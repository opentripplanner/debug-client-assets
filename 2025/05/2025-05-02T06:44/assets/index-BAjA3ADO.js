var eS=Object.defineProperty;var tS=(i,n,a)=>n in i?eS(i,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[n]=a;var mp=(i,n,a)=>tS(i,typeof n!="symbol"?n+"":n,a);function nS(i,n){for(var a=0;a<n.length;a++){const h=n[a];if(typeof h!="string"&&!Array.isArray(h)){for(const p in h)if(p!=="default"&&!(p in i)){const _=Object.getOwnPropertyDescriptor(h,p);_&&Object.defineProperty(i,p,_.get?_:{enumerable:!0,get:()=>h[p]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))h(p);new MutationObserver(p=>{for(const _ of p)if(_.type==="childList")for(const v of _.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&h(v)}).observe(document,{childList:!0,subtree:!0});function a(p){const _={};return p.integrity&&(_.integrity=p.integrity),p.referrerPolicy&&(_.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?_.credentials="include":p.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function h(p){if(p.ep)return;p.ep=!0;const _=a(p);fetch(p.href,_)}})();function Lp(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Pv={exports:{}},Ey={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb;function iS(){if(Vb)return Ey;Vb=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(h,p,_){var v=null;if(_!==void 0&&(v=""+_),p.key!==void 0&&(v=""+p.key),"key"in p){_={};for(var c in p)c!=="key"&&(_[c]=p[c])}else _=p;return p=_.ref,{$$typeof:i,type:h,key:v,ref:p!==void 0?p:null,props:_}}return Ey.Fragment=n,Ey.jsx=a,Ey.jsxs=a,Ey}var Zb;function rS(){return Zb||(Zb=1,Pv.exports=iS()),Pv.exports}var se=rS(),Ov={exports:{}},Rn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gb;function aS(){if(Gb)return Rn;Gb=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),v=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),j=Symbol.iterator;function U(Se){return Se===null||typeof Se!="object"?null:(Se=j&&Se[j]||Se["@@iterator"],typeof Se=="function"?Se:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ie=Object.assign,me={};function pe(Se,gt,kt){this.props=Se,this.context=gt,this.refs=me,this.updater=kt||V}pe.prototype.isReactComponent={},pe.prototype.setState=function(Se,gt){if(typeof Se!="object"&&typeof Se!="function"&&Se!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Se,gt,"setState")},pe.prototype.forceUpdate=function(Se){this.updater.enqueueForceUpdate(this,Se,"forceUpdate")};function Le(){}Le.prototype=pe.prototype;function Qe(Se,gt,kt){this.props=Se,this.context=gt,this.refs=me,this.updater=kt||V}var He=Qe.prototype=new Le;He.constructor=Qe,ie(He,pe.prototype),He.isPureReactComponent=!0;var $e=Array.isArray,ke={H:null,A:null,T:null,S:null,V:null},Ze=Object.prototype.hasOwnProperty;function nt(Se,gt,kt,St,zt,Yt){return kt=Yt.ref,{$$typeof:i,type:Se,key:gt,ref:kt!==void 0?kt:null,props:Yt}}function Ke(Se,gt){return nt(Se.type,gt,void 0,void 0,void 0,Se.props)}function Re(Se){return typeof Se=="object"&&Se!==null&&Se.$$typeof===i}function _t(Se){var gt={"=":"=0",":":"=2"};return"$"+Se.replace(/[=:]/g,function(kt){return gt[kt]})}var It=/\/+/g;function Ot(Se,gt){return typeof Se=="object"&&Se!==null&&Se.key!=null?_t(""+Se.key):gt.toString(36)}function Vt(){}function Wt(Se){switch(Se.status){case"fulfilled":return Se.value;case"rejected":throw Se.reason;default:switch(typeof Se.status=="string"?Se.then(Vt,Vt):(Se.status="pending",Se.then(function(gt){Se.status==="pending"&&(Se.status="fulfilled",Se.value=gt)},function(gt){Se.status==="pending"&&(Se.status="rejected",Se.reason=gt)})),Se.status){case"fulfilled":return Se.value;case"rejected":throw Se.reason}}throw Se}function dn(Se,gt,kt,St,zt){var Yt=typeof Se;(Yt==="undefined"||Yt==="boolean")&&(Se=null);var tn=!1;if(Se===null)tn=!0;else switch(Yt){case"bigint":case"string":case"number":tn=!0;break;case"object":switch(Se.$$typeof){case i:case n:tn=!0;break;case P:return tn=Se._init,dn(tn(Se._payload),gt,kt,St,zt)}}if(tn)return zt=zt(Se),tn=St===""?"."+Ot(Se,0):St,$e(zt)?(kt="",tn!=null&&(kt=tn.replace(It,"$&/")+"/"),dn(zt,gt,kt,"",function(ni){return ni})):zt!=null&&(Re(zt)&&(zt=Ke(zt,kt+(zt.key==null||Se&&Se.key===zt.key?"":(""+zt.key).replace(It,"$&/")+"/")+tn)),gt.push(zt)),1;tn=0;var gi=St===""?".":St+":";if($e(Se))for(var Tn=0;Tn<Se.length;Tn++)St=Se[Tn],Yt=gi+Ot(St,Tn),tn+=dn(St,gt,kt,Yt,zt);else if(Tn=U(Se),typeof Tn=="function")for(Se=Tn.call(Se),Tn=0;!(St=Se.next()).done;)St=St.value,Yt=gi+Ot(St,Tn++),tn+=dn(St,gt,kt,Yt,zt);else if(Yt==="object"){if(typeof Se.then=="function")return dn(Wt(Se),gt,kt,St,zt);throw gt=String(Se),Error("Objects are not valid as a React child (found: "+(gt==="[object Object]"?"object with keys {"+Object.keys(Se).join(", ")+"}":gt)+"). If you meant to render a collection of children, use an array instead.")}return tn}function Oe(Se,gt,kt){if(Se==null)return Se;var St=[],zt=0;return dn(Se,St,"","",function(Yt){return gt.call(kt,Yt,zt++)}),St}function vt(Se){if(Se._status===-1){var gt=Se._result;gt=gt(),gt.then(function(kt){(Se._status===0||Se._status===-1)&&(Se._status=1,Se._result=kt)},function(kt){(Se._status===0||Se._status===-1)&&(Se._status=2,Se._result=kt)}),Se._status===-1&&(Se._status=0,Se._result=gt)}if(Se._status===1)return Se._result.default;throw Se._result}var mt=typeof reportError=="function"?reportError:function(Se){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var gt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Se=="object"&&Se!==null&&typeof Se.message=="string"?String(Se.message):String(Se),error:Se});if(!window.dispatchEvent(gt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Se);return}console.error(Se)};function Qt(){}return Rn.Children={map:Oe,forEach:function(Se,gt,kt){Oe(Se,function(){gt.apply(this,arguments)},kt)},count:function(Se){var gt=0;return Oe(Se,function(){gt++}),gt},toArray:function(Se){return Oe(Se,function(gt){return gt})||[]},only:function(Se){if(!Re(Se))throw Error("React.Children.only expected to receive a single React element child.");return Se}},Rn.Component=pe,Rn.Fragment=a,Rn.Profiler=p,Rn.PureComponent=Qe,Rn.StrictMode=h,Rn.Suspense=C,Rn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ke,Rn.__COMPILER_RUNTIME={__proto__:null,c:function(Se){return ke.H.useMemoCache(Se)}},Rn.cache=function(Se){return function(){return Se.apply(null,arguments)}},Rn.cloneElement=function(Se,gt,kt){if(Se==null)throw Error("The argument must be a React element, but you passed "+Se+".");var St=ie({},Se.props),zt=Se.key,Yt=void 0;if(gt!=null)for(tn in gt.ref!==void 0&&(Yt=void 0),gt.key!==void 0&&(zt=""+gt.key),gt)!Ze.call(gt,tn)||tn==="key"||tn==="__self"||tn==="__source"||tn==="ref"&&gt.ref===void 0||(St[tn]=gt[tn]);var tn=arguments.length-2;if(tn===1)St.children=kt;else if(1<tn){for(var gi=Array(tn),Tn=0;Tn<tn;Tn++)gi[Tn]=arguments[Tn+2];St.children=gi}return nt(Se.type,zt,void 0,void 0,Yt,St)},Rn.createContext=function(Se){return Se={$$typeof:v,_currentValue:Se,_currentValue2:Se,_threadCount:0,Provider:null,Consumer:null},Se.Provider=Se,Se.Consumer={$$typeof:_,_context:Se},Se},Rn.createElement=function(Se,gt,kt){var St,zt={},Yt=null;if(gt!=null)for(St in gt.key!==void 0&&(Yt=""+gt.key),gt)Ze.call(gt,St)&&St!=="key"&&St!=="__self"&&St!=="__source"&&(zt[St]=gt[St]);var tn=arguments.length-2;if(tn===1)zt.children=kt;else if(1<tn){for(var gi=Array(tn),Tn=0;Tn<tn;Tn++)gi[Tn]=arguments[Tn+2];zt.children=gi}if(Se&&Se.defaultProps)for(St in tn=Se.defaultProps,tn)zt[St]===void 0&&(zt[St]=tn[St]);return nt(Se,Yt,void 0,void 0,null,zt)},Rn.createRef=function(){return{current:null}},Rn.forwardRef=function(Se){return{$$typeof:c,render:Se}},Rn.isValidElement=Re,Rn.lazy=function(Se){return{$$typeof:P,_payload:{_status:-1,_result:Se},_init:vt}},Rn.memo=function(Se,gt){return{$$typeof:k,type:Se,compare:gt===void 0?null:gt}},Rn.startTransition=function(Se){var gt=ke.T,kt={};ke.T=kt;try{var St=Se(),zt=ke.S;zt!==null&&zt(kt,St),typeof St=="object"&&St!==null&&typeof St.then=="function"&&St.then(Qt,mt)}catch(Yt){mt(Yt)}finally{ke.T=gt}},Rn.unstable_useCacheRefresh=function(){return ke.H.useCacheRefresh()},Rn.use=function(Se){return ke.H.use(Se)},Rn.useActionState=function(Se,gt,kt){return ke.H.useActionState(Se,gt,kt)},Rn.useCallback=function(Se,gt){return ke.H.useCallback(Se,gt)},Rn.useContext=function(Se){return ke.H.useContext(Se)},Rn.useDebugValue=function(){},Rn.useDeferredValue=function(Se,gt){return ke.H.useDeferredValue(Se,gt)},Rn.useEffect=function(Se,gt,kt){var St=ke.H;if(typeof kt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return St.useEffect(Se,gt)},Rn.useId=function(){return ke.H.useId()},Rn.useImperativeHandle=function(Se,gt,kt){return ke.H.useImperativeHandle(Se,gt,kt)},Rn.useInsertionEffect=function(Se,gt){return ke.H.useInsertionEffect(Se,gt)},Rn.useLayoutEffect=function(Se,gt){return ke.H.useLayoutEffect(Se,gt)},Rn.useMemo=function(Se,gt){return ke.H.useMemo(Se,gt)},Rn.useOptimistic=function(Se,gt){return ke.H.useOptimistic(Se,gt)},Rn.useReducer=function(Se,gt,kt){return ke.H.useReducer(Se,gt,kt)},Rn.useRef=function(Se){return ke.H.useRef(Se)},Rn.useState=function(Se){return ke.H.useState(Se)},Rn.useSyncExternalStore=function(Se,gt,kt){return ke.H.useSyncExternalStore(Se,gt,kt)},Rn.useTransition=function(){return ke.H.useTransition()},Rn.version="19.1.0",Rn}var $b;function Qx(){return $b||($b=1,Ov.exports=aS()),Ov.exports}var ce=Qx();const Rl=Lp(ce);var jv={exports:{}},Sy={},Bv={exports:{}},Fv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yb;function sS(){return Yb||(Yb=1,function(i){function n(Oe,vt){var mt=Oe.length;Oe.push(vt);e:for(;0<mt;){var Qt=mt-1>>>1,Se=Oe[Qt];if(0<p(Se,vt))Oe[Qt]=vt,Oe[mt]=Se,mt=Qt;else break e}}function a(Oe){return Oe.length===0?null:Oe[0]}function h(Oe){if(Oe.length===0)return null;var vt=Oe[0],mt=Oe.pop();if(mt!==vt){Oe[0]=mt;e:for(var Qt=0,Se=Oe.length,gt=Se>>>1;Qt<gt;){var kt=2*(Qt+1)-1,St=Oe[kt],zt=kt+1,Yt=Oe[zt];if(0>p(St,mt))zt<Se&&0>p(Yt,St)?(Oe[Qt]=Yt,Oe[zt]=mt,Qt=zt):(Oe[Qt]=St,Oe[kt]=mt,Qt=kt);else if(zt<Se&&0>p(Yt,mt))Oe[Qt]=Yt,Oe[zt]=mt,Qt=zt;else break e}}return vt}function p(Oe,vt){var mt=Oe.sortIndex-vt.sortIndex;return mt!==0?mt:Oe.id-vt.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;i.unstable_now=function(){return _.now()}}else{var v=Date,c=v.now();i.unstable_now=function(){return v.now()-c}}var C=[],k=[],P=1,j=null,U=3,V=!1,ie=!1,me=!1,pe=!1,Le=typeof setTimeout=="function"?setTimeout:null,Qe=typeof clearTimeout=="function"?clearTimeout:null,He=typeof setImmediate<"u"?setImmediate:null;function $e(Oe){for(var vt=a(k);vt!==null;){if(vt.callback===null)h(k);else if(vt.startTime<=Oe)h(k),vt.sortIndex=vt.expirationTime,n(C,vt);else break;vt=a(k)}}function ke(Oe){if(me=!1,$e(Oe),!ie)if(a(C)!==null)ie=!0,Ze||(Ze=!0,Ot());else{var vt=a(k);vt!==null&&dn(ke,vt.startTime-Oe)}}var Ze=!1,nt=-1,Ke=5,Re=-1;function _t(){return pe?!0:!(i.unstable_now()-Re<Ke)}function It(){if(pe=!1,Ze){var Oe=i.unstable_now();Re=Oe;var vt=!0;try{e:{ie=!1,me&&(me=!1,Qe(nt),nt=-1),V=!0;var mt=U;try{t:{for($e(Oe),j=a(C);j!==null&&!(j.expirationTime>Oe&&_t());){var Qt=j.callback;if(typeof Qt=="function"){j.callback=null,U=j.priorityLevel;var Se=Qt(j.expirationTime<=Oe);if(Oe=i.unstable_now(),typeof Se=="function"){j.callback=Se,$e(Oe),vt=!0;break t}j===a(C)&&h(C),$e(Oe)}else h(C);j=a(C)}if(j!==null)vt=!0;else{var gt=a(k);gt!==null&&dn(ke,gt.startTime-Oe),vt=!1}}break e}finally{j=null,U=mt,V=!1}vt=void 0}}finally{vt?Ot():Ze=!1}}}var Ot;if(typeof He=="function")Ot=function(){He(It)};else if(typeof MessageChannel<"u"){var Vt=new MessageChannel,Wt=Vt.port2;Vt.port1.onmessage=It,Ot=function(){Wt.postMessage(null)}}else Ot=function(){Le(It,0)};function dn(Oe,vt){nt=Le(function(){Oe(i.unstable_now())},vt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Oe){Oe.callback=null},i.unstable_forceFrameRate=function(Oe){0>Oe||125<Oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ke=0<Oe?Math.floor(1e3/Oe):5},i.unstable_getCurrentPriorityLevel=function(){return U},i.unstable_next=function(Oe){switch(U){case 1:case 2:case 3:var vt=3;break;default:vt=U}var mt=U;U=vt;try{return Oe()}finally{U=mt}},i.unstable_requestPaint=function(){pe=!0},i.unstable_runWithPriority=function(Oe,vt){switch(Oe){case 1:case 2:case 3:case 4:case 5:break;default:Oe=3}var mt=U;U=Oe;try{return vt()}finally{U=mt}},i.unstable_scheduleCallback=function(Oe,vt,mt){var Qt=i.unstable_now();switch(typeof mt=="object"&&mt!==null?(mt=mt.delay,mt=typeof mt=="number"&&0<mt?Qt+mt:Qt):mt=Qt,Oe){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=mt+Se,Oe={id:P++,callback:vt,priorityLevel:Oe,startTime:mt,expirationTime:Se,sortIndex:-1},mt>Qt?(Oe.sortIndex=mt,n(k,Oe),a(C)===null&&Oe===a(k)&&(me?(Qe(nt),nt=-1):me=!0,dn(ke,mt-Qt))):(Oe.sortIndex=Se,n(C,Oe),ie||V||(ie=!0,Ze||(Ze=!0,Ot()))),Oe},i.unstable_shouldYield=_t,i.unstable_wrapCallback=function(Oe){var vt=U;return function(){var mt=U;U=vt;try{return Oe.apply(this,arguments)}finally{U=mt}}}}(Fv)),Fv}var qb;function oS(){return qb||(qb=1,Bv.exports=sS()),Bv.exports}var Uv={exports:{}},Ja={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hb;function lS(){if(Hb)return Ja;Hb=1;var i=Qx();function n(C){var k="https://react.dev/errors/"+C;if(1<arguments.length){k+="?args[]="+encodeURIComponent(arguments[1]);for(var P=2;P<arguments.length;P++)k+="&args[]="+encodeURIComponent(arguments[P])}return"Minified React error #"+C+"; visit "+k+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var h={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},p=Symbol.for("react.portal");function _(C,k,P){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:j==null?null:""+j,children:C,containerInfo:k,implementation:P}}var v=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(C,k){if(C==="font")return"";if(typeof k=="string")return k==="use-credentials"?k:""}return Ja.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=h,Ja.createPortal=function(C,k){var P=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!k||k.nodeType!==1&&k.nodeType!==9&&k.nodeType!==11)throw Error(n(299));return _(C,k,null,P)},Ja.flushSync=function(C){var k=v.T,P=h.p;try{if(v.T=null,h.p=2,C)return C()}finally{v.T=k,h.p=P,h.d.f()}},Ja.preconnect=function(C,k){typeof C=="string"&&(k?(k=k.crossOrigin,k=typeof k=="string"?k==="use-credentials"?k:"":void 0):k=null,h.d.C(C,k))},Ja.prefetchDNS=function(C){typeof C=="string"&&h.d.D(C)},Ja.preinit=function(C,k){if(typeof C=="string"&&k&&typeof k.as=="string"){var P=k.as,j=c(P,k.crossOrigin),U=typeof k.integrity=="string"?k.integrity:void 0,V=typeof k.fetchPriority=="string"?k.fetchPriority:void 0;P==="style"?h.d.S(C,typeof k.precedence=="string"?k.precedence:void 0,{crossOrigin:j,integrity:U,fetchPriority:V}):P==="script"&&h.d.X(C,{crossOrigin:j,integrity:U,fetchPriority:V,nonce:typeof k.nonce=="string"?k.nonce:void 0})}},Ja.preinitModule=function(C,k){if(typeof C=="string")if(typeof k=="object"&&k!==null){if(k.as==null||k.as==="script"){var P=c(k.as,k.crossOrigin);h.d.M(C,{crossOrigin:P,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0})}}else k==null&&h.d.M(C)},Ja.preload=function(C,k){if(typeof C=="string"&&typeof k=="object"&&k!==null&&typeof k.as=="string"){var P=k.as,j=c(P,k.crossOrigin);h.d.L(C,P,{crossOrigin:j,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0,type:typeof k.type=="string"?k.type:void 0,fetchPriority:typeof k.fetchPriority=="string"?k.fetchPriority:void 0,referrerPolicy:typeof k.referrerPolicy=="string"?k.referrerPolicy:void 0,imageSrcSet:typeof k.imageSrcSet=="string"?k.imageSrcSet:void 0,imageSizes:typeof k.imageSizes=="string"?k.imageSizes:void 0,media:typeof k.media=="string"?k.media:void 0})}},Ja.preloadModule=function(C,k){if(typeof C=="string")if(k){var P=c(k.as,k.crossOrigin);h.d.m(C,{as:typeof k.as=="string"&&k.as!=="script"?k.as:void 0,crossOrigin:P,integrity:typeof k.integrity=="string"?k.integrity:void 0})}else h.d.m(C)},Ja.requestFormReset=function(C){h.d.r(C)},Ja.unstable_batchedUpdates=function(C,k){return C(k)},Ja.useFormState=function(C,k,P){return v.H.useFormState(C,k,P)},Ja.useFormStatus=function(){return v.H.useHostTransitionStatus()},Ja.version="19.1.0",Ja}var Xb;function Yw(){if(Xb)return Uv.exports;Xb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Uv.exports=lS(),Uv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wb;function cS(){if(Wb)return Sy;Wb=1;var i=oS(),n=Qx(),a=Yw();function h(r){var u="https://react.dev/errors/"+r;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+r+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function _(r){var u=r,m=r;if(r.alternate)for(;u.return;)u=u.return;else{r=u;do u=r,(u.flags&4098)!==0&&(m=u.return),r=u.return;while(r)}return u.tag===3?m:null}function v(r){if(r.tag===13){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function c(r){if(_(r)!==r)throw Error(h(188))}function C(r){var u=r.alternate;if(!u){if(u=_(r),u===null)throw Error(h(188));return u!==r?null:r}for(var m=r,b=u;;){var M=m.return;if(M===null)break;var z=M.alternate;if(z===null){if(b=M.return,b!==null){m=b;continue}break}if(M.child===z.child){for(z=M.child;z;){if(z===m)return c(M),r;if(z===b)return c(M),u;z=z.sibling}throw Error(h(188))}if(m.return!==b.return)m=M,b=z;else{for(var H=!1,ae=M.child;ae;){if(ae===m){H=!0,m=M,b=z;break}if(ae===b){H=!0,b=M,m=z;break}ae=ae.sibling}if(!H){for(ae=z.child;ae;){if(ae===m){H=!0,m=z,b=M;break}if(ae===b){H=!0,b=z,m=M;break}ae=ae.sibling}if(!H)throw Error(h(189))}}if(m.alternate!==b)throw Error(h(190))}if(m.tag!==3)throw Error(h(188));return m.stateNode.current===m?r:u}function k(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r;for(r=r.child;r!==null;){if(u=k(r),u!==null)return u;r=r.sibling}return null}var P=Object.assign,j=Symbol.for("react.element"),U=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),me=Symbol.for("react.strict_mode"),pe=Symbol.for("react.profiler"),Le=Symbol.for("react.provider"),Qe=Symbol.for("react.consumer"),He=Symbol.for("react.context"),$e=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),Ze=Symbol.for("react.suspense_list"),nt=Symbol.for("react.memo"),Ke=Symbol.for("react.lazy"),Re=Symbol.for("react.activity"),_t=Symbol.for("react.memo_cache_sentinel"),It=Symbol.iterator;function Ot(r){return r===null||typeof r!="object"?null:(r=It&&r[It]||r["@@iterator"],typeof r=="function"?r:null)}var Vt=Symbol.for("react.client.reference");function Wt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Vt?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case ie:return"Fragment";case pe:return"Profiler";case me:return"StrictMode";case ke:return"Suspense";case Ze:return"SuspenseList";case Re:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case V:return"Portal";case He:return(r.displayName||"Context")+".Provider";case Qe:return(r._context.displayName||"Context")+".Consumer";case $e:var u=r.render;return r=r.displayName,r||(r=u.displayName||u.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case nt:return u=r.displayName||null,u!==null?u:Wt(r.type)||"Memo";case Ke:u=r._payload,r=r._init;try{return Wt(r(u))}catch{}}return null}var dn=Array.isArray,Oe=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,vt=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,mt={pending:!1,data:null,method:null,action:null},Qt=[],Se=-1;function gt(r){return{current:r}}function kt(r){0>Se||(r.current=Qt[Se],Qt[Se]=null,Se--)}function St(r,u){Se++,Qt[Se]=r.current,r.current=u}var zt=gt(null),Yt=gt(null),tn=gt(null),gi=gt(null);function Tn(r,u){switch(St(tn,u),St(Yt,r),St(zt,null),u.nodeType){case 9:case 11:r=(r=u.documentElement)&&(r=r.namespaceURI)?hp(r):0;break;default:if(r=u.tagName,u=u.namespaceURI)u=hp(u),r=dp(u,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}kt(zt),St(zt,r)}function ni(){kt(zt),kt(Yt),kt(tn)}function ba(r){r.memoizedState!==null&&St(gi,r);var u=zt.current,m=dp(u,r.type);u!==m&&(St(Yt,r),St(zt,m))}function Mi(r){Yt.current===r&&(kt(zt),kt(Yt)),gi.current===r&&(kt(gi),Pt._currentValue=mt)}var yi=Object.prototype.hasOwnProperty,Er=i.unstable_scheduleCallback,Zn=i.unstable_cancelCallback,Gn=i.unstable_shouldYield,wa=i.unstable_requestPaint,li=i.unstable_now,js=i.unstable_getCurrentPriorityLevel,is=i.unstable_ImmediatePriority,rr=i.unstable_UserBlockingPriority,fr=i.unstable_NormalPriority,xo=i.unstable_LowPriority,Bs=i.unstable_IdlePriority,bo=i.log,Fs=i.unstable_setDisableYieldValue,Xr=null,Ki=null;function pr(r){if(typeof bo=="function"&&Fs(r),Ki&&typeof Ki.setStrictMode=="function")try{Ki.setStrictMode(Xr,r)}catch{}}var Gi=Math.clz32?Math.clz32:zu,wo=Math.log,Fc=Math.LN2;function zu(r){return r>>>=0,r===0?32:31-(wo(r)/Fc|0)|0}var Vl=256,ja=4194304;function Ne(r){var u=r&42;if(u!==0)return u;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ee(r,u,m){var b=r.pendingLanes;if(b===0)return 0;var M=0,z=r.suspendedLanes,H=r.pingedLanes;r=r.warmLanes;var ae=b&134217727;return ae!==0?(b=ae&~z,b!==0?M=Ne(b):(H&=ae,H!==0?M=Ne(H):m||(m=ae&~r,m!==0&&(M=Ne(m))))):(ae=b&~z,ae!==0?M=Ne(ae):H!==0?M=Ne(H):m||(m=b&~r,m!==0&&(M=Ne(m)))),M===0?0:u!==0&&u!==M&&(u&z)===0&&(z=M&-M,m=u&-u,z>=m||z===32&&(m&4194048)!==0)?u:M}function re(r,u){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&u)===0}function X(r,u){switch(r){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _e(){var r=Vl;return Vl<<=1,(Vl&4194048)===0&&(Vl=256),r}function Ce(){var r=ja;return ja<<=1,(ja&62914560)===0&&(ja=4194304),r}function Ae(r){for(var u=[],m=0;31>m;m++)u.push(r);return u}function Be(r,u){r.pendingLanes|=u,u!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ze(r,u,m,b,M,z){var H=r.pendingLanes;r.pendingLanes=m,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=m,r.entangledLanes&=m,r.errorRecoveryDisabledLanes&=m,r.shellSuspendCounter=0;var ae=r.entanglements,we=r.expirationTimes,Ye=r.hiddenUpdates;for(m=H&~m;0<m;){var ct=31-Gi(m),xt=1<<ct;ae[ct]=0,we[ct]=-1;var We=Ye[ct];if(We!==null)for(Ye[ct]=null,ct=0;ct<We.length;ct++){var et=We[ct];et!==null&&(et.lane&=-536870913)}m&=~xt}b!==0&&rt(r,b,0),z!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=z&~(H&~u))}function rt(r,u,m){r.pendingLanes|=u,r.suspendedLanes&=~u;var b=31-Gi(u);r.entangledLanes|=u,r.entanglements[b]=r.entanglements[b]|1073741824|m&4194090}function Je(r,u){var m=r.entangledLanes|=u;for(r=r.entanglements;m;){var b=31-Gi(m),M=1<<b;M&u|r[b]&u&&(r[b]|=u),m&=~M}}function je(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ht(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ct(){var r=vt.p;return r!==0?r:(r=window.event,r===void 0?32:ra(r.type))}function Rt(r,u){var m=vt.p;try{return vt.p=r,u()}finally{vt.p=m}}var Xe=Math.random().toString(36).slice(2),$t="__reactFiber$"+Xe,jt="__reactProps$"+Xe,nn="__reactContainer$"+Xe,Cn="__reactEvents$"+Xe,yt="__reactListeners$"+Xe,Bt="__reactHandles$"+Xe,Mt="__reactResources$"+Xe,sn="__reactMarker$"+Xe;function Ci(r){delete r[$t],delete r[jt],delete r[Cn],delete r[yt],delete r[Bt]}function sa(r){var u=r[$t];if(u)return u;for(var m=r.parentNode;m;){if(u=m[nn]||m[$t]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(r=vy(r);r!==null;){if(m=r[$t])return m;r=vy(r)}return u}r=m,m=r.parentNode}return null}function qt(r){if(r=r[$t]||r[nn]){var u=r.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return r}return null}function Bi(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r.stateNode;throw Error(h(33))}function $n(r){var u=r[Mt];return u||(u=r[Mt]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Ji(r){r[sn]=!0}var Zl=new Set,To={};function ar(r,u){Jn(r,u),Jn(r+"Capture",u)}function Jn(r,u){for(To[r]=u,r=0;r<u.length;r++)Zl.add(u[r])}var Ag=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gl={},ed={};function el(r){return yi.call(ed,r)?!0:yi.call(Gl,r)?!1:Ag.test(r)?ed[r]=!0:(Gl[r]=!0,!1)}function Eo(r,u,m){if(el(u))if(m===null)r.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":r.removeAttribute(u);return;case"boolean":var b=u.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){r.removeAttribute(u);return}}r.setAttribute(u,""+m)}}function Lu(r,u,m){if(m===null)r.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttribute(u,""+m)}}function Us(r,u,m,b){if(b===null)r.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(m);return}r.setAttributeNS(u,m,""+b)}}var td,$l;function Yl(r){if(td===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);td=u&&u[1]||"",$l=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+td+r+$l}var _f=!1;function nd(r,u){if(!r||_f)return"";_f=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(et){var We=et}Reflect.construct(r,[],xt)}else{try{xt.call()}catch(et){We=et}r.call(xt.prototype)}}else{try{throw Error()}catch(et){We=et}(xt=r())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(et){if(et&&We&&typeof et.stack=="string")return[et.stack,We.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=b.DetermineComponentFrameRoot(),H=z[0],ae=z[1];if(H&&ae){var we=H.split(`
`),Ye=ae.split(`
`);for(M=b=0;b<we.length&&!we[b].includes("DetermineComponentFrameRoot");)b++;for(;M<Ye.length&&!Ye[M].includes("DetermineComponentFrameRoot");)M++;if(b===we.length||M===Ye.length)for(b=we.length-1,M=Ye.length-1;1<=b&&0<=M&&we[b]!==Ye[M];)M--;for(;1<=b&&0<=M;b--,M--)if(we[b]!==Ye[M]){if(b!==1||M!==1)do if(b--,M--,0>M||we[b]!==Ye[M]){var ct=`
`+we[b].replace(" at new "," at ");return r.displayName&&ct.includes("<anonymous>")&&(ct=ct.replace("<anonymous>",r.displayName)),ct}while(1<=b&&0<=M);break}}}finally{_f=!1,Error.prepareStackTrace=m}return(m=r?r.displayName||r.name:"")?Yl(m):""}function Nu(r){switch(r.tag){case 26:case 27:case 5:return Yl(r.type);case 16:return Yl("Lazy");case 13:return Yl("Suspense");case 19:return Yl("SuspenseList");case 0:case 15:return nd(r.type,!1);case 11:return nd(r.type.render,!1);case 1:return nd(r.type,!0);case 31:return Yl("Activity");default:return""}}function vf(r){try{var u="";do u+=Nu(r),r=r.return;while(r);return u}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function Ta(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function tl(r){var u=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function xf(r){var u=tl(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,u),b=""+r[u];if(!r.hasOwnProperty(u)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var M=m.get,z=m.set;return Object.defineProperty(r,u,{configurable:!0,get:function(){return M.call(this)},set:function(H){b=""+H,z.call(this,H)}}),Object.defineProperty(r,u,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(H){b=""+H},stopTracking:function(){r._valueTracker=null,delete r[u]}}}}function Pu(r){r._valueTracker||(r._valueTracker=xf(r))}function id(r){if(!r)return!1;var u=r._valueTracker;if(!u)return!0;var m=u.getValue(),b="";return r&&(b=tl(r)?r.checked?"true":"false":r.value),r=b,r!==m?(u.setValue(r),!0):!1}function ql(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ou=/[\n"\\]/g;function $i(r){return r.replace(Ou,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function yn(r,u,m,b,M,z,H,ae){r.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?r.type=H:r.removeAttribute("type"),u!=null?H==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+Ta(u)):r.value!==""+Ta(u)&&(r.value=""+Ta(u)):H!=="submit"&&H!=="reset"||r.removeAttribute("value"),u!=null?Vs(r,H,Ta(u)):m!=null?Vs(r,H,Ta(m)):b!=null&&r.removeAttribute("value"),M==null&&z!=null&&(r.defaultChecked=!!z),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?r.name=""+Ta(ae):r.removeAttribute("name")}function nl(r,u,m,b,M,z,H,ae){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(r.type=z),u!=null||m!=null){if(!(z!=="submit"&&z!=="reset"||u!=null))return;m=m!=null?""+Ta(m):"",u=u!=null?""+Ta(u):m,ae||u===r.value||(r.value=u),r.defaultValue=u}b=b??M,b=typeof b!="function"&&typeof b!="symbol"&&!!b,r.checked=ae?r.checked:!!b,r.defaultChecked=!!b,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(r.name=H)}function Vs(r,u,m){u==="number"&&ql(r.ownerDocument)===r||r.defaultValue===""+m||(r.defaultValue=""+m)}function oa(r,u,m,b){if(r=r.options,u){u={};for(var M=0;M<m.length;M++)u["$"+m[M]]=!0;for(m=0;m<r.length;m++)M=u.hasOwnProperty("$"+r[m].value),r[m].selected!==M&&(r[m].selected=M),M&&b&&(r[m].defaultSelected=!0)}else{for(m=""+Ta(m),u=null,M=0;M<r.length;M++){if(r[M].value===m){r[M].selected=!0,b&&(r[M].defaultSelected=!0);return}u!==null||r[M].disabled||(u=r[M])}u!==null&&(u.selected=!0)}}function Hl(r,u,m){if(u!=null&&(u=""+Ta(u),u!==r.value&&(r.value=u),m==null)){r.defaultValue!==u&&(r.defaultValue=u);return}r.defaultValue=m!=null?""+Ta(m):""}function kn(r,u,m,b){if(u==null){if(b!=null){if(m!=null)throw Error(h(92));if(dn(b)){if(1<b.length)throw Error(h(93));b=b[0]}m=b}m==null&&(m=""),u=m}m=Ta(u),r.defaultValue=m,b=r.textContent,b===m&&b!==""&&b!==null&&(r.value=b)}function kr(r,u){if(u){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=u;return}}r.textContent=u}var ju=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xl(r,u,m){var b=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="":b?r.setProperty(u,m):typeof m!="number"||m===0||ju.has(u)?u==="float"?r.cssFloat=m:r[u]=(""+m).trim():r[u]=m+"px"}function Ur(r,u,m){if(u!=null&&typeof u!="object")throw Error(h(62));if(r=r.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||u!=null&&u.hasOwnProperty(b)||(b.indexOf("--")===0?r.setProperty(b,""):b==="float"?r.cssFloat="":r[b]="");for(var M in u)b=u[M],u.hasOwnProperty(M)&&m[M]!==b&&Xl(r,M,b)}else for(var z in u)u.hasOwnProperty(z)&&Xl(r,z,u[z])}function mr(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Di=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sr(r){return rd.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Vr=null;function er(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Wl=null,Ea=null;function _i(r){var u=qt(r);if(u&&(r=u.stateNode)){var m=r[jt]||null;e:switch(r=u.stateNode,u.type){case"input":if(yn(r,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+$i(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var b=m[u];if(b!==r&&b.form===r.form){var M=b[jt]||null;if(!M)throw Error(h(90));yn(b,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(u=0;u<m.length;u++)b=m[u],b.form===r.form&&id(b)}break e;case"textarea":Hl(r,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&oa(r,!!m.multiple,u,!1)}}}var il=!1;function So(r,u,m){if(il)return r(u,m);il=!0;try{var b=r(u);return b}finally{if(il=!1,(Wl!==null||Ea!==null)&&(np(),Wl&&(u=Wl,r=Ea,Ea=Wl=null,_i(u),r)))for(u=0;u<r.length;u++)_i(r[u])}}function Ao(r,u){var m=r.stateNode;if(m===null)return null;var b=m[jt]||null;if(b===null)return null;m=b[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(r=r.type,b=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!b;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(h(231,u,typeof m));return m}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ii=!1;if(Yi)try{var la={};Object.defineProperty(la,"passive",{get:function(){ii=!0}}),window.addEventListener("test",la,la),window.removeEventListener("test",la,la)}catch{ii=!1}var xn=null,fn=null,Mo=null;function Dn(){if(Mo)return Mo;var r,u=fn,m=u.length,b,M="value"in xn?xn.value:xn.textContent,z=M.length;for(r=0;r<m&&u[r]===M[r];r++);var H=m-r;for(b=1;b<=H&&u[m-b]===M[z-b];b++);return Mo=M.slice(r,1<b?1-b:void 0)}function Co(r){var u=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&u===13&&(r=13)):r=u,r===10&&(r=13),32<=r||r===13?r:0}function ca(){return!0}function Uc(){return!1}function Ar(r){function u(m,b,M,z,H){this._reactName=m,this._targetInst=M,this.type=b,this.nativeEvent=z,this.target=H,this.currentTarget=null;for(var ae in r)r.hasOwnProperty(ae)&&(m=r[ae],this[ae]=m?m(z):z[ae]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?ca:Uc,this.isPropagationStopped=Uc,this}return P(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ca)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ca)},persist:function(){},isPersistent:ca}),u}var Zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rl=Ar(Zs),Do=P({},Zs,{view:0,detail:0}),ad=Ar(Do),al,sd,rs,sr=P({},Do,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Io,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==rs&&(rs&&r.type==="mousemove"?(al=r.screenX-rs.screenX,sd=r.screenY-rs.screenY):sd=al=0,rs=r),al)},movementY:function(r){return"movementY"in r?r.movementY:sd}}),Bu=Ar(sr),Up=P({},sr,{dataTransfer:0}),Zr=Ar(Up),or=P({},Do,{relatedTarget:0}),Sa=Ar(or),Vc=P({},Zs,{animationName:0,elapsedTime:0,pseudoElement:0}),bf=Ar(Vc),Vp=P({},Zs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ko=Ar(Vp),wf=P({},Zs,{data:0}),Zp=Ar(wf),od={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ld={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},as={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gp(r){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(r):(r=as[r])?!!u[r]:!1}function Io(){return Gp}var Tf=P({},Do,{key:function(r){if(r.key){var u=od[r.key]||r.key;if(u!=="Unidentified")return u}return r.type==="keypress"?(r=Co(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ld[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Io,charCode:function(r){return r.type==="keypress"?Co(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Co(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Zc=Ar(Tf),Ef=P({},sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cd=Ar(Ef),Gs=P({},Do,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Io}),Mg=Ar(Gs),Gc=P({},Zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fu=Ar(Gc),$c=P({},sr,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),$p=Ar($c),ud=P({},Zs,{newState:0,oldState:0}),Yp=Ar(ud),Yc=[9,13,27,32],Sf=Yi&&"CompositionEvent"in window,qc=null;Yi&&"documentMode"in document&&(qc=document.documentMode);var Cg=Yi&&"TextEvent"in window&&!qc,Af=Yi&&(!Sf||qc&&8<qc&&11>=qc),Uu=" ",hd=!1;function dd(r,u){switch(r){case"keyup":return Yc.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mf(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ql=!1;function Kl(r,u){switch(r){case"compositionend":return Mf(u);case"keypress":return u.which!==32?null:(hd=!0,Uu);case"textInput":return r=u.data,r===Uu&&hd?null:r;default:return null}}function fd(r,u){if(Ql)return r==="compositionend"||!Sf&&dd(r,u)?(r=Dn(),Mo=fn=xn=null,Ql=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Af&&u.locale!=="ko"?null:u.data;default:return null}}var qp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hc(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u==="input"?!!qp[r.type]:u==="textarea"}function Hp(r,u,m,b){Wl?Ea?Ea.push(b):Ea=[b]:Wl=b,u=zm(u,"onChange"),0<u.length&&(m=new rl("onChange","change",null,m,b),r.push({event:m,listeners:u}))}var Ro=null,Xc=null;function Dg(r){Ka(r,0)}function Vu(r){var u=Bi(r);if(id(u))return r}function pd(r,u){if(r==="change")return u}var md=!1;if(Yi){var Zu;if(Yi){var gd="oninput"in document;if(!gd){var Gu=document.createElement("div");Gu.setAttribute("oninput","return;"),gd=typeof Gu.oninput=="function"}Zu=gd}else Zu=!1;md=Zu&&(!document.documentMode||9<document.documentMode)}function ss(){Ro&&(Ro.detachEvent("onpropertychange",yd),Xc=Ro=null)}function yd(r){if(r.propertyName==="value"&&Vu(Xc)){var u=[];Hp(u,Xc,r,er(r)),So(Dg,u)}}function Cf(r,u,m){r==="focusin"?(ss(),Ro=u,Xc=m,Ro.attachEvent("onpropertychange",yd)):r==="focusout"&&ss()}function Df(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Vu(Xc)}function Xp(r,u){if(r==="click")return Vu(u)}function Bn(r,u){if(r==="input"||r==="change")return Vu(u)}function Jl(r,u){return r===u&&(r!==0||1/r===1/u)||r!==r&&u!==u}var Wr=typeof Object.is=="function"?Object.is:Jl;function $u(r,u){if(Wr(r,u))return!0;if(typeof r!="object"||r===null||typeof u!="object"||u===null)return!1;var m=Object.keys(r),b=Object.keys(u);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var M=m[b];if(!yi.call(u,M)||!Wr(r[M],u[M]))return!1}return!0}function Wp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Qp(r,u){var m=Wp(r);r=0;for(var b;m;){if(m.nodeType===3){if(b=r+m.textContent.length,r<=u&&b>=u)return{node:m,offset:u-r};r=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=Wp(m)}}function Kp(r,u){return r&&u?r===u?!0:r&&r.nodeType===3?!1:u&&u.nodeType===3?Kp(r,u.parentNode):"contains"in r?r.contains(u):r.compareDocumentPosition?!!(r.compareDocumentPosition(u)&16):!1:!1}function kf(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var u=ql(r.document);u instanceof r.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)r=u.contentWindow;else break;u=ql(r.document)}return u}function If(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u&&(u==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||u==="textarea"||r.contentEditable==="true")}var Jp=Yi&&"documentMode"in document&&11>=document.documentMode,zo=null,Wc=null,sl=null,Yu=!1;function ol(r,u,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Yu||zo==null||zo!==ql(b)||(b=zo,"selectionStart"in b&&If(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),sl&&$u(sl,b)||(sl=b,b=zm(Wc,"onSelect"),0<b.length&&(u=new rl("onSelect","select",null,u,m),r.push({event:u,listeners:b}),u.target=zo)))}function Ba(r,u){var m={};return m[r.toLowerCase()]=u.toLowerCase(),m["Webkit"+r]="webkit"+u,m["Moz"+r]="moz"+u,m}var Ir={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionrun:Ba("Transition","TransitionRun"),transitionstart:Ba("Transition","TransitionStart"),transitioncancel:Ba("Transition","TransitionCancel"),transitionend:Ba("Transition","TransitionEnd")},_d={},Rf={};Yi&&(Rf=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);function Lo(r){if(_d[r])return _d[r];if(!Ir[r])return r;var u=Ir[r],m;for(m in u)if(u.hasOwnProperty(m)&&m in Rf)return _d[r]=u[m];return r}var ll=Lo("animationend"),qu=Lo("animationiteration"),Hu=Lo("animationstart"),Xu=Lo("transitionrun"),vd=Lo("transitionstart"),em=Lo("transitioncancel"),ec=Lo("transitionend"),tc=new Map,xd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xd.push("scrollEnd");function Aa(r,u){tc.set(r,u),ar(u,[r])}var zn=new WeakMap;function Qr(r,u){if(typeof r=="object"&&r!==null){var m=zn.get(r);return m!==void 0?m:(u={value:r,source:u,stack:vf(u)},zn.set(r,u),u)}return{value:r,source:u,stack:vf(u)}}var ua=[],nc=0,ic=0;function bd(){for(var r=nc,u=ic=nc=0;u<r;){var m=ua[u];ua[u++]=null;var b=ua[u];ua[u++]=null;var M=ua[u];ua[u++]=null;var z=ua[u];if(ua[u++]=null,b!==null&&M!==null){var H=b.pending;H===null?M.next=M:(M.next=H.next,H.next=M),b.pending=M}z!==0&&rc(m,M,z)}}function Wu(r,u,m,b){ua[nc++]=r,ua[nc++]=u,ua[nc++]=m,ua[nc++]=b,ic|=b,r.lanes|=b,r=r.alternate,r!==null&&(r.lanes|=b)}function wd(r,u,m,b){return Wu(r,u,m,b),cl(r)}function Qc(r,u){return Wu(r,null,null,u),cl(r)}function rc(r,u,m){r.lanes|=m;var b=r.alternate;b!==null&&(b.lanes|=m);for(var M=!1,z=r.return;z!==null;)z.childLanes|=m,b=z.alternate,b!==null&&(b.childLanes|=m),z.tag===22&&(r=z.stateNode,r===null||r._visibility&1||(M=!0)),r=z,z=z.return;return r.tag===3?(z=r.stateNode,M&&u!==null&&(M=31-Gi(m),r=z.hiddenUpdates,b=r[M],b===null?r[M]=[u]:b.push(u),u.lane=m|536870912),z):null}function cl(r){if(50<oo)throw oo=0,$d=null,Error(h(185));for(var u=r.return;u!==null;)r=u,u=r.return;return r.tag===3?r.stateNode:null}var No={};function zf(r,u,m,b){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kr(r,u,m,b){return new zf(r,u,m,b)}function Td(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Fa(r,u){var m=r.alternate;return m===null?(m=Kr(r.tag,u,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=u,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&65011712,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,u=r.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m.refCleanup=r.refCleanup,m}function Kc(r,u){r.flags&=65011714;var m=r.alternate;return m===null?(r.childLanes=0,r.lanes=u,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=m.childLanes,r.lanes=m.lanes,r.child=m.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=m.memoizedProps,r.memoizedState=m.memoizedState,r.updateQueue=m.updateQueue,r.type=m.type,u=m.dependencies,r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),r}function ac(r,u,m,b,M,z){var H=0;if(b=r,typeof r=="function")Td(r)&&(H=1);else if(typeof r=="string")H=oe(r,m,zt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Re:return r=Kr(31,m,u,M),r.elementType=Re,r.lanes=z,r;case ie:return sc(m.children,M,z,u);case me:H=8,M|=24;break;case pe:return r=Kr(12,m,u,M|2),r.elementType=pe,r.lanes=z,r;case ke:return r=Kr(13,m,u,M),r.elementType=ke,r.lanes=z,r;case Ze:return r=Kr(19,m,u,M),r.elementType=Ze,r.lanes=z,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Le:case He:H=10;break e;case Qe:H=9;break e;case $e:H=11;break e;case nt:H=14;break e;case Ke:H=16,b=null;break e}H=29,m=Error(h(130,r===null?"null":typeof r,"")),b=null}return u=Kr(H,m,u,M),u.elementType=r,u.type=b,u.lanes=z,u}function sc(r,u,m,b){return r=Kr(7,r,b,u),r.lanes=m,r}function Qu(r,u,m){return r=Kr(6,r,null,u),r.lanes=m,r}function Ed(r,u,m){return u=Kr(4,r.children!==null?r.children:[],r.key,u),u.lanes=m,u.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},u}var ul=[],$s=0,oc=null,lc=0,Jr=[],Rr=0,Ua=null,Po=1,Ys="";function ri(r,u){ul[$s++]=lc,ul[$s++]=oc,oc=r,lc=u}function hl(r,u,m){Jr[Rr++]=Po,Jr[Rr++]=Ys,Jr[Rr++]=Ua,Ua=r;var b=Po;r=Ys;var M=32-Gi(b)-1;b&=~(1<<M),m+=1;var z=32-Gi(u)+M;if(30<z){var H=M-M%5;z=(b&(1<<H)-1).toString(32),b>>=H,M-=H,Po=1<<32-Gi(u)+M|m<<M|b,Ys=z+r}else Po=1<<z|m<<M|b,Ys=r}function ha(r){r.return!==null&&(ri(r,1),hl(r,1,0))}function Ku(r){for(;r===oc;)oc=ul[--$s],ul[$s]=null,lc=ul[--$s],ul[$s]=null;for(;r===Ua;)Ua=Jr[--Rr],Jr[Rr]=null,Ys=Jr[--Rr],Jr[Rr]=null,Po=Jr[--Rr],Jr[Rr]=null}var Mr=null,Li=null,An=!1,os=null,Ma=!1,Ju=Error(h(519));function dl(r){var u=Error(h(418,""));throw Jc(Qr(u,r)),Ju}function Sd(r){var u=r.stateNode,m=r.type,b=r.memoizedProps;switch(u[$t]=r,u[jt]=b,m){case"dialog":En("cancel",u),En("close",u);break;case"iframe":case"object":case"embed":En("load",u);break;case"video":case"audio":for(m=0;m<Eh.length;m++)En(Eh[m],u);break;case"source":En("error",u);break;case"img":case"image":case"link":En("error",u),En("load",u);break;case"details":En("toggle",u);break;case"input":En("invalid",u),nl(u,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0),Pu(u);break;case"select":En("invalid",u);break;case"textarea":En("invalid",u),kn(u,b.value,b.defaultValue,b.children),Pu(u)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||b.suppressHydrationWarning===!0||fy(u.textContent,m)?(b.popover!=null&&(En("beforetoggle",u),En("toggle",u)),b.onScroll!=null&&En("scroll",u),b.onScrollEnd!=null&&En("scrollend",u),b.onClick!=null&&(u.onclick=Lm),u=!0):u=!1,u||dl(r)}function Ad(r){for(Mr=r.return;Mr;)switch(Mr.tag){case 5:case 13:Ma=!1;return;case 27:case 3:Ma=!0;return;default:Mr=Mr.return}}function qs(r){if(r!==Mr)return!1;if(!An)return Ad(r),An=!0,!1;var u=r.tag,m;if((m=u!==3&&u!==27)&&((m=u===5)&&(m=r.type,m=!(m!=="form"&&m!=="button")||py(r.type,r.memoizedProps)),m=!m),m&&Li&&dl(r),Ad(r),u===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(h(317));e:{for(r=r.nextSibling,u=0;r;){if(r.nodeType===8)if(m=r.data,m==="/$"){if(u===0){Li=ys(r.nextSibling);break e}u--}else m!=="$"&&m!=="$!"&&m!=="$?"||u++;r=r.nextSibling}Li=null}}else u===27?(u=Li,Dc(r.type)?(r=fp,fp=null,Li=r):Li=u):Li=Mr?ys(r.stateNode.nextSibling):null;return!0}function ls(){Li=Mr=null,An=!1}function Lf(){var r=os;return r!==null&&(pa===null?pa=r:pa.push.apply(pa,r),os=null),r}function Jc(r){os===null?os=[r]:os.push(r)}var Md=gt(null),fl=null,Hs=null;function Ca(r,u,m){St(Md,u._currentValue),u._currentValue=m}function da(r){r._currentValue=Md.current,kt(Md)}function Cr(r,u,m){for(;r!==null;){var b=r.alternate;if((r.childLanes&u)!==u?(r.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),r===m)break;r=r.return}}function pl(r,u,m,b){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var z=M.dependencies;if(z!==null){var H=M.child;z=z.firstContext;e:for(;z!==null;){var ae=z;z=M;for(var we=0;we<u.length;we++)if(ae.context===u[we]){z.lanes|=m,ae=z.alternate,ae!==null&&(ae.lanes|=m),Cr(z.return,m,r),b||(H=null);break e}z=ae.next}}else if(M.tag===18){if(H=M.return,H===null)throw Error(h(341));H.lanes|=m,z=H.alternate,z!==null&&(z.lanes|=m),Cr(H,m,r),H=null}else H=M.child;if(H!==null)H.return=M;else for(H=M;H!==null;){if(H===r){H=null;break}if(M=H.sibling,M!==null){M.return=H.return,H=M;break}H=H.return}M=H}}function Gr(r,u,m,b){r=null;for(var M=u,z=!1;M!==null;){if(!z){if((M.flags&524288)!==0)z=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var H=M.alternate;if(H===null)throw Error(h(387));if(H=H.memoizedProps,H!==null){var ae=M.type;Wr(M.pendingProps.value,H.value)||(r!==null?r.push(ae):r=[ae])}}else if(M===gi.current){if(H=M.alternate,H===null)throw Error(h(387));H.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push(Pt):r=[Pt])}M=M.return}r!==null&&pl(u,r,m,b),u.flags|=262144}function Da(r){for(r=r.firstContext;r!==null;){if(!Wr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ml(r){fl=r,Hs=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function ei(r){return Cd(fl,r)}function Xs(r,u){return fl===null&&ml(r),Cd(r,u)}function Cd(r,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},Hs===null){if(r===null)throw Error(h(308));Hs=u,r.dependencies={lanes:0,firstContext:u},r.flags|=524288}else Hs=Hs.next=u;return m}var kg=typeof AbortController<"u"?AbortController:function(){var r=[],u=this.signal={aborted:!1,addEventListener:function(m,b){r.push(b)}};this.abort=function(){u.aborted=!0,r.forEach(function(m){return m()})}},Nf=i.unstable_scheduleCallback,Ig=i.unstable_NormalPriority,Ni={$$typeof:He,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cc(){return{controller:new kg,data:new Map,refCount:0}}function zr(r){r.refCount--,r.refCount===0&&Nf(Ig,function(){r.controller.abort()})}var Lt=null,Dd=0,cs=0,uc=null;function hc(r,u){if(Lt===null){var m=Lt=[];Dd=0,cs=Cm(),uc={status:"pending",value:void 0,then:function(b){m.push(b)}}}return Dd++,u.then(Oo,Oo),u}function Oo(){if(--Dd===0&&Lt!==null){uc!==null&&(uc.status="fulfilled");var r=Lt;Lt=null,cs=0,uc=null;for(var u=0;u<r.length;u++)(0,r[u])()}}function Pf(r,u){var m=[],b={status:"pending",value:null,reason:null,then:function(M){m.push(M)}};return r.then(function(){b.status="fulfilled",b.value=u;for(var M=0;M<m.length;M++)(0,m[M])(u)},function(M){for(b.status="rejected",b.reason=M,M=0;M<m.length;M++)(0,m[M])(void 0)}),b}var bn=Oe.S;Oe.S=function(r,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&hc(r,u),bn!==null&&bn(r,u)};var Ws=gt(null);function kd(){var r=Ws.current;return r!==null?r:Ii.pooledCache}function gl(r,u){u===null?St(Ws,Ws.current):St(Ws,u.pool)}function Of(){var r=kd();return r===null?null:{parent:Ni._currentValue,pool:r}}var eh=Error(h(460)),Id=Error(h(474)),eu=Error(h(542)),th={then:function(){}};function jf(r){return r=r.status,r==="fulfilled"||r==="rejected"}function tu(){}function tm(r,u,m){switch(m=r[m],m===void 0?r.push(u):m!==u&&(u.then(tu,tu),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,ci(r),r;default:if(typeof u.status=="string")u.then(tu,tu);else{if(r=Ii,r!==null&&100<r.shellSuspendCounter)throw Error(h(482));r=u,r.status="pending",r.then(function(b){if(u.status==="pending"){var M=u;M.status="fulfilled",M.value=b}},function(b){if(u.status==="pending"){var M=u;M.status="rejected",M.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,ci(r),r}throw nh=u,eh}}var nh=null;function Qs(){if(nh===null)throw Error(h(459));var r=nh;return nh=null,r}function ci(r){if(r===eh||r===eu)throw Error(h(483))}var Va=!1;function nu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function dc(r,u){r=r.updateQueue,u.updateQueue===r&&(u.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function jo(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function us(r,u,m){var b=r.updateQueue;if(b===null)return null;if(b=b.shared,(si&2)!==0){var M=b.pending;return M===null?u.next=u:(u.next=M.next,M.next=u),b.pending=u,u=cl(r),rc(r,null,m),u}return Wu(r,b,u,m),cl(r)}function ih(r,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194048)!==0)){var b=u.lanes;b&=r.pendingLanes,m|=b,u.lanes=m,Je(r,m)}}function Za(r,u){var m=r.updateQueue,b=r.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var M=null,z=null;if(m=m.firstBaseUpdate,m!==null){do{var H={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};z===null?M=z=H:z=z.next=H,m=m.next}while(m!==null);z===null?M=z=u:z=z.next=u}else M=z=u;m={baseState:b.baseState,firstBaseUpdate:M,lastBaseUpdate:z,shared:b.shared,callbacks:b.callbacks},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=u:r.next=u,m.lastBaseUpdate=u}var fc=!1;function Zt(){if(fc){var r=uc;if(r!==null)throw r}}function Ht(r,u,m,b){fc=!1;var M=r.updateQueue;Va=!1;var z=M.firstBaseUpdate,H=M.lastBaseUpdate,ae=M.shared.pending;if(ae!==null){M.shared.pending=null;var we=ae,Ye=we.next;we.next=null,H===null?z=Ye:H.next=Ye,H=we;var ct=r.alternate;ct!==null&&(ct=ct.updateQueue,ae=ct.lastBaseUpdate,ae!==H&&(ae===null?ct.firstBaseUpdate=Ye:ae.next=Ye,ct.lastBaseUpdate=we))}if(z!==null){var xt=M.baseState;H=0,ct=Ye=we=null,ae=z;do{var We=ae.lane&-536870913,et=We!==ae.lane;if(et?(Pn&We)===We:(b&We)===We){We!==0&&We===cs&&(fc=!0),ct!==null&&(ct=ct.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var un=r,ln=ae;We=u;var _n=m;switch(ln.tag){case 1:if(un=ln.payload,typeof un=="function"){xt=un.call(_n,xt,We);break e}xt=un;break e;case 3:un.flags=un.flags&-65537|128;case 0:if(un=ln.payload,We=typeof un=="function"?un.call(_n,xt,We):un,We==null)break e;xt=P({},xt,We);break e;case 2:Va=!0}}We=ae.callback,We!==null&&(r.flags|=64,et&&(r.flags|=8192),et=M.callbacks,et===null?M.callbacks=[We]:et.push(We))}else et={lane:We,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},ct===null?(Ye=ct=et,we=xt):ct=ct.next=et,H|=We;if(ae=ae.next,ae===null){if(ae=M.shared.pending,ae===null)break;et=ae,ae=et.next,et.next=null,M.lastBaseUpdate=et,M.shared.pending=null}}while(!0);ct===null&&(we=xt),M.baseState=we,M.firstBaseUpdate=Ye,M.lastBaseUpdate=ct,z===null&&(M.shared.lanes=0),uu|=H,r.lanes=H,r.memoizedState=xt}}function rh(r,u){if(typeof r!="function")throw Error(h(191,r));r.call(u)}function Rd(r,u){var m=r.callbacks;if(m!==null)for(r.callbacks=null,r=0;r<m.length;r++)rh(m[r],u)}var yl=gt(null),Lr=gt(0);function Bf(r,u){r=Cl,St(Lr,r),St(yl,u),Cl=r|u.baseLanes}function Nr(){St(Lr,Cl),St(yl,yl.current)}function Ff(){Cl=Lr.current,kt(yl),kt(Lr)}var Ga=0,Kt=null,on=null,tr=null,_l=!1,ea=!1,Ks=!1,vl=0,xl=0,$a=null,Uf=0;function vi(){throw Error(h(321))}function Bo(r,u){if(u===null)return!1;for(var m=0;m<u.length&&m<r.length;m++)if(!Wr(r[m],u[m]))return!1;return!0}function ah(r,u,m,b,M,z){return Ga=z,Kt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Oe.H=r===null||r.memoizedState===null?nm:Gf,Ks=!1,z=m(b,M),Ks=!1,ea&&(z=bl(u,m,b,M)),sh(r),z}function sh(r){Oe.H=no;var u=on!==null&&on.next!==null;if(Ga=0,tr=on=Kt=null,_l=!1,xl=0,$a=null,u)throw Error(h(300));r===null||Pr||(r=r.dependencies,r!==null&&Da(r)&&(Pr=!0))}function bl(r,u,m,b){Kt=r;var M=0;do{if(ea&&($a=null),xl=0,ea=!1,25<=M)throw Error(h(301));if(M+=1,tr=on=null,r.updateQueue!=null){var z=r.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}Oe.H=$f,z=u(m,b)}while(ea);return z}function Vf(){var r=Oe.H,u=r.useState()[0];return u=typeof u.then=="function"?f(u):u,r=r.useState()[0],(on!==null?on.memoizedState:null)!==r&&(Kt.flags|=1024),u}function oh(){var r=vl!==0;return vl=0,r}function pc(r,u,m){u.updateQueue=r.updateQueue,u.flags&=-2053,r.lanes&=~m}function lh(r){if(_l){for(r=r.memoizedState;r!==null;){var u=r.queue;u!==null&&(u.pending=null),r=r.next}_l=!1}Ga=0,tr=on=Kt=null,ea=!1,xl=vl=0,$a=null}function x(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tr===null?Kt.memoizedState=tr=r:tr=tr.next=r,tr}function e(){if(on===null){var r=Kt.alternate;r=r!==null?r.memoizedState:null}else r=on.next;var u=tr===null?Kt.memoizedState:tr.next;if(u!==null)tr=u,on=r;else{if(r===null)throw Kt.alternate===null?Error(h(467)):Error(h(310));on=r,r={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},tr===null?Kt.memoizedState=tr=r:tr=tr.next=r}return tr}function s(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function f(r){var u=xl;return xl+=1,$a===null&&($a=[]),r=tm($a,r,u),u=Kt,(tr===null?u.memoizedState:tr.next)===null&&(u=u.alternate,Oe.H=u===null||u.memoizedState===null?nm:Gf),r}function g(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return f(r);if(r.$$typeof===He)return ei(r)}throw Error(h(438,String(r)))}function w(r){var u=null,m=Kt.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var b=Kt.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(M){return M.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=s(),Kt.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(r),b=0;b<r;b++)m[b]=_t;return u.index++,m}function S(r,u){return typeof u=="function"?u(r):u}function D(r){var u=e();return R(u,on,r)}function R(r,u,m){var b=r.queue;if(b===null)throw Error(h(311));b.lastRenderedReducer=m;var M=r.baseQueue,z=b.pending;if(z!==null){if(M!==null){var H=M.next;M.next=z.next,z.next=H}u.baseQueue=M=z,b.pending=null}if(z=r.baseState,M===null)r.memoizedState=z;else{u=M.next;var ae=H=null,we=null,Ye=u,ct=!1;do{var xt=Ye.lane&-536870913;if(xt!==Ye.lane?(Pn&xt)===xt:(Ga&xt)===xt){var We=Ye.revertLane;if(We===0)we!==null&&(we=we.next={lane:0,revertLane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),xt===cs&&(ct=!0);else if((Ga&We)===We){Ye=Ye.next,We===cs&&(ct=!0);continue}else xt={lane:0,revertLane:Ye.revertLane,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},we===null?(ae=we=xt,H=z):we=we.next=xt,Kt.lanes|=We,uu|=We;xt=Ye.action,Ks&&m(z,xt),z=Ye.hasEagerState?Ye.eagerState:m(z,xt)}else We={lane:xt,revertLane:Ye.revertLane,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},we===null?(ae=we=We,H=z):we=we.next=We,Kt.lanes|=xt,uu|=xt;Ye=Ye.next}while(Ye!==null&&Ye!==u);if(we===null?H=z:we.next=ae,!Wr(z,r.memoizedState)&&(Pr=!0,ct&&(m=uc,m!==null)))throw m;r.memoizedState=z,r.baseState=H,r.baseQueue=we,b.lastRenderedState=z}return M===null&&(b.lanes=0),[r.memoizedState,b.dispatch]}function N(r){var u=e(),m=u.queue;if(m===null)throw Error(h(311));m.lastRenderedReducer=r;var b=m.dispatch,M=m.pending,z=u.memoizedState;if(M!==null){m.pending=null;var H=M=M.next;do z=r(z,H.action),H=H.next;while(H!==M);Wr(z,u.memoizedState)||(Pr=!0),u.memoizedState=z,u.baseQueue===null&&(u.baseState=z),m.lastRenderedState=z}return[z,b]}function F(r,u,m){var b=Kt,M=e(),z=An;if(z){if(m===void 0)throw Error(h(407));m=m()}else m=u();var H=!Wr((on||M).memoizedState,m);H&&(M.memoizedState=m,Pr=!0),M=M.queue;var ae=K.bind(null,b,M,r);if(In(2048,8,ae,[r]),M.getSnapshot!==u||H||tr!==null&&tr.memoizedState.tag&1){if(b.flags|=2048,Et(9,ut(),Z.bind(null,b,M,m,u),null),Ii===null)throw Error(h(349));z||(Ga&124)!==0||G(b,u,m)}return m}function G(r,u,m){r.flags|=16384,r={getSnapshot:u,value:m},u=Kt.updateQueue,u===null?(u=s(),Kt.updateQueue=u,u.stores=[r]):(m=u.stores,m===null?u.stores=[r]:m.push(r))}function Z(r,u,m,b){u.value=m,u.getSnapshot=b,te(u)&&he(r)}function K(r,u,m){return m(function(){te(u)&&he(r)})}function te(r){var u=r.getSnapshot;r=r.value;try{var m=u();return!Wr(r,m)}catch{return!0}}function he(r){var u=Qc(r,2);u!==null&&ma(u,r,2)}function ue(r){var u=x();if(typeof r=="function"){var m=r;if(r=m(),Ks){pr(!0);try{m()}finally{pr(!1)}}}return u.memoizedState=u.baseState=r,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:r},u}function de(r,u,m,b){return r.baseState=m,R(r,on,typeof b=="function"?b:S)}function ge(r,u,m,b,M){if(qn(r))throw Error(h(485));if(r=u.action,r!==null){var z={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){z.listeners.push(H)}};Oe.T!==null?m(!0):z.isTransition=!1,b(z),m=u.pending,m===null?(z.next=u.pending=z,xe(u,z)):(z.next=m.next,u.pending=m.next=z)}}function xe(r,u){var m=u.action,b=u.payload,M=r.state;if(u.isTransition){var z=Oe.T,H={};Oe.T=H;try{var ae=m(M,b),we=Oe.S;we!==null&&we(H,ae),be(r,u,ae)}catch(Ye){De(r,u,Ye)}finally{Oe.T=z}}else try{z=m(M,b),be(r,u,z)}catch(Ye){De(r,u,Ye)}}function be(r,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){Te(r,u,b)},function(b){return De(r,u,b)}):Te(r,u,m)}function Te(r,u,m){u.status="fulfilled",u.value=m,Me(u),r.state=m,u=r.pending,u!==null&&(m=u.next,m===u?r.pending=null:(m=m.next,u.next=m,xe(r,m)))}function De(r,u,m){var b=r.pending;if(r.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=m,Me(u),u=u.next;while(u!==b)}r.action=null}function Me(r){r=r.listeners;for(var u=0;u<r.length;u++)(0,r[u])()}function Ge(r,u){return u}function Ue(r,u){if(An){var m=Ii.formState;if(m!==null){e:{var b=Kt;if(An){if(Li){t:{for(var M=Li,z=Ma;M.nodeType!==8;){if(!z){M=null;break t}if(M=ys(M.nextSibling),M===null){M=null;break t}}z=M.data,M=z==="F!"||z==="F"?M:null}if(M){Li=ys(M.nextSibling),b=M.data==="F!";break e}}dl(b)}b=!1}b&&(u=m[0])}}return m=x(),m.memoizedState=m.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ge,lastRenderedState:u},m.queue=b,m=Pi.bind(null,Kt,b),b.dispatch=m,b=ue(!1),z=qi.bind(null,Kt,!1,b.queue),b=x(),M={state:u,dispatch:null,action:r,pending:null},b.queue=M,m=ge.bind(null,Kt,M,z,m),M.dispatch=m,b.memoizedState=r,[u,m,!1]}function at(r){var u=e();return st(u,on,r)}function st(r,u,m){if(u=R(r,u,Ge)[0],r=D(S)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=f(u)}catch(H){throw H===eh?eu:H}else b=u;u=e();var M=u.queue,z=M.dispatch;return m!==u.memoizedState&&(Kt.flags|=2048,Et(9,ut(),it.bind(null,M,m),null)),[b,z,r]}function it(r,u){r.action=u}function At(r){var u=e(),m=on;if(m!==null)return st(u,m,r);e(),u=u.memoizedState,m=e();var b=m.queue.dispatch;return m.memoizedState=r,[u,b,!1]}function Et(r,u,m,b){return r={tag:r,create:m,deps:b,inst:u,next:null},u=Kt.updateQueue,u===null&&(u=s(),Kt.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=r.next=r:(b=m.next,m.next=r,r.next=b,u.lastEffect=r),r}function ut(){return{destroy:void 0,resource:void 0}}function Ft(){return e().memoizedState}function cn(r,u,m,b){var M=x();b=b===void 0?null:b,Kt.flags|=r,M.memoizedState=Et(1|u,ut(),m,b)}function In(r,u,m,b){var M=e();b=b===void 0?null:b;var z=M.memoizedState.inst;on!==null&&b!==null&&Bo(b,on.memoizedState.deps)?M.memoizedState=Et(u,z,m,b):(Kt.flags|=r,M.memoizedState=Et(1|u,z,m,b))}function pn(r,u){cn(8390656,8,r,u)}function Xn(r,u){In(2048,8,r,u)}function ai(r,u){return In(4,2,r,u)}function ui(r,u){return In(4,4,r,u)}function Yn(r,u){if(typeof u=="function"){r=r();var m=u(r);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return r=r(),u.current=r,function(){u.current=null}}function Wn(r,u,m){m=m!=null?m.concat([r]):null,In(4,4,Yn.bind(null,u,r),m)}function Fi(){}function lr(r,u){var m=e();u=u===void 0?null:u;var b=m.memoizedState;return u!==null&&Bo(u,b[1])?b[0]:(m.memoizedState=[r,u],r)}function gr(r,u){var m=e();u=u===void 0?null:u;var b=m.memoizedState;if(u!==null&&Bo(u,b[1]))return b[0];if(b=r(),Ks){pr(!0);try{r()}finally{pr(!1)}}return m.memoizedState=[b,u],b}function $r(r,u,m){return m===void 0||(Ga&1073741824)!==0?r.memoizedState=u:(r.memoizedState=m,r=xh(),Kt.lanes|=r,uu|=r,m)}function Js(r,u,m,b){return Wr(m,u)?m:yl.current!==null?(r=$r(r,m,b),Wr(r,u)||(Pr=!0),r):(Ga&42)===0?(Pr=!0,r.memoizedState=m):(r=xh(),Kt.lanes|=r,uu|=r,u)}function hs(r,u,m,b,M){var z=vt.p;vt.p=z!==0&&8>z?z:8;var H=Oe.T,ae={};Oe.T=ae,qi(r,!1,u,m);try{var we=M(),Ye=Oe.S;if(Ye!==null&&Ye(ae,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var ct=Pf(we,b);hi(r,u,ct,ia(r))}else hi(r,u,b,ia(r))}catch(xt){hi(r,u,{then:function(){},status:"rejected",reason:xt},ia())}finally{vt.p=z,Oe.T=H}}function wl(){}function eo(r,u,m,b){if(r.tag!==5)throw Error(h(476));var M=Tl(r).queue;hs(r,M,u,mt,m===null?wl:function(){return ds(r),m(b)})}function Tl(r){var u=r.memoizedState;if(u!==null)return u;u={memoizedState:mt,baseState:mt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:mt},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:m},next:null},r.memoizedState=u,r=r.alternate,r!==null&&(r.memoizedState=u),u}function ds(r){var u=Tl(r).next.queue;hi(r,u,{},ia())}function fs(){return ei(Pt)}function fa(){return e().memoizedState}function to(){return e().memoizedState}function mc(r){for(var u=r.return;u!==null;){switch(u.tag){case 24:case 3:var m=ia();r=jo(m);var b=us(u,r,m);b!==null&&(ma(b,u,m),ih(b,u,m)),u={cache:cc()},r.payload=u;return}u=u.return}}function gc(r,u,m){var b=ia();m={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},qn(r)?Fo(u,m):(m=wd(r,u,m,b),m!==null&&(ma(m,r,b),Zf(m,u,b)))}function Pi(r,u,m){var b=ia();hi(r,u,m,b)}function hi(r,u,m,b){var M={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(qn(r))Fo(u,M);else{var z=r.alternate;if(r.lanes===0&&(z===null||z.lanes===0)&&(z=u.lastRenderedReducer,z!==null))try{var H=u.lastRenderedState,ae=z(H,m);if(M.hasEagerState=!0,M.eagerState=ae,Wr(ae,H))return Wu(r,u,M,0),Ii===null&&bd(),!1}catch{}finally{}if(m=wd(r,u,M,b),m!==null)return ma(m,r,b),Zf(m,u,b),!0}return!1}function qi(r,u,m,b){if(b={lane:2,revertLane:Cm(),action:b,hasEagerState:!1,eagerState:null,next:null},qn(r)){if(u)throw Error(h(479))}else u=wd(r,m,b,2),u!==null&&ma(u,r,2)}function qn(r){var u=r.alternate;return r===Kt||u!==null&&u===Kt}function Fo(r,u){ea=_l=!0;var m=r.pending;m===null?u.next=u:(u.next=m.next,m.next=u),r.pending=u}function Zf(r,u,m){if((m&4194048)!==0){var b=u.lanes;b&=r.pendingLanes,m|=b,u.lanes=m,Je(r,m)}}var no={readContext:ei,use:g,useCallback:vi,useContext:vi,useEffect:vi,useImperativeHandle:vi,useLayoutEffect:vi,useInsertionEffect:vi,useMemo:vi,useReducer:vi,useRef:vi,useState:vi,useDebugValue:vi,useDeferredValue:vi,useTransition:vi,useSyncExternalStore:vi,useId:vi,useHostTransitionStatus:vi,useFormState:vi,useActionState:vi,useOptimistic:vi,useMemoCache:vi,useCacheRefresh:vi},nm={readContext:ei,use:g,useCallback:function(r,u){return x().memoizedState=[r,u===void 0?null:u],r},useContext:ei,useEffect:pn,useImperativeHandle:function(r,u,m){m=m!=null?m.concat([r]):null,cn(4194308,4,Yn.bind(null,u,r),m)},useLayoutEffect:function(r,u){return cn(4194308,4,r,u)},useInsertionEffect:function(r,u){cn(4,2,r,u)},useMemo:function(r,u){var m=x();u=u===void 0?null:u;var b=r();if(Ks){pr(!0);try{r()}finally{pr(!1)}}return m.memoizedState=[b,u],b},useReducer:function(r,u,m){var b=x();if(m!==void 0){var M=m(u);if(Ks){pr(!0);try{m(u)}finally{pr(!1)}}}else M=u;return b.memoizedState=b.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},b.queue=r,r=r.dispatch=gc.bind(null,Kt,r),[b.memoizedState,r]},useRef:function(r){var u=x();return r={current:r},u.memoizedState=r},useState:function(r){r=ue(r);var u=r.queue,m=Pi.bind(null,Kt,u);return u.dispatch=m,[r.memoizedState,m]},useDebugValue:Fi,useDeferredValue:function(r,u){var m=x();return $r(m,r,u)},useTransition:function(){var r=ue(!1);return r=hs.bind(null,Kt,r.queue,!0,!1),x().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,u,m){var b=Kt,M=x();if(An){if(m===void 0)throw Error(h(407));m=m()}else{if(m=u(),Ii===null)throw Error(h(349));(Pn&124)!==0||G(b,u,m)}M.memoizedState=m;var z={value:m,getSnapshot:u};return M.queue=z,pn(K.bind(null,b,z,r),[r]),b.flags|=2048,Et(9,ut(),Z.bind(null,b,z,m,u),null),m},useId:function(){var r=x(),u=Ii.identifierPrefix;if(An){var m=Ys,b=Po;m=(b&~(1<<32-Gi(b)-1)).toString(32)+m,u=""+u+"R"+m,m=vl++,0<m&&(u+="H"+m.toString(32)),u+=""}else m=Uf++,u=""+u+"r"+m.toString(32)+"";return r.memoizedState=u},useHostTransitionStatus:fs,useFormState:Ue,useActionState:Ue,useOptimistic:function(r){var u=x();u.memoizedState=u.baseState=r;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=qi.bind(null,Kt,!0,m),m.dispatch=u,[r,u]},useMemoCache:w,useCacheRefresh:function(){return x().memoizedState=mc.bind(null,Kt)}},Gf={readContext:ei,use:g,useCallback:lr,useContext:ei,useEffect:Xn,useImperativeHandle:Wn,useInsertionEffect:ai,useLayoutEffect:ui,useMemo:gr,useReducer:D,useRef:Ft,useState:function(){return D(S)},useDebugValue:Fi,useDeferredValue:function(r,u){var m=e();return Js(m,on.memoizedState,r,u)},useTransition:function(){var r=D(S)[0],u=e().memoizedState;return[typeof r=="boolean"?r:f(r),u]},useSyncExternalStore:F,useId:fa,useHostTransitionStatus:fs,useFormState:at,useActionState:at,useOptimistic:function(r,u){var m=e();return de(m,on,r,u)},useMemoCache:w,useCacheRefresh:to},$f={readContext:ei,use:g,useCallback:lr,useContext:ei,useEffect:Xn,useImperativeHandle:Wn,useInsertionEffect:ai,useLayoutEffect:ui,useMemo:gr,useReducer:N,useRef:Ft,useState:function(){return N(S)},useDebugValue:Fi,useDeferredValue:function(r,u){var m=e();return on===null?$r(m,r,u):Js(m,on.memoizedState,r,u)},useTransition:function(){var r=N(S)[0],u=e().memoizedState;return[typeof r=="boolean"?r:f(r),u]},useSyncExternalStore:F,useId:fa,useHostTransitionStatus:fs,useFormState:At,useActionState:At,useOptimistic:function(r,u){var m=e();return on!==null?de(m,on,r,u):(m.baseState=r,[r,m.queue.dispatch])},useMemoCache:w,useCacheRefresh:to},ka=null,Ya=0;function ps(r){var u=Ya;return Ya+=1,ka===null&&(ka=[]),tm(ka,r,u)}function yc(r,u){u=u.props.ref,r.ref=u!==void 0?u:null}function iu(r,u){throw u.$$typeof===j?Error(h(525)):(r=Object.prototype.toString.call(u),Error(h(31,r==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":r)))}function ch(r){var u=r._init;return u(r._payload)}function uh(r){function u(Pe,Ie){if(r){var Fe=Pe.deletions;Fe===null?(Pe.deletions=[Ie],Pe.flags|=16):Fe.push(Ie)}}function m(Pe,Ie){if(!r)return null;for(;Ie!==null;)u(Pe,Ie),Ie=Ie.sibling;return null}function b(Pe){for(var Ie=new Map;Pe!==null;)Pe.key!==null?Ie.set(Pe.key,Pe):Ie.set(Pe.index,Pe),Pe=Pe.sibling;return Ie}function M(Pe,Ie){return Pe=Fa(Pe,Ie),Pe.index=0,Pe.sibling=null,Pe}function z(Pe,Ie,Fe){return Pe.index=Fe,r?(Fe=Pe.alternate,Fe!==null?(Fe=Fe.index,Fe<Ie?(Pe.flags|=67108866,Ie):Fe):(Pe.flags|=67108866,Ie)):(Pe.flags|=1048576,Ie)}function H(Pe){return r&&Pe.alternate===null&&(Pe.flags|=67108866),Pe}function ae(Pe,Ie,Fe,dt){return Ie===null||Ie.tag!==6?(Ie=Qu(Fe,Pe.mode,dt),Ie.return=Pe,Ie):(Ie=M(Ie,Fe),Ie.return=Pe,Ie)}function we(Pe,Ie,Fe,dt){var Ut=Fe.type;return Ut===ie?ct(Pe,Ie,Fe.props.children,dt,Fe.key):Ie!==null&&(Ie.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===Ke&&ch(Ut)===Ie.type)?(Ie=M(Ie,Fe.props),yc(Ie,Fe),Ie.return=Pe,Ie):(Ie=ac(Fe.type,Fe.key,Fe.props,null,Pe.mode,dt),yc(Ie,Fe),Ie.return=Pe,Ie)}function Ye(Pe,Ie,Fe,dt){return Ie===null||Ie.tag!==4||Ie.stateNode.containerInfo!==Fe.containerInfo||Ie.stateNode.implementation!==Fe.implementation?(Ie=Ed(Fe,Pe.mode,dt),Ie.return=Pe,Ie):(Ie=M(Ie,Fe.children||[]),Ie.return=Pe,Ie)}function ct(Pe,Ie,Fe,dt,Ut){return Ie===null||Ie.tag!==7?(Ie=sc(Fe,Pe.mode,dt,Ut),Ie.return=Pe,Ie):(Ie=M(Ie,Fe),Ie.return=Pe,Ie)}function xt(Pe,Ie,Fe){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return Ie=Qu(""+Ie,Pe.mode,Fe),Ie.return=Pe,Ie;if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case U:return Fe=ac(Ie.type,Ie.key,Ie.props,null,Pe.mode,Fe),yc(Fe,Ie),Fe.return=Pe,Fe;case V:return Ie=Ed(Ie,Pe.mode,Fe),Ie.return=Pe,Ie;case Ke:var dt=Ie._init;return Ie=dt(Ie._payload),xt(Pe,Ie,Fe)}if(dn(Ie)||Ot(Ie))return Ie=sc(Ie,Pe.mode,Fe,null),Ie.return=Pe,Ie;if(typeof Ie.then=="function")return xt(Pe,ps(Ie),Fe);if(Ie.$$typeof===He)return xt(Pe,Xs(Pe,Ie),Fe);iu(Pe,Ie)}return null}function We(Pe,Ie,Fe,dt){var Ut=Ie!==null?Ie.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return Ut!==null?null:ae(Pe,Ie,""+Fe,dt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case U:return Fe.key===Ut?we(Pe,Ie,Fe,dt):null;case V:return Fe.key===Ut?Ye(Pe,Ie,Fe,dt):null;case Ke:return Ut=Fe._init,Fe=Ut(Fe._payload),We(Pe,Ie,Fe,dt)}if(dn(Fe)||Ot(Fe))return Ut!==null?null:ct(Pe,Ie,Fe,dt,null);if(typeof Fe.then=="function")return We(Pe,Ie,ps(Fe),dt);if(Fe.$$typeof===He)return We(Pe,Ie,Xs(Pe,Fe),dt);iu(Pe,Fe)}return null}function et(Pe,Ie,Fe,dt,Ut){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return Pe=Pe.get(Fe)||null,ae(Ie,Pe,""+dt,Ut);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case U:return Pe=Pe.get(dt.key===null?Fe:dt.key)||null,we(Ie,Pe,dt,Ut);case V:return Pe=Pe.get(dt.key===null?Fe:dt.key)||null,Ye(Ie,Pe,dt,Ut);case Ke:var Fn=dt._init;return dt=Fn(dt._payload),et(Pe,Ie,Fe,dt,Ut)}if(dn(dt)||Ot(dt))return Pe=Pe.get(Fe)||null,ct(Ie,Pe,dt,Ut,null);if(typeof dt.then=="function")return et(Pe,Ie,Fe,ps(dt),Ut);if(dt.$$typeof===He)return et(Pe,Ie,Fe,Xs(Ie,dt),Ut);iu(Ie,dt)}return null}function un(Pe,Ie,Fe,dt){for(var Ut=null,Fn=null,an=Ie,hn=Ie=0,ya=null;an!==null&&hn<Fe.length;hn++){an.index>hn?(ya=an,an=null):ya=an.sibling;var oi=We(Pe,an,Fe[hn],dt);if(oi===null){an===null&&(an=ya);break}r&&an&&oi.alternate===null&&u(Pe,an),Ie=z(oi,Ie,hn),Fn===null?Ut=oi:Fn.sibling=oi,Fn=oi,an=ya}if(hn===Fe.length)return m(Pe,an),An&&ri(Pe,hn),Ut;if(an===null){for(;hn<Fe.length;hn++)an=xt(Pe,Fe[hn],dt),an!==null&&(Ie=z(an,Ie,hn),Fn===null?Ut=an:Fn.sibling=an,Fn=an);return An&&ri(Pe,hn),Ut}for(an=b(an);hn<Fe.length;hn++)ya=et(an,Pe,hn,Fe[hn],dt),ya!==null&&(r&&ya.alternate!==null&&an.delete(ya.key===null?hn:ya.key),Ie=z(ya,Ie,hn),Fn===null?Ut=ya:Fn.sibling=ya,Fn=ya);return r&&an.forEach(function(Kd){return u(Pe,Kd)}),An&&ri(Pe,hn),Ut}function ln(Pe,Ie,Fe,dt){if(Fe==null)throw Error(h(151));for(var Ut=null,Fn=null,an=Ie,hn=Ie=0,ya=null,oi=Fe.next();an!==null&&!oi.done;hn++,oi=Fe.next()){an.index>hn?(ya=an,an=null):ya=an.sibling;var Kd=We(Pe,an,oi.value,dt);if(Kd===null){an===null&&(an=ya);break}r&&an&&Kd.alternate===null&&u(Pe,an),Ie=z(Kd,Ie,hn),Fn===null?Ut=Kd:Fn.sibling=Kd,Fn=Kd,an=ya}if(oi.done)return m(Pe,an),An&&ri(Pe,hn),Ut;if(an===null){for(;!oi.done;hn++,oi=Fe.next())oi=xt(Pe,oi.value,dt),oi!==null&&(Ie=z(oi,Ie,hn),Fn===null?Ut=oi:Fn.sibling=oi,Fn=oi);return An&&ri(Pe,hn),Ut}for(an=b(an);!oi.done;hn++,oi=Fe.next())oi=et(an,Pe,hn,oi.value,dt),oi!==null&&(r&&oi.alternate!==null&&an.delete(oi.key===null?hn:oi.key),Ie=z(oi,Ie,hn),Fn===null?Ut=oi:Fn.sibling=oi,Fn=oi);return r&&an.forEach(function(JE){return u(Pe,JE)}),An&&ri(Pe,hn),Ut}function _n(Pe,Ie,Fe,dt){if(typeof Fe=="object"&&Fe!==null&&Fe.type===ie&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case U:e:{for(var Ut=Fe.key;Ie!==null;){if(Ie.key===Ut){if(Ut=Fe.type,Ut===ie){if(Ie.tag===7){m(Pe,Ie.sibling),dt=M(Ie,Fe.props.children),dt.return=Pe,Pe=dt;break e}}else if(Ie.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===Ke&&ch(Ut)===Ie.type){m(Pe,Ie.sibling),dt=M(Ie,Fe.props),yc(dt,Fe),dt.return=Pe,Pe=dt;break e}m(Pe,Ie);break}else u(Pe,Ie);Ie=Ie.sibling}Fe.type===ie?(dt=sc(Fe.props.children,Pe.mode,dt,Fe.key),dt.return=Pe,Pe=dt):(dt=ac(Fe.type,Fe.key,Fe.props,null,Pe.mode,dt),yc(dt,Fe),dt.return=Pe,Pe=dt)}return H(Pe);case V:e:{for(Ut=Fe.key;Ie!==null;){if(Ie.key===Ut)if(Ie.tag===4&&Ie.stateNode.containerInfo===Fe.containerInfo&&Ie.stateNode.implementation===Fe.implementation){m(Pe,Ie.sibling),dt=M(Ie,Fe.children||[]),dt.return=Pe,Pe=dt;break e}else{m(Pe,Ie);break}else u(Pe,Ie);Ie=Ie.sibling}dt=Ed(Fe,Pe.mode,dt),dt.return=Pe,Pe=dt}return H(Pe);case Ke:return Ut=Fe._init,Fe=Ut(Fe._payload),_n(Pe,Ie,Fe,dt)}if(dn(Fe))return un(Pe,Ie,Fe,dt);if(Ot(Fe)){if(Ut=Ot(Fe),typeof Ut!="function")throw Error(h(150));return Fe=Ut.call(Fe),ln(Pe,Ie,Fe,dt)}if(typeof Fe.then=="function")return _n(Pe,Ie,ps(Fe),dt);if(Fe.$$typeof===He)return _n(Pe,Ie,Xs(Pe,Fe),dt);iu(Pe,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint"?(Fe=""+Fe,Ie!==null&&Ie.tag===6?(m(Pe,Ie.sibling),dt=M(Ie,Fe),dt.return=Pe,Pe=dt):(m(Pe,Ie),dt=Qu(Fe,Pe.mode,dt),dt.return=Pe,Pe=dt),H(Pe)):m(Pe,Ie)}return function(Pe,Ie,Fe,dt){try{Ya=0;var Ut=_n(Pe,Ie,Fe,dt);return ka=null,Ut}catch(an){if(an===eh||an===eu)throw an;var Fn=Kr(29,an,null,Pe.mode);return Fn.lanes=dt,Fn.return=Pe,Fn}finally{}}}var zd=uh(!0),Rg=uh(!1),io=gt(null),ro=null;function ru(r){var u=r.alternate;St(Ui,Ui.current&1),St(io,r),ro===null&&(u===null||yl.current!==null||u.memoizedState!==null)&&(ro=r)}function im(r){if(r.tag===22){if(St(Ui,Ui.current),St(io,r),ro===null){var u=r.alternate;u!==null&&u.memoizedState!==null&&(ro=r)}}else _c()}function _c(){St(Ui,Ui.current),St(io,io.current)}function El(r){kt(io),ro===r&&(ro=null),kt(Ui)}var Ui=gt(0);function rm(r){for(var u=r;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||_y(m)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function hh(r,u,m,b){u=r.memoizedState,m=m(b,u),m=m==null?u:P({},u,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Ld={enqueueSetState:function(r,u,m){r=r._reactInternals;var b=ia(),M=jo(b);M.payload=u,m!=null&&(M.callback=m),u=us(r,M,b),u!==null&&(ma(u,r,b),ih(u,r,b))},enqueueReplaceState:function(r,u,m){r=r._reactInternals;var b=ia(),M=jo(b);M.tag=1,M.payload=u,m!=null&&(M.callback=m),u=us(r,M,b),u!==null&&(ma(u,r,b),ih(u,r,b))},enqueueForceUpdate:function(r,u){r=r._reactInternals;var m=ia(),b=jo(m);b.tag=2,u!=null&&(b.callback=u),u=us(r,b,m),u!==null&&(ma(u,r,m),ih(u,r,m))}};function Yf(r,u,m,b,M,z,H){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(b,z,H):u.prototype&&u.prototype.isPureReactComponent?!$u(m,b)||!$u(M,z):!0}function zg(r,u,m,b){r=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,b),u.state!==r&&Ld.enqueueReplaceState(u,u.state,null)}function au(r,u){var m=u;if("ref"in u){m={};for(var b in u)b!=="ref"&&(m[b]=u[b])}if(r=r.defaultProps){m===u&&(m=P({},m));for(var M in r)m[M]===void 0&&(m[M]=r[M])}return m}var am=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function j_(r){am(r)}function Lg(r){console.error(r)}function Ng(r){am(r)}function qf(r,u){try{var m=r.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function B_(r,u,m){try{var b=r.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Hf(r,u,m){return m=jo(m),m.tag=3,m.payload={element:null},m.callback=function(){qf(r,u)},m}function Pg(r){return r=jo(r),r.tag=3,r}function sm(r,u,m,b){var M=m.type.getDerivedStateFromError;if(typeof M=="function"){var z=b.value;r.payload=function(){return M(z)},r.callback=function(){B_(u,m,b)}}var H=m.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(r.callback=function(){B_(u,m,b),typeof M!="function"&&(hu===null?hu=new Set([this]):hu.add(this));var ae=b.stack;this.componentDidCatch(b.value,{componentStack:ae!==null?ae:""})})}function Xf(r,u,m,b,M){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=m.alternate,u!==null&&Gr(u,m,M,!0),m=io.current,m!==null){switch(m.tag){case 13:return ro===null?ry():m.alternate===null&&cr===0&&(cr=3),m.flags&=-257,m.flags|=65536,m.lanes=M,b===th?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([b]):u.add(b),ap(r,b,M)),!1;case 22:return m.flags|=65536,b===th?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([b]):m.add(b)),ap(r,b,M)),!1}throw Error(h(435,m.tag))}return ap(r,b,M),ry(),!1}if(An)return u=io.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=M,b!==Ju&&(r=Error(h(422),{cause:b}),Jc(Qr(r,m)))):(b!==Ju&&(u=Error(h(423),{cause:b}),Jc(Qr(u,m))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,b=Qr(b,m),M=Hf(r.stateNode,b,M),Za(r,M),cr!==4&&(cr=2)),!1;var z=Error(h(520),{cause:b});if(z=Qr(z,m),Vi===null?Vi=[z]:Vi.push(z),cr!==4&&(cr=2),u===null)return!0;b=Qr(b,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,r=M&-M,m.lanes|=r,r=Hf(m.stateNode,b,r),Za(m,r),!1;case 1:if(u=m.type,z=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(hu===null||!hu.has(z))))return m.flags|=65536,M&=-M,m.lanes|=M,M=Pg(M),sm(M,r,m,b),Za(m,M),!1}m=m.return}while(m!==null);return!1}var qa=Error(h(461)),Pr=!1;function Or(r,u,m,b){u.child=r===null?Rg(u,null,m,b):zd(u,r.child,m,b)}function F_(r,u,m,b,M){m=m.render;var z=u.ref;if("ref"in b){var H={};for(var ae in b)ae!=="ref"&&(H[ae]=b[ae])}else H=b;return ml(u),b=ah(r,u,m,H,z,M),ae=oh(),r!==null&&!Pr?(pc(r,u,M),Sl(r,u,M)):(An&&ae&&ha(u),u.flags|=1,Or(r,u,b,M),u.child)}function Og(r,u,m,b,M){if(r===null){var z=m.type;return typeof z=="function"&&!Td(z)&&z.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=z,U_(r,u,z,b,M)):(r=ac(m.type,null,b,u,u.mode,M),r.ref=u.ref,r.return=u,u.child=r)}if(z=r.child,!fh(r,M)){var H=z.memoizedProps;if(m=m.compare,m=m!==null?m:$u,m(H,b)&&r.ref===u.ref)return Sl(r,u,M)}return u.flags|=1,r=Fa(z,b),r.ref=u.ref,r.return=u,u.child=r}function U_(r,u,m,b,M){if(r!==null){var z=r.memoizedProps;if($u(z,b)&&r.ref===u.ref)if(Pr=!1,u.pendingProps=b=z,fh(r,M))(r.flags&131072)!==0&&(Pr=!0);else return u.lanes=r.lanes,Sl(r,u,M)}return Wf(r,u,m,b,M)}function V_(r,u,m){var b=u.pendingProps,M=b.children,z=r!==null?r.memoizedState:null;if(b.mode==="hidden"){if((u.flags&128)!==0){if(b=z!==null?z.baseLanes|m:m,r!==null){for(M=u.child=r.child,z=0;M!==null;)z=z|M.lanes|M.childLanes,M=M.sibling;u.childLanes=z&~b}else u.childLanes=0,u.child=null;return Z_(r,u,b,m)}if((m&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},r!==null&&gl(u,z!==null?z.cachePool:null),z!==null?Bf(u,z):Nr(),im(u);else return u.lanes=u.childLanes=536870912,Z_(r,u,z!==null?z.baseLanes|m:m,m)}else z!==null?(gl(u,z.cachePool),Bf(u,z),_c(),u.memoizedState=null):(r!==null&&gl(u,null),Nr(),_c());return Or(r,u,M,m),u.child}function Z_(r,u,m,b){var M=kd();return M=M===null?null:{parent:Ni._currentValue,pool:M},u.memoizedState={baseLanes:m,cachePool:M},r!==null&&gl(u,null),Nr(),im(u),r!==null&&Gr(r,u,b,!0),null}function om(r,u){var m=u.ref;if(m===null)r!==null&&r.ref!==null&&(u.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(h(284));(r===null||r.ref!==m)&&(u.flags|=4194816)}}function Wf(r,u,m,b,M){return ml(u),m=ah(r,u,m,b,void 0,M),b=oh(),r!==null&&!Pr?(pc(r,u,M),Sl(r,u,M)):(An&&b&&ha(u),u.flags|=1,Or(r,u,m,M),u.child)}function lm(r,u,m,b,M,z){return ml(u),u.updateQueue=null,m=bl(u,b,m,M),sh(r),b=oh(),r!==null&&!Pr?(pc(r,u,z),Sl(r,u,z)):(An&&b&&ha(u),u.flags|=1,Or(r,u,m,z),u.child)}function jg(r,u,m,b,M){if(ml(u),u.stateNode===null){var z=No,H=m.contextType;typeof H=="object"&&H!==null&&(z=ei(H)),z=new m(b,z),u.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=Ld,u.stateNode=z,z._reactInternals=u,z=u.stateNode,z.props=b,z.state=u.memoizedState,z.refs={},nu(u),H=m.contextType,z.context=typeof H=="object"&&H!==null?ei(H):No,z.state=u.memoizedState,H=m.getDerivedStateFromProps,typeof H=="function"&&(hh(u,m,H,b),z.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(H=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),H!==z.state&&Ld.enqueueReplaceState(z,z.state,null),Ht(u,b,z,M),Zt(),z.state=u.memoizedState),typeof z.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(r===null){z=u.stateNode;var ae=u.memoizedProps,we=au(m,ae);z.props=we;var Ye=z.context,ct=m.contextType;H=No,typeof ct=="object"&&ct!==null&&(H=ei(ct));var xt=m.getDerivedStateFromProps;ct=typeof xt=="function"||typeof z.getSnapshotBeforeUpdate=="function",ae=u.pendingProps!==ae,ct||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ae||Ye!==H)&&zg(u,z,b,H),Va=!1;var We=u.memoizedState;z.state=We,Ht(u,b,z,M),Zt(),Ye=u.memoizedState,ae||We!==Ye||Va?(typeof xt=="function"&&(hh(u,m,xt,b),Ye=u.memoizedState),(we=Va||Yf(u,m,we,b,We,Ye,H))?(ct||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(u.flags|=4194308)):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=Ye),z.props=b,z.state=Ye,z.context=H,b=we):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{z=u.stateNode,dc(r,u),H=u.memoizedProps,ct=au(m,H),z.props=ct,xt=u.pendingProps,We=z.context,Ye=m.contextType,we=No,typeof Ye=="object"&&Ye!==null&&(we=ei(Ye)),ae=m.getDerivedStateFromProps,(Ye=typeof ae=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(H!==xt||We!==we)&&zg(u,z,b,we),Va=!1,We=u.memoizedState,z.state=We,Ht(u,b,z,M),Zt();var et=u.memoizedState;H!==xt||We!==et||Va||r!==null&&r.dependencies!==null&&Da(r.dependencies)?(typeof ae=="function"&&(hh(u,m,ae,b),et=u.memoizedState),(ct=Va||Yf(u,m,ct,b,We,et,we)||r!==null&&r.dependencies!==null&&Da(r.dependencies))?(Ye||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(b,et,we),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(b,et,we)),typeof z.componentDidUpdate=="function"&&(u.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof z.componentDidUpdate!="function"||H===r.memoizedProps&&We===r.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&We===r.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=et),z.props=b,z.state=et,z.context=we,b=ct):(typeof z.componentDidUpdate!="function"||H===r.memoizedProps&&We===r.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&We===r.memoizedState||(u.flags|=1024),b=!1)}return z=b,om(r,u),b=(u.flags&128)!==0,z||b?(z=u.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:z.render(),u.flags|=1,r!==null&&b?(u.child=zd(u,r.child,null,M),u.child=zd(u,null,m,M)):Or(r,u,m,M),u.memoizedState=z.state,r=u.child):r=Sl(r,u,M),r}function su(r,u,m,b){return ls(),u.flags|=256,Or(r,u,m,b),u.child}var dh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bg(r){return{baseLanes:r,cachePool:Of()}}function Fg(r,u,m){return r=r!==null?r.childLanes&~m:0,u&&(r|=Qa),r}function G_(r,u,m){var b=u.pendingProps,M=!1,z=(u.flags&128)!==0,H;if((H=z)||(H=r!==null&&r.memoizedState===null?!1:(Ui.current&2)!==0),H&&(M=!0,u.flags&=-129),H=(u.flags&32)!==0,u.flags&=-33,r===null){if(An){if(M?ru(u):_c(),An){var ae=Li,we;if(we=ae){e:{for(we=ae,ae=Ma;we.nodeType!==8;){if(!ae){ae=null;break e}if(we=ys(we.nextSibling),we===null){ae=null;break e}}ae=we}ae!==null?(u.memoizedState={dehydrated:ae,treeContext:Ua!==null?{id:Po,overflow:Ys}:null,retryLane:536870912,hydrationErrors:null},we=Kr(18,null,null,0),we.stateNode=ae,we.return=u,u.child=we,Mr=u,Li=null,we=!0):we=!1}we||dl(u)}if(ae=u.memoizedState,ae!==null&&(ae=ae.dehydrated,ae!==null))return _y(ae)?u.lanes=32:u.lanes=536870912,null;El(u)}return ae=b.children,b=b.fallback,M?(_c(),M=u.mode,ae=cm({mode:"hidden",children:ae},M),b=sc(b,M,m,null),ae.return=u,b.return=u,ae.sibling=b,u.child=ae,M=u.child,M.memoizedState=Bg(m),M.childLanes=Fg(r,H,m),u.memoizedState=dh,b):(ru(u),Ug(u,ae))}if(we=r.memoizedState,we!==null&&(ae=we.dehydrated,ae!==null)){if(z)u.flags&256?(ru(u),u.flags&=-257,u=Vg(r,u,m)):u.memoizedState!==null?(_c(),u.child=r.child,u.flags|=128,u=null):(_c(),M=b.fallback,ae=u.mode,b=cm({mode:"visible",children:b.children},ae),M=sc(M,ae,m,null),M.flags|=2,b.return=u,M.return=u,b.sibling=M,u.child=b,zd(u,r.child,null,m),b=u.child,b.memoizedState=Bg(m),b.childLanes=Fg(r,H,m),u.memoizedState=dh,u=M);else if(ru(u),_y(ae)){if(H=ae.nextSibling&&ae.nextSibling.dataset,H)var Ye=H.dgst;H=Ye,b=Error(h(419)),b.stack="",b.digest=H,Jc({value:b,source:null,stack:null}),u=Vg(r,u,m)}else if(Pr||Gr(r,u,m,!1),H=(m&r.childLanes)!==0,Pr||H){if(H=Ii,H!==null&&(b=m&-m,b=(b&42)!==0?1:je(b),b=(b&(H.suspendedLanes|m))!==0?0:b,b!==0&&b!==we.retryLane))throw we.retryLane=b,Qc(r,b),ma(H,r,b),qa;ae.data==="$?"||ry(),u=Vg(r,u,m)}else ae.data==="$?"?(u.flags|=192,u.child=r.child,u=null):(r=we.treeContext,Li=ys(ae.nextSibling),Mr=u,An=!0,os=null,Ma=!1,r!==null&&(Jr[Rr++]=Po,Jr[Rr++]=Ys,Jr[Rr++]=Ua,Po=r.id,Ys=r.overflow,Ua=u),u=Ug(u,b.children),u.flags|=4096);return u}return M?(_c(),M=b.fallback,ae=u.mode,we=r.child,Ye=we.sibling,b=Fa(we,{mode:"hidden",children:b.children}),b.subtreeFlags=we.subtreeFlags&65011712,Ye!==null?M=Fa(Ye,M):(M=sc(M,ae,m,null),M.flags|=2),M.return=u,b.return=u,b.sibling=M,u.child=b,b=M,M=u.child,ae=r.child.memoizedState,ae===null?ae=Bg(m):(we=ae.cachePool,we!==null?(Ye=Ni._currentValue,we=we.parent!==Ye?{parent:Ye,pool:Ye}:we):we=Of(),ae={baseLanes:ae.baseLanes|m,cachePool:we}),M.memoizedState=ae,M.childLanes=Fg(r,H,m),u.memoizedState=dh,b):(ru(u),m=r.child,r=m.sibling,m=Fa(m,{mode:"visible",children:b.children}),m.return=u,m.sibling=null,r!==null&&(H=u.deletions,H===null?(u.deletions=[r],u.flags|=16):H.push(r)),u.child=m,u.memoizedState=null,m)}function Ug(r,u){return u=cm({mode:"visible",children:u},r.mode),u.return=r,r.child=u}function cm(r,u){return r=Kr(22,r,null,u),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Vg(r,u,m){return zd(u,r.child,null,m),r=Ug(u,u.pendingProps.children),r.flags|=2,u.memoizedState=null,r}function $_(r,u,m){r.lanes|=u;var b=r.alternate;b!==null&&(b.lanes|=u),Cr(r.return,u,m)}function Qf(r,u,m,b,M){var z=r.memoizedState;z===null?r.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:M}:(z.isBackwards=u,z.rendering=null,z.renderingStartTime=0,z.last=b,z.tail=m,z.tailMode=M)}function Y_(r,u,m){var b=u.pendingProps,M=b.revealOrder,z=b.tail;if(Or(r,u,b.children,m),b=Ui.current,(b&2)!==0)b=b&1|2,u.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=u.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&$_(r,m,u);else if(r.tag===19)$_(r,m,u);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===u)break e;for(;r.sibling===null;){if(r.return===null||r.return===u)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}b&=1}switch(St(Ui,b),M){case"forwards":for(m=u.child,M=null;m!==null;)r=m.alternate,r!==null&&rm(r)===null&&(M=m),m=m.sibling;m=M,m===null?(M=u.child,u.child=null):(M=m.sibling,m.sibling=null),Qf(u,!1,M,m,z);break;case"backwards":for(m=null,M=u.child,u.child=null;M!==null;){if(r=M.alternate,r!==null&&rm(r)===null){u.child=M;break}r=M.sibling,M.sibling=m,m=M,M=r}Qf(u,!0,m,null,z);break;case"together":Qf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Sl(r,u,m){if(r!==null&&(u.dependencies=r.dependencies),uu|=u.lanes,(m&u.childLanes)===0)if(r!==null){if(Gr(r,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(r!==null&&u.child!==r.child)throw Error(h(153));if(u.child!==null){for(r=u.child,m=Fa(r,r.pendingProps),u.child=m,m.return=u;r.sibling!==null;)r=r.sibling,m=m.sibling=Fa(r,r.pendingProps),m.return=u;m.sibling=null}return u.child}function fh(r,u){return(r.lanes&u)!==0?!0:(r=r.dependencies,!!(r!==null&&Da(r)))}function Cv(r,u,m){switch(u.tag){case 3:Tn(u,u.stateNode.containerInfo),Ca(u,Ni,r.memoizedState.cache),ls();break;case 27:case 5:ba(u);break;case 4:Tn(u,u.stateNode.containerInfo);break;case 10:Ca(u,u.type,u.memoizedProps.value);break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(ru(u),u.flags|=128,null):(m&u.child.childLanes)!==0?G_(r,u,m):(ru(u),r=Sl(r,u,m),r!==null?r.sibling:null);ru(u);break;case 19:var M=(r.flags&128)!==0;if(b=(m&u.childLanes)!==0,b||(Gr(r,u,m,!1),b=(m&u.childLanes)!==0),M){if(b)return Y_(r,u,m);u.flags|=128}if(M=u.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),St(Ui,Ui.current),b)break;return null;case 22:case 23:return u.lanes=0,V_(r,u,m);case 24:Ca(u,Ni,r.memoizedState.cache)}return Sl(r,u,m)}function Hi(r,u,m){if(r!==null)if(r.memoizedProps!==u.pendingProps)Pr=!0;else{if(!fh(r,m)&&(u.flags&128)===0)return Pr=!1,Cv(r,u,m);Pr=(r.flags&131072)!==0}else Pr=!1,An&&(u.flags&1048576)!==0&&hl(u,lc,u.index);switch(u.lanes=0,u.tag){case 16:e:{r=u.pendingProps;var b=u.elementType,M=b._init;if(b=M(b._payload),u.type=b,typeof b=="function")Td(b)?(r=au(b,r),u.tag=1,u=jg(null,u,b,r,m)):(u.tag=0,u=Wf(null,u,b,r,m));else{if(b!=null){if(M=b.$$typeof,M===$e){u.tag=11,u=F_(null,u,b,r,m);break e}else if(M===nt){u.tag=14,u=Og(null,u,b,r,m);break e}}throw u=Wt(b)||b,Error(h(306,u,""))}}return u;case 0:return Wf(r,u,u.type,u.pendingProps,m);case 1:return b=u.type,M=au(b,u.pendingProps),jg(r,u,b,M,m);case 3:e:{if(Tn(u,u.stateNode.containerInfo),r===null)throw Error(h(387));b=u.pendingProps;var z=u.memoizedState;M=z.element,dc(r,u),Ht(u,b,null,m);var H=u.memoizedState;if(b=H.cache,Ca(u,Ni,b),b!==z.cache&&pl(u,[Ni],m,!0),Zt(),b=H.element,z.isDehydrated)if(z={element:b,isDehydrated:!1,cache:H.cache},u.updateQueue.baseState=z,u.memoizedState=z,u.flags&256){u=su(r,u,b,m);break e}else if(b!==M){M=Qr(Error(h(424)),u),Jc(M),u=su(r,u,b,m);break e}else{switch(r=u.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Li=ys(r.firstChild),Mr=u,An=!0,os=null,Ma=!0,m=Rg(u,null,b,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(ls(),b===M){u=Sl(r,u,m);break e}Or(r,u,b,m)}u=u.child}return u;case 26:return om(r,u),r===null?(m=A(u.type,null,u.pendingProps,null))?u.memoizedState=m:An||(m=u.type,r=u.pendingProps,b=Ah(tn.current).createElement(m),b[$t]=u,b[jt]=r,_r(b,m,r),Ji(b),u.stateNode=b):u.memoizedState=A(u.type,r.memoizedProps,u.pendingProps,r.memoizedState),null;case 27:return ba(u),r===null&&An&&(b=u.stateNode=Xd(u.type,u.pendingProps,tn.current),Mr=u,Ma=!0,M=Li,Dc(u.type)?(fp=M,Li=ys(b.firstChild)):Li=M),Or(r,u,u.pendingProps.children,m),om(r,u),r===null&&(u.flags|=4194304),u.child;case 5:return r===null&&An&&((M=b=Li)&&(b=_0(b,u.type,u.pendingProps,Ma),b!==null?(u.stateNode=b,Mr=u,Li=ys(b.firstChild),Ma=!1,M=!0):M=!1),M||dl(u)),ba(u),M=u.type,z=u.pendingProps,H=r!==null?r.memoizedProps:null,b=z.children,py(M,z)?b=null:H!==null&&py(M,H)&&(u.flags|=32),u.memoizedState!==null&&(M=ah(r,u,Vf,null,null,m),Pt._currentValue=M),om(r,u),Or(r,u,b,m),u.child;case 6:return r===null&&An&&((r=m=Li)&&(m=v0(m,u.pendingProps,Ma),m!==null?(u.stateNode=m,Mr=u,Li=null,r=!0):r=!1),r||dl(u)),null;case 13:return G_(r,u,m);case 4:return Tn(u,u.stateNode.containerInfo),b=u.pendingProps,r===null?u.child=zd(u,null,b,m):Or(r,u,b,m),u.child;case 11:return F_(r,u,u.type,u.pendingProps,m);case 7:return Or(r,u,u.pendingProps,m),u.child;case 8:return Or(r,u,u.pendingProps.children,m),u.child;case 12:return Or(r,u,u.pendingProps.children,m),u.child;case 10:return b=u.pendingProps,Ca(u,u.type,b.value),Or(r,u,b.children,m),u.child;case 9:return M=u.type._context,b=u.pendingProps.children,ml(u),M=ei(M),b=b(M),u.flags|=1,Or(r,u,b,m),u.child;case 14:return Og(r,u,u.type,u.pendingProps,m);case 15:return U_(r,u,u.type,u.pendingProps,m);case 19:return Y_(r,u,m);case 31:return b=u.pendingProps,m=u.mode,b={mode:b.mode,children:b.children},r===null?(m=cm(b,m),m.ref=u.ref,u.child=m,m.return=u,u=m):(m=Fa(r.child,b),m.ref=u.ref,u.child=m,m.return=u,u=m),u;case 22:return V_(r,u,m);case 24:return ml(u),b=ei(Ni),r===null?(M=kd(),M===null&&(M=Ii,z=cc(),M.pooledCache=z,z.refCount++,z!==null&&(M.pooledCacheLanes|=m),M=z),u.memoizedState={parent:b,cache:M},nu(u),Ca(u,Ni,M)):((r.lanes&m)!==0&&(dc(r,u),Ht(u,null,null,m),Zt()),M=r.memoizedState,z=u.memoizedState,M.parent!==b?(M={parent:b,cache:b},u.memoizedState=M,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=M),Ca(u,Ni,b)):(b=z.cache,Ca(u,Ni,b),b!==M.cache&&pl(u,[Ni],m,!0))),Or(r,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(h(156,u.tag))}function Ha(r){r.flags|=4}function Zg(r,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!ve(u)){if(u=io.current,u!==null&&((Pn&4194048)===Pn?ro!==null:(Pn&62914560)!==Pn&&(Pn&536870912)===0||u!==ro))throw nh=th,Id;r.flags|=8192}}function ph(r,u){u!==null&&(r.flags|=4),r.flags&16384&&(u=r.tag!==22?Ce():536870912,r.lanes|=u,_h|=u)}function ou(r,u){if(!An)switch(r.tailMode){case"hidden":u=r.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u||r.tail===null?r.tail=null:r.tail.sibling=null:b.sibling=null}}function ki(r){var u=r.alternate!==null&&r.alternate.child===r.child,m=0,b=0;if(u)for(var M=r.child;M!==null;)m|=M.lanes|M.childLanes,b|=M.subtreeFlags&65011712,b|=M.flags&65011712,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)m|=M.lanes|M.childLanes,b|=M.subtreeFlags,b|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=b,r.childLanes=m,u}function q_(r,u,m){var b=u.pendingProps;switch(Ku(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ki(u),null;case 1:return ki(u),null;case 3:return m=u.stateNode,b=null,r!==null&&(b=r.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),da(Ni),ni(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(r===null||r.child===null)&&(qs(u)?Ha(u):r===null||r.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Lf())),ki(u),null;case 26:return m=u.memoizedState,r===null?(Ha(u),m!==null?(ki(u),Zg(u,m)):(ki(u),u.flags&=-16777217)):m?m!==r.memoizedState?(Ha(u),ki(u),Zg(u,m)):(ki(u),u.flags&=-16777217):(r.memoizedProps!==b&&Ha(u),ki(u),u.flags&=-16777217),null;case 27:Mi(u),m=tn.current;var M=u.type;if(r!==null&&u.stateNode!=null)r.memoizedProps!==b&&Ha(u);else{if(!b){if(u.stateNode===null)throw Error(h(166));return ki(u),null}r=zt.current,qs(u)?Sd(u):(r=Xd(M,b,m),u.stateNode=r,Ha(u))}return ki(u),null;case 5:if(Mi(u),m=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==b&&Ha(u);else{if(!b){if(u.stateNode===null)throw Error(h(166));return ki(u),null}if(r=zt.current,qs(u))Sd(u);else{switch(M=Ah(tn.current),r){case 1:r=M.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:r=M.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":r=M.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":r=M.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof b.is=="string"?M.createElement("select",{is:b.is}):M.createElement("select"),b.multiple?r.multiple=!0:b.size&&(r.size=b.size);break;default:r=typeof b.is=="string"?M.createElement(m,{is:b.is}):M.createElement(m)}}r[$t]=u,r[jt]=b;e:for(M=u.child;M!==null;){if(M.tag===5||M.tag===6)r.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===u)break e;for(;M.sibling===null;){if(M.return===null||M.return===u)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}u.stateNode=r;e:switch(_r(r,m,b),m){case"button":case"input":case"select":case"textarea":r=!!b.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Ha(u)}}return ki(u),u.flags&=-16777217,null;case 6:if(r&&u.stateNode!=null)r.memoizedProps!==b&&Ha(u);else{if(typeof b!="string"&&u.stateNode===null)throw Error(h(166));if(r=tn.current,qs(u)){if(r=u.stateNode,m=u.memoizedProps,b=null,M=Mr,M!==null)switch(M.tag){case 27:case 5:b=M.memoizedProps}r[$t]=u,r=!!(r.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||fy(r.nodeValue,m)),r||dl(u)}else r=Ah(r).createTextNode(b),r[$t]=u,u.stateNode=r}return ki(u),null;case 13:if(b=u.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=qs(u),b!==null&&b.dehydrated!==null){if(r===null){if(!M)throw Error(h(318));if(M=u.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(h(317));M[$t]=u}else ls(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;ki(u),M=!1}else M=Lf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=M),M=!0;if(!M)return u.flags&256?(El(u),u):(El(u),null)}if(El(u),(u.flags&128)!==0)return u.lanes=m,u;if(m=b!==null,r=r!==null&&r.memoizedState!==null,m){b=u.child,M=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(M=b.alternate.memoizedState.cachePool.pool);var z=null;b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(z=b.memoizedState.cachePool.pool),z!==M&&(b.flags|=2048)}return m!==r&&m&&(u.child.flags|=8192),ph(u,u.updateQueue),ki(u),null;case 4:return ni(),r===null&&Im(u.stateNode.containerInfo),ki(u),null;case 10:return da(u.type),ki(u),null;case 19:if(kt(Ui),M=u.memoizedState,M===null)return ki(u),null;if(b=(u.flags&128)!==0,z=M.rendering,z===null)if(b)ou(M,!1);else{if(cr!==0||r!==null&&(r.flags&128)!==0)for(r=u.child;r!==null;){if(z=rm(r),z!==null){for(u.flags|=128,ou(M,!1),r=z.updateQueue,u.updateQueue=r,ph(u,r),u.subtreeFlags=0,r=m,m=u.child;m!==null;)Kc(m,r),m=m.sibling;return St(Ui,Ui.current&1|2),u.child}r=r.sibling}M.tail!==null&&li()>Vd&&(u.flags|=128,b=!0,ou(M,!1),u.lanes=4194304)}else{if(!b)if(r=rm(z),r!==null){if(u.flags|=128,b=!0,r=r.updateQueue,u.updateQueue=r,ph(u,r),ou(M,!0),M.tail===null&&M.tailMode==="hidden"&&!z.alternate&&!An)return ki(u),null}else 2*li()-M.renderingStartTime>Vd&&m!==536870912&&(u.flags|=128,b=!0,ou(M,!1),u.lanes=4194304);M.isBackwards?(z.sibling=u.child,u.child=z):(r=M.last,r!==null?r.sibling=z:u.child=z,M.last=z)}return M.tail!==null?(u=M.tail,M.rendering=u,M.tail=u.sibling,M.renderingStartTime=li(),u.sibling=null,r=Ui.current,St(Ui,b?r&1|2:r&1),u):(ki(u),null);case 22:case 23:return El(u),Ff(),b=u.memoizedState!==null,r!==null?r.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(m&536870912)!==0&&(u.flags&128)===0&&(ki(u),u.subtreeFlags&6&&(u.flags|=8192)):ki(u),m=u.updateQueue,m!==null&&ph(u,m.retryQueue),m=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==m&&(u.flags|=2048),r!==null&&kt(Ws),null;case 24:return m=null,r!==null&&(m=r.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),da(Ni),ki(u),null;case 25:return null;case 30:return null}throw Error(h(156,u.tag))}function H_(r,u){switch(Ku(u),u.tag){case 1:return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 3:return da(Ni),ni(),r=u.flags,(r&65536)!==0&&(r&128)===0?(u.flags=r&-65537|128,u):null;case 26:case 27:case 5:return Mi(u),null;case 13:if(El(u),r=u.memoizedState,r!==null&&r.dehydrated!==null){if(u.alternate===null)throw Error(h(340));ls()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 19:return kt(Ui),null;case 4:return ni(),null;case 10:return da(u.type),null;case 22:case 23:return El(u),Ff(),r!==null&&kt(Ws),r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 24:return da(Ni),null;case 25:return null;default:return null}}function Nd(r,u){switch(Ku(u),u.tag){case 3:da(Ni),ni();break;case 26:case 27:case 5:Mi(u);break;case 4:ni();break;case 13:El(u);break;case 19:kt(Ui);break;case 10:da(u.type);break;case 22:case 23:El(u),Ff(),r!==null&&kt(Ws);break;case 24:da(Ni)}}function mh(r,u){try{var m=u.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var M=b.next;m=M;do{if((m.tag&r)===r){b=void 0;var z=m.create,H=m.inst;b=z(),H.destroy=b}m=m.next}while(m!==M)}}catch(ae){Ri(u,u.return,ae)}}function ms(r,u,m){try{var b=u.updateQueue,M=b!==null?b.lastEffect:null;if(M!==null){var z=M.next;b=z;do{if((b.tag&r)===r){var H=b.inst,ae=H.destroy;if(ae!==void 0){H.destroy=void 0,M=u;var we=m,Ye=ae;try{Ye()}catch(ct){Ri(M,we,ct)}}}b=b.next}while(b!==z)}}catch(ct){Ri(u,u.return,ct)}}function Kf(r){var u=r.updateQueue;if(u!==null){var m=r.stateNode;try{Rd(u,m)}catch(b){Ri(r,r.return,b)}}}function gh(r,u,m){m.props=au(r.type,r.memoizedProps),m.state=r.memoizedState;try{m.componentWillUnmount()}catch(b){Ri(r,u,b)}}function vc(r,u){try{var m=r.ref;if(m!==null){switch(r.tag){case 26:case 27:case 5:var b=r.stateNode;break;case 30:b=r.stateNode;break;default:b=r.stateNode}typeof m=="function"?r.refCleanup=m(b):m.current=b}}catch(M){Ri(r,u,M)}}function Al(r,u){var m=r.ref,b=r.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(M){Ri(r,u,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(M){Ri(r,u,M)}else m.current=null}function Gg(r){var u=r.type,m=r.memoizedProps,b=r.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(M){Ri(r,r.return,M)}}function xc(r,u,m){try{var b=r.stateNode;g0(b,r.type,m,u),b[jt]=u}catch(M){Ri(r,r.return,M)}}function X_(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Dc(r.type)||r.tag===4}function um(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||X_(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Dc(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function yh(r,u,m){var b=r.tag;if(b===5||b===6)r=r.stateNode,u?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(r,u):(u=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,u.appendChild(r),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=Lm));else if(b!==4&&(b===27&&Dc(r.type)&&(m=r.stateNode,u=null),r=r.child,r!==null))for(yh(r,u,m),r=r.sibling;r!==null;)yh(r,u,m),r=r.sibling}function Pd(r,u,m){var b=r.tag;if(b===5||b===6)r=r.stateNode,u?m.insertBefore(r,u):m.appendChild(r);else if(b!==4&&(b===27&&Dc(r.type)&&(m=r.stateNode),r=r.child,r!==null))for(Pd(r,u,m),r=r.sibling;r!==null;)Pd(r,u,m),r=r.sibling}function $g(r){var u=r.stateNode,m=r.memoizedProps;try{for(var b=r.type,M=u.attributes;M.length;)u.removeAttributeNode(M[0]);_r(u,b,m),u[$t]=r,u[jt]=m}catch(z){Ri(r,r.return,z)}}var Ml=!1,yr=!1,Yg=!1,W_=typeof WeakSet=="function"?WeakSet:Set,Yr=null;function Dv(r,u){if(r=r.containerInfo,Hd=ga,r=kf(r),If(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var M=b.anchorOffset,z=b.focusNode;b=b.focusOffset;try{m.nodeType,z.nodeType}catch{m=null;break e}var H=0,ae=-1,we=-1,Ye=0,ct=0,xt=r,We=null;t:for(;;){for(var et;xt!==m||M!==0&&xt.nodeType!==3||(ae=H+M),xt!==z||b!==0&&xt.nodeType!==3||(we=H+b),xt.nodeType===3&&(H+=xt.nodeValue.length),(et=xt.firstChild)!==null;)We=xt,xt=et;for(;;){if(xt===r)break t;if(We===m&&++Ye===M&&(ae=H),We===z&&++ct===b&&(we=H),(et=xt.nextSibling)!==null)break;xt=We,We=xt.parentNode}xt=et}m=ae===-1||we===-1?null:{start:ae,end:we}}else m=null}m=m||{start:0,end:0}}else m=null;for(Pm={focusedElem:r,selectionRange:m},ga=!1,Yr=u;Yr!==null;)if(u=Yr,r=u.child,(u.subtreeFlags&1024)!==0&&r!==null)r.return=u,Yr=r;else for(;Yr!==null;){switch(u=Yr,z=u.alternate,r=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&z!==null){r=void 0,m=u,M=z.memoizedProps,z=z.memoizedState,b=m.stateNode;try{var un=au(m.type,M,m.elementType===m.type);r=b.getSnapshotBeforeUpdate(un,z),b.__reactInternalSnapshotBeforeUpdate=r}catch(ln){Ri(m,m.return,ln)}}break;case 3:if((r&1024)!==0){if(r=u.stateNode.containerInfo,m=r.nodeType,m===9)yy(r);else if(m===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":yy(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(h(163))}if(r=u.sibling,r!==null){r.return=u.return,Yr=r;break}Yr=u.return}}function hm(r,u,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:so(r,m),b&4&&mh(5,m);break;case 1:if(so(r,m),b&4)if(r=m.stateNode,u===null)try{r.componentDidMount()}catch(H){Ri(m,m.return,H)}else{var M=au(m.type,u.memoizedProps);u=u.memoizedState;try{r.componentDidUpdate(M,u,r.__reactInternalSnapshotBeforeUpdate)}catch(H){Ri(m,m.return,H)}}b&64&&Kf(m),b&512&&vc(m,m.return);break;case 3:if(so(r,m),b&64&&(r=m.updateQueue,r!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{Rd(r,u)}catch(H){Ri(m,m.return,H)}}break;case 27:u===null&&b&4&&$g(m);case 26:case 5:so(r,m),u===null&&b&4&&Gg(m),b&512&&vc(m,m.return);break;case 12:so(r,m);break;case 13:so(r,m),b&4&&Xg(r,m),b&64&&(r=m.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(m=s0.bind(null,m),x0(r,m))));break;case 22:if(b=m.memoizedState!==null||Ml,!b){u=u!==null&&u.memoizedState!==null||yr,M=Ml;var z=yr;Ml=b,(yr=u)&&!z?lu(r,m,(m.subtreeFlags&8772)!==0):so(r,m),Ml=M,yr=z}break;case 30:break;default:so(r,m)}}function qg(r){var u=r.alternate;u!==null&&(r.alternate=null,qg(u)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(u=r.stateNode,u!==null&&Ci(u)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Oi=null,Ia=!1;function Uo(r,u,m){for(m=m.child;m!==null;)Hg(r,u,m),m=m.sibling}function Hg(r,u,m){if(Ki&&typeof Ki.onCommitFiberUnmount=="function")try{Ki.onCommitFiberUnmount(Xr,m)}catch{}switch(m.tag){case 26:yr||Al(m,u),Uo(r,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:yr||Al(m,u);var b=Oi,M=Ia;Dc(m.type)&&(Oi=m.stateNode,Ia=!1),Uo(r,u,m),Ch(m.stateNode),Oi=b,Ia=M;break;case 5:yr||Al(m,u);case 6:if(b=Oi,M=Ia,Oi=null,Uo(r,u,m),Oi=b,Ia=M,Oi!==null)if(Ia)try{(Oi.nodeType===9?Oi.body:Oi.nodeName==="HTML"?Oi.ownerDocument.body:Oi).removeChild(m.stateNode)}catch(z){Ri(m,u,z)}else try{Oi.removeChild(m.stateNode)}catch(z){Ri(m,u,z)}break;case 18:Oi!==null&&(Ia?(r=Oi,Om(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,m.stateNode),Qd(r)):Om(Oi,m.stateNode));break;case 4:b=Oi,M=Ia,Oi=m.stateNode.containerInfo,Ia=!0,Uo(r,u,m),Oi=b,Ia=M;break;case 0:case 11:case 14:case 15:yr||ms(2,m,u),yr||ms(4,m,u),Uo(r,u,m);break;case 1:yr||(Al(m,u),b=m.stateNode,typeof b.componentWillUnmount=="function"&&gh(m,u,b)),Uo(r,u,m);break;case 21:Uo(r,u,m);break;case 22:yr=(b=yr)||m.memoizedState!==null,Uo(r,u,m),yr=b;break;default:Uo(r,u,m)}}function Xg(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Qd(r)}catch(m){Ri(u,u.return,m)}}function dm(r){switch(r.tag){case 13:case 19:var u=r.stateNode;return u===null&&(u=r.stateNode=new W_),u;case 22:return r=r.stateNode,u=r._retryCache,u===null&&(u=r._retryCache=new W_),u;default:throw Error(h(435,r.tag))}}function fm(r,u){var m=dm(r);u.forEach(function(b){var M=o0.bind(null,r,b);m.has(b)||(m.add(b),b.then(M,M))})}function Xa(r,u){var m=u.deletions;if(m!==null)for(var b=0;b<m.length;b++){var M=m[b],z=r,H=u,ae=H;e:for(;ae!==null;){switch(ae.tag){case 27:if(Dc(ae.type)){Oi=ae.stateNode,Ia=!1;break e}break;case 5:Oi=ae.stateNode,Ia=!1;break e;case 3:case 4:Oi=ae.stateNode.containerInfo,Ia=!0;break e}ae=ae.return}if(Oi===null)throw Error(h(160));Hg(z,H,M),Oi=null,Ia=!1,z=M.alternate,z!==null&&(z.return=null),M.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Od(u,r),u=u.sibling}var ao=null;function Od(r,u){var m=r.alternate,b=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Xa(u,r),gs(r),b&4&&(ms(3,r,r.return),mh(3,r),ms(5,r,r.return));break;case 1:Xa(u,r),gs(r),b&512&&(yr||m===null||Al(m,m.return)),b&64&&Ml&&(r=r.updateQueue,r!==null&&(b=r.callbacks,b!==null&&(m=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var M=ao;if(Xa(u,r),gs(r),b&512&&(yr||m===null||Al(m,m.return)),b&4){var z=m!==null?m.memoizedState:null;if(b=r.memoizedState,m===null)if(b===null)if(r.stateNode===null){e:{b=r.type,m=r.memoizedProps,M=M.ownerDocument||M;t:switch(b){case"title":z=M.getElementsByTagName("title")[0],(!z||z[sn]||z[$t]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=M.createElement(b),M.head.insertBefore(z,M.querySelector("head > title"))),_r(z,b,m),z[$t]=r,Ji(z),b=z;break e;case"link":var H=ye("link","href",M).get(b+(m.href||""));if(H){for(var ae=0;ae<H.length;ae++)if(z=H[ae],z.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&z.getAttribute("rel")===(m.rel==null?null:m.rel)&&z.getAttribute("title")===(m.title==null?null:m.title)&&z.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){H.splice(ae,1);break t}}z=M.createElement(b),_r(z,b,m),M.head.appendChild(z);break;case"meta":if(H=ye("meta","content",M).get(b+(m.content||""))){for(ae=0;ae<H.length;ae++)if(z=H[ae],z.getAttribute("content")===(m.content==null?null:""+m.content)&&z.getAttribute("name")===(m.name==null?null:m.name)&&z.getAttribute("property")===(m.property==null?null:m.property)&&z.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&z.getAttribute("charset")===(m.charSet==null?null:m.charSet)){H.splice(ae,1);break t}}z=M.createElement(b),_r(z,b,m),M.head.appendChild(z);break;default:throw Error(h(468,b))}z[$t]=r,Ji(z),b=z}r.stateNode=b}else Y(M,r.type,r.stateNode);else r.stateNode=W(M,b,r.memoizedProps);else z!==b?(z===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):z.count--,b===null?Y(M,r.type,r.stateNode):W(M,b,r.memoizedProps)):b===null&&r.stateNode!==null&&xc(r,r.memoizedProps,m.memoizedProps)}break;case 27:Xa(u,r),gs(r),b&512&&(yr||m===null||Al(m,m.return)),m!==null&&b&4&&xc(r,r.memoizedProps,m.memoizedProps);break;case 5:if(Xa(u,r),gs(r),b&512&&(yr||m===null||Al(m,m.return)),r.flags&32){M=r.stateNode;try{kr(M,"")}catch(et){Ri(r,r.return,et)}}b&4&&r.stateNode!=null&&(M=r.memoizedProps,xc(r,M,m!==null?m.memoizedProps:M)),b&1024&&(Yg=!0);break;case 6:if(Xa(u,r),gs(r),b&4){if(r.stateNode===null)throw Error(h(162));b=r.memoizedProps,m=r.stateNode;try{m.nodeValue=b}catch(et){Ri(r,r.return,et)}}break;case 3:if(Ee=null,M=ao,ao=Dh(u.containerInfo),Xa(u,r),ao=M,gs(r),b&4&&m!==null&&m.memoizedState.isDehydrated)try{Qd(u.containerInfo)}catch(et){Ri(r,r.return,et)}Yg&&(Yg=!1,pm(r));break;case 4:b=ao,ao=Dh(r.stateNode.containerInfo),Xa(u,r),gs(r),ao=b;break;case 12:Xa(u,r),gs(r);break;case 13:Xa(u,r),gs(r),r.child.flags&8192&&r.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(_m=li()),b&4&&(b=r.updateQueue,b!==null&&(r.updateQueue=null,fm(r,b)));break;case 22:M=r.memoizedState!==null;var we=m!==null&&m.memoizedState!==null,Ye=Ml,ct=yr;if(Ml=Ye||M,yr=ct||we,Xa(u,r),yr=ct,Ml=Ye,gs(r),b&8192)e:for(u=r.stateNode,u._visibility=M?u._visibility&-2:u._visibility|1,M&&(m===null||we||Ml||yr||bc(r)),m=null,u=r;;){if(u.tag===5||u.tag===26){if(m===null){we=m=u;try{if(z=we.stateNode,M)H=z.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{ae=we.stateNode;var xt=we.memoizedProps.style,We=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;ae.style.display=We==null||typeof We=="boolean"?"":(""+We).trim()}}catch(et){Ri(we,we.return,et)}}}else if(u.tag===6){if(m===null){we=u;try{we.stateNode.nodeValue=M?"":we.memoizedProps}catch(et){Ri(we,we.return,et)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===r)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break e;for(;u.sibling===null;){if(u.return===null||u.return===r)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}b&4&&(b=r.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,fm(r,m))));break;case 19:Xa(u,r),gs(r),b&4&&(b=r.updateQueue,b!==null&&(r.updateQueue=null,fm(r,b)));break;case 30:break;case 21:break;default:Xa(u,r),gs(r)}}function gs(r){var u=r.flags;if(u&2){try{for(var m,b=r.return;b!==null;){if(X_(b)){m=b;break}b=b.return}if(m==null)throw Error(h(160));switch(m.tag){case 27:var M=m.stateNode,z=um(r);Pd(r,z,M);break;case 5:var H=m.stateNode;m.flags&32&&(kr(H,""),m.flags&=-33);var ae=um(r);Pd(r,ae,H);break;case 3:case 4:var we=m.stateNode.containerInfo,Ye=um(r);yh(r,Ye,we);break;default:throw Error(h(161))}}catch(ct){Ri(r,r.return,ct)}r.flags&=-3}u&4096&&(r.flags&=-4097)}function pm(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var u=r;pm(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),r=r.sibling}}function so(r,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)hm(r,u.alternate,u),u=u.sibling}function bc(r){for(r=r.child;r!==null;){var u=r;switch(u.tag){case 0:case 11:case 14:case 15:ms(4,u,u.return),bc(u);break;case 1:Al(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&gh(u,u.return,m),bc(u);break;case 27:Ch(u.stateNode);case 26:case 5:Al(u,u.return),bc(u);break;case 22:u.memoizedState===null&&bc(u);break;case 30:bc(u);break;default:bc(u)}r=r.sibling}}function lu(r,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,M=r,z=u,H=z.flags;switch(z.tag){case 0:case 11:case 15:lu(M,z,m),mh(4,z);break;case 1:if(lu(M,z,m),b=z,M=b.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Ye){Ri(b,b.return,Ye)}if(b=z,M=b.updateQueue,M!==null){var ae=b.stateNode;try{var we=M.shared.hiddenCallbacks;if(we!==null)for(M.shared.hiddenCallbacks=null,M=0;M<we.length;M++)rh(we[M],ae)}catch(Ye){Ri(b,b.return,Ye)}}m&&H&64&&Kf(z),vc(z,z.return);break;case 27:$g(z);case 26:case 5:lu(M,z,m),m&&b===null&&H&4&&Gg(z),vc(z,z.return);break;case 12:lu(M,z,m);break;case 13:lu(M,z,m),m&&H&4&&Xg(M,z);break;case 22:z.memoizedState===null&&lu(M,z,m),vc(z,z.return);break;case 30:break;default:lu(M,z,m)}u=u.sibling}}function Wg(r,u){var m=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),r=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(r=u.memoizedState.cachePool.pool),r!==m&&(r!=null&&r.refCount++,m!=null&&zr(m))}function mm(r,u){r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&zr(r))}function Vo(r,u,m,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Q_(r,u,m,b),u=u.sibling}function Q_(r,u,m,b){var M=u.flags;switch(u.tag){case 0:case 11:case 15:Vo(r,u,m,b),M&2048&&mh(9,u);break;case 1:Vo(r,u,m,b);break;case 3:Vo(r,u,m,b),M&2048&&(r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&zr(r)));break;case 12:if(M&2048){Vo(r,u,m,b),r=u.stateNode;try{var z=u.memoizedProps,H=z.id,ae=z.onPostCommit;typeof ae=="function"&&ae(H,u.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(we){Ri(u,u.return,we)}}else Vo(r,u,m,b);break;case 13:Vo(r,u,m,b);break;case 23:break;case 22:z=u.stateNode,H=u.alternate,u.memoizedState!==null?z._visibility&2?Vo(r,u,m,b):wc(r,u):z._visibility&2?Vo(r,u,m,b):(z._visibility|=2,jd(r,u,m,b,(u.subtreeFlags&10256)!==0)),M&2048&&Wg(H,u);break;case 24:Vo(r,u,m,b),M&2048&&mm(u.alternate,u);break;default:Vo(r,u,m,b)}}function jd(r,u,m,b,M){for(M=M&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var z=r,H=u,ae=m,we=b,Ye=H.flags;switch(H.tag){case 0:case 11:case 15:jd(z,H,ae,we,M),mh(8,H);break;case 23:break;case 22:var ct=H.stateNode;H.memoizedState!==null?ct._visibility&2?jd(z,H,ae,we,M):wc(z,H):(ct._visibility|=2,jd(z,H,ae,we,M)),M&&Ye&2048&&Wg(H.alternate,H);break;case 24:jd(z,H,ae,we,M),M&&Ye&2048&&mm(H.alternate,H);break;default:jd(z,H,ae,we,M)}u=u.sibling}}function wc(r,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=r,b=u,M=b.flags;switch(b.tag){case 22:wc(m,b),M&2048&&Wg(b.alternate,b);break;case 24:wc(m,b),M&2048&&mm(b.alternate,b);break;default:wc(m,b)}u=u.sibling}}var Bd=8192;function Fd(r){if(r.subtreeFlags&Bd)for(r=r.child;r!==null;)K_(r),r=r.sibling}function K_(r){switch(r.tag){case 26:Fd(r),r.flags&Bd&&r.memoizedState!==null&&qe(ao,r.memoizedState,r.memoizedProps);break;case 5:Fd(r);break;case 3:case 4:var u=ao;ao=Dh(r.stateNode.containerInfo),Fd(r),ao=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Bd,Bd=16777216,Fd(r),Bd=u):Fd(r));break;default:Fd(r)}}function J_(r){var u=r.alternate;if(u!==null&&(r=u.child,r!==null)){u.child=null;do u=r.sibling,r.sibling=null,r=u;while(r!==null)}}function Jf(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];Yr=b,Qg(b,r)}J_(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)e0(r),r=r.sibling}function e0(r){switch(r.tag){case 0:case 11:case 15:Jf(r),r.flags&2048&&ms(9,r,r.return);break;case 3:Jf(r);break;case 12:Jf(r);break;case 22:var u=r.stateNode;r.memoizedState!==null&&u._visibility&2&&(r.return===null||r.return.tag!==13)?(u._visibility&=-3,gm(r)):Jf(r);break;default:Jf(r)}}function gm(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];Yr=b,Qg(b,r)}J_(r)}for(r=r.child;r!==null;){switch(u=r,u.tag){case 0:case 11:case 15:ms(8,u,u.return),gm(u);break;case 22:m=u.stateNode,m._visibility&2&&(m._visibility&=-3,gm(u));break;default:gm(u)}r=r.sibling}}function Qg(r,u){for(;Yr!==null;){var m=Yr;switch(m.tag){case 0:case 11:case 15:ms(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:zr(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,Yr=b;else e:for(m=r;Yr!==null;){b=Yr;var M=b.sibling,z=b.return;if(qg(b),b===m){Yr=null;break e}if(M!==null){M.return=z,Yr=M;break e}Yr=z}}}var Kg={getCacheForType:function(r){var u=ei(Ni),m=u.data.get(r);return m===void 0&&(m=r(),u.data.set(r,m)),m}},t0=typeof WeakMap=="function"?WeakMap:Map,si=0,Ii=null,Nn=null,Pn=0,di=0,Wa=null,cu=!1,Ud=!1,Jg=!1,Cl=0,cr=0,uu=0,Zo=0,ym=0,Qa=0,_h=0,Vi=null,pa=null,ey=!1,_m=0,Vd=1/0,Zd=null,hu=null,ta=0,du=null,Gd=null,vh=0,na=0,ep=null,ty=null,oo=0,$d=null;function ia(){if((si&2)!==0&&Pn!==0)return Pn&-Pn;if(Oe.T!==null){var r=cs;return r!==0?r:Cm()}return Ct()}function xh(){Qa===0&&(Qa=(Pn&536870912)===0||An?_e():536870912);var r=io.current;return r!==null&&(r.flags|=32),Qa}function ma(r,u,m){(r===Ii&&(di===2||di===9)||r.cancelPendingCommit!==null)&&(bh(r,0),Tc(r,Pn,Qa,!1)),Be(r,m),((si&2)===0||r!==Ii)&&(r===Ii&&((si&2)===0&&(Zo|=m),cr===4&&Tc(r,Pn,Qa,!1)),Dl(r))}function tp(r,u,m){if((si&6)!==0)throw Error(h(327));var b=!m&&(u&124)===0&&(u&r.expiredLanes)===0||re(r,u),M=b?Rv(r,u):bm(r,u,!0),z=b;do{if(M===0){Ud&&!b&&Tc(r,u,0,!1);break}else{if(m=r.current.alternate,z&&!kv(m)){M=bm(r,u,!1),z=!1;continue}if(M===2){if(z=u,r.errorRecoveryDisabledLanes&z)var H=0;else H=r.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){u=H;e:{var ae=r;M=Vi;var we=ae.current.memoizedState.isDehydrated;if(we&&(bh(ae,H).flags|=256),H=bm(ae,H,!1),H!==2){if(Jg&&!we){ae.errorRecoveryDisabledLanes|=z,Zo|=z,M=4;break e}z=pa,pa=M,z!==null&&(pa===null?pa=z:pa.push.apply(pa,z))}M=H}if(z=!1,M!==2)continue}}if(M===1){bh(r,0),Tc(r,u,0,!0);break}e:{switch(b=r,z=M,z){case 0:case 1:throw Error(h(345));case 4:if((u&4194048)!==u)break;case 6:Tc(b,u,Qa,!cu);break e;case 2:pa=null;break;case 3:case 5:break;default:throw Error(h(329))}if((u&62914560)===u&&(M=_m+300-li(),10<M)){if(Tc(b,u,Qa,!cu),ee(b,0,!0)!==0)break e;b.timeoutHandle=Mh(n0.bind(null,b,m,pa,Zd,ey,u,Qa,Zo,_h,cu,z,2,-0,0),M);break e}n0(b,m,pa,Zd,ey,u,Qa,Zo,_h,cu,z,0,-0,0)}}break}while(!0);Dl(r)}function n0(r,u,m,b,M,z,H,ae,we,Ye,ct,xt,We,et){if(r.timeoutHandle=-1,xt=u.subtreeFlags,(xt&8192||(xt&16785408)===16785408)&&(Ve={stylesheets:null,count:0,unsuspend:pt},K_(u),xt=tt(),xt!==null)){r.cancelPendingCommit=xt(Go.bind(null,r,u,z,m,b,M,H,ae,we,ct,1,We,et)),Tc(r,z,H,!Ye);return}Go(r,u,z,m,b,M,H,ae,we)}function kv(r){for(var u=r;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var M=m[b],z=M.getSnapshot;M=M.value;try{if(!Wr(z(),M))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Tc(r,u,m,b){u&=~ym,u&=~Zo,r.suspendedLanes|=u,r.pingedLanes&=~u,b&&(r.warmLanes|=u),b=r.expirationTimes;for(var M=u;0<M;){var z=31-Gi(M),H=1<<z;b[z]=-1,M&=~H}m!==0&&rt(r,m,u)}function np(){return(si&6)===0?(op(0),!1):!0}function ny(){if(Nn!==null){if(di===0)var r=Nn.return;else r=Nn,Hs=fl=null,lh(r),ka=null,Ya=0,r=Nn;for(;r!==null;)Nd(r.alternate,r),r=r.return;Nn=null}}function bh(r,u){var m=r.timeoutHandle;m!==-1&&(r.timeoutHandle=-1,qr(m)),m=r.cancelPendingCommit,m!==null&&(r.cancelPendingCommit=null,m()),ny(),Ii=r,Nn=m=Fa(r.current,null),Pn=u,di=0,Wa=null,cu=!1,Ud=re(r,u),Jg=!1,_h=Qa=ym=Zo=uu=cr=0,pa=Vi=null,ey=!1,(u&8)!==0&&(u|=u&32);var b=r.entangledLanes;if(b!==0)for(r=r.entanglements,b&=u;0<b;){var M=31-Gi(b),z=1<<M;u|=r[M],b&=~z}return Cl=u,bd(),m}function iy(r,u){Kt=null,Oe.H=no,u===eh||u===eu?(u=Qs(),di=3):u===Id?(u=Qs(),di=4):di=u===qa?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Wa=u,Nn===null&&(cr=1,qf(r,Qr(u,r.current)))}function vm(){var r=Oe.H;return Oe.H=no,r===null?no:r}function xm(){var r=Oe.A;return Oe.A=Kg,r}function ry(){cr=4,cu||(Pn&4194048)!==Pn&&io.current!==null||(Ud=!0),(uu&134217727)===0&&(Zo&134217727)===0||Ii===null||Tc(Ii,Pn,Qa,!1)}function bm(r,u,m){var b=si;si|=2;var M=vm(),z=xm();(Ii!==r||Pn!==u)&&(Zd=null,bh(r,u)),u=!1;var H=cr;e:do try{if(di!==0&&Nn!==null){var ae=Nn,we=Wa;switch(di){case 8:ny(),H=6;break e;case 3:case 2:case 9:case 6:io.current===null&&(u=!0);var Ye=di;if(di=0,Wa=null,wh(r,ae,we,Ye),m&&Ud){H=0;break e}break;default:Ye=di,di=0,Wa=null,wh(r,ae,we,Ye)}}Iv(),H=cr;break}catch(ct){iy(r,ct)}while(!0);return u&&r.shellSuspendCounter++,Hs=fl=null,si=b,Oe.H=M,Oe.A=z,Nn===null&&(Ii=null,Pn=0,bd()),H}function Iv(){for(;Nn!==null;)i0(Nn)}function Rv(r,u){var m=si;si|=2;var b=vm(),M=xm();Ii!==r||Pn!==u?(Zd=null,Vd=li()+500,bh(r,u)):Ud=re(r,u);e:do try{if(di!==0&&Nn!==null){u=Nn;var z=Wa;t:switch(di){case 1:di=0,Wa=null,wh(r,u,z,1);break;case 2:case 9:if(jf(z)){di=0,Wa=null,r0(u);break}u=function(){di!==2&&di!==9||Ii!==r||(di=7),Dl(r)},z.then(u,u);break e;case 3:di=7;break e;case 4:di=5;break e;case 7:jf(z)?(di=0,Wa=null,r0(u)):(di=0,Wa=null,wh(r,u,z,7));break;case 5:var H=null;switch(Nn.tag){case 26:H=Nn.memoizedState;case 5:case 27:var ae=Nn;if(!H||ve(H)){di=0,Wa=null;var we=ae.sibling;if(we!==null)Nn=we;else{var Ye=ae.return;Ye!==null?(Nn=Ye,ip(Ye)):Nn=null}break t}}di=0,Wa=null,wh(r,u,z,5);break;case 6:di=0,Wa=null,wh(r,u,z,6);break;case 8:ny(),cr=6;break e;default:throw Error(h(462))}}zv();break}catch(ct){iy(r,ct)}while(!0);return Hs=fl=null,Oe.H=b,Oe.A=M,si=m,Nn!==null?0:(Ii=null,Pn=0,bd(),cr)}function zv(){for(;Nn!==null&&!Gn();)i0(Nn)}function i0(r){var u=Hi(r.alternate,r,Cl);r.memoizedProps=r.pendingProps,u===null?ip(r):Nn=u}function r0(r){var u=r,m=u.alternate;switch(u.tag){case 15:case 0:u=lm(m,u,u.pendingProps,u.type,void 0,Pn);break;case 11:u=lm(m,u,u.pendingProps,u.type.render,u.ref,Pn);break;case 5:lh(u);default:Nd(m,u),u=Nn=Kc(u,Cl),u=Hi(m,u,Cl)}r.memoizedProps=r.pendingProps,u===null?ip(r):Nn=u}function wh(r,u,m,b){Hs=fl=null,lh(u),ka=null,Ya=0;var M=u.return;try{if(Xf(r,M,u,m,Pn)){cr=1,qf(r,Qr(m,r.current)),Nn=null;return}}catch(z){if(M!==null)throw Nn=M,z;cr=1,qf(r,Qr(m,r.current)),Nn=null;return}u.flags&32768?(An||b===1?r=!0:Ud||(Pn&536870912)!==0?r=!1:(cu=r=!0,(b===2||b===9||b===3||b===6)&&(b=io.current,b!==null&&b.tag===13&&(b.flags|=16384))),Yd(u,r)):ip(u)}function ip(r){var u=r;do{if((u.flags&32768)!==0){Yd(u,cu);return}r=u.return;var m=q_(u.alternate,u,Cl);if(m!==null){Nn=m;return}if(u=u.sibling,u!==null){Nn=u;return}Nn=u=r}while(u!==null);cr===0&&(cr=5)}function Yd(r,u){do{var m=H_(r.alternate,r);if(m!==null){m.flags&=32767,Nn=m;return}if(m=r.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(r=r.sibling,r!==null)){Nn=r;return}Nn=r=m}while(r!==null);cr=6,Nn=null}function Go(r,u,m,b,M,z,H,ae,we){r.cancelPendingCommit=null;do Tm();while(ta!==0);if((si&6)!==0)throw Error(h(327));if(u!==null){if(u===r.current)throw Error(h(177));if(z=u.lanes|u.childLanes,z|=ic,ze(r,m,z,H,ae,we),r===Ii&&(Nn=Ii=null,Pn=0),Gd=u,du=r,vh=m,na=z,ep=M,ty=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,oy(fr,function(){return rp(),null})):(r.callbackNode=null,r.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=Oe.T,Oe.T=null,M=vt.p,vt.p=2,H=si,si|=4;try{Dv(r,u,m)}finally{si=H,vt.p=M,Oe.T=b}}ta=1,Ec(),ay(),wm()}}function Ec(){if(ta===1){ta=0;var r=du,u=Gd,m=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||m){m=Oe.T,Oe.T=null;var b=vt.p;vt.p=2;var M=si;si|=4;try{Od(u,r);var z=Pm,H=kf(r.containerInfo),ae=z.focusedElem,we=z.selectionRange;if(H!==ae&&ae&&ae.ownerDocument&&Kp(ae.ownerDocument.documentElement,ae)){if(we!==null&&If(ae)){var Ye=we.start,ct=we.end;if(ct===void 0&&(ct=Ye),"selectionStart"in ae)ae.selectionStart=Ye,ae.selectionEnd=Math.min(ct,ae.value.length);else{var xt=ae.ownerDocument||document,We=xt&&xt.defaultView||window;if(We.getSelection){var et=We.getSelection(),un=ae.textContent.length,ln=Math.min(we.start,un),_n=we.end===void 0?ln:Math.min(we.end,un);!et.extend&&ln>_n&&(H=_n,_n=ln,ln=H);var Pe=Qp(ae,ln),Ie=Qp(ae,_n);if(Pe&&Ie&&(et.rangeCount!==1||et.anchorNode!==Pe.node||et.anchorOffset!==Pe.offset||et.focusNode!==Ie.node||et.focusOffset!==Ie.offset)){var Fe=xt.createRange();Fe.setStart(Pe.node,Pe.offset),et.removeAllRanges(),ln>_n?(et.addRange(Fe),et.extend(Ie.node,Ie.offset)):(Fe.setEnd(Ie.node,Ie.offset),et.addRange(Fe))}}}}for(xt=[],et=ae;et=et.parentNode;)et.nodeType===1&&xt.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<xt.length;ae++){var dt=xt[ae];dt.element.scrollLeft=dt.left,dt.element.scrollTop=dt.top}}ga=!!Hd,Pm=Hd=null}finally{si=M,vt.p=b,Oe.T=m}}r.current=u,ta=2}}function ay(){if(ta===2){ta=0;var r=du,u=Gd,m=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||m){m=Oe.T,Oe.T=null;var b=vt.p;vt.p=2;var M=si;si|=4;try{hm(r,u.alternate,u)}finally{si=M,vt.p=b,Oe.T=m}}ta=3}}function wm(){if(ta===4||ta===3){ta=0,wa();var r=du,u=Gd,m=vh,b=ty;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?ta=5:(ta=0,Gd=du=null,a0(r,r.pendingLanes));var M=r.pendingLanes;if(M===0&&(hu=null),ht(m),u=u.stateNode,Ki&&typeof Ki.onCommitFiberRoot=="function")try{Ki.onCommitFiberRoot(Xr,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=Oe.T,M=vt.p,vt.p=2,Oe.T=null;try{for(var z=r.onRecoverableError,H=0;H<b.length;H++){var ae=b[H];z(ae.value,{componentStack:ae.stack})}}finally{Oe.T=u,vt.p=M}}(vh&3)!==0&&Tm(),Dl(r),M=r.pendingLanes,(m&4194090)!==0&&(M&42)!==0?r===$d?oo++:(oo=0,$d=r):oo=0,op(0)}}function a0(r,u){(r.pooledCacheLanes&=u)===0&&(u=r.pooledCache,u!=null&&(r.pooledCache=null,zr(u)))}function Tm(r){return Ec(),ay(),wm(),rp()}function rp(){if(ta!==5)return!1;var r=du,u=na;na=0;var m=ht(vh),b=Oe.T,M=vt.p;try{vt.p=32>m?32:m,Oe.T=null,m=ep,ep=null;var z=du,H=vh;if(ta=0,Gd=du=null,vh=0,(si&6)!==0)throw Error(h(331));var ae=si;if(si|=4,e0(z.current),Q_(z,z.current,H,m),si=ae,op(0,!1),Ki&&typeof Ki.onPostCommitFiberRoot=="function")try{Ki.onPostCommitFiberRoot(Xr,z)}catch{}return!0}finally{vt.p=M,Oe.T=b,a0(r,u)}}function Em(r,u,m){u=Qr(m,u),u=Hf(r.stateNode,u,2),r=us(r,u,2),r!==null&&(Be(r,2),Dl(r))}function Ri(r,u,m){if(r.tag===3)Em(r,r,m);else for(;u!==null;){if(u.tag===3){Em(u,r,m);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(hu===null||!hu.has(b))){r=Qr(m,r),m=Pg(2),b=us(u,m,2),b!==null&&(sm(m,b,u,r),Be(b,2),Dl(b));break}}u=u.return}}function ap(r,u,m){var b=r.pingCache;if(b===null){b=r.pingCache=new t0;var M=new Set;b.set(u,M)}else M=b.get(u),M===void 0&&(M=new Set,b.set(u,M));M.has(m)||(Jg=!0,M.add(m),r=sy.bind(null,r,u,m),u.then(r,r))}function sy(r,u,m){var b=r.pingCache;b!==null&&b.delete(u),r.pingedLanes|=r.suspendedLanes&m,r.warmLanes&=~m,Ii===r&&(Pn&m)===m&&(cr===4||cr===3&&(Pn&62914560)===Pn&&300>li()-_m?(si&2)===0&&bh(r,0):ym|=m,_h===Pn&&(_h=0)),Dl(r)}function Th(r,u){u===0&&(u=Ce()),r=Qc(r,u),r!==null&&(Be(r,u),Dl(r))}function s0(r){var u=r.memoizedState,m=0;u!==null&&(m=u.retryLane),Th(r,m)}function o0(r,u){var m=0;switch(r.tag){case 13:var b=r.stateNode,M=r.memoizedState;M!==null&&(m=M.retryLane);break;case 19:b=r.stateNode;break;case 22:b=r.stateNode._retryCache;break;default:throw Error(h(314))}b!==null&&b.delete(u),Th(r,m)}function oy(r,u){return Er(r,u)}var sp=null,Sc=null,Sm=!1,Am=!1,ly=!1,fu=0;function Dl(r){r!==Sc&&r.next===null&&(Sc===null?sp=Sc=r:Sc=Sc.next=r),Am=!0,Sm||(Sm=!0,u0())}function op(r,u){if(!ly&&Am){ly=!0;do for(var m=!1,b=sp;b!==null;){if(r!==0){var M=b.pendingLanes;if(M===0)var z=0;else{var H=b.suspendedLanes,ae=b.pingedLanes;z=(1<<31-Gi(42|r)+1)-1,z&=M&~(H&~ae),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(m=!0,Ac(b,z))}else z=Pn,z=ee(b,b===Ii?z:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(z&3)===0||re(b,z)||(m=!0,Ac(b,z));b=b.next}while(m);ly=!1}}function Lv(){l0()}function l0(){Am=Sm=!1;var r=0;fu!==0&&(Nv()&&(r=fu),fu=0);for(var u=li(),m=null,b=sp;b!==null;){var M=b.next,z=c0(b,u);z===0?(b.next=null,m===null?sp=M:m.next=M,M===null&&(Sc=m)):(m=b,(r!==0||(z&3)!==0)&&(Am=!0)),b=M}op(r)}function c0(r,u){for(var m=r.suspendedLanes,b=r.pingedLanes,M=r.expirationTimes,z=r.pendingLanes&-62914561;0<z;){var H=31-Gi(z),ae=1<<H,we=M[H];we===-1?((ae&m)===0||(ae&b)!==0)&&(M[H]=X(ae,u)):we<=u&&(r.expiredLanes|=ae),z&=~ae}if(u=Ii,m=Pn,m=ee(r,r===u?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),b=r.callbackNode,m===0||r===u&&(di===2||di===9)||r.cancelPendingCommit!==null)return b!==null&&b!==null&&Zn(b),r.callbackNode=null,r.callbackPriority=0;if((m&3)===0||re(r,m)){if(u=m&-m,u===r.callbackPriority)return u;switch(b!==null&&Zn(b),ht(m)){case 2:case 8:m=rr;break;case 32:m=fr;break;case 268435456:m=Bs;break;default:m=fr}return b=Mm.bind(null,r),m=Er(m,b),r.callbackPriority=u,r.callbackNode=m,u}return b!==null&&b!==null&&Zn(b),r.callbackPriority=2,r.callbackNode=null,2}function Mm(r,u){if(ta!==0&&ta!==5)return r.callbackNode=null,r.callbackPriority=0,null;var m=r.callbackNode;if(Tm()&&r.callbackNode!==m)return null;var b=Pn;return b=ee(r,r===Ii?b:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),b===0?null:(tp(r,b,u),c0(r,li()),r.callbackNode!=null&&r.callbackNode===m?Mm.bind(null,r):null)}function Ac(r,u){if(Tm())return null;tp(r,u,!0)}function u0(){gy(function(){(si&6)!==0?Er(is,Lv):l0()})}function Cm(){return fu===0&&(fu=_e()),fu}function cy(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Sr(""+r)}function uy(r,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,r.id&&m.setAttribute("form",r.id),u.parentNode.insertBefore(m,u),r=new FormData(r),m.parentNode.removeChild(m),r}function h0(r,u,m,b,M){if(u==="submit"&&m&&m.stateNode===M){var z=cy((M[jt]||null).action),H=b.submitter;H&&(u=(u=H[jt]||null)?cy(u.formAction):H.getAttribute("formAction"),u!==null&&(z=u,H=null));var ae=new rl("action","action",null,b,M);r.push({event:ae,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(fu!==0){var we=H?uy(M,H):new FormData(M);eo(m,{pending:!0,data:we,method:M.method,action:z},null,we)}}else typeof z=="function"&&(ae.preventDefault(),we=H?uy(M,H):new FormData(M),eo(m,{pending:!0,data:we,method:M.method,action:z},z,we))},currentTarget:M}]})}}for(var lp=0;lp<xd.length;lp++){var Dm=xd[lp],cp=Dm.toLowerCase(),d0=Dm[0].toUpperCase()+Dm.slice(1);Aa(cp,"on"+d0)}Aa(ll,"onAnimationEnd"),Aa(qu,"onAnimationIteration"),Aa(Hu,"onAnimationStart"),Aa("dblclick","onDoubleClick"),Aa("focusin","onFocus"),Aa("focusout","onBlur"),Aa(Xu,"onTransitionRun"),Aa(vd,"onTransitionStart"),Aa(em,"onTransitionCancel"),Aa(ec,"onTransitionEnd"),Jn("onMouseEnter",["mouseout","mouseover"]),Jn("onMouseLeave",["mouseout","mouseover"]),Jn("onPointerEnter",["pointerout","pointerover"]),Jn("onPointerLeave",["pointerout","pointerover"]),ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ar("onBeforeInput",["compositionend","keypress","textInput","paste"]),ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Eh));function Ka(r,u){u=(u&4)!==0;for(var m=0;m<r.length;m++){var b=r[m],M=b.event;b=b.listeners;e:{var z=void 0;if(u)for(var H=b.length-1;0<=H;H--){var ae=b[H],we=ae.instance,Ye=ae.currentTarget;if(ae=ae.listener,we!==z&&M.isPropagationStopped())break e;z=ae,M.currentTarget=Ye;try{z(M)}catch(ct){am(ct)}M.currentTarget=null,z=we}else for(H=0;H<b.length;H++){if(ae=b[H],we=ae.instance,Ye=ae.currentTarget,ae=ae.listener,we!==z&&M.isPropagationStopped())break e;z=ae,M.currentTarget=Ye;try{z(M)}catch(ct){am(ct)}M.currentTarget=null,z=we}}}}function En(r,u){var m=u[Cn];m===void 0&&(m=u[Cn]=new Set);var b=r+"__bubble";m.has(b)||(hy(u,r,2,!1),m.add(b))}function km(r,u,m){var b=0;u&&(b|=4),hy(m,r,b,u)}var up="_reactListening"+Math.random().toString(36).slice(2);function Im(r){if(!r[up]){r[up]=!0,Zl.forEach(function(m){m!=="selectionchange"&&(f0.has(m)||km(m,!1,r),km(m,!0,r))});var u=r.nodeType===9?r:r.ownerDocument;u===null||u[up]||(u[up]=!0,km("selectionchange",!1,u))}}function hy(r,u,m,b){switch(ra(u)){case 2:var M=Ra;break;case 8:M=Br;break;default:M=bi}m=M.bind(null,u,m,r),M=void 0,!ii||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(M=!0),b?M!==void 0?r.addEventListener(u,m,{capture:!0,passive:M}):r.addEventListener(u,m,!0):M!==void 0?r.addEventListener(u,m,{passive:M}):r.addEventListener(u,m,!1)}function Rm(r,u,m,b,M){var z=b;if((u&1)===0&&(u&2)===0&&b!==null)e:for(;;){if(b===null)return;var H=b.tag;if(H===3||H===4){var ae=b.stateNode.containerInfo;if(ae===M)break;if(H===4)for(H=b.return;H!==null;){var we=H.tag;if((we===3||we===4)&&H.stateNode.containerInfo===M)return;H=H.return}for(;ae!==null;){if(H=sa(ae),H===null)return;if(we=H.tag,we===5||we===6||we===26||we===27){b=z=H;continue e}ae=ae.parentNode}}b=b.return}So(function(){var Ye=z,ct=er(m),xt=[];e:{var We=tc.get(r);if(We!==void 0){var et=rl,un=r;switch(r){case"keypress":if(Co(m)===0)break e;case"keydown":case"keyup":et=Zc;break;case"focusin":un="focus",et=Sa;break;case"focusout":un="blur",et=Sa;break;case"beforeblur":case"afterblur":et=Sa;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=Bu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Zr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Mg;break;case ll:case qu:case Hu:et=bf;break;case ec:et=Fu;break;case"scroll":case"scrollend":et=ad;break;case"wheel":et=$p;break;case"copy":case"cut":case"paste":et=ko;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=cd;break;case"toggle":case"beforetoggle":et=Yp}var ln=(u&4)!==0,_n=!ln&&(r==="scroll"||r==="scrollend"),Pe=ln?We!==null?We+"Capture":null:We;ln=[];for(var Ie=Ye,Fe;Ie!==null;){var dt=Ie;if(Fe=dt.stateNode,dt=dt.tag,dt!==5&&dt!==26&&dt!==27||Fe===null||Pe===null||(dt=Ao(Ie,Pe),dt!=null&&ln.push(qd(Ie,dt,Fe))),_n)break;Ie=Ie.return}0<ln.length&&(We=new et(We,un,null,m,ct),xt.push({event:We,listeners:ln}))}}if((u&7)===0){e:{if(We=r==="mouseover"||r==="pointerover",et=r==="mouseout"||r==="pointerout",We&&m!==Vr&&(un=m.relatedTarget||m.fromElement)&&(sa(un)||un[nn]))break e;if((et||We)&&(We=ct.window===ct?ct:(We=ct.ownerDocument)?We.defaultView||We.parentWindow:window,et?(un=m.relatedTarget||m.toElement,et=Ye,un=un?sa(un):null,un!==null&&(_n=_(un),ln=un.tag,un!==_n||ln!==5&&ln!==27&&ln!==6)&&(un=null)):(et=null,un=Ye),et!==un)){if(ln=Bu,dt="onMouseLeave",Pe="onMouseEnter",Ie="mouse",(r==="pointerout"||r==="pointerover")&&(ln=cd,dt="onPointerLeave",Pe="onPointerEnter",Ie="pointer"),_n=et==null?We:Bi(et),Fe=un==null?We:Bi(un),We=new ln(dt,Ie+"leave",et,m,ct),We.target=_n,We.relatedTarget=Fe,dt=null,sa(ct)===Ye&&(ln=new ln(Pe,Ie+"enter",un,m,ct),ln.target=Fe,ln.relatedTarget=_n,dt=ln),_n=dt,et&&un)t:{for(ln=et,Pe=un,Ie=0,Fe=ln;Fe;Fe=Sh(Fe))Ie++;for(Fe=0,dt=Pe;dt;dt=Sh(dt))Fe++;for(;0<Ie-Fe;)ln=Sh(ln),Ie--;for(;0<Fe-Ie;)Pe=Sh(Pe),Fe--;for(;Ie--;){if(ln===Pe||Pe!==null&&ln===Pe.alternate)break t;ln=Sh(ln),Pe=Sh(Pe)}ln=null}else ln=null;et!==null&&Mc(xt,We,et,ln,!1),un!==null&&_n!==null&&Mc(xt,_n,un,ln,!0)}}e:{if(We=Ye?Bi(Ye):window,et=We.nodeName&&We.nodeName.toLowerCase(),et==="select"||et==="input"&&We.type==="file")var Ut=pd;else if(Hc(We))if(md)Ut=Bn;else{Ut=Df;var Fn=Cf}else et=We.nodeName,!et||et.toLowerCase()!=="input"||We.type!=="checkbox"&&We.type!=="radio"?Ye&&mr(Ye.elementType)&&(Ut=pd):Ut=Xp;if(Ut&&(Ut=Ut(r,Ye))){Hp(xt,Ut,m,ct);break e}Fn&&Fn(r,We,Ye),r==="focusout"&&Ye&&We.type==="number"&&Ye.memoizedProps.value!=null&&Vs(We,"number",We.value)}switch(Fn=Ye?Bi(Ye):window,r){case"focusin":(Hc(Fn)||Fn.contentEditable==="true")&&(zo=Fn,Wc=Ye,sl=null);break;case"focusout":sl=Wc=zo=null;break;case"mousedown":Yu=!0;break;case"contextmenu":case"mouseup":case"dragend":Yu=!1,ol(xt,m,ct);break;case"selectionchange":if(Jp)break;case"keydown":case"keyup":ol(xt,m,ct)}var an;if(Sf)e:{switch(r){case"compositionstart":var hn="onCompositionStart";break e;case"compositionend":hn="onCompositionEnd";break e;case"compositionupdate":hn="onCompositionUpdate";break e}hn=void 0}else Ql?dd(r,m)&&(hn="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(hn="onCompositionStart");hn&&(Af&&m.locale!=="ko"&&(Ql||hn!=="onCompositionStart"?hn==="onCompositionEnd"&&Ql&&(an=Dn()):(xn=ct,fn="value"in xn?xn.value:xn.textContent,Ql=!0)),Fn=zm(Ye,hn),0<Fn.length&&(hn=new Zp(hn,r,null,m,ct),xt.push({event:hn,listeners:Fn}),an?hn.data=an:(an=Mf(m),an!==null&&(hn.data=an)))),(an=Cg?Kl(r,m):fd(r,m))&&(hn=zm(Ye,"onBeforeInput"),0<hn.length&&(Fn=new Zp("onBeforeInput","beforeinput",null,m,ct),xt.push({event:Fn,listeners:hn}),Fn.data=an)),h0(xt,r,Ye,m,ct)}Ka(xt,u)})}function qd(r,u,m){return{instance:r,listener:u,currentTarget:m}}function zm(r,u){for(var m=u+"Capture",b=[];r!==null;){var M=r,z=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||z===null||(M=Ao(r,m),M!=null&&b.unshift(qd(r,M,z)),M=Ao(r,u),M!=null&&b.push(qd(r,M,z))),r.tag===3)return b;r=r.return}return[]}function Sh(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Mc(r,u,m,b,M){for(var z=u._reactName,H=[];m!==null&&m!==b;){var ae=m,we=ae.alternate,Ye=ae.stateNode;if(ae=ae.tag,we!==null&&we===b)break;ae!==5&&ae!==26&&ae!==27||Ye===null||(we=Ye,M?(Ye=Ao(m,z),Ye!=null&&H.unshift(qd(m,Ye,we))):M||(Ye=Ao(m,z),Ye!=null&&H.push(qd(m,Ye,we)))),m=m.return}H.length!==0&&r.push({event:u,listeners:H})}var p0=/\r\n?/g,m0=/\u0000|\uFFFD/g;function dy(r){return(typeof r=="string"?r:""+r).replace(p0,`
`).replace(m0,"")}function fy(r,u){return u=dy(u),dy(r)===u}function Lm(){}function xi(r,u,m,b,M,z){switch(m){case"children":typeof b=="string"?u==="body"||u==="textarea"&&b===""||kr(r,b):(typeof b=="number"||typeof b=="bigint")&&u!=="body"&&kr(r,""+b);break;case"className":Lu(r,"class",b);break;case"tabIndex":Lu(r,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":Lu(r,m,b);break;case"style":Ur(r,b,z);break;case"data":if(u!=="object"){Lu(r,"data",b);break}case"src":case"href":if(b===""&&(u!=="a"||m!=="href")){r.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){r.removeAttribute(m);break}b=Sr(""+b),r.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){r.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(m==="formAction"?(u!=="input"&&xi(r,u,"name",M.name,M,null),xi(r,u,"formEncType",M.formEncType,M,null),xi(r,u,"formMethod",M.formMethod,M,null),xi(r,u,"formTarget",M.formTarget,M,null)):(xi(r,u,"encType",M.encType,M,null),xi(r,u,"method",M.method,M,null),xi(r,u,"target",M.target,M,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){r.removeAttribute(m);break}b=Sr(""+b),r.setAttribute(m,b);break;case"onClick":b!=null&&(r.onclick=Lm);break;case"onScroll":b!=null&&En("scroll",r);break;case"onScrollEnd":b!=null&&En("scrollend",r);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(h(61));if(m=b.__html,m!=null){if(M.children!=null)throw Error(h(60));r.innerHTML=m}}break;case"multiple":r.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":r.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){r.removeAttribute("xlink:href");break}m=Sr(""+b),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?r.setAttribute(m,""+b):r.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?r.setAttribute(m,""):r.removeAttribute(m);break;case"capture":case"download":b===!0?r.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?r.setAttribute(m,b):r.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?r.setAttribute(m,b):r.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?r.removeAttribute(m):r.setAttribute(m,b);break;case"popover":En("beforetoggle",r),En("toggle",r),Eo(r,"popover",b);break;case"xlinkActuate":Us(r,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Us(r,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Us(r,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Us(r,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Us(r,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Us(r,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Us(r,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Us(r,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Us(r,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":Eo(r,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=Di.get(m)||m,Eo(r,m,b))}}function Nm(r,u,m,b,M,z){switch(m){case"style":Ur(r,b,z);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(h(61));if(m=b.__html,m!=null){if(M.children!=null)throw Error(h(60));r.innerHTML=m}}break;case"children":typeof b=="string"?kr(r,b):(typeof b=="number"||typeof b=="bigint")&&kr(r,""+b);break;case"onScroll":b!=null&&En("scroll",r);break;case"onScrollEnd":b!=null&&En("scrollend",r);break;case"onClick":b!=null&&(r.onclick=Lm);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!To.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(M=m.endsWith("Capture"),u=m.slice(2,M?m.length-7:void 0),z=r[jt]||null,z=z!=null?z[m]:null,typeof z=="function"&&r.removeEventListener(u,z,M),typeof b=="function")){typeof z!="function"&&z!==null&&(m in r?r[m]=null:r.hasAttribute(m)&&r.removeAttribute(m)),r.addEventListener(u,b,M);break e}m in r?r[m]=b:b===!0?r.setAttribute(m,""):Eo(r,m,b)}}}function _r(r,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":En("error",r),En("load",r);var b=!1,M=!1,z;for(z in m)if(m.hasOwnProperty(z)){var H=m[z];if(H!=null)switch(z){case"src":b=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:xi(r,u,z,H,m,null)}}M&&xi(r,u,"srcSet",m.srcSet,m,null),b&&xi(r,u,"src",m.src,m,null);return;case"input":En("invalid",r);var ae=z=H=M=null,we=null,Ye=null;for(b in m)if(m.hasOwnProperty(b)){var ct=m[b];if(ct!=null)switch(b){case"name":M=ct;break;case"type":H=ct;break;case"checked":we=ct;break;case"defaultChecked":Ye=ct;break;case"value":z=ct;break;case"defaultValue":ae=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(h(137,u));break;default:xi(r,u,b,ct,m,null)}}nl(r,z,ae,we,Ye,H,M,!1),Pu(r);return;case"select":En("invalid",r),b=H=z=null;for(M in m)if(m.hasOwnProperty(M)&&(ae=m[M],ae!=null))switch(M){case"value":z=ae;break;case"defaultValue":H=ae;break;case"multiple":b=ae;default:xi(r,u,M,ae,m,null)}u=z,m=H,r.multiple=!!b,u!=null?oa(r,!!b,u,!1):m!=null&&oa(r,!!b,m,!0);return;case"textarea":En("invalid",r),z=M=b=null;for(H in m)if(m.hasOwnProperty(H)&&(ae=m[H],ae!=null))switch(H){case"value":b=ae;break;case"defaultValue":M=ae;break;case"children":z=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(h(91));break;default:xi(r,u,H,ae,m,null)}kn(r,b,M,z),Pu(r);return;case"option":for(we in m)if(m.hasOwnProperty(we)&&(b=m[we],b!=null))switch(we){case"selected":r.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:xi(r,u,we,b,m,null)}return;case"dialog":En("beforetoggle",r),En("toggle",r),En("cancel",r),En("close",r);break;case"iframe":case"object":En("load",r);break;case"video":case"audio":for(b=0;b<Eh.length;b++)En(Eh[b],r);break;case"image":En("error",r),En("load",r);break;case"details":En("toggle",r);break;case"embed":case"source":case"link":En("error",r),En("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ye in m)if(m.hasOwnProperty(Ye)&&(b=m[Ye],b!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:xi(r,u,Ye,b,m,null)}return;default:if(mr(u)){for(ct in m)m.hasOwnProperty(ct)&&(b=m[ct],b!==void 0&&Nm(r,u,ct,b,m,void 0));return}}for(ae in m)m.hasOwnProperty(ae)&&(b=m[ae],b!=null&&xi(r,u,ae,b,m,null))}function g0(r,u,m,b){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,z=null,H=null,ae=null,we=null,Ye=null,ct=null;for(et in m){var xt=m[et];if(m.hasOwnProperty(et)&&xt!=null)switch(et){case"checked":break;case"value":break;case"defaultValue":we=xt;default:b.hasOwnProperty(et)||xi(r,u,et,null,b,xt)}}for(var We in b){var et=b[We];if(xt=m[We],b.hasOwnProperty(We)&&(et!=null||xt!=null))switch(We){case"type":z=et;break;case"name":M=et;break;case"checked":Ye=et;break;case"defaultChecked":ct=et;break;case"value":H=et;break;case"defaultValue":ae=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(h(137,u));break;default:et!==xt&&xi(r,u,We,et,b,xt)}}yn(r,H,ae,we,Ye,ct,z,M);return;case"select":et=H=ae=We=null;for(z in m)if(we=m[z],m.hasOwnProperty(z)&&we!=null)switch(z){case"value":break;case"multiple":et=we;default:b.hasOwnProperty(z)||xi(r,u,z,null,b,we)}for(M in b)if(z=b[M],we=m[M],b.hasOwnProperty(M)&&(z!=null||we!=null))switch(M){case"value":We=z;break;case"defaultValue":ae=z;break;case"multiple":H=z;default:z!==we&&xi(r,u,M,z,b,we)}u=ae,m=H,b=et,We!=null?oa(r,!!m,We,!1):!!b!=!!m&&(u!=null?oa(r,!!m,u,!0):oa(r,!!m,m?[]:"",!1));return;case"textarea":et=We=null;for(ae in m)if(M=m[ae],m.hasOwnProperty(ae)&&M!=null&&!b.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:xi(r,u,ae,null,b,M)}for(H in b)if(M=b[H],z=m[H],b.hasOwnProperty(H)&&(M!=null||z!=null))switch(H){case"value":We=M;break;case"defaultValue":et=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(h(91));break;default:M!==z&&xi(r,u,H,M,b,z)}Hl(r,We,et);return;case"option":for(var un in m)if(We=m[un],m.hasOwnProperty(un)&&We!=null&&!b.hasOwnProperty(un))switch(un){case"selected":r.selected=!1;break;default:xi(r,u,un,null,b,We)}for(we in b)if(We=b[we],et=m[we],b.hasOwnProperty(we)&&We!==et&&(We!=null||et!=null))switch(we){case"selected":r.selected=We&&typeof We!="function"&&typeof We!="symbol";break;default:xi(r,u,we,We,b,et)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ln in m)We=m[ln],m.hasOwnProperty(ln)&&We!=null&&!b.hasOwnProperty(ln)&&xi(r,u,ln,null,b,We);for(Ye in b)if(We=b[Ye],et=m[Ye],b.hasOwnProperty(Ye)&&We!==et&&(We!=null||et!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(h(137,u));break;default:xi(r,u,Ye,We,b,et)}return;default:if(mr(u)){for(var _n in m)We=m[_n],m.hasOwnProperty(_n)&&We!==void 0&&!b.hasOwnProperty(_n)&&Nm(r,u,_n,void 0,b,We);for(ct in b)We=b[ct],et=m[ct],!b.hasOwnProperty(ct)||We===et||We===void 0&&et===void 0||Nm(r,u,ct,We,b,et);return}}for(var Pe in m)We=m[Pe],m.hasOwnProperty(Pe)&&We!=null&&!b.hasOwnProperty(Pe)&&xi(r,u,Pe,null,b,We);for(xt in b)We=b[xt],et=m[xt],!b.hasOwnProperty(xt)||We===et||We==null&&et==null||xi(r,u,xt,We,b,et)}var Hd=null,Pm=null;function Ah(r){return r.nodeType===9?r:r.ownerDocument}function hp(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function dp(r,u){if(r===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&u==="foreignObject"?0:r}function py(r,u){return r==="textarea"||r==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var my=null;function Nv(){var r=window.event;return r&&r.type==="popstate"?r===my?!1:(my=r,!0):(my=null,!1)}var Mh=typeof setTimeout=="function"?setTimeout:void 0,qr=typeof clearTimeout=="function"?clearTimeout:void 0,Cc=typeof Promise=="function"?Promise:void 0,gy=typeof queueMicrotask=="function"?queueMicrotask:typeof Cc<"u"?function(r){return Cc.resolve(null).then(r).catch(y0)}:Mh;function y0(r){setTimeout(function(){throw r})}function Dc(r){return r==="head"}function Om(r,u){var m=u,b=0,M=0;do{var z=m.nextSibling;if(r.removeChild(m),z&&z.nodeType===8)if(m=z.data,m==="/$"){if(0<b&&8>b){m=b;var H=r.ownerDocument;if(m&1&&Ch(H.documentElement),m&2&&Ch(H.body),m&4)for(m=H.head,Ch(m),H=m.firstChild;H;){var ae=H.nextSibling,we=H.nodeName;H[sn]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&H.rel.toLowerCase()==="stylesheet"||m.removeChild(H),H=ae}}if(M===0){r.removeChild(z),Qd(u);return}M--}else m==="$"||m==="$?"||m==="$!"?M++:b=m.charCodeAt(0)-48;else b=0;m=z}while(m);Qd(u)}function yy(r){var u=r.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":yy(m),Ci(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}r.removeChild(m)}}function _0(r,u,m,b){for(;r.nodeType===1;){var M=m;if(r.nodeName.toLowerCase()!==u.toLowerCase()){if(!b&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(b){if(!r[sn])switch(u){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(z=r.getAttribute("rel"),z==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(z!==M.rel||r.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(z=r.getAttribute("src"),(z!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&z&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(u==="input"&&r.type==="hidden"){var z=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===z)return r}else return r;if(r=ys(r.nextSibling),r===null)break}return null}function v0(r,u,m){if(u==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!m||(r=ys(r.nextSibling),r===null))return null;return r}function _y(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function x0(r,u){var m=r.ownerDocument;if(r.data!=="$?"||m.readyState==="complete")u();else{var b=function(){u(),m.removeEventListener("DOMContentLoaded",b)};m.addEventListener("DOMContentLoaded",b),r._reactRetry=b}}function ys(r){for(;r!=null;r=r.nextSibling){var u=r.nodeType;if(u===1||u===3)break;if(u===8){if(u=r.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return r}var fp=null;function vy(r){r=r.previousSibling;for(var u=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(u===0)return r;u--}else m==="/$"&&u++}r=r.previousSibling}return null}function Xd(r,u,m){switch(u=Ah(m),r){case"html":if(r=u.documentElement,!r)throw Error(h(452));return r;case"head":if(r=u.head,!r)throw Error(h(453));return r;case"body":if(r=u.body,!r)throw Error(h(454));return r;default:throw Error(h(451))}}function Ch(r){for(var u=r.attributes;u.length;)r.removeAttributeNode(u[0]);Ci(r)}var _s=new Map,jm=new Set;function Dh(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var vs=vt.d;vt.d={f:xy,r:by,D:o,C:t,L:l,m:d,X:T,S:y,M:E};function xy(){var r=vs.f(),u=np();return r||u}function by(r){var u=qt(r);u!==null&&u.tag===5&&u.type==="form"?ds(u):vs.r(r)}var pu=typeof document>"u"?null:document;function b0(r,u,m){var b=pu;if(b&&typeof u=="string"&&u){var M=$i(u);M='link[rel="'+r+'"][href="'+M+'"]',typeof m=="string"&&(M+='[crossorigin="'+m+'"]'),jm.has(M)||(jm.add(M),r={rel:r,crossOrigin:m,href:u},b.querySelector(M)===null&&(u=b.createElement("link"),_r(u,"link",r),Ji(u),b.head.appendChild(u)))}}function o(r){vs.D(r),b0("dns-prefetch",r,null)}function t(r,u){vs.C(r,u),b0("preconnect",r,u)}function l(r,u,m){vs.L(r,u,m);var b=pu;if(b&&r&&u){var M='link[rel="preload"][as="'+$i(u)+'"]';u==="image"&&m&&m.imageSrcSet?(M+='[imagesrcset="'+$i(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(M+='[imagesizes="'+$i(m.imageSizes)+'"]')):M+='[href="'+$i(r)+'"]';var z=M;switch(u){case"style":z=I(r);break;case"script":z=$(r)}_s.has(z)||(r=P({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:r,as:u},m),_s.set(z,r),b.querySelector(M)!==null||u==="style"&&b.querySelector(L(z))||u==="script"&&b.querySelector(q(z))||(u=b.createElement("link"),_r(u,"link",r),Ji(u),b.head.appendChild(u)))}}function d(r,u){vs.m(r,u);var m=pu;if(m&&r){var b=u&&typeof u.as=="string"?u.as:"script",M='link[rel="modulepreload"][as="'+$i(b)+'"][href="'+$i(r)+'"]',z=M;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=$(r)}if(!_s.has(z)&&(r=P({rel:"modulepreload",href:r},u),_s.set(z,r),m.querySelector(M)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(q(z)))return}b=m.createElement("link"),_r(b,"link",r),Ji(b),m.head.appendChild(b)}}}function y(r,u,m){vs.S(r,u,m);var b=pu;if(b&&r){var M=$n(b).hoistableStyles,z=I(r);u=u||"default";var H=M.get(z);if(!H){var ae={loading:0,preload:null};if(H=b.querySelector(L(z)))ae.loading=5;else{r=P({rel:"stylesheet",href:r,"data-precedence":u},m),(m=_s.get(z))&&le(r,m);var we=H=b.createElement("link");Ji(we),_r(we,"link",r),we._p=new Promise(function(Ye,ct){we.onload=Ye,we.onerror=ct}),we.addEventListener("load",function(){ae.loading|=1}),we.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,J(H,u,b)}H={type:"stylesheet",instance:H,count:1,state:ae},M.set(z,H)}}}function T(r,u){vs.X(r,u);var m=pu;if(m&&r){var b=$n(m).hoistableScripts,M=$(r),z=b.get(M);z||(z=m.querySelector(q(M)),z||(r=P({src:r,async:!0},u),(u=_s.get(M))&&fe(r,u),z=m.createElement("script"),Ji(z),_r(z,"link",r),m.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},b.set(M,z))}}function E(r,u){vs.M(r,u);var m=pu;if(m&&r){var b=$n(m).hoistableScripts,M=$(r),z=b.get(M);z||(z=m.querySelector(q(M)),z||(r=P({src:r,async:!0,type:"module"},u),(u=_s.get(M))&&fe(r,u),z=m.createElement("script"),Ji(z),_r(z,"link",r),m.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},b.set(M,z))}}function A(r,u,m,b){var M=(M=tn.current)?Dh(M):null;if(!M)throw Error(h(446));switch(r){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=I(m.href),m=$n(M).hoistableStyles,b=m.get(u),b||(b={type:"style",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){r=I(m.href);var z=$n(M).hoistableStyles,H=z.get(r);if(H||(M=M.ownerDocument||M,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(r,H),(z=M.querySelector(L(r)))&&!z._p&&(H.instance=z,H.state.loading=5),_s.has(r)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},_s.set(r,m),z||B(M,r,m,H.state))),u&&b===null)throw Error(h(528,""));return H}if(u&&b!==null)throw Error(h(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=$(m),m=$n(M).hoistableScripts,b=m.get(u),b||(b={type:"script",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(h(444,r))}}function I(r){return'href="'+$i(r)+'"'}function L(r){return'link[rel="stylesheet"]['+r+"]"}function O(r){return P({},r,{"data-precedence":r.precedence,precedence:null})}function B(r,u,m,b){r.querySelector('link[rel="preload"][as="style"]['+u+"]")?b.loading=1:(u=r.createElement("link"),b.preload=u,u.addEventListener("load",function(){return b.loading|=1}),u.addEventListener("error",function(){return b.loading|=2}),_r(u,"link",m),Ji(u),r.head.appendChild(u))}function $(r){return'[src="'+$i(r)+'"]'}function q(r){return"script[async]"+r}function W(r,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var b=r.querySelector('style[data-href~="'+$i(m.href)+'"]');if(b)return u.instance=b,Ji(b),b;var M=P({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(r.ownerDocument||r).createElement("style"),Ji(b),_r(b,"style",M),J(b,m.precedence,r),u.instance=b;case"stylesheet":M=I(m.href);var z=r.querySelector(L(M));if(z)return u.state.loading|=4,u.instance=z,Ji(z),z;b=O(m),(M=_s.get(M))&&le(b,M),z=(r.ownerDocument||r).createElement("link"),Ji(z);var H=z;return H._p=new Promise(function(ae,we){H.onload=ae,H.onerror=we}),_r(z,"link",b),u.state.loading|=4,J(z,m.precedence,r),u.instance=z;case"script":return z=$(m.src),(M=r.querySelector(q(z)))?(u.instance=M,Ji(M),M):(b=m,(M=_s.get(z))&&(b=P({},m),fe(b,M)),r=r.ownerDocument||r,M=r.createElement("script"),Ji(M),_r(M,"link",b),r.head.appendChild(M),u.instance=M);case"void":return null;default:throw Error(h(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(b=u.instance,u.state.loading|=4,J(b,m.precedence,r));return u.instance}function J(r,u,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=b.length?b[b.length-1]:null,z=M,H=0;H<b.length;H++){var ae=b[H];if(ae.dataset.precedence===u)z=ae;else if(z!==M)break}z?z.parentNode.insertBefore(r,z.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(r,u.firstChild))}function le(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.title==null&&(r.title=u.title)}function fe(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.integrity==null&&(r.integrity=u.integrity)}var Ee=null;function ye(r,u,m){if(Ee===null){var b=new Map,M=Ee=new Map;M.set(m,b)}else M=Ee,b=M.get(m),b||(b=new Map,M.set(m,b));if(b.has(r))return b;for(b.set(r,null),m=m.getElementsByTagName(r),M=0;M<m.length;M++){var z=m[M];if(!(z[sn]||z[$t]||r==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var H=z.getAttribute(u)||"";H=r+H;var ae=b.get(H);ae?ae.push(z):b.set(H,[z])}}return b}function Y(r,u,m){r=r.ownerDocument||r,r.head.insertBefore(m,u==="title"?r.querySelector("head > title"):null)}function oe(r,u,m){if(m===1||u.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return r=u.disabled,typeof u.precedence=="string"&&r==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function ve(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Ve=null;function pt(){}function qe(r,u,m){if(Ve===null)throw Error(h(475));var b=Ve;if(u.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var M=I(m.href),z=r.querySelector(L(M));if(z){r=z._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(b.count++,b=wt.bind(b),r.then(b,b)),u.state.loading|=4,u.instance=z,Ji(z);return}z=r.ownerDocument||r,m=O(m),(M=_s.get(M))&&le(m,M),z=z.createElement("link"),Ji(z);var H=z;H._p=new Promise(function(ae,we){H.onload=ae,H.onerror=we}),_r(z,"link",m),u.instance=z}b.stylesheets===null&&(b.stylesheets=new Map),b.stylesheets.set(u,r),(r=u.state.preload)&&(u.state.loading&3)===0&&(b.count++,u=wt.bind(b),r.addEventListener("load",u),r.addEventListener("error",u))}}function tt(){if(Ve===null)throw Error(h(475));var r=Ve;return r.stylesheets&&r.count===0&&Tt(r,r.stylesheets),0<r.count?function(u){var m=setTimeout(function(){if(r.stylesheets&&Tt(r,r.stylesheets),r.unsuspend){var b=r.unsuspend;r.unsuspend=null,b()}},6e4);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(m)}}:null}function wt(){if(this.count--,this.count===0){if(this.stylesheets)Tt(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var ft=null;function Tt(r,u){r.stylesheets=null,r.unsuspend!==null&&(r.count++,ft=new Map,u.forEach(ot,r),ft=null,wt.call(r))}function ot(r,u){if(!(u.state.loading&4)){var m=ft.get(r);if(m)var b=m.get(null);else{m=new Map,ft.set(r,m);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<M.length;z++){var H=M[z];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(m.set(H.dataset.precedence,H),b=H)}b&&m.set(null,b)}M=u.instance,H=M.getAttribute("data-precedence"),z=m.get(H)||b,z===b&&m.set(null,M),m.set(H,M),this.count++,b=wt.bind(this),M.addEventListener("load",b),M.addEventListener("error",b),z?z.parentNode.insertBefore(M,z.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),u.state.loading|=4}}var Pt={$$typeof:He,Provider:null,Consumer:null,_currentValue:mt,_currentValue2:mt,_threadCount:0};function Jt(r,u,m,b,M,z,H,ae){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=b,this.onUncaughtError=M,this.onCaughtError=z,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function Xt(r,u,m,b,M,z,H,ae,we,Ye,ct,xt){return r=new Jt(r,u,m,H,ae,we,Ye,xt),u=1,z===!0&&(u|=24),z=Kr(3,null,null,u),r.current=z,z.stateNode=r,u=cc(),u.refCount++,r.pooledCache=u,u.refCount++,z.memoizedState={element:b,isDehydrated:m,cache:u},nu(z),r}function Gt(r){return r?(r=No,r):No}function Sn(r,u,m,b,M,z){M=Gt(M),b.context===null?b.context=M:b.pendingContext=M,b=jo(u),b.payload={element:m},z=z===void 0?null:z,z!==null&&(b.callback=z),m=us(r,b,u),m!==null&&(ma(m,r,u),ih(m,r,u))}function ji(r,u){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<u?m:u}}function nr(r,u){ji(r,u),(r=r.alternate)&&ji(r,u)}function jr(r){if(r.tag===13){var u=Qc(r,67108864);u!==null&&ma(u,r,67108864),nr(r,67108864)}}var ga=!0;function Ra(r,u,m,b){var M=Oe.T;Oe.T=null;var z=vt.p;try{vt.p=2,bi(r,u,m,b)}finally{vt.p=z,Oe.T=M}}function Br(r,u,m,b){var M=Oe.T;Oe.T=null;var z=vt.p;try{vt.p=8,bi(r,u,m,b)}finally{vt.p=z,Oe.T=M}}function bi(r,u,m,b){if(ga){var M=ur(b);if(M===null)Rm(r,u,b,hr,m),lo(r,b);else if($o(M,r,u,m,b))b.stopPropagation();else if(lo(r,b),u&4&&-1<Ti.indexOf(r)){for(;M!==null;){var z=qt(M);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var H=Ne(z.pendingLanes);if(H!==0){var ae=z;for(ae.pendingLanes|=2,ae.entangledLanes|=2;H;){var we=1<<31-Gi(H);ae.entanglements[1]|=we,H&=~we}Dl(z),(si&6)===0&&(Vd=li()+500,op(0))}}break;case 13:ae=Qc(z,2),ae!==null&&ma(ae,z,2),np(),nr(z,2)}if(z=ur(b),z===null&&Rm(r,u,b,hr,m),z===M)break;M=z}M!==null&&b.stopPropagation()}else Rm(r,u,b,null,m)}}function ur(r){return r=er(r),vr(r)}var hr=null;function vr(r){if(hr=null,r=sa(r),r!==null){var u=_(r);if(u===null)r=null;else{var m=u.tag;if(m===13){if(r=v(u),r!==null)return r;r=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;r=null}else u!==r&&(r=null)}}return hr=r,null}function ra(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(js()){case is:return 2;case rr:return 8;case fr:case xo:return 32;case Bs:return 268435456;default:return 32}default:return 32}}var za=!1,zi=null,dr=null,wi=null,Xi=new Map,Wi=new Map,fi=[],Ti="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lo(r,u){switch(r){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":Xi.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wi.delete(u.pointerId)}}function kl(r,u,m,b,M,z){return r===null||r.nativeEvent!==z?(r={blockedOn:u,domEventName:m,eventSystemFlags:b,nativeEvent:z,targetContainers:[M]},u!==null&&(u=qt(u),u!==null&&jr(u)),r):(r.eventSystemFlags|=b,u=r.targetContainers,M!==null&&u.indexOf(M)===-1&&u.push(M),r)}function $o(r,u,m,b,M){switch(u){case"focusin":return zi=kl(zi,r,u,m,b,M),!0;case"dragenter":return dr=kl(dr,r,u,m,b,M),!0;case"mouseover":return wi=kl(wi,r,u,m,b,M),!0;case"pointerover":var z=M.pointerId;return Xi.set(z,kl(Xi.get(z)||null,r,u,m,b,M)),!0;case"gotpointercapture":return z=M.pointerId,Wi.set(z,kl(Wi.get(z)||null,r,u,m,b,M)),!0}return!1}function w0(r){var u=sa(r.target);if(u!==null){var m=_(u);if(m!==null){if(u=m.tag,u===13){if(u=v(m),u!==null){r.blockedOn=u,Rt(r.priority,function(){if(m.tag===13){var b=ia();b=je(b);var M=Qc(m,b);M!==null&&ma(M,m,b),nr(m,b)}});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function kc(r){if(r.blockedOn!==null)return!1;for(var u=r.targetContainers;0<u.length;){var m=ur(r.nativeEvent);if(m===null){m=r.nativeEvent;var b=new m.constructor(m.type,m);Vr=b,m.target.dispatchEvent(b),Vr=null}else return u=qt(m),u!==null&&jr(u),r.blockedOn=m,!1;u.shift()}return!0}function mu(r,u,m){kc(r)&&m.delete(u)}function Wd(){za=!1,zi!==null&&kc(zi)&&(zi=null),dr!==null&&kc(dr)&&(dr=null),wi!==null&&kc(wi)&&(wi=null),Xi.forEach(mu),Wi.forEach(mu)}function Ic(r,u){r.blockedOn===u&&(r.blockedOn=null,za||(za=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Wd)))}var Rc=null;function wy(r){Rc!==r&&(Rc=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Rc===r&&(Rc=null);for(var u=0;u<r.length;u+=3){var m=r[u],b=r[u+1],M=r[u+2];if(typeof b!="function"){if(vr(b||m)===null)continue;break}var z=qt(m);z!==null&&(r.splice(u,3),u-=3,eo(z,{pending:!0,data:M,method:m.method,action:b},b,M))}}))}function Qd(r){function u(we){return Ic(we,r)}zi!==null&&Ic(zi,r),dr!==null&&Ic(dr,r),wi!==null&&Ic(wi,r),Xi.forEach(u),Wi.forEach(u);for(var m=0;m<fi.length;m++){var b=fi[m];b.blockedOn===r&&(b.blockedOn=null)}for(;0<fi.length&&(m=fi[0],m.blockedOn===null);)w0(m),m.blockedOn===null&&fi.shift();if(m=(r.ownerDocument||r).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var M=m[b],z=m[b+1],H=M[jt]||null;if(typeof z=="function")H||wy(m);else if(H){var ae=null;if(z&&z.hasAttribute("formAction")){if(M=z,H=z[jt]||null)ae=H.formAction;else if(vr(M)!==null)continue}else ae=H.action;typeof ae=="function"?m[b+1]=ae:(m.splice(b,3),b-=3),wy(m)}}}function Bm(r){this._internalRoot=r}pp.prototype.render=Bm.prototype.render=function(r){var u=this._internalRoot;if(u===null)throw Error(h(409));var m=u.current,b=ia();Sn(m,b,r,u,null,null)},pp.prototype.unmount=Bm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var u=r.containerInfo;Sn(r.current,2,null,r,null,null),np(),u[nn]=null}};function pp(r){this._internalRoot=r}pp.prototype.unstable_scheduleHydration=function(r){if(r){var u=Ct();r={blockedOn:null,target:r,priority:u};for(var m=0;m<fi.length&&u!==0&&u<fi[m].priority;m++);fi.splice(m,0,r),m===0&&w0(r)}};var Fm=n.version;if(Fm!=="19.1.0")throw Error(h(527,Fm,"19.1.0"));vt.findDOMNode=function(r){var u=r._reactInternals;if(u===void 0)throw typeof r.render=="function"?Error(h(188)):(r=Object.keys(r).join(","),Error(h(268,r)));return r=C(u),r=r!==null?k(r):null,r=r===null?null:r.stateNode,r};var Ty={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Oe,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var co=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!co.isDisabled&&co.supportsFiber)try{Xr=co.inject(Ty),Ki=co}catch{}}return Sy.createRoot=function(r,u){if(!p(r))throw Error(h(299));var m=!1,b="",M=j_,z=Lg,H=Ng,ae=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(M=u.onUncaughtError),u.onCaughtError!==void 0&&(z=u.onCaughtError),u.onRecoverableError!==void 0&&(H=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ae=u.unstable_transitionCallbacks)),u=Xt(r,1,!1,null,null,m,b,M,z,H,ae,null),r[nn]=u.current,Im(r),new Bm(u)},Sy.hydrateRoot=function(r,u,m){if(!p(r))throw Error(h(299));var b=!1,M="",z=j_,H=Lg,ae=Ng,we=null,Ye=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onUncaughtError!==void 0&&(z=m.onUncaughtError),m.onCaughtError!==void 0&&(H=m.onCaughtError),m.onRecoverableError!==void 0&&(ae=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(we=m.unstable_transitionCallbacks),m.formState!==void 0&&(Ye=m.formState)),u=Xt(r,1,!0,u,m??null,b,M,z,H,ae,we,Ye),u.context=Gt(null),m=u.current,b=ia(),b=je(b),M=jo(b),M.callback=null,us(m,M,b),m=b,u.current.lanes=m,Be(u,m),Dl(u),r[nn]=u.current,Im(r),new pp(u)},Sy.version="19.1.0",Sy}var Qb;function uS(){if(Qb)return jv.exports;Qb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),jv.exports=cS(),jv.exports}var hS=uS();const dS=Lp(hS),fS="modulepreload",pS=function(i){return"https://www.opentripplanner.org/debug-client-assets/2025/05/2025-05-02T06:44/"+i},Kb={},qw=function(n,a,h){let p=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),c=(v==null?void 0:v.nonce)||(v==null?void 0:v.getAttribute("nonce"));p=Promise.allSettled(a.map(C=>{if(C=pS(C),C in Kb)return;Kb[C]=!0;const k=C.endsWith(".css"),P=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${C}"]${P}`))return;const j=document.createElement("link");if(j.rel=k?"stylesheet":fS,k||(j.as="script"),j.crossOrigin="",j.href=C,c&&j.setAttribute("nonce",c),document.head.appendChild(j),k)return new Promise((U,V)=>{j.addEventListener("load",U),j.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${C}`)))})}))}function _(v){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=v,window.dispatchEvent(c),!c.defaultPrevented)throw v}return p.then(v=>{for(const c of v||[])c.status==="rejected"&&_(c.reason);return n().catch(_)})},mS=ce.createContext(null);function gS(i,n){const a=Array.isArray(i)?i[0]:i?i.x:0,h=Array.isArray(i)?i[1]:i?i.y:0,p=Array.isArray(n)?n[0]:n?n.x:0,_=Array.isArray(n)?n[1]:n?n.y:0;return a===p&&h===_}function uo(i,n){if(i===n)return!0;if(!i||!n)return!1;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let a=0;a<i.length;a++)if(!uo(i[a],n[a]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof i=="object"&&typeof n=="object"){const a=Object.keys(i),h=Object.keys(n);if(a.length!==h.length)return!1;for(const p of a)if(!n.hasOwnProperty(p)||!uo(i[p],n[p]))return!1;return!0}return!1}function Jb(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function e1(i,n){const a=n.viewState||n,h={};if("longitude"in a&&"latitude"in a&&(a.longitude!==i.center.lng||a.latitude!==i.center.lat)){const p=i.center.constructor;h.center=new p(a.longitude,a.latitude)}return"zoom"in a&&a.zoom!==i.zoom&&(h.zoom=a.zoom),"bearing"in a&&a.bearing!==i.bearing&&(h.bearing=a.bearing),"pitch"in a&&a.pitch!==i.pitch&&(h.pitch=a.pitch),a.padding&&i.padding&&!uo(a.padding,i.padding)&&(h.padding=a.padding),h}const yS=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function t1(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const n={};for(const h of i.layers)n[h.id]=h;const a=i.layers.map(h=>{let p=null;"interactive"in h&&(p=Object.assign({},h),delete p.interactive);const _=n[h.ref];if(_){p=p||Object.assign({},h),delete p.ref;for(const v of yS)v in _&&(p[v]=_[v])}return p||h});return{...i,layers:a}}const n1={version:8,sources:{},layers:[]},i1={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},r1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},a1={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},_S=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],vS=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ng{constructor(n,a,h){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=p=>{const _=this.props[a1[p.type]];_?_(p):p.type==="error"&&console.error(p.error)},this._onCameraEvent=p=>{if(this._internalUpdate)return;p.viewState=this._propsedCameraUpdate||Jb(this._map.transform);const _=this.props[r1[p.type]];_&&_(p)},this._onCameraUpdate=p=>this._internalUpdate?p:(this._propsedCameraUpdate=Jb(p),e1(p,this.props)),this._onPointerEvent=p=>{(p.type==="mousemove"||p.type==="mouseout")&&this._updateHover(p);const _=this.props[i1[p.type]];_&&(this.props.interactiveLayerIds&&p.type!=="mouseover"&&p.type!=="mouseout"&&(p.features=this._hoveredFeatures||this._queryRenderedFeatures(p.point)),_(p),delete p.features)},this._MapClass=n,this.props=a,this._initialize(h)}get map(){return this._map}setProps(n){const a=this.props;this.props=n;const h=this._updateSettings(n,a),p=this._updateSize(n),_=this._updateViewState(n);this._updateStyle(n,a),this._updateStyleComponents(n),this._updateHandlers(n,a),(h||p||_&&!this._map.isMoving())&&this.redraw()}static reuse(n,a){const h=ng.savedMaps.pop();if(!h)return null;const p=h.map,_=p.getContainer();for(a.className=_.className;_.childNodes.length>0;)a.appendChild(_.childNodes[0]);p._container=a;const v=p._resizeObserver;v&&(v.disconnect(),v.observe(a)),h.setProps({...n,styleDiffing:!1}),p.resize();const{initialViewState:c}=n;return c&&(c.bounds?p.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):h._updateViewState(c)),p.isStyleLoaded()?p.fire("load"):p.once("style.load",()=>p.fire("load")),p._update(),h}_initialize(n){const{props:a}=this,{mapStyle:h=n1}=a,p={...a,...a.initialViewState,container:n,style:t1(h)},_=p.initialViewState||p.viewState||p;if(Object.assign(p,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),a.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,a.gl)}const v=new this._MapClass(p);_.padding&&v.setPadding(_.padding),a.cursor&&(v.getCanvas().style.cursor=a.cursor),v.transformCameraUpdate=this._onCameraUpdate,v.on("style.load",()=>{var c;this._styleComponents={light:v.getLight(),sky:v.getSky(),projection:(c=v.getProjection)==null?void 0:c.call(v),terrain:v.getTerrain()},this._updateStyleComponents(this.props)}),v.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in i1)v.on(c,this._onPointerEvent);for(const c in r1)v.on(c,this._onCameraEvent);for(const c in a1)v.on(c,this._onEvent);this._map=v}recycle(){const a=this.map.getContainer().querySelector("[mapboxgl-children]");a==null||a.remove(),ng.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_updateSize(n){const{viewState:a}=n;if(a){const h=this._map;if(a.width!==h.transform.width||a.height!==h.transform.height)return h.resize(),!0}return!1}_updateViewState(n){const a=this._map,h=a.transform;if(!a.isMoving()){const _=e1(h,n);if(Object.keys(_).length>0)return this._internalUpdate=!0,a.jumpTo(_),this._internalUpdate=!1,!0}return!1}_updateSettings(n,a){const h=this._map;let p=!1;for(const _ of _S)if(_ in n&&!uo(n[_],a[_])){p=!0;const v=h[`set${_[0].toUpperCase()}${_.slice(1)}`];v==null||v.call(h,n[_])}return p}_updateStyle(n,a){if(n.cursor!==a.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==a.mapStyle){const{mapStyle:h=n1,styleDiffing:p=!0}=n,_={diff:p};"localIdeographFontFamily"in n&&(_.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(t1(h),_)}}_updateStyleComponents({light:n,projection:a,sky:h,terrain:p}){var c,C;const _=this._map,v=this._styleComponents;_.style._loaded&&(n&&!uo(n,v.light)&&(v.light=n,_.setLight(n)),a&&!uo(a,v.projection)&&a!==((c=v.projection)==null?void 0:c.type)&&(v.projection=typeof a=="string"?{type:a}:a,(C=_.setProjection)==null||C.call(_,v.projection)),h&&!uo(h,v.sky)&&(v.sky=h,_.setSky(h)),p!==void 0&&!uo(p,v.terrain)&&(!p||_.getSource(p.source))&&(v.terrain=p,_.setTerrain(p)))}_updateHandlers(n,a){const h=this._map;for(const p of vS){const _=n[p]??!0,v=a[p]??!0;uo(_,v)||(_?h[p].enable(_):h[p].disable())}}_queryRenderedFeatures(n){const a=this._map,{interactiveLayerIds:h=[]}=this.props;try{return a.queryRenderedFeatures(n,{layers:h.filter(a.getLayer.bind(a))})}catch{return[]}}_updateHover(n){var p;const{props:a}=this;if(a.interactiveLayerIds&&(a.onMouseMove||a.onMouseEnter||a.onMouseLeave)){const _=n.type,v=((p=this._hoveredFeatures)==null?void 0:p.length)>0,c=this._queryRenderedFeatures(n.point),C=c.length>0;!C&&v&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=c,C&&!v&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=_}else this._hoveredFeatures=null}}ng.savedMaps=[];const xS=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function bS(i){if(!i)return null;const n=i.map,a={getMap:()=>n};for(const h of wS(n))!(h in a)&&!xS.includes(h)&&(a[h]=n[h].bind(n));return a}function wS(i){const n=new Set;let a=i;for(;a;){for(const h of Object.getOwnPropertyNames(a))h[0]!=="_"&&typeof i[h]=="function"&&h!=="fire"&&h!=="setEventedParent"&&n.add(h);a=Object.getPrototypeOf(a)}return Array.from(n)}const TS=typeof document<"u"?ce.useLayoutEffect:ce.useEffect;function ES(i,n){const{RTLTextPlugin:a,maxParallelImageRequests:h,workerCount:p,workerUrl:_}=n;if(a&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:v,lazy:c=!0}=typeof a=="string"?{pluginUrl:a}:a;i.setRTLTextPlugin(v,C=>{C&&console.error(C)},c)}h!==void 0&&i.setMaxParallelImageRequests(h),p!==void 0&&i.setWorkerCount(p),_!==void 0&&i.setWorkerUrl(_)}const mg=ce.createContext(null);function SS(i,n){const a=ce.useContext(mS),[h,p]=ce.useState(null),_=ce.useRef(),{current:v}=ce.useRef({mapLib:null,map:null});ce.useEffect(()=>{const k=i.mapLib;let P=!0,j;return Promise.resolve(k||qw(()=>Promise.resolve().then(()=>Jw),void 0)).then(U=>{if(!P)return;if(!U)throw new Error("Invalid mapLib");const V="Map"in U?U:U.default;if(!V.Map)throw new Error("Invalid mapLib");ES(V,i),i.reuseMaps&&(j=ng.reuse(i,_.current)),j||(j=new ng(V.Map,i,_.current)),v.map=bS(j),v.mapLib=V,p(j),a==null||a.onMapMount(v.map,i.id)}).catch(U=>{const{onError:V}=i;V?V({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{P=!1,j&&(a==null||a.onMapUnmount(i.id),i.reuseMaps?j.recycle():j.destroy())}},[]),TS(()=>{h&&h.setProps(i)}),ce.useImperativeHandle(n,()=>v.map,[h]);const c=ce.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),C={height:"100%"};return ce.createElement("div",{id:i.id,ref:_,style:c},h&&ce.createElement(mg.Provider,{value:v},ce.createElement("div",{"mapboxgl-children":"",style:C},i.children)))}const AS=ce.forwardRef(SS);var Kx=Yw();const _p=Lp(Kx),MS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Wh(i,n){if(!i||!n)return;const a=i.style;for(const h in n){const p=n[h];Number.isFinite(p)&&!MS.test(h)?a[h]=`${p}px`:a[h]=p}}function Hw(i,n){if(i===n)return null;const a=s1(i),h=s1(n),p=[];for(const _ of h)a.has(_)||p.push(_);for(const _ of a)h.has(_)||p.push(_);return p.length===0?null:p}function s1(i){return new Set(i?i.trim().split(/\s+/):[])}const o1=ce.memo(ce.forwardRef((i,n)=>{const{map:a,mapLib:h}=ce.useContext(mg),p=ce.useRef({props:i}),_=ce.useMemo(()=>{let Le=!1;ce.Children.forEach(i.children,$e=>{$e&&(Le=!0)});const Qe={...i,element:Le?document.createElement("div"):void 0},He=new h.Marker(Qe);return He.setLngLat([i.longitude,i.latitude]),He.getElement().addEventListener("click",$e=>{var ke,Ze;(Ze=(ke=p.current.props).onClick)==null||Ze.call(ke,{type:"click",target:He,originalEvent:$e})}),He.on("dragstart",$e=>{var Ze,nt;const ke=$e;ke.lngLat=_.getLngLat(),(nt=(Ze=p.current.props).onDragStart)==null||nt.call(Ze,ke)}),He.on("drag",$e=>{var Ze,nt;const ke=$e;ke.lngLat=_.getLngLat(),(nt=(Ze=p.current.props).onDrag)==null||nt.call(Ze,ke)}),He.on("dragend",$e=>{var Ze,nt;const ke=$e;ke.lngLat=_.getLngLat(),(nt=(Ze=p.current.props).onDragEnd)==null||nt.call(Ze,ke)}),He},[]);ce.useEffect(()=>(_.addTo(a.getMap()),()=>{_.remove()}),[]);const{longitude:v,latitude:c,offset:C,style:k,draggable:P=!1,popup:j=null,rotation:U=0,rotationAlignment:V="auto",pitchAlignment:ie="auto"}=i;ce.useEffect(()=>{Wh(_.getElement(),k)},[k]),ce.useImperativeHandle(n,()=>_,[]);const me=p.current.props;(_.getLngLat().lng!==v||_.getLngLat().lat!==c)&&_.setLngLat([v,c]),C&&!gS(_.getOffset(),C)&&_.setOffset(C),_.isDraggable()!==P&&_.setDraggable(P),_.getRotation()!==U&&_.setRotation(U),_.getRotationAlignment()!==V&&_.setRotationAlignment(V),_.getPitchAlignment()!==ie&&_.setPitchAlignment(ie),_.getPopup()!==j&&_.setPopup(j);const pe=Hw(me.className,i.className);if(pe)for(const Le of pe)_.toggleClassName(Le);return p.current.props=i,Kx.createPortal(i.children,_.getElement())})),Xw=ce.memo(ce.forwardRef((i,n)=>{const{map:a,mapLib:h}=ce.useContext(mg),p=ce.useMemo(()=>document.createElement("div"),[]),_=ce.useRef({props:i}),v=ce.useMemo(()=>{const c={...i},C=new h.Popup(c);return C.setLngLat([i.longitude,i.latitude]),C.once("open",k=>{var P,j;(j=(P=_.current.props).onOpen)==null||j.call(P,k)}),C},[]);if(ce.useEffect(()=>{const c=C=>{var k,P;(P=(k=_.current.props).onClose)==null||P.call(k,C)};return v.on("close",c),v.setDOMContent(p).addTo(a.getMap()),()=>{v.off("close",c),v.isOpen()&&v.remove()}},[]),ce.useEffect(()=>{Wh(v.getElement(),i.style)},[i.style]),ce.useImperativeHandle(n,()=>v,[]),v.isOpen()){const c=_.current.props;(v.getLngLat().lng!==i.longitude||v.getLngLat().lat!==i.latitude)&&v.setLngLat([i.longitude,i.latitude]),i.offset&&!uo(c.offset,i.offset)&&v.setOffset(i.offset),(c.anchor!==i.anchor||c.maxWidth!==i.maxWidth)&&(v.options.anchor=i.anchor,v.setMaxWidth(i.maxWidth));const C=Hw(c.className,i.className);if(C)for(const k of C)v.toggleClassName(k);_.current.props=i}return Kx.createPortal(i.children,p)}));function Np(i,n,a,h){const p=ce.useContext(mg),_=ce.useMemo(()=>i(p),[]);return ce.useEffect(()=>{const v=n,c=null,C=typeof n=="function"?n:null,{map:k}=p;return k.hasControl(_)||(k.addControl(_,v==null?void 0:v.position),c&&c(p)),()=>{C&&C(p),k.hasControl(_)&&k.removeControl(_)}},[]),_}function CS(i){const n=Np(({mapLib:a})=>new a.AttributionControl(i),{position:i.position});return ce.useEffect(()=>{Wh(n._container,i.style)},[i.style]),null}ce.memo(CS);function DS(i){const n=Np(({mapLib:a})=>new a.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return ce.useEffect(()=>{Wh(n._controlContainer,i.style)},[i.style]),null}ce.memo(DS);function kS(i,n){const a=ce.useRef({props:i}),h=Np(({mapLib:p})=>{const _=new p.GeolocateControl(i),v=_._setupUI;return _._setupUI=()=>{_._container.hasChildNodes()||v()},_.on("geolocate",c=>{var C,k;(k=(C=a.current.props).onGeolocate)==null||k.call(C,c)}),_.on("error",c=>{var C,k;(k=(C=a.current.props).onError)==null||k.call(C,c)}),_.on("outofmaxbounds",c=>{var C,k;(k=(C=a.current.props).onOutOfMaxBounds)==null||k.call(C,c)}),_.on("trackuserlocationstart",c=>{var C,k;(k=(C=a.current.props).onTrackUserLocationStart)==null||k.call(C,c)}),_.on("trackuserlocationend",c=>{var C,k;(k=(C=a.current.props).onTrackUserLocationEnd)==null||k.call(C,c)}),_},{position:i.position});return a.current.props=i,ce.useImperativeHandle(n,()=>h,[]),ce.useEffect(()=>{Wh(h._container,i.style)},[i.style]),null}ce.memo(ce.forwardRef(kS));function IS(i){const n=Np(({mapLib:a})=>new a.NavigationControl(i),{position:i.position});return ce.useEffect(()=>{Wh(n._container,i.style)},[i.style]),null}const RS=ce.memo(IS);function zS(i){const n=Np(({mapLib:_})=>new _.ScaleControl(i),{position:i.position}),a=ce.useRef(i),h=a.current;a.current=i;const{style:p}=i;return i.maxWidth!==void 0&&i.maxWidth!==h.maxWidth&&(n.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==h.unit&&n.setUnit(i.unit),ce.useEffect(()=>{Wh(n._container,p)},[p]),null}ce.memo(zS);function LS(i){const n=Np(({mapLib:a})=>new a.TerrainControl(i),{position:i.position});return ce.useEffect(()=>{Wh(n._container,i.style)},[i.style]),null}ce.memo(LS);function NS(i){const n=Np(({mapLib:a})=>new a.LogoControl(i),{position:i.position});return ce.useEffect(()=>{Wh(n._container,i.style)},[i.style]),null}ce.memo(NS);function O0(i,n){if(!i)throw new Error(n)}let PS=0;function OS(i,n,a){if(i.style&&i.style._loaded){const h={...a};return delete h.id,delete h.children,i.addSource(n,h),i.getSource(n)}return null}function jS(i,n,a){var v,c,C;O0(n.id===a.id,"source id changed"),O0(n.type===a.type,"source type changed");let h="",p=0;for(const k in n)k!=="children"&&k!=="id"&&!uo(a[k],n[k])&&(h=k,p++);if(!p)return;const _=n.type;if(_==="geojson")i.setData(n.data);else if(_==="image")i.updateImage({url:n.url,coordinates:n.coordinates});else switch(h){case"coordinates":(v=i.setCoordinates)==null||v.call(i,n.coordinates);break;case"url":(c=i.setUrl)==null||c.call(i,n.url);break;case"tiles":(C=i.setTiles)==null||C.call(i,n.tiles);break;default:console.warn(`Unable to update <Source> prop: ${h}`)}}function BS(i){const n=ce.useContext(mg).map.getMap(),a=ce.useRef(i),[,h]=ce.useState(0),p=ce.useMemo(()=>i.id||`jsx-source-${PS++}`,[]);ce.useEffect(()=>{if(n){const v=()=>setTimeout(()=>h(c=>c+1),0);return n.on("styledata",v),v(),()=>{var c;if(n.off("styledata",v),n.style&&n.style._loaded&&n.getSource(p)){const C=(c=n.getStyle())==null?void 0:c.layers;if(C)for(const k of C)k.source===p&&n.removeLayer(k.id);n.removeSource(p)}}}},[n]);let _=n&&n.style&&n.getSource(p);return _?jS(_,i,a.current):_=OS(n,p,i),a.current=i,_&&ce.Children.map(i.children,v=>v&&ce.cloneElement(v,{source:p}))||null}function FS(i,n,a,h){if(O0(a.id===h.id,"layer id changed"),O0(a.type===h.type,"layer type changed"),a.type==="custom"||h.type==="custom")return;const{layout:p={},paint:_={},filter:v,minzoom:c,maxzoom:C,beforeId:k}=a;if(k!==h.beforeId&&i.moveLayer(n,k),p!==h.layout){const P=h.layout||{};for(const j in p)uo(p[j],P[j])||i.setLayoutProperty(n,j,p[j]);for(const j in P)p.hasOwnProperty(j)||i.setLayoutProperty(n,j,void 0)}if(_!==h.paint){const P=h.paint||{};for(const j in _)uo(_[j],P[j])||i.setPaintProperty(n,j,_[j]);for(const j in P)_.hasOwnProperty(j)||i.setPaintProperty(n,j,void 0)}uo(v,h.filter)||i.setFilter(n,v),(c!==h.minzoom||C!==h.maxzoom)&&i.setLayerZoomRange(n,c,C)}function US(i,n,a){if(i.style&&i.style._loaded&&(!("source"in a)||i.getSource(a.source))){const h={...a,id:n};delete h.beforeId,i.addLayer(h,a.beforeId)}}let VS=0;function l1(i){const n=ce.useContext(mg).map.getMap(),a=ce.useRef(i),[,h]=ce.useState(0),p=ce.useMemo(()=>i.id||`jsx-layer-${VS++}`,[]);if(ce.useEffect(()=>{if(n){const v=()=>h(c=>c+1);return n.on("styledata",v),v(),()=>{n.off("styledata",v),n.style&&n.style._loaded&&n.getLayer(p)&&n.removeLayer(p)}}},[n]),n&&n.style&&n.getLayer(p))try{FS(n,p,i,a.current)}catch(v){console.warn(v)}else US(n,p,i);return a.current=i,null}var k0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.3.0/LICENSE.txt
 */var ZS=k0.exports,c1;function GS(){return c1||(c1=1,function(i,n){(function(a,h){i.exports=h()})(ZS,function(){var a={},h={};function p(v,c,C){if(h[v]=C,v==="index"){var k="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",P={};return h.shared(P),h.index(a,P),typeof window<"u"&&a.setWorkerUrl(window.URL.createObjectURL(new Blob([k],{type:"text/javascript"}))),a}}p("shared",["exports"],function(v){function c(o,t,l,d){return new(l||(l=Promise))(function(y,T){function E(L){try{I(d.next(L))}catch(O){T(O)}}function A(L){try{I(d.throw(L))}catch(O){T(O)}}function I(L){var O;L.done?y(L.value):(O=L.value,O instanceof l?O:new l(function(B){B(O)})).then(E,A)}I((d=d.apply(o,t||[])).next())})}function C(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var k,P;function j(){if(P)return k;function o(t,l){this.x=t,this.y=l}return P=1,k=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,l){return this.clone()._rotateAround(t,l)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var l=t.x-this.x,d=t.y-this.y;return l*l+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,l){return Math.atan2(this.x*l-this.y*t,this.x*t+this.y*l)},_matMult:function(t){var l=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=l,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var l=Math.cos(t),d=Math.sin(t),y=d*this.x+l*this.y;return this.x=l*this.x-d*this.y,this.y=y,this},_rotateAround:function(t,l){var d=Math.cos(t),y=Math.sin(t),T=l.y+y*(this.x-l.x)+d*(this.y-l.y);return this.x=l.x+d*(this.x-l.x)-y*(this.y-l.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t},k}typeof SuppressedError=="function"&&SuppressedError;var U,V,ie=C(j()),me=function(){if(V)return U;function o(t,l,d,y){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(y-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=l,this.p2x=d,this.p2y=y}return V=1,U=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,l){if(l===void 0&&(l=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,y=0;y<8;y++){var T=this.sampleCurveX(d)-t;if(Math.abs(T)<l)return d;var E=this.sampleCurveDerivativeX(d);if(Math.abs(E)<1e-6)break;d-=T/E}var A=0,I=1;for(d=t,y=0;y<20&&(T=this.sampleCurveX(d),!(Math.abs(T-t)<l));y++)t>T?A=d:I=d,d=.5*(I-A)+A;return d},solve:function(t,l){return this.sampleCurveY(this.solveCurveX(t,l))}},U}(),pe=C(me);let Le,Qe;function He(){return Le==null&&(Le=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Le}function $e(){if(Qe==null&&(Qe=!1,He())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let d=0;d<5*5;d++){const y=4*d;t.fillStyle=`rgb(${y},${y+1},${y+2})`,t.fillRect(d%5,Math.floor(d/5),1,1)}const l=t.getImageData(0,0,5,5).data;for(let d=0;d<5*5*4;d++)if(d%4!=3&&l[d]!==d){Qe=!0;break}}}return Qe||!1}var ke,Ze=1e-6,nt=typeof Float32Array<"u"?Float32Array:Array;function Ke(){var o=new nt(9);return nt!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Re(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function _t(){var o=new nt(3);return nt!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function It(o,t,l){var d=new nt(3);return d[0]=o,d[1]=t,d[2]=l,d}function Ot(o,t,l){var d=t[0],y=t[1],T=t[2],E=t[3];return o[0]=l[0]*d+l[4]*y+l[8]*T+l[12]*E,o[1]=l[1]*d+l[5]*y+l[9]*T+l[13]*E,o[2]=l[2]*d+l[6]*y+l[10]*T+l[14]*E,o[3]=l[3]*d+l[7]*y+l[11]*T+l[15]*E,o}function Vt(){var o=new nt(4);return nt!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function Wt(){var o=new nt(2);return nt!=Float32Array&&(o[0]=0,o[1]=0),o}function dn(o,t){var l=new nt(2);return l[0]=o,l[1]=t,l}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)}),_t(),ke=new nt(4),nt!=Float32Array&&(ke[0]=0,ke[1]=0,ke[2]=0,ke[3]=0),_t(),It(1,0,0),It(0,1,0),Vt(),Vt(),Ke(),Wt();const Oe=8192;function vt(o,t,l){return t*(Oe/(o.tileSize*Math.pow(2,l-o.tileID.overscaledZ)))}function mt(o,t){return(o%t+t)%t}function Qt(o,t,l){return o*(1-l)+t*l}function Se(o){if(o<=0)return 0;if(o>=1)return 1;const t=o*o,l=t*o;return 4*(o<.5?l:3*(o-t)+l-.75)}function gt(o,t,l,d){const y=new pe(o,t,l,d);return T=>y.solve(T)}const kt=gt(.25,.1,.25,1);function St(o,t,l){return Math.min(l,Math.max(t,o))}function zt(o,t,l){const d=l-t,y=((o-t)%d+d)%d+t;return y===t?l:y}function Yt(o,...t){for(const l of t)for(const d in l)o[d]=l[d];return o}let tn=1;function gi(o,t,l){const d={};for(const y in o)d[y]=t.call(this,o[y],y,o);return d}function Tn(o,t,l){const d={};for(const y in o)t.call(this,o[y],y,o)&&(d[y]=o[y]);return d}function ni(o){return Array.isArray(o)?o.map(ni):typeof o=="object"&&o?gi(o,ni):o}const ba={};function Mi(o){ba[o]||(typeof console<"u"&&console.warn(o),ba[o]=!0)}function yi(o,t,l){return(l.y-o.y)*(t.x-o.x)>(t.y-o.y)*(l.x-o.x)}function Er(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let Zn=null;function Gn(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const wa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function li(o,t,l,d,y){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(o,{timestamp:0});try{const E=T==null?void 0:T.format;if(!E||!E.startsWith("BGR")&&!E.startsWith("RGB"))throw new Error(`Unrecognized format ${E}`);const A=E.startsWith("BGR"),I=new Uint8ClampedArray(d*y*4);if(yield T.copyTo(I,function(L,O,B,$,q){const W=4*Math.max(1,0),J=(Math.max(0,B)-B)*$*4+W,le=4*$,fe=Math.max(0,O),Ee=Math.max(0,B);return{rect:{x:fe,y:Ee,width:Math.min(L.width,O+$)-fe,height:Math.min(L.height,B+q)-Ee},layout:[{offset:J,stride:le}]}}(o,t,l,d,y)),A)for(let L=0;L<I.length;L+=4){const O=I[L];I[L]=I[L+2],I[L+2]=O}return I}finally{T.close()}})}let js,is;function rr(o,t,l,d){return o.addEventListener(t,l,d),{unsubscribe:()=>{o.removeEventListener(t,l,d)}}}function fr(o){return o/Math.PI*180}const xo={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Bs={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},bo="AbortError";function Fs(){return new Error(bo)}const Xr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ki(o){return Xr.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const pr="global-dispatcher";class Gi extends Error{constructor(t,l,d,y){super(`AJAXError: ${l} (${t}): ${d}`),this.status=t,this.statusText=l,this.url=d,this.body=y}}const wo=()=>Er(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Fc=function(o,t){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const d=Ki(o.url);if(d)return d(o,t);if(Er(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:pr},t)}if(!(/^file:/.test(l=o.url)||/^file:/.test(wo())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,y){return c(this,void 0,void 0,function*(){const T=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:wo(),signal:y.signal});let E,A;d.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{E=yield fetch(T)}catch(L){throw new Gi(0,L.message,d.url,new Blob)}if(!E.ok){const L=yield E.blob();throw new Gi(E.status,E.statusText,d.url,L)}A=d.type==="arrayBuffer"||d.type==="image"?E.arrayBuffer():d.type==="json"?E.json():E.text();const I=yield A;if(y.signal.aborted)throw Fs();return{data:I,cacheControl:E.headers.get("Cache-Control"),expires:E.headers.get("Expires")}})}(o,t);if(Er(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:pr},t)}var l;return function(d,y){return new Promise((T,E)=>{var A;const I=new XMLHttpRequest;I.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(I.responseType="arraybuffer");for(const L in d.headers)I.setRequestHeader(L,d.headers[L]);d.type==="json"&&(I.responseType="text",!((A=d.headers)===null||A===void 0)&&A.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=d.credentials==="include",I.onerror=()=>{E(new Error(I.statusText))},I.onload=()=>{if(!y.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let L=I.response;if(d.type==="json")try{L=JSON.parse(I.response)}catch(O){return void E(O)}T({data:L,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const L=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});E(new Gi(I.status,I.statusText,d.url,L))}},y.signal.addEventListener("abort",()=>{I.abort(),E(Fs())}),I.send(d.body)})}(o,t)};function zu(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const t=new URL(o),l=window.location;return t.protocol===l.protocol&&t.host===l.host}function Vl(o,t,l){l[o]&&l[o].indexOf(t)!==-1||(l[o]=l[o]||[],l[o].push(t))}function ja(o,t,l){if(l&&l[o]){const d=l[o].indexOf(t);d!==-1&&l[o].splice(d,1)}}class Ne{constructor(t,l={}){Yt(this,l),this.type=t}}class ee extends Ne{constructor(t,l={}){super("error",Yt({error:t},l))}}class re{on(t,l){return this._listeners=this._listeners||{},Vl(t,l,this._listeners),{unsubscribe:()=>{this.off(t,l)}}}off(t,l){return ja(t,l,this._listeners),ja(t,l,this._oneTimeListeners),this}once(t,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Vl(t,l,this._oneTimeListeners),this):new Promise(d=>this.once(t,d))}fire(t,l){typeof t=="string"&&(t=new Ne(t,l||{}));const d=t.type;if(this.listens(d)){t.target=this;const y=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const A of y)A.call(this,t);const T=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const A of T)ja(d,A,this._oneTimeListeners),A.call(this,t);const E=this._eventedParent;E&&(Yt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(t))}else t instanceof ee&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,l){return this._eventedParent=t,this._eventedParentData=l,this}}var X={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const _e=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ce(o,t){const l={};for(const d in o)d!=="ref"&&(l[d]=o[d]);return _e.forEach(d=>{d in t&&(l[d]=t[d])}),l}function Ae(o,t){if(Array.isArray(o)){if(!Array.isArray(t)||o.length!==t.length)return!1;for(let l=0;l<o.length;l++)if(!Ae(o[l],t[l]))return!1;return!0}if(typeof o=="object"&&o!==null&&t!==null){if(typeof t!="object"||Object.keys(o).length!==Object.keys(t).length)return!1;for(const l in o)if(!Ae(o[l],t[l]))return!1;return!0}return o===t}function Be(o,t){o.push(t)}function ze(o,t,l){Be(l,{command:"addSource",args:[o,t[o]]})}function rt(o,t,l){Be(t,{command:"removeSource",args:[o]}),l[o]=!0}function Je(o,t,l,d){rt(o,l,d),ze(o,t,l)}function je(o,t,l){let d;for(d in o[l])if(Object.prototype.hasOwnProperty.call(o[l],d)&&d!=="data"&&!Ae(o[l][d],t[l][d]))return!1;for(d in t[l])if(Object.prototype.hasOwnProperty.call(t[l],d)&&d!=="data"&&!Ae(o[l][d],t[l][d]))return!1;return!0}function ht(o,t,l,d,y,T){o=o||{},t=t||{};for(const E in o)Object.prototype.hasOwnProperty.call(o,E)&&(Ae(o[E],t[E])||l.push({command:T,args:[d,E,t[E],y]}));for(const E in t)Object.prototype.hasOwnProperty.call(t,E)&&!Object.prototype.hasOwnProperty.call(o,E)&&(Ae(o[E],t[E])||l.push({command:T,args:[d,E,t[E],y]}))}function Ct(o){return o.id}function Rt(o,t){return o[t.id]=t,o}class Xe{constructor(t,l,d,y){this.message=(t?`${t}: `:"")+d,y&&(this.identifier=y),l!=null&&l.__line__&&(this.line=l.__line__)}}function $t(o,...t){for(const l of t)for(const d in l)o[d]=l[d];return o}class jt extends Error{constructor(t,l){super(l),this.message=l,this.key=t}}class nn{constructor(t,l=[]){this.parent=t,this.bindings={};for(const[d,y]of l)this.bindings[d]=y}concat(t){return new nn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Cn={kind:"null"},yt={kind:"number"},Bt={kind:"string"},Mt={kind:"boolean"},sn={kind:"color"},Ci={kind:"projectionDefinition"},sa={kind:"object"},qt={kind:"value"},Bi={kind:"collator"},$n={kind:"formatted"},Ji={kind:"padding"},Zl={kind:"resolvedImage"},To={kind:"variableAnchorOffsetCollection"};function ar(o,t){return{kind:"array",itemType:o,N:t}}function Jn(o){if(o.kind==="array"){const t=Jn(o.itemType);return typeof o.N=="number"?`array<${t}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${t}>`}return o.kind}const Ag=[Cn,yt,Bt,Mt,sn,Ci,$n,sa,ar(qt),Ji,Zl,To];function Gl(o,t){if(t.kind==="error")return null;if(o.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Gl(o.itemType,t.itemType))&&(typeof o.N!="number"||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if(o.kind==="value"){for(const l of Ag)if(!Gl(l,t))return null}}return`Expected ${Jn(o)} but found ${Jn(t)} instead.`}function ed(o,t){return t.some(l=>l.kind===o.kind)}function el(o,t){return t.some(l=>l==="null"?o===null:l==="array"?Array.isArray(o):l==="object"?o&&!Array.isArray(o)&&typeof o=="object":l===typeof o)}function Eo(o,t){return o.kind==="array"&&t.kind==="array"?o.itemType.kind===t.itemType.kind&&typeof o.N=="number":o.kind===t.kind}const Lu=.96422,Us=.82521,td=4/29,$l=6/29,Yl=3*$l*$l,_f=$l*$l*$l,nd=Math.PI/180,Nu=180/Math.PI;function vf(o){return(o%=360)<0&&(o+=360),o}function Ta([o,t,l,d]){let y,T;const E=xf((.2225045*(o=tl(o))+.7168786*(t=tl(t))+.0606169*(l=tl(l)))/1);o===t&&t===l?y=T=E:(y=xf((.4360747*o+.3850649*t+.1430804*l)/Lu),T=xf((.0139322*o+.0971045*t+.7141733*l)/Us));const A=116*E-16;return[A<0?0:A,500*(y-E),200*(E-T),d]}function tl(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function xf(o){return o>_f?Math.pow(o,1/3):o/Yl+td}function Pu([o,t,l,d]){let y=(o+16)/116,T=isNaN(t)?y:y+t/500,E=isNaN(l)?y:y-l/200;return y=1*ql(y),T=Lu*ql(T),E=Us*ql(E),[id(3.1338561*T-1.6168667*y-.4906146*E),id(-.9787684*T+1.9161415*y+.033454*E),id(.0719453*T-.2289914*y+1.4052427*E),d]}function id(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function ql(o){return o>$l?o*o*o:Yl*(o-td)}function Ou(o){return parseInt(o.padEnd(2,o),16)/255}function $i(o,t){return yn(t?o/100:o,0,1)}function yn(o,t,l){return Math.min(Math.max(t,o),l)}function nl(o){return!o.some(Number.isNaN)}const Vs={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function oa(o,t,l){return o+l*(t-o)}function Hl(o,t,l){return o.map((d,y)=>oa(d,t[y],l))}class kn{constructor(t,l,d,y=1,T=!0){this.r=t,this.g=l,this.b=d,this.a=y,T||(this.r*=y,this.g*=y,this.b*=y,y||this.overwriteGetter("rgb",[t,l,d,y]))}static parse(t){if(t instanceof kn)return t;if(typeof t!="string")return;const l=function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];const y=Vs[d];if(y){const[E,A,I]=y;return[E/255,A/255,I/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const E=d.length<6?1:2;let A=1;return[Ou(d.slice(A,A+=E)),Ou(d.slice(A,A+=E)),Ou(d.slice(A,A+=E)),Ou(d.slice(A,A+E)||"ff")]}if(d.startsWith("rgb")){const E=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[A,I,L,O,B,$,q,W,J,le,fe,Ee]=E,ye=[O||" ",q||" ",le].join("");if(ye==="  "||ye==="  /"||ye===",,"||ye===",,,"){const Y=[L,$,J].join(""),oe=Y==="%%%"?100:Y===""?255:0;if(oe){const ve=[yn(+I/oe,0,1),yn(+B/oe,0,1),yn(+W/oe,0,1),fe?$i(+fe,Ee):1];if(nl(ve))return ve}}return}}const T=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[E,A,I,L,O,B,$,q,W]=T,J=[I||" ",O||" ",$].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const le=[+A,yn(+L,0,100),yn(+B,0,100),q?$i(+q,W):1];if(nl(le))return function([fe,Ee,ye,Y]){function oe(ve){const Ve=(ve+fe/30)%12,pt=Ee*Math.min(ye,1-ye);return ye-pt*Math.max(-1,Math.min(Ve-3,9-Ve,1))}return fe=vf(fe),Ee/=100,ye/=100,[oe(0),oe(8),oe(4),Y]}(le)}}}(t);return l?new kn(...l,!1):void 0}get rgb(){const{r:t,g:l,b:d,a:y}=this,T=y||1/0;return this.overwriteGetter("rgb",[t/T,l/T,d/T,y])}get hcl(){return this.overwriteGetter("hcl",function(t){const[l,d,y,T]=Ta(t),E=Math.sqrt(d*d+y*y);return[Math.round(1e4*E)?vf(Math.atan2(y,d)*Nu):NaN,E,l,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ta(this.rgb))}overwriteGetter(t,l){return Object.defineProperty(this,t,{value:l}),l}toString(){const[t,l,d,y]=this.rgb;return`rgba(${[t,l,d].map(T=>Math.round(255*T)).join(",")},${y})`}static interpolate(t,l,d,y="rgb"){switch(y){case"rgb":{const[T,E,A,I]=Hl(t.rgb,l.rgb,d);return new kn(T,E,A,I,!1)}case"hcl":{const[T,E,A,I]=t.hcl,[L,O,B,$]=l.hcl;let q,W;if(isNaN(T)||isNaN(L))isNaN(T)?isNaN(L)?q=NaN:(q=L,A!==1&&A!==0||(W=O)):(q=T,B!==1&&B!==0||(W=E));else{let ye=L-T;L>T&&ye>180?ye-=360:L<T&&T-L>180&&(ye+=360),q=T+d*ye}const[J,le,fe,Ee]=function([ye,Y,oe,ve]){return ye=isNaN(ye)?0:ye*nd,Pu([oe,Math.cos(ye)*Y,Math.sin(ye)*Y,ve])}([q,W??oa(E,O,d),oa(A,B,d),oa(I,$,d)]);return new kn(J,le,fe,Ee,!1)}case"lab":{const[T,E,A,I]=Pu(Hl(t.lab,l.lab,d));return new kn(T,E,A,I,!1)}}}}kn.black=new kn(0,0,0,1),kn.white=new kn(1,1,1,1),kn.transparent=new kn(0,0,0,0),kn.red=new kn(1,0,0,1);class kr{constructor(t,l,d){this.sensitivity=t?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,l){return this.collator.compare(t,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ju=["bottom","center","top"];class Xl{constructor(t,l,d,y,T,E){this.text=t,this.image=l,this.scale=d,this.fontStack=y,this.textColor=T,this.verticalAlign=E}}class Ur{constructor(t){this.sections=t}static fromString(t){return new Ur([new Xl(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Ur?t:Ur.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class mr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof mr)return t;if(typeof t=="number")return new mr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const l of t)if(typeof l!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new mr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,l,d){return new mr(Hl(t.values,l.values,d))}}class Di{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const rd=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Sr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Sr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let l=0;l<t.length;l+=2){const d=t[l],y=t[l+1];if(typeof d!="string"||!rd.has(d)||!Array.isArray(y)||y.length!==2||typeof y[0]!="number"||typeof y[1]!="number")return}return new Sr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,l,d){const y=t.values,T=l.values;if(y.length!==T.length)throw new Di(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${l.toString()}`);const E=[];for(let A=0;A<y.length;A+=2){if(y[A]!==T[A])throw new Di(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${y[A]}, to[${A}]: ${T[A]}`);E.push(y[A]);const[I,L]=y[A+1],[O,B]=T[A+1];E.push([oa(I,O,d),oa(L,B,d)])}return new Sr(E)}}class Vr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Vr({name:t,available:!1}):null}}class er{constructor(t,l,d){this.from=t,this.to=l,this.transition=d}static interpolate(t,l,d){return new er(t,l,d)}static parse(t){return t instanceof er?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new er(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new er(t.from,t.to,t.transition):typeof t=="string"?new er(t,t,1):void 0}}function Wl(o,t,l,d){return typeof o=="number"&&o>=0&&o<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof l=="number"&&l>=0&&l<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[o,t,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[o,t,l,d]:[o,t,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ea(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof er||o instanceof kn||o instanceof kr||o instanceof Ur||o instanceof mr||o instanceof Sr||o instanceof Vr)return!0;if(Array.isArray(o)){for(const t of o)if(!Ea(t))return!1;return!0}if(typeof o=="object"){for(const t in o)if(!Ea(o[t]))return!1;return!0}return!1}function _i(o){if(o===null)return Cn;if(typeof o=="string")return Bt;if(typeof o=="boolean")return Mt;if(typeof o=="number")return yt;if(o instanceof kn)return sn;if(o instanceof er)return Ci;if(o instanceof kr)return Bi;if(o instanceof Ur)return $n;if(o instanceof mr)return Ji;if(o instanceof Sr)return To;if(o instanceof Vr)return Zl;if(Array.isArray(o)){const t=o.length;let l;for(const d of o){const y=_i(d);if(l){if(l===y)continue;l=qt;break}l=y}return ar(l||qt,t)}return sa}function il(o){const t=typeof o;return o===null?"":t==="string"||t==="number"||t==="boolean"?String(o):o instanceof kn||o instanceof er||o instanceof Ur||o instanceof mr||o instanceof Sr||o instanceof Vr?o.toString():JSON.stringify(o)}class So{constructor(t,l){this.type=t,this.value=l}static parse(t,l){if(t.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ea(t[1]))return l.error("invalid value");const d=t[1];let y=_i(d);const T=l.expectedType;return y.kind!=="array"||y.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(y=T),new So(y,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ao={string:Bt,number:yt,boolean:Mt,object:sa};class Yi{constructor(t,l){this.type=t,this.args=l}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");let d,y=1;const T=t[0];if(T==="array"){let A,I;if(t.length>2){const L=t[1];if(typeof L!="string"||!(L in Ao)||L==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);A=Ao[L],y++}else A=qt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return l.error('The length argument to "array" must be a positive integer literal',2);I=t[2],y++}d=ar(A,I)}else{if(!Ao[T])throw new Error(`Types doesn't contain name = ${T}`);d=Ao[T]}const E=[];for(;y<t.length;y++){const A=l.parse(t[y],y,qt);if(!A)return null;E.push(A)}return new Yi(d,E)}evaluate(t){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(t);if(!Gl(this.type,_i(d)))return d;if(l===this.args.length-1)throw new Di(`Expected value to be of type ${Jn(this.type)}, but found ${Jn(_i(d))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const ii={"to-boolean":Mt,"to-color":sn,"to-number":yt,"to-string":Bt};class la{constructor(t,l){this.type=t,this.args=l}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");const d=t[0];if(!ii[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&t.length!==2)return l.error("Expected one argument.");const y=ii[d],T=[];for(let E=1;E<t.length;E++){const A=l.parse(t[E],E,qt);if(!A)return null;T.push(A)}return new la(y,T)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let l,d;for(const y of this.args){if(l=y.evaluate(t),d=null,l instanceof kn)return l;if(typeof l=="string"){const T=t.parseColor(l);if(T)return T}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rgba value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Wl(l[0],l[1],l[2],l[3]),!d))return new kn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Di(d||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const d of this.args){l=d.evaluate(t);const y=mr.parse(l);if(y)return y}throw new Di(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const d of this.args){l=d.evaluate(t);const y=Sr.parse(l);if(y)return y}throw new Di(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const d of this.args){if(l=d.evaluate(t),l===null)return 0;const y=Number(l);if(!isNaN(y))return y}throw new Di(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Ur.fromString(il(this.args[0].evaluate(t)));case"resolvedImage":return Vr.fromString(il(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return il(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const xn=["Unknown","Point","LineString","Polygon"];class fn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let l=this._parseColorCache[t];return l||(l=this._parseColorCache[t]=kn.parse(t)),l}}class Mo{constructor(t,l,d=[],y,T=new nn,E=[]){this.registry=t,this.path=d,this.key=d.map(A=>`[${A}]`).join(""),this.scope=T,this.errors=E,this.expectedType=y,this._isConstant=l}parse(t,l,d,y,T={}){return l?this.concat(l,d,y)._parse(t,T):this._parse(t,T)}_parse(t,l){function d(y,T,E){return E==="assert"?new Yi(T,[y]):E==="coerce"?new la(T,[y]):y}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=t[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[y];if(T){let E=T.parse(t,this);if(!E)return null;if(this.expectedType){const A=this.expectedType,I=E.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||I.kind!=="value")if(A.kind!=="projectionDefinition"||I.kind!=="string"&&I.kind!=="array")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(A.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(A.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(A,I))return null}else E=d(E,A,l.typeAnnotation||"coerce");else E=d(E,A,l.typeAnnotation||"coerce");else E=d(E,A,l.typeAnnotation||"coerce");else E=d(E,A,l.typeAnnotation||"coerce");else E=d(E,A,l.typeAnnotation||"assert")}if(!(E instanceof So)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const A=new fn;try{E=new So(E.type,E.evaluate(A))}catch(I){return this.error(I.message),null}}return E}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,l,d){const y=typeof t=="number"?this.path.concat(t):this.path,T=d?this.scope.concat(d):this.scope;return new Mo(this.registry,this._isConstant,y,l||null,T,this.errors)}error(t,...l){const d=`${this.key}${l.map(y=>`[${y}]`).join("")}`;this.errors.push(new jt(d,t))}checkSubtype(t,l){const d=Gl(t,l);return d&&this.error(d),d}}class Dn{constructor(t,l){this.type=l.type,this.bindings=[].concat(t),this.result=l}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const l of this.bindings)t(l[1]);t(this.result)}static parse(t,l){if(t.length<4)return l.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const d=[];for(let T=1;T<t.length-1;T+=2){const E=t[T];if(typeof E!="string")return l.error(`Expected string, but found ${typeof E} instead.`,T);if(/[^a-zA-Z0-9_]/.test(E))return l.error("Variable names must contain only alphanumeric characters or '_'.",T);const A=l.parse(t[T+1],T+1);if(!A)return null;d.push([E,A])}const y=l.parse(t[t.length-1],t.length-1,l.expectedType,d);return y?new Dn(d,y):null}outputDefined(){return this.result.outputDefined()}}class Co{constructor(t,l){this.type=l.type,this.name=t,this.boundExpression=l}static parse(t,l){if(t.length!==2||typeof t[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const d=t[1];return l.scope.has(d)?new Co(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ca{constructor(t,l,d){this.type=t,this.index=l,this.input=d}static parse(t,l){if(t.length!==3)return l.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const d=l.parse(t[1],1,yt),y=l.parse(t[2],2,ar(l.expectedType||qt));return d&&y?new ca(y.type.itemType,d,y):null}evaluate(t){const l=this.index.evaluate(t),d=this.input.evaluate(t);if(l<0)throw new Di(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new Di(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new Di(`Array index must be an integer, but found ${l} instead.`);return d[l]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Uc{constructor(t,l){this.type=Mt,this.needle=t,this.haystack=l}static parse(t,l){if(t.length!==3)return l.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const d=l.parse(t[1],1,qt),y=l.parse(t[2],2,qt);return d&&y?ed(d.type,[Mt,Bt,yt,Cn,qt])?new Uc(d,y):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Jn(d.type)} instead`):null}evaluate(t){const l=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!d)return!1;if(!el(l,["boolean","string","number","null"]))throw new Di(`Expected first argument to be of type boolean, string, number or null, but found ${Jn(_i(l))} instead.`);if(!el(d,["string","array"]))throw new Di(`Expected second argument to be of type array or string, but found ${Jn(_i(d))} instead.`);return d.indexOf(l)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ar{constructor(t,l,d){this.type=yt,this.needle=t,this.haystack=l,this.fromIndex=d}static parse(t,l){if(t.length<=2||t.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const d=l.parse(t[1],1,qt),y=l.parse(t[2],2,qt);if(!d||!y)return null;if(!ed(d.type,[Mt,Bt,yt,Cn,qt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Jn(d.type)} instead`);if(t.length===4){const T=l.parse(t[3],3,yt);return T?new Ar(d,y,T):null}return new Ar(d,y)}evaluate(t){const l=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!el(l,["boolean","string","number","null"]))throw new Di(`Expected first argument to be of type boolean, string, number or null, but found ${Jn(_i(l))} instead.`);let y;if(this.fromIndex&&(y=this.fromIndex.evaluate(t)),el(d,["string"])){const T=d.indexOf(l,y);return T===-1?-1:[...d.slice(0,T)].length}if(el(d,["array"]))return d.indexOf(l,y);throw new Di(`Expected second argument to be of type array or string, but found ${Jn(_i(d))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Zs{constructor(t,l,d,y,T,E){this.inputType=t,this.type=l,this.input=d,this.cases=y,this.outputs=T,this.otherwise=E}static parse(t,l){if(t.length<5)return l.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return l.error("Expected an even number of arguments.");let d,y;l.expectedType&&l.expectedType.kind!=="value"&&(y=l.expectedType);const T={},E=[];for(let L=2;L<t.length-1;L+=2){let O=t[L];const B=t[L+1];Array.isArray(O)||(O=[O]);const $=l.concat(L);if(O.length===0)return $.error("Expected at least one branch label.");for(const W of O){if(typeof W!="number"&&typeof W!="string")return $.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return $.error("Numeric branch labels must be integer values.");if(d){if($.checkSubtype(d,_i(W)))return null}else d=_i(W);if(T[String(W)]!==void 0)return $.error("Branch labels must be unique.");T[String(W)]=E.length}const q=l.parse(B,L,y);if(!q)return null;y=y||q.type,E.push(q)}const A=l.parse(t[1],1,qt);if(!A)return null;const I=l.parse(t[t.length-1],t.length-1,y);return I?A.type.kind!=="value"&&l.concat(1).checkSubtype(d,A.type)?null:new Zs(d,y,A,T,E,I):null}evaluate(t){const l=this.input.evaluate(t);return(_i(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(t,l,d){this.type=t,this.branches=l,this.otherwise=d}static parse(t,l){if(t.length<4)return l.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&l.expectedType.kind!=="value"&&(d=l.expectedType);const y=[];for(let E=1;E<t.length-1;E+=2){const A=l.parse(t[E],E,Mt);if(!A)return null;const I=l.parse(t[E+1],E+1,d);if(!I)return null;y.push([A,I]),d=d||I.type}const T=l.parse(t[t.length-1],t.length-1,d);if(!T)return null;if(!d)throw new Error("Can't infer output type");return new rl(d,y,T)}evaluate(t){for(const[l,d]of this.branches)if(l.evaluate(t))return d.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[l,d]of this.branches)t(l),t(d);t(this.otherwise)}outputDefined(){return this.branches.every(([t,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class Do{constructor(t,l,d,y){this.type=t,this.input=l,this.beginIndex=d,this.endIndex=y}static parse(t,l){if(t.length<=2||t.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const d=l.parse(t[1],1,qt),y=l.parse(t[2],2,yt);if(!d||!y)return null;if(!ed(d.type,[ar(qt),Bt,qt]))return l.error(`Expected first argument to be of type array or string, but found ${Jn(d.type)} instead`);if(t.length===4){const T=l.parse(t[3],3,yt);return T?new Do(d.type,d,y,T):null}return new Do(d.type,d,y)}evaluate(t){const l=this.input.evaluate(t),d=this.beginIndex.evaluate(t);let y;if(this.endIndex&&(y=this.endIndex.evaluate(t)),el(l,["string"]))return[...l].slice(d,y).join("");if(el(l,["array"]))return l.slice(d,y);throw new Di(`Expected first argument to be of type array or string, but found ${Jn(_i(l))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ad(o,t){const l=o.length-1;let d,y,T=0,E=l,A=0;for(;T<=E;)if(A=Math.floor((T+E)/2),d=o[A],y=o[A+1],d<=t){if(A===l||t<y)return A;T=A+1}else{if(!(d>t))throw new Di("Input is not a number.");E=A-1}return 0}class al{constructor(t,l,d){this.type=t,this.input=l,this.labels=[],this.outputs=[];for(const[y,T]of d)this.labels.push(y),this.outputs.push(T)}static parse(t,l){if(t.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(t[1],1,yt);if(!d)return null;const y=[];let T=null;l.expectedType&&l.expectedType.kind!=="value"&&(T=l.expectedType);for(let E=1;E<t.length;E+=2){const A=E===1?-1/0:t[E],I=t[E+1],L=E,O=E+1;if(typeof A!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(y.length&&y[y.length-1][0]>=A)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const B=l.parse(I,O,T);if(!B)return null;T=T||B.type,y.push([A,B])}return new al(T,d,y)}evaluate(t){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(t);const y=this.input.evaluate(t);if(y<=l[0])return d[0].evaluate(t);const T=l.length;return y>=l[T-1]?d[T-1].evaluate(t):d[ad(l,y)].evaluate(t)}eachChild(t){t(this.input);for(const l of this.outputs)t(l)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function sd(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var rs,sr,Bu=function(){if(sr)return rs;function o(t,l,d,y){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(y-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=l,this.p2x=d,this.p2y=y}return sr=1,rs=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,l){if(l===void 0&&(l=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,y=0;y<8;y++){var T=this.sampleCurveX(d)-t;if(Math.abs(T)<l)return d;var E=this.sampleCurveDerivativeX(d);if(Math.abs(E)<1e-6)break;d-=T/E}var A=0,I=1;for(d=t,y=0;y<20&&(T=this.sampleCurveX(d),!(Math.abs(T-t)<l));y++)t>T?A=d:I=d,d=.5*(I-A)+A;return d},solve:function(t,l){return this.sampleCurveY(this.solveCurveX(t,l))}},rs}(),Up=sd(Bu);class Zr{constructor(t,l,d,y,T){this.type=t,this.operator=l,this.interpolation=d,this.input=y,this.labels=[],this.outputs=[];for(const[E,A]of T)this.labels.push(E),this.outputs.push(A)}static interpolationFactor(t,l,d,y){let T=0;if(t.name==="exponential")T=or(l,t.base,d,y);else if(t.name==="linear")T=or(l,1,d,y);else if(t.name==="cubic-bezier"){const E=t.controlPoints;T=new Up(E[0],E[1],E[2],E[3]).solve(or(l,1,d,y))}return T}static parse(t,l){let[d,y,T,...E]=t;if(!Array.isArray(y)||y.length===0)return l.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const L=y[1];if(typeof L!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:L}}else{if(y[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const L=y.slice(1);if(L.length!==4||L.some(O=>typeof O!="number"||O<0||O>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:L}}}if(t.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(T=l.parse(T,2,yt),!T)return null;const A=[];let I=null;d==="interpolate-hcl"||d==="interpolate-lab"?I=sn:l.expectedType&&l.expectedType.kind!=="value"&&(I=l.expectedType);for(let L=0;L<E.length;L+=2){const O=E[L],B=E[L+1],$=L+3,q=L+4;if(typeof O!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(A.length&&A[A.length-1][0]>=O)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const W=l.parse(B,q,I);if(!W)return null;I=I||W.type,A.push([O,W])}return Eo(I,yt)||Eo(I,Ci)||Eo(I,sn)||Eo(I,Ji)||Eo(I,To)||Eo(I,ar(yt))?new Zr(I,d,y,T,A):l.error(`Type ${Jn(I)} is not interpolatable.`)}evaluate(t){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(t);const y=this.input.evaluate(t);if(y<=l[0])return d[0].evaluate(t);const T=l.length;if(y>=l[T-1])return d[T-1].evaluate(t);const E=ad(l,y),A=Zr.interpolationFactor(this.interpolation,y,l[E],l[E+1]),I=d[E].evaluate(t),L=d[E+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return oa(I,L,A);case"color":return kn.interpolate(I,L,A);case"padding":return mr.interpolate(I,L,A);case"variableAnchorOffsetCollection":return Sr.interpolate(I,L,A);case"array":return Hl(I,L,A);case"projectionDefinition":return er.interpolate(I,L,A)}case"interpolate-hcl":return kn.interpolate(I,L,A,"hcl");case"interpolate-lab":return kn.interpolate(I,L,A,"lab")}}eachChild(t){t(this.input);for(const l of this.outputs)t(l)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function or(o,t,l,d){const y=d-l,T=o-l;return y===0?0:t===1?T/y:(Math.pow(t,T)-1)/(Math.pow(t,y)-1)}const Sa={color:kn.interpolate,number:oa,padding:mr.interpolate,variableAnchorOffsetCollection:Sr.interpolate,array:Hl};class Vc{constructor(t,l){this.type=t,this.args=l}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");let d=null;const y=l.expectedType;y&&y.kind!=="value"&&(d=y);const T=[];for(const A of t.slice(1)){const I=l.parse(A,1+T.length,d,void 0,{typeAnnotation:"omit"});if(!I)return null;d=d||I.type,T.push(I)}if(!d)throw new Error("No output type");const E=y&&T.some(A=>Gl(y,A.type));return new Vc(E?qt:d,T)}evaluate(t){let l,d=null,y=0;for(const T of this.args)if(y++,d=T.evaluate(t),d&&d instanceof Vr&&!d.available&&(l||(l=d.name),d=null,y===this.args.length&&(d=l)),d!==null)break;return d}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function bf(o,t){return o==="=="||o==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Vp(o,t,l,d){return d.compare(t,l)===0}function ko(o,t,l){const d=o!=="=="&&o!=="!=";return class Ww{constructor(T,E,A){this.type=Mt,this.lhs=T,this.rhs=E,this.collator=A,this.hasUntypedArgument=T.type.kind==="value"||E.type.kind==="value"}static parse(T,E){if(T.length!==3&&T.length!==4)return E.error("Expected two or three arguments.");const A=T[0];let I=E.parse(T[1],1,qt);if(!I)return null;if(!bf(A,I.type))return E.concat(1).error(`"${A}" comparisons are not supported for type '${Jn(I.type)}'.`);let L=E.parse(T[2],2,qt);if(!L)return null;if(!bf(A,L.type))return E.concat(2).error(`"${A}" comparisons are not supported for type '${Jn(L.type)}'.`);if(I.type.kind!==L.type.kind&&I.type.kind!=="value"&&L.type.kind!=="value")return E.error(`Cannot compare types '${Jn(I.type)}' and '${Jn(L.type)}'.`);d&&(I.type.kind==="value"&&L.type.kind!=="value"?I=new Yi(L.type,[I]):I.type.kind!=="value"&&L.type.kind==="value"&&(L=new Yi(I.type,[L])));let O=null;if(T.length===4){if(I.type.kind!=="string"&&L.type.kind!=="string"&&I.type.kind!=="value"&&L.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(O=E.parse(T[3],3,Bi),!O)return null}return new Ww(I,L,O)}evaluate(T){const E=this.lhs.evaluate(T),A=this.rhs.evaluate(T);if(d&&this.hasUntypedArgument){const I=_i(E),L=_i(A);if(I.kind!==L.kind||I.kind!=="string"&&I.kind!=="number")throw new Di(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${I.kind}, ${L.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const I=_i(E),L=_i(A);if(I.kind!=="string"||L.kind!=="string")return t(T,E,A)}return this.collator?l(T,E,A,this.collator.evaluate(T)):t(T,E,A)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const wf=ko("==",function(o,t,l){return t===l},Vp),Zp=ko("!=",function(o,t,l){return t!==l},function(o,t,l,d){return!Vp(0,t,l,d)}),od=ko("<",function(o,t,l){return t<l},function(o,t,l,d){return d.compare(t,l)<0}),ld=ko(">",function(o,t,l){return t>l},function(o,t,l,d){return d.compare(t,l)>0}),as=ko("<=",function(o,t,l){return t<=l},function(o,t,l,d){return d.compare(t,l)<=0}),Gp=ko(">=",function(o,t,l){return t>=l},function(o,t,l,d){return d.compare(t,l)>=0});class Io{constructor(t,l,d){this.type=Bi,this.locale=d,this.caseSensitive=t,this.diacriticSensitive=l}static parse(t,l){if(t.length!==2)return l.error("Expected one argument.");const d=t[1];if(typeof d!="object"||Array.isArray(d))return l.error("Collator options argument must be an object.");const y=l.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Mt);if(!y)return null;const T=l.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Mt);if(!T)return null;let E=null;return d.locale&&(E=l.parse(d.locale,1,Bt),!E)?null:new Io(y,T,E)}evaluate(t){return new kr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Tf{constructor(t,l,d,y,T){this.type=Bt,this.number=t,this.locale=l,this.currency=d,this.minFractionDigits=y,this.maxFractionDigits=T}static parse(t,l){if(t.length!==3)return l.error("Expected two arguments.");const d=l.parse(t[1],1,yt);if(!d)return null;const y=t[2];if(typeof y!="object"||Array.isArray(y))return l.error("NumberFormat options argument must be an object.");let T=null;if(y.locale&&(T=l.parse(y.locale,1,Bt),!T))return null;let E=null;if(y.currency&&(E=l.parse(y.currency,1,Bt),!E))return null;let A=null;if(y["min-fraction-digits"]&&(A=l.parse(y["min-fraction-digits"],1,yt),!A))return null;let I=null;return y["max-fraction-digits"]&&(I=l.parse(y["max-fraction-digits"],1,yt),!I)?null:new Tf(d,T,E,A,I)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Zc{constructor(t){this.type=$n,this.sections=t}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");const d=t[1];if(!Array.isArray(d)&&typeof d=="object")return l.error("First argument must be an image or text section.");const y=[];let T=!1;for(let E=1;E<=t.length-1;++E){const A=t[E];if(T&&typeof A=="object"&&!Array.isArray(A)){T=!1;let I=null;if(A["font-scale"]&&(I=l.parse(A["font-scale"],1,yt),!I))return null;let L=null;if(A["text-font"]&&(L=l.parse(A["text-font"],1,ar(Bt)),!L))return null;let O=null;if(A["text-color"]&&(O=l.parse(A["text-color"],1,sn),!O))return null;let B=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!ju.includes(A["vertical-align"]))return l.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(B=l.parse(A["vertical-align"],1,Bt),!B)return null}const $=y[y.length-1];$.scale=I,$.font=L,$.textColor=O,$.verticalAlign=B}else{const I=l.parse(t[E],1,qt);if(!I)return null;const L=I.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,y.push({content:I,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Zc(y)}evaluate(t){return new Ur(this.sections.map(l=>{const d=l.content.evaluate(t);return _i(d)===Zl?new Xl("",d,null,null,null,l.verticalAlign?l.verticalAlign.evaluate(t):null):new Xl(il(d),null,l.scale?l.scale.evaluate(t):null,l.font?l.font.evaluate(t).join(","):null,l.textColor?l.textColor.evaluate(t):null,l.verticalAlign?l.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const l of this.sections)t(l.content),l.scale&&t(l.scale),l.font&&t(l.font),l.textColor&&t(l.textColor),l.verticalAlign&&t(l.verticalAlign)}outputDefined(){return!1}}class Ef{constructor(t){this.type=Zl,this.input=t}static parse(t,l){if(t.length!==2)return l.error("Expected two arguments.");const d=l.parse(t[1],1,Bt);return d?new Ef(d):l.error("No image name provided.")}evaluate(t){const l=this.input.evaluate(t),d=Vr.fromString(l);return d&&t.availableImages&&(d.available=t.availableImages.indexOf(l)>-1),d}eachChild(t){t(this.input)}outputDefined(){return!1}}class cd{constructor(t){this.type=yt,this.input=t}static parse(t,l){if(t.length!==2)return l.error(`Expected 1 argument, but found ${t.length-1} instead.`);const d=l.parse(t[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Jn(d.type)} instead.`):new cd(d):null}evaluate(t){const l=this.input.evaluate(t);if(typeof l=="string")return[...l].length;if(Array.isArray(l))return l.length;throw new Di(`Expected value to be of type string or array, but found ${Jn(_i(l))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Gs=8192;function Mg(o,t){const l=(180+o[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,y=Math.pow(2,t.z);return[Math.round(l*y*Gs),Math.round(d*y*Gs)]}function Gc(o,t){const l=Math.pow(2,t.z);return[(y=(o[0]/Gs+t.x)/l,360*y-180),(d=(o[1]/Gs+t.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,y}function Fu(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function $c(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function $p(o,t,l){const d=o[0]-t[0],y=o[1]-t[1],T=o[0]-l[0],E=o[1]-l[1];return d*E-T*y==0&&d*T<=0&&y*E<=0}function ud(o,t,l,d){return(y=[d[0]-l[0],d[1]-l[1]])[0]*(T=[t[0]-o[0],t[1]-o[1]])[1]-y[1]*T[0]!=0&&!(!Af(o,t,l,d)||!Af(l,d,o,t));var y,T}function Yp(o,t,l){for(const d of l)for(let y=0;y<d.length-1;++y)if(ud(o,t,d[y],d[y+1]))return!0;return!1}function Yc(o,t,l=!1){let d=!1;for(const A of t)for(let I=0;I<A.length-1;I++){if($p(o,A[I],A[I+1]))return l;(T=A[I])[1]>(y=o)[1]!=(E=A[I+1])[1]>y[1]&&y[0]<(E[0]-T[0])*(y[1]-T[1])/(E[1]-T[1])+T[0]&&(d=!d)}var y,T,E;return d}function Sf(o,t){for(const l of t)if(Yc(o,l))return!0;return!1}function qc(o,t){for(const l of o)if(!Yc(l,t))return!1;for(let l=0;l<o.length-1;++l)if(Yp(o[l],o[l+1],t))return!1;return!0}function Cg(o,t){for(const l of t)if(qc(o,l))return!0;return!1}function Af(o,t,l,d){const y=d[0]-l[0],T=d[1]-l[1],E=(o[0]-l[0])*T-y*(o[1]-l[1]),A=(t[0]-l[0])*T-y*(t[1]-l[1]);return E>0&&A<0||E<0&&A>0}function Uu(o,t,l){const d=[];for(let y=0;y<o.length;y++){const T=[];for(let E=0;E<o[y].length;E++){const A=Mg(o[y][E],l);Fu(t,A),T.push(A)}d.push(T)}return d}function hd(o,t,l){const d=[];for(let y=0;y<o.length;y++){const T=Uu(o[y],t,l);d.push(T)}return d}function dd(o,t,l,d){if(o[0]<l[0]||o[0]>l[2]){const y=.5*d;let T=o[0]-l[0]>y?-d:l[0]-o[0]>y?d:0;T===0&&(T=o[0]-l[2]>y?-d:l[2]-o[0]>y?d:0),o[0]+=T}Fu(t,o)}function Mf(o,t,l,d){const y=Math.pow(2,d.z)*Gs,T=[d.x*Gs,d.y*Gs],E=[];for(const A of o)for(const I of A){const L=[I.x+T[0],I.y+T[1]];dd(L,t,l,y),E.push(L)}return E}function Ql(o,t,l,d){const y=Math.pow(2,d.z)*Gs,T=[d.x*Gs,d.y*Gs],E=[];for(const I of o){const L=[];for(const O of I){const B=[O.x+T[0],O.y+T[1]];Fu(t,B),L.push(B)}E.push(L)}if(t[2]-t[0]<=y/2){(A=t)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const I of E)for(const L of I)dd(L,t,l,y)}var A;return E}class Kl{constructor(t,l){this.type=Mt,this.geojson=t,this.geometries=l}static parse(t,l){if(t.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ea(t[1])){const d=t[1];if(d.type==="FeatureCollection"){const y=[];for(const T of d.features){const{type:E,coordinates:A}=T.geometry;E==="Polygon"&&y.push(A),E==="MultiPolygon"&&y.push(...A)}if(y.length)return new Kl(d,{type:"MultiPolygon",coordinates:y})}else if(d.type==="Feature"){const y=d.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Kl(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Kl(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(l,d){const y=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],E=l.canonicalID();if(d.type==="Polygon"){const A=Uu(d.coordinates,T,E),I=Mf(l.geometry(),y,T,E);if(!$c(y,T))return!1;for(const L of I)if(!Yc(L,A))return!1}if(d.type==="MultiPolygon"){const A=hd(d.coordinates,T,E),I=Mf(l.geometry(),y,T,E);if(!$c(y,T))return!1;for(const L of I)if(!Sf(L,A))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(l,d){const y=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],E=l.canonicalID();if(d.type==="Polygon"){const A=Uu(d.coordinates,T,E),I=Ql(l.geometry(),y,T,E);if(!$c(y,T))return!1;for(const L of I)if(!qc(L,A))return!1}if(d.type==="MultiPolygon"){const A=hd(d.coordinates,T,E),I=Ql(l.geometry(),y,T,E);if(!$c(y,T))return!1;for(const L of I)if(!Cg(L,A))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let fd=class{constructor(o=[],t=(l,d)=>l<d?-1:l>d?1:0){if(this.data=o,this.length=this.data.length,this.compare=t,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:t,compare:l}=this,d=t[o];for(;o>0;){const y=o-1>>1,T=t[y];if(l(d,T)>=0)break;t[o]=T,o=y}t[o]=d}_down(o){const{data:t,compare:l}=this,d=this.length>>1,y=t[o];for(;o<d;){let T=1+(o<<1);const E=T+1;if(E<this.length&&l(t[E],t[T])<0&&(T=E),l(t[T],y)>=0)break;t[o]=t[T],o=T}t[o]=y}};function qp(o,t,l=0,d=o.length-1,y=Hp){for(;d>l;){if(d-l>600){const I=d-l+1,L=t-l+1,O=Math.log(I),B=.5*Math.exp(2*O/3),$=.5*Math.sqrt(O*B*(I-B)/I)*(L-I/2<0?-1:1);qp(o,t,Math.max(l,Math.floor(t-L*B/I+$)),Math.min(d,Math.floor(t+(I-L)*B/I+$)),y)}const T=o[t];let E=l,A=d;for(Hc(o,l,t),y(o[d],T)>0&&Hc(o,l,d);E<A;){for(Hc(o,E,A),E++,A--;y(o[E],T)<0;)E++;for(;y(o[A],T)>0;)A--}y(o[l],T)===0?Hc(o,l,A):(A++,Hc(o,A,d)),A<=t&&(l=A+1),t<=A&&(d=A-1)}}function Hc(o,t,l){const d=o[t];o[t]=o[l],o[l]=d}function Hp(o,t){return o<t?-1:o>t?1:0}function Ro(o,t){if(o.length<=1)return[o];const l=[];let d,y;for(const T of o){const E=Dg(T);E!==0&&(T.area=Math.abs(E),y===void 0&&(y=E<0),y===E<0?(d&&l.push(d),d=[T]):d.push(T))}if(d&&l.push(d),t>1)for(let T=0;T<l.length;T++)l[T].length<=t||(qp(l[T],t,1,l[T].length-1,Xc),l[T]=l[T].slice(0,t));return l}function Xc(o,t){return t.area-o.area}function Dg(o){let t=0;for(let l,d,y=0,T=o.length,E=T-1;y<T;E=y++)l=o[y],d=o[E],t+=(d.x-l.x)*(l.y+d.y);return t}const Vu=1/298.257223563,pd=Vu*(2-Vu),md=Math.PI/180;class Zu{constructor(t){const l=6378.137*md*1e3,d=Math.cos(t*md),y=1/(1-pd*(1-d*d)),T=Math.sqrt(y);this.kx=l*T*d,this.ky=l*T*y*(1-pd)}distance(t,l){const d=this.wrap(t[0]-l[0])*this.kx,y=(t[1]-l[1])*this.ky;return Math.sqrt(d*d+y*y)}pointOnLine(t,l){let d,y,T,E,A=1/0;for(let I=0;I<t.length-1;I++){let L=t[I][0],O=t[I][1],B=this.wrap(t[I+1][0]-L)*this.kx,$=(t[I+1][1]-O)*this.ky,q=0;B===0&&$===0||(q=(this.wrap(l[0]-L)*this.kx*B+(l[1]-O)*this.ky*$)/(B*B+$*$),q>1?(L=t[I+1][0],O=t[I+1][1]):q>0&&(L+=B/this.kx*q,O+=$/this.ky*q)),B=this.wrap(l[0]-L)*this.kx,$=(l[1]-O)*this.ky;const W=B*B+$*$;W<A&&(A=W,d=L,y=O,T=I,E=q)}return{point:[d,y],index:T,t:Math.max(0,Math.min(1,E))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function gd(o,t){return t[0]-o[0]}function Gu(o){return o[1]-o[0]+1}function ss(o,t){return o[1]>=o[0]&&o[1]<t}function yd(o,t){if(o[0]>o[1])return[null,null];const l=Gu(o);if(t){if(l===2)return[o,null];const y=Math.floor(l/2);return[[o[0],o[0]+y],[o[0]+y,o[1]]]}if(l===1)return[o,null];const d=Math.floor(l/2)-1;return[[o[0],o[0]+d],[o[0]+d+1,o[1]]]}function Cf(o,t){if(!ss(t,o.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let d=t[0];d<=t[1];++d)Fu(l,o[d]);return l}function Df(o){const t=[1/0,1/0,-1/0,-1/0];for(const l of o)for(const d of l)Fu(t,d);return t}function Xp(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function Bn(o,t,l){if(!Xp(o)||!Xp(t))return NaN;let d=0,y=0;return o[2]<t[0]&&(d=t[0]-o[2]),o[0]>t[2]&&(d=o[0]-t[2]),o[1]>t[3]&&(y=o[1]-t[3]),o[3]<t[1]&&(y=t[1]-o[3]),l.distance([0,0],[d,y])}function Jl(o,t,l){const d=l.pointOnLine(t,o);return l.distance(o,d.point)}function Wr(o,t,l,d,y){const T=Math.min(Jl(o,[l,d],y),Jl(t,[l,d],y)),E=Math.min(Jl(l,[o,t],y),Jl(d,[o,t],y));return Math.min(T,E)}function $u(o,t,l,d,y){if(!ss(t,o.length)||!ss(d,l.length))return 1/0;let T=1/0;for(let E=t[0];E<t[1];++E){const A=o[E],I=o[E+1];for(let L=d[0];L<d[1];++L){const O=l[L],B=l[L+1];if(ud(A,I,O,B))return 0;T=Math.min(T,Wr(A,I,O,B,y))}}return T}function Wp(o,t,l,d,y){if(!ss(t,o.length)||!ss(d,l.length))return NaN;let T=1/0;for(let E=t[0];E<=t[1];++E)for(let A=d[0];A<=d[1];++A)if(T=Math.min(T,y.distance(o[E],l[A])),T===0)return T;return T}function Qp(o,t,l){if(Yc(o,t,!0))return 0;let d=1/0;for(const y of t){const T=y[0],E=y[y.length-1];if(T!==E&&(d=Math.min(d,Jl(o,[E,T],l)),d===0))return d;const A=l.pointOnLine(y,o);if(d=Math.min(d,l.distance(o,A.point)),d===0)return d}return d}function Kp(o,t,l,d){if(!ss(t,o.length))return NaN;for(let T=t[0];T<=t[1];++T)if(Yc(o[T],l,!0))return 0;let y=1/0;for(let T=t[0];T<t[1];++T){const E=o[T],A=o[T+1];for(const I of l)for(let L=0,O=I.length,B=O-1;L<O;B=L++){const $=I[B],q=I[L];if(ud(E,A,$,q))return 0;y=Math.min(y,Wr(E,A,$,q,d))}}return y}function kf(o,t){for(const l of o)for(const d of l)if(Yc(d,t,!0))return!0;return!1}function If(o,t,l,d=1/0){const y=Df(o),T=Df(t);if(d!==1/0&&Bn(y,T,l)>=d)return d;if($c(y,T)){if(kf(o,t))return 0}else if(kf(t,o))return 0;let E=1/0;for(const A of o)for(let I=0,L=A.length,O=L-1;I<L;O=I++){const B=A[O],$=A[I];for(const q of t)for(let W=0,J=q.length,le=J-1;W<J;le=W++){const fe=q[le],Ee=q[W];if(ud(B,$,fe,Ee))return 0;E=Math.min(E,Wr(B,$,fe,Ee,l))}}return E}function Jp(o,t,l,d,y,T){if(!T)return;const E=Bn(Cf(d,T),y,l);E<t&&o.push([E,T,[0,0]])}function zo(o,t,l,d,y,T,E){if(!T||!E)return;const A=Bn(Cf(d,T),Cf(y,E),l);A<t&&o.push([A,T,E])}function Wc(o,t,l,d,y=1/0){let T=Math.min(d.distance(o[0],l[0][0]),y);if(T===0)return T;const E=new fd([[0,[0,o.length-1],[0,0]]],gd),A=Df(l);for(;E.length>0;){const I=E.pop();if(I[0]>=T)continue;const L=I[1],O=t?50:100;if(Gu(L)<=O){if(!ss(L,o.length))return NaN;if(t){const B=Kp(o,L,l,d);if(isNaN(B)||B===0)return B;T=Math.min(T,B)}else for(let B=L[0];B<=L[1];++B){const $=Qp(o[B],l,d);if(T=Math.min(T,$),T===0)return 0}}else{const B=yd(L,t);Jp(E,T,d,o,A,B[0]),Jp(E,T,d,o,A,B[1])}}return T}function sl(o,t,l,d,y,T=1/0){let E=Math.min(T,y.distance(o[0],l[0]));if(E===0)return E;const A=new fd([[0,[0,o.length-1],[0,l.length-1]]],gd);for(;A.length>0;){const I=A.pop();if(I[0]>=E)continue;const L=I[1],O=I[2],B=t?50:100,$=d?50:100;if(Gu(L)<=B&&Gu(O)<=$){if(!ss(L,o.length)&&ss(O,l.length))return NaN;let q;if(t&&d)q=$u(o,L,l,O,y),E=Math.min(E,q);else if(t&&!d){const W=o.slice(L[0],L[1]+1);for(let J=O[0];J<=O[1];++J)if(q=Jl(l[J],W,y),E=Math.min(E,q),E===0)return E}else if(!t&&d){const W=l.slice(O[0],O[1]+1);for(let J=L[0];J<=L[1];++J)if(q=Jl(o[J],W,y),E=Math.min(E,q),E===0)return E}else q=Wp(o,L,l,O,y),E=Math.min(E,q)}else{const q=yd(L,t),W=yd(O,d);zo(A,E,y,o,l,q[0],W[0]),zo(A,E,y,o,l,q[0],W[1]),zo(A,E,y,o,l,q[1],W[0]),zo(A,E,y,o,l,q[1],W[1])}}return E}function Yu(o){return o.type==="MultiPolygon"?o.coordinates.map(t=>({type:"Polygon",coordinates:t})):o.type==="MultiLineString"?o.coordinates.map(t=>({type:"LineString",coordinates:t})):o.type==="MultiPoint"?o.coordinates.map(t=>({type:"Point",coordinates:t})):[o]}class ol{constructor(t,l){this.type=yt,this.geojson=t,this.geometries=l}static parse(t,l){if(t.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ea(t[1])){const d=t[1];if(d.type==="FeatureCollection")return new ol(d,d.features.map(y=>Yu(y.geometry)).flat());if(d.type==="Feature")return new ol(d,Yu(d.geometry));if("type"in d&&"coordinates"in d)return new ol(d,Yu(d))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(l,d){const y=l.geometry(),T=y.flat().map(I=>Gc([I.x,I.y],l.canonical));if(y.length===0)return NaN;const E=new Zu(T[0][1]);let A=1/0;for(const I of d){switch(I.type){case"Point":A=Math.min(A,sl(T,!1,[I.coordinates],!1,E,A));break;case"LineString":A=Math.min(A,sl(T,!1,I.coordinates,!0,E,A));break;case"Polygon":A=Math.min(A,Wc(T,!1,I.coordinates,E,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="LineString")return function(l,d){const y=l.geometry(),T=y.flat().map(I=>Gc([I.x,I.y],l.canonical));if(y.length===0)return NaN;const E=new Zu(T[0][1]);let A=1/0;for(const I of d){switch(I.type){case"Point":A=Math.min(A,sl(T,!0,[I.coordinates],!1,E,A));break;case"LineString":A=Math.min(A,sl(T,!0,I.coordinates,!0,E,A));break;case"Polygon":A=Math.min(A,Wc(T,!0,I.coordinates,E,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="Polygon")return function(l,d){const y=l.geometry();if(y.length===0||y[0].length===0)return NaN;const T=Ro(y,0).map(I=>I.map(L=>L.map(O=>Gc([O.x,O.y],l.canonical)))),E=new Zu(T[0][0][0][1]);let A=1/0;for(const I of d)for(const L of T){switch(I.type){case"Point":A=Math.min(A,Wc([I.coordinates],!1,L,E,A));break;case"LineString":A=Math.min(A,Wc(I.coordinates,!0,L,E,A));break;case"Polygon":A=Math.min(A,If(L,I.coordinates,E,A))}if(A===0)return A}return A}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ba={"==":wf,"!=":Zp,">":ld,"<":od,">=":Gp,"<=":as,array:Yi,at:ca,boolean:Yi,case:rl,coalesce:Vc,collator:Io,format:Zc,image:Ef,in:Uc,"index-of":Ar,interpolate:Zr,"interpolate-hcl":Zr,"interpolate-lab":Zr,length:cd,let:Dn,literal:So,match:Zs,number:Yi,"number-format":Tf,object:Yi,slice:Do,step:al,string:Yi,"to-boolean":la,"to-color":la,"to-number":la,"to-string":la,var:Co,within:Kl,distance:ol};class Ir{constructor(t,l,d,y){this.name=t,this.type=l,this._evaluate=d,this.args=y}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,l){const d=t[0],y=Ir.definitions[d];if(!y)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,A=E.filter(([L])=>!Array.isArray(L)||L.length===t.length-1);let I=null;for(const[L,O]of A){I=new Mo(l.registry,qu,l.path,null,l.scope);const B=[];let $=!1;for(let q=1;q<t.length;q++){const W=t[q],J=Array.isArray(L)?L[q-1]:L.type,le=I.parse(W,1+B.length,J);if(!le){$=!0;break}B.push(le)}if(!$)if(Array.isArray(L)&&L.length!==B.length)I.error(`Expected ${L.length} arguments, but found ${B.length} instead.`);else{for(let q=0;q<B.length;q++){const W=Array.isArray(L)?L[q]:L.type,J=B[q];I.concat(q+1).checkSubtype(W,J.type)}if(I.errors.length===0)return new Ir(d,T,O,B)}}if(A.length===1)l.errors.push(...I.errors);else{const L=(A.length?A:E).map(([B])=>{return $=B,Array.isArray($)?`(${$.map(Jn).join(", ")})`:`(${Jn($.type)}...)`;var $}).join(" | "),O=[];for(let B=1;B<t.length;B++){const $=l.parse(t[B],1+O.length);if(!$)return null;O.push(Jn($.type))}l.error(`Expected arguments of type ${L}, but found (${O.join(", ")}) instead.`)}return null}static register(t,l){Ir.definitions=l;for(const d in l)t[d]=Ir}}function _d(o,[t,l,d,y]){t=t.evaluate(o),l=l.evaluate(o),d=d.evaluate(o);const T=y?y.evaluate(o):1,E=Wl(t,l,d,T);if(E)throw new Di(E);return new kn(t/255,l/255,d/255,T,!1)}function Rf(o,t){return o in t}function Lo(o,t){const l=t[o];return l===void 0?null:l}function ll(o){return{type:o}}function qu(o){if(o instanceof Co)return qu(o.boundExpression);if(o instanceof Ir&&o.name==="error"||o instanceof Io||o instanceof Kl||o instanceof ol)return!1;const t=o instanceof la||o instanceof Yi;let l=!0;return o.eachChild(d=>{l=t?l&&qu(d):l&&d instanceof So}),!!l&&Hu(o)&&vd(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Hu(o){if(o instanceof Ir&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof Kl||o instanceof ol)return!1;let t=!0;return o.eachChild(l=>{t&&!Hu(l)&&(t=!1)}),t}function Xu(o){if(o instanceof Ir&&o.name==="feature-state")return!1;let t=!0;return o.eachChild(l=>{t&&!Xu(l)&&(t=!1)}),t}function vd(o,t){if(o instanceof Ir&&t.indexOf(o.name)>=0)return!1;let l=!0;return o.eachChild(d=>{l&&!vd(d,t)&&(l=!1)}),l}function em(o){return{result:"success",value:o}}function ec(o){return{result:"error",value:o}}function tc(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function xd(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Aa(o){return!!o.expression&&o.expression.interpolated}function zn(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Qr(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function ua(o){return o}function nc(o,t){const l=t.type==="color",d=o.stops&&typeof o.stops[0][0]=="object",y=d||!(d||o.property!==void 0),T=o.type||(Aa(t)?"exponential":"interval");if(l||t.type==="padding"){const O=l?kn.parse:mr.parse;(o=$t({},o)).stops&&(o.stops=o.stops.map(B=>[B[0],O(B[1])])),o.default=O(o.default?o.default:t.default)}if(o.colorSpace&&(E=o.colorSpace)!=="rgb"&&E!=="hcl"&&E!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var E;let A,I,L;if(T==="exponential")A=wd;else if(T==="interval")A=Wu;else if(T==="categorical"){A=bd,I=Object.create(null);for(const O of o.stops)I[O[0]]=O[1];L=typeof o.stops[0][0]}else{if(T!=="identity")throw new Error(`Unknown function type "${T}"`);A=Qc}if(d){const O={},B=[];for(let W=0;W<o.stops.length;W++){const J=o.stops[W],le=J[0].zoom;O[le]===void 0&&(O[le]={zoom:le,type:o.type,property:o.property,default:o.default,stops:[]},B.push(le)),O[le].stops.push([J[0].value,J[1]])}const $=[];for(const W of B)$.push([O[W].zoom,nc(O[W],t)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:Zr.interpolationFactor.bind(void 0,q),zoomStops:$.map(W=>W[0]),evaluate:({zoom:W},J)=>wd({stops:$,base:o.base},t,W).evaluate(W,J)}}if(y){const O=T==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Zr.interpolationFactor.bind(void 0,O),zoomStops:o.stops.map(B=>B[0]),evaluate:({zoom:B})=>A(o,t,B,I,L)}}return{kind:"source",evaluate(O,B){const $=B&&B.properties?B.properties[o.property]:void 0;return $===void 0?ic(o.default,t.default):A(o,t,$,I,L)}}}function ic(o,t,l){return o!==void 0?o:t!==void 0?t:l!==void 0?l:void 0}function bd(o,t,l,d,y){return ic(typeof l===y?d[l]:void 0,o.default,t.default)}function Wu(o,t,l){if(zn(l)!=="number")return ic(o.default,t.default);const d=o.stops.length;if(d===1||l<=o.stops[0][0])return o.stops[0][1];if(l>=o.stops[d-1][0])return o.stops[d-1][1];const y=ad(o.stops.map(T=>T[0]),l);return o.stops[y][1]}function wd(o,t,l){const d=o.base!==void 0?o.base:1;if(zn(l)!=="number")return ic(o.default,t.default);const y=o.stops.length;if(y===1||l<=o.stops[0][0])return o.stops[0][1];if(l>=o.stops[y-1][0])return o.stops[y-1][1];const T=ad(o.stops.map(O=>O[0]),l),E=function(O,B,$,q){const W=q-$,J=O-$;return W===0?0:B===1?J/W:(Math.pow(B,J)-1)/(Math.pow(B,W)-1)}(l,d,o.stops[T][0],o.stops[T+1][0]),A=o.stops[T][1],I=o.stops[T+1][1],L=Sa[t.type]||ua;return typeof A.evaluate=="function"?{evaluate(...O){const B=A.evaluate.apply(void 0,O),$=I.evaluate.apply(void 0,O);if(B!==void 0&&$!==void 0)return L(B,$,E,o.colorSpace)}}:L(A,I,E,o.colorSpace)}function Qc(o,t,l){switch(t.type){case"color":l=kn.parse(l);break;case"formatted":l=Ur.fromString(l.toString());break;case"resolvedImage":l=Vr.fromString(l.toString());break;case"padding":l=mr.parse(l);break;default:zn(l)===t.type||t.type==="enum"&&t.values[l]||(l=void 0)}return ic(l,o.default,t.default)}Ir.register(Ba,{error:[{kind:"error"},[Bt],(o,[t])=>{throw new Di(t.evaluate(o))}],typeof:[Bt,[qt],(o,[t])=>Jn(_i(t.evaluate(o)))],"to-rgba":[ar(yt,4),[sn],(o,[t])=>{const[l,d,y,T]=t.evaluate(o).rgb;return[255*l,255*d,255*y,T]}],rgb:[sn,[yt,yt,yt],_d],rgba:[sn,[yt,yt,yt,yt],_d],has:{type:Mt,overloads:[[[Bt],(o,[t])=>Rf(t.evaluate(o),o.properties())],[[Bt,sa],(o,[t,l])=>Rf(t.evaluate(o),l.evaluate(o))]]},get:{type:qt,overloads:[[[Bt],(o,[t])=>Lo(t.evaluate(o),o.properties())],[[Bt,sa],(o,[t,l])=>Lo(t.evaluate(o),l.evaluate(o))]]},"feature-state":[qt,[Bt],(o,[t])=>Lo(t.evaluate(o),o.featureState||{})],properties:[sa,[],o=>o.properties()],"geometry-type":[Bt,[],o=>o.geometryType()],id:[qt,[],o=>o.id()],zoom:[yt,[],o=>o.globals.zoom],"heatmap-density":[yt,[],o=>o.globals.heatmapDensity||0],"line-progress":[yt,[],o=>o.globals.lineProgress||0],accumulated:[qt,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[yt,ll(yt),(o,t)=>{let l=0;for(const d of t)l+=d.evaluate(o);return l}],"*":[yt,ll(yt),(o,t)=>{let l=1;for(const d of t)l*=d.evaluate(o);return l}],"-":{type:yt,overloads:[[[yt,yt],(o,[t,l])=>t.evaluate(o)-l.evaluate(o)],[[yt],(o,[t])=>-t.evaluate(o)]]},"/":[yt,[yt,yt],(o,[t,l])=>t.evaluate(o)/l.evaluate(o)],"%":[yt,[yt,yt],(o,[t,l])=>t.evaluate(o)%l.evaluate(o)],ln2:[yt,[],()=>Math.LN2],pi:[yt,[],()=>Math.PI],e:[yt,[],()=>Math.E],"^":[yt,[yt,yt],(o,[t,l])=>Math.pow(t.evaluate(o),l.evaluate(o))],sqrt:[yt,[yt],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[yt,[yt],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[yt,[yt],(o,[t])=>Math.log(t.evaluate(o))],log2:[yt,[yt],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[yt,[yt],(o,[t])=>Math.sin(t.evaluate(o))],cos:[yt,[yt],(o,[t])=>Math.cos(t.evaluate(o))],tan:[yt,[yt],(o,[t])=>Math.tan(t.evaluate(o))],asin:[yt,[yt],(o,[t])=>Math.asin(t.evaluate(o))],acos:[yt,[yt],(o,[t])=>Math.acos(t.evaluate(o))],atan:[yt,[yt],(o,[t])=>Math.atan(t.evaluate(o))],min:[yt,ll(yt),(o,t)=>Math.min(...t.map(l=>l.evaluate(o)))],max:[yt,ll(yt),(o,t)=>Math.max(...t.map(l=>l.evaluate(o)))],abs:[yt,[yt],(o,[t])=>Math.abs(t.evaluate(o))],round:[yt,[yt],(o,[t])=>{const l=t.evaluate(o);return l<0?-Math.round(-l):Math.round(l)}],floor:[yt,[yt],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[yt,[yt],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[Mt,[Bt,qt],(o,[t,l])=>o.properties()[t.value]===l.value],"filter-id-==":[Mt,[qt],(o,[t])=>o.id()===t.value],"filter-type-==":[Mt,[Bt],(o,[t])=>o.geometryType()===t.value],"filter-<":[Mt,[Bt,qt],(o,[t,l])=>{const d=o.properties()[t.value],y=l.value;return typeof d==typeof y&&d<y}],"filter-id-<":[Mt,[qt],(o,[t])=>{const l=o.id(),d=t.value;return typeof l==typeof d&&l<d}],"filter->":[Mt,[Bt,qt],(o,[t,l])=>{const d=o.properties()[t.value],y=l.value;return typeof d==typeof y&&d>y}],"filter-id->":[Mt,[qt],(o,[t])=>{const l=o.id(),d=t.value;return typeof l==typeof d&&l>d}],"filter-<=":[Mt,[Bt,qt],(o,[t,l])=>{const d=o.properties()[t.value],y=l.value;return typeof d==typeof y&&d<=y}],"filter-id-<=":[Mt,[qt],(o,[t])=>{const l=o.id(),d=t.value;return typeof l==typeof d&&l<=d}],"filter->=":[Mt,[Bt,qt],(o,[t,l])=>{const d=o.properties()[t.value],y=l.value;return typeof d==typeof y&&d>=y}],"filter-id->=":[Mt,[qt],(o,[t])=>{const l=o.id(),d=t.value;return typeof l==typeof d&&l>=d}],"filter-has":[Mt,[qt],(o,[t])=>t.value in o.properties()],"filter-has-id":[Mt,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Mt,[ar(Bt)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[Mt,[ar(qt)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[Mt,[Bt,ar(qt)],(o,[t,l])=>l.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[Mt,[Bt,ar(qt)],(o,[t,l])=>function(d,y,T,E){for(;T<=E;){const A=T+E>>1;if(y[A]===d)return!0;y[A]>d?E=A-1:T=A+1}return!1}(o.properties()[t.value],l.value,0,l.value.length-1)],all:{type:Mt,overloads:[[[Mt,Mt],(o,[t,l])=>t.evaluate(o)&&l.evaluate(o)],[ll(Mt),(o,t)=>{for(const l of t)if(!l.evaluate(o))return!1;return!0}]]},any:{type:Mt,overloads:[[[Mt,Mt],(o,[t,l])=>t.evaluate(o)||l.evaluate(o)],[ll(Mt),(o,t)=>{for(const l of t)if(l.evaluate(o))return!0;return!1}]]},"!":[Mt,[Mt],(o,[t])=>!t.evaluate(o)],"is-supported-script":[Mt,[Bt],(o,[t])=>{const l=o.globals&&o.globals.isSupportedScript;return!l||l(t.evaluate(o))}],upcase:[Bt,[Bt],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[Bt,[Bt],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[Bt,ll(qt),(o,t)=>t.map(l=>il(l.evaluate(o))).join("")],"resolved-locale":[Bt,[Bi],(o,[t])=>t.evaluate(o).resolvedLocale()]});class rc{constructor(t,l){var d;this.expression=t,this._warningHistory={},this._evaluator=new fn,this._defaultValue=l?(d=l).type==="color"&&Qr(d.default)?new kn(0,0,0,0):d.type==="color"?kn.parse(d.default)||null:d.type==="padding"?mr.parse(d.default)||null:d.type==="variableAnchorOffsetCollection"?Sr.parse(d.default)||null:d.type==="projectionDefinition"?er.parse(d.default)||null:d.default===void 0?null:d.default:null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(t,l,d,y,T,E){return this._evaluator.globals=t,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=y,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(t,l,d,y,T,E){this._evaluator.globals=t,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=y,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=E||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Di(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function cl(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Ba}function No(o,t){const l=new Mo(Ba,qu,[],t?function(y){const T={color:sn,string:Bt,number:yt,enum:Bt,boolean:Mt,formatted:$n,padding:Ji,projectionDefinition:Ci,resolvedImage:Zl,variableAnchorOffsetCollection:To};return y.type==="array"?ar(T[y.value]||qt,y.length):T[y.type]}(t):void 0),d=l.parse(o,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?em(new rc(d,t)):ec(l.errors)}class zf{constructor(t,l){this.kind=t,this._styleExpression=l,this.isStateDependent=t!=="constant"&&!Xu(l.expression)}evaluateWithoutErrorHandling(t,l,d,y,T,E){return this._styleExpression.evaluateWithoutErrorHandling(t,l,d,y,T,E)}evaluate(t,l,d,y,T,E){return this._styleExpression.evaluate(t,l,d,y,T,E)}}class Kr{constructor(t,l,d,y){this.kind=t,this.zoomStops=d,this._styleExpression=l,this.isStateDependent=t!=="camera"&&!Xu(l.expression),this.interpolationType=y}evaluateWithoutErrorHandling(t,l,d,y,T,E){return this._styleExpression.evaluateWithoutErrorHandling(t,l,d,y,T,E)}evaluate(t,l,d,y,T,E){return this._styleExpression.evaluate(t,l,d,y,T,E)}interpolationFactor(t,l,d){return this.interpolationType?Zr.interpolationFactor(this.interpolationType,t,l,d):0}}function Td(o,t){const l=No(o,t);if(l.result==="error")return l;const d=l.value.expression,y=Hu(d);if(!y&&!tc(t))return ec([new jt("","data expressions not supported")]);const T=vd(d,["zoom"]);if(!T&&!xd(t))return ec([new jt("","zoom expressions not supported")]);const E=Kc(d);return E||T?E instanceof jt?ec([E]):E instanceof Zr&&!Aa(t)?ec([new jt("",'"interpolate" expressions cannot be used with this property')]):em(E?new Kr(y?"camera":"composite",l.value,E.labels,E instanceof Zr?E.interpolation:void 0):new zf(y?"constant":"source",l.value)):ec([new jt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Fa{constructor(t,l){this._parameters=t,this._specification=l,$t(this,nc(this._parameters,this._specification))}static deserialize(t){return new Fa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Kc(o){let t=null;if(o instanceof Dn)t=Kc(o.result);else if(o instanceof Vc){for(const l of o.args)if(t=Kc(l),t)break}else(o instanceof al||o instanceof Zr)&&o.input instanceof Ir&&o.input.name==="zoom"&&(t=o);return t instanceof jt||o.eachChild(l=>{const d=Kc(l);d instanceof jt?t=d:!t&&d?t=new jt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&d&&t!==d&&(t=new jt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ac(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const t of o.slice(1))if(!ac(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const sc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qu(o){if(o==null)return{filter:()=>!0,needGeometry:!1};ac(o)||(o=$s(o));const t=No(o,sc);if(t.result==="error")throw new Error(t.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,d,y)=>t.value.evaluate(l,d,{},y),needGeometry:ul(o)}}function Ed(o,t){return o<t?-1:o>t?1:0}function ul(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let t=1;t<o.length;t++)if(ul(o[t]))return!0;return!1}function $s(o){if(!o)return!0;const t=o[0];return o.length<=1?t!=="any":t==="=="?oc(o[1],o[2],"=="):t==="!="?Rr(oc(o[1],o[2],"==")):t==="<"||t===">"||t==="<="||t===">="?oc(o[1],o[2],t):t==="any"?(l=o.slice(1),["any"].concat(l.map($s))):t==="all"?["all"].concat(o.slice(1).map($s)):t==="none"?["all"].concat(o.slice(1).map($s).map(Rr)):t==="in"?lc(o[1],o.slice(2)):t==="!in"?Rr(lc(o[1],o.slice(2))):t==="has"?Jr(o[1]):t!=="!has"||Rr(Jr(o[1]));var l}function oc(o,t,l){switch(o){case"$type":return[`filter-type-${l}`,t];case"$id":return[`filter-id-${l}`,t];default:return[`filter-${l}`,o,t]}}function lc(o,t){if(t.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(l=>typeof l!=typeof t[0])?["filter-in-large",o,["literal",t.sort(Ed)]]:["filter-in-small",o,["literal",t]]}}function Jr(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Rr(o){return["!",o]}function Ua(o){const t=typeof o;if(t==="number"||t==="boolean"||t==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let y="[";for(const T of o)y+=`${Ua(T)},`;return`${y}]`}const l=Object.keys(o).sort();let d="{";for(let y=0;y<l.length;y++)d+=`${JSON.stringify(l[y])}:${Ua(o[l[y]])},`;return`${d}}`}function Po(o){let t="";for(const l of _e)t+=`/${Ua(o[l])}`;return t}function Ys(o){const t=o.value;return t?[new Xe(o.key,t,"constants have been deprecated as of v8")]:[]}function ri(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function hl(o){if(Array.isArray(o))return o.map(hl);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const t={};for(const l in o)t[l]=hl(o[l]);return t}return ri(o)}function ha(o){const t=o.key,l=o.value,d=o.valueSpec||{},y=o.objectElementValidators||{},T=o.style,E=o.styleSpec,A=o.validateSpec;let I=[];const L=zn(l);if(L!=="object")return[new Xe(t,l,`object expected, ${L} found`)];for(const O in l){const B=O.split(".")[0],$=d[B]||d["*"];let q;if(y[B])q=y[B];else if(d[B])q=A;else if(y["*"])q=y["*"];else{if(!d["*"]){I.push(new Xe(t,l[O],`unknown property "${O}"`));continue}q=A}I=I.concat(q({key:(t&&`${t}.`)+O,value:l[O],valueSpec:$,style:T,styleSpec:E,object:l,objectKey:O,validateSpec:A},l))}for(const O in d)y[O]||d[O].required&&d[O].default===void 0&&l[O]===void 0&&I.push(new Xe(t,l,`missing required property "${O}"`));return I}function Ku(o){const t=o.value,l=o.valueSpec,d=o.style,y=o.styleSpec,T=o.key,E=o.arrayElementValidator||o.validateSpec;if(zn(t)!=="array")return[new Xe(T,t,`array expected, ${zn(t)} found`)];if(l.length&&t.length!==l.length)return[new Xe(T,t,`array length ${l.length} expected, length ${t.length} found`)];if(l["min-length"]&&t.length<l["min-length"])return[new Xe(T,t,`array length at least ${l["min-length"]} expected, length ${t.length} found`)];let A={type:l.value,values:l.values};y.$version<7&&(A.function=l.function),zn(l.value)==="object"&&(A=l.value);let I=[];for(let L=0;L<t.length;L++)I=I.concat(E({array:t,arrayIndex:L,value:t[L],valueSpec:A,validateSpec:o.validateSpec,style:d,styleSpec:y,key:`${T}[${L}]`}));return I}function Mr(o){const t=o.key,l=o.value,d=o.valueSpec;let y=zn(l);return y==="number"&&l!=l&&(y="NaN"),y!=="number"?[new Xe(t,l,`number expected, ${y} found`)]:"minimum"in d&&l<d.minimum?[new Xe(t,l,`${l} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&l>d.maximum?[new Xe(t,l,`${l} is greater than the maximum value ${d.maximum}`)]:[]}function Li(o){const t=o.valueSpec,l=ri(o.value.type);let d,y,T,E={};const A=l!=="categorical"&&o.value.property===void 0,I=!A,L=zn(o.value.stops)==="array"&&zn(o.value.stops[0])==="array"&&zn(o.value.stops[0][0])==="object",O=ha({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(q){if(l==="identity")return[new Xe(q.key,q.value,'identity function may not have a "stops" property')];let W=[];const J=q.value;return W=W.concat(Ku({key:q.key,value:J,valueSpec:q.valueSpec,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:B})),zn(J)==="array"&&J.length===0&&W.push(new Xe(q.key,J,"array must have at least one stop")),W},default:function(q){return q.validateSpec({key:q.key,value:q.value,valueSpec:t,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec})}}});return l==="identity"&&A&&O.push(new Xe(o.key,o.value,'missing required property "property"')),l==="identity"||o.value.stops||O.push(new Xe(o.key,o.value,'missing required property "stops"')),l==="exponential"&&o.valueSpec.expression&&!Aa(o.valueSpec)&&O.push(new Xe(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(I&&!tc(o.valueSpec)?O.push(new Xe(o.key,o.value,"property functions not supported")):A&&!xd(o.valueSpec)&&O.push(new Xe(o.key,o.value,"zoom functions not supported"))),l!=="categorical"&&!L||o.value.property!==void 0||O.push(new Xe(o.key,o.value,'"property" property is required')),O;function B(q){let W=[];const J=q.value,le=q.key;if(zn(J)!=="array")return[new Xe(le,J,`array expected, ${zn(J)} found`)];if(J.length!==2)return[new Xe(le,J,`array length 2 expected, length ${J.length} found`)];if(L){if(zn(J[0])!=="object")return[new Xe(le,J,`object expected, ${zn(J[0])} found`)];if(J[0].zoom===void 0)return[new Xe(le,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new Xe(le,J,"object stop key must have value")];if(T&&T>ri(J[0].zoom))return[new Xe(le,J[0].zoom,"stop zoom values must appear in ascending order")];ri(J[0].zoom)!==T&&(T=ri(J[0].zoom),y=void 0,E={}),W=W.concat(ha({key:`${le}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:Mr,value:$}}))}else W=W.concat($({key:`${le}[0]`,value:J[0],validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec},J));return cl(hl(J[1]))?W.concat([new Xe(`${le}[1]`,J[1],"expressions are not allowed in function stops.")]):W.concat(q.validateSpec({key:`${le}[1]`,value:J[1],valueSpec:t,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec}))}function $(q,W){const J=zn(q.value),le=ri(q.value),fe=q.value!==null?q.value:W;if(d){if(J!==d)return[new Xe(q.key,fe,`${J} stop domain type must match previous stop domain type ${d}`)]}else d=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new Xe(q.key,fe,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&l!=="categorical"){let Ee=`number expected, ${J} found`;return tc(t)&&l===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xe(q.key,fe,Ee)]}return l!=="categorical"||J!=="number"||isFinite(le)&&Math.floor(le)===le?l!=="categorical"&&J==="number"&&y!==void 0&&le<y?[new Xe(q.key,fe,"stop domain values must appear in ascending order")]:(y=le,l==="categorical"&&le in E?[new Xe(q.key,fe,"stop domain values must be unique")]:(E[le]=!0,[])):[new Xe(q.key,fe,`integer expected, found ${le}`)]}}function An(o){const t=(o.expressionContext==="property"?Td:No)(hl(o.value),o.valueSpec);if(t.result==="error")return t.value.map(d=>new Xe(`${o.key}${d.key}`,o.value,d.message));const l=t.value.expression||t.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!l.outputDefined())return[new Xe(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Xu(l))return[new Xe(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Xu(l))return[new Xe(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!vd(l,["zoom","feature-state"]))return[new Xe(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Hu(l))return[new Xe(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function os(o){const t=o.key,l=o.value,d=o.valueSpec,y=[];return Array.isArray(d.values)?d.values.indexOf(ri(l))===-1&&y.push(new Xe(t,l,`expected one of [${d.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(d.values).indexOf(ri(l))===-1&&y.push(new Xe(t,l,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(l)} found`)),y}function Ma(o){return ac(hl(o.value))?An($t({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ju(o)}function Ju(o){const t=o.value,l=o.key;if(zn(t)!=="array")return[new Xe(l,t,`array expected, ${zn(t)} found`)];const d=o.styleSpec;let y,T=[];if(t.length<1)return[new Xe(l,t,"filter array must have at least 1 element")];switch(T=T.concat(os({key:`${l}[0]`,value:t[0],valueSpec:d.filter_operator,style:o.style,styleSpec:o.styleSpec})),ri(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ri(t[1])==="$type"&&T.push(new Xe(l,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&T.push(new Xe(l,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(y=zn(t[1]),y!=="string"&&T.push(new Xe(`${l}[1]`,t[1],`string expected, ${y} found`)));for(let E=2;E<t.length;E++)y=zn(t[E]),ri(t[1])==="$type"?T=T.concat(os({key:`${l}[${E}]`,value:t[E],valueSpec:d.geometry_type,style:o.style,styleSpec:o.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&T.push(new Xe(`${l}[${E}]`,t[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<t.length;E++)T=T.concat(Ju({key:`${l}[${E}]`,value:t[E],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":y=zn(t[1]),t.length!==2?T.push(new Xe(l,t,`filter array for "${t[0]}" operator must have 2 elements`)):y!=="string"&&T.push(new Xe(`${l}[1]`,t[1],`string expected, ${y} found`))}return T}function dl(o,t){const l=o.key,d=o.validateSpec,y=o.style,T=o.styleSpec,E=o.value,A=o.objectKey,I=T[`${t}_${o.layerType}`];if(!I)return[];const L=A.match(/^(.*)-transition$/);if(t==="paint"&&L&&I[L[1]]&&I[L[1]].transition)return d({key:l,value:E,valueSpec:T.transition,style:y,styleSpec:T});const O=o.valueSpec||I[A];if(!O)return[new Xe(l,E,`unknown property "${A}"`)];let B;if(zn(E)==="string"&&tc(O)&&!O.tokens&&(B=/^{([^}]+)}$/.exec(E)))return[new Xe(l,E,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const $=[];return o.layerType==="symbol"&&(A==="text-field"&&y&&!y.glyphs&&$.push(new Xe(l,E,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&Qr(hl(E))&&ri(E.type)==="identity"&&$.push(new Xe(l,E,'"text-font" does not support identity functions'))),$.concat(d({key:o.key,value:E,valueSpec:O,style:y,styleSpec:T,expressionContext:"property",propertyType:t,propertyKey:A}))}function Sd(o){return dl(o,"paint")}function Ad(o){return dl(o,"layout")}function qs(o){let t=[];const l=o.value,d=o.key,y=o.style,T=o.styleSpec;l.type||l.ref||t.push(new Xe(d,l,'either "type" or "ref" is required'));let E=ri(l.type);const A=ri(l.ref);if(l.id){const I=ri(l.id);for(let L=0;L<o.arrayIndex;L++){const O=y.layers[L];ri(O.id)===I&&t.push(new Xe(d,l.id,`duplicate layer id "${l.id}", previously used at line ${O.id.__line__}`))}}if("ref"in l){let I;["type","source","source-layer","filter","layout"].forEach(L=>{L in l&&t.push(new Xe(d,l[L],`"${L}" is prohibited for ref layers`))}),y.layers.forEach(L=>{ri(L.id)===A&&(I=L)}),I?I.ref?t.push(new Xe(d,l.ref,"ref cannot reference another ref layer")):E=ri(I.type):t.push(new Xe(d,l.ref,`ref layer "${A}" not found`))}else if(E!=="background")if(l.source){const I=y.sources&&y.sources[l.source],L=I&&ri(I.type);I?L==="vector"&&E==="raster"?t.push(new Xe(d,l.source,`layer "${l.id}" requires a raster source`)):L!=="raster-dem"&&E==="hillshade"?t.push(new Xe(d,l.source,`layer "${l.id}" requires a raster-dem source`)):L==="raster"&&E!=="raster"?t.push(new Xe(d,l.source,`layer "${l.id}" requires a vector source`)):L!=="vector"||l["source-layer"]?L==="raster-dem"&&E!=="hillshade"?t.push(new Xe(d,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!l.paint||!l.paint["line-gradient"]||L==="geojson"&&I.lineMetrics||t.push(new Xe(d,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Xe(d,l,`layer "${l.id}" must specify a "source-layer"`)):t.push(new Xe(d,l.source,`source "${l.source}" not found`))}else t.push(new Xe(d,l,'missing required property "source"'));return t=t.concat(ha({key:d,value:l,valueSpec:T.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${d}.type`,value:l.type,valueSpec:T.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:l,objectKey:"type"}),filter:Ma,layout:I=>ha({layer:l,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":L=>Ad($t({layerType:E},L))}}),paint:I=>ha({layer:l,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":L=>Sd($t({layerType:E},L))}})}})),t}function ls(o){const t=o.value,l=o.key,d=zn(t);return d!=="string"?[new Xe(l,t,`string expected, ${d} found`)]:[]}const Lf={promoteId:function({key:o,value:t}){if(zn(t)==="string")return ls({key:o,value:t});{const l=[];for(const d in t)l.push(...ls({key:`${o}.${d}`,value:t[d]}));return l}}};function Jc(o){const t=o.value,l=o.key,d=o.styleSpec,y=o.style,T=o.validateSpec;if(!t.type)return[new Xe(l,t,'"type" is required')];const E=ri(t.type);let A;switch(E){case"vector":case"raster":return A=ha({key:l,value:t,valueSpec:d[`source_${E.replace("-","_")}`],style:o.style,styleSpec:d,objectElementValidators:Lf,validateSpec:T}),A;case"raster-dem":return A=function(I){var L;const O=(L=I.sourceName)!==null&&L!==void 0?L:"",B=I.value,$=I.styleSpec,q=$.source_raster_dem,W=I.style;let J=[];const le=zn(B);if(B===void 0)return J;if(le!=="object")return J.push(new Xe("source_raster_dem",B,`object expected, ${le} found`)),J;const fe=ri(B.encoding)==="custom",Ee=["redFactor","greenFactor","blueFactor","baseShift"],ye=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const Y in B)!fe&&Ee.includes(Y)?J.push(new Xe(Y,B[Y],`In "${O}": "${Y}" is only valid when "encoding" is set to "custom". ${ye} encoding found`)):q[Y]?J=J.concat(I.validateSpec({key:Y,value:B[Y],valueSpec:q[Y],validateSpec:I.validateSpec,style:W,styleSpec:$})):J.push(new Xe(Y,B[Y],`unknown property "${Y}"`));return J}({sourceName:l,value:t,style:o.style,styleSpec:d,validateSpec:T}),A;case"geojson":if(A=ha({key:l,value:t,valueSpec:d.source_geojson,style:y,styleSpec:d,validateSpec:T,objectElementValidators:Lf}),t.cluster)for(const I in t.clusterProperties){const[L,O]=t.clusterProperties[I],B=typeof L=="string"?[L,["accumulated"],["get",I]]:L;A.push(...An({key:`${l}.${I}.map`,value:O,expressionContext:"cluster-map"})),A.push(...An({key:`${l}.${I}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return A;case"video":return ha({key:l,value:t,valueSpec:d.source_video,style:y,validateSpec:T,styleSpec:d});case"image":return ha({key:l,value:t,valueSpec:d.source_image,style:y,validateSpec:T,styleSpec:d});case"canvas":return[new Xe(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return os({key:`${l}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Md(o){const t=o.value,l=o.styleSpec,d=l.light,y=o.style;let T=[];const E=zn(t);if(t===void 0)return T;if(E!=="object")return T=T.concat([new Xe("light",t,`object expected, ${E} found`)]),T;for(const A in t){const I=A.match(/^(.*)-transition$/);T=T.concat(I&&d[I[1]]&&d[I[1]].transition?o.validateSpec({key:A,value:t[A],valueSpec:l.transition,validateSpec:o.validateSpec,style:y,styleSpec:l}):d[A]?o.validateSpec({key:A,value:t[A],valueSpec:d[A],validateSpec:o.validateSpec,style:y,styleSpec:l}):[new Xe(A,t[A],`unknown property "${A}"`)])}return T}function fl(o){const t=o.value,l=o.styleSpec,d=l.sky,y=o.style,T=zn(t);if(t===void 0)return[];if(T!=="object")return[new Xe("sky",t,`object expected, ${T} found`)];let E=[];for(const A in t)E=E.concat(d[A]?o.validateSpec({key:A,value:t[A],valueSpec:d[A],style:y,styleSpec:l}):[new Xe(A,t[A],`unknown property "${A}"`)]);return E}function Hs(o){const t=o.value,l=o.styleSpec,d=l.terrain,y=o.style;let T=[];const E=zn(t);if(t===void 0)return T;if(E!=="object")return T=T.concat([new Xe("terrain",t,`object expected, ${E} found`)]),T;for(const A in t)T=T.concat(d[A]?o.validateSpec({key:A,value:t[A],valueSpec:d[A],validateSpec:o.validateSpec,style:y,styleSpec:l}):[new Xe(A,t[A],`unknown property "${A}"`)]);return T}function Ca(o){let t=[];const l=o.value,d=o.key;if(Array.isArray(l)){const y=[],T=[];for(const E in l)l[E].id&&y.includes(l[E].id)&&t.push(new Xe(d,l,`all the sprites' ids must be unique, but ${l[E].id} is duplicated`)),y.push(l[E].id),l[E].url&&T.includes(l[E].url)&&t.push(new Xe(d,l,`all the sprites' URLs must be unique, but ${l[E].url} is duplicated`)),T.push(l[E].url),t=t.concat(ha({key:`${d}[${E}]`,value:l[E],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return t}return ls({key:d,value:l})}const da={"*":()=>[],array:Ku,boolean:function(o){const t=o.value,l=o.key,d=zn(t);return d!=="boolean"?[new Xe(l,t,`boolean expected, ${d} found`)]:[]},number:Mr,color:function(o){const t=o.key,l=o.value,d=zn(l);return d!=="string"?[new Xe(t,l,`color expected, ${d} found`)]:kn.parse(String(l))?[]:[new Xe(t,l,`color expected, "${l}" found`)]},constants:Ys,enum:os,filter:Ma,function:Li,layer:qs,object:ha,source:Jc,light:Md,sky:fl,terrain:Hs,projection:function(o){const t=o.value,l=o.styleSpec,d=l.projection,y=o.style,T=zn(t);if(t===void 0)return[];if(T!=="object")return[new Xe("projection",t,`object expected, ${T} found`)];let E=[];for(const A in t)E=E.concat(d[A]?o.validateSpec({key:A,value:t[A],valueSpec:d[A],style:y,styleSpec:l}):[new Xe(A,t[A],`unknown property "${A}"`)]);return E},projectionDefinition:function(o){const t=o.key;let l=o.value;l=l instanceof String?l.valueOf():l;const d=zn(l);return d!=="array"||function(y){return Array.isArray(y)&&y.length===3&&typeof y[0]=="string"&&typeof y[1]=="string"&&typeof y[2]=="number"}(l)||function(y){return!!["interpolate","step","literal"].includes(y[0])}(l)?["array","string"].includes(d)?[]:[new Xe(t,l,`projection expected, invalid type "${d}" found`)]:[new Xe(t,l,`projection expected, invalid array ${JSON.stringify(l)} found`)]},string:ls,formatted:function(o){return ls(o).length===0?[]:An(o)},resolvedImage:function(o){return ls(o).length===0?[]:An(o)},padding:function(o){const t=o.key,l=o.value;if(zn(l)==="array"){if(l.length<1||l.length>4)return[new Xe(t,l,`padding requires 1 to 4 values; ${l.length} values found`)];const d={type:"number"};let y=[];for(let T=0;T<l.length;T++)y=y.concat(o.validateSpec({key:`${t}[${T}]`,value:l[T],validateSpec:o.validateSpec,valueSpec:d}));return y}return Mr({key:t,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const t=o.key,l=o.value,d=zn(l),y=o.styleSpec;if(d!=="array"||l.length<1||l.length%2!=0)return[new Xe(t,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let E=0;E<l.length;E+=2)T=T.concat(os({key:`${t}[${E}]`,value:l[E],valueSpec:y.layout_symbol["text-anchor"]})),T=T.concat(Ku({key:`${t}[${E+1}]`,value:l[E+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:y}));return T},sprite:Ca};function Cr(o){const t=o.value,l=o.valueSpec,d=o.styleSpec;return o.validateSpec=Cr,l.expression&&Qr(ri(t))?Li(o):l.expression&&cl(hl(t))?An(o):l.type&&da[l.type]?da[l.type](o):ha($t({},o,{valueSpec:l.type?d[l.type]:l}))}function pl(o){const t=o.value,l=o.key,d=ls(o);return d.length||(t.indexOf("{fontstack}")===-1&&d.push(new Xe(l,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&d.push(new Xe(l,t,'"glyphs" url must include a "{range}" token'))),d}function Gr(o,t=X){let l=[];return l=l.concat(Cr({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,validateSpec:Cr,objectElementValidators:{glyphs:pl,"*":()=>[]}})),o.constants&&(l=l.concat(Ys({key:"constants",value:o.constants}))),ml(l)}function Da(o){return function(t){return o({...t,validateSpec:Cr})}}function ml(o){return[].concat(o).sort((t,l)=>t.line-l.line)}function ei(o){return function(...t){return ml(o.apply(this,t))}}Gr.source=ei(Da(Jc)),Gr.sprite=ei(Da(Ca)),Gr.glyphs=ei(Da(pl)),Gr.light=ei(Da(Md)),Gr.sky=ei(Da(fl)),Gr.terrain=ei(Da(Hs)),Gr.layer=ei(Da(qs)),Gr.filter=ei(Da(Ma)),Gr.paintProperty=ei(Da(Sd)),Gr.layoutProperty=ei(Da(Ad));const Xs=Gr,Cd=Xs.light,kg=Xs.sky,Nf=Xs.paintProperty,Ig=Xs.layoutProperty;function Ni(o,t){let l=!1;if(t&&t.length)for(const d of t)o.fire(new ee(new Error(d.message))),l=!0;return l}class cc{constructor(t,l,d){const y=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const E=new Int32Array(this.arrayBuffer);t=E[0],this.d=(l=E[1])+2*(d=E[2]);for(let I=0;I<this.d*this.d;I++){const L=E[3+I],O=E[3+I+1];y.push(L===O?null:E.subarray(L,O))}const A=E[3+y.length+1];this.keys=E.subarray(E[3+y.length],A),this.bboxes=E.subarray(A),this.insert=this._insertReadonly}else{this.d=l+2*d;for(let E=0;E<this.d*this.d;E++)y.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=t,this.padding=d,this.scale=l/t,this.uid=0;const T=d/l*t;this.min=-T,this.max=t+T}insert(t,l,d,y,T){this._forEachCell(l,d,y,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,l,d,y,T,E){this.cells[T].push(E)}query(t,l,d,y,T){const E=this.min,A=this.max;if(t<=E&&l<=E&&A<=d&&A<=y&&!T)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(t,l,d,y,this._queryCell,I,{},T),I}}_queryCell(t,l,d,y,T,E,A,I){const L=this.cells[T];if(L!==null){const O=this.keys,B=this.bboxes;for(let $=0;$<L.length;$++){const q=L[$];if(A[q]===void 0){const W=4*q;(I?I(B[W+0],B[W+1],B[W+2],B[W+3]):t<=B[W+2]&&l<=B[W+3]&&d>=B[W+0]&&y>=B[W+1])?(A[q]=!0,E.push(O[q])):A[q]=!1}}}}_forEachCell(t,l,d,y,T,E,A,I){const L=this._convertToCellCoord(t),O=this._convertToCellCoord(l),B=this._convertToCellCoord(d),$=this._convertToCellCoord(y);for(let q=L;q<=B;q++)for(let W=O;W<=$;W++){const J=this.d*W+q;if((!I||I(this._convertFromCellCoord(q),this._convertFromCellCoord(W),this._convertFromCellCoord(q+1),this._convertFromCellCoord(W+1)))&&T.call(this,t,l,d,y,J,E,A,I))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,l=3+this.cells.length+1+1;let d=0;for(let E=0;E<this.cells.length;E++)d+=this.cells[E].length;const y=new Int32Array(l+d+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;let T=l;for(let E=0;E<t.length;E++){const A=t[E];y[3+E]=T,y.set(A,T),T+=A.length}return y[3+t.length]=T,y.set(this.keys,T),T+=this.keys.length,y[3+t.length+1]=T,y.set(this.bboxes,T),T+=this.bboxes.length,y.buffer}static serialize(t,l){const d=t.toArrayBuffer();return l&&l.push(d),{buffer:d}}static deserialize(t){return new cc(t.buffer)}}const zr={};function Lt(o,t,l={}){if(zr[o])throw new Error(`${o} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:o,writeable:!1}),zr[o]={klass:t,omit:l.omit||[],shallow:l.shallow||[]}}Lt("Object",Object),Lt("TransferableGridIndex",cc),Lt("Color",kn),Lt("Error",Error),Lt("AJAXError",Gi),Lt("ResolvedImage",Vr),Lt("StylePropertyFunction",Fa),Lt("StyleExpression",rc,{omit:["_evaluator"]}),Lt("ZoomDependentExpression",Kr),Lt("ZoomConstantExpression",zf),Lt("CompoundExpression",Ir,{omit:["_evaluate"]});for(const o in Ba)Ba[o]._classRegistryKey||Lt(`Expression_${o}`,Ba[o]);function Dd(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function cs(o){return o.$name||o.constructor._classRegistryKey}function uc(o){return!function(t){if(t===null||typeof t!="object")return!1;const l=cs(t);return!(!l||l==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Dd(o)||Gn(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function hc(o,t){if(uc(o))return(Dd(o)||Gn(o))&&t&&t.push(o),ArrayBuffer.isView(o)&&t&&t.push(o.buffer),o instanceof ImageData&&t&&t.push(o.data.buffer),o;if(Array.isArray(o)){const T=[];for(const E of o)T.push(hc(E,t));return T}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const l=cs(o);if(!l)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!zr[l])throw new Error(`${l} is not registered.`);const{klass:d}=zr[l],y=d.serialize?d.serialize(o,t):{};if(d.serialize){if(t&&y===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in o){if(!o.hasOwnProperty(T)||zr[l].omit.indexOf(T)>=0)continue;const E=o[T];y[T]=zr[l].shallow.indexOf(T)>=0?E:hc(E,t)}o instanceof Error&&(y.message=o.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(y.$name=l),y}function Oo(o){if(uc(o))return o;if(Array.isArray(o))return o.map(Oo);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const t=cs(o)||"Object";if(!zr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:l}=zr[t];if(!l)throw new Error(`can't deserialize unregistered class ${t}`);if(l.deserialize)return l.deserialize(o);const d=Object.create(l.prototype);for(const y of Object.keys(o)){if(y==="$name")continue;const T=o[y];d[y]=zr[t].shallow.indexOf(y)>=0?T:Oo(T)}return d}class Pf{constructor(){this.first=!0}update(t,l){const d=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=l),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=d,!0))}}const bn={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Ws(o){for(const t of o)if(eu(t.charCodeAt(0)))return!0;return!1}function kd(o){for(const t of o)if(!eh(t.charCodeAt(0)))return!1;return!0}function gl(o){const t=o.map(l=>{try{return new RegExp(`\\p{sc=${l}}`,"u").source}catch{return null}}).filter(l=>l);return new RegExp(t.join("|"),"u")}const Of=gl(["Arab","Dupl","Mong","Ougr","Syrc"]);function eh(o){return!Of.test(String.fromCodePoint(o))}const Id=gl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function eu(o){return!(o!==746&&o!==747&&(o<4352||!(bn["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||bn["CJK Compatibility"](o)||bn["CJK Strokes"](o)||!(!bn["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||bn["Enclosed CJK Letters and Months"](o)||bn["Ideographic Description Characters"](o)||bn.Kanbun(o)||bn.Katakana(o)&&o!==12540||!(!bn["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!bn["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||bn["Vertical Forms"](o)||bn["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||Id.test(String.fromCodePoint(o)))))}function th(o){return!(eu(o)||function(t){return!!(bn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||bn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||bn["Letterlike Symbols"](t)||bn["Number Forms"](t)||bn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||bn["Control Pictures"](t)&&t!==9251||bn["Optical Character Recognition"](t)||bn["Enclosed Alphanumerics"](t)||bn["Geometric Shapes"](t)||bn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||bn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||bn["CJK Symbols and Punctuation"](t)||bn.Katakana(t)||bn["Private Use Area"](t)||bn["CJK Compatibility Forms"](t)||bn["Small Form Variants"](t)||bn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(o))}const jf=gl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function tu(o){return jf.test(String.fromCodePoint(o))}function tm(o,t){return!(!t&&tu(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||bn.Khmer(o))}function nh(o){for(const t of o)if(tu(t.charCodeAt(0)))return!0;return!1}const Qs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(Qs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const l=o.pluginURL,d=new Promise(T=>{this.loadScriptResolve=T});t(l);const y=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([d,y]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:l};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${l}`)})}};class ci{constructor(t,l){this.zoom=t,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pf,this.transition={})}isSupportedScript(t){return function(l,d){for(const y of l)if(!tm(y.charCodeAt(0),d))return!1;return!0}(t,Qs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,l=t-Math.floor(t),d=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*l}}}class Va{constructor(t,l){this.property=t,this.value=l,this.expression=function(d,y){if(Qr(d))return new Fa(d,y);if(cl(d)){const T=Td(d,y);if(T.result==="error")throw new Error(T.value.map(E=>`${E.key}: ${E.message}`).join(", "));return T.value}{let T=d;return y.type==="color"&&typeof d=="string"?T=kn.parse(d):y.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?T=Sr.parse(d):y.type==="projectionDefinition"&&typeof d=="string"&&(T=er.parse(d)):T=mr.parse(d),{kind:"constant",evaluate:()=>T}}}(l===void 0?t.specification.default:l,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,l,d){return this.property.possiblyEvaluate(this,t,l,d)}}class nu{constructor(t){this.property=t,this.value=new Va(t,void 0)}transitioned(t,l){return new jo(this.property,this.value,l,Yt({},t.transition,this.transition),t.now)}untransitioned(){return new jo(this.property,this.value,null,{},0)}}class dc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ni(this._values[t].value.value)}setValue(t,l){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new nu(this._values[t].property)),this._values[t].value=new Va(this._values[t].property,l===null?void 0:ni(l))}getTransition(t){return ni(this._values[t].transition)}setTransition(t,l){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new nu(this._values[t].property)),this._values[t].transition=ni(l)||void 0}serialize(){const t={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(t[l]=d);const y=this.getTransition(l);y!==void 0&&(t[`${l}-transition`]=y)}return t}transitioned(t,l){const d=new us(this._properties);for(const y of Object.keys(this._values))d._values[y]=this._values[y].transitioned(t,l._values[y]);return d}untransitioned(){const t=new us(this._properties);for(const l of Object.keys(this._values))t._values[l]=this._values[l].untransitioned();return t}}class jo{constructor(t,l,d,y,T){this.property=t,this.value=l,this.begin=T+y.delay||0,this.end=this.begin+y.duration||0,t.specification.transition&&(y.delay||y.duration)&&(this.prior=d)}possiblyEvaluate(t,l,d){const y=t.now||0,T=this.value.possiblyEvaluate(t,l,d),E=this.prior;if(E){if(y>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(y<this.begin)return E.possiblyEvaluate(t,l,d);{const A=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(t,l,d),T,Se(A))}}return T}}class us{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,l,d){const y=new fc(this._properties);for(const T of Object.keys(this._values))y._values[T]=this._values[T].possiblyEvaluate(t,l,d);return y}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ih{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ni(this._values[t].value)}setValue(t,l){this._values[t]=new Va(this._values[t].property,l===null?void 0:ni(l))}serialize(){const t={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(t[l]=d)}return t}possiblyEvaluate(t,l,d){const y=new fc(this._properties);for(const T of Object.keys(this._values))y._values[T]=this._values[T].possiblyEvaluate(t,l,d);return y}}class Za{constructor(t,l,d){this.property=t,this.value=l,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,l,d,y){return this.property.evaluate(this.value,this.parameters,t,l,d,y)}}class fc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Zt{constructor(t){this.specification=t}possiblyEvaluate(t,l){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(l)}interpolate(t,l,d){const y=Sa[this.specification.type];return y?y(t,l,d):t}}class Ht{constructor(t,l){this.specification=t,this.overrides=l}possiblyEvaluate(t,l,d,y){return new Za(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(l,null,{},d,y)}:t.expression,l)}interpolate(t,l,d){if(t.value.kind!=="constant"||l.value.kind!=="constant")return t;if(t.value.value===void 0||l.value.value===void 0)return new Za(this,{kind:"constant",value:void 0},t.parameters);const y=Sa[this.specification.type];if(y){const T=y(t.value.value,l.value.value,d);return new Za(this,{kind:"constant",value:T},t.parameters)}return t}evaluate(t,l,d,y,T,E){return t.kind==="constant"?t.value:t.evaluate(l,d,y,T,E)}}class rh extends Ht{possiblyEvaluate(t,l,d,y){if(t.value===void 0)return new Za(this,{kind:"constant",value:void 0},l);if(t.expression.kind==="constant"){const T=t.expression.evaluate(l,null,{},d,y),E=t.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,A=this._calculate(E,E,E,l);return new Za(this,{kind:"constant",value:A},l)}if(t.expression.kind==="camera"){const T=this._calculate(t.expression.evaluate({zoom:l.zoom-1}),t.expression.evaluate({zoom:l.zoom}),t.expression.evaluate({zoom:l.zoom+1}),l);return new Za(this,{kind:"constant",value:T},l)}return new Za(this,t.expression,l)}evaluate(t,l,d,y,T,E){if(t.kind==="source"){const A=t.evaluate(l,d,y,T,E);return this._calculate(A,A,A,l)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(l.zoom)-1},d,y),t.evaluate({zoom:Math.floor(l.zoom)},d,y),t.evaluate({zoom:Math.floor(l.zoom)+1},d,y),l):t.value}_calculate(t,l,d,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:t,to:l}:{from:d,to:l}}interpolate(t){return t}}class Rd{constructor(t){this.specification=t}possiblyEvaluate(t,l,d,y){if(t.value!==void 0){if(t.expression.kind==="constant"){const T=t.expression.evaluate(l,null,{},d,y);return this._calculate(T,T,T,l)}return this._calculate(t.expression.evaluate(new ci(Math.floor(l.zoom-1),l)),t.expression.evaluate(new ci(Math.floor(l.zoom),l)),t.expression.evaluate(new ci(Math.floor(l.zoom+1),l)),l)}}_calculate(t,l,d,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:t,to:l}:{from:d,to:l}}interpolate(t){return t}}class yl{constructor(t){this.specification=t}possiblyEvaluate(t,l,d,y){return!!t.expression.evaluate(l,null,{},d,y)}interpolate(){return!1}}class Lr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in t){const d=t[l];d.specification.overridable&&this.overridableProperties.push(l);const y=this.defaultPropertyValues[l]=new Va(d,void 0),T=this.defaultTransitionablePropertyValues[l]=new nu(d);this.defaultTransitioningPropertyValues[l]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=y.possiblyEvaluate({})}}}Lt("DataDrivenProperty",Ht),Lt("DataConstantProperty",Zt),Lt("CrossFadedDataDrivenProperty",rh),Lt("CrossFadedProperty",Rd),Lt("ColorRampProperty",yl);const Bf="-transition";class Nr extends re{constructor(t,l){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),l.layout&&(this._unevaluatedLayout=new ih(l.layout)),l.paint)){this._transitionablePaint=new dc(l.paint);for(const d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(const d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fc(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,l,d={}){l!=null&&this._validate(Ig,`layers.${this.id}.layout.${t}`,t,l,d)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,l):this.visibility=l)}getPaintProperty(t){return t.endsWith(Bf)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,l,d={}){if(l!=null&&this._validate(Nf,`layers.${this.id}.paint.${t}`,t,l,d))return!1;if(t.endsWith(Bf))return this._transitionablePaint.setTransition(t.slice(0,-11),l||void 0),!1;{const y=this._transitionablePaint._values[t],T=y.property.specification["property-type"]==="cross-faded-data-driven",E=y.value.isDataDriven(),A=y.value;this._transitionablePaint.setValue(t,l),this._handleSpecialPaintPropertyUpdate(t);const I=this._transitionablePaint._values[t].value;return I.isDataDriven()||E||T||this._handleOverridablePaintPropertyUpdate(t,A,I)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,l,d){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,l){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,l)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Tn(t,(l,d)=>!(l===void 0||d==="layout"&&!Object.keys(l).length||d==="paint"&&!Object.keys(l).length))}_validate(t,l,d,y,T={}){return(!T||T.validate!==!1)&&Ni(this,t.call(Xs,{key:l,layerType:this.type,objectKey:d,value:y,styleSpec:X,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const l=this.paint.get(t);if(l instanceof Za&&tc(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const Ff={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ga{constructor(t,l){this._structArray=t,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Kt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,l){return t._trim(),l&&(t.isTransferred=!0,l.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const l=Object.create(this.prototype);return l.arrayBuffer=t.arrayBuffer,l.length=t.length,l.capacity=t.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function on(o,t=1){let l=0,d=0;return{members:o.map(y=>{const T=Ff[y.type].BYTES_PER_ELEMENT,E=l=tr(l,Math.max(t,T)),A=y.components||1;return d=Math.max(d,T),l+=T*A,{name:y.name,type:y.type,components:A,offset:E}}),size:tr(l,Math.max(d,t)),alignment:t}}function tr(o,t){return Math.ceil(o/t)*t}class _l extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,l)}emplace(t,l,d){const y=2*t;return this.int16[y+0]=l,this.int16[y+1]=d,t}}_l.prototype.bytesPerElement=4,Lt("StructArrayLayout2i4",_l);class ea extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,l,d)}emplace(t,l,d,y){const T=3*t;return this.int16[T+0]=l,this.int16[T+1]=d,this.int16[T+2]=y,t}}ea.prototype.bytesPerElement=6,Lt("StructArrayLayout3i6",ea);class Ks extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,l,d,y)}emplace(t,l,d,y,T){const E=4*t;return this.int16[E+0]=l,this.int16[E+1]=d,this.int16[E+2]=y,this.int16[E+3]=T,t}}Ks.prototype.bytesPerElement=8,Lt("StructArrayLayout4i8",Ks);class vl extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E){const A=this.length;return this.resize(A+1),this.emplace(A,t,l,d,y,T,E)}emplace(t,l,d,y,T,E,A){const I=6*t;return this.int16[I+0]=l,this.int16[I+1]=d,this.int16[I+2]=y,this.int16[I+3]=T,this.int16[I+4]=E,this.int16[I+5]=A,t}}vl.prototype.bytesPerElement=12,Lt("StructArrayLayout2i4i12",vl);class xl extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E){const A=this.length;return this.resize(A+1),this.emplace(A,t,l,d,y,T,E)}emplace(t,l,d,y,T,E,A){const I=4*t,L=8*t;return this.int16[I+0]=l,this.int16[I+1]=d,this.uint8[L+4]=y,this.uint8[L+5]=T,this.uint8[L+6]=E,this.uint8[L+7]=A,t}}xl.prototype.bytesPerElement=8,Lt("StructArrayLayout2i4ub8",xl);class $a extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,l)}emplace(t,l,d){const y=2*t;return this.float32[y+0]=l,this.float32[y+1]=d,t}}$a.prototype.bytesPerElement=8,Lt("StructArrayLayout2f8",$a);class Uf extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E,A,I,L,O){const B=this.length;return this.resize(B+1),this.emplace(B,t,l,d,y,T,E,A,I,L,O)}emplace(t,l,d,y,T,E,A,I,L,O,B){const $=10*t;return this.uint16[$+0]=l,this.uint16[$+1]=d,this.uint16[$+2]=y,this.uint16[$+3]=T,this.uint16[$+4]=E,this.uint16[$+5]=A,this.uint16[$+6]=I,this.uint16[$+7]=L,this.uint16[$+8]=O,this.uint16[$+9]=B,t}}Uf.prototype.bytesPerElement=20,Lt("StructArrayLayout10ui20",Uf);class vi extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E,A,I,L,O,B,$){const q=this.length;return this.resize(q+1),this.emplace(q,t,l,d,y,T,E,A,I,L,O,B,$)}emplace(t,l,d,y,T,E,A,I,L,O,B,$,q){const W=12*t;return this.int16[W+0]=l,this.int16[W+1]=d,this.int16[W+2]=y,this.int16[W+3]=T,this.uint16[W+4]=E,this.uint16[W+5]=A,this.uint16[W+6]=I,this.uint16[W+7]=L,this.int16[W+8]=O,this.int16[W+9]=B,this.int16[W+10]=$,this.int16[W+11]=q,t}}vi.prototype.bytesPerElement=24,Lt("StructArrayLayout4i4ui4i24",vi);class Bo extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,l,d)}emplace(t,l,d,y){const T=3*t;return this.float32[T+0]=l,this.float32[T+1]=d,this.float32[T+2]=y,t}}Bo.prototype.bytesPerElement=12,Lt("StructArrayLayout3f12",Bo);class ah extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const l=this.length;return this.resize(l+1),this.emplace(l,t)}emplace(t,l){return this.uint32[1*t+0]=l,t}}ah.prototype.bytesPerElement=4,Lt("StructArrayLayout1ul4",ah);class sh extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E,A,I,L){const O=this.length;return this.resize(O+1),this.emplace(O,t,l,d,y,T,E,A,I,L)}emplace(t,l,d,y,T,E,A,I,L,O){const B=10*t,$=5*t;return this.int16[B+0]=l,this.int16[B+1]=d,this.int16[B+2]=y,this.int16[B+3]=T,this.int16[B+4]=E,this.int16[B+5]=A,this.uint32[$+3]=I,this.uint16[B+8]=L,this.uint16[B+9]=O,t}}sh.prototype.bytesPerElement=20,Lt("StructArrayLayout6i1ul2ui20",sh);class bl extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E){const A=this.length;return this.resize(A+1),this.emplace(A,t,l,d,y,T,E)}emplace(t,l,d,y,T,E,A){const I=6*t;return this.int16[I+0]=l,this.int16[I+1]=d,this.int16[I+2]=y,this.int16[I+3]=T,this.int16[I+4]=E,this.int16[I+5]=A,t}}bl.prototype.bytesPerElement=12,Lt("StructArrayLayout2i2i2i12",bl);class Vf extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T){const E=this.length;return this.resize(E+1),this.emplace(E,t,l,d,y,T)}emplace(t,l,d,y,T,E){const A=4*t,I=8*t;return this.float32[A+0]=l,this.float32[A+1]=d,this.float32[A+2]=y,this.int16[I+6]=T,this.int16[I+7]=E,t}}Vf.prototype.bytesPerElement=16,Lt("StructArrayLayout2f1f2i16",Vf);class oh extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E){const A=this.length;return this.resize(A+1),this.emplace(A,t,l,d,y,T,E)}emplace(t,l,d,y,T,E,A){const I=16*t,L=4*t,O=8*t;return this.uint8[I+0]=l,this.uint8[I+1]=d,this.float32[L+1]=y,this.float32[L+2]=T,this.int16[O+6]=E,this.int16[O+7]=A,t}}oh.prototype.bytesPerElement=16,Lt("StructArrayLayout2ub2f2i16",oh);class pc extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,l,d)}emplace(t,l,d,y){const T=3*t;return this.uint16[T+0]=l,this.uint16[T+1]=d,this.uint16[T+2]=y,t}}pc.prototype.bytesPerElement=6,Lt("StructArrayLayout3ui6",pc);class lh extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,t,l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe)}emplace(t,l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe,Ee){const ye=24*t,Y=12*t,oe=48*t;return this.int16[ye+0]=l,this.int16[ye+1]=d,this.uint16[ye+2]=y,this.uint16[ye+3]=T,this.uint32[Y+2]=E,this.uint32[Y+3]=A,this.uint32[Y+4]=I,this.uint16[ye+10]=L,this.uint16[ye+11]=O,this.uint16[ye+12]=B,this.float32[Y+7]=$,this.float32[Y+8]=q,this.uint8[oe+36]=W,this.uint8[oe+37]=J,this.uint8[oe+38]=le,this.uint32[Y+10]=fe,this.int16[ye+22]=Ee,t}}lh.prototype.bytesPerElement=48,Lt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",lh);class x extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe,Ee,ye,Y,oe,ve,Ve,pt,qe,tt,wt,ft){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,t,l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe,Ee,ye,Y,oe,ve,Ve,pt,qe,tt,wt,ft)}emplace(t,l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe,Ee,ye,Y,oe,ve,Ve,pt,qe,tt,wt,ft,Tt){const ot=32*t,Pt=16*t;return this.int16[ot+0]=l,this.int16[ot+1]=d,this.int16[ot+2]=y,this.int16[ot+3]=T,this.int16[ot+4]=E,this.int16[ot+5]=A,this.int16[ot+6]=I,this.int16[ot+7]=L,this.uint16[ot+8]=O,this.uint16[ot+9]=B,this.uint16[ot+10]=$,this.uint16[ot+11]=q,this.uint16[ot+12]=W,this.uint16[ot+13]=J,this.uint16[ot+14]=le,this.uint16[ot+15]=fe,this.uint16[ot+16]=Ee,this.uint16[ot+17]=ye,this.uint16[ot+18]=Y,this.uint16[ot+19]=oe,this.uint16[ot+20]=ve,this.uint16[ot+21]=Ve,this.uint16[ot+22]=pt,this.uint32[Pt+12]=qe,this.float32[Pt+13]=tt,this.float32[Pt+14]=wt,this.uint16[ot+30]=ft,this.uint16[ot+31]=Tt,t}}x.prototype.bytesPerElement=64,Lt("StructArrayLayout8i15ui1ul2f2ui64",x);class e extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const l=this.length;return this.resize(l+1),this.emplace(l,t)}emplace(t,l){return this.float32[1*t+0]=l,t}}e.prototype.bytesPerElement=4,Lt("StructArrayLayout1f4",e);class s extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,l,d)}emplace(t,l,d,y){const T=3*t;return this.uint16[6*t+0]=l,this.float32[T+1]=d,this.float32[T+2]=y,t}}s.prototype.bytesPerElement=12,Lt("StructArrayLayout1ui2f12",s);class f extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,l,d)}emplace(t,l,d,y){const T=4*t;return this.uint32[2*t+0]=l,this.uint16[T+2]=d,this.uint16[T+3]=y,t}}f.prototype.bytesPerElement=8,Lt("StructArrayLayout1ul2ui8",f);class g extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,l)}emplace(t,l,d){const y=2*t;return this.uint16[y+0]=l,this.uint16[y+1]=d,t}}g.prototype.bytesPerElement=4,Lt("StructArrayLayout2ui4",g);class w extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const l=this.length;return this.resize(l+1),this.emplace(l,t)}emplace(t,l){return this.uint16[1*t+0]=l,t}}w.prototype.bytesPerElement=2,Lt("StructArrayLayout1ui2",w);class S extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,d,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,l,d,y)}emplace(t,l,d,y,T){const E=4*t;return this.float32[E+0]=l,this.float32[E+1]=d,this.float32[E+2]=y,this.float32[E+3]=T,t}}S.prototype.bytesPerElement=16,Lt("StructArrayLayout4f16",S);class D extends Ga{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ie(this.anchorPointX,this.anchorPointY)}}D.prototype.size=20;class R extends sh{get(t){return new D(this,t)}}Lt("CollisionBoxArray",R);class N extends Ga{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}N.prototype.size=48;class F extends lh{get(t){return new N(this,t)}}Lt("PlacedSymbolArray",F);class G extends Ga{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}G.prototype.size=64;class Z extends x{get(t){return new G(this,t)}}Lt("SymbolInstanceArray",Z);class K extends e{getoffsetX(t){return this.float32[1*t+0]}}Lt("GlyphOffsetArray",K);class te extends ea{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Lt("SymbolLineVertexArray",te);class he extends Ga{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}he.prototype.size=12;class ue extends s{get(t){return new he(this,t)}}Lt("TextAnchorOffsetArray",ue);class de extends Ga{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}de.prototype.size=8;class ge extends f{get(t){return new de(this,t)}}Lt("FeatureIndexArray",ge);class xe extends _l{}class be extends _l{}class Te extends _l{}class De extends vl{}class Me extends xl{}class Ge extends $a{}class Ue extends Uf{}class at extends vi{}class st extends Bo{}class it extends ah{}class At extends bl{}class Et extends oh{}class ut extends pc{}class Ft extends g{}const cn=on([{name:"a_pos",components:2,type:"Int16"}],4),{members:In}=cn;class pn{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,l,d,y){const T=this.segments[this.segments.length-1];return t>pn.MAX_VERTEX_ARRAY_LENGTH&&Mi(`Max vertices per segment is ${pn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${pn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+t>pn.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==y?this.createNewSegment(l,d,y):T}createNewSegment(t,l,d){const y={vertexOffset:t.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(y.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(y),y}getOrCreateLatestSegment(t,l,d){return this.prepareSegment(0,t,l,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const l in t.vaos)t.vaos[l].destroy()}static simpleSegment(t,l,d,y){return new pn([{vertexOffset:t,primitiveOffset:l,vertexLength:d,primitiveLength:y,vaos:{},sortKey:0}])}}function Xn(o,t){return 256*(o=St(Math.floor(o),0,255))+St(Math.floor(t),0,255)}pn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Lt("SegmentVector",pn);const ai=on([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ui,Yn,Wn,Fi={exports:{}},lr={exports:{}},gr={exports:{}},$r=function(){if(Wn)return Fi.exports;Wn=1;var o=(ui||(ui=1,lr.exports=function(l,d){var y,T,E,A,I,L,O,B;for(T=l.length-(y=3&l.length),E=d,I=3432918353,L=461845907,B=0;B<T;)O=255&l.charCodeAt(B)|(255&l.charCodeAt(++B))<<8|(255&l.charCodeAt(++B))<<16|(255&l.charCodeAt(++B))<<24,++B,E=27492+(65535&(A=5*(65535&(E=(E^=O=(65535&(O=(O=(65535&O)*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*L+(((O>>>16)*L&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(O=0,y){case 3:O^=(255&l.charCodeAt(B+2))<<16;case 2:O^=(255&l.charCodeAt(B+1))<<8;case 1:E^=O=(65535&(O=(O=(65535&(O^=255&l.charCodeAt(B)))*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*L+(((O>>>16)*L&65535)<<16)&4294967295}return E^=l.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0}),lr.exports),t=(Yn||(Yn=1,gr.exports=function(l,d){for(var y,T=l.length,E=d^T,A=0;T>=4;)y=1540483477*(65535&(y=255&l.charCodeAt(A)|(255&l.charCodeAt(++A))<<8|(255&l.charCodeAt(++A))<<16|(255&l.charCodeAt(++A))<<24))+((1540483477*(y>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),T-=4,++A;switch(T){case 3:E^=(255&l.charCodeAt(A+2))<<16;case 2:E^=(255&l.charCodeAt(A+1))<<8;case 1:E=1540483477*(65535&(E^=255&l.charCodeAt(A)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0}),gr.exports);return Fi.exports=o,Fi.exports.murmur3=o,Fi.exports.murmur2=t,Fi.exports}(),Js=C($r);class hs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,l,d,y){this.ids.push(wl(t)),this.positions.push(l,d,y)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=wl(t);let d=0,y=this.ids.length-1;for(;d<y;){const E=d+y>>1;this.ids[E]>=l?y=E:d=E+1}const T=[];for(;this.ids[d]===l;)T.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return T}static serialize(t,l){const d=new Float64Array(t.ids),y=new Uint32Array(t.positions);return eo(d,y,0,d.length-1),l&&l.push(d.buffer,y.buffer),{ids:d,positions:y}}static deserialize(t){const l=new hs;return l.ids=t.ids,l.positions=t.positions,l.indexed=!0,l}}function wl(o){const t=+o;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Js(String(o))}function eo(o,t,l,d){for(;l<d;){const y=o[l+d>>1];let T=l-1,E=d+1;for(;;){do T++;while(o[T]<y);do E--;while(o[E]>y);if(T>=E)break;Tl(o,T,E),Tl(t,3*T,3*E),Tl(t,3*T+1,3*E+1),Tl(t,3*T+2,3*E+2)}E-l<d-E?(eo(o,t,l,E),l=E+1):(eo(o,t,E+1,d),d=E)}}function Tl(o,t,l){const d=o[t];o[t]=o[l],o[l]=d}Lt("FeaturePositionMap",hs);class ds{constructor(t,l){this.gl=t.gl,this.location=l}}class fs extends ds{constructor(t,l){super(t,l),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class fa extends ds{constructor(t,l){super(t,l),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class to extends ds{constructor(t,l){super(t,l),this.current=kn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const mc=new Float32Array(16);function gc(o){return[Xn(255*o.r,255*o.g),Xn(255*o.b,255*o.a)]}class Pi{constructor(t,l,d){this.value=t,this.uniformNames=l.map(y=>`u_${y}`),this.type=d}setUniform(t,l,d){t.set(d.constantOr(this.value))}getBinding(t,l,d){return this.type==="color"?new to(t,l):new fs(t,l)}}class hi{constructor(t,l){this.uniformNames=l.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=t.tlbr}setUniform(t,l,d,y){const T=y==="u_pattern_to"?this.patternTo:y==="u_pattern_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&t.set(T)}getBinding(t,l,d){return d.substr(0,9)==="u_pattern"?new fa(t,l):new fs(t,l)}}class qi{constructor(t,l,d,y){this.expression=t,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(T=>({name:`a_${T}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,l,d,y,T){const E=this.paintVertexArray.length,A=this.expression.evaluate(new ci(0),l,{},y,[],T);this.paintVertexArray.resize(t),this._setPaintValue(E,t,A)}updatePaintArray(t,l,d,y){const T=this.expression.evaluate({zoom:0},d,y);this._setPaintValue(t,l,T)}_setPaintValue(t,l,d){if(this.type==="color"){const y=gc(d);for(let T=t;T<l;T++)this.paintVertexArray.emplace(T,y[0],y[1])}else{for(let y=t;y<l;y++)this.paintVertexArray.emplace(y,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qn{constructor(t,l,d,y,T,E){this.expression=t,this.uniformNames=l.map(A=>`u_${A}_t`),this.type=d,this.useIntegerZoom=y,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=l.map(A=>({name:`a_${A}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(t,l,d,y,T){const E=this.expression.evaluate(new ci(this.zoom),l,{},y,[],T),A=this.expression.evaluate(new ci(this.zoom+1),l,{},y,[],T),I=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(I,t,E,A)}updatePaintArray(t,l,d,y){const T=this.expression.evaluate({zoom:this.zoom},d,y),E=this.expression.evaluate({zoom:this.zoom+1},d,y);this._setPaintValue(t,l,T,E)}_setPaintValue(t,l,d,y){if(this.type==="color"){const T=gc(d),E=gc(y);for(let A=t;A<l;A++)this.paintVertexArray.emplace(A,T[0],T[1],E[0],E[1])}else{for(let T=t;T<l;T++)this.paintVertexArray.emplace(T,d,y);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(y))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,l){const d=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,y=St(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);t.set(y)}getBinding(t,l,d){return new fs(t,l)}}class Fo{constructor(t,l,d,y,T,E){this.expression=t,this.type=l,this.useIntegerZoom=d,this.zoom=y,this.layerId=E,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(t,l,d){const y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(y,t,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(t,l,d,y,T){this._setPaintValues(t,l,d.patterns&&d.patterns[this.layerId],T)}_setPaintValues(t,l,d,y){if(!y||!d)return;const{min:T,mid:E,max:A}=d,I=y[T],L=y[E],O=y[A];if(I&&L&&O)for(let B=t;B<l;B++)this.zoomInPaintVertexArray.emplace(B,L.tl[0],L.tl[1],L.br[0],L.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],L.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,L.tl[0],L.tl[1],L.br[0],L.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],L.pixelRatio,O.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,ai.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,ai.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zf{constructor(t,l,d){this.binders={},this._buffers=[];const y=[];for(const T in t.paint._values){if(!d(T))continue;const E=t.paint.get(T);if(!(E instanceof Za&&tc(E.property.specification)))continue;const A=nm(T,t.type),I=E.value,L=E.property.specification.type,O=E.property.useIntegerZoom,B=E.property.specification["property-type"],$=B==="cross-faded"||B==="cross-faded-data-driven";if(I.kind==="constant")this.binders[T]=$?new hi(I.value,A):new Pi(I.value,A,L),y.push(`/u_${T}`);else if(I.kind==="source"||$){const q=Gf(T,L,"source");this.binders[T]=$?new Fo(I,L,O,l,q,t.id):new qi(I,A,L,q),y.push(`/a_${T}`)}else{const q=Gf(T,L,"composite");this.binders[T]=new qn(I,A,L,O,l,q),y.push(`/z_${T}`)}}this.cacheKey=y.sort().join("")}getMaxValue(t){const l=this.binders[t];return l instanceof qi||l instanceof qn?l.maxValue:0}populatePaintArrays(t,l,d,y,T){for(const E in this.binders){const A=this.binders[E];(A instanceof qi||A instanceof qn||A instanceof Fo)&&A.populatePaintArray(t,l,d,y,T)}}setConstantPatternPositions(t,l){for(const d in this.binders){const y=this.binders[d];y instanceof hi&&y.setConstantPatternPositions(t,l)}}updatePaintArrays(t,l,d,y,T){let E=!1;for(const A in t){const I=l.getPositions(A);for(const L of I){const O=d.feature(L.index);for(const B in this.binders){const $=this.binders[B];if(($ instanceof qi||$ instanceof qn||$ instanceof Fo)&&$.expression.isStateDependent===!0){const q=y.paint.get(B);$.expression=q.value,$.updatePaintArray(L.start,L.end,O,t[A],T),E=!0}}}}return E}defines(){const t=[];for(const l in this.binders){const d=this.binders[l];(d instanceof Pi||d instanceof hi)&&t.push(...d.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return t}getBinderAttributes(){const t=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof qi||d instanceof qn)for(let y=0;y<d.paintVertexAttributes.length;y++)t.push(d.paintVertexAttributes[y].name);else if(d instanceof Fo)for(let y=0;y<ai.members.length;y++)t.push(ai.members[y].name)}return t}getBinderUniforms(){const t=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Pi||d instanceof hi||d instanceof qn)for(const y of d.uniformNames)t.push(y)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,l){const d=[];for(const y in this.binders){const T=this.binders[y];if(T instanceof Pi||T instanceof hi||T instanceof qn){for(const E of T.uniformNames)if(l[E]){const A=T.getBinding(t,l[E],E);d.push({name:E,property:y,binding:A})}}}return d}setUniforms(t,l,d,y){for(const{name:T,property:E,binding:A}of l)this.binders[E].setUniform(A,y,d.get(E),T)}updatePaintBuffers(t){this._buffers=[];for(const l in this.binders){const d=this.binders[l];if(t&&d instanceof Fo){const y=t.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(d instanceof qi||d instanceof qn)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(t){for(const l in this.binders){const d=this.binders[l];(d instanceof qi||d instanceof qn||d instanceof Fo)&&d.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const l=this.binders[t];(l instanceof qi||l instanceof qn||l instanceof Fo)&&l.destroy()}}}class no{constructor(t,l,d=()=>!0){this.programConfigurations={};for(const y of t)this.programConfigurations[y.id]=new Zf(y,l,d);this.needsUpload=!1,this._featureMap=new hs,this._bufferOffset=0}populatePaintArrays(t,l,d,y,T,E){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(t,l,y,T,E);l.id!==void 0&&this._featureMap.add(l.id,d,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,l,d,y){for(const T of d)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(t,this._featureMap,l,T,y)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function nm(o,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}function Gf(o,t,l){const d={color:{source:$a,composite:S},number:{source:e,composite:$a}},y=function(T){return{"line-pattern":{source:Ue,composite:Ue},"fill-pattern":{source:Ue,composite:Ue},"fill-extrusion-pattern":{source:Ue,composite:Ue}}[T]}(o);return y&&y[l]||d[t][l]}Lt("ConstantBinder",Pi),Lt("CrossFadedConstantBinder",hi),Lt("SourceExpressionBinder",qi),Lt("CrossFadedCompositeBinder",Fo),Lt("CompositeExpressionBinder",qn),Lt("ProgramConfiguration",Zf,{omit:["_buffers"]}),Lt("ProgramConfigurationSet",no);const $f=Math.pow(2,14)-1,ka=-$f-1;function Ya(o){const t=Oe/o.extent,l=o.loadGeometry();for(let d=0;d<l.length;d++){const y=l[d];for(let T=0;T<y.length;T++){const E=y[T],A=Math.round(E.x*t),I=Math.round(E.y*t);E.x=St(A,ka,$f),E.y=St(I,ka,$f),(A<E.x||A>E.x+1||I<E.y||I>E.y+1)&&Mi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function ps(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?Ya(o):[]}}const yc=-32768;function iu(o,t,l,d,y){o.emplaceBack(yc+8*t+d,yc+8*l+y)}class ch{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new be,this.indexArray=new ut,this.segments=new pn,this.programConfigurations=new no(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,d){const y=this.layers[0],T=[];let E=null,A=!1,I=y.type==="heatmap";if(y.type==="circle"){const O=y;E=O.layout.get("circle-sort-key"),A=!E.isConstant(),I=I||O.paint.get("circle-pitch-alignment")==="map"}const L=I?l.subdivisionGranularity.circle:1;for(const{feature:O,id:B,index:$,sourceLayerIndex:q}of t){const W=this.layers[0]._featureFilter.needGeometry,J=ps(O,W);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),J,d))continue;const le=A?E.evaluate(J,{},d):void 0,fe={id:B,properties:O.properties,type:O.type,sourceLayerIndex:q,index:$,geometry:W?J.geometry:Ya(O),patterns:{},sortKey:le};T.push(fe)}A&&T.sort((O,B)=>O.sortKey-B.sortKey);for(const O of T){const{geometry:B,index:$,sourceLayerIndex:q}=O,W=t[$].feature;this.addFeature(O,B,$,d,L),l.featureIndex.insert(W,B,$,q,this.index)}}update(t,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,In),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,l,d,y,T=1){let E;switch(T){case 1:E=[0,7];break;case 3:E=[0,2,5,7];break;case 5:E=[0,1,3,4,6,7];break;case 7:E=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const A=E.length;for(const I of l)for(const L of I){const O=L.x,B=L.y;if(O<0||O>=Oe||B<0||B>=Oe)continue;const $=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,t.sortKey),q=$.vertexLength;for(let W=0;W<A;W++)for(let J=0;J<A;J++)iu(this.layoutVertexArray,O,B,E[J],E[W]);for(let W=0;W<A-1;W++)for(let J=0;J<A-1;J++){const le=q+W*A+J,fe=q+(W+1)*A+J;this.indexArray.emplaceBack(le,fe+1,le+1),this.indexArray.emplaceBack(le,fe,fe+1)}$.vertexLength+=A*A,$.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,{},y)}}function uh(o,t){for(let l=0;l<o.length;l++)if(Ui(t,o[l]))return!0;for(let l=0;l<t.length;l++)if(Ui(o,t[l]))return!0;return!!ro(o,t)}function zd(o,t,l){return!!Ui(o,t)||!!im(t,o,l)}function Rg(o,t){if(o.length===1)return El(t,o[0]);for(let l=0;l<t.length;l++){const d=t[l];for(let y=0;y<d.length;y++)if(Ui(o,d[y]))return!0}for(let l=0;l<o.length;l++)if(El(t,o[l]))return!0;for(let l=0;l<t.length;l++)if(ro(o,t[l]))return!0;return!1}function io(o,t,l){if(o.length>1){if(ro(o,t))return!0;for(let d=0;d<t.length;d++)if(im(t[d],o,l))return!0}for(let d=0;d<o.length;d++)if(im(o[d],t,l))return!0;return!1}function ro(o,t){if(o.length===0||t.length===0)return!1;for(let l=0;l<o.length-1;l++){const d=o[l],y=o[l+1];for(let T=0;T<t.length-1;T++)if(ru(d,y,t[T],t[T+1]))return!0}return!1}function ru(o,t,l,d){return yi(o,l,d)!==yi(t,l,d)&&yi(o,t,l)!==yi(o,t,d)}function im(o,t,l){const d=l*l;if(t.length===1)return o.distSqr(t[0])<d;for(let y=1;y<t.length;y++)if(_c(o,t[y-1],t[y])<d)return!0;return!1}function _c(o,t,l){const d=t.distSqr(l);if(d===0)return o.distSqr(t);const y=((o.x-t.x)*(l.x-t.x)+(o.y-t.y)*(l.y-t.y))/d;return o.distSqr(y<0?t:y>1?l:l.sub(t)._mult(y)._add(t))}function El(o,t){for(let l=0;l<o.length;l++)if(Ui(o[l],t))return!0;return!1}function Ui(o,t){let l=!1;for(let d=0,y=o.length-1;d<o.length;y=d++){const T=o[d],E=o[y];T.y>t.y!=E.y>t.y&&t.x<(E.x-T.x)*(t.y-T.y)/(E.y-T.y)+T.x&&(l=!l)}return l}function rm(o,t,l){const d=l[0],y=l[2];if(o.x<d.x&&t.x<d.x||o.x>y.x&&t.x>y.x||o.y<d.y&&t.y<d.y||o.y>y.y&&t.y>y.y)return!1;const T=yi(o,t,l[0]);return T!==yi(o,t,l[1])||T!==yi(o,t,l[2])||T!==yi(o,t,l[3])}function hh(o,t,l){const d=t.paint.get(o).value;return d.kind==="constant"?d.value:l.programConfigurations.get(t.id).getMaxValue(o)}function Ld(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Yf(o,t,l,d,y){if(!t[0]&&!t[1])return o;const T=ie.convert(t)._mult(y);l==="viewport"&&T._rotate(-d);const E=[];for(let A=0;A<o.length;A++)E.push(o[A].sub(T));return E}let zg,au;Lt("CircleBucket",ch,{omit:["layers"]});var am={get paint(){return au=au||new Lr({"circle-radius":new Ht(X.paint_circle["circle-radius"]),"circle-color":new Ht(X.paint_circle["circle-color"]),"circle-blur":new Ht(X.paint_circle["circle-blur"]),"circle-opacity":new Ht(X.paint_circle["circle-opacity"]),"circle-translate":new Zt(X.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(X.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(X.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(X.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ht(X.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ht(X.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ht(X.paint_circle["circle-stroke-opacity"])})},get layout(){return zg=zg||new Lr({"circle-sort-key":new Ht(X.layout_circle["circle-sort-key"])})}};class j_ extends Nr{constructor(t){super(t,am)}createBucket(t){return new ch(t)}queryRadius(t){const l=t;return hh("circle-radius",this,l)+hh("circle-stroke-width",this,l)+Ld(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:l,featureState:d,geometry:y,transform:T,pixelsToTileUnits:E,unwrappedTileID:A,getElevation:I}){const L=Yf(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,E),O=this.paint.get("circle-radius").evaluate(l,d)+this.paint.get("circle-stroke-width").evaluate(l,d),B=this.paint.get("circle-pitch-alignment")==="map",$=B?L:function(W,J,le,fe){return W.map(Ee=>Lg(Ee,J,le,fe))}(L,T,A,I),q=B?O*E:O;for(const W of y)for(const J of W){const le=B?J:Lg(J,T,A,I);let fe=q;const Ee=T.projectTileCoordinates(J.x,J.y,A,I).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?fe*=Ee/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(fe*=T.cameraToCenterDistance/Ee),zd($,le,fe))return!0}return!1}}function Lg(o,t,l,d){const y=t.projectTileCoordinates(o.x,o.y,l,d).point;return new ie((.5*y.x+.5)*t.width,(.5*-y.y+.5)*t.height)}class Ng extends ch{}let qf;Lt("HeatmapBucket",Ng,{omit:["layers"]});var B_={get paint(){return qf=qf||new Lr({"heatmap-radius":new Ht(X.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ht(X.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(X.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yl(X.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(X.paint_heatmap["heatmap-opacity"])})}};function Hf(o,{width:t,height:l},d,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==t*l*d)throw new RangeError(`mismatched image size. expected: ${y.length} but got: ${t*l*d}`)}else y=new Uint8Array(t*l*d);return o.width=t,o.height=l,o.data=y,o}function Pg(o,{width:t,height:l},d){if(t===o.width&&l===o.height)return;const y=Hf({},{width:t,height:l},d);sm(o,y,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,t),height:Math.min(o.height,l)},d),o.width=t,o.height=l,o.data=y.data}function sm(o,t,l,d,y,T){if(y.width===0||y.height===0)return t;if(y.width>o.width||y.height>o.height||l.x>o.width-y.width||l.y>o.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>t.width||y.height>t.height||d.x>t.width-y.width||d.y>t.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const E=o.data,A=t.data;if(E===A)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<y.height;I++){const L=((l.y+I)*o.width+l.x)*T,O=((d.y+I)*t.width+d.x)*T;for(let B=0;B<y.width*T;B++)A[O+B]=E[L+B]}return t}class Xf{constructor(t,l){Hf(this,t,1,l)}resize(t){Pg(this,t,1)}clone(){return new Xf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,l,d,y,T){sm(t,l,d,y,T,1)}}class qa{constructor(t,l){Hf(this,t,4,l)}resize(t){Pg(this,t,4)}replace(t,l){l?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new qa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,l,d,y,T){sm(t,l,d,y,T,4)}}function Pr(o){const t={},l=o.resolution||256,d=o.clips?o.clips.length:1,y=o.image||new qa({width:l,height:d});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const T=(E,A,I)=>{t[o.evaluationKey]=I;const L=o.expression.evaluate(t);y.data[E+A+0]=Math.floor(255*L.r/L.a),y.data[E+A+1]=Math.floor(255*L.g/L.a),y.data[E+A+2]=Math.floor(255*L.b/L.a),y.data[E+A+3]=Math.floor(255*L.a)};if(o.clips)for(let E=0,A=0;E<d;++E,A+=4*l)for(let I=0,L=0;I<l;I++,L+=4){const O=I/(l-1),{start:B,end:$}=o.clips[E];T(A,L,B*(1-O)+$*O)}else for(let E=0,A=0;E<l;E++,A+=4)T(0,A,E/(l-1));return y}Lt("AlphaImage",Xf),Lt("RGBAImage",qa);const Or="big-fb";class F_ extends Nr{createBucket(t){return new Ng(t)}constructor(t){super(t,B_),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pr({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Or)&&this.heatmapFbos.delete(Or)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Og;var U_={get paint(){return Og=Og||new Lr({"hillshade-illumination-direction":new Zt(X.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(X.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(X.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(X.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(X.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(X.paint_hillshade["hillshade-accent-color"])})}};class V_ extends Nr{constructor(t){super(t,U_)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Z_=on([{name:"a_pos",components:2,type:"Int16"}],4),{members:om}=Z_;function Wf(o,t,l){const d=l.patternDependencies;let y=!1;for(const T of t){const E=T.paint.get(`${o}-pattern`);E.isConstant()||(y=!0);const A=E.constantOr(null);A&&(y=!0,d[A.to]=!0,d[A.from]=!0)}return y}function lm(o,t,l,d,y){const T=y.patternDependencies;for(const E of t){const A=E.paint.get(`${o}-pattern`).value;if(A.kind!=="constant"){let I=A.evaluate({zoom:d-1},l,{},y.availableImages),L=A.evaluate({zoom:d},l,{},y.availableImages),O=A.evaluate({zoom:d+1},l,{},y.availableImages);I=I&&I.name?I.name:I,L=L&&L.name?L.name:L,O=O&&O.name?O.name:O,T[I]=!0,T[L]=!0,T[O]=!0,l.patterns[E.id]={min:I,mid:L,max:O}}}return l}function jg(o,t,l,d,y){let T;if(y===function(E,A,I,L){let O=0;for(let B=A,$=I-L;B<I;B+=L)O+=(E[$]-E[B])*(E[B+1]+E[$+1]),$=B;return O}(o,t,l,d)>0)for(let E=t;E<l;E+=d)T=H_(E/d|0,o[E],o[E+1],T);else for(let E=l-d;E>=t;E-=d)T=H_(E/d|0,o[E],o[E+1],T);return T&&Ha(T,T.next)&&(Nd(T),T=T.next),T}function su(o,t){if(!o)return o;t||(t=o);let l,d=o;do if(l=!1,d.steiner||!Ha(d,d.next)&&Hi(d.prev,d,d.next)!==0)d=d.next;else{if(Nd(d),d=t=d.prev,d===d.next)break;l=!0}while(l||d!==t);return t}function dh(o,t,l,d,y,T,E){if(!o)return;!E&&T&&function(I,L,O,B){let $=I;do $.z===0&&($.z=Qf($.x,$.y,L,O,B)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==I);$.prevZ.nextZ=null,$.prevZ=null,function(q){let W,J=1;do{let le,fe=q;q=null;let Ee=null;for(W=0;fe;){W++;let ye=fe,Y=0;for(let ve=0;ve<J&&(Y++,ye=ye.nextZ,ye);ve++);let oe=J;for(;Y>0||oe>0&&ye;)Y!==0&&(oe===0||!ye||fe.z<=ye.z)?(le=fe,fe=fe.nextZ,Y--):(le=ye,ye=ye.nextZ,oe--),Ee?Ee.nextZ=le:q=le,le.prevZ=Ee,Ee=le;fe=ye}Ee.nextZ=null,J*=2}while(W>1)}($)}(o,d,y,T);let A=o;for(;o.prev!==o.next;){const I=o.prev,L=o.next;if(T?Fg(o,d,y,T):Bg(o))t.push(I.i,o.i,L.i),Nd(o),o=L.next,A=L.next;else if((o=L)===A){E?E===1?dh(o=G_(su(o),t),t,l,d,y,T,2):E===2&&Ug(o,t,l,d,y,T):dh(su(o),t,l,d,y,T,1);break}}}function Bg(o){const t=o.prev,l=o,d=o.next;if(Hi(t,l,d)>=0)return!1;const y=t.x,T=l.x,E=d.x,A=t.y,I=l.y,L=d.y,O=Math.min(y,T,E),B=Math.min(A,I,L),$=Math.max(y,T,E),q=Math.max(A,I,L);let W=d.next;for(;W!==t;){if(W.x>=O&&W.x<=$&&W.y>=B&&W.y<=q&&fh(y,A,T,I,E,L,W.x,W.y)&&Hi(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function Fg(o,t,l,d){const y=o.prev,T=o,E=o.next;if(Hi(y,T,E)>=0)return!1;const A=y.x,I=T.x,L=E.x,O=y.y,B=T.y,$=E.y,q=Math.min(A,I,L),W=Math.min(O,B,$),J=Math.max(A,I,L),le=Math.max(O,B,$),fe=Qf(q,W,t,l,d),Ee=Qf(J,le,t,l,d);let ye=o.prevZ,Y=o.nextZ;for(;ye&&ye.z>=fe&&Y&&Y.z<=Ee;){if(ye.x>=q&&ye.x<=J&&ye.y>=W&&ye.y<=le&&ye!==y&&ye!==E&&fh(A,O,I,B,L,$,ye.x,ye.y)&&Hi(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,Y.x>=q&&Y.x<=J&&Y.y>=W&&Y.y<=le&&Y!==y&&Y!==E&&fh(A,O,I,B,L,$,Y.x,Y.y)&&Hi(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;ye&&ye.z>=fe;){if(ye.x>=q&&ye.x<=J&&ye.y>=W&&ye.y<=le&&ye!==y&&ye!==E&&fh(A,O,I,B,L,$,ye.x,ye.y)&&Hi(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;Y&&Y.z<=Ee;){if(Y.x>=q&&Y.x<=J&&Y.y>=W&&Y.y<=le&&Y!==y&&Y!==E&&fh(A,O,I,B,L,$,Y.x,Y.y)&&Hi(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function G_(o,t){let l=o;do{const d=l.prev,y=l.next.next;!Ha(d,y)&&Zg(d,l,l.next,y)&&ki(d,y)&&ki(y,d)&&(t.push(d.i,l.i,y.i),Nd(l),Nd(l.next),l=o=y),l=l.next}while(l!==o);return su(l)}function Ug(o,t,l,d,y,T){let E=o;do{let A=E.next.next;for(;A!==E.prev;){if(E.i!==A.i&&Cv(E,A)){let I=q_(E,A);return E=su(E,E.next),I=su(I,I.next),dh(E,t,l,d,y,T,0),void dh(I,t,l,d,y,T,0)}A=A.next}E=E.next}while(E!==o)}function cm(o,t){let l=o.x-t.x;return l===0&&(l=o.y-t.y,l===0)&&(l=(o.next.y-o.y)/(o.next.x-o.x)-(t.next.y-t.y)/(t.next.x-t.x)),l}function Vg(o,t){const l=function(y,T){let E=T;const A=y.x,I=y.y;let L,O=-1/0;if(Ha(y,E))return E;do{if(Ha(y,E.next))return E.next;if(I<=E.y&&I>=E.next.y&&E.next.y!==E.y){const J=E.x+(I-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(J<=A&&J>O&&(O=J,L=E.x<E.next.x?E:E.next,J===A))return L}E=E.next}while(E!==T);if(!L)return null;const B=L,$=L.x,q=L.y;let W=1/0;E=L;do{if(A>=E.x&&E.x>=$&&A!==E.x&&Sl(I<q?A:O,I,$,q,I<q?O:A,I,E.x,E.y)){const J=Math.abs(I-E.y)/(A-E.x);ki(E,y)&&(J<W||J===W&&(E.x>L.x||E.x===L.x&&$_(L,E)))&&(L=E,W=J)}E=E.next}while(E!==B);return L}(o,t);if(!l)return t;const d=q_(l,o);return su(d,d.next),su(l,l.next)}function $_(o,t){return Hi(o.prev,o,t.prev)<0&&Hi(t.next,o,o.next)<0}function Qf(o,t,l,d,y){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-l)*y|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-d)*y|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Y_(o){let t=o,l=o;do(t.x<l.x||t.x===l.x&&t.y<l.y)&&(l=t),t=t.next;while(t!==o);return l}function Sl(o,t,l,d,y,T,E,A){return(y-E)*(t-A)>=(o-E)*(T-A)&&(o-E)*(d-A)>=(l-E)*(t-A)&&(l-E)*(T-A)>=(y-E)*(d-A)}function fh(o,t,l,d,y,T,E,A){return!(o===E&&t===A)&&Sl(o,t,l,d,y,T,E,A)}function Cv(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(l,d){let y=l;do{if(y.i!==l.i&&y.next.i!==l.i&&y.i!==d.i&&y.next.i!==d.i&&Zg(y,y.next,l,d))return!0;y=y.next}while(y!==l);return!1}(o,t)&&(ki(o,t)&&ki(t,o)&&function(l,d){let y=l,T=!1;const E=(l.x+d.x)/2,A=(l.y+d.y)/2;do y.y>A!=y.next.y>A&&y.next.y!==y.y&&E<(y.next.x-y.x)*(A-y.y)/(y.next.y-y.y)+y.x&&(T=!T),y=y.next;while(y!==l);return T}(o,t)&&(Hi(o.prev,o,t.prev)||Hi(o,t.prev,t))||Ha(o,t)&&Hi(o.prev,o,o.next)>0&&Hi(t.prev,t,t.next)>0)}function Hi(o,t,l){return(t.y-o.y)*(l.x-t.x)-(t.x-o.x)*(l.y-t.y)}function Ha(o,t){return o.x===t.x&&o.y===t.y}function Zg(o,t,l,d){const y=ou(Hi(o,t,l)),T=ou(Hi(o,t,d)),E=ou(Hi(l,d,o)),A=ou(Hi(l,d,t));return y!==T&&E!==A||!(y!==0||!ph(o,l,t))||!(T!==0||!ph(o,d,t))||!(E!==0||!ph(l,o,d))||!(A!==0||!ph(l,t,d))}function ph(o,t,l){return t.x<=Math.max(o.x,l.x)&&t.x>=Math.min(o.x,l.x)&&t.y<=Math.max(o.y,l.y)&&t.y>=Math.min(o.y,l.y)}function ou(o){return o>0?1:o<0?-1:0}function ki(o,t){return Hi(o.prev,o,o.next)<0?Hi(o,t,o.next)>=0&&Hi(o,o.prev,t)>=0:Hi(o,t,o.prev)<0||Hi(o,o.next,t)<0}function q_(o,t){const l=mh(o.i,o.x,o.y),d=mh(t.i,t.x,t.y),y=o.next,T=t.prev;return o.next=t,t.prev=o,l.next=y,y.prev=l,d.next=l,l.prev=d,T.next=d,d.prev=T,d}function H_(o,t,l,d){const y=mh(o,t,l);return d?(y.next=d.next,y.prev=d,d.next.prev=y,d.next=y):(y.prev=y,y.next=y),y}function Nd(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function mh(o,t,l){return{i:o,x:t,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ms{constructor(t,l){if(l>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=l}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Kf{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Kf.noSubdivision=new Kf({fill:new ms(0,0),line:new ms(0,0),tile:new ms(0,0),stencil:new ms(0,0),circle:1}),Lt("SubdivisionGranularityExpression",ms),Lt("SubdivisionGranularitySetting",Kf);const gh=-32768,vc=32767;class Al{constructor(t,l){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Oe/t,this._canonical=l}_getKey(t,l){return(t+=32768)<<16|(l+=32768)<<0}_vertexToIndex(t,l){if(t<-32768||l<-32768||t>32767||l>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const d=0|Math.round(t),y=0|Math.round(l),T=this._getKey(d,y);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const E=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,E),this._vertexBuffer.push(d,y),E}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(y,T){const E=[];for(let A=0;A<T.length;A+=3){const I=T[A],L=T[A+1],O=T[A+2],B=y[2*I],$=y[2*I+1];(y[2*L]-B)*(y[2*O+1]-$)-(y[2*L+1]-$)*(y[2*O]-B)>0?(E.push(I),E.push(O),E.push(L)):(E.push(I),E.push(L),E.push(O))}return E}(this._vertexBuffer,t);const l=[],d=t.length;for(let y=0;y<d;y+=3){const T=[t[y+0],t[y+1],t[y+2]],E=[this._vertexBuffer[2*t[y+0]+0],this._vertexBuffer[2*t[y+0]+1],this._vertexBuffer[2*t[y+1]+0],this._vertexBuffer[2*t[y+1]+1],this._vertexBuffer[2*t[y+2]+0],this._vertexBuffer[2*t[y+2]+1]];let A=1/0,I=1/0,L=-1/0,O=-1/0;for(let J=0;J<3;J++){const le=E[2*J],fe=E[2*J+1];A=Math.min(A,le),L=Math.max(L,le),I=Math.min(I,fe),O=Math.max(O,fe)}if(A===L||I===O)continue;const B=Math.floor(A/this._granularityCellSize),$=Math.ceil(L/this._granularityCellSize),q=Math.floor(I/this._granularityCellSize),W=Math.ceil(O/this._granularityCellSize);if(B!==$||q!==W)for(let J=q;J<W;J++){const le=this._scanlineGenerateVertexRingForCellRow(J,E,T);X_(this._vertexBuffer,le,l)}else l.push(...T)}return l}_scanlineGenerateVertexRingForCellRow(t,l,d){const y=t*this._granularityCellSize,T=y+this._granularityCellSize,E=[];for(let A=0;A<3;A++){const I=l[2*A],L=l[2*A+1],O=l[2*(A+1)%6],B=l[(2*(A+1)+1)%6],$=l[2*(A+2)%6],q=l[(2*(A+2)+1)%6],W=O-I,J=B-L,le=W===0,fe=J===0,Ee=(y-L)/J,ye=(T-L)/J,Y=Math.min(Ee,ye),oe=Math.max(Ee,ye);if(!fe&&(Y>=1||oe<=0)||fe&&(L<y||L>T)){B>=y&&B<=T&&E.push(d[(A+1)%3]);continue}!fe&&Y>0&&E.push(this._vertexToIndex(I+W*Y,L+J*Y));const ve=I+W*Math.max(Y,0),Ve=I+W*Math.min(oe,1);le||this._generateIntraEdgeVertices(E,I,L,O,B,ve,Ve),!fe&&oe<1&&E.push(this._vertexToIndex(I+W*oe,L+J*oe)),(fe||B>=y&&B<=T)&&E.push(d[(A+1)%3]),!fe&&(B<=y||B>=T)&&this._generateInterEdgeVertices(E,I,L,O,B,$,q,Ve,y,T)}return E}_generateIntraEdgeVertices(t,l,d,y,T,E,A){const I=y-l,L=T-d,O=L===0,B=O?Math.min(l,y):Math.min(E,A),$=O?Math.max(l,y):Math.max(E,A),q=Math.floor(B/this._granularityCellSize)+1,W=Math.ceil($/this._granularityCellSize)-1;if(O?l<y:E<A)for(let J=q;J<=W;J++){const le=J*this._granularityCellSize;t.push(this._vertexToIndex(le,d+L*(le-l)/I))}else for(let J=W;J>=q;J--){const le=J*this._granularityCellSize;t.push(this._vertexToIndex(le,d+L*(le-l)/I))}}_generateInterEdgeVertices(t,l,d,y,T,E,A,I,L,O){const B=T-d,$=E-y,q=A-T,W=(L-T)/q,J=(O-T)/q,le=Math.min(W,J),fe=Math.max(W,J),Ee=y+$*le;let ye=Math.floor(Math.min(Ee,I)/this._granularityCellSize)+1,Y=Math.ceil(Math.max(Ee,I)/this._granularityCellSize)-1,oe=I<Ee;const ve=q===0;if(ve&&(A===L||A===O))return;if(ve||le>=1||fe<=0){const pt=d-A,qe=E+(l-E)*Math.min((L-A)/pt,(O-A)/pt);ye=Math.floor(Math.min(qe,I)/this._granularityCellSize)+1,Y=Math.ceil(Math.max(qe,I)/this._granularityCellSize)-1,oe=I<qe}const Ve=B>0?O:L;if(oe)for(let pt=ye;pt<=Y;pt++)t.push(this._vertexToIndex(pt*this._granularityCellSize,Ve));else for(let pt=Y;pt>=ye;pt--)t.push(this._vertexToIndex(pt*this._granularityCellSize,Ve))}_generateOutline(t){const l=[];for(const d of t){const y=xc(d,this._granularity,!0),T=this._pointArrayToIndices(y),E=[];for(let A=1;A<T.length;A++)E.push(T[A-1]),E.push(T[A]);l.push(E)}return l}_handlePoles(t){let l=!1,d=!1;this._canonical&&(this._canonical.y===0&&(l=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(l||d)&&this._fillPoles(t,l,d)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let l=0;l<t.length;l+=2){const d=t[l+1];d===gh&&(t[l+1]=-32767),d===vc&&(t[l+1]=32766)}}_generatePoleQuad(t,l,d,y,T,E){y>T!=(E===gh)?(t.push(l),t.push(d),t.push(this._vertexToIndex(y,E)),t.push(d),t.push(this._vertexToIndex(T,E)),t.push(this._vertexToIndex(y,E))):(t.push(d),t.push(l),t.push(this._vertexToIndex(y,E)),t.push(this._vertexToIndex(T,E)),t.push(d),t.push(this._vertexToIndex(y,E)))}_fillPoles(t,l,d){const y=this._vertexBuffer,T=Oe,E=t.length;for(let A=2;A<E;A+=3){const I=t[A-2],L=t[A-1],O=t[A],B=y[2*I],$=y[2*I+1],q=y[2*L],W=y[2*L+1],J=y[2*O],le=y[2*O+1];l&&($===0&&W===0&&this._generatePoleQuad(t,I,L,B,q,gh),W===0&&le===0&&this._generatePoleQuad(t,L,O,q,J,gh),le===0&&$===0&&this._generatePoleQuad(t,O,I,J,B,gh)),d&&($===T&&W===T&&this._generatePoleQuad(t,I,L,B,q,vc),W===T&&le===T&&this._generatePoleQuad(t,L,O,q,J,vc),le===T&&$===T&&this._generatePoleQuad(t,O,I,J,B,vc))}}_initializeVertices(t){for(let l=0;l<t.length;l+=2)this._vertexToIndex(t[l],t[l+1])}subdividePolygonInternal(t,l){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:d,holeIndices:y}=function(A){const I=[],L=[];for(const O of A)if(O.length!==0){O!==A[0]&&I.push(L.length/2);for(let B=0;B<O.length;B++)L.push(O[B].x),L.push(O[B].y)}return{flattened:L,holeIndices:I}}(t);let T;this._initializeVertices(d);try{const A=function(L,O,B=2){const $=O&&O.length,q=$?O[0]*B:L.length;let W=jg(L,0,q,B,!0);const J=[];if(!W||W.next===W.prev)return J;let le,fe,Ee;if($&&(W=function(ye,Y,oe,ve){const Ve=[];for(let pt=0,qe=Y.length;pt<qe;pt++){const tt=jg(ye,Y[pt]*ve,pt<qe-1?Y[pt+1]*ve:ye.length,ve,!1);tt===tt.next&&(tt.steiner=!0),Ve.push(Y_(tt))}Ve.sort(cm);for(let pt=0;pt<Ve.length;pt++)oe=Vg(Ve[pt],oe);return oe}(L,O,W,B)),L.length>80*B){le=1/0,fe=1/0;let ye=-1/0,Y=-1/0;for(let oe=B;oe<q;oe+=B){const ve=L[oe],Ve=L[oe+1];ve<le&&(le=ve),Ve<fe&&(fe=Ve),ve>ye&&(ye=ve),Ve>Y&&(Y=Ve)}Ee=Math.max(ye-le,Y-fe),Ee=Ee!==0?32767/Ee:0}return dh(W,J,B,le,fe,Ee,0),J}(d,y),I=this._convertIndices(d,A);T=this._subdivideTrianglesScanline(I)}catch(A){console.error(A)}let E=[];return l&&(E=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:E}}_convertIndices(t,l){const d=[];for(let y=0;y<l.length;y++)d.push(this._vertexToIndex(t[2*l[y]],t[2*l[y]+1]));return d}_pointArrayToIndices(t){const l=[];for(let d=0;d<t.length;d++){const y=t[d];l.push(this._vertexToIndex(y.x,y.y))}return l}}function Gg(o,t,l,d=!0){return new Al(l,t).subdividePolygonInternal(o,d)}function xc(o,t,l=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const d=o[0],y=o[o.length-1],T=l&&(d.x!==y.x||d.y!==y.y);if(t<2)return T?[...o,o[0]]:[...o];const E=Math.floor(Oe/t),A=[];A.push(new ie(o[0].x,o[0].y));const I=o.length,L=T?I:I-1;for(let O=0;O<L;O++){const B=o[O],$=O<I-1?o[O+1]:o[0],q=B.x,W=B.y,J=$.x,le=$.y,fe=q!==J,Ee=W!==le;if(!fe&&!Ee)continue;const ye=J-q,Y=le-W,oe=Math.abs(ye),ve=Math.abs(Y);let Ve=q,pt=W;for(;;){const tt=ye>0?(Math.floor(Ve/E)+1)*E:(Math.ceil(Ve/E)-1)*E,wt=Y>0?(Math.floor(pt/E)+1)*E:(Math.ceil(pt/E)-1)*E,ft=Math.abs(Ve-tt),Tt=Math.abs(pt-wt),ot=Math.abs(Ve-J),Pt=Math.abs(pt-le),Jt=fe?ft/oe:Number.POSITIVE_INFINITY,Xt=Ee?Tt/ve:Number.POSITIVE_INFINITY;if((ot<=ft||!fe)&&(Pt<=Tt||!Ee))break;if(Jt<Xt&&fe||!Ee){Ve=tt,pt+=Y*Jt;const Gt=new ie(Ve,Math.round(pt));A[A.length-1].x===Gt.x&&A[A.length-1].y===Gt.y||A.push(Gt)}else{Ve+=ye*Xt,pt=wt;const Gt=new ie(Math.round(Ve),pt);A[A.length-1].x===Gt.x&&A[A.length-1].y===Gt.y||A.push(Gt)}}const qe=new ie(J,le);A[A.length-1].x===qe.x&&A[A.length-1].y===qe.y||A.push(qe)}return A}function X_(o,t,l){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,y=o[2*t[0]];for(let I=1;I<t.length;I++){const L=o[2*t[I]];L<y&&(y=L,d=I)}const T=t.length;let E=d,A=(E+1)%T;for(;;){const I=E-1>=0?E-1:T-1,L=(A+1)%T,O=o[2*t[I]],B=o[2*t[L]],$=o[2*t[E]],q=o[2*t[E]+1],W=o[2*t[A]+1];let J=!1;if(O<B)J=!0;else if(O>B)J=!1;else{const le=W-q,fe=-(o[2*t[A]]-$),Ee=q<W?1:-1;((O-$)*le+(o[2*t[I]+1]-q)*fe)*Ee>((B-$)*le+(o[2*t[L]+1]-q)*fe)*Ee&&(J=!0)}if(J){const le=t[I],fe=t[E],Ee=t[A];le!==fe&&le!==Ee&&fe!==Ee&&l.push(Ee,fe,le),E--,E<0&&(E=T-1)}else{const le=t[L],fe=t[E],Ee=t[A];le!==fe&&le!==Ee&&fe!==Ee&&l.push(Ee,fe,le),A++,A>=T&&(A=0)}if(I===L)break}}function um(o,t,l,d,y,T,E,A,I){const L=y.length/2,O=E&&A&&I;if(L<pn.MAX_VERTEX_ARRAY_LENGTH){const B=t.prepareSegment(L,l,d),$=B.vertexLength;for(let J=0;J<T.length;J+=3)d.emplaceBack($+T[J],$+T[J+1],$+T[J+2]);let q,W;B.vertexLength+=L,B.primitiveLength+=T.length/3,O&&(W=E.prepareSegment(L,l,A),q=W.vertexLength,W.vertexLength+=L);for(let J=0;J<y.length;J+=2)o(y[J],y[J+1]);if(O)for(let J=0;J<I.length;J++){const le=I[J];for(let fe=1;fe<le.length;fe+=2)A.emplaceBack(q+le[fe-1],q+le[fe]);W.primitiveLength+=le.length/2}}else(function(B,$,q,W,J,le){const fe=[];for(let ve=0;ve<W.length/2;ve++)fe.push(-1);const Ee={count:0};let ye=0,Y=B.getOrCreateLatestSegment($,q),oe=Y.vertexLength;for(let ve=2;ve<J.length;ve+=3){const Ve=J[ve-2],pt=J[ve-1],qe=J[ve];let tt=fe[Ve]<ye,wt=fe[pt]<ye,ft=fe[qe]<ye;Y.vertexLength+((tt?1:0)+(wt?1:0)+(ft?1:0))>pn.MAX_VERTEX_ARRAY_LENGTH&&(Y=B.createNewSegment($,q),ye=Ee.count,tt=!0,wt=!0,ft=!0,oe=0);const Tt=yh(fe,W,le,Ee,Ve,tt,Y),ot=yh(fe,W,le,Ee,pt,wt,Y),Pt=yh(fe,W,le,Ee,qe,ft,Y);q.emplaceBack(oe+Tt-ye,oe+ot-ye,oe+Pt-ye),Y.primitiveLength++}})(t,l,d,y,T,o),O&&function(B,$,q,W,J,le){const fe=[];for(let ve=0;ve<W.length/2;ve++)fe.push(-1);const Ee={count:0};let ye=0,Y=B.getOrCreateLatestSegment($,q),oe=Y.vertexLength;for(let ve=0;ve<J.length;ve++){const Ve=J[ve];for(let pt=1;pt<J[ve].length;pt+=2){const qe=Ve[pt-1],tt=Ve[pt];let wt=fe[qe]<ye,ft=fe[tt]<ye;Y.vertexLength+((wt?1:0)+(ft?1:0))>pn.MAX_VERTEX_ARRAY_LENGTH&&(Y=B.createNewSegment($,q),ye=Ee.count,wt=!0,ft=!0,oe=0);const Tt=yh(fe,W,le,Ee,qe,wt,Y),ot=yh(fe,W,le,Ee,tt,ft,Y);q.emplaceBack(oe+Tt-ye,oe+ot-ye),Y.primitiveLength++}}}(E,l,A,y,I,o),t.forceNewSegmentOnNextPrepare(),E==null||E.forceNewSegmentOnNextPrepare()}function yh(o,t,l,d,y,T,E){if(T){const A=d.count;return l(t[2*y],t[2*y+1]),o[y]=d.count,d.count++,E.vertexLength++,A}return o[y]}class Pd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new ut,this.indexArray2=new Ft,this.programConfigurations=new no(t.layers,t.zoom),this.segments=new pn,this.segments2=new pn,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,d){this.hasPattern=Wf("fill",this.layers,l);const y=this.layers[0].layout.get("fill-sort-key"),T=!y.isConstant(),E=[];for(const{feature:A,id:I,index:L,sourceLayerIndex:O}of t){const B=this.layers[0]._featureFilter.needGeometry,$=ps(A,B);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),$,d))continue;const q=T?y.evaluate($,{},d,l.availableImages):void 0,W={id:I,properties:A.properties,type:A.type,sourceLayerIndex:O,index:L,geometry:B?$.geometry:Ya(A),patterns:{},sortKey:q};E.push(W)}T&&E.sort((A,I)=>A.sortKey-I.sortKey);for(const A of E){const{geometry:I,index:L,sourceLayerIndex:O}=A;if(this.hasPattern){const B=lm("fill",this.layers,A,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(A,I,L,d,{},l.subdivisionGranularity);l.featureIndex.insert(t[L].feature,I,L,O,this.index)}}update(t,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,d)}addFeatures(t,l,d){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,l,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,om),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,l,d,y,T,E){for(const A of Ro(l,500)){const I=Gg(A,y,E.fill.getGranularityForZoomLevel(y.z)),L=this.layoutVertexArray;um((O,B)=>{L.emplaceBack(O,B)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,y)}}let $g,Ml;Lt("FillBucket",Pd,{omit:["layers","patternFeatures"]});var yr={get paint(){return Ml=Ml||new Lr({"fill-antialias":new Zt(X.paint_fill["fill-antialias"]),"fill-opacity":new Ht(X.paint_fill["fill-opacity"]),"fill-color":new Ht(X.paint_fill["fill-color"]),"fill-outline-color":new Ht(X.paint_fill["fill-outline-color"]),"fill-translate":new Zt(X.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(X.paint_fill["fill-translate-anchor"]),"fill-pattern":new rh(X.paint_fill["fill-pattern"])})},get layout(){return $g=$g||new Lr({"fill-sort-key":new Ht(X.layout_fill["fill-sort-key"])})}};class Yg extends Nr{constructor(t){super(t,yr)}recalculate(t,l){super.recalculate(t,l);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Pd(t)}queryRadius(){return Ld(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:l,transform:d,pixelsToTileUnits:y}){return Rg(Yf(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,y),l)}isTileClipped(){return!0}}const W_=on([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Yr=on([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Dv}=W_;var hm,qg,Oi,Ia,Uo,Hg,Xg,dm={};function fm(){if(qg)return hm;qg=1;var o=j();function t(y,T,E,A,I){this.properties={},this.extent=E,this.type=0,this._pbf=y,this._geometry=-1,this._keys=A,this._values=I,y.readFields(l,this,T)}function l(y,T,E){y==1?T.id=E.readVarint():y==2?function(A,I){for(var L=A.readVarint()+A.pos;A.pos<L;){var O=I._keys[A.readVarint()],B=I._values[A.readVarint()];I.properties[O]=B}}(E,T):y==3?T.type=E.readVarint():y==4&&(T._geometry=E.pos)}function d(y){for(var T,E,A=0,I=0,L=y.length,O=L-1;I<L;O=I++)A+=((E=y[O]).x-(T=y[I]).x)*(T.y+E.y);return A}return hm=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var T,E=y.readVarint()+y.pos,A=1,I=0,L=0,O=0,B=[];y.pos<E;){if(I<=0){var $=y.readVarint();A=7&$,I=$>>3}if(I--,A===1||A===2)L+=y.readSVarint(),O+=y.readSVarint(),A===1&&(T&&B.push(T),T=[]),T.push(new o(L,O));else{if(A!==7)throw new Error("unknown command "+A);T&&T.push(T[0].clone())}}return T&&B.push(T),B},t.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var T=y.readVarint()+y.pos,E=1,A=0,I=0,L=0,O=1/0,B=-1/0,$=1/0,q=-1/0;y.pos<T;){if(A<=0){var W=y.readVarint();E=7&W,A=W>>3}if(A--,E===1||E===2)(I+=y.readSVarint())<O&&(O=I),I>B&&(B=I),(L+=y.readSVarint())<$&&($=L),L>q&&(q=L);else if(E!==7)throw new Error("unknown command "+E)}return[O,$,B,q]},t.prototype.toGeoJSON=function(y,T,E){var A,I,L=this.extent*Math.pow(2,E),O=this.extent*y,B=this.extent*T,$=this.loadGeometry(),q=t.types[this.type];function W(fe){for(var Ee=0;Ee<fe.length;Ee++){var ye=fe[Ee];fe[Ee]=[360*(ye.x+O)/L-180,360/Math.PI*Math.atan(Math.exp((180-360*(ye.y+B)/L)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(A=0;A<$.length;A++)J[A]=$[A][0];W($=J);break;case 2:for(A=0;A<$.length;A++)W($[A]);break;case 3:for($=function(fe){var Ee=fe.length;if(Ee<=1)return[fe];for(var ye,Y,oe=[],ve=0;ve<Ee;ve++){var Ve=d(fe[ve]);Ve!==0&&(Y===void 0&&(Y=Ve<0),Y===Ve<0?(ye&&oe.push(ye),ye=[fe[ve]]):ye.push(fe[ve]))}return ye&&oe.push(ye),oe}($),A=0;A<$.length;A++)for(I=0;I<$[A].length;I++)W($[A][I])}$.length===1?$=$[0]:q="Multi"+q;var le={type:"Feature",geometry:{type:q,coordinates:$},properties:this.properties};return"id"in this&&(le.id=this.id),le},hm}function Xa(){if(Ia)return Oi;Ia=1;var o=fm();function t(d,y){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(l,this,y),this.length=this._features.length}function l(d,y,T){d===15?y.version=T.readVarint():d===1?y.name=T.readString():d===5?y.extent=T.readVarint():d===2?y._features.push(T.pos):d===3?y._keys.push(T.readString()):d===4&&y._values.push(function(E){for(var A=null,I=E.readVarint()+E.pos;E.pos<I;){var L=E.readVarint()>>3;A=L===1?E.readString():L===2?E.readFloat():L===3?E.readDouble():L===4?E.readVarint64():L===5?E.readVarint():L===6?E.readSVarint():L===7?E.readBoolean():null}return A}(T))}return Oi=t,t.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var y=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,y,this.extent,this._keys,this._values)},Oi}function ao(){return Xg||(Xg=1,dm.VectorTile=function(){if(Hg)return Uo;Hg=1;var o=Xa();function t(l,d,y){if(l===3){var T=new o(y,y.readVarint()+y.pos);T.length&&(d[T.name]=T)}}return Uo=function(l,d){this.layers=l.readFields(t,{},d)},Uo}(),dm.VectorTileFeature=fm(),dm.VectorTileLayer=Xa()),dm}var Od=C(ao());const gs=Od.VectorTileFeature.types,pm=Math.pow(2,13);function so(o,t,l,d,y,T,E,A){o.emplaceBack(t,l,2*Math.floor(d*pm)+E,y*pm*2,T*pm*2,Math.round(A))}class bc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new De,this.centroidVertexArray=new xe,this.indexArray=new ut,this.programConfigurations=new no(t.layers,t.zoom),this.segments=new pn,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,d){this.features=[],this.hasPattern=Wf("fill-extrusion",this.layers,l);for(const{feature:y,id:T,index:E,sourceLayerIndex:A}of t){const I=this.layers[0]._featureFilter.needGeometry,L=ps(y,I);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),L,d))continue;const O={id:T,sourceLayerIndex:A,index:E,geometry:I?L.geometry:Ya(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(lm("fill-extrusion",this.layers,O,this.zoom,l)):this.addFeature(O,O.geometry,E,d,{},l.subdivisionGranularity),l.featureIndex.insert(y,O.geometry,E,A,this.index,!0)}}addFeatures(t,l,d){for(const y of this.features){const{geometry:T}=y;this.addFeature(y,T,y.index,l,d,t.subdivisionGranularity)}}update(t,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Dv),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Yr.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,l,d,y,T,E){for(const A of Ro(l,500)){const I={x:0,y:0,sampleCount:0},L=this.layoutVertexArray.length;this.processPolygon(I,y,t,A,E);const O=this.layoutVertexArray.length-L,B=Math.floor(I.x/I.sampleCount),$=Math.floor(I.y/I.sampleCount);for(let q=0;q<O;q++)this.centroidVertexArray.emplaceBack(B,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,y)}processPolygon(t,l,d,y,T){if(y.length<1||mm(y[0]))return;for(const B of y)B.length!==0&&lu(t,B);const E={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=T.fill.getGranularityForZoomLevel(l.z),I=gs[d.type]==="Polygon";for(const B of y){if(B.length===0||mm(B))continue;const $=xc(B,A,I);this._generateSideFaces($,E)}if(!I)return;const L=Gg(y,l,A,!1),O=this.layoutVertexArray;um((B,$)=>{so(O,B,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,L.verticesFlattened,L.indicesTriangles)}_generateSideFaces(t,l){let d=0;for(let y=1;y<t.length;y++){const T=t[y],E=t[y-1];if(Wg(T,E))continue;l.segment.vertexLength+4>pn.MAX_VERTEX_ARRAY_LENGTH&&(l.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=T.sub(E)._perp()._unit(),I=E.dist(T);d+I>32768&&(d=0),so(this.layoutVertexArray,T.x,T.y,A.x,A.y,0,0,d),so(this.layoutVertexArray,T.x,T.y,A.x,A.y,0,1,d),d+=I,so(this.layoutVertexArray,E.x,E.y,A.x,A.y,0,0,d),so(this.layoutVertexArray,E.x,E.y,A.x,A.y,0,1,d);const L=l.segment.vertexLength;this.indexArray.emplaceBack(L,L+2,L+1),this.indexArray.emplaceBack(L+1,L+2,L+3),l.segment.vertexLength+=4,l.segment.primitiveLength+=2}}}function lu(o,t){for(let l=0;l<t.length;l++){const d=t[l];l===t.length-1&&t[0].x===d.x&&t[0].y===d.y||(o.x+=d.x,o.y+=d.y,o.sampleCount++)}}function Wg(o,t){return o.x===t.x&&(o.x<0||o.x>Oe)||o.y===t.y&&(o.y<0||o.y>Oe)}function mm(o){return o.every(t=>t.x<0)||o.every(t=>t.x>Oe)||o.every(t=>t.y<0)||o.every(t=>t.y>Oe)}let Vo;Lt("FillExtrusionBucket",bc,{omit:["layers","features"]});var Q_={get paint(){return Vo=Vo||new Lr({"fill-extrusion-opacity":new Zt(X["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ht(X["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(X["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(X["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new rh(X["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ht(X["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ht(X["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(X["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class jd extends Nr{constructor(t){super(t,Q_)}createBucket(t){return new bc(t)}queryRadius(){return Ld(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:l,featureState:d,geometry:y,transform:T,pixelsToTileUnits:E,pixelPosMatrix:A}){const I=Yf(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,E),L=this.paint.get("fill-extrusion-height").evaluate(l,d),O=this.paint.get("fill-extrusion-base").evaluate(l,d),B=function(q,W,J){const le=[];for(const fe of q){const Ee=[fe.x,fe.y,0,1];Ot(Ee,Ee,W),le.push(new ie(Ee[0]/Ee[3],Ee[1]/Ee[3]))}return le}(I,A),$=function(q,W,J,le){const fe=[],Ee=[],ye=le[8]*W,Y=le[9]*W,oe=le[10]*W,ve=le[11]*W,Ve=le[8]*J,pt=le[9]*J,qe=le[10]*J,tt=le[11]*J;for(const wt of q){const ft=[],Tt=[];for(const ot of wt){const Pt=ot.x,Jt=ot.y,Xt=le[0]*Pt+le[4]*Jt+le[12],Gt=le[1]*Pt+le[5]*Jt+le[13],Sn=le[2]*Pt+le[6]*Jt+le[14],ji=le[3]*Pt+le[7]*Jt+le[15],nr=Sn+oe,jr=ji+ve,ga=Xt+Ve,Ra=Gt+pt,Br=Sn+qe,bi=ji+tt,ur=new ie((Xt+ye)/jr,(Gt+Y)/jr);ur.z=nr/jr,ft.push(ur);const hr=new ie(ga/bi,Ra/bi);hr.z=Br/bi,Tt.push(hr)}fe.push(ft),Ee.push(Tt)}return[fe,Ee]}(y,O,L,A);return function(q,W,J){let le=1/0;Rg(J,W)&&(le=Bd(J,W[0]));for(let fe=0;fe<W.length;fe++){const Ee=W[fe],ye=q[fe];for(let Y=0;Y<Ee.length-1;Y++){const oe=Ee[Y],ve=[oe,Ee[Y+1],ye[Y+1],ye[Y],oe];uh(J,ve)&&(le=Math.min(le,Bd(J,ve)))}}return le!==1/0&&le}($[0],$[1],B)}}function wc(o,t){return o.x*t.x+o.y*t.y}function Bd(o,t){if(o.length===1){let l=0;const d=t[l++];let y;for(;!y||d.equals(y);)if(y=t[l++],!y)return 1/0;for(;l<t.length;l++){const T=t[l],E=o[0],A=y.sub(d),I=T.sub(d),L=E.sub(d),O=wc(A,A),B=wc(A,I),$=wc(I,I),q=wc(L,A),W=wc(L,I),J=O*$-B*B,le=($*q-B*W)/J,fe=(O*W-B*q)/J,Ee=d.z*(1-le-fe)+y.z*le+T.z*fe;if(isFinite(Ee))return Ee}return 1/0}{let l=1/0;for(const d of t)l=Math.min(l,d.z);return l}}const Fd=on([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:K_}=Fd,J_=on([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Jf}=J_,e0=Od.VectorTileFeature.types,gm=Math.cos(Math.PI/180*37.5),Qg=Math.pow(2,14)/.5;class Kg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Me,this.layoutVertexArray2=new Ge,this.indexArray=new ut,this.programConfigurations=new no(t.layers,t.zoom),this.segments=new pn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,d){this.hasPattern=Wf("line",this.layers,l);const y=this.layers[0].layout.get("line-sort-key"),T=!y.isConstant(),E=[];for(const{feature:A,id:I,index:L,sourceLayerIndex:O}of t){const B=this.layers[0]._featureFilter.needGeometry,$=ps(A,B);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),$,d))continue;const q=T?y.evaluate($,{},d):void 0,W={id:I,properties:A.properties,type:A.type,sourceLayerIndex:O,index:L,geometry:B?$.geometry:Ya(A),patterns:{},sortKey:q};E.push(W)}T&&E.sort((A,I)=>A.sortKey-I.sortKey);for(const A of E){const{geometry:I,index:L,sourceLayerIndex:O}=A;if(this.hasPattern){const B=lm("line",this.layers,A,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(A,I,L,d,{},l.subdivisionGranularity);l.featureIndex.insert(t[L].feature,I,L,O,this.index)}}update(t,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,d)}addFeatures(t,l,d){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,l,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Jf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,K_),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,l,d,y,T,E){const A=this.layers[0].layout,I=A.get("line-join").evaluate(t,{}),L=A.get("line-cap"),O=A.get("line-miter-limit"),B=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const $ of l)this.addLine($,t,I,L,O,B,y,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,y)}addLine(t,l,d,y,T,E,A,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=xc(t,A?I.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<t.length-1;ye++)this.totalDistance+=t[ye].dist(t[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=e0[l.type]==="Polygon";let O=t.length;for(;O>=2&&t[O-1].equals(t[O-2]);)O--;let B=0;for(;B<O-1&&t[B].equals(t[B+1]);)B++;if(O<(L?3:2))return;d==="bevel"&&(T=1.05);const $=this.overscaling<=16?15*Oe/(512*this.overscaling):0,q=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let W,J,le,fe,Ee;this.e1=this.e2=-1,L&&(W=t[O-2],Ee=t[B].sub(W)._unit()._perp());for(let ye=B;ye<O;ye++){if(le=ye===O-1?L?t[B+1]:void 0:t[ye+1],le&&t[ye].equals(le))continue;Ee&&(fe=Ee),W&&(J=W),W=t[ye],Ee=le?le.sub(W)._unit()._perp():fe,fe=fe||Ee;let Y=fe.add(Ee);Y.x===0&&Y.y===0||Y._unit();const oe=fe.x*Ee.x+fe.y*Ee.y,ve=Y.x*Ee.x+Y.y*Ee.y,Ve=ve!==0?1/ve:1/0,pt=2*Math.sqrt(2-2*ve),qe=ve<gm&&J&&le,tt=fe.x*Ee.y-fe.y*Ee.x>0;if(qe&&ye>B){const Tt=W.dist(J);if(Tt>2*$){const ot=W.sub(W.sub(J)._mult($/Tt)._round());this.updateDistance(J,ot),this.addCurrentVertex(ot,fe,0,0,q),J=ot}}const wt=J&&le;let ft=wt?d:L?"butt":y;if(wt&&ft==="round"&&(Ve<E?ft="miter":Ve<=2&&(ft="fakeround")),ft==="miter"&&Ve>T&&(ft="bevel"),ft==="bevel"&&(Ve>2&&(ft="flipbevel"),Ve<T&&(ft="miter")),J&&this.updateDistance(J,W),ft==="miter")Y._mult(Ve),this.addCurrentVertex(W,Y,0,0,q);else if(ft==="flipbevel"){if(Ve>100)Y=Ee.mult(-1);else{const Tt=Ve*fe.add(Ee).mag()/fe.sub(Ee).mag();Y._perp()._mult(Tt*(tt?-1:1))}this.addCurrentVertex(W,Y,0,0,q),this.addCurrentVertex(W,Y.mult(-1),0,0,q)}else if(ft==="bevel"||ft==="fakeround"){const Tt=-Math.sqrt(Ve*Ve-1),ot=tt?Tt:0,Pt=tt?0:Tt;if(J&&this.addCurrentVertex(W,fe,ot,Pt,q),ft==="fakeround"){const Jt=Math.round(180*pt/Math.PI/20);for(let Xt=1;Xt<Jt;Xt++){let Gt=Xt/Jt;if(Gt!==.5){const ji=Gt-.5;Gt+=Gt*ji*(Gt-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*ji*ji+(.848013+oe*(.215638*oe-1.06021)))}const Sn=Ee.sub(fe)._mult(Gt)._add(fe)._unit()._mult(tt?-1:1);this.addHalfVertex(W,Sn.x,Sn.y,!1,tt,0,q)}}le&&this.addCurrentVertex(W,Ee,-ot,-Pt,q)}else if(ft==="butt")this.addCurrentVertex(W,Y,0,0,q);else if(ft==="square"){const Tt=J?1:-1;this.addCurrentVertex(W,Y,Tt,Tt,q)}else ft==="round"&&(J&&(this.addCurrentVertex(W,fe,0,0,q),this.addCurrentVertex(W,fe,1,1,q,!0)),le&&(this.addCurrentVertex(W,Ee,-1,-1,q,!0),this.addCurrentVertex(W,Ee,0,0,q)));if(qe&&ye<O-1){const Tt=W.dist(le);if(Tt>2*$){const ot=W.add(le.sub(W)._mult($/Tt)._round());this.updateDistance(W,ot),this.addCurrentVertex(ot,Ee,0,0,q),W=ot}}}}addCurrentVertex(t,l,d,y,T,E=!1){const A=l.y*y-l.x,I=-l.y-l.x*y;this.addHalfVertex(t,l.x+l.y*d,l.y-l.x*d,E,!1,d,T),this.addHalfVertex(t,A,I,E,!0,-y,T),this.distance>Qg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,l,d,y,T,E))}addHalfVertex({x:t,y:l},d,y,T,E,A,I){const L=.5*(this.lineClips?this.scaledDistance*(Qg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(T?1:0),(l<<1)+(E?1:0),Math.round(63*d)+128,Math.round(63*y)+128,1+(A===0?0:A<0?-1:1)|(63&L)<<2,L>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,O,this.e2),I.primitiveLength++),E?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,l){this.distance+=t.dist(l),this.updateScaledDistance()}}let t0,si;Lt("LineBucket",Kg,{omit:["layers","patternFeatures"]});var Ii={get paint(){return si=si||new Lr({"line-opacity":new Ht(X.paint_line["line-opacity"]),"line-color":new Ht(X.paint_line["line-color"]),"line-translate":new Zt(X.paint_line["line-translate"]),"line-translate-anchor":new Zt(X.paint_line["line-translate-anchor"]),"line-width":new Ht(X.paint_line["line-width"]),"line-gap-width":new Ht(X.paint_line["line-gap-width"]),"line-offset":new Ht(X.paint_line["line-offset"]),"line-blur":new Ht(X.paint_line["line-blur"]),"line-dasharray":new Rd(X.paint_line["line-dasharray"]),"line-pattern":new rh(X.paint_line["line-pattern"]),"line-gradient":new yl(X.paint_line["line-gradient"])})},get layout(){return t0=t0||new Lr({"line-cap":new Zt(X.layout_line["line-cap"]),"line-join":new Ht(X.layout_line["line-join"]),"line-miter-limit":new Zt(X.layout_line["line-miter-limit"]),"line-round-limit":new Zt(X.layout_line["line-round-limit"]),"line-sort-key":new Ht(X.layout_line["line-sort-key"])})}};class Nn extends Ht{possiblyEvaluate(t,l){return l=new ci(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(t,l)}evaluate(t,l,d,y){return l=Yt({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(t,l,d,y)}}let Pn;class di extends Nr{constructor(t){super(t,Ii),this.gradientVersion=0,Pn||(Pn=new Nn(Ii.paint.properties["line-width"].specification),Pn.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!function(d){return d._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof al,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,l){super.recalculate(t,l),this.paint._values["line-floorwidth"]=Pn.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Kg(t)}queryRadius(t){const l=t,d=Wa(hh("line-width",this,l),hh("line-gap-width",this,l)),y=hh("line-offset",this,l);return d/2+Math.abs(y)+Ld(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:l,featureState:d,geometry:y,transform:T,pixelsToTileUnits:E}){const A=Yf(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,E),I=E/2*Wa(this.paint.get("line-width").evaluate(l,d),this.paint.get("line-gap-width").evaluate(l,d)),L=this.paint.get("line-offset").evaluate(l,d);return L&&(y=function(O,B){const $=[];for(let q=0;q<O.length;q++){const W=O[q],J=[];for(let le=0;le<W.length;le++){const fe=W[le-1],Ee=W[le],ye=W[le+1],Y=le===0?new ie(0,0):Ee.sub(fe)._unit()._perp(),oe=le===W.length-1?new ie(0,0):ye.sub(Ee)._unit()._perp(),ve=Y._add(oe)._unit(),Ve=ve.x*oe.x+ve.y*oe.y;Ve!==0&&ve._mult(1/Ve),J.push(ve._mult(B)._add(Ee))}$.push(J)}return $}(y,L*E)),function(O,B,$){for(let q=0;q<B.length;q++){const W=B[q];if(O.length>=3){for(let J=0;J<W.length;J++)if(Ui(O,W[J]))return!0}if(io(O,W,$))return!0}return!1}(A,y,I)}isTileClipped(){return!0}}function Wa(o,t){return t>0?t+2*o:o}const cu=on([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ud=on([{name:"a_projected_pos",components:3,type:"Float32"}],4);on([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Jg=on([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);on([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Cl=on([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cr=on([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function uu(o,t,l){return o.sections.forEach(d=>{d.text=function(y,T,E){const A=T.layout.get("text-transform").evaluate(E,{});return A==="uppercase"?y=y.toLocaleUpperCase():A==="lowercase"&&(y=y.toLocaleLowerCase()),Qs.applyArabicShaping&&(y=Qs.applyArabicShaping(y)),y}(d.text,t,l)}),o}on([{name:"triangle",components:3,type:"Uint16"}]),on([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),on([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),on([{type:"Float32",name:"offsetX"}]),on([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),on([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Zo={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ym,Qa,_h,Vi=24,pa={};function ey(){return ym||(ym=1,pa.read=function(o,t,l,d,y){var T,E,A=8*y-d-1,I=(1<<A)-1,L=I>>1,O=-7,B=l?y-1:0,$=l?-1:1,q=o[t+B];for(B+=$,T=q&(1<<-O)-1,q>>=-O,O+=A;O>0;T=256*T+o[t+B],B+=$,O-=8);for(E=T&(1<<-O)-1,T>>=-O,O+=d;O>0;E=256*E+o[t+B],B+=$,O-=8);if(T===0)T=1-L;else{if(T===I)return E?NaN:1/0*(q?-1:1);E+=Math.pow(2,d),T-=L}return(q?-1:1)*E*Math.pow(2,T-d)},pa.write=function(o,t,l,d,y,T){var E,A,I,L=8*T-y-1,O=(1<<L)-1,B=O>>1,$=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=d?0:T-1,W=d?1:-1,J=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(A=isNaN(t)?1:0,E=O):(E=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-E))<1&&(E--,I*=2),(t+=E+B>=1?$/I:$*Math.pow(2,1-B))*I>=2&&(E++,I/=2),E+B>=O?(A=0,E=O):E+B>=1?(A=(t*I-1)*Math.pow(2,y),E+=B):(A=t*Math.pow(2,B-1)*Math.pow(2,y),E=0));y>=8;o[l+q]=255&A,q+=W,A/=256,y-=8);for(E=E<<y|A,L+=y;L>0;o[l+q]=255&E,q+=W,E/=256,L-=8);o[l+q-W]|=128*J}),pa}function _m(){if(_h)return Qa;_h=1,Qa=t;var o=ey();function t(Y){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Y)?Y:new Uint8Array(Y||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var l=4294967296,d=1/l,y=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function T(Y){return Y.type===t.Bytes?Y.readVarint()+Y.pos:Y.pos+1}function E(Y,oe,ve){return ve?4294967296*oe+(Y>>>0):4294967296*(oe>>>0)+(Y>>>0)}function A(Y,oe,ve){var Ve=oe<=16383?1:oe<=2097151?2:oe<=268435455?3:Math.floor(Math.log(oe)/(7*Math.LN2));ve.realloc(Ve);for(var pt=ve.pos-1;pt>=Y;pt--)ve.buf[pt+Ve]=ve.buf[pt]}function I(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeVarint(Y[ve])}function L(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeSVarint(Y[ve])}function O(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeFloat(Y[ve])}function B(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeDouble(Y[ve])}function $(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeBoolean(Y[ve])}function q(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeFixed32(Y[ve])}function W(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeSFixed32(Y[ve])}function J(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeFixed64(Y[ve])}function le(Y,oe){for(var ve=0;ve<Y.length;ve++)oe.writeSFixed64(Y[ve])}function fe(Y,oe){return(Y[oe]|Y[oe+1]<<8|Y[oe+2]<<16)+16777216*Y[oe+3]}function Ee(Y,oe,ve){Y[ve]=oe,Y[ve+1]=oe>>>8,Y[ve+2]=oe>>>16,Y[ve+3]=oe>>>24}function ye(Y,oe){return(Y[oe]|Y[oe+1]<<8|Y[oe+2]<<16)+(Y[oe+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(Y,oe,ve){for(ve=ve||this.length;this.pos<ve;){var Ve=this.readVarint(),pt=Ve>>3,qe=this.pos;this.type=7&Ve,Y(pt,oe,this),this.pos===qe&&this.skip(Ve)}return oe},readMessage:function(Y,oe){return this.readFields(Y,oe,this.readVarint()+this.pos)},readFixed32:function(){var Y=fe(this.buf,this.pos);return this.pos+=4,Y},readSFixed32:function(){var Y=ye(this.buf,this.pos);return this.pos+=4,Y},readFixed64:function(){var Y=fe(this.buf,this.pos)+fe(this.buf,this.pos+4)*l;return this.pos+=8,Y},readSFixed64:function(){var Y=fe(this.buf,this.pos)+ye(this.buf,this.pos+4)*l;return this.pos+=8,Y},readFloat:function(){var Y=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Y},readDouble:function(){var Y=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Y},readVarint:function(Y){var oe,ve,Ve=this.buf;return oe=127&(ve=Ve[this.pos++]),ve<128?oe:(oe|=(127&(ve=Ve[this.pos++]))<<7,ve<128?oe:(oe|=(127&(ve=Ve[this.pos++]))<<14,ve<128?oe:(oe|=(127&(ve=Ve[this.pos++]))<<21,ve<128?oe:function(pt,qe,tt){var wt,ft,Tt=tt.buf;if(wt=(112&(ft=Tt[tt.pos++]))>>4,ft<128||(wt|=(127&(ft=Tt[tt.pos++]))<<3,ft<128)||(wt|=(127&(ft=Tt[tt.pos++]))<<10,ft<128)||(wt|=(127&(ft=Tt[tt.pos++]))<<17,ft<128)||(wt|=(127&(ft=Tt[tt.pos++]))<<24,ft<128)||(wt|=(1&(ft=Tt[tt.pos++]))<<31,ft<128))return E(pt,wt,qe);throw new Error("Expected varint not more than 10 bytes")}(oe|=(15&(ve=Ve[this.pos]))<<28,Y,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Y=this.readVarint();return Y%2==1?(Y+1)/-2:Y/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Y=this.readVarint()+this.pos,oe=this.pos;return this.pos=Y,Y-oe>=12&&y?function(ve,Ve,pt){return y.decode(ve.subarray(Ve,pt))}(this.buf,oe,Y):function(ve,Ve,pt){for(var qe="",tt=Ve;tt<pt;){var wt,ft,Tt,ot=ve[tt],Pt=null,Jt=ot>239?4:ot>223?3:ot>191?2:1;if(tt+Jt>pt)break;Jt===1?ot<128&&(Pt=ot):Jt===2?(192&(wt=ve[tt+1]))==128&&(Pt=(31&ot)<<6|63&wt)<=127&&(Pt=null):Jt===3?(ft=ve[tt+2],(192&(wt=ve[tt+1]))==128&&(192&ft)==128&&((Pt=(15&ot)<<12|(63&wt)<<6|63&ft)<=2047||Pt>=55296&&Pt<=57343)&&(Pt=null)):Jt===4&&(ft=ve[tt+2],Tt=ve[tt+3],(192&(wt=ve[tt+1]))==128&&(192&ft)==128&&(192&Tt)==128&&((Pt=(15&ot)<<18|(63&wt)<<12|(63&ft)<<6|63&Tt)<=65535||Pt>=1114112)&&(Pt=null)),Pt===null?(Pt=65533,Jt=1):Pt>65535&&(Pt-=65536,qe+=String.fromCharCode(Pt>>>10&1023|55296),Pt=56320|1023&Pt),qe+=String.fromCharCode(Pt),tt+=Jt}return qe}(this.buf,oe,Y)},readBytes:function(){var Y=this.readVarint()+this.pos,oe=this.buf.subarray(this.pos,Y);return this.pos=Y,oe},readPackedVarint:function(Y,oe){if(this.type!==t.Bytes)return Y.push(this.readVarint(oe));var ve=T(this);for(Y=Y||[];this.pos<ve;)Y.push(this.readVarint(oe));return Y},readPackedSVarint:function(Y){if(this.type!==t.Bytes)return Y.push(this.readSVarint());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readSVarint());return Y},readPackedBoolean:function(Y){if(this.type!==t.Bytes)return Y.push(this.readBoolean());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readBoolean());return Y},readPackedFloat:function(Y){if(this.type!==t.Bytes)return Y.push(this.readFloat());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readFloat());return Y},readPackedDouble:function(Y){if(this.type!==t.Bytes)return Y.push(this.readDouble());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readDouble());return Y},readPackedFixed32:function(Y){if(this.type!==t.Bytes)return Y.push(this.readFixed32());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readFixed32());return Y},readPackedSFixed32:function(Y){if(this.type!==t.Bytes)return Y.push(this.readSFixed32());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readSFixed32());return Y},readPackedFixed64:function(Y){if(this.type!==t.Bytes)return Y.push(this.readFixed64());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readFixed64());return Y},readPackedSFixed64:function(Y){if(this.type!==t.Bytes)return Y.push(this.readSFixed64());var oe=T(this);for(Y=Y||[];this.pos<oe;)Y.push(this.readSFixed64());return Y},skip:function(Y){var oe=7&Y;if(oe===t.Varint)for(;this.buf[this.pos++]>127;);else if(oe===t.Bytes)this.pos=this.readVarint()+this.pos;else if(oe===t.Fixed32)this.pos+=4;else{if(oe!==t.Fixed64)throw new Error("Unimplemented type: "+oe);this.pos+=8}},writeTag:function(Y,oe){this.writeVarint(Y<<3|oe)},realloc:function(Y){for(var oe=this.length||16;oe<this.pos+Y;)oe*=2;if(oe!==this.length){var ve=new Uint8Array(oe);ve.set(this.buf),this.buf=ve,this.length=oe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Y){this.realloc(4),Ee(this.buf,Y,this.pos),this.pos+=4},writeSFixed32:function(Y){this.realloc(4),Ee(this.buf,Y,this.pos),this.pos+=4},writeFixed64:function(Y){this.realloc(8),Ee(this.buf,-1&Y,this.pos),Ee(this.buf,Math.floor(Y*d),this.pos+4),this.pos+=8},writeSFixed64:function(Y){this.realloc(8),Ee(this.buf,-1&Y,this.pos),Ee(this.buf,Math.floor(Y*d),this.pos+4),this.pos+=8},writeVarint:function(Y){(Y=+Y||0)>268435455||Y<0?function(oe,ve){var Ve,pt;if(oe>=0?(Ve=oe%4294967296|0,pt=oe/4294967296|0):(pt=~(-oe/4294967296),4294967295^(Ve=~(-oe%4294967296))?Ve=Ve+1|0:(Ve=0,pt=pt+1|0)),oe>=18446744073709552e3||oe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(qe,tt,wt){wt.buf[wt.pos++]=127&qe|128,qe>>>=7,wt.buf[wt.pos++]=127&qe|128,qe>>>=7,wt.buf[wt.pos++]=127&qe|128,qe>>>=7,wt.buf[wt.pos++]=127&qe|128,wt.buf[wt.pos]=127&(qe>>>=7)}(Ve,0,ve),function(qe,tt){var wt=(7&qe)<<4;tt.buf[tt.pos++]|=wt|((qe>>>=3)?128:0),qe&&(tt.buf[tt.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(tt.buf[tt.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(tt.buf[tt.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(tt.buf[tt.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(tt.buf[tt.pos++]=127&qe)))))}(pt,ve)}(Y,this):(this.realloc(4),this.buf[this.pos++]=127&Y|(Y>127?128:0),Y<=127||(this.buf[this.pos++]=127&(Y>>>=7)|(Y>127?128:0),Y<=127||(this.buf[this.pos++]=127&(Y>>>=7)|(Y>127?128:0),Y<=127||(this.buf[this.pos++]=Y>>>7&127))))},writeSVarint:function(Y){this.writeVarint(Y<0?2*-Y-1:2*Y)},writeBoolean:function(Y){this.writeVarint(!!Y)},writeString:function(Y){Y=String(Y),this.realloc(4*Y.length),this.pos++;var oe=this.pos;this.pos=function(Ve,pt,qe){for(var tt,wt,ft=0;ft<pt.length;ft++){if((tt=pt.charCodeAt(ft))>55295&&tt<57344){if(!wt){tt>56319||ft+1===pt.length?(Ve[qe++]=239,Ve[qe++]=191,Ve[qe++]=189):wt=tt;continue}if(tt<56320){Ve[qe++]=239,Ve[qe++]=191,Ve[qe++]=189,wt=tt;continue}tt=wt-55296<<10|tt-56320|65536,wt=null}else wt&&(Ve[qe++]=239,Ve[qe++]=191,Ve[qe++]=189,wt=null);tt<128?Ve[qe++]=tt:(tt<2048?Ve[qe++]=tt>>6|192:(tt<65536?Ve[qe++]=tt>>12|224:(Ve[qe++]=tt>>18|240,Ve[qe++]=tt>>12&63|128),Ve[qe++]=tt>>6&63|128),Ve[qe++]=63&tt|128)}return qe}(this.buf,Y,this.pos);var ve=this.pos-oe;ve>=128&&A(oe,ve,this),this.pos=oe-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(Y){this.realloc(4),o.write(this.buf,Y,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Y){this.realloc(8),o.write(this.buf,Y,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Y){var oe=Y.length;this.writeVarint(oe),this.realloc(oe);for(var ve=0;ve<oe;ve++)this.buf[this.pos++]=Y[ve]},writeRawMessage:function(Y,oe){this.pos++;var ve=this.pos;Y(oe,this);var Ve=this.pos-ve;Ve>=128&&A(ve,Ve,this),this.pos=ve-1,this.writeVarint(Ve),this.pos+=Ve},writeMessage:function(Y,oe,ve){this.writeTag(Y,t.Bytes),this.writeRawMessage(oe,ve)},writePackedVarint:function(Y,oe){oe.length&&this.writeMessage(Y,I,oe)},writePackedSVarint:function(Y,oe){oe.length&&this.writeMessage(Y,L,oe)},writePackedBoolean:function(Y,oe){oe.length&&this.writeMessage(Y,$,oe)},writePackedFloat:function(Y,oe){oe.length&&this.writeMessage(Y,O,oe)},writePackedDouble:function(Y,oe){oe.length&&this.writeMessage(Y,B,oe)},writePackedFixed32:function(Y,oe){oe.length&&this.writeMessage(Y,q,oe)},writePackedSFixed32:function(Y,oe){oe.length&&this.writeMessage(Y,W,oe)},writePackedFixed64:function(Y,oe){oe.length&&this.writeMessage(Y,J,oe)},writePackedSFixed64:function(Y,oe){oe.length&&this.writeMessage(Y,le,oe)},writeBytesField:function(Y,oe){this.writeTag(Y,t.Bytes),this.writeBytes(oe)},writeFixed32Field:function(Y,oe){this.writeTag(Y,t.Fixed32),this.writeFixed32(oe)},writeSFixed32Field:function(Y,oe){this.writeTag(Y,t.Fixed32),this.writeSFixed32(oe)},writeFixed64Field:function(Y,oe){this.writeTag(Y,t.Fixed64),this.writeFixed64(oe)},writeSFixed64Field:function(Y,oe){this.writeTag(Y,t.Fixed64),this.writeSFixed64(oe)},writeVarintField:function(Y,oe){this.writeTag(Y,t.Varint),this.writeVarint(oe)},writeSVarintField:function(Y,oe){this.writeTag(Y,t.Varint),this.writeSVarint(oe)},writeStringField:function(Y,oe){this.writeTag(Y,t.Bytes),this.writeString(oe)},writeFloatField:function(Y,oe){this.writeTag(Y,t.Fixed32),this.writeFloat(oe)},writeDoubleField:function(Y,oe){this.writeTag(Y,t.Fixed64),this.writeDouble(oe)},writeBooleanField:function(Y,oe){this.writeVarintField(Y,!!oe)}},Qa}var Vd=C(_m());const Zd=3;function hu(o,t,l){o===1&&l.readMessage(ta,t)}function ta(o,t,l){if(o===3){const{id:d,bitmap:y,width:T,height:E,left:A,top:I,advance:L}=l.readMessage(du,{});t.push({id:d,bitmap:new Xf({width:T+2*Zd,height:E+2*Zd},y),metrics:{width:T,height:E,left:A,top:I,advance:L}})}}function du(o,t,l){o===1?t.id=l.readVarint():o===2?t.bitmap=l.readBytes():o===3?t.width=l.readVarint():o===4?t.height=l.readVarint():o===5?t.left=l.readSVarint():o===6?t.top=l.readSVarint():o===7&&(t.advance=l.readVarint())}const Gd=Zd;function vh(o){let t=0,l=0;for(const E of o)t+=E.w*E.h,l=Math.max(l,E.w);o.sort((E,A)=>A.h-E.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),l),h:1/0}];let y=0,T=0;for(const E of o)for(let A=d.length-1;A>=0;A--){const I=d[A];if(!(E.w>I.w||E.h>I.h)){if(E.x=I.x,E.y=I.y,T=Math.max(T,E.y+E.h),y=Math.max(y,E.x+E.w),E.w===I.w&&E.h===I.h){const L=d.pop();A<d.length&&(d[A]=L)}else E.h===I.h?(I.x+=E.w,I.w-=E.w):E.w===I.w?(I.y+=E.h,I.h-=E.h):(d.push({x:I.x+E.w,y:I.y,w:I.w-E.w,h:E.h}),I.y+=E.h,I.h-=E.h);break}}return{w:y,h:T,fill:t/(y*T)||0}}const na=1;class ep{constructor(t,{pixelRatio:l,version:d,stretchX:y,stretchY:T,content:E,textFitWidth:A,textFitHeight:I}){this.paddedRect=t,this.pixelRatio=l,this.stretchX=y,this.stretchY=T,this.content=E,this.version=d,this.textFitWidth=A,this.textFitHeight=I}get tl(){return[this.paddedRect.x+na,this.paddedRect.y+na]}get br(){return[this.paddedRect.x+this.paddedRect.w-na,this.paddedRect.y+this.paddedRect.h-na]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*na)/this.pixelRatio,(this.paddedRect.h-2*na)/this.pixelRatio]}}class ty{constructor(t,l){const d={},y={};this.haveRenderCallbacks=[];const T=[];this.addImages(t,d,T),this.addImages(l,y,T);const{w:E,h:A}=vh(T),I=new qa({width:E||1,height:A||1});for(const L in t){const O=t[L],B=d[L].paddedRect;qa.copy(O.data,I,{x:0,y:0},{x:B.x+na,y:B.y+na},O.data)}for(const L in l){const O=l[L],B=y[L].paddedRect,$=B.x+na,q=B.y+na,W=O.data.width,J=O.data.height;qa.copy(O.data,I,{x:0,y:0},{x:$,y:q},O.data),qa.copy(O.data,I,{x:0,y:J-1},{x:$,y:q-1},{width:W,height:1}),qa.copy(O.data,I,{x:0,y:0},{x:$,y:q+J},{width:W,height:1}),qa.copy(O.data,I,{x:W-1,y:0},{x:$-1,y:q},{width:1,height:J}),qa.copy(O.data,I,{x:0,y:0},{x:$+W,y:q},{width:1,height:J})}this.image=I,this.iconPositions=d,this.patternPositions=y}addImages(t,l,d){for(const y in t){const T=t[y],E={x:0,y:0,w:T.data.width+2*na,h:T.data.height+2*na};d.push(E),l[y]=new ep(E,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(t,l){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in t.updatedImages)this.patchUpdatedImage(this.iconPositions[d],t.getImage(d),l),this.patchUpdatedImage(this.patternPositions[d],t.getImage(d),l)}patchUpdatedImage(t,l,d){if(!t||!l||t.version===l.version)return;t.version=l.version;const[y,T]=t.tl;d.update(l.data,void 0,{x:y,y:T})}}var oo;Lt("ImagePosition",ep),Lt("ImageAtlas",ty),v.ah=void 0,(oo=v.ah||(v.ah={}))[oo.none=0]="none",oo[oo.horizontal=1]="horizontal",oo[oo.vertical=2]="vertical",oo[oo.horizontalOnly=3]="horizontalOnly";const $d=-17;class ia{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,l,d){const y=new ia;return y.scale=t||1,y.fontStack=l,y.verticalAlign=d||"bottom",y}static forImage(t,l){const d=new ia;return d.imageName=t,d.verticalAlign=l||"bottom",d}}class xh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,l){const d=new xh;for(let y=0;y<t.sections.length;y++){const T=t.sections[y];T.image?d.addImageSection(T):d.addTextSection(T,l)}return d}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let l="";for(let d=0;d<t.length;d++){const y=t.charCodeAt(d+1)||null,T=t.charCodeAt(d-1)||null;l+=y&&th(y)&&!Zo[t[d+1]]||T&&th(T)&&!Zo[t[d-1]]||!Zo[t[d]]?t[d]:Zo[t[d]]}return l}(this.text)}trim(){let t=0;for(let d=0;d<this.text.length&&tp[this.text.charCodeAt(d)];d++)t++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=t&&tp[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(t,l),this.sectionIndex=this.sectionIndex.slice(t,l)}substring(t,l){const d=new xh;return d.text=this.text.substring(t,l),d.sectionIndex=this.sectionIndex.slice(t,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,l)=>Math.max(t,this.sections[l].scale),0)}getMaxImageSize(t){let l=0,d=0;for(let y=0;y<this.length();y++){const T=this.getSection(y);if(T.imageName){const E=t[T.imageName];if(!E)continue;const A=E.displaySize;l=Math.max(l,A[0]),d=Math.max(d,A[1])}}return{maxImageWidth:l,maxImageHeight:d}}addTextSection(t,l){this.text+=t.text,this.sections.push(ia.forText(t.scale,t.fontStack||l,t.verticalAlign));const d=this.sections.length-1;for(let y=0;y<t.text.length;++y)this.sectionIndex.push(d)}addImageSection(t){const l=t.image?t.image.name:"";if(l.length===0)return void Mi("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(ia.forImage(l,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Mi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ma(o,t,l,d,y,T,E,A,I,L,O,B,$,q,W){const J=xh.fromFeature(o,y);let le;B===v.ah.vertical&&J.verticalizePunctuation();const{processBidirectionalText:fe,processStyledBidirectionalText:Ee}=Qs;if(fe&&J.sections.length===1){le=[];const oe=fe(J.toString(),vm(J,L,T,t,d,q));for(const ve of oe){const Ve=new xh;Ve.text=ve,Ve.sections=J.sections;for(let pt=0;pt<ve.length;pt++)Ve.sectionIndex.push(0);le.push(Ve)}}else if(Ee){le=[];const oe=Ee(J.text,J.sectionIndex,vm(J,L,T,t,d,q));for(const ve of oe){const Ve=new xh;Ve.text=ve[0],Ve.sectionIndex=ve[1],Ve.sections=J.sections,le.push(Ve)}}else le=function(oe,ve){const Ve=[],pt=oe.text;let qe=0;for(const tt of ve)Ve.push(oe.substring(qe,tt)),qe=tt;return qe<pt.length&&Ve.push(oe.substring(qe,pt.length)),Ve}(J,vm(J,L,T,t,d,q));const ye=[],Y={positionedLines:ye,text:J.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(oe,ve,Ve,pt,qe,tt,wt,ft,Tt,ot,Pt,Jt){let Xt=0,Gt=0,Sn=0,ji=0;const nr=ft==="right"?1:ft==="left"?0:.5,jr=Vi/Jt;let ga=0;for(const bi of qe){bi.trim();const ur=bi.getMaxScale(),hr={positionedGlyphs:[],lineOffset:0};oe.positionedLines[ga]=hr;const vr=hr.positionedGlyphs;let ra=0;if(!bi.length()){Gt+=tt,++ga;continue}const za=ry(pt,bi,jr);for(let dr=0;dr<bi.length();dr++){const wi=bi.getSection(dr),Xi=bi.getSectionIndex(dr),Wi=bi.getCharCode(dr),fi=Iv(Tt,Pt,Wi);let Ti;if(wi.imageName){if(oe.iconsInText=!0,wi.scale=wi.scale*jr,Ti=zv(wi,fi,ur,za,pt),!Ti)continue;ra=Math.max(ra,Ti.imageOffset)}else if(Ti=Rv(wi,Wi,fi,za,ve,Ve),!Ti)continue;const{rect:lo,metrics:kl,baselineOffset:$o}=Ti;vr.push({glyph:Wi,imageName:wi.imageName,x:Xt,y:Gt+$o+$d,vertical:fi,scale:wi.scale,fontStack:wi.fontStack,sectionIndex:Xi,metrics:kl,rect:lo}),fi?(oe.verticalizable=!0,Xt+=(wi.imageName?kl.advance:Vi)*wi.scale+ot):Xt+=kl.advance*wi.scale+ot}vr.length!==0&&(Sn=Math.max(Xt-ot,Sn),i0(vr,0,vr.length-1,nr)),Xt=0,hr.lineOffset=Math.max(ra,(ur-1)*Vi);const zi=tt*ur+ra;Gt+=zi,ji=Math.max(zi,ji),++ga}const{horizontalAlign:Ra,verticalAlign:Br}=xm(wt);(function(bi,ur,hr,vr,ra,za,zi,dr,wi){const Xi=(ur-hr)*ra;let Wi=0;Wi=za!==zi?-dr*vr-$d:-vr*wi*zi+.5*zi;for(const fi of bi)for(const Ti of fi.positionedGlyphs)Ti.x+=Xi,Ti.y+=Wi})(oe.positionedLines,nr,Ra,Br,Sn,ji,tt,Gt,qe.length),oe.top+=-Br*Gt,oe.bottom=oe.top+Gt,oe.left+=-Ra*Sn,oe.right=oe.left+Sn}(Y,t,l,d,le,E,A,I,B,L,$,W),!function(oe){for(const ve of oe)if(ve.positionedGlyphs.length!==0)return!1;return!0}(ye)&&Y}const tp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},n0={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},kv={40:!0};function Tc(o,t,l,d,y,T){if(t.imageName){const E=d[t.imageName];return E?E.displaySize[0]*t.scale*Vi/T+y:0}{const E=l[t.fontStack],A=E&&E[o];return A?A.metrics.advance*t.scale+y:0}}function np(o,t,l,d){const y=Math.pow(o-t,2);return d?o<t?y/2:2*y:y+Math.abs(l)*l}function ny(o,t,l){let d=0;return o===10&&(d-=1e4),l&&(d+=150),o!==40&&o!==65288||(d+=50),t!==41&&t!==65289||(d+=50),d}function bh(o,t,l,d,y,T){let E=null,A=np(t,l,y,T);for(const I of d){const L=np(t-I.x,l,y,T)+I.badness;L<=A&&(E=I,A=L)}return{index:o,x:t,priorBreak:E,badness:A}}function iy(o){return o?iy(o.priorBreak).concat(o.index):[]}function vm(o,t,l,d,y,T){if(!o)return[];const E=[],A=function(B,$,q,W,J,le){let fe=0;for(let Ee=0;Ee<B.length();Ee++){const ye=B.getSection(Ee);fe+=Tc(B.getCharCode(Ee),ye,W,J,$,le)}return fe/Math.max(1,Math.ceil(fe/q))}(o,t,l,d,y,T),I=o.text.indexOf("")>=0;let L=0;for(let B=0;B<o.length();B++){const $=o.getSection(B),q=o.getCharCode(B);if(tp[q]||(L+=Tc(q,$,d,y,t,T)),B<o.length()-1){const W=!((O=q)<11904)&&(!!bn["CJK Compatibility Forms"](O)||!!bn["CJK Compatibility"](O)||!!bn["CJK Strokes"](O)||!!bn["CJK Symbols and Punctuation"](O)||!!bn["Enclosed CJK Letters and Months"](O)||!!bn["Halfwidth and Fullwidth Forms"](O)||!!bn["Ideographic Description Characters"](O)||!!bn["Vertical Forms"](O)||Id.test(String.fromCodePoint(O)));(n0[q]||W||$.imageName||B!==o.length()-2&&kv[o.getCharCode(B+1)])&&E.push(bh(B+1,L,A,E,ny(q,o.getCharCode(B+1),W&&I),!1))}}var O;return iy(bh(o.length(),L,A,E,0,!0))}function xm(o){let t=.5,l=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:t,verticalAlign:l}}function ry(o,t,l){const d=t.getMaxScale()*Vi,{maxImageWidth:y,maxImageHeight:T}=t.getMaxImageSize(o),E=Math.max(d,T*l);return{verticalLineContentWidth:Math.max(d,y*l),horizontalLineContentHeight:E}}function bm(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function Iv(o,t,l){return!(o===v.ah.horizontal||!t&&!eu(l)||t&&(tp[l]||(d=l,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function Rv(o,t,l,d,y,T){const E=T[o.fontStack],A=function(L,O,B,$){if(L&&L.rect)return L;const q=O[B.fontStack],W=q&&q[$];return W?{rect:null,metrics:W.metrics}:null}(E&&E[t],y,o,t);if(A===null)return null;let I;if(l)I=d.verticalLineContentWidth-o.scale*Vi;else{const L=bm(o.verticalAlign);I=(d.horizontalLineContentHeight-o.scale*Vi)*L}return{rect:A.rect,metrics:A.metrics,baselineOffset:I}}function zv(o,t,l,d,y){const T=y[o.imageName];if(!T)return null;const E=T.paddedRect,A=T.displaySize,I={width:A[0],height:A[1],left:na,top:-3,advance:t?A[1]:A[0]};let L;if(t)L=d.verticalLineContentWidth-A[1]*o.scale;else{const O=bm(o.verticalAlign);L=(d.horizontalLineContentHeight-A[1]*o.scale)*O}return{rect:E,metrics:I,baselineOffset:L,imageOffset:(t?A[0]:A[1])*o.scale-Vi*l}}function i0(o,t,l,d){if(d===0)return;const y=o[l],T=(o[l].x+y.metrics.advance*y.scale)*d;for(let E=t;E<=l;E++)o[E].x-=T}function r0(o,t,l){const{horizontalAlign:d,verticalAlign:y}=xm(l),T=t[0]-o.displaySize[0]*d,E=t[1]-o.displaySize[1]*y;return{image:o,top:E,bottom:E+o.displaySize[1],left:T,right:T+o.displaySize[0]}}function wh(o){var t,l;let d=o.left,y=o.top,T=o.right-d,E=o.bottom-y;const A=(t=o.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",I=(l=o.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",L=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(I==="proportional"){if(A==="stretchOnly"&&T/E<L||A==="proportional"){const O=Math.ceil(E*L);d*=O/T,T=O}}else if(A==="proportional"&&I==="stretchOnly"&&L!==0&&T/E>L){const O=Math.ceil(T/L);y*=O/E,E=O}return{x1:d,y1:y,x2:d+T,y2:y+E}}function ip(o,t,l,d,y,T){const E=o.image;let A;if(E.content){const le=E.content,fe=E.pixelRatio||1;A=[le[0]/fe,le[1]/fe,E.displaySize[0]-le[2]/fe,E.displaySize[1]-le[3]/fe]}const I=t.left*T,L=t.right*T;let O,B,$,q;l==="width"||l==="both"?(q=y[0]+I-d[3],B=y[0]+L+d[1]):(q=y[0]+(I+L-E.displaySize[0])/2,B=q+E.displaySize[0]);const W=t.top*T,J=t.bottom*T;return l==="height"||l==="both"?(O=y[1]+W-d[0],$=y[1]+J+d[2]):(O=y[1]+(W+J-E.displaySize[1])/2,$=O+E.displaySize[1]),{image:E,top:O,right:B,bottom:$,left:q,collisionPadding:A}}const Yd=255,Go=128,Ec=Yd*Go;function ay(o,t){const{expression:l}=t;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new ci(o+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:y}=l;let T=0;for(;T<d.length&&d[T]<=o;)T++;T=Math.max(0,T-1);let E=T;for(;E<d.length&&d[E]<o+1;)E++;E=Math.min(d.length-1,E);const A=d[T],I=d[E];return l.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:I,interpolationType:y}:{kind:"camera",minZoom:A,maxZoom:I,minSize:l.evaluate(new ci(A)),maxSize:l.evaluate(new ci(I)),interpolationType:y}}}function wm(o,t,l){let d="never";const y=o.get(t);return y?d=y:o.get(l)&&(d="always"),d}const a0=Od.VectorTileFeature.types,Tm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rp(o,t,l,d,y,T,E,A,I,L,O,B,$){const q=A?Math.min(Ec,Math.round(A[0])):0,W=A?Math.min(Ec,Math.round(A[1])):0;o.emplaceBack(t,l,Math.round(32*d),Math.round(32*y),T,E,(q<<1)+(I?1:0),W,16*L,16*O,256*B,256*$)}function Em(o,t,l){o.emplaceBack(t.x,t.y,l),o.emplaceBack(t.x,t.y,l),o.emplaceBack(t.x,t.y,l),o.emplaceBack(t.x,t.y,l)}function Ri(o){for(const t of o.sections)if(nh(t.text))return!0;return!1}class ap{constructor(t){this.layoutVertexArray=new at,this.indexArray=new ut,this.programConfigurations=t,this.segments=new pn,this.dynamicLayoutVertexArray=new st,this.opacityVertexArray=new it,this.hasVisibleVertices=!1,this.placedSymbolArray=new F}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,l,d,y){this.isEmpty()||(d&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cu.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ud.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Tm,!0),this.opacityVertexBuffer.itemSize=1),(d||y)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Lt("SymbolBuffers",ap);class sy{constructor(t,l,d){this.layoutVertexArray=new t,this.layoutAttributes=l,this.indexArray=new d,this.segments=new pn,this.collisionVertexArray=new Et}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Jg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Lt("CollisionBuffers",sy);class Th{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(E=>E.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ay(this.zoom,l["text-size"]),this.iconSizeData=ay(this.zoom,l["icon-size"]);const d=this.layers[0].layout,y=d.get("symbol-sort-key"),T=d.get("symbol-z-order");this.canOverlap=wm(d,"text-overlap","text-allow-overlap")!=="never"||wm(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!y.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(E=>v.ah[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=t.sourceID}createArrays(){this.text=new ap(new no(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new ap(new no(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new K,this.lineVertexArray=new te,this.symbolInstances=new Z,this.textAnchorOffsets=new ue}calculateGlyphDependencies(t,l,d,y,T){for(let E=0;E<t.length;E++)if(l[t.charCodeAt(E)]=!0,(d||y)&&T){const A=Zo[t.charAt(E)];A&&(l[A.charCodeAt(0)]=!0)}}populate(t,l,d){const y=this.layers[0],T=y.layout,E=T.get("text-font"),A=T.get("text-field"),I=T.get("icon-image"),L=(A.value.kind!=="constant"||A.value.value instanceof Ur&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),O=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,B=T.get("symbol-sort-key");if(this.features=[],!L&&!O)return;const $=l.iconDependencies,q=l.glyphDependencies,W=l.availableImages,J=new ci(this.zoom);for(const{feature:le,id:fe,index:Ee,sourceLayerIndex:ye}of t){const Y=y._featureFilter.needGeometry,oe=ps(le,Y);if(!y._featureFilter.filter(J,oe,d))continue;let ve,Ve;if(Y||(oe.geometry=Ya(le)),L){const qe=y.getValueAndResolveTokens("text-field",oe,d,W),tt=Ur.factory(qe),wt=this.hasRTLText=this.hasRTLText||Ri(tt);(!wt||Qs.getRTLTextPluginStatus()==="unavailable"||wt&&Qs.isParsed())&&(ve=uu(tt,y,oe))}if(O){const qe=y.getValueAndResolveTokens("icon-image",oe,d,W);Ve=qe instanceof Vr?qe:Vr.fromString(qe)}if(!ve&&!Ve)continue;const pt=this.sortFeaturesByKey?B.evaluate(oe,{},d):void 0;if(this.features.push({id:fe,text:ve,icon:Ve,index:Ee,sourceLayerIndex:ye,geometry:oe.geometry,properties:le.properties,type:a0[le.type],sortKey:pt}),Ve&&($[Ve.name]=!0),ve){const qe=E.evaluate(oe,{},d).join(","),tt=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ah.vertical)>=0;for(const wt of ve.sections)if(wt.image)$[wt.image.name]=!0;else{const ft=Ws(ve.toString()),Tt=wt.fontStack||qe,ot=q[Tt]=q[Tt]||{};this.calculateGlyphDependencies(wt.text,ot,tt,this.allowVerticalPlacement,ft)}}}T.get("symbol-placement")==="line"&&(this.features=function(le){const fe={},Ee={},ye=[];let Y=0;function oe(qe){ye.push(le[qe]),Y++}function ve(qe,tt,wt){const ft=Ee[qe];return delete Ee[qe],Ee[tt]=ft,ye[ft].geometry[0].pop(),ye[ft].geometry[0]=ye[ft].geometry[0].concat(wt[0]),ft}function Ve(qe,tt,wt){const ft=fe[tt];return delete fe[tt],fe[qe]=ft,ye[ft].geometry[0].shift(),ye[ft].geometry[0]=wt[0].concat(ye[ft].geometry[0]),ft}function pt(qe,tt,wt){const ft=wt?tt[0][tt[0].length-1]:tt[0][0];return`${qe}:${ft.x}:${ft.y}`}for(let qe=0;qe<le.length;qe++){const tt=le[qe],wt=tt.geometry,ft=tt.text?tt.text.toString():null;if(!ft){oe(qe);continue}const Tt=pt(ft,wt),ot=pt(ft,wt,!0);if(Tt in Ee&&ot in fe&&Ee[Tt]!==fe[ot]){const Pt=Ve(Tt,ot,wt),Jt=ve(Tt,ot,ye[Pt].geometry);delete fe[Tt],delete Ee[ot],Ee[pt(ft,ye[Jt].geometry,!0)]=Jt,ye[Pt].geometry=null}else Tt in Ee?ve(Tt,ot,wt):ot in fe?Ve(Tt,ot,wt):(oe(qe),fe[Tt]=Y-1,Ee[ot]=Y-1)}return ye.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,fe)=>le.sortKey-fe.sortKey)}update(t,l,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,l,this.layers,d),this.icon.programConfigurations.updatePaintArrays(t,l,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,l){const d=this.lineVertexArray.length;if(t.segment!==void 0){let y=t.dist(l[t.segment+1]),T=t.dist(l[t.segment]);const E={};for(let A=t.segment+1;A<l.length;A++)E[A]={x:l[A].x,y:l[A].y,tileUnitDistanceFromAnchor:y},A<l.length-1&&(y+=l[A+1].dist(l[A]));for(let A=t.segment||0;A>=0;A--)E[A]={x:l[A].x,y:l[A].y,tileUnitDistanceFromAnchor:T},A>0&&(T+=l[A-1].dist(l[A]));for(let A=0;A<l.length;A++){const I=E[A];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(t,l,d,y,T,E,A,I,L,O,B,$){const q=t.indexArray,W=t.layoutVertexArray,J=t.segments.prepareSegment(4*l.length,W,q,this.canOverlap?E.sortKey:void 0),le=this.glyphOffsetArray.length,fe=J.vertexLength,Ee=this.allowVerticalPlacement&&A===v.ah.vertical?Math.PI/2:0,ye=E.text&&E.text.sections;for(let Y=0;Y<l.length;Y++){const{tl:oe,tr:ve,bl:Ve,br:pt,tex:qe,pixelOffsetTL:tt,pixelOffsetBR:wt,minFontScaleX:ft,minFontScaleY:Tt,glyphOffset:ot,isSDF:Pt,sectionIndex:Jt}=l[Y],Xt=J.vertexLength,Gt=ot[1];rp(W,I.x,I.y,oe.x,Gt+oe.y,qe.x,qe.y,d,Pt,tt.x,tt.y,ft,Tt),rp(W,I.x,I.y,ve.x,Gt+ve.y,qe.x+qe.w,qe.y,d,Pt,wt.x,tt.y,ft,Tt),rp(W,I.x,I.y,Ve.x,Gt+Ve.y,qe.x,qe.y+qe.h,d,Pt,tt.x,wt.y,ft,Tt),rp(W,I.x,I.y,pt.x,Gt+pt.y,qe.x+qe.w,qe.y+qe.h,d,Pt,wt.x,wt.y,ft,Tt),Em(t.dynamicLayoutVertexArray,I,Ee),q.emplaceBack(Xt,Xt+2,Xt+1),q.emplaceBack(Xt+1,Xt+2,Xt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ot[0]),Y!==l.length-1&&Jt===l[Y+1].sectionIndex||t.programConfigurations.populatePaintArrays(W.length,E,E.index,{},$,ye&&ye[Jt])}t.placedSymbolArray.emplaceBack(I.x,I.y,le,this.glyphOffsetArray.length-le,fe,L,O,I.segment,d?d[0]:0,d?d[1]:0,y[0],y[1],A,0,!1,0,B)}_addCollisionDebugVertex(t,l,d,y,T,E){return l.emplaceBack(0,0),t.emplaceBack(d.x,d.y,y,T,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(t,l,d,y,T,E,A){const I=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),L=I.vertexLength,O=T.layoutVertexArray,B=T.collisionVertexArray,$=A.anchorX,q=A.anchorY;this._addCollisionDebugVertex(O,B,E,$,q,new ie(t,l)),this._addCollisionDebugVertex(O,B,E,$,q,new ie(d,l)),this._addCollisionDebugVertex(O,B,E,$,q,new ie(d,y)),this._addCollisionDebugVertex(O,B,E,$,q,new ie(t,y)),I.vertexLength+=4;const W=T.indexArray;W.emplaceBack(L,L+1),W.emplaceBack(L+1,L+2),W.emplaceBack(L+2,L+3),W.emplaceBack(L+3,L),I.primitiveLength+=4}addDebugCollisionBoxes(t,l,d,y){for(let T=t;T<l;T++){const E=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,y?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sy(At,Cl.members,Ft),this.iconCollisionBox=new sy(At,Cl.members,Ft);for(let t=0;t<this.symbolInstances.length;t++){const l=this.symbolInstances.get(t);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(t,l,d,y,T,E,A,I,L){const O={};for(let B=l;B<d;B++){const $=t.get(B);O.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.textFeatureIndex=$.featureIndex;break}for(let B=y;B<T;B++){const $=t.get(B);O.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalTextFeatureIndex=$.featureIndex;break}for(let B=E;B<A;B++){const $=t.get(B);O.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.iconFeatureIndex=$.featureIndex;break}for(let B=I;B<L;B++){const $=t.get(B);O.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalIconFeatureIndex=$.featureIndex;break}return O}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,l){const d=t.placedSymbolArray.get(l),y=d.vertexStartIndex+4*d.numGlyphs;for(let T=d.vertexStartIndex;T<y;T+=4)t.indexArray.emplaceBack(T,T+2,T+1),t.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(t),d=Math.cos(t),y=[],T=[],E=[];for(let A=0;A<this.symbolInstances.length;++A){E.push(A);const I=this.symbolInstances.get(A);y.push(0|Math.round(l*I.anchorX+d*I.anchorY)),T.push(I.featureIndex)}return E.sort((A,I)=>y[A]-y[I]||T[I]-T[A]),E}addToSortKeyRanges(t,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((y,T,E)=>{y>=0&&E.indexOf(y)===T&&this.addIndicesForPlacedSymbol(this.text,y)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let s0,o0;Lt("SymbolBucket",Th,{omit:["layers","collisionBoxArray","features","compareText"]}),Th.MAX_GLYPHS=65535,Th.addDynamicAttributes=Em;var oy={get paint(){return o0=o0||new Lr({"icon-opacity":new Ht(X.paint_symbol["icon-opacity"]),"icon-color":new Ht(X.paint_symbol["icon-color"]),"icon-halo-color":new Ht(X.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ht(X.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ht(X.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(X.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(X.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ht(X.paint_symbol["text-opacity"]),"text-color":new Ht(X.paint_symbol["text-color"],{runtimeType:sn,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Ht(X.paint_symbol["text-halo-color"]),"text-halo-width":new Ht(X.paint_symbol["text-halo-width"]),"text-halo-blur":new Ht(X.paint_symbol["text-halo-blur"]),"text-translate":new Zt(X.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(X.paint_symbol["text-translate-anchor"])})},get layout(){return s0=s0||new Lr({"symbol-placement":new Zt(X.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(X.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(X.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ht(X.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(X.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Zt(X.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Zt(X.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Zt(X.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(X.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(X.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ht(X.layout_symbol["icon-size"]),"icon-text-fit":new Zt(X.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(X.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ht(X.layout_symbol["icon-image"]),"icon-rotate":new Ht(X.layout_symbol["icon-rotate"]),"icon-padding":new Ht(X.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(X.layout_symbol["icon-keep-upright"]),"icon-offset":new Ht(X.layout_symbol["icon-offset"]),"icon-anchor":new Ht(X.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(X.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(X.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(X.layout_symbol["text-rotation-alignment"]),"text-field":new Ht(X.layout_symbol["text-field"]),"text-font":new Ht(X.layout_symbol["text-font"]),"text-size":new Ht(X.layout_symbol["text-size"]),"text-max-width":new Ht(X.layout_symbol["text-max-width"]),"text-line-height":new Zt(X.layout_symbol["text-line-height"]),"text-letter-spacing":new Ht(X.layout_symbol["text-letter-spacing"]),"text-justify":new Ht(X.layout_symbol["text-justify"]),"text-radial-offset":new Ht(X.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(X.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ht(X.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ht(X.layout_symbol["text-anchor"]),"text-max-angle":new Zt(X.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(X.layout_symbol["text-writing-mode"]),"text-rotate":new Ht(X.layout_symbol["text-rotate"]),"text-padding":new Zt(X.layout_symbol["text-padding"]),"text-keep-upright":new Zt(X.layout_symbol["text-keep-upright"]),"text-transform":new Ht(X.layout_symbol["text-transform"]),"text-offset":new Ht(X.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(X.layout_symbol["text-allow-overlap"]),"text-overlap":new Zt(X.layout_symbol["text-overlap"]),"text-ignore-placement":new Zt(X.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(X.layout_symbol["text-optional"])})}};class sp{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Cn,this.defaultValue=t}evaluate(t){if(t.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(t.formattedSection))return l.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Lt("FormatSectionOverride",sp,{omit:["defaultValue"]});class Sc extends Nr{constructor(t){super(t,oy)}recalculate(t,l){if(super.recalculate(t,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const y=[];for(const T of d)y.indexOf(T)<0&&y.push(T);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,l,d,y){const T=this.layout.get(t).evaluate(l,{},d,y),E=this._unevaluatedLayout._values[t];return E.isDataDriven()||cl(E.value)||!T?T:function(A,I){return I.replace(/{([^{}]+)}/g,(L,O)=>A&&O in A?String(A[O]):"")}(l.properties,T)}createBucket(t){return new Th(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of oy.paint.overridableProperties){if(!Sc.hasPaintOverride(this.layout,t))continue;const l=this.paint.get(t),d=new sp(l),y=new rc(d,l.property.specification);let T=null;T=l.value.kind==="constant"||l.value.kind==="source"?new zf("source",y):new Kr("composite",y,l.value.zoomStops),this.paint._values[t]=new Za(l.property,T,l.parameters)}}_handleOverridablePaintPropertyUpdate(t,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&Sc.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,l){const d=t.get("text-field"),y=oy.paint.properties[l];let T=!1;const E=A=>{for(const I of A)if(y.overrides&&y.overrides.hasOverride(I))return void(T=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Ur)E(d.value.value.sections);else if(d.value.kind==="source"){const A=L=>{T||(L instanceof So&&_i(L.value)===$n?E(L.value.sections):L instanceof Zc?E(L.sections):L.eachChild(A))},I=d.value;I._styleExpression&&A(I._styleExpression.expression)}return T}}let Sm;var Am={get paint(){return Sm=Sm||new Lr({"background-color":new Zt(X.paint_background["background-color"]),"background-pattern":new Rd(X.paint_background["background-pattern"]),"background-opacity":new Zt(X.paint_background["background-opacity"])})}};class ly extends Nr{constructor(t){super(t,Am)}}let fu;var Dl={get paint(){return fu=fu||new Lr({"raster-opacity":new Zt(X.paint_raster["raster-opacity"]),"raster-hue-rotate":new Zt(X.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(X.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(X.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(X.paint_raster["raster-saturation"]),"raster-contrast":new Zt(X.paint_raster["raster-contrast"]),"raster-resampling":new Zt(X.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(X.paint_raster["raster-fade-duration"])})}};class op extends Nr{constructor(t){super(t,Dl)}}class Lv extends Nr{constructor(t){super(t,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class l0{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const c0={once:!0},Mm=63710088e-1;class Ac{constructor(t,l){if(isNaN(t)||isNaN(l))throw new Error(`Invalid LngLat object: (${t}, ${l})`);if(this.lng=+t,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ac(zt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const l=Math.PI/180,d=this.lat*l,y=t.lat*l,T=Math.sin(d)*Math.sin(y)+Math.cos(d)*Math.cos(y)*Math.cos((t.lng-this.lng)*l);return Mm*Math.acos(Math.min(T,1))}static convert(t){if(t instanceof Ac)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ac(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ac(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const u0=2*Math.PI*Mm;function Cm(o){return u0*Math.cos(o*Math.PI/180)}function cy(o){return(180+o)/360}function uy(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function h0(o,t){return o/Cm(t)}function lp(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function Dm(o,t){return o*Cm(lp(t))}class cp{constructor(t,l,d=0){this.x=+t,this.y=+l,this.z=+d}static fromLngLat(t,l=0){const d=Ac.convert(t);return new cp(cy(d.lng),uy(d.lat),h0(l,d.lat))}toLngLat(){return new Ac(360*this.x-180,lp(this.y))}toAltitude(){return Dm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/u0*(t=lp(this.y),1/Math.cos(t*Math.PI/180));var t}}function d0(o,t,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[o*d-2*Math.PI*6378137/2,t*d-2*Math.PI*6378137/2]}class Eh{constructor(t,l,d){if(!function(y,T,E){return!(y<0||y>25||E<0||E>=Math.pow(2,y)||T<0||T>=Math.pow(2,y))}(t,l,d))throw new Error(`x=${l}, y=${d}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=l,this.y=d,this.key=En(0,t,t,l,d)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,l,d){const y=(E=this.y,A=this.z,I=d0(256*(T=this.x),256*(E=Math.pow(2,A)-E-1),A),L=d0(256*(T+1),256*(E+1),A),I[0]+","+I[1]+","+L[0]+","+L[1]);var T,E,A,I,L;const O=function(B,$,q){let W,J="";for(let le=B;le>0;le--)W=1<<le-1,J+=($&W?1:0)+(q&W?2:0);return J}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,y)}isChildOf(t){const l=this.z-t.z;return l>0&&t.x===this.x>>l&&t.y===this.y>>l}getTilePoint(t){const l=Math.pow(2,this.z);return new ie((t.x*l-this.x)*Oe,(t.y*l-this.y)*Oe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class f0{constructor(t,l){this.wrap=t,this.canonical=l,this.key=En(t,l.z,l.z,l.x,l.y)}}class Ka{constructor(t,l,d,y,T){if(this.terrainRttPosMatrix32f=null,t<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${d}`);this.overscaledZ=t,this.wrap=l,this.canonical=new Eh(d,+y,+T),this.key=En(l,t,d,y,T)}clone(){return new Ka(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?new Ka(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ka(t,this.wrap,t,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(t,l){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-t;return t>this.canonical.z?En(this.wrap*+l,t,this.canonical.z,this.canonical.x,this.canonical.y):En(this.wrap*+l,t,t,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const l=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>l&&t.canonical.y===this.canonical.y>>l}children(t){if(this.overscaledZ>=t)return[new Ka(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,y=2*this.canonical.y;return[new Ka(l,this.wrap,l,d,y),new Ka(l,this.wrap,l,d+1,y),new Ka(l,this.wrap,l,d,y+1),new Ka(l,this.wrap,l,d+1,y+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ka(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ka(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new f0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new cp(t.x-this.wrap,t.y))}}function En(o,t,l,d,y){(o*=2)<0&&(o=-1*o-1);const T=1<<l;return(T*T*o+T*y+d).toString(36)+l.toString(36)+t.toString(36)}Lt("CanonicalTileID",Eh),Lt("OverscaledTileID",Ka,{omit:["terrainRttPosMatrix32f"]});class km{constructor(t,l,d,y=1,T=1,E=1,A=0){if(this.uid=t,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void Mi(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const I=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=y,this.greenFactor=T,this.blueFactor=E,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let L=0;L<I;L++)this.data[this._idx(-1,L)]=this.data[this._idx(0,L)],this.data[this._idx(I,L)]=this.data[this._idx(I-1,L)],this.data[this._idx(L,-1)]=this.data[this._idx(L,0)],this.data[this._idx(L,I)]=this.data[this._idx(L,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let L=0;L<I;L++)for(let O=0;O<I;O++){const B=this.get(L,O);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(t,l){const d=new Uint8Array(this.data.buffer),y=4*this._idx(t,l);return this.unpack(d[y],d[y+1],d[y+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,l){if(t<-1||t>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(t+1)}unpack(t,l,d){return t*this.redFactor+l*this.greenFactor+d*this.blueFactor-this.baseShift}getPixels(){return new qa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,l,d){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let y=l*this.dim,T=l*this.dim+this.dim,E=d*this.dim,A=d*this.dim+this.dim;switch(l){case-1:y=T-1;break;case 1:T=y+1}switch(d){case-1:E=A-1;break;case 1:A=E+1}const I=-l*this.dim,L=-d*this.dim;for(let O=E;O<A;O++)for(let B=y;B<T;B++)this.data[this._idx(B,O)]=t.data[this._idx(B+I,O+L)]}}Lt("DEMData",km);class up{constructor(t){this._stringToNumber={},this._numberToString=[];for(let l=0;l<t.length;l++){const d=t[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Im{constructor(t,l,d,y,T){this.type="Feature",this._vectorTileFeature=t,t._z=l,t._x=d,t._y=y,this.properties=t.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(t[l]=this[l]);return t}}class hy{constructor(t,l){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new cc(Oe,16,0),this.grid3D=new cc(Oe,16,0),this.featureIndexArray=new ge,this.promoteId=l}insert(t,l,d,y,T,E){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,y,T);const I=E?this.grid3D:this.grid;for(let L=0;L<l.length;L++){const O=l[L],B=[1/0,1/0,-1/0,-1/0];for(let $=0;$<O.length;$++){const q=O[$];B[0]=Math.min(B[0],q.x),B[1]=Math.min(B[1],q.y),B[2]=Math.max(B[2],q.x),B[3]=Math.max(B[3],q.y)}B[0]<Oe&&B[1]<Oe&&B[2]>=0&&B[3]>=0&&I.insert(A,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Od.VectorTile(new Vd(this.rawTileData)).layers,this.sourceLayerCoder=new up(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,l,d,y){this.loadVTLayers();const T=t.params,E=Oe/t.tileSize/t.scale,A=Qu(T.filter),I=t.queryGeometry,L=t.queryPadding*E,O=qd(I),B=this.grid.query(O.minX-L,O.minY-L,O.maxX+L,O.maxY+L),$=qd(t.cameraQueryGeometry),q=this.grid3D.query($.minX-L,$.minY-L,$.maxX+L,$.maxY+L,(le,fe,Ee,ye)=>function(Y,oe,ve,Ve,pt){for(const tt of Y)if(oe<=tt.x&&ve<=tt.y&&Ve>=tt.x&&pt>=tt.y)return!0;const qe=[new ie(oe,ve),new ie(oe,pt),new ie(Ve,pt),new ie(Ve,ve)];if(Y.length>2){for(const tt of qe)if(Ui(Y,tt))return!0}for(let tt=0;tt<Y.length-1;tt++)if(rm(Y[tt],Y[tt+1],qe))return!0;return!1}(t.cameraQueryGeometry,le-L,fe-L,Ee+L,ye+L));for(const le of q)B.push(le);B.sort(zm);const W={};let J;for(let le=0;le<B.length;le++){const fe=B[le];if(fe===J)continue;J=fe;const Ee=this.featureIndexArray.get(fe);let ye=null;this.loadMatchingFeature(W,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,A,T.layers,T.availableImages,l,d,y,(Y,oe,ve)=>(ye||(ye=Ya(Y)),oe.queryIntersectsFeature({queryGeometry:I,feature:Y,featureState:ve,geometry:ye,zoom:this.z,transform:t.transform,pixelsToTileUnits:E,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return W}loadMatchingFeature(t,l,d,y,T,E,A,I,L,O,B){const $=this.bucketLayerIDs[l];if(E&&!$.some(le=>E.has(le)))return;const q=this.sourceLayerCoder.decode(d),W=this.vtLayers[q].feature(y);if(T.needGeometry){const le=ps(W,!0);if(!T.filter(new ci(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!T.filter(new ci(this.tileID.overscaledZ),W))return;const J=this.getId(W,q);for(let le=0;le<$.length;le++){const fe=$[le];if(E&&!E.has(fe))continue;const Ee=I[fe];if(!Ee)continue;let ye={};J&&O&&(ye=O.getState(Ee.sourceLayer||"_geojsonTileLayer",J));const Y=Yt({},L[fe]);Y.paint=Rm(Y.paint,Ee.paint,W,ye,A),Y.layout=Rm(Y.layout,Ee.layout,W,ye,A);const oe=!B||B(W,Ee,ye);if(!oe)continue;const ve=new Im(W,this.z,this.x,this.y,J);ve.layer=Y;let Ve=t[fe];Ve===void 0&&(Ve=t[fe]=[]),Ve.push({featureIndex:y,feature:ve,intersectionZ:oe})}}lookupSymbolFeatures(t,l,d,y,T,E,A,I){const L={};this.loadVTLayers();const O=Qu(T);for(const B of t)this.loadMatchingFeature(L,d,y,B,O,E,A,I,l);return L}hasLayer(t){for(const l of this.bucketLayerIDs)for(const d of l)if(t===d)return!0;return!1}getId(t,l){var d;let y=t.id;return this.promoteId&&(y=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof y=="boolean"&&(y=Number(y)),y===void 0&&(!((d=t.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(y=Number(t.properties.cluster_id))),y}}function Rm(o,t,l,d,y){return gi(o,(T,E)=>{const A=t instanceof fc?t.get(E):null;return A&&A.evaluate?A.evaluate(l,d,y):A})}function qd(o){let t=1/0,l=1/0,d=-1/0,y=-1/0;for(const T of o)t=Math.min(t,T.x),l=Math.min(l,T.y),d=Math.max(d,T.x),y=Math.max(y,T.y);return{minX:t,minY:l,maxX:d,maxY:y}}function zm(o,t){return t-o}function Sh(o,t,l,d,y){const T=[];for(let E=0;E<o.length;E++){const A=o[E];let I;for(let L=0;L<A.length-1;L++){let O=A[L],B=A[L+1];O.x<t&&B.x<t||(O.x<t?O=new ie(t,O.y+(t-O.x)/(B.x-O.x)*(B.y-O.y))._round():B.x<t&&(B=new ie(t,O.y+(t-O.x)/(B.x-O.x)*(B.y-O.y))._round()),O.y<l&&B.y<l||(O.y<l?O=new ie(O.x+(l-O.y)/(B.y-O.y)*(B.x-O.x),l)._round():B.y<l&&(B=new ie(O.x+(l-O.y)/(B.y-O.y)*(B.x-O.x),l)._round()),O.x>=d&&B.x>=d||(O.x>=d?O=new ie(d,O.y+(d-O.x)/(B.x-O.x)*(B.y-O.y))._round():B.x>=d&&(B=new ie(d,O.y+(d-O.x)/(B.x-O.x)*(B.y-O.y))._round()),O.y>=y&&B.y>=y||(O.y>=y?O=new ie(O.x+(y-O.y)/(B.y-O.y)*(B.x-O.x),y)._round():B.y>=y&&(B=new ie(O.x+(y-O.y)/(B.y-O.y)*(B.x-O.x),y)._round()),I&&O.equals(I[I.length-1])||(I=[O],T.push(I)),I.push(B)))))}}return T}Lt("FeatureIndex",hy,{omit:["rawTileData","sourceLayerCoder"]});class Mc extends ie{constructor(t,l,d,y){super(t,l),this.angle=d,y!==void 0&&(this.segment=y)}clone(){return new Mc(this.x,this.y,this.angle,this.segment)}}function p0(o,t,l,d,y){if(t.segment===void 0||l===0)return!0;let T=t,E=t.segment+1,A=0;for(;A>-l/2;){if(E--,E<0)return!1;A-=o[E].dist(T),T=o[E]}A+=o[E].dist(o[E+1]),E++;const I=[];let L=0;for(;A<l/2;){const O=o[E],B=o[E+1];if(!B)return!1;let $=o[E-1].angleTo(O)-O.angleTo(B);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:A,angleDelta:$}),L+=$;A-I[0].distance>d;)L-=I.shift().angleDelta;if(L>y)return!1;E++,A+=O.dist(B)}return!0}function m0(o){let t=0;for(let l=0;l<o.length-1;l++)t+=o[l].dist(o[l+1]);return t}function dy(o,t,l){return o?.6*t*l:0}function fy(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function Lm(o,t,l,d,y,T){const E=dy(l,y,T),A=fy(l,d)*T;let I=0;const L=m0(o)/2;for(let O=0;O<o.length-1;O++){const B=o[O],$=o[O+1],q=B.dist($);if(I+q>L){const W=(L-I)/q,J=Sa.number(B.x,$.x,W),le=Sa.number(B.y,$.y,W),fe=new Mc(J,le,$.angleTo(B),O);return fe._round(),!E||p0(o,fe,A,E,t)?fe:void 0}I+=q}}function xi(o,t,l,d,y,T,E,A,I){const L=dy(d,T,E),O=fy(d,y),B=O*E,$=o[0].x===0||o[0].x===I||o[0].y===0||o[0].y===I;return t-B<t/4&&(t=B+t/4),Nm(o,$?t/2*A%t:(O/2+2*T)*E*A%t,t,L,l,B,$,!1,I)}function Nm(o,t,l,d,y,T,E,A,I){const L=T/2,O=m0(o);let B=0,$=t-l,q=[];for(let W=0;W<o.length-1;W++){const J=o[W],le=o[W+1],fe=J.dist(le),Ee=le.angleTo(J);for(;$+l<B+fe;){$+=l;const ye=($-B)/fe,Y=Sa.number(J.x,le.x,ye),oe=Sa.number(J.y,le.y,ye);if(Y>=0&&Y<I&&oe>=0&&oe<I&&$-L>=0&&$+L<=O){const ve=new Mc(Y,oe,Ee,W);ve._round(),d&&!p0(o,ve,T,d,y)||q.push(ve)}}B+=fe}return A||q.length||E||(q=Nm(o,B/2,l,d,y,T,E,!0,I)),q}Lt("Anchor",Mc);const _r=na;function g0(o,t,l,d){const y=[],T=o.image,E=T.pixelRatio,A=T.paddedRect.w-2*_r,I=T.paddedRect.h-2*_r;let L={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const O=T.stretchX||[[0,A]],B=T.stretchY||[[0,I]],$=(ot,Pt)=>ot+Pt[1]-Pt[0],q=O.reduce($,0),W=B.reduce($,0),J=A-q,le=I-W;let fe=0,Ee=q,ye=0,Y=W,oe=0,ve=J,Ve=0,pt=le;if(T.content&&d){const ot=T.content,Pt=ot[2]-ot[0],Jt=ot[3]-ot[1];(T.textFitWidth||T.textFitHeight)&&(L=wh(o)),fe=Hd(O,0,ot[0]),ye=Hd(B,0,ot[1]),Ee=Hd(O,ot[0],ot[2]),Y=Hd(B,ot[1],ot[3]),oe=ot[0]-fe,Ve=ot[1]-ye,ve=Pt-Ee,pt=Jt-Y}const qe=L.x1,tt=L.y1,wt=L.x2-qe,ft=L.y2-tt,Tt=(ot,Pt,Jt,Xt)=>{const Gt=Ah(ot.stretch-fe,Ee,wt,qe),Sn=hp(ot.fixed-oe,ve,ot.stretch,q),ji=Ah(Pt.stretch-ye,Y,ft,tt),nr=hp(Pt.fixed-Ve,pt,Pt.stretch,W),jr=Ah(Jt.stretch-fe,Ee,wt,qe),ga=hp(Jt.fixed-oe,ve,Jt.stretch,q),Ra=Ah(Xt.stretch-ye,Y,ft,tt),Br=hp(Xt.fixed-Ve,pt,Xt.stretch,W),bi=new ie(Gt,ji),ur=new ie(jr,ji),hr=new ie(jr,Ra),vr=new ie(Gt,Ra),ra=new ie(Sn/E,nr/E),za=new ie(ga/E,Br/E),zi=t*Math.PI/180;if(zi){const Xi=Math.sin(zi),Wi=Math.cos(zi),fi=[Wi,-Xi,Xi,Wi];bi._matMult(fi),ur._matMult(fi),vr._matMult(fi),hr._matMult(fi)}const dr=ot.stretch+ot.fixed,wi=Pt.stretch+Pt.fixed;return{tl:bi,tr:ur,bl:vr,br:hr,tex:{x:T.paddedRect.x+_r+dr,y:T.paddedRect.y+_r+wi,w:Jt.stretch+Jt.fixed-dr,h:Xt.stretch+Xt.fixed-wi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ra,pixelOffsetBR:za,minFontScaleX:ve/E/wt,minFontScaleY:pt/E/ft,isSDF:l}};if(d&&(T.stretchX||T.stretchY)){const ot=Pm(O,J,q),Pt=Pm(B,le,W);for(let Jt=0;Jt<ot.length-1;Jt++){const Xt=ot[Jt],Gt=ot[Jt+1];for(let Sn=0;Sn<Pt.length-1;Sn++)y.push(Tt(Xt,Pt[Sn],Gt,Pt[Sn+1]))}}else y.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:I+1}));return y}function Hd(o,t,l){let d=0;for(const y of o)d+=Math.max(t,Math.min(l,y[1]))-Math.max(t,Math.min(l,y[0]));return d}function Pm(o,t,l){const d=[{fixed:-1,stretch:0}];for(const[y,T]of o){const E=d[d.length-1];d.push({fixed:y-E.stretch,stretch:E.stretch}),d.push({fixed:y-E.stretch,stretch:E.stretch+(T-y)})}return d.push({fixed:t+_r,stretch:l}),d}function Ah(o,t,l,d){return o/t*l+d}function hp(o,t,l,d){return o-t*l/d}class dp{constructor(t,l,d,y,T,E,A,I,L,O){var B;if(this.boxStartIndex=t.length,L){let $=E.top,q=E.bottom;const W=E.collisionPadding;W&&($-=W[1],q+=W[3]);let J=q-$;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const $=!((B=E.image)===null||B===void 0)&&B.content&&(E.image.textFitWidth||E.image.textFitHeight)?wh(E):{x1:E.left,y1:E.top,x2:E.right,y2:E.bottom};$.y1=$.y1*A-I[0],$.y2=$.y2*A+I[2],$.x1=$.x1*A-I[3],$.x2=$.x2*A+I[1];const q=E.collisionPadding;if(q&&($.x1-=q[0]*A,$.y1-=q[1]*A,$.x2+=q[2]*A,$.y2+=q[3]*A),O){const W=new ie($.x1,$.y1),J=new ie($.x2,$.y1),le=new ie($.x1,$.y2),fe=new ie($.x2,$.y2),Ee=O*Math.PI/180;W._rotate(Ee),J._rotate(Ee),le._rotate(Ee),fe._rotate(Ee),$.x1=Math.min(W.x,J.x,le.x,fe.x),$.x2=Math.max(W.x,J.x,le.x,fe.x),$.y1=Math.min(W.y,J.y,le.y,fe.y),$.y2=Math.max(W.y,J.y,le.y,fe.y)}t.emplaceBack(l.x,l.y,$.x1,$.y1,$.x2,$.y2,d,y,T)}this.boxEndIndex=t.length}}class py{constructor(t=[],l=(d,y)=>d<y?-1:d>y?1:0){if(this.data=t,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:l,compare:d}=this,y=l[t];for(;t>0;){const T=t-1>>1,E=l[T];if(d(y,E)>=0)break;l[t]=E,t=T}l[t]=y}_down(t){const{data:l,compare:d}=this,y=this.length>>1,T=l[t];for(;t<y;){let E=1+(t<<1);const A=E+1;if(A<this.length&&d(l[A],l[E])<0&&(E=A),d(l[E],T)>=0)break;l[t]=l[E],t=E}l[t]=T}}function my(o,t=1,l=!1){let d=1/0,y=1/0,T=-1/0,E=-1/0;const A=o[0];for(let q=0;q<A.length;q++){const W=A[q];(!q||W.x<d)&&(d=W.x),(!q||W.y<y)&&(y=W.y),(!q||W.x>T)&&(T=W.x),(!q||W.y>E)&&(E=W.y)}const I=Math.min(T-d,E-y);let L=I/2;const O=new py([],Nv);if(I===0)return new ie(d,y);for(let q=d;q<T;q+=I)for(let W=y;W<E;W+=I)O.push(new Mh(q+L,W+L,L,o));let B=function(q){let W=0,J=0,le=0;const fe=q[0];for(let Ee=0,ye=fe.length,Y=ye-1;Ee<ye;Y=Ee++){const oe=fe[Ee],ve=fe[Y],Ve=oe.x*ve.y-ve.x*oe.y;J+=(oe.x+ve.x)*Ve,le+=(oe.y+ve.y)*Ve,W+=3*Ve}return new Mh(J/W,le/W,0,q)}(o),$=O.length;for(;O.length;){const q=O.pop();(q.d>B.d||!B.d)&&(B=q,l&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,$)),q.max-B.d<=t||(L=q.h/2,O.push(new Mh(q.p.x-L,q.p.y-L,L,o)),O.push(new Mh(q.p.x+L,q.p.y-L,L,o)),O.push(new Mh(q.p.x-L,q.p.y+L,L,o)),O.push(new Mh(q.p.x+L,q.p.y+L,L,o)),$+=4)}return l&&(console.log(`num probes: ${$}`),console.log(`best distance: ${B.d}`)),B.p}function Nv(o,t){return t.max-o.max}function Mh(o,t,l,d){this.p=new ie(o,t),this.h=l,this.d=function(y,T){let E=!1,A=1/0;for(let I=0;I<T.length;I++){const L=T[I];for(let O=0,B=L.length,$=B-1;O<B;$=O++){const q=L[O],W=L[$];q.y>y.y!=W.y>y.y&&y.x<(W.x-q.x)*(y.y-q.y)/(W.y-q.y)+q.x&&(E=!E),A=Math.min(A,_c(y,q,W))}}return(E?1:-1)*Math.sqrt(A)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var qr;v.ay=void 0,(qr=v.ay||(v.ay={}))[qr.center=1]="center",qr[qr.left=2]="left",qr[qr.right=3]="right",qr[qr.top=4]="top",qr[qr.bottom=5]="bottom",qr[qr["top-left"]=6]="top-left",qr[qr["top-right"]=7]="top-right",qr[qr["bottom-left"]=8]="bottom-left",qr[qr["bottom-right"]=9]="bottom-right";const Cc=7,gy=Number.POSITIVE_INFINITY;function y0(o,t){return t[1]!==gy?function(l,d,y){let T=0,E=0;switch(d=Math.abs(d),y=Math.abs(y),l){case"top-right":case"top-left":case"top":E=y-Cc;break;case"bottom-right":case"bottom-left":case"bottom":E=-y+Cc}switch(l){case"top-right":case"bottom-right":case"right":T=-d;break;case"top-left":case"bottom-left":case"left":T=d}return[T,E]}(o,t[0],t[1]):function(l,d){let y=0,T=0;d<0&&(d=0);const E=d/Math.SQRT2;switch(l){case"top-right":case"top-left":T=E-Cc;break;case"bottom-right":case"bottom-left":T=-E+Cc;break;case"bottom":T=-d+Cc;break;case"top":T=d-Cc}switch(l){case"top-right":case"bottom-right":y=-E;break;case"top-left":case"bottom-left":y=E;break;case"left":y=d;break;case"right":y=-d}return[y,T]}(o,t[0])}function Dc(o,t,l){var d;const y=o.layout,T=(d=y.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(t,{},l);if(T){const A=T.values,I=[];for(let L=0;L<A.length;L+=2){const O=I[L]=A[L],B=A[L+1].map($=>$*Vi);O.startsWith("top")?B[1]-=Cc:O.startsWith("bottom")&&(B[1]+=Cc),I[L+1]=B}return new Sr(I)}const E=y.get("text-variable-anchor");if(E){let A;A=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[y.get("text-radial-offset").evaluate(t,{},l)*Vi,gy]:y.get("text-offset").evaluate(t,{},l).map(L=>L*Vi);const I=[];for(const L of E)I.push(L,y0(L,A));return new Sr(I)}return null}function Om(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function yy(o,t,l,d,y,T,E,A,I,L,O,B){let $=T.textMaxSize.evaluate(t,{});$===void 0&&($=E);const q=o.layers[0].layout,W=q.get("icon-offset").evaluate(t,{},O),J=v0(l.horizontal),le=E/24,fe=o.tilePixelRatio*le,Ee=o.tilePixelRatio*$/24,ye=o.tilePixelRatio*A,Y=o.tilePixelRatio*q.get("symbol-spacing"),oe=q.get("text-padding")*o.tilePixelRatio,ve=function(Jt,Xt,Gt,Sn=1){const ji=Jt.get("icon-padding").evaluate(Xt,{},Gt),nr=ji&&ji.values;return[nr[0]*Sn,nr[1]*Sn,nr[2]*Sn,nr[3]*Sn]}(q,t,O,o.tilePixelRatio),Ve=q.get("text-max-angle")/180*Math.PI,pt=q.get("text-rotation-alignment")!=="viewport"&&q.get("symbol-placement")!=="point",qe=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",tt=q.get("symbol-placement"),wt=Y/2,ft=q.get("icon-text-fit");let Tt;d&&ft!=="none"&&(o.allowVerticalPlacement&&l.vertical&&(Tt=ip(d,l.vertical,ft,q.get("icon-text-fit-padding"),W,le)),J&&(d=ip(d,J,ft,q.get("icon-text-fit-padding"),W,le)));const ot=O?B.line.getGranularityForZoomLevel(O.z):1,Pt=(Jt,Xt)=>{Xt.x<0||Xt.x>=Oe||Xt.y<0||Xt.y>=Oe||function(Gt,Sn,ji,nr,jr,ga,Ra,Br,bi,ur,hr,vr,ra,za,zi,dr,wi,Xi,Wi,fi,Ti,lo,kl,$o,w0){const kc=Gt.addToLineVertexArray(Sn,ji);let mu,Wd,Ic,Rc,wy=0,Qd=0,Bm=0,pp=0,Fm=-1,Ty=-1;const co={};let r=Js("");if(Gt.allowVerticalPlacement&&nr.vertical){const _n=Br.layout.get("text-rotate").evaluate(Ti,{},$o)+90;Ic=new dp(bi,Sn,ur,hr,vr,nr.vertical,ra,za,zi,_n),Ra&&(Rc=new dp(bi,Sn,ur,hr,vr,Ra,wi,Xi,zi,_n))}if(jr){const _n=Br.layout.get("icon-rotate").evaluate(Ti,{}),Pe=Br.layout.get("icon-text-fit")!=="none",Ie=g0(jr,_n,kl,Pe),Fe=Ra?g0(Ra,_n,kl,Pe):void 0;Wd=new dp(bi,Sn,ur,hr,vr,jr,wi,Xi,!1,_n),wy=4*Ie.length;const dt=Gt.iconSizeData;let Ut=null;dt.kind==="source"?(Ut=[Go*Br.layout.get("icon-size").evaluate(Ti,{})],Ut[0]>Ec&&Mi(`${Gt.layerIds[0]}: Value for "icon-size" is >= ${Yd}. Reduce your "icon-size".`)):dt.kind==="composite"&&(Ut=[Go*lo.compositeIconSizes[0].evaluate(Ti,{},$o),Go*lo.compositeIconSizes[1].evaluate(Ti,{},$o)],(Ut[0]>Ec||Ut[1]>Ec)&&Mi(`${Gt.layerIds[0]}: Value for "icon-size" is >= ${Yd}. Reduce your "icon-size".`)),Gt.addSymbols(Gt.icon,Ie,Ut,fi,Wi,Ti,v.ah.none,Sn,kc.lineStartIndex,kc.lineLength,-1,$o),Fm=Gt.icon.placedSymbolArray.length-1,Fe&&(Qd=4*Fe.length,Gt.addSymbols(Gt.icon,Fe,Ut,fi,Wi,Ti,v.ah.vertical,Sn,kc.lineStartIndex,kc.lineLength,-1,$o),Ty=Gt.icon.placedSymbolArray.length-1)}const u=Object.keys(nr.horizontal);for(const _n of u){const Pe=nr.horizontal[_n];if(!mu){r=Js(Pe.text);const Fe=Br.layout.get("text-rotate").evaluate(Ti,{},$o);mu=new dp(bi,Sn,ur,hr,vr,Pe,ra,za,zi,Fe)}const Ie=Pe.positionedLines.length===1;if(Bm+=_0(Gt,Sn,Pe,ga,Br,zi,Ti,dr,kc,nr.vertical?v.ah.horizontal:v.ah.horizontalOnly,Ie?u:[_n],co,Fm,lo,$o),Ie)break}nr.vertical&&(pp+=_0(Gt,Sn,nr.vertical,ga,Br,zi,Ti,dr,kc,v.ah.vertical,["vertical"],co,Ty,lo,$o));const m=mu?mu.boxStartIndex:Gt.collisionBoxArray.length,b=mu?mu.boxEndIndex:Gt.collisionBoxArray.length,M=Ic?Ic.boxStartIndex:Gt.collisionBoxArray.length,z=Ic?Ic.boxEndIndex:Gt.collisionBoxArray.length,H=Wd?Wd.boxStartIndex:Gt.collisionBoxArray.length,ae=Wd?Wd.boxEndIndex:Gt.collisionBoxArray.length,we=Rc?Rc.boxStartIndex:Gt.collisionBoxArray.length,Ye=Rc?Rc.boxEndIndex:Gt.collisionBoxArray.length;let ct=-1;const xt=(_n,Pe)=>_n&&_n.circleDiameter?Math.max(_n.circleDiameter,Pe):Pe;ct=xt(mu,ct),ct=xt(Ic,ct),ct=xt(Wd,ct),ct=xt(Rc,ct);const We=ct>-1?1:0;We&&(ct*=w0/Vi),Gt.glyphOffsetArray.length>=Th.MAX_GLYPHS&&Mi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ti.sortKey!==void 0&&Gt.addToSortKeyRanges(Gt.symbolInstances.length,Ti.sortKey);const et=Dc(Br,Ti,$o),[un,ln]=function(_n,Pe){const Ie=_n.length,Fe=Pe==null?void 0:Pe.values;if((Fe==null?void 0:Fe.length)>0)for(let dt=0;dt<Fe.length;dt+=2){const Ut=Fe[dt+1];_n.emplaceBack(v.ay[Fe[dt]],Ut[0],Ut[1])}return[Ie,_n.length]}(Gt.textAnchorOffsets,et);Gt.symbolInstances.emplaceBack(Sn.x,Sn.y,co.right>=0?co.right:-1,co.center>=0?co.center:-1,co.left>=0?co.left:-1,co.vertical||-1,Fm,Ty,r,m,b,M,z,H,ae,we,Ye,ur,Bm,pp,wy,Qd,We,0,ra,ct,un,ln)}(o,Xt,Jt,l,d,y,Tt,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,fe,[oe,oe,oe,oe],pt,I,ye,ve,qe,W,t,T,L,O,E)};if(tt==="line")for(const Jt of Sh(t.geometry,0,0,Oe,Oe)){const Xt=xc(Jt,ot),Gt=xi(Xt,Y,Ve,l.vertical||J,d,24,Ee,o.overscaling,Oe);for(const Sn of Gt)J&&_y(o,J.text,wt,Sn)||Pt(Xt,Sn)}else if(tt==="line-center"){for(const Jt of t.geometry)if(Jt.length>1){const Xt=xc(Jt,ot),Gt=Lm(Xt,Ve,l.vertical||J,d,24,Ee);Gt&&Pt(Xt,Gt)}}else if(t.type==="Polygon")for(const Jt of Ro(t.geometry,0)){const Xt=my(Jt,16);Pt(xc(Jt[0],ot,!0),new Mc(Xt.x,Xt.y,0))}else if(t.type==="LineString")for(const Jt of t.geometry){const Xt=xc(Jt,ot);Pt(Xt,new Mc(Xt[0].x,Xt[0].y,0))}else if(t.type==="Point")for(const Jt of t.geometry)for(const Xt of Jt)Pt([Xt],new Mc(Xt.x,Xt.y,0))}function _0(o,t,l,d,y,T,E,A,I,L,O,B,$,q,W){const J=function(Ee,ye,Y,oe,ve,Ve,pt,qe){const tt=oe.layout.get("text-rotate").evaluate(Ve,{})*Math.PI/180,wt=[];for(const ft of ye.positionedLines)for(const Tt of ft.positionedGlyphs){if(!Tt.rect)continue;const ot=Tt.rect||{};let Pt=Gd+1,Jt=!0,Xt=1,Gt=0;const Sn=(ve||qe)&&Tt.vertical,ji=Tt.metrics.advance*Tt.scale/2;if(qe&&ye.verticalizable&&(Gt=ft.lineOffset/2-(Tt.imageName?-(Vi-Tt.metrics.width*Tt.scale)/2:(Tt.scale-1)*Vi)),Tt.imageName){const Xi=pt[Tt.imageName];Jt=Xi.sdf,Xt=Xi.pixelRatio,Pt=na/Xt}const nr=ve?[Tt.x+ji,Tt.y]:[0,0];let jr=ve?[0,0]:[Tt.x+ji+Y[0],Tt.y+Y[1]-Gt],ga=[0,0];Sn&&(ga=jr,jr=[0,0]);const Ra=Tt.metrics.isDoubleResolution?2:1,Br=(Tt.metrics.left-Pt)*Tt.scale-ji+jr[0],bi=(-Tt.metrics.top-Pt)*Tt.scale+jr[1],ur=Br+ot.w/Ra*Tt.scale/Xt,hr=bi+ot.h/Ra*Tt.scale/Xt,vr=new ie(Br,bi),ra=new ie(ur,bi),za=new ie(Br,hr),zi=new ie(ur,hr);if(Sn){const Xi=new ie(-ji,ji-$d),Wi=-Math.PI/2,fi=Vi/2-ji,Ti=new ie(5-$d-fi,-(Tt.imageName?fi:0)),lo=new ie(...ga);vr._rotateAround(Wi,Xi)._add(Ti)._add(lo),ra._rotateAround(Wi,Xi)._add(Ti)._add(lo),za._rotateAround(Wi,Xi)._add(Ti)._add(lo),zi._rotateAround(Wi,Xi)._add(Ti)._add(lo)}if(tt){const Xi=Math.sin(tt),Wi=Math.cos(tt),fi=[Wi,-Xi,Xi,Wi];vr._matMult(fi),ra._matMult(fi),za._matMult(fi),zi._matMult(fi)}const dr=new ie(0,0),wi=new ie(0,0);wt.push({tl:vr,tr:ra,bl:za,br:zi,tex:ot,writingMode:ye.writingMode,glyphOffset:nr,sectionIndex:Tt.sectionIndex,isSDF:Jt,pixelOffsetTL:dr,pixelOffsetBR:wi,minFontScaleX:0,minFontScaleY:0})}return wt}(0,l,A,y,T,E,d,o.allowVerticalPlacement),le=o.textSizeData;let fe=null;le.kind==="source"?(fe=[Go*y.layout.get("text-size").evaluate(E,{})],fe[0]>Ec&&Mi(`${o.layerIds[0]}: Value for "text-size" is >= ${Yd}. Reduce your "text-size".`)):le.kind==="composite"&&(fe=[Go*q.compositeTextSizes[0].evaluate(E,{},W),Go*q.compositeTextSizes[1].evaluate(E,{},W)],(fe[0]>Ec||fe[1]>Ec)&&Mi(`${o.layerIds[0]}: Value for "text-size" is >= ${Yd}. Reduce your "text-size".`)),o.addSymbols(o.text,J,fe,A,T,E,L,t,I.lineStartIndex,I.lineLength,$,W);for(const Ee of O)B[Ee]=o.text.placedSymbolArray.length-1;return 4*J.length}function v0(o){for(const t in o)return o[t];return null}function _y(o,t,l,d){const y=o.compareText;if(t in y){const T=y[t];for(let E=T.length-1;E>=0;E--)if(d.dist(T[E])<l)return!0}else y[t]=[];return y[t].push(d),!1}const x0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ys{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,d]=new Uint8Array(t,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=d>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const T=x0[15&d];if(!T)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(t,2,1),[A]=new Uint32Array(t,4,1);return new ys(A,E,T,t)}constructor(t,l=64,d=Float64Array,y){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const T=x0.indexOf(this.ArrayType),E=2*t*this.ArrayType.BYTES_PER_ELEMENT,A=t*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-A%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${d}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+I,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+E+A+I),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+I,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=t)}add(t,l){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=t,this.coords[this._pos++]=l,d}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return fp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,l,d,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:E,nodeSize:A}=this,I=[0,T.length-1,0],L=[];for(;I.length;){const O=I.pop()||0,B=I.pop()||0,$=I.pop()||0;if(B-$<=A){for(let le=$;le<=B;le++){const fe=E[2*le],Ee=E[2*le+1];fe>=t&&fe<=d&&Ee>=l&&Ee<=y&&L.push(T[le])}continue}const q=$+B>>1,W=E[2*q],J=E[2*q+1];W>=t&&W<=d&&J>=l&&J<=y&&L.push(T[q]),(O===0?t<=W:l<=J)&&(I.push($),I.push(q-1),I.push(1-O)),(O===0?d>=W:y>=J)&&(I.push(q+1),I.push(B),I.push(1-O))}return L}within(t,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:T,nodeSize:E}=this,A=[0,y.length-1,0],I=[],L=d*d;for(;A.length;){const O=A.pop()||0,B=A.pop()||0,$=A.pop()||0;if(B-$<=E){for(let le=$;le<=B;le++)_s(T[2*le],T[2*le+1],t,l)<=L&&I.push(y[le]);continue}const q=$+B>>1,W=T[2*q],J=T[2*q+1];_s(W,J,t,l)<=L&&I.push(y[q]),(O===0?t-d<=W:l-d<=J)&&(A.push($),A.push(q-1),A.push(1-O)),(O===0?t+d>=W:l+d>=J)&&(A.push(q+1),A.push(B),A.push(1-O))}return I}}function fp(o,t,l,d,y,T){if(y-d<=l)return;const E=d+y>>1;vy(o,t,E,d,y,T),fp(o,t,l,d,E-1,1-T),fp(o,t,l,E+1,y,1-T)}function vy(o,t,l,d,y,T){for(;y>d;){if(y-d>600){const L=y-d+1,O=l-d+1,B=Math.log(L),$=.5*Math.exp(2*B/3),q=.5*Math.sqrt(B*$*(L-$)/L)*(O-L/2<0?-1:1);vy(o,t,l,Math.max(d,Math.floor(l-O*$/L+q)),Math.min(y,Math.floor(l+(L-O)*$/L+q)),T)}const E=t[2*l+T];let A=d,I=y;for(Xd(o,t,d,l),t[2*y+T]>E&&Xd(o,t,d,y);A<I;){for(Xd(o,t,A,I),A++,I--;t[2*A+T]<E;)A++;for(;t[2*I+T]>E;)I--}t[2*d+T]===E?Xd(o,t,d,I):(I++,Xd(o,t,I,y)),I<=l&&(d=I+1),l<=I&&(y=I-1)}}function Xd(o,t,l,d){Ch(o,l,d),Ch(t,2*l,2*d),Ch(t,2*l+1,2*d+1)}function Ch(o,t,l){const d=o[t];o[t]=o[l],o[l]=d}function _s(o,t,l,d){const y=o-l,T=t-d;return y*y+T*T}var jm;v.ck=void 0,(jm=v.ck||(v.ck={})).create="create",jm.load="load",jm.fullLoad="fullLoad";let Dh=null,vs=[];const xy=1e3/60,by="loadTime",pu="fullLoadTime",b0={mark(o){performance.mark(o)},frame(o){const t=o;Dh!=null&&vs.push(t-Dh),Dh=t},clearMetrics(){Dh=null,vs=[],performance.clearMeasures(by),performance.clearMeasures(pu);for(const o in v.ck)performance.clearMarks(v.ck[o])},getPerformanceMetrics(){performance.measure(by,v.ck.create,v.ck.load),performance.measure(pu,v.ck.create,v.ck.fullLoad);const o=performance.getEntriesByName(by)[0].duration,t=performance.getEntriesByName(pu)[0].duration,l=vs.length,d=1/(vs.reduce((T,E)=>T+E,0)/l/1e3),y=vs.filter(T=>T>xy).reduce((T,E)=>T+(E-xy)/xy,0);return{loadTime:o,fullLoadTime:t,fps:d,percentDroppedFrames:y/(l+y)*100,totalFrames:l}}};v.$=cp,v.A=nt,v.B=Sa,v.C=ci,v.D=Zt,v.E=re,v.F=kg,v.G=function(o){if(Zn==null){const t=o.navigator?o.navigator.userAgent:null;Zn=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Zn},v.H=class{constructor(o,t){this.target=o,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new l0(()=>this.process()),this.subscription=rr(this.target,"message",l=>this.receive(l),!1),this.globalScope=Er(self)?o:window}registerMessageHandler(o,t){this.messageHandlers[o]=t}sendAsync(o,t){return new Promise((l,d)=>{const y=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=t?rr(t.signal,"abort",()=>{T==null||T.unsubscribe(),delete this.resolveRejects[y];const I={id:y,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(I)},c0):null;this.resolveRejects[y]={resolve:I=>{T==null||T.unsubscribe(),l(I)},reject:I=>{T==null||T.unsubscribe(),d(I)}};const E=[],A=Object.assign(Object.assign({},o),{id:y,sourceMapId:this.mapId,origin:location.origin,data:hc(o.data,E)});this.target.postMessage(A,{transfer:E})})}receive(o){const t=o.data,l=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[l];const d=this.abortControllers[l];return delete this.abortControllers[l],void(d&&d.abort())}if(Er(self)||t.mustQueue)return this.tasks[l]=t,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,t)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),t=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(o,t)}processTask(o,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const y=this.resolveRejects[o];return delete this.resolveRejects[o],y?void(t.error?y.reject(Oo(t.error)):y.resolve(Oo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=Oo(t.data),d=new AbortController;this.abortControllers[o]=d;try{const y=yield this.messageHandlers[t.type](t.sourceMapId,l,d);this.completeTask(o,null,y)}catch(y){this.completeTask(o,y)}})}completeTask(o,t,l){const d=[];delete this.abortControllers[o];const y={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?hc(t):null,data:hc(l,d)};this.target.postMessage(y,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.I=ep,v.J=pr,v.K=function(){var o=new nt(16);return nt!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},v.L=function(o,t,l){var d,y,T,E,A,I,L,O,B,$,q,W,J=l[0],le=l[1],fe=l[2];return t===o?(o[12]=t[0]*J+t[4]*le+t[8]*fe+t[12],o[13]=t[1]*J+t[5]*le+t[9]*fe+t[13],o[14]=t[2]*J+t[6]*le+t[10]*fe+t[14],o[15]=t[3]*J+t[7]*le+t[11]*fe+t[15]):(y=t[1],T=t[2],E=t[3],A=t[4],I=t[5],L=t[6],O=t[7],B=t[8],$=t[9],q=t[10],W=t[11],o[0]=d=t[0],o[1]=y,o[2]=T,o[3]=E,o[4]=A,o[5]=I,o[6]=L,o[7]=O,o[8]=B,o[9]=$,o[10]=q,o[11]=W,o[12]=d*J+A*le+B*fe+t[12],o[13]=y*J+I*le+$*fe+t[13],o[14]=T*J+L*le+q*fe+t[14],o[15]=E*J+O*le+W*fe+t[15]),o},v.M=function(o,t,l){var d=l[0],y=l[1],T=l[2];return o[0]=t[0]*d,o[1]=t[1]*d,o[2]=t[2]*d,o[3]=t[3]*d,o[4]=t[4]*y,o[5]=t[5]*y,o[6]=t[6]*y,o[7]=t[7]*y,o[8]=t[8]*T,o[9]=t[9]*T,o[10]=t[10]*T,o[11]=t[11]*T,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},v.N=function(o,t,l){var d=t[0],y=t[1],T=t[2],E=t[3],A=t[4],I=t[5],L=t[6],O=t[7],B=t[8],$=t[9],q=t[10],W=t[11],J=t[12],le=t[13],fe=t[14],Ee=t[15],ye=l[0],Y=l[1],oe=l[2],ve=l[3];return o[0]=ye*d+Y*A+oe*B+ve*J,o[1]=ye*y+Y*I+oe*$+ve*le,o[2]=ye*T+Y*L+oe*q+ve*fe,o[3]=ye*E+Y*O+oe*W+ve*Ee,o[4]=(ye=l[4])*d+(Y=l[5])*A+(oe=l[6])*B+(ve=l[7])*J,o[5]=ye*y+Y*I+oe*$+ve*le,o[6]=ye*T+Y*L+oe*q+ve*fe,o[7]=ye*E+Y*O+oe*W+ve*Ee,o[8]=(ye=l[8])*d+(Y=l[9])*A+(oe=l[10])*B+(ve=l[11])*J,o[9]=ye*y+Y*I+oe*$+ve*le,o[10]=ye*T+Y*L+oe*q+ve*fe,o[11]=ye*E+Y*O+oe*W+ve*Ee,o[12]=(ye=l[12])*d+(Y=l[13])*A+(oe=l[14])*B+(ve=l[15])*J,o[13]=ye*y+Y*I+oe*$+ve*le,o[14]=ye*T+Y*L+oe*q+ve*fe,o[15]=ye*E+Y*O+oe*W+ve*Ee,o},v.O=function(o,t){const l={};for(let d=0;d<t.length;d++){const y=t[d];y in o&&(l[y]=o[y])}return l},v.P=ie,v.Q=Ac,v.R=qa,v.S=uy,v.T=dc,v.U=cy,v.V=He,v.W=$e,v.X=li,v.Y=Ka,v.Z=Oe,v._=c,v.a=Xr,v.a$=function(o,t,l){var d=Math.sin(l),y=Math.cos(l),T=t[4],E=t[5],A=t[6],I=t[7],L=t[8],O=t[9],B=t[10],$=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=T*y+L*d,o[5]=E*y+O*d,o[6]=A*y+B*d,o[7]=I*y+$*d,o[8]=L*y-T*d,o[9]=O*y-E*d,o[10]=B*y-A*d,o[11]=$*y-I*d,o},v.a0=25,v.a1=Eh,v.a2=o=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(l=>{t.onloadstart=()=>{l(t)};for(const d of o){const y=window.document.createElement("source");zu(d)||(t.crossOrigin="Anonymous"),y.src=d,t.appendChild(y)}})},v.a3=Xe,v.a4=function(){return tn++},v.a5=R,v.a6=Th,v.a7=Qu,v.a8=ps,v.a9=Im,v.aA=Om,v.aB=xm,v.aC=ys,v.aD=on,v.aE=Kf,v.aF=xe,v.aG=pn,v.aH=ut,v.aI=function(o){return Math.pow(2,o)},v.aJ=85.051129,v.aK=h0,v.aL=zt,v.aM=fr,v.aN=Dm,v.aO=function(o,t,l){return o[0]=t[0]*l,o[1]=t[1]*l,o[2]=t[2]*l,o},v.aP=function(o,t,l){return o[0]=t[0]+l[0],o[1]=t[1]+l[1],o[2]=t[2]+l[2],o},v.aQ=function(o){var t=new nt(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t},v.aR=function(o,t,l){return o[0]=t[0]*l[0],o[1]=t[1]*l[1],o[2]=t[2]*l[2],o[3]=t[3]*l[3],o},v.aS=function(o,t,l){return o[0]=t[0]-l[0],o[1]=t[1]-l[1],o[2]=t[2]-l[2],o},v.aT=function(o,t){var l=t[0],d=t[1],y=t[2],T=l*l+d*d+y*y;return T>0&&(T=1/Math.sqrt(T)),o[0]=t[0]*T,o[1]=t[1]*T,o[2]=t[2]*T,o},v.aU=function(o,t,l){var d=t[0],y=t[1],T=t[2],E=l[0],A=l[1],I=l[2];return o[0]=y*I-T*A,o[1]=T*E-d*I,o[2]=d*A-y*E,o},v.aV=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]},v.aW=f0,v.aX=En,v.aY=function(o,t,l,d,y){var T,E=1/Math.tan(t/2);return o[0]=E/l,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=E,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,y!=null&&y!==1/0?(o[10]=(y+d)*(T=1/(d-y)),o[14]=2*y*d*T):(o[10]=-1,o[14]=-2*d),o},v.aZ=function(o){var t=new nt(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},v.a_=function(o,t,l){var d=Math.sin(l),y=Math.cos(l),T=t[0],E=t[1],A=t[2],I=t[3],L=t[4],O=t[5],B=t[6],$=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=T*y+L*d,o[1]=E*y+O*d,o[2]=A*y+B*d,o[3]=I*y+$*d,o[4]=L*y-T*d,o[5]=O*y-E*d,o[6]=B*y-A*d,o[7]=$*y-I*d,o},v.aa=function(o){const t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,y,T)=>{const E=y||T;return t[d]=!E||E.toLowerCase(),""}),t["max-age"]){const l=parseInt(t["max-age"],10);isNaN(l)?delete t["max-age"]:t["max-age"]=l}return t},v.ab=function(o){return Math.log(o)/Math.LN2},v.ac=function(o){var t=o[0],l=o[1];return t*t+l*l},v.ad=function(o){return o*Math.PI/180},v.ae=St,v.af=function(o,t){const l=[];for(const d in o)d in t||l.push(d);return l},v.ag=function(o,t){let l=0,d=0;if(o.kind==="constant")d=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:y,minZoom:T,maxZoom:E}=o,A=y?St(Zr.interpolationFactor(y,t,T,E),0,1):0;o.kind==="camera"?d=Sa.number(o.minSize,o.maxSize,A):l=A}return{uSizeT:l,uSize:d}},v.ai=function(o,{uSize:t,uSizeT:l},{lowerSize:d,upperSize:y}){return o.kind==="source"?d/Go:o.kind==="composite"?Sa.number(d/Go,y/Go,l):t},v.aj=function(o,t){var l=t[0],d=t[1],y=t[2],T=t[3],E=t[4],A=t[5],I=t[6],L=t[7],O=t[8],B=t[9],$=t[10],q=t[11],W=t[12],J=t[13],le=t[14],fe=t[15],Ee=l*A-d*E,ye=l*I-y*E,Y=l*L-T*E,oe=d*I-y*A,ve=d*L-T*A,Ve=y*L-T*I,pt=O*J-B*W,qe=O*le-$*W,tt=O*fe-q*W,wt=B*le-$*J,ft=B*fe-q*J,Tt=$*fe-q*le,ot=Ee*Tt-ye*ft+Y*wt+oe*tt-ve*qe+Ve*pt;return ot?(o[0]=(A*Tt-I*ft+L*wt)*(ot=1/ot),o[1]=(y*ft-d*Tt-T*wt)*ot,o[2]=(J*Ve-le*ve+fe*oe)*ot,o[3]=($*ve-B*Ve-q*oe)*ot,o[4]=(I*tt-E*Tt-L*qe)*ot,o[5]=(l*Tt-y*tt+T*qe)*ot,o[6]=(le*Y-W*Ve-fe*ye)*ot,o[7]=(O*Ve-$*Y+q*ye)*ot,o[8]=(E*ft-A*tt+L*pt)*ot,o[9]=(d*tt-l*ft-T*pt)*ot,o[10]=(W*ve-J*Y+fe*Ee)*ot,o[11]=(B*Y-O*ve-q*Ee)*ot,o[12]=(A*qe-E*wt-I*pt)*ot,o[13]=(l*wt-d*qe+y*pt)*ot,o[14]=(J*ye-W*oe-le*Ee)*ot,o[15]=(O*oe-B*ye+$*Ee)*ot,o):null},v.ak=Wt,v.al=function(o){return Math.hypot(o[0],o[1])},v.am=function(o){return o[0]=0,o[1]=0,o},v.an=function(o,t,l){return o[0]=t[0]*l,o[1]=t[1]*l,o},v.ao=Em,v.ap=Ot,v.aq=function(o,t,l,d){const y=t.y-o.y,T=t.x-o.x,E=d.y-l.y,A=d.x-l.x,I=E*T-A*y;if(I===0)return null;const L=(A*(o.y-l.y)-E*(o.x-l.x))/I;return new ie(o.x+L*T,o.y+L*y)},v.ar=Sh,v.as=uh,v.at=Re,v.au=function(o){let t=1/0,l=1/0,d=-1/0,y=-1/0;for(const T of o)t=Math.min(t,T.x),l=Math.min(l,T.y),d=Math.max(d,T.x),y=Math.max(y,T.y);return[t,l,d,y]},v.av=Vi,v.aw=vt,v.ax=function(o,t,l,d,y=!1){if(!l[0]&&!l[1])return[0,0];const T=y?d==="map"?-o.bearingInRadians:0:d==="viewport"?o.bearingInRadians:0;if(T){const E=Math.sin(T),A=Math.cos(T);l=[l[0]*A-l[1]*E,l[0]*E+l[1]*A]}return[y?l[0]:vt(t,l[0],o.zoom),y?l[1]:vt(t,l[1],o.zoom)]},v.az=wm,v.b=Gn,v.b$=o=>o.type==="symbol",v.b0=function(){const o=new Float32Array(16);return Re(o),o},v.b1=function(){const o=new Float64Array(16);return Re(o),o},v.b2=function(){return new Float64Array(16)},v.b3=function(o,t,l){const d=new Float64Array(4);return function(y,T,E,A){var I=.5*Math.PI/180;T*=I,E*=I,A*=I;var L=Math.sin(T),O=Math.cos(T),B=Math.sin(E),$=Math.cos(E),q=Math.sin(A),W=Math.cos(A);y[0]=L*$*W-O*B*q,y[1]=O*B*W+L*$*q,y[2]=O*$*q-L*B*W,y[3]=O*$*W+L*B*q}(d,o,t-90,l),d},v.b4=function(o,t,l,d){var y,T,E,A,I,L=t[0],O=t[1],B=t[2],$=t[3],q=l[0],W=l[1],J=l[2],le=l[3];return(T=L*q+O*W+B*J+$*le)<0&&(T=-T,q=-q,W=-W,J=-J,le=-le),1-T>Ze?(y=Math.acos(T),E=Math.sin(y),A=Math.sin((1-d)*y)/E,I=Math.sin(d*y)/E):(A=1-d,I=d),o[0]=A*L+I*q,o[1]=A*O+I*W,o[2]=A*B+I*J,o[3]=A*$+I*le,o},v.b5=function(o){const t=new Float64Array(9);var l,d,y,T,E,A,I,L,O,B,$,q,W,J,le,fe,Ee,ye;B=(y=(d=o)[0])*(I=y+y),$=(T=d[1])*I,W=(E=d[2])*I,J=E*(L=T+T),fe=(A=d[3])*I,Ee=A*L,ye=A*(O=E+E),(l=t)[0]=1-(q=T*L)-(le=E*O),l[3]=$-ye,l[6]=W+Ee,l[1]=$+ye,l[4]=1-B-le,l[7]=J-fe,l[2]=W-Ee,l[5]=J+fe,l[8]=1-B-q;const Y=fr(-Math.asin(St(t[2],-1,1)));let oe,ve;return Math.hypot(t[5],t[8])<.001?(oe=0,ve=-fr(Math.atan2(t[3],t[4]))):(oe=fr(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ve=fr(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:oe,pitch:Y+90,bearing:ve}},v.b6=function(o,t){return o.roll==t.roll&&o.pitch==t.pitch&&o.bearing==t.bearing},v.b7=kn,v.b8=fs,v.b9=gh,v.bA=function(o,t){if(!o)return[{command:"setStyle",args:[t]}];let l=[];try{if(!Ae(o.version,t.version))return[{command:"setStyle",args:[t]}];Ae(o.center,t.center)||l.push({command:"setCenter",args:[t.center]}),Ae(o.centerAltitude,t.centerAltitude)||l.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Ae(o.zoom,t.zoom)||l.push({command:"setZoom",args:[t.zoom]}),Ae(o.bearing,t.bearing)||l.push({command:"setBearing",args:[t.bearing]}),Ae(o.pitch,t.pitch)||l.push({command:"setPitch",args:[t.pitch]}),Ae(o.roll,t.roll)||l.push({command:"setRoll",args:[t.roll]}),Ae(o.sprite,t.sprite)||l.push({command:"setSprite",args:[t.sprite]}),Ae(o.glyphs,t.glyphs)||l.push({command:"setGlyphs",args:[t.glyphs]}),Ae(o.transition,t.transition)||l.push({command:"setTransition",args:[t.transition]}),Ae(o.light,t.light)||l.push({command:"setLight",args:[t.light]}),Ae(o.terrain,t.terrain)||l.push({command:"setTerrain",args:[t.terrain]}),Ae(o.sky,t.sky)||l.push({command:"setSky",args:[t.sky]}),Ae(o.projection,t.projection)||l.push({command:"setProjection",args:[t.projection]});const d={},y=[];(function(E,A,I,L){let O;for(O in A=A||{},E=E||{})Object.prototype.hasOwnProperty.call(E,O)&&(Object.prototype.hasOwnProperty.call(A,O)||rt(O,I,L));for(O in A)Object.prototype.hasOwnProperty.call(A,O)&&(Object.prototype.hasOwnProperty.call(E,O)?Ae(E[O],A[O])||(E[O].type==="geojson"&&A[O].type==="geojson"&&je(E,A,O)?Be(I,{command:"setGeoJSONSourceData",args:[O,A[O].data]}):Je(O,A,I,L)):ze(O,A,I))})(o.sources,t.sources,y,d);const T=[];o.layers&&o.layers.forEach(E=>{"source"in E&&d[E.source]?l.push({command:"removeLayer",args:[E.id]}):T.push(E)}),l=l.concat(y),function(E,A,I){A=A||[];const L=(E=E||[]).map(Ct),O=A.map(Ct),B=E.reduce(Rt,{}),$=A.reduce(Rt,{}),q=L.slice(),W=Object.create(null);let J,le,fe,Ee,ye;for(let Y=0,oe=0;Y<L.length;Y++)J=L[Y],Object.prototype.hasOwnProperty.call($,J)?oe++:(Be(I,{command:"removeLayer",args:[J]}),q.splice(q.indexOf(J,oe),1));for(let Y=0,oe=0;Y<O.length;Y++)J=O[O.length-1-Y],q[q.length-1-Y]!==J&&(Object.prototype.hasOwnProperty.call(B,J)?(Be(I,{command:"removeLayer",args:[J]}),q.splice(q.lastIndexOf(J,q.length-oe),1)):oe++,Ee=q[q.length-Y],Be(I,{command:"addLayer",args:[$[J],Ee]}),q.splice(q.length-Y,0,J),W[J]=!0);for(let Y=0;Y<O.length;Y++)if(J=O[Y],le=B[J],fe=$[J],!W[J]&&!Ae(le,fe))if(Ae(le.source,fe.source)&&Ae(le["source-layer"],fe["source-layer"])&&Ae(le.type,fe.type)){for(ye in ht(le.layout,fe.layout,I,J,null,"setLayoutProperty"),ht(le.paint,fe.paint,I,J,null,"setPaintProperty"),Ae(le.filter,fe.filter)||Be(I,{command:"setFilter",args:[J,fe.filter]}),Ae(le.minzoom,fe.minzoom)&&Ae(le.maxzoom,fe.maxzoom)||Be(I,{command:"setLayerZoomRange",args:[J,fe.minzoom,fe.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?ht(le[ye],fe[ye],I,J,ye.slice(6),"setPaintProperty"):Ae(le[ye],fe[ye])||Be(I,{command:"setLayerProperty",args:[J,ye,fe[ye]]}));for(ye in fe)Object.prototype.hasOwnProperty.call(fe,ye)&&!Object.prototype.hasOwnProperty.call(le,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?ht(le[ye],fe[ye],I,J,ye.slice(6),"setPaintProperty"):Ae(le[ye],fe[ye])||Be(I,{command:"setLayerProperty",args:[J,ye,fe[ye]]}))}else Be(I,{command:"removeLayer",args:[J]}),Ee=q[q.lastIndexOf(J)+1],Be(I,{command:"addLayer",args:[fe,Ee]})}(T,t.layers,l)}catch(d){console.warn("Unable to compute style diff:",d),l=[{command:"setStyle",args:[t]}]}return l},v.bB=function(o){const t=[],l=o.id;return l===void 0&&t.push({message:`layers.${l}: missing required property "id"`}),o.render===void 0&&t.push({message:`layers.${l}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&t.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),t},v.bC=function o(t,l){if(Array.isArray(t)){if(!Array.isArray(l)||t.length!==l.length)return!1;for(let d=0;d<t.length;d++)if(!o(t[d],l[d]))return!1;return!0}if(typeof t=="object"&&t!==null&&l!==null){if(typeof l!="object"||Object.keys(t).length!==Object.keys(l).length)return!1;for(const d in t)if(!o(t[d],l[d]))return!1;return!0}return t===l},v.bD=gi,v.bE=Tn,v.bF=class extends ds{constructor(o,t){super(o,t),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},v.bG=to,v.bH=class extends ds{constructor(o,t){super(o,t),this.current=mc}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let t=1;t<16;t++)if(o[t]!==this.current[t]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},v.bI=fa,v.bJ=class extends ds{constructor(o,t){super(o,t),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},v.bK=class extends ds{constructor(o,t){super(o,t),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},v.bL=Ke,v.bM=function(o,t){var l=Math.sin(t),d=Math.cos(t);return o[0]=d,o[1]=l,o[2]=0,o[3]=-l,o[4]=d,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},v.bN=function(o,t,l){var d=t[0],y=t[1],T=t[2];return o[0]=d*l[0]+y*l[3]+T*l[6],o[1]=d*l[1]+y*l[4]+T*l[7],o[2]=d*l[2]+y*l[5]+T*l[8],o},v.bO=function(o,t,l,d,y,T,E){var A=1/(t-l),I=1/(d-y),L=1/(T-E);return o[0]=-2*A,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*I,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*L,o[11]=0,o[12]=(t+l)*A,o[13]=(y+d)*I,o[14]=(E+T)*L,o[15]=1,o},v.bP=class extends Vf{},v.bQ=cr,v.bR=class extends pc{},v.bS=Or,v.bT=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},v.bU=Pr,v.bV=function(o,t,l){var d=t[0],y=t[1],T=t[2],E=l[3]*d+l[7]*y+l[11]*T+l[15];return o[0]=(l[0]*d+l[4]*y+l[8]*T+l[12])/(E=E||1),o[1]=(l[1]*d+l[5]*y+l[9]*T+l[13])/E,o[2]=(l[2]*d+l[6]*y+l[10]*T+l[14])/E,o},v.bW=class extends Ks{},v.bX=class extends w{},v.bY=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]&&o[4]===t[4]&&o[5]===t[5]&&o[6]===t[6]&&o[7]===t[7]&&o[8]===t[8]&&o[9]===t[9]&&o[10]===t[10]&&o[11]===t[11]&&o[12]===t[12]&&o[13]===t[13]&&o[14]===t[14]&&o[15]===t[15]},v.bZ=function(o,t){var l=o[0],d=o[1],y=o[2],T=o[3],E=o[4],A=o[5],I=o[6],L=o[7],O=o[8],B=o[9],$=o[10],q=o[11],W=o[12],J=o[13],le=o[14],fe=o[15],Ee=t[0],ye=t[1],Y=t[2],oe=t[3],ve=t[4],Ve=t[5],pt=t[6],qe=t[7],tt=t[8],wt=t[9],ft=t[10],Tt=t[11],ot=t[12],Pt=t[13],Jt=t[14],Xt=t[15];return Math.abs(l-Ee)<=Ze*Math.max(1,Math.abs(l),Math.abs(Ee))&&Math.abs(d-ye)<=Ze*Math.max(1,Math.abs(d),Math.abs(ye))&&Math.abs(y-Y)<=Ze*Math.max(1,Math.abs(y),Math.abs(Y))&&Math.abs(T-oe)<=Ze*Math.max(1,Math.abs(T),Math.abs(oe))&&Math.abs(E-ve)<=Ze*Math.max(1,Math.abs(E),Math.abs(ve))&&Math.abs(A-Ve)<=Ze*Math.max(1,Math.abs(A),Math.abs(Ve))&&Math.abs(I-pt)<=Ze*Math.max(1,Math.abs(I),Math.abs(pt))&&Math.abs(L-qe)<=Ze*Math.max(1,Math.abs(L),Math.abs(qe))&&Math.abs(O-tt)<=Ze*Math.max(1,Math.abs(O),Math.abs(tt))&&Math.abs(B-wt)<=Ze*Math.max(1,Math.abs(B),Math.abs(wt))&&Math.abs($-ft)<=Ze*Math.max(1,Math.abs($),Math.abs(ft))&&Math.abs(q-Tt)<=Ze*Math.max(1,Math.abs(q),Math.abs(Tt))&&Math.abs(W-ot)<=Ze*Math.max(1,Math.abs(W),Math.abs(ot))&&Math.abs(J-Pt)<=Ze*Math.max(1,Math.abs(J),Math.abs(Pt))&&Math.abs(le-Jt)<=Ze*Math.max(1,Math.abs(le),Math.abs(Jt))&&Math.abs(fe-Xt)<=Ze*Math.max(1,Math.abs(fe),Math.abs(Xt))},v.b_=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},v.ba=vc,v.bb=ms,v.bc=Qt,v.bd=Se,v.be=er,v.bf=function(o,t,l,d,y){return Qt(d,y,St((o-t)/(l-t),0,1))},v.bg=mt,v.bh=function(){return new Float64Array(4)},v.bi=function(){return new Float64Array(3)},v.bj=function(o,t,l,d){var y=[],T=[];return y[0]=t[0]-l[0],y[1]=t[1]-l[1],y[2]=t[2]-l[2],T[0]=y[0]*Math.cos(d)-y[1]*Math.sin(d),T[1]=y[0]*Math.sin(d)+y[1]*Math.cos(d),T[2]=y[2],o[0]=T[0]+l[0],o[1]=T[1]+l[1],o[2]=T[2]+l[2],o},v.bk=function(o,t,l,d){var y=[],T=[];return y[0]=t[0]-l[0],y[1]=t[1]-l[1],y[2]=t[2]-l[2],T[0]=y[0],T[1]=y[1]*Math.cos(d)-y[2]*Math.sin(d),T[2]=y[1]*Math.sin(d)+y[2]*Math.cos(d),o[0]=T[0]+l[0],o[1]=T[1]+l[1],o[2]=T[2]+l[2],o},v.bl=function(o,t,l,d){var y=[],T=[];return y[0]=t[0]-l[0],y[1]=t[1]-l[1],y[2]=t[2]-l[2],T[0]=y[2]*Math.sin(d)+y[0]*Math.cos(d),T[1]=y[1],T[2]=y[2]*Math.cos(d)-y[0]*Math.sin(d),o[0]=T[0]+l[0],o[1]=T[1]+l[1],o[2]=T[2]+l[2],o},v.bm=function(o,t,l){var d=Math.sin(l),y=Math.cos(l),T=t[0],E=t[1],A=t[2],I=t[3],L=t[8],O=t[9],B=t[10],$=t[11];return t!==o&&(o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=T*y-L*d,o[1]=E*y-O*d,o[2]=A*y-B*d,o[3]=I*y-$*d,o[8]=T*d+L*y,o[9]=E*d+O*y,o[10]=A*d+B*y,o[11]=I*d+$*y,o},v.bn=function(o,t){const l=mt(o,360),d=mt(t,360),y=d-l,T=d>l?y-360:y+360;return Math.abs(y)<Math.abs(T)?y:T},v.bo=function(o){return o[0]=0,o[1]=0,o[2]=0,o},v.bp=function(o,t,l,d){const y=Math.sqrt(o*o+t*t),T=Math.sqrt(l*l+d*d);o/=y,t/=y,l/=T,d/=T;const E=Math.acos(o*l+t*d);return-t*l+o*d>0?E:-E},v.bq=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]},v.br=Mm,v.bs=function(o,t){const l=mt(o,2*Math.PI),d=mt(t,2*Math.PI);return Math.min(Math.abs(l-d),Math.abs(l-d+2*Math.PI),Math.abs(l-d-2*Math.PI))},v.bt=function(o){return Math.hypot(o[0],o[1],o[2])},v.bu=function(){const o={},t=X.$version;for(const l in X.$root){const d=X.$root[l];if(d.required){let y=null;y=l==="version"?t:d.type==="array"?[]:{},y!=null&&(o[l]=y)}}return o},v.bv=Pf,v.bw=wo,v.bx=function(o){o=o.slice();const t=Object.create(null);for(let l=0;l<o.length;l++)t[o[l].id]=o[l];for(let l=0;l<o.length;l++)"ref"in o[l]&&(o[l]=Ce(o[l],t[o[l].ref]));return o},v.by=function(o){if(o.type==="custom")return new Lv(o);switch(o.type){case"background":return new ly(o);case"circle":return new j_(o);case"fill":return new Yg(o);case"fill-extrusion":return new jd(o);case"heatmap":return new F_(o);case"hillshade":return new V_(o);case"line":return new di(o);case"raster":return new op(o);case"symbol":return new Sc(o)}},v.bz=ni,v.c=Fs,v.c0=o=>o.type==="circle",v.c1=o=>o.type==="heatmap",v.c2=o=>o.type==="line",v.c3=o=>o.type==="fill",v.c4=o=>o.type==="fill-extrusion",v.c5=o=>o.type==="hillshade",v.c6=o=>o.type==="raster",v.c7=o=>o.type==="background",v.c8=o=>o.type==="custom",v.c9=gt,v.cA=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},v.cB=function(o,t,l,d,y){return c(this,void 0,void 0,function*(){if($e())try{return yield li(o,t,l,d,y)}catch{}return function(T,E,A,I,L){const O=T.width,B=T.height;js&&is||(js=new OffscreenCanvas(O,B),is=js.getContext("2d",{willReadFrequently:!0})),js.width=O,js.height=B,is.drawImage(T,0,0,O,B);const $=is.getImageData(E,A,I,L);return is.clearRect(0,0,O,B),$.data}(o,t,l,d,y)})},v.cC=km,v.cD=C,v.cE=j,v.cF=ao,v.cG=_m,v.cH=No,v.cI=Qs,v.ca=function(o,t,l){const d=dn(t.x-l.x,t.y-l.y),y=dn(o.x-l.x,o.y-l.y);var T,E;return fr(Math.atan2(d[0]*y[1]-d[1]*y[0],(T=d)[0]*(E=y)[0]+T[1]*E[1]))},v.cb=kt,v.cc=function(o,t){return Bs[t]&&(o instanceof MouseEvent||o instanceof WheelEvent)},v.cd=function(o,t){return xo[t]&&"touches"in o},v.ce=function(o){return xo[o]||Bs[o]},v.cf=function(o,t,l){var d=t[0],y=t[1];return o[0]=l[0]*d+l[4]*y+l[12],o[1]=l[1]*d+l[5]*y+l[13],o},v.cg=function(o,t){const{x:l,y:d}=cp.fromLngLat(t);return!(o<0||o>25||d<0||d>=1||l<0||l>=1)},v.ch=function(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},v.ci=class extends ea{},v.cj=b0,v.cl=function(o){return o.message===bo},v.cm=Gi,v.cn=function(o,t){Xr.REGISTERED_PROTOCOLS[o]=t},v.co=function(o){delete Xr.REGISTERED_PROTOCOLS[o]},v.cp=function(o,t){const l={};for(let y=0;y<o.length;y++){const T=t&&t[o[y].id]||Po(o[y]);t&&(t[o[y].id]=T);let E=l[T];E||(E=l[T]=[]),E.push(o[y])}const d=[];for(const y in l)d.push(l[y]);return d},v.cq=Lt,v.cr=up,v.cs=hy,v.ct=ty,v.cu=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=Oe/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const t=o.bucket.layers[0],l=t.layout,d=t._unevaluatedLayout._values,y={layoutIconSize:d["icon-size"].possiblyEvaluate(new ci(o.bucket.zoom+1),o.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new ci(o.bucket.zoom+1),o.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new ci(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:L,maxZoom:O}=o.bucket.textSizeData;y.compositeTextSizes=[d["text-size"].possiblyEvaluate(new ci(L),o.canonical),d["text-size"].possiblyEvaluate(new ci(O),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:L,maxZoom:O}=o.bucket.iconSizeData;y.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new ci(L),o.canonical),d["icon-size"].possiblyEvaluate(new ci(O),o.canonical)]}const T=l.get("text-line-height")*Vi,E=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",A=l.get("text-keep-upright"),I=l.get("text-size");for(const L of o.bucket.features){const O=l.get("text-font").evaluate(L,{},o.canonical).join(","),B=I.evaluate(L,{},o.canonical),$=y.layoutTextSize.evaluate(L,{},o.canonical),q=y.layoutIconSize.evaluate(L,{},o.canonical),W={horizontal:{},vertical:void 0},J=L.text;let le,fe=[0,0];if(J){const Y=J.toString(),oe=l.get("text-letter-spacing").evaluate(L,{},o.canonical)*Vi,ve=kd(Y)?oe:0,Ve=l.get("text-anchor").evaluate(L,{},o.canonical),pt=Dc(t,L,o.canonical);if(!pt){const ft=l.get("text-radial-offset").evaluate(L,{},o.canonical);fe=ft?y0(Ve,[ft*Vi,gy]):l.get("text-offset").evaluate(L,{},o.canonical).map(Tt=>Tt*Vi)}let qe=E?"center":l.get("text-justify").evaluate(L,{},o.canonical);const tt=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(L,{},o.canonical)*Vi:1/0,wt=()=>{o.bucket.allowVerticalPlacement&&Ws(Y)&&(W.vertical=ma(J,o.glyphMap,o.glyphPositions,o.imagePositions,O,tt,T,Ve,"left",ve,fe,v.ah.vertical,!0,$,B))};if(!E&&pt){const ft=new Set;if(qe==="auto")for(let ot=0;ot<pt.values.length;ot+=2)ft.add(Om(pt.values[ot]));else ft.add(qe);let Tt=!1;for(const ot of ft)if(!W.horizontal[ot])if(Tt)W.horizontal[ot]=W.horizontal[0];else{const Pt=ma(J,o.glyphMap,o.glyphPositions,o.imagePositions,O,tt,T,"center",ot,ve,fe,v.ah.horizontal,!1,$,B);Pt&&(W.horizontal[ot]=Pt,Tt=Pt.positionedLines.length===1)}wt()}else{qe==="auto"&&(qe=Om(Ve));const ft=ma(J,o.glyphMap,o.glyphPositions,o.imagePositions,O,tt,T,Ve,qe,ve,fe,v.ah.horizontal,!1,$,B);ft&&(W.horizontal[qe]=ft),wt(),Ws(Y)&&E&&A&&(W.vertical=ma(J,o.glyphMap,o.glyphPositions,o.imagePositions,O,tt,T,Ve,qe,ve,fe,v.ah.vertical,!1,$,B))}}let Ee=!1;if(L.icon&&L.icon.name){const Y=o.imageMap[L.icon.name];Y&&(le=r0(o.imagePositions[L.icon.name],l.get("icon-offset").evaluate(L,{},o.canonical),l.get("icon-anchor").evaluate(L,{},o.canonical)),Ee=!!Y.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=Ee:o.bucket.sdfIcons!==Ee&&Mi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Y.pixelRatio!==o.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const ye=v0(W.horizontal)||W.vertical;o.bucket.iconsInText=!!ye&&ye.iconsInText,(ye||le)&&yy(o.bucket,L,W,le,o.imageMap,y,$,q,fe,Ee,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},v.cv=Kg,v.cw=Pd,v.cx=bc,v.cy=Od,v.cz=Vd,v.d=zu,v.e=Yt,v.f=o=>c(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(t)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.g=Ki,v.h=o=>new Promise((t,l)=>{const d=new Image;d.onload=()=>{t(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=wa})},d.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const y=new Blob([new Uint8Array(o)],{type:"image/png"});d.src=o.byteLength?URL.createObjectURL(y):wa}),v.i=Er,v.j=(o,t)=>Fc(Yt(o,{type:"json"}),t),v.k=ee,v.l=Ne,v.m=Fc,v.n=(o,t)=>Fc(Yt(o,{type:"arrayBuffer"}),t),v.o=function(o){return new Vd(o).readFields(hu,[])},v.p=vh,v.q=Xf,v.r=Lr,v.s=rr,v.t=Cd,v.u=bn,v.v=X,v.w=Mi,v.x=Ni,v.y=Xs,v.z=function([o,t,l]){return t+=90,t*=Math.PI/180,l*=Math.PI/180,{x:o*Math.cos(t)*Math.sin(l),y:o*Math.sin(t)*Math.sin(l),z:o*Math.cos(l)}}}),p("worker",["./shared"],function(v){class c{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,re){for(const _e of ee){this._layerConfigs[_e.id]=_e;const Ce=this._layers[_e.id]=v.by(_e);Ce._featureFilter=v.a7(Ce.filter),this.keyCache[_e.id]&&delete this.keyCache[_e.id]}for(const _e of re)delete this.keyCache[_e],delete this._layerConfigs[_e],delete this._layers[_e];this.familiesBySource={};const X=v.cp(Object.values(this._layerConfigs),this.keyCache);for(const _e of X){const Ce=_e.map(je=>this._layers[je.id]),Ae=Ce[0];if(Ae.visibility==="none")continue;const Be=Ae.source||"";let ze=this.familiesBySource[Be];ze||(ze=this.familiesBySource[Be]={});const rt=Ae.sourceLayer||"_geojsonTileLayer";let Je=ze[rt];Je||(Je=ze[rt]=[]),Je.push(Ce)}}}class C{constructor(ee){const re={},X=[];for(const Be in ee){const ze=ee[Be],rt=re[Be]={};for(const Je in ze){const je=ze[+Je];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const ht={x:0,y:0,w:je.bitmap.width+2,h:je.bitmap.height+2};X.push(ht),rt[Je]={rect:ht,metrics:je.metrics}}}const{w:_e,h:Ce}=v.p(X),Ae=new v.q({width:_e||1,height:Ce||1});for(const Be in ee){const ze=ee[Be];for(const rt in ze){const Je=ze[+rt];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const je=re[Be][rt].rect;v.q.copy(Je.bitmap,Ae,{x:0,y:0},{x:je.x+1,y:je.y+1},Je.bitmap)}}this.image=Ae,this.positions=re}}v.cq("GlyphAtlas",C);class k{constructor(ee){this.tileID=new v.Y(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,re,X,_e,Ce){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new v.a5;const Ae=new v.cr(Object.keys(ee.layers).sort()),Be=new v.cs(this.tileID,this.promoteId);Be.bucketLayerIDs=[];const ze={},rt={featureIndex:Be,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X,subdivisionGranularity:Ce},Je=re.familiesBySource[this.source];for(const Mt in Je){const sn=ee.layers[Mt];if(!sn)continue;sn.version===1&&v.w(`Vector tile source "${this.source}" layer "${Mt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ci=Ae.encode(Mt),sa=[];for(let qt=0;qt<sn.length;qt++){const Bi=sn.feature(qt),$n=Be.getId(Bi,Mt);sa.push({feature:Bi,id:$n,index:qt,sourceLayerIndex:Ci})}for(const qt of Je[Mt]){const Bi=qt[0];Bi.source!==this.source&&v.w(`layer.source = ${Bi.source} does not equal this.source = ${this.source}`),Bi.minzoom&&this.zoom<Math.floor(Bi.minzoom)||Bi.maxzoom&&this.zoom>=Bi.maxzoom||Bi.visibility!=="none"&&(P(qt,this.zoom,X),(ze[Bi.id]=Bi.createBucket({index:Be.bucketLayerIDs.length,layers:qt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ci,sourceID:this.source})).populate(sa,rt,this.tileID.canonical),Be.bucketLayerIDs.push(qt.map($n=>$n.id)))}}const je=v.bD(rt.glyphDependencies,Mt=>Object.keys(Mt).map(Number));this.inFlightDependencies.forEach(Mt=>Mt==null?void 0:Mt.abort()),this.inFlightDependencies=[];let ht=Promise.resolve({});if(Object.keys(je).length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),ht=_e.sendAsync({type:"GG",data:{stacks:je,source:this.source,tileID:this.tileID,type:"glyphs"}},Mt)}const Ct=Object.keys(rt.iconDependencies);let Rt=Promise.resolve({});if(Ct.length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),Rt=_e.sendAsync({type:"GI",data:{icons:Ct,source:this.source,tileID:this.tileID,type:"icons"}},Mt)}const Xe=Object.keys(rt.patternDependencies);let $t=Promise.resolve({});if(Xe.length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),$t=_e.sendAsync({type:"GI",data:{icons:Xe,source:this.source,tileID:this.tileID,type:"patterns"}},Mt)}const[jt,nn,Cn]=yield Promise.all([ht,Rt,$t]),yt=new C(jt),Bt=new v.ct(nn,Cn);for(const Mt in ze){const sn=ze[Mt];sn instanceof v.a6?(P(sn.layers,this.zoom,X),v.cu({bucket:sn,glyphMap:jt,glyphPositions:yt.positions,imageMap:nn,imagePositions:Bt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:rt.subdivisionGranularity})):sn.hasPattern&&(sn instanceof v.cv||sn instanceof v.cw||sn instanceof v.cx)&&(P(sn.layers,this.zoom,X),sn.addFeatures(rt,this.tileID.canonical,Bt.patternPositions))}return this.status="done",{buckets:Object.values(ze).filter(Mt=>!Mt.isEmpty()),featureIndex:Be,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yt.image,imageAtlas:Bt,glyphMap:this.returnDependencies?jt:null,iconMap:this.returnDependencies?nn:null,glyphPositions:this.returnDependencies?yt.positions:null}})}}function P(Ne,ee,re){const X=new v.C(ee);for(const _e of Ne)_e.recalculate(X,re)}class j{constructor(ee,re,X){this.actor=ee,this.layerIndex=re,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,re){return v._(this,void 0,void 0,function*(){const X=yield v.n(ee.request,re);try{return{vectorTile:new v.cy.VectorTile(new v.cz(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(_e){const Ce=new Uint8Array(X.data);let Ae=`Unable to parse the tile at ${ee.request.url}, `;throw Ae+=Ce[0]===31&&Ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${_e.message}`,new Error(Ae)}})}loadTile(ee){return v._(this,void 0,void 0,function*(){const re=ee.uid,X=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new v.cA(ee.request),_e=new k(ee);this.loading[re]=_e;const Ce=new AbortController;_e.abort=Ce;try{const Ae=yield this.loadVectorTile(ee,Ce);if(delete this.loading[re],!Ae)return null;const Be=Ae.rawData,ze={};Ae.expires&&(ze.expires=Ae.expires),Ae.cacheControl&&(ze.cacheControl=Ae.cacheControl);const rt={};if(X){const je=X.finish();je&&(rt.resourceTiming=JSON.parse(JSON.stringify(je)))}_e.vectorTile=Ae.vectorTile;const Je=_e.parse(Ae.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[re]=_e,this.fetching[re]={rawTileData:Be,cacheControl:ze,resourceTiming:rt};try{const je=yield Je;return v.e({rawTileData:Be.slice(0)},je,ze,rt)}finally{delete this.fetching[re]}}catch(Ae){throw delete this.loading[re],_e.status="done",this.loaded[re]=_e,Ae}})}reloadTile(ee){return v._(this,void 0,void 0,function*(){const re=ee.uid;if(!this.loaded||!this.loaded[re])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[re];if(X.showCollisionBoxes=ee.showCollisionBoxes,X.status==="parsing"){const _e=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let Ce;if(this.fetching[re]){const{rawTileData:Ae,cacheControl:Be,resourceTiming:ze}=this.fetching[re];delete this.fetching[re],Ce=v.e({rawTileData:Ae.slice(0)},_e,Be,ze)}else Ce=_e;return Ce}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return v._(this,void 0,void 0,function*(){const re=this.loading,X=ee.uid;re&&re[X]&&re[X].abort&&(re[X].abort.abort(),delete re[X])})}removeTile(ee){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class U{constructor(){this.loaded={}}loadTile(ee){return v._(this,void 0,void 0,function*(){const{uid:re,encoding:X,rawImageData:_e,redFactor:Ce,greenFactor:Ae,blueFactor:Be,baseShift:ze}=ee,rt=_e.width+2,Je=_e.height+2,je=v.b(_e)?new v.R({width:rt,height:Je},yield v.cB(_e,-1,-1,rt,Je)):_e,ht=new v.cC(re,je,X,Ce,Ae,Be,ze);return this.loaded=this.loaded||{},this.loaded[re]=ht,ht})}removeTile(ee){const re=this.loaded,X=ee.uid;re&&re[X]&&delete re[X]}}var V,ie,me=function(){if(ie)return V;function Ne(re,X){if(re.length!==0){ee(re[0],X);for(var _e=1;_e<re.length;_e++)ee(re[_e],!X)}}function ee(re,X){for(var _e=0,Ce=0,Ae=0,Be=re.length,ze=Be-1;Ae<Be;ze=Ae++){var rt=(re[Ae][0]-re[ze][0])*(re[ze][1]+re[Ae][1]),Je=_e+rt;Ce+=Math.abs(_e)>=Math.abs(rt)?_e-Je+rt:rt-Je+_e,_e=Je}_e+Ce>=0!=!!X&&re.reverse()}return ie=1,V=function re(X,_e){var Ce,Ae=X&&X.type;if(Ae==="FeatureCollection")for(Ce=0;Ce<X.features.length;Ce++)re(X.features[Ce],_e);else if(Ae==="GeometryCollection")for(Ce=0;Ce<X.geometries.length;Ce++)re(X.geometries[Ce],_e);else if(Ae==="Feature")re(X.geometry,_e);else if(Ae==="Polygon")Ne(X.coordinates,_e);else if(Ae==="MultiPolygon")for(Ce=0;Ce<X.coordinates.length;Ce++)Ne(X.coordinates[Ce],_e);return X}}(),pe=v.cD(me);const Le=v.cy.VectorTileFeature.prototype.toGeoJSON;class Qe{constructor(ee){this._feature=ee,this.extent=v.Z,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){const ee=[];for(const re of this._feature.geometry)ee.push([new v.P(re[0],re[1])]);return ee}{const ee=[];for(const re of this._feature.geometry){const X=[];for(const _e of re)X.push(new v.P(_e[0],_e[1]));ee.push(X)}return ee}}toGeoJSON(ee,re,X){return Le.call(this,ee,re,X)}}class He{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.Z,this.length=ee.length,this._features=ee}feature(ee){return new Qe(this._features[ee])}}var $e,ke,Ze,nt={exports:{}},Ke=function(){if(Ze)return nt.exports;Ze=1;var Ne=v.cG(),ee=function(){if(ke)return $e;ke=1;var Je=v.cE(),je=v.cF().VectorTileFeature;function ht(Rt,Xe){this.options=Xe||{},this.features=Rt,this.length=Rt.length}function Ct(Rt,Xe){this.id=typeof Rt.id=="number"?Rt.id:void 0,this.type=Rt.type,this.rawGeometry=Rt.type===1?[Rt.geometry]:Rt.geometry,this.properties=Rt.tags,this.extent=Xe||4096}return $e=ht,ht.prototype.feature=function(Rt){return new Ct(this.features[Rt],this.options.extent)},Ct.prototype.loadGeometry=function(){var Rt=this.rawGeometry;this.geometry=[];for(var Xe=0;Xe<Rt.length;Xe++){for(var $t=Rt[Xe],jt=[],nn=0;nn<$t.length;nn++)jt.push(new Je($t[nn][0],$t[nn][1]));this.geometry.push(jt)}return this.geometry},Ct.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Rt=this.geometry,Xe=1/0,$t=-1/0,jt=1/0,nn=-1/0,Cn=0;Cn<Rt.length;Cn++)for(var yt=Rt[Cn],Bt=0;Bt<yt.length;Bt++){var Mt=yt[Bt];Xe=Math.min(Xe,Mt.x),$t=Math.max($t,Mt.x),jt=Math.min(jt,Mt.y),nn=Math.max(nn,Mt.y)}return[Xe,jt,$t,nn]},Ct.prototype.toGeoJSON=je.prototype.toGeoJSON,$e}();function re(Je){var je=new Ne;return function(ht,Ct){for(var Rt in ht.layers)Ct.writeMessage(3,X,ht.layers[Rt])}(Je,je),je.finish()}function X(Je,je){var ht;je.writeVarintField(15,Je.version||1),je.writeStringField(1,Je.name||""),je.writeVarintField(5,Je.extent||4096);var Ct={keys:[],values:[],keycache:{},valuecache:{}};for(ht=0;ht<Je.length;ht++)Ct.feature=Je.feature(ht),je.writeMessage(2,_e,Ct);var Rt=Ct.keys;for(ht=0;ht<Rt.length;ht++)je.writeStringField(3,Rt[ht]);var Xe=Ct.values;for(ht=0;ht<Xe.length;ht++)je.writeMessage(4,rt,Xe[ht])}function _e(Je,je){var ht=Je.feature;ht.id!==void 0&&je.writeVarintField(1,ht.id),je.writeMessage(2,Ce,Je),je.writeVarintField(3,ht.type),je.writeMessage(4,ze,ht)}function Ce(Je,je){var ht=Je.feature,Ct=Je.keys,Rt=Je.values,Xe=Je.keycache,$t=Je.valuecache;for(var jt in ht.properties){var nn=ht.properties[jt],Cn=Xe[jt];if(nn!==null){Cn===void 0&&(Ct.push(jt),Xe[jt]=Cn=Ct.length-1),je.writeVarint(Cn);var yt=typeof nn;yt!=="string"&&yt!=="boolean"&&yt!=="number"&&(nn=JSON.stringify(nn));var Bt=yt+":"+nn,Mt=$t[Bt];Mt===void 0&&(Rt.push(nn),$t[Bt]=Mt=Rt.length-1),je.writeVarint(Mt)}}}function Ae(Je,je){return(je<<3)+(7&Je)}function Be(Je){return Je<<1^Je>>31}function ze(Je,je){for(var ht=Je.loadGeometry(),Ct=Je.type,Rt=0,Xe=0,$t=ht.length,jt=0;jt<$t;jt++){var nn=ht[jt],Cn=1;Ct===1&&(Cn=nn.length),je.writeVarint(Ae(1,Cn));for(var yt=Ct===3?nn.length-1:nn.length,Bt=0;Bt<yt;Bt++){Bt===1&&Ct!==1&&je.writeVarint(Ae(2,yt-1));var Mt=nn[Bt].x-Rt,sn=nn[Bt].y-Xe;je.writeVarint(Be(Mt)),je.writeVarint(Be(sn)),Rt+=Mt,Xe+=sn}Ct===3&&je.writeVarint(Ae(7,1))}}function rt(Je,je){var ht=typeof Je;ht==="string"?je.writeStringField(1,Je):ht==="boolean"?je.writeBooleanField(7,Je):ht==="number"&&(Je%1!=0?je.writeDoubleField(3,Je):Je<0?je.writeSVarintField(6,Je):je.writeVarintField(5,Je))}return nt.exports=re,nt.exports.fromVectorTileJs=re,nt.exports.fromGeojsonVt=function(Je,je){je=je||{};var ht={};for(var Ct in Je)ht[Ct]=new ee(Je[Ct].features,je),ht[Ct].name=Ct,ht[Ct].version=je.version,ht[Ct].extent=je.extent;return re({layers:ht})},nt.exports.GeoJSONWrapper=ee,nt.exports}(),Re=v.cD(Ke);const _t={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ne=>Ne},It=Math.fround||(Ot=new Float32Array(1),Ne=>(Ot[0]=+Ne,Ot[0]));var Ot;const Vt=3,Wt=5,dn=6;class Oe{constructor(ee){this.options=Object.assign(Object.create(_t),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:re,minZoom:X,maxZoom:_e}=this.options;re&&console.time("total time");const Ce=`prepare ${ee.length} points`;re&&console.time(Ce),this.points=ee;const Ae=[];for(let ze=0;ze<ee.length;ze++){const rt=ee[ze];if(!rt.geometry)continue;const[Je,je]=rt.geometry.coordinates,ht=It(Qt(Je)),Ct=It(Se(je));Ae.push(ht,Ct,1/0,ze,-1,1),this.options.reduce&&Ae.push(0)}let Be=this.trees[_e+1]=this._createTree(Ae);re&&console.timeEnd(Ce);for(let ze=_e;ze>=X;ze--){const rt=+Date.now();Be=this.trees[ze]=this._createTree(this._cluster(Be,ze)),re&&console.log("z%d: %d clusters in %dms",ze,Be.numItems,+Date.now()-rt)}return re&&console.timeEnd("total time"),this}getClusters(ee,re){let X=((ee[0]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,ee[1]));let Ce=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)X=-180,Ce=180;else if(X>Ce){const je=this.getClusters([X,_e,180,Ae],re),ht=this.getClusters([-180,_e,Ce,Ae],re);return je.concat(ht)}const Be=this.trees[this._limitZoom(re)],ze=Be.range(Qt(X),Se(Ae),Qt(Ce),Se(_e)),rt=Be.data,Je=[];for(const je of ze){const ht=this.stride*je;Je.push(rt[ht+Wt]>1?vt(rt,ht,this.clusterProps):this.points[rt[ht+Vt]])}return Je}getChildren(ee){const re=this._getOriginId(ee),X=this._getOriginZoom(ee),_e="No cluster with the specified id.",Ce=this.trees[X];if(!Ce)throw new Error(_e);const Ae=Ce.data;if(re*this.stride>=Ae.length)throw new Error(_e);const Be=this.options.radius/(this.options.extent*Math.pow(2,X-1)),ze=Ce.within(Ae[re*this.stride],Ae[re*this.stride+1],Be),rt=[];for(const Je of ze){const je=Je*this.stride;Ae[je+4]===ee&&rt.push(Ae[je+Wt]>1?vt(Ae,je,this.clusterProps):this.points[Ae[je+Vt]])}if(rt.length===0)throw new Error(_e);return rt}getLeaves(ee,re,X){const _e=[];return this._appendLeaves(_e,ee,re=re||10,X=X||0,0),_e}getTile(ee,re,X){const _e=this.trees[this._limitZoom(ee)],Ce=Math.pow(2,ee),{extent:Ae,radius:Be}=this.options,ze=Be/Ae,rt=(X-ze)/Ce,Je=(X+1+ze)/Ce,je={features:[]};return this._addTileFeatures(_e.range((re-ze)/Ce,rt,(re+1+ze)/Ce,Je),_e.data,re,X,Ce,je),re===0&&this._addTileFeatures(_e.range(1-ze/Ce,rt,1,Je),_e.data,Ce,X,Ce,je),re===Ce-1&&this._addTileFeatures(_e.range(0,rt,ze/Ce,Je),_e.data,-1,X,Ce,je),je.features.length?je:null}getClusterExpansionZoom(ee){let re=this._getOriginZoom(ee)-1;for(;re<=this.options.maxZoom;){const X=this.getChildren(ee);if(re++,X.length!==1)break;ee=X[0].properties.cluster_id}return re}_appendLeaves(ee,re,X,_e,Ce){const Ae=this.getChildren(re);for(const Be of Ae){const ze=Be.properties;if(ze&&ze.cluster?Ce+ze.point_count<=_e?Ce+=ze.point_count:Ce=this._appendLeaves(ee,ze.cluster_id,X,_e,Ce):Ce<_e?Ce++:ee.push(Be),ee.length===X)break}return Ce}_createTree(ee){const re=new v.aC(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<ee.length;X+=this.stride)re.add(ee[X],ee[X+1]);return re.finish(),re.data=ee,re}_addTileFeatures(ee,re,X,_e,Ce,Ae){for(const Be of ee){const ze=Be*this.stride,rt=re[ze+Wt]>1;let Je,je,ht;if(rt)Je=mt(re,ze,this.clusterProps),je=re[ze],ht=re[ze+1];else{const Xe=this.points[re[ze+Vt]];Je=Xe.properties;const[$t,jt]=Xe.geometry.coordinates;je=Qt($t),ht=Se(jt)}const Ct={type:1,geometry:[[Math.round(this.options.extent*(je*Ce-X)),Math.round(this.options.extent*(ht*Ce-_e))]],tags:Je};let Rt;Rt=rt||this.options.generateId?re[ze+Vt]:this.points[re[ze+Vt]].id,Rt!==void 0&&(Ct.id=Rt),Ae.features.push(Ct)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,re){const{radius:X,extent:_e,reduce:Ce,minPoints:Ae}=this.options,Be=X/(_e*Math.pow(2,re)),ze=ee.data,rt=[],Je=this.stride;for(let je=0;je<ze.length;je+=Je){if(ze[je+2]<=re)continue;ze[je+2]=re;const ht=ze[je],Ct=ze[je+1],Rt=ee.within(ze[je],ze[je+1],Be),Xe=ze[je+Wt];let $t=Xe;for(const jt of Rt){const nn=jt*Je;ze[nn+2]>re&&($t+=ze[nn+Wt])}if($t>Xe&&$t>=Ae){let jt,nn=ht*Xe,Cn=Ct*Xe,yt=-1;const Bt=((je/Je|0)<<5)+(re+1)+this.points.length;for(const Mt of Rt){const sn=Mt*Je;if(ze[sn+2]<=re)continue;ze[sn+2]=re;const Ci=ze[sn+Wt];nn+=ze[sn]*Ci,Cn+=ze[sn+1]*Ci,ze[sn+4]=Bt,Ce&&(jt||(jt=this._map(ze,je,!0),yt=this.clusterProps.length,this.clusterProps.push(jt)),Ce(jt,this._map(ze,sn)))}ze[je+4]=Bt,rt.push(nn/$t,Cn/$t,1/0,Bt,-1,$t),Ce&&rt.push(yt)}else{for(let jt=0;jt<Je;jt++)rt.push(ze[je+jt]);if($t>1)for(const jt of Rt){const nn=jt*Je;if(!(ze[nn+2]<=re)){ze[nn+2]=re;for(let Cn=0;Cn<Je;Cn++)rt.push(ze[nn+Cn])}}}}return rt}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,re,X){if(ee[re+Wt]>1){const Ae=this.clusterProps[ee[re+dn]];return X?Object.assign({},Ae):Ae}const _e=this.points[ee[re+Vt]].properties,Ce=this.options.map(_e);return X&&Ce===_e?Object.assign({},Ce):Ce}}function vt(Ne,ee,re){return{type:"Feature",id:Ne[ee+Vt],properties:mt(Ne,ee,re),geometry:{type:"Point",coordinates:[(X=Ne[ee],360*(X-.5)),gt(Ne[ee+1])]}};var X}function mt(Ne,ee,re){const X=Ne[ee+Wt],_e=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,Ce=Ne[ee+dn],Ae=Ce===-1?{}:Object.assign({},re[Ce]);return Object.assign(Ae,{cluster:!0,cluster_id:Ne[ee+Vt],point_count:X,point_count_abbreviated:_e})}function Qt(Ne){return Ne/360+.5}function Se(Ne){const ee=Math.sin(Ne*Math.PI/180),re=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return re<0?0:re>1?1:re}function gt(Ne){const ee=(180-360*Ne)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function kt(Ne,ee,re,X){let _e=X;const Ce=ee+(re-ee>>1);let Ae,Be=re-ee;const ze=Ne[ee],rt=Ne[ee+1],Je=Ne[re],je=Ne[re+1];for(let ht=ee+3;ht<re;ht+=3){const Ct=St(Ne[ht],Ne[ht+1],ze,rt,Je,je);if(Ct>_e)Ae=ht,_e=Ct;else if(Ct===_e){const Rt=Math.abs(ht-Ce);Rt<Be&&(Ae=ht,Be=Rt)}}_e>X&&(Ae-ee>3&&kt(Ne,ee,Ae,X),Ne[Ae+2]=_e,re-Ae>3&&kt(Ne,Ae,re,X))}function St(Ne,ee,re,X,_e,Ce){let Ae=_e-re,Be=Ce-X;if(Ae!==0||Be!==0){const ze=((Ne-re)*Ae+(ee-X)*Be)/(Ae*Ae+Be*Be);ze>1?(re=_e,X=Ce):ze>0&&(re+=Ae*ze,X+=Be*ze)}return Ae=Ne-re,Be=ee-X,Ae*Ae+Be*Be}function zt(Ne,ee,re,X){const _e={id:Ne??null,type:ee,geometry:re,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Yt(_e,re);else if(ee==="Polygon")Yt(_e,re[0]);else if(ee==="MultiLineString")for(const Ce of re)Yt(_e,Ce);else if(ee==="MultiPolygon")for(const Ce of re)Yt(_e,Ce[0]);return _e}function Yt(Ne,ee){for(let re=0;re<ee.length;re+=3)Ne.minX=Math.min(Ne.minX,ee[re]),Ne.minY=Math.min(Ne.minY,ee[re+1]),Ne.maxX=Math.max(Ne.maxX,ee[re]),Ne.maxY=Math.max(Ne.maxY,ee[re+1])}function tn(Ne,ee,re,X){if(!ee.geometry)return;const _e=ee.geometry.coordinates;if(_e&&_e.length===0)return;const Ce=ee.geometry.type,Ae=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2);let Be=[],ze=ee.id;if(re.promoteId?ze=ee.properties[re.promoteId]:re.generateId&&(ze=X||0),Ce==="Point")gi(_e,Be);else if(Ce==="MultiPoint")for(const rt of _e)gi(rt,Be);else if(Ce==="LineString")Tn(_e,Be,Ae,!1);else if(Ce==="MultiLineString"){if(re.lineMetrics){for(const rt of _e)Be=[],Tn(rt,Be,Ae,!1),Ne.push(zt(ze,"LineString",Be,ee.properties));return}ni(_e,Be,Ae,!1)}else if(Ce==="Polygon")ni(_e,Be,Ae,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(const rt of ee.geometry.geometries)tn(Ne,{id:ze,geometry:rt,properties:ee.properties},re,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const rt of _e){const Je=[];ni(rt,Je,Ae,!0),Be.push(Je)}}Ne.push(zt(ze,Ce,Be,ee.properties))}function gi(Ne,ee){ee.push(ba(Ne[0]),Mi(Ne[1]),0)}function Tn(Ne,ee,re,X){let _e,Ce,Ae=0;for(let ze=0;ze<Ne.length;ze++){const rt=ba(Ne[ze][0]),Je=Mi(Ne[ze][1]);ee.push(rt,Je,0),ze>0&&(Ae+=X?(_e*Je-rt*Ce)/2:Math.sqrt(Math.pow(rt-_e,2)+Math.pow(Je-Ce,2))),_e=rt,Ce=Je}const Be=ee.length-3;ee[2]=1,kt(ee,0,Be,re),ee[Be+2]=1,ee.size=Math.abs(Ae),ee.start=0,ee.end=ee.size}function ni(Ne,ee,re,X){for(let _e=0;_e<Ne.length;_e++){const Ce=[];Tn(Ne[_e],Ce,re,X),ee.push(Ce)}}function ba(Ne){return Ne/360+.5}function Mi(Ne){const ee=Math.sin(Ne*Math.PI/180),re=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return re<0?0:re>1?1:re}function yi(Ne,ee,re,X,_e,Ce,Ae,Be){if(X/=ee,Ce>=(re/=ee)&&Ae<X)return Ne;if(Ae<re||Ce>=X)return null;const ze=[];for(const rt of Ne){const Je=rt.geometry;let je=rt.type;const ht=_e===0?rt.minX:rt.minY,Ct=_e===0?rt.maxX:rt.maxY;if(ht>=re&&Ct<X){ze.push(rt);continue}if(Ct<re||ht>=X)continue;let Rt=[];if(je==="Point"||je==="MultiPoint")Er(Je,Rt,re,X,_e);else if(je==="LineString")Zn(Je,Rt,re,X,_e,!1,Be.lineMetrics);else if(je==="MultiLineString")wa(Je,Rt,re,X,_e,!1);else if(je==="Polygon")wa(Je,Rt,re,X,_e,!0);else if(je==="MultiPolygon")for(const Xe of Je){const $t=[];wa(Xe,$t,re,X,_e,!0),$t.length&&Rt.push($t)}if(Rt.length){if(Be.lineMetrics&&je==="LineString"){for(const Xe of Rt)ze.push(zt(rt.id,je,Xe,rt.tags));continue}je!=="LineString"&&je!=="MultiLineString"||(Rt.length===1?(je="LineString",Rt=Rt[0]):je="MultiLineString"),je!=="Point"&&je!=="MultiPoint"||(je=Rt.length===3?"Point":"MultiPoint"),ze.push(zt(rt.id,je,Rt,rt.tags))}}return ze.length?ze:null}function Er(Ne,ee,re,X,_e){for(let Ce=0;Ce<Ne.length;Ce+=3){const Ae=Ne[Ce+_e];Ae>=re&&Ae<=X&&li(ee,Ne[Ce],Ne[Ce+1],Ne[Ce+2])}}function Zn(Ne,ee,re,X,_e,Ce,Ae){let Be=Gn(Ne);const ze=_e===0?js:is;let rt,Je,je=Ne.start;for(let $t=0;$t<Ne.length-3;$t+=3){const jt=Ne[$t],nn=Ne[$t+1],Cn=Ne[$t+2],yt=Ne[$t+3],Bt=Ne[$t+4],Mt=_e===0?jt:nn,sn=_e===0?yt:Bt;let Ci=!1;Ae&&(rt=Math.sqrt(Math.pow(jt-yt,2)+Math.pow(nn-Bt,2))),Mt<re?sn>re&&(Je=ze(Be,jt,nn,yt,Bt,re),Ae&&(Be.start=je+rt*Je)):Mt>X?sn<X&&(Je=ze(Be,jt,nn,yt,Bt,X),Ae&&(Be.start=je+rt*Je)):li(Be,jt,nn,Cn),sn<re&&Mt>=re&&(Je=ze(Be,jt,nn,yt,Bt,re),Ci=!0),sn>X&&Mt<=X&&(Je=ze(Be,jt,nn,yt,Bt,X),Ci=!0),!Ce&&Ci&&(Ae&&(Be.end=je+rt*Je),ee.push(Be),Be=Gn(Ne)),Ae&&(je+=rt)}let ht=Ne.length-3;const Ct=Ne[ht],Rt=Ne[ht+1],Xe=_e===0?Ct:Rt;Xe>=re&&Xe<=X&&li(Be,Ct,Rt,Ne[ht+2]),ht=Be.length-3,Ce&&ht>=3&&(Be[ht]!==Be[0]||Be[ht+1]!==Be[1])&&li(Be,Be[0],Be[1],Be[2]),Be.length&&ee.push(Be)}function Gn(Ne){const ee=[];return ee.size=Ne.size,ee.start=Ne.start,ee.end=Ne.end,ee}function wa(Ne,ee,re,X,_e,Ce){for(const Ae of Ne)Zn(Ae,ee,re,X,_e,Ce,!1)}function li(Ne,ee,re,X){Ne.push(ee,re,X)}function js(Ne,ee,re,X,_e,Ce){const Ae=(Ce-ee)/(X-ee);return li(Ne,Ce,re+(_e-re)*Ae,1),Ae}function is(Ne,ee,re,X,_e,Ce){const Ae=(Ce-re)/(_e-re);return li(Ne,ee+(X-ee)*Ae,Ce,1),Ae}function rr(Ne,ee){const re=[];for(let X=0;X<Ne.length;X++){const _e=Ne[X],Ce=_e.type;let Ae;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")Ae=fr(_e.geometry,ee);else if(Ce==="MultiLineString"||Ce==="Polygon"){Ae=[];for(const Be of _e.geometry)Ae.push(fr(Be,ee))}else if(Ce==="MultiPolygon"){Ae=[];for(const Be of _e.geometry){const ze=[];for(const rt of Be)ze.push(fr(rt,ee));Ae.push(ze)}}re.push(zt(_e.id,Ce,Ae,_e.tags))}return re}function fr(Ne,ee){const re=[];re.size=Ne.size,Ne.start!==void 0&&(re.start=Ne.start,re.end=Ne.end);for(let X=0;X<Ne.length;X+=3)re.push(Ne[X]+ee,Ne[X+1],Ne[X+2]);return re}function xo(Ne,ee){if(Ne.transformed)return Ne;const re=1<<Ne.z,X=Ne.x,_e=Ne.y;for(const Ce of Ne.features){const Ae=Ce.geometry,Be=Ce.type;if(Ce.geometry=[],Be===1)for(let ze=0;ze<Ae.length;ze+=2)Ce.geometry.push(Bs(Ae[ze],Ae[ze+1],ee,re,X,_e));else for(let ze=0;ze<Ae.length;ze++){const rt=[];for(let Je=0;Je<Ae[ze].length;Je+=2)rt.push(Bs(Ae[ze][Je],Ae[ze][Je+1],ee,re,X,_e));Ce.geometry.push(rt)}}return Ne.transformed=!0,Ne}function Bs(Ne,ee,re,X,_e,Ce){return[Math.round(re*(Ne*X-_e)),Math.round(re*(ee*X-Ce))]}function bo(Ne,ee,re,X,_e){const Ce=ee===_e.maxZoom?0:_e.tolerance/((1<<ee)*_e.extent),Ae={features:[],numPoints:0,numSimplified:0,numFeatures:Ne.length,source:null,x:re,y:X,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Be of Ne)Fs(Ae,Be,Ce,_e);return Ae}function Fs(Ne,ee,re,X){const _e=ee.geometry,Ce=ee.type,Ae=[];if(Ne.minX=Math.min(Ne.minX,ee.minX),Ne.minY=Math.min(Ne.minY,ee.minY),Ne.maxX=Math.max(Ne.maxX,ee.maxX),Ne.maxY=Math.max(Ne.maxY,ee.maxY),Ce==="Point"||Ce==="MultiPoint")for(let Be=0;Be<_e.length;Be+=3)Ae.push(_e[Be],_e[Be+1]),Ne.numPoints++,Ne.numSimplified++;else if(Ce==="LineString")Xr(Ae,_e,Ne,re,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(let Be=0;Be<_e.length;Be++)Xr(Ae,_e[Be],Ne,re,Ce==="Polygon",Be===0);else if(Ce==="MultiPolygon")for(let Be=0;Be<_e.length;Be++){const ze=_e[Be];for(let rt=0;rt<ze.length;rt++)Xr(Ae,ze[rt],Ne,re,!0,rt===0)}if(Ae.length){let Be=ee.tags||null;if(Ce==="LineString"&&X.lineMetrics){Be={};for(const rt in ee.tags)Be[rt]=ee.tags[rt];Be.mapbox_clip_start=_e.start/_e.size,Be.mapbox_clip_end=_e.end/_e.size}const ze={geometry:Ae,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:Be};ee.id!==null&&(ze.id=ee.id),Ne.features.push(ze)}}function Xr(Ne,ee,re,X,_e,Ce){const Ae=X*X;if(X>0&&ee.size<(_e?Ae:X))return void(re.numPoints+=ee.length/3);const Be=[];for(let ze=0;ze<ee.length;ze+=3)(X===0||ee[ze+2]>Ae)&&(re.numSimplified++,Be.push(ee[ze],ee[ze+1])),re.numPoints++;_e&&function(ze,rt){let Je=0;for(let je=0,ht=ze.length,Ct=ht-2;je<ht;Ct=je,je+=2)Je+=(ze[je]-ze[Ct])*(ze[je+1]+ze[Ct+1]);if(Je>0===rt)for(let je=0,ht=ze.length;je<ht/2;je+=2){const Ct=ze[je],Rt=ze[je+1];ze[je]=ze[ht-2-je],ze[je+1]=ze[ht-1-je],ze[ht-2-je]=Ct,ze[ht-1-je]=Rt}}(Be,Ce),Ne.push(Be)}const Ki={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class pr{constructor(ee,re){const X=(re=this.options=function(Ce,Ae){for(const Be in Ae)Ce[Be]=Ae[Be];return Ce}(Object.create(Ki),re)).debug;if(X&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");let _e=function(Ce,Ae){const Be=[];if(Ce.type==="FeatureCollection")for(let ze=0;ze<Ce.features.length;ze++)tn(Be,Ce.features[ze],Ae,ze);else tn(Be,Ce.type==="Feature"?Ce:{geometry:Ce},Ae);return Be}(ee,re);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_e=function(Ce,Ae){const Be=Ae.buffer/Ae.extent;let ze=Ce;const rt=yi(Ce,1,-1-Be,Be,0,-1,2,Ae),Je=yi(Ce,1,1-Be,2+Be,0,-1,2,Ae);return(rt||Je)&&(ze=yi(Ce,1,-Be,1+Be,0,-1,2,Ae)||[],rt&&(ze=rr(rt,1).concat(ze)),Je&&(ze=ze.concat(rr(Je,-1)))),ze}(_e,re),_e.length&&this.splitTile(_e,0,0,0),X&&(_e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,re,X,_e,Ce,Ae,Be){const ze=[ee,re,X,_e],rt=this.options,Je=rt.debug;for(;ze.length;){_e=ze.pop(),X=ze.pop(),re=ze.pop(),ee=ze.pop();const je=1<<re,ht=Gi(re,X,_e);let Ct=this.tiles[ht];if(!Ct&&(Je>1&&console.time("creation"),Ct=this.tiles[ht]=bo(ee,re,X,_e,rt),this.tileCoords.push({z:re,x:X,y:_e}),Je)){Je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,X,_e,Ct.numFeatures,Ct.numPoints,Ct.numSimplified),console.timeEnd("creation"));const Ci=`z${re}`;this.stats[Ci]=(this.stats[Ci]||0)+1,this.total++}if(Ct.source=ee,Ce==null){if(re===rt.indexMaxZoom||Ct.numPoints<=rt.indexMaxPoints)continue}else{if(re===rt.maxZoom||re===Ce)continue;if(Ce!=null){const Ci=Ce-re;if(X!==Ae>>Ci||_e!==Be>>Ci)continue}}if(Ct.source=null,ee.length===0)continue;Je>1&&console.time("clipping");const Rt=.5*rt.buffer/rt.extent,Xe=.5-Rt,$t=.5+Rt,jt=1+Rt;let nn=null,Cn=null,yt=null,Bt=null,Mt=yi(ee,je,X-Rt,X+$t,0,Ct.minX,Ct.maxX,rt),sn=yi(ee,je,X+Xe,X+jt,0,Ct.minX,Ct.maxX,rt);ee=null,Mt&&(nn=yi(Mt,je,_e-Rt,_e+$t,1,Ct.minY,Ct.maxY,rt),Cn=yi(Mt,je,_e+Xe,_e+jt,1,Ct.minY,Ct.maxY,rt),Mt=null),sn&&(yt=yi(sn,je,_e-Rt,_e+$t,1,Ct.minY,Ct.maxY,rt),Bt=yi(sn,je,_e+Xe,_e+jt,1,Ct.minY,Ct.maxY,rt),sn=null),Je>1&&console.timeEnd("clipping"),ze.push(nn||[],re+1,2*X,2*_e),ze.push(Cn||[],re+1,2*X,2*_e+1),ze.push(yt||[],re+1,2*X+1,2*_e),ze.push(Bt||[],re+1,2*X+1,2*_e+1)}}getTile(ee,re,X){ee=+ee,re=+re,X=+X;const _e=this.options,{extent:Ce,debug:Ae}=_e;if(ee<0||ee>24)return null;const Be=1<<ee,ze=Gi(ee,re=re+Be&Be-1,X);if(this.tiles[ze])return xo(this.tiles[ze],Ce);Ae>1&&console.log("drilling down to z%d-%d-%d",ee,re,X);let rt,Je=ee,je=re,ht=X;for(;!rt&&Je>0;)Je--,je>>=1,ht>>=1,rt=this.tiles[Gi(Je,je,ht)];return rt&&rt.source?(Ae>1&&(console.log("found parent tile z%d-%d-%d",Je,je,ht),console.time("drilling down")),this.splitTile(rt.source,Je,je,ht,ee,re,X),Ae>1&&console.timeEnd("drilling down"),this.tiles[ze]?xo(this.tiles[ze],Ce):null):null}}function Gi(Ne,ee,re){return 32*((1<<Ne)*re+ee)+Ne}function wo(Ne,ee){return ee?Ne.properties[ee]:Ne.id}function Fc(Ne,ee){if(Ne==null)return!0;if(Ne.type==="Feature")return wo(Ne,ee)!=null;if(Ne.type==="FeatureCollection"){const re=new Set;for(const X of Ne.features){const _e=wo(X,ee);if(_e==null||re.has(_e))return!1;re.add(_e)}return!0}return!1}function zu(Ne,ee){const re=new Map;if(Ne!=null)if(Ne.type==="Feature")re.set(wo(Ne,ee),Ne);else for(const X of Ne.features)re.set(wo(X,ee),X);return re}class Vl extends j{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,re){return v._(this,void 0,void 0,function*(){const X=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const _e=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!_e)return null;const Ce=new He(_e.features);let Ae=Re(Ce);return Ae.byteOffset===0&&Ae.byteLength===Ae.buffer.byteLength||(Ae=new Uint8Array(Ae)),{vectorTile:Ce,rawData:Ae.buffer}})}loadData(ee){return v._(this,void 0,void 0,function*(){var re;(re=this._pendingRequest)===null||re===void 0||re.abort();const X=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new v.cA(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new Oe(function({superclusterOptions:Ae,clusterProperties:Be}){if(!Be||!Ae)return Ae;const ze={},rt={},Je={accumulated:null,zoom:0},je={properties:null},ht=Object.keys(Be);for(const Ct of ht){const[Rt,Xe]=Be[Ct],$t=v.cH(Xe),jt=v.cH(typeof Rt=="string"?[Rt,["accumulated"],["get",Ct]]:Rt);ze[Ct]=$t.value,rt[Ct]=jt.value}return Ae.map=Ct=>{je.properties=Ct;const Rt={};for(const Xe of ht)Rt[Xe]=ze[Xe].evaluate(Je,je);return Rt},Ae.reduce=(Ct,Rt)=>{je.properties=Rt;for(const Xe of ht)Je.accumulated=Ct[Xe],Ct[Xe]=rt[Xe].evaluate(Je,je)},Ae}(ee)).load((yield this._pendingData).features):(_e=yield this._pendingData,new pr(_e,ee.geojsonVtOptions)),this.loaded={};const Ce={};if(X){const Ae=X.finish();Ae&&(Ce.resourceTiming={},Ce.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Ae)))}return Ce}catch(Ce){if(delete this._pendingRequest,v.cl(Ce))return{abandoned:!0};throw Ce}var _e})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const re=this.loaded;return re&&re[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,re){return v._(this,void 0,void 0,function*(){let X=yield this.loadGeoJSON(ee,re);if(delete this._pendingRequest,typeof X!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(pe(X,!0),ee.filter){const _e=v.cH(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(_e.result==="error")throw new Error(_e.value.map(Ae=>`${Ae.key}: ${Ae.message}`).join(", "));X={type:"FeatureCollection",features:X.features.filter(Ae=>_e.value.evaluate({zoom:0},Ae))}}return X})}loadGeoJSON(ee,re){return v._(this,void 0,void 0,function*(){const{promoteId:X}=ee;if(ee.request){const _e=yield v.j(ee.request,re);return this._dataUpdateable=Fc(_e.data,X)?zu(_e.data,X):void 0,_e.data}if(typeof ee.data=="string")try{const _e=JSON.parse(ee.data);return this._dataUpdateable=Fc(_e,X)?zu(_e,X):void 0,_e}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(_e,Ce,Ae){var Be,ze,rt,Je;if(Ce.removeAll&&_e.clear(),Ce.remove)for(const je of Ce.remove)_e.delete(je);if(Ce.add)for(const je of Ce.add){const ht=wo(je,Ae);ht!=null&&_e.set(ht,je)}if(Ce.update)for(const je of Ce.update){let ht=_e.get(je.id);if(ht==null)continue;const Ct=!je.removeAllProperties&&(((Be=je.removeProperties)===null||Be===void 0?void 0:Be.length)>0||((ze=je.addOrUpdateProperties)===null||ze===void 0?void 0:ze.length)>0);if((je.newGeometry||je.removeAllProperties||Ct)&&(ht=Object.assign({},ht),_e.set(je.id,ht),Ct&&(ht.properties=Object.assign({},ht.properties))),je.newGeometry&&(ht.geometry=je.newGeometry),je.removeAllProperties)ht.properties={};else if(((rt=je.removeProperties)===null||rt===void 0?void 0:rt.length)>0)for(const Rt of je.removeProperties)Object.prototype.hasOwnProperty.call(ht.properties,Rt)&&delete ht.properties[Rt];if(((Je=je.addOrUpdateProperties)===null||Je===void 0?void 0:Je.length)>0)for(const{key:Rt,value:Xe}of je.addOrUpdateProperties)ht.properties[Rt]=Xe}}(this._dataUpdateable,ee.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class ja{constructor(ee){this.self=ee,this.actor=new v.H(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(re,X)=>{if(this.externalWorkerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.externalWorkerSourceTypes[re]=X},this.self.addProtocol=v.cn,this.self.removeProtocol=v.co,this.self.registerRTLTextPlugin=re=>{v.cI.setMethods(re)},this.actor.registerMessageHandler("LDT",(re,X)=>this._getDEMWorkerSource(re,X.source).loadTile(X)),this.actor.registerMessageHandler("RDT",(re,X)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(re,X.source).removeTile(X)})),this.actor.registerMessageHandler("GCEZ",(re,X)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(re,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("GCC",(re,X)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(re,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("GCL",(re,X)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(re,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("LD",(re,X)=>this._getWorkerSource(re,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("GD",(re,X)=>this._getWorkerSource(re,X.type,X.source).getData()),this.actor.registerMessageHandler("LT",(re,X)=>this._getWorkerSource(re,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("RT",(re,X)=>this._getWorkerSource(re,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("AT",(re,X)=>this._getWorkerSource(re,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("RMT",(re,X)=>this._getWorkerSource(re,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("RS",(re,X)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[re]||!this.workerSources[re][X.type]||!this.workerSources[re][X.type][X.source])return;const _e=this.workerSources[re][X.type][X.source];delete this.workerSources[re][X.type][X.source],_e.removeSource!==void 0&&_e.removeSource(X)})),this.actor.registerMessageHandler("RM",re=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[re],delete this.availableImages[re],delete this.workerSources[re],delete this.demWorkerSources[re]})),this.actor.registerMessageHandler("SR",(re,X)=>v._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("SRPS",(re,X)=>this._syncRTLPluginState(re,X)),this.actor.registerMessageHandler("IS",(re,X)=>v._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("SI",(re,X)=>this._setImages(re,X)),this.actor.registerMessageHandler("UL",(re,X)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(re).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("SL",(re,X)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(re).replace(X)}))}_setImages(ee,re){return v._(this,void 0,void 0,function*(){this.availableImages[ee]=re;for(const X in this.workerSources[ee]){const _e=this.workerSources[ee][X];for(const Ce in _e)_e[Ce].availableImages=re}})}_syncRTLPluginState(ee,re){return v._(this,void 0,void 0,function*(){return yield v.cI.syncState(re,this.self.importScripts)})}_getAvailableImages(ee){let re=this.availableImages[ee];return re||(re=[]),re}_getLayerIndex(ee){let re=this.layerIndexes[ee];return re||(re=this.layerIndexes[ee]=new c),re}_getWorkerSource(ee,re,X){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][re]||(this.workerSources[ee][re]={}),!this.workerSources[ee][re][X]){const _e={sendAsync:(Ce,Ae)=>(Ce.targetMapId=ee,this.actor.sendAsync(Ce,Ae))};switch(re){case"vector":this.workerSources[ee][re][X]=new j(_e,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][re][X]=new Vl(_e,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][re][X]=new this.externalWorkerSourceTypes[re](_e,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][re][X]}_getDEMWorkerSource(ee,re){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][re]||(this.demWorkerSources[ee][re]=new U),this.demWorkerSources[ee][re]}}return v.i(self)&&(self.worker=new ja(self)),ja}),p("index",["exports","./shared"],function(v,c){var C="5.3.0";function k(){var x=new c.A(4);return c.A!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x}let P,j;const U={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(x,e,s){const f=requestAnimationFrame(w=>{g(),e(w)}),{unsubscribe:g}=c.s(x.signal,"abort",()=>{g(),cancelAnimationFrame(f),s(c.c())},!1)},frameAsync(x){return new Promise((e,s)=>{this.frame(x,e,s)})},getImageData(x,e=0){return this.getImageCanvasContext(x).getImageData(-e,-e,x.width+2*e,x.height+2*e)},getImageCanvasContext(x){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=x.width,e.height=x.height,s.drawImage(x,0,0,x.width,x.height),s},resolveURL:x=>(P||(P=document.createElement("a")),P.href=x,P.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(j==null&&(j=matchMedia("(prefers-reduced-motion: reduce)")),j.matches)}};class V{static testProp(e){if(!V.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in V.docStyle)return e[s];return e[0]}static create(e,s,f){const g=window.document.createElement(e);return s!==void 0&&(g.className=s),f&&f.appendChild(g),g}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(e,s){e.style[V.transformProp]=s}static addEventListener(e,s,f,g={}){e.addEventListener(s,f,"passive"in g?g:g.capture)}static removeEventListener(e,s,f,g={}){e.removeEventListener(s,f,"passive"in g?g:g.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",V.suppressClickInternal,!0)},0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,f){const g=s.boundingClientRect;return new c.P((f.clientX-g.left)/s.x-e.clientLeft,(f.clientY-g.top)/s.y-e.clientTop)}static mousePos(e,s){const f=V.getScale(e);return V.getPoint(e,f,s)}static touchPos(e,s){const f=[],g=V.getScale(e);for(let w=0;w<s.length;w++)f.push(V.getPoint(e,g,s[w]));return f}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const s=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),f=s.querySelectorAll("script");for(const g of f)g.remove();return V.clean(s),s.innerHTML}static isPossiblyDangerous(e,s){const f=s.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!f.includes("javascript:")&&!f.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const s=e.children;for(const f of s)V.removeAttributes(f),V.clean(f)}static removeAttributes(e){for(const{name:s,value:f}of e.attributes)V.isPossiblyDangerous(s,f)&&e.removeAttribute(s)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const ie={supported:!1,testSupport:function(x){!Le&&pe&&(Qe?He(x):me=x)}};let me,pe,Le=!1,Qe=!1;function He(x){const e=x.createTexture();x.bindTexture(x.TEXTURE_2D,e);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,pe),x.isContextLost())return;ie.supported=!0}catch{}x.deleteTexture(e),Le=!0}var $e;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{me&&He(me),me=null,Qe=!0},pe.onerror=()=>{Le=!0,me=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(x){let e,s,f,g;x.resetRequestQueue=()=>{e=[],s=0,f=0,g={}},x.addThrottleControl=R=>{const N=f++;return g[N]=R,N},x.removeThrottleControl=R=>{delete g[R],S()},x.getImage=(R,N,F=!0)=>new Promise((G,Z)=>{ie.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),c.e(R,{type:"image"}),e.push({abortController:N,requestParameters:R,supportImageRefresh:F,state:"queued",onError:K=>{Z(K)},onSuccess:K=>{G(K)}}),S()});const w=R=>c._(this,void 0,void 0,function*(){R.state="running";const{requestParameters:N,supportImageRefresh:F,onError:G,onSuccess:Z,abortController:K}=R,te=F===!1&&!c.i(self)&&!c.g(N.url)&&(!N.headers||Object.keys(N.headers).reduce((de,ge)=>de&&ge==="accept",!0));s++;const he=te?D(N,K):c.m(N,K);try{const de=yield he;delete R.abortController,R.state="completed",de.data instanceof HTMLImageElement||c.b(de.data)?Z(de):de.data&&Z({data:yield(ue=de.data,typeof createImageBitmap=="function"?c.f(ue):c.h(ue)),cacheControl:de.cacheControl,expires:de.expires})}catch(de){delete R.abortController,G(de)}finally{s--,S()}var ue}),S=()=>{const R=(()=>{for(const N of Object.keys(g))if(g[N]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let N=s;N<R&&e.length>0;N++){const F=e.shift();F.abortController.signal.aborted?N--:w(F)}},D=(R,N)=>new Promise((F,G)=>{const Z=new Image,K=R.url,te=R.credentials;te&&te==="include"?Z.crossOrigin="use-credentials":(te&&te==="same-origin"||!c.d(K))&&(Z.crossOrigin="anonymous"),N.signal.addEventListener("abort",()=>{Z.src="",G(c.c())}),Z.fetchPriority="high",Z.onload=()=>{Z.onerror=Z.onload=null,F({data:Z})},Z.onerror=()=>{Z.onerror=Z.onload=null,N.signal.aborted||G(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Z.src=K})}($e||($e={})),$e.resetRequestQueue();class ke{constructor(e){this._transformRequestFn=e}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ze(x){const e=[];if(typeof x=="string")e.push({id:"default",url:x});else if(x&&x.length>0){const s=[];for(const{id:f,url:g}of x){const w=`${f}${g}`;s.indexOf(w)===-1&&(s.push(w),e.push({id:f,url:g}))}}return e}function nt(x,e,s){try{const f=new URL(x);return f.pathname+=`${e}${s}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${x}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class Ke{constructor(e,s,f,g){this.context=e,this.format=f,this.texture=e.gl.createTexture(),this.update(s,g)}update(e,s,f){const{width:g,height:w}=e,S=!(this.size&&this.size[0]===g&&this.size[1]===w||f),{context:D}=this,{gl:R}=D;if(this.useMipmap=!!(s&&s.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),D.pixelStoreUnpackFlipY.set(!1),D.pixelStoreUnpack.set(1),D.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!s||s.premultiply!==!1)),S)this.size=[g,w],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,e):R.texImage2D(R.TEXTURE_2D,0,this.format,g,w,0,this.format,R.UNSIGNED_BYTE,e.data);else{const{x:N,y:F}=f||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?R.texSubImage2D(R.TEXTURE_2D,0,N,F,R.RGBA,R.UNSIGNED_BYTE,e):R.texSubImage2D(R.TEXTURE_2D,0,N,F,g,w,R.RGBA,R.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)}bind(e,s,f){const{context:g}=this,{gl:w}=g;w.bindTexture(w.TEXTURE_2D,this.texture),f!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=w.LINEAR),e!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,e),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,f||e),this.filter=e),s!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,s),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Re(x){const{userImage:e}=x;return!!(e&&e.render&&e.render())&&(x.data.replace(new Uint8Array(e.data.buffer)),!0)}class _t extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:f}of this.requestors)f(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const f=s.spriteData;s.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let f=!0;const g=s.data||s.spriteData;return this._validateStretch(s.stretchX,g&&g.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),f=!1),this._validateStretch(s.stretchY,g&&g.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),f=!1),this._validateContent(s.content,s)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),f=!1),f}_validateStretch(e,s){if(!e)return!0;let f=0;for(const g of e){if(g[0]<f||g[1]<g[0]||s<g[1])return!1;f=g[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const f=s.spriteData,g=f&&f.width||s.data.width,w=f&&f.height||s.data.height;return!(e[0]<0||g<e[0]||e[1]<0||w<e[1]||e[2]<0||g<e[2]||e[3]<0||w<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,f=!0){const g=this.getImage(e);if(f&&(g.data.width!==s.data.width||g.data.height!==s.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=g.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((s,f)=>{let g=!0;if(!this.isLoaded())for(const w of e)this.images[w]||(g=!1);this.isLoaded()||g?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})})}_getImagesForIds(e){const s={};for(const f of e){let g=this.getImage(f);g||(this.fire(new c.l("styleimagemissing",{id:f})),g=this.getImage(f)),g?s[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],f=this.getImage(e);if(!f)return null;if(s&&s.position.version===f.version)return s.position;if(s)s.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},w=new c.I(g,f);this.patterns[e]={bin:g,position:w}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ke(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const w in this.patterns)e.push(this.patterns[w].bin);const{w:s,h:f}=c.p(e),g=this.atlasImage;g.resize({width:s||1,height:f||1});for(const w in this.patterns){const{bin:S}=this.patterns[w],D=S.x+1,R=S.y+1,N=this.getImage(w).data,F=N.width,G=N.height;c.R.copy(N,g,{x:0,y:0},{x:D,y:R},{width:F,height:G}),c.R.copy(N,g,{x:0,y:G-1},{x:D,y:R-1},{width:F,height:1}),c.R.copy(N,g,{x:0,y:0},{x:D,y:R+G},{width:F,height:1}),c.R.copy(N,g,{x:F-1,y:0},{x:D-1,y:R},{width:1,height:G}),c.R.copy(N,g,{x:0,y:0},{x:D+F,y:R},{width:1,height:G})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const f=this.getImage(s);f||c.w(`Image with ID: "${s}" was not found`),Re(f)&&this.updateImage(s,f)}}}const It=1e20;function Ot(x,e,s,f,g,w,S,D,R){for(let N=e;N<e+f;N++)Vt(x,s*w+N,w,g,S,D,R);for(let N=s;N<s+g;N++)Vt(x,N*w+e,1,f,S,D,R)}function Vt(x,e,s,f,g,w,S){w[0]=0,S[0]=-1e20,S[1]=It,g[0]=x[e];for(let D=1,R=0,N=0;D<f;D++){g[D]=x[e+D*s];const F=D*D;do{const G=w[R];N=(g[D]-g[G]+F-G*G)/(D-G)/2}while(N<=S[R]&&--R>-1);R++,w[R]=D,S[R]=N,S[R+1]=It}for(let D=0,R=0;D<f;D++){for(;S[R+1]<D;)R++;const N=w[R],F=D-N;x[e+D*s]=g[N]+F*F}}class Wt{constructor(e,s){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const s=[];for(const w in e)for(const S of e[w])s.push(this._getAndCacheGlyphsPromise(w,S));const f=yield Promise.all(s),g={};for(const{stack:w,id:S,glyph:D}of f)g[w]||(g[w]={}),g[w][S]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics};return g})}_getAndCacheGlyphsPromise(e,s){return c._(this,void 0,void 0,function*(){let f=this.entries[e];f||(f=this.entries[e]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[s];if(g!==void 0)return{stack:e,id:s,glyph:g};if(g=this._tinySDF(f,e,s),g)return f.glyphs[s]=g,{stack:e,id:s,glyph:g};const w=Math.floor(s/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[w])return{stack:e,id:s,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[w]){const D=Wt.loadGlyphRange(e,w,this.url,this.requestManager);f.requests[w]=D}const S=yield f.requests[w];for(const D in S)this._doesCharSupportLocalGlyph(+D)||(f.glyphs[+D]=S[+D]);return f.ranges[w]=!0,{stack:e,id:s,glyph:S[s]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,s,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let w=e.tinySDF;if(!w){let D="400";/bold/i.test(s)?D="900":/medium/i.test(s)?D="500":/light/i.test(s)&&(D="200"),w=e.tinySDF=new Wt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:D})}const S=w.draw(String.fromCharCode(f));return{id:f,bitmap:new c.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Wt.loadGlyphRange=function(x,e,s,f){return c._(this,void 0,void 0,function*(){const g=256*e,w=g+255,S=f.transformRequest(s.replace("{fontstack}",x).replace("{range}",`${g}-${w}`),"Glyphs"),D=yield c.n(S,new AbortController);if(!D||!D.data)throw new Error(`Could not load glyph range. range: ${e}, ${g}-${w}`);const R={};for(const N of c.o(D.data))R[N.id]=N;return R})},Wt.TinySDF=class{constructor({fontSize:x=24,buffer:e=3,radius:s=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:w="normal",fontStyle:S="normal"}={}){this.buffer=e,this.cutoff=f,this.radius=s;const D=this.size=x+4*e,R=this._createCanvas(D),N=this.ctx=R.getContext("2d",{willReadFrequently:!0});N.font=`${S} ${w} ${x}px ${g}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(x){const e=document.createElement("canvas");return e.width=e.height=x,e}draw(x){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:w}=this.ctx.measureText(x),S=Math.ceil(s),D=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-g))),R=Math.min(this.size-this.buffer,S+Math.ceil(f)),N=D+2*this.buffer,F=R+2*this.buffer,G=Math.max(N*F,0),Z=new Uint8ClampedArray(G),K={data:Z,width:N,height:F,glyphWidth:D,glyphHeight:R,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(D===0||R===0)return K;const{ctx:te,buffer:he,gridInner:ue,gridOuter:de}=this;te.clearRect(he,he,D,R),te.fillText(x,he,he+S);const ge=te.getImageData(he,he,D,R);de.fill(It,0,G),ue.fill(0,0,G);for(let xe=0;xe<R;xe++)for(let be=0;be<D;be++){const Te=ge.data[4*(xe*D+be)+3]/255;if(Te===0)continue;const De=(xe+he)*N+be+he;if(Te===1)de[De]=0,ue[De]=It;else{const Me=.5-Te;de[De]=Me>0?Me*Me:0,ue[De]=Me<0?Me*Me:0}}Ot(de,0,0,N,F,N,this.f,this.v,this.z),Ot(ue,he,he,D,R,N,this.f,this.v,this.z);for(let xe=0;xe<G;xe++){const be=Math.sqrt(de[xe])-Math.sqrt(ue[xe]);Z[xe]=Math.round(255-255*(be/this.radius+this.cutoff))}return K}};class dn{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,s){return c.z(e.expression.evaluate(s))}interpolate(e,s,f){return{x:c.B.number(e.x,s.x,f),y:c.B.number(e.y,s.y,f),z:c.B.number(e.z,s.z,f)}}}let Oe;class vt extends c.E{constructor(e){super(),Oe=Oe||new c.r({anchor:new c.D(c.v.light.anchor),position:new dn,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Oe),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(c.t,e,s))for(const f in e){const g=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,f){return(!f||f.validate!==!1)&&c.x(this,e.call(c.y,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const mt=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Qt extends c.E{constructor(e){super(),this._transitionable=new c.T(mt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0))}setSky(e,s={}){if(!this._validate(c.F,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in e){const g=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,f={}){return(f==null?void 0:f.validate)!==!1&&c.x(this,e.call(c.y,c.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Se{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const f=e.join(",")+String(s);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(e,s)),this.dashEntry[f]}getDashRanges(e,s,f){const g=[];let w=e.length%2==1?-e[e.length-1]*f:0,S=e[0]*f,D=!0;g.push({left:w,right:S,isDash:D,zeroLength:e[0]===0});let R=e[0];for(let N=1;N<e.length;N++){D=!D;const F=e[N];w=R*f,R+=F,S=R*f,g.push({left:w,right:S,isDash:D,zeroLength:F===0})}return g}addRoundDash(e,s,f){const g=s/2;for(let w=-f;w<=f;w++){const S=this.width*(this.nextRow+f+w);let D=0,R=e[D];for(let N=0;N<this.width;N++){N/R.right>1&&(R=e[++D]);const F=Math.abs(N-R.left),G=Math.abs(N-R.right),Z=Math.min(F,G);let K;const te=w/f*(g+1);if(R.isDash){const he=g-Math.abs(te);K=Math.sqrt(Z*Z+he*he)}else K=g-Math.sqrt(Z*Z+te*te);this.data[S+N]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(e){for(let D=e.length-1;D>=0;--D){const R=e[D],N=e[D+1];R.zeroLength?e.splice(D,1):N&&N.isDash===R.isDash&&(N.left=R.left,e.splice(D,1))}const s=e[0],f=e[e.length-1];s.isDash===f.isDash&&(s.left=f.left-this.width,f.right=s.right+this.width);const g=this.width*this.nextRow;let w=0,S=e[w];for(let D=0;D<this.width;D++){D/S.right>1&&(S=e[++w]);const R=Math.abs(D-S.left),N=Math.abs(D-S.right),F=Math.min(R,N);this.data[g+D]=Math.max(0,Math.min(255,(S.isDash?F:-F)+128))}}addDash(e,s){const f=s?7:0,g=2*f+1;if(this.nextRow+g>this.height)return c.w("LineAtlas out of space"),null;let w=0;for(let D=0;D<e.length;D++)w+=e[D];if(w!==0){const D=this.width/w,R=this.getDashRanges(e,this.width,D);s?this.addRoundDash(R,D,f):this.addRegularDash(R)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:w};return this.nextRow+=g,this.dirty=!0,S}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const gt="maplibre_preloaded_worker_pool";class kt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<kt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[gt]}numActive(){return Object.keys(this.active).length}}const St=Math.floor(U.hardwareConcurrency/2);let zt,Yt;function tn(){return zt||(zt=new kt),zt}kt.workerCount=c.G(globalThis)?Math.max(Math.min(St,3),1):1;class gi{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const f=this.workerPool.acquire(s);for(let g=0;g<f.length;g++){const w=new c.H(f[g],s);w.name=`Worker ${g}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:e,data:s}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const f of this.actors)f.registerMessageHandler(e,s)}}function Tn(){return Yt||(Yt=new gi(tn(),c.J),Yt.registerMessageHandler("GR",(x,e,s)=>c.m(e,s))),Yt}function ni(x,e){const s=c.K();return c.L(s,s,[1,1,0]),c.M(s,s,[.5*x.width,.5*x.height,1]),x.calculatePosMatrix?c.N(s,s,x.calculatePosMatrix(e.toUnwrapped())):s}function ba(x,e,s,f,g,w,S){var D;const R=function(Z,K,te){if(Z)for(const he of Z){const ue=K[he];if(ue&&ue.source===te&&ue.type==="fill-extrusion")return!0}else for(const he in K){const ue=K[he];if(ue.source===te&&ue.type==="fill-extrusion")return!0}return!1}((D=g==null?void 0:g.layers)!==null&&D!==void 0?D:null,e,x.id),N=w.maxPitchScaleFactor(),F=x.tilesIn(f,N,R);F.sort(Mi);const G=[];for(const Z of F)G.push({wrappedTileID:Z.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(e,s,x._state,Z.queryGeometry,Z.cameraQueryGeometry,Z.scale,g,w,N,ni(x.transform,Z.tileID),S?(K,te)=>S(Z.tileID,K,te):void 0)});return function(Z,K){for(const te in Z)for(const he of Z[te])yi(he,K);return Z}(function(Z){const K={},te={};for(const he of Z){const ue=he.queryResults,de=he.wrappedTileID,ge=te[de]=te[de]||{};for(const xe in ue){const be=ue[xe],Te=ge[xe]=ge[xe]||{},De=K[xe]=K[xe]||[];for(const Me of be)Te[Me.featureIndex]||(Te[Me.featureIndex]=!0,De.push(Me))}}return K}(G),x)}function Mi(x,e){const s=x.tileID,f=e.tileID;return s.overscaledZ-f.overscaledZ||s.canonical.y-f.canonical.y||s.wrap-f.wrap||s.canonical.x-f.canonical.x}function yi(x,e){const s=x.feature,f=e.getFeatureState(s.layer["source-layer"],s.id);s.source=s.layer.source,s.layer["source-layer"]&&(s.sourceLayer=s.layer["source-layer"]),s.state=f}function Er(x,e,s){return c._(this,void 0,void 0,function*(){let f=x;if(x.url?f=(yield c.j(e.transformRequest(x.url,"Source"),s)).data:yield U.frameAsync(s),!f)return null;const g=c.O(c.e(f,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map(w=>w.id)),g})}class Zn{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}extend(e){const s=this._sw,f=this._ne;let g,w;if(e instanceof c.Q)g=e,w=e;else{if(!(e instanceof Zn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Zn.convert(e)):this.extend(c.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.Q.convert(e)):this;if(g=e._sw,w=e._ne,!g||!w)return this}return s||f?(s.lng=Math.min(g.lng,s.lng),s.lat=Math.min(g.lat,s.lat),f.lng=Math.max(w.lng,f.lng),f.lat=Math.max(w.lat,f.lat)):(this._sw=new c.Q(g.lng,g.lat),this._ne=new c.Q(w.lng,w.lat)),this}getCenter(){return new c.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.Q(this.getWest(),this.getNorth())}getSouthEast(){return new c.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:f}=c.Q.convert(e);let g=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(e){return e instanceof Zn?e:e&&new Zn(e)}static fromLngLat(e,s=0){const f=360*s/40075017,g=f/Math.cos(Math.PI/180*e.lat);return new Zn(new c.Q(e.lng-g,e.lat-f),new c.Q(e.lng+g,e.lat+f))}adjustAntiMeridian(){const e=new c.Q(this._sw.lng,this._sw.lat),s=new c.Q(this._ne.lng,this._ne.lat);return new Zn(e,e.lng>s.lng?new c.Q(s.lng+360,s.lat):s)}}class Gn{constructor(e,s,f){this.bounds=Zn.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=f||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),f=Math.floor(c.U(this.bounds.getWest())*s),g=Math.floor(c.S(this.bounds.getNorth())*s),w=Math.ceil(c.U(this.bounds.getEast())*s),S=Math.ceil(c.S(this.bounds.getSouth())*s);return e.x>=f&&e.x<w&&e.y>=g&&e.y<S}}class wa extends c.E{constructor(e,s,f,g){if(super(),this.id=e,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.O(s,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Er(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Gn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((w,S)=>{e.reloadPromise={resolve:w,reject:S}})}else e.actor=this.dispatcher.getActor(),g="LT";e.abortController=new AbortController;try{const w=yield e.actor.sendAsync({type:g,data:f},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,w)}catch(w){if(delete e.abortController,e.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const f=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(f.resolve).catch(f.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class li extends c.E{constructor(e,s,f,g){super(),this.id=e,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},s),c.e(this,c.O(s,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield Er(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(c.e(this,s),s.bounds&&(this.tileBounds=new Gn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(s){this._tileJSONRequest=null,this.fire(new c.k(s))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const f=yield $e.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,w=g.gl,S=f.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new Ke(g,S,w.RGBA,{useMipmap:!0}),e.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class js extends li{constructor(e,s,f,g){super(e,s,f,g),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const g=yield $e.getImage(f,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(g&&g.data){const w=g.data;this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&e.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const S=c.b(w)&&c.V()?w:yield this.readImageNow(w),D={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const R=yield e.actor.sendAsync({type:"LDT",data:D});e.dem=R,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(g){if(delete e.abortController,e.aborted)e.state="unloaded";else if(g)throw e.state="errored",g}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.W()){const s=e.width+2,f=e.height+2;try{return new c.R({width:s,height:f},yield c.X(e,-1,-1,s,f))}catch{}}return U.getImageData(e,1)})}_getNeighboringTiles(e){const s=e.canonical,f=Math.pow(2,s.z),g=(s.x-1+f)%f,w=s.x===0?e.wrap-1:e.wrap,S=(s.x+1+f)%f,D=s.x+1===f?e.wrap+1:e.wrap,R={};return R[new c.Y(e.overscaledZ,w,s.z,g,s.y).key]={backfilled:!1},R[new c.Y(e.overscaledZ,D,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(R[new c.Y(e.overscaledZ,w,s.z,g,s.y-1).key]={backfilled:!1},R[new c.Y(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},R[new c.Y(e.overscaledZ,D,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<f&&(R[new c.Y(e.overscaledZ,w,s.z,g,s.y+1).key]={backfilled:!1},R[new c.Y(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},R[new c.Y(e.overscaledZ,D,s.z,S,s.y+1).key]={backfilled:!1}),R}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class is extends c.E{constructor(e,s,f,g){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(g),this._data=s.data,this._options=c.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId,s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(s.buffer!==void 0?s.buffer:128),tolerance:this._pixelsToTileUnits(s.tolerance!==void 0?s.tolerance:.375),extent:c.Z,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:c.Z,radius:this._pixelsToTileUnits(s.clusterRadius||50),log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.Z/this.tileSize)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(s=>s.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const e=new Zn,s=yield this.getData();let f;switch(s.type){case"FeatureCollection":f=s.features.map(g=>this.getCoordinatesFromGeometry(g.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(s.geometry);break;default:f=this.getCoordinatesFromGeometry(s)}if(f.length==0)return e;for(let g=0;g<f.length-1;g+=2)e.extend([f[g],f[g+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:f}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const s=c.e({type:this.type},this.workerOptions);e?s.dataDiff=e:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(U.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let g=null;f.resourceTiming&&f.resourceTiming[this.id]&&(g=f.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(w,{resourceTiming:g}),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(f))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const f={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const g=yield this.actor.sendAsync({type:s,data:f},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(g,this.map.painter,s==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class rr extends c.E{constructor(e,s,f,g){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=f,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=s}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield $e.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new c.k(s))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(c.$.fromLngLat);var f;return this.tileID=function(g){let w=1/0,S=1/0,D=-1/0,R=-1/0;for(const Z of g)w=Math.min(w,Z.x),S=Math.min(S,Z.y),D=Math.max(D,Z.x),R=Math.max(R,Z.y);const N=Math.max(D-w,R-S),F=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),G=Math.pow(2,F);return new c.a1(F,Math.floor((w+D)/2*G),Math.floor((S+R)/2*G))}(s),this.terrainTileRanges=this._getOverlappingTileRanges(s),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=s.map(g=>this.tileID.getTilePoint(g)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.texture||(this.texture=new Ke(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let s=1/0,f=1/0,g=-1/0,w=-1/0;for(const D of e)s=Math.min(s,D.x),f=Math.min(f,D.y),g=Math.max(g,D.x),w=Math.max(w,D.y);const S={};for(let D=0;D<=c.a0;D++){const R=Math.pow(2,D),N=Math.floor(s*R),F=Math.floor(f*R),G=Math.floor(g*R),Z=Math.floor(w*R);S[D]={minTileX:N,minTileY:F,maxTileX:G,maxTileY:Z}}return S}}class fr extends rr{constructor(e,s,f,g){super(e,s,f,g),this.roundZoom=!0,this.type="video",this.options=s}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield c.a2(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new c.k(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new c.k(new c.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new Ke(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class xo extends rr{constructor(e,s,f,g){super(e,s,f,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(S=>typeof S!="number"))||this.fire(new c.k(new c.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a3(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new c.k(new c.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,f=s.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ke(s,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const w in this.tiles){const S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,g=!0)}g&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Bs={},bo=x=>{switch(x){case"geojson":return is;case"image":return rr;case"raster":return li;case"raster-dem":return js;case"vector":return wa;case"video":return fr;case"canvas":return xo}return Bs[x]},Fs="RTLPluginLoaded";class Xr extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Tn()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(s,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=U.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Fs))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ki=null;function pr(){return Ki||(Ki=new Xr),Ki}class Gi{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a4(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(g,w){const S={};if(!w)return S;for(const D of g){const R=D.layerIds.map(N=>w.getLayer(N)).filter(Boolean);if(R.length!==0){D.layers=R,D.stateDependentLayerIds&&(D.stateDependentLayers=D.stateDependentLayerIds.map(N=>R.filter(F=>F.id===N)[0]));for(const N of R)S[N.id]=D}}return S}(e.buckets,s==null?void 0:s.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const w=this.buckets[g];if(w instanceof c.a6){if(this.hasSymbolBuckets=!0,!f)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const w=this.buckets[g];if(w instanceof c.a6&&w.hasRTLText){this.hasRTLText=!0,pr().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const w=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(g).queryRadius(w))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ke(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ke(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,f,g,w,S,D,R,N,F,G){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:w,scale:S,tileSize:this.tileSize,pixelPosMatrix:F,transform:R,params:D,queryPadding:this.queryPadding*N,getElevation:G},e,s,f):{}}querySourceFeatures(e,s){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),w=s&&s.sourceLayer?s.sourceLayer:"",S=g._geojsonTileLayer||g[w];if(!S)return;const D=c.a7(s&&s.filter),{z:R,x:N,y:F}=this.tileID.canonical,G={z:R,x:N,y:F};for(let Z=0;Z<S.length;Z++){const K=S.feature(Z);if(D.needGeometry){const ue=c.a8(K,!0);if(!D.filter(new c.C(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!D.filter(new c.C(this.tileID.overscaledZ),K))continue;const te=f.getId(K,w),he=new c.a9(K,R,N,F,te);he.tile=G,e.push(he)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const f=c.aa(e.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(s)if(this.expirationTime<s)g=!0;else{const w=this.expirationTime-s;w?this.expirationTime=f+Math.max(w,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!s.style.hasLayer(g))continue;const w=this.buckets[g],S=w.layers[0].sourceLayer||"_geojsonTileLayer",D=f[S],R=e[S];if(!D||!R||Object.keys(R).length===0)continue;w.update(R,D,this.imageAtlas&&this.imageAtlas.patternPositions||{});const N=s&&s.style&&s.style.getLayer(g);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<U.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=U.now()+e}setDependencies(e,s){const f={};for(const g of s)f[g]=!0;this.dependencies[e]=f}hasDependency(e,s){for(const f of e){const g=this.dependencies[f];if(g){for(const w of s)if(g[w])return!0}}return!1}}class wo{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,f){const g=e.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const w={value:s,timeout:void 0};if(f!==void 0&&(w.timeout=setTimeout(()=>{this.remove(e,w)},f)),this.data[g].push(w),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const f=e.wrapped().key,g=s===void 0?0:this.data[f].indexOf(s),w=this.data[f][g];return this.data[f].splice(g,1),w.timeout&&clearTimeout(w.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(w.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const f in this.data)for(const g of this.data[f])e(g.value)||s.push(g);for(const f of s)this.remove(f.value.tileID,f)}}class Fc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,f){const g=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][g]=this.stateChanges[e][g]||{},c.e(this.stateChanges[e][g],f),this.deletedStates[e]===null){this.deletedStates[e]={};for(const w in this.state[e])w!==g&&(this.deletedStates[e][w]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][g]===null){this.deletedStates[e][g]={};for(const w in this.state[e][g])f[w]||(this.deletedStates[e][g][w]=null)}else for(const w in f)this.deletedStates[e]&&this.deletedStates[e][g]&&this.deletedStates[e][g][w]===null&&delete this.deletedStates[e][g][w]}removeFeatureState(e,s,f){if(this.deletedStates[e]===null)return;const g=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},f&&s!==void 0)this.deletedStates[e][g]!==null&&(this.deletedStates[e][g]=this.deletedStates[e][g]||{},this.deletedStates[e][g][f]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][g])for(f in this.deletedStates[e][g]={},this.stateChanges[e][g])this.deletedStates[e][g][f]=null;else this.deletedStates[e][g]=null;else this.deletedStates[e]=null}getState(e,s){const f=String(s),g=c.e({},(this.state[e]||{})[f],(this.stateChanges[e]||{})[f]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const w=this.deletedStates[e][s];if(w===null)return{};for(const S in w)delete g[S]}return g}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const w={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),c.e(this.state[g][S],this.stateChanges[g][S]),w[S]=this.state[g][S];f[g]=w}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const w={};if(this.deletedStates[g]===null)for(const S in this.state[g])w[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(this.deletedStates[g][S]===null)this.state[g][S]={};else for(const D of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][D];w[S]=this.state[g][S]}f[g]=f[g]||{},c.e(f[g],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in e)e[g].setFeatureState(f,s)}}function zu(x,e,s){const f=e.intersectsFrustum(x);if(!s)return f;const g=e.intersectsPlane(s);return f===0||g===0?0:f===2&&g===2?2:1}function Vl(x,e,s,f,g){let w=x;const S=Math.atan(e/s),D=Math.hypot(e,s);return w=x+c.ab(f/D/Math.max(.5,Math.cos(c.ad(g/2)))),w+=1*c.ab(Math.cos(S))/2,w+=c.ae(x-w,-0,0),w}function ja(x,e){const s=(e.roundZoom?Math.round:Math.floor)(x.zoom+c.ab(x.tileSize/e.tileSize));return Math.max(0,s)}function Ne(x,e){const s=x.getCameraFrustum(),f=x.getClippingPlane(),g=x.screenPointToMercatorCoordinate(x.getCameraPoint()),w=c.$.fromLngLat(x.center,x.elevation);g.z=w.z+Math.cos(x.pitchInRadians)*x.cameraToCenterDistance/x.worldSize;const S=x.getCoveringTilesDetailsProvider(),D=S.allowVariableZoom(x,e),R=ja(x,e),N=e.minzoom||0,F=e.maxzoom!==void 0?e.maxzoom:x.maxZoom,G=Math.min(Math.max(0,R),F),Z=Math.pow(2,G),K=[Z*g.x,Z*g.y,0],te=[Z*w.x,Z*w.y,0],he=Math.hypot(w.x-g.x,w.y-g.y),ue=Math.abs(w.z-g.z),de=Math.hypot(he,ue),ge=Te=>({zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),xe=[],be=[];if(x.renderWorldCopies&&S.allowWorldCopies())for(let Te=1;Te<=3;Te++)xe.push(ge(-Te)),xe.push(ge(Te));for(xe.push(ge(0));xe.length>0;){const Te=xe.pop(),De=Te.x,Me=Te.y;let Ge=Te.fullyVisible;const Ue={x:De,y:Me,z:Te.zoom},at=S.getTileAABB(Ue,Te.wrap,x.elevation,e);if(!Ge){const Et=zu(s,at,f);if(Et===0)continue;Ge=Et===2}const st=S.distanceToTile2d(g.x,g.y,Ue,at);let it=R;D&&(it=(e.calculateTileZoom||Vl)(x.zoom+c.ab(x.tileSize/e.tileSize),st,ue,de,x.fov)),it=(e.roundZoom?Math.round:Math.floor)(it),it=Math.max(0,it);const At=Math.min(it,F);if(Te.wrap=S.getWrap(w,Ue,Te.wrap),Te.zoom>=At){if(Te.zoom<N)continue;const Et=G-Te.zoom,ut=K[0]-.5-(De<<Et),Ft=K[1]-.5-(Me<<Et),cn=e.reparseOverscaled?Math.max(Te.zoom,it):Te.zoom;be.push({tileID:new c.Y(Te.zoom===F?cn:Te.zoom,Te.wrap,Te.zoom,De,Me),distanceSq:c.ac([te[0]-.5-De,te[1]-.5-Me]),tileDistanceToCamera:Math.sqrt(ut*ut+Ft*Ft)})}else for(let Et=0;Et<4;Et++)xe.push({zoom:Te.zoom+1,x:(De<<1)+Et%2,y:(Me<<1)+(Et>>1),wrap:Te.wrap,fullyVisible:Ge})}return be.sort((Te,De)=>Te.distanceSq-De.distanceSq).map(Te=>Te.tileID)}class ee extends c.E{constructor(e,s,f){super(),this.id=e,this.dispatcher=f,this.on("data",g=>this._dataHandler(g)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,w,S,D)=>{const R=new(bo(w.type))(g,w,S,D);if(R.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${R.id}`);return R})(e,s,f,this),this._tiles={},this._cache=new wo(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Fc,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,f)}catch(g){e.state="errored",g.status!==404?this._source.fire(new c.k(g,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const f=this._tiles[s];f.upload(e),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(re).map(e=>e.key)}getRenderableIds(e){const s=[];for(const f in this._tiles)this._isIdRenderable(f,e)&&s.push(this._tiles[f]);return e?s.sort((f,g)=>{const w=f.tileID,S=g.tileID,D=new c.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),R=new c.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-S.overscaledZ||R.y-D.y||R.x-D.x}).map(f=>f.tileID.key):s.map(f=>f.tileID).sort(re).map(f=>f.key)}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)(e||this._tiles[s].state!=="errored")&&this._reloadTile(s,"reloading")}}_reloadTile(e,s){return c._(this,void 0,void 0,function*(){const f=this._tiles[e];f&&(f.state!=="loading"&&(f.state=s),yield this._loadTile(f,e,s))})}_tileLoaded(e,s,f){e.timeAdded=U.now(),f==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let g=0;g<s.length;g++){const w=s[g];if(e.neighboringTiles&&e.neighboringTiles[w]){const S=this.getTileByID(w);f(e,S),f(S,e)}}function f(g,w){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let S=w.tileID.canonical.x-g.tileID.canonical.x;const D=w.tileID.canonical.y-g.tileID.canonical.y,R=Math.pow(2,g.tileID.canonical.z),N=w.tileID.key;S===0&&D===0||Math.abs(D)>1||(Math.abs(S)>1&&(Math.abs(S+R)===1?S+=R:Math.abs(S-R)===1&&(S-=R)),w.dem&&g.dem&&(g.dem.backfillBorder(w.dem,S,D),g.neighboringTiles&&g.neighboringTiles[N]&&(g.neighboringTiles[N].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,f,g){for(const w in this._tiles){let S=this._tiles[w];if(g[w]||!S.hasData()||S.tileID.overscaledZ<=s||S.tileID.overscaledZ>f)continue;let D=S.tileID;for(;S&&S.tileID.overscaledZ>s+1;){const N=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[N.key],S&&S.hasData()&&(D=N)}let R=D;for(;R.overscaledZ>s;)if(R=R.scaledTo(R.overscaledZ-1),e[R.key]||e[R.canonical.key]){g[D.key]=D;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const f=this._loadedParentTiles[e.key];return f&&f.tileID.overscaledZ>=s?f:null}for(let f=e.overscaledZ-1;f>=s;f--){const g=e.scaledTo(f),w=this._getLoadedTile(g);if(w)return w}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,f=Math.ceil(e.height/this._source.tileSize)+1,g=Math.floor(s*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(w)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const f={};for(const g in this._tiles){const w=this._tiles[g];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+s),f[w.tileID.key]=w}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(e,s,f,g,w,S){const D={},R={},N=Object.keys(e),F=U.now();for(const G of N){const Z=e[G],K=this._tiles[G];if(!K||K.fadeEndTime!==0&&K.fadeEndTime<=F)continue;const te=this.findLoadedParent(Z,s),he=this.findLoadedSibling(Z),ue=te||he||null;ue&&(this._addTile(ue.tileID),D[ue.tileID.key]=ue.tileID),R[G]=Z}this._retainLoadedChildren(R,g,f,e);for(const G in D)e[G]||(this._coveredTiles[G]=!0,e[G]=D[G]);if(S){const G={},Z={};for(const K of w)this._tiles[K.key].hasData()?G[K.key]=K:Z[K.key]=K;for(const K in Z){const te=Z[K].children(this._source.maxzoom);this._tiles[te[0].key]&&this._tiles[te[1].key]&&this._tiles[te[2].key]&&this._tiles[te[3].key]&&(G[te[0].key]=e[te[0].key]=te[0],G[te[1].key]=e[te[1].key]=te[1],G[te[2].key]=e[te[2].key]=te[2],G[te[3].key]=e[te[3].key]=te[3],delete Z[K])}for(const K in Z){const te=Z[K],he=this.findLoadedParent(te,this._source.minzoom),ue=this.findLoadedSibling(te),de=he||ue||null;if(de){G[de.tileID.key]=e[de.tileID.key]=de.tileID;for(const ge in G)G[ge].isChildOf(de.tileID)&&delete G[ge]}}for(const K in this._tiles)G[K]||(this._coveredTiles[K]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let f;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new c.Y(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y)):(f=Ne(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(F=>this._source.hasTile(F)))):f=[];const g=ja(e,this._source),w=Math.max(g-ee.maxOverzooming,this._source.minzoom),S=Math.max(g+ee.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const G of f)if(G.canonical.z>this._source.minzoom){const Z=G.scaledTo(G.canonical.z-1);F[Z.key]=Z;const K=G.scaledTo(Math.max(this._source.minzoom,Math.min(G.canonical.z,5)));F[K.key]=K}f=f.concat(Object.values(F))}const D=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,D&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const R=this._updateRetainedTiles(f,g);X(this._source.type)&&this._updateCoveredAndRetainedTiles(R,w,S,g,f,s);for(const F in R)this._tiles[F].clearFadeHold();const N=c.af(this._tiles,R);for(const F of N){const G=this._tiles[F];G.hasSymbolBuckets&&!G.holdingForFade()?G.setHoldDuration(this.map._fadeDuration):G.hasSymbolBuckets&&!G.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var f;const g={},w={},S=Math.max(s-ee.maxOverzooming,this._source.minzoom),D=Math.max(s+ee.maxUnderzooming,this._source.minzoom),R={};for(const N of e){const F=this._addTile(N);g[N.key]=N,F.hasData()||s<this._source.maxzoom&&(R[N.key]=N)}this._retainLoadedChildren(R,s,D,g);for(const N of e){let F=this._tiles[N.key];if(F.hasData())continue;if(s+1>this._source.maxzoom){const Z=N.children(this._source.maxzoom)[0],K=this.getTile(Z);if(K&&K.hasData()){g[Z.key]=Z;continue}}else{const Z=N.children(this._source.maxzoom);if(g[Z[0].key]&&g[Z[1].key]&&g[Z[2].key]&&g[Z[3].key])continue}let G=F.wasRequested();for(let Z=N.overscaledZ-1;Z>=S;--Z){const K=N.scaledTo(Z);if(w[K.key])break;if(w[K.key]=!0,F=this.getTile(K),!F&&G&&(F=this._addTile(K)),F){const te=F.hasData();if((te||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||G)&&(g[K.key]=K),G=F.wasRequested(),te)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let f,g=this._tiles[e].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}s.push(g.key);const w=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(w),f)break;g=w}for(const w of s)this._loadedParentTiles[w]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,f=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=f}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const f=s;return s||(s=new Gi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,f||this._source.fire(new c.l("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const f=s.getExpiryTimeout();f&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},f))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,f){const g=[],w=this.transform;if(!w)return g;const S=f?w.getCameraQueryGeometry(e):e,D=e.map(te=>w.screenPointToMercatorCoordinate(te,this.terrain)),R=S.map(te=>w.screenPointToMercatorCoordinate(te,this.terrain)),N=this.getIds();let F=1/0,G=1/0,Z=-1/0,K=-1/0;for(const te of R)F=Math.min(F,te.x),G=Math.min(G,te.y),Z=Math.max(Z,te.x),K=Math.max(K,te.y);for(let te=0;te<N.length;te++){const he=this._tiles[N[te]];if(he.holdingForFade())continue;const ue=he.tileID,de=Math.pow(2,w.zoom-he.tileID.overscaledZ),ge=s*he.queryPadding*c.Z/he.tileSize/de,xe=[ue.getTilePoint(new c.$(F,G)),ue.getTilePoint(new c.$(Z,K))];if(xe[0].x-ge<c.Z&&xe[0].y-ge<c.Z&&xe[1].x+ge>=0&&xe[1].y+ge>=0){const be=D.map(De=>ue.getTilePoint(De)),Te=R.map(De=>ue.getTilePoint(De));g.push({tile:he,tileID:ue,queryGeometry:be,cameraQueryGeometry:Te,scale:de})}}return g}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(s),s}hasTransition(){if(this._source.hasTransition())return!0;if(X(this._source.type)){const e=U.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,f){this._state.updateState(e=e||"_geojsonTileLayer",s,f)}removeFeatureState(e,s,f){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,f)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,f){const g=this._tiles[e];g&&g.setDependencies(s,f)}reloadTilesForDependencies(e,s){for(const f in this._tiles)this._tiles[f].hasDependency(e,s)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(e,s))}}function re(x,e){const s=Math.abs(2*x.wrap)-+(x.wrap<0),f=Math.abs(2*e.wrap)-+(e.wrap<0);return x.overscaledZ-e.overscaledZ||f-s||e.canonical.y-x.canonical.y||e.canonical.x-x.canonical.x}function X(x){return x==="raster"||x==="image"||x==="video"}ee.maxOverzooming=10,ee.maxUnderzooming=3;class _e{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ae(e,0,1);let s=1,f=this._distances[s];const g=e*this.paddedLength+this.padding;for(;f<g&&s<this._distances.length;)f=this._distances[++s];const w=s-1,S=this._distances[w],D=f-S,R=D>0?(g-S)/D:0;return this.points[w].mult(1-R).add(this.points[s].mult(R))}}function Ce(x,e){let s=!0;return x==="always"||x!=="never"&&e!=="never"||(s=!1),s}class Ae{constructor(e,s,f){const g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(e/f),this.yCellCount=Math.ceil(s/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,f,g,w){this._forEachCell(s,f,g,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(w)}insertCircle(e,s,f,g){this._forEachCell(s-g,f-g,s+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(f),this.circles.push(g)}_insertBoxCell(e,s,f,g,w,S){this.boxCells[w].push(S)}_insertCircleCell(e,s,f,g,w,S){this.circleCells[w].push(S)}_query(e,s,f,g,w,S,D){if(f<0||e>this.width||g<0||s>this.height)return[];const R=[];if(e<=0&&s<=0&&this.width<=f&&this.height<=g){if(w)return[{key:null,x1:e,y1:s,x2:f,y2:g}];for(let N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const F=this.circles[3*N],G=this.circles[3*N+1],Z=this.circles[3*N+2];R.push({key:this.circleKeys[N],x1:F-Z,y1:G-Z,x2:F+Z,y2:G+Z})}}else this._forEachCell(e,s,f,g,this._queryCell,R,{hitTest:w,overlapMode:S,seenUids:{box:{},circle:{}}},D);return R}query(e,s,f,g){return this._query(e,s,f,g,!1,null)}hitTest(e,s,f,g,w,S){return this._query(e,s,f,g,!0,w,S).length>0}hitTestCircle(e,s,f,g,w){const S=e-f,D=e+f,R=s-f,N=s+f;if(D<0||S>this.width||N<0||R>this.height)return!1;const F=[];return this._forEachCell(S,R,D,N,this._queryCellCircle,F,{hitTest:!0,overlapMode:g,circle:{x:e,y:s,radius:f},seenUids:{box:{},circle:{}}},w),F.length>0}_queryCell(e,s,f,g,w,S,D,R){const{seenUids:N,hitTest:F,overlapMode:G}=D,Z=this.boxCells[w];if(Z!==null){const te=this.bboxes;for(const he of Z)if(!N.box[he]){N.box[he]=!0;const ue=4*he,de=this.boxKeys[he];if(e<=te[ue+2]&&s<=te[ue+3]&&f>=te[ue+0]&&g>=te[ue+1]&&(!R||R(de))&&(!F||!Ce(G,de.overlapMode))&&(S.push({key:de,x1:te[ue],y1:te[ue+1],x2:te[ue+2],y2:te[ue+3]}),F))return!0}}const K=this.circleCells[w];if(K!==null){const te=this.circles;for(const he of K)if(!N.circle[he]){N.circle[he]=!0;const ue=3*he,de=this.circleKeys[he];if(this._circleAndRectCollide(te[ue],te[ue+1],te[ue+2],e,s,f,g)&&(!R||R(de))&&(!F||!Ce(G,de.overlapMode))){const ge=te[ue],xe=te[ue+1],be=te[ue+2];if(S.push({key:de,x1:ge-be,y1:xe-be,x2:ge+be,y2:xe+be}),F)return!0}}}return!1}_queryCellCircle(e,s,f,g,w,S,D,R){const{circle:N,seenUids:F,overlapMode:G}=D,Z=this.boxCells[w];if(Z!==null){const te=this.bboxes;for(const he of Z)if(!F.box[he]){F.box[he]=!0;const ue=4*he,de=this.boxKeys[he];if(this._circleAndRectCollide(N.x,N.y,N.radius,te[ue+0],te[ue+1],te[ue+2],te[ue+3])&&(!R||R(de))&&!Ce(G,de.overlapMode))return S.push(!0),!0}}const K=this.circleCells[w];if(K!==null){const te=this.circles;for(const he of K)if(!F.circle[he]){F.circle[he]=!0;const ue=3*he,de=this.circleKeys[he];if(this._circlesCollide(te[ue],te[ue+1],te[ue+2],N.x,N.y,N.radius)&&(!R||R(de))&&!Ce(G,de.overlapMode))return S.push(!0),!0}}}_forEachCell(e,s,f,g,w,S,D,R){const N=this._convertToXCellCoord(e),F=this._convertToYCellCoord(s),G=this._convertToXCellCoord(f),Z=this._convertToYCellCoord(g);for(let K=N;K<=G;K++)for(let te=F;te<=Z;te++)if(w.call(this,e,s,f,g,this.xCellCount*te+K,S,D,R))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,f,g,w,S){const D=g-e,R=w-s,N=f+S;return N*N>D*D+R*R}_circleAndRectCollide(e,s,f,g,w,S,D){const R=(S-g)/2,N=Math.abs(e-(g+R));if(N>R+f)return!1;const F=(D-w)/2,G=Math.abs(s-(w+F));if(G>F+f)return!1;if(N<=R||G<=F)return!0;const Z=N-R,K=G-F;return Z*Z+K*K<=f*f}}function Be(x,e,s){const f=c.K();if(!x){const{vecSouth:G,vecEast:Z}=rt(e),K=k();K[0]=Z[0],K[1]=Z[1],K[2]=G[0],K[3]=G[1],g=K,(F=(S=(w=K)[0])*(N=w[3])-(R=w[2])*(D=w[1]))&&(g[0]=N*(F=1/F),g[1]=-D*F,g[2]=-R*F,g[3]=S*F),f[0]=K[0],f[1]=K[1],f[4]=K[2],f[5]=K[3]}var g,w,S,D,R,N,F;return c.M(f,f,[1/s,1/s,1]),f}function ze(x,e,s,f){if(x){const g=c.K();if(!e){const{vecSouth:w,vecEast:S}=rt(s);g[0]=S[0],g[1]=S[1],g[4]=w[0],g[5]=w[1]}return c.M(g,g,[f,f,1]),g}return s.pixelsToClipSpaceMatrix}function rt(x){const e=Math.cos(x.rollInRadians),s=Math.sin(x.rollInRadians),f=Math.cos(x.pitchInRadians),g=Math.cos(x.bearingInRadians),w=Math.sin(x.bearingInRadians),S=c.ak();S[0]=-g*f*s-w*e,S[1]=-w*f*s+g*e;const D=c.al(S);D<1e-9?c.am(S):c.an(S,S,1/D);const R=c.ak();R[0]=g*f*e-w*s,R[1]=w*f*e+g*s;const N=c.al(R);return N<1e-9?c.am(R):c.an(R,R,1/N),{vecEast:R,vecSouth:S}}function Je(x,e,s,f){let g;f?(g=[x,e,f(x,e),1],c.ap(g,g,s)):(g=[x,e,0,1],Bi(g,g,s));const w=g[3];return{point:new c.P(g[0]/w,g[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function je(x,e){return .5+x/e*.5}function ht(x,e){return x.x>=-e[0]&&x.x<=e[0]&&x.y>=-e[1]&&x.y<=e[1]}function Ct(x,e,s,f,g,w,S,D,R,N,F,G,Z){const K=s?x.textSizeData:x.iconSizeData,te=c.ag(K,e.transform.zoom),he=[256/e.width*2+1,256/e.height*2+1],ue=s?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;ue.clear();const de=x.lineVertexArray,ge=s?x.text.placedSymbolArray:x.icon.placedSymbolArray,xe=e.transform.width/e.transform.height;let be=!1;for(let Te=0;Te<ge.length;Te++){const De=ge.get(Te);if(De.hidden||De.writingMode===c.ah.vertical&&!be){qt(De.numGlyphs,ue);continue}be=!1;const Me=new c.P(De.anchorX,De.anchorY),Ge={getElevation:Z,pitchedLabelPlaneMatrix:f,lineVertexArray:de,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:Me,unwrappedTileID:R,width:N,height:F,translation:G},Ue=Bt(De.anchorX,De.anchorY,Ge);if(!ht(Ue.point,he)){qt(De.numGlyphs,ue);continue}const at=je(e.transform.cameraToCenterDistance,Ue.signedDistanceFromCamera),st=c.ai(K,te,De),it=w?st*e.transform.getPitchedTextCorrection(De.anchorX,De.anchorY,R)/at:st*at,At=$t({projectionContext:Ge,pitchedLabelPlaneMatrixInverse:g,symbol:De,fontSize:it,flip:!1,keepUpright:S,glyphOffsetArray:x.glyphOffsetArray,dynamicLayoutVertexArray:ue,aspectRatio:xe,rotateToLine:D});be=At.useVertical,(At.notEnoughRoom||be||At.needsFlipping&&$t({projectionContext:Ge,pitchedLabelPlaneMatrixInverse:g,symbol:De,fontSize:it,flip:!0,keepUpright:S,glyphOffsetArray:x.glyphOffsetArray,dynamicLayoutVertexArray:ue,aspectRatio:xe,rotateToLine:D}).notEnoughRoom)&&qt(De.numGlyphs,ue)}s?x.text.dynamicLayoutVertexBuffer.updateData(ue):x.icon.dynamicLayoutVertexBuffer.updateData(ue)}function Rt(x,e,s,f,g,w,S,D){const R=w.glyphStartIndex+w.numGlyphs,N=w.lineStartIndex,F=w.lineStartIndex+w.lineLength,G=e.getoffsetX(w.glyphStartIndex),Z=e.getoffsetX(R-1),K=Ci(x*G,s,f,g,w.segment,N,F,D,S);if(!K)return null;const te=Ci(x*Z,s,f,g,w.segment,N,F,D,S);return te?D.projectionCache.anyProjectionOccluded?null:{first:K,last:te}:null}function Xe(x,e,s,f){return x===c.ah.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*f?{useVertical:!0}:(x===c.ah.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function $t(x){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:s,symbol:f,fontSize:g,flip:w,keepUpright:S,glyphOffsetArray:D,dynamicLayoutVertexArray:R,aspectRatio:N,rotateToLine:F}=x,G=g/24,Z=f.lineOffsetX*G,K=f.lineOffsetY*G;let te;if(f.numGlyphs>1){const he=f.glyphStartIndex+f.numGlyphs,ue=f.lineStartIndex,de=f.lineStartIndex+f.lineLength,ge=Rt(G,D,Z,K,w,f,F,e);if(!ge)return{notEnoughRoom:!0};const xe=yt(ge.first.point.x,ge.first.point.y,e,s),be=yt(ge.last.point.x,ge.last.point.y,e,s);if(S&&!w){const Te=Xe(f.writingMode,xe,be,N);if(Te)return Te}te=[ge.first];for(let Te=f.glyphStartIndex+1;Te<he-1;Te++)te.push(Ci(G*D.getoffsetX(Te),Z,K,w,f.segment,ue,de,e,F));te.push(ge.last)}else{if(S&&!w){const ue=Cn(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,de=f.lineStartIndex+f.segment+1,ge=new c.P(e.lineVertexArray.getx(de),e.lineVertexArray.gety(de)),xe=Cn(ge.x,ge.y,e),be=xe.signedDistanceFromCamera>0?xe.point:jt(e.tileAnchorPoint,ge,ue,1,e),Te=yt(ue.x,ue.y,e,s),De=yt(be.x,be.y,e,s),Me=Xe(f.writingMode,Te,De,N);if(Me)return Me}const he=Ci(G*D.getoffsetX(f.glyphStartIndex),Z,K,w,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,e,F);if(!he||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};te=[he]}for(const he of te)c.ao(R,he.point,he.angle);return{}}function jt(x,e,s,f,g){const w=x.add(x.sub(e)._unit()),S=Cn(w.x,w.y,g).point,D=s.sub(S);return s.add(D._mult(f/D.mag()))}function nn(x,e,s){const f=e.projectionCache;if(f.projections[x])return f.projections[x];const g=new c.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),w=Cn(g.x,g.y,e);if(w.signedDistanceFromCamera>0)return f.projections[x]=w.point,f.anyProjectionOccluded=f.anyProjectionOccluded||w.isOccluded,w.point;const S=x-s.direction;return jt(s.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),g,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function Cn(x,e,s){const f=x+s.translation[0],g=e+s.translation[1];let w;return s.pitchWithMap?(w=Je(f,g,s.pitchedLabelPlaneMatrix,s.getElevation),w.isOccluded=!1):(w=s.transform.projectTileCoordinates(f,g,s.unwrappedTileID,s.getElevation),w.point.x=(.5*w.point.x+.5)*s.width,w.point.y=(.5*-w.point.y+.5)*s.height),w}function yt(x,e,s,f){if(s.pitchWithMap){const g=[x,e,0,1];return c.ap(g,g,f),s.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],s.unwrappedTileID,s.getElevation).point}return{x:x/s.width*2-1,y:e/s.height*2-1}}function Bt(x,e,s){return s.transform.projectTileCoordinates(x,e,s.unwrappedTileID,s.getElevation)}function Mt(x,e,s){return x._unit()._perp()._mult(e*s)}function sn(x,e,s,f,g,w,S,D,R){if(D.projectionCache.offsets[x])return D.projectionCache.offsets[x];const N=s.add(e);if(x+R.direction<f||x+R.direction>=g)return D.projectionCache.offsets[x]=N,N;const F=nn(x+R.direction,D,R),G=Mt(F.sub(s),S,R.direction),Z=s.add(G),K=F.add(G);return D.projectionCache.offsets[x]=c.aq(w,N,Z,K)||N,D.projectionCache.offsets[x]}function Ci(x,e,s,f,g,w,S,D,R){const N=f?x-e:x+e;let F=N>0?1:-1,G=0;f&&(F*=-1,G=Math.PI),F<0&&(G+=Math.PI);let Z,K=F>0?w+g:w+g+1;D.projectionCache.cachedAnchorPoint?Z=D.projectionCache.cachedAnchorPoint:(Z=Cn(D.tileAnchorPoint.x,D.tileAnchorPoint.y,D).point,D.projectionCache.cachedAnchorPoint=Z);let te,he,ue=Z,de=Z,ge=0,xe=0;const be=Math.abs(N),Te=[];let De;for(;ge+xe<=be;){if(K+=F,K<w||K>=S)return null;ge+=xe,de=ue,he=te;const Ue={absOffsetX:be,direction:F,distanceFromAnchor:ge,previousVertex:de};if(ue=nn(K,D,Ue),s===0)Te.push(de),De=ue.sub(de);else{let at;const st=ue.sub(de);at=st.mag()===0?Mt(nn(K+F,D,Ue).sub(ue),s,F):Mt(st,s,F),he||(he=de.add(at)),te=sn(K,at,ue,w,S,he,s,D,Ue),Te.push(he),De=te.sub(he)}xe=De.mag()}const Me=De._mult((be-ge)/xe)._add(he||de),Ge=G+Math.atan2(ue.y-de.y,ue.x-de.x);return Te.push(Me),{point:Me,angle:R?Ge:0,path:Te}}const sa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qt(x,e){for(let s=0;s<x;s++){const f=e.length;e.resize(f+4),e.float32.set(sa,3*f)}}function Bi(x,e,s){const f=e[0],g=e[1];return x[0]=s[0]*f+s[4]*g+s[12],x[1]=s[1]*f+s[5]*g+s[13],x[3]=s[3]*f+s[7]*g+s[15],x}const $n=100;class Ji{constructor(e,s=new Ae(e.width+200,e.height+200,25),f=new Ae(e.width+200,e.height+200,25)){this.transform=e,this.grid=s,this.ignoredGrid=f,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+$n,this.screenBottomBoundary=e.height+$n,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,f,g,w,S,D,R,N,F,G,Z){const K=this.projectAndGetPerspectiveRatio(e.anchorPointX+R[0],e.anchorPointY+R[1],w,F,Z),te=f*K.perspectiveRatio;let he;if(S||D)he=this._projectCollisionBox(e,te,g,w,S,D,R,K,F,G,Z);else{const De=K.x+(G?G.x*te:0),Me=K.y+(G?G.y*te:0);he={allPointsOccluded:!1,box:[De+e.x1*te,Me+e.y1*te,De+e.x2*te,Me+e.y2*te]}}const[ue,de,ge,xe]=he.box,be=S?he.allPointsOccluded:K.isOccluded;let Te=be;return Te||(Te=K.perspectiveRatio<this.perspectiveRatioCutoff),Te||(Te=!this.isInsideGrid(ue,de,ge,xe)),Te||s!=="always"&&this.grid.hitTest(ue,de,ge,xe,s,N)?{box:[ue,de,ge,xe],placeable:!1,offscreen:!1,occluded:be}:{box:[ue,de,ge,xe],placeable:!0,offscreen:this.isOffscreen(ue,de,ge,xe),occluded:be}}placeCollisionCircles(e,s,f,g,w,S,D,R,N,F,G,Z,K,te){const he=[],ue=new c.P(s.anchorX,s.anchorY),de=this.getPerspectiveRatio(ue.x,ue.y,S,te),ge=(N?w*this.transform.getPitchedTextCorrection(s.anchorX,s.anchorY,S)/de:w*de)/c.av,xe={getElevation:te,pitchedLabelPlaneMatrix:D,lineVertexArray:f,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ue,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:K},be=Rt(ge,g,s.lineOffsetX*ge,s.lineOffsetY*ge,!1,s,!1,xe);let Te=!1,De=!1,Me=!0;if(be){const Ge=.5*G*de+Z,Ue=new c.P(-100,-100),at=new c.P(this.screenRightBoundary,this.screenBottomBoundary),st=new _e,it=be.first,At=be.last;let Et=[];for(let cn=it.path.length-1;cn>=1;cn--)Et.push(it.path[cn]);for(let cn=1;cn<At.path.length;cn++)Et.push(At.path[cn]);const ut=2.5*Ge;if(N){const cn=this.projectPathToScreenSpace(Et,xe);Et=cn.some(In=>In.signedDistanceFromCamera<=0)?[]:cn.map(In=>In.point)}let Ft=[];if(Et.length>0){const cn=Et[0].clone(),In=Et[0].clone();for(let pn=1;pn<Et.length;pn++)cn.x=Math.min(cn.x,Et[pn].x),cn.y=Math.min(cn.y,Et[pn].y),In.x=Math.max(In.x,Et[pn].x),In.y=Math.max(In.y,Et[pn].y);Ft=cn.x>=Ue.x&&In.x<=at.x&&cn.y>=Ue.y&&In.y<=at.y?[Et]:In.x<Ue.x||cn.x>at.x||In.y<Ue.y||cn.y>at.y?[]:c.ar([Et],Ue.x,Ue.y,at.x,at.y)}for(const cn of Ft){st.reset(cn,.25*Ge);let In=0;In=st.length<=.5*Ge?1:Math.ceil(st.paddedLength/ut)+1;for(let pn=0;pn<In;pn++){const Xn=pn/Math.max(In-1,1),ai=st.lerp(Xn),ui=ai.x+$n,Yn=ai.y+$n;he.push(ui,Yn,Ge,0);const Wn=ui-Ge,Fi=Yn-Ge,lr=ui+Ge,gr=Yn+Ge;if(Me=Me&&this.isOffscreen(Wn,Fi,lr,gr),De=De||this.isInsideGrid(Wn,Fi,lr,gr),e!=="always"&&this.grid.hitTestCircle(ui,Yn,Ge,e,F)&&(Te=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!R&&Te||!De||de<this.perspectiveRatioCutoff?[]:he,offscreen:Me,collisionDetected:Te}}projectPathToScreenSpace(e,s){const f=function(g,w){const S=c.K();return c.aj(S,w.pitchedLabelPlaneMatrix),g.map(D=>{const R=Je(D.x,D.y,S,w.getElevation),N=w.transform.projectTileCoordinates(R.point.x,R.point.y,w.unwrappedTileID,w.getElevation);return N.point.x=(.5*N.point.x+.5)*w.width,N.point.y=(.5*-N.point.y+.5)*w.height,N})}(e,s);return function(g){let w=0,S=0,D=0,R=0;for(let N=0;N<g.length;N++)g[N].isOccluded?(D=N+1,R=0):(R++,R>S&&(S=R,w=D));return g.slice(w,w+S)}(f)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let f=1/0,g=1/0,w=-1/0,S=-1/0;for(const F of e){const G=new c.P(F.x+$n,F.y+$n);f=Math.min(f,G.x),g=Math.min(g,G.y),w=Math.max(w,G.x),S=Math.max(S,G.y),s.push(G)}const D=this.grid.query(f,g,w,S).concat(this.ignoredGrid.query(f,g,w,S)),R={},N={};for(const F of D){const G=F.key;if(R[G.bucketInstanceId]===void 0&&(R[G.bucketInstanceId]={}),R[G.bucketInstanceId][G.featureIndex])continue;const Z=[new c.P(F.x1,F.y1),new c.P(F.x2,F.y1),new c.P(F.x2,F.y2),new c.P(F.x1,F.y2)];c.as(s,Z)&&(R[G.bucketInstanceId][G.featureIndex]=!0,N[G.bucketInstanceId]===void 0&&(N[G.bucketInstanceId]=[]),N[G.bucketInstanceId].push(G.featureIndex))}return N}insertCollisionBox(e,s,f,g,w,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:w,collisionGroupID:S,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,f,g,w,S){const D=f?this.ignoredGrid:this.grid,R={bucketInstanceId:g,featureIndex:w,collisionGroupID:S,overlapMode:s};for(let N=0;N<e.length;N+=4)D.insertCircle(R,e[N],e[N+1],e[N+2])}projectAndGetPerspectiveRatio(e,s,f,g,w){if(w){let S;g?(S=[e,s,g(e,s),1],c.ap(S,S,w)):(S=[e,s,0,1],Bi(S,S,w));const D=S[3];return{x:(S[0]/D+1)/2*this.transform.width+$n,y:(-S[1]/D+1)/2*this.transform.height+$n,perspectiveRatio:.5+this.transform.cameraToCenterDistance/D*.5,isOccluded:!1,signedDistanceFromCamera:D}}{const S=this.transform.projectTileCoordinates(e,s,f,g);return{x:(S.point.x+1)/2*this.transform.width+$n,y:(1-S.point.y)/2*this.transform.height+$n,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(e,s,f,g){const w=this.transform.projectTileCoordinates(e,s,f,g);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(e,s,f,g){return f<$n||e>=this.screenRightBoundary||g<$n||s>this.screenBottomBoundary}isInsideGrid(e,s,f,g){return f>=0&&e<this.gridRightBoundary&&g>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=c.at([]);return c.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,f,g,w,S,D,R,N,F,G){let Z=1,K=0,te=0,he=1;const ue=e.anchorPointX+D[0],de=e.anchorPointY+D[1];if(S&&!w){const Et=this.projectAndGetPerspectiveRatio(ue+1,de,g,N,G),ut=Et.x-R.x,Ft=Math.atan((Et.y-R.y)/ut)+(ut<0?Math.PI:0),cn=Math.sin(Ft),In=Math.cos(Ft);Z=In,K=cn,te=-cn,he=In}else if(!S&&w){const Et=rt(this.transform);Z=Et.vecEast[0],K=Et.vecEast[1],te=Et.vecSouth[0],he=Et.vecSouth[1]}let ge=R.x,xe=R.y,be=s;w&&(ge=ue,xe=de,be=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),be*=this.transform.getPitchedTextCorrection(ue,de,g),F||(be*=c.ae(.5+R.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),F&&(ge+=Z*F.x*be+te*F.y*be,xe+=K*F.x*be+he*F.y*be);const Te=e.x1*be,De=e.x2*be,Me=(Te+De)/2,Ge=e.y1*be,Ue=e.y2*be,at=(Ge+Ue)/2,st=[{offsetX:Te,offsetY:Ge},{offsetX:Me,offsetY:Ge},{offsetX:De,offsetY:Ge},{offsetX:De,offsetY:at},{offsetX:De,offsetY:Ue},{offsetX:Me,offsetY:Ue},{offsetX:Te,offsetY:Ue},{offsetX:Te,offsetY:at}];let it=[];for(const{offsetX:Et,offsetY:ut}of st)it.push(new c.P(ge+Z*Et+te*ut,xe+K*Et+he*ut));let At=!1;if(w){const Et=it.map(ut=>this.projectAndGetPerspectiveRatio(ut.x,ut.y,g,N,G));At=Et.some(ut=>!ut.isOccluded),it=Et.map(ut=>new c.P(ut.x,ut.y))}else At=!0;return{box:c.au(it),allPointsOccluded:!At}}}class Zl{constructor(e,s,f,g){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class To{constructor(e,s,f,g,w){this.text=new Zl(e?e.text:null,s,f,w),this.icon=new Zl(e?e.icon:null,s,g,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ar{constructor(e,s,f){this.text=e,this.icon=s,this.skipFade=f}}class Jn{constructor(e,s,f,g,w){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=w}}class Ag{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:f=>f.collisionGroupID===s}}return this.collisionGroups[e]}}function Gl(x,e,s,f,g){const{horizontalAlign:w,verticalAlign:S}=c.aB(x);return new c.P(-(w-.5)*e+f[0]*g,-(S-.5)*s+f[1]*g)}class ed{constructor(e,s,f,g,w){this.transform=e.clone(),this.terrain=s,this.collisionIndex=new Ji(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Ag(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(f,g)=>s.getElevation(e,f,g):null}getBucketParts(e,s,f,g){const w=f.getBucket(s),S=f.latestFeatureIndex;if(!w||!S||s.id!==w.layerIds[0])return;const D=f.collisionBoxArray,R=w.layers[0].layout,N=w.layers[0].paint,F=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),G=f.tileSize/c.Z,Z=f.tileID.toUnwrapped(),K=R.get("text-rotation-alignment")==="map",te=c.aw(f,1,this.transform.zoom),he=c.ax(this.collisionIndex.transform,f,N.get("text-translate"),N.get("text-translate-anchor")),ue=c.ax(this.collisionIndex.transform,f,N.get("icon-translate"),N.get("icon-translate-anchor")),de=Be(K,this.transform,te);this.retainedQueryData[w.bucketInstanceId]=new Jn(w.bucketInstanceId,S,w.sourceLayerIndex,w.index,f.tileID);const ge={bucket:w,layout:R,translationText:he,translationIcon:ue,unwrappedTileID:Z,pitchedLabelPlaneMatrix:de,scale:F,textPixelRatio:G,holdingForFade:f.holdingForFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:c.ag(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(g)for(const xe of w.sortKeyRanges){const{sortKey:be,symbolInstanceStart:Te,symbolInstanceEnd:De}=xe;e.push({sortKey:be,symbolInstanceStart:Te,symbolInstanceEnd:De,parameters:ge})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:ge})}attemptAnchorPlacement(e,s,f,g,w,S,D,R,N,F,G,Z,K,te,he,ue,de,ge,xe,be){const Te=c.ay[e.textAnchor],De=[e.textOffset0,e.textOffset1],Me=Gl(Te,f,g,De,w),Ge=this.collisionIndex.placeCollisionBox(s,Z,R,N,F,D,S,ue,G.predicate,xe,Me,be);if((!ge||this.collisionIndex.placeCollisionBox(ge,Z,R,N,F,D,S,de,G.predicate,xe,Me,be).placeable)&&Ge.placeable){let Ue;if(this.prevPlacement&&this.prevPlacement.variableOffsets[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID].text&&(Ue=this.prevPlacement.variableOffsets[K.crossTileID].anchor),K.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[K.crossTileID]={textOffset:De,width:f,height:g,anchor:Te,textBoxScale:w,prevAnchor:Ue},this.markUsedJustification(te,Te,K,he),te.allowVerticalPlacement&&(this.markUsedOrientation(te,he,K),this.placedOrientations[K.crossTileID]=he),{shift:Me,placedGlyphBoxes:Ge}}}placeLayerBucketPart(e,s,f){const{bucket:g,layout:w,translationText:S,translationIcon:D,unwrappedTileID:R,pitchedLabelPlaneMatrix:N,textPixelRatio:F,holdingForFade:G,collisionBoxArray:Z,partiallyEvaluatedTextSize:K,collisionGroup:te}=e.parameters,he=w.get("text-optional"),ue=w.get("icon-optional"),de=c.az(w,"text-overlap","text-allow-overlap"),ge=de==="always",xe=c.az(w,"icon-overlap","icon-allow-overlap"),be=xe==="always",Te=w.get("text-rotation-alignment")==="map",De=w.get("text-pitch-alignment")==="map",Me=w.get("icon-text-fit")!=="none",Ge=w.get("symbol-z-order")==="viewport-y",Ue=ge&&(be||!g.hasIconData()||ue),at=be&&(ge||!g.hasTextData()||he);!g.collisionArrays&&Z&&g.deserializeCollisionBoxes(Z);const st=this.retainedQueryData[g.bucketInstanceId].tileID,it=this._getTerrainElevationFunc(st),At=this.transform.getFastPathSimpleProjectionMatrix(st),Et=(ut,Ft,cn)=>{var In,pn;if(s[ut.crossTileID])return;if(G)return void(this.placements[ut.crossTileID]=new ar(!1,!1,!1));let Xn=!1,ai=!1,ui=!0,Yn=null,Wn={box:null,placeable:!1,offscreen:null,occluded:!1},Fi={placeable:!1},lr=null,gr=null,$r=null,Js=0,hs=0,wl=0;Ft.textFeatureIndex?Js=Ft.textFeatureIndex:ut.useRuntimeCollisionCircles&&(Js=ut.featureIndex),Ft.verticalTextFeatureIndex&&(hs=Ft.verticalTextFeatureIndex);const eo=Ft.textBox;if(eo){const fa=Pi=>{let hi=c.ah.horizontal;if(g.allowVerticalPlacement&&!Pi&&this.prevPlacement){const qi=this.prevPlacement.placedOrientations[ut.crossTileID];qi&&(this.placedOrientations[ut.crossTileID]=qi,hi=qi,this.markUsedOrientation(g,hi,ut))}return hi},to=(Pi,hi)=>{if(g.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&Ft.verticalTextBox){for(const qi of g.writingModes)if(qi===c.ah.vertical?(Wn=hi(),Fi=Wn):Wn=Pi(),Wn&&Wn.placeable)break}else Wn=Pi()},mc=ut.textAnchorOffsetStartIndex,gc=ut.textAnchorOffsetEndIndex;if(gc===mc){const Pi=(hi,qi)=>{const qn=this.collisionIndex.placeCollisionBox(hi,de,F,st,R,De,Te,S,te.predicate,it,void 0,At);return qn&&qn.placeable&&(this.markUsedOrientation(g,qi,ut),this.placedOrientations[ut.crossTileID]=qi),qn};to(()=>Pi(eo,c.ah.horizontal),()=>{const hi=Ft.verticalTextBox;return g.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&hi?Pi(hi,c.ah.vertical):{box:null,offscreen:null}}),fa(Wn&&Wn.placeable)}else{let Pi=c.ay[(pn=(In=this.prevPlacement)===null||In===void 0?void 0:In.variableOffsets[ut.crossTileID])===null||pn===void 0?void 0:pn.anchor];const hi=(qn,Fo,Zf)=>{const no=qn.x2-qn.x1,nm=qn.y2-qn.y1,Gf=ut.textBoxScale,$f=Me&&xe==="never"?Fo:null;let ka=null,Ya=de==="never"?1:2,ps="never";Pi&&Ya++;for(let yc=0;yc<Ya;yc++){for(let iu=mc;iu<gc;iu++){const ch=g.textAnchorOffsets.get(iu);if(Pi&&ch.textAnchor!==Pi)continue;const uh=this.attemptAnchorPlacement(ch,qn,no,nm,Gf,Te,De,F,st,R,te,ps,ut,g,Zf,S,D,$f,it);if(uh&&(ka=uh.placedGlyphBoxes,ka&&ka.placeable))return Xn=!0,Yn=uh.shift,ka}Pi?Pi=null:ps=de}return f&&!ka&&(ka={box:this.collisionIndex.placeCollisionBox(eo,"always",F,st,R,De,Te,S,te.predicate,it,void 0,At).box,offscreen:!1,placeable:!1,occluded:!1}),ka};to(()=>hi(eo,Ft.iconBox,c.ah.horizontal),()=>{const qn=Ft.verticalTextBox;return g.allowVerticalPlacement&&(!Wn||!Wn.placeable)&&ut.numVerticalGlyphVertices>0&&qn?hi(qn,Ft.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Wn&&(Xn=Wn.placeable,ui=Wn.offscreen);const qi=fa(Wn&&Wn.placeable);if(!Xn&&this.prevPlacement){const qn=this.prevPlacement.variableOffsets[ut.crossTileID];qn&&(this.variableOffsets[ut.crossTileID]=qn,this.markUsedJustification(g,qn.anchor,ut,qi))}}}if(lr=Wn,Xn=lr&&lr.placeable,ui=lr&&lr.offscreen,ut.useRuntimeCollisionCircles){const fa=g.text.placedSymbolArray.get(ut.centerJustifiedTextSymbolIndex),to=c.ai(g.textSizeData,K,fa),mc=w.get("text-padding");gr=this.collisionIndex.placeCollisionCircles(de,fa,g.lineVertexArray,g.glyphOffsetArray,to,R,N,f,De,te.predicate,ut.collisionCircleDiameter,mc,S,it),gr.circles.length&&gr.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),Xn=ge||gr.circles.length>0&&!gr.collisionDetected,ui=ui&&gr.offscreen}if(Ft.iconFeatureIndex&&(wl=Ft.iconFeatureIndex),Ft.iconBox){const fa=to=>this.collisionIndex.placeCollisionBox(to,xe,F,st,R,De,Te,D,te.predicate,it,Me&&Yn?Yn:void 0,At);Fi&&Fi.placeable&&Ft.verticalIconBox?($r=fa(Ft.verticalIconBox),ai=$r.placeable):($r=fa(Ft.iconBox),ai=$r.placeable),ui=ui&&$r.offscreen}const Tl=he||ut.numHorizontalGlyphVertices===0&&ut.numVerticalGlyphVertices===0,ds=ue||ut.numIconVertices===0;Tl||ds?ds?Tl||(ai=ai&&Xn):Xn=ai&&Xn:ai=Xn=ai&&Xn;const fs=ai&&$r.placeable;if(Xn&&lr.placeable&&this.collisionIndex.insertCollisionBox(lr.box,de,w.get("text-ignore-placement"),g.bucketInstanceId,Fi&&Fi.placeable&&hs?hs:Js,te.ID),fs&&this.collisionIndex.insertCollisionBox($r.box,xe,w.get("icon-ignore-placement"),g.bucketInstanceId,wl,te.ID),gr&&Xn&&this.collisionIndex.insertCollisionCircles(gr.circles,de,w.get("text-ignore-placement"),g.bucketInstanceId,Js,te.ID),f&&this.storeCollisionData(g.bucketInstanceId,cn,Ft,lr,$r,gr),ut.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ut.crossTileID]=new ar((Xn||Ue)&&!(lr!=null&&lr.occluded),(ai||at)&&!($r!=null&&$r.occluded),ui||g.justReloaded),s[ut.crossTileID]=!0};if(Ge){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ut=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ft=ut.length-1;Ft>=0;--Ft){const cn=ut[Ft];Et(g.symbolInstances.get(cn),g.collisionArrays[cn],cn)}}else for(let ut=e.symbolInstanceStart;ut<e.symbolInstanceEnd;ut++)Et(g.symbolInstances.get(ut),g.collisionArrays[ut],ut);g.justReloaded=!1}storeCollisionData(e,s,f,g,w,S){if(f.textBox||f.iconBox){let D,R;this.collisionBoxArrays.has(e)?D=this.collisionBoxArrays.get(e):(D=new Map,this.collisionBoxArrays.set(e,D)),D.has(s)?R=D.get(s):(R={text:null,icon:null},D.set(s,R)),f.textBox&&(R.text=g.box),f.iconBox&&(R.icon=w.box)}if(S){let D=this.collisionCircleArrays[e];D===void 0&&(D=this.collisionCircleArrays[e]=[]);for(let R=0;R<S.circles.length;R+=4)D.push(S.circles[R+0]-$n),D.push(S.circles[R+1]-$n),D.push(S.circles[R+2]),D.push(S.collisionDetected?1:0)}}markUsedJustification(e,s,f,g){let w;w=g===c.ah.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.aA(s)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const D of S)D>=0&&(e.text.placedSymbolArray.get(D).crossTileID=w>=0&&D!==w?0:f.crossTileID)}markUsedOrientation(e,s,f){const g=s===c.ah.horizontal||s===c.ah.horizontalOnly?s:0,w=s===c.ah.vertical?s:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const D of S)e.text.placedSymbolArray.get(D).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let f=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const g=s?s.symbolFadeChange(e):1,w=s?s.opacities:{},S=s?s.variableOffsets:{},D=s?s.placedOrientations:{};for(const R in this.placements){const N=this.placements[R],F=w[R];F?(this.opacities[R]=new To(F,g,N.text,N.icon),f=f||N.text!==F.text.placed||N.icon!==F.icon.placed):(this.opacities[R]=new To(null,g,N.text,N.icon,N.skipFade),f=f||N.text||N.icon)}for(const R in w){const N=w[R];if(!this.opacities[R]){const F=new To(N,g,!1,!1);F.isHidden()||(this.opacities[R]=F,f=f||N.text.placed||N.icon.placed)}}for(const R in S)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=S[R]);for(const R in D)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=D[R]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const f={};for(const g of s){const w=g.getBucket(e);w&&g.latestFeatureIndex&&e.id===w.layerIds[0]&&this.updateBucketOpacities(w,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(e,s,f,g){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const w=e.layers[0],S=w.layout,D=new To(null,0,!1,!1,!0),R=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),F=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),G=S.get("text-rotation-alignment")==="map",Z=S.get("text-pitch-alignment")==="map",K=S.get("icon-text-fit")!=="none",te=new To(null,0,R&&(N||!e.hasIconData()||S.get("icon-optional")),N&&(R||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&g&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(g);const he=(de,ge,xe)=>{for(let be=0;be<ge/4;be++)de.opacityVertexArray.emplaceBack(xe);de.hasVisibleVertices=de.hasVisibleVertices||xe!==Nu},ue=this.collisionBoxArrays.get(e.bucketInstanceId);for(let de=0;de<e.symbolInstances.length;de++){const ge=e.symbolInstances.get(de),{numHorizontalGlyphVertices:xe,numVerticalGlyphVertices:be,crossTileID:Te}=ge;let De=this.opacities[Te];f[Te]?De=D:De||(De=te,this.opacities[Te]=De),f[Te]=!0;const Me=ge.numIconVertices>0,Ge=this.placedOrientations[ge.crossTileID],Ue=Ge===c.ah.vertical,at=Ge===c.ah.horizontal||Ge===c.ah.horizontalOnly;if(xe>0||be>0){const it=nd(De.text);he(e.text,xe,Ue?Nu:it),he(e.text,be,at?Nu:it);const At=De.text.isHidden();[ge.rightJustifiedTextSymbolIndex,ge.centerJustifiedTextSymbolIndex,ge.leftJustifiedTextSymbolIndex].forEach(Ft=>{Ft>=0&&(e.text.placedSymbolArray.get(Ft).hidden=At||Ue?1:0)}),ge.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ge.verticalPlacedTextSymbolIndex).hidden=At||at?1:0);const Et=this.variableOffsets[ge.crossTileID];Et&&this.markUsedJustification(e,Et.anchor,ge,Ge);const ut=this.placedOrientations[ge.crossTileID];ut&&(this.markUsedJustification(e,"left",ge,ut),this.markUsedOrientation(e,ut,ge))}if(Me){const it=nd(De.icon),At=!(K&&ge.verticalPlacedIconSymbolIndex&&Ue);ge.placedIconSymbolIndex>=0&&(he(e.icon,ge.numIconVertices,At?it:Nu),e.icon.placedSymbolArray.get(ge.placedIconSymbolIndex).hidden=De.icon.isHidden()),ge.verticalPlacedIconSymbolIndex>=0&&(he(e.icon,ge.numVerticalIconVertices,At?Nu:it),e.icon.placedSymbolArray.get(ge.verticalPlacedIconSymbolIndex).hidden=De.icon.isHidden())}const st=ue&&ue.has(de)?ue.get(de):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const it=e.collisionArrays[de];if(it){let At=new c.P(0,0);if(it.textBox||it.verticalTextBox){let Et=!0;if(F){const ut=this.variableOffsets[Te];ut?(At=Gl(ut.anchor,ut.width,ut.height,ut.textOffset,ut.textBoxScale),G&&At._rotate(Z?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Et=!1}if(it.textBox||it.verticalTextBox){let ut;it.textBox&&(ut=Ue),it.verticalTextBox&&(ut=at),el(e.textCollisionBox.collisionVertexArray,De.text.placed,!Et||ut,st.text,At.x,At.y)}}if(it.iconBox||it.verticalIconBox){const Et=!!(!at&&it.verticalIconBox);let ut;it.iconBox&&(ut=Et),it.verticalIconBox&&(ut=!Et),el(e.iconCollisionBox.collisionVertexArray,De.icon.placed,ut,st.icon,K?At.x:0,K?At.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const f=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*f>e}setStale(){this.stale=!0}}function el(x,e,s,f,g,w){f&&f.length!==0||(f=[0,0,0,0]);const S=f[0]-$n,D=f[1]-$n,R=f[2]-$n,N=f[3]-$n;x.emplaceBack(e?1:0,s?1:0,g||0,w||0,S,D),x.emplaceBack(e?1:0,s?1:0,g||0,w||0,R,D),x.emplaceBack(e?1:0,s?1:0,g||0,w||0,R,N),x.emplaceBack(e?1:0,s?1:0,g||0,w||0,S,N)}const Eo=Math.pow(2,25),Lu=Math.pow(2,24),Us=Math.pow(2,17),td=Math.pow(2,16),$l=Math.pow(2,9),Yl=Math.pow(2,8),_f=Math.pow(2,1);function nd(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const e=x.placed?1:0,s=Math.floor(127*x.opacity);return s*Eo+e*Lu+s*Us+e*td+s*$l+e*Yl+s*_f+e}const Nu=0;class vf{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,f,g,w){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(S,g,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((D,R)=>D.sortKey-R.sortKey));this._currentPartIndex<S.length;)if(s.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,w())return!0;return!1}}class Ta{constructor(e,s,f,g,w,S,D,R){this.placement=new ed(e,s,S,D,R),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(e,s,f){const g=U.now(),w=()=>!this._forceFullPlacement&&U.now()-g>2;for(;this._currentPlacementIndex>=0;){const S=s[e[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=D)&&(!S.maxzoom||S.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new vf(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const tl=512/c.Z/2;class xf{constructor(e,s,f){this.tileID=e,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let w=0;w<s.length;w++){const S=s.get(w),D=S.key,R=g.get(D);R?R.push(S):g.set(D,[S])}for(const[w,S]of g){const D={positions:S.map(R=>({x:Math.floor(R.anchorX*tl),y:Math.floor(R.anchorY*tl)})),crossTileIDs:S.map(R=>R.crossTileID)};if(D.positions.length>128){const R=new c.aC(D.positions.length,16,Uint16Array);for(const{x:N,y:F}of D.positions)R.add(N,F);R.finish(),delete D.positions,D.index=R}this._symbolsByKey[w]=D}}getScaledCoordinates(e,s){const{x:f,y:g,z:w}=this.tileID.canonical,{x:S,y:D,z:R}=s.canonical,N=tl/Math.pow(2,R-w),F=(D*c.Z+e.anchorY)*N,G=g*c.Z*tl;return{x:Math.floor((S*c.Z+e.anchorX)*N-f*c.Z*tl),y:Math.floor(F-G)}}findMatches(e,s,f){const g=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let w=0;w<e.length;w++){const S=e.get(w);if(S.crossTileID)continue;const D=this._symbolsByKey[S.key];if(!D)continue;const R=this.getScaledCoordinates(S,s);if(D.index){const N=D.index.range(R.x-g,R.y-g,R.x+g,R.y+g).sort();for(const F of N){const G=D.crossTileIDs[F];if(!f[G]){f[G]=!0,S.crossTileID=G;break}}}else if(D.positions)for(let N=0;N<D.positions.length;N++){const F=D.positions[N],G=D.crossTileIDs[N];if(Math.abs(F.x-R.x)<=g&&Math.abs(F.y-R.y)<=g&&!f[G]){f[G]=!0,S.crossTileID=G;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Pu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class id{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const f in this.indexes){const g=this.indexes[f],w={};for(const S in g){const D=g[S];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+s),w[D.tileID.key]=D}this.indexes[f]=w}this.lng=e}addBucket(e,s,f){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let w=0;w<s.symbolInstances.length;w++)s.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const g=this.usedCrossTileIDs[e.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>e.overscaledZ)for(const D in S){const R=S[D];R.tileID.isChildOf(e)&&R.findMatches(s.symbolInstances,e,g)}else{const D=S[e.scaledTo(Number(w)).key];D&&D.findMatches(s.symbolInstances,e,g)}}for(let w=0;w<s.symbolInstances.length;w++){const S=s.symbolInstances.get(w);S.crossTileID||(S.crossTileID=f.generate(),g[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new xf(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const f of s.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[e][g]}removeStaleBuckets(e){let s=!1;for(const f in this.indexes){const g=this.indexes[f];for(const w in g)e[g[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[w]),delete g[w],s=!0)}return s}}class ql{constructor(){this.layerIndexes={},this.crossTileIDs=new Pu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,f){let g=this.layerIndexes[e.id];g===void 0&&(g=this.layerIndexes[e.id]=new id);let w=!1;const S={};g.handleWrapJump(f);for(const D of s){const R=D.getBucket(e);R&&e.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(D.tileID,R,this.crossTileIDs)&&(w=!0),S[R.bucketInstanceId]=!0)}return g.removeStaleBuckets(S)&&(w=!0),w}pruneUnusedLayers(e){const s={};e.forEach(f=>{s[f]=!0});for(const f in this.layerIndexes)s[f]||delete this.layerIndexes[f]}}var Ou="void main() {fragColor=vec4(1.0);}";const $i={prelude:yn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:yn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:yn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:yn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:yn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yn(Ou,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:yn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:yn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:yn(Ou,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:yn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:yn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:yn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:yn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:yn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:yn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:yn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:yn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:yn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:yn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:yn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function yn(x,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=e.match(/in ([\w]+) ([\w]+)/g),g=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(g):g,D={};return{fragmentSource:x=x.replace(s,(R,N,F,G,Z)=>(D[Z]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
in ${F} ${G} ${Z};
#else
uniform ${F} ${G} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${F} ${G} ${Z} = u_${Z};
#endif
`)),vertexSource:e=e.replace(s,(R,N,F,G,Z)=>{const K=G==="float"?"vec2":"vec4",te=Z.match(/color/)?"color":K;return D[Z]?N==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
in ${F} ${K} a_${Z};
out ${F} ${G} ${Z};
#else
uniform ${F} ${G} u_${Z};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${F} ${G} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${te}(a_${Z}, u_${Z}_t);
#else
    ${F} ${G} ${Z} = u_${Z};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
in ${F} ${K} a_${Z};
#else
uniform ${F} ${G} u_${Z};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${F} ${G} ${Z} = a_${Z};
#else
    ${F} ${G} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${F} ${G} ${Z} = unpack_mix_${te}(a_${Z}, u_${Z}_t);
#else
    ${F} ${G} ${Z} = u_${Z};
#endif
`}),staticAttributes:f,staticUniforms:S}}class nl{constructor(e,s,f){this.vertexBuffer=e,this.indexBuffer=s,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Vs=c.aD([{name:"a_pos",type:"Int16",components:2}]);const oa="#define PROJECTION_MERCATOR",Hl="mercator";class kn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Hl}get shaderDefine(){return oa}get shaderPreludeCode(){return $i.projectionMercator}get vertexShaderPreludeCode(){return $i.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aE.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,s,f,g,w){if(this._cachedMesh)return this._cachedMesh;const S=new c.aF;S.emplaceBack(0,0),S.emplaceBack(c.Z,0),S.emplaceBack(0,c.Z),S.emplaceBack(c.Z,c.Z);const D=e.createVertexBuffer(S,Vs.members),R=c.aG.simpleSegment(0,0,4,2),N=new c.aH;N.emplaceBack(1,0,2),N.emplaceBack(1,2,3);const F=e.createIndexBuffer(N);return this._cachedMesh=new nl(D,F,R),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function kr(x,e){const s=c.ae(e.lat,-85.051129,c.aJ);return new c.P(c.U(e.lng)*x,c.S(s)*x)}function ju(x,e){return new c.$(e.x/x,e.y/x).toLngLat()}function Xl(x){return x.cameraToCenterDistance*Math.min(.85*Math.tan(c.ad(90-x.pitch)),Math.tan(c.ad(89.25-x.pitch)))}function Ur(x,e){const s=x.canonical,f=e/c.aI(s.z),g=s.x+Math.pow(2,s.z)*x.wrap,w=c.at(new Float64Array(16));return c.L(w,w,[g*f,s.y*f,0]),c.M(w,w,[f/c.Z,f/c.Z,1]),w}function mr(x,e,s,f,g){const w=c.$.fromLngLat(x,e),S=g*c.aK(1,x.lat),D=S*Math.cos(c.ad(s)),R=Math.sqrt(S*S-D*D),N=R*Math.sin(c.ad(-f)),F=R*Math.cos(c.ad(-f));return new c.$(w.x+N,w.y+F,w.z+D)}class Di{constructor(e=0,s=0,f=0,g=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=f,this.right=g}interpolate(e,s,f){return s.top!=null&&e.top!=null&&(this.top=c.B.number(e.top,s.top,f)),s.bottom!=null&&e.bottom!=null&&(this.bottom=c.B.number(e.bottom,s.bottom,f)),s.left!=null&&e.left!=null&&(this.left=c.B.number(e.left,s.left,f)),s.right!=null&&e.right!=null&&(this.right=c.B.number(e.right,s.right,f)),this}getCenter(e,s){const f=c.ae((this.left+e-this.right)/2,0,e),g=c.ae((this.top+s-this.bottom)/2,0,s);return new c.P(f,g)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Di(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function rd(x,e){if(!x.renderWorldCopies||x.lngRange)return;const s=e.lng-x.center.lng;e.lng+=s>180?-360:s<-180?360:0}function Sr(x){return Math.max(0,Math.floor(x))}class Vr{constructor(e,s,f,g,w,S){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=s||0,this._maxZoom=f||22,this._minPitch=g??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Sr(this._zoom),this._scale=c.aI(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Di,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,s,f){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Sr(this._zoom),this._scale=c.aI(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Di(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!f&&e.autoCalculateNearFarZ,s&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const s=c.aL(e,-180,180)*Math.PI/180;var f,g,w,S,D,R,N,F,G;this._bearingInRadians!==s&&(this._unmodified=!1,this._bearingInRadians=s,this._calcMatrices(),this._rotationMatrix=k(),f=this._rotationMatrix,w=-this._bearingInRadians,S=(g=this._rotationMatrix)[0],D=g[1],R=g[2],N=g[3],F=Math.sin(w),G=Math.cos(w),f[0]=S*G+R*F,f[1]=D*G+N*F,f[2]=S*-F+R*G,f[3]=D*-F+N*G)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const s=c.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==s&&(this._unmodified=!1,this._pitchInRadians=s,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const s=e/180*Math.PI;this._rollInRadians!==s&&(this._unmodified=!1,this._rollInRadians=s,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aM(this._fovInRadians)}setFov(e){e=c.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ad(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const s=this.getConstrained(this._center,e).zoom;this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this._tileZoom=Math.max(0,Math.floor(s)),this._scale=c.aI(s),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,s){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=s,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,f){this._unmodified=!1,this._edgeInsets.interpolate(e,s,f),this._constrain(),this._calcMatrices()}resize(e,s,f=!0){this._width=e,this._height=s,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Zn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.aJ])}getConstrained(e,s){return this._callbacks.getConstrained(e,s)}getCameraQueryGeometry(e,s){if(s.length===1)return[s[0],e];{let f=e.x,g=e.y,w=e.x,S=e.y;for(const D of s)f=Math.min(f,D.x),g=Math.min(g,D.y),w=Math.max(w,D.x),S=Math.max(S,D.y);return[new c.P(f,g),new c.P(w,g),new c.P(w,S),new c.P(f,S),new c.P(f,g)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(s),this.setZoom(f),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.at(new Float64Array(16));c.M(e,e,[this._width/2,-this._height/2,1]),c.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.at(new Float64Array(16)),c.M(e,e,[1,-1,1]),c.L(e,e,[-1,-1,0]),c.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,s,f,g){const w=f!==void 0?f:this.bearing,S=g=g!==void 0?g:this.pitch,D=c.$.fromLngLat(e,s),R=-Math.cos(c.ad(S)),N=Math.sin(c.ad(S)),F=N*Math.sin(c.ad(w)),G=-N*Math.cos(c.ad(w));let Z=this.elevation;const K=s-Z;let te;R*K>=0||Math.abs(R)<.1?(te=1e4,Z=s+te*R):te=-K/R;let he,ue,de=c.aN(1,D.y),ge=0;do{if(ge+=1,ge>10)break;ue=te/de,he=new c.$(D.x+F*ue,D.y+G*ue),de=1/he.meterInMercatorCoordinateUnits()}while(Math.abs(te-ue*de)>1e-12);return{center:he.toLngLat(),elevation:Z,zoom:c.ab(this.height/2/Math.tan(this.fovInRadians/2)/ue/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const s=c.aK(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/s,g=c.$.fromLngLat(this.center,this.elevation),w=mr(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=e;const S=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),c.aN(w.z,g.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aK(1,this.center.lat)*this.worldSize;return mr(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const s=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/s,e.canonical.y/s,1/s/c.Z,1/s/c.Z]}}class er{constructor(e,s){this.min=e,this.max=s,this.center=c.aO([],c.aP([],this.min,this.max),.5)}quadrant(e){const s=[e%2==0,e<2],f=c.aQ(this.min),g=c.aQ(this.max);for(let w=0;w<s.length;w++)f[w]=s[w]?this.min[w]:this.center[w],g[w]=s[w]?this.center[w]:this.max[w];return g[2]=this.max[2],new er(f,g)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let s=!0;for(let f=0;f<e.planes.length;f++){const g=this.intersectsPlane(e.planes[f]);if(g===0)return 0;g===1&&(s=!1)}return s?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let s=e[3],f=e[3];for(let g=0;g<3;g++)e[g]>0?(s+=e[g]*this.min[g],f+=e[g]*this.max[g]):(f+=e[g]*this.min[g],s+=e[g]*this.max[g]);return s>=0?2:f<0?0:1}}class Wl{distanceToTile2d(e,s,f,g){const w=g.distanceX([e,s]),S=g.distanceY([e,s]);return Math.hypot(w,S)}getWrap(e,s,f){return f}getTileAABB(e,s,f,g){var w,S;let D=f,R=f;if(g.terrain){const F=new c.Y(e.z,s,e.z,e.x,e.y),G=g.terrain.getMinMaxElevation(F);D=(w=G.minElevation)!==null&&w!==void 0?w:f,R=(S=G.maxElevation)!==null&&S!==void 0?S:f}const N=1<<e.z;return new er([s+e.x/N,e.y/N,D],[s+(e.x+1)/N,(e.y+1)/N,R])}allowVariableZoom(e,s){const f=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,g=c.ae(78.5-f/2,0,60);return!!s.terrain||e.pitch>g}allowWorldCopies(){return!0}recalculateCache(){}}class Ea{constructor(e,s,f){this.points=e,this.planes=s,this.aabb=f}static fromInvProjectionMatrix(e,s=1,f=0){const g=Math.pow(2,f),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const F=1/(N=c.ap([],N,e))[3]/s*g;return c.aR(N,N,[F,F,1/N[3],F])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const F=c.aS([],w[N[0]],w[N[1]]),G=c.aS([],w[N[2]],w[N[1]]),Z=c.aT([],c.aU([],F,G)),K=-c.aV(Z,w[N[1]]);return Z.concat(K)}),D=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],R=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const N of w)for(let F=0;F<3;F++)D[F]=Math.min(D[F],N[F]),R[F]=Math.max(R[F],N[F]);return new Ea(w,S,new er(D,R))}}class _i{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,f){return this._helper.interpolatePadding(e,s,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s,f=!0){this._helper.resize(e,s,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,s){}constructor(e,s,f,g,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Vr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,D)=>this.getConstrained(S,D)},e,s,f,g,w),this._coveringTilesDetailsProvider=new Wl}clone(){const e=new _i;return e.apply(this),e}apply(e,s,f){this._helper.apply(e,s,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const s=[new c.aW(0,e)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new c.P(0,0)),g=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),D=Math.floor(Math.min(f.x,g.x,w.x,S.x)),R=Math.floor(Math.max(f.x,g.x,w.x,S.x)),N=1;for(let F=D-N;F<=R+N;F++)F!==0&&s.push(new c.aW(F,e))}return s}getCameraFrustum(){return Ea.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const s=this.screenPointToLocation(this.centerPoint,e),f=e?e.getElevationForLngLatZoom(s,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(e,s){const f=c.aK(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(s,f),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),S=c.$.fromLngLat(e),D=new c.$(S.x-(g.x-w.x),S.y-(g.y-w.y));this.setCenter(D==null?void 0:D.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,s){return s?this.coordinatePoint(c.$.fromLngLat(e),s.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.$.fromLngLat(e))}screenPointToLocation(e,s){var f;return(f=this.screenPointToMercatorCoordinate(e,s))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(e,s){if(s){const f=s.pointCoordinate(e);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,s){const f=s||0,g=[e.x,e.y,0,1],w=[e.x,e.y,1,1];c.ap(g,g,this._pixelMatrixInverse),c.ap(w,w,this._pixelMatrixInverse);const S=g[3],D=w[3],R=g[1]/S,N=w[1]/D,F=g[2]/S,G=w[2]/D,Z=F===G?0:(f-F)/(G-F);return new c.$(c.B.number(g[0]/S,w[0]/D,Z)/this.worldSize,c.B.number(R,N,Z)/this.worldSize,f)}coordinatePoint(e,s=0,f=this._pixelMatrix){const g=[e.x*this.worldSize,e.y*this.worldSize,s,1];return c.ap(g,g,f),new c.P(g[0]/g[3],g[1]/g[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Xl(this));return new Zn().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,s){return s?s.pointCoordinate(e)!=null:e.y>this.height/2-Xl(this)}calculatePosMatrix(e,s=!1,f){var g;const w=(g=e.key)!==null&&g!==void 0?g:c.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),S=s?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(w)){const N=S.get(w);return f?N.f32:N.f64}const D=Ur(e,this.worldSize);c.N(D,s?this._alignedProjMatrix:this._viewProjMatrix,D);const R={f64:D,f32:new Float32Array(D)};return S.set(w,R),f?R.f32:R.f64}calculateFogMatrix(e){const s=e.key,f=this._fogMatrixCacheF32;if(f.has(s))return f.get(s);const g=Ur(e,this.worldSize);return c.N(g,this._fogMatrix,g),f.set(s,new Float32Array(g)),f.get(s)}getConstrained(e,s){s=c.ae(+s,this.minZoom,this.maxZoom);const f={center:new c.Q(e.lng,e.lat),zoom:s};let g=this._helper._lngRange;this._helper._renderWorldCopies||g!==null||(g=[-179.9999999999,180-1e-10]);const w=this.tileSize*c.aI(f.zoom);let S=0,D=w,R=0,N=w,F=0,G=0;const{x:Z,y:K}=this.size;if(this._helper._latRange){const xe=this._helper._latRange;S=c.S(xe[1])*w,D=c.S(xe[0])*w,D-S<K&&(F=K/(D-S))}g&&(R=c.aL(c.U(g[0])*w,0,w),N=c.aL(c.U(g[1])*w,0,w),N<R&&(N+=w),N-R<Z&&(G=Z/(N-R)));const{x:te,y:he}=kr(w,e);let ue,de;const ge=Math.max(G||0,F||0);if(ge){const xe=new c.P(G?(N+R)/2:te,F?(D+S)/2:he);return f.center=ju(w,xe).wrap(),f.zoom+=c.ab(ge),f}if(this._helper._latRange){const xe=K/2;he-xe<S&&(de=S+xe),he+xe>D&&(de=D-xe)}if(g){const xe=(R+N)/2;let be=te;this._helper._renderWorldCopies&&(be=c.aL(te,xe-w/2,xe+w/2));const Te=Z/2;be-Te<R&&(ue=R+Te),be+Te>N&&(ue=N-Te)}if(ue!==void 0||de!==void 0){const xe=new c.P(ue??te,de??he);f.center=ju(w,xe).wrap()}return f}calculateCenterFromCameraLngLatAlt(e,s,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,f,g)}_calculateNearFarZIfNeeded(e,s,f){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=e-g*this._helper._pixelPerMeter/Math.cos(s),S=g<0?w:e,D=Math.PI/2+this.pitchInRadians,R=c.ad(this.fov)*(Math.abs(Math.cos(c.ad(this.roll)))*this.height+Math.abs(Math.sin(c.ad(this.roll)))*this.width)/this.height*(.5+f.y/this.height),N=Math.sin(R)*S/Math.sin(c.ae(Math.PI-D-R,.01,Math.PI-.01)),F=Xl(this),G=Math.atan(F/this._helper.cameraToCenterDistance),Z=c.ad(.75),K=G>Z?2*G*(.5+f.y/(2*F)):Z,te=Math.sin(K)*S/Math.sin(c.ae(Math.PI-D-K,.01,Math.PI-.01)),he=Math.min(N,te);this._helper._farZ=1.01*(Math.cos(Math.PI/2-s)*he+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,s=kr(this.worldSize,this.center),f=s.x,g=s.y;this._helper._pixelPerMeter=c.aK(1,this.center.lat)*this.worldSize;const w=c.ad(Math.min(this.pitch,89.25)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let D;this._calculateNearFarZIfNeeded(S,w,e),D=new Float64Array(16),c.aY(D,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aj(this._invProjMatrix,D),D[8]=2*-e.x/this._helper._width,D[9]=2*e.y/this._helper._height,this._projectionMatrix=c.aZ(D),c.M(D,D,[1,-1,1]),c.L(D,D,[0,0,-this._helper.cameraToCenterDistance]),c.a_(D,D,-this.rollInRadians),c.a$(D,D,this.pitchInRadians),c.a_(D,D,-this.bearingInRadians),c.L(D,D,[-f,-g,0]),this._mercatorMatrix=c.M([],D,[this.worldSize,this.worldSize,this.worldSize]),c.M(D,D,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,D),c.L(D,D,[0,0,-this.elevation]),this._viewProjMatrix=D,this._invViewProjMatrix=c.aj([],D);const R=[0,0,-1,1];c.ap(R,R,this._invViewProjMatrix),this._cameraPosition=[R[0]/R[3],R[1]/R[3],R[2]/R[3]],this._fogMatrix=new Float64Array(16),c.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.L(this._fogMatrix,this._fogMatrix,[-f,-g,0]),c.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,D);const N=this._helper._width%2/2,F=this._helper._height%2/2,G=Math.cos(this.bearingInRadians),Z=Math.sin(-this.bearingInRadians),K=f-Math.round(f)+G*N+Z*F,te=g-Math.round(g)+G*F+Z*N,he=new Float64Array(D);if(c.L(he,he,[K>.5?K-1:K,te>.5?te-1:te,0]),this._alignedProjMatrix=he,D=c.aj(new Float64Array(16),this._pixelMatrix),!D)throw new Error("failed to invert matrix");this._pixelMatrixInverse=D,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.ap(s,s,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aK(1,this.center.lat)*this.worldSize;return mr(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,s){const f=c.$.fromLngLat(e),g=[f.x*this.worldSize,f.y*this.worldSize,s,1];return c.ap(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(e){const{overscaledTileID:s,aligned:f,applyTerrainMatrix:g}=e,w=this._helper.getMercatorTileCoordinates(s),S=s?this.calculatePosMatrix(s,f,!0):null;let D;return D=s&&s.terrainRttPosMatrix32f&&g?s.terrainRttPosMatrix32f:S||c.b0(),{mainMatrix:D,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:D}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,s,f){return 1}transformLightDirection(e){return c.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,s,f,g){const w=this.calculatePosMatrix(f);let S;g?(S=[e,s,g(e,s),1],c.ap(S,S,w)):(S=[e,s,0,1],Bi(S,S,w));const D=S[3];return{point:new c.P(S[0]/D,S[1]/D),signedDistanceFromCamera:D,isOccluded:!1}}populateCache(e){for(const s of e)this.calculatePosMatrix(s)}getMatrixForModel(e,s){const f=c.$.fromLngLat(e,s),g=f.meterInMercatorCoordinateUnits(),w=c.b1();return c.L(w,w,[f.x,f.y,f.z]),c.a_(w,w,Math.PI),c.a$(w,w,Math.PI/2),c.M(w,w,[-g,g,g]),w}getProjectionDataForCustomLayer(e=!0){const s=new c.Y(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:s,applyGlobeMatrix:e}),g=Ur(s,this.worldSize);c.N(g,this._viewProjMatrix,g),f.tileMercatorCoords=[0,0,1,1];const w=[c.Z,c.Z,this.worldSize/this._helper.pixelsPerMeter],S=c.b2();return c.M(S,g,w),f.fallbackMatrix=S,f.mainMatrix=S,f}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function il(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function So(x){if(x.useSlerp)if(x.k<1){const e=c.b3(x.startEulerAngles.roll,x.startEulerAngles.pitch,x.startEulerAngles.bearing),s=c.b3(x.endEulerAngles.roll,x.endEulerAngles.pitch,x.endEulerAngles.bearing),f=new Float64Array(4);c.b4(f,e,s,x.k);const g=c.b5(f);x.tr.setRoll(g.roll),x.tr.setPitch(g.pitch),x.tr.setBearing(g.bearing)}else x.tr.setRoll(x.endEulerAngles.roll),x.tr.setPitch(x.endEulerAngles.pitch),x.tr.setBearing(x.endEulerAngles.bearing);else x.tr.setRoll(c.B.number(x.startEulerAngles.roll,x.endEulerAngles.roll,x.k)),x.tr.setPitch(c.B.number(x.startEulerAngles.pitch,x.endEulerAngles.pitch,x.k)),x.tr.setBearing(c.B.number(x.startEulerAngles.bearing,x.endEulerAngles.bearing,x.k))}function Ao(x,e,s,f,g){const w=g.padding,S=kr(g.worldSize,s.getNorthWest()),D=kr(g.worldSize,s.getNorthEast()),R=kr(g.worldSize,s.getSouthEast()),N=kr(g.worldSize,s.getSouthWest()),F=c.ad(-f),G=S.rotate(F),Z=D.rotate(F),K=R.rotate(F),te=N.rotate(F),he=new c.P(Math.max(G.x,Z.x,te.x,K.x),Math.max(G.y,Z.y,te.y,K.y)),ue=new c.P(Math.min(G.x,Z.x,te.x,K.x),Math.min(G.y,Z.y,te.y,K.y)),de=he.sub(ue),ge=(g.width-(w.left+w.right+e.left+e.right))/de.x,xe=(g.height-(w.top+w.bottom+e.top+e.bottom))/de.y;if(xe<0||ge<0)return void il();const be=Math.min(c.ab(g.scale*Math.min(ge,xe)),x.maxZoom),Te=c.P.convert(x.offset),De=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ad(f)),Me=Te.add(De).mult(g.scale/c.aI(be));return{center:ju(g.worldSize,S.add(R).div(2).sub(Me)),zoom:be,bearing:f}}class Yi{get useGlobeControls(){return!1}handlePanInertia(e,s){return{easingOffset:e,easingCenter:s.center}}handleMapControlsRollPitchBearingZoom(e,s){e.bearingDelta&&s.setBearing(s.bearing+e.bearingDelta),e.pitchDelta&&s.setPitch(s.pitch+e.pitchDelta),e.rollDelta&&s.setRoll(s.roll+e.rollDelta),e.zoomDelta&&s.setZoom(s.zoom+e.zoomDelta)}handleMapControlsPan(e,s,f){e.around.distSqr(s.centerPoint)<.01||s.setLocationAtPoint(f,e.around)}cameraForBoxAndBearing(e,s,f,g,w){return Ao(e,s,f,g,w)}handleJumpToCenterZoom(e,s){e.zoom!==(s.zoom!==void 0?+s.zoom:e.zoom)&&e.setZoom(+s.zoom),s.center!==void 0&&e.setCenter(c.Q.convert(s.center))}handleEaseTo(e,s){const f=e.zoom,g=e.padding,w={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:s.roll===void 0?e.roll:s.roll,pitch:s.pitch===void 0?e.pitch:s.pitch,bearing:s.bearing===void 0?e.bearing:s.bearing},D=s.zoom!==void 0,R=!e.isPaddingEqual(s.padding);let N=!1;const F=D?+s.zoom:e.zoom;let G=e.centerPoint.add(s.offsetAsPoint);const Z=e.screenPointToLocation(G),{center:K,zoom:te}=e.getConstrained(c.Q.convert(s.center||Z),F??f);rd(e,K);const he=kr(e.worldSize,Z),ue=kr(e.worldSize,K).sub(he),de=c.aI(te-f);return N=te!==f,{easeFunc:ge=>{if(N&&e.setZoom(c.B.number(f,te,ge)),c.b6(w,S)||So({startEulerAngles:w,endEulerAngles:S,tr:e,k:ge,useSlerp:w.roll!=S.roll}),R&&(e.interpolatePadding(g,s.padding,ge),G=e.centerPoint.add(s.offsetAsPoint)),s.around)e.setLocationAtPoint(s.around,s.aroundPoint);else{const xe=c.aI(e.zoom-f),be=te>f?Math.min(2,de):Math.max(.5,de),Te=Math.pow(be,1-ge),De=ju(e.worldSize,he.add(ue.mult(ge*Te)).mult(xe));e.setLocationAtPoint(e.renderWorldCopies?De.wrap():De,G)}},isZooming:N,elevationCenter:K}}handleFlyTo(e,s){const f=s.zoom!==void 0,g=e.zoom,w=e.getConstrained(c.Q.convert(s.center||s.locationAtOffset),f?+s.zoom:g),S=w.center,D=w.zoom;rd(e,S);const R=kr(e.worldSize,s.locationAtOffset),N=kr(e.worldSize,S).sub(R),F=N.mag(),G=c.aI(D-g);let Z;if(s.minZoom!==void 0){const K=Math.min(+s.minZoom,g,D),te=e.getConstrained(S,K).zoom;Z=c.aI(te-g)}return{easeFunc:(K,te,he,ue)=>{e.setZoom(K===1?D:g+c.ab(te));const de=K===1?S:ju(e.worldSize,R.add(N.mult(he)).mult(te));e.setLocationAtPoint(e.renderWorldCopies?de.wrap():de,ue)},scaleOfZoom:G,targetCenter:S,scaleOfMinZoom:Z,pixelPathLength:F}}}class ii{constructor(e,s,f){this.blendFunction=e,this.blendColor=s,this.mask=f}}ii.Replace=[1,0],ii.disabled=new ii(ii.Replace,c.b7.transparent,[!1,!1,!1,!1]),ii.unblended=new ii(ii.Replace,c.b7.transparent,[!0,!0,!0,!0]),ii.alphaBlended=new ii([1,771],c.b7.transparent,[!0,!0,!0,!0]);const la=2305;class xn{constructor(e,s,f){this.enable=e,this.mode=s,this.frontFace=f}}xn.disabled=new xn(!1,1029,la),xn.backCCW=new xn(!0,1029,la),xn.frontCCW=new xn(!0,1028,la);class fn{constructor(e,s,f){this.func=e,this.mask=s,this.range=f}}fn.ReadOnly=!1,fn.ReadWrite=!0,fn.disabled=new fn(519,fn.ReadOnly,[0,1]);const Mo=7680;class Dn{constructor(e,s,f,g,w,S){this.test=e,this.ref=s,this.mask=f,this.fail=g,this.depthFail=w,this.pass=S}}Dn.disabled=new Dn({func:519,mask:0},0,0,Mo,Mo,Mo);const Co=new WeakMap;function ca(x){var e;if(Co.has(x))return Co.get(x);{const s=(e=x.getParameter(x.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Co.set(x,s),s}}class Uc{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const s=e.context,f=s.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const g=new c.aF;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const w=new c.aH;w.emplaceBack(0,1,2),this._fullscreenTriangle=new nl(s.createVertexBuffer(g,Vs.members),s.createIndexBuffer(w),c.aG.simpleSegment(0,0,g.length,w.length)),this._resultBuffer=new Uint8Array(4),s.activeTexture.set(f.TEXTURE1);const S=f.createTexture();f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=s.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),ca(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,s){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,s),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,s=e.gl;e.activeTexture.set(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,s){const f=this._cachedRenderContext.context,g=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:c.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,g.TRIANGLES,fn.disabled,Dn.disabled,ii.unblended,xn.disabled,((w,S)=>({u_input:w,u_output_expected:S}))(e,s),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ca(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const w=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ca(e)){const s=e.clientWaitSync(this._readbackQueue.sync,0,0);if(s===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(s===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Uc._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let s=0;return s+=e[0]/256,s+=e[1]/65536,s+=e[2]/16777216,e[3]<127&&(s=-s),s/128}}const Ar=c.Z/128;function Zs(x,e){const s=x.granularity!==void 0?Math.max(x.granularity,1):1,f=s+(x.generateBorders?2:0),g=s+(x.extendToNorthPole||x.generateBorders?1:0)+(x.extendToSouthPole||x.generateBorders?1:0),w=f+1,S=g+1,D=x.generateBorders?-1:0,R=x.generateBorders||x.extendToNorthPole?-1:0,N=s+(x.generateBorders?1:0),F=s+(x.generateBorders||x.extendToSouthPole?1:0),G=w*S,Z=f*g*6,K=w*S>65536;if(K&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const te=K||e==="32bit",he=new Int16Array(2*G);let ue=0;for(let xe=R;xe<=F;xe++)for(let be=D;be<=N;be++){let Te=be/s*c.Z;be===-1&&(Te=-64),be===s+1&&(Te=c.Z+Ar);let De=xe/s*c.Z;xe===-1&&(De=x.extendToNorthPole?c.b9:-64),xe===s+1&&(De=x.extendToSouthPole?c.ba:c.Z+Ar),he[ue++]=Te,he[ue++]=De}const de=te?new Uint32Array(Z):new Uint16Array(Z);let ge=0;for(let xe=0;xe<g;xe++)for(let be=0;be<f;be++){const Te=be+1+xe*w,De=be+(xe+1)*w,Me=be+1+(xe+1)*w;de[ge++]=be+xe*w,de[ge++]=De,de[ge++]=Te,de[ge++]=Te,de[ge++]=De,de[ge++]=Me}return{vertices:he.buffer.slice(0),indices:de.buffer.slice(0),uses32bitIndices:te}}const rl=new c.aE({fill:new c.bb(128,2),line:new c.bb(512,0),tile:new c.bb(128,32),stencil:new c.bb(128,1),circle:3});class Do{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return $i.projectionGlobe}get vertexShaderPreludeCode(){return $i.projectionMercator.vertexSource}get subdivisionGranularity(){return rl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Uc(e));const s=c.S(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(s,f),w=U.now();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=w);const S=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bd(S))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,s,f,g,w){const S=(w==="stencil"?rl.stencil:rl.tile).getGranularityForZoomLevel(s.z);return this._getMesh(e,{granularity:S,generateBorders:f,extendToNorthPole:s.y===0&&g,extendToSouthPole:s.y===(1<<s.z)-1&&g})}_getMesh(e,s){const f=this._getMeshKey(s);if(f in this._tileMeshCache)return this._tileMeshCache[f];const g=function(w,S){const D=Zs(S,"16bit"),R=c.aF.deserialize({arrayBuffer:D.vertices,length:D.vertices.byteLength/2/2}),N=c.aH.deserialize({arrayBuffer:D.indices,length:D.indices.byteLength/2/3});return new nl(w.createVertexBuffer(R,Vs.members),w.createIndexBuffer(N),c.aG.simpleSegment(0,0,R.length,N.length))}(e,s);return this._tileMeshCache[f]=g,g}recalculate(e){}hasTransition(){const e=U.now();let s=!1;return s=s||(e-this._errorMeasurementLastChangeTime)/1e3<.7,s=s||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,s}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const ad=new c.r({type:new c.D(c.v.projection.type)});class al extends c.E{constructor(e){super(),this._transitionable=new c.T(ad),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0)),this._mercatorProjection=new kn,this._verticalPerspectiveProjection=new Do}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,s,f,g,w){return this.currentProjection.getMeshFromTileID(e,s,f,g,w)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function sd(x){const e=Bu(x.worldSize,x.center.lat);return 2*Math.PI*e}function rs(x,e,s,f,g){const w=1/(1<<g),S=e/c.Z*w+f*w,D=c.bg((x/c.Z*w+s*w)*Math.PI*2+Math.PI,2*Math.PI),R=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,N=Math.cos(R),F=new Float64Array(3);return F[0]=Math.sin(D)*N,F[1]=Math.sin(R),F[2]=Math.cos(D)*N,F}function sr(x){return function(e,s){const f=Math.cos(s),g=new Float64Array(3);return g[0]=Math.sin(e)*f,g[1]=Math.sin(s),g[2]=Math.cos(e)*f,g}(x.lng*Math.PI/180,x.lat*Math.PI/180)}function Bu(x,e){return x/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Up(x){const e=Math.asin(x[1])/Math.PI*180,s=Math.sqrt(x[0]*x[0]+x[2]*x[2]);if(s>1e-6){const f=x[0]/s,g=Math.acos(x[2]/s),w=(f>0?g:-g)/Math.PI*180;return new c.Q(c.aL(w,-180,180),e)}return new c.Q(0,e)}function Zr(x){return Math.cos(x*Math.PI/180)}function or(x,e){const s=Zr(x),f=Zr(e);return c.ab(f/s)}function Sa(x,e){const s=x.rotate(e.bearingInRadians),f=e.zoom+or(e.center.lat,0),g=c.bc(1/Zr(e.center.lat),1/Zr(Math.min(Math.abs(e.center.lat),60)),c.bf(f,7,3,0,1)),w=360/sd({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.Q(e.center.lng-s.x*w*g,c.ae(e.center.lat+s.y*w,-85.051129,c.aJ))}function Vc(x){const e=.5*x,s=Math.sin(e),f=Math.cos(e);return Math.log(s+f)-Math.log(f-s)}function bf(x,e,s,f){const g=x.lat+s*f;if(Math.abs(s)>1){const w=(Math.sign(x.lat+s)!==Math.sign(x.lat)?-Math.abs(x.lat):Math.abs(x.lat))*Math.PI/180,S=Math.abs(x.lat+s)*Math.PI/180,D=Vc(w+f*(S-w)),R=Vc(w),N=Vc(S);return new c.Q(x.lng+e*((D-R)/(N-R)),g)}return new c.Q(x.lng+e*f,g)}class Vp{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,s,f,g){const w=`${e.z}_${e.x}_${e.y}`,S=this._cache.get(w);if(S)return S;const D=this._cachePrevious.get(w);if(D)return this._cache.set(w,D),D;const R=this._aabbFactory(e,s,f,g);return this._cache.set(w,R),this._hadAnyChanges=!0,R}}function ko(x,e,s){const f=x-e;return f<0?-f:Math.max(0,f-s)}function wf(x,e,s,f,g){const w=x-s;let S;return S=w<0?Math.min(-w,1+w-g):w>1?Math.min(Math.max(w-g,0),1-w):0,Math.max(S,ko(e,f,g))}class Zp{constructor(){this._aabbCache=new Vp(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,s,f,g){const w=1<<f.z,S=1/w,D=f.x/w,R=f.y/w;let N=2;return N=Math.min(N,wf(e,s,D,R,S)),N=Math.min(N,wf(e,s,D+.5,-R-S,S)),N=Math.min(N,wf(e,s,D+.5,2-R-S,S)),N}getWrap(e,s,f){const g=1<<s.z,w=1/g,S=s.x/g,D=ko(e.x,S,w),R=ko(e.x,S-1,w),N=ko(e.x,S+1,w),F=Math.min(D,R,N);return F===N?1:F===R?-1:0}allowVariableZoom(e,s){return ja(e,s)>4}allowWorldCopies(){return!1}getTileAABB(e,s,f,g){return this._aabbCache.getTileAABB(e,s,f,g)}_computeTileAABB(e,s,f,g){if(e.z<=0)return new er([-1,-1,-1],[1,1,1]);if(e.z===1)return new er([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const w=[rs(0,0,e.x,e.y,e.z),rs(c.Z,0,e.x,e.y,e.z),rs(c.Z,c.Z,e.x,e.y,e.z),rs(0,c.Z,e.x,e.y,e.z)],S=[1,1,1],D=[-1,-1,-1];for(const R of w)for(let N=0;N<3;N++)S[N]=Math.min(S[N],R[N]),D[N]=Math.max(D[N],R[N]);if(e.y===0||e.y===(1<<e.z)-1){const R=[0,e.y===0?1:-1,0];for(let N=0;N<3;N++)S[N]=Math.min(S[N],R[N]),D[N]=Math.max(D[N],R[N])}return new er(S,D)}}}class od{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,f){return this._helper.interpolatePadding(e,s,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s){this._helper.resize(e,s)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bh(),this._projectionMatrix=c.b1(),this._globeViewProjMatrix32f=c.b0(),this._globeViewProjMatrixNoCorrection=c.b1(),this._globeViewProjMatrixNoCorrectionInverted=c.b1(),this._globeProjMatrixInverted=c.b1(),this._cameraPosition=c.bi(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Vr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,s)=>this.getConstrained(e,s)}),this._coveringTilesDetailsProvider=new Zp}clone(){const e=new od;return e.apply(this),e}apply(e,s){this._globeLatitudeErrorCorrectionRadians=s||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bi();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:s,applyGlobeMatrix:f}=e,g=this._helper.getMercatorTileCoordinates(s);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const s=this.pitchInRadians,f=this.cameraToCenterDistance/e,g=Math.sin(s)*f,w=Math.cos(s)*f+1,S=1/Math.sqrt(g*g+w*w)*1;let D=-g,R=w;const N=Math.sqrt(D*D+R*R);D/=N,R/=N;const F=[0,D,R];return c.bj(F,F,[0,0,0],-this.bearingInRadians),c.bk(F,F,[0,0,0],-1*this.center.lat*Math.PI/180),c.bl(F,F,[0,0,0],this.center.lng*Math.PI/180),c.aO(F,F,.25),[...F,.25*-S]}isLocationOccluded(e){return!this.isSurfacePointVisible(sr(e))}transformLightDirection(e){const s=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,g=Math.cos(f),w=[Math.sin(s)*g,Math.sin(f),Math.cos(s)*g],S=[w[2],0,-w[0]],D=[0,0,0];c.aU(D,S,w),c.aT(S,S),c.aT(D,D);const R=[0,0,0];return c.aT(R,[S[0]*e[0]+D[0]*e[1]+w[0]*e[2],S[1]*e[0]+D[1]*e[1]+w[1]*e[2],S[2]*e[0]+D[2]*e[1]+w[2]*e[2]]),R}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,s,f){const g=function(D,R,N){const F=1/(1<<N.z);return new c.$(D/c.Z*F+N.x*F,R/c.Z*F+N.y*F)}(e,s,f.canonical),w=(S=g.y,[c.bg(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(e,s,f,g){const w=f.canonical,S=rs(e,s,w.x,w.y,w.z),D=1+(g?g(e,s):0)/c.br,R=[S[0]*D,S[1]*D,S[2]*D,1];c.ap(R,R,this._globeViewProjMatrixNoCorrection);const N=this._cachedClippingPlane,F=N[0]*S[0]+N[1]*S[1]+N[2]*S[2]+N[3]<0;return{point:new c.P(R[0]/R[3],R[1]/R[3]),signedDistanceFromCamera:R[3],isOccluded:F}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Bu(this.worldSize,this.center.lat),s=c.b2(),f=c.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.aY(s,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;s[8]=2*-g.x/this._helper._width,s[9]=2*g.y/this._helper._height,this._projectionMatrix=c.aZ(s),this._globeProjMatrixInverted=c.b2(),c.aj(this._globeProjMatrixInverted,s),c.L(s,s,[0,0,-this.cameraToCenterDistance]),c.a_(s,s,this.rollInRadians),c.a$(s,s,-this.pitchInRadians),c.a_(s,s,this.bearingInRadians),c.L(s,s,[0,0,-e]);const w=c.bi();w[0]=e,w[1]=e,w[2]=e,c.a$(f,s,this.center.lat*Math.PI/180),c.bm(f,f,-this.center.lng*Math.PI/180),c.M(f,f,w),this._globeViewProjMatrixNoCorrection=f,c.a$(s,s,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bm(s,s,-this.center.lng*Math.PI/180),c.M(s,s,w),this._globeViewProjMatrix32f=new Float32Array(s),this._globeViewProjMatrixNoCorrectionInverted=c.b2(),c.aj(this._globeViewProjMatrixNoCorrectionInverted,f);const S=c.bi();this._cameraPosition=c.bi(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bj(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),c.bk(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),c.bj(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),c.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bk(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),c.bl(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const D=c.aZ(this._globeViewProjMatrixNoCorrectionInverted);c.M(D,D,[1,1,-1]),this._cachedFrustum=Ea.fromInvProjectionMatrix(D)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const s=c.b2();return c.at(s),s}getVisibleUnwrappedCoordinates(e){return[new c.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,s){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=sr(e);c.aO(f,f,1+s/c.br);const g=c.bh();return c.ap(g,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(e){}getBounds(){const e=.5*this.width,s=.5*this.height,f=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,s),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,s)],g=[];for(const G of f)g.push(this.unprojectScreenPoint(G));let w=0,S=0,D=0,R=0;const N=this.center;for(const G of g){const Z=c.bn(N.lng,G.lng),K=c.bn(N.lat,G.lat);Z<S&&(S=Z),Z>w&&(w=Z),K<R&&(R=K),K>D&&(D=K)}const F=[N.lng+S,N.lat+R,N.lng+w,N.lat+D];return this.isSurfacePointOnScreen([0,1,0])&&(F[3]=90,F[0]=-180,F[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(F[1]=-90,F[0]=-180,F[2]=180),new Zn(F)}getConstrained(e,s){const f=c.ae(e.lat,-85.051129,c.aJ),g=c.ae(+s,this.minZoom+or(0,f),this.maxZoom);return{center:new c.Q(e.lng,f),zoom:g}}calculateCenterFromCameraLngLatAlt(e,s,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,f,g)}setLocationAtPoint(e,s){const f=sr(this.unprojectScreenPoint(s)),g=sr(e),w=c.bi();c.bo(w);const S=c.bi();c.bl(S,f,w,-this.center.lng*Math.PI/180),c.bk(S,S,w,this.center.lat*Math.PI/180);const D=g[0]*g[0]+g[2]*g[2],R=S[0]*S[0];if(D<R)return;const N=Math.sqrt(D-R),F=-N,G=c.bp(g[0],g[2],S[0],N),Z=c.bp(g[0],g[2],S[0],F),K=c.bi();c.bl(K,g,w,-G);const te=c.bp(K[1],K[2],S[1],S[2]),he=c.bi();c.bl(he,g,w,-Z);const ue=c.bp(he[1],he[2],S[1],S[2]),de=.5*Math.PI,ge=te>=-de&&te<=de,xe=ue>=-de&&ue<=de;let be,Te;if(ge&&xe){const Ue=this.center.lng*Math.PI/180,at=this.center.lat*Math.PI/180;c.bs(G,Ue)+c.bs(te,at)<c.bs(Z,Ue)+c.bs(ue,at)?(be=G,Te=te):(be=Z,Te=ue)}else if(ge)be=G,Te=te;else{if(!xe)return;be=Z,Te=ue}const De=be/Math.PI*180,Me=Te/Math.PI*180,Ge=this.center.lat;this.setCenter(new c.Q(De,c.ae(Me,-90,90))),this.setZoom(this.zoom+or(Ge,this.center.lat))}locationToScreenPoint(e,s){const f=sr(e);if(s){const g=s.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aO(f,f,1+g/c.br)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(e){const s=c.bh();return c.ap(s,[...e,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],new c.P((.5*s[0]+.5)*this.width,(.5*-s[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,s){if(s){const f=s.pointCoordinate(e);if(f)return f}return c.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,s){var f;return(f=this.screenPointToMercatorCoordinate(e,s))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(e,s){const f=this._cameraPosition,g=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(f,g)}getRayDirectionFromPixel(e){const s=c.bh();s[0]=e.x/this.width*2-1,s[1]=-1*(e.y/this.height*2-1),s[2]=1,s[3]=1,c.ap(s,s,this._globeViewProjMatrixNoCorrectionInverted),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3];const f=c.bi();f[0]=s[0]-this._cameraPosition[0],f[1]=s[1]-this._cameraPosition[1],f[2]=s[2]-this._cameraPosition[2];const g=c.bi();return c.aT(g,f),g}isSurfacePointVisible(e){const s=this._cachedClippingPlane;return s[0]*e[0]+s[1]*e[1]+s[2]*e[2]+s[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const s=c.bh();return c.ap(s,[...e,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3],s[0]>-1&&s[0]<1&&s[1]>-1&&s[1]<1&&s[2]>-1&&s[2]<1}rayPlanetIntersection(e,s){const f=c.aV(e,s),g=c.bi(),w=c.bi();c.aO(w,s,f),c.aS(g,e,w);const S=1-c.aV(g,g);if(S<0)return null;const D=c.aV(e,e)-1,R=-f+(f<0?1:-1)*Math.sqrt(S),N=D/R,F=R;return{tMin:Math.min(N,F),tMax:Math.max(N,F)}}unprojectScreenPoint(e){const s=this._cameraPosition,f=this.getRayDirectionFromPixel(e),g=this.rayPlanetIntersection(s,f);if(g){const N=c.bi();c.aP(N,s,[f[0]*g.tMin,f[1]*g.tMin,f[2]*g.tMin]);const F=c.bi();return c.aT(F,N),Up(F)}const w=this._cachedClippingPlane[0]*f[0]+this._cachedClippingPlane[1]*f[1]+this._cachedClippingPlane[2]*f[2],S=-c.bq(this._cachedClippingPlane,s)/w,D=c.bi();if(S>0)c.aP(D,s,[f[0]*S,f[1]*S,f[2]*S]);else{const N=c.bi();c.aP(N,s,[2*f[0],2*f[1],2*f[2]]);const F=c.bq(this._cachedClippingPlane,N);c.aS(D,N,[this._cachedClippingPlane[0]*F,this._cachedClippingPlane[1]*F,this._cachedClippingPlane[2]*F])}const R=c.bi();return c.aT(R,D),Up(R)}getMatrixForModel(e,s){const f=c.Q.convert(e),g=1/c.br,w=c.b1();return c.bm(w,w,f.lng/180*Math.PI),c.a$(w,w,-f.lat/180*Math.PI),c.L(w,w,[0,0,1+s/c.br]),c.a$(w,w,.5*Math.PI),c.M(w,w,[g,g,g]),w}getProjectionDataForCustomLayer(e=!0){const s=this.getProjectionData({overscaledTileID:new c.Y(0,0,0,0,0),applyGlobeMatrix:e});return s.tileMercatorCoords=[0,0,1,1],s}getFastPathSimpleProjectionMatrix(e){}}class ld{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,f){return this._helper.interpolatePadding(e,s,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s,f=!0){this._helper.resize(e,s,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,s){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=s,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Vr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,s)=>this.getConstrained(e,s)}),this._globeness=1,this._mercatorTransform=new _i,this._verticalPerspectiveTransform=new od}clone(){const e=new ld;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const s=this._mercatorTransform.getProjectionData(e),f=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:s.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:s.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,s,f){const g=this._mercatorTransform.getPitchedTextCorrection(e,s,f),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,s,f);return c.bc(g,w,this._globeness)}projectTileCoordinates(e,s,f,g){return this.currentTransform.projectTileCoordinates(e,s,f,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,s){return this.currentTransform.lngLatToCameraDepth(e,s)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,s){return this.currentTransform.getConstrained(e,s)}calculateCenterFromCameraLngLatAlt(e,s,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,f,g)}setLocationAtPoint(e,s){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,s),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,s),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,s){return this.currentTransform.locationToScreenPoint(e,s)}screenPointToMercatorCoordinate(e,s){return this.currentTransform.screenPointToMercatorCoordinate(e,s)}screenPointToLocation(e,s){return this.currentTransform.screenPointToLocation(e,s)}isPointOnMapSurface(e,s){return this.currentTransform.isPointOnMapSurface(e,s)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,s){return this.currentTransform.getMatrixForModel(e,s)}getProjectionDataForCustomLayer(e=!0){const s=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return s;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return f.fallbackMatrix=s.mainMatrix,f}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class as{get useGlobeControls(){return!0}handlePanInertia(e,s){const f=Sa(e,s);return Math.abs(f.lng-s.center.lng)>180&&(f.lng=s.center.lng+179.5*Math.sign(f.lng-s.center.lng)),{easingCenter:f,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,s){const f=e.around,g=s.screenPointToLocation(f);e.bearingDelta&&s.setBearing(s.bearing+e.bearingDelta),e.pitchDelta&&s.setPitch(s.pitch+e.pitchDelta),e.rollDelta&&s.setRoll(s.roll+e.rollDelta);const w=s.zoom;e.zoomDelta&&s.setZoom(s.zoom+e.zoomDelta);const S=s.zoom-w;if(S===0)return;const D=c.bn(s.center.lng,g.lng),R=D/(Math.abs(D/180)+1),N=c.bn(s.center.lat,g.lat),F=s.getRayDirectionFromPixel(f),G=s.cameraPosition,Z=-1*c.aV(G,F),K=c.bi();c.aP(K,G,[F[0]*Z,F[1]*Z,F[2]*Z]);const te=c.bt(K)-1,he=Math.exp(.5*-Math.max(te-.3,0)),ue=Bu(s.worldSize,s.center.lat)/Math.min(s.width,s.height),de=c.bf(ue,.9,.5,1,.25),ge=(1-c.aI(-S))*Math.min(he,de),xe=s.center.lat,be=s.zoom,Te=new c.Q(s.center.lng+R*ge,c.ae(s.center.lat+N*ge,-85.051129,c.aJ));s.setLocationAtPoint(g,f);const De=s.center,Me=c.bf(Math.abs(D),45,85,0,1),Ge=c.bf(ue,.75,.35,0,1),Ue=Math.pow(Math.max(Me,Ge),.25),at=c.bn(De.lng,Te.lng),st=c.bn(De.lat,Te.lat);s.setCenter(new c.Q(De.lng+at*Ue,De.lat+st*Ue).wrap()),s.setZoom(be+or(xe,s.center.lat))}handleMapControlsPan(e,s,f){if(!e.panDelta)return;const g=s.center.lat,w=s.zoom;s.setCenter(Sa(e.panDelta,s).wrap()),s.setZoom(w+or(g,s.center.lat))}cameraForBoxAndBearing(e,s,f,g,w){const S=Ao(e,s,f,g,w),D=s.left/w.width*2-1,R=(w.width-s.right)/w.width*2-1,N=s.top/w.height*-2+1,F=(w.height-s.bottom)/w.height*-2+1,G=c.bn(f.getWest(),f.getEast())<0,Z=G?f.getEast():f.getWest(),K=G?f.getWest():f.getEast(),te=Math.max(f.getNorth(),f.getSouth()),he=Math.min(f.getNorth(),f.getSouth()),ue=Z+.5*c.bn(Z,K),de=te+.5*c.bn(te,he),ge=w.clone();ge.setCenter(S.center),ge.setBearing(S.bearing),ge.setPitch(0),ge.setRoll(0),ge.setZoom(S.zoom);const xe=ge.modelViewProjectionMatrix,be=[sr(f.getNorthWest()),sr(f.getNorthEast()),sr(f.getSouthWest()),sr(f.getSouthEast()),sr(new c.Q(K,de)),sr(new c.Q(Z,de)),sr(new c.Q(ue,te)),sr(new c.Q(ue,he))],Te=sr(S.center);let De=Number.POSITIVE_INFINITY;for(const Me of be)D<0&&(De=as.getLesserNonNegativeNonNull(De,as.solveVectorScale(Me,Te,xe,"x",D))),R>0&&(De=as.getLesserNonNegativeNonNull(De,as.solveVectorScale(Me,Te,xe,"x",R))),N>0&&(De=as.getLesserNonNegativeNonNull(De,as.solveVectorScale(Me,Te,xe,"y",N))),F<0&&(De=as.getLesserNonNegativeNonNull(De,as.solveVectorScale(Me,Te,xe,"y",F)));if(Number.isFinite(De)&&De!==0)return S.zoom=ge.zoom+c.ab(De),S;il()}handleJumpToCenterZoom(e,s){const f=e.center.lat,g=e.getConstrained(s.center?c.Q.convert(s.center):e.center,e.zoom).center;e.setCenter(g.wrap());const w=s.zoom!==void 0?+s.zoom:e.zoom+or(f,g.lat);e.zoom!==w&&e.setZoom(w)}handleEaseTo(e,s){const f=e.zoom,g=e.center,w=e.padding,S={roll:e.roll,pitch:e.pitch,bearing:e.bearing},D={roll:s.roll===void 0?e.roll:s.roll,pitch:s.pitch===void 0?e.pitch:s.pitch,bearing:s.bearing===void 0?e.bearing:s.bearing},R=s.zoom!==void 0,N=!e.isPaddingEqual(s.padding);let F=!1;const G=s.center?c.Q.convert(s.center):g,Z=e.getConstrained(G,f).center;rd(e,Z);const K=e.clone();K.setCenter(Z),K.setZoom(R?+s.zoom:f+or(g.lat,G.lat)),K.setBearing(s.bearing);const te=new c.P(c.ae(e.centerPoint.x+s.offsetAsPoint.x,0,e.width),c.ae(e.centerPoint.y+s.offsetAsPoint.y,0,e.height));K.setLocationAtPoint(Z,te);const he=(s.offset&&s.offsetAsPoint.mag())>0?K.center:Z,ue=R?+s.zoom:f+or(g.lat,he.lat),de=f+or(g.lat,0),ge=ue+or(he.lat,0),xe=c.bn(g.lng,he.lng),be=c.bn(g.lat,he.lat),Te=c.aI(ge-de);return F=ue!==f,{easeFunc:De=>{if(c.b6(S,D)||So({startEulerAngles:S,endEulerAngles:D,tr:e,k:De,useSlerp:S.roll!=D.roll}),N&&e.interpolatePadding(w,s.padding,De),s.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(s.around,s.aroundPoint);else{const Me=ge>de?Math.min(2,Te):Math.max(.5,Te),Ge=Math.pow(Me,1-De),Ue=bf(g,xe,be,De*Ge);e.setCenter(Ue.wrap())}if(F){const Me=c.B.number(de,ge,De)+or(0,e.center.lat);e.setZoom(Me)}},isZooming:F,elevationCenter:he}}handleFlyTo(e,s){const f=s.zoom!==void 0,g=e.center,w=e.zoom,S=e.padding,D=!e.isPaddingEqual(s.padding),R=e.getConstrained(c.Q.convert(s.center||s.locationAtOffset),w).center,N=f?+s.zoom:e.zoom+or(e.center.lat,R.lat),F=e.clone();F.setCenter(R),F.setZoom(N),F.setBearing(s.bearing);const G=new c.P(c.ae(e.centerPoint.x+s.offsetAsPoint.x,0,e.width),c.ae(e.centerPoint.y+s.offsetAsPoint.y,0,e.height));F.setLocationAtPoint(R,G);const Z=F.center;rd(e,Z);const K=function(be,Te,De){const Me=sr(Te),Ge=sr(De),Ue=c.aV(Me,Ge),at=Math.acos(Ue),st=sd(be);return at/(2*Math.PI)*st}(e,g,Z),te=w+or(g.lat,0),he=N+or(Z.lat,0),ue=c.aI(he-te);let de;if(typeof s.minZoom=="number"){const be=+s.minZoom+or(Z.lat,0),Te=Math.min(be,te,he)+or(0,Z.lat),De=e.getConstrained(Z,Te).zoom+or(Z.lat,0);de=c.aI(De-te)}const ge=c.bn(g.lng,Z.lng),xe=c.bn(g.lat,Z.lat);return{easeFunc:(be,Te,De,Me)=>{const Ge=bf(g,ge,xe,De);D&&e.interpolatePadding(S,s.padding,be);const Ue=be===1?Z:Ge;e.setCenter(Ue.wrap());const at=te+c.ab(Te);e.setZoom(be===1?N:at+or(0,Ue.lat))},scaleOfZoom:ue,targetCenter:Z,scaleOfMinZoom:de,pixelPathLength:K}}static solveVectorScale(e,s,f,g,w){const S=g==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],D=[f[3],f[7],f[11],f[15]],R=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],N=e[0]*D[0]+e[1]*D[1]+e[2]*D[2],F=s[0]*S[0]+s[1]*S[1]+s[2]*S[2],G=s[0]*D[0]+s[1]*D[1]+s[2]*D[2];return F+w*N===R+w*G||D[3]*(R-F)+S[3]*(G-N)+R*G==F*N?null:(F+S[3]-w*G-w*D[3])/(F-R-w*G+w*N)}static getLesserNonNegativeNonNull(e,s){return s!==null&&s>=0&&s<e?s:e}}class Gp{constructor(e){this._globe=e,this._mercatorCameraHelper=new Yi,this._verticalPerspectiveCameraHelper=new as}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,s){return this.currentHelper.handlePanInertia(e,s)}handleMapControlsRollPitchBearingZoom(e,s){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,s)}handleMapControlsPan(e,s,f){this.currentHelper.handleMapControlsPan(e,s,f)}cameraForBoxAndBearing(e,s,f,g,w){return this.currentHelper.cameraForBoxAndBearing(e,s,f,g,w)}handleJumpToCenterZoom(e,s){this.currentHelper.handleJumpToCenterZoom(e,s)}handleEaseTo(e,s){return this.currentHelper.handleEaseTo(e,s)}handleFlyTo(e,s){return this.currentHelper.handleFlyTo(e,s)}}const Io=(x,e)=>c.x(x,e&&e.filter(s=>s.identifier!=="source.canvas")),Tf=c.bu();class Zc extends c.E{constructor(e,s={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const g=this.sourceCaches[f].getSource().type;g!=="vector"&&g!=="geojson"||this.sourceCaches[f].reload()}},this.map=e,this.dispatcher=new gi(tn(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,g)=>this.getGlyphs(f,g)),this.dispatcher.registerMessageHandler("GI",(f,g)=>this.getImages(f,g)),this.imageManager=new _t,this.imageManager.setEventedParent(this),this.glyphManager=new Wt(e._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Se(256,512),this.crossTileSymbolIndex=new ql,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bv,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.bw()),pr().on(Fs,this._rtlPluginLoaded),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const g=this.sourceCaches[f.sourceId];if(!g)return;const w=g.getSource();if(w&&w.vectorLayerIds)for(const S in this._layers){const D=this._layers[S];D.source===w.id&&this._validateLayer(D)}})}loadURL(e,s={},f){this.fire(new c.l("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const g=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;c.j(g,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,s,f)}).catch(S=>{this._loadStyleRequest=null,S&&!w.signal.aborted&&this.fire(new c.k(S))})}loadJSON(e,s={},f){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,U.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Tf,{validate:!1})}_load(e,s,f){var g,w;const S=s.transformStyle?s.transformStyle(f,e):e;if(!s.validate||!Io(this,c.y(S))){this._loaded=!0,this.stylesheet=S;for(const D in S.sources)this.addSource(D,S.sources[D],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new vt(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new Qt(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const e=c.bx(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of e){const f=c.by(s);f.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=f}}_loadSprite(e,s=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,S,D,R){return c._(this,void 0,void 0,function*(){const N=Ze(w),F=D>1?"@2x":"",G={},Z={};for(const{id:K,url:te}of N){const he=S.transformRequest(nt(te,F,".json"),"SpriteJSON");G[K]=c.j(he,R);const ue=S.transformRequest(nt(te,F,".png"),"SpriteImage");Z[K]=$e.getImage(ue,R)}return yield Promise.all([...Object.values(G),...Object.values(Z)]),function(K,te){return c._(this,void 0,void 0,function*(){const he={};for(const ue in K){he[ue]={};const de=U.getImageCanvasContext((yield te[ue]).data),ge=(yield K[ue]).data;for(const xe in ge){const{width:be,height:Te,x:De,y:Me,sdf:Ge,pixelRatio:Ue,stretchX:at,stretchY:st,content:it,textFitWidth:At,textFitHeight:Et}=ge[xe];he[ue][xe]={data:null,pixelRatio:Ue,sdf:Ge,stretchX:at,stretchY:st,content:it,textFitWidth:At,textFitHeight:Et,spriteData:{width:be,height:Te,x:De,y:Me,context:de}}}}return he})}(G,Z)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const S in w){this._spritesImagesIds[S]=[];const D=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(R=>!(R in w)):[];for(const R of D)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(const R in w[S]){const N=S==="default"?R:`${S}:${R}`;this._spritesImagesIds[S].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,w[S][R],!1):this.imageManager.addImage(N,w[S][R]),s&&(this._changedImages[N]=!0)}}}).catch(w=>{this._spriteRequest=null,g=w,this.fire(new c.k(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),f&&f(g)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const f=e.sourceLayer;if(!f)return;const g=s.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.k(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const f=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?c.bz(f):f);const g=[];for(const w of e)if(f[w]){const S=s?c.bz(f[w]):f[w];g.push(S)}return g}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const f of s){const g=this._layers[f];g.type!=="custom"&&(e[f]=g.serialize())}return e}hasTransitions(){var e,s,f;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((s=this.sky)===null||s===void 0)&&s.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const g in this.sourceCaches)if(this.sourceCaches[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const g=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(g.length||w.length)&&this._updateWorkerLayers(g,w);for(const S in this._updatedSources){const D=this._updatedSources[S];if(D==="reload")this._reloadSource(S);else{if(D!=="clear")throw new Error(`Invalid action ${D}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const w=this.sourceCaches[g];f[g]=w.used,w.used=!1}for(const g of this._order){const w=this._layers[g];w.recalculate(e,this._availableImages),!w.isHidden(e.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const g in f){const w=this.sourceCaches[g];!!f[g]!=!!w.used&&w.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,s&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var f;this._checkLoaded();const g=this.serialize();if(e=s.transformStyle?s.transformStyle(g,e):e,((f=s.validate)===null||f===void 0||f)&&Io(this,c.y(e)))return!1;(e=c.bz(e)).layers=c.bx(e.layers);const w=c.bA(g,e),S=this._getOperationsToPerform(w);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const D of S.operations)D();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],f=[];for(const g of e)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":s.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":s.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setSky":s.push(()=>this.setSky.apply(this,g.args));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setTransition":s.push(()=>{});break;default:f.push(g.command)}return{operations:s,unimplemented:f}}addImage(e,s){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,f={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(c.y.source,`sources.${e}`,s,null,f))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const g=this.sourceCaches[e]=new ee(e,s,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:e})),g.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${f}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const f=this.sourceCaches[e].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,f={}){this._checkLoaded();const g=e.id;if(this.getLayer(g))return void this.fire(new c.k(new Error(`Layer "${g}" already exists on this map.`)));let w;if(e.type==="custom"){if(Io(this,c.bB(e)))return;w=c.by(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(g,e.source),e=c.bz(e),e=c.e(e,{source:g})),this._validate(c.y.layer,`layers.${g}`,e,{arrayIndex:-1},f))return;w=c.by(e),this._validateLayer(w),w.setEventedParent(this,{layer:{id:g}})}const S=s?this._order.indexOf(s):this._order.length;if(s&&S===-1)this.fire(new c.k(new Error(`Cannot add layer "${g}" before non-existing layer "${s}".`)));else{if(this._order.splice(S,0,g),this._layerOrderChanged=!0,this._layers[g]=w,this._removedLayers[g]&&w.source&&w.type!=="custom"){const D=this._removedLayers[g];delete this._removedLayers[g],D.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const f=this._order.indexOf(e);this._order.splice(f,1);const g=s?this._order.indexOf(s):this._order.length;s&&g===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(g,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const f=this._order.indexOf(e);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,f){this._checkLoaded();const g=this.getLayer(e);g?g.minzoom===s&&g.maxzoom===f||(s!=null&&(g.minzoom=s),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,f={}){this._checkLoaded();const g=this.getLayer(e);if(g){if(!c.bC(g.filter,s))return s==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(c.y.filter,`layers.${g.id}.filter`,s,null,f)||(g.filter=c.bz(s),this._updateLayer(g)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bz(this.getLayer(e).filter)}setLayoutProperty(e,s,f,g={}){this._checkLoaded();const w=this.getLayer(e);w?c.bC(w.getLayoutProperty(s),f)||(w.setLayoutProperty(s,f,g),this._updateLayer(w)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const f=this.getLayer(e);if(f)return f.getLayoutProperty(s);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,f,g={}){this._checkLoaded();const w=this.getLayer(e);w?c.bC(w.getPaintProperty(s),f)||(w.setPaintProperty(s,f,g)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const f=e.source,g=e.sourceLayer,w=this.sourceCaches[f];if(w===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const S=w.getSource().type;S==="geojson"&&g?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||g?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(g,e.id,s)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const f=e.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const w=g.getSource().type,S=w==="vector"?e.sourceLayer:void 0;w!=="vector"||S?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(S,e.id,s):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,f=e.sourceLayer,g=this.sourceCaches[s];if(g!==void 0)return g.getSource().type!=="vector"||f?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bD(this.sourceCaches,w=>w.serialize()),s=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,g=this.stylesheet;return c.bE({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:e,layers:s,terrain:f},w=>w!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=S=>this._layers[S].type==="fill-extrusion",f={},g=[];for(let S=this._order.length-1;S>=0;S--){const D=this._order[S];if(s(D)){f[D]=S;for(const R of e){const N=R[D];if(N)for(const F of N)g.push(F)}}}g.sort((S,D)=>D.intersectionZ-S.intersectionZ);const w=[];for(let S=this._order.length-1;S>=0;S--){const D=this._order[S];if(s(D))for(let R=g.length-1;R>=0;R--){const N=g[R].feature;if(f[N.layer.id]<S)break;w.push(N),g.pop()}else for(const R of e){const N=R[D];if(N)for(const F of N)w.push(F.feature)}}return w}queryRenderedFeatures(e,s,f){s&&s.filter&&this._validate(c.y.filter,"queryRenderedFeatures.filter",s.filter,null,s);const g={};if(s&&s.layers){if(!(Array.isArray(s.layers)||s.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const N of s.layers){const F=this._layers[N];if(!F)return this.fire(new c.k(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];g[F.source]=!0}}const w=[];s.availableImages=this._availableImages;const S=this._serializedAllLayers(),D=s.layers instanceof Set?s.layers:Array.isArray(s.layers)?new Set(s.layers):null,R=Object.assign(Object.assign({},s),{layers:D});for(const N in this.sourceCaches)s.layers&&!g[N]||w.push(ba(this.sourceCaches[N],this._layers,S,e,R,f,this.map.terrain?(F,G,Z)=>this.map.terrain.getElevation(F,G,Z):void 0));return this.placement&&w.push(function(N,F,G,Z,K,te,he){const ue={},de=te.queryRenderedSymbols(Z),ge=[];for(const xe of Object.keys(de).map(Number))ge.push(he[xe]);ge.sort(Mi);for(const xe of ge){const be=xe.featureIndex.lookupSymbolFeatures(de[xe.bucketInstanceId],F,xe.bucketIndex,xe.sourceLayerIndex,K.filter,K.layers,K.availableImages,N);for(const Te in be){const De=ue[Te]=ue[Te]||[],Me=be[Te];Me.sort((Ge,Ue)=>{const at=xe.featureSortOrder;if(at){const st=at.indexOf(Ge.featureIndex);return at.indexOf(Ue.featureIndex)-st}return Ue.featureIndex-Ge.featureIndex});for(const Ge of Me)De.push(Ge)}}return function(xe,be,Te){for(const De in xe)for(const Me of xe[De])yi(Me,Te[be[De].source]);return xe}(ue,N,G)}(this._layers,S,this.sourceCaches,e,R,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(e,s){s&&s.filter&&this._validate(c.y.filter,"querySourceFeatures.filter",s.filter,null,s);const f=this.sourceCaches[e];return f?function(g,w){const S=g.getRenderableIds().map(N=>g.getTileByID(N)),D=[],R={};for(let N=0;N<S.length;N++){const F=S[N],G=F.tileID.canonical.key;R[G]||(R[G]=!0,F.querySourceFeatures(D,w))}return D}(f,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const S in e)if(!c.bC(e[S],f[S])){g=!0;break}if(!g)return;const w={now:U.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(w)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){this._checkLoaded();const f=this.getSky();let g=!1;if(!e&&!f)return;if(e&&!f)g=!0;else if(!e&&f)g=!0;else for(const S in e)if(!c.bC(e[S],f[S])){g=!0;break}if(!g)return;const w={now:U.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(w)}_setProjectionInternal(e){const s=function(f){if(Array.isArray(f)){const g=new al({type:f});return{projection:g,transform:new ld,cameraHelper:new Gp(g)}}switch(f){case"mercator":return{projection:new kn,transform:new _i,cameraHelper:new Yi};case"globe":{const g=new al({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new ld,cameraHelper:new Gp(g)}}case"vertical-perspective":return{projection:new Do,transform:new od,cameraHelper:new as};default:return c.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new kn,transform:new _i,cameraHelper:new Yi}}}(e);this.projection=s.projection,this.map.migrateProjection(s.transform,s.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(e,s,f,g,w={}){return(!w||w.validate!==!1)&&Io(this,e.call(c.y,c.e({key:s,style:this.serialize(),value:f,styleSpec:c.v},g)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),pr().off(Fs,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const f=this.sourceCaches[s];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,f,g,w=!1){let S=!1,D=!1;const R={};for(const N of this._order){const F=this._layers[N];if(F.type!=="symbol")continue;if(!R[F.source]){const Z=this.sourceCaches[F.source];R[F.source]=Z.getRenderableIds(!0).map(K=>Z.getTileByID(K)).sort((K,te)=>te.tileID.overscaledZ-K.tileID.overscaledZ||(K.tileID.isLessThan(te.tileID)?-1:1))}const G=this.crossTileSymbolIndex.addLayer(F,R[F.source],e.center.lng);S=S||G}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(U.now(),e.zoom))&&(this.pauseablePlacement=new Ta(e,this.map.terrain,this._order,w,s,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(U.now()),D=!0),S&&this.pauseablePlacement.placement.setStale()),D||S)for(const N of this._order){const F=this._layers[N];F.type==="symbol"&&this.placement.updateLayerOpacities(F,R[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(U.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[s.source];return g&&g.setDependencies(s.tileID.key,s.type,s.icons),f})}getGlyphs(e,s){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(s.stacks),g=this.sourceCaches[s.source];return g&&g.setDependencies(s.tileID.key,s.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(c.y.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,f={},g){this._checkLoaded();const w=[{id:e,url:s}],S=[...Ze(this.stylesheet.sprite),...w];this._validate(c.y.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(w,!0,g))}removeSprite(e){this._checkLoaded();const s=Ze(this.stylesheet.sprite);if(s.find(f=>f.id===e)){if(this._spritesImagesIds[e])for(const f of this._spritesImagesIds[e])this.imageManager.removeImage(f),this._changedImages[f]=!0;s.splice(s.findIndex(f=>f.id===e),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ze(this.stylesheet.sprite)}setSprite(e,s={},f){this._checkLoaded(),e&&this._validate(c.y.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,f):(this._unloadSprite(),f&&f(null)))}}var Ef=c.aD([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class cd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,f,g,w,S,D,R,N){this.context=e;let F=this.boundPaintVertexBuffers.length!==g.length;for(let G=0;!F&&G<g.length;G++)this.boundPaintVertexBuffers[G]!==g[G]&&(F=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==f||F||this.boundIndexBuffer!==w||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==D||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==N?this.freshBind(s,f,g,w,S,D,R,N):(e.bindVertexArray.set(this.vao),D&&D.bind(),w&&w.dynamicDraw&&w.bind(),R&&R.bind(),N&&N.bind())}freshBind(e,s,f,g,w,S,D,R){const N=e.numAttributes,F=this.context,G=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=D,this.boundDynamicVertexBuffer3=R,s.enableAttributes(G,e);for(const Z of f)Z.enableAttributes(G,e);S&&S.enableAttributes(G,e),D&&D.enableAttributes(G,e),R&&R.enableAttributes(G,e),s.bind(),s.setVertexAttribPointers(G,e,w);for(const Z of f)Z.bind(),Z.setVertexAttribPointers(G,e,w);S&&(S.bind(),S.setVertexAttribPointers(G,e,w)),g&&g.bind(),D&&(D.bind(),D.setVertexAttribPointers(G,e,w)),R&&(R.bind(),R.setVertexAttribPointers(G,e,w)),F.currentNumAttributes=N}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Gs=(x,e,s,f,g)=>({u_texture:0,u_ele_delta:x,u_fog_matrix:e,u_fog_color:s?s.properties.get("fog-color"):c.b7.white,u_fog_ground_blend:s?s.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:s?s.calculateFogBlendOpacity(f):0,u_horizon_color:s?s.properties.get("horizon-color"):c.b7.white,u_horizon_fog_blend:s?s.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),Mg={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Gc(x){const e=[];for(let s=0;s<x.length;s++){if(x[s]===null)continue;const f=x[s].split(" ");e.push(f.pop())}return e}class Fu{constructor(e,s,f,g,w,S,D,R){const N=e.gl;this.program=N.createProgram();const F=Gc(s.staticAttributes),G=f?f.getBinderAttributes():[],Z=F.concat(G),K=$i.prelude.staticUniforms?Gc($i.prelude.staticUniforms):[],te=D.staticUniforms?Gc(D.staticUniforms):[],he=s.staticUniforms?Gc(s.staticUniforms):[],ue=f?f.getBinderUniforms():[],de=K.concat(te).concat(he).concat(ue),ge=[];for(const Ue of de)ge.indexOf(Ue)<0&&ge.push(Ue);const xe=f?f.defines():[];ca(N)&&xe.unshift("#version 300 es"),w&&xe.push("#define OVERDRAW_INSPECTOR;"),S&&xe.push("#define TERRAIN3D;"),R&&xe.push(R);let be=xe.concat($i.prelude.fragmentSource,D.fragmentSource,s.fragmentSource).join(`
`),Te=xe.concat($i.prelude.vertexSource,D.vertexSource,s.vertexSource).join(`
`);ca(N)||(be=function(Ue){return Ue.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(be),Te=function(Ue){return Ue.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Te));const De=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(De,be),N.compileShader(De),!N.getShaderParameter(De,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(De)}`);N.attachShader(this.program,De);const Me=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Me,Te),N.compileShader(Me),!N.getShaderParameter(Me,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(Me)}`);N.attachShader(this.program,Me),this.attributes={};const Ge={};this.numAttributes=Z.length;for(let Ue=0;Ue<this.numAttributes;Ue++)Z[Ue]&&(N.bindAttribLocation(this.program,Ue,Z[Ue]),this.attributes[Z[Ue]]=Ue);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(Me),N.deleteShader(De);for(let Ue=0;Ue<ge.length;Ue++){const at=ge[Ue];if(at&&!Ge[at]){const st=N.getUniformLocation(this.program,at);st&&(Ge[at]=st)}}this.fixedUniforms=g(e,Ge),this.terrainUniforms=((Ue,at)=>({u_depth:new c.bF(Ue,at.u_depth),u_terrain:new c.bF(Ue,at.u_terrain),u_terrain_dim:new c.b8(Ue,at.u_terrain_dim),u_terrain_matrix:new c.bH(Ue,at.u_terrain_matrix),u_terrain_unpack:new c.bI(Ue,at.u_terrain_unpack),u_terrain_exaggeration:new c.b8(Ue,at.u_terrain_exaggeration)}))(e,Ge),this.projectionUniforms=((Ue,at)=>({u_projection_matrix:new c.bH(Ue,at.u_projection_matrix),u_projection_tile_mercator_coords:new c.bI(Ue,at.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bI(Ue,at.u_projection_clipping_plane),u_projection_transition:new c.b8(Ue,at.u_projection_transition),u_projection_fallback_matrix:new c.bH(Ue,at.u_projection_fallback_matrix)}))(e,Ge),this.binderUniforms=f?f.getUniforms(e,Ge):[]}draw(e,s,f,g,w,S,D,R,N,F,G,Z,K,te,he,ue,de,ge,xe){const be=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(f),e.setStencilMode(g),e.setColorMode(w),e.setCullFace(S),R){e.activeTexture.set(be.TEXTURE2),be.bindTexture(be.TEXTURE_2D,R.depthTexture),e.activeTexture.set(be.TEXTURE3),be.bindTexture(be.TEXTURE_2D,R.texture);for(const De in this.terrainUniforms)this.terrainUniforms[De].set(R[De])}if(N)for(const De in N)this.projectionUniforms[Mg[De]].set(N[De]);if(D)for(const De in this.fixedUniforms)this.fixedUniforms[De].set(D[De]);ue&&ue.setUniforms(e,this.binderUniforms,te,{zoom:he});let Te=0;switch(s){case be.LINES:Te=2;break;case be.TRIANGLES:Te=3;break;case be.LINE_STRIP:Te=1}for(const De of K.get()){const Me=De.vaos||(De.vaos={});(Me[F]||(Me[F]=new cd)).bind(e,this,G,ue?ue.getPaintVertexBuffers():[],Z,De.vertexOffset,de,ge,xe),be.drawElements(s,De.primitiveLength*Te,be.UNSIGNED_SHORT,De.primitiveOffset*Te*2)}}}function $c(x,e,s){const f=1/c.aw(s,1,e.transform.tileZoom),g=Math.pow(2,s.tileID.overscaledZ),w=s.tileSize*Math.pow(2,e.transform.tileZoom)/g,S=w*(s.tileID.canonical.x+s.tileID.wrap*g),D=w*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[f,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[S>>16,D>>16],u_pixel_coord_lower:[65535&S,65535&D]}}const $p=(x,e,s,f)=>{const g=x.style.light,w=g.properties.get("position"),S=[w.x,w.y,w.z],D=c.bL();g.properties.get("anchor")==="viewport"&&c.bM(D,x.transform.bearingInRadians),c.bN(S,S,D);const R=x.transform.transformLightDirection(S),N=g.properties.get("color");return{u_lightpos:S,u_lightpos_globe:R,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[N.r,N.g,N.b],u_vertical_gradient:+e,u_opacity:s,u_fill_translate:f}},ud=(x,e,s,f,g,w,S)=>c.e($p(x,e,s,f),$c(w,x,S),{u_height_factor:-Math.pow(2,g.overscaledZ)/S.tileSize/8}),Yp=(x,e,s,f)=>c.e($c(e,x,s),{u_fill_translate:f}),Yc=(x,e)=>({u_world:x,u_fill_translate:e}),Sf=(x,e,s,f,g)=>c.e(Yp(x,e,s,g),{u_world:f}),qc=(x,e,s,f,g)=>{const w=x.transform;let S,D,R=0;if(s.paint.get("circle-pitch-alignment")==="map"){const N=c.aw(e,1,w.zoom);S=!0,D=[N,N],R=N/(c.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*g}else S=!1,D=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:D,u_globe_extrude_scale:R,u_translate:f}},Cg=x=>({u_pixel_extrude_scale:[1/x.width,1/x.height]}),Af=x=>({u_viewport_size:[x.width,x.height]}),Uu=(x,e=1)=>({u_color:x,u_overlay:0,u_overlay_scale:e}),hd=(x,e,s,f)=>{const g=c.aw(x,1,e)/(c.Z*Math.pow(2,x.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:c.aw(x,1,e),u_intensity:s,u_globe_extrude_scale:g}},dd=(x,e,s,f)=>{const g=c.K();c.bO(g,0,x.width,x.height,0,0,1);const w=x.context.gl;return{u_matrix:g,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:s,u_color_ramp:f,u_opacity:e.paint.get("heatmap-opacity")}},Mf=(x,e,s)=>{const f=s.paint.get("hillshade-shadow-color"),g=s.paint.get("hillshade-highlight-color"),w=s.paint.get("hillshade-accent-color");let S=s.paint.get("hillshade-illumination-direction")*(Math.PI/180);return s.paint.get("hillshade-illumination-anchor")==="viewport"&&(S+=x.transform.bearingInRadians),{u_image:0,u_latrange:Kl(0,e.tileID),u_light:[s.paint.get("hillshade-exaggeration"),S],u_shadow:f,u_highlight:g,u_accent:w}},Ql=(x,e)=>{const s=e.stride,f=c.K();return c.bO(f,0,c.Z,-8192,0,0,1),c.L(f,f,[0,-8192,0]),{u_matrix:f,u_image:1,u_dimension:[s,s],u_zoom:x.overscaledZ,u_unpack:e.getUnpackVector()}};function Kl(x,e){const s=Math.pow(2,e.canonical.z),f=e.canonical.y;return[new c.$(0,f/s).toLngLat().lat,new c.$(0,(f+1)/s).toLngLat().lat]}const fd=(x,e,s,f)=>{const g=x.transform;return{u_translation:Xc(x,e,s),u_ratio:f/c.aw(e,1,g.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},qp=(x,e,s,f,g)=>c.e(fd(x,e,s,f),{u_image:0,u_image_height:g}),Hc=(x,e,s,f,g)=>{const w=x.transform,S=Ro(e,w);return{u_translation:Xc(x,e,s),u_texsize:e.imageAtlasTexture.size,u_ratio:f/c.aw(e,1,w.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[S,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Hp=(x,e,s,f,g,w)=>{const S=x.lineAtlas,D=Ro(e,x.transform),R=s.layout.get("line-cap")==="round",N=S.getDash(g.from,R),F=S.getDash(g.to,R),G=N.width*w.fromScale,Z=F.width*w.toScale;return c.e(fd(x,e,s,f),{u_patternscale_a:[D/G,-N.height/2],u_patternscale_b:[D/Z,-F.height/2],u_sdfgamma:S.width/(256*Math.min(G,Z)*x.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:F.y,u_mix:w.t})};function Ro(x,e){return 1/c.aw(x,1,e.tileZoom)}function Xc(x,e,s){return c.ax(x.transform,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Dg=(x,e,s,f,g)=>{return{u_tl_parent:x,u_scale_parent:e,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=f.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Vu(f.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var w,S};function Vu(x){x*=Math.PI/180;const e=Math.sin(x),s=Math.cos(x);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const pd=(x,e,s,f,g,w,S,D,R,N,F,G,Z)=>{const K=S.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:K.width/K.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:D,u_coord_matrix:R,u_is_text:+F,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:w,u_texsize:G,u_texture:0,u_translation:N,u_pitched_scale:Z}},md=(x,e,s,f,g,w,S,D,R,N,F,G,Z,K)=>{const te=S.transform;return c.e(pd(x,e,s,f,g,w,S,D,R,N,F,G,K),{u_gamma_scale:f?Math.cos(te.pitch*Math.PI/180)*te.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Zu=(x,e,s,f,g,w,S,D,R,N,F,G,Z)=>c.e(md(x,e,s,f,g,w,S,D,R,N,!0,F,0,Z),{u_texsize_icon:G,u_texture_icon:1}),gd=(x,e)=>({u_opacity:x,u_color:e}),Gu=(x,e,s,f,g)=>c.e(function(w,S,D,R){const N=D.imageManager.getPattern(w.from.toString()),F=D.imageManager.getPattern(w.to.toString()),{width:G,height:Z}=D.imageManager.getPixelSize(),K=Math.pow(2,R.tileID.overscaledZ),te=R.tileSize*Math.pow(2,D.transform.tileZoom)/K,he=te*(R.tileID.canonical.x+R.tileID.wrap*K),ue=te*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:N.tl,u_pattern_br_a:N.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[G,Z],u_mix:S.t,u_pattern_size_a:N.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/c.aw(R,1,D.transform.tileZoom),u_pixel_coord_upper:[he>>16,ue>>16],u_pixel_coord_lower:[65535&he,65535&ue]}}(s,g,e,f),{u_opacity:x}),ss=(x,e)=>{},yd={fillExtrusion:(x,e)=>({u_lightpos:new c.bJ(x,e.u_lightpos),u_lightpos_globe:new c.bJ(x,e.u_lightpos_globe),u_lightintensity:new c.b8(x,e.u_lightintensity),u_lightcolor:new c.bJ(x,e.u_lightcolor),u_vertical_gradient:new c.b8(x,e.u_vertical_gradient),u_opacity:new c.b8(x,e.u_opacity),u_fill_translate:new c.bK(x,e.u_fill_translate)}),fillExtrusionPattern:(x,e)=>({u_lightpos:new c.bJ(x,e.u_lightpos),u_lightpos_globe:new c.bJ(x,e.u_lightpos_globe),u_lightintensity:new c.b8(x,e.u_lightintensity),u_lightcolor:new c.bJ(x,e.u_lightcolor),u_vertical_gradient:new c.b8(x,e.u_vertical_gradient),u_height_factor:new c.b8(x,e.u_height_factor),u_opacity:new c.b8(x,e.u_opacity),u_fill_translate:new c.bK(x,e.u_fill_translate),u_image:new c.bF(x,e.u_image),u_texsize:new c.bK(x,e.u_texsize),u_pixel_coord_upper:new c.bK(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bK(x,e.u_pixel_coord_lower),u_scale:new c.bJ(x,e.u_scale),u_fade:new c.b8(x,e.u_fade)}),fill:(x,e)=>({u_fill_translate:new c.bK(x,e.u_fill_translate)}),fillPattern:(x,e)=>({u_image:new c.bF(x,e.u_image),u_texsize:new c.bK(x,e.u_texsize),u_pixel_coord_upper:new c.bK(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bK(x,e.u_pixel_coord_lower),u_scale:new c.bJ(x,e.u_scale),u_fade:new c.b8(x,e.u_fade),u_fill_translate:new c.bK(x,e.u_fill_translate)}),fillOutline:(x,e)=>({u_world:new c.bK(x,e.u_world),u_fill_translate:new c.bK(x,e.u_fill_translate)}),fillOutlinePattern:(x,e)=>({u_world:new c.bK(x,e.u_world),u_image:new c.bF(x,e.u_image),u_texsize:new c.bK(x,e.u_texsize),u_pixel_coord_upper:new c.bK(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bK(x,e.u_pixel_coord_lower),u_scale:new c.bJ(x,e.u_scale),u_fade:new c.b8(x,e.u_fade),u_fill_translate:new c.bK(x,e.u_fill_translate)}),circle:(x,e)=>({u_camera_to_center_distance:new c.b8(x,e.u_camera_to_center_distance),u_scale_with_map:new c.bF(x,e.u_scale_with_map),u_pitch_with_map:new c.bF(x,e.u_pitch_with_map),u_extrude_scale:new c.bK(x,e.u_extrude_scale),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.b8(x,e.u_globe_extrude_scale),u_translate:new c.bK(x,e.u_translate)}),collisionBox:(x,e)=>({u_pixel_extrude_scale:new c.bK(x,e.u_pixel_extrude_scale)}),collisionCircle:(x,e)=>({u_viewport_size:new c.bK(x,e.u_viewport_size)}),debug:(x,e)=>({u_color:new c.bG(x,e.u_color),u_overlay:new c.bF(x,e.u_overlay),u_overlay_scale:new c.b8(x,e.u_overlay_scale)}),depth:ss,clippingMask:ss,heatmap:(x,e)=>({u_extrude_scale:new c.b8(x,e.u_extrude_scale),u_intensity:new c.b8(x,e.u_intensity),u_globe_extrude_scale:new c.b8(x,e.u_globe_extrude_scale)}),heatmapTexture:(x,e)=>({u_matrix:new c.bH(x,e.u_matrix),u_world:new c.bK(x,e.u_world),u_image:new c.bF(x,e.u_image),u_color_ramp:new c.bF(x,e.u_color_ramp),u_opacity:new c.b8(x,e.u_opacity)}),hillshade:(x,e)=>({u_image:new c.bF(x,e.u_image),u_latrange:new c.bK(x,e.u_latrange),u_light:new c.bK(x,e.u_light),u_shadow:new c.bG(x,e.u_shadow),u_highlight:new c.bG(x,e.u_highlight),u_accent:new c.bG(x,e.u_accent)}),hillshadePrepare:(x,e)=>({u_matrix:new c.bH(x,e.u_matrix),u_image:new c.bF(x,e.u_image),u_dimension:new c.bK(x,e.u_dimension),u_zoom:new c.b8(x,e.u_zoom),u_unpack:new c.bI(x,e.u_unpack)}),line:(x,e)=>({u_translation:new c.bK(x,e.u_translation),u_ratio:new c.b8(x,e.u_ratio),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_units_to_pixels:new c.bK(x,e.u_units_to_pixels)}),lineGradient:(x,e)=>({u_translation:new c.bK(x,e.u_translation),u_ratio:new c.b8(x,e.u_ratio),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_units_to_pixels:new c.bK(x,e.u_units_to_pixels),u_image:new c.bF(x,e.u_image),u_image_height:new c.b8(x,e.u_image_height)}),linePattern:(x,e)=>({u_translation:new c.bK(x,e.u_translation),u_texsize:new c.bK(x,e.u_texsize),u_ratio:new c.b8(x,e.u_ratio),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_image:new c.bF(x,e.u_image),u_units_to_pixels:new c.bK(x,e.u_units_to_pixels),u_scale:new c.bJ(x,e.u_scale),u_fade:new c.b8(x,e.u_fade)}),lineSDF:(x,e)=>({u_translation:new c.bK(x,e.u_translation),u_ratio:new c.b8(x,e.u_ratio),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_units_to_pixels:new c.bK(x,e.u_units_to_pixels),u_patternscale_a:new c.bK(x,e.u_patternscale_a),u_patternscale_b:new c.bK(x,e.u_patternscale_b),u_sdfgamma:new c.b8(x,e.u_sdfgamma),u_image:new c.bF(x,e.u_image),u_tex_y_a:new c.b8(x,e.u_tex_y_a),u_tex_y_b:new c.b8(x,e.u_tex_y_b),u_mix:new c.b8(x,e.u_mix)}),raster:(x,e)=>({u_tl_parent:new c.bK(x,e.u_tl_parent),u_scale_parent:new c.b8(x,e.u_scale_parent),u_buffer_scale:new c.b8(x,e.u_buffer_scale),u_fade_t:new c.b8(x,e.u_fade_t),u_opacity:new c.b8(x,e.u_opacity),u_image0:new c.bF(x,e.u_image0),u_image1:new c.bF(x,e.u_image1),u_brightness_low:new c.b8(x,e.u_brightness_low),u_brightness_high:new c.b8(x,e.u_brightness_high),u_saturation_factor:new c.b8(x,e.u_saturation_factor),u_contrast_factor:new c.b8(x,e.u_contrast_factor),u_spin_weights:new c.bJ(x,e.u_spin_weights),u_coords_top:new c.bI(x,e.u_coords_top),u_coords_bottom:new c.bI(x,e.u_coords_bottom)}),symbolIcon:(x,e)=>({u_is_size_zoom_constant:new c.bF(x,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bF(x,e.u_is_size_feature_constant),u_size_t:new c.b8(x,e.u_size_t),u_size:new c.b8(x,e.u_size),u_camera_to_center_distance:new c.b8(x,e.u_camera_to_center_distance),u_pitch:new c.b8(x,e.u_pitch),u_rotate_symbol:new c.bF(x,e.u_rotate_symbol),u_aspect_ratio:new c.b8(x,e.u_aspect_ratio),u_fade_change:new c.b8(x,e.u_fade_change),u_label_plane_matrix:new c.bH(x,e.u_label_plane_matrix),u_coord_matrix:new c.bH(x,e.u_coord_matrix),u_is_text:new c.bF(x,e.u_is_text),u_pitch_with_map:new c.bF(x,e.u_pitch_with_map),u_is_along_line:new c.bF(x,e.u_is_along_line),u_is_variable_anchor:new c.bF(x,e.u_is_variable_anchor),u_texsize:new c.bK(x,e.u_texsize),u_texture:new c.bF(x,e.u_texture),u_translation:new c.bK(x,e.u_translation),u_pitched_scale:new c.b8(x,e.u_pitched_scale)}),symbolSDF:(x,e)=>({u_is_size_zoom_constant:new c.bF(x,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bF(x,e.u_is_size_feature_constant),u_size_t:new c.b8(x,e.u_size_t),u_size:new c.b8(x,e.u_size),u_camera_to_center_distance:new c.b8(x,e.u_camera_to_center_distance),u_pitch:new c.b8(x,e.u_pitch),u_rotate_symbol:new c.bF(x,e.u_rotate_symbol),u_aspect_ratio:new c.b8(x,e.u_aspect_ratio),u_fade_change:new c.b8(x,e.u_fade_change),u_label_plane_matrix:new c.bH(x,e.u_label_plane_matrix),u_coord_matrix:new c.bH(x,e.u_coord_matrix),u_is_text:new c.bF(x,e.u_is_text),u_pitch_with_map:new c.bF(x,e.u_pitch_with_map),u_is_along_line:new c.bF(x,e.u_is_along_line),u_is_variable_anchor:new c.bF(x,e.u_is_variable_anchor),u_texsize:new c.bK(x,e.u_texsize),u_texture:new c.bF(x,e.u_texture),u_gamma_scale:new c.b8(x,e.u_gamma_scale),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_is_halo:new c.bF(x,e.u_is_halo),u_translation:new c.bK(x,e.u_translation),u_pitched_scale:new c.b8(x,e.u_pitched_scale)}),symbolTextAndIcon:(x,e)=>({u_is_size_zoom_constant:new c.bF(x,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bF(x,e.u_is_size_feature_constant),u_size_t:new c.b8(x,e.u_size_t),u_size:new c.b8(x,e.u_size),u_camera_to_center_distance:new c.b8(x,e.u_camera_to_center_distance),u_pitch:new c.b8(x,e.u_pitch),u_rotate_symbol:new c.bF(x,e.u_rotate_symbol),u_aspect_ratio:new c.b8(x,e.u_aspect_ratio),u_fade_change:new c.b8(x,e.u_fade_change),u_label_plane_matrix:new c.bH(x,e.u_label_plane_matrix),u_coord_matrix:new c.bH(x,e.u_coord_matrix),u_is_text:new c.bF(x,e.u_is_text),u_pitch_with_map:new c.bF(x,e.u_pitch_with_map),u_is_along_line:new c.bF(x,e.u_is_along_line),u_is_variable_anchor:new c.bF(x,e.u_is_variable_anchor),u_texsize:new c.bK(x,e.u_texsize),u_texsize_icon:new c.bK(x,e.u_texsize_icon),u_texture:new c.bF(x,e.u_texture),u_texture_icon:new c.bF(x,e.u_texture_icon),u_gamma_scale:new c.b8(x,e.u_gamma_scale),u_device_pixel_ratio:new c.b8(x,e.u_device_pixel_ratio),u_is_halo:new c.bF(x,e.u_is_halo),u_translation:new c.bK(x,e.u_translation),u_pitched_scale:new c.b8(x,e.u_pitched_scale)}),background:(x,e)=>({u_opacity:new c.b8(x,e.u_opacity),u_color:new c.bG(x,e.u_color)}),backgroundPattern:(x,e)=>({u_opacity:new c.b8(x,e.u_opacity),u_image:new c.bF(x,e.u_image),u_pattern_tl_a:new c.bK(x,e.u_pattern_tl_a),u_pattern_br_a:new c.bK(x,e.u_pattern_br_a),u_pattern_tl_b:new c.bK(x,e.u_pattern_tl_b),u_pattern_br_b:new c.bK(x,e.u_pattern_br_b),u_texsize:new c.bK(x,e.u_texsize),u_mix:new c.b8(x,e.u_mix),u_pattern_size_a:new c.bK(x,e.u_pattern_size_a),u_pattern_size_b:new c.bK(x,e.u_pattern_size_b),u_scale_a:new c.b8(x,e.u_scale_a),u_scale_b:new c.b8(x,e.u_scale_b),u_pixel_coord_upper:new c.bK(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bK(x,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.b8(x,e.u_tile_units_to_pixels)}),terrain:(x,e)=>({u_texture:new c.bF(x,e.u_texture),u_ele_delta:new c.b8(x,e.u_ele_delta),u_fog_matrix:new c.bH(x,e.u_fog_matrix),u_fog_color:new c.bG(x,e.u_fog_color),u_fog_ground_blend:new c.b8(x,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.b8(x,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bG(x,e.u_horizon_color),u_horizon_fog_blend:new c.b8(x,e.u_horizon_fog_blend),u_is_globe_mode:new c.b8(x,e.u_is_globe_mode)}),terrainDepth:(x,e)=>({u_ele_delta:new c.b8(x,e.u_ele_delta)}),terrainCoords:(x,e)=>({u_texture:new c.bF(x,e.u_texture),u_terrain_coords_id:new c.b8(x,e.u_terrain_coords_id),u_ele_delta:new c.b8(x,e.u_ele_delta)}),projectionErrorMeasurement:(x,e)=>({u_input:new c.b8(x,e.u_input),u_output_expected:new c.b8(x,e.u_output_expected)}),atmosphere:(x,e)=>({u_sun_pos:new c.bJ(x,e.u_sun_pos),u_atmosphere_blend:new c.b8(x,e.u_atmosphere_blend),u_globe_position:new c.bJ(x,e.u_globe_position),u_globe_radius:new c.b8(x,e.u_globe_radius),u_inv_proj_matrix:new c.bH(x,e.u_inv_proj_matrix)}),sky:(x,e)=>({u_sky_color:new c.bG(x,e.u_sky_color),u_horizon_color:new c.bG(x,e.u_horizon_color),u_horizon:new c.bK(x,e.u_horizon),u_horizon_normal:new c.bK(x,e.u_horizon_normal),u_sky_horizon_blend:new c.b8(x,e.u_sky_horizon_blend),u_sky_blend:new c.b8(x,e.u_sky_blend)})};class Cf{constructor(e,s,f){this.context=e;const g=e.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Df={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Xp{constructor(e,s,f,g){this.length=s.length,this.attributes=f,this.itemSize=s.bytesPerElement,this.dynamicDraw=g,this.context=e;const w=e.gl;this.buffer=w.createBuffer(),e.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let f=0;f<this.attributes.length;f++){const g=s.attributes[this.attributes[f].name];g!==void 0&&e.enableVertexAttribArray(g)}}setVertexAttribPointers(e,s,f){for(let g=0;g<this.attributes.length;g++){const w=this.attributes[g],S=s.attributes[w.name];S!==void 0&&e.vertexAttribPointer(S,w.components,e[Df[w.type]],!1,this.itemSize,w.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Bn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Jl extends Bn{getDefault(){return c.b7.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Wr extends Bn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class $u extends Bn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Wp extends Bn{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Qp extends Bn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Kp extends Bn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class kf extends Bn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class If extends Bn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Jp extends Bn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class zo extends Bn{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Wc extends Bn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class sl extends Bn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Yu extends Bn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class ol extends Bn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ba extends Bn{getDefault(){return c.b7.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ir extends Bn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class _d extends Bn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class Rf extends Bn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Lo extends Bn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ll extends Bn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class qu extends Bn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Hu extends Bn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Xu extends Bn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class vd extends Bn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class em extends Bn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ec extends Bn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class tc extends Bn{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class xd extends Bn{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const f=this.gl;ca(f)?f.bindVertexArray(e):(s=f.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Aa extends Bn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class zn extends Bn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Qr extends Bn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ua extends Bn{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class nc extends ua{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class ic extends ua{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class bd extends ua{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Wu="Framebuffer is not complete";class wd{constructor(e,s,f,g,w){this.context=e,this.width=s,this.height=f;const S=e.gl,D=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new nc(e,D),g)this.depthAttachment=w?new bd(e,D):new ic(e,D);else if(w)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(Wu)}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const f=this.depthAttachment.get();f&&e.deleteRenderbuffer(f)}e.deleteFramebuffer(this.framebuffer)}}class Qc{constructor(e){var s,f;if(this.gl=e,this.clearColor=new Jl(this),this.clearDepth=new Wr(this),this.clearStencil=new $u(this),this.colorMask=new Wp(this),this.depthMask=new Qp(this),this.stencilMask=new Kp(this),this.stencilFunc=new kf(this),this.stencilOp=new If(this),this.stencilTest=new Jp(this),this.depthRange=new zo(this),this.depthTest=new Wc(this),this.depthFunc=new sl(this),this.blend=new Yu(this),this.blendFunc=new ol(this),this.blendColor=new Ba(this),this.blendEquation=new Ir(this),this.cullFace=new _d(this),this.cullFaceSide=new Rf(this),this.frontFace=new Lo(this),this.program=new ll(this),this.activeTexture=new qu(this),this.viewport=new Hu(this),this.bindFramebuffer=new Xu(this),this.bindRenderbuffer=new vd(this),this.bindTexture=new em(this),this.bindVertexBuffer=new ec(this),this.bindElementBuffer=new tc(this),this.bindVertexArray=new xd(this),this.pixelStoreUnpack=new Aa(this),this.pixelStoreUnpackPremultiplyAlpha=new zn(this),this.pixelStoreUnpackFlipY=new Qr(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),ca(e)){this.HALF_FLOAT=e.HALF_FLOAT;const g=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(f=e.RGB16F)!==null&&f!==void 0?f:g==null?void 0:g.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const g=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new Cf(this,e,s)}createVertexBuffer(e,s,f){return new Xp(this,e,s,f)}createRenderbuffer(e,s,f){const g=this.gl,w=g.createRenderbuffer();return this.bindRenderbuffer.set(w),g.renderbufferStorage(g.RENDERBUFFER,e,s,f),this.bindRenderbuffer.set(null),w}createFramebuffer(e,s,f,g){return new wd(this,e,s,f,g)}clear({color:e,depth:s,stencil:f}){const g=this.gl;let w=0;e&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),f!==void 0&&(w|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(w)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bC(e.blendFunction,ii.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return ca(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return ca(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let rc;function cl(x,e,s,f,g){const w=x.context,S=x.transform,D=w.gl,R=x.useProgram("collisionBox"),N=[];let F=0,G=0;for(let de=0;de<f.length;de++){const ge=f[de],xe=e.getTile(ge).getBucket(s);if(!xe)continue;const be=g?xe.textCollisionBox:xe.iconCollisionBox,Te=xe.collisionCircleArray;Te.length>0&&(N.push({circleArray:Te,circleOffset:G,coord:ge}),F+=Te.length/4,G=F),be&&R.draw(w,D.LINES,fn.disabled,Dn.disabled,x.colorModeForRenderPass(),xn.disabled,Cg(x.transform),x.style.map.terrain&&x.style.map.terrain.getTerrainData(ge),S.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),s.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,null,x.transform.zoom,null,null,be.collisionVertexBuffer)}if(!g||!N.length)return;const Z=x.useProgram("collisionCircle"),K=new c.bP;K.resize(4*F),K._trim();let te=0;for(const de of N)for(let ge=0;ge<de.circleArray.length/4;ge++){const xe=4*ge,be=de.circleArray[xe+0],Te=de.circleArray[xe+1],De=de.circleArray[xe+2],Me=de.circleArray[xe+3];K.emplace(te++,be,Te,De,Me,0),K.emplace(te++,be,Te,De,Me,1),K.emplace(te++,be,Te,De,Me,2),K.emplace(te++,be,Te,De,Me,3)}(!rc||rc.length<2*F)&&(rc=function(de){const ge=2*de,xe=new c.bR;xe.resize(ge),xe._trim();for(let be=0;be<ge;be++){const Te=6*be;xe.uint16[Te+0]=4*be+0,xe.uint16[Te+1]=4*be+1,xe.uint16[Te+2]=4*be+2,xe.uint16[Te+3]=4*be+2,xe.uint16[Te+4]=4*be+3,xe.uint16[Te+5]=4*be+0}return xe}(F));const he=w.createIndexBuffer(rc,!0),ue=w.createVertexBuffer(K,c.bQ.members,!0);for(const de of N){const ge=Af(x.transform);Z.draw(w,D.TRIANGLES,fn.disabled,Dn.disabled,x.colorModeForRenderPass(),xn.disabled,ge,x.style.map.terrain&&x.style.map.terrain.getTerrainData(de.coord),null,s.id,ue,he,c.aG.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,x.transform.zoom,null,null,null)}ue.destroy(),he.destroy()}const No=c.at(new Float32Array(16));function zf(x,e,s,f,g,w){const{horizontalAlign:S,verticalAlign:D}=c.aB(x);return new c.P((-(S-.5)*e/g+f[0])*w,(-(D-.5)*s/g+f[1])*w)}function Kr(x,e,s,f,g,w){const S=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let D=f.mult(w);s||(D=D.rotate(-g));const R=S.add(D);return Je(R.x,R.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(s){const D=Cn(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(x),R=Math.atan(D.y/D.x)+(D.x<0?Math.PI:0);return x.add(f.rotate(R))}return x.add(f)}function Td(x,e,s,f,g,w,S,D,R,N,F,G){const Z=x.text.placedSymbolArray,K=x.text.dynamicLayoutVertexArray,te=x.icon.dynamicLayoutVertexArray,he={};K.clear();for(let ue=0;ue<Z.length;ue++){const de=Z.get(ue),ge=de.hidden||!de.crossTileID||x.allowVerticalPlacement&&!de.placedOrientation?null:f[de.crossTileID];if(ge){const xe=new c.P(de.anchorX,de.anchorY),be={getElevation:G,width:g.width,height:g.height,pitchedLabelPlaneMatrix:w,pitchWithMap:s,transform:g,tileAnchorPoint:xe,translation:N,unwrappedTileID:F},Te=s?Bt(xe.x,xe.y,be):Cn(xe.x,xe.y,be),De=je(g.cameraToCenterDistance,Te.signedDistanceFromCamera);let Me=c.ai(x.textSizeData,D,de)*De/c.av;s&&(Me*=x.tilePixelRatio/S);const{width:Ge,height:Ue,anchor:at,textOffset:st,textBoxScale:it}=ge,At=zf(at,Ge,Ue,st,it,Me),Et=g.getPitchedTextCorrection(xe.x+N[0],xe.y+N[1],F),ut=Kr(Te.point,be,e,At,-g.bearingInRadians,Et),Ft=x.allowVerticalPlacement&&de.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let cn=0;cn<de.numGlyphs;cn++)c.ao(K,ut,Ft);R&&de.associatedIconIndex>=0&&(he[de.associatedIconIndex]={shiftedAnchor:ut,angle:Ft})}else qt(de.numGlyphs,K)}if(R){te.clear();const ue=x.icon.placedSymbolArray;for(let de=0;de<ue.length;de++){const ge=ue.get(de);if(ge.hidden)qt(ge.numGlyphs,te);else{const xe=he[de];if(xe)for(let be=0;be<ge.numGlyphs;be++)c.ao(te,xe.shiftedAnchor,xe.angle);else qt(ge.numGlyphs,te)}}x.icon.dynamicLayoutVertexBuffer.updateData(te)}x.text.dynamicLayoutVertexBuffer.updateData(K)}function Fa(x,e,s){return s.iconsInText&&e?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function Kc(x,e,s,f,g,w,S,D,R,N,F,G,Z){const K=x.context,te=K.gl,he=x.transform,ue=D==="map",de=R==="map",ge=D!=="viewport"&&s.layout.get("symbol-placement")!=="point",xe=ue&&!de&&!ge,be=!s.layout.get("symbol-sort-key").isConstant();let Te=!1;const De=x.getDepthModeForSublayer(0,fn.ReadOnly),Me=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ge=[],Ue=he.getCircleRadiusCorrection();for(const at of f){const st=e.getTile(at),it=st.getBucket(s);if(!it)continue;const At=g?it.text:it.icon;if(!At||!At.segments.get().length||!At.hasVisibleVertices)continue;const Et=At.programConfigurations.get(s.id),ut=g||it.sdfIcons,Ft=g?it.textSizeData:it.iconSizeData,cn=de||he.pitch!==0,In=x.useProgram(Fa(ut,g,it),Et),pn=c.ag(Ft,he.zoom),Xn=x.style.map.terrain&&x.style.map.terrain.getTerrainData(at);let ai,ui,Yn,Wn,Fi=[0,0],lr=null;if(g)ui=st.glyphAtlasTexture,Yn=te.LINEAR,ai=st.glyphAtlasTexture.size,it.iconsInText&&(Fi=st.imageAtlasTexture.size,lr=st.imageAtlasTexture,Wn=cn||x.options.rotating||x.options.zooming||Ft.kind==="composite"||Ft.kind==="camera"?te.LINEAR:te.NEAREST);else{const Pi=s.layout.get("icon-size").constantOr(0)!==1||it.iconsNeedLinear;ui=st.imageAtlasTexture,Yn=ut||x.options.rotating||x.options.zooming||Pi||cn?te.LINEAR:te.NEAREST,ai=st.imageAtlasTexture.size}const gr=c.aw(st,1,x.transform.zoom),$r=Be(ue,x.transform,gr),Js=c.K();c.aj(Js,$r);const hs=ze(de,ue,x.transform,gr),wl=c.ax(he,st,w,S),eo=he.getProjectionData({overscaledTileID:at,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Tl=Me&&it.hasTextData(),ds=s.layout.get("icon-text-fit")!=="none"&&Tl&&it.hasIconData();if(ge){const Pi=x.style.map.terrain?(qi,qn)=>x.style.map.terrain.getElevation(at,qi,qn):null,hi=s.layout.get("text-rotation-alignment")==="map";Ct(it,x,g,$r,Js,de,N,hi,at.toUnwrapped(),he.width,he.height,wl,Pi)}const fs=g&&Me||ds,fa=ge||fs?No:de?$r:x.transform.clipSpaceToPixelsMatrix,to=ut&&s.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let mc;mc=ut?it.iconsInText?Zu(Ft.kind,pn,xe,de,ge,fs,x,fa,hs,wl,ai,Fi,Ue):md(Ft.kind,pn,xe,de,ge,fs,x,fa,hs,wl,g,ai,0,Ue):pd(Ft.kind,pn,xe,de,ge,fs,x,fa,hs,wl,g,ai,Ue);const gc={program:In,buffers:At,uniformValues:mc,projectionData:eo,atlasTexture:ui,atlasTextureIcon:lr,atlasInterpolation:Yn,atlasInterpolationIcon:Wn,isSDF:ut,hasHalo:to};if(be&&it.canOverlap){Te=!0;const Pi=At.segments.get();for(const hi of Pi)Ge.push({segments:new c.aG([hi]),sortKey:hi.sortKey,state:gc,terrainData:Xn})}else Ge.push({segments:At.segments,sortKey:0,state:gc,terrainData:Xn})}Te&&Ge.sort((at,st)=>at.sortKey-st.sortKey);for(const at of Ge){const st=at.state;if(K.activeTexture.set(te.TEXTURE0),st.atlasTexture.bind(st.atlasInterpolation,te.CLAMP_TO_EDGE),st.atlasTextureIcon&&(K.activeTexture.set(te.TEXTURE1),st.atlasTextureIcon&&st.atlasTextureIcon.bind(st.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),st.isSDF){const it=st.uniformValues;st.hasHalo&&(it.u_is_halo=1,ac(st.buffers,at.segments,s,x,st.program,De,F,G,it,st.projectionData,at.terrainData)),it.u_is_halo=0}ac(st.buffers,at.segments,s,x,st.program,De,F,G,st.uniformValues,st.projectionData,at.terrainData)}}function ac(x,e,s,f,g,w,S,D,R,N,F){const G=f.context;g.draw(G,G.gl.TRIANGLES,w,S,D,xn.backCCW,R,F,N,s.id,x.layoutVertexBuffer,x.indexBuffer,e,s.paint,f.transform.zoom,x.programConfigurations.get(s.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function sc(x,e,s,f,g){const w=x.context,S=w.gl,D=Dn.disabled,R=new ii([S.ONE,S.ONE],c.b7.transparent,[!0,!0,!0,!0]),N=e.getBucket(s);if(!N)return;const F=f.key;let G=s.heatmapFbos.get(F);G||(G=Ed(w,e.tileSize,e.tileSize),s.heatmapFbos.set(F,G)),w.bindFramebuffer.set(G.framebuffer),w.viewport.set([0,0,e.tileSize,e.tileSize]),w.clear({color:c.b7.transparent});const Z=N.programConfigurations.get(s.id),K=x.useProgram("heatmap",Z,!g),te=x.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=x.style.map.terrain.getTerrainData(f);K.draw(w,S.TRIANGLES,fn.disabled,D,R,xn.disabled,hd(e,x.transform.zoom,s.paint.get("heatmap-intensity"),1),he,te,s.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,s.paint,x.transform.zoom,Z)}function Qu(x,e,s,f,g){const w=x.context,S=w.gl,D=x.transform;w.setColorMode(x.colorModeForRenderPass());const R=ul(w,e),N=s.key,F=e.heatmapFbos.get(N);if(!F)return;w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,F.colorAttachment.get()),w.activeTexture.set(S.TEXTURE1),R.bind(S.LINEAR,S.CLAMP_TO_EDGE);const G=D.getProjectionData({overscaledTileID:s,applyTerrainMatrix:g,applyGlobeMatrix:!f});x.useProgram("heatmapTexture").draw(w,S.TRIANGLES,fn.disabled,Dn.disabled,x.colorModeForRenderPass(),xn.disabled,dd(x,e,0,1),null,G,e.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments,e.paint,D.zoom),F.destroy(),e.heatmapFbos.delete(N)}function Ed(x,e,s){var f,g;const w=x.gl,S=w.createTexture();w.bindTexture(w.TEXTURE_2D,S),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const D=(f=x.HALF_FLOAT)!==null&&f!==void 0?f:w.UNSIGNED_BYTE,R=(g=x.RGBA16F)!==null&&g!==void 0?g:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,R,e,s,0,w.RGBA,D,null);const N=x.createFramebuffer(e,s,!1,!1);return N.colorAttachment.set(S),N}function ul(x,e){return e.colorRampTexture||(e.colorRampTexture=new Ke(x,e.colorRamp,x.gl.RGBA)),e.colorRampTexture}function $s(x,e,s,f,g){if(!s||!f||!f.imageAtlas)return;const w=f.imageAtlas.patternPositions;let S=w[s.to.toString()],D=w[s.from.toString()];if(!S&&D&&(S=D),!D&&S&&(D=S),!S||!D){const R=g.getPaintProperty(e);S=w[R],D=w[R]}S&&D&&x.setConstantPatternPositions(S,D)}function oc(x,e,s,f,g,w,S,D){const R=x.context.gl,N="fill-pattern",F=s.paint.get(N),G=F&&F.constantOr(1),Z=s.getCrossfadeParameters();let K,te,he,ue,de;const ge=x.transform,xe=s.paint.get("fill-translate"),be=s.paint.get("fill-translate-anchor");S?(te=G&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",K=R.LINES):(te=G?"fillPattern":"fill",K=R.TRIANGLES);const Te=F.constantOr(null);for(const De of f){const Me=e.getTile(De);if(G&&!Me.patternsLoaded())continue;const Ge=Me.getBucket(s);if(!Ge)continue;const Ue=Ge.programConfigurations.get(s.id),at=x.useProgram(te,Ue),st=x.style.map.terrain&&x.style.map.terrain.getTerrainData(De);G&&(x.context.activeTexture.set(R.TEXTURE0),Me.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Ue.updatePaintBuffers(Z)),$s(Ue,N,Te,Me,s);const it=ge.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),At=c.ax(ge,Me,xe,be);if(S){ue=Ge.indexBuffer2,de=Ge.segments2;const ut=[R.drawingBufferWidth,R.drawingBufferHeight];he=te==="fillOutlinePattern"&&G?Sf(x,Z,Me,ut,At):Yc(ut,At)}else ue=Ge.indexBuffer,de=Ge.segments,he=G?Yp(x,Z,Me,At):{u_fill_translate:At};let Et;if(x.renderPass==="translucent"&&D){const[ut]=x.getStencilConfigForOverlapAndUpdateStencilID(f);Et=ut[De.overscaledZ]}else Et=x.stencilModeForClipping(De);at.draw(x.context,K,g,Et,w,xn.backCCW,he,st,it,s.id,Ge.layoutVertexBuffer,ue,de,s.paint,x.transform.zoom,Ue)}}function lc(x,e,s,f,g,w,S,D){const R=x.context,N=R.gl,F="fill-extrusion-pattern",G=s.paint.get(F),Z=G.constantOr(1),K=s.getCrossfadeParameters(),te=s.paint.get("fill-extrusion-opacity"),he=G.constantOr(null),ue=x.transform;for(const de of f){const ge=e.getTile(de),xe=ge.getBucket(s);if(!xe)continue;const be=x.style.map.terrain&&x.style.map.terrain.getTerrainData(de),Te=xe.programConfigurations.get(s.id),De=x.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",Te);Z&&(x.context.activeTexture.set(N.TEXTURE0),ge.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Te.updatePaintBuffers(K));const Me=ue.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!D,applyTerrainMatrix:!0});$s(Te,F,he,ge,s);const Ge=c.ax(ue,ge,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Ue=s.paint.get("fill-extrusion-vertical-gradient"),at=Z?ud(x,Ue,te,Ge,de,K,ge):$p(x,Ue,te,Ge);De.draw(R,R.gl.TRIANGLES,g,w,S,xn.backCCW,at,be,Me,s.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,s.paint,x.transform.zoom,Te,x.style.map.terrain&&xe.centroidVertexBuffer)}}function Jr(x,e,s,f,g,w,S,D,R){var N;const F=x.style.projection,G=x.context,Z=x.transform,K=G.gl,te=x.useProgram("hillshade"),he=!x.options.moving;for(const ue of f){const de=e.getTile(ue),ge=de.fbo;if(!ge)continue;const xe=F.getMeshFromTileID(G,ue.canonical,D,!0,"raster"),be=(N=x.style.map.terrain)===null||N===void 0?void 0:N.getTerrainData(ue);G.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,ge.colorAttachment.get());const Te=Z.getProjectionData({overscaledTileID:ue,aligned:he,applyGlobeMatrix:!R,applyTerrainMatrix:!0});te.draw(G,K.TRIANGLES,w,g[ue.overscaledZ],S,xn.backCCW,Mf(x,de,s),be,Te,s.id,xe.vertexBuffer,xe.indexBuffer,xe.segments)}}const Rr=[new c.P(0,0),new c.P(c.Z,0),new c.P(c.Z,c.Z),new c.P(0,c.Z)];function Ua(x,e,s,f,g,w,S,D,R=!1,N=!1){const F=f[f.length-1].overscaledZ,G=x.context,Z=G.gl,K=x.useProgram("raster"),te=x.transform,he=x.style.projection,ue=x.colorModeForRenderPass(),de=!x.options.moving;for(const ge of f){const xe=x.getDepthModeForSublayer(ge.overscaledZ-F,s.paint.get("raster-opacity")===1?fn.ReadWrite:fn.ReadOnly,Z.LESS),be=e.getTile(ge);be.registerFadeDuration(s.paint.get("raster-fade-duration"));const Te=e.findLoadedParent(ge,0),De=e.findLoadedSibling(ge),Me=Po(be,Te||De||null,e,s,x.transform,x.style.map.terrain);let Ge,Ue;const at=s.paint.get("raster-resampling")==="nearest"?Z.NEAREST:Z.LINEAR;G.activeTexture.set(Z.TEXTURE0),be.texture.bind(at,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),G.activeTexture.set(Z.TEXTURE1),Te?(Te.texture.bind(at,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),Ge=Math.pow(2,Te.tileID.overscaledZ-be.tileID.overscaledZ),Ue=[be.tileID.canonical.x*Ge%1,be.tileID.canonical.y*Ge%1]):be.texture.bind(at,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),be.texture.useMipmap&&G.extTextureFilterAnisotropic&&x.transform.pitch>20&&Z.texParameterf(Z.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax);const st=x.style.map.terrain&&x.style.map.terrain.getTerrainData(ge),it=te.getProjectionData({overscaledTileID:ge,aligned:de,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),At=Dg(Ue||[0,0],Ge||1,Me,s,D),Et=he.getMeshFromTileID(G,ge.canonical,w,S,"raster");K.draw(G,Z.TRIANGLES,xe,g?g[ge.overscaledZ]:Dn.disabled,ue,R?xn.frontCCW:xn.backCCW,At,st,it,s.id,Et.vertexBuffer,Et.indexBuffer,Et.segments)}}function Po(x,e,s,f,g,w){const S=f.paint.get("raster-fade-duration");if(!w&&S>0){const D=U.now(),R=(D-x.timeAdded)/S,N=e?(D-e.timeAdded)/S:-1,F=s.getSource(),G=ja(g,{tileSize:F.tileSize,roundZoom:F.roundZoom}),Z=!e||Math.abs(e.tileID.overscaledZ-G)>Math.abs(x.tileID.overscaledZ-G),K=Z&&x.refreshedUponExpiration?1:c.ae(Z?R:1-N,0,1);return x.refreshedUponExpiration&&R>=1&&(x.refreshedUponExpiration=!1),e?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}const Ys=new c.b7(1,0,0,1),ri=new c.b7(0,1,0,1),hl=new c.b7(0,0,1,1),ha=new c.b7(1,0,1,1),Ku=new c.b7(0,1,1,1);function Mr(x,e,s,f){An(x,0,e+s/2,x.transform.width,s,f)}function Li(x,e,s,f){An(x,e-s/2,0,s,x.transform.height,f)}function An(x,e,s,f,g,w){const S=x.context,D=S.gl;D.enable(D.SCISSOR_TEST),D.scissor(e*x.pixelRatio,s*x.pixelRatio,f*x.pixelRatio,g*x.pixelRatio),S.clear({color:w}),D.disable(D.SCISSOR_TEST)}function os(x,e,s){const f=x.context,g=f.gl,w=x.useProgram("debug"),S=fn.disabled,D=Dn.disabled,R=x.colorModeForRenderPass(),N="$debug",F=x.style.map.terrain&&x.style.map.terrain.getTerrainData(s);f.activeTexture.set(g.TEXTURE0);const G=e.getTileByID(s.key).latestRawTileData,Z=Math.floor((G&&G.byteLength||0)/1024),K=e.getTile(s).tileSize,te=512/Math.min(K,512)*(s.overscaledZ/x.transform.zoom)*.5;let he=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(he+=` => ${s.overscaledZ}`),function(de,ge){de.initDebugOverlayCanvas();const xe=de.debugOverlayCanvas,be=de.context.gl,Te=de.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,xe.width,xe.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(ge,5,5),Te.strokeText(ge,5,5),de.debugOverlayTexture.update(xe),de.debugOverlayTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE)}(x,`${he} ${Z}kB`);const ue=x.transform.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(f,g.TRIANGLES,S,D,ii.alphaBlended,xn.disabled,Uu(c.b7.transparent,te),null,ue,N,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),w.draw(f,g.LINE_STRIP,S,D,R,xn.disabled,Uu(c.b7.red),F,ue,N,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function Ma(x,e,s,f){const{isRenderingGlobe:g}=f,w=x.context,S=w.gl,D=x.transform,R=x.colorModeForRenderPass(),N=x.getDepthModeFor3D(),F=x.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,x.width,x.height]);for(const G of s){const Z=e.getTerrainMesh(G.tileID),K=x.renderToTexture.getTexture(G),te=e.getTerrainData(G.tileID);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,K.texture);const he=e.getMeshFrameDelta(D.zoom),ue=D.calculateFogMatrix(G.tileID.toUnwrapped()),de=Gs(he,ue,x.style.sky,D.pitch,g),ge=D.getProjectionData({overscaledTileID:G.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});F.draw(w,S.TRIANGLES,N,Dn.disabled,R,xn.backCCW,de,te,ge,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments)}}function Ju(x,e){if(!e.mesh){const s=new c.aF;s.emplaceBack(-1,-1),s.emplaceBack(1,-1),s.emplaceBack(1,1),s.emplaceBack(-1,1);const f=new c.aH;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),e.mesh=new nl(x.createVertexBuffer(s,Vs.members),x.createIndexBuffer(f),c.aG.simpleSegment(0,0,s.length,f.length))}return e.mesh}class dl{constructor(e,s){this.context=new Qc(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.at(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ee.maxUnderzooming+ee.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ql}resize(e,s,f){if(this.width=Math.floor(e*f),this.height=Math.floor(s*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const e=this.context,s=new c.aF;s.emplaceBack(0,0),s.emplaceBack(c.Z,0),s.emplaceBack(0,c.Z),s.emplaceBack(c.Z,c.Z),this.tileExtentBuffer=e.createVertexBuffer(s,Vs.members),this.tileExtentSegments=c.aG.simpleSegment(0,0,4,2);const f=new c.aF;f.emplaceBack(0,0),f.emplaceBack(c.Z,0),f.emplaceBack(0,c.Z),f.emplaceBack(c.Z,c.Z),this.debugBuffer=e.createVertexBuffer(f,Vs.members),this.debugSegments=c.aG.simpleSegment(0,0,4,5);const g=new c.bW;g.emplaceBack(0,0,0,0),g.emplaceBack(c.Z,0,c.Z,0),g.emplaceBack(0,c.Z,0,c.Z),g.emplaceBack(c.Z,c.Z,c.Z,c.Z),this.rasterBoundsBuffer=e.createVertexBuffer(g,Ef.members),this.rasterBoundsSegments=c.aG.simpleSegment(0,0,4,2);const w=new c.aF;w.emplaceBack(0,0),w.emplaceBack(c.Z,0),w.emplaceBack(0,c.Z),w.emplaceBack(c.Z,c.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(w,Vs.members),this.rasterBoundsSegmentsPosOnly=c.aG.simpleSegment(0,0,4,5);const S=new c.aF;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(S,Vs.members),this.viewportSegments=c.aG.simpleSegment(0,0,4,2);const D=new c.bX;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(D);const R=new c.aH;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(R);const N=this.context.gl;this.stencilClearMode=new Dn({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.tileExtentMesh=new nl(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.K();c.bO(f,0,this.width,this.height,0,0,1),c.M(f,f,[s.drawingBufferWidth,s.drawingBufferHeight,0]);const g={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(e,s.TRIANGLES,fn.disabled,this.stencilClearMode,ii.disabled,xn.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s,f){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source,this.nextStencilID+s.length>256&&this.clearStencil();const g=this.context;g.setColorMode(ii.disabled),g.setDepthMode(fn.disabled);const w={};for(const S of s)w[S.key]=this.nextStencilID++;this._renderTileMasks(w,s,f,!0),this._renderTileMasks(w,s,f,!1),this._tileClippingMaskIDs=w}_renderTileMasks(e,s,f,g){const w=this.context,S=w.gl,D=this.style.projection,R=this.transform,N=this.useProgram("clippingMask");for(const F of s){const G=e[F.key],Z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),K=D.getMeshFromTileID(this.context,F.canonical,g,!0,"stencil"),te=R.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});N.draw(w,S.TRIANGLES,fn.disabled,new Dn({func:S.ALWAYS,mask:0},G,255,S.KEEP,S.KEEP,S.REPLACE),ii.disabled,f?xn.disabled:xn.backCCW,null,Z,te,"$clipping",K.vertexBuffer,K.indexBuffer,K.segments)}}_renderTilesDepthBuffer(){const e=this.context,s=e.gl,f=this.style.projection,g=this.transform,w=this.useProgram("depth"),S=this.getDepthModeFor3D(),D=Ne(g,{tileSize:g.tileSize});for(const R of D){const N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),F=f.getMeshFromTileID(this.context,R.canonical,!0,!0,"raster"),G=g.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(e,s.TRIANGLES,S,Dn.disabled,ii.disabled,xn.backCCW,null,N,G,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new Dn({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new Dn({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const s=this.context.gl,f=e.sort((S,D)=>D.overscaledZ-S.overscaledZ),g=f[f.length-1].overscaledZ,w=f[0].overscaledZ-g+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let D=0;D<w;D++)S[D+g]=new Dn({func:s.GEQUAL,mask:255},D+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=w,[S,f]}return[{[g]:Dn.disabled},f]}stencilConfigForOverlapTwoPass(e){const s=this.context.gl,f=e.sort((S,D)=>D.overscaledZ-S.overscaledZ),g=f[f.length-1].overscaledZ,w=f[0].overscaledZ-g+1;if(this.clearStencil(),w>1){const S={},D={};for(let R=0;R<w;R++)S[R+g]=new Dn({func:s.GREATER,mask:255},w+1+R,255,s.KEEP,s.KEEP,s.REPLACE),D[R+g]=new Dn({func:s.GREATER,mask:255},1+R,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID=2*w+1,[S,D,f]}return this.nextStencilID=3,[{[g]:new Dn({func:s.GREATER,mask:255},2,255,s.KEEP,s.KEEP,s.REPLACE)},{[g]:new Dn({func:s.GREATER,mask:255},1,255,s.KEEP,s.KEEP,s.REPLACE)},f]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new ii([e.CONSTANT_COLOR,e.ONE],new c.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ii.unblended:ii.alphaBlended}getDepthModeForSublayer(e,s,f){if(!this.opaquePassEnabledForLayer())return fn.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new fn(f||this.context.gl.LEQUAL,s,[g,g])}getDepthModeFor3D(){return new fn(this.context.gl.LEQUAL,fn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){var f,g;this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(U.now()),this.imageManager.beginFrame();const w=this.style._order,S=this.style.sourceCaches,D={},R={},N={},F={isRenderingToTexture:!1,isRenderingGlobe:((f=e.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const Z in S){const K=S[Z];K.used&&K.prepare(this.context),D[Z]=K.getVisibleCoordinates(!1),R[Z]=D[Z].slice().reverse(),N[Z]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Z=0;Z<w.length;Z++)if(this.style._layers[w[Z]].is3D()){this.opaquePassCutoff=Z;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Z of w){const K=this.style._layers[Z];if(!K.hasOffscreenPass()||K.isHidden(this.transform.zoom))continue;const te=R[K.source];(K.type==="custom"||te.length)&&this.renderLayer(this,S[K.source],K,te,F)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:Z=>this.useProgram(Z)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?c.b7.black:c.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Z,K){const te=Z.context,he=te.gl,ue=((De,Me,Ge)=>{const Ue=Math.cos(Me.rollInRadians),at=Math.sin(Me.rollInRadians),st=Xl(Me),it=Me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:De.properties.get("sky-color"),u_horizon_color:De.properties.get("horizon-color"),u_horizon:[(Me.width/2-st*at)*Ge,(Me.height/2+st*Ue)*Ge],u_horizon_normal:[-at,Ue],u_sky_horizon_blend:De.properties.get("sky-horizon-blend")*Me.height/2*Ge,u_sky_blend:it}})(K,Z.style.map.transform,Z.pixelRatio),de=new fn(he.LEQUAL,fn.ReadWrite,[0,1]),ge=Dn.disabled,xe=Z.colorModeForRenderPass(),be=Z.useProgram("sky"),Te=Ju(te,K);be.draw(te,he.TRIANGLES,de,ge,xe,xn.disabled,ue,null,void 0,"sky",Te.vertexBuffer,Te.indexBuffer,Te.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const Z=this.style._layers[w[this.currentLayer]],K=S[Z.source],te=D[Z.source];this._renderTileClippingMasks(Z,te,!1),this.renderLayer(this,K,Z,te,F)}this.renderPass="translucent";let G=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const Z=this.style._layers[w[this.currentLayer]],K=S[Z.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Z,F))continue;this.opaquePassEnabledForLayer()||G||(G=!0,F.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const te=(Z.type==="symbol"?N:R)[Z.source];this._renderTileClippingMasks(Z,D[Z.source],!1),this.renderLayer(this,K,Z,te,F)}if(F.isRenderingGlobe&&function(Z,K,te){const he=Z.context,ue=he.gl,de=Z.useProgram("atmosphere"),ge=new fn(ue.LEQUAL,fn.ReadOnly,[0,1]),xe=Z.transform,be=function(it,At){const Et=it.properties.get("position"),ut=[-Et.x,-Et.y,-Et.z],Ft=c.at(new Float64Array(16));return it.properties.get("anchor")==="map"&&(c.a_(Ft,Ft,At.rollInRadians),c.a$(Ft,Ft,-At.pitchInRadians),c.a_(Ft,Ft,At.bearingInRadians),c.a$(Ft,Ft,At.center.lat*Math.PI/180),c.bm(Ft,Ft,-At.center.lng*Math.PI/180)),c.bV(ut,ut,Ft),ut}(te,Z.transform),Te=xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),De=K.properties.get("atmosphere-blend")*Te.projectionTransition;if(De===0)return;const Me=Bu(xe.worldSize,xe.center.lat),Ge=xe.inverseProjectionMatrix,Ue=new Float64Array(4);Ue[3]=1,c.ap(Ue,Ue,xe.modelViewProjectionMatrix),Ue[0]/=Ue[3],Ue[1]/=Ue[3],Ue[2]/=Ue[3],Ue[3]=1,c.ap(Ue,Ue,Ge),Ue[0]/=Ue[3],Ue[1]/=Ue[3],Ue[2]/=Ue[3],Ue[3]=1;const at=((it,At,Et,ut,Ft)=>({u_sun_pos:it,u_atmosphere_blend:At,u_globe_position:Et,u_globe_radius:ut,u_inv_proj_matrix:Ft}))(be,De,[Ue[0],Ue[1],Ue[2]],Me,Ge),st=Ju(he,K);de.draw(he,ue.TRIANGLES,ge,Dn.disabled,ii.alphaBlended,xn.disabled,at,null,null,"atmosphere",st.vertexBuffer,st.indexBuffer,st.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Z=function(K,te){let he=null;const ue=Object.values(K._layers).flatMap(be=>be.source&&!be.isHidden(te)?[K.sourceCaches[be.source]]:[]),de=ue.filter(be=>be.getSource().type==="vector"),ge=ue.filter(be=>be.getSource().type!=="vector"),xe=be=>{(!he||he.getSource().maxzoom<be.getSource().maxzoom)&&(he=be)};return de.forEach(be=>xe(be)),he||ge.forEach(be=>xe(be)),he}(this.style,this.transform.zoom);Z&&function(K,te,he){for(let ue=0;ue<he.length;ue++)os(K,te,he[ue])}(this,Z,Z.getVisibleCoordinates())}this.options.showPadding&&function(Z){const K=Z.transform.padding;Mr(Z,Z.transform.height-(K.top||0),3,Ys),Mr(Z,K.bottom||0,3,ri),Li(Z,K.left||0,3,hl),Li(Z,Z.transform.width-(K.right||0),3,ha);const te=Z.transform.centerPoint;(function(he,ue,de,ge){An(he,ue-1,de-10,2,20,ge),An(he,ue-10,de-1,20,2,ge)})(Z,te.x,Z.transform.height-te.y,Ku)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=e?!c.bY(s,f):!c.bZ(s,f)),g||(g=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(c.b_(s,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,S){const D=w.context,R=D.gl,N=w.transform,F=ii.unblended,G=new fn(R.LEQUAL,fn.ReadWrite,[0,1]),Z=S.sourceCache.getRenderableTiles(),K=w.useProgram("terrainDepth");D.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),D.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),D.clear({color:c.b7.transparent,depth:1});for(const te of Z){const he=S.getTerrainMesh(te.tileID),ue=S.getTerrainData(te.tileID),de=N.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ge={u_ele_delta:S.getMeshFrameDelta(N.zoom)};K.draw(D,R.TRIANGLES,G,Dn.disabled,F,xn.backCCW,ge,ue,de,"terrain",he.vertexBuffer,he.indexBuffer,he.segments)}D.bindFramebuffer.set(null),D.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,S){const D=w.context,R=D.gl,N=w.transform,F=ii.unblended,G=new fn(R.LEQUAL,fn.ReadWrite,[0,1]),Z=S.getCoordsTexture(),K=S.sourceCache.getRenderableTiles(),te=w.useProgram("terrainCoords");D.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),D.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),D.clear({color:c.b7.transparent,depth:1}),S.coordsIndex=[];for(const he of K){const ue=S.getTerrainMesh(he.tileID),de=S.getTerrainData(he.tileID);D.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,Z.texture);const ge={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(N.zoom)},xe=N.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});te.draw(D,R.TRIANGLES,G,Dn.disabled,F,xn.backCCW,ge,de,xe,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),S.coordsIndex.push(he.tileID.key)}D.bindFramebuffer.set(null),D.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(e,s,f,g,w){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(g||[]).length)&&(this.id=f.id,c.b$(f)?function(S,D,R,N,F,G){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=G,K=Dn.disabled,te=S.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(he,ue,de,ge,xe,be,Te,De,Me){const Ge=ue.transform,Ue=ue.style.map.terrain,at=xe==="map",st=be==="map";for(const it of he){const At=ge.getTile(it),Et=At.getBucket(de);if(!Et||!Et.text||!Et.text.segments.get().length)continue;const ut=c.ag(Et.textSizeData,Ge.zoom),Ft=c.aw(At,1,ue.transform.zoom),cn=Be(at,ue.transform,Ft),In=de.layout.get("icon-text-fit")!=="none"&&Et.hasIconData();if(ut){const pn=Math.pow(2,Ge.zoom-At.tileID.overscaledZ),Xn=Ue?(ai,ui)=>Ue.getElevation(it,ai,ui):null;Td(Et,at,st,Me,Ge,cn,pn,ut,In,c.ax(Ge,At,Te,De),it.toUnwrapped(),Xn)}}}(N,S,R,D,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),F),R.paint.get("icon-opacity").constantOr(1)!==0&&Kc(S,D,R,N,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),K,te,Z),R.paint.get("text-opacity").constantOr(1)!==0&&Kc(S,D,R,N,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),K,te,Z),D.map.showCollisionBoxes&&(cl(S,D,R,N,!0),cl(S,D,R,N,!1))}(e,s,f,g,this.style.placement.variableOffsets,w):c.c0(f)?function(S,D,R,N,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:G}=F,Z=R.paint.get("circle-opacity"),K=R.paint.get("circle-stroke-width"),te=R.paint.get("circle-stroke-opacity"),he=!R.layout.get("circle-sort-key").isConstant();if(Z.constantOr(1)===0&&(K.constantOr(1)===0||te.constantOr(1)===0))return;const ue=S.context,de=ue.gl,ge=S.transform,xe=S.getDepthModeForSublayer(0,fn.ReadOnly),be=Dn.disabled,Te=S.colorModeForRenderPass(),De=[],Me=ge.getCircleRadiusCorrection();for(let Ge=0;Ge<N.length;Ge++){const Ue=N[Ge],at=D.getTile(Ue),st=at.getBucket(R);if(!st)continue;const it=R.paint.get("circle-translate"),At=R.paint.get("circle-translate-anchor"),Et=c.ax(ge,at,it,At),ut=st.programConfigurations.get(R.id),Ft=S.useProgram("circle",ut),cn=st.layoutVertexBuffer,In=st.indexBuffer,pn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ue),Xn={programConfiguration:ut,program:Ft,layoutVertexBuffer:cn,indexBuffer:In,uniformValues:qc(S,at,R,Et,Me),terrainData:pn,projectionData:ge.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!G,applyTerrainMatrix:!0})};if(he){const ai=st.segments.get();for(const ui of ai)De.push({segments:new c.aG([ui]),sortKey:ui.sortKey,state:Xn})}else De.push({segments:st.segments,sortKey:0,state:Xn})}he&&De.sort((Ge,Ue)=>Ge.sortKey-Ue.sortKey);for(const Ge of De){const{programConfiguration:Ue,program:at,layoutVertexBuffer:st,indexBuffer:it,uniformValues:At,terrainData:Et,projectionData:ut}=Ge.state;at.draw(ue,de.TRIANGLES,xe,be,Te,xn.backCCW,At,Et,ut,R.id,st,it,Ge.segments,R.paint,S.transform.zoom,Ue)}}(e,s,f,g,w):c.c1(f)?function(S,D,R,N,F){if(R.paint.get("heatmap-opacity")===0)return;const G=S.context,{isRenderingToTexture:Z,isRenderingGlobe:K}=F;if(S.style.map.terrain){for(const te of N){const he=D.getTile(te);D.hasRenderableParent(te)||(S.renderPass==="offscreen"?sc(S,he,R,te,K):S.renderPass==="translucent"&&Qu(S,R,te,Z,K))}G.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(te,he,ue,de){const ge=te.context,xe=ge.gl,be=te.transform,Te=Dn.disabled,De=new ii([xe.ONE,xe.ONE],c.b7.transparent,[!0,!0,!0,!0]);(function(Me,Ge,Ue){const at=Me.gl;Me.activeTexture.set(at.TEXTURE1),Me.viewport.set([0,0,Ge.width/4,Ge.height/4]);let st=Ue.heatmapFbos.get(c.bS);st?(at.bindTexture(at.TEXTURE_2D,st.colorAttachment.get()),Me.bindFramebuffer.set(st.framebuffer)):(st=Ed(Me,Ge.width/4,Ge.height/4),Ue.heatmapFbos.set(c.bS,st))})(ge,te,ue),ge.clear({color:c.b7.transparent});for(let Me=0;Me<de.length;Me++){const Ge=de[Me];if(he.hasRenderableParent(Ge))continue;const Ue=he.getTile(Ge),at=Ue.getBucket(ue);if(!at)continue;const st=at.programConfigurations.get(ue.id),it=te.useProgram("heatmap",st),At=be.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Et=be.getCircleRadiusCorrection();it.draw(ge,xe.TRIANGLES,fn.disabled,Te,De,xn.backCCW,hd(Ue,be.zoom,ue.paint.get("heatmap-intensity"),Et),null,At,ue.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,ue.paint,be.zoom,st)}ge.viewport.set([0,0,te.width,te.height])}(S,D,R,N):S.renderPass==="translucent"&&function(te,he){const ue=te.context,de=ue.gl;ue.setColorMode(te.colorModeForRenderPass());const ge=he.heatmapFbos.get(c.bS);ge&&(ue.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,ge.colorAttachment.get()),ue.activeTexture.set(de.TEXTURE1),ul(ue,he).bind(de.LINEAR,de.CLAMP_TO_EDGE),te.useProgram("heatmapTexture").draw(ue,de.TRIANGLES,fn.disabled,Dn.disabled,te.colorModeForRenderPass(),xn.disabled,dd(te,he,0,1),null,null,he.id,te.viewportBuffer,te.quadTriangleIndexBuffer,te.viewportSegments,he.paint,te.transform.zoom))}(S,R)}(e,s,f,g,w):c.c2(f)?function(S,D,R,N,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:G}=F,Z=R.paint.get("line-opacity"),K=R.paint.get("line-width");if(Z.constantOr(1)===0||K.constantOr(1)===0)return;const te=S.getDepthModeForSublayer(0,fn.ReadOnly),he=S.colorModeForRenderPass(),ue=R.paint.get("line-dasharray"),de=R.paint.get("line-pattern"),ge=de.constantOr(1),xe=R.paint.get("line-gradient"),be=R.getCrossfadeParameters(),Te=ge?"linePattern":ue?"lineSDF":xe?"lineGradient":"line",De=S.context,Me=De.gl,Ge=S.transform;let Ue=!0;for(const at of N){const st=D.getTile(at);if(ge&&!st.patternsLoaded())continue;const it=st.getBucket(R);if(!it)continue;const At=it.programConfigurations.get(R.id),Et=S.context.program.get(),ut=S.useProgram(Te,At),Ft=Ue||ut.program!==Et,cn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(at),In=de.constantOr(null);if(In&&st.imageAtlas){const Yn=st.imageAtlas,Wn=Yn.patternPositions[In.to.toString()],Fi=Yn.patternPositions[In.from.toString()];Wn&&Fi&&At.setConstantPatternPositions(Wn,Fi)}const pn=Ge.getProjectionData({overscaledTileID:at,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),Xn=Ge.getPixelScale(),ai=ge?Hc(S,st,R,Xn,be):ue?Hp(S,st,R,Xn,ue,be):xe?qp(S,st,R,Xn,it.lineClipsArray.length):fd(S,st,R,Xn);if(ge)De.activeTexture.set(Me.TEXTURE0),st.imageAtlasTexture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE),At.updatePaintBuffers(be);else if(ue&&(Ft||S.lineAtlas.dirty))De.activeTexture.set(Me.TEXTURE0),S.lineAtlas.bind(De);else if(xe){const Yn=it.gradients[R.id];let Wn=Yn.texture;if(R.gradientVersion!==Yn.version){let Fi=256;if(R.stepInterpolant){const lr=D.getSource().maxzoom,gr=at.canonical.z===lr?Math.ceil(1<<S.transform.maxZoom-at.canonical.z):1;Fi=c.ae(c.bT(it.maxLineLength/c.Z*1024*gr),256,De.maxTextureSize)}Yn.gradient=c.bU({expression:R.gradientExpression(),evaluationKey:"lineProgress",resolution:Fi,image:Yn.gradient||void 0,clips:it.lineClipsArray}),Yn.texture?Yn.texture.update(Yn.gradient):Yn.texture=new Ke(De,Yn.gradient,Me.RGBA),Yn.version=R.gradientVersion,Wn=Yn.texture}De.activeTexture.set(Me.TEXTURE0),Wn.bind(R.stepInterpolant?Me.NEAREST:Me.LINEAR,Me.CLAMP_TO_EDGE)}let ui;if(G){const[Yn]=S.getStencilConfigForOverlapAndUpdateStencilID(N);ui=Yn[at.overscaledZ]}else ui=S.stencilModeForClipping(at);ut.draw(De,Me.TRIANGLES,te,ui,he,xn.disabled,ai,cn,pn,R.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,R.paint,S.transform.zoom,At,it.layoutVertexBuffer2),Ue=!1}}(e,s,f,g,w):c.c3(f)?function(S,D,R,N,F){const G=R.paint.get("fill-color"),Z=R.paint.get("fill-opacity");if(Z.constantOr(1)===0)return;const{isRenderingToTexture:K}=F,te=S.colorModeForRenderPass(),he=R.paint.get("fill-pattern"),ue=S.opaquePassEnabledForLayer()&&!he.constantOr(1)&&G.constantOr(c.b7.transparent).a===1&&Z.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ue){const de=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?fn.ReadWrite:fn.ReadOnly);oc(S,D,R,N,de,te,!1,K)}if(S.renderPass==="translucent"&&R.paint.get("fill-antialias")){const de=S.getDepthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,fn.ReadOnly);oc(S,D,R,N,de,te,!0,K)}}(e,s,f,g,w):c.c4(f)?function(S,D,R,N,F){const G=R.paint.get("fill-extrusion-opacity");if(G===0)return;const{isRenderingToTexture:Z}=F;if(S.renderPass==="translucent"){const K=new fn(S.context.gl.LEQUAL,fn.ReadWrite,S.depthRangeFor3D);if(G!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))lc(S,D,R,N,K,Dn.disabled,ii.disabled,Z),lc(S,D,R,N,K,S.stencilModeFor3D(),S.colorModeForRenderPass(),Z);else{const te=S.colorModeForRenderPass();lc(S,D,R,N,K,Dn.disabled,te,Z)}}}(e,s,f,g,w):c.c5(f)?function(S,D,R,N,F){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:G}=F,Z=S.context,K=S.style.projection.useSubdivision,te=S.getDepthModeForSublayer(0,fn.ReadOnly),he=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ue,de,ge,xe,be,Te,De){const Me=ue.context,Ge=Me.gl;for(const Ue of ge){const at=de.getTile(Ue),st=at.dem;if(!st||!st.data||!at.needsHillshadePrepare)continue;const it=st.dim,At=st.stride,Et=st.getPixels();if(Me.activeTexture.set(Ge.TEXTURE1),Me.pixelStoreUnpackPremultiplyAlpha.set(!1),at.demTexture=at.demTexture||ue.getTileTexture(At),at.demTexture){const Ft=at.demTexture;Ft.update(Et,{premultiply:!1}),Ft.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE)}else at.demTexture=new Ke(Me,Et,Ge.RGBA,{premultiply:!1}),at.demTexture.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE);Me.activeTexture.set(Ge.TEXTURE0);let ut=at.fbo;if(!ut){const Ft=new Ke(Me,{width:it,height:it,data:null},Ge.RGBA);Ft.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),ut=at.fbo=Me.createFramebuffer(it,it,!0,!1),ut.colorAttachment.set(Ft.texture)}Me.bindFramebuffer.set(ut.framebuffer),Me.viewport.set([0,0,it,it]),ue.useProgram("hillshadePrepare").draw(Me,Ge.TRIANGLES,be,Te,De,xn.disabled,Ql(at.tileID,st),null,null,xe.id,ue.rasterBoundsBuffer,ue.quadTriangleIndexBuffer,ue.rasterBoundsSegments),at.needsHillshadePrepare=!1}})(S,D,N,R,te,Dn.disabled,he),Z.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(K){const[ue,de,ge]=S.stencilConfigForOverlapTwoPass(N);Jr(S,D,R,ge,ue,te,he,!1,G),Jr(S,D,R,ge,de,te,he,!0,G)}else{const[ue,de]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Jr(S,D,R,de,ue,te,he,!1,G)}}(e,s,f,g,w):c.c6(f)?function(S,D,R,N,F){if(S.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!N.length)return;const{isRenderingToTexture:G}=F,Z=D.getSource(),K=S.style.projection.useSubdivision;if(Z instanceof rr)Ua(S,D,R,N,null,!1,!1,Z.tileCoords,Z.flippedWindingOrder,G);else if(K){const[te,he,ue]=S.stencilConfigForOverlapTwoPass(N);Ua(S,D,R,ue,te,!1,!0,Rr,!1,G),Ua(S,D,R,ue,he,!0,!0,Rr,!1,G)}else{const[te,he]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Ua(S,D,R,he,te,!1,!0,Rr,!1,G)}}(e,s,f,g,w):c.c7(f)?function(S,D,R,N,F){const G=R.paint.get("background-color"),Z=R.paint.get("background-opacity");if(Z===0)return;const{isRenderingToTexture:K}=F,te=S.context,he=te.gl,ue=S.style.projection,de=S.transform,ge=de.tileSize,xe=R.paint.get("background-pattern");if(S.isPatternMissing(xe))return;const be=!xe&&G.a===1&&Z===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==be)return;const Te=Dn.disabled,De=S.getDepthModeForSublayer(0,be==="opaque"?fn.ReadWrite:fn.ReadOnly),Me=S.colorModeForRenderPass(),Ge=S.useProgram(xe?"backgroundPattern":"background"),Ue=N||Ne(de,{tileSize:ge,terrain:S.style.map.terrain});xe&&(te.activeTexture.set(he.TEXTURE0),S.imageManager.bind(S.context));const at=R.getCrossfadeParameters();for(const st of Ue){const it=de.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!K,applyTerrainMatrix:!0}),At=xe?Gu(Z,S,xe,{tileID:st,tileSize:ge},at):gd(Z,G),Et=S.style.map.terrain&&S.style.map.terrain.getTerrainData(st),ut=ue.getMeshFromTileID(te,st.canonical,!1,!0,"raster");Ge.draw(te,he.TRIANGLES,De,Te,Me,xn.backCCW,At,Et,it,R.id,ut.vertexBuffer,ut.indexBuffer,ut.segments)}}(e,0,f,g,w):c.c8(f)&&function(S,D,R,N){const{isRenderingGlobe:F}=N,G=S.context,Z=R.implementation,K=S.style.projection,te=S.transform,he=te.getProjectionDataForCustomLayer(F),ue={farZ:te.farZ,nearZ:te.nearZ,fov:te.fov*Math.PI/180,modelViewProjectionMatrix:te.modelViewProjectionMatrix,projectionMatrix:te.projectionMatrix,shaderData:{variantName:K.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${K.shaderPreludeCode.vertexSource}`,define:K.shaderDefine},defaultProjectionData:he},de=Z.renderingMode?Z.renderingMode:"2d";if(S.renderPass==="offscreen"){const ge=Z.prerender;ge&&(S.setCustomLayerDefaults(),G.setColorMode(S.colorModeForRenderPass()),ge.call(Z,G.gl,ue),G.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),G.setColorMode(S.colorModeForRenderPass()),G.setStencilMode(Dn.disabled);const ge=de==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,fn.ReadOnly);G.setDepthMode(ge),Z.render(G.gl,ue),G.setDirty(),S.setBaseState(),G.bindFramebuffer.set(null)}}(e,0,f,w))}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),f=this.imageManager.getPattern(e.to.toString());return!s||!f}useProgram(e,s,f=!1){this.cache=this.cache||{};const g=!!this.style.map.terrain,w=this.style.projection,S=e+(s?s.cacheKey:"")+`/${f?Hl:w.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(g?"/terrain":"");return this.cache[S]||(this.cache[S]=new Fu(this.context,$i[e],s,yd[e],this._showOverdrawInspector,g,f?$i.projectionMercator:w.shaderPreludeCode,f?oa:w.shaderDefine)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ke(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}function Sd(x,e){let s,f=!1,g=null,w=null;const S=()=>{g=null,f&&(x.apply(w,s),g=setTimeout(S,e),f=!1)};return(...D)=>(f=!0,w=this,s=D,g||S(),g)}class Ad{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let f;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(!this._isValidHash(s))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:f,pitch:+(s[4]||0)}),!0},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const f=s.join("/");let g=f;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${f}`);let w=window.location.hash.replace(g,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let S=window.location.href.replace(/(#.+)?$/,w);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=Sd(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,g),S=Math.round(s.lng*w)/w,D=Math.round(s.lat*w)/w,R=this._map.getBearing(),N=this._map.getPitch();let F="";if(F+=e?`/${S}/${D}/${f}`:`${f}/${D}/${S}`,(R||N)&&(F+="/"+Math.round(10*R)/10),N&&(F+=`/${Math.round(N)}`),this._hashName){const G=this._hashName;let Z=!1;const K=window.location.hash.slice(1).split("&").map(te=>{const he=te.split("=")[0];return he===G?(Z=!0,`${he}=${F}`):te}).filter(te=>te);return Z||K.push(`${G}=${F}`),`#${K.join("&")}`}return`#${F}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.Q(+e[2],+e[1])}catch{return!1}const s=+e[0],f=+(e[3]||0),g=+(e[4]||0);return s>=this._map.getMinZoom()&&s<=this._map.getMaxZoom()&&f>=-180&&f<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const qs={linearity:.3,easing:c.c9(0,0,.3,1)},ls=c.e({deceleration:2500,maxSpeed:1400},qs),Lf=c.e({deceleration:20,maxSpeed:1400},qs),Jc=c.e({deceleration:1e3,maxSpeed:360},qs),Md=c.e({deceleration:1e3,maxSpeed:90},qs),fl=c.e({deceleration:1e3,maxSpeed:360},qs);class Hs{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:U.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=U.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)s.zoom+=w.zoomDelta||0,s.bearing+=w.bearingDelta||0,s.pitch+=w.pitchDelta||0,s.roll+=w.rollDelta||0,w.panDelta&&s.pan._add(w.panDelta),w.around&&(s.around=w.around),w.pinchAround&&(s.pinchAround=w.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(s.pan.mag()){const w=da(s.pan.mag(),f,c.e({},ls,e||{})),S=s.pan.mult(w.amount/s.pan.mag()),D=this._map.cameraHelper.handlePanInertia(S,this._map.transform);g.center=D.easingCenter,g.offset=D.easingOffset,Ca(g,w)}if(s.zoom){const w=da(s.zoom,f,Lf);g.zoom=this._map.transform.zoom+w.amount,Ca(g,w)}if(s.bearing){const w=da(s.bearing,f,Jc);g.bearing=this._map.transform.bearing+c.ae(w.amount,-179,179),Ca(g,w)}if(s.pitch){const w=da(s.pitch,f,Md);g.pitch=this._map.transform.pitch+w.amount,Ca(g,w)}if(s.roll){const w=da(s.roll,f,fl);g.roll=this._map.transform.roll+c.ae(w.amount,-179,179),Ca(g,w)}if(g.zoom||g.bearing){const w=s.pinchAround===void 0?s.around:s.pinchAround;g.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),c.e(g,{noMoveStart:!0})}}function Ca(x,e){(!x.duration||x.duration<e.duration)&&(x.duration=e.duration,x.easing=e.easing)}function da(x,e,s){const{maxSpeed:f,linearity:g,deceleration:w}=s,S=c.ae(x*g/(e/1e3),-f,f),D=Math.abs(S)/(w*g);return{easing:s.easing,duration:1e3*D,amount:S*(D/2)}}class Cr extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,f,g={}){f=f instanceof MouseEvent?f:new MouseEvent(e,f);const w=V.mousePos(s.getCanvas(),f),S=s.unproject(w);super(e,c.e({point:w,lngLat:S,originalEvent:f},g)),this._defaultPrevented=!1,this.target=s}}class pl extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,f){const g=e==="touchend"?f.changedTouches:f.touches,w=V.touchPos(s.getCanvasContainer(),g),S=w.map(R=>s.unproject(R)),D=w.reduce((R,N,F,G)=>R.add(N.div(G.length)),new c.P(0,0));super(e,{points:w,point:D,lngLats:S,lngLat:s.unproject(D),originalEvent:f}),this._defaultPrevented=!1}}class Gr extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,f){super(e,{originalEvent:f}),this._defaultPrevented=!1}}class Da{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Gr(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new Cr(e.type,this._map,e))}mouseup(e){this._map.fire(new Cr(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Cr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Cr(e.type,this._map,e))}mouseover(e){this._map.fire(new Cr(e.type,this._map,e))}mouseout(e){this._map.fire(new Cr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new pl(e.type,this._map,e))}touchmove(e){this._map.fire(new pl(e.type,this._map,e))}touchend(e){this._map.fire(new pl(e.type,this._map,e))}touchcancel(e){this._map.fire(new pl(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ml{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Cr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Cr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ei{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class Xs{constructor(e,s){this._map=e,this._tr=new ei(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(V.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const f=s;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const w=Math.min(g.x,f.x),S=Math.max(g.x,f.x),D=Math.min(g.y,f.y),R=Math.max(g.y,f.y);V.setTransform(this._box,`translate(${w}px,${D}px)`),this._box.style.width=S-w+"px",this._box.style.height=R-D+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const f=this._startPos,g=s;if(this.reset(),V.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:w=>w.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new c.l(e,{originalEvent:s}))}}function Cd(x,e){if(x.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${e.length}`);const s={};for(let f=0;f<x.length;f++)s[x[f].identifier]=e[f];return s}class kg{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const w=new c.P(0,0);for(const S of g)w._add(S);return w.div(g.length)}(s),this.touches=Cd(f,s)))}touchmove(e,s,f){if(this.aborted||!this.centroid)return;const g=Cd(f,s);for(const w in this.touches){const S=g[w];(!S||S.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(e,s,f){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Nf{constructor(e){this.singleTap=new kg(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,f){this.singleTap.touchstart(e,s,f)}touchmove(e,s,f){this.singleTap.touchmove(e,s,f)}touchend(e,s,f){const g=this.singleTap.touchend(e,s,f);if(g){const w=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(g)<30;if(w&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Ig{constructor(e){this._tr=new ei(e),this._zoomIn=new Nf({numTouches:1,numTaps:2}),this._zoomOut=new Nf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,f){this._zoomIn.touchstart(e,s,f),this._zoomOut.touchstart(e,s,f)}touchmove(e,s,f){this._zoomIn.touchmove(e,s,f),this._zoomOut.touchmove(e,s,f)}touchend(e,s,f){const g=this._zoomIn.touchend(e,s,f),w=this._zoomOut.touchend(e,s,f),S=this._tr;return g?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(g)},{originalEvent:e})}):w?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(w)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ni{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.rollDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(s)?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const g=Array.isArray(s)?s[0]:s;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&V.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const cc={0:1,2:2};class zr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=V.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(s,f){const g=cc[f];return s.buttons===void 0||(s.buttons&g)!==g}(e,this._eventButton)}isValidEndEvent(e){return V.mouseButton(e)===this._eventButton}}class Lt{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Dd{constructor(e=new zr({checkCorrectEvent:()=>!0}),s=new Lt){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=s}_executeRelevantHandler(e,s,f){return e instanceof MouseEvent?s(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?f(e):void 0}startMove(e){this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.startMove(s),s=>this.oneFingerTouchMoveStateManager.startMove(s))}endMove(e){this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.endMove(s),s=>this.oneFingerTouchMoveStateManager.endMove(s))}isValidStartEvent(e){return this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.isValidStartEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidStartEvent(s))}isValidMoveEvent(e){return this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.isValidMoveEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(s))}isValidEndEvent(e){return this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.isValidEndEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidEndEvent(s))}}const cs=x=>{x.mousedown=x.dragStart,x.mousemoveWindow=x.dragMove,x.mouseup=x.dragEnd,x.contextmenu=e=>{e.preventDefault()}};class uc{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,f){return this._calculateTransform(e,s,f)}touchmove(e,s,f){if(this._active){if(!this._shouldBePrevented(f.length))return e.preventDefault(),this._calculateTransform(e,s,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,f){this._calculateTransform(e,s,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,f){f.length>0&&(this._active=!0);const g=Cd(f,s),w=new c.P(0,0),S=new c.P(0,0);let D=0;for(const N in g){const F=g[N],G=this._touches[N];G&&(w._add(F),S._add(F.sub(G)),D++,g[N]=F)}if(this._touches=g,this._shouldBePrevented(D)||!S.mag())return;const R=S.div(D);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(D),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,f){if(!this._firstTwoTouches)return;e.preventDefault();const[g,w]=this._firstTwoTouches,S=Oo(f,s,g),D=Oo(f,s,w);if(!S||!D)return;const R=this._aroundCenter?null:S.add(D).div(2);return this._move([S,D],R,e)}touchend(e,s,f){if(!this._firstTwoTouches)return;const[g,w]=this._firstTwoTouches,S=Oo(f,s,g),D=Oo(f,s,w);S&&D||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Oo(x,e,s){for(let f=0;f<x.length;f++)if(x[f].identifier===s)return e[f]}function Pf(x,e){return Math.log(x/e)/Math.LN2}class bn extends hc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const f=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Pf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Pf(this._distance,f),pinchAround:s}}}function Ws(x,e){return 180*x.angleWith(e)/Math.PI}class kd extends hc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,f){const g=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ws(this._vector,g),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,f=Ws(e,this._startVector);return Math.abs(f)<s}}function gl(x){return Math.abs(x.y)>Math.abs(x.x)}class Of extends hc{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,f){super.touchstart(e,s,f),this._currentTouchCount=f.length}_start(e){this._lastPoints=e,gl(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=e[0].sub(this._lastPoints[0]),w=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,w,f.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(g.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,f){if(this._valid!==void 0)return this._valid;const g=e.mag()>=2,w=s.mag()>=2;if(!g&&!w)return;if(!g||!w)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=e.y>0==s.y>0;return gl(e)&&gl(s)&&S}}const eh={panStep:100,bearingStep:15,pitchStep:10};class Id{constructor(e){this._tr=new ei(e);const s=eh;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,f=0,g=0,w=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?f=-1:(e.preventDefault(),w=-1);break;case 39:e.shiftKey?f=1:(e.preventDefault(),w=1);break;case 38:e.shiftKey?g=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?g=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:D=>{const R=this._tr;D.easeTo({duration:300,easeId:"keyboardHandler",easing:eu,zoom:s?Math.round(R.zoom)+s*(e.shiftKey?2:1):R.zoom,bearing:R.bearing+f*this._bearingStep,pitch:R.pitch+g*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:R.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function eu(x){return x*(2-x)}const th=4.000244140625;class jf{constructor(e,s){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=e,this._tr=new ei(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const f=U.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,s!==0&&s%th==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(g*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=V.mousePos(this._map.getCanvas(),e),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(c.Q.convert(f.center)):s,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const D=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=D),typeof this._targetZoom=="number"&&(this._targetZoom+=D)}if(this._delta!==0){const D=this._type==="wheel"&&Math.abs(this._delta)>th?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*D)));this._delta<0&&R!==0&&(R=1/R);const N=typeof this._targetZoom!="number"?e.scale:c.aI(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,c.ab(N*R))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,f=this._startZoom,g=this._easing;let w,S=!1;if(this._type==="wheel"&&f&&g){const D=U.now()-this._lastWheelEventTime,R=Math.min((D+5)/200,1),N=g(R);w=c.B.number(f,s,N),R<1?this._frameId||(this._frameId=!0):S=!0}else w=s,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!S,zoomDelta:w-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=c.cb;if(this._prevEase){const f=this._prevEase,g=(U.now()-f.start)/f.duration,w=f.easing(g+.01)-f.easing(g),S=.27/Math.sqrt(w*w+1e-4)*.01,D=Math.sqrt(.0729-S*S);s=c.c9(S,D,.25,1)}return this._prevEase={start:U.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class tu{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class tm{constructor(e){this._tr=new ei(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nh{constructor(){this._tap=new Nf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,f){if(!this._swipePoint)if(this._tapTime){const g=s[0],w=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(g)<30;w&&S?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(e,s,f)}touchmove(e,s,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=s[0],w=g.y-this._swipePoint.y;return this._swipePoint=g,e.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(e,s,f)}touchend(e,s,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(e,s,f);g&&(this._tapTime=e.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qs{constructor(e,s,f){this._el=e,this._mousePan=s,this._touchPan=f}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ci{constructor(e,s,f,g){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=s,this._mousePitch=f,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Va{constructor(e,s,f,g){this._el=e,this._touchZoom=s,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class nu{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=s,this._container.appendChild(g);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=f,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const dc=x=>x.zoom||x.drag||x.roll||x.pitch||x.rotate;class jo extends c.l{}function us(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta||x.rollDelta}class ih{constructor(e,s){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,w)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=g.type==="renderFrame"?void 0:g,D={needsRenderFrame:!1},R={},N={};for(const{handlerName:Z,handler:K,allowed:te}of this._handlers){if(!K.isEnabled())continue;let he;if(this._blockedByActive(N,te,Z))K.reset();else if(K[w||g.type]){if(c.cc(g,w||g.type)){const ue=V.mousePos(this._map.getCanvas(),g);he=K[w||g.type](g,ue)}else if(c.cd(g,w||g.type)){const ue=this._getMapTouches(g.touches),de=V.touchPos(this._map.getCanvas(),ue);he=K[w||g.type](g,de,ue)}else c.ce(w||g.type)||(he=K[w||g.type](g));this.mergeHandlerResult(D,R,he,Z,S),he&&he.needsRenderFrame&&this._triggerRenderFrame()}(he||K.isActive())&&(N[Z]=K)}const F={};for(const Z in this._previousActiveHandlers)N[Z]||(F[Z]=S);this._previousActiveHandlers=N,(Object.keys(F).length||us(D))&&(this._changes.push([D,R,F]),this._triggerRenderFrame()),(Object.keys(N).length||us(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=D;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Hs(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,w,S]of this._listeners)V.addEventListener(g,w,g===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,s,f]of this._listeners)V.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(e){const s=this._map,f=s.getCanvasContainer();this._add("mapEvent",new Da(s,e));const g=s.boxZoom=new Xs(s,e);this._add("boxZoom",g),e.interactive&&e.boxZoom&&g.enable();const w=s.cooperativeGestures=new nu(s,e.cooperativeGestures);this._add("cooperativeGestures",w),e.cooperativeGestures&&w.enable();const S=new Ig(s),D=new tm(s);s.doubleClickZoom=new tu(D,S),this._add("tapZoom",S),this._add("clickZoom",D),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const R=new nh;this._add("tapDragZoom",R);const N=s.touchPitch=new Of(s);this._add("touchPitch",N),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const F=()=>s.project(s.getCenter()),G=function({enable:be,clickTolerance:Te,aroundCenter:De=!0,minPixelCenterThreshold:Me=100,rotateDegreesPerPixelMoved:Ge=.8},Ue){const at=new zr({checkCorrectEvent:st=>V.mouseButton(st)===0&&st.ctrlKey||V.mouseButton(st)===2&&!st.ctrlKey});return new Ni({clickTolerance:Te,move:(st,it)=>{const At=Ue();if(De&&Math.abs(At.y-st.y)>Me)return{bearingDelta:c.ca(new c.P(st.x,it.y),it,At)};let Et=(it.x-st.x)*Ge;return De&&it.y<At.y&&(Et=-Et),{bearingDelta:Et}},moveStateManager:at,enable:be,assignEvents:cs})}(e,F),Z=function({enable:be,clickTolerance:Te,pitchDegreesPerPixelMoved:De=-.5}){const Me=new zr({checkCorrectEvent:Ge=>V.mouseButton(Ge)===0&&Ge.ctrlKey||V.mouseButton(Ge)===2});return new Ni({clickTolerance:Te,move:(Ge,Ue)=>({pitchDelta:(Ue.y-Ge.y)*De}),moveStateManager:Me,enable:be,assignEvents:cs})}(e),K=function({enable:be,clickTolerance:Te,rollDegreesPerPixelMoved:De=.3},Me){const Ge=new zr({checkCorrectEvent:Ue=>V.mouseButton(Ue)===2&&Ue.ctrlKey});return new Ni({clickTolerance:Te,move:(Ue,at)=>{const st=Me();let it=(at.x-Ue.x)*De;return at.y<st.y&&(it=-it),{rollDelta:it}},moveStateManager:Ge,enable:be,assignEvents:cs})}(e,F);s.dragRotate=new ci(e,G,Z,K),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",Z,["mouseRotate","mouseRoll"]),this._add("mouseRoll",K,["mousePitch"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const te=function({enable:be,clickTolerance:Te}){const De=new zr({checkCorrectEvent:Me=>V.mouseButton(Me)===0&&!Me.ctrlKey});return new Ni({clickTolerance:Te,move:(Me,Ge)=>({around:Ge,panDelta:Ge.sub(Me)}),activateOnStart:!0,moveStateManager:De,enable:be,assignEvents:cs})}(e),he=new uc(e,s);s.dragPan=new Qs(f,te,he),this._add("mousePan",te),this._add("touchPan",he,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const ue=new kd,de=new bn;s.touchZoomRotate=new Va(f,de,ue,R),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const ge=s.scrollZoom=new jf(s,()=>this._triggerRenderFrame());this._add("scrollZoom",ge,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const xe=s.keyboard=new Id(s);this._add("keyboard",xe),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new ml(s))}_add(e,s,f){this._handlers.push({handlerName:e,handler:s,allowed:f}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!dc(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,f){for(const g in e)if(g!==f&&(!s||s.indexOf(g)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const f of e)this._el.contains(f.target)&&s.push(f);return s}mergeHandlerResult(e,s,f,g,w){if(!f)return;c.e(e,f);const S={handlerName:g,originalEvent:f.originalEvent||w};f.zoomDelta!==void 0&&(s.zoom=S),f.panDelta!==void 0&&(s.drag=S),f.rollDelta!==void 0&&(s.roll=S),f.pitchDelta!==void 0&&(s.pitch=S),f.bearingDelta!==void 0&&(s.rotate=S)}_applyChanges(){const e={},s={},f={};for(const[g,w,S]of this._changes)g.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(g.panDelta)),g.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(e.rollDelta=(e.rollDelta||0)+g.rollDelta),g.around!==void 0&&(e.around=g.around),g.pinchAround!==void 0&&(e.pinchAround=g.pinchAround),g.noInertia&&(e.noInertia=g.noInertia),c.e(s,w),c.e(f,S);this._updateMapTransform(e,s,f),this._changes=[]}_updateMapTransform(e,s,f){const g=this._map,w=g._getTransformForUpdate(),S=g.terrain;if(!(us(e)||S&&this._terrainMovement))return this._fireEvents(s,f,!0);g._stop(!0);let{panDelta:D,zoomDelta:R,bearingDelta:N,pitchDelta:F,rollDelta:G,around:Z,pinchAround:K}=e;K!==void 0&&(Z=K),Z=Z||g.transform.centerPoint,S&&!w.isPointOnMapSurface(Z)&&(Z=w.centerPoint);const te={panDelta:D,zoomDelta:R,rollDelta:G,pitchDelta:F,bearingDelta:N,around:Z};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(Z)&&(Z=w.centerPoint);const he=Z.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(D?Z.sub(D):Z);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(te,w),this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(D))):this._map.cameraHelper.handleMapControlsPan(te,w,he):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(te,w,he))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(te,w),this._map.cameraHelper.handleMapControlsPan(te,w,he)),g._applyUpdatedTransform(w),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,f,!0)}_fireEvents(e,s,f){const g=dc(this._eventsInProgress),w=dc(e),S={};for(const G in e){const{originalEvent:Z}=e[G];this._eventsInProgress[G]||(S[`${G}start`]=Z),this._eventsInProgress[G]=e[G]}!g&&w&&this._fireEvent("movestart",w.originalEvent);for(const G in S)this._fireEvent(G,S[G]);w&&this._fireEvent("move",w.originalEvent);for(const G in e){const{originalEvent:Z}=e[G];this._fireEvent(G,Z)}const D={};let R;for(const G in this._eventsInProgress){const{handlerName:Z,originalEvent:K}=this._eventsInProgress[G];this._handlersById[Z].isActive()||(delete this._eventsInProgress[G],R=s[Z]||K,D[`${G}end`]=R)}for(const G in D)this._fireEvent(G,D[G]);const N=dc(this._eventsInProgress),F=(g||w)&&!N;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const G=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&G.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(G)}if(f&&F){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=K=>K!==0&&-this._bearingSnap<K&&K<this._bearingSnap;!G||!G.essential&&U.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:R})),Z(this._map.getBearing())&&this._map.resetNorth()):(Z(G.bearing||this._map.getBearing())&&(G.bearing=0),G.freezeElevation=!0,this._map.easeTo(G,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new c.l(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new jo("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Za extends c.E{constructor(e,s,f){super(),this._renderFrameCallback=()=>{const g=Math.min((U.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=f.bearingSnap,this.cameraHelper=s,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,s){e.apply(this.transform),this.transform=e,this.cameraHelper=s}getCenter(){return new c.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,s){return this.jumpTo({elevation:e},s),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,s,f){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},s),f)}panTo(e,s,f){return this.easeTo(c.e({center:e},s),f)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,f){return this.easeTo(c.e({zoom:e},s),f)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,s){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",s)).fire(new c.l("move",s)).fire(new c.l("moveend",s))),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,f){return this.easeTo(c.e({bearing:e},s),f)}resetNorth(e,s){return this.rotateTo(0,c.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}getRoll(){return this.transform.roll}setRoll(e,s){return this.jumpTo({roll:e},s),this}cameraForBounds(e,s){e=Zn.convert(e).adjustAntiMeridian();const f=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),f,s)}_cameraForBoxAndBearing(e,s,f,g){const w={top:0,bottom:0,right:0,left:0};if(typeof(g=c.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const N=g.padding;g.padding={top:N,bottom:N,right:N,left:N}}const S=c.e(w,g.padding);g.padding=S;const D=this.transform,R=new Zn(e,s);return this.cameraHelper.cameraForBoxAndBearing(g,S,R,f,D)}fitBounds(e,s,f){return this._fitInternal(this.cameraForBounds(e,s),s,f)}fitScreenCoordinates(e,s,f,g,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(s)),f,g),g,w)}_fitInternal(e,s,f){return e?(delete(s=c.e(e,s)).padding,s.linear?this.easeTo(s,f):this.flyTo(s,f)):this}jumpTo(e,s){this.stop();const f=this._getTransformForUpdate();let g=!1,w=!1,S=!1;const D=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,e);const R=f.zoom!==D;return"elevation"in e&&f.elevation!==+e.elevation&&f.setElevation(+e.elevation),"bearing"in e&&f.bearing!==+e.bearing&&(g=!0,f.setBearing(+e.bearing)),"pitch"in e&&f.pitch!==+e.pitch&&(w=!0,f.setPitch(+e.pitch)),"roll"in e&&f.roll!==+e.roll&&(S=!0,f.setRoll(+e.roll)),e.padding==null||f.isPaddingEqual(e.padding)||f.setPadding(e.padding),this._applyUpdatedTransform(f),this.fire(new c.l("movestart",s)).fire(new c.l("move",s)),R&&this.fire(new c.l("zoomstart",s)).fire(new c.l("zoom",s)).fire(new c.l("zoomend",s)),g&&this.fire(new c.l("rotatestart",s)).fire(new c.l("rotate",s)).fire(new c.l("rotateend",s)),w&&this.fire(new c.l("pitchstart",s)).fire(new c.l("pitch",s)).fire(new c.l("pitchend",s)),S&&this.fire(new c.l("rollstart",s)).fire(new c.l("roll",s)).fire(new c.l("rollend",s)),this.fire(new c.l("moveend",s))}calculateCameraOptionsFromTo(e,s,f,g=0){const w=c.$.fromLngLat(e,s),S=c.$.fromLngLat(f,g),D=S.x-w.x,R=S.y-w.y,N=S.z-w.z,F=Math.hypot(D,R,N);if(F===0)throw new Error("Can't calculate camera options with same From and To");const G=Math.hypot(D,R),Z=c.ab(this.transform.cameraToCenterDistance/F/this.transform.tileSize),K=180*Math.atan2(D,-R)/Math.PI;let te=180*Math.acos(G/F)/Math.PI;return te=N<0?90-te:90+te,{center:S.toLngLat(),elevation:g,zoom:Z,pitch:te,bearing:K}}calculateCameraOptionsFromCameraLngLatAltRotation(e,s,f,g,w){const S=this.transform.calculateCenterFromCameraLngLatAlt(e,s,f,g);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:f,pitch:g,roll:w}}easeTo(e,s){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.cb},e)).animate===!1||!e.essential&&U.prefersReducedMotion)&&(e.duration=0);const f=this._getTransformForUpdate(),g=this.getBearing(),w=f.pitch,S=f.roll,D="bearing"in e?this._normalizeBearing(e.bearing,g):g,R="pitch"in e?+e.pitch:w,N="roll"in e?this._normalizeBearing(e.roll,S):S,F="padding"in e?e.padding:f.padding,G=c.P.convert(e.offset);let Z,K;e.around&&(Z=c.Q.convert(e.around),K=f.locationToScreenPoint(Z));const te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},he=this.cameraHelper.handleEaseTo(f,{bearing:D,pitch:R,roll:N,padding:F,around:Z,aroundPoint:K,offsetAsPoint:G,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||g!==D,this._pitching=this._pitching||R!==w,this._rolling=this._rolling||N!==S,this._padding=!f.isPaddingEqual(F),this._zooming=this._zooming||he.isZooming,this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,te),this.terrain&&this._prepareElevation(he.elevationCenter),this._ease(ue=>{he.easeFunc(ue),this.terrain&&!e.freezeElevation&&this._updateElevation(ue),this._applyUpdatedTransform(f),this._fireMoveEvents(s)},ue=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,ue)},e),this}_prepareEase(e,s,f={}){this._moving=!0,s||f.moving||this.fire(new c.l("movestart",e)),this._zooming&&!f.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!f.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!f.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!f.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(f-(s-(f*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.setElevation(c.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const s=e.getCameraLngLat(),f=e.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(s,e.zoom):0;if(f<g){const w=this.calculateCameraOptionsFromTo(s,g,e.center,e.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(s.push(g=>this._elevateCameraIfInsideTerrain(g)),this.transformCameraUpdate&&s.push(g=>this.transformCameraUpdate(g)),!s.length)return;const f=e.clone();for(const g of s){const w=f.clone(),{center:S,zoom:D,roll:R,pitch:N,bearing:F,elevation:G}=g(w);S&&w.setCenter(S),G!==void 0&&w.setElevation(G),D!==void 0&&w.setZoom(D),R!==void 0&&w.setRoll(R),N!==void 0&&w.setPitch(N),F!==void 0&&w.setBearing(F),f.apply(w)}this.transform.apply(f)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const f=this._zooming,g=this._rotating,w=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new c.l("zoomend",e)),g&&this.fire(new c.l("rotateend",e)),w&&this.fire(new c.l("pitchend",e)),S&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,s){if(!e.essential&&U.prefersReducedMotion){const it=c.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(it,s)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cb},e);const f=this._getTransformForUpdate(),g=f.bearing,w=f.pitch,S=f.roll,D=f.padding,R="bearing"in e?this._normalizeBearing(e.bearing,g):g,N="pitch"in e?+e.pitch:w,F="roll"in e?this._normalizeBearing(e.roll,S):S,G="padding"in e?e.padding:f.padding,Z=c.P.convert(e.offset);let K=f.centerPoint.add(Z);const te=f.screenPointToLocation(K),he=this.cameraHelper.handleFlyTo(f,{bearing:R,pitch:N,roll:F,padding:G,locationAtOffset:te,offsetAsPoint:Z,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ue=e.curve;const de=Math.max(f.width,f.height),ge=de/he.scaleOfZoom,xe=he.pixelPathLength;typeof he.scaleOfMinZoom=="number"&&(ue=Math.sqrt(de/he.scaleOfMinZoom/xe*2));const be=ue*ue;function Te(it){const At=(ge*ge-de*de+(it?-1:1)*be*be*xe*xe)/(2*(it?ge:de)*be*xe);return Math.log(Math.sqrt(At*At+1)-At)}function De(it){return(Math.exp(it)-Math.exp(-it))/2}function Me(it){return(Math.exp(it)+Math.exp(-it))/2}const Ge=Te(!1);let Ue=function(it){return Me(Ge)/Me(Ge+ue*it)},at=function(it){return de*((Me(Ge)*(De(At=Ge+ue*it)/Me(At))-De(Ge))/be)/xe;var At},st=(Te(!0)-Ge)/ue;if(Math.abs(xe)<2e-6||!isFinite(st)){if(Math.abs(de-ge)<1e-6)return this.easeTo(e,s);const it=ge<de?-1:1;st=Math.abs(Math.log(ge/de))/ue,at=()=>0,Ue=At=>Math.exp(it*ue*At)}return e.duration="duration"in e?+e.duration:1e3*st/("screenSpeed"in e?+e.screenSpeed/ue:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=g!==R,this._pitching=N!==w,this._rolling=F!==S,this._padding=!f.isPaddingEqual(G),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(he.targetCenter),this._ease(it=>{const At=it*st,Et=1/Ue(At),ut=at(At);this._rotating&&f.setBearing(c.B.number(g,R,it)),this._pitching&&f.setPitch(c.B.number(w,N,it)),this._rolling&&f.setRoll(c.B.number(S,F,it)),this._padding&&(f.interpolatePadding(D,G,it),K=f.centerPoint.add(Z)),he.easeFunc(it,Et,ut,K),this.terrain&&!e.freezeElevation&&this._updateElevation(it),this._applyUpdatedTransform(f),this._fireMoveEvents(s)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,s)}return e||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(e,s,f){f.animate===!1||f.duration===0?(e(1),s()):(this._easeStart=U.now(),this._easeOptions=f,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=c.aL(e,-180,180);const f=Math.abs(e-s);return Math.abs(e-360-s)<f&&(e-=360),Math.abs(e+360-s)<f&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.Q.convert(e),this.transform.tileZoom):null}}const fc={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Zt{constructor(e=fc){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const f=this._map._getUIString(`AttributionControl.${s}`);e.title=f,e.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const s=this._map.style.sourceCaches;for(const g in s){const w=s[g];if(w.used||w.usedForTerrain){const S=w.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter(g=>String(g).trim()),e.sort((g,w)=>g.length-w.length),e=e.filter((g,w)=>{for(let S=w+1;S<e.length;S++)if(e[S].indexOf(g)>=0)return!1;return!0});const f=e.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,e.length?(this._innerContainer.innerHTML=V.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ht{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const f=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const s=V.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class rh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,f=s?this._queue.concat(s):this._queue;for(const g of f)if(g.id===e)return void(g.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const f of s)if(!f.cancelled&&(f.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Rd=c.aD([{name:"a_pos3d",type:"Int16",components:3}]);class yl extends c.E{constructor(e){super(),this._lastTilesetChange=U.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const f={};for(const g of Ne(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),c.bO(g.terrainRttPosMatrix32f,0,c.Z,c.Z,0,0,1),this._tiles[g.key]=new Gi(g,this.tileSize),this._lastTilesetChange=U.now());for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(e){for(const s in this._tiles){const f=this._tiles[s];(!e||f.tileID.equals(e)||f.tileID.isChildOf(e)||e.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,s){return s?this._getTerrainCoordsForTileRanges(e,s):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const s={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID,w=e.clone(),S=c.b2();if(g.canonical.equals(e.canonical))c.bO(S,0,c.Z,c.Z,0,0,1);else if(g.canonical.isChildOf(e.canonical)){const D=g.canonical.z-e.canonical.z,R=g.canonical.x-(g.canonical.x>>D<<D),N=g.canonical.y-(g.canonical.y>>D<<D),F=c.Z>>D;c.bO(S,0,F,F,0,0,1),c.L(S,S,[-R*F,-N*F,0])}else{if(!e.canonical.isChildOf(g.canonical))continue;{const D=e.canonical.z-g.canonical.z,R=e.canonical.x-(e.canonical.x>>D<<D),N=e.canonical.y-(e.canonical.y>>D<<D),F=c.Z>>D;c.bO(S,0,c.Z,c.Z,0,0,1),c.L(S,S,[R*F,N*F,0]),c.M(S,S,[1/2**D,1/2**D,0])}}w.terrainRttPosMatrix32f=new Float32Array(S),s[f]=w}return s}_getTerrainCoordsForTileRanges(e,s){const f={};for(const g of this._renderableTilesKeys){const w=this._tiles[g].tileID;if(!this._isWithinTileRanges(w,s))continue;const S=e.clone(),D=c.b2();if(w.canonical.z===e.canonical.z){const R=e.canonical.x-w.canonical.x,N=e.canonical.y-w.canonical.y;c.bO(D,0,c.Z,c.Z,0,0,1),c.L(D,D,[R*c.Z,N*c.Z,0])}else if(w.canonical.z>e.canonical.z){const R=w.canonical.z-e.canonical.z,N=w.canonical.x-(w.canonical.x>>R<<R),F=w.canonical.y-(w.canonical.y>>R<<R),G=e.canonical.x-(w.canonical.x>>R),Z=e.canonical.y-(w.canonical.y>>R),K=c.Z>>R;c.bO(D,0,K,K,0,0,1),c.L(D,D,[-N*K+G*c.Z,-F*K+Z*c.Z,0])}else{const R=e.canonical.z-w.canonical.z,N=e.canonical.x-(e.canonical.x>>R<<R),F=e.canonical.y-(e.canonical.y>>R<<R),G=(e.canonical.x>>R)-w.canonical.x,Z=(e.canonical.y>>R)-w.canonical.y,K=c.Z<<R;c.bO(D,0,K,K,0,0,1),c.L(D,D,[N*c.Z+G*K,F*c.Z+Z*K,0])}S.terrainRttPosMatrix32f=new Float32Array(D),f[g]=S}return f}getSourceTile(e,s){const f=this.sourceCache._source;let g=e.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(g).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!w||!w.dem)&&s)for(;g>=f.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(e.scaledTo(g--).key);return w}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,s){return s[e.canonical.z]&&e.canonical.x>=s[e.canonical.z].minTileX&&e.canonical.x<=s[e.canonical.z].maxTileX&&e.canonical.y>=s[e.canonical.z].minTileY&&e.canonical.y<=s[e.canonical.z].maxTileY}}class Lr{constructor(e,s,f){this._meshCache={},this.painter=e,this.sourceCache=new yl(s),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,f,g=c.Z){var w;if(!(s>=0&&s<g&&f>=0&&f<g))return 0;const S=this.getTerrainData(e),D=(w=S.tile)===null||w===void 0?void 0:w.dem;if(!D)return 0;const R=c.cf([],[s/g*c.Z,f/g*c.Z],S.u_terrain_matrix),N=[R[0]*D.dim,R[1]*D.dim],F=Math.floor(N[0]),G=Math.floor(N[1]),Z=N[0]-F,K=N[1]-G;return D.get(F,G)*(1-Z)*(1-K)+D.get(F+1,G)*Z*(1-K)+D.get(F,G+1)*(1-Z)*K+D.get(F+1,G+1)*Z*K}getElevationForLngLatZoom(e,s){if(!c.cg(s,e.wrap()))return 0;const{tileID:f,mercatorX:g,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(f,g%c.Z,w%c.Z,c.Z)}getElevation(e,s,f,g=c.Z){return this.getDEMElevation(e,s,f,g)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const g=this.painter.context,w=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ke(g,w,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ke(g,new c.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.at([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const g=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new Ke(g,s.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),s.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const f=s&&s+s.tileID.key+e.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let w=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=g?w=e.canonical.z-g:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>w<<w),D=e.canonical.y-(e.canonical.y>>w<<w),R=c.ch(new Float64Array(16),[1/(c.Z<<w),1/(c.Z<<w),0]);c.L(R,R,[S*c.Z,D*c.Z,0]),this._demMatrixCache[e.key]={matrix:R,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,f=s.width/devicePixelRatio,g=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ke(s.context,{width:f,height:g,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ke(s.context,{width:f,height:g,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,S=0;w<this._coordsTextureSize;w++)for(let D=0;D<this._coordsTextureSize;D++,S+=4)s[S+0]=255&D,s[S+1]=255&w,s[S+2]=D>>8<<4|w>>8,s[S+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),g=new Ke(e,f,e.gl.RGBA,{premultiply:!1});return g.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),f=this.painter.context,g=f.gl,w=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),D=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(w,D-S-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),f.bindFramebuffer.set(null);const R=s[0]+(s[2]>>4<<8),N=s[1]+((15&s[2])<<8),F=this.coordsIndex[255-s[3]],G=F&&this.sourceCache.getTileByID(F);if(!G)return null;const Z=this._coordsTextureSize,K=(1<<G.tileID.canonical.z)*Z;return new c.$((G.tileID.canonical.x*Z+R)/K+G.tileID.wrap,(G.tileID.canonical.y*Z+N)/K,this.getElevation(G.tileID,R,N,Z))}depthAtPoint(e){const s=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),f.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(e){var s;const f=((s=this.painter.style.projection)===null||s===void 0?void 0:s.transitionState)>0,g=f&&e.canonical.y===0,w=f&&e.canonical.y===(1<<e.canonical.z)-1,S=`m_${g?"n":""}_${w?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const D=this.painter.context,R=new c.ci,N=new c.aH,F=this.meshSize,G=c.Z/F,Z=F*F;for(let Me=0;Me<=F;Me++)for(let Ge=0;Ge<=F;Ge++)R.emplaceBack(Ge*G,Me*G,0);for(let Me=0;Me<Z;Me+=F+1)for(let Ge=0;Ge<F;Ge++)N.emplaceBack(Ge+Me,F+Ge+Me+1,F+Ge+Me+2),N.emplaceBack(Ge+Me,F+Ge+Me+2,Ge+Me+1);const K=R.length,te=K+(F+1),he=(F+1)*F,ue=g?c.b9:0,de=g?0:1,ge=w?c.ba:c.Z,xe=w?0:1;for(let Me=0;Me<=F;Me++)R.emplaceBack(Me*G,ue,de);for(let Me=0;Me<=F;Me++)R.emplaceBack(Me*G,ge,xe);for(let Me=0;Me<F;Me++)N.emplaceBack(he+Me,te+Me,te+Me+1),N.emplaceBack(he+Me,te+Me+1,he+Me+1),N.emplaceBack(0+Me,K+Me+1,K+Me),N.emplaceBack(0+Me,0+Me+1,K+Me+1);const be=R.length,Te=be+2*(F+1);for(const Me of[0,1])for(let Ge=0;Ge<=F;Ge++)for(const Ue of[0,1])R.emplaceBack(Me*c.Z,Ge*G,Ue);for(let Me=0;Me<2*F;Me+=2)N.emplaceBack(be+Me,be+Me+1,be+Me+3),N.emplaceBack(be+Me,be+Me+3,be+Me+2),N.emplaceBack(Te+Me,Te+Me+3,Te+Me+1),N.emplaceBack(Te+Me,Te+Me+2,Te+Me+3);const De=new nl(D.createVertexBuffer(R,Rd.members),D.createIndexBuffer(N),c.aG.simpleSegment(0,0,R.length,N.length));return this._meshCache[S]=De,De}getMeshFrameDelta(e){return 2*Math.PI*c.br/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,s){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,f={minElevation:null,maxElevation:null};return s&&s.dem&&(f.minElevation=s.dem.min*this.exaggeration,f.maxElevation=s.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(e,s){const f=c.$.fromLngLat(e.wrap()),g=(1<<s)*c.Z,w=f.x*g,S=f.y*g,D=Math.floor(w/c.Z),R=Math.floor(S/c.Z);return{tileID:new c.Y(s,0,s,D,R),mercatorX:w,mercatorY:S}}}class Bf{constructor(e,s,f){this._context=e,this._size=s,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new Ke(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(f.texture),{id:e,fbo:s,texture:f,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>e.id!==s),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Nr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ff{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new Bf(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(f=>!e._layers[f].isHidden(s)),this._coordsAscending={};for(const f in e.sourceCaches){this._coordsAscending[f]={};const g=e.sourceCaches[f].getVisibleCoordinates(),w=e.sourceCaches[f].getSource(),S=w instanceof rr?w.terrainTileRanges:null;for(const D of g){const R=this.terrain.sourceCache.getTerrainCoords(D,S);for(const N in R)this._coordsAscending[f][N]||(this._coordsAscending[f][N]=[]),this._coordsAscending[f][N].push(R[N])}}this._coordsAscendingStr={};for(const f of e._order){const g=e._layers[f],w=g.source;if(Nr[g.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const S in this._coordsAscending[w])this._coordsAscendingStr[w][S]=this._coordsAscending[w][S].map(D=>D.key).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsAscendingStr){const w=this._coordsAscendingStr[g][f.tileID.key];w&&w!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(e,s){if(e.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},s),{isRenderingToTexture:!0}),g=e.type,w=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Nr[g]&&(this._prevType&&Nr[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(e.id),!S))return!0;if(Nr[this._prevType]||Nr[g]&&S){this._prevType=g;const D=this._stacks.length-1,R=this._stacks[D]||[];for(const N of this._renderableTiles){if(this.pool.isFull()&&(Ma(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(N),N.rtt[D]){const G=this.pool.getObjectForId(N.rtt[D].id);if(G.stamp===N.rtt[D].stamp){this.pool.useObject(G);continue}}const F=this.pool.getOrCreateFreeObject();this.pool.useObject(F),this.pool.stampObject(F),N.rtt[D]={id:F.id,stamp:F.stamp},w.context.bindFramebuffer.set(F.fbo.framebuffer),w.context.clear({color:c.b7.transparent,stencil:0}),w.currentStencilSource=void 0;for(let G=0;G<R.length;G++){const Z=w.style._layers[R[G]],K=Z.source?this._coordsAscending[Z.source][N.tileID.key]:[N.tileID];w.context.viewport.set([0,0,F.fbo.width,F.fbo.height]),w._renderTileClippingMasks(Z,K,!0),w.renderLayer(w,w.style.sourceCaches[Z.source],Z,K,f),Z.source&&(N.rttCoords[Z.source]=this._coordsAscendingStr[Z.source][N.tileID.key])}}return Ma(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),Nr[g]}return!1}}const Ga={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Kt=C,on={hash:!1,interactive:!0,bearingSnap:7,attributionControl:fc,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},tr={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class _l{constructor(e,s,f=!1){this.mousedown=w=>{this.startMove(w,V.mousePos(this.element,w)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,V.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=s;const g=new Dd;this._rotatePitchHanlder=new Ni({clickTolerance:3,move:(w,S)=>{const D=s.getBoundingClientRect(),R=new c.P((D.bottom-D.top)/2,(D.right-D.left)/2);return{bearingDelta:c.ca(new c.P(w.x,S.y),S,R),pitchDelta:f?-.5*(S.y-w.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=e,V.addEventListener(s,"mousedown",this.mousedown),V.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(s,"touchcancel",this.reset)}startMove(e,s){this._rotatePitchHanlder.dragStart(e,s),V.disableDrag()}move(e,s){const f=this.map,{bearingDelta:g,pitchDelta:w}=this._rotatePitchHanlder.dragMove(e,s)||{};g&&f.setBearing(f.getBearing()+g),w&&f.setPitch(f.getPitch()+w)}off(){const e=this.element;V.removeEventListener(e,"mousedown",this.mousedown),V.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let ea;function Ks(x,e,s){const f=new c.Q(x.lng,x.lat);if(x=new c.Q(x.lng,x.lat),e){const g=new c.Q(x.lng-360,x.lat),w=new c.Q(x.lng+360,x.lat),S=s.locationToScreenPoint(x).distSqr(e);s.locationToScreenPoint(g).distSqr(e)<S?x=g:s.locationToScreenPoint(w).distSqr(e)<S&&(x=w)}for(;Math.abs(x.lng-s.center.lng)>180;){const g=s.locationToScreenPoint(x);if(g.x>=0&&g.y>=0&&g.x<=s.width&&g.y<=s.height)break;x.lng>s.center.lng?x.lng-=360:x.lng+=360}return x.lng!==f.lng&&s.isPointOnMapSurface(s.locationToScreenPoint(x))?x:f}const vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xl(x,e,s){const f=x.classList;for(const g in vl)f.remove(`maplibregl-${s}-anchor-${g}`);f.add(`maplibregl-${s}-anchor-${e}`)}class $a extends c.E{constructor(e){if(super(),this._onKeyPress=s=>{const f=s.code,g=s.charCode||s.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=s=>{const f=s.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=s=>{var f;if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ks(this._lngLat,this._flatPos,this._map.transform):(f=this._lngLat)===null||f===void 0?void 0:f.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let w="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?w=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(w=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${vl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${w}`),U.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const s=V.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${f}px`),s.setAttributeNS(null,"width",`${g}px`),s.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const w=V.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const S=V.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const D=V.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"transform","translate(3.0, 29.0)"),D.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of R){const ge=V.createNS("http://www.w3.org/2000/svg","ellipse");ge.setAttributeNS(null,"opacity","0.04"),ge.setAttributeNS(null,"cx","10.5"),ge.setAttributeNS(null,"cy","5.80029008"),ge.setAttributeNS(null,"rx",de.rx),ge.setAttributeNS(null,"ry",de.ry),D.appendChild(ge)}const N=V.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill",this._color);const F=V.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),N.appendChild(F);const G=V.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"fill","#000000");const Z=V.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),G.appendChild(Z);const K=V.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF");const te=V.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const he=V.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");const ue=V.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#FFFFFF"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962"),te.appendChild(he),te.appendChild(ue),S.appendChild(D),S.appendChild(N),S.appendChild(G),S.appendChild(K),S.appendChild(te),s.appendChild(S),s.setAttributeNS(null,"height",f*this._scale+"px"),s.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(s),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),xl(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const g=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,f;if(!(!((s=this._map)===null||s===void 0)&&s.terrain)){const G=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==G&&(this._element.style.opacity=G))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const g=this._map,w=g.terrain.depthAtPoint(this._pos),S=g.terrain.getElevationForLngLatZoom(this._lngLat,g.transform.tileZoom);if(g.transform.lngLatToCameraDepth(this._lngLat,S)-w<.006)return void(this._element.style.opacity=this._opacity);const D=-this._offset.y/g.transform.pixelsPerMeter,R=Math.sin(g.getPitch()*Math.PI/180)*D,N=g.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),F=g.transform.lngLatToCameraDepth(this._lngLat,S+R)-N>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&F&&this._popup.remove(),this._element.style.opacity=F?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return(this._opacity===void 0||e===void 0&&s===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const Uf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let vi=0,Bo=!1;const ah={maxWidth:100,unit:"metric"};function sh(x,e,s){const f=s&&s.maxWidth||100,g=x._container.clientHeight/2,w=x._container.clientWidth/2,S=x.unproject([w-f/2,g]),D=x.unproject([w+f/2,g]),R=Math.round(x.project(D).x-x.project(S).x),N=Math.min(f,R,x._container.clientWidth),F=S.distanceTo(D);if(s&&s.unit==="imperial"){const G=3.2808*F;G>5280?bl(e,N,G/5280,x._getUIString("ScaleControl.Miles")):bl(e,N,G,x._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?bl(e,N,F/1852,x._getUIString("ScaleControl.NauticalMiles")):F>=1e3?bl(e,N,F/1e3,x._getUIString("ScaleControl.Kilometers")):bl(e,N,F,x._getUIString("ScaleControl.Meters"))}function bl(x,e,s,f){const g=function(w){const S=Math.pow(10,`${Math.floor(w)}`.length-1);let D=w/S;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(R){const N=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*N)/N}(D),S*D}(s);x.style.width=e*(g/s)+"px",x.innerHTML=`${g}&nbsp;${f}`}const Vf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},oh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function pc(x){if(x){if(typeof x=="number"){const e=Math.round(Math.abs(x)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,x),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-x),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(x,0),right:new c.P(-x,0)}}if(x instanceof c.P||Array.isArray(x)){const e=c.P.convert(x);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(x.center||[0,0]),top:c.P.convert(x.top||[0,0]),"top-left":c.P.convert(x["top-left"]||[0,0]),"top-right":c.P.convert(x["top-right"]||[0,0]),bottom:c.P.convert(x.bottom||[0,0]),"bottom-left":c.P.convert(x["bottom-left"]||[0,0]),"bottom-right":c.P.convert(x["bottom-right"]||[0,0]),left:c.P.convert(x.left||[0,0]),right:c.P.convert(x.right||[0,0])}}return pc(new c.P(0,0))}const lh=C;v.AJAXError=c.cm,v.Event=c.l,v.Evented=c.E,v.LngLat=c.Q,v.MercatorCoordinate=c.$,v.Point=c.P,v.addProtocol=c.cn,v.config=c.a,v.removeProtocol=c.co,v.AttributionControl=Zt,v.BoxZoomHandler=Xs,v.CanvasSource=xo,v.CooperativeGesturesHandler=nu,v.DoubleClickZoomHandler=tu,v.DragPanHandler=Qs,v.DragRotateHandler=ci,v.EdgeInsets=Di,v.FullscreenControl=class extends c.E{constructor(x={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const x=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=is,v.GeolocateControl=class extends c.E{constructor(x){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new c.Q(e.coords.longitude,e.coords.latitude),f=e.coords.accuracy,g=this._map.getBearing(),w=c.e({bearing:g},this.options.fitBoundsOptions),S=Zn.fromLngLat(s,f);this._map.fitBounds(S,w,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new c.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Bo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $a({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},Uf,x)}onAdd(x){return this._map=x,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(ea!==void 0&&!e)return ea;if(window.navigator.permissions===void 0)return ea=!!window.navigator.geolocation,ea;try{ea=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ea=!!window.navigator.geolocation}return ea})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,vi=0,Bo=!1}_isOutOfMapMaxBounds(x){const e=this._map.getMaxBounds(),s=x.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const x=this._map.getBounds(),e=x.getSouthEast(),s=x.getNorthEast(),f=e.distanceTo(s),g=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":vi--,Bo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),vi++,vi>1?(x={maximumAge:6e5,timeout:0},Bo=!0):(x=this.options.positionOptions,Bo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.GlobeControl=class{constructor(){this._toggleProjection=()=>{var x;const e=(x=this._map.getProjection())===null||x===void 0?void 0:x.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var x;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((x=this._map.getProjection())===null||x===void 0?void 0:x.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(x){return this._map=x,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=V.create("button","maplibregl-ctrl-globe",this._container),V.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},v.Hash=Ad,v.ImageSource=rr,v.KeyboardHandler=Id,v.LngLatBounds=Zn,v.LogoControl=Ht,v.Map=class extends Za{constructor(x){var e,s;c.cj.mark(c.ck.create);const f=Object.assign(Object.assign(Object.assign({},on),x),{canvasContextAttributes:Object.assign(Object.assign({},on.canvasContextAttributes),x.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new _i,w=new Yi;if(f.minZoom!==void 0&&g.setMinZoom(f.minZoom),f.maxZoom!==void 0&&g.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&g.setMinPitch(f.minPitch),f.maxPitch!==void 0&&g.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&g.setRenderWorldCopies(f.renderWorldCopies),super(g,w,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new rh,this._controls=[],this._mapId=c.a4(),this._contextLost=D=>{D.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:D}))},this._contextRestored=D=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:D}))},this._onMapScroll=D=>{if(D.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ga),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=$e.addThrottleControl(()=>this.isMoving()),this._requestManager=new ke(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let D=!1;const R=Sd(N=>{this._trackResize&&!this._removed&&(this.resize(N),this.redraw())},50);this._resizeObserver=new ResizeObserver(N=>{D?R(N):D=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ih(this,f),this._hash=f.hash&&new Ad(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.e({},f.fitBoundsOptions,{duration:0}))));const S=typeof f.style=="string"||((s=(e=f.style)===null||e===void 0?void 0:e.projection)===null||s===void 0?void 0:s.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Zt(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Ht,f.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const D=c.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(D)}}),this.on("data",D=>{this._update(D.dataType==="style"),this.fire(new c.l(`${D.dataType}data`,D))}),this.on("dataloading",D=>{this.fire(new c.l(`${D.dataType}dataloading`,D))}),this.on("dataabort",D=>{this.fire(new c.l("sourcedataabort",D))})}_getMapId(){return this._mapId}addControl(x,e){if(e===void 0&&(e=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=x.onAdd(this);this._controls.push(x);const f=this._controlPositions[e];return e.indexOf("bottom")!==-1?f.insertBefore(s,f.firstChild):f.appendChild(s),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(x);return e>-1&&this._controls.splice(e,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}calculateCameraOptionsFromTo(x,e,s,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(x,e,s,f)}resize(x,e=!0){const[s,f]=this._containerDimensions(),g=this._getClampedPixelRatio(s,f);if(this._resizeCanvas(s,f,g),this.painter.resize(s,f,g),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const D=this._getClampedPixelRatio(s,f);this._resizeCanvas(s,f,D),this.painter.resize(s,f,D)}this._resizeTransform(e);const w=!this._moving;return w&&(this.stop(),this.fire(new c.l("movestart",x)).fire(new c.l("move",x))),this.fire(new c.l("resize",x)),w&&this.fire(new c.l("moveend",x)),this}_resizeTransform(x=!0){var e;const[s,f]=this._containerDimensions();this.transform.resize(s,f,x),(e=this._requestedCameraState)===null||e===void 0||e.resize(s,f,x)}_getClampedPixelRatio(x,e){const{0:s,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),w=x*g,S=e*g;return Math.min(w>s?s/w:1,S>f?f/S:1)*g}getPixelRatio(){var x;return(x=this._overridePixelRatio)!==null&&x!==void 0?x:devicePixelRatio}setPixelRatio(x){this._overridePixelRatio=x,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(Zn.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.setMinZoom(x),this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.setMaxZoom(x),this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.setMinPitch(x),this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(x>=this.transform.minPitch)return this.transform.setMaxPitch(x),this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.setRenderWorldCopies(x),this._update()}project(x){return this.transform.locationToScreenPoint(c.Q.convert(x),this.style&&this.terrain)}unproject(x){return this.transform.screenPointToLocation(c.P.convert(x),this.terrain)}isMoving(){var x;return this._moving||((x=this.handlers)===null||x===void 0?void 0:x.isMoving())}isZooming(){var x;return this._zooming||((x=this.handlers)===null||x===void 0?void 0:x.isZooming())}isRotating(){var x;return this._rotating||((x=this.handlers)===null||x===void 0?void 0:x.isRotating())}_createDelegatedListener(x,e,s){if(x==="mouseenter"||x==="mouseover"){let f=!1;return{layers:e,listener:s,delegates:{mousemove:w=>{const S=e.filter(R=>this.getLayer(R)),D=S.length!==0?this.queryRenderedFeatures(w.point,{layers:S}):[];D.length?f||(f=!0,s.call(this,new Cr(x,this,w.originalEvent,{features:D}))):f=!1},mouseout:()=>{f=!1}}}}if(x==="mouseleave"||x==="mouseout"){let f=!1;return{layers:e,listener:s,delegates:{mousemove:S=>{const D=e.filter(R=>this.getLayer(R));(D.length!==0?this.queryRenderedFeatures(S.point,{layers:D}):[]).length?f=!0:f&&(f=!1,s.call(this,new Cr(x,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,s.call(this,new Cr(x,this,S.originalEvent)))}}}}{const f=g=>{const w=e.filter(D=>this.getLayer(D)),S=w.length!==0?this.queryRenderedFeatures(g.point,{layers:w}):[];S.length&&(g.features=S,s.call(this,g),delete g.features)};return{layers:e,listener:s,delegates:{[x]:f}}}}_saveDelegatedListener(x,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(e)}_removeDelegatedListener(x,e,s){if(!this._delegatedListeners||!this._delegatedListeners[x])return;const f=this._delegatedListeners[x];for(let g=0;g<f.length;g++){const w=f[g];if(w.listener===s&&w.layers.length===e.length&&w.layers.every(S=>e.includes(S))){for(const S in w.delegates)this.off(S,w.delegates[S]);return void f.splice(g,1)}}}on(x,e,s){if(s===void 0)return super.on(x,e);const f=typeof e=="string"?[e]:e,g=this._createDelegatedListener(x,f,s);this._saveDelegatedListener(x,g);for(const w in g.delegates)this.on(w,g.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(x,f,s)}}}once(x,e,s){if(s===void 0)return super.once(x,e);const f=typeof e=="string"?[e]:e,g=this._createDelegatedListener(x,f,s);for(const w in g.delegates){const S=g.delegates[w];g.delegates[w]=(...D)=>{this._removeDelegatedListener(x,f,s),S(...D)}}this._saveDelegatedListener(x,g);for(const w in g.delegates)this.once(w,g.delegates[w]);return this}off(x,e,s){return s===void 0?super.off(x,e):(this._removeDelegatedListener(x,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(x,e){if(!this.style)return[];let s;const f=x instanceof c.P||Array.isArray(x),g=f?x:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(f?{}:x)||{},g instanceof c.P||typeof g[0]=="number")s=[c.P.convert(g)];else{const w=c.P.convert(g[0]),S=c.P.convert(g[1]);s=[w,new c.P(S.x,w.y),S,new c.P(w.x,S.y),w]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(x,e){return this.style.querySourceFeatures(x,e)}setStyle(x,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(x,e))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const e=this._locale[x];if(e==null)throw new Error(`Missing UI string '${x}'`);return e}_updateStyle(x,e){var s,f;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(x,e));const g=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!x)),x?(this.style=new Zc(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x,e,g):this.style.loadJSON(x,e,g),this):((f=(s=this.style)===null||s===void 0?void 0:s.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,e){if(typeof x=="string"){const s=this._requestManager.transformRequest(x,"Style");c.j(s,new AbortController).then(f=>{this._updateDiff(f.data,e)}).catch(f=>{f&&this.fire(new c.k(f))})}else typeof x=="object"&&this._updateDiff(x,e)}_updateDiff(x,e){try{this.style.setState(x,e)&&this._update(!0)}catch(s){c.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(x,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(x,e){return this._lazyInitEmptyStyle(),this.style.addSource(x,e),this._update(!0)}isSourceLoaded(x){const e=this.style&&this.style.sourceCaches[x];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),x){const e=this.style.sourceCaches[x.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${x.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const f=this.style._layers[s];f.type==="hillshade"&&f.source===x.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Lr(this.painter,e,x),this.painter.renderToTexture=new Ff(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=s=>{var f;s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==x.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=s.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:x})),this}getTerrain(){var x,e;return(e=(x=this.terrain)===null||x===void 0?void 0:x.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const e in x){const s=x[e]._tiles;for(const f in s){const g=s[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,e,s={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:w,stretchY:S,content:D,textFitWidth:R,textFitHeight:N}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:G,data:Z}=e,K=e;return this.style.addImage(x,{data:new c.R({width:F,height:G},new Uint8Array(Z)),pixelRatio:f,stretchX:w,stretchY:S,content:D,textFitWidth:R,textFitHeight:N,sdf:g,version:0,userImage:K}),K.onAdd&&K.onAdd(this,x),this}}{const{width:F,height:G,data:Z}=U.getImageData(e);this.style.addImage(x,{data:new c.R({width:F,height:G},Z),pixelRatio:f,stretchX:w,stretchY:S,content:D,textFitWidth:R,textFitHeight:N,sdf:g,version:0})}}updateImage(x,e){const s=this.style.getImage(x);if(!s)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=e instanceof HTMLImageElement||c.b(e)?U.getImageData(e):e,{width:g,height:w,data:S}=f;if(g===void 0||w===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==s.data.width||w!==s.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const D=!(e instanceof HTMLImageElement||c.b(e));return s.data.replace(S,D),this.style.updateImage(x,s),this}getImage(x){return this.style.getImage(x)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x){return $e.getImage(this._requestManager.transformRequest(x,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(x,e){return this._lazyInitEmptyStyle(),this.style.addLayer(x,e),this._update(!0)}moveLayer(x,e){return this.style.moveLayer(x,e),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(x,e,s){return this.style.setLayerZoomRange(x,e,s),this._update(!0)}setFilter(x,e,s={}){return this.style.setFilter(x,e,s),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,e,s,f={}){return this.style.setPaintProperty(x,e,s,f),this._update(!0)}getPaintProperty(x,e){return this.style.getPaintProperty(x,e)}setLayoutProperty(x,e,s,f={}){return this.style.setLayoutProperty(x,e,s,f),this._update(!0)}getLayoutProperty(x,e){return this.style.getLayoutProperty(x,e)}setGlyphs(x,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(x,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(x,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(x,e,s,f=>{f||this._update(!0)}),this}removeSprite(x){return this._lazyInitEmptyStyle(),this.style.removeSprite(x),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(x,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(x,e,s=>{s||this._update(!0)}),this}setLight(x,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(x,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(x,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(x,e){return this.style.setFeatureState(x,e),this._update()}removeFeatureState(x,e){return this.style.removeFeatureState(x,e),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,e=0;return this._container&&(x=this._container.clientWidth||400,e=this._container.clientHeight||300),[x,e]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map");const e=this._canvasContainer=V.create("div","maplibregl-canvas-container",x);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),f=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],f);const g=this._controlContainer=V.create("div","maplibregl-control-container",x),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{w[S]=V.create("div",`maplibregl-ctrl-${S} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,e,s){this._canvas.width=Math.floor(s*x),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const x=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{e={requestedAttributes:x},f&&(e.statusMessage=f.statusMessage,e.type=f.type)},{once:!0});let s=null;if(s=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,x):this._canvas.getContext("webgl2",x)||this._canvas.getContext("webgl",x),!s){const f="Failed to initialize WebGL";throw e?(e.message=f,new Error(JSON.stringify(e))):new Error(f)}this.painter=new dl(s,this.transform),ie.testSupport(s)}migrateProjection(x,e){super.migrateProjection(x,e),this.painter.transform=x,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){var e,s,f,g,w;const S=this._idleTriggered?this._fadeDuration:0,D=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,Z=U.now();this.style.zoomHistory.update(G,Z);const K=new c.C(G,{now:Z,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),te=K.crossFadingFactor();te===1&&te===this._crossFadingFactor||(R=!0,this._crossFadingFactor=te),this.style.update(K)}const N=((s=this.style.projection)===null||s===void 0?void 0:s.transitionState)>0!==D;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||N)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,N),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cj.mark(c.ck.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,c.cj.mark(c.ck.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var x;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),$e.removeThrottleControl(this._imageQueueHandle),(x=this._resizeObserver)===null||x===void 0||x.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cj.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,U.frame(this._frameRequest,x=>{c.cj.frame(x),this._frameRequest=null;try{this._render(x)}catch(e){if(!c.cl(e)&&!function(s){return s.message===Wu}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get version(){return Kt}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(x){return this._lazyInitEmptyStyle(),this.style.setProjection(x),this._update(!0)}},v.MapMouseEvent=Cr,v.MapTouchEvent=pl,v.MapWheelEvent=Gr,v.Marker=$a,v.NavigationControl=class{constructor(x){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),f=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,s)=>{const f=this._map._getUIString(`NavigationControl.${s}`);e.title=f,e.setAttribute("aria-label",f)},this.options=c.e({},tr,x),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _l(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,e){const s=V.create("button",x,this._container);return s.type="button",s.addEventListener("click",e),s}},v.Popup=class extends c.E{constructor(x){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var s;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const D of this.options.className.split(" "))this._container.classList.add(D);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ks(this._lngLat,this._flatPos,this._map.transform):(s=this._lngLat)===null||s===void 0?void 0:s.wrap(),this._trackPointer&&!e)return;const f=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const w=pc(this.options.offset);if(!g){const D=this._container.offsetWidth,R=this._container.offsetHeight;let N;N=f.y+w.bottom.y<R?["top"]:f.y>this._map.transform.height-R?["bottom"]:[],f.x<D/2?N.push("left"):f.x>this._map.transform.width-D/2&&N.push("right"),g=N.length===0?"bottom":N.join("-")}let S=f.add(w[g]);this.options.subpixelPositioning||(S=S.round()),V.setTransform(this._container,`${vl[g]} translate(${S.x}px,${S.y}px)`),xl(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Vf),x)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=c.Q.convert(x),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const e=document.createDocumentFragment(),s=document.createElement("body");let f;for(s.innerHTML=x;f=s.firstChild,f;)e.appendChild(f);return this.setDOMContent(e)}getMaxWidth(){var x;return(x=this._container)===null||x===void 0?void 0:x.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){return this._container&&this._container.classList.add(x),this}removeClassName(x){return this._container&&this._container.classList.remove(x),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}setSubpixelPositioning(x){this.options.subpixelPositioning=x}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(oh);x&&x.focus()}},v.RasterDEMTileSource=js,v.RasterTileSource=li,v.ScaleControl=class{constructor(x){this._onMove=()=>{sh(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,sh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ah),x)}getDefaultPosition(){return"bottom-left"}onAdd(x){return this._map=x,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=jf,v.Style=Zc,v.TerrainControl=class{constructor(x){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=x}onAdd(x){return this._map=x,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=Of,v.TwoFingersTouchRotateHandler=kd,v.TwoFingersTouchZoomHandler=bn,v.TwoFingersTouchZoomRotateHandler=Va,v.VectorTileSource=wa,v.VideoSource=fr,v.addSourceType=(x,e)=>c._(void 0,void 0,void 0,function*(){if(bo(x))throw new Error(`A source type called "${x}" already exists.`);((s,f)=>{Bs[s]=f})(x,e)}),v.clearPrewarmedResources=function(){const x=zt;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(gt),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.createTileMesh=Zs,v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return pr().getRTLTextPluginStatus()},v.getVersion=function(){return lh},v.getWorkerCount=function(){return kt.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(x){return Tn().broadcast("IS",x)},v.prewarm=function(){tn().acquire(gt)},v.setMaxParallelImageRequests=function(x){c.a.MAX_PARALLEL_IMAGE_REQUESTS=x},v.setRTLTextPlugin=function(x,e){return pr().setRTLTextPlugin(x,e)},v.setWorkerCount=function(x){kt.workerCount=x},v.setWorkerUrl=function(x){c.a.WORKER_URL=x}});var _=a;return _})}(k0)),k0.exports}var Qw=GS();const Kw=Lp(Qw),Jw=nS({__proto__:null,default:Kw},[Qw]),$S="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",YS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class Km extends Error{constructor(a,h){const p=`${Km.extractMessage(a)}: ${JSON.stringify({response:a,request:h})}`;super(p);mp(this,"response");mp(this,"request");Object.setPrototypeOf(this,Km.prototype),this.response=a,this.request=h,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Km)}static extractMessage(a){var h,p;return((p=(h=a.errors)==null?void 0:h[0])==null?void 0:p.message)??`GraphQL Error (Code: ${String(a.status)})`}}const u1=i=>i.toUpperCase(),Vv=i=>typeof i=="function"?i():i,e2=(i,n)=>i.map((a,h)=>[a,n[h]]),Um=i=>{let n={};return i instanceof Headers?n=qS(i):Array.isArray(i)?i.forEach(([a,h])=>{a&&h!==void 0&&(n[a]=h)}):i&&(n=i),n},qS=i=>{const n={};return i.forEach((a,h)=>{n[h]=a}),n},HS=i=>{try{const n=i();return XS(n)?n.catch(a=>h1(a)):n}catch(n){return h1(n)}},h1=i=>i instanceof Error?i:new Error(String(i)),XS=i=>typeof i=="object"&&i!==null&&"then"in i&&typeof i.then=="function"&&"catch"in i&&typeof i.catch=="function"&&"finally"in i&&typeof i.finally=="function",Jx=i=>{throw new Error(`Unhandled case: ${String(i)}`)},I0=i=>typeof i=="object"&&i!==null&&!Array.isArray(i),WS=(i,n)=>i.documents?i:{documents:i,requestHeaders:n,signal:void 0},QS=(i,n,a)=>i.query?i:{query:i,variables:n,requestHeaders:a,signal:void 0};function mi(i,n){if(!!!i)throw new Error(n)}function Yh(i){return typeof i=="object"&&i!==null}function nv(i,n){if(!!!i)throw new Error(n??"Unexpected invariant triggered.")}const KS=/\r\n|[\n\r]/g;function dx(i,n){let a=0,h=1;for(const p of i.body.matchAll(KS)){if(typeof p.index=="number"||nv(!1),p.index>=n)break;a=p.index+p[0].length,h+=1}return{line:h,column:n+1-a}}function JS(i){return t2(i.source,dx(i.source,i.start))}function t2(i,n){const a=i.locationOffset.column-1,h="".padStart(a)+i.body,p=n.line-1,_=i.locationOffset.line-1,v=n.line+_,c=n.line===1?a:0,C=n.column+c,k=`${i.name}:${v}:${C}
`,P=h.split(/\r\n|[\n\r]/g),j=P[p];if(j.length>120){const U=Math.floor(C/80),V=C%80,ie=[];for(let me=0;me<j.length;me+=80)ie.push(j.slice(me,me+80));return k+d1([[`${v} |`,ie[0]],...ie.slice(1,U+1).map(me=>["|",me]),["|","^".padStart(V)],["|",ie[U+1]]])}return k+d1([[`${v-1} |`,P[p-1]],[`${v} |`,j],["|","^".padStart(C)],[`${v+1} |`,P[p+1]]])}function d1(i){const n=i.filter(([h,p])=>p!==void 0),a=Math.max(...n.map(([h])=>h.length));return n.map(([h,p])=>h.padStart(a)+(p?" "+p:"")).join(`
`)}function eA(i){const n=i[0];return n==null||"kind"in n||"length"in n?{nodes:n,source:i[1],positions:i[2],path:i[3],originalError:i[4],extensions:i[5]}:n}class Si extends Error{constructor(n,...a){var h,p,_;const{nodes:v,source:c,positions:C,path:k,originalError:P,extensions:j}=eA(a);super(n),this.name="GraphQLError",this.path=k??void 0,this.originalError=P??void 0,this.nodes=f1(Array.isArray(v)?v:v?[v]:void 0);const U=f1((h=this.nodes)===null||h===void 0?void 0:h.map(ie=>ie.loc).filter(ie=>ie!=null));this.source=c??(U==null||(p=U[0])===null||p===void 0?void 0:p.source),this.positions=C??(U==null?void 0:U.map(ie=>ie.start)),this.locations=C&&c?C.map(ie=>dx(c,ie)):U==null?void 0:U.map(ie=>dx(ie.source,ie.start));const V=Yh(P==null?void 0:P.extensions)?P==null?void 0:P.extensions:void 0;this.extensions=(_=j??V)!==null&&_!==void 0?_:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),P!=null&&P.stack?Object.defineProperty(this,"stack",{value:P.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Si):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let n=this.message;if(this.nodes)for(const a of this.nodes)a.loc&&(n+=`

`+JS(a.loc));else if(this.source&&this.locations)for(const a of this.locations)n+=`

`+t2(this.source,a);return n}toJSON(){const n={message:this.message};return this.locations!=null&&(n.locations=this.locations),this.path!=null&&(n.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(n.extensions=this.extensions),n}}function f1(i){return i===void 0||i.length===0?void 0:i}function va(i,n,a){return new Si(`Syntax Error: ${a}`,{source:i,positions:[n]})}class tA{constructor(n,a,h){this.start=n.start,this.end=a.end,this.startToken=n,this.endToken=a,this.source=h}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class n2{constructor(n,a,h,p,_,v){this.kind=n,this.start=a,this.end=h,this.line=p,this.column=_,this.value=v,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const i2={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},nA=new Set(Object.keys(i2));function p1(i){const n=i==null?void 0:i.kind;return typeof n=="string"&&nA.has(n)}var xu;(function(i){i.QUERY="query",i.MUTATION="mutation",i.SUBSCRIPTION="subscription"})(xu||(xu={}));var Qn;(function(i){i.QUERY="QUERY",i.MUTATION="MUTATION",i.SUBSCRIPTION="SUBSCRIPTION",i.FIELD="FIELD",i.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",i.FRAGMENT_SPREAD="FRAGMENT_SPREAD",i.INLINE_FRAGMENT="INLINE_FRAGMENT",i.VARIABLE_DEFINITION="VARIABLE_DEFINITION",i.SCHEMA="SCHEMA",i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.FIELD_DEFINITION="FIELD_DEFINITION",i.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.ENUM_VALUE="ENUM_VALUE",i.INPUT_OBJECT="INPUT_OBJECT",i.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(Qn||(Qn={}));var Nt;(function(i){i.NAME="Name",i.DOCUMENT="Document",i.OPERATION_DEFINITION="OperationDefinition",i.VARIABLE_DEFINITION="VariableDefinition",i.SELECTION_SET="SelectionSet",i.FIELD="Field",i.ARGUMENT="Argument",i.FRAGMENT_SPREAD="FragmentSpread",i.INLINE_FRAGMENT="InlineFragment",i.FRAGMENT_DEFINITION="FragmentDefinition",i.VARIABLE="Variable",i.INT="IntValue",i.FLOAT="FloatValue",i.STRING="StringValue",i.BOOLEAN="BooleanValue",i.NULL="NullValue",i.ENUM="EnumValue",i.LIST="ListValue",i.OBJECT="ObjectValue",i.OBJECT_FIELD="ObjectField",i.DIRECTIVE="Directive",i.NAMED_TYPE="NamedType",i.LIST_TYPE="ListType",i.NON_NULL_TYPE="NonNullType",i.SCHEMA_DEFINITION="SchemaDefinition",i.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",i.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",i.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",i.FIELD_DEFINITION="FieldDefinition",i.INPUT_VALUE_DEFINITION="InputValueDefinition",i.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",i.UNION_TYPE_DEFINITION="UnionTypeDefinition",i.ENUM_TYPE_DEFINITION="EnumTypeDefinition",i.ENUM_VALUE_DEFINITION="EnumValueDefinition",i.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",i.DIRECTIVE_DEFINITION="DirectiveDefinition",i.SCHEMA_EXTENSION="SchemaExtension",i.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",i.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",i.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",i.UNION_TYPE_EXTENSION="UnionTypeExtension",i.ENUM_TYPE_EXTENSION="EnumTypeExtension",i.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(Nt||(Nt={}));function fx(i){return i===9||i===32}function Ky(i){return i>=48&&i<=57}function r2(i){return i>=97&&i<=122||i>=65&&i<=90}function eb(i){return r2(i)||i===95}function a2(i){return r2(i)||Ky(i)||i===95}function iA(i){var n;let a=Number.MAX_SAFE_INTEGER,h=null,p=-1;for(let v=0;v<i.length;++v){var _;const c=i[v],C=rA(c);C!==c.length&&(h=(_=h)!==null&&_!==void 0?_:v,p=v,v!==0&&C<a&&(a=C))}return i.map((v,c)=>c===0?v:v.slice(a)).slice((n=h)!==null&&n!==void 0?n:0,p+1)}function rA(i){let n=0;for(;n<i.length&&fx(i.charCodeAt(n));)++n;return n}function aA(i,n){const a=i.replace(/"""/g,'\\"""'),h=a.split(/\r\n|[\n\r]/g),p=h.length===1,_=h.length>1&&h.slice(1).every(V=>V.length===0||fx(V.charCodeAt(0))),v=a.endsWith('\\"""'),c=i.endsWith('"')&&!v,C=i.endsWith("\\"),k=c||C,P=!p||i.length>70||k||_||v;let j="";const U=p&&fx(i.charCodeAt(0));return(P&&!U||_)&&(j+=`
`),j+=a,(P||k)&&(j+=`
`),'"""'+j+'"""'}var bt;(function(i){i.SOF="<SOF>",i.EOF="<EOF>",i.BANG="!",i.DOLLAR="$",i.AMP="&",i.PAREN_L="(",i.PAREN_R=")",i.SPREAD="...",i.COLON=":",i.EQUALS="=",i.AT="@",i.BRACKET_L="[",i.BRACKET_R="]",i.BRACE_L="{",i.PIPE="|",i.BRACE_R="}",i.NAME="Name",i.INT="Int",i.FLOAT="Float",i.STRING="String",i.BLOCK_STRING="BlockString",i.COMMENT="Comment"})(bt||(bt={}));class sA{constructor(n){const a=new n2(bt.SOF,0,0,0,0);this.source=n,this.lastToken=a,this.token=a,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let n=this.token;if(n.kind!==bt.EOF)do if(n.next)n=n.next;else{const a=lA(this,n.end);n.next=a,a.prev=n,n=a}while(n.kind===bt.COMMENT);return n}}function oA(i){return i===bt.BANG||i===bt.DOLLAR||i===bt.AMP||i===bt.PAREN_L||i===bt.PAREN_R||i===bt.SPREAD||i===bt.COLON||i===bt.EQUALS||i===bt.AT||i===bt.BRACKET_L||i===bt.BRACKET_R||i===bt.BRACE_L||i===bt.PIPE||i===bt.BRACE_R}function gg(i){return i>=0&&i<=55295||i>=57344&&i<=1114111}function iv(i,n){return s2(i.charCodeAt(n))&&o2(i.charCodeAt(n+1))}function s2(i){return i>=55296&&i<=56319}function o2(i){return i>=56320&&i<=57343}function Ep(i,n){const a=i.source.body.codePointAt(n);if(a===void 0)return bt.EOF;if(a>=32&&a<=126){const h=String.fromCodePoint(a);return h==='"'?`'"'`:`"${h}"`}return"U+"+a.toString(16).toUpperCase().padStart(4,"0")}function Hr(i,n,a,h,p){const _=i.line,v=1+a-i.lineStart;return new n2(n,a,h,_,v,p)}function lA(i,n){const a=i.source.body,h=a.length;let p=n;for(;p<h;){const _=a.charCodeAt(p);switch(_){case 65279:case 9:case 32:case 44:++p;continue;case 10:++p,++i.line,i.lineStart=p;continue;case 13:a.charCodeAt(p+1)===10?p+=2:++p,++i.line,i.lineStart=p;continue;case 35:return cA(i,p);case 33:return Hr(i,bt.BANG,p,p+1);case 36:return Hr(i,bt.DOLLAR,p,p+1);case 38:return Hr(i,bt.AMP,p,p+1);case 40:return Hr(i,bt.PAREN_L,p,p+1);case 41:return Hr(i,bt.PAREN_R,p,p+1);case 46:if(a.charCodeAt(p+1)===46&&a.charCodeAt(p+2)===46)return Hr(i,bt.SPREAD,p,p+3);break;case 58:return Hr(i,bt.COLON,p,p+1);case 61:return Hr(i,bt.EQUALS,p,p+1);case 64:return Hr(i,bt.AT,p,p+1);case 91:return Hr(i,bt.BRACKET_L,p,p+1);case 93:return Hr(i,bt.BRACKET_R,p,p+1);case 123:return Hr(i,bt.BRACE_L,p,p+1);case 124:return Hr(i,bt.PIPE,p,p+1);case 125:return Hr(i,bt.BRACE_R,p,p+1);case 34:return a.charCodeAt(p+1)===34&&a.charCodeAt(p+2)===34?mA(i,p):hA(i,p)}if(Ky(_)||_===45)return uA(i,p,_);if(eb(_))return gA(i,p);throw va(i.source,p,_===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:gg(_)||iv(a,p)?`Unexpected character: ${Ep(i,p)}.`:`Invalid character: ${Ep(i,p)}.`)}return Hr(i,bt.EOF,h,h)}function cA(i,n){const a=i.source.body,h=a.length;let p=n+1;for(;p<h;){const _=a.charCodeAt(p);if(_===10||_===13)break;if(gg(_))++p;else if(iv(a,p))p+=2;else break}return Hr(i,bt.COMMENT,n,p,a.slice(n+1,p))}function uA(i,n,a){const h=i.source.body;let p=n,_=a,v=!1;if(_===45&&(_=h.charCodeAt(++p)),_===48){if(_=h.charCodeAt(++p),Ky(_))throw va(i.source,p,`Invalid number, unexpected digit after 0: ${Ep(i,p)}.`)}else p=Zv(i,p,_),_=h.charCodeAt(p);if(_===46&&(v=!0,_=h.charCodeAt(++p),p=Zv(i,p,_),_=h.charCodeAt(p)),(_===69||_===101)&&(v=!0,_=h.charCodeAt(++p),(_===43||_===45)&&(_=h.charCodeAt(++p)),p=Zv(i,p,_),_=h.charCodeAt(p)),_===46||eb(_))throw va(i.source,p,`Invalid number, expected digit but got: ${Ep(i,p)}.`);return Hr(i,v?bt.FLOAT:bt.INT,n,p,h.slice(n,p))}function Zv(i,n,a){if(!Ky(a))throw va(i.source,n,`Invalid number, expected digit but got: ${Ep(i,n)}.`);const h=i.source.body;let p=n+1;for(;Ky(h.charCodeAt(p));)++p;return p}function hA(i,n){const a=i.source.body,h=a.length;let p=n+1,_=p,v="";for(;p<h;){const c=a.charCodeAt(p);if(c===34)return v+=a.slice(_,p),Hr(i,bt.STRING,n,p+1,v);if(c===92){v+=a.slice(_,p);const C=a.charCodeAt(p+1)===117?a.charCodeAt(p+2)===123?dA(i,p):fA(i,p):pA(i,p);v+=C.value,p+=C.size,_=p;continue}if(c===10||c===13)break;if(gg(c))++p;else if(iv(a,p))p+=2;else throw va(i.source,p,`Invalid character within String: ${Ep(i,p)}.`)}throw va(i.source,p,"Unterminated string.")}function dA(i,n){const a=i.source.body;let h=0,p=3;for(;p<12;){const _=a.charCodeAt(n+p++);if(_===125){if(p<5||!gg(h))break;return{value:String.fromCodePoint(h),size:p}}if(h=h<<4|ky(_),h<0)break}throw va(i.source,n,`Invalid Unicode escape sequence: "${a.slice(n,n+p)}".`)}function fA(i,n){const a=i.source.body,h=m1(a,n+2);if(gg(h))return{value:String.fromCodePoint(h),size:6};if(s2(h)&&a.charCodeAt(n+6)===92&&a.charCodeAt(n+7)===117){const p=m1(a,n+8);if(o2(p))return{value:String.fromCodePoint(h,p),size:12}}throw va(i.source,n,`Invalid Unicode escape sequence: "${a.slice(n,n+6)}".`)}function m1(i,n){return ky(i.charCodeAt(n))<<12|ky(i.charCodeAt(n+1))<<8|ky(i.charCodeAt(n+2))<<4|ky(i.charCodeAt(n+3))}function ky(i){return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:-1}function pA(i,n){const a=i.source.body;switch(a.charCodeAt(n+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw va(i.source,n,`Invalid character escape sequence: "${a.slice(n,n+2)}".`)}function mA(i,n){const a=i.source.body,h=a.length;let p=i.lineStart,_=n+3,v=_,c="";const C=[];for(;_<h;){const k=a.charCodeAt(_);if(k===34&&a.charCodeAt(_+1)===34&&a.charCodeAt(_+2)===34){c+=a.slice(v,_),C.push(c);const P=Hr(i,bt.BLOCK_STRING,n,_+3,iA(C).join(`
`));return i.line+=C.length-1,i.lineStart=p,P}if(k===92&&a.charCodeAt(_+1)===34&&a.charCodeAt(_+2)===34&&a.charCodeAt(_+3)===34){c+=a.slice(v,_),v=_+1,_+=4;continue}if(k===10||k===13){c+=a.slice(v,_),C.push(c),k===13&&a.charCodeAt(_+1)===10?_+=2:++_,c="",v=_,p=_;continue}if(gg(k))++_;else if(iv(a,_))_+=2;else throw va(i.source,_,`Invalid character within String: ${Ep(i,_)}.`)}throw va(i.source,_,"Unterminated string.")}function gA(i,n){const a=i.source.body,h=a.length;let p=n+1;for(;p<h;){const _=a.charCodeAt(p);if(a2(_))++p;else break}return Hr(i,bt.NAME,n,p,a.slice(n,p))}const yA=10,l2=2;function vn(i){return rv(i,[])}function rv(i,n){switch(typeof i){case"string":return JSON.stringify(i);case"function":return i.name?`[function ${i.name}]`:"[function]";case"object":return _A(i,n);default:return String(i)}}function _A(i,n){if(i===null)return"null";if(n.includes(i))return"[Circular]";const a=[...n,i];if(vA(i)){const h=i.toJSON();if(h!==i)return typeof h=="string"?h:rv(h,a)}else if(Array.isArray(i))return bA(i,a);return xA(i,a)}function vA(i){return typeof i.toJSON=="function"}function xA(i,n){const a=Object.entries(i);return a.length===0?"{}":n.length>l2?"["+wA(i)+"]":"{ "+a.map(([p,_])=>p+": "+rv(_,n)).join(", ")+" }"}function bA(i,n){if(i.length===0)return"[]";if(n.length>l2)return"[Array]";const a=Math.min(yA,i.length),h=i.length-a,p=[];for(let _=0;_<a;++_)p.push(rv(i[_],n));return h===1?p.push("... 1 more item"):h>1&&p.push(`... ${h} more items`),"["+p.join(", ")+"]"}function wA(i){const n=Object.prototype.toString.call(i).replace(/^\[object /,"").replace(/]$/,"");if(n==="Object"&&typeof i.constructor=="function"){const a=i.constructor.name;if(typeof a=="string"&&a!=="")return a}return n}const TA=globalThis.process&&!0,Iu=TA?function(n,a){return n instanceof a}:function(n,a){if(n instanceof a)return!0;if(typeof n=="object"&&n!==null){var h;const p=a.prototype[Symbol.toStringTag],_=Symbol.toStringTag in n?n[Symbol.toStringTag]:(h=n.constructor)===null||h===void 0?void 0:h.name;if(p===_){const v=vn(n);throw new Error(`Cannot use ${p} "${v}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class c2{constructor(n,a="GraphQL request",h={line:1,column:1}){typeof n=="string"||mi(!1,`Body must be a string. Received: ${vn(n)}.`),this.body=n,this.name=a,this.locationOffset=h,this.locationOffset.line>0||mi(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||mi(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function EA(i){return Iu(i,c2)}function SA(i,n){const a=new u2(i,n),h=a.parseDocument();return Object.defineProperty(h,"tokenCount",{enumerable:!1,value:a.tokenCount}),h}function AA(i,n){const a=new u2(i,n);a.expectToken(bt.SOF);const h=a.parseValueLiteral(!1);return a.expectToken(bt.EOF),h}class u2{constructor(n,a={}){const h=EA(n)?n:new c2(n);this._lexer=new sA(h),this._options=a,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const n=this.expectToken(bt.NAME);return this.node(n,{kind:Nt.NAME,value:n.value})}parseDocument(){return this.node(this._lexer.token,{kind:Nt.DOCUMENT,definitions:this.many(bt.SOF,this.parseDefinition,bt.EOF)})}parseDefinition(){if(this.peek(bt.BRACE_L))return this.parseOperationDefinition();const n=this.peekDescription(),a=n?this._lexer.lookahead():this._lexer.token;if(a.kind===bt.NAME){switch(a.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(n)throw va(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(a.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(a)}parseOperationDefinition(){const n=this._lexer.token;if(this.peek(bt.BRACE_L))return this.node(n,{kind:Nt.OPERATION_DEFINITION,operation:xu.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const a=this.parseOperationType();let h;return this.peek(bt.NAME)&&(h=this.parseName()),this.node(n,{kind:Nt.OPERATION_DEFINITION,operation:a,name:h,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const n=this.expectToken(bt.NAME);switch(n.value){case"query":return xu.QUERY;case"mutation":return xu.MUTATION;case"subscription":return xu.SUBSCRIPTION}throw this.unexpected(n)}parseVariableDefinitions(){return this.optionalMany(bt.PAREN_L,this.parseVariableDefinition,bt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:Nt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(bt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(bt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const n=this._lexer.token;return this.expectToken(bt.DOLLAR),this.node(n,{kind:Nt.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:Nt.SELECTION_SET,selections:this.many(bt.BRACE_L,this.parseSelection,bt.BRACE_R)})}parseSelection(){return this.peek(bt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const n=this._lexer.token,a=this.parseName();let h,p;return this.expectOptionalToken(bt.COLON)?(h=a,p=this.parseName()):p=a,this.node(n,{kind:Nt.FIELD,alias:h,name:p,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(bt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(n){const a=n?this.parseConstArgument:this.parseArgument;return this.optionalMany(bt.PAREN_L,a,bt.PAREN_R)}parseArgument(n=!1){const a=this._lexer.token,h=this.parseName();return this.expectToken(bt.COLON),this.node(a,{kind:Nt.ARGUMENT,name:h,value:this.parseValueLiteral(n)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const n=this._lexer.token;this.expectToken(bt.SPREAD);const a=this.expectOptionalKeyword("on");return!a&&this.peek(bt.NAME)?this.node(n,{kind:Nt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(n,{kind:Nt.INLINE_FRAGMENT,typeCondition:a?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const n=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(n,{kind:Nt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(n,{kind:Nt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(n){const a=this._lexer.token;switch(a.kind){case bt.BRACKET_L:return this.parseList(n);case bt.BRACE_L:return this.parseObject(n);case bt.INT:return this.advanceLexer(),this.node(a,{kind:Nt.INT,value:a.value});case bt.FLOAT:return this.advanceLexer(),this.node(a,{kind:Nt.FLOAT,value:a.value});case bt.STRING:case bt.BLOCK_STRING:return this.parseStringLiteral();case bt.NAME:switch(this.advanceLexer(),a.value){case"true":return this.node(a,{kind:Nt.BOOLEAN,value:!0});case"false":return this.node(a,{kind:Nt.BOOLEAN,value:!1});case"null":return this.node(a,{kind:Nt.NULL});default:return this.node(a,{kind:Nt.ENUM,value:a.value})}case bt.DOLLAR:if(n)if(this.expectToken(bt.DOLLAR),this._lexer.token.kind===bt.NAME){const h=this._lexer.token.value;throw va(this._lexer.source,a.start,`Unexpected variable "$${h}" in constant value.`)}else throw this.unexpected(a);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const n=this._lexer.token;return this.advanceLexer(),this.node(n,{kind:Nt.STRING,value:n.value,block:n.kind===bt.BLOCK_STRING})}parseList(n){const a=()=>this.parseValueLiteral(n);return this.node(this._lexer.token,{kind:Nt.LIST,values:this.any(bt.BRACKET_L,a,bt.BRACKET_R)})}parseObject(n){const a=()=>this.parseObjectField(n);return this.node(this._lexer.token,{kind:Nt.OBJECT,fields:this.any(bt.BRACE_L,a,bt.BRACE_R)})}parseObjectField(n){const a=this._lexer.token,h=this.parseName();return this.expectToken(bt.COLON),this.node(a,{kind:Nt.OBJECT_FIELD,name:h,value:this.parseValueLiteral(n)})}parseDirectives(n){const a=[];for(;this.peek(bt.AT);)a.push(this.parseDirective(n));return a}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(n){const a=this._lexer.token;return this.expectToken(bt.AT),this.node(a,{kind:Nt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(n)})}parseTypeReference(){const n=this._lexer.token;let a;if(this.expectOptionalToken(bt.BRACKET_L)){const h=this.parseTypeReference();this.expectToken(bt.BRACKET_R),a=this.node(n,{kind:Nt.LIST_TYPE,type:h})}else a=this.parseNamedType();return this.expectOptionalToken(bt.BANG)?this.node(n,{kind:Nt.NON_NULL_TYPE,type:a}):a}parseNamedType(){return this.node(this._lexer.token,{kind:Nt.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(bt.STRING)||this.peek(bt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("schema");const h=this.parseConstDirectives(),p=this.many(bt.BRACE_L,this.parseOperationTypeDefinition,bt.BRACE_R);return this.node(n,{kind:Nt.SCHEMA_DEFINITION,description:a,directives:h,operationTypes:p})}parseOperationTypeDefinition(){const n=this._lexer.token,a=this.parseOperationType();this.expectToken(bt.COLON);const h=this.parseNamedType();return this.node(n,{kind:Nt.OPERATION_TYPE_DEFINITION,operation:a,type:h})}parseScalarTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("scalar");const h=this.parseName(),p=this.parseConstDirectives();return this.node(n,{kind:Nt.SCALAR_TYPE_DEFINITION,description:a,name:h,directives:p})}parseObjectTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("type");const h=this.parseName(),p=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:Nt.OBJECT_TYPE_DEFINITION,description:a,name:h,interfaces:p,directives:_,fields:v})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(bt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(bt.BRACE_L,this.parseFieldDefinition,bt.BRACE_R)}parseFieldDefinition(){const n=this._lexer.token,a=this.parseDescription(),h=this.parseName(),p=this.parseArgumentDefs();this.expectToken(bt.COLON);const _=this.parseTypeReference(),v=this.parseConstDirectives();return this.node(n,{kind:Nt.FIELD_DEFINITION,description:a,name:h,arguments:p,type:_,directives:v})}parseArgumentDefs(){return this.optionalMany(bt.PAREN_L,this.parseInputValueDef,bt.PAREN_R)}parseInputValueDef(){const n=this._lexer.token,a=this.parseDescription(),h=this.parseName();this.expectToken(bt.COLON);const p=this.parseTypeReference();let _;this.expectOptionalToken(bt.EQUALS)&&(_=this.parseConstValueLiteral());const v=this.parseConstDirectives();return this.node(n,{kind:Nt.INPUT_VALUE_DEFINITION,description:a,name:h,type:p,defaultValue:_,directives:v})}parseInterfaceTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("interface");const h=this.parseName(),p=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:Nt.INTERFACE_TYPE_DEFINITION,description:a,name:h,interfaces:p,directives:_,fields:v})}parseUnionTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("union");const h=this.parseName(),p=this.parseConstDirectives(),_=this.parseUnionMemberTypes();return this.node(n,{kind:Nt.UNION_TYPE_DEFINITION,description:a,name:h,directives:p,types:_})}parseUnionMemberTypes(){return this.expectOptionalToken(bt.EQUALS)?this.delimitedMany(bt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("enum");const h=this.parseName(),p=this.parseConstDirectives(),_=this.parseEnumValuesDefinition();return this.node(n,{kind:Nt.ENUM_TYPE_DEFINITION,description:a,name:h,directives:p,values:_})}parseEnumValuesDefinition(){return this.optionalMany(bt.BRACE_L,this.parseEnumValueDefinition,bt.BRACE_R)}parseEnumValueDefinition(){const n=this._lexer.token,a=this.parseDescription(),h=this.parseEnumValueName(),p=this.parseConstDirectives();return this.node(n,{kind:Nt.ENUM_VALUE_DEFINITION,description:a,name:h,directives:p})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw va(this._lexer.source,this._lexer.token.start,`${T0(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("input");const h=this.parseName(),p=this.parseConstDirectives(),_=this.parseInputFieldsDefinition();return this.node(n,{kind:Nt.INPUT_OBJECT_TYPE_DEFINITION,description:a,name:h,directives:p,fields:_})}parseInputFieldsDefinition(){return this.optionalMany(bt.BRACE_L,this.parseInputValueDef,bt.BRACE_R)}parseTypeSystemExtension(){const n=this._lexer.lookahead();if(n.kind===bt.NAME)switch(n.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(n)}parseSchemaExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const a=this.parseConstDirectives(),h=this.optionalMany(bt.BRACE_L,this.parseOperationTypeDefinition,bt.BRACE_R);if(a.length===0&&h.length===0)throw this.unexpected();return this.node(n,{kind:Nt.SCHEMA_EXTENSION,directives:a,operationTypes:h})}parseScalarTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const a=this.parseName(),h=this.parseConstDirectives();if(h.length===0)throw this.unexpected();return this.node(n,{kind:Nt.SCALAR_TYPE_EXTENSION,name:a,directives:h})}parseObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const a=this.parseName(),h=this.parseImplementsInterfaces(),p=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(h.length===0&&p.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:Nt.OBJECT_TYPE_EXTENSION,name:a,interfaces:h,directives:p,fields:_})}parseInterfaceTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const a=this.parseName(),h=this.parseImplementsInterfaces(),p=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(h.length===0&&p.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:Nt.INTERFACE_TYPE_EXTENSION,name:a,interfaces:h,directives:p,fields:_})}parseUnionTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const a=this.parseName(),h=this.parseConstDirectives(),p=this.parseUnionMemberTypes();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Nt.UNION_TYPE_EXTENSION,name:a,directives:h,types:p})}parseEnumTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const a=this.parseName(),h=this.parseConstDirectives(),p=this.parseEnumValuesDefinition();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Nt.ENUM_TYPE_EXTENSION,name:a,directives:h,values:p})}parseInputObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const a=this.parseName(),h=this.parseConstDirectives(),p=this.parseInputFieldsDefinition();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Nt.INPUT_OBJECT_TYPE_EXTENSION,name:a,directives:h,fields:p})}parseDirectiveDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("directive"),this.expectToken(bt.AT);const h=this.parseName(),p=this.parseArgumentDefs(),_=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const v=this.parseDirectiveLocations();return this.node(n,{kind:Nt.DIRECTIVE_DEFINITION,description:a,name:h,arguments:p,repeatable:_,locations:v})}parseDirectiveLocations(){return this.delimitedMany(bt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const n=this._lexer.token,a=this.parseName();if(Object.prototype.hasOwnProperty.call(Qn,a.value))return a;throw this.unexpected(n)}node(n,a){return this._options.noLocation!==!0&&(a.loc=new tA(n,this._lexer.lastToken,this._lexer.source)),a}peek(n){return this._lexer.token.kind===n}expectToken(n){const a=this._lexer.token;if(a.kind===n)return this.advanceLexer(),a;throw va(this._lexer.source,a.start,`Expected ${h2(n)}, found ${T0(a)}.`)}expectOptionalToken(n){return this._lexer.token.kind===n?(this.advanceLexer(),!0):!1}expectKeyword(n){const a=this._lexer.token;if(a.kind===bt.NAME&&a.value===n)this.advanceLexer();else throw va(this._lexer.source,a.start,`Expected "${n}", found ${T0(a)}.`)}expectOptionalKeyword(n){const a=this._lexer.token;return a.kind===bt.NAME&&a.value===n?(this.advanceLexer(),!0):!1}unexpected(n){const a=n??this._lexer.token;return va(this._lexer.source,a.start,`Unexpected ${T0(a)}.`)}any(n,a,h){this.expectToken(n);const p=[];for(;!this.expectOptionalToken(h);)p.push(a.call(this));return p}optionalMany(n,a,h){if(this.expectOptionalToken(n)){const p=[];do p.push(a.call(this));while(!this.expectOptionalToken(h));return p}return[]}many(n,a,h){this.expectToken(n);const p=[];do p.push(a.call(this));while(!this.expectOptionalToken(h));return p}delimitedMany(n,a){this.expectOptionalToken(n);const h=[];do h.push(a.call(this));while(this.expectOptionalToken(n));return h}advanceLexer(){const{maxTokens:n}=this._options,a=this._lexer.advance();if(a.kind!==bt.EOF&&(++this._tokenCounter,n!==void 0&&this._tokenCounter>n))throw va(this._lexer.source,a.start,`Document contains more that ${n} tokens. Parsing aborted.`)}}function T0(i){const n=i.value;return h2(i.kind)+(n!=null?` "${n}"`:"")}function h2(i){return oA(i)?`"${i}"`:i}const MA=5;function CA(i,n){const[a,h]=n?[i,n]:[void 0,i];let p=" Did you mean ";a&&(p+=a+" ");const _=h.map(C=>`"${C}"`);switch(_.length){case 0:return"";case 1:return p+_[0]+"?";case 2:return p+_[0]+" or "+_[1]+"?"}const v=_.slice(0,MA),c=v.pop();return p+v.join(", ")+", or "+c+"?"}function g1(i){return i}function d2(i,n){const a=Object.create(null);for(const h of i)a[n(h)]=h;return a}function vp(i,n,a){const h=Object.create(null);for(const p of i)h[n(p)]=a(p);return h}function av(i,n){const a=Object.create(null);for(const h of Object.keys(i))a[h]=n(i[h],h);return a}function DA(i,n){let a=0,h=0;for(;a<i.length&&h<n.length;){let p=i.charCodeAt(a),_=n.charCodeAt(h);if(E0(p)&&E0(_)){let v=0;do++a,v=v*10+p-px,p=i.charCodeAt(a);while(E0(p)&&v>0);let c=0;do++h,c=c*10+_-px,_=n.charCodeAt(h);while(E0(_)&&c>0);if(v<c)return-1;if(v>c)return 1}else{if(p<_)return-1;if(p>_)return 1;++a,++h}}return i.length-n.length}const px=48,kA=57;function E0(i){return!isNaN(i)&&px<=i&&i<=kA}function IA(i,n){const a=Object.create(null),h=new RA(i),p=Math.floor(i.length*.4)+1;for(const _ of n){const v=h.measure(_,p);v!==void 0&&(a[_]=v)}return Object.keys(a).sort((_,v)=>{const c=a[_]-a[v];return c!==0?c:DA(_,v)})}class RA{constructor(n){this._input=n,this._inputLowerCase=n.toLowerCase(),this._inputArray=y1(this._inputLowerCase),this._rows=[new Array(n.length+1).fill(0),new Array(n.length+1).fill(0),new Array(n.length+1).fill(0)]}measure(n,a){if(this._input===n)return 0;const h=n.toLowerCase();if(this._inputLowerCase===h)return 1;let p=y1(h),_=this._inputArray;if(p.length<_.length){const P=p;p=_,_=P}const v=p.length,c=_.length;if(v-c>a)return;const C=this._rows;for(let P=0;P<=c;P++)C[0][P]=P;for(let P=1;P<=v;P++){const j=C[(P-1)%3],U=C[P%3];let V=U[0]=P;for(let ie=1;ie<=c;ie++){const me=p[P-1]===_[ie-1]?0:1;let pe=Math.min(j[ie]+1,U[ie-1]+1,j[ie-1]+me);if(P>1&&ie>1&&p[P-1]===_[ie-2]&&p[P-2]===_[ie-1]){const Le=C[(P-2)%3][ie-2];pe=Math.min(pe,Le+1)}pe<V&&(V=pe),U[ie]=pe}if(V>a)return}const k=C[v%3][c];return k<=a?k:void 0}}function y1(i){const n=i.length,a=new Array(n);for(let h=0;h<n;++h)a[h]=i.charCodeAt(h);return a}function Ul(i){if(i==null)return Object.create(null);if(Object.getPrototypeOf(i)===null)return i;const n=Object.create(null);for(const[a,h]of Object.entries(i))n[a]=h;return n}function zA(i){return`"${i.replace(LA,NA)}"`}const LA=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function NA(i){return PA[i.charCodeAt(0)]}const PA=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],OA=Object.freeze({});function jA(i,n,a=i2){const h=new Map;for(const Le of Object.values(Nt))h.set(Le,BA(n,Le));let p,_=Array.isArray(i),v=[i],c=-1,C=[],k=i,P,j;const U=[],V=[];do{c++;const Le=c===v.length,Qe=Le&&C.length!==0;if(Le){if(P=V.length===0?void 0:U[U.length-1],k=j,j=V.pop(),Qe)if(_){k=k.slice();let $e=0;for(const[ke,Ze]of C){const nt=ke-$e;Ze===null?(k.splice(nt,1),$e++):k[nt]=Ze}}else{k=Object.defineProperties({},Object.getOwnPropertyDescriptors(k));for(const[$e,ke]of C)k[$e]=ke}c=p.index,v=p.keys,C=p.edits,_=p.inArray,p=p.prev}else if(j){if(P=_?c:v[c],k=j[P],k==null)continue;U.push(P)}let He;if(!Array.isArray(k)){var ie,me;p1(k)||mi(!1,`Invalid AST Node: ${vn(k)}.`);const $e=Le?(ie=h.get(k.kind))===null||ie===void 0?void 0:ie.leave:(me=h.get(k.kind))===null||me===void 0?void 0:me.enter;if(He=$e==null?void 0:$e.call(n,k,P,j,U,V),He===OA)break;if(He===!1){if(!Le){U.pop();continue}}else if(He!==void 0&&(C.push([P,He]),!Le))if(p1(He))k=He;else{U.pop();continue}}if(He===void 0&&Qe&&C.push([P,k]),Le)U.pop();else{var pe;p={inArray:_,index:c,keys:v,edits:C,prev:p},_=Array.isArray(k),v=_?k:(pe=a[k.kind])!==null&&pe!==void 0?pe:[],c=-1,C=[],j&&V.push(j),j=k}}while(p!==void 0);return C.length!==0?C[C.length-1][1]:i}function BA(i,n){const a=i[n];return typeof a=="object"?a:typeof a=="function"?{enter:a,leave:void 0}:{enter:i.enter,leave:i.leave}}function Qo(i){return jA(i,UA)}const FA=80,UA={Name:{leave:i=>i.value},Variable:{leave:i=>"$"+i.name},Document:{leave:i=>en(i.definitions,`

`)},OperationDefinition:{leave(i){const n=Vn("(",en(i.variableDefinitions,", "),")"),a=en([i.operation,en([i.name,n]),en(i.directives," ")]," ");return(a==="query"?"":a+" ")+i.selectionSet}},VariableDefinition:{leave:({variable:i,type:n,defaultValue:a,directives:h})=>i+": "+n+Vn(" = ",a)+Vn(" ",en(h," "))},SelectionSet:{leave:({selections:i})=>zc(i)},Field:{leave({alias:i,name:n,arguments:a,directives:h,selectionSet:p}){const _=Vn("",i,": ")+n;let v=_+Vn("(",en(a,", "),")");return v.length>FA&&(v=_+Vn(`(
`,R0(en(a,`
`)),`
)`)),en([v,en(h," "),p]," ")}},Argument:{leave:({name:i,value:n})=>i+": "+n},FragmentSpread:{leave:({name:i,directives:n})=>"..."+i+Vn(" ",en(n," "))},InlineFragment:{leave:({typeCondition:i,directives:n,selectionSet:a})=>en(["...",Vn("on ",i),en(n," "),a]," ")},FragmentDefinition:{leave:({name:i,typeCondition:n,variableDefinitions:a,directives:h,selectionSet:p})=>`fragment ${i}${Vn("(",en(a,", "),")")} on ${n} ${Vn("",en(h," ")," ")}`+p},IntValue:{leave:({value:i})=>i},FloatValue:{leave:({value:i})=>i},StringValue:{leave:({value:i,block:n})=>n?aA(i):zA(i)},BooleanValue:{leave:({value:i})=>i?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:i})=>i},ListValue:{leave:({values:i})=>"["+en(i,", ")+"]"},ObjectValue:{leave:({fields:i})=>"{"+en(i,", ")+"}"},ObjectField:{leave:({name:i,value:n})=>i+": "+n},Directive:{leave:({name:i,arguments:n})=>"@"+i+Vn("(",en(n,", "),")")},NamedType:{leave:({name:i})=>i},ListType:{leave:({type:i})=>"["+i+"]"},NonNullType:{leave:({type:i})=>i+"!"},SchemaDefinition:{leave:({description:i,directives:n,operationTypes:a})=>Vn("",i,`
`)+en(["schema",en(n," "),zc(a)]," ")},OperationTypeDefinition:{leave:({operation:i,type:n})=>i+": "+n},ScalarTypeDefinition:{leave:({description:i,name:n,directives:a})=>Vn("",i,`
`)+en(["scalar",n,en(a," ")]," ")},ObjectTypeDefinition:{leave:({description:i,name:n,interfaces:a,directives:h,fields:p})=>Vn("",i,`
`)+en(["type",n,Vn("implements ",en(a," & ")),en(h," "),zc(p)]," ")},FieldDefinition:{leave:({description:i,name:n,arguments:a,type:h,directives:p})=>Vn("",i,`
`)+n+(_1(a)?Vn(`(
`,R0(en(a,`
`)),`
)`):Vn("(",en(a,", "),")"))+": "+h+Vn(" ",en(p," "))},InputValueDefinition:{leave:({description:i,name:n,type:a,defaultValue:h,directives:p})=>Vn("",i,`
`)+en([n+": "+a,Vn("= ",h),en(p," ")]," ")},InterfaceTypeDefinition:{leave:({description:i,name:n,interfaces:a,directives:h,fields:p})=>Vn("",i,`
`)+en(["interface",n,Vn("implements ",en(a," & ")),en(h," "),zc(p)]," ")},UnionTypeDefinition:{leave:({description:i,name:n,directives:a,types:h})=>Vn("",i,`
`)+en(["union",n,en(a," "),Vn("= ",en(h," | "))]," ")},EnumTypeDefinition:{leave:({description:i,name:n,directives:a,values:h})=>Vn("",i,`
`)+en(["enum",n,en(a," "),zc(h)]," ")},EnumValueDefinition:{leave:({description:i,name:n,directives:a})=>Vn("",i,`
`)+en([n,en(a," ")]," ")},InputObjectTypeDefinition:{leave:({description:i,name:n,directives:a,fields:h})=>Vn("",i,`
`)+en(["input",n,en(a," "),zc(h)]," ")},DirectiveDefinition:{leave:({description:i,name:n,arguments:a,repeatable:h,locations:p})=>Vn("",i,`
`)+"directive @"+n+(_1(a)?Vn(`(
`,R0(en(a,`
`)),`
)`):Vn("(",en(a,", "),")"))+(h?" repeatable":"")+" on "+en(p," | ")},SchemaExtension:{leave:({directives:i,operationTypes:n})=>en(["extend schema",en(i," "),zc(n)]," ")},ScalarTypeExtension:{leave:({name:i,directives:n})=>en(["extend scalar",i,en(n," ")]," ")},ObjectTypeExtension:{leave:({name:i,interfaces:n,directives:a,fields:h})=>en(["extend type",i,Vn("implements ",en(n," & ")),en(a," "),zc(h)]," ")},InterfaceTypeExtension:{leave:({name:i,interfaces:n,directives:a,fields:h})=>en(["extend interface",i,Vn("implements ",en(n," & ")),en(a," "),zc(h)]," ")},UnionTypeExtension:{leave:({name:i,directives:n,types:a})=>en(["extend union",i,en(n," "),Vn("= ",en(a," | "))]," ")},EnumTypeExtension:{leave:({name:i,directives:n,values:a})=>en(["extend enum",i,en(n," "),zc(a)]," ")},InputObjectTypeExtension:{leave:({name:i,directives:n,fields:a})=>en(["extend input",i,en(n," "),zc(a)]," ")}};function en(i,n=""){var a;return(a=i==null?void 0:i.filter(h=>h).join(n))!==null&&a!==void 0?a:""}function zc(i){return Vn(`{
`,R0(en(i,`
`)),`
}`)}function Vn(i,n,a=""){return n!=null&&n!==""?i+n+a:""}function R0(i){return Vn("  ",i.replace(/\n/g,`
  `))}function _1(i){var n;return(n=i==null?void 0:i.some(a=>a.includes(`
`)))!==null&&n!==void 0?n:!1}function mx(i,n){switch(i.kind){case Nt.NULL:return null;case Nt.INT:return parseInt(i.value,10);case Nt.FLOAT:return parseFloat(i.value);case Nt.STRING:case Nt.ENUM:case Nt.BOOLEAN:return i.value;case Nt.LIST:return i.values.map(a=>mx(a,n));case Nt.OBJECT:return vp(i.fields,a=>a.name.value,a=>mx(a.value,n));case Nt.VARIABLE:return n==null?void 0:n[i.name.value]}}function Bc(i){if(i!=null||mi(!1,"Must provide name."),typeof i=="string"||mi(!1,"Expected name to be a string."),i.length===0)throw new Si("Expected name to be a non-empty string.");for(let n=1;n<i.length;++n)if(!a2(i.charCodeAt(n)))throw new Si(`Names must only contain [_a-zA-Z0-9] but "${i}" does not.`);if(!eb(i.charCodeAt(0)))throw new Si(`Names must start with [_a-zA-Z] but "${i}" does not.`);return i}function VA(i){if(i==="true"||i==="false"||i==="null")throw new Si(`Enum values cannot be named: ${i}`);return Bc(i)}function f2(i){return yg(i)||sf(i)||Oc(i)||Sp(i)||lf(i)||jh(i)||ff(i)||Bh(i)}function yg(i){return Iu(i,Pp)}function sf(i){return Iu(i,pf)}function ZA(i){if(!sf(i))throw new Error(`Expected ${vn(i)} to be a GraphQL Object type.`);return i}function Oc(i){return Iu(i,S2)}function GA(i){if(!Oc(i))throw new Error(`Expected ${vn(i)} to be a GraphQL Interface type.`);return i}function Sp(i){return Iu(i,A2)}function lf(i){return Iu(i,sv)}function jh(i){return Iu(i,M2)}function ff(i){return Iu(i,Il)}function Bh(i){return Iu(i,Hn)}function p2(i){return yg(i)||lf(i)||jh(i)||tb(i)&&p2(i.ofType)}function m2(i){return yg(i)||sf(i)||Oc(i)||Sp(i)||lf(i)||tb(i)&&m2(i.ofType)}function g2(i){return yg(i)||lf(i)}function $A(i){return Oc(i)||Sp(i)}class Il{constructor(n){f2(n)||mi(!1,`Expected ${vn(n)} to be a GraphQL type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class Hn{constructor(n){y2(n)||mi(!1,`Expected ${vn(n)} to be a GraphQL nullable type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function tb(i){return ff(i)||Bh(i)}function y2(i){return f2(i)&&!Bh(i)}function YA(i){if(!y2(i))throw new Error(`Expected ${vn(i)} to be a GraphQL nullable type.`);return i}function qA(i){if(i){let n=i;for(;tb(n);)n=n.ofType;return n}}function _2(i){return typeof i=="function"?i():i}function v2(i){return typeof i=="function"?i():i}class Pp{constructor(n){var a,h,p,_;const v=(a=n.parseValue)!==null&&a!==void 0?a:g1;this.name=Bc(n.name),this.description=n.description,this.specifiedByURL=n.specifiedByURL,this.serialize=(h=n.serialize)!==null&&h!==void 0?h:g1,this.parseValue=v,this.parseLiteral=(p=n.parseLiteral)!==null&&p!==void 0?p:(c,C)=>v(mx(c,C)),this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(_=n.extensionASTNodes)!==null&&_!==void 0?_:[],n.specifiedByURL==null||typeof n.specifiedByURL=="string"||mi(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${vn(n.specifiedByURL)}.`),n.serialize==null||typeof n.serialize=="function"||mi(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),n.parseLiteral&&(typeof n.parseValue=="function"&&typeof n.parseLiteral=="function"||mi(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class pf{constructor(n){var a;this.name=Bc(n.name),this.description=n.description,this.isTypeOf=n.isTypeOf,this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._fields=()=>b2(n),this._interfaces=()=>x2(n),n.isTypeOf==null||typeof n.isTypeOf=="function"||mi(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${vn(n.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:T2(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function x2(i){var n;const a=_2((n=i.interfaces)!==null&&n!==void 0?n:[]);return Array.isArray(a)||mi(!1,`${i.name} interfaces must be an Array or a function which returns an Array.`),a}function b2(i){const n=v2(i.fields);return Jm(n)||mi(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),av(n,(a,h)=>{var p;Jm(a)||mi(!1,`${i.name}.${h} field config must be an object.`),a.resolve==null||typeof a.resolve=="function"||mi(!1,`${i.name}.${h} field resolver must be a function if provided, but got: ${vn(a.resolve)}.`);const _=(p=a.args)!==null&&p!==void 0?p:{};return Jm(_)||mi(!1,`${i.name}.${h} args must be an object with argument names as keys.`),{name:Bc(h),description:a.description,type:a.type,args:w2(_),resolve:a.resolve,subscribe:a.subscribe,deprecationReason:a.deprecationReason,extensions:Ul(a.extensions),astNode:a.astNode}})}function w2(i){return Object.entries(i).map(([n,a])=>({name:Bc(n),description:a.description,type:a.type,defaultValue:a.defaultValue,deprecationReason:a.deprecationReason,extensions:Ul(a.extensions),astNode:a.astNode}))}function Jm(i){return Yh(i)&&!Array.isArray(i)}function T2(i){return av(i,n=>({description:n.description,type:n.type,args:E2(n.args),resolve:n.resolve,subscribe:n.subscribe,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function E2(i){return vp(i,n=>n.name,n=>({description:n.description,type:n.type,defaultValue:n.defaultValue,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}class S2{constructor(n){var a;this.name=Bc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._fields=b2.bind(void 0,n),this._interfaces=x2.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||mi(!1,`${this.name} must provide "resolveType" as a function, but got: ${vn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:T2(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class A2{constructor(n){var a;this.name=Bc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._types=HA.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||mi(!1,`${this.name} must provide "resolveType" as a function, but got: ${vn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function HA(i){const n=_2(i.types);return Array.isArray(n)||mi(!1,`Must provide Array of types or a function which returns such an array for Union ${i.name}.`),n}class sv{constructor(n){var a;this.name=Bc(n.name),this.description=n.description,this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._values=typeof n.values=="function"?n.values:v1(this.name,n.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=v1(this.name,this._values())),this._values}getValue(n){return this._nameLookup===null&&(this._nameLookup=d2(this.getValues(),a=>a.name)),this._nameLookup[n]}serialize(n){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(h=>[h.value,h])));const a=this._valueLookup.get(n);if(a===void 0)throw new Si(`Enum "${this.name}" cannot represent value: ${vn(n)}`);return a.name}parseValue(n){if(typeof n!="string"){const h=vn(n);throw new Si(`Enum "${this.name}" cannot represent non-string value: ${h}.`+S0(this,h))}const a=this.getValue(n);if(a==null)throw new Si(`Value "${n}" does not exist in "${this.name}" enum.`+S0(this,n));return a.value}parseLiteral(n,a){if(n.kind!==Nt.ENUM){const p=Qo(n);throw new Si(`Enum "${this.name}" cannot represent non-enum value: ${p}.`+S0(this,p),{nodes:n})}const h=this.getValue(n.value);if(h==null){const p=Qo(n);throw new Si(`Value "${p}" does not exist in "${this.name}" enum.`+S0(this,p),{nodes:n})}return h.value}toConfig(){const n=vp(this.getValues(),a=>a.name,a=>({description:a.description,value:a.value,deprecationReason:a.deprecationReason,extensions:a.extensions,astNode:a.astNode}));return{name:this.name,description:this.description,values:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function S0(i,n){const a=i.getValues().map(p=>p.name),h=IA(n,a);return CA("the enum value",h)}function v1(i,n){return Jm(n)||mi(!1,`${i} values must be an object with value names as keys.`),Object.entries(n).map(([a,h])=>(Jm(h)||mi(!1,`${i}.${a} must refer to an object with a "value" key representing an internal value but got: ${vn(h)}.`),{name:VA(a),description:h.description,value:h.value!==void 0?h.value:a,deprecationReason:h.deprecationReason,extensions:Ul(h.extensions),astNode:h.astNode}))}class M2{constructor(n){var a,h;this.name=Bc(n.name),this.description=n.description,this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this.isOneOf=(h=n.isOneOf)!==null&&h!==void 0?h:!1,this._fields=XA.bind(void 0,n)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const n=av(this.getFields(),a=>({description:a.description,type:a.type,defaultValue:a.defaultValue,deprecationReason:a.deprecationReason,extensions:a.extensions,astNode:a.astNode}));return{name:this.name,description:this.description,fields:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function XA(i){const n=v2(i.fields);return Jm(n)||mi(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),av(n,(a,h)=>(!("resolve"in a)||mi(!1,`${i.name}.${h} field has a resolve property, but Input Types cannot define resolvers.`),{name:Bc(h),description:a.description,type:a.type,defaultValue:a.defaultValue,deprecationReason:a.deprecationReason,extensions:Ul(a.extensions),astNode:a.astNode}))}const Gv=2147483647,$v=-2147483648,WA=new Pp({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(i){const n=f_(i);if(typeof n=="boolean")return n?1:0;let a=n;if(typeof n=="string"&&n!==""&&(a=Number(n)),typeof a!="number"||!Number.isInteger(a))throw new Si(`Int cannot represent non-integer value: ${vn(n)}`);if(a>Gv||a<$v)throw new Si("Int cannot represent non 32-bit signed integer value: "+vn(n));return a},parseValue(i){if(typeof i!="number"||!Number.isInteger(i))throw new Si(`Int cannot represent non-integer value: ${vn(i)}`);if(i>Gv||i<$v)throw new Si(`Int cannot represent non 32-bit signed integer value: ${i}`);return i},parseLiteral(i){if(i.kind!==Nt.INT)throw new Si(`Int cannot represent non-integer value: ${Qo(i)}`,{nodes:i});const n=parseInt(i.value,10);if(n>Gv||n<$v)throw new Si(`Int cannot represent non 32-bit signed integer value: ${i.value}`,{nodes:i});return n}}),QA=new Pp({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(i){const n=f_(i);if(typeof n=="boolean")return n?1:0;let a=n;if(typeof n=="string"&&n!==""&&(a=Number(n)),typeof a!="number"||!Number.isFinite(a))throw new Si(`Float cannot represent non numeric value: ${vn(n)}`);return a},parseValue(i){if(typeof i!="number"||!Number.isFinite(i))throw new Si(`Float cannot represent non numeric value: ${vn(i)}`);return i},parseLiteral(i){if(i.kind!==Nt.FLOAT&&i.kind!==Nt.INT)throw new Si(`Float cannot represent non numeric value: ${Qo(i)}`,i);return parseFloat(i.value)}}),Fr=new Pp({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(i){const n=f_(i);if(typeof n=="string")return n;if(typeof n=="boolean")return n?"true":"false";if(typeof n=="number"&&Number.isFinite(n))return n.toString();throw new Si(`String cannot represent value: ${vn(i)}`)},parseValue(i){if(typeof i!="string")throw new Si(`String cannot represent a non string value: ${vn(i)}`);return i},parseLiteral(i){if(i.kind!==Nt.STRING)throw new Si(`String cannot represent a non string value: ${Qo(i)}`,{nodes:i});return i.value}}),Ho=new Pp({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(i){const n=f_(i);if(typeof n=="boolean")return n;if(Number.isFinite(n))return n!==0;throw new Si(`Boolean cannot represent a non boolean value: ${vn(n)}`)},parseValue(i){if(typeof i!="boolean")throw new Si(`Boolean cannot represent a non boolean value: ${vn(i)}`);return i},parseLiteral(i){if(i.kind!==Nt.BOOLEAN)throw new Si(`Boolean cannot represent a non boolean value: ${Qo(i)}`,{nodes:i});return i.value}}),C2=new Pp({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(i){const n=f_(i);if(typeof n=="string")return n;if(Number.isInteger(n))return String(n);throw new Si(`ID cannot represent value: ${vn(i)}`)},parseValue(i){if(typeof i=="string")return i;if(typeof i=="number"&&Number.isInteger(i))return i.toString();throw new Si(`ID cannot represent value: ${vn(i)}`)},parseLiteral(i){if(i.kind!==Nt.STRING&&i.kind!==Nt.INT)throw new Si("ID cannot represent a non-string and non-integer value: "+Qo(i),{nodes:i});return i.value}}),KA=Object.freeze([Fr,WA,QA,Ho,C2]);function f_(i){if(Yh(i)){if(typeof i.valueOf=="function"){const n=i.valueOf();if(!Yh(n))return n}if(typeof i.toJSON=="function")return i.toJSON()}return i}function JA(i){return Iu(i,Op)}class Op{constructor(n){var a,h;this.name=Bc(n.name),this.description=n.description,this.locations=n.locations,this.isRepeatable=(a=n.isRepeatable)!==null&&a!==void 0?a:!1,this.extensions=Ul(n.extensions),this.astNode=n.astNode,Array.isArray(n.locations)||mi(!1,`@${n.name} locations must be an Array.`);const p=(h=n.args)!==null&&h!==void 0?h:{};Yh(p)&&!Array.isArray(p)||mi(!1,`@${n.name} args must be an object with argument names as keys.`),this.args=w2(p)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:E2(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const eM=new Op({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[Qn.FIELD,Qn.FRAGMENT_SPREAD,Qn.INLINE_FRAGMENT],args:{if:{type:new Hn(Ho),description:"Included when true."}}}),tM=new Op({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[Qn.FIELD,Qn.FRAGMENT_SPREAD,Qn.INLINE_FRAGMENT],args:{if:{type:new Hn(Ho),description:"Skipped when true."}}}),nM="No longer supported",iM=new Op({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[Qn.FIELD_DEFINITION,Qn.ARGUMENT_DEFINITION,Qn.INPUT_FIELD_DEFINITION,Qn.ENUM_VALUE],args:{reason:{type:Fr,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:nM}}}),rM=new Op({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[Qn.SCALAR],args:{url:{type:new Hn(Fr),description:"The URL that specifies the behavior of this scalar."}}}),aM=new Op({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[Qn.INPUT_OBJECT],args:{}}),sM=Object.freeze([eM,tM,iM,rM,aM]);function oM(i){return typeof i=="object"&&typeof(i==null?void 0:i[Symbol.iterator])=="function"}function Iy(i,n){if(Bh(n)){const a=Iy(i,n.ofType);return(a==null?void 0:a.kind)===Nt.NULL?null:a}if(i===null)return{kind:Nt.NULL};if(i===void 0)return null;if(ff(n)){const a=n.ofType;if(oM(i)){const h=[];for(const p of i){const _=Iy(p,a);_!=null&&h.push(_)}return{kind:Nt.LIST,values:h}}return Iy(i,a)}if(jh(n)){if(!Yh(i))return null;const a=[];for(const h of Object.values(n.getFields())){const p=Iy(i[h.name],h.type);p&&a.push({kind:Nt.OBJECT_FIELD,name:{kind:Nt.NAME,value:h.name},value:p})}return{kind:Nt.OBJECT,fields:a}}if(g2(n)){const a=n.serialize(i);if(a==null)return null;if(typeof a=="boolean")return{kind:Nt.BOOLEAN,value:a};if(typeof a=="number"&&Number.isFinite(a)){const h=String(a);return x1.test(h)?{kind:Nt.INT,value:h}:{kind:Nt.FLOAT,value:h}}if(typeof a=="string")return lf(n)?{kind:Nt.ENUM,value:a}:n===C2&&x1.test(a)?{kind:Nt.INT,value:a}:{kind:Nt.STRING,value:a};throw new TypeError(`Cannot convert value to AST: ${vn(a)}.`)}nv(!1,"Unexpected input type: "+vn(n))}const x1=/^-?(?:0|[1-9][0-9]*)$/,nb=new pf({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:Fr,resolve:i=>i.description},types:{description:"A list of all types supported by this server.",type:new Hn(new Il(new Hn(bu))),resolve(i){return Object.values(i.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new Hn(bu),resolve:i=>i.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:bu,resolve:i=>i.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:bu,resolve:i=>i.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new Hn(new Il(new Hn(D2))),resolve:i=>i.getDirectives()}})}),D2=new pf({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new Hn(Fr),resolve:i=>i.name},description:{type:Fr,resolve:i=>i.description},isRepeatable:{type:new Hn(Ho),resolve:i=>i.isRepeatable},locations:{type:new Hn(new Il(new Hn(k2))),resolve:i=>i.locations},args:{type:new Hn(new Il(new Hn(ov))),args:{includeDeprecated:{type:Ho,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(a=>a.deprecationReason==null)}}})}),k2=new sv({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:Qn.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:Qn.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:Qn.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:Qn.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:Qn.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:Qn.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:Qn.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:Qn.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:Qn.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:Qn.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:Qn.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:Qn.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:Qn.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:Qn.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:Qn.UNION,description:"Location adjacent to a union definition."},ENUM:{value:Qn.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:Qn.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:Qn.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:Qn.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),bu=new pf({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new Hn(z2),resolve(i){if(yg(i))return Zi.SCALAR;if(sf(i))return Zi.OBJECT;if(Oc(i))return Zi.INTERFACE;if(Sp(i))return Zi.UNION;if(lf(i))return Zi.ENUM;if(jh(i))return Zi.INPUT_OBJECT;if(ff(i))return Zi.LIST;if(Bh(i))return Zi.NON_NULL;nv(!1,`Unexpected type: "${vn(i)}".`)}},name:{type:Fr,resolve:i=>"name"in i?i.name:void 0},description:{type:Fr,resolve:i=>"description"in i?i.description:void 0},specifiedByURL:{type:Fr,resolve:i=>"specifiedByURL"in i?i.specifiedByURL:void 0},fields:{type:new Il(new Hn(I2)),args:{includeDeprecated:{type:Ho,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(sf(i)||Oc(i)){const a=Object.values(i.getFields());return n?a:a.filter(h=>h.deprecationReason==null)}}},interfaces:{type:new Il(new Hn(bu)),resolve(i){if(sf(i)||Oc(i))return i.getInterfaces()}},possibleTypes:{type:new Il(new Hn(bu)),resolve(i,n,a,{schema:h}){if($A(i))return h.getPossibleTypes(i)}},enumValues:{type:new Il(new Hn(R2)),args:{includeDeprecated:{type:Ho,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(lf(i)){const a=i.getValues();return n?a:a.filter(h=>h.deprecationReason==null)}}},inputFields:{type:new Il(new Hn(ov)),args:{includeDeprecated:{type:Ho,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(jh(i)){const a=Object.values(i.getFields());return n?a:a.filter(h=>h.deprecationReason==null)}}},ofType:{type:bu,resolve:i=>"ofType"in i?i.ofType:void 0},isOneOf:{type:Ho,resolve:i=>{if(jh(i))return i.isOneOf}}})}),I2=new pf({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new Hn(Fr),resolve:i=>i.name},description:{type:Fr,resolve:i=>i.description},args:{type:new Hn(new Il(new Hn(ov))),args:{includeDeprecated:{type:Ho,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(a=>a.deprecationReason==null)}},type:{type:new Hn(bu),resolve:i=>i.type},isDeprecated:{type:new Hn(Ho),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:Fr,resolve:i=>i.deprecationReason}})}),ov=new pf({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new Hn(Fr),resolve:i=>i.name},description:{type:Fr,resolve:i=>i.description},type:{type:new Hn(bu),resolve:i=>i.type},defaultValue:{type:Fr,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(i){const{type:n,defaultValue:a}=i,h=Iy(a,n);return h?Qo(h):null}},isDeprecated:{type:new Hn(Ho),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:Fr,resolve:i=>i.deprecationReason}})}),R2=new pf({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new Hn(Fr),resolve:i=>i.name},description:{type:Fr,resolve:i=>i.description},isDeprecated:{type:new Hn(Ho),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:Fr,resolve:i=>i.deprecationReason}})});var Zi;(function(i){i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.INPUT_OBJECT="INPUT_OBJECT",i.LIST="LIST",i.NON_NULL="NON_NULL"})(Zi||(Zi={}));const z2=new sv({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:Zi.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:Zi.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:Zi.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:Zi.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:Zi.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:Zi.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:Zi.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:Zi.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new Hn(nb);new Hn(Fr);new Hn(Fr);const lM=Object.freeze([nb,D2,k2,bu,I2,ov,R2,z2]);class cM{constructor(n){var a,h;this.__validationErrors=n.assumeValid===!0?[]:void 0,Yh(n)||mi(!1,"Must provide configuration object."),!n.types||Array.isArray(n.types)||mi(!1,`"types" must be Array if provided but got: ${vn(n.types)}.`),!n.directives||Array.isArray(n.directives)||mi(!1,`"directives" must be Array if provided but got: ${vn(n.directives)}.`),this.description=n.description,this.extensions=Ul(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._queryType=n.query,this._mutationType=n.mutation,this._subscriptionType=n.subscription,this._directives=(h=n.directives)!==null&&h!==void 0?h:sM;const p=new Set(n.types);if(n.types!=null)for(const _ of n.types)p.delete(_),Nc(_,p);this._queryType!=null&&Nc(this._queryType,p),this._mutationType!=null&&Nc(this._mutationType,p),this._subscriptionType!=null&&Nc(this._subscriptionType,p);for(const _ of this._directives)if(JA(_))for(const v of _.args)Nc(v.type,p);Nc(nb,p),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const _ of p){if(_==null)continue;const v=_.name;if(v||mi(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[v]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${v}".`);if(this._typeMap[v]=_,Oc(_)){for(const c of _.getInterfaces())if(Oc(c)){let C=this._implementationsMap[c.name];C===void 0&&(C=this._implementationsMap[c.name]={objects:[],interfaces:[]}),C.interfaces.push(_)}}else if(sf(_)){for(const c of _.getInterfaces())if(Oc(c)){let C=this._implementationsMap[c.name];C===void 0&&(C=this._implementationsMap[c.name]={objects:[],interfaces:[]}),C.objects.push(_)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(n){switch(n){case xu.QUERY:return this.getQueryType();case xu.MUTATION:return this.getMutationType();case xu.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(n){return this.getTypeMap()[n]}getPossibleTypes(n){return Sp(n)?n.getTypes():this.getImplementations(n).objects}getImplementations(n){const a=this._implementationsMap[n.name];return a??{objects:[],interfaces:[]}}isSubType(n,a){let h=this._subTypeMap[n.name];if(h===void 0){if(h=Object.create(null),Sp(n))for(const p of n.getTypes())h[p.name]=!0;else{const p=this.getImplementations(n);for(const _ of p.objects)h[_.name]=!0;for(const _ of p.interfaces)h[_.name]=!0}this._subTypeMap[n.name]=h}return h[a.name]!==void 0}getDirectives(){return this._directives}getDirective(n){return this.getDirectives().find(a=>a.name===n)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function Nc(i,n){const a=qA(i);if(!n.has(a)){if(n.add(a),Sp(a))for(const h of a.getTypes())Nc(h,n);else if(sf(a)||Oc(a)){for(const h of a.getInterfaces())Nc(h,n);for(const h of Object.values(a.getFields())){Nc(h.type,n);for(const p of h.args)Nc(p.type,n)}}else if(jh(a))for(const h of Object.values(a.getFields()))Nc(h.type,n)}return n}function Ry(i,n,a){if(i){if(i.kind===Nt.VARIABLE){i.name.value;return}if(Bh(n))return i.kind===Nt.NULL?void 0:Ry(i,n.ofType,a);if(i.kind===Nt.NULL)return null;if(ff(n)){const h=n.ofType;if(i.kind===Nt.LIST){const _=[];for(const v of i.values)if(b1(v,a)){if(Bh(h))return;_.push(null)}else{const c=Ry(v,h,a);if(c===void 0)return;_.push(c)}return _}const p=Ry(i,h,a);return p===void 0?void 0:[p]}if(jh(n)){if(i.kind!==Nt.OBJECT)return;const h=Object.create(null),p=d2(i.fields,_=>_.name.value);for(const _ of Object.values(n.getFields())){const v=p[_.name];if(!v||b1(v.value,a)){if(_.defaultValue!==void 0)h[_.name]=_.defaultValue;else if(Bh(_.type))return;continue}const c=Ry(v.value,_.type,a);if(c===void 0)return;h[_.name]=c}if(n.isOneOf){const _=Object.keys(h);if(_.length!==1||h[_[0]]===null)return}return h}if(g2(n)){let h;try{h=n.parseLiteral(i,a)}catch{return}return h===void 0?void 0:h}nv(!1,"Unexpected input type: "+vn(n))}}function b1(i,n){return i.kind===Nt.VARIABLE&&n==null}function uM(i){const n={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...i},a=n.descriptions?"description":"",h=n.specifiedByUrl?"specifiedByURL":"",p=n.directiveIsRepeatable?"isRepeatable":"",_=n.schemaDescription?a:"";function v(C){return n.inputValueDeprecation?C:""}const c=n.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${_}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${a}
          ${p}
          locations
          args${v("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${a}
      ${h}
      ${c}
      fields(includeDeprecated: true) {
        name
        ${a}
        args${v("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${v("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${a}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${a}
      type { ...TypeRef }
      defaultValue
      ${v("isDeprecated")}
      ${v("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function hM(i,n){Yh(i)&&Yh(i.__schema)||mi(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${vn(i)}.`);const a=i.__schema,h=vp(a.types,Re=>Re.name,Re=>U(Re));for(const Re of[...KA,...lM])h[Re.name]&&(h[Re.name]=Re);const p=a.queryType?P(a.queryType):null,_=a.mutationType?P(a.mutationType):null,v=a.subscriptionType?P(a.subscriptionType):null,c=a.directives?a.directives.map(Ke):[];return new cM({description:a.description,query:p,mutation:_,subscription:v,types:Object.values(h),directives:c,assumeValid:void 0});function C(Re){if(Re.kind===Zi.LIST){const _t=Re.ofType;if(!_t)throw new Error("Decorated type deeper than introspection query.");return new Il(C(_t))}if(Re.kind===Zi.NON_NULL){const _t=Re.ofType;if(!_t)throw new Error("Decorated type deeper than introspection query.");const It=C(_t);return new Hn(YA(It))}return k(Re)}function k(Re){const _t=Re.name;if(!_t)throw new Error(`Unknown type reference: ${vn(Re)}.`);const It=h[_t];if(!It)throw new Error(`Invalid or incomplete schema, unknown type: ${_t}. Ensure that a full introspection query is used in order to build a client schema.`);return It}function P(Re){return ZA(k(Re))}function j(Re){return GA(k(Re))}function U(Re){if(Re!=null&&Re.name!=null&&Re.kind!=null)switch(Re.kind){case Zi.SCALAR:return V(Re);case Zi.OBJECT:return me(Re);case Zi.INTERFACE:return pe(Re);case Zi.UNION:return Le(Re);case Zi.ENUM:return Qe(Re);case Zi.INPUT_OBJECT:return He(Re)}const _t=vn(Re);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${_t}.`)}function V(Re){return new Pp({name:Re.name,description:Re.description,specifiedByURL:Re.specifiedByURL})}function ie(Re){if(Re.interfaces===null&&Re.kind===Zi.INTERFACE)return[];if(!Re.interfaces){const _t=vn(Re);throw new Error(`Introspection result missing interfaces: ${_t}.`)}return Re.interfaces.map(j)}function me(Re){return new pf({name:Re.name,description:Re.description,interfaces:()=>ie(Re),fields:()=>$e(Re)})}function pe(Re){return new S2({name:Re.name,description:Re.description,interfaces:()=>ie(Re),fields:()=>$e(Re)})}function Le(Re){if(!Re.possibleTypes){const _t=vn(Re);throw new Error(`Introspection result missing possibleTypes: ${_t}.`)}return new A2({name:Re.name,description:Re.description,types:()=>Re.possibleTypes.map(P)})}function Qe(Re){if(!Re.enumValues){const _t=vn(Re);throw new Error(`Introspection result missing enumValues: ${_t}.`)}return new sv({name:Re.name,description:Re.description,values:vp(Re.enumValues,_t=>_t.name,_t=>({description:_t.description,deprecationReason:_t.deprecationReason}))})}function He(Re){if(!Re.inputFields){const _t=vn(Re);throw new Error(`Introspection result missing inputFields: ${_t}.`)}return new M2({name:Re.name,description:Re.description,fields:()=>Ze(Re.inputFields),isOneOf:Re.isOneOf})}function $e(Re){if(!Re.fields)throw new Error(`Introspection result missing fields: ${vn(Re)}.`);return vp(Re.fields,_t=>_t.name,ke)}function ke(Re){const _t=C(Re.type);if(!m2(_t)){const It=vn(_t);throw new Error(`Introspection must provide output type for fields, but received: ${It}.`)}if(!Re.args){const It=vn(Re);throw new Error(`Introspection result missing field args: ${It}.`)}return{description:Re.description,deprecationReason:Re.deprecationReason,type:_t,args:Ze(Re.args)}}function Ze(Re){return vp(Re,_t=>_t.name,nt)}function nt(Re){const _t=C(Re.type);if(!p2(_t)){const Ot=vn(_t);throw new Error(`Introspection must provide input type for arguments, but received: ${Ot}.`)}const It=Re.defaultValue!=null?Ry(AA(Re.defaultValue),_t):void 0;return{description:Re.description,type:_t,defaultValue:It,deprecationReason:Re.deprecationReason}}function Ke(Re){if(!Re.args){const _t=vn(Re);throw new Error(`Introspection result missing directive args: ${_t}.`)}if(!Re.locations){const _t=vn(Re);throw new Error(`Introspection result missing directive locations: ${_t}.`)}return new Op({name:Re.name,description:Re.description,isRepeatable:Re.isRepeatable,locations:Re.locations.slice(),args:Ze(Re.args)})}}const w1="Accept",gx="Content-Type",yx="application/json",L2="application/graphql-response+json",T1=i=>i.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),dM=i=>{const n=i.toLowerCase();return n.includes(L2)||n.includes(yx)},E1=i=>{try{if(Array.isArray(i))return{_tag:"Batch",executionResults:i.map(S1)};if(I0(i))return{_tag:"Single",executionResult:S1(i)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(i)}`)}catch(n){return n}},S1=i=>{if(typeof i!="object"||i===null)throw new Error("Invalid execution result: result is not object");let n,a,h;if("errors"in i){if(!I0(i.errors)&&!Array.isArray(i.errors))throw new Error("Invalid execution result: errors is not plain object OR array");n=i.errors}if("data"in i){if(!I0(i.data)&&i.data!==null)throw new Error("Invalid execution result: data is not plain object");a=i.data}if("extensions"in i){if(!I0(i.extensions))throw new Error("Invalid execution result: extensions is not plain object");h=i.extensions}return{data:a,errors:n,extensions:h}},fM=i=>i._tag==="Batch"?i.executionResults.some(A1):A1(i.executionResult),A1=i=>Array.isArray(i.errors)?i.errors.length>0:!!i.errors,N2=i=>typeof i=="object"&&i!==null&&"kind"in i&&i.kind===Nt.OPERATION_DEFINITION,pM=i=>{var h;let n;const a=i.definitions.filter(N2);return a.length===1&&(n=(h=a[0].name)==null?void 0:h.value),n},mM=i=>{let n=!1;const a=i.definitions.filter(N2);return a.length===1&&(n=a[0].operation===xu.MUTATION),n},Yv=(i,n)=>{const a=typeof i=="string"?i:Qo(i);let h=!1,p;if(n)return{expression:a,isMutation:h,operationName:p};const _=HS(()=>typeof i=="string"?SA(i):i);return _ instanceof Error?{expression:a,isMutation:h,operationName:p}:(p=pM(_),h=mM(_),{expression:a,operationName:p,isMutation:h})},ib=JSON,qv=async i=>{const n={...i,method:i.request._tag==="Single"?i.request.document.isMutation?"POST":u1(i.method??"post"):i.request.hasMutations?"POST":u1(i.method??"post"),fetchOptions:{...i.fetchOptions,errorPolicy:i.fetchOptions.errorPolicy??"none"}},h=await yM(n.method)(n);if(!h.ok)return new Km({status:h.status,headers:h.headers},{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables});const p=await gM(h,i.fetchOptions.jsonSerializer??ib);if(p instanceof Error)throw p;const _={status:h.status,headers:h.headers};if(fM(p)&&n.fetchOptions.errorPolicy==="none"){const v=p._tag==="Batch"?{...p.executionResults,..._}:{...p.executionResult,..._};return new Km(v,{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables})}switch(p._tag){case"Single":return{..._,...M1(n)(p.executionResult)};case"Batch":return{..._,data:p.executionResults.map(M1(n))};default:Jx(p)}},M1=i=>n=>({extensions:n.extensions,data:n.data,errors:i.fetchOptions.errorPolicy==="all"?n.errors:void 0}),gM=async(i,n)=>{const a=i.headers.get(gx),h=await i.text();return a&&dM(a)?E1(n.parse(h)):E1(h)},yM=i=>async n=>{const a=new Headers(n.headers);let h=null,p;a.has(w1)||a.set(w1,[L2,yx].join(", ")),i==="POST"?(p=(n.fetchOptions.jsonSerializer??ib).stringify(_M(n)),typeof p=="string"&&!a.has(gx)&&a.set(gx,yx)):h=vM(n);const _={method:i,headers:a,body:p,...n.fetchOptions};let v=new URL(n.url),c=_;if(n.middleware){const k=await Promise.resolve(n.middleware({..._,url:n.url,operationName:n.request._tag==="Single"?n.request.document.operationName:void 0,variables:n.request.variables})),{url:P,...j}=k;v=new URL(P),c=j}return h&&h.forEach((k,P)=>{v.searchParams.append(P,k)}),await(n.fetch??fetch)(v,c)},_M=i=>{switch(i.request._tag){case"Single":return{query:i.request.document.expression,variables:i.request.variables,operationName:i.request.document.operationName};case"Batch":return e2(i.request.query,i.request.variables??[]).map(([n,a])=>({query:n,variables:a}));default:throw Jx(i.request)}},vM=i=>{var h;const n=i.fetchOptions.jsonSerializer??ib,a=new URLSearchParams;switch(i.request._tag){case"Single":return a.append("query",T1(i.request.document.expression)),i.request.variables&&a.append("variables",n.stringify(i.request.variables)),i.request.document.operationName&&a.append("operationName",i.request.document.operationName),a;case"Batch":{const p=((h=i.request.variables)==null?void 0:h.map(c=>n.stringify(c)))??[],_=i.request.query.map(T1),v=e2(_,p).map(([c,C])=>({query:c,variables:C}));return a.append("query",n.stringify(v)),a}default:throw Jx(i.request)}};class xM{constructor(n,a={}){mp(this,"url");mp(this,"requestConfig");mp(this,"rawRequest",async(...n)=>{const[a,h,p]=n,_=QS(a,h,p),{headers:v,fetch:c=globalThis.fetch,method:C="POST",requestMiddleware:k,responseMiddleware:P,excludeOperationName:j,...U}=this.requestConfig,{url:V}=this;_.signal!==void 0&&(U.signal=_.signal);const ie=Yv(_.query,j),me=await qv({url:V,request:{_tag:"Single",document:ie,variables:_.variables},headers:{...Um(Vv(v)),...Um(_.requestHeaders)},fetch:c,method:C,fetchOptions:U,middleware:k});if(P&&await P(me,{operationName:ie.operationName,variables:h,url:this.url}),me instanceof Error)throw me;return me});this.url=n,this.requestConfig=a}async request(n,...a){const[h,p]=a,_=bM(n,h,p),{headers:v,fetch:c=globalThis.fetch,method:C="POST",requestMiddleware:k,responseMiddleware:P,excludeOperationName:j,...U}=this.requestConfig,{url:V}=this;_.signal!==void 0&&(U.signal=_.signal);const ie=Yv(_.document,j),me=await qv({url:V,request:{_tag:"Single",document:ie,variables:_.variables},headers:{...Um(Vv(v)),...Um(_.requestHeaders)},fetch:c,method:C,fetchOptions:U,middleware:k});if(P&&await P(me,{operationName:ie.operationName,variables:_.variables,url:this.url}),me instanceof Error)throw me;return me.data}async batchRequests(n,a){const h=WS(n,a),{headers:p,excludeOperationName:_,...v}=this.requestConfig;h.signal!==void 0&&(v.signal=h.signal);const c=h.documents.map(({document:U})=>Yv(U,_)),C=c.map(({expression:U})=>U),k=c.some(({isMutation:U})=>U),P=h.documents.map(({variables:U})=>U),j=await qv({url:this.url,request:{_tag:"Batch",operationName:void 0,query:C,hasMutations:k,variables:P},headers:{...Um(Vv(p)),...Um(h.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:v,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(j,{operationName:void 0,variables:P,url:this.url}),j instanceof Error)throw j;return j.data}setHeaders(n){return this.requestConfig.headers=n,this}setHeader(n,a){const{headers:h}=this.requestConfig;return h?h[n]=a:this.requestConfig.headers={[n]:a},this}setEndpoint(n){return this.url=n,this}}async function j0(i,n,...a){const h=wM(i,n,...a);return new xM(h.url).request({...h})}const bM=(i,n,a)=>i.document?i:{document:i,variables:n,requestHeaders:a,signal:void 0},wM=(i,n,...a)=>{const[h,p]=a;return typeof i=="string"?{url:i,document:n,variables:h,requestHeaders:p,signal:void 0}:i},Hv="/otp/transmodel/v3",Jy=()=>{try{return new URL(Hv),Hv}catch{return`${window.location.origin}${Hv}`}};var P2=(i=>(i.LimitToNumOfItineraries="limitToNumOfItineraries",i.LimitToSearchWindow="limitToSearchWindow",i.ListAll="listAll",i.Off="off",i))(P2||{}),Ei=(i=>(i.Air="air",i.Bicycle="bicycle",i.Bus="bus",i.Cableway="cableway",i.Car="car",i.Coach="coach",i.Foot="foot",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Scooter="scooter",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Water="water",i))(Ei||{}),lv=(i=>(i.Bicycle="bicycle",i.BikePark="bike_park",i.BikeRental="bike_rental",i.Car="car",i.CarPark="car_park",i.CarPickup="car_pickup",i.CarRental="car_rental",i.Flexible="flexible",i.Foot="foot",i.ScooterRental="scooter_rental",i))(lv||{}),O2=(i=>(i.Air="air",i.Bus="bus",i.Cableway="cableway",i.Coach="coach",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Unknown="unknown",i.Water="water",i))(O2||{});const TM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},EM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},SM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},AM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},MM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},CM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},DM={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":TM,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":EM,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":SM,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":AM,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":MM,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        generalizedCost\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            generalizedCost\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":CM};function _g(i){return DM[i]??{}}const kM=_g(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),IM=i=>{const[n,a]=ce.useState(null);return ce.useEffect(()=>{(async()=>{if(i.place){const p={id:i.place};try{a(await j0(Jy(),kM,p))}catch(_){console.error("Error at useQuayCoordinateQuery",_)}}else a(null)})()},[i]),n==null?void 0:n.quay};function C1(i){const n=IM(i);if(n){const{latitude:a,longitude:h}=n;if(a&&h)return{latitude:a,longitude:h}}if(i.coordinates)return{...i.coordinates}}function RM({setCursor:i,tripQueryVariables:n,setTripQueryVariables:a,loading:h}){const p=C1(n.from),_=C1(n.to);return se.jsxs(se.Fragment,{children:[p&&se.jsx(o1,{draggable:!0,latitude:p.latitude,longitude:p.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),h||a({...n,from:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:se.jsx("img",{alt:"",src:$S,height:48,width:49})}),_&&se.jsx(o1,{draggable:!0,latitude:_.latitude,longitude:_.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),h||a({...n,to:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:se.jsx("img",{alt:"",src:YS,height:48,width:49})})]})}var zM=function(i,n){for(var a=Math.pow(10,n),h=i.length,p=new Array(Math.floor(i.length/2)),_=0,v=0,c=0,C=0;_<h;++C){var k=1,P=0,j=void 0;do j=i.charCodeAt(_++)-63-1,k+=j<<P,P+=5;while(j>=31);v+=k&1?~(k>>1):k>>1,k=1,P=0;do j=i.charCodeAt(_++)-63-1,k+=j<<P,P+=5;while(j>=31);c+=k&1?~(k>>1):k>>1,p[C]=[v/a,c/a]}return p.length=C,p};const LM=function(i){return i===Ei.Foot?"#191616":i===Ei.Bicycle?"#5076D9":i===Ei.Scooter?"#253664":i===Ei.Car?"#7e7e7e":i===Ei.Rail?"#86BF8B":i===Ei.Coach?"#25642A":i===Ei.Metro?"#D9B250":i===Ei.Bus?"#fe0000":i===Ei.Tram?"#D9B250":i===Ei.Trolleybus?"#25642A":i===Ei.Water||i===Ei.Air||i===Ei.Cableway||i===Ei.Funicular||i===Ei.Monorail||i===Ei.Taxi?"#81304C":"#aaa"},j2=function(i){var n,a;return(a=(n=i.line)==null?void 0:n.presentation)!=null&&a.colour?`#${i.line.presentation.colour}`:LM(i.mode)};function NM({tripPattern:i}){return se.jsx(se.Fragment,{children:i==null?void 0:i.legs.map((n,a)=>n.pointsOnLink&&se.jsxs(BS,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:zM(n.pointsOnLink.points,5).map(h=>h.reverse())}},children:[se.jsx(l1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),se.jsx(l1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":j2(n),"line-width":4}})]},n.id||`footleg_${a}`))})}const B2=(i,n,a)=>({...i,[a]:{coordinates:{latitude:n.lat,longitude:n.lng}}}),PM=(i,n)=>B2(i,n,"from"),OM=(i,n)=>B2(i,n,"to");function jM({tripQueryVariables:i,setTripQueryVariables:n}){return ce.useCallback(a=>{a.preventDefault(),i.from.coordinates?n(OM(i,a.lngLat)):n(PM(i,a.lngLat))},[i,n])}var Xv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var D1;function BM(){return D1||(D1=1,function(i){(function(){var n={}.hasOwnProperty;function a(){for(var _="",v=0;v<arguments.length;v++){var c=arguments[v];c&&(_=p(_,h(c)))}return _}function h(_){if(typeof _=="string"||typeof _=="number")return _;if(typeof _!="object")return"";if(Array.isArray(_))return a.apply(null,_);if(_.toString!==Object.prototype.toString&&!_.toString.toString().includes("[native code]"))return _.toString();var v="";for(var c in _)n.call(_,c)&&_[c]&&(v=p(v,c));return v}function p(_,v){return v?_?_+" "+v:_+v:_}i.exports?(a.default=a,i.exports=a):window.classNames=a})()}(Xv)),Xv.exports}var FM=BM();const Mn=Lp(FM);function _x(){return _x=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var h in a)({}).hasOwnProperty.call(a,h)&&(i[h]=a[h])}return i},_x.apply(null,arguments)}function F2(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.includes(h))continue;a[h]=i[h]}return a}function k1(i){return"default"+i.charAt(0).toUpperCase()+i.substr(1)}function UM(i){var n=VM(i,"string");return typeof n=="symbol"?n:String(n)}function VM(i,n){if(typeof i!="object"||i===null)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var h=a.call(i,n);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function ZM(i,n,a){var h=ce.useRef(i!==void 0),p=ce.useState(n),_=p[0],v=p[1],c=i!==void 0,C=h.current;return h.current=c,!c&&C&&_!==n&&v(n),[c?i:_,ce.useCallback(function(k){for(var P=arguments.length,j=new Array(P>1?P-1:0),U=1;U<P;U++)j[U-1]=arguments[U];a&&a.apply(void 0,[k].concat(j)),v(k)},[a])]}function U2(i,n){return Object.keys(n).reduce(function(a,h){var p,_=a,v=_[k1(h)],c=_[h],C=F2(_,[k1(h),h].map(UM)),k=n[h],P=ZM(c,v,i[k]),j=P[0],U=P[1];return _x({},C,(p={},p[h]=j,p[k]=U,p))},i)}function vx(i,n){return vx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},vx(i,n)}function GM(i,n){i.prototype=Object.create(n.prototype),i.prototype.constructor=i,vx(i,n)}const $M=["xxl","xl","lg","md","sm","xs"],YM="xs",p_=ce.createContext({prefixes:{},breakpoints:$M,minBreakpoint:YM}),{Consumer:X3,Provider:W3}=p_;function Un(i,n){const{prefixes:a}=ce.useContext(p_);return i||a[n]||n}function qM(){const{breakpoints:i}=ce.useContext(p_);return i}function HM(){const{minBreakpoint:i}=ce.useContext(p_);return i}function V2(){const{dir:i}=ce.useContext(p_);return i==="rtl"}function m_(i){return i&&i.ownerDocument||document}function XM(i){var n=m_(i);return n&&n.defaultView||window}function WM(i,n){return XM(i).getComputedStyle(i,n)}var QM=/([A-Z])/g;function KM(i){return i.replace(QM,"-$1").toLowerCase()}var JM=/^ms-/;function A0(i){return KM(i).replace(JM,"-ms-")}var eC=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function tC(i){return!!(i&&eC.test(i))}function Fh(i,n){var a="",h="";if(typeof n=="string")return i.style.getPropertyValue(A0(n))||WM(i).getPropertyValue(A0(n));Object.keys(n).forEach(function(p){var _=n[p];!_&&_!==0?i.style.removeProperty(A0(p)):tC(p)?h+=p+"("+_+") ":a+=A0(p)+": "+_+";"}),h&&(a+="transform: "+h+";"),i.style.cssText+=";"+a}var Wv={exports:{}},Qv,I1;function nC(){if(I1)return Qv;I1=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Qv=i,Qv}var Kv,R1;function iC(){if(R1)return Kv;R1=1;var i=nC();function n(){}function a(){}return a.resetWarningCache=n,Kv=function(){function h(v,c,C,k,P,j){if(j!==i){var U=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw U.name="Invariant Violation",U}}h.isRequired=h;function p(){return h}var _={array:h,bigint:h,bool:h,func:h,number:h,object:h,string:h,symbol:h,any:h,arrayOf:p,element:h,elementType:h,instanceOf:p,node:h,objectOf:p,oneOf:p,oneOfType:p,shape:p,exact:p,checkPropTypes:a,resetWarningCache:n};return _.PropTypes=_,_},Kv}var z1;function rC(){return z1||(z1=1,Wv.exports=iC()()),Wv.exports}var aC=rC();const Uh=Lp(aC),L1={disabled:!1},Z2=Rl.createContext(null);var sC=function(n){return n.scrollTop},zy="unmounted",ef="exited",Pc="entering",Rh="entered",e_="exiting",Qh=function(i){GM(n,i);function n(h,p){var _;_=i.call(this,h,p)||this;var v=p,c=v&&!v.isMounting?h.enter:h.appear,C;return _.appearStatus=null,h.in?c?(C=ef,_.appearStatus=Pc):C=Rh:h.unmountOnExit||h.mountOnEnter?C=zy:C=ef,_.state={status:C},_.nextCallback=null,_}n.getDerivedStateFromProps=function(p,_){var v=p.in;return v&&_.status===zy?{status:ef}:null};var a=n.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(p){var _=null;if(p!==this.props){var v=this.state.status;this.props.in?v!==Pc&&v!==Rh&&(_=Pc):(v===Pc||v===Rh)&&(_=e_)}this.updateStatus(!1,_)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var p=this.props.timeout,_,v,c;return _=v=c=p,p!=null&&typeof p!="number"&&(_=p.exit,v=p.enter,c=p.appear!==void 0?p.appear:v),{exit:_,enter:v,appear:c}},a.updateStatus=function(p,_){if(p===void 0&&(p=!1),_!==null)if(this.cancelNextCallback(),_===Pc){if(this.props.unmountOnExit||this.props.mountOnEnter){var v=this.props.nodeRef?this.props.nodeRef.current:_p.findDOMNode(this);v&&sC(v)}this.performEnter(p)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ef&&this.setState({status:zy})},a.performEnter=function(p){var _=this,v=this.props.enter,c=this.context?this.context.isMounting:p,C=this.props.nodeRef?[c]:[_p.findDOMNode(this),c],k=C[0],P=C[1],j=this.getTimeouts(),U=c?j.appear:j.enter;if(!p&&!v||L1.disabled){this.safeSetState({status:Rh},function(){_.props.onEntered(k)});return}this.props.onEnter(k,P),this.safeSetState({status:Pc},function(){_.props.onEntering(k,P),_.onTransitionEnd(U,function(){_.safeSetState({status:Rh},function(){_.props.onEntered(k,P)})})})},a.performExit=function(){var p=this,_=this.props.exit,v=this.getTimeouts(),c=this.props.nodeRef?void 0:_p.findDOMNode(this);if(!_||L1.disabled){this.safeSetState({status:ef},function(){p.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:e_},function(){p.props.onExiting(c),p.onTransitionEnd(v.exit,function(){p.safeSetState({status:ef},function(){p.props.onExited(c)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(p,_){_=this.setNextCallback(_),this.setState(p,_)},a.setNextCallback=function(p){var _=this,v=!0;return this.nextCallback=function(c){v&&(v=!1,_.nextCallback=null,p(c))},this.nextCallback.cancel=function(){v=!1},this.nextCallback},a.onTransitionEnd=function(p,_){this.setNextCallback(_);var v=this.props.nodeRef?this.props.nodeRef.current:_p.findDOMNode(this),c=p==null&&!this.props.addEndListener;if(!v||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var C=this.props.nodeRef?[this.nextCallback]:[v,this.nextCallback],k=C[0],P=C[1];this.props.addEndListener(k,P)}p!=null&&setTimeout(this.nextCallback,p)},a.render=function(){var p=this.state.status;if(p===zy)return null;var _=this.props,v=_.children;_.in,_.mountOnEnter,_.unmountOnExit,_.appear,_.enter,_.exit,_.timeout,_.addEndListener,_.onEnter,_.onEntering,_.onEntered,_.onExit,_.onExiting,_.onExited,_.nodeRef;var c=F2(_,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Rl.createElement(Z2.Provider,{value:null},typeof v=="function"?v(p,c):Rl.cloneElement(Rl.Children.only(v),c))},n}(Rl.Component);Qh.contextType=Z2;Qh.propTypes={};function Vm(){}Qh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Vm,onEntering:Vm,onEntered:Vm,onExit:Vm,onExiting:Vm,onExited:Vm};Qh.UNMOUNTED=zy;Qh.EXITED=ef;Qh.ENTERING=Pc;Qh.ENTERED=Rh;Qh.EXITING=e_;function G2(i){return i.code==="Escape"||i.keyCode===27}function oC(){const i=ce.version.split(".");return{major:+i[0],minor:+i[1],patch:+i[2]}}function vg(i){if(!i||typeof i=="function")return null;const{major:n}=oC();return n>=19?i.props.ref:i.ref}const cv=!!(typeof window<"u"&&window.document&&window.document.createElement);var xx=!1,bx=!1;try{var Jv={get passive(){return xx=!0},get once(){return bx=xx=!0}};cv&&(window.addEventListener("test",Jv,Jv),window.removeEventListener("test",Jv,!0))}catch{}function lC(i,n,a,h){if(h&&typeof h!="boolean"&&!bx){var p=h.once,_=h.capture,v=a;!bx&&p&&(v=a.__once||function c(C){this.removeEventListener(n,c,_),a.call(this,C)},a.__once=v),i.addEventListener(n,v,xx?h:_)}i.addEventListener(n,a,h)}function cC(i,n,a,h){var p=h&&typeof h!="boolean"?h.capture:h;i.removeEventListener(n,a,p),a.__once&&i.removeEventListener(n,a.__once,p)}function Nh(i,n,a,h){return lC(i,n,a,h),function(){cC(i,n,a,h)}}function uC(i,n,a,h){if(h===void 0&&(h=!0),i){var p=document.createEvent("HTMLEvents");p.initEvent(n,a,h),i.dispatchEvent(p)}}function hC(i){var n=Fh(i,"transitionDuration")||"",a=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*a}function dC(i,n,a){a===void 0&&(a=5);var h=!1,p=setTimeout(function(){h||uC(i,"transitionend",!0)},n+a),_=Nh(i,"transitionend",function(){h=!0},{once:!0});return function(){clearTimeout(p),_()}}function fC(i,n,a,h){a==null&&(a=hC(i)||0);var p=dC(i,a,h),_=Nh(i,"transitionend",n);return function(){p(),_()}}function N1(i,n){const a=Fh(i,n)||"",h=a.indexOf("ms")===-1?1e3:1;return parseFloat(a)*h}function rb(i,n){const a=N1(i,"transitionDuration"),h=N1(i,"transitionDelay"),p=fC(i,_=>{_.target===i&&(p(),n(_))},a+h)}function Ay(...i){return i.filter(n=>n!=null).reduce((n,a)=>{if(typeof a!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return n===null?a:function(...p){n.apply(this,p),a.apply(this,p)}},null)}function $2(i){i.offsetHeight}const P1=i=>!i||typeof i=="function"?i:n=>{i.current=n};function pC(i,n){const a=P1(i),h=P1(n);return p=>{a&&a(p),h&&h(p)}}function Y2(i,n){return ce.useMemo(()=>pC(i,n),[i,n])}function wx(i){return i&&"setState"in i?_p.findDOMNode(i):i??null}const ab=Rl.forwardRef(({onEnter:i,onEntering:n,onEntered:a,onExit:h,onExiting:p,onExited:_,addEndListener:v,children:c,childRef:C,...k},P)=>{const j=ce.useRef(null),U=Y2(j,C),V=Ze=>{U(wx(Ze))},ie=Ze=>nt=>{Ze&&j.current&&Ze(j.current,nt)},me=ce.useCallback(ie(i),[i]),pe=ce.useCallback(ie(n),[n]),Le=ce.useCallback(ie(a),[a]),Qe=ce.useCallback(ie(h),[h]),He=ce.useCallback(ie(p),[p]),$e=ce.useCallback(ie(_),[_]),ke=ce.useCallback(ie(v),[v]);return se.jsx(Qh,{ref:P,...k,onEnter:me,onEntered:Le,onEntering:pe,onExit:Qe,onExited:$e,onExiting:He,addEndListener:ke,nodeRef:j,children:typeof c=="function"?(Ze,nt)=>c(Ze,{...nt,ref:V}):Rl.cloneElement(c,{ref:V})})}),mC={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function gC(i,n){const a=`offset${i[0].toUpperCase()}${i.slice(1)}`,h=n[a],p=mC[i];return h+parseInt(Fh(n,p[0]),10)+parseInt(Fh(n,p[1]),10)}const yC={[ef]:"collapse",[e_]:"collapsing",[Pc]:"collapsing",[Rh]:"collapse show"},q2=Rl.forwardRef(({onEnter:i,onEntering:n,onEntered:a,onExit:h,onExiting:p,className:_,children:v,dimension:c="height",in:C=!1,timeout:k=300,mountOnEnter:P=!1,unmountOnExit:j=!1,appear:U=!1,getDimensionValue:V=gC,...ie},me)=>{const pe=typeof c=="function"?c():c,Le=ce.useMemo(()=>Ay(Ze=>{Ze.style[pe]="0"},i),[pe,i]),Qe=ce.useMemo(()=>Ay(Ze=>{const nt=`scroll${pe[0].toUpperCase()}${pe.slice(1)}`;Ze.style[pe]=`${Ze[nt]}px`},n),[pe,n]),He=ce.useMemo(()=>Ay(Ze=>{Ze.style[pe]=null},a),[pe,a]),$e=ce.useMemo(()=>Ay(Ze=>{Ze.style[pe]=`${V(pe,Ze)}px`,$2(Ze)},h),[h,V,pe]),ke=ce.useMemo(()=>Ay(Ze=>{Ze.style[pe]=null},p),[pe,p]);return se.jsx(ab,{ref:me,addEndListener:rb,...ie,"aria-expanded":ie.role?C:null,onEnter:Le,onEntering:Qe,onEntered:He,onExit:$e,onExiting:ke,childRef:vg(v),in:C,timeout:k,mountOnEnter:P,unmountOnExit:j,appear:U,children:(Ze,nt)=>Rl.cloneElement(v,{...nt,className:Mn(_,v.props.className,yC[Ze],pe==="width"&&"collapse-horizontal")})})});function H2(i,n){return Array.isArray(i)?i.includes(n):i===n}const g_=ce.createContext({});g_.displayName="AccordionContext";const sb=ce.forwardRef(({as:i="div",bsPrefix:n,className:a,children:h,eventKey:p,..._},v)=>{const{activeEventKey:c}=ce.useContext(g_);return n=Un(n,"accordion-collapse"),se.jsx(q2,{ref:v,in:H2(c,p),..._,className:Mn(a,n),children:se.jsx(i,{children:ce.Children.only(h)})})});sb.displayName="AccordionCollapse";const uv=ce.createContext({eventKey:""});uv.displayName="AccordionItemContext";const X2=ce.forwardRef(({as:i="div",bsPrefix:n,className:a,onEnter:h,onEntering:p,onEntered:_,onExit:v,onExiting:c,onExited:C,...k},P)=>{n=Un(n,"accordion-body");const{eventKey:j}=ce.useContext(uv);return se.jsx(sb,{eventKey:j,onEnter:h,onEntering:p,onEntered:_,onExit:v,onExiting:c,onExited:C,children:se.jsx(i,{ref:P,...k,className:Mn(a,n)})})});X2.displayName="AccordionBody";function _C(i,n){const{activeEventKey:a,onSelect:h,alwaysOpen:p}=ce.useContext(g_);return _=>{let v=i===a?null:i;p&&(Array.isArray(a)?a.includes(i)?v=a.filter(c=>c!==i):v=[...a,i]:v=[i]),h==null||h(v,_),n==null||n(_)}}const ob=ce.forwardRef(({as:i="button",bsPrefix:n,className:a,onClick:h,...p},_)=>{n=Un(n,"accordion-button");const{eventKey:v}=ce.useContext(uv),c=_C(v,h),{activeEventKey:C}=ce.useContext(g_);return i==="button"&&(p.type="button"),se.jsx(i,{ref:_,onClick:c,...p,"aria-expanded":Array.isArray(C)?C.includes(v):v===C,className:Mn(a,n,!H2(C,v)&&"collapsed")})});ob.displayName="AccordionButton";const W2=ce.forwardRef(({as:i="h2","aria-controls":n,bsPrefix:a,className:h,children:p,onClick:_,...v},c)=>(a=Un(a,"accordion-header"),se.jsx(i,{ref:c,...v,className:Mn(h,a),children:se.jsx(ob,{onClick:_,"aria-controls":n,children:p})})));W2.displayName="AccordionHeader";const Q2=ce.forwardRef(({as:i="div",bsPrefix:n,className:a,eventKey:h,...p},_)=>{n=Un(n,"accordion-item");const v=ce.useMemo(()=>({eventKey:h}),[h]);return se.jsx(uv.Provider,{value:v,children:se.jsx(i,{ref:_,...p,className:Mn(a,n)})})});Q2.displayName="AccordionItem";const K2=ce.forwardRef((i,n)=>{const{as:a="div",activeKey:h,bsPrefix:p,className:_,onSelect:v,flush:c,alwaysOpen:C,...k}=U2(i,{activeKey:"onSelect"}),P=Un(p,"accordion"),j=ce.useMemo(()=>({activeEventKey:h,onSelect:v,alwaysOpen:C}),[h,v,C]);return se.jsx(g_.Provider,{value:j,children:se.jsx(a,{ref:n,...k,className:Mn(_,P,c&&`${P}-flush`)})})});K2.displayName="Accordion";const M0=Object.assign(K2,{Button:ob,Collapse:sb,Item:Q2,Header:W2,Body:X2});function vC(i){const n=ce.useRef(i);return ce.useEffect(()=>{n.current=i},[i]),n}function y_(i){const n=vC(i);return ce.useCallback(function(...a){return n.current&&n.current(...a)},[n])}const xC=i=>ce.forwardRef((n,a)=>se.jsx("div",{...n,ref:a,className:Mn(n.className,i)}));function O1(){return ce.useState(null)}function bC(i){const n=ce.useRef(i);return ce.useEffect(()=>{n.current=i},[i]),n}function _u(i){const n=bC(i);return ce.useCallback(function(...a){return n.current&&n.current(...a)},[n])}function J2(){const i=ce.useRef(!0),n=ce.useRef(()=>i.current);return ce.useEffect(()=>(i.current=!0,()=>{i.current=!1}),[]),n.current}function wC(i){const n=ce.useRef(null);return ce.useEffect(()=>{n.current=i}),n.current}const TC=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",EC=typeof document<"u",j1=EC||TC?ce.useLayoutEffect:ce.useEffect,SC=["as","disabled"];function AC(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}function MC(i){return!i||i.trim()==="#"}function eT({tagName:i,disabled:n,href:a,target:h,rel:p,role:_,onClick:v,tabIndex:c=0,type:C}){i||(a!=null||h!=null||p!=null?i="a":i="button");const k={tagName:i};if(i==="button")return[{type:C||"button",disabled:n},k];const P=U=>{if((n||i==="a"&&MC(a))&&U.preventDefault(),n){U.stopPropagation();return}v==null||v(U)},j=U=>{U.key===" "&&(U.preventDefault(),P(U))};return i==="a"&&(a||(a="#"),n&&(a=void 0)),[{role:_??"button",disabled:void 0,tabIndex:n?void 0:c,href:a,target:i==="a"?h:void 0,"aria-disabled":n||void 0,rel:i==="a"?p:void 0,onClick:P,onKeyDown:j},k]}const CC=ce.forwardRef((i,n)=>{let{as:a,disabled:h}=i,p=AC(i,SC);const[_,{tagName:v}]=eT(Object.assign({tagName:a,disabled:h},p));return se.jsx(v,Object.assign({},p,_,{ref:n}))});CC.displayName="Button";const DC={[Pc]:"show",[Rh]:"show"},B0=ce.forwardRef(({className:i,children:n,transitionClasses:a={},onEnter:h,...p},_)=>{const v={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...p},c=ce.useCallback((C,k)=>{$2(C),h==null||h(C,k)},[h]);return se.jsx(ab,{ref:_,addEndListener:rb,...v,onEnter:c,childRef:vg(n),children:(C,k)=>ce.cloneElement(n,{...k,className:Mn("fade",i,n.props.className,DC[C],a[C])})})});B0.displayName="Fade";const kC={"aria-label":Uh.string,onClick:Uh.func,variant:Uh.oneOf(["white"])},lb=ce.forwardRef(({className:i,variant:n,"aria-label":a="Close",...h},p)=>se.jsx("button",{ref:p,type:"button",className:Mn("btn-close",n&&`btn-close-${n}`,i),"aria-label":a,...h}));lb.displayName="CloseButton";lb.propTypes=kC;const Ap=ce.forwardRef(({as:i,bsPrefix:n,variant:a="primary",size:h,active:p=!1,disabled:_=!1,className:v,...c},C)=>{const k=Un(n,"btn"),[P,{tagName:j}]=eT({tagName:i,disabled:_,...c}),U=j;return se.jsx(U,{...P,...c,ref:C,disabled:_,className:Mn(v,k,p&&"active",a&&`${k}-${a}`,h&&`${k}-${h}`,c.href&&_&&"disabled")})});Ap.displayName="Button";const cb=ce.forwardRef(({bsPrefix:i,size:n,vertical:a=!1,className:h,role:p="group",as:_="div",...v},c)=>{const C=Un(i,"btn-group");let k=C;return a&&(k=`${C}-vertical`),se.jsx(_,{...v,ref:c,role:p,className:Mn(h,k,n&&`${C}-${n}`)})});cb.displayName="ButtonGroup";function IC(i,n){return ce.Children.toArray(i).some(a=>ce.isValidElement(a)&&a.type===n)}function RC({as:i,bsPrefix:n,className:a,...h}){n=Un(n,"col");const p=qM(),_=HM(),v=[],c=[];return p.forEach(C=>{const k=h[C];delete h[C];let P,j,U;typeof k=="object"&&k!=null?{span:P,offset:j,order:U}=k:P=k;const V=C!==_?`-${C}`:"";P&&v.push(P===!0?`${n}${V}`:`${n}${V}-${P}`),U!=null&&c.push(`order${V}-${U}`),j!=null&&c.push(`offset${V}-${j}`)}),[{...h,className:Mn(a,...v,...c)},{as:i,bsPrefix:n,spans:v}]}const tT=ce.forwardRef((i,n)=>{const[{className:a,...h},{as:p="div",bsPrefix:_,spans:v}]=RC(i);return se.jsx(p,{...h,ref:n,className:Mn(a,!v.length&&_)})});tT.displayName="Col";var zC=Function.prototype.bind.call(Function.prototype.call,[].slice);function Zm(i,n){return zC(i.querySelectorAll(n))}var B1=Object.prototype.hasOwnProperty;function F1(i,n,a){for(a of i.keys())if(Vy(a,n))return a}function Vy(i,n){var a,h,p;if(i===n)return!0;if(i&&n&&(a=i.constructor)===n.constructor){if(a===Date)return i.getTime()===n.getTime();if(a===RegExp)return i.toString()===n.toString();if(a===Array){if((h=i.length)===n.length)for(;h--&&Vy(i[h],n[h]););return h===-1}if(a===Set){if(i.size!==n.size)return!1;for(h of i)if(p=h,p&&typeof p=="object"&&(p=F1(n,p),!p)||!n.has(p))return!1;return!0}if(a===Map){if(i.size!==n.size)return!1;for(h of i)if(p=h[0],p&&typeof p=="object"&&(p=F1(n,p),!p)||!Vy(h[1],n.get(p)))return!1;return!0}if(a===ArrayBuffer)i=new Uint8Array(i),n=new Uint8Array(n);else if(a===DataView){if((h=i.byteLength)===n.byteLength)for(;h--&&i.getInt8(h)===n.getInt8(h););return h===-1}if(ArrayBuffer.isView(i)){if((h=i.byteLength)===n.byteLength)for(;h--&&i[h]===n[h];);return h===-1}if(!a||typeof i=="object"){h=0;for(a in i)if(B1.call(i,a)&&++h&&!B1.call(n,a)||!(a in n)||!Vy(i[a],n[a]))return!1;return Object.keys(n).length===h}}return i!==i&&n!==n}function LC(i){const n=J2();return[i[0],ce.useCallback(a=>{if(n())return i[1](a)},[n,i[1]])]}var go="top",Ol="bottom",jl="right",yo="left",ub="auto",__=[go,Ol,jl,yo],ig="start",t_="end",NC="clippingParents",nT="viewport",My="popper",PC="reference",U1=__.reduce(function(i,n){return i.concat([n+"-"+ig,n+"-"+t_])},[]),iT=[].concat(__,[ub]).reduce(function(i,n){return i.concat([n,n+"-"+ig,n+"-"+t_])},[]),OC="beforeRead",jC="read",BC="afterRead",FC="beforeMain",UC="main",VC="afterMain",ZC="beforeWrite",GC="write",$C="afterWrite",YC=[OC,jC,BC,FC,UC,VC,ZC,GC,$C];function Su(i){return i.split("-")[0]}function Ko(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var n=i.ownerDocument;return n&&n.defaultView||window}return i}function Mp(i){var n=Ko(i).Element;return i instanceof n||i instanceof Element}function Au(i){var n=Ko(i).HTMLElement;return i instanceof n||i instanceof HTMLElement}function hb(i){if(typeof ShadowRoot>"u")return!1;var n=Ko(i).ShadowRoot;return i instanceof n||i instanceof ShadowRoot}var bp=Math.max,F0=Math.min,rg=Math.round;function Tx(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function rT(){return!/^((?!chrome|android).)*safari/i.test(Tx())}function ag(i,n,a){n===void 0&&(n=!1),a===void 0&&(a=!1);var h=i.getBoundingClientRect(),p=1,_=1;n&&Au(i)&&(p=i.offsetWidth>0&&rg(h.width)/i.offsetWidth||1,_=i.offsetHeight>0&&rg(h.height)/i.offsetHeight||1);var v=Mp(i)?Ko(i):window,c=v.visualViewport,C=!rT()&&a,k=(h.left+(C&&c?c.offsetLeft:0))/p,P=(h.top+(C&&c?c.offsetTop:0))/_,j=h.width/p,U=h.height/_;return{width:j,height:U,top:P,right:k+j,bottom:P+U,left:k,x:k,y:P}}function db(i){var n=ag(i),a=i.offsetWidth,h=i.offsetHeight;return Math.abs(n.width-a)<=1&&(a=n.width),Math.abs(n.height-h)<=1&&(h=n.height),{x:i.offsetLeft,y:i.offsetTop,width:a,height:h}}function aT(i,n){var a=n.getRootNode&&n.getRootNode();if(i.contains(n))return!0;if(a&&hb(a)){var h=n;do{if(h&&i.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function cf(i){return i?(i.nodeName||"").toLowerCase():null}function qh(i){return Ko(i).getComputedStyle(i)}function qC(i){return["table","td","th"].indexOf(cf(i))>=0}function mf(i){return((Mp(i)?i.ownerDocument:i.document)||window.document).documentElement}function hv(i){return cf(i)==="html"?i:i.assignedSlot||i.parentNode||(hb(i)?i.host:null)||mf(i)}function V1(i){return!Au(i)||qh(i).position==="fixed"?null:i.offsetParent}function HC(i){var n=/firefox/i.test(Tx()),a=/Trident/i.test(Tx());if(a&&Au(i)){var h=qh(i);if(h.position==="fixed")return null}var p=hv(i);for(hb(p)&&(p=p.host);Au(p)&&["html","body"].indexOf(cf(p))<0;){var _=qh(p);if(_.transform!=="none"||_.perspective!=="none"||_.contain==="paint"||["transform","perspective"].indexOf(_.willChange)!==-1||n&&_.willChange==="filter"||n&&_.filter&&_.filter!=="none")return p;p=p.parentNode}return null}function v_(i){for(var n=Ko(i),a=V1(i);a&&qC(a)&&qh(a).position==="static";)a=V1(a);return a&&(cf(a)==="html"||cf(a)==="body"&&qh(a).position==="static")?n:a||HC(i)||n}function fb(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Zy(i,n,a){return bp(i,F0(n,a))}function XC(i,n,a){var h=Zy(i,n,a);return h>a?a:h}function sT(){return{top:0,right:0,bottom:0,left:0}}function oT(i){return Object.assign({},sT(),i)}function lT(i,n){return n.reduce(function(a,h){return a[h]=i,a},{})}var WC=function(n,a){return n=typeof n=="function"?n(Object.assign({},a.rects,{placement:a.placement})):n,oT(typeof n!="number"?n:lT(n,__))};function QC(i){var n,a=i.state,h=i.name,p=i.options,_=a.elements.arrow,v=a.modifiersData.popperOffsets,c=Su(a.placement),C=fb(c),k=[yo,jl].indexOf(c)>=0,P=k?"height":"width";if(!(!_||!v)){var j=WC(p.padding,a),U=db(_),V=C==="y"?go:yo,ie=C==="y"?Ol:jl,me=a.rects.reference[P]+a.rects.reference[C]-v[C]-a.rects.popper[P],pe=v[C]-a.rects.reference[C],Le=v_(_),Qe=Le?C==="y"?Le.clientHeight||0:Le.clientWidth||0:0,He=me/2-pe/2,$e=j[V],ke=Qe-U[P]-j[ie],Ze=Qe/2-U[P]/2+He,nt=Zy($e,Ze,ke),Ke=C;a.modifiersData[h]=(n={},n[Ke]=nt,n.centerOffset=nt-Ze,n)}}function KC(i){var n=i.state,a=i.options,h=a.element,p=h===void 0?"[data-popper-arrow]":h;p!=null&&(typeof p=="string"&&(p=n.elements.popper.querySelector(p),!p)||aT(n.elements.popper,p)&&(n.elements.arrow=p))}const JC={name:"arrow",enabled:!0,phase:"main",fn:QC,effect:KC,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function sg(i){return i.split("-")[1]}var eD={top:"auto",right:"auto",bottom:"auto",left:"auto"};function tD(i,n){var a=i.x,h=i.y,p=n.devicePixelRatio||1;return{x:rg(a*p)/p||0,y:rg(h*p)/p||0}}function Z1(i){var n,a=i.popper,h=i.popperRect,p=i.placement,_=i.variation,v=i.offsets,c=i.position,C=i.gpuAcceleration,k=i.adaptive,P=i.roundOffsets,j=i.isFixed,U=v.x,V=U===void 0?0:U,ie=v.y,me=ie===void 0?0:ie,pe=typeof P=="function"?P({x:V,y:me}):{x:V,y:me};V=pe.x,me=pe.y;var Le=v.hasOwnProperty("x"),Qe=v.hasOwnProperty("y"),He=yo,$e=go,ke=window;if(k){var Ze=v_(a),nt="clientHeight",Ke="clientWidth";if(Ze===Ko(a)&&(Ze=mf(a),qh(Ze).position!=="static"&&c==="absolute"&&(nt="scrollHeight",Ke="scrollWidth")),Ze=Ze,p===go||(p===yo||p===jl)&&_===t_){$e=Ol;var Re=j&&Ze===ke&&ke.visualViewport?ke.visualViewport.height:Ze[nt];me-=Re-h.height,me*=C?1:-1}if(p===yo||(p===go||p===Ol)&&_===t_){He=jl;var _t=j&&Ze===ke&&ke.visualViewport?ke.visualViewport.width:Ze[Ke];V-=_t-h.width,V*=C?1:-1}}var It=Object.assign({position:c},k&&eD),Ot=P===!0?tD({x:V,y:me},Ko(a)):{x:V,y:me};if(V=Ot.x,me=Ot.y,C){var Vt;return Object.assign({},It,(Vt={},Vt[$e]=Qe?"0":"",Vt[He]=Le?"0":"",Vt.transform=(ke.devicePixelRatio||1)<=1?"translate("+V+"px, "+me+"px)":"translate3d("+V+"px, "+me+"px, 0)",Vt))}return Object.assign({},It,(n={},n[$e]=Qe?me+"px":"",n[He]=Le?V+"px":"",n.transform="",n))}function nD(i){var n=i.state,a=i.options,h=a.gpuAcceleration,p=h===void 0?!0:h,_=a.adaptive,v=_===void 0?!0:_,c=a.roundOffsets,C=c===void 0?!0:c,k={placement:Su(n.placement),variation:sg(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:p,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,Z1(Object.assign({},k,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:v,roundOffsets:C})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,Z1(Object.assign({},k,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:C})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const iD={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:nD,data:{}};var C0={passive:!0};function rD(i){var n=i.state,a=i.instance,h=i.options,p=h.scroll,_=p===void 0?!0:p,v=h.resize,c=v===void 0?!0:v,C=Ko(n.elements.popper),k=[].concat(n.scrollParents.reference,n.scrollParents.popper);return _&&k.forEach(function(P){P.addEventListener("scroll",a.update,C0)}),c&&C.addEventListener("resize",a.update,C0),function(){_&&k.forEach(function(P){P.removeEventListener("scroll",a.update,C0)}),c&&C.removeEventListener("resize",a.update,C0)}}const aD={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:rD,data:{}};var sD={left:"right",right:"left",bottom:"top",top:"bottom"};function z0(i){return i.replace(/left|right|bottom|top/g,function(n){return sD[n]})}var oD={start:"end",end:"start"};function G1(i){return i.replace(/start|end/g,function(n){return oD[n]})}function pb(i){var n=Ko(i),a=n.pageXOffset,h=n.pageYOffset;return{scrollLeft:a,scrollTop:h}}function mb(i){return ag(mf(i)).left+pb(i).scrollLeft}function lD(i,n){var a=Ko(i),h=mf(i),p=a.visualViewport,_=h.clientWidth,v=h.clientHeight,c=0,C=0;if(p){_=p.width,v=p.height;var k=rT();(k||!k&&n==="fixed")&&(c=p.offsetLeft,C=p.offsetTop)}return{width:_,height:v,x:c+mb(i),y:C}}function cD(i){var n,a=mf(i),h=pb(i),p=(n=i.ownerDocument)==null?void 0:n.body,_=bp(a.scrollWidth,a.clientWidth,p?p.scrollWidth:0,p?p.clientWidth:0),v=bp(a.scrollHeight,a.clientHeight,p?p.scrollHeight:0,p?p.clientHeight:0),c=-h.scrollLeft+mb(i),C=-h.scrollTop;return qh(p||a).direction==="rtl"&&(c+=bp(a.clientWidth,p?p.clientWidth:0)-_),{width:_,height:v,x:c,y:C}}function gb(i){var n=qh(i),a=n.overflow,h=n.overflowX,p=n.overflowY;return/auto|scroll|overlay|hidden/.test(a+p+h)}function cT(i){return["html","body","#document"].indexOf(cf(i))>=0?i.ownerDocument.body:Au(i)&&gb(i)?i:cT(hv(i))}function Gy(i,n){var a;n===void 0&&(n=[]);var h=cT(i),p=h===((a=i.ownerDocument)==null?void 0:a.body),_=Ko(h),v=p?[_].concat(_.visualViewport||[],gb(h)?h:[]):h,c=n.concat(v);return p?c:c.concat(Gy(hv(v)))}function Ex(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function uD(i,n){var a=ag(i,!1,n==="fixed");return a.top=a.top+i.clientTop,a.left=a.left+i.clientLeft,a.bottom=a.top+i.clientHeight,a.right=a.left+i.clientWidth,a.width=i.clientWidth,a.height=i.clientHeight,a.x=a.left,a.y=a.top,a}function $1(i,n,a){return n===nT?Ex(lD(i,a)):Mp(n)?uD(n,a):Ex(cD(mf(i)))}function hD(i){var n=Gy(hv(i)),a=["absolute","fixed"].indexOf(qh(i).position)>=0,h=a&&Au(i)?v_(i):i;return Mp(h)?n.filter(function(p){return Mp(p)&&aT(p,h)&&cf(p)!=="body"}):[]}function dD(i,n,a,h){var p=n==="clippingParents"?hD(i):[].concat(n),_=[].concat(p,[a]),v=_[0],c=_.reduce(function(C,k){var P=$1(i,k,h);return C.top=bp(P.top,C.top),C.right=F0(P.right,C.right),C.bottom=F0(P.bottom,C.bottom),C.left=bp(P.left,C.left),C},$1(i,v,h));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function uT(i){var n=i.reference,a=i.element,h=i.placement,p=h?Su(h):null,_=h?sg(h):null,v=n.x+n.width/2-a.width/2,c=n.y+n.height/2-a.height/2,C;switch(p){case go:C={x:v,y:n.y-a.height};break;case Ol:C={x:v,y:n.y+n.height};break;case jl:C={x:n.x+n.width,y:c};break;case yo:C={x:n.x-a.width,y:c};break;default:C={x:n.x,y:n.y}}var k=p?fb(p):null;if(k!=null){var P=k==="y"?"height":"width";switch(_){case ig:C[k]=C[k]-(n[P]/2-a[P]/2);break;case t_:C[k]=C[k]+(n[P]/2-a[P]/2);break}}return C}function n_(i,n){n===void 0&&(n={});var a=n,h=a.placement,p=h===void 0?i.placement:h,_=a.strategy,v=_===void 0?i.strategy:_,c=a.boundary,C=c===void 0?NC:c,k=a.rootBoundary,P=k===void 0?nT:k,j=a.elementContext,U=j===void 0?My:j,V=a.altBoundary,ie=V===void 0?!1:V,me=a.padding,pe=me===void 0?0:me,Le=oT(typeof pe!="number"?pe:lT(pe,__)),Qe=U===My?PC:My,He=i.rects.popper,$e=i.elements[ie?Qe:U],ke=dD(Mp($e)?$e:$e.contextElement||mf(i.elements.popper),C,P,v),Ze=ag(i.elements.reference),nt=uT({reference:Ze,element:He,placement:p}),Ke=Ex(Object.assign({},He,nt)),Re=U===My?Ke:Ze,_t={top:ke.top-Re.top+Le.top,bottom:Re.bottom-ke.bottom+Le.bottom,left:ke.left-Re.left+Le.left,right:Re.right-ke.right+Le.right},It=i.modifiersData.offset;if(U===My&&It){var Ot=It[p];Object.keys(_t).forEach(function(Vt){var Wt=[jl,Ol].indexOf(Vt)>=0?1:-1,dn=[go,Ol].indexOf(Vt)>=0?"y":"x";_t[Vt]+=Ot[dn]*Wt})}return _t}function fD(i,n){n===void 0&&(n={});var a=n,h=a.placement,p=a.boundary,_=a.rootBoundary,v=a.padding,c=a.flipVariations,C=a.allowedAutoPlacements,k=C===void 0?iT:C,P=sg(h),j=P?c?U1:U1.filter(function(ie){return sg(ie)===P}):__,U=j.filter(function(ie){return k.indexOf(ie)>=0});U.length===0&&(U=j);var V=U.reduce(function(ie,me){return ie[me]=n_(i,{placement:me,boundary:p,rootBoundary:_,padding:v})[Su(me)],ie},{});return Object.keys(V).sort(function(ie,me){return V[ie]-V[me]})}function pD(i){if(Su(i)===ub)return[];var n=z0(i);return[G1(i),n,G1(n)]}function mD(i){var n=i.state,a=i.options,h=i.name;if(!n.modifiersData[h]._skip){for(var p=a.mainAxis,_=p===void 0?!0:p,v=a.altAxis,c=v===void 0?!0:v,C=a.fallbackPlacements,k=a.padding,P=a.boundary,j=a.rootBoundary,U=a.altBoundary,V=a.flipVariations,ie=V===void 0?!0:V,me=a.allowedAutoPlacements,pe=n.options.placement,Le=Su(pe),Qe=Le===pe,He=C||(Qe||!ie?[z0(pe)]:pD(pe)),$e=[pe].concat(He).reduce(function(zt,Yt){return zt.concat(Su(Yt)===ub?fD(n,{placement:Yt,boundary:P,rootBoundary:j,padding:k,flipVariations:ie,allowedAutoPlacements:me}):Yt)},[]),ke=n.rects.reference,Ze=n.rects.popper,nt=new Map,Ke=!0,Re=$e[0],_t=0;_t<$e.length;_t++){var It=$e[_t],Ot=Su(It),Vt=sg(It)===ig,Wt=[go,Ol].indexOf(Ot)>=0,dn=Wt?"width":"height",Oe=n_(n,{placement:It,boundary:P,rootBoundary:j,altBoundary:U,padding:k}),vt=Wt?Vt?jl:yo:Vt?Ol:go;ke[dn]>Ze[dn]&&(vt=z0(vt));var mt=z0(vt),Qt=[];if(_&&Qt.push(Oe[Ot]<=0),c&&Qt.push(Oe[vt]<=0,Oe[mt]<=0),Qt.every(function(zt){return zt})){Re=It,Ke=!1;break}nt.set(It,Qt)}if(Ke)for(var Se=ie?3:1,gt=function(Yt){var tn=$e.find(function(gi){var Tn=nt.get(gi);if(Tn)return Tn.slice(0,Yt).every(function(ni){return ni})});if(tn)return Re=tn,"break"},kt=Se;kt>0;kt--){var St=gt(kt);if(St==="break")break}n.placement!==Re&&(n.modifiersData[h]._skip=!0,n.placement=Re,n.reset=!0)}}const gD={name:"flip",enabled:!0,phase:"main",fn:mD,requiresIfExists:["offset"],data:{_skip:!1}};function Y1(i,n,a){return a===void 0&&(a={x:0,y:0}),{top:i.top-n.height-a.y,right:i.right-n.width+a.x,bottom:i.bottom-n.height+a.y,left:i.left-n.width-a.x}}function q1(i){return[go,jl,Ol,yo].some(function(n){return i[n]>=0})}function yD(i){var n=i.state,a=i.name,h=n.rects.reference,p=n.rects.popper,_=n.modifiersData.preventOverflow,v=n_(n,{elementContext:"reference"}),c=n_(n,{altBoundary:!0}),C=Y1(v,h),k=Y1(c,p,_),P=q1(C),j=q1(k);n.modifiersData[a]={referenceClippingOffsets:C,popperEscapeOffsets:k,isReferenceHidden:P,hasPopperEscaped:j},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":P,"data-popper-escaped":j})}const _D={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:yD};function vD(i,n,a){var h=Su(i),p=[yo,go].indexOf(h)>=0?-1:1,_=typeof a=="function"?a(Object.assign({},n,{placement:i})):a,v=_[0],c=_[1];return v=v||0,c=(c||0)*p,[yo,jl].indexOf(h)>=0?{x:c,y:v}:{x:v,y:c}}function xD(i){var n=i.state,a=i.options,h=i.name,p=a.offset,_=p===void 0?[0,0]:p,v=iT.reduce(function(P,j){return P[j]=vD(j,n.rects,_),P},{}),c=v[n.placement],C=c.x,k=c.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=C,n.modifiersData.popperOffsets.y+=k),n.modifiersData[h]=v}const bD={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:xD};function wD(i){var n=i.state,a=i.name;n.modifiersData[a]=uT({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const TD={name:"popperOffsets",enabled:!0,phase:"read",fn:wD,data:{}};function ED(i){return i==="x"?"y":"x"}function SD(i){var n=i.state,a=i.options,h=i.name,p=a.mainAxis,_=p===void 0?!0:p,v=a.altAxis,c=v===void 0?!1:v,C=a.boundary,k=a.rootBoundary,P=a.altBoundary,j=a.padding,U=a.tether,V=U===void 0?!0:U,ie=a.tetherOffset,me=ie===void 0?0:ie,pe=n_(n,{boundary:C,rootBoundary:k,padding:j,altBoundary:P}),Le=Su(n.placement),Qe=sg(n.placement),He=!Qe,$e=fb(Le),ke=ED($e),Ze=n.modifiersData.popperOffsets,nt=n.rects.reference,Ke=n.rects.popper,Re=typeof me=="function"?me(Object.assign({},n.rects,{placement:n.placement})):me,_t=typeof Re=="number"?{mainAxis:Re,altAxis:Re}:Object.assign({mainAxis:0,altAxis:0},Re),It=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Ot={x:0,y:0};if(Ze){if(_){var Vt,Wt=$e==="y"?go:yo,dn=$e==="y"?Ol:jl,Oe=$e==="y"?"height":"width",vt=Ze[$e],mt=vt+pe[Wt],Qt=vt-pe[dn],Se=V?-Ke[Oe]/2:0,gt=Qe===ig?nt[Oe]:Ke[Oe],kt=Qe===ig?-Ke[Oe]:-nt[Oe],St=n.elements.arrow,zt=V&&St?db(St):{width:0,height:0},Yt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:sT(),tn=Yt[Wt],gi=Yt[dn],Tn=Zy(0,nt[Oe],zt[Oe]),ni=He?nt[Oe]/2-Se-Tn-tn-_t.mainAxis:gt-Tn-tn-_t.mainAxis,ba=He?-nt[Oe]/2+Se+Tn+gi+_t.mainAxis:kt+Tn+gi+_t.mainAxis,Mi=n.elements.arrow&&v_(n.elements.arrow),yi=Mi?$e==="y"?Mi.clientTop||0:Mi.clientLeft||0:0,Er=(Vt=It==null?void 0:It[$e])!=null?Vt:0,Zn=vt+ni-Er-yi,Gn=vt+ba-Er,wa=Zy(V?F0(mt,Zn):mt,vt,V?bp(Qt,Gn):Qt);Ze[$e]=wa,Ot[$e]=wa-vt}if(c){var li,js=$e==="x"?go:yo,is=$e==="x"?Ol:jl,rr=Ze[ke],fr=ke==="y"?"height":"width",xo=rr+pe[js],Bs=rr-pe[is],bo=[go,yo].indexOf(Le)!==-1,Fs=(li=It==null?void 0:It[ke])!=null?li:0,Xr=bo?xo:rr-nt[fr]-Ke[fr]-Fs+_t.altAxis,Ki=bo?rr+nt[fr]+Ke[fr]-Fs-_t.altAxis:Bs,pr=V&&bo?XC(Xr,rr,Ki):Zy(V?Xr:xo,rr,V?Ki:Bs);Ze[ke]=pr,Ot[ke]=pr-rr}n.modifiersData[h]=Ot}}const AD={name:"preventOverflow",enabled:!0,phase:"main",fn:SD,requiresIfExists:["offset"]};function MD(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function CD(i){return i===Ko(i)||!Au(i)?pb(i):MD(i)}function DD(i){var n=i.getBoundingClientRect(),a=rg(n.width)/i.offsetWidth||1,h=rg(n.height)/i.offsetHeight||1;return a!==1||h!==1}function kD(i,n,a){a===void 0&&(a=!1);var h=Au(n),p=Au(n)&&DD(n),_=mf(n),v=ag(i,p,a),c={scrollLeft:0,scrollTop:0},C={x:0,y:0};return(h||!h&&!a)&&((cf(n)!=="body"||gb(_))&&(c=CD(n)),Au(n)?(C=ag(n,!0),C.x+=n.clientLeft,C.y+=n.clientTop):_&&(C.x=mb(_))),{x:v.left+c.scrollLeft-C.x,y:v.top+c.scrollTop-C.y,width:v.width,height:v.height}}function ID(i){var n=new Map,a=new Set,h=[];i.forEach(function(_){n.set(_.name,_)});function p(_){a.add(_.name);var v=[].concat(_.requires||[],_.requiresIfExists||[]);v.forEach(function(c){if(!a.has(c)){var C=n.get(c);C&&p(C)}}),h.push(_)}return i.forEach(function(_){a.has(_.name)||p(_)}),h}function RD(i){var n=ID(i);return YC.reduce(function(a,h){return a.concat(n.filter(function(p){return p.phase===h}))},[])}function zD(i){var n;return function(){return n||(n=new Promise(function(a){Promise.resolve().then(function(){n=void 0,a(i())})})),n}}function LD(i){var n=i.reduce(function(a,h){var p=a[h.name];return a[h.name]=p?Object.assign({},p,h,{options:Object.assign({},p.options,h.options),data:Object.assign({},p.data,h.data)}):h,a},{});return Object.keys(n).map(function(a){return n[a]})}var H1={placement:"bottom",modifiers:[],strategy:"absolute"};function X1(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return!n.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function ND(i){i===void 0&&(i={});var n=i,a=n.defaultModifiers,h=a===void 0?[]:a,p=n.defaultOptions,_=p===void 0?H1:p;return function(c,C,k){k===void 0&&(k=_);var P={placement:"bottom",orderedModifiers:[],options:Object.assign({},H1,_),modifiersData:{},elements:{reference:c,popper:C},attributes:{},styles:{}},j=[],U=!1,V={state:P,setOptions:function(Le){var Qe=typeof Le=="function"?Le(P.options):Le;me(),P.options=Object.assign({},_,P.options,Qe),P.scrollParents={reference:Mp(c)?Gy(c):c.contextElement?Gy(c.contextElement):[],popper:Gy(C)};var He=RD(LD([].concat(h,P.options.modifiers)));return P.orderedModifiers=He.filter(function($e){return $e.enabled}),ie(),V.update()},forceUpdate:function(){if(!U){var Le=P.elements,Qe=Le.reference,He=Le.popper;if(X1(Qe,He)){P.rects={reference:kD(Qe,v_(He),P.options.strategy==="fixed"),popper:db(He)},P.reset=!1,P.placement=P.options.placement,P.orderedModifiers.forEach(function(_t){return P.modifiersData[_t.name]=Object.assign({},_t.data)});for(var $e=0;$e<P.orderedModifiers.length;$e++){if(P.reset===!0){P.reset=!1,$e=-1;continue}var ke=P.orderedModifiers[$e],Ze=ke.fn,nt=ke.options,Ke=nt===void 0?{}:nt,Re=ke.name;typeof Ze=="function"&&(P=Ze({state:P,options:Ke,name:Re,instance:V})||P)}}}},update:zD(function(){return new Promise(function(pe){V.forceUpdate(),pe(P)})}),destroy:function(){me(),U=!0}};if(!X1(c,C))return V;V.setOptions(k).then(function(pe){!U&&k.onFirstUpdate&&k.onFirstUpdate(pe)});function ie(){P.orderedModifiers.forEach(function(pe){var Le=pe.name,Qe=pe.options,He=Qe===void 0?{}:Qe,$e=pe.effect;if(typeof $e=="function"){var ke=$e({state:P,name:Le,instance:V,options:He}),Ze=function(){};j.push(ke||Ze)}})}function me(){j.forEach(function(pe){return pe()}),j=[]}return V}}const PD=ND({defaultModifiers:[_D,TD,iD,aD,bD,gD,AD,JC]}),OD=["enabled","placement","strategy","modifiers"];function jD(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}const BD={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},FD={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:i})=>()=>{const{reference:n,popper:a}=i.elements;if("removeAttribute"in n){const h=(n.getAttribute("aria-describedby")||"").split(",").filter(p=>p.trim()!==a.id);h.length?n.setAttribute("aria-describedby",h.join(",")):n.removeAttribute("aria-describedby")}},fn:({state:i})=>{var n;const{popper:a,reference:h}=i.elements,p=(n=a.getAttribute("role"))==null?void 0:n.toLowerCase();if(a.id&&p==="tooltip"&&"setAttribute"in h){const _=h.getAttribute("aria-describedby");if(_&&_.split(",").indexOf(a.id)!==-1)return;h.setAttribute("aria-describedby",_?`${_},${a.id}`:a.id)}}},UD=[];function VD(i,n,a={}){let{enabled:h=!0,placement:p="bottom",strategy:_="absolute",modifiers:v=UD}=a,c=jD(a,OD);const C=ce.useRef(v),k=ce.useRef(),P=ce.useCallback(()=>{var pe;(pe=k.current)==null||pe.update()},[]),j=ce.useCallback(()=>{var pe;(pe=k.current)==null||pe.forceUpdate()},[]),[U,V]=LC(ce.useState({placement:p,update:P,forceUpdate:j,attributes:{},styles:{popper:{},arrow:{}}})),ie=ce.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:pe})=>{const Le={},Qe={};Object.keys(pe.elements).forEach(He=>{Le[He]=pe.styles[He],Qe[He]=pe.attributes[He]}),V({state:pe,styles:Le,attributes:Qe,update:P,forceUpdate:j,placement:pe.placement})}}),[P,j,V]),me=ce.useMemo(()=>(Vy(C.current,v)||(C.current=v),C.current),[v]);return ce.useEffect(()=>{!k.current||!h||k.current.setOptions({placement:p,strategy:_,modifiers:[...me,ie,BD]})},[_,p,ie,h,me]),ce.useEffect(()=>{if(!(!h||i==null||n==null))return k.current=PD(i,n,Object.assign({},c,{placement:p,strategy:_,modifiers:[...me,FD,ie]})),()=>{k.current!=null&&(k.current.destroy(),k.current=void 0,V(pe=>Object.assign({},pe,{attributes:{},styles:{popper:{}}})))}},[h,i,n]),U}function U0(i,n){if(i.contains)return i.contains(n);if(i.compareDocumentPosition)return i===n||!!(i.compareDocumentPosition(n)&16)}var ex,W1;function ZD(){if(W1)return ex;W1=1;var i=function(){};return ex=i,ex}var GD=ZD();const $D=Lp(GD),Q1=()=>{};function YD(i){return i.button===0}function qD(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}const L0=i=>i&&("current"in i?i.current:i),K1={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function HD(i,n=Q1,{disabled:a,clickTrigger:h="click"}={}){const p=ce.useRef(!1),_=ce.useRef(!1),v=ce.useCallback(k=>{const P=L0(i);$D(!!P,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),p.current=!P||qD(k)||!YD(k)||!!U0(P,k.target)||_.current,_.current=!1},[i]),c=_u(k=>{const P=L0(i);P&&U0(P,k.target)?_.current=!0:_.current=!1}),C=_u(k=>{p.current||n(k)});ce.useEffect(()=>{var k,P;if(a||i==null)return;const j=m_(L0(i)),U=j.defaultView||window;let V=(k=U.event)!=null?k:(P=U.parent)==null?void 0:P.event,ie=null;K1[h]&&(ie=Nh(j,K1[h],c,!0));const me=Nh(j,h,v,!0),pe=Nh(j,h,Qe=>{if(Qe===V){V=void 0;return}C(Qe)});let Le=[];return"ontouchstart"in j.documentElement&&(Le=[].slice.call(j.body.children).map(Qe=>Nh(Qe,"mousemove",Q1))),()=>{ie==null||ie(),me(),pe(),Le.forEach(Qe=>Qe())}},[i,a,h,v,c,C])}function XD(i){const n={};return Array.isArray(i)?(i==null||i.forEach(a=>{n[a.name]=a}),n):i||n}function WD(i={}){return Array.isArray(i)?i:Object.keys(i).map(n=>(i[n].name=n,i[n]))}function QD({enabled:i,enableEvents:n,placement:a,flip:h,offset:p,fixed:_,containerPadding:v,arrowElement:c,popperConfig:C={}}){var k,P,j,U;const V=XD(C.modifiers);return Object.assign({},C,{placement:a,enabled:i,strategy:_?"fixed":C.strategy,modifiers:WD(Object.assign({},V,{eventListeners:{enabled:n,options:(k=V.eventListeners)==null?void 0:k.options},preventOverflow:Object.assign({},V.preventOverflow,{options:Object.assign({padding:v},(P=V.preventOverflow)==null?void 0:P.options)}),offset:{options:Object.assign({offset:p},(j=V.offset)==null?void 0:j.options)},arrow:Object.assign({},V.arrow,{enabled:!!c,options:Object.assign({},(U=V.arrow)==null?void 0:U.options,{element:c})}),flip:Object.assign({enabled:!!h},V.flip)}))})}const KD=ce.createContext(null),JD="data-rr-ui-";function ek(i){return`${JD}${i}`}const hT=ce.createContext(cv?window:void 0);hT.Provider;function yb(){return ce.useContext(hT)}const tk=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",nk=typeof document<"u",dT=nk||tk?ce.useLayoutEffect:ce.useEffect,x_=ce.createContext(null);x_.displayName="NavbarContext";const ik={type:Uh.string,tooltip:Uh.bool,as:Uh.elementType},dv=ce.forwardRef(({as:i="div",className:n,type:a="valid",tooltip:h=!1,...p},_)=>se.jsx(i,{...p,ref:_,className:Mn(n,`${a}-${h?"tooltip":"feedback"}`)}));dv.displayName="Feedback";dv.propTypes=ik;const Hh=ce.createContext({}),_b=ce.forwardRef(({id:i,bsPrefix:n,className:a,type:h="checkbox",isValid:p=!1,isInvalid:_=!1,as:v="input",...c},C)=>{const{controlId:k}=ce.useContext(Hh);return n=Un(n,"form-check-input"),se.jsx(v,{...c,ref:C,type:h,id:i||k,className:Mn(a,n,p&&"is-valid",_&&"is-invalid")})});_b.displayName="FormCheckInput";const V0=ce.forwardRef(({bsPrefix:i,className:n,htmlFor:a,...h},p)=>{const{controlId:_}=ce.useContext(Hh);return i=Un(i,"form-check-label"),se.jsx("label",{...h,ref:p,htmlFor:a||_,className:Mn(n,i)})});V0.displayName="FormCheckLabel";const fT=ce.forwardRef(({id:i,bsPrefix:n,bsSwitchPrefix:a,inline:h=!1,reverse:p=!1,disabled:_=!1,isValid:v=!1,isInvalid:c=!1,feedbackTooltip:C=!1,feedback:k,feedbackType:P,className:j,style:U,title:V="",type:ie="checkbox",label:me,children:pe,as:Le="input",...Qe},He)=>{n=Un(n,"form-check"),a=Un(a,"form-switch");const{controlId:$e}=ce.useContext(Hh),ke=ce.useMemo(()=>({controlId:i||$e}),[$e,i]),Ze=!pe&&me!=null&&me!==!1||IC(pe,V0),nt=se.jsx(_b,{...Qe,type:ie==="switch"?"checkbox":ie,ref:He,isValid:v,isInvalid:c,disabled:_,as:Le});return se.jsx(Hh.Provider,{value:ke,children:se.jsx("div",{style:U,className:Mn(j,Ze&&n,h&&`${n}-inline`,p&&`${n}-reverse`,ie==="switch"&&a),children:pe||se.jsxs(se.Fragment,{children:[nt,Ze&&se.jsx(V0,{title:V,children:me}),k&&se.jsx(dv,{type:P,tooltip:C,children:k})]})})})});fT.displayName="FormCheck";const Z0=Object.assign(fT,{Input:_b,Label:V0}),pT=ce.forwardRef(({bsPrefix:i,type:n,size:a,htmlSize:h,id:p,className:_,isValid:v=!1,isInvalid:c=!1,plaintext:C,readOnly:k,as:P="input",...j},U)=>{const{controlId:V}=ce.useContext(Hh);return i=Un(i,"form-control"),se.jsx(P,{...j,type:n,size:h,ref:U,readOnly:k,id:p||V,className:Mn(_,C?`${i}-plaintext`:i,a&&`${i}-${a}`,n==="color"&&`${i}-color`,v&&"is-valid",c&&"is-invalid")})});pT.displayName="FormControl";const rk=Object.assign(pT,{Feedback:dv}),mT=ce.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=Un(n,"form-floating"),se.jsx(a,{ref:p,className:Mn(i,n),...h})));mT.displayName="FormFloating";const vb=ce.forwardRef(({controlId:i,as:n="div",...a},h)=>{const p=ce.useMemo(()=>({controlId:i}),[i]);return se.jsx(Hh.Provider,{value:p,children:se.jsx(n,{...a,ref:h})})});vb.displayName="FormGroup";const gT=ce.forwardRef(({as:i="label",bsPrefix:n,column:a=!1,visuallyHidden:h=!1,className:p,htmlFor:_,...v},c)=>{const{controlId:C}=ce.useContext(Hh);n=Un(n,"form-label");let k="col-form-label";typeof a=="string"&&(k=`${k} ${k}-${a}`);const P=Mn(p,n,h&&"visually-hidden",a&&k);return _=_||C,a?se.jsx(tT,{ref:c,as:"label",className:P,htmlFor:_,...v}):se.jsx(i,{ref:c,className:P,htmlFor:_,...v})});gT.displayName="FormLabel";const yT=ce.forwardRef(({bsPrefix:i,className:n,id:a,...h},p)=>{const{controlId:_}=ce.useContext(Hh);return i=Un(i,"form-range"),se.jsx("input",{...h,type:"range",ref:p,className:Mn(n,i),id:a||_})});yT.displayName="FormRange";const _T=ce.forwardRef(({bsPrefix:i,size:n,htmlSize:a,className:h,isValid:p=!1,isInvalid:_=!1,id:v,...c},C)=>{const{controlId:k}=ce.useContext(Hh);return i=Un(i,"form-select"),se.jsx("select",{...c,size:a,ref:C,className:Mn(h,i,n&&`${i}-${n}`,p&&"is-valid",_&&"is-invalid"),id:v||k})});_T.displayName="FormSelect";const vT=ce.forwardRef(({bsPrefix:i,className:n,as:a="small",muted:h,...p},_)=>(i=Un(i,"form-text"),se.jsx(a,{...p,ref:_,className:Mn(n,i,h&&"text-muted")})));vT.displayName="FormText";const xT=ce.forwardRef((i,n)=>se.jsx(Z0,{...i,ref:n,type:"switch"}));xT.displayName="Switch";const ak=Object.assign(xT,{Input:Z0.Input,Label:Z0.Label}),bT=ce.forwardRef(({bsPrefix:i,className:n,children:a,controlId:h,label:p,..._},v)=>(i=Un(i,"form-floating"),se.jsxs(vb,{ref:v,className:Mn(n,i),controlId:h,..._,children:[a,se.jsx("label",{htmlFor:h,children:p})]})));bT.displayName="FloatingLabel";const sk={_ref:Uh.any,validated:Uh.bool,as:Uh.elementType},xb=ce.forwardRef(({className:i,validated:n,as:a="form",...h},p)=>se.jsx(a,{...h,ref:p,className:Mn(i,n&&"was-validated")}));xb.displayName="Form";xb.propTypes=sk;const Ai=Object.assign(xb,{Group:vb,Control:rk,Floating:mT,Check:Z0,Switch:ak,Label:gT,Text:vT,Range:yT,Select:_T,FloatingLabel:bT}),J1=i=>!i||typeof i=="function"?i:n=>{i.current=n};function ok(i,n){const a=J1(i),h=J1(n);return p=>{a&&a(p),h&&h(p)}}function fv(i,n){return ce.useMemo(()=>ok(i,n),[i,n])}function tx(i){i===void 0&&(i=m_());try{var n=i.activeElement;return!n||!n.nodeName?null:n}catch{return i.body}}function lk(i){const n=ce.useRef(i);return n.current=i,n}function ck(i){const n=lk(i);ce.useEffect(()=>()=>n.current(),[])}function uk(i=document){const n=i.defaultView;return Math.abs(n.innerWidth-i.documentElement.clientWidth)}const ew=ek("modal-open");class bb{constructor({ownerDocument:n,handleContainerOverflow:a=!0,isRTL:h=!1}={}){this.handleContainerOverflow=a,this.isRTL=h,this.modals=[],this.ownerDocument=n}getScrollbarWidth(){return uk(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(n){}removeModalAttributes(n){}setContainerStyle(n){const a={overflow:"hidden"},h=this.isRTL?"paddingLeft":"paddingRight",p=this.getElement();n.style={overflow:p.style.overflow,[h]:p.style[h]},n.scrollBarWidth&&(a[h]=`${parseInt(Fh(p,h)||"0",10)+n.scrollBarWidth}px`),p.setAttribute(ew,""),Fh(p,a)}reset(){[...this.modals].forEach(n=>this.remove(n))}removeContainerStyle(n){const a=this.getElement();a.removeAttribute(ew),Object.assign(a.style,n.style)}add(n){let a=this.modals.indexOf(n);return a!==-1||(a=this.modals.length,this.modals.push(n),this.setModalAttributes(n),a!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),a}remove(n){const a=this.modals.indexOf(n);a!==-1&&(this.modals.splice(a,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(n))}isTopModal(n){return!!this.modals.length&&this.modals[this.modals.length-1]===n}}const nx=(i,n)=>cv?i==null?(n||m_()).body:(typeof i=="function"&&(i=i()),i&&"current"in i&&(i=i.current),i&&("nodeType"in i||i.getBoundingClientRect)?i:null):null;function Sx(i,n){const a=yb(),[h,p]=ce.useState(()=>nx(i,a==null?void 0:a.document));if(!h){const _=nx(i);_&&p(_)}return ce.useEffect(()=>{},[n,h]),ce.useEffect(()=>{const _=nx(i);_!==h&&p(_)},[i,h]),h}function hk({children:i,in:n,onExited:a,mountOnEnter:h,unmountOnExit:p}){const _=ce.useRef(null),v=ce.useRef(n),c=_u(a);ce.useEffect(()=>{n?v.current=!0:c(_.current)},[n,c]);const C=fv(_,vg(i)),k=ce.cloneElement(i,{ref:C});return n?k:p||!v.current&&h?null:k}const dk=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function fk(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}function pk(i){let{onEnter:n,onEntering:a,onEntered:h,onExit:p,onExiting:_,onExited:v,addEndListener:c,children:C}=i,k=fk(i,dk);const P=ce.useRef(null),j=fv(P,vg(C)),U=$e=>ke=>{$e&&P.current&&$e(P.current,ke)},V=ce.useCallback(U(n),[n]),ie=ce.useCallback(U(a),[a]),me=ce.useCallback(U(h),[h]),pe=ce.useCallback(U(p),[p]),Le=ce.useCallback(U(_),[_]),Qe=ce.useCallback(U(v),[v]),He=ce.useCallback(U(c),[c]);return Object.assign({},k,{nodeRef:P},n&&{onEnter:V},a&&{onEntering:ie},h&&{onEntered:me},p&&{onExit:pe},_&&{onExiting:Le},v&&{onExited:Qe},c&&{addEndListener:He},{children:typeof C=="function"?($e,ke)=>C($e,Object.assign({},ke,{ref:j})):ce.cloneElement(C,{ref:j})})}const mk=["component"];function gk(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}const yk=ce.forwardRef((i,n)=>{let{component:a}=i,h=gk(i,mk);const p=pk(h);return se.jsx(a,Object.assign({ref:n},p))});function _k({in:i,onTransition:n}){const a=ce.useRef(null),h=ce.useRef(!0),p=_u(n);return j1(()=>{if(!a.current)return;let _=!1;return p({in:i,element:a.current,initial:h.current,isStale:()=>_}),()=>{_=!0}},[i,p]),j1(()=>(h.current=!1,()=>{h.current=!0}),[]),a}function vk({children:i,in:n,onExited:a,onEntered:h,transition:p}){const[_,v]=ce.useState(!n);n&&_&&v(!1);const c=_k({in:!!n,onTransition:k=>{const P=()=>{k.isStale()||(k.in?h==null||h(k.element,k.initial):(v(!0),a==null||a(k.element)))};Promise.resolve(p(k)).then(P,j=>{throw k.in||v(!0),j})}}),C=fv(c,vg(i));return _&&!n?null:ce.cloneElement(i,{ref:C})}function Ax(i,n,a){return i?se.jsx(yk,Object.assign({},a,{component:i})):n?se.jsx(vk,Object.assign({},a,{transition:n})):se.jsx(hk,Object.assign({},a))}const xk=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function bk(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}let ix;function wk(i){return ix||(ix=new bb({ownerDocument:i==null?void 0:i.document})),ix}function Tk(i){const n=yb(),a=i||wk(n),h=ce.useRef({dialog:null,backdrop:null});return Object.assign(h.current,{add:()=>a.add(h.current),remove:()=>a.remove(h.current),isTopModal:()=>a.isTopModal(h.current),setDialogRef:ce.useCallback(p=>{h.current.dialog=p},[]),setBackdropRef:ce.useCallback(p=>{h.current.backdrop=p},[])})}const wT=ce.forwardRef((i,n)=>{let{show:a=!1,role:h="dialog",className:p,style:_,children:v,backdrop:c=!0,keyboard:C=!0,onBackdropClick:k,onEscapeKeyDown:P,transition:j,runTransition:U,backdropTransition:V,runBackdropTransition:ie,autoFocus:me=!0,enforceFocus:pe=!0,restoreFocus:Le=!0,restoreFocusOptions:Qe,renderDialog:He,renderBackdrop:$e=Gn=>se.jsx("div",Object.assign({},Gn)),manager:ke,container:Ze,onShow:nt,onHide:Ke=()=>{},onExit:Re,onExited:_t,onExiting:It,onEnter:Ot,onEntering:Vt,onEntered:Wt}=i,dn=bk(i,xk);const Oe=yb(),vt=Sx(Ze),mt=Tk(ke),Qt=J2(),Se=wC(a),[gt,kt]=ce.useState(!a),St=ce.useRef(null);ce.useImperativeHandle(n,()=>mt,[mt]),cv&&!Se&&a&&(St.current=tx(Oe==null?void 0:Oe.document)),a&&gt&&kt(!1);const zt=_u(()=>{if(mt.add(),ba.current=Nh(document,"keydown",Tn),ni.current=Nh(document,"focus",()=>setTimeout(tn),!0),nt&&nt(),me){var Gn,wa;const li=tx((Gn=(wa=mt.dialog)==null?void 0:wa.ownerDocument)!=null?Gn:Oe==null?void 0:Oe.document);mt.dialog&&li&&!U0(mt.dialog,li)&&(St.current=li,mt.dialog.focus())}}),Yt=_u(()=>{if(mt.remove(),ba.current==null||ba.current(),ni.current==null||ni.current(),Le){var Gn;(Gn=St.current)==null||Gn.focus==null||Gn.focus(Qe),St.current=null}});ce.useEffect(()=>{!a||!vt||zt()},[a,vt,zt]),ce.useEffect(()=>{gt&&Yt()},[gt,Yt]),ck(()=>{Yt()});const tn=_u(()=>{if(!pe||!Qt()||!mt.isTopModal())return;const Gn=tx(Oe==null?void 0:Oe.document);mt.dialog&&Gn&&!U0(mt.dialog,Gn)&&mt.dialog.focus()}),gi=_u(Gn=>{Gn.target===Gn.currentTarget&&(k==null||k(Gn),c===!0&&Ke())}),Tn=_u(Gn=>{C&&G2(Gn)&&mt.isTopModal()&&(P==null||P(Gn),Gn.defaultPrevented||Ke())}),ni=ce.useRef(),ba=ce.useRef(),Mi=(...Gn)=>{kt(!0),_t==null||_t(...Gn)};if(!vt)return null;const yi=Object.assign({role:h,ref:mt.setDialogRef,"aria-modal":h==="dialog"?!0:void 0},dn,{style:_,className:p,tabIndex:-1});let Er=He?He(yi):se.jsx("div",Object.assign({},yi,{children:ce.cloneElement(v,{role:"document"})}));Er=Ax(j,U,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!a,onExit:Re,onExiting:It,onExited:Mi,onEnter:Ot,onEntering:Vt,onEntered:Wt,children:Er});let Zn=null;return c&&(Zn=$e({ref:mt.setBackdropRef,onClick:gi}),Zn=Ax(V,ie,{in:!!a,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Zn})),se.jsx(se.Fragment,{children:_p.createPortal(se.jsxs(se.Fragment,{children:[Zn,Er]}),vt)})});wT.displayName="Modal";const Ek=Object.assign(wT,{Manager:bb});function Mx(i,n){return i.classList?!!n&&i.classList.contains(n):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+n+" ")!==-1}function Sk(i,n){i.classList?i.classList.add(n):Mx(i,n)||(typeof i.className=="string"?i.className=i.className+" "+n:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+n))}function tw(i,n){return i.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Ak(i,n){i.classList?i.classList.remove(n):typeof i.className=="string"?i.className=tw(i.className,n):i.setAttribute("class",tw(i.className&&i.className.baseVal||"",n))}const Gm={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class TT extends bb{adjustAndStore(n,a,h){const p=a.style[n];a.dataset[n]=p,Fh(a,{[n]:`${parseFloat(Fh(a,n))+h}px`})}restore(n,a){const h=a.dataset[n];h!==void 0&&(delete a.dataset[n],Fh(a,{[n]:h}))}setContainerStyle(n){super.setContainerStyle(n);const a=this.getElement();if(Sk(a,"modal-open"),!n.scrollBarWidth)return;const h=this.isRTL?"paddingLeft":"paddingRight",p=this.isRTL?"marginLeft":"marginRight";Zm(a,Gm.FIXED_CONTENT).forEach(_=>this.adjustAndStore(h,_,n.scrollBarWidth)),Zm(a,Gm.STICKY_CONTENT).forEach(_=>this.adjustAndStore(p,_,-n.scrollBarWidth)),Zm(a,Gm.NAVBAR_TOGGLER).forEach(_=>this.adjustAndStore(p,_,n.scrollBarWidth))}removeContainerStyle(n){super.removeContainerStyle(n);const a=this.getElement();Ak(a,"modal-open");const h=this.isRTL?"paddingLeft":"paddingRight",p=this.isRTL?"marginLeft":"marginRight";Zm(a,Gm.FIXED_CONTENT).forEach(_=>this.restore(h,_)),Zm(a,Gm.STICKY_CONTENT).forEach(_=>this.restore(p,_)),Zm(a,Gm.NAVBAR_TOGGLER).forEach(_=>this.restore(p,_))}}let rx;function Mk(i){return rx||(rx=new TT(i)),rx}const ET=ce.createContext({onHide(){}}),Ck=ce.forwardRef(({closeLabel:i="Close",closeVariant:n,closeButton:a=!1,onHide:h,children:p,..._},v)=>{const c=ce.useContext(ET),C=y_(()=>{c==null||c.onHide(),h==null||h()});return se.jsxs("div",{ref:v,..._,children:[p,a&&se.jsx(lb,{"aria-label":i,variant:n,onClick:C})]})}),ST=ce.forwardRef(({bsPrefix:i,className:n,as:a,...h},p)=>{i=Un(i,"navbar-brand");const _=a||(h.href?"a":"span");return se.jsx(_,{...h,ref:p,className:Mn(n,i)})});ST.displayName="NavbarBrand";const AT=ce.forwardRef(({children:i,bsPrefix:n,...a},h)=>{n=Un(n,"navbar-collapse");const p=ce.useContext(x_);return se.jsx(q2,{in:!!(p&&p.expanded),...a,children:se.jsx("div",{ref:h,className:n,children:i})})});AT.displayName="NavbarCollapse";const MT=ce.forwardRef(({bsPrefix:i,className:n,children:a,label:h="Toggle navigation",as:p="button",onClick:_,...v},c)=>{i=Un(i,"navbar-toggler");const{onToggle:C,expanded:k}=ce.useContext(x_)||{},P=y_(j=>{_&&_(j),C&&C()});return p==="button"&&(v.type="button"),se.jsx(p,{...v,ref:c,onClick:P,"aria-label":h,className:Mn(n,i,!k&&"collapsed"),children:a||se.jsx("span",{className:`${i}-icon`})})});MT.displayName="NavbarToggle";const Cx=new WeakMap,nw=(i,n)=>{if(!i||!n)return;const a=Cx.get(n)||new Map;Cx.set(n,a);let h=a.get(i);return h||(h=n.matchMedia(i),h.refCount=0,a.set(h.media,h)),h};function Dk(i,n=typeof window>"u"?void 0:window){const a=nw(i,n),[h,p]=ce.useState(()=>a?a.matches:!1);return dT(()=>{let _=nw(i,n);if(!_)return p(!1);let v=Cx.get(n);const c=()=>{p(_.matches)};return _.refCount++,_.addListener(c),c(),()=>{_.removeListener(c),_.refCount--,_.refCount<=0&&(v==null||v.delete(_.media)),_=void 0}},[i]),h}function kk(i){const n=Object.keys(i);function a(c,C){return c===C?C:c?`${c} and ${C}`:C}function h(c){return n[Math.min(n.indexOf(c)+1,n.length-1)]}function p(c){const C=h(c);let k=i[C];return typeof k=="number"?k=`${k-.2}px`:k=`calc(${k} - 0.2px)`,`(max-width: ${k})`}function _(c){let C=i[c];return typeof C=="number"&&(C=`${C}px`),`(min-width: ${C})`}function v(c,C,k){let P;typeof c=="object"?(P=c,k=C,C=!0):(C=C||!0,P={[c]:C});let j=ce.useMemo(()=>Object.entries(P).reduce((U,[V,ie])=>((ie==="up"||ie===!0)&&(U=a(U,_(V))),(ie==="down"||ie===!0)&&(U=a(U,p(V))),U),""),[JSON.stringify(P)]);return Dk(j,k)}return v}const Ik=kk({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),CT=ce.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=Un(n,"offcanvas-body"),se.jsx(a,{ref:p,className:Mn(i,n),...h})));CT.displayName="OffcanvasBody";const Rk={[Pc]:"show",[Rh]:"show"},DT=ce.forwardRef(({bsPrefix:i,className:n,children:a,in:h=!1,mountOnEnter:p=!1,unmountOnExit:_=!1,appear:v=!1,...c},C)=>(i=Un(i,"offcanvas"),se.jsx(ab,{ref:C,addEndListener:rb,in:h,mountOnEnter:p,unmountOnExit:_,appear:v,...c,childRef:vg(a),children:(k,P)=>ce.cloneElement(a,{...P,className:Mn(n,a.props.className,(k===Pc||k===e_)&&`${i}-toggling`,Rk[k])})})));DT.displayName="OffcanvasToggling";const kT=ce.forwardRef(({bsPrefix:i,className:n,closeLabel:a="Close",closeButton:h=!1,...p},_)=>(i=Un(i,"offcanvas-header"),se.jsx(Ck,{ref:_,...p,className:Mn(n,i),closeLabel:a,closeButton:h})));kT.displayName="OffcanvasHeader";const zk=xC("h5"),IT=ce.forwardRef(({className:i,bsPrefix:n,as:a=zk,...h},p)=>(n=Un(n,"offcanvas-title"),se.jsx(a,{ref:p,className:Mn(i,n),...h})));IT.displayName="OffcanvasTitle";function Lk(i){return se.jsx(DT,{...i})}function Nk(i){return se.jsx(B0,{...i})}const RT=ce.forwardRef(({bsPrefix:i,className:n,children:a,"aria-labelledby":h,placement:p="start",responsive:_,show:v=!1,backdrop:c=!0,keyboard:C=!0,scroll:k=!1,onEscapeKeyDown:P,onShow:j,onHide:U,container:V,autoFocus:ie=!0,enforceFocus:me=!0,restoreFocus:pe=!0,restoreFocusOptions:Le,onEntered:Qe,onExit:He,onExiting:$e,onEnter:ke,onEntering:Ze,onExited:nt,backdropClassName:Ke,manager:Re,renderStaticNode:_t=!1,...It},Ot)=>{const Vt=ce.useRef();i=Un(i,"offcanvas");const[Wt,dn]=ce.useState(!1),Oe=y_(U),vt=Ik(_||"xs","up");ce.useEffect(()=>{dn(_?v&&!vt:v)},[v,_,vt]);const mt=ce.useMemo(()=>({onHide:Oe}),[Oe]);function Qt(){return Re||(k?(Vt.current||(Vt.current=new TT({handleContainerOverflow:!1})),Vt.current):Mk())}const Se=(zt,...Yt)=>{zt&&(zt.style.visibility="visible"),ke==null||ke(zt,...Yt)},gt=(zt,...Yt)=>{zt&&(zt.style.visibility=""),nt==null||nt(...Yt)},kt=ce.useCallback(zt=>se.jsx("div",{...zt,className:Mn(`${i}-backdrop`,Ke)}),[Ke,i]),St=zt=>se.jsx("div",{...zt,...It,className:Mn(n,_?`${i}-${_}`:i,`${i}-${p}`),"aria-labelledby":h,children:a});return se.jsxs(se.Fragment,{children:[!Wt&&(_||_t)&&St({}),se.jsx(ET.Provider,{value:mt,children:se.jsx(Ek,{show:Wt,ref:Ot,backdrop:c,container:V,keyboard:C,autoFocus:ie,enforceFocus:me&&!k,restoreFocus:pe,restoreFocusOptions:Le,onEscapeKeyDown:P,onShow:j,onHide:Oe,onEnter:Se,onEntering:Ze,onEntered:Qe,onExit:He,onExiting:$e,onExited:gt,manager:Qt(),transition:Lk,backdropTransition:Nk,renderBackdrop:kt,renderDialog:St})})]})});RT.displayName="Offcanvas";const Pk=Object.assign(RT,{Body:CT,Header:kT,Title:IT}),zT=ce.forwardRef(({onHide:i,...n},a)=>{const h=ce.useContext(x_),p=y_(()=>{h==null||h.onToggle==null||h.onToggle(),i==null||i()});return se.jsx(Pk,{ref:a,show:!!(h!=null&&h.expanded),...n,renderStaticNode:!0,onHide:p})});zT.displayName="NavbarOffcanvas";const LT=ce.forwardRef(({className:i,bsPrefix:n,as:a="span",...h},p)=>(n=Un(n,"navbar-text"),se.jsx(a,{ref:p,className:Mn(i,n),...h})));LT.displayName="NavbarText";const NT=ce.forwardRef((i,n)=>{const{bsPrefix:a,expand:h=!0,variant:p="light",bg:_,fixed:v,sticky:c,className:C,as:k="nav",expanded:P,onToggle:j,onSelect:U,collapseOnSelect:V=!1,...ie}=U2(i,{expanded:"onToggle"}),me=Un(a,"navbar"),pe=ce.useCallback((...He)=>{U==null||U(...He),V&&P&&(j==null||j(!1))},[U,V,P,j]);ie.role===void 0&&k!=="nav"&&(ie.role="navigation");let Le=`${me}-expand`;typeof h=="string"&&(Le=`${Le}-${h}`);const Qe=ce.useMemo(()=>({onToggle:()=>j==null?void 0:j(!P),bsPrefix:me,expanded:!!P,expand:h}),[me,P,h,j]);return se.jsx(x_.Provider,{value:Qe,children:se.jsx(KD.Provider,{value:pe,children:se.jsx(k,{ref:n,...ie,className:Mn(C,me,h&&Le,p&&`${me}-${p}`,_&&`bg-${_}`,c&&`sticky-${c}`,v&&`fixed-${v}`)})})})});NT.displayName="Navbar";const Ok=Object.assign(NT,{Brand:ST,Collapse:AT,Offcanvas:zT,Text:LT,Toggle:MT}),jk=()=>{};function Bk(i,n,{disabled:a,clickTrigger:h}={}){const p=n||jk;HD(i,p,{disabled:a,clickTrigger:h});const _=_u(v=>{G2(v)&&p(v)});ce.useEffect(()=>{if(a||i==null)return;const v=m_(L0(i));let c=(v.defaultView||window).event;const C=Nh(v,"keyup",k=>{if(k===c){c=void 0;return}_(k)});return()=>{C()}},[i,a,_])}const PT=ce.forwardRef((i,n)=>{const{flip:a,offset:h,placement:p,containerPadding:_,popperConfig:v={},transition:c,runTransition:C}=i,[k,P]=O1(),[j,U]=O1(),V=fv(P,n),ie=Sx(i.container),me=Sx(i.target),[pe,Le]=ce.useState(!i.show),Qe=VD(me,k,QD({placement:p,enableEvents:!!i.show,containerPadding:_||5,flip:a,offset:h,arrowElement:j,popperConfig:v}));i.show&&pe&&Le(!1);const He=(...It)=>{Le(!0),i.onExited&&i.onExited(...It)},$e=i.show||!pe;if(Bk(k,i.onHide,{disabled:!i.rootClose||i.rootCloseDisabled,clickTrigger:i.rootCloseEvent}),!$e)return null;const{onExit:ke,onExiting:Ze,onEnter:nt,onEntering:Ke,onEntered:Re}=i;let _t=i.children(Object.assign({},Qe.attributes.popper,{style:Qe.styles.popper,ref:V}),{popper:Qe,placement:p,show:!!i.show,arrowProps:Object.assign({},Qe.attributes.arrow,{style:Qe.styles.arrow,ref:U})});return _t=Ax(c,C,{in:!!i.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:_t,onExit:ke,onExiting:Ze,onExited:He,onEnter:nt,onEntering:Ke,onEntered:Re}),ie?_p.createPortal(_t,ie):null});PT.displayName="Overlay";const OT=ce.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=Un(n,"popover-header"),se.jsx(a,{ref:p,className:Mn(i,n),...h})));OT.displayName="PopoverHeader";const wb=ce.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=Un(n,"popover-body"),se.jsx(a,{ref:p,className:Mn(i,n),...h})));wb.displayName="PopoverBody";function jT(i,n){let a=i;return i==="left"?a=n?"end":"start":i==="right"&&(a=n?"start":"end"),a}function BT(i="absolute"){return{position:i,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const Fk=ce.forwardRef(({bsPrefix:i,placement:n="right",className:a,style:h,children:p,body:_,arrowProps:v,hasDoneInitialMeasure:c,popper:C,show:k,...P},j)=>{const U=Un(i,"popover"),V=V2(),[ie]=(n==null?void 0:n.split("-"))||[],me=jT(ie,V);let pe=h;return k&&!c&&(pe={...h,...BT(C==null?void 0:C.strategy)}),se.jsxs("div",{ref:j,role:"tooltip",style:pe,"x-placement":ie,className:Mn(a,U,ie&&`bs-popover-${me}`),...P,children:[se.jsx("div",{className:"popover-arrow",...v}),_?se.jsx(wb,{children:p}):p]})}),Uk=Object.assign(Fk,{Header:OT,Body:wb,POPPER_OFFSET:[0,8]}),FT=ce.forwardRef(({bsPrefix:i,placement:n="right",className:a,style:h,children:p,arrowProps:_,hasDoneInitialMeasure:v,popper:c,show:C,...k},P)=>{i=Un(i,"tooltip");const j=V2(),[U]=(n==null?void 0:n.split("-"))||[],V=jT(U,j);let ie=h;return C&&!v&&(ie={...h,...BT(c==null?void 0:c.strategy)}),se.jsxs("div",{ref:P,style:ie,role:"tooltip","x-placement":U,className:Mn(a,i,`bs-tooltip-${V}`),...k,children:[se.jsx("div",{className:"tooltip-arrow",..._}),se.jsx("div",{className:`${i}-inner`,children:p})]})});FT.displayName="Tooltip";const Vk=Object.assign(FT,{TOOLTIP_OFFSET:[0,6]});function Zk(i){const n=ce.useRef(null),a=Un(void 0,"popover"),h=Un(void 0,"tooltip"),p=ce.useMemo(()=>({name:"offset",options:{offset:()=>{if(i)return i;if(n.current){if(Mx(n.current,a))return Uk.POPPER_OFFSET;if(Mx(n.current,h))return Vk.TOOLTIP_OFFSET}return[0,0]}}}),[i,a,h]);return[n,[p]]}function Gk(i,n){const{ref:a}=i,{ref:h}=n;i.ref=a.__wrapped||(a.__wrapped=p=>a(wx(p))),n.ref=h.__wrapped||(h.__wrapped=p=>h(wx(p)))}const UT=ce.forwardRef(({children:i,transition:n=B0,popperConfig:a={},rootClose:h=!1,placement:p="top",show:_=!1,...v},c)=>{const C=ce.useRef({}),[k,P]=ce.useState(null),[j,U]=Zk(v.offset),V=Y2(c,j),ie=n===!0?B0:n||void 0,me=y_(pe=>{P(pe),a==null||a.onFirstUpdate==null||a.onFirstUpdate(pe)});return dT(()=>{k&&v.target&&(C.current.scheduleUpdate==null||C.current.scheduleUpdate())},[k,v.target]),ce.useEffect(()=>{_||P(null)},[_]),se.jsx(PT,{...v,ref:V,popperConfig:{...a,modifiers:U.concat(a.modifiers||[]),onFirstUpdate:me},transition:ie,rootClose:h,placement:p,show:_,children:(pe,{arrowProps:Le,popper:Qe,show:He})=>{var $e;Gk(pe,Le);const ke=Qe==null?void 0:Qe.placement,Ze=Object.assign(C.current,{state:Qe==null?void 0:Qe.state,scheduleUpdate:Qe==null?void 0:Qe.update,placement:ke,outOfBoundaries:(Qe==null||($e=Qe.state)==null||($e=$e.modifiersData.hide)==null?void 0:$e.isReferenceHidden)||!1,strategy:a.strategy}),nt=!!k;return typeof i=="function"?i({...pe,placement:ke,show:He,...!n&&He&&{className:"show"},popper:Ze,arrowProps:Le,hasDoneInitialMeasure:nt}):ce.cloneElement(i,{...pe,placement:ke,arrowProps:Le,popper:Ze,hasDoneInitialMeasure:nt,className:Mn(i.props.className,!n&&He&&"show"),style:{...i.props.style,...pe.style}})}})});UT.displayName="Overlay";const VT=ce.forwardRef(({bsPrefix:i,variant:n,animation:a="border",size:h,as:p="div",className:_,...v},c)=>{i=Un(i,"spinner");const C=`${i}-${a}`;return se.jsx(p,{ref:c,...v,className:Mn(_,C,h&&`${C}-${h}`,n&&`text-${n}`)})});VT.displayName="Spinner";const $k=ce.forwardRef(({bsPrefix:i,className:n,striped:a,bordered:h,borderless:p,hover:_,size:v,variant:c,responsive:C,...k},P)=>{const j=Un(i,"table"),U=Mn(n,j,c&&`${j}-${c}`,v&&`${j}-${v}`,a&&`${j}-${typeof a=="string"?`striped-${a}`:"striped"}`,h&&`${j}-bordered`,p&&`${j}-borderless`,_&&`${j}-hover`),V=se.jsx("table",{...k,className:U,ref:P});if(C){let ie=`${j}-responsive`;return typeof C=="string"&&(ie=`${ie}-${C}`),se.jsx("div",{className:ie,children:V})}return V});function Yk({tripQueryVariables:i,setTripQueryVariables:n,coordinates:a,onClose:h}){return se.jsx(Xw,{longitude:a.lng,latitude:a.lat,anchor:"bottom",onClose:h,children:se.jsxs(cb,{vertical:!0,children:[se.jsx(Ap,{onClick:()=>{n({...i,from:{coordinates:{latitude:a.lat,longitude:a.lng}}}),h()},children:"Start here"}),se.jsx(Ap,{onClick:()=>{n({...i,to:{coordinates:{latitude:a.lat,longitude:a.lng}}}),h()},children:"End here"})]})})}function qk({coordinates:i,properties:n,onClose:a}){return se.jsxs(Xw,{latitude:i.lat,longitude:i.lng,closeButton:!0,onClose:()=>a(),maxWidth:"350px",children:[se.jsx($k,{bordered:!0,children:se.jsx("tbody",{children:Object.entries(n).map(([h,p])=>se.jsxs("tr",{children:[se.jsx("th",{scope:"row",children:h}),se.jsx("td",{children:String(p)})]},h))})}),se.jsx("div",{className:"geometry-popup-osm-link",children:se.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${i.lat}&mlon=${i.lng}#map=18/${i.lat}/${i.lng}`,target:"_blank",rel:"noreferrer",children:" osm.org"})})]})}const ZT=i=>{const n=i.getStyle();return!n||!n.layers?[]:n.layers.filter(a=>a.type!=="raster"&&!a.id.startsWith("jsx")).filter(a=>i.getLayoutProperty(a.id,"visibility")!=="none").map(a=>a.id)},Hk=({mapRef:i,setInteractiveLayerIds:n})=>{const[a,h]=ce.useState([]),[p,_]=ce.useState({});ce.useEffect(()=>{if(!i)return;const C=i.getMap(),k=()=>{const P=C.getStyle();if(!P||!P.layers)return;const j=P.layers.filter(V=>V.type==="raster").map(V=>{var pe;let ie=V.id;const me=(pe=V.metadata)==null?void 0:pe.name;return me&&(ie=me),{id:V.id,name:ie}});h(j);const U={};P.layers.filter(V=>V.type!=="raster"&&!V.id.startsWith("jsx")).reverse().forEach(V=>{var me;const ie=((me=V.metadata)==null?void 0:me.group)||"Misc";U[ie]||(U[ie]=[]),U[ie].push({id:V.id,name:V.id})}),_(U)};return C.isStyleLoaded()?k():C.on("styledata",k),()=>{C.off("styledata",k)}},[i]);const v=ce.useCallback((C,k)=>{if(!i)return;const P=i.getMap();P.setLayoutProperty(C,"visibility",k?"visible":"none");const j=ZT(P);n(j)},[i,n]),c=ce.useCallback(C=>{if(!i)return;const k=i.getMap();a.forEach(P=>{k.setLayoutProperty(P.id,"visibility",P.id===C?"visible":"none")})},[i,a]);return se.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[se.jsx("h4",{style:{marginTop:0},children:"Background"}),se.jsx("select",{onChange:C=>c(C.target.value),children:a.map(C=>se.jsx("option",{value:C.id,children:C.name},C.id))}),se.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(p).map(([C,k])=>{const P=k.every(U=>(i==null?void 0:i.getMap().getLayoutProperty(U.id,"visibility"))!=="none"),j=U=>{k.forEach(V=>{v(V.id,U)})};return se.jsxs("div",{style:{marginBottom:"10px"},children:[se.jsx("h6",{style:{margin:"0 0 5px"},children:se.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[se.jsx("input",{type:"checkbox",checked:P,onChange:U=>j(U.target.checked),style:{marginRight:"5px"}}),C]})}),k.map(U=>{const V=(i==null?void 0:i.getMap().getLayoutProperty(U.id,"visibility"))!=="none";return se.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[se.jsx("input",{type:"checkbox",checked:V,onChange:ie=>v(U.id,ie.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),U.name]},U.id)})]},C)})]})},Xk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class Wk extends ce.Component{constructor(a){super(a);mp(this,"toggleSidebar",a=>{this.setState(h=>({isSidebarOpen:h.activeContent!==a||!h.isSidebarOpen,activeContent:h.activeContent===a?null:a}))});this.state={isSidebarOpen:!1,activeContent:null}}render(){const{isSidebarOpen:a,activeContent:h}=this.state,{position:p,setInteractiveLayerIds:_,mapRef:v}=this.props;return se.jsxs("div",{children:[se.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${h==="debugLayer"?"active":""} ${a?"open":""}`,style:{top:"20px"},children:se.jsx("img",{src:Xk,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),se.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:a?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:a?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:a&&h==="debugLayer"&&se.jsx(Hk,{position:p,setInteractiveLayerIds:_,mapRef:v})})]})}}const Qk="/otp/routers/default/inspector/vectortile/style.json";function Kk({tripQueryVariables:i,setTripQueryVariables:n,tripQueryResult:a,selectedTripPatternIndex:h,loading:p}){var ke,Ze;const _=jM({tripQueryVariables:i,setTripQueryVariables:n}),[v,c]=ce.useState(null),[C,k]=ce.useState(null),[P,j]=ce.useState([]),[U,V]=ce.useState("auto"),ie=ce.useCallback(()=>V("pointer"),[]),me=ce.useCallback(()=>V("auto"),[]),pe=nt=>{if(nt.features){const Ke=nt.features[0];k({coordinates:nt.lngLat,feature:Ke})}},Le=nt=>{const Ke=nt.target;if(Ke.getZoom()<2){const Re=Ke.getSource("stops");Ke.fitBounds(Re.bounds,{animate:!1})}},Qe=nt=>{nt.target.addControl(new Kw.AttributionControl,"bottom-left")};function He(nt){Le(nt);const Ke=ZT(nt.target);j(Ke),Qe(nt)}const $e=ce.useRef(null);return se.jsx("div",{className:"map-container below-content",children:se.jsxs(AS,{attributionControl:!1,mapLib:qw(()=>Promise.resolve().then(()=>Jw),void 0),mapStyle:Qk,onDblClick:_,onContextMenu:nt=>{c(nt.lngLat)},interactiveLayerIds:P,cursor:U,onMouseEnter:ie,onMouseLeave:me,onClick:pe,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:He,ref:$e,children:[se.jsx(RS,{position:"top-left"}),se.jsx(RM,{setCursor:V,tripQueryVariables:i,setTripQueryVariables:n,loading:p}),se.jsx(Wk,{position:"top-right",setInteractiveLayerIds:j,mapRef:$e==null?void 0:$e.current}),(a==null?void 0:a.trip.tripPatterns.length)&&se.jsx(NM,{tripPattern:a.trip.tripPatterns[h]}),v&&se.jsx(Yk,{tripQueryVariables:i,setTripQueryVariables:n,coordinates:v,onClose:()=>c(null)}),((ke=C==null?void 0:C.feature)==null?void 0:ke.properties)&&se.jsx(qk,{coordinates:C==null?void 0:C.coordinates,properties:(Ze=C==null?void 0:C.feature)==null?void 0:Ze.properties,onClose:()=>k(null)})]})})}function Jk(){const[i,n]=ce.useState(0),a=ce.useRef(null);return ce.useLayoutEffect(()=>{a.current&&n(a.current.getBoundingClientRect().width)},[]),ce.useEffect(()=>{const h=()=>{a.current&&n(a.current.getBoundingClientRect().width)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),{containerRef:a,containerWidth:i}}const eI=70,tI=20,Dx=40;function nI(i,n,a,h){const p=ce.useMemo(()=>new Date(h).getTime()-new Date(a).getTime(),[a,h]),_=ce.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(a).getTime())/p,[i.expectedStartTime,a,p]),v=ce.useMemo(()=>new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime(),[i.expectedStartTime,i.expectedEndTime]),c=tI+Dx,k=n-eI-Dx-c,P=c+_*k,j=k*(v/p);return{maxSpan:p,startPx:c,pxSpan:k,widthPx:j,leftPx:P}}const iI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",rI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",aI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",sI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",oI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",lI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",cI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",uI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",hI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",dI="https://www.opentripplanner.org/debug-client-assets/2025/05/2025-05-02T06:44/assets/monorail-CEIE-7ZV.png",fI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",pI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",mI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",gI="https://www.opentripplanner.org/debug-client-assets/2025/05/2025-05-02T06:44/assets/trolleybus-BefhFtdd.png",yI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function _I(i){return i===Ei.Rail||i===Ei.Coach||i===Ei.Metro||i===Ei.Bus||i===Ei.Tram||i===Ei.Water||i===Ei.Air||i===Ei.Cableway||i===Ei.Funicular||i===Ei.Trolleybus||i===Ei.Monorail||i===Ei.Taxi}function vI(i){const n=xI(i);function a(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const h=a(n[0]/255),p=a(n[1]/255),_=a(n[2]/255);return .2126*h+.7152*p+.0722*_>.179?"#000":"#fff"}function xI(i){return bI(i)}function bI(i){return i.length===4?wI(i):[parseInt(i.slice(1,3),16),parseInt(i.slice(3,5),16),parseInt(i.slice(5,7),16)]}function wI(i){const n=i.slice(1,2),a=i.slice(2,3),h=i.slice(3,4);return[parseInt(n+n,16),parseInt(a+a,16),parseInt(h+h,16)]}function TI(i,n,a,h,p){var j;const _=ce.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(n).getTime())/a,[i.expectedStartTime,n,a]),v=ce.useMemo(()=>p*(new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime())/a-1,[p,i,a]),c=h+_*p+1,C=v>40&&_I(i.mode)&&((j=i.line)==null?void 0:j.publicCode)&&i.line.publicCode.length<=6,k=j2(i),P=ce.useMemo(()=>vI(k),[k]);return{widthPx:v,leftPx:c,legTextColor:P,modeColor:k,showPublicCode:C}}const EI=Object.assign({"../../static/img/mode/air.png":iI,"../../static/img/mode/bicycle.png":rI,"../../static/img/mode/bus.png":aI,"../../static/img/mode/cableway.png":sI,"../../static/img/mode/car.png":oI,"../../static/img/mode/coach.png":lI,"../../static/img/mode/foot.png":cI,"../../static/img/mode/funicular.png":uI,"../../static/img/mode/metro.png":hI,"../../static/img/mode/monorail.png":dI,"../../static/img/mode/rail.png":fI,"../../static/img/mode/taxi.png":pI,"../../static/img/mode/tram.png":mI,"../../static/img/mode/trolleybus.png":gI,"../../static/img/mode/water.png":yI});function SI(i){return EI[`../../static/img/mode/${i.mode.toLowerCase()}.png`]}function AI({leg:i,earliestStartTime:n,maxSpan:a,startPx:h,pxSpan:p}){var j;const{widthPx:_,leftPx:v,legTextColor:c,modeColor:C,showPublicCode:k}=TI(i,n,a,h,p),P=SI(i);return se.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${_}px`,left:v,color:c,background:C},children:[se.jsx("div",{className:"itinerary-header-leg-icon",style:{background:c,maskImage:`url(${P})`,WebkitMaskImage:`url(${P})`}}),k&&se.jsx("span",{className:"itinerary-header-leg-public-code",children:(j=i.line)==null?void 0:j.publicCode})]})}function $y(i,n,a){return new Date(i).toLocaleTimeString("en-US",{timeStyle:a,hourCycle:"h24",timeZone:n})}const b_=ce.createContext("UTC");function MI({tripPattern:i,itineraryIndex:n,containerWidth:a,earliestStartTime:h,latestEndTime:p}){const{maxSpan:_,pxSpan:v,startPx:c,widthPx:C,leftPx:k}=nI(i,a,h,p),P=ce.useContext(b_),j=ce.useMemo(()=>$y(i.expectedStartTime,P,"short"),[i.expectedStartTime,P]),U=ce.useMemo(()=>$y(i.expectedEndTime,P,"short"),[i.expectedEndTime,P]);return se.jsxs("div",{className:"itinerary-header-wrapper",children:[se.jsxs("div",{className:"itinerary-header-itinerary-number",children:[n+1,"."]}),se.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${C+5}px`,left:`${k-2}px`}}),se.jsx("div",{title:i.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${k-Dx}px`},children:j}),i.legs.map((V,ie)=>se.jsx(AI,{leg:V,earliestStartTime:h,startPx:c,maxSpan:_,pxSpan:v},V.id||`leg_${ie}`)),se.jsx("div",{title:i.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${k+C+2}px`},children:U})]})}function CI(i){const n=ce.useMemo(()=>(i==null?void 0:i.trip.tripPatterns.reduce((h,p)=>h===null?p==null?void 0:p.expectedStartTime:new Date(p==null?void 0:p.expectedStartTime)<new Date(h)?p.expectedStartTime:h,null))||null,[i==null?void 0:i.trip]),a=ce.useMemo(()=>(i==null?void 0:i.trip.tripPatterns.reduce((h,p)=>h===null?p==null?void 0:p.expectedEndTime:new Date(p==null?void 0:p.expectedEndTime)>new Date(h)?p.expectedEndTime:h,null))||null,[i==null?void 0:i.trip]);return[n,a]}function iw({aimedTime:i,expectedTime:n,hasRealtime:a}){const h=ce.useContext(b_);return i!==n?se.jsxs(se.Fragment,{children:[se.jsx("span",{title:n,style:{color:"red"},children:$y(n,h,"short")}),se.jsx("span",{title:i,style:{textDecoration:"line-through"},children:$y(i,h,"short")})]}):se.jsxs("span",{title:n,children:[$y(n,h,"short"),a&&se.jsx("span",{children:" (on time)"})]})}function DI(i){const n=i/1e3;return n>100?`${n.toFixed(0)} km`:n>1?`${n.toFixed(1)} km`:`${i.toFixed(0)} m`}function kI(i){const n=Math.floor(i/3600),a=Math.floor(i/60)%60,h=i%60;let p="";return n>0&&(p=`${p}${n}h `),a>0&&(p=`${p}${a}min `),h>1&&(p=`${p}${h}s`),p}const II="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function RI({leg:i}){var n;return(n=i.interchangeFrom)!=null&&n.staySeated?se.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:II,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const zI=_g(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),LI=Qo(zI),NI="/graphiql?flavor=transmodel";function PI({legId:i,legName:n}){const a={id:i},h=encodeURIComponent(LI),p=encodeURIComponent(JSON.stringify(a));return se.jsx("a",{href:NI+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}const OI=_g(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),jI=Qo(OI),BI="/graphiql?flavor=transmodel";function rw({legId:i,legName:n}){const a={id:i},h=encodeURIComponent(jI),p=encodeURIComponent(JSON.stringify(a));return se.jsx("a",{href:BI+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}const FI=_g(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),UI=Qo(FI),VI="/graphiql?flavor=transmodel";function ZI({legId:i,legName:n}){const a={id:i},h=encodeURIComponent(UI),p=encodeURIComponent(JSON.stringify(a));return se.jsx("a",{href:VI+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}function GI(i){var n,a,h,p;return(n=i.line)!=null&&n.publicCode?i.line.publicCode+" "+((h=(a=i.toEstimatedCall)==null?void 0:a.destinationDisplay)==null?void 0:h.frontText):((p=i.line)==null?void 0:p.name)||"unknown"}function $I({leg:i,isLast:n}){var a,h,p,_,v;return se.jsxs("div",{className:"itinerary-leg-details",children:[se.jsxs("div",{className:"times",children:[DI(i.distance),", ",kI(i.duration),","," ",se.jsxs("span",{title:"Generalized cost: "+i.generalizedCost,children:["",i.generalizedCost]})]}),se.jsx(RI,{leg:i}),se.jsx(iw,{aimedTime:i.aimedStartTime,expectedTime:i.expectedStartTime,hasRealtime:i.realtime})," -"," ",se.jsx(iw,{aimedTime:i.aimedEndTime,expectedTime:i.expectedEndTime,hasRealtime:i.realtime}),se.jsxs("div",{className:"mode",children:[se.jsx("b",{children:i.mode})," ",i.line&&se.jsxs(se.Fragment,{children:[se.jsx(PI,{legId:(a=i.line)==null?void 0:a.id,legName:GI(i)}),", ",se.jsx(ZI,{legId:(h=i.authority)==null?void 0:h.id,legName:(p=i.authority)==null?void 0:p.name})]})," ",i.mode!==Ei.Foot&&se.jsxs(se.Fragment,{children:[se.jsx("br",{}),se.jsx(rw,{legId:(_=i.fromPlace.quay)==null?void 0:_.id,legName:i.fromPlace.name})," "," "]})," ",!n&&se.jsx(rw,{legId:(v=i.toPlace.quay)==null?void 0:v.id,legName:i.toPlace.name})]})]})}function YI({tripPattern:i}){return se.jsxs("div",{children:[i.systemNotices.length>0&&se.jsxs("p",{children:["System tags: ",i.systemNotices.map(n=>n.tag).join(", ")]}),i.legs.map((n,a)=>se.jsx($I,{leg:n,isLast:a===i.legs.length-1},n.id?n.id:`noid_${a}`)),se.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ",i.generalizedCost]})]})}function qI({previousPageCursor:i,nextPageCursor:n,onPagination:a,loading:h}){return se.jsxs("div",{style:{display:"flex",justifyContent:"space-evenly"},children:[se.jsx(Ap,{variant:"outline-primary",size:"sm",disabled:!i||h,onClick:()=>{i&&a(i)},children:"Previous page"})," ",se.jsx(Ap,{variant:"outline-primary",size:"sm",disabled:!n||h,onClick:()=>{n&&a(n)},children:"Next page"})]})}function HI({tripQueryResult:i,selectedTripPatternIndex:n,setSelectedTripPatternIndex:a,pageResults:h,loading:p}){const[_,v]=CI(i),{containerRef:c,containerWidth:C}=Jk(),k=ce.useContext(b_);return se.jsxs("section",{className:"left-pane-container below-content",ref:c,children:[se.jsxs(se.Fragment,{children:[se.jsx("div",{className:"panel-header",children:"Itinerary results"}),se.jsx("div",{className:"pagination-controls",children:se.jsx(qI,{onPagination:h,previousPageCursor:i==null?void 0:i.trip.previousPageCursor,nextPageCursor:i==null?void 0:i.trip.nextPageCursor,loading:p})}),se.jsx(M0,{activeKey:`${n}`,onSelect:P=>a(parseInt(P)),children:i&&i.trip.tripPatterns.map((P,j)=>se.jsxs(M0.Item,{eventKey:`${j}`,bsPrefix:P.systemNotices.length===0?"":"accordion-item-filtered",children:[se.jsx(M0.Header,{children:se.jsx(MI,{containerWidth:C,tripPattern:P,itineraryIndex:j,earliestStartTime:_,latestEndTime:v})}),se.jsx(M0.Body,{children:se.jsx(YI,{tripPattern:P})})]},`${j}`))})]}),se.jsxs("div",{className:"time-zone-info",children:["All times in ",se.jsx("code",{children:k})]})]})}const kx=_g(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        generalizedCost
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            generalizedCost
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            toEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),XI=Qo(kx),WI=i=>{const[n,a]=ce.useState(null),[h,p]=ce.useState(!1),_=ce.useCallback(async v=>{if(h)console.warn("Wait for previous search to finish");else if(i){p(!0);try{a(v?await j0(Jy(),kx,{...i,pageCursor:v}):await j0(Jy(),kx,i))}catch(c){console.error("Error at useTripQuery",c)}p(!1)}else console.warn("Can't search without variables")},[a,i,h]);return ce.useEffect(()=>{aw(i==null?void 0:i.from)&&aw(i==null?void 0:i.to)&&_()},[i==null?void 0:i.from,i==null?void 0:i.to]),[n,h,_]};function aw(i){return i&&(i.coordinates||i.place)}const QI=_g(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),KI=()=>{const[i,n]=ce.useState(null);return ce.useEffect(()=>{(async()=>{n(await j0(Jy(),QI))})()},[]),i==null?void 0:i.serverInfo},JI={from:{},to:{},dateTime:new Date().toISOString()},eR=()=>{const n=new URLSearchParams(window.location.search).get("variables");return n?JSON.parse(decodeURIComponent(n)):JI},tR=i=>{const n=new URLSearchParams(window.location.search);n.set("variables",encodeURIComponent(JSON.stringify(i))),history.pushState({},"","?"+n.toString()+window.location.hash)},nR=()=>{const[i,n]=ce.useState(eR());return ce.useEffect(()=>{tR(i)},[i]),{tripQueryVariables:i,setTripQueryVariables:n}};function iR({target:i,serverInfo:n}){return se.jsx(UT,{target:i.current,show:!!n,placement:"right",children:se.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:se.jsx("pre",{children:JSON.stringify(n,null,2)})})})}const rR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function aR({serverInfo:i}){const[n,a]=ce.useState(!1),h=ce.useRef(null);return se.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[se.jsx(Ok.Brand,{onClick:()=>a(p=>!p),children:se.jsxs("div",{ref:h,children:[se.jsx("img",{alt:"",src:rR,width:"50",height:"50",className:"logo-image"}),"OTP Debug",n&&se.jsx(iR,{serverInfo:i,target:h})]})}),se.jsxs("div",{className:"details",children:[se.jsxs("div",{children:["Version: ",i==null?void 0:i.version]}),se.jsxs("div",{children:["Time zone: ",i==null?void 0:i.internalTransitModelTimeZone]})]})]})}const sw=7,ow="-{0,1}\\d+(\\.\\d+){0,1}",sR="("+ow+")(\\s+)("+ow+")";function oR(i){const n=i.match(sR);return n?{coordinates:{latitude:+n[1],longitude:+n[4]}}:{place:i}}function lR(i){var n,a;return i.coordinates?`${(n=i.coordinates)==null?void 0:n.latitude.toPrecision(sw)} ${(a=i.coordinates)==null?void 0:a.longitude.toPrecision(sw)}`:i.place?i.place:null}function lw({id:i,label:n,tripQueryVariables:a,setTripQueryVariables:h,locationFieldKey:p}){const[_,v]=ce.useState("");ce.useEffect(()=>{const C=a[p];v(lR(C)||"")},[a,p]);const c=ce.useCallback(C=>{const k=oR(C)||{};h({...a,[p]:k})},[a,h,p]);return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:i,children:n}),se.jsx(Ai.Control,{type:"text",id:i,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:C=>{v(C.target.value)},onBlur:C=>{c(C.target.value)},value:_})]})}const cR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function uR({tripQueryVariables:i,setTripQueryVariables:n}){const a=()=>{n({...i,from:i.to,to:i.from})};return se.jsx("button",{className:"swap-from-to",onClick:a,title:"Swap from/to",children:se.jsx("img",{alt:"Swap from/to",src:cR})})}function hR({tripQueryVariables:i,setTripQueryVariables:n}){const a=h=>{n({...i,arriveBy:h})};return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Departure/Arrival"}),se.jsxs(Ai.Select,{size:"sm",onChange:h=>h.target.value==="arrival"?a(!0):a(!1),value:i.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[se.jsx("option",{value:"arrival",children:"Arrive before"}),se.jsx("option",{value:"departure",children:"Depart after"})]})]})}class Q extends Array{constructor(n,a){if(super(n),this.sign=a,Object.setPrototypeOf(this,Q.prototype),n>Q.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(n){var a=Math.floor,h=Number.isFinite;if(typeof n=="number"){if(n===0)return Q.__zero();if(Q.__isOneDigitInt(n))return 0>n?Q.__oneDigit(-n,!0):Q.__oneDigit(n,!1);if(!h(n)||a(n)!==n)throw new RangeError("The number "+n+" cannot be converted to BigInt because it is not an integer");return Q.__fromDouble(n)}if(typeof n=="string"){const p=Q.__fromString(n);if(p===null)throw new SyntaxError("Cannot convert "+n+" to a BigInt");return p}if(typeof n=="boolean")return n===!0?Q.__oneDigit(1,!1):Q.__zero();if(typeof n=="object"){if(n.constructor===Q)return n;const p=Q.__toPrimitive(n);return Q.BigInt(p)}throw new TypeError("Cannot convert "+n+" to a BigInt")}toDebugString(){const n=["BigInt["];for(const a of this)n.push((a&&(a>>>0).toString(16))+", ");return n.push("]"),n.join("")}toString(n=10){if(2>n||36<n)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(n&n-1)==0?Q.__toStringBasePowerOfTwo(this,n):Q.__toStringGeneric(this,n,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(n){const a=n.length;if(a===0)return 0;if(a===1){const pe=n.__unsignedDigit(0);return n.sign?-pe:pe}const h=n.__digit(a-1),p=Q.__clz30(h),_=30*a-p;if(1024<_)return n.sign?-1/0:1/0;let v=_-1,c=h,C=a-1;const k=p+3;let P=k===32?0:c<<k;P>>>=12;const j=k-12;let U=12<=k?0:c<<20+k,V=20+k;for(0<j&&0<C&&(C--,c=n.__digit(C),P|=c>>>30-j,U=c<<j+2,V=j+2);0<V&&0<C;)C--,c=n.__digit(C),U|=30<=V?c<<V-30:c>>>30-V,V-=30;const ie=Q.__decideRounding(n,V,C,c);if((ie===1||ie===0&&(1&U)==1)&&(U=U+1>>>0,U===0&&(P++,P>>>20!=0&&(P=0,v++,1023<v))))return n.sign?-1/0:1/0;const me=n.sign?-2147483648:0;return v=v+1023<<20,Q.__kBitConversionInts[1]=me|v|P,Q.__kBitConversionInts[0]=U,Q.__kBitConversionDouble[0]}static unaryMinus(n){if(n.length===0)return n;const a=n.__copy();return a.sign=!n.sign,a}static bitwiseNot(n){return n.sign?Q.__absoluteSubOne(n).__trim():Q.__absoluteAddOne(n,!0)}static exponentiate(n,a){if(a.sign)throw new RangeError("Exponent must be positive");if(a.length===0)return Q.__oneDigit(1,!1);if(n.length===0)return n;if(n.length===1&&n.__digit(0)===1)return n.sign&&(1&a.__digit(0))==0?Q.unaryMinus(n):n;if(1<a.length)throw new RangeError("BigInt too big");let h=a.__unsignedDigit(0);if(h===1)return n;if(h>=Q.__kMaxLengthBits)throw new RangeError("BigInt too big");if(n.length===1&&n.__digit(0)===2){const v=1+(0|h/30),c=n.sign&&(1&h)!=0,C=new Q(v,c);C.__initializeDigits();const k=1<<h%30;return C.__setDigit(v-1,k),C}let p=null,_=n;for((1&h)!=0&&(p=n),h>>=1;h!==0;h>>=1)_=Q.multiply(_,_),(1&h)!=0&&(p===null?p=_:p=Q.multiply(p,_));return p}static multiply(n,a){if(n.length===0)return n;if(a.length===0)return a;let h=n.length+a.length;30<=n.__clzmsd()+a.__clzmsd()&&h--;const p=new Q(h,n.sign!==a.sign);p.__initializeDigits();for(let _=0;_<n.length;_++)Q.__multiplyAccumulate(a,n.__digit(_),p,_);return p.__trim()}static divide(n,a){if(a.length===0)throw new RangeError("Division by zero");if(0>Q.__absoluteCompare(n,a))return Q.__zero();const h=n.sign!==a.sign,p=a.__unsignedDigit(0);let _;if(a.length===1&&32767>=p){if(p===1)return h===n.sign?n:Q.unaryMinus(n);_=Q.__absoluteDivSmall(n,p,null)}else _=Q.__absoluteDivLarge(n,a,!0,!1);return _.sign=h,_.__trim()}static remainder(n,a){if(a.length===0)throw new RangeError("Division by zero");if(0>Q.__absoluteCompare(n,a))return n;const h=a.__unsignedDigit(0);if(a.length===1&&32767>=h){if(h===1)return Q.__zero();const _=Q.__absoluteModSmall(n,h);return _===0?Q.__zero():Q.__oneDigit(_,n.sign)}const p=Q.__absoluteDivLarge(n,a,!1,!0);return p.sign=n.sign,p.__trim()}static add(n,a){const h=n.sign;return h===a.sign?Q.__absoluteAdd(n,a,h):0<=Q.__absoluteCompare(n,a)?Q.__absoluteSub(n,a,h):Q.__absoluteSub(a,n,!h)}static subtract(n,a){const h=n.sign;return h===a.sign?0<=Q.__absoluteCompare(n,a)?Q.__absoluteSub(n,a,h):Q.__absoluteSub(a,n,!h):Q.__absoluteAdd(n,a,h)}static leftShift(n,a){return a.length===0||n.length===0?n:a.sign?Q.__rightShiftByAbsolute(n,a):Q.__leftShiftByAbsolute(n,a)}static signedRightShift(n,a){return a.length===0||n.length===0?n:a.sign?Q.__leftShiftByAbsolute(n,a):Q.__rightShiftByAbsolute(n,a)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(n,a){return 0>Q.__compareToBigInt(n,a)}static lessThanOrEqual(n,a){return 0>=Q.__compareToBigInt(n,a)}static greaterThan(n,a){return 0<Q.__compareToBigInt(n,a)}static greaterThanOrEqual(n,a){return 0<=Q.__compareToBigInt(n,a)}static equal(n,a){if(n.sign!==a.sign||n.length!==a.length)return!1;for(let h=0;h<n.length;h++)if(n.__digit(h)!==a.__digit(h))return!1;return!0}static notEqual(n,a){return!Q.equal(n,a)}static bitwiseAnd(n,a){var h=Math.max;if(!n.sign&&!a.sign)return Q.__absoluteAnd(n,a).__trim();if(n.sign&&a.sign){const p=h(n.length,a.length)+1;let _=Q.__absoluteSubOne(n,p);const v=Q.__absoluteSubOne(a);return _=Q.__absoluteOr(_,v,_),Q.__absoluteAddOne(_,!0,_).__trim()}return n.sign&&([n,a]=[a,n]),Q.__absoluteAndNot(n,Q.__absoluteSubOne(a)).__trim()}static bitwiseXor(n,a){var h=Math.max;if(!n.sign&&!a.sign)return Q.__absoluteXor(n,a).__trim();if(n.sign&&a.sign){const v=h(n.length,a.length),c=Q.__absoluteSubOne(n,v),C=Q.__absoluteSubOne(a);return Q.__absoluteXor(c,C,c).__trim()}const p=h(n.length,a.length)+1;n.sign&&([n,a]=[a,n]);let _=Q.__absoluteSubOne(a,p);return _=Q.__absoluteXor(_,n,_),Q.__absoluteAddOne(_,!0,_).__trim()}static bitwiseOr(n,a){var h=Math.max;const p=h(n.length,a.length);if(!n.sign&&!a.sign)return Q.__absoluteOr(n,a).__trim();if(n.sign&&a.sign){let v=Q.__absoluteSubOne(n,p);const c=Q.__absoluteSubOne(a);return v=Q.__absoluteAnd(v,c,v),Q.__absoluteAddOne(v,!0,v).__trim()}n.sign&&([n,a]=[a,n]);let _=Q.__absoluteSubOne(a,p);return _=Q.__absoluteAndNot(_,n,_),Q.__absoluteAddOne(_,!0,_).__trim()}static asIntN(n,a){var h=Math.floor;if(a.length===0)return a;if(n=h(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return Q.__zero();if(n>=Q.__kMaxLengthBits)return a;const p=0|(n+29)/30;if(a.length<p)return a;const _=a.__unsignedDigit(p-1),v=1<<(n-1)%30;if(a.length===p&&_<v)return a;if((_&v)!==v)return Q.__truncateToNBits(n,a);if(!a.sign)return Q.__truncateAndSubFromPowerOfTwo(n,a,!0);if((_&v-1)==0){for(let c=p-2;0<=c;c--)if(a.__digit(c)!==0)return Q.__truncateAndSubFromPowerOfTwo(n,a,!1);return a.length===p&&_===v?a:Q.__truncateToNBits(n,a)}return Q.__truncateAndSubFromPowerOfTwo(n,a,!1)}static asUintN(n,a){var h=Math.floor;if(a.length===0)return a;if(n=h(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return Q.__zero();if(a.sign){if(n>Q.__kMaxLengthBits)throw new RangeError("BigInt too big");return Q.__truncateAndSubFromPowerOfTwo(n,a,!1)}if(n>=Q.__kMaxLengthBits)return a;const p=0|(n+29)/30;if(a.length<p)return a;const _=n%30;return a.length==p&&(_===0||!(a.__digit(p-1)>>>_))?a:Q.__truncateToNBits(n,a)}static ADD(n,a){if(n=Q.__toPrimitive(n),a=Q.__toPrimitive(a),typeof n=="string")return typeof a!="string"&&(a=a.toString()),n+a;if(typeof a=="string")return n.toString()+a;if(n=Q.__toNumeric(n),a=Q.__toNumeric(a),Q.__isBigInt(n)&&Q.__isBigInt(a))return Q.add(n,a);if(typeof n=="number"&&typeof a=="number")return n+a;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(n,a){return Q.__compare(n,a,0)}static LE(n,a){return Q.__compare(n,a,1)}static GT(n,a){return Q.__compare(n,a,2)}static GE(n,a){return Q.__compare(n,a,3)}static EQ(n,a){for(;;){if(Q.__isBigInt(n))return Q.__isBigInt(a)?Q.equal(n,a):Q.EQ(a,n);if(typeof n=="number"){if(Q.__isBigInt(a))return Q.__equalToNumber(a,n);if(typeof a!="object")return n==a;a=Q.__toPrimitive(a)}else if(typeof n=="string"){if(Q.__isBigInt(a))return n=Q.__fromString(n),n!==null&&Q.equal(n,a);if(typeof a!="object")return n==a;a=Q.__toPrimitive(a)}else if(typeof n=="boolean"){if(Q.__isBigInt(a))return Q.__equalToNumber(a,+n);if(typeof a!="object")return n==a;a=Q.__toPrimitive(a)}else if(typeof n=="symbol"){if(Q.__isBigInt(a))return!1;if(typeof a!="object")return n==a;a=Q.__toPrimitive(a)}else if(typeof n=="object"){if(typeof a=="object"&&a.constructor!==Q)return n==a;n=Q.__toPrimitive(n)}else return n==a}}static NE(n,a){return!Q.EQ(n,a)}static DataViewGetBigInt64(n,a,h=!1){return Q.asIntN(64,Q.DataViewGetBigUint64(n,a,h))}static DataViewGetBigUint64(n,a,h=!1){const[p,_]=h?[4,0]:[0,4],v=n.getUint32(a+p,h),c=n.getUint32(a+_,h),C=new Q(3,!1);return C.__setDigit(0,1073741823&c),C.__setDigit(1,(268435455&v)<<2|c>>>30),C.__setDigit(2,v>>>28),C.__trim()}static DataViewSetBigInt64(n,a,h,p=!1){Q.DataViewSetBigUint64(n,a,h,p)}static DataViewSetBigUint64(n,a,h,p=!1){h=Q.asUintN(64,h);let _=0,v=0;if(0<h.length&&(v=h.__digit(0),1<h.length)){const k=h.__digit(1);v|=k<<30,_=k>>>2,2<h.length&&(_|=h.__digit(2)<<28)}const[c,C]=p?[4,0]:[0,4];n.setUint32(a+c,_,p),n.setUint32(a+C,v,p)}static __zero(){return new Q(0,!1)}static __oneDigit(n,a){const h=new Q(1,a);return h.__setDigit(0,n),h}__copy(){const n=new Q(this.length,this.sign);for(let a=0;a<this.length;a++)n[a]=this[a];return n}__trim(){let n=this.length,a=this[n-1];for(;a===0;)n--,a=this[n-1],this.pop();return n===0&&(this.sign=!1),this}__initializeDigits(){for(let n=0;n<this.length;n++)this[n]=0}static __decideRounding(n,a,h,p){if(0<a)return-1;let _;if(0>a)_=-a-1;else{if(h===0)return-1;h--,p=n.__digit(h),_=29}let v=1<<_;if((p&v)==0)return-1;if(v-=1,(p&v)!=0)return 1;for(;0<h;)if(h--,n.__digit(h)!==0)return 1;return 0}static __fromDouble(n){Q.__kBitConversionDouble[0]=n;const a=2047&Q.__kBitConversionInts[1]>>>20,h=a-1023,p=(0|h/30)+1,_=new Q(p,0>n);let v=1048575&Q.__kBitConversionInts[1]|1048576,c=Q.__kBitConversionInts[0];const C=20,k=h%30;let P,j=0;if(k<20){const U=C-k;j=U+32,P=v>>>U,v=v<<32-U|c>>>U,c<<=32-U}else if(k===20)j=32,P=v,v=c,c=0;else{const U=k-C;j=32-U,P=v<<U|c>>>32-U,v=c<<U,c=0}_.__setDigit(p-1,P);for(let U=p-2;0<=U;U--)0<j?(j-=30,P=v>>>2,v=v<<30|c>>>2,c<<=30):P=0,_.__setDigit(U,P);return _.__trim()}static __isWhitespace(n){return 13>=n&&9<=n||(159>=n?n==32:131071>=n?n==160||n==5760:196607>=n?(n&=131071,10>=n||n==40||n==41||n==47||n==95||n==4096):n==65279)}static __fromString(n,a=0){let h=0;const p=n.length;let _=0;if(_===p)return Q.__zero();let v=n.charCodeAt(_);for(;Q.__isWhitespace(v);){if(++_===p)return Q.__zero();v=n.charCodeAt(_)}if(v===43){if(++_===p)return null;v=n.charCodeAt(_),h=1}else if(v===45){if(++_===p)return null;v=n.charCodeAt(_),h=-1}if(a===0){if(a=10,v===48){if(++_===p)return Q.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(a=16,++_===p)return null;v=n.charCodeAt(_)}else if(v===79||v===111){if(a=8,++_===p)return null;v=n.charCodeAt(_)}else if(v===66||v===98){if(a=2,++_===p)return null;v=n.charCodeAt(_)}}}else if(a===16&&v===48){if(++_===p)return Q.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(++_===p)return null;v=n.charCodeAt(_)}}if(h!=0&&a!==10)return null;for(;v===48;){if(++_===p)return Q.__zero();v=n.charCodeAt(_)}const c=p-_;let C=Q.__kMaxBitsPerChar[a],k=Q.__kBitsPerCharTableMultiplier-1;if(c>1073741824/C)return null;const P=C*c+k>>>Q.__kBitsPerCharTableShift,j=new Q(0|(P+29)/30,!1),U=10>a?a:10,V=10<a?a-10:0;if((a&a-1)==0){C>>=Q.__kBitsPerCharTableShift;const ie=[],me=[];let pe=!1;do{let Le=0,Qe=0;for(;;){let He;if(v-48>>>0<U)He=v-48;else if((32|v)-97>>>0<V)He=(32|v)-87;else{pe=!0;break}if(Qe+=C,Le=Le<<C|He,++_===p){pe=!0;break}if(v=n.charCodeAt(_),30<Qe+C)break}ie.push(Le),me.push(Qe)}while(!pe);Q.__fillFromParts(j,ie,me)}else{j.__initializeDigits();let ie=!1,me=0;do{let pe=0,Le=1;for(;;){let He;if(v-48>>>0<U)He=v-48;else if((32|v)-97>>>0<V)He=(32|v)-87;else{ie=!0;break}const $e=Le*a;if(1073741823<$e)break;if(Le=$e,pe=pe*a+He,me++,++_===p){ie=!0;break}v=n.charCodeAt(_)}k=30*Q.__kBitsPerCharTableMultiplier-1;const Qe=0|(C*me+k>>>Q.__kBitsPerCharTableShift)/30;j.__inplaceMultiplyAdd(Le,pe,Qe)}while(!ie)}if(_!==p){if(!Q.__isWhitespace(v))return null;for(_++;_<p;_++)if(v=n.charCodeAt(_),!Q.__isWhitespace(v))return null}return j.sign=h==-1,j.__trim()}static __fillFromParts(n,a,h){let p=0,_=0,v=0;for(let c=a.length-1;0<=c;c--){const C=a[c],k=h[c];_|=C<<v,v+=k,v===30?(n.__setDigit(p++,_),v=0,_=0):30<v&&(n.__setDigit(p++,1073741823&_),v-=30,_=C>>>k-v)}if(_!==0){if(p>=n.length)throw new Error("implementation bug");n.__setDigit(p++,_)}for(;p<n.length;p++)n.__setDigit(p,0)}static __toStringBasePowerOfTwo(n,a){const h=n.length;let p=a-1;p=(85&p>>>1)+(85&p),p=(51&p>>>2)+(51&p),p=(15&p>>>4)+(15&p);const _=p,v=a-1,c=n.__digit(h-1),C=Q.__clz30(c);let k=0|(30*h-C+_-1)/_;if(n.sign&&k++,268435456<k)throw new Error("string too long");const P=Array(k);let j=k-1,U=0,V=0;for(let me=0;me<h-1;me++){const pe=n.__digit(me),Le=(U|pe<<V)&v;P[j--]=Q.__kConversionChars[Le];const Qe=_-V;for(U=pe>>>Qe,V=30-Qe;V>=_;)P[j--]=Q.__kConversionChars[U&v],U>>>=_,V-=_}const ie=(U|c<<V)&v;for(P[j--]=Q.__kConversionChars[ie],U=c>>>_-V;U!==0;)P[j--]=Q.__kConversionChars[U&v],U>>>=_;if(n.sign&&(P[j--]="-"),j!=-1)throw new Error("implementation bug");return P.join("")}static __toStringGeneric(n,a,h){const p=n.length;if(p===0)return"";if(p===1){let me=n.__unsignedDigit(0).toString(a);return h===!1&&n.sign&&(me="-"+me),me}const _=30*p-Q.__clz30(n.__digit(p-1)),v=Q.__kMaxBitsPerChar[a],c=v-1;let C=_*Q.__kBitsPerCharTableMultiplier;C+=c-1,C=0|C/c;const k=C+1>>1,P=Q.exponentiate(Q.__oneDigit(a,!1),Q.__oneDigit(k,!1));let j,U;const V=P.__unsignedDigit(0);if(P.length===1&&32767>=V){j=new Q(n.length,!1),j.__initializeDigits();let me=0;for(let pe=2*n.length-1;0<=pe;pe--){const Le=me<<15|n.__halfDigit(pe);j.__setHalfDigit(pe,0|Le/V),me=0|Le%V}U=me.toString(a)}else{const me=Q.__absoluteDivLarge(n,P,!0,!0);j=me.quotient;const pe=me.remainder.__trim();U=Q.__toStringGeneric(pe,a,!0)}j.__trim();let ie=Q.__toStringGeneric(j,a,!0);for(;U.length<k;)U="0"+U;return h===!1&&n.sign&&(ie="-"+ie),ie+U}static __unequalSign(n){return n?-1:1}static __absoluteGreater(n){return n?-1:1}static __absoluteLess(n){return n?1:-1}static __compareToBigInt(n,a){const h=n.sign;if(h!==a.sign)return Q.__unequalSign(h);const p=Q.__absoluteCompare(n,a);return 0<p?Q.__absoluteGreater(h):0>p?Q.__absoluteLess(h):0}static __compareToNumber(n,a){if(Q.__isOneDigitInt(a)){const h=n.sign,p=0>a;if(h!==p)return Q.__unequalSign(h);if(n.length===0){if(p)throw new Error("implementation bug");return a===0?0:-1}if(1<n.length)return Q.__absoluteGreater(h);const _=Math.abs(a),v=n.__unsignedDigit(0);return v>_?Q.__absoluteGreater(h):v<_?Q.__absoluteLess(h):0}return Q.__compareToDouble(n,a)}static __compareToDouble(n,a){if(a!==a)return a;if(a===1/0)return-1;if(a===-1/0)return 1;const h=n.sign;if(h!==0>a)return Q.__unequalSign(h);if(a===0)throw new Error("implementation bug: should be handled elsewhere");if(n.length===0)return-1;Q.__kBitConversionDouble[0]=a;const p=2047&Q.__kBitConversionInts[1]>>>20;if(p==2047)throw new Error("implementation bug: handled elsewhere");const _=p-1023;if(0>_)return Q.__absoluteGreater(h);const v=n.length;let c=n.__digit(v-1);const C=Q.__clz30(c),k=30*v-C,P=_+1;if(k<P)return Q.__absoluteLess(h);if(k>P)return Q.__absoluteGreater(h);let j=1048576|1048575&Q.__kBitConversionInts[1],U=Q.__kBitConversionInts[0];const V=20,ie=29-C;if(ie!==(0|(k-1)%30))throw new Error("implementation bug");let me,pe=0;if(20>ie){const Le=V-ie;pe=Le+32,me=j>>>Le,j=j<<32-Le|U>>>Le,U<<=32-Le}else if(ie===20)pe=32,me=j,j=U,U=0;else{const Le=ie-V;pe=32-Le,me=j<<Le|U>>>32-Le,j=U<<Le,U=0}if(c>>>=0,me>>>=0,c>me)return Q.__absoluteGreater(h);if(c<me)return Q.__absoluteLess(h);for(let Le=v-2;0<=Le;Le--){0<pe?(pe-=30,me=j>>>2,j=j<<30|U>>>2,U<<=30):me=0;const Qe=n.__unsignedDigit(Le);if(Qe>me)return Q.__absoluteGreater(h);if(Qe<me)return Q.__absoluteLess(h)}if(j!==0||U!==0){if(pe===0)throw new Error("implementation bug");return Q.__absoluteLess(h)}return 0}static __equalToNumber(n,a){var h=Math.abs;return Q.__isOneDigitInt(a)?a===0?n.length===0:n.length===1&&n.sign===0>a&&n.__unsignedDigit(0)===h(a):Q.__compareToDouble(n,a)===0}static __comparisonResultToBool(n,a){return a===0?0>n:a===1?0>=n:a===2?0<n:a===3?0<=n:void 0}static __compare(n,a,h){if(n=Q.__toPrimitive(n),a=Q.__toPrimitive(a),typeof n=="string"&&typeof a=="string")switch(h){case 0:return n<a;case 1:return n<=a;case 2:return n>a;case 3:return n>=a}if(Q.__isBigInt(n)&&typeof a=="string")return a=Q.__fromString(a),a!==null&&Q.__comparisonResultToBool(Q.__compareToBigInt(n,a),h);if(typeof n=="string"&&Q.__isBigInt(a))return n=Q.__fromString(n),n!==null&&Q.__comparisonResultToBool(Q.__compareToBigInt(n,a),h);if(n=Q.__toNumeric(n),a=Q.__toNumeric(a),Q.__isBigInt(n)){if(Q.__isBigInt(a))return Q.__comparisonResultToBool(Q.__compareToBigInt(n,a),h);if(typeof a!="number")throw new Error("implementation bug");return Q.__comparisonResultToBool(Q.__compareToNumber(n,a),h)}if(typeof n!="number")throw new Error("implementation bug");if(Q.__isBigInt(a))return Q.__comparisonResultToBool(Q.__compareToNumber(a,n),2^h);if(typeof a!="number")throw new Error("implementation bug");return h===0?n<a:h===1?n<=a:h===2?n>a:h===3?n>=a:void 0}__clzmsd(){return Q.__clz30(this.__digit(this.length-1))}static __absoluteAdd(n,a,h){if(n.length<a.length)return Q.__absoluteAdd(a,n,h);if(n.length===0)return n;if(a.length===0)return n.sign===h?n:Q.unaryMinus(n);let p=n.length;(n.__clzmsd()===0||a.length===n.length&&a.__clzmsd()===0)&&p++;const _=new Q(p,h);let v=0,c=0;for(;c<a.length;c++){const C=n.__digit(c)+a.__digit(c)+v;v=C>>>30,_.__setDigit(c,1073741823&C)}for(;c<n.length;c++){const C=n.__digit(c)+v;v=C>>>30,_.__setDigit(c,1073741823&C)}return c<_.length&&_.__setDigit(c,v),_.__trim()}static __absoluteSub(n,a,h){if(n.length===0)return n;if(a.length===0)return n.sign===h?n:Q.unaryMinus(n);const p=new Q(n.length,h);let _=0,v=0;for(;v<a.length;v++){const c=n.__digit(v)-a.__digit(v)-_;_=1&c>>>30,p.__setDigit(v,1073741823&c)}for(;v<n.length;v++){const c=n.__digit(v)-_;_=1&c>>>30,p.__setDigit(v,1073741823&c)}return p.__trim()}static __absoluteAddOne(n,a,h=null){const p=n.length;h===null?h=new Q(p,a):h.sign=a;let _=1;for(let v=0;v<p;v++){const c=n.__digit(v)+_;_=c>>>30,h.__setDigit(v,1073741823&c)}return _!=0&&h.__setDigitGrow(p,1),h}static __absoluteSubOne(n,a){const h=n.length;a=a||h;const p=new Q(a,!1);let _=1;for(let v=0;v<h;v++){const c=n.__digit(v)-_;_=1&c>>>30,p.__setDigit(v,1073741823&c)}if(_!=0)throw new Error("implementation bug");for(let v=h;v<a;v++)p.__setDigit(v,0);return p}static __absoluteAnd(n,a,h=null){let p=n.length,_=a.length,v=_;if(p<_){v=p;const k=n,P=p;n=a,p=_,a=k,_=P}let c=v;h===null?h=new Q(c,!1):c=h.length;let C=0;for(;C<v;C++)h.__setDigit(C,n.__digit(C)&a.__digit(C));for(;C<c;C++)h.__setDigit(C,0);return h}static __absoluteAndNot(n,a,h=null){const p=n.length,_=a.length;let v=_;p<_&&(v=p);let c=p;h===null?h=new Q(c,!1):c=h.length;let C=0;for(;C<v;C++)h.__setDigit(C,n.__digit(C)&~a.__digit(C));for(;C<p;C++)h.__setDigit(C,n.__digit(C));for(;C<c;C++)h.__setDigit(C,0);return h}static __absoluteOr(n,a,h=null){let p=n.length,_=a.length,v=_;if(p<_){v=p;const k=n,P=p;n=a,p=_,a=k,_=P}let c=p;h===null?h=new Q(c,!1):c=h.length;let C=0;for(;C<v;C++)h.__setDigit(C,n.__digit(C)|a.__digit(C));for(;C<p;C++)h.__setDigit(C,n.__digit(C));for(;C<c;C++)h.__setDigit(C,0);return h}static __absoluteXor(n,a,h=null){let p=n.length,_=a.length,v=_;if(p<_){v=p;const k=n,P=p;n=a,p=_,a=k,_=P}let c=p;h===null?h=new Q(c,!1):c=h.length;let C=0;for(;C<v;C++)h.__setDigit(C,n.__digit(C)^a.__digit(C));for(;C<p;C++)h.__setDigit(C,n.__digit(C));for(;C<c;C++)h.__setDigit(C,0);return h}static __absoluteCompare(n,a){const h=n.length-a.length;if(h!=0)return h;let p=n.length-1;for(;0<=p&&n.__digit(p)===a.__digit(p);)p--;return 0>p?0:n.__unsignedDigit(p)>a.__unsignedDigit(p)?1:-1}static __multiplyAccumulate(n,a,h,p){if(a===0)return;const _=32767&a,v=a>>>15;let c=0,C=0;for(let k,P=0;P<n.length;P++,p++){k=h.__digit(p);const j=n.__digit(P),U=32767&j,V=j>>>15,ie=Q.__imul(U,_),me=Q.__imul(U,v),pe=Q.__imul(V,_),Le=Q.__imul(V,v);k+=C+ie+c,c=k>>>30,k&=1073741823,k+=((32767&me)<<15)+((32767&pe)<<15),c+=k>>>30,C=Le+(me>>>15)+(pe>>>15),h.__setDigit(p,1073741823&k)}for(;c!=0||C!==0;p++){let k=h.__digit(p);k+=c+C,C=0,c=k>>>30,h.__setDigit(p,1073741823&k)}}static __internalMultiplyAdd(n,a,h,p,_){let v=h,c=0;for(let C=0;C<p;C++){const k=n.__digit(C),P=Q.__imul(32767&k,a),j=Q.__imul(k>>>15,a),U=P+((32767&j)<<15)+c+v;v=U>>>30,c=j>>>15,_.__setDigit(C,1073741823&U)}if(_.length>p)for(_.__setDigit(p++,v+c);p<_.length;)_.__setDigit(p++,0);else if(v+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(n,a,h){h>this.length&&(h=this.length);const p=32767&n,_=n>>>15;let v=0,c=a;for(let C=0;C<h;C++){const k=this.__digit(C),P=32767&k,j=k>>>15,U=Q.__imul(P,p),V=Q.__imul(P,_),ie=Q.__imul(j,p),me=Q.__imul(j,_);let pe=c+U+v;v=pe>>>30,pe&=1073741823,pe+=((32767&V)<<15)+((32767&ie)<<15),v+=pe>>>30,c=me+(V>>>15)+(ie>>>15),this.__setDigit(C,1073741823&pe)}if(v!=0||c!==0)throw new Error("implementation bug")}static __absoluteDivSmall(n,a,h=null){h===null&&(h=new Q(n.length,!1));let p=0;for(let _,v=2*n.length-1;0<=v;v-=2){_=(p<<15|n.__halfDigit(v))>>>0;const c=0|_/a;p=0|_%a,_=(p<<15|n.__halfDigit(v-1))>>>0;const C=0|_/a;p=0|_%a,h.__setDigit(v>>>1,c<<15|C)}return h}static __absoluteModSmall(n,a){let h=0;for(let p=2*n.length-1;0<=p;p--)h=0|((h<<15|n.__halfDigit(p))>>>0)%a;return h}static __absoluteDivLarge(n,a,h,p){const _=a.__halfDigitLength(),v=a.length,c=n.__halfDigitLength()-_;let C=null;h&&(C=new Q(c+2>>>1,!1),C.__initializeDigits());const k=new Q(_+2>>>1,!1);k.__initializeDigits();const P=Q.__clz15(a.__halfDigit(_-1));0<P&&(a=Q.__specialLeftShift(a,P,0));const j=Q.__specialLeftShift(n,P,1),U=a.__halfDigit(_-1);let V=0;for(let ie,me=c;0<=me;me--){ie=32767;const pe=j.__halfDigit(me+_);if(pe!==U){const Qe=(pe<<15|j.__halfDigit(me+_-1))>>>0;ie=0|Qe/U;let He=0|Qe%U;const $e=a.__halfDigit(_-2),ke=j.__halfDigit(me+_-2);for(;Q.__imul(ie,$e)>>>0>(He<<16|ke)>>>0&&(ie--,He+=U,!(32767<He)););}Q.__internalMultiplyAdd(a,ie,0,v,k);let Le=j.__inplaceSub(k,me,_+1);Le!==0&&(Le=j.__inplaceAdd(a,me,_),j.__setHalfDigit(me+_,32767&j.__halfDigit(me+_)+Le),ie--),h&&(1&me?V=ie<<15:C.__setDigit(me>>>1,V|ie))}if(p)return j.__inplaceRightShift(P),h?{quotient:C,remainder:j}:j;if(h)return C;throw new Error("unreachable")}static __clz15(n){return Q.__clz30(n)-15}__inplaceAdd(n,a,h){let p=0;for(let _=0;_<h;_++){const v=this.__halfDigit(a+_)+n.__halfDigit(_)+p;p=v>>>15,this.__setHalfDigit(a+_,32767&v)}return p}__inplaceSub(n,a,h){let p=0;if(1&a){a>>=1;let _=this.__digit(a),v=32767&_,c=0;for(;c<h-1>>>1;c++){const P=n.__digit(c),j=(_>>>15)-(32767&P)-p;p=1&j>>>15,this.__setDigit(a+c,(32767&j)<<15|32767&v),_=this.__digit(a+c+1),v=(32767&_)-(P>>>15)-p,p=1&v>>>15}const C=n.__digit(c),k=(_>>>15)-(32767&C)-p;if(p=1&k>>>15,this.__setDigit(a+c,(32767&k)<<15|32767&v),a+c+1>=this.length)throw new RangeError("out of bounds");(1&h)==0&&(_=this.__digit(a+c+1),v=(32767&_)-(C>>>15)-p,p=1&v>>>15,this.__setDigit(a+n.length,1073709056&_|32767&v))}else{a>>=1;let _=0;for(;_<n.length-1;_++){const P=this.__digit(a+_),j=n.__digit(_),U=(32767&P)-(32767&j)-p;p=1&U>>>15;const V=(P>>>15)-(j>>>15)-p;p=1&V>>>15,this.__setDigit(a+_,(32767&V)<<15|32767&U)}const v=this.__digit(a+_),c=n.__digit(_),C=(32767&v)-(32767&c)-p;p=1&C>>>15;let k=0;(1&h)==0&&(k=(v>>>15)-(c>>>15)-p,p=1&k>>>15),this.__setDigit(a+_,(32767&k)<<15|32767&C)}return p}__inplaceRightShift(n){if(n===0)return;let a=this.__digit(0)>>>n;const h=this.length-1;for(let p=0;p<h;p++){const _=this.__digit(p+1);this.__setDigit(p,1073741823&_<<30-n|a),a=_>>>n}this.__setDigit(h,a)}static __specialLeftShift(n,a,h){const p=n.length,_=new Q(p+h,!1);if(a===0){for(let c=0;c<p;c++)_.__setDigit(c,n.__digit(c));return 0<h&&_.__setDigit(p,0),_}let v=0;for(let c=0;c<p;c++){const C=n.__digit(c);_.__setDigit(c,1073741823&C<<a|v),v=C>>>30-a}return 0<h&&_.__setDigit(p,v),_}static __leftShiftByAbsolute(n,a){const h=Q.__toShiftAmount(a);if(0>h)throw new RangeError("BigInt too big");const p=0|h/30,_=h%30,v=n.length,c=_!==0&&n.__digit(v-1)>>>30-_!=0,C=v+p+(c?1:0),k=new Q(C,n.sign);if(_===0){let P=0;for(;P<p;P++)k.__setDigit(P,0);for(;P<C;P++)k.__setDigit(P,n.__digit(P-p))}else{let P=0;for(let j=0;j<p;j++)k.__setDigit(j,0);for(let j=0;j<v;j++){const U=n.__digit(j);k.__setDigit(j+p,1073741823&U<<_|P),P=U>>>30-_}if(c)k.__setDigit(v+p,P);else if(P!==0)throw new Error("implementation bug")}return k.__trim()}static __rightShiftByAbsolute(n,a){const h=n.length,p=n.sign,_=Q.__toShiftAmount(a);if(0>_)return Q.__rightShiftByMaximum(p);const v=0|_/30,c=_%30;let C=h-v;if(0>=C)return Q.__rightShiftByMaximum(p);let k=!1;if(p){if((n.__digit(v)&(1<<c)-1)!=0)k=!0;else for(let j=0;j<v;j++)if(n.__digit(j)!==0){k=!0;break}}k&&c===0&&~n.__digit(h-1)==0&&C++;let P=new Q(C,p);if(c===0){P.__setDigit(C-1,0);for(let j=v;j<h;j++)P.__setDigit(j-v,n.__digit(j))}else{let j=n.__digit(v)>>>c;const U=h-v-1;for(let V=0;V<U;V++){const ie=n.__digit(V+v+1);P.__setDigit(V,1073741823&ie<<30-c|j),j=ie>>>c}P.__setDigit(U,j)}return k&&(P=Q.__absoluteAddOne(P,!0,P)),P.__trim()}static __rightShiftByMaximum(n){return n?Q.__oneDigit(1,!0):Q.__zero()}static __toShiftAmount(n){if(1<n.length)return-1;const a=n.__unsignedDigit(0);return a>Q.__kMaxLengthBits?-1:a}static __toPrimitive(n,a="default"){if(typeof n!="object"||n.constructor===Q)return n;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const _=n[Symbol.toPrimitive];if(_){const v=_(a);if(typeof v!="object")return v;throw new TypeError("Cannot convert object to primitive value")}}const h=n.valueOf;if(h){const _=h.call(n);if(typeof _!="object")return _}const p=n.toString;if(p){const _=p.call(n);if(typeof _!="object")return _}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(n){return Q.__isBigInt(n)?n:+n}static __isBigInt(n){return typeof n=="object"&&n!==null&&n.constructor===Q}static __truncateToNBits(n,a){const h=0|(n+29)/30,p=new Q(h,a.sign),_=h-1;for(let c=0;c<_;c++)p.__setDigit(c,a.__digit(c));let v=a.__digit(_);if(n%30!=0){const c=32-n%30;v=v<<c>>>c}return p.__setDigit(_,v),p.__trim()}static __truncateAndSubFromPowerOfTwo(n,a,h){var p=Math.min;const _=0|(n+29)/30,v=new Q(_,h);let c=0;const C=_-1;let k=0;for(const V=p(C,a.length);c<V;c++){const ie=0-a.__digit(c)-k;k=1&ie>>>30,v.__setDigit(c,1073741823&ie)}for(;c<C;c++)v.__setDigit(c,0|1073741823&-k);let P=C<a.length?a.__digit(C):0;const j=n%30;let U;if(j==0)U=0-P-k,U&=1073741823;else{const V=32-j;P=P<<V>>>V;const ie=1<<32-V;U=ie-P-k,U&=ie-1}return v.__setDigit(C,U),v.__trim()}__digit(n){return this[n]}__unsignedDigit(n){return this[n]>>>0}__setDigit(n,a){this[n]=0|a}__setDigitGrow(n,a){this[n]=0|a}__halfDigitLength(){const n=this.length;return 32767>=this.__unsignedDigit(n-1)?2*n-1:2*n}__halfDigit(n){return 32767&this[n>>>1]>>>15*(1&n)}__setHalfDigit(n,a){const h=n>>>1,p=this.__digit(h),_=1&n?32767&p|a<<15:1073709056&p|32767&a;this.__setDigit(h,_)}static __digitPow(n,a){let h=1;for(;0<a;)1&a&&(h*=n),a>>>=1,n*=n;return h}static __isOneDigitInt(n){return(1073741823&n)===n}}Q.__kMaxLength=33554432,Q.__kMaxLengthBits=Q.__kMaxLength<<5,Q.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],Q.__kBitsPerCharTableShift=5,Q.__kBitsPerCharTableMultiplier=1<<Q.__kBitsPerCharTableShift,Q.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Q.__kBitConversionBuffer=new ArrayBuffer(8),Q.__kBitConversionDouble=new Float64Array(Q.__kBitConversionBuffer),Q.__kBitConversionInts=new Int32Array(Q.__kBitConversionBuffer),Q.__clz30=Math.clz32?function(i){return Math.clz32(i)-2}:function(i){return i===0?30:0|29-(0|Math.log(i>>>0)/Math.LN2)},Q.__imul=Math.imul||function(i,n){return 0|i*n};const qo=Q.BigInt(0),i_=Q.BigInt(1),Tb=Q.BigInt(2),dR=Q.BigInt(10),fR=Q.BigInt(24),pR=Q.BigInt(60),mR=Q.BigInt(1e3),w_=Q.BigInt(1e6),Yy=Q.BigInt(1e9),GT=Q.multiply(Q.BigInt(3600),Yy),gR=Q.multiply(pR,Yy),uf=Q.multiply(GT,fR);function Ih(i){return typeof i=="bigint"?Q.BigInt(i.toString(10)):i}function $T(i){return Q.equal(Q.remainder(i,Tb),qo)}function yp(i){return Q.lessThan(i,qo)?Q.unaryMinus(i):i}function G0(i,n){return Q.lessThan(i,n)?-1:Q.greaterThan(i,n)?1:0}function Ly(i,n){return{quotient:Q.divide(i,n),remainder:Q.remainder(i,n)}}var cw,uw;const mn="slot-epochNanoSeconds",gn="slot-iso-date",ir="slot-iso-date-time",wr="slot-time",Dt="slot-calendar",YT="slot-date-brand",qT="slot-year-month-brand",HT="slot-month-day-brand",pi="slot-time-zone",Es="slot-years",Ss="slot-months",ho="slot-weeks",As="slot-days",Ms="slot-hours",Cs="slot-minutes",Ds="slot-seconds",ks="slot-milliseconds",Is="slot-microseconds",fo="slot-nanoseconds",XT="date",WT="ym",QT="md",KT="time",JT="datetime",eE="instant",jp="original",Hm="timezone-canonical",Ix="timezone-original",Ny="calendar-id",tE="locale",Rx="options",nE=new WeakMap,zx=Symbol.for("@@Temporal__GetSlots");(cw=globalThis)[zx]||(cw[zx]=function(i){return nE.get(i)});const pv=globalThis[zx],Lx=Symbol.for("@@Temporal__CreateSlots");(uw=globalThis)[Lx]||(uw[Lx]=function(i){nE.set(i,Object.create(null))});const Kh=globalThis[Lx];function Ps(i,...n){if(!i||typeof i!="object")return!1;const a=pv(i);return!!a&&n.every(h=>h in a)}function ne(i,n){var h;const a=(h=pv(i))==null?void 0:h[n];if(a===void 0)throw new TypeError(`Missing internal slot ${n}`);return a}function Ln(i,n,a){const h=pv(i);if(h===void 0)throw new TypeError("Missing slots for the given container");if(h[n])throw new TypeError(`${n} already has set`);h[n]=a}const Nx={};function Jh(i,n){Object.defineProperty(i.prototype,Symbol.toStringTag,{value:n,writable:!1,enumerable:!1,configurable:!0});const a=Object.getOwnPropertyNames(i);for(let p=0;p<a.length;p++){const _=a[p],v=Object.getOwnPropertyDescriptor(i,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i,_,v))}const h=Object.getOwnPropertyNames(i.prototype);for(let p=0;p<h.length;p++){const _=h[p],v=Object.getOwnPropertyDescriptor(i.prototype,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i.prototype,_,v))}Px(n,i),Px(`${n}.prototype`,i.prototype)}function Px(i,n){const a=`%${i}%`;if(Nx[a]!==void 0)throw new Error(`intrinsic ${i} already exists`);Nx[a]=n}function Oa(i){return Nx[i]}function Wm(i,n){let a=i;if(a===0)return{div:a,mod:a};const h=Math.sign(a);a=Math.abs(a);const p=Math.trunc(1+Math.log10(a));if(n>=p)return{div:0*h,mod:h*a};if(n===0)return{div:h*a,mod:0*h};const _=a.toPrecision(p);return{div:h*Number.parseInt(_.slice(0,p-n),10),mod:h*Number.parseInt(_.slice(p-n),10)}}function ax(i,n,a){let h=i,p=a;if(h===0)return p;const _=Math.sign(h)||Math.sign(p);h=Math.abs(h),p=Math.abs(p);const v=h.toPrecision(Math.trunc(1+Math.log10(h)));if(p===0)return _*Number.parseInt(v+"0".repeat(n),10);const c=v+p.toPrecision(Math.trunc(1+Math.log10(p))).padStart(n,"0");return _*Number.parseInt(c,10)}function mv(i,n){const a=n==="negative";switch(i){case"ceil":return a?"zero":"infinity";case"floor":return a?"infinity":"zero";case"expand":return"infinity";case"trunc":return"zero";case"halfCeil":return a?"half-zero":"half-infinity";case"halfFloor":return a?"half-infinity":"half-zero";case"halfExpand":return"half-infinity";case"halfTrunc":return"half-zero";case"halfEven":return"half-even"}}function gv(i,n,a,h,p){return p==="zero"?i:p==="infinity"?n:a<0?i:a>0?n:p==="half-zero"?i:p==="half-infinity"?n:h?i:n}class jn{constructor(n){this.totalNs=Ih(n),this.sec=Q.toNumber(Q.divide(this.totalNs,Yy)),this.subsec=Q.toNumber(Q.remainder(this.totalNs,Yy))}static validateNew(n,a){if(Q.greaterThan(yp(n),jn.MAX))throw new RangeError(`${a} of duration time units cannot exceed ${jn.MAX} s`);return new jn(n)}static fromEpochNsDiff(n,a){const h=Q.subtract(Ih(n),Ih(a));return new jn(h)}static fromComponents(n,a,h,p,_,v){const c=Q.add(Q.add(Q.add(Q.add(Q.add(Q.BigInt(v),Q.multiply(Q.BigInt(_),mR)),Q.multiply(Q.BigInt(p),w_)),Q.multiply(Q.BigInt(h),Yy)),Q.multiply(Q.BigInt(a),gR)),Q.multiply(Q.BigInt(n),GT));return jn.validateNew(c,"total")}abs(){return new jn(yp(this.totalNs))}add(n){return jn.validateNew(Q.add(this.totalNs,n.totalNs),"sum")}add24HourDays(n){return jn.validateNew(Q.add(this.totalNs,Q.multiply(Q.BigInt(n),uf)),"sum")}addToEpochNs(n){return Q.add(Ih(n),this.totalNs)}cmp(n){return G0(this.totalNs,n.totalNs)}divmod(n){const{quotient:a,remainder:h}=Ly(this.totalNs,Q.BigInt(n));return{quotient:Q.toNumber(a),remainder:new jn(h)}}fdiv(n){const a=Ih(n),h=Q.BigInt(a);let{quotient:p,remainder:_}=Ly(this.totalNs,h);const v=[];let c;const C=(Q.lessThan(this.totalNs,qo)?-1:1)*Math.sign(Q.toNumber(a));for(;!Q.equal(_,qo)&&v.length<50;)_=Q.multiply(_,dR),{quotient:c,remainder:_}=Ly(_,h),v.push(Math.abs(Q.toNumber(c)));return C*+(yp(p).toString()+"."+v.join(""))}isZero(){return Q.equal(this.totalNs,qo)}round(n,a){const h=Ih(n);if(Q.equal(h,i_))return this;const{quotient:p,remainder:_}=Ly(this.totalNs,h),v=Q.lessThan(this.totalNs,qo)?"negative":"positive",c=Q.multiply(yp(p),h),C=Q.add(c,h),k=G0(yp(Q.multiply(_,Tb)),h),P=mv(a,v),j=Q.equal(yp(this.totalNs),c)?c:gv(c,C,k,$T(p),P),U=v==="positive"?j:Q.unaryMinus(j);return jn.validateNew(U,"rounding")}sign(){return this.cmp(new jn(qo))}subtract(n){return jn.validateNew(Q.subtract(this.totalNs,n.totalNs),"difference")}}jn.MAX=Q.BigInt("9007199254740991999999999"),jn.ZERO=new jn(qo);const hw=/[A-Za-z._][A-Za-z._0-9+-]*/,T_=new RegExp(`(?:${/(?:[+-](?:[01][0-9]|2[0-3])(?::?[0-5][0-9])?)/.source}|(?:${hw.source})(?:\\/(?:${hw.source}))*)`),iE=/(?:[+-]\d{6}|\d{4})/,$0=/(?:0[1-9]|1[0-2])/,Ox=/(?:0[1-9]|[12]\d|3[01])/,yR=new RegExp(`(${iE.source})(?:-(${$0.source})-(${Ox.source})|(${$0.source})(${Ox.source}))`),rE=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,aE=/((?:[+-])(?:[01][0-9]|2[0-3])(?::?(?:[0-5][0-9])(?::?(?:[0-5][0-9])(?:[.,](?:\d{1,9}))?)?)?)/,sE=new RegExp(`([zZ])|${aE.source}?`),og=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,_R=new RegExp([`^${yR.source}`,`(?:(?:[tT]|\\s+)${rE.source}(?:${sE.source})?)?`,`(?:\\[!?(${T_.source})\\])?`,`((?:${og.source})*)$`].join("")),vR=new RegExp([`^[tT]?${rE.source}`,`(?:${sE.source})?`,`(?:\\[!?${T_.source}\\])?`,`((?:${og.source})*)$`].join("")),xR=new RegExp(`^(${iE.source})-?(${$0.source})(?:\\[!?${T_.source}\\])?((?:${og.source})*)$`),bR=new RegExp(`^(?:--)?(${$0.source})-?(${Ox.source})(?:\\[!?${T_.source}\\])?((?:${og.source})*)$`),sx=/(\d+)(?:[.,](\d{1,9}))?/,wR=new RegExp(`(?:${sx.source}H)?(?:${sx.source}M)?(?:${sx.source}S)?`),TR=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${wR.source})?$`,"i"),hf=864e5,Y0=1e6*hf,ER=6e10,oE=1e8*hf,lg=Eu(oE),r_=Q.unaryMinus(lg),SR=Q.add(Q.subtract(r_,uf),i_),AR=Q.subtract(Q.add(lg,uf),i_),MR=146097*hf,dw=-271821,fw=275760,qy=Date.UTC(1847,0,1),CR=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","ethiopic-amete-alem","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"],DR=new Set(["ACT","AET","AGT","ART","AST","BET","BST","CAT","CNT","CST","CTT","EAT","ECT","IET","IST","JST","MIT","NET","NST","PLT","PNT","PRT","PST","SST","VST"]);function Tr(i){return typeof i=="object"&&i!==null||typeof i=="function"}function yv(i){if(typeof i=="bigint")throw new TypeError("Cannot convert BigInt to number");return Number(i)}function _v(i){if(typeof i=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return String(i)}function wn(i){const n=yv(i);if(n===0)return 0;if(Number.isNaN(n)||n===1/0||n===-1/0)throw new RangeError("invalid number value");const a=Math.trunc(n);return a===0?0:a}function pw(i,n){const a=wn(i);if(a<=0)throw n!==void 0?new RangeError(`property '${n}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return a}function Lc(i){const n=yv(i);if(Number.isNaN(n))throw new RangeError("not a number");if(n===1/0||n===-1/0)throw new RangeError("infinity is out of range");if(!function(a){if(typeof a!="number"||Number.isNaN(a)||a===1/0||a===-1/0)return!1;const h=Math.abs(a);return Math.floor(h)===h}(n))throw new RangeError(`unsupported fractional value ${i}`);return n===0?0:n}function a_(i,n){return String(i).padStart(n,"0")}function aa(i){if(typeof i!="string")throw new TypeError(`expected a string, not ${String(i)}`);return i}function jx(i,n){if(Tr(i)){const a=i==null?void 0:i.toString();if(typeof a=="string"||typeof a=="number")return a;throw new TypeError("Cannot convert object to primitive value")}return i}const Bx=["era","eraYear","year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],kR={era:_v,eraYear:wn,year:wn,month:pw,monthCode:function(i){const n=aa(jx(i));if(n.length<3||n.length>4||n[0]!=="M"||"0123456789".indexOf(n[1])===-1||"0123456789".indexOf(n[2])===-1||n[1]+n[2]==="00"&&n[3]!=="L"||n[3]!=="L"&&n[3]!==void 0)throw new RangeError(`bad month code ${n}; must match M01-M99 or M00L-M99L`);return n},day:pw,hour:wn,minute:wn,second:wn,millisecond:wn,microsecond:wn,nanosecond:wn,offset:function(i){const n=aa(jx(i));return Tg(n),n},timeZone:Ls},IR={hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},cg=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],mw=Object.fromEntries(cg.map(i=>[i[0],i[1]])),RR=Object.fromEntries(cg.map(([i,n])=>[n,i])),Hy=cg.map(([,i])=>i),ug={day:Y0,hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},q0=["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],zR=Intl.DateTimeFormat,gw=new Map;function lE(i){const n=u_(i);let a=gw.get(n);return a===void 0&&(a=new zR("en-us",{timeZone:n,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),gw.set(n,a)),a}function La(i){return Ps(i,mn)&&!Ps(i,pi,Dt)}function xr(i){return Ps(i,Es,Ss,As,Ms,Cs,Ds,ks,Is,fo)}function br(i){return Ps(i,YT)}function Dr(i){return Ps(i,wr)}function Qi(i){return Ps(i,ir)}function Na(i){return Ps(i,qT)}function Yo(i){return Ps(i,HT)}function On(i){return Ps(i,mn,pi,Dt)}function lt(i,n){if(!n(i))throw new TypeError("invalid receiver: method called with the wrong type of this-object")}function xg(i){if(Ps(i,Dt)||Ps(i,pi))throw new TypeError("with() does not support a calendar or timeZone property");if(Dr(i))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(i.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(i.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function E_(i,n){return n==="never"||n==="auto"&&i==="iso8601"?"":`[${n==="critical"?"!":""}u-ca=${i}]`}function vv(i){let n,a,h=!1;for(og.lastIndex=0;a=og.exec(i);){const{1:p,2:_,3:v}=a;if(_==="u-ca"){if(n===void 0)n=v,h=p==="!";else if(p==="!"||h)throw new RangeError(`Invalid annotations in ${i}: more than one u-ca present with critical flag`)}else if(p==="!")throw new RangeError(`Unrecognized annotation: !${_}=${v}`)}return n}function Ru(i){const n=_R.exec(i);if(!n)throw new RangeError(`invalid RFC 9557 string: ${i}`);const a=vv(n[16]);let h=n[1];if(h==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);const p=+h,_=+(n[2]??n[4]??1),v=+(n[3]??n[5]??1),c=n[6]!==void 0,C=+(n[6]??0),k=+(n[7]??n[10]??0);let P=+(n[8]??n[11]??0);P===60&&(P=59);const j=(n[9]??n[12]??"")+"000000000",U=+j.slice(0,3),V=+j.slice(3,6),ie=+j.slice(6,9);let me,pe=!1;n[13]?(me=void 0,pe=!0):n[14]&&(me=n[14]);const Le=n[15];return Db(p,_,v,C,k,P,U,V,ie),{year:p,month:_,day:v,time:c?{hour:C,minute:k,second:P,millisecond:U,microsecond:V,nanosecond:ie}:"start-of-day",tzAnnotation:Le,offset:me,z:pe,calendar:a}}function cE(i){const n=vR.exec(i);let a,h,p,_,v,c,C;if(n){C=vv(n[10]),a=+(n[1]??0),h=+(n[2]??n[5]??0),p=+(n[3]??n[6]??0),p===60&&(p=59);const k=(n[4]??n[7]??"")+"000000000";if(_=+k.slice(0,3),v=+k.slice(3,6),c=+k.slice(6,9),n[8])throw new RangeError("Z designator not supported for PlainTime")}else{let k,P;if({time:k,z:P,calendar:C}=Ru(i),k==="start-of-day")throw new RangeError(`time is missing in string: ${i}`);if(P)throw new RangeError("Z designator not supported for PlainTime");({hour:a,minute:h,second:p,millisecond:_,microsecond:v,nanosecond:c}=k)}if(Tv(a,h,p,_,v,c),/[tT ][0-9][0-9]/.test(i))return{hour:a,minute:h,second:p,millisecond:_,microsecond:v,nanosecond:c,calendar:C};try{const{month:k,day:P}=Sb(i);Dp(1972,k,P)}catch{try{const{year:k,month:P}=Eb(i);Dp(k,P,1)}catch{return{hour:a,minute:h,second:p,millisecond:_,microsecond:v,nanosecond:c,calendar:C}}}throw new RangeError(`invalid RFC 9557 time-only string ${i}; may need a T prefix`)}function Eb(i){const n=xR.exec(i);let a,h,p,_;if(n){p=vv(n[3]);let v=n[1];if(v==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);if(a=+v,h=+n[2],_=1,p!==void 0&&p!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let v;if({year:a,month:h,calendar:p,day:_,z:v}=Ru(i),v)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:a,month:h,calendar:p,referenceISODay:_}}function Sb(i){const n=bR.exec(i);let a,h,p,_;if(n){if(p=vv(n[3]),a=+n[1],h=+n[2],p!==void 0&&p!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let v;if({month:a,day:h,calendar:p,year:_,z:v}=Ru(i),v)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:a,day:h,calendar:p,referenceISOYear:_}}const uE=new RegExp(`^${T_.source}$`,"i"),hE=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])?)?/.source}$`);function dE(i){const n=NR.test(i)?"Seconds not allowed in offset time zone":"Invalid time zone";throw new RangeError(`${n}: ${i}`)}function of(i){return uE.test(i)||dE(i),hE.test(i)?{offsetMinutes:Tg(i)/6e10}:{tzName:i}}function Xy(i,n,a,h){let p=i,_=n,v=a;switch(h){case"reject":Dp(p,_,v);break;case"constrain":({year:p,month:_,day:v}=DE(p,_,v))}return{year:p,month:_,day:v}}function xv(i,n,a,h,p,_,v){let c=i,C=n,k=a,P=h,j=p,U=_;switch(v){case"reject":Tv(c,C,k,P,j,U);break;case"constrain":c=Rs(c,0,23),C=Rs(C,0,59),k=Rs(k,0,59),P=Rs(P,0,999),j=Rs(j,0,999),U=Rs(U,0,999)}return{hour:c,minute:C,second:k,millisecond:P,microsecond:j,nanosecond:U}}function fE(i){if(!Tr(i))throw new TypeError("invalid duration-like");const n={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let a=!1;for(let h=0;h<q0.length;h++){const p=q0[h],_=i[p];_!==void 0&&(a=!0,n[p]=Lc(_))}if(!a)throw new TypeError("invalid duration-like");return n}function ts({years:i,months:n,weeks:a,days:h},p,_,v){return{years:i,months:v??n,weeks:_??a,days:p??h}}function ti(i,n){return{isoDate:i,time:n}}function Kn(i){return Gh(i,"overflow",["constrain","reject"],"constrain")}function Wy(i){return Gh(i,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function jc(i,n){return Gh(i,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],n)}function N0(i,n){return Gh(i,"offset",["prefer","use","ignore","reject"],n)}function S_(i){return Gh(i,"calendarName",["auto","always","never","critical"],"auto")}function bg(i){let n=i.roundingIncrement;if(n===void 0)return 1;const a=wn(n);if(a<1||a>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${n}`);return a}function wg(i,n,a){const h=a?n:n-1;if(i>h)throw new RangeError(`roundingIncrement must be at least 1 and less than ${h}, not ${i}`);if(n%i!=0)throw new RangeError(`Rounding increment must divide evenly into ${n}`)}function A_(i){const n=i.fractionalSecondDigits;if(n===void 0)return"auto";if(typeof n!="number"){if(_v(n)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return"auto"}const a=Math.floor(n);if(!Number.isFinite(a)||a<0||a>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return a}function M_(i,n){switch(i){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(n){case"auto":return{precision:n,unit:"nanosecond",increment:1};case 0:return{precision:n,unit:"second",increment:1};case 1:case 2:case 3:return{precision:n,unit:"millisecond",increment:10**(3-n)};case 4:case 5:case 6:return{precision:n,unit:"microsecond",increment:10**(6-n)};case 7:case 8:case 9:return{precision:n,unit:"nanosecond",increment:10**(9-n)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`)}}const Xh=Symbol("~required~");function mo(i,n,a,h,p=[]){let _=[];for(let k=0;k<cg.length;k++){const P=cg[k],j=P[1],U=P[2];a!=="datetime"&&a!==U||_.push(j)}_=_.concat(p);let v=h;v===Xh?v=void 0:v!==void 0&&_.push(v);let c=[];c=c.concat(_);for(let k=0;k<_.length;k++){const P=_[k],j=RR[P];j!==void 0&&c.push(j)}let C=Gh(i,n,c,v);if(C===void 0&&h===Xh)throw new RangeError(`${n} is required`);return C&&C in mw?mw[C]:C}function ox(i){const n=i.relativeTo;if(n===void 0)return{};let a,h,p,_,v,c="option",C=!1;if(Tr(n)){if(On(n))return{zonedRelativeTo:n};if(br(n))return{plainRelativeTo:n};if(Qi(n))return{plainRelativeTo:zs(ne(n,ir).isoDate,ne(n,Dt))};p=R_(n);const k=Jo(p,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],[]);({isoDate:a,time:h}=D_(p,k,"constrain")),{offset:v,timeZone:_}=k,v===void 0&&(c="wall")}else{let k,P,j,U,V;if({year:j,month:U,day:V,time:h,calendar:p,tzAnnotation:k,offset:v,z:P}=Ru(aa(n)),k)_=Ls(k),P?c="exact":v||(c="wall"),C=!0;else if(P)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");p||(p="iso8601"),p=Os(p),a={year:j,month:U,day:V}}return _===void 0?{plainRelativeTo:zs(a,p)}:{zonedRelativeTo:es(H0(a,h,c,c==="option"?Tg(v):0,_,"compatible","reject",C),_,p)}}function zh(i){return ne(i,Es)!==0?"year":ne(i,Ss)!==0?"month":ne(i,ho)!==0?"week":ne(i,As)!==0?"day":ne(i,Ms)!==0?"hour":ne(i,Cs)!==0?"minute":ne(i,Ds)!==0?"second":ne(i,ks)!==0?"millisecond":ne(i,Is)!==0?"microsecond":"nanosecond"}function Vh(i,n){return Hy.indexOf(i)>Hy.indexOf(n)?n:i}function yu(i){return i==="year"||i==="month"||i==="week"}function Lh(i){return yu(i)||i==="day"?"date":"time"}function gf(i){return Oa("%calendarImpl%")(i)}function C_(i){return Oa("%calendarImpl%")(ne(i,Dt))}function Ns(i,n,a="date"){const h=Object.create(null),p=gf(i).isoToDate(n,{year:!0,monthCode:!0,day:!0});return h.monthCode=p.monthCode,a!=="month-day"&&a!=="date"||(h.day=p.day),a!=="year-month"&&a!=="date"||(h.year=p.year),h}function Jo(i,n,a,h,p){const _=gf(i).extraFields(a),v=a.concat(h,_),c=Object.create(null);let C=!1;v.sort();for(let k=0;k<v.length;k++){const P=v[k],j=n[P];if(j!==void 0)C=!0,c[P]=(0,kR[P])(j);else if(p!=="partial"){if(p.includes(P))throw new TypeError(`required property '${P}' missing or undefined`);c[P]=IR[P]}}if(p==="partial"&&!C)throw new TypeError("no supported properties found");return c}function Fx(i,n="complete"){const a=["hour","microsecond","millisecond","minute","nanosecond","second"];let h=!1;const p=Object.create(null);for(let _=0;_<a.length;_++){const v=a[_],c=i[v];c!==void 0?(p[v]=wn(c),h=!0):n==="complete"&&(p[v]=0)}if(!h)throw new TypeError("invalid time-like");return p}function Py(i,n){if(Tr(i)){if(br(i))return Kn(rn(n)),zs(ne(i,gn),ne(i,Dt));if(On(i)){const C=Bl(ne(i,pi),ne(i,mn));return Kn(rn(n)),zs(C.isoDate,ne(i,Dt))}if(Qi(i))return Kn(rn(n)),zs(ne(i,ir).isoDate,ne(i,Dt));const c=R_(i);return zs(df(c,Jo(c,i,["year","month","monthCode","day"],[],[]),Kn(rn(n))),c)}let{year:a,month:h,day:p,calendar:_,z:v}=Ru(aa(i));if(v)throw new RangeError("Z designator not supported for PlainDate");return _||(_="iso8601"),_=Os(_),Kn(rn(n)),zs({year:a,month:h,day:p},_)}function D_(i,n,a){return ti(df(i,n,a),xv(n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond,a))}function Oy(i,n){let a,h,p;if(Tr(i)){if(Qi(i))return Kn(rn(n)),zl(ne(i,ir),ne(i,Dt));if(On(i)){const c=Bl(ne(i,pi),ne(i,mn));return Kn(rn(n)),zl(c,ne(i,Dt))}if(br(i))return Kn(rn(n)),zl(ti(ne(i,gn),{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),ne(i,Dt));p=R_(i);const _=Jo(p,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],[]),v=Kn(rn(n));({isoDate:a,time:h}=D_(p,_,v))}else{let _,v,c,C;if({year:v,month:c,day:C,time:h,calendar:p,z:_}=Ru(aa(i)),_)throw new RangeError("Z designator not supported for PlainDateTime");h==="start-of-day"&&(h={deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),Db(v,c,C,h.hour,h.minute,h.second,h.millisecond,h.microsecond,h.nanosecond),p||(p="iso8601"),p=Os(p),Kn(rn(n)),a={year:v,month:c,day:C}}return zl(ti(a,h),p)}function Pl(i){const n=Oa("%Temporal.Duration%");if(xr(i))return new n(ne(i,Es),ne(i,Ss),ne(i,ho),ne(i,As),ne(i,Ms),ne(i,Cs),ne(i,Ds),ne(i,ks),ne(i,Is),ne(i,fo));if(!Tr(i))return function(p){const{years:_,months:v,weeks:c,days:C,hours:k,minutes:P,seconds:j,milliseconds:U,microseconds:V,nanoseconds:ie}=function(me){const pe=TR.exec(me);if(!pe)throw new RangeError(`invalid duration: ${me}`);if(pe.every((mt,Qt)=>Qt<2||mt===void 0))throw new RangeError(`invalid duration: ${me}`);const Le=pe[1]==="-"?-1:1,Qe=pe[2]===void 0?0:wn(pe[2])*Le,He=pe[3]===void 0?0:wn(pe[3])*Le,$e=pe[4]===void 0?0:wn(pe[4])*Le,ke=pe[5]===void 0?0:wn(pe[5])*Le,Ze=pe[6]===void 0?0:wn(pe[6])*Le,nt=pe[7],Ke=pe[8],Re=pe[9],_t=pe[10],It=pe[11];let Ot=0,Vt=0,Wt=0;if(nt!==void 0){if(Ke??Re??_t??It)throw new RangeError("only the smallest unit can be fractional");Wt=3600*wn((nt+"000000000").slice(0,9))*Le}else if(Ot=Ke===void 0?0:wn(Ke)*Le,Re!==void 0){if(_t??It)throw new RangeError("only the smallest unit can be fractional");Wt=60*wn((Re+"000000000").slice(0,9))*Le}else Vt=_t===void 0?0:wn(_t)*Le,It!==void 0&&(Wt=wn((It+"000000000").slice(0,9))*Le);const dn=Wt%1e3,Oe=Math.trunc(Wt/1e3)%1e3,vt=Math.trunc(Wt/1e6)%1e3;return Vt+=Math.trunc(Wt/1e9)%60,Ot+=Math.trunc(Wt/6e10),Ev(Qe,He,$e,ke,Ze,Ot,Vt,vt,Oe,dn),{years:Qe,months:He,weeks:$e,days:ke,hours:Ze,minutes:Ot,seconds:Vt,milliseconds:vt,microseconds:Oe,nanoseconds:dn}}(p);return new(Oa("%Temporal.Duration%"))(_,v,c,C,k,P,j,U,V,ie)}(aa(i));const a={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let h=fE(i);for(let p=0;p<q0.length;p++){const _=q0[p],v=h[_];v!==void 0&&(a[_]=v)}return new n(a.years,a.months,a.weeks,a.days,a.hours,a.minutes,a.seconds,a.milliseconds,a.microseconds,a.nanoseconds)}function jy(i){let n;if(Tr(i)){if(La(i)||On(i))return wu(ne(i,mn));n=jx(i)}else n=i;const{year:a,month:h,day:p,time:_,offset:v,z:c}=function(me){const pe=Ru(me);if(!pe.z&&!pe.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return pe}(aa(n)),{hour:C=0,minute:k=0,second:P=0,millisecond:j=0,microsecond:U=0,nanosecond:V=0}=_==="start-of-day"?{}:_,ie=c_(a,h,p,C,k,P,j,U,V-(c?0:Tg(v)));return tg(ie.isoDate),wu(Pa(ie))}function yw(i,n){if(Tr(i)){if(Yo(i))return Kn(rn(n)),Qm(ne(i,gn),ne(i,Dt));let c;return Ps(i,Dt)?c=ne(i,Dt):(c=i.calendar,c===void 0&&(c="iso8601"),c=I_(c)),Qm(X0(c,Jo(c,i,["year","month","monthCode","day"],[],[]),Kn(rn(n))),c)}let{month:a,day:h,referenceISOYear:p,calendar:_}=Sb(aa(i));if(_===void 0&&(_="iso8601"),_=Os(_),Kn(rn(n)),_==="iso8601")return Qm({year:1972,month:a,day:h},_);let v={year:p,month:a,day:h};return Bp(v),v=X0(_,Ns(_,v,"month-day"),"constrain"),Qm(v,_)}function rf(i,n){let a;if(Tr(i)){if(Dr(i))return Kn(rn(n)),Ph(ne(i,wr));if(Qi(i))return Kn(rn(n)),Ph(ne(i,ir).time);if(On(i)){const k=Bl(ne(i,pi),ne(i,mn));return Kn(rn(n)),Ph(k.time)}const{hour:h,minute:p,second:_,millisecond:v,microsecond:c,nanosecond:C}=Fx(i);a=xv(h,p,_,v,c,C,Kn(rn(n)))}else a=cE(aa(i)),Kn(rn(n));return Ph(a)}function pE(i){return i===void 0?{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}:ne(rf(i),wr)}function By(i,n){if(Tr(i)){if(Na(i))return Kn(rn(n)),eg(ne(i,gn),ne(i,Dt));const c=R_(i);return eg(s_(c,Jo(c,i,["year","month","monthCode"],[],[]),Kn(rn(n))),c)}let{year:a,month:h,referenceISODay:p,calendar:_}=Eb(aa(i));_===void 0&&(_="iso8601"),_=Os(_),Kn(rn(n));let v={year:a,month:h,day:p};return kb(v),v=s_(_,Ns(_,v,"year-month"),"constrain"),eg(v,_)}function H0(i,n,a,h,p,_,v,c){if(n==="start-of-day")return tf(p,i);const C=ti(i,n);if(a==="wall"||v==="ignore")return ns(p,C,_);if(a==="exact"||v==="use"){const j=c_(i.year,i.month,i.day,n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond-h);tg(j.isoDate);const U=Pa(j);return Du(U),U}tg(i);const k=Pa(C),P=o_(p,C);for(let j=0;j<P.length;j++){const U=P[j],V=Q.toNumber(Q.subtract(k,U)),ie=af(V,6e10,"halfExpand");if(V===h||c&&ie===h)return U}if(v==="reject"){const j=Ux(h),U=l_(C,"iso8601","auto");throw new RangeError(`Offset ${j} is invalid for ${U} in ${p}`)}return TE(P,p,C,_)}function Fy(i,n){let a,h,p,_,v,c,C,k=!1,P="option";if(Tr(i)){if(On(i)){const me=rn(n);return Wy(me),N0(me,"reject"),Kn(me),es(ne(i,mn),ne(i,pi),ne(i,Dt))}v=R_(i);const U=Jo(v,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],["timeZone"]);({offset:_,timeZone:p}=U),_===void 0&&(P="wall");const V=rn(n);c=Wy(V),C=N0(V,"reject");const ie=Kn(V);({isoDate:a,time:h}=D_(v,U,ie))}else{let U,V,ie,me,pe;({year:ie,month:me,day:pe,time:h,tzAnnotation:U,offset:_,z:V,calendar:v}=function(Qe){const He=Ru(Qe);if(!He.tzAnnotation)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return He}(aa(i))),p=Ls(U),V?P="exact":_||(P="wall"),v||(v="iso8601"),v=Os(v),k=!0;const Le=rn(n);c=Wy(Le),C=N0(Le,"reject"),Kn(Le),a={year:ie,month:me,day:pe}}let j=0;return P==="option"&&(j=Tg(_)),es(H0(a,h,P,j,p,c,C,k),p,v)}function mE(i,n,a){Bp(n),Kh(i),Ln(i,gn,n),Ln(i,Dt,a),Ln(i,YT,!0)}function zs(i,n){const a=Oa("%Temporal.PlainDate%"),h=Object.create(a.prototype);return mE(h,i,n),h}function gE(i,n,a){kp(n),Kh(i),Ln(i,ir,n),Ln(i,Dt,a)}function zl(i,n){const a=Oa("%Temporal.PlainDateTime%"),h=Object.create(a.prototype);return gE(h,i,n),h}function yE(i,n,a){Bp(n),Kh(i),Ln(i,gn,n),Ln(i,Dt,a),Ln(i,HT,!0)}function Qm(i,n){const a=Oa("%Temporal.PlainMonthDay%"),h=Object.create(a.prototype);return yE(h,i,n),h}function _E(i,n){Kh(i),Ln(i,wr,n)}function Ph(i){const n=Oa("%Temporal.PlainTime%"),a=Object.create(n.prototype);return _E(a,i),a}function vE(i,n,a){kb(n),Kh(i),Ln(i,gn,n),Ln(i,Dt,a),Ln(i,qT,!0)}function eg(i,n){const a=Oa("%Temporal.PlainYearMonth%"),h=Object.create(a.prototype);return vE(h,i,n),h}function xE(i,n){Du(n),Kh(i),Ln(i,mn,n)}function wu(i){const n=Oa("%Temporal.Instant%"),a=Object.create(n.prototype);return xE(a,i),a}function bE(i,n,a,h){Du(n),Kh(i),Ln(i,mn,n),Ln(i,pi,a),Ln(i,Dt,h)}function es(i,n,a="iso8601"){const h=Oa("%Temporal.ZonedDateTime%"),p=Object.create(h.prototype);return bE(p,i,n,a),p}function _w(i){return Bx.filter(n=>i[n]!==void 0)}function Cp(i,n,a){const h=_w(a),p=gf(i).fieldKeysToIgnore(h),_=Object.create(null),v=_w(n);for(let c=0;c<Bx.length;c++){let C;const k=Bx[c];v.includes(k)&&!p.includes(k)&&(C=n[k]),h.includes(k)&&(C=a[k]),C!==void 0&&(_[k]=C)}return _}function Xo(i,n,a,h){const p=gf(i).dateAdd(n,a,h);return Bp(p),p}function k_(i,n,a,h){return gf(i).dateUntil(n,a,h)}function I_(i){if(Tr(i)&&Ps(i,Dt))return ne(i,Dt);const n=aa(i);try{return Os(n)}catch{}let a;try{({calendar:a}=Ru(n))}catch{try{({calendar:a}=cE(n))}catch{try{({calendar:a}=Eb(n))}catch{({calendar:a}=Sb(n))}}}return a||(a="iso8601"),Os(a)}function R_(i){if(Ps(i,Dt))return ne(i,Dt);const{calendar:n}=i;return n===void 0?"iso8601":I_(n)}function Cu(i,n){return Os(i)===Os(n)}function df(i,n,a){const h=gf(i);h.resolveFields(n,"date");const p=h.dateToISO(n,a);return Bp(p),p}function s_(i,n,a){const h=gf(i);h.resolveFields(n,"year-month"),n.day=1;const p=h.dateToISO(n,a);return kb(p),p}function X0(i,n,a){const h=gf(i);h.resolveFields(n,"month-day");const p=h.monthDayToISOReferenceDate(n,a);return Bp(p),p}function Ls(i){if(Tr(i)&&On(i))return ne(i,pi);const n=aa(i);if(n==="UTC")return"UTC";const{tzName:a,offsetMinutes:h}=function(_){const{tzAnnotation:v,offset:c,z:C}=function(k){if(uE.test(k))return{tzAnnotation:k,offset:void 0,z:!1};try{const{tzAnnotation:P,offset:j,z:U}=Ru(k);if(U||P||j)return{tzAnnotation:P,offset:j,z:U}}catch{}dE(k)}(_);return v?of(v):C?of("UTC"):c?of(c):void 0}(n);if(h!==void 0)return Ab(h);const p=W0(a);if(!p)throw new RangeError(`Unrecognized time zone ${a}`);return p.identifier}function wE(i,n){if(i===n)return!0;const a=of(i).offsetMinutes,h=of(n).offsetMinutes;if(a===void 0&&h===void 0){const p=W0(n);if(!p)return!1;const _=W0(i);return!!_&&_.primaryIdentifier===p.primaryIdentifier}return a===h}function Oh(i,n){const a=of(i).offsetMinutes;return a!==void 0?6e10*a:Vx(i,n)}function Ux(i){const n=i<0?"-":"+",a=Math.abs(i),h=Math.floor(a/36e11),p=Math.floor(a/6e10)%60,_=Math.floor(a/1e9)%60,v=a%1e9;return`${n}${bv(h,p,_,v,_===0&&v===0?"minute":"auto")}`}function Bl(i,n){const a=Oh(i,n);let{isoDate:{year:h,month:p,day:_},time:{hour:v,minute:c,second:C,millisecond:k,microsecond:P,nanosecond:j}}=AE(n);return c_(h,p,_,v,c,C,k,P,j+a)}function ns(i,n,a){return TE(o_(i,n),i,n,a)}function TE(i,n,a,h){const p=i.length;if(p===1)return i[0];if(p)switch(h){case"compatible":case"earlier":return i[0];case"later":return i[p-1];case"reject":throw new RangeError("multiple instants found")}if(h==="reject")throw new RangeError("multiple instants found");const _=Pa(a),v=Q.subtract(_,uf);Du(v);const c=Oh(n,v),C=Q.add(_,uf);Du(C);const k=Oh(n,C)-c;switch(h){case"earlier":{const P=jn.fromComponents(0,0,0,0,0,-k),j=hg(a.time,P);return o_(n,ti(_o(a.isoDate.year,a.isoDate.month,a.isoDate.day+j.deltaDays),j))[0]}case"compatible":case"later":{const P=jn.fromComponents(0,0,0,0,0,k),j=hg(a.time,P),U=o_(n,ti(_o(a.isoDate.year,a.isoDate.month,a.isoDate.day+j.deltaDays),j));return U[U.length-1]}}}function o_(i,n){if(i==="UTC")return tg(n.isoDate),[Pa(n)];const a=of(i).offsetMinutes;if(a!==void 0){const h=c_(n.isoDate.year,n.isoDate.month,n.isoDate.day,n.time.hour,n.time.minute-a,n.time.second,n.time.millisecond,n.time.microsecond,n.time.nanosecond);tg(h.isoDate);const p=Pa(h);return Du(p),[p]}return tg(n.isoDate),function(h,p){let _=Pa(p),v=Q.subtract(_,uf);Q.lessThan(v,r_)&&(v=_);let c=Q.add(_,uf);Q.greaterThan(c,lg)&&(c=_);const C=Vx(h,v),k=Vx(h,c);return(C===k?[C]:[C,k]).map(j=>{const U=Q.subtract(_,Q.BigInt(j)),V=function(ie,me){const{epochMilliseconds:pe,time:{millisecond:Le,microsecond:Qe,nanosecond:He}}=AE(me),{year:$e,month:ke,day:Ze,hour:nt,minute:Ke,second:Re}=ME(ie,pe);return c_($e,ke,Ze,nt,Ke,Re,Le,Qe,He)}(h,U);if(dg(p,V)===0)return Du(U),U}).filter(j=>j!==void 0)}(i,n)}function tf(i,n){const a=ti(n,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),h=o_(i,a);if(h.length)return h[0];const p=Pa(a),_=Q.subtract(p,uf);return Du(_),Cb(i,_)}function z_(i){let n;return n=i<0||i>9999?(i<0?"-":"+")+a_(Math.abs(i),6):a_(i,4),n}function Wo(i){return a_(i,2)}function EE(i,n){let a;if(n==="auto"){if(i===0)return"";a=a_(i,9).replace(/0+$/,"")}else{if(n===0)return"";a=a_(i,9).slice(0,n)}return`.${a}`}function bv(i,n,a,h,p){let _=`${Wo(i)}:${Wo(n)}`;return p==="minute"||(_+=`:${Wo(a)}`,_+=EE(h,p)),_}function vw(i,n,a){let h=n;h===void 0&&(h="UTC");const p=ne(i,mn),_=l_(Bl(h,p),"iso8601",a,"never");let v="Z";return n!==void 0&&(v=SE(Oh(h,p))),`${_}${v}`}function D0(i,n){const a=ne(i,Es),h=ne(i,Ss),p=ne(i,ho),_=ne(i,As),v=ne(i,Ms),c=ne(i,Cs),C=K0(i);let k="";a!==0&&(k+=`${Math.abs(a)}Y`),h!==0&&(k+=`${Math.abs(h)}M`),p!==0&&(k+=`${Math.abs(p)}W`),_!==0&&(k+=`${Math.abs(_)}D`);let P="";v!==0&&(P+=`${Math.abs(v)}H`),c!==0&&(P+=`${Math.abs(c)}M`);const j=jn.fromComponents(0,0,ne(i,Ds),ne(i,ks),ne(i,Is),ne(i,fo));j.isZero()&&!["second","millisecond","microsecond","nanosecond"].includes(zh(i))&&n==="auto"||(P+=`${Math.abs(j.sec)}${EE(Math.abs(j.subsec),n)}S`);let U=`${C<0?"-":""}P${k}`;return P&&(U=`${U}T${P}`),U}function xw(i,n="auto"){const{year:a,month:h,day:p}=ne(i,gn);return`${z_(a)}-${Wo(h)}-${Wo(p)}${E_(ne(i,Dt),n)}`}function bw({hour:i,minute:n,second:a,millisecond:h,microsecond:p,nanosecond:_},v){return bv(i,n,a,1e6*h+1e3*p+_,v)}function l_(i,n,a,h="auto"){const{isoDate:{year:p,month:_,day:v},time:{hour:c,minute:C,second:k,millisecond:P,microsecond:j,nanosecond:U}}=i;return`${z_(p)}-${Wo(_)}-${Wo(v)}T${bv(c,C,k,1e6*P+1e3*j+U,a)}${E_(n,h)}`}function ww(i,n="auto"){const{year:a,month:h,day:p}=ne(i,gn);let _=`${Wo(h)}-${Wo(p)}`;const v=ne(i,Dt);n!=="always"&&n!=="critical"&&v==="iso8601"||(_=`${z_(a)}-${_}`);const c=E_(v,n);return c&&(_+=c),_}function Tw(i,n="auto"){const{year:a,month:h,day:p}=ne(i,gn);let _=`${z_(a)}-${Wo(h)}`;const v=ne(i,Dt);n!=="always"&&n!=="critical"&&v==="iso8601"||(_+=`-${Wo(p)}`);const c=E_(v,n);return c&&(_+=c),_}function Ew(i,n,a="auto",h="auto",p="auto",_=void 0){let v=ne(i,mn);if(_){const{unit:P,increment:j,roundingMode:U}=_;v=Yx(v,j,P,U)}const c=ne(i,pi),C=Oh(c,v);let k=l_(Bl(c,v),"iso8601",n,"never");return p!=="never"&&(k+=SE(C)),h!=="never"&&(k+=`[${h==="critical"?"!":""}${c}]`),k+=E_(ne(i,Dt),a),k}function Sw(i){return hE.test(i)}function Tg(i){const n=PR.exec(i);if(!n)throw new RangeError(`invalid time zone offset: ${i}; must match HH:MM[:SS.SSSSSSSSS]`);return(n[1]==="-"?-1:1)*(1e9*(60*(60*+n[2]+ +(n[3]||0))+ +(n[4]||0))+ +((n[5]||0)+"000000000").slice(0,9))}let gp;const LR=Object.assign(Object.create(null),{"/":!0,"-":!0,_:!0});function W0(i){var _;if(gp===void 0){const v=(_=Intl.supportedValuesOf)==null?void 0:_.call(Intl,"timeZone");if(v){gp=new Map;for(let c=0;c<v.length;c++){const C=v[c];gp.set(u_(C),C)}}else gp=null}const n=u_(i);let a=gp==null?void 0:gp.get(n);if(a)return{identifier:a,primaryIdentifier:a};try{a=lE(i).resolvedOptions().timeZone}catch{return}if(n==="antarctica/south_pole"&&(a="Antarctica/McMurdo"),DR.has(i))throw new RangeError(`${i} is a legacy time zone identifier from ICU. Use ${a} instead`);const h=[...n].map((v,c)=>c===0||LR[n[c-1]]?v.toUpperCase():v).join("").split("/");if(h.length===1)return n==="gb-eire"?{identifier:"GB-Eire",primaryIdentifier:a}:{identifier:n.length<=3||/[-0-9]/.test(n)?n.toUpperCase():h[0],primaryIdentifier:a};if(h[0]==="Etc")return{identifier:`Etc/${["Zulu","Greenwich","Universal"].includes(h[1])?h[1]:h[1].toUpperCase()}`,primaryIdentifier:a};if(h[0]==="Us")return{identifier:`US/${h[1]}`,primaryIdentifier:a};const p=new Map([["Act","ACT"],["Lhi","LHI"],["Nsw","NSW"],["Dar_Es_Salaam","Dar_es_Salaam"],["Port_Of_Spain","Port_of_Spain"],["Port-Au-Prince","Port-au-Prince"],["Isle_Of_Man","Isle_of_Man"],["Comodrivadavia","ComodRivadavia"],["Knox_In","Knox_IN"],["Dumontdurville","DumontDUrville"],["Mcmurdo","McMurdo"],["Denoronha","DeNoronha"],["Easterisland","EasterIsland"],["Bajanorte","BajaNorte"],["Bajasur","BajaSur"]]);return h[1]=p.get(h[1])??h[1],h.length>2&&(h[2]=p.get(h[2])??h[2]),{identifier:h.join("/"),primaryIdentifier:a}}function wp(i,n){const{year:a,month:h,day:p,hour:_,minute:v,second:c}=ME(i,n);let C=n%1e3;return C<0&&(C+=1e3),1e6*(Mb({isoDate:{year:a,month:h,day:p},time:{hour:_,minute:v,second:c,millisecond:C}})-n)}function Vx(i,n){return wp(i,Fl(n,"floor"))}function Ab(i){const n=i<0?"-":"+",a=Math.abs(i);return`${n}${bv(Math.floor(a/60),a%60,0,0,"minute")}`}function SE(i){return Ab(af(i,ER,"halfExpand")/6e10)}function Mb({isoDate:{year:i,month:n,day:a},time:{hour:h,minute:p,second:_,millisecond:v}}){const c=i%400,C=(i-c)/400,k=new Date;return k.setUTCHours(h,p,_,v),k.setUTCFullYear(c,n-1,a),k.getTime()+MR*C}function Pa(i){const n=Mb(i),a=1e3*i.time.microsecond+i.time.nanosecond;return Q.add(Eu(n),Q.BigInt(a))}function AE(i){let n=Fl(i,"trunc"),a=Q.toNumber(Q.remainder(i,w_));a<0&&(a+=1e6,n-=1);const h=Math.floor(a/1e3)%1e3,p=a%1e3,_=new Date(n);return{epochMilliseconds:n,isoDate:{year:_.getUTCFullYear(),month:_.getUTCMonth()+1,day:_.getUTCDate()},time:{hour:_.getUTCHours(),minute:_.getUTCMinutes(),second:_.getUTCSeconds(),millisecond:_.getUTCMilliseconds(),microsecond:h,nanosecond:p}}}function Cb(i,n){if(i==="UTC")return null;const a=Fl(n,"floor");if(a<qy)return Cb(i,Eu(qy));const h=Date.now(),p=Math.max(a,h)+366*hf*3;let _=a,v=wp(i,_),c=_,C=v;for(;v===C&&_<p;){if(c=_+2*hf*7,c>oE)return null;C=wp(i,c),v===C&&(_=c)}return v===C?null:Eu(OE(k=>wp(i,k),_,c,v,C))}function Zx(i,n){if(i==="UTC")return null;const a=Fl(n,"ceil"),h=Date.now(),p=h+366*hf*3;if(a>p){const k=Zx(i,Eu(p));if(k===null||Q.lessThan(k,Eu(h)))return k}if(i==="Africa/Casablanca"||i==="Africa/El_Aaiun"){const k=Date.UTC(2088,0,1);if(k<a)return Zx(i,Eu(k))}let _=a-1;if(_<qy)return null;let v=wp(i,_),c=_,C=v;for(;v===C&&_>qy;){if(c=_-2*hf*7,c<qy)return null;C=wp(i,c),v===C&&(_=c)}return v===C?null:Eu(OE(k=>wp(i,k),c,_,C,v))}function ME(i,n){return function(a){const h=a.split(/[^\w]+/);if(h.length!==7)throw new RangeError(`expected 7 parts in "${a}`);const p=+h[0],_=+h[1];let v=+h[2];const c=h[3];if(c[0]==="b"||c[0]==="B")v=1-v;else if(c[0]!=="a"&&c[0]!=="A")throw new RangeError(`Unknown era ${c} in "${a}`);const C=h[4]==="24"?0:+h[4],k=+h[5],P=+h[6];if(!(Number.isFinite(v)&&Number.isFinite(p)&&Number.isFinite(_)&&Number.isFinite(C)&&Number.isFinite(k)&&Number.isFinite(P)))throw new RangeError(`Invalid number in "${a}`);return{year:v,month:p,day:_,hour:C,minute:k,second:P}}(lE(i).format(n))}function Q0(i){return i!==void 0&&!(i%4!=0||i%100==0&&i%400!=0)}function Tp(i,n){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[Q0(i)?"leapyear":"standard"][n-1]}function K0(i){const n=[ne(i,Es),ne(i,Ss),ne(i,ho),ne(i,As),ne(i,Ms),ne(i,Cs),ne(i,Ds),ne(i,ks),ne(i,Is),ne(i,fo)];for(let a=0;a<n.length;a++){const h=n[a];if(h!==0)return h<0?-1:1}return 0}function wv(i){const n=["years","months","weeks","days"];for(let a=0;a<n.length;a++){const h=i[n[a]];if(h!==0)return h<0?-1:1}return 0}function CE(i){const n=wv(i.date);return n!==0?n:i.time.sign()}function xp(i,n){let a=i,h=n;if(!Number.isFinite(a)||!Number.isFinite(h))throw new RangeError("infinity is out of range");return h-=1,a+=Math.floor(h/12),h%=12,h<0&&(h+=12),h+=1,{year:a,month:h}}function _o(i,n,a){let h=i,p=n,_=a;if(!Number.isFinite(_))throw new RangeError("infinity is out of range");({year:h,month:p}=xp(h,p));const v=146097;if(Math.abs(_)>v){const k=Math.trunc(_/v);h+=400*k,_-=k*v}let c=0,C=p>2?h:h-1;for(;c=Q0(C)?366:365,_<-c;)h-=1,C-=1,_+=c;for(C+=1;c=Q0(C)?366:365,_>c;)h+=1,C+=1,_-=c;for(;_<1;)({year:h,month:p}=xp(h,p-1)),_+=Tp(h,p);for(;_>Tp(h,p);)_-=Tp(h,p),{year:h,month:p}=xp(h,p+1);return{year:h,month:p,day:_}}function c_(i,n,a,h,p,_,v,c,C){const k=nf(h,p,_,v,c,C);return ti(_o(i,n,a+k.deltaDays),k)}function nf(i,n,a,h,p,_){let v,c=i,C=n,k=a,P=h,j=p,U=_;({div:v,mod:U}=Wm(U,3)),j+=v,U<0&&(j-=1,U+=1e3),{div:v,mod:j}=Wm(j,3),P+=v,j<0&&(P-=1,j+=1e3),k+=Math.trunc(P/1e3),P%=1e3,P<0&&(k-=1,P+=1e3),C+=Math.trunc(k/60),k%=60,k<0&&(C-=1,k+=60),c+=Math.trunc(C/60),C%=60,C<0&&(c-=1,C+=60);let V=Math.trunc(c/24);return c%=24,c<0&&(V-=1,c+=24),V+=0,c+=0,C+=0,k+=0,P+=0,j+=0,U+=0,{deltaDays:V,hour:c,minute:C,second:k,millisecond:P,microsecond:j,nanosecond:U}}function Aw(i,n){const a=ts(i,0);if(wv(a)===0)return i.days;const h=ne(n,gn),p=Xo(ne(n,Dt),h,a,"constrain"),_=Ip(h.year,h.month-1,h.day),v=Ip(p.year,p.month-1,p.day)-_;return i.days+v}function vo(i){return new(Oa("%Temporal.Duration%"))(-ne(i,Es),-ne(i,Ss),-ne(i,ho),-ne(i,As),-ne(i,Ms),-ne(i,Cs),-ne(i,Ds),-ne(i,ks),-ne(i,Is),-ne(i,fo))}function Rs(i,n,a){return Math.min(a,Math.max(n,i))}function DE(i,n,a){const h=Rs(n,1,12);return{year:i,month:h,day:Rs(a,1,Tp(i,h))}}function xa(i,n,a){if(i<n||i>a)throw new RangeError(`value out of range: ${n} <= ${i} <= ${a}`)}function Dp(i,n,a){xa(n,1,12),xa(a,1,Tp(i,n))}function Bp(i){kp(ti(i,{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}))}function Tv(i,n,a,h,p,_){xa(i,0,23),xa(n,0,59),xa(a,0,59),xa(h,0,999),xa(p,0,999),xa(_,0,999)}function Db(i,n,a,h,p,_,v,c,C){Dp(i,n,a),Tv(h,p,_,v,c,C)}function kp(i){const n=Pa(i);(Q.lessThan(n,SR)||Q.greaterThan(n,AR))&&Du(n)}function Gx(i){Pa(i)}function Du(i){if(Q.lessThan(i,r_)||Q.greaterThan(i,lg))throw new RangeError("date/time value is outside of supported range")}function kb({year:i,month:n}){xa(i,dw,fw),i===dw?xa(n,4,12):i===fw&&xa(n,1,9)}function Ev(i,n,a,h,p,_,v,c,C,k){let P=0;const j=[i,n,a,h,p,_,v,c,C,k];for(let Le=0;Le<j.length;Le++){const Qe=j[Le];if(Qe===1/0||Qe===-1/0)throw new RangeError("infinite values not allowed as duration fields");if(Qe!==0){const He=Qe<0?-1:1;if(P!==0&&He!==P)throw new RangeError("mixed-sign values not allowed as duration fields");P=He}}if(Math.abs(i)>=2**32||Math.abs(n)>=2**32||Math.abs(a)>=2**32)throw new RangeError("years, months, and weeks must be < 2");const U=Wm(c,3),V=Wm(C,6),ie=Wm(k,9),me=Wm(1e6*U.mod+1e3*V.mod+ie.mod,9).div,pe=86400*h+3600*p+60*_+v+U.div+V.div+ie.div+me;if(!Number.isSafeInteger(pe))throw new RangeError("total of duration time units cannot exceed 9007199254740991.999999999 s")}function Xm(i){return{date:{years:ne(i,Es),months:ne(i,Ss),weeks:ne(i,ho),days:ne(i,As)},time:jn.fromComponents(ne(i,Ms),ne(i,Cs),ne(i,Ds),ne(i,ks),ne(i,Is),ne(i,fo))}}function Tu(i){const n=jn.fromComponents(ne(i,Ms),ne(i,Cs),ne(i,Ds),ne(i,ks),ne(i,Is),ne(i,fo)).add24HourDays(ne(i,As));return{date:{years:ne(i,Es),months:ne(i,Ss),weeks:ne(i,ho),days:0},time:n}}function kE(i){const n=Tu(i),a=Math.trunc(n.time.sec/86400);return Ev(n.date.years,n.date.months,n.date.weeks,a,0,0,0,0,0,0),{...n.date,days:a}}function Ll(i,n){const a=i.time.sign();let h=i.time.abs().subsec,p=0,_=0,v=i.time.abs().sec,c=0,C=0,k=0;switch(n){case"year":case"month":case"week":case"day":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,C=Math.trunc(c/60),c%=60,k=Math.trunc(C/24),C%=24;break;case"hour":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,C=Math.trunc(c/60),c%=60;break;case"minute":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60;break;case"second":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3;break;case"millisecond":p=Math.trunc(h/1e3),h%=1e3,_=ax(v,3,Math.trunc(p/1e3)),p%=1e3,v=0;break;case"microsecond":p=ax(v,6,Math.trunc(h/1e3)),h%=1e3,v=0;break;case"nanosecond":h=ax(v,9,h),v=0}return new(Oa("%Temporal.Duration%"))(i.date.years,i.date.months,i.date.weeks,i.date.days+a*k,a*C,a*c,a*v,a*_,a*p,a*h)}function Zh(i,n){return wv(i),n.sign(),{date:i,time:n}}function Ip(i,n,a){return Mb({isoDate:{year:i,month:n+1,day:a},time:{hour:0,minute:0,second:0,millisecond:0}})/hf}function tg({year:i,month:n,day:a}){if(Math.abs(Ip(i,n-1,a))>1e8)throw new RangeError("date/time value is outside the supported range")}function Ib(i,n){const a=n.hour-i.hour,h=n.minute-i.minute,p=n.second-i.second,_=n.millisecond-i.millisecond,v=n.microsecond-i.microsecond,c=n.nanosecond-i.nanosecond;return jn.fromComponents(a,h,p,_,v,c)}function Rb(i,n,a,h,p){let _=jn.fromEpochNsDiff(n,i);return _=J0(_,a,h,p),Zh({years:0,months:0,weeks:0,days:0},_)}function IE(i,n,a,h){Gx(i),Gx(n);let p=Ib(i.time,n.time);const _=p.sign(),v=ku(i.isoDate,n.isoDate);let c=n.isoDate;v===_&&(c=_o(c.year,c.month,c.day+_),p=p.add24HourDays(-_));const C=Vh("day",h),k=k_(a,i.isoDate,c,C);return h!==C&&(p=p.add24HourDays(k.days),k.days=0),Zh(k,p)}function RE(i,n,a,h,p){const _=Q.subtract(n,i);if(Q.equal(_,qo))return{date:{years:0,months:0,weeks:0,days:0},time:jn.ZERO};const v=Q.lessThan(_,qo)?-1:1,c=Bl(a,i),C=Bl(a,n);let k,P=0,j=v===1?2:1,U=Ib(c.time,C.time);for(U.sign()===-v&&P++;P<=j;P++){k=ti(_o(C.isoDate.year,C.isoDate.month,C.isoDate.day-P*v),c.time);const ie=ns(a,k,"compatible");if(U=jn.fromEpochNsDiff(n,ie),U.sign()!==-v)break}const V=Vh("day",p);return Zh(k_(h,c.isoDate,k.isoDate,V),U)}function zE(i,n,a,h,p,_,v,c,C){let k,P,j,U,V=n;switch(c){case"year":{const Ot=af(V.date.years,v,"trunc");k=Ot,P=Ot+v*i,j={years:k,months:0,weeks:0,days:0},U={...j,years:P};break}case"month":{const Ot=af(V.date.months,v,"trunc");k=Ot,P=Ot+v*i,j=ts(V.date,0,0,k),U=ts(V.date,0,0,P);break}case"week":{const Ot=ts(V.date,0,0),Vt=Xo(_,h.isoDate,Ot,"constrain"),Wt=k_(_,Vt,_o(Vt.year,Vt.month,Vt.day+V.date.days),"week"),dn=af(V.date.weeks+Wt.weeks,v,"trunc");k=dn,P=dn+v*i,j=ts(V.date,0,k),U=ts(V.date,0,P);break}case"day":{const Ot=af(V.date.days,v,"trunc");k=Ot,P=Ot+v*i,j=ts(V.date,k),U=ts(V.date,P);break}}const ie=Xo(_,h.isoDate,j,"constrain"),me=Xo(_,h.isoDate,U,"constrain");let pe,Le;const Qe=ti(ie,h.time),He=ti(me,h.time);p?(pe=ns(p,Qe,"compatible"),Le=ns(p,He,"compatible")):(pe=Pa(Qe),Le=Pa(He));const $e=jn.fromEpochNsDiff(a,pe),ke=jn.fromEpochNsDiff(Le,pe),Ze=mv(C,i<0?"negative":"positive"),nt=$e.add($e).abs().subtract(ke.abs()).sign(),Ke=Math.abs(k)/v%2==0,Re=$e.isZero()?Math.abs(k):$e.cmp(ke)?gv(Math.abs(k),Math.abs(P),nt,Ke,Ze):Math.abs(P),_t=new jn(Q.add(Q.multiply(ke.totalNs,Q.BigInt(k)),Q.multiply($e.totalNs,Q.BigInt(v*i)))).fdiv(ke.totalNs),It=Re===Math.abs(P);return V={date:It?U:j,time:jn.ZERO},{nudgeResult:{duration:V,nudgedEpochNs:It?Le:pe,didExpandCalendarUnit:It},total:_t}}function Sv(i,n,a,h,p,_,v,c,C){let k=i;const P=yu(c)||h&&c==="day",j=CE(k)<0?-1:1;let U;return P?{nudgeResult:U}=zE(j,k,n,a,h,p,v,c,C):U=h?function(V,ie,me,pe,Le,Qe,He,$e){let ke=ie;const Ze=Xo(Le,me.isoDate,ke.date,"constrain"),nt=ti(Ze,me.time),Ke=ti(_o(Ze.year,Ze.month,Ze.day+V),me.time),Re=ns(pe,nt,"compatible"),_t=ns(pe,Ke,"compatible"),It=jn.fromEpochNsDiff(_t,Re);if(It.sign()!==V)throw new RangeError("time zone returned inconsistent Instants");const Ot=Q.BigInt(ug[He]*Qe);let Vt=ke.time.round(Ot,$e);const Wt=Vt.subtract(It),dn=Wt.sign()!==-V;let Oe,vt;return dn?(Oe=V,Vt=Wt.round(Ot,$e),vt=Vt.addToEpochNs(_t)):(Oe=0,vt=Vt.addToEpochNs(Re)),{duration:Zh(ts(ke.date,ke.date.days+Oe),Vt),nudgedEpochNs:vt,didExpandCalendarUnit:dn}}(j,k,a,h,p,v,c,C):function(V,ie,me,pe,Le,Qe){let He=V;const $e=He.time.add24HourDays(He.date.days),ke=$e.round(Q.BigInt(pe*ug[Le]),Qe),Ze=ke.subtract($e),{quotient:nt}=$e.divmod(Y0),{quotient:Ke}=ke.divmod(Y0),Re=Math.sign(Ke-nt)===$e.sign(),_t=Ze.addToEpochNs(ie);let It=0,Ot=ke;return Lh(me)==="date"&&(It=Ke,Ot=ke.add(jn.fromComponents(24*-Ke,0,0,0,0,0))),{duration:{date:ts(He.date,It),time:Ot},nudgedEpochNs:_t,didExpandCalendarUnit:Re}}(k,n,_,v,c,C),k=U.duration,U.didExpandCalendarUnit&&c!=="week"&&(k=function(V,ie,me,pe,Le,Qe,He,$e){let ke=ie;if($e===He)return ke;const Ze=Hy.indexOf(He);for(let nt=Hy.indexOf($e)-1;nt>=Ze;nt--){const Ke=Hy[nt];if(Ke==="week"&&He!=="week")continue;let Re;switch(Ke){case"year":Re={years:ke.date.years+V,months:0,weeks:0,days:0};break;case"month":{const Ot=ke.date.months+V;Re=ts(ke.date,0,0,Ot);break}case"week":{const Ot=ke.date.weeks+V;Re=ts(ke.date,0,Ot);break}}const _t=ti(Xo(Qe,pe.isoDate,Re,"constrain"),pe.time);let It;if(It=Le?ns(Le,_t,"compatible"):Pa(_t),G0(me,It)===-V)break;ke={date:Re,time:jn.ZERO}}return ke}(j,k,U.nudgedEpochNs,a,h,p,_,Vh(c,"day"))),k}function Mw(i,n,a,h,p,_){return yu(_)||h&&_==="day"?zE(CE(i)<0?-1:1,i,n,a,h,p,1,_,"trunc").total:Qy(i.time.add24HourDays(i.date.days),_)}function LE(i,n,a,h,p,_,v){if(dg(i,n)==0)return{date:{years:0,months:0,weeks:0,days:0},time:jn.ZERO};kp(i),kp(n);const c=IE(i,n,a,h);return _==="nanosecond"&&p===1?c:Sv(c,Pa(n),i,null,a,h,p,_,v)}function NE(i,n,a,h,p,_,v,c){if(Lh(p)==="time")return Rb(i,n,_,v,c);const C=RE(i,n,a,h,p);return v==="nanosecond"&&_===1?C:Sv(C,n,Bl(a,i),a,h,p,_,v,c)}function Eg(i,n,a,h,p,_){const v=cg.reduce((V,ie)=>{const me=ie[0],pe=ie[1],Le=ie[2];return a!=="datetime"&&Le!==a||h.includes(pe)||V.push(pe,me),V},[]);let c=mo(n,"largestUnit",a,"auto");if(h.includes(c))throw new RangeError(`largestUnit must be one of ${v.join(", ")}, not ${c}`);const C=bg(n);let k=jc(n,"trunc");i==="since"&&(k=function(V){switch(V){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return V}}(k));const P=mo(n,"smallestUnit",a,p);if(h.includes(P))throw new RangeError(`smallestUnit must be one of ${v.join(", ")}, not ${P}`);const j=Vh(_,P);if(c==="auto"&&(c=j),Vh(c,P)!==c)throw new RangeError(`largestUnit ${c} cannot be smaller than smallestUnit ${P}`);const U={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[P];return U!==void 0&&wg(C,U,!1),{largestUnit:c,roundingIncrement:C,roundingMode:k,smallestUnit:P}}function Cw(i,n,a,h){const p=jy(a),_=Eg(i,rn(h),"time",[],"nanosecond","second");let v=Ll(Rb(ne(n,mn),ne(p,mn),_.roundingIncrement,_.smallestUnit,_.roundingMode),_.largestUnit);return i==="since"&&(v=vo(v)),v}function Dw(i,n,a,h){const p=Py(a),_=ne(n,Dt),v=ne(p,Dt);if(!Cu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Eg(i,rn(h),"date",[],"day","day"),C=Oa("%Temporal.Duration%"),k=ne(n,gn),P=ne(p,gn);if(ku(k,P)===0)return new C;let j={date:k_(_,k,P,c.largestUnit),time:jn.ZERO};if(c.smallestUnit!=="day"||c.roundingIncrement!==1){const V=ti(k,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});j=Sv(j,Pa(ti(P,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),V,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let U=Ll(j,"day");return i==="since"&&(U=vo(U)),U}function kw(i,n,a,h){const p=Oy(a),_=ne(n,Dt),v=ne(p,Dt);if(!Cu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Eg(i,rn(h),"datetime",[],"nanosecond","day"),C=Oa("%Temporal.Duration%"),k=ne(n,ir),P=ne(p,ir);if(dg(k,P)===0)return new C;let j=Ll(LE(k,P,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);return i==="since"&&(j=vo(j)),j}function Iw(i,n,a,h){const p=rf(a),_=Eg(i,rn(h),"time",[],"nanosecond","hour");let v=Ib(ne(n,wr),ne(p,wr));v=J0(v,_.roundingIncrement,_.smallestUnit,_.roundingMode);let c=Ll(Zh({years:0,months:0,weeks:0,days:0},v),_.largestUnit);return i==="since"&&(c=vo(c)),c}function Rw(i,n,a,h){const p=By(a),_=ne(n,Dt),v=ne(p,Dt);if(!Cu(_,v))throw new RangeError(`cannot compute difference between months of ${_} and ${v} calendars`);const c=Eg(i,rn(h),"date",["week","day"],"month","year"),C=Oa("%Temporal.Duration%");if(ku(ne(n,gn),ne(p,gn))==0)return new C;const k=Ns(_,ne(n,gn),"year-month");k.day=1;const P=df(_,k,"constrain"),j=Ns(_,ne(p,gn),"year-month");j.day=1;const U=df(_,j,"constrain");let V={date:ts(k_(_,P,U,c.largestUnit),0,0),time:jn.ZERO};if(c.smallestUnit!=="month"||c.roundingIncrement!==1){const me=ti(P,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});V=Sv(V,Pa(ti(U,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),me,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let ie=Ll(V,"day");return i==="since"&&(ie=vo(ie)),ie}function zw(i,n,a,h){const p=Fy(a),_=ne(n,Dt),v=ne(p,Dt);if(!Cu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Eg(i,rn(h),"datetime",[],"nanosecond","hour"),C=ne(n,mn),k=ne(p,mn),P=Oa("%Temporal.Duration%");let j;if(Lh(c.largestUnit)!=="date")j=Ll(Rb(C,k,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);else{const U=ne(n,pi);if(!wE(U,ne(p,pi)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");if(Q.equal(C,k))return new P;j=Ll(NE(C,k,U,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),"hour")}return i==="since"&&(j=vo(j)),j}function hg({hour:i,minute:n,second:a,millisecond:h,microsecond:p,nanosecond:_},v){let c=a,C=_;return c+=v.sec,C+=v.subsec,nf(i,n,c,h,p,C)}function $x(i,n){const a=n.addToEpochNs(i);return Du(a),a}function Uy(i,n,a,h,p="constrain"){if(wv(h.date)===0)return $x(i,h.time);const _=Bl(n,i);return $x(ns(n,ti(Xo(a,_.isoDate,h.date,p),_.time),"compatible"),h.time)}function Lw(i,n,a){let h=Pl(a);i==="subtract"&&(h=vo(h));const p=Vh(zh(n),zh(h));if(yu(p))throw new RangeError("For years, months, or weeks arithmetic, use date arithmetic relative to a starting point");const _=Tu(n),v=Tu(h);return Ll(Zh({years:0,months:0,weeks:0,days:0},_.time.add(v.time)),p)}function Nw(i,n,a){let h=Pl(a);i==="subtract"&&(h=vo(h));const p=zh(h);if(Lh(p)==="date")throw new RangeError(`Duration field ${p} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);const _=Tu(h);return wu($x(ne(n,mn),_.time))}function Pw(i,n,a,h){const p=ne(n,Dt);let _=Pl(a);i==="subtract"&&(_=vo(_));const v=kE(_),c=Kn(rn(h));return zs(Xo(p,ne(n,gn),v,c),p)}function Ow(i,n,a,h){let p=Pl(a);i==="subtract"&&(p=vo(p));const _=Kn(rn(h)),v=ne(n,Dt),c=Tu(p),C=ne(n,ir),k=hg(C.time,c.time),P=ts(c.date,k.deltaDays);return Ev(P.years,P.months,P.weeks,P.days,0,0,0,0,0,0),zl(ti(Xo(v,C.isoDate,P,_),k),v)}function jw(i,n,a){let h=Pl(a);i==="subtract"&&(h=vo(h));const p=Tu(h),{hour:_,minute:v,second:c,millisecond:C,microsecond:k,nanosecond:P}=hg(ne(n,wr),p.time);return Ph(xv(_,v,c,C,k,P,"reject"))}function Bw(i,n,a,h){let p=Pl(a);i==="subtract"&&(p=vo(p));const _=Kn(rn(h)),v=K0(p),c=ne(n,Dt),C=Ns(c,ne(n,gn),"year-month");C.day=1;let k=df(c,C,"constrain");if(v<0){const j=Xo(c,k,{months:1},"constrain");k=_o(j.year,j.month,j.day-1)}const P=kE(p);return Bp(k),eg(s_(c,Ns(c,Xo(c,k,P,_),"year-month"),_),c)}function Fw(i,n,a,h){let p=Pl(a);i==="subtract"&&(p=vo(p));const _=Kn(rn(h)),v=ne(n,pi),c=ne(n,Dt),C=Xm(p);return es(Uy(ne(n,mn),v,c,C,_),v,c)}function af(i,n,a){const h=Math.trunc(i/n),p=i%n,_=i<0?"negative":"positive",v=Math.abs(h),c=v+1,C=po(Math.abs(2*p)-n),k=v%2==0,P=mv(a,_),j=p===0?v:gv(v,c,C,k,P);return n*(_==="positive"?j:-j)}function Yx(i,n,a,h){const p=ug[a]*n;return function(_,v,c){const C=Ih(_),k=Ih(v),P=Q.divide(C,k),j=Q.remainder(C,k),U=mv(c,"positive");let V,ie;Q.lessThan(C,qo)?(V=Q.subtract(P,i_),ie=P):(V=P,ie=Q.add(P,i_));const me=G0(yp(Q.multiply(j,Tb)),k)*(Q.lessThan(C,qo)?-1:1)+0,pe=Q.equal(j,qo)?P:gv(V,ie,me,$T(V),U);return Q.multiply(pe,k)}(i,Q.BigInt(p),h)}function qx(i,n,a,h){Gx(i);const{year:p,month:_,day:v}=i.isoDate,c=Hx(i.time,n,a,h);return ti(_o(p,_,v+c.deltaDays),c)}function Hx({hour:i,minute:n,second:a,millisecond:h,microsecond:p,nanosecond:_},v,c,C){let k;switch(c){case"day":case"hour":k=1e3*(1e3*(1e3*(60*(60*i+n)+a)+h)+p)+_;break;case"minute":k=1e3*(1e3*(1e3*(60*n+a)+h)+p)+_;break;case"second":k=1e3*(1e3*(1e3*a+h)+p)+_;break;case"millisecond":k=1e3*(1e3*h+p)+_;break;case"microsecond":k=1e3*p+_;break;case"nanosecond":k=_}const P=ug[c],j=af(k,P*v,C)/P;switch(c){case"day":return{deltaDays:j,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return nf(j,0,0,0,0,0);case"minute":return nf(i,j,0,0,0,0);case"second":return nf(i,n,j,0,0,0);case"millisecond":return nf(i,n,a,j,0,0);case"microsecond":return nf(i,n,a,h,j,0);case"nanosecond":return nf(i,n,a,h,p,j);default:throw new Error(`Invalid unit ${c}`)}}function J0(i,n,a,h){const p=ug[a];return i.round(Q.BigInt(p*n),h)}function Qy(i,n){const a=ug[n];return i.fdiv(Q.BigInt(a))}function ku(i,n){return i.year!==n.year?po(i.year-n.year):i.month!==n.month?po(i.month-n.month):i.day!==n.day?po(i.day-n.day):0}function Xx(i,n){return i.hour!==n.hour?po(i.hour-n.hour):i.minute!==n.minute?po(i.minute-n.minute):i.second!==n.second?po(i.second-n.second):i.millisecond!==n.millisecond?po(i.millisecond-n.millisecond):i.microsecond!==n.microsecond?po(i.microsecond-n.microsecond):i.nanosecond!==n.nanosecond?po(i.nanosecond-n.nanosecond):0}function dg(i,n){const a=ku(i.isoDate,n.isoDate);return a!==0?a:Xx(i.time,n.time)}function PE(i){const n=ev(i);return globalThis.BigInt!==void 0?globalThis.BigInt(n.toString(10)):n}function Fl(i,n){const a=Ih(i),{quotient:h,remainder:p}=Ly(a,w_);let _=Q.toNumber(h);return n==="floor"&&Q.toNumber(p)<0&&(_-=1),n==="ceil"&&Q.toNumber(p)>0&&(_+=1),_}function Eu(i){if(!Number.isInteger(i))throw new RangeError("epoch milliseconds must be an integer");return Q.multiply(Q.BigInt(i),w_)}function ev(i){let n=i;if(typeof i=="object"){const a=i[Symbol.toPrimitive];a&&typeof a=="function"&&(n=a.call(i,"number"))}if(typeof n=="number")throw new TypeError("cannot convert number to bigint");return typeof n=="bigint"?Q.BigInt(n.toString(10)):Q.BigInt(n)}const Wx=(()=>{let i=Q.BigInt(Date.now()%1e6);return()=>{const n=Date.now(),a=Q.BigInt(n),h=Q.add(Eu(n),i);return i=Q.remainder(a,w_),Q.greaterThan(h,lg)?lg:Q.lessThan(h,r_)?r_:h}})();function Cy(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function po(i){return i<0?-1:i>0?1:i}function rn(i){if(i===void 0)return Object.create(null);if(Tr(i)&&i!==null)return i;throw new TypeError("Options parameter must be an object, not "+(i===null?"null":typeof i))}function Rp(i,n){const a=Object.create(null);return a[i]=n,a}function Gh(i,n,a,h){let p=i[n];if(p!==void 0){if(p=_v(p),!a.includes(p))throw new RangeError(`${n} must be one of ${a.join(", ")}, not ${p}`);return p}if(h===Xh)throw new RangeError(`${n} option is required`);return h}function Os(i){const n=u_(i);if(!CR.includes(u_(n)))throw new RangeError(`invalid calendar identifier ${n}`);switch(n){case"ethiopic-amete-alem":return"ethioaa";case"islamicc":return"islamic-civil"}return n}function u_(i){let n="";for(let a=0;a<i.length;a++){const h=i.charCodeAt(a);n+=h>=65&&h<=90?String.fromCharCode(h+32):String.fromCharCode(h)}return n}function yf(i){throw new TypeError(`Do not use built-in arithmetic operators with Temporal objects. When comparing, use ${i==="PlainMonthDay"?"Temporal.PlainDate.compare(obj1.toPlainDate(year), obj2.toPlainDate(year))":`Temporal.${i}.compare(obj1, obj2)`}, not obj1 > obj2. When coercing to strings, use \`\${obj}\` or String(obj), not '' + obj. When coercing to numbers, use properties or methods of the object, not \`+obj\`. When concatenating with strings, use \`\${str}\${obj}\` or str.concat(obj), not str + obj. In React, coerce to a string before rendering a Temporal object.`)}const NR=new RegExp(`^${aE.source}$`),PR=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/.source}$`);function OE(i,n,a,h=i(n),p=i(a)){let _=n,v=a,c=h,C=p;for(;v-_>1;){let k=Math.trunc((_+v)/2);const P=i(k);P===c?(_=k,c=P):P===C&&(v=k,C=P)}return v}function jE(i){return[...i]}function BE(i,n){if(i!=="gregory"&&i!=="iso8601")return;const a=L_[i];let h=n.year;const{dayOfWeek:p,dayOfYear:_,daysInYear:v}=a.isoToDate(n,{dayOfWeek:!0,dayOfYear:!0,daysInYear:!0}),c=a.getFirstDayOfWeek(),C=a.getMinimalDaysInFirstWeek();let k=(p+7-c)%7,P=(p-_+7001-c)%7,j=Math.floor((_-1+P)/7);if(7-P>=C&&++j,j==0)j=function(U,V,ie,me){let pe=(me-U-ie+1)%7;pe<0&&(pe+=7);let Le=Math.floor((ie+pe-1)/7);return 7-pe>=V&&++Le,Le}(c,C,_+a.isoToDate(a.dateAdd(n,{years:-1},"constrain"),{daysInYear:!0}).daysInYear,p),h--;else if(_>=v-5){let U=(k+v-_)%7;U<0&&(U+=7),6-U>=C&&_+7-k>v&&(j=1,h++)}return{week:j,year:h}}function Uw(i,n,a,h,p){if(n!==p.year){if(i*(n-p.year)>0)return!0}else if(a!==p.month){if(i*(a-p.month)>0)return!0}else if(h!==p.day&&i*(h-p.day)>0)return!0;return!1}const L_={};function zp(i){if(!i.startsWith("M"))throw new RangeError(`Invalid month code: ${i}.  Month codes must start with M.`);const n=+i.slice(1);if(Number.isNaN(n))throw new RangeError(`Invalid month code: ${i}`);return n}function Mu(i,n=!1){return`M${`${i}`.padStart(2,"0")}${n?"L":""}`}function zb(i,n=void 0,a=12){let{month:h,monthCode:p}=i;if(p===void 0){if(h===void 0)throw new TypeError("Either month or monthCode are required");n==="reject"&&xa(h,1,a),n==="constrain"&&(h=Rs(h,1,a)),p=Mu(h)}else{const _=zp(p);if(p!==Mu(_))throw new RangeError(`Invalid month code: ${p}`);if(h!==void 0&&h!==_)throw new RangeError(`monthCode ${p} and month ${h} must match if both are present`);if(h=_,h<1||h>a)throw new RangeError(`Invalid monthCode: ${p}`)}return{...i,month:h,monthCode:p}}L_.iso8601={resolveFields(i,n){if((n==="date"||n==="year-month")&&i.year===void 0)throw new TypeError("year is required");if((n==="date"||n==="month-day")&&i.day===void 0)throw new TypeError("day is required");Object.assign(i,zb(i))},dateToISO:(i,n)=>Xy(i.year,i.month,i.day,n),monthDayToISOReferenceDate(i,n){const{month:a,day:h}=Xy(i.year??1972,i.month,i.day,n);return{month:a,day:h,year:1972}},extraFields:()=>[],fieldKeysToIgnore(i){const n=new Set;for(let a=0;a<i.length;a++){const h=i[a];n.add(h),h==="month"?n.add("monthCode"):h==="monthCode"&&n.add("month")}return jE(n)},dateAdd(i,{years:n=0,months:a=0,weeks:h=0,days:p=0},_){let{year:v,month:c,day:C}=i;return v+=n,c+=a,{year:v,month:c}=xp(v,c),{year:v,month:c,day:C}=Xy(v,c,C,_),C+=p+7*h,_o(v,c,C)},dateUntil(i,n,a){const h=-ku(i,n);if(h===0)return{years:0,months:0,weeks:0,days:0};let p,_=0,v=0;if(a==="year"||a==="month"){let P=n.year-i.year;for(P!==0&&(P-=h);!Uw(h,i.year+P,i.month,i.day,n);)_=P,P+=h;let j=h;for(p=xp(i.year+_,i.month+j);!Uw(h,p.year,p.month,i.day,n);)v=j,j+=h,p=xp(p.year,p.month+h);a==="month"&&(v+=12*_,_=0)}p=xp(i.year+_,i.month+v);const c=DE(p.year,p.month,i.day);let C=0,k=Ip(n.year,n.month-1,n.day)-Ip(c.year,c.month-1,c.day);return a==="week"&&(C=Math.trunc(k/7),k%=7),{years:_,months:v,weeks:C,days:k}},isoToDate({year:i,month:n,day:a},h){const p={era:void 0,eraYear:void 0,year:i,month:n,day:a,daysInWeek:7,monthsInYear:12};if(h.monthCode&&(p.monthCode=Mu(n)),h.dayOfWeek){const _=n+(n<3?10:-2),v=i-(n<3?1:0),c=Math.floor(v/100),C=v-100*c,k=(a+Math.floor(2.6*_-.2)+(C+Math.floor(C/4))+(Math.floor(c/4)-2*c))%7;p.dayOfWeek=k+(k<=0?7:0)}if(h.dayOfYear){let _=a;for(let v=n-1;v>0;v--)_+=Tp(i,v);p.dayOfYear=_}return h.weekOfYear&&(p.weekOfYear=BE("iso8601",{year:i,month:n,day:a})),h.daysInMonth&&(p.daysInMonth=Tp(i,n)),(h.daysInYear||h.inLeapYear)&&(p.inLeapYear=Q0(i),p.daysInYear=p.inLeapYear?366:365),p},getFirstDayOfWeek:()=>1,getMinimalDaysInFirstWeek:()=>4};class _a{constructor(n){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,n!==void 0){let a=0;for(const h of n.map.entries()){if(++a>_a.MAX_CACHE_ENTRIES)break;this.map.set(...h)}}}get(n){const a=this.map.get(n);return a&&(this.hits++,this.report()),this.calls++,a}set(n,a){this.map.set(n,a),this.misses++,this.report()}report(){}setObject(n){if(_a.objectMap.get(n))throw new RangeError("object already cached");_a.objectMap.set(n,this),this.report()}static getCacheForObject(n){let a=_a.objectMap.get(n);return a||(a=new _a,_a.objectMap.set(n,a)),a}}function FE({isoYear:i,isoMonth:n,isoDay:a}){return`${z_(i)}-${Wo(n)}-${Wo(a)}T00:00Z`}function lx(i,n){return{years:i.year-n.year,months:i.month-n.month,days:i.day-n.day}}_a.objectMap=new WeakMap,_a.MAX_CACHE_ENTRIES=1e3;class Fp{constructor(){this.eras=[],this.hasEra=!1,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new Intl.DateTimeFormat(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:"short",timeZone:"UTC"})),this.formatter}getCalendarParts(n){let a=this.getFormatter(),h=new Date(n);if(n==="-271821-04-19T00:00Z"){const p=a.resolvedOptions();a=new Intl.DateTimeFormat(p.locale,{...p,timeZone:"Etc/GMT+1"}),h=new Date("-271821-04-20T00:00Z")}try{return a.formatToParts(h)}catch{throw new RangeError(`Invalid ISO date: ${n}`)}}isoToCalendarDate(n,a){const{year:h,month:p,day:_}=n,v=JSON.stringify({func:"isoToCalendarDate",isoYear:h,isoMonth:p,isoDay:_,id:this.id}),c=a.get(v);if(c)return c;const C=FE({isoYear:h,isoMonth:p,isoDay:_}),k=this.getCalendarParts(C),P={};for(let U=0;U<k.length;U++){const{type:V,value:ie}=k[U];if(V!=="year"&&V!=="relatedYear"||(this.hasEra?P.eraYear=+ie:P.year=+ie),V==="month"){const me=/^([0-9]*)(.*?)$/.exec(ie);if(!me||me.length!=3||!me[1]&&!me[2])throw new RangeError(`Unexpected month: ${ie}`);if(P.month=me[1]?+me[1]:1,P.month<1)throw new RangeError(`Invalid month ${ie} from ${C}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(P.month>13)throw new RangeError(`Invalid month ${ie} from ${C}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);me[2]&&(P.monthExtra=me[2])}V==="day"&&(P.day=+ie),this.hasEra&&V==="era"&&ie!=null&&ie!==""&&(P.era=ie.split(" (")[0].normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(/ /g,"-").toLowerCase())}if(this.hasEra&&P.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.hasEra){const U=this.eras.find(V=>P.era===V.genericName);U&&(P.era=U.code)}if(this.reviseIntlEra){const{era:U,eraYear:V}=this.reviseIntlEra(P,n);P.era=U,P.eraYear=V}this.checkIcuBugs&&this.checkIcuBugs(n);const j=this.adjustCalendarDate(P,a,"constrain",!0);if(j.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(n)}`);if(j.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(n)}`);if(j.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(n)}`);return a.set(v,j),["constrain","reject"].forEach(U=>{const V=JSON.stringify({func:"calendarToIsoDate",year:j.year,month:j.month,day:j.day,overflow:U,id:this.id});a.set(V,n)}),j}validateCalendarDate(n){const{month:a,year:h,day:p,eraYear:_,monthCode:v,monthExtra:c}=n;if(c!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(h===void 0&&_===void 0)throw new TypeError("year or eraYear is required");if(a===void 0&&v===void 0)throw new TypeError("month or monthCode is required");if(p===void 0)throw new RangeError("Missing day");if(v!==void 0){if(typeof v!="string")throw new RangeError("monthCode must be a string, not "+typeof v);if(!/^M([01]?\d)(L?)$/.test(v))throw new RangeError(`Invalid monthCode: ${v}`)}if(this.hasEra&&n.era===void 0!=(n.eraYear===void 0))throw new TypeError("properties era and eraYear must be provided together")}adjustCalendarDate(n,a=void 0,h="constrain",p=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let _=n;this.validateCalendarDate(_);const v=this.monthsInYear(_,a);let{month:c,monthCode:C}=_;return{month:c,monthCode:C}=zb(_,h,v),{..._,month:c,monthCode:C}}regulateMonthDayNaive(n,a,h){const p=this.monthsInYear(n,h);let{month:_,day:v}=n;return a==="reject"?(xa(_,1,p),xa(v,1,this.maximumMonthLength(n))):(_=Rs(_,1,p),v=Rs(v,1,this.maximumMonthLength({...n,month:_}))),{...n,month:_,day:v}}calendarToIsoDate(n,a="constrain",h){const p=n;let _=this.adjustCalendarDate(n,h,a,!1);_=this.regulateMonthDayNaive(_,a,h);const{year:v,month:c,day:C}=_,k=JSON.stringify({func:"calendarToIsoDate",year:v,month:c,day:C,overflow:a,id:this.id});let P,j=h.get(k);if(j||p.year!==void 0&&p.month!==void 0&&p.day!==void 0&&(p.year!==_.year||p.month!==_.month||p.day!==_.day)&&(P=JSON.stringify({func:"calendarToIsoDate",year:p.year,month:p.month,day:p.day,overflow:a,id:this.id}),j=h.get(P),j))return j;let U=this.estimateIsoDate({year:v,month:c,day:C});const V=Qe=>{let He=this.addDaysIso(U,Qe);if(_.day>this.minimumMonthLength(_)){let $e=this.isoToCalendarDate(He,h);for(;$e.month!==c||$e.year!==v;){if(a==="reject")throw new RangeError(`day ${C} does not exist in month ${c} of year ${v}`);He=this.addDaysIso(He,-1),$e=this.isoToCalendarDate(He,h)}}return He};let ie=0,me=this.isoToCalendarDate(U,h),pe=lx(_,me);if(pe.years!==0||pe.months!==0||pe.days!==0){const Qe=365*pe.years+30*pe.months+pe.days;U=this.addDaysIso(U,Qe),me=this.isoToCalendarDate(U,h),pe=lx(_,me),pe.years===0&&pe.months===0?U=V(pe.days):ie=this.compareCalendarDates(_,me)}let Le=8;for(;ie;){U=this.addDaysIso(U,ie*Le);const Qe=me;me=this.isoToCalendarDate(U,h);const He=ie;if(ie=this.compareCalendarDates(_,me),ie){if(pe=lx(_,me),pe.years===0&&pe.months===0)U=V(pe.days),ie=0;else if(He&&ie!==He)if(Le>1)Le/=2;else{if(a==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...p})}`);this.compareCalendarDates(me,Qe)>0&&(U=this.addDaysIso(U,-1)),ie=0}}}if(h.set(k,U),P&&h.set(P,U),_.year===void 0||_.month===void 0||_.day===void 0||_.monthCode===void 0||this.hasEra&&(_.era===void 0||_.eraYear===void 0))throw new RangeError("Unexpected missing property");return U}compareCalendarDates(n,a){return n.year!==a.year?po(n.year-a.year):n.month!==a.month?po(n.month-a.month):n.day!==a.day?po(n.day-a.day):0}regulateDate(n,a="constrain",h){const p=this.calendarToIsoDate(n,a,h);return this.isoToCalendarDate(p,h)}addDaysIso(n,a){return _o(n.year,n.month,n.day+a)}addDaysCalendar(n,a,h){const p=this.calendarToIsoDate(n,"constrain",h),_=this.addDaysIso(p,a);return this.isoToCalendarDate(_,h)}addMonthsCalendar(n,a,h,p){let _=n;const{day:v}=_;for(let c=0,C=Math.abs(a);c<C;c++){const{month:k}=_,P=_,j=a<0?-Math.max(v,this.daysInPreviousMonth(_,p)):this.daysInMonth(_,p),U=this.calendarToIsoDate(_,"constrain",p);let V=this.addDaysIso(U,j);if(_=this.isoToCalendarDate(V,p),a>0){const ie=this.monthsInYear(P,p);for(;_.month-1!=k%ie;)V=this.addDaysIso(V,-1),_=this.isoToCalendarDate(V,p)}_.day!==v&&(_=this.regulateDate({..._,day:v},"constrain",p))}if(h==="reject"&&_.day!==v)throw new RangeError(`Day ${v} does not exist in resulting calendar month`);return _}addCalendar(n,{years:a=0,months:h=0,weeks:p=0,days:_=0},v,c){const{year:C,day:k,monthCode:P}=n,j=this.adjustCalendarDate({year:C+a,monthCode:P,day:k},c),U=this.addMonthsCalendar(j,h,v,c),V=_+7*p;return this.addDaysCalendar(U,V,c)}untilCalendar(n,a,h,p){let _=0,v=0,c=0,C=0;switch(h){case"day":_=this.calendarDaysUntil(n,a,p);break;case"week":{const k=this.calendarDaysUntil(n,a,p);_=k%7,v=(k-_)/7;break}case"month":case"year":{const k=this.compareCalendarDates(a,n);if(!k)return{years:0,months:0,weeks:0,days:0};const P=a.year-n.year,j=a.day-n.day;if(h==="year"&&P){let ie=0;a.monthCode>n.monthCode&&(ie=1),a.monthCode<n.monthCode&&(ie=-1),ie||(ie=Math.sign(j)),C=ie*k<0?P-k:P}let U,V=C?this.addCalendar(n,{years:C},"constrain",p):n;do c+=k,U=V,V=this.addMonthsCalendar(U,k,"constrain",p),V.day!==n.day&&(V=this.regulateDate({...V,day:n.day},"constrain",p));while(this.compareCalendarDates(a,V)*k>=0);c-=k,_=this.calendarDaysUntil(U,a,p);break}}return{years:C,months:c,weeks:v,days:_}}daysInMonth(n,a){const{day:h}=n,p=this.maximumMonthLength(n),_=this.minimumMonthLength(n);if(_===p)return _;const v=h<=p-_?p:_,c=this.calendarToIsoDate(n,"constrain",a),C=this.addDaysIso(c,v),k=this.isoToCalendarDate(C,a),P=this.addDaysIso(C,-k.day);return this.isoToCalendarDate(P,a).day}daysInPreviousMonth(n,a){const{day:h,month:p,year:_}=n;let v={year:p>1?_:_-1,month:p,day:1};const c=p>1?p-1:this.monthsInYear(v,a);v={...v,month:c};const C=this.minimumMonthLength(v),k=this.maximumMonthLength(v);if(C===k)return k;const P=this.calendarToIsoDate(n,"constrain",a),j=this.addDaysIso(P,-h);return this.isoToCalendarDate(j,a).day}startOfCalendarYear(n){return{year:n.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(n){return{year:n.year,month:n.month,day:1}}calendarDaysUntil(n,a,h){const p=this.calendarToIsoDate(n,"constrain",h),_=this.calendarToIsoDate(a,"constrain",h);return Ip(_.year,_.month-1,_.day)-Ip(p.year,p.month-1,p.day)}monthDaySearchStartYear(n,a){return 1972}monthDayFromFields(n,a,h){let p,_,v,c,C,{era:k,eraYear:P,year:j,month:U,monthCode:V,day:ie}=n;if(U!==void 0&&j===void 0&&(!this.hasEra||k===void 0||P===void 0))throw new TypeError("when month is present, year (or era and eraYear) are required");(V===void 0||j!==void 0||this.hasEra&&P!==void 0)&&({monthCode:V,day:ie}=this.isoToCalendarDate(this.calendarToIsoDate(n,a,h),h));const me={year:this.monthDaySearchStartYear(V,ie),month:12,day:31},pe=this.isoToCalendarDate(me,h),Le=pe.monthCode>V||pe.monthCode===V&&pe.day>=ie?pe.year:pe.year-1;for(let Qe=0;Qe<20;Qe++){const He=this.adjustCalendarDate({day:ie,monthCode:V,year:Le-Qe},h),$e=this.calendarToIsoDate(He,"constrain",h),ke=this.isoToCalendarDate($e,h);if({year:p,month:_,day:v}=$e,ke.monthCode===V&&ke.day===ie)return{month:_,day:v,year:p};if(a==="constrain"){const Ze=this.maxLengthOfMonthCodeInAnyYear(ke.monthCode);if(ke.monthCode===V&&ke.day===Ze&&ie>Ze)return{month:_,day:v,year:p};(c===void 0||ke.monthCode===c.monthCode&&ke.day>c.day)&&(c=ke,C=$e)}}if(a==="constrain"&&C!==void 0)return C;throw new RangeError(`No recent ${this.id} year with monthCode ${V} and day ${ie}`)}getFirstDayOfWeek(){}getMinimalDaysInFirstWeek(){}}class OR extends Fp{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}}}inLeapYear(n){const{year:a}=n;return(7*a+1)%19<7}monthsInYear(n){return this.inLeapYear(n)?13:12}minimumMonthLength(n){return this.minMaxMonthLength(n,"min")}maximumMonthLength(n){return this.minMaxMonthLength(n,"max")}minMaxMonthLength(n,a){const{month:h,year:p}=n,_=this.getMonthCode(p,h),v=Object.entries(this.months).find(C=>C[1].monthCode===_);if(v===void 0)throw new RangeError(`unmatched Hebrew month: ${h}`);const c=v[1].days;return typeof c=="number"?c:c[a]}maxLengthOfMonthCodeInAnyYear(n){return["M04","M06","M08","M10","M12"].includes(n)?29:30}estimateIsoDate(n){const{year:a}=n;return{year:a-3760,month:1,day:1}}getMonthCode(n,a){return this.inLeapYear({year:n})?a===6?Mu(5,!0):Mu(a<6?a:a-1):Mu(a)}adjustCalendarDate(n,a,h="constrain",p=!1){let{year:_,month:v,monthCode:c,day:C,monthExtra:k}=n;if(_===void 0)throw new TypeError("Missing property: year");if(p){if(k){const P=this.months[k];if(!P)throw new RangeError(`Unrecognized month from formatToParts: ${k}`);v=this.inLeapYear({year:_})?P.leap:P.regular}return c=this.getMonthCode(_,v),{year:_,month:v,day:C,monthCode:c}}if(this.validateCalendarDate(n),v===void 0)if(c.endsWith("L")){if(c!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${c}`);if(v=6,!this.inLeapYear({year:_})){if(h==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${_} which is not a leap year`);v=6,c="M06"}}else{v=zp(c),this.inLeapYear({year:_})&&v>=6&&v++;const P=this.monthsInYear({year:_});if(v<1||v>P)throw new RangeError(`Invalid monthCode: ${c}`)}else if(h==="reject"?(xa(v,1,this.monthsInYear({year:_})),xa(C,1,this.maximumMonthLength({year:_,month:v}))):(v=Rs(v,1,this.monthsInYear({year:_})),C=Rs(C,1,this.maximumMonthLength({year:_,month:v}))),c===void 0)c=this.getMonthCode(_,v);else if(this.getMonthCode(_,v)!==c)throw new RangeError(`monthCode ${c} doesn't correspond to month ${v} in Hebrew year ${_}`);return{...n,day:C,month:v,monthCode:c,year:_}}}class Sg extends Fp{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425}inLeapYear(n,a){const h={year:n.year,month:1,monthCode:"M01",day:1},p={year:n.year+1,month:1,monthCode:"M01",day:1};return this.calendarDaysUntil(h,p,a)===355}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(){return 30}estimateIsoDate(n){const{year:a}=this.adjustCalendarDate(n);return{year:Math.floor(a*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class jR extends Sg{constructor(){super(...arguments),this.id="islamic"}}class BR extends Sg{constructor(){super(...arguments),this.id="islamic-umalqura"}}class FR extends Sg{constructor(){super(...arguments),this.id="islamic-tbla"}}class UR extends Sg{constructor(){super(...arguments),this.id="islamic-civil"}}class VR extends Sg{constructor(){super(...arguments),this.id="islamic-rgsa"}}class ZR extends Sg{constructor(){super(...arguments),this.id="islamicc"}}class GR extends Fp{constructor(){super(...arguments),this.id="persian",this.calendarType="solar"}inLeapYear(n,a){return this.daysInMonth({year:n.year,month:12,day:1},a)===30}monthsInYear(){return 12}minimumMonthLength(n){const{month:a}=n;return a===12?29:a<=6?31:30}maximumMonthLength(n){const{month:a}=n;return a===12?30:a<=6?31:30}maxLengthOfMonthCodeInAnyYear(n){return zp(n)<=6?31:30}estimateIsoDate(n){const{year:a}=this.adjustCalendarDate(n);return{year:a+621,month:1,day:1}}}class $R extends Fp{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(n){return Lb(n.year+78)}monthsInYear(){return 12}minimumMonthLength(n){return this.getMonthInfo(n).length}maximumMonthLength(n){return this.getMonthInfo(n).length}maxLengthOfMonthCodeInAnyYear(n){const a=zp(n);let h=this.months[a];return h=h.leap??h,h.length}getMonthInfo(n){const{month:a}=n;let h=this.months[a];if(h===void 0)throw new RangeError(`Invalid month: ${a}`);return this.inLeapYear(n)&&h.leap&&(h=h.leap),h}estimateIsoDate(n){const a=this.adjustCalendarDate(n),h=this.getMonthInfo(a);return _o(a.year+78+(h.nextYear?1:0),h.month,h.day+a.day-1)}checkIcuBugs(n){if(this.vulnerableToBceBug&&n.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function Lb(i){return i%4==0&&(i%100!=0||i%400==0)}class UE extends Fp{constructor(n,a){super(),this.calendarType="solar",this.id=n,this.isoEpoch=a}inLeapYear(n){const{year:a}=this.estimateIsoDate({month:1,day:1,year:n.year});return Lb(a)}monthsInYear(){return 12}minimumMonthLength(n){const{month:a}=n;return a===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(a)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][zp(n)-1]}estimateIsoDate(n){const a=this.adjustCalendarDate(n);return Xy(a.year+this.isoEpoch.year,a.month+this.isoEpoch.month,a.day+this.isoEpoch.day,"constrain")}}class VE extends Fp{constructor(n,a){super(),this.hasEra=!0,this.calendarType="solar",this.id=n;const{eras:h,anchorEra:p}=function(_){let v,c=_;if(c.length===0)throw new RangeError("Invalid era data: eras are required");if(c.length===1&&c[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(c.length===1&&!c[0].code)throw new RangeError("Invalid era data: at least one named era is required");if(c.filter(k=>k.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");c.forEach(k=>{if(k.isAnchor||!k.anchorEpoch&&!k.reverseOf){if(v)throw new RangeError("Invalid era data: cannot have multiple anchor eras");v=k,k.anchorEpoch={year:k.hasYearZero?0:1}}else if(!k.code)throw new RangeError("If era name is blank, it must be the anchor era")}),c=c.filter(k=>k.code),c.forEach(k=>{const{reverseOf:P}=k;if(P){const j=c.find(U=>U.code===P);if(j===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${P}`);k.reverseOf=j,k.anchorEpoch=j.anchorEpoch,k.isoEpoch=j.isoEpoch}k.anchorEpoch.month===void 0&&(k.anchorEpoch.month=1),k.anchorEpoch.day===void 0&&(k.anchorEpoch.day=1)}),c.sort((k,P)=>{if(k.reverseOf)return 1;if(P.reverseOf)return-1;if(!k.isoEpoch||!P.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return P.isoEpoch.year-k.isoEpoch.year});const C=c[c.length-1].reverseOf;if(C&&C!==c[c.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return c.forEach((k,P)=>{k.genericName="era"+(c.length-1-P)}),{eras:c,anchorEra:v||c[0]}}(a);this.anchorEra=p,this.eras=h}inLeapYear(n){const{year:a}=this.estimateIsoDate({month:1,day:1,year:n.year});return Lb(a)}monthsInYear(){return 12}minimumMonthLength(n){const{month:a}=n;return a===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(a)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][zp(n)-1]}completeEraYear(n){const a=(c,C,k)=>{const P=n[c];if(P!=null&&P!=C&&!(k||[]).includes(P)){const j=k==null?void 0:k[0];throw new RangeError(`Input ${c} ${P} doesn't match calculated value ${j?`${C} (also called ${j})`:C}`)}},h=c=>{let C;const k={...n,year:c},P=this.eras.find((j,U)=>{if(U===this.eras.length-1){if(j.reverseOf){if(c>0)throw new RangeError(`Signed year ${c} is invalid for era ${j.code}`);return C=j.anchorEpoch.year-c,!0}return C=c-j.anchorEpoch.year+(j.hasYearZero?0:1),!0}return this.compareCalendarDates(k,j.anchorEpoch)>=0&&(C=c-j.anchorEpoch.year+(j.hasYearZero?0:1),!0)});if(!P)throw new RangeError(`Year ${c} was not matched by any era`);return{eraYear:C,era:P.code,eraNames:P.names}};let{year:p,eraYear:_,era:v}=n;if(p!=null){const c=h(p);({eraYear:_,era:v}=c),a("era",v,c==null?void 0:c.eraNames),a("eraYear",_)}else{if(_==null)throw new RangeError("Either year or eraYear and era are required");{if(v===void 0)throw new RangeError("era and eraYear must be provided together");const c=this.eras.find(({code:C,names:k=[]})=>C===v||k.includes(v));if(!c)throw new RangeError(`Era ${v} (ISO year ${_}) was not matched by any era`);p=c.reverseOf?c.anchorEpoch.year-_:_+c.anchorEpoch.year-(c.hasYearZero?0:1),a("year",p),{eraYear:_,era:v}=h(p)}}return{...n,year:p,eraYear:_,era:v}}adjustCalendarDate(n,a,h="constrain"){let p=n;const{month:_,monthCode:v}=p;return _===void 0&&(p={...p,month:zp(v)}),this.validateCalendarDate(p),p=this.completeEraYear(p),super.adjustCalendarDate(p,a,h)}estimateIsoDate(n){const a=this.adjustCalendarDate(n),{year:h,month:p,day:_}=a,{anchorEra:v}=this;return Xy(h+v.isoEpoch.year-(v.hasYearZero?0:1),p,_,"constrain")}}class Nb extends VE{constructor(n,a){super(n,a)}isoToCalendarDate(n){const{year:a,month:h,day:p}=n,_=Mu(h),v=a-this.anchorEra.isoEpoch.year+1;return this.completeEraYear({year:v,month:h,monthCode:_,day:p})}}const vu={inLeapYear(i){const{year:n}=i;return(n+1)%4==0},monthsInYear:()=>13,minimumMonthLength(i){const{month:n}=i;return n===13?this.inLeapYear(i)?6:5:30},maximumMonthLength(i){return this.minimumMonthLength(i)},maxLengthOfMonthCodeInAnyYear:i=>i==="M13"?6:30};class YR extends UE{constructor(n,a){super(n,a),this.inLeapYear=vu.inLeapYear,this.monthsInYear=vu.monthsInYear,this.minimumMonthLength=vu.minimumMonthLength,this.maximumMonthLength=vu.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=vu.maxLengthOfMonthCodeInAnyYear}}class ZE extends VE{constructor(n,a){super(n,a),this.inLeapYear=vu.inLeapYear,this.monthsInYear=vu.monthsInYear,this.minimumMonthLength=vu.minimumMonthLength,this.maximumMonthLength=vu.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=vu.maxLengthOfMonthCodeInAnyYear}}class qR extends YR{constructor(){super("ethioaa",{year:-5492,month:7,day:17})}}class HR extends ZE{constructor(){super("coptic",[{code:"coptic",isoEpoch:{year:284,month:8,day:29}},{code:"coptic-inverse",reverseOf:"coptic"}])}}class XR extends ZE{constructor(){super("ethiopic",[{code:"ethioaa",names:["ethiopic-amete-alem","mundi"],isoEpoch:{year:-5492,month:7,day:17}},{code:"ethiopic",names:["incar"],isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class WR extends Nb{constructor(){super("roc",[{code:"roc",names:["minguo"],isoEpoch:{year:1912,month:1,day:1}},{code:"roc-inverse",names:["before-roc"],reverseOf:"roc"}])}}class QR extends UE{constructor(){super("buddhist",{year:-543,month:1,day:1})}}class KR extends Nb{constructor(){super("gregory",[{code:"gregory",names:["ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"gregory-inverse",names:["be","bce"],reverseOf:"gregory"}])}reviseIntlEra(n){let{era:a,eraYear:h}=n;return a==="b"&&(a="gregory-inverse"),a==="a"&&(a="gregory"),{era:a,eraYear:h}}getFirstDayOfWeek(){return 1}getMinimalDaysInFirstWeek(){return 1}}class JR extends Nb{constructor(){super("japanese",[{code:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{code:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{code:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{code:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{code:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{code:"japanese",names:["japanese","gregory","ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"japanese-inverse",names:["japanese-inverse","gregory-inverse","bc","bce"],reverseOf:"japanese"}]),this.erasBeginMidYear=!0}reviseIntlEra(n,a){const{era:h,eraYear:p}=n,{year:_}=a;return this.eras.find(v=>v.code===h)?{era:h,eraYear:p}:_<1?{era:"japanese-inverse",eraYear:1-_}:{era:"japanese",eraYear:_}}}class GE extends Fp{constructor(){super(...arguments),this.calendarType="lunisolar"}inLeapYear(n,a){const h=this.getMonthList(n.year,a);return Object.entries(h).length===13}monthsInYear(n,a){return this.inLeapYear(n,a)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(n){return["M01L","M09L","M10L","M11L","M12L"].includes(n)?29:30}monthDaySearchStartYear(n,a){const h={M01L:[1651,1651],M02L:[1947,1765],M03L:[1966,1955],M04L:[1963,1944],M05L:[1971,1952],M06L:[1960,1941],M07L:[1968,1938],M08L:[1957,1718],M09L:[1832,1832],M10L:[1870,1870],M11L:[1814,1814],M12L:[1890,1890]}[n]??[1972,1972];return a<30?h[0]:h[1]}getMonthList(n,a){if(n===void 0)throw new TypeError("Missing year");const h=JSON.stringify({func:"getMonthList",calendarYear:n,id:this.id}),p=a.get(h);if(p)return p;const _=this.getFormatter(),v=(pe,Le)=>{const Qe=FE({isoYear:pe,isoMonth:2,isoDay:1}),He=new Date(Qe);He.setUTCDate(Le+1);const $e=_.formatToParts(He),ke=$e.find(Re=>Re.type==="month").value,Ze=+$e.find(Re=>Re.type==="day").value,nt=$e.find(Re=>Re.type==="relatedYear");let Ke;if(nt===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return Ke=+nt.value,{calendarMonthString:ke,calendarDay:Ze,calendarYearToVerify:Ke}};let c=17,{calendarMonthString:C,calendarDay:k,calendarYearToVerify:P}=v(n,c);C!=="1"&&(c+=29,{calendarMonthString:C,calendarDay:k}=v(n,c)),c-=k-5;const j={};let U,V,ie=1,me=!1;do({calendarMonthString:C,calendarDay:k,calendarYearToVerify:P}=v(n,c)),U&&(j[V].daysInMonth=U+30-k),P!==n?me=!0:(j[C]={monthIndex:ie++},c+=30),U=k,V=C;while(!me);return j[V].daysInMonth=U+30-k,a.set(h,j),j}estimateIsoDate(n){const{year:a,month:h}=n;return{year:a,month:h>=12?12:h+1,day:1}}adjustCalendarDate(n,a,h="constrain",p=!1){let{year:_,month:v,monthExtra:c,day:C,monthCode:k}=n;if(_===void 0)throw new TypeError("Missing property: year");if(p){if(c&&c!=="bis")throw new RangeError(`Unexpected leap month suffix: ${c}`);const P=Mu(v,c!==void 0),j=`${v}${c||""}`,U=this.getMonthList(_,a)[j];if(U===void 0)throw new RangeError(`Unmatched month ${j} in Chinese year ${_}`);return v=U.monthIndex,{year:_,month:v,day:C,monthCode:P}}if(this.validateCalendarDate(n),v===void 0){const P=this.getMonthList(_,a);let j=k.replace(/^M|L$/g,V=>V==="L"?"bis":"");j[0]==="0"&&(j=j.slice(1));let U=P[j];if(v=U&&U.monthIndex,v===void 0&&k.endsWith("L")&&k!="M13L"&&h==="constrain"){const V=+k.replace(/^M0?|L$/g,"");U=P[V],U&&(v=U.monthIndex,k=Mu(V))}if(v===void 0)throw new RangeError(`Unmatched month ${k} in Chinese year ${_}`)}else if(k===void 0){const P=this.getMonthList(_,a),j=Object.entries(P),U=j.length;h==="reject"?(xa(v,1,U),xa(C,1,this.maximumMonthLength())):(v=Rs(v,1,U),C=Rs(C,1,this.maximumMonthLength()));const V=j.find(ie=>ie[1].monthIndex===v);if(V===void 0)throw new RangeError(`Invalid month ${v} in Chinese year ${_}`);k=Mu(+V[0].replace("bis",""),V[0].indexOf("bis")!==-1)}else{const P=this.getMonthList(_,a);let j=k.replace(/^M|L$/g,V=>V==="L"?"bis":"");j[0]==="0"&&(j=j.slice(1));const U=P[j];if(!U)throw new RangeError(`Unmatched monthCode ${k} in Chinese year ${_}`);if(v!==U.monthIndex)throw new RangeError(`monthCode ${k} doesn't correspond to month ${v} in Chinese year ${_}`)}return{...n,year:_,month:v,monthCode:k,day:C}}}class e3 extends GE{constructor(){super(...arguments),this.id="chinese"}}class t3 extends GE{constructor(){super(...arguments),this.id="dangi"}}class n3{constructor(n){this.helper=n}extraFields(n){return this.helper.hasEra&&n.includes("year")?["era","eraYear"]:[]}resolveFields(n){if(this.helper.calendarType!=="lunisolar"){const a=new _a;zb(n,void 0,this.helper.monthsInYear({year:n.year??1972},a))}}dateToISO(n,a){const h=new _a,p=this.helper.calendarToIsoDate(n,a,h);return h.setObject(p),p}monthDayToISOReferenceDate(n,a){const h=new _a,p=this.helper.monthDayFromFields(n,a,h);return h.setObject(p),p}fieldKeysToIgnore(n){const a=new Set;for(let h=0;h<n.length;h++){const p=n[h];switch(a.add(p),p){case"era":a.add("eraYear"),a.add("year");break;case"eraYear":a.add("era"),a.add("year");break;case"year":a.add("era"),a.add("eraYear");break;case"month":a.add("monthCode"),this.helper.erasBeginMidYear&&(a.add("era"),a.add("eraYear"));break;case"monthCode":a.add("month"),this.helper.erasBeginMidYear&&(a.add("era"),a.add("eraYear"));break;case"day":this.helper.erasBeginMidYear&&(a.add("era"),a.add("eraYear"))}}return jE(a)}dateAdd(n,{years:a,months:h,weeks:p,days:_},v){const c=_a.getCacheForObject(n),C=this.helper.isoToCalendarDate(n,c),k=this.helper.addCalendar(C,{years:a,months:h,weeks:p,days:_},v,c),P=this.helper.calendarToIsoDate(k,"constrain",c);return _a.getCacheForObject(P)||new _a(c).setObject(P),P}dateUntil(n,a,h){const p=_a.getCacheForObject(n),_=_a.getCacheForObject(a),v=this.helper.isoToCalendarDate(n,p),c=this.helper.isoToCalendarDate(a,_);return this.helper.untilCalendar(v,c,h,p)}isoToDate(n,a){const h=_a.getCacheForObject(n),p=this.helper.isoToCalendarDate(n,h);if(a.dayOfWeek&&(p.dayOfWeek=L_.iso8601.isoToDate(n,{dayOfWeek:!0}).dayOfWeek),a.dayOfYear){const _=this.helper.startOfCalendarYear(p),v=this.helper.calendarDaysUntil(_,p,h);p.dayOfYear=v+1}if(a.weekOfYear&&(p.weekOfYear=BE(this.helper.id,n)),p.daysInWeek=7,a.daysInMonth&&(p.daysInMonth=this.helper.daysInMonth(p,h)),a.daysInYear){const _=this.helper.startOfCalendarYear(p),v=this.helper.addCalendar(_,{years:1},"constrain",h);p.daysInYear=this.helper.calendarDaysUntil(_,v,h)}return a.monthsInYear&&(p.monthsInYear=this.helper.monthsInYear(p,h)),a.inLeapYear&&(p.inLeapYear=this.helper.inLeapYear(p,h)),p}getFirstDayOfWeek(){return this.helper.getFirstDayOfWeek()}getMinimalDaysInFirstWeek(){return this.helper.getMinimalDaysInFirstWeek()}}for(const i of[OR,GR,XR,qR,HR,e3,t3,WR,$R,QR,KR,JR,jR,BR,FR,UR,VR,ZR]){const n=new i;L_[n.id]=new n3(n)}Px("calendarImpl",function(i){return L_[i]});const h_=Intl.DateTimeFormat;function $m(i,n){let a=ne(i,n);return typeof a=="function"&&(a=new h_(ne(i,tE),a(ne(i,Rx))),function(h,p,_){const v=pv(h);if(v===void 0)throw new TypeError("Missing slots for the given container");if(v[p]===void 0)throw new TypeError(`tried to reset ${p} which was not set`);v[p]=_}(i,n,a)),a}function Dy(i){return Ps(i,jp)}class d_{constructor(n=void 0,a=void 0){(function(h,p,_){const v=_!==void 0;let c;if(v){const j=["localeMatcher","calendar","numberingSystem","hour12","hourCycle","timeZone","weekday","era","year","month","day","dayPeriod","hour","minute","second","fractionalSecondDigits","timeZoneName","formatMatcher","dateStyle","timeStyle"];c=function(V){if(V==null)throw new TypeError(`Expected object not ${V}`);return Object(V)}(_);const U=Object.create(null);for(let V=0;V<j.length;V++){const ie=j[V];Object.prototype.hasOwnProperty.call(c,ie)&&(U[ie]=c[ie])}c=U}else c=Object.create(null);const C=new h_(p,c),k=C.resolvedOptions();if(Kh(h),v){const j=Object.assign(Object.create(null),k);for(const U in j)Object.prototype.hasOwnProperty.call(c,U)||delete j[U];j.hour12=c.hour12,j.hourCycle=c.hourCycle,Ln(h,Rx,j)}else Ln(h,Rx,c);Ln(h,tE,k.locale),Ln(h,jp,C),Ln(h,Hm,k.timeZone),Ln(h,Ny,k.calendar),Ln(h,XT,h3),Ln(h,WT,c3),Ln(h,QT,u3),Ln(h,KT,l3),Ln(h,JT,d3),Ln(h,eE,f3);const P=v?c.timeZone:void 0;if(P===void 0)Ln(h,Ix,k.timeZone);else{const j=_v(P);if(j.startsWith(""))throw new RangeError("Unicode minus (U+2212) is not supported in time zone offsets");Ln(h,Ix,Ls(j))}})(this,n,a)}get format(){lt(this,Dy);const n=r3.bind(this);return Object.defineProperties(n,{length:{value:1,enumerable:!1,writable:!1,configurable:!0},name:{value:"",enumerable:!1,writable:!1,configurable:!0}}),n}formatRange(n,a){return lt(this,Dy),s3.call(this,n,a)}formatToParts(n,...a){return lt(this,Dy),a3.call(this,n,...a)}formatRangeToParts(n,a){return lt(this,Dy),o3.call(this,n,a)}resolvedOptions(){return lt(this,Dy),i3.call(this)}}"formatToParts"in h_.prototype||delete d_.prototype.formatToParts,"formatRangeToParts"in h_.prototype||delete d_.prototype.formatRangeToParts;const Nl=function(i=void 0,n=void 0){return new d_(i,n)};function i3(){const i=ne(this,jp).resolvedOptions();return i.timeZone=ne(this,Ix),i}function r3(i,...n){let a,h,p=fg(i,this);return p.formatter?(a=p.formatter,h=[Fl(p.epochNs,"floor")]):(a=ne(this,jp),h=[i,...n]),a.format(...h)}function a3(i,...n){let a,h,p=fg(i,this);return p.formatter?(a=p.formatter,h=[Fl(p.epochNs,"floor")]):(a=ne(this,jp),h=[i,...n]),a.formatToParts(...h)}function s3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const a=tv(i),h=tv(n);let p,_=[a,h];if($h(a)!==$h(h))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");if($h(a)){if(!$E(a,h))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{epochNs:v,formatter:c}=fg(a,this),{epochNs:C,formatter:k}=fg(h,this);c&&(p=c,_=[Fl(v,"floor"),Fl(C,"floor")])}return p||(p=ne(this,jp)),p.formatRange(..._)}function o3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const a=tv(i),h=tv(n);let p,_=[a,h];if($h(a)!==$h(h))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");if($h(a)){if(!$E(a,h))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{epochNs:v,formatter:c}=fg(a,this),{epochNs:C,formatter:k}=fg(h,this);c&&(p=c,_=[Fl(v,"floor"),Fl(C,"floor")])}return p||(p=ne(this,jp)),p.formatRangeToParts(..._)}function N_(i={},n={}){const a=Object.assign({},i),h=["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"];for(let p=0;p<h.length;p++){const _=h[p];a[_]=_ in n?n[_]:a[_],a[_]!==!1&&a[_]!==void 0||delete a[_]}return a}function l3(i){const n=N_(i,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});if(n.timeStyle!=="long"&&n.timeStyle!=="full"||(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"})),!Mv(n)){if(P_(i))throw new TypeError(`cannot format Temporal.PlainTime with options [${Object.keys(i)}]`);Object.assign(n,{hour:"numeric",minute:"numeric",second:"numeric"})}return n}function c3(i){const n={short:{year:"2-digit",month:"numeric"},medium:{year:"numeric",month:"short"},long:{year:"numeric",month:"long"},full:{year:"numeric",month:"long"}},a=N_(i,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in a&&a.dateStyle){const h=a.dateStyle;delete a.dateStyle,Object.assign(a,n[h])}if(!("year"in a||"month"in a||"era"in a)){if(P_(i))throw new TypeError(`cannot format PlainYearMonth with options [${Object.keys(i)}]`);Object.assign(a,{year:"numeric",month:"numeric"})}return a}function u3(i){const n={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric"},long:{month:"long",day:"numeric"},full:{month:"long",day:"numeric"}},a=N_(i,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in a&&a.dateStyle){const h=a.dateStyle;delete a.dateStyle,Object.assign(a,n[h])}if(!("month"in a)&&!("day"in a)){if(P_(i))throw new TypeError(`cannot format PlainMonthDay with options [${Object.keys(i)}]`);Object.assign(a,{month:"numeric",day:"numeric"})}return a}function h3(i){const n=N_(i,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if(!Av(n)){if(P_(i))throw new TypeError(`cannot format PlainDate with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric"})}return n}function d3(i){const n=N_(i,{timeZoneName:!1});if((n.timeStyle==="long"||n.timeStyle==="full")&&(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"}),n.dateStyle)&&(Object.assign(n,{short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"long",day:"numeric"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long"}}[n.dateStyle]),delete n.dateStyle),!Mv(n)&&!Av(n)){if(P_(i))throw new TypeError(`cannot format PlainDateTime with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}return n}function f3(i){let n=i;return Mv(n)||Av(n)||(n=Object.assign({},n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),n}function Av(i){return"year"in i||"month"in i||"day"in i||"weekday"in i||"dateStyle"in i||"era"in i}function Mv(i){return"hour"in i||"minute"in i||"second"in i||"timeStyle"in i||"dayPeriod"in i||"fractionalSecondDigits"in i}function P_(i){return Av(i)||Mv(i)||"dateStyle"in i||"timeStyle"in i||"timeZoneName"in i}function $h(i){return br(i)||Dr(i)||Qi(i)||On(i)||Na(i)||Yo(i)||La(i)}function tv(i){return $h(i)?i:yv(i)}function $E(i,n){return!(!$h(i)||!$h(n)||Dr(i)&&!Dr(n)||br(i)&&!br(n)||Qi(i)&&!Qi(n)||On(i)&&!On(n)||Na(i)&&!Na(n)||Yo(i)&&!Yo(n)||La(i)&&!La(n))}function fg(i,n){if(Dr(i)){const a={isoDate:{year:1970,month:1,day:1},time:ne(i,wr)};return{epochNs:ns(ne(n,Hm),a,"compatible"),formatter:$m(n,KT)}}if(Na(i)){const a=ne(i,Dt),h=ne(n,Ny);if(a!==h)throw new RangeError(`cannot format PlainYearMonth with calendar ${a} in locale with calendar ${h}`);const p=ti(ne(i,gn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:ns(ne(n,Hm),p,"compatible"),formatter:$m(n,WT)}}if(Yo(i)){const a=ne(i,Dt),h=ne(n,Ny);if(a!==h)throw new RangeError(`cannot format PlainMonthDay with calendar ${a} in locale with calendar ${h}`);const p=ti(ne(i,gn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:ns(ne(n,Hm),p,"compatible"),formatter:$m(n,QT)}}if(br(i)){const a=ne(i,Dt),h=ne(n,Ny);if(a!=="iso8601"&&a!==h)throw new RangeError(`cannot format PlainDate with calendar ${a} in locale with calendar ${h}`);const p=ti(ne(i,gn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:ns(ne(n,Hm),p,"compatible"),formatter:$m(n,XT)}}if(Qi(i)){const a=ne(i,Dt),h=ne(n,Ny);if(a!=="iso8601"&&a!==h)throw new RangeError(`cannot format PlainDateTime with calendar ${a} in locale with calendar ${h}`);const p=ne(i,ir);return{epochNs:ns(ne(n,Hm),p,"compatible"),formatter:$m(n,JT)}}if(On(i))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return La(i)?{epochNs:ne(i,mn),formatter:$m(n,eE)}:{}}function YE(i){const n=Object.create(null);return n.years=ne(i,Es),n.months=ne(i,Ss),n.weeks=ne(i,ho),n.days=ne(i,As),n.hours=ne(i,Ms),n.minutes=ne(i,Cs),n.seconds=ne(i,Ds),n.milliseconds=ne(i,ks),n.microseconds=ne(i,Is),n.nanoseconds=ne(i,fo),n}d_.prototype.constructor=Nl,Object.defineProperty(Nl,"prototype",{value:d_.prototype,writable:!1,enumerable:!1,configurable:!1}),Nl.supportedLocalesOf=h_.supportedLocalesOf,Jh(Nl,"Intl.DateTimeFormat");var Gw;const{format:p3,formatToParts:m3}=((Gw=Intl.DurationFormat)==null?void 0:Gw.prototype)??Object.create(null);function qE(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=YE(Pl(i));return p3.call(this,n)}var $w;($w=Intl.DurationFormat)!=null&&$w.prototype&&(Intl.DurationFormat.prototype.format=qE,Intl.DurationFormat.prototype.formatToParts=function(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=YE(Pl(i));return m3.call(this,n)});class Pb{constructor(n){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");xE(this,ev(n))}get epochMilliseconds(){return lt(this,La),Fl(ne(this,mn),"floor")}get epochNanoseconds(){return lt(this,La),PE(Q.BigInt(ne(this,mn)))}add(n){return lt(this,La),Nw("add",this,n)}subtract(n){return lt(this,La),Nw("subtract",this,n)}until(n,a=void 0){return lt(this,La),Cw("until",this,n,a)}since(n,a=void 0){return lt(this,La),Cw("since",this,n,a)}round(n){if(lt(this,La),n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Rp("smallestUnit",n):rn(n),h=bg(a),p=jc(a,"halfExpand"),_=mo(a,"smallestUnit","time",Xh);return wg(h,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[_],!0),wu(Yx(ne(this,mn),h,_,p))}equals(n){lt(this,La);const a=jy(n),h=ne(this,mn),p=ne(a,mn);return Q.equal(Q.BigInt(h),Q.BigInt(p))}toString(n=void 0){lt(this,La);const a=rn(n),h=A_(a),p=jc(a,"trunc"),_=mo(a,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let v=a.timeZone;v!==void 0&&(v=Ls(v));const{precision:c,unit:C,increment:k}=M_(_,h);return vw(wu(Yx(ne(this,mn),k,C,p)),v,c)}toJSON(){return lt(this,La),vw(this,void 0,"auto")}toLocaleString(n=void 0,a=void 0){return lt(this,La),new Nl(n,a).format(this)}valueOf(){yf("Instant")}toZonedDateTimeISO(n){lt(this,La);const a=Ls(n);return es(ne(this,mn),a,"iso8601")}static fromEpochMilliseconds(n){return wu(Eu(yv(n)))}static fromEpochNanoseconds(n){return wu(ev(n))}static from(n){return jy(n)}static compare(n,a){const h=jy(n),p=jy(a),_=ne(h,mn),v=ne(p,mn);return Q.lessThan(_,v)?-1:Q.greaterThan(_,v)?1:0}}Jh(Pb,"Temporal.Instant");class Ob{constructor(n,a,h,p="iso8601"){const _=wn(n),v=wn(a),c=wn(h),C=Os(p===void 0?"iso8601":aa(p));Dp(_,v,c),mE(this,{year:_,month:v,day:c},C)}get calendarId(){return lt(this,br),ne(this,Dt)}get era(){return xs(this,"era")}get eraYear(){return xs(this,"eraYear")}get year(){return xs(this,"year")}get month(){return xs(this,"month")}get monthCode(){return xs(this,"monthCode")}get day(){return xs(this,"day")}get dayOfWeek(){return xs(this,"dayOfWeek")}get dayOfYear(){return xs(this,"dayOfYear")}get weekOfYear(){var n;return(n=xs(this,"weekOfYear"))==null?void 0:n.week}get yearOfWeek(){var n;return(n=xs(this,"weekOfYear"))==null?void 0:n.year}get daysInWeek(){return xs(this,"daysInWeek")}get daysInMonth(){return xs(this,"daysInMonth")}get daysInYear(){return xs(this,"daysInYear")}get monthsInYear(){return xs(this,"monthsInYear")}get inLeapYear(){return xs(this,"inLeapYear")}with(n,a=void 0){if(lt(this,br),!Tr(n))throw new TypeError("invalid argument");xg(n);const h=ne(this,Dt);let p=Ns(h,ne(this,gn));return p=Cp(h,p,Jo(h,n,["year","month","monthCode","day"],[],"partial")),zs(df(h,p,Kn(rn(a))),h)}withCalendar(n){lt(this,br);const a=I_(n);return zs(ne(this,gn),a)}add(n,a=void 0){return lt(this,br),Pw("add",this,n,a)}subtract(n,a=void 0){return lt(this,br),Pw("subtract",this,n,a)}until(n,a=void 0){return lt(this,br),Dw("until",this,n,a)}since(n,a=void 0){return lt(this,br),Dw("since",this,n,a)}equals(n){lt(this,br);const a=Py(n);return ku(ne(this,gn),ne(a,gn))===0&&Cu(ne(this,Dt),ne(a,Dt))}toString(n=void 0){return lt(this,br),xw(this,S_(rn(n)))}toJSON(){return lt(this,br),xw(this)}toLocaleString(n=void 0,a=void 0){return lt(this,br),new Nl(n,a).format(this)}valueOf(){yf("PlainDate")}toPlainDateTime(n=void 0){lt(this,br);const a=pE(n);return zl(ti(ne(this,gn),a),ne(this,Dt))}toZonedDateTime(n){let a,h;if(lt(this,br),Tr(n)){const v=n.timeZone;v===void 0?a=Ls(n):(a=Ls(v),h=n.plainTime)}else a=Ls(n);const p=ne(this,gn);let _;return h===void 0?_=tf(a,p):(h=rf(h),_=ns(a,ti(p,ne(h,wr)),"compatible")),es(_,a,ne(this,Dt))}toPlainYearMonth(){lt(this,br);const n=ne(this,Dt);return eg(s_(n,Ns(n,ne(this,gn)),"constrain"),n)}toPlainMonthDay(){lt(this,br);const n=ne(this,Dt);return Qm(X0(n,Ns(n,ne(this,gn)),"constrain"),n)}static from(n,a=void 0){return Py(n,a)}static compare(n,a){const h=Py(n),p=Py(a);return ku(ne(h,gn),ne(p,gn))}}function xs(i,n){lt(i,br);const a=ne(i,gn);return C_(i).isoToDate(a,{[n]:!0})[n]}Jh(Ob,"Temporal.PlainDate");class jb{constructor(n,a,h,p=0,_=0,v=0,c=0,C=0,k=0,P="iso8601"){const j=wn(n),U=wn(a),V=wn(h),ie=p===void 0?0:wn(p),me=_===void 0?0:wn(_),pe=v===void 0?0:wn(v),Le=c===void 0?0:wn(c),Qe=C===void 0?0:wn(C),He=k===void 0?0:wn(k),$e=Os(P===void 0?"iso8601":aa(P));Db(j,U,V,ie,me,pe,Le,Qe,He),gE(this,{isoDate:{year:j,month:U,day:V},time:{hour:ie,minute:me,second:pe,millisecond:Le,microsecond:Qe,nanosecond:He}},$e)}get calendarId(){return lt(this,Qi),ne(this,Dt)}get year(){return bs(this,"year")}get month(){return bs(this,"month")}get monthCode(){return bs(this,"monthCode")}get day(){return bs(this,"day")}get hour(){return Ym(this,"hour")}get minute(){return Ym(this,"minute")}get second(){return Ym(this,"second")}get millisecond(){return Ym(this,"millisecond")}get microsecond(){return Ym(this,"microsecond")}get nanosecond(){return Ym(this,"nanosecond")}get era(){return bs(this,"era")}get eraYear(){return bs(this,"eraYear")}get dayOfWeek(){return bs(this,"dayOfWeek")}get dayOfYear(){return bs(this,"dayOfYear")}get weekOfYear(){var n;return(n=bs(this,"weekOfYear"))==null?void 0:n.week}get yearOfWeek(){var n;return(n=bs(this,"weekOfYear"))==null?void 0:n.year}get daysInWeek(){return bs(this,"daysInWeek")}get daysInYear(){return bs(this,"daysInYear")}get daysInMonth(){return bs(this,"daysInMonth")}get monthsInYear(){return bs(this,"monthsInYear")}get inLeapYear(){return bs(this,"inLeapYear")}with(n,a=void 0){if(lt(this,Qi),!Tr(n))throw new TypeError("invalid argument");xg(n);const h=ne(this,Dt),p=ne(this,ir);let _={...Ns(h,p.isoDate),...p.time};return _=Cp(h,_,Jo(h,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],"partial")),zl(D_(h,_,Kn(rn(a))),h)}withPlainTime(n=void 0){lt(this,Qi);const a=pE(n);return zl(ti(ne(this,ir).isoDate,a),ne(this,Dt))}withCalendar(n){lt(this,Qi);const a=I_(n);return zl(ne(this,ir),a)}add(n,a=void 0){return lt(this,Qi),Ow("add",this,n,a)}subtract(n,a=void 0){return lt(this,Qi),Ow("subtract",this,n,a)}until(n,a=void 0){return lt(this,Qi),kw("until",this,n,a)}since(n,a=void 0){return lt(this,Qi),kw("since",this,n,a)}round(n){if(lt(this,Qi),n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Rp("smallestUnit",n):rn(n),h=bg(a),p=jc(a,"halfExpand"),_=mo(a,"smallestUnit","time",Xh,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];wg(h,v,v===1);const c=ne(this,ir);return zl(h===1&&_==="nanosecond"?c:qx(c,h,_,p),ne(this,Dt))}equals(n){lt(this,Qi);const a=Oy(n);return dg(ne(this,ir),ne(a,ir))===0&&Cu(ne(this,Dt),ne(a,Dt))}toString(n=void 0){lt(this,Qi);const a=rn(n),h=S_(a),p=A_(a),_=jc(a,"trunc"),v=mo(a,"smallestUnit","time",void 0);if(v==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:c,unit:C,increment:k}=M_(v,p),P=qx(ne(this,ir),k,C,_);return kp(P),l_(P,ne(this,Dt),c,h)}toJSON(){return lt(this,Qi),l_(ne(this,ir),ne(this,Dt),"auto")}toLocaleString(n=void 0,a=void 0){return lt(this,Qi),new Nl(n,a).format(this)}valueOf(){yf("PlainDateTime")}toZonedDateTime(n,a=void 0){lt(this,Qi);const h=Ls(n),p=Wy(rn(a));return es(ns(h,ne(this,ir),p),h,ne(this,Dt))}toPlainDate(){return lt(this,Qi),zs(ne(this,ir).isoDate,ne(this,Dt))}toPlainTime(){return lt(this,Qi),Ph(ne(this,ir).time)}static from(n,a=void 0){return Oy(n,a)}static compare(n,a){const h=Oy(n),p=Oy(a);return dg(ne(h,ir),ne(p,ir))}}function bs(i,n){lt(i,Qi);const a=ne(i,ir).isoDate;return C_(i).isoToDate(a,{[n]:!0})[n]}function Ym(i,n){return lt(i,Qi),ne(i,ir).time[n]}Jh(jb,"Temporal.PlainDateTime");class pg{constructor(n=0,a=0,h=0,p=0,_=0,v=0,c=0,C=0,k=0,P=0){const j=n===void 0?0:Lc(n),U=a===void 0?0:Lc(a),V=h===void 0?0:Lc(h),ie=p===void 0?0:Lc(p),me=_===void 0?0:Lc(_),pe=v===void 0?0:Lc(v),Le=c===void 0?0:Lc(c),Qe=C===void 0?0:Lc(C),He=k===void 0?0:Lc(k),$e=P===void 0?0:Lc(P);Ev(j,U,V,ie,me,pe,Le,Qe,He,$e),Kh(this),Ln(this,Es,j),Ln(this,Ss,U),Ln(this,ho,V),Ln(this,As,ie),Ln(this,Ms,me),Ln(this,Cs,pe),Ln(this,Ds,Le),Ln(this,ks,Qe),Ln(this,Is,He),Ln(this,fo,$e)}get years(){return lt(this,xr),ne(this,Es)}get months(){return lt(this,xr),ne(this,Ss)}get weeks(){return lt(this,xr),ne(this,ho)}get days(){return lt(this,xr),ne(this,As)}get hours(){return lt(this,xr),ne(this,Ms)}get minutes(){return lt(this,xr),ne(this,Cs)}get seconds(){return lt(this,xr),ne(this,Ds)}get milliseconds(){return lt(this,xr),ne(this,ks)}get microseconds(){return lt(this,xr),ne(this,Is)}get nanoseconds(){return lt(this,xr),ne(this,fo)}get sign(){return lt(this,xr),K0(this)}get blank(){return lt(this,xr),K0(this)===0}with(n){lt(this,xr);const a=fE(n),{years:h=ne(this,Es),months:p=ne(this,Ss),weeks:_=ne(this,ho),days:v=ne(this,As),hours:c=ne(this,Ms),minutes:C=ne(this,Cs),seconds:k=ne(this,Ds),milliseconds:P=ne(this,ks),microseconds:j=ne(this,Is),nanoseconds:U=ne(this,fo)}=a;return new pg(h,p,_,v,c,C,k,P,j,U)}negated(){return lt(this,xr),vo(this)}abs(){return lt(this,xr),new pg(Math.abs(ne(this,Es)),Math.abs(ne(this,Ss)),Math.abs(ne(this,ho)),Math.abs(ne(this,As)),Math.abs(ne(this,Ms)),Math.abs(ne(this,Cs)),Math.abs(ne(this,Ds)),Math.abs(ne(this,ks)),Math.abs(ne(this,Is)),Math.abs(ne(this,fo)))}add(n){return lt(this,xr),Lw("add",this,n)}subtract(n){return lt(this,xr),Lw("subtract",this,n)}round(n){if(lt(this,xr),n===void 0)throw new TypeError("options parameter is required");const a=zh(this),h=typeof n=="string"?Rp("smallestUnit",n):rn(n);let p=mo(h,"largestUnit","datetime",void 0,["auto"]),{plainRelativeTo:_,zonedRelativeTo:v}=ox(h);const c=bg(h),C=jc(h,"halfExpand");let k=mo(h,"smallestUnit","datetime",void 0),P=!0;k||(P=!1,k="nanosecond");const j=Vh(a,k);let U=!0;if(p||(U=!1,p=j),p==="auto"&&(p=j),!P&&!U)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(Vh(p,k)!==p)throw new RangeError(`largestUnit ${p} cannot be smaller than smallestUnit ${k}`);const V={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[k];if(V!==void 0&&wg(c,V,!1),c>1&&Lh(k)==="date"&&p!==k)throw new RangeError("For calendar units with roundingIncrement > 1, use largestUnit = smallestUnit");if(v){let me=Xm(this);const pe=ne(v,pi),Le=ne(v,Dt),Qe=ne(v,mn);return me=NE(Qe,Uy(Qe,pe,Le,me),pe,Le,p,c,k,C),Lh(p)==="date"&&(p="hour"),Ll(me,p)}if(_){let me=Tu(this);const pe=hg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},me.time),Le=ne(_,gn),Qe=ne(_,Dt),He=Xo(Qe,Le,ts(me.date,pe.deltaDays),"constrain");return me=LE(ti(Le,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),ti(He,pe),Qe,p,c,k,C),Ll(me,p)}if(yu(a))throw new RangeError(`a starting point is required for ${a}s balancing`);if(yu(p))throw new RangeError(`a starting point is required for ${p}s balancing`);let ie=Tu(this);if(k==="day"){const{quotient:me,remainder:pe}=ie.time.divmod(Y0);let Le=ie.date.days+me+Qy(pe,"day");Le=af(Le,c,C),ie=Zh({years:0,months:0,weeks:0,days:Le},jn.ZERO)}else ie=Zh({years:0,months:0,weeks:0,days:0},J0(ie.time,c,k,C));return Ll(ie,p)}total(n){if(lt(this,xr),n===void 0)throw new TypeError("options argument is required");const a=typeof n=="string"?Rp("unit",n):rn(n);let{plainRelativeTo:h,zonedRelativeTo:p}=ox(a);const _=mo(a,"unit","datetime",Xh);if(p){const c=Xm(this),C=ne(p,pi),k=ne(p,Dt),P=ne(p,mn);return function(j,U,V,ie,me){return Lh(me)==="time"?Qy(jn.fromEpochNsDiff(U,j),me):Mw(RE(j,U,V,ie,me),U,Bl(V,j),V,ie,me)}(P,Uy(P,C,k,c),C,k,_)}if(h){const c=Tu(this);let C=hg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},c.time);const k=ne(h,gn),P=ne(h,Dt),j=Xo(P,k,ts(c.date,C.deltaDays),"constrain");return function(U,V,ie,me){if(dg(U,V)==0)return 0;kp(U),kp(V);const pe=IE(U,V,ie,me);return me==="nanosecond"?Q.toNumber(pe.time.totalNs):Mw(pe,Pa(V),U,null,ie,me)}(ti(k,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),ti(j,C),P,_)}const v=zh(this);if(yu(v))throw new RangeError(`a starting point is required for ${v}s total`);if(yu(_))throw new RangeError(`a starting point is required for ${_}s total`);return Qy(Tu(this).time,_)}toString(n=void 0){lt(this,xr);const a=rn(n),h=A_(a),p=jc(a,"trunc"),_=mo(a,"smallestUnit","time",void 0);if(_==="hour"||_==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:v,unit:c,increment:C}=M_(_,h);if(c==="nanosecond"&&C===1)return D0(this,v);const k=zh(this);let P=Xm(this);const j=J0(P.time,C,c,p);return P=Zh(P.date,j),D0(Ll(P,Vh(k,"second")),v)}toJSON(){return lt(this,xr),D0(this,"auto")}toLocaleString(n=void 0,a=void 0){if(lt(this,xr),typeof Intl.DurationFormat=="function"){const h=new Intl.DurationFormat(n,a);return qE.call(h,this)}return console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),D0(this,"auto")}valueOf(){yf("Duration")}static from(n){return Pl(n)}static compare(n,a,h=void 0){const p=Pl(n),_=Pl(a),v=rn(h),{plainRelativeTo:c,zonedRelativeTo:C}=ox(v);if(ne(p,Es)===ne(_,Es)&&ne(p,Ss)===ne(_,Ss)&&ne(p,ho)===ne(_,ho)&&ne(p,As)===ne(_,As)&&ne(p,Ms)===ne(_,Ms)&&ne(p,Cs)===ne(_,Cs)&&ne(p,Ds)===ne(_,Ds)&&ne(p,ks)===ne(_,ks)&&ne(p,Is)===ne(_,Is)&&ne(p,fo)===ne(_,fo))return 0;const k=zh(p),P=zh(_),j=Xm(p),U=Xm(_);if(C&&(Lh(k)==="date"||Lh(P)==="date")){const Le=ne(C,pi),Qe=ne(C,Dt),He=ne(C,mn),$e=Uy(He,Le,Qe,j),ke=Uy(He,Le,Qe,U);return po(Q.toNumber(Q.subtract($e,ke)))}let V=j.date.days,ie=U.date.days;if(yu(k)||yu(P)){if(!c)throw new RangeError("A starting point is required for years, months, or weeks comparison");V=Aw(j.date,c),ie=Aw(U.date,c)}const me=j.time.add24HourDays(V),pe=U.time.add24HourDays(ie);return me.cmp(pe)}}Jh(pg,"Temporal.Duration");class Bb{constructor(n,a,h="iso8601",p=1972){const _=wn(n),v=wn(a),c=Os(h===void 0?"iso8601":aa(h)),C=wn(p);Dp(C,_,v),yE(this,{year:C,month:_,day:v},c)}get monthCode(){return Vw(this,"monthCode")}get day(){return Vw(this,"day")}get calendarId(){return lt(this,Yo),ne(this,Dt)}with(n,a=void 0){if(lt(this,Yo),!Tr(n))throw new TypeError("invalid argument");xg(n);const h=ne(this,Dt);let p=Ns(h,ne(this,gn),"month-day");return p=Cp(h,p,Jo(h,n,["year","month","monthCode","day"],[],"partial")),Qm(X0(h,p,Kn(rn(a))),h)}equals(n){lt(this,Yo);const a=yw(n);return ku(ne(this,gn),ne(a,gn))===0&&Cu(ne(this,Dt),ne(a,Dt))}toString(n=void 0){return lt(this,Yo),ww(this,S_(rn(n)))}toJSON(){return lt(this,Yo),ww(this)}toLocaleString(n=void 0,a=void 0){return lt(this,Yo),new Nl(n,a).format(this)}valueOf(){yf("PlainMonthDay")}toPlainDate(n){if(lt(this,Yo),!Tr(n))throw new TypeError("argument should be an object");const a=ne(this,Dt);return zs(df(a,Cp(a,Ns(a,ne(this,gn),"month-day"),Jo(a,n,["year"],[],[])),"constrain"),a)}static from(n,a=void 0){return yw(n,a)}}function Vw(i,n){lt(i,Yo);const a=ne(i,gn);return C_(i).isoToDate(a,{[n]:!0})[n]}function cx(i){return Bl(i,Wx())}Jh(Bb,"Temporal.PlainMonthDay");const HE={instant:()=>wu(Wx()),plainDateTimeISO:(i=Cy())=>zl(cx(Ls(i)),"iso8601"),plainDateISO:(i=Cy())=>zs(cx(Ls(i)).isoDate,"iso8601"),plainTimeISO:(i=Cy())=>Ph(cx(Ls(i)).time),timeZoneId:()=>Cy(),zonedDateTimeISO:(i=Cy())=>{const n=Ls(i);return es(Wx(),n,"iso8601")},[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(HE,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});class O_{constructor(n=0,a=0,h=0,p=0,_=0,v=0){const c=n===void 0?0:wn(n),C=a===void 0?0:wn(a),k=h===void 0?0:wn(h),P=p===void 0?0:wn(p),j=_===void 0?0:wn(_),U=v===void 0?0:wn(v);Tv(c,C,k,P,j,U),_E(this,{hour:c,minute:C,second:k,millisecond:P,microsecond:j,nanosecond:U})}get hour(){return lt(this,Dr),ne(this,wr).hour}get minute(){return lt(this,Dr),ne(this,wr).minute}get second(){return lt(this,Dr),ne(this,wr).second}get millisecond(){return lt(this,Dr),ne(this,wr).millisecond}get microsecond(){return lt(this,Dr),ne(this,wr).microsecond}get nanosecond(){return lt(this,Dr),ne(this,wr).nanosecond}with(n,a=void 0){if(lt(this,Dr),!Tr(n))throw new TypeError("invalid argument");xg(n);const h=Fx(n,"partial"),p=Fx(this);let{hour:_,minute:v,second:c,millisecond:C,microsecond:k,nanosecond:P}=Object.assign(p,h);const j=Kn(rn(a));return{hour:_,minute:v,second:c,millisecond:C,microsecond:k,nanosecond:P}=xv(_,v,c,C,k,P,j),new O_(_,v,c,C,k,P)}add(n){return lt(this,Dr),jw("add",this,n)}subtract(n){return lt(this,Dr),jw("subtract",this,n)}until(n,a=void 0){return lt(this,Dr),Iw("until",this,n,a)}since(n,a=void 0){return lt(this,Dr),Iw("since",this,n,a)}round(n){if(lt(this,Dr),n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Rp("smallestUnit",n):rn(n),h=bg(a),p=jc(a,"halfExpand"),_=mo(a,"smallestUnit","time",Xh);return wg(h,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_],!1),Ph(Hx(ne(this,wr),h,_,p))}equals(n){lt(this,Dr);const a=rf(n);return Xx(ne(this,wr),ne(a,wr))===0}toString(n=void 0){lt(this,Dr);const a=rn(n),h=A_(a),p=jc(a,"trunc"),_=mo(a,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:v,unit:c,increment:C}=M_(_,h);return bw(Hx(ne(this,wr),C,c,p),v)}toJSON(){return lt(this,Dr),bw(ne(this,wr),"auto")}toLocaleString(n=void 0,a=void 0){return lt(this,Dr),new Nl(n,a).format(this)}valueOf(){yf("PlainTime")}static from(n,a=void 0){return rf(n,a)}static compare(n,a){const h=rf(n),p=rf(a);return Xx(ne(h,wr),ne(p,wr))}}Jh(O_,"Temporal.PlainTime");class Fb{constructor(n,a,h="iso8601",p=1){const _=wn(n),v=wn(a),c=Os(h===void 0?"iso8601":aa(h)),C=wn(p);Dp(_,v,C),vE(this,{year:_,month:v,day:C},c)}get year(){return kh(this,"year")}get month(){return kh(this,"month")}get monthCode(){return kh(this,"monthCode")}get calendarId(){return lt(this,Na),ne(this,Dt)}get era(){return kh(this,"era")}get eraYear(){return kh(this,"eraYear")}get daysInMonth(){return kh(this,"daysInMonth")}get daysInYear(){return kh(this,"daysInYear")}get monthsInYear(){return kh(this,"monthsInYear")}get inLeapYear(){return kh(this,"inLeapYear")}with(n,a=void 0){if(lt(this,Na),!Tr(n))throw new TypeError("invalid argument");xg(n);const h=ne(this,Dt);let p=Ns(h,ne(this,gn),"year-month");return p=Cp(h,p,Jo(h,n,["year","month","monthCode"],[],"partial")),eg(s_(h,p,Kn(rn(a))),h)}add(n,a=void 0){return lt(this,Na),Bw("add",this,n,a)}subtract(n,a=void 0){return lt(this,Na),Bw("subtract",this,n,a)}until(n,a=void 0){return lt(this,Na),Rw("until",this,n,a)}since(n,a=void 0){return lt(this,Na),Rw("since",this,n,a)}equals(n){lt(this,Na);const a=By(n);return ku(ne(this,gn),ne(a,gn))===0&&Cu(ne(this,Dt),ne(a,Dt))}toString(n=void 0){return lt(this,Na),Tw(this,S_(rn(n)))}toJSON(){return lt(this,Na),Tw(this)}toLocaleString(n=void 0,a=void 0){return lt(this,Na),new Nl(n,a).format(this)}valueOf(){yf("PlainYearMonth")}toPlainDate(n){if(lt(this,Na),!Tr(n))throw new TypeError("argument should be an object");const a=ne(this,Dt);return zs(df(a,Cp(a,Ns(a,ne(this,gn),"year-month"),Jo(a,n,["day"],[],[])),"constrain"),a)}static from(n,a=void 0){return By(n,a)}static compare(n,a){const h=By(n),p=By(a);return ku(ne(h,gn),ne(p,gn))}}function kh(i,n){lt(i,Na);const a=ne(i,gn);return C_(i).isoToDate(a,{[n]:!0})[n]}Jh(Fb,"Temporal.PlainYearMonth");const g3=Nl.prototype.resolvedOptions;class Ub{constructor(n,a,h="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const p=ev(n);let _=aa(a);const{tzName:v,offsetMinutes:c}=of(_);if(c===void 0){const C=W0(v);if(!C)throw new RangeError(`unknown time zone ${v}`);_=C.identifier}else _=Ab(c);bE(this,p,_,Os(h===void 0?"iso8601":aa(h)))}get calendarId(){return lt(this,On),ne(this,Dt)}get timeZoneId(){return lt(this,On),ne(this,pi)}get year(){return ws(this,"year")}get month(){return ws(this,"month")}get monthCode(){return ws(this,"monthCode")}get day(){return ws(this,"day")}get hour(){return qm(this,"hour")}get minute(){return qm(this,"minute")}get second(){return qm(this,"second")}get millisecond(){return qm(this,"millisecond")}get microsecond(){return qm(this,"microsecond")}get nanosecond(){return qm(this,"nanosecond")}get era(){return ws(this,"era")}get eraYear(){return ws(this,"eraYear")}get epochMilliseconds(){return lt(this,On),Fl(ne(this,mn),"floor")}get epochNanoseconds(){return lt(this,On),PE(ne(this,mn))}get dayOfWeek(){return ws(this,"dayOfWeek")}get dayOfYear(){return ws(this,"dayOfYear")}get weekOfYear(){var n;return(n=ws(this,"weekOfYear"))==null?void 0:n.week}get yearOfWeek(){var n;return(n=ws(this,"weekOfYear"))==null?void 0:n.year}get hoursInDay(){lt(this,On);const n=ne(this,pi),a=gu(this).isoDate,h=_o(a.year,a.month,a.day+1),p=tf(n,a),_=tf(n,h);return Qy(jn.fromEpochNsDiff(_,p),"hour")}get daysInWeek(){return ws(this,"daysInWeek")}get daysInMonth(){return ws(this,"daysInMonth")}get daysInYear(){return ws(this,"daysInYear")}get monthsInYear(){return ws(this,"monthsInYear")}get inLeapYear(){return ws(this,"inLeapYear")}get offset(){return lt(this,On),Ux(Oh(ne(this,pi),ne(this,mn)))}get offsetNanoseconds(){return lt(this,On),Oh(ne(this,pi),ne(this,mn))}with(n,a=void 0){if(lt(this,On),!Tr(n))throw new TypeError("invalid zoned-date-time-like");xg(n);const h=ne(this,Dt),p=ne(this,pi),_=Oh(p,ne(this,mn)),v=gu(this);let c={...Ns(h,v.isoDate),...v.time,offset:Ux(_)};c=Cp(h,c,Jo(h,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset"],"partial"));const C=rn(a),k=Wy(C),P=N0(C,"prefer"),j=D_(h,c,Kn(C)),U=Tg(c.offset);return es(H0(j.isoDate,j.time,"option",U,p,k,P,!1),p,h)}withPlainTime(n=void 0){lt(this,On);const a=ne(this,pi),h=ne(this,Dt),p=gu(this).isoDate;let _;return _=n===void 0?tf(a,p):ns(a,ti(p,ne(rf(n),wr)),"compatible"),es(_,a,h)}withTimeZone(n){lt(this,On);const a=Ls(n);return es(ne(this,mn),a,ne(this,Dt))}withCalendar(n){lt(this,On);const a=I_(n);return es(ne(this,mn),ne(this,pi),a)}add(n,a=void 0){return lt(this,On),Fw("add",this,n,a)}subtract(n,a=void 0){return lt(this,On),Fw("subtract",this,n,a)}until(n,a=void 0){return lt(this,On),zw("until",this,n,a)}since(n,a=void 0){return lt(this,On),zw("since",this,n,a)}round(n){if(lt(this,On),n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Rp("smallestUnit",n):rn(n),h=bg(a),p=jc(a,"halfExpand"),_=mo(a,"smallestUnit","time",Xh,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];if(wg(h,v,v===1),_==="nanosecond"&&h===1)return es(ne(this,mn),ne(this,pi),ne(this,Dt));const c=ne(this,pi),C=ne(this,mn),k=gu(this);let P;if(_==="day"){const j=k.isoDate,U=_o(j.year,j.month,j.day+1),V=tf(c,j),ie=tf(c,U),me=Q.subtract(ie,V);P=jn.fromEpochNsDiff(C,V).round(me,p).addToEpochNs(V)}else{const j=qx(k,h,_,p),U=Oh(c,C);P=H0(j.isoDate,j.time,"option",U,c,"compatible","prefer",!1)}return es(P,c,ne(this,Dt))}equals(n){lt(this,On);const a=Fy(n),h=ne(this,mn),p=ne(a,mn);return!!Q.equal(Q.BigInt(h),Q.BigInt(p))&&!!wE(ne(this,pi),ne(a,pi))&&Cu(ne(this,Dt),ne(a,Dt))}toString(n=void 0){lt(this,On);const a=rn(n),h=S_(a),p=A_(a),_=function(U){return Gh(U,"offset",["auto","never"],"auto")}(a),v=jc(a,"trunc"),c=mo(a,"smallestUnit","time",void 0);if(c==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const C=function(U){return Gh(U,"timeZoneName",["auto","never","critical"],"auto")}(a),{precision:k,unit:P,increment:j}=M_(c,p);return Ew(this,k,h,C,_,{unit:P,increment:j,roundingMode:v})}toLocaleString(n=void 0,a=void 0){lt(this,On);const h=rn(a),p=Object.create(null);if(function(C,k,P,j){if(k==null)return;const U=Reflect.ownKeys(k);for(let V=0;V<U.length;V++){const ie=U[V];if(!P.some(me=>Object.is(me,ie))&&Object.prototype.propertyIsEnumerable.call(k,ie)){const me=k[ie];C[ie]=me}}}(p,h,["timeZone"]),h.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");if(p.year===void 0&&p.month===void 0&&p.day===void 0&&p.era===void 0&&p.weekday===void 0&&p.dateStyle===void 0&&p.hour===void 0&&p.minute===void 0&&p.second===void 0&&p.fractionalSecondDigits===void 0&&p.timeStyle===void 0&&p.dayPeriod===void 0&&p.timeZoneName===void 0&&(p.timeZoneName="short"),p.timeZone=ne(this,pi),Sw(p.timeZone))throw new RangeError("toLocaleString does not currently support offset time zones");const _=new Nl(n,p),v=g3.call(_).calendar,c=ne(this,Dt);if(c!=="iso8601"&&v!=="iso8601"&&!Cu(v,c))throw new RangeError(`cannot format ZonedDateTime with calendar ${c} in locale with calendar ${v}`);return _.format(wu(ne(this,mn)))}toJSON(){return lt(this,On),Ew(this,"auto")}valueOf(){yf("ZonedDateTime")}startOfDay(){lt(this,On);const n=ne(this,pi);return es(tf(n,gu(this).isoDate),n,ne(this,Dt))}getTimeZoneTransition(n){lt(this,On);const a=ne(this,pi);if(n===void 0)throw new TypeError("options parameter is required");const h=Gh(typeof n=="string"?Rp("direction",n):rn(n),"direction",["next","previous"],Xh);if(h===void 0)throw new TypeError("direction option is required");if(Sw(a)||a==="UTC")return null;const p=ne(this,mn),_=h==="next"?Cb(a,p):Zx(a,p);return _===null?null:es(_,a,ne(this,Dt))}toInstant(){return lt(this,On),wu(ne(this,mn))}toPlainDate(){return lt(this,On),zs(gu(this).isoDate,ne(this,Dt))}toPlainTime(){return lt(this,On),Ph(gu(this).time)}toPlainDateTime(){return lt(this,On),zl(gu(this),ne(this,Dt))}static from(n,a=void 0){return Fy(n,a)}static compare(n,a){const h=Fy(n),p=Fy(a),_=ne(h,mn),v=ne(p,mn);return Q.lessThan(Q.BigInt(_),Q.BigInt(v))?-1:Q.greaterThan(Q.BigInt(_),Q.BigInt(v))?1:0}}function gu(i){return Bl(ne(i,pi),ne(i,mn))}function ws(i,n){lt(i,On);const a=gu(i).isoDate;return C_(i).isoToDate(a,{[n]:!0})[n]}function qm(i,n){return lt(i,On),gu(i).time[n]}Jh(Ub,"Temporal.ZonedDateTime");var Zw=Object.freeze({__proto__:null,Duration:pg,Instant:Pb,Now:HE,PlainDate:Ob,PlainDateTime:jb,PlainMonthDay:Bb,PlainTime:O_,PlainYearMonth:Fb,ZonedDateTime:Ub});const y3=[Pb,Ob,jb,pg,Bb,O_,Fb,Ub];for(const i of y3){const n=Object.getOwnPropertyDescriptor(i,"prototype");(n.configurable||n.enumerable||n.writable)&&(n.configurable=!1,n.enumerable=!1,n.writable=!1,Object.defineProperty(i,"prototype",n))}function _3({tripQueryVariables:i,setTripQueryVariables:n}){const a=ce.useContext(b_),h=Zw.Instant.from(i.dateTime).toZonedDateTimeISO(a).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),p=ce.useCallback(_=>{const v=Zw.PlainDateTime.from(_.target.value).toZonedDateTime(a).toString({calendarName:"never",timeZoneName:"never"});n({...i,dateTime:v})},[i,n,a]);return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+a,children:"Time"}),se.jsx(Ai.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:p,value:h})]})}function v3({tripQueryVariables:i,setTripQueryVariables:n}){return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),se.jsx(Ai.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:i.searchWindow||"",onChange:a=>n({...i,searchWindow:Number(a.target.value)>0?Number(a.target.value):void 0})})]})}function x3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),se.jsxs(Ai.Select,{id:"accessSelect",size:"sm",onChange:h=>{var p,_;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,accessMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.directMode||(_=i.modes)!=null&&_.transportModes?{...i.modes,accessMode:void 0}:void 0})},value:((a=i.modes)==null?void 0:a.accessMode)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(lv).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}function b3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),se.jsxs(Ai.Select,{id:"egressSelect",size:"sm",onChange:h=>{var p,_;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,egressMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.directMode||(_=i.modes)!=null&&_.transportModes?{...i.modes,egressMode:void 0}:void 0})},value:((a=i.modes)==null?void 0:a.egressMode)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(lv).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}function w3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),se.jsxs(Ai.Select,{id:"directModeSelect",size:"sm",onChange:h=>{var p,_,v;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,directMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.accessMode||(_=i.modes)!=null&&_.egressMode||(v=i.modes)!=null&&v.transportModes?{...i.modes,directMode:void 0}:void 0})},value:((a=i.modes)==null?void 0:a.directMode)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(lv).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}const T3=({label:i,options:n,values:a,onChange:h})=>{const[p,_]=ce.useState(!1),v=()=>{_(!p)},c=C=>{const k=C.target.value,P=C.target.checked;h(P?[...a,k]:a.filter(j=>j!==k))};return se.jsxs("div",{className:`dropdown ${p?"show":""}`,children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:i}),se.jsx(Ai.Control,{type:"text",id:"multiSelectDropdown",size:"sm",value:a.length>0?a.join(", "):"Not selected",onClick:v,onChange:()=>{}}),se.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${p?"show":""}`,children:n.map(C=>se.jsx(Ai.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${C.id}`,label:C.label,checked:a.includes(C.id),onChange:c,value:`${C.id}`},`${C.id}`))})]})};function E3({tripQueryVariables:i,setTripQueryVariables:n}){var p;const a=ce.useMemo(()=>{var _,v;return((v=(_=i==null?void 0:i.modes)==null?void 0:_.transportModes)==null?void 0:v.map(c=>c==null?void 0:c.transportMode).filter(c=>!!c))||[]},[(p=i.modes)==null?void 0:p.transportModes]),h=ce.useCallback(_=>{var c,C,k;const v=_.map(P=>({transportMode:P}));v.length===0?n({...i,modes:(c=i.modes)!=null&&c.directMode||(C=i.modes)!=null&&C.accessMode||(k=i.modes)!=null&&k.egressMode?{...i.modes}:void 0}):n({...i,modes:{...i.modes,transportModes:v.length>0?v:void 0}})},[i,n]);return se.jsx(T3,{label:"Transit mode",options:Object.values(O2).map(_=>({id:_,label:_.toString()})),values:a,onChange:h})}function S3({tripQueryVariables:i,setTripQueryVariables:n}){return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),se.jsx(Ai.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:i.numTripPatterns||"",onChange:a=>n({...i,numTripPatterns:Number(a.target.value)>0?Number(a.target.value):void 0})})]})}function A3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(Ai.Group,{children:[se.jsx(Ai.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),se.jsxs(Ai.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-medium",onChange:h=>{n({...i,itineraryFilters:{debug:h.target.value}})},value:((a=i.itineraryFilters)==null?void 0:a.debug)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(P2).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}const M3="https://www.opentripplanner.org/debug-client-assets/2025/05/2025-05-02T06:44/assets/graphql-solid-B1mrnAEK.svg",C3="/graphiql?flavor=transmodel";function D3({tripQueryVariables:i}){const n=encodeURIComponent(JSON.stringify(i)),a=encodeURIComponent(XI),h="Open in GraphiQL";return se.jsx(Ap,{title:h,href:C3+"&query="+a+"&variables="+n,target:"_blank",children:se.jsx("img",{alt:h,title:h,src:M3,width:"20",height:"20",className:"d-inline-block align-middle"})})}function k3({tripQueryVariables:i,setTripQueryVariables:n,onRoute:a,loading:h}){return se.jsxs("div",{className:"box input-group search-bar",children:[se.jsxs("div",{className:"input-family",children:[se.jsx(lw,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(uR,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(lw,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsxs("div",{className:"input-family",children:[se.jsx(hR,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(_3,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsxs("div",{className:"input-family",children:[se.jsx(S3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(v3,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsxs("div",{className:"input-family",children:[se.jsx(x3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(E3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(b3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(w3,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsx(A3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx("div",{className:"search-bar-route-button-wrapper",children:se.jsxs(cb,{children:[se.jsxs(Ap,{variant:"primary",onClick:()=>a(),disabled:h,children:[h&&se.jsxs(se.Fragment,{children:[se.jsx(VT,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),se.jsx(D3,{tripQueryVariables:i})]})})]})}const XE=ce.createContext(void 0);function I3(){const i=ce.useContext(XE);if(!i)throw new Error("useTripSchema must be used within a TripSchemaProvider");return i}function Ts(i,n){return n.split(".").reduce((a,h)=>{if(a!=null){if(Array.isArray(a)){const p=Number(h);return Number.isNaN(p)?void 0:a[p]}else if(typeof a=="object")return a[h]}},i)}function Jd(i,n,a){const h=n.split(".");function p(_,v){const c=h[v],C=!isNaN(Number(c));if(v===h.length-1){if(Array.isArray(_)&&C){const U=[..._];return U[Number(c)]=a,U}if(ux(_)&&!C)return{..._,[c]:a};if(C){const U=Array.isArray(_)?[..._]:[];return U[Number(c)]=a,U}else return{...ux(_)?_:{},[c]:a}}const k=v+1,P=h[k],j=!isNaN(Number(P));if(Array.isArray(_)&&C){const U=[..._],V=_[Number(c)];return U[Number(c)]=p(V!==void 0?V:j?[]:{},k),U}else if(ux(_)&&!C){const U={..._},V=_[c];return U[c]=p(V!==void 0?V:j?[]:{},k),U}else if(C){const U=[];return U[Number(c)]=p(j?[]:{},k),U}else return{[c]:p(j?[]:{},k)}}return i==null&&(i=!isNaN(Number(h[0]))?[]:{}),p(i,0)}function ux(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}const R3="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",z3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",L3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",N3=({defaultValue:i,type:n})=>se.jsxs("span",{children:[i!=null&&se.jsx("span",{title:`Default: ${i??"None"}`,children:se.jsx("img",{alt:"Info",src:R3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="DoubleFunction"&&se.jsx("span",{title:`Type: ${n.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:se.jsx("img",{alt:"Info",src:z3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="Duration"&&se.jsx("span",{className:"default-tooltip-icon",title:`Type: ${n.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:se.jsx("img",{alt:"Info",src:L3,className:"default-tooltip-icon"})})]}),WE=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),QE=({tripQueryVariables:i,setTripQueryVariables:n})=>{function a(){let h={};WE.forEach(p=>{const _=Ts(i,p);_!==void 0&&(h=Jd(h,p,_))}),n(h)}return se.jsx("button",{className:"reset-button",onClick:a,children:"Reset"})};function hx(i){if(!i)return" ";const n=i.split(".");return n[n.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,h=>h.toUpperCase())+" "}function P0(i,n=[]){let a=[];return i?(Object.entries(i).forEach(([h,p])=>{const _=[...n,h].join(".");a=a.concat(P3(h,p,_,n))}),a):[]}function P3(i,n,a,h){var _;let p=[];if(typeof n=="object"&&n.type)if(n.type.type==="Enum"){const v=["Not selected",...n.type.values||[]],c=n.defaultValue!==void 0?n.defaultValue:"Not selected";p.push({path:a,type:{type:"Enum"},defaultValue:c,enumValues:v,isList:n.isList})}else n.type.type==="InputObject"&&n.isList?(p.push({path:a,type:{type:"Group",name:n.type.name},defaultValue:n.defaultValue,isComplex:!0,isList:!0}),p=p.concat(P0(n.type.fields,[...h,`${i}.*`]))):n.type.type==="InputObject"?(p.push({path:a,type:{type:"Group",name:n.type.name},isComplex:!0,isList:!1}),p=p.concat(P0(n.type.fields,[...h,i]))):n.type.type==="Scalar"&&p.push({path:a,type:{type:n.type.type,subtype:n.type.subtype},defaultValue:n.defaultValue,isList:n.isList});else typeof n=="object"&&((_=n.type)!=null&&_.fields)?(p.push({path:a,type:{type:"Group"},isComplex:!0}),p=p.concat(P0(n.type.fields,[...h,i]))):p.push({path:a,type:n.type??typeof n,defaultValue:n.defaultValue});return p}const O3=({tripQueryVariables:i,setTripQueryVariables:n})=>{const[a,h]=ce.useState([]),[p,_]=ce.useState({}),[v]=ce.useState(""),{tripArgs:c,loading:C,error:k}=I3();ce.useEffect(()=>{if(!c||C||k)return;const ke=P0(c.trip.arguments);h(ke)},[c,C,k]);function P(ke){return ke.replace(/\.\d+/g,".*")}function j(ke,Ze){const nt=P(ke),Ke=a.find(_t=>_t.path===nt);if(!Ke){console.error(`No matching argumentConfig found for path: ${ke}`);return}if(Ke.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Ke.type.subtype)&&Ke.isList&&typeof Ze=="string"){const _t=Ze.split(",").map(Ot=>Ot.trim());let It=Jd(i,ke,_t);It=V(It,ke),n(It);return}let Re=Jd(i,ke,Ze);Re=V(Re,ke),n(Re)}function U(ke){return typeof ke=="object"&&ke!==null&&!Array.isArray(ke)}function V(ke,Ze){if(!Ze.includes(".")){const Ke=Ts(ke,Ze);if(Array.isArray(Ke)&&Ke.length===0){const Re={...ke};return delete Re[Ze],Re}if(U(Ke)&&Object.keys(Ke).every(_t=>{const It=Ke[_t];return It==null||Array.isArray(It)&&It.length===0})){const _t={...ke};return delete _t[Ze],_t}return ke}const nt=Ze.split(".");for(let Ke=nt.length-1;Ke>0;Ke--){const Re=nt.slice(0,Ke).join("."),_t=Ts(ke,Re);_t!=null&&(Array.isArray(_t)?_t.length===0&&(ke=Jd(ke,Re,void 0)):U(_t)&&Object.keys(_t).every(Ot=>{const Vt=`${Re}.${Ot}`,Wt=Ts(ke,Vt);return Wt==null||Array.isArray(Wt)&&Wt.length===0})&&(ke=Jd(ke,Re,void 0)))}return ke}function ie(ke){_(Ze=>({...Ze,[ke]:!Ze[ke]}))}const me=a.filter(({path:ke})=>hx(ke).toLowerCase().includes(v.toLowerCase())).filter(({path:ke})=>!WE.has(ke));function pe(ke,Ze,nt,Ke){const Re=Ts(i,ke)??[],_t=Ke.name;return se.jsxs("div",{children:[Re.map((It,Ot)=>{const Vt=`${ke}.${Ot}`,Wt=Ze.filter(vt=>vt.path.startsWith(`${ke}.*.`)&&vt.path!==`${ke}.*`).map(vt=>({...vt,path:vt.path.replace(`${ke}.*`,Vt)})),dn=Wt.filter(vt=>vt.path.split(".").length===Vt.split(".").length+1),Oe=p[Vt];return se.jsxs("div",{style:{marginLeft:15},children:[se.jsxs("span",{style:{cursor:"pointer"},onClick:()=>ie(Vt),children:[Oe?" ":" "," [#",Ot+1,"]"]}),se.jsx("button",{style:{marginLeft:10},onClick:()=>Qe(ke,Ot),children:"Remove"}),Oe&&se.jsx("div",{style:{marginLeft:20},children:$e(dn,nt+1,Wt)})]},Vt)}),se.jsxs("button",{onClick:()=>Le(ke),children:["+ Add ",_t]})]})}function Le(ke){const nt=[...Ts(i,ke)??[],{}],Ke=Jd(i,ke,nt);n(Ke)}function Qe(ke,Ze){const Ke=(Ts(i,ke)??[]).filter((_t,It)=>It!==Ze);let Re=Jd(i,ke,Ke);Re=V(Re,ke),n(Re)}function He(ke){let Ze=Jd(i,ke,void 0);Ze=V(Ze,ke),n(Ze)}function $e(ke,Ze,nt){return ke.map(({path:Ke,type:Re,defaultValue:_t,enumValues:It,isComplex:Ot,isList:Vt})=>{const Wt=p[Ke],dn=Ke.split(".").length,Oe=nt.filter(mt=>{const Qt=mt.path.split(".").length;return mt.path.startsWith(`${Ke}.`)&&mt.path!==Ke&&Qt===dn+1}),vt=Ze+1;return se.jsx("div",{style:{marginLeft:`${Ze*15}px`,marginBottom:"10px"},children:Ot?se.jsxs("div",{children:[se.jsxs("span",{style:{cursor:"pointer"},onClick:()=>ie(Ke),children:[Wt?" ":" "," ",hx(Ke)]}),Wt&&Vt?se.jsx("div",{style:{marginLeft:20},children:pe(Ke,nt,vt,Re)}):Wt?$e(Oe,vt,nt):null]}):se.jsxs("div",{children:[se.jsxs("label",{className:"argument-label",htmlFor:Ke,children:[hx(Ke)," ",se.jsx(N3,{defaultValue:_t,type:Re})]}),Re.subtype==="Boolean"&&(()=>{const mt=Ts(i,Ke),Qt=mt!==void 0;return se.jsxs("span",{children:[se.jsx("input",{type:"checkbox",id:Ke,checked:mt??!1,onChange:Se=>j(Ke,Se.target.checked)}),Qt&&se.jsx("a",{onClick:()=>He(Ke),className:"remove-argument",children:"x"})]})})(),Re.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Re.subtype)&&Vt&&se.jsx("input",{className:"comma-separated-input",type:"text",id:Ke,value:(()=>{const mt=Ts(i,Ke);return Array.isArray(mt)?mt.join(", "):""})(),onChange:mt=>j(Ke,mt.target.value),placeholder:"Comma-separated list"}),Re.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Re.subtype)&&!Vt&&se.jsx("input",{type:"text",id:Ke,value:Ts(i,Ke)??"",onChange:mt=>j(Ke,mt.target.value||void 0)}),Re.subtype==="Int"&&se.jsx("input",{type:"number",id:Ke,value:Ts(i,Ke)??"",onChange:mt=>{const Qt=parseInt(mt.target.value,10);j(Ke,Number.isNaN(Qt)?void 0:Qt)}}),Re.subtype==="Float"&&se.jsx("input",{type:"number",id:Ke,step:"any",value:Ts(i,Ke)??"",onChange:mt=>{const Qt=parseFloat(mt.target.value);j(Ke,Number.isNaN(Qt)?void 0:Qt)}}),Re.subtype==="DateTime"&&se.jsx("input",{type:"datetime-local",id:Ke,value:(Ts(i,Ke)??"").slice(0,16),onChange:mt=>{const Qt=mt.target.value?new Date(mt.target.value).toISOString():void 0;j(Ke,Qt)}}),Re.type==="Enum"&&It&&Vt&&se.jsx("select",{id:Ke,multiple:!0,value:(()=>{const mt=Ts(i,Ke);return Array.isArray(mt)?mt:[]})(),onChange:mt=>{const Qt=Array.from(mt.target.selectedOptions,Se=>Se.value);j(Ke,Qt)},children:It.map(mt=>se.jsx("option",{value:mt,children:mt},mt))}),Re.type==="Enum"&&It&&!Vt&&se.jsx("select",{id:Ke,value:Ts(i,Ke)??"Not selected",onChange:mt=>{j(Ke,mt.target.value||void 0)},children:It.map(mt=>se.jsx("option",{value:mt,children:mt},mt))})]})},Ke)})}return se.jsxs("div",{className:"left-pane-container below-content",children:[se.jsxs("div",{className:"panel-header",children:["Filters",se.jsx(QE,{tripQueryVariables:i,setTripQueryVariables:n})]}),me.length===0?se.jsx("p",{children:"No arguments found."}):se.jsx("div",{className:"argument-list",children:$e(me.filter(ke=>ke.path.split(".").length===1),0,me)})]})},j3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",B3="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",F3="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",U3=({children:i})=>{const[n,a]=ce.useState(0),h=_=>{switch(_){case 0:return se.jsx("img",{src:j3,alt:"Itineray list",title:"Itineray"});case 1:return se.jsx("img",{src:B3,alt:"Filters",title:"Filters"});case 2:return se.jsx("img",{width:"25",height:"25",src:F3,alt:"Filters",title:"Filters"});default:return null}},p=Rl.Children.toArray(i).filter(_=>Rl.isValidElement(_));return se.jsxs("div",{className:"sidebar-container",children:[se.jsx("div",{className:"sidebar",children:p.map((_,v)=>se.jsx("div",{className:`sidebar-button ${v===n?"active":""}`,onClick:()=>a(v),children:h(v)},v))}),se.jsx("div",{className:"sidebar-content",children:p.map((_,v)=>v===n?se.jsx("div",{children:_},v):null)})]})},V3=({tripQueryVariables:i,setTripQueryVariables:n})=>se.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[se.jsxs("div",{className:"panel-header",children:["Arguments raw",se.jsx(QE,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsx("pre",{children:JSON.stringify(i,null,2)})]});function Z3(i){let n=i;for(;;)if(Bh(n))n=n.ofType;else if(ff(n))n=n.ofType;else break;return n}function KE(i){const n=Z3(i);if(yg(n))return{type:"Scalar",subtype:n.name};if(lf(n))return{type:"Enum",values:n.getValues().map(a=>a.name)};if(jh(n)){const a=n.getFields(),h={};for(const p of Object.keys(a)){const _=a[p];if(_.deprecationReason)continue;const v=ff(_.type),c=_.defaultValue!==void 0?_.defaultValue:null;h[p]={type:KE(_.type),defaultValue:c,isList:v}}return{type:"InputObject",name:n.name,fields:h}}return{type:"Scalar",subtype:"String"}}function G3(i){const n=i.getQueryType();if(!n)throw new Error("No Query type found in the schema.");const a=n.getFields().trip;if(!a)throw new Error("No trip query found in the schema.");const h={};return a.args.forEach(p=>{if(p.deprecationReason)return;const _=p.name,v=KE(p.type),c=p.defaultValue!==null?p.defaultValue:null,C=ff(p.type);h[_]={type:v,...c!==null&&{defaultValue:c},isList:C}}),{trip:{arguments:h}}}async function $3(i){const n=uM(),a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!a.ok)throw new Error(`Failed to fetch schema. HTTP error: ${a.status}`);const{data:h}=await a.json(),p=hM(h);return G3(p)}function Y3({endpoint:i,children:n}){const[a,h]=ce.useState(null),[p,_]=ce.useState(!0),[v,c]=ce.useState(null);ce.useEffect(()=>{let k=!0;async function P(){_(!0),c(null);try{const j=await $3(i);k&&h(j)}catch(j){console.error("Error loading trip arguments:",j),k&&c("Failed to load trip schema")}finally{k&&_(!1)}}return P(),()=>{k=!1}},[i]);const C={tripArgs:a,loading:p,error:v};return se.jsx(XE.Provider,{value:C,children:n})}function q3(){const i=KI(),{tripQueryVariables:n,setTripQueryVariables:a}=nR(),[h,p,_]=WI(n),[v,c]=ce.useState(0),C=(i==null?void 0:i.internalTransitModelTimeZone)||Intl.DateTimeFormat().resolvedOptions().timeZone;return se.jsx("div",{className:"app",children:se.jsx(b_.Provider,{value:C,children:se.jsxs("div",{className:"layout",children:[se.jsx("div",{className:"box logo-section",children:se.jsx(aR,{serverInfo:i})}),se.jsx("div",{className:"box input-section",children:se.jsx(k3,{onRoute:_,tripQueryVariables:n,setTripQueryVariables:a,loading:p})}),se.jsx("div",{className:"box trip-section",children:se.jsxs(U3,{children:[se.jsx(HI,{tripQueryResult:h,selectedTripPatternIndex:v,setSelectedTripPatternIndex:c,pageResults:_,loading:p}),se.jsx(Y3,{endpoint:Jy(),children:se.jsx(O3,{tripQueryVariables:n,setTripQueryVariables:a})}),se.jsx(V3,{tripQueryVariables:n,setTripQueryVariables:a})]})}),se.jsx("div",{className:"box map-section",children:se.jsx(Kk,{tripQueryResult:h,tripQueryVariables:n,setTripQueryVariables:a,selectedTripPatternIndex:v,loading:p})})]})})})}dS.createRoot(document.getElementById("root")).render(se.jsx(Rl.StrictMode,{children:se.jsx(q3,{})}));
