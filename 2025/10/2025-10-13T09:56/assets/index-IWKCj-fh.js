function wS(n,e){for(var r=0;r<e.length;r++){const u=e[r];if(typeof u!="string"&&!Array.isArray(u)){for(const d in u)if(d!=="default"&&!(d in n)){const m=Object.getOwnPropertyDescriptor(u,d);m&&Object.defineProperty(n,d,m.get?m:{enumerable:!0,get:()=>u[d]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const y of m.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&u(y)}).observe(document,{childList:!0,subtree:!0});function r(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function u(d){if(d.ep)return;d.ep=!0;const m=r(d);fetch(d.href,m)}})();function Hp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Wb={exports:{}},Jy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zw;function DC(){if(zw)return Jy;zw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(u,d,m){var y=null;if(m!==void 0&&(y=""+m),d.key!==void 0&&(y=""+d.key),"key"in d){m={};for(var l in d)l!=="key"&&(m[l]=d[l])}else m=d;return d=m.ref,{$$typeof:n,type:u,key:y,ref:d!==void 0?d:null,props:m}}return Jy.Fragment=e,Jy.jsx=r,Jy.jsxs=r,Jy}var jw;function IC(){return jw||(jw=1,Wb.exports=DC()),Wb.exports}var H=IC(),Qb={exports:{}},zn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fw;function RC(){if(Fw)return zn;Fw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),C=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),N=Symbol.iterator;function F(Te){return Te===null||typeof Te!="object"?null:(Te=N&&Te[N]||Te["@@iterator"],typeof Te=="function"?Te:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},W=Object.assign,re={};function ie(Te,nt,yt){this.props=Te,this.context=nt,this.refs=re,this.updater=yt||B}ie.prototype.isReactComponent={},ie.prototype.setState=function(Te,nt){if(typeof Te!="object"&&typeof Te!="function"&&Te!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Te,nt,"setState")},ie.prototype.forceUpdate=function(Te){this.updater.enqueueForceUpdate(this,Te,"forceUpdate")};function de(){}de.prototype=ie.prototype;function Ee(Te,nt,yt){this.props=Te,this.context=nt,this.refs=re,this.updater=yt||B}var we=Ee.prototype=new de;we.constructor=Ee,W(we,ie.prototype),we.isPureReactComponent=!0;var ke=Array.isArray,ge={H:null,A:null,T:null,S:null,V:null},Ae=Object.prototype.hasOwnProperty;function Ge(Te,nt,yt,pt,Et,Ut){return yt=Ut.ref,{$$typeof:n,type:Te,key:nt,ref:yt!==void 0?yt:null,props:Ut}}function at(Te,nt){return Ge(Te.type,nt,void 0,void 0,void 0,Te.props)}function Me(Te){return typeof Te=="object"&&Te!==null&&Te.$$typeof===n}function Qe(Te){var nt={"=":"=0",":":"=2"};return"$"+Te.replace(/[=:]/g,function(yt){return nt[yt]})}var St=/\/+/g;function bt(Te,nt){return typeof Te=="object"&&Te!==null&&Te.key!=null?Qe(""+Te.key):nt.toString(36)}function zt(){}function Zt(Te){switch(Te.status){case"fulfilled":return Te.value;case"rejected":throw Te.reason;default:switch(typeof Te.status=="string"?Te.then(zt,zt):(Te.status="pending",Te.then(function(nt){Te.status==="pending"&&(Te.status="fulfilled",Te.value=nt)},function(nt){Te.status==="pending"&&(Te.status="rejected",Te.reason=nt)})),Te.status){case"fulfilled":return Te.value;case"rejected":throw Te.reason}}throw Te}function Ft(Te,nt,yt,pt,Et){var Ut=typeof Te;(Ut==="undefined"||Ut==="boolean")&&(Te=null);var Ot=!1;if(Te===null)Ot=!0;else switch(Ut){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(Te.$$typeof){case n:case e:Ot=!0;break;case k:return Ot=Te._init,Ft(Ot(Te._payload),nt,yt,pt,Et)}}if(Ot)return Et=Et(Te),Ot=pt===""?"."+bt(Te,0):pt,ke(Et)?(yt="",Ot!=null&&(yt=Ot.replace(St,"$&/")+"/"),Ft(Et,nt,yt,"",function(Xn){return Xn})):Et!=null&&(Me(Et)&&(Et=at(Et,yt+(Et.key==null||Te&&Te.key===Et.key?"":(""+Et.key).replace(St,"$&/")+"/")+Ot)),nt.push(Et)),1;Ot=0;var Ln=pt===""?".":pt+":";if(ke(Te))for(var Wt=0;Wt<Te.length;Wt++)pt=Te[Wt],Ut=Ln+bt(pt,Wt),Ot+=Ft(pt,nt,yt,Ut,Et);else if(Wt=F(Te),typeof Wt=="function")for(Te=Wt.call(Te),Wt=0;!(pt=Te.next()).done;)pt=pt.value,Ut=Ln+bt(pt,Wt++),Ot+=Ft(pt,nt,yt,Ut,Et);else if(Ut==="object"){if(typeof Te.then=="function")return Ft(Zt(Te),nt,yt,pt,Et);throw nt=String(Te),Error("Objects are not valid as a React child (found: "+(nt==="[object Object]"?"object with keys {"+Object.keys(Te).join(", ")+"}":nt)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function Be(Te,nt,yt){if(Te==null)return Te;var pt=[],Et=0;return Ft(Te,pt,"","",function(Ut){return nt.call(yt,Ut,Et++)}),pt}function lt(Te){if(Te._status===-1){var nt=Te._result;nt=nt(),nt.then(function(yt){(Te._status===0||Te._status===-1)&&(Te._status=1,Te._result=yt)},function(yt){(Te._status===0||Te._status===-1)&&(Te._status=2,Te._result=yt)}),Te._status===-1&&(Te._status=0,Te._result=nt)}if(Te._status===1)return Te._result.default;throw Te._result}var _t=typeof reportError=="function"?reportError:function(Te){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var nt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Te=="object"&&Te!==null&&typeof Te.message=="string"?String(Te.message):String(Te),error:Te});if(!window.dispatchEvent(nt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Te);return}console.error(Te)};function ut(){}return zn.Children={map:Be,forEach:function(Te,nt,yt){Be(Te,function(){nt.apply(this,arguments)},yt)},count:function(Te){var nt=0;return Be(Te,function(){nt++}),nt},toArray:function(Te){return Be(Te,function(nt){return nt})||[]},only:function(Te){if(!Me(Te))throw Error("React.Children.only expected to receive a single React element child.");return Te}},zn.Component=ie,zn.Fragment=r,zn.Profiler=d,zn.PureComponent=Ee,zn.StrictMode=u,zn.Suspense=E,zn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ge,zn.__COMPILER_RUNTIME={__proto__:null,c:function(Te){return ge.H.useMemoCache(Te)}},zn.cache=function(Te){return function(){return Te.apply(null,arguments)}},zn.cloneElement=function(Te,nt,yt){if(Te==null)throw Error("The argument must be a React element, but you passed "+Te+".");var pt=W({},Te.props),Et=Te.key,Ut=void 0;if(nt!=null)for(Ot in nt.ref!==void 0&&(Ut=void 0),nt.key!==void 0&&(Et=""+nt.key),nt)!Ae.call(nt,Ot)||Ot==="key"||Ot==="__self"||Ot==="__source"||Ot==="ref"&&nt.ref===void 0||(pt[Ot]=nt[Ot]);var Ot=arguments.length-2;if(Ot===1)pt.children=yt;else if(1<Ot){for(var Ln=Array(Ot),Wt=0;Wt<Ot;Wt++)Ln[Wt]=arguments[Wt+2];pt.children=Ln}return Ge(Te.type,Et,void 0,void 0,Ut,pt)},zn.createContext=function(Te){return Te={$$typeof:y,_currentValue:Te,_currentValue2:Te,_threadCount:0,Provider:null,Consumer:null},Te.Provider=Te,Te.Consumer={$$typeof:m,_context:Te},Te},zn.createElement=function(Te,nt,yt){var pt,Et={},Ut=null;if(nt!=null)for(pt in nt.key!==void 0&&(Ut=""+nt.key),nt)Ae.call(nt,pt)&&pt!=="key"&&pt!=="__self"&&pt!=="__source"&&(Et[pt]=nt[pt]);var Ot=arguments.length-2;if(Ot===1)Et.children=yt;else if(1<Ot){for(var Ln=Array(Ot),Wt=0;Wt<Ot;Wt++)Ln[Wt]=arguments[Wt+2];Et.children=Ln}if(Te&&Te.defaultProps)for(pt in Ot=Te.defaultProps,Ot)Et[pt]===void 0&&(Et[pt]=Ot[pt]);return Ge(Te,Ut,void 0,void 0,null,Et)},zn.createRef=function(){return{current:null}},zn.forwardRef=function(Te){return{$$typeof:l,render:Te}},zn.isValidElement=Me,zn.lazy=function(Te){return{$$typeof:k,_payload:{_status:-1,_result:Te},_init:lt}},zn.memo=function(Te,nt){return{$$typeof:C,type:Te,compare:nt===void 0?null:nt}},zn.startTransition=function(Te){var nt=ge.T,yt={};ge.T=yt;try{var pt=Te(),Et=ge.S;Et!==null&&Et(yt,pt),typeof pt=="object"&&pt!==null&&typeof pt.then=="function"&&pt.then(ut,_t)}catch(Ut){_t(Ut)}finally{ge.T=nt}},zn.unstable_useCacheRefresh=function(){return ge.H.useCacheRefresh()},zn.use=function(Te){return ge.H.use(Te)},zn.useActionState=function(Te,nt,yt){return ge.H.useActionState(Te,nt,yt)},zn.useCallback=function(Te,nt){return ge.H.useCallback(Te,nt)},zn.useContext=function(Te){return ge.H.useContext(Te)},zn.useDebugValue=function(){},zn.useDeferredValue=function(Te,nt){return ge.H.useDeferredValue(Te,nt)},zn.useEffect=function(Te,nt,yt){var pt=ge.H;if(typeof yt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return pt.useEffect(Te,nt)},zn.useId=function(){return ge.H.useId()},zn.useImperativeHandle=function(Te,nt,yt){return ge.H.useImperativeHandle(Te,nt,yt)},zn.useInsertionEffect=function(Te,nt){return ge.H.useInsertionEffect(Te,nt)},zn.useLayoutEffect=function(Te,nt){return ge.H.useLayoutEffect(Te,nt)},zn.useMemo=function(Te,nt){return ge.H.useMemo(Te,nt)},zn.useOptimistic=function(Te,nt){return ge.H.useOptimistic(Te,nt)},zn.useReducer=function(Te,nt,yt){return ge.H.useReducer(Te,nt,yt)},zn.useRef=function(Te){return ge.H.useRef(Te)},zn.useState=function(Te){return ge.H.useState(Te)},zn.useSyncExternalStore=function(Te,nt,yt){return ge.H.useSyncExternalStore(Te,nt,yt)},zn.useTransition=function(){return ge.H.useTransition()},zn.version="19.1.1",zn}var Bw;function E1(){return Bw||(Bw=1,Qb.exports=RC()),Qb.exports}var K=E1();const fl=Hp(K),Uw=wS({__proto__:null,default:fl},[K]);var Kb={exports:{}},e0={},Jb={exports:{}},ex={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vw;function kC(){return Vw||(Vw=1,function(n){function e(Be,lt){var _t=Be.length;Be.push(lt);e:for(;0<_t;){var ut=_t-1>>>1,Te=Be[ut];if(0<d(Te,lt))Be[ut]=lt,Be[_t]=Te,_t=ut;else break e}}function r(Be){return Be.length===0?null:Be[0]}function u(Be){if(Be.length===0)return null;var lt=Be[0],_t=Be.pop();if(_t!==lt){Be[0]=_t;e:for(var ut=0,Te=Be.length,nt=Te>>>1;ut<nt;){var yt=2*(ut+1)-1,pt=Be[yt],Et=yt+1,Ut=Be[Et];if(0>d(pt,_t))Et<Te&&0>d(Ut,pt)?(Be[ut]=Ut,Be[Et]=_t,ut=Et):(Be[ut]=pt,Be[yt]=_t,ut=yt);else if(Et<Te&&0>d(Ut,_t))Be[ut]=Ut,Be[Et]=_t,ut=Et;else break e}}return lt}function d(Be,lt){var _t=Be.sortIndex-lt.sortIndex;return _t!==0?_t:Be.id-lt.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;n.unstable_now=function(){return m.now()}}else{var y=Date,l=y.now();n.unstable_now=function(){return y.now()-l}}var E=[],C=[],k=1,N=null,F=3,B=!1,W=!1,re=!1,ie=!1,de=typeof setTimeout=="function"?setTimeout:null,Ee=typeof clearTimeout=="function"?clearTimeout:null,we=typeof setImmediate<"u"?setImmediate:null;function ke(Be){for(var lt=r(C);lt!==null;){if(lt.callback===null)u(C);else if(lt.startTime<=Be)u(C),lt.sortIndex=lt.expirationTime,e(E,lt);else break;lt=r(C)}}function ge(Be){if(re=!1,ke(Be),!W)if(r(E)!==null)W=!0,Ae||(Ae=!0,bt());else{var lt=r(C);lt!==null&&Ft(ge,lt.startTime-Be)}}var Ae=!1,Ge=-1,at=5,Me=-1;function Qe(){return ie?!0:!(n.unstable_now()-Me<at)}function St(){if(ie=!1,Ae){var Be=n.unstable_now();Me=Be;var lt=!0;try{e:{W=!1,re&&(re=!1,Ee(Ge),Ge=-1),B=!0;var _t=F;try{t:{for(ke(Be),N=r(E);N!==null&&!(N.expirationTime>Be&&Qe());){var ut=N.callback;if(typeof ut=="function"){N.callback=null,F=N.priorityLevel;var Te=ut(N.expirationTime<=Be);if(Be=n.unstable_now(),typeof Te=="function"){N.callback=Te,ke(Be),lt=!0;break t}N===r(E)&&u(E),ke(Be)}else u(E);N=r(E)}if(N!==null)lt=!0;else{var nt=r(C);nt!==null&&Ft(ge,nt.startTime-Be),lt=!1}}break e}finally{N=null,F=_t,B=!1}lt=void 0}}finally{lt?bt():Ae=!1}}}var bt;if(typeof we=="function")bt=function(){we(St)};else if(typeof MessageChannel<"u"){var zt=new MessageChannel,Zt=zt.port2;zt.port1.onmessage=St,bt=function(){Zt.postMessage(null)}}else bt=function(){de(St,0)};function Ft(Be,lt){Ge=de(function(){Be(n.unstable_now())},lt)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Be){Be.callback=null},n.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):at=0<Be?Math.floor(1e3/Be):5},n.unstable_getCurrentPriorityLevel=function(){return F},n.unstable_next=function(Be){switch(F){case 1:case 2:case 3:var lt=3;break;default:lt=F}var _t=F;F=lt;try{return Be()}finally{F=_t}},n.unstable_requestPaint=function(){ie=!0},n.unstable_runWithPriority=function(Be,lt){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var _t=F;F=Be;try{return lt()}finally{F=_t}},n.unstable_scheduleCallback=function(Be,lt,_t){var ut=n.unstable_now();switch(typeof _t=="object"&&_t!==null?(_t=_t.delay,_t=typeof _t=="number"&&0<_t?ut+_t:ut):_t=ut,Be){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=_t+Te,Be={id:k++,callback:lt,priorityLevel:Be,startTime:_t,expirationTime:Te,sortIndex:-1},_t>ut?(Be.sortIndex=_t,e(C,Be),r(E)===null&&Be===r(C)&&(re?(Ee(Ge),Ge=-1):re=!0,Ft(ge,_t-ut))):(Be.sortIndex=Te,e(E,Be),W||B||(W=!0,Ae||(Ae=!0,bt()))),Be},n.unstable_shouldYield=Qe,n.unstable_wrapCallback=function(Be){var lt=F;return function(){var _t=F;F=lt;try{return Be.apply(this,arguments)}finally{F=_t}}}}(ex)),ex}var Gw;function PC(){return Gw||(Gw=1,Jb.exports=kC()),Jb.exports}var tx={exports:{}},Ro={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $w;function OC(){if($w)return Ro;$w=1;var n=E1();function e(E){var C="https://react.dev/errors/"+E;if(1<arguments.length){C+="?args[]="+encodeURIComponent(arguments[1]);for(var k=2;k<arguments.length;k++)C+="&args[]="+encodeURIComponent(arguments[k])}return"Minified React error #"+E+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var u={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},d=Symbol.for("react.portal");function m(E,C,k){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:N==null?null:""+N,children:E,containerInfo:C,implementation:k}}var y=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(E,C){if(E==="font")return"";if(typeof C=="string")return C==="use-credentials"?C:""}return Ro.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=u,Ro.createPortal=function(E,C){var k=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C||C.nodeType!==1&&C.nodeType!==9&&C.nodeType!==11)throw Error(e(299));return m(E,C,null,k)},Ro.flushSync=function(E){var C=y.T,k=u.p;try{if(y.T=null,u.p=2,E)return E()}finally{y.T=C,u.p=k,u.d.f()}},Ro.preconnect=function(E,C){typeof E=="string"&&(C?(C=C.crossOrigin,C=typeof C=="string"?C==="use-credentials"?C:"":void 0):C=null,u.d.C(E,C))},Ro.prefetchDNS=function(E){typeof E=="string"&&u.d.D(E)},Ro.preinit=function(E,C){if(typeof E=="string"&&C&&typeof C.as=="string"){var k=C.as,N=l(k,C.crossOrigin),F=typeof C.integrity=="string"?C.integrity:void 0,B=typeof C.fetchPriority=="string"?C.fetchPriority:void 0;k==="style"?u.d.S(E,typeof C.precedence=="string"?C.precedence:void 0,{crossOrigin:N,integrity:F,fetchPriority:B}):k==="script"&&u.d.X(E,{crossOrigin:N,integrity:F,fetchPriority:B,nonce:typeof C.nonce=="string"?C.nonce:void 0})}},Ro.preinitModule=function(E,C){if(typeof E=="string")if(typeof C=="object"&&C!==null){if(C.as==null||C.as==="script"){var k=l(C.as,C.crossOrigin);u.d.M(E,{crossOrigin:k,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0})}}else C==null&&u.d.M(E)},Ro.preload=function(E,C){if(typeof E=="string"&&typeof C=="object"&&C!==null&&typeof C.as=="string"){var k=C.as,N=l(k,C.crossOrigin);u.d.L(E,k,{crossOrigin:N,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0,type:typeof C.type=="string"?C.type:void 0,fetchPriority:typeof C.fetchPriority=="string"?C.fetchPriority:void 0,referrerPolicy:typeof C.referrerPolicy=="string"?C.referrerPolicy:void 0,imageSrcSet:typeof C.imageSrcSet=="string"?C.imageSrcSet:void 0,imageSizes:typeof C.imageSizes=="string"?C.imageSizes:void 0,media:typeof C.media=="string"?C.media:void 0})}},Ro.preloadModule=function(E,C){if(typeof E=="string")if(C){var k=l(C.as,C.crossOrigin);u.d.m(E,{as:typeof C.as=="string"&&C.as!=="script"?C.as:void 0,crossOrigin:k,integrity:typeof C.integrity=="string"?C.integrity:void 0})}else u.d.m(E)},Ro.requestFormReset=function(E){u.d.r(E)},Ro.unstable_batchedUpdates=function(E,C){return E(C)},Ro.useFormState=function(E,C,k){return y.H.useFormState(E,C,k)},Ro.useFormStatus=function(){return y.H.useHostTransitionStatus()},Ro.version="19.1.1",Ro}var Zw;function TS(){if(Zw)return tx.exports;Zw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),tx.exports=OC(),tx.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yw;function LC(){if(Yw)return e0;Yw=1;var n=PC(),e=E1(),r=TS();function u(a){var h="https://react.dev/errors/"+a;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+a+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function m(a){var h=a,g=a;if(a.alternate)for(;h.return;)h=h.return;else{a=h;do h=a,(h.flags&4098)!==0&&(g=h.return),a=h.return;while(a)}return h.tag===3?g:null}function y(a){if(a.tag===13){var h=a.memoizedState;if(h===null&&(a=a.alternate,a!==null&&(h=a.memoizedState)),h!==null)return h.dehydrated}return null}function l(a){if(m(a)!==a)throw Error(u(188))}function E(a){var h=a.alternate;if(!h){if(h=m(a),h===null)throw Error(u(188));return h!==a?null:a}for(var g=a,w=h;;){var D=g.return;if(D===null)break;var L=D.alternate;if(L===null){if(w=D.return,w!==null){g=w;continue}break}if(D.child===L.child){for(L=D.child;L;){if(L===g)return l(D),a;if(L===w)return l(D),h;L=L.sibling}throw Error(u(188))}if(g.return!==w.return)g=D,w=L;else{for(var q=!1,se=D.child;se;){if(se===g){q=!0,g=D,w=L;break}if(se===w){q=!0,w=D,g=L;break}se=se.sibling}if(!q){for(se=L.child;se;){if(se===g){q=!0,g=L,w=D;break}if(se===w){q=!0,w=L,g=D;break}se=se.sibling}if(!q)throw Error(u(189))}}if(g.alternate!==w)throw Error(u(190))}if(g.tag!==3)throw Error(u(188));return g.stateNode.current===g?a:h}function C(a){var h=a.tag;if(h===5||h===26||h===27||h===6)return a;for(a=a.child;a!==null;){if(h=C(a),h!==null)return h;a=a.sibling}return null}var k=Object.assign,N=Symbol.for("react.element"),F=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),re=Symbol.for("react.strict_mode"),ie=Symbol.for("react.profiler"),de=Symbol.for("react.provider"),Ee=Symbol.for("react.consumer"),we=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),Ge=Symbol.for("react.memo"),at=Symbol.for("react.lazy"),Me=Symbol.for("react.activity"),Qe=Symbol.for("react.memo_cache_sentinel"),St=Symbol.iterator;function bt(a){return a===null||typeof a!="object"?null:(a=St&&a[St]||a["@@iterator"],typeof a=="function"?a:null)}var zt=Symbol.for("react.client.reference");function Zt(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===zt?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case W:return"Fragment";case ie:return"Profiler";case re:return"StrictMode";case ge:return"Suspense";case Ae:return"SuspenseList";case Me:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case B:return"Portal";case we:return(a.displayName||"Context")+".Provider";case Ee:return(a._context.displayName||"Context")+".Consumer";case ke:var h=a.render;return a=a.displayName,a||(a=h.displayName||h.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ge:return h=a.displayName||null,h!==null?h:Zt(a.type)||"Memo";case at:h=a._payload,a=a._init;try{return Zt(a(h))}catch{}}return null}var Ft=Array.isArray,Be=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,lt=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_t={pending:!1,data:null,method:null,action:null},ut=[],Te=-1;function nt(a){return{current:a}}function yt(a){0>Te||(a.current=ut[Te],ut[Te]=null,Te--)}function pt(a,h){Te++,ut[Te]=a.current,a.current=h}var Et=nt(null),Ut=nt(null),Ot=nt(null),Ln=nt(null);function Wt(a,h){switch(pt(Ot,h),pt(Ut,a),pt(Et,null),h.nodeType){case 9:case 11:a=(a=h.documentElement)&&(a=a.namespaceURI)?yf(a):0;break;default:if(a=h.tagName,h=h.namespaceURI)h=yf(h),a=ku(h,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}yt(Et),pt(Et,a)}function Xn(){yt(Et),yt(Ut),yt(Ot)}function br(a){a.memoizedState!==null&&pt(Ln,a);var h=Et.current,g=ku(h,a.type);h!==g&&(pt(Ut,a),pt(Et,g))}function ir(a){Ut.current===a&&(yt(Et),yt(Ut)),Ln.current===a&&(yt(Ln),Z._currentValue=_t)}var yi=Object.prototype.hasOwnProperty,Un=n.unstable_scheduleCallback,Vn=n.unstable_cancelCallback,Dn=n.unstable_shouldYield,Pr=n.unstable_requestPaint,ki=n.unstable_now,Aa=n.unstable_getCurrentPriorityLevel,_a=n.unstable_ImmediatePriority,Gr=n.unstable_UserBlockingPriority,Or=n.unstable_NormalPriority,Va=n.unstable_LowPriority,Ca=n.unstable_IdlePriority,Da=n.log,Ga=n.unstable_setDisableYieldValue,gn=null,ii=null;function xr(a){if(typeof Da=="function"&&Ga(a),ii&&typeof ii.setStrictMode=="function")try{ii.setStrictMode(gn,a)}catch{}}var Pe=Math.clz32?Math.clz32:le,te=Math.log,ne=Math.LN2;function le(a){return a>>>=0,a===0?32:31-(te(a)/ne|0)|0}var be=256,De=4194304;function Oe(a){var h=a&42;if(h!==0)return h;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ye(a,h,g){var w=a.pendingLanes;if(w===0)return 0;var D=0,L=a.suspendedLanes,q=a.pingedLanes;a=a.warmLanes;var se=w&134217727;return se!==0?(w=se&~L,w!==0?D=Oe(w):(q&=se,q!==0?D=Oe(q):g||(g=se&~a,g!==0&&(D=Oe(g))))):(se=w&~L,se!==0?D=Oe(se):q!==0?D=Oe(q):g||(g=w&~a,g!==0&&(D=Oe(g)))),D===0?0:h!==0&&h!==D&&(h&L)===0&&(L=D&-D,g=h&-h,L>=g||L===32&&(g&4194048)!==0)?h:D}function je(a,h){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&h)===0}function tt(a,h){switch(a){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mt(){var a=be;return be<<=1,(be&4194048)===0&&(be=256),a}function ot(){var a=De;return De<<=1,(De&62914560)===0&&(De=4194304),a}function jt(a){for(var h=[],g=0;31>g;g++)h.push(a);return h}function Fe(a,h){a.pendingLanes|=h,h!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function rn(a,h,g,w,D,L){var q=a.pendingLanes;a.pendingLanes=g,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=g,a.entangledLanes&=g,a.errorRecoveryDisabledLanes&=g,a.shellSuspendCounter=0;var se=a.entanglements,Ce=a.expirationTimes,He=a.hiddenUpdates;for(g=q&~g;0<g;){var st=31-Pe(g),ft=1<<st;se[st]=0,Ce[st]=-1;var Ke=He[st];if(Ke!==null)for(He[st]=null,st=0;st<Ke.length;st++){var et=Ke[st];et!==null&&(et.lane&=-536870913)}g&=~ft}w!==0&&Sn(a,w,0),L!==0&&D===0&&a.tag!==0&&(a.suspendedLanes|=L&~(q&~h))}function Sn(a,h,g){a.pendingLanes|=h,a.suspendedLanes&=~h;var w=31-Pe(h);a.entangledLanes|=h,a.entanglements[w]=a.entanglements[w]|1073741824|g&4194090}function $t(a,h){var g=a.entangledLanes|=h;for(a=a.entanglements;g;){var w=31-Pe(g),D=1<<w;D&h|a[w]&h&&(a[w]|=h),g&=~D}}function cn(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ci(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function fr(){var a=lt.p;return a!==0?a:(a=window.event,a===void 0?32:Vt(a.type))}function wr(a,h){var g=lt.p;try{return lt.p=a,h()}finally{lt.p=g}}var di=Math.random().toString(36).slice(2),Kt="__reactFiber$"+di,an="__reactProps$"+di,Pi="__reactContainer$"+di,wt="__reactEvents$"+di,Jr="__reactListeners$"+di,Yi="__reactHandles$"+di,Vs="__reactResources$"+di,ps="__reactMarker$"+di;function It(a){delete a[Kt],delete a[an],delete a[wt],delete a[Jr],delete a[Yi]}function yn(a){var h=a[Kt];if(h)return h;for(var g=a.parentNode;g;){if(h=g[Pi]||g[Kt]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(a=wp(a);a!==null;){if(g=a[Kt])return g;a=wp(a)}return h}a=g,g=a.parentNode}return null}function ln(a){if(a=a[Kt]||a[Pi]){var h=a.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return a}return null}function rr(a){var h=a.tag;if(h===5||h===26||h===27||h===6)return a.stateNode;throw Error(u(33))}function fo(a){var h=a[Vs];return h||(h=a[Vs]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Oi(a){a[ps]=!0}var _n=new Set,rh={};function Ia(a,h){Gs(a,h),Gs(a+"Capture",h)}function Gs(a,h){for(rh[a]=h,a=0;a<h.length;a++)_n.add(h[a])}var ms=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kl={},Hi={};function Cd(a){return yi.call(Hi,a)?!0:yi.call(Kl,a)?!1:ms.test(a)?Hi[a]=!0:(Kl[a]=!0,!1)}function $r(a,h,g){if(Cd(h))if(g===null)a.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":a.removeAttribute(h);return;case"boolean":var w=h.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){a.removeAttribute(h);return}}a.setAttribute(h,""+g)}}function ei(a,h,g){if(g===null)a.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttribute(h,""+g)}}function gs(a,h,g,w){if(w===null)a.removeAttribute(g);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(g);return}a.setAttributeNS(h,g,""+w)}}var Jl,Dd;function $a(a){if(Jl===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);Jl=h&&h[1]||"",Dd=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Jl+a+Dd}var ys=!1;function ah(a,h){if(!a||ys)return"";ys=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(h){var ft=function(){throw Error()};if(Object.defineProperty(ft.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ft,[])}catch(et){var Ke=et}Reflect.construct(a,[],ft)}else{try{ft.call()}catch(et){Ke=et}a.call(ft.prototype)}}else{try{throw Error()}catch(et){Ke=et}(ft=a())&&typeof ft.catch=="function"&&ft.catch(function(){})}}catch(et){if(et&&Ke&&typeof et.stack=="string")return[et.stack,Ke.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=w.DetermineComponentFrameRoot(),q=L[0],se=L[1];if(q&&se){var Ce=q.split(`
`),He=se.split(`
`);for(D=w=0;w<Ce.length&&!Ce[w].includes("DetermineComponentFrameRoot");)w++;for(;D<He.length&&!He[D].includes("DetermineComponentFrameRoot");)D++;if(w===Ce.length||D===He.length)for(w=Ce.length-1,D=He.length-1;1<=w&&0<=D&&Ce[w]!==He[D];)D--;for(;1<=w&&0<=D;w--,D--)if(Ce[w]!==He[D]){if(w!==1||D!==1)do if(w--,D--,0>D||Ce[w]!==He[D]){var st=`
`+Ce[w].replace(" at new "," at ");return a.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",a.displayName)),st}while(1<=w&&0<=D);break}}}finally{ys=!1,Error.prepareStackTrace=g}return(g=a?a.displayName||a.name:"")?$a(g):""}function em(a){switch(a.tag){case 26:case 27:case 5:return $a(a.type);case 16:return $a("Lazy");case 13:return $a("Suspense");case 19:return $a("SuspenseList");case 0:case 15:return ah(a.type,!1);case 11:return ah(a.type.render,!1);case 1:return ah(a.type,!0);case 31:return $a("Activity");default:return""}}function Bf(a){try{var h="";do h+=em(a),a=a.return;while(a);return h}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function Zr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Uf(a){var h=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function iy(a){var h=Uf(a)?"checked":"value",g=Object.getOwnPropertyDescriptor(a.constructor.prototype,h),w=""+a[h];if(!a.hasOwnProperty(h)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var D=g.get,L=g.set;return Object.defineProperty(a,h,{configurable:!0,get:function(){return D.call(this)},set:function(q){w=""+q,L.call(this,q)}}),Object.defineProperty(a,h,{enumerable:g.enumerable}),{getValue:function(){return w},setValue:function(q){w=""+q},stopTracking:function(){a._valueTracker=null,delete a[h]}}}}function Id(a){a._valueTracker||(a._valueTracker=iy(a))}function tm(a){if(!a)return!1;var h=a._valueTracker;if(!h)return!0;var g=h.getValue(),w="";return a&&(w=Uf(a)?a.checked?"true":"false":a.value),a=w,a!==g?(h.setValue(a),!0):!1}function qc(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Xc=/[\n"\\]/g;function Ra(a){return a.replace(Xc,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function oh(a,h,g,w,D,L,q,se){a.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?a.type=q:a.removeAttribute("type"),h!=null?q==="number"?(h===0&&a.value===""||a.value!=h)&&(a.value=""+Zr(h)):a.value!==""+Zr(h)&&(a.value=""+Zr(h)):q!=="submit"&&q!=="reset"||a.removeAttribute("value"),h!=null?sh(a,q,Zr(h)):g!=null?sh(a,q,Zr(g)):w!=null&&a.removeAttribute("value"),D==null&&L!=null&&(a.defaultChecked=!!L),D!=null&&(a.checked=D&&typeof D!="function"&&typeof D!="symbol"),se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?a.name=""+Zr(se):a.removeAttribute("name")}function ec(a,h,g,w,D,L,q,se){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(a.type=L),h!=null||g!=null){if(!(L!=="submit"&&L!=="reset"||h!=null))return;g=g!=null?""+Zr(g):"",h=h!=null?""+Zr(h):g,se||h===a.value||(a.value=h),a.defaultValue=h}w=w??D,w=typeof w!="function"&&typeof w!="symbol"&&!!w,a.checked=se?a.checked:!!w,a.defaultChecked=!!w,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(a.name=q)}function sh(a,h,g){h==="number"&&qc(a.ownerDocument)===a||a.defaultValue===""+g||(a.defaultValue=""+g)}function bl(a,h,g,w){if(a=a.options,h){h={};for(var D=0;D<g.length;D++)h["$"+g[D]]=!0;for(g=0;g<a.length;g++)D=h.hasOwnProperty("$"+a[g].value),a[g].selected!==D&&(a[g].selected=D),D&&w&&(a[g].defaultSelected=!0)}else{for(g=""+Zr(g),h=null,D=0;D<a.length;D++){if(a[D].value===g){a[D].selected=!0,w&&(a[D].defaultSelected=!0);return}h!==null||a[D].disabled||(h=a[D])}h!==null&&(h.selected=!0)}}function nm(a,h,g){if(h!=null&&(h=""+Zr(h),h!==a.value&&(a.value=h),g==null)){a.defaultValue!==h&&(a.defaultValue=h);return}a.defaultValue=g!=null?""+Zr(g):""}function tc(a,h,g,w){if(h==null){if(w!=null){if(g!=null)throw Error(u(92));if(Ft(w)){if(1<w.length)throw Error(u(93));w=w[0]}g=w}g==null&&(g=""),h=g}g=Zr(h),a.defaultValue=g,w=a.textContent,w===g&&w!==""&&w!==null&&(a.value=w)}function _s(a,h){if(h){var g=a.firstChild;if(g&&g===a.lastChild&&g.nodeType===3){g.nodeValue=h;return}}a.textContent=h}var No=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function En(a,h,g){var w=h.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?w?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="":w?a.setProperty(h,g):typeof g!="number"||g===0||No.has(h)?h==="float"?a.cssFloat=g:a[h]=(""+g).trim():a[h]=g+"px"}function xl(a,h,g){if(h!=null&&typeof h!="object")throw Error(u(62));if(a=a.style,g!=null){for(var w in g)!g.hasOwnProperty(w)||h!=null&&h.hasOwnProperty(w)||(w.indexOf("--")===0?a.setProperty(w,""):w==="float"?a.cssFloat="":a[w]="");for(var D in h)w=h[D],h.hasOwnProperty(D)&&g[D]!==w&&En(a,D,w)}else for(var L in h)h.hasOwnProperty(L)&&En(a,L,h[L])}function vs(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $s=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xn(a){return nc.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Zs=null;function Wc(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ys=null,pr=null;function Tr(a){var h=ln(a);if(h&&(a=h.stateNode)){var g=a[an]||null;e:switch(a=h.stateNode,h.type){case"input":if(oh(a,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),h=g.name,g.type==="radio"&&h!=null){for(g=a;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Ra(""+h)+'"][type="radio"]'),h=0;h<g.length;h++){var w=g[h];if(w!==a&&w.form===a.form){var D=w[an]||null;if(!D)throw Error(u(90));oh(w,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(h=0;h<g.length;h++)w=g[h],w.form===a.form&&tm(w)}break e;case"textarea":nm(a,g.value,g.defaultValue);break e;case"select":h=g.value,h!=null&&bl(a,!!g.multiple,h,!1)}}}var Yr=!1;function ar(a,h,g){if(Yr)return a(h,g);Yr=!0;try{var w=a(h);return w}finally{if(Yr=!1,(Ys!==null||pr!==null)&&(Bm(),Ys&&(h=Ys,a=pr,pr=Ys=null,Tr(h),a)))for(h=0;h<a.length;h++)Tr(a[h])}}function Wn(a,h){var g=a.stateNode;if(g===null)return null;var w=g[an]||null;if(w===null)return null;g=w[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(a=a.type,w=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!w;break e;default:a=!1}if(a)return null;if(g&&typeof g!="function")throw Error(u(231,h,typeof g));return g}var bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hr=!1;if(bs)try{var qr={};Object.defineProperty(qr,"passive",{get:function(){Hr=!0}}),window.addEventListener("test",qr,qr),window.removeEventListener("test",qr,qr)}catch{Hr=!1}var qi=null,fi=null,xs=null;function Qt(){if(xs)return xs;var a,h=fi,g=h.length,w,D="value"in qi?qi.value:qi.textContent,L=D.length;for(a=0;a<g&&h[a]===D[a];a++);var q=g-a;for(w=1;w<=q&&h[g-w]===D[L-w];w++);return xs=D.slice(a,1<w?1-w:void 0)}function on(a){var h=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&h===13&&(a=13)):a=h,a===10&&(a=13),32<=a||a===13?a:0}function po(){return!0}function Pn(){return!1}function Mi(a){function h(g,w,D,L,q){this._reactName=g,this._targetInst=D,this.type=w,this.nativeEvent=L,this.target=q,this.currentTarget=null;for(var se in a)a.hasOwnProperty(se)&&(g=a[se],this[se]=g?g(L):L[se]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?po:Pn,this.isPropagationStopped=Pn,this}return k(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=po)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=po)},persist:function(){},isPersistent:po}),h}var ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Za=Mi(ea),wl=k({},ea,{view:0,detail:0}),Vf=Mi(wl),Tl,ic,Sl,rc=k({},wl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sc,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Sl&&(Sl&&a.type==="mousemove"?(Tl=a.screenX-Sl.screenX,ic=a.screenY-Sl.screenY):ic=Tl=0,Sl=a),Tl)},movementY:function(a){return"movementY"in a?a.movementY:ic}}),lh=Mi(rc),zo=k({},rc,{dataTransfer:0}),Lr=Mi(zo),Qc=k({},wl,{relatedTarget:0}),ac=Mi(Qc),oc=k({},ea,{animationName:0,elapsedTime:0,pseudoElement:0}),Ki=Mi(oc),im=k({},ea,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),ch=Mi(im),Gf=k({},ea,{data:0}),rm=Mi(Gf),Kc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ws(a){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(a):(a=uh[a])?!!h[a]:!1}function sc(){return ws}var hh=k({},wl,{key:function(a){if(a.key){var h=Kc[a.key]||a.key;if(h!=="Unidentified")return h}return a.type==="keypress"?(a=on(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Xr[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sc,charCode:function(a){return a.type==="keypress"?on(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?on(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),dh=Mi(hh),ta=k({},rc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$f=Mi(ta),Rd=k({},wl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sc}),ry=Mi(Rd),Zf=k({},ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),ay=Mi(Zf),oy=k({},rc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),kd=Mi(oy),Yf=k({},ea,{newState:0,oldState:0}),lc=Mi(Yf),Hf=[9,13,27,32],Jc=bs&&"CompositionEvent"in window,va=null;bs&&"documentMode"in document&&(va=document.documentMode);var sy=bs&&"TextEvent"in window&&!va,fh=bs&&(!Jc||va&&8<va&&11>=va),eu=" ",tu=!1;function am(a,h){switch(a){case"keyup":return Hf.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ph(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var nu=!1;function cc(a,h){switch(a){case"compositionend":return ph(h);case"keypress":return h.which!==32?null:(tu=!0,eu);case"textInput":return a=h.data,a===eu&&tu?null:a;default:return null}}function om(a,h){if(nu)return a==="compositionend"||!Jc&&am(a,h)?(a=Qt(),xs=fi=qi=null,nu=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return fh&&h.locale!=="ko"?null:h.data;default:return null}}var qf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sm(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h==="input"?!!qf[a.type]:h==="textarea"}function Xf(a,h,g,w){Ys?pr?pr.push(w):pr=[w]:Ys=w,h=mf(h,"onChange"),0<h.length&&(g=new Za("onChange","change",null,g,w),a.push({event:g,listeners:h}))}var uc=null,iu=null;function Pd(a){Z_(a,0)}function mh(a){var h=rr(a);if(tm(h))return a}function Wf(a,h){if(a==="change")return h}var El=!1;if(bs){var gh;if(bs){var yh="oninput"in document;if(!yh){var ru=document.createElement("div");ru.setAttribute("oninput","return;"),yh=typeof ru.oninput=="function"}gh=yh}else gh=!1;El=gh&&(!document.documentMode||9<document.documentMode)}function lm(){uc&&(uc.detachEvent("onpropertychange",au),iu=uc=null)}function au(a){if(a.propertyName==="value"&&mh(iu)){var h=[];Xf(h,iu,a,Wc(a)),ar(Pd,h)}}function cm(a,h,g){a==="focusin"?(lm(),uc=h,iu=g,uc.attachEvent("onpropertychange",au)):a==="focusout"&&lm()}function ly(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return mh(iu)}function um(a,h){if(a==="click")return mh(h)}function hm(a,h){if(a==="input"||a==="change")return mh(h)}function Qf(a,h){return a===h&&(a!==0||1/a===1/h)||a!==a&&h!==h}var ba=typeof Object.is=="function"?Object.is:Qf;function ou(a,h){if(ba(a,h))return!0;if(typeof a!="object"||a===null||typeof h!="object"||h===null)return!1;var g=Object.keys(a),w=Object.keys(h);if(g.length!==w.length)return!1;for(w=0;w<g.length;w++){var D=g[w];if(!yi.call(h,D)||!ba(a[D],h[D]))return!1}return!0}function _h(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ts(a,h){var g=_h(a);a=0;for(var w;g;){if(g.nodeType===3){if(w=a+g.textContent.length,a<=h&&w>=h)return{node:g,offset:h-a};a=w}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=_h(g)}}function Gn(a,h){return a&&h?a===h?!0:a&&a.nodeType===3?!1:h&&h.nodeType===3?Gn(a,h.parentNode):"contains"in a?a.contains(h):a.compareDocumentPosition?!!(a.compareDocumentPosition(h)&16):!1:!1}function Od(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var h=qc(a.document);h instanceof a.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)a=h.contentWindow;else break;h=qc(a.document)}return h}function vh(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h&&(h==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||h==="textarea"||a.contentEditable==="true")}var dm=bs&&"documentMode"in document&&11>=document.documentMode,Ml=null,Hs=null,hc=null,Kf=!1;function fm(a,h,g){var w=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Kf||Ml==null||Ml!==qc(w)||(w=Ml,"selectionStart"in w&&vh(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),hc&&ou(hc,w)||(hc=w,w=mf(Hs,"onSelect"),0<w.length&&(h=new Za("onSelect","select",null,h,g),a.push({event:h,listeners:w}),h.target=Ml)))}function dc(a,h){var g={};return g[a.toLowerCase()]=h.toLowerCase(),g["Webkit"+a]="webkit"+h,g["Moz"+a]="moz"+h,g}var su={animationend:dc("Animation","AnimationEnd"),animationiteration:dc("Animation","AnimationIteration"),animationstart:dc("Animation","AnimationStart"),transitionrun:dc("Transition","TransitionRun"),transitionstart:dc("Transition","TransitionStart"),transitioncancel:dc("Transition","TransitionCancel"),transitionend:dc("Transition","TransitionEnd")},Ld={},pm={};bs&&(pm=document.createElement("div").style,"AnimationEvent"in window||(delete su.animationend.animation,delete su.animationiteration.animation,delete su.animationstart.animation),"TransitionEvent"in window||delete su.transitionend.transition);function Al(a){if(Ld[a])return Ld[a];if(!su[a])return a;var h=su[a],g;for(g in h)if(h.hasOwnProperty(g)&&g in pm)return Ld[a]=h[g];return a}var bh=Al("animationend"),xh=Al("animationiteration"),wh=Al("animationstart"),Jf=Al("transitionrun"),fc=Al("transitionstart"),Th=Al("transitioncancel"),pc=Al("transitionend"),Ya=new Map,Nd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nd.push("scrollEnd");function mo(a,h){Ya.set(a,h),Ia(h,[a])}var zd=new WeakMap;function Nr(a,h){if(typeof a=="object"&&a!==null){var g=zd.get(a);return g!==void 0?g:(h={value:a,source:h,stack:Bf(h)},zd.set(a,h),h)}return{value:a,source:h,stack:Bf(h)}}var xa=[],qs=0,mc=0;function gc(){for(var a=qs,h=mc=qs=0;h<a;){var g=xa[h];xa[h++]=null;var w=xa[h];xa[h++]=null;var D=xa[h];xa[h++]=null;var L=xa[h];if(xa[h++]=null,w!==null&&D!==null){var q=w.pending;q===null?D.next=D:(D.next=q.next,q.next=D),w.pending=D}L!==0&&ep(g,D,L)}}function Sh(a,h,g,w){xa[qs++]=a,xa[qs++]=h,xa[qs++]=g,xa[qs++]=w,mc|=w,a.lanes|=w,a=a.alternate,a!==null&&(a.lanes|=w)}function Cl(a,h,g,w){return Sh(a,h,g,w),lu(a)}function Ha(a,h){return Sh(a,null,null,h),lu(a)}function ep(a,h,g){a.lanes|=g;var w=a.alternate;w!==null&&(w.lanes|=g);for(var D=!1,L=a.return;L!==null;)L.childLanes|=g,w=L.alternate,w!==null&&(w.childLanes|=g),L.tag===22&&(a=L.stateNode,a===null||a._visibility&1||(D=!0)),a=L,L=L.return;return a.tag===3?(L=a.stateNode,D&&h!==null&&(D=31-Pe(g),a=L.hiddenUpdates,w=a[D],w===null?a[D]=[h]:w.push(h),h.lane=g|536870912),L):null}function lu(a){if(50<gp)throw gp=0,Xh=null,Error(u(185));for(var h=a.return;h!==null;)a=h,h=a.return;return a.tag===3?a.stateNode:null}var vn={};function Eh(a,h,g,w){this.tag=a,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qa(a,h,g,w){return new Eh(a,h,g,w)}function jd(a){return a=a.prototype,!(!a||!a.isReactComponent)}function na(a,h){var g=a.alternate;return g===null?(g=qa(a.tag,h,a.key,a.mode),g.elementType=a.elementType,g.type=a.type,g.stateNode=a.stateNode,g.alternate=a,a.alternate=g):(g.pendingProps=h,g.type=a.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=a.flags&65011712,g.childLanes=a.childLanes,g.lanes=a.lanes,g.child=a.child,g.memoizedProps=a.memoizedProps,g.memoizedState=a.memoizedState,g.updateQueue=a.updateQueue,h=a.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=a.sibling,g.index=a.index,g.ref=a.ref,g.refCleanup=a.refCleanup,g}function tp(a,h){a.flags&=65011714;var g=a.alternate;return g===null?(a.childLanes=0,a.lanes=h,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=g.childLanes,a.lanes=g.lanes,a.child=g.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=g.memoizedProps,a.memoizedState=g.memoizedState,a.updateQueue=g.updateQueue,a.type=g.type,h=g.dependencies,a.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),a}function Fd(a,h,g,w,D,L){var q=0;if(w=a,typeof a=="function")jd(a)&&(q=1);else if(typeof a=="string")q=o(a,g,Et.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case Me:return a=qa(31,g,h,D),a.elementType=Me,a.lanes=L,a;case W:return Dl(g.children,D,L,h);case re:q=8,D|=24;break;case ie:return a=qa(12,g,h,D|2),a.elementType=ie,a.lanes=L,a;case ge:return a=qa(13,g,h,D),a.elementType=ge,a.lanes=L,a;case Ae:return a=qa(19,g,h,D),a.elementType=Ae,a.lanes=L,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case de:case we:q=10;break e;case Ee:q=9;break e;case ke:q=11;break e;case Ge:q=14;break e;case at:q=16,w=null;break e}q=29,g=Error(u(130,a===null?"null":typeof a,"")),w=null}return h=qa(q,g,h,D),h.elementType=a,h.type=w,h.lanes=L,h}function Dl(a,h,g,w){return a=qa(7,a,w,h),a.lanes=g,a}function np(a,h,g){return a=qa(6,a,null,h),a.lanes=g,a}function Mh(a,h,g){return h=qa(4,a.children!==null?a.children:[],a.key,h),h.lanes=g,h.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},h}var Xs=[],Ss=0,Il=null,cu=0,Xa=[],ia=0,jo=null,Wa=1,go="";function Ws(a,h){Xs[Ss++]=cu,Xs[Ss++]=Il,Il=a,cu=h}function Rl(a,h,g){Xa[ia++]=Wa,Xa[ia++]=go,Xa[ia++]=jo,jo=a;var w=Wa;a=go;var D=32-Pe(w)-1;w&=~(1<<D),g+=1;var L=32-Pe(h)+D;if(30<L){var q=D-D%5;L=(w&(1<<q)-1).toString(32),w>>=q,D-=q,Wa=1<<32-Pe(h)+D|g<<D|w,go=L+a}else Wa=1<<L|g<<D|w,go=a}function Ah(a){a.return!==null&&(Ws(a,1),Rl(a,1,0))}function uu(a){for(;a===Il;)Il=Xs[--Ss],Xs[Ss]=null,cu=Xs[--Ss],Xs[Ss]=null;for(;a===jo;)jo=Xa[--ia],Xa[ia]=null,go=Xa[--ia],Xa[ia]=null,Wa=Xa[--ia],Xa[ia]=null}var or=null,Ui=null,Qn=!1,kl=null,Qa=!1,Ch=Error(u(519));function yc(a){var h=Error(u(418,""));throw Qs(Nr(h,a)),Ch}function Bd(a){var h=a.stateNode,g=a.type,w=a.memoizedProps;switch(h[Kt]=a,h[an]=w,g){case"dialog":Zn("cancel",h),Zn("close",h);break;case"iframe":case"object":case"embed":Zn("load",h);break;case"video":case"audio":for(g=0;g<Ru.length;g++)Zn(Ru[g],h);break;case"source":Zn("error",h);break;case"img":case"image":case"link":Zn("error",h),Zn("load",h);break;case"details":Zn("toggle",h);break;case"input":Zn("invalid",h),ec(h,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0),Id(h);break;case"select":Zn("invalid",h);break;case"textarea":Zn("invalid",h),tc(h,w.value,w.defaultValue,w.children),Id(h)}g=w.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||h.textContent===""+g||w.suppressHydrationWarning===!0||$y(h.textContent,g)?(w.popover!=null&&(Zn("beforetoggle",h),Zn("toggle",h)),w.onScroll!=null&&Zn("scroll",h),w.onScrollEnd!=null&&Zn("scrollend",h),w.onClick!=null&&(h.onclick=gf),h=!0):h=!1,h||yc(a)}function Vi(a){for(or=a.return;or;)switch(or.tag){case 5:case 13:Qa=!1;return;case 27:case 3:Qa=!0;return;default:or=or.return}}function ka(a){if(a!==or)return!1;if(!Qn)return Vi(a),Qn=!0,!1;var h=a.tag,g;if((g=h!==3&&h!==27)&&((g=h===5)&&(g=a.type,g=!(g!=="form"&&g!=="button")||eg(a.type,a.memoizedProps)),g=!g),g&&Ui&&yc(a),Vi(a),h===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(u(317));e:{for(a=a.nextSibling,h=0;a;){if(a.nodeType===8)if(g=a.data,g==="/$"){if(h===0){Ui=Co(a.nextSibling);break e}h--}else g!=="$"&&g!=="$!"&&g!=="$?"||h++;a=a.nextSibling}Ui=null}}else h===27?(h=Ui,Nc(a.type)?(a=rg,rg=null,Ui=a):Ui=h):Ui=or?Co(a.stateNode.nextSibling):null;return!0}function ra(){Ui=or=null,Qn=!1}function Dh(){var a=kl;return a!==null&&(za===null?za=a:za.push.apply(za,a),kl=null),a}function Qs(a){kl===null?kl=[a]:kl.push(a)}var Ud=nt(null),Ka=null,yo=null;function aa(a,h,g){pt(Ud,h._currentValue),h._currentValue=g}function Fo(a){a._currentValue=Ud.current,yt(Ud)}function Vd(a,h,g){for(;a!==null;){var w=a.alternate;if((a.childLanes&h)!==h?(a.childLanes|=h,w!==null&&(w.childLanes|=h)):w!==null&&(w.childLanes&h)!==h&&(w.childLanes|=h),a===g)break;a=a.return}}function Gd(a,h,g,w){var D=a.child;for(D!==null&&(D.return=a);D!==null;){var L=D.dependencies;if(L!==null){var q=D.child;L=L.firstContext;e:for(;L!==null;){var se=L;L=D;for(var Ce=0;Ce<h.length;Ce++)if(se.context===h[Ce]){L.lanes|=g,se=L.alternate,se!==null&&(se.lanes|=g),Vd(L.return,g,a),w||(q=null);break e}L=se.next}}else if(D.tag===18){if(q=D.return,q===null)throw Error(u(341));q.lanes|=g,L=q.alternate,L!==null&&(L.lanes|=g),Vd(q,g,a),q=null}else q=D.child;if(q!==null)q.return=D;else for(q=D;q!==null;){if(q===a){q=null;break}if(D=q.sibling,D!==null){D.return=q.return,q=D;break}q=q.return}D=q}}function hu(a,h,g,w){a=null;for(var D=h,L=!1;D!==null;){if(!L){if((D.flags&524288)!==0)L=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var q=D.alternate;if(q===null)throw Error(u(387));if(q=q.memoizedProps,q!==null){var se=D.type;ba(D.pendingProps.value,q.value)||(a!==null?a.push(se):a=[se])}}else if(D===Ln.current){if(q=D.alternate,q===null)throw Error(u(387));q.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(a!==null?a.push(Z):a=[Z])}D=D.return}a!==null&&Gd(h,a,g,w),h.flags|=262144}function Ih(a){for(a=a.firstContext;a!==null;){if(!ba(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Pl(a){Ka=a,yo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Ai(a){return wa(Ka,a)}function Ks(a,h){return Ka===null&&Pl(a),wa(a,h)}function wa(a,h){var g=h._currentValue;if(h={context:h,memoizedValue:g,next:null},yo===null){if(a===null)throw Error(u(308));yo=h,a.dependencies={lanes:0,firstContext:h},a.flags|=524288}else yo=yo.next=h;return g}var du=typeof AbortController<"u"?AbortController:function(){var a=[],h=this.signal={aborted:!1,addEventListener:function(g,w){a.push(w)}};this.abort=function(){h.aborted=!0,a.forEach(function(g){return g()})}},ip=n.unstable_scheduleCallback,mm=n.unstable_NormalPriority,mr={$$typeof:we,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ol(){return{controller:new du,data:new Map,refCount:0}}function _c(a){a.refCount--,a.refCount===0&&ip(mm,function(){a.controller.abort()})}var Es=null,$d=0,Sr=0,oa=null;function fu(a,h){if(Es===null){var g=Es=[];$d=0,Sr=jy(),oa={status:"pending",value:void 0,then:function(w){g.push(w)}}}return $d++,h.then(_o,_o),h}function _o(){if(--$d===0&&Es!==null){oa!==null&&(oa.status="fulfilled");var a=Es;Es=null,Sr=0,oa=null;for(var h=0;h<a.length;h++)(0,a[h])()}}function pu(a,h){var g=[],w={status:"pending",value:null,reason:null,then:function(D){g.push(D)}};return a.then(function(){w.status="fulfilled",w.value=h;for(var D=0;D<g.length;D++)(0,g[D])(h)},function(D){for(w.status="rejected",w.reason=D,D=0;D<g.length;D++)(0,g[D])(void 0)}),w}var gm=Be.S;Be.S=function(a,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&fu(a,h),gm!==null&&gm(a,h)};var Bo=nt(null);function rp(){var a=Bo.current;return a!==null?a:mi.pooledCache}function Zd(a,h){h===null?pt(Bo,Bo.current):pt(Bo,h.pool)}function mu(){var a=rp();return a===null?null:{parent:mr._currentValue,pool:a}}var Js=Error(u(460)),vo=Error(u(474)),kt=Error(u(542)),Rh={then:function(){}};function kh(a){return a=a.status,a==="fulfilled"||a==="rejected"}function gu(){}function vc(a,h,g){switch(g=a[g],g===void 0?a.push(h):g!==h&&(h.then(gu,gu),h=g),h.status){case"fulfilled":return h.value;case"rejected":throw a=h.reason,In(a),a;default:if(typeof h.status=="string")h.then(gu,gu);else{if(a=mi,a!==null&&100<a.shellSuspendCounter)throw Error(u(482));a=h,a.status="pending",a.then(function(w){if(h.status==="pending"){var D=h;D.status="fulfilled",D.value=w}},function(w){if(h.status==="pending"){var D=h;D.status="rejected",D.reason=w}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw a=h.reason,In(a),a}throw Uo=h,Js}}var Uo=null;function Ph(){if(Uo===null)throw Error(u(459));var a=Uo;return Uo=null,a}function In(a){if(a===Js||a===kt)throw Error(u(483))}var Vo=!1;function ap(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yu(a,h){a=a.updateQueue,h.updateQueue===a&&(h.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ll(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function el(a,h,g){var w=a.updateQueue;if(w===null)return null;if(w=w.shared,(ui&2)!==0){var D=w.pending;return D===null?h.next=h:(h.next=D.next,D.next=h),w.pending=h,h=lu(a),ep(a,null,g),h}return Sh(a,w,h,g),lu(a)}function bc(a,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194048)!==0)){var w=h.lanes;w&=a.pendingLanes,g|=w,h.lanes=g,$t(a,g)}}function Oh(a,h){var g=a.updateQueue,w=a.alternate;if(w!==null&&(w=w.updateQueue,g===w)){var D=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var q={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};L===null?D=L=q:L=L.next=q,g=g.next}while(g!==null);L===null?D=L=h:L=L.next=h}else D=L=h;g={baseState:w.baseState,firstBaseUpdate:D,lastBaseUpdate:L,shared:w.shared,callbacks:w.callbacks},a.updateQueue=g;return}a=g.lastBaseUpdate,a===null?g.firstBaseUpdate=h:a.next=h,g.lastBaseUpdate=h}var Yd=!1;function _u(){if(Yd){var a=oa;if(a!==null)throw a}}function xc(a,h,g,w){Yd=!1;var D=a.updateQueue;Vo=!1;var L=D.firstBaseUpdate,q=D.lastBaseUpdate,se=D.shared.pending;if(se!==null){D.shared.pending=null;var Ce=se,He=Ce.next;Ce.next=null,q===null?L=He:q.next=He,q=Ce;var st=a.alternate;st!==null&&(st=st.updateQueue,se=st.lastBaseUpdate,se!==q&&(se===null?st.firstBaseUpdate=He:se.next=He,st.lastBaseUpdate=Ce))}if(L!==null){var ft=D.baseState;q=0,st=He=Ce=null,se=L;do{var Ke=se.lane&-536870913,et=Ke!==se.lane;if(et?(Kn&Ke)===Ke:(w&Ke)===Ke){Ke!==0&&Ke===Sr&&(Yd=!0),st!==null&&(st=st.next={lane:0,tag:se.tag,payload:se.payload,callback:null,next:null});e:{var fn=a,sn=se;Ke=h;var gi=g;switch(sn.tag){case 1:if(fn=sn.payload,typeof fn=="function"){ft=fn.call(gi,ft,Ke);break e}ft=fn;break e;case 3:fn.flags=fn.flags&-65537|128;case 0:if(fn=sn.payload,Ke=typeof fn=="function"?fn.call(gi,ft,Ke):fn,Ke==null)break e;ft=k({},ft,Ke);break e;case 2:Vo=!0}}Ke=se.callback,Ke!==null&&(a.flags|=64,et&&(a.flags|=8192),et=D.callbacks,et===null?D.callbacks=[Ke]:et.push(Ke))}else et={lane:Ke,tag:se.tag,payload:se.payload,callback:se.callback,next:null},st===null?(He=st=et,Ce=ft):st=st.next=et,q|=Ke;if(se=se.next,se===null){if(se=D.shared.pending,se===null)break;et=se,se=et.next,et.next=null,D.lastBaseUpdate=et,D.shared.pending=null}}while(!0);st===null&&(Ce=ft),D.baseState=Ce,D.firstBaseUpdate=He,D.lastBaseUpdate=st,L===null&&(D.shared.lanes=0),Au|=q,a.lanes=q,a.memoizedState=ft}}function op(a,h){if(typeof a!="function")throw Error(u(191,a));a.call(h)}function sp(a,h){var g=a.callbacks;if(g!==null)for(a.callbacks=null,a=0;a<g.length;a++)op(g[a],h)}var sa=nt(null),ti=nt(0);function Hd(a,h){a=Ho,pt(ti,a),pt(sa,h),Ho=a|h.baseLanes}function vu(){pt(ti,Ho),pt(sa,sa.current)}function Lh(){Ho=ti.current,yt(sa),yt(ti)}var Ms=0,An=null,ri=null,gr=null,Ja=!1,tl=!1,Nt=!1,qt=0,eo=0,Nl=null,qd=0;function $n(){throw Error(u(321))}function Nh(a,h){if(h===null)return!1;for(var g=0;g<h.length&&g<a.length;g++)if(!ba(a[g],h[g]))return!1;return!0}function to(a,h,g,w,D,L){return Ms=L,An=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Be.H=a===null||a.memoizedState===null?$o:Zo,Nt=!1,L=g(w,D),Nt=!1,tl&&(L=bo(h,g,w,D)),ym(a),L}function ym(a){Be.H=la;var h=ri!==null&&ri.next!==null;if(Ms=0,gr=ri=An=null,Ja=!1,eo=0,Nl=null,h)throw Error(u(300));a===null||Ar||(a=a.dependencies,a!==null&&Ih(a)&&(Ar=!0))}function bo(a,h,g,w){An=a;var D=0;do{if(tl&&(Nl=null),eo=0,tl=!1,25<=D)throw Error(u(301));if(D+=1,gr=ri=null,a.updateQueue!=null){var L=a.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}Be.H=no,L=h(g,w)}while(tl);return L}function Gi(){var a=Be.H,h=a.useState()[0];return h=typeof h.then=="function"?wc(h):h,a=a.useState()[0],(ri!==null?ri.memoizedState:null)!==a&&(An.flags|=1024),h}function Li(){var a=qt!==0;return qt=0,a}function zh(a,h,g){h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~g}function nl(a){if(Ja){for(a=a.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}Ja=!1}Ms=0,gr=ri=An=null,tl=!1,eo=qt=0,Nl=null}function Wr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?An.memoizedState=gr=a:gr=gr.next=a,gr}function Ni(){if(ri===null){var a=An.alternate;a=a!==null?a.memoizedState:null}else a=ri.next;var h=gr===null?An.memoizedState:gr.next;if(h!==null)gr=h,ri=a;else{if(a===null)throw An.alternate===null?Error(u(467)):Error(u(310));ri=a,a={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},gr===null?An.memoizedState=gr=a:gr=gr.next=a}return gr}function il(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wc(a){var h=eo;return eo+=1,Nl===null&&(Nl=[]),a=vc(Nl,a,h),h=An,(gr===null?h.memoizedState:gr.next)===null&&(h=h.alternate,Be.H=h===null||h.memoizedState===null?$o:Zo),a}function rl(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return wc(a);if(a.$$typeof===we)return Ai(a)}throw Error(u(438,String(a)))}function al(a){var h=null,g=An.updateQueue;if(g!==null&&(h=g.memoCache),h==null){var w=An.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(h={data:w.data.map(function(D){return D.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),g===null&&(g=il(),An.updateQueue=g),g.memoCache=h,g=h.data[h.index],g===void 0)for(g=h.data[h.index]=Array(a),w=0;w<a;w++)g[w]=Qe;return h.index++,g}function Go(a,h){return typeof h=="function"?h(a):h}function bu(a){var h=Ni();return xu(h,ri,a)}function xu(a,h,g){var w=a.queue;if(w===null)throw Error(u(311));w.lastRenderedReducer=g;var D=a.baseQueue,L=w.pending;if(L!==null){if(D!==null){var q=D.next;D.next=L.next,L.next=q}h.baseQueue=D=L,w.pending=null}if(L=a.baseState,D===null)a.memoizedState=L;else{h=D.next;var se=q=null,Ce=null,He=h,st=!1;do{var ft=He.lane&-536870913;if(ft!==He.lane?(Kn&ft)===ft:(Ms&ft)===ft){var Ke=He.revertLane;if(Ke===0)Ce!==null&&(Ce=Ce.next={lane:0,revertLane:0,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null}),ft===Sr&&(st=!0);else if((Ms&Ke)===Ke){He=He.next,Ke===Sr&&(st=!0);continue}else ft={lane:0,revertLane:He.revertLane,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null},Ce===null?(se=Ce=ft,q=L):Ce=Ce.next=ft,An.lanes|=Ke,Au|=Ke;ft=He.action,Nt&&g(L,ft),L=He.hasEagerState?He.eagerState:g(L,ft)}else Ke={lane:ft,revertLane:He.revertLane,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null},Ce===null?(se=Ce=Ke,q=L):Ce=Ce.next=Ke,An.lanes|=ft,Au|=ft;He=He.next}while(He!==null&&He!==h);if(Ce===null?q=L:Ce.next=se,!ba(L,a.memoizedState)&&(Ar=!0,st&&(g=oa,g!==null)))throw g;a.memoizedState=L,a.baseState=q,a.baseQueue=Ce,w.lastRenderedState=L}return D===null&&(w.lanes=0),[a.memoizedState,w.dispatch]}function jh(a){var h=Ni(),g=h.queue;if(g===null)throw Error(u(311));g.lastRenderedReducer=a;var w=g.dispatch,D=g.pending,L=h.memoizedState;if(D!==null){g.pending=null;var q=D=D.next;do L=a(L,q.action),q=q.next;while(q!==D);ba(L,h.memoizedState)||(Ar=!0),h.memoizedState=L,h.baseQueue===null&&(h.baseState=L),g.lastRenderedState=L}return[L,w]}function b(a,h,g){var w=An,D=Ni(),L=Qn;if(L){if(g===void 0)throw Error(u(407));g=g()}else g=h();var q=!ba((ri||D).memoizedState,g);q&&(D.memoizedState=g,Ar=!0),D=D.queue;var se=p.bind(null,w,D,a);if(Ne(2048,8,se,[a]),D.getSnapshot!==h||q||gr!==null&&gr.memoizedState.tag&1){if(w.flags|=2048,ye(9,Se(),c.bind(null,w,D,g,h),null),mi===null)throw Error(u(349));L||(Ms&124)!==0||t(w,h,g)}return g}function t(a,h,g){a.flags|=16384,a={getSnapshot:h,value:g},h=An.updateQueue,h===null?(h=il(),An.updateQueue=h,h.stores=[a]):(g=h.stores,g===null?h.stores=[a]:g.push(a))}function c(a,h,g,w){h.value=g,h.getSnapshot=w,v(h)&&T(a)}function p(a,h,g){return g(function(){v(h)&&T(a)})}function v(a){var h=a.getSnapshot;a=a.value;try{var g=h();return!ba(a,g)}catch{return!0}}function T(a){var h=Ha(a,2);h!==null&&Ao(h,a,2)}function M(a){var h=Wr();if(typeof a=="function"){var g=a;if(a=g(),Nt){xr(!0);try{g()}finally{xr(!1)}}}return h.memoizedState=h.baseState=a,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:a},h}function R(a,h,g,w){return a.baseState=g,xu(a,ri,typeof w=="function"?w:Go)}function P(a,h,g,w,D){if(Tc(a))throw Error(u(485));if(a=h.action,a!==null){var L={payload:D,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){L.listeners.push(q)}};Be.T!==null?g(!0):L.isTransition=!1,w(L),g=h.pending,g===null?(L.next=h.pending=L,j(h,L)):(L.next=g.next,h.pending=g.next=L)}}function j(a,h){var g=h.action,w=h.payload,D=a.state;if(h.isTransition){var L=Be.T,q={};Be.T=q;try{var se=g(D,w),Ce=Be.S;Ce!==null&&Ce(q,se),U(a,h,se)}catch(He){G(a,h,He)}finally{Be.T=L}}else try{L=g(D,w),U(a,h,L)}catch(He){G(a,h,He)}}function U(a,h,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(w){$(a,h,w)},function(w){return G(a,h,w)}):$(a,h,g)}function $(a,h,g){h.status="fulfilled",h.value=g,Y(h),a.state=g,h=a.pending,h!==null&&(g=h.next,g===h?a.pending=null:(g=g.next,h.next=g,j(a,g)))}function G(a,h,g){var w=a.pending;if(a.pending=null,w!==null){w=w.next;do h.status="rejected",h.reason=g,Y(h),h=h.next;while(h!==w)}a.action=null}function Y(a){a=a.listeners;for(var h=0;h<a.length;h++)(0,a[h])()}function ee(a,h){return h}function he(a,h){if(Qn){var g=mi.formState;if(g!==null){e:{var w=An;if(Qn){if(Ui){t:{for(var D=Ui,L=Qa;D.nodeType!==8;){if(!L){D=null;break t}if(D=Co(D.nextSibling),D===null){D=null;break t}}L=D.data,D=L==="F!"||L==="F"?D:null}if(D){Ui=Co(D.nextSibling),w=D.data==="F!";break e}}yc(w)}w=!1}w&&(h=g[0])}}return g=Wr(),g.memoizedState=g.baseState=h,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ee,lastRenderedState:h},g.queue=w,g=xo.bind(null,An,w),w.dispatch=g,w=M(!1),L=ol.bind(null,An,!1,w.queue),w=Wr(),D={state:h,dispatch:null,action:a,pending:null},w.queue=D,g=P.bind(null,An,D,L,g),D.dispatch=g,w.memoizedState=a,[h,g,!1]}function ue(a){var h=Ni();return fe(h,ri,a)}function fe(a,h,g){if(h=xu(a,h,ee)[0],a=bu(Go)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var w=wc(h)}catch(q){throw q===Js?kt:q}else w=h;h=Ni();var D=h.queue,L=D.dispatch;return g!==h.memoizedState&&(An.flags|=2048,ye(9,Se(),pe.bind(null,D,g),null)),[w,L,a]}function pe(a,h){a.action=h}function ve(a){var h=Ni(),g=ri;if(g!==null)return fe(h,g,a);Ni(),h=h.memoizedState,g=Ni();var w=g.queue.dispatch;return g.memoizedState=a,[h,w,!1]}function ye(a,h,g,w){return a={tag:a,create:g,deps:w,inst:h,next:null},h=An.updateQueue,h===null&&(h=il(),An.updateQueue=h),g=h.lastEffect,g===null?h.lastEffect=a.next=a:(w=g.next,g.next=a,a.next=w,h.lastEffect=a),a}function Se(){return{destroy:void 0,resource:void 0}}function Re(){return Ni().memoizedState}function _e(a,h,g,w){var D=Wr();w=w===void 0?null:w,An.flags|=a,D.memoizedState=ye(1|h,Se(),g,w)}function Ne(a,h,g,w){var D=Ni();w=w===void 0?null:w;var L=D.memoizedState.inst;ri!==null&&w!==null&&Nh(w,ri.memoizedState.deps)?D.memoizedState=ye(h,L,g,w):(An.flags|=a,D.memoizedState=ye(1|h,L,g,w))}function We(a,h){_e(8390656,8,a,h)}function Ve(a,h){Ne(2048,8,a,h)}function $e(a,h){return Ne(4,2,a,h)}function Xe(a,h){return Ne(4,4,a,h)}function Mt(a,h){if(typeof h=="function"){a=a();var g=h(a);return function(){typeof g=="function"?g():h(null)}}if(h!=null)return a=a(),h.current=a,function(){h.current=null}}function vt(a,h,g){g=g!=null?g.concat([a]):null,Ne(4,4,Mt.bind(null,h,a),g)}function ct(){}function Bt(a,h){var g=Ni();h=h===void 0?null:h;var w=g.memoizedState;return h!==null&&Nh(h,w[1])?w[0]:(g.memoizedState=[a,h],a)}function bn(a,h){var g=Ni();h=h===void 0?null:h;var w=g.memoizedState;if(h!==null&&Nh(h,w[1]))return w[0];if(w=a(),Nt){xr(!0);try{a()}finally{xr(!1)}}return g.memoizedState=[w,h],w}function jn(a,h,g){return g===void 0||(Ms&1073741824)!==0?a.memoizedState=h:(a.memoizedState=g,a=jm(),An.lanes|=a,Au|=a,g)}function zi(a,h,g,w){return ba(g,h)?g:sa.current!==null?(a=jn(a,g,w),ba(a,h)||(Ar=!0),a):(Ms&42)===0?(Ar=!0,a.memoizedState=g):(a=jm(),An.lanes|=a,Au|=a,h)}function qn(a,h,g,w,D){var L=lt.p;lt.p=L!==0&&8>L?L:8;var q=Be.T,se={};Be.T=se,ol(a,!1,h,g);try{var Ce=D(),He=Be.S;if(He!==null&&He(se,Ce),Ce!==null&&typeof Ce=="object"&&typeof Ce.then=="function"){var st=pu(Ce,w);wo(a,h,st,ai(a))}else wo(a,h,w,ai(a))}catch(ft){wo(a,h,{then:function(){},status:"rejected",reason:ft},ai())}finally{lt.p=L,Be.T=q}}function Ci(){}function ji(a,h,g,w){if(a.tag!==5)throw Error(u(476));var D=pi(a).queue;qn(a,D,h,_t,g===null?Ci:function(){return un(a),g(w)})}function pi(a){var h=a.memoizedState;if(h!==null)return h;h={memoizedState:_t,baseState:_t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:_t},next:null};var g={};return h.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:g},next:null},a.memoizedState=h,a=a.alternate,a!==null&&(a.memoizedState=h),h}function un(a){var h=pi(a).next.queue;wo(a,h,{},ai())}function yr(){return Ai(Z)}function Ji(){return Ni().memoizedState}function Er(){return Ni().memoizedState}function Ta(a){for(var h=a.return;h!==null;){switch(h.tag){case 24:case 3:var g=ai();a=Ll(g);var w=el(h,a,g);w!==null&&(Ao(w,h,g),bc(w,h,g)),h={cache:Ol()},a.payload=h;return}h=h.return}}function zl(a,h,g){var w=ai();g={lane:w,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},Tc(a)?Sc(h,g):(g=Cl(a,h,g,w),g!==null&&(Ao(g,a,w),As(g,h,w)))}function xo(a,h,g){var w=ai();wo(a,h,g,w)}function wo(a,h,g,w){var D={lane:w,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(Tc(a))Sc(h,D);else{var L=a.alternate;if(a.lanes===0&&(L===null||L.lanes===0)&&(L=h.lastRenderedReducer,L!==null))try{var q=h.lastRenderedState,se=L(q,g);if(D.hasEagerState=!0,D.eagerState=se,ba(se,q))return Sh(a,h,D,0),mi===null&&gc(),!1}catch{}finally{}if(g=Cl(a,h,D,w),g!==null)return Ao(g,a,w),As(g,h,w),!0}return!1}function ol(a,h,g,w){if(w={lane:2,revertLane:jy(),action:w,hasEagerState:!1,eagerState:null,next:null},Tc(a)){if(h)throw Error(u(479))}else h=Cl(a,g,w,2),h!==null&&Ao(h,a,2)}function Tc(a){var h=a.alternate;return a===An||h!==null&&h===An}function Sc(a,h){tl=Ja=!0;var g=a.pending;g===null?h.next=h:(h.next=g.next,g.next=h),a.pending=h}function As(a,h,g){if((g&4194048)!==0){var w=h.lanes;w&=a.pendingLanes,g|=w,h.lanes=g,$t(a,g)}}var la={readContext:Ai,use:rl,useCallback:$n,useContext:$n,useEffect:$n,useImperativeHandle:$n,useLayoutEffect:$n,useInsertionEffect:$n,useMemo:$n,useReducer:$n,useRef:$n,useState:$n,useDebugValue:$n,useDeferredValue:$n,useTransition:$n,useSyncExternalStore:$n,useId:$n,useHostTransitionStatus:$n,useFormState:$n,useActionState:$n,useOptimistic:$n,useMemoCache:$n,useCacheRefresh:$n},$o={readContext:Ai,use:rl,useCallback:function(a,h){return Wr().memoizedState=[a,h===void 0?null:h],a},useContext:Ai,useEffect:We,useImperativeHandle:function(a,h,g){g=g!=null?g.concat([a]):null,_e(4194308,4,Mt.bind(null,h,a),g)},useLayoutEffect:function(a,h){return _e(4194308,4,a,h)},useInsertionEffect:function(a,h){_e(4,2,a,h)},useMemo:function(a,h){var g=Wr();h=h===void 0?null:h;var w=a();if(Nt){xr(!0);try{a()}finally{xr(!1)}}return g.memoizedState=[w,h],w},useReducer:function(a,h,g){var w=Wr();if(g!==void 0){var D=g(h);if(Nt){xr(!0);try{g(h)}finally{xr(!1)}}}else D=h;return w.memoizedState=w.baseState=D,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:D},w.queue=a,a=a.dispatch=zl.bind(null,An,a),[w.memoizedState,a]},useRef:function(a){var h=Wr();return a={current:a},h.memoizedState=a},useState:function(a){a=M(a);var h=a.queue,g=xo.bind(null,An,h);return h.dispatch=g,[a.memoizedState,g]},useDebugValue:ct,useDeferredValue:function(a,h){var g=Wr();return jn(g,a,h)},useTransition:function(){var a=M(!1);return a=qn.bind(null,An,a.queue,!0,!1),Wr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,h,g){var w=An,D=Wr();if(Qn){if(g===void 0)throw Error(u(407));g=g()}else{if(g=h(),mi===null)throw Error(u(349));(Kn&124)!==0||t(w,h,g)}D.memoizedState=g;var L={value:g,getSnapshot:h};return D.queue=L,We(p.bind(null,w,L,a),[a]),w.flags|=2048,ye(9,Se(),c.bind(null,w,L,g,h),null),g},useId:function(){var a=Wr(),h=mi.identifierPrefix;if(Qn){var g=go,w=Wa;g=(w&~(1<<32-Pe(w)-1)).toString(32)+g,h="«"+h+"R"+g,g=qt++,0<g&&(h+="H"+g.toString(32)),h+="»"}else g=qd++,h="«"+h+"r"+g.toString(32)+"»";return a.memoizedState=h},useHostTransitionStatus:yr,useFormState:he,useActionState:he,useOptimistic:function(a){var h=Wr();h.memoizedState=h.baseState=a;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=g,h=ol.bind(null,An,!0,g),g.dispatch=h,[a,h]},useMemoCache:al,useCacheRefresh:function(){return Wr().memoizedState=Ta.bind(null,An)}},Zo={readContext:Ai,use:rl,useCallback:Bt,useContext:Ai,useEffect:Ve,useImperativeHandle:vt,useInsertionEffect:$e,useLayoutEffect:Xe,useMemo:bn,useReducer:bu,useRef:Re,useState:function(){return bu(Go)},useDebugValue:ct,useDeferredValue:function(a,h){var g=Ni();return zi(g,ri.memoizedState,a,h)},useTransition:function(){var a=bu(Go)[0],h=Ni().memoizedState;return[typeof a=="boolean"?a:wc(a),h]},useSyncExternalStore:b,useId:Ji,useHostTransitionStatus:yr,useFormState:ue,useActionState:ue,useOptimistic:function(a,h){var g=Ni();return R(g,ri,a,h)},useMemoCache:al,useCacheRefresh:Er},no={readContext:Ai,use:rl,useCallback:Bt,useContext:Ai,useEffect:Ve,useImperativeHandle:vt,useInsertionEffect:$e,useLayoutEffect:Xe,useMemo:bn,useReducer:jh,useRef:Re,useState:function(){return jh(Go)},useDebugValue:ct,useDeferredValue:function(a,h){var g=Ni();return ri===null?jn(g,a,h):zi(g,ri.memoizedState,a,h)},useTransition:function(){var a=jh(Go)[0],h=Ni().memoizedState;return[typeof a=="boolean"?a:wc(a),h]},useSyncExternalStore:b,useId:Ji,useHostTransitionStatus:yr,useFormState:ve,useActionState:ve,useOptimistic:function(a,h){var g=Ni();return ri!==null?R(g,ri,a,h):(g.baseState=a,[a,g.queue.dispatch])},useMemoCache:al,useCacheRefresh:Er},_i=null,Xi=0;function ca(a){var h=Xi;return Xi+=1,_i===null&&(_i=[]),vc(_i,a,h)}function er(a,h){h=h.props.ref,a.ref=h!==void 0?h:null}function wu(a,h){throw h.$$typeof===N?Error(u(525)):(a=Object.prototype.toString.call(h),Error(u(31,a==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":a)))}function Tu(a){var h=a._init;return h(a._payload)}function Ec(a){function h(Ue,Le){if(a){var qe=Ue.deletions;qe===null?(Ue.deletions=[Le],Ue.flags|=16):qe.push(Le)}}function g(Ue,Le){if(!a)return null;for(;Le!==null;)h(Ue,Le),Le=Le.sibling;return null}function w(Ue){for(var Le=new Map;Ue!==null;)Ue.key!==null?Le.set(Ue.key,Ue):Le.set(Ue.index,Ue),Ue=Ue.sibling;return Le}function D(Ue,Le){return Ue=na(Ue,Le),Ue.index=0,Ue.sibling=null,Ue}function L(Ue,Le,qe){return Ue.index=qe,a?(qe=Ue.alternate,qe!==null?(qe=qe.index,qe<Le?(Ue.flags|=67108866,Le):qe):(Ue.flags|=67108866,Le)):(Ue.flags|=1048576,Le)}function q(Ue){return a&&Ue.alternate===null&&(Ue.flags|=67108866),Ue}function se(Ue,Le,qe,dt){return Le===null||Le.tag!==6?(Le=np(qe,Ue.mode,dt),Le.return=Ue,Le):(Le=D(Le,qe),Le.return=Ue,Le)}function Ce(Ue,Le,qe,dt){var Ht=qe.type;return Ht===W?st(Ue,Le,qe.props.children,dt,qe.key):Le!==null&&(Le.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===at&&Tu(Ht)===Le.type)?(Le=D(Le,qe.props),er(Le,qe),Le.return=Ue,Le):(Le=Fd(qe.type,qe.key,qe.props,null,Ue.mode,dt),er(Le,qe),Le.return=Ue,Le)}function He(Ue,Le,qe,dt){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==qe.containerInfo||Le.stateNode.implementation!==qe.implementation?(Le=Mh(qe,Ue.mode,dt),Le.return=Ue,Le):(Le=D(Le,qe.children||[]),Le.return=Ue,Le)}function st(Ue,Le,qe,dt,Ht){return Le===null||Le.tag!==7?(Le=Dl(qe,Ue.mode,dt,Ht),Le.return=Ue,Le):(Le=D(Le,qe),Le.return=Ue,Le)}function ft(Ue,Le,qe){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Le=np(""+Le,Ue.mode,qe),Le.return=Ue,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case F:return qe=Fd(Le.type,Le.key,Le.props,null,Ue.mode,qe),er(qe,Le),qe.return=Ue,qe;case B:return Le=Mh(Le,Ue.mode,qe),Le.return=Ue,Le;case at:var dt=Le._init;return Le=dt(Le._payload),ft(Ue,Le,qe)}if(Ft(Le)||bt(Le))return Le=Dl(Le,Ue.mode,qe,null),Le.return=Ue,Le;if(typeof Le.then=="function")return ft(Ue,ca(Le),qe);if(Le.$$typeof===we)return ft(Ue,Ks(Ue,Le),qe);wu(Ue,Le)}return null}function Ke(Ue,Le,qe,dt){var Ht=Le!==null?Le.key:null;if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return Ht!==null?null:se(Ue,Le,""+qe,dt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case F:return qe.key===Ht?Ce(Ue,Le,qe,dt):null;case B:return qe.key===Ht?He(Ue,Le,qe,dt):null;case at:return Ht=qe._init,qe=Ht(qe._payload),Ke(Ue,Le,qe,dt)}if(Ft(qe)||bt(qe))return Ht!==null?null:st(Ue,Le,qe,dt,null);if(typeof qe.then=="function")return Ke(Ue,Le,ca(qe),dt);if(qe.$$typeof===we)return Ke(Ue,Le,Ks(Ue,qe),dt);wu(Ue,qe)}return null}function et(Ue,Le,qe,dt,Ht){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return Ue=Ue.get(qe)||null,se(Le,Ue,""+dt,Ht);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case F:return Ue=Ue.get(dt.key===null?qe:dt.key)||null,Ce(Le,Ue,dt,Ht);case B:return Ue=Ue.get(dt.key===null?qe:dt.key)||null,He(Le,Ue,dt,Ht);case at:var Fn=dt._init;return dt=Fn(dt._payload),et(Ue,Le,qe,dt,Ht)}if(Ft(dt)||bt(dt))return Ue=Ue.get(qe)||null,st(Le,Ue,dt,Ht,null);if(typeof dt.then=="function")return et(Ue,Le,qe,ca(dt),Ht);if(dt.$$typeof===we)return et(Ue,Le,qe,Ks(Le,dt),Ht);wu(Le,dt)}return null}function fn(Ue,Le,qe,dt){for(var Ht=null,Fn=null,en=Le,hn=Le=0,ma=null;en!==null&&hn<qe.length;hn++){en.index>hn?(ma=en,en=null):ma=en.sibling;var oi=Ke(Ue,en,qe[hn],dt);if(oi===null){en===null&&(en=ma);break}a&&en&&oi.alternate===null&&h(Ue,en),Le=L(oi,Le,hn),Fn===null?Ht=oi:Fn.sibling=oi,Fn=oi,en=ma}if(hn===qe.length)return g(Ue,en),Qn&&Ws(Ue,hn),Ht;if(en===null){for(;hn<qe.length;hn++)en=ft(Ue,qe[hn],dt),en!==null&&(Le=L(en,Le,hn),Fn===null?Ht=en:Fn.sibling=en,Fn=en);return Qn&&Ws(Ue,hn),Ht}for(en=w(en);hn<qe.length;hn++)ma=et(en,Ue,hn,qe[hn],dt),ma!==null&&(a&&ma.alternate!==null&&en.delete(ma.key===null?hn:ma.key),Le=L(ma,Le,hn),Fn===null?Ht=ma:Fn.sibling=ma,Fn=ma);return a&&en.forEach(function(zu){return h(Ue,zu)}),Qn&&Ws(Ue,hn),Ht}function sn(Ue,Le,qe,dt){if(qe==null)throw Error(u(151));for(var Ht=null,Fn=null,en=Le,hn=Le=0,ma=null,oi=qe.next();en!==null&&!oi.done;hn++,oi=qe.next()){en.index>hn?(ma=en,en=null):ma=en.sibling;var zu=Ke(Ue,en,oi.value,dt);if(zu===null){en===null&&(en=ma);break}a&&en&&zu.alternate===null&&h(Ue,en),Le=L(zu,Le,hn),Fn===null?Ht=zu:Fn.sibling=zu,Fn=zu,en=ma}if(oi.done)return g(Ue,en),Qn&&Ws(Ue,hn),Ht;if(en===null){for(;!oi.done;hn++,oi=qe.next())oi=ft(Ue,oi.value,dt),oi!==null&&(Le=L(oi,Le,hn),Fn===null?Ht=oi:Fn.sibling=oi,Fn=oi);return Qn&&Ws(Ue,hn),Ht}for(en=w(en);!oi.done;hn++,oi=qe.next())oi=et(en,Ue,hn,oi.value,dt),oi!==null&&(a&&oi.alternate!==null&&en.delete(oi.key===null?hn:oi.key),Le=L(oi,Le,hn),Fn===null?Ht=oi:Fn.sibling=oi,Fn=oi);return a&&en.forEach(function(Xb){return h(Ue,Xb)}),Qn&&Ws(Ue,hn),Ht}function gi(Ue,Le,qe,dt){if(typeof qe=="object"&&qe!==null&&qe.type===W&&qe.key===null&&(qe=qe.props.children),typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case F:e:{for(var Ht=qe.key;Le!==null;){if(Le.key===Ht){if(Ht=qe.type,Ht===W){if(Le.tag===7){g(Ue,Le.sibling),dt=D(Le,qe.props.children),dt.return=Ue,Ue=dt;break e}}else if(Le.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===at&&Tu(Ht)===Le.type){g(Ue,Le.sibling),dt=D(Le,qe.props),er(dt,qe),dt.return=Ue,Ue=dt;break e}g(Ue,Le);break}else h(Ue,Le);Le=Le.sibling}qe.type===W?(dt=Dl(qe.props.children,Ue.mode,dt,qe.key),dt.return=Ue,Ue=dt):(dt=Fd(qe.type,qe.key,qe.props,null,Ue.mode,dt),er(dt,qe),dt.return=Ue,Ue=dt)}return q(Ue);case B:e:{for(Ht=qe.key;Le!==null;){if(Le.key===Ht)if(Le.tag===4&&Le.stateNode.containerInfo===qe.containerInfo&&Le.stateNode.implementation===qe.implementation){g(Ue,Le.sibling),dt=D(Le,qe.children||[]),dt.return=Ue,Ue=dt;break e}else{g(Ue,Le);break}else h(Ue,Le);Le=Le.sibling}dt=Mh(qe,Ue.mode,dt),dt.return=Ue,Ue=dt}return q(Ue);case at:return Ht=qe._init,qe=Ht(qe._payload),gi(Ue,Le,qe,dt)}if(Ft(qe))return fn(Ue,Le,qe,dt);if(bt(qe)){if(Ht=bt(qe),typeof Ht!="function")throw Error(u(150));return qe=Ht.call(qe),sn(Ue,Le,qe,dt)}if(typeof qe.then=="function")return gi(Ue,Le,ca(qe),dt);if(qe.$$typeof===we)return gi(Ue,Le,Ks(Ue,qe),dt);wu(Ue,qe)}return typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint"?(qe=""+qe,Le!==null&&Le.tag===6?(g(Ue,Le.sibling),dt=D(Le,qe),dt.return=Ue,Ue=dt):(g(Ue,Le),dt=np(qe,Ue.mode,dt),dt.return=Ue,Ue=dt),q(Ue)):g(Ue,Le)}return function(Ue,Le,qe,dt){try{Xi=0;var Ht=gi(Ue,Le,qe,dt);return _i=null,Ht}catch(en){if(en===Js||en===kt)throw en;var Fn=qa(29,en,null,Ue.mode);return Fn.lanes=dt,Fn.return=Ue,Fn}finally{}}}var Pa=Ec(!0),To=Ec(!1),Mr=nt(null),Qr=null;function Sa(a){var h=a.alternate;pt(sr,sr.current&1),pt(Mr,a),Qr===null&&(h===null||sa.current!==null||h.memoizedState!==null)&&(Qr=a)}function lp(a){if(a.tag===22){if(pt(sr,sr.current),pt(Mr,a),Qr===null){var h=a.alternate;h!==null&&h.memoizedState!==null&&(Qr=a)}}else Cs()}function Cs(){pt(sr,sr.current),pt(Mr,Mr.current)}function io(a){yt(Mr),Qr===a&&(Qr=null),yt(sr)}var sr=nt(0);function So(a){for(var h=a;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||ig(g)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Mc(a,h,g,w){h=a.memoizedState,g=g(w,h),g=g==null?h:k({},h,g),a.memoizedState=g,a.lanes===0&&(a.updateQueue.baseState=g)}var _m={enqueueSetState:function(a,h,g){a=a._reactInternals;var w=ai(),D=Ll(w);D.payload=h,g!=null&&(D.callback=g),h=el(a,D,w),h!==null&&(Ao(h,a,w),bc(h,a,w))},enqueueReplaceState:function(a,h,g){a=a._reactInternals;var w=ai(),D=Ll(w);D.tag=1,D.payload=h,g!=null&&(D.callback=g),h=el(a,D,w),h!==null&&(Ao(h,a,w),bc(h,a,w))},enqueueForceUpdate:function(a,h){a=a._reactInternals;var g=ai(),w=Ll(g);w.tag=2,h!=null&&(w.callback=h),h=el(a,w,g),h!==null&&(Ao(h,a,g),bc(h,a,g))}};function g_(a,h,g,w,D,L,q){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(w,L,q):h.prototype&&h.prototype.isPureReactComponent?!ou(g,w)||!ou(D,L):!0}function vm(a,h,g,w){a=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,w),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,w),h.state!==a&&_m.enqueueReplaceState(h,h.state,null)}function Su(a,h){var g=h;if("ref"in h){g={};for(var w in h)w!=="ref"&&(g[w]=h[w])}if(a=a.defaultProps){g===h&&(g=k({},g));for(var D in a)g[D]===void 0&&(g[D]=a[D])}return g}var Fh=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function cy(a){Fh(a)}function y_(a){console.error(a)}function bm(a){Fh(a)}function xm(a,h){try{var g=a.onUncaughtError;g(h.value,{componentStack:h.stack})}catch(w){setTimeout(function(){throw w})}}function wm(a,h,g){try{var w=a.onCaughtError;w(g.value,{componentStack:g.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function Tm(a,h,g){return g=Ll(g),g.tag=3,g.payload={element:null},g.callback=function(){xm(a,h)},g}function uy(a){return a=Ll(a),a.tag=3,a}function Bh(a,h,g,w){var D=g.type.getDerivedStateFromError;if(typeof D=="function"){var L=w.value;a.payload=function(){return D(L)},a.callback=function(){wm(h,g,w)}}var q=g.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(a.callback=function(){wm(h,g,w),typeof D!="function"&&(ll===null?ll=new Set([this]):ll.add(this));var se=w.stack;this.componentDidCatch(w.value,{componentStack:se!==null?se:""})})}function Lb(a,h,g,w,D){if(g.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(h=g.alternate,h!==null&&hu(h,g,D,!0),g=Mr.current,g!==null){switch(g.tag){case 13:return Qr===null?Cy():g.alternate===null&&lr===0&&(lr=3),g.flags&=-257,g.flags|=65536,g.lanes=D,w===Rh?g.flags|=16384:(h=g.updateQueue,h===null?g.updateQueue=new Set([w]):h.add(w),Vm(a,w,D)),!1;case 22:return g.flags|=65536,w===Rh?g.flags|=16384:(h=g.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([w])},g.updateQueue=h):(g=h.retryQueue,g===null?h.retryQueue=new Set([w]):g.add(w)),Vm(a,w,D)),!1}throw Error(u(435,g.tag))}return Vm(a,w,D),Cy(),!1}if(Qn)return h=Mr.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=D,w!==Ch&&(a=Error(u(422),{cause:w}),Qs(Nr(a,g)))):(w!==Ch&&(h=Error(u(423),{cause:w}),Qs(Nr(h,g))),a=a.current.alternate,a.flags|=65536,D&=-D,a.lanes|=D,w=Nr(w,g),D=Tm(a.stateNode,w,D),Oh(a,D),lr!==4&&(lr=2)),!1;var L=Error(u(520),{cause:w});if(L=Nr(L,g),sf===null?sf=[L]:sf.push(L),lr!==4&&(lr=2),h===null)return!0;w=Nr(w,g),g=h;do{switch(g.tag){case 3:return g.flags|=65536,a=D&-D,g.lanes|=a,a=Tm(g.stateNode,w,a),Oh(g,a),!1;case 1:if(h=g.type,L=g.stateNode,(g.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(ll===null||!ll.has(L))))return g.flags|=65536,D&=-D,g.lanes|=D,D=uy(D),Bh(D,a,g,w),Oh(g,D),!1}g=g.return}while(g!==null);return!1}var Uh=Error(u(461)),Ar=!1;function zr(a,h,g,w){h.child=a===null?To(h,null,g,w):Pa(h,a.child,g,w)}function __(a,h,g,w,D){g=g.render;var L=h.ref;if("ref"in w){var q={};for(var se in w)se!=="ref"&&(q[se]=w[se])}else q=w;return Pl(h),w=to(a,h,g,q,L,D),se=Li(),a!==null&&!Ar?(zh(a,h,D),Ac(a,h,D)):(Qn&&se&&Ah(h),h.flags|=1,zr(a,h,w,D),h.child)}function v_(a,h,g,w,D){if(a===null){var L=g.type;return typeof L=="function"&&!jd(L)&&L.defaultProps===void 0&&g.compare===null?(h.tag=15,h.type=L,b_(a,h,L,w,D)):(a=Fd(g.type,null,w,h,h.mode,D),a.ref=h.ref,a.return=h,h.child=a)}if(L=a.child,!Rm(a,D)){var q=L.memoizedProps;if(g=g.compare,g=g!==null?g:ou,g(q,w)&&a.ref===h.ref)return Ac(a,h,D)}return h.flags|=1,a=na(L,w),a.ref=h.ref,a.return=h,h.child=a}function b_(a,h,g,w,D){if(a!==null){var L=a.memoizedProps;if(ou(L,w)&&a.ref===h.ref)if(Ar=!1,h.pendingProps=w=L,Rm(a,D))(a.flags&131072)!==0&&(Ar=!0);else return h.lanes=a.lanes,Ac(a,h,D)}return Sm(a,h,g,w,D)}function x_(a,h,g){var w=h.pendingProps,D=w.children,L=a!==null?a.memoizedState:null;if(w.mode==="hidden"){if((h.flags&128)!==0){if(w=L!==null?L.baseLanes|g:g,a!==null){for(D=h.child=a.child,L=0;D!==null;)L=L|D.lanes|D.childLanes,D=D.sibling;h.childLanes=L&~w}else h.childLanes=0,h.child=null;return hy(a,h,w,g)}if((g&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},a!==null&&Zd(h,L!==null?L.cachePool:null),L!==null?Hd(h,L):vu(),lp(h);else return h.lanes=h.childLanes=536870912,hy(a,h,L!==null?L.baseLanes|g:g,g)}else L!==null?(Zd(h,L.cachePool),Hd(h,L),Cs(),h.memoizedState=null):(a!==null&&Zd(h,null),vu(),Cs());return zr(a,h,D,g),h.child}function hy(a,h,g,w){var D=rp();return D=D===null?null:{parent:mr._currentValue,pool:D},h.memoizedState={baseLanes:g,cachePool:D},a!==null&&Zd(h,null),vu(),lp(h),a!==null&&hu(a,h,w,!0),null}function Xd(a,h){var g=h.ref;if(g===null)a!==null&&a.ref!==null&&(h.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(u(284));(a===null||a.ref!==g)&&(h.flags|=4194816)}}function Sm(a,h,g,w,D){return Pl(h),g=to(a,h,g,w,void 0,D),w=Li(),a!==null&&!Ar?(zh(a,h,D),Ac(a,h,D)):(Qn&&w&&Ah(h),h.flags|=1,zr(a,h,g,D),h.child)}function dy(a,h,g,w,D,L){return Pl(h),h.updateQueue=null,g=bo(h,w,g,D),ym(a),w=Li(),a!==null&&!Ar?(zh(a,h,L),Ac(a,h,L)):(Qn&&w&&Ah(h),h.flags|=1,zr(a,h,g,L),h.child)}function w_(a,h,g,w,D){if(Pl(h),h.stateNode===null){var L=vn,q=g.contextType;typeof q=="object"&&q!==null&&(L=Ai(q)),L=new g(w,L),h.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=_m,h.stateNode=L,L._reactInternals=h,L=h.stateNode,L.props=w,L.state=h.memoizedState,L.refs={},ap(h),q=g.contextType,L.context=typeof q=="object"&&q!==null?Ai(q):vn,L.state=h.memoizedState,q=g.getDerivedStateFromProps,typeof q=="function"&&(Mc(h,g,q,w),L.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(q=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),q!==L.state&&_m.enqueueReplaceState(L,L.state,null),xc(h,w,L,D),_u(),L.state=h.memoizedState),typeof L.componentDidMount=="function"&&(h.flags|=4194308),w=!0}else if(a===null){L=h.stateNode;var se=h.memoizedProps,Ce=Su(g,se);L.props=Ce;var He=L.context,st=g.contextType;q=vn,typeof st=="object"&&st!==null&&(q=Ai(st));var ft=g.getDerivedStateFromProps;st=typeof ft=="function"||typeof L.getSnapshotBeforeUpdate=="function",se=h.pendingProps!==se,st||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(se||He!==q)&&vm(h,L,w,q),Vo=!1;var Ke=h.memoizedState;L.state=Ke,xc(h,w,L,D),_u(),He=h.memoizedState,se||Ke!==He||Vo?(typeof ft=="function"&&(Mc(h,g,ft,w),He=h.memoizedState),(Ce=Vo||g_(h,g,Ce,w,Ke,He,q))?(st||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(h.flags|=4194308)):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=w,h.memoizedState=He),L.props=w,L.state=He,L.context=q,w=Ce):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),w=!1)}else{L=h.stateNode,yu(a,h),q=h.memoizedProps,st=Su(g,q),L.props=st,ft=h.pendingProps,Ke=L.context,He=g.contextType,Ce=vn,typeof He=="object"&&He!==null&&(Ce=Ai(He)),se=g.getDerivedStateFromProps,(He=typeof se=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(q!==ft||Ke!==Ce)&&vm(h,L,w,Ce),Vo=!1,Ke=h.memoizedState,L.state=Ke,xc(h,w,L,D),_u();var et=h.memoizedState;q!==ft||Ke!==et||Vo||a!==null&&a.dependencies!==null&&Ih(a.dependencies)?(typeof se=="function"&&(Mc(h,g,se,w),et=h.memoizedState),(st=Vo||g_(h,g,st,w,Ke,et,Ce)||a!==null&&a.dependencies!==null&&Ih(a.dependencies))?(He||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(w,et,Ce),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(w,et,Ce)),typeof L.componentDidUpdate=="function"&&(h.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof L.componentDidUpdate!="function"||q===a.memoizedProps&&Ke===a.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||q===a.memoizedProps&&Ke===a.memoizedState||(h.flags|=1024),h.memoizedProps=w,h.memoizedState=et),L.props=w,L.state=et,L.context=Ce,w=st):(typeof L.componentDidUpdate!="function"||q===a.memoizedProps&&Ke===a.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||q===a.memoizedProps&&Ke===a.memoizedState||(h.flags|=1024),w=!1)}return L=w,Xd(a,h),w=(h.flags&128)!==0,L||w?(L=h.stateNode,g=w&&typeof g.getDerivedStateFromError!="function"?null:L.render(),h.flags|=1,a!==null&&w?(h.child=Pa(h,a.child,null,D),h.child=Pa(h,null,g,D)):zr(a,h,g,D),h.memoizedState=L.state,a=h.child):a=Ac(a,h,D),a}function T_(a,h,g,w){return ra(),h.flags|=256,zr(a,h,g,w),h.child}var Em={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mm(a){return{baseLanes:a,cachePool:mu()}}function fy(a,h,g){return a=a!==null?a.childLanes&~g:0,h&&(a|=Ds),a}function Am(a,h,g){var w=h.pendingProps,D=!1,L=(h.flags&128)!==0,q;if((q=L)||(q=a!==null&&a.memoizedState===null?!1:(sr.current&2)!==0),q&&(D=!0,h.flags&=-129),q=(h.flags&32)!==0,h.flags&=-33,a===null){if(Qn){if(D?Sa(h):Cs(),Qn){var se=Ui,Ce;if(Ce=se){e:{for(Ce=se,se=Qa;Ce.nodeType!==8;){if(!se){se=null;break e}if(Ce=Co(Ce.nextSibling),Ce===null){se=null;break e}}se=Ce}se!==null?(h.memoizedState={dehydrated:se,treeContext:jo!==null?{id:Wa,overflow:go}:null,retryLane:536870912,hydrationErrors:null},Ce=qa(18,null,null,0),Ce.stateNode=se,Ce.return=h,h.child=Ce,or=h,Ui=null,Ce=!0):Ce=!1}Ce||yc(h)}if(se=h.memoizedState,se!==null&&(se=se.dehydrated,se!==null))return ig(se)?h.lanes=32:h.lanes=536870912,null;io(h)}return se=w.children,w=w.fallback,D?(Cs(),D=h.mode,se=Wd({mode:"hidden",children:se},D),w=Dl(w,D,g,null),se.return=h,w.return=h,se.sibling=w,h.child=se,D=h.child,D.memoizedState=Mm(g),D.childLanes=fy(a,q,g),h.memoizedState=Em,w):(Sa(h),Cm(h,se))}if(Ce=a.memoizedState,Ce!==null&&(se=Ce.dehydrated,se!==null)){if(L)h.flags&256?(Sa(h),h.flags&=-257,h=Vh(a,h,g)):h.memoizedState!==null?(Cs(),h.child=a.child,h.flags|=128,h=null):(Cs(),D=w.fallback,se=h.mode,w=Wd({mode:"visible",children:w.children},se),D=Dl(D,se,g,null),D.flags|=2,w.return=h,D.return=h,w.sibling=D,h.child=w,Pa(h,a.child,null,g),w=h.child,w.memoizedState=Mm(g),w.childLanes=fy(a,q,g),h.memoizedState=Em,h=D);else if(Sa(h),ig(se)){if(q=se.nextSibling&&se.nextSibling.dataset,q)var He=q.dgst;q=He,w=Error(u(419)),w.stack="",w.digest=q,Qs({value:w,source:null,stack:null}),h=Vh(a,h,g)}else if(Ar||hu(a,h,g,!1),q=(g&a.childLanes)!==0,Ar||q){if(q=mi,q!==null&&(w=g&-g,w=(w&42)!==0?1:cn(w),w=(w&(q.suspendedLanes|g))!==0?0:w,w!==0&&w!==Ce.retryLane))throw Ce.retryLane=w,Ha(a,w),Ao(q,a,w),Uh;se.data==="$?"||Cy(),h=Vh(a,h,g)}else se.data==="$?"?(h.flags|=192,h.child=a.child,h=null):(a=Ce.treeContext,Ui=Co(se.nextSibling),or=h,Qn=!0,kl=null,Qa=!1,a!==null&&(Xa[ia++]=Wa,Xa[ia++]=go,Xa[ia++]=jo,Wa=a.id,go=a.overflow,jo=h),h=Cm(h,w.children),h.flags|=4096);return h}return D?(Cs(),D=w.fallback,se=h.mode,Ce=a.child,He=Ce.sibling,w=na(Ce,{mode:"hidden",children:w.children}),w.subtreeFlags=Ce.subtreeFlags&65011712,He!==null?D=na(He,D):(D=Dl(D,se,g,null),D.flags|=2),D.return=h,w.return=h,w.sibling=D,h.child=w,w=D,D=h.child,se=a.child.memoizedState,se===null?se=Mm(g):(Ce=se.cachePool,Ce!==null?(He=mr._currentValue,Ce=Ce.parent!==He?{parent:He,pool:He}:Ce):Ce=mu(),se={baseLanes:se.baseLanes|g,cachePool:Ce}),D.memoizedState=se,D.childLanes=fy(a,q,g),h.memoizedState=Em,w):(Sa(h),g=a.child,a=g.sibling,g=na(g,{mode:"visible",children:w.children}),g.return=h,g.sibling=null,a!==null&&(q=h.deletions,q===null?(h.deletions=[a],h.flags|=16):q.push(a)),h.child=g,h.memoizedState=null,g)}function Cm(a,h){return h=Wd({mode:"visible",children:h},a.mode),h.return=a,a.child=h}function Wd(a,h){return a=qa(22,a,null,h),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Vh(a,h,g){return Pa(h,a.child,null,g),a=Cm(h,h.pendingProps.children),a.flags|=2,h.memoizedState=null,a}function Oa(a,h,g){a.lanes|=h;var w=a.alternate;w!==null&&(w.lanes|=h),Vd(a.return,h,g)}function Dm(a,h,g,w,D){var L=a.memoizedState;L===null?a.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:w,tail:g,tailMode:D}:(L.isBackwards=h,L.rendering=null,L.renderingStartTime=0,L.last=w,L.tail=g,L.tailMode=D)}function Im(a,h,g){var w=h.pendingProps,D=w.revealOrder,L=w.tail;if(zr(a,h,w.children,g),w=sr.current,(w&2)!==0)w=w&1|2,h.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=h.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Oa(a,g,h);else if(a.tag===19)Oa(a,g,h);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===h)break e;for(;a.sibling===null;){if(a.return===null||a.return===h)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}w&=1}switch(pt(sr,w),D){case"forwards":for(g=h.child,D=null;g!==null;)a=g.alternate,a!==null&&So(a)===null&&(D=g),g=g.sibling;g=D,g===null?(D=h.child,h.child=null):(D=g.sibling,g.sibling=null),Dm(h,!1,D,g,L);break;case"backwards":for(g=null,D=h.child,h.child=null;D!==null;){if(a=D.alternate,a!==null&&So(a)===null){h.child=D;break}a=D.sibling,D.sibling=g,g=D,D=a}Dm(h,!0,g,null,L);break;case"together":Dm(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Ac(a,h,g){if(a!==null&&(h.dependencies=a.dependencies),Au|=h.lanes,(g&h.childLanes)===0)if(a!==null){if(hu(a,h,g,!1),(g&h.childLanes)===0)return null}else return null;if(a!==null&&h.child!==a.child)throw Error(u(153));if(h.child!==null){for(a=h.child,g=na(a,a.pendingProps),h.child=g,g.return=h;a.sibling!==null;)a=a.sibling,g=g.sibling=na(a,a.pendingProps),g.return=h;g.sibling=null}return h.child}function Rm(a,h){return(a.lanes&h)!==0?!0:(a=a.dependencies,!!(a!==null&&Ih(a)))}function Nb(a,h,g){switch(h.tag){case 3:Wt(h,h.stateNode.containerInfo),aa(h,mr,a.memoizedState.cache),ra();break;case 27:case 5:br(h);break;case 4:Wt(h,h.stateNode.containerInfo);break;case 10:aa(h,h.type,h.memoizedProps.value);break;case 13:var w=h.memoizedState;if(w!==null)return w.dehydrated!==null?(Sa(h),h.flags|=128,null):(g&h.child.childLanes)!==0?Am(a,h,g):(Sa(h),a=Ac(a,h,g),a!==null?a.sibling:null);Sa(h);break;case 19:var D=(a.flags&128)!==0;if(w=(g&h.childLanes)!==0,w||(hu(a,h,g,!1),w=(g&h.childLanes)!==0),D){if(w)return Im(a,h,g);h.flags|=128}if(D=h.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),pt(sr,sr.current),w)break;return null;case 22:case 23:return h.lanes=0,x_(a,h,g);case 24:aa(h,mr,a.memoizedState.cache)}return Ac(a,h,g)}function S_(a,h,g){if(a!==null)if(a.memoizedProps!==h.pendingProps)Ar=!0;else{if(!Rm(a,g)&&(h.flags&128)===0)return Ar=!1,Nb(a,h,g);Ar=(a.flags&131072)!==0}else Ar=!1,Qn&&(h.flags&1048576)!==0&&Rl(h,cu,h.index);switch(h.lanes=0,h.tag){case 16:e:{a=h.pendingProps;var w=h.elementType,D=w._init;if(w=D(w._payload),h.type=w,typeof w=="function")jd(w)?(a=Su(w,a),h.tag=1,h=w_(null,h,w,a,g)):(h.tag=0,h=Sm(null,h,w,a,g));else{if(w!=null){if(D=w.$$typeof,D===ke){h.tag=11,h=__(null,h,w,a,g);break e}else if(D===Ge){h.tag=14,h=v_(null,h,w,a,g);break e}}throw h=Zt(w)||w,Error(u(306,h,""))}}return h;case 0:return Sm(a,h,h.type,h.pendingProps,g);case 1:return w=h.type,D=Su(w,h.pendingProps),w_(a,h,w,D,g);case 3:e:{if(Wt(h,h.stateNode.containerInfo),a===null)throw Error(u(387));w=h.pendingProps;var L=h.memoizedState;D=L.element,yu(a,h),xc(h,w,null,g);var q=h.memoizedState;if(w=q.cache,aa(h,mr,w),w!==L.cache&&Gd(h,[mr],g,!0),_u(),w=q.element,L.isDehydrated)if(L={element:w,isDehydrated:!1,cache:q.cache},h.updateQueue.baseState=L,h.memoizedState=L,h.flags&256){h=T_(a,h,w,g);break e}else if(w!==D){D=Nr(Error(u(424)),h),Qs(D),h=T_(a,h,w,g);break e}else{switch(a=h.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ui=Co(a.firstChild),or=h,Qn=!0,kl=null,Qa=!0,g=To(h,null,w,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(ra(),w===D){h=Ac(a,h,g);break e}zr(a,h,w,g)}h=h.child}return h;case 26:return Xd(a,h),a===null?(g=og(h.type,null,h.pendingProps,null))?h.memoizedState=g:Qn||(g=h.type,a=h.pendingProps,w=Lc(Ot.current).createElement(g),w[Kt]=h,w[an]=a,ha(w,g,a),Oi(w),h.stateNode=w):h.memoizedState=og(h.type,a.memoizedProps,h.pendingProps,a.memoizedState),null;case 27:return br(h),a===null&&Qn&&(w=h.stateNode=Tp(h.type,h.pendingProps,Ot.current),or=h,Qa=!0,D=Ui,Nc(h.type)?(rg=D,Ui=Co(w.firstChild)):Ui=D),zr(a,h,h.pendingProps.children,g),Xd(a,h),a===null&&(h.flags|=4194304),h.child;case 5:return a===null&&Qn&&((D=w=Ui)&&(w=Zb(w,h.type,h.pendingProps,Qa),w!==null?(h.stateNode=w,or=h,Ui=Co(w.firstChild),Qa=!1,D=!0):D=!1),D||yc(h)),br(h),D=h.type,L=h.pendingProps,q=a!==null?a.memoizedProps:null,w=L.children,eg(D,L)?w=null:q!==null&&eg(D,q)&&(h.flags|=32),h.memoizedState!==null&&(D=to(a,h,Gi,null,null,g),Z._currentValue=D),Xd(a,h),zr(a,h,w,g),h.child;case 6:return a===null&&Qn&&((a=g=Ui)&&(g=Yb(g,h.pendingProps,Qa),g!==null?(h.stateNode=g,or=h,Ui=null,a=!0):a=!1),a||yc(h)),null;case 13:return Am(a,h,g);case 4:return Wt(h,h.stateNode.containerInfo),w=h.pendingProps,a===null?h.child=Pa(h,null,w,g):zr(a,h,w,g),h.child;case 11:return __(a,h,h.type,h.pendingProps,g);case 7:return zr(a,h,h.pendingProps,g),h.child;case 8:return zr(a,h,h.pendingProps.children,g),h.child;case 12:return zr(a,h,h.pendingProps.children,g),h.child;case 10:return w=h.pendingProps,aa(h,h.type,w.value),zr(a,h,w.children,g),h.child;case 9:return D=h.type._context,w=h.pendingProps.children,Pl(h),D=Ai(D),w=w(D),h.flags|=1,zr(a,h,w,g),h.child;case 14:return v_(a,h,h.type,h.pendingProps,g);case 15:return b_(a,h,h.type,h.pendingProps,g);case 19:return Im(a,h,g);case 31:return w=h.pendingProps,g=h.mode,w={mode:w.mode,children:w.children},a===null?(g=Wd(w,g),g.ref=h.ref,h.child=g,g.return=h,h=g):(g=na(a.child,w),g.ref=h.ref,h.child=g,g.return=h,h=g),h;case 22:return x_(a,h,g);case 24:return Pl(h),w=Ai(mr),a===null?(D=rp(),D===null&&(D=mi,L=Ol(),D.pooledCache=L,L.refCount++,L!==null&&(D.pooledCacheLanes|=g),D=L),h.memoizedState={parent:w,cache:D},ap(h),aa(h,mr,D)):((a.lanes&g)!==0&&(yu(a,h),xc(h,null,null,g),_u()),D=a.memoizedState,L=h.memoizedState,D.parent!==w?(D={parent:w,cache:w},h.memoizedState=D,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=D),aa(h,mr,w)):(w=L.cache,aa(h,mr,w),w!==D.cache&&Gd(h,[mr],g,!0))),zr(a,h,h.pendingProps.children,g),h.child;case 29:throw h.pendingProps}throw Error(u(156,h.tag))}function jl(a){a.flags|=4}function E_(a,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!f(h)){if(h=Mr.current,h!==null&&((Kn&4194048)===Kn?Qr!==null:(Kn&62914560)!==Kn&&(Kn&536870912)===0||h!==Qr))throw Uo=Rh,vo;a.flags|=8192}}function Qd(a,h){h!==null&&(a.flags|=4),a.flags&16384&&(h=a.tag!==22?ot():536870912,a.lanes|=h,of|=h)}function Kd(a,h){if(!Qn)switch(a.tailMode){case"hidden":h=a.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?a.tail=null:g.sibling=null;break;case"collapsed":g=a.tail;for(var w=null;g!==null;)g.alternate!==null&&(w=g),g=g.sibling;w===null?h||a.tail===null?a.tail=null:a.tail.sibling=null:w.sibling=null}}function tr(a){var h=a.alternate!==null&&a.alternate.child===a.child,g=0,w=0;if(h)for(var D=a.child;D!==null;)g|=D.lanes|D.childLanes,w|=D.subtreeFlags&65011712,w|=D.flags&65011712,D.return=a,D=D.sibling;else for(D=a.child;D!==null;)g|=D.lanes|D.childLanes,w|=D.subtreeFlags,w|=D.flags,D.return=a,D=D.sibling;return a.subtreeFlags|=w,a.childLanes=g,h}function zb(a,h,g){var w=h.pendingProps;switch(uu(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tr(h),null;case 1:return tr(h),null;case 3:return g=h.stateNode,w=null,a!==null&&(w=a.memoizedState.cache),h.memoizedState.cache!==w&&(h.flags|=2048),Fo(mr),Xn(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(ka(h)?jl(h):a===null||a.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Dh())),tr(h),null;case 26:return g=h.memoizedState,a===null?(jl(h),g!==null?(tr(h),E_(h,g)):(tr(h),h.flags&=-16777217)):g?g!==a.memoizedState?(jl(h),tr(h),E_(h,g)):(tr(h),h.flags&=-16777217):(a.memoizedProps!==w&&jl(h),tr(h),h.flags&=-16777217),null;case 27:ir(h),g=Ot.current;var D=h.type;if(a!==null&&h.stateNode!=null)a.memoizedProps!==w&&jl(h);else{if(!w){if(h.stateNode===null)throw Error(u(166));return tr(h),null}a=Et.current,ka(h)?Bd(h):(a=Tp(D,w,g),h.stateNode=a,jl(h))}return tr(h),null;case 5:if(ir(h),g=h.type,a!==null&&h.stateNode!=null)a.memoizedProps!==w&&jl(h);else{if(!w){if(h.stateNode===null)throw Error(u(166));return tr(h),null}if(a=Et.current,ka(h))Bd(h);else{switch(D=Lc(Ot.current),a){case 1:a=D.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:a=D.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":a=D.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":a=D.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":a=D.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof w.is=="string"?D.createElement("select",{is:w.is}):D.createElement("select"),w.multiple?a.multiple=!0:w.size&&(a.size=w.size);break;default:a=typeof w.is=="string"?D.createElement(g,{is:w.is}):D.createElement(g)}}a[Kt]=h,a[an]=w;e:for(D=h.child;D!==null;){if(D.tag===5||D.tag===6)a.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===h)break e;for(;D.sibling===null;){if(D.return===null||D.return===h)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}h.stateNode=a;e:switch(ha(a,g,w),g){case"button":case"input":case"select":case"textarea":a=!!w.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&jl(h)}}return tr(h),h.flags&=-16777217,null;case 6:if(a&&h.stateNode!=null)a.memoizedProps!==w&&jl(h);else{if(typeof w!="string"&&h.stateNode===null)throw Error(u(166));if(a=Ot.current,ka(h)){if(a=h.stateNode,g=h.memoizedProps,w=null,D=or,D!==null)switch(D.tag){case 27:case 5:w=D.memoizedProps}a[Kt]=h,a=!!(a.nodeValue===g||w!==null&&w.suppressHydrationWarning===!0||$y(a.nodeValue,g)),a||yc(h)}else a=Lc(a).createTextNode(w),a[Kt]=h,h.stateNode=a}return tr(h),null;case 13:if(w=h.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(D=ka(h),w!==null&&w.dehydrated!==null){if(a===null){if(!D)throw Error(u(318));if(D=h.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(u(317));D[Kt]=h}else ra(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;tr(h),D=!1}else D=Dh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=D),D=!0;if(!D)return h.flags&256?(io(h),h):(io(h),null)}if(io(h),(h.flags&128)!==0)return h.lanes=g,h;if(g=w!==null,a=a!==null&&a.memoizedState!==null,g){w=h.child,D=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(D=w.alternate.memoizedState.cachePool.pool);var L=null;w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(L=w.memoizedState.cachePool.pool),L!==D&&(w.flags|=2048)}return g!==a&&g&&(h.child.flags|=8192),Qd(h,h.updateQueue),tr(h),null;case 4:return Xn(),a===null&&By(h.stateNode.containerInfo),tr(h),null;case 10:return Fo(h.type),tr(h),null;case 19:if(yt(sr),D=h.memoizedState,D===null)return tr(h),null;if(w=(h.flags&128)!==0,L=D.rendering,L===null)if(w)Kd(D,!1);else{if(lr!==0||a!==null&&(a.flags&128)!==0)for(a=h.child;a!==null;){if(L=So(a),L!==null){for(h.flags|=128,Kd(D,!1),a=L.updateQueue,h.updateQueue=a,Qd(h,a),h.subtreeFlags=0,a=g,g=h.child;g!==null;)tp(g,a),g=g.sibling;return pt(sr,sr.current&1|2),h.child}a=a.sibling}D.tail!==null&&ki()>mp&&(h.flags|=128,w=!0,Kd(D,!1),h.lanes=4194304)}else{if(!w)if(a=So(L),a!==null){if(h.flags|=128,w=!0,a=a.updateQueue,h.updateQueue=a,Qd(h,a),Kd(D,!0),D.tail===null&&D.tailMode==="hidden"&&!L.alternate&&!Qn)return tr(h),null}else 2*ki()-D.renderingStartTime>mp&&g!==536870912&&(h.flags|=128,w=!0,Kd(D,!1),h.lanes=4194304);D.isBackwards?(L.sibling=h.child,h.child=L):(a=D.last,a!==null?a.sibling=L:h.child=L,D.last=L)}return D.tail!==null?(h=D.tail,D.rendering=h,D.tail=h.sibling,D.renderingStartTime=ki(),h.sibling=null,a=sr.current,pt(sr,w?a&1|2:a&1),h):(tr(h),null);case 22:case 23:return io(h),Lh(),w=h.memoizedState!==null,a!==null?a.memoizedState!==null!==w&&(h.flags|=8192):w&&(h.flags|=8192),w?(g&536870912)!==0&&(h.flags&128)===0&&(tr(h),h.subtreeFlags&6&&(h.flags|=8192)):tr(h),g=h.updateQueue,g!==null&&Qd(h,g.retryQueue),g=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==g&&(h.flags|=2048),a!==null&&yt(Bo),null;case 24:return g=null,a!==null&&(g=a.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),Fo(mr),tr(h),null;case 25:return null;case 30:return null}throw Error(u(156,h.tag))}function jb(a,h){switch(uu(h),h.tag){case 1:return a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 3:return Fo(mr),Xn(),a=h.flags,(a&65536)!==0&&(a&128)===0?(h.flags=a&-65537|128,h):null;case 26:case 27:case 5:return ir(h),null;case 13:if(io(h),a=h.memoizedState,a!==null&&a.dehydrated!==null){if(h.alternate===null)throw Error(u(340));ra()}return a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 19:return yt(sr),null;case 4:return Xn(),null;case 10:return Fo(h.type),null;case 22:case 23:return io(h),Lh(),a!==null&&yt(Bo),a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 24:return Fo(mr),null;case 25:return null;default:return null}}function M_(a,h){switch(uu(h),h.tag){case 3:Fo(mr),Xn();break;case 26:case 27:case 5:ir(h);break;case 4:Xn();break;case 13:io(h);break;case 19:yt(sr);break;case 10:Fo(h.type);break;case 22:case 23:io(h),Lh(),a!==null&&yt(Bo);break;case 24:Fo(mr)}}function Gh(a,h){try{var g=h.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var D=w.next;g=D;do{if((g.tag&a)===a){w=void 0;var L=g.create,q=g.inst;w=L(),q.destroy=w}g=g.next}while(g!==D)}}catch(se){Bi(h,h.return,se)}}function Fl(a,h,g){try{var w=h.updateQueue,D=w!==null?w.lastEffect:null;if(D!==null){var L=D.next;w=L;do{if((w.tag&a)===a){var q=w.inst,se=q.destroy;if(se!==void 0){q.destroy=void 0,D=h;var Ce=g,He=se;try{He()}catch(st){Bi(D,Ce,st)}}}w=w.next}while(w!==L)}}catch(st){Bi(h,h.return,st)}}function py(a){var h=a.updateQueue;if(h!==null){var g=a.stateNode;try{sp(h,g)}catch(w){Bi(a,a.return,w)}}}function Eu(a,h,g){g.props=Su(a.type,a.memoizedProps),g.state=a.memoizedState;try{g.componentWillUnmount()}catch(w){Bi(a,h,w)}}function Cc(a,h){try{var g=a.ref;if(g!==null){switch(a.tag){case 26:case 27:case 5:var w=a.stateNode;break;case 30:w=a.stateNode;break;default:w=a.stateNode}typeof g=="function"?a.refCleanup=g(w):g.current=w}}catch(D){Bi(a,h,D)}}function Bl(a,h){var g=a.ref,w=a.refCleanup;if(g!==null)if(typeof w=="function")try{w()}catch(D){Bi(a,h,D)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(D){Bi(a,h,D)}else g.current=null}function A_(a){var h=a.type,g=a.memoizedProps,w=a.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":g.autoFocus&&w.focus();break e;case"img":g.src?w.src=g.src:g.srcSet&&(w.srcset=g.srcSet)}}catch(D){Bi(a,a.return,D)}}function my(a,h,g){try{var w=a.stateNode;Zy(w,a.type,g,h),w[an]=h}catch(D){Bi(a,a.return,D)}}function C_(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Nc(a.type)||a.tag===4}function gy(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||C_(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Nc(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function yy(a,h,g){var w=a.tag;if(w===5||w===6)a=a.stateNode,h?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(a,h):(h=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,h.appendChild(a),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=gf));else if(w!==4&&(w===27&&Nc(a.type)&&(g=a.stateNode,h=null),a=a.child,a!==null))for(yy(a,h,g),a=a.sibling;a!==null;)yy(a,h,g),a=a.sibling}function km(a,h,g){var w=a.tag;if(w===5||w===6)a=a.stateNode,h?g.insertBefore(a,h):g.appendChild(a);else if(w!==4&&(w===27&&Nc(a.type)&&(g=a.stateNode),a=a.child,a!==null))for(km(a,h,g),a=a.sibling;a!==null;)km(a,h,g),a=a.sibling}function Pm(a){var h=a.stateNode,g=a.memoizedProps;try{for(var w=a.type,D=h.attributes;D.length;)h.removeAttributeNode(D[0]);ha(h,w,g),h[Kt]=a,h[an]=g}catch(L){Bi(a,a.return,L)}}var Dc=!1,_r=!1,$h=!1,D_=typeof WeakSet=="function"?WeakSet:Set,On=null;function Jd(a,h){if(a=a.containerInfo,Jm=Ie,a=Od(a),vh(a)){if("selectionStart"in a)var g={start:a.selectionStart,end:a.selectionEnd};else e:{g=(g=a.ownerDocument)&&g.defaultView||window;var w=g.getSelection&&g.getSelection();if(w&&w.rangeCount!==0){g=w.anchorNode;var D=w.anchorOffset,L=w.focusNode;w=w.focusOffset;try{g.nodeType,L.nodeType}catch{g=null;break e}var q=0,se=-1,Ce=-1,He=0,st=0,ft=a,Ke=null;t:for(;;){for(var et;ft!==g||D!==0&&ft.nodeType!==3||(se=q+D),ft!==L||w!==0&&ft.nodeType!==3||(Ce=q+w),ft.nodeType===3&&(q+=ft.nodeValue.length),(et=ft.firstChild)!==null;)Ke=ft,ft=et;for(;;){if(ft===a)break t;if(Ke===g&&++He===D&&(se=q),Ke===L&&++st===w&&(Ce=q),(et=ft.nextSibling)!==null)break;ft=Ke,Ke=ft.parentNode}ft=et}g=se===-1||Ce===-1?null:{start:se,end:Ce}}else g=null}g=g||{start:0,end:0}}else g=null;for(ro={focusedElem:a,selectionRange:g},Ie=!1,On=h;On!==null;)if(h=On,a=h.child,(h.subtreeFlags&1024)!==0&&a!==null)a.return=h,On=a;else for(;On!==null;){switch(h=On,L=h.alternate,a=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&L!==null){a=void 0,g=h,D=L.memoizedProps,L=L.memoizedState,w=g.stateNode;try{var fn=Su(g.type,D,g.elementType===g.type);a=w.getSnapshotBeforeUpdate(fn,L),w.__reactInternalSnapshotBeforeUpdate=a}catch(sn){Bi(g,g.return,sn)}}break;case 3:if((a&1024)!==0){if(a=h.stateNode.containerInfo,g=a.nodeType,g===9)ng(a);else if(g===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":ng(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(u(163))}if(a=h.sibling,a!==null){a.return=h.return,On=a;break}On=h.return}}function _y(a,h,g){var w=g.flags;switch(g.tag){case 0:case 11:case 15:Eo(a,g),w&4&&Gh(5,g);break;case 1:if(Eo(a,g),w&4)if(a=g.stateNode,h===null)try{a.componentDidMount()}catch(q){Bi(g,g.return,q)}else{var D=Su(g.type,h.memoizedProps);h=h.memoizedState;try{a.componentDidUpdate(D,h,a.__reactInternalSnapshotBeforeUpdate)}catch(q){Bi(g,g.return,q)}}w&64&&py(g),w&512&&Cc(g,g.return);break;case 3:if(Eo(a,g),w&64&&(a=g.updateQueue,a!==null)){if(h=null,g.child!==null)switch(g.child.tag){case 27:case 5:h=g.child.stateNode;break;case 1:h=g.child.stateNode}try{sp(a,h)}catch(q){Bi(g,g.return,q)}}break;case 27:h===null&&w&4&&Pm(g);case 26:case 5:Eo(a,g),h===null&&w&4&&A_(g),w&512&&Cc(g,g.return);break;case 12:Eo(a,g);break;case 13:Eo(a,g),w&4&&ef(a,g),w&64&&(a=g.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(g=Py.bind(null,g),Q_(a,g))));break;case 22:if(w=g.memoizedState!==null||Dc,!w){h=h!==null&&h.memoizedState!==null||_r,D=Dc;var L=_r;Dc=w,(_r=h)&&!L?Ic(a,g,(g.subtreeFlags&8772)!==0):Eo(a,g),Dc=D,_r=L}break;case 30:break;default:Eo(a,g)}}function cp(a){var h=a.alternate;h!==null&&(a.alternate=null,cp(h)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(h=a.stateNode,h!==null&&It(h)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Fi=null,ua=!1;function Ul(a,h,g){for(g=g.child;g!==null;)vy(a,h,g),g=g.sibling}function vy(a,h,g){if(ii&&typeof ii.onCommitFiberUnmount=="function")try{ii.onCommitFiberUnmount(gn,g)}catch{}switch(g.tag){case 26:_r||Bl(g,h),Ul(a,h,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:_r||Bl(g,h);var w=Fi,D=ua;Nc(g.type)&&(Fi=g.stateNode,ua=!1),Ul(a,h,g),Ou(g.stateNode),Fi=w,ua=D;break;case 5:_r||Bl(g,h);case 6:if(w=Fi,D=ua,Fi=null,Ul(a,h,g),Fi=w,ua=D,Fi!==null)if(ua)try{(Fi.nodeType===9?Fi.body:Fi.nodeName==="HTML"?Fi.ownerDocument.body:Fi).removeChild(g.stateNode)}catch(L){Bi(g,h,L)}else try{Fi.removeChild(g.stateNode)}catch(L){Bi(g,h,L)}break;case 18:Fi!==null&&(ua?(a=Fi,qy(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,g.stateNode),Br(a)):qy(Fi,g.stateNode));break;case 4:w=Fi,D=ua,Fi=g.stateNode.containerInfo,ua=!0,Ul(a,h,g),Fi=w,ua=D;break;case 0:case 11:case 14:case 15:_r||Fl(2,g,h),_r||Fl(4,g,h),Ul(a,h,g);break;case 1:_r||(Bl(g,h),w=g.stateNode,typeof w.componentWillUnmount=="function"&&Eu(g,h,w)),Ul(a,h,g);break;case 21:Ul(a,h,g);break;case 22:_r=(w=_r)||g.memoizedState!==null,Ul(a,h,g),_r=w;break;default:Ul(a,h,g)}}function ef(a,h){if(h.memoizedState===null&&(a=h.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Br(a)}catch(g){Bi(h,h.return,g)}}function by(a){switch(a.tag){case 13:case 19:var h=a.stateNode;return h===null&&(h=a.stateNode=new D_),h;case 22:return a=a.stateNode,h=a._retryCache,h===null&&(h=a._retryCache=new D_),h;default:throw Error(u(435,a.tag))}}function Mu(a,h){var g=by(a);h.forEach(function(w){var D=Gb.bind(null,a,w);g.has(w)||(g.add(w),w.then(D,D))})}function La(a,h){var g=h.deletions;if(g!==null)for(var w=0;w<g.length;w++){var D=g[w],L=a,q=h,se=q;e:for(;se!==null;){switch(se.tag){case 27:if(Nc(se.type)){Fi=se.stateNode,ua=!1;break e}break;case 5:Fi=se.stateNode,ua=!1;break e;case 3:case 4:Fi=se.stateNode.containerInfo,ua=!0;break e}se=se.return}if(Fi===null)throw Error(u(160));vy(L,q,D),Fi=null,ua=!1,L=D.alternate,L!==null&&(L.return=null),D.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)tf(h,a),h=h.sibling}var Na=null;function tf(a,h){var g=a.alternate,w=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:La(h,a),Yo(a),w&4&&(Fl(3,a,a.return),Gh(3,a),Fl(5,a,a.return));break;case 1:La(h,a),Yo(a),w&512&&(_r||g===null||Bl(g,g.return)),w&64&&Dc&&(a=a.updateQueue,a!==null&&(w=a.callbacks,w!==null&&(g=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=g===null?w:g.concat(w))));break;case 26:var D=Na;if(La(h,a),Yo(a),w&512&&(_r||g===null||Bl(g,g.return)),w&4){var L=g!==null?g.memoizedState:null;if(w=a.memoizedState,g===null)if(w===null)if(a.stateNode===null){e:{w=a.type,g=a.memoizedProps,D=D.ownerDocument||D;t:switch(w){case"title":L=D.getElementsByTagName("title")[0],(!L||L[ps]||L[Kt]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=D.createElement(w),D.head.insertBefore(L,D.querySelector("head > title"))),ha(L,w,g),L[Kt]=a,Oi(L),w=L;break e;case"link":var q=s("link","href",D).get(w+(g.href||""));if(q){for(var se=0;se<q.length;se++)if(L=q[se],L.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&L.getAttribute("rel")===(g.rel==null?null:g.rel)&&L.getAttribute("title")===(g.title==null?null:g.title)&&L.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){q.splice(se,1);break t}}L=D.createElement(w),ha(L,w,g),D.head.appendChild(L);break;case"meta":if(q=s("meta","content",D).get(w+(g.content||""))){for(se=0;se<q.length;se++)if(L=q[se],L.getAttribute("content")===(g.content==null?null:""+g.content)&&L.getAttribute("name")===(g.name==null?null:g.name)&&L.getAttribute("property")===(g.property==null?null:g.property)&&L.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&L.getAttribute("charset")===(g.charSet==null?null:g.charSet)){q.splice(se,1);break t}}L=D.createElement(w),ha(L,w,g),D.head.appendChild(L);break;default:throw Error(u(468,w))}L[Kt]=a,Oi(L),w=L}a.stateNode=w}else i(D,a.type,a.stateNode);else a.stateNode=_f(D,w,a.memoizedProps);else L!==w?(L===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):L.count--,w===null?i(D,a.type,a.stateNode):_f(D,w,a.memoizedProps)):w===null&&a.stateNode!==null&&my(a,a.memoizedProps,g.memoizedProps)}break;case 27:La(h,a),Yo(a),w&512&&(_r||g===null||Bl(g,g.return)),g!==null&&w&4&&my(a,a.memoizedProps,g.memoizedProps);break;case 5:if(La(h,a),Yo(a),w&512&&(_r||g===null||Bl(g,g.return)),a.flags&32){D=a.stateNode;try{_s(D,"")}catch(et){Bi(a,a.return,et)}}w&4&&a.stateNode!=null&&(D=a.memoizedProps,my(a,D,g!==null?g.memoizedProps:D)),w&1024&&($h=!0);break;case 6:if(La(h,a),Yo(a),w&4){if(a.stateNode===null)throw Error(u(162));w=a.memoizedProps,g=a.stateNode;try{g.nodeValue=w}catch(et){Bi(a,a.return,et)}}break;case 3:if(lg=null,D=Na,Na=ag(h.containerInfo),La(h,a),Na=D,Yo(a),w&4&&g!==null&&g.memoizedState.isDehydrated)try{Br(h.containerInfo)}catch(et){Bi(a,a.return,et)}$h&&($h=!1,xy(a));break;case 4:w=Na,Na=ag(a.stateNode.containerInfo),La(h,a),Yo(a),Na=w;break;case 12:La(h,a),Yo(a);break;case 13:La(h,a),Yo(a),a.child.flags&8192&&a.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Lm=ki()),w&4&&(w=a.updateQueue,w!==null&&(a.updateQueue=null,Mu(a,w)));break;case 22:D=a.memoizedState!==null;var Ce=g!==null&&g.memoizedState!==null,He=Dc,st=_r;if(Dc=He||D,_r=st||Ce,La(h,a),_r=st,Dc=He,Yo(a),w&8192)e:for(h=a.stateNode,h._visibility=D?h._visibility&-2:h._visibility|1,D&&(g===null||Ce||Dc||_r||Zh(a)),g=null,h=a;;){if(h.tag===5||h.tag===26){if(g===null){Ce=g=h;try{if(L=Ce.stateNode,D)q=L.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{se=Ce.stateNode;var ft=Ce.memoizedProps.style,Ke=ft!=null&&ft.hasOwnProperty("display")?ft.display:null;se.style.display=Ke==null||typeof Ke=="boolean"?"":(""+Ke).trim()}}catch(et){Bi(Ce,Ce.return,et)}}}else if(h.tag===6){if(g===null){Ce=h;try{Ce.stateNode.nodeValue=D?"":Ce.memoizedProps}catch(et){Bi(Ce,Ce.return,et)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===a)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break e;for(;h.sibling===null;){if(h.return===null||h.return===a)break e;g===h&&(g=null),h=h.return}g===h&&(g=null),h.sibling.return=h.return,h=h.sibling}w&4&&(w=a.updateQueue,w!==null&&(g=w.retryQueue,g!==null&&(w.retryQueue=null,Mu(a,g))));break;case 19:La(h,a),Yo(a),w&4&&(w=a.updateQueue,w!==null&&(a.updateQueue=null,Mu(a,w)));break;case 30:break;case 21:break;default:La(h,a),Yo(a)}}function Yo(a){var h=a.flags;if(h&2){try{for(var g,w=a.return;w!==null;){if(C_(w)){g=w;break}w=w.return}if(g==null)throw Error(u(160));switch(g.tag){case 27:var D=g.stateNode,L=gy(a);km(a,L,D);break;case 5:var q=g.stateNode;g.flags&32&&(_s(q,""),g.flags&=-33);var se=gy(a);km(a,se,q);break;case 3:case 4:var Ce=g.stateNode.containerInfo,He=gy(a);yy(a,He,Ce);break;default:throw Error(u(161))}}catch(st){Bi(a,a.return,st)}a.flags&=-3}h&4096&&(a.flags&=-4097)}function xy(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var h=a;xy(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),a=a.sibling}}function Eo(a,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)_y(a,h.alternate,h),h=h.sibling}function Zh(a){for(a=a.child;a!==null;){var h=a;switch(h.tag){case 0:case 11:case 14:case 15:Fl(4,h,h.return),Zh(h);break;case 1:Bl(h,h.return);var g=h.stateNode;typeof g.componentWillUnmount=="function"&&Eu(h,h.return,g),Zh(h);break;case 27:Ou(h.stateNode);case 26:case 5:Bl(h,h.return),Zh(h);break;case 22:h.memoizedState===null&&Zh(h);break;case 30:Zh(h);break;default:Zh(h)}a=a.sibling}}function Ic(a,h,g){for(g=g&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var w=h.alternate,D=a,L=h,q=L.flags;switch(L.tag){case 0:case 11:case 15:Ic(D,L,g),Gh(4,L);break;case 1:if(Ic(D,L,g),w=L,D=w.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(He){Bi(w,w.return,He)}if(w=L,D=w.updateQueue,D!==null){var se=w.stateNode;try{var Ce=D.shared.hiddenCallbacks;if(Ce!==null)for(D.shared.hiddenCallbacks=null,D=0;D<Ce.length;D++)op(Ce[D],se)}catch(He){Bi(w,w.return,He)}}g&&q&64&&py(L),Cc(L,L.return);break;case 27:Pm(L);case 26:case 5:Ic(D,L,g),g&&w===null&&q&4&&A_(L),Cc(L,L.return);break;case 12:Ic(D,L,g);break;case 13:Ic(D,L,g),g&&q&4&&ef(D,L);break;case 22:L.memoizedState===null&&Ic(D,L,g),Cc(L,L.return);break;case 30:break;default:Ic(D,L,g)}h=h.sibling}}function Yh(a,h){var g=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),a=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(a=h.memoizedState.cachePool.pool),a!==g&&(a!=null&&a.refCount++,g!=null&&_c(g))}function up(a,h){a=null,h.alternate!==null&&(a=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==a&&(h.refCount++,a!=null&&_c(a))}function sl(a,h,g,w){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)wy(a,h,g,w),h=h.sibling}function wy(a,h,g,w){var D=h.flags;switch(h.tag){case 0:case 11:case 15:sl(a,h,g,w),D&2048&&Gh(9,h);break;case 1:sl(a,h,g,w);break;case 3:sl(a,h,g,w),D&2048&&(a=null,h.alternate!==null&&(a=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==a&&(h.refCount++,a!=null&&_c(a)));break;case 12:if(D&2048){sl(a,h,g,w),a=h.stateNode;try{var L=h.memoizedProps,q=L.id,se=L.onPostCommit;typeof se=="function"&&se(q,h.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(Ce){Bi(h,h.return,Ce)}}else sl(a,h,g,w);break;case 13:sl(a,h,g,w);break;case 23:break;case 22:L=h.stateNode,q=h.alternate,h.memoizedState!==null?L._visibility&2?sl(a,h,g,w):hp(a,h):L._visibility&2?sl(a,h,g,w):(L._visibility|=2,nf(a,h,g,w,(h.subtreeFlags&10256)!==0)),D&2048&&Yh(q,h);break;case 24:sl(a,h,g,w),D&2048&&up(h.alternate,h);break;default:sl(a,h,g,w)}}function nf(a,h,g,w,D){for(D=D&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var L=a,q=h,se=g,Ce=w,He=q.flags;switch(q.tag){case 0:case 11:case 15:nf(L,q,se,Ce,D),Gh(8,q);break;case 23:break;case 22:var st=q.stateNode;q.memoizedState!==null?st._visibility&2?nf(L,q,se,Ce,D):hp(L,q):(st._visibility|=2,nf(L,q,se,Ce,D)),D&&He&2048&&Yh(q.alternate,q);break;case 24:nf(L,q,se,Ce,D),D&&He&2048&&up(q.alternate,q);break;default:nf(L,q,se,Ce,D)}h=h.sibling}}function hp(a,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var g=a,w=h,D=w.flags;switch(w.tag){case 22:hp(g,w),D&2048&&Yh(w.alternate,w);break;case 24:hp(g,w),D&2048&&up(w.alternate,w);break;default:hp(g,w)}h=h.sibling}}var dp=8192;function rf(a){if(a.subtreeFlags&dp)for(a=a.child;a!==null;)I_(a),a=a.sibling}function I_(a){switch(a.tag){case 26:rf(a),a.flags&dp&&a.memoizedState!==null&&S(Na,a.memoizedState,a.memoizedProps);break;case 5:rf(a);break;case 3:case 4:var h=Na;Na=ag(a.stateNode.containerInfo),rf(a),Na=h;break;case 22:a.memoizedState===null&&(h=a.alternate,h!==null&&h.memoizedState!==null?(h=dp,dp=16777216,rf(a),dp=h):rf(a));break;default:rf(a)}}function Hh(a){var h=a.alternate;if(h!==null&&(a=h.child,a!==null)){h.child=null;do h=a.sibling,a.sibling=null,a=h;while(a!==null)}}function fp(a){var h=a.deletions;if((a.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];On=w,k_(w,a)}Hh(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)R_(a),a=a.sibling}function R_(a){switch(a.tag){case 0:case 11:case 15:fp(a),a.flags&2048&&Fl(9,a,a.return);break;case 3:fp(a);break;case 12:fp(a);break;case 22:var h=a.stateNode;a.memoizedState!==null&&h._visibility&2&&(a.return===null||a.return.tag!==13)?(h._visibility&=-3,pp(a)):fp(a);break;default:fp(a)}}function pp(a){var h=a.deletions;if((a.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];On=w,k_(w,a)}Hh(a)}for(a=a.child;a!==null;){switch(h=a,h.tag){case 0:case 11:case 15:Fl(8,h,h.return),pp(h);break;case 22:g=h.stateNode,g._visibility&2&&(g._visibility&=-3,pp(h));break;default:pp(h)}a=a.sibling}}function k_(a,h){for(;On!==null;){var g=On;switch(g.tag){case 0:case 11:case 15:Fl(8,g,h);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var w=g.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:_c(g.memoizedState.cache)}if(w=g.child,w!==null)w.return=g,On=w;else e:for(g=a;On!==null;){w=On;var D=w.sibling,L=w.return;if(cp(w),w===g){On=null;break e}if(D!==null){D.return=L,On=D;break e}On=L}}}var P_={getCacheForType:function(a){var h=Ai(mr),g=h.data.get(a);return g===void 0&&(g=a(),h.data.set(a,g)),g}},Fb=typeof WeakMap=="function"?WeakMap:Map,ui=0,mi=null,Nn=null,Kn=0,vi=0,Mo=null,Rc=!1,af=!1,Ty=!1,Ho=0,lr=0,Au=0,qh=0,Sy=0,Ds=0,of=0,sf=null,za=null,Om=!1,Lm=0,mp=1/0,Nm=null,ll=null,Ea=0,kc=null,lf=null,cf=0,Ey=0,zm=null,O_=null,gp=0,Xh=null;function ai(){if((ui&2)!==0&&Kn!==0)return Kn&-Kn;if(Be.T!==null){var a=Sr;return a!==0?a:jy()}return fr()}function jm(){Ds===0&&(Ds=(Kn&536870912)===0||Qn?mt():536870912);var a=Mr.current;return a!==null&&(a.flags|=32),Ds}function Ao(a,h,g){(a===mi&&(vi===2||vi===9)||a.cancelPendingCommit!==null)&&(hf(a,0),Pc(a,Kn,Ds,!1)),Fe(a,g),((ui&2)===0||a!==mi)&&(a===mi&&((ui&2)===0&&(qh|=g),lr===4&&Pc(a,Kn,Ds,!1)),cl(a))}function My(a,h,g){if((ui&6)!==0)throw Error(u(327));var w=!g&&(h&124)===0&&(h&a.expiredLanes)===0||je(a,h),D=w?Ub(a,h):Dy(a,h,!0),L=w;do{if(D===0){af&&!w&&Pc(a,h,0,!1);break}else{if(g=a.current.alternate,L&&!uf(g)){D=Dy(a,h,!1),L=!1;continue}if(D===2){if(L=h,a.errorRecoveryDisabledLanes&L)var q=0;else q=a.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){h=q;e:{var se=a;D=sf;var Ce=se.current.memoizedState.isDehydrated;if(Ce&&(hf(se,q).flags|=256),q=Dy(se,q,!1),q!==2){if(Ty&&!Ce){se.errorRecoveryDisabledLanes|=L,qh|=L,D=4;break e}L=za,za=D,L!==null&&(za===null?za=L:za.push.apply(za,L))}D=q}if(L=!1,D!==2)continue}}if(D===1){hf(a,0),Pc(a,h,0,!0);break}e:{switch(w=a,L=D,L){case 0:case 1:throw Error(u(345));case 4:if((h&4194048)!==h)break;case 6:Pc(w,h,Ds,!Rc);break e;case 2:za=null;break;case 3:case 5:break;default:throw Error(u(329))}if((h&62914560)===h&&(D=Lm+300-ki(),10<D)){if(Pc(w,h,Ds,!Rc),Ye(w,0,!0)!==0)break e;w.timeoutHandle=Yy(Fm.bind(null,w,g,za,Nm,Om,h,Ds,qh,of,Rc,L,2,-0,0),D);break e}Fm(w,g,za,Nm,Om,h,Ds,qh,of,Rc,L,0,-0,0)}}break}while(!0);cl(a)}function Fm(a,h,g,w,D,L,q,se,Ce,He,st,ft,Ke,et){if(a.timeoutHandle=-1,ft=h.subtreeFlags,(ft&8192||(ft&16785408)===16785408)&&(_={stylesheets:null,count:0,unsuspend:x},I_(h),ft=A(),ft!==null)){a.cancelPendingCommit=ft(df.bind(null,a,h,L,g,w,D,q,se,Ce,st,1,Ke,et)),Pc(a,L,q,!He);return}df(a,h,L,g,w,D,q,se,Ce)}function uf(a){for(var h=a;;){var g=h.tag;if((g===0||g===11||g===15)&&h.flags&16384&&(g=h.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var w=0;w<g.length;w++){var D=g[w],L=D.getSnapshot;D=D.value;try{if(!ba(L(),D))return!1}catch{return!1}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Pc(a,h,g,w){h&=~Sy,h&=~qh,a.suspendedLanes|=h,a.pingedLanes&=~h,w&&(a.warmLanes|=h),w=a.expirationTimes;for(var D=h;0<D;){var L=31-Pe(D),q=1<<L;w[L]=-1,D&=~q}g!==0&&Sn(a,g,h)}function Bm(){return(ui&6)===0?(qo(0),!1):!0}function Ay(){if(Nn!==null){if(vi===0)var a=Nn.return;else a=Nn,yo=Ka=null,nl(a),_i=null,Xi=0,a=Nn;for(;a!==null;)M_(a.alternate,a),a=a.return;Nn=null}}function hf(a,h){var g=a.timeoutHandle;g!==-1&&(a.timeoutHandle=-1,$b(g)),g=a.cancelPendingCommit,g!==null&&(a.cancelPendingCommit=null,g()),Ay(),mi=a,Nn=g=na(a.current,null),Kn=h,vi=0,Mo=null,Rc=!1,af=je(a,h),Ty=!1,of=Ds=Sy=qh=Au=lr=0,za=sf=null,Om=!1,(h&8)!==0&&(h|=h&32);var w=a.entangledLanes;if(w!==0)for(a=a.entanglements,w&=h;0<w;){var D=31-Pe(w),L=1<<D;h|=a[D],w&=~L}return Ho=h,gc(),g}function L_(a,h){An=null,Be.H=la,h===Js||h===kt?(h=Ph(),vi=3):h===vo?(h=Ph(),vi=4):vi=h===Uh?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Mo=h,Nn===null&&(lr=1,xm(a,Nr(h,a.current)))}function N_(){var a=Be.H;return Be.H=la,a===null?la:a}function z_(){var a=Be.A;return Be.A=P_,a}function Cy(){lr=4,Rc||(Kn&4194048)!==Kn&&Mr.current!==null||(af=!0),(Au&134217727)===0&&(qh&134217727)===0||mi===null||Pc(mi,Kn,Ds,!1)}function Dy(a,h,g){var w=ui;ui|=2;var D=N_(),L=z_();(mi!==a||Kn!==h)&&(Nm=null,hf(a,h)),h=!1;var q=lr;e:do try{if(vi!==0&&Nn!==null){var se=Nn,Ce=Mo;switch(vi){case 8:Ay(),q=6;break e;case 3:case 2:case 9:case 6:Mr.current===null&&(h=!0);var He=vi;if(vi=0,Mo=null,Cu(a,se,Ce,He),g&&af){q=0;break e}break;default:He=vi,vi=0,Mo=null,Cu(a,se,Ce,He)}}Bb(),q=lr;break}catch(st){L_(a,st)}while(!0);return h&&a.shellSuspendCounter++,yo=Ka=null,ui=w,Be.H=D,Be.A=L,Nn===null&&(mi=null,Kn=0,gc()),q}function Bb(){for(;Nn!==null;)j_(Nn)}function Ub(a,h){var g=ui;ui|=2;var w=N_(),D=z_();mi!==a||Kn!==h?(Nm=null,mp=ki()+500,hf(a,h)):af=je(a,h);e:do try{if(vi!==0&&Nn!==null){h=Nn;var L=Mo;t:switch(vi){case 1:vi=0,Mo=null,Cu(a,h,L,1);break;case 2:case 9:if(kh(L)){vi=0,Mo=null,Iy(h);break}h=function(){vi!==2&&vi!==9||mi!==a||(vi=7),cl(a)},L.then(h,h);break e;case 3:vi=7;break e;case 4:vi=5;break e;case 7:kh(L)?(vi=0,Mo=null,Iy(h)):(vi=0,Mo=null,Cu(a,h,L,7));break;case 5:var q=null;switch(Nn.tag){case 26:q=Nn.memoizedState;case 5:case 27:var se=Nn;if(!q||f(q)){vi=0,Mo=null;var Ce=se.sibling;if(Ce!==null)Nn=Ce;else{var He=se.return;He!==null?(Nn=He,yp(He)):Nn=null}break t}}vi=0,Mo=null,Cu(a,h,L,5);break;case 6:vi=0,Mo=null,Cu(a,h,L,6);break;case 8:Ay(),lr=6;break e;default:throw Error(u(462))}}Vb();break}catch(st){L_(a,st)}while(!0);return yo=Ka=null,Be.H=w,Be.A=D,ui=g,Nn!==null?0:(mi=null,Kn=0,gc(),lr)}function Vb(){for(;Nn!==null&&!Dn();)j_(Nn)}function j_(a){var h=S_(a.alternate,a,Ho);a.memoizedProps=a.pendingProps,h===null?yp(a):Nn=h}function Iy(a){var h=a,g=h.alternate;switch(h.tag){case 15:case 0:h=dy(g,h,h.pendingProps,h.type,void 0,Kn);break;case 11:h=dy(g,h,h.pendingProps,h.type.render,h.ref,Kn);break;case 5:nl(h);default:M_(g,h),h=Nn=tp(h,Ho),h=S_(g,h,Ho)}a.memoizedProps=a.pendingProps,h===null?yp(a):Nn=h}function Cu(a,h,g,w){yo=Ka=null,nl(h),_i=null,Xi=0;var D=h.return;try{if(Lb(a,D,h,g,Kn)){lr=1,xm(a,Nr(g,a.current)),Nn=null;return}}catch(L){if(D!==null)throw Nn=D,L;lr=1,xm(a,Nr(g,a.current)),Nn=null;return}h.flags&32768?(Qn||w===1?a=!0:af||(Kn&536870912)!==0?a=!1:(Rc=a=!0,(w===2||w===9||w===3||w===6)&&(w=Mr.current,w!==null&&w.tag===13&&(w.flags|=16384))),Oc(h,a)):yp(h)}function yp(a){var h=a;do{if((h.flags&32768)!==0){Oc(h,Rc);return}a=h.return;var g=zb(h.alternate,h,Ho);if(g!==null){Nn=g;return}if(h=h.sibling,h!==null){Nn=h;return}Nn=h=a}while(h!==null);lr===0&&(lr=5)}function Oc(a,h){do{var g=jb(a.alternate,a);if(g!==null){g.flags&=32767,Nn=g;return}if(g=a.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!h&&(a=a.sibling,a!==null)){Nn=a;return}Nn=a=g}while(a!==null);lr=6,Nn=null}function df(a,h,g,w,D,L,q,se,Ce){a.cancelPendingCommit=null;do Um();while(Ea!==0);if((ui&6)!==0)throw Error(u(327));if(h!==null){if(h===a.current)throw Error(u(177));if(L=h.lanes|h.childLanes,L|=mc,rn(a,g,L,q,se,Ce),a===mi&&(Nn=mi=null,Kn=0),lf=h,kc=a,cf=g,Ey=L,zm=D,O_=w,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,U_(Or,function(){return Ry(),null})):(a.callbackNode=null,a.callbackPriority=0),w=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||w){w=Be.T,Be.T=null,D=lt.p,lt.p=2,q=ui,ui|=4;try{Jd(a,h,g)}finally{ui=q,lt.p=D,Be.T=w}}Ea=1,Wh(),_p(),vp()}}function Wh(){if(Ea===1){Ea=0;var a=kc,h=lf,g=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||g){g=Be.T,Be.T=null;var w=lt.p;lt.p=2;var D=ui;ui|=4;try{tf(h,a);var L=ro,q=Od(a.containerInfo),se=L.focusedElem,Ce=L.selectionRange;if(q!==se&&se&&se.ownerDocument&&Gn(se.ownerDocument.documentElement,se)){if(Ce!==null&&vh(se)){var He=Ce.start,st=Ce.end;if(st===void 0&&(st=He),"selectionStart"in se)se.selectionStart=He,se.selectionEnd=Math.min(st,se.value.length);else{var ft=se.ownerDocument||document,Ke=ft&&ft.defaultView||window;if(Ke.getSelection){var et=Ke.getSelection(),fn=se.textContent.length,sn=Math.min(Ce.start,fn),gi=Ce.end===void 0?sn:Math.min(Ce.end,fn);!et.extend&&sn>gi&&(q=gi,gi=sn,sn=q);var Ue=Ts(se,sn),Le=Ts(se,gi);if(Ue&&Le&&(et.rangeCount!==1||et.anchorNode!==Ue.node||et.anchorOffset!==Ue.offset||et.focusNode!==Le.node||et.focusOffset!==Le.offset)){var qe=ft.createRange();qe.setStart(Ue.node,Ue.offset),et.removeAllRanges(),sn>gi?(et.addRange(qe),et.extend(Le.node,Le.offset)):(qe.setEnd(Le.node,Le.offset),et.addRange(qe))}}}}for(ft=[],et=se;et=et.parentNode;)et.nodeType===1&&ft.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof se.focus=="function"&&se.focus(),se=0;se<ft.length;se++){var dt=ft[se];dt.element.scrollLeft=dt.left,dt.element.scrollTop=dt.top}}Ie=!!Jm,ro=Jm=null}finally{ui=D,lt.p=w,Be.T=g}}a.current=h,Ea=2}}function _p(){if(Ea===2){Ea=0;var a=kc,h=lf,g=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||g){g=Be.T,Be.T=null;var w=lt.p;lt.p=2;var D=ui;ui|=4;try{_y(a,h.alternate,h)}finally{ui=D,lt.p=w,Be.T=g}}Ea=3}}function vp(){if(Ea===4||Ea===3){Ea=0,Pr();var a=kc,h=lf,g=cf,w=O_;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Ea=5:(Ea=0,lf=kc=null,F_(a,a.pendingLanes));var D=a.pendingLanes;if(D===0&&(ll=null),ci(g),h=h.stateNode,ii&&typeof ii.onCommitFiberRoot=="function")try{ii.onCommitFiberRoot(gn,h,void 0,(h.current.flags&128)===128)}catch{}if(w!==null){h=Be.T,D=lt.p,lt.p=2,Be.T=null;try{for(var L=a.onRecoverableError,q=0;q<w.length;q++){var se=w[q];L(se.value,{componentStack:se.stack})}}finally{Be.T=h,lt.p=D}}(cf&3)!==0&&Um(),cl(a),D=a.pendingLanes,(g&4194090)!==0&&(D&42)!==0?a===Xh?gp++:(gp=0,Xh=a):gp=0,qo(0)}}function F_(a,h){(a.pooledCacheLanes&=h)===0&&(h=a.pooledCache,h!=null&&(a.pooledCache=null,_c(h)))}function Um(a){return Wh(),_p(),vp(),Ry()}function Ry(){if(Ea!==5)return!1;var a=kc,h=Ey;Ey=0;var g=ci(cf),w=Be.T,D=lt.p;try{lt.p=32>g?32:g,Be.T=null,g=zm,zm=null;var L=kc,q=cf;if(Ea=0,lf=kc=null,cf=0,(ui&6)!==0)throw Error(u(331));var se=ui;if(ui|=4,R_(L.current),wy(L,L.current,q,g),ui=se,qo(0,!1),ii&&typeof ii.onPostCommitFiberRoot=="function")try{ii.onPostCommitFiberRoot(gn,L)}catch{}return!0}finally{lt.p=D,Be.T=w,F_(a,h)}}function ky(a,h,g){h=Nr(g,h),h=Tm(a.stateNode,h,2),a=el(a,h,2),a!==null&&(Fe(a,2),cl(a))}function Bi(a,h,g){if(a.tag===3)ky(a,a,g);else for(;h!==null;){if(h.tag===3){ky(h,a,g);break}else if(h.tag===1){var w=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(ll===null||!ll.has(w))){a=Nr(g,a),g=uy(2),w=el(h,g,2),w!==null&&(Bh(g,w,h,a),Fe(w,2),cl(w));break}}h=h.return}}function Vm(a,h,g){var w=a.pingCache;if(w===null){w=a.pingCache=new Fb;var D=new Set;w.set(h,D)}else D=w.get(h),D===void 0&&(D=new Set,w.set(h,D));D.has(g)||(Ty=!0,D.add(g),a=B_.bind(null,a,h,g),h.then(a,a))}function B_(a,h,g){var w=a.pingCache;w!==null&&w.delete(h),a.pingedLanes|=a.suspendedLanes&g,a.warmLanes&=~g,mi===a&&(Kn&g)===g&&(lr===4||lr===3&&(Kn&62914560)===Kn&&300>ki()-Lm?(ui&2)===0&&hf(a,0):Sy|=g,of===Kn&&(of=0)),cl(a)}function Gm(a,h){h===0&&(h=ot()),a=Ha(a,h),a!==null&&(Fe(a,h),cl(a))}function Py(a){var h=a.memoizedState,g=0;h!==null&&(g=h.retryLane),Gm(a,g)}function Gb(a,h){var g=0;switch(a.tag){case 13:var w=a.stateNode,D=a.memoizedState;D!==null&&(g=D.retryLane);break;case 19:w=a.stateNode;break;case 22:w=a.stateNode._retryCache;break;default:throw Error(u(314))}w!==null&&w.delete(h),Gm(a,g)}function U_(a,h){return Un(a,h)}var $m=null,ff=null,Oy=!1,Zm=!1,Ly=!1,Du=0;function cl(a){a!==ff&&a.next===null&&(ff===null?$m=ff=a:ff=ff.next=a),Zm=!0,Oy||(Oy=!0,zy())}function qo(a,h){if(!Ly&&Zm){Ly=!0;do for(var g=!1,w=$m;w!==null;){if(a!==0){var D=w.pendingLanes;if(D===0)var L=0;else{var q=w.suspendedLanes,se=w.pingedLanes;L=(1<<31-Pe(42|a)+1)-1,L&=D&~(q&~se),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(g=!0,bp(w,L))}else L=Kn,L=Ye(w,w===mi?L:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(L&3)===0||je(w,L)||(g=!0,bp(w,L));w=w.next}while(g);Ly=!1}}function Iu(){Ny()}function Ny(){Zm=Oy=!1;var a=0;Du!==0&&(X_()&&(a=Du),Du=0);for(var h=ki(),g=null,w=$m;w!==null;){var D=w.next,L=Ym(w,h);L===0?(w.next=null,g===null?$m=D:g.next=D,D===null&&(ff=g)):(g=w,(a!==0||(L&3)!==0)&&(Zm=!0)),w=D}qo(a)}function Ym(a,h){for(var g=a.suspendedLanes,w=a.pingedLanes,D=a.expirationTimes,L=a.pendingLanes&-62914561;0<L;){var q=31-Pe(L),se=1<<q,Ce=D[q];Ce===-1?((se&g)===0||(se&w)!==0)&&(D[q]=tt(se,h)):Ce<=h&&(a.expiredLanes|=se),L&=~se}if(h=mi,g=Kn,g=Ye(a,a===h?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),w=a.callbackNode,g===0||a===h&&(vi===2||vi===9)||a.cancelPendingCommit!==null)return w!==null&&w!==null&&Vn(w),a.callbackNode=null,a.callbackPriority=0;if((g&3)===0||je(a,g)){if(h=g&-g,h===a.callbackPriority)return h;switch(w!==null&&Vn(w),ci(g)){case 2:case 8:g=Gr;break;case 32:g=Or;break;case 268435456:g=Ca;break;default:g=Or}return w=V_.bind(null,a),g=Un(g,w),a.callbackPriority=h,a.callbackNode=g,h}return w!==null&&w!==null&&Vn(w),a.callbackPriority=2,a.callbackNode=null,2}function V_(a,h){if(Ea!==0&&Ea!==5)return a.callbackNode=null,a.callbackPriority=0,null;var g=a.callbackNode;if(Um()&&a.callbackNode!==g)return null;var w=Kn;return w=Ye(a,a===mi?w:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),w===0?null:(My(a,w,h),Ym(a,ki()),a.callbackNode!=null&&a.callbackNode===g?V_.bind(null,a):null)}function bp(a,h){if(Um())return null;My(a,h,!0)}function zy(){Pu(function(){(ui&6)!==0?Un(_a,Iu):Ny()})}function jy(){return Du===0&&(Du=mt()),Du}function Hm(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:xn(""+a)}function qm(a,h){var g=h.ownerDocument.createElement("input");return g.name=h.name,g.value=h.value,a.id&&g.setAttribute("form",a.id),h.parentNode.insertBefore(g,h),a=new FormData(a),g.parentNode.removeChild(g),a}function pf(a,h,g,w,D){if(h==="submit"&&g&&g.stateNode===D){var L=Hm((D[an]||null).action),q=w.submitter;q&&(h=(h=q[an]||null)?Hm(h.formAction):q.getAttribute("formAction"),h!==null&&(L=h,q=null));var se=new Za("action","action",null,w,D);a.push({event:se,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(Du!==0){var Ce=q?qm(D,q):new FormData(D);ji(g,{pending:!0,data:Ce,method:D.method,action:L},null,Ce)}}else typeof L=="function"&&(se.preventDefault(),Ce=q?qm(D,q):new FormData(D),ji(g,{pending:!0,data:Ce,method:D.method,action:L},L,Ce))},currentTarget:D}]})}}for(var Xm=0;Xm<Nd.length;Xm++){var Wm=Nd[Xm],Fy=Wm.toLowerCase(),G_=Wm[0].toUpperCase()+Wm.slice(1);mo(Fy,"on"+G_)}mo(bh,"onAnimationEnd"),mo(xh,"onAnimationIteration"),mo(wh,"onAnimationStart"),mo("dblclick","onDoubleClick"),mo("focusin","onFocus"),mo("focusout","onBlur"),mo(Jf,"onTransitionRun"),mo(fc,"onTransitionStart"),mo(Th,"onTransitionCancel"),mo(pc,"onTransitionEnd"),Gs("onMouseEnter",["mouseout","mouseover"]),Gs("onMouseLeave",["mouseout","mouseover"]),Gs("onPointerEnter",["pointerout","pointerover"]),Gs("onPointerLeave",["pointerout","pointerover"]),Ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ru));function Z_(a,h){h=(h&4)!==0;for(var g=0;g<a.length;g++){var w=a[g],D=w.event;w=w.listeners;e:{var L=void 0;if(h)for(var q=w.length-1;0<=q;q--){var se=w[q],Ce=se.instance,He=se.currentTarget;if(se=se.listener,Ce!==L&&D.isPropagationStopped())break e;L=se,D.currentTarget=He;try{L(D)}catch(st){Fh(st)}D.currentTarget=null,L=Ce}else for(q=0;q<w.length;q++){if(se=w[q],Ce=se.instance,He=se.currentTarget,se=se.listener,Ce!==L&&D.isPropagationStopped())break e;L=se,D.currentTarget=He;try{L(D)}catch(st){Fh(st)}D.currentTarget=null,L=Ce}}}}function Zn(a,h){var g=h[wt];g===void 0&&(g=h[wt]=new Set);var w=a+"__bubble";g.has(w)||(Y_(h,a,2,!1),g.add(w))}function Qm(a,h,g){var w=0;h&&(w|=4),Y_(g,a,w,h)}var Km="_reactListening"+Math.random().toString(36).slice(2);function By(a){if(!a[Km]){a[Km]=!0,_n.forEach(function(g){g!=="selectionchange"&&($_.has(g)||Qm(g,!1,a),Qm(g,!0,a))});var h=a.nodeType===9?a:a.ownerDocument;h===null||h[Km]||(h[Km]=!0,Qm("selectionchange",!1,h))}}function Y_(a,h,g,w){switch(Vt(h)){case 2:var D=Ze;break;case 8:D=Je;break;default:D=ht}g=D.bind(null,h,g,a),D=void 0,!Hr||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(D=!0),w?D!==void 0?a.addEventListener(h,g,{capture:!0,passive:D}):a.addEventListener(h,g,!0):D!==void 0?a.addEventListener(h,g,{passive:D}):a.addEventListener(h,g,!1)}function Uy(a,h,g,w,D){var L=w;if((h&1)===0&&(h&2)===0&&w!==null)e:for(;;){if(w===null)return;var q=w.tag;if(q===3||q===4){var se=w.stateNode.containerInfo;if(se===D)break;if(q===4)for(q=w.return;q!==null;){var Ce=q.tag;if((Ce===3||Ce===4)&&q.stateNode.containerInfo===D)return;q=q.return}for(;se!==null;){if(q=yn(se),q===null)return;if(Ce=q.tag,Ce===5||Ce===6||Ce===26||Ce===27){w=L=q;continue e}se=se.parentNode}}w=w.return}ar(function(){var He=L,st=Wc(g),ft=[];e:{var Ke=Ya.get(a);if(Ke!==void 0){var et=Za,fn=a;switch(a){case"keypress":if(on(g)===0)break e;case"keydown":case"keyup":et=dh;break;case"focusin":fn="focus",et=ac;break;case"focusout":fn="blur",et=ac;break;case"beforeblur":case"afterblur":et=ac;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=lh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Lr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=ry;break;case bh:case xh:case wh:et=Ki;break;case pc:et=ay;break;case"scroll":case"scrollend":et=Vf;break;case"wheel":et=kd;break;case"copy":case"cut":case"paste":et=ch;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=$f;break;case"toggle":case"beforetoggle":et=lc}var sn=(h&4)!==0,gi=!sn&&(a==="scroll"||a==="scrollend"),Ue=sn?Ke!==null?Ke+"Capture":null:Ke;sn=[];for(var Le=He,qe;Le!==null;){var dt=Le;if(qe=dt.stateNode,dt=dt.tag,dt!==5&&dt!==26&&dt!==27||qe===null||Ue===null||(dt=Wn(Le,Ue),dt!=null&&sn.push(xp(Le,dt,qe))),gi)break;Le=Le.return}0<sn.length&&(Ke=new et(Ke,fn,null,g,st),ft.push({event:Ke,listeners:sn}))}}if((h&7)===0){e:{if(Ke=a==="mouseover"||a==="pointerover",et=a==="mouseout"||a==="pointerout",Ke&&g!==Zs&&(fn=g.relatedTarget||g.fromElement)&&(yn(fn)||fn[Pi]))break e;if((et||Ke)&&(Ke=st.window===st?st:(Ke=st.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,et?(fn=g.relatedTarget||g.toElement,et=He,fn=fn?yn(fn):null,fn!==null&&(gi=m(fn),sn=fn.tag,fn!==gi||sn!==5&&sn!==27&&sn!==6)&&(fn=null)):(et=null,fn=He),et!==fn)){if(sn=lh,dt="onMouseLeave",Ue="onMouseEnter",Le="mouse",(a==="pointerout"||a==="pointerover")&&(sn=$f,dt="onPointerLeave",Ue="onPointerEnter",Le="pointer"),gi=et==null?Ke:rr(et),qe=fn==null?Ke:rr(fn),Ke=new sn(dt,Le+"leave",et,g,st),Ke.target=gi,Ke.relatedTarget=qe,dt=null,yn(st)===He&&(sn=new sn(Ue,Le+"enter",fn,g,st),sn.target=qe,sn.relatedTarget=gi,dt=sn),gi=dt,et&&fn)t:{for(sn=et,Ue=fn,Le=0,qe=sn;qe;qe=Xo(qe))Le++;for(qe=0,dt=Ue;dt;dt=Xo(dt))qe++;for(;0<Le-qe;)sn=Xo(sn),Le--;for(;0<qe-Le;)Ue=Xo(Ue),qe--;for(;Le--;){if(sn===Ue||Ue!==null&&sn===Ue.alternate)break t;sn=Xo(sn),Ue=Xo(Ue)}sn=null}else sn=null;et!==null&&Vy(ft,Ke,et,sn,!1),fn!==null&&gi!==null&&Vy(ft,gi,fn,sn,!0)}}e:{if(Ke=He?rr(He):window,et=Ke.nodeName&&Ke.nodeName.toLowerCase(),et==="select"||et==="input"&&Ke.type==="file")var Ht=Wf;else if(sm(Ke))if(El)Ht=hm;else{Ht=ly;var Fn=cm}else et=Ke.nodeName,!et||et.toLowerCase()!=="input"||Ke.type!=="checkbox"&&Ke.type!=="radio"?He&&vs(He.elementType)&&(Ht=Wf):Ht=um;if(Ht&&(Ht=Ht(a,He))){Xf(ft,Ht,g,st);break e}Fn&&Fn(a,Ke,He),a==="focusout"&&He&&Ke.type==="number"&&He.memoizedProps.value!=null&&sh(Ke,"number",Ke.value)}switch(Fn=He?rr(He):window,a){case"focusin":(sm(Fn)||Fn.contentEditable==="true")&&(Ml=Fn,Hs=He,hc=null);break;case"focusout":hc=Hs=Ml=null;break;case"mousedown":Kf=!0;break;case"contextmenu":case"mouseup":case"dragend":Kf=!1,fm(ft,g,st);break;case"selectionchange":if(dm)break;case"keydown":case"keyup":fm(ft,g,st)}var en;if(Jc)e:{switch(a){case"compositionstart":var hn="onCompositionStart";break e;case"compositionend":hn="onCompositionEnd";break e;case"compositionupdate":hn="onCompositionUpdate";break e}hn=void 0}else nu?am(a,g)&&(hn="onCompositionEnd"):a==="keydown"&&g.keyCode===229&&(hn="onCompositionStart");hn&&(fh&&g.locale!=="ko"&&(nu||hn!=="onCompositionStart"?hn==="onCompositionEnd"&&nu&&(en=Qt()):(qi=st,fi="value"in qi?qi.value:qi.textContent,nu=!0)),Fn=mf(He,hn),0<Fn.length&&(hn=new rm(hn,a,null,g,st),ft.push({event:hn,listeners:Fn}),en?hn.data=en:(en=ph(g),en!==null&&(hn.data=en)))),(en=sy?cc(a,g):om(a,g))&&(hn=mf(He,"onBeforeInput"),0<hn.length&&(Fn=new rm("onBeforeInput","beforeinput",null,g,st),ft.push({event:Fn,listeners:hn}),Fn.data=en)),pf(ft,a,He,g,st)}Z_(ft,h)})}function xp(a,h,g){return{instance:a,listener:h,currentTarget:g}}function mf(a,h){for(var g=h+"Capture",w=[];a!==null;){var D=a,L=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||L===null||(D=Wn(a,g),D!=null&&w.unshift(xp(a,D,L)),D=Wn(a,h),D!=null&&w.push(xp(a,D,L))),a.tag===3)return w;a=a.return}return[]}function Xo(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Vy(a,h,g,w,D){for(var L=h._reactName,q=[];g!==null&&g!==w;){var se=g,Ce=se.alternate,He=se.stateNode;if(se=se.tag,Ce!==null&&Ce===w)break;se!==5&&se!==26&&se!==27||He===null||(Ce=He,D?(He=Wn(g,L),He!=null&&q.unshift(xp(g,He,Ce))):D||(He=Wn(g,L),He!=null&&q.push(xp(g,He,Ce)))),g=g.return}q.length!==0&&a.push({event:h,listeners:q})}var H_=/\r\n?/g,q_=/\u0000|\uFFFD/g;function Gy(a){return(typeof a=="string"?a:""+a).replace(H_,`
`).replace(q_,"")}function $y(a,h){return h=Gy(h),Gy(a)===h}function gf(){}function bi(a,h,g,w,D,L){switch(g){case"children":typeof w=="string"?h==="body"||h==="textarea"&&w===""||_s(a,w):(typeof w=="number"||typeof w=="bigint")&&h!=="body"&&_s(a,""+w);break;case"className":ei(a,"class",w);break;case"tabIndex":ei(a,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":ei(a,g,w);break;case"style":xl(a,w,L);break;case"data":if(h!=="object"){ei(a,"data",w);break}case"src":case"href":if(w===""&&(h!=="a"||g!=="href")){a.removeAttribute(g);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){a.removeAttribute(g);break}w=xn(""+w),a.setAttribute(g,w);break;case"action":case"formAction":if(typeof w=="function"){a.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(g==="formAction"?(h!=="input"&&bi(a,h,"name",D.name,D,null),bi(a,h,"formEncType",D.formEncType,D,null),bi(a,h,"formMethod",D.formMethod,D,null),bi(a,h,"formTarget",D.formTarget,D,null)):(bi(a,h,"encType",D.encType,D,null),bi(a,h,"method",D.method,D,null),bi(a,h,"target",D.target,D,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){a.removeAttribute(g);break}w=xn(""+w),a.setAttribute(g,w);break;case"onClick":w!=null&&(a.onclick=gf);break;case"onScroll":w!=null&&Zn("scroll",a);break;case"onScrollEnd":w!=null&&Zn("scrollend",a);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(u(61));if(g=w.__html,g!=null){if(D.children!=null)throw Error(u(60));a.innerHTML=g}}break;case"multiple":a.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":a.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){a.removeAttribute("xlink:href");break}g=xn(""+w),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?a.setAttribute(g,""+w):a.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?a.setAttribute(g,""):a.removeAttribute(g);break;case"capture":case"download":w===!0?a.setAttribute(g,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?a.setAttribute(g,w):a.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?a.setAttribute(g,w):a.removeAttribute(g);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?a.removeAttribute(g):a.setAttribute(g,w);break;case"popover":Zn("beforetoggle",a),Zn("toggle",a),$r(a,"popover",w);break;case"xlinkActuate":gs(a,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":gs(a,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":gs(a,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":gs(a,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":gs(a,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":gs(a,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":gs(a,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":gs(a,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":gs(a,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":$r(a,"is",w);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=$s.get(g)||g,$r(a,g,w))}}function Qh(a,h,g,w,D,L){switch(g){case"style":xl(a,w,L);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(u(61));if(g=w.__html,g!=null){if(D.children!=null)throw Error(u(60));a.innerHTML=g}}break;case"children":typeof w=="string"?_s(a,w):(typeof w=="number"||typeof w=="bigint")&&_s(a,""+w);break;case"onScroll":w!=null&&Zn("scroll",a);break;case"onScrollEnd":w!=null&&Zn("scrollend",a);break;case"onClick":w!=null&&(a.onclick=gf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!rh.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(D=g.endsWith("Capture"),h=g.slice(2,D?g.length-7:void 0),L=a[an]||null,L=L!=null?L[g]:null,typeof L=="function"&&a.removeEventListener(h,L,D),typeof w=="function")){typeof L!="function"&&L!==null&&(g in a?a[g]=null:a.hasAttribute(g)&&a.removeAttribute(g)),a.addEventListener(h,w,D);break e}g in a?a[g]=w:w===!0?a.setAttribute(g,""):$r(a,g,w)}}}function ha(a,h,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Zn("error",a),Zn("load",a);var w=!1,D=!1,L;for(L in g)if(g.hasOwnProperty(L)){var q=g[L];if(q!=null)switch(L){case"src":w=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(u(137,h));default:bi(a,h,L,q,g,null)}}D&&bi(a,h,"srcSet",g.srcSet,g,null),w&&bi(a,h,"src",g.src,g,null);return;case"input":Zn("invalid",a);var se=L=q=D=null,Ce=null,He=null;for(w in g)if(g.hasOwnProperty(w)){var st=g[w];if(st!=null)switch(w){case"name":D=st;break;case"type":q=st;break;case"checked":Ce=st;break;case"defaultChecked":He=st;break;case"value":L=st;break;case"defaultValue":se=st;break;case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(u(137,h));break;default:bi(a,h,w,st,g,null)}}ec(a,L,se,Ce,He,q,D,!1),Id(a);return;case"select":Zn("invalid",a),w=q=L=null;for(D in g)if(g.hasOwnProperty(D)&&(se=g[D],se!=null))switch(D){case"value":L=se;break;case"defaultValue":q=se;break;case"multiple":w=se;default:bi(a,h,D,se,g,null)}h=L,g=q,a.multiple=!!w,h!=null?bl(a,!!w,h,!1):g!=null&&bl(a,!!w,g,!0);return;case"textarea":Zn("invalid",a),L=D=w=null;for(q in g)if(g.hasOwnProperty(q)&&(se=g[q],se!=null))switch(q){case"value":w=se;break;case"defaultValue":D=se;break;case"children":L=se;break;case"dangerouslySetInnerHTML":if(se!=null)throw Error(u(91));break;default:bi(a,h,q,se,g,null)}tc(a,w,D,L),Id(a);return;case"option":for(Ce in g)if(g.hasOwnProperty(Ce)&&(w=g[Ce],w!=null))switch(Ce){case"selected":a.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:bi(a,h,Ce,w,g,null)}return;case"dialog":Zn("beforetoggle",a),Zn("toggle",a),Zn("cancel",a),Zn("close",a);break;case"iframe":case"object":Zn("load",a);break;case"video":case"audio":for(w=0;w<Ru.length;w++)Zn(Ru[w],a);break;case"image":Zn("error",a),Zn("load",a);break;case"details":Zn("toggle",a);break;case"embed":case"source":case"link":Zn("error",a),Zn("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(He in g)if(g.hasOwnProperty(He)&&(w=g[He],w!=null))switch(He){case"children":case"dangerouslySetInnerHTML":throw Error(u(137,h));default:bi(a,h,He,w,g,null)}return;default:if(vs(h)){for(st in g)g.hasOwnProperty(st)&&(w=g[st],w!==void 0&&Qh(a,h,st,w,g,void 0));return}}for(se in g)g.hasOwnProperty(se)&&(w=g[se],w!=null&&bi(a,h,se,w,g,null))}function Zy(a,h,g,w){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,L=null,q=null,se=null,Ce=null,He=null,st=null;for(et in g){var ft=g[et];if(g.hasOwnProperty(et)&&ft!=null)switch(et){case"checked":break;case"value":break;case"defaultValue":Ce=ft;default:w.hasOwnProperty(et)||bi(a,h,et,null,w,ft)}}for(var Ke in w){var et=w[Ke];if(ft=g[Ke],w.hasOwnProperty(Ke)&&(et!=null||ft!=null))switch(Ke){case"type":L=et;break;case"name":D=et;break;case"checked":He=et;break;case"defaultChecked":st=et;break;case"value":q=et;break;case"defaultValue":se=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(u(137,h));break;default:et!==ft&&bi(a,h,Ke,et,w,ft)}}oh(a,q,se,Ce,He,st,L,D);return;case"select":et=q=se=Ke=null;for(L in g)if(Ce=g[L],g.hasOwnProperty(L)&&Ce!=null)switch(L){case"value":break;case"multiple":et=Ce;default:w.hasOwnProperty(L)||bi(a,h,L,null,w,Ce)}for(D in w)if(L=w[D],Ce=g[D],w.hasOwnProperty(D)&&(L!=null||Ce!=null))switch(D){case"value":Ke=L;break;case"defaultValue":se=L;break;case"multiple":q=L;default:L!==Ce&&bi(a,h,D,L,w,Ce)}h=se,g=q,w=et,Ke!=null?bl(a,!!g,Ke,!1):!!w!=!!g&&(h!=null?bl(a,!!g,h,!0):bl(a,!!g,g?[]:"",!1));return;case"textarea":et=Ke=null;for(se in g)if(D=g[se],g.hasOwnProperty(se)&&D!=null&&!w.hasOwnProperty(se))switch(se){case"value":break;case"children":break;default:bi(a,h,se,null,w,D)}for(q in w)if(D=w[q],L=g[q],w.hasOwnProperty(q)&&(D!=null||L!=null))switch(q){case"value":Ke=D;break;case"defaultValue":et=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(u(91));break;default:D!==L&&bi(a,h,q,D,w,L)}nm(a,Ke,et);return;case"option":for(var fn in g)if(Ke=g[fn],g.hasOwnProperty(fn)&&Ke!=null&&!w.hasOwnProperty(fn))switch(fn){case"selected":a.selected=!1;break;default:bi(a,h,fn,null,w,Ke)}for(Ce in w)if(Ke=w[Ce],et=g[Ce],w.hasOwnProperty(Ce)&&Ke!==et&&(Ke!=null||et!=null))switch(Ce){case"selected":a.selected=Ke&&typeof Ke!="function"&&typeof Ke!="symbol";break;default:bi(a,h,Ce,Ke,w,et)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var sn in g)Ke=g[sn],g.hasOwnProperty(sn)&&Ke!=null&&!w.hasOwnProperty(sn)&&bi(a,h,sn,null,w,Ke);for(He in w)if(Ke=w[He],et=g[He],w.hasOwnProperty(He)&&Ke!==et&&(Ke!=null||et!=null))switch(He){case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(u(137,h));break;default:bi(a,h,He,Ke,w,et)}return;default:if(vs(h)){for(var gi in g)Ke=g[gi],g.hasOwnProperty(gi)&&Ke!==void 0&&!w.hasOwnProperty(gi)&&Qh(a,h,gi,void 0,w,Ke);for(st in w)Ke=w[st],et=g[st],!w.hasOwnProperty(st)||Ke===et||Ke===void 0&&et===void 0||Qh(a,h,st,Ke,w,et);return}}for(var Ue in g)Ke=g[Ue],g.hasOwnProperty(Ue)&&Ke!=null&&!w.hasOwnProperty(Ue)&&bi(a,h,Ue,null,w,Ke);for(ft in w)Ke=w[ft],et=g[ft],!w.hasOwnProperty(ft)||Ke===et||Ke==null&&et==null||bi(a,h,ft,Ke,w,et)}var Jm=null,ro=null;function Lc(a){return a.nodeType===9?a:a.ownerDocument}function yf(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ku(a,h){if(a===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&h==="foreignObject"?0:a}function eg(a,h){return a==="textarea"||a==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var tg=null;function X_(){var a=window.event;return a&&a.type==="popstate"?a===tg?!1:(tg=a,!0):(tg=null,!1)}var Yy=typeof setTimeout=="function"?setTimeout:void 0,$b=typeof clearTimeout=="function"?clearTimeout:void 0,Hy=typeof Promise=="function"?Promise:void 0,Pu=typeof queueMicrotask=="function"?queueMicrotask:typeof Hy<"u"?function(a){return Hy.resolve(null).then(a).catch(W_)}:Yy;function W_(a){setTimeout(function(){throw a})}function Nc(a){return a==="head"}function qy(a,h){var g=h,w=0,D=0;do{var L=g.nextSibling;if(a.removeChild(g),L&&L.nodeType===8)if(g=L.data,g==="/$"){if(0<w&&8>w){g=w;var q=a.ownerDocument;if(g&1&&Ou(q.documentElement),g&2&&Ou(q.body),g&4)for(g=q.head,Ou(g),q=g.firstChild;q;){var se=q.nextSibling,Ce=q.nodeName;q[ps]||Ce==="SCRIPT"||Ce==="STYLE"||Ce==="LINK"&&q.rel.toLowerCase()==="stylesheet"||g.removeChild(q),q=se}}if(D===0){a.removeChild(L),Br(h);return}D--}else g==="$"||g==="$?"||g==="$!"?D++:w=g.charCodeAt(0)-48;else w=0;g=L}while(g);Br(h)}function ng(a){var h=a.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var g=h;switch(h=h.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":ng(g),It(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}a.removeChild(g)}}function Zb(a,h,g,w){for(;a.nodeType===1;){var D=g;if(a.nodeName.toLowerCase()!==h.toLowerCase()){if(!w&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(w){if(!a[ps])switch(h){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(L=a.getAttribute("rel"),L==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(L!==D.rel||a.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||a.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||a.getAttribute("title")!==(D.title==null?null:D.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(L=a.getAttribute("src"),(L!==(D.src==null?null:D.src)||a.getAttribute("type")!==(D.type==null?null:D.type)||a.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&L&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(h==="input"&&a.type==="hidden"){var L=D.name==null?null:""+D.name;if(D.type==="hidden"&&a.getAttribute("name")===L)return a}else return a;if(a=Co(a.nextSibling),a===null)break}return null}function Yb(a,h,g){if(h==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!g||(a=Co(a.nextSibling),a===null))return null;return a}function ig(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function Q_(a,h){var g=a.ownerDocument;if(a.data!=="$?"||g.readyState==="complete")h();else{var w=function(){h(),g.removeEventListener("DOMContentLoaded",w)};g.addEventListener("DOMContentLoaded",w),a._reactRetry=w}}function Co(a){for(;a!=null;a=a.nextSibling){var h=a.nodeType;if(h===1||h===3)break;if(h===8){if(h=a.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return a}var rg=null;function wp(a){a=a.previousSibling;for(var h=0;a;){if(a.nodeType===8){var g=a.data;if(g==="$"||g==="$!"||g==="$?"){if(h===0)return a;h--}else g==="/$"&&h++}a=a.previousSibling}return null}function Tp(a,h,g){switch(h=Lc(g),a){case"html":if(a=h.documentElement,!a)throw Error(u(452));return a;case"head":if(a=h.head,!a)throw Error(u(453));return a;case"body":if(a=h.body,!a)throw Error(u(454));return a;default:throw Error(u(451))}}function Ou(a){for(var h=a.attributes;h.length;)a.removeAttributeNode(h[0]);It(a)}var Is=new Map,K_=new Set;function ag(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Do=lt.d;lt.d={f:da,r:Xy,D:Qy,C:Hb,L:J_,m:ev,X:tv,S:qb,M:Ky};function da(){var a=Do.f(),h=Bm();return a||h}function Xy(a){var h=ln(a);h!==null&&h.tag===5&&h.type==="form"?un(h):Do.r(a)}var Kh=typeof document>"u"?null:document;function Wy(a,h,g){var w=Kh;if(w&&typeof h=="string"&&h){var D=Ra(h);D='link[rel="'+a+'"][href="'+D+'"]',typeof g=="string"&&(D+='[crossorigin="'+g+'"]'),K_.has(D)||(K_.add(D),a={rel:a,crossOrigin:g,href:h},w.querySelector(D)===null&&(h=w.createElement("link"),ha(h,"link",a),Oi(h),w.head.appendChild(h)))}}function Qy(a){Do.D(a),Wy("dns-prefetch",a,null)}function Hb(a,h){Do.C(a,h),Wy("preconnect",a,h)}function J_(a,h,g){Do.L(a,h,g);var w=Kh;if(w&&a&&h){var D='link[rel="preload"][as="'+Ra(h)+'"]';h==="image"&&g&&g.imageSrcSet?(D+='[imagesrcset="'+Ra(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(D+='[imagesizes="'+Ra(g.imageSizes)+'"]')):D+='[href="'+Ra(a)+'"]';var L=D;switch(h){case"style":L=Jh(a);break;case"script":L=Lu(a)}Is.has(L)||(a=k({rel:"preload",href:h==="image"&&g&&g.imageSrcSet?void 0:a,as:h},g),Is.set(L,a),w.querySelector(D)!==null||h==="style"&&w.querySelector(zc(L))||h==="script"&&w.querySelector(Nu(L))||(h=w.createElement("link"),ha(h,"link",a),Oi(h),w.head.appendChild(h)))}}function ev(a,h){Do.m(a,h);var g=Kh;if(g&&a){var w=h&&typeof h.as=="string"?h.as:"script",D='link[rel="modulepreload"][as="'+Ra(w)+'"][href="'+Ra(a)+'"]',L=D;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Lu(a)}if(!Is.has(L)&&(a=k({rel:"modulepreload",href:a},h),Is.set(L,a),g.querySelector(D)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Nu(L)))return}w=g.createElement("link"),ha(w,"link",a),Oi(w),g.head.appendChild(w)}}}function qb(a,h,g){Do.S(a,h,g);var w=Kh;if(w&&a){var D=fo(w).hoistableStyles,L=Jh(a);h=h||"default";var q=D.get(L);if(!q){var se={loading:0,preload:null};if(q=w.querySelector(zc(L)))se.loading=5;else{a=k({rel:"stylesheet",href:a,"data-precedence":h},g),(g=Is.get(L))&&Sp(a,g);var Ce=q=w.createElement("link");Oi(Ce),ha(Ce,"link",a),Ce._p=new Promise(function(He,st){Ce.onload=He,Ce.onerror=st}),Ce.addEventListener("load",function(){se.loading|=1}),Ce.addEventListener("error",function(){se.loading|=2}),se.loading|=4,vf(q,h,w)}q={type:"stylesheet",instance:q,count:1,state:se},D.set(L,q)}}}function tv(a,h){Do.X(a,h);var g=Kh;if(g&&a){var w=fo(g).hoistableScripts,D=Lu(a),L=w.get(D);L||(L=g.querySelector(Nu(D)),L||(a=k({src:a,async:!0},h),(h=Is.get(D))&&Ep(a,h),L=g.createElement("script"),Oi(L),ha(L,"link",a),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},w.set(D,L))}}function Ky(a,h){Do.M(a,h);var g=Kh;if(g&&a){var w=fo(g).hoistableScripts,D=Lu(a),L=w.get(D);L||(L=g.querySelector(Nu(D)),L||(a=k({src:a,async:!0,type:"module"},h),(h=Is.get(D))&&Ep(a,h),L=g.createElement("script"),Oi(L),ha(L,"link",a),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},w.set(D,L))}}function og(a,h,g,w){var D=(D=Ot.current)?ag(D):null;if(!D)throw Error(u(446));switch(a){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(h=Jh(g.href),g=fo(D).hoistableStyles,w=g.get(h),w||(w={type:"style",instance:null,count:0,state:null},g.set(h,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){a=Jh(g.href);var L=fo(D).hoistableStyles,q=L.get(a);if(q||(D=D.ownerDocument||D,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(a,q),(L=D.querySelector(zc(a)))&&!L._p&&(q.instance=L,q.state.loading=5),Is.has(a)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Is.set(a,g),L||nv(D,a,g,q.state))),h&&w===null)throw Error(u(528,""));return q}if(h&&w!==null)throw Error(u(529,""));return null;case"script":return h=g.async,g=g.src,typeof g=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Lu(g),g=fo(D).hoistableScripts,w=g.get(h),w||(w={type:"script",instance:null,count:0,state:null},g.set(h,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(u(444,a))}}function Jh(a){return'href="'+Ra(a)+'"'}function zc(a){return'link[rel="stylesheet"]['+a+"]"}function sg(a){return k({},a,{"data-precedence":a.precedence,precedence:null})}function nv(a,h,g,w){a.querySelector('link[rel="preload"][as="style"]['+h+"]")?w.loading=1:(h=a.createElement("link"),w.preload=h,h.addEventListener("load",function(){return w.loading|=1}),h.addEventListener("error",function(){return w.loading|=2}),ha(h,"link",g),Oi(h),a.head.appendChild(h))}function Lu(a){return'[src="'+Ra(a)+'"]'}function Nu(a){return"script[async]"+a}function _f(a,h,g){if(h.count++,h.instance===null)switch(h.type){case"style":var w=a.querySelector('style[data-href~="'+Ra(g.href)+'"]');if(w)return h.instance=w,Oi(w),w;var D=k({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return w=(a.ownerDocument||a).createElement("style"),Oi(w),ha(w,"style",D),vf(w,g.precedence,a),h.instance=w;case"stylesheet":D=Jh(g.href);var L=a.querySelector(zc(D));if(L)return h.state.loading|=4,h.instance=L,Oi(L),L;w=sg(g),(D=Is.get(D))&&Sp(w,D),L=(a.ownerDocument||a).createElement("link"),Oi(L);var q=L;return q._p=new Promise(function(se,Ce){q.onload=se,q.onerror=Ce}),ha(L,"link",w),h.state.loading|=4,vf(L,g.precedence,a),h.instance=L;case"script":return L=Lu(g.src),(D=a.querySelector(Nu(L)))?(h.instance=D,Oi(D),D):(w=g,(D=Is.get(L))&&(w=k({},g),Ep(w,D)),a=a.ownerDocument||a,D=a.createElement("script"),Oi(D),ha(D,"link",w),a.head.appendChild(D),h.instance=D);case"void":return null;default:throw Error(u(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(w=h.instance,h.state.loading|=4,vf(w,g.precedence,a));return h.instance}function vf(a,h,g){for(var w=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=w.length?w[w.length-1]:null,L=D,q=0;q<w.length;q++){var se=w[q];if(se.dataset.precedence===h)L=se;else if(L!==D)break}L?L.parentNode.insertBefore(a,L.nextSibling):(h=g.nodeType===9?g.head:g,h.insertBefore(a,h.firstChild))}function Sp(a,h){a.crossOrigin==null&&(a.crossOrigin=h.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=h.referrerPolicy),a.title==null&&(a.title=h.title)}function Ep(a,h){a.crossOrigin==null&&(a.crossOrigin=h.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=h.referrerPolicy),a.integrity==null&&(a.integrity=h.integrity)}var lg=null;function s(a,h,g){if(lg===null){var w=new Map,D=lg=new Map;D.set(g,w)}else D=lg,w=D.get(g),w||(w=new Map,D.set(g,w));if(w.has(a))return w;for(w.set(a,null),g=g.getElementsByTagName(a),D=0;D<g.length;D++){var L=g[D];if(!(L[ps]||L[Kt]||a==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var q=L.getAttribute(h)||"";q=a+q;var se=w.get(q);se?se.push(L):w.set(q,[L])}}return w}function i(a,h,g){a=a.ownerDocument||a,a.head.insertBefore(g,h==="title"?a.querySelector("head > title"):null)}function o(a,h,g){if(g===1||h.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return a=h.disabled,typeof h.precedence=="string"&&a==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function f(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var _=null;function x(){}function S(a,h,g){if(_===null)throw Error(u(475));var w=_;if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var D=Jh(g.href),L=a.querySelector(zc(D));if(L){a=L._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(w.count++,w=I.bind(w),a.then(w,w)),h.state.loading|=4,h.instance=L,Oi(L);return}L=a.ownerDocument||a,g=sg(g),(D=Is.get(D))&&Sp(g,D),L=L.createElement("link"),Oi(L);var q=L;q._p=new Promise(function(se,Ce){q.onload=se,q.onerror=Ce}),ha(L,"link",g),h.instance=L}w.stylesheets===null&&(w.stylesheets=new Map),w.stylesheets.set(h,a),(a=h.state.preload)&&(h.state.loading&3)===0&&(w.count++,h=I.bind(w),a.addEventListener("load",h),a.addEventListener("error",h))}}function A(){if(_===null)throw Error(u(475));var a=_;return a.stylesheets&&a.count===0&&z(a,a.stylesheets),0<a.count?function(h){var g=setTimeout(function(){if(a.stylesheets&&z(a,a.stylesheets),a.unsuspend){var w=a.unsuspend;a.unsuspend=null,w()}},6e4);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(g)}}:null}function I(){if(this.count--,this.count===0){if(this.stylesheets)z(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var O=null;function z(a,h){a.stylesheets=null,a.unsuspend!==null&&(a.count++,O=new Map,h.forEach(V,a),O=null,I.call(a))}function V(a,h){if(!(h.state.loading&4)){var g=O.get(a);if(g)var w=g.get(null);else{g=new Map,O.set(a,g);for(var D=a.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<D.length;L++){var q=D[L];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(g.set(q.dataset.precedence,q),w=q)}w&&g.set(null,w)}D=h.instance,q=D.getAttribute("data-precedence"),L=g.get(q)||w,L===w&&g.set(null,D),g.set(q,D),this.count++,w=I.bind(this),D.addEventListener("load",w),D.addEventListener("error",w),L?L.parentNode.insertBefore(D,L.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(D,a.firstChild)),h.state.loading|=4}}var Z={$$typeof:we,Provider:null,Consumer:null,_currentValue:_t,_currentValue2:_t,_threadCount:0};function X(a,h,g,w,D,L,q,se){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jt(0),this.hiddenUpdates=jt(null),this.identifierPrefix=w,this.onUncaughtError=D,this.onCaughtError=L,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function Q(a,h,g,w,D,L,q,se,Ce,He,st,ft){return a=new X(a,h,g,q,se,Ce,He,ft),h=1,L===!0&&(h|=24),L=qa(3,null,null,h),a.current=L,L.stateNode=a,h=Ol(),h.refCount++,a.pooledCache=h,h.refCount++,L.memoizedState={element:w,isDehydrated:g,cache:h},ap(L),a}function ae(a){return a?(a=vn,a):vn}function ce(a,h,g,w,D,L){D=ae(D),w.context===null?w.context=D:w.pendingContext=D,w=Ll(h),w.payload={element:g},L=L===void 0?null:L,L!==null&&(w.callback=L),g=el(a,w,h),g!==null&&(Ao(g,a,h),bc(g,a,h))}function me(a,h){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var g=a.retryLane;a.retryLane=g!==0&&g<h?g:h}}function ze(a,h){me(a,h),(a=a.alternate)&&me(a,h)}function xe(a){if(a.tag===13){var h=Ha(a,67108864);h!==null&&Ao(h,a,67108864),ze(a,67108864)}}var Ie=!0;function Ze(a,h,g,w){var D=Be.T;Be.T=null;var L=lt.p;try{lt.p=2,ht(a,h,g,w)}finally{lt.p=L,Be.T=D}}function Je(a,h,g,w){var D=Be.T;Be.T=null;var L=lt.p;try{lt.p=8,ht(a,h,g,w)}finally{lt.p=L,Be.T=D}}function ht(a,h,g,w){if(Ie){var D=Dt(w);if(D===null)Uy(a,h,w,xt,g),$i(a,w);else if(fa(D,a,h,g,w))w.stopPropagation();else if($i(a,w),h&4&&-1<kn.indexOf(a)){for(;D!==null;){var L=ln(D);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var q=Oe(L.pendingLanes);if(q!==0){var se=L;for(se.pendingLanes|=2,se.entangledLanes|=2;q;){var Ce=1<<31-Pe(q);se.entanglements[1]|=Ce,q&=~Ce}cl(L),(ui&6)===0&&(mp=ki()+500,qo(0))}}break;case 13:se=Ha(L,2),se!==null&&Ao(se,L,2),Bm(),ze(L,2)}if(L=Dt(w),L===null&&Uy(a,h,w,xt,g),L===D)break;D=L}D!==null&&w.stopPropagation()}else Uy(a,h,w,null,g)}}function Dt(a){return a=Wc(a),Ct(a)}var xt=null;function Ct(a){if(xt=null,a=yn(a),a!==null){var h=m(a);if(h===null)a=null;else{var g=h.tag;if(g===13){if(a=y(h),a!==null)return a;a=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;a=null}else h!==a&&(a=null)}}return xt=a,null}function Vt(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Aa()){case _a:return 2;case Gr:return 8;case Or:case Va:return 32;case Ca:return 268435456;default:return 32}default:return 32}}var At=!1,Tt=null,it=null,Yt=null,Jt=new Map,Gt=new Map,Lt=[],kn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $i(a,h){switch(a){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":it=null;break;case"mouseover":case"mouseout":Yt=null;break;case"pointerover":case"pointerout":Jt.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gt.delete(h.pointerId)}}function Wi(a,h,g,w,D,L){return a===null||a.nativeEvent!==L?(a={blockedOn:h,domEventName:g,eventSystemFlags:w,nativeEvent:L,targetContainers:[D]},h!==null&&(h=ln(h),h!==null&&xe(h)),a):(a.eventSystemFlags|=w,h=a.targetContainers,D!==null&&h.indexOf(D)===-1&&h.push(D),a)}function fa(a,h,g,w,D){switch(h){case"focusin":return Tt=Wi(Tt,a,h,g,w,D),!0;case"dragenter":return it=Wi(it,a,h,g,w,D),!0;case"mouseover":return Yt=Wi(Yt,a,h,g,w,D),!0;case"pointerover":var L=D.pointerId;return Jt.set(L,Wi(Jt.get(L)||null,a,h,g,w,D)),!0;case"gotpointercapture":return L=D.pointerId,Gt.set(L,Wi(Gt.get(L)||null,a,h,g,w,D)),!0}return!1}function Io(a){var h=yn(a.target);if(h!==null){var g=m(h);if(g!==null){if(h=g.tag,h===13){if(h=y(g),h!==null){a.blockedOn=h,wr(a.priority,function(){if(g.tag===13){var w=ai();w=cn(w);var D=Ha(g,w);D!==null&&Ao(D,g,w),ze(g,w)}});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){a.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pa(a){if(a.blockedOn!==null)return!1;for(var h=a.targetContainers;0<h.length;){var g=Dt(a.nativeEvent);if(g===null){g=a.nativeEvent;var w=new g.constructor(g.type,g);Zs=w,g.target.dispatchEvent(w),Zs=null}else return h=ln(g),h!==null&&xe(h),a.blockedOn=g,!1;h.shift()}return!0}function jr(a,h,g){pa(a)&&g.delete(h)}function Zi(){At=!1,Tt!==null&&pa(Tt)&&(Tt=null),it!==null&&pa(it)&&(it=null),Yt!==null&&pa(Yt)&&(Yt=null),Jt.forEach(jr),Gt.forEach(jr)}function cr(a,h){a.blockedOn===h&&(a.blockedOn=null,At||(At=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Zi)))}var vr=null;function Fr(a){vr!==a&&(vr=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){vr===a&&(vr=null);for(var h=0;h<a.length;h+=3){var g=a[h],w=a[h+1],D=a[h+2];if(typeof w!="function"){if(Ct(w||g)===null)continue;break}var L=ln(g);L!==null&&(a.splice(h,3),h-=3,ji(L,{pending:!0,data:D,method:g.method,action:w},w,D))}}))}function Br(a){function h(Ce){return cr(Ce,a)}Tt!==null&&cr(Tt,a),it!==null&&cr(it,a),Yt!==null&&cr(Yt,a),Jt.forEach(h),Gt.forEach(h);for(var g=0;g<Lt.length;g++){var w=Lt[g];w.blockedOn===a&&(w.blockedOn=null)}for(;0<Lt.length&&(g=Lt[0],g.blockedOn===null);)Io(g),g.blockedOn===null&&Lt.shift();if(g=(a.ownerDocument||a).$$reactFormReplay,g!=null)for(w=0;w<g.length;w+=3){var D=g[w],L=g[w+1],q=D[an]||null;if(typeof L=="function")q||Fr(g);else if(q){var se=null;if(L&&L.hasAttribute("formAction")){if(D=L,q=L[an]||null)se=q.formAction;else if(Ct(D)!==null)continue}else se=q.action;typeof se=="function"?g[w+1]=se:(g.splice(w,3),w-=3),Fr(g)}}}function ao(a){this._internalRoot=a}ur.prototype.render=ao.prototype.render=function(a){var h=this._internalRoot;if(h===null)throw Error(u(409));var g=h.current,w=ai();ce(g,w,a,h,null,null)},ur.prototype.unmount=ao.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var h=a.containerInfo;ce(a.current,2,null,a,null,null),Bm(),h[Pi]=null}};function ur(a){this._internalRoot=a}ur.prototype.unstable_scheduleHydration=function(a){if(a){var h=fr();a={blockedOn:null,target:a,priority:h};for(var g=0;g<Lt.length&&h!==0&&h<Lt[g].priority;g++);Lt.splice(g,0,a),g===0&&Io(a)}};var ja=e.version;if(ja!=="19.1.1")throw Error(u(527,ja,"19.1.1"));lt.findDOMNode=function(a){var h=a._reactInternals;if(h===void 0)throw typeof a.render=="function"?Error(u(188)):(a=Object.keys(a).join(","),Error(u(268,a)));return a=E(h),a=a!==null?C(a):null,a=a===null?null:a.stateNode,a};var Cr={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Be,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hr.isDisabled&&hr.supportsFiber)try{gn=hr.inject(Cr),ii=hr}catch{}}return e0.createRoot=function(a,h){if(!d(a))throw Error(u(299));var g=!1,w="",D=cy,L=y_,q=bm,se=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(D=h.onUncaughtError),h.onCaughtError!==void 0&&(L=h.onCaughtError),h.onRecoverableError!==void 0&&(q=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(se=h.unstable_transitionCallbacks)),h=Q(a,1,!1,null,null,g,w,D,L,q,se,null),a[Pi]=h.current,By(a),new ao(h)},e0.hydrateRoot=function(a,h,g){if(!d(a))throw Error(u(299));var w=!1,D="",L=cy,q=y_,se=bm,Ce=null,He=null;return g!=null&&(g.unstable_strictMode===!0&&(w=!0),g.identifierPrefix!==void 0&&(D=g.identifierPrefix),g.onUncaughtError!==void 0&&(L=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(se=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Ce=g.unstable_transitionCallbacks),g.formState!==void 0&&(He=g.formState)),h=Q(a,1,!0,h,g??null,w,D,L,q,se,Ce,He),h.context=ae(null),g=h.current,w=ai(),w=cn(w),D=Ll(w),D.callback=null,el(g,D,w),g=w,h.current.lanes=g,Fe(h,g),cl(h),a[Pi]=h.current,By(a),new ur(h)},e0.version="19.1.1",e0}var Hw;function NC(){if(Hw)return Kb.exports;Hw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Kb.exports=LC(),Kb.exports}var zC=NC();const jC=Hp(zC),FC="modulepreload",BC=function(n){return"https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-13T09:56/"+n},qw={},SS=function(e,r,u){let d=Promise.resolve();if(r&&r.length>0){let C=function(k){return Promise.all(k.map(N=>Promise.resolve(N).then(F=>({status:"fulfilled",value:F}),F=>({status:"rejected",reason:F}))))};var y=C;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),E=l?.nonce||l?.getAttribute("nonce");d=C(r.map(k=>{if(k=BC(k),k in qw)return;qw[k]=!0;const N=k.endsWith(".css"),F=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${k}"]${F}`))return;const B=document.createElement("link");if(B.rel=N?"stylesheet":FC,N||(B.as="script"),B.crossOrigin="",B.href=k,E&&B.setAttribute("nonce",E),document.head.appendChild(B),N)return new Promise((W,re)=>{B.addEventListener("load",W),B.addEventListener("error",()=>re(new Error(`Unable to preload CSS for ${k}`)))})}))}function m(l){const E=new Event("vite:preloadError",{cancelable:!0});if(E.payload=l,window.dispatchEvent(E),!E.defaultPrevented)throw l}return d.then(l=>{for(const E of l||[])E.status==="rejected"&&m(E.reason);return e().catch(m)})},UC=K.createContext(null);function VC(n,e){const r=Array.isArray(n)?n[0]:n?n.x:0,u=Array.isArray(n)?n[1]:n?n.y:0,d=Array.isArray(e)?e[0]:e?e.x:0,m=Array.isArray(e)?e[1]:e?e.y:0;return r===d&&u===m}function ks(n,e){if(n===e)return!0;if(!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!ks(n[r],e[r]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const r=Object.keys(n),u=Object.keys(e);if(r.length!==u.length)return!1;for(const d of r)if(!e.hasOwnProperty(d)||!ks(n[d],e[d]))return!1;return!0}return!1}function Xw(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function Ww(n,e){const r=e.viewState||e,u={};if("longitude"in r&&"latitude"in r&&(r.longitude!==n.center.lng||r.latitude!==n.center.lat)){const d=n.center.constructor;u.center=new d(r.longitude,r.latitude)}return"zoom"in r&&r.zoom!==n.zoom&&(u.zoom=r.zoom),"bearing"in r&&r.bearing!==n.bearing&&(u.bearing=r.bearing),"pitch"in r&&r.pitch!==n.pitch&&(u.pitch=r.pitch),r.padding&&n.padding&&!ks(r.padding,n.padding)&&(u.padding=r.padding),u}const GC=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Qw(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const e={};for(const u of n.layers)e[u.id]=u;const r=n.layers.map(u=>{let d=null;"interactive"in u&&(d=Object.assign({},u),delete d.interactive);const m=e[u.ref];if(m){d=d||Object.assign({},u),delete d.ref;for(const y of GC)y in m&&(d[y]=m[y])}return d||u});return{...n,layers:r}}const Kw={version:8,sources:{},layers:[]},Jw={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},e2={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},t2={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},$C=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],ZC=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Mg{constructor(e,r,u){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=d=>{const m=this.props[t2[d.type]];m?m(d):d.type==="error"&&console.error(d.error)},this._onCameraEvent=d=>{if(this._internalUpdate)return;d.viewState=this._propsedCameraUpdate||Xw(this._map.transform);const m=this.props[e2[d.type]];m&&m(d)},this._onCameraUpdate=d=>this._internalUpdate?d:(this._propsedCameraUpdate=Xw(d),Ww(d,this.props)),this._onPointerEvent=d=>{(d.type==="mousemove"||d.type==="mouseout")&&this._updateHover(d);const m=this.props[Jw[d.type]];m&&(this.props.interactiveLayerIds&&d.type!=="mouseover"&&d.type!=="mouseout"&&(d.features=this._hoveredFeatures||this._queryRenderedFeatures(d.point)),m(d),delete d.features)},this._MapClass=e,this.props=r,this._initialize(u)}get map(){return this._map}setProps(e){const r=this.props;this.props=e;const u=this._updateSettings(e,r),d=this._updateSize(e),m=this._updateViewState(e);this._updateStyle(e,r),this._updateStyleComponents(e),this._updateHandlers(e,r),(u||d||m&&!this._map.isMoving())&&this.redraw()}static reuse(e,r){const u=Mg.savedMaps.pop();if(!u)return null;const d=u.map,m=d.getContainer();for(r.className=m.className;m.childNodes.length>0;)r.appendChild(m.childNodes[0]);d._container=r;const y=d._resizeObserver;y&&(y.disconnect(),y.observe(r)),u.setProps({...e,styleDiffing:!1}),d.resize();const{initialViewState:l}=e;return l&&(l.bounds?d.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):u._updateViewState(l)),d.isStyleLoaded()?d.fire("load"):d.once("style.load",()=>d.fire("load")),d._update(),u}_initialize(e){const{props:r}=this,{mapStyle:u=Kw}=r,d={...r,...r.initialViewState,container:e,style:Qw(u)},m=d.initialViewState||d.viewState||d;if(Object.assign(d,{center:[m.longitude||0,m.latitude||0],zoom:m.zoom||0,pitch:m.pitch||0,bearing:m.bearing||0}),r.gl){const l=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=l,r.gl)}const y=new this._MapClass(d);m.padding&&y.setPadding(m.padding),r.cursor&&(y.getCanvas().style.cursor=r.cursor),y.transformCameraUpdate=this._onCameraUpdate,y.on("style.load",()=>{this._styleComponents={light:y.getLight(),sky:y.getSky(),projection:y.getProjection?.(),terrain:y.getTerrain()},this._updateStyleComponents(this.props)}),y.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const l in Jw)y.on(l,this._onPointerEvent);for(const l in e2)y.on(l,this._onCameraEvent);for(const l in t2)y.on(l,this._onEvent);this._map=y}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),Mg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){const{viewState:r}=e;if(r){const u=this._map;if(r.width!==u.transform.width||r.height!==u.transform.height)return u.resize(),!0}return!1}_updateViewState(e){const r=this._map,u=r.transform;if(!r.isMoving()){const m=Ww(u,e);if(Object.keys(m).length>0)return this._internalUpdate=!0,r.jumpTo(m),this._internalUpdate=!1,!0}return!1}_updateSettings(e,r){const u=this._map;let d=!1;for(const m of $C)m in e&&!ks(e[m],r[m])&&(d=!0,u[`set${m[0].toUpperCase()}${m.slice(1)}`]?.call(u,e[m]));return d}_updateStyle(e,r){if(e.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==r.mapStyle){const{mapStyle:u=Kw,styleDiffing:d=!0}=e,m={diff:d};"localIdeographFontFamily"in e&&(m.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Qw(u),m)}}_updateStyleComponents({light:e,projection:r,sky:u,terrain:d}){const m=this._map,y=this._styleComponents;m.style._loaded&&(e&&!ks(e,y.light)&&(y.light=e,m.setLight(e)),r&&!ks(r,y.projection)&&r!==y.projection?.type&&(y.projection=typeof r=="string"?{type:r}:r,m.setProjection?.(y.projection)),u&&!ks(u,y.sky)&&(y.sky=u,m.setSky(u)),d!==void 0&&!ks(d,y.terrain)&&(!d||m.getSource(d.source))&&(y.terrain=d,m.setTerrain(d)))}_updateHandlers(e,r){const u=this._map;for(const d of ZC){const m=e[d]??!0,y=r[d]??!0;ks(m,y)||(m?u[d].enable(m):u[d].disable())}}_queryRenderedFeatures(e){const r=this._map,{interactiveLayerIds:u=[]}=this.props;try{return r.queryRenderedFeatures(e,{layers:u.filter(r.getLayer.bind(r))})}catch{return[]}}_updateHover(e){const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const d=e.type,m=this._hoveredFeatures?.length>0,y=this._queryRenderedFeatures(e.point),l=y.length>0;!l&&m&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=y,l&&!m&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=d}else this._hoveredFeatures=null}}Mg.savedMaps=[];const YC=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function HC(n){if(!n)return null;const e=n.map,r={getMap:()=>e};for(const u of qC(e))!(u in r)&&!YC.includes(u)&&(r[u]=e[u].bind(e));return r}function qC(n){const e=new Set;let r=n;for(;r;){for(const u of Object.getOwnPropertyNames(r))u[0]!=="_"&&typeof n[u]=="function"&&u!=="fire"&&u!=="setEventedParent"&&e.add(u);r=Object.getPrototypeOf(r)}return Array.from(e)}const XC=typeof document<"u"?K.useLayoutEffect:K.useEffect;function WC(n,e){const{RTLTextPlugin:r,maxParallelImageRequests:u,workerCount:d,workerUrl:m}=e;if(r&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:y,lazy:l=!0}=typeof r=="string"?{pluginUrl:r}:r;n.setRTLTextPlugin(y,E=>{E&&console.error(E)},l)}u!==void 0&&n.setMaxParallelImageRequests(u),d!==void 0&&n.setWorkerCount(d),m!==void 0&&n.setWorkerUrl(m)}const Vg=K.createContext(null);function QC(n,e){const r=K.useContext(UC),[u,d]=K.useState(null),m=K.useRef(),{current:y}=K.useRef({mapLib:null,map:null});K.useEffect(()=>{const C=n.mapLib;let k=!0,N;return Promise.resolve(C||SS(()=>Promise.resolve().then(()=>IS),void 0)).then(F=>{if(!k)return;if(!F)throw new Error("Invalid mapLib");const B="Map"in F?F:F.default;if(!B.Map)throw new Error("Invalid mapLib");WC(B,n),n.reuseMaps&&(N=Mg.reuse(n,m.current)),N||(N=new Mg(B.Map,n,m.current)),y.map=HC(N),y.mapLib=B,d(N),r?.onMapMount(y.map,n.id)}).catch(F=>{const{onError:B}=n;B?B({type:"error",target:null,originalEvent:null,error:F}):console.error(F)}),()=>{k=!1,N&&(r?.onMapUnmount(n.id),n.reuseMaps?N.recycle():N.destroy())}},[]),XC(()=>{u&&u.setProps(n)}),K.useImperativeHandle(e,()=>y.map,[u]);const l=K.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),E={height:"100%"};return K.createElement("div",{id:n.id,ref:m,style:l},u&&K.createElement(Vg.Provider,{value:y},K.createElement("div",{"mapboxgl-children":"",style:E},n.children)))}const KC=K.forwardRef(QC);var nb=TS();const Ip=Hp(nb),JC=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Td(n,e){if(!n||!e)return;const r=n.style;for(const u in e){const d=e[u];Number.isFinite(d)&&!JC.test(u)?r[u]=`${d}px`:r[u]=d}}function ES(n,e){if(n===e)return null;const r=n2(n),u=n2(e),d=[];for(const m of u)r.has(m)||d.push(m);for(const m of r)u.has(m)||d.push(m);return d.length===0?null:d}function n2(n){return new Set(n?n.trim().split(/\s+/):[])}const i2=K.memo(K.forwardRef((n,e)=>{const{map:r,mapLib:u}=K.useContext(Vg),d=K.useRef({props:n}),m=K.useMemo(()=>{let de=!1;K.Children.forEach(n.children,ke=>{ke&&(de=!0)});const Ee={...n,element:de?document.createElement("div"):void 0},we=new u.Marker(Ee);return we.setLngLat([n.longitude,n.latitude]),we.getElement().addEventListener("click",ke=>{d.current.props.onClick?.({type:"click",target:we,originalEvent:ke})}),we.on("dragstart",ke=>{const ge=ke;ge.lngLat=m.getLngLat(),d.current.props.onDragStart?.(ge)}),we.on("drag",ke=>{const ge=ke;ge.lngLat=m.getLngLat(),d.current.props.onDrag?.(ge)}),we.on("dragend",ke=>{const ge=ke;ge.lngLat=m.getLngLat(),d.current.props.onDragEnd?.(ge)}),we},[]);K.useEffect(()=>(m.addTo(r.getMap()),()=>{m.remove()}),[]);const{longitude:y,latitude:l,offset:E,style:C,draggable:k=!1,popup:N=null,rotation:F=0,rotationAlignment:B="auto",pitchAlignment:W="auto"}=n;K.useEffect(()=>{Td(m.getElement(),C)},[C]),K.useImperativeHandle(e,()=>m,[]);const re=d.current.props;(m.getLngLat().lng!==y||m.getLngLat().lat!==l)&&m.setLngLat([y,l]),E&&!VC(m.getOffset(),E)&&m.setOffset(E),m.isDraggable()!==k&&m.setDraggable(k),m.getRotation()!==F&&m.setRotation(F),m.getRotationAlignment()!==B&&m.setRotationAlignment(B),m.getPitchAlignment()!==W&&m.setPitchAlignment(W),m.getPopup()!==N&&m.setPopup(N);const ie=ES(re.className,n.className);if(ie)for(const de of ie)m.toggleClassName(de);return d.current.props=n,nb.createPortal(n.children,m.getElement())})),MS=K.memo(K.forwardRef((n,e)=>{const{map:r,mapLib:u}=K.useContext(Vg),d=K.useMemo(()=>document.createElement("div"),[]),m=K.useRef({props:n}),y=K.useMemo(()=>{const l={...n},E=new u.Popup(l);return E.setLngLat([n.longitude,n.latitude]),E.once("open",C=>{m.current.props.onOpen?.(C)}),E},[]);if(K.useEffect(()=>{const l=E=>{m.current.props.onClose?.(E)};return y.on("close",l),y.setDOMContent(d).addTo(r.getMap()),()=>{y.off("close",l),y.isOpen()&&y.remove()}},[]),K.useEffect(()=>{Td(y.getElement(),n.style)},[n.style]),K.useImperativeHandle(e,()=>y,[]),y.isOpen()){const l=m.current.props;(y.getLngLat().lng!==n.longitude||y.getLngLat().lat!==n.latitude)&&y.setLngLat([n.longitude,n.latitude]),n.offset&&!ks(l.offset,n.offset)&&y.setOffset(n.offset),(l.anchor!==n.anchor||l.maxWidth!==n.maxWidth)&&(y.options.anchor=n.anchor,y.setMaxWidth(n.maxWidth));const E=ES(l.className,n.className);if(E)for(const C of E)y.toggleClassName(C);m.current.props=n}return nb.createPortal(n.children,d)}));function qp(n,e,r,u){const d=K.useContext(Vg),m=K.useMemo(()=>n(d),[]);return K.useEffect(()=>{const y=e,l=null,E=typeof e=="function"?e:null,{map:C}=d;return C.hasControl(m)||(C.addControl(m,y?.position),l&&l(d)),()=>{E&&E(d),C.hasControl(m)&&C.removeControl(m)}},[]),m}function eD(n){const e=qp(({mapLib:r})=>new r.AttributionControl(n),{position:n.position});return K.useEffect(()=>{Td(e._container,n.style)},[n.style]),null}K.memo(eD);function tD(n){const e=qp(({mapLib:r})=>new r.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return K.useEffect(()=>{Td(e._controlContainer,n.style)},[n.style]),null}K.memo(tD);function nD(n,e){const r=K.useRef({props:n}),u=qp(({mapLib:d})=>{const m=new d.GeolocateControl(n),y=m._setupUI;return m._setupUI=()=>{m._container.hasChildNodes()||y()},m.on("geolocate",l=>{r.current.props.onGeolocate?.(l)}),m.on("error",l=>{r.current.props.onError?.(l)}),m.on("outofmaxbounds",l=>{r.current.props.onOutOfMaxBounds?.(l)}),m.on("trackuserlocationstart",l=>{r.current.props.onTrackUserLocationStart?.(l)}),m.on("trackuserlocationend",l=>{r.current.props.onTrackUserLocationEnd?.(l)}),m},{position:n.position});return r.current.props=n,K.useImperativeHandle(e,()=>u,[]),K.useEffect(()=>{Td(u._container,n.style)},[n.style]),null}K.memo(K.forwardRef(nD));function iD(n){const e=qp(({mapLib:r})=>new r.NavigationControl(n),{position:n.position});return K.useEffect(()=>{Td(e._container,n.style)},[n.style]),null}const rD=K.memo(iD);function aD(n){const e=qp(({mapLib:m})=>new m.ScaleControl(n),{position:n.position}),r=K.useRef(n),u=r.current;r.current=n;const{style:d}=n;return n.maxWidth!==void 0&&n.maxWidth!==u.maxWidth&&(e.options.maxWidth=n.maxWidth),n.unit!==void 0&&n.unit!==u.unit&&e.setUnit(n.unit),K.useEffect(()=>{Td(e._container,d)},[d]),null}K.memo(aD);function oD(n){const e=qp(({mapLib:r})=>new r.TerrainControl(n),{position:n.position});return K.useEffect(()=>{Td(e._container,n.style)},[n.style]),null}K.memo(oD);function sD(n){const e=qp(({mapLib:r})=>new r.LogoControl(n),{position:n.position});return K.useEffect(()=>{Td(e._container,n.style)},[n.style]),null}K.memo(sD);function Iv(n,e){if(!n)throw new Error(e)}let lD=0;function cD(n,e,r){if(n.style&&n.style._loaded){const u={...r};return delete u.id,delete u.children,n.addSource(e,u),n.getSource(e)}return null}function uD(n,e,r){Iv(e.id===r.id,"source id changed"),Iv(e.type===r.type,"source type changed");let u="",d=0;for(const y in e)y!=="children"&&y!=="id"&&!ks(r[y],e[y])&&(u=y,d++);if(!d)return;const m=e.type;if(m==="geojson")n.setData(e.data);else if(m==="image")n.updateImage({url:e.url,coordinates:e.coordinates});else switch(u){case"coordinates":n.setCoordinates?.(e.coordinates);break;case"url":n.setUrl?.(e.url);break;case"tiles":n.setTiles?.(e.tiles);break;default:console.warn(`Unable to update <Source> prop: ${u}`)}}function hD(n){const e=K.useContext(Vg).map.getMap(),r=K.useRef(n),[,u]=K.useState(0),d=K.useMemo(()=>n.id||`jsx-source-${lD++}`,[]);K.useEffect(()=>{if(e){const y=()=>setTimeout(()=>u(l=>l+1),0);return e.on("styledata",y),y(),()=>{if(e.off("styledata",y),e.style&&e.style._loaded&&e.getSource(d)){const l=e.getStyle()?.layers;if(l)for(const E of l)E.source===d&&e.removeLayer(E.id);e.removeSource(d)}}}},[e]);let m=e&&e.style&&e.getSource(d);return m?uD(m,n,r.current):m=cD(e,d,n),r.current=n,m&&K.Children.map(n.children,y=>y&&K.cloneElement(y,{source:d}))||null}function dD(n,e,r,u){if(Iv(r.id===u.id,"layer id changed"),Iv(r.type===u.type,"layer type changed"),r.type==="custom"||u.type==="custom")return;const{layout:d={},paint:m={},filter:y,minzoom:l,maxzoom:E,beforeId:C}=r;if(C!==u.beforeId&&n.moveLayer(e,C),d!==u.layout){const k=u.layout||{};for(const N in d)ks(d[N],k[N])||n.setLayoutProperty(e,N,d[N]);for(const N in k)d.hasOwnProperty(N)||n.setLayoutProperty(e,N,void 0)}if(m!==u.paint){const k=u.paint||{};for(const N in m)ks(m[N],k[N])||n.setPaintProperty(e,N,m[N]);for(const N in k)m.hasOwnProperty(N)||n.setPaintProperty(e,N,void 0)}ks(y,u.filter)||n.setFilter(e,y),(l!==u.minzoom||E!==u.maxzoom)&&n.setLayerZoomRange(e,l,E)}function fD(n,e,r){if(n.style&&n.style._loaded&&(!("source"in r)||n.getSource(r.source))){const u={...r,id:e};delete u.beforeId,n.addLayer(u,r.beforeId)}}let pD=0;function r2(n){const e=K.useContext(Vg).map.getMap(),r=K.useRef(n),[,u]=K.useState(0),d=K.useMemo(()=>n.id||`jsx-layer-${pD++}`,[]);if(K.useEffect(()=>{if(e){const y=()=>u(l=>l+1);return e.on("styledata",y),y(),()=>{e.off("styledata",y),e.style&&e.style._loaded&&e.getLayer(d)&&e.removeLayer(d)}}},[e]),e&&e.style&&e.getLayer(d))try{dD(e,d,n,r.current)}catch(y){console.warn(y)}else fD(e,d,n);return r.current=n,null}var vv={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.2/LICENSE.txt
 */var mD=vv.exports,a2;function gD(){return a2||(a2=1,function(n,e){(function(r,u){n.exports=u()})(mD,function(){var r={},u={};function d(y,l,E){if(u[y]=E,y==="index"){var C="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",k={};return u.shared(k),u.index(r,k),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([C],{type:"text/javascript"}))),r}}d("shared",["exports"],function(y){function l(s,i,o,f){return new(o||(o=Promise))(function(_,x){function S(O){try{I(f.next(O))}catch(z){x(z)}}function A(O){try{I(f.throw(O))}catch(z){x(z)}}function I(O){var z;O.done?_(O.value):(z=O.value,z instanceof o?z:new o(function(V){V(z)})).then(S,A)}I((f=f.apply(s,i||[])).next())})}function E(s,i){this.x=s,this.y=i}function C(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var k,N;typeof SuppressedError=="function"&&SuppressedError,E.prototype={clone(){return new E(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,i){return this.clone()._rotateAround(s,i)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const i=s.x-this.x,o=s.y-this.y;return i*i+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult(s){const i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const i=Math.cos(s),o=Math.sin(s),f=o*this.x+i*this.y;return this.x=i*this.x-o*this.y,this.y=f,this},_rotateAround(s,i){const o=Math.cos(s),f=Math.sin(s),_=i.y+f*(this.x-i.x)+o*(this.y-i.y);return this.x=i.x+o*(this.x-i.x)-f*(this.y-i.y),this.y=_,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:E},E.convert=function(s){if(s instanceof E)return s;if(Array.isArray(s))return new E(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new E(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};var F=function(){if(N)return k;function s(i,o,f,_){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(_-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=_}return N=1,k=s,s.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,_=0;_<8;_++){var x=this.sampleCurveX(f)-i;if(Math.abs(x)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=x/S}var A=0,I=1;for(f=i,_=0;_<20&&(x=this.sampleCurveX(f),!(Math.abs(x-i)<o));_++)i>x?A=f:I=f,f=.5*(I-A)+A;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},k}(),B=C(F);let W,re;function ie(){return W==null&&(W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),W}function de(){if(re==null&&(re=!1,ie())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let f=0;f<5*5;f++){const _=4*f;i.fillStyle=`rgb(${_},${_+1},${_+2})`,i.fillRect(f%5,Math.floor(f/5),1,1)}const o=i.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&o[f]!==f){re=!0;break}}}return re||!1}var Ee=1e-6,we=typeof Float32Array<"u"?Float32Array:Array;function ke(){var s=new we(9);return we!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function ge(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ae(){var s=new we(3);return we!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Ge(s){var i=s[0],o=s[1],f=s[2];return Math.sqrt(i*i+o*o+f*f)}function at(s,i,o){var f=new we(3);return f[0]=s,f[1]=i,f[2]=o,f}function Me(s,i,o){return s[0]=i[0]+o[0],s[1]=i[1]+o[1],s[2]=i[2]+o[2],s}function Qe(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s}function St(s,i,o){var f=i[0],_=i[1],x=i[2],S=o[0],A=o[1],I=o[2];return s[0]=_*I-x*A,s[1]=x*S-f*I,s[2]=f*A-_*S,s}var bt,zt=Ge;function Zt(s,i,o){var f=i[0],_=i[1],x=i[2],S=i[3];return s[0]=o[0]*f+o[4]*_+o[8]*x+o[12]*S,s[1]=o[1]*f+o[5]*_+o[9]*x+o[13]*S,s[2]=o[2]*f+o[6]*_+o[10]*x+o[14]*S,s[3]=o[3]*f+o[7]*_+o[11]*x+o[15]*S,s}function Ft(){var s=new we(4);return we!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Be(s,i,o,f){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;i*=x,f*=x,o*=x;var S=Math.sin(i),A=Math.cos(i),I=Math.sin(o),O=Math.cos(o),z=Math.sin(f),V=Math.cos(f);switch(_){case"xyz":s[0]=S*O*V+A*I*z,s[1]=A*I*V-S*O*z,s[2]=A*O*z+S*I*V,s[3]=A*O*V-S*I*z;break;case"xzy":s[0]=S*O*V-A*I*z,s[1]=A*I*V-S*O*z,s[2]=A*O*z+S*I*V,s[3]=A*O*V+S*I*z;break;case"yxz":s[0]=S*O*V+A*I*z,s[1]=A*I*V-S*O*z,s[2]=A*O*z-S*I*V,s[3]=A*O*V+S*I*z;break;case"yzx":s[0]=S*O*V+A*I*z,s[1]=A*I*V+S*O*z,s[2]=A*O*z-S*I*V,s[3]=A*O*V-S*I*z;break;case"zxy":s[0]=S*O*V-A*I*z,s[1]=A*I*V+S*O*z,s[2]=A*O*z+S*I*V,s[3]=A*O*V-S*I*z;break;case"zyx":s[0]=S*O*V-A*I*z,s[1]=A*I*V+S*O*z,s[2]=A*O*z-S*I*V,s[3]=A*O*V+S*I*z;break;default:throw new Error("Unknown angle order "+_)}return s}function lt(){var s=new we(2);return we!=Float32Array&&(s[0]=0,s[1]=0),s}function _t(s,i){var o=new we(2);return o[0]=s,o[1]=i,o}Ae(),bt=new we(4),we!=Float32Array&&(bt[0]=0,bt[1]=0,bt[2]=0,bt[3]=0),Ae(),at(1,0,0),at(0,1,0),Ft(),Ft(),ke(),lt();const ut=8192;function Te(s,i,o){return i*(ut/(s.tileSize*Math.pow(2,o-s.tileID.overscaledZ)))}function nt(s,i){return(s%i+i)%i}function yt(s,i,o){return s*(1-o)+i*o}function pt(s){if(s<=0)return 0;if(s>=1)return 1;const i=s*s,o=i*s;return 4*(s<.5?o:3*(s-i)+o-.75)}function Et(s,i,o,f){const _=new B(s,i,o,f);return x=>_.solve(x)}const Ut=Et(.25,.1,.25,1);function Ot(s,i,o){return Math.min(o,Math.max(i,s))}function Ln(s,i,o){const f=o-i,_=((s-i)%f+f)%f+i;return _===i?o:_}function Wt(s,...i){for(const o of i)for(const f in o)s[f]=o[f];return s}let Xn=1;function br(s,i,o){const f={};for(const _ in s)f[_]=i.call(this,s[_],_,s);return f}function ir(s,i,o){const f={};for(const _ in s)i.call(this,s[_],_,s)&&(f[_]=s[_]);return f}function yi(s){return Array.isArray(s)?s.map(yi):typeof s=="object"&&s?br(s,yi):s}const Un={};function Vn(s){Un[s]||(typeof console<"u"&&console.warn(s),Un[s]=!0)}function Dn(s,i,o){return(o.y-s.y)*(i.x-s.x)>(i.y-s.y)*(o.x-s.x)}function Pr(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let ki=null;function Aa(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const _a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Gr(s,i,o,f,_){return l(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(s,{timestamp:0});try{const S=x?.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const A=S.startsWith("BGR"),I=new Uint8ClampedArray(f*_*4);if(yield x.copyTo(I,function(O,z,V,Z,X){const Q=4*Math.max(-z,0),ae=(Math.max(0,V)-V)*Z*4+Q,ce=4*Z,me=Math.max(0,z),ze=Math.max(0,V);return{rect:{x:me,y:ze,width:Math.min(O.width,z+Z)-me,height:Math.min(O.height,V+X)-ze},layout:[{offset:ae,stride:ce}]}}(s,i,o,f,_)),A)for(let O=0;O<I.length;O+=4){const z=I[O];I[O]=I[O+2],I[O+2]=z}return I}finally{x.close()}})}let Or,Va;function Ca(s,i,o,f){return s.addEventListener(i,o,f),{unsubscribe:()=>{s.removeEventListener(i,o,f)}}}function Da(s){return s*Math.PI/180}function Ga(s){return s/Math.PI*180}const gn={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ii={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},xr="AbortError";function Pe(){return new Error(xr)}const te={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ne(s){return te.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const le="global-dispatcher";class be extends Error{constructor(i,o,f,_){super(`AJAXError: ${o} (${i}): ${f}`),this.status=i,this.statusText=o,this.url=f,this.body=_}}const De=()=>Pr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Oe=function(s,i){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const f=ne(s.url);if(f)return f(s,i);if(Pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:le},i)}if(!(/^file:/.test(o=s.url)||/^file:/.test(De())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,_){return l(this,void 0,void 0,function*(){const x=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:De(),signal:_.signal});let S,A;f.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{S=yield fetch(x)}catch(O){throw new be(0,O.message,f.url,new Blob)}if(!S.ok){const O=yield S.blob();throw new be(S.status,S.statusText,f.url,O)}A=f.type==="arrayBuffer"||f.type==="image"?S.arrayBuffer():f.type==="json"?S.json():S.text();const I=yield A;if(_.signal.aborted)throw Pe();return{data:I,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(s,i);if(Pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:le},i)}var o;return function(f,_){return new Promise((x,S)=>{var A;const I=new XMLHttpRequest;I.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(I.responseType="arraybuffer");for(const O in f.headers)I.setRequestHeader(O,f.headers[O]);f.type==="json"&&(I.responseType="text",!((A=f.headers)===null||A===void 0)&&A.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=f.credentials==="include",I.onerror=()=>{S(new Error(I.statusText))},I.onload=()=>{if(!_.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let O=I.response;if(f.type==="json")try{O=JSON.parse(I.response)}catch(z){return void S(z)}x({data:O,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const O=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});S(new be(I.status,I.statusText,f.url,O))}},_.signal.addEventListener("abort",()=>{I.abort(),S(Pe())}),I.send(f.body)})}(s,i)};function Ye(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const i=new URL(s),o=window.location;return i.protocol===o.protocol&&i.host===o.host}function je(s,i,o){o[s]&&o[s].indexOf(i)!==-1||(o[s]=o[s]||[],o[s].push(i))}function tt(s,i,o){if(o&&o[s]){const f=o[s].indexOf(i);f!==-1&&o[s].splice(f,1)}}class mt{constructor(i,o={}){Wt(this,o),this.type=i}}class ot extends mt{constructor(i,o={}){super("error",Wt({error:i},o))}}class jt{on(i,o){return this._listeners=this._listeners||{},je(i,o,this._listeners),{unsubscribe:()=>{this.off(i,o)}}}off(i,o){return tt(i,o,this._listeners),tt(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},je(i,o,this._oneTimeListeners),this):new Promise(f=>this.once(i,f))}fire(i,o){typeof i=="string"&&(i=new mt(i,o||{}));const f=i.type;if(this.listens(f)){i.target=this;const _=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const A of _)A.call(this,i);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const A of x)tt(f,A,this._oneTimeListeners),A.call(this,i);const S=this._eventedParent;S&&(Wt(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(i))}else i instanceof ot&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var Fe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const rn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Sn(s,i){const o={};for(const f in s)f!=="ref"&&(o[f]=s[f]);return rn.forEach(f=>{f in i&&(o[f]=i[f])}),o}function $t(s,i){if(Array.isArray(s)){if(!Array.isArray(i)||s.length!==i.length)return!1;for(let o=0;o<s.length;o++)if(!$t(s[o],i[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&i!==null){if(typeof i!="object"||Object.keys(s).length!==Object.keys(i).length)return!1;for(const o in s)if(!$t(s[o],i[o]))return!1;return!0}return s===i}function cn(s,i){s.push(i)}function ci(s,i,o){cn(o,{command:"addSource",args:[s,i[s]]})}function fr(s,i,o){cn(i,{command:"removeSource",args:[s]}),o[s]=!0}function wr(s,i,o,f){fr(s,o,f),ci(s,i,o)}function di(s,i,o){let f;for(f in s[o])if(Object.prototype.hasOwnProperty.call(s[o],f)&&f!=="data"&&!$t(s[o][f],i[o][f]))return!1;for(f in i[o])if(Object.prototype.hasOwnProperty.call(i[o],f)&&f!=="data"&&!$t(s[o][f],i[o][f]))return!1;return!0}function Kt(s,i,o,f,_,x){s=s||{},i=i||{};for(const S in s)Object.prototype.hasOwnProperty.call(s,S)&&($t(s[S],i[S])||o.push({command:x,args:[f,S,i[S],_]}));for(const S in i)Object.prototype.hasOwnProperty.call(i,S)&&!Object.prototype.hasOwnProperty.call(s,S)&&($t(s[S],i[S])||o.push({command:x,args:[f,S,i[S],_]}))}function an(s){return s.id}function Pi(s,i){return s[i.id]=i,s}class wt{constructor(i,o,f,_){this.message=(i?`${i}: `:"")+f,_&&(this.identifier=_),o!=null&&o.__line__&&(this.line=o.__line__)}}function Jr(s,...i){for(const o of i)for(const f in o)s[f]=o[f];return s}class Yi extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class Vs{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[f,_]of o)this.bindings[f]=_}concat(i){return new Vs(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ps={kind:"null"},It={kind:"number"},yn={kind:"string"},ln={kind:"boolean"},rr={kind:"color"},fo={kind:"projectionDefinition"},Oi={kind:"object"},_n={kind:"value"},rh={kind:"collator"},Ia={kind:"formatted"},Gs={kind:"padding"},ms={kind:"colorArray"},Kl={kind:"numberArray"},Hi={kind:"resolvedImage"},Cd={kind:"variableAnchorOffsetCollection"};function $r(s,i){return{kind:"array",itemType:s,N:i}}function ei(s){if(s.kind==="array"){const i=ei(s.itemType);return typeof s.N=="number"?`array<${i}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${i}>`}return s.kind}const gs=[ps,It,yn,ln,rr,fo,Ia,Oi,$r(_n),Gs,Kl,ms,Hi,Cd];function Jl(s,i){if(i.kind==="error")return null;if(s.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Jl(s.itemType,i.itemType))&&(typeof s.N!="number"||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if(s.kind==="value"){for(const o of gs)if(!Jl(o,i))return null}}return`Expected ${ei(s)} but found ${ei(i)} instead.`}function Dd(s,i){return i.some(o=>o.kind===s.kind)}function $a(s,i){return i.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function ys(s,i){return s.kind==="array"&&i.kind==="array"?s.itemType.kind===i.itemType.kind&&typeof s.N=="number":s.kind===i.kind}const ah=.96422,em=.82521,Bf=4/29,Zr=6/29,Uf=3*Zr*Zr,iy=Zr*Zr*Zr,Id=Math.PI/180,tm=180/Math.PI;function qc(s){return(s%=360)<0&&(s+=360),s}function Xc([s,i,o,f]){let _,x;const S=oh((.2225045*(s=Ra(s))+.7168786*(i=Ra(i))+.0606169*(o=Ra(o)))/1);s===i&&i===o?_=x=S:(_=oh((.4360747*s+.3850649*i+.1430804*o)/ah),x=oh((.0139322*s+.0971045*i+.7141733*o)/em));const A=116*S-16;return[A<0?0:A,500*(_-S),200*(S-x),f]}function Ra(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function oh(s){return s>iy?Math.pow(s,1/3):s/Uf+Bf}function ec([s,i,o,f]){let _=(s+16)/116,x=isNaN(i)?_:_+i/500,S=isNaN(o)?_:_-o/200;return _=1*bl(_),x=ah*bl(x),S=em*bl(S),[sh(3.1338561*x-1.6168667*_-.4906146*S),sh(-.9787684*x+1.9161415*_+.033454*S),sh(.0719453*x-.2289914*_+1.4052427*S),f]}function sh(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function bl(s){return s>Zr?s*s*s:Uf*(s-Bf)}const nm=Object.hasOwn||function(s,i){return Object.prototype.hasOwnProperty.call(s,i)};function tc(s,i){return nm(s,i)?s[i]:void 0}function _s(s){return parseInt(s.padEnd(2,s),16)/255}function No(s,i){return En(i?s/100:s,0,1)}function En(s,i,o){return Math.min(Math.max(i,s),o)}function xl(s){return!s.some(Number.isNaN)}const vs={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function $s(s,i,o){return s+o*(i-s)}function nc(s,i,o){return s.map((f,_)=>$s(f,i[_],o))}class xn{constructor(i,o,f,_=1,x=!0){this.r=i,this.g=o,this.b=f,this.a=_,x||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[i,o,f,_]))}static parse(i){if(i instanceof xn)return i;if(typeof i!="string")return;const o=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=tc(vs,f);if(_){const[S,A,I]=_;return[S/255,A/255,I/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const S=f.length<6?1:2;let A=1;return[_s(f.slice(A,A+=S)),_s(f.slice(A,A+=S)),_s(f.slice(A,A+=S)),_s(f.slice(A,A+S)||"ff")]}if(f.startsWith("rgb")){const S=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[A,I,O,z,V,Z,X,Q,ae,ce,me,ze]=S,xe=[z||" ",X||" ",ce].join("");if(xe==="  "||xe==="  /"||xe===",,"||xe===",,,"){const Ie=[O,Z,ae].join(""),Ze=Ie==="%%%"?100:Ie===""?255:0;if(Ze){const Je=[En(+I/Ze,0,1),En(+V/Ze,0,1),En(+Q/Ze,0,1),me?No(+me,ze):1];if(xl(Je))return Je}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[S,A,I,O,z,V,Z,X,Q]=x,ae=[I||" ",z||" ",Z].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const ce=[+A,En(+O,0,100),En(+V,0,100),X?No(+X,Q):1];if(xl(ce))return function([me,ze,xe,Ie]){function Ze(Je){const ht=(Je+me/30)%12,Dt=ze*Math.min(xe,1-xe);return xe-Dt*Math.max(-1,Math.min(ht-3,9-ht,1))}return me=qc(me),ze/=100,xe/=100,[Ze(0),Ze(8),Ze(4),Ie]}(ce)}}}(i);return o?new xn(...o,!1):void 0}get rgb(){const{r:i,g:o,b:f,a:_}=this,x=_||1/0;return this.overwriteGetter("rgb",[i/x,o/x,f/x,_])}get hcl(){return this.overwriteGetter("hcl",function(i){const[o,f,_,x]=Xc(i),S=Math.sqrt(f*f+_*_);return[Math.round(1e4*S)?qc(Math.atan2(_,f)*tm):NaN,S,o,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Xc(this.rgb))}overwriteGetter(i,o){return Object.defineProperty(this,i,{value:o}),o}toString(){const[i,o,f,_]=this.rgb;return`rgba(${[i,o,f].map(x=>Math.round(255*x)).join(",")},${_})`}static interpolate(i,o,f,_="rgb"){switch(_){case"rgb":{const[x,S,A,I]=nc(i.rgb,o.rgb,f);return new xn(x,S,A,I,!1)}case"hcl":{const[x,S,A,I]=i.hcl,[O,z,V,Z]=o.hcl;let X,Q;if(isNaN(x)||isNaN(O))isNaN(x)?isNaN(O)?X=NaN:(X=O,A!==1&&A!==0||(Q=z)):(X=x,V!==1&&V!==0||(Q=S));else{let xe=O-x;O>x&&xe>180?xe-=360:O<x&&x-O>180&&(xe+=360),X=x+f*xe}const[ae,ce,me,ze]=function([xe,Ie,Ze,Je]){return xe=isNaN(xe)?0:xe*Id,ec([Ze,Math.cos(xe)*Ie,Math.sin(xe)*Ie,Je])}([X,Q??$s(S,z,f),$s(A,V,f),$s(I,Z,f)]);return new xn(ae,ce,me,ze,!1)}case"lab":{const[x,S,A,I]=ec(nc(i.lab,o.lab,f));return new xn(x,S,A,I,!1)}}}}xn.black=new xn(0,0,0,1),xn.white=new xn(1,1,1,1),xn.transparent=new xn(0,0,0,0),xn.red=new xn(1,0,0,1);class Zs{constructor(i,o,f){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Wc=["bottom","center","top"];class Ys{constructor(i,o,f,_,x,S){this.text=i,this.image=o,this.scale=f,this.fontStack=_,this.textColor=x,this.verticalAlign=S}}class pr{constructor(i){this.sections=i}static fromString(i){return new pr([new Ys(i,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof pr?i:pr.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class Tr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Tr)return i;if(typeof i=="number")return new Tr([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const o of i)if(typeof o!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new Tr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new Tr(nc(i.values,o.values,f))}}class Yr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Yr)return i;if(typeof i=="number")return new Yr([i]);if(Array.isArray(i)){for(const o of i)if(typeof o!="number")return;return new Yr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new Yr(nc(i.values,o.values,f))}}class ar{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof ar)return i;if(typeof i=="string"){const f=xn.parse(i);return f?new ar([f]):void 0}if(!Array.isArray(i))return;const o=[];for(const f of i){if(typeof f!="string")return;const _=xn.parse(f);if(!_)return;o.push(_)}return new ar(o)}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f,_="rgb"){const x=[];if(i.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let S=0;S<i.values.length;S++)x.push(xn.interpolate(i.values[S],o.values[S],f,_));return new ar(x)}}class Wn extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const bs=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Hr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Hr)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let o=0;o<i.length;o+=2){const f=i[o],_=i[o+1];if(typeof f!="string"||!bs.has(f)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new Hr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){const _=i.values,x=o.values;if(_.length!==x.length)throw new Wn(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${o.toString()}`);const S=[];for(let A=0;A<_.length;A+=2){if(_[A]!==x[A])throw new Wn(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${_[A]}, to[${A}]: ${x[A]}`);S.push(_[A]);const[I,O]=_[A+1],[z,V]=x[A+1];S.push([$s(I,z,f),$s(O,V,f)])}return new Hr(S)}}class qr{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new qr({name:i,available:!1}):null}}class qi{constructor(i,o,f){this.from=i,this.to=o,this.transition=f}static interpolate(i,o,f){return new qi(i,o,f)}static parse(i){return i instanceof qi?i:Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"?new qi(i[0],i[1],i[2]):typeof i=="object"&&typeof i.from=="string"&&typeof i.to=="string"&&typeof i.transition=="number"?new qi(i.from,i.to,i.transition):typeof i=="string"?new qi(i,i,1):void 0}}function fi(s,i,o,f){return typeof s=="number"&&s>=0&&s<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[s,i,o,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[s,i,o,f]:[s,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function xs(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof qi||s instanceof xn||s instanceof Zs||s instanceof pr||s instanceof Tr||s instanceof Yr||s instanceof ar||s instanceof Hr||s instanceof qr)return!0;if(Array.isArray(s)){for(const i of s)if(!xs(i))return!1;return!0}if(typeof s=="object"){for(const i in s)if(!xs(s[i]))return!1;return!0}return!1}function Qt(s){if(s===null)return ps;if(typeof s=="string")return yn;if(typeof s=="boolean")return ln;if(typeof s=="number")return It;if(s instanceof xn)return rr;if(s instanceof qi)return fo;if(s instanceof Zs)return rh;if(s instanceof pr)return Ia;if(s instanceof Tr)return Gs;if(s instanceof Yr)return Kl;if(s instanceof ar)return ms;if(s instanceof Hr)return Cd;if(s instanceof qr)return Hi;if(Array.isArray(s)){const i=s.length;let o;for(const f of s){const _=Qt(f);if(o){if(o===_)continue;o=_n;break}o=_}return $r(o||_n,i)}return Oi}function on(s){const i=typeof s;return s===null?"":i==="string"||i==="number"||i==="boolean"?String(s):s instanceof xn||s instanceof qi||s instanceof pr||s instanceof Tr||s instanceof Yr||s instanceof ar||s instanceof Hr||s instanceof qr?s.toString():JSON.stringify(s)}class po{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!xs(i[1]))return o.error("invalid value");const f=i[1];let _=Qt(f);const x=o.expectedType;return _.kind!=="array"||_.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(_=x),new po(_,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Pn={string:yn,number:It,boolean:ln,object:Oi};class Mi{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f,_=1;const x=i[0];if(x==="array"){let A,I;if(i.length>2){const O=i[1];if(typeof O!="string"||!(O in Pn)||O==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);A=Pn[O],_++}else A=_n;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);I=i[2],_++}f=$r(A,I)}else{if(!Pn[x])throw new Error(`Types doesn't contain name = ${x}`);f=Pn[x]}const S=[];for(;_<i.length;_++){const A=o.parse(i[_],_,_n);if(!A)return null;S.push(A)}return new Mi(f,S)}evaluate(i){for(let o=0;o<this.args.length;o++){const f=this.args[o].evaluate(i);if(!Jl(this.type,Qt(f)))return f;if(o===this.args.length-1)throw new Wn(`Expected value to be of type ${ei(this.type)}, but found ${ei(Qt(f))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const ea={"to-boolean":ln,"to-color":rr,"to-number":It,"to-string":yn};class Za{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[0];if(!ea[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&i.length!==2)return o.error("Expected one argument.");const _=ea[f],x=[];for(let S=1;S<i.length;S++){const A=o.parse(i[S],S,_n);if(!A)return null;x.push(A)}return new Za(_,x)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let o,f;for(const _ of this.args){if(o=_.evaluate(i),f=null,o instanceof xn)return o;if(typeof o=="string"){const x=i.parseColor(o);if(x)return x}else if(Array.isArray(o)&&(f=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:fi(o[0],o[1],o[2],o[3]),!f))return new xn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Wn(f||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const f of this.args){o=f.evaluate(i);const _=Tr.parse(o);if(_)return _}throw new Wn(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const f of this.args){o=f.evaluate(i);const _=Yr.parse(o);if(_)return _}throw new Wn(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const f of this.args){o=f.evaluate(i);const _=ar.parse(o);if(_)return _}throw new Wn(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const f of this.args){o=f.evaluate(i);const _=Hr.parse(o);if(_)return _}throw new Wn(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const f of this.args){if(o=f.evaluate(i),o===null)return 0;const _=Number(o);if(!isNaN(_))return _}throw new Wn(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return pr.fromString(on(this.args[0].evaluate(i)));case"resolvedImage":return qr.fromString(on(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return on(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const wl=["Unknown","Point","LineString","Polygon"];class Vf{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?wl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let o=this._parseColorCache.get(i);return o||(o=xn.parse(i),this._parseColorCache.set(i,o)),o}}class Tl{constructor(i,o,f=[],_,x=new Vs,S=[]){this.registry=i,this.path=f,this.key=f.map(A=>`[${A}]`).join(""),this.scope=x,this.errors=S,this.expectedType=_,this._isConstant=o}parse(i,o,f,_,x={}){return o?this.concat(o,f,_)._parse(i,x):this._parse(i,x)}_parse(i,o){function f(_,x,S){return S==="assert"?new Mi(x,[_]):S==="coerce"?new Za(x,[_]):_}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=i[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[_];if(x){let S=x.parse(i,this);if(!S)return null;if(this.expectedType){const A=this.expectedType,I=S.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||I.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(I.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(I.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(I.kind)||A.kind==="colorArray"&&["value","string","array"].includes(I.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(I.kind))S=f(S,A,o.typeAnnotation||"coerce");else if(this.checkSubtype(A,I))return null}else S=f(S,A,o.typeAnnotation||"assert")}if(!(S instanceof po)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const A=new Vf;try{S=new po(S.type,S.evaluate(A))}catch(I){return this.error(I.message),null}}return S}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,f){const _=typeof i=="number"?this.path.concat(i):this.path,x=f?this.scope.concat(f):this.scope;return new Tl(this.registry,this._isConstant,_,o||null,x,this.errors)}error(i,...o){const f=`${this.key}${o.map(_=>`[${_}]`).join("")}`;this.errors.push(new Yi(f,i))}checkSubtype(i,o){const f=Jl(i,o);return f&&this.error(f),f}}class ic{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let x=1;x<i.length-1;x+=2){const S=i[x];if(typeof S!="string")return o.error(`Expected string, but found ${typeof S} instead.`,x);if(/[^a-zA-Z0-9_]/.test(S))return o.error("Variable names must contain only alphanumeric characters or '_'.",x);const A=o.parse(i[x+1],x+1);if(!A)return null;f.push([S,A])}const _=o.parse(i[i.length-1],i.length-1,o.expectedType,f);return _?new ic(f,_):null}outputDefined(){return this.result.outputDefined()}}class Sl{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const f=i[1];return o.scope.has(f)?new Sl(f,o.scope.get(f)):o.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class rc{constructor(i,o,f){this.type=i,this.index=o,this.input=f}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,It),_=o.parse(i[2],2,$r(o.expectedType||_n));return f&&_?new rc(_.type.itemType,f,_):null}evaluate(i){const o=this.index.evaluate(i),f=this.input.evaluate(i);if(o<0)throw new Wn(`Array index out of bounds: ${o} < 0.`);if(o>=f.length)throw new Wn(`Array index out of bounds: ${o} > ${f.length-1}.`);if(o!==Math.floor(o))throw new Wn(`Array index must be an integer, but found ${o} instead.`);return f[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class lh{constructor(i,o){this.type=ln,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,_n),_=o.parse(i[2],2,_n);return f&&_?Dd(f.type,[ln,yn,It,ps,_n])?new lh(f,_):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ei(f.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!f)return!1;if(!$a(o,["boolean","string","number","null"]))throw new Wn(`Expected first argument to be of type boolean, string, number or null, but found ${ei(Qt(o))} instead.`);if(!$a(f,["string","array"]))throw new Wn(`Expected second argument to be of type array or string, but found ${ei(Qt(f))} instead.`);return f.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class zo{constructor(i,o,f){this.type=It,this.needle=i,this.haystack=o,this.fromIndex=f}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,_n),_=o.parse(i[2],2,_n);if(!f||!_)return null;if(!Dd(f.type,[ln,yn,It,ps,_n]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ei(f.type)} instead`);if(i.length===4){const x=o.parse(i[3],3,It);return x?new zo(f,_,x):null}return new zo(f,_)}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!$a(o,["boolean","string","number","null"]))throw new Wn(`Expected first argument to be of type boolean, string, number or null, but found ${ei(Qt(o))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(i)),$a(f,["string"])){const x=f.indexOf(o,_);return x===-1?-1:[...f.slice(0,x)].length}if($a(f,["array"]))return f.indexOf(o,_);throw new Wn(`Expected second argument to be of type array or string, but found ${ei(Qt(f))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Lr{constructor(i,o,f,_,x,S){this.inputType=i,this.type=o,this.input=f,this.cases=_,this.outputs=x,this.otherwise=S}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let f,_;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);const x={},S=[];for(let O=2;O<i.length-1;O+=2){let z=i[O];const V=i[O+1];Array.isArray(z)||(z=[z]);const Z=o.concat(O);if(z.length===0)return Z.error("Expected at least one branch label.");for(const Q of z){if(typeof Q!="number"&&typeof Q!="string")return Z.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return Z.error("Numeric branch labels must be integer values.");if(f){if(Z.checkSubtype(f,Qt(Q)))return null}else f=Qt(Q);if(x[String(Q)]!==void 0)return Z.error("Branch labels must be unique.");x[String(Q)]=S.length}const X=o.parse(V,O,_);if(!X)return null;_=_||X.type,S.push(X)}const A=o.parse(i[1],1,_n);if(!A)return null;const I=o.parse(i[i.length-1],i.length-1,_);return I?A.type.kind!=="value"&&o.concat(1).checkSubtype(f,A.type)?null:new Lr(f,_,A,x,S,I):null}evaluate(i){const o=this.input.evaluate(i);return(Qt(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class Qc{constructor(i,o,f){this.type=i,this.branches=o,this.otherwise=f}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const _=[];for(let S=1;S<i.length-1;S+=2){const A=o.parse(i[S],S,ln);if(!A)return null;const I=o.parse(i[S+1],S+1,f);if(!I)return null;_.push([A,I]),f=f||I.type}const x=o.parse(i[i.length-1],i.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new Qc(f,_,x)}evaluate(i){for(const[o,f]of this.branches)if(o.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,f]of this.branches)i(o),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class ac{constructor(i,o,f,_){this.type=i,this.input=o,this.beginIndex=f,this.endIndex=_}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,_n),_=o.parse(i[2],2,It);if(!f||!_)return null;if(!Dd(f.type,[$r(_n),yn,_n]))return o.error(`Expected first argument to be of type array or string, but found ${ei(f.type)} instead`);if(i.length===4){const x=o.parse(i[3],3,It);return x?new ac(f.type,f,_,x):null}return new ac(f.type,f,_)}evaluate(i){const o=this.input.evaluate(i),f=this.beginIndex.evaluate(i);let _;if(this.endIndex&&(_=this.endIndex.evaluate(i)),$a(o,["string"]))return[...o].slice(f,_).join("");if($a(o,["array"]))return o.slice(f,_);throw new Wn(`Expected first argument to be of type array or string, but found ${ei(Qt(o))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function oc(s,i){const o=s.length-1;let f,_,x=0,S=o,A=0;for(;x<=S;)if(A=Math.floor((x+S)/2),f=s[A],_=s[A+1],f<=i){if(A===o||i<_)return A;x=A+1}else{if(!(f>i))throw new Wn("Input is not a number.");S=A-1}return 0}class Ki{constructor(i,o,f){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[_,x]of f)this.labels.push(_),this.outputs.push(x)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const f=o.parse(i[1],1,It);if(!f)return null;const _=[];let x=null;o.expectedType&&o.expectedType.kind!=="value"&&(x=o.expectedType);for(let S=1;S<i.length;S+=2){const A=S===1?-1/0:i[S],I=i[S+1],O=S,z=S+1;if(typeof A!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(_.length&&_[_.length-1][0]>=A)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const V=o.parse(I,z,x);if(!V)return null;x=x||V.type,_.push([A,V])}return new Ki(x,f,_)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const _=this.input.evaluate(i);if(_<=o[0])return f[0].evaluate(i);const x=o.length;return _>=o[x-1]?f[x-1].evaluate(i):f[oc(o,_)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function im(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ch,Gf,rm=function(){if(Gf)return ch;function s(i,o,f,_){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(_-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=_}return Gf=1,ch=s,s.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,_=0;_<8;_++){var x=this.sampleCurveX(f)-i;if(Math.abs(x)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=x/S}var A=0,I=1;for(f=i,_=0;_<20&&(x=this.sampleCurveX(f),!(Math.abs(x-i)<o));_++)i>x?A=f:I=f,f=.5*(I-A)+A;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},ch}(),Kc=im(rm);class Xr{constructor(i,o,f,_,x){this.type=i,this.operator=o,this.interpolation=f,this.input=_,this.labels=[],this.outputs=[];for(const[S,A]of x)this.labels.push(S),this.outputs.push(A)}static interpolationFactor(i,o,f,_){let x=0;if(i.name==="exponential")x=uh(o,i.base,f,_);else if(i.name==="linear")x=uh(o,1,f,_);else if(i.name==="cubic-bezier"){const S=i.controlPoints;x=new Kc(S[0],S[1],S[2],S[3]).solve(uh(o,1,f,_))}return x}static parse(i,o){let[f,_,x,...S]=i;if(!Array.isArray(_)||_.length===0)return o.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const O=_[1];if(typeof O!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:O}}else{if(_[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const O=_.slice(1);if(O.length!==4||O.some(z=>typeof z!="number"||z<0||z>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:O}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(x=o.parse(x,2,It),!x)return null;const A=[];let I=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||o.expectedType==ms?o.expectedType&&o.expectedType.kind!=="value"&&(I=o.expectedType):I=rr;for(let O=0;O<S.length;O+=2){const z=S[O],V=S[O+1],Z=O+3,X=O+4;if(typeof z!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(A.length&&A[A.length-1][0]>=z)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const Q=o.parse(V,X,I);if(!Q)return null;I=I||Q.type,A.push([z,Q])}return ys(I,It)||ys(I,fo)||ys(I,rr)||ys(I,Gs)||ys(I,Kl)||ys(I,ms)||ys(I,Cd)||ys(I,$r(It))?new Xr(I,f,_,x,A):o.error(`Type ${ei(I)} is not interpolatable.`)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const _=this.input.evaluate(i);if(_<=o[0])return f[0].evaluate(i);const x=o.length;if(_>=o[x-1])return f[x-1].evaluate(i);const S=oc(o,_),A=Xr.interpolationFactor(this.interpolation,_,o[S],o[S+1]),I=f[S].evaluate(i),O=f[S+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return $s(I,O,A);case"color":return xn.interpolate(I,O,A);case"padding":return Tr.interpolate(I,O,A);case"colorArray":return ar.interpolate(I,O,A);case"numberArray":return Yr.interpolate(I,O,A);case"variableAnchorOffsetCollection":return Hr.interpolate(I,O,A);case"array":return nc(I,O,A);case"projectionDefinition":return qi.interpolate(I,O,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return xn.interpolate(I,O,A,"hcl");case"colorArray":return ar.interpolate(I,O,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return xn.interpolate(I,O,A,"lab");case"colorArray":return ar.interpolate(I,O,A,"lab")}}}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function uh(s,i,o,f){const _=f-o,x=s-o;return _===0?0:i===1?x/_:(Math.pow(i,x)-1)/(Math.pow(i,_)-1)}const ws={color:xn.interpolate,number:$s,padding:Tr.interpolate,numberArray:Yr.interpolate,colorArray:ar.interpolate,variableAnchorOffsetCollection:Hr.interpolate,array:nc};class sc{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f=null;const _=o.expectedType;_&&_.kind!=="value"&&(f=_);const x=[];for(const A of i.slice(1)){const I=o.parse(A,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!I)return null;f=f||I.type,x.push(I)}if(!f)throw new Error("No output type");const S=_&&x.some(A=>Jl(_,A.type));return new sc(S?_n:f,x)}evaluate(i){let o,f=null,_=0;for(const x of this.args)if(_++,f=x.evaluate(i),f&&f instanceof qr&&!f.available&&(o||(o=f.name),f=null,_===this.args.length&&(f=o)),f!==null)break;return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function hh(s,i){return s==="=="||s==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function dh(s,i,o,f){return f.compare(i,o)===0}function ta(s,i,o){const f=s!=="=="&&s!=="!=";return class AS{constructor(x,S,A){this.type=ln,this.lhs=x,this.rhs=S,this.collator=A,this.hasUntypedArgument=x.type.kind==="value"||S.type.kind==="value"}static parse(x,S){if(x.length!==3&&x.length!==4)return S.error("Expected two or three arguments.");const A=x[0];let I=S.parse(x[1],1,_n);if(!I)return null;if(!hh(A,I.type))return S.concat(1).error(`"${A}" comparisons are not supported for type '${ei(I.type)}'.`);let O=S.parse(x[2],2,_n);if(!O)return null;if(!hh(A,O.type))return S.concat(2).error(`"${A}" comparisons are not supported for type '${ei(O.type)}'.`);if(I.type.kind!==O.type.kind&&I.type.kind!=="value"&&O.type.kind!=="value")return S.error(`Cannot compare types '${ei(I.type)}' and '${ei(O.type)}'.`);f&&(I.type.kind==="value"&&O.type.kind!=="value"?I=new Mi(O.type,[I]):I.type.kind!=="value"&&O.type.kind==="value"&&(O=new Mi(I.type,[O])));let z=null;if(x.length===4){if(I.type.kind!=="string"&&O.type.kind!=="string"&&I.type.kind!=="value"&&O.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(z=S.parse(x[3],3,rh),!z)return null}return new AS(I,O,z)}evaluate(x){const S=this.lhs.evaluate(x),A=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const I=Qt(S),O=Qt(A);if(I.kind!==O.kind||I.kind!=="string"&&I.kind!=="number")throw new Wn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${I.kind}, ${O.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const I=Qt(S),O=Qt(A);if(I.kind!=="string"||O.kind!=="string")return i(x,S,A)}return this.collator?o(x,S,A,this.collator.evaluate(x)):i(x,S,A)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const $f=ta("==",function(s,i,o){return i===o},dh),Rd=ta("!=",function(s,i,o){return i!==o},function(s,i,o,f){return!dh(0,i,o,f)}),ry=ta("<",function(s,i,o){return i<o},function(s,i,o,f){return f.compare(i,o)<0}),Zf=ta(">",function(s,i,o){return i>o},function(s,i,o,f){return f.compare(i,o)>0}),ay=ta("<=",function(s,i,o){return i<=o},function(s,i,o,f){return f.compare(i,o)<=0}),oy=ta(">=",function(s,i,o){return i>=o},function(s,i,o,f){return f.compare(i,o)>=0});class kd{constructor(i,o,f){this.type=rh,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return o.error("Collator options argument must be an object.");const _=o.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,ln);if(!_)return null;const x=o.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,ln);if(!x)return null;let S=null;return f.locale&&(S=o.parse(f.locale,1,yn),!S)?null:new kd(_,x,S)}evaluate(i){return new Zs(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class Yf{constructor(i,o,f,_,x){this.type=yn,this.number=i,this.locale=o,this.currency=f,this.minFractionDigits=_,this.maxFractionDigits=x}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const f=o.parse(i[1],1,It);if(!f)return null;const _=i[2];if(typeof _!="object"||Array.isArray(_))return o.error("NumberFormat options argument must be an object.");let x=null;if(_.locale&&(x=o.parse(_.locale,1,yn),!x))return null;let S=null;if(_.currency&&(S=o.parse(_.currency,1,yn),!S))return null;let A=null;if(_["min-fraction-digits"]&&(A=o.parse(_["min-fraction-digits"],1,It),!A))return null;let I=null;return _["max-fraction-digits"]&&(I=o.parse(_["max-fraction-digits"],1,It),!I)?null:new Yf(f,x,S,A,I)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class lc{constructor(i){this.type=Ia,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return o.error("First argument must be an image or text section.");const _=[];let x=!1;for(let S=1;S<=i.length-1;++S){const A=i[S];if(x&&typeof A=="object"&&!Array.isArray(A)){x=!1;let I=null;if(A["font-scale"]&&(I=o.parse(A["font-scale"],1,It),!I))return null;let O=null;if(A["text-font"]&&(O=o.parse(A["text-font"],1,$r(yn)),!O))return null;let z=null;if(A["text-color"]&&(z=o.parse(A["text-color"],1,rr),!z))return null;let V=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!Wc.includes(A["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(V=o.parse(A["vertical-align"],1,yn),!V)return null}const Z=_[_.length-1];Z.scale=I,Z.font=O,Z.textColor=z,Z.verticalAlign=V}else{const I=o.parse(i[S],1,_n);if(!I)return null;const O=I.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,_.push({content:I,scale:null,font:null,textColor:null,verticalAlign:null})}}return new lc(_)}evaluate(i){return new pr(this.sections.map(o=>{const f=o.content.evaluate(i);return Qt(f)===Hi?new Ys("",f,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(i):null):new Ys(on(f),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null,o.verticalAlign?o.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor),o.verticalAlign&&i(o.verticalAlign)}outputDefined(){return!1}}class Hf{constructor(i){this.type=Hi,this.input=i}static parse(i,o){if(i.length!==2)return o.error("Expected two arguments.");const f=o.parse(i[1],1,yn);return f?new Hf(f):o.error("No image name provided.")}evaluate(i){const o=this.input.evaluate(i),f=qr.fromString(o);return f&&i.availableImages&&(f.available=i.availableImages.indexOf(o)>-1),f}eachChild(i){i(this.input)}outputDefined(){return!1}}class Jc{constructor(i){this.type=It,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=o.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ei(f.type)} instead.`):new Jc(f):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new Wn(`Expected value to be of type string or array, but found ${ei(Qt(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const va=8192;function sy(s,i){const o=(180+s[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,_=Math.pow(2,i.z);return[Math.round(o*_*va),Math.round(f*_*va)]}function fh(s,i){const o=Math.pow(2,i.z);return[(_=(s[0]/va+i.x)/o,360*_-180),(f=(s[1]/va+i.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,_}function eu(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function tu(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function am(s,i,o){const f=s[0]-i[0],_=s[1]-i[1],x=s[0]-o[0],S=s[1]-o[1];return f*S-x*_==0&&f*x<=0&&_*S<=0}function ph(s,i,o,f){return(_=[f[0]-o[0],f[1]-o[1]])[0]*(x=[i[0]-s[0],i[1]-s[1]])[1]-_[1]*x[0]!=0&&!(!Xf(s,i,o,f)||!Xf(o,f,s,i));var _,x}function nu(s,i,o){for(const f of o)for(let _=0;_<f.length-1;++_)if(ph(s,i,f[_],f[_+1]))return!0;return!1}function cc(s,i,o=!1){let f=!1;for(const A of i)for(let I=0;I<A.length-1;I++){if(am(s,A[I],A[I+1]))return o;(x=A[I])[1]>(_=s)[1]!=(S=A[I+1])[1]>_[1]&&_[0]<(S[0]-x[0])*(_[1]-x[1])/(S[1]-x[1])+x[0]&&(f=!f)}var _,x,S;return f}function om(s,i){for(const o of i)if(cc(s,o))return!0;return!1}function qf(s,i){for(const o of s)if(!cc(o,i))return!1;for(let o=0;o<s.length-1;++o)if(nu(s[o],s[o+1],i))return!1;return!0}function sm(s,i){for(const o of i)if(qf(s,o))return!0;return!1}function Xf(s,i,o,f){const _=f[0]-o[0],x=f[1]-o[1],S=(s[0]-o[0])*x-_*(s[1]-o[1]),A=(i[0]-o[0])*x-_*(i[1]-o[1]);return S>0&&A<0||S<0&&A>0}function uc(s,i,o){const f=[];for(let _=0;_<s.length;_++){const x=[];for(let S=0;S<s[_].length;S++){const A=sy(s[_][S],o);eu(i,A),x.push(A)}f.push(x)}return f}function iu(s,i,o){const f=[];for(let _=0;_<s.length;_++){const x=uc(s[_],i,o);f.push(x)}return f}function Pd(s,i,o,f){if(s[0]<o[0]||s[0]>o[2]){const _=.5*f;let x=s[0]-o[0]>_?-f:o[0]-s[0]>_?f:0;x===0&&(x=s[0]-o[2]>_?-f:o[2]-s[0]>_?f:0),s[0]+=x}eu(i,s)}function mh(s,i,o,f){const _=Math.pow(2,f.z)*va,x=[f.x*va,f.y*va],S=[];for(const A of s)for(const I of A){const O=[I.x+x[0],I.y+x[1]];Pd(O,i,o,_),S.push(O)}return S}function Wf(s,i,o,f){const _=Math.pow(2,f.z)*va,x=[f.x*va,f.y*va],S=[];for(const I of s){const O=[];for(const z of I){const V=[z.x+x[0],z.y+x[1]];eu(i,V),O.push(V)}S.push(O)}if(i[2]-i[0]<=_/2){(A=i)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const I of S)for(const O of I)Pd(O,i,o,_)}var A;return S}class El{constructor(i,o){this.type=ln,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(xs(i[1])){const f=i[1];if(f.type==="FeatureCollection"){const _=[];for(const x of f.features){const{type:S,coordinates:A}=x.geometry;S==="Polygon"&&_.push(A),S==="MultiPolygon"&&_.push(...A)}if(_.length)return new El(f,{type:"MultiPolygon",coordinates:_})}else if(f.type==="Feature"){const _=f.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new El(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new El(f,f)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const _=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const A=uc(f.coordinates,x,S),I=mh(o.geometry(),_,x,S);if(!tu(_,x))return!1;for(const O of I)if(!cc(O,A))return!1}if(f.type==="MultiPolygon"){const A=iu(f.coordinates,x,S),I=mh(o.geometry(),_,x,S);if(!tu(_,x))return!1;for(const O of I)if(!om(O,A))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const _=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const A=uc(f.coordinates,x,S),I=Wf(o.geometry(),_,x,S);if(!tu(_,x))return!1;for(const O of I)if(!qf(O,A))return!1}if(f.type==="MultiPolygon"){const A=iu(f.coordinates,x,S),I=Wf(o.geometry(),_,x,S);if(!tu(_,x))return!1;for(const O of I)if(!sm(O,A))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let gh=class{constructor(s=[],i=(o,f)=>o<f?-1:o>f?1:0){if(this.data=s,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:i,compare:o}=this,f=i[s];for(;s>0;){const _=s-1>>1,x=i[_];if(o(f,x)>=0)break;i[s]=x,s=_}i[s]=f}_down(s){const{data:i,compare:o}=this,f=this.length>>1,_=i[s];for(;s<f;){let x=1+(s<<1);const S=x+1;if(S<this.length&&o(i[S],i[x])<0&&(x=S),o(i[x],_)>=0)break;i[s]=i[x],s=x}i[s]=_}};function yh(s,i,o=0,f=s.length-1,_=lm){for(;f>o;){if(f-o>600){const I=f-o+1,O=i-o+1,z=Math.log(I),V=.5*Math.exp(2*z/3),Z=.5*Math.sqrt(z*V*(I-V)/I)*(O-I/2<0?-1:1);yh(s,i,Math.max(o,Math.floor(i-O*V/I+Z)),Math.min(f,Math.floor(i+(I-O)*V/I+Z)),_)}const x=s[i];let S=o,A=f;for(ru(s,o,i),_(s[f],x)>0&&ru(s,o,f);S<A;){for(ru(s,S,A),S++,A--;_(s[S],x)<0;)S++;for(;_(s[A],x)>0;)A--}_(s[o],x)===0?ru(s,o,A):(A++,ru(s,A,f)),A<=i&&(o=A+1),i<=A&&(f=A-1)}}function ru(s,i,o){const f=s[i];s[i]=s[o],s[o]=f}function lm(s,i){return s<i?-1:s>i?1:0}function au(s,i){if(s.length<=1)return[s];const o=[];let f,_;for(const x of s){const S=ly(x);S!==0&&(x.area=Math.abs(S),_===void 0&&(_=S<0),_===S<0?(f&&o.push(f),f=[x]):f.push(x))}if(f&&o.push(f),i>1)for(let x=0;x<o.length;x++)o[x].length<=i||(yh(o[x],i,1,o[x].length-1,cm),o[x]=o[x].slice(0,i));return o}function cm(s,i){return i.area-s.area}function ly(s){let i=0;for(let o,f,_=0,x=s.length,S=x-1;_<x;S=_++)o=s[_],f=s[S],i+=(f.x-o.x)*(o.y+f.y);return i}const um=1/298.257223563,hm=um*(2-um),Qf=Math.PI/180;class ba{constructor(i){const o=6378.137*Qf*1e3,f=Math.cos(i*Qf),_=1/(1-hm*(1-f*f)),x=Math.sqrt(_);this.kx=o*x*f,this.ky=o*x*_*(1-hm)}distance(i,o){const f=this.wrap(i[0]-o[0])*this.kx,_=(i[1]-o[1])*this.ky;return Math.sqrt(f*f+_*_)}pointOnLine(i,o){let f,_,x,S,A=1/0;for(let I=0;I<i.length-1;I++){let O=i[I][0],z=i[I][1],V=this.wrap(i[I+1][0]-O)*this.kx,Z=(i[I+1][1]-z)*this.ky,X=0;V===0&&Z===0||(X=(this.wrap(o[0]-O)*this.kx*V+(o[1]-z)*this.ky*Z)/(V*V+Z*Z),X>1?(O=i[I+1][0],z=i[I+1][1]):X>0&&(O+=V/this.kx*X,z+=Z/this.ky*X)),V=this.wrap(o[0]-O)*this.kx,Z=(o[1]-z)*this.ky;const Q=V*V+Z*Z;Q<A&&(A=Q,f=O,_=z,x=I,S=X)}return{point:[f,_],index:x,t:Math.max(0,Math.min(1,S))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function ou(s,i){return i[0]-s[0]}function _h(s){return s[1]-s[0]+1}function Ts(s,i){return s[1]>=s[0]&&s[1]<i}function Gn(s,i){if(s[0]>s[1])return[null,null];const o=_h(s);if(i){if(o===2)return[s,null];const _=Math.floor(o/2);return[[s[0],s[0]+_],[s[0]+_,s[1]]]}if(o===1)return[s,null];const f=Math.floor(o/2)-1;return[[s[0],s[0]+f],[s[0]+f+1,s[1]]]}function Od(s,i){if(!Ts(i,s.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let f=i[0];f<=i[1];++f)eu(o,s[f]);return o}function vh(s){const i=[1/0,1/0,-1/0,-1/0];for(const o of s)for(const f of o)eu(i,f);return i}function dm(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Ml(s,i,o){if(!dm(s)||!dm(i))return NaN;let f=0,_=0;return s[2]<i[0]&&(f=i[0]-s[2]),s[0]>i[2]&&(f=s[0]-i[2]),s[1]>i[3]&&(_=s[1]-i[3]),s[3]<i[1]&&(_=i[1]-s[3]),o.distance([0,0],[f,_])}function Hs(s,i,o){const f=o.pointOnLine(i,s);return o.distance(s,f.point)}function hc(s,i,o,f,_){const x=Math.min(Hs(s,[o,f],_),Hs(i,[o,f],_)),S=Math.min(Hs(o,[s,i],_),Hs(f,[s,i],_));return Math.min(x,S)}function Kf(s,i,o,f,_){if(!Ts(i,s.length)||!Ts(f,o.length))return 1/0;let x=1/0;for(let S=i[0];S<i[1];++S){const A=s[S],I=s[S+1];for(let O=f[0];O<f[1];++O){const z=o[O],V=o[O+1];if(ph(A,I,z,V))return 0;x=Math.min(x,hc(A,I,z,V,_))}}return x}function fm(s,i,o,f,_){if(!Ts(i,s.length)||!Ts(f,o.length))return NaN;let x=1/0;for(let S=i[0];S<=i[1];++S)for(let A=f[0];A<=f[1];++A)if(x=Math.min(x,_.distance(s[S],o[A])),x===0)return x;return x}function dc(s,i,o){if(cc(s,i,!0))return 0;let f=1/0;for(const _ of i){const x=_[0],S=_[_.length-1];if(x!==S&&(f=Math.min(f,Hs(s,[S,x],o)),f===0))return f;const A=o.pointOnLine(_,s);if(f=Math.min(f,o.distance(s,A.point)),f===0)return f}return f}function su(s,i,o,f){if(!Ts(i,s.length))return NaN;for(let x=i[0];x<=i[1];++x)if(cc(s[x],o,!0))return 0;let _=1/0;for(let x=i[0];x<i[1];++x){const S=s[x],A=s[x+1];for(const I of o)for(let O=0,z=I.length,V=z-1;O<z;V=O++){const Z=I[V],X=I[O];if(ph(S,A,Z,X))return 0;_=Math.min(_,hc(S,A,Z,X,f))}}return _}function Ld(s,i){for(const o of s)for(const f of o)if(cc(f,i,!0))return!0;return!1}function pm(s,i,o,f=1/0){const _=vh(s),x=vh(i);if(f!==1/0&&Ml(_,x,o)>=f)return f;if(tu(_,x)){if(Ld(s,i))return 0}else if(Ld(i,s))return 0;let S=1/0;for(const A of s)for(let I=0,O=A.length,z=O-1;I<O;z=I++){const V=A[z],Z=A[I];for(const X of i)for(let Q=0,ae=X.length,ce=ae-1;Q<ae;ce=Q++){const me=X[ce],ze=X[Q];if(ph(V,Z,me,ze))return 0;S=Math.min(S,hc(V,Z,me,ze,o))}}return S}function Al(s,i,o,f,_,x){if(!x)return;const S=Ml(Od(f,x),_,o);S<i&&s.push([S,x,[0,0]])}function bh(s,i,o,f,_,x,S){if(!x||!S)return;const A=Ml(Od(f,x),Od(_,S),o);A<i&&s.push([A,x,S])}function xh(s,i,o,f,_=1/0){let x=Math.min(f.distance(s[0],o[0][0]),_);if(x===0)return x;const S=new gh([[0,[0,s.length-1],[0,0]]],ou),A=vh(o);for(;S.length>0;){const I=S.pop();if(I[0]>=x)continue;const O=I[1],z=i?50:100;if(_h(O)<=z){if(!Ts(O,s.length))return NaN;if(i){const V=su(s,O,o,f);if(isNaN(V)||V===0)return V;x=Math.min(x,V)}else for(let V=O[0];V<=O[1];++V){const Z=dc(s[V],o,f);if(x=Math.min(x,Z),x===0)return 0}}else{const V=Gn(O,i);Al(S,x,f,s,A,V[0]),Al(S,x,f,s,A,V[1])}}return x}function wh(s,i,o,f,_,x=1/0){let S=Math.min(x,_.distance(s[0],o[0]));if(S===0)return S;const A=new gh([[0,[0,s.length-1],[0,o.length-1]]],ou);for(;A.length>0;){const I=A.pop();if(I[0]>=S)continue;const O=I[1],z=I[2],V=i?50:100,Z=f?50:100;if(_h(O)<=V&&_h(z)<=Z){if(!Ts(O,s.length)&&Ts(z,o.length))return NaN;let X;if(i&&f)X=Kf(s,O,o,z,_),S=Math.min(S,X);else if(i&&!f){const Q=s.slice(O[0],O[1]+1);for(let ae=z[0];ae<=z[1];++ae)if(X=Hs(o[ae],Q,_),S=Math.min(S,X),S===0)return S}else if(!i&&f){const Q=o.slice(z[0],z[1]+1);for(let ae=O[0];ae<=O[1];++ae)if(X=Hs(s[ae],Q,_),S=Math.min(S,X),S===0)return S}else X=fm(s,O,o,z,_),S=Math.min(S,X)}else{const X=Gn(O,i),Q=Gn(z,f);bh(A,S,_,s,o,X[0],Q[0]),bh(A,S,_,s,o,X[0],Q[1]),bh(A,S,_,s,o,X[1],Q[0]),bh(A,S,_,s,o,X[1],Q[1])}}return S}function Jf(s){return s.type==="MultiPolygon"?s.coordinates.map(i=>({type:"Polygon",coordinates:i})):s.type==="MultiLineString"?s.coordinates.map(i=>({type:"LineString",coordinates:i})):s.type==="MultiPoint"?s.coordinates.map(i=>({type:"Point",coordinates:i})):[s]}class fc{constructor(i,o){this.type=It,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(xs(i[1])){const f=i[1];if(f.type==="FeatureCollection")return new fc(f,f.features.map(_=>Jf(_.geometry)).flat());if(f.type==="Feature")return new fc(f,Jf(f.geometry));if("type"in f&&"coordinates"in f)return new fc(f,Jf(f))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const _=o.geometry(),x=_.flat().map(I=>fh([I.x,I.y],o.canonical));if(_.length===0)return NaN;const S=new ba(x[0][1]);let A=1/0;for(const I of f){switch(I.type){case"Point":A=Math.min(A,wh(x,!1,[I.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,wh(x,!1,I.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,xh(x,!1,I.coordinates,S,A))}if(A===0)return A}return A}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const _=o.geometry(),x=_.flat().map(I=>fh([I.x,I.y],o.canonical));if(_.length===0)return NaN;const S=new ba(x[0][1]);let A=1/0;for(const I of f){switch(I.type){case"Point":A=Math.min(A,wh(x,!0,[I.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,wh(x,!0,I.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,xh(x,!0,I.coordinates,S,A))}if(A===0)return A}return A}(i,this.geometries);if(i.geometryType()==="Polygon")return function(o,f){const _=o.geometry();if(_.length===0||_[0].length===0)return NaN;const x=au(_,0).map(I=>I.map(O=>O.map(z=>fh([z.x,z.y],o.canonical)))),S=new ba(x[0][0][0][1]);let A=1/0;for(const I of f)for(const O of x){switch(I.type){case"Point":A=Math.min(A,xh([I.coordinates],!1,O,S,A));break;case"LineString":A=Math.min(A,xh(I.coordinates,!0,O,S,A));break;case"Polygon":A=Math.min(A,pm(O,I.coordinates,S,A))}if(A===0)return A}return A}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Th{constructor(i){this.type=_n,this.key=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=i[1];return f==null?o.error("Global state property must be defined."):typeof f!="string"?o.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new Th(f)}evaluate(i){var o;const f=(o=i.globals)===null||o===void 0?void 0:o.globalState;return f&&Object.keys(f).length!==0?tc(f,this.key):null}eachChild(){}outputDefined(){return!1}}const pc={"==":$f,"!=":Rd,">":Zf,"<":ry,">=":oy,"<=":ay,array:Mi,at:rc,boolean:Mi,case:Qc,coalesce:sc,collator:kd,format:lc,image:Hf,in:lh,"index-of":zo,interpolate:Xr,"interpolate-hcl":Xr,"interpolate-lab":Xr,length:Jc,let:ic,literal:po,match:Lr,number:Mi,"number-format":Yf,object:Mi,slice:ac,step:Ki,string:Mi,"to-boolean":Za,"to-color":Za,"to-number":Za,"to-string":Za,var:Sl,within:El,distance:fc,"global-state":Th};class Ya{constructor(i,o,f,_){this.name=i,this.type=o,this._evaluate=f,this.args=_}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,o){const f=i[0],_=Ya.definitions[f];if(!_)return o.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,A=S.filter(([O])=>!Array.isArray(O)||O.length===i.length-1);let I=null;for(const[O,z]of A){I=new Tl(o.registry,xa,o.path,null,o.scope);const V=[];let Z=!1;for(let X=1;X<i.length;X++){const Q=i[X],ae=Array.isArray(O)?O[X-1]:O.type,ce=I.parse(Q,1+V.length,ae);if(!ce){Z=!0;break}V.push(ce)}if(!Z)if(Array.isArray(O)&&O.length!==V.length)I.error(`Expected ${O.length} arguments, but found ${V.length} instead.`);else{for(let X=0;X<V.length;X++){const Q=Array.isArray(O)?O[X]:O.type,ae=V[X];I.concat(X+1).checkSubtype(Q,ae.type)}if(I.errors.length===0)return new Ya(f,x,z,V)}}if(A.length===1)o.errors.push(...I.errors);else{const O=(A.length?A:S).map(([V])=>{return Z=V,Array.isArray(Z)?`(${Z.map(ei).join(", ")})`:`(${ei(Z.type)}...)`;var Z}).join(" | "),z=[];for(let V=1;V<i.length;V++){const Z=o.parse(i[V],1+z.length);if(!Z)return null;z.push(ei(Z.type))}o.error(`Expected arguments of type ${O}, but found (${z.join(", ")}) instead.`)}return null}static register(i,o){Ya.definitions=o;for(const f in o)i[f]=Ya}}function Nd(s,[i,o,f,_]){i=i.evaluate(s),o=o.evaluate(s),f=f.evaluate(s);const x=_?_.evaluate(s):1,S=fi(i,o,f,x);if(S)throw new Wn(S);return new xn(i/255,o/255,f/255,x,!1)}function mo(s,i){return s in i}function zd(s,i){const o=i[s];return o===void 0?null:o}function Nr(s){return{type:s}}function xa(s){if(s instanceof Sl)return xa(s.boundExpression);if(s instanceof Ya&&s.name==="error"||s instanceof kd||s instanceof El||s instanceof fc||s instanceof Th)return!1;const i=s instanceof Za||s instanceof Mi;let o=!0;return s.eachChild(f=>{o=i?o&&xa(f):o&&f instanceof po}),!!o&&qs(s)&&gc(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function qs(s){if(s instanceof Ya&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof El||s instanceof fc)return!1;let i=!0;return s.eachChild(o=>{i&&!qs(o)&&(i=!1)}),i}function mc(s){if(s instanceof Ya&&s.name==="feature-state")return!1;let i=!0;return s.eachChild(o=>{i&&!mc(o)&&(i=!1)}),i}function gc(s,i){if(s instanceof Ya&&i.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(f=>{o&&!gc(f,i)&&(o=!1)}),o}function Sh(s){return{result:"success",value:s}}function Cl(s){return{result:"error",value:s}}function Ha(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function ep(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function lu(s){return!!s.expression&&s.expression.interpolated}function vn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Eh(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&Qt(s)===Oi}function qa(s){return s}function jd(s,i){const o=s.stops&&typeof s.stops[0][0]=="object",f=o||!(o||s.property!==void 0),_=s.type||(lu(i)?"exponential":"interval"),x=function(z){switch(z.type){case"color":return xn.parse;case"padding":return Tr.parse;case"numberArray":return Yr.parse;case"colorArray":return ar.parse;default:return null}}(i);if(x&&((s=Jr({},s)).stops&&(s.stops=s.stops.map(z=>[z[0],x(z[1])])),s.default=x(s.default?s.default:i.default)),s.colorSpace&&(S=s.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var S;const A=function(z){switch(z){case"exponential":return Dl;case"interval":return Fd;case"categorical":return tp;case"identity":return np;default:throw new Error(`Unknown function type "${z}"`)}}(_);let I,O;if(_==="categorical"){I=Object.create(null);for(const z of s.stops)I[z[0]]=z[1];O=typeof s.stops[0][0]}if(o){const z={},V=[];for(let Q=0;Q<s.stops.length;Q++){const ae=s.stops[Q],ce=ae[0].zoom;z[ce]===void 0&&(z[ce]={zoom:ce,type:s.type,property:s.property,default:s.default,stops:[]},V.push(ce)),z[ce].stops.push([ae[0].value,ae[1]])}const Z=[];for(const Q of V)Z.push([z[Q].zoom,jd(z[Q],i)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:Xr.interpolationFactor.bind(void 0,X),zoomStops:Z.map(Q=>Q[0]),evaluate:({zoom:Q},ae)=>Dl({stops:Z,base:s.base},i,Q).evaluate(Q,ae)}}if(f){const z=_==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:Xr.interpolationFactor.bind(void 0,z),zoomStops:s.stops.map(V=>V[0]),evaluate:({zoom:V})=>A(s,i,V,I,O)}}return{kind:"source",evaluate(z,V){const Z=V&&V.properties?V.properties[s.property]:void 0;return Z===void 0?na(s.default,i.default):A(s,i,Z,I,O)}}}function na(s,i,o){return s!==void 0?s:i!==void 0?i:o!==void 0?o:void 0}function tp(s,i,o,f,_){return na(typeof o===_?f[o]:void 0,s.default,i.default)}function Fd(s,i,o){if(vn(o)!=="number")return na(s.default,i.default);const f=s.stops.length;if(f===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[f-1][0])return s.stops[f-1][1];const _=oc(s.stops.map(x=>x[0]),o);return s.stops[_][1]}function Dl(s,i,o){const f=s.base!==void 0?s.base:1;if(vn(o)!=="number")return na(s.default,i.default);const _=s.stops.length;if(_===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[_-1][0])return s.stops[_-1][1];const x=oc(s.stops.map(z=>z[0]),o),S=function(z,V,Z,X){const Q=X-Z,ae=z-Z;return Q===0?0:V===1?ae/Q:(Math.pow(V,ae)-1)/(Math.pow(V,Q)-1)}(o,f,s.stops[x][0],s.stops[x+1][0]),A=s.stops[x][1],I=s.stops[x+1][1],O=ws[i.type]||qa;return typeof A.evaluate=="function"?{evaluate(...z){const V=A.evaluate.apply(void 0,z),Z=I.evaluate.apply(void 0,z);if(V!==void 0&&Z!==void 0)return O(V,Z,S,s.colorSpace)}}:O(A,I,S,s.colorSpace)}function np(s,i,o){switch(i.type){case"color":o=xn.parse(o);break;case"formatted":o=pr.fromString(o.toString());break;case"resolvedImage":o=qr.fromString(o.toString());break;case"padding":o=Tr.parse(o);break;case"colorArray":o=ar.parse(o);break;case"numberArray":o=Yr.parse(o);break;default:vn(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0)}return na(o,s.default,i.default)}Ya.register(pc,{error:[{kind:"error"},[yn],(s,[i])=>{throw new Wn(i.evaluate(s))}],typeof:[yn,[_n],(s,[i])=>ei(Qt(i.evaluate(s)))],"to-rgba":[$r(It,4),[rr],(s,[i])=>{const[o,f,_,x]=i.evaluate(s).rgb;return[255*o,255*f,255*_,x]}],rgb:[rr,[It,It,It],Nd],rgba:[rr,[It,It,It,It],Nd],has:{type:ln,overloads:[[[yn],(s,[i])=>mo(i.evaluate(s),s.properties())],[[yn,Oi],(s,[i,o])=>mo(i.evaluate(s),o.evaluate(s))]]},get:{type:_n,overloads:[[[yn],(s,[i])=>zd(i.evaluate(s),s.properties())],[[yn,Oi],(s,[i,o])=>zd(i.evaluate(s),o.evaluate(s))]]},"feature-state":[_n,[yn],(s,[i])=>zd(i.evaluate(s),s.featureState||{})],properties:[Oi,[],s=>s.properties()],"geometry-type":[yn,[],s=>s.geometryType()],id:[_n,[],s=>s.id()],zoom:[It,[],s=>s.globals.zoom],"heatmap-density":[It,[],s=>s.globals.heatmapDensity||0],elevation:[It,[],s=>s.globals.elevation||0],"line-progress":[It,[],s=>s.globals.lineProgress||0],accumulated:[_n,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[It,Nr(It),(s,i)=>{let o=0;for(const f of i)o+=f.evaluate(s);return o}],"*":[It,Nr(It),(s,i)=>{let o=1;for(const f of i)o*=f.evaluate(s);return o}],"-":{type:It,overloads:[[[It,It],(s,[i,o])=>i.evaluate(s)-o.evaluate(s)],[[It],(s,[i])=>-i.evaluate(s)]]},"/":[It,[It,It],(s,[i,o])=>i.evaluate(s)/o.evaluate(s)],"%":[It,[It,It],(s,[i,o])=>i.evaluate(s)%o.evaluate(s)],ln2:[It,[],()=>Math.LN2],pi:[It,[],()=>Math.PI],e:[It,[],()=>Math.E],"^":[It,[It,It],(s,[i,o])=>Math.pow(i.evaluate(s),o.evaluate(s))],sqrt:[It,[It],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[It,[It],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[It,[It],(s,[i])=>Math.log(i.evaluate(s))],log2:[It,[It],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[It,[It],(s,[i])=>Math.sin(i.evaluate(s))],cos:[It,[It],(s,[i])=>Math.cos(i.evaluate(s))],tan:[It,[It],(s,[i])=>Math.tan(i.evaluate(s))],asin:[It,[It],(s,[i])=>Math.asin(i.evaluate(s))],acos:[It,[It],(s,[i])=>Math.acos(i.evaluate(s))],atan:[It,[It],(s,[i])=>Math.atan(i.evaluate(s))],min:[It,Nr(It),(s,i)=>Math.min(...i.map(o=>o.evaluate(s)))],max:[It,Nr(It),(s,i)=>Math.max(...i.map(o=>o.evaluate(s)))],abs:[It,[It],(s,[i])=>Math.abs(i.evaluate(s))],round:[It,[It],(s,[i])=>{const o=i.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[It,[It],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[It,[It],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[ln,[yn,_n],(s,[i,o])=>s.properties()[i.value]===o.value],"filter-id-==":[ln,[_n],(s,[i])=>s.id()===i.value],"filter-type-==":[ln,[yn],(s,[i])=>s.geometryType()===i.value],"filter-<":[ln,[yn,_n],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f<_}],"filter-id-<":[ln,[_n],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o<f}],"filter->":[ln,[yn,_n],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f>_}],"filter-id->":[ln,[_n],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o>f}],"filter-<=":[ln,[yn,_n],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f<=_}],"filter-id-<=":[ln,[_n],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o<=f}],"filter->=":[ln,[yn,_n],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f>=_}],"filter-id->=":[ln,[_n],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o>=f}],"filter-has":[ln,[_n],(s,[i])=>i.value in s.properties()],"filter-has-id":[ln,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[ln,[$r(yn)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[ln,[$r(_n)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[ln,[yn,$r(_n)],(s,[i,o])=>o.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[ln,[yn,$r(_n)],(s,[i,o])=>function(f,_,x,S){for(;x<=S;){const A=x+S>>1;if(_[A]===f)return!0;_[A]>f?S=A-1:x=A+1}return!1}(s.properties()[i.value],o.value,0,o.value.length-1)],all:{type:ln,overloads:[[[ln,ln],(s,[i,o])=>i.evaluate(s)&&o.evaluate(s)],[Nr(ln),(s,i)=>{for(const o of i)if(!o.evaluate(s))return!1;return!0}]]},any:{type:ln,overloads:[[[ln,ln],(s,[i,o])=>i.evaluate(s)||o.evaluate(s)],[Nr(ln),(s,i)=>{for(const o of i)if(o.evaluate(s))return!0;return!1}]]},"!":[ln,[ln],(s,[i])=>!i.evaluate(s)],"is-supported-script":[ln,[yn],(s,[i])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(i.evaluate(s))}],upcase:[yn,[yn],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[yn,[yn],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[yn,Nr(_n),(s,i)=>i.map(o=>on(o.evaluate(s))).join("")],"resolved-locale":[yn,[rh],(s,[i])=>i.evaluate(s).resolvedLocale()]});class Mh{constructor(i,o,f){this.expression=i,this._warningHistory={},this._evaluator=new Vf,this._defaultValue=o?function(_){if(_.type==="color"&&Eh(_.default))return new xn(0,0,0,0);switch(_.type){case"color":return xn.parse(_.default)||null;case"padding":return Tr.parse(_.default)||null;case"numberArray":return Yr.parse(_.default)||null;case"colorArray":return ar.parse(_.default)||null;case"variableAnchorOffsetCollection":return Hr.parse(_.default)||null;case"projectionDefinition":return qi.parse(_.default)||null;default:return _.default===void 0?null:_.default}}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this._globalState=f}evaluateWithoutErrorHandling(i,o,f,_,x,S){return this._globalState&&(i={...i,globalState:this._globalState}),this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=f,this._evaluator.canonical=_,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(i,o,f,_,x,S){this._globalState&&(i={...i,globalState:this._globalState}),this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=f||null,this._evaluator.canonical=_,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Wn(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function Xs(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in pc}function Ss(s,i,o){const f=new Tl(pc,xa,[],i?function(x){const S={color:rr,string:yn,number:It,enum:yn,boolean:ln,formatted:Ia,padding:Gs,numberArray:Kl,colorArray:ms,projectionDefinition:fo,resolvedImage:Hi,variableAnchorOffsetCollection:Cd};return x.type==="array"?$r(S[x.value]||_n,x.length):S[x.type]}(i):void 0),_=f.parse(s,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?Sh(new Mh(_,i,o)):Cl(f.errors)}class Il{constructor(i,o,f){this.kind=i,this._styleExpression=o,this.isStateDependent=i!=="constant"&&!mc(o.expression),this.globalStateRefs=Wa(o.expression),this._globalState=f}evaluateWithoutErrorHandling(i,o,f,_,x,S){return this._globalState&&(i={...i,globalState:this._globalState}),this._styleExpression.evaluateWithoutErrorHandling(i,o,f,_,x,S)}evaluate(i,o,f,_,x,S){return this._globalState&&(i={...i,globalState:this._globalState}),this._styleExpression.evaluate(i,o,f,_,x,S)}}class cu{constructor(i,o,f,_,x){this.kind=i,this.zoomStops=f,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!mc(o.expression),this.globalStateRefs=Wa(o.expression),this.interpolationType=_,this._globalState=x}evaluateWithoutErrorHandling(i,o,f,_,x,S){return this._globalState&&(i={...i,globalState:this._globalState}),this._styleExpression.evaluateWithoutErrorHandling(i,o,f,_,x,S)}evaluate(i,o,f,_,x,S){return this._globalState&&(i={...i,globalState:this._globalState}),this._styleExpression.evaluate(i,o,f,_,x,S)}interpolationFactor(i,o,f){return this.interpolationType?Xr.interpolationFactor(this.interpolationType,i,o,f):0}}function Xa(s,i,o){const f=Ss(s,i,o);if(f.result==="error")return f;const _=f.value.expression,x=qs(_);if(!x&&!Ha(i))return Cl([new Yi("","data expressions not supported")]);const S=gc(_,["zoom"]);if(!S&&!ep(i))return Cl([new Yi("","zoom expressions not supported")]);const A=jo(_);return A||S?A instanceof Yi?Cl([A]):A instanceof Xr&&!lu(i)?Cl([new Yi("",'"interpolate" expressions cannot be used with this property')]):Sh(A?new cu(x?"camera":"composite",f.value,A.labels,A instanceof Xr?A.interpolation:void 0,o):new Il(x?"constant":"source",f.value,o)):Cl([new Yi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ia{constructor(i,o){this._parameters=i,this._specification=o,Jr(this,jd(this._parameters,this._specification))}static deserialize(i){return new ia(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function jo(s){let i=null;if(s instanceof ic)i=jo(s.result);else if(s instanceof sc){for(const o of s.args)if(i=jo(o),i)break}else(s instanceof Ki||s instanceof Xr)&&s.input instanceof Ya&&s.input.name==="zoom"&&(i=s);return i instanceof Yi||s.eachChild(o=>{const f=jo(o);f instanceof Yi?i=f:!i&&f?i=new Yi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new Yi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Wa(s,i=new Set){return s instanceof Th&&i.add(s.key),s.eachChild(o=>{Wa(o,i)}),i}function go(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!go(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Ws={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Rl(s,i){if(s==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};go(s)||(s=or(s));const o=Ss(s,Ws,i);if(o.result==="error")throw new Error(o.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,_,x)=>o.value.evaluate(f,_,{},x),needGeometry:uu(s),getGlobalStateRefs:()=>Wa(o.value.expression)}}function Ah(s,i){return s<i?-1:s>i?1:0}function uu(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let i=1;i<s.length;i++)if(uu(s[i]))return!0;return!1}function or(s){if(!s)return!0;const i=s[0];return s.length<=1?i!=="any":i==="=="?Ui(s[1],s[2],"=="):i==="!="?Qa(Ui(s[1],s[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Ui(s[1],s[2],i):i==="any"?(o=s.slice(1),["any"].concat(o.map(or))):i==="all"?["all"].concat(s.slice(1).map(or)):i==="none"?["all"].concat(s.slice(1).map(or).map(Qa)):i==="in"?Qn(s[1],s.slice(2)):i==="!in"?Qa(Qn(s[1],s.slice(2))):i==="has"?kl(s[1]):i!=="!has"||Qa(kl(s[1]));var o}function Ui(s,i,o){switch(s){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,s,i]}}function Qn(s,i){if(i.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",s,["literal",i.sort(Ah)]]:["filter-in-small",s,["literal",i]]}}function kl(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Qa(s){return["!",s]}function Ch(s){const i=typeof s;if(i==="number"||i==="boolean"||i==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let _="[";for(const x of s)_+=`${Ch(x)},`;return`${_}]`}const o=Object.keys(s).sort();let f="{";for(let _=0;_<o.length;_++)f+=`${JSON.stringify(o[_])}:${Ch(s[o[_]])},`;return`${f}}`}function yc(s){let i="";for(const o of rn)i+=`/${Ch(s[o])}`;return i}function Bd(s){const i=s.value;return i?[new wt(s.key,i,"constants have been deprecated as of v8")]:[]}function Vi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ka(s){if(Array.isArray(s))return s.map(ka);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const o in s)i[o]=ka(s[o]);return i}return Vi(s)}function ra(s){const i=s.key,o=s.value,f=s.valueSpec||{},_=s.objectElementValidators||{},x=s.style,S=s.styleSpec,A=s.validateSpec;let I=[];const O=vn(o);if(O!=="object")return[new wt(i,o,`object expected, ${O} found`)];for(const z in o){const V=z.split(".")[0],Z=tc(f,V)||f["*"];let X;if(tc(_,V))X=_[V];else if(tc(f,V))X=A;else if(_["*"])X=_["*"];else{if(!f["*"]){I.push(new wt(i,o[z],`unknown property "${z}"`));continue}X=A}I=I.concat(X({key:(i&&`${i}.`)+z,value:o[z],valueSpec:Z,style:x,styleSpec:S,object:o,objectKey:z,validateSpec:A},o))}for(const z in f)_[z]||f[z].required&&f[z].default===void 0&&o[z]===void 0&&I.push(new wt(i,o,`missing required property "${z}"`));return I}function Dh(s){const i=s.value,o=s.valueSpec,f=s.style,_=s.styleSpec,x=s.key,S=s.arrayElementValidator||s.validateSpec;if(vn(i)!=="array")return[new wt(x,i,`array expected, ${vn(i)} found`)];if(o.length&&i.length!==o.length)return[new wt(x,i,`array length ${o.length} expected, length ${i.length} found`)];if(o["min-length"]&&i.length<o["min-length"])return[new wt(x,i,`array length at least ${o["min-length"]} expected, length ${i.length} found`)];let A={type:o.value,values:o.values};_.$version<7&&(A.function=o.function),vn(o.value)==="object"&&(A=o.value);let I=[];for(let O=0;O<i.length;O++)I=I.concat(S({array:i,arrayIndex:O,value:i[O],valueSpec:A,validateSpec:s.validateSpec,style:f,styleSpec:_,key:`${x}[${O}]`}));return I}function Qs(s){const i=s.key,o=s.value,f=s.valueSpec;let _=vn(o);return _==="number"&&o!=o&&(_="NaN"),_!=="number"?[new wt(i,o,`number expected, ${_} found`)]:"minimum"in f&&o<f.minimum?[new wt(i,o,`${o} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&o>f.maximum?[new wt(i,o,`${o} is greater than the maximum value ${f.maximum}`)]:[]}function Ud(s){const i=s.valueSpec,o=Vi(s.value.type);let f,_,x,S={};const A=o!=="categorical"&&s.value.property===void 0,I=!A,O=vn(s.value.stops)==="array"&&vn(s.value.stops[0])==="array"&&vn(s.value.stops[0][0])==="object",z=ra({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(X){if(o==="identity")return[new wt(X.key,X.value,'identity function may not have a "stops" property')];let Q=[];const ae=X.value;return Q=Q.concat(Dh({key:X.key,value:ae,valueSpec:X.valueSpec,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:V})),vn(ae)==="array"&&ae.length===0&&Q.push(new wt(X.key,ae,"array must have at least one stop")),Q},default:function(X){return X.validateSpec({key:X.key,value:X.value,valueSpec:i,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec})}}});return o==="identity"&&A&&z.push(new wt(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||z.push(new wt(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!lu(s.valueSpec)&&z.push(new wt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(I&&!Ha(s.valueSpec)?z.push(new wt(s.key,s.value,"property functions not supported")):A&&!ep(s.valueSpec)&&z.push(new wt(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!O||s.value.property!==void 0||z.push(new wt(s.key,s.value,'"property" property is required')),z;function V(X){let Q=[];const ae=X.value,ce=X.key;if(vn(ae)!=="array")return[new wt(ce,ae,`array expected, ${vn(ae)} found`)];if(ae.length!==2)return[new wt(ce,ae,`array length 2 expected, length ${ae.length} found`)];if(O){if(vn(ae[0])!=="object")return[new wt(ce,ae,`object expected, ${vn(ae[0])} found`)];if(ae[0].zoom===void 0)return[new wt(ce,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new wt(ce,ae,"object stop key must have value")];if(x&&x>Vi(ae[0].zoom))return[new wt(ce,ae[0].zoom,"stop zoom values must appear in ascending order")];Vi(ae[0].zoom)!==x&&(x=Vi(ae[0].zoom),_=void 0,S={}),Q=Q.concat(ra({key:`${ce}[0]`,value:ae[0],valueSpec:{zoom:{}},validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Qs,value:Z}}))}else Q=Q.concat(Z({key:`${ce}[0]`,value:ae[0],validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec},ae));return Xs(ka(ae[1]))?Q.concat([new wt(`${ce}[1]`,ae[1],"expressions are not allowed in function stops.")]):Q.concat(X.validateSpec({key:`${ce}[1]`,value:ae[1],valueSpec:i,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec}))}function Z(X,Q){const ae=vn(X.value),ce=Vi(X.value),me=X.value!==null?X.value:Q;if(f){if(ae!==f)return[new wt(X.key,me,`${ae} stop domain type must match previous stop domain type ${f}`)]}else f=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean")return[new wt(X.key,me,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&o!=="categorical"){let ze=`number expected, ${ae} found`;return Ha(i)&&o===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wt(X.key,me,ze)]}return o!=="categorical"||ae!=="number"||isFinite(ce)&&Math.floor(ce)===ce?o!=="categorical"&&ae==="number"&&_!==void 0&&ce<_?[new wt(X.key,me,"stop domain values must appear in ascending order")]:(_=ce,o==="categorical"&&ce in S?[new wt(X.key,me,"stop domain values must be unique")]:(S[ce]=!0,[])):[new wt(X.key,me,`integer expected, found ${ce}`)]}}function Ka(s){const i=(s.expressionContext==="property"?Xa:Ss)(ka(s.value),s.valueSpec);if(i.result==="error")return i.value.map(f=>new wt(`${s.key}${f.key}`,s.value,f.message));const o=i.value.expression||i.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new wt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!mc(o))return[new wt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!mc(o))return[new wt(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!gc(o,["zoom","feature-state"]))return[new wt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!qs(o))return[new wt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yo(s){const i=s.key,o=s.value,f=vn(o);return f!=="string"?[new wt(i,o,`color expected, ${f} found`)]:xn.parse(String(o))?[]:[new wt(i,o,`color expected, "${o}" found`)]}function aa(s){const i=s.key,o=s.value,f=s.valueSpec,_=[];return Array.isArray(f.values)?f.values.indexOf(Vi(o))===-1&&_.push(new wt(i,o,`expected one of [${f.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(f.values).indexOf(Vi(o))===-1&&_.push(new wt(i,o,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(o)} found`)),_}function Fo(s){return go(ka(s.value))?Ka(Jr({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Vd(s)}function Vd(s){const i=s.value,o=s.key;if(vn(i)!=="array")return[new wt(o,i,`array expected, ${vn(i)} found`)];const f=s.styleSpec;let _,x=[];if(i.length<1)return[new wt(o,i,"filter array must have at least 1 element")];switch(x=x.concat(aa({key:`${o}[0]`,value:i[0],valueSpec:f.filter_operator,style:s.style,styleSpec:s.styleSpec})),Vi(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Vi(i[1])==="$type"&&x.push(new wt(o,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&x.push(new wt(o,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(_=vn(i[1]),_!=="string"&&x.push(new wt(`${o}[1]`,i[1],`string expected, ${_} found`)));for(let S=2;S<i.length;S++)_=vn(i[S]),Vi(i[1])==="$type"?x=x.concat(aa({key:`${o}[${S}]`,value:i[S],valueSpec:f.geometry_type,style:s.style,styleSpec:s.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&x.push(new wt(`${o}[${S}]`,i[S],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let S=1;S<i.length;S++)x=x.concat(Vd({key:`${o}[${S}]`,value:i[S],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":_=vn(i[1]),i.length!==2?x.push(new wt(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):_!=="string"&&x.push(new wt(`${o}[1]`,i[1],`string expected, ${_} found`))}return x}function Gd(s,i){const o=s.key,f=s.validateSpec,_=s.style,x=s.styleSpec,S=s.value,A=s.objectKey,I=x[`${i}_${s.layerType}`];if(!I)return[];const O=A.match(/^(.*)-transition$/);if(i==="paint"&&O&&I[O[1]]&&I[O[1]].transition)return f({key:o,value:S,valueSpec:x.transition,style:_,styleSpec:x});const z=s.valueSpec||I[A];if(!z)return[new wt(o,S,`unknown property "${A}"`)];let V;if(vn(S)==="string"&&Ha(z)&&!z.tokens&&(V=/^{([^}]+)}$/.exec(S)))return[new wt(o,S,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const Z=[];return s.layerType==="symbol"&&(A==="text-field"&&_&&!_.glyphs&&Z.push(new wt(o,S,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&Eh(ka(S))&&Vi(S.type)==="identity"&&Z.push(new wt(o,S,'"text-font" does not support identity functions'))),Z.concat(f({key:s.key,value:S,valueSpec:z,style:_,styleSpec:x,expressionContext:"property",propertyType:i,propertyKey:A}))}function hu(s){return Gd(s,"paint")}function Ih(s){return Gd(s,"layout")}function Pl(s){let i=[];const o=s.value,f=s.key,_=s.style,x=s.styleSpec;if(vn(o)!=="object")return[new wt(f,o,`object expected, ${vn(o)} found`)];o.type||o.ref||i.push(new wt(f,o,'either "type" or "ref" is required'));let S=Vi(o.type);const A=Vi(o.ref);if(o.id){const I=Vi(o.id);for(let O=0;O<s.arrayIndex;O++){const z=_.layers[O];Vi(z.id)===I&&i.push(new wt(f,o.id,`duplicate layer id "${o.id}", previously used at line ${z.id.__line__}`))}}if("ref"in o){let I;["type","source","source-layer","filter","layout"].forEach(O=>{O in o&&i.push(new wt(f,o[O],`"${O}" is prohibited for ref layers`))}),_.layers.forEach(O=>{Vi(O.id)===A&&(I=O)}),I?I.ref?i.push(new wt(f,o.ref,"ref cannot reference another ref layer")):S=Vi(I.type):i.push(new wt(f,o.ref,`ref layer "${A}" not found`))}else if(S!=="background")if(o.source){const I=_.sources&&_.sources[o.source],O=I&&Vi(I.type);I?O==="vector"&&S==="raster"?i.push(new wt(f,o.source,`layer "${o.id}" requires a raster source`)):O!=="raster-dem"&&S==="hillshade"||O!=="raster-dem"&&S==="color-relief"?i.push(new wt(f,o.source,`layer "${o.id}" requires a raster-dem source`)):O==="raster"&&S!=="raster"?i.push(new wt(f,o.source,`layer "${o.id}" requires a vector source`)):O!=="vector"||o["source-layer"]?O==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?i.push(new wt(f,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!o.paint||!o.paint["line-gradient"]||O==="geojson"&&I.lineMetrics||i.push(new wt(f,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new wt(f,o,`layer "${o.id}" must specify a "source-layer"`)):i.push(new wt(f,o.source,`source "${o.source}" not found`))}else i.push(new wt(f,o,'missing required property "source"'));return i=i.concat(ra({key:f,value:o,valueSpec:x.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${f}.type`,value:o.type,valueSpec:x.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:Fo,layout:I=>ra({layer:o,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>Ih(Jr({layerType:S},O))}}),paint:I=>ra({layer:o,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>hu(Jr({layerType:S},O))}})}})),i}function Ai(s){const i=s.value,o=s.key,f=vn(i);return f!=="string"?[new wt(o,i,`string expected, ${f} found`)]:[]}const Ks={promoteId:function({key:s,value:i}){if(vn(i)==="string")return Ai({key:s,value:i});{const o=[];for(const f in i)o.push(...Ai({key:`${s}.${f}`,value:i[f]}));return o}}};function wa(s){const i=s.value,o=s.key,f=s.styleSpec,_=s.style,x=s.validateSpec;if(!i.type)return[new wt(o,i,'"type" is required')];const S=Vi(i.type);let A;switch(S){case"vector":case"raster":return A=ra({key:o,value:i,valueSpec:f[`source_${S.replace("-","_")}`],style:s.style,styleSpec:f,objectElementValidators:Ks,validateSpec:x}),A;case"raster-dem":return A=function(I){var O;const z=(O=I.sourceName)!==null&&O!==void 0?O:"",V=I.value,Z=I.styleSpec,X=Z.source_raster_dem,Q=I.style;let ae=[];const ce=vn(V);if(V===void 0)return ae;if(ce!=="object")return ae.push(new wt("source_raster_dem",V,`object expected, ${ce} found`)),ae;const me=Vi(V.encoding)==="custom",ze=["redFactor","greenFactor","blueFactor","baseShift"],xe=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const Ie in V)!me&&ze.includes(Ie)?ae.push(new wt(Ie,V[Ie],`In "${z}": "${Ie}" is only valid when "encoding" is set to "custom". ${xe} encoding found`)):X[Ie]?ae=ae.concat(I.validateSpec({key:Ie,value:V[Ie],valueSpec:X[Ie],validateSpec:I.validateSpec,style:Q,styleSpec:Z})):ae.push(new wt(Ie,V[Ie],`unknown property "${Ie}"`));return ae}({sourceName:o,value:i,style:s.style,styleSpec:f,validateSpec:x}),A;case"geojson":if(A=ra({key:o,value:i,valueSpec:f.source_geojson,style:_,styleSpec:f,validateSpec:x,objectElementValidators:Ks}),i.cluster)for(const I in i.clusterProperties){const[O,z]=i.clusterProperties[I],V=typeof O=="string"?[O,["accumulated"],["get",I]]:O;A.push(...Ka({key:`${o}.${I}.map`,value:z,expressionContext:"cluster-map"})),A.push(...Ka({key:`${o}.${I}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return A;case"video":return ra({key:o,value:i,valueSpec:f.source_video,style:_,validateSpec:x,styleSpec:f});case"image":return ra({key:o,value:i,valueSpec:f.source_image,style:_,validateSpec:x,styleSpec:f});case"canvas":return[new wt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return aa({key:`${o}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function du(s){const i=s.value,o=s.styleSpec,f=o.light,_=s.style;let x=[];const S=vn(i);if(i===void 0)return x;if(S!=="object")return x=x.concat([new wt("light",i,`object expected, ${S} found`)]),x;for(const A in i){const I=A.match(/^(.*)-transition$/);x=x.concat(I&&f[I[1]]&&f[I[1]].transition?s.validateSpec({key:A,value:i[A],valueSpec:o.transition,validateSpec:s.validateSpec,style:_,styleSpec:o}):f[A]?s.validateSpec({key:A,value:i[A],valueSpec:f[A],validateSpec:s.validateSpec,style:_,styleSpec:o}):[new wt(A,i[A],`unknown property "${A}"`)])}return x}function ip(s){const i=s.value,o=s.styleSpec,f=o.sky,_=s.style,x=vn(i);if(i===void 0)return[];if(x!=="object")return[new wt("sky",i,`object expected, ${x} found`)];let S=[];for(const A in i)S=S.concat(f[A]?s.validateSpec({key:A,value:i[A],valueSpec:f[A],style:_,styleSpec:o}):[new wt(A,i[A],`unknown property "${A}"`)]);return S}function mm(s){const i=s.value,o=s.styleSpec,f=o.terrain,_=s.style;let x=[];const S=vn(i);if(i===void 0)return x;if(S!=="object")return x=x.concat([new wt("terrain",i,`object expected, ${S} found`)]),x;for(const A in i)x=x.concat(f[A]?s.validateSpec({key:A,value:i[A],valueSpec:f[A],validateSpec:s.validateSpec,style:_,styleSpec:o}):[new wt(A,i[A],`unknown property "${A}"`)]);return x}function mr(s){let i=[];const o=s.value,f=s.key;if(Array.isArray(o)){const _=[],x=[];for(const S in o)o[S].id&&_.includes(o[S].id)&&i.push(new wt(f,o,`all the sprites' ids must be unique, but ${o[S].id} is duplicated`)),_.push(o[S].id),o[S].url&&x.includes(o[S].url)&&i.push(new wt(f,o,`all the sprites' URLs must be unique, but ${o[S].url} is duplicated`)),x.push(o[S].url),i=i.concat(ra({key:`${f}[${S}]`,value:o[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return i}return Ai({key:f,value:o})}function Ol(s){return i=s.value,i&&i.constructor===Object?[]:[new wt(s.key,s.value,`object expected, ${vn(s.value)} found`)];var i}const _c={"*":()=>[],array:Dh,boolean:function(s){const i=s.value,o=s.key,f=vn(i);return f!=="boolean"?[new wt(o,i,`boolean expected, ${f} found`)]:[]},number:Qs,color:yo,constants:Bd,enum:aa,filter:Fo,function:Ud,layer:Pl,object:ra,source:wa,light:du,sky:ip,terrain:mm,projection:function(s){const i=s.value,o=s.styleSpec,f=o.projection,_=s.style,x=vn(i);if(i===void 0)return[];if(x!=="object")return[new wt("projection",i,`object expected, ${x} found`)];let S=[];for(const A in i)S=S.concat(f[A]?s.validateSpec({key:A,value:i[A],valueSpec:f[A],style:_,styleSpec:o}):[new wt(A,i[A],`unknown property "${A}"`)]);return S},projectionDefinition:function(s){const i=s.key;let o=s.value;o=o instanceof String?o.valueOf():o;const f=vn(o);return f!=="array"||function(_){return Array.isArray(_)&&_.length===3&&typeof _[0]=="string"&&typeof _[1]=="string"&&typeof _[2]=="number"}(o)||function(_){return!!["interpolate","step","literal"].includes(_[0])}(o)?["array","string"].includes(f)?[]:[new wt(i,o,`projection expected, invalid type "${f}" found`)]:[new wt(i,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:Ai,formatted:function(s){return Ai(s).length===0?[]:Ka(s)},resolvedImage:function(s){return Ai(s).length===0?[]:Ka(s)},padding:function(s){const i=s.key,o=s.value;if(vn(o)==="array"){if(o.length<1||o.length>4)return[new wt(i,o,`padding requires 1 to 4 values; ${o.length} values found`)];const f={type:"number"};let _=[];for(let x=0;x<o.length;x++)_=_.concat(s.validateSpec({key:`${i}[${x}]`,value:o[x],validateSpec:s.validateSpec,valueSpec:f}));return _}return Qs({key:i,value:o,valueSpec:{}})},numberArray:function(s){const i=s.key,o=s.value;if(vn(o)==="array"){const f={type:"number"};if(o.length<1)return[new wt(i,o,"array length at least 1 expected, length 0 found")];let _=[];for(let x=0;x<o.length;x++)_=_.concat(s.validateSpec({key:`${i}[${x}]`,value:o[x],validateSpec:s.validateSpec,valueSpec:f}));return _}return Qs({key:i,value:o,valueSpec:{}})},colorArray:function(s){const i=s.key,o=s.value;if(vn(o)==="array"){if(o.length<1)return[new wt(i,o,"array length at least 1 expected, length 0 found")];let f=[];for(let _=0;_<o.length;_++)f=f.concat(yo({key:`${i}[${_}]`,value:o[_]}));return f}return yo({key:i,value:o})},variableAnchorOffsetCollection:function(s){const i=s.key,o=s.value,f=vn(o),_=s.styleSpec;if(f!=="array"||o.length<1||o.length%2!=0)return[new wt(i,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let S=0;S<o.length;S+=2)x=x.concat(aa({key:`${i}[${S}]`,value:o[S],valueSpec:_.layout_symbol["text-anchor"]})),x=x.concat(Dh({key:`${i}[${S+1}]`,value:o[S+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:_}));return x},sprite:mr,state:Ol};function Es(s){const i=s.value,o=s.valueSpec,f=s.styleSpec;return s.validateSpec=Es,o.expression&&Eh(Vi(i))?Ud(s):o.expression&&Xs(ka(i))?Ka(s):o.type&&_c[o.type]?_c[o.type](s):ra(Jr({},s,{valueSpec:o.type?f[o.type]:o}))}function $d(s){const i=s.value,o=s.key,f=Ai(s);return f.length||(i.indexOf("{fontstack}")===-1&&f.push(new wt(o,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&f.push(new wt(o,i,'"glyphs" url must include a "{range}" token'))),f}function Sr(s,i=Fe){let o=[];return o=o.concat(Es({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,validateSpec:Es,objectElementValidators:{glyphs:$d,"*":()=>[]}})),s.constants&&(o=o.concat(Bd({key:"constants",value:s.constants}))),fu(o)}function oa(s){return function(i){return s({...i,validateSpec:Es})}}function fu(s){return[].concat(s).sort((i,o)=>i.line-o.line)}function _o(s){return function(...i){return fu(s.apply(this,i))}}Sr.source=_o(oa(wa)),Sr.sprite=_o(oa(mr)),Sr.glyphs=_o(oa($d)),Sr.light=_o(oa(du)),Sr.sky=_o(oa(ip)),Sr.terrain=_o(oa(mm)),Sr.state=_o(oa(Ol)),Sr.layer=_o(oa(Pl)),Sr.filter=_o(oa(Fo)),Sr.paintProperty=_o(oa(hu)),Sr.layoutProperty=_o(oa(Ih));const pu=Sr,gm=pu.light,Bo=pu.sky,rp=pu.paintProperty,Zd=pu.layoutProperty;function mu(s,i){let o=!1;if(i&&i.length)for(const f of i)s.fire(new ot(new Error(f.message))),o=!0;return o}class Js{constructor(i,o,f){const _=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const S=new Int32Array(this.arrayBuffer);i=S[0],this.d=(o=S[1])+2*(f=S[2]);for(let I=0;I<this.d*this.d;I++){const O=S[3+I],z=S[3+I+1];_.push(O===z?null:S.subarray(O,z))}const A=S[3+_.length+1];this.keys=S.subarray(S[3+_.length],A),this.bboxes=S.subarray(A),this.insert=this._insertReadonly}else{this.d=o+2*f;for(let S=0;S<this.d*this.d;S++)_.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=i,this.padding=f,this.scale=o/i,this.uid=0;const x=f/o*i;this.min=-x,this.max=i+x}insert(i,o,f,_,x){this._forEachCell(o,f,_,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,o,f,_,x,S){this.cells[x].push(S)}query(i,o,f,_,x){const S=this.min,A=this.max;if(i<=S&&o<=S&&A<=f&&A<=_&&!x)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(i,o,f,_,this._queryCell,I,{},x),I}}_queryCell(i,o,f,_,x,S,A,I){const O=this.cells[x];if(O!==null){const z=this.keys,V=this.bboxes;for(let Z=0;Z<O.length;Z++){const X=O[Z];if(A[X]===void 0){const Q=4*X;(I?I(V[Q+0],V[Q+1],V[Q+2],V[Q+3]):i<=V[Q+2]&&o<=V[Q+3]&&f>=V[Q+0]&&_>=V[Q+1])?(A[X]=!0,S.push(z[X])):A[X]=!1}}}}_forEachCell(i,o,f,_,x,S,A,I){const O=this._convertToCellCoord(i),z=this._convertToCellCoord(o),V=this._convertToCellCoord(f),Z=this._convertToCellCoord(_);for(let X=O;X<=V;X++)for(let Q=z;Q<=Z;Q++){const ae=this.d*Q+X;if((!I||I(this._convertFromCellCoord(X),this._convertFromCellCoord(Q),this._convertFromCellCoord(X+1),this._convertFromCellCoord(Q+1)))&&x.call(this,i,o,f,_,ae,S,A,I))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,o=3+this.cells.length+1+1;let f=0;for(let S=0;S<this.cells.length;S++)f+=this.cells[S].length;const _=new Int32Array(o+f+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let x=o;for(let S=0;S<i.length;S++){const A=i[S];_[3+S]=x,_.set(A,x),x+=A.length}return _[3+i.length]=x,_.set(this.keys,x),x+=this.keys.length,_[3+i.length+1]=x,_.set(this.bboxes,x),x+=this.bboxes.length,_.buffer}static serialize(i,o){const f=i.toArrayBuffer();return o&&o.push(f),{buffer:f}}static deserialize(i){return new Js(i.buffer)}}const vo={};function kt(s,i,o={}){if(vo[s])throw new Error(`${s} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:s,writeable:!1}),vo[s]={klass:i,omit:o.omit||[],shallow:o.shallow||[]}}kt("Object",Object),kt("Set",Set),kt("TransferableGridIndex",Js),kt("Color",xn),kt("Error",Error),kt("AJAXError",be),kt("ResolvedImage",qr),kt("StylePropertyFunction",ia),kt("StyleExpression",Mh,{omit:["_evaluator"]}),kt("ZoomDependentExpression",cu),kt("ZoomConstantExpression",Il),kt("CompoundExpression",Ya,{omit:["_evaluate"]});for(const s in pc)pc[s]._classRegistryKey||kt(`Expression_${s}`,pc[s]);function Rh(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function kh(s){return s.$name||s.constructor._classRegistryKey}function gu(s){return!function(i){if(i===null||typeof i!="object")return!1;const o=kh(i);return!(!o||o==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||Rh(s)||Aa(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function vc(s,i){if(gu(s))return(Rh(s)||Aa(s))&&i&&i.push(s),ArrayBuffer.isView(s)&&i&&i.push(s.buffer),s instanceof ImageData&&i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const x=[];for(const S of s)x.push(vc(S,i));return x}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const o=kh(s);if(!o)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!vo[o])throw new Error(`${o} is not registered.`);const{klass:f}=vo[o],_=f.serialize?f.serialize(s,i):{};if(f.serialize){if(i&&_===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in s){if(!s.hasOwnProperty(x)||vo[o].omit.indexOf(x)>=0)continue;const S=s[x];_[x]=vo[o].shallow.indexOf(x)>=0?S:vc(S,i)}s instanceof Error&&(_.message=s.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(_.$name=o),_}function Uo(s){if(gu(s))return s;if(Array.isArray(s))return s.map(Uo);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const i=kh(s)||"Object";if(!vo[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:o}=vo[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(s);const f=Object.create(o.prototype);for(const _ of Object.keys(s)){if(_==="$name")continue;const x=s[_];f[_]=vo[i].shallow.indexOf(_)>=0?x:Uo(x)}return f}class Ph{constructor(){this.first=!0}update(i,o){const f=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=o),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=f,!0))}}const In={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Hangul Syllables":s=>s>=44032&&s<=55215,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Vo(s){for(const i of s)if(Oh(i.charCodeAt(0)))return!0;return!1}function ap(s){for(const i of s)if(!el(i.charCodeAt(0)))return!1;return!0}function yu(s){const i=s.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(i.join("|"),"u")}const Ll=yu(["Arab","Dupl","Mong","Ougr","Syrc"]);function el(s){return!Ll.test(String.fromCodePoint(s))}const bc=yu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Oh(s){return!(s!==746&&s!==747&&(s<4352||!(In["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||In["CJK Compatibility"](s)||In["CJK Strokes"](s)||!(!In["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||In["Enclosed CJK Letters and Months"](s)||In["Ideographic Description Characters"](s)||In.Kanbun(s)||In.Katakana(s)&&s!==12540||!(!In["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!In["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||In["Vertical Forms"](s)||In["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||bc.test(String.fromCodePoint(s)))))}function Yd(s){return!(Oh(s)||function(i){return!!(In["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||In["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||In["Letterlike Symbols"](i)||In["Number Forms"](i)||In["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||In["Control Pictures"](i)&&i!==9251||In["Optical Character Recognition"](i)||In["Enclosed Alphanumerics"](i)||In["Geometric Shapes"](i)||In["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||In["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||In["CJK Symbols and Punctuation"](i)||In.Katakana(i)||In["Private Use Area"](i)||In["CJK Compatibility Forms"](i)||In["Small Form Variants"](i)||In["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(s))}const _u=yu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function xc(s){return _u.test(String.fromCodePoint(s))}function op(s,i){return!(!i&&xc(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||In.Khmer(s))}function sp(s){for(const i of s)if(xc(i.charCodeAt(0)))return!0;return!1}const sa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(sa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,i){return l(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const o=s.pluginURL,f=new Promise(x=>{this.loadScriptResolve=x});i(o);const _=new Promise(x=>setTimeout(()=>x(),this.TIMEOUT));if(yield Promise.race([f,_]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:o};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)})}};class ti{constructor(i,o){this.isSupportedScript=Hd,this.zoom=i,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new Ph,this.transition=o.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ph,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,o=i-Math.floor(i),f=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*o}}}function Hd(s){return function(i,o){for(const f of i)if(!op(f.charCodeAt(0),o))return!1;return!0}(s,sa.getRTLTextPluginStatus()==="loaded")}class vu{constructor(i,o,f){this.property=i,this.value=o,this.expression=function(_,x,S){if(Eh(_))return new ia(_,x);if(Xs(_)){const A=Xa(_,x,S);if(A.result==="error")throw new Error(A.value.map(I=>`${I.key}: ${I.message}`).join(", "));return A.value}{let A=_;return x.type==="color"&&typeof _=="string"?A=xn.parse(_):x.type!=="padding"||typeof _!="number"&&!Array.isArray(_)?x.type!=="numberArray"||typeof _!="number"&&!Array.isArray(_)?x.type!=="colorArray"||typeof _!="string"&&!Array.isArray(_)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(_)?A=Hr.parse(_):x.type==="projectionDefinition"&&typeof _=="string"&&(A=qi.parse(_)):A=ar.parse(_):A=Yr.parse(_):A=Tr.parse(_),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>A}}}(o===void 0?i.specification.default:o,i.specification,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,o,f){return this.property.possiblyEvaluate(this,i,o,f)}}class Lh{constructor(i,o){this.property=i,this.value=new vu(i,void 0,o)}transitioned(i,o){return new An(this.property,this.value,o,Wt({},i.transition,this.transition),i.now)}untransitioned(){return new An(this.property,this.value,null,{},0)}}class Ms{constructor(i,o){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._globalState=o}getValue(i){return yi(this._values[i].value.value)}setValue(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Lh(this._values[i].property,this._globalState)),this._values[i].value=new vu(this._values[i].property,o===null?void 0:yi(o),this._globalState)}getTransition(i){return yi(this._values[i].transition)}setTransition(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Lh(this._values[i].property,this._globalState)),this._values[i].transition=yi(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f);const _=this.getTransition(o);_!==void 0&&(i[`${o}-transition`]=_)}return i}transitioned(i,o){const f=new ri(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].transitioned(i,o._values[_]);return f}untransitioned(){const i=new ri(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class An{constructor(i,o,f,_,x){this.property=i,this.value=o,this.begin=x+_.delay||0,this.end=this.begin+_.duration||0,i.specification.transition&&(_.delay||_.duration)&&(this.prior=f)}possiblyEvaluate(i,o,f){const _=i.now||0,x=this.value.possiblyEvaluate(i,o,f),S=this.prior;if(S){if(_>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(_<this.begin)return S.possiblyEvaluate(i,o,f);{const A=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(i,o,f),x,pt(A))}}return x}}class ri{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,f){const _=new tl(this._properties);for(const x of Object.keys(this._values))_._values[x]=this._values[x].possiblyEvaluate(i,o,f);return _}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class gr{constructor(i,o){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._globalState=o}hasValue(i){return this._values[i].value!==void 0}getValue(i){return yi(this._values[i].value)}setValue(i,o){this._values[i]=new vu(this._values[i].property,o===null?void 0:yi(o),this._globalState)}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f)}return i}possiblyEvaluate(i,o,f){const _=new tl(this._properties);for(const x of Object.keys(this._values))_._values[x]=this._values[x].possiblyEvaluate(i,o,f);return _}}class Ja{constructor(i,o,f){this.property=i,this.value=o,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,f,_){return this.property.evaluate(this.value,this.parameters,i,o,f,_)}}class tl{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Nt{constructor(i){this.specification=i}possiblyEvaluate(i,o){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(o)}interpolate(i,o,f){const _=ws[this.specification.type];return _?_(i,o,f):i}}class qt{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,f,_){return new Ja(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},f,_)}:i.expression,o)}interpolate(i,o,f){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new Ja(this,{kind:"constant",value:void 0},i.parameters);const _=ws[this.specification.type];if(_){const x=_(i.value.value,o.value.value,f);return new Ja(this,{kind:"constant",value:x},i.parameters)}return i}evaluate(i,o,f,_,x,S){return i.kind==="constant"?i.value:i.evaluate(o,f,_,x,S)}}class eo extends qt{possiblyEvaluate(i,o,f,_){if(i.value===void 0)return new Ja(this,{kind:"constant",value:void 0},o);if(i.expression.kind==="constant"){const x=i.expression.evaluate(o,null,{},f,_),S=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,A=this._calculate(S,S,S,o);return new Ja(this,{kind:"constant",value:A},o)}if(i.expression.kind==="camera"){const x=this._calculate(i.expression.evaluate({zoom:o.zoom-1}),i.expression.evaluate({zoom:o.zoom}),i.expression.evaluate({zoom:o.zoom+1}),o);return new Ja(this,{kind:"constant",value:x},o)}return new Ja(this,i.expression,o)}evaluate(i,o,f,_,x,S){if(i.kind==="source"){const A=i.evaluate(o,f,_,x,S);return this._calculate(A,A,A,o)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(o.zoom)-1},f,_),i.evaluate({zoom:Math.floor(o.zoom)},f,_),i.evaluate({zoom:Math.floor(o.zoom)+1},f,_),o):i.value}_calculate(i,o,f,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class Nl{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,_){if(i.value!==void 0){if(i.expression.kind==="constant"){const x=i.expression.evaluate(o,null,{},f,_);return this._calculate(x,x,x,o)}return this._calculate(i.expression.evaluate(new ti(Math.floor(o.zoom-1),o)),i.expression.evaluate(new ti(Math.floor(o.zoom),o)),i.expression.evaluate(new ti(Math.floor(o.zoom+1),o)),o)}}_calculate(i,o,f,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class qd{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,_){return!!i.expression.evaluate(o,null,{},f,_)}interpolate(){return!1}}class $n{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in i){const f=i[o];f.specification.overridable&&this.overridableProperties.push(o);const _=this.defaultPropertyValues[o]=new vu(f,void 0,void 0),x=this.defaultTransitionablePropertyValues[o]=new Lh(f,void 0);this.defaultTransitioningPropertyValues[o]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=_.possiblyEvaluate({})}}}kt("DataDrivenProperty",qt),kt("DataConstantProperty",Nt),kt("CrossFadedDataDrivenProperty",eo),kt("CrossFadedProperty",Nl),kt("ColorRampProperty",qd);const Nh="-transition";class to extends jt{constructor(i,o,f){if(super(),this.id=i.id,this.type=i.type,this._globalState=f,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=Rl(i.filter,f)),o.layout&&(this._unevaluatedLayout=new gr(o.layout,f)),o.paint)){this._transitionablePaint=new Ms(o.paint,f);for(const _ in i.paint)this.setPaintProperty(_,i.paint[_],{validate:!1});for(const _ in i.layout)this.setLayoutProperty(_,i.layout[_],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new tl(o.paint)}}setFilter(i){this.filter=i,this._featureFilter=Rl(i,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[o];for(const _ of f.getGlobalStateRefs())i.add(_)}for(const o of this._featureFilter.getGlobalStateRefs())i.add(o);return i}getPaintAffectingGlobalStateRefs(){var i;const o=new globalThis.Map;if(this._transitionablePaint)for(const f in this._transitionablePaint._values){const _=this._transitionablePaint._values[f].value;for(const x of _.getGlobalStateRefs()){const S=(i=o.get(x))!==null&&i!==void 0?i:[];S.push({name:f,value:_.value}),o.set(x,S)}}return o}setLayoutProperty(i,o,f={}){o!=null&&this._validate(Zd,`layers.${this.id}.layout.${i}`,i,o,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,o):this.visibility=o)}getPaintProperty(i){return i.endsWith(Nh)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o,f={}){if(o!=null&&this._validate(rp,`layers.${this.id}.paint.${i}`,i,o,f))return!1;if(i.endsWith(Nh))return this._transitionablePaint.setTransition(i.slice(0,-11),o||void 0),!1;{const _=this._transitionablePaint._values[i],x=_.property.specification["property-type"]==="cross-faded-data-driven",S=_.value.isDataDriven(),A=_.value;this._transitionablePaint.setValue(i,o),this._handleSpecialPaintPropertyUpdate(i);const I=this._transitionablePaint._values[i].value;return I.isDataDriven()||S||x||this._handleOverridablePaintPropertyUpdate(i,A,I)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,o,f){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),ir(i,(o,f)=>!(o===void 0||f==="layout"&&!Object.keys(o).length||f==="paint"&&!Object.keys(o).length))}_validate(i,o,f,_,x={}){return(!x||x.validate!==!1)&&mu(this,i.call(pu,{key:o,layerType:this.type,objectKey:f,value:_,styleSpec:Fe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof Ja&&Ha(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const ym={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class bo{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Gi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Li(s,i=1){let o=0,f=0;return{members:s.map(_=>{const x=ym[_.type].BYTES_PER_ELEMENT,S=o=zh(o,Math.max(i,x)),A=_.components||1;return f=Math.max(f,x),o+=x*A,{name:_.name,type:_.type,components:A,offset:S}}),size:zh(o,Math.max(f,i)),alignment:i}}function zh(s,i){return Math.ceil(s/i)*i}class nl extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const _=2*i;return this.int16[_+0]=o,this.int16[_+1]=f,i}}nl.prototype.bytesPerElement=4,kt("StructArrayLayout2i4",nl);class Wr extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const x=3*i;return this.int16[x+0]=o,this.int16[x+1]=f,this.int16[x+2]=_,i}}Wr.prototype.bytesPerElement=6,kt("StructArrayLayout3i6",Wr);class Ni extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,f,_)}emplace(i,o,f,_,x){const S=4*i;return this.int16[S+0]=o,this.int16[S+1]=f,this.int16[S+2]=_,this.int16[S+3]=x,i}}Ni.prototype.bytesPerElement=8,kt("StructArrayLayout4i8",Ni);class il extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,i,o,f,_,x,S)}emplace(i,o,f,_,x,S,A){const I=6*i;return this.int16[I+0]=o,this.int16[I+1]=f,this.int16[I+2]=_,this.int16[I+3]=x,this.int16[I+4]=S,this.int16[I+5]=A,i}}il.prototype.bytesPerElement=12,kt("StructArrayLayout2i4i12",il);class wc extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,i,o,f,_,x,S)}emplace(i,o,f,_,x,S,A){const I=4*i,O=8*i;return this.int16[I+0]=o,this.int16[I+1]=f,this.uint8[O+4]=_,this.uint8[O+5]=x,this.uint8[O+6]=S,this.uint8[O+7]=A,i}}wc.prototype.bytesPerElement=8,kt("StructArrayLayout2i4ub8",wc);class rl extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const _=2*i;return this.float32[_+0]=o,this.float32[_+1]=f,i}}rl.prototype.bytesPerElement=8,kt("StructArrayLayout2f8",rl);class al extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S,A,I,O,z){const V=this.length;return this.resize(V+1),this.emplace(V,i,o,f,_,x,S,A,I,O,z)}emplace(i,o,f,_,x,S,A,I,O,z,V){const Z=10*i;return this.uint16[Z+0]=o,this.uint16[Z+1]=f,this.uint16[Z+2]=_,this.uint16[Z+3]=x,this.uint16[Z+4]=S,this.uint16[Z+5]=A,this.uint16[Z+6]=I,this.uint16[Z+7]=O,this.uint16[Z+8]=z,this.uint16[Z+9]=V,i}}al.prototype.bytesPerElement=20,kt("StructArrayLayout10ui20",al);class Go extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S,A,I,O,z,V,Z){const X=this.length;return this.resize(X+1),this.emplace(X,i,o,f,_,x,S,A,I,O,z,V,Z)}emplace(i,o,f,_,x,S,A,I,O,z,V,Z,X){const Q=12*i;return this.int16[Q+0]=o,this.int16[Q+1]=f,this.int16[Q+2]=_,this.int16[Q+3]=x,this.uint16[Q+4]=S,this.uint16[Q+5]=A,this.uint16[Q+6]=I,this.uint16[Q+7]=O,this.int16[Q+8]=z,this.int16[Q+9]=V,this.int16[Q+10]=Z,this.int16[Q+11]=X,i}}Go.prototype.bytesPerElement=24,kt("StructArrayLayout4i4ui4i24",Go);class bu extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const x=3*i;return this.float32[x+0]=o,this.float32[x+1]=f,this.float32[x+2]=_,i}}bu.prototype.bytesPerElement=12,kt("StructArrayLayout3f12",bu);class xu extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}xu.prototype.bytesPerElement=4,kt("StructArrayLayout1ul4",xu);class jh extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S,A,I,O){const z=this.length;return this.resize(z+1),this.emplace(z,i,o,f,_,x,S,A,I,O)}emplace(i,o,f,_,x,S,A,I,O,z){const V=10*i,Z=5*i;return this.int16[V+0]=o,this.int16[V+1]=f,this.int16[V+2]=_,this.int16[V+3]=x,this.int16[V+4]=S,this.int16[V+5]=A,this.uint32[Z+3]=I,this.uint16[V+8]=O,this.uint16[V+9]=z,i}}jh.prototype.bytesPerElement=20,kt("StructArrayLayout6i1ul2ui20",jh);class b extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,i,o,f,_,x,S)}emplace(i,o,f,_,x,S,A){const I=6*i;return this.int16[I+0]=o,this.int16[I+1]=f,this.int16[I+2]=_,this.int16[I+3]=x,this.int16[I+4]=S,this.int16[I+5]=A,i}}b.prototype.bytesPerElement=12,kt("StructArrayLayout2i2i2i12",b);class t extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,f,_,x)}emplace(i,o,f,_,x,S){const A=4*i,I=8*i;return this.float32[A+0]=o,this.float32[A+1]=f,this.float32[A+2]=_,this.int16[I+6]=x,this.int16[I+7]=S,i}}t.prototype.bytesPerElement=16,kt("StructArrayLayout2f1f2i16",t);class c extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,i,o,f,_,x,S)}emplace(i,o,f,_,x,S,A){const I=16*i,O=4*i,z=8*i;return this.uint8[I+0]=o,this.uint8[I+1]=f,this.float32[O+1]=_,this.float32[O+2]=x,this.int16[z+6]=S,this.int16[z+7]=A,i}}c.prototype.bytesPerElement=16,kt("StructArrayLayout2ub2f2i16",c);class p extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const x=3*i;return this.uint16[x+0]=o,this.uint16[x+1]=f,this.uint16[x+2]=_,i}}p.prototype.bytesPerElement=6,kt("StructArrayLayout3ui6",p);class v extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me){const ze=this.length;return this.resize(ze+1),this.emplace(ze,i,o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me)}emplace(i,o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me,ze){const xe=24*i,Ie=12*i,Ze=48*i;return this.int16[xe+0]=o,this.int16[xe+1]=f,this.uint16[xe+2]=_,this.uint16[xe+3]=x,this.uint32[Ie+2]=S,this.uint32[Ie+3]=A,this.uint32[Ie+4]=I,this.uint16[xe+10]=O,this.uint16[xe+11]=z,this.uint16[xe+12]=V,this.float32[Ie+7]=Z,this.float32[Ie+8]=X,this.uint8[Ze+36]=Q,this.uint8[Ze+37]=ae,this.uint8[Ze+38]=ce,this.uint32[Ie+10]=me,this.int16[xe+22]=ze,i}}v.prototype.bytesPerElement=48,kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",v);class T extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me,ze,xe,Ie,Ze,Je,ht,Dt,xt,Ct,Vt,At){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,i,o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me,ze,xe,Ie,Ze,Je,ht,Dt,xt,Ct,Vt,At)}emplace(i,o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me,ze,xe,Ie,Ze,Je,ht,Dt,xt,Ct,Vt,At,Tt){const it=32*i,Yt=16*i;return this.int16[it+0]=o,this.int16[it+1]=f,this.int16[it+2]=_,this.int16[it+3]=x,this.int16[it+4]=S,this.int16[it+5]=A,this.int16[it+6]=I,this.int16[it+7]=O,this.uint16[it+8]=z,this.uint16[it+9]=V,this.uint16[it+10]=Z,this.uint16[it+11]=X,this.uint16[it+12]=Q,this.uint16[it+13]=ae,this.uint16[it+14]=ce,this.uint16[it+15]=me,this.uint16[it+16]=ze,this.uint16[it+17]=xe,this.uint16[it+18]=Ie,this.uint16[it+19]=Ze,this.uint16[it+20]=Je,this.uint16[it+21]=ht,this.uint16[it+22]=Dt,this.uint32[Yt+12]=xt,this.float32[Yt+13]=Ct,this.float32[Yt+14]=Vt,this.uint16[it+30]=At,this.uint16[it+31]=Tt,i}}T.prototype.bytesPerElement=64,kt("StructArrayLayout8i15ui1ul2f2ui64",T);class M extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}M.prototype.bytesPerElement=4,kt("StructArrayLayout1f4",M);class R extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const x=3*i;return this.uint16[6*i+0]=o,this.float32[x+1]=f,this.float32[x+2]=_,i}}R.prototype.bytesPerElement=12,kt("StructArrayLayout1ui2f12",R);class P extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const x=4*i;return this.uint32[2*i+0]=o,this.uint16[x+2]=f,this.uint16[x+3]=_,i}}P.prototype.bytesPerElement=8,kt("StructArrayLayout1ul2ui8",P);class j extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const _=2*i;return this.uint16[_+0]=o,this.uint16[_+1]=f,i}}j.prototype.bytesPerElement=4,kt("StructArrayLayout2ui4",j);class U extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}U.prototype.bytesPerElement=2,kt("StructArrayLayout1ui2",U);class $ extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,_){const x=this.length;return this.resize(x+1),this.emplace(x,i,o,f,_)}emplace(i,o,f,_,x){const S=4*i;return this.float32[S+0]=o,this.float32[S+1]=f,this.float32[S+2]=_,this.float32[S+3]=x,i}}$.prototype.bytesPerElement=16,kt("StructArrayLayout4f16",$);class G extends bo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new E(this.anchorPointX,this.anchorPointY)}}G.prototype.size=20;class Y extends jh{get(i){return new G(this,i)}}kt("CollisionBoxArray",Y);class ee extends bo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ee.prototype.size=48;class he extends v{get(i){return new ee(this,i)}}kt("PlacedSymbolArray",he);class ue extends bo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ue.prototype.size=64;class fe extends T{get(i){return new ue(this,i)}}kt("SymbolInstanceArray",fe);class pe extends M{getoffsetX(i){return this.float32[1*i+0]}}kt("GlyphOffsetArray",pe);class ve extends Wr{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}kt("SymbolLineVertexArray",ve);class ye extends bo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ye.prototype.size=12;class Se extends R{get(i){return new ye(this,i)}}kt("TextAnchorOffsetArray",Se);class Re extends bo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Re.prototype.size=8;class _e extends P{get(i){return new Re(this,i)}}kt("FeatureIndexArray",_e);class Ne extends nl{}class We extends nl{}class Ve extends nl{}class $e extends il{}class Xe extends wc{}class Mt extends rl{}class vt extends al{}class ct extends Go{}class Bt extends bu{}class bn extends xu{}class jn extends b{}class zi extends c{}class qn extends p{}class Ci extends j{}const ji=Li([{name:"a_pos",components:2,type:"Int16"}],4),{members:pi}=ji;class un{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,o,f,_){const x=this.segments[this.segments.length-1];return i>un.MAX_VERTEX_ARRAY_LENGTH&&Vn(`Max vertices per segment is ${un.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${un.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+i>un.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==_?this.createNewSegment(o,f,_):x}createNewSegment(i,o,f){const _={vertexOffset:i.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(_.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(_),_}getOrCreateLatestSegment(i,o,f){return this.prepareSegment(0,i,o,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,f,_){return new un([{vertexOffset:i,primitiveOffset:o,vertexLength:f,primitiveLength:_,vaos:{},sortKey:0}])}}function yr(s,i){return 256*(s=Ot(Math.floor(s),0,255))+Ot(Math.floor(i),0,255)}un.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt("SegmentVector",un);const Ji=Li([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Er,Ta,zl,xo={exports:{}},wo={exports:{}},ol={exports:{}},Tc=function(){if(zl)return xo.exports;zl=1;var s=(Er||(Er=1,wo.exports=function(o,f){var _,x,S,A,I,O,z,V;for(x=o.length-(_=3&o.length),S=f,I=3432918353,O=461845907,V=0;V<x;)z=255&o.charCodeAt(V)|(255&o.charCodeAt(++V))<<8|(255&o.charCodeAt(++V))<<16|(255&o.charCodeAt(++V))<<24,++V,S=27492+(65535&(A=5*(65535&(S=(S^=z=(65535&(z=(z=(65535&z)*I+(((z>>>16)*I&65535)<<16)&4294967295)<<15|z>>>17))*O+(((z>>>16)*O&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(z=0,_){case 3:z^=(255&o.charCodeAt(V+2))<<16;case 2:z^=(255&o.charCodeAt(V+1))<<8;case 1:S^=z=(65535&(z=(z=(65535&(z^=255&o.charCodeAt(V)))*I+(((z>>>16)*I&65535)<<16)&4294967295)<<15|z>>>17))*O+(((z>>>16)*O&65535)<<16)&4294967295}return S^=o.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),wo.exports),i=(Ta||(Ta=1,ol.exports=function(o,f){for(var _,x=o.length,S=f^x,A=0;x>=4;)_=1540483477*(65535&(_=255&o.charCodeAt(A)|(255&o.charCodeAt(++A))<<8|(255&o.charCodeAt(++A))<<16|(255&o.charCodeAt(++A))<<24))+((1540483477*(_>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),x-=4,++A;switch(x){case 3:S^=(255&o.charCodeAt(A+2))<<16;case 2:S^=(255&o.charCodeAt(A+1))<<8;case 1:S=1540483477*(65535&(S^=255&o.charCodeAt(A)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),ol.exports);return xo.exports=s,xo.exports.murmur3=s,xo.exports.murmur2=i,xo.exports}(),Sc=C(Tc);class As{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,o,f,_){this.ids.push(la(i)),this.positions.push(o,f,_)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=la(i);let f=0,_=this.ids.length-1;for(;f<_;){const S=f+_>>1;this.ids[S]>=o?_=S:f=S+1}const x=[];for(;this.ids[f]===o;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(i,o){const f=new Float64Array(i.ids),_=new Uint32Array(i.positions);return $o(f,_,0,f.length-1),o&&o.push(f.buffer,_.buffer),{ids:f,positions:_}}static deserialize(i){const o=new As;return o.ids=i.ids,o.positions=i.positions,o.indexed=!0,o}}function la(s){const i=+s;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:Sc(String(s))}function $o(s,i,o,f){for(;o<f;){const _=s[o+f>>1];let x=o-1,S=f+1;for(;;){do x++;while(s[x]<_);do S--;while(s[S]>_);if(x>=S)break;Zo(s,x,S),Zo(i,3*x,3*S),Zo(i,3*x+1,3*S+1),Zo(i,3*x+2,3*S+2)}S-o<f-S?($o(s,i,o,S),o=S+1):($o(s,i,S+1,f),f=S)}}function Zo(s,i,o){const f=s[i];s[i]=s[o],s[o]=f}kt("FeaturePositionMap",As);class no{constructor(i,o){this.gl=i.gl,this.location=o}}class _i extends no{constructor(i,o){super(i,o),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Xi extends no{constructor(i,o){super(i,o),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class ca extends no{constructor(i,o){super(i,o),this.current=xn.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const er=new Float32Array(16);function wu(s){return[yr(255*s.r,255*s.g),yr(255*s.b,255*s.a)]}class Tu{constructor(i,o,f){this.value=i,this.uniformNames=o.map(_=>`u_${_}`),this.type=f}setUniform(i,o,f){i.set(f.constantOr(this.value))}getBinding(i,o,f){return this.type==="color"?new ca(i,o):new _i(i,o)}}class Ec{constructor(i,o){this.uniformNames=o.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=i.tlbr}setUniform(i,o,f,_){const x=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&i.set(x)}getBinding(i,o,f){return f.substr(0,9)==="u_pattern"?new Xi(i,o):new _i(i,o)}}class Pa{constructor(i,o,f,_){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=o.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(i,o,f){const _=this.paintVertexArray.length,x=this.expression.evaluate(new ti(0,f),o,{},f.canonical,[],f.formattedSection);this.paintVertexArray.resize(i),this._setPaintValue(_,i,x)}updatePaintArray(i,o,f,_,x){const S=this.expression.evaluate(new ti(0,x),f,_);this._setPaintValue(i,o,S)}_setPaintValue(i,o,f){if(this.type==="color"){const _=wu(f);for(let x=i;x<o;x++)this.paintVertexArray.emplace(x,_[0],_[1])}else{for(let _=i;_<o;_++)this.paintVertexArray.emplace(_,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class To{constructor(i,o,f,_,x,S){this.expression=i,this.uniformNames=o.map(A=>`u_${A}_t`),this.type=f,this.useIntegerZoom=_,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=o.map(A=>({name:`a_${A}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(i,o,f){const _=this.expression.evaluate(new ti(this.zoom,f),o,{},f.canonical,[],f.formattedSection),x=this.expression.evaluate(new ti(this.zoom+1,f),o,{},f.canonical,[],f.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(S,i,_,x)}updatePaintArray(i,o,f,_,x){const S=this.expression.evaluate(new ti(this.zoom,x),f,_),A=this.expression.evaluate(new ti(this.zoom+1,x),f,_);this._setPaintValue(i,o,S,A)}_setPaintValue(i,o,f,_){if(this.type==="color"){const x=wu(f),S=wu(_);for(let A=i;A<o;A++)this.paintVertexArray.emplace(A,x[0],x[1],S[0],S[1])}else{for(let x=i;x<o;x++)this.paintVertexArray.emplace(x,f,_);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(_))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o){const f=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,_=Ot(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(_)}getBinding(i,o,f){return new _i(i,o)}}class Mr{constructor(i,o,f,_,x,S){this.expression=i,this.type=o,this.useIntegerZoom=f,this.zoom=_,this.layerId=S,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(i,o,f){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(_,i,o.patterns&&o.patterns[this.layerId],f.imagePositions)}updatePaintArray(i,o,f,_,x){this._setPaintValues(i,o,f.patterns&&f.patterns[this.layerId],x.imagePositions)}_setPaintValues(i,o,f,_){if(!_||!f)return;const{min:x,mid:S,max:A}=f,I=_[x],O=_[S],z=_[A];if(I&&O&&z)for(let V=i;V<o;V++)this.zoomInPaintVertexArray.emplace(V,O.tl[0],O.tl[1],O.br[0],O.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],O.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(V,O.tl[0],O.tl[1],O.br[0],O.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],O.pixelRatio,z.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,Ji.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,Ji.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qr{constructor(i,o,f){this.binders={},this._buffers=[];const _=[];for(const x in i.paint._values){if(!f(x))continue;const S=i.paint.get(x);if(!(S instanceof Ja&&Ha(S.property.specification)))continue;const A=lp(x,i.type),I=S.value,O=S.property.specification.type,z=S.property.useIntegerZoom,V=S.property.specification["property-type"],Z=V==="cross-faded"||V==="cross-faded-data-driven";if(I.kind==="constant")this.binders[x]=Z?new Ec(I.value,A):new Tu(I.value,A,O),_.push(`/u_${x}`);else if(I.kind==="source"||Z){const X=Cs(x,O,"source");this.binders[x]=Z?new Mr(I,O,z,o,X,i.id):new Pa(I,A,O,X),_.push(`/a_${x}`)}else{const X=Cs(x,O,"composite");this.binders[x]=new To(I,A,O,z,o,X),_.push(`/z_${x}`)}}this.cacheKey=_.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof Pa||o instanceof To?o.maxValue:0}populatePaintArrays(i,o,f){for(const _ in this.binders){const x=this.binders[_];(x instanceof Pa||x instanceof To||x instanceof Mr)&&x.populatePaintArray(i,o,f)}}setConstantPatternPositions(i,o){for(const f in this.binders){const _=this.binders[f];_ instanceof Ec&&_.setConstantPatternPositions(i,o)}}updatePaintArrays(i,o,f,_,x){let S=!1;for(const A in i){const I=o.getPositions(A);for(const O of I){const z=f.feature(O.index);for(const V in this.binders){const Z=this.binders[V];if((Z instanceof Pa||Z instanceof To||Z instanceof Mr)&&Z.expression.isStateDependent===!0){const X=_.paint.get(V);Z.expression=X.value,Z.updatePaintArray(O.start,O.end,z,i[A],x),S=!0}}}}return S}defines(){const i=[];for(const o in this.binders){const f=this.binders[o];(f instanceof Tu||f instanceof Ec)&&i.push(...f.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Pa||f instanceof To)for(let _=0;_<f.paintVertexAttributes.length;_++)i.push(f.paintVertexAttributes[_].name);else if(f instanceof Mr)for(let _=0;_<Ji.members.length;_++)i.push(Ji.members[_].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Tu||f instanceof Ec||f instanceof To)for(const _ of f.uniformNames)i.push(_)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,o){const f=[];for(const _ in this.binders){const x=this.binders[_];if(x instanceof Tu||x instanceof Ec||x instanceof To){for(const S of x.uniformNames)if(o[S]){const A=x.getBinding(i,o[S],S);f.push({name:S,property:_,binding:A})}}}return f}setUniforms(i,o,f,_){for(const{name:x,property:S,binding:A}of o)this.binders[S].setUniform(A,_,f.get(S),x)}updatePaintBuffers(i){this._buffers=[];for(const o in this.binders){const f=this.binders[o];if(i&&f instanceof Mr){const _=i.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(f instanceof Pa||f instanceof To)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(i){for(const o in this.binders){const f=this.binders[o];(f instanceof Pa||f instanceof To||f instanceof Mr)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof Pa||o instanceof To||o instanceof Mr)&&o.destroy()}}}class Sa{constructor(i,o,f=()=>!0){this.programConfigurations={};for(const _ of i)this.programConfigurations[_.id]=new Qr(_,o,f);this.needsUpload=!1,this._featureMap=new As,this._bufferOffset=0}populatePaintArrays(i,o,f,_){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(i,o,_);o.id!==void 0&&this._featureMap.add(o.id,f,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,f,_){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(i,this._featureMap,o,x,_)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function lp(s,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}function Cs(s,i,o){const f={color:{source:rl,composite:$},number:{source:M,composite:rl}},_=function(x){return{"line-pattern":{source:vt,composite:vt},"fill-pattern":{source:vt,composite:vt},"fill-extrusion-pattern":{source:vt,composite:vt}}[x]}(s);return _&&_[o]||f[i][o]}kt("ConstantBinder",Tu),kt("CrossFadedConstantBinder",Ec),kt("SourceExpressionBinder",Pa),kt("CrossFadedCompositeBinder",Mr),kt("CompositeExpressionBinder",To),kt("ProgramConfiguration",Qr,{omit:["_buffers"]}),kt("ProgramConfigurationSet",Sa);const io=Math.pow(2,14)-1,sr=-io-1;function So(s){const i=ut/s.extent,o=s.loadGeometry();for(let f=0;f<o.length;f++){const _=o[f];for(let x=0;x<_.length;x++){const S=_[x],A=Math.round(S.x*i),I=Math.round(S.y*i);S.x=Ot(A,sr,io),S.y=Ot(I,sr,io),(A<S.x||A>S.x+1||I<S.y||I>S.y+1)&&Vn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Mc(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?So(s):[]}}const _m=-32768;function g_(s,i,o,f,_){s.emplaceBack(_m+8*i+f,_m+8*o+_)}class vm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new We,this.indexArray=new qn,this.segments=new un,this.programConfigurations=new Sa(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){const _=this.layers[0],x=[];let S=null,A=!1,I=_.type==="heatmap";if(_.type==="circle"){const z=_;S=z.layout.get("circle-sort-key"),A=!S.isConstant(),I=I||z.paint.get("circle-pitch-alignment")==="map"}const O=I?o.subdivisionGranularity.circle:1;for(const{feature:z,id:V,index:Z,sourceLayerIndex:X}of i){const Q=this.layers[0]._featureFilter.needGeometry,ae=Mc(z,Q);if(!this.layers[0]._featureFilter.filter(new ti(this.zoom),ae,f))continue;const ce=A?S.evaluate(ae,{},f):void 0,me={id:V,properties:z.properties,type:z.type,sourceLayerIndex:X,index:Z,geometry:Q?ae.geometry:So(z),patterns:{},sortKey:ce};x.push(me)}A&&x.sort((z,V)=>z.sortKey-V.sortKey);for(const z of x){const{geometry:V,index:Z,sourceLayerIndex:X}=z,Q=i[Z].feature;this.addFeature(z,V,Z,f,O),o.featureIndex.insert(Q,V,Z,X,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,pi),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,f,_,x=1){let S;switch(x){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const A=S.length;for(const I of o)for(const O of I){const z=O.x,V=O.y;if(z<0||z>=ut||V<0||V>=ut)continue;const Z=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,i.sortKey),X=Z.vertexLength;for(let Q=0;Q<A;Q++)for(let ae=0;ae<A;ae++)g_(this.layoutVertexArray,z,V,S[ae],S[Q]);for(let Q=0;Q<A-1;Q++)for(let ae=0;ae<A-1;ae++){const ce=X+Q*A+ae,me=X+(Q+1)*A+ae;this.indexArray.emplaceBack(ce,me+1,ce+1),this.indexArray.emplaceBack(ce,me,me+1)}Z.vertexLength+=A*A,Z.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:{},canonical:_})}}function Su(s,i){for(let o=0;o<s.length;o++)if(Bh(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(Bh(s,i[o]))return!0;return!!bm(s,i)}function Fh(s,i,o){return!!Bh(s,i)||!!wm(i,s,o)}function cy(s,i){if(s.length===1)return uy(i,s[0]);for(let o=0;o<i.length;o++){const f=i[o];for(let _=0;_<f.length;_++)if(Bh(s,f[_]))return!0}for(let o=0;o<s.length;o++)if(uy(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(bm(s,i[o]))return!0;return!1}function y_(s,i,o){if(s.length>1){if(bm(s,i))return!0;for(let f=0;f<i.length;f++)if(wm(i[f],s,o))return!0}for(let f=0;f<s.length;f++)if(wm(s[f],i,o))return!0;return!1}function bm(s,i){if(s.length===0||i.length===0)return!1;for(let o=0;o<s.length-1;o++){const f=s[o],_=s[o+1];for(let x=0;x<i.length-1;x++)if(xm(f,_,i[x],i[x+1]))return!0}return!1}function xm(s,i,o,f){return Dn(s,o,f)!==Dn(i,o,f)&&Dn(s,i,o)!==Dn(s,i,f)}function wm(s,i,o){const f=o*o;if(i.length===1)return s.distSqr(i[0])<f;for(let _=1;_<i.length;_++)if(Tm(s,i[_-1],i[_])<f)return!0;return!1}function Tm(s,i,o){const f=i.distSqr(o);if(f===0)return s.distSqr(i);const _=((s.x-i.x)*(o.x-i.x)+(s.y-i.y)*(o.y-i.y))/f;return s.distSqr(_<0?i:_>1?o:o.sub(i)._mult(_)._add(i))}function uy(s,i){let o,f,_,x=!1;for(let S=0;S<s.length;S++){o=s[S];for(let A=0,I=o.length-1;A<o.length;I=A++)f=o[A],_=o[I],f.y>i.y!=_.y>i.y&&i.x<(_.x-f.x)*(i.y-f.y)/(_.y-f.y)+f.x&&(x=!x)}return x}function Bh(s,i){let o=!1;for(let f=0,_=s.length-1;f<s.length;_=f++){const x=s[f],S=s[_];x.y>i.y!=S.y>i.y&&i.x<(S.x-x.x)*(i.y-x.y)/(S.y-x.y)+x.x&&(o=!o)}return o}function Lb(s,i,o){const f=o[0],_=o[2];if(s.x<f.x&&i.x<f.x||s.x>_.x&&i.x>_.x||s.y<f.y&&i.y<f.y||s.y>_.y&&i.y>_.y)return!1;const x=Dn(s,i,o[0]);return x!==Dn(s,i,o[1])||x!==Dn(s,i,o[2])||x!==Dn(s,i,o[3])}function Uh(s,i,o){const f=i.paint.get(s).value;return f.kind==="constant"?f.value:o.programConfigurations.get(i.id).getMaxValue(s)}function Ar(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function zr(s,i,o,f,_){if(!i[0]&&!i[1])return s;const x=E.convert(i)._mult(_);o==="viewport"&&x._rotate(-f);const S=[];for(let A=0;A<s.length;A++)S.push(s[A].sub(x));return S}function __({queryGeometry:s,size:i},o){return Fh(s,o,i)}function v_({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_},x){return Fh(s,x,i*(o.projectTileCoordinates(x.x,x.y,f,_).signedDistanceFromCamera/o.cameraToCenterDistance))}function b_({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_},x){const S=o.projectTileCoordinates(x.x,x.y,f,_).signedDistanceFromCamera,A=i*(o.cameraToCenterDistance/S);return Fh(s,Xd(x,o,f,_),A)}function x_({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_},x){return Fh(s,Xd(x,o,f,_),i)}function hy({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_,pitchAlignment:x="map",pitchScale:S="map"},A){const I=x==="map"?S==="map"?__:v_:S==="map"?b_:x_,O={queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_};for(const z of A)for(const V of z)if(I(O,V))return!0;return!1}function Xd(s,i,o,f){const _=i.projectTileCoordinates(s.x,s.y,o,f).point;return new E((.5*_.x+.5)*i.width,(.5*-_.y+.5)*i.height)}let Sm,dy;kt("CircleBucket",vm,{omit:["layers"]});var w_={get paint(){return dy=dy||new $n({"circle-radius":new qt(Fe.paint_circle["circle-radius"]),"circle-color":new qt(Fe.paint_circle["circle-color"]),"circle-blur":new qt(Fe.paint_circle["circle-blur"]),"circle-opacity":new qt(Fe.paint_circle["circle-opacity"]),"circle-translate":new Nt(Fe.paint_circle["circle-translate"]),"circle-translate-anchor":new Nt(Fe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nt(Fe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nt(Fe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(Fe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(Fe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(Fe.paint_circle["circle-stroke-opacity"])})},get layout(){return Sm=Sm||new $n({"circle-sort-key":new qt(Fe.layout_circle["circle-sort-key"])})}};class T_ extends to{constructor(i,o){super(i,w_,o)}createBucket(i){return new vm(i)}queryRadius(i){const o=i;return Uh("circle-radius",this,o)+Uh("circle-stroke-width",this,o)+Ar(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:x,pixelsToTileUnits:S,unwrappedTileID:A,getElevation:I}){const O=zr(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,S),z=this.paint.get("circle-radius").evaluate(o,f)+this.paint.get("circle-stroke-width").evaluate(o,f),V=this.paint.get("circle-pitch-scale"),Z=this.paint.get("circle-pitch-alignment");let X,Q;return Z==="map"?(X=O,Q=z*S):(X=function(ae,ce,me,ze){return ae.map(xe=>Xd(xe,ce,me,ze))}(O,x,A,I),Q=z),hy({queryGeometry:X,size:Q,transform:x,unwrappedTileID:A,getElevation:I,pitchAlignment:Z,pitchScale:V},_)}}class Em extends vm{}let Mm;kt("HeatmapBucket",Em,{omit:["layers"]});var fy={get paint(){return Mm=Mm||new $n({"heatmap-radius":new qt(Fe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(Fe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nt(Fe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qd(Fe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nt(Fe.paint_heatmap["heatmap-opacity"])})}};function Am(s,{width:i,height:o},f,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==i*o*f)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${i*o*f}`)}else _=new Uint8Array(i*o*f);return s.width=i,s.height=o,s.data=_,s}function Cm(s,{width:i,height:o},f){if(i===s.width&&o===s.height)return;const _=Am({},{width:i,height:o},f);Wd(s,_,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,i),height:Math.min(s.height,o)},f),s.width=i,s.height=o,s.data=_.data}function Wd(s,i,o,f,_,x){if(_.width===0||_.height===0)return i;if(_.width>s.width||_.height>s.height||o.x>s.width-_.width||o.y>s.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>i.width||_.height>i.height||f.x>i.width-_.width||f.y>i.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const S=s.data,A=i.data;if(S===A)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<_.height;I++){const O=((o.y+I)*s.width+o.x)*x,z=((f.y+I)*i.width+f.x)*x;for(let V=0;V<_.width*x;V++)A[z+V]=S[O+V]}return i}class Vh{constructor(i,o){Am(this,i,1,o)}resize(i){Cm(this,i,1)}clone(){return new Vh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,_,x){Wd(i,o,f,_,x,1)}}class Oa{constructor(i,o){Am(this,i,4,o)}resize(i){Cm(this,i,4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,_,x){Wd(i,o,f,_,x,4)}setPixel(i,o,f){const _=4*(i*this.width+o);this.data[_+0]=Math.round(255*f.r/f.a),this.data[_+1]=Math.round(255*f.g/f.a),this.data[_+2]=Math.round(255*f.b/f.a),this.data[_+3]=Math.round(255*f.a)}}function Dm(s){const i={},o=s.resolution||256,f=s.clips?s.clips.length:1,_=s.image||new Oa({width:o,height:f});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const x=(S,A,I)=>{i[s.evaluationKey]=I;const O=s.expression.evaluate(i);_.setPixel(S/4/o,A/4,O)};if(s.clips)for(let S=0,A=0;S<f;++S,A+=4*o)for(let I=0,O=0;I<o;I++,O+=4){const z=I/(o-1),{start:V,end:Z}=s.clips[S];x(A,O,V*(1-z)+Z*z)}else for(let S=0,A=0;S<o;S++,A+=4)x(0,A,S/(o-1));return _}kt("AlphaImage",Vh),kt("RGBAImage",Oa);const Im="big-fb";class Ac extends to{createBucket(i){return new Em(i)}constructor(i,o){super(i,fy,o),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Dm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Im)&&this.heatmapFbos.delete(Im)}queryRadius(i){return Uh("heatmap-radius",this,i)}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:x,pixelsToTileUnits:S,unwrappedTileID:A,getElevation:I}){return hy({queryGeometry:i,size:this.paint.get("heatmap-radius").evaluate(o,f)*S,transform:x,unwrappedTileID:A,getElevation:I},_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Rm;var Nb={get paint(){return Rm=Rm||new $n({"hillshade-illumination-direction":new Nt(Fe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Nt(Fe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Nt(Fe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nt(Fe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nt(Fe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nt(Fe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nt(Fe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Nt(Fe.paint_hillshade["hillshade-method"])})}};class S_ extends to{constructor(i,o){super(i,Nb,o),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,_=this.paint.get("hillshade-shadow-color").values;const x=Math.max(i.length,o.length,f.length,_.length);i=i.concat(Array(x-i.length).fill(i.at(-1))),o=o.concat(Array(x-o.length).fill(o.at(-1))),f=f.concat(Array(x-f.length).fill(f.at(-1))),_=_.concat(Array(x-_.length).fill(_.at(-1)));const S=o.map(Da);return{directionRadians:i.map(Da),altitudeRadians:S,shadowColor:_,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let jl;var E_={get paint(){return jl=jl||new $n({"color-relief-opacity":new Nt(Fe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new qd(Fe["paint_color-relief"]["color-relief-color"])})}};class Qd{constructor(i,o,f,_){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(o,_)}update(i,o,f){const{width:_,height:x}=i,S=!(this.size&&this.size[0]===_&&this.size[1]===x||f),{context:A}=this,{gl:I}=A;if(this.useMipmap=!!(o&&o.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!o||o.premultiply!==!1)),S)this.size=[_,x],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Aa(i)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,i):I.texImage2D(I.TEXTURE_2D,0,this.format,_,x,0,this.format,I.UNSIGNED_BYTE,i.data);else{const{x:O,y:z}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Aa(i)?I.texSubImage2D(I.TEXTURE_2D,0,O,z,I.RGBA,I.UNSIGNED_BYTE,i):I.texSubImage2D(I.TEXTURE_2D,0,O,z,_,x,I.RGBA,I.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,o,f){const{context:_}=this,{gl:x}=_;x.bindTexture(x.TEXTURE_2D,this.texture),f!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=x.LINEAR),i!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,i),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,f||i),this.filter=i),o!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,o),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Kd{constructor(i,o,f,_=1,x=1,S=1,A=0){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Vn(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const I=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=x,this.blueFactor=S,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let O=0;O<I;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(I,O)]=this.data[this._idx(I-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,I)]=this.data[this._idx(O,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<I;O++)for(let z=0;z<I;z++){const V=this.get(O,z);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(i,o){const f=new Uint8Array(this.data.buffer),_=4*this._idx(i,o);return this.unpack(f[_],f[_+1],f[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}unpack(i,o,f){return i*this.redFactor+o*this.greenFactor+f*this.blueFactor-this.baseShift}pack(i){return tr(i,this.getUnpackVector())}getPixels(){return new Oa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,o,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let _=o*this.dim,x=o*this.dim+this.dim,S=f*this.dim,A=f*this.dim+this.dim;switch(o){case-1:_=x-1;break;case 1:x=_+1}switch(f){case-1:S=A-1;break;case 1:A=S+1}const I=-o*this.dim,O=-f*this.dim;for(let z=S;z<A;z++)for(let V=_;V<x;V++)this.data[this._idx(V,z)]=i.data[this._idx(V+I,z+O)]}}function tr(s,i){const o=i[0],f=i[1],_=i[2],x=i[3],S=Math.min(o,f,_),A=Math.round((s+x)/S);return{r:Math.floor(A*S/o)%256,g:Math.floor(A*S/f)%256,b:Math.floor(A*S/_)%256}}kt("DEMData",Kd);class zb extends to{constructor(i,o){super(i,E_,o)}_createColorRamp(i){const o={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof Il&&f._styleExpression.expression instanceof Xr){this.colorRampExpression=f;const S=f._styleExpression.expression;o.elevationStops=S.labels,o.colorStops=[];for(const A of o.elevationStops)o.colorStops.push(S.evaluate({globals:{elevation:A}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[xn.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=i)return o;const _={elevationStops:[],colorStops:[]},x=(o.elevationStops.length-1)/(i-1);for(let S=0;S<o.elevationStops.length-.5;S+=x)_.elevationStops.push(o.elevationStops[Math.round(S)]),_.colorStops.push(o.colorStops[Math.round(S)]);return Vn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),_}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,o,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const _=this._createColorRamp(o),x=new Oa({width:_.colorStops.length,height:1}),S=new Oa({width:_.colorStops.length,height:1});for(let A=0;A<_.elevationStops.length;A++){const I=tr(_.elevationStops[A],f);S.setPixel(0,A,new xn(I.r/255,I.g/255,I.b/255,1)),x.setPixel(0,A,_.colorStops[A])}return this.colorRampTextures={elevationTexture:new Qd(i,S,i.gl.RGBA),colorTexture:new Qd(i,x,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const jb=Li([{name:"a_pos",components:2,type:"Int16"}],4),{members:M_}=jb;function Gh(s,i,o){const f=o.patternDependencies;let _=!1;for(const x of i){const S=x.paint.get(`${s}-pattern`);S.isConstant()||(_=!0);const A=S.constantOr(null);A&&(_=!0,f[A.to]=!0,f[A.from]=!0)}return _}function Fl(s,i,o,f,_){const{zoom:x}=f,S=_.patternDependencies;for(const A of i){const I=A.paint.get(`${s}-pattern`).value;if(I.kind!=="constant"){let O=I.evaluate({zoom:x-1},o,{},_.availableImages),z=I.evaluate({zoom:x},o,{},_.availableImages),V=I.evaluate({zoom:x+1},o,{},_.availableImages);O=O&&O.name?O.name:O,z=z&&z.name?z.name:z,V=V&&V.name?V.name:V,S[O]=!0,S[z]=!0,S[V]=!0,o.patterns[A.id]={min:O,mid:z,max:V}}}return o}function py(s,i,o,f,_){let x;if(_===function(S,A,I,O){let z=0;for(let V=A,Z=I-O;V<I;V+=O)z+=(S[Z]-S[V])*(S[V+1]+S[Z+1]),Z=V;return z}(s,i,o,f)>0)for(let S=i;S<o;S+=f)x=vy(S/f|0,s[S],s[S+1],x);else for(let S=o-f;S>=i;S-=f)x=vy(S/f|0,s[S],s[S+1],x);return x&&Jd(x,x.next)&&(ef(x),x=x.next),x}function Eu(s,i){if(!s)return s;i||(i=s);let o,f=s;do if(o=!1,f.steiner||!Jd(f,f.next)&&On(f.prev,f,f.next)!==0)f=f.next;else{if(ef(f),f=i=f.prev,f===f.next)break;o=!0}while(o||f!==i);return i}function Cc(s,i,o,f,_,x,S){if(!s)return;!S&&x&&function(I,O,z,V){let Z=I;do Z.z===0&&(Z.z=Pm(Z.x,Z.y,O,z,V)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==I);Z.prevZ.nextZ=null,Z.prevZ=null,function(X){let Q,ae=1;do{let ce,me=X;X=null;let ze=null;for(Q=0;me;){Q++;let xe=me,Ie=0;for(let Je=0;Je<ae&&(Ie++,xe=xe.nextZ,xe);Je++);let Ze=ae;for(;Ie>0||Ze>0&&xe;)Ie!==0&&(Ze===0||!xe||me.z<=xe.z)?(ce=me,me=me.nextZ,Ie--):(ce=xe,xe=xe.nextZ,Ze--),ze?ze.nextZ=ce:X=ce,ce.prevZ=ze,ze=ce;me=xe}ze.nextZ=null,ae*=2}while(Q>1)}(Z)}(s,f,_,x);let A=s;for(;s.prev!==s.next;){const I=s.prev,O=s.next;if(x?A_(s,f,_,x):Bl(s))i.push(I.i,s.i,O.i),ef(s),s=O.next,A=O.next;else if((s=O)===A){S?S===1?Cc(s=my(Eu(s),i),i,o,f,_,x,2):S===2&&C_(s,i,o,f,_,x):Cc(Eu(s),i,o,f,_,x,1);break}}}function Bl(s){const i=s.prev,o=s,f=s.next;if(On(i,o,f)>=0)return!1;const _=i.x,x=o.x,S=f.x,A=i.y,I=o.y,O=f.y,z=Math.min(_,x,S),V=Math.min(A,I,O),Z=Math.max(_,x,S),X=Math.max(A,I,O);let Q=f.next;for(;Q!==i;){if(Q.x>=z&&Q.x<=Z&&Q.y>=V&&Q.y<=X&&$h(_,A,x,I,S,O,Q.x,Q.y)&&On(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function A_(s,i,o,f){const _=s.prev,x=s,S=s.next;if(On(_,x,S)>=0)return!1;const A=_.x,I=x.x,O=S.x,z=_.y,V=x.y,Z=S.y,X=Math.min(A,I,O),Q=Math.min(z,V,Z),ae=Math.max(A,I,O),ce=Math.max(z,V,Z),me=Pm(X,Q,i,o,f),ze=Pm(ae,ce,i,o,f);let xe=s.prevZ,Ie=s.nextZ;for(;xe&&xe.z>=me&&Ie&&Ie.z<=ze;){if(xe.x>=X&&xe.x<=ae&&xe.y>=Q&&xe.y<=ce&&xe!==_&&xe!==S&&$h(A,z,I,V,O,Z,xe.x,xe.y)&&On(xe.prev,xe,xe.next)>=0||(xe=xe.prevZ,Ie.x>=X&&Ie.x<=ae&&Ie.y>=Q&&Ie.y<=ce&&Ie!==_&&Ie!==S&&$h(A,z,I,V,O,Z,Ie.x,Ie.y)&&On(Ie.prev,Ie,Ie.next)>=0))return!1;Ie=Ie.nextZ}for(;xe&&xe.z>=me;){if(xe.x>=X&&xe.x<=ae&&xe.y>=Q&&xe.y<=ce&&xe!==_&&xe!==S&&$h(A,z,I,V,O,Z,xe.x,xe.y)&&On(xe.prev,xe,xe.next)>=0)return!1;xe=xe.prevZ}for(;Ie&&Ie.z<=ze;){if(Ie.x>=X&&Ie.x<=ae&&Ie.y>=Q&&Ie.y<=ce&&Ie!==_&&Ie!==S&&$h(A,z,I,V,O,Z,Ie.x,Ie.y)&&On(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.nextZ}return!0}function my(s,i){let o=s;do{const f=o.prev,_=o.next.next;!Jd(f,_)&&_y(f,o,o.next,_)&&ua(f,_)&&ua(_,f)&&(i.push(f.i,o.i,_.i),ef(o),ef(o.next),o=s=_),o=o.next}while(o!==s);return Eu(o)}function C_(s,i,o,f,_,x){let S=s;do{let A=S.next.next;for(;A!==S.prev;){if(S.i!==A.i&&D_(S,A)){let I=Ul(S,A);return S=Eu(S,S.next),I=Eu(I,I.next),Cc(S,i,o,f,_,x,0),void Cc(I,i,o,f,_,x,0)}A=A.next}S=S.next}while(S!==s)}function gy(s,i){let o=s.x-i.x;return o===0&&(o=s.y-i.y,o===0)&&(o=(s.next.y-s.y)/(s.next.x-s.x)-(i.next.y-i.y)/(i.next.x-i.x)),o}function yy(s,i){const o=function(_,x){let S=x;const A=_.x,I=_.y;let O,z=-1/0;if(Jd(_,S))return S;do{if(Jd(_,S.next))return S.next;if(I<=S.y&&I>=S.next.y&&S.next.y!==S.y){const ae=S.x+(I-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(ae<=A&&ae>z&&(z=ae,O=S.x<S.next.x?S:S.next,ae===A))return O}S=S.next}while(S!==x);if(!O)return null;const V=O,Z=O.x,X=O.y;let Q=1/0;S=O;do{if(A>=S.x&&S.x>=Z&&A!==S.x&&_r(I<X?A:z,I,Z,X,I<X?z:A,I,S.x,S.y)){const ae=Math.abs(I-S.y)/(A-S.x);ua(S,_)&&(ae<Q||ae===Q&&(S.x>O.x||S.x===O.x&&km(O,S)))&&(O=S,Q=ae)}S=S.next}while(S!==V);return O}(s,i);if(!o)return i;const f=Ul(o,s);return Eu(f,f.next),Eu(o,o.next)}function km(s,i){return On(s.prev,s,i.prev)<0&&On(i.next,s,s.next)<0}function Pm(s,i,o,f,_){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*_|0)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*_|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Dc(s){let i=s,o=s;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==s);return o}function _r(s,i,o,f,_,x,S,A){return(_-S)*(i-A)>=(s-S)*(x-A)&&(s-S)*(f-A)>=(o-S)*(i-A)&&(o-S)*(x-A)>=(_-S)*(f-A)}function $h(s,i,o,f,_,x,S,A){return!(s===S&&i===A)&&_r(s,i,o,f,_,x,S,A)}function D_(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(o,f){let _=o;do{if(_.i!==o.i&&_.next.i!==o.i&&_.i!==f.i&&_.next.i!==f.i&&_y(_,_.next,o,f))return!0;_=_.next}while(_!==o);return!1}(s,i)&&(ua(s,i)&&ua(i,s)&&function(o,f){let _=o,x=!1;const S=(o.x+f.x)/2,A=(o.y+f.y)/2;do _.y>A!=_.next.y>A&&_.next.y!==_.y&&S<(_.next.x-_.x)*(A-_.y)/(_.next.y-_.y)+_.x&&(x=!x),_=_.next;while(_!==o);return x}(s,i)&&(On(s.prev,s,i.prev)||On(s,i.prev,i))||Jd(s,i)&&On(s.prev,s,s.next)>0&&On(i.prev,i,i.next)>0)}function On(s,i,o){return(i.y-s.y)*(o.x-i.x)-(i.x-s.x)*(o.y-i.y)}function Jd(s,i){return s.x===i.x&&s.y===i.y}function _y(s,i,o,f){const _=Fi(On(s,i,o)),x=Fi(On(s,i,f)),S=Fi(On(o,f,s)),A=Fi(On(o,f,i));return _!==x&&S!==A||!(_!==0||!cp(s,o,i))||!(x!==0||!cp(s,f,i))||!(S!==0||!cp(o,s,f))||!(A!==0||!cp(o,i,f))}function cp(s,i,o){return i.x<=Math.max(s.x,o.x)&&i.x>=Math.min(s.x,o.x)&&i.y<=Math.max(s.y,o.y)&&i.y>=Math.min(s.y,o.y)}function Fi(s){return s>0?1:s<0?-1:0}function ua(s,i){return On(s.prev,s,s.next)<0?On(s,i,s.next)>=0&&On(s,s.prev,i)>=0:On(s,i,s.prev)<0||On(s,s.next,i)<0}function Ul(s,i){const o=by(s.i,s.x,s.y),f=by(i.i,i.x,i.y),_=s.next,x=i.prev;return s.next=i,i.prev=s,o.next=_,_.prev=o,f.next=o,o.prev=f,x.next=f,f.prev=x,f}function vy(s,i,o,f){const _=by(s,i,o);return f?(_.next=f.next,_.prev=f,f.next.prev=_,f.next=_):(_.prev=_,_.next=_),_}function ef(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function by(s,i,o){return{i:s,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Mu{constructor(i,o){if(o>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=o}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class La{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}La.noSubdivision=new La({fill:new Mu(0,0),line:new Mu(0,0),tile:new Mu(0,0),stencil:new Mu(0,0),circle:1}),kt("SubdivisionGranularityExpression",Mu),kt("SubdivisionGranularitySetting",La);const Na=-32768,tf=32767;class Yo{constructor(i,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=ut/i,this._canonical=o}_getKey(i,o){return(i+=32768)<<16|o+32768}_vertexToIndex(i,o){if(i<-32768||o<-32768||i>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(i),_=0|Math.round(o),x=this._getKey(f,_);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,S),this._vertexBuffer.push(f,_),S}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(_,x){const S=[];for(let A=0;A<x.length;A+=3){const I=x[A],O=x[A+1],z=x[A+2],V=_[2*I],Z=_[2*I+1];(_[2*O]-V)*(_[2*z+1]-Z)-(_[2*O+1]-Z)*(_[2*z]-V)>0?(S.push(I),S.push(z),S.push(O)):(S.push(I),S.push(O),S.push(z))}return S}(this._vertexBuffer,i);const o=[],f=i.length;for(let _=0;_<f;_+=3){const x=[i[_+0],i[_+1],i[_+2]],S=[this._vertexBuffer[2*i[_+0]+0],this._vertexBuffer[2*i[_+0]+1],this._vertexBuffer[2*i[_+1]+0],this._vertexBuffer[2*i[_+1]+1],this._vertexBuffer[2*i[_+2]+0],this._vertexBuffer[2*i[_+2]+1]];let A=1/0,I=1/0,O=-1/0,z=-1/0;for(let ae=0;ae<3;ae++){const ce=S[2*ae],me=S[2*ae+1];A=Math.min(A,ce),O=Math.max(O,ce),I=Math.min(I,me),z=Math.max(z,me)}if(A===O||I===z)continue;const V=Math.floor(A/this._granularityCellSize),Z=Math.ceil(O/this._granularityCellSize),X=Math.floor(I/this._granularityCellSize),Q=Math.ceil(z/this._granularityCellSize);if(V!==Z||X!==Q)for(let ae=X;ae<Q;ae++){const ce=this._scanlineGenerateVertexRingForCellRow(ae,S,x);Zh(this._vertexBuffer,ce,o)}else o.push(...x)}return o}_scanlineGenerateVertexRingForCellRow(i,o,f){const _=i*this._granularityCellSize,x=_+this._granularityCellSize,S=[];for(let A=0;A<3;A++){const I=o[2*A],O=o[2*A+1],z=o[2*(A+1)%6],V=o[(2*(A+1)+1)%6],Z=o[2*(A+2)%6],X=o[(2*(A+2)+1)%6],Q=z-I,ae=V-O,ce=Q===0,me=ae===0,ze=(_-O)/ae,xe=(x-O)/ae,Ie=Math.min(ze,xe),Ze=Math.max(ze,xe);if(!me&&(Ie>=1||Ze<=0)||me&&(O<_||O>x)){V>=_&&V<=x&&S.push(f[(A+1)%3]);continue}!me&&Ie>0&&S.push(this._vertexToIndex(I+Q*Ie,O+ae*Ie));const Je=I+Q*Math.max(Ie,0),ht=I+Q*Math.min(Ze,1);ce||this._generateIntraEdgeVertices(S,I,O,z,V,Je,ht),!me&&Ze<1&&S.push(this._vertexToIndex(I+Q*Ze,O+ae*Ze)),(me||V>=_&&V<=x)&&S.push(f[(A+1)%3]),!me&&(V<=_||V>=x)&&this._generateInterEdgeVertices(S,I,O,z,V,Z,X,ht,_,x)}return S}_generateIntraEdgeVertices(i,o,f,_,x,S,A){const I=_-o,O=x-f,z=O===0,V=z?Math.min(o,_):Math.min(S,A),Z=z?Math.max(o,_):Math.max(S,A),X=Math.floor(V/this._granularityCellSize)+1,Q=Math.ceil(Z/this._granularityCellSize)-1;if(z?o<_:S<A)for(let ae=X;ae<=Q;ae++){const ce=ae*this._granularityCellSize;i.push(this._vertexToIndex(ce,f+O*(ce-o)/I))}else for(let ae=Q;ae>=X;ae--){const ce=ae*this._granularityCellSize;i.push(this._vertexToIndex(ce,f+O*(ce-o)/I))}}_generateInterEdgeVertices(i,o,f,_,x,S,A,I,O,z){const V=x-f,Z=S-_,X=A-x,Q=(O-x)/X,ae=(z-x)/X,ce=Math.min(Q,ae),me=Math.max(Q,ae),ze=_+Z*ce;let xe=Math.floor(Math.min(ze,I)/this._granularityCellSize)+1,Ie=Math.ceil(Math.max(ze,I)/this._granularityCellSize)-1,Ze=I<ze;const Je=X===0;if(Je&&(A===O||A===z))return;if(Je||ce>=1||me<=0){const Dt=f-A,xt=S+(o-S)*Math.min((O-A)/Dt,(z-A)/Dt);xe=Math.floor(Math.min(xt,I)/this._granularityCellSize)+1,Ie=Math.ceil(Math.max(xt,I)/this._granularityCellSize)-1,Ze=I<xt}const ht=V>0?z:O;if(Ze)for(let Dt=xe;Dt<=Ie;Dt++)i.push(this._vertexToIndex(Dt*this._granularityCellSize,ht));else for(let Dt=Ie;Dt>=xe;Dt--)i.push(this._vertexToIndex(Dt*this._granularityCellSize,ht))}_generateOutline(i){const o=[];for(const f of i){const _=Eo(f,this._granularity,!0),x=this._pointArrayToIndices(_),S=[];for(let A=1;A<x.length;A++)S.push(x[A-1]),S.push(x[A]);o.push(S)}return o}_handlePoles(i){let o=!1,f=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(o||f)&&this._fillPoles(i,o,f)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let o=0;o<i.length;o+=2){const f=i[o+1];f===Na&&(i[o+1]=-32767),f===tf&&(i[o+1]=32766)}}_generatePoleQuad(i,o,f,_,x,S){_>x!=(S===Na)?(i.push(o),i.push(f),i.push(this._vertexToIndex(_,S)),i.push(f),i.push(this._vertexToIndex(x,S)),i.push(this._vertexToIndex(_,S))):(i.push(f),i.push(o),i.push(this._vertexToIndex(_,S)),i.push(this._vertexToIndex(x,S)),i.push(f),i.push(this._vertexToIndex(_,S)))}_fillPoles(i,o,f){const _=this._vertexBuffer,x=ut,S=i.length;for(let A=2;A<S;A+=3){const I=i[A-2],O=i[A-1],z=i[A],V=_[2*I],Z=_[2*I+1],X=_[2*O],Q=_[2*O+1],ae=_[2*z],ce=_[2*z+1];o&&(Z===0&&Q===0&&this._generatePoleQuad(i,I,O,V,X,Na),Q===0&&ce===0&&this._generatePoleQuad(i,O,z,X,ae,Na),ce===0&&Z===0&&this._generatePoleQuad(i,z,I,ae,V,Na)),f&&(Z===x&&Q===x&&this._generatePoleQuad(i,I,O,V,X,tf),Q===x&&ce===x&&this._generatePoleQuad(i,O,z,X,ae,tf),ce===x&&Z===x&&this._generatePoleQuad(i,z,I,ae,V,tf))}}_initializeVertices(i){for(let o=0;o<i.length;o+=2)this._vertexToIndex(i[o],i[o+1])}subdividePolygonInternal(i,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:_}=function(A){const I=[],O=[];for(const z of A)if(z.length!==0){z!==A[0]&&I.push(O.length/2);for(let V=0;V<z.length;V++)O.push(z[V].x),O.push(z[V].y)}return{flattened:O,holeIndices:I}}(i);let x;this._initializeVertices(f);try{const A=function(O,z,V=2){const Z=z&&z.length,X=Z?z[0]*V:O.length;let Q=py(O,0,X,V,!0);const ae=[];if(!Q||Q.next===Q.prev)return ae;let ce,me,ze;if(Z&&(Q=function(xe,Ie,Ze,Je){const ht=[];for(let Dt=0,xt=Ie.length;Dt<xt;Dt++){const Ct=py(xe,Ie[Dt]*Je,Dt<xt-1?Ie[Dt+1]*Je:xe.length,Je,!1);Ct===Ct.next&&(Ct.steiner=!0),ht.push(Dc(Ct))}ht.sort(gy);for(let Dt=0;Dt<ht.length;Dt++)Ze=yy(ht[Dt],Ze);return Ze}(O,z,Q,V)),O.length>80*V){ce=O[0],me=O[1];let xe=ce,Ie=me;for(let Ze=V;Ze<X;Ze+=V){const Je=O[Ze],ht=O[Ze+1];Je<ce&&(ce=Je),ht<me&&(me=ht),Je>xe&&(xe=Je),ht>Ie&&(Ie=ht)}ze=Math.max(xe-ce,Ie-me),ze=ze!==0?32767/ze:0}return Cc(Q,ae,V,ce,me,ze,0),ae}(f,_),I=this._convertIndices(f,A);x=this._subdivideTrianglesScanline(I)}catch(A){console.error(A)}let S=[];return o&&(S=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:S}}_convertIndices(i,o){const f=[];for(let _=0;_<o.length;_++)f.push(this._vertexToIndex(i[2*o[_]],i[2*o[_]+1]));return f}_pointArrayToIndices(i){const o=[];for(let f=0;f<i.length;f++){const _=i[f];o.push(this._vertexToIndex(_.x,_.y))}return o}}function xy(s,i,o,f=!0){return new Yo(o,i).subdividePolygonInternal(s,f)}function Eo(s,i,o=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const f=s[0],_=s[s.length-1],x=o&&(f.x!==_.x||f.y!==_.y);if(i<2)return x?[...s,s[0]]:[...s];const S=Math.floor(ut/i),A=[];A.push(new E(s[0].x,s[0].y));const I=s.length,O=x?I:I-1;for(let z=0;z<O;z++){const V=s[z],Z=z<I-1?s[z+1]:s[0],X=V.x,Q=V.y,ae=Z.x,ce=Z.y,me=X!==ae,ze=Q!==ce;if(!me&&!ze)continue;const xe=ae-X,Ie=ce-Q,Ze=Math.abs(xe),Je=Math.abs(Ie);let ht=X,Dt=Q;for(;;){const Ct=xe>0?(Math.floor(ht/S)+1)*S:(Math.ceil(ht/S)-1)*S,Vt=Ie>0?(Math.floor(Dt/S)+1)*S:(Math.ceil(Dt/S)-1)*S,At=Math.abs(ht-Ct),Tt=Math.abs(Dt-Vt),it=Math.abs(ht-ae),Yt=Math.abs(Dt-ce),Jt=me?At/Ze:Number.POSITIVE_INFINITY,Gt=ze?Tt/Je:Number.POSITIVE_INFINITY;if((it<=At||!me)&&(Yt<=Tt||!ze))break;if(Jt<Gt&&me||!ze){ht=Ct,Dt+=Ie*Jt;const Lt=new E(ht,Math.round(Dt));A[A.length-1].x===Lt.x&&A[A.length-1].y===Lt.y||A.push(Lt)}else{ht+=xe*Gt,Dt=Vt;const Lt=new E(Math.round(ht),Dt);A[A.length-1].x===Lt.x&&A[A.length-1].y===Lt.y||A.push(Lt)}}const xt=new E(ae,ce);A[A.length-1].x===xt.x&&A[A.length-1].y===xt.y||A.push(xt)}return A}function Zh(s,i,o){if(i.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,_=s[2*i[0]];for(let I=1;I<i.length;I++){const O=s[2*i[I]];O<_&&(_=O,f=I)}const x=i.length;let S=f,A=(S+1)%x;for(;;){const I=S-1>=0?S-1:x-1,O=(A+1)%x,z=s[2*i[I]],V=s[2*i[O]],Z=s[2*i[S]],X=s[2*i[S]+1],Q=s[2*i[A]+1];let ae=!1;if(z<V)ae=!0;else if(z>V)ae=!1;else{const ce=Q-X,me=-(s[2*i[A]]-Z),ze=X<Q?1:-1;((z-Z)*ce+(s[2*i[I]+1]-X)*me)*ze>((V-Z)*ce+(s[2*i[O]+1]-X)*me)*ze&&(ae=!0)}if(ae){const ce=i[I],me=i[S],ze=i[A];ce!==me&&ce!==ze&&me!==ze&&o.push(ze,me,ce),S--,S<0&&(S=x-1)}else{const ce=i[O],me=i[S],ze=i[A];ce!==me&&ce!==ze&&me!==ze&&o.push(ze,me,ce),A++,A>=x&&(A=0)}if(I===O)break}}function Ic(s,i,o,f,_,x,S,A,I){const O=_.length/2,z=S&&A&&I;if(O<un.MAX_VERTEX_ARRAY_LENGTH){const V=i.prepareSegment(O,o,f),Z=V.vertexLength;for(let ae=0;ae<x.length;ae+=3)f.emplaceBack(Z+x[ae],Z+x[ae+1],Z+x[ae+2]);let X,Q;V.vertexLength+=O,V.primitiveLength+=x.length/3,z&&(Q=S.prepareSegment(O,o,A),X=Q.vertexLength,Q.vertexLength+=O);for(let ae=0;ae<_.length;ae+=2)s(_[ae],_[ae+1]);if(z)for(let ae=0;ae<I.length;ae++){const ce=I[ae];for(let me=1;me<ce.length;me+=2)A.emplaceBack(X+ce[me-1],X+ce[me]);Q.primitiveLength+=ce.length/2}}else(function(V,Z,X,Q,ae,ce){const me=[];for(let Je=0;Je<Q.length/2;Je++)me.push(-1);const ze={count:0};let xe=0,Ie=V.getOrCreateLatestSegment(Z,X),Ze=Ie.vertexLength;for(let Je=2;Je<ae.length;Je+=3){const ht=ae[Je-2],Dt=ae[Je-1],xt=ae[Je];let Ct=me[ht]<xe,Vt=me[Dt]<xe,At=me[xt]<xe;Ie.vertexLength+((Ct?1:0)+(Vt?1:0)+(At?1:0))>un.MAX_VERTEX_ARRAY_LENGTH&&(Ie=V.createNewSegment(Z,X),xe=ze.count,Ct=!0,Vt=!0,At=!0,Ze=0);const Tt=Yh(me,Q,ce,ze,ht,Ct,Ie),it=Yh(me,Q,ce,ze,Dt,Vt,Ie),Yt=Yh(me,Q,ce,ze,xt,At,Ie);X.emplaceBack(Ze+Tt-xe,Ze+it-xe,Ze+Yt-xe),Ie.primitiveLength++}})(i,o,f,_,x,s),z&&function(V,Z,X,Q,ae,ce){const me=[];for(let Je=0;Je<Q.length/2;Je++)me.push(-1);const ze={count:0};let xe=0,Ie=V.getOrCreateLatestSegment(Z,X),Ze=Ie.vertexLength;for(let Je=0;Je<ae.length;Je++){const ht=ae[Je];for(let Dt=1;Dt<ae[Je].length;Dt+=2){const xt=ht[Dt-1],Ct=ht[Dt];let Vt=me[xt]<xe,At=me[Ct]<xe;Ie.vertexLength+((Vt?1:0)+(At?1:0))>un.MAX_VERTEX_ARRAY_LENGTH&&(Ie=V.createNewSegment(Z,X),xe=ze.count,Vt=!0,At=!0,Ze=0);const Tt=Yh(me,Q,ce,ze,xt,Vt,Ie),it=Yh(me,Q,ce,ze,Ct,At,Ie);X.emplaceBack(Ze+Tt-xe,Ze+it-xe),Ie.primitiveLength++}}}(S,o,A,_,I,s),i.forceNewSegmentOnNextPrepare(),S?.forceNewSegmentOnNextPrepare()}function Yh(s,i,o,f,_,x,S){if(x){const A=f.count;return o(i[2*_],i[2*_+1]),s[_]=f.count,f.count++,S.vertexLength++,A}return s[_]}class up{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ve,this.indexArray=new qn,this.indexArray2=new Ci,this.programConfigurations=new Sa(i.layers,i.zoom),this.segments=new un,this.segments2=new un,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasPattern=Gh("fill",this.layers,o);const _=this.layers[0].layout.get("fill-sort-key"),x=!_.isConstant(),S=[];for(const{feature:A,id:I,index:O,sourceLayerIndex:z}of i){const V=this.layers[0]._featureFilter.needGeometry,Z=Mc(A,V);if(!this.layers[0]._featureFilter.filter(new ti(this.zoom),Z,f))continue;const X=x?_.evaluate(Z,{},f,o.availableImages):void 0,Q={id:I,properties:A.properties,type:A.type,sourceLayerIndex:z,index:O,geometry:V?Z.geometry:So(A),patterns:{},sortKey:X};S.push(Q)}x&&S.sort((A,I)=>A.sortKey-I.sortKey);for(const A of S){const{geometry:I,index:O,sourceLayerIndex:z}=A;if(this.hasPattern){const V=Fl("fill",this.layers,A,{zoom:this.zoom},o);this.patternFeatures.push(V)}else this.addFeature(A,I,O,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[O].feature,I,O,z,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}addFeatures(i,o,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,M_),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,f,_,x,S){for(const A of au(o,500)){const I=xy(A,_,S.fill.getGranularityForZoomLevel(_.z)),O=this.layoutVertexArray;Ic((z,V)=>{O.emplaceBack(z,V)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:x,canonical:_})}}let sl,wy;kt("FillBucket",up,{omit:["layers","patternFeatures"]});var nf={get paint(){return wy=wy||new $n({"fill-antialias":new Nt(Fe.paint_fill["fill-antialias"]),"fill-opacity":new qt(Fe.paint_fill["fill-opacity"]),"fill-color":new qt(Fe.paint_fill["fill-color"]),"fill-outline-color":new qt(Fe.paint_fill["fill-outline-color"]),"fill-translate":new Nt(Fe.paint_fill["fill-translate"]),"fill-translate-anchor":new Nt(Fe.paint_fill["fill-translate-anchor"]),"fill-pattern":new eo(Fe.paint_fill["fill-pattern"])})},get layout(){return sl=sl||new $n({"fill-sort-key":new qt(Fe.layout_fill["fill-sort-key"])})}};class hp extends to{constructor(i,o){super(i,nf,o)}recalculate(i,o){super.recalculate(i,o);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new up(i)}queryRadius(){return Ar(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:o,transform:f,pixelsToTileUnits:_}){return cy(zr(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,_),o)}isTileClipped(){return!0}}const dp=Li([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),rf=Li([{name:"a_centroid",components:2,type:"Int16"}],4),{members:I_}=dp;class Hh{constructor(i,o,f,_,x){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=_,this._values=x,i.readFields(fp,this,o)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const o=i.readVarint()+i.pos,f=[];let _,x=1,S=0,A=0,I=0;for(;i.pos<o;){if(S<=0){const O=i.readVarint();x=7&O,S=O>>3}if(S--,x===1||x===2)A+=i.readSVarint(),I+=i.readSVarint(),x===1&&(_&&f.push(_),_=[]),_&&_.push(new E(A,I));else{if(x!==7)throw new Error(`unknown command ${x}`);_&&_.push(_[0].clone())}}return _&&f.push(_),f}bbox(){const i=this._pbf;i.pos=this._geometry;const o=i.readVarint()+i.pos;let f=1,_=0,x=0,S=0,A=1/0,I=-1/0,O=1/0,z=-1/0;for(;i.pos<o;){if(_<=0){const V=i.readVarint();f=7&V,_=V>>3}if(_--,f===1||f===2)x+=i.readSVarint(),S+=i.readSVarint(),x<A&&(A=x),x>I&&(I=x),S<O&&(O=S),S>z&&(z=S);else if(f!==7)throw new Error(`unknown command ${f}`)}return[A,O,I,z]}toGeoJSON(i,o,f){const _=this.extent*Math.pow(2,f),x=this.extent*i,S=this.extent*o,A=this.loadGeometry();function I(Z){return[360*(Z.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((1-2*(Z.y+S)/_)*Math.PI))-90]}function O(Z){return Z.map(I)}let z;if(this.type===1){const Z=[];for(const Q of A)Z.push(Q[0]);const X=O(Z);z=Z.length===1?{type:"Point",coordinates:X[0]}:{type:"MultiPoint",coordinates:X}}else if(this.type===2){const Z=A.map(O);z=Z.length===1?{type:"LineString",coordinates:Z[0]}:{type:"MultiLineString",coordinates:Z}}else{if(this.type!==3)throw new Error("unknown feature type");{const Z=function(Q){const ae=Q.length;if(ae<=1)return[Q];const ce=[];let me,ze;for(let xe=0;xe<ae;xe++){const Ie=R_(Q[xe]);Ie!==0&&(ze===void 0&&(ze=Ie<0),ze===Ie<0?(me&&ce.push(me),me=[Q[xe]]):me&&me.push(Q[xe]))}return me&&ce.push(me),ce}(A),X=[];for(const Q of Z)X.push(Q.map(O));z=X.length===1?{type:"Polygon",coordinates:X[0]}:{type:"MultiPolygon",coordinates:X}}}const V={type:"Feature",geometry:z,properties:this.properties};return this.id!=null&&(V.id=this.id),V}}function fp(s,i,o){s===1?i.id=o.readVarint():s===2?function(f,_){const x=f.readVarint()+f.pos;for(;f.pos<x;){const S=_._keys[f.readVarint()],A=_._values[f.readVarint()];_.properties[S]=A}}(o,i):s===3?i.type=o.readVarint():s===4&&(i._geometry=o.pos)}function R_(s){let i=0;for(let o,f,_=0,x=s.length,S=x-1;_<x;S=_++)o=s[_],f=s[S],i+=(f.x-o.x)*(o.y+f.y);return i}Hh.types=["Unknown","Point","LineString","Polygon"];class pp{constructor(i,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(k_,this,o),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const o=this._pbf.readVarint()+this._pbf.pos;return new Hh(this._pbf,o,this.extent,this._keys,this._values)}}function k_(s,i,o){s===15?i.version=o.readVarint():s===1?i.name=o.readString():s===5?i.extent=o.readVarint():s===2?i._features.push(o.pos):s===3?i._keys.push(o.readString()):s===4&&i._values.push(function(f){let _=null;const x=f.readVarint()+f.pos;for(;f.pos<x;){const S=f.readVarint()>>3;_=S===1?f.readString():S===2?f.readFloat():S===3?f.readDouble():S===4?f.readVarint64():S===5?f.readVarint():S===6?f.readSVarint():S===7?f.readBoolean():null}if(_==null)throw new Error("unknown feature value");return _}(o))}class P_{constructor(i,o){this.layers=i.readFields(Fb,{},o)}}function Fb(s,i,o){if(s===3){const f=new pp(o,o.readVarint()+o.pos);f.length&&(i[f.name]=f)}}const ui=Math.pow(2,13);function mi(s,i,o,f,_,x,S,A){s.emplaceBack(i,o,2*Math.floor(f*ui)+S,_*ui*2,x*ui*2,Math.round(A))}class Nn{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new $e,this.centroidVertexArray=new Ne,this.indexArray=new qn,this.programConfigurations=new Sa(i.layers,i.zoom),this.segments=new un,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.features=[],this.hasPattern=Gh("fill-extrusion",this.layers,o);for(const{feature:_,id:x,index:S,sourceLayerIndex:A}of i){const I=this.layers[0]._featureFilter.needGeometry,O=Mc(_,I);if(!this.layers[0]._featureFilter.filter(new ti(this.zoom),O,f))continue;const z={id:x,sourceLayerIndex:A,index:S,geometry:I?O.geometry:So(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(Fl("fill-extrusion",this.layers,z,{zoom:this.zoom},o)):this.addFeature(z,z.geometry,S,f,{},o.subdivisionGranularity),o.featureIndex.insert(_,z.geometry,S,A,this.index,!0)}}addFeatures(i,o,f){for(const _ of this.features){const{geometry:x}=_;this.addFeature(_,x,_.index,o,f,i.subdivisionGranularity)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,I_),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,rf.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,o,f,_,x,S){for(const A of au(o,500)){const I={x:0,y:0,sampleCount:0},O=this.layoutVertexArray.length;this.processPolygon(I,_,i,A,S);const z=this.layoutVertexArray.length-O,V=Math.floor(I.x/I.sampleCount),Z=Math.floor(I.y/I.sampleCount);for(let X=0;X<z;X++)this.centroidVertexArray.emplaceBack(V,Z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:x,canonical:_})}processPolygon(i,o,f,_,x){if(_.length<1||Mo(_[0]))return;for(const V of _)V.length!==0&&Kn(i,V);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=x.fill.getGranularityForZoomLevel(o.z),I=Hh.types[f.type]==="Polygon";for(const V of _){if(V.length===0||Mo(V))continue;const Z=Eo(V,A,I);this._generateSideFaces(Z,S)}if(!I)return;const O=xy(_,o,A,!1),z=this.layoutVertexArray;Ic((V,Z)=>{mi(z,V,Z,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles)}_generateSideFaces(i,o){let f=0;for(let _=1;_<i.length;_++){const x=i[_],S=i[_-1];if(vi(x,S))continue;o.segment.vertexLength+4>un.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=x.sub(S)._perp()._unit(),I=S.dist(x);f+I>32768&&(f=0),mi(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,0,f),mi(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,1,f),f+=I,mi(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,0,f),mi(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,1,f);const O=o.segment.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function Kn(s,i){for(let o=0;o<i.length;o++){const f=i[o];o===i.length-1&&i[0].x===f.x&&i[0].y===f.y||(s.x+=f.x,s.y+=f.y,s.sampleCount++)}}function vi(s,i){return s.x===i.x&&(s.x<0||s.x>ut)||s.y===i.y&&(s.y<0||s.y>ut)}function Mo(s){return s.every(i=>i.x<0)||s.every(i=>i.x>ut)||s.every(i=>i.y<0)||s.every(i=>i.y>ut)}let Rc;kt("FillExtrusionBucket",Nn,{omit:["layers","features"]});var af={get paint(){return Rc=Rc||new $n({"fill-extrusion-opacity":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(Fe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new eo(Fe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(Fe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(Fe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Ty extends to{constructor(i,o){super(i,af,o)}createBucket(i){return new Nn(i)}queryRadius(){return Ar(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:x,pixelsToTileUnits:S,pixelPosMatrix:A}){const I=zr(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,S),O=this.paint.get("fill-extrusion-height").evaluate(o,f),z=this.paint.get("fill-extrusion-base").evaluate(o,f),V=function(X,Q){const ae=[];for(const ce of X){const me=[ce.x,ce.y,0,1];Zt(me,me,Q),ae.push(new E(me[0]/me[3],me[1]/me[3]))}return ae}(I,A),Z=function(X,Q,ae,ce){const me=[],ze=[],xe=ce[8]*Q,Ie=ce[9]*Q,Ze=ce[10]*Q,Je=ce[11]*Q,ht=ce[8]*ae,Dt=ce[9]*ae,xt=ce[10]*ae,Ct=ce[11]*ae;for(const Vt of X){const At=[],Tt=[];for(const it of Vt){const Yt=it.x,Jt=it.y,Gt=ce[0]*Yt+ce[4]*Jt+ce[12],Lt=ce[1]*Yt+ce[5]*Jt+ce[13],kn=ce[2]*Yt+ce[6]*Jt+ce[14],$i=ce[3]*Yt+ce[7]*Jt+ce[15],Wi=kn+Ze,fa=$i+Je,Io=Gt+ht,pa=Lt+Dt,jr=kn+xt,Zi=$i+Ct,cr=new E((Gt+xe)/fa,(Lt+Ie)/fa);cr.z=Wi/fa,At.push(cr);const vr=new E(Io/Zi,pa/Zi);vr.z=jr/Zi,Tt.push(vr)}me.push(At),ze.push(Tt)}return[me,ze]}(_,z,O,A);return function(X,Q,ae){let ce=1/0;cy(ae,Q)&&(ce=lr(ae,Q[0]));for(let me=0;me<Q.length;me++){const ze=Q[me],xe=X[me];for(let Ie=0;Ie<ze.length-1;Ie++){const Ze=ze[Ie],Je=[Ze,ze[Ie+1],xe[Ie+1],xe[Ie],Ze];Su(ae,Je)&&(ce=Math.min(ce,lr(ae,Je)))}}return ce!==1/0&&ce}(Z[0],Z[1],V)}}function Ho(s,i){return s.x*i.x+s.y*i.y}function lr(s,i){if(s.length===1){let o=0;const f=i[o++];let _;for(;!_||f.equals(_);)if(_=i[o++],!_)return 1/0;for(;o<i.length;o++){const x=i[o],S=s[0],A=_.sub(f),I=x.sub(f),O=S.sub(f),z=Ho(A,A),V=Ho(A,I),Z=Ho(I,I),X=Ho(O,A),Q=Ho(O,I),ae=z*Z-V*V,ce=(Z*X-V*Q)/ae,me=(z*Q-V*X)/ae,ze=f.z*(1-ce-me)+_.z*ce+x.z*me;if(isFinite(ze))return ze}return 1/0}{let o=1/0;for(const f of i)o=Math.min(o,f.z);return o}}const Au=Li([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:qh}=Au,Sy=Li([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ds}=Sy,of=Math.cos(Math.PI/180*37.5),sf=Math.pow(2,14)/.5;class za{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Xe,this.layoutVertexArray2=new Mt,this.indexArray=new qn,this.programConfigurations=new Sa(i.layers,i.zoom),this.segments=new un,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasPattern=Gh("line",this.layers,o);const _=this.layers[0].layout.get("line-sort-key"),x=!_.isConstant(),S=[];for(const{feature:A,id:I,index:O,sourceLayerIndex:z}of i){const V=this.layers[0]._featureFilter.needGeometry,Z=Mc(A,V);if(!this.layers[0]._featureFilter.filter(new ti(this.zoom),Z,f))continue;const X=x?_.evaluate(Z,{},f):void 0,Q={id:I,properties:A.properties,type:A.type,sourceLayerIndex:z,index:O,geometry:V?Z.geometry:So(A),patterns:{},sortKey:X};S.push(Q)}x&&S.sort((A,I)=>A.sortKey-I.sortKey);for(const A of S){const{geometry:I,index:O,sourceLayerIndex:z}=A;if(this.hasPattern){const V=Fl("line",this.layers,A,{zoom:this.zoom},o);this.patternFeatures.push(V)}else this.addFeature(A,I,O,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[O].feature,I,O,z,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}addFeatures(i,o,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Ds)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,qh),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,f,_,x,S){const A=this.layers[0].layout,I=A.get("line-join").evaluate(i,{}),O=A.get("line-cap"),z=A.get("line-miter-limit"),V=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const Z of o)this.addLine(Z,i,I,O,z,V,_,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:x,canonical:_})}addLine(i,o,f,_,x,S,A,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=Eo(i,A?I.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let xe=0;xe<i.length-1;xe++)this.totalDistance+=i[xe].dist(i[xe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=Hh.types[o.type]==="Polygon";let z=i.length;for(;z>=2&&i[z-1].equals(i[z-2]);)z--;let V=0;for(;V<z-1&&i[V].equals(i[V+1]);)V++;if(z<(O?3:2))return;f==="bevel"&&(x=1.05);const Z=this.overscaling<=16?122880/(512*this.overscaling):0,X=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let Q,ae,ce,me,ze;this.e1=this.e2=-1,O&&(Q=i[z-2],ze=i[V].sub(Q)._unit()._perp());for(let xe=V;xe<z;xe++){if(ce=xe===z-1?O?i[V+1]:void 0:i[xe+1],ce&&i[xe].equals(ce))continue;ze&&(me=ze),Q&&(ae=Q),Q=i[xe],ze=ce?ce.sub(Q)._unit()._perp():me,me=me||ze;let Ie=me.add(ze);Ie.x===0&&Ie.y===0||Ie._unit();const Ze=me.x*ze.x+me.y*ze.y,Je=Ie.x*ze.x+Ie.y*ze.y,ht=Je!==0?1/Je:1/0,Dt=2*Math.sqrt(2-2*Je),xt=Je<of&&ae&&ce,Ct=me.x*ze.y-me.y*ze.x>0;if(xt&&xe>V){const Tt=Q.dist(ae);if(Tt>2*Z){const it=Q.sub(Q.sub(ae)._mult(Z/Tt)._round());this.updateDistance(ae,it),this.addCurrentVertex(it,me,0,0,X),ae=it}}const Vt=ae&&ce;let At=Vt?f:O?"butt":_;if(Vt&&At==="round"&&(ht<S?At="miter":ht<=2&&(At="fakeround")),At==="miter"&&ht>x&&(At="bevel"),At==="bevel"&&(ht>2&&(At="flipbevel"),ht<x&&(At="miter")),ae&&this.updateDistance(ae,Q),At==="miter")Ie._mult(ht),this.addCurrentVertex(Q,Ie,0,0,X);else if(At==="flipbevel"){if(ht>100)Ie=ze.mult(-1);else{const Tt=ht*me.add(ze).mag()/me.sub(ze).mag();Ie._perp()._mult(Tt*(Ct?-1:1))}this.addCurrentVertex(Q,Ie,0,0,X),this.addCurrentVertex(Q,Ie.mult(-1),0,0,X)}else if(At==="bevel"||At==="fakeround"){const Tt=-Math.sqrt(ht*ht-1),it=Ct?Tt:0,Yt=Ct?0:Tt;if(ae&&this.addCurrentVertex(Q,me,it,Yt,X),At==="fakeround"){const Jt=Math.round(180*Dt/Math.PI/20);for(let Gt=1;Gt<Jt;Gt++){let Lt=Gt/Jt;if(Lt!==.5){const $i=Lt-.5;Lt+=Lt*$i*(Lt-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*$i*$i+(.848013+Ze*(.215638*Ze-1.06021)))}const kn=ze.sub(me)._mult(Lt)._add(me)._unit()._mult(Ct?-1:1);this.addHalfVertex(Q,kn.x,kn.y,!1,Ct,0,X)}}ce&&this.addCurrentVertex(Q,ze,-it,-Yt,X)}else if(At==="butt")this.addCurrentVertex(Q,Ie,0,0,X);else if(At==="square"){const Tt=ae?1:-1;this.addCurrentVertex(Q,Ie,Tt,Tt,X)}else At==="round"&&(ae&&(this.addCurrentVertex(Q,me,0,0,X),this.addCurrentVertex(Q,me,1,1,X,!0)),ce&&(this.addCurrentVertex(Q,ze,-1,-1,X,!0),this.addCurrentVertex(Q,ze,0,0,X)));if(xt&&xe<z-1){const Tt=Q.dist(ce);if(Tt>2*Z){const it=Q.add(ce.sub(Q)._mult(Z/Tt)._round());this.updateDistance(Q,it),this.addCurrentVertex(it,ze,0,0,X),Q=it}}}}addCurrentVertex(i,o,f,_,x,S=!1){const A=o.y*_-o.x,I=-o.y-o.x*_;this.addHalfVertex(i,o.x+o.y*f,o.y-o.x*f,S,!1,f,x),this.addHalfVertex(i,A,I,S,!0,-_,x),this.distance>sf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,o,f,_,x,S))}addHalfVertex({x:i,y:o},f,_,x,S,A,I){const O=.5*(this.lineClips?this.scaledDistance*(sf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(x?1:0),(o<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*_)+128,1+(A===0?0:A<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,z,this.e2),I.primitiveLength++),S?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}}let Om,Lm;kt("LineBucket",za,{omit:["layers","patternFeatures"]});var mp={get paint(){return Lm=Lm||new $n({"line-opacity":new qt(Fe.paint_line["line-opacity"]),"line-color":new qt(Fe.paint_line["line-color"]),"line-translate":new Nt(Fe.paint_line["line-translate"]),"line-translate-anchor":new Nt(Fe.paint_line["line-translate-anchor"]),"line-width":new qt(Fe.paint_line["line-width"]),"line-gap-width":new qt(Fe.paint_line["line-gap-width"]),"line-offset":new qt(Fe.paint_line["line-offset"]),"line-blur":new qt(Fe.paint_line["line-blur"]),"line-dasharray":new Nl(Fe.paint_line["line-dasharray"]),"line-pattern":new eo(Fe.paint_line["line-pattern"]),"line-gradient":new qd(Fe.paint_line["line-gradient"])})},get layout(){return Om=Om||new $n({"line-cap":new Nt(Fe.layout_line["line-cap"]),"line-join":new qt(Fe.layout_line["line-join"]),"line-miter-limit":new Nt(Fe.layout_line["line-miter-limit"]),"line-round-limit":new Nt(Fe.layout_line["line-round-limit"]),"line-sort-key":new qt(Fe.layout_line["line-sort-key"])})}};class Nm extends qt{possiblyEvaluate(i,o){return o=new ti(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(i,o)}evaluate(i,o,f,_){return o=Wt({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,f,_)}}let ll;class Ea extends to{constructor(i,o){super(i,mp,o),this.gradientVersion=0,ll||(ll=new Nm(mp.paint.properties["line-width"].specification),ll.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof Ki,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,o){super.recalculate(i,o),this.paint._values["line-floorwidth"]=ll.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new za(i)}queryRadius(i){const o=i,f=kc(Uh("line-width",this,o),Uh("line-gap-width",this,o)),_=Uh("line-offset",this,o);return f/2+Math.abs(_)+Ar(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:x,pixelsToTileUnits:S}){const A=zr(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,S),I=S/2*kc(this.paint.get("line-width").evaluate(o,f),this.paint.get("line-gap-width").evaluate(o,f)),O=this.paint.get("line-offset").evaluate(o,f);return O&&(_=function(z,V){const Z=[];for(let X=0;X<z.length;X++){const Q=z[X],ae=[];for(let ce=0;ce<Q.length;ce++){const me=Q[ce-1],ze=Q[ce],xe=Q[ce+1],Ie=ce===0?new E(0,0):ze.sub(me)._unit()._perp(),Ze=ce===Q.length-1?new E(0,0):xe.sub(ze)._unit()._perp(),Je=Ie._add(Ze)._unit(),ht=Je.x*Ze.x+Je.y*Ze.y;ht!==0&&Je._mult(1/ht),ae.push(Je._mult(V)._add(ze))}Z.push(ae)}return Z}(_,O*S)),function(z,V,Z){for(let X=0;X<V.length;X++){const Q=V[X];if(z.length>=3){for(let ae=0;ae<Q.length;ae++)if(Bh(z,Q[ae]))return!0}if(y_(z,Q,Z))return!0}return!1}(A,_,I)}isTileClipped(){return!0}}function kc(s,i){return i>0?i+2*s:s}const lf=Li([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cf=Li([{name:"a_projected_pos",components:3,type:"Float32"}],4);Li([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ey=Li([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Li([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zm=Li([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),O_=Li([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function gp(s,i,o){return s.sections.forEach(f=>{f.text=function(_,x,S){const A=x.layout.get("text-transform").evaluate(S,{});return A==="uppercase"?_=_.toLocaleUpperCase():A==="lowercase"&&(_=_.toLocaleLowerCase()),sa.applyArabicShaping&&(_=sa.applyArabicShaping(_)),_}(f.text,i,o)}),s}Li([{name:"triangle",components:3,type:"Uint16"}]),Li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Li([{type:"Float32",name:"offsetX"}]),Li([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Li([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Xh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ai=24;const jm=4294967296,Ao=1/jm,My=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Fm{constructor(i=new Uint8Array(16)){this.buf=ArrayBuffer.isView(i)?i:new Uint8Array(i),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(i,o,f=this.length){for(;this.pos<f;){const _=this.readVarint(),x=_>>3,S=this.pos;this.type=7&_,i(x,o,this),this.pos===S&&this.skip(_)}return o}readMessage(i,o){return this.readFields(i,o,this.readVarint()+this.pos)}readFixed32(){const i=this.dataView.getUint32(this.pos,!0);return this.pos+=4,i}readSFixed32(){const i=this.dataView.getInt32(this.pos,!0);return this.pos+=4,i}readFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*jm;return this.pos+=8,i}readSFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*jm;return this.pos+=8,i}readFloat(){const i=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,i}readDouble(){const i=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,i}readVarint(i){const o=this.buf;let f,_;return _=o[this.pos++],f=127&_,_<128?f:(_=o[this.pos++],f|=(127&_)<<7,_<128?f:(_=o[this.pos++],f|=(127&_)<<14,_<128?f:(_=o[this.pos++],f|=(127&_)<<21,_<128?f:(_=o[this.pos],f|=(15&_)<<28,function(x,S,A){const I=A.buf;let O,z;if(z=I[A.pos++],O=(112&z)>>4,z<128||(z=I[A.pos++],O|=(127&z)<<3,z<128)||(z=I[A.pos++],O|=(127&z)<<10,z<128)||(z=I[A.pos++],O|=(127&z)<<17,z<128)||(z=I[A.pos++],O|=(127&z)<<24,z<128)||(z=I[A.pos++],O|=(1&z)<<31,z<128))return uf(x,O,S);throw new Error("Expected varint not more than 10 bytes")}(f,i,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const i=this.readVarint();return i%2==1?(i+1)/-2:i/2}readBoolean(){return!!this.readVarint()}readString(){const i=this.readVarint()+this.pos,o=this.pos;return this.pos=i,i-o>=12&&My?My.decode(this.buf.subarray(o,i)):function(f,_,x){let S="",A=_;for(;A<x;){const I=f[A];let O,z,V,Z=null,X=I>239?4:I>223?3:I>191?2:1;if(A+X>x)break;X===1?I<128&&(Z=I):X===2?(O=f[A+1],(192&O)==128&&(Z=(31&I)<<6|63&O,Z<=127&&(Z=null))):X===3?(O=f[A+1],z=f[A+2],(192&O)==128&&(192&z)==128&&(Z=(15&I)<<12|(63&O)<<6|63&z,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):X===4&&(O=f[A+1],z=f[A+2],V=f[A+3],(192&O)==128&&(192&z)==128&&(192&V)==128&&(Z=(15&I)<<18|(63&O)<<12|(63&z)<<6|63&V,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,X=1):Z>65535&&(Z-=65536,S+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|1023&Z),S+=String.fromCharCode(Z),A+=X}return S}(this.buf,o,i)}readBytes(){const i=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,i);return this.pos=i,o}readPackedVarint(i=[],o){const f=this.readPackedEnd();for(;this.pos<f;)i.push(this.readVarint(o));return i}readPackedSVarint(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readSVarint());return i}readPackedBoolean(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readBoolean());return i}readPackedFloat(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readFloat());return i}readPackedDouble(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readDouble());return i}readPackedFixed32(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readFixed32());return i}readPackedSFixed32(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readSFixed32());return i}readPackedFixed64(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readFixed64());return i}readPackedSFixed64(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readSFixed64());return i}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(i){const o=7&i;if(o===0)for(;this.buf[this.pos++]>127;);else if(o===2)this.pos=this.readVarint()+this.pos;else if(o===5)this.pos+=4;else{if(o!==1)throw new Error(`Unimplemented type: ${o}`);this.pos+=8}}writeTag(i,o){this.writeVarint(i<<3|o)}realloc(i){let o=this.length||16;for(;o<this.pos+i;)o*=2;if(o!==this.length){const f=new Uint8Array(o);f.set(this.buf),this.buf=f,this.dataView=new DataView(f.buffer),this.length=o}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeSFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*Ao),!0),this.pos+=8}writeSFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*Ao),!0),this.pos+=8}writeVarint(i){(i=+i||0)>268435455||i<0?function(o,f){let _,x;if(o>=0?(_=o%4294967296|0,x=o/4294967296|0):(_=~(-o%4294967296),x=~(-o/4294967296),4294967295^_?_=_+1|0:(_=0,x=x+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(S,A,I){I.buf[I.pos++]=127&S|128,S>>>=7,I.buf[I.pos++]=127&S|128,S>>>=7,I.buf[I.pos++]=127&S|128,S>>>=7,I.buf[I.pos++]=127&S|128,I.buf[I.pos]=127&(S>>>=7)}(_,0,f),function(S,A){const I=(7&S)<<4;A.buf[A.pos++]|=I|((S>>>=3)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S)))))}(x,f)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))}writeSVarint(i){this.writeVarint(i<0?2*-i-1:2*i)}writeBoolean(i){this.writeVarint(+i)}writeString(i){i=String(i),this.realloc(4*i.length),this.pos++;const o=this.pos;this.pos=function(_,x,S){for(let A,I,O=0;O<x.length;O++){if(A=x.charCodeAt(O),A>55295&&A<57344){if(!I){A>56319||O+1===x.length?(_[S++]=239,_[S++]=191,_[S++]=189):I=A;continue}if(A<56320){_[S++]=239,_[S++]=191,_[S++]=189,I=A;continue}A=I-55296<<10|A-56320|65536,I=null}else I&&(_[S++]=239,_[S++]=191,_[S++]=189,I=null);A<128?_[S++]=A:(A<2048?_[S++]=A>>6|192:(A<65536?_[S++]=A>>12|224:(_[S++]=A>>18|240,_[S++]=A>>12&63|128),_[S++]=A>>6&63|128),_[S++]=63&A|128)}return S}(this.buf,i,this.pos);const f=this.pos-o;f>=128&&Pc(o,f,this),this.pos=o-1,this.writeVarint(f),this.pos+=f}writeFloat(i){this.realloc(4),this.dataView.setFloat32(this.pos,i,!0),this.pos+=4}writeDouble(i){this.realloc(8),this.dataView.setFloat64(this.pos,i,!0),this.pos+=8}writeBytes(i){const o=i.length;this.writeVarint(o),this.realloc(o);for(let f=0;f<o;f++)this.buf[this.pos++]=i[f]}writeRawMessage(i,o){this.pos++;const f=this.pos;i(o,this);const _=this.pos-f;_>=128&&Pc(f,_,this),this.pos=f-1,this.writeVarint(_),this.pos+=_}writeMessage(i,o,f){this.writeTag(i,2),this.writeRawMessage(o,f)}writePackedVarint(i,o){o.length&&this.writeMessage(i,Bm,o)}writePackedSVarint(i,o){o.length&&this.writeMessage(i,Ay,o)}writePackedBoolean(i,o){o.length&&this.writeMessage(i,N_,o)}writePackedFloat(i,o){o.length&&this.writeMessage(i,hf,o)}writePackedDouble(i,o){o.length&&this.writeMessage(i,L_,o)}writePackedFixed32(i,o){o.length&&this.writeMessage(i,z_,o)}writePackedSFixed32(i,o){o.length&&this.writeMessage(i,Cy,o)}writePackedFixed64(i,o){o.length&&this.writeMessage(i,Dy,o)}writePackedSFixed64(i,o){o.length&&this.writeMessage(i,Bb,o)}writeBytesField(i,o){this.writeTag(i,2),this.writeBytes(o)}writeFixed32Field(i,o){this.writeTag(i,5),this.writeFixed32(o)}writeSFixed32Field(i,o){this.writeTag(i,5),this.writeSFixed32(o)}writeFixed64Field(i,o){this.writeTag(i,1),this.writeFixed64(o)}writeSFixed64Field(i,o){this.writeTag(i,1),this.writeSFixed64(o)}writeVarintField(i,o){this.writeTag(i,0),this.writeVarint(o)}writeSVarintField(i,o){this.writeTag(i,0),this.writeSVarint(o)}writeStringField(i,o){this.writeTag(i,2),this.writeString(o)}writeFloatField(i,o){this.writeTag(i,5),this.writeFloat(o)}writeDoubleField(i,o){this.writeTag(i,1),this.writeDouble(o)}writeBooleanField(i,o){this.writeVarintField(i,+o)}}function uf(s,i,o){return o?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}function Pc(s,i,o){const f=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));o.realloc(f);for(let _=o.pos-1;_>=s;_--)o.buf[_+f]=o.buf[_]}function Bm(s,i){for(let o=0;o<s.length;o++)i.writeVarint(s[o])}function Ay(s,i){for(let o=0;o<s.length;o++)i.writeSVarint(s[o])}function hf(s,i){for(let o=0;o<s.length;o++)i.writeFloat(s[o])}function L_(s,i){for(let o=0;o<s.length;o++)i.writeDouble(s[o])}function N_(s,i){for(let o=0;o<s.length;o++)i.writeBoolean(s[o])}function z_(s,i){for(let o=0;o<s.length;o++)i.writeFixed32(s[o])}function Cy(s,i){for(let o=0;o<s.length;o++)i.writeSFixed32(s[o])}function Dy(s,i){for(let o=0;o<s.length;o++)i.writeFixed64(s[o])}function Bb(s,i){for(let o=0;o<s.length;o++)i.writeSFixed64(s[o])}function Ub(s,i,o){s===1&&o.readMessage(Vb,i)}function Vb(s,i,o){if(s===3){const{id:f,bitmap:_,width:x,height:S,left:A,top:I,advance:O}=o.readMessage(j_,{});i.push({id:f,bitmap:new Vh({width:x+6,height:S+6},_),metrics:{width:x,height:S,left:A,top:I,advance:O}})}}function j_(s,i,o){s===1?i.id=o.readVarint():s===2?i.bitmap=o.readBytes():s===3?i.width=o.readVarint():s===4?i.height=o.readVarint():s===5?i.left=o.readSVarint():s===6?i.top=o.readSVarint():s===7&&(i.advance=o.readVarint())}function Iy(s){let i=0,o=0;for(const S of s)i+=S.w*S.h,o=Math.max(o,S.w);s.sort((S,A)=>A.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let _=0,x=0;for(const S of s)for(let A=f.length-1;A>=0;A--){const I=f[A];if(!(S.w>I.w||S.h>I.h)){if(S.x=I.x,S.y=I.y,x=Math.max(x,S.y+S.h),_=Math.max(_,S.x+S.w),S.w===I.w&&S.h===I.h){const O=f.pop();O&&A<f.length&&(f[A]=O)}else S.h===I.h?(I.x+=S.w,I.w-=S.w):S.w===I.w?(I.y+=S.h,I.h-=S.h):(f.push({x:I.x+S.w,y:I.y,w:I.w-S.w,h:S.h}),I.y+=S.h,I.h-=S.h);break}}return{w:_,h:x,fill:i/(_*x)||0}}class Cu{constructor(i,{pixelRatio:o,version:f,stretchX:_,stretchY:x,content:S,textFitWidth:A,textFitHeight:I}){this.paddedRect=i,this.pixelRatio=o,this.stretchX=_,this.stretchY=x,this.content=S,this.version=f,this.textFitWidth=A,this.textFitHeight=I}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class yp{constructor(i,o){const f={},_={};this.haveRenderCallbacks=[];const x=[];this.addImages(i,f,x),this.addImages(o,_,x);const{w:S,h:A}=Iy(x),I=new Oa({width:S||1,height:A||1});for(const O in i){const z=i[O],V=f[O].paddedRect;Oa.copy(z.data,I,{x:0,y:0},{x:V.x+1,y:V.y+1},z.data)}for(const O in o){const z=o[O],V=_[O].paddedRect,Z=V.x+1,X=V.y+1,Q=z.data.width,ae=z.data.height;Oa.copy(z.data,I,{x:0,y:0},{x:Z,y:X},z.data),Oa.copy(z.data,I,{x:0,y:ae-1},{x:Z,y:X-1},{width:Q,height:1}),Oa.copy(z.data,I,{x:0,y:0},{x:Z,y:X+ae},{width:Q,height:1}),Oa.copy(z.data,I,{x:Q-1,y:0},{x:Z-1,y:X},{width:1,height:ae}),Oa.copy(z.data,I,{x:0,y:0},{x:Z+Q,y:X},{width:1,height:ae})}this.image=I,this.iconPositions=f,this.patternPositions=_}addImages(i,o,f){for(const _ in i){const x=i[_],S={x:0,y:0,w:x.data.width+2,h:x.data.height+2};f.push(S),o[_]=new Cu(S,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(i,o){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in i.updatedImages)this.patchUpdatedImage(this.iconPositions[f],i.getImage(f),o),this.patchUpdatedImage(this.patternPositions[f],i.getImage(f),o)}patchUpdatedImage(i,o,f){if(!i||!o||i.version===o.version)return;i.version=o.version;const[_,x]=i.tl;f.update(o.data,void 0,{x:_,y:x})}}var Oc;kt("ImagePosition",Cu),kt("ImageAtlas",yp),y.ao=void 0,(Oc=y.ao||(y.ao={}))[Oc.none=0]="none",Oc[Oc.horizontal=1]="horizontal",Oc[Oc.vertical=2]="vertical",Oc[Oc.horizontalOnly=3]="horizontalOnly";class df{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(i,o,f){const _=new df;return _.scale=i||1,_.fontStack=o,_.verticalAlign=f||"bottom",_}static forImage(i,o){const f=new df;return f.imageName=i,f.verticalAlign=o||"bottom",f}}class Wh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const f=new Wh;for(let _=0;_<i.sections.length;_++){const x=i.sections[_];x.image?f.addImageSection(x):f.addTextSection(x,o)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let o="";for(let f=0;f<i.length;f++){const _=i.charCodeAt(f+1)||null,x=i.charCodeAt(f-1)||null;o+=_&&Yd(_)&&!Xh[i[f+1]]||x&&Yd(x)&&!Xh[i[f-1]]||!Xh[i[f]]?i[f]:Xh[i[f]]}return o}(this.text)}trim(){let i=0;for(let f=0;f<this.text.length&&vp[this.text.charCodeAt(f)];f++)i++;let o=this.text.length;for(let f=this.text.length-1;f>=0&&f>=i&&vp[this.text.charCodeAt(f)];f--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const f=new Wh;return f.text=this.text.substring(i,o),f.sectionIndex=this.sectionIndex.slice(i,o),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}getMaxImageSize(i){let o=0,f=0;for(let _=0;_<this.length();_++){const x=this.getSection(_);if(x.imageName){const S=i[x.imageName];if(!S)continue;const A=S.displaySize;o=Math.max(o,A[0]),f=Math.max(f,A[1])}}return{maxImageWidth:o,maxImageHeight:f}}addTextSection(i,o){this.text+=i.text,this.sections.push(df.forText(i.scale,i.fontStack||o,i.verticalAlign));const f=this.sections.length-1;for(let _=0;_<i.text.length;++_)this.sectionIndex.push(f)}addImageSection(i){const o=i.image?i.image.name:"";if(o.length===0)return void Vn("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(df.forImage(o,i.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Vn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _p(s,i,o,f,_,x,S,A,I,O,z,V,Z,X,Q){const ae=Wh.fromFeature(s,_);let ce;V===y.ao.vertical&&ae.verticalizePunctuation();const{processBidirectionalText:me,processStyledBidirectionalText:ze}=sa;if(me&&ae.sections.length===1){ce=[];const Ze=me(ae.toString(),Gm(ae,O,x,i,f,X));for(const Je of Ze){const ht=new Wh;ht.text=Je,ht.sections=ae.sections;for(let Dt=0;Dt<Je.length;Dt++)ht.sectionIndex.push(0);ce.push(ht)}}else if(ze){ce=[];const Ze=ze(ae.text,ae.sectionIndex,Gm(ae,O,x,i,f,X));for(const Je of Ze){const ht=new Wh;ht.text=Je[0],ht.sectionIndex=Je[1],ht.sections=ae.sections,ce.push(ht)}}else ce=function(Ze,Je){const ht=[],Dt=Ze.text;let xt=0;for(const Ct of Je)ht.push(Ze.substring(xt,Ct)),xt=Ct;return xt<Dt.length&&ht.push(Ze.substring(xt,Dt.length)),ht}(ae,Gm(ae,O,x,i,f,X));const xe=[],Ie={positionedLines:xe,text:ae.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:V,iconsInText:!1,verticalizable:!1};return function(Ze,Je,ht,Dt,xt,Ct,Vt,At,Tt,it,Yt,Jt){let Gt=0,Lt=0,kn=0,$i=0;const Wi=At==="right"?1:At==="left"?0:.5,fa=ai/Jt;let Io=0;for(const Zi of xt){Zi.trim();const cr=Zi.getMaxScale(),vr={positionedGlyphs:[],lineOffset:0};Ze.positionedLines[Io]=vr;const Fr=vr.positionedGlyphs;let Br=0;if(!Zi.length()){Lt+=Ct,++Io;continue}const ao=Gb(Dt,Zi,fa);for(let ja=0;ja<Zi.length();ja++){const Cr=Zi.getSection(ja),hr=Zi.getSectionIndex(ja),a=Zi.getCharCode(ja),h=$m(Tt,Yt,a);let g;if(Cr.imageName){if(Ze.iconsInText=!0,Cr.scale=Cr.scale*fa,g=Oy(Cr,h,cr,ao,Dt),!g)continue;Br=Math.max(Br,g.imageOffset)}else if(g=ff(Cr,a,h,ao,Je,ht),!g)continue;const{rect:w,metrics:D,baselineOffset:L}=g;Fr.push({glyph:a,imageName:Cr.imageName,x:Gt,y:Lt+L+-17,vertical:h,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:hr,metrics:D,rect:w}),h?(Ze.verticalizable=!0,Gt+=(Cr.imageName?D.advance:ai)*Cr.scale+it):Gt+=D.advance*Cr.scale+it}Fr.length!==0&&(kn=Math.max(Gt-it,kn),Zm(Fr,0,Fr.length-1,Wi)),Gt=0,vr.lineOffset=Math.max(Br,(cr-1)*ai);const ur=Ct*cr+Br;Lt+=ur,$i=Math.max(ur,$i),++Io}const{horizontalAlign:pa,verticalAlign:jr}=Py(Vt);(function(Zi,cr,vr,Fr,Br,ao,ur,ja,Cr){const hr=(cr-vr)*Br;let a=0;a=ao!==ur?-ja*Fr- -17:-Fr*Cr*ur+.5*ur;for(const h of Zi)for(const g of h.positionedGlyphs)g.x+=hr,g.y+=a})(Ze.positionedLines,Wi,pa,jr,kn,$i,Ct,Lt,xt.length),Ze.top+=-jr*Lt,Ze.bottom=Ze.top+Lt,Ze.left+=-pa*kn,Ze.right=Ze.left+kn}(Ie,i,o,f,ce,S,A,I,V,O,Z,Q),!function(Ze){for(const Je of Ze)if(Je.positionedGlyphs.length!==0)return!1;return!0}(xe)&&Ie}const vp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},F_={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Um={40:!0};function Ry(s,i,o,f,_,x){if(i.imageName){const S=f[i.imageName];return S?S.displaySize[0]*i.scale*ai/x+_:0}{const S=o[i.fontStack],A=S&&S[s];return A?A.metrics.advance*i.scale+_:0}}function ky(s,i,o,f){const _=Math.pow(s-i,2);return f?s<i?_/2:2*_:_+Math.abs(o)*o}function Bi(s,i,o){let f=0;return s===10&&(f-=1e4),o&&(f+=150),s!==40&&s!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function Vm(s,i,o,f,_,x){let S=null,A=ky(i,o,_,x);for(const I of f){const O=ky(i-I.x,o,_,x)+I.badness;O<=A&&(S=I,A=O)}return{index:s,x:i,priorBreak:S,badness:A}}function B_(s){return s?B_(s.priorBreak).concat(s.index):[]}function Gm(s,i,o,f,_,x){if(!s)return[];const S=[],A=function(V,Z,X,Q,ae,ce){let me=0;for(let ze=0;ze<V.length();ze++){const xe=V.getSection(ze);me+=Ry(V.getCharCode(ze),xe,Q,ae,Z,ce)}return me/Math.max(1,Math.ceil(me/X))}(s,i,o,f,_,x),I=s.text.indexOf("​")>=0;let O=0;for(let V=0;V<s.length();V++){const Z=s.getSection(V),X=s.getCharCode(V);if(vp[X]||(O+=Ry(X,Z,f,_,i,x)),V<s.length()-1){const Q=!((z=X)<11904)&&(!!In["CJK Compatibility Forms"](z)||!!In["CJK Compatibility"](z)||!!In["CJK Strokes"](z)||!!In["CJK Symbols and Punctuation"](z)||!!In["Enclosed CJK Letters and Months"](z)||!!In["Halfwidth and Fullwidth Forms"](z)||!!In["Ideographic Description Characters"](z)||!!In["Vertical Forms"](z)||bc.test(String.fromCodePoint(z)));(F_[X]||Q||Z.imageName||V!==s.length()-2&&Um[s.getCharCode(V+1)])&&S.push(Vm(V+1,O,A,S,Bi(X,s.getCharCode(V+1),Q&&I),!1))}}var z;return B_(Vm(s.length(),O,A,S,0,!0))}function Py(s){let i=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function Gb(s,i,o){const f=i.getMaxScale()*ai,{maxImageWidth:_,maxImageHeight:x}=i.getMaxImageSize(s),S=Math.max(f,x*o);return{verticalLineContentWidth:Math.max(f,_*o),horizontalLineContentHeight:S}}function U_(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function $m(s,i,o){return!(s===y.ao.horizontal||!i&&!Oh(o)||i&&(vp[o]||(f=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function ff(s,i,o,f,_,x){const S=x[s.fontStack],A=function(O,z,V,Z){if(O&&O.rect)return O;const X=z[V.fontStack],Q=X&&X[Z];return Q?{rect:null,metrics:Q.metrics}:null}(S&&S[i],_,s,i);if(A===null)return null;let I;if(o)I=f.verticalLineContentWidth-s.scale*ai;else{const O=U_(s.verticalAlign);I=(f.horizontalLineContentHeight-s.scale*ai)*O}return{rect:A.rect,metrics:A.metrics,baselineOffset:I}}function Oy(s,i,o,f,_){const x=_[s.imageName];if(!x)return null;const S=x.paddedRect,A=x.displaySize,I={width:A[0],height:A[1],left:1,top:-3,advance:i?A[1]:A[0]};let O;if(i)O=f.verticalLineContentWidth-A[1]*s.scale;else{const z=U_(s.verticalAlign);O=(f.horizontalLineContentHeight-A[1]*s.scale)*z}return{rect:S,metrics:I,baselineOffset:O,imageOffset:(i?A[0]:A[1])*s.scale-ai*o}}function Zm(s,i,o,f){if(f===0)return;const _=s[o],x=(s[o].x+_.metrics.advance*_.scale)*f;for(let S=i;S<=o;S++)s[S].x-=x}function Ly(s,i,o){const{horizontalAlign:f,verticalAlign:_}=Py(o),x=i[0]-s.displaySize[0]*f,S=i[1]-s.displaySize[1]*_;return{image:s,top:S,bottom:S+s.displaySize[1],left:x,right:x+s.displaySize[0]}}function Du(s){var i,o;let f=s.left,_=s.top,x=s.right-f,S=s.bottom-_;const A=(i=s.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",I=(o=s.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",O=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(I==="proportional"){if(A==="stretchOnly"&&x/S<O||A==="proportional"){const z=Math.ceil(S*O);f*=z/x,x=z}}else if(A==="proportional"&&I==="stretchOnly"&&O!==0&&x/S>O){const z=Math.ceil(x/O);_*=z/S,S=z}return{x1:f,y1:_,x2:f+x,y2:_+S}}function cl(s,i,o,f,_,x){const S=s.image;let A;if(S.content){const ce=S.content,me=S.pixelRatio||1;A=[ce[0]/me,ce[1]/me,S.displaySize[0]-ce[2]/me,S.displaySize[1]-ce[3]/me]}const I=i.left*x,O=i.right*x;let z,V,Z,X;o==="width"||o==="both"?(X=_[0]+I-f[3],V=_[0]+O+f[1]):(X=_[0]+(I+O-S.displaySize[0])/2,V=X+S.displaySize[0]);const Q=i.top*x,ae=i.bottom*x;return o==="height"||o==="both"?(z=_[1]+Q-f[0],Z=_[1]+ae+f[2]):(z=_[1]+(Q+ae-S.displaySize[1])/2,Z=z+S.displaySize[1]),{image:S,top:z,right:V,bottom:Z,left:X,collisionPadding:A}}const qo=128,Iu=32640;function Ny(s,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new ti(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:_}=o;let x=0;for(;x<f.length&&f[x]<=s;)x++;x=Math.max(0,x-1);let S=x;for(;S<f.length&&f[S]<s+1;)S++;S=Math.min(f.length-1,S);const A=f[x],I=f[S];return o.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:I,interpolationType:_}:{kind:"camera",minZoom:A,maxZoom:I,minSize:o.evaluate(new ti(A)),maxSize:o.evaluate(new ti(I)),interpolationType:_}}}function Ym(s,i,o){let f="never";const _=s.get(i);return _?f=_:s.get(o)&&(f="always"),f}const V_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function bp(s,i,o,f,_,x,S,A,I,O,z,V,Z){const X=A?Math.min(Iu,Math.round(A[0])):0,Q=A?Math.min(Iu,Math.round(A[1])):0;s.emplaceBack(i,o,Math.round(32*f),Math.round(32*_),x,S,(X<<1)+(I?1:0),Q,16*O,16*z,256*V,256*Z)}function zy(s,i,o){s.emplaceBack(i.x,i.y,o),s.emplaceBack(i.x,i.y,o),s.emplaceBack(i.x,i.y,o),s.emplaceBack(i.x,i.y,o)}function jy(s){for(const i of s.sections)if(sp(i.text))return!0;return!1}class Hm{constructor(i){this.layoutVertexArray=new ct,this.indexArray=new qn,this.programConfigurations=i,this.segments=new un,this.dynamicLayoutVertexArray=new Bt,this.opacityVertexArray=new bn,this.hasVisibleVertices=!1,this.placedSymbolArray=new he}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,o,f,_){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,lf.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,cf.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,V_,!0),this.opacityVertexBuffer.itemSize=1),(f||_)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kt("SymbolBuffers",Hm);class qm{constructor(i,o,f){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new f,this.segments=new un,this.collisionVertexArray=new zi}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Ey.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kt("CollisionBuffers",qm);class pf{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(S=>S.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ny(this.zoom,o["text-size"]),this.iconSizeData=Ny(this.zoom,o["icon-size"]);const f=this.layers[0].layout,_=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=Ym(f,"text-overlap","text-allow-overlap")!=="never"||Ym(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(S=>y.ao[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=i.sourceID}createArrays(){this.text=new Hm(new Sa(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Hm(new Sa(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new pe,this.lineVertexArray=new ve,this.symbolInstances=new fe,this.textAnchorOffsets=new Se}calculateGlyphDependencies(i,o,f,_,x){for(let S=0;S<i.length;S++)if(o[i.charCodeAt(S)]=!0,(f||_)&&x){const A=Xh[i.charAt(S)];A&&(o[A.charCodeAt(0)]=!0)}}populate(i,o,f){const _=this.layers[0],x=_.layout,S=x.get("text-font"),A=x.get("text-field"),I=x.get("icon-image"),O=(A.value.kind!=="constant"||A.value.value instanceof pr&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),z=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,V=x.get("symbol-sort-key");if(this.features=[],!O&&!z)return;const Z=o.iconDependencies,X=o.glyphDependencies,Q=o.availableImages,ae=new ti(this.zoom);for(const{feature:ce,id:me,index:ze,sourceLayerIndex:xe}of i){const Ie=_._featureFilter.needGeometry,Ze=Mc(ce,Ie);if(!_._featureFilter.filter(ae,Ze,f))continue;let Je,ht;if(Ie||(Ze.geometry=So(ce)),O){const xt=_.getValueAndResolveTokens("text-field",Ze,f,Q),Ct=pr.factory(xt),Vt=this.hasRTLText=this.hasRTLText||jy(Ct);(!Vt||sa.getRTLTextPluginStatus()==="unavailable"||Vt&&sa.isParsed())&&(Je=gp(Ct,_,Ze))}if(z){const xt=_.getValueAndResolveTokens("icon-image",Ze,f,Q);ht=xt instanceof qr?xt:qr.fromString(xt)}if(!Je&&!ht)continue;const Dt=this.sortFeaturesByKey?V.evaluate(Ze,{},f):void 0;if(this.features.push({id:me,text:Je,icon:ht,index:ze,sourceLayerIndex:xe,geometry:Ze.geometry,properties:ce.properties,type:Hh.types[ce.type],sortKey:Dt}),ht&&(Z[ht.name]=!0),Je){const xt=S.evaluate(Ze,{},f).join(","),Ct=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ao.vertical)>=0;for(const Vt of Je.sections)if(Vt.image)Z[Vt.image.name]=!0;else{const At=Vo(Je.toString()),Tt=Vt.fontStack||xt,it=X[Tt]=X[Tt]||{};this.calculateGlyphDependencies(Vt.text,it,Ct,this.allowVerticalPlacement,At)}}}x.get("symbol-placement")==="line"&&(this.features=function(ce){const me={},ze={},xe=[];let Ie=0;function Ze(xt){xe.push(ce[xt]),Ie++}function Je(xt,Ct,Vt){const At=ze[xt];return delete ze[xt],ze[Ct]=At,xe[At].geometry[0].pop(),xe[At].geometry[0]=xe[At].geometry[0].concat(Vt[0]),At}function ht(xt,Ct,Vt){const At=me[Ct];return delete me[Ct],me[xt]=At,xe[At].geometry[0].shift(),xe[At].geometry[0]=Vt[0].concat(xe[At].geometry[0]),At}function Dt(xt,Ct,Vt){const At=Vt?Ct[0][Ct[0].length-1]:Ct[0][0];return`${xt}:${At.x}:${At.y}`}for(let xt=0;xt<ce.length;xt++){const Ct=ce[xt],Vt=Ct.geometry,At=Ct.text?Ct.text.toString():null;if(!At){Ze(xt);continue}const Tt=Dt(At,Vt),it=Dt(At,Vt,!0);if(Tt in ze&&it in me&&ze[Tt]!==me[it]){const Yt=ht(Tt,it,Vt),Jt=Je(Tt,it,xe[Yt].geometry);delete me[Tt],delete ze[it],ze[Dt(At,xe[Jt].geometry,!0)]=Jt,xe[Yt].geometry=null}else Tt in ze?Je(Tt,it,Vt):it in me?ht(Tt,it,Vt):(Ze(xt),me[Tt]=Ie-1,ze[it]=Ie-1)}return xe.filter(xt=>xt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,me)=>ce.sortKey-me.sortKey)}update(i,o,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,o,this.layers,{imagePositions:f}),this.icon.programConfigurations.updatePaintArrays(i,o,this.layers,{imagePositions:f}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const f=this.lineVertexArray.length;if(i.segment!==void 0){let _=i.dist(o[i.segment+1]),x=i.dist(o[i.segment]);const S={};for(let A=i.segment+1;A<o.length;A++)S[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:_},A<o.length-1&&(_+=o[A+1].dist(o[A]));for(let A=i.segment||0;A>=0;A--)S[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:x},A>0&&(x+=o[A-1].dist(o[A]));for(let A=0;A<o.length;A++){const I=S[A];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,o,f,_,x,S,A,I,O,z,V,Z){const X=i.indexArray,Q=i.layoutVertexArray,ae=i.segments.prepareSegment(4*o.length,Q,X,this.canOverlap?S.sortKey:void 0),ce=this.glyphOffsetArray.length,me=ae.vertexLength,ze=this.allowVerticalPlacement&&A===y.ao.vertical?Math.PI/2:0,xe=S.text&&S.text.sections;for(let Ie=0;Ie<o.length;Ie++){const{tl:Ze,tr:Je,bl:ht,br:Dt,tex:xt,pixelOffsetTL:Ct,pixelOffsetBR:Vt,minFontScaleX:At,minFontScaleY:Tt,glyphOffset:it,isSDF:Yt,sectionIndex:Jt}=o[Ie],Gt=ae.vertexLength,Lt=it[1];bp(Q,I.x,I.y,Ze.x,Lt+Ze.y,xt.x,xt.y,f,Yt,Ct.x,Ct.y,At,Tt),bp(Q,I.x,I.y,Je.x,Lt+Je.y,xt.x+xt.w,xt.y,f,Yt,Vt.x,Ct.y,At,Tt),bp(Q,I.x,I.y,ht.x,Lt+ht.y,xt.x,xt.y+xt.h,f,Yt,Ct.x,Vt.y,At,Tt),bp(Q,I.x,I.y,Dt.x,Lt+Dt.y,xt.x+xt.w,xt.y+xt.h,f,Yt,Vt.x,Vt.y,At,Tt),zy(i.dynamicLayoutVertexArray,I,ze),X.emplaceBack(Gt,Gt+2,Gt+1),X.emplaceBack(Gt+1,Gt+2,Gt+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),Ie!==o.length-1&&Jt===o[Ie+1].sectionIndex||i.programConfigurations.populatePaintArrays(Q.length,S,S.index,{imagePositions:{},canonical:Z,formattedSection:xe&&xe[Jt]})}i.placedSymbolArray.emplaceBack(I.x,I.y,ce,this.glyphOffsetArray.length-ce,me,O,z,I.segment,f?f[0]:0,f?f[1]:0,_[0],_[1],A,0,!1,0,V)}_addCollisionDebugVertex(i,o,f,_,x,S){return o.emplaceBack(0,0),i.emplaceBack(f.x,f.y,_,x,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(i,o,f,_,x,S,A){const I=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),O=I.vertexLength,z=x.layoutVertexArray,V=x.collisionVertexArray,Z=A.anchorX,X=A.anchorY;this._addCollisionDebugVertex(z,V,S,Z,X,new E(i,o)),this._addCollisionDebugVertex(z,V,S,Z,X,new E(f,o)),this._addCollisionDebugVertex(z,V,S,Z,X,new E(f,_)),this._addCollisionDebugVertex(z,V,S,Z,X,new E(i,_)),I.vertexLength+=4;const Q=x.indexArray;Q.emplaceBack(O,O+1),Q.emplaceBack(O+1,O+2),Q.emplaceBack(O+2,O+3),Q.emplaceBack(O+3,O),I.primitiveLength+=4}addDebugCollisionBoxes(i,o,f,_){for(let x=i;x<o;x++){const S=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,_?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new qm(jn,zm.members,Ci),this.iconCollisionBox=new qm(jn,zm.members,Ci);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(i,o,f,_,x,S,A,I,O){const z={};for(let V=o;V<f;V++){const Z=i.get(V);z.textBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.textFeatureIndex=Z.featureIndex;break}for(let V=_;V<x;V++){const Z=i.get(V);z.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.verticalTextFeatureIndex=Z.featureIndex;break}for(let V=S;V<A;V++){const Z=i.get(V);z.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.iconFeatureIndex=Z.featureIndex;break}for(let V=I;V<O;V++){const Z=i.get(V);z.verticalIconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.verticalIconFeatureIndex=Z.featureIndex;break}return z}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const f=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,o){const f=i.placedSymbolArray.get(o),_=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<_;x+=4)i.indexArray.emplaceBack(x,x+2,x+1),i.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),f=Math.cos(i),_=[],x=[],S=[];for(let A=0;A<this.symbolInstances.length;++A){S.push(A);const I=this.symbolInstances.get(A);_.push(0|Math.round(o*I.anchorX+f*I.anchorY)),x.push(I.featureIndex)}return S.sort((A,I)=>_[A]-_[I]||x[I]-x[A]),S}addToSortKeyRanges(i,o){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===o?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const f=this.symbolInstances.get(o);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((_,x,S)=>{_>=0&&S.indexOf(_)===x&&this.addIndicesForPlacedSymbol(this.text,_)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Xm,Wm;kt("SymbolBucket",pf,{omit:["layers","collisionBoxArray","features","compareText"]}),pf.MAX_GLYPHS=65535,pf.addDynamicAttributes=zy;var Fy={get paint(){return Wm=Wm||new $n({"icon-opacity":new qt(Fe.paint_symbol["icon-opacity"]),"icon-color":new qt(Fe.paint_symbol["icon-color"]),"icon-halo-color":new qt(Fe.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(Fe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(Fe.paint_symbol["icon-halo-blur"]),"icon-translate":new Nt(Fe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nt(Fe.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(Fe.paint_symbol["text-opacity"]),"text-color":new qt(Fe.paint_symbol["text-color"],{runtimeType:rr,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new qt(Fe.paint_symbol["text-halo-color"]),"text-halo-width":new qt(Fe.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(Fe.paint_symbol["text-halo-blur"]),"text-translate":new Nt(Fe.paint_symbol["text-translate"]),"text-translate-anchor":new Nt(Fe.paint_symbol["text-translate-anchor"])})},get layout(){return Xm=Xm||new $n({"symbol-placement":new Nt(Fe.layout_symbol["symbol-placement"]),"symbol-spacing":new Nt(Fe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nt(Fe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(Fe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Nt(Fe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Nt(Fe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Nt(Fe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Nt(Fe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nt(Fe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nt(Fe.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(Fe.layout_symbol["icon-size"]),"icon-text-fit":new Nt(Fe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Nt(Fe.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(Fe.layout_symbol["icon-image"]),"icon-rotate":new qt(Fe.layout_symbol["icon-rotate"]),"icon-padding":new qt(Fe.layout_symbol["icon-padding"]),"icon-keep-upright":new Nt(Fe.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(Fe.layout_symbol["icon-offset"]),"icon-anchor":new qt(Fe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nt(Fe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nt(Fe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nt(Fe.layout_symbol["text-rotation-alignment"]),"text-field":new qt(Fe.layout_symbol["text-field"]),"text-font":new qt(Fe.layout_symbol["text-font"]),"text-size":new qt(Fe.layout_symbol["text-size"]),"text-max-width":new qt(Fe.layout_symbol["text-max-width"]),"text-line-height":new Nt(Fe.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(Fe.layout_symbol["text-letter-spacing"]),"text-justify":new qt(Fe.layout_symbol["text-justify"]),"text-radial-offset":new qt(Fe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Nt(Fe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new qt(Fe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new qt(Fe.layout_symbol["text-anchor"]),"text-max-angle":new Nt(Fe.layout_symbol["text-max-angle"]),"text-writing-mode":new Nt(Fe.layout_symbol["text-writing-mode"]),"text-rotate":new qt(Fe.layout_symbol["text-rotate"]),"text-padding":new Nt(Fe.layout_symbol["text-padding"]),"text-keep-upright":new Nt(Fe.layout_symbol["text-keep-upright"]),"text-transform":new qt(Fe.layout_symbol["text-transform"]),"text-offset":new qt(Fe.layout_symbol["text-offset"]),"text-allow-overlap":new Nt(Fe.layout_symbol["text-allow-overlap"]),"text-overlap":new Nt(Fe.layout_symbol["text-overlap"]),"text-ignore-placement":new Nt(Fe.layout_symbol["text-ignore-placement"]),"text-optional":new Nt(Fe.layout_symbol["text-optional"])})}};class G_{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:ps,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt("FormatSectionOverride",G_,{omit:["defaultValue"]});class Ru extends to{constructor(i,o){super(i,Fy,o)}recalculate(i,o){if(super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const _=[];for(const x of f)_.indexOf(x)<0&&_.push(x);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,o,f,_){const x=this.layout.get(i).evaluate(o,{},f,_),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||Xs(S.value)||!x?x:function(A,I){return I.replace(/{([^{}]+)}/g,(O,z)=>A&&z in A?String(A[z]):"")}(o.properties,x)}createBucket(i){return new pf(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of Fy.paint.overridableProperties){if(!Ru.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),f=new G_(o),_=new Mh(f,o.property.specification);let x=null;x=o.value.kind==="constant"||o.value.kind==="source"?new Il("source",_):new cu("composite",_,o.value.zoomStops),this.paint._values[i]=new Ja(o.property,x,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,f){return!(!this.layout||o.isDataDriven()||f.isDataDriven())&&Ru.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const f=i.get("text-field"),_=Fy.paint.properties[o];let x=!1;const S=A=>{for(const I of A)if(_.overrides&&_.overrides.hasOverride(I))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof pr)S(f.value.value.sections);else if(f.value.kind==="source"||f.value.kind==="composite"){const A=O=>{x||(O instanceof po&&Qt(O.value)===Ia?S(O.value.sections):O instanceof lc?S(O.sections):O.eachChild(A))},I=f.value;I._styleExpression&&A(I._styleExpression.expression)}return x}}let $_;var Z_={get paint(){return $_=$_||new $n({"background-color":new Nt(Fe.paint_background["background-color"]),"background-pattern":new Nl(Fe.paint_background["background-pattern"]),"background-opacity":new Nt(Fe.paint_background["background-opacity"])})}};class Zn extends to{constructor(i,o){super(i,Z_,o)}}let Qm;var Km={get paint(){return Qm=Qm||new $n({"raster-opacity":new Nt(Fe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Nt(Fe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nt(Fe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nt(Fe.paint_raster["raster-brightness-max"]),"raster-saturation":new Nt(Fe.paint_raster["raster-saturation"]),"raster-contrast":new Nt(Fe.paint_raster["raster-contrast"]),"raster-resampling":new Nt(Fe.paint_raster["raster-resampling"]),"raster-fade-duration":new Nt(Fe.paint_raster["raster-fade-duration"])})}};class By extends to{constructor(i,o){super(i,Km,o)}}class Y_ extends to{constructor(i,o){super(i,{},o),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Uy{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const xp={once:!0},mf=63710088e-1;class Xo{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xo(Ln(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,f=this.lat*o,_=i.lat*o,x=Math.sin(f)*Math.sin(_)+Math.cos(f)*Math.cos(_)*Math.cos((i.lng-this.lng)*o);return mf*Math.acos(Math.min(x,1))}static convert(i){if(i instanceof Xo)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Xo(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Xo(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Vy=2*Math.PI*mf;function H_(s){return Vy*Math.cos(s*Math.PI/180)}function q_(s){return(180+s)/360}function Gy(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function $y(s,i){return s/H_(i)}function gf(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function bi(s,i){return s*H_(gf(i))}class Qh{constructor(i,o,f=0){this.x=+i,this.y=+o,this.z=+f}static fromLngLat(i,o=0){const f=Xo.convert(i);return new Qh(q_(f.lng),Gy(f.lat),$y(o,f.lat))}toLngLat(){return new Xo(360*this.x-180,gf(this.y))}toAltitude(){return bi(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Vy*(i=gf(this.y),1/Math.cos(i*Math.PI/180));var i}}function ha(s,i,o){var f=2*Math.PI*6378137/256/Math.pow(2,o);return[s*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}class Zy{constructor(i,o,f){if(!function(_,x,S){return!(_<0||_>25||S<0||S>=Math.pow(2,_)||x<0||x>=Math.pow(2,_))}(i,o,f))throw new Error(`x=${o}, y=${f}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=o,this.y=f,this.key=Lc(0,i,i,o,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o,f){const _=(S=this.y,A=this.z,I=ha(256*(x=this.x),256*(S=Math.pow(2,A)-S-1),A),O=ha(256*(x+1),256*(S+1),A),I[0]+","+I[1]+","+O[0]+","+O[1]);var x,S,A,I,O;const z=function(V,Z,X){let Q,ae="";for(let ce=V;ce>0;ce--)Q=1<<ce-1,ae+=(Z&Q?1:0)+(X&Q?2:0);return ae}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,_)}isChildOf(i){const o=this.z-i.z;return o>0&&i.x===this.x>>o&&i.y===this.y>>o}getTilePoint(i){const o=Math.pow(2,this.z);return new E((i.x*o-this.x)*ut,(i.y*o-this.y)*ut)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Jm{constructor(i,o){this.wrap=i,this.canonical=o,this.key=Lc(i,o.z,o.z,o.x,o.y)}}class ro{constructor(i,o,f,_,x){if(this.terrainRttPosMatrix32f=null,i<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${f}`);this.overscaledZ=i,this.wrap=o,this.canonical=new Zy(f,+_,+x),this.key=Lc(o,i,f,_,x)}clone(){return new ro(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-i;return i>this.canonical.z?new ro(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ro(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-i;return i>this.canonical.z?Lc(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y):Lc(this.wrap*+o,i,i,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new ro(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,f=2*this.canonical.x,_=2*this.canonical.y;return[new ro(o,this.wrap,o,f,_),new ro(o,this.wrap,o,f+1,_),new ro(o,this.wrap,o,f,_+1),new ro(o,this.wrap,o,f+1,_+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new ro(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new ro(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Jm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Qh(i.x-this.wrap,i.y))}}function Lc(s,i,o,f,_){(s*=2)<0&&(s=-1*s-1);const x=1<<o;return(x*x*s+x*_+f).toString(36)+o.toString(36)+i.toString(36)}function yf(s,i){return i?s.properties[i]:s.id}kt("CanonicalTileID",Zy),kt("OverscaledTileID",ro,{omit:["terrainRttPosMatrix32f"]});class ku{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const o=new ku;return o.extend(i(new E(this.minX,this.minY))),o.extend(i(new E(this.maxX,this.minY))),o.extend(i(new E(this.minX,this.maxY))),o.extend(i(new E(this.maxX,this.maxY))),o}static fromPoints(i){const o=new ku;for(const f of i)o.extend(f);return o}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class eg{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const f=i[o];this._stringToNumber[f]=o,this._numberToString[o]=f}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class tg{constructor(i,o,f,_,x){this.type="Feature",this._vectorTileFeature=i,i._z=o,i._x=f,i._y=_,this.properties=i.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(i[o]=this[o]);return i}}class X_{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Js(ut,16,0),this.grid3D=new Js(ut,16,0),this.featureIndexArray=new _e,this.promoteId=o}insert(i,o,f,_,x,S){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,_,x);const I=S?this.grid3D:this.grid;for(let O=0;O<o.length;O++){const z=o[O],V=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<z.length;Z++){const X=z[Z];V[0]=Math.min(V[0],X.x),V[1]=Math.min(V[1],X.y),V[2]=Math.max(V[2],X.x),V[3]=Math.max(V[3],X.y)}V[0]<ut&&V[1]<ut&&V[2]>=0&&V[3]>=0&&I.insert(A,V[0],V[1],V[2],V[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new P_(new Fm(this.rawTileData)).layers,this.sourceLayerCoder=new eg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,o,f,_){this.loadVTLayers();const x=i.params,S=ut/i.tileSize/i.scale,A=Rl(x.filter,x.globalState),I=i.queryGeometry,O=i.queryPadding*S,z=ku.fromPoints(I),V=this.grid.query(z.minX-O,z.minY-O,z.maxX+O,z.maxY+O),Z=ku.fromPoints(i.cameraQueryGeometry).expandBy(O),X=this.grid3D.query(Z.minX,Z.minY,Z.maxX,Z.maxY,(ce,me,ze,xe)=>function(Ie,Ze,Je,ht,Dt){for(const Ct of Ie)if(Ze<=Ct.x&&Je<=Ct.y&&ht>=Ct.x&&Dt>=Ct.y)return!0;const xt=[new E(Ze,Je),new E(Ze,Dt),new E(ht,Dt),new E(ht,Je)];if(Ie.length>2){for(const Ct of xt)if(Bh(Ie,Ct))return!0}for(let Ct=0;Ct<Ie.length-1;Ct++)if(Lb(Ie[Ct],Ie[Ct+1],xt))return!0;return!1}(i.cameraQueryGeometry,ce-O,me-O,ze+O,xe+O));for(const ce of X)V.push(ce);V.sort($b);const Q={};let ae;for(let ce=0;ce<V.length;ce++){const me=V[ce];if(me===ae)continue;ae=me;const ze=this.featureIndexArray.get(me);let xe=null;this.loadMatchingFeature(Q,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,A,x.layers,x.availableImages,o,f,_,(Ie,Ze,Je)=>(xe||(xe=So(Ie)),Ze.queryIntersectsFeature({queryGeometry:I,feature:Ie,featureState:Je,geometry:xe,zoom:this.z,transform:i.transform,pixelsToTileUnits:S,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return Q}loadMatchingFeature(i,o,f,_,x,S,A,I,O,z,V){const Z=this.bucketLayerIDs[o];if(S&&!Z.some(ce=>S.has(ce)))return;const X=this.sourceLayerCoder.decode(f),Q=this.vtLayers[X].feature(_);if(x.needGeometry){const ce=Mc(Q,!0);if(!x.filter(new ti(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!x.filter(new ti(this.tileID.overscaledZ),Q))return;const ae=this.getId(Q,X);for(let ce=0;ce<Z.length;ce++){const me=Z[ce];if(S&&!S.has(me))continue;const ze=I[me];if(!ze)continue;let xe={};ae&&z&&(xe=z.getState(ze.sourceLayer||"_geojsonTileLayer",ae));const Ie=Wt({},O[me]);Ie.paint=Yy(Ie.paint,ze.paint,Q,xe,A),Ie.layout=Yy(Ie.layout,ze.layout,Q,xe,A);const Ze=!V||V(Q,ze,xe);if(!Ze)continue;const Je=new tg(Q,this.z,this.x,this.y,ae);Je.layer=Ie;let ht=i[me];ht===void 0&&(ht=i[me]=[]),ht.push({featureIndex:_,feature:Je,intersectionZ:Ze})}}lookupSymbolFeatures(i,o,f,_,x,S,A,I){const O={};this.loadVTLayers();const z=Rl(x.filterSpec,x.globalState);for(const V of i)this.loadMatchingFeature(O,f,_,V,z,S,A,I,o);return O}hasLayer(i){for(const o of this.bucketLayerIDs)for(const f of o)if(i===f)return!0;return!1}getId(i,o){var f;let _=i.id;return this.promoteId&&(_=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof _=="boolean"&&(_=Number(_)),_===void 0&&(!((f=i.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(_=Number(i.properties.cluster_id))),_}}function Yy(s,i,o,f,_){return br(s,(x,S)=>{const A=i instanceof tl?i.get(S):null;return A&&A.evaluate?A.evaluate(o,f,_):A})}function $b(s,i){return i-s}function Hy(s,i,o,f,_){const x=[];for(let S=0;S<s.length;S++){const A=s[S];let I;for(let O=0;O<A.length-1;O++){let z=A[O],V=A[O+1];z.x<i&&V.x<i||(z.x<i?z=new E(i,z.y+(i-z.x)/(V.x-z.x)*(V.y-z.y))._round():V.x<i&&(V=new E(i,z.y+(i-z.x)/(V.x-z.x)*(V.y-z.y))._round()),z.y<o&&V.y<o||(z.y<o?z=new E(z.x+(o-z.y)/(V.y-z.y)*(V.x-z.x),o)._round():V.y<o&&(V=new E(z.x+(o-z.y)/(V.y-z.y)*(V.x-z.x),o)._round()),z.x>=f&&V.x>=f||(z.x>=f?z=new E(f,z.y+(f-z.x)/(V.x-z.x)*(V.y-z.y))._round():V.x>=f&&(V=new E(f,z.y+(f-z.x)/(V.x-z.x)*(V.y-z.y))._round()),z.y>=_&&V.y>=_||(z.y>=_?z=new E(z.x+(_-z.y)/(V.y-z.y)*(V.x-z.x),_)._round():V.y>=_&&(V=new E(z.x+(_-z.y)/(V.y-z.y)*(V.x-z.x),_)._round()),I&&z.equals(I[I.length-1])||(I=[z],x.push(I)),I.push(V)))))}}return x}kt("FeatureIndex",X_,{omit:["rawTileData","sourceLayerCoder"]});class Pu extends E{constructor(i,o,f,_){super(i,o),this.angle=f,_!==void 0&&(this.segment=_)}clone(){return new Pu(this.x,this.y,this.angle,this.segment)}}function W_(s,i,o,f,_){if(i.segment===void 0||o===0)return!0;let x=i,S=i.segment+1,A=0;for(;A>-o/2;){if(S--,S<0)return!1;A-=s[S].dist(x),x=s[S]}A+=s[S].dist(s[S+1]),S++;const I=[];let O=0;for(;A<o/2;){const z=s[S],V=s[S+1];if(!V)return!1;let Z=s[S-1].angleTo(z)-z.angleTo(V);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:A,angleDelta:Z}),O+=Z;A-I[0].distance>f;)O-=I.shift().angleDelta;if(O>_)return!1;S++,A+=z.dist(V)}return!0}function Nc(s){let i=0;for(let o=0;o<s.length-1;o++)i+=s[o].dist(s[o+1]);return i}function qy(s,i,o){return s?.6*i*o:0}function ng(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function Zb(s,i,o,f,_,x){const S=qy(o,_,x),A=ng(o,f)*x;let I=0;const O=Nc(s)/2;for(let z=0;z<s.length-1;z++){const V=s[z],Z=s[z+1],X=V.dist(Z);if(I+X>O){const Q=(O-I)/X,ae=ws.number(V.x,Z.x,Q),ce=ws.number(V.y,Z.y,Q),me=new Pu(ae,ce,Z.angleTo(V),z);return me._round(),!S||W_(s,me,A,S,i)?me:void 0}I+=X}}function Yb(s,i,o,f,_,x,S,A,I){const O=qy(f,x,S),z=ng(f,_),V=z*S,Z=s[0].x===0||s[0].x===I||s[0].y===0||s[0].y===I;return i-V<i/4&&(i=V+i/4),ig(s,Z?i/2*A%i:(z/2+2*x)*S*A%i,i,O,o,V,Z,!1,I)}function ig(s,i,o,f,_,x,S,A,I){const O=x/2,z=Nc(s);let V=0,Z=i-o,X=[];for(let Q=0;Q<s.length-1;Q++){const ae=s[Q],ce=s[Q+1],me=ae.dist(ce),ze=ce.angleTo(ae);for(;Z+o<V+me;){Z+=o;const xe=(Z-V)/me,Ie=ws.number(ae.x,ce.x,xe),Ze=ws.number(ae.y,ce.y,xe);if(Ie>=0&&Ie<I&&Ze>=0&&Ze<I&&Z-O>=0&&Z+O<=z){const Je=new Pu(Ie,Ze,ze,Q);Je._round(),f&&!W_(s,Je,x,f,_)||X.push(Je)}}V+=me}return A||X.length||S||(X=ig(s,V/2,o,f,_,x,S,!0,I)),X}function Q_(s,i,o,f){const _=[],x=s.image,S=x.pixelRatio,A=x.paddedRect.w-2,I=x.paddedRect.h-2;let O={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const z=x.stretchX||[[0,A]],V=x.stretchY||[[0,I]],Z=(it,Yt)=>it+Yt[1]-Yt[0],X=z.reduce(Z,0),Q=V.reduce(Z,0),ae=A-X,ce=I-Q;let me=0,ze=X,xe=0,Ie=Q,Ze=0,Je=ae,ht=0,Dt=ce;if(x.content&&f){const it=x.content,Yt=it[2]-it[0],Jt=it[3]-it[1];(x.textFitWidth||x.textFitHeight)&&(O=Du(s)),me=Co(z,0,it[0]),xe=Co(V,0,it[1]),ze=Co(z,it[0],it[2]),Ie=Co(V,it[1],it[3]),Ze=it[0]-me,ht=it[1]-xe,Je=Yt-ze,Dt=Jt-Ie}const xt=O.x1,Ct=O.y1,Vt=O.x2-xt,At=O.y2-Ct,Tt=(it,Yt,Jt,Gt)=>{const Lt=wp(it.stretch-me,ze,Vt,xt),kn=Tp(it.fixed-Ze,Je,it.stretch,X),$i=wp(Yt.stretch-xe,Ie,At,Ct),Wi=Tp(Yt.fixed-ht,Dt,Yt.stretch,Q),fa=wp(Jt.stretch-me,ze,Vt,xt),Io=Tp(Jt.fixed-Ze,Je,Jt.stretch,X),pa=wp(Gt.stretch-xe,Ie,At,Ct),jr=Tp(Gt.fixed-ht,Dt,Gt.stretch,Q),Zi=new E(Lt,$i),cr=new E(fa,$i),vr=new E(fa,pa),Fr=new E(Lt,pa),Br=new E(kn/S,Wi/S),ao=new E(Io/S,jr/S),ur=i*Math.PI/180;if(ur){const hr=Math.sin(ur),a=Math.cos(ur),h=[a,-hr,hr,a];Zi._matMult(h),cr._matMult(h),Fr._matMult(h),vr._matMult(h)}const ja=it.stretch+it.fixed,Cr=Yt.stretch+Yt.fixed;return{tl:Zi,tr:cr,bl:Fr,br:vr,tex:{x:x.paddedRect.x+1+ja,y:x.paddedRect.y+1+Cr,w:Jt.stretch+Jt.fixed-ja,h:Gt.stretch+Gt.fixed-Cr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Br,pixelOffsetBR:ao,minFontScaleX:Je/S/Vt,minFontScaleY:Dt/S/At,isSDF:o}};if(f&&(x.stretchX||x.stretchY)){const it=rg(z,ae,X),Yt=rg(V,ce,Q);for(let Jt=0;Jt<it.length-1;Jt++){const Gt=it[Jt],Lt=it[Jt+1];for(let kn=0;kn<Yt.length-1;kn++)_.push(Tt(Gt,Yt[kn],Lt,Yt[kn+1]))}}else _.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:I+1}));return _}function Co(s,i,o){let f=0;for(const _ of s)f+=Math.max(i,Math.min(o,_[1]))-Math.max(i,Math.min(o,_[0]));return f}function rg(s,i,o){const f=[{fixed:-1,stretch:0}];for(const[_,x]of s){const S=f[f.length-1];f.push({fixed:_-S.stretch,stretch:S.stretch}),f.push({fixed:_-S.stretch,stretch:S.stretch+(x-_)})}return f.push({fixed:i+1,stretch:o}),f}function wp(s,i,o,f){return s/i*o+f}function Tp(s,i,o,f){return s-i*o/f}kt("Anchor",Pu);class Ou{constructor(i,o,f,_,x,S,A,I,O,z){var V;if(this.boxStartIndex=i.length,O){let Z=S.top,X=S.bottom;const Q=S.collisionPadding;Q&&(Z-=Q[1],X+=Q[3]);let ae=X-Z;ae>0&&(ae=Math.max(10,ae),this.circleDiameter=ae)}else{const Z=!((V=S.image)===null||V===void 0)&&V.content&&(S.image.textFitWidth||S.image.textFitHeight)?Du(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};Z.y1=Z.y1*A-I[0],Z.y2=Z.y2*A+I[2],Z.x1=Z.x1*A-I[3],Z.x2=Z.x2*A+I[1];const X=S.collisionPadding;if(X&&(Z.x1-=X[0]*A,Z.y1-=X[1]*A,Z.x2+=X[2]*A,Z.y2+=X[3]*A),z){const Q=new E(Z.x1,Z.y1),ae=new E(Z.x2,Z.y1),ce=new E(Z.x1,Z.y2),me=new E(Z.x2,Z.y2),ze=z*Math.PI/180;Q._rotate(ze),ae._rotate(ze),ce._rotate(ze),me._rotate(ze),Z.x1=Math.min(Q.x,ae.x,ce.x,me.x),Z.x2=Math.max(Q.x,ae.x,ce.x,me.x),Z.y1=Math.min(Q.y,ae.y,ce.y,me.y),Z.y2=Math.max(Q.y,ae.y,ce.y,me.y)}i.emplaceBack(o.x,o.y,Z.x1,Z.y1,Z.x2,Z.y2,f,_,x)}this.boxEndIndex=i.length}}class Is{constructor(i=[],o=(f,_)=>f<_?-1:f>_?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:f}=this,_=o[i];for(;i>0;){const x=i-1>>1,S=o[x];if(f(_,S)>=0)break;o[i]=S,i=x}o[i]=_}_down(i){const{data:o,compare:f}=this,_=this.length>>1,x=o[i];for(;i<_;){let S=1+(i<<1);const A=S+1;if(A<this.length&&f(o[A],o[S])<0&&(S=A),f(o[S],x)>=0)break;o[i]=o[S],i=S}o[i]=x}}function K_(s,i=1,o=!1){const f=ku.fromPoints(s[0]),_=Math.min(f.width(),f.height());let x=_/2;const S=new Is([],ag),{minX:A,minY:I,maxX:O,maxY:z}=f;if(_===0)return new E(A,I);for(let X=A;X<O;X+=_)for(let Q=I;Q<z;Q+=_)S.push(new Do(X+x,Q+x,x,s));let V=function(X){let Q=0,ae=0,ce=0;const me=X[0];for(let ze=0,xe=me.length,Ie=xe-1;ze<xe;Ie=ze++){const Ze=me[ze],Je=me[Ie],ht=Ze.x*Je.y-Je.x*Ze.y;ae+=(Ze.x+Je.x)*ht,ce+=(Ze.y+Je.y)*ht,Q+=3*ht}return new Do(ae/Q,ce/Q,0,X)}(s),Z=S.length;for(;S.length;){const X=S.pop();(X.d>V.d||!V.d)&&(V=X,o&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,Z)),X.max-V.d<=i||(x=X.h/2,S.push(new Do(X.p.x-x,X.p.y-x,x,s)),S.push(new Do(X.p.x+x,X.p.y-x,x,s)),S.push(new Do(X.p.x-x,X.p.y+x,x,s)),S.push(new Do(X.p.x+x,X.p.y+x,x,s)),Z+=4)}return o&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${V.d}`)),V.p}function ag(s,i){return i.max-s.max}function Do(s,i,o,f){this.p=new E(s,i),this.h=o,this.d=function(_,x){let S=!1,A=1/0;for(let I=0;I<x.length;I++){const O=x[I];for(let z=0,V=O.length,Z=V-1;z<V;Z=z++){const X=O[z],Q=O[Z];X.y>_.y!=Q.y>_.y&&_.x<(Q.x-X.x)*(_.y-X.y)/(Q.y-X.y)+X.x&&(S=!S),A=Math.min(A,Tm(_,X,Q))}}return(S?1:-1)*Math.sqrt(A)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var da;y.aE=void 0,(da=y.aE||(y.aE={}))[da.center=1]="center",da[da.left=2]="left",da[da.right=3]="right",da[da.top=4]="top",da[da.bottom=5]="bottom",da[da["top-left"]=6]="top-left",da[da["top-right"]=7]="top-right",da[da["bottom-left"]=8]="bottom-left",da[da["bottom-right"]=9]="bottom-right";const Xy=Number.POSITIVE_INFINITY;function Kh(s,i){return i[1]!==Xy?function(o,f,_){let x=0,S=0;switch(f=Math.abs(f),_=Math.abs(_),o){case"top-right":case"top-left":case"top":S=_-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-_}switch(o){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,S]}(s,i[0],i[1]):function(o,f){let _=0,x=0;f<0&&(f=0);const S=f/Math.SQRT2;switch(o){case"top-right":case"top-left":x=S-7;break;case"bottom-right":case"bottom-left":x=7-S;break;case"bottom":x=7-f;break;case"top":x=f-7}switch(o){case"top-right":case"bottom-right":_=-S;break;case"top-left":case"bottom-left":_=S;break;case"left":_=f;break;case"right":_=-f}return[_,x]}(s,i[0])}function Wy(s,i,o){var f;const _=s.layout,x=(f=_.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(i,{},o);if(x){const A=x.values,I=[];for(let O=0;O<A.length;O+=2){const z=I[O]=A[O],V=A[O+1].map(Z=>Z*ai);z.startsWith("top")?V[1]-=7:z.startsWith("bottom")&&(V[1]+=7),I[O+1]=V}return new Hr(I)}const S=_.get("text-variable-anchor");if(S){let A;A=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(i,{},o)*ai,Xy]:_.get("text-offset").evaluate(i,{},o).map(O=>O*ai);const I=[];for(const O of S)I.push(O,Kh(O,A));return new Hr(I)}return null}function Qy(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Hb(s,i,o,f,_,x,S,A,I,O,z,V){let Z=x.textMaxSize.evaluate(i,{});Z===void 0&&(Z=S);const X=s.layers[0].layout,Q=X.get("icon-offset").evaluate(i,{},z),ae=ev(o.horizontal),ce=S/24,me=s.tilePixelRatio*ce,ze=s.tilePixelRatio*Z/24,xe=s.tilePixelRatio*A,Ie=s.tilePixelRatio*X.get("symbol-spacing"),Ze=X.get("text-padding")*s.tilePixelRatio,Je=function(Jt,Gt,Lt,kn=1){const $i=Jt.get("icon-padding").evaluate(Gt,{},Lt),Wi=$i&&$i.values;return[Wi[0]*kn,Wi[1]*kn,Wi[2]*kn,Wi[3]*kn]}(X,i,z,s.tilePixelRatio),ht=X.get("text-max-angle")/180*Math.PI,Dt=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",xt=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Ct=X.get("symbol-placement"),Vt=Ie/2,At=X.get("icon-text-fit");let Tt;f&&At!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(Tt=cl(f,o.vertical,At,X.get("icon-text-fit-padding"),Q,ce)),ae&&(f=cl(f,ae,At,X.get("icon-text-fit-padding"),Q,ce)));const it=z?V.line.getGranularityForZoomLevel(z.z):1,Yt=(Jt,Gt)=>{Gt.x<0||Gt.x>=ut||Gt.y<0||Gt.y>=ut||function(Lt,kn,$i,Wi,fa,Io,pa,jr,Zi,cr,vr,Fr,Br,ao,ur,ja,Cr,hr,a,h,g,w,D,L,q){const se=Lt.addToLineVertexArray(kn,$i);let Ce,He,st,ft,Ke=0,et=0,fn=0,sn=0,gi=-1,Ue=-1;const Le={};let qe=Sc("");if(Lt.allowVerticalPlacement&&Wi.vertical){const oo=jr.layout.get("text-rotate").evaluate(g,{},L)+90;st=new Ou(Zi,kn,cr,vr,Fr,Wi.vertical,Br,ao,ur,oo),pa&&(ft=new Ou(Zi,kn,cr,vr,Fr,pa,Cr,hr,ur,oo))}if(fa){const oo=jr.layout.get("icon-rotate").evaluate(g,{}),ul=jr.layout.get("icon-text-fit")!=="none",Mp=Q_(fa,oo,D,ul),Fc=pa?Q_(pa,oo,D,ul):void 0;He=new Ou(Zi,kn,cr,vr,Fr,fa,Cr,hr,!1,oo),Ke=4*Mp.length;const Ap=Lt.iconSizeData;let ju=null;Ap.kind==="source"?(ju=[qo*jr.layout.get("icon-size").evaluate(g,{})],ju[0]>Iu&&Vn(`${Lt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ap.kind==="composite"&&(ju=[qo*w.compositeIconSizes[0].evaluate(g,{},L),qo*w.compositeIconSizes[1].evaluate(g,{},L)],(ju[0]>Iu||ju[1]>Iu)&&Vn(`${Lt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Lt.addSymbols(Lt.icon,Mp,ju,h,a,g,y.ao.none,kn,se.lineStartIndex,se.lineLength,-1,L),gi=Lt.icon.placedSymbolArray.length-1,Fc&&(et=4*Fc.length,Lt.addSymbols(Lt.icon,Fc,ju,h,a,g,y.ao.vertical,kn,se.lineStartIndex,se.lineLength,-1,L),Ue=Lt.icon.placedSymbolArray.length-1)}const dt=Object.keys(Wi.horizontal);for(const oo of dt){const ul=Wi.horizontal[oo];if(!Ce){qe=Sc(ul.text);const Fc=jr.layout.get("text-rotate").evaluate(g,{},L);Ce=new Ou(Zi,kn,cr,vr,Fr,ul,Br,ao,ur,Fc)}const Mp=ul.positionedLines.length===1;if(fn+=J_(Lt,kn,ul,Io,jr,ur,g,ja,se,Wi.vertical?y.ao.horizontal:y.ao.horizontalOnly,Mp?dt:[oo],Le,gi,w,L),Mp)break}Wi.vertical&&(sn+=J_(Lt,kn,Wi.vertical,Io,jr,ur,g,ja,se,y.ao.vertical,["vertical"],Le,Ue,w,L));const Ht=Ce?Ce.boxStartIndex:Lt.collisionBoxArray.length,Fn=Ce?Ce.boxEndIndex:Lt.collisionBoxArray.length,en=st?st.boxStartIndex:Lt.collisionBoxArray.length,hn=st?st.boxEndIndex:Lt.collisionBoxArray.length,ma=He?He.boxStartIndex:Lt.collisionBoxArray.length,oi=He?He.boxEndIndex:Lt.collisionBoxArray.length,zu=ft?ft.boxStartIndex:Lt.collisionBoxArray.length,Xb=ft?ft.boxEndIndex:Lt.collisionBoxArray.length;let jc=-1;const iv=(oo,ul)=>oo&&oo.circleDiameter?Math.max(oo.circleDiameter,ul):ul;jc=iv(Ce,jc),jc=iv(st,jc),jc=iv(He,jc),jc=iv(ft,jc);const Nw=jc>-1?1:0;Nw&&(jc*=q/ai),Lt.glyphOffsetArray.length>=pf.MAX_GLYPHS&&Vn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),g.sortKey!==void 0&&Lt.addToSortKeyRanges(Lt.symbolInstances.length,g.sortKey);const MC=Wy(jr,g,L),[AC,CC]=function(oo,ul){const Mp=oo.length,Fc=ul?.values;if(Fc?.length>0)for(let Ap=0;Ap<Fc.length;Ap+=2){const ju=Fc[Ap+1];oo.emplaceBack(y.aE[Fc[Ap]],ju[0],ju[1])}return[Mp,oo.length]}(Lt.textAnchorOffsets,MC);Lt.symbolInstances.emplaceBack(kn.x,kn.y,Le.right>=0?Le.right:-1,Le.center>=0?Le.center:-1,Le.left>=0?Le.left:-1,Le.vertical||-1,gi,Ue,qe,Ht,Fn,en,hn,ma,oi,zu,Xb,cr,fn,sn,Ke,et,Nw,0,Br,jc,AC,CC)}(s,Gt,Jt,o,f,_,Tt,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,me,[Ze,Ze,Ze,Ze],Dt,I,xe,Je,xt,Q,i,x,O,z,S)};if(Ct==="line")for(const Jt of Hy(i.geometry,0,0,ut,ut)){const Gt=Eo(Jt,it),Lt=Yb(Gt,Ie,ht,o.vertical||ae,f,24,ze,s.overscaling,ut);for(const kn of Lt)ae&&qb(s,ae.text,Vt,kn)||Yt(Gt,kn)}else if(Ct==="line-center"){for(const Jt of i.geometry)if(Jt.length>1){const Gt=Eo(Jt,it),Lt=Zb(Gt,ht,o.vertical||ae,f,24,ze);Lt&&Yt(Gt,Lt)}}else if(i.type==="Polygon")for(const Jt of au(i.geometry,0)){const Gt=K_(Jt,16);Yt(Eo(Jt[0],it,!0),new Pu(Gt.x,Gt.y,0))}else if(i.type==="LineString")for(const Jt of i.geometry){const Gt=Eo(Jt,it);Yt(Gt,new Pu(Gt[0].x,Gt[0].y,0))}else if(i.type==="Point")for(const Jt of i.geometry)for(const Gt of Jt)Yt([Gt],new Pu(Gt.x,Gt.y,0))}function J_(s,i,o,f,_,x,S,A,I,O,z,V,Z,X,Q){const ae=function(ze,xe,Ie,Ze,Je,ht,Dt,xt){const Ct=Ze.layout.get("text-rotate").evaluate(ht,{})*Math.PI/180,Vt=[];for(const At of xe.positionedLines)for(const Tt of At.positionedGlyphs){if(!Tt.rect)continue;const it=Tt.rect||{};let Yt=4,Jt=!0,Gt=1,Lt=0;const kn=(Je||xt)&&Tt.vertical,$i=Tt.metrics.advance*Tt.scale/2;if(xt&&xe.verticalizable&&(Lt=At.lineOffset/2-(Tt.imageName?-(ai-Tt.metrics.width*Tt.scale)/2:(Tt.scale-1)*ai)),Tt.imageName){const hr=Dt[Tt.imageName];Jt=hr.sdf,Gt=hr.pixelRatio,Yt=1/Gt}const Wi=Je?[Tt.x+$i,Tt.y]:[0,0];let fa=Je?[0,0]:[Tt.x+$i+Ie[0],Tt.y+Ie[1]-Lt],Io=[0,0];kn&&(Io=fa,fa=[0,0]);const pa=Tt.metrics.isDoubleResolution?2:1,jr=(Tt.metrics.left-Yt)*Tt.scale-$i+fa[0],Zi=(-Tt.metrics.top-Yt)*Tt.scale+fa[1],cr=jr+it.w/pa*Tt.scale/Gt,vr=Zi+it.h/pa*Tt.scale/Gt,Fr=new E(jr,Zi),Br=new E(cr,Zi),ao=new E(jr,vr),ur=new E(cr,vr);if(kn){const hr=new E(-$i,$i- -17),a=-Math.PI/2,h=12-$i,g=new E(22-h,-(Tt.imageName?h:0)),w=new E(...Io);Fr._rotateAround(a,hr)._add(g)._add(w),Br._rotateAround(a,hr)._add(g)._add(w),ao._rotateAround(a,hr)._add(g)._add(w),ur._rotateAround(a,hr)._add(g)._add(w)}if(Ct){const hr=Math.sin(Ct),a=Math.cos(Ct),h=[a,-hr,hr,a];Fr._matMult(h),Br._matMult(h),ao._matMult(h),ur._matMult(h)}const ja=new E(0,0),Cr=new E(0,0);Vt.push({tl:Fr,tr:Br,bl:ao,br:ur,tex:it,writingMode:xe.writingMode,glyphOffset:Wi,sectionIndex:Tt.sectionIndex,isSDF:Jt,pixelOffsetTL:ja,pixelOffsetBR:Cr,minFontScaleX:0,minFontScaleY:0})}return Vt}(0,o,A,_,x,S,f,s.allowVerticalPlacement),ce=s.textSizeData;let me=null;ce.kind==="source"?(me=[qo*_.layout.get("text-size").evaluate(S,{})],me[0]>Iu&&Vn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ce.kind==="composite"&&(me=[qo*X.compositeTextSizes[0].evaluate(S,{},Q),qo*X.compositeTextSizes[1].evaluate(S,{},Q)],(me[0]>Iu||me[1]>Iu)&&Vn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,ae,me,A,x,S,O,i,I.lineStartIndex,I.lineLength,Z,Q);for(const ze of z)V[ze]=s.text.placedSymbolArray.length-1;return 4*ae.length}function ev(s){for(const i in s)return s[i];return null}function qb(s,i,o,f){const _=s.compareText;if(i in _){const x=_[i];for(let S=x.length-1;S>=0;S--)if(f.dist(x[S])<o)return!0}else _[i]=[];return _[i].push(f),!1}const tv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ky{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,f]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=f>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const x=tv[15&f];if(!x)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(i,2,1),[A]=new Uint32Array(i,4,1);return new Ky(A,S,x,i)}constructor(i,o=64,f=Float64Array,_){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=f,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const x=tv.indexOf(this.ArrayType),S=2*i*this.ArrayType.BYTES_PER_ELEMENT,A=i*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-A%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+A+I,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+S+A+I),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+A+I,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=i,this.coords[this._pos++]=o,f}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return og(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,f,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:S,nodeSize:A}=this,I=[0,x.length-1,0],O=[];for(;I.length;){const z=I.pop()||0,V=I.pop()||0,Z=I.pop()||0;if(V-Z<=A){for(let ce=Z;ce<=V;ce++){const me=S[2*ce],ze=S[2*ce+1];me>=i&&me<=f&&ze>=o&&ze<=_&&O.push(x[ce])}continue}const X=Z+V>>1,Q=S[2*X],ae=S[2*X+1];Q>=i&&Q<=f&&ae>=o&&ae<=_&&O.push(x[X]),(z===0?i<=Q:o<=ae)&&(I.push(Z),I.push(X-1),I.push(1-z)),(z===0?f>=Q:_>=ae)&&(I.push(X+1),I.push(V),I.push(1-z))}return O}within(i,o,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:S}=this,A=[0,_.length-1,0],I=[],O=f*f;for(;A.length;){const z=A.pop()||0,V=A.pop()||0,Z=A.pop()||0;if(V-Z<=S){for(let ce=Z;ce<=V;ce++)nv(x[2*ce],x[2*ce+1],i,o)<=O&&I.push(_[ce]);continue}const X=Z+V>>1,Q=x[2*X],ae=x[2*X+1];nv(Q,ae,i,o)<=O&&I.push(_[X]),(z===0?i-f<=Q:o-f<=ae)&&(A.push(Z),A.push(X-1),A.push(1-z)),(z===0?i+f>=Q:o+f>=ae)&&(A.push(X+1),A.push(V),A.push(1-z))}return I}}function og(s,i,o,f,_,x){if(_-f<=o)return;const S=f+_>>1;Jh(s,i,S,f,_,x),og(s,i,o,f,S-1,1-x),og(s,i,o,S+1,_,1-x)}function Jh(s,i,o,f,_,x){for(;_>f;){if(_-f>600){const O=_-f+1,z=o-f+1,V=Math.log(O),Z=.5*Math.exp(2*V/3),X=.5*Math.sqrt(V*Z*(O-Z)/O)*(z-O/2<0?-1:1);Jh(s,i,o,Math.max(f,Math.floor(o-z*Z/O+X)),Math.min(_,Math.floor(o+(O-z)*Z/O+X)),x)}const S=i[2*o+x];let A=f,I=_;for(zc(s,i,f,o),i[2*_+x]>S&&zc(s,i,f,_);A<I;){for(zc(s,i,A,I),A++,I--;i[2*A+x]<S;)A++;for(;i[2*I+x]>S;)I--}i[2*f+x]===S?zc(s,i,f,I):(I++,zc(s,i,I,_)),I<=o&&(f=I+1),o<=I&&(_=I-1)}}function zc(s,i,o,f){sg(s,o,f),sg(i,2*o,2*f),sg(i,2*o+1,2*f+1)}function sg(s,i,o){const f=s[i];s[i]=s[o],s[o]=f}function nv(s,i,o,f){const _=s-o,x=i-f;return _*_+x*x}var Lu;y.cx=void 0,(Lu=y.cx||(y.cx={})).create="create",Lu.load="load",Lu.fullLoad="fullLoad";let Nu=null,_f=[];const vf=1e3/60,Sp="loadTime",Ep="fullLoadTime",lg={mark(s){performance.mark(s)},frame(s){const i=s;Nu!=null&&_f.push(i-Nu),Nu=i},clearMetrics(){Nu=null,_f=[],performance.clearMeasures(Sp),performance.clearMeasures(Ep);for(const s in y.cx)performance.clearMarks(y.cx[s])},getPerformanceMetrics(){performance.measure(Sp,y.cx.create,y.cx.load),performance.measure(Ep,y.cx.create,y.cx.fullLoad);const s=performance.getEntriesByName(Sp)[0].duration,i=performance.getEntriesByName(Ep)[0].duration,o=_f.length,f=1/(_f.reduce((x,S)=>x+S,0)/o/1e3),_=_f.filter(x=>x>vf).reduce((x,S)=>x+(S-vf)/vf,0);return{loadTime:s,fullLoadTime:i,fps:f,percentDroppedFrames:_/(o+_)*100,totalFrames:o}}};y.$=ut,y.A=we,y.B=function([s,i,o]){return i+=90,i*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(i)*Math.sin(o),y:s*Math.sin(i)*Math.sin(o),z:s*Math.cos(o)}},y.C=ws,y.D=Nt,y.E=jt,y.F=ti,y.G=Bo,y.H=function(s){if(ki==null){const i=s.navigator?s.navigator.userAgent:null;ki=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return ki},y.I=Cu,y.J=class{constructor(s,i){this.target=s,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Uy(()=>this.process()),this.subscription=Ca(this.target,"message",o=>this.receive(o),!1),this.globalScope=Pr(self)?s:window}registerMessageHandler(s,i){this.messageHandlers[s]=i}sendAsync(s,i){return new Promise((o,f)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=i?Ca(i.signal,"abort",()=>{x?.unsubscribe(),delete this.resolveRejects[_];const I={id:_,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(I)},xp):null;this.resolveRejects[_]={resolve:I=>{x?.unsubscribe(),o(I)},reject:I=>{x?.unsubscribe(),f(I)}};const S=[],A=Object.assign(Object.assign({},s),{id:_,sourceMapId:this.mapId,origin:location.origin,data:vc(s.data,S)});this.target.postMessage(A,{transfer:S})})}receive(s){const i=s.data,o=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[o];const f=this.abortControllers[o];return delete this.abortControllers[o],void(f&&f.abort())}if(Pr(self)||i.mustQueue)return this.tasks[o]=i,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,i)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),i=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(s,i)}processTask(s,i){return l(this,void 0,void 0,function*(){if(i.type==="<response>"){const _=this.resolveRejects[s];return delete this.resolveRejects[s],_?void(i.error?_.reject(Uo(i.error)):_.resolve(Uo(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=Uo(i.data),f=new AbortController;this.abortControllers[s]=f;try{const _=yield this.messageHandlers[i.type](i.sourceMapId,o,f);this.completeTask(s,null,_)}catch(_){this.completeTask(s,_)}})}completeTask(s,i,o){const f=[];delete this.abortControllers[s];const _={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?vc(i):null,data:vc(o,f)};this.target.postMessage(_,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.K=le,y.L=function(){var s=new we(16);return we!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},y.M=function(s,i,o){var f,_,x,S,A,I,O,z,V,Z,X,Q,ae=o[0],ce=o[1],me=o[2];return i===s?(s[12]=i[0]*ae+i[4]*ce+i[8]*me+i[12],s[13]=i[1]*ae+i[5]*ce+i[9]*me+i[13],s[14]=i[2]*ae+i[6]*ce+i[10]*me+i[14],s[15]=i[3]*ae+i[7]*ce+i[11]*me+i[15]):(_=i[1],x=i[2],S=i[3],A=i[4],I=i[5],O=i[6],z=i[7],V=i[8],Z=i[9],X=i[10],Q=i[11],s[0]=f=i[0],s[1]=_,s[2]=x,s[3]=S,s[4]=A,s[5]=I,s[6]=O,s[7]=z,s[8]=V,s[9]=Z,s[10]=X,s[11]=Q,s[12]=f*ae+A*ce+V*me+i[12],s[13]=_*ae+I*ce+Z*me+i[13],s[14]=x*ae+O*ce+X*me+i[14],s[15]=S*ae+z*ce+Q*me+i[15]),s},y.N=function(s,i,o){var f=o[0],_=o[1],x=o[2];return s[0]=i[0]*f,s[1]=i[1]*f,s[2]=i[2]*f,s[3]=i[3]*f,s[4]=i[4]*_,s[5]=i[5]*_,s[6]=i[6]*_,s[7]=i[7]*_,s[8]=i[8]*x,s[9]=i[9]*x,s[10]=i[10]*x,s[11]=i[11]*x,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},y.O=function(s,i,o){var f=i[0],_=i[1],x=i[2],S=i[3],A=i[4],I=i[5],O=i[6],z=i[7],V=i[8],Z=i[9],X=i[10],Q=i[11],ae=i[12],ce=i[13],me=i[14],ze=i[15],xe=o[0],Ie=o[1],Ze=o[2],Je=o[3];return s[0]=xe*f+Ie*A+Ze*V+Je*ae,s[1]=xe*_+Ie*I+Ze*Z+Je*ce,s[2]=xe*x+Ie*O+Ze*X+Je*me,s[3]=xe*S+Ie*z+Ze*Q+Je*ze,s[4]=(xe=o[4])*f+(Ie=o[5])*A+(Ze=o[6])*V+(Je=o[7])*ae,s[5]=xe*_+Ie*I+Ze*Z+Je*ce,s[6]=xe*x+Ie*O+Ze*X+Je*me,s[7]=xe*S+Ie*z+Ze*Q+Je*ze,s[8]=(xe=o[8])*f+(Ie=o[9])*A+(Ze=o[10])*V+(Je=o[11])*ae,s[9]=xe*_+Ie*I+Ze*Z+Je*ce,s[10]=xe*x+Ie*O+Ze*X+Je*me,s[11]=xe*S+Ie*z+Ze*Q+Je*ze,s[12]=(xe=o[12])*f+(Ie=o[13])*A+(Ze=o[14])*V+(Je=o[15])*ae,s[13]=xe*_+Ie*I+Ze*Z+Je*ce,s[14]=xe*x+Ie*O+Ze*X+Je*me,s[15]=xe*S+Ie*z+Ze*Q+Je*ze,s},y.P=E,y.Q=function(s,i){const o={};for(let f=0;f<i.length;f++){const _=i[f];_ in s&&(o[_]=s[_])}return o},y.R=Oa,y.S=Xo,y.T=Qd,y.U=Gy,y.V=q_,y.W=ie,y.X=de,y.Y=Gr,y.Z=ro,y._=l,y.a=te,y.a$=zt,y.a0=function(s,i){var o,f,_,x,S;if(!s)return i??{};if(!i)return s;let A=Object.assign({},s);if(i.removeAll&&(A={removeAll:!0}),i.remove){const I=new Set(i.remove);A.add&&(A.add=A.add.filter(z=>!I.has(z.id))),A.update&&(A.update=A.update.filter(z=>!I.has(z.id)));const O=new Set(((o=s.add)!==null&&o!==void 0?o:[]).map(z=>z.id));i.remove=i.remove.filter(z=>!O.has(z))}if(i.remove){const I=new Set(A.remove?A.remove.concat(i.remove):i.remove);A.remove=Array.from(I.values())}if(i.add){const I=A.add?A.add.concat(i.add):i.add,O=new Map(I.map(z=>[z.id,z]));A.add=Array.from(O.values())}if(i.update){const I=new Map((f=A.update)===null||f===void 0?void 0:f.map(O=>[O.id,O]));for(const O of i.update){const z=(_=I.get(O.id))!==null&&_!==void 0?_:{id:O.id};O.newGeometry&&(z.newGeometry=O.newGeometry),O.addOrUpdateProperties&&(z.addOrUpdateProperties=((x=z.addOrUpdateProperties)!==null&&x!==void 0?x:[]).concat(O.addOrUpdateProperties)),O.removeProperties&&(z.removeProperties=((S=z.removeProperties)!==null&&S!==void 0?S:[]).concat(O.removeProperties)),O.removeAllProperties&&(z.removeAllProperties=!0),I.set(O.id,z)}A.update=Array.from(I.values())}return A.remove&&A.add&&(A.remove=A.remove.filter(I=>A.add.findIndex(O=>O.id===I)===-1)),A},y.a1=Qh,y.a2=ku,y.a3=25,y.a4=Zy,y.a5=s=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(o=>{i.onloadstart=()=>{o(i)};for(const f of s){const _=window.document.createElement("source");Ye(f)||(i.crossOrigin="Anonymous"),_.src=f,i.appendChild(_)}})},y.a6=wt,y.a7=function(){return Xn++},y.a8=Y,y.a9=pf,y.aA=function(s){let i=1/0,o=1/0,f=-1/0,_=-1/0;for(const x of s)i=Math.min(i,x.x),o=Math.min(o,x.y),f=Math.max(f,x.x),_=Math.max(_,x.y);return[i,o,f,_]},y.aB=ai,y.aC=Te,y.aD=function(s,i,o,f,_=!1){if(!o[0]&&!o[1])return[0,0];const x=_?f==="map"?-s.bearingInRadians:0:f==="viewport"?s.bearingInRadians:0;if(x){const S=Math.sin(x),A=Math.cos(x);o=[o[0]*A-o[1]*S,o[0]*S+o[1]*A]}return[_?o[0]:Te(i,o[0],s.zoom),_?o[1]:Te(i,o[1],s.zoom)]},y.aF=Ym,y.aG=Qy,y.aH=Py,y.aI=Ky,y.aJ=Li,y.aK=La,y.aL=Ne,y.aM=un,y.aN=qn,y.aO=Ln,y.aP=Ga,y.aQ=bi,y.aR=Qe,y.aS=Me,y.aT=function(s){var i=new we(3);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i},y.aU=function(s,i,o){return s[0]=i[0]-o[0],s[1]=i[1]-o[1],s[2]=i[2]-o[2],s},y.aV=function(s,i){var o=i[0],f=i[1],_=i[2],x=o*o+f*f+_*_;return x>0&&(x=1/Math.sqrt(x)),s[0]=i[0]*x,s[1]=i[1]*x,s[2]=i[2]*x,s},y.aW=St,y.aX=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]},y.aY=function(s,i,o){return s[0]=i[0]*o[0],s[1]=i[1]*o[1],s[2]=i[2]*o[2],s[3]=i[3]*o[3],s},y.aZ=Ge,y.a_=function(s,i,o){const f=i[0]*o[0]+i[1]*o[1]+i[2]*o[2];return f===0?null:(-(s[0]*o[0]+s[1]*o[1]+s[2]*o[2])-o[3])/f},y.aa=Rl,y.ab=Mc,y.ac=tg,y.ad=function(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,f,_,x)=>{const S=_||x;return i[f]=!S||S.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i},y.ae=Da,y.af=function(s){return Math.pow(2,s)},y.ag=ge,y.ah=Ot,y.ai=85.051129,y.aj=$y,y.ak=function(s){return Math.log(s)/Math.LN2},y.al=function(s){var i=s[0],o=s[1];return i*i+o*o},y.am=function(s,i){const o=[];for(const f in s)f in i||o.push(f);return o},y.an=function(s,i){let o=0,f=0;if(s.kind==="constant")f=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:_,minZoom:x,maxZoom:S}=s,A=_?Ot(Xr.interpolationFactor(_,i,x,S),0,1):0;s.kind==="camera"?f=ws.number(s.minSize,s.maxSize,A):o=A}return{uSizeT:o,uSize:f}},y.ap=function(s,{uSize:i,uSizeT:o},{lowerSize:f,upperSize:_}){return s.kind==="source"?f/qo:s.kind==="composite"?ws.number(f/qo,_/qo,o):i},y.aq=function(s,i){var o=i[0],f=i[1],_=i[2],x=i[3],S=i[4],A=i[5],I=i[6],O=i[7],z=i[8],V=i[9],Z=i[10],X=i[11],Q=i[12],ae=i[13],ce=i[14],me=i[15],ze=o*A-f*S,xe=o*I-_*S,Ie=o*O-x*S,Ze=f*I-_*A,Je=f*O-x*A,ht=_*O-x*I,Dt=z*ae-V*Q,xt=z*ce-Z*Q,Ct=z*me-X*Q,Vt=V*ce-Z*ae,At=V*me-X*ae,Tt=Z*me-X*ce,it=ze*Tt-xe*At+Ie*Vt+Ze*Ct-Je*xt+ht*Dt;return it?(s[0]=(A*Tt-I*At+O*Vt)*(it=1/it),s[1]=(_*At-f*Tt-x*Vt)*it,s[2]=(ae*ht-ce*Je+me*Ze)*it,s[3]=(Z*Je-V*ht-X*Ze)*it,s[4]=(I*Ct-S*Tt-O*xt)*it,s[5]=(o*Tt-_*Ct+x*xt)*it,s[6]=(ce*Ie-Q*ht-me*xe)*it,s[7]=(z*ht-Z*Ie+X*xe)*it,s[8]=(S*At-A*Ct+O*Dt)*it,s[9]=(f*Ct-o*At-x*Dt)*it,s[10]=(Q*Je-ae*Ie+me*ze)*it,s[11]=(V*Ie-z*Je-X*ze)*it,s[12]=(A*xt-S*Vt-I*Dt)*it,s[13]=(o*Vt-f*xt+_*Dt)*it,s[14]=(ae*xe-Q*Ze-ce*ze)*it,s[15]=(z*Ze-V*xe+Z*ze)*it,s):null},y.ar=lt,y.as=function(s){var i=s[0],o=s[1];return Math.sqrt(i*i+o*o)},y.at=function(s){return s[0]=0,s[1]=0,s},y.au=function(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s},y.av=zy,y.aw=Zt,y.ax=function(s,i,o,f){const _=i.y-s.y,x=i.x-s.x,S=f.y-o.y,A=f.x-o.x,I=S*x-A*_;if(I===0)return null;const O=(A*(s.y-o.y)-S*(s.x-o.x))/I;return new E(s.x+O*x,s.y+O*_)},y.ay=Hy,y.az=Su,y.b=Aa,y.b$=class extends t{},y.b0=function(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s[3]=i[3]*o,s},y.b1=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]+s[3]},y.b2=Jm,y.b3=Lc,y.b4=function(s,i,o,f,_){var x=1/Math.tan(i/2);if(s[0]=x/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,_!=null&&_!==1/0){var S=1/(f-_);s[10]=(_+f)*S,s[14]=2*_*f*S}else s[10]=-1,s[14]=-2*f;return s},y.b5=function(s){var i=new we(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},y.b6=function(s,i,o){var f=Math.sin(o),_=Math.cos(o),x=i[0],S=i[1],A=i[2],I=i[3],O=i[4],z=i[5],V=i[6],Z=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=x*_+O*f,s[1]=S*_+z*f,s[2]=A*_+V*f,s[3]=I*_+Z*f,s[4]=O*_-x*f,s[5]=z*_-S*f,s[6]=V*_-A*f,s[7]=Z*_-I*f,s},y.b7=function(s,i,o){var f=Math.sin(o),_=Math.cos(o),x=i[4],S=i[5],A=i[6],I=i[7],O=i[8],z=i[9],V=i[10],Z=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=x*_+O*f,s[5]=S*_+z*f,s[6]=A*_+V*f,s[7]=I*_+Z*f,s[8]=O*_-x*f,s[9]=z*_-S*f,s[10]=V*_-A*f,s[11]=Z*_-I*f,s},y.b8=function(){const s=new Float32Array(16);return ge(s),s},y.b9=function(){const s=new Float64Array(16);return ge(s),s},y.bA=function(s,i){const o=nt(s,360),f=nt(i,360),_=f-o,x=f>o?_-360:_+360;return Math.abs(_)<Math.abs(x)?_:x},y.bB=function(s){return s[0]=0,s[1]=0,s[2]=0,s},y.bC=function(s,i,o,f){const _=Math.sqrt(s*s+i*i),x=Math.sqrt(o*o+f*f);s/=_,i/=_,o/=x,f/=x;const S=Math.acos(s*o+i*f);return-i*o+s*f>0?S:-S},y.bD=function(s,i){const o=nt(s,2*Math.PI),f=nt(i,2*Math.PI);return Math.min(Math.abs(o-f),Math.abs(o-f+2*Math.PI),Math.abs(o-f-2*Math.PI))},y.bE=function(){const s={},i=Fe.$version;for(const o in Fe.$root){const f=Fe.$root[o];if(f.required){let _=null;_=o==="version"?i:f.type==="array"?[]:{},_!=null&&(s[o]=_)}}return s},y.bF=Ph,y.bG=De,y.bH=function s(i,o){if(Array.isArray(i)){if(!Array.isArray(o)||i.length!==o.length)return!1;for(let f=0;f<i.length;f++)if(!s(i[f],o[f]))return!1;return!0}if(typeof i=="object"&&i!==null&&o!==null){if(typeof o!="object"||Object.keys(i).length!==Object.keys(o).length)return!1;for(const f in i)if(!s(i[f],o[f]))return!1;return!0}return i===o},y.bI=function(s){s=s.slice();const i=Object.create(null);for(let o=0;o<s.length;o++)i[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=Sn(s[o],i[s[o].ref]));return s},y.bJ=function(s,i){if(s.type==="custom")return new Y_(s,i);switch(s.type){case"background":return new Zn(s,i);case"circle":return new T_(s,i);case"color-relief":return new zb(s,i);case"fill":return new hp(s,i);case"fill-extrusion":return new Ty(s,i);case"heatmap":return new Ac(s,i);case"hillshade":return new S_(s,i);case"line":return new Ea(s,i);case"raster":return new By(s,i);case"symbol":return new Ru(s,i)}},y.bK=yi,y.bL=function(s,i){if(!s)return[{command:"setStyle",args:[i]}];let o=[];try{if(!$t(s.version,i.version))return[{command:"setStyle",args:[i]}];$t(s.center,i.center)||o.push({command:"setCenter",args:[i.center]}),$t(s.state,i.state)||o.push({command:"setGlobalState",args:[i.state]}),$t(s.centerAltitude,i.centerAltitude)||o.push({command:"setCenterAltitude",args:[i.centerAltitude]}),$t(s.zoom,i.zoom)||o.push({command:"setZoom",args:[i.zoom]}),$t(s.bearing,i.bearing)||o.push({command:"setBearing",args:[i.bearing]}),$t(s.pitch,i.pitch)||o.push({command:"setPitch",args:[i.pitch]}),$t(s.roll,i.roll)||o.push({command:"setRoll",args:[i.roll]}),$t(s.sprite,i.sprite)||o.push({command:"setSprite",args:[i.sprite]}),$t(s.glyphs,i.glyphs)||o.push({command:"setGlyphs",args:[i.glyphs]}),$t(s.transition,i.transition)||o.push({command:"setTransition",args:[i.transition]}),$t(s.light,i.light)||o.push({command:"setLight",args:[i.light]}),$t(s.terrain,i.terrain)||o.push({command:"setTerrain",args:[i.terrain]}),$t(s.sky,i.sky)||o.push({command:"setSky",args:[i.sky]}),$t(s.projection,i.projection)||o.push({command:"setProjection",args:[i.projection]});const f={},_=[];(function(S,A,I,O){let z;for(z in A=A||{},S=S||{})Object.prototype.hasOwnProperty.call(S,z)&&(Object.prototype.hasOwnProperty.call(A,z)||fr(z,I,O));for(z in A)Object.prototype.hasOwnProperty.call(A,z)&&(Object.prototype.hasOwnProperty.call(S,z)?$t(S[z],A[z])||(S[z].type==="geojson"&&A[z].type==="geojson"&&di(S,A,z)?cn(I,{command:"setGeoJSONSourceData",args:[z,A[z].data]}):wr(z,A,I,O)):ci(z,A,I))})(s.sources,i.sources,_,f);const x=[];s.layers&&s.layers.forEach(S=>{"source"in S&&f[S.source]?o.push({command:"removeLayer",args:[S.id]}):x.push(S)}),o=o.concat(_),function(S,A,I){A=A||[];const O=(S=S||[]).map(an),z=A.map(an),V=S.reduce(Pi,{}),Z=A.reduce(Pi,{}),X=O.slice(),Q=Object.create(null);let ae,ce,me,ze,xe;for(let Ie=0,Ze=0;Ie<O.length;Ie++)ae=O[Ie],Object.prototype.hasOwnProperty.call(Z,ae)?Ze++:(cn(I,{command:"removeLayer",args:[ae]}),X.splice(X.indexOf(ae,Ze),1));for(let Ie=0,Ze=0;Ie<z.length;Ie++)ae=z[z.length-1-Ie],X[X.length-1-Ie]!==ae&&(Object.prototype.hasOwnProperty.call(V,ae)?(cn(I,{command:"removeLayer",args:[ae]}),X.splice(X.lastIndexOf(ae,X.length-Ze),1)):Ze++,ze=X[X.length-Ie],cn(I,{command:"addLayer",args:[Z[ae],ze]}),X.splice(X.length-Ie,0,ae),Q[ae]=!0);for(let Ie=0;Ie<z.length;Ie++)if(ae=z[Ie],ce=V[ae],me=Z[ae],!Q[ae]&&!$t(ce,me))if($t(ce.source,me.source)&&$t(ce["source-layer"],me["source-layer"])&&$t(ce.type,me.type)){for(xe in Kt(ce.layout,me.layout,I,ae,null,"setLayoutProperty"),Kt(ce.paint,me.paint,I,ae,null,"setPaintProperty"),$t(ce.filter,me.filter)||cn(I,{command:"setFilter",args:[ae,me.filter]}),$t(ce.minzoom,me.minzoom)&&$t(ce.maxzoom,me.maxzoom)||cn(I,{command:"setLayerZoomRange",args:[ae,me.minzoom,me.maxzoom]}),ce)Object.prototype.hasOwnProperty.call(ce,xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?Kt(ce[xe],me[xe],I,ae,xe.slice(6),"setPaintProperty"):$t(ce[xe],me[xe])||cn(I,{command:"setLayerProperty",args:[ae,xe,me[xe]]}));for(xe in me)Object.prototype.hasOwnProperty.call(me,xe)&&!Object.prototype.hasOwnProperty.call(ce,xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?Kt(ce[xe],me[xe],I,ae,xe.slice(6),"setPaintProperty"):$t(ce[xe],me[xe])||cn(I,{command:"setLayerProperty",args:[ae,xe,me[xe]]}))}else cn(I,{command:"removeLayer",args:[ae]}),ze=X[X.lastIndexOf(ae)+1],cn(I,{command:"addLayer",args:[me,ze]})}(x,i.layers,o)}catch(f){console.warn("Unable to compute style diff:",f),o=[{command:"setStyle",args:[i]}]}return o},y.bM=function(s){const i=[],o=s.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},y.bN=br,y.bO=ir,y.bP=class extends no{constructor(s,i){super(s,i),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},y.bQ=ca,y.bR=class extends no{constructor(s,i){super(s,i),this.current=er}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let i=1;i<16;i++)if(s[i]!==this.current[i]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},y.bS=Xi,y.bT=class extends no{constructor(s,i){super(s,i),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},y.bU=class extends no{constructor(s,i){super(s,i),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},y.bV=ke,y.bW=function(s,i){var o=Math.sin(i),f=Math.cos(i);return s[0]=f,s[1]=o,s[2]=0,s[3]=-o,s[4]=f,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},y.bX=function(s,i,o){var f=i[0],_=i[1],x=i[2];return s[0]=f*o[0]+_*o[3]+x*o[6],s[1]=f*o[1]+_*o[4]+x*o[7],s[2]=f*o[2]+_*o[5]+x*o[8],s},y.bY=function(s,i,o,f,_,x,S){var A=1/(i-o),I=1/(f-_),O=1/(x-S);return s[0]=-2*A,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*I,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*O,s[11]=0,s[12]=(i+o)*A,s[13]=(_+f)*I,s[14]=(S+x)*O,s[15]=1,s},y.bZ=class extends no{constructor(s,i){super(s,i),this.current=new Array}set(s){if(s!=this.current){this.current=s;const i=new Float32Array(4*s.length);for(let o=0;o<s.length;o++)i[4*o]=s[o].r,i[4*o+1]=s[o].g,i[4*o+2]=s[o].b,i[4*o+3]=s[o].a;this.gl.uniform4fv(this.location,i)}}},y.b_=class extends no{constructor(s,i){super(s,i),this.current=new Array}set(s){if(s!=this.current){this.current=s;const i=new Float32Array(s);this.gl.uniform1fv(this.location,i)}}},y.ba=function(){return new Float64Array(16)},y.bb=function(s,i,o){const f=new Float64Array(4);return Be(f,s,i-90,o),f},y.bc=function(s,i,o,f){var _,x,S,A,I,O=i[0],z=i[1],V=i[2],Z=i[3],X=o[0],Q=o[1],ae=o[2],ce=o[3];return(x=O*X+z*Q+V*ae+Z*ce)<0&&(x=-x,X=-X,Q=-Q,ae=-ae,ce=-ce),1-x>Ee?(_=Math.acos(x),S=Math.sin(_),A=Math.sin((1-f)*_)/S,I=Math.sin(f*_)/S):(A=1-f,I=f),s[0]=A*O+I*X,s[1]=A*z+I*Q,s[2]=A*V+I*ae,s[3]=A*Z+I*ce,s},y.bd=function(s){const i=new Float64Array(9);var o,f,_,x,S,A,I,O,z,V,Z,X,Q,ae,ce,me,ze,xe;V=(_=(f=s)[0])*(I=_+_),Z=(x=f[1])*I,Q=(S=f[2])*I,ae=S*(O=x+x),me=(A=f[3])*I,ze=A*O,xe=A*(z=S+S),(o=i)[0]=1-(X=x*O)-(ce=S*z),o[3]=Z-xe,o[6]=Q+ze,o[1]=Z+xe,o[4]=1-V-ce,o[7]=ae-me,o[2]=Q-ze,o[5]=ae+me,o[8]=1-V-X;const Ie=Ga(-Math.asin(Ot(i[2],-1,1)));let Ze,Je;return Math.hypot(i[5],i[8])<.001?(Ze=0,Je=-Ga(Math.atan2(i[3],i[4]))):(Ze=Ga(i[5]===0&&i[8]===0?0:Math.atan2(i[5],i[8])),Je=Ga(i[1]===0&&i[0]===0?0:Math.atan2(i[1],i[0]))),{roll:Ze,pitch:Ie+90,bearing:Je}},y.be=function(s,i){return s.roll==i.roll&&s.pitch==i.pitch&&s.bearing==i.bearing},y.bf=xn,y.bg=_i,y.bh=Na,y.bi=tf,y.bj=Mu,y.bk=yt,y.bl=pt,y.bm=qi,y.bn=function(s,i,o,f,_){return yt(f,_,Ot((s-i)/(o-i),0,1))},y.bo=nt,y.bp=function(){return new Float64Array(3)},y.bq=function(s,i,o,f){return s[0]=i[0]+o[0]*f,s[1]=i[1]+o[1]*f,s[2]=i[2]+o[2]*f,s},y.br=Be,y.bs=function(s,i,o){var f=o[0],_=o[1],x=o[2],S=o[3],A=i[0],I=i[1],O=i[2],z=_*O-x*I,V=x*A-f*O,Z=f*I-_*A;return s[0]=A+S*(z+=z)+_*(Z+=Z)-x*(V+=V),s[1]=I+S*V+x*z-f*Z,s[2]=O+S*Z+f*V-_*z,s},y.bt=function(s,i,o){const f=(_=[s[0],s[1],s[2],i[0],i[1],i[2],o[0],o[1],o[2]])[0]*((z=_[8])*(S=_[4])-(A=_[5])*(O=_[7]))+_[1]*(-z*(x=_[3])+A*(I=_[6]))+_[2]*(O*x-S*I);var _,x,S,A,I,O,z;if(f===0)return null;const V=St([],[i[0],i[1],i[2]],[o[0],o[1],o[2]]),Z=St([],[o[0],o[1],o[2]],[s[0],s[1],s[2]]),X=St([],[s[0],s[1],s[2]],[i[0],i[1],i[2]]),Q=Qe([],V,-s[3]);return Me(Q,Q,Qe([],Z,-i[3])),Me(Q,Q,Qe([],X,-o[3])),Qe(Q,Q,1/f),Q},y.bu=mf,y.bv=function(){return new Float64Array(4)},y.bw=function(s,i,o,f){var _=[],x=[];return _[0]=i[0]-o[0],_[1]=i[1]-o[1],_[2]=i[2]-o[2],x[0]=_[0]*Math.cos(f)-_[1]*Math.sin(f),x[1]=_[0]*Math.sin(f)+_[1]*Math.cos(f),x[2]=_[2],s[0]=x[0]+o[0],s[1]=x[1]+o[1],s[2]=x[2]+o[2],s},y.bx=function(s,i,o,f){var _=[],x=[];return _[0]=i[0]-o[0],_[1]=i[1]-o[1],_[2]=i[2]-o[2],x[0]=_[0],x[1]=_[1]*Math.cos(f)-_[2]*Math.sin(f),x[2]=_[1]*Math.sin(f)+_[2]*Math.cos(f),s[0]=x[0]+o[0],s[1]=x[1]+o[1],s[2]=x[2]+o[2],s},y.by=function(s,i,o,f){var _=[],x=[];return _[0]=i[0]-o[0],_[1]=i[1]-o[1],_[2]=i[2]-o[2],x[0]=_[2]*Math.sin(f)+_[0]*Math.cos(f),x[1]=_[1],x[2]=_[2]*Math.cos(f)-_[0]*Math.sin(f),s[0]=x[0]+o[0],s[1]=x[1]+o[1],s[2]=x[2]+o[2],s},y.bz=function(s,i,o){var f=Math.sin(o),_=Math.cos(o),x=i[0],S=i[1],A=i[2],I=i[3],O=i[8],z=i[9],V=i[10],Z=i[11];return i!==s&&(s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=x*_-O*f,s[1]=S*_-z*f,s[2]=A*_-V*f,s[3]=I*_-Z*f,s[8]=x*f+O*_,s[9]=S*f+z*_,s[10]=A*f+V*_,s[11]=I*f+Z*_,s},y.c=Pe,y.c0=O_,y.c1=class extends p{},y.c2=Im,y.c3=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},y.c4=Dm,y.c5=function(s,i,o){var f=i[0],_=i[1],x=i[2],S=o[3]*f+o[7]*_+o[11]*x+o[15];return s[0]=(o[0]*f+o[4]*_+o[8]*x+o[12])/(S=S||1),s[1]=(o[1]*f+o[5]*_+o[9]*x+o[13])/S,s[2]=(o[2]*f+o[6]*_+o[10]*x+o[14])/S,s},y.c6=class extends Ni{},y.c7=class extends U{},y.c8=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]&&s[3]===i[3]&&s[4]===i[4]&&s[5]===i[5]&&s[6]===i[6]&&s[7]===i[7]&&s[8]===i[8]&&s[9]===i[9]&&s[10]===i[10]&&s[11]===i[11]&&s[12]===i[12]&&s[13]===i[13]&&s[14]===i[14]&&s[15]===i[15]},y.c9=function(s,i){var o=s[0],f=s[1],_=s[2],x=s[3],S=s[4],A=s[5],I=s[6],O=s[7],z=s[8],V=s[9],Z=s[10],X=s[11],Q=s[12],ae=s[13],ce=s[14],me=s[15],ze=i[0],xe=i[1],Ie=i[2],Ze=i[3],Je=i[4],ht=i[5],Dt=i[6],xt=i[7],Ct=i[8],Vt=i[9],At=i[10],Tt=i[11],it=i[12],Yt=i[13],Jt=i[14],Gt=i[15];return Math.abs(o-ze)<=Ee*Math.max(1,Math.abs(o),Math.abs(ze))&&Math.abs(f-xe)<=Ee*Math.max(1,Math.abs(f),Math.abs(xe))&&Math.abs(_-Ie)<=Ee*Math.max(1,Math.abs(_),Math.abs(Ie))&&Math.abs(x-Ze)<=Ee*Math.max(1,Math.abs(x),Math.abs(Ze))&&Math.abs(S-Je)<=Ee*Math.max(1,Math.abs(S),Math.abs(Je))&&Math.abs(A-ht)<=Ee*Math.max(1,Math.abs(A),Math.abs(ht))&&Math.abs(I-Dt)<=Ee*Math.max(1,Math.abs(I),Math.abs(Dt))&&Math.abs(O-xt)<=Ee*Math.max(1,Math.abs(O),Math.abs(xt))&&Math.abs(z-Ct)<=Ee*Math.max(1,Math.abs(z),Math.abs(Ct))&&Math.abs(V-Vt)<=Ee*Math.max(1,Math.abs(V),Math.abs(Vt))&&Math.abs(Z-At)<=Ee*Math.max(1,Math.abs(Z),Math.abs(At))&&Math.abs(X-Tt)<=Ee*Math.max(1,Math.abs(X),Math.abs(Tt))&&Math.abs(Q-it)<=Ee*Math.max(1,Math.abs(Q),Math.abs(it))&&Math.abs(ae-Yt)<=Ee*Math.max(1,Math.abs(ae),Math.abs(Yt))&&Math.abs(ce-Jt)<=Ee*Math.max(1,Math.abs(ce),Math.abs(Jt))&&Math.abs(me-Gt)<=Ee*Math.max(1,Math.abs(me),Math.abs(Gt))},y.cA=function(s,i){te.REGISTERED_PROTOCOLS[s]=i},y.cB=function(s){delete te.REGISTERED_PROTOCOLS[s]},y.cC=function(s,i){const o={};for(let _=0;_<s.length;_++){const x=i&&i[s[_].id]||yc(s[_]);i&&(i[s[_].id]=x);let S=o[x];S||(S=o[x]=[]),S.push(s[_])}const f=[];for(const _ in o)f.push(o[_]);return f},y.cD=kt,y.cE=eg,y.cF=X_,y.cG=yp,y.cH=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=ut/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const i=s.bucket.layers[0],o=i.layout,f=i._unevaluatedLayout._values,_={layoutIconSize:f["icon-size"].possiblyEvaluate(new ti(s.bucket.zoom+1),s.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new ti(s.bucket.zoom+1),s.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new ti(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:O,maxZoom:z}=s.bucket.textSizeData;_.compositeTextSizes=[f["text-size"].possiblyEvaluate(new ti(O),s.canonical),f["text-size"].possiblyEvaluate(new ti(z),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:O,maxZoom:z}=s.bucket.iconSizeData;_.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new ti(O),s.canonical),f["icon-size"].possiblyEvaluate(new ti(z),s.canonical)]}const x=o.get("text-line-height")*ai,S=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",A=o.get("text-keep-upright"),I=o.get("text-size");for(const O of s.bucket.features){const z=o.get("text-font").evaluate(O,{},s.canonical).join(","),V=I.evaluate(O,{},s.canonical),Z=_.layoutTextSize.evaluate(O,{},s.canonical),X=_.layoutIconSize.evaluate(O,{},s.canonical),Q={horizontal:{},vertical:void 0},ae=O.text;let ce,me=[0,0];if(ae){const Ie=ae.toString(),Ze=o.get("text-letter-spacing").evaluate(O,{},s.canonical)*ai,Je=ap(Ie)?Ze:0,ht=o.get("text-anchor").evaluate(O,{},s.canonical),Dt=Wy(i,O,s.canonical);if(!Dt){const At=o.get("text-radial-offset").evaluate(O,{},s.canonical);me=At?Kh(ht,[At*ai,Xy]):o.get("text-offset").evaluate(O,{},s.canonical).map(Tt=>Tt*ai)}let xt=S?"center":o.get("text-justify").evaluate(O,{},s.canonical);const Ct=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(O,{},s.canonical)*ai:1/0,Vt=()=>{s.bucket.allowVerticalPlacement&&Vo(Ie)&&(Q.vertical=_p(ae,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ct,x,ht,"left",Je,me,y.ao.vertical,!0,Z,V))};if(!S&&Dt){const At=new Set;if(xt==="auto")for(let it=0;it<Dt.values.length;it+=2)At.add(Qy(Dt.values[it]));else At.add(xt);let Tt=!1;for(const it of At)if(!Q.horizontal[it])if(Tt)Q.horizontal[it]=Q.horizontal[0];else{const Yt=_p(ae,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ct,x,"center",it,Je,me,y.ao.horizontal,!1,Z,V);Yt&&(Q.horizontal[it]=Yt,Tt=Yt.positionedLines.length===1)}Vt()}else{xt==="auto"&&(xt=Qy(ht));const At=_p(ae,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ct,x,ht,xt,Je,me,y.ao.horizontal,!1,Z,V);At&&(Q.horizontal[xt]=At),Vt(),Vo(Ie)&&S&&A&&(Q.vertical=_p(ae,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ct,x,ht,xt,Je,me,y.ao.vertical,!1,Z,V))}}let ze=!1;if(O.icon&&O.icon.name){const Ie=s.imageMap[O.icon.name];Ie&&(ce=Ly(s.imagePositions[O.icon.name],o.get("icon-offset").evaluate(O,{},s.canonical),o.get("icon-anchor").evaluate(O,{},s.canonical)),ze=!!Ie.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ze:s.bucket.sdfIcons!==ze&&Vn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ie.pixelRatio!==s.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const xe=ev(Q.horizontal)||Q.vertical;s.bucket.iconsInText=!!xe&&xe.iconsInText,(xe||ce)&&Hb(s.bucket,O,Q,ce,s.imageMap,_,Z,X,me,ze,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},y.cI=za,y.cJ=up,y.cK=Nn,y.cL=P_,y.cM=Fm,y.cN=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},y.cO=function(s,i,o,f,_){return l(this,void 0,void 0,function*(){if(de())try{return yield Gr(s,i,o,f,_)}catch{}return function(x,S,A,I,O){const z=x.width,V=x.height;Or&&Va||(Or=new OffscreenCanvas(z,V),Va=Or.getContext("2d",{willReadFrequently:!0})),Or.width=z,Or.height=V,Va.drawImage(x,0,0,z,V);const Z=Va.getImageData(S,A,I,O);return Va.clearRect(0,0,z,V),Z.data}(s,i,o,f,_)})},y.cP=Kd,y.cQ=C,y.cR=pp,y.cS=Hh,y.cT=Ss,y.cU=function(s,i){const o=new Map;if(s!=null)if(s.type==="Feature")o.set(yf(s,i),s);else for(const f of s.features)o.set(yf(f,i),f);return o},y.cV=function(s,i){if(s==null)return!0;if(s.type==="Feature")return yf(s,i)!=null;if(s.type==="FeatureCollection"){const o=new Set;for(const f of s.features){const _=yf(f,i);if(_==null||o.has(_))return!1;o.add(_)}return!0}return!1},y.cW=function(s,i,o){var f,_,x,S;if(i.removeAll&&s.clear(),i.remove)for(const A of i.remove)s.delete(A);if(i.add)for(const A of i.add){const I=yf(A,o);I!=null&&s.set(I,A)}if(i.update)for(const A of i.update){let I=s.get(A.id);if(I==null)continue;const O=!A.removeAllProperties&&(((f=A.removeProperties)===null||f===void 0?void 0:f.length)>0||((_=A.addOrUpdateProperties)===null||_===void 0?void 0:_.length)>0);if((A.newGeometry||A.removeAllProperties||O)&&(I=Object.assign({},I),s.set(A.id,I),O&&(I.properties=Object.assign({},I.properties))),A.newGeometry&&(I.geometry=A.newGeometry),A.removeAllProperties)I.properties={};else if(((x=A.removeProperties)===null||x===void 0?void 0:x.length)>0)for(const z of A.removeProperties)Object.prototype.hasOwnProperty.call(I.properties,z)&&delete I.properties[z];if(((S=A.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0)for(const{key:z,value:V}of A.addOrUpdateProperties)I.properties[z]=V}},y.cX=sa,y.ca=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},y.cb=s=>s.type==="symbol",y.cc=s=>s.type==="circle",y.cd=s=>s.type==="heatmap",y.ce=s=>s.type==="line",y.cf=s=>s.type==="fill",y.cg=s=>s.type==="fill-extrusion",y.ch=s=>s.type==="hillshade",y.ci=s=>s.type==="color-relief",y.cj=s=>s.type==="raster",y.ck=s=>s.type==="background",y.cl=s=>s.type==="custom",y.cm=Et,y.cn=function(s,i,o){const f=_t(i.x-o.x,i.y-o.y),_=_t(s.x-o.x,s.y-o.y);var x,S;return Ga(Math.atan2(f[0]*_[1]-f[1]*_[0],(x=f)[0]*(S=_)[0]+x[1]*S[1]))},y.co=Ut,y.cp=function(s,i){return ii[i]&&(s instanceof MouseEvent||s instanceof WheelEvent)},y.cq=function(s,i){return gn[i]&&"touches"in s},y.cr=function(s){return gn[s]||ii[s]},y.cs=function(s,i,o){var f=i[0],_=i[1];return s[0]=o[0]*f+o[4]*_+o[12],s[1]=o[1]*f+o[5]*_+o[13],s},y.ct=function(s,i){const{x:o,y:f}=Qh.fromLngLat(i);return!(s<0||s>25||f<0||f>=1||o<0||o>=1)},y.cu=function(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},y.cv=class extends Wr{},y.cw=lg,y.cy=function(s){return s.message===xr},y.cz=be,y.d=Ye,y.e=Wt,y.f=s=>l(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(i)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),y.g=ne,y.h=s=>new Promise((i,o)=>{const f=new Image;f.onload=()=>{i(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=_a})},f.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(s)],{type:"image/png"});f.src=s.byteLength?URL.createObjectURL(_):_a}),y.i=Pr,y.j=(s,i)=>Oe(Wt(s,{type:"json"}),i),y.k=ot,y.l=mt,y.m=Oe,y.n=(s,i)=>Oe(Wt(s,{type:"arrayBuffer"}),i),y.o=function(s){return new Fm(s).readFields(Ub,[])},y.p=Iy,y.q=Vh,y.r=$n,y.s=Ca,y.t=Ms,y.u=In,y.v=Fe,y.w=Vn,y.x=gm,y.y=mu,y.z=pu}),d("worker",["./shared"],function(y){class l{constructor(te,ne){this.keyCache={},te&&this.replace(te,ne)}replace(te,ne){this._layerConfigs={},this._layers={},this.update(te,[],ne)}update(te,ne,le){for(const De of te){this._layerConfigs[De.id]=De;const Oe=this._layers[De.id]=y.bJ(De,le);Oe._featureFilter=y.aa(Oe.filter,le),this.keyCache[De.id]&&delete this.keyCache[De.id]}for(const De of ne)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const be=y.cC(Object.values(this._layerConfigs),this.keyCache);for(const De of be){const Oe=De.map(jt=>this._layers[jt.id]),Ye=Oe[0];if(Ye.visibility==="none")continue;const je=Ye.source||"";let tt=this.familiesBySource[je];tt||(tt=this.familiesBySource[je]={});const mt=Ye.sourceLayer||"_geojsonTileLayer";let ot=tt[mt];ot||(ot=tt[mt]=[]),ot.push(Oe)}}}class E{constructor(te){const ne={},le=[];for(const Ye in te){const je=te[Ye],tt=ne[Ye]={};for(const mt in je){const ot=je[+mt];if(!ot||ot.bitmap.width===0||ot.bitmap.height===0)continue;const jt={x:0,y:0,w:ot.bitmap.width+2,h:ot.bitmap.height+2};le.push(jt),tt[mt]={rect:jt,metrics:ot.metrics}}}const{w:be,h:De}=y.p(le),Oe=new y.q({width:be||1,height:De||1});for(const Ye in te){const je=te[Ye];for(const tt in je){const mt=je[+tt];if(!mt||mt.bitmap.width===0||mt.bitmap.height===0)continue;const ot=ne[Ye][tt].rect;y.q.copy(mt.bitmap,Oe,{x:0,y:0},{x:ot.x+1,y:ot.y+1},mt.bitmap)}}this.image=Oe,this.positions=ne}}y.cD("GlyphAtlas",E);class C{constructor(te){this.tileID=new y.Z(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId,this.inFlightDependencies=[]}parse(te,ne,le,be,De){return y._(this,void 0,void 0,function*(){this.status="parsing",this.data=te,this.collisionBoxArray=new y.a8;const Oe=new y.cE(Object.keys(te.layers).sort()),Ye=new y.cF(this.tileID,this.promoteId);Ye.bucketLayerIDs=[];const je={},tt={featureIndex:Ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le,subdivisionGranularity:De},mt=ne.familiesBySource[this.source];for(const Kt in mt){const an=te.layers[Kt];if(!an)continue;an.version===1&&y.w(`Vector tile source "${this.source}" layer "${Kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pi=Oe.encode(Kt),wt=[];for(let Jr=0;Jr<an.length;Jr++){const Yi=an.feature(Jr),Vs=Ye.getId(Yi,Kt);wt.push({feature:Yi,id:Vs,index:Jr,sourceLayerIndex:Pi})}for(const Jr of mt[Kt]){const Yi=Jr[0];Yi.source!==this.source&&y.w(`layer.source = ${Yi.source} does not equal this.source = ${this.source}`),Yi.minzoom&&this.zoom<Math.floor(Yi.minzoom)||Yi.maxzoom&&this.zoom>=Yi.maxzoom||Yi.visibility!=="none"&&(k(Jr,this.zoom,le),(je[Yi.id]=Yi.createBucket({index:Ye.bucketLayerIDs.length,layers:Jr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pi,sourceID:this.source})).populate(wt,tt,this.tileID.canonical),Ye.bucketLayerIDs.push(Jr.map(Vs=>Vs.id)))}}const ot=y.bN(tt.glyphDependencies,Kt=>Object.keys(Kt).map(Number));this.inFlightDependencies.forEach(Kt=>Kt?.abort()),this.inFlightDependencies=[];let jt=Promise.resolve({});if(Object.keys(ot).length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),jt=be.sendAsync({type:"GG",data:{stacks:ot,source:this.source,tileID:this.tileID,type:"glyphs"}},Kt)}const Fe=Object.keys(tt.iconDependencies);let rn=Promise.resolve({});if(Fe.length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),rn=be.sendAsync({type:"GI",data:{icons:Fe,source:this.source,tileID:this.tileID,type:"icons"}},Kt)}const Sn=Object.keys(tt.patternDependencies);let $t=Promise.resolve({});if(Sn.length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),$t=be.sendAsync({type:"GI",data:{icons:Sn,source:this.source,tileID:this.tileID,type:"patterns"}},Kt)}const[cn,ci,fr]=yield Promise.all([jt,rn,$t]),wr=new E(cn),di=new y.cG(ci,fr);for(const Kt in je){const an=je[Kt];an instanceof y.a9?(k(an.layers,this.zoom,le),y.cH({bucket:an,glyphMap:cn,glyphPositions:wr.positions,imageMap:ci,imagePositions:di.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:tt.subdivisionGranularity})):an.hasPattern&&(an instanceof y.cI||an instanceof y.cJ||an instanceof y.cK)&&(k(an.layers,this.zoom,le),an.addFeatures(tt,this.tileID.canonical,di.patternPositions))}return this.status="done",{buckets:Object.values(je).filter(Kt=>!Kt.isEmpty()),featureIndex:Ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wr.image,imageAtlas:di,glyphMap:this.returnDependencies?cn:null,iconMap:this.returnDependencies?ci:null,glyphPositions:this.returnDependencies?wr.positions:null}})}}function k(Pe,te,ne){const le=new y.F(te);for(const be of Pe)be.recalculate(le,ne)}class N{constructor(te,ne,le){this.actor=te,this.layerIndex=ne,this.availableImages=le,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(te,ne){return y._(this,void 0,void 0,function*(){const le=yield y.n(te.request,ne);try{return{vectorTile:new y.cL(new y.cM(le.data)),rawData:le.data,cacheControl:le.cacheControl,expires:le.expires}}catch(be){const De=new Uint8Array(le.data);let Oe=`Unable to parse the tile at ${te.request.url}, `;throw Oe+=De[0]===31&&De[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${be.message}`,new Error(Oe)}})}loadTile(te){return y._(this,void 0,void 0,function*(){const ne=te.uid,le=!!(te&&te.request&&te.request.collectResourceTiming)&&new y.cN(te.request),be=new C(te);this.loading[ne]=be;const De=new AbortController;be.abort=De;try{const Oe=yield this.loadVectorTile(te,De);if(delete this.loading[ne],!Oe)return null;const Ye=Oe.rawData,je={};Oe.expires&&(je.expires=Oe.expires),Oe.cacheControl&&(je.cacheControl=Oe.cacheControl);const tt={};if(le){const ot=le.finish();ot&&(tt.resourceTiming=JSON.parse(JSON.stringify(ot)))}be.vectorTile=Oe.vectorTile;const mt=be.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity);this.loaded[ne]=be,this.fetching[ne]={rawTileData:Ye,cacheControl:je,resourceTiming:tt};try{const ot=yield mt;return y.e({rawTileData:Ye.slice(0)},ot,je,tt)}finally{delete this.fetching[ne]}}catch(Oe){throw delete this.loading[ne],be.status="done",this.loaded[ne]=be,Oe}})}reloadTile(te){return y._(this,void 0,void 0,function*(){const ne=te.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const le=this.loaded[ne];if(le.showCollisionBoxes=te.showCollisionBoxes,le.status==="parsing"){const be=yield le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity);let De;if(this.fetching[ne]){const{rawTileData:Oe,cacheControl:Ye,resourceTiming:je}=this.fetching[ne];delete this.fetching[ne],De=y.e({rawTileData:Oe.slice(0)},be,Ye,je)}else De=be;return De}if(le.status==="done"&&le.vectorTile)return le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity)})}abortTile(te){return y._(this,void 0,void 0,function*(){const ne=this.loading,le=te.uid;ne&&ne[le]&&ne[le].abort&&(ne[le].abort.abort(),delete ne[le])})}removeTile(te){return y._(this,void 0,void 0,function*(){this.loaded&&this.loaded[te.uid]&&delete this.loaded[te.uid]})}}class F{constructor(){this.loaded={}}loadTile(te){return y._(this,void 0,void 0,function*(){const{uid:ne,encoding:le,rawImageData:be,redFactor:De,greenFactor:Oe,blueFactor:Ye,baseShift:je}=te,tt=be.width+2,mt=be.height+2,ot=y.b(be)?new y.R({width:tt,height:mt},yield y.cO(be,-1,-1,tt,mt)):be,jt=new y.cP(ne,ot,le,De,Oe,Ye,je);return this.loaded=this.loaded||{},this.loaded[ne]=jt,jt})}removeTile(te){const ne=this.loaded,le=te.uid;ne&&ne[le]&&delete ne[le]}}var B,W,re=function(){if(W)return B;function Pe(ne,le){if(ne.length!==0){te(ne[0],le);for(var be=1;be<ne.length;be++)te(ne[be],!le)}}function te(ne,le){for(var be=0,De=0,Oe=0,Ye=ne.length,je=Ye-1;Oe<Ye;je=Oe++){var tt=(ne[Oe][0]-ne[je][0])*(ne[je][1]+ne[Oe][1]),mt=be+tt;De+=Math.abs(be)>=Math.abs(tt)?be-mt+tt:tt-mt+be,be=mt}be+De>=0!=!!le&&ne.reverse()}return W=1,B=function ne(le,be){var De,Oe=le&&le.type;if(Oe==="FeatureCollection")for(De=0;De<le.features.length;De++)ne(le.features[De],be);else if(Oe==="GeometryCollection")for(De=0;De<le.geometries.length;De++)ne(le.geometries[De],be);else if(Oe==="Feature")ne(le.geometry,be);else if(Oe==="Polygon")Pe(le.coordinates,be);else if(Oe==="MultiPolygon")for(De=0;De<le.coordinates.length;De++)Pe(le.coordinates[De],be);return le}}(),ie=y.cQ(re);class de extends y.cS{constructor(te,ne){super(new y.cM,0,ne,[],[]),this.feature=te,this.type=te.type,this.properties=te.tags?te.tags:{},"id"in te&&(typeof te.id=="string"?this.id=parseInt(te.id,10):typeof te.id!="number"||isNaN(te.id)||(this.id=te.id))}loadGeometry(){const te=[],ne=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const le of ne){const be=[];for(const De of le)be.push(new y.P(De[0],De[1]));te.push(be)}return te}}class Ee extends y.cR{constructor(te,ne){super(new y.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ne?ne.version:1,this.extent=ne?ne.extent:4096,this.length=te.length,this.features=te}feature(te){return new de(this.features[te],this.extent)}}function we(Pe,te){te.writeVarintField(15,Pe.version||1),te.writeStringField(1,Pe.name||""),te.writeVarintField(5,Pe.extent||4096);const ne={keys:[],values:[],keycache:{},valuecache:{}};for(let De=0;De<Pe.length;De++)ne.feature=Pe.feature(De),te.writeMessage(2,ke,ne);const le=ne.keys;for(const De of le)te.writeStringField(3,De);const be=ne.values;for(const De of be)te.writeMessage(4,Me,De)}function ke(Pe,te){if(!Pe.feature)return;const ne=Pe.feature;ne.id!==void 0&&te.writeVarintField(1,ne.id),te.writeMessage(2,ge,Pe),te.writeVarintField(3,ne.type),te.writeMessage(4,at,ne)}function ge(Pe,te){for(const ne in Pe.feature?.properties){let le=Pe.feature.properties[ne],be=Pe.keycache[ne];if(le===null)continue;be===void 0&&(Pe.keys.push(ne),be=Pe.keys.length-1,Pe.keycache[ne]=be),te.writeVarint(be),typeof le!="string"&&typeof le!="boolean"&&typeof le!="number"&&(le=JSON.stringify(le));const De=typeof le+":"+le;let Oe=Pe.valuecache[De];Oe===void 0&&(Pe.values.push(le),Oe=Pe.values.length-1,Pe.valuecache[De]=Oe),te.writeVarint(Oe)}}function Ae(Pe,te){return(te<<3)+(7&Pe)}function Ge(Pe){return Pe<<1^Pe>>31}function at(Pe,te){const ne=Pe.loadGeometry(),le=Pe.type;let be=0,De=0;for(const Oe of ne){let Ye=1;le===1&&(Ye=Oe.length),te.writeVarint(Ae(1,Ye));const je=le===3?Oe.length-1:Oe.length;for(let tt=0;tt<je;tt++){tt===1&&le!==1&&te.writeVarint(Ae(2,je-1));const mt=Oe[tt].x-be,ot=Oe[tt].y-De;te.writeVarint(Ge(mt)),te.writeVarint(Ge(ot)),be+=mt,De+=ot}Pe.type===3&&te.writeVarint(Ae(7,1))}}function Me(Pe,te){const ne=typeof Pe;ne==="string"?te.writeStringField(1,Pe):ne==="boolean"?te.writeBooleanField(7,Pe):ne==="number"&&(Pe%1!=0?te.writeDoubleField(3,Pe):Pe<0?te.writeSVarintField(6,Pe):te.writeVarintField(5,Pe))}const Qe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Pe=>Pe},St=Math.fround||(bt=new Float32Array(1),Pe=>(bt[0]=+Pe,bt[0]));var bt;class zt{constructor(te){this.options=Object.assign(Object.create(Qe),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:ne,minZoom:le,maxZoom:be}=this.options;ne&&console.time("total time");const De=`prepare ${te.length} points`;ne&&console.time(De),this.points=te;const Oe=[];for(let je=0;je<te.length;je++){const tt=te[je];if(!tt.geometry)continue;const[mt,ot]=tt.geometry.coordinates,jt=St(Be(mt)),Fe=St(lt(ot));Oe.push(jt,Fe,1/0,je,-1,1),this.options.reduce&&Oe.push(0)}let Ye=this.trees[be+1]=this._createTree(Oe);ne&&console.timeEnd(De);for(let je=be;je>=le;je--){const tt=+Date.now();Ye=this.trees[je]=this._createTree(this._cluster(Ye,je)),ne&&console.log("z%d: %d clusters in %dms",je,Ye.numItems,+Date.now()-tt)}return ne&&console.timeEnd("total time"),this}getClusters(te,ne){let le=((te[0]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,te[1]));let De=te[2]===180?180:((te[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)le=-180,De=180;else if(le>De){const ot=this.getClusters([le,be,180,Oe],ne),jt=this.getClusters([-180,be,De,Oe],ne);return ot.concat(jt)}const Ye=this.trees[this._limitZoom(ne)],je=Ye.range(Be(le),lt(Oe),Be(De),lt(be)),tt=Ye.data,mt=[];for(const ot of je){const jt=this.stride*ot;mt.push(tt[jt+5]>1?Zt(tt,jt,this.clusterProps):this.points[tt[jt+3]])}return mt}getChildren(te){const ne=this._getOriginId(te),le=this._getOriginZoom(te),be="No cluster with the specified id.",De=this.trees[le];if(!De)throw new Error(be);const Oe=De.data;if(ne*this.stride>=Oe.length)throw new Error(be);const Ye=this.options.radius/(this.options.extent*Math.pow(2,le-1)),je=De.within(Oe[ne*this.stride],Oe[ne*this.stride+1],Ye),tt=[];for(const mt of je){const ot=mt*this.stride;Oe[ot+4]===te&&tt.push(Oe[ot+5]>1?Zt(Oe,ot,this.clusterProps):this.points[Oe[ot+3]])}if(tt.length===0)throw new Error(be);return tt}getLeaves(te,ne,le){const be=[];return this._appendLeaves(be,te,ne=ne||10,le=le||0,0),be}getTile(te,ne,le){const be=this.trees[this._limitZoom(te)],De=Math.pow(2,te),{extent:Oe,radius:Ye}=this.options,je=Ye/Oe,tt=(le-je)/De,mt=(le+1+je)/De,ot={features:[]};return this._addTileFeatures(be.range((ne-je)/De,tt,(ne+1+je)/De,mt),be.data,ne,le,De,ot),ne===0&&this._addTileFeatures(be.range(1-je/De,tt,1,mt),be.data,De,le,De,ot),ne===De-1&&this._addTileFeatures(be.range(0,tt,je/De,mt),be.data,-1,le,De,ot),ot.features.length?ot:null}getClusterExpansionZoom(te){let ne=this._getOriginZoom(te)-1;for(;ne<=this.options.maxZoom;){const le=this.getChildren(te);if(ne++,le.length!==1)break;te=le[0].properties.cluster_id}return ne}_appendLeaves(te,ne,le,be,De){const Oe=this.getChildren(ne);for(const Ye of Oe){const je=Ye.properties;if(je&&je.cluster?De+je.point_count<=be?De+=je.point_count:De=this._appendLeaves(te,je.cluster_id,le,be,De):De<be?De++:te.push(Ye),te.length===le)break}return De}_createTree(te){const ne=new y.aI(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let le=0;le<te.length;le+=this.stride)ne.add(te[le],te[le+1]);return ne.finish(),ne.data=te,ne}_addTileFeatures(te,ne,le,be,De,Oe){for(const Ye of te){const je=Ye*this.stride,tt=ne[je+5]>1;let mt,ot,jt;if(tt)mt=Ft(ne,je,this.clusterProps),ot=ne[je],jt=ne[je+1];else{const Sn=this.points[ne[je+3]];mt=Sn.properties;const[$t,cn]=Sn.geometry.coordinates;ot=Be($t),jt=lt(cn)}const Fe={type:1,geometry:[[Math.round(this.options.extent*(ot*De-le)),Math.round(this.options.extent*(jt*De-be))]],tags:mt};let rn;rn=tt||this.options.generateId?ne[je+3]:this.points[ne[je+3]].id,rn!==void 0&&(Fe.id=rn),Oe.features.push(Fe)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,ne){const{radius:le,extent:be,reduce:De,minPoints:Oe}=this.options,Ye=le/(be*Math.pow(2,ne)),je=te.data,tt=[],mt=this.stride;for(let ot=0;ot<je.length;ot+=mt){if(je[ot+2]<=ne)continue;je[ot+2]=ne;const jt=je[ot],Fe=je[ot+1],rn=te.within(je[ot],je[ot+1],Ye),Sn=je[ot+5];let $t=Sn;for(const cn of rn){const ci=cn*mt;je[ci+2]>ne&&($t+=je[ci+5])}if($t>Sn&&$t>=Oe){let cn,ci=jt*Sn,fr=Fe*Sn,wr=-1;const di=(ot/mt<<5)+(ne+1)+this.points.length;for(const Kt of rn){const an=Kt*mt;if(je[an+2]<=ne)continue;je[an+2]=ne;const Pi=je[an+5];ci+=je[an]*Pi,fr+=je[an+1]*Pi,je[an+4]=di,De&&(cn||(cn=this._map(je,ot,!0),wr=this.clusterProps.length,this.clusterProps.push(cn)),De(cn,this._map(je,an)))}je[ot+4]=di,tt.push(ci/$t,fr/$t,1/0,di,-1,$t),De&&tt.push(wr)}else{for(let cn=0;cn<mt;cn++)tt.push(je[ot+cn]);if($t>1)for(const cn of rn){const ci=cn*mt;if(!(je[ci+2]<=ne)){je[ci+2]=ne;for(let fr=0;fr<mt;fr++)tt.push(je[ci+fr])}}}}return tt}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,ne,le){if(te[ne+5]>1){const Oe=this.clusterProps[te[ne+6]];return le?Object.assign({},Oe):Oe}const be=this.points[te[ne+3]].properties,De=this.options.map(be);return le&&De===be?Object.assign({},De):De}}function Zt(Pe,te,ne){return{type:"Feature",id:Pe[te+3],properties:Ft(Pe,te,ne),geometry:{type:"Point",coordinates:[(le=Pe[te],360*(le-.5)),_t(Pe[te+1])]}};var le}function Ft(Pe,te,ne){const le=Pe[te+5],be=le>=1e4?`${Math.round(le/1e3)}k`:le>=1e3?Math.round(le/100)/10+"k":le,De=Pe[te+6],Oe=De===-1?{}:Object.assign({},ne[De]);return Object.assign(Oe,{cluster:!0,cluster_id:Pe[te+3],point_count:le,point_count_abbreviated:be})}function Be(Pe){return Pe/360+.5}function lt(Pe){const te=Math.sin(Pe*Math.PI/180),ne=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return ne<0?0:ne>1?1:ne}function _t(Pe){const te=(180-360*Pe)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function ut(Pe,te,ne,le){let be=le;const De=te+(ne-te>>1);let Oe,Ye=ne-te;const je=Pe[te],tt=Pe[te+1],mt=Pe[ne],ot=Pe[ne+1];for(let jt=te+3;jt<ne;jt+=3){const Fe=Te(Pe[jt],Pe[jt+1],je,tt,mt,ot);if(Fe>be)Oe=jt,be=Fe;else if(Fe===be){const rn=Math.abs(jt-De);rn<Ye&&(Oe=jt,Ye=rn)}}be>le&&(Oe-te>3&&ut(Pe,te,Oe,le),Pe[Oe+2]=be,ne-Oe>3&&ut(Pe,Oe,ne,le))}function Te(Pe,te,ne,le,be,De){let Oe=be-ne,Ye=De-le;if(Oe!==0||Ye!==0){const je=((Pe-ne)*Oe+(te-le)*Ye)/(Oe*Oe+Ye*Ye);je>1?(ne=be,le=De):je>0&&(ne+=Oe*je,le+=Ye*je)}return Oe=Pe-ne,Ye=te-le,Oe*Oe+Ye*Ye}function nt(Pe,te,ne,le){const be={id:Pe??null,type:te,geometry:ne,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")yt(be,ne);else if(te==="Polygon")yt(be,ne[0]);else if(te==="MultiLineString")for(const De of ne)yt(be,De);else if(te==="MultiPolygon")for(const De of ne)yt(be,De[0]);return be}function yt(Pe,te){for(let ne=0;ne<te.length;ne+=3)Pe.minX=Math.min(Pe.minX,te[ne]),Pe.minY=Math.min(Pe.minY,te[ne+1]),Pe.maxX=Math.max(Pe.maxX,te[ne]),Pe.maxY=Math.max(Pe.maxY,te[ne+1])}function pt(Pe,te,ne,le){if(!te.geometry)return;const be=te.geometry.coordinates;if(be&&be.length===0)return;const De=te.geometry.type,Oe=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let Ye=[],je=te.id;if(ne.promoteId?je=te.properties[ne.promoteId]:ne.generateId&&(je=le||0),De==="Point")Et(be,Ye);else if(De==="MultiPoint")for(const tt of be)Et(tt,Ye);else if(De==="LineString")Ut(be,Ye,Oe,!1);else if(De==="MultiLineString"){if(ne.lineMetrics){for(const tt of be)Ye=[],Ut(tt,Ye,Oe,!1),Pe.push(nt(je,"LineString",Ye,te.properties));return}Ot(be,Ye,Oe,!1)}else if(De==="Polygon")Ot(be,Ye,Oe,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(const tt of te.geometry.geometries)pt(Pe,{id:je,geometry:tt,properties:te.properties},ne,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const tt of be){const mt=[];Ot(tt,mt,Oe,!0),Ye.push(mt)}}Pe.push(nt(je,De,Ye,te.properties))}function Et(Pe,te){te.push(Ln(Pe[0]),Wt(Pe[1]),0)}function Ut(Pe,te,ne,le){let be,De,Oe=0;for(let je=0;je<Pe.length;je++){const tt=Ln(Pe[je][0]),mt=Wt(Pe[je][1]);te.push(tt,mt,0),je>0&&(Oe+=le?(be*mt-tt*De)/2:Math.sqrt(Math.pow(tt-be,2)+Math.pow(mt-De,2))),be=tt,De=mt}const Ye=te.length-3;te[2]=1,ut(te,0,Ye,ne),te[Ye+2]=1,te.size=Math.abs(Oe),te.start=0,te.end=te.size}function Ot(Pe,te,ne,le){for(let be=0;be<Pe.length;be++){const De=[];Ut(Pe[be],De,ne,le),te.push(De)}}function Ln(Pe){return Pe/360+.5}function Wt(Pe){const te=Math.sin(Pe*Math.PI/180),ne=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return ne<0?0:ne>1?1:ne}function Xn(Pe,te,ne,le,be,De,Oe,Ye){if(le/=te,De>=(ne/=te)&&Oe<le)return Pe;if(Oe<ne||De>=le)return null;const je=[];for(const tt of Pe){const mt=tt.geometry;let ot=tt.type;const jt=be===0?tt.minX:tt.minY,Fe=be===0?tt.maxX:tt.maxY;if(jt>=ne&&Fe<le){je.push(tt);continue}if(Fe<ne||jt>=le)continue;let rn=[];if(ot==="Point"||ot==="MultiPoint")br(mt,rn,ne,le,be);else if(ot==="LineString")ir(mt,rn,ne,le,be,!1,Ye.lineMetrics);else if(ot==="MultiLineString")Un(mt,rn,ne,le,be,!1);else if(ot==="Polygon")Un(mt,rn,ne,le,be,!0);else if(ot==="MultiPolygon")for(const Sn of mt){const $t=[];Un(Sn,$t,ne,le,be,!0),$t.length&&rn.push($t)}if(rn.length){if(Ye.lineMetrics&&ot==="LineString"){for(const Sn of rn)je.push(nt(tt.id,ot,Sn,tt.tags));continue}ot!=="LineString"&&ot!=="MultiLineString"||(rn.length===1?(ot="LineString",rn=rn[0]):ot="MultiLineString"),ot!=="Point"&&ot!=="MultiPoint"||(ot=rn.length===3?"Point":"MultiPoint"),je.push(nt(tt.id,ot,rn,tt.tags))}}return je.length?je:null}function br(Pe,te,ne,le,be){for(let De=0;De<Pe.length;De+=3){const Oe=Pe[De+be];Oe>=ne&&Oe<=le&&Vn(te,Pe[De],Pe[De+1],Pe[De+2])}}function ir(Pe,te,ne,le,be,De,Oe){let Ye=yi(Pe);const je=be===0?Dn:Pr;let tt,mt,ot=Pe.start;for(let $t=0;$t<Pe.length-3;$t+=3){const cn=Pe[$t],ci=Pe[$t+1],fr=Pe[$t+2],wr=Pe[$t+3],di=Pe[$t+4],Kt=be===0?cn:ci,an=be===0?wr:di;let Pi=!1;Oe&&(tt=Math.sqrt(Math.pow(cn-wr,2)+Math.pow(ci-di,2))),Kt<ne?an>ne&&(mt=je(Ye,cn,ci,wr,di,ne),Oe&&(Ye.start=ot+tt*mt)):Kt>le?an<le&&(mt=je(Ye,cn,ci,wr,di,le),Oe&&(Ye.start=ot+tt*mt)):Vn(Ye,cn,ci,fr),an<ne&&Kt>=ne&&(mt=je(Ye,cn,ci,wr,di,ne),Pi=!0),an>le&&Kt<=le&&(mt=je(Ye,cn,ci,wr,di,le),Pi=!0),!De&&Pi&&(Oe&&(Ye.end=ot+tt*mt),te.push(Ye),Ye=yi(Pe)),Oe&&(ot+=tt)}let jt=Pe.length-3;const Fe=Pe[jt],rn=Pe[jt+1],Sn=be===0?Fe:rn;Sn>=ne&&Sn<=le&&Vn(Ye,Fe,rn,Pe[jt+2]),jt=Ye.length-3,De&&jt>=3&&(Ye[jt]!==Ye[0]||Ye[jt+1]!==Ye[1])&&Vn(Ye,Ye[0],Ye[1],Ye[2]),Ye.length&&te.push(Ye)}function yi(Pe){const te=[];return te.size=Pe.size,te.start=Pe.start,te.end=Pe.end,te}function Un(Pe,te,ne,le,be,De){for(const Oe of Pe)ir(Oe,te,ne,le,be,De,!1)}function Vn(Pe,te,ne,le){Pe.push(te,ne,le)}function Dn(Pe,te,ne,le,be,De){const Oe=(De-te)/(le-te);return Vn(Pe,De,ne+(be-ne)*Oe,1),Oe}function Pr(Pe,te,ne,le,be,De){const Oe=(De-ne)/(be-ne);return Vn(Pe,te+(le-te)*Oe,De,1),Oe}function ki(Pe,te){const ne=[];for(let le=0;le<Pe.length;le++){const be=Pe[le],De=be.type;let Oe;if(De==="Point"||De==="MultiPoint"||De==="LineString")Oe=Aa(be.geometry,te);else if(De==="MultiLineString"||De==="Polygon"){Oe=[];for(const Ye of be.geometry)Oe.push(Aa(Ye,te))}else if(De==="MultiPolygon"){Oe=[];for(const Ye of be.geometry){const je=[];for(const tt of Ye)je.push(Aa(tt,te));Oe.push(je)}}ne.push(nt(be.id,De,Oe,be.tags))}return ne}function Aa(Pe,te){const ne=[];ne.size=Pe.size,Pe.start!==void 0&&(ne.start=Pe.start,ne.end=Pe.end);for(let le=0;le<Pe.length;le+=3)ne.push(Pe[le]+te,Pe[le+1],Pe[le+2]);return ne}function _a(Pe,te){if(Pe.transformed)return Pe;const ne=1<<Pe.z,le=Pe.x,be=Pe.y;for(const De of Pe.features){const Oe=De.geometry,Ye=De.type;if(De.geometry=[],Ye===1)for(let je=0;je<Oe.length;je+=2)De.geometry.push(Gr(Oe[je],Oe[je+1],te,ne,le,be));else for(let je=0;je<Oe.length;je++){const tt=[];for(let mt=0;mt<Oe[je].length;mt+=2)tt.push(Gr(Oe[je][mt],Oe[je][mt+1],te,ne,le,be));De.geometry.push(tt)}}return Pe.transformed=!0,Pe}function Gr(Pe,te,ne,le,be,De){return[Math.round(ne*(Pe*le-be)),Math.round(ne*(te*le-De))]}function Or(Pe,te,ne,le,be){const De=te===be.maxZoom?0:be.tolerance/((1<<te)*be.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:Pe.length,source:null,x:ne,y:le,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ye of Pe)Va(Oe,Ye,De,be);return Oe}function Va(Pe,te,ne,le){const be=te.geometry,De=te.type,Oe=[];if(Pe.minX=Math.min(Pe.minX,te.minX),Pe.minY=Math.min(Pe.minY,te.minY),Pe.maxX=Math.max(Pe.maxX,te.maxX),Pe.maxY=Math.max(Pe.maxY,te.maxY),De==="Point"||De==="MultiPoint")for(let Ye=0;Ye<be.length;Ye+=3)Oe.push(be[Ye],be[Ye+1]),Pe.numPoints++,Pe.numSimplified++;else if(De==="LineString")Ca(Oe,be,Pe,ne,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(let Ye=0;Ye<be.length;Ye++)Ca(Oe,be[Ye],Pe,ne,De==="Polygon",Ye===0);else if(De==="MultiPolygon")for(let Ye=0;Ye<be.length;Ye++){const je=be[Ye];for(let tt=0;tt<je.length;tt++)Ca(Oe,je[tt],Pe,ne,!0,tt===0)}if(Oe.length){let Ye=te.tags||null;if(De==="LineString"&&le.lineMetrics){Ye={};for(const tt in te.tags)Ye[tt]=te.tags[tt];Ye.mapbox_clip_start=be.start/be.size,Ye.mapbox_clip_end=be.end/be.size}const je={geometry:Oe,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:Ye};te.id!==null&&(je.id=te.id),Pe.features.push(je)}}function Ca(Pe,te,ne,le,be,De){const Oe=le*le;if(le>0&&te.size<(be?Oe:le))return void(ne.numPoints+=te.length/3);const Ye=[];for(let je=0;je<te.length;je+=3)(le===0||te[je+2]>Oe)&&(ne.numSimplified++,Ye.push(te[je],te[je+1])),ne.numPoints++;be&&function(je,tt){let mt=0;for(let ot=0,jt=je.length,Fe=jt-2;ot<jt;Fe=ot,ot+=2)mt+=(je[ot]-je[Fe])*(je[ot+1]+je[Fe+1]);if(mt>0===tt)for(let ot=0,jt=je.length;ot<jt/2;ot+=2){const Fe=je[ot],rn=je[ot+1];je[ot]=je[jt-2-ot],je[ot+1]=je[jt-1-ot],je[jt-2-ot]=Fe,je[jt-1-ot]=rn}}(Ye,De),Pe.push(Ye)}const Da={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ga{constructor(te,ne){const le=(ne=this.options=function(De,Oe){for(const Ye in Oe)De[Ye]=Oe[Ye];return De}(Object.create(Da),ne)).debug;if(le&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let be=function(De,Oe){const Ye=[];if(De.type==="FeatureCollection")for(let je=0;je<De.features.length;je++)pt(Ye,De.features[je],Oe,je);else pt(Ye,De.type==="Feature"?De:{geometry:De},Oe);return Ye}(te,ne);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),be=function(De,Oe){const Ye=Oe.buffer/Oe.extent;let je=De;const tt=Xn(De,1,-1-Ye,Ye,0,-1,2,Oe),mt=Xn(De,1,1-Ye,2+Ye,0,-1,2,Oe);return(tt||mt)&&(je=Xn(De,1,-Ye,1+Ye,0,-1,2,Oe)||[],tt&&(je=ki(tt,1).concat(je)),mt&&(je=je.concat(ki(mt,-1)))),je}(be,ne),be.length&&this.splitTile(be,0,0,0),le&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,ne,le,be,De,Oe,Ye){const je=[te,ne,le,be],tt=this.options,mt=tt.debug;for(;je.length;){be=je.pop(),le=je.pop(),ne=je.pop(),te=je.pop();const ot=1<<ne,jt=gn(ne,le,be);let Fe=this.tiles[jt];if(!Fe&&(mt>1&&console.time("creation"),Fe=this.tiles[jt]=Or(te,ne,le,be,tt),this.tileCoords.push({z:ne,x:le,y:be}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,le,be,Fe.numFeatures,Fe.numPoints,Fe.numSimplified),console.timeEnd("creation"));const Pi=`z${ne}`;this.stats[Pi]=(this.stats[Pi]||0)+1,this.total++}if(Fe.source=te,De==null){if(ne===tt.indexMaxZoom||Fe.numPoints<=tt.indexMaxPoints)continue}else{if(ne===tt.maxZoom||ne===De)continue;if(De!=null){const Pi=De-ne;if(le!==Oe>>Pi||be!==Ye>>Pi)continue}}if(Fe.source=null,te.length===0)continue;mt>1&&console.time("clipping");const rn=.5*tt.buffer/tt.extent,Sn=.5-rn,$t=.5+rn,cn=1+rn;let ci=null,fr=null,wr=null,di=null,Kt=Xn(te,ot,le-rn,le+$t,0,Fe.minX,Fe.maxX,tt),an=Xn(te,ot,le+Sn,le+cn,0,Fe.minX,Fe.maxX,tt);te=null,Kt&&(ci=Xn(Kt,ot,be-rn,be+$t,1,Fe.minY,Fe.maxY,tt),fr=Xn(Kt,ot,be+Sn,be+cn,1,Fe.minY,Fe.maxY,tt),Kt=null),an&&(wr=Xn(an,ot,be-rn,be+$t,1,Fe.minY,Fe.maxY,tt),di=Xn(an,ot,be+Sn,be+cn,1,Fe.minY,Fe.maxY,tt),an=null),mt>1&&console.timeEnd("clipping"),je.push(ci||[],ne+1,2*le,2*be),je.push(fr||[],ne+1,2*le,2*be+1),je.push(wr||[],ne+1,2*le+1,2*be),je.push(di||[],ne+1,2*le+1,2*be+1)}}getTile(te,ne,le){te=+te,ne=+ne,le=+le;const be=this.options,{extent:De,debug:Oe}=be;if(te<0||te>24)return null;const Ye=1<<te,je=gn(te,ne=ne+Ye&Ye-1,le);if(this.tiles[je])return _a(this.tiles[je],De);Oe>1&&console.log("drilling down to z%d-%d-%d",te,ne,le);let tt,mt=te,ot=ne,jt=le;for(;!tt&&mt>0;)mt--,ot>>=1,jt>>=1,tt=this.tiles[gn(mt,ot,jt)];return tt&&tt.source?(Oe>1&&(console.log("found parent tile z%d-%d-%d",mt,ot,jt),console.time("drilling down")),this.splitTile(tt.source,mt,ot,jt,te,ne,le),Oe>1&&console.timeEnd("drilling down"),this.tiles[je]?_a(this.tiles[je],De):null):null}}function gn(Pe,te,ne){return 32*((1<<Pe)*ne+te)+Pe}class ii extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(te,ne){return y._(this,void 0,void 0,function*(){const le=te.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const be=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!be)return null;const De=new Ee(be.features,{version:2,extent:y.$});let Oe=function(Ye){const je=new y.cM;return function(tt,mt){for(const ot in tt.layers)mt.writeMessage(3,we,tt.layers[ot])}(Ye,je),je.finish()}(De);return Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),{vectorTile:De,rawData:Oe.buffer}})}loadData(te){return y._(this,void 0,void 0,function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const le=!!(te&&te.request&&te.request.collectResourceTiming)&&new y.cN(te.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(te,this._pendingRequest);const be=yield this._pendingData;this._geoJSONIndex=te.cluster?new zt(function({superclusterOptions:Oe,clusterProperties:Ye}){if(!Ye||!Oe)return Oe;const je={},tt={},mt={accumulated:null,zoom:0},ot={properties:null},jt=Object.keys(Ye);for(const Fe of jt){const[rn,Sn]=Ye[Fe],$t=y.cT(Sn),cn=y.cT(typeof rn=="string"?[rn,["accumulated"],["get",Fe]]:rn);je[Fe]=$t.value,tt[Fe]=cn.value}return Oe.map=Fe=>{ot.properties=Fe;const rn={};for(const Sn of jt)rn[Sn]=je[Sn].evaluate(mt,ot);return rn},Oe.reduce=(Fe,rn)=>{ot.properties=rn;for(const Sn of jt)mt.accumulated=Fe[Sn],Fe[Sn]=tt[Sn].evaluate(mt,ot)},Oe}(te)).load(be.features):function(Oe,Ye){return new Ga(Oe,Ye)}(be,te.geojsonVtOptions),this.loaded={};const De={data:be};if(le){const Oe=le.finish();Oe&&(De.resourceTiming={},De.resourceTiming[te.source]=JSON.parse(JSON.stringify(Oe)))}return De}catch(be){if(delete this._pendingRequest,y.cy(be))return{abandoned:!0};throw be}})}getData(){return y._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(te){const ne=this.loaded;return ne&&ne[te.uid]?super.reloadTile(te):this.loadTile(te)}loadAndProcessGeoJSON(te,ne){return y._(this,void 0,void 0,function*(){let le=yield this.loadGeoJSON(te,ne);if(delete this._pendingRequest,typeof le!="object")throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(ie(le,!0),te.filter){const be=y.cT(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(be.result==="error")throw new Error(be.value.map(Oe=>`${Oe.key}: ${Oe.message}`).join(", "));le={type:"FeatureCollection",features:le.features.filter(Oe=>be.value.evaluate({zoom:0},Oe))}}return le})}loadGeoJSON(te,ne){return y._(this,void 0,void 0,function*(){const{promoteId:le}=te;if(te.request){const be=yield y.j(te.request,ne);return this._dataUpdateable=y.cV(be.data,le)?y.cU(be.data,le):void 0,be.data}if(typeof te.data=="string")try{const be=JSON.parse(te.data);return this._dataUpdateable=y.cV(be,le)?y.cU(be,le):void 0,be}catch{throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`)}if(!te.dataDiff)throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${te.source}`);return y.cW(this._dataUpdateable,te.dataDiff,le),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(te){return y._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(te){return this._geoJSONIndex.getClusterExpansionZoom(te.clusterId)}getClusterChildren(te){return this._geoJSONIndex.getChildren(te.clusterId)}getClusterLeaves(te){return this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset)}}class xr{constructor(te){this.self=te,this.actor=new y.J(te),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ne,le)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=le},this.self.addProtocol=y.cA,this.self.removeProtocol=y.cB,this.self.registerRTLTextPlugin=ne=>{y.cX.setMethods(ne)},this.actor.registerMessageHandler("LDT",(ne,le)=>this._getDEMWorkerSource(ne,le.source).loadTile(le)),this.actor.registerMessageHandler("RDT",(ne,le)=>y._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,le.source).removeTile(le)})),this.actor.registerMessageHandler("GCEZ",(ne,le)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,le.type,le.source).getClusterExpansionZoom(le)})),this.actor.registerMessageHandler("GCC",(ne,le)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,le.type,le.source).getClusterChildren(le)})),this.actor.registerMessageHandler("GCL",(ne,le)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,le.type,le.source).getClusterLeaves(le)})),this.actor.registerMessageHandler("LD",(ne,le)=>this._getWorkerSource(ne,le.type,le.source).loadData(le)),this.actor.registerMessageHandler("GD",(ne,le)=>this._getWorkerSource(ne,le.type,le.source).getData()),this.actor.registerMessageHandler("LT",(ne,le)=>this._getWorkerSource(ne,le.type,le.source).loadTile(le)),this.actor.registerMessageHandler("RT",(ne,le)=>this._getWorkerSource(ne,le.type,le.source).reloadTile(le)),this.actor.registerMessageHandler("AT",(ne,le)=>this._getWorkerSource(ne,le.type,le.source).abortTile(le)),this.actor.registerMessageHandler("RMT",(ne,le)=>this._getWorkerSource(ne,le.type,le.source).removeTile(le)),this.actor.registerMessageHandler("RS",(ne,le)=>y._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][le.type]||!this.workerSources[ne][le.type][le.source])return;const be=this.workerSources[ne][le.type][le.source];delete this.workerSources[ne][le.type][le.source],be.removeSource!==void 0&&be.removeSource(le)})),this.actor.registerMessageHandler("RM",ne=>y._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],this.globalStates.delete(ne)})),this.actor.registerMessageHandler("SR",(ne,le)=>y._(this,void 0,void 0,function*(){this.referrer=le})),this.actor.registerMessageHandler("SRPS",(ne,le)=>this._syncRTLPluginState(ne,le)),this.actor.registerMessageHandler("IS",(ne,le)=>y._(this,void 0,void 0,function*(){this.self.importScripts(le)})),this.actor.registerMessageHandler("SI",(ne,le)=>this._setImages(ne,le)),this.actor.registerMessageHandler("UL",(ne,le)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(le.layers,le.removedIds,this._getGlobalState(ne))})),this.actor.registerMessageHandler("UGS",(ne,le)=>y._(this,void 0,void 0,function*(){const be=this._getGlobalState(ne);for(const De in le)be[De]=le[De]})),this.actor.registerMessageHandler("SL",(ne,le)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(le,this._getGlobalState(ne))}))}_getGlobalState(te){let ne=this.globalStates.get(te);return ne||(ne={},this.globalStates.set(te,ne)),ne}_setImages(te,ne){return y._(this,void 0,void 0,function*(){this.availableImages[te]=ne;for(const le in this.workerSources[te]){const be=this.workerSources[te][le];for(const De in be)be[De].availableImages=ne}})}_syncRTLPluginState(te,ne){return y._(this,void 0,void 0,function*(){return yield y.cX.syncState(ne,this.self.importScripts)})}_getAvailableImages(te){let ne=this.availableImages[te];return ne||(ne=[]),ne}_getLayerIndex(te){let ne=this.layerIndexes[te];return ne||(ne=this.layerIndexes[te]=new l),ne}_getWorkerSource(te,ne,le){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][ne]||(this.workerSources[te][ne]={}),!this.workerSources[te][ne][le]){const be={sendAsync:(De,Oe)=>(De.targetMapId=te,this.actor.sendAsync(De,Oe))};switch(ne){case"vector":this.workerSources[te][ne][le]=new N(be,this._getLayerIndex(te),this._getAvailableImages(te));break;case"geojson":this.workerSources[te][ne][le]=new ii(be,this._getLayerIndex(te),this._getAvailableImages(te));break;default:this.workerSources[te][ne][le]=new this.externalWorkerSourceTypes[ne](be,this._getLayerIndex(te),this._getAvailableImages(te))}}return this.workerSources[te][ne][le]}_getDEMWorkerSource(te,ne){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][ne]||(this.demWorkerSources[te][ne]=new F),this.demWorkerSources[te][ne]}}return y.i(self)&&(self.worker=new xr(self)),xr}),d("index",["exports","./shared"],function(y,l){var E="5.7.2";function C(){var b=new l.A(4);return l.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let k,N;const F={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,t,c){const p=requestAnimationFrame(T=>{v(),t(T)}),{unsubscribe:v}=l.s(b.signal,"abort",()=>{v(),cancelAnimationFrame(p),c(l.c())},!1)},frameAsync(b){return new Promise((t,c)=>{this.frame(b,t,c)})},getImageData(b,t=0){return this.getImageCanvasContext(b).getImageData(-t,-t,b.width+2*t,b.height+2*t)},getImageCanvasContext(b){const t=window.document.createElement("canvas"),c=t.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return t.width=b.width,t.height=b.height,c.drawImage(b,0,0,b.width,b.height),c},resolveURL:b=>(k||(k=document.createElement("a")),k.href=b,k.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(N==null&&(N=matchMedia("(prefers-reduced-motion: reduce)")),N.matches)}};class B{static testProp(t){if(!B.docStyle)return t[0];for(let c=0;c<t.length;c++)if(t[c]in B.docStyle)return t[c];return t[0]}static create(t,c,p){const v=window.document.createElement(t);return c!==void 0&&(v.className=c),p&&p.appendChild(v),v}static createNS(t,c){return window.document.createElementNS(t,c)}static disableDrag(){B.docStyle&&B.selectProp&&(B.userSelect=B.docStyle[B.selectProp],B.docStyle[B.selectProp]="none")}static enableDrag(){B.docStyle&&B.selectProp&&(B.docStyle[B.selectProp]=B.userSelect)}static setTransform(t,c){t.style[B.transformProp]=c}static addEventListener(t,c,p,v={}){t.addEventListener(c,p,"passive"in v?v:v.capture)}static removeEventListener(t,c,p,v={}){t.removeEventListener(c,p,"passive"in v?v:v.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",B.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",B.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",B.suppressClickInternal,!0)},0)}static getScale(t){const c=t.getBoundingClientRect();return{x:c.width/t.offsetWidth||1,y:c.height/t.offsetHeight||1,boundingClientRect:c}}static getPoint(t,c,p){const v=c.boundingClientRect;return new l.P((p.clientX-v.left)/c.x-t.clientLeft,(p.clientY-v.top)/c.y-t.clientTop)}static mousePos(t,c){const p=B.getScale(t);return B.getPoint(t,p,c)}static touchPos(t,c){const p=[],v=B.getScale(t);for(let T=0;T<c.length;T++)p.push(B.getPoint(t,v,c[T]));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const c=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),p=c.querySelectorAll("script");for(const v of p)v.remove();return B.clean(c),c.innerHTML}static isPossiblyDangerous(t,c){const p=c.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!p.includes("javascript:")&&!p.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const c=t.children;for(const p of c)B.removeAttributes(p),B.clean(p)}static removeAttributes(t){for(const{name:c,value:p}of t.attributes)B.isPossiblyDangerous(c,p)&&t.removeAttribute(c)}}B.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,B.selectProp=B.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),B.transformProp=B.testProp(["transform","WebkitTransform"]);const W={supported:!1,testSupport:function(b){!de&&ie&&(Ee?we(b):re=b)}};let re,ie,de=!1,Ee=!1;function we(b){const t=b.createTexture();b.bindTexture(b.TEXTURE_2D,t);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,ie),b.isContextLost())return;W.supported=!0}catch{}b.deleteTexture(t),de=!0}var ke;typeof document<"u"&&(ie=document.createElement("img"),ie.onload=()=>{re&&we(re),re=null,Ee=!0},ie.onerror=()=>{de=!0,re=null},ie.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let t,c,p,v;b.resetRequestQueue=()=>{t=[],c=0,p=0,v={}},b.addThrottleControl=P=>{const j=p++;return v[j]=P,j},b.removeThrottleControl=P=>{delete v[P],M()},b.getImage=(P,j,U=!0)=>new Promise(($,G)=>{W.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),l.e(P,{type:"image"}),t.push({abortController:j,requestParameters:P,supportImageRefresh:U,state:"queued",onError:Y=>{G(Y)},onSuccess:Y=>{$(Y)}}),M()});const T=P=>l._(this,void 0,void 0,function*(){P.state="running";const{requestParameters:j,supportImageRefresh:U,onError:$,onSuccess:G,abortController:Y}=P,ee=U===!1&&!l.i(self)&&!l.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce((fe,pe)=>fe&&pe==="accept",!0));c++;const he=ee?R(j,Y):l.m(j,Y);try{const fe=yield he;delete P.abortController,P.state="completed",fe.data instanceof HTMLImageElement||l.b(fe.data)?G(fe):fe.data&&G({data:yield(ue=fe.data,typeof createImageBitmap=="function"?l.f(ue):l.h(ue)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete P.abortController,$(fe)}finally{c--,M()}var ue}),M=()=>{const P=(()=>{for(const j of Object.keys(v))if(v[j]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=c;j<P&&t.length>0;j++){const U=t.shift();U.abortController.signal.aborted?j--:T(U)}},R=(P,j)=>new Promise((U,$)=>{const G=new Image,Y=P.url,ee=P.credentials;ee&&ee==="include"?G.crossOrigin="use-credentials":(ee&&ee==="same-origin"||!l.d(Y))&&(G.crossOrigin="anonymous"),j.signal.addEventListener("abort",()=>{G.src="",$(l.c())}),G.fetchPriority="high",G.onload=()=>{G.onerror=G.onload=null,U({data:G})},G.onerror=()=>{G.onerror=G.onload=null,j.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},G.src=Y})}(ke||(ke={})),ke.resetRequestQueue();class ge{constructor(t){this._transformRequestFn=t??null}transformRequest(t,c){return this._transformRequestFn&&this._transformRequestFn(t,c)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ae(b){const t=[];if(typeof b=="string")t.push({id:"default",url:b});else if(b&&b.length>0){const c=[];for(const{id:p,url:v}of b){const T=`${p}${v}`;c.indexOf(T)===-1&&(c.push(T),t.push({id:p,url:v}))}}return t}function Ge(b,t,c){try{const p=new URL(b);return p.pathname+=`${t}${c}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function at(b){const{userImage:t}=b;return!!(t&&t.render&&t.render())&&(b.data.replace(new Uint8Array(t.data.buffer)),!0)}class Me extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:c,promiseResolve:p}of this.requestors)p(this._getImagesForIds(c));this.requestors=[]}}getImage(t){const c=this.images[t];if(c&&!c.data&&c.spriteData){const p=c.spriteData;c.data=new l.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),c.spriteData=null}return c}addImage(t,c){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,c)&&(this.images[t]=c)}_validate(t,c){let p=!0;const v=c.data||c.spriteData;return this._validateStretch(c.stretchX,v&&v.width)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,v&&v.height)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "content" value`))),p=!1),p}_validateStretch(t,c){if(!t)return!0;let p=0;for(const v of t){if(v[0]<p||v[1]<v[0]||c<v[1])return!1;p=v[1]}return!0}_validateContent(t,c){if(!t)return!0;if(t.length!==4)return!1;const p=c.spriteData,v=p&&p.width||c.data.width,T=p&&p.height||c.data.height;return!(t[0]<0||v<t[0]||t[1]<0||T<t[1]||t[2]<0||v<t[2]||t[3]<0||T<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,c,p=!0){const v=this.getImage(t);if(p&&(v.data.width!==c.data.width||v.data.height!==c.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=v.version+1,this.images[t]=c,this.updatedImages[t]=!0}removeImage(t){const c=this.images[t];delete this.images[t],delete this.patterns[t],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((c,p)=>{let v=!0;if(!this.isLoaded())for(const T of t)this.images[T]||(v=!1);this.isLoaded()||v?c(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:c})})}_getImagesForIds(t){const c={};for(const p of t){let v=this.getImage(p);v||(this.fire(new l.l("styleimagemissing",{id:p})),v=this.getImage(p)),v?c[p]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:l.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return c}getPixelSize(){const{width:t,height:c}=this.atlasImage;return{width:t,height:c}}getPattern(t){const c=this.patterns[t],p=this.getImage(t);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const v={w:p.data.width+2,h:p.data.height+2,x:0,y:0},T=new l.I(v,p);this.patterns[t]={bin:v,position:T}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const c=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(t,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const T in this.patterns)t.push(this.patterns[T].bin);const{w:c,h:p}=l.p(t),v=this.atlasImage;v.resize({width:c||1,height:p||1});for(const T in this.patterns){const{bin:M}=this.patterns[T],R=M.x+1,P=M.y+1,j=this.getImage(T).data,U=j.width,$=j.height;l.R.copy(j,v,{x:0,y:0},{x:R,y:P},{width:U,height:$}),l.R.copy(j,v,{x:0,y:$-1},{x:R,y:P-1},{width:U,height:1}),l.R.copy(j,v,{x:0,y:0},{x:R,y:P+$},{width:U,height:1}),l.R.copy(j,v,{x:U-1,y:0},{x:R-1,y:P},{width:1,height:$}),l.R.copy(j,v,{x:0,y:0},{x:R+U,y:P},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const c of t){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.getImage(c);p||l.w(`Image with ID: "${c}" was not found`),at(p)&&this.updateImage(c,p)}}}const Qe=1e20;function St(b,t,c,p,v,T,M,R,P){for(let j=t;j<t+p;j++)bt(b,c*T+j,T,v,M,R,P);for(let j=c;j<c+v;j++)bt(b,j*T+t,1,p,M,R,P)}function bt(b,t,c,p,v,T,M){T[0]=0,M[0]=-Qe,M[1]=Qe,v[0]=b[t];for(let R=1,P=0,j=0;R<p;R++){v[R]=b[t+R*c];const U=R*R;do{const $=T[P];j=(v[R]-v[$]+U-$*$)/(R-$)/2}while(j<=M[P]&&--P>-1);P++,T[P]=R,M[P]=j,M[P+1]=Qe}for(let R=0,P=0;R<p;R++){for(;M[P+1]<R;)P++;const j=T[P],U=R-j;b[t+R*c]=v[j]+U*U}}class zt{constructor(t,c,p){this.requestManager=t,this.localIdeographFontFamily=c,this.entries={},this.lang=p}setURL(t){this.url=t}getGlyphs(t){return l._(this,void 0,void 0,function*(){const c=[];for(const T in t)for(const M of t[T])c.push(this._getAndCacheGlyphsPromise(T,M));const p=yield Promise.all(c),v={};for(const{stack:T,id:M,glyph:R}of p)v[T]||(v[T]={}),v[T][M]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return v})}_getAndCacheGlyphsPromise(t,c){return l._(this,void 0,void 0,function*(){let p=this.entries[t];p||(p=this.entries[t]={glyphs:{},requests:{},ranges:{}});let v=p.glyphs[c];if(v!==void 0)return{stack:t,id:c,glyph:v};if(v=this._tinySDF(p,t,c),v)return p.glyphs[c]=v,{stack:t,id:c,glyph:v};const T=Math.floor(c/256);if(256*T>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[T])return{stack:t,id:c,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[T]){const R=zt.loadGlyphRange(t,T,this.url,this.requestManager);p.requests[T]=R}const M=yield p.requests[T];for(const R in M)this._doesCharSupportLocalGlyph(+R)||(p.glyphs[+R]=M[+R]);return p.ranges[T]=!0,{stack:t,id:c,glyph:M[c]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||l.u["CJK Unified Ideographs"](t)||l.u["Hangul Syllables"](t)||l.u.Hiragana(t)||l.u.Katakana(t)||l.u["CJK Symbols and Punctuation"](t)||l.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,c,p){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let T=t.tinySDF;if(!T){let R="400";/bold/i.test(c)?R="900":/medium/i.test(c)?R="500":/light/i.test(c)&&(R="200"),T=t.tinySDF=new zt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:v,fontWeight:R})}const M=T.draw(String.fromCharCode(p));return{id:p,bitmap:new l.q({width:M.width||60,height:M.height||60},M.data),metrics:{width:M.glyphWidth/2||24,height:M.glyphHeight/2||24,left:M.glyphLeft/2+.5||0,top:M.glyphTop/2-27.5||-8,advance:M.glyphAdvance/2||24,isDoubleResolution:!0}}}}zt.loadGlyphRange=function(b,t,c,p){return l._(this,void 0,void 0,function*(){const v=256*t,T=v+255,M=p.transformRequest(c.replace("{fontstack}",b).replace("{range}",`${v}-${T}`),"Glyphs"),R=yield l.n(M,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${t}, ${v}-${T}`);const P={};for(const j of l.o(R.data))P[j.id]=j;return P})},zt.TinySDF=class{constructor({fontSize:b=24,buffer:t=3,radius:c=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:T="normal",fontStyle:M="normal",lang:R=null}={}){this.buffer=t,this.cutoff=p,this.radius=c,this.lang=R;const P=this.size=b+4*t,j=this._createCanvas(P),U=this.ctx=j.getContext("2d",{willReadFrequently:!0});U.font=`${M} ${T} ${b}px ${v}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(b){const t=document.createElement("canvas");return t.width=t.height=b,t}draw(b){const{width:t,actualBoundingBoxAscent:c,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:T}=this.ctx.measureText(b),M=Math.ceil(c),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-v))),P=Math.min(this.size-this.buffer,M+Math.ceil(p)),j=R+2*this.buffer,U=P+2*this.buffer,$=Math.max(j*U,0),G=new Uint8ClampedArray($),Y={data:G,width:j,height:U,glyphWidth:R,glyphHeight:P,glyphTop:M,glyphLeft:0,glyphAdvance:t};if(R===0||P===0)return Y;const{ctx:ee,buffer:he,gridInner:ue,gridOuter:fe}=this;this.lang&&(ee.lang=this.lang),ee.clearRect(he,he,R,P),ee.fillText(b,he,he+M);const pe=ee.getImageData(he,he,R,P);fe.fill(Qe,0,$),ue.fill(0,0,$);for(let ve=0;ve<P;ve++)for(let ye=0;ye<R;ye++){const Se=pe.data[4*(ve*R+ye)+3]/255;if(Se===0)continue;const Re=(ve+he)*j+ye+he;if(Se===1)fe[Re]=0,ue[Re]=Qe;else{const _e=.5-Se;fe[Re]=_e>0?_e*_e:0,ue[Re]=_e<0?_e*_e:0}}St(fe,0,0,j,U,j,this.f,this.v,this.z),St(ue,he,he,R,P,j,this.f,this.v,this.z);for(let ve=0;ve<$;ve++){const ye=Math.sqrt(fe[ve])-Math.sqrt(ue[ve]);G[ve]=Math.round(255-255*(ye/this.radius+this.cutoff))}return Y}};class Zt{constructor(){this.specification=l.v.light.position}possiblyEvaluate(t,c){return l.B(t.expression.evaluate(c))}interpolate(t,c,p){return{x:l.C.number(t.x,c.x,p),y:l.C.number(t.y,c.y,p),z:l.C.number(t.z,c.z,p)}}}let Ft;class Be extends l.E{constructor(t){super(),Ft=Ft||new l.r({anchor:new l.D(l.v.light.anchor),position:new Zt,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.t(Ft,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,c={}){if(!this._validate(l.x,t,c))for(const p in t){const v=t[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),v):this._transitionable.setValue(p,v)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,c,p){return(!p||p.validate!==!1)&&l.y(this,t.call(l.z,{value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const lt=new l.r({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class _t extends l.E{constructor(t){super(),this._transitionable=new l.t(lt,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0))}setSky(t,c={}){if(!this._validate(l.G,t,c)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in t){const v=t[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),v):this._transitionable.setValue(p,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,c,p={}){return p?.validate!==!1&&l.y(this,t.call(l.z,l.e({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class ut{constructor(t,c){this.width=t,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,c){const p=t.join(",")+String(c);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(t,c)),this.dashEntry[p]}getDashRanges(t,c,p){const v=[];let T=t.length%2==1?-t[t.length-1]*p:0,M=t[0]*p,R=!0;v.push({left:T,right:M,isDash:R,zeroLength:t[0]===0});let P=t[0];for(let j=1;j<t.length;j++){R=!R;const U=t[j];T=P*p,P+=U,M=P*p,v.push({left:T,right:M,isDash:R,zeroLength:U===0})}return v}addRoundDash(t,c,p){const v=c/2;for(let T=-p;T<=p;T++){const M=this.width*(this.nextRow+p+T);let R=0,P=t[R];for(let j=0;j<this.width;j++){j/P.right>1&&(P=t[++R]);const U=Math.abs(j-P.left),$=Math.abs(j-P.right),G=Math.min(U,$);let Y;const ee=T/p*(v+1);if(P.isDash){const he=v-Math.abs(ee);Y=Math.sqrt(G*G+he*he)}else Y=v-Math.sqrt(G*G+ee*ee);this.data[M+j]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(t){for(let R=t.length-1;R>=0;--R){const P=t[R],j=t[R+1];P.zeroLength?t.splice(R,1):j&&j.isDash===P.isDash&&(j.left=P.left,t.splice(R,1))}const c=t[0],p=t[t.length-1];c.isDash===p.isDash&&(c.left=p.left-this.width,p.right=c.right+this.width);const v=this.width*this.nextRow;let T=0,M=t[T];for(let R=0;R<this.width;R++){R/M.right>1&&(M=t[++T]);const P=Math.abs(R-M.left),j=Math.abs(R-M.right),U=Math.min(P,j);this.data[v+R]=Math.max(0,Math.min(255,(M.isDash?U:-U)+128))}}addDash(t,c){const p=c?7:0,v=2*p+1;if(this.nextRow+v>this.height)return l.w("LineAtlas out of space"),null;let T=0;for(let R=0;R<t.length;R++)T+=t[R];if(T!==0){const R=this.width/T,P=this.getDashRanges(t,this.width,R);c?this.addRoundDash(P,R,p):this.addRegularDash(P)}const M={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:T};return this.nextRow+=v,this.dirty=!0,M}bind(t){const c=t.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}const Te="maplibre_preloaded_worker_pool";class nt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<nt.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Te]}numActive(){return Object.keys(this.active).length}}const yt=Math.floor(F.hardwareConcurrency/2);let pt,Et;function Ut(){return pt||(pt=new nt),pt}nt.workerCount=l.H(globalThis)?Math.max(Math.min(yt,3),1):1;class Ot{constructor(t,c){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c;const p=this.workerPool.acquire(c);for(let v=0;v<p.length;v++){const T=new l.J(p[v],c);T.name=`Worker ${v}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,c){const p=[];for(const v of this.actors)p.push(v.sendAsync({type:t,data:c}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,c){for(const p of this.actors)p.registerMessageHandler(t,c)}}function Ln(){return Et||(Et=new Ot(Ut(),l.K),Et.registerMessageHandler("GR",(b,t,c)=>l.m(t,c))),Et}function Wt(b,t){const c=l.L();return l.M(c,c,[1,1,0]),l.N(c,c,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?l.O(c,c,b.calculatePosMatrix(t.toUnwrapped())):c}function Xn(b,t,c,p,v,T,M){var R;const P=function(G,Y,ee){if(G)for(const he of G){const ue=Y[he];if(ue&&ue.source===ee&&ue.type==="fill-extrusion")return!0}else for(const he in Y){const ue=Y[he];if(ue.source===ee&&ue.type==="fill-extrusion")return!0}return!1}((R=v?.layers)!==null&&R!==void 0?R:null,t,b.id),j=T.maxPitchScaleFactor(),U=b.tilesIn(p,j,P);U.sort(br);const $=[];for(const G of U)$.push({wrappedTileID:G.tileID.wrapped().key,queryResults:G.tile.queryRenderedFeatures(t,c,b._state,G.queryGeometry,G.cameraQueryGeometry,G.scale,v,T,j,Wt(b.transform,G.tileID),M?(Y,ee)=>M(G.tileID,Y,ee):void 0)});return function(G,Y){for(const ee in G)for(const he of G[ee])ir(he,Y);return G}(function(G){const Y={},ee={};for(const he of G){const ue=he.queryResults,fe=he.wrappedTileID,pe=ee[fe]=ee[fe]||{};for(const ve in ue){const ye=ue[ve],Se=pe[ve]=pe[ve]||{},Re=Y[ve]=Y[ve]||[];for(const _e of ye)Se[_e.featureIndex]||(Se[_e.featureIndex]=!0,Re.push(_e))}}return Y}($),b)}function br(b,t){const c=b.tileID,p=t.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function ir(b,t){const c=b.feature,p=t.getFeatureState(c.layer["source-layer"],c.id);c.source=c.layer.source,c.layer["source-layer"]&&(c.sourceLayer=c.layer["source-layer"]),c.state=p}function yi(b,t,c){return l._(this,void 0,void 0,function*(){let p=b;if(b.url?p=(yield l.j(t.transformRequest(b.url,"Source"),c)).data:yield F.frameAsync(c),!p)return null;const v=l.Q(l.e(p,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(v.vectorLayerIds=p.vector_layers.map(T=>T.id)),v})}class Un{constructor(t,c){t&&(c?this.setSouthWest(t).setNorthEast(c):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.S?new l.S(t.lng,t.lat):l.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.S?new l.S(t.lng,t.lat):l.S.convert(t),this}extend(t){const c=this._sw,p=this._ne;let v,T;if(t instanceof l.S)v=t,T=t;else{if(!(t instanceof Un))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Un.convert(t)):this.extend(l.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.S.convert(t)):this;if(v=t._sw,T=t._ne,!v||!T)return this}return c||p?(c.lng=Math.min(v.lng,c.lng),c.lat=Math.min(v.lat,c.lat),p.lng=Math.max(T.lng,p.lng),p.lat=Math.max(T.lat,p.lat)):(this._sw=new l.S(v.lng,v.lat),this._ne=new l.S(T.lng,T.lat)),this}getCenter(){return new l.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.S(this.getWest(),this.getNorth())}getSouthEast(){return new l.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:c,lat:p}=l.S.convert(t);let v=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(t){return t instanceof Un?t:t&&new Un(t)}static fromLngLat(t,c=0){const p=360*c/40075017,v=p/Math.cos(Math.PI/180*t.lat);return new Un(new l.S(t.lng-v,t.lat-p),new l.S(t.lng+v,t.lat+p))}adjustAntiMeridian(){const t=new l.S(this._sw.lng,this._sw.lat),c=new l.S(this._ne.lng,this._ne.lat);return new Un(t,t.lng>c.lng?new l.S(c.lng+360,c.lat):c)}}class Vn{constructor(t,c,p){this.bounds=Un.convert(this.validateBounds(t)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const c=Math.pow(2,t.z),p=Math.floor(l.V(this.bounds.getWest())*c),v=Math.floor(l.U(this.bounds.getNorth())*c),T=Math.ceil(l.V(this.bounds.getEast())*c),M=Math.ceil(l.U(this.bounds.getSouth())*c);return t.x>=p&&t.x<T&&t.y>=v&&t.y<M}}class Dn extends l.E{constructor(t,c,p,v){if(super(),this.id=t,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.Q(c,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield yi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(l.e(this,t),t.bounds&&(this.tileBounds=new Vn(t.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,this.fire(new l.k(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(t){return l._(this,void 0,void 0,function*(){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};p.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((T,M)=>{t.reloadPromise={resolve:T,reject:M}})}else t.actor=this.dispatcher.getActor(),v="LT";t.abortController=new AbortController;try{const T=yield t.actor.sendAsync({type:v,data:p},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,T)}catch(T){if(delete t.abortController,t.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,c){if(c&&c.resourceTiming&&(t.resourceTiming=c.resourceTiming),c&&this.map._refreshExpiredTiles&&t.setExpiryData(c),t.loadVectorData(c,this.map.painter),t.reloadPromise){const p=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(p.resolve).catch(p.reject)}}abortTile(t){return l._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return l._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Pr extends l.E{constructor(t,c,p,v){super(),this.id=t,this.dispatcher=p,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},c),l.e(this,l.Q(c,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const c=yield yi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,c&&(l.e(this,c),c.bounds&&(this.tileBounds=new Vn(c.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(c){this._tileJSONRequest=null,this._loaded=!0,this.fire(new l.k(c))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return l._(this,void 0,void 0,function*(){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const p=yield ke.getImage(this.map._requestManager.transformRequest(c,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&t.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const v=this.map.painter.context,T=v.gl,M=p.data;t.texture=this.map.painter.getTileTexture(M.width),t.texture?t.texture.update(M,{useMipmap:!0}):(t.texture=new l.T(v,M,T.RGBA,{useMipmap:!0}),t.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(p){if(delete t.abortController,t.aborted)t.state="unloaded";else if(p)throw t.state="errored",p}})}abortTile(t){return l._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return l._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class ki extends Pr{constructor(t,c,p,v){super(t,c,p,v),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox",this.redFactor=c.redFactor,this.greenFactor=c.greenFactor,this.blueFactor=c.blueFactor,this.baseShift=c.baseShift}loadTile(t){return l._(this,void 0,void 0,function*(){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(c,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const v=yield ke.getImage(p,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(v&&v.data){const T=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&t.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const M=l.b(T)&&l.W()?T:yield this.readImageNow(T),R={type:this.type,uid:t.uid,source:this.id,rawImageData:M,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const P=yield t.actor.sendAsync({type:"LDT",data:R});t.dem=P,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(v){if(delete t.abortController,t.aborted)t.state="unloaded";else if(v)throw t.state="errored",v}})}readImageNow(t){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.X()){const c=t.width+2,p=t.height+2;try{return new l.R({width:c,height:p},yield l.Y(t,-1,-1,c,p))}catch{}}return F.getImageData(t,1)})}_getNeighboringTiles(t){const c=t.canonical,p=Math.pow(2,c.z),v=(c.x-1+p)%p,T=c.x===0?t.wrap-1:t.wrap,M=(c.x+1+p)%p,R=c.x+1===p?t.wrap+1:t.wrap,P={};return P[new l.Z(t.overscaledZ,T,c.z,v,c.y).key]={backfilled:!1},P[new l.Z(t.overscaledZ,R,c.z,M,c.y).key]={backfilled:!1},c.y>0&&(P[new l.Z(t.overscaledZ,T,c.z,v,c.y-1).key]={backfilled:!1},P[new l.Z(t.overscaledZ,t.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},P[new l.Z(t.overscaledZ,R,c.z,M,c.y-1).key]={backfilled:!1}),c.y+1<p&&(P[new l.Z(t.overscaledZ,T,c.z,v,c.y+1).key]={backfilled:!1},P[new l.Z(t.overscaledZ,t.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},P[new l.Z(t.overscaledZ,R,c.z,M,c.y+1).key]={backfilled:!1}),P}unloadTile(t){return l._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Aa extends l.E{constructor(t,c,p,v){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:c.data},this.actor=p.getActor(),this.setEventedParent(v),this._data=c.data,this._options=l.e({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId,c.clusterMaxZoom!==void 0&&this.maxzoom<=c.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${c.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(c.buffer!==void 0?c.buffer:128),tolerance:this._pixelsToTileUnits(c.tolerance!==void 0?c.tolerance:.375),extent:l.$,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(c.clusterMaxZoom),minPoints:Math.max(2,c.clusterMinPoints||2),extent:l.$,radius:this._pixelsToTileUnits(c.clusterRadius||50),log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(l.$/this.tileSize)}_getClusterMaxZoom(t){const c=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${c}"`),c}load(){return l._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=l.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return l._(this,void 0,void 0,function*(){const t=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map(c=>c.coordinates).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return l._(this,void 0,void 0,function*(){const t=new Un,c=yield this.getData();let p;switch(c.type){case"FeatureCollection":p=c.features.map(v=>this.getCoordinatesFromGeometry(v.geometry)).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(c.geometry);break;default:p=this.getCoordinatesFromGeometry(c)}if(p.length==0)return t;for(let v=0;v<p.length-1;v+=2)t.extend([p[v],p[v+1]]);return t})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,c,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:c,offset:p}})}_updateWorkerData(){return l._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:t,diff:c}=this._pendingWorkerUpdate;if(!t&&!c)return void l.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const p=l.e({type:this.type},this.workerOptions);t?(typeof t=="string"?(p.request=this.map._requestManager.transformRequest(F.resolveURL(t),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):c&&(p.dataDiff=c,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new l.l("dataloading",{dataType:"source"}));try{const v=yield this.actor.sendAsync({type:"LD",data:p});if(this._isUpdatingWorker=!1,this._removed||v.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));this._data=v.data;let T=null;v.resourceTiming&&v.resourceTiming[this.id]&&(T=v.resourceTiming[this.id].slice(0));const M={dataType:"source"};this._collectResourceTiming&&T&&T.length>0&&l.e(M,{resourceTiming:T}),this.fire(new l.l("data",Object.assign(Object.assign({},M),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},M),{sourceDataType:"content"})))}catch(v){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(v))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(t){return l._(this,void 0,void 0,function*(){const c=t.actor?"RT":"LT";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const v=yield this.actor.sendAsync({type:c,data:p},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(v,this.map.painter,c==="RT")})}abortTile(t){return l._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return l._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class _a extends l.E{constructor(t,c,p,v){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=c}load(t){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const c=yield ke.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,c&&c.data&&(this.image=c.data,t&&(this.coordinates=t),this._finishLoading())}catch(c){this._request=null,this._loaded=!0,this.fire(new l.k(c))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const c=t.map(l.a1.fromLngLat);var p;return this.tileID=function(v){const T=l.a2.fromPoints(v),M=T.width(),R=T.height(),P=Math.max(M,R),j=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),U=Math.pow(2,j);return new l.a4(j,Math.floor((T.minX+T.maxX)/2*U),Math.floor((T.minY+T.maxY)/2*U))}(c),this.terrainTileRanges=this._getOverlappingTileRanges(c),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=c.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,c=t.gl;this.texture||(this.texture=new l.T(t,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let p=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,p=!0)}p&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return l._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:c,minY:p,maxX:v,maxY:T}=l.a2.fromPoints(t),M={};for(let R=0;R<=l.a3;R++){const P=Math.pow(2,R),j=Math.floor(c*P),U=Math.floor(p*P),$=Math.floor(v*P),G=Math.floor(T*P);M[R]={minTileX:j,minTileY:U,maxTileX:$,maxTileY:G}}return M}}class Gr extends _a{constructor(t,c,p,v){super(t,c,p,v),this.roundZoom=!0,this.type="video",this.options=c}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const c of t.urls)this.urls.push(this.map._requestManager.transformRequest(c,"Source").url);try{const c=yield l.a5(this.urls);if(this._loaded=!0,!c)return;this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(c){this.fire(new l.k(c))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const c=this.video.seekable;t<c.start(0)||t>c.end(0)?this.fire(new l.k(new l.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,c=t.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(t,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let p=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,p=!0)}p&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Or extends _a{constructor(t,c,p,v){super(t,c,p,v),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(T=>!Array.isArray(T)||T.length!==2||T.some(M=>typeof M!="number"))||this.fire(new l.k(new l.a6(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.a6(`sources.${t}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new l.k(new l.a6(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.a6(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.a6(`sources.${t}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){return l._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context,p=c.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.T(c,this.canvas,p.RGBA,{premultiply:!0});let v=!1;for(const T in this.tiles){const M=this.tiles[T];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,v=!0)}v&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Va={},Ca=b=>{switch(b){case"geojson":return Aa;case"image":return _a;case"raster":return Pr;case"raster-dem":return ki;case"vector":return Dn;case"video":return Gr;case"canvas":return Or}return Va[b]},Da="RTLPluginLoaded";class Ga extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ln()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(c=>{throw this.status="error",c})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return l._(this,arguments,void 0,function*(c,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=F.resolveURL(c),!this.url)throw new Error(`requested url ${c} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return l._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(Da))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let gn=null;function ii(){return gn||(gn=new Ga),gn}class xr{constructor(t,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=l.a7(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const c=t+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,c,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(v,T){const M={};if(!T)return M;for(const R of v){const P=R.layerIds.map(j=>T.getLayer(j)).filter(Boolean);if(P.length!==0){R.layers=P,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(j=>P.filter(U=>U.id===j)[0]));for(const j of P)M[j.id]=R}}return M}(t.buckets,c?.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const T=this.buckets[v];if(T instanceof l.a9){if(this.hasSymbolBuckets=!0,!p)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const T=this.buckets[v];if(T instanceof l.a9&&T.hasRTLText){this.hasRTLText=!0,ii().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(v).queryRadius(T))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const p in this.buckets){const v=this.buckets[p];v.uploadPending()&&v.upload(t)}const c=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(t,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(t,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,c,p,v,T,M,R,P,j,U,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:T,scale:M,tileSize:this.tileSize,pixelPosMatrix:U,transform:P,params:R,queryPadding:this.queryPadding*j,getElevation:$},t,c,p):{}}querySourceFeatures(t,c){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const v=p.loadVTLayers(),T=c&&c.sourceLayer?c.sourceLayer:"",M=v._geojsonTileLayer||v[T];if(!M)return;const R=l.aa(c?.filter,c?.globalState),{z:P,x:j,y:U}=this.tileID.canonical,$={z:P,x:j,y:U};for(let G=0;G<M.length;G++){const Y=M.feature(G);if(R.needGeometry){const ue=l.ab(Y,!0);if(!R.filter(new l.F(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!R.filter(new l.F(this.tileID.overscaledZ),Y))continue;const ee=p.getId(Y,T),he=new l.ac(Y,P,j,U,ee);he.tile=$,t.push(he)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const c=this.expirationTime;if(t.cacheControl){const p=l.ad(t.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const p=Date.now();let v=!1;if(this.expirationTime>p)v=!1;else if(c)if(this.expirationTime<c)v=!0;else{const T=this.expirationTime-c;T?this.expirationTime=p+Math.max(T,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!c.style.hasLayer(v))continue;const T=this.buckets[v],M=T.layers[0].sourceLayer||"_geojsonTileLayer",R=p[M],P=t[M];if(!R||!P||Object.keys(P).length===0)continue;T.update(P,R,this.imageAtlas&&this.imageAtlas.patternPositions||{});const j=c&&c.style&&c.style.getLayer(v);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(T)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=F.now()+t}setDependencies(t,c){const p={};for(const v of c)p[v]=!0;this.dependencies[t]=p}hasDependency(t,c){for(const p of t){const v=this.dependencies[p];if(v){for(const T of c)if(v[T])return!0}}return!1}}class Pe{constructor(t,c){this.max=t,this.onRemove=c,this.reset()}reset(){for(const t in this.data)for(const c of this.data[t])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(t,c,p){const v=t.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const T={value:c,timeout:void 0};if(p!==void 0&&(T.timeout=setTimeout(()=>{this.remove(t,T)},p)),this.data[v].push(T),this.order.push(v),this.order.length>this.max){const M=this._getAndRemoveByKey(this.order[0]);M&&this.onRemove(M)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const c=this.data[t].shift();return c.timeout&&clearTimeout(c.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),c.value}getByKey(t){const c=this.data[t];return c?c[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,c){if(!this.has(t))return this;const p=t.wrapped().key,v=c===void 0?0:this.data[p].indexOf(c),T=this.data[p][v];return this.data[p].splice(v,1),T.timeout&&clearTimeout(T.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(T.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(t){const c=[];for(const p in this.data)for(const v of this.data[p])t(v.value)||c.push(v);for(const p of c)this.remove(p.value.tileID,p)}}class te{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,c,p){const v=String(c);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][v]=this.stateChanges[t][v]||{},l.e(this.stateChanges[t][v],p),this.deletedStates[t]===null){this.deletedStates[t]={};for(const T in this.state[t])T!==v&&(this.deletedStates[t][T]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][v]===null){this.deletedStates[t][v]={};for(const T in this.state[t][v])p[T]||(this.deletedStates[t][v][T]=null)}else for(const T in p)this.deletedStates[t]&&this.deletedStates[t][v]&&this.deletedStates[t][v][T]===null&&delete this.deletedStates[t][v][T]}removeFeatureState(t,c,p){if(this.deletedStates[t]===null)return;const v=String(c);if(this.deletedStates[t]=this.deletedStates[t]||{},p&&c!==void 0)this.deletedStates[t][v]!==null&&(this.deletedStates[t][v]=this.deletedStates[t][v]||{},this.deletedStates[t][v][p]=null);else if(c!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][v])for(p in this.deletedStates[t][v]={},this.stateChanges[t][v])this.deletedStates[t][v][p]=null;else this.deletedStates[t][v]=null;else this.deletedStates[t]=null}getState(t,c){const p=String(c),v=l.e({},(this.state[t]||{})[p],(this.stateChanges[t]||{})[p]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const T=this.deletedStates[t][c];if(T===null)return{};for(const M in T)delete v[M]}return v}initializeTileState(t,c){t.setFeatureState(this.state,c)}coalesceChanges(t,c){const p={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const T={};for(const M in this.stateChanges[v])this.state[v][M]||(this.state[v][M]={}),l.e(this.state[v][M],this.stateChanges[v][M]),T[M]=this.state[v][M];p[v]=T}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const T={};if(this.deletedStates[v]===null)for(const M in this.state[v])T[M]={},this.state[v][M]={};else for(const M in this.deletedStates[v]){if(this.deletedStates[v][M]===null)this.state[v][M]={};else for(const R of Object.keys(this.deletedStates[v][M]))delete this.state[v][M][R];T[M]=this.state[v][M]}p[v]=p[v]||{},l.e(p[v],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const v in t)t[v].setFeatureState(p,c)}}const ne=89.25;function le(b,t){const c=l.ah(t.lat,-l.ai,l.ai);return new l.P(l.V(t.lng)*b,l.U(c)*b)}function be(b,t){return new l.a1(t.x/b,t.y/b).toLngLat()}function De(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(l.ae(90-b.pitch)),Math.tan(l.ae(ne-b.pitch)))}function Oe(b,t){const c=b.canonical,p=t/l.af(c.z),v=c.x+Math.pow(2,c.z)*b.wrap,T=l.ag(new Float64Array(16));return l.M(T,T,[v*p,c.y*p,0]),l.N(T,T,[p/l.$,p/l.$,1]),T}function Ye(b,t,c,p,v){const T=l.a1.fromLngLat(b,t),M=v*l.aj(1,b.lat),R=M*Math.cos(l.ae(c)),P=Math.sqrt(M*M-R*R),j=P*Math.sin(l.ae(-p)),U=P*Math.cos(l.ae(-p));return new l.a1(T.x+j,T.y+U,T.z+R)}function je(b,t,c){const p=t.intersectsFrustum(b);if(!c||p===0)return p;const v=t.intersectsPlane(c);return v===0?0:p===2&&v===2?2:1}function tt(b,t,c){let p=0;const v=(c-t)/10;for(let T=0;T<10;T++)p+=v*Math.pow(Math.cos(t+(T+.5)/10*(c-t)),b);return p}function mt(b,t){return function(c,p,v,T,M){const R=2*((b-1)/l.ak(Math.cos(l.ae(ne-M))/Math.cos(l.ae(ne)))-1),P=Math.acos(v/T),j=2*tt(R-1,0,l.ae(M/2)),U=Math.min(l.ae(ne),P+l.ae(M/2)),$=tt(R-1,Math.min(U,P-l.ae(M/2)),U),G=Math.atan(p/v),Y=Math.hypot(p,v);let ee=c;return ee+=l.ak(T/Y/Math.max(.5,Math.cos(l.ae(M/2)))),ee+=R*l.ak(Math.cos(G))/2,ee-=l.ak(Math.max(1,$/j/t))/2,ee}}const ot=mt(9.314,3);function jt(b,t){const c=(t.roundZoom?Math.round:Math.floor)(b.zoom+l.ak(b.tileSize/t.tileSize));return Math.max(0,c)}function Fe(b,t){const c=b.getCameraFrustum(),p=b.getClippingPlane(),v=b.screenPointToMercatorCoordinate(b.getCameraPoint()),T=l.a1.fromLngLat(b.center,b.elevation);v.z=T.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const M=b.getCoveringTilesDetailsProvider(),R=M.allowVariableZoom(b,t),P=jt(b,t),j=t.minzoom||0,U=t.maxzoom!==void 0?t.maxzoom:b.maxZoom,$=Math.min(Math.max(0,P),U),G=Math.pow(2,$),Y=[G*v.x,G*v.y,0],ee=[G*T.x,G*T.y,0],he=Math.hypot(T.x-v.x,T.y-v.y),ue=Math.abs(T.z-v.z),fe=Math.hypot(he,ue),pe=Se=>({zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),ve=[],ye=[];if(b.renderWorldCopies&&M.allowWorldCopies())for(let Se=1;Se<=3;Se++)ve.push(pe(-Se)),ve.push(pe(Se));for(ve.push(pe(0));ve.length>0;){const Se=ve.pop(),Re=Se.x,_e=Se.y;let Ne=Se.fullyVisible;const We={x:Re,y:_e,z:Se.zoom},Ve=M.getTileBoundingVolume(We,Se.wrap,b.elevation,t);if(!Ne){const vt=je(c,Ve,p);if(vt===0)continue;Ne=vt===2}const $e=M.distanceToTile2d(v.x,v.y,We,Ve);let Xe=P;R&&(Xe=(t.calculateTileZoom||ot)(b.zoom+l.ak(b.tileSize/t.tileSize),$e,ue,fe,b.fov)),Xe=(t.roundZoom?Math.round:Math.floor)(Xe),Xe=Math.max(0,Xe);const Mt=Math.min(Xe,U);if(Se.wrap=M.getWrap(T,We,Se.wrap),Se.zoom>=Mt){if(Se.zoom<j)continue;const vt=$-Se.zoom,ct=Y[0]-.5-(Re<<vt),Bt=Y[1]-.5-(_e<<vt),bn=t.reparseOverscaled?Math.max(Se.zoom,Xe):Se.zoom;ye.push({tileID:new l.Z(Se.zoom===U?bn:Se.zoom,Se.wrap,Se.zoom,Re,_e),distanceSq:l.al([ee[0]-.5-Re,ee[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(ct*ct+Bt*Bt)})}else for(let vt=0;vt<4;vt++)ve.push({zoom:Se.zoom+1,x:(Re<<1)+vt%2,y:(_e<<1)+(vt>>1),wrap:Se.wrap,fullyVisible:Ne})}return ye.sort((Se,Re)=>Se.distanceSq-Re.distanceSq).map(Se=>Se.tileID)}const rn=l.a2.fromPoints([new l.P(0,0),new l.P(l.$,l.$)]);class Sn extends l.E{constructor(t,c,p){super(),this.id=t,this.dispatcher=p,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,T,M,R)=>{const P=new(Ca(T.type))(v,T,M,R);if(P.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${P.id}`);return P})(t,c,p,this),this._tiles={},this._cache=new Pe(0,v=>this._unloadTile(v)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new te,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const c=this._tiles[t];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,c,p){return l._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,c,p)}catch(v){t.state="errored",v.status!==404?this._source.fire(new l.k(v,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new l.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const p=this._tiles[c];p.upload(t),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort($t).map(t=>t.key)}getRenderableIds(t){const c=[];for(const p in this._tiles)this._isIdRenderable(p,t)&&c.push(this._tiles[p]);return t?c.sort((p,v)=>{const T=p.tileID,M=v.tileID,R=new l.P(T.canonical.x,T.canonical.y)._rotate(-this.transform.bearingInRadians),P=new l.P(M.canonical.x,M.canonical.y)._rotate(-this.transform.bearingInRadians);return T.overscaledZ-M.overscaledZ||P.y-R.y||P.x-R.x}).map(p=>p.tileID.key):c.map(p=>p.tileID).sort($t).map(p=>p.key)}hasRenderableParent(t){const c=this.findLoadedParent(t,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(t,c){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(c||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)t?this._reloadTile(c,"expired"):this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(t,c){return l._(this,void 0,void 0,function*(){const p=this._tiles[t];p&&(p.state!=="loading"&&(p.state=c),yield this._loadTile(p,t,c))})}_tileLoaded(t,c,p){t.timeAdded=F.now(),p==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(c,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const c=this.getRenderableIds();for(let v=0;v<c.length;v++){const T=c[v];if(t.neighboringTiles&&t.neighboringTiles[T]){const M=this.getTileByID(T);p(t,M),p(M,t)}}function p(v,T){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let M=T.tileID.canonical.x-v.tileID.canonical.x;const R=T.tileID.canonical.y-v.tileID.canonical.y,P=Math.pow(2,v.tileID.canonical.z),j=T.tileID.key;M===0&&R===0||Math.abs(R)>1||(Math.abs(M)>1&&(Math.abs(M+P)===1?M+=P:Math.abs(M-P)===1&&(M-=P)),T.dem&&v.dem&&(v.dem.backfillBorder(T.dem,M,R),v.neighboringTiles&&v.neighboringTiles[j]&&(v.neighboringTiles[j].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,c,p,v){for(const T in this._tiles){let M=this._tiles[T];if(v[T]||!M.hasData()||M.tileID.overscaledZ<=c||M.tileID.overscaledZ>p)continue;let R=M.tileID;for(;M&&M.tileID.overscaledZ>c+1;){const j=M.tileID.scaledTo(M.tileID.overscaledZ-1);M=this._tiles[j.key],M&&M.hasData()&&(R=j)}let P=R;for(;P.overscaledZ>c;)if(P=P.scaledTo(P.overscaledZ-1),t[P.key]||t[P.canonical.key]){v[R.key]=R;break}}}findLoadedParent(t,c){if(t.key in this._loadedParentTiles){const p=this._loadedParentTiles[t.key];return p&&p.tileID.overscaledZ>=c?p:null}for(let p=t.overscaledZ-1;p>=c;p--){const v=t.scaledTo(p),T=this._getLoadedTile(v);if(T)return T}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const c=this._tiles[t.key];return c&&c.hasData()?c:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const c=Math.ceil(t.width/this._source.tileSize)+1,p=Math.ceil(t.height/this._source.tileSize)+1,v=Math.floor(c*p*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(T)}handleWrapJump(t){const c=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,c){const p={};for(const v in this._tiles){const T=this._tiles[v];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+c),p[T.tileID.key]=T}this._tiles=p;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(t,c,p,v,T,M){const R={},P={},j=Object.keys(t),U=F.now();for(const $ of j){const G=t[$],Y=this._tiles[$];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=U)continue;const ee=this.findLoadedParent(G,c),he=this.findLoadedSibling(G),ue=ee||he||null;ue&&(this._addTile(ue.tileID),R[ue.tileID.key]=ue.tileID),P[$]=G}this._retainLoadedChildren(P,v,p,t);for(const $ in R)t[$]||(this._coveredTiles[$]=!0,t[$]=R[$]);if(M){const $={},G={};for(const Y of T)this._tiles[Y.key].hasData()?$[Y.key]=Y:G[Y.key]=Y;for(const Y in G){const ee=G[Y].children(this._source.maxzoom);this._tiles[ee[0].key]&&this._tiles[ee[1].key]&&this._tiles[ee[2].key]&&this._tiles[ee[3].key]&&($[ee[0].key]=t[ee[0].key]=ee[0],$[ee[1].key]=t[ee[1].key]=ee[1],$[ee[2].key]=t[ee[2].key]=ee[2],$[ee[3].key]=t[ee[3].key]=ee[3],delete G[Y])}for(const Y in G){const ee=G[Y],he=this.findLoadedParent(ee,this._source.minzoom),ue=this.findLoadedSibling(ee),fe=he||ue||null;if(fe){$[fe.tileID.key]=t[fe.tileID.key]=fe.tileID;for(const pe in $)$[pe].isChildOf(fe.tileID)&&delete $[pe]}}for(const Y in this._tiles)$[Y]||(this._coveredTiles[Y]=!0)}}update(t,c){if(!this._sourceLoaded||this._paused)return;let p;this.transform=t,this.terrain=c,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new l.Z(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(p=Fe(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter(U=>this._source.hasTile(U)))):p=[];const v=jt(t,this._source),T=Math.max(v-Sn.maxOverzooming,this._source.minzoom),M=Math.max(v+Sn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const $ of p)if($.canonical.z>this._source.minzoom){const G=$.scaledTo($.canonical.z-1);U[G.key]=G;const Y=$.scaledTo(Math.max(this._source.minzoom,Math.min($.canonical.z,5)));U[Y.key]=Y}p=p.concat(Object.values(U))}const R=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,R&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(p,v);cn(this._source.type)&&this._updateCoveredAndRetainedTiles(P,T,M,v,p,c);for(const U in P)this._tiles[U].clearFadeHold();const j=l.am(this._tiles,P);for(const U of j){const $=this._tiles[U];$.hasSymbolBuckets&&!$.holdingForFade()?$.setHoldDuration(this.map._fadeDuration):$.hasSymbolBuckets&&!$.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,c){var p;const v={},T={},M=Math.max(c-Sn.maxOverzooming,this._source.minzoom),R=Math.max(c+Sn.maxUnderzooming,this._source.minzoom),P={};for(const j of t){const U=this._addTile(j);v[j.key]=j,U.hasData()||c<this._source.maxzoom&&(P[j.key]=j)}this._retainLoadedChildren(P,c,R,v);for(const j of t){let U=this._tiles[j.key];if(U.hasData())continue;if(c+1>this._source.maxzoom){const G=j.children(this._source.maxzoom)[0],Y=this.getTile(G);if(Y&&Y.hasData()){v[G.key]=G;continue}}else{const G=j.children(this._source.maxzoom);if(G.length===4&&v[G[0].key]&&v[G[1].key]&&v[G[2].key]&&v[G[3].key]||G.length===1&&v[G[0].key])continue}let $=U.wasRequested();for(let G=j.overscaledZ-1;G>=M;--G){const Y=j.scaledTo(G);if(T[Y.key])break;if(T[Y.key]=!0,U=this.getTile(Y),!U&&$&&(U=this._addTile(Y)),U){const ee=U.hasData();if((ee||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||$)&&(v[Y.key]=Y),$=U.wasRequested(),ee)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const c=[];let p,v=this._tiles[t].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){p=this._loadedParentTiles[v.key];break}c.push(v.key);const T=v.scaledTo(v.overscaledZ-1);if(p=this._getLoadedTile(T),p)break;v=T}for(const T of c)this._loadedParentTiles[T]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const c=this._tiles[t].tileID,p=this._getLoadedTile(c);this._loadedSiblingTiles[c.key]=p}}_addTile(t){let c=this._tiles[t.key];if(c)return c;c=this._cache.getAndRemove(t),c&&(this._setTileReloadTimer(t.key,c),c.tileID=t,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,c)));const p=c;return c||(c=new xr(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(c,t.key,c.state)),c.uses++,this._tiles[t.key]=c,p||this._source.fire(new l.l("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(t,c){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const p=c.getExpiryTimeout();p&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},p))}refreshTiles(t){for(const c in this._tiles)(this._isIdRenderable(c)||this._tiles[c].state=="errored")&&t.some(p=>p.equals(this._tiles[c].tileID.canonical))&&this._reloadTile(c,"expired")}_removeTile(t){const c=this._tiles[t];c&&(c.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}_dataHandler(t){const c=t.sourceDataType;t.dataType==="source"&&c==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&c==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,c,p){const v=[],T=this.transform;if(!T)return v;const M=T.getCoveringTilesDetailsProvider().allowWorldCopies(),R=p?T.getCameraQueryGeometry(t):t,P=Y=>T.screenPointToMercatorCoordinate(Y,this.terrain),j=this.transformBbox(t,P,!M),U=this.transformBbox(R,P,!M),$=this.getIds(),G=l.a2.fromPoints(U);for(let Y=0;Y<$.length;Y++){const ee=this._tiles[$[Y]];if(ee.holdingForFade())continue;const he=M?[ee.tileID]:[ee.tileID.unwrapTo(-1),ee.tileID.unwrapTo(0)],ue=Math.pow(2,T.zoom-ee.tileID.overscaledZ),fe=c*ee.queryPadding*l.$/ee.tileSize/ue;for(const pe of he){const ve=G.map(ye=>pe.getTilePoint(new l.a1(ye.x,ye.y)));if(ve.expandBy(fe),ve.intersects(rn)){const ye=j.map(Re=>pe.getTilePoint(Re)),Se=U.map(Re=>pe.getTilePoint(Re));v.push({tile:ee,tileID:M?pe:pe.unwrapTo(0),queryGeometry:ye,cameraQueryGeometry:Se,scale:ue})}}}return v}transformBbox(t,c,p){let v=t.map(c);if(p){const T=l.a2.fromPoints(t);T.shrinkBy(.001*Math.min(T.width(),T.height()));const M=T.map(c);l.a2.fromPoints(v).covers(M)||(v=v.map(R=>R.x>.5?new l.a1(R.x-1,R.y,R.z):R))}return v}getVisibleCoordinates(t){const c=this.getRenderableIds(t).map(p=>this._tiles[p].tileID);return this.transform&&this.transform.populateCache(c),c}hasTransition(){if(this._source.hasTransition())return!0;if(cn(this._source.type)){const t=F.now();for(const c in this._tiles)if(this._tiles[c].fadeEndTime>=t)return!0}return!1}setFeatureState(t,c,p){this._state.updateState(t=t||"_geojsonTileLayer",c,p)}removeFeatureState(t,c,p){this._state.removeFeatureState(t=t||"_geojsonTileLayer",c,p)}getFeatureState(t,c){return this._state.getState(t=t||"_geojsonTileLayer",c)}setDependencies(t,c,p){const v=this._tiles[t];v&&v.setDependencies(c,p)}reloadTilesForDependencies(t,c){for(const p in this._tiles)this._tiles[p].hasDependency(t,c)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(t,c))}}function $t(b,t){const c=Math.abs(2*b.wrap)-+(b.wrap<0),p=Math.abs(2*t.wrap)-+(t.wrap<0);return b.overscaledZ-t.overscaledZ||p-c||t.canonical.y-b.canonical.y||t.canonical.x-b.canonical.x}function cn(b){return b==="raster"||b==="image"||b==="video"}Sn.maxOverzooming=10,Sn.maxUnderzooming=3;class ci{constructor(t,c){this.reset(t,c)}reset(t,c){this.points=t||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.ah(t,0,1);let c=1,p=this._distances[c];const v=t*this.paddedLength+this.padding;for(;p<v&&c<this._distances.length;)p=this._distances[++c];const T=c-1,M=this._distances[T],R=p-M,P=R>0?(v-M)/R:0;return this.points[T].mult(1-P).add(this.points[c].mult(P))}}function fr(b,t){let c=!0;return b==="always"||b!=="never"&&t!=="never"||(c=!1),c}class wr{constructor(t,c,p){const v=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(t/p),this.yCellCount=Math.ceil(c/p);for(let M=0;M<this.xCellCount*this.yCellCount;M++)v.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=c,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,c,p,v,T){this._forEachCell(c,p,v,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(T)}insertCircle(t,c,p,v){this._forEachCell(c-v,p-v,c+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(c),this.circles.push(p),this.circles.push(v)}_insertBoxCell(t,c,p,v,T,M){this.boxCells[T].push(M)}_insertCircleCell(t,c,p,v,T,M){this.circleCells[T].push(M)}_query(t,c,p,v,T,M,R){if(p<0||t>this.width||v<0||c>this.height)return[];const P=[];if(t<=0&&c<=0&&this.width<=p&&this.height<=v){if(T)return[{key:null,x1:t,y1:c,x2:p,y2:v}];for(let j=0;j<this.boxKeys.length;j++)P.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const U=this.circles[3*j],$=this.circles[3*j+1],G=this.circles[3*j+2];P.push({key:this.circleKeys[j],x1:U-G,y1:$-G,x2:U+G,y2:$+G})}}else this._forEachCell(t,c,p,v,this._queryCell,P,{hitTest:T,overlapMode:M,seenUids:{box:{},circle:{}}},R);return P}query(t,c,p,v){return this._query(t,c,p,v,!1,null)}hitTest(t,c,p,v,T,M){return this._query(t,c,p,v,!0,T,M).length>0}hitTestCircle(t,c,p,v,T){const M=t-p,R=t+p,P=c-p,j=c+p;if(R<0||M>this.width||j<0||P>this.height)return!1;const U=[];return this._forEachCell(M,P,R,j,this._queryCellCircle,U,{hitTest:!0,overlapMode:v,circle:{x:t,y:c,radius:p},seenUids:{box:{},circle:{}}},T),U.length>0}_queryCell(t,c,p,v,T,M,R,P){const{seenUids:j,hitTest:U,overlapMode:$}=R,G=this.boxCells[T];if(G!==null){const ee=this.bboxes;for(const he of G)if(!j.box[he]){j.box[he]=!0;const ue=4*he,fe=this.boxKeys[he];if(t<=ee[ue+2]&&c<=ee[ue+3]&&p>=ee[ue+0]&&v>=ee[ue+1]&&(!P||P(fe))&&(!U||!fr($,fe.overlapMode))&&(M.push({key:fe,x1:ee[ue],y1:ee[ue+1],x2:ee[ue+2],y2:ee[ue+3]}),U))return!0}}const Y=this.circleCells[T];if(Y!==null){const ee=this.circles;for(const he of Y)if(!j.circle[he]){j.circle[he]=!0;const ue=3*he,fe=this.circleKeys[he];if(this._circleAndRectCollide(ee[ue],ee[ue+1],ee[ue+2],t,c,p,v)&&(!P||P(fe))&&(!U||!fr($,fe.overlapMode))){const pe=ee[ue],ve=ee[ue+1],ye=ee[ue+2];if(M.push({key:fe,x1:pe-ye,y1:ve-ye,x2:pe+ye,y2:ve+ye}),U)return!0}}}return!1}_queryCellCircle(t,c,p,v,T,M,R,P){const{circle:j,seenUids:U,overlapMode:$}=R,G=this.boxCells[T];if(G!==null){const ee=this.bboxes;for(const he of G)if(!U.box[he]){U.box[he]=!0;const ue=4*he,fe=this.boxKeys[he];if(this._circleAndRectCollide(j.x,j.y,j.radius,ee[ue+0],ee[ue+1],ee[ue+2],ee[ue+3])&&(!P||P(fe))&&!fr($,fe.overlapMode))return M.push(!0),!0}}const Y=this.circleCells[T];if(Y!==null){const ee=this.circles;for(const he of Y)if(!U.circle[he]){U.circle[he]=!0;const ue=3*he,fe=this.circleKeys[he];if(this._circlesCollide(ee[ue],ee[ue+1],ee[ue+2],j.x,j.y,j.radius)&&(!P||P(fe))&&!fr($,fe.overlapMode))return M.push(!0),!0}}}_forEachCell(t,c,p,v,T,M,R,P){const j=this._convertToXCellCoord(t),U=this._convertToYCellCoord(c),$=this._convertToXCellCoord(p),G=this._convertToYCellCoord(v);for(let Y=j;Y<=$;Y++)for(let ee=U;ee<=G;ee++)if(T.call(this,t,c,p,v,this.xCellCount*ee+Y,M,R,P))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,c,p,v,T,M){const R=v-t,P=T-c,j=p+M;return j*j>R*R+P*P}_circleAndRectCollide(t,c,p,v,T,M,R){const P=(M-v)/2,j=Math.abs(t-(v+P));if(j>P+p)return!1;const U=(R-T)/2,$=Math.abs(c-(T+U));if($>U+p)return!1;if(j<=P||$<=U)return!0;const G=j-P,Y=$-U;return G*G+Y*Y<=p*p}}function di(b,t,c){const p=l.L();if(!b){const{vecSouth:$,vecEast:G}=an(t),Y=C();Y[0]=G[0],Y[1]=G[1],Y[2]=$[0],Y[3]=$[1],v=Y,(U=(M=(T=Y)[0])*(j=T[3])-(P=T[2])*(R=T[1]))&&(v[0]=j*(U=1/U),v[1]=-R*U,v[2]=-P*U,v[3]=M*U),p[0]=Y[0],p[1]=Y[1],p[4]=Y[2],p[5]=Y[3]}var v,T,M,R,P,j,U;return l.N(p,p,[1/c,1/c,1]),p}function Kt(b,t,c,p){if(b){const v=l.L();if(!t){const{vecSouth:T,vecEast:M}=an(c);v[0]=M[0],v[1]=M[1],v[4]=T[0],v[5]=T[1]}return l.N(v,v,[p,p,1]),v}return c.pixelsToClipSpaceMatrix}function an(b){const t=Math.cos(b.rollInRadians),c=Math.sin(b.rollInRadians),p=Math.cos(b.pitchInRadians),v=Math.cos(b.bearingInRadians),T=Math.sin(b.bearingInRadians),M=l.ar();M[0]=-v*p*c-T*t,M[1]=-T*p*c+v*t;const R=l.as(M);R<1e-9?l.at(M):l.au(M,M,1/R);const P=l.ar();P[0]=v*p*t-T*c,P[1]=T*p*t+v*c;const j=l.as(P);return j<1e-9?l.at(P):l.au(P,P,1/j),{vecEast:P,vecSouth:M}}function Pi(b,t,c,p){let v;p?(v=[b,t,p(b,t),1],l.aw(v,v,c)):(v=[b,t,0,1],Kl(v,v,c));const T=v[3];return{point:new l.P(v[0]/T,v[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function wt(b,t){return .5+b/t*.5}function Jr(b,t){return b.x>=-t[0]&&b.x<=t[0]&&b.y>=-t[1]&&b.y<=t[1]}function Yi(b,t,c,p,v,T,M,R,P,j,U,$,G){const Y=c?b.textSizeData:b.iconSizeData,ee=l.an(Y,t.transform.zoom),he=[256/t.width*2+1,256/t.height*2+1],ue=c?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;ue.clear();const fe=b.lineVertexArray,pe=c?b.text.placedSymbolArray:b.icon.placedSymbolArray,ve=t.transform.width/t.transform.height;let ye=!1;for(let Se=0;Se<pe.length;Se++){const Re=pe.get(Se);if(Re.hidden||Re.writingMode===l.ao.vertical&&!ye){ms(Re.numGlyphs,ue);continue}ye=!1;const _e=new l.P(Re.anchorX,Re.anchorY),Ne={getElevation:G,pitchedLabelPlaneMatrix:p,lineVertexArray:fe,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:_e,unwrappedTileID:P,width:j,height:U,translation:$},We=Oi(Re.anchorX,Re.anchorY,Ne);if(!Jr(We.point,he)){ms(Re.numGlyphs,ue);continue}const Ve=wt(t.transform.cameraToCenterDistance,We.signedDistanceFromCamera),$e=l.ap(Y,ee,Re),Xe=T?$e*t.transform.getPitchedTextCorrection(Re.anchorX,Re.anchorY,P)/Ve:$e*Ve,Mt=It({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:v,symbol:Re,fontSize:Xe,flip:!1,keepUpright:M,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:ue,aspectRatio:ve,rotateToLine:R});ye=Mt.useVertical,(Mt.notEnoughRoom||ye||Mt.needsFlipping&&It({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:v,symbol:Re,fontSize:Xe,flip:!0,keepUpright:M,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:ue,aspectRatio:ve,rotateToLine:R}).notEnoughRoom)&&ms(Re.numGlyphs,ue)}c?b.text.dynamicLayoutVertexBuffer.updateData(ue):b.icon.dynamicLayoutVertexBuffer.updateData(ue)}function Vs(b,t,c,p,v,T,M,R){const P=T.glyphStartIndex+T.numGlyphs,j=T.lineStartIndex,U=T.lineStartIndex+T.lineLength,$=t.getoffsetX(T.glyphStartIndex),G=t.getoffsetX(P-1),Y=Ia(b*$,c,p,v,T.segment,j,U,R,M);if(!Y)return null;const ee=Ia(b*G,c,p,v,T.segment,j,U,R,M);return ee?R.projectionCache.anyProjectionOccluded?null:{first:Y,last:ee}:null}function ps(b,t,c,p){return b===l.ao.horizontal&&Math.abs(c.y-t.y)>Math.abs(c.x-t.x)*p?{useVertical:!0}:(b===l.ao.vertical?t.y<c.y:t.x>c.x)?{needsFlipping:!0}:null}function It(b){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:c,symbol:p,fontSize:v,flip:T,keepUpright:M,glyphOffsetArray:R,dynamicLayoutVertexArray:P,aspectRatio:j,rotateToLine:U}=b,$=v/24,G=p.lineOffsetX*$,Y=p.lineOffsetY*$;let ee;if(p.numGlyphs>1){const he=p.glyphStartIndex+p.numGlyphs,ue=p.lineStartIndex,fe=p.lineStartIndex+p.lineLength,pe=Vs($,R,G,Y,T,p,U,t);if(!pe)return{notEnoughRoom:!0};const ve=fo(pe.first.point.x,pe.first.point.y,t,c),ye=fo(pe.last.point.x,pe.last.point.y,t,c);if(M&&!T){const Se=ps(p.writingMode,ve,ye,j);if(Se)return Se}ee=[pe.first];for(let Se=p.glyphStartIndex+1;Se<he-1;Se++){const Re=Ia($*R.getoffsetX(Se),G,Y,T,p.segment,ue,fe,t,U);if(!Re)return{notEnoughRoom:!0};ee.push(Re)}ee.push(pe.last)}else{if(M&&!T){const ue=rr(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,fe=p.lineStartIndex+p.segment+1,pe=new l.P(t.lineVertexArray.getx(fe),t.lineVertexArray.gety(fe)),ve=rr(pe.x,pe.y,t),ye=ve.signedDistanceFromCamera>0?ve.point:yn(t.tileAnchorPoint,pe,ue,1,t),Se=fo(ue.x,ue.y,t,c),Re=fo(ye.x,ye.y,t,c),_e=ps(p.writingMode,Se,Re,j);if(_e)return _e}const he=Ia($*R.getoffsetX(p.glyphStartIndex),G,Y,T,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,t,U);if(!he||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ee=[he]}for(const he of ee)l.av(P,he.point,he.angle);return{}}function yn(b,t,c,p,v){const T=b.add(b.sub(t)._unit()),M=rr(T.x,T.y,v).point,R=c.sub(M);return c.add(R._mult(p/R.mag()))}function ln(b,t,c){const p=t.projectionCache;if(p.projections[b])return p.projections[b];const v=new l.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),T=rr(v.x,v.y,t);if(T.signedDistanceFromCamera>0)return p.projections[b]=T.point,p.anyProjectionOccluded=p.anyProjectionOccluded||T.isOccluded,T.point;const M=b-c.direction;return yn(c.distanceFromAnchor===0?t.tileAnchorPoint:new l.P(t.lineVertexArray.getx(M),t.lineVertexArray.gety(M)),v,c.previousVertex,c.absOffsetX-c.distanceFromAnchor+1,t)}function rr(b,t,c){const p=b+c.translation[0],v=t+c.translation[1];let T;return c.pitchWithMap?(T=Pi(p,v,c.pitchedLabelPlaneMatrix,c.getElevation),T.isOccluded=!1):(T=c.transform.projectTileCoordinates(p,v,c.unwrappedTileID,c.getElevation),T.point.x=(.5*T.point.x+.5)*c.width,T.point.y=(.5*-T.point.y+.5)*c.height),T}function fo(b,t,c,p){if(c.pitchWithMap){const v=[b,t,0,1];return l.aw(v,v,p),c.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],c.unwrappedTileID,c.getElevation).point}return{x:b/c.width*2-1,y:1-t/c.height*2}}function Oi(b,t,c){return c.transform.projectTileCoordinates(b,t,c.unwrappedTileID,c.getElevation)}function _n(b,t,c){return b._unit()._perp()._mult(t*c)}function rh(b,t,c,p,v,T,M,R,P){if(R.projectionCache.offsets[b])return R.projectionCache.offsets[b];const j=c.add(t);if(b+P.direction<p||b+P.direction>=v)return R.projectionCache.offsets[b]=j,j;const U=ln(b+P.direction,R,P),$=_n(U.sub(c),M,P.direction),G=c.add($),Y=U.add($);return R.projectionCache.offsets[b]=l.ax(T,j,G,Y)||j,R.projectionCache.offsets[b]}function Ia(b,t,c,p,v,T,M,R,P){const j=p?b-t:b+t;let U=j>0?1:-1,$=0;p&&(U*=-1,$=Math.PI),U<0&&($+=Math.PI);let G,Y=U>0?T+v:T+v+1;R.projectionCache.cachedAnchorPoint?G=R.projectionCache.cachedAnchorPoint:(G=rr(R.tileAnchorPoint.x,R.tileAnchorPoint.y,R).point,R.projectionCache.cachedAnchorPoint=G);let ee,he,ue=G,fe=G,pe=0,ve=0;const ye=Math.abs(j),Se=[];let Re;for(;pe+ve<=ye;){if(Y+=U,Y<T||Y>=M)return null;pe+=ve,fe=ue,he=ee;const We={absOffsetX:ye,direction:U,distanceFromAnchor:pe,previousVertex:fe};if(ue=ln(Y,R,We),c===0)Se.push(fe),Re=ue.sub(fe);else{let Ve;const $e=ue.sub(fe);Ve=$e.mag()===0?_n(ln(Y+U,R,We).sub(ue),c,U):_n($e,c,U),he||(he=fe.add(Ve)),ee=rh(Y,Ve,ue,T,M,he,c,R,We),Se.push(he),Re=ee.sub(he)}ve=Re.mag()}const _e=Re._mult((ye-pe)/ve)._add(he||fe),Ne=$+Math.atan2(ue.y-fe.y,ue.x-fe.x);return Se.push(_e),{point:_e,angle:P?Ne:0,path:Se}}const Gs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ms(b,t){for(let c=0;c<b;c++){const p=t.length;t.resize(p+4),t.float32.set(Gs,3*p)}}function Kl(b,t,c){const p=t[0],v=t[1];return b[0]=c[0]*p+c[4]*v+c[12],b[1]=c[1]*p+c[5]*v+c[13],b[3]=c[3]*p+c[7]*v+c[15],b}const Hi=100;class Cd{constructor(t,c=new wr(t.width+200,t.height+200,25),p=new wr(t.width+200,t.height+200,25)){this.transform=t,this.grid=c,this.ignoredGrid=p,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Hi,this.screenBottomBoundary=t.height+Hi,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,c,p,v,T,M,R,P,j,U,$,G){const Y=this.projectAndGetPerspectiveRatio(t.anchorPointX+P[0],t.anchorPointY+P[1],T,U,G),ee=p*Y.perspectiveRatio;let he;if(M||R)he=this._projectCollisionBox(t,ee,v,T,M,R,P,Y,U,$,G);else{const Re=Y.x+($?$.x*ee:0),_e=Y.y+($?$.y*ee:0);he={allPointsOccluded:!1,box:[Re+t.x1*ee,_e+t.y1*ee,Re+t.x2*ee,_e+t.y2*ee]}}const[ue,fe,pe,ve]=he.box,ye=M?he.allPointsOccluded:Y.isOccluded;let Se=ye;return Se||(Se=Y.perspectiveRatio<this.perspectiveRatioCutoff),Se||(Se=!this.isInsideGrid(ue,fe,pe,ve)),Se||c!=="always"&&this.grid.hitTest(ue,fe,pe,ve,c,j)?{box:[ue,fe,pe,ve],placeable:!1,offscreen:!1,occluded:ye}:{box:[ue,fe,pe,ve],placeable:!0,offscreen:this.isOffscreen(ue,fe,pe,ve),occluded:ye}}placeCollisionCircles(t,c,p,v,T,M,R,P,j,U,$,G,Y,ee){const he=[],ue=new l.P(c.anchorX,c.anchorY),fe=this.getPerspectiveRatio(ue.x,ue.y,M,ee),pe=(j?T*this.transform.getPitchedTextCorrection(c.anchorX,c.anchorY,M)/fe:T*fe)/l.aB,ve={getElevation:ee,pitchedLabelPlaneMatrix:R,lineVertexArray:p,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ue,unwrappedTileID:M,width:this.transform.width,height:this.transform.height,translation:Y},ye=Vs(pe,v,c.lineOffsetX*pe,c.lineOffsetY*pe,!1,c,!1,ve);let Se=!1,Re=!1,_e=!0;if(ye){const Ne=.5*$*fe+G,We=new l.P(-100,-100),Ve=new l.P(this.screenRightBoundary,this.screenBottomBoundary),$e=new ci,Xe=ye.first,Mt=ye.last;let vt=[];for(let bn=Xe.path.length-1;bn>=1;bn--)vt.push(Xe.path[bn]);for(let bn=1;bn<Mt.path.length;bn++)vt.push(Mt.path[bn]);const ct=2.5*Ne;if(j){const bn=this.projectPathToScreenSpace(vt,ve);vt=bn.some(jn=>jn.signedDistanceFromCamera<=0)?[]:bn.map(jn=>jn.point)}let Bt=[];if(vt.length>0){const bn=vt[0].clone(),jn=vt[0].clone();for(let zi=1;zi<vt.length;zi++)bn.x=Math.min(bn.x,vt[zi].x),bn.y=Math.min(bn.y,vt[zi].y),jn.x=Math.max(jn.x,vt[zi].x),jn.y=Math.max(jn.y,vt[zi].y);Bt=bn.x>=We.x&&jn.x<=Ve.x&&bn.y>=We.y&&jn.y<=Ve.y?[vt]:jn.x<We.x||bn.x>Ve.x||jn.y<We.y||bn.y>Ve.y?[]:l.ay([vt],We.x,We.y,Ve.x,Ve.y)}for(const bn of Bt){$e.reset(bn,.25*Ne);let jn=0;jn=$e.length<=.5*Ne?1:Math.ceil($e.paddedLength/ct)+1;for(let zi=0;zi<jn;zi++){const qn=zi/Math.max(jn-1,1),Ci=$e.lerp(qn),ji=Ci.x+Hi,pi=Ci.y+Hi;he.push(ji,pi,Ne,0);const un=ji-Ne,yr=pi-Ne,Ji=ji+Ne,Er=pi+Ne;if(_e=_e&&this.isOffscreen(un,yr,Ji,Er),Re=Re||this.isInsideGrid(un,yr,Ji,Er),t!=="always"&&this.grid.hitTestCircle(ji,pi,Ne,t,U)&&(Se=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Se}}}}return{circles:!P&&Se||!Re||fe<this.perspectiveRatioCutoff?[]:he,offscreen:_e,collisionDetected:Se}}projectPathToScreenSpace(t,c){const p=function(v,T){const M=l.L();return l.aq(M,T.pitchedLabelPlaneMatrix),v.map(R=>{const P=Pi(R.x,R.y,M,T.getElevation),j=T.transform.projectTileCoordinates(P.point.x,P.point.y,T.unwrappedTileID,T.getElevation);return j.point.x=(.5*j.point.x+.5)*T.width,j.point.y=(.5*-j.point.y+.5)*T.height,j})}(t,c);return function(v){let T=0,M=0,R=0,P=0;for(let j=0;j<v.length;j++)v[j].isOccluded?(R=j+1,P=0):(P++,P>M&&(M=P,T=R));return v.slice(T,T+M)}(p)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[],p=new l.a2;for(const $ of t){const G=new l.P($.x+Hi,$.y+Hi);p.extend(G),c.push(G)}const{minX:v,minY:T,maxX:M,maxY:R}=p,P=this.grid.query(v,T,M,R).concat(this.ignoredGrid.query(v,T,M,R)),j={},U={};for(const $ of P){const G=$.key;if(j[G.bucketInstanceId]===void 0&&(j[G.bucketInstanceId]={}),j[G.bucketInstanceId][G.featureIndex])continue;const Y=[new l.P($.x1,$.y1),new l.P($.x2,$.y1),new l.P($.x2,$.y2),new l.P($.x1,$.y2)];l.az(c,Y)&&(j[G.bucketInstanceId][G.featureIndex]=!0,U[G.bucketInstanceId]===void 0&&(U[G.bucketInstanceId]=[]),U[G.bucketInstanceId].push(G.featureIndex))}return U}insertCollisionBox(t,c,p,v,T,M){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:T,collisionGroupID:M,overlapMode:c},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,c,p,v,T,M){const R=p?this.ignoredGrid:this.grid,P={bucketInstanceId:v,featureIndex:T,collisionGroupID:M,overlapMode:c};for(let j=0;j<t.length;j+=4)R.insertCircle(P,t[j],t[j+1],t[j+2])}projectAndGetPerspectiveRatio(t,c,p,v,T){if(T){let M;v?(M=[t,c,v(t,c),1],l.aw(M,M,T)):(M=[t,c,0,1],Kl(M,M,T));const R=M[3];return{x:(M[0]/R+1)/2*this.transform.width+Hi,y:(-M[1]/R+1)/2*this.transform.height+Hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R*.5,isOccluded:!1,signedDistanceFromCamera:R}}{const M=this.transform.projectTileCoordinates(t,c,p,v);return{x:(M.point.x+1)/2*this.transform.width+Hi,y:(1-M.point.y)/2*this.transform.height+Hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M.signedDistanceFromCamera*.5,isOccluded:M.isOccluded,signedDistanceFromCamera:M.signedDistanceFromCamera}}}getPerspectiveRatio(t,c,p,v){const T=this.transform.projectTileCoordinates(t,c,p,v);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(t,c,p,v){return p<Hi||t>=this.screenRightBoundary||v<Hi||c>this.screenBottomBoundary}isInsideGrid(t,c,p,v){return p>=0&&t<this.gridRightBoundary&&v>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const t=l.ag([]);return l.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,c,p,v,T,M,R,P,j,U,$){let G=1,Y=0,ee=0,he=1;const ue=t.anchorPointX+R[0],fe=t.anchorPointY+R[1];if(M&&!T){const vt=this.projectAndGetPerspectiveRatio(ue+1,fe,v,j,$),ct=vt.x-P.x,Bt=Math.atan((vt.y-P.y)/ct)+(ct<0?Math.PI:0),bn=Math.sin(Bt),jn=Math.cos(Bt);G=jn,Y=bn,ee=-bn,he=jn}else if(!M&&T){const vt=an(this.transform);G=vt.vecEast[0],Y=vt.vecEast[1],ee=vt.vecSouth[0],he=vt.vecSouth[1]}let pe=P.x,ve=P.y,ye=c;T&&(pe=ue,ve=fe,ye=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),ye*=this.transform.getPitchedTextCorrection(ue,fe,v),U||(ye*=l.ah(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(pe+=G*U.x*ye+ee*U.y*ye,ve+=Y*U.x*ye+he*U.y*ye);const Se=t.x1*ye,Re=t.x2*ye,_e=(Se+Re)/2,Ne=t.y1*ye,We=t.y2*ye,Ve=(Ne+We)/2,$e=[{offsetX:Se,offsetY:Ne},{offsetX:_e,offsetY:Ne},{offsetX:Re,offsetY:Ne},{offsetX:Re,offsetY:Ve},{offsetX:Re,offsetY:We},{offsetX:_e,offsetY:We},{offsetX:Se,offsetY:We},{offsetX:Se,offsetY:Ve}];let Xe=[];for(const{offsetX:vt,offsetY:ct}of $e)Xe.push(new l.P(pe+G*vt+ee*ct,ve+Y*vt+he*ct));let Mt=!1;if(T){const vt=Xe.map(ct=>this.projectAndGetPerspectiveRatio(ct.x,ct.y,v,j,$));Mt=vt.some(ct=>!ct.isOccluded),Xe=vt.map(ct=>new l.P(ct.x,ct.y))}else Mt=!0;return{box:l.aA(Xe),allPointsOccluded:!Mt}}}class $r{constructor(t,c,p,v){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?c:-c))):v&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ei{constructor(t,c,p,v,T){this.text=new $r(t?t.text:null,c,p,T),this.icon=new $r(t?t.icon:null,c,v,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gs{constructor(t,c,p){this.text=t,this.icon=c,this.skipFade=p}}class Jl{constructor(t,c,p,v,T){this.bucketInstanceId=t,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=T}}class Dd{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const c=++this.maxGroupID;this.collisionGroups[t]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[t]}}function $a(b,t,c,p,v){const{horizontalAlign:T,verticalAlign:M}=l.aH(b);return new l.P(-(T-.5)*t+p[0]*v,-(M-.5)*c+p[1]*v)}class ys{constructor(t,c,p,v,T){this.transform=t.clone(),this.terrain=c,this.collisionIndex=new Cd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Dd(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const c=this.terrain;return c?(p,v)=>c.getElevation(t,p,v):null}getBucketParts(t,c,p,v){const T=p.getBucket(c),M=p.latestFeatureIndex;if(!T||!M||c.id!==T.layerIds[0])return;const R=p.collisionBoxArray,P=T.layers[0].layout,j=T.layers[0].paint,U=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),$=p.tileSize/l.$,G=p.tileID.toUnwrapped(),Y=P.get("text-rotation-alignment")==="map",ee=l.aC(p,1,this.transform.zoom),he=l.aD(this.collisionIndex.transform,p,j.get("text-translate"),j.get("text-translate-anchor")),ue=l.aD(this.collisionIndex.transform,p,j.get("icon-translate"),j.get("icon-translate-anchor")),fe=di(Y,this.transform,ee);this.retainedQueryData[T.bucketInstanceId]=new Jl(T.bucketInstanceId,M,T.sourceLayerIndex,T.index,p.tileID);const pe={bucket:T,layout:P,translationText:he,translationIcon:ue,unwrappedTileID:G,pitchedLabelPlaneMatrix:fe,scale:U,textPixelRatio:$,holdingForFade:p.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:l.an(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(v)for(const ve of T.sortKeyRanges){const{sortKey:ye,symbolInstanceStart:Se,symbolInstanceEnd:Re}=ve;t.push({sortKey:ye,symbolInstanceStart:Se,symbolInstanceEnd:Re,parameters:pe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(t,c,p,v,T,M,R,P,j,U,$,G,Y,ee,he,ue,fe,pe,ve,ye){const Se=l.aE[t.textAnchor],Re=[t.textOffset0,t.textOffset1],_e=$a(Se,p,v,Re,T),Ne=this.collisionIndex.placeCollisionBox(c,G,P,j,U,R,M,ue,$.predicate,ve,_e,ye);if((!pe||this.collisionIndex.placeCollisionBox(pe,G,P,j,U,R,M,fe,$.predicate,ve,_e,ye).placeable)&&Ne.placeable){let We;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(We=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Re,width:p,height:v,anchor:Se,textBoxScale:T,prevAnchor:We},this.markUsedJustification(ee,Se,Y,he),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,he,Y),this.placedOrientations[Y.crossTileID]=he),{shift:_e,placedGlyphBoxes:Ne}}}placeLayerBucketPart(t,c,p){const{bucket:v,layout:T,translationText:M,translationIcon:R,unwrappedTileID:P,pitchedLabelPlaneMatrix:j,textPixelRatio:U,holdingForFade:$,collisionBoxArray:G,partiallyEvaluatedTextSize:Y,collisionGroup:ee}=t.parameters,he=T.get("text-optional"),ue=T.get("icon-optional"),fe=l.aF(T,"text-overlap","text-allow-overlap"),pe=fe==="always",ve=l.aF(T,"icon-overlap","icon-allow-overlap"),ye=ve==="always",Se=T.get("text-rotation-alignment")==="map",Re=T.get("text-pitch-alignment")==="map",_e=T.get("icon-text-fit")!=="none",Ne=T.get("symbol-z-order")==="viewport-y",We=pe&&(ye||!v.hasIconData()||ue),Ve=ye&&(pe||!v.hasTextData()||he);!v.collisionArrays&&G&&v.deserializeCollisionBoxes(G);const $e=this.retainedQueryData[v.bucketInstanceId].tileID,Xe=this._getTerrainElevationFunc($e),Mt=this.transform.getFastPathSimpleProjectionMatrix($e),vt=(ct,Bt,bn)=>{var jn,zi;if(c[ct.crossTileID])return;if($)return void(this.placements[ct.crossTileID]=new gs(!1,!1,!1));let qn=!1,Ci=!1,ji=!0,pi=null,un={box:null,placeable:!1,offscreen:null,occluded:!1},yr={placeable:!1},Ji=null,Er=null,Ta=null,zl=0,xo=0,wo=0;Bt.textFeatureIndex?zl=Bt.textFeatureIndex:ct.useRuntimeCollisionCircles&&(zl=ct.featureIndex),Bt.verticalTextFeatureIndex&&(xo=Bt.verticalTextFeatureIndex);const ol=Bt.textBox;if(ol){const la=_i=>{let Xi=l.ao.horizontal;if(v.allowVerticalPlacement&&!_i&&this.prevPlacement){const ca=this.prevPlacement.placedOrientations[ct.crossTileID];ca&&(this.placedOrientations[ct.crossTileID]=ca,Xi=ca,this.markUsedOrientation(v,Xi,ct))}return Xi},$o=(_i,Xi)=>{if(v.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&Bt.verticalTextBox){for(const ca of v.writingModes)if(ca===l.ao.vertical?(un=Xi(),yr=un):un=_i(),un&&un.placeable)break}else un=_i()},Zo=ct.textAnchorOffsetStartIndex,no=ct.textAnchorOffsetEndIndex;if(no===Zo){const _i=(Xi,ca)=>{const er=this.collisionIndex.placeCollisionBox(Xi,fe,U,$e,P,Re,Se,M,ee.predicate,Xe,void 0,Mt);return er&&er.placeable&&(this.markUsedOrientation(v,ca,ct),this.placedOrientations[ct.crossTileID]=ca),er};$o(()=>_i(ol,l.ao.horizontal),()=>{const Xi=Bt.verticalTextBox;return v.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&Xi?_i(Xi,l.ao.vertical):{box:null,offscreen:null}}),la(un&&un.placeable)}else{let _i=l.aE[(zi=(jn=this.prevPlacement)===null||jn===void 0?void 0:jn.variableOffsets[ct.crossTileID])===null||zi===void 0?void 0:zi.anchor];const Xi=(er,wu,Tu)=>{const Ec=er.x2-er.x1,Pa=er.y2-er.y1,To=ct.textBoxScale,Mr=_e&&ve==="never"?wu:null;let Qr=null,Sa=fe==="never"?1:2,lp="never";_i&&Sa++;for(let Cs=0;Cs<Sa;Cs++){for(let io=Zo;io<no;io++){const sr=v.textAnchorOffsets.get(io);if(_i&&sr.textAnchor!==_i)continue;const So=this.attemptAnchorPlacement(sr,er,Ec,Pa,To,Se,Re,U,$e,P,ee,lp,ct,v,Tu,M,R,Mr,Xe);if(So&&(Qr=So.placedGlyphBoxes,Qr&&Qr.placeable))return qn=!0,pi=So.shift,Qr}_i?_i=null:lp=fe}return p&&!Qr&&(Qr={box:this.collisionIndex.placeCollisionBox(ol,"always",U,$e,P,Re,Se,M,ee.predicate,Xe,void 0,Mt).box,offscreen:!1,placeable:!1,occluded:!1}),Qr};$o(()=>Xi(ol,Bt.iconBox,l.ao.horizontal),()=>{const er=Bt.verticalTextBox;return v.allowVerticalPlacement&&(!un||!un.placeable)&&ct.numVerticalGlyphVertices>0&&er?Xi(er,Bt.verticalIconBox,l.ao.vertical):{box:null,occluded:!0,offscreen:null}}),un&&(qn=un.placeable,ji=un.offscreen);const ca=la(un&&un.placeable);if(!qn&&this.prevPlacement){const er=this.prevPlacement.variableOffsets[ct.crossTileID];er&&(this.variableOffsets[ct.crossTileID]=er,this.markUsedJustification(v,er.anchor,ct,ca))}}}if(Ji=un,qn=Ji&&Ji.placeable,ji=Ji&&Ji.offscreen,ct.useRuntimeCollisionCircles){const la=v.text.placedSymbolArray.get(ct.centerJustifiedTextSymbolIndex),$o=l.ap(v.textSizeData,Y,la),Zo=T.get("text-padding");Er=this.collisionIndex.placeCollisionCircles(fe,la,v.lineVertexArray,v.glyphOffsetArray,$o,P,j,p,Re,ee.predicate,ct.collisionCircleDiameter,Zo,M,Xe),Er.circles.length&&Er.collisionDetected&&!p&&l.w("Collisions detected, but collision boxes are not shown"),qn=pe||Er.circles.length>0&&!Er.collisionDetected,ji=ji&&Er.offscreen}if(Bt.iconFeatureIndex&&(wo=Bt.iconFeatureIndex),Bt.iconBox){const la=$o=>this.collisionIndex.placeCollisionBox($o,ve,U,$e,P,Re,Se,R,ee.predicate,Xe,_e&&pi?pi:void 0,Mt);yr&&yr.placeable&&Bt.verticalIconBox?(Ta=la(Bt.verticalIconBox),Ci=Ta.placeable):(Ta=la(Bt.iconBox),Ci=Ta.placeable),ji=ji&&Ta.offscreen}const Tc=he||ct.numHorizontalGlyphVertices===0&&ct.numVerticalGlyphVertices===0,Sc=ue||ct.numIconVertices===0;Tc||Sc?Sc?Tc||(Ci=Ci&&qn):qn=Ci&&qn:Ci=qn=Ci&&qn;const As=Ci&&Ta.placeable;if(qn&&Ji.placeable&&this.collisionIndex.insertCollisionBox(Ji.box,fe,T.get("text-ignore-placement"),v.bucketInstanceId,yr&&yr.placeable&&xo?xo:zl,ee.ID),As&&this.collisionIndex.insertCollisionBox(Ta.box,ve,T.get("icon-ignore-placement"),v.bucketInstanceId,wo,ee.ID),Er&&qn&&this.collisionIndex.insertCollisionCircles(Er.circles,fe,T.get("text-ignore-placement"),v.bucketInstanceId,zl,ee.ID),p&&this.storeCollisionData(v.bucketInstanceId,bn,Bt,Ji,Ta,Er),ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ct.crossTileID]=new gs((qn||We)&&!Ji?.occluded,(Ci||Ve)&&!Ta?.occluded,ji||v.justReloaded),c[ct.crossTileID]=!0};if(Ne){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ct=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Bt=ct.length-1;Bt>=0;--Bt){const bn=ct[Bt];vt(v.symbolInstances.get(bn),v.collisionArrays[bn],bn)}}else for(let ct=t.symbolInstanceStart;ct<t.symbolInstanceEnd;ct++)vt(v.symbolInstances.get(ct),v.collisionArrays[ct],ct);v.justReloaded=!1}storeCollisionData(t,c,p,v,T,M){if(p.textBox||p.iconBox){let R,P;this.collisionBoxArrays.has(t)?R=this.collisionBoxArrays.get(t):(R=new Map,this.collisionBoxArrays.set(t,R)),R.has(c)?P=R.get(c):(P={text:null,icon:null},R.set(c,P)),p.textBox&&(P.text=v.box),p.iconBox&&(P.icon=T.box)}if(M){let R=this.collisionCircleArrays[t];R===void 0&&(R=this.collisionCircleArrays[t]=[]);for(let P=0;P<M.circles.length;P+=4)R.push(M.circles[P+0]-Hi),R.push(M.circles[P+1]-Hi),R.push(M.circles[P+2]),R.push(M.collisionDetected?1:0)}}markUsedJustification(t,c,p,v){let T;T=v===l.ao.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[l.aG(c)];const M=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const R of M)R>=0&&(t.text.placedSymbolArray.get(R).crossTileID=T>=0&&R!==T?0:p.crossTileID)}markUsedOrientation(t,c,p){const v=c===l.ao.horizontal||c===l.ao.horizontalOnly?c:0,T=c===l.ao.vertical?c:0,M=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const R of M)t.text.placedSymbolArray.get(R).placedOrientation=v;p.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const v=c?c.symbolFadeChange(t):1,T=c?c.opacities:{},M=c?c.variableOffsets:{},R=c?c.placedOrientations:{};for(const P in this.placements){const j=this.placements[P],U=T[P];U?(this.opacities[P]=new ei(U,v,j.text,j.icon),p=p||j.text!==U.text.placed||j.icon!==U.icon.placed):(this.opacities[P]=new ei(null,v,j.text,j.icon,j.skipFade),p=p||j.text||j.icon)}for(const P in T){const j=T[P];if(!this.opacities[P]){const U=new ei(j,v,!1,!1);U.isHidden()||(this.opacities[P]=U,p=p||j.text.placed||j.icon.placed)}}for(const P in M)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=M[P]);for(const P in R)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=R[P]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:t)}updateLayerOpacities(t,c){const p={};for(const v of c){const T=v.getBucket(t);T&&v.latestFeatureIndex&&t.id===T.layerIds[0]&&this.updateBucketOpacities(T,v.tileID,p,v.collisionBoxArray)}}updateBucketOpacities(t,c,p,v){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const T=t.layers[0],M=T.layout,R=new ei(null,0,!1,!1,!0),P=M.get("text-allow-overlap"),j=M.get("icon-allow-overlap"),U=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=M.get("text-rotation-alignment")==="map",G=M.get("text-pitch-alignment")==="map",Y=M.get("icon-text-fit")!=="none",ee=new ei(null,0,P&&(j||!t.hasIconData()||M.get("icon-optional")),j&&(P||!t.hasTextData()||M.get("text-optional")),!0);!t.collisionArrays&&v&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(v);const he=(fe,pe,ve)=>{for(let ye=0;ye<pe/4;ye++)fe.opacityVertexArray.emplaceBack(ve);fe.hasVisibleVertices=fe.hasVisibleVertices||ve!==Xc},ue=this.collisionBoxArrays.get(t.bucketInstanceId);for(let fe=0;fe<t.symbolInstances.length;fe++){const pe=t.symbolInstances.get(fe),{numHorizontalGlyphVertices:ve,numVerticalGlyphVertices:ye,crossTileID:Se}=pe;let Re=this.opacities[Se];p[Se]?Re=R:Re||(Re=ee,this.opacities[Se]=Re),p[Se]=!0;const _e=pe.numIconVertices>0,Ne=this.placedOrientations[pe.crossTileID],We=Ne===l.ao.vertical,Ve=Ne===l.ao.horizontal||Ne===l.ao.horizontalOnly;if(ve>0||ye>0){const Xe=qc(Re.text);he(t.text,ve,We?Xc:Xe),he(t.text,ye,Ve?Xc:Xe);const Mt=Re.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach(Bt=>{Bt>=0&&(t.text.placedSymbolArray.get(Bt).hidden=Mt||We?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=Mt||Ve?1:0);const vt=this.variableOffsets[pe.crossTileID];vt&&this.markUsedJustification(t,vt.anchor,pe,Ne);const ct=this.placedOrientations[pe.crossTileID];ct&&(this.markUsedJustification(t,"left",pe,ct),this.markUsedOrientation(t,ct,pe))}if(_e){const Xe=qc(Re.icon),Mt=!(Y&&pe.verticalPlacedIconSymbolIndex&&We);pe.placedIconSymbolIndex>=0&&(he(t.icon,pe.numIconVertices,Mt?Xe:Xc),t.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=Re.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(he(t.icon,pe.numVerticalIconVertices,Mt?Xc:Xe),t.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}const $e=ue&&ue.has(fe)?ue.get(fe):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Xe=t.collisionArrays[fe];if(Xe){let Mt=new l.P(0,0);if(Xe.textBox||Xe.verticalTextBox){let vt=!0;if(U){const ct=this.variableOffsets[Se];ct?(Mt=$a(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),$&&Mt._rotate(G?-this.transform.bearingInRadians:this.transform.bearingInRadians)):vt=!1}if(Xe.textBox||Xe.verticalTextBox){let ct;Xe.textBox&&(ct=We),Xe.verticalTextBox&&(ct=Ve),ah(t.textCollisionBox.collisionVertexArray,Re.text.placed,!vt||ct,$e.text,Mt.x,Mt.y)}}if(Xe.iconBox||Xe.verticalIconBox){const vt=!!(!Ve&&Xe.verticalIconBox);let ct;Xe.iconBox&&(ct=vt),Xe.verticalIconBox&&(ct=!vt),ah(t.iconCollisionBox.collisionVertexArray,Re.icon.placed,ct,$e.icon,Y?Mt.x:0,Y?Mt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>t}setStale(){this.stale=!0}}function ah(b,t,c,p,v,T){p&&p.length!==0||(p=[0,0,0,0]);const M=p[0]-Hi,R=p[1]-Hi,P=p[2]-Hi,j=p[3]-Hi;b.emplaceBack(t?1:0,c?1:0,v||0,T||0,M,R),b.emplaceBack(t?1:0,c?1:0,v||0,T||0,P,R),b.emplaceBack(t?1:0,c?1:0,v||0,T||0,P,j),b.emplaceBack(t?1:0,c?1:0,v||0,T||0,M,j)}const em=Math.pow(2,25),Bf=Math.pow(2,24),Zr=Math.pow(2,17),Uf=Math.pow(2,16),iy=Math.pow(2,9),Id=Math.pow(2,8),tm=Math.pow(2,1);function qc(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const t=b.placed?1:0,c=Math.floor(127*b.opacity);return c*em+t*Bf+c*Zr+t*Uf+c*iy+t*Id+c*tm+t}const Xc=0;class Ra{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,c,p,v,T){const M=this._bucketParts;for(;this._currentTileIndex<t.length;)if(c.getBucketParts(M,v,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((R,P)=>R.sortKey-P.sortKey));this._currentPartIndex<M.length;)if(c.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,T())return!0;return!1}}class oh{constructor(t,c,p,v,T,M,R,P){this.placement=new ys(t,c,M,R,P),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(t,c,p){const v=F.now(),T=()=>!this._forceFullPlacement&&F.now()-v>2;for(;this._currentPlacementIndex>=0;){const M=c[t[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=R)&&(!M.maxzoom||M.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Ra(M)),this._inProgressLayer.continuePlacement(p[M.source],this.placement,this._showCollisionBoxes,M,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ec=512/l.$/2;class sh{constructor(t,c,p){this.tileID=t,this.bucketInstanceId=p,this._symbolsByKey={};const v=new Map;for(let T=0;T<c.length;T++){const M=c.get(T),R=M.key,P=v.get(R);P?P.push(M):v.set(R,[M])}for(const[T,M]of v){const R={positions:M.map(P=>({x:Math.floor(P.anchorX*ec),y:Math.floor(P.anchorY*ec)})),crossTileIDs:M.map(P=>P.crossTileID)};if(R.positions.length>128){const P=new l.aI(R.positions.length,16,Uint16Array);for(const{x:j,y:U}of R.positions)P.add(j,U);P.finish(),delete R.positions,R.index=P}this._symbolsByKey[T]=R}}getScaledCoordinates(t,c){const{x:p,y:v,z:T}=this.tileID.canonical,{x:M,y:R,z:P}=c.canonical,j=ec/Math.pow(2,P-T),U=(R*l.$+t.anchorY)*j,$=v*l.$*ec;return{x:Math.floor((M*l.$+t.anchorX)*j-p*l.$*ec),y:Math.floor(U-$)}}findMatches(t,c,p){const v=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let T=0;T<t.length;T++){const M=t.get(T);if(M.crossTileID)continue;const R=this._symbolsByKey[M.key];if(!R)continue;const P=this.getScaledCoordinates(M,c);if(R.index){const j=R.index.range(P.x-v,P.y-v,P.x+v,P.y+v).sort();for(const U of j){const $=R.crossTileIDs[U];if(!p[$]){p[$]=!0,M.crossTileID=$;break}}}else if(R.positions)for(let j=0;j<R.positions.length;j++){const U=R.positions[j],$=R.crossTileIDs[j];if(Math.abs(U.x-P.x)<=v&&Math.abs(U.y-P.y)<=v&&!p[$]){p[$]=!0,M.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class bl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class nm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const c=Math.round((t-this.lng)/360);if(c!==0)for(const p in this.indexes){const v=this.indexes[p],T={};for(const M in v){const R=v[M];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+c),T[R.tileID.key]=R}this.indexes[p]=T}this.lng=t}addBucket(t,c,p){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let T=0;T<c.symbolInstances.length;T++)c.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const v=this.usedCrossTileIDs[t.overscaledZ];for(const T in this.indexes){const M=this.indexes[T];if(Number(T)>t.overscaledZ)for(const R in M){const P=M[R];P.tileID.isChildOf(t)&&P.findMatches(c.symbolInstances,t,v)}else{const R=M[t.scaledTo(Number(T)).key];R&&R.findMatches(c.symbolInstances,t,v)}}for(let T=0;T<c.symbolInstances.length;T++){const M=c.symbolInstances.get(T);M.crossTileID||(M.crossTileID=p.generate(),v[M.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new sh(t,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(t,c){for(const p of c.getCrossTileIDsLists())for(const v of p)delete this.usedCrossTileIDs[t][v]}removeStaleBuckets(t){let c=!1;for(const p in this.indexes){const v=this.indexes[p];for(const T in v)t[v[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[T]),delete v[T],c=!0)}return c}}class tc{constructor(){this.layerIndexes={},this.crossTileIDs=new bl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,c,p){let v=this.layerIndexes[t.id];v===void 0&&(v=this.layerIndexes[t.id]=new nm);let T=!1;const M={};v.handleWrapJump(p);for(const R of c){const P=R.getBucket(t);P&&t.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(R.tileID,P,this.crossTileIDs)&&(T=!0),M[P.bucketInstanceId]=!0)}return v.removeStaleBuckets(M)&&(T=!0),T}pruneUnusedLayers(t){const c={};t.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}var _s="void main() {fragColor=vec4(1.0);}";const No={prelude:En(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:En("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:En("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:En(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:En(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:En(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:En(_s,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:En(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:En(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:En("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:En("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:En(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:En("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:En(_s,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:En(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:En(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:En(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:En(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:En(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:En(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:En(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:En(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:En(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:En(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:En(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:En(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:En(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:En(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:En(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:En(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:En("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:En("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:En("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:En("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:En(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:En("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function En(b,t){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=t.match(/in ([\w]+) ([\w]+)/g),v=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=T?T.concat(v):v,R={};return{fragmentSource:b=b.replace(c,(P,j,U,$,G)=>(R[G]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${G}
in ${U} ${$} ${G};
#else
uniform ${U} ${$} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${U} ${$} ${G} = u_${G};
#endif
`)),vertexSource:t=t.replace(c,(P,j,U,$,G)=>{const Y=$==="float"?"vec2":"vec4",ee=G.match(/color/)?"color":Y;return R[G]?j==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${U} ${Y} a_${G};
out ${U} ${$} ${G};
#else
uniform ${U} ${$} u_${G};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${U} ${$} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${ee}(a_${G}, u_${G}_t);
#else
    ${U} ${$} ${G} = u_${G};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${U} ${Y} a_${G};
#else
uniform ${U} ${$} u_${G};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${U} ${$} ${G} = a_${G};
#else
    ${U} ${$} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${U} ${$} ${G} = unpack_mix_${ee}(a_${G}, u_${G}_t);
#else
    ${U} ${$} ${G} = u_${G};
#endif
`}),staticAttributes:p,staticUniforms:M}}class xl{constructor(t,c,p){this.vertexBuffer=t,this.indexBuffer=c,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var vs=l.aJ([{name:"a_pos",type:"Int16",components:2}]);const $s="#define PROJECTION_MERCATOR",nc="mercator";class xn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return nc}get shaderDefine(){return $s}get shaderPreludeCode(){return No.projectionMercator}get vertexShaderPreludeCode(){return No.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,c,p,v,T){if(this._cachedMesh)return this._cachedMesh;const M=new l.aL;M.emplaceBack(0,0),M.emplaceBack(l.$,0),M.emplaceBack(0,l.$),M.emplaceBack(l.$,l.$);const R=t.createVertexBuffer(M,vs.members),P=l.aM.simpleSegment(0,0,4,2),j=new l.aN;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);const U=t.createIndexBuffer(j);return this._cachedMesh=new xl(R,U,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class Zs{constructor(t=0,c=0,p=0,v=0){if(isNaN(t)||t<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=c,this.left=p,this.right=v}interpolate(t,c,p){return c.top!=null&&t.top!=null&&(this.top=l.C.number(t.top,c.top,p)),c.bottom!=null&&t.bottom!=null&&(this.bottom=l.C.number(t.bottom,c.bottom,p)),c.left!=null&&t.left!=null&&(this.left=l.C.number(t.left,c.left,p)),c.right!=null&&t.right!=null&&(this.right=l.C.number(t.right,c.right,p)),this}getCenter(t,c){const p=l.ah((this.left+t-this.right)/2,0,t),v=l.ah((this.top+c-this.bottom)/2,0,c);return new l.P(p,v)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Zs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Wc(b,t){if(!b.renderWorldCopies||b.lngRange)return;const c=t.lng-b.center.lng;t.lng+=c>180?-360:c<-180?360:0}function Ys(b){return Math.max(0,Math.floor(b))}class pr{constructor(t,c,p,v,T,M){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=M===void 0||!!M,this._minZoom=c||0,this._maxZoom=p||22,this._minPitch=v??0,this._maxPitch=T??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ys(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Zs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,c,p){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Ys(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new Zs(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!p&&t.autoCalculateNearFarZ,c&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const c=l.aO(t,-180,180)*Math.PI/180;var p,v,T,M,R,P,j,U,$;this._bearingInRadians!==c&&(this._unmodified=!1,this._bearingInRadians=c,this._calcMatrices(),this._rotationMatrix=C(),p=this._rotationMatrix,T=-this._bearingInRadians,M=(v=this._rotationMatrix)[0],R=v[1],P=v[2],j=v[3],U=Math.sin(T),$=Math.cos(T),p[0]=M*$+P*U,p[1]=R*$+j*U,p[2]=M*-U+P*$,p[3]=R*-U+j*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const c=l.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==c&&(this._unmodified=!1,this._pitchInRadians=c,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const c=t/180*Math.PI;this._rollInRadians!==c&&(this._unmodified=!1,this._rollInRadians=c,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aP(this._fovInRadians)}setFov(t){t=l.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=l.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const c=this.getConstrained(this._center,t).zoom;this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this._tileZoom=Math.max(0,Math.floor(c)),this._scale=l.af(c),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,c){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=c,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,c,p){this._unmodified=!1,this._edgeInsets.interpolate(t,c,p),this._constrain(),this._calcMatrices()}resize(t,c,p=!0){this._width=t,this._height=c,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Un([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-l.ai,l.ai])}getConstrained(t,c){return this._callbacks.getConstrained(t,c)}getCameraQueryGeometry(t,c){if(c.length===1)return[c[0],t];{const{minX:p,minY:v,maxX:T,maxY:M}=l.a2.fromPoints(c).extend(t);return[new l.P(p,v),new l.P(T,v),new l.P(T,M),new l.P(p,M),new l.P(p,v)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:c,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(c),this.setZoom(p),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=l.ag(new Float64Array(16));l.N(t,t,[this._width/2,-this._height/2,1]),l.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=l.ag(new Float64Array(16)),l.N(t,t,[1,-1,1]),l.M(t,t,[-1,-1,0]),l.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,c,p,v){const T=p!==void 0?p:this.bearing,M=v=v!==void 0?v:this.pitch,R=l.a1.fromLngLat(t,c),P=-Math.cos(l.ae(M)),j=Math.sin(l.ae(M)),U=j*Math.sin(l.ae(T)),$=-j*Math.cos(l.ae(T));let G=this.elevation;const Y=c-G;let ee;P*Y>=0||Math.abs(P)<.1?(ee=1e4,G=c+ee*P):ee=-Y/P;let he,ue,fe=l.aQ(1,R.y),pe=0;do{if(pe+=1,pe>10)break;ue=ee/fe,he=new l.a1(R.x+U*ue,R.y+$*ue),fe=1/he.meterInMercatorCoordinateUnits()}while(Math.abs(ee-ue*fe)>1e-12);return{center:he.toLngLat(),elevation:G,zoom:l.ak(this.height/2/Math.tan(this.fovInRadians/2)/ue/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const c=l.aj(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/c,v=l.a1.fromLngLat(this.center,this.elevation),T=Ye(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=t;const M=this.calculateCenterFromCameraLngLatAlt(T.toLngLat(),l.aQ(T.z,v.y),this.bearing,this.pitch);this._elevation=M.elevation,this._center=M.center,this.setZoom(M.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=l.aj(1,this.center.lat)*this.worldSize;return Ye(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const c=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/c,t.canonical.y/c,1/c/l.$,1/c/l.$]}}class Tr{constructor(t,c){this.min=t,this.max=c,this.center=l.aR([],l.aS([],this.min,this.max),.5)}quadrant(t){const c=[t%2==0,t<2],p=l.aT(this.min),v=l.aT(this.max);for(let T=0;T<c.length;T++)p[T]=c[T]?this.min[T]:this.center[T],v[T]=c[T]?this.center[T]:this.max[T];return v[2]=this.max[2],new Tr(p,v)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let c=!0;for(let p=0;p<t.planes.length;p++){const v=this.intersectsPlane(t.planes[p]);if(v===0)return 0;v===1&&(c=!1)}return c?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let c=t[3],p=t[3];for(let v=0;v<3;v++)t[v]>0?(c+=t[v]*this.min[v],p+=t[v]*this.max[v]):(p+=t[v]*this.min[v],c+=t[v]*this.max[v]);return c>=0?2:p<0?0:1}}class Yr{distanceToTile2d(t,c,p,v){const T=v.distanceX([t,c]),M=v.distanceY([t,c]);return Math.hypot(T,M)}getWrap(t,c,p){return p}getTileBoundingVolume(t,c,p,v){var T,M;let R=0,P=0;if(v?.terrain){const U=new l.Z(t.z,c,t.z,t.x,t.y),$=v.terrain.getMinMaxElevation(U);R=(T=$.minElevation)!==null&&T!==void 0?T:Math.min(0,p),P=(M=$.maxElevation)!==null&&M!==void 0?M:Math.max(0,p)}const j=1<<t.z;return new Tr([c+t.x/j,t.y/j,R],[c+(t.x+1)/j,(t.y+1)/j,P])}allowVariableZoom(t,c){const p=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,v=l.ah(78.5-p/2,0,60);return!!c.terrain||t.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class ar{constructor(t,c,p){this.points=t,this.planes=c,this.aabb=p}static fromInvProjectionMatrix(t,c=1,p=0,v,T){const M=T?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],R=Math.pow(2,p),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(G=>function(Y,ee,he,ue){const fe=l.aw([],Y,ee),pe=1/fe[3]/he*ue;return l.aY(fe,fe,[pe,pe,1/fe[3],pe])}(G,t,c,R));v&&function(G,Y,ee,he){const ue=he?4:0,fe=he?0:4;let pe=0;const ve=[],ye=[];for(let _e=0;_e<4;_e++){const Ne=l.aU([],G[_e+fe],G[_e+ue]),We=l.aZ(Ne);l.aR(Ne,Ne,1/We),ve.push(We),ye.push(Ne)}for(let _e=0;_e<4;_e++){const Ne=l.a_(G[_e+ue],ye[_e],ee);pe=Ne!==null&&Ne>=0?Math.max(pe,Ne):Math.max(pe,ve[_e])}const Se=function(_e,Ne){const We=l.aU([],_e[Ne[0]],_e[Ne[1]]),Ve=l.aU([],_e[Ne[2]],_e[Ne[1]]),$e=[0,0,0,0];return l.aV($e,l.aW([],We,Ve)),$e[3]=-l.aX($e,_e[Ne[0]]),$e}(G,Y),Re=function(_e,Ne){const We=l.a$(_e),Ve=l.b0([],_e,1/We),$e=l.aU([],Ne,l.aR([],Ve,l.aX(Ne,Ve))),Xe=l.a$($e);if(Xe>0){const Mt=Math.sqrt(1-Ve[3]*Ve[3]),vt=l.aR([],Ve,-Ve[3]),ct=l.aS([],vt,l.aR([],$e,Mt/Xe));return l.b1(Ne,ct)}return null}(ee,Se);if(Re!==null){const _e=Re/l.aX(ye[0],Se);pe=Math.min(pe,_e)}for(let _e=0;_e<4;_e++){const Ne=Math.min(pe,ve[_e]);G[_e+fe]=[G[_e+ue][0]+ye[_e][0]*Ne,G[_e+ue][1]+ye[_e][1]*Ne,G[_e+ue][2]+ye[_e][2]*Ne,1]}}(P,M[0],v,T);const j=M.map(G=>{const Y=l.aU([],P[G[0]],P[G[1]]),ee=l.aU([],P[G[2]],P[G[1]]),he=l.aV([],l.aW([],Y,ee)),ue=-l.aX(he,P[G[1]]);return he.concat(ue)}),U=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const G of P)for(let Y=0;Y<3;Y++)U[Y]=Math.min(U[Y],G[Y]),$[Y]=Math.max($[Y],G[Y]);return new ar(P,j,new Tr(U,$))}}class Wn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,c,p){return this._helper.interpolatePadding(t,c,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,c,p=!0){this._helper.resize(t,c,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,c){this._helper.overrideNearFarZ(t,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,c){}constructor(t,c,p,v,T){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new pr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(M,R)=>this.getConstrained(M,R)},t,c,p,v,T),this._coveringTilesDetailsProvider=new Yr}clone(){const t=new Wn;return t.apply(this),t}apply(t,c,p){this._helper.apply(t,c,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const c=[new l.b2(0,t)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new l.P(0,0)),v=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),T=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),M=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),R=Math.floor(Math.min(p.x,v.x,T.x,M.x)),P=Math.floor(Math.max(p.x,v.x,T.x,M.x)),j=1;for(let U=R-j;U<=P+j;U++)U!==0&&c.push(new l.b2(U,t))}return c}getCameraFrustum(){return ar.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const c=this.screenPointToLocation(this.centerPoint,t),p=t?t.getElevationForLngLatZoom(c,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(t,c){const p=l.aj(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(c,p),T=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),M=l.a1.fromLngLat(t),R=new l.a1(M.x-(v.x-T.x),M.y-(v.y-T.y));this.setCenter(R?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,c){return c?this.coordinatePoint(l.a1.fromLngLat(t),c.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(l.a1.fromLngLat(t))}screenPointToLocation(t,c){var p;return(p=this.screenPointToMercatorCoordinate(t,c))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(t,c){if(c){const p=c.pointCoordinate(t);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,c){const p=c||0,v=[t.x,t.y,0,1],T=[t.x,t.y,1,1];l.aw(v,v,this._pixelMatrixInverse),l.aw(T,T,this._pixelMatrixInverse);const M=v[3],R=T[3],P=v[1]/M,j=T[1]/R,U=v[2]/M,$=T[2]/R,G=U===$?0:(p-U)/($-U);return new l.a1(l.C.number(v[0]/M,T[0]/R,G)/this.worldSize,l.C.number(P,j,G)/this.worldSize,p)}coordinatePoint(t,c=0,p=this._pixelMatrix){const v=[t.x*this.worldSize,t.y*this.worldSize,c,1];return l.aw(v,v,p),new l.P(v[0]/v[3],v[1]/v[3])}getBounds(){const t=Math.max(0,this._helper._height/2-De(this));return new Un().extend(this.screenPointToLocation(new l.P(0,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(t,c){return c?c.pointCoordinate(t)!=null:t.y>this.height/2-De(this)}calculatePosMatrix(t,c=!1,p){var v;const T=(v=t.key)!==null&&v!==void 0?v:l.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),M=c?this._alignedPosMatrixCache:this._posMatrixCache;if(M.has(T)){const j=M.get(T);return p?j.f32:j.f64}const R=Oe(t,this.worldSize);l.O(R,c?this._alignedProjMatrix:this._viewProjMatrix,R);const P={f64:R,f32:new Float32Array(R)};return M.set(T,P),p?P.f32:P.f64}calculateFogMatrix(t){const c=t.key,p=this._fogMatrixCacheF32;if(p.has(c))return p.get(c);const v=Oe(t,this.worldSize);return l.O(v,this._fogMatrix,v),p.set(c,new Float32Array(v)),p.get(c)}getConstrained(t,c){c=l.ah(+c,this.minZoom,this.maxZoom);const p={center:new l.S(t.lng,t.lat),zoom:c};let v=this._helper._lngRange;if(!this._helper._renderWorldCopies&&v===null){const ve=179.9999999999;v=[-ve,ve]}const T=this.tileSize*l.af(p.zoom);let M=0,R=T,P=0,j=T,U=0,$=0;const{x:G,y:Y}=this.size;if(this._helper._latRange){const ve=this._helper._latRange;M=l.U(ve[1])*T,R=l.U(ve[0])*T,R-M<Y&&(U=Y/(R-M))}v&&(P=l.aO(l.V(v[0])*T,0,T),j=l.aO(l.V(v[1])*T,0,T),j<P&&(j+=T),j-P<G&&($=G/(j-P)));const{x:ee,y:he}=le(T,t);let ue,fe;const pe=Math.max($||0,U||0);if(pe){const ve=new l.P($?(j+P)/2:ee,U?(R+M)/2:he);return p.center=be(T,ve).wrap(),p.zoom+=l.ak(pe),p}if(this._helper._latRange){const ve=Y/2;he-ve<M&&(fe=M+ve),he+ve>R&&(fe=R-ve)}if(v){const ve=(P+j)/2;let ye=ee;this._helper._renderWorldCopies&&(ye=l.aO(ee,ve-T/2,ve+T/2));const Se=G/2;ye-Se<P&&(ue=P+Se),ye+Se>j&&(ue=j-Se)}if(ue!==void 0||fe!==void 0){const ve=new l.P(ue??ee,fe??he);p.center=be(T,ve).wrap()}return p}calculateCenterFromCameraLngLatAlt(t,c,p,v){return this._helper.calculateCenterFromCameraLngLatAlt(t,c,p,v)}_calculateNearFarZIfNeeded(t,c,p){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),T=t-v*this._helper._pixelPerMeter/Math.cos(c),M=v<0?T:t,R=Math.PI/2+this.pitchInRadians,P=l.ae(this.fov)*(Math.abs(Math.cos(l.ae(this.roll)))*this.height+Math.abs(Math.sin(l.ae(this.roll)))*this.width)/this.height*(.5+p.y/this.height),j=Math.sin(P)*M/Math.sin(l.ah(Math.PI-R-P,.01,Math.PI-.01)),U=De(this),$=Math.atan(U/this._helper.cameraToCenterDistance),G=l.ae(.75),Y=$>G?2*$*(.5+p.y/(2*U)):G,ee=Math.sin(Y)*M/Math.sin(l.ah(Math.PI-R-Y,.01,Math.PI-.01)),he=Math.min(j,ee);this._helper._farZ=1.01*(Math.cos(Math.PI/2-c)*he+M),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,c=le(this.worldSize,this.center),p=c.x,v=c.y;this._helper._pixelPerMeter=l.aj(1,this.center.lat)*this.worldSize;const T=l.ae(Math.min(this.pitch,ne)),M=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(T));let R;this._calculateNearFarZIfNeeded(M,T,t),R=new Float64Array(16),l.b4(R,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.aq(this._invProjMatrix,R),R[8]=2*-t.x/this._helper._width,R[9]=2*t.y/this._helper._height,this._projectionMatrix=l.b5(R),l.N(R,R,[1,-1,1]),l.M(R,R,[0,0,-this._helper.cameraToCenterDistance]),l.b6(R,R,-this.rollInRadians),l.b7(R,R,this.pitchInRadians),l.b6(R,R,-this.bearingInRadians),l.M(R,R,[-p,-v,0]),this._mercatorMatrix=l.N([],R,[this.worldSize,this.worldSize,this.worldSize]),l.N(R,R,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,R),l.M(R,R,[0,0,-this.elevation]),this._viewProjMatrix=R,this._invViewProjMatrix=l.aq([],R);const P=[0,0,-1,1];l.aw(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),l.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,M,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,l.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.M(this._fogMatrix,this._fogMatrix,[-p,-v,0]),l.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,R);const j=this._helper._width%2/2,U=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),G=Math.sin(-this.bearingInRadians),Y=p-Math.round(p)+$*j+G*U,ee=v-Math.round(v)+$*U+G*j,he=new Float64Array(R);if(l.M(he,he,[Y>.5?Y-1:Y,ee>.5?ee-1:ee,0]),this._alignedProjMatrix=he,R=l.aq(new Float64Array(16),this._pixelMatrix),!R)throw new Error("failed to invert matrix");this._pixelMatrixInverse=R,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new l.P(0,0)),c=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.aw(c,c,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=l.aj(1,this.center.lat)*this.worldSize;return Ye(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,c){const p=l.a1.fromLngLat(t),v=[p.x*this.worldSize,p.y*this.worldSize,c,1];return l.aw(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(t){const{overscaledTileID:c,aligned:p,applyTerrainMatrix:v}=t,T=this._helper.getMercatorTileCoordinates(c),M=c?this.calculatePosMatrix(c,p,!0):null;let R;return R=c&&c.terrainRttPosMatrix32f&&v?c.terrainRttPosMatrix32f:M||l.b8(),{mainMatrix:R,tileMercatorCoords:T,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:R}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,c,p){return 1}transformLightDirection(t){return l.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,c,p,v){const T=this.calculatePosMatrix(p);let M;v?(M=[t,c,v(t,c),1],l.aw(M,M,T)):(M=[t,c,0,1],Kl(M,M,T));const R=M[3];return{point:new l.P(M[0]/R,M[1]/R),signedDistanceFromCamera:R,isOccluded:!1}}populateCache(t){for(const c of t)this.calculatePosMatrix(c)}getMatrixForModel(t,c){const p=l.a1.fromLngLat(t,c),v=p.meterInMercatorCoordinateUnits(),T=l.b9();return l.M(T,T,[p.x,p.y,p.z]),l.b6(T,T,Math.PI),l.b7(T,T,Math.PI/2),l.N(T,T,[-v,v,v]),T}getProjectionDataForCustomLayer(t=!0){const c=new l.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:c,applyGlobeMatrix:t}),v=Oe(c,this.worldSize);l.O(v,this._viewProjMatrix,v),p.tileMercatorCoords=[0,0,1,1];const T=[l.$,l.$,this.worldSize/this._helper.pixelsPerMeter],M=l.ba();return l.N(M,v,T),p.fallbackMatrix=M,p.mainMatrix=M,p}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function bs(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Hr(b){if(b.useSlerp)if(b.k<1){const t=l.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),c=l.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),p=new Float64Array(4);l.bc(p,t,c,b.k);const v=l.bd(p);b.tr.setRoll(v.roll),b.tr.setPitch(v.pitch),b.tr.setBearing(v.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(l.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(l.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(l.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function qr(b,t,c,p,v){const T=v.padding,M=le(v.worldSize,c.getNorthWest()),R=le(v.worldSize,c.getNorthEast()),P=le(v.worldSize,c.getSouthEast()),j=le(v.worldSize,c.getSouthWest()),U=l.ae(-p),$=M.rotate(U),G=R.rotate(U),Y=P.rotate(U),ee=j.rotate(U),he=new l.P(Math.max($.x,G.x,ee.x,Y.x),Math.max($.y,G.y,ee.y,Y.y)),ue=new l.P(Math.min($.x,G.x,ee.x,Y.x),Math.min($.y,G.y,ee.y,Y.y)),fe=he.sub(ue),pe=(v.width-(T.left+T.right+t.left+t.right))/fe.x,ve=(v.height-(T.top+T.bottom+t.top+t.bottom))/fe.y;if(ve<0||pe<0)return void bs();const ye=Math.min(l.ak(v.scale*Math.min(pe,ve)),b.maxZoom),Se=l.P.convert(b.offset),Re=new l.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(l.ae(p)),_e=Se.add(Re).mult(v.scale/l.af(ye));return{center:be(v.worldSize,M.add(P).div(2).sub(_e)),zoom:ye,bearing:p}}class qi{get useGlobeControls(){return!1}handlePanInertia(t,c){const p=t.mag(),v=Math.abs(De(c));return{easingOffset:t.mult(Math.min(.75*v/p,1)),easingCenter:c.center}}handleMapControlsRollPitchBearingZoom(t,c){t.bearingDelta&&c.setBearing(c.bearing+t.bearingDelta),t.pitchDelta&&c.setPitch(c.pitch+t.pitchDelta),t.rollDelta&&c.setRoll(c.roll+t.rollDelta),t.zoomDelta&&c.setZoom(c.zoom+t.zoomDelta)}handleMapControlsPan(t,c,p){t.around.distSqr(c.centerPoint)<.01||c.setLocationAtPoint(p,t.around)}cameraForBoxAndBearing(t,c,p,v,T){return qr(t,c,p,v,T)}handleJumpToCenterZoom(t,c){t.zoom!==(c.zoom!==void 0?+c.zoom:t.zoom)&&t.setZoom(+c.zoom),c.center!==void 0&&t.setCenter(l.S.convert(c.center))}handleEaseTo(t,c){const p=t.zoom,v=t.padding,T={roll:t.roll,pitch:t.pitch,bearing:t.bearing},M={roll:c.roll===void 0?t.roll:c.roll,pitch:c.pitch===void 0?t.pitch:c.pitch,bearing:c.bearing===void 0?t.bearing:c.bearing},R=c.zoom!==void 0,P=!t.isPaddingEqual(c.padding);let j=!1;const U=R?+c.zoom:t.zoom;let $=t.centerPoint.add(c.offsetAsPoint);const G=t.screenPointToLocation($),{center:Y,zoom:ee}=t.getConstrained(l.S.convert(c.center||G),U??p);Wc(t,Y);const he=le(t.worldSize,G),ue=le(t.worldSize,Y).sub(he),fe=l.af(ee-p);return j=ee!==p,{easeFunc:pe=>{if(j&&t.setZoom(l.C.number(p,ee,pe)),l.be(T,M)||Hr({startEulerAngles:T,endEulerAngles:M,tr:t,k:pe,useSlerp:T.roll!=M.roll}),P&&(t.interpolatePadding(v,c.padding,pe),$=t.centerPoint.add(c.offsetAsPoint)),c.around)t.setLocationAtPoint(c.around,c.aroundPoint);else{const ve=l.af(t.zoom-p),ye=ee>p?Math.min(2,fe):Math.max(.5,fe),Se=Math.pow(ye,1-pe),Re=be(t.worldSize,he.add(ue.mult(pe*Se)).mult(ve));t.setLocationAtPoint(t.renderWorldCopies?Re.wrap():Re,$)}},isZooming:j,elevationCenter:Y}}handleFlyTo(t,c){const p=c.zoom!==void 0,v=t.zoom,T=t.getConstrained(l.S.convert(c.center||c.locationAtOffset),p?+c.zoom:v),M=T.center,R=T.zoom;Wc(t,M);const P=le(t.worldSize,c.locationAtOffset),j=le(t.worldSize,M).sub(P),U=j.mag(),$=l.af(R-v);let G;if(c.minZoom!==void 0){const Y=Math.min(+c.minZoom,v,R),ee=t.getConstrained(M,Y).zoom;G=l.af(ee-v)}return{easeFunc:(Y,ee,he,ue)=>{t.setZoom(Y===1?R:v+l.ak(ee));const fe=Y===1?M:be(t.worldSize,P.add(j.mult(he)).mult(ee));t.setLocationAtPoint(t.renderWorldCopies?fe.wrap():fe,ue)},scaleOfZoom:$,targetCenter:M,scaleOfMinZoom:G,pixelPathLength:U}}}class fi{constructor(t,c,p){this.blendFunction=t,this.blendColor=c,this.mask=p}}fi.Replace=[1,0],fi.disabled=new fi(fi.Replace,l.bf.transparent,[!1,!1,!1,!1]),fi.unblended=new fi(fi.Replace,l.bf.transparent,[!0,!0,!0,!0]),fi.alphaBlended=new fi([1,771],l.bf.transparent,[!0,!0,!0,!0]);const xs=2305;class Qt{constructor(t,c,p){this.enable=t,this.mode=c,this.frontFace=p}}Qt.disabled=new Qt(!1,1029,xs),Qt.backCCW=new Qt(!0,1029,xs),Qt.frontCCW=new Qt(!0,1028,xs);class on{constructor(t,c,p){this.func=t,this.mask=c,this.range=p}}on.ReadOnly=!1,on.ReadWrite=!0,on.disabled=new on(519,on.ReadOnly,[0,1]);const po=7680;class Pn{constructor(t,c,p,v,T,M){this.test=t,this.ref=c,this.mask=p,this.fail=v,this.depthFail=T,this.pass=M}}Pn.disabled=new Pn({func:519,mask:0},0,0,po,po,po);const Mi=new WeakMap;function ea(b){var t;if(Mi.has(b))return Mi.get(b);{const c=(t=b.getParameter(b.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Mi.set(b,c),c}}class Za{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const c=t.context,p=c.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const v=new l.aL;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const T=new l.aN;T.emplaceBack(0,1,2),this._fullscreenTriangle=new xl(c.createVertexBuffer(v,vs.members),c.createIndexBuffer(T),l.aM.simpleSegment(0,0,v.length,T.length)),this._resultBuffer=new Uint8Array(4),c.activeTexture.set(p.TEXTURE1);const M=p.createTexture();p.bindTexture(p.TEXTURE_2D,M),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=c.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(M),ea(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,c){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,c),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,c=t.gl;t.activeTexture.set(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,c){const p=this._cachedRenderContext.context,v=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:l.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,v.TRIANGLES,on.disabled,Pn.disabled,fi.unblended,Qt.disabled,((T,M)=>({u_input:T,u_output_expected:M}))(t,c),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ea(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const T=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:T}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ea(t)){const c=t.clientWaitSync(this._readbackQueue.sync,0,0);if(c===t.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(c===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Za._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let c=0;return c+=t[0]/256,c+=t[1]/65536,c+=t[2]/16777216,t[3]<127&&(c=-c),c/128}}const wl=l.$/128;function Vf(b,t){const c=b.granularity!==void 0?Math.max(b.granularity,1):1,p=c+(b.generateBorders?2:0),v=c+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),T=p+1,M=v+1,R=b.generateBorders?-1:0,P=b.generateBorders||b.extendToNorthPole?-1:0,j=c+(b.generateBorders?1:0),U=c+(b.generateBorders||b.extendToSouthPole?1:0),$=T*M,G=p*v*6,Y=T*M>65536;if(Y&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ee=Y||t==="32bit",he=new Int16Array(2*$);let ue=0;for(let ve=P;ve<=U;ve++)for(let ye=R;ye<=j;ye++){let Se=ye/c*l.$;ye===-1&&(Se=-wl),ye===c+1&&(Se=l.$+wl);let Re=ve/c*l.$;ve===-1&&(Re=b.extendToNorthPole?l.bh:-wl),ve===c+1&&(Re=b.extendToSouthPole?l.bi:l.$+wl),he[ue++]=Se,he[ue++]=Re}const fe=ee?new Uint32Array(G):new Uint16Array(G);let pe=0;for(let ve=0;ve<v;ve++)for(let ye=0;ye<p;ye++){const Se=ye+1+ve*T,Re=ye+(ve+1)*T,_e=ye+1+(ve+1)*T;fe[pe++]=ye+ve*T,fe[pe++]=Re,fe[pe++]=Se,fe[pe++]=Se,fe[pe++]=Re,fe[pe++]=_e}return{vertices:he.buffer.slice(0),indices:fe.buffer.slice(0),uses32bitIndices:ee}}const Tl=new l.aK({fill:new l.bj(128,2),line:new l.bj(512,0),tile:new l.bj(128,32),stencil:new l.bj(128,1),circle:3});class ic{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return No.projectionGlobe}get vertexShaderPreludeCode(){return No.projectionMercator.vertexSource}get subdivisionGranularity(){return Tl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Za(t));const c=l.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-c*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(c,p),T=F.now();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=T);const M=Math.min(Math.max((T-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bl(M))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,c,p,v,T){const M=(T==="stencil"?Tl.stencil:Tl.tile).getGranularityForZoomLevel(c.z);return this._getMesh(t,{granularity:M,generateBorders:p,extendToNorthPole:c.y===0&&v,extendToSouthPole:c.y===(1<<c.z)-1&&v})}_getMesh(t,c){const p=this._getMeshKey(c);if(p in this._tileMeshCache)return this._tileMeshCache[p];const v=function(T,M){const R=Vf(M,"16bit"),P=l.aL.deserialize({arrayBuffer:R.vertices,length:R.vertices.byteLength/2/2}),j=l.aN.deserialize({arrayBuffer:R.indices,length:R.indices.byteLength/2/3});return new xl(T.createVertexBuffer(P,vs.members),T.createIndexBuffer(j),l.aM.simpleSegment(0,0,P.length,j.length))}(t,c);return this._tileMeshCache[p]=v,v}recalculate(t){}hasTransition(){const t=F.now();let c=!1;return c=c||(t-this._errorMeasurementLastChangeTime)/1e3<.7,c=c||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,c}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Sl=new l.r({type:new l.D(l.v.projection.type)});class rc extends l.E{constructor(t){super(),this._transitionable=new l.t(Sl,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0)),this._mercatorProjection=new xn,this._verticalPerspectiveProjection=new ic}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof l.bm){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,c,p,v,T){return this.currentProjection.getMeshFromTileID(t,c,p,v,T)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function lh(b){const t=Qc(b.worldSize,b.center.lat);return 2*Math.PI*t}function zo(b,t,c,p,v){const T=1/(1<<v),M=t/l.$*T+p*T,R=l.bo((b/l.$*T+c*T)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-M*Math.PI*2))-.5*Math.PI,j=Math.cos(P),U=new Float64Array(3);return U[0]=Math.sin(R)*j,U[1]=Math.sin(P),U[2]=Math.cos(R)*j,U}function Lr(b){return function(t,c){const p=Math.cos(c),v=new Float64Array(3);return v[0]=Math.sin(t)*p,v[1]=Math.sin(c),v[2]=Math.cos(t)*p,v}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function Qc(b,t){return b/(2*Math.PI)/Math.cos(t*Math.PI/180)}function ac(b){const t=Math.asin(b[1])/Math.PI*180,c=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(c>1e-6){const p=b[0]/c,v=Math.acos(b[2]/c),T=(p>0?v:-v)/Math.PI*180;return new l.S(l.aO(T,-180,180),t)}return new l.S(0,t)}function oc(b){return Math.cos(b*Math.PI/180)}function Ki(b,t){const c=oc(b),p=oc(t);return l.ak(p/c)}function im(b,t){const c=b.rotate(t.bearingInRadians),p=t.zoom+Ki(t.center.lat,0),v=l.bk(1/oc(t.center.lat),1/oc(Math.min(Math.abs(t.center.lat),60)),l.bn(p,7,3,0,1)),T=360/lh({worldSize:t.worldSize,center:{lat:t.center.lat}});return new l.S(t.center.lng-c.x*T*v,l.ah(t.center.lat+c.y*T,-l.ai,l.ai))}function ch(b){const t=.5*b,c=Math.sin(t),p=Math.cos(t);return Math.log(c+p)-Math.log(p-c)}function Gf(b,t,c,p){const v=b.lat+c*p;if(Math.abs(c)>1){const T=(Math.sign(b.lat+c)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,M=Math.abs(b.lat+c)*Math.PI/180,R=ch(T+p*(M-T)),P=ch(T),j=ch(M);return new l.S(b.lng+t*((R-P)/(j-P)),v)}return new l.S(b.lng+t*p,v)}class rm{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,c,p,v){const T=`${t.z}_${t.x}_${t.y}_${v?.terrain?"t":""}`,M=this._cache.get(T);if(M)return M;const R=this._cachePrevious.get(T);if(R)return this._cache.set(T,R),R;const P=this._boundingVolumeFactory(t,c,p,v);return this._cache.set(T,P),this._hadAnyChanges=!0,P}}class Kc{constructor(t,c,p,v){this.min=p,this.max=v,this.points=t,this.planes=c}static fromAabb(t,c){const p=[];for(let v=0;v<8;v++)p.push([1&~v?t[0]:c[0],(v>>1&1)==1?c[1]:t[1],(v>>2&1)==1?c[2]:t[2]]);return new Kc(p,[[-1,0,0,c[0]],[1,0,0,-t[0]],[0,-1,0,c[1]],[0,1,0,-t[1]],[0,0,-1,c[2]],[0,0,1,-t[2]]],t,c)}static fromCenterSizeAngles(t,c,p){const v=l.br([],p[0],p[1],p[2]),T=l.bs([],[c[0],0,0],v),M=l.bs([],[0,c[1],0],v),R=l.bs([],[0,0,c[2]],v),P=[...t],j=[...t];for(let $=0;$<8;$++)for(let G=0;G<3;G++){const Y=t[G]+T[G]*(1&~$?-1:1)+M[G]*(($>>1&1)==1?1:-1)+R[G]*(($>>2&1)==1?1:-1);P[G]=Math.min(P[G],Y),j[G]=Math.max(j[G],Y)}const U=[];for(let $=0;$<8;$++){const G=[...t];l.aS(G,G,l.aR([],T,1&~$?-1:1)),l.aS(G,G,l.aR([],M,($>>1&1)==1?1:-1)),l.aS(G,G,l.aR([],R,($>>2&1)==1?1:-1)),U.push(G)}return new Kc(U,[[...T,-l.aX(T,U[0])],[...M,-l.aX(M,U[0])],[...R,-l.aX(R,U[0])],[-T[0],-T[1],-T[2],-l.aX(T,U[7])],[-M[0],-M[1],-M[2],-l.aX(M,U[7])],[-R[0],-R[1],-R[2],-l.aX(R,U[7])]],P,j)}intersectsFrustum(t){let c=!0;const p=this.points.length,v=this.planes.length,T=t.planes.length,M=t.points.length;for(let R=0;R<T;R++){const P=t.planes[R];let j=0;for(let U=0;U<p;U++){const $=this.points[U];P[0]*$[0]+P[1]*$[1]+P[2]*$[2]+P[3]>=0&&j++}if(j===0)return 0;j<p&&(c=!1)}if(c)return 2;for(let R=0;R<v;R++){const P=this.planes[R];let j=0;for(let U=0;U<M;U++){const $=t.points[U];P[0]*$[0]+P[1]*$[1]+P[2]*$[2]+P[3]>=0&&j++}if(j===0)return 0}return 1}intersectsPlane(t){const c=this.points.length;let p=0;for(let v=0;v<c;v++){const T=this.points[v];t[0]*T[0]+t[1]*T[1]+t[2]*T[2]+t[3]>=0&&p++}return p===c?2:p===0?0:1}}function Xr(b,t,c){const p=b-t;return p<0?-p:Math.max(0,p-c)}function uh(b,t,c,p,v){const T=b-c;let M;return M=T<0?Math.min(-T,1+T-v):T>1?Math.min(Math.max(T-v,0),1-T):0,Math.max(M,Xr(t,p,v))}class ws{constructor(){this._boundingVolumeCache=new rm(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,c,p,v){const T=1<<p.z,M=1/T,R=p.x/T,P=p.y/T;let j=2;return j=Math.min(j,uh(t,c,R,P,M)),j=Math.min(j,uh(t,c,R+.5,-P-M,M)),j=Math.min(j,uh(t,c,R+.5,2-P-M,M)),j}getWrap(t,c,p){const v=1<<c.z,T=1/v,M=c.x/v,R=Xr(t.x,M,T),P=Xr(t.x,M-1,T),j=Xr(t.x,M+1,T),U=Math.min(R,P,j);return U===j?1:U===P?-1:0}allowVariableZoom(t,c){return jt(t,c)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,c,p,v){return this._boundingVolumeCache.getTileBoundingVolume(t,c,p,v)}_computeTileBoundingVolume(t,c,p,v){var T,M;let R=0,P=0;if(v?.terrain){const j=new l.Z(t.z,c,t.z,t.x,t.y),U=v.terrain.getMinMaxElevation(j);R=(T=U.minElevation)!==null&&T!==void 0?T:Math.min(0,p),P=(M=U.maxElevation)!==null&&M!==void 0?M:Math.max(0,p)}if(R/=l.bu,P/=l.bu,R+=1,P+=1,t.z<=0)return Kc.fromAabb([-P,-P,-P],[P,P,P]);if(t.z===1)return Kc.fromAabb([t.x===0?-P:0,t.y===0?0:-P,-P],[t.x===0?0:P,t.y===0?P:0,P]);{const j=[zo(0,0,t.x,t.y,t.z),zo(l.$,0,t.x,t.y,t.z),zo(l.$,l.$,t.x,t.y,t.z),zo(0,l.$,t.x,t.y,t.z)],U=[];for(const $e of j)U.push(l.aR([],$e,P));if(P!==R)for(const $e of j)U.push(l.aR([],$e,R));t.y===0&&U.push([0,1,0]),t.y===(1<<t.z)-1&&U.push([0,-1,0]);const $=[1,1,1],G=[-1,-1,-1];for(const $e of U)for(let Xe=0;Xe<3;Xe++)$[Xe]=Math.min($[Xe],$e[Xe]),G[Xe]=Math.max(G[Xe],$e[Xe]);const Y=zo(l.$/2,l.$/2,t.x,t.y,t.z),ee=l.aW([],[0,1,0],Y);l.aV(ee,ee);const he=l.aW([],Y,ee);l.aV(he,he);const ue=l.aW([],j[2],j[1]);l.aV(ue,ue);const fe=l.aW([],j[0],j[3]);l.aV(fe,fe),U.push(l.aR([],Y,P)),t.y>=(1<<t.z)/2&&U.push(l.aR([],zo(l.$/2,0,t.x,t.y,t.z),P)),t.y<(1<<t.z)/2&&U.push(l.aR([],zo(l.$/2,l.$,t.x,t.y,t.z),P));const pe=sc(Y,U),ve=sc(he,U),ye=[-Y[0],-Y[1],-Y[2],pe.max],Se=[Y[0],Y[1],Y[2],-pe.min],Re=[-he[0],-he[1],-he[2],ve.max],_e=[he[0],he[1],he[2],-ve.min],Ne=[...ue,0],We=[...fe,0],Ve=[];return t.y===0?Ve.push(l.bt(We,Ne,ye),l.bt(We,Ne,Se)):Ve.push(l.bt(Re,Ne,ye),l.bt(Re,Ne,Se),l.bt(Re,We,ye),l.bt(Re,We,Se)),t.y===(1<<t.z)-1?Ve.push(l.bt(We,Ne,ye),l.bt(We,Ne,Se)):Ve.push(l.bt(_e,Ne,ye),l.bt(_e,Ne,Se),l.bt(_e,We,ye),l.bt(_e,We,Se)),new Kc(Ve,[ye,Se,Re,_e,Ne,We],$,G)}}}function sc(b,t){let c=1/0,p=-1/0;for(const v of t){const T=l.aX(b,v);c=Math.min(c,T),p=Math.max(p,T)}return{min:c,max:p}}class hh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,c,p){return this._helper.interpolatePadding(t,c,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,c){this._helper.resize(t,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,c){this._helper.overrideNearFarZ(t,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=l.bv(),this._projectionMatrix=l.b9(),this._globeViewProjMatrix32f=l.b8(),this._globeViewProjMatrixNoCorrection=l.b9(),this._globeViewProjMatrixNoCorrectionInverted=l.b9(),this._globeProjMatrixInverted=l.b9(),this._cameraPosition=l.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new pr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,c)=>this.getConstrained(t,c)}),this._coveringTilesDetailsProvider=new ws}clone(){const t=new hh;return t.apply(this),t}apply(t,c){this._globeLatitudeErrorCorrectionRadians=c||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=l.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:c,applyGlobeMatrix:p}=t,v=this._helper.getMercatorTileCoordinates(c);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const c=this.pitchInRadians,p=this.cameraToCenterDistance/t,v=Math.sin(c)*p,T=Math.cos(c)*p+1,M=1/Math.sqrt(v*v+T*T)*1;let R=-v,P=T;const j=Math.sqrt(R*R+P*P);R/=j,P/=j;const U=[0,R,P];l.bw(U,U,[0,0,0],-this.bearingInRadians),l.bx(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),l.by(U,U,[0,0,0],this.center.lng*Math.PI/180);const $=1/l.aZ(U);return l.aR(U,U,$),[...U,-M*$]}isLocationOccluded(t){return!this.isSurfacePointVisible(Lr(t))}transformLightDirection(t){const c=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,v=Math.cos(p),T=[Math.sin(c)*v,Math.sin(p),Math.cos(c)*v],M=[T[2],0,-T[0]],R=[0,0,0];l.aW(R,M,T),l.aV(M,M),l.aV(R,R);const P=[0,0,0];return l.aV(P,[M[0]*t[0]+R[0]*t[1]+T[0]*t[2],M[1]*t[0]+R[1]*t[1]+T[1]*t[2],M[2]*t[0]+R[2]*t[1]+T[2]*t[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,c,p){const v=function(R,P,j){const U=1/(1<<j.z);return new l.a1(R/l.$*U+j.x*U,P/l.$*U+j.y*U)}(t,c,p.canonical),T=(M=v.y,[l.bo(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-M*Math.PI*2))-.5*Math.PI]);var M;return this.getCircleRadiusCorrection()/Math.cos(T[1])}projectTileCoordinates(t,c,p,v){const T=p.canonical,M=zo(t,c,T.x,T.y,T.z),R=1+(v?v(t,c):0)/l.bu,P=[M[0]*R,M[1]*R,M[2]*R,1];l.aw(P,P,this._globeViewProjMatrixNoCorrection);const j=this._cachedClippingPlane,U=j[0]*M[0]+j[1]*M[1]+j[2]*M[2]+j[3]<0;return{point:new l.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Qc(this.worldSize,this.center.lat),c=l.ba(),p=l.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),l.b4(c,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;c[8]=2*-v.x/this._helper._width,c[9]=2*v.y/this._helper._height,this._projectionMatrix=l.b5(c),this._globeProjMatrixInverted=l.ba(),l.aq(this._globeProjMatrixInverted,c),l.M(c,c,[0,0,-this.cameraToCenterDistance]),l.b6(c,c,this.rollInRadians),l.b7(c,c,-this.pitchInRadians),l.b6(c,c,this.bearingInRadians),l.M(c,c,[0,0,-t]);const T=l.bp();T[0]=t,T[1]=t,T[2]=t,l.b7(p,c,this.center.lat*Math.PI/180),l.bz(p,p,-this.center.lng*Math.PI/180),l.N(p,p,T),this._globeViewProjMatrixNoCorrection=p,l.b7(c,c,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bz(c,c,-this.center.lng*Math.PI/180),l.N(c,c,T),this._globeViewProjMatrix32f=new Float32Array(c),this._globeViewProjMatrixNoCorrectionInverted=l.ba(),l.aq(this._globeViewProjMatrixNoCorrectionInverted,p);const M=l.bp();this._cameraPosition=l.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,l.bw(this._cameraPosition,this._cameraPosition,M,-this.rollInRadians),l.bx(this._cameraPosition,this._cameraPosition,M,this.pitchInRadians),l.bw(this._cameraPosition,this._cameraPosition,M,-this.bearingInRadians),l.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bx(this._cameraPosition,this._cameraPosition,M,-this.center.lat*Math.PI/180),l.by(this._cameraPosition,this._cameraPosition,M,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const R=l.b5(this._globeViewProjMatrixNoCorrectionInverted);l.N(R,R,[1,1,-1]),this._cachedFrustum=ar.fromInvProjectionMatrix(R,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){l.w("calculateFogMatrix is not supported on globe projection.");const c=l.ba();return l.ag(c),c}getVisibleUnwrappedCoordinates(t){return[new l.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,c){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=Lr(t);l.aR(p,p,1+c/l.bu);const v=l.bv();return l.aw(v,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(t){}getBounds(){const t=.5*this.width,c=.5*this.height,p=[new l.P(0,0),new l.P(t,0),new l.P(this.width,0),new l.P(this.width,c),new l.P(this.width,this.height),new l.P(t,this.height),new l.P(0,this.height),new l.P(0,c)],v=[];for(const $ of p)v.push(this.unprojectScreenPoint($));let T=0,M=0,R=0,P=0;const j=this.center;for(const $ of v){const G=l.bA(j.lng,$.lng),Y=l.bA(j.lat,$.lat);G<M&&(M=G),G>T&&(T=G),Y<P&&(P=Y),Y>R&&(R=Y)}const U=[j.lng+M,j.lat+P,j.lng+T,j.lat+R];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new Un(U)}getConstrained(t,c){const p=l.ah(t.lat,-l.ai,l.ai),v=l.ah(+c,this.minZoom+Ki(0,p),this.maxZoom);return{center:new l.S(t.lng,p),zoom:v}}calculateCenterFromCameraLngLatAlt(t,c,p,v){return this._helper.calculateCenterFromCameraLngLatAlt(t,c,p,v)}setLocationAtPoint(t,c){const p=Lr(this.unprojectScreenPoint(c)),v=Lr(t),T=l.bp();l.bB(T);const M=l.bp();l.by(M,p,T,-this.center.lng*Math.PI/180),l.bx(M,M,T,this.center.lat*Math.PI/180);const R=v[0]*v[0]+v[2]*v[2],P=M[0]*M[0];if(R<P)return;const j=Math.sqrt(R-P),U=-j,$=l.bC(v[0],v[2],M[0],j),G=l.bC(v[0],v[2],M[0],U),Y=l.bp();l.by(Y,v,T,-$);const ee=l.bC(Y[1],Y[2],M[1],M[2]),he=l.bp();l.by(he,v,T,-G);const ue=l.bC(he[1],he[2],M[1],M[2]),fe=.5*Math.PI,pe=ee>=-fe&&ee<=fe,ve=ue>=-fe&&ue<=fe;let ye,Se;if(pe&&ve){const We=this.center.lng*Math.PI/180,Ve=this.center.lat*Math.PI/180;l.bD($,We)+l.bD(ee,Ve)<l.bD(G,We)+l.bD(ue,Ve)?(ye=$,Se=ee):(ye=G,Se=ue)}else if(pe)ye=$,Se=ee;else{if(!ve)return;ye=G,Se=ue}const Re=ye/Math.PI*180,_e=Se/Math.PI*180,Ne=this.center.lat;this.setCenter(new l.S(Re,l.ah(_e,-90,90))),this.setZoom(this.zoom+Ki(Ne,this.center.lat))}locationToScreenPoint(t,c){const p=Lr(t);if(c){const v=c.getElevationForLngLatZoom(t,this._helper._tileZoom);l.aR(p,p,1+v/l.bu)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(t){const c=l.bv();return l.aw(c,[...t,1],this._globeViewProjMatrixNoCorrection),c[0]/=c[3],c[1]/=c[3],new l.P((.5*c[0]+.5)*this.width,(.5*-c[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,c){if(c){const p=c.pointCoordinate(t);if(p)return p}return l.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,c){var p;return(p=this.screenPointToMercatorCoordinate(t,c))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(t,c){const p=this._cameraPosition,v=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(p,v)}getRayDirectionFromPixel(t){const c=l.bv();c[0]=t.x/this.width*2-1,c[1]=-1*(t.y/this.height*2-1),c[2]=1,c[3]=1,l.aw(c,c,this._globeViewProjMatrixNoCorrectionInverted),c[0]/=c[3],c[1]/=c[3],c[2]/=c[3];const p=l.bp();p[0]=c[0]-this._cameraPosition[0],p[1]=c[1]-this._cameraPosition[1],p[2]=c[2]-this._cameraPosition[2];const v=l.bp();return l.aV(v,p),v}isSurfacePointVisible(t){const c=this._cachedClippingPlane;return c[0]*t[0]+c[1]*t[1]+c[2]*t[2]+c[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const c=l.bv();return l.aw(c,[...t,1],this._globeViewProjMatrixNoCorrection),c[0]/=c[3],c[1]/=c[3],c[2]/=c[3],c[0]>-1&&c[0]<1&&c[1]>-1&&c[1]<1&&c[2]>-1&&c[2]<1}rayPlanetIntersection(t,c){const p=l.aX(t,c),v=l.bp(),T=l.bp();l.aR(T,c,p),l.aU(v,t,T);const M=1-l.aX(v,v);if(M<0)return null;const R=l.aX(t,t)-1,P=-p+(p<0?1:-1)*Math.sqrt(M),j=R/P,U=P;return{tMin:Math.min(j,U),tMax:Math.max(j,U)}}unprojectScreenPoint(t){const c=this._cameraPosition,p=this.getRayDirectionFromPixel(t),v=this.rayPlanetIntersection(c,p);if(v){const U=l.bp();l.aS(U,c,[p[0]*v.tMin,p[1]*v.tMin,p[2]*v.tMin]);const $=l.bp();return l.aV($,U),ac($)}const T=this._cachedClippingPlane,M=T[0]*p[0]+T[1]*p[1]+T[2]*p[2],R=-l.b1(T,c)/M,P=l.bp();if(R>0)l.aS(P,c,[p[0]*R,p[1]*R,p[2]*R]);else{const U=l.bp();l.aS(U,c,[2*p[0],2*p[1],2*p[2]]);const $=l.b1(this._cachedClippingPlane,U);l.aU(P,U,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const j=function(U){const $=l.bp();return $[0]=U[0]*-U[3],$[1]=U[1]*-U[3],$[2]=U[2]*-U[3],{center:$,radius:Math.sqrt(1-U[3]*U[3])}}(T);return ac(function(U,$,G){const Y=l.bp();l.aU(Y,G,U);const ee=l.bp();return l.bq(ee,U,Y,$/l.a$(Y)),ee}(j.center,j.radius,P))}getMatrixForModel(t,c){const p=l.S.convert(t),v=1/l.bu,T=l.b9();return l.bz(T,T,p.lng/180*Math.PI),l.b7(T,T,-p.lat/180*Math.PI),l.M(T,T,[0,0,1+c/l.bu]),l.b7(T,T,.5*Math.PI),l.N(T,T,[v,v,v]),T}getProjectionDataForCustomLayer(t=!0){const c=this.getProjectionData({overscaledTileID:new l.Z(0,0,0,0,0),applyGlobeMatrix:t});return c.tileMercatorCoords=[0,0,1,1],c}getFastPathSimpleProjectionMatrix(t){}}class dh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,c,p){return this._helper.interpolatePadding(t,c,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,c,p=!0){this._helper.resize(t,c,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,c){this._helper.overrideNearFarZ(t,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,c){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=c,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new pr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,c)=>this.getConstrained(t,c)}),this._globeness=1,this._mercatorTransform=new Wn,this._verticalPerspectiveTransform=new hh}clone(){const t=new dh;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const c=this._mercatorTransform.getProjectionData(t),p=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:c.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:c.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return l.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,c,p){const v=this._mercatorTransform.getPitchedTextCorrection(t,c,p),T=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,c,p);return l.bk(v,T,this._globeness)}projectTileCoordinates(t,c,p,v){return this.currentTransform.projectTileCoordinates(t,c,p,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,c){return this.currentTransform.lngLatToCameraDepth(t,c)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,c){return this.currentTransform.getConstrained(t,c)}calculateCenterFromCameraLngLatAlt(t,c,p,v){return this._helper.calculateCenterFromCameraLngLatAlt(t,c,p,v)}setLocationAtPoint(t,c){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,c),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,c),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,c){return this.currentTransform.locationToScreenPoint(t,c)}screenPointToMercatorCoordinate(t,c){return this.currentTransform.screenPointToMercatorCoordinate(t,c)}screenPointToLocation(t,c){return this.currentTransform.screenPointToLocation(t,c)}isPointOnMapSurface(t,c){return this.currentTransform.isPointOnMapSurface(t,c)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,c){return this.currentTransform.getMatrixForModel(t,c)}getProjectionDataForCustomLayer(t=!0){const c=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return c;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return p.fallbackMatrix=c.mainMatrix,p}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class ta{get useGlobeControls(){return!0}handlePanInertia(t,c){const p=im(t,c);return Math.abs(p.lng-c.center.lng)>180&&(p.lng=c.center.lng+179.5*Math.sign(p.lng-c.center.lng)),{easingCenter:p,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,c){const p=t.around,v=c.screenPointToLocation(p);t.bearingDelta&&c.setBearing(c.bearing+t.bearingDelta),t.pitchDelta&&c.setPitch(c.pitch+t.pitchDelta),t.rollDelta&&c.setRoll(c.roll+t.rollDelta);const T=c.zoom;t.zoomDelta&&c.setZoom(c.zoom+t.zoomDelta);const M=c.zoom-T;if(M===0)return;const R=l.bA(c.center.lng,v.lng),P=R/(Math.abs(R/180)+1),j=l.bA(c.center.lat,v.lat),U=c.getRayDirectionFromPixel(p),$=c.cameraPosition,G=-1*l.aX($,U),Y=l.bp();l.aS(Y,$,[U[0]*G,U[1]*G,U[2]*G]);const ee=l.aZ(Y)-1,he=Math.exp(.5*-Math.max(ee-.3,0)),ue=Qc(c.worldSize,c.center.lat)/Math.min(c.width,c.height),fe=l.bn(ue,.9,.5,1,.25),pe=(1-l.af(-M))*Math.min(he,fe),ve=c.center.lat,ye=c.zoom,Se=new l.S(c.center.lng+P*pe,l.ah(c.center.lat+j*pe,-l.ai,l.ai));c.setLocationAtPoint(v,p);const Re=c.center,_e=l.bn(Math.abs(R),45,85,0,1),Ne=l.bn(ue,.75,.35,0,1),We=Math.pow(Math.max(_e,Ne),.25),Ve=l.bA(Re.lng,Se.lng),$e=l.bA(Re.lat,Se.lat);c.setCenter(new l.S(Re.lng+Ve*We,Re.lat+$e*We).wrap()),c.setZoom(ye+Ki(ve,c.center.lat))}handleMapControlsPan(t,c,p){if(!t.panDelta)return;const v=c.center.lat,T=c.zoom;c.setCenter(im(t.panDelta,c).wrap()),c.setZoom(T+Ki(v,c.center.lat))}cameraForBoxAndBearing(t,c,p,v,T){const M=qr(t,c,p,v,T),R=c.left/T.width*2-1,P=(T.width-c.right)/T.width*2-1,j=c.top/T.height*-2+1,U=(T.height-c.bottom)/T.height*-2+1,$=l.bA(p.getWest(),p.getEast())<0,G=$?p.getEast():p.getWest(),Y=$?p.getWest():p.getEast(),ee=Math.max(p.getNorth(),p.getSouth()),he=Math.min(p.getNorth(),p.getSouth()),ue=G+.5*l.bA(G,Y),fe=ee+.5*l.bA(ee,he),pe=T.clone();pe.setCenter(M.center),pe.setBearing(M.bearing),pe.setPitch(0),pe.setRoll(0),pe.setZoom(M.zoom);const ve=pe.modelViewProjectionMatrix,ye=[Lr(p.getNorthWest()),Lr(p.getNorthEast()),Lr(p.getSouthWest()),Lr(p.getSouthEast()),Lr(new l.S(Y,fe)),Lr(new l.S(G,fe)),Lr(new l.S(ue,ee)),Lr(new l.S(ue,he))],Se=Lr(M.center);let Re=Number.POSITIVE_INFINITY;for(const _e of ye)R<0&&(Re=ta.getLesserNonNegativeNonNull(Re,ta.solveVectorScale(_e,Se,ve,"x",R))),P>0&&(Re=ta.getLesserNonNegativeNonNull(Re,ta.solveVectorScale(_e,Se,ve,"x",P))),j>0&&(Re=ta.getLesserNonNegativeNonNull(Re,ta.solveVectorScale(_e,Se,ve,"y",j))),U<0&&(Re=ta.getLesserNonNegativeNonNull(Re,ta.solveVectorScale(_e,Se,ve,"y",U)));if(Number.isFinite(Re)&&Re!==0)return M.zoom=pe.zoom+l.ak(Re),M;bs()}handleJumpToCenterZoom(t,c){const p=t.center.lat,v=t.getConstrained(c.center?l.S.convert(c.center):t.center,t.zoom).center;t.setCenter(v.wrap());const T=c.zoom!==void 0?+c.zoom:t.zoom+Ki(p,v.lat);t.zoom!==T&&t.setZoom(T)}handleEaseTo(t,c){const p=t.zoom,v=t.center,T=t.padding,M={roll:t.roll,pitch:t.pitch,bearing:t.bearing},R={roll:c.roll===void 0?t.roll:c.roll,pitch:c.pitch===void 0?t.pitch:c.pitch,bearing:c.bearing===void 0?t.bearing:c.bearing},P=c.zoom!==void 0,j=!t.isPaddingEqual(c.padding);let U=!1;const $=c.center?l.S.convert(c.center):v,G=t.getConstrained($,p).center;Wc(t,G);const Y=t.clone();Y.setCenter(G),Y.setZoom(P?+c.zoom:p+Ki(v.lat,$.lat)),Y.setBearing(c.bearing);const ee=new l.P(l.ah(t.centerPoint.x+c.offsetAsPoint.x,0,t.width),l.ah(t.centerPoint.y+c.offsetAsPoint.y,0,t.height));Y.setLocationAtPoint(G,ee);const he=(c.offset&&c.offsetAsPoint.mag())>0?Y.center:G,ue=P?+c.zoom:p+Ki(v.lat,he.lat),fe=p+Ki(v.lat,0),pe=ue+Ki(he.lat,0),ve=l.bA(v.lng,he.lng),ye=l.bA(v.lat,he.lat),Se=l.af(pe-fe);return U=ue!==p,{easeFunc:Re=>{if(l.be(M,R)||Hr({startEulerAngles:M,endEulerAngles:R,tr:t,k:Re,useSlerp:M.roll!=R.roll}),j&&t.interpolatePadding(T,c.padding,Re),c.around)l.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(c.around,c.aroundPoint);else{const _e=pe>fe?Math.min(2,Se):Math.max(.5,Se),Ne=Math.pow(_e,1-Re),We=Gf(v,ve,ye,Re*Ne);t.setCenter(We.wrap())}if(U){const _e=l.C.number(fe,pe,Re)+Ki(0,t.center.lat);t.setZoom(_e)}},isZooming:U,elevationCenter:he}}handleFlyTo(t,c){const p=c.zoom!==void 0,v=t.center,T=t.zoom,M=t.padding,R=!t.isPaddingEqual(c.padding),P=t.getConstrained(l.S.convert(c.center||c.locationAtOffset),T).center,j=p?+c.zoom:t.zoom+Ki(t.center.lat,P.lat),U=t.clone();U.setCenter(P),U.setZoom(j),U.setBearing(c.bearing);const $=new l.P(l.ah(t.centerPoint.x+c.offsetAsPoint.x,0,t.width),l.ah(t.centerPoint.y+c.offsetAsPoint.y,0,t.height));U.setLocationAtPoint(P,$);const G=U.center;Wc(t,G);const Y=function(ye,Se,Re){const _e=Lr(Se),Ne=Lr(Re),We=l.aX(_e,Ne),Ve=Math.acos(We),$e=lh(ye);return Ve/(2*Math.PI)*$e}(t,v,G),ee=T+Ki(v.lat,0),he=j+Ki(G.lat,0),ue=l.af(he-ee);let fe;if(typeof c.minZoom=="number"){const ye=+c.minZoom+Ki(G.lat,0),Se=Math.min(ye,ee,he)+Ki(0,G.lat),Re=t.getConstrained(G,Se).zoom+Ki(G.lat,0);fe=l.af(Re-ee)}const pe=l.bA(v.lng,G.lng),ve=l.bA(v.lat,G.lat);return{easeFunc:(ye,Se,Re,_e)=>{const Ne=Gf(v,pe,ve,Re);R&&t.interpolatePadding(M,c.padding,ye);const We=ye===1?G:Ne;t.setCenter(We.wrap());const Ve=ee+l.ak(Se);t.setZoom(ye===1?j:Ve+Ki(0,We.lat))},scaleOfZoom:ue,targetCenter:G,scaleOfMinZoom:fe,pixelPathLength:Y}}static solveVectorScale(t,c,p,v,T){const M=v==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],R=[p[3],p[7],p[11],p[15]],P=t[0]*M[0]+t[1]*M[1]+t[2]*M[2],j=t[0]*R[0]+t[1]*R[1]+t[2]*R[2],U=c[0]*M[0]+c[1]*M[1]+c[2]*M[2],$=c[0]*R[0]+c[1]*R[1]+c[2]*R[2];return U+T*j===P+T*$||R[3]*(P-U)+M[3]*($-j)+P*$==U*j?null:(U+M[3]-T*$-T*R[3])/(U-P-T*$+T*j)}static getLesserNonNegativeNonNull(t,c){return c!==null&&c>=0&&c<t?c:t}}class $f{constructor(t){this._globe=t,this._mercatorCameraHelper=new qi,this._verticalPerspectiveCameraHelper=new ta}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,c){return this.currentHelper.handlePanInertia(t,c)}handleMapControlsRollPitchBearingZoom(t,c){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,c)}handleMapControlsPan(t,c,p){this.currentHelper.handleMapControlsPan(t,c,p)}cameraForBoxAndBearing(t,c,p,v,T){return this.currentHelper.cameraForBoxAndBearing(t,c,p,v,T)}handleJumpToCenterZoom(t,c){this.currentHelper.handleJumpToCenterZoom(t,c)}handleEaseTo(t,c){return this.currentHelper.handleEaseTo(t,c)}handleFlyTo(t,c){return this.currentHelper.handleFlyTo(t,c)}}const Rd=(b,t)=>l.y(b,t&&t.filter(c=>c.identifier!=="source.canvas")),ry=l.bE();class Zf extends l.E{constructor(t,c={}){var p,v;super(),this._rtlPluginLoaded=()=>{for(const M in this.sourceCaches){const R=this.sourceCaches[M].getSource().type;R!=="vector"&&R!=="geojson"||this.sourceCaches[M].reload()}},this.map=t,this.dispatcher=new Ot(Ut(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(M,R)=>this.getGlyphs(M,R)),this.dispatcher.registerMessageHandler("GI",(M,R)=>this.getImages(M,R)),this.imageManager=new Me,this.imageManager.setEventedParent(this);const T=((p=t._container)===null||p===void 0?void 0:p.lang)||typeof document<"u"&&((v=document.documentElement)===null||v===void 0?void 0:v.lang)||void 0;this.glyphManager=new zt(t._requestManager,c.localIdeographFontFamily,T),this.lineAtlas=new ut(256,512),this.crossTileSymbolIndex=new tc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",l.bG()),ii().on(Da,this._rtlPluginLoaded),this.on("data",M=>{if(M.dataType!=="source"||M.sourceDataType!=="metadata")return;const R=this.sourceCaches[M.sourceId];if(!R)return;const P=R.getSource();if(P&&P.vectorLayerIds)for(const j in this._layers){const U=this._layers[j];U.source===P.id&&this._validateLayer(U)}})}setGlobalStateProperty(t,c){var p,v,T;this._checkLoaded();const M=c===null?(T=(v=(p=this.stylesheet.state)===null||p===void 0?void 0:p[t])===null||v===void 0?void 0:v.default)!==null&&T!==void 0?T:null:c;if(l.bH(M,this._globalState[t]))return this;this._globalState[t]=M,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const c=[];for(const p in t)!l.bH(this._globalState[p],t[p].default)&&(c.push(p),this._globalState[p]=t[p].default);this._applyGlobalStateChanges(c)}_applyGlobalStateChanges(t){if(t.length===0)return;const c=new Set,p={};for(const v of t){p[v]=this._globalState[v];for(const T in this._layers){const M=this._layers[T],R=M.getLayoutAffectingGlobalStateRefs(),P=M.getPaintAffectingGlobalStateRefs();if(R.has(v)&&c.add(M.source),P.has(v))for(const{name:j,value:U}of P.get(v))this._updatePaintProperty(M,j,U)}}this.dispatcher.broadcast("UGS",p);for(const v in this.sourceCaches)c.has(v)&&(this._reloadSource(v),this._changed=!0)}loadURL(t,c={},p){this.fire(new l.l("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;const v=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;l.j(v,this._loadStyleRequest).then(M=>{this._loadStyleRequest=null,this._load(M.data,c,p)}).catch(M=>{this._loadStyleRequest=null,M&&!T.signal.aborted&&this.fire(new l.k(M))})}loadJSON(t,c={},p){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,F.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,c.validate=c.validate!==!1,this._load(t,c,p)}).catch(()=>{})}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(ry,{validate:!1})}_load(t,c,p){var v,T;let M=c.transformStyle?c.transformStyle(p,t):t;if(!c.validate||!Rd(this,l.z(M))){M=Object.assign({},M),this._loaded=!0,this.stylesheet=M;for(const R in M.sources)this.addSource(R,M.sources[R],{validate:!1});M.sprite?this._loadSprite(M.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(M.glyphs),this._createLayers(),this.light=new Be(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new _t(this.stylesheet.sky),this.map.setTerrain((T=this.stylesheet.terrain)!==null&&T!==void 0?T:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){var t;const c=l.bI(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",c),this._order=c.map(p=>p.id),this._layers={},this._serializedLayers=null;for(const p of c){const v=l.bJ(p,this._globalState);v.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=v}}_loadSprite(t,c=!1,p=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(T,M,R,P){return l._(this,void 0,void 0,function*(){const j=Ae(T),U=R>1?"@2x":"",$={},G={};for(const{id:Y,url:ee}of j){const he=M.transformRequest(Ge(ee,U,".json"),"SpriteJSON");$[Y]=l.j(he,P);const ue=M.transformRequest(Ge(ee,U,".png"),"SpriteImage");G[Y]=ke.getImage(ue,P)}return yield Promise.all([...Object.values($),...Object.values(G)]),function(Y,ee){return l._(this,void 0,void 0,function*(){const he={};for(const ue in Y){he[ue]={};const fe=F.getImageCanvasContext((yield ee[ue]).data),pe=(yield Y[ue]).data;for(const ve in pe){const{width:ye,height:Se,x:Re,y:_e,sdf:Ne,pixelRatio:We,stretchX:Ve,stretchY:$e,content:Xe,textFitWidth:Mt,textFitHeight:vt}=pe[ve];he[ue][ve]={data:null,pixelRatio:We,sdf:Ne,stretchX:Ve,stretchY:$e,content:Xe,textFitWidth:Mt,textFitHeight:vt,spriteData:{width:ye,height:Se,x:Re,y:_e,context:fe}}}}return he})}($,G)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(T=>{if(this._spriteRequest=null,T)for(const M in T){this._spritesImagesIds[M]=[];const R=this._spritesImagesIds[M]?this._spritesImagesIds[M].filter(P=>!(P in T)):[];for(const P of R)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in T[M]){const j=M==="default"?P:`${M}:${P}`;this._spritesImagesIds[M].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,T[M][P],!1):this.imageManager.addImage(j,T[M][P]),c&&(this._changedImages[j]=!0)}}}).catch(T=>{this._spriteRequest=null,v=T,this.fire(new l.k(v))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),p&&p(v)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(t){const c=this.sourceCaches[t.source];if(!c)return;const p=t.sourceLayer;if(!p)return;const v=c.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.k(new Error(`Source layer "${p}" does not exist on source "${v.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,c=!1){const p=this._serializedAllLayers();if(!t||t.length===0)return Object.values(c?l.bK(p):p);const v=[];for(const T of t)if(p[T]){const M=c?l.bK(p[T]):p[T];v.push(M)}return v}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const c=Object.keys(this._layers);for(const p of c){const v=this._layers[p];v.type!=="custom"&&(t[p]=v.serialize())}return t}hasTransitions(){var t,c,p;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((c=this.sky)===null||c===void 0)&&c.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const v in this.sourceCaches)if(this.sourceCaches[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const c=this._changed;if(c){const v=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(v.length||T.length)&&this._updateWorkerLayers(v,T);for(const M in this._updatedSources){const R=this._updatedSources[M];if(R==="reload")this._reloadSource(M);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(M)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const p={};for(const v in this.sourceCaches){const T=this.sourceCaches[v];p[v]=T.used,T.used=!1}for(const v of this._order){const T=this._layers[v];T.recalculate(t,this._availableImages),!T.isHidden(t.zoom)&&T.source&&(this.sourceCaches[T.source].used=!0)}for(const v in p){const T=this.sourceCaches[v];!!p[v]!=!!T.used&&T.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,c&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,c){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,c={}){var p;this._checkLoaded();const v=this.serialize();if(t=c.transformStyle?c.transformStyle(v,t):t,((p=c.validate)===null||p===void 0||p)&&Rd(this,l.z(t)))return!1;(t=l.bK(t)).layers=l.bI(t.layers);const T=l.bL(v,t),M=this._getOperationsToPerform(T);if(M.unimplemented.length>0)throw new Error(`Unimplemented: ${M.unimplemented.join(", ")}.`);if(M.operations.length===0)return!1;for(const R of M.operations)R();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const c=[],p=[];for(const v of t)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":c.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":c.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":c.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":c.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":c.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":c.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":c.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":c.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":c.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":c.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":c.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":c.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":c.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":c.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":c.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":c.push(()=>{});break;default:p.push(v.command)}return{operations:c,unimplemented:p}}addImage(t,c){if(this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,c),this._afterImageUpdated(t)}updateImage(t,c){this.imageManager.updateImage(t,c)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,c,p={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(l.z.source,`sources.${t}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const v=this.sourceCaches[t]=new Sn(t,c,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:t})),v.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===t)return this.fire(new l.k(new Error(`Source "${t}" cannot be removed while layer "${p}" is using it.`)));const c=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],c.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,c){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const p=this.sourceCaches[t].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(c),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,c,p={}){this._checkLoaded();const v=t.id;if(this.getLayer(v))return void this.fire(new l.k(new Error(`Layer "${v}" already exists on this map.`)));let T;if(t.type==="custom"){if(Rd(this,l.bM(t)))return;T=l.bJ(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(v,t.source),t=l.bK(t),t=l.e(t,{source:v})),this._validate(l.z.layer,`layers.${v}`,t,{arrayIndex:-1},p))return;T=l.bJ(t,this._globalState),this._validateLayer(T),T.setEventedParent(this,{layer:{id:v}})}const M=c?this._order.indexOf(c):this._order.length;if(c&&M===-1)this.fire(new l.k(new Error(`Cannot add layer "${v}" before non-existing layer "${c}".`)));else{if(this._order.splice(M,0,v),this._layerOrderChanged=!0,this._layers[v]=T,this._removedLayers[v]&&T.source&&T.type!=="custom"){const R=this._removedLayers[v];delete this._removedLayers[v],R.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(t,c){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===c)return;const p=this._order.indexOf(t);this._order.splice(p,1);const v=c?this._order.indexOf(c):this._order.length;c&&v===-1?this.fire(new l.k(new Error(`Cannot move layer "${t}" before non-existing layer "${c}".`))):(this._order.splice(v,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const c=this._layers[t];if(!c)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${t}".`)));c.setEventedParent(null);const p=this._order.indexOf(t);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=c,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],c.onRemove&&c.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,c,p){this._checkLoaded();const v=this.getLayer(t);v?v.minzoom===c&&v.maxzoom===p||(c!=null&&(v.minzoom=c),p!=null&&(v.maxzoom=p),this._updateLayer(v)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,c,p={}){this._checkLoaded();const v=this.getLayer(t);if(v){if(!l.bH(v.filter,c))return c==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(l.z.filter,`layers.${v.id}.filter`,c,null,p)||(v.setFilter(l.bK(c)),this._updateLayer(v)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.bK(this.getLayer(t).filter)}setLayoutProperty(t,c,p,v={}){this._checkLoaded();const T=this.getLayer(t);T?l.bH(T.getLayoutProperty(c),p)||(T.setLayoutProperty(c,p,v),this._updateLayer(T)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,c){const p=this.getLayer(t);if(p)return p.getLayoutProperty(c);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,c,p,v={}){this._checkLoaded();const T=this.getLayer(t);T?l.bH(T.getPaintProperty(c),p)||this._updatePaintProperty(T,c,p,v):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,c,p,v={}){t.setPaintProperty(c,p,v)&&this._updateLayer(t),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,c){return this.getLayer(t).getPaintProperty(c)}setFeatureState(t,c){this._checkLoaded();const p=t.source,v=t.sourceLayer,T=this.sourceCaches[p];if(T===void 0)return void this.fire(new l.k(new Error(`The source '${p}' does not exist in the map's style.`)));const M=T.getSource().type;M==="geojson"&&v?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):M!=="vector"||v?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),T.setFeatureState(v,t.id,c)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,c){this._checkLoaded();const p=t.source,v=this.sourceCaches[p];if(v===void 0)return void this.fire(new l.k(new Error(`The source '${p}' does not exist in the map's style.`)));const T=v.getSource().type,M=T==="vector"?t.sourceLayer:void 0;T!=="vector"||M?c&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(M,t.id,c):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const c=t.source,p=t.sourceLayer,v=this.sourceCaches[c];if(v!==void 0)return v.getSource().type!=="vector"||p?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(p,t.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.bN(this.sourceCaches,T=>T.serialize()),c=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,v=this.stylesheet;return l.bO({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:t,layers:c,terrain:p},T=>T!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const c=M=>this._layers[M].type==="fill-extrusion",p={},v=[];for(let M=this._order.length-1;M>=0;M--){const R=this._order[M];if(c(R)){p[R]=M;for(const P of t){const j=P[R];if(j)for(const U of j)v.push(U)}}}v.sort((M,R)=>R.intersectionZ-M.intersectionZ);const T=[];for(let M=this._order.length-1;M>=0;M--){const R=this._order[M];if(c(R))for(let P=v.length-1;P>=0;P--){const j=v[P].feature;if(p[j.layer.id]<M)break;T.push(j),v.pop()}else for(const P of t){const j=P[R];if(j)for(const U of j)T.push(U.feature)}}return T}queryRenderedFeatures(t,c,p){c&&c.filter&&this._validate(l.z.filter,"queryRenderedFeatures.filter",c.filter,null,c);const v={};if(c&&c.layers){if(!(Array.isArray(c.layers)||c.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const j of c.layers){const U=this._layers[j];if(!U)return this.fire(new l.k(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];v[U.source]=!0}}const T=[];c.availableImages=this._availableImages;const M=this._serializedAllLayers(),R=c.layers instanceof Set?c.layers:Array.isArray(c.layers)?new Set(c.layers):null,P=Object.assign(Object.assign({},c),{layers:R,globalState:this._globalState});for(const j in this.sourceCaches)c.layers&&!v[j]||T.push(Xn(this.sourceCaches[j],this._layers,M,t,P,p,this.map.terrain?(U,$,G)=>this.map.terrain.getElevation(U,$,G):void 0));return this.placement&&T.push(function(j,U,$,G,Y,ee,he){const ue={},fe=ee.queryRenderedSymbols(G),pe=[];for(const ve of Object.keys(fe).map(Number))pe.push(he[ve]);pe.sort(br);for(const ve of pe){const ye=ve.featureIndex.lookupSymbolFeatures(fe[ve.bucketInstanceId],U,ve.bucketIndex,ve.sourceLayerIndex,{filterSpec:Y.filter,globalState:Y.globalState},Y.layers,Y.availableImages,j);for(const Se in ye){const Re=ue[Se]=ue[Se]||[],_e=ye[Se];_e.sort((Ne,We)=>{const Ve=ve.featureSortOrder;if(Ve){const $e=Ve.indexOf(Ne.featureIndex);return Ve.indexOf(We.featureIndex)-$e}return We.featureIndex-Ne.featureIndex});for(const Ne of _e)Re.push(Ne)}}return function(ve,ye,Se){for(const Re in ve)for(const _e of ve[Re])ir(_e,Se[ye[Re].source]);return ve}(ue,j,$)}(this._layers,M,this.sourceCaches,t,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(t,c){c?.filter&&this._validate(l.z.filter,"querySourceFeatures.filter",c.filter,null,c);const p=this.sourceCaches[t];return p?function(v,T){const M=v.getRenderableIds().map(j=>v.getTileByID(j)),R=[],P={};for(let j=0;j<M.length;j++){const U=M[j],$=U.tileID.canonical.key;P[$]||(P[$]=!0,U.querySourceFeatures(R,T))}return R}(p,c?Object.assign(Object.assign({},c),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,c={}){this._checkLoaded();const p=this.light.getLight();let v=!1;for(const M in t)if(!l.bH(t[M],p[M])){v=!0;break}if(!v)return;const T={now:F.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,c),this.light.updateTransitions(T)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,c={}){this._checkLoaded();const p=this.getSky();let v=!1;if(!t&&!p)return;if(t&&!p)v=!0;else if(!t&&p)v=!0;else for(const M in t)if(!l.bH(t[M],p[M])){v=!0;break}if(!v)return;const T={now:F.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,c),this.sky.updateTransitions(T)}_setProjectionInternal(t){const c=function(p){if(Array.isArray(p)){const v=new rc({type:p});return{projection:v,transform:new dh,cameraHelper:new $f(v)}}switch(p){case"mercator":return{projection:new xn,transform:new Wn,cameraHelper:new qi};case"globe":{const v=new rc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:v,transform:new dh,cameraHelper:new $f(v)}}case"vertical-perspective":return{projection:new ic,transform:new hh,cameraHelper:new ta};default:return l.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new xn,transform:new Wn,cameraHelper:new qi}}}(t);this.projection=c.projection,this.map.migrateProjection(c.transform,c.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(t,c,p,v,T={}){return(!T||T.validate!==!1)&&Rd(this,t.call(l.z,l.e({key:c,style:this.serialize(),value:p,styleSpec:l.v},v)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ii().off(Da,this._rtlPluginLoaded);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const p=this.sourceCaches[c];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const c in this.sourceCaches)this.sourceCaches[c].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,c,p,v,T=!1){let M=!1,R=!1;const P={};for(const j of this._order){const U=this._layers[j];if(U.type!=="symbol")continue;if(!P[U.source]){const G=this.sourceCaches[U.source];P[U.source]=G.getRenderableIds(!0).map(Y=>G.getTileByID(Y)).sort((Y,ee)=>ee.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(ee.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(U,P[U.source],t.center.lng);M=M||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(F.now(),t.zoom))&&(this.pauseablePlacement=new oh(t,this.map.terrain,this._order,T,c,p,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(F.now()),R=!0),M&&this.pauseablePlacement.placement.setStale()),R||M)for(const j of this._order){const U=this._layers[j];U.type==="symbol"&&this.placement.updateLayerOpacities(U,P[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(F.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,c){return l._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(c.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[c.source];return v&&v.setDependencies(c.tileID.key,c.type,c.icons),p})}getGlyphs(t,c){return l._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(c.stacks),v=this.sourceCaches[c.source];return v&&v.setDependencies(c.tileID.key,c.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,c={}){this._checkLoaded(),t&&this._validate(l.z.glyphs,"glyphs",t,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,c,p={},v){this._checkLoaded();const T=[{id:t,url:c}],M=[...Ae(this.stylesheet.sprite),...T];this._validate(l.z.sprite,"sprite",M,null,p)||(this.stylesheet.sprite=M,this._loadSprite(T,!0,v))}removeSprite(t){this._checkLoaded();const c=Ae(this.stylesheet.sprite);if(c.find(p=>p.id===t)){if(this._spritesImagesIds[t])for(const p of this._spritesImagesIds[t])this.imageManager.removeImage(p),this._changedImages[p]=!0;c.splice(c.findIndex(p=>p.id===t),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ae(this.stylesheet.sprite)}setSprite(t,c={},p){this._checkLoaded(),t&&this._validate(l.z.sprite,"sprite",t,null,c)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,p):(this._unloadSprite(),p&&p(null)))}}var ay=l.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class oy{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,c,p,v,T,M,R,P,j){this.context=t;let U=this.boundPaintVertexBuffers.length!==v.length;for(let $=0;!U&&$<v.length;$++)this.boundPaintVertexBuffers[$]!==v[$]&&(U=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||U||this.boundIndexBuffer!==T||this.boundVertexOffset!==M||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==j?this.freshBind(c,p,v,T,M,R,P,j):(t.bindVertexArray.set(this.vao),R&&R.bind(),T&&T.dynamicDraw&&T.bind(),P&&P.bind(),j&&j.bind())}freshBind(t,c,p,v,T,M,R,P){const j=t.numAttributes,U=this.context,$=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=P,c.enableAttributes($,t);for(const G of p)G.enableAttributes($,t);M&&M.enableAttributes($,t),R&&R.enableAttributes($,t),P&&P.enableAttributes($,t),c.bind(),c.setVertexAttribPointers($,t,T);for(const G of p)G.bind(),G.setVertexAttribPointers($,t,T);M&&(M.bind(),M.setVertexAttribPointers($,t,T)),v&&v.bind(),R&&(R.bind(),R.setVertexAttribPointers($,t,T)),P&&(P.bind(),P.setVertexAttribPointers($,t,T)),U.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const kd=(b,t,c,p,v)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:t,u_fog_color:c?c.properties.get("fog-color"):l.bf.white,u_fog_ground_blend:c?c.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:c?c.calculateFogBlendOpacity(p):0,u_horizon_color:c?c.properties.get("horizon-color"):l.bf.white,u_horizon_fog_blend:c?c.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),Yf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function lc(b){const t=[];for(let c=0;c<b.length;c++){if(b[c]===null)continue;const p=b[c].split(" ");t.push(p.pop())}return t}class Hf{constructor(t,c,p,v,T,M,R,P,j=[]){const U=t.gl;this.program=U.createProgram();const $=lc(c.staticAttributes),G=p?p.getBinderAttributes():[],Y=$.concat(G),ee=No.prelude.staticUniforms?lc(No.prelude.staticUniforms):[],he=R.staticUniforms?lc(R.staticUniforms):[],ue=c.staticUniforms?lc(c.staticUniforms):[],fe=p?p.getBinderUniforms():[],pe=ee.concat(he).concat(ue).concat(fe),ve=[];for(const Ve of pe)ve.indexOf(Ve)<0&&ve.push(Ve);const ye=p?p.defines():[];ea(U)&&ye.unshift("#version 300 es"),T&&ye.push("#define OVERDRAW_INSPECTOR;"),M&&ye.push("#define TERRAIN3D;"),P&&ye.push(P),j&&ye.push(...j);let Se=ye.concat(No.prelude.fragmentSource,R.fragmentSource,c.fragmentSource).join(`
`),Re=ye.concat(No.prelude.vertexSource,R.vertexSource,c.vertexSource).join(`
`);ea(U)||(Se=function(Ve){return Ve.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Se),Re=function(Ve){return Ve.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Re));const _e=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);if(U.shaderSource(_e,Se),U.compileShader(_e),!U.getShaderParameter(_e,U.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${U.getShaderInfoLog(_e)}`);U.attachShader(this.program,_e);const Ne=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);if(U.shaderSource(Ne,Re),U.compileShader(Ne),!U.getShaderParameter(Ne,U.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${U.getShaderInfoLog(Ne)}`);U.attachShader(this.program,Ne),this.attributes={};const We={};this.numAttributes=Y.length;for(let Ve=0;Ve<this.numAttributes;Ve++)Y[Ve]&&(U.bindAttribLocation(this.program,Ve,Y[Ve]),this.attributes[Y[Ve]]=Ve);if(U.linkProgram(this.program),!U.getProgramParameter(this.program,U.LINK_STATUS))throw new Error(`Program failed to link: ${U.getProgramInfoLog(this.program)}`);U.deleteShader(Ne),U.deleteShader(_e);for(let Ve=0;Ve<ve.length;Ve++){const $e=ve[Ve];if($e&&!We[$e]){const Xe=U.getUniformLocation(this.program,$e);Xe&&(We[$e]=Xe)}}this.fixedUniforms=v(t,We),this.terrainUniforms=((Ve,$e)=>({u_depth:new l.bP(Ve,$e.u_depth),u_terrain:new l.bP(Ve,$e.u_terrain),u_terrain_dim:new l.bg(Ve,$e.u_terrain_dim),u_terrain_matrix:new l.bR(Ve,$e.u_terrain_matrix),u_terrain_unpack:new l.bS(Ve,$e.u_terrain_unpack),u_terrain_exaggeration:new l.bg(Ve,$e.u_terrain_exaggeration)}))(t,We),this.projectionUniforms=((Ve,$e)=>({u_projection_matrix:new l.bR(Ve,$e.u_projection_matrix),u_projection_tile_mercator_coords:new l.bS(Ve,$e.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.bS(Ve,$e.u_projection_clipping_plane),u_projection_transition:new l.bg(Ve,$e.u_projection_transition),u_projection_fallback_matrix:new l.bR(Ve,$e.u_projection_fallback_matrix)}))(t,We),this.binderUniforms=p?p.getUniforms(t,We):[]}draw(t,c,p,v,T,M,R,P,j,U,$,G,Y,ee,he,ue,fe,pe,ve){const ye=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(p),t.setStencilMode(v),t.setColorMode(T),t.setCullFace(M),P){t.activeTexture.set(ye.TEXTURE2),ye.bindTexture(ye.TEXTURE_2D,P.depthTexture),t.activeTexture.set(ye.TEXTURE3),ye.bindTexture(ye.TEXTURE_2D,P.texture);for(const Re in this.terrainUniforms)this.terrainUniforms[Re].set(P[Re])}if(j)for(const Re in j)this.projectionUniforms[Yf[Re]].set(j[Re]);if(R)for(const Re in this.fixedUniforms)this.fixedUniforms[Re].set(R[Re]);ue&&ue.setUniforms(t,this.binderUniforms,ee,{zoom:he});let Se=0;switch(c){case ye.LINES:Se=2;break;case ye.TRIANGLES:Se=3;break;case ye.LINE_STRIP:Se=1}for(const Re of Y.get()){const _e=Re.vaos||(Re.vaos={});(_e[U]||(_e[U]=new oy)).bind(t,this,$,ue?ue.getPaintVertexBuffers():[],G,Re.vertexOffset,fe,pe,ve),ye.drawElements(c,Re.primitiveLength*Se,ye.UNSIGNED_SHORT,Re.primitiveOffset*Se*2)}}}function Jc(b,t,c){const p=1/l.aC(c,1,t.transform.tileZoom),v=Math.pow(2,c.tileID.overscaledZ),T=c.tileSize*Math.pow(2,t.transform.tileZoom)/v,M=T*(c.tileID.canonical.x+c.tileID.wrap*v),R=T*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[p,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[M>>16,R>>16],u_pixel_coord_lower:[65535&M,65535&R]}}const va=(b,t,c,p)=>{const v=b.style.light,T=v.properties.get("position"),M=[T.x,T.y,T.z],R=l.bV();v.properties.get("anchor")==="viewport"&&l.bW(R,b.transform.bearingInRadians),l.bX(M,M,R);const P=b.transform.transformLightDirection(M),j=v.properties.get("color");return{u_lightpos:M,u_lightpos_globe:P,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+t,u_opacity:c,u_fill_translate:p}},sy=(b,t,c,p,v,T,M)=>l.e(va(b,t,c,p),Jc(T,b,M),{u_height_factor:-Math.pow(2,v.overscaledZ)/M.tileSize/8}),fh=(b,t,c,p)=>l.e(Jc(t,b,c),{u_fill_translate:p}),eu=(b,t)=>({u_world:b,u_fill_translate:t}),tu=(b,t,c,p,v)=>l.e(fh(b,t,c,v),{u_world:p}),am=(b,t,c,p,v)=>{const T=b.transform;let M,R,P=0;if(c.paint.get("circle-pitch-alignment")==="map"){const j=l.aC(t,1,T.zoom);M=!0,R=[j,j],P=j/(l.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*v}else M=!1,R=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+M,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:R,u_globe_extrude_scale:P,u_translate:p}},ph=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),nu=b=>({u_viewport_size:[b.width,b.height]}),cc=(b,t=1)=>({u_color:b,u_overlay:0,u_overlay_scale:t}),om=(b,t,c,p)=>{const v=l.aC(b,1,t)/(l.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:l.aC(b,1,t),u_intensity:c,u_globe_extrude_scale:v}},qf=(b,t,c,p)=>{const v=l.L();l.bY(v,0,b.width,b.height,0,0,1);const T=b.context.gl;return{u_matrix:v,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:c,u_color_ramp:p,u_opacity:t.paint.get("heatmap-opacity")}},sm=(b,t,c)=>{const p=c.paint.get("hillshade-accent-color");let v;switch(c.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const T=c.getIlluminationProperties();for(let M=0;M<T.directionRadians.length;M++)c.paint.get("hillshade-illumination-anchor")==="viewport"&&(T.directionRadians[M]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:uc(0,t.tileID),u_exaggeration:c.paint.get("hillshade-exaggeration"),u_altitudes:T.altitudeRadians,u_azimuths:T.directionRadians,u_accent:p,u_method:v,u_highlights:T.highlightColor,u_shadows:T.shadowColor}},Xf=(b,t)=>{const c=t.stride,p=l.L();return l.bY(p,0,l.$,-l.$,0,0,1),l.M(p,p,[0,-l.$,0]),{u_matrix:p,u_image:1,u_dimension:[c,c],u_zoom:b.overscaledZ,u_unpack:t.getUnpackVector()}};function uc(b,t){const c=Math.pow(2,t.canonical.z),p=t.canonical.y;return[new l.a1(0,p/c).toLngLat().lat,new l.a1(0,(p+1)/c).toLngLat().lat]}const iu=(b,t,c=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:c,u_opacity:b.paint.get("color-relief-opacity")}),Pd=(b,t,c,p)=>{const v=b.transform;return{u_translation:yh(b,t,c),u_ratio:p/l.aC(t,1,v.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},mh=(b,t,c,p,v)=>l.e(Pd(b,t,c,p),{u_image:0,u_image_height:v}),Wf=(b,t,c,p,v)=>{const T=b.transform,M=gh(t,T);return{u_translation:yh(b,t,c),u_texsize:t.imageAtlasTexture.size,u_ratio:p/l.aC(t,1,T.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[M,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},El=(b,t,c,p,v,T)=>{const M=b.lineAtlas,R=gh(t,b.transform),P=c.layout.get("line-cap")==="round",j=M.getDash(v.from,P),U=M.getDash(v.to,P),$=j.width*T.fromScale,G=U.width*T.toScale;return l.e(Pd(b,t,c,p),{u_patternscale_a:[R/$,-j.height/2],u_patternscale_b:[R/G,-U.height/2],u_sdfgamma:M.width/(256*Math.min($,G)*b.pixelRatio)/2,u_image:0,u_tex_y_a:j.y,u_tex_y_b:U.y,u_mix:T.t})};function gh(b,t){return 1/l.aC(b,1,t.tileZoom)}function yh(b,t,c){return l.aD(b.transform,t,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const ru=(b,t,c,p,v)=>{return{u_tl_parent:b,u_scale_parent:t,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(M=p.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(T=p.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:lm(p.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var T,M};function lm(b){b*=Math.PI/180;const t=Math.sin(b),c=Math.cos(b);return[(2*c+1)/3,(-Math.sqrt(3)*t-c+1)/3,(Math.sqrt(3)*t-c+1)/3]}const au=(b,t,c,p,v,T,M,R,P,j,U,$,G)=>{const Y=M.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:Y.width/Y.height,u_fade_change:M.options.fadeDuration?M.symbolFadeChange:1,u_label_plane_matrix:R,u_coord_matrix:P,u_is_text:+U,u_pitch_with_map:+p,u_is_along_line:v,u_is_variable_anchor:T,u_texsize:$,u_texture:0,u_translation:j,u_pitched_scale:G}},cm=(b,t,c,p,v,T,M,R,P,j,U,$,G,Y)=>{const ee=M.transform;return l.e(au(b,t,c,p,v,T,M,R,P,j,U,$,Y),{u_gamma_scale:p?Math.cos(ee.pitch*Math.PI/180)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:M.pixelRatio,u_is_halo:1})},ly=(b,t,c,p,v,T,M,R,P,j,U,$,G)=>l.e(cm(b,t,c,p,v,T,M,R,P,j,!0,U,0,G),{u_texsize_icon:$,u_texture_icon:1}),um=(b,t)=>({u_opacity:b,u_color:t}),hm=(b,t,c,p,v)=>l.e(function(T,M,R,P){const j=R.imageManager.getPattern(T.from.toString()),U=R.imageManager.getPattern(T.to.toString()),{width:$,height:G}=R.imageManager.getPixelSize(),Y=Math.pow(2,P.tileID.overscaledZ),ee=P.tileSize*Math.pow(2,R.transform.tileZoom)/Y,he=ee*(P.tileID.canonical.x+P.tileID.wrap*Y),ue=ee*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[$,G],u_mix:M.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:M.fromScale,u_scale_b:M.toScale,u_tile_units_to_pixels:1/l.aC(P,1,R.transform.tileZoom),u_pixel_coord_upper:[he>>16,ue>>16],u_pixel_coord_lower:[65535&he,65535&ue]}}(c,v,t,p),{u_opacity:b}),Qf=(b,t)=>{},ba={fillExtrusion:(b,t)=>({u_lightpos:new l.bT(b,t.u_lightpos),u_lightpos_globe:new l.bT(b,t.u_lightpos_globe),u_lightintensity:new l.bg(b,t.u_lightintensity),u_lightcolor:new l.bT(b,t.u_lightcolor),u_vertical_gradient:new l.bg(b,t.u_vertical_gradient),u_opacity:new l.bg(b,t.u_opacity),u_fill_translate:new l.bU(b,t.u_fill_translate)}),fillExtrusionPattern:(b,t)=>({u_lightpos:new l.bT(b,t.u_lightpos),u_lightpos_globe:new l.bT(b,t.u_lightpos_globe),u_lightintensity:new l.bg(b,t.u_lightintensity),u_lightcolor:new l.bT(b,t.u_lightcolor),u_vertical_gradient:new l.bg(b,t.u_vertical_gradient),u_height_factor:new l.bg(b,t.u_height_factor),u_opacity:new l.bg(b,t.u_opacity),u_fill_translate:new l.bU(b,t.u_fill_translate),u_image:new l.bP(b,t.u_image),u_texsize:new l.bU(b,t.u_texsize),u_pixel_coord_upper:new l.bU(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(b,t.u_pixel_coord_lower),u_scale:new l.bT(b,t.u_scale),u_fade:new l.bg(b,t.u_fade)}),fill:(b,t)=>({u_fill_translate:new l.bU(b,t.u_fill_translate)}),fillPattern:(b,t)=>({u_image:new l.bP(b,t.u_image),u_texsize:new l.bU(b,t.u_texsize),u_pixel_coord_upper:new l.bU(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(b,t.u_pixel_coord_lower),u_scale:new l.bT(b,t.u_scale),u_fade:new l.bg(b,t.u_fade),u_fill_translate:new l.bU(b,t.u_fill_translate)}),fillOutline:(b,t)=>({u_world:new l.bU(b,t.u_world),u_fill_translate:new l.bU(b,t.u_fill_translate)}),fillOutlinePattern:(b,t)=>({u_world:new l.bU(b,t.u_world),u_image:new l.bP(b,t.u_image),u_texsize:new l.bU(b,t.u_texsize),u_pixel_coord_upper:new l.bU(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(b,t.u_pixel_coord_lower),u_scale:new l.bT(b,t.u_scale),u_fade:new l.bg(b,t.u_fade),u_fill_translate:new l.bU(b,t.u_fill_translate)}),circle:(b,t)=>({u_camera_to_center_distance:new l.bg(b,t.u_camera_to_center_distance),u_scale_with_map:new l.bP(b,t.u_scale_with_map),u_pitch_with_map:new l.bP(b,t.u_pitch_with_map),u_extrude_scale:new l.bU(b,t.u_extrude_scale),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_globe_extrude_scale:new l.bg(b,t.u_globe_extrude_scale),u_translate:new l.bU(b,t.u_translate)}),collisionBox:(b,t)=>({u_pixel_extrude_scale:new l.bU(b,t.u_pixel_extrude_scale)}),collisionCircle:(b,t)=>({u_viewport_size:new l.bU(b,t.u_viewport_size)}),debug:(b,t)=>({u_color:new l.bQ(b,t.u_color),u_overlay:new l.bP(b,t.u_overlay),u_overlay_scale:new l.bg(b,t.u_overlay_scale)}),depth:Qf,clippingMask:Qf,heatmap:(b,t)=>({u_extrude_scale:new l.bg(b,t.u_extrude_scale),u_intensity:new l.bg(b,t.u_intensity),u_globe_extrude_scale:new l.bg(b,t.u_globe_extrude_scale)}),heatmapTexture:(b,t)=>({u_matrix:new l.bR(b,t.u_matrix),u_world:new l.bU(b,t.u_world),u_image:new l.bP(b,t.u_image),u_color_ramp:new l.bP(b,t.u_color_ramp),u_opacity:new l.bg(b,t.u_opacity)}),hillshade:(b,t)=>({u_image:new l.bP(b,t.u_image),u_latrange:new l.bU(b,t.u_latrange),u_exaggeration:new l.bg(b,t.u_exaggeration),u_altitudes:new l.b_(b,t.u_altitudes),u_azimuths:new l.b_(b,t.u_azimuths),u_accent:new l.bQ(b,t.u_accent),u_method:new l.bP(b,t.u_method),u_shadows:new l.bZ(b,t.u_shadows),u_highlights:new l.bZ(b,t.u_highlights)}),hillshadePrepare:(b,t)=>({u_matrix:new l.bR(b,t.u_matrix),u_image:new l.bP(b,t.u_image),u_dimension:new l.bU(b,t.u_dimension),u_zoom:new l.bg(b,t.u_zoom),u_unpack:new l.bS(b,t.u_unpack)}),colorRelief:(b,t)=>({u_image:new l.bP(b,t.u_image),u_unpack:new l.bS(b,t.u_unpack),u_dimension:new l.bU(b,t.u_dimension),u_elevation_stops:new l.bP(b,t.u_elevation_stops),u_color_stops:new l.bP(b,t.u_color_stops),u_color_ramp_size:new l.bP(b,t.u_color_ramp_size),u_opacity:new l.bg(b,t.u_opacity)}),line:(b,t)=>({u_translation:new l.bU(b,t.u_translation),u_ratio:new l.bg(b,t.u_ratio),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.bU(b,t.u_units_to_pixels)}),lineGradient:(b,t)=>({u_translation:new l.bU(b,t.u_translation),u_ratio:new l.bg(b,t.u_ratio),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.bU(b,t.u_units_to_pixels),u_image:new l.bP(b,t.u_image),u_image_height:new l.bg(b,t.u_image_height)}),linePattern:(b,t)=>({u_translation:new l.bU(b,t.u_translation),u_texsize:new l.bU(b,t.u_texsize),u_ratio:new l.bg(b,t.u_ratio),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_image:new l.bP(b,t.u_image),u_units_to_pixels:new l.bU(b,t.u_units_to_pixels),u_scale:new l.bT(b,t.u_scale),u_fade:new l.bg(b,t.u_fade)}),lineSDF:(b,t)=>({u_translation:new l.bU(b,t.u_translation),u_ratio:new l.bg(b,t.u_ratio),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.bU(b,t.u_units_to_pixels),u_patternscale_a:new l.bU(b,t.u_patternscale_a),u_patternscale_b:new l.bU(b,t.u_patternscale_b),u_sdfgamma:new l.bg(b,t.u_sdfgamma),u_image:new l.bP(b,t.u_image),u_tex_y_a:new l.bg(b,t.u_tex_y_a),u_tex_y_b:new l.bg(b,t.u_tex_y_b),u_mix:new l.bg(b,t.u_mix)}),raster:(b,t)=>({u_tl_parent:new l.bU(b,t.u_tl_parent),u_scale_parent:new l.bg(b,t.u_scale_parent),u_buffer_scale:new l.bg(b,t.u_buffer_scale),u_fade_t:new l.bg(b,t.u_fade_t),u_opacity:new l.bg(b,t.u_opacity),u_image0:new l.bP(b,t.u_image0),u_image1:new l.bP(b,t.u_image1),u_brightness_low:new l.bg(b,t.u_brightness_low),u_brightness_high:new l.bg(b,t.u_brightness_high),u_saturation_factor:new l.bg(b,t.u_saturation_factor),u_contrast_factor:new l.bg(b,t.u_contrast_factor),u_spin_weights:new l.bT(b,t.u_spin_weights),u_coords_top:new l.bS(b,t.u_coords_top),u_coords_bottom:new l.bS(b,t.u_coords_bottom)}),symbolIcon:(b,t)=>({u_is_size_zoom_constant:new l.bP(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bP(b,t.u_is_size_feature_constant),u_size_t:new l.bg(b,t.u_size_t),u_size:new l.bg(b,t.u_size),u_camera_to_center_distance:new l.bg(b,t.u_camera_to_center_distance),u_pitch:new l.bg(b,t.u_pitch),u_rotate_symbol:new l.bP(b,t.u_rotate_symbol),u_aspect_ratio:new l.bg(b,t.u_aspect_ratio),u_fade_change:new l.bg(b,t.u_fade_change),u_label_plane_matrix:new l.bR(b,t.u_label_plane_matrix),u_coord_matrix:new l.bR(b,t.u_coord_matrix),u_is_text:new l.bP(b,t.u_is_text),u_pitch_with_map:new l.bP(b,t.u_pitch_with_map),u_is_along_line:new l.bP(b,t.u_is_along_line),u_is_variable_anchor:new l.bP(b,t.u_is_variable_anchor),u_texsize:new l.bU(b,t.u_texsize),u_texture:new l.bP(b,t.u_texture),u_translation:new l.bU(b,t.u_translation),u_pitched_scale:new l.bg(b,t.u_pitched_scale)}),symbolSDF:(b,t)=>({u_is_size_zoom_constant:new l.bP(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bP(b,t.u_is_size_feature_constant),u_size_t:new l.bg(b,t.u_size_t),u_size:new l.bg(b,t.u_size),u_camera_to_center_distance:new l.bg(b,t.u_camera_to_center_distance),u_pitch:new l.bg(b,t.u_pitch),u_rotate_symbol:new l.bP(b,t.u_rotate_symbol),u_aspect_ratio:new l.bg(b,t.u_aspect_ratio),u_fade_change:new l.bg(b,t.u_fade_change),u_label_plane_matrix:new l.bR(b,t.u_label_plane_matrix),u_coord_matrix:new l.bR(b,t.u_coord_matrix),u_is_text:new l.bP(b,t.u_is_text),u_pitch_with_map:new l.bP(b,t.u_pitch_with_map),u_is_along_line:new l.bP(b,t.u_is_along_line),u_is_variable_anchor:new l.bP(b,t.u_is_variable_anchor),u_texsize:new l.bU(b,t.u_texsize),u_texture:new l.bP(b,t.u_texture),u_gamma_scale:new l.bg(b,t.u_gamma_scale),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_is_halo:new l.bP(b,t.u_is_halo),u_translation:new l.bU(b,t.u_translation),u_pitched_scale:new l.bg(b,t.u_pitched_scale)}),symbolTextAndIcon:(b,t)=>({u_is_size_zoom_constant:new l.bP(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bP(b,t.u_is_size_feature_constant),u_size_t:new l.bg(b,t.u_size_t),u_size:new l.bg(b,t.u_size),u_camera_to_center_distance:new l.bg(b,t.u_camera_to_center_distance),u_pitch:new l.bg(b,t.u_pitch),u_rotate_symbol:new l.bP(b,t.u_rotate_symbol),u_aspect_ratio:new l.bg(b,t.u_aspect_ratio),u_fade_change:new l.bg(b,t.u_fade_change),u_label_plane_matrix:new l.bR(b,t.u_label_plane_matrix),u_coord_matrix:new l.bR(b,t.u_coord_matrix),u_is_text:new l.bP(b,t.u_is_text),u_pitch_with_map:new l.bP(b,t.u_pitch_with_map),u_is_along_line:new l.bP(b,t.u_is_along_line),u_is_variable_anchor:new l.bP(b,t.u_is_variable_anchor),u_texsize:new l.bU(b,t.u_texsize),u_texsize_icon:new l.bU(b,t.u_texsize_icon),u_texture:new l.bP(b,t.u_texture),u_texture_icon:new l.bP(b,t.u_texture_icon),u_gamma_scale:new l.bg(b,t.u_gamma_scale),u_device_pixel_ratio:new l.bg(b,t.u_device_pixel_ratio),u_is_halo:new l.bP(b,t.u_is_halo),u_translation:new l.bU(b,t.u_translation),u_pitched_scale:new l.bg(b,t.u_pitched_scale)}),background:(b,t)=>({u_opacity:new l.bg(b,t.u_opacity),u_color:new l.bQ(b,t.u_color)}),backgroundPattern:(b,t)=>({u_opacity:new l.bg(b,t.u_opacity),u_image:new l.bP(b,t.u_image),u_pattern_tl_a:new l.bU(b,t.u_pattern_tl_a),u_pattern_br_a:new l.bU(b,t.u_pattern_br_a),u_pattern_tl_b:new l.bU(b,t.u_pattern_tl_b),u_pattern_br_b:new l.bU(b,t.u_pattern_br_b),u_texsize:new l.bU(b,t.u_texsize),u_mix:new l.bg(b,t.u_mix),u_pattern_size_a:new l.bU(b,t.u_pattern_size_a),u_pattern_size_b:new l.bU(b,t.u_pattern_size_b),u_scale_a:new l.bg(b,t.u_scale_a),u_scale_b:new l.bg(b,t.u_scale_b),u_pixel_coord_upper:new l.bU(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(b,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bg(b,t.u_tile_units_to_pixels)}),terrain:(b,t)=>({u_texture:new l.bP(b,t.u_texture),u_ele_delta:new l.bg(b,t.u_ele_delta),u_fog_matrix:new l.bR(b,t.u_fog_matrix),u_fog_color:new l.bQ(b,t.u_fog_color),u_fog_ground_blend:new l.bg(b,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bg(b,t.u_fog_ground_blend_opacity),u_horizon_color:new l.bQ(b,t.u_horizon_color),u_horizon_fog_blend:new l.bg(b,t.u_horizon_fog_blend),u_is_globe_mode:new l.bg(b,t.u_is_globe_mode)}),terrainDepth:(b,t)=>({u_ele_delta:new l.bg(b,t.u_ele_delta)}),terrainCoords:(b,t)=>({u_texture:new l.bP(b,t.u_texture),u_terrain_coords_id:new l.bg(b,t.u_terrain_coords_id),u_ele_delta:new l.bg(b,t.u_ele_delta)}),projectionErrorMeasurement:(b,t)=>({u_input:new l.bg(b,t.u_input),u_output_expected:new l.bg(b,t.u_output_expected)}),atmosphere:(b,t)=>({u_sun_pos:new l.bT(b,t.u_sun_pos),u_atmosphere_blend:new l.bg(b,t.u_atmosphere_blend),u_globe_position:new l.bT(b,t.u_globe_position),u_globe_radius:new l.bg(b,t.u_globe_radius),u_inv_proj_matrix:new l.bR(b,t.u_inv_proj_matrix)}),sky:(b,t)=>({u_sky_color:new l.bQ(b,t.u_sky_color),u_horizon_color:new l.bQ(b,t.u_horizon_color),u_horizon:new l.bU(b,t.u_horizon),u_horizon_normal:new l.bU(b,t.u_horizon_normal),u_sky_horizon_blend:new l.bg(b,t.u_sky_horizon_blend),u_sky_blend:new l.bg(b,t.u_sky_blend)})};class ou{constructor(t,c,p){this.context=t;const v=t.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const _h={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ts{constructor(t,c,p,v){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=v,this.context=t;const T=t.gl;this.buffer=T.createBuffer(),t.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,c){for(let p=0;p<this.attributes.length;p++){const v=c.attributes[this.attributes[p].name];v!==void 0&&t.enableVertexAttribArray(v)}}setVertexAttribPointers(t,c,p){for(let v=0;v<this.attributes.length;v++){const T=this.attributes[v],M=c.attributes[T.name];M!==void 0&&t.vertexAttribPointer(M,T.components,t[_h[T.type]],!1,this.itemSize,T.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Gn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Od extends Gn{getDefault(){return l.bf.transparent}set(t){const c=this.current;(t.r!==c.r||t.g!==c.g||t.b!==c.b||t.a!==c.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class vh extends Gn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class dm extends Gn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ml extends Gn{getDefault(){return[!0,!0,!0,!0]}set(t){const c=this.current;(t[0]!==c[0]||t[1]!==c[1]||t[2]!==c[2]||t[3]!==c[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Hs extends Gn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class hc extends Gn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Kf extends Gn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const c=this.current;(t.func!==c.func||t.ref!==c.ref||t.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class fm extends Gn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const c=this.current;(t[0]!==c[0]||t[1]!==c[1]||t[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class dc extends Gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;t?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=t,this.dirty=!1}}class su extends Gn{getDefault(){return[0,1]}set(t){const c=this.current;(t[0]!==c[0]||t[1]!==c[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ld extends Gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;t?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=t,this.dirty=!1}}class pm extends Gn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Al extends Gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;t?c.enable(c.BLEND):c.disable(c.BLEND),this.current=t,this.dirty=!1}}class bh extends Gn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const c=this.current;(t[0]!==c[0]||t[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class xh extends Gn{getDefault(){return l.bf.transparent}set(t){const c=this.current;(t.r!==c.r||t.g!==c.g||t.b!==c.b||t.a!==c.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class wh extends Gn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Jf extends Gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;t?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=t,this.dirty=!1}}class fc extends Gn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Th extends Gn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class pc extends Gn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Ya extends Gn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Nd extends Gn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const c=this.current;(t[0]!==c[0]||t[1]!==c[1]||t[2]!==c[2]||t[3]!==c[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class mo extends Gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class zd extends Gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Nr extends Gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class xa extends Gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class qs extends Gn{getDefault(){return null}set(t){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class mc extends Gn{getDefault(){return null}set(t){var c;if(t===this.current&&!this.dirty)return;const p=this.gl;ea(p)?p.bindVertexArray(t):(c=p.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class gc extends Gn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Sh extends Gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Cl extends Gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ha extends Gn{constructor(t,c){super(t),this.context=t,this.parent=c}getDefault(){return null}}class ep extends Ha{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class lu extends Ha{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class vn extends Ha{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Eh="Framebuffer is not complete";class qa{constructor(t,c,p,v,T){this.context=t,this.width=c,this.height=p;const M=t.gl,R=this.framebuffer=M.createFramebuffer();if(this.colorAttachment=new ep(t,R),v)this.depthAttachment=T?new vn(t,R):new lu(t,R);else if(T)throw new Error("Stencil cannot be set without depth");if(M.checkFramebufferStatus(M.FRAMEBUFFER)!==M.FRAMEBUFFER_COMPLETE)throw new Error(Eh)}destroy(){const t=this.context.gl,c=this.colorAttachment.get();if(c&&t.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&t.deleteRenderbuffer(p)}t.deleteFramebuffer(this.framebuffer)}}class jd{constructor(t){var c,p;if(this.gl=t,this.clearColor=new Od(this),this.clearDepth=new vh(this),this.clearStencil=new dm(this),this.colorMask=new Ml(this),this.depthMask=new Hs(this),this.stencilMask=new hc(this),this.stencilFunc=new Kf(this),this.stencilOp=new fm(this),this.stencilTest=new dc(this),this.depthRange=new su(this),this.depthTest=new Ld(this),this.depthFunc=new pm(this),this.blend=new Al(this),this.blendFunc=new bh(this),this.blendColor=new xh(this),this.blendEquation=new wh(this),this.cullFace=new Jf(this),this.cullFaceSide=new fc(this),this.frontFace=new Th(this),this.program=new pc(this),this.activeTexture=new Ya(this),this.viewport=new Nd(this),this.bindFramebuffer=new mo(this),this.bindRenderbuffer=new zd(this),this.bindTexture=new Nr(this),this.bindVertexBuffer=new xa(this),this.bindElementBuffer=new qs(this),this.bindVertexArray=new mc(this),this.pixelStoreUnpack=new gc(this),this.pixelStoreUnpackPremultiplyAlpha=new Sh(this),this.pixelStoreUnpackFlipY=new Cl(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),ea(t)){this.HALF_FLOAT=t.HALF_FLOAT;const v=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=t.RGBA16F)!==null&&c!==void 0?c:v?.RGBA16F_EXT,this.RGB16F=(p=t.RGB16F)!==null&&p!==void 0?p:v?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const v=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,c){return new ou(this,t,c)}createVertexBuffer(t,c,p){return new Ts(this,t,c,p)}createRenderbuffer(t,c,p){const v=this.gl,T=v.createRenderbuffer();return this.bindRenderbuffer.set(T),v.renderbufferStorage(v.RENDERBUFFER,t,c,p),this.bindRenderbuffer.set(null),T}createFramebuffer(t,c,p,v){return new qa(this,t,c,p,v)}clear({color:t,depth:c,stencil:p}){const v=this.gl;let T=0;t&&(T|=v.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(T|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(T|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),v.clear(T)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.bH(t.blendFunction,fi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return ea(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var c;return ea(this.gl)?this.gl.deleteVertexArray(t):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let na;function tp(b,t,c,p,v){const T=b.context,M=b.transform,R=T.gl,P=b.useProgram("collisionBox"),j=[];let U=0,$=0;for(let fe=0;fe<p.length;fe++){const pe=p[fe],ve=t.getTile(pe).getBucket(c);if(!ve)continue;const ye=v?ve.textCollisionBox:ve.iconCollisionBox,Se=ve.collisionCircleArray;Se.length>0&&(j.push({circleArray:Se,circleOffset:$,coord:pe}),U+=Se.length/4,$=U),ye&&P.draw(T,R.LINES,on.disabled,Pn.disabled,b.colorModeForRenderPass(),Qt.disabled,ph(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(pe),M.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),c.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,null,b.transform.zoom,null,null,ye.collisionVertexBuffer)}if(!v||!j.length)return;const G=b.useProgram("collisionCircle"),Y=new l.b$;Y.resize(4*U),Y._trim();let ee=0;for(const fe of j)for(let pe=0;pe<fe.circleArray.length/4;pe++){const ve=4*pe,ye=fe.circleArray[ve+0],Se=fe.circleArray[ve+1],Re=fe.circleArray[ve+2],_e=fe.circleArray[ve+3];Y.emplace(ee++,ye,Se,Re,_e,0),Y.emplace(ee++,ye,Se,Re,_e,1),Y.emplace(ee++,ye,Se,Re,_e,2),Y.emplace(ee++,ye,Se,Re,_e,3)}(!na||na.length<2*U)&&(na=function(fe){const pe=2*fe,ve=new l.c1;ve.resize(pe),ve._trim();for(let ye=0;ye<pe;ye++){const Se=6*ye;ve.uint16[Se+0]=4*ye+0,ve.uint16[Se+1]=4*ye+1,ve.uint16[Se+2]=4*ye+2,ve.uint16[Se+3]=4*ye+2,ve.uint16[Se+4]=4*ye+3,ve.uint16[Se+5]=4*ye+0}return ve}(U));const he=T.createIndexBuffer(na,!0),ue=T.createVertexBuffer(Y,l.c0.members,!0);for(const fe of j){const pe=nu(b.transform);G.draw(T,R.TRIANGLES,on.disabled,Pn.disabled,b.colorModeForRenderPass(),Qt.disabled,pe,b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe.coord),null,c.id,ue,he,l.aM.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,b.transform.zoom,null,null,null)}ue.destroy(),he.destroy()}const Fd=l.ag(new Float32Array(16));function Dl(b,t,c,p,v,T){const{horizontalAlign:M,verticalAlign:R}=l.aH(b);return new l.P((-(M-.5)*t/v+p[0])*T,(-(R-.5)*c/v+p[1])*T)}function np(b,t,c,p,v,T){const M=t.tileAnchorPoint.add(new l.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let R=p.mult(T);c||(R=R.rotate(-v));const P=M.add(R);return Pi(P.x,P.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(c){const R=rr(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(b),P=Math.atan(R.y/R.x)+(R.x<0?Math.PI:0);return b.add(p.rotate(P))}return b.add(p)}function Mh(b,t,c,p,v,T,M,R,P,j,U,$){const G=b.text.placedSymbolArray,Y=b.text.dynamicLayoutVertexArray,ee=b.icon.dynamicLayoutVertexArray,he={};Y.clear();for(let ue=0;ue<G.length;ue++){const fe=G.get(ue),pe=fe.hidden||!fe.crossTileID||b.allowVerticalPlacement&&!fe.placedOrientation?null:p[fe.crossTileID];if(pe){const ve=new l.P(fe.anchorX,fe.anchorY),ye={getElevation:$,width:v.width,height:v.height,pitchedLabelPlaneMatrix:T,pitchWithMap:c,transform:v,tileAnchorPoint:ve,translation:j,unwrappedTileID:U},Se=c?Oi(ve.x,ve.y,ye):rr(ve.x,ve.y,ye),Re=wt(v.cameraToCenterDistance,Se.signedDistanceFromCamera);let _e=l.ap(b.textSizeData,R,fe)*Re/l.aB;c&&(_e*=b.tilePixelRatio/M);const{width:Ne,height:We,anchor:Ve,textOffset:$e,textBoxScale:Xe}=pe,Mt=Dl(Ve,Ne,We,$e,Xe,_e),vt=v.getPitchedTextCorrection(ve.x+j[0],ve.y+j[1],U),ct=np(Se.point,ye,t,Mt,-v.bearingInRadians,vt),Bt=b.allowVerticalPlacement&&fe.placedOrientation===l.ao.vertical?Math.PI/2:0;for(let bn=0;bn<fe.numGlyphs;bn++)l.av(Y,ct,Bt);P&&fe.associatedIconIndex>=0&&(he[fe.associatedIconIndex]={shiftedAnchor:ct,angle:Bt})}else ms(fe.numGlyphs,Y)}if(P){ee.clear();const ue=b.icon.placedSymbolArray;for(let fe=0;fe<ue.length;fe++){const pe=ue.get(fe);if(pe.hidden)ms(pe.numGlyphs,ee);else{const ve=he[fe];if(ve)for(let ye=0;ye<pe.numGlyphs;ye++)l.av(ee,ve.shiftedAnchor,ve.angle);else ms(pe.numGlyphs,ee)}}b.icon.dynamicLayoutVertexBuffer.updateData(ee)}b.text.dynamicLayoutVertexBuffer.updateData(Y)}function Xs(b,t,c){return c.iconsInText&&t?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Ss(b,t,c,p,v,T,M,R,P,j,U,$,G){const Y=b.context,ee=Y.gl,he=b.transform,ue=R==="map",fe=P==="map",pe=R!=="viewport"&&c.layout.get("symbol-placement")!=="point",ve=ue&&!fe&&!pe,ye=!c.layout.get("symbol-sort-key").isConstant();let Se=!1;const Re=b.getDepthModeForSublayer(0,on.ReadOnly),_e=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ne=[],We=he.getCircleRadiusCorrection();for(const Ve of p){const $e=t.getTile(Ve),Xe=$e.getBucket(c);if(!Xe)continue;const Mt=v?Xe.text:Xe.icon;if(!Mt||!Mt.segments.get().length||!Mt.hasVisibleVertices)continue;const vt=Mt.programConfigurations.get(c.id),ct=v||Xe.sdfIcons,Bt=v?Xe.textSizeData:Xe.iconSizeData,bn=fe||he.pitch!==0,jn=b.useProgram(Xs(ct,v,Xe),vt),zi=l.an(Bt,he.zoom),qn=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ve);let Ci,ji,pi,un,yr=[0,0],Ji=null;if(v)ji=$e.glyphAtlasTexture,pi=ee.LINEAR,Ci=$e.glyphAtlasTexture.size,Xe.iconsInText&&(yr=$e.imageAtlasTexture.size,Ji=$e.imageAtlasTexture,un=bn||b.options.rotating||b.options.zooming||Bt.kind==="composite"||Bt.kind==="camera"?ee.LINEAR:ee.NEAREST);else{const _i=c.layout.get("icon-size").constantOr(0)!==1||Xe.iconsNeedLinear;ji=$e.imageAtlasTexture,pi=ct||b.options.rotating||b.options.zooming||_i||bn?ee.LINEAR:ee.NEAREST,Ci=$e.imageAtlasTexture.size}const Er=l.aC($e,1,b.transform.zoom),Ta=di(ue,b.transform,Er),zl=l.L();l.aq(zl,Ta);const xo=Kt(fe,ue,b.transform,Er),wo=l.aD(he,$e,T,M),ol=he.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),Tc=_e&&Xe.hasTextData(),Sc=c.layout.get("icon-text-fit")!=="none"&&Tc&&Xe.hasIconData();if(pe){const _i=b.style.map.terrain?(ca,er)=>b.style.map.terrain.getElevation(Ve,ca,er):null,Xi=c.layout.get("text-rotation-alignment")==="map";Yi(Xe,b,v,Ta,zl,fe,j,Xi,Ve.toUnwrapped(),he.width,he.height,wo,_i)}const As=v&&_e||Sc,la=pe||As?Fd:fe?Ta:b.transform.clipSpaceToPixelsMatrix,$o=ct&&c.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Zo;Zo=ct?Xe.iconsInText?ly(Bt.kind,zi,ve,fe,pe,As,b,la,xo,wo,Ci,yr,We):cm(Bt.kind,zi,ve,fe,pe,As,b,la,xo,wo,v,Ci,0,We):au(Bt.kind,zi,ve,fe,pe,As,b,la,xo,wo,v,Ci,We);const no={program:jn,buffers:Mt,uniformValues:Zo,projectionData:ol,atlasTexture:ji,atlasTextureIcon:Ji,atlasInterpolation:pi,atlasInterpolationIcon:un,isSDF:ct,hasHalo:$o};if(ye&&Xe.canOverlap){Se=!0;const _i=Mt.segments.get();for(const Xi of _i)Ne.push({segments:new l.aM([Xi]),sortKey:Xi.sortKey,state:no,terrainData:qn})}else Ne.push({segments:Mt.segments,sortKey:0,state:no,terrainData:qn})}Se&&Ne.sort((Ve,$e)=>Ve.sortKey-$e.sortKey);for(const Ve of Ne){const $e=Ve.state;if(Y.activeTexture.set(ee.TEXTURE0),$e.atlasTexture.bind($e.atlasInterpolation,ee.CLAMP_TO_EDGE),$e.atlasTextureIcon&&(Y.activeTexture.set(ee.TEXTURE1),$e.atlasTextureIcon&&$e.atlasTextureIcon.bind($e.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),$e.isSDF){const Xe=$e.uniformValues;$e.hasHalo&&(Xe.u_is_halo=1,Il($e.buffers,Ve.segments,c,b,$e.program,Re,U,$,Xe,$e.projectionData,Ve.terrainData)),Xe.u_is_halo=0}Il($e.buffers,Ve.segments,c,b,$e.program,Re,U,$,$e.uniformValues,$e.projectionData,Ve.terrainData)}}function Il(b,t,c,p,v,T,M,R,P,j,U){const $=p.context;v.draw($,$.gl.TRIANGLES,T,M,R,Qt.backCCW,P,U,j,c.id,b.layoutVertexBuffer,b.indexBuffer,t,c.paint,p.transform.zoom,b.programConfigurations.get(c.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function cu(b,t,c,p,v){const T=b.context,M=T.gl,R=Pn.disabled,P=new fi([M.ONE,M.ONE],l.bf.transparent,[!0,!0,!0,!0]),j=t.getBucket(c);if(!j)return;const U=p.key;let $=c.heatmapFbos.get(U);$||($=ia(T,t.tileSize,t.tileSize),c.heatmapFbos.set(U,$)),T.bindFramebuffer.set($.framebuffer),T.viewport.set([0,0,t.tileSize,t.tileSize]),T.clear({color:l.bf.transparent});const G=j.programConfigurations.get(c.id),Y=b.useProgram("heatmap",G,!v),ee=b.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=b.style.map.terrain.getTerrainData(p);Y.draw(T,M.TRIANGLES,on.disabled,R,P,Qt.disabled,om(t,b.transform.zoom,c.paint.get("heatmap-intensity"),1),he,ee,c.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,c.paint,b.transform.zoom,G)}function Xa(b,t,c,p,v){const T=b.context,M=T.gl,R=b.transform;T.setColorMode(b.colorModeForRenderPass());const P=jo(T,t),j=c.key,U=t.heatmapFbos.get(j);if(!U)return;T.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,U.colorAttachment.get()),T.activeTexture.set(M.TEXTURE1),P.bind(M.LINEAR,M.CLAMP_TO_EDGE);const $=R.getProjectionData({overscaledTileID:c,applyTerrainMatrix:v,applyGlobeMatrix:!p});b.useProgram("heatmapTexture").draw(T,M.TRIANGLES,on.disabled,Pn.disabled,b.colorModeForRenderPass(),Qt.disabled,qf(b,t,0,1),null,$,t.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,t.paint,R.zoom),U.destroy(),t.heatmapFbos.delete(j)}function ia(b,t,c){var p,v;const T=b.gl,M=T.createTexture();T.bindTexture(T.TEXTURE_2D,M),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const R=(p=b.HALF_FLOAT)!==null&&p!==void 0?p:T.UNSIGNED_BYTE,P=(v=b.RGBA16F)!==null&&v!==void 0?v:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,P,t,c,0,T.RGBA,R,null);const j=b.createFramebuffer(t,c,!1,!1);return j.colorAttachment.set(M),j}function jo(b,t){return t.colorRampTexture||(t.colorRampTexture=new l.T(b,t.colorRamp,b.gl.RGBA)),t.colorRampTexture}function Wa(b,t,c,p,v){if(!c||!p||!p.imageAtlas)return;const T=p.imageAtlas.patternPositions;let M=T[c.to.toString()],R=T[c.from.toString()];if(!M&&R&&(M=R),!R&&M&&(R=M),!M||!R){const P=v.getPaintProperty(t);M=T[P],R=T[P]}M&&R&&b.setConstantPatternPositions(M,R)}function go(b,t,c,p,v,T,M,R){const P=b.context.gl,j="fill-pattern",U=c.paint.get(j),$=U&&U.constantOr(1),G=c.getCrossfadeParameters();let Y,ee,he,ue,fe;const pe=b.transform,ve=c.paint.get("fill-translate"),ye=c.paint.get("fill-translate-anchor");M?(ee=$&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=P.LINES):(ee=$?"fillPattern":"fill",Y=P.TRIANGLES);const Se=U.constantOr(null);for(const Re of p){const _e=t.getTile(Re);if($&&!_e.patternsLoaded())continue;const Ne=_e.getBucket(c);if(!Ne)continue;const We=Ne.programConfigurations.get(c.id),Ve=b.useProgram(ee,We),$e=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Re);$&&(b.context.activeTexture.set(P.TEXTURE0),_e.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),We.updatePaintBuffers(G)),Wa(We,j,Se,_e,c);const Xe=pe.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),Mt=l.aD(pe,_e,ve,ye);if(M){ue=Ne.indexBuffer2,fe=Ne.segments2;const ct=[P.drawingBufferWidth,P.drawingBufferHeight];he=ee==="fillOutlinePattern"&&$?tu(b,G,_e,ct,Mt):eu(ct,Mt)}else ue=Ne.indexBuffer,fe=Ne.segments,he=$?fh(b,G,_e,Mt):{u_fill_translate:Mt};const vt=b.stencilModeForClipping(Re);Ve.draw(b.context,Y,v,vt,T,Qt.backCCW,he,$e,Xe,c.id,Ne.layoutVertexBuffer,ue,fe,c.paint,b.transform.zoom,We)}}function Ws(b,t,c,p,v,T,M,R){const P=b.context,j=P.gl,U="fill-extrusion-pattern",$=c.paint.get(U),G=$.constantOr(1),Y=c.getCrossfadeParameters(),ee=c.paint.get("fill-extrusion-opacity"),he=$.constantOr(null),ue=b.transform;for(const fe of p){const pe=t.getTile(fe),ve=pe.getBucket(c);if(!ve)continue;const ye=b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe),Se=ve.programConfigurations.get(c.id),Re=b.useProgram(G?"fillExtrusionPattern":"fillExtrusion",Se);G&&(b.context.activeTexture.set(j.TEXTURE0),pe.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Se.updatePaintBuffers(Y));const _e=ue.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!R,applyTerrainMatrix:!0});Wa(Se,U,he,pe,c);const Ne=l.aD(ue,pe,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),We=c.paint.get("fill-extrusion-vertical-gradient"),Ve=G?sy(b,We,ee,Ne,fe,Y,pe):va(b,We,ee,Ne);Re.draw(P,P.gl.TRIANGLES,v,T,M,Qt.backCCW,Ve,ye,_e,c.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,c.paint,b.transform.zoom,Se,b.style.map.terrain&&ve.centroidVertexBuffer)}}function Rl(b,t,c,p,v,T,M,R,P){var j;const U=b.style.projection,$=b.context,G=b.transform,Y=$.gl,ee=[`#define NUM_ILLUMINATION_SOURCES ${c.paint.get("hillshade-highlight-color").values.length}`],he=b.useProgram("hillshade",null,!1,ee),ue=!b.options.moving;for(const fe of p){const pe=t.getTile(fe),ve=pe.fbo;if(!ve)continue;const ye=U.getMeshFromTileID($,fe.canonical,R,!0,"raster"),Se=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(fe);$.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ve.colorAttachment.get());const Re=G.getProjectionData({overscaledTileID:fe,aligned:ue,applyGlobeMatrix:!P,applyTerrainMatrix:!0});he.draw($,Y.TRIANGLES,T,v[fe.overscaledZ],M,Qt.backCCW,sm(b,pe,c),Se,Re,c.id,ye.vertexBuffer,ye.indexBuffer,ye.segments)}}function Ah(b,t,c,p,v,T,M,R,P){var j;const U=b.style.projection,$=b.context,G=b.transform,Y=$.gl,ee=b.useProgram("colorRelief"),he=!b.options.moving;let ue=!0,fe=0;for(const pe of p){const ve=t.getTile(pe),ye=ve.dem;if(ue){const Ve=Y.getParameter(Y.MAX_TEXTURE_SIZE),{elevationTexture:$e,colorTexture:Xe}=c.getColorRampTextures($,Ve,ye.getUnpackVector());$.activeTexture.set(Y.TEXTURE1),$e.bind(Y.NEAREST,Y.CLAMP_TO_EDGE),$.activeTexture.set(Y.TEXTURE4),Xe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),ue=!1,fe=$e.size[0]}if(!ye||!ye.data)continue;const Se=ye.stride,Re=ye.getPixels();if($.activeTexture.set(Y.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),ve.demTexture=ve.demTexture||b.getTileTexture(Se),ve.demTexture){const Ve=ve.demTexture;Ve.update(Re,{premultiply:!1}),Ve.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}else ve.demTexture=new l.T($,Re,Y.RGBA,{premultiply:!1}),ve.demTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const _e=U.getMeshFromTileID($,pe.canonical,R,!0,"raster"),Ne=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(pe),We=G.getProjectionData({overscaledTileID:pe,aligned:he,applyGlobeMatrix:!P,applyTerrainMatrix:!0});ee.draw($,Y.TRIANGLES,T,v[pe.overscaledZ],M,Qt.backCCW,iu(c,ve.dem,fe),Ne,We,c.id,_e.vertexBuffer,_e.indexBuffer,_e.segments)}}const uu=[new l.P(0,0),new l.P(l.$,0),new l.P(l.$,l.$),new l.P(0,l.$)];function or(b,t,c,p,v,T,M,R,P=!1,j=!1){const U=p[p.length-1].overscaledZ,$=b.context,G=$.gl,Y=b.useProgram("raster"),ee=b.transform,he=b.style.projection,ue=b.colorModeForRenderPass(),fe=!b.options.moving;for(const pe of p){const ve=b.getDepthModeForSublayer(pe.overscaledZ-U,c.paint.get("raster-opacity")===1?on.ReadWrite:on.ReadOnly,G.LESS),ye=t.getTile(pe);ye.registerFadeDuration(c.paint.get("raster-fade-duration"));const Se=t.findLoadedParent(pe,0),Re=t.findLoadedSibling(pe),_e=Ui(ye,Se||Re||null,t,c,b.transform,b.style.map.terrain);let Ne,We;const Ve=c.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;$.activeTexture.set(G.TEXTURE0),ye.texture.bind(Ve,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(G.TEXTURE1),Se?(Se.texture.bind(Ve,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),Ne=Math.pow(2,Se.tileID.overscaledZ-ye.tileID.overscaledZ),We=[ye.tileID.canonical.x*Ne%1,ye.tileID.canonical.y*Ne%1]):ye.texture.bind(Ve,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),ye.texture.useMipmap&&$.extTextureFilterAnisotropic&&b.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const $e=b.style.map.terrain&&b.style.map.terrain.getTerrainData(pe),Xe=ee.getProjectionData({overscaledTileID:pe,aligned:fe,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Mt=ru(We||[0,0],Ne||1,_e,c,R),vt=he.getMeshFromTileID($,pe.canonical,T,M,"raster");Y.draw($,G.TRIANGLES,ve,v?v[pe.overscaledZ]:Pn.disabled,ue,P?Qt.frontCCW:Qt.backCCW,Mt,$e,Xe,c.id,vt.vertexBuffer,vt.indexBuffer,vt.segments)}}function Ui(b,t,c,p,v,T){const M=p.paint.get("raster-fade-duration");if(!T&&M>0){const R=F.now(),P=(R-b.timeAdded)/M,j=t?(R-t.timeAdded)/M:-1,U=c.getSource(),$=jt(v,{tileSize:U.tileSize,roundZoom:U.roundZoom}),G=!t||Math.abs(t.tileID.overscaledZ-$)>Math.abs(b.tileID.overscaledZ-$),Y=G&&b.refreshedUponExpiration?1:l.ah(G?P:1-j,0,1);return b.refreshedUponExpiration&&P>=1&&(b.refreshedUponExpiration=!1),t?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Qn=new l.bf(1,0,0,1),kl=new l.bf(0,1,0,1),Qa=new l.bf(0,0,1,1),Ch=new l.bf(1,0,1,1),yc=new l.bf(0,1,1,1);function Bd(b,t,c,p){ka(b,0,t+c/2,b.transform.width,c,p)}function Vi(b,t,c,p){ka(b,t-c/2,0,c,b.transform.height,p)}function ka(b,t,c,p,v,T){const M=b.context,R=M.gl;R.enable(R.SCISSOR_TEST),R.scissor(t*b.pixelRatio,c*b.pixelRatio,p*b.pixelRatio,v*b.pixelRatio),M.clear({color:T}),R.disable(R.SCISSOR_TEST)}function ra(b,t,c){const p=b.context,v=p.gl,T=b.useProgram("debug"),M=on.disabled,R=Pn.disabled,P=b.colorModeForRenderPass(),j="$debug",U=b.style.map.terrain&&b.style.map.terrain.getTerrainData(c);p.activeTexture.set(v.TEXTURE0);const $=t.getTileByID(c.key).latestRawTileData,G=Math.floor(($&&$.byteLength||0)/1024),Y=t.getTile(c).tileSize,ee=512/Math.min(Y,512)*(c.overscaledZ/b.transform.zoom)*.5;let he=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(he+=` => ${c.overscaledZ}`),function(fe,pe){fe.initDebugOverlayCanvas();const ve=fe.debugOverlayCanvas,ye=fe.context.gl,Se=fe.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,ve.width,ve.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(pe,5,5),Se.strokeText(pe,5,5),fe.debugOverlayTexture.update(ve),fe.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(b,`${he} ${G}kB`);const ue=b.transform.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(p,v.TRIANGLES,M,R,fi.alphaBlended,Qt.disabled,cc(l.bf.transparent,ee),null,ue,j,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),T.draw(p,v.LINE_STRIP,M,R,P,Qt.disabled,cc(l.bf.red),U,ue,j,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Dh(b,t,c,p){const{isRenderingGlobe:v}=p,T=b.context,M=T.gl,R=b.transform,P=b.colorModeForRenderPass(),j=b.getDepthModeFor3D(),U=b.useProgram("terrain");T.bindFramebuffer.set(null),T.viewport.set([0,0,b.width,b.height]);for(const $ of c){const G=t.getTerrainMesh($.tileID),Y=b.renderToTexture.getTexture($),ee=t.getTerrainData($.tileID);T.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,Y.texture);const he=t.getMeshFrameDelta(R.zoom),ue=R.calculateFogMatrix($.tileID.toUnwrapped()),fe=kd(he,ue,b.style.sky,R.pitch,v),pe=R.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(T,M.TRIANGLES,j,Pn.disabled,P,Qt.backCCW,fe,ee,pe,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}}function Qs(b,t){if(!t.mesh){const c=new l.aL;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(1,1),c.emplaceBack(-1,1);const p=new l.aN;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),t.mesh=new xl(b.createVertexBuffer(c,vs.members),b.createIndexBuffer(p),l.aM.simpleSegment(0,0,c.length,p.length))}return t.mesh}class Ud{constructor(t,c){this.context=new jd(t),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Sn.maxUnderzooming+Sn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new tc}resize(t,c,p){if(this.width=Math.floor(t*p),this.height=Math.floor(c*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const t=this.context,c=new l.aL;c.emplaceBack(0,0),c.emplaceBack(l.$,0),c.emplaceBack(0,l.$),c.emplaceBack(l.$,l.$),this.tileExtentBuffer=t.createVertexBuffer(c,vs.members),this.tileExtentSegments=l.aM.simpleSegment(0,0,4,2);const p=new l.aL;p.emplaceBack(0,0),p.emplaceBack(l.$,0),p.emplaceBack(0,l.$),p.emplaceBack(l.$,l.$),this.debugBuffer=t.createVertexBuffer(p,vs.members),this.debugSegments=l.aM.simpleSegment(0,0,4,5);const v=new l.c6;v.emplaceBack(0,0,0,0),v.emplaceBack(l.$,0,l.$,0),v.emplaceBack(0,l.$,0,l.$),v.emplaceBack(l.$,l.$,l.$,l.$),this.rasterBoundsBuffer=t.createVertexBuffer(v,ay.members),this.rasterBoundsSegments=l.aM.simpleSegment(0,0,4,2);const T=new l.aL;T.emplaceBack(0,0),T.emplaceBack(l.$,0),T.emplaceBack(0,l.$),T.emplaceBack(l.$,l.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(T,vs.members),this.rasterBoundsSegmentsPosOnly=l.aM.simpleSegment(0,0,4,5);const M=new l.aL;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(M,vs.members),this.viewportSegments=l.aM.simpleSegment(0,0,4,2);const R=new l.c7;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(R);const P=new l.aN;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(P);const j=this.context.gl;this.stencilClearMode=new Pn({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new xl(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,c=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=l.L();l.bY(p,0,this.width,this.height,0,0,1),l.N(p,p,[c.drawingBufferWidth,c.drawingBufferHeight,0]);const v={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(t,c.TRIANGLES,on.disabled,this.stencilClearMode,fi.disabled,Qt.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,c,p){if(this.currentStencilSource===t.source||!t.isTileClipped()||!c||!c.length)return;this.currentStencilSource=t.source,this.nextStencilID+c.length>256&&this.clearStencil();const v=this.context;v.setColorMode(fi.disabled),v.setDepthMode(on.disabled);const T={};for(const M of c)T[M.key]=this.nextStencilID++;this._renderTileMasks(T,c,p,!0),this._renderTileMasks(T,c,p,!1),this._tileClippingMaskIDs=T}_renderTileMasks(t,c,p,v){const T=this.context,M=T.gl,R=this.style.projection,P=this.transform,j=this.useProgram("clippingMask");for(const U of c){const $=t[U.key],G=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),Y=R.getMeshFromTileID(this.context,U.canonical,v,!0,"stencil"),ee=P.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!p,applyTerrainMatrix:!0});j.draw(T,M.TRIANGLES,on.disabled,new Pn({func:M.ALWAYS,mask:0},$,255,M.KEEP,M.KEEP,M.REPLACE),fi.disabled,p?Qt.disabled:Qt.backCCW,null,G,ee,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}_renderTilesDepthBuffer(){const t=this.context,c=t.gl,p=this.style.projection,v=this.transform,T=this.useProgram("depth"),M=this.getDepthModeFor3D(),R=Fe(v,{tileSize:v.tileSize});for(const P of R){const j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),U=p.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),$=v.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(t,c.TRIANGLES,M,Pn.disabled,fi.disabled,Qt.backCCW,null,j,$,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,c=this.context.gl;return new Pn({func:c.NOTEQUAL,mask:255},t,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(t){const c=this.context.gl;return new Pn({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,c.KEEP,c.KEEP,c.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const c=this.context.gl,p=t.sort((M,R)=>R.overscaledZ-M.overscaledZ),v=p[p.length-1].overscaledZ,T=p[0].overscaledZ-v+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const M={};for(let R=0;R<T;R++)M[R+v]=new Pn({func:c.GEQUAL,mask:255},R+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=T,[M,p]}return[{[v]:Pn.disabled},p]}stencilConfigForOverlapTwoPass(t){const c=this.context.gl,p=t.sort((M,R)=>R.overscaledZ-M.overscaledZ),v=p[p.length-1].overscaledZ,T=p[0].overscaledZ-v+1;if(this.clearStencil(),T>1){const M={},R={};for(let P=0;P<T;P++)M[P+v]=new Pn({func:c.GREATER,mask:255},T+1+P,255,c.KEEP,c.KEEP,c.REPLACE),R[P+v]=new Pn({func:c.GREATER,mask:255},1+P,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID=2*T+1,[M,R,p]}return this.nextStencilID=3,[{[v]:new Pn({func:c.GREATER,mask:255},2,255,c.KEEP,c.KEEP,c.REPLACE)},{[v]:new Pn({func:c.GREATER,mask:255},1,255,c.KEEP,c.KEEP,c.REPLACE)},p]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new fi([t.CONSTANT_COLOR,t.ONE],new l.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fi.unblended:fi.alphaBlended}getDepthModeForSublayer(t,c,p){if(!this.opaquePassEnabledForLayer())return on.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new on(p||this.context.gl.LEQUAL,c,[v,v])}getDepthModeFor3D(){return new on(this.context.gl.LEQUAL,on.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,c){var p,v;this.style=t,this.options=c,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(F.now()),this.imageManager.beginFrame();const T=this.style._order,M=this.style.sourceCaches,R={},P={},j={},U={isRenderingToTexture:!1,isRenderingGlobe:((p=t.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const G in M){const Y=M[G];Y.used&&Y.prepare(this.context),R[G]=Y.getVisibleCoordinates(!1),P[G]=R[G].slice().reverse(),j[G]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<T.length;G++)if(this.style._layers[T[G]].is3D()){this.opaquePassCutoff=G;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const G of T){const Y=this.style._layers[G];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const ee=P[Y.source];(Y.type==="custom"||ee.length)&&this.renderLayer(this,M[Y.source],Y,ee,U)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:G=>this.useProgram(G)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?l.bf.black:l.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(G,Y){const ee=G.context,he=ee.gl,ue=((Re,_e,Ne)=>{const We=Math.cos(_e.rollInRadians),Ve=Math.sin(_e.rollInRadians),$e=De(_e),Xe=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Re.properties.get("sky-color"),u_horizon_color:Re.properties.get("horizon-color"),u_horizon:[(_e.width/2-$e*Ve)*Ne,(_e.height/2+$e*We)*Ne],u_horizon_normal:[-Ve,We],u_sky_horizon_blend:Re.properties.get("sky-horizon-blend")*_e.height/2*Ne,u_sky_blend:Xe}})(Y,G.style.map.transform,G.pixelRatio),fe=new on(he.LEQUAL,on.ReadWrite,[0,1]),pe=Pn.disabled,ve=G.colorModeForRenderPass(),ye=G.useProgram("sky"),Se=Qs(ee,Y);ye.draw(ee,he.TRIANGLES,fe,pe,ve,Qt.disabled,ue,null,void 0,"sky",Se.vertexBuffer,Se.indexBuffer,Se.segments)}(this,this.style.sky),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[T[this.currentLayer]],Y=M[G.source],ee=R[G.source];this._renderTileClippingMasks(G,ee,!1),this.renderLayer(this,Y,G,ee,U)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const G=this.style._layers[T[this.currentLayer]],Y=M[G.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(G,U))continue;this.opaquePassEnabledForLayer()||$||($=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ee=(G.type==="symbol"?j:P)[G.source];this._renderTileClippingMasks(G,R[G.source],!!this.renderToTexture),this.renderLayer(this,Y,G,ee,U)}if(U.isRenderingGlobe&&function(G,Y,ee){const he=G.context,ue=he.gl,fe=G.useProgram("atmosphere"),pe=new on(ue.LEQUAL,on.ReadOnly,[0,1]),ve=G.transform,ye=function(Xe,Mt){const vt=Xe.properties.get("position"),ct=[-vt.x,-vt.y,-vt.z],Bt=l.ag(new Float64Array(16));return Xe.properties.get("anchor")==="map"&&(l.b6(Bt,Bt,Mt.rollInRadians),l.b7(Bt,Bt,-Mt.pitchInRadians),l.b6(Bt,Bt,Mt.bearingInRadians),l.b7(Bt,Bt,Mt.center.lat*Math.PI/180),l.bz(Bt,Bt,-Mt.center.lng*Math.PI/180)),l.c5(ct,ct,Bt),ct}(ee,G.transform),Se=ve.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Re=Y.properties.get("atmosphere-blend")*Se.projectionTransition;if(Re===0)return;const _e=Qc(ve.worldSize,ve.center.lat),Ne=ve.inverseProjectionMatrix,We=new Float64Array(4);We[3]=1,l.aw(We,We,ve.modelViewProjectionMatrix),We[0]/=We[3],We[1]/=We[3],We[2]/=We[3],We[3]=1,l.aw(We,We,Ne),We[0]/=We[3],We[1]/=We[3],We[2]/=We[3],We[3]=1;const Ve=((Xe,Mt,vt,ct,Bt)=>({u_sun_pos:Xe,u_atmosphere_blend:Mt,u_globe_position:vt,u_globe_radius:ct,u_inv_proj_matrix:Bt}))(ye,Re,[We[0],We[1],We[2]],_e,Ne),$e=Qs(he,Y);fe.draw(he,ue.TRIANGLES,pe,Pn.disabled,fi.alphaBlended,Qt.disabled,Ve,null,null,"atmosphere",$e.vertexBuffer,$e.indexBuffer,$e.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const G=function(Y,ee){let he=null;const ue=Object.values(Y._layers).flatMap(ye=>ye.source&&!ye.isHidden(ee)?[Y.sourceCaches[ye.source]]:[]),fe=ue.filter(ye=>ye.getSource().type==="vector"),pe=ue.filter(ye=>ye.getSource().type!=="vector"),ve=ye=>{(!he||he.getSource().maxzoom<ye.getSource().maxzoom)&&(he=ye)};return fe.forEach(ye=>ve(ye)),he||pe.forEach(ye=>ve(ye)),he}(this.style,this.transform.zoom);G&&function(Y,ee,he){for(let ue=0;ue<he.length;ue++)ra(Y,ee,he[ue])}(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const Y=G.transform.padding;Bd(G,G.transform.height-(Y.top||0),3,Qn),Bd(G,Y.bottom||0,3,kl),Vi(G,Y.left||0,3,Qa),Vi(G,G.transform.width-(Y.right||0),3,Ch);const ee=G.transform.centerPoint;(function(he,ue,fe,pe){ka(he,ue-1,fe-10,2,20,pe),ka(he,ue-10,fe-1,20,2,pe)})(G,ee.x,G.transform.height-ee.y,yc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const c=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=t?!l.c8(c,p):!l.c9(c,p)),v||(v=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(l.ca(c,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(T,M){const R=T.context,P=R.gl,j=T.transform,U=fi.unblended,$=new on(P.LEQUAL,on.ReadWrite,[0,1]),G=M.sourceCache.getRenderableTiles(),Y=T.useProgram("terrainDepth");R.bindFramebuffer.set(M.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),R.clear({color:l.bf.transparent,depth:1});for(const ee of G){const he=M.getTerrainMesh(ee.tileID),ue=M.getTerrainData(ee.tileID),fe=j.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),pe={u_ele_delta:M.getMeshFrameDelta(j.zoom)};Y.draw(R,P.TRIANGLES,$,Pn.disabled,U,Qt.backCCW,pe,ue,fe,"terrain",he.vertexBuffer,he.indexBuffer,he.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,T.width,T.height])}(this,this.style.map.terrain),function(T,M){const R=T.context,P=R.gl,j=T.transform,U=fi.unblended,$=new on(P.LEQUAL,on.ReadWrite,[0,1]),G=M.getCoordsTexture(),Y=M.sourceCache.getRenderableTiles(),ee=T.useProgram("terrainCoords");R.bindFramebuffer.set(M.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),R.clear({color:l.bf.transparent,depth:1}),M.coordsIndex=[];for(const he of Y){const ue=M.getTerrainMesh(he.tileID),fe=M.getTerrainData(he.tileID);R.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,G.texture);const pe={u_terrain_coords_id:(255-M.coordsIndex.length)/255,u_texture:0,u_ele_delta:M.getMeshFrameDelta(j.zoom)},ve=j.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ee.draw(R,P.TRIANGLES,$,Pn.disabled,U,Qt.backCCW,pe,fe,ve,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),M.coordsIndex.push(he.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,T.width,T.height])}(this,this.style.map.terrain))}renderLayer(t,c,p,v,T){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(v||[]).length)&&(this.id=p.id,l.cb(p)?function(M,R,P,j,U,$){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:G}=$,Y=Pn.disabled,ee=M.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(he,ue,fe,pe,ve,ye,Se,Re,_e){const Ne=ue.transform,We=ue.style.map.terrain,Ve=ve==="map",$e=ye==="map";for(const Xe of he){const Mt=pe.getTile(Xe),vt=Mt.getBucket(fe);if(!vt||!vt.text||!vt.text.segments.get().length)continue;const ct=l.an(vt.textSizeData,Ne.zoom),Bt=l.aC(Mt,1,ue.transform.zoom),bn=di(Ve,ue.transform,Bt),jn=fe.layout.get("icon-text-fit")!=="none"&&vt.hasIconData();if(ct){const zi=Math.pow(2,Ne.zoom-Mt.tileID.overscaledZ),qn=We?(Ci,ji)=>We.getElevation(Xe,Ci,ji):null;Mh(vt,Ve,$e,_e,Ne,bn,zi,ct,jn,l.aD(Ne,Mt,Se,Re),Xe.toUnwrapped(),qn)}}}(j,M,P,R,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),U),P.paint.get("icon-opacity").constantOr(1)!==0&&Ss(M,R,P,j,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),Y,ee,G),P.paint.get("text-opacity").constantOr(1)!==0&&Ss(M,R,P,j,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),Y,ee,G),R.map.showCollisionBoxes&&(tp(M,R,P,j,!0),tp(M,R,P,j,!1))}(t,c,p,v,this.style.placement.variableOffsets,T):l.cc(p)?function(M,R,P,j,U){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:$}=U,G=P.paint.get("circle-opacity"),Y=P.paint.get("circle-stroke-width"),ee=P.paint.get("circle-stroke-opacity"),he=!P.layout.get("circle-sort-key").isConstant();if(G.constantOr(1)===0&&(Y.constantOr(1)===0||ee.constantOr(1)===0))return;const ue=M.context,fe=ue.gl,pe=M.transform,ve=M.getDepthModeForSublayer(0,on.ReadOnly),ye=Pn.disabled,Se=M.colorModeForRenderPass(),Re=[],_e=pe.getCircleRadiusCorrection();for(let Ne=0;Ne<j.length;Ne++){const We=j[Ne],Ve=R.getTile(We),$e=Ve.getBucket(P);if(!$e)continue;const Xe=P.paint.get("circle-translate"),Mt=P.paint.get("circle-translate-anchor"),vt=l.aD(pe,Ve,Xe,Mt),ct=$e.programConfigurations.get(P.id),Bt=M.useProgram("circle",ct),bn=$e.layoutVertexBuffer,jn=$e.indexBuffer,zi=M.style.map.terrain&&M.style.map.terrain.getTerrainData(We),qn={programConfiguration:ct,program:Bt,layoutVertexBuffer:bn,indexBuffer:jn,uniformValues:am(M,Ve,P,vt,_e),terrainData:zi,projectionData:pe.getProjectionData({overscaledTileID:We,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(he){const Ci=$e.segments.get();for(const ji of Ci)Re.push({segments:new l.aM([ji]),sortKey:ji.sortKey,state:qn})}else Re.push({segments:$e.segments,sortKey:0,state:qn})}he&&Re.sort((Ne,We)=>Ne.sortKey-We.sortKey);for(const Ne of Re){const{programConfiguration:We,program:Ve,layoutVertexBuffer:$e,indexBuffer:Xe,uniformValues:Mt,terrainData:vt,projectionData:ct}=Ne.state;Ve.draw(ue,fe.TRIANGLES,ve,ye,Se,Qt.backCCW,Mt,vt,ct,P.id,$e,Xe,Ne.segments,P.paint,M.transform.zoom,We)}}(t,c,p,v,T):l.cd(p)?function(M,R,P,j,U){if(P.paint.get("heatmap-opacity")===0)return;const $=M.context,{isRenderingToTexture:G,isRenderingGlobe:Y}=U;if(M.style.map.terrain){for(const ee of j){const he=R.getTile(ee);R.hasRenderableParent(ee)||(M.renderPass==="offscreen"?cu(M,he,P,ee,Y):M.renderPass==="translucent"&&Xa(M,P,ee,G,Y))}$.viewport.set([0,0,M.width,M.height])}else M.renderPass==="offscreen"?function(ee,he,ue,fe){const pe=ee.context,ve=pe.gl,ye=ee.transform,Se=Pn.disabled,Re=new fi([ve.ONE,ve.ONE],l.bf.transparent,[!0,!0,!0,!0]);(function(_e,Ne,We){const Ve=_e.gl;_e.activeTexture.set(Ve.TEXTURE1),_e.viewport.set([0,0,Ne.width/4,Ne.height/4]);let $e=We.heatmapFbos.get(l.c2);$e?(Ve.bindTexture(Ve.TEXTURE_2D,$e.colorAttachment.get()),_e.bindFramebuffer.set($e.framebuffer)):($e=ia(_e,Ne.width/4,Ne.height/4),We.heatmapFbos.set(l.c2,$e))})(pe,ee,ue),pe.clear({color:l.bf.transparent});for(let _e=0;_e<fe.length;_e++){const Ne=fe[_e];if(he.hasRenderableParent(Ne))continue;const We=he.getTile(Ne),Ve=We.getBucket(ue);if(!Ve)continue;const $e=Ve.programConfigurations.get(ue.id),Xe=ee.useProgram("heatmap",$e),Mt=ye.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),vt=ye.getCircleRadiusCorrection();Xe.draw(pe,ve.TRIANGLES,on.disabled,Se,Re,Qt.backCCW,om(We,ye.zoom,ue.paint.get("heatmap-intensity"),vt),null,Mt,ue.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,ue.paint,ye.zoom,$e)}pe.viewport.set([0,0,ee.width,ee.height])}(M,R,P,j):M.renderPass==="translucent"&&function(ee,he){const ue=ee.context,fe=ue.gl;ue.setColorMode(ee.colorModeForRenderPass());const pe=he.heatmapFbos.get(l.c2);pe&&(ue.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,pe.colorAttachment.get()),ue.activeTexture.set(fe.TEXTURE1),jo(ue,he).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),ee.useProgram("heatmapTexture").draw(ue,fe.TRIANGLES,on.disabled,Pn.disabled,ee.colorModeForRenderPass(),Qt.disabled,qf(ee,he,0,1),null,null,he.id,ee.viewportBuffer,ee.quadTriangleIndexBuffer,ee.viewportSegments,he.paint,ee.transform.zoom))}(M,P)}(t,c,p,v,T):l.ce(p)?function(M,R,P,j,U){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:$}=U,G=P.paint.get("line-opacity"),Y=P.paint.get("line-width");if(G.constantOr(1)===0||Y.constantOr(1)===0)return;const ee=M.getDepthModeForSublayer(0,on.ReadOnly),he=M.colorModeForRenderPass(),ue=P.paint.get("line-dasharray"),fe=P.paint.get("line-pattern"),pe=fe.constantOr(1),ve=P.paint.get("line-gradient"),ye=P.getCrossfadeParameters(),Se=pe?"linePattern":ue?"lineSDF":ve?"lineGradient":"line",Re=M.context,_e=Re.gl,Ne=M.transform;let We=!0;for(const Ve of j){const $e=R.getTile(Ve);if(pe&&!$e.patternsLoaded())continue;const Xe=$e.getBucket(P);if(!Xe)continue;const Mt=Xe.programConfigurations.get(P.id),vt=M.context.program.get(),ct=M.useProgram(Se,Mt),Bt=We||ct.program!==vt,bn=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Ve),jn=fe.constantOr(null);if(jn&&$e.imageAtlas){const pi=$e.imageAtlas,un=pi.patternPositions[jn.to.toString()],yr=pi.patternPositions[jn.from.toString()];un&&yr&&Mt.setConstantPatternPositions(un,yr)}const zi=Ne.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),qn=Ne.getPixelScale(),Ci=pe?Wf(M,$e,P,qn,ye):ue?El(M,$e,P,qn,ue,ye):ve?mh(M,$e,P,qn,Xe.lineClipsArray.length):Pd(M,$e,P,qn);if(pe)Re.activeTexture.set(_e.TEXTURE0),$e.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),Mt.updatePaintBuffers(ye);else if(ue&&(Bt||M.lineAtlas.dirty))Re.activeTexture.set(_e.TEXTURE0),M.lineAtlas.bind(Re);else if(ve){const pi=Xe.gradients[P.id];let un=pi.texture;if(P.gradientVersion!==pi.version){let yr=256;if(P.stepInterpolant){const Ji=R.getSource().maxzoom,Er=Ve.canonical.z===Ji?Math.ceil(1<<M.transform.maxZoom-Ve.canonical.z):1;yr=l.ah(l.c3(Xe.maxLineLength/l.$*1024*Er),256,Re.maxTextureSize)}pi.gradient=l.c4({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:yr,image:pi.gradient||void 0,clips:Xe.lineClipsArray}),pi.texture?pi.texture.update(pi.gradient):pi.texture=new l.T(Re,pi.gradient,_e.RGBA),pi.version=P.gradientVersion,un=pi.texture}Re.activeTexture.set(_e.TEXTURE0),un.bind(P.stepInterpolant?_e.NEAREST:_e.LINEAR,_e.CLAMP_TO_EDGE)}const ji=M.stencilModeForClipping(Ve);ct.draw(Re,_e.TRIANGLES,ee,ji,he,Qt.disabled,Ci,bn,zi,P.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,P.paint,M.transform.zoom,Mt,Xe.layoutVertexBuffer2),We=!1}}(t,c,p,v,T):l.cf(p)?function(M,R,P,j,U){const $=P.paint.get("fill-color"),G=P.paint.get("fill-opacity");if(G.constantOr(1)===0)return;const{isRenderingToTexture:Y}=U,ee=M.colorModeForRenderPass(),he=P.paint.get("fill-pattern"),ue=M.opaquePassEnabledForLayer()&&!he.constantOr(1)&&$.constantOr(l.bf.transparent).a===1&&G.constantOr(0)===1?"opaque":"translucent";if(M.renderPass===ue){const fe=M.getDepthModeForSublayer(1,M.renderPass==="opaque"?on.ReadWrite:on.ReadOnly);go(M,R,P,j,fe,ee,!1,Y)}if(M.renderPass==="translucent"&&P.paint.get("fill-antialias")){const fe=M.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,on.ReadOnly);go(M,R,P,j,fe,ee,!0,Y)}}(t,c,p,v,T):l.cg(p)?function(M,R,P,j,U){const $=P.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:G}=U;if(M.renderPass==="translucent"){const Y=new on(M.context.gl.LEQUAL,on.ReadWrite,M.depthRangeFor3D);if($!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))Ws(M,R,P,j,Y,Pn.disabled,fi.disabled,G),Ws(M,R,P,j,Y,M.stencilModeFor3D(),M.colorModeForRenderPass(),G);else{const ee=M.colorModeForRenderPass();Ws(M,R,P,j,Y,Pn.disabled,ee,G)}}}(t,c,p,v,T):l.ch(p)?function(M,R,P,j,U){if(M.renderPass!=="offscreen"&&M.renderPass!=="translucent")return;const{isRenderingToTexture:$}=U,G=M.context,Y=M.style.projection.useSubdivision,ee=M.getDepthModeForSublayer(0,on.ReadOnly),he=M.colorModeForRenderPass();if(M.renderPass==="offscreen")(function(ue,fe,pe,ve,ye,Se,Re){const _e=ue.context,Ne=_e.gl;for(const We of pe){const Ve=fe.getTile(We),$e=Ve.dem;if(!$e||!$e.data||!Ve.needsHillshadePrepare)continue;const Xe=$e.dim,Mt=$e.stride,vt=$e.getPixels();if(_e.activeTexture.set(Ne.TEXTURE1),_e.pixelStoreUnpackPremultiplyAlpha.set(!1),Ve.demTexture=Ve.demTexture||ue.getTileTexture(Mt),Ve.demTexture){const Bt=Ve.demTexture;Bt.update(vt,{premultiply:!1}),Bt.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE)}else Ve.demTexture=new l.T(_e,vt,Ne.RGBA,{premultiply:!1}),Ve.demTexture.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE);_e.activeTexture.set(Ne.TEXTURE0);let ct=Ve.fbo;if(!ct){const Bt=new l.T(_e,{width:Xe,height:Xe,data:null},Ne.RGBA);Bt.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),ct=Ve.fbo=_e.createFramebuffer(Xe,Xe,!0,!1),ct.colorAttachment.set(Bt.texture)}_e.bindFramebuffer.set(ct.framebuffer),_e.viewport.set([0,0,Xe,Xe]),ue.useProgram("hillshadePrepare").draw(_e,Ne.TRIANGLES,ye,Se,Re,Qt.disabled,Xf(Ve.tileID,$e),null,null,ve.id,ue.rasterBoundsBuffer,ue.quadTriangleIndexBuffer,ue.rasterBoundsSegments),Ve.needsHillshadePrepare=!1}})(M,R,j,P,ee,Pn.disabled,he),G.viewport.set([0,0,M.width,M.height]);else if(M.renderPass==="translucent")if(Y){const[ue,fe,pe]=M.stencilConfigForOverlapTwoPass(j);Rl(M,R,P,pe,ue,ee,he,!1,$),Rl(M,R,P,pe,fe,ee,he,!0,$)}else{const[ue,fe]=M.getStencilConfigForOverlapAndUpdateStencilID(j);Rl(M,R,P,fe,ue,ee,he,!1,$)}}(t,c,p,v,T):l.ci(p)?function(M,R,P,j,U){if(M.renderPass!=="translucent"||!j.length)return;const{isRenderingToTexture:$}=U,G=M.style.projection.useSubdivision,Y=M.getDepthModeForSublayer(0,on.ReadOnly),ee=M.colorModeForRenderPass();if(G){const[he,ue,fe]=M.stencilConfigForOverlapTwoPass(j);Ah(M,R,P,fe,he,Y,ee,!1,$),Ah(M,R,P,fe,ue,Y,ee,!0,$)}else{const[he,ue]=M.getStencilConfigForOverlapAndUpdateStencilID(j);Ah(M,R,P,ue,he,Y,ee,!1,$)}}(t,c,p,v,T):l.cj(p)?function(M,R,P,j,U){if(M.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!j.length)return;const{isRenderingToTexture:$}=U,G=R.getSource(),Y=M.style.projection.useSubdivision;if(G instanceof _a)or(M,R,P,j,null,!1,!1,G.tileCoords,G.flippedWindingOrder,$);else if(Y){const[ee,he,ue]=M.stencilConfigForOverlapTwoPass(j);or(M,R,P,ue,ee,!1,!0,uu,!1,$),or(M,R,P,ue,he,!0,!0,uu,!1,$)}else{const[ee,he]=M.getStencilConfigForOverlapAndUpdateStencilID(j);or(M,R,P,he,ee,!1,!0,uu,!1,$)}}(t,c,p,v,T):l.ck(p)?function(M,R,P,j,U){const $=P.paint.get("background-color"),G=P.paint.get("background-opacity");if(G===0)return;const{isRenderingToTexture:Y}=U,ee=M.context,he=ee.gl,ue=M.style.projection,fe=M.transform,pe=fe.tileSize,ve=P.paint.get("background-pattern");if(M.isPatternMissing(ve))return;const ye=!ve&&$.a===1&&G===1&&M.opaquePassEnabledForLayer()?"opaque":"translucent";if(M.renderPass!==ye)return;const Se=Pn.disabled,Re=M.getDepthModeForSublayer(0,ye==="opaque"?on.ReadWrite:on.ReadOnly),_e=M.colorModeForRenderPass(),Ne=M.useProgram(ve?"backgroundPattern":"background"),We=j||Fe(fe,{tileSize:pe,terrain:M.style.map.terrain});ve&&(ee.activeTexture.set(he.TEXTURE0),M.imageManager.bind(M.context));const Ve=P.getCrossfadeParameters();for(const $e of We){const Xe=fe.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),Mt=ve?hm(G,M,ve,{tileID:$e,tileSize:pe},Ve):um(G,$),vt=M.style.map.terrain&&M.style.map.terrain.getTerrainData($e),ct=ue.getMeshFromTileID(ee,$e.canonical,!1,!0,"raster");Ne.draw(ee,he.TRIANGLES,Re,Se,_e,Qt.backCCW,Mt,vt,Xe,P.id,ct.vertexBuffer,ct.indexBuffer,ct.segments)}}(t,0,p,v,T):l.cl(p)&&function(M,R,P,j){const{isRenderingGlobe:U}=j,$=M.context,G=P.implementation,Y=M.style.projection,ee=M.transform,he=ee.getProjectionDataForCustomLayer(U),ue={farZ:ee.farZ,nearZ:ee.nearZ,fov:ee.fov*Math.PI/180,modelViewProjectionMatrix:ee.modelViewProjectionMatrix,projectionMatrix:ee.projectionMatrix,shaderData:{variantName:Y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Y.shaderPreludeCode.vertexSource}`,define:Y.shaderDefine},defaultProjectionData:he},fe=G.renderingMode?G.renderingMode:"2d";if(M.renderPass==="offscreen"){const pe=G.prerender;pe&&(M.setCustomLayerDefaults(),$.setColorMode(M.colorModeForRenderPass()),pe.call(G,$.gl,ue),$.setDirty(),M.setBaseState())}else if(M.renderPass==="translucent"){M.setCustomLayerDefaults(),$.setColorMode(M.colorModeForRenderPass()),$.setStencilMode(Pn.disabled);const pe=fe==="3d"?M.getDepthModeFor3D():M.getDepthModeForSublayer(0,on.ReadOnly);$.setDepthMode(pe),G.render($.gl,ue),$.setDirty(),M.setBaseState(),$.bindFramebuffer.set(null)}}(t,0,p,T))}saveTileTexture(t){const c=this._tileTextures[t.size[0]];c?c.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const c=this._tileTextures[t];return c&&c.length>0?c.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const c=this.imageManager.getPattern(t.from.toString()),p=this.imageManager.getPattern(t.to.toString());return!c||!p}useProgram(t,c,p=!1,v=[]){this.cache=this.cache||{};const T=!!this.style.map.terrain,M=this.style.projection,R=p?No.projectionMercator:M.shaderPreludeCode,P=p?$s:M.shaderDefine,j=t+(c?c.cacheKey:"")+`/${p?nc:M.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(T?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[j]||(this.cache[j]=new Hf(this.context,No[t],c,ba[t],this._showOverdrawInspector,T,R,P,v)),this.cache[j]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:c}=this.context.gl;return this.width!==t||this.height!==c}}function Ka(b,t){let c,p=!1,v=null,T=null;const M=()=>{v=null,p&&(b.apply(T,c),v=setTimeout(M,t),p=!1)};return(...R)=>(p=!0,T=this,c=R,v||M(),v)}class yo{constructor(t){this._getCurrentHash=()=>{const c=window.location.hash.replace("#","");if(this._hashName){let p;return c.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(p=v)}),(p&&p[1]||"").split("/")}return c.split("/")},this._onHashChange=()=>{const c=this._getCurrentHash();if(!this._isValidHash(c))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0},this._updateHashUnthrottled=()=>{const c=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,c)},this._removeHash=()=>{const c=this._getCurrentHash();if(c.length===0)return;const p=c.join("/");let v=p;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${p}`);let T=window.location.hash.replace(v,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let M=window.location.href.replace(/(#.+)?$/,T);M=M.replace("&&","&"),window.history.replaceState(window.history.state,null,M)},this._updateHash=Ka(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const c=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,v),M=Math.round(c.lng*T)/T,R=Math.round(c.lat*T)/T,P=this._map.getBearing(),j=this._map.getPitch();let U="";if(U+=t?`/${M}/${R}/${p}`:`${p}/${R}/${M}`,(P||j)&&(U+="/"+Math.round(10*P)/10),j&&(U+=`/${Math.round(j)}`),this._hashName){const $=this._hashName;let G=!1;const Y=window.location.hash.slice(1).split("&").map(ee=>{const he=ee.split("=")[0];return he===$?(G=!0,`${he}=${U}`):ee}).filter(ee=>ee);return G||Y.push(`${$}=${U}`),`#${Y.join("&")}`}return`#${U}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new l.S(+t[2],+t[1])}catch{return!1}const c=+t[0],p=+(t[3]||0),v=+(t[4]||0);return c>=this._map.getMinZoom()&&c<=this._map.getMaxZoom()&&p>=-180&&p<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const aa={linearity:.3,easing:l.cm(0,0,.3,1)},Fo=l.e({deceleration:2500,maxSpeed:1400},aa),Vd=l.e({deceleration:20,maxSpeed:1400},aa),Gd=l.e({deceleration:1e3,maxSpeed:360},aa),hu=l.e({deceleration:1e3,maxSpeed:90},aa),Ih=l.e({deceleration:1e3,maxSpeed:360},aa);class Pl{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:F.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,c=F.now();for(;t.length>0&&c-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)c.zoom+=T.zoomDelta||0,c.bearing+=T.bearingDelta||0,c.pitch+=T.pitchDelta||0,c.roll+=T.rollDelta||0,T.panDelta&&c.pan._add(T.panDelta),T.around&&(c.around=T.around),T.pinchAround&&(c.pinchAround=T.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(c.pan.mag()){const T=Ks(c.pan.mag(),p,l.e({},Fo,t||{})),M=c.pan.mult(T.amount/c.pan.mag()),R=this._map.cameraHelper.handlePanInertia(M,this._map.transform);v.center=R.easingCenter,v.offset=R.easingOffset,Ai(v,T)}if(c.zoom){const T=Ks(c.zoom,p,Vd);v.zoom=this._map.transform.zoom+T.amount,Ai(v,T)}if(c.bearing){const T=Ks(c.bearing,p,Gd);v.bearing=this._map.transform.bearing+l.ah(T.amount,-179,179),Ai(v,T)}if(c.pitch){const T=Ks(c.pitch,p,hu);v.pitch=this._map.transform.pitch+T.amount,Ai(v,T)}if(c.roll){const T=Ks(c.roll,p,Ih);v.roll=this._map.transform.roll+l.ah(T.amount,-179,179),Ai(v,T)}if(v.zoom||v.bearing){const T=c.pinchAround===void 0?c.around:c.pinchAround;v.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),l.e(v,{noMoveStart:!0})}}function Ai(b,t){(!b.duration||b.duration<t.duration)&&(b.duration=t.duration,b.easing=t.easing)}function Ks(b,t,c){const{maxSpeed:p,linearity:v,deceleration:T}=c,M=l.ah(b*v/(t/1e3),-p,p),R=Math.abs(M)/(T*v);return{easing:c.easing,duration:1e3*R,amount:M*(R/2)}}class wa extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,c,p,v={}){p=p instanceof MouseEvent?p:new MouseEvent(t,p);const T=B.mousePos(c.getCanvas(),p),M=c.unproject(T);super(t,l.e({point:T,lngLat:M,originalEvent:p},v)),this._defaultPrevented=!1,this.target=c}}class du extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,c,p){const v=t==="touchend"?p.changedTouches:p.touches,T=B.touchPos(c.getCanvasContainer(),v),M=T.map(P=>c.unproject(P)),R=T.reduce((P,j,U,$)=>P.add(j.div($.length)),new l.P(0,0));super(t,{points:T,point:R,lngLats:M,lngLat:c.unproject(R),originalEvent:p}),this._defaultPrevented=!1}}class ip extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,c,p){super(t,{originalEvent:p}),this._defaultPrevented=!1}}class mm{constructor(t,c){this._map=t,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new ip(t.type,this._map,t))}mousedown(t,c){return this._mousedownPos=c,this._firePreventable(new wa(t.type,this._map,t))}mouseup(t){this._map.fire(new wa(t.type,this._map,t))}click(t,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new wa(t.type,this._map,t))}dblclick(t){return this._firePreventable(new wa(t.type,this._map,t))}mouseover(t){this._map.fire(new wa(t.type,this._map,t))}mouseout(t){this._map.fire(new wa(t.type,this._map,t))}touchstart(t){return this._firePreventable(new du(t.type,this._map,t))}touchmove(t){this._map.fire(new du(t.type,this._map,t))}touchend(t){this._map.fire(new du(t.type,this._map,t))}touchcancel(t){this._map.fire(new du(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new wa(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new wa(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ol{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(l.P.convert(t),this._map.terrain)}}class _c{constructor(t,c){this._map=t,this._tr=new Ol(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,c){this.isEnabled()&&t.shiftKey&&t.button===0&&(B.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(t,c){if(!this._active)return;const p=c;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=p,this._box||(this._box=B.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const T=Math.min(v.x,p.x),M=Math.max(v.x,p.x),R=Math.min(v.y,p.y),P=Math.max(v.y,p.y);B.setTransform(this._box,`translate(${T}px,${R}px)`),this._box.style.width=M-T+"px",this._box.style.height=P-R+"px"}mouseupWindow(t,c){if(!this._active||t.button!==0)return;const p=this._startPos,v=c;if(this.reset(),B.suppressClick(),p.x!==v.x||p.y!==v.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:t})),{cameraAnimation:T=>T.fitScreenCoordinates(p,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(B.remove(this._box),this._box=null),B.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,c){return this._map.fire(new l.l(t,{originalEvent:c}))}}function Es(b,t){if(b.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${t.length}`);const c={};for(let p=0;p<b.length;p++)c[b[p].identifier]=t[p];return c}class $d{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){const T=new l.P(0,0);for(const M of v)T._add(M);return T.div(v.length)}(c),this.touches=Es(p,c)))}touchmove(t,c,p){if(this.aborted||!this.centroid)return;const v=Es(p,c);for(const T in this.touches){const M=v[T];(!M||M.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(t,c,p){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Sr{constructor(t){this.singleTap=new $d(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,c,p){this.singleTap.touchstart(t,c,p)}touchmove(t,c,p){this.singleTap.touchmove(t,c,p)}touchend(t,c,p){const v=this.singleTap.touchend(t,c,p);if(v){const T=t.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(v)<30;if(T&&M||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class oa{constructor(t){this._tr=new Ol(t),this._zoomIn=new Sr({numTouches:1,numTaps:2}),this._zoomOut=new Sr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,c,p){this._zoomIn.touchstart(t,c,p),this._zoomOut.touchstart(t,c,p)}touchmove(t,c,p){this._zoomIn.touchmove(t,c,p),this._zoomOut.touchmove(t,c,p)}touchend(t,c,p){const v=this._zoomIn.touchend(t,c,p),T=this._zoomOut.touchend(t,c,p),M=this._tr;return v?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:M.zoom+1,around:M.unproject(v)},{originalEvent:t})}):T?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:M.zoom-1,around:M.unproject(T)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const c=this._moveFunction(...t);if(c.bearingDelta||c.pitchDelta||c.rollDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(t,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(c)?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,c){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const v=Array.isArray(c)?c[0]:c;return!this._moved&&v.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(p,v))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&B.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const _o=0,pu=2,gm={[_o]:1,[pu]:2};class Bo{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const c=B.mouseButton(t);this._eventButton=c}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(c,p){const v=gm[p];return c.buttons===void 0||(c.buttons&v)!==v}(t,this._eventButton)}isValidEndEvent(t){return B.mouseButton(t)===this._eventButton}}class rp{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Zd{constructor(t=new Bo({checkCorrectEvent:()=>!0}),c=new rp){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=c}_executeRelevantHandler(t,c,p){return t instanceof MouseEvent?c(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?p(t):void 0}startMove(t){this._executeRelevantHandler(t,c=>this.mouseMoveStateManager.startMove(c),c=>this.oneFingerTouchMoveStateManager.startMove(c))}endMove(t){this._executeRelevantHandler(t,c=>this.mouseMoveStateManager.endMove(c),c=>this.oneFingerTouchMoveStateManager.endMove(c))}isValidStartEvent(t){return this._executeRelevantHandler(t,c=>this.mouseMoveStateManager.isValidStartEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidStartEvent(c))}isValidMoveEvent(t){return this._executeRelevantHandler(t,c=>this.mouseMoveStateManager.isValidMoveEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(c))}isValidEndEvent(t){return this._executeRelevantHandler(t,c=>this.mouseMoveStateManager.isValidEndEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidEndEvent(c))}}const mu=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=t=>{t.preventDefault()}};class Js{constructor(t,c){this._clickTolerance=t.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,c,p){return this._calculateTransform(t,c,p)}touchmove(t,c,p){if(this._active){if(!this._shouldBePrevented(p.length))return t.preventDefault(),this._calculateTransform(t,c,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,c,p){this._calculateTransform(t,c,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,c,p){p.length>0&&(this._active=!0);const v=Es(p,c),T=new l.P(0,0),M=new l.P(0,0);let R=0;for(const j in v){const U=v[j],$=this._touches[j];$&&(T._add(U),M._add(U.sub($)),R++,v[j]=U)}if(this._touches=v,this._shouldBePrevented(R)||!M.mag())return;const P=M.div(R);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(R),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(t,c,p){if(!this._firstTwoTouches)return;t.preventDefault();const[v,T]=this._firstTwoTouches,M=kt(p,c,v),R=kt(p,c,T);if(!M||!R)return;const P=this._aroundCenter?null:M.add(R).div(2);return this._move([M,R],P,t)}touchend(t,c,p){if(!this._firstTwoTouches)return;const[v,T]=this._firstTwoTouches,M=kt(p,c,v),R=kt(p,c,T);M&&R||(this._active&&B.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function kt(b,t,c){for(let p=0;p<b.length;p++)if(b[p].identifier===c)return t[p]}function Rh(b,t){return Math.log(b/t)/Math.LN2}class kh extends vo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,c){const p=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Rh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Rh(this._distance,p),pinchAround:c}}}function gu(b,t){return 180*b.angleWith(t)/Math.PI}class vc extends vo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,c,p){const v=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:gu(this._vector,v),pinchAround:c}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const c=25/(Math.PI*this._minDiameter)*360,p=gu(t,this._startVector);return Math.abs(p)<c}}function Uo(b){return Math.abs(b.y)>Math.abs(b.x)}class Ph extends vo{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,c,p){super.touchstart(t,c,p),this._currentTouchCount=p.length}_start(t){this._lastPoints=t,Uo(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,c,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=t[0].sub(this._lastPoints[0]),T=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,T,p.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(t,c,p){if(this._valid!==void 0)return this._valid;const v=t.mag()>=2,T=c.mag()>=2;if(!v&&!T)return;if(!v||!T)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const M=t.y>0==c.y>0;return Uo(t)&&Uo(c)&&M}}const In={panStep:100,bearingStep:15,pitchStep:10};class Vo{constructor(t){this._tr=new Ol(t);const c=In;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let c=0,p=0,v=0,T=0,M=0;switch(t.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:t.shiftKey?p=-1:(t.preventDefault(),T=-1);break;case 39:t.shiftKey?p=1:(t.preventDefault(),T=1);break;case 38:t.shiftKey?v=1:(t.preventDefault(),M=-1);break;case 40:t.shiftKey?v=-1:(t.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(p=0,v=0),{cameraAnimation:R=>{const P=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:ap,zoom:c?Math.round(P.zoom)+c*(t.shiftKey?2:1):P.zoom,bearing:P.bearing+p*this._bearingStep,pitch:P.pitch+v*this._pitchStep,offset:[-T*this._panStep,-M*this._panStep],center:P.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ap(b){return b*(2-b)}const yu=4.000244140625,Ll=1/450;class el{constructor(t,c){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=t,this._tr=new Ol(t),this._triggerRenderFrame=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ll}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let c=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const p=F.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%yu==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(v*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),t.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=t,this._delta-=c,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=B.mousePos(this._map.getCanvas(),t),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(l.S.convert(p.center)):c,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const R=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=R),typeof this._targetZoom=="number"&&(this._targetZoom+=R)}if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>yu?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&P!==0&&(P=1/P);const j=typeof this._targetZoom!="number"?t.scale:l.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),l.ak(j*P)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const c=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,p=this._startZoom,v=this._easing;let T,M=!1;if(this._type==="wheel"&&p&&v){const R=F.now()-this._lastWheelEventTime,P=Math.min((R+5)/200,1),j=v(P);T=l.C.number(p,c,j),P<1?this._frameId||(this._frameId=!0):M=!0}else T=c,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=T,{noInertia:!0,needsRenderFrame:!M,zoomDelta:T-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let c=l.co;if(this._prevEase){const p=this._prevEase,v=(F.now()-p.start)/p.duration,T=p.easing(v+.01)-p.easing(v),M=.27/Math.sqrt(T*T+1e-4)*.01,R=Math.sqrt(.0729-M*M);c=l.cm(M,R,.25,1)}return this._prevEase={start:F.now(),duration:t,easing:c},c}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class bc{constructor(t,c){this._clickZoom=t,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Oh{constructor(t){this._tr=new Ol(t),this.reset()}reset(){this._active=!1}dblclick(t,c){return t.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yd{constructor(){this._tap=new Sr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,c,p){if(!this._swipePoint)if(this._tapTime){const v=c[0],T=t.timeStamp-this._tapTime<500,M=this._tapPoint.dist(v)<30;T&&M?p.length>0&&(this._swipePoint=v,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(t,c,p)}touchmove(t,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const v=c[0],T=v.y-this._swipePoint.y;return this._swipePoint=v,t.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(t,c,p)}touchend(t,c,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const v=this._tap.touchend(t,c,p);v&&(this._tapTime=t.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _u{constructor(t,c,p){this._el=t,this._mousePan=c,this._touchPan=p}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xc{constructor(t,c,p,v){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=c,this._mousePitch=p,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class op{constructor(t,c,p,v){this._el=t,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class sp{constructor(t,c){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=c,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=B.create("div","maplibregl-cooperative-gesture-screen",t);let c=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(c=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=c,this._container.appendChild(v);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=p,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(B.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,c){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:t,originalEvent:c})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const sa=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class ti extends l.l{}function Hd(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class vu{constructor(t,c){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,T)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const M=v.type==="renderFrame"?void 0:v,R={needsRenderFrame:!1},P={},j={};for(const{handlerName:G,handler:Y,allowed:ee}of this._handlers){if(!Y.isEnabled())continue;let he;if(this._blockedByActive(j,ee,G))Y.reset();else if(Y[T||v.type]){if(l.cp(v,T||v.type)){const ue=B.mousePos(this._map.getCanvas(),v);he=Y[T||v.type](v,ue)}else if(l.cq(v,T||v.type)){const ue=this._getMapTouches(v.touches),fe=B.touchPos(this._map.getCanvas(),ue);he=Y[T||v.type](v,fe,ue)}else l.cr(T||v.type)||(he=Y[T||v.type](v));this.mergeHandlerResult(R,P,he,G,M),he&&he.needsRenderFrame&&this._triggerRenderFrame()}(he||Y.isActive())&&(j[G]=Y)}const U={};for(const G in this._previousActiveHandlers)j[G]||(U[G]=M);this._previousActiveHandlers=j,(Object.keys(U).length||Hd(R))&&(this._changes.push([R,P,U]),this._triggerRenderFrame()),(Object.keys(j).length||Hd(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=R;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Pl(t),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,T,M]of this._listeners)B.addEventListener(v,T,v===document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[t,c,p]of this._listeners)B.removeEventListener(t,c,t===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(t){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new mm(c,t));const v=c.boxZoom=new _c(c,t);this._add("boxZoom",v),t.interactive&&t.boxZoom&&v.enable();const T=c.cooperativeGestures=new sp(c,t.cooperativeGestures);this._add("cooperativeGestures",T),t.cooperativeGestures&&T.enable();const M=new oa(c),R=new Oh(c);c.doubleClickZoom=new bc(R,M),this._add("tapZoom",M),this._add("clickZoom",R),t.interactive&&t.doubleClickZoom&&c.doubleClickZoom.enable();const P=new Yd;this._add("tapDragZoom",P);const j=c.touchPitch=new Ph(c);this._add("touchPitch",j),t.interactive&&t.touchPitch&&c.touchPitch.enable(t.touchPitch);const U=()=>c.project(c.getCenter()),$=function({enable:ye,clickTolerance:Se,aroundCenter:Re=!0,minPixelCenterThreshold:_e=100,rotateDegreesPerPixelMoved:Ne=.8},We){const Ve=new Bo({checkCorrectEvent:$e=>B.mouseButton($e)===0&&$e.ctrlKey||B.mouseButton($e)===2&&!$e.ctrlKey});return new fu({clickTolerance:Se,move:($e,Xe)=>{const Mt=We();if(Re&&Math.abs(Mt.y-$e.y)>_e)return{bearingDelta:l.cn(new l.P($e.x,Xe.y),Xe,Mt)};let vt=(Xe.x-$e.x)*Ne;return Re&&Xe.y<Mt.y&&(vt=-vt),{bearingDelta:vt}},moveStateManager:Ve,enable:ye,assignEvents:mu})}(t,U),G=function({enable:ye,clickTolerance:Se,pitchDegreesPerPixelMoved:Re=-.5}){const _e=new Bo({checkCorrectEvent:Ne=>B.mouseButton(Ne)===0&&Ne.ctrlKey||B.mouseButton(Ne)===2});return new fu({clickTolerance:Se,move:(Ne,We)=>({pitchDelta:(We.y-Ne.y)*Re}),moveStateManager:_e,enable:ye,assignEvents:mu})}(t),Y=function({enable:ye,clickTolerance:Se,rollDegreesPerPixelMoved:Re=.3},_e){const Ne=new Bo({checkCorrectEvent:We=>B.mouseButton(We)===2&&We.ctrlKey});return new fu({clickTolerance:Se,move:(We,Ve)=>{const $e=_e();let Xe=(Ve.x-We.x)*Re;return Ve.y<$e.y&&(Xe=-Xe),{rollDelta:Xe}},moveStateManager:Ne,enable:ye,assignEvents:mu})}(t,U);c.dragRotate=new xc(t,$,G,Y),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",G,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Y,["mousePitch"]),t.interactive&&t.dragRotate&&c.dragRotate.enable();const ee=function({enable:ye,clickTolerance:Se}){const Re=new Bo({checkCorrectEvent:_e=>B.mouseButton(_e)===0&&!_e.ctrlKey});return new fu({clickTolerance:Se,move:(_e,Ne)=>({around:Ne,panDelta:Ne.sub(_e)}),activateOnStart:!0,moveStateManager:Re,enable:ye,assignEvents:mu})}(t),he=new Js(t,c);c.dragPan=new _u(p,ee,he),this._add("mousePan",ee),this._add("touchPan",he,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&c.dragPan.enable(t.dragPan);const ue=new vc,fe=new kh;c.touchZoomRotate=new op(p,fe,ue,P),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&c.touchZoomRotate.enable(t.touchZoomRotate);const pe=c.scrollZoom=new el(c,()=>this._triggerRenderFrame());this._add("scrollZoom",pe,["mousePan"]),t.interactive&&t.scrollZoom&&c.scrollZoom.enable(t.scrollZoom);const ve=c.keyboard=new Vo(c);this._add("keyboard",ve),t.interactive&&t.keyboard&&c.keyboard.enable(),this._add("blockableMapEvent",new mr(c))}_add(t,c,p){this._handlers.push({handlerName:t,handler:c,allowed:p}),this._handlersById[t]=c}stop(t){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!sa(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,c,p){for(const v in t)if(v!==p&&(!c||c.indexOf(v)<0))return!0;return!1}_getMapTouches(t){const c=[];for(const p of t)this._el.contains(p.target)&&c.push(p);return c}mergeHandlerResult(t,c,p,v,T){if(!p)return;l.e(t,p);const M={handlerName:v,originalEvent:p.originalEvent||T};p.zoomDelta!==void 0&&(c.zoom=M),p.panDelta!==void 0&&(c.drag=M),p.rollDelta!==void 0&&(c.roll=M),p.pitchDelta!==void 0&&(c.pitch=M),p.bearingDelta!==void 0&&(c.rotate=M)}_applyChanges(){const t={},c={},p={};for(const[v,T,M]of this._changes)v.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(v.panDelta)),v.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(t.rollDelta=(t.rollDelta||0)+v.rollDelta),v.around!==void 0&&(t.around=v.around),v.pinchAround!==void 0&&(t.pinchAround=v.pinchAround),v.noInertia&&(t.noInertia=v.noInertia),l.e(c,T),l.e(p,M);this._updateMapTransform(t,c,p),this._changes=[]}_updateMapTransform(t,c,p){const v=this._map,T=v._getTransformForUpdate(),M=v.terrain;if(!(Hd(t)||M&&this._terrainMovement))return this._fireEvents(c,p,!0);v._stop(!0);let{panDelta:R,zoomDelta:P,bearingDelta:j,pitchDelta:U,rollDelta:$,around:G,pinchAround:Y}=t;Y!==void 0&&(G=Y),G=G||v.transform.centerPoint,M&&!T.isPointOnMapSurface(G)&&(G=T.centerPoint);const ee={panDelta:R,zoomDelta:P,rollDelta:$,pitchDelta:U,bearingDelta:j,around:G};this._map.cameraHelper.useGlobeControls&&!T.isPointOnMapSurface(G)&&(G=T.centerPoint);const he=G.distSqr(T.centerPoint)<.01?T.center:T.screenPointToLocation(R?G.sub(R):G);M?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ee,T),this._terrainMovement||!c.drag&&!c.zoom?c.drag&&this._terrainMovement?T.setCenter(T.screenPointToLocation(T.centerPoint.sub(R))):this._map.cameraHelper.handleMapControlsPan(ee,T,he):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ee,T,he))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ee,T),this._map.cameraHelper.handleMapControlsPan(ee,T,he)),v._applyUpdatedTransform(T),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(c,p,!0)}_fireEvents(t,c,p){const v=sa(this._eventsInProgress),T=sa(t),M={};for(const $ in t){const{originalEvent:G}=t[$];this._eventsInProgress[$]||(M[`${$}start`]=G),this._eventsInProgress[$]=t[$]}!v&&T&&this._fireEvent("movestart",T.originalEvent);for(const $ in M)this._fireEvent($,M[$]);T&&this._fireEvent("move",T.originalEvent);for(const $ in t){const{originalEvent:G}=t[$];this._fireEvent($,G)}const R={};let P;for(const $ in this._eventsInProgress){const{handlerName:G,originalEvent:Y}=this._eventsInProgress[$];this._handlersById[G].isActive()||(delete this._eventsInProgress[$],P=c[G]||Y,R[`${$}end`]=P)}for(const $ in R)this._fireEvent($,R[$]);const j=sa(this._eventsInProgress),U=(v||T)&&!j;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(p&&U){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),G=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!$||!$.essential&&F.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:P})),G(this._map.getBearing())&&this._map.resetNorth()):(G($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(t,c){this._map.fire(new l.l(t,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new ti("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Lh extends l.E{constructor(t,c,p){super(),this._renderFrameCallback=()=>{const v=Math.min((F.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=p.bearingSnap,this.cameraHelper=c,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,c){t.apply(this.transform),this.transform=t,this.cameraHelper=c}getCenter(){return new l.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,c){return this.jumpTo({center:t},c)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,c){return this.jumpTo({elevation:t},c),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,c,p){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},c),p)}panTo(t,c,p){return this.easeTo(l.e({center:t},c),p)}getZoom(){return this.transform.zoom}setZoom(t,c){return this.jumpTo({zoom:t},c),this}zoomTo(t,c,p){return this.easeTo(l.e({zoom:t},c),p)}zoomIn(t,c){return this.zoomTo(this.getZoom()+1,t,c),this}zoomOut(t,c){return this.zoomTo(this.getZoom()-1,t,c),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,c){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new l.l("movestart",c)).fire(new l.l("move",c)).fire(new l.l("moveend",c))),this}getBearing(){return this.transform.bearing}setBearing(t,c){return this.jumpTo({bearing:t},c),this}getPadding(){return this.transform.padding}setPadding(t,c){return this.jumpTo({padding:t},c),this}rotateTo(t,c,p){return this.easeTo(l.e({bearing:t},c),p)}resetNorth(t,c){return this.rotateTo(0,l.e({duration:1e3},t),c),this}resetNorthPitch(t,c){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},t),c),this}snapToNorth(t,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,c):this}getPitch(){return this.transform.pitch}setPitch(t,c){return this.jumpTo({pitch:t},c),this}getRoll(){return this.transform.roll}setRoll(t,c){return this.jumpTo({roll:t},c),this}cameraForBounds(t,c){t=Un.convert(t).adjustAntiMeridian();const p=c&&c.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),p,c)}_cameraForBoxAndBearing(t,c,p,v){const T={top:0,bottom:0,right:0,left:0};if(typeof(v=l.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const j=v.padding;v.padding={top:j,bottom:j,right:j,left:j}}const M=l.e(T,v.padding);v.padding=M;const R=this.transform,P=new Un(t,c);return this.cameraHelper.cameraForBoxAndBearing(v,M,P,p,R)}fitBounds(t,c,p){return this._fitInternal(this.cameraForBounds(t,c),c,p)}fitScreenCoordinates(t,c,p,v,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(t)),this.transform.screenPointToLocation(l.P.convert(c)),p,v),v,T)}_fitInternal(t,c,p){return t?(delete(c=l.e(t,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(t,c){this.stop();const p=this._getTransformForUpdate();let v=!1,T=!1,M=!1;const R=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,t);const P=p.zoom!==R;return"elevation"in t&&p.elevation!==+t.elevation&&p.setElevation(+t.elevation),"bearing"in t&&p.bearing!==+t.bearing&&(v=!0,p.setBearing(+t.bearing)),"pitch"in t&&p.pitch!==+t.pitch&&(T=!0,p.setPitch(+t.pitch)),"roll"in t&&p.roll!==+t.roll&&(M=!0,p.setRoll(+t.roll)),t.padding==null||p.isPaddingEqual(t.padding)||p.setPadding(t.padding),this._applyUpdatedTransform(p),this.fire(new l.l("movestart",c)).fire(new l.l("move",c)),P&&this.fire(new l.l("zoomstart",c)).fire(new l.l("zoom",c)).fire(new l.l("zoomend",c)),v&&this.fire(new l.l("rotatestart",c)).fire(new l.l("rotate",c)).fire(new l.l("rotateend",c)),T&&this.fire(new l.l("pitchstart",c)).fire(new l.l("pitch",c)).fire(new l.l("pitchend",c)),M&&this.fire(new l.l("rollstart",c)).fire(new l.l("roll",c)).fire(new l.l("rollend",c)),this.fire(new l.l("moveend",c))}calculateCameraOptionsFromTo(t,c,p,v=0){const T=l.a1.fromLngLat(t,c),M=l.a1.fromLngLat(p,v),R=M.x-T.x,P=M.y-T.y,j=M.z-T.z,U=Math.hypot(R,P,j);if(U===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(R,P),G=l.ak(this.transform.cameraToCenterDistance/U/this.transform.tileSize),Y=180*Math.atan2(R,-P)/Math.PI;let ee=180*Math.acos($/U)/Math.PI;return ee=j<0?90-ee:90+ee,{center:M.toLngLat(),elevation:v,zoom:G,pitch:ee,bearing:Y}}calculateCameraOptionsFromCameraLngLatAltRotation(t,c,p,v,T){const M=this.transform.calculateCenterFromCameraLngLatAlt(t,c,p,v);return{center:M.center,elevation:M.elevation,zoom:M.zoom,bearing:p,pitch:v,roll:T}}easeTo(t,c){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.co},t)).animate===!1||!t.essential&&F.prefersReducedMotion)&&(t.duration=0);const p=this._getTransformForUpdate(),v=this.getBearing(),T=p.pitch,M=p.roll,R="bearing"in t?this._normalizeBearing(t.bearing,v):v,P="pitch"in t?+t.pitch:T,j="roll"in t?this._normalizeBearing(t.roll,M):M,U="padding"in t?t.padding:p.padding,$=l.P.convert(t.offset);let G,Y;t.around&&(G=l.S.convert(t.around),Y=p.locationToScreenPoint(G));const ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},he=this.cameraHelper.handleEaseTo(p,{bearing:R,pitch:P,roll:j,padding:U,around:G,aroundPoint:Y,offsetAsPoint:$,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||v!==R,this._pitching=this._pitching||P!==T,this._rolling=this._rolling||j!==M,this._padding=!p.isPaddingEqual(U),this._zooming=this._zooming||he.isZooming,this._easeId=t.easeId,this._prepareEase(c,t.noMoveStart,ee),this.terrain&&this._prepareElevation(he.elevationCenter),this._ease(ue=>{he.easeFunc(ue),this.terrain&&!t.freezeElevation&&this._updateElevation(ue),this._applyUpdatedTransform(p),this._fireMoveEvents(c)},ue=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(c,ue)},t),this}_prepareEase(t,c,p={}){this._moving=!0,c||p.moving||this.fire(new l.l("movestart",t)),this._zooming&&!p.zooming&&this.fire(new l.l("zoomstart",t)),this._rotating&&!p.rotating&&this.fire(new l.l("rotatestart",t)),this._pitching&&!p.pitching&&this.fire(new l.l("pitchstart",t)),this._rolling&&!p.rolling&&this.fire(new l.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const c=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&c!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(p-(c-(p*t+this._elevationStart))/(1-t)),this._elevationTarget=c}this.transform.setElevation(l.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const c=t.getCameraLngLat(),p=t.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(c,t.zoom):0;if(p<v){const T=this.calculateCameraOptionsFromTo(c,v,t.center,t.elevation);return{pitch:T.pitch,zoom:T.zoom}}return{}}_applyUpdatedTransform(t){const c=[];if(c.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&c.push(v=>this.transformCameraUpdate(v)),!c.length)return;const p=t.clone();for(const v of c){const T=p.clone(),{center:M,zoom:R,roll:P,pitch:j,bearing:U,elevation:$}=v(T);M&&T.setCenter(M),$!==void 0&&T.setElevation($),R!==void 0&&T.setZoom(R),P!==void 0&&T.setRoll(P),j!==void 0&&T.setPitch(j),U!==void 0&&T.setBearing(U),p.apply(T)}this.transform.apply(p)}_fireMoveEvents(t){this.fire(new l.l("move",t)),this._zooming&&this.fire(new l.l("zoom",t)),this._rotating&&this.fire(new l.l("rotate",t)),this._pitching&&this.fire(new l.l("pitch",t)),this._rolling&&this.fire(new l.l("roll",t))}_afterEase(t,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;const p=this._zooming,v=this._rotating,T=this._pitching,M=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new l.l("zoomend",t)),v&&this.fire(new l.l("rotateend",t)),T&&this.fire(new l.l("pitchend",t)),M&&this.fire(new l.l("rollend",t)),this.fire(new l.l("moveend",t))}flyTo(t,c){if(!t.essential&&F.prefersReducedMotion){const Xe=l.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Xe,c)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.co},t);const p=this._getTransformForUpdate(),v=p.bearing,T=p.pitch,M=p.roll,R=p.padding,P="bearing"in t?this._normalizeBearing(t.bearing,v):v,j="pitch"in t?+t.pitch:T,U="roll"in t?this._normalizeBearing(t.roll,M):M,$="padding"in t?t.padding:p.padding,G=l.P.convert(t.offset);let Y=p.centerPoint.add(G);const ee=p.screenPointToLocation(Y),he=this.cameraHelper.handleFlyTo(p,{bearing:P,pitch:j,roll:U,padding:$,locationAtOffset:ee,offsetAsPoint:G,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ue=t.curve;const fe=Math.max(p.width,p.height),pe=fe/he.scaleOfZoom,ve=he.pixelPathLength;typeof he.scaleOfMinZoom=="number"&&(ue=Math.sqrt(fe/he.scaleOfMinZoom/ve*2));const ye=ue*ue;function Se(Xe){const Mt=(pe*pe-fe*fe+(Xe?-1:1)*ye*ye*ve*ve)/(2*(Xe?pe:fe)*ye*ve);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function Re(Xe){return(Math.exp(Xe)-Math.exp(-Xe))/2}function _e(Xe){return(Math.exp(Xe)+Math.exp(-Xe))/2}const Ne=Se(!1);let We=function(Xe){return _e(Ne)/_e(Ne+ue*Xe)},Ve=function(Xe){return fe*((_e(Ne)*(Re(Mt=Ne+ue*Xe)/_e(Mt))-Re(Ne))/ye)/ve;var Mt},$e=(Se(!0)-Ne)/ue;if(Math.abs(ve)<2e-6||!isFinite($e)){if(Math.abs(fe-pe)<1e-6)return this.easeTo(t,c);const Xe=pe<fe?-1:1;$e=Math.abs(Math.log(pe/fe))/ue,Ve=()=>0,We=Mt=>Math.exp(Xe*ue*Mt)}return t.duration="duration"in t?+t.duration:1e3*$e/("screenSpeed"in t?+t.screenSpeed/ue:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=v!==P,this._pitching=j!==T,this._rolling=U!==M,this._padding=!p.isPaddingEqual($),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(he.targetCenter),this._ease(Xe=>{const Mt=Xe*$e,vt=1/We(Mt),ct=Ve(Mt);this._rotating&&p.setBearing(l.C.number(v,P,Xe)),this._pitching&&p.setPitch(l.C.number(T,j,Xe)),this._rolling&&p.setRoll(l.C.number(M,U,Xe)),this._padding&&(p.interpolatePadding(R,$,Xe),Y=p.centerPoint.add(G)),he.easeFunc(Xe,vt,ct,Y),this.terrain&&!t.freezeElevation&&this._updateElevation(Xe),this._applyUpdatedTransform(p),this._fireMoveEvents(c)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(c)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,c){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,c)}return t||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(t,c,p){p.animate===!1||p.duration===0?(t(1),c()):(this._easeStart=F.now(),this._easeOptions=p,this._onEaseFrame=t,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,c){t=l.aO(t,-180,180);const p=Math.abs(t-c);return Math.abs(t-360-c)<p&&(t-=360),Math.abs(t+360-c)<p&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(l.S.convert(t),this.transform.tileZoom):null}}const Ms={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class An{constructor(t=Ms){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=c=>{!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=B.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=B.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=B.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){B.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,c){const p=this._map._getUIString(`AttributionControl.${c}`);t.title=p,t.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const c=this._map.style.sourceCaches;for(const v in c){const T=c[v];if(T.used||T.usedForTerrain){const M=T.getSource();M.attribution&&t.indexOf(M.attribution)<0&&t.push(M.attribution)}}t=t.filter(v=>String(v).trim()),t.sort((v,T)=>v.length-T.length),t=t.filter((v,T)=>{for(let M=T+1;M<t.length;M++)if(t[M].indexOf(v)>=0)return!1;return!0});const p=t.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,t.length?(this._innerContainer.innerHTML=B.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ri{constructor(t={}){this._updateCompact=()=>{const c=this._container.children;if(c.length){const p=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=B.create("div","maplibregl-ctrl");const c=B.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){B.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class gr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const c=++this._id;return this._queue.push({callback:t,id:c,cancelled:!1}),c}remove(t){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const v of p)if(v.id===t)return void(v.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ja=l.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class tl extends l.E{constructor(t){super(),this._lastTilesetChange=F.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,c){this.sourceCache.update(t,c),this._renderableTilesKeys=[];const p={};for(const v of Fe(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),l.bY(v.terrainRttPosMatrix32f,0,l.$,l.$,0,0,1),this._tiles[v.key]=new xr(v,this.tileSize),this._lastTilesetChange=F.now());for(const v in this._tiles)p[v]||delete this._tiles[v]}freeRtt(t){for(const c in this._tiles){const p=this._tiles[c];(!t||p.tileID.equals(t)||p.tileID.isChildOf(t)||t.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,c){return c?this._getTerrainCoordsForTileRanges(t,c):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const c={};for(const p of this._renderableTilesKeys){const v=this._tiles[p].tileID,T=t.clone(),M=l.ba();if(v.canonical.equals(t.canonical))l.bY(M,0,l.$,l.$,0,0,1);else if(v.canonical.isChildOf(t.canonical)){const R=v.canonical.z-t.canonical.z,P=v.canonical.x-(v.canonical.x>>R<<R),j=v.canonical.y-(v.canonical.y>>R<<R),U=l.$>>R;l.bY(M,0,U,U,0,0,1),l.M(M,M,[-P*U,-j*U,0])}else{if(!t.canonical.isChildOf(v.canonical))continue;{const R=t.canonical.z-v.canonical.z,P=t.canonical.x-(t.canonical.x>>R<<R),j=t.canonical.y-(t.canonical.y>>R<<R),U=l.$>>R;l.bY(M,0,l.$,l.$,0,0,1),l.M(M,M,[P*U,j*U,0]),l.N(M,M,[1/2**R,1/2**R,0])}}T.terrainRttPosMatrix32f=new Float32Array(M),c[p]=T}return c}_getTerrainCoordsForTileRanges(t,c){const p={};for(const v of this._renderableTilesKeys){const T=this._tiles[v].tileID;if(!this._isWithinTileRanges(T,c))continue;const M=t.clone(),R=l.ba();if(T.canonical.z===t.canonical.z){const P=t.canonical.x-T.canonical.x,j=t.canonical.y-T.canonical.y;l.bY(R,0,l.$,l.$,0,0,1),l.M(R,R,[P*l.$,j*l.$,0])}else if(T.canonical.z>t.canonical.z){const P=T.canonical.z-t.canonical.z,j=T.canonical.x-(T.canonical.x>>P<<P),U=T.canonical.y-(T.canonical.y>>P<<P),$=t.canonical.x-(T.canonical.x>>P),G=t.canonical.y-(T.canonical.y>>P),Y=l.$>>P;l.bY(R,0,Y,Y,0,0,1),l.M(R,R,[-j*Y+$*l.$,-U*Y+G*l.$,0])}else{const P=t.canonical.z-T.canonical.z,j=t.canonical.x-(t.canonical.x>>P<<P),U=t.canonical.y-(t.canonical.y>>P<<P),$=(t.canonical.x>>P)-T.canonical.x,G=(t.canonical.y>>P)-T.canonical.y,Y=l.$<<P;l.bY(R,0,Y,Y,0,0,1),l.M(R,R,[j*l.$+$*Y,U*l.$+G*Y,0])}M.terrainRttPosMatrix32f=new Float32Array(R),p[v]=M}return p}getSourceTile(t,c){const p=this.sourceCache._source;let v=t.overscaledZ-this.deltaZoom;if(v>p.maxzoom&&(v=p.maxzoom),v<p.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(v).key);let T=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!T||!T.dem)&&c)for(;v>=p.minzoom&&(!T||!T.dem);)T=this.sourceCache.getTileByID(t.scaledTo(v--).key);return T}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,c){return c[t.canonical.z]&&t.canonical.x>=c[t.canonical.z].minTileX&&t.canonical.x<=c[t.canonical.z].maxTileX&&t.canonical.y>=c[t.canonical.z].minTileY&&t.canonical.y<=c[t.canonical.z].maxTileY}}class Nt{constructor(t,c,p){this._meshCache={},this.painter=t,this.sourceCache=new tl(c),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,c,p,v=l.$){var T;if(!(c>=0&&c<v&&p>=0&&p<v))return 0;const M=this.getTerrainData(t),R=(T=M.tile)===null||T===void 0?void 0:T.dem;if(!R)return 0;const P=l.cs([],[c/v*l.$,p/v*l.$],M.u_terrain_matrix),j=[P[0]*R.dim,P[1]*R.dim],U=Math.floor(j[0]),$=Math.floor(j[1]),G=j[0]-U,Y=j[1]-$;return R.get(U,$)*(1-G)*(1-Y)+R.get(U+1,$)*G*(1-Y)+R.get(U,$+1)*(1-G)*Y+R.get(U+1,$+1)*G*Y}getElevationForLngLatZoom(t,c){if(!l.ct(c,t.wrap()))return 0;const{tileID:p,mercatorX:v,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(t,c);return this.getElevation(p,v%l.$,T%l.$,l.$)}getElevation(t,c,p,v=l.$){return this.getDEMElevation(t,c,p,v)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const v=this.painter.context,T=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(v,T,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(v,new l.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ag([])}const c=this.sourceCache.getSourceTile(t,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){const v=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new l.T(v,c.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),c.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}const p=c&&c+c.tileID.key+t.key;if(p&&!this._demMatrixCache[p]){const v=this.sourceCache.sourceCache._source.maxzoom;let T=t.canonical.z-c.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=v?T=t.canonical.z-v:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const M=t.canonical.x-(t.canonical.x>>T<<T),R=t.canonical.y-(t.canonical.y>>T<<T),P=l.cu(new Float64Array(16),[1/(l.$<<T),1/(l.$<<T),0]);l.M(P,P,[M*l.$,R*l.$,0]),this._demMatrixCache[t.key]={matrix:P,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(t){const c=this.painter,p=c.width/devicePixelRatio,v=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(c.context,{width:p,height:v,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(c.context,{width:p,height:v,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(p,v,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,p,v))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,M=0;T<this._coordsTextureSize;T++)for(let R=0;R<this._coordsTextureSize;R++,M+=4)c[M+0]=255&R,c[M+1]=255&T,c[M+2]=R>>8<<4|T>>8,c[M+3]=0;const p=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),v=new l.T(t,p,t.gl.RGBA,{premultiply:!1});return v.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const c=new Uint8Array(4),p=this.painter.context,v=p.gl,T=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),M=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(T,R-M-1,1,1,v.RGBA,v.UNSIGNED_BYTE,c),p.bindFramebuffer.set(null);const P=c[0]+(c[2]>>4<<8),j=c[1]+((15&c[2])<<8),U=this.coordsIndex[255-c[3]],$=U&&this.sourceCache.getTileByID(U);if(!$)return null;const G=this._coordsTextureSize,Y=(1<<$.tileID.canonical.z)*G;return new l.a1(($.tileID.canonical.x*G+P)/Y+$.tileID.wrap,($.tileID.canonical.y*G+j)/Y,this.getElevation($.tileID,P,j,G))}depthAtPoint(t){const c=new Uint8Array(4),p=this.painter.context,v=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,c),p.bindFramebuffer.set(null),(c[0]/16777216+c[1]/65536+c[2]/256+c[3])/256}getTerrainMesh(t){var c;const p=((c=this.painter.style.projection)===null||c===void 0?void 0:c.transitionState)>0,v=p&&t.canonical.y===0,T=p&&t.canonical.y===(1<<t.canonical.z)-1,M=`m_${v?"n":""}_${T?"s":""}`;if(this._meshCache[M])return this._meshCache[M];const R=this.painter.context,P=new l.cv,j=new l.aN,U=this.meshSize,$=l.$/U,G=U*U;for(let _e=0;_e<=U;_e++)for(let Ne=0;Ne<=U;Ne++)P.emplaceBack(Ne*$,_e*$,0);for(let _e=0;_e<G;_e+=U+1)for(let Ne=0;Ne<U;Ne++)j.emplaceBack(Ne+_e,U+Ne+_e+1,U+Ne+_e+2),j.emplaceBack(Ne+_e,U+Ne+_e+2,Ne+_e+1);const Y=P.length,ee=Y+(U+1),he=(U+1)*U,ue=v?l.bh:0,fe=v?0:1,pe=T?l.bi:l.$,ve=T?0:1;for(let _e=0;_e<=U;_e++)P.emplaceBack(_e*$,ue,fe);for(let _e=0;_e<=U;_e++)P.emplaceBack(_e*$,pe,ve);for(let _e=0;_e<U;_e++)j.emplaceBack(he+_e,ee+_e,ee+_e+1),j.emplaceBack(he+_e,ee+_e+1,he+_e+1),j.emplaceBack(0+_e,Y+_e+1,Y+_e),j.emplaceBack(0+_e,0+_e+1,Y+_e+1);const ye=P.length,Se=ye+2*(U+1);for(const _e of[0,1])for(let Ne=0;Ne<=U;Ne++)for(const We of[0,1])P.emplaceBack(_e*l.$,Ne*$,We);for(let _e=0;_e<2*U;_e+=2)j.emplaceBack(ye+_e,ye+_e+1,ye+_e+3),j.emplaceBack(ye+_e,ye+_e+3,ye+_e+2),j.emplaceBack(Se+_e,Se+_e+3,Se+_e+1),j.emplaceBack(Se+_e,Se+_e+2,Se+_e+3);const Re=new xl(R.createVertexBuffer(P,Ja.members),R.createIndexBuffer(j),l.aM.simpleSegment(0,0,P.length,j.length));return this._meshCache[M]=Re,Re}getMeshFrameDelta(t){return 2*Math.PI*l.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,c){var p;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(t,c);return(p=this.getMinMaxElevation(v).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(t){const c=this.getTerrainData(t).tile,p={minElevation:null,maxElevation:null};return c&&c.dem&&(p.minElevation=c.dem.min*this.exaggeration,p.maxElevation=c.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(t,c){const p=l.a1.fromLngLat(t.wrap()),v=(1<<c)*l.$,T=p.x*v,M=p.y*v,R=Math.floor(T/l.$),P=Math.floor(M/l.$);return{tileID:new l.Z(c,0,c,R,P),mercatorX:T,mercatorY:M}}}class qt{constructor(t,c,p){this._context=t,this._size=c,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(p.texture),{id:t,fbo:c,texture:p,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>t.id!==c),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const eo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Nl{constructor(t,c){this.painter=t,this.terrain=c,this.pool=new qt(t.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(p=>!t._layers[p].isHidden(c)),this._coordsAscending={};for(const p in t.sourceCaches){this._coordsAscending[p]={};const v=t.sourceCaches[p].getVisibleCoordinates(),T=t.sourceCaches[p].getSource(),M=T instanceof _a?T.terrainTileRanges:null;for(const R of v){const P=this.terrain.sourceCache.getTerrainCoords(R,M);for(const j in P)this._coordsAscending[p][j]||(this._coordsAscending[p][j]=[]),this._coordsAscending[p][j].push(P[j])}}this._coordsAscendingStr={};for(const p of t._order){const v=t._layers[p],T=v.source;if(eo[v.type]&&!this._coordsAscendingStr[T]){this._coordsAscendingStr[T]={};for(const M in this._coordsAscending[T])this._coordsAscendingStr[T][M]=this._coordsAscending[T][M].map(R=>R.key).sort().join()}}for(const p of this._renderableTiles)for(const v in this._coordsAscendingStr){const T=this._coordsAscendingStr[v][p.tileID.key];T&&T!==p.rttCoords[v]&&(p.rtt=[])}}renderLayer(t,c){if(t.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},c),{isRenderingToTexture:!0}),v=t.type,T=this.painter,M=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(eo[v]&&(this._prevType&&eo[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(t.id),!M))return!0;if(eo[this._prevType]||eo[v]&&M){this._prevType=v;const R=this._stacks.length-1,P=this._stacks[R]||[];for(const j of this._renderableTiles){if(this.pool.isFull()&&(Dh(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[R]){const $=this.pool.getObjectForId(j.rtt[R].id);if($.stamp===j.rtt[R].stamp){this.pool.useObject($);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),j.rtt[R]={id:U.id,stamp:U.stamp},T.context.bindFramebuffer.set(U.fbo.framebuffer),T.context.clear({color:l.bf.transparent,stencil:0}),T.currentStencilSource=void 0;for(let $=0;$<P.length;$++){const G=T.style._layers[P[$]],Y=G.source?this._coordsAscending[G.source][j.tileID.key]:[j.tileID];T.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),T._renderTileClippingMasks(G,Y,!0),T.renderLayer(T,T.style.sourceCaches[G.source],G,Y,p),G.source&&(j.rttCoords[G.source]=this._coordsAscendingStr[G.source][j.tileID.key])}}return Dh(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),eo[v]}return!1}}const qd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},$n=E,Nh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ms,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},to={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ym{constructor(t,c,p=!1){this.mousedown=T=>{this.startMove(T,B.mousePos(this.element,T)),B.addEventListener(window,"mousemove",this.mousemove),B.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.move(T,B.mousePos(this.element,T))},this.mouseup=T=>{this._rotatePitchHandler.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=B.touchPos(this.element,T.targetTouches)[0],this.startMove(T,this._startPos),B.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=B.touchPos(this.element,T.targetTouches)[0],this.move(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=c;const v=new Zd;this._rotatePitchHandler=new fu({clickTolerance:3,move:(T,M)=>{const R=c.getBoundingClientRect(),P=new l.P((R.bottom-R.top)/2,(R.right-R.left)/2);return{bearingDelta:l.cn(new l.P(T.x,M.y),M,P),pitchDelta:p?-.5*(M.y-T.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=t,B.addEventListener(c,"mousedown",this.mousedown),B.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),B.addEventListener(c,"touchcancel",this.reset)}startMove(t,c){this._rotatePitchHandler.dragStart(t,c),B.disableDrag()}move(t,c){const p=this.map,{bearingDelta:v,pitchDelta:T}=this._rotatePitchHandler.dragMove(t,c)||{};v&&p.setBearing(p.getBearing()+v),T&&p.setPitch(p.getPitch()+T)}off(){const t=this.element;B.removeEventListener(t,"mousedown",this.mousedown),B.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),B.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.removeEventListener(window,"touchend",this.touchend),B.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){B.enableDrag(),B.removeEventListener(window,"mousemove",this.mousemove),B.removeEventListener(window,"mouseup",this.mouseup),B.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.removeEventListener(window,"touchend",this.touchend)}}let bo;function Gi(b,t,c,p=!1){if(p||!c.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const v=new l.S(b.lng,b.lat);if(b=new l.S(b.lng,b.lat),t){const T=new l.S(b.lng-360,b.lat),M=new l.S(b.lng+360,b.lat),R=c.locationToScreenPoint(b).distSqr(t);c.locationToScreenPoint(T).distSqr(t)<R?b=T:c.locationToScreenPoint(M).distSqr(t)<R&&(b=M)}for(;Math.abs(b.lng-c.center.lng)>180;){const T=c.locationToScreenPoint(b);if(T.x>=0&&T.y>=0&&T.x<=c.width&&T.y<=c.height)break;b.lng>c.center.lng?b.lng-=360:b.lng+=360}return b.lng!==v.lng&&c.isPointOnMapSurface(c.locationToScreenPoint(b))?b:v}const Li={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zh(b,t,c){const p=b.classList;for(const v in Li)p.remove(`maplibregl-${c}-anchor-${v}`);p.add(`maplibregl-${c}-anchor-${t}`)}class nl extends l.E{constructor(t){if(super(),this._onKeyPress=c=>{const p=c.code,v=c.charCode||c.keyCode;p!=="Space"&&p!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=c=>{const p=c.originalEvent.target,v=this._element;this._popup&&(p===v||v.contains(p))&&this.togglePopup()},this._update=c=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();(c?.type==="terrain"||c?.type==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=Gi(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||c&&c.type!=="moveend"||(this._pos=this._pos.round()),B.setTransform(this._element,`${Li[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${v}`),F.frameAsync(new AbortController).then(()=>{this._updateOpacity(c&&c.type==="moveend")}).catch(()=>{})},this._onMove=c=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=c=>{this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=B.create("div");const c=B.createNS("http://www.w3.org/2000/svg","svg"),p=41,v=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${v}px`),c.setAttributeNS(null,"viewBox",`0 0 ${v} ${p}`);const T=B.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const M=B.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill-rule","nonzero");const R=B.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of P){const pe=B.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",fe.rx),pe.setAttributeNS(null,"ry",fe.ry),R.appendChild(pe)}const j=B.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);const U=B.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(U);const $=B.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const G=B.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(G);const Y=B.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const ee=B.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(8.0, 8.0)");const he=B.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");const ue=B.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#FFFFFF"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962"),ee.appendChild(he),ee.appendChild(ue),M.appendChild(R),M.appendChild(j),M.appendChild($),M.appendChild(Y),M.appendChild(ee),c.appendChild(M),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(c),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),zh(this._element,this._anchor,"marker"),t&&t.className)for(const c of t.className.split(" "))this._element.classList.add(c);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),B.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const v=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var c,p;const v=(c=this._map)===null||c===void 0?void 0:c.terrain,T=this._map.transform.isLocationOccluded(this._lngLat);if(!v||T){const Y=T?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const M=this._map,R=M.terrain.depthAtPoint(this._pos),P=M.terrain.getElevationForLngLatZoom(this._lngLat,M.transform.tileZoom);if(M.transform.lngLatToCameraDepth(this._lngLat,P)-R<.006)return void(this._element.style.opacity=this._opacity);const j=-this._offset.y/M.transform.pixelsPerMeter,U=Math.sin(M.getPitch()*Math.PI/180)*j,$=M.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),G=M.transform.lngLatToCameraDepth(this._lngLat,P+U)-$>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&G&&this._popup.remove(),this._element.style.opacity=G?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,c){return(this._opacity===void 0||t===void 0&&c===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),c!==void 0&&(this._opacityWhenCovered=c),this._map&&this._updateOpacity(!0),this}}const Wr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ni=0,il=!1;const wc={maxWidth:100,unit:"metric"};function rl(b,t,c){const p=c&&c.maxWidth||100,v=b._container.clientHeight/2,T=b._container.clientWidth/2,M=b.unproject([T-p/2,v]),R=b.unproject([T+p/2,v]),P=Math.round(b.project(R).x-b.project(M).x),j=Math.min(p,P,b._container.clientWidth),U=M.distanceTo(R);if(c&&c.unit==="imperial"){const $=3.2808*U;$>5280?al(t,j,$/5280,b._getUIString("ScaleControl.Miles")):al(t,j,$,b._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?al(t,j,U/1852,b._getUIString("ScaleControl.NauticalMiles")):U>=1e3?al(t,j,U/1e3,b._getUIString("ScaleControl.Kilometers")):al(t,j,U,b._getUIString("ScaleControl.Meters"))}function al(b,t,c,p){const v=function(T){const M=Math.pow(10,`${Math.floor(T)}`.length-1);let R=T/M;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(P){const j=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*j)/j}(R),M*R}(c);b.style.width=t*(v/c)+"px",b.innerHTML=`${v}&nbsp;${p}`}const Go={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},bu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xu(b){if(b){if(typeof b=="number"){const t=Math.round(Math.abs(b)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,b),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-b),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(b,0),right:new l.P(-b,0)}}if(b instanceof l.P||Array.isArray(b)){const t=l.P.convert(b);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(b.center||[0,0]),top:l.P.convert(b.top||[0,0]),"top-left":l.P.convert(b["top-left"]||[0,0]),"top-right":l.P.convert(b["top-right"]||[0,0]),bottom:l.P.convert(b.bottom||[0,0]),"bottom-left":l.P.convert(b["bottom-left"]||[0,0]),"bottom-right":l.P.convert(b["bottom-right"]||[0,0]),left:l.P.convert(b.left||[0,0]),right:l.P.convert(b.right||[0,0])}}return xu(new l.P(0,0))}const jh=E;y.AJAXError=l.cz,y.Event=l.l,y.Evented=l.E,y.LngLat=l.S,y.MercatorCoordinate=l.a1,y.Point=l.P,y.addProtocol=l.cA,y.config=l.a,y.removeProtocol=l.cB,y.AttributionControl=An,y.BoxZoomHandler=_c,y.CanvasSource=Or,y.CooperativeGesturesHandler=sp,y.DoubleClickZoomHandler=bc,y.DragPanHandler=_u,y.DragRotateHandler=xc,y.EdgeInsets=Zs,y.FullscreenControl=class extends l.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var t;let c=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=c?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)c=c.shadowRoot.fullscreenElement;c===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){B.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=B.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);B.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=Aa,y.GeolocateControl=class extends l.E{constructor(b){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const c=new l.S(t.coords.longitude,t.coords.latitude),p=t.coords.accuracy,v=this._map.getBearing(),T=l.e({bearing:v},this.options.fitBoundsOptions),M=Un.fromLngLat(c,p);this._map.fitBounds(M,T,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const c=new l.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&il)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=B.create("button","maplibregl-ctrl-geolocate",this._container),B.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new nl({element:this._dotElement}),this._circleElement=B.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new nl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{const p=c?.[0]instanceof ResizeObserverEntry;c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))})}},this.options=l.e({},Wr,b)}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return l._(this,arguments,void 0,function*(t=!1){if(bo!==void 0&&!t)return bo;if(window.navigator.permissions===void 0)return bo=!!window.navigator.geolocation,bo;try{bo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{bo=!!window.navigator.geolocation}return bo})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),B.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ni=0,il=!1}_isOutOfMapMaxBounds(b){const t=this._map.getMaxBounds(),c=b.coords;return t&&(c.longitude<t.getWest()||c.longitude>t.getEast()||c.latitude<t.getSouth()||c.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;const t=this._map.project(b),c=this._map.unproject([t.x+100,t.y]),p=b.distanceTo(c)/100,v=2*this._accuracy/p;this._circleElement.style.width=`${v.toFixed(2)}px`,this._circleElement.style.height=`${v.toFixed(2)}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ni--,il=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ni++,Ni>1?(b={maximumAge:6e5,timeout:0},il=!0):(b=this.options.positionOptions,il=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const t=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=B.create("button","maplibregl-ctrl-globe",this._container),B.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){B.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},y.Hash=yo,y.ImageSource=_a,y.KeyboardHandler=Vo,y.LngLatBounds=Un,y.LogoControl=ri,y.Map=class extends Lh{constructor(b){var t,c;l.cw.mark(l.cx.create);const p=Object.assign(Object.assign(Object.assign({},Nh),b),{canvasContextAttributes:Object.assign(Object.assign({},Nh.canvasContextAttributes),b.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new Wn,T=new qi;if(p.minZoom!==void 0&&v.setMinZoom(p.minZoom),p.maxZoom!==void 0&&v.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&v.setMinPitch(p.minPitch),p.maxPitch!==void 0&&v.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&v.setRenderWorldCopies(p.renderWorldCopies),super(v,T,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new gr,this._controls=[],this._mapId=l.a7(),this._contextLost=R=>{R.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.l("webglcontextlost",{originalEvent:R}))},this._contextRestored=R=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.l("webglcontextrestored",{originalEvent:R}))},this._onMapScroll=R=>{if(R.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},qd),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ke.addThrottleControl(()=>this.isMoving()),this._requestManager=new ge(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let R=!1;const P=Ka(j=>{this._trackResize&&!this._removed&&(this.resize(j),this.redraw())},50);this._resizeObserver=new ResizeObserver(j=>{R?P(j):R=!0}),this._resizeObserver.observe(this._container)}this.handlers=new vu(this,p),this._hash=p.hash&&new yo(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,l.e({},p.fitBoundsOptions,{duration:0}))));const M=typeof p.style=="string"||((c=(t=p.style)===null||t===void 0?void 0:t.projection)===null||c===void 0?void 0:c.type)!=="globe";this.resize(null,M),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new An(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new ri,p.logoPosition),this.on("style.load",()=>{if(M||this._resizeTransform(),this.transform.unmodified){const R=l.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(R)}}),this.on("data",R=>{this._update(R.dataType==="style"),this.fire(new l.l(`${R.dataType}data`,R))}),this.on("dataloading",R=>{this.fire(new l.l(`${R.dataType}dataloading`,R))}),this.on("dataabort",R=>{this.fire(new l.l("sourcedataabort",R))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,t){return this.style.setGlobalStateProperty(b,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,t){if(t===void 0&&(t=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=b.onAdd(this);this._controls.push(b);const p=this._controlPositions[t];return t.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(b);return t>-1&&this._controls.splice(t,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return Fe(this.transform,b)}calculateCameraOptionsFromTo(b,t,c,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,t,c,p)}resize(b,t=!0){const[c,p]=this._containerDimensions(),v=this._getClampedPixelRatio(c,p);if(this._resizeCanvas(c,p,v),this.painter.resize(c,p,v),this.painter.overLimit()){const M=this.painter.context.gl;this._maxCanvasSize=[M.drawingBufferWidth,M.drawingBufferHeight];const R=this._getClampedPixelRatio(c,p);this._resizeCanvas(c,p,R),this.painter.resize(c,p,R)}this._resizeTransform(t);const T=!this._moving;return T&&(this.stop(),this.fire(new l.l("movestart",b)).fire(new l.l("move",b))),this.fire(new l.l("resize",b)),T&&this.fire(new l.l("moveend",b)),this}_resizeTransform(b=!0){var t;const[c,p]=this._containerDimensions();this.transform.resize(c,p,b),(t=this._requestedCameraState)===null||t===void 0||t.resize(c,p,b)}_getClampedPixelRatio(b,t){const{0:c,1:p}=this._maxCanvasSize,v=this.getPixelRatio(),T=b*v,M=t*v;return Math.min(T>c?c/T:1,M>p?p/M:1)*v}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Un.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(l.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(l.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,t,c){if(b==="mouseenter"||b==="mouseover"){let p=!1;return{layers:t,listener:c,delegates:{mousemove:T=>{const M=t.filter(P=>this.getLayer(P)),R=M.length!==0?this.queryRenderedFeatures(T.point,{layers:M}):[];R.length?p||(p=!0,c.call(this,new wa(b,this,T.originalEvent,{features:R}))):p=!1},mouseout:()=>{p=!1}}}}if(b==="mouseleave"||b==="mouseout"){let p=!1;return{layers:t,listener:c,delegates:{mousemove:M=>{const R=t.filter(P=>this.getLayer(P));(R.length!==0?this.queryRenderedFeatures(M.point,{layers:R}):[]).length?p=!0:p&&(p=!1,c.call(this,new wa(b,this,M.originalEvent)))},mouseout:M=>{p&&(p=!1,c.call(this,new wa(b,this,M.originalEvent)))}}}}{const p=v=>{const T=t.filter(R=>this.getLayer(R)),M=T.length!==0?this.queryRenderedFeatures(v.point,{layers:T}):[];M.length&&(v.features=M,c.call(this,v),delete v.features)};return{layers:t,listener:c,delegates:{[b]:p}}}}_saveDelegatedListener(b,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(t)}_removeDelegatedListener(b,t,c){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const p=this._delegatedListeners[b];for(let v=0;v<p.length;v++){const T=p[v];if(T.listener===c&&T.layers.length===t.length&&T.layers.every(M=>t.includes(M))){for(const M in T.delegates)this.off(M,T.delegates[M]);return void p.splice(v,1)}}}on(b,t,c){if(c===void 0)return super.on(b,t);const p=typeof t=="string"?[t]:t,v=this._createDelegatedListener(b,p,c);this._saveDelegatedListener(b,v);for(const T in v.delegates)this.on(T,v.delegates[T]);return{unsubscribe:()=>{this._removeDelegatedListener(b,p,c)}}}once(b,t,c){if(c===void 0)return super.once(b,t);const p=typeof t=="string"?[t]:t,v=this._createDelegatedListener(b,p,c);for(const T in v.delegates){const M=v.delegates[T];v.delegates[T]=(...R)=>{this._removeDelegatedListener(b,p,c),M(...R)}}this._saveDelegatedListener(b,v);for(const T in v.delegates)this.once(T,v.delegates[T]);return this}off(b,t,c){return c===void 0?super.off(b,t):(this._removeDelegatedListener(b,typeof t=="string"?[t]:t,c),this)}queryRenderedFeatures(b,t){if(!this.style)return[];let c;const p=b instanceof l.P||Array.isArray(b),v=p?b:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(p?{}:b)||{},v instanceof l.P||typeof v[0]=="number")c=[l.P.convert(v)];else{const T=l.P.convert(v[0]),M=l.P.convert(v[1]);c=[T,new l.P(M.x,T.y),M,new l.P(T.x,M.y),T]}return this.style.queryRenderedFeatures(c,t,this.transform)}querySourceFeatures(b,t){return this.style.querySourceFeatures(b,t)}setStyle(b,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(b,t))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const t=this._locale[b];if(t==null)throw new Error(`Missing UI string '${b}'`);return t}_updateStyle(b,t){var c,p;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,t));const v=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Zf(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,t,v):this.style.loadJSON(b,t,v),this):((p=(c=this.style)===null||c===void 0?void 0:c.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,t){if(typeof b=="string"){const c=this._requestManager.transformRequest(b,"Style");l.j(c,new AbortController).then(p=>{this._updateDiff(p.data,t)}).catch(p=>{p&&this.fire(new l.k(p))})}else typeof b=="object"&&this._updateDiff(b,t)}_updateDiff(b,t){try{this.style.setState(b,t)&&this._update(!0)}catch(c){l.w(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(b,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(b,t){return this._lazyInitEmptyStyle(),this.style.addSource(b,t),this._update(!0)}isSourceLoaded(b){const t=this.style&&this.style.sourceCaches[b];if(t!==void 0)return t.loaded();this.fire(new l.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const t=this.style.sourceCaches[b.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&t.reload();for(const c in this.style._layers){const p=this.style._layers[c];p.type==="hillshade"&&p.source===b.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===b.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Nt(this.painter,t,b),this.painter.renderToTexture=new Nl(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=c=>{var p;c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=c.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:b})),this}getTerrain(){var b,t;return(t=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const t in b){const c=b[t]._tiles;for(const p in c){const v=c[p];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,t,c){if(c){const p=this.getSource(c);if(!p)throw new Error(`There is no source with ID "${c}", cannot set LOD parameters`);p.calculateTileZoom=mt(Math.max(1,b),Math.max(1,t))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=mt(Math.max(1,b),Math.max(1,t));return this._update(!0),this}refreshTiles(b,t){const c=this.style.sourceCaches[b];if(!c)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);t===void 0?c.reload(!0):c.refreshTiles(t.map(p=>new l.a4(p.z,p.x,p.y)))}addImage(b,t,c={}){const{pixelRatio:p=1,sdf:v=!1,stretchX:T,stretchY:M,content:R,textFitWidth:P,textFitHeight:j}=c;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:$,data:G}=t,Y=t;return this.style.addImage(b,{data:new l.R({width:U,height:$},new Uint8Array(G)),pixelRatio:p,stretchX:T,stretchY:M,content:R,textFitWidth:P,textFitHeight:j,sdf:v,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,b),this}}{const{width:U,height:$,data:G}=F.getImageData(t);this.style.addImage(b,{data:new l.R({width:U,height:$},G),pixelRatio:p,stretchX:T,stretchY:M,content:R,textFitWidth:P,textFitHeight:j,sdf:v,version:0})}}updateImage(b,t){const c=this.style.getImage(b);if(!c)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=t instanceof HTMLImageElement||l.b(t)?F.getImageData(t):t,{width:v,height:T,data:M}=p;if(v===void 0||T===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==c.data.width||T!==c.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(t instanceof HTMLImageElement||l.b(t));return c.data.replace(M,R),this.style.updateImage(b,c),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return ke.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,t){return this._lazyInitEmptyStyle(),this.style.addLayer(b,t),this._update(!0)}moveLayer(b,t){return this.style.moveLayer(b,t),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,t,c){return this.style.setLayerZoomRange(b,t,c),this._update(!0)}setFilter(b,t,c={}){return this.style.setFilter(b,t,c),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,t,c,p={}){return this.style.setPaintProperty(b,t,c,p),this._update(!0)}getPaintProperty(b,t){return this.style.getPaintProperty(b,t)}setLayoutProperty(b,t,c,p={}){return this.style.setLayoutProperty(b,t,c,p),this._update(!0)}getLayoutProperty(b,t){return this.style.getLayoutProperty(b,t)}setGlyphs(b,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,t,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,t,c,p=>{p||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,t,c=>{c||this._update(!0)}),this}setLight(b,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,t){return this.style.setFeatureState(b,t),this._update()}removeFeatureState(b,t){return this.style.removeFeatureState(b,t),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,t=0;return this._container&&(b=this._container.clientWidth||400,t=this._container.clientHeight||300),[b,t]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const t=this._canvasContainer=B.create("div","maplibregl-canvas-container",b);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=B.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const c=this._containerDimensions(),p=this._getClampedPixelRatio(c[0],c[1]);this._resizeCanvas(c[0],c[1],p);const v=this._controlContainer=B.create("div","maplibregl-control-container",b),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{T[M]=B.create("div",`maplibregl-ctrl-${M} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,t,c){this._canvas.width=Math.floor(c*b),this._canvas.height=Math.floor(c*t),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{t={requestedAttributes:b},p&&(t.statusMessage=p.statusMessage,t.type=p.type)},{once:!0});let c=null;if(c=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!c){const p="Failed to initialize WebGL";throw t?(t.message=p,new Error(JSON.stringify(t))):new Error(p)}this.painter=new Ud(c,this.transform),W.testSupport(c)}migrateProjection(b,t){super.migrateProjection(b,t),this.painter.transform=b,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var t,c,p,v,T;const M=this._idleTriggered?this._fadeDuration:0,R=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,G=F.now();this.style.zoomHistory.update($,G);const Y=new l.F($,{now:G,fadeDuration:M,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ee=Y.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(P=!0,this._crossFadingFactor=ee),this.style.update(Y)}const j=((c=this.style.projection)===null||c===void 0?void 0:c.transitionState)>0!==R;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(T=this.style.projection)===null||T===void 0?void 0:T.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,M,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:M,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cw.mark(l.cx.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,l.cw.mark(l.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ke.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),B.remove(this._canvasContainer),B.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cw.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,F.frame(this._frameRequest,b=>{l.cw.frame(b),this._frameRequest=null;try{this._render(b)}catch(t){if(!l.cy(t)&&!function(c){return c.message===Eh}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return $n}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},y.MapMouseEvent=wa,y.MapTouchEvent=du,y.MapWheelEvent=ip,y.Marker=nl,y.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const t=this._map.getZoom(),c=t===this._map.getMaxZoom(),p=t===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,c)=>{const p=this._map._getUIString(`NavigationControl.${c}`);t.title=p,t.setAttribute("aria-label",p)},this.options=l.e({},to,b),this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),B.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),B.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=B.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ym(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){B.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,t){const c=B.create("button",b,this._container);return c.type="button",c.addEventListener("click",t),c}},y.Popup=class extends l.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&B.remove(this._content),this._container&&(B.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=B.create("div","maplibregl-popup",this._map.getContainer()),this._tip=B.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const M of this.options.className.split(" "))this._container.classList.add(M);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Gi(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const c=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const v=xu(this.options.offset);if(!p){const M=this._container.offsetWidth,R=this._container.offsetHeight;let P;P=c.y+v.bottom.y<R?["top"]:c.y>this._map.transform.height-R?["bottom"]:[],c.x<M/2?P.push("left"):c.x>this._map.transform.width-M/2&&P.push("right"),p=P.length===0?"bottom":P.join("-")}let T=c.add(v[p]);this.options.subpixelPositioning||(T=T.round()),B.setTransform(this._container,`${Li[p]} translate(${T.x}px,${T.y}px)`),zh(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(Go),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=l.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const t=document.createDocumentFragment(),c=document.createElement("body");let p;for(c.innerHTML=b;p=c.firstChild,p;)t.appendChild(p);return this.setDOMContent(t)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=B.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=B.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(bu);b&&b.focus()}},y.RasterDEMTileSource=ki,y.RasterTileSource=Pr,y.ScaleControl=class{constructor(b){this._onMove=()=>{rl(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,rl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},wc),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){B.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=el,y.Style=Zf,y.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=B.create("button","maplibregl-ctrl-terrain",this._container),B.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){B.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Ph,y.TwoFingersTouchRotateHandler=vc,y.TwoFingersTouchZoomHandler=kh,y.TwoFingersTouchZoomRotateHandler=op,y.VectorTileSource=Dn,y.VideoSource=Gr,y.addSourceType=(b,t)=>l._(void 0,void 0,void 0,function*(){if(Ca(b))throw new Error(`A source type called "${b}" already exists.`);((c,p)=>{Va[c]=p})(b,t)}),y.clearPrewarmedResources=function(){const b=pt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Te),pt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.createTileMesh=Vf,y.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return ii().getRTLTextPluginStatus()},y.getVersion=function(){return jh},y.getWorkerCount=function(){return nt.workerCount},y.getWorkerUrl=function(){return l.a.WORKER_URL},y.importScriptInWorkers=function(b){return Ln().broadcast("IS",b)},y.prewarm=function(){Ut().acquire(Te)},y.setMaxParallelImageRequests=function(b){l.a.MAX_PARALLEL_IMAGE_REQUESTS=b},y.setRTLTextPlugin=function(b,t){return ii().setRTLTextPlugin(b,t)},y.setWorkerCount=function(b){nt.workerCount=b},y.setWorkerUrl=function(b){l.a.WORKER_URL=b}});var m=r;return m})}(vv)),vv.exports}var CS=gD();const DS=Hp(CS),IS=wS({__proto__:null,default:DS},[CS]),yD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",_D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class xg extends Error{response;request;constructor(e,r){const u=`${xg.extractMessage(e)}: ${JSON.stringify({response:e,request:r})}`;super(u),Object.setPrototypeOf(this,xg.prototype),this.response=e,this.request=r,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,xg)}static extractMessage(e){return e.errors?.[0]?.message??`GraphQL Error (Code: ${String(e.status)})`}}const o2=n=>n.toUpperCase(),nx=n=>typeof n=="function"?n():n,RS=(n,e)=>n.map((r,u)=>[r,e[u]]),cg=n=>{let e={};return n instanceof Headers?e=vD(n):Array.isArray(n)?n.forEach(([r,u])=>{r&&u!==void 0&&(e[r]=u)}):n&&(e=n),e},vD=n=>{const e={};return n.forEach((r,u)=>{e[u]=r}),e},bD=n=>{try{const e=n();return xD(e)?e.catch(r=>s2(r)):e}catch(e){return s2(e)}},s2=n=>n instanceof Error?n:new Error(String(n)),xD=n=>typeof n=="object"&&n!==null&&"then"in n&&typeof n.then=="function"&&"catch"in n&&typeof n.catch=="function"&&"finally"in n&&typeof n.finally=="function",M1=n=>{throw new Error(`Unhandled case: ${String(n)}`)},bv=n=>typeof n=="object"&&n!==null&&!Array.isArray(n),wD=(n,e)=>n.documents?n:{documents:n,requestHeaders:e,signal:void 0},TD=(n,e,r)=>n.query?n:{query:n,variables:e,requestHeaders:r,signal:void 0};function Ei(n,e){if(!!!n)throw new Error(e)}function _d(n){return typeof n=="object"&&n!==null}function ib(n,e){if(!!!n)throw new Error(e??"Unexpected invariant triggered.")}const SD=/\r\n|[\n\r]/g;function Lx(n,e){let r=0,u=1;for(const d of n.body.matchAll(SD)){if(typeof d.index=="number"||ib(!1),d.index>=e)break;r=d.index+d[0].length,u+=1}return{line:u,column:e+1-r}}function ED(n){return kS(n.source,Lx(n.source,n.start))}function kS(n,e){const r=n.locationOffset.column-1,u="".padStart(r)+n.body,d=e.line-1,m=n.locationOffset.line-1,y=e.line+m,l=e.line===1?r:0,E=e.column+l,C=`${n.name}:${y}:${E}
`,k=u.split(/\r\n|[\n\r]/g),N=k[d];if(N.length>120){const F=Math.floor(E/80),B=E%80,W=[];for(let re=0;re<N.length;re+=80)W.push(N.slice(re,re+80));return C+l2([[`${y} |`,W[0]],...W.slice(1,F+1).map(re=>["|",re]),["|","^".padStart(B)],["|",W[F+1]]])}return C+l2([[`${y-1} |`,k[d-1]],[`${y} |`,N],["|","^".padStart(E)],[`${y+1} |`,k[d+1]]])}function l2(n){const e=n.filter(([u,d])=>d!==void 0),r=Math.max(...e.map(([u])=>u.length));return e.map(([u,d])=>u.padStart(r)+(d?" "+d:"")).join(`
`)}function MD(n){const e=n[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:n[1],positions:n[2],path:n[3],originalError:n[4],extensions:n[5]}:e}class Ii extends Error{constructor(e,...r){var u,d,m;const{nodes:y,source:l,positions:E,path:C,originalError:k,extensions:N}=MD(r);super(e),this.name="GraphQLError",this.path=C??void 0,this.originalError=k??void 0,this.nodes=c2(Array.isArray(y)?y:y?[y]:void 0);const F=c2((u=this.nodes)===null||u===void 0?void 0:u.map(W=>W.loc).filter(W=>W!=null));this.source=l??(F==null||(d=F[0])===null||d===void 0?void 0:d.source),this.positions=E??F?.map(W=>W.start),this.locations=E&&l?E.map(W=>Lx(l,W)):F?.map(W=>Lx(W.source,W.start));const B=_d(k?.extensions)?k?.extensions:void 0;this.extensions=(m=N??B)!==null&&m!==void 0?m:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),k!=null&&k.stack?Object.defineProperty(this,"stack",{value:k.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Ii):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(e+=`

`+ED(r.loc));else if(this.source&&this.locations)for(const r of this.locations)e+=`

`+kS(this.source,r);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function c2(n){return n===void 0||n.length===0?void 0:n}function Ba(n,e,r){return new Ii(`Syntax Error: ${r}`,{source:n,positions:[e]})}class AD{constructor(e,r,u){this.start=e.start,this.end=r.end,this.startToken=e,this.endToken=r,this.source=u}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class PS{constructor(e,r,u,d,m,y){this.kind=e,this.start=r,this.end=u,this.line=d,this.column=m,this.value=y,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const OS={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},CD=new Set(Object.keys(OS));function u2(n){const e=n?.kind;return typeof e=="string"&&CD.has(e)}var ad;(function(n){n.QUERY="query",n.MUTATION="mutation",n.SUBSCRIPTION="subscription"})(ad||(ad={}));var si;(function(n){n.QUERY="QUERY",n.MUTATION="MUTATION",n.SUBSCRIPTION="SUBSCRIPTION",n.FIELD="FIELD",n.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",n.FRAGMENT_SPREAD="FRAGMENT_SPREAD",n.INLINE_FRAGMENT="INLINE_FRAGMENT",n.VARIABLE_DEFINITION="VARIABLE_DEFINITION",n.SCHEMA="SCHEMA",n.SCALAR="SCALAR",n.OBJECT="OBJECT",n.FIELD_DEFINITION="FIELD_DEFINITION",n.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",n.INTERFACE="INTERFACE",n.UNION="UNION",n.ENUM="ENUM",n.ENUM_VALUE="ENUM_VALUE",n.INPUT_OBJECT="INPUT_OBJECT",n.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(si||(si={}));var Pt;(function(n){n.NAME="Name",n.DOCUMENT="Document",n.OPERATION_DEFINITION="OperationDefinition",n.VARIABLE_DEFINITION="VariableDefinition",n.SELECTION_SET="SelectionSet",n.FIELD="Field",n.ARGUMENT="Argument",n.FRAGMENT_SPREAD="FragmentSpread",n.INLINE_FRAGMENT="InlineFragment",n.FRAGMENT_DEFINITION="FragmentDefinition",n.VARIABLE="Variable",n.INT="IntValue",n.FLOAT="FloatValue",n.STRING="StringValue",n.BOOLEAN="BooleanValue",n.NULL="NullValue",n.ENUM="EnumValue",n.LIST="ListValue",n.OBJECT="ObjectValue",n.OBJECT_FIELD="ObjectField",n.DIRECTIVE="Directive",n.NAMED_TYPE="NamedType",n.LIST_TYPE="ListType",n.NON_NULL_TYPE="NonNullType",n.SCHEMA_DEFINITION="SchemaDefinition",n.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",n.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",n.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",n.FIELD_DEFINITION="FieldDefinition",n.INPUT_VALUE_DEFINITION="InputValueDefinition",n.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",n.UNION_TYPE_DEFINITION="UnionTypeDefinition",n.ENUM_TYPE_DEFINITION="EnumTypeDefinition",n.ENUM_VALUE_DEFINITION="EnumValueDefinition",n.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",n.DIRECTIVE_DEFINITION="DirectiveDefinition",n.SCHEMA_EXTENSION="SchemaExtension",n.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",n.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",n.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",n.UNION_TYPE_EXTENSION="UnionTypeExtension",n.ENUM_TYPE_EXTENSION="EnumTypeExtension",n.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(Pt||(Pt={}));function Nx(n){return n===9||n===32}function I0(n){return n>=48&&n<=57}function LS(n){return n>=97&&n<=122||n>=65&&n<=90}function A1(n){return LS(n)||n===95}function NS(n){return LS(n)||I0(n)||n===95}function DD(n){var e;let r=Number.MAX_SAFE_INTEGER,u=null,d=-1;for(let y=0;y<n.length;++y){var m;const l=n[y],E=ID(l);E!==l.length&&(u=(m=u)!==null&&m!==void 0?m:y,d=y,y!==0&&E<r&&(r=E))}return n.map((y,l)=>l===0?y:y.slice(r)).slice((e=u)!==null&&e!==void 0?e:0,d+1)}function ID(n){let e=0;for(;e<n.length&&Nx(n.charCodeAt(e));)++e;return e}function RD(n,e){const r=n.replace(/"""/g,'\\"""'),u=r.split(/\r\n|[\n\r]/g),d=u.length===1,m=u.length>1&&u.slice(1).every(B=>B.length===0||Nx(B.charCodeAt(0))),y=r.endsWith('\\"""'),l=n.endsWith('"')&&!y,E=n.endsWith("\\"),C=l||E,k=!d||n.length>70||C||m||y;let N="";const F=d&&Nx(n.charCodeAt(0));return(k&&!F||m)&&(N+=`
`),N+=r,(k||C)&&(N+=`
`),'"""'+N+'"""'}var gt;(function(n){n.SOF="<SOF>",n.EOF="<EOF>",n.BANG="!",n.DOLLAR="$",n.AMP="&",n.PAREN_L="(",n.PAREN_R=")",n.SPREAD="...",n.COLON=":",n.EQUALS="=",n.AT="@",n.BRACKET_L="[",n.BRACKET_R="]",n.BRACE_L="{",n.PIPE="|",n.BRACE_R="}",n.NAME="Name",n.INT="Int",n.FLOAT="Float",n.STRING="String",n.BLOCK_STRING="BlockString",n.COMMENT="Comment"})(gt||(gt={}));class kD{constructor(e){const r=new PS(gt.SOF,0,0,0,0);this.source=e,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==gt.EOF)do if(e.next)e=e.next;else{const r=OD(this,e.end);e.next=r,r.prev=e,e=r}while(e.kind===gt.COMMENT);return e}}function PD(n){return n===gt.BANG||n===gt.DOLLAR||n===gt.AMP||n===gt.PAREN_L||n===gt.PAREN_R||n===gt.SPREAD||n===gt.COLON||n===gt.EQUALS||n===gt.AT||n===gt.BRACKET_L||n===gt.BRACKET_R||n===gt.BRACE_L||n===gt.PIPE||n===gt.BRACE_R}function Gg(n){return n>=0&&n<=55295||n>=57344&&n<=1114111}function rb(n,e){return zS(n.charCodeAt(e))&&jS(n.charCodeAt(e+1))}function zS(n){return n>=55296&&n<=56319}function jS(n){return n>=56320&&n<=57343}function Np(n,e){const r=n.source.body.codePointAt(e);if(r===void 0)return gt.EOF;if(r>=32&&r<=126){const u=String.fromCodePoint(r);return u==='"'?`'"'`:`"${u}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function ga(n,e,r,u,d){const m=n.line,y=1+r-n.lineStart;return new PS(e,r,u,m,y,d)}function OD(n,e){const r=n.source.body,u=r.length;let d=e;for(;d<u;){const m=r.charCodeAt(d);switch(m){case 65279:case 9:case 32:case 44:++d;continue;case 10:++d,++n.line,n.lineStart=d;continue;case 13:r.charCodeAt(d+1)===10?d+=2:++d,++n.line,n.lineStart=d;continue;case 35:return LD(n,d);case 33:return ga(n,gt.BANG,d,d+1);case 36:return ga(n,gt.DOLLAR,d,d+1);case 38:return ga(n,gt.AMP,d,d+1);case 40:return ga(n,gt.PAREN_L,d,d+1);case 41:return ga(n,gt.PAREN_R,d,d+1);case 46:if(r.charCodeAt(d+1)===46&&r.charCodeAt(d+2)===46)return ga(n,gt.SPREAD,d,d+3);break;case 58:return ga(n,gt.COLON,d,d+1);case 61:return ga(n,gt.EQUALS,d,d+1);case 64:return ga(n,gt.AT,d,d+1);case 91:return ga(n,gt.BRACKET_L,d,d+1);case 93:return ga(n,gt.BRACKET_R,d,d+1);case 123:return ga(n,gt.BRACE_L,d,d+1);case 124:return ga(n,gt.PIPE,d,d+1);case 125:return ga(n,gt.BRACE_R,d,d+1);case 34:return r.charCodeAt(d+1)===34&&r.charCodeAt(d+2)===34?UD(n,d):zD(n,d)}if(I0(m)||m===45)return ND(n,d,m);if(A1(m))return VD(n,d);throw Ba(n.source,d,m===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Gg(m)||rb(r,d)?`Unexpected character: ${Np(n,d)}.`:`Invalid character: ${Np(n,d)}.`)}return ga(n,gt.EOF,u,u)}function LD(n,e){const r=n.source.body,u=r.length;let d=e+1;for(;d<u;){const m=r.charCodeAt(d);if(m===10||m===13)break;if(Gg(m))++d;else if(rb(r,d))d+=2;else break}return ga(n,gt.COMMENT,e,d,r.slice(e+1,d))}function ND(n,e,r){const u=n.source.body;let d=e,m=r,y=!1;if(m===45&&(m=u.charCodeAt(++d)),m===48){if(m=u.charCodeAt(++d),I0(m))throw Ba(n.source,d,`Invalid number, unexpected digit after 0: ${Np(n,d)}.`)}else d=ix(n,d,m),m=u.charCodeAt(d);if(m===46&&(y=!0,m=u.charCodeAt(++d),d=ix(n,d,m),m=u.charCodeAt(d)),(m===69||m===101)&&(y=!0,m=u.charCodeAt(++d),(m===43||m===45)&&(m=u.charCodeAt(++d)),d=ix(n,d,m),m=u.charCodeAt(d)),m===46||A1(m))throw Ba(n.source,d,`Invalid number, expected digit but got: ${Np(n,d)}.`);return ga(n,y?gt.FLOAT:gt.INT,e,d,u.slice(e,d))}function ix(n,e,r){if(!I0(r))throw Ba(n.source,e,`Invalid number, expected digit but got: ${Np(n,e)}.`);const u=n.source.body;let d=e+1;for(;I0(u.charCodeAt(d));)++d;return d}function zD(n,e){const r=n.source.body,u=r.length;let d=e+1,m=d,y="";for(;d<u;){const l=r.charCodeAt(d);if(l===34)return y+=r.slice(m,d),ga(n,gt.STRING,e,d+1,y);if(l===92){y+=r.slice(m,d);const E=r.charCodeAt(d+1)===117?r.charCodeAt(d+2)===123?jD(n,d):FD(n,d):BD(n,d);y+=E.value,d+=E.size,m=d;continue}if(l===10||l===13)break;if(Gg(l))++d;else if(rb(r,d))d+=2;else throw Ba(n.source,d,`Invalid character within String: ${Np(n,d)}.`)}throw Ba(n.source,d,"Unterminated string.")}function jD(n,e){const r=n.source.body;let u=0,d=3;for(;d<12;){const m=r.charCodeAt(e+d++);if(m===125){if(d<5||!Gg(u))break;return{value:String.fromCodePoint(u),size:d}}if(u=u<<4|l0(m),u<0)break}throw Ba(n.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+d)}".`)}function FD(n,e){const r=n.source.body,u=h2(r,e+2);if(Gg(u))return{value:String.fromCodePoint(u),size:6};if(zS(u)&&r.charCodeAt(e+6)===92&&r.charCodeAt(e+7)===117){const d=h2(r,e+8);if(jS(d))return{value:String.fromCodePoint(u,d),size:12}}throw Ba(n.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+6)}".`)}function h2(n,e){return l0(n.charCodeAt(e))<<12|l0(n.charCodeAt(e+1))<<8|l0(n.charCodeAt(e+2))<<4|l0(n.charCodeAt(e+3))}function l0(n){return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:-1}function BD(n,e){const r=n.source.body;switch(r.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Ba(n.source,e,`Invalid character escape sequence: "${r.slice(e,e+2)}".`)}function UD(n,e){const r=n.source.body,u=r.length;let d=n.lineStart,m=e+3,y=m,l="";const E=[];for(;m<u;){const C=r.charCodeAt(m);if(C===34&&r.charCodeAt(m+1)===34&&r.charCodeAt(m+2)===34){l+=r.slice(y,m),E.push(l);const k=ga(n,gt.BLOCK_STRING,e,m+3,DD(E).join(`
`));return n.line+=E.length-1,n.lineStart=d,k}if(C===92&&r.charCodeAt(m+1)===34&&r.charCodeAt(m+2)===34&&r.charCodeAt(m+3)===34){l+=r.slice(y,m),y=m+1,m+=4;continue}if(C===10||C===13){l+=r.slice(y,m),E.push(l),C===13&&r.charCodeAt(m+1)===10?m+=2:++m,l="",y=m,d=m;continue}if(Gg(C))++m;else if(rb(r,m))m+=2;else throw Ba(n.source,m,`Invalid character within String: ${Np(n,m)}.`)}throw Ba(n.source,m,"Unterminated string.")}function VD(n,e){const r=n.source.body,u=r.length;let d=e+1;for(;d<u;){const m=r.charCodeAt(d);if(NS(m))++d;else break}return ga(n,gt.NAME,e,d,r.slice(e,d))}const GD=10,FS=2;function Mn(n){return ab(n,[])}function ab(n,e){switch(typeof n){case"string":return JSON.stringify(n);case"function":return n.name?`[function ${n.name}]`:"[function]";case"object":return $D(n,e);default:return String(n)}}function $D(n,e){if(n===null)return"null";if(e.includes(n))return"[Circular]";const r=[...e,n];if(ZD(n)){const u=n.toJSON();if(u!==n)return typeof u=="string"?u:ab(u,r)}else if(Array.isArray(n))return HD(n,r);return YD(n,r)}function ZD(n){return typeof n.toJSON=="function"}function YD(n,e){const r=Object.entries(n);return r.length===0?"{}":e.length>FS?"["+qD(n)+"]":"{ "+r.map(([d,m])=>d+": "+ab(m,e)).join(", ")+" }"}function HD(n,e){if(n.length===0)return"[]";if(e.length>FS)return"[Array]";const r=Math.min(GD,n.length),u=n.length-r,d=[];for(let m=0;m<r;++m)d.push(ab(n[m],e));return u===1?d.push("... 1 more item"):u>1&&d.push(`... ${u} more items`),"["+d.join(", ")+"]"}function qD(n){const e=Object.prototype.toString.call(n).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof n.constructor=="function"){const r=n.constructor.name;if(typeof r=="string"&&r!=="")return r}return e}const XD=globalThis.process&&!0,nh=XD?function(e,r){return e instanceof r}:function(e,r){if(e instanceof r)return!0;if(typeof e=="object"&&e!==null){var u;const d=r.prototype[Symbol.toStringTag],m=Symbol.toStringTag in e?e[Symbol.toStringTag]:(u=e.constructor)===null||u===void 0?void 0:u.name;if(d===m){const y=Mn(e);throw new Error(`Cannot use ${d} "${y}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class BS{constructor(e,r="GraphQL request",u={line:1,column:1}){typeof e=="string"||Ei(!1,`Body must be a string. Received: ${Mn(e)}.`),this.body=e,this.name=r,this.locationOffset=u,this.locationOffset.line>0||Ei(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Ei(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function WD(n){return nh(n,BS)}function US(n,e){const r=new VS(n,e),u=r.parseDocument();return Object.defineProperty(u,"tokenCount",{enumerable:!1,value:r.tokenCount}),u}function QD(n,e){const r=new VS(n,e);r.expectToken(gt.SOF);const u=r.parseValueLiteral(!1);return r.expectToken(gt.EOF),u}class VS{constructor(e,r={}){const u=WD(e)?e:new BS(e);this._lexer=new kD(u),this._options=r,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const e=this.expectToken(gt.NAME);return this.node(e,{kind:Pt.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:Pt.DOCUMENT,definitions:this.many(gt.SOF,this.parseDefinition,gt.EOF)})}parseDefinition(){if(this.peek(gt.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),r=e?this._lexer.lookahead():this._lexer.token;if(r.kind===gt.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw Ba(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(gt.BRACE_L))return this.node(e,{kind:Pt.OPERATION_DEFINITION,operation:ad.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let u;return this.peek(gt.NAME)&&(u=this.parseName()),this.node(e,{kind:Pt.OPERATION_DEFINITION,operation:r,name:u,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(gt.NAME);switch(e.value){case"query":return ad.QUERY;case"mutation":return ad.MUTATION;case"subscription":return ad.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(gt.PAREN_L,this.parseVariableDefinition,gt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:Pt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(gt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(gt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(gt.DOLLAR),this.node(e,{kind:Pt.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:Pt.SELECTION_SET,selections:this.many(gt.BRACE_L,this.parseSelection,gt.BRACE_R)})}parseSelection(){return this.peek(gt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,r=this.parseName();let u,d;return this.expectOptionalToken(gt.COLON)?(u=r,d=this.parseName()):d=r,this.node(e,{kind:Pt.FIELD,alias:u,name:d,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(gt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const r=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(gt.PAREN_L,r,gt.PAREN_R)}parseArgument(e=!1){const r=this._lexer.token,u=this.parseName();return this.expectToken(gt.COLON),this.node(r,{kind:Pt.ARGUMENT,name:u,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(gt.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(gt.NAME)?this.node(e,{kind:Pt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:Pt.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:Pt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:Pt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const r=this._lexer.token;switch(r.kind){case gt.BRACKET_L:return this.parseList(e);case gt.BRACE_L:return this.parseObject(e);case gt.INT:return this.advanceLexer(),this.node(r,{kind:Pt.INT,value:r.value});case gt.FLOAT:return this.advanceLexer(),this.node(r,{kind:Pt.FLOAT,value:r.value});case gt.STRING:case gt.BLOCK_STRING:return this.parseStringLiteral();case gt.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:Pt.BOOLEAN,value:!0});case"false":return this.node(r,{kind:Pt.BOOLEAN,value:!1});case"null":return this.node(r,{kind:Pt.NULL});default:return this.node(r,{kind:Pt.ENUM,value:r.value})}case gt.DOLLAR:if(e)if(this.expectToken(gt.DOLLAR),this._lexer.token.kind===gt.NAME){const u=this._lexer.token.value;throw Ba(this._lexer.source,r.start,`Unexpected variable "$${u}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:Pt.STRING,value:e.value,block:e.kind===gt.BLOCK_STRING})}parseList(e){const r=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:Pt.LIST,values:this.any(gt.BRACKET_L,r,gt.BRACKET_R)})}parseObject(e){const r=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:Pt.OBJECT,fields:this.any(gt.BRACE_L,r,gt.BRACE_R)})}parseObjectField(e){const r=this._lexer.token,u=this.parseName();return this.expectToken(gt.COLON),this.node(r,{kind:Pt.OBJECT_FIELD,name:u,value:this.parseValueLiteral(e)})}parseDirectives(e){const r=[];for(;this.peek(gt.AT);)r.push(this.parseDirective(e));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const r=this._lexer.token;return this.expectToken(gt.AT),this.node(r,{kind:Pt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let r;if(this.expectOptionalToken(gt.BRACKET_L)){const u=this.parseTypeReference();this.expectToken(gt.BRACKET_R),r=this.node(e,{kind:Pt.LIST_TYPE,type:u})}else r=this.parseNamedType();return this.expectOptionalToken(gt.BANG)?this.node(e,{kind:Pt.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:Pt.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(gt.STRING)||this.peek(gt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const u=this.parseConstDirectives(),d=this.many(gt.BRACE_L,this.parseOperationTypeDefinition,gt.BRACE_R);return this.node(e,{kind:Pt.SCHEMA_DEFINITION,description:r,directives:u,operationTypes:d})}parseOperationTypeDefinition(){const e=this._lexer.token,r=this.parseOperationType();this.expectToken(gt.COLON);const u=this.parseNamedType();return this.node(e,{kind:Pt.OPERATION_TYPE_DEFINITION,operation:r,type:u})}parseScalarTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const u=this.parseName(),d=this.parseConstDirectives();return this.node(e,{kind:Pt.SCALAR_TYPE_DEFINITION,description:r,name:u,directives:d})}parseObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const u=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),y=this.parseFieldsDefinition();return this.node(e,{kind:Pt.OBJECT_TYPE_DEFINITION,description:r,name:u,interfaces:d,directives:m,fields:y})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(gt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(gt.BRACE_L,this.parseFieldDefinition,gt.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,r=this.parseDescription(),u=this.parseName(),d=this.parseArgumentDefs();this.expectToken(gt.COLON);const m=this.parseTypeReference(),y=this.parseConstDirectives();return this.node(e,{kind:Pt.FIELD_DEFINITION,description:r,name:u,arguments:d,type:m,directives:y})}parseArgumentDefs(){return this.optionalMany(gt.PAREN_L,this.parseInputValueDef,gt.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,r=this.parseDescription(),u=this.parseName();this.expectToken(gt.COLON);const d=this.parseTypeReference();let m;this.expectOptionalToken(gt.EQUALS)&&(m=this.parseConstValueLiteral());const y=this.parseConstDirectives();return this.node(e,{kind:Pt.INPUT_VALUE_DEFINITION,description:r,name:u,type:d,defaultValue:m,directives:y})}parseInterfaceTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const u=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),y=this.parseFieldsDefinition();return this.node(e,{kind:Pt.INTERFACE_TYPE_DEFINITION,description:r,name:u,interfaces:d,directives:m,fields:y})}parseUnionTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const u=this.parseName(),d=this.parseConstDirectives(),m=this.parseUnionMemberTypes();return this.node(e,{kind:Pt.UNION_TYPE_DEFINITION,description:r,name:u,directives:d,types:m})}parseUnionMemberTypes(){return this.expectOptionalToken(gt.EQUALS)?this.delimitedMany(gt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const u=this.parseName(),d=this.parseConstDirectives(),m=this.parseEnumValuesDefinition();return this.node(e,{kind:Pt.ENUM_TYPE_DEFINITION,description:r,name:u,directives:d,values:m})}parseEnumValuesDefinition(){return this.optionalMany(gt.BRACE_L,this.parseEnumValueDefinition,gt.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,r=this.parseDescription(),u=this.parseEnumValueName(),d=this.parseConstDirectives();return this.node(e,{kind:Pt.ENUM_VALUE_DEFINITION,description:r,name:u,directives:d})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Ba(this._lexer.source,this._lexer.token.start,`${rv(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const u=this.parseName(),d=this.parseConstDirectives(),m=this.parseInputFieldsDefinition();return this.node(e,{kind:Pt.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:u,directives:d,fields:m})}parseInputFieldsDefinition(){return this.optionalMany(gt.BRACE_L,this.parseInputValueDef,gt.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===gt.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),u=this.optionalMany(gt.BRACE_L,this.parseOperationTypeDefinition,gt.BRACE_R);if(r.length===0&&u.length===0)throw this.unexpected();return this.node(e,{kind:Pt.SCHEMA_EXTENSION,directives:r,operationTypes:u})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),u=this.parseConstDirectives();if(u.length===0)throw this.unexpected();return this.node(e,{kind:Pt.SCALAR_TYPE_EXTENSION,name:r,directives:u})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),u=this.parseImplementsInterfaces(),d=this.parseConstDirectives(),m=this.parseFieldsDefinition();if(u.length===0&&d.length===0&&m.length===0)throw this.unexpected();return this.node(e,{kind:Pt.OBJECT_TYPE_EXTENSION,name:r,interfaces:u,directives:d,fields:m})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),u=this.parseImplementsInterfaces(),d=this.parseConstDirectives(),m=this.parseFieldsDefinition();if(u.length===0&&d.length===0&&m.length===0)throw this.unexpected();return this.node(e,{kind:Pt.INTERFACE_TYPE_EXTENSION,name:r,interfaces:u,directives:d,fields:m})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),u=this.parseConstDirectives(),d=this.parseUnionMemberTypes();if(u.length===0&&d.length===0)throw this.unexpected();return this.node(e,{kind:Pt.UNION_TYPE_EXTENSION,name:r,directives:u,types:d})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),u=this.parseConstDirectives(),d=this.parseEnumValuesDefinition();if(u.length===0&&d.length===0)throw this.unexpected();return this.node(e,{kind:Pt.ENUM_TYPE_EXTENSION,name:r,directives:u,values:d})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),u=this.parseConstDirectives(),d=this.parseInputFieldsDefinition();if(u.length===0&&d.length===0)throw this.unexpected();return this.node(e,{kind:Pt.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:u,fields:d})}parseDirectiveDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(gt.AT);const u=this.parseName(),d=this.parseArgumentDefs(),m=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const y=this.parseDirectiveLocations();return this.node(e,{kind:Pt.DIRECTIVE_DEFINITION,description:r,name:u,arguments:d,repeatable:m,locations:y})}parseDirectiveLocations(){return this.delimitedMany(gt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(si,r.value))return r;throw this.unexpected(e)}node(e,r){return this._options.noLocation!==!0&&(r.loc=new AD(e,this._lexer.lastToken,this._lexer.source)),r}peek(e){return this._lexer.token.kind===e}expectToken(e){const r=this._lexer.token;if(r.kind===e)return this.advanceLexer(),r;throw Ba(this._lexer.source,r.start,`Expected ${GS(e)}, found ${rv(r)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const r=this._lexer.token;if(r.kind===gt.NAME&&r.value===e)this.advanceLexer();else throw Ba(this._lexer.source,r.start,`Expected "${e}", found ${rv(r)}.`)}expectOptionalKeyword(e){const r=this._lexer.token;return r.kind===gt.NAME&&r.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const r=e??this._lexer.token;return Ba(this._lexer.source,r.start,`Unexpected ${rv(r)}.`)}any(e,r,u){this.expectToken(e);const d=[];for(;!this.expectOptionalToken(u);)d.push(r.call(this));return d}optionalMany(e,r,u){if(this.expectOptionalToken(e)){const d=[];do d.push(r.call(this));while(!this.expectOptionalToken(u));return d}return[]}many(e,r,u){this.expectToken(e);const d=[];do d.push(r.call(this));while(!this.expectOptionalToken(u));return d}delimitedMany(e,r){this.expectOptionalToken(e);const u=[];do u.push(r.call(this));while(this.expectOptionalToken(e));return u}advanceLexer(){const{maxTokens:e}=this._options,r=this._lexer.advance();if(r.kind!==gt.EOF&&(++this._tokenCounter,e!==void 0&&this._tokenCounter>e))throw Ba(this._lexer.source,r.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function rv(n){const e=n.value;return GS(n.kind)+(e!=null?` "${e}"`:"")}function GS(n){return PD(n)?`"${n}"`:n}const KD=5;function JD(n,e){const[r,u]=e?[n,e]:[void 0,n];let d=" Did you mean ";r&&(d+=r+" ");const m=u.map(E=>`"${E}"`);switch(m.length){case 0:return"";case 1:return d+m[0]+"?";case 2:return d+m[0]+" or "+m[1]+"?"}const y=m.slice(0,KD),l=y.pop();return d+y.join(", ")+", or "+l+"?"}function d2(n){return n}function $S(n,e){const r=Object.create(null);for(const u of n)r[e(u)]=u;return r}function Rp(n,e,r){const u=Object.create(null);for(const d of n)u[e(d)]=r(d);return u}function ob(n,e){const r=Object.create(null);for(const u of Object.keys(n))r[u]=e(n[u],u);return r}function eI(n,e){let r=0,u=0;for(;r<n.length&&u<e.length;){let d=n.charCodeAt(r),m=e.charCodeAt(u);if(av(d)&&av(m)){let y=0;do++r,y=y*10+d-zx,d=n.charCodeAt(r);while(av(d)&&y>0);let l=0;do++u,l=l*10+m-zx,m=e.charCodeAt(u);while(av(m)&&l>0);if(y<l)return-1;if(y>l)return 1}else{if(d<m)return-1;if(d>m)return 1;++r,++u}}return n.length-e.length}const zx=48,tI=57;function av(n){return!isNaN(n)&&zx<=n&&n<=tI}function nI(n,e){const r=Object.create(null),u=new iI(n),d=Math.floor(n.length*.4)+1;for(const m of e){const y=u.measure(m,d);y!==void 0&&(r[m]=y)}return Object.keys(r).sort((m,y)=>{const l=r[m]-r[y];return l!==0?l:eI(m,y)})}class iI{constructor(e){this._input=e,this._inputLowerCase=e.toLowerCase(),this._inputArray=f2(this._inputLowerCase),this._rows=[new Array(e.length+1).fill(0),new Array(e.length+1).fill(0),new Array(e.length+1).fill(0)]}measure(e,r){if(this._input===e)return 0;const u=e.toLowerCase();if(this._inputLowerCase===u)return 1;let d=f2(u),m=this._inputArray;if(d.length<m.length){const k=d;d=m,m=k}const y=d.length,l=m.length;if(y-l>r)return;const E=this._rows;for(let k=0;k<=l;k++)E[0][k]=k;for(let k=1;k<=y;k++){const N=E[(k-1)%3],F=E[k%3];let B=F[0]=k;for(let W=1;W<=l;W++){const re=d[k-1]===m[W-1]?0:1;let ie=Math.min(N[W]+1,F[W-1]+1,N[W-1]+re);if(k>1&&W>1&&d[k-1]===m[W-2]&&d[k-2]===m[W-1]){const de=E[(k-2)%3][W-2];ie=Math.min(ie,de+1)}ie<B&&(B=ie),F[W]=ie}if(B>r)return}const C=E[y%3][l];return C<=r?C:void 0}}function f2(n){const e=n.length,r=new Array(e);for(let u=0;u<e;++u)r[u]=n.charCodeAt(u);return r}function Ql(n){if(n==null)return Object.create(null);if(Object.getPrototypeOf(n)===null)return n;const e=Object.create(null);for(const[r,u]of Object.entries(n))e[r]=u;return e}function rI(n){return`"${n.replace(aI,oI)}"`}const aI=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function oI(n){return sI[n.charCodeAt(0)]}const sI=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],lI=Object.freeze({});function C1(n,e,r=OS){const u=new Map;for(const de of Object.values(Pt))u.set(de,cI(e,de));let d,m=Array.isArray(n),y=[n],l=-1,E=[],C=n,k,N;const F=[],B=[];do{l++;const de=l===y.length,Ee=de&&E.length!==0;if(de){if(k=B.length===0?void 0:F[F.length-1],C=N,N=B.pop(),Ee)if(m){C=C.slice();let ke=0;for(const[ge,Ae]of E){const Ge=ge-ke;Ae===null?(C.splice(Ge,1),ke++):C[Ge]=Ae}}else{C={...C};for(const[ke,ge]of E)C[ke]=ge}l=d.index,y=d.keys,E=d.edits,m=d.inArray,d=d.prev}else if(N){if(k=m?l:y[l],C=N[k],C==null)continue;F.push(k)}let we;if(!Array.isArray(C)){var W,re;u2(C)||Ei(!1,`Invalid AST Node: ${Mn(C)}.`);const ke=de?(W=u.get(C.kind))===null||W===void 0?void 0:W.leave:(re=u.get(C.kind))===null||re===void 0?void 0:re.enter;if(we=ke?.call(e,C,k,N,F,B),we===lI)break;if(we===!1){if(!de){F.pop();continue}}else if(we!==void 0&&(E.push([k,we]),!de))if(u2(we))C=we;else{F.pop();continue}}if(we===void 0&&Ee&&E.push([k,C]),de)F.pop();else{var ie;d={inArray:m,index:l,keys:y,edits:E,prev:d},m=Array.isArray(C),y=m?C:(ie=r[C.kind])!==null&&ie!==void 0?ie:[],l=-1,E=[],N&&B.push(N),N=C}}while(d!==void 0);return E.length!==0?E[E.length-1][1]:n}function cI(n,e){const r=n[e];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:n.enter,leave:n.leave}}function hs(n){return C1(n,hI)}const uI=80,hI={Name:{leave:n=>n.value},Variable:{leave:n=>"$"+n.name},Document:{leave:n=>Xt(n.definitions,`

`)},OperationDefinition:{leave(n){const e=Jn("(",Xt(n.variableDefinitions,", "),")"),r=Xt([n.operation,Xt([n.name,e]),Xt(n.directives," ")]," ");return(r==="query"?"":r+" ")+n.selectionSet}},VariableDefinition:{leave:({variable:n,type:e,defaultValue:r,directives:u})=>n+": "+e+Jn(" = ",r)+Jn(" ",Xt(u," "))},SelectionSet:{leave:({selections:n})=>Bc(n)},Field:{leave({alias:n,name:e,arguments:r,directives:u,selectionSet:d}){const m=Jn("",n,": ")+e;let y=m+Jn("(",Xt(r,", "),")");return y.length>uI&&(y=m+Jn(`(
`,xv(Xt(r,`
`)),`
)`)),Xt([y,Xt(u," "),d]," ")}},Argument:{leave:({name:n,value:e})=>n+": "+e},FragmentSpread:{leave:({name:n,directives:e})=>"..."+n+Jn(" ",Xt(e," "))},InlineFragment:{leave:({typeCondition:n,directives:e,selectionSet:r})=>Xt(["...",Jn("on ",n),Xt(e," "),r]," ")},FragmentDefinition:{leave:({name:n,typeCondition:e,variableDefinitions:r,directives:u,selectionSet:d})=>`fragment ${n}${Jn("(",Xt(r,", "),")")} on ${e} ${Jn("",Xt(u," ")," ")}`+d},IntValue:{leave:({value:n})=>n},FloatValue:{leave:({value:n})=>n},StringValue:{leave:({value:n,block:e})=>e?RD(n):rI(n)},BooleanValue:{leave:({value:n})=>n?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:n})=>n},ListValue:{leave:({values:n})=>"["+Xt(n,", ")+"]"},ObjectValue:{leave:({fields:n})=>"{"+Xt(n,", ")+"}"},ObjectField:{leave:({name:n,value:e})=>n+": "+e},Directive:{leave:({name:n,arguments:e})=>"@"+n+Jn("(",Xt(e,", "),")")},NamedType:{leave:({name:n})=>n},ListType:{leave:({type:n})=>"["+n+"]"},NonNullType:{leave:({type:n})=>n+"!"},SchemaDefinition:{leave:({description:n,directives:e,operationTypes:r})=>Jn("",n,`
`)+Xt(["schema",Xt(e," "),Bc(r)]," ")},OperationTypeDefinition:{leave:({operation:n,type:e})=>n+": "+e},ScalarTypeDefinition:{leave:({description:n,name:e,directives:r})=>Jn("",n,`
`)+Xt(["scalar",e,Xt(r," ")]," ")},ObjectTypeDefinition:{leave:({description:n,name:e,interfaces:r,directives:u,fields:d})=>Jn("",n,`
`)+Xt(["type",e,Jn("implements ",Xt(r," & ")),Xt(u," "),Bc(d)]," ")},FieldDefinition:{leave:({description:n,name:e,arguments:r,type:u,directives:d})=>Jn("",n,`
`)+e+(p2(r)?Jn(`(
`,xv(Xt(r,`
`)),`
)`):Jn("(",Xt(r,", "),")"))+": "+u+Jn(" ",Xt(d," "))},InputValueDefinition:{leave:({description:n,name:e,type:r,defaultValue:u,directives:d})=>Jn("",n,`
`)+Xt([e+": "+r,Jn("= ",u),Xt(d," ")]," ")},InterfaceTypeDefinition:{leave:({description:n,name:e,interfaces:r,directives:u,fields:d})=>Jn("",n,`
`)+Xt(["interface",e,Jn("implements ",Xt(r," & ")),Xt(u," "),Bc(d)]," ")},UnionTypeDefinition:{leave:({description:n,name:e,directives:r,types:u})=>Jn("",n,`
`)+Xt(["union",e,Xt(r," "),Jn("= ",Xt(u," | "))]," ")},EnumTypeDefinition:{leave:({description:n,name:e,directives:r,values:u})=>Jn("",n,`
`)+Xt(["enum",e,Xt(r," "),Bc(u)]," ")},EnumValueDefinition:{leave:({description:n,name:e,directives:r})=>Jn("",n,`
`)+Xt([e,Xt(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:n,name:e,directives:r,fields:u})=>Jn("",n,`
`)+Xt(["input",e,Xt(r," "),Bc(u)]," ")},DirectiveDefinition:{leave:({description:n,name:e,arguments:r,repeatable:u,locations:d})=>Jn("",n,`
`)+"directive @"+e+(p2(r)?Jn(`(
`,xv(Xt(r,`
`)),`
)`):Jn("(",Xt(r,", "),")"))+(u?" repeatable":"")+" on "+Xt(d," | ")},SchemaExtension:{leave:({directives:n,operationTypes:e})=>Xt(["extend schema",Xt(n," "),Bc(e)]," ")},ScalarTypeExtension:{leave:({name:n,directives:e})=>Xt(["extend scalar",n,Xt(e," ")]," ")},ObjectTypeExtension:{leave:({name:n,interfaces:e,directives:r,fields:u})=>Xt(["extend type",n,Jn("implements ",Xt(e," & ")),Xt(r," "),Bc(u)]," ")},InterfaceTypeExtension:{leave:({name:n,interfaces:e,directives:r,fields:u})=>Xt(["extend interface",n,Jn("implements ",Xt(e," & ")),Xt(r," "),Bc(u)]," ")},UnionTypeExtension:{leave:({name:n,directives:e,types:r})=>Xt(["extend union",n,Xt(e," "),Jn("= ",Xt(r," | "))]," ")},EnumTypeExtension:{leave:({name:n,directives:e,values:r})=>Xt(["extend enum",n,Xt(e," "),Bc(r)]," ")},InputObjectTypeExtension:{leave:({name:n,directives:e,fields:r})=>Xt(["extend input",n,Xt(e," "),Bc(r)]," ")}};function Xt(n,e=""){var r;return(r=n?.filter(u=>u).join(e))!==null&&r!==void 0?r:""}function Bc(n){return Jn(`{
`,xv(Xt(n,`
`)),`
}`)}function Jn(n,e,r=""){return e!=null&&e!==""?n+e+r:""}function xv(n){return Jn("  ",n.replace(/\n/g,`
  `))}function p2(n){var e;return(e=n?.some(r=>r.includes(`
`)))!==null&&e!==void 0?e:!1}function jx(n,e){switch(n.kind){case Pt.NULL:return null;case Pt.INT:return parseInt(n.value,10);case Pt.FLOAT:return parseFloat(n.value);case Pt.STRING:case Pt.ENUM:case Pt.BOOLEAN:return n.value;case Pt.LIST:return n.values.map(r=>jx(r,e));case Pt.OBJECT:return Rp(n.fields,r=>r.name.value,r=>jx(r.value,e));case Pt.VARIABLE:return e?.[n.name.value]}}function Hc(n){if(n!=null||Ei(!1,"Must provide name."),typeof n=="string"||Ei(!1,"Expected name to be a string."),n.length===0)throw new Ii("Expected name to be a non-empty string.");for(let e=1;e<n.length;++e)if(!NS(n.charCodeAt(e)))throw new Ii(`Names must only contain [_a-zA-Z0-9] but "${n}" does not.`);if(!A1(n.charCodeAt(0)))throw new Ii(`Names must start with [_a-zA-Z] but "${n}" does not.`);return n}function dI(n){if(n==="true"||n==="false"||n==="null")throw new Ii(`Enum values cannot be named: ${n}`);return Hc(n)}function ZS(n){return $g(n)||Af(n)||$c(n)||zp(n)||If(n)||cd(n)||Lf(n)||ud(n)}function $g(n){return nh(n,Xp)}function Af(n){return nh(n,Nf)}function fI(n){if(!Af(n))throw new Error(`Expected ${Mn(n)} to be a GraphQL Object type.`);return n}function $c(n){return nh(n,iE)}function pI(n){if(!$c(n))throw new Error(`Expected ${Mn(n)} to be a GraphQL Interface type.`);return n}function zp(n){return nh(n,rE)}function If(n){return nh(n,sb)}function cd(n){return nh(n,aE)}function Lf(n){return nh(n,Vl)}function ud(n){return nh(n,ni)}function YS(n){return $g(n)||If(n)||cd(n)||D1(n)&&YS(n.ofType)}function HS(n){return $g(n)||Af(n)||$c(n)||zp(n)||If(n)||D1(n)&&HS(n.ofType)}function qS(n){return $g(n)||If(n)}function mI(n){return $c(n)||zp(n)}class Vl{constructor(e){ZS(e)||Ei(!1,`Expected ${Mn(e)} to be a GraphQL type.`),this.ofType=e}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class ni{constructor(e){XS(e)||Ei(!1,`Expected ${Mn(e)} to be a GraphQL nullable type.`),this.ofType=e}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function D1(n){return Lf(n)||ud(n)}function XS(n){return ZS(n)&&!ud(n)}function gI(n){if(!XS(n))throw new Error(`Expected ${Mn(n)} to be a GraphQL nullable type.`);return n}function yI(n){if(n){let e=n;for(;D1(e);)e=e.ofType;return e}}function WS(n){return typeof n=="function"?n():n}function QS(n){return typeof n=="function"?n():n}class Xp{constructor(e){var r,u,d,m;const y=(r=e.parseValue)!==null&&r!==void 0?r:d2;this.name=Hc(e.name),this.description=e.description,this.specifiedByURL=e.specifiedByURL,this.serialize=(u=e.serialize)!==null&&u!==void 0?u:d2,this.parseValue=y,this.parseLiteral=(d=e.parseLiteral)!==null&&d!==void 0?d:(l,E)=>y(jx(l,E)),this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(m=e.extensionASTNodes)!==null&&m!==void 0?m:[],e.specifiedByURL==null||typeof e.specifiedByURL=="string"||Ei(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${Mn(e.specifiedByURL)}.`),e.serialize==null||typeof e.serialize=="function"||Ei(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),e.parseLiteral&&(typeof e.parseValue=="function"&&typeof e.parseLiteral=="function"||Ei(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class Nf{constructor(e){var r;this.name=Hc(e.name),this.description=e.description,this.isTypeOf=e.isTypeOf,this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._fields=()=>JS(e),this._interfaces=()=>KS(e),e.isTypeOf==null||typeof e.isTypeOf=="function"||Ei(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${Mn(e.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:tE(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function KS(n){var e;const r=WS((e=n.interfaces)!==null&&e!==void 0?e:[]);return Array.isArray(r)||Ei(!1,`${n.name} interfaces must be an Array or a function which returns an Array.`),r}function JS(n){const e=QS(n.fields);return wg(e)||Ei(!1,`${n.name} fields must be an object with field names as keys or a function which returns such an object.`),ob(e,(r,u)=>{var d;wg(r)||Ei(!1,`${n.name}.${u} field config must be an object.`),r.resolve==null||typeof r.resolve=="function"||Ei(!1,`${n.name}.${u} field resolver must be a function if provided, but got: ${Mn(r.resolve)}.`);const m=(d=r.args)!==null&&d!==void 0?d:{};return wg(m)||Ei(!1,`${n.name}.${u} args must be an object with argument names as keys.`),{name:Hc(u),description:r.description,type:r.type,args:eE(m),resolve:r.resolve,subscribe:r.subscribe,deprecationReason:r.deprecationReason,extensions:Ql(r.extensions),astNode:r.astNode}})}function eE(n){return Object.entries(n).map(([e,r])=>({name:Hc(e),description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:Ql(r.extensions),astNode:r.astNode}))}function wg(n){return _d(n)&&!Array.isArray(n)}function tE(n){return ob(n,e=>({description:e.description,type:e.type,args:nE(e.args),resolve:e.resolve,subscribe:e.subscribe,deprecationReason:e.deprecationReason,extensions:e.extensions,astNode:e.astNode}))}function nE(n){return Rp(n,e=>e.name,e=>({description:e.description,type:e.type,defaultValue:e.defaultValue,deprecationReason:e.deprecationReason,extensions:e.extensions,astNode:e.astNode}))}class iE{constructor(e){var r;this.name=Hc(e.name),this.description=e.description,this.resolveType=e.resolveType,this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._fields=JS.bind(void 0,e),this._interfaces=KS.bind(void 0,e),e.resolveType==null||typeof e.resolveType=="function"||Ei(!1,`${this.name} must provide "resolveType" as a function, but got: ${Mn(e.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:tE(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class rE{constructor(e){var r;this.name=Hc(e.name),this.description=e.description,this.resolveType=e.resolveType,this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._types=_I.bind(void 0,e),e.resolveType==null||typeof e.resolveType=="function"||Ei(!1,`${this.name} must provide "resolveType" as a function, but got: ${Mn(e.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function _I(n){const e=WS(n.types);return Array.isArray(e)||Ei(!1,`Must provide Array of types or a function which returns such an array for Union ${n.name}.`),e}class sb{constructor(e){var r;this.name=Hc(e.name),this.description=e.description,this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._values=typeof e.values=="function"?e.values:m2(this.name,e.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=m2(this.name,this._values())),this._values}getValue(e){return this._nameLookup===null&&(this._nameLookup=$S(this.getValues(),r=>r.name)),this._nameLookup[e]}serialize(e){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(u=>[u.value,u])));const r=this._valueLookup.get(e);if(r===void 0)throw new Ii(`Enum "${this.name}" cannot represent value: ${Mn(e)}`);return r.name}parseValue(e){if(typeof e!="string"){const u=Mn(e);throw new Ii(`Enum "${this.name}" cannot represent non-string value: ${u}.`+ov(this,u))}const r=this.getValue(e);if(r==null)throw new Ii(`Value "${e}" does not exist in "${this.name}" enum.`+ov(this,e));return r.value}parseLiteral(e,r){if(e.kind!==Pt.ENUM){const d=hs(e);throw new Ii(`Enum "${this.name}" cannot represent non-enum value: ${d}.`+ov(this,d),{nodes:e})}const u=this.getValue(e.value);if(u==null){const d=hs(e);throw new Ii(`Value "${d}" does not exist in "${this.name}" enum.`+ov(this,d),{nodes:e})}return u.value}toConfig(){const e=Rp(this.getValues(),r=>r.name,r=>({description:r.description,value:r.value,deprecationReason:r.deprecationReason,extensions:r.extensions,astNode:r.astNode}));return{name:this.name,description:this.description,values:e,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function ov(n,e){const r=n.getValues().map(d=>d.name),u=nI(e,r);return JD("the enum value",u)}function m2(n,e){return wg(e)||Ei(!1,`${n} values must be an object with value names as keys.`),Object.entries(e).map(([r,u])=>(wg(u)||Ei(!1,`${n}.${r} must refer to an object with a "value" key representing an internal value but got: ${Mn(u)}.`),{name:dI(r),description:u.description,value:u.value!==void 0?u.value:r,deprecationReason:u.deprecationReason,extensions:Ql(u.extensions),astNode:u.astNode}))}class aE{constructor(e){var r,u;this.name=Hc(e.name),this.description=e.description,this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this.isOneOf=(u=e.isOneOf)!==null&&u!==void 0?u:!1,this._fields=vI.bind(void 0,e)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const e=ob(this.getFields(),r=>({description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:r.extensions,astNode:r.astNode}));return{name:this.name,description:this.description,fields:e,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function vI(n){const e=QS(n.fields);return wg(e)||Ei(!1,`${n.name} fields must be an object with field names as keys or a function which returns such an object.`),ob(e,(r,u)=>(!("resolve"in r)||Ei(!1,`${n.name}.${u} field has a resolve property, but Input Types cannot define resolvers.`),{name:Hc(u),description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:Ql(r.extensions),astNode:r.astNode}))}const rx=2147483647,ax=-2147483648,bI=new Xp({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(n){const e=H0(n);if(typeof e=="boolean")return e?1:0;let r=e;if(typeof e=="string"&&e!==""&&(r=Number(e)),typeof r!="number"||!Number.isInteger(r))throw new Ii(`Int cannot represent non-integer value: ${Mn(e)}`);if(r>rx||r<ax)throw new Ii("Int cannot represent non 32-bit signed integer value: "+Mn(e));return r},parseValue(n){if(typeof n!="number"||!Number.isInteger(n))throw new Ii(`Int cannot represent non-integer value: ${Mn(n)}`);if(n>rx||n<ax)throw new Ii(`Int cannot represent non 32-bit signed integer value: ${n}`);return n},parseLiteral(n){if(n.kind!==Pt.INT)throw new Ii(`Int cannot represent non-integer value: ${hs(n)}`,{nodes:n});const e=parseInt(n.value,10);if(e>rx||e<ax)throw new Ii(`Int cannot represent non 32-bit signed integer value: ${n.value}`,{nodes:n});return e}}),xI=new Xp({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(n){const e=H0(n);if(typeof e=="boolean")return e?1:0;let r=e;if(typeof e=="string"&&e!==""&&(r=Number(e)),typeof r!="number"||!Number.isFinite(r))throw new Ii(`Float cannot represent non numeric value: ${Mn(e)}`);return r},parseValue(n){if(typeof n!="number"||!Number.isFinite(n))throw new Ii(`Float cannot represent non numeric value: ${Mn(n)}`);return n},parseLiteral(n){if(n.kind!==Pt.FLOAT&&n.kind!==Pt.INT)throw new Ii(`Float cannot represent non numeric value: ${hs(n)}`,n);return parseFloat(n.value)}}),Kr=new Xp({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(n){const e=H0(n);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"true":"false";if(typeof e=="number"&&Number.isFinite(e))return e.toString();throw new Ii(`String cannot represent value: ${Mn(n)}`)},parseValue(n){if(typeof n!="string")throw new Ii(`String cannot represent a non string value: ${Mn(n)}`);return n},parseLiteral(n){if(n.kind!==Pt.STRING)throw new Ii(`String cannot represent a non string value: ${hs(n)}`,{nodes:n});return n.value}}),pl=new Xp({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(n){const e=H0(n);if(typeof e=="boolean")return e;if(Number.isFinite(e))return e!==0;throw new Ii(`Boolean cannot represent a non boolean value: ${Mn(e)}`)},parseValue(n){if(typeof n!="boolean")throw new Ii(`Boolean cannot represent a non boolean value: ${Mn(n)}`);return n},parseLiteral(n){if(n.kind!==Pt.BOOLEAN)throw new Ii(`Boolean cannot represent a non boolean value: ${hs(n)}`,{nodes:n});return n.value}}),oE=new Xp({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(n){const e=H0(n);if(typeof e=="string")return e;if(Number.isInteger(e))return String(e);throw new Ii(`ID cannot represent value: ${Mn(n)}`)},parseValue(n){if(typeof n=="string")return n;if(typeof n=="number"&&Number.isInteger(n))return n.toString();throw new Ii(`ID cannot represent value: ${Mn(n)}`)},parseLiteral(n){if(n.kind!==Pt.STRING&&n.kind!==Pt.INT)throw new Ii("ID cannot represent a non-string and non-integer value: "+hs(n),{nodes:n});return n.value}}),wI=Object.freeze([Kr,bI,xI,pl,oE]);function H0(n){if(_d(n)){if(typeof n.valueOf=="function"){const e=n.valueOf();if(!_d(e))return e}if(typeof n.toJSON=="function")return n.toJSON()}return n}function TI(n){return nh(n,Wp)}class Wp{constructor(e){var r,u;this.name=Hc(e.name),this.description=e.description,this.locations=e.locations,this.isRepeatable=(r=e.isRepeatable)!==null&&r!==void 0?r:!1,this.extensions=Ql(e.extensions),this.astNode=e.astNode,Array.isArray(e.locations)||Ei(!1,`@${e.name} locations must be an Array.`);const d=(u=e.args)!==null&&u!==void 0?u:{};_d(d)&&!Array.isArray(d)||Ei(!1,`@${e.name} args must be an object with argument names as keys.`),this.args=eE(d)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:nE(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const SI=new Wp({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[si.FIELD,si.FRAGMENT_SPREAD,si.INLINE_FRAGMENT],args:{if:{type:new ni(pl),description:"Included when true."}}}),EI=new Wp({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[si.FIELD,si.FRAGMENT_SPREAD,si.INLINE_FRAGMENT],args:{if:{type:new ni(pl),description:"Skipped when true."}}}),MI="No longer supported",AI=new Wp({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[si.FIELD_DEFINITION,si.ARGUMENT_DEFINITION,si.INPUT_FIELD_DEFINITION,si.ENUM_VALUE],args:{reason:{type:Kr,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:MI}}}),CI=new Wp({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[si.SCALAR],args:{url:{type:new ni(Kr),description:"The URL that specifies the behavior of this scalar."}}}),DI=new Wp({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[si.INPUT_OBJECT],args:{}}),II=Object.freeze([SI,EI,AI,CI,DI]);function RI(n){return typeof n=="object"&&typeof n?.[Symbol.iterator]=="function"}function c0(n,e){if(ud(e)){const r=c0(n,e.ofType);return r?.kind===Pt.NULL?null:r}if(n===null)return{kind:Pt.NULL};if(n===void 0)return null;if(Lf(e)){const r=e.ofType;if(RI(n)){const u=[];for(const d of n){const m=c0(d,r);m!=null&&u.push(m)}return{kind:Pt.LIST,values:u}}return c0(n,r)}if(cd(e)){if(!_d(n))return null;const r=[];for(const u of Object.values(e.getFields())){const d=c0(n[u.name],u.type);d&&r.push({kind:Pt.OBJECT_FIELD,name:{kind:Pt.NAME,value:u.name},value:d})}return{kind:Pt.OBJECT,fields:r}}if(qS(e)){const r=e.serialize(n);if(r==null)return null;if(typeof r=="boolean")return{kind:Pt.BOOLEAN,value:r};if(typeof r=="number"&&Number.isFinite(r)){const u=String(r);return g2.test(u)?{kind:Pt.INT,value:u}:{kind:Pt.FLOAT,value:u}}if(typeof r=="string")return If(e)?{kind:Pt.ENUM,value:r}:e===oE&&g2.test(r)?{kind:Pt.INT,value:r}:{kind:Pt.STRING,value:r};throw new TypeError(`Cannot convert value to AST: ${Mn(r)}.`)}ib(!1,"Unexpected input type: "+Mn(e))}const g2=/^-?(?:0|[1-9][0-9]*)$/,I1=new Nf({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:Kr,resolve:n=>n.description},types:{description:"A list of all types supported by this server.",type:new ni(new Vl(new ni(Zu))),resolve(n){return Object.values(n.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new ni(Zu),resolve:n=>n.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:Zu,resolve:n=>n.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:Zu,resolve:n=>n.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new ni(new Vl(new ni(sE))),resolve:n=>n.getDirectives()}})}),sE=new Nf({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new ni(Kr),resolve:n=>n.name},description:{type:Kr,resolve:n=>n.description},isRepeatable:{type:new ni(pl),resolve:n=>n.isRepeatable},locations:{type:new ni(new Vl(new ni(lE))),resolve:n=>n.locations},args:{type:new ni(new Vl(new ni(lb))),args:{includeDeprecated:{type:pl,defaultValue:!1}},resolve(n,{includeDeprecated:e}){return e?n.args:n.args.filter(r=>r.deprecationReason==null)}}})}),lE=new sb({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:si.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:si.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:si.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:si.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:si.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:si.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:si.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:si.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:si.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:si.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:si.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:si.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:si.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:si.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:si.UNION,description:"Location adjacent to a union definition."},ENUM:{value:si.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:si.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:si.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:si.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),Zu=new Nf({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new ni(hE),resolve(n){if($g(n))return Qi.SCALAR;if(Af(n))return Qi.OBJECT;if($c(n))return Qi.INTERFACE;if(zp(n))return Qi.UNION;if(If(n))return Qi.ENUM;if(cd(n))return Qi.INPUT_OBJECT;if(Lf(n))return Qi.LIST;if(ud(n))return Qi.NON_NULL;ib(!1,`Unexpected type: "${Mn(n)}".`)}},name:{type:Kr,resolve:n=>"name"in n?n.name:void 0},description:{type:Kr,resolve:n=>"description"in n?n.description:void 0},specifiedByURL:{type:Kr,resolve:n=>"specifiedByURL"in n?n.specifiedByURL:void 0},fields:{type:new Vl(new ni(cE)),args:{includeDeprecated:{type:pl,defaultValue:!1}},resolve(n,{includeDeprecated:e}){if(Af(n)||$c(n)){const r=Object.values(n.getFields());return e?r:r.filter(u=>u.deprecationReason==null)}}},interfaces:{type:new Vl(new ni(Zu)),resolve(n){if(Af(n)||$c(n))return n.getInterfaces()}},possibleTypes:{type:new Vl(new ni(Zu)),resolve(n,e,r,{schema:u}){if(mI(n))return u.getPossibleTypes(n)}},enumValues:{type:new Vl(new ni(uE)),args:{includeDeprecated:{type:pl,defaultValue:!1}},resolve(n,{includeDeprecated:e}){if(If(n)){const r=n.getValues();return e?r:r.filter(u=>u.deprecationReason==null)}}},inputFields:{type:new Vl(new ni(lb)),args:{includeDeprecated:{type:pl,defaultValue:!1}},resolve(n,{includeDeprecated:e}){if(cd(n)){const r=Object.values(n.getFields());return e?r:r.filter(u=>u.deprecationReason==null)}}},ofType:{type:Zu,resolve:n=>"ofType"in n?n.ofType:void 0},isOneOf:{type:pl,resolve:n=>{if(cd(n))return n.isOneOf}}})}),cE=new Nf({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new ni(Kr),resolve:n=>n.name},description:{type:Kr,resolve:n=>n.description},args:{type:new ni(new Vl(new ni(lb))),args:{includeDeprecated:{type:pl,defaultValue:!1}},resolve(n,{includeDeprecated:e}){return e?n.args:n.args.filter(r=>r.deprecationReason==null)}},type:{type:new ni(Zu),resolve:n=>n.type},isDeprecated:{type:new ni(pl),resolve:n=>n.deprecationReason!=null},deprecationReason:{type:Kr,resolve:n=>n.deprecationReason}})}),lb=new Nf({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new ni(Kr),resolve:n=>n.name},description:{type:Kr,resolve:n=>n.description},type:{type:new ni(Zu),resolve:n=>n.type},defaultValue:{type:Kr,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(n){const{type:e,defaultValue:r}=n,u=c0(r,e);return u?hs(u):null}},isDeprecated:{type:new ni(pl),resolve:n=>n.deprecationReason!=null},deprecationReason:{type:Kr,resolve:n=>n.deprecationReason}})}),uE=new Nf({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new ni(Kr),resolve:n=>n.name},description:{type:Kr,resolve:n=>n.description},isDeprecated:{type:new ni(pl),resolve:n=>n.deprecationReason!=null},deprecationReason:{type:Kr,resolve:n=>n.deprecationReason}})});var Qi;(function(n){n.SCALAR="SCALAR",n.OBJECT="OBJECT",n.INTERFACE="INTERFACE",n.UNION="UNION",n.ENUM="ENUM",n.INPUT_OBJECT="INPUT_OBJECT",n.LIST="LIST",n.NON_NULL="NON_NULL"})(Qi||(Qi={}));const hE=new sb({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:Qi.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:Qi.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:Qi.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:Qi.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:Qi.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:Qi.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:Qi.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:Qi.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new ni(I1);new ni(Kr);new ni(Kr);const kI=Object.freeze([I1,sE,lE,Zu,cE,lb,uE,hE]);class PI{constructor(e){var r,u;this.__validationErrors=e.assumeValid===!0?[]:void 0,_d(e)||Ei(!1,"Must provide configuration object."),!e.types||Array.isArray(e.types)||Ei(!1,`"types" must be Array if provided but got: ${Mn(e.types)}.`),!e.directives||Array.isArray(e.directives)||Ei(!1,`"directives" must be Array if provided but got: ${Mn(e.directives)}.`),this.description=e.description,this.extensions=Ql(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._queryType=e.query,this._mutationType=e.mutation,this._subscriptionType=e.subscription,this._directives=(u=e.directives)!==null&&u!==void 0?u:II;const d=new Set(e.types);if(e.types!=null)for(const m of e.types)d.delete(m),Vc(m,d);this._queryType!=null&&Vc(this._queryType,d),this._mutationType!=null&&Vc(this._mutationType,d),this._subscriptionType!=null&&Vc(this._subscriptionType,d);for(const m of this._directives)if(TI(m))for(const y of m.args)Vc(y.type,d);Vc(I1,d),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const m of d){if(m==null)continue;const y=m.name;if(y||Ei(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[y]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${y}".`);if(this._typeMap[y]=m,$c(m)){for(const l of m.getInterfaces())if($c(l)){let E=this._implementationsMap[l.name];E===void 0&&(E=this._implementationsMap[l.name]={objects:[],interfaces:[]}),E.interfaces.push(m)}}else if(Af(m)){for(const l of m.getInterfaces())if($c(l)){let E=this._implementationsMap[l.name];E===void 0&&(E=this._implementationsMap[l.name]={objects:[],interfaces:[]}),E.objects.push(m)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(e){switch(e){case ad.QUERY:return this.getQueryType();case ad.MUTATION:return this.getMutationType();case ad.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(e){return this.getTypeMap()[e]}getPossibleTypes(e){return zp(e)?e.getTypes():this.getImplementations(e).objects}getImplementations(e){const r=this._implementationsMap[e.name];return r??{objects:[],interfaces:[]}}isSubType(e,r){let u=this._subTypeMap[e.name];if(u===void 0){if(u=Object.create(null),zp(e))for(const d of e.getTypes())u[d.name]=!0;else{const d=this.getImplementations(e);for(const m of d.objects)u[m.name]=!0;for(const m of d.interfaces)u[m.name]=!0}this._subTypeMap[e.name]=u}return u[r.name]!==void 0}getDirectives(){return this._directives}getDirective(e){return this.getDirectives().find(r=>r.name===e)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function Vc(n,e){const r=yI(n);if(!e.has(r)){if(e.add(r),zp(r))for(const u of r.getTypes())Vc(u,e);else if(Af(r)||$c(r)){for(const u of r.getInterfaces())Vc(u,e);for(const u of Object.values(r.getFields())){Vc(u.type,e);for(const d of u.args)Vc(d.type,e)}}else if(cd(r))for(const u of Object.values(r.getFields()))Vc(u.type,e)}return e}function u0(n,e,r){if(n){if(n.kind===Pt.VARIABLE){n.name.value;return}if(ud(e))return n.kind===Pt.NULL?void 0:u0(n,e.ofType,r);if(n.kind===Pt.NULL)return null;if(Lf(e)){const u=e.ofType;if(n.kind===Pt.LIST){const m=[];for(const y of n.values)if(y2(y,r)){if(ud(u))return;m.push(null)}else{const l=u0(y,u,r);if(l===void 0)return;m.push(l)}return m}const d=u0(n,u,r);return d===void 0?void 0:[d]}if(cd(e)){if(n.kind!==Pt.OBJECT)return;const u=Object.create(null),d=$S(n.fields,m=>m.name.value);for(const m of Object.values(e.getFields())){const y=d[m.name];if(!y||y2(y.value,r)){if(m.defaultValue!==void 0)u[m.name]=m.defaultValue;else if(ud(m.type))return;continue}const l=u0(y.value,m.type,r);if(l===void 0)return;u[m.name]=l}if(e.isOneOf){const m=Object.keys(u);if(m.length!==1||u[m[0]]===null)return}return u}if(qS(e)){let u;try{u=e.parseLiteral(n,r)}catch{return}return u===void 0?void 0:u}ib(!1,"Unexpected input type: "+Mn(e))}}function y2(n,e){return n.kind===Pt.VARIABLE&&e==null}function OI(n){const e={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...n},r=e.descriptions?"description":"",u=e.specifiedByUrl?"specifiedByURL":"",d=e.directiveIsRepeatable?"isRepeatable":"",m=e.schemaDescription?r:"";function y(E){return e.inputValueDeprecation?E:""}const l=e.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${m}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${r}
          ${d}
          locations
          args${y("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${r}
      ${u}
      ${l}
      fields(includeDeprecated: true) {
        name
        ${r}
        args${y("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${y("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${r}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${r}
      type { ...TypeRef }
      defaultValue
      ${y("isDeprecated")}
      ${y("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function LI(n,e){_d(n)&&_d(n.__schema)||Ei(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${Mn(n)}.`);const r=n.__schema,u=Rp(r.types,Me=>Me.name,Me=>F(Me));for(const Me of[...wI,...kI])u[Me.name]&&(u[Me.name]=Me);const d=r.queryType?k(r.queryType):null,m=r.mutationType?k(r.mutationType):null,y=r.subscriptionType?k(r.subscriptionType):null,l=r.directives?r.directives.map(at):[];return new PI({description:r.description,query:d,mutation:m,subscription:y,types:Object.values(u),directives:l,assumeValid:void 0});function E(Me){if(Me.kind===Qi.LIST){const Qe=Me.ofType;if(!Qe)throw new Error("Decorated type deeper than introspection query.");return new Vl(E(Qe))}if(Me.kind===Qi.NON_NULL){const Qe=Me.ofType;if(!Qe)throw new Error("Decorated type deeper than introspection query.");const St=E(Qe);return new ni(gI(St))}return C(Me)}function C(Me){const Qe=Me.name;if(!Qe)throw new Error(`Unknown type reference: ${Mn(Me)}.`);const St=u[Qe];if(!St)throw new Error(`Invalid or incomplete schema, unknown type: ${Qe}. Ensure that a full introspection query is used in order to build a client schema.`);return St}function k(Me){return fI(C(Me))}function N(Me){return pI(C(Me))}function F(Me){if(Me!=null&&Me.name!=null&&Me.kind!=null)switch(Me.kind){case Qi.SCALAR:return B(Me);case Qi.OBJECT:return re(Me);case Qi.INTERFACE:return ie(Me);case Qi.UNION:return de(Me);case Qi.ENUM:return Ee(Me);case Qi.INPUT_OBJECT:return we(Me)}const Qe=Mn(Me);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${Qe}.`)}function B(Me){return new Xp({name:Me.name,description:Me.description,specifiedByURL:Me.specifiedByURL})}function W(Me){if(Me.interfaces===null&&Me.kind===Qi.INTERFACE)return[];if(!Me.interfaces){const Qe=Mn(Me);throw new Error(`Introspection result missing interfaces: ${Qe}.`)}return Me.interfaces.map(N)}function re(Me){return new Nf({name:Me.name,description:Me.description,interfaces:()=>W(Me),fields:()=>ke(Me)})}function ie(Me){return new iE({name:Me.name,description:Me.description,interfaces:()=>W(Me),fields:()=>ke(Me)})}function de(Me){if(!Me.possibleTypes){const Qe=Mn(Me);throw new Error(`Introspection result missing possibleTypes: ${Qe}.`)}return new rE({name:Me.name,description:Me.description,types:()=>Me.possibleTypes.map(k)})}function Ee(Me){if(!Me.enumValues){const Qe=Mn(Me);throw new Error(`Introspection result missing enumValues: ${Qe}.`)}return new sb({name:Me.name,description:Me.description,values:Rp(Me.enumValues,Qe=>Qe.name,Qe=>({description:Qe.description,deprecationReason:Qe.deprecationReason}))})}function we(Me){if(!Me.inputFields){const Qe=Mn(Me);throw new Error(`Introspection result missing inputFields: ${Qe}.`)}return new aE({name:Me.name,description:Me.description,fields:()=>Ae(Me.inputFields),isOneOf:Me.isOneOf})}function ke(Me){if(!Me.fields)throw new Error(`Introspection result missing fields: ${Mn(Me)}.`);return Rp(Me.fields,Qe=>Qe.name,ge)}function ge(Me){const Qe=E(Me.type);if(!HS(Qe)){const St=Mn(Qe);throw new Error(`Introspection must provide output type for fields, but received: ${St}.`)}if(!Me.args){const St=Mn(Me);throw new Error(`Introspection result missing field args: ${St}.`)}return{description:Me.description,deprecationReason:Me.deprecationReason,type:Qe,args:Ae(Me.args)}}function Ae(Me){return Rp(Me,Qe=>Qe.name,Ge)}function Ge(Me){const Qe=E(Me.type);if(!YS(Qe)){const bt=Mn(Qe);throw new Error(`Introspection must provide input type for arguments, but received: ${bt}.`)}const St=Me.defaultValue!=null?u0(QD(Me.defaultValue),Qe):void 0;return{description:Me.description,type:Qe,defaultValue:St,deprecationReason:Me.deprecationReason}}function at(Me){if(!Me.args){const Qe=Mn(Me);throw new Error(`Introspection result missing directive args: ${Qe}.`)}if(!Me.locations){const Qe=Mn(Me);throw new Error(`Introspection result missing directive locations: ${Qe}.`)}return new Wp({name:Me.name,description:Me.description,isRepeatable:Me.isRepeatable,locations:Me.locations.slice(),args:Ae(Me.args)})}}const _2="Accept",Fx="Content-Type",Bx="application/json",dE="application/graphql-response+json",v2=n=>n.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),NI=n=>{const e=n.toLowerCase();return e.includes(dE)||e.includes(Bx)},b2=n=>{try{if(Array.isArray(n))return{_tag:"Batch",executionResults:n.map(x2)};if(bv(n))return{_tag:"Single",executionResult:x2(n)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(n)}`)}catch(e){return e}},x2=n=>{if(typeof n!="object"||n===null)throw new Error("Invalid execution result: result is not object");let e,r,u;if("errors"in n){if(!bv(n.errors)&&!Array.isArray(n.errors))throw new Error("Invalid execution result: errors is not plain object OR array");e=n.errors}if("data"in n){if(!bv(n.data)&&n.data!==null)throw new Error("Invalid execution result: data is not plain object");r=n.data}if("extensions"in n){if(!bv(n.extensions))throw new Error("Invalid execution result: extensions is not plain object");u=n.extensions}return{data:r,errors:e,extensions:u}},zI=n=>n._tag==="Batch"?n.executionResults.some(w2):w2(n.executionResult),w2=n=>Array.isArray(n.errors)?n.errors.length>0:!!n.errors,fE=n=>typeof n=="object"&&n!==null&&"kind"in n&&n.kind===Pt.OPERATION_DEFINITION,jI=n=>{let e;const r=n.definitions.filter(fE);return r.length===1&&(e=r[0].name?.value),e},FI=n=>{let e=!1;const r=n.definitions.filter(fE);return r.length===1&&(e=r[0].operation==="mutation"),e},ox=(n,e)=>{const r=typeof n=="string"?n:hs(n);let u=!1,d;if(e)return{expression:r,isMutation:u,operationName:d};const m=bD(()=>typeof n=="string"?US(n):n);return m instanceof Error?{expression:r,isMutation:u,operationName:d}:(d=jI(m),u=FI(m),{expression:r,operationName:d,isMutation:u})},R1=JSON,sx=async n=>{const e={...n,method:n.request._tag==="Single"?n.request.document.isMutation?"POST":o2(n.method??"post"):n.request.hasMutations?"POST":o2(n.method??"post"),fetchOptions:{...n.fetchOptions,errorPolicy:n.fetchOptions.errorPolicy??"none"}},u=await UI(e.method)(e);if(!u.ok)return new xg({status:u.status,headers:u.headers},{query:n.request._tag==="Single"?n.request.document.expression:n.request.query,variables:n.request.variables});const d=await BI(u,n.fetchOptions.jsonSerializer??R1);if(d instanceof Error)throw d;const m={status:u.status,headers:u.headers};if(zI(d)&&e.fetchOptions.errorPolicy==="none"){const y=d._tag==="Batch"?{...d.executionResults,...m}:{...d.executionResult,...m};return new xg(y,{query:n.request._tag==="Single"?n.request.document.expression:n.request.query,variables:n.request.variables})}switch(d._tag){case"Single":return{...m,...T2(e)(d.executionResult)};case"Batch":return{...m,data:d.executionResults.map(T2(e))};default:M1(d)}},T2=n=>e=>({extensions:e.extensions,data:e.data,errors:n.fetchOptions.errorPolicy==="all"?e.errors:void 0}),BI=async(n,e)=>{const r=n.headers.get(Fx),u=await n.text();return r&&NI(r)?b2(e.parse(u)):b2(u)},UI=n=>async e=>{const r=new Headers(e.headers);let u=null,d;r.has(_2)||r.set(_2,[dE,Bx].join(", ")),n==="POST"?(d=(e.fetchOptions.jsonSerializer??R1).stringify(VI(e)),typeof d=="string"&&!r.has(Fx)&&r.set(Fx,Bx)):u=GI(e);const m={method:n,headers:r,body:d,...e.fetchOptions};let y=new URL(e.url),l=m;if(e.middleware){const C=await Promise.resolve(e.middleware({...m,url:e.url,operationName:e.request._tag==="Single"?e.request.document.operationName:void 0,variables:e.request.variables})),{url:k,...N}=C;y=new URL(k),l=N}return u&&u.forEach((C,k)=>{y.searchParams.append(k,C)}),await(e.fetch??fetch)(y,l)},VI=n=>{switch(n.request._tag){case"Single":return{query:n.request.document.expression,variables:n.request.variables,operationName:n.request.document.operationName};case"Batch":return RS(n.request.query,n.request.variables??[]).map(([e,r])=>({query:e,variables:r}));default:throw M1(n.request)}},GI=n=>{const e=n.fetchOptions.jsonSerializer??R1,r=new URLSearchParams;switch(n.request._tag){case"Single":return r.append("query",v2(n.request.document.expression)),n.request.variables&&r.append("variables",e.stringify(n.request.variables)),n.request.document.operationName&&r.append("operationName",n.request.document.operationName),r;case"Batch":{const u=n.request.variables?.map(y=>e.stringify(y))??[],d=n.request.query.map(v2),m=RS(d,u).map(([y,l])=>({query:y,variables:l}));return r.append("query",e.stringify(m)),r}default:throw M1(n.request)}};class $I{url;requestConfig;constructor(e,r={}){this.url=e,this.requestConfig=r}rawRequest=async(...e)=>{const[r,u,d]=e,m=TD(r,u,d),{headers:y,fetch:l=globalThis.fetch,method:E="POST",requestMiddleware:C,responseMiddleware:k,excludeOperationName:N,...F}=this.requestConfig,{url:B}=this;m.signal!==void 0&&(F.signal=m.signal);const W=ox(m.query,N),re=await sx({url:B,request:{_tag:"Single",document:W,variables:m.variables},headers:{...cg(nx(y)),...cg(m.requestHeaders)},fetch:l,method:E,fetchOptions:F,middleware:C});if(k&&await k(re,{operationName:W.operationName,variables:u,url:this.url}),re instanceof Error)throw re;return re};async request(e,...r){const[u,d]=r,m=ZI(e,u,d),{headers:y,fetch:l=globalThis.fetch,method:E="POST",requestMiddleware:C,responseMiddleware:k,excludeOperationName:N,...F}=this.requestConfig,{url:B}=this;m.signal!==void 0&&(F.signal=m.signal);const W=ox(m.document,N),re=await sx({url:B,request:{_tag:"Single",document:W,variables:m.variables},headers:{...cg(nx(y)),...cg(m.requestHeaders)},fetch:l,method:E,fetchOptions:F,middleware:C});if(k&&await k(re,{operationName:W.operationName,variables:m.variables,url:this.url}),re instanceof Error)throw re;return re.data}async batchRequests(e,r){const u=wD(e,r),{headers:d,excludeOperationName:m,...y}=this.requestConfig;u.signal!==void 0&&(y.signal=u.signal);const l=u.documents.map(({document:F})=>ox(F,m)),E=l.map(({expression:F})=>F),C=l.some(({isMutation:F})=>F),k=u.documents.map(({variables:F})=>F),N=await sx({url:this.url,request:{_tag:"Batch",operationName:void 0,query:E,hasMutations:C,variables:k},headers:{...cg(nx(d)),...cg(u.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:y,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(N,{operationName:void 0,variables:k,url:this.url}),N instanceof Error)throw N;return N.data}setHeaders(e){return this.requestConfig.headers=e,this}setHeader(e,r){const{headers:u}=this.requestConfig;return u?u[e]=r:this.requestConfig.headers={[e]:r},this}setEndpoint(e){return this.url=e,this}}async function k1(n,e,...r){const u=YI(n,e,...r);return new $I(u.url).request({...u})}const ZI=(n,e,r)=>n.document?n:{document:n,variables:e,requestHeaders:r,signal:void 0},YI=(n,e,...r)=>{const[u,d]=r;return typeof n=="string"?{url:n,document:e,variables:u,requestHeaders:d,signal:void 0}:n},lx="/otp/transmodel/v3",cb=()=>{try{return new URL(lx),lx}catch{return`${window.location.origin}${lx}`}};var pE=(n=>(n.LimitToNumOfItineraries="limitToNumOfItineraries",n.LimitToSearchWindow="limitToSearchWindow",n.ListAll="listAll",n.Off="off",n))(pE||{}),Ti=(n=>(n.Air="air",n.Bicycle="bicycle",n.Bus="bus",n.Cableway="cableway",n.Car="car",n.Coach="coach",n.Foot="foot",n.Funicular="funicular",n.Lift="lift",n.Metro="metro",n.Monorail="monorail",n.Rail="rail",n.Scooter="scooter",n.Taxi="taxi",n.Tram="tram",n.Trolleybus="trolleybus",n.Water="water",n))(Ti||{}),Ag=(n=>(n.Bicycle="bicycle",n.BikePark="bike_park",n.BikeRental="bike_rental",n.Car="car",n.CarPark="car_park",n.CarPickup="car_pickup",n.CarRental="car_rental",n.Flexible="flexible",n.Foot="foot",n.ScooterRental="scooter_rental",n))(Ag||{}),mE=(n=>(n.Air="air",n.Bus="bus",n.Cableway="cableway",n.Coach="coach",n.Funicular="funicular",n.Lift="lift",n.Metro="metro",n.Monorail="monorail",n.Rail="rail",n.Taxi="taxi",n.Tram="tram",n.Trolleybus="trolleybus",n.Unknown="unknown",n.Water="water",n))(mE||{});const HI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},qI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},XI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},WI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},QI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},KI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"fromEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},JI={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":HI,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":qI,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":XI,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":WI,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":QI,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        generalizedCost\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            generalizedCost\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            fromEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":KI};function Zg(n){return JI[n]??{}}const eR=Zg(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),tR=n=>{const[e,r]=K.useState(null);return K.useEffect(()=>{(async()=>{if(n.place){const d={id:n.place};try{r(await k1(cb(),eR,d))}catch(m){console.error("Error at useQuayCoordinateQuery",m)}}else r(null)})()},[n]),e?.quay};function S2(n){const e=tR(n);if(e){const{latitude:r,longitude:u}=e;if(r&&u)return{latitude:r,longitude:u}}if(n.coordinates)return{...n.coordinates}}function nR({setCursor:n,tripQueryVariables:e,setTripQueryVariables:r,loading:u}){const d=S2(e.from),m=S2(e.to);return H.jsxs(H.Fragment,{children:[d&&H.jsx(i2,{draggable:!0,latitude:d.latitude,longitude:d.longitude,onDragStart:()=>n("grabbing"),onDragEnd:y=>{n("auto"),u||r({...e,from:{coordinates:{latitude:y.lngLat.lat,longitude:y.lngLat.lng}}})},anchor:"bottom-right",children:H.jsx("img",{alt:"",src:yD,height:48,width:49})}),m&&H.jsx(i2,{draggable:!0,latitude:m.latitude,longitude:m.longitude,onDragStart:()=>n("grabbing"),onDragEnd:y=>{n("auto"),u||r({...e,to:{coordinates:{latitude:y.lngLat.lat,longitude:y.lngLat.lng}}})},anchor:"bottom-right",children:H.jsx("img",{alt:"",src:_D,height:48,width:49})})]})}var iR=function(n,e){for(var r=Math.pow(10,e),u=n.length,d=new Array(Math.floor(n.length/2)),m=0,y=0,l=0,E=0;m<u;++E){var C=1,k=0,N=void 0;do N=n.charCodeAt(m++)-63-1,C+=N<<k,k+=5;while(N>=31);y+=C&1?~(C>>1):C>>1,C=1,k=0;do N=n.charCodeAt(m++)-63-1,C+=N<<k,k+=5;while(N>=31);l+=C&1?~(C>>1):C>>1,d[E]=[y/r,l/r]}return d.length=E,d};const rR=function(n){return n===Ti.Foot?"#191616":n===Ti.Bicycle?"#5076D9":n===Ti.Scooter?"#14b7ca":n===Ti.Car?"#7e7e7e":n===Ti.Rail?"#86BF8B":n===Ti.Coach?"#25642A":n===Ti.Metro?"#D9B250":n===Ti.Bus?"#fe0000":n===Ti.Tram?"#D9B250":n===Ti.Trolleybus?"#25642A":n===Ti.Water||n===Ti.Air||n===Ti.Cableway||n===Ti.Funicular||n===Ti.Monorail||n===Ti.Taxi?"#81304C":"#aaa"},gE=function(n){return n.line?.presentation?.colour?`#${n.line.presentation.colour}`:rR(n.mode)};function aR({tripPattern:n}){return H.jsx(H.Fragment,{children:n?.legs.map((e,r)=>e.pointsOnLink&&H.jsxs(hD,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:iR(e.pointsOnLink.points,5).map(u=>u.reverse())}},children:[H.jsx(r2,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),H.jsx(r2,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":gE(e),"line-width":4}})]},e.id||`footleg_${r}`))})}const yE=(n,e,r)=>({...n,[r]:{coordinates:{latitude:e.lat,longitude:e.lng}}}),oR=(n,e)=>yE(n,e,"from"),sR=(n,e)=>yE(n,e,"to");function lR({tripQueryVariables:n,setTripQueryVariables:e}){return K.useCallback(r=>{r.preventDefault(),n.from.coordinates?e(sR(n,r.lngLat)):e(oR(n,r.lngLat))},[n,e])}var cx={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var E2;function cR(){return E2||(E2=1,function(n){(function(){var e={}.hasOwnProperty;function r(){for(var m="",y=0;y<arguments.length;y++){var l=arguments[y];l&&(m=d(m,u(l)))}return m}function u(m){if(typeof m=="string"||typeof m=="number")return m;if(typeof m!="object")return"";if(Array.isArray(m))return r.apply(null,m);if(m.toString!==Object.prototype.toString&&!m.toString.toString().includes("[native code]"))return m.toString();var y="";for(var l in m)e.call(m,l)&&m[l]&&(y=d(y,l));return y}function d(m,y){return y?m?m+" "+y:m+y:m}n.exports?(r.default=r,n.exports=r):window.classNames=r})()}(cx)),cx.exports}var uR=cR();const mn=Hp(uR);function pn(){return pn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var u in r)({}).hasOwnProperty.call(r,u)&&(n[u]=r[u])}return n},pn.apply(null,arguments)}function P1(n,e){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(e.indexOf(u)!==-1)continue;r[u]=n[u]}return r}function M2(n){return"default"+n.charAt(0).toUpperCase()+n.substr(1)}function hR(n){var e=dR(n,"string");return typeof e=="symbol"?e:String(e)}function dR(n,e){if(typeof n!="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var u=r.call(n,e);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function fR(n,e,r){var u=K.useRef(n!==void 0),d=K.useState(e),m=d[0],y=d[1],l=n!==void 0,E=u.current;return u.current=l,!l&&E&&m!==e&&y(e),[l?n:m,K.useCallback(function(C){for(var k=arguments.length,N=new Array(k>1?k-1:0),F=1;F<k;F++)N[F-1]=arguments[F];r&&r.apply(void 0,[C].concat(N)),y(C)},[r])]}function _E(n,e){return Object.keys(e).reduce(function(r,u){var d,m=r,y=m[M2(u)],l=m[u],E=P1(m,[M2(u),u].map(hR)),C=e[u],k=fR(l,y,n[C]),N=k[0],F=k[1];return pn({},E,(d={},d[u]=N,d[C]=F,d))},n)}function Rv(n,e){return Rv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,u){return r.__proto__=u,r},Rv(n,e)}function pR(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Rv(n,e)}const mR=["xxl","xl","lg","md","sm","xs"],gR="xs",q0=K.createContext({prefixes:{},breakpoints:mR,minBreakpoint:gR}),{Consumer:u6,Provider:h6}=q0;function Rn(n,e){const{prefixes:r}=K.useContext(q0);return n||r[e]||e}function yR(){const{breakpoints:n}=K.useContext(q0);return n}function _R(){const{minBreakpoint:n}=K.useContext(q0);return n}function O1(){const{dir:n}=K.useContext(q0);return n==="rtl"}function Yg(n){return n&&n.ownerDocument||document}function vR(n){var e=Yg(n);return e&&e.defaultView||window}function bR(n,e){return vR(n).getComputedStyle(n,e)}var xR=/([A-Z])/g;function wR(n){return n.replace(xR,"-$1").toLowerCase()}var TR=/^ms-/;function sv(n){return wR(n).replace(TR,"-ms-")}var SR=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function ER(n){return!!(n&&SR.test(n))}function hd(n,e){var r="",u="";if(typeof e=="string")return n.style.getPropertyValue(sv(e))||bR(n).getPropertyValue(sv(e));Object.keys(e).forEach(function(d){var m=e[d];!m&&m!==0?n.style.removeProperty(sv(d)):ER(d)?u+=d+"("+m+") ":r+=sv(d)+": "+m+";"}),u&&(r+="transform: "+u+";"),n.style.cssText+=";"+r}var ux={exports:{}},hx,A2;function MR(){if(A2)return hx;A2=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return hx=n,hx}var dx,C2;function AR(){if(C2)return dx;C2=1;var n=MR();function e(){}function r(){}return r.resetWarningCache=e,dx=function(){function u(y,l,E,C,k,N){if(N!==n){var F=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw F.name="Invariant Violation",F}}u.isRequired=u;function d(){return u}var m={array:u,bigint:u,bool:u,func:u,number:u,object:u,string:u,symbol:u,any:u,arrayOf:d,element:u,elementType:u,instanceOf:d,node:u,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:r,resetWarningCache:e};return m.PropTypes=m,m},dx}var D2;function CR(){return D2||(D2=1,ux.exports=AR()()),ux.exports}var DR=CR();const dd=Hp(DR),I2={disabled:!1},vE=fl.createContext(null);var IR=function(e){return e.scrollTop},h0="unmounted",wf="exited",Gc="entering",nd="entered",R0="exiting",Sd=function(n){pR(e,n);function e(u,d){var m;m=n.call(this,u,d)||this;var y=d,l=y&&!y.isMounting?u.enter:u.appear,E;return m.appearStatus=null,u.in?l?(E=wf,m.appearStatus=Gc):E=nd:u.unmountOnExit||u.mountOnEnter?E=h0:E=wf,m.state={status:E},m.nextCallback=null,m}e.getDerivedStateFromProps=function(d,m){var y=d.in;return y&&m.status===h0?{status:wf}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(d){var m=null;if(d!==this.props){var y=this.state.status;this.props.in?y!==Gc&&y!==nd&&(m=Gc):(y===Gc||y===nd)&&(m=R0)}this.updateStatus(!1,m)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var d=this.props.timeout,m,y,l;return m=y=l=d,d!=null&&typeof d!="number"&&(m=d.exit,y=d.enter,l=d.appear!==void 0?d.appear:y),{exit:m,enter:y,appear:l}},r.updateStatus=function(d,m){if(d===void 0&&(d=!1),m!==null)if(this.cancelNextCallback(),m===Gc){if(this.props.unmountOnExit||this.props.mountOnEnter){var y=this.props.nodeRef?this.props.nodeRef.current:Ip.findDOMNode(this);y&&IR(y)}this.performEnter(d)}else this.performExit();else this.props.unmountOnExit&&this.state.status===wf&&this.setState({status:h0})},r.performEnter=function(d){var m=this,y=this.props.enter,l=this.context?this.context.isMounting:d,E=this.props.nodeRef?[l]:[Ip.findDOMNode(this),l],C=E[0],k=E[1],N=this.getTimeouts(),F=l?N.appear:N.enter;if(!d&&!y||I2.disabled){this.safeSetState({status:nd},function(){m.props.onEntered(C)});return}this.props.onEnter(C,k),this.safeSetState({status:Gc},function(){m.props.onEntering(C,k),m.onTransitionEnd(F,function(){m.safeSetState({status:nd},function(){m.props.onEntered(C,k)})})})},r.performExit=function(){var d=this,m=this.props.exit,y=this.getTimeouts(),l=this.props.nodeRef?void 0:Ip.findDOMNode(this);if(!m||I2.disabled){this.safeSetState({status:wf},function(){d.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:R0},function(){d.props.onExiting(l),d.onTransitionEnd(y.exit,function(){d.safeSetState({status:wf},function(){d.props.onExited(l)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(d,m){m=this.setNextCallback(m),this.setState(d,m)},r.setNextCallback=function(d){var m=this,y=!0;return this.nextCallback=function(l){y&&(y=!1,m.nextCallback=null,d(l))},this.nextCallback.cancel=function(){y=!1},this.nextCallback},r.onTransitionEnd=function(d,m){this.setNextCallback(m);var y=this.props.nodeRef?this.props.nodeRef.current:Ip.findDOMNode(this),l=d==null&&!this.props.addEndListener;if(!y||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var E=this.props.nodeRef?[this.nextCallback]:[y,this.nextCallback],C=E[0],k=E[1];this.props.addEndListener(C,k)}d!=null&&setTimeout(this.nextCallback,d)},r.render=function(){var d=this.state.status;if(d===h0)return null;var m=this.props,y=m.children;m.in,m.mountOnEnter,m.unmountOnExit,m.appear,m.enter,m.exit,m.timeout,m.addEndListener,m.onEnter,m.onEntering,m.onEntered,m.onExit,m.onExiting,m.onExited,m.nodeRef;var l=P1(m,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return fl.createElement(vE.Provider,{value:null},typeof y=="function"?y(d,l):fl.cloneElement(fl.Children.only(y),l))},e}(fl.Component);Sd.contextType=vE;Sd.propTypes={};function ug(){}Sd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ug,onEntering:ug,onEntered:ug,onExit:ug,onExiting:ug,onExited:ug};Sd.UNMOUNTED=h0;Sd.EXITED=wf;Sd.ENTERING=Gc;Sd.ENTERED=nd;Sd.EXITING=R0;function bE(n){return n.code==="Escape"||n.keyCode===27}function RR(){const n=K.version.split(".");return{major:+n[0],minor:+n[1],patch:+n[2]}}function Hg(n){if(!n||typeof n=="function")return null;const{major:e}=RR();return e>=19?n.props.ref:n.ref}const qg=!!(typeof window<"u"&&window.document&&window.document.createElement);var Ux=!1,Vx=!1;try{var fx={get passive(){return Ux=!0},get once(){return Vx=Ux=!0}};qg&&(window.addEventListener("test",fx,fx),window.removeEventListener("test",fx,!0))}catch{}function xE(n,e,r,u){if(u&&typeof u!="boolean"&&!Vx){var d=u.once,m=u.capture,y=r;!Vx&&d&&(y=r.__once||function l(E){this.removeEventListener(e,l,m),r.call(this,E)},r.__once=y),n.addEventListener(e,y,Ux?u:m)}n.addEventListener(e,r,u)}function Gx(n,e,r,u){var d=u&&typeof u!="boolean"?u.capture:u;n.removeEventListener(e,r,d),r.__once&&n.removeEventListener(e,r.__once,d)}function od(n,e,r,u){return xE(n,e,r,u),function(){Gx(n,e,r,u)}}function kR(n,e,r,u){if(u===void 0&&(u=!0),n){var d=document.createEvent("HTMLEvents");d.initEvent(e,r,u),n.dispatchEvent(d)}}function PR(n){var e=hd(n,"transitionDuration")||"",r=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*r}function OR(n,e,r){r===void 0&&(r=5);var u=!1,d=setTimeout(function(){u||kR(n,"transitionend",!0)},e+r),m=od(n,"transitionend",function(){u=!0},{once:!0});return function(){clearTimeout(d),m()}}function wE(n,e,r,u){r==null&&(r=PR(n)||0);var d=OR(n,r,u),m=od(n,"transitionend",e);return function(){d(),m()}}function R2(n,e){const r=hd(n,e)||"",u=r.indexOf("ms")===-1?1e3:1;return parseFloat(r)*u}function L1(n,e){const r=R2(n,"transitionDuration"),u=R2(n,"transitionDelay"),d=wE(n,m=>{m.target===n&&(d(),e(m))},r+u)}function t0(...n){return n.filter(e=>e!=null).reduce((e,r)=>{if(typeof r!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return e===null?r:function(...d){e.apply(this,d),r.apply(this,d)}},null)}function TE(n){n.offsetHeight}const k2=n=>!n||typeof n=="function"?n:e=>{n.current=e};function LR(n,e){const r=k2(n),u=k2(e);return d=>{r&&r(d),u&&u(d)}}function N1(n,e){return K.useMemo(()=>LR(n,e),[n,e])}function $x(n){return n&&"setState"in n?Ip.findDOMNode(n):n??null}const ub=fl.forwardRef(({onEnter:n,onEntering:e,onEntered:r,onExit:u,onExiting:d,onExited:m,addEndListener:y,children:l,childRef:E,...C},k)=>{const N=K.useRef(null),F=N1(N,E),B=Ae=>{F($x(Ae))},W=Ae=>Ge=>{Ae&&N.current&&Ae(N.current,Ge)},re=K.useCallback(W(n),[n]),ie=K.useCallback(W(e),[e]),de=K.useCallback(W(r),[r]),Ee=K.useCallback(W(u),[u]),we=K.useCallback(W(d),[d]),ke=K.useCallback(W(m),[m]),ge=K.useCallback(W(y),[y]);return H.jsx(Sd,{ref:k,...C,onEnter:re,onEntered:de,onEntering:ie,onExit:Ee,onExited:ke,onExiting:we,addEndListener:ge,nodeRef:N,children:typeof l=="function"?(Ae,Ge)=>l(Ae,{...Ge,ref:B}):fl.cloneElement(l,{ref:B})})});ub.displayName="TransitionWrapper";const NR={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function zR(n,e){const r=`offset${n[0].toUpperCase()}${n.slice(1)}`,u=e[r],d=NR[n];return u+parseInt(hd(e,d[0]),10)+parseInt(hd(e,d[1]),10)}const jR={[wf]:"collapse",[R0]:"collapsing",[Gc]:"collapsing",[nd]:"collapse show"},z1=fl.forwardRef(({onEnter:n,onEntering:e,onEntered:r,onExit:u,onExiting:d,className:m,children:y,dimension:l="height",in:E=!1,timeout:C=300,mountOnEnter:k=!1,unmountOnExit:N=!1,appear:F=!1,getDimensionValue:B=zR,...W},re)=>{const ie=typeof l=="function"?l():l,de=K.useMemo(()=>t0(Ae=>{Ae.style[ie]="0"},n),[ie,n]),Ee=K.useMemo(()=>t0(Ae=>{const Ge=`scroll${ie[0].toUpperCase()}${ie.slice(1)}`;Ae.style[ie]=`${Ae[Ge]}px`},e),[ie,e]),we=K.useMemo(()=>t0(Ae=>{Ae.style[ie]=null},r),[ie,r]),ke=K.useMemo(()=>t0(Ae=>{Ae.style[ie]=`${B(ie,Ae)}px`,TE(Ae)},u),[u,B,ie]),ge=K.useMemo(()=>t0(Ae=>{Ae.style[ie]=null},d),[ie,d]);return H.jsx(ub,{ref:re,addEndListener:L1,...W,"aria-expanded":W.role?E:null,onEnter:de,onEntering:Ee,onEntered:we,onExit:ke,onExiting:ge,childRef:Hg(y),in:E,timeout:C,mountOnEnter:k,unmountOnExit:N,appear:F,children:(Ae,Ge)=>fl.cloneElement(y,{...Ge,className:mn(m,y.props.className,jR[Ae],ie==="width"&&"collapse-horizontal")})})});z1.displayName="Collapse";function SE(n,e){return Array.isArray(n)?n.includes(e):n===e}const X0=K.createContext({});X0.displayName="AccordionContext";const j1=K.forwardRef(({as:n="div",bsPrefix:e,className:r,children:u,eventKey:d,...m},y)=>{const{activeEventKey:l}=K.useContext(X0);return e=Rn(e,"accordion-collapse"),H.jsx(z1,{ref:y,in:SE(l,d),...m,className:mn(r,e),children:H.jsx(n,{children:K.Children.only(u)})})});j1.displayName="AccordionCollapse";const hb=K.createContext({eventKey:""});hb.displayName="AccordionItemContext";const EE=K.forwardRef(({as:n="div",bsPrefix:e,className:r,onEnter:u,onEntering:d,onEntered:m,onExit:y,onExiting:l,onExited:E,...C},k)=>{e=Rn(e,"accordion-body");const{eventKey:N}=K.useContext(hb);return H.jsx(j1,{eventKey:N,onEnter:u,onEntering:d,onEntered:m,onExit:y,onExiting:l,onExited:E,children:H.jsx(n,{ref:k,...C,className:mn(r,e)})})});EE.displayName="AccordionBody";function FR(n,e){const{activeEventKey:r,onSelect:u,alwaysOpen:d}=K.useContext(X0);return m=>{let y=n===r?null:n;d&&(Array.isArray(r)?r.includes(n)?y=r.filter(l=>l!==n):y=[...r,n]:y=[n]),u?.(y,m),e?.(m)}}const F1=K.forwardRef(({as:n="button",bsPrefix:e,className:r,onClick:u,...d},m)=>{e=Rn(e,"accordion-button");const{eventKey:y}=K.useContext(hb),l=FR(y,u),{activeEventKey:E}=K.useContext(X0);return n==="button"&&(d.type="button"),H.jsx(n,{ref:m,onClick:l,...d,"aria-expanded":Array.isArray(E)?E.includes(y):y===E,className:mn(r,e,!SE(E,y)&&"collapsed")})});F1.displayName="AccordionButton";const ME=K.forwardRef(({as:n="h2","aria-controls":e,bsPrefix:r,className:u,children:d,onClick:m,...y},l)=>(r=Rn(r,"accordion-header"),H.jsx(n,{ref:l,...y,className:mn(u,r),children:H.jsx(F1,{onClick:m,"aria-controls":e,children:d})})));ME.displayName="AccordionHeader";const AE=K.forwardRef(({as:n="div",bsPrefix:e,className:r,eventKey:u,...d},m)=>{e=Rn(e,"accordion-item");const y=K.useMemo(()=>({eventKey:u}),[u]);return H.jsx(hb.Provider,{value:y,children:H.jsx(n,{ref:m,...d,className:mn(r,e)})})});AE.displayName="AccordionItem";const CE=K.forwardRef((n,e)=>{const{as:r="div",activeKey:u,bsPrefix:d,className:m,onSelect:y,flush:l,alwaysOpen:E,...C}=_E(n,{activeKey:"onSelect"}),k=Rn(d,"accordion"),N=K.useMemo(()=>({activeEventKey:u,onSelect:y,alwaysOpen:E}),[u,y,E]);return H.jsx(X0.Provider,{value:N,children:H.jsx(r,{ref:e,...C,className:mn(m,k,l&&`${k}-flush`)})})});CE.displayName="Accordion";const lv=Object.assign(CE,{Button:F1,Collapse:j1,Item:AE,Header:ME,Body:EE});function BR(n){const e=K.useRef(n);return K.useEffect(()=>{e.current=n},[n]),e}function jp(n){const e=BR(n);return K.useCallback(function(...r){return e.current&&e.current(...r)},[e])}const DE=n=>K.forwardRef((e,r)=>H.jsx("div",{...e,ref:r,className:mn(e.className,n)}));function P2(){return K.useState(null)}function UR(n){const e=K.useRef(n);return K.useEffect(()=>{e.current=n},[n]),e}function Gu(n){const e=UR(n);return K.useCallback(function(...r){return e.current&&e.current(...r)},[e])}function IE(){const n=K.useRef(!0),e=K.useRef(()=>n.current);return K.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),e.current}function VR(n){const e=K.useRef(null);return K.useEffect(()=>{e.current=n}),e.current}const GR=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",$R=typeof document<"u",O2=$R||GR?K.useLayoutEffect:K.useEffect,ZR=["as","disabled"];function YR(n,e){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(e.indexOf(u)>=0)continue;r[u]=n[u]}return r}function HR(n){return!n||n.trim()==="#"}function RE({tagName:n,disabled:e,href:r,target:u,rel:d,role:m,onClick:y,tabIndex:l=0,type:E}){n||(r!=null||u!=null||d!=null?n="a":n="button");const C={tagName:n};if(n==="button")return[{type:E||"button",disabled:e},C];const k=F=>{if((e||n==="a"&&HR(r))&&F.preventDefault(),e){F.stopPropagation();return}y?.(F)},N=F=>{F.key===" "&&(F.preventDefault(),k(F))};return n==="a"&&(r||(r="#"),e&&(r=void 0)),[{role:m??"button",disabled:void 0,tabIndex:e?void 0:l,href:r,target:n==="a"?u:void 0,"aria-disabled":e||void 0,rel:n==="a"?d:void 0,onClick:k,onKeyDown:N},C]}const qR=K.forwardRef((n,e)=>{let{as:r,disabled:u}=n,d=YR(n,ZR);const[m,{tagName:y}]=RE(Object.assign({tagName:r,disabled:u},d));return H.jsx(y,Object.assign({},d,m,{ref:e}))});qR.displayName="Button";const XR={[Gc]:"show",[nd]:"show"},Cg=K.forwardRef(({className:n,children:e,transitionClasses:r={},onEnter:u,...d},m)=>{const y={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...d},l=K.useCallback((E,C)=>{TE(E),u?.(E,C)},[u]);return H.jsx(ub,{ref:m,addEndListener:L1,...y,onEnter:l,childRef:Hg(e),children:(E,C)=>K.cloneElement(e,{...C,className:mn("fade",n,e.props.className,XR[E],r[E])})})});Cg.displayName="Fade";const WR={"aria-label":dd.string,onClick:dd.func,variant:dd.oneOf(["white"])},B1=K.forwardRef(({className:n,variant:e,"aria-label":r="Close",...u},d)=>H.jsx("button",{ref:d,type:"button",className:mn("btn-close",e&&`btn-close-${e}`,n),"aria-label":r,...u}));B1.displayName="CloseButton";B1.propTypes=WR;const Cf=K.forwardRef(({as:n,bsPrefix:e,variant:r="primary",size:u,active:d=!1,disabled:m=!1,className:y,...l},E)=>{const C=Rn(e,"btn"),[k,{tagName:N}]=RE({tagName:n,disabled:m,...l}),F=N;return H.jsx(F,{...k,...l,ref:E,disabled:m,className:mn(y,C,d&&"active",r&&`${C}-${r}`,u&&`${C}-${u}`,l.href&&m&&"disabled")})});Cf.displayName="Button";const U1=K.forwardRef(({bsPrefix:n,size:e,vertical:r=!1,className:u,role:d="group",as:m="div",...y},l)=>{const E=Rn(n,"btn-group");let C=E;return r&&(C=`${E}-vertical`),H.jsx(m,{...y,ref:l,role:d,className:mn(u,C,e&&`${E}-${e}`)})});U1.displayName="ButtonGroup";function QR(n){const e=K.useRef(n);return e.current=n,e}function KR(n){const e=QR(n);K.useEffect(()=>()=>e.current(),[])}function JR(n,e){return K.Children.toArray(n).some(r=>K.isValidElement(r)&&r.type===e)}function ek({as:n,bsPrefix:e,className:r,...u}){e=Rn(e,"col");const d=yR(),m=_R(),y=[],l=[];return d.forEach(E=>{const C=u[E];delete u[E];let k,N,F;typeof C=="object"&&C!=null?{span:k,offset:N,order:F}=C:k=C;const B=E!==m?`-${E}`:"";k&&y.push(k===!0?`${e}${B}`:`${e}${B}-${k}`),F!=null&&l.push(`order${B}-${F}`),N!=null&&l.push(`offset${B}-${N}`)}),[{...u,className:mn(r,...y,...l)},{as:n,bsPrefix:e,spans:y}]}const kE=K.forwardRef((n,e)=>{const[{className:r,...u},{as:d="div",bsPrefix:m,spans:y}]=ek(n);return H.jsx(d,{...u,ref:e,className:mn(r,!y.length&&m)})});kE.displayName="Col";var tk=Function.prototype.bind.call(Function.prototype.call,[].slice);function hg(n,e){return tk(n.querySelectorAll(e))}var L2=Object.prototype.hasOwnProperty;function N2(n,e,r){for(r of n.keys())if(x0(r,e))return r}function x0(n,e){var r,u,d;if(n===e)return!0;if(n&&e&&(r=n.constructor)===e.constructor){if(r===Date)return n.getTime()===e.getTime();if(r===RegExp)return n.toString()===e.toString();if(r===Array){if((u=n.length)===e.length)for(;u--&&x0(n[u],e[u]););return u===-1}if(r===Set){if(n.size!==e.size)return!1;for(u of n)if(d=u,d&&typeof d=="object"&&(d=N2(e,d),!d)||!e.has(d))return!1;return!0}if(r===Map){if(n.size!==e.size)return!1;for(u of n)if(d=u[0],d&&typeof d=="object"&&(d=N2(e,d),!d)||!x0(u[1],e.get(d)))return!1;return!0}if(r===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(r===DataView){if((u=n.byteLength)===e.byteLength)for(;u--&&n.getInt8(u)===e.getInt8(u););return u===-1}if(ArrayBuffer.isView(n)){if((u=n.byteLength)===e.byteLength)for(;u--&&n[u]===e[u];);return u===-1}if(!r||typeof n=="object"){u=0;for(r in n)if(L2.call(n,r)&&++u&&!L2.call(e,r)||!(r in e)||!x0(n[r],e[r]))return!1;return Object.keys(e).length===u}}return n!==n&&e!==e}function nk(n){const e=IE();return[n[0],K.useCallback(r=>{if(e())return n[1](r)},[e,n[1]])]}var zs="top",Hl="bottom",ql="right",js="left",V1="auto",W0=[zs,Hl,ql,js],Dg="start",k0="end",ik="clippingParents",PE="viewport",n0="popper",rk="reference",z2=W0.reduce(function(n,e){return n.concat([e+"-"+Dg,e+"-"+k0])},[]),OE=[].concat(W0,[V1]).reduce(function(n,e){return n.concat([e,e+"-"+Dg,e+"-"+k0])},[]),ak="beforeRead",ok="read",sk="afterRead",lk="beforeMain",ck="main",uk="afterMain",hk="beforeWrite",dk="write",fk="afterWrite",pk=[ak,ok,sk,lk,ck,uk,hk,dk,fk];function Xu(n){return n.split("-")[0]}function _l(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Fp(n){var e=_l(n).Element;return n instanceof e||n instanceof Element}function Wu(n){var e=_l(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function G1(n){if(typeof ShadowRoot>"u")return!1;var e=_l(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}var Pp=Math.max,kv=Math.min,Ig=Math.round;function Zx(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function LE(){return!/^((?!chrome|android).)*safari/i.test(Zx())}function Rg(n,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var u=n.getBoundingClientRect(),d=1,m=1;e&&Wu(n)&&(d=n.offsetWidth>0&&Ig(u.width)/n.offsetWidth||1,m=n.offsetHeight>0&&Ig(u.height)/n.offsetHeight||1);var y=Fp(n)?_l(n):window,l=y.visualViewport,E=!LE()&&r,C=(u.left+(E&&l?l.offsetLeft:0))/d,k=(u.top+(E&&l?l.offsetTop:0))/m,N=u.width/d,F=u.height/m;return{width:N,height:F,top:k,right:C+N,bottom:k+F,left:C,x:C,y:k}}function $1(n){var e=Rg(n),r=n.offsetWidth,u=n.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-u)<=1&&(u=e.height),{x:n.offsetLeft,y:n.offsetTop,width:r,height:u}}function NE(n,e){var r=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(r&&G1(r)){var u=e;do{if(u&&n.isSameNode(u))return!0;u=u.parentNode||u.host}while(u)}return!1}function Rf(n){return n?(n.nodeName||"").toLowerCase():null}function vd(n){return _l(n).getComputedStyle(n)}function mk(n){return["table","td","th"].indexOf(Rf(n))>=0}function zf(n){return((Fp(n)?n.ownerDocument:n.document)||window.document).documentElement}function db(n){return Rf(n)==="html"?n:n.assignedSlot||n.parentNode||(G1(n)?n.host:null)||zf(n)}function j2(n){return!Wu(n)||vd(n).position==="fixed"?null:n.offsetParent}function gk(n){var e=/firefox/i.test(Zx()),r=/Trident/i.test(Zx());if(r&&Wu(n)){var u=vd(n);if(u.position==="fixed")return null}var d=db(n);for(G1(d)&&(d=d.host);Wu(d)&&["html","body"].indexOf(Rf(d))<0;){var m=vd(d);if(m.transform!=="none"||m.perspective!=="none"||m.contain==="paint"||["transform","perspective"].indexOf(m.willChange)!==-1||e&&m.willChange==="filter"||e&&m.filter&&m.filter!=="none")return d;d=d.parentNode}return null}function Q0(n){for(var e=_l(n),r=j2(n);r&&mk(r)&&vd(r).position==="static";)r=j2(r);return r&&(Rf(r)==="html"||Rf(r)==="body"&&vd(r).position==="static")?e:r||gk(n)||e}function Z1(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function w0(n,e,r){return Pp(n,kv(e,r))}function yk(n,e,r){var u=w0(n,e,r);return u>r?r:u}function zE(){return{top:0,right:0,bottom:0,left:0}}function jE(n){return Object.assign({},zE(),n)}function FE(n,e){return e.reduce(function(r,u){return r[u]=n,r},{})}var _k=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,jE(typeof e!="number"?e:FE(e,W0))};function vk(n){var e,r=n.state,u=n.name,d=n.options,m=r.elements.arrow,y=r.modifiersData.popperOffsets,l=Xu(r.placement),E=Z1(l),C=[js,ql].indexOf(l)>=0,k=C?"height":"width";if(!(!m||!y)){var N=_k(d.padding,r),F=$1(m),B=E==="y"?zs:js,W=E==="y"?Hl:ql,re=r.rects.reference[k]+r.rects.reference[E]-y[E]-r.rects.popper[k],ie=y[E]-r.rects.reference[E],de=Q0(m),Ee=de?E==="y"?de.clientHeight||0:de.clientWidth||0:0,we=re/2-ie/2,ke=N[B],ge=Ee-F[k]-N[W],Ae=Ee/2-F[k]/2+we,Ge=w0(ke,Ae,ge),at=E;r.modifiersData[u]=(e={},e[at]=Ge,e.centerOffset=Ge-Ae,e)}}function bk(n){var e=n.state,r=n.options,u=r.element,d=u===void 0?"[data-popper-arrow]":u;d!=null&&(typeof d=="string"&&(d=e.elements.popper.querySelector(d),!d)||NE(e.elements.popper,d)&&(e.elements.arrow=d))}const xk={name:"arrow",enabled:!0,phase:"main",fn:vk,effect:bk,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function kg(n){return n.split("-")[1]}var wk={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Tk(n,e){var r=n.x,u=n.y,d=e.devicePixelRatio||1;return{x:Ig(r*d)/d||0,y:Ig(u*d)/d||0}}function F2(n){var e,r=n.popper,u=n.popperRect,d=n.placement,m=n.variation,y=n.offsets,l=n.position,E=n.gpuAcceleration,C=n.adaptive,k=n.roundOffsets,N=n.isFixed,F=y.x,B=F===void 0?0:F,W=y.y,re=W===void 0?0:W,ie=typeof k=="function"?k({x:B,y:re}):{x:B,y:re};B=ie.x,re=ie.y;var de=y.hasOwnProperty("x"),Ee=y.hasOwnProperty("y"),we=js,ke=zs,ge=window;if(C){var Ae=Q0(r),Ge="clientHeight",at="clientWidth";if(Ae===_l(r)&&(Ae=zf(r),vd(Ae).position!=="static"&&l==="absolute"&&(Ge="scrollHeight",at="scrollWidth")),Ae=Ae,d===zs||(d===js||d===ql)&&m===k0){ke=Hl;var Me=N&&Ae===ge&&ge.visualViewport?ge.visualViewport.height:Ae[Ge];re-=Me-u.height,re*=E?1:-1}if(d===js||(d===zs||d===Hl)&&m===k0){we=ql;var Qe=N&&Ae===ge&&ge.visualViewport?ge.visualViewport.width:Ae[at];B-=Qe-u.width,B*=E?1:-1}}var St=Object.assign({position:l},C&&wk),bt=k===!0?Tk({x:B,y:re},_l(r)):{x:B,y:re};if(B=bt.x,re=bt.y,E){var zt;return Object.assign({},St,(zt={},zt[ke]=Ee?"0":"",zt[we]=de?"0":"",zt.transform=(ge.devicePixelRatio||1)<=1?"translate("+B+"px, "+re+"px)":"translate3d("+B+"px, "+re+"px, 0)",zt))}return Object.assign({},St,(e={},e[ke]=Ee?re+"px":"",e[we]=de?B+"px":"",e.transform="",e))}function Sk(n){var e=n.state,r=n.options,u=r.gpuAcceleration,d=u===void 0?!0:u,m=r.adaptive,y=m===void 0?!0:m,l=r.roundOffsets,E=l===void 0?!0:l,C={placement:Xu(e.placement),variation:kg(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:d,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,F2(Object.assign({},C,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:y,roundOffsets:E})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,F2(Object.assign({},C,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:E})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ek={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Sk,data:{}};var cv={passive:!0};function Mk(n){var e=n.state,r=n.instance,u=n.options,d=u.scroll,m=d===void 0?!0:d,y=u.resize,l=y===void 0?!0:y,E=_l(e.elements.popper),C=[].concat(e.scrollParents.reference,e.scrollParents.popper);return m&&C.forEach(function(k){k.addEventListener("scroll",r.update,cv)}),l&&E.addEventListener("resize",r.update,cv),function(){m&&C.forEach(function(k){k.removeEventListener("scroll",r.update,cv)}),l&&E.removeEventListener("resize",r.update,cv)}}const Ak={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Mk,data:{}};var Ck={left:"right",right:"left",bottom:"top",top:"bottom"};function wv(n){return n.replace(/left|right|bottom|top/g,function(e){return Ck[e]})}var Dk={start:"end",end:"start"};function B2(n){return n.replace(/start|end/g,function(e){return Dk[e]})}function Y1(n){var e=_l(n),r=e.pageXOffset,u=e.pageYOffset;return{scrollLeft:r,scrollTop:u}}function H1(n){return Rg(zf(n)).left+Y1(n).scrollLeft}function Ik(n,e){var r=_l(n),u=zf(n),d=r.visualViewport,m=u.clientWidth,y=u.clientHeight,l=0,E=0;if(d){m=d.width,y=d.height;var C=LE();(C||!C&&e==="fixed")&&(l=d.offsetLeft,E=d.offsetTop)}return{width:m,height:y,x:l+H1(n),y:E}}function Rk(n){var e,r=zf(n),u=Y1(n),d=(e=n.ownerDocument)==null?void 0:e.body,m=Pp(r.scrollWidth,r.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),y=Pp(r.scrollHeight,r.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),l=-u.scrollLeft+H1(n),E=-u.scrollTop;return vd(d||r).direction==="rtl"&&(l+=Pp(r.clientWidth,d?d.clientWidth:0)-m),{width:m,height:y,x:l,y:E}}function q1(n){var e=vd(n),r=e.overflow,u=e.overflowX,d=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+d+u)}function BE(n){return["html","body","#document"].indexOf(Rf(n))>=0?n.ownerDocument.body:Wu(n)&&q1(n)?n:BE(db(n))}function T0(n,e){var r;e===void 0&&(e=[]);var u=BE(n),d=u===((r=n.ownerDocument)==null?void 0:r.body),m=_l(u),y=d?[m].concat(m.visualViewport||[],q1(u)?u:[]):u,l=e.concat(y);return d?l:l.concat(T0(db(y)))}function Yx(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function kk(n,e){var r=Rg(n,!1,e==="fixed");return r.top=r.top+n.clientTop,r.left=r.left+n.clientLeft,r.bottom=r.top+n.clientHeight,r.right=r.left+n.clientWidth,r.width=n.clientWidth,r.height=n.clientHeight,r.x=r.left,r.y=r.top,r}function U2(n,e,r){return e===PE?Yx(Ik(n,r)):Fp(e)?kk(e,r):Yx(Rk(zf(n)))}function Pk(n){var e=T0(db(n)),r=["absolute","fixed"].indexOf(vd(n).position)>=0,u=r&&Wu(n)?Q0(n):n;return Fp(u)?e.filter(function(d){return Fp(d)&&NE(d,u)&&Rf(d)!=="body"}):[]}function Ok(n,e,r,u){var d=e==="clippingParents"?Pk(n):[].concat(e),m=[].concat(d,[r]),y=m[0],l=m.reduce(function(E,C){var k=U2(n,C,u);return E.top=Pp(k.top,E.top),E.right=kv(k.right,E.right),E.bottom=kv(k.bottom,E.bottom),E.left=Pp(k.left,E.left),E},U2(n,y,u));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function UE(n){var e=n.reference,r=n.element,u=n.placement,d=u?Xu(u):null,m=u?kg(u):null,y=e.x+e.width/2-r.width/2,l=e.y+e.height/2-r.height/2,E;switch(d){case zs:E={x:y,y:e.y-r.height};break;case Hl:E={x:y,y:e.y+e.height};break;case ql:E={x:e.x+e.width,y:l};break;case js:E={x:e.x-r.width,y:l};break;default:E={x:e.x,y:e.y}}var C=d?Z1(d):null;if(C!=null){var k=C==="y"?"height":"width";switch(m){case Dg:E[C]=E[C]-(e[k]/2-r[k]/2);break;case k0:E[C]=E[C]+(e[k]/2-r[k]/2);break}}return E}function P0(n,e){e===void 0&&(e={});var r=e,u=r.placement,d=u===void 0?n.placement:u,m=r.strategy,y=m===void 0?n.strategy:m,l=r.boundary,E=l===void 0?ik:l,C=r.rootBoundary,k=C===void 0?PE:C,N=r.elementContext,F=N===void 0?n0:N,B=r.altBoundary,W=B===void 0?!1:B,re=r.padding,ie=re===void 0?0:re,de=jE(typeof ie!="number"?ie:FE(ie,W0)),Ee=F===n0?rk:n0,we=n.rects.popper,ke=n.elements[W?Ee:F],ge=Ok(Fp(ke)?ke:ke.contextElement||zf(n.elements.popper),E,k,y),Ae=Rg(n.elements.reference),Ge=UE({reference:Ae,element:we,placement:d}),at=Yx(Object.assign({},we,Ge)),Me=F===n0?at:Ae,Qe={top:ge.top-Me.top+de.top,bottom:Me.bottom-ge.bottom+de.bottom,left:ge.left-Me.left+de.left,right:Me.right-ge.right+de.right},St=n.modifiersData.offset;if(F===n0&&St){var bt=St[d];Object.keys(Qe).forEach(function(zt){var Zt=[ql,Hl].indexOf(zt)>=0?1:-1,Ft=[zs,Hl].indexOf(zt)>=0?"y":"x";Qe[zt]+=bt[Ft]*Zt})}return Qe}function Lk(n,e){e===void 0&&(e={});var r=e,u=r.placement,d=r.boundary,m=r.rootBoundary,y=r.padding,l=r.flipVariations,E=r.allowedAutoPlacements,C=E===void 0?OE:E,k=kg(u),N=k?l?z2:z2.filter(function(W){return kg(W)===k}):W0,F=N.filter(function(W){return C.indexOf(W)>=0});F.length===0&&(F=N);var B=F.reduce(function(W,re){return W[re]=P0(n,{placement:re,boundary:d,rootBoundary:m,padding:y})[Xu(re)],W},{});return Object.keys(B).sort(function(W,re){return B[W]-B[re]})}function Nk(n){if(Xu(n)===V1)return[];var e=wv(n);return[B2(n),e,B2(e)]}function zk(n){var e=n.state,r=n.options,u=n.name;if(!e.modifiersData[u]._skip){for(var d=r.mainAxis,m=d===void 0?!0:d,y=r.altAxis,l=y===void 0?!0:y,E=r.fallbackPlacements,C=r.padding,k=r.boundary,N=r.rootBoundary,F=r.altBoundary,B=r.flipVariations,W=B===void 0?!0:B,re=r.allowedAutoPlacements,ie=e.options.placement,de=Xu(ie),Ee=de===ie,we=E||(Ee||!W?[wv(ie)]:Nk(ie)),ke=[ie].concat(we).reduce(function(Et,Ut){return Et.concat(Xu(Ut)===V1?Lk(e,{placement:Ut,boundary:k,rootBoundary:N,padding:C,flipVariations:W,allowedAutoPlacements:re}):Ut)},[]),ge=e.rects.reference,Ae=e.rects.popper,Ge=new Map,at=!0,Me=ke[0],Qe=0;Qe<ke.length;Qe++){var St=ke[Qe],bt=Xu(St),zt=kg(St)===Dg,Zt=[zs,Hl].indexOf(bt)>=0,Ft=Zt?"width":"height",Be=P0(e,{placement:St,boundary:k,rootBoundary:N,altBoundary:F,padding:C}),lt=Zt?zt?ql:js:zt?Hl:zs;ge[Ft]>Ae[Ft]&&(lt=wv(lt));var _t=wv(lt),ut=[];if(m&&ut.push(Be[bt]<=0),l&&ut.push(Be[lt]<=0,Be[_t]<=0),ut.every(function(Et){return Et})){Me=St,at=!1;break}Ge.set(St,ut)}if(at)for(var Te=W?3:1,nt=function(Ut){var Ot=ke.find(function(Ln){var Wt=Ge.get(Ln);if(Wt)return Wt.slice(0,Ut).every(function(Xn){return Xn})});if(Ot)return Me=Ot,"break"},yt=Te;yt>0;yt--){var pt=nt(yt);if(pt==="break")break}e.placement!==Me&&(e.modifiersData[u]._skip=!0,e.placement=Me,e.reset=!0)}}const jk={name:"flip",enabled:!0,phase:"main",fn:zk,requiresIfExists:["offset"],data:{_skip:!1}};function V2(n,e,r){return r===void 0&&(r={x:0,y:0}),{top:n.top-e.height-r.y,right:n.right-e.width+r.x,bottom:n.bottom-e.height+r.y,left:n.left-e.width-r.x}}function G2(n){return[zs,ql,Hl,js].some(function(e){return n[e]>=0})}function Fk(n){var e=n.state,r=n.name,u=e.rects.reference,d=e.rects.popper,m=e.modifiersData.preventOverflow,y=P0(e,{elementContext:"reference"}),l=P0(e,{altBoundary:!0}),E=V2(y,u),C=V2(l,d,m),k=G2(E),N=G2(C);e.modifiersData[r]={referenceClippingOffsets:E,popperEscapeOffsets:C,isReferenceHidden:k,hasPopperEscaped:N},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":k,"data-popper-escaped":N})}const Bk={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Fk};function Uk(n,e,r){var u=Xu(n),d=[js,zs].indexOf(u)>=0?-1:1,m=typeof r=="function"?r(Object.assign({},e,{placement:n})):r,y=m[0],l=m[1];return y=y||0,l=(l||0)*d,[js,ql].indexOf(u)>=0?{x:l,y}:{x:y,y:l}}function Vk(n){var e=n.state,r=n.options,u=n.name,d=r.offset,m=d===void 0?[0,0]:d,y=OE.reduce(function(k,N){return k[N]=Uk(N,e.rects,m),k},{}),l=y[e.placement],E=l.x,C=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=E,e.modifiersData.popperOffsets.y+=C),e.modifiersData[u]=y}const Gk={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Vk};function $k(n){var e=n.state,r=n.name;e.modifiersData[r]=UE({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Zk={name:"popperOffsets",enabled:!0,phase:"read",fn:$k,data:{}};function Yk(n){return n==="x"?"y":"x"}function Hk(n){var e=n.state,r=n.options,u=n.name,d=r.mainAxis,m=d===void 0?!0:d,y=r.altAxis,l=y===void 0?!1:y,E=r.boundary,C=r.rootBoundary,k=r.altBoundary,N=r.padding,F=r.tether,B=F===void 0?!0:F,W=r.tetherOffset,re=W===void 0?0:W,ie=P0(e,{boundary:E,rootBoundary:C,padding:N,altBoundary:k}),de=Xu(e.placement),Ee=kg(e.placement),we=!Ee,ke=Z1(de),ge=Yk(ke),Ae=e.modifiersData.popperOffsets,Ge=e.rects.reference,at=e.rects.popper,Me=typeof re=="function"?re(Object.assign({},e.rects,{placement:e.placement})):re,Qe=typeof Me=="number"?{mainAxis:Me,altAxis:Me}:Object.assign({mainAxis:0,altAxis:0},Me),St=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,bt={x:0,y:0};if(Ae){if(m){var zt,Zt=ke==="y"?zs:js,Ft=ke==="y"?Hl:ql,Be=ke==="y"?"height":"width",lt=Ae[ke],_t=lt+ie[Zt],ut=lt-ie[Ft],Te=B?-at[Be]/2:0,nt=Ee===Dg?Ge[Be]:at[Be],yt=Ee===Dg?-at[Be]:-Ge[Be],pt=e.elements.arrow,Et=B&&pt?$1(pt):{width:0,height:0},Ut=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:zE(),Ot=Ut[Zt],Ln=Ut[Ft],Wt=w0(0,Ge[Be],Et[Be]),Xn=we?Ge[Be]/2-Te-Wt-Ot-Qe.mainAxis:nt-Wt-Ot-Qe.mainAxis,br=we?-Ge[Be]/2+Te+Wt+Ln+Qe.mainAxis:yt+Wt+Ln+Qe.mainAxis,ir=e.elements.arrow&&Q0(e.elements.arrow),yi=ir?ke==="y"?ir.clientTop||0:ir.clientLeft||0:0,Un=(zt=St?.[ke])!=null?zt:0,Vn=lt+Xn-Un-yi,Dn=lt+br-Un,Pr=w0(B?kv(_t,Vn):_t,lt,B?Pp(ut,Dn):ut);Ae[ke]=Pr,bt[ke]=Pr-lt}if(l){var ki,Aa=ke==="x"?zs:js,_a=ke==="x"?Hl:ql,Gr=Ae[ge],Or=ge==="y"?"height":"width",Va=Gr+ie[Aa],Ca=Gr-ie[_a],Da=[zs,js].indexOf(de)!==-1,Ga=(ki=St?.[ge])!=null?ki:0,gn=Da?Va:Gr-Ge[Or]-at[Or]-Ga+Qe.altAxis,ii=Da?Gr+Ge[Or]+at[Or]-Ga-Qe.altAxis:Ca,xr=B&&Da?yk(gn,Gr,ii):w0(B?gn:Va,Gr,B?ii:Ca);Ae[ge]=xr,bt[ge]=xr-Gr}e.modifiersData[u]=bt}}const qk={name:"preventOverflow",enabled:!0,phase:"main",fn:Hk,requiresIfExists:["offset"]};function Xk(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Wk(n){return n===_l(n)||!Wu(n)?Y1(n):Xk(n)}function Qk(n){var e=n.getBoundingClientRect(),r=Ig(e.width)/n.offsetWidth||1,u=Ig(e.height)/n.offsetHeight||1;return r!==1||u!==1}function Kk(n,e,r){r===void 0&&(r=!1);var u=Wu(e),d=Wu(e)&&Qk(e),m=zf(e),y=Rg(n,d,r),l={scrollLeft:0,scrollTop:0},E={x:0,y:0};return(u||!u&&!r)&&((Rf(e)!=="body"||q1(m))&&(l=Wk(e)),Wu(e)?(E=Rg(e,!0),E.x+=e.clientLeft,E.y+=e.clientTop):m&&(E.x=H1(m))),{x:y.left+l.scrollLeft-E.x,y:y.top+l.scrollTop-E.y,width:y.width,height:y.height}}function Jk(n){var e=new Map,r=new Set,u=[];n.forEach(function(m){e.set(m.name,m)});function d(m){r.add(m.name);var y=[].concat(m.requires||[],m.requiresIfExists||[]);y.forEach(function(l){if(!r.has(l)){var E=e.get(l);E&&d(E)}}),u.push(m)}return n.forEach(function(m){r.has(m.name)||d(m)}),u}function eP(n){var e=Jk(n);return pk.reduce(function(r,u){return r.concat(e.filter(function(d){return d.phase===u}))},[])}function tP(n){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(n())})})),e}}function nP(n){var e=n.reduce(function(r,u){var d=r[u.name];return r[u.name]=d?Object.assign({},d,u,{options:Object.assign({},d.options,u.options),data:Object.assign({},d.data,u.data)}):u,r},{});return Object.keys(e).map(function(r){return e[r]})}var $2={placement:"bottom",modifiers:[],strategy:"absolute"};function Z2(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return!e.some(function(u){return!(u&&typeof u.getBoundingClientRect=="function")})}function iP(n){n===void 0&&(n={});var e=n,r=e.defaultModifiers,u=r===void 0?[]:r,d=e.defaultOptions,m=d===void 0?$2:d;return function(l,E,C){C===void 0&&(C=m);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},$2,m),modifiersData:{},elements:{reference:l,popper:E},attributes:{},styles:{}},N=[],F=!1,B={state:k,setOptions:function(de){var Ee=typeof de=="function"?de(k.options):de;re(),k.options=Object.assign({},m,k.options,Ee),k.scrollParents={reference:Fp(l)?T0(l):l.contextElement?T0(l.contextElement):[],popper:T0(E)};var we=eP(nP([].concat(u,k.options.modifiers)));return k.orderedModifiers=we.filter(function(ke){return ke.enabled}),W(),B.update()},forceUpdate:function(){if(!F){var de=k.elements,Ee=de.reference,we=de.popper;if(Z2(Ee,we)){k.rects={reference:Kk(Ee,Q0(we),k.options.strategy==="fixed"),popper:$1(we)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function(Qe){return k.modifiersData[Qe.name]=Object.assign({},Qe.data)});for(var ke=0;ke<k.orderedModifiers.length;ke++){if(k.reset===!0){k.reset=!1,ke=-1;continue}var ge=k.orderedModifiers[ke],Ae=ge.fn,Ge=ge.options,at=Ge===void 0?{}:Ge,Me=ge.name;typeof Ae=="function"&&(k=Ae({state:k,options:at,name:Me,instance:B})||k)}}}},update:tP(function(){return new Promise(function(ie){B.forceUpdate(),ie(k)})}),destroy:function(){re(),F=!0}};if(!Z2(l,E))return B;B.setOptions(C).then(function(ie){!F&&C.onFirstUpdate&&C.onFirstUpdate(ie)});function W(){k.orderedModifiers.forEach(function(ie){var de=ie.name,Ee=ie.options,we=Ee===void 0?{}:Ee,ke=ie.effect;if(typeof ke=="function"){var ge=ke({state:k,name:de,instance:B,options:we}),Ae=function(){};N.push(ge||Ae)}})}function re(){N.forEach(function(ie){return ie()}),N=[]}return B}}const rP=iP({defaultModifiers:[Bk,Zk,Ek,Ak,Gk,jk,qk,xk]}),aP=["enabled","placement","strategy","modifiers"];function oP(n,e){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(e.indexOf(u)>=0)continue;r[u]=n[u]}return r}const sP={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},lP={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:n})=>()=>{const{reference:e,popper:r}=n.elements;if("removeAttribute"in e){const u=(e.getAttribute("aria-describedby")||"").split(",").filter(d=>d.trim()!==r.id);u.length?e.setAttribute("aria-describedby",u.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:n})=>{var e;const{popper:r,reference:u}=n.elements,d=(e=r.getAttribute("role"))==null?void 0:e.toLowerCase();if(r.id&&d==="tooltip"&&"setAttribute"in u){const m=u.getAttribute("aria-describedby");if(m&&m.split(",").indexOf(r.id)!==-1)return;u.setAttribute("aria-describedby",m?`${m},${r.id}`:r.id)}}},cP=[];function uP(n,e,r={}){let{enabled:u=!0,placement:d="bottom",strategy:m="absolute",modifiers:y=cP}=r,l=oP(r,aP);const E=K.useRef(y),C=K.useRef(),k=K.useCallback(()=>{var ie;(ie=C.current)==null||ie.update()},[]),N=K.useCallback(()=>{var ie;(ie=C.current)==null||ie.forceUpdate()},[]),[F,B]=nk(K.useState({placement:d,update:k,forceUpdate:N,attributes:{},styles:{popper:{},arrow:{}}})),W=K.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:ie})=>{const de={},Ee={};Object.keys(ie.elements).forEach(we=>{de[we]=ie.styles[we],Ee[we]=ie.attributes[we]}),B({state:ie,styles:de,attributes:Ee,update:k,forceUpdate:N,placement:ie.placement})}}),[k,N,B]),re=K.useMemo(()=>(x0(E.current,y)||(E.current=y),E.current),[y]);return K.useEffect(()=>{!C.current||!u||C.current.setOptions({placement:d,strategy:m,modifiers:[...re,W,sP]})},[m,d,W,u,re]),K.useEffect(()=>{if(!(!u||n==null||e==null))return C.current=rP(n,e,Object.assign({},l,{placement:d,strategy:m,modifiers:[...re,lP,W]})),()=>{C.current!=null&&(C.current.destroy(),C.current=void 0,B(ie=>Object.assign({},ie,{attributes:{},styles:{popper:{}}})))}},[u,n,e]),F}function Pv(n,e){if(n.contains)return n.contains(e);if(n.compareDocumentPosition)return n===e||!!(n.compareDocumentPosition(e)&16)}var px,Y2;function hP(){if(Y2)return px;Y2=1;var n=function(){};return px=n,px}var dP=hP();const fP=Hp(dP),H2=()=>{};function pP(n){return n.button===0}function mP(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}const Tv=n=>n&&("current"in n?n.current:n),q2={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function gP(n,e=H2,{disabled:r,clickTrigger:u="click"}={}){const d=K.useRef(!1),m=K.useRef(!1),y=K.useCallback(C=>{const k=Tv(n);fP(!!k,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),d.current=!k||mP(C)||!pP(C)||!!Pv(k,C.target)||m.current,m.current=!1},[n]),l=Gu(C=>{const k=Tv(n);k&&Pv(k,C.target)?m.current=!0:m.current=!1}),E=Gu(C=>{d.current||e(C)});K.useEffect(()=>{var C,k;if(r||n==null)return;const N=Yg(Tv(n)),F=N.defaultView||window;let B=(C=F.event)!=null?C:(k=F.parent)==null?void 0:k.event,W=null;q2[u]&&(W=od(N,q2[u],l,!0));const re=od(N,u,y,!0),ie=od(N,u,Ee=>{if(Ee===B){B=void 0;return}E(Ee)});let de=[];return"ontouchstart"in N.documentElement&&(de=[].slice.call(N.body.children).map(Ee=>od(Ee,"mousemove",H2))),()=>{W?.(),re(),ie(),de.forEach(Ee=>Ee())}},[n,r,u,y,l,E])}function yP(n){const e={};return Array.isArray(n)?(n?.forEach(r=>{e[r.name]=r}),e):n||e}function _P(n={}){return Array.isArray(n)?n:Object.keys(n).map(e=>(n[e].name=e,n[e]))}function vP({enabled:n,enableEvents:e,placement:r,flip:u,offset:d,fixed:m,containerPadding:y,arrowElement:l,popperConfig:E={}}){var C,k,N,F;const B=yP(E.modifiers);return Object.assign({},E,{placement:r,enabled:n,strategy:m?"fixed":E.strategy,modifiers:_P(Object.assign({},B,{eventListeners:{enabled:e,options:(C=B.eventListeners)==null?void 0:C.options},preventOverflow:Object.assign({},B.preventOverflow,{options:Object.assign({padding:y},(k=B.preventOverflow)==null?void 0:k.options)}),offset:{options:Object.assign({offset:d},(N=B.offset)==null?void 0:N.options)},arrow:Object.assign({},B.arrow,{enabled:!!l,options:Object.assign({},(F=B.arrow)==null?void 0:F.options,{element:l})}),flip:Object.assign({enabled:!!u},B.flip)}))})}const bP=K.createContext(null),xP="data-rr-ui-";function wP(n){return`${xP}${n}`}const VE=K.createContext(qg?window:void 0);VE.Provider;function X1(){return K.useContext(VE)}const TP=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",SP=typeof document<"u",GE=SP||TP?K.useLayoutEffect:K.useEffect,K0=K.createContext(null);K0.displayName="NavbarContext";const EP={type:dd.string,tooltip:dd.bool,as:dd.elementType},fb=K.forwardRef(({as:n="div",className:e,type:r="valid",tooltip:u=!1,...d},m)=>H.jsx(n,{...d,ref:m,className:mn(e,`${r}-${u?"tooltip":"feedback"}`)}));fb.displayName="Feedback";fb.propTypes=EP;const bd=K.createContext({}),W1=K.forwardRef(({id:n,bsPrefix:e,className:r,type:u="checkbox",isValid:d=!1,isInvalid:m=!1,as:y="input",...l},E)=>{const{controlId:C}=K.useContext(bd);return e=Rn(e,"form-check-input"),H.jsx(y,{...l,ref:E,type:u,id:n||C,className:mn(r,e,d&&"is-valid",m&&"is-invalid")})});W1.displayName="FormCheckInput";const Ov=K.forwardRef(({bsPrefix:n,className:e,htmlFor:r,...u},d)=>{const{controlId:m}=K.useContext(bd);return n=Rn(n,"form-check-label"),H.jsx("label",{...u,ref:d,htmlFor:r||m,className:mn(e,n)})});Ov.displayName="FormCheckLabel";const $E=K.forwardRef(({id:n,bsPrefix:e,bsSwitchPrefix:r,inline:u=!1,reverse:d=!1,disabled:m=!1,isValid:y=!1,isInvalid:l=!1,feedbackTooltip:E=!1,feedback:C,feedbackType:k,className:N,style:F,title:B="",type:W="checkbox",label:re,children:ie,as:de="input",...Ee},we)=>{e=Rn(e,"form-check"),r=Rn(r,"form-switch");const{controlId:ke}=K.useContext(bd),ge=K.useMemo(()=>({controlId:n||ke}),[ke,n]),Ae=!ie&&re!=null&&re!==!1||JR(ie,Ov),Ge=H.jsx(W1,{...Ee,type:W==="switch"?"checkbox":W,ref:we,isValid:y,isInvalid:l,disabled:m,as:de});return H.jsx(bd.Provider,{value:ge,children:H.jsx("div",{style:F,className:mn(N,Ae&&e,u&&`${e}-inline`,d&&`${e}-reverse`,W==="switch"&&r),children:ie||H.jsxs(H.Fragment,{children:[Ge,Ae&&H.jsx(Ov,{title:B,children:re}),C&&H.jsx(fb,{type:k,tooltip:E,children:C})]})})})});$E.displayName="FormCheck";const Lv=Object.assign($E,{Input:W1,Label:Ov}),ZE=K.forwardRef(({bsPrefix:n,type:e,size:r,htmlSize:u,id:d,className:m,isValid:y=!1,isInvalid:l=!1,plaintext:E,readOnly:C,as:k="input",...N},F)=>{const{controlId:B}=K.useContext(bd);return n=Rn(n,"form-control"),H.jsx(k,{...N,type:e,size:u,ref:F,readOnly:C,id:d||B,className:mn(m,E?`${n}-plaintext`:n,r&&`${n}-${r}`,e==="color"&&`${n}-color`,y&&"is-valid",l&&"is-invalid")})});ZE.displayName="FormControl";const MP=Object.assign(ZE,{Feedback:fb}),YE=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...u},d)=>(e=Rn(e,"form-floating"),H.jsx(r,{ref:d,className:mn(n,e),...u})));YE.displayName="FormFloating";const Q1=K.forwardRef(({controlId:n,as:e="div",...r},u)=>{const d=K.useMemo(()=>({controlId:n}),[n]);return H.jsx(bd.Provider,{value:d,children:H.jsx(e,{...r,ref:u})})});Q1.displayName="FormGroup";const HE=K.forwardRef(({as:n="label",bsPrefix:e,column:r=!1,visuallyHidden:u=!1,className:d,htmlFor:m,...y},l)=>{const{controlId:E}=K.useContext(bd);e=Rn(e,"form-label");let C="col-form-label";typeof r=="string"&&(C=`${C} ${C}-${r}`);const k=mn(d,e,u&&"visually-hidden",r&&C);return m=m||E,r?H.jsx(kE,{ref:l,as:"label",className:k,htmlFor:m,...y}):H.jsx(n,{ref:l,className:k,htmlFor:m,...y})});HE.displayName="FormLabel";const qE=K.forwardRef(({bsPrefix:n,className:e,id:r,...u},d)=>{const{controlId:m}=K.useContext(bd);return n=Rn(n,"form-range"),H.jsx("input",{...u,type:"range",ref:d,className:mn(e,n),id:r||m})});qE.displayName="FormRange";const XE=K.forwardRef(({bsPrefix:n,size:e,htmlSize:r,className:u,isValid:d=!1,isInvalid:m=!1,id:y,...l},E)=>{const{controlId:C}=K.useContext(bd);return n=Rn(n,"form-select"),H.jsx("select",{...l,size:r,ref:E,className:mn(u,n,e&&`${n}-${e}`,d&&"is-valid",m&&"is-invalid"),id:y||C})});XE.displayName="FormSelect";const WE=K.forwardRef(({bsPrefix:n,className:e,as:r="small",muted:u,...d},m)=>(n=Rn(n,"form-text"),H.jsx(r,{...d,ref:m,className:mn(e,n,u&&"text-muted")})));WE.displayName="FormText";const QE=K.forwardRef((n,e)=>H.jsx(Lv,{...n,ref:e,type:"switch"}));QE.displayName="Switch";const AP=Object.assign(QE,{Input:Lv.Input,Label:Lv.Label}),KE=K.forwardRef(({bsPrefix:n,className:e,children:r,controlId:u,label:d,...m},y)=>(n=Rn(n,"form-floating"),H.jsxs(Q1,{ref:y,className:mn(e,n),controlId:u,...m,children:[r,H.jsx("label",{htmlFor:u,children:d})]})));KE.displayName="FloatingLabel";const CP={_ref:dd.any,validated:dd.bool,as:dd.elementType},K1=K.forwardRef(({className:n,validated:e,as:r="form",...u},d)=>H.jsx(r,{...u,ref:d,className:mn(n,e&&"was-validated")}));K1.displayName="Form";K1.propTypes=CP;const Ri=Object.assign(K1,{Group:Q1,Control:MP,Floating:YE,Check:Lv,Switch:AP,Label:HE,Text:WE,Range:qE,Select:XE,FloatingLabel:KE}),X2=n=>!n||typeof n=="function"?n:e=>{n.current=e};function DP(n,e){const r=X2(n),u=X2(e);return d=>{r&&r(d),u&&u(d)}}function pb(n,e){return K.useMemo(()=>DP(n,e),[n,e])}var uv;function W2(n){if((!uv&&uv!==0||n)&&qg){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),uv=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return uv}function IP(){return K.useState(null)}function mx(n){n===void 0&&(n=Yg());try{var e=n.activeElement;return!e||!e.nodeName?null:e}catch{return n.body}}function RP(n){const e=K.useRef(n);return e.current=n,e}function kP(n){const e=RP(n);K.useEffect(()=>()=>e.current(),[])}function PP(n=document){const e=n.defaultView;return Math.abs(e.innerWidth-n.documentElement.clientWidth)}const Q2=wP("modal-open");class J1{constructor({ownerDocument:e,handleContainerOverflow:r=!0,isRTL:u=!1}={}){this.handleContainerOverflow=r,this.isRTL=u,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return PP(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const r={overflow:"hidden"},u=this.isRTL?"paddingLeft":"paddingRight",d=this.getElement();e.style={overflow:d.style.overflow,[u]:d.style[u]},e.scrollBarWidth&&(r[u]=`${parseInt(hd(d,u)||"0",10)+e.scrollBarWidth}px`),d.setAttribute(Q2,""),hd(d,r)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const r=this.getElement();r.removeAttribute(Q2),Object.assign(r.style,e.style)}add(e){let r=this.modals.indexOf(e);return r!==-1||(r=this.modals.length,this.modals.push(e),this.setModalAttributes(e),r!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),r}remove(e){const r=this.modals.indexOf(e);r!==-1&&(this.modals.splice(r,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const gx=(n,e)=>qg?n==null?(e||Yg()).body:(typeof n=="function"&&(n=n()),n&&"current"in n&&(n=n.current),n&&("nodeType"in n||n.getBoundingClientRect)?n:null):null;function Hx(n,e){const r=X1(),[u,d]=K.useState(()=>gx(n,r?.document));if(!u){const m=gx(n);m&&d(m)}return K.useEffect(()=>{},[e,u]),K.useEffect(()=>{const m=gx(n);m!==u&&d(m)},[n,u]),u}function OP({children:n,in:e,onExited:r,mountOnEnter:u,unmountOnExit:d}){const m=K.useRef(null),y=K.useRef(e),l=Gu(r);K.useEffect(()=>{e?y.current=!0:l(m.current)},[e,l]);const E=pb(m,Hg(n)),C=K.cloneElement(n,{ref:E});return e?C:d||!y.current&&u?null:C}const LP=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function NP(n,e){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(e.indexOf(u)>=0)continue;r[u]=n[u]}return r}function zP(n){let{onEnter:e,onEntering:r,onEntered:u,onExit:d,onExiting:m,onExited:y,addEndListener:l,children:E}=n,C=NP(n,LP);const k=K.useRef(null),N=pb(k,Hg(E)),F=ke=>ge=>{ke&&k.current&&ke(k.current,ge)},B=K.useCallback(F(e),[e]),W=K.useCallback(F(r),[r]),re=K.useCallback(F(u),[u]),ie=K.useCallback(F(d),[d]),de=K.useCallback(F(m),[m]),Ee=K.useCallback(F(y),[y]),we=K.useCallback(F(l),[l]);return Object.assign({},C,{nodeRef:k},e&&{onEnter:B},r&&{onEntering:W},u&&{onEntered:re},d&&{onExit:ie},m&&{onExiting:de},y&&{onExited:Ee},l&&{addEndListener:we},{children:typeof E=="function"?(ke,ge)=>E(ke,Object.assign({},ge,{ref:N})):K.cloneElement(E,{ref:N})})}const jP=["component"];function FP(n,e){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(e.indexOf(u)>=0)continue;r[u]=n[u]}return r}const BP=K.forwardRef((n,e)=>{let{component:r}=n,u=FP(n,jP);const d=zP(u);return H.jsx(r,Object.assign({ref:e},d))});function UP({in:n,onTransition:e}){const r=K.useRef(null),u=K.useRef(!0),d=Gu(e);return O2(()=>{if(!r.current)return;let m=!1;return d({in:n,element:r.current,initial:u.current,isStale:()=>m}),()=>{m=!0}},[n,d]),O2(()=>(u.current=!1,()=>{u.current=!0}),[]),r}function VP({children:n,in:e,onExited:r,onEntered:u,transition:d}){const[m,y]=K.useState(!e);e&&m&&y(!1);const l=UP({in:!!e,onTransition:C=>{const k=()=>{C.isStale()||(C.in?u?.(C.element,C.initial):(y(!0),r?.(C.element)))};Promise.resolve(d(C)).then(k,N=>{throw C.in||y(!0),N})}}),E=pb(l,Hg(n));return m&&!e?null:K.cloneElement(n,{ref:E})}function qx(n,e,r){return n?H.jsx(BP,Object.assign({},r,{component:n})):e?H.jsx(VP,Object.assign({},r,{transition:e})):H.jsx(OP,Object.assign({},r))}const GP=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function $P(n,e){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(e.indexOf(u)>=0)continue;r[u]=n[u]}return r}let yx;function ZP(n){return yx||(yx=new J1({ownerDocument:n?.document})),yx}function YP(n){const e=X1(),r=n||ZP(e),u=K.useRef({dialog:null,backdrop:null});return Object.assign(u.current,{add:()=>r.add(u.current),remove:()=>r.remove(u.current),isTopModal:()=>r.isTopModal(u.current),setDialogRef:K.useCallback(d=>{u.current.dialog=d},[]),setBackdropRef:K.useCallback(d=>{u.current.backdrop=d},[])})}const JE=K.forwardRef((n,e)=>{let{show:r=!1,role:u="dialog",className:d,style:m,children:y,backdrop:l=!0,keyboard:E=!0,onBackdropClick:C,onEscapeKeyDown:k,transition:N,runTransition:F,backdropTransition:B,runBackdropTransition:W,autoFocus:re=!0,enforceFocus:ie=!0,restoreFocus:de=!0,restoreFocusOptions:Ee,renderDialog:we,renderBackdrop:ke=Dn=>H.jsx("div",Object.assign({},Dn)),manager:ge,container:Ae,onShow:Ge,onHide:at=()=>{},onExit:Me,onExited:Qe,onExiting:St,onEnter:bt,onEntering:zt,onEntered:Zt}=n,Ft=$P(n,GP);const Be=X1(),lt=Hx(Ae),_t=YP(ge),ut=IE(),Te=VR(r),[nt,yt]=K.useState(!r),pt=K.useRef(null);K.useImperativeHandle(e,()=>_t,[_t]),qg&&!Te&&r&&(pt.current=mx(Be?.document)),r&&nt&&yt(!1);const Et=Gu(()=>{if(_t.add(),br.current=od(document,"keydown",Wt),Xn.current=od(document,"focus",()=>setTimeout(Ot),!0),Ge&&Ge(),re){var Dn,Pr;const ki=mx((Dn=(Pr=_t.dialog)==null?void 0:Pr.ownerDocument)!=null?Dn:Be?.document);_t.dialog&&ki&&!Pv(_t.dialog,ki)&&(pt.current=ki,_t.dialog.focus())}}),Ut=Gu(()=>{if(_t.remove(),br.current==null||br.current(),Xn.current==null||Xn.current(),de){var Dn;(Dn=pt.current)==null||Dn.focus==null||Dn.focus(Ee),pt.current=null}});K.useEffect(()=>{!r||!lt||Et()},[r,lt,Et]),K.useEffect(()=>{nt&&Ut()},[nt,Ut]),kP(()=>{Ut()});const Ot=Gu(()=>{if(!ie||!ut()||!_t.isTopModal())return;const Dn=mx(Be?.document);_t.dialog&&Dn&&!Pv(_t.dialog,Dn)&&_t.dialog.focus()}),Ln=Gu(Dn=>{Dn.target===Dn.currentTarget&&(C?.(Dn),l===!0&&at())}),Wt=Gu(Dn=>{E&&bE(Dn)&&_t.isTopModal()&&(k?.(Dn),Dn.defaultPrevented||at())}),Xn=K.useRef(),br=K.useRef(),ir=(...Dn)=>{yt(!0),Qe?.(...Dn)};if(!lt)return null;const yi=Object.assign({role:u,ref:_t.setDialogRef,"aria-modal":u==="dialog"?!0:void 0},Ft,{style:m,className:d,tabIndex:-1});let Un=we?we(yi):H.jsx("div",Object.assign({},yi,{children:K.cloneElement(y,{role:"document"})}));Un=qx(N,F,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!r,onExit:Me,onExiting:St,onExited:ir,onEnter:bt,onEntering:zt,onEntered:Zt,children:Un});let Vn=null;return l&&(Vn=ke({ref:_t.setBackdropRef,onClick:Ln}),Vn=qx(B,W,{in:!!r,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Vn})),H.jsx(H.Fragment,{children:Ip.createPortal(H.jsxs(H.Fragment,{children:[Vn,Un]}),lt)})});JE.displayName="Modal";const eM=Object.assign(JE,{Manager:J1});function Xx(n,e){return n.classList?!!e&&n.classList.contains(e):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+e+" ")!==-1}function HP(n,e){n.classList?n.classList.add(e):Xx(n,e)||(typeof n.className=="string"?n.className=n.className+" "+e:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+e))}function K2(n,e){return n.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function qP(n,e){n.classList?n.classList.remove(e):typeof n.className=="string"?n.className=K2(n.className,e):n.setAttribute("class",K2(n.className&&n.className.baseVal||"",e))}const dg={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class tM extends J1{adjustAndStore(e,r,u){const d=r.style[e];r.dataset[e]=d,hd(r,{[e]:`${parseFloat(hd(r,e))+u}px`})}restore(e,r){const u=r.dataset[e];u!==void 0&&(delete r.dataset[e],hd(r,{[e]:u}))}setContainerStyle(e){super.setContainerStyle(e);const r=this.getElement();if(HP(r,"modal-open"),!e.scrollBarWidth)return;const u=this.isRTL?"paddingLeft":"paddingRight",d=this.isRTL?"marginLeft":"marginRight";hg(r,dg.FIXED_CONTENT).forEach(m=>this.adjustAndStore(u,m,e.scrollBarWidth)),hg(r,dg.STICKY_CONTENT).forEach(m=>this.adjustAndStore(d,m,-e.scrollBarWidth)),hg(r,dg.NAVBAR_TOGGLER).forEach(m=>this.adjustAndStore(d,m,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const r=this.getElement();qP(r,"modal-open");const u=this.isRTL?"paddingLeft":"paddingRight",d=this.isRTL?"marginLeft":"marginRight";hg(r,dg.FIXED_CONTENT).forEach(m=>this.restore(u,m)),hg(r,dg.STICKY_CONTENT).forEach(m=>this.restore(d,m)),hg(r,dg.NAVBAR_TOGGLER).forEach(m=>this.restore(d,m))}}let _x;function nM(n){return _x||(_x=new tM(n)),_x}const iM=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...u},d)=>(e=Rn(e,"modal-body"),H.jsx(r,{ref:d,className:mn(n,e),...u})));iM.displayName="ModalBody";const ew=K.createContext({onHide(){}}),tw=K.forwardRef(({bsPrefix:n,className:e,contentClassName:r,centered:u,size:d,fullscreen:m,children:y,scrollable:l,...E},C)=>{n=Rn(n,"modal");const k=`${n}-dialog`,N=typeof m=="string"?`${n}-fullscreen-${m}`:`${n}-fullscreen`;return H.jsx("div",{...E,ref:C,className:mn(k,e,d&&`${n}-${d}`,u&&`${k}-centered`,l&&`${k}-scrollable`,m&&N),children:H.jsx("div",{className:mn(`${n}-content`,r),children:y})})});tw.displayName="ModalDialog";const rM=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...u},d)=>(e=Rn(e,"modal-footer"),H.jsx(r,{ref:d,className:mn(n,e),...u})));rM.displayName="ModalFooter";const nw=K.forwardRef(({closeLabel:n="Close",closeVariant:e,closeButton:r=!1,onHide:u,children:d,...m},y)=>{const l=K.useContext(ew),E=jp(()=>{l?.onHide(),u?.()});return H.jsxs("div",{ref:y,...m,children:[d,r&&H.jsx(B1,{"aria-label":n,variant:e,onClick:E})]})});nw.displayName="AbstractModalHeader";const aM=K.forwardRef(({bsPrefix:n,className:e,closeLabel:r="Close",closeButton:u=!1,...d},m)=>(n=Rn(n,"modal-header"),H.jsx(nw,{ref:m,...d,className:mn(e,n),closeLabel:r,closeButton:u})));aM.displayName="ModalHeader";const XP=DE("h4"),oM=K.forwardRef(({className:n,bsPrefix:e,as:r=XP,...u},d)=>(e=Rn(e,"modal-title"),H.jsx(r,{ref:d,className:mn(n,e),...u})));oM.displayName="ModalTitle";function WP(n){return H.jsx(Cg,{...n,timeout:null})}function QP(n){return H.jsx(Cg,{...n,timeout:null})}const sM=K.forwardRef(({bsPrefix:n,className:e,style:r,dialogClassName:u,contentClassName:d,children:m,dialogAs:y=tw,"data-bs-theme":l,"aria-labelledby":E,"aria-describedby":C,"aria-label":k,show:N=!1,animation:F=!0,backdrop:B=!0,keyboard:W=!0,onEscapeKeyDown:re,onShow:ie,onHide:de,container:Ee,autoFocus:we=!0,enforceFocus:ke=!0,restoreFocus:ge=!0,restoreFocusOptions:Ae,onEntered:Ge,onExit:at,onExiting:Me,onEnter:Qe,onEntering:St,onExited:bt,backdropClassName:zt,manager:Zt,...Ft},Be)=>{const[lt,_t]=K.useState({}),[ut,Te]=K.useState(!1),nt=K.useRef(!1),yt=K.useRef(!1),pt=K.useRef(null),[Et,Ut]=IP(),Ot=N1(Be,Ut),Ln=jp(de),Wt=O1();n=Rn(n,"modal");const Xn=K.useMemo(()=>({onHide:Ln}),[Ln]);function br(){return Zt||nM({isRTL:Wt})}function ir(gn){if(!qg)return;const ii=br().getScrollbarWidth()>0,xr=gn.scrollHeight>Yg(gn).documentElement.clientHeight;_t({paddingRight:ii&&!xr?W2():void 0,paddingLeft:!ii&&xr?W2():void 0})}const yi=jp(()=>{Et&&ir(Et.dialog)});KR(()=>{Gx(window,"resize",yi),pt.current==null||pt.current()});const Un=()=>{nt.current=!0},Vn=gn=>{nt.current&&Et&&gn.target===Et.dialog&&(yt.current=!0),nt.current=!1},Dn=()=>{Te(!0),pt.current=wE(Et.dialog,()=>{Te(!1)})},Pr=gn=>{gn.target===gn.currentTarget&&Dn()},ki=gn=>{if(B==="static"){Pr(gn);return}if(yt.current||gn.target!==gn.currentTarget){yt.current=!1;return}de?.()},Aa=gn=>{W?re?.(gn):(gn.preventDefault(),B==="static"&&Dn())},_a=(gn,ii)=>{gn&&ir(gn),Qe?.(gn,ii)},Gr=gn=>{pt.current==null||pt.current(),at?.(gn)},Or=(gn,ii)=>{St?.(gn,ii),xE(window,"resize",yi)},Va=gn=>{gn&&(gn.style.display=""),bt?.(gn),Gx(window,"resize",yi)},Ca=K.useCallback(gn=>H.jsx("div",{...gn,className:mn(`${n}-backdrop`,zt,!F&&"show")}),[F,zt,n]),Da={...r,...lt};Da.display="block";const Ga=gn=>H.jsx("div",{role:"dialog",...gn,style:Da,className:mn(e,n,ut&&`${n}-static`,!F&&"show"),onClick:B?ki:void 0,onMouseUp:Vn,"data-bs-theme":l,"aria-label":k,"aria-labelledby":E,"aria-describedby":C,children:H.jsx(y,{...Ft,onMouseDown:Un,className:u,contentClassName:d,children:m})});return H.jsx(ew.Provider,{value:Xn,children:H.jsx(eM,{show:N,ref:Ot,backdrop:B,container:Ee,keyboard:!0,autoFocus:we,enforceFocus:ke,restoreFocus:ge,restoreFocusOptions:Ae,onEscapeKeyDown:Aa,onShow:ie,onHide:de,onEnter:_a,onEntering:Or,onEntered:Ge,onExit:Gr,onExiting:Me,onExited:Va,manager:br(),transition:F?WP:void 0,backdropTransition:F?QP:void 0,renderBackdrop:Ca,renderDialog:Ga})})});sM.displayName="Modal";const hv=Object.assign(sM,{Body:iM,Header:aM,Title:oM,Footer:rM,Dialog:tw,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),lM=K.forwardRef(({bsPrefix:n,className:e,as:r,...u},d)=>{n=Rn(n,"navbar-brand");const m=r||(u.href?"a":"span");return H.jsx(m,{...u,ref:d,className:mn(e,n)})});lM.displayName="NavbarBrand";const cM=K.forwardRef(({children:n,bsPrefix:e,...r},u)=>{e=Rn(e,"navbar-collapse");const d=K.useContext(K0);return H.jsx(z1,{in:!!(d&&d.expanded),...r,children:H.jsx("div",{ref:u,className:e,children:n})})});cM.displayName="NavbarCollapse";const uM=K.forwardRef(({bsPrefix:n,className:e,children:r,label:u="Toggle navigation",as:d="button",onClick:m,...y},l)=>{n=Rn(n,"navbar-toggler");const{onToggle:E,expanded:C}=K.useContext(K0)||{},k=jp(N=>{m&&m(N),E&&E()});return d==="button"&&(y.type="button"),H.jsx(d,{...y,ref:l,onClick:k,"aria-label":u,className:mn(e,n,!C&&"collapsed"),children:r||H.jsx("span",{className:`${n}-icon`})})});uM.displayName="NavbarToggle";const Wx=new WeakMap,J2=(n,e)=>{if(!n||!e)return;const r=Wx.get(e)||new Map;Wx.set(e,r);let u=r.get(n);return u||(u=e.matchMedia(n),u.refCount=0,r.set(u.media,u)),u};function KP(n,e=typeof window>"u"?void 0:window){const r=J2(n,e),[u,d]=K.useState(()=>r?r.matches:!1);return GE(()=>{let m=J2(n,e);if(!m)return d(!1);let y=Wx.get(e);const l=()=>{d(m.matches)};return m.refCount++,m.addListener(l),l(),()=>{m.removeListener(l),m.refCount--,m.refCount<=0&&y?.delete(m.media),m=void 0}},[n]),u}function JP(n){const e=Object.keys(n);function r(l,E){return l===E?E:l?`${l} and ${E}`:E}function u(l){return e[Math.min(e.indexOf(l)+1,e.length-1)]}function d(l){const E=u(l);let C=n[E];return typeof C=="number"?C=`${C-.2}px`:C=`calc(${C} - 0.2px)`,`(max-width: ${C})`}function m(l){let E=n[l];return typeof E=="number"&&(E=`${E}px`),`(min-width: ${E})`}function y(l,E,C){let k;typeof l=="object"?(k=l,C=E,E=!0):(E=E||!0,k={[l]:E});let N=K.useMemo(()=>Object.entries(k).reduce((F,[B,W])=>((W==="up"||W===!0)&&(F=r(F,m(B))),(W==="down"||W===!0)&&(F=r(F,d(B))),F),""),[JSON.stringify(k)]);return KP(N,C)}return y}const e3=JP({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),hM=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...u},d)=>(e=Rn(e,"offcanvas-body"),H.jsx(r,{ref:d,className:mn(n,e),...u})));hM.displayName="OffcanvasBody";const t3={[Gc]:"show",[nd]:"show"},dM=K.forwardRef(({bsPrefix:n,className:e,children:r,in:u=!1,mountOnEnter:d=!1,unmountOnExit:m=!1,appear:y=!1,...l},E)=>(n=Rn(n,"offcanvas"),H.jsx(ub,{ref:E,addEndListener:L1,in:u,mountOnEnter:d,unmountOnExit:m,appear:y,...l,childRef:Hg(r),children:(C,k)=>K.cloneElement(r,{...k,className:mn(e,r.props.className,(C===Gc||C===R0)&&`${n}-toggling`,t3[C])})})));dM.displayName="OffcanvasToggling";const fM=K.forwardRef(({bsPrefix:n,className:e,closeLabel:r="Close",closeButton:u=!1,...d},m)=>(n=Rn(n,"offcanvas-header"),H.jsx(nw,{ref:m,...d,className:mn(e,n),closeLabel:r,closeButton:u})));fM.displayName="OffcanvasHeader";const n3=DE("h5"),pM=K.forwardRef(({className:n,bsPrefix:e,as:r=n3,...u},d)=>(e=Rn(e,"offcanvas-title"),H.jsx(r,{ref:d,className:mn(n,e),...u})));pM.displayName="OffcanvasTitle";function i3(n){return H.jsx(dM,{...n})}function r3(n){return H.jsx(Cg,{...n})}const mM=K.forwardRef(({bsPrefix:n,className:e,children:r,"aria-labelledby":u,placement:d="start",responsive:m,show:y=!1,backdrop:l=!0,keyboard:E=!0,scroll:C=!1,onEscapeKeyDown:k,onShow:N,onHide:F,container:B,autoFocus:W=!0,enforceFocus:re=!0,restoreFocus:ie=!0,restoreFocusOptions:de,onEntered:Ee,onExit:we,onExiting:ke,onEnter:ge,onEntering:Ae,onExited:Ge,backdropClassName:at,manager:Me,renderStaticNode:Qe=!1,...St},bt)=>{const zt=K.useRef();n=Rn(n,"offcanvas");const[Zt,Ft]=K.useState(!1),Be=jp(F),lt=e3(m||"xs","up");K.useEffect(()=>{Ft(m?y&&!lt:y)},[y,m,lt]);const _t=K.useMemo(()=>({onHide:Be}),[Be]);function ut(){return Me||(C?(zt.current||(zt.current=new tM({handleContainerOverflow:!1})),zt.current):nM())}const Te=(Et,...Ut)=>{Et&&(Et.style.visibility="visible"),ge?.(Et,...Ut)},nt=(Et,...Ut)=>{Et&&(Et.style.visibility=""),Ge?.(...Ut)},yt=K.useCallback(Et=>H.jsx("div",{...Et,className:mn(`${n}-backdrop`,at)}),[at,n]),pt=Et=>H.jsx("div",{...Et,...St,className:mn(e,m?`${n}-${m}`:n,`${n}-${d}`),"aria-labelledby":u,children:r});return H.jsxs(H.Fragment,{children:[!Zt&&(m||Qe)&&pt({}),H.jsx(ew.Provider,{value:_t,children:H.jsx(eM,{show:Zt,ref:bt,backdrop:l,container:B,keyboard:E,autoFocus:W,enforceFocus:re&&!C,restoreFocus:ie,restoreFocusOptions:de,onEscapeKeyDown:k,onShow:N,onHide:Be,onEnter:Te,onEntering:Ae,onEntered:Ee,onExit:we,onExiting:ke,onExited:nt,manager:ut(),transition:i3,backdropTransition:r3,renderBackdrop:yt,renderDialog:pt})})]})});mM.displayName="Offcanvas";const a3=Object.assign(mM,{Body:hM,Header:fM,Title:pM}),gM=K.forwardRef(({onHide:n,...e},r)=>{const u=K.useContext(K0),d=jp(()=>{u==null||u.onToggle==null||u.onToggle(),n?.()});return H.jsx(a3,{ref:r,show:!!(u!=null&&u.expanded),...e,renderStaticNode:!0,onHide:d})});gM.displayName="NavbarOffcanvas";const yM=K.forwardRef(({className:n,bsPrefix:e,as:r="span",...u},d)=>(e=Rn(e,"navbar-text"),H.jsx(r,{ref:d,className:mn(n,e),...u})));yM.displayName="NavbarText";const _M=K.forwardRef((n,e)=>{const{bsPrefix:r,expand:u=!0,variant:d="light",bg:m,fixed:y,sticky:l,className:E,as:C="nav",expanded:k,onToggle:N,onSelect:F,collapseOnSelect:B=!1,...W}=_E(n,{expanded:"onToggle"}),re=Rn(r,"navbar"),ie=K.useCallback((...we)=>{F?.(...we),B&&k&&N?.(!1)},[F,B,k,N]);W.role===void 0&&C!=="nav"&&(W.role="navigation");let de=`${re}-expand`;typeof u=="string"&&(de=`${de}-${u}`);const Ee=K.useMemo(()=>({onToggle:()=>N?.(!k),bsPrefix:re,expanded:!!k,expand:u}),[re,k,u,N]);return H.jsx(K0.Provider,{value:Ee,children:H.jsx(bP.Provider,{value:ie,children:H.jsx(C,{ref:e,...W,className:mn(E,re,u&&de,d&&`${re}-${d}`,m&&`bg-${m}`,l&&`sticky-${l}`,y&&`fixed-${y}`)})})})});_M.displayName="Navbar";const o3=Object.assign(_M,{Brand:lM,Collapse:cM,Offcanvas:gM,Text:yM,Toggle:uM}),s3=()=>{};function l3(n,e,{disabled:r,clickTrigger:u}={}){const d=e||s3;gP(n,d,{disabled:r,clickTrigger:u});const m=Gu(y=>{bE(y)&&d(y)});K.useEffect(()=>{if(r||n==null)return;const y=Yg(Tv(n));let l=(y.defaultView||window).event;const E=od(y,"keyup",C=>{if(C===l){l=void 0;return}m(C)});return()=>{E()}},[n,r,m])}const vM=K.forwardRef((n,e)=>{const{flip:r,offset:u,placement:d,containerPadding:m,popperConfig:y={},transition:l,runTransition:E}=n,[C,k]=P2(),[N,F]=P2(),B=pb(k,e),W=Hx(n.container),re=Hx(n.target),[ie,de]=K.useState(!n.show),Ee=uP(re,C,vP({placement:d,enableEvents:!!n.show,containerPadding:m||5,flip:r,offset:u,arrowElement:N,popperConfig:y}));n.show&&ie&&de(!1);const we=(...St)=>{de(!0),n.onExited&&n.onExited(...St)},ke=n.show||!ie;if(l3(C,n.onHide,{disabled:!n.rootClose||n.rootCloseDisabled,clickTrigger:n.rootCloseEvent}),!ke)return null;const{onExit:ge,onExiting:Ae,onEnter:Ge,onEntering:at,onEntered:Me}=n;let Qe=n.children(Object.assign({},Ee.attributes.popper,{style:Ee.styles.popper,ref:B}),{popper:Ee,placement:d,show:!!n.show,arrowProps:Object.assign({},Ee.attributes.arrow,{style:Ee.styles.arrow,ref:F})});return Qe=qx(l,E,{in:!!n.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Qe,onExit:ge,onExiting:Ae,onExited:we,onEnter:Ge,onEntering:at,onEntered:Me}),W?Ip.createPortal(Qe,W):null});vM.displayName="Overlay";const bM=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...u},d)=>(e=Rn(e,"popover-header"),H.jsx(r,{ref:d,className:mn(n,e),...u})));bM.displayName="PopoverHeader";const iw=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...u},d)=>(e=Rn(e,"popover-body"),H.jsx(r,{ref:d,className:mn(n,e),...u})));iw.displayName="PopoverBody";function xM(n,e){let r=n;return n==="left"?r=e?"end":"start":n==="right"&&(r=e?"start":"end"),r}function wM(n="absolute"){return{position:n,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const TM=K.forwardRef(({bsPrefix:n,placement:e="right",className:r,style:u,children:d,body:m,arrowProps:y,hasDoneInitialMeasure:l,popper:E,show:C,...k},N)=>{const F=Rn(n,"popover"),B=O1(),[W]=e?.split("-")||[],re=xM(W,B);let ie=u;return C&&!l&&(ie={...u,...wM(E?.strategy)}),H.jsxs("div",{ref:N,role:"tooltip",style:ie,"x-placement":W,className:mn(r,F,W&&`bs-popover-${re}`),...k,children:[H.jsx("div",{className:"popover-arrow",...y}),m?H.jsx(iw,{children:d}):d]})});TM.displayName="Popover";const c3=Object.assign(TM,{Header:bM,Body:iw,POPPER_OFFSET:[0,8]}),SM=K.forwardRef(({bsPrefix:n,placement:e="right",className:r,style:u,children:d,arrowProps:m,hasDoneInitialMeasure:y,popper:l,show:E,...C},k)=>{n=Rn(n,"tooltip");const N=O1(),[F]=e?.split("-")||[],B=xM(F,N);let W=u;return E&&!y&&(W={...u,...wM(l?.strategy)}),H.jsxs("div",{ref:k,style:W,role:"tooltip","x-placement":F,className:mn(r,n,`bs-tooltip-${B}`),...C,children:[H.jsx("div",{className:"tooltip-arrow",...m}),H.jsx("div",{className:`${n}-inner`,children:d})]})});SM.displayName="Tooltip";const u3=Object.assign(SM,{TOOLTIP_OFFSET:[0,6]});function h3(n){const e=K.useRef(null),r=Rn(void 0,"popover"),u=Rn(void 0,"tooltip"),d=K.useMemo(()=>({name:"offset",options:{offset:()=>{if(n)return n;if(e.current){if(Xx(e.current,r))return c3.POPPER_OFFSET;if(Xx(e.current,u))return u3.TOOLTIP_OFFSET}return[0,0]}}}),[n,r,u]);return[e,[d]]}function d3(n,e){const{ref:r}=n,{ref:u}=e;n.ref=r.__wrapped||(r.__wrapped=d=>r($x(d))),e.ref=u.__wrapped||(u.__wrapped=d=>u($x(d)))}const EM=K.forwardRef(({children:n,transition:e=Cg,popperConfig:r={},rootClose:u=!1,placement:d="top",show:m=!1,...y},l)=>{const E=K.useRef({}),[C,k]=K.useState(null),[N,F]=h3(y.offset),B=N1(l,N),W=e===!0?Cg:e||void 0,re=jp(ie=>{k(ie),r==null||r.onFirstUpdate==null||r.onFirstUpdate(ie)});return GE(()=>{C&&y.target&&(E.current.scheduleUpdate==null||E.current.scheduleUpdate())},[C,y.target]),K.useEffect(()=>{m||k(null)},[m]),H.jsx(vM,{...y,ref:B,popperConfig:{...r,modifiers:F.concat(r.modifiers||[]),onFirstUpdate:re},transition:W,rootClose:u,placement:d,show:m,children:(ie,{arrowProps:de,popper:Ee,show:we})=>{var ke;d3(ie,de);const ge=Ee?.placement,Ae=Object.assign(E.current,{state:Ee?.state,scheduleUpdate:Ee?.update,placement:ge,outOfBoundaries:(Ee==null||(ke=Ee.state)==null||(ke=ke.modifiersData.hide)==null?void 0:ke.isReferenceHidden)||!1,strategy:r.strategy}),Ge=!!C;return typeof n=="function"?n({...ie,placement:ge,show:we,...!e&&we&&{className:"show"},popper:Ae,arrowProps:de,hasDoneInitialMeasure:Ge}):K.cloneElement(n,{...ie,placement:ge,arrowProps:de,popper:Ae,hasDoneInitialMeasure:Ge,className:mn(n.props.className,!e&&we&&"show"),style:{...n.props.style,...ie.style}})}})});EM.displayName="Overlay";const MM=K.forwardRef(({bsPrefix:n,variant:e,animation:r="border",size:u,as:d="div",className:m,...y},l)=>{n=Rn(n,"spinner");const E=`${n}-${r}`;return H.jsx(d,{ref:l,...y,className:mn(m,E,u&&`${E}-${u}`,e&&`text-${e}`)})});MM.displayName="Spinner";const mb=K.forwardRef(({bsPrefix:n,className:e,striped:r,bordered:u,borderless:d,hover:m,size:y,variant:l,responsive:E,...C},k)=>{const N=Rn(n,"table"),F=mn(e,N,l&&`${N}-${l}`,y&&`${N}-${y}`,r&&`${N}-${typeof r=="string"?`striped-${r}`:"striped"}`,u&&`${N}-bordered`,d&&`${N}-borderless`,m&&`${N}-hover`),B=H.jsx("table",{...C,className:F,ref:k});if(E){let W=`${N}-responsive`;return typeof E=="string"&&(W=`${W}-${E}`),H.jsx("div",{className:W,children:B})}return B});mb.displayName="Table";function f3({tripQueryVariables:n,setTripQueryVariables:e,coordinates:r,onClose:u}){return H.jsx(MS,{longitude:r.lng,latitude:r.lat,anchor:"bottom",onClose:u,children:H.jsxs(U1,{vertical:!0,children:[H.jsx(Cf,{onClick:()=>{e({...n,from:{coordinates:{latitude:r.lat,longitude:r.lng}}}),u()},children:"Start here"}),H.jsx(Cf,{onClick:()=>{e({...n,to:{coordinates:{latitude:r.lat,longitude:r.lng}}}),u()},children:"End here"})]})})}function p3({coordinates:n,properties:e,onClose:r}){return H.jsxs(MS,{latitude:n.lat,longitude:n.lng,closeButton:!0,onClose:()=>r(),maxWidth:"350px",children:[H.jsx(mb,{bordered:!0,children:H.jsx("tbody",{children:Object.entries(e).map(([u,d])=>H.jsxs("tr",{children:[H.jsx("th",{scope:"row",children:u}),H.jsx("td",{children:String(d)})]},u))})}),H.jsx("div",{className:"geometry-popup-osm-link",children:H.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${n.lat}&mlon=${n.lng}#map=18/${n.lat}/${n.lng}`,target:"_blank",rel:"noreferrer",children:"↗️ osm.org"})})]})}const AM=n=>{const e=n.getStyle();return!e||!e.layers?[]:e.layers.filter(r=>r.type!=="raster"&&!r.id.startsWith("jsx")).filter(r=>n.getLayoutProperty(r.id,"visibility")!=="none").map(r=>r.id)},m3=({mapRef:n,setInteractiveLayerIds:e})=>{const[r,u]=K.useState([]),[d,m]=K.useState({});K.useEffect(()=>{if(!n)return;const E=n.getMap(),C=()=>{const k=E.getStyle();if(!k||!k.layers)return;const N=k.layers.filter(B=>B.type==="raster").map(B=>{let W=B.id;const re=B.metadata?.name;return re&&(W=re),{id:B.id,name:W}});u(N);const F={};k.layers.filter(B=>B.type!=="raster"&&!B.id.startsWith("jsx")).reverse().forEach(B=>{const W=B.metadata?.group||"Misc";F[W]||(F[W]=[]),F[W].push({id:B.id,name:B.id})}),m(F)};return E.isStyleLoaded()?C():E.on("styledata",C),()=>{E.off("styledata",C)}},[n]);const y=K.useCallback((E,C)=>{if(!n)return;const k=n.getMap();k.setLayoutProperty(E,"visibility",C?"visible":"none");const N=AM(k);e(N)},[n,e]),l=K.useCallback(E=>{if(!n)return;const C=n.getMap();r.forEach(k=>{C.setLayoutProperty(k.id,"visibility",k.id===E?"visible":"none")})},[n,r]);return H.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[H.jsx("h4",{style:{marginTop:0},children:"Background"}),H.jsx("select",{onChange:E=>l(E.target.value),children:r.map(E=>H.jsx("option",{value:E.id,children:E.name},E.id))}),H.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(d).map(([E,C])=>{const k=C.every(F=>n?.getMap().getLayoutProperty(F.id,"visibility")!=="none"),N=F=>{C.forEach(B=>{y(B.id,F)})};return H.jsxs("div",{style:{marginBottom:"10px"},children:[H.jsx("h6",{style:{margin:"0 0 5px"},children:H.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[H.jsx("input",{type:"checkbox",checked:k,onChange:F=>N(F.target.checked),style:{marginRight:"5px"}}),E]})}),C.map(F=>{const B=n?.getMap().getLayoutProperty(F.id,"visibility")!=="none";return H.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[H.jsx("input",{type:"checkbox",checked:B,onChange:W=>y(F.id,W.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),F.name]},F.id)})]},E)})]})},g3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class y3 extends K.Component{constructor(e){super(e),this.state={isSidebarOpen:!1,activeContent:null}}toggleSidebar=e=>{this.setState(r=>({isSidebarOpen:r.activeContent!==e||!r.isSidebarOpen,activeContent:r.activeContent===e?null:e}))};render(){const{isSidebarOpen:e,activeContent:r}=this.state,{position:u,setInteractiveLayerIds:d,mapRef:m}=this.props;return H.jsxs("div",{children:[H.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${r==="debugLayer"?"active":""} ${e?"open":""}`,style:{top:"20px"},children:H.jsx("img",{src:g3,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),H.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:e?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:e?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:e&&r==="debugLayer"&&H.jsx(m3,{position:u,setInteractiveLayerIds:d,mapRef:m})})]})}}const _3="/otp/debug/vectortiles/style.json";function v3({tripQueryVariables:n,setTripQueryVariables:e,tripQueryResult:r,selectedTripPatternIndexes:u,loading:d}){const m=lR({tripQueryVariables:n,setTripQueryVariables:e}),[y,l]=K.useState(null),[E,C]=K.useState(null),[k,N]=K.useState([]),[F,B]=K.useState("auto"),W=K.useCallback(()=>B("pointer"),[]),re=K.useCallback(()=>B("auto"),[]),ie=ge=>{if(ge.features){const Ae=ge.features[0];C({coordinates:ge.lngLat,feature:Ae})}},de=ge=>{const Ae=ge.target;if(Ae.getZoom()<2){const Ge=Ae.getSource("stops");Ae.fitBounds(Ge.bounds,{animate:!1})}},Ee=ge=>{ge.target.addControl(new DS.AttributionControl,"bottom-left")};function we(ge){de(ge);const Ae=AM(ge.target);N(Ae),Ee(ge)}const ke=K.useRef(null);return H.jsx("div",{className:"map-container below-content",children:H.jsxs(KC,{attributionControl:!1,mapLib:SS(()=>Promise.resolve().then(()=>IS),void 0),mapStyle:_3,onDblClick:m,onContextMenu:ge=>{l(ge.lngLat)},interactiveLayerIds:k,cursor:F,onMouseEnter:W,onMouseLeave:re,onClick:ie,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:we,ref:ke,children:[H.jsx(rD,{position:"top-left"}),H.jsx(nR,{setCursor:B,tripQueryVariables:n,setTripQueryVariables:e,loading:d}),H.jsx(y3,{position:"top-right",setInteractiveLayerIds:N,mapRef:ke?.current}),r?.trip.tripPatterns.length&&u.map(ge=>{const Ae=r.trip.tripPatterns[ge];return Ae?H.jsx(aR,{tripPattern:Ae},`trippattern-${ge}`):null}),y&&H.jsx(f3,{tripQueryVariables:n,setTripQueryVariables:e,coordinates:y,onClose:()=>l(null)}),E?.feature?.properties&&H.jsx(p3,{coordinates:E?.coordinates,properties:E?.feature?.properties,onClose:()=>C(null)})]})})}function b3(){const[n,e]=K.useState(0),r=K.useRef(null);return K.useLayoutEffect(()=>{r.current&&e(r.current.getBoundingClientRect().width)},[]),K.useEffect(()=>{const u=()=>{r.current&&e(r.current.getBoundingClientRect().width)};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[]),{containerRef:r,containerWidth:n}}const x3=70,w3=20,Qx=40;function T3(n,e,r,u){const d=K.useMemo(()=>new Date(u).getTime()-new Date(r).getTime(),[r,u]),m=K.useMemo(()=>(new Date(n.expectedStartTime).getTime()-new Date(r).getTime())/d,[n.expectedStartTime,r,d]),y=K.useMemo(()=>new Date(n.expectedEndTime).getTime()-new Date(n.expectedStartTime).getTime(),[n.expectedStartTime,n.expectedEndTime]),l=w3+Qx,C=e-x3-Qx-l,k=l+m*C,N=C*(y/d);return{maxSpan:d,startPx:l,pxSpan:C,widthPx:N,leftPx:k}}const S3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",E3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",M3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",A3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",C3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",D3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",I3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",R3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",k3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",P3="https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-13T09:56/assets/monorail-CEIE-7ZV.png",O3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",L3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABHNCSVQICAgIfAhkiAAAAFtJREFUKJFjYCAOCBGpDif4D8UUG8LAwMDAwESJKaOaaaj5GwOZ8fyfgYHBAomNIYkrBYkyMDD8wKaOhYGBYTEWg9CBJBax5YxYNDBiUYjNYBR1y/FoQgZwlwIAXKYUAUY5kWQAAAAASUVORK5CYII=",N3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",z3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",j3="https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-13T09:56/assets/trolleybus-BefhFtdd.png",F3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function B3(n){return n===Ti.Rail||n===Ti.Coach||n===Ti.Metro||n===Ti.Bus||n===Ti.Tram||n===Ti.Water||n===Ti.Air||n===Ti.Cableway||n===Ti.Funicular||n===Ti.Trolleybus||n===Ti.Monorail||n===Ti.Taxi}function U3(n){const e=V3(n);function r(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}const u=r(e[0]/255),d=r(e[1]/255),m=r(e[2]/255);return .2126*u+.7152*d+.0722*m>.179?"#000":"#fff"}function V3(n){return G3(n)}function G3(n){return n.length===4?$3(n):[parseInt(n.slice(1,3),16),parseInt(n.slice(3,5),16),parseInt(n.slice(5,7),16)]}function $3(n){const e=n.slice(1,2),r=n.slice(2,3),u=n.slice(3,4);return[parseInt(e+e,16),parseInt(r+r,16),parseInt(u+u,16)]}function Z3(n,e,r,u,d){const m=K.useMemo(()=>(new Date(n.expectedStartTime).getTime()-new Date(e).getTime())/r,[n.expectedStartTime,e,r]),y=K.useMemo(()=>d*(new Date(n.expectedEndTime).getTime()-new Date(n.expectedStartTime).getTime())/r-1,[d,n,r]),l=u+m*d+1,E=y>40&&B3(n.mode)&&n.line?.publicCode&&n.line.publicCode.length<=6,C=gE(n),k=K.useMemo(()=>U3(C),[C]);return{widthPx:y,leftPx:l,legTextColor:k,modeColor:C,showPublicCode:E}}const Y3=Object.assign({"../../static/img/mode/air.png":S3,"../../static/img/mode/bicycle.png":E3,"../../static/img/mode/bus.png":M3,"../../static/img/mode/cableway.png":A3,"../../static/img/mode/car.png":C3,"../../static/img/mode/coach.png":D3,"../../static/img/mode/foot.png":I3,"../../static/img/mode/funicular.png":R3,"../../static/img/mode/metro.png":k3,"../../static/img/mode/monorail.png":P3,"../../static/img/mode/rail.png":O3,"../../static/img/mode/scooter.png":L3,"../../static/img/mode/taxi.png":N3,"../../static/img/mode/tram.png":z3,"../../static/img/mode/trolleybus.png":j3,"../../static/img/mode/water.png":F3});function H3(n){return Y3[`../../static/img/mode/${n.mode.toLowerCase()}.png`]}function q3({leg:n,earliestStartTime:e,maxSpan:r,startPx:u,pxSpan:d}){const{widthPx:m,leftPx:y,legTextColor:l,modeColor:E,showPublicCode:C}=Z3(n,e,r,u,d),k=H3(n);return H.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${m}px`,left:y,color:l,background:E},children:[H.jsx("div",{className:"itinerary-header-leg-icon",style:{background:l,maskImage:`url(${k})`,WebkitMaskImage:`url(${k})`}}),C&&H.jsx("span",{className:"itinerary-header-leg-public-code",children:n.line?.publicCode})]})}function Zc(n,e,r){return new Date(n).toLocaleTimeString("en-US",{timeStyle:r,hourCycle:"h24",timeZone:e})}const Xg=K.createContext("UTC");function X3({tripPattern:n,itineraryIndex:e,containerWidth:r,earliestStartTime:u,latestEndTime:d,comparisonSelectedIndexes:m,setComparisonSelectedIndexes:y}){const{maxSpan:l,pxSpan:E,startPx:C,widthPx:k,leftPx:N}=T3(n,r,u,d),F=K.useContext(Xg),B=K.useMemo(()=>Zc(n.expectedStartTime,F,"short"),[n.expectedStartTime,F]),W=K.useMemo(()=>Zc(n.expectedEndTime,F,"short"),[n.expectedEndTime,F]),re=()=>{!y||!m||(m.includes(e)?y(m.filter(de=>de!==e)):m.length<2&&y([...m,e]))},ie=m?.includes(e)||!1;return H.jsxs("div",{className:"itinerary-header-wrapper",style:{position:"relative"},children:[m&&y&&H.jsx("div",{onClick:de=>de.stopPropagation(),style:{position:"absolute",top:"4px",right:"4px",zIndex:10},children:H.jsx("input",{type:"checkbox",checked:ie,onChange:re,disabled:!ie&&m.length>=2,title:"Select for comparison"})}),H.jsxs("div",{className:"itinerary-header-itinerary-number",children:[e+1,"."]}),H.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${k+5}px`,left:`${N-2}px`}}),H.jsx("div",{title:n.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${N-Qx}px`},children:B}),n.legs.map((de,Ee)=>H.jsx(q3,{leg:de,earliestStartTime:u,startPx:C,maxSpan:l,pxSpan:E},de.id||`leg_${Ee}`)),H.jsx("div",{title:n.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${N+k+2}px`},children:W})]})}function W3(n){const e=K.useMemo(()=>n?.trip.tripPatterns.reduce((u,d)=>u===null?d?.expectedStartTime:new Date(d?.expectedStartTime)<new Date(u)?d.expectedStartTime:u,null)||null,[n?.trip]),r=K.useMemo(()=>n?.trip.tripPatterns.reduce((u,d)=>u===null?d?.expectedEndTime:new Date(d?.expectedEndTime)>new Date(u)?d.expectedEndTime:u,null)||null,[n?.trip]);return[e,r]}function eT({aimedTime:n,expectedTime:e,hasRealtime:r}){const u=K.useContext(Xg);return n!==e?H.jsxs(H.Fragment,{children:[H.jsx("span",{title:e,style:{color:"red"},children:Zc(e,u,"short")}),H.jsx("span",{title:n,style:{textDecoration:"line-through"},children:Zc(n,u,"short")})]}):H.jsxs("span",{title:e,children:[Zc(e,u,"short"),r&&H.jsx("span",{children:" (on time)"})]})}function rw(n){const e=n/1e3;return e>100?`${e.toFixed(0)} km`:e>1?`${e.toFixed(1)} km`:`${n.toFixed(0)} m`}const dv=n=>{const e=parseFloat(n.replace(/[^0-9.]/g,""));return n.includes("km")?e*1e3:e};function aw(n){const e=Math.floor(n/3600),r=Math.floor(n/60)%60,u=n%60;let d="";return e>0&&(d=`${d}${e}h `),r>0&&(d=`${d}${r}min `),u>1&&(d=`${d}${u}s`),d}const Q3="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function K3({leg:n}){return n.interchangeFrom?.staySeated?H.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:Q3,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const J3=Zg(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),eO=hs(J3),tO="/graphiql?flavor=transmodel";function nO({legId:n,legName:e}){const r={id:n},u=encodeURIComponent(eO),d=encodeURIComponent(JSON.stringify(r));return H.jsx("a",{href:tO+"&query="+u+"&variables="+d,target:"_blank",rel:"noreferrer",children:e})}const iO=Zg(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),rO=hs(iO),aO="/graphiql?flavor=transmodel";function tT({legId:n,legName:e}){const r={id:n},u=encodeURIComponent(rO),d=encodeURIComponent(JSON.stringify(r));return H.jsx("a",{href:aO+"&query="+u+"&variables="+d,target:"_blank",rel:"noreferrer",children:e})}const oO=Zg(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),sO=hs(oO),lO="/graphiql?flavor=transmodel";function cO({legId:n,legName:e}){const r={id:n},u=encodeURIComponent(sO),d=encodeURIComponent(JSON.stringify(r));return H.jsx("a",{href:lO+"&query="+u+"&variables="+d,target:"_blank",rel:"noreferrer",children:e})}function uO(n){return n.line?.publicCode?n.line.publicCode+" "+n.fromEstimatedCall?.destinationDisplay?.frontText:n.line?.name||"unknown"}function hO({leg:n,isLast:e}){return H.jsxs("div",{className:"itinerary-leg-details",children:[H.jsxs("div",{className:"times",children:[rw(n.distance),", ",aw(n.duration),","," ",H.jsxs("span",{title:"Generalized cost: ¢"+n.generalizedCost,children:["¢",n.generalizedCost]})]}),H.jsx(K3,{leg:n}),H.jsx(eT,{aimedTime:n.aimedStartTime,expectedTime:n.expectedStartTime,hasRealtime:n.realtime})," -"," ",H.jsx(eT,{aimedTime:n.aimedEndTime,expectedTime:n.expectedEndTime,hasRealtime:n.realtime}),H.jsxs("div",{className:"mode",children:[H.jsx("b",{children:n.mode})," ",n.line&&H.jsxs(H.Fragment,{children:[H.jsx(nO,{legId:n.line?.id,legName:uO(n)}),", ",H.jsx(cO,{legId:n.authority?.id,legName:n.authority?.name})]})," ",n.mode!==Ti.Foot&&H.jsxs(H.Fragment,{children:[H.jsx("br",{}),H.jsx(tT,{legId:n.fromPlace.quay?.id,legName:n.fromPlace.name})," →"," "]})," ",!e&&H.jsx(tT,{legId:n.toPlace.quay?.id,legName:n.toPlace.name})]})]})}function dO({tripPattern:n}){return H.jsxs("div",{children:[n.systemNotices.length>0&&H.jsxs("p",{children:["System tags: ",n.systemNotices.map(e=>e.tag).join(", ")]}),n.legs.map((e,r)=>H.jsx(hO,{leg:e,isLast:r===n.legs.length-1},e.id?e.id:`noid_${r}`)),H.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ¢",n.generalizedCost]})]})}function fO({previousPageCursor:n,nextPageCursor:e,onPagination:r,loading:u,comparisonSelectedIndexes:d,onCompare:m}){return H.jsxs("div",{className:"pagination-controls-container",children:[H.jsx(Cf,{variant:"outline-primary",size:"sm",disabled:!n||u,onClick:()=>{n&&r(n)},children:"Previous page"}),H.jsx("div",{style:{textAlign:"center"},children:d?.length===2&&m&&H.jsx(Cf,{variant:"primary",size:"sm",onClick:m,children:"Compare selected"})}),H.jsx(Cf,{variant:"outline-primary",size:"sm",disabled:!e||u,onClick:()=>{e&&r(e)},children:"Next page"})]})}function pO({error:n,onDismiss:e}){if(!n)return null;const r=y=>{try{const l=y,E=String(l.message||"").toLowerCase(),C=l.code;if(E.includes("fetch")&&E.includes("failed"))return{userMessage:"Connection failed. Please check your internet connection and try again.",showRaw:!1};if(E.includes("network error")||C==="NETWORK_ERROR")return{userMessage:"Network error occurred. Please verify your internet connection and try again.",showRaw:!1};if(E.includes("enotfound")||E.includes("getaddrinfo"))return{userMessage:"Unable to reach the server. Please check your internet connection or try again later.",showRaw:!1};if(E.includes("timeout"))return{userMessage:"Request timed out. The server may be busy, please try again in a moment.",showRaw:!0};const k=l.response;if(k&&typeof k.status=="number"){const N=k.status;if(N>=500)return{userMessage:"Server error occurred. Please try again later.",showRaw:!0};if(N===404)return{userMessage:"Service not found. Please contact support if this issue persists.",showRaw:!0};if(N>=400)return{userMessage:"Request failed. Please check your search parameters and try again.",showRaw:!0}}if(k&&k.errors)return{userMessage:"Server returned an error response.",showRaw:!0}}catch{}return{userMessage:"An unexpected error occurred. Please try again.",showRaw:!0}},{userMessage:u,showRaw:d}=r(n);let m;try{const l=n.response;l&&l.errors?m=JSON.stringify(l.errors,null,2):l&&l.data?m=JSON.stringify(l.data,null,2):m=JSON.stringify(n,null,2)}catch{m="Unable to display error details"}return H.jsx("div",{className:"error-display-container",children:H.jsxs("div",{className:"flex-space-between",children:[H.jsxs("div",{className:"flex-1",children:[H.jsx("div",{className:"error-title",children:"Search Error"}),H.jsx("div",{className:"error-message",children:u}),d&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"error-title",children:"Technical Details:"}),H.jsx("pre",{className:"error-details",children:m})]})]}),e&&H.jsx("button",{onClick:e,className:"error-dismiss-button","aria-label":"Dismiss error",children:"×"})]})})}function mO({hasSearched:n,tripQueryResult:e}){return!n||!e?null:H.jsx("div",{className:"no-results-display-container",children:H.jsx("div",{className:"flex-space-between",children:H.jsxs("div",{className:"flex-1",children:[H.jsx("div",{className:"info-title",children:"No Results Found"}),H.jsx("div",{className:"info-message",children:"No matching trips were found for your search criteria."}),H.jsx("div",{className:"info-title",children:"Raw Response:"}),H.jsx("pre",{className:"no-results-details",children:JSON.stringify(e,null,2)})]})})})}function gO({tripQueryResult:n,selectedTripPatternIndexes:e,setSelectedTripPatternIndexes:r,pageResults:u,loading:d,comparisonSelectedIndexes:m,setComparisonSelectedIndexes:y,onCompare:l,error:E}){const[C,k]=W3(n),{containerRef:N,containerWidth:F}=b3(),B=K.useContext(Xg),W=!!(n&&n.trip.tripPatterns.length===0),re=n!==null,ie=E||re&&!E&&W;return H.jsxs("section",{className:"left-pane-container below-content",ref:N,children:[H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"panel-header",children:"Itinerary results"}),H.jsx(pO,{error:E}),H.jsx(mO,{hasSearched:re&&!E&&W,tripQueryResult:n}),!ie&&H.jsx("div",{className:"pagination-controls",children:H.jsx(fO,{onPagination:u,previousPageCursor:n?.trip.previousPageCursor,nextPageCursor:n?.trip.nextPageCursor,loading:d,comparisonSelectedIndexes:m,onCompare:l})}),H.jsx(lv,{activeKey:e.map(String),onSelect:de=>{const Ee=parseInt(de);r(we=>{if(we.includes(Ee))return we.filter(ke=>ke!==Ee);{const ke=[...we,Ee];return ke.length>2?ke.slice(-2):ke}})},children:n&&n.trip.tripPatterns.map((de,Ee)=>H.jsxs(lv.Item,{eventKey:`${Ee}`,bsPrefix:de.systemNotices.length===0?"":"accordion-item-filtered",children:[H.jsx(lv.Header,{children:H.jsx(X3,{containerWidth:F,tripPattern:de,itineraryIndex:Ee,earliestStartTime:C,latestEndTime:k,comparisonSelectedIndexes:m,setComparisonSelectedIndexes:y})}),H.jsx(lv.Body,{children:H.jsx(dO,{tripPattern:de})})]},`${Ee}`))})]}),H.jsxs("div",{className:"time-zone-info",children:["All times in ",H.jsx("code",{children:B})]})]})}const bf=(n,e,r="lower")=>n==null||e==null||n===e?"":(r==="lower"?n<e:n>e)?"compare-value-best":"",xf={duration:"lower",cost:"lower",legs:"lower",walkingDistance:"lower"},nT=(n,e)=>{if(!n)throw new Error("TripPattern is required");const r=Zc(n.expectedStartTime,e,"short"),u=Zc(n.expectedEndTime,e,"short"),d=aw(n.duration),m=n.generalizedCost,y=n.legs.filter(E=>E&&E.mode===Ti.Foot).reduce((E,C)=>E+C.distance,0),l=Math.max(0,n.legs.length-1);return{startTime:r,endTime:u,duration:d,generalizedCost:m,walkingDistance:rw(y),totalLegs:l}},iT=(n,e,r)=>n.map((u,d)=>{const m=u.id||`leg${e}_${d}`,y=u.fromPlace?.name||"Unknown",l=u.toPlace?.name||"Unknown",E=`${u.mode}${u.line?.publicCode?` (${u.line.publicCode})`:""} | ${y} → ${l} | ${Zc(u.aimedStartTime,r,"short")} to ${Zc(u.aimedEndTime,r,"short")}`;return{value:m,label:E}});function yO({itinerary1:n,itinerary2:e,summary1:r,summary2:u,selectedIndexes:d}){return H.jsxs(mb,{bordered:!0,hover:!0,className:"compare-summary-table",children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("th",{children:"Itinerary"}),H.jsx("th",{children:"Start Time"}),H.jsx("th",{children:"End Time"}),H.jsx("th",{children:"Duration"}),H.jsx("th",{children:"Cost"}),H.jsx("th",{children:"Transfers"}),H.jsx("th",{children:"Walking Distance"})]})}),H.jsxs("tbody",{children:[H.jsxs("tr",{children:[H.jsx("td",{children:H.jsxs("span",{className:"compare-itinerary-number",children:["#",d[0]+1]})}),H.jsx("td",{children:r.startTime}),H.jsx("td",{children:r.endTime}),H.jsx("td",{className:bf(n.duration,e.duration,xf.duration),children:r.duration}),H.jsxs("td",{className:bf(r.generalizedCost,u.generalizedCost,xf.cost),children:["¢",r.generalizedCost]}),H.jsx("td",{className:bf(r.totalLegs,u.totalLegs,xf.legs),children:r.totalLegs}),H.jsx("td",{className:bf(dv(r.walkingDistance),dv(u.walkingDistance),xf.walkingDistance),children:r.walkingDistance})]}),H.jsxs("tr",{children:[H.jsx("td",{children:H.jsxs("span",{className:"compare-itinerary-number",children:["#",d[1]+1]})}),H.jsx("td",{children:u.startTime}),H.jsx("td",{children:u.endTime}),H.jsx("td",{className:bf(e.duration,n.duration,xf.duration),children:u.duration}),H.jsxs("td",{className:bf(u.generalizedCost,r.generalizedCost,xf.cost),children:["¢",u.generalizedCost]}),H.jsx("td",{className:bf(u.totalLegs,r.totalLegs,xf.legs),children:u.totalLegs}),H.jsx("td",{className:bf(dv(u.walkingDistance),dv(r.walkingDistance),xf.walkingDistance),children:u.walkingDistance})]})]})]})}function Bp(n){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bp(n)}function _O(n,e){if(Bp(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var u=r.call(n,e);if(Bp(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CM(n){var e=_O(n,"string");return Bp(e)=="symbol"?e:e+""}function d0(n,e,r){return(e=CM(e))in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function rT(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);e&&(u=u.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,u)}return r}function dn(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rT(Object(r),!0).forEach(function(u){d0(n,u,r[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):rT(Object(r)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(r,u))})}return n}function vO(n){if(Array.isArray(n))return n}function bO(n,e){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var u,d,m,y,l=[],E=!0,C=!1;try{if(m=(r=r.call(n)).next,e===0){if(Object(r)!==r)return;E=!1}else for(;!(E=(u=m.call(r)).done)&&(l.push(u.value),l.length!==e);E=!0);}catch(k){C=!0,d=k}finally{try{if(!E&&r.return!=null&&(y=r.return(),Object(y)!==y))return}finally{if(C)throw d}}return l}}function Kx(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,u=Array(e);r<e;r++)u[r]=n[r];return u}function DM(n,e){if(n){if(typeof n=="string")return Kx(n,e);var r={}.toString.call(n).slice(8,-1);return r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set"?Array.from(n):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kx(n,e):void 0}}function xO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fd(n,e){return vO(n)||bO(n,e)||DM(n,e)||xO()}function Ed(n,e){if(n==null)return{};var r,u,d=P1(n,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(n);for(u=0;u<m.length;u++)r=m[u],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(n,r)&&(d[r]=n[r])}return d}var wO=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function TO(n){var e=n.defaultInputValue,r=e===void 0?"":e,u=n.defaultMenuIsOpen,d=u===void 0?!1:u,m=n.defaultValue,y=m===void 0?null:m,l=n.inputValue,E=n.menuIsOpen,C=n.onChange,k=n.onInputChange,N=n.onMenuClose,F=n.onMenuOpen,B=n.value,W=Ed(n,wO),re=K.useState(l!==void 0?l:r),ie=fd(re,2),de=ie[0],Ee=ie[1],we=K.useState(E!==void 0?E:d),ke=fd(we,2),ge=ke[0],Ae=ke[1],Ge=K.useState(B!==void 0?B:y),at=fd(Ge,2),Me=at[0],Qe=at[1],St=K.useCallback(function(_t,ut){typeof C=="function"&&C(_t,ut),Qe(_t)},[C]),bt=K.useCallback(function(_t,ut){var Te;typeof k=="function"&&(Te=k(_t,ut)),Ee(Te!==void 0?Te:_t)},[k]),zt=K.useCallback(function(){typeof F=="function"&&F(),Ae(!0)},[F]),Zt=K.useCallback(function(){typeof N=="function"&&N(),Ae(!1)},[N]),Ft=l!==void 0?l:de,Be=E!==void 0?E:ge,lt=B!==void 0?B:Me;return dn(dn({},W),{},{inputValue:Ft,menuIsOpen:Be,onChange:St,onInputChange:bt,onMenuClose:Zt,onMenuOpen:zt,value:lt})}function SO(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function aT(n,e){for(var r=0;r<e.length;r++){var u=e[r];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,CM(u.key),u)}}function EO(n,e,r){return e&&aT(n.prototype,e),r&&aT(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function MO(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Rv(n,e)}function Nv(n){return Nv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nv(n)}function IM(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IM=function(){return!!n})()}function AO(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function CO(n,e){if(e&&(Bp(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AO(n)}function DO(n){var e=IM();return function(){var r,u=Nv(n);if(e){var d=Nv(this).constructor;r=Reflect.construct(u,arguments,d)}else r=u.apply(this,arguments);return CO(this,r)}}function IO(n){if(Array.isArray(n))return Kx(n)}function RO(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function kO(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ow(n){return IO(n)||RO(n)||DM(n)||kO()}function PO(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function OO(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var LO=function(){function n(r){var u=this;this._insertTag=function(d){var m;u.tags.length===0?u.insertionPoint?m=u.insertionPoint.nextSibling:u.prepend?m=u.container.firstChild:m=u.before:m=u.tags[u.tags.length-1].nextSibling,u.container.insertBefore(d,m),u.tags.push(d)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(u){u.forEach(this._insertTag)},e.insert=function(u){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(OO(this));var d=this.tags[this.tags.length-1];if(this.isSpeedy){var m=PO(d);try{m.insertRule(u,m.cssRules.length)}catch{}}else d.appendChild(document.createTextNode(u));this.ctr++},e.flush=function(){this.tags.forEach(function(u){var d;return(d=u.parentNode)==null?void 0:d.removeChild(u)}),this.tags=[],this.ctr=0},n}(),ko="-ms-",zv="-moz-",xi="-webkit-",RM="comm",sw="rule",lw="decl",NO="@import",kM="@keyframes",zO="@layer",jO=Math.abs,gb=String.fromCharCode,FO=Object.assign;function BO(n,e){return co(n,0)^45?(((e<<2^co(n,0))<<2^co(n,1))<<2^co(n,2))<<2^co(n,3):0}function PM(n){return n.trim()}function UO(n,e){return(n=e.exec(n))?n[0]:n}function wi(n,e,r){return n.replace(e,r)}function Jx(n,e){return n.indexOf(e)}function co(n,e){return n.charCodeAt(e)|0}function O0(n,e,r){return n.slice(e,r)}function Bu(n){return n.length}function cw(n){return n.length}function fv(n,e){return e.push(n),n}function VO(n,e){return n.map(e).join("")}var yb=1,Pg=1,OM=0,Fs=0,ya=0,Wg="";function _b(n,e,r,u,d,m,y){return{value:n,root:e,parent:r,type:u,props:d,children:m,line:yb,column:Pg,length:y,return:""}}function i0(n,e){return FO(_b("",null,null,"",null,null,0),n,{length:-n.length},e)}function GO(){return ya}function $O(){return ya=Fs>0?co(Wg,--Fs):0,Pg--,ya===10&&(Pg=1,yb--),ya}function ml(){return ya=Fs<OM?co(Wg,Fs++):0,Pg++,ya===10&&(Pg=1,yb++),ya}function Qu(){return co(Wg,Fs)}function Sv(){return Fs}function J0(n,e){return O0(Wg,n,e)}function L0(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function LM(n){return yb=Pg=1,OM=Bu(Wg=n),Fs=0,[]}function NM(n){return Wg="",n}function Ev(n){return PM(J0(Fs-1,e1(n===91?n+2:n===40?n+1:n)))}function ZO(n){for(;(ya=Qu())&&ya<33;)ml();return L0(n)>2||L0(ya)>3?"":" "}function YO(n,e){for(;--e&&ml()&&!(ya<48||ya>102||ya>57&&ya<65||ya>70&&ya<97););return J0(n,Sv()+(e<6&&Qu()==32&&ml()==32))}function e1(n){for(;ml();)switch(ya){case n:return Fs;case 34:case 39:n!==34&&n!==39&&e1(ya);break;case 40:n===41&&e1(n);break;case 92:ml();break}return Fs}function HO(n,e){for(;ml()&&n+ya!==57;)if(n+ya===84&&Qu()===47)break;return"/*"+J0(e,Fs-1)+"*"+gb(n===47?n:ml())}function qO(n){for(;!L0(Qu());)ml();return J0(n,Fs)}function XO(n){return NM(Mv("",null,null,null,[""],n=LM(n),0,[0],n))}function Mv(n,e,r,u,d,m,y,l,E){for(var C=0,k=0,N=y,F=0,B=0,W=0,re=1,ie=1,de=1,Ee=0,we="",ke=d,ge=m,Ae=u,Ge=we;ie;)switch(W=Ee,Ee=ml()){case 40:if(W!=108&&co(Ge,N-1)==58){Jx(Ge+=wi(Ev(Ee),"&","&\f"),"&\f")!=-1&&(de=-1);break}case 34:case 39:case 91:Ge+=Ev(Ee);break;case 9:case 10:case 13:case 32:Ge+=ZO(W);break;case 92:Ge+=YO(Sv()-1,7);continue;case 47:switch(Qu()){case 42:case 47:fv(WO(HO(ml(),Sv()),e,r),E);break;default:Ge+="/"}break;case 123*re:l[C++]=Bu(Ge)*de;case 125*re:case 59:case 0:switch(Ee){case 0:case 125:ie=0;case 59+k:de==-1&&(Ge=wi(Ge,/\f/g,"")),B>0&&Bu(Ge)-N&&fv(B>32?sT(Ge+";",u,r,N-1):sT(wi(Ge," ","")+";",u,r,N-2),E);break;case 59:Ge+=";";default:if(fv(Ae=oT(Ge,e,r,C,k,d,l,we,ke=[],ge=[],N),m),Ee===123)if(k===0)Mv(Ge,e,Ae,Ae,ke,m,N,l,ge);else switch(F===99&&co(Ge,3)===110?100:F){case 100:case 108:case 109:case 115:Mv(n,Ae,Ae,u&&fv(oT(n,Ae,Ae,0,0,d,l,we,d,ke=[],N),ge),d,ge,N,l,u?ke:ge);break;default:Mv(Ge,Ae,Ae,Ae,[""],ge,0,l,ge)}}C=k=B=0,re=de=1,we=Ge="",N=y;break;case 58:N=1+Bu(Ge),B=W;default:if(re<1){if(Ee==123)--re;else if(Ee==125&&re++==0&&$O()==125)continue}switch(Ge+=gb(Ee),Ee*re){case 38:de=k>0?1:(Ge+="\f",-1);break;case 44:l[C++]=(Bu(Ge)-1)*de,de=1;break;case 64:Qu()===45&&(Ge+=Ev(ml())),F=Qu(),k=N=Bu(we=Ge+=qO(Sv())),Ee++;break;case 45:W===45&&Bu(Ge)==2&&(re=0)}}return m}function oT(n,e,r,u,d,m,y,l,E,C,k){for(var N=d-1,F=d===0?m:[""],B=cw(F),W=0,re=0,ie=0;W<u;++W)for(var de=0,Ee=O0(n,N+1,N=jO(re=y[W])),we=n;de<B;++de)(we=PM(re>0?F[de]+" "+Ee:wi(Ee,/&\f/g,F[de])))&&(E[ie++]=we);return _b(n,e,r,d===0?sw:l,E,C,k)}function WO(n,e,r){return _b(n,e,r,RM,gb(GO()),O0(n,2,-2),0)}function sT(n,e,r,u){return _b(n,e,r,lw,O0(n,0,u),O0(n,u+1,-1),u)}function Tg(n,e){for(var r="",u=cw(n),d=0;d<u;d++)r+=e(n[d],d,n,e)||"";return r}function QO(n,e,r,u){switch(n.type){case zO:if(n.children.length)break;case NO:case lw:return n.return=n.return||n.value;case RM:return"";case kM:return n.return=n.value+"{"+Tg(n.children,u)+"}";case sw:n.value=n.props.join(",")}return Bu(r=Tg(n.children,u))?n.return=n.value+"{"+r+"}":""}function KO(n){var e=cw(n);return function(r,u,d,m){for(var y="",l=0;l<e;l++)y+=n[l](r,u,d,m)||"";return y}}function JO(n){return function(e){e.root||(e=e.return)&&n(e)}}function eL(n){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=n(r)),e[r]}}var tL=function(e,r,u){for(var d=0,m=0;d=m,m=Qu(),d===38&&m===12&&(r[u]=1),!L0(m);)ml();return J0(e,Fs)},nL=function(e,r){var u=-1,d=44;do switch(L0(d)){case 0:d===38&&Qu()===12&&(r[u]=1),e[u]+=tL(Fs-1,r,u);break;case 2:e[u]+=Ev(d);break;case 4:if(d===44){e[++u]=Qu()===58?"&\f":"",r[u]=e[u].length;break}default:e[u]+=gb(d)}while(d=ml());return e},iL=function(e,r){return NM(nL(LM(e),r))},lT=new WeakMap,rL=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,u=e.parent,d=e.column===u.column&&e.line===u.line;u.type!=="rule";)if(u=u.parent,!u)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!lT.get(u))&&!d){lT.set(e,!0);for(var m=[],y=iL(r,m),l=u.props,E=0,C=0;E<y.length;E++)for(var k=0;k<l.length;k++,C++)e.props[C]=m[E]?y[E].replace(/&\f/g,l[k]):l[k]+" "+y[E]}}},aL=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function zM(n,e){switch(BO(n,e)){case 5103:return xi+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return xi+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return xi+n+zv+n+ko+n+n;case 6828:case 4268:return xi+n+ko+n+n;case 6165:return xi+n+ko+"flex-"+n+n;case 5187:return xi+n+wi(n,/(\w+).+(:[^]+)/,xi+"box-$1$2"+ko+"flex-$1$2")+n;case 5443:return xi+n+ko+"flex-item-"+wi(n,/flex-|-self/,"")+n;case 4675:return xi+n+ko+"flex-line-pack"+wi(n,/align-content|flex-|-self/,"")+n;case 5548:return xi+n+ko+wi(n,"shrink","negative")+n;case 5292:return xi+n+ko+wi(n,"basis","preferred-size")+n;case 6060:return xi+"box-"+wi(n,"-grow","")+xi+n+ko+wi(n,"grow","positive")+n;case 4554:return xi+wi(n,/([^-])(transform)/g,"$1"+xi+"$2")+n;case 6187:return wi(wi(wi(n,/(zoom-|grab)/,xi+"$1"),/(image-set)/,xi+"$1"),n,"")+n;case 5495:case 3959:return wi(n,/(image-set\([^]*)/,xi+"$1$`$1");case 4968:return wi(wi(n,/(.+:)(flex-)?(.*)/,xi+"box-pack:$3"+ko+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+xi+n+n;case 4095:case 3583:case 4068:case 2532:return wi(n,/(.+)-inline(.+)/,xi+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Bu(n)-1-e>6)switch(co(n,e+1)){case 109:if(co(n,e+4)!==45)break;case 102:return wi(n,/(.+:)(.+)-([^]+)/,"$1"+xi+"$2-$3$1"+zv+(co(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~Jx(n,"stretch")?zM(wi(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(co(n,e+1)!==115)break;case 6444:switch(co(n,Bu(n)-3-(~Jx(n,"!important")&&10))){case 107:return wi(n,":",":"+xi)+n;case 101:return wi(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+xi+(co(n,14)===45?"inline-":"")+"box$3$1"+xi+"$2$3$1"+ko+"$2box$3")+n}break;case 5936:switch(co(n,e+11)){case 114:return xi+n+ko+wi(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return xi+n+ko+wi(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return xi+n+ko+wi(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return xi+n+ko+n+n}return n}var oL=function(e,r,u,d){if(e.length>-1&&!e.return)switch(e.type){case lw:e.return=zM(e.value,e.length);break;case kM:return Tg([i0(e,{value:wi(e.value,"@","@"+xi)})],d);case sw:if(e.length)return VO(e.props,function(m){switch(UO(m,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Tg([i0(e,{props:[wi(m,/:(read-\w+)/,":"+zv+"$1")]})],d);case"::placeholder":return Tg([i0(e,{props:[wi(m,/:(plac\w+)/,":"+xi+"input-$1")]}),i0(e,{props:[wi(m,/:(plac\w+)/,":"+zv+"$1")]}),i0(e,{props:[wi(m,/:(plac\w+)/,ko+"input-$1")]})],d)}return""})}},sL=[oL],lL=function(e){var r=e.key;if(r==="css"){var u=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(u,function(re){var ie=re.getAttribute("data-emotion");ie.indexOf(" ")!==-1&&(document.head.appendChild(re),re.setAttribute("data-s",""))})}var d=e.stylisPlugins||sL,m={},y,l=[];y=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(re){for(var ie=re.getAttribute("data-emotion").split(" "),de=1;de<ie.length;de++)m[ie[de]]=!0;l.push(re)});var E,C=[rL,aL];{var k,N=[QO,JO(function(re){k.insert(re)})],F=KO(C.concat(d,N)),B=function(ie){return Tg(XO(ie),F)};E=function(ie,de,Ee,we){k=Ee,B(ie?ie+"{"+de.styles+"}":de.styles),we&&(W.inserted[de.name]=!0)}}var W={key:r,sheet:new LO({key:r,container:y,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:m,registered:{},insert:E};return W.sheet.hydrate(l),W},vx={exports:{}},Di={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cT;function cL(){if(cT)return Di;cT=1;var n=typeof Symbol=="function"&&Symbol.for,e=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,u=n?Symbol.for("react.fragment"):60107,d=n?Symbol.for("react.strict_mode"):60108,m=n?Symbol.for("react.profiler"):60114,y=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,E=n?Symbol.for("react.async_mode"):60111,C=n?Symbol.for("react.concurrent_mode"):60111,k=n?Symbol.for("react.forward_ref"):60112,N=n?Symbol.for("react.suspense"):60113,F=n?Symbol.for("react.suspense_list"):60120,B=n?Symbol.for("react.memo"):60115,W=n?Symbol.for("react.lazy"):60116,re=n?Symbol.for("react.block"):60121,ie=n?Symbol.for("react.fundamental"):60117,de=n?Symbol.for("react.responder"):60118,Ee=n?Symbol.for("react.scope"):60119;function we(ge){if(typeof ge=="object"&&ge!==null){var Ae=ge.$$typeof;switch(Ae){case e:switch(ge=ge.type,ge){case E:case C:case u:case m:case d:case N:return ge;default:switch(ge=ge&&ge.$$typeof,ge){case l:case k:case W:case B:case y:return ge;default:return Ae}}case r:return Ae}}}function ke(ge){return we(ge)===C}return Di.AsyncMode=E,Di.ConcurrentMode=C,Di.ContextConsumer=l,Di.ContextProvider=y,Di.Element=e,Di.ForwardRef=k,Di.Fragment=u,Di.Lazy=W,Di.Memo=B,Di.Portal=r,Di.Profiler=m,Di.StrictMode=d,Di.Suspense=N,Di.isAsyncMode=function(ge){return ke(ge)||we(ge)===E},Di.isConcurrentMode=ke,Di.isContextConsumer=function(ge){return we(ge)===l},Di.isContextProvider=function(ge){return we(ge)===y},Di.isElement=function(ge){return typeof ge=="object"&&ge!==null&&ge.$$typeof===e},Di.isForwardRef=function(ge){return we(ge)===k},Di.isFragment=function(ge){return we(ge)===u},Di.isLazy=function(ge){return we(ge)===W},Di.isMemo=function(ge){return we(ge)===B},Di.isPortal=function(ge){return we(ge)===r},Di.isProfiler=function(ge){return we(ge)===m},Di.isStrictMode=function(ge){return we(ge)===d},Di.isSuspense=function(ge){return we(ge)===N},Di.isValidElementType=function(ge){return typeof ge=="string"||typeof ge=="function"||ge===u||ge===C||ge===m||ge===d||ge===N||ge===F||typeof ge=="object"&&ge!==null&&(ge.$$typeof===W||ge.$$typeof===B||ge.$$typeof===y||ge.$$typeof===l||ge.$$typeof===k||ge.$$typeof===ie||ge.$$typeof===de||ge.$$typeof===Ee||ge.$$typeof===re)},Di.typeOf=we,Di}var uT;function uL(){return uT||(uT=1,vx.exports=cL()),vx.exports}var bx,hT;function hL(){if(hT)return bx;hT=1;var n=uL(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},u={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},d={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},m={};m[n.ForwardRef]=u,m[n.Memo]=d;function y(W){return n.isMemo(W)?d:m[W.$$typeof]||e}var l=Object.defineProperty,E=Object.getOwnPropertyNames,C=Object.getOwnPropertySymbols,k=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,F=Object.prototype;function B(W,re,ie){if(typeof re!="string"){if(F){var de=N(re);de&&de!==F&&B(W,de,ie)}var Ee=E(re);C&&(Ee=Ee.concat(C(re)));for(var we=y(W),ke=y(re),ge=0;ge<Ee.length;++ge){var Ae=Ee[ge];if(!r[Ae]&&!(ie&&ie[Ae])&&!(ke&&ke[Ae])&&!(we&&we[Ae])){var Ge=k(re,Ae);try{l(W,Ae,Ge)}catch{}}}}return W}return bx=B,bx}hL();var dL=!0;function fL(n,e,r){var u="";return r.split(" ").forEach(function(d){n[d]!==void 0?e.push(n[d]+";"):d&&(u+=d+" ")}),u}var jM=function(e,r,u){var d=e.key+"-"+r.name;(u===!1||dL===!1)&&e.registered[d]===void 0&&(e.registered[d]=r.styles)},pL=function(e,r,u){jM(e,r,u);var d=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var m=r;do e.insert(r===m?"."+d:"",m,e.sheet,!0),m=m.next;while(m!==void 0)}};function mL(n){for(var e=0,r,u=0,d=n.length;d>=4;++u,d-=4)r=n.charCodeAt(u)&255|(n.charCodeAt(++u)&255)<<8|(n.charCodeAt(++u)&255)<<16|(n.charCodeAt(++u)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(d){case 3:e^=(n.charCodeAt(u+2)&255)<<16;case 2:e^=(n.charCodeAt(u+1)&255)<<8;case 1:e^=n.charCodeAt(u)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var gL={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},yL=/[A-Z]|^ms/g,_L=/_EMO_([^_]+?)_([^]*?)_EMO_/g,FM=function(e){return e.charCodeAt(1)===45},dT=function(e){return e!=null&&typeof e!="boolean"},xx=eL(function(n){return FM(n)?n:n.replace(yL,"-$&").toLowerCase()}),fT=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(_L,function(u,d,m){return Uu={name:d,styles:m,next:Uu},d})}return gL[e]!==1&&!FM(e)&&typeof r=="number"&&r!==0?r+"px":r};function N0(n,e,r){if(r==null)return"";var u=r;if(u.__emotion_styles!==void 0)return u;switch(typeof r){case"boolean":return"";case"object":{var d=r;if(d.anim===1)return Uu={name:d.name,styles:d.styles,next:Uu},d.name;var m=r;if(m.styles!==void 0){var y=m.next;if(y!==void 0)for(;y!==void 0;)Uu={name:y.name,styles:y.styles,next:Uu},y=y.next;var l=m.styles+";";return l}return vL(n,e,r)}case"function":{if(n!==void 0){var E=Uu,C=r(n);return Uu=E,N0(n,e,C)}break}}var k=r;return k}function vL(n,e,r){var u="";if(Array.isArray(r))for(var d=0;d<r.length;d++)u+=N0(n,e,r[d])+";";else for(var m in r){var y=r[m];if(typeof y!="object"){var l=y;dT(l)&&(u+=xx(m)+":"+fT(m,l)+";")}else if(Array.isArray(y)&&typeof y[0]=="string"&&e==null)for(var E=0;E<y.length;E++)dT(y[E])&&(u+=xx(m)+":"+fT(m,y[E])+";");else{var C=N0(n,e,y);switch(m){case"animation":case"animationName":{u+=xx(m)+":"+C+";";break}default:u+=m+"{"+C+"}"}}}return u}var pT=/label:\s*([^\s;{]+)\s*(;|$)/g,Uu;function BM(n,e,r){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var u=!0,d="";Uu=void 0;var m=n[0];if(m==null||m.raw===void 0)u=!1,d+=N0(r,e,m);else{var y=m;d+=y[0]}for(var l=1;l<n.length;l++)if(d+=N0(r,e,n[l]),u){var E=m;d+=E[l]}pT.lastIndex=0;for(var C="",k;(k=pT.exec(d))!==null;)C+="-"+k[1];var N=mL(d)+C;return{name:N,styles:d,next:Uu}}var bL=function(e){return e()},xL=Uw.useInsertionEffect?Uw.useInsertionEffect:!1,wL=xL||bL,UM=K.createContext(typeof HTMLElement<"u"?lL({key:"css"}):null);UM.Provider;var TL=function(e){return K.forwardRef(function(r,u){var d=K.useContext(UM);return e(r,d,u)})},SL=K.createContext({}),uw={}.hasOwnProperty,t1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",EL=function(e,r){var u={};for(var d in r)uw.call(r,d)&&(u[d]=r[d]);return u[t1]=e,u},ML=function(e){var r=e.cache,u=e.serialized,d=e.isStringTag;return jM(r,u,d),wL(function(){return pL(r,u,d)}),null},AL=TL(function(n,e,r){var u=n.css;typeof u=="string"&&e.registered[u]!==void 0&&(u=e.registered[u]);var d=n[t1],m=[u],y="";typeof n.className=="string"?y=fL(e.registered,m,n.className):n.className!=null&&(y=n.className+" ");var l=BM(m,void 0,K.useContext(SL));y+=e.key+"-"+l.name;var E={};for(var C in n)uw.call(n,C)&&C!=="css"&&C!==t1&&(E[C]=n[C]);return E.className=y,r&&(E.ref=r),K.createElement(K.Fragment,null,K.createElement(ML,{cache:e,serialized:l,isStringTag:typeof d=="string"}),K.createElement(d,E))}),CL=AL,nn=function(e,r){var u=arguments;if(r==null||!uw.call(r,"css"))return K.createElement.apply(void 0,u);var d=u.length,m=new Array(d);m[0]=CL,m[1]=EL(e,r);for(var y=2;y<d;y++)m[y]=u[y];return K.createElement.apply(null,m)};(function(n){var e;e||(e=n.JSX||(n.JSX={}))})(nn||(nn={}));function hw(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return BM(e)}function DL(){var n=hw.apply(void 0,arguments),e="animation-"+n.name;return{name:e,styles:"@keyframes "+e+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function IL(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}const RL=Math.min,kL=Math.max,jv=Math.round,pv=Math.floor,Fv=n=>({x:n,y:n});function PL(n){const{x:e,y:r,width:u,height:d}=n;return{width:u,height:d,top:r,left:e,right:e+u,bottom:r+d,x:e,y:r}}function vb(){return typeof window<"u"}function VM(n){return $M(n)?(n.nodeName||"").toLowerCase():"#document"}function xd(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function GM(n){var e;return(e=($M(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function $M(n){return vb()?n instanceof Node||n instanceof xd(n).Node:!1}function OL(n){return vb()?n instanceof Element||n instanceof xd(n).Element:!1}function dw(n){return vb()?n instanceof HTMLElement||n instanceof xd(n).HTMLElement:!1}function mT(n){return!vb()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof xd(n).ShadowRoot}function ZM(n){const{overflow:e,overflowX:r,overflowY:u,display:d}=fw(n);return/auto|scroll|overlay|hidden|clip/.test(e+u+r)&&!["inline","contents"].includes(d)}function LL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function NL(n){return["html","body","#document"].includes(VM(n))}function fw(n){return xd(n).getComputedStyle(n)}function zL(n){if(VM(n)==="html")return n;const e=n.assignedSlot||n.parentNode||mT(n)&&n.host||GM(n);return mT(e)?e.host:e}function YM(n){const e=zL(n);return NL(e)?n.ownerDocument?n.ownerDocument.body:n.body:dw(e)&&ZM(e)?e:YM(e)}function Bv(n,e,r){var u;e===void 0&&(e=[]),r===void 0&&(r=!0);const d=YM(n),m=d===((u=n.ownerDocument)==null?void 0:u.body),y=xd(d);if(m){const l=n1(y);return e.concat(y,y.visualViewport||[],ZM(d)?d:[],l&&r?Bv(l):[])}return e.concat(d,Bv(d,[],r))}function n1(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function jL(n){const e=fw(n);let r=parseFloat(e.width)||0,u=parseFloat(e.height)||0;const d=dw(n),m=d?n.offsetWidth:r,y=d?n.offsetHeight:u,l=jv(r)!==m||jv(u)!==y;return l&&(r=m,u=y),{width:r,height:u,$:l}}function pw(n){return OL(n)?n:n.contextElement}function gT(n){const e=pw(n);if(!dw(e))return Fv(1);const r=e.getBoundingClientRect(),{width:u,height:d,$:m}=jL(e);let y=(m?jv(r.width):r.width)/u,l=(m?jv(r.height):r.height)/d;return(!y||!Number.isFinite(y))&&(y=1),(!l||!Number.isFinite(l))&&(l=1),{x:y,y:l}}const FL=Fv(0);function BL(n){const e=xd(n);return!LL()||!e.visualViewport?FL:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function UL(n,e,r){return!1}function yT(n,e,r,u){e===void 0&&(e=!1);const d=n.getBoundingClientRect(),m=pw(n);let y=Fv(1);e&&(y=gT(n));const l=UL()?BL(m):Fv(0);let E=(d.left+l.x)/y.x,C=(d.top+l.y)/y.y,k=d.width/y.x,N=d.height/y.y;if(m){const F=xd(m),B=u;let W=F,re=n1(W);for(;re&&u&&B!==W;){const ie=gT(re),de=re.getBoundingClientRect(),Ee=fw(re),we=de.left+(re.clientLeft+parseFloat(Ee.paddingLeft))*ie.x,ke=de.top+(re.clientTop+parseFloat(Ee.paddingTop))*ie.y;E*=ie.x,C*=ie.y,k*=ie.x,N*=ie.y,E+=we,C+=ke,W=xd(re),re=n1(W)}}return PL({width:k,height:N,x:E,y:C})}function VL(n,e){let r=null,u;const d=GM(n);function m(){var l;clearTimeout(u),(l=r)==null||l.disconnect(),r=null}function y(l,E){l===void 0&&(l=!1),E===void 0&&(E=1),m();const{left:C,top:k,width:N,height:F}=n.getBoundingClientRect();if(l||e(),!N||!F)return;const B=pv(k),W=pv(d.clientWidth-(C+N)),re=pv(d.clientHeight-(k+F)),ie=pv(C),Ee={rootMargin:-B+"px "+-W+"px "+-re+"px "+-ie+"px",threshold:kL(0,RL(1,E))||1};let we=!0;function ke(ge){const Ae=ge[0].intersectionRatio;if(Ae!==E){if(!we)return y();Ae?y(!1,Ae):u=setTimeout(()=>{y(!1,1e-7)},1e3)}we=!1}try{r=new IntersectionObserver(ke,{...Ee,root:d.ownerDocument})}catch{r=new IntersectionObserver(ke,Ee)}r.observe(n)}return y(!0),m}function GL(n,e,r,u){u===void 0&&(u={});const{ancestorScroll:d=!0,ancestorResize:m=!0,elementResize:y=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:E=!1}=u,C=pw(n),k=d||m?[...C?Bv(C):[],...Bv(e)]:[];k.forEach(de=>{d&&de.addEventListener("scroll",r,{passive:!0}),m&&de.addEventListener("resize",r)});const N=C&&l?VL(C,r):null;let F=-1,B=null;y&&(B=new ResizeObserver(de=>{let[Ee]=de;Ee&&Ee.target===C&&B&&(B.unobserve(e),cancelAnimationFrame(F),F=requestAnimationFrame(()=>{var we;(we=B)==null||we.observe(e)})),r()}),C&&!E&&B.observe(C),B.observe(e));let W,re=E?yT(n):null;E&&ie();function ie(){const de=yT(n);re&&(de.x!==re.x||de.y!==re.y||de.width!==re.width||de.height!==re.height)&&r(),re=de,W=requestAnimationFrame(ie)}return r(),()=>{var de;k.forEach(Ee=>{d&&Ee.removeEventListener("scroll",r),m&&Ee.removeEventListener("resize",r)}),N?.(),(de=B)==null||de.disconnect(),B=null,E&&cancelAnimationFrame(W)}}var i1=K.useLayoutEffect,$L=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Uv=function(){};function ZL(n,e){return e?e[0]==="-"?n+e:n+"__"+e:n}function YL(n,e){for(var r=arguments.length,u=new Array(r>2?r-2:0),d=2;d<r;d++)u[d-2]=arguments[d];var m=[].concat(u);if(e&&n)for(var y in e)e.hasOwnProperty(y)&&e[y]&&m.push("".concat(ZL(n,y)));return m.filter(function(l){return l}).map(function(l){return String(l).trim()}).join(" ")}var _T=function(e){return tN(e)?e.filter(Boolean):Bp(e)==="object"&&e!==null?[e]:[]},HM=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var r=Ed(e,$L);return dn({},r)},Vr=function(e,r,u){var d=e.cx,m=e.getStyles,y=e.getClassNames,l=e.className;return{css:m(r,e),className:d(u??{},y(r,e),l)}};function bb(n){return[document.documentElement,document.body,window].indexOf(n)>-1}function HL(n){return bb(n)?window.innerHeight:n.clientHeight}function qM(n){return bb(n)?window.pageYOffset:n.scrollTop}function Vv(n,e){if(bb(n)){window.scrollTo(0,e);return}n.scrollTop=e}function qL(n){var e=getComputedStyle(n),r=e.position==="absolute",u=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var d=n;d=d.parentElement;)if(e=getComputedStyle(d),!(r&&e.position==="static")&&u.test(e.overflow+e.overflowY+e.overflowX))return d;return document.documentElement}function XL(n,e,r,u){return r*((n=n/u-1)*n*n+1)+e}function mv(n,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Uv,d=qM(n),m=e-d,y=10,l=0;function E(){l+=y;var C=XL(l,d,m,r);Vv(n,C),l<r?window.requestAnimationFrame(E):u(n)}E()}function vT(n,e){var r=n.getBoundingClientRect(),u=e.getBoundingClientRect(),d=e.offsetHeight/3;u.bottom+d>r.bottom?Vv(n,Math.min(e.offsetTop+e.clientHeight-n.offsetHeight+d,n.scrollHeight)):u.top-d<r.top&&Vv(n,Math.max(e.offsetTop-d,0))}function WL(n){var e=n.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function bT(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function QL(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var XM=!1,KL={get passive(){return XM=!0}},gv=typeof window<"u"?window:{};gv.addEventListener&&gv.removeEventListener&&(gv.addEventListener("p",Uv,KL),gv.removeEventListener("p",Uv,!1));var JL=XM;function eN(n){return n!=null}function tN(n){return Array.isArray(n)}function yv(n,e,r){return n?e:r}var nN=function(e){for(var r=arguments.length,u=new Array(r>1?r-1:0),d=1;d<r;d++)u[d-1]=arguments[d];var m=Object.entries(e).filter(function(y){var l=fd(y,1),E=l[0];return!u.includes(E)});return m.reduce(function(y,l){var E=fd(l,2),C=E[0],k=E[1];return y[C]=k,y},{})},iN=["children","innerProps"],rN=["children","innerProps"];function aN(n){var e=n.maxHeight,r=n.menuEl,u=n.minHeight,d=n.placement,m=n.shouldScroll,y=n.isFixedPosition,l=n.controlHeight,E=qL(r),C={placement:"bottom",maxHeight:e};if(!r||!r.offsetParent)return C;var k=E.getBoundingClientRect(),N=k.height,F=r.getBoundingClientRect(),B=F.bottom,W=F.height,re=F.top,ie=r.offsetParent.getBoundingClientRect(),de=ie.top,Ee=y?window.innerHeight:HL(E),we=qM(E),ke=parseInt(getComputedStyle(r).marginBottom,10),ge=parseInt(getComputedStyle(r).marginTop,10),Ae=de-ge,Ge=Ee-re,at=Ae+we,Me=N-we-re,Qe=B-Ee+we+ke,St=we+re-ge,bt=160;switch(d){case"auto":case"bottom":if(Ge>=W)return{placement:"bottom",maxHeight:e};if(Me>=W&&!y)return m&&mv(E,Qe,bt),{placement:"bottom",maxHeight:e};if(!y&&Me>=u||y&&Ge>=u){m&&mv(E,Qe,bt);var zt=y?Ge-ke:Me-ke;return{placement:"bottom",maxHeight:zt}}if(d==="auto"||y){var Zt=e,Ft=y?Ae:at;return Ft>=u&&(Zt=Math.min(Ft-ke-l,e)),{placement:"top",maxHeight:Zt}}if(d==="bottom")return m&&Vv(E,Qe),{placement:"bottom",maxHeight:e};break;case"top":if(Ae>=W)return{placement:"top",maxHeight:e};if(at>=W&&!y)return m&&mv(E,St,bt),{placement:"top",maxHeight:e};if(!y&&at>=u||y&&Ae>=u){var Be=e;return(!y&&at>=u||y&&Ae>=u)&&(Be=y?Ae-ge:at-ge),m&&mv(E,St,bt),{placement:"top",maxHeight:Be}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(d,'".'))}return C}function oN(n){var e={bottom:"top",top:"bottom"};return n?e[n]:"bottom"}var WM=function(e){return e==="auto"?"bottom":e},sN=function(e,r){var u,d=e.placement,m=e.theme,y=m.borderRadius,l=m.spacing,E=m.colors;return dn((u={label:"menu"},d0(u,oN(d),"100%"),d0(u,"position","absolute"),d0(u,"width","100%"),d0(u,"zIndex",1),u),r?{}:{backgroundColor:E.neutral0,borderRadius:y,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:l.menuGutter,marginTop:l.menuGutter})},QM=K.createContext(null),lN=function(e){var r=e.children,u=e.minMenuHeight,d=e.maxMenuHeight,m=e.menuPlacement,y=e.menuPosition,l=e.menuShouldScrollIntoView,E=e.theme,C=K.useContext(QM)||{},k=C.setPortalPlacement,N=K.useRef(null),F=K.useState(d),B=fd(F,2),W=B[0],re=B[1],ie=K.useState(null),de=fd(ie,2),Ee=de[0],we=de[1],ke=E.spacing.controlHeight;return i1(function(){var ge=N.current;if(ge){var Ae=y==="fixed",Ge=l&&!Ae,at=aN({maxHeight:d,menuEl:ge,minHeight:u,placement:m,shouldScroll:Ge,isFixedPosition:Ae,controlHeight:ke});re(at.maxHeight),we(at.placement),k?.(at.placement)}},[d,m,y,l,u,k,ke]),r({ref:N,placerProps:dn(dn({},e),{},{placement:Ee||WM(m),maxHeight:W})})},cN=function(e){var r=e.children,u=e.innerRef,d=e.innerProps;return nn("div",pn({},Vr(e,"menu",{menu:!0}),{ref:u},d),r)},uN=cN,hN=function(e,r){var u=e.maxHeight,d=e.theme.spacing.baseUnit;return dn({maxHeight:u,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r?{}:{paddingBottom:d,paddingTop:d})},dN=function(e){var r=e.children,u=e.innerProps,d=e.innerRef,m=e.isMulti;return nn("div",pn({},Vr(e,"menuList",{"menu-list":!0,"menu-list--is-multi":m}),{ref:d},u),r)},KM=function(e,r){var u=e.theme,d=u.spacing.baseUnit,m=u.colors;return dn({textAlign:"center"},r?{}:{color:m.neutral40,padding:"".concat(d*2,"px ").concat(d*3,"px")})},fN=KM,pN=KM,mN=function(e){var r=e.children,u=r===void 0?"No options":r,d=e.innerProps,m=Ed(e,iN);return nn("div",pn({},Vr(dn(dn({},m),{},{children:u,innerProps:d}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),d),u)},gN=function(e){var r=e.children,u=r===void 0?"Loading...":r,d=e.innerProps,m=Ed(e,rN);return nn("div",pn({},Vr(dn(dn({},m),{},{children:u,innerProps:d}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),d),u)},yN=function(e){var r=e.rect,u=e.offset,d=e.position;return{left:r.left,position:d,top:u,width:r.width,zIndex:1}},_N=function(e){var r=e.appendTo,u=e.children,d=e.controlElement,m=e.innerProps,y=e.menuPlacement,l=e.menuPosition,E=K.useRef(null),C=K.useRef(null),k=K.useState(WM(y)),N=fd(k,2),F=N[0],B=N[1],W=K.useMemo(function(){return{setPortalPlacement:B}},[]),re=K.useState(null),ie=fd(re,2),de=ie[0],Ee=ie[1],we=K.useCallback(function(){if(d){var Ge=WL(d),at=l==="fixed"?0:window.pageYOffset,Me=Ge[F]+at;(Me!==de?.offset||Ge.left!==de?.rect.left||Ge.width!==de?.rect.width)&&Ee({offset:Me,rect:Ge})}},[d,l,F,de?.offset,de?.rect.left,de?.rect.width]);i1(function(){we()},[we]);var ke=K.useCallback(function(){typeof C.current=="function"&&(C.current(),C.current=null),d&&E.current&&(C.current=GL(d,E.current,we,{elementResize:"ResizeObserver"in window}))},[d,we]);i1(function(){ke()},[ke]);var ge=K.useCallback(function(Ge){E.current=Ge,ke()},[ke]);if(!r&&l!=="fixed"||!de)return null;var Ae=nn("div",pn({ref:ge},Vr(dn(dn({},e),{},{offset:de.offset,position:l,rect:de.rect}),"menuPortal",{"menu-portal":!0}),m),u);return nn(QM.Provider,{value:W},r?nb.createPortal(Ae,r):Ae)},vN=function(e){var r=e.isDisabled,u=e.isRtl;return{label:"container",direction:u?"rtl":void 0,pointerEvents:r?"none":void 0,position:"relative"}},bN=function(e){var r=e.children,u=e.innerProps,d=e.isDisabled,m=e.isRtl;return nn("div",pn({},Vr(e,"container",{"--is-disabled":d,"--is-rtl":m}),u),r)},xN=function(e,r){var u=e.theme.spacing,d=e.isMulti,m=e.hasValue,y=e.selectProps.controlShouldRenderValue;return dn({alignItems:"center",display:d&&m&&y?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},r?{}:{padding:"".concat(u.baseUnit/2,"px ").concat(u.baseUnit*2,"px")})},wN=function(e){var r=e.children,u=e.innerProps,d=e.isMulti,m=e.hasValue;return nn("div",pn({},Vr(e,"valueContainer",{"value-container":!0,"value-container--is-multi":d,"value-container--has-value":m}),u),r)},TN=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},SN=function(e){var r=e.children,u=e.innerProps;return nn("div",pn({},Vr(e,"indicatorsContainer",{indicators:!0}),u),r)},xT,EN=["size"],MN=["innerProps","isRtl","size"],AN={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},JM=function(e){var r=e.size,u=Ed(e,EN);return nn("svg",pn({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:AN},u))},mw=function(e){return nn(JM,pn({size:20},e),nn("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},eA=function(e){return nn(JM,pn({size:20},e),nn("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},tA=function(e,r){var u=e.isFocused,d=e.theme,m=d.spacing.baseUnit,y=d.colors;return dn({label:"indicatorContainer",display:"flex",transition:"color 150ms"},r?{}:{color:u?y.neutral60:y.neutral20,padding:m*2,":hover":{color:u?y.neutral80:y.neutral40}})},CN=tA,DN=function(e){var r=e.children,u=e.innerProps;return nn("div",pn({},Vr(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),u),r||nn(eA,null))},IN=tA,RN=function(e){var r=e.children,u=e.innerProps;return nn("div",pn({},Vr(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),u),r||nn(mw,null))},kN=function(e,r){var u=e.isDisabled,d=e.theme,m=d.spacing.baseUnit,y=d.colors;return dn({label:"indicatorSeparator",alignSelf:"stretch",width:1},r?{}:{backgroundColor:u?y.neutral10:y.neutral20,marginBottom:m*2,marginTop:m*2})},PN=function(e){var r=e.innerProps;return nn("span",pn({},r,Vr(e,"indicatorSeparator",{"indicator-separator":!0})))},ON=DL(xT||(xT=IL([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),LN=function(e,r){var u=e.isFocused,d=e.size,m=e.theme,y=m.colors,l=m.spacing.baseUnit;return dn({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:d,lineHeight:1,marginRight:d,textAlign:"center",verticalAlign:"middle"},r?{}:{color:u?y.neutral60:y.neutral20,padding:l*2})},wx=function(e){var r=e.delay,u=e.offset;return nn("span",{css:hw({animation:"".concat(ON," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:u?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},NN=function(e){var r=e.innerProps,u=e.isRtl,d=e.size,m=d===void 0?4:d,y=Ed(e,MN);return nn("div",pn({},Vr(dn(dn({},y),{},{innerProps:r,isRtl:u,size:m}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),r),nn(wx,{delay:0,offset:u}),nn(wx,{delay:160,offset:!0}),nn(wx,{delay:320,offset:!u}))},zN=function(e,r){var u=e.isDisabled,d=e.isFocused,m=e.theme,y=m.colors,l=m.borderRadius,E=m.spacing;return dn({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:E.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},r?{}:{backgroundColor:u?y.neutral5:y.neutral0,borderColor:u?y.neutral10:d?y.primary:y.neutral20,borderRadius:l,borderStyle:"solid",borderWidth:1,boxShadow:d?"0 0 0 1px ".concat(y.primary):void 0,"&:hover":{borderColor:d?y.primary:y.neutral30}})},jN=function(e){var r=e.children,u=e.isDisabled,d=e.isFocused,m=e.innerRef,y=e.innerProps,l=e.menuIsOpen;return nn("div",pn({ref:m},Vr(e,"control",{control:!0,"control--is-disabled":u,"control--is-focused":d,"control--menu-is-open":l}),y,{"aria-disabled":u||void 0}),r)},FN=jN,BN=["data"],UN=function(e,r){var u=e.theme.spacing;return r?{}:{paddingBottom:u.baseUnit*2,paddingTop:u.baseUnit*2}},VN=function(e){var r=e.children,u=e.cx,d=e.getStyles,m=e.getClassNames,y=e.Heading,l=e.headingProps,E=e.innerProps,C=e.label,k=e.theme,N=e.selectProps;return nn("div",pn({},Vr(e,"group",{group:!0}),E),nn(y,pn({},l,{selectProps:N,theme:k,getStyles:d,getClassNames:m,cx:u}),C),nn("div",null,r))},GN=function(e,r){var u=e.theme,d=u.colors,m=u.spacing;return dn({label:"group",cursor:"default",display:"block"},r?{}:{color:d.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:m.baseUnit*3,paddingRight:m.baseUnit*3,textTransform:"uppercase"})},$N=function(e){var r=HM(e);r.data;var u=Ed(r,BN);return nn("div",pn({},Vr(e,"groupHeading",{"group-heading":!0}),u))},ZN=VN,YN=["innerRef","isDisabled","isHidden","inputClassName"],HN=function(e,r){var u=e.isDisabled,d=e.value,m=e.theme,y=m.spacing,l=m.colors;return dn(dn({visibility:u?"hidden":"visible",transform:d?"translateZ(0)":""},qN),r?{}:{margin:y.baseUnit/2,paddingBottom:y.baseUnit/2,paddingTop:y.baseUnit/2,color:l.neutral80})},nA={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},qN={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":dn({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},nA)},XN=function(e){return dn({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},nA)},WN=function(e){var r=e.cx,u=e.value,d=HM(e),m=d.innerRef,y=d.isDisabled,l=d.isHidden,E=d.inputClassName,C=Ed(d,YN);return nn("div",pn({},Vr(e,"input",{"input-container":!0}),{"data-value":u||""}),nn("input",pn({className:r({input:!0},E),ref:m,style:XN(l),disabled:y},C)))},QN=WN,KN=function(e,r){var u=e.theme,d=u.spacing,m=u.borderRadius,y=u.colors;return dn({label:"multiValue",display:"flex",minWidth:0},r?{}:{backgroundColor:y.neutral10,borderRadius:m/2,margin:d.baseUnit/2})},JN=function(e,r){var u=e.theme,d=u.borderRadius,m=u.colors,y=e.cropWithEllipsis;return dn({overflow:"hidden",textOverflow:y||y===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},r?{}:{borderRadius:d/2,color:m.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},ez=function(e,r){var u=e.theme,d=u.spacing,m=u.borderRadius,y=u.colors,l=e.isFocused;return dn({alignItems:"center",display:"flex"},r?{}:{borderRadius:m/2,backgroundColor:l?y.dangerLight:void 0,paddingLeft:d.baseUnit,paddingRight:d.baseUnit,":hover":{backgroundColor:y.dangerLight,color:y.danger}})},iA=function(e){var r=e.children,u=e.innerProps;return nn("div",u,r)},tz=iA,nz=iA;function iz(n){var e=n.children,r=n.innerProps;return nn("div",pn({role:"button"},r),e||nn(mw,{size:14}))}var rz=function(e){var r=e.children,u=e.components,d=e.data,m=e.innerProps,y=e.isDisabled,l=e.removeProps,E=e.selectProps,C=u.Container,k=u.Label,N=u.Remove;return nn(C,{data:d,innerProps:dn(dn({},Vr(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":y})),m),selectProps:E},nn(k,{data:d,innerProps:dn({},Vr(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:E},r),nn(N,{data:d,innerProps:dn(dn({},Vr(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(r||"option")},l),selectProps:E}))},az=rz,oz=function(e,r){var u=e.isDisabled,d=e.isFocused,m=e.isSelected,y=e.theme,l=y.spacing,E=y.colors;return dn({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},r?{}:{backgroundColor:m?E.primary:d?E.primary25:"transparent",color:u?E.neutral20:m?E.neutral0:"inherit",padding:"".concat(l.baseUnit*2,"px ").concat(l.baseUnit*3,"px"),":active":{backgroundColor:u?void 0:m?E.primary:E.primary50}})},sz=function(e){var r=e.children,u=e.isDisabled,d=e.isFocused,m=e.isSelected,y=e.innerRef,l=e.innerProps;return nn("div",pn({},Vr(e,"option",{option:!0,"option--is-disabled":u,"option--is-focused":d,"option--is-selected":m}),{ref:y,"aria-disabled":u},l),r)},lz=sz,cz=function(e,r){var u=e.theme,d=u.spacing,m=u.colors;return dn({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},r?{}:{color:m.neutral50,marginLeft:d.baseUnit/2,marginRight:d.baseUnit/2})},uz=function(e){var r=e.children,u=e.innerProps;return nn("div",pn({},Vr(e,"placeholder",{placeholder:!0}),u),r)},hz=uz,dz=function(e,r){var u=e.isDisabled,d=e.theme,m=d.spacing,y=d.colors;return dn({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r?{}:{color:u?y.neutral40:y.neutral80,marginLeft:m.baseUnit/2,marginRight:m.baseUnit/2})},fz=function(e){var r=e.children,u=e.isDisabled,d=e.innerProps;return nn("div",pn({},Vr(e,"singleValue",{"single-value":!0,"single-value--is-disabled":u}),d),r)},pz=fz,mz={ClearIndicator:RN,Control:FN,DropdownIndicator:DN,DownChevron:eA,CrossIcon:mw,Group:ZN,GroupHeading:$N,IndicatorsContainer:SN,IndicatorSeparator:PN,Input:QN,LoadingIndicator:NN,Menu:uN,MenuList:dN,MenuPortal:_N,LoadingMessage:gN,NoOptionsMessage:mN,MultiValue:az,MultiValueContainer:tz,MultiValueLabel:nz,MultiValueRemove:iz,Option:lz,Placeholder:hz,SelectContainer:bN,SingleValue:pz,ValueContainer:wN},gz=function(e){return dn(dn({},mz),e.components)},wT=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function yz(n,e){return!!(n===e||wT(n)&&wT(e))}function _z(n,e){if(n.length!==e.length)return!1;for(var r=0;r<n.length;r++)if(!yz(n[r],e[r]))return!1;return!0}function vz(n,e){e===void 0&&(e=_z);var r=null;function u(){for(var d=[],m=0;m<arguments.length;m++)d[m]=arguments[m];if(r&&r.lastThis===this&&e(d,r.lastArgs))return r.lastResult;var y=n.apply(this,d);return r={lastResult:y,lastArgs:d,lastThis:this},y}return u.clear=function(){r=null},u}var bz={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},xz=function(e){return nn("span",pn({css:bz},e))},TT=xz,wz={guidance:function(e){var r=e.isSearchable,u=e.isMulti,d=e.tabSelectsValue,m=e.context,y=e.isInitialFocus;switch(m){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(d?", press Tab to select the option and exit the menu":"",".");case"input":return y?"".concat(e["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(u?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var r=e.action,u=e.label,d=u===void 0?"":u,m=e.labels,y=e.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(d,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(m.length>1?"s":""," ").concat(m.join(","),", selected.");case"select-option":return y?"option ".concat(d," is disabled. Select another option."):"option ".concat(d,", selected.");default:return""}},onFocus:function(e){var r=e.context,u=e.focused,d=e.options,m=e.label,y=m===void 0?"":m,l=e.selectValue,E=e.isDisabled,C=e.isSelected,k=e.isAppleDevice,N=function(re,ie){return re&&re.length?"".concat(re.indexOf(ie)+1," of ").concat(re.length):""};if(r==="value"&&l)return"value ".concat(y," focused, ").concat(N(l,u),".");if(r==="menu"&&k){var F=E?" disabled":"",B="".concat(C?" selected":"").concat(F);return"".concat(y).concat(B,", ").concat(N(d,u),".")}return""},onFilter:function(e){var r=e.inputValue,u=e.resultsMessage;return"".concat(u).concat(r?" for search term "+r:"",".")}},Tz=function(e){var r=e.ariaSelection,u=e.focusedOption,d=e.focusedValue,m=e.focusableOptions,y=e.isFocused,l=e.selectValue,E=e.selectProps,C=e.id,k=e.isAppleDevice,N=E.ariaLiveMessages,F=E.getOptionLabel,B=E.inputValue,W=E.isMulti,re=E.isOptionDisabled,ie=E.isSearchable,de=E.menuIsOpen,Ee=E.options,we=E.screenReaderStatus,ke=E.tabSelectsValue,ge=E.isLoading,Ae=E["aria-label"],Ge=E["aria-live"],at=K.useMemo(function(){return dn(dn({},wz),N||{})},[N]),Me=K.useMemo(function(){var Ft="";if(r&&at.onChange){var Be=r.option,lt=r.options,_t=r.removedValue,ut=r.removedValues,Te=r.value,nt=function(Wt){return Array.isArray(Wt)?null:Wt},yt=_t||Be||nt(Te),pt=yt?F(yt):"",Et=lt||ut||void 0,Ut=Et?Et.map(F):[],Ot=dn({isDisabled:yt&&re(yt,l),label:pt,labels:Ut},r);Ft=at.onChange(Ot)}return Ft},[r,at,re,l,F]),Qe=K.useMemo(function(){var Ft="",Be=u||d,lt=!!(u&&l&&l.includes(u));if(Be&&at.onFocus){var _t={focused:Be,label:F(Be),isDisabled:re(Be,l),isSelected:lt,options:m,context:Be===u?"menu":"value",selectValue:l,isAppleDevice:k};Ft=at.onFocus(_t)}return Ft},[u,d,F,re,at,m,l,k]),St=K.useMemo(function(){var Ft="";if(de&&Ee.length&&!ge&&at.onFilter){var Be=we({count:m.length});Ft=at.onFilter({inputValue:B,resultsMessage:Be})}return Ft},[m,B,de,at,Ee,we,ge]),bt=r?.action==="initial-input-focus",zt=K.useMemo(function(){var Ft="";if(at.guidance){var Be=d?"value":de?"menu":"input";Ft=at.guidance({"aria-label":Ae,context:Be,isDisabled:u&&re(u,l),isMulti:W,isSearchable:ie,tabSelectsValue:ke,isInitialFocus:bt})}return Ft},[Ae,u,d,W,re,ie,de,at,l,ke,bt]),Zt=nn(K.Fragment,null,nn("span",{id:"aria-selection"},Me),nn("span",{id:"aria-focused"},Qe),nn("span",{id:"aria-results"},St),nn("span",{id:"aria-guidance"},zt));return nn(K.Fragment,null,nn(TT,{id:C},bt&&Zt),nn(TT,{"aria-live":Ge,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},y&&!bt&&Zt))},Sz=Tz,r1=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],Ez=new RegExp("["+r1.map(function(n){return n.letters}).join("")+"]","g"),rA={};for(var Tx=0;Tx<r1.length;Tx++)for(var Sx=r1[Tx],Ex=0;Ex<Sx.letters.length;Ex++)rA[Sx.letters[Ex]]=Sx.base;var aA=function(e){return e.replace(Ez,function(r){return rA[r]})},Mz=vz(aA),ST=function(e){return e.replace(/^\s+|\s+$/g,"")},Az=function(e){return"".concat(e.label," ").concat(e.value)},Cz=function(e){return function(r,u){if(r.data.__isNew__)return!0;var d=dn({ignoreCase:!0,ignoreAccents:!0,stringify:Az,trim:!0,matchFrom:"any"},e),m=d.ignoreCase,y=d.ignoreAccents,l=d.stringify,E=d.trim,C=d.matchFrom,k=E?ST(u):u,N=E?ST(l(r)):l(r);return m&&(k=k.toLowerCase(),N=N.toLowerCase()),y&&(k=Mz(k),N=aA(N)),C==="start"?N.substr(0,k.length)===k:N.indexOf(k)>-1}},Dz=["innerRef"];function Iz(n){var e=n.innerRef,r=Ed(n,Dz),u=nN(r,"onExited","in","enter","exit","appear");return nn("input",pn({ref:e},u,{css:hw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var Rz=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function kz(n){var e=n.isEnabled,r=n.onBottomArrive,u=n.onBottomLeave,d=n.onTopArrive,m=n.onTopLeave,y=K.useRef(!1),l=K.useRef(!1),E=K.useRef(0),C=K.useRef(null),k=K.useCallback(function(ie,de){if(C.current!==null){var Ee=C.current,we=Ee.scrollTop,ke=Ee.scrollHeight,ge=Ee.clientHeight,Ae=C.current,Ge=de>0,at=ke-ge-we,Me=!1;at>de&&y.current&&(u&&u(ie),y.current=!1),Ge&&l.current&&(m&&m(ie),l.current=!1),Ge&&de>at?(r&&!y.current&&r(ie),Ae.scrollTop=ke,Me=!0,y.current=!0):!Ge&&-de>we&&(d&&!l.current&&d(ie),Ae.scrollTop=0,Me=!0,l.current=!0),Me&&Rz(ie)}},[r,u,d,m]),N=K.useCallback(function(ie){k(ie,ie.deltaY)},[k]),F=K.useCallback(function(ie){E.current=ie.changedTouches[0].clientY},[]),B=K.useCallback(function(ie){var de=E.current-ie.changedTouches[0].clientY;k(ie,de)},[k]),W=K.useCallback(function(ie){if(ie){var de=JL?{passive:!1}:!1;ie.addEventListener("wheel",N,de),ie.addEventListener("touchstart",F,de),ie.addEventListener("touchmove",B,de)}},[B,F,N]),re=K.useCallback(function(ie){ie&&(ie.removeEventListener("wheel",N,!1),ie.removeEventListener("touchstart",F,!1),ie.removeEventListener("touchmove",B,!1))},[B,F,N]);return K.useEffect(function(){if(e){var ie=C.current;return W(ie),function(){re(ie)}}},[e,W,re]),function(ie){C.current=ie}}var ET=["boxSizing","height","overflow","paddingRight","position"],MT={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function AT(n){n.cancelable&&n.preventDefault()}function CT(n){n.stopPropagation()}function DT(){var n=this.scrollTop,e=this.scrollHeight,r=n+this.offsetHeight;n===0?this.scrollTop=1:r===e&&(this.scrollTop=n-1)}function IT(){return"ontouchstart"in window||navigator.maxTouchPoints}var RT=!!(typeof window<"u"&&window.document&&window.document.createElement),r0=0,fg={capture:!1,passive:!1};function Pz(n){var e=n.isEnabled,r=n.accountForScrollbars,u=r===void 0?!0:r,d=K.useRef({}),m=K.useRef(null),y=K.useCallback(function(E){if(RT){var C=document.body,k=C&&C.style;if(u&&ET.forEach(function(W){var re=k&&k[W];d.current[W]=re}),u&&r0<1){var N=parseInt(d.current.paddingRight,10)||0,F=document.body?document.body.clientWidth:0,B=window.innerWidth-F+N||0;Object.keys(MT).forEach(function(W){var re=MT[W];k&&(k[W]=re)}),k&&(k.paddingRight="".concat(B,"px"))}C&&IT()&&(C.addEventListener("touchmove",AT,fg),E&&(E.addEventListener("touchstart",DT,fg),E.addEventListener("touchmove",CT,fg))),r0+=1}},[u]),l=K.useCallback(function(E){if(RT){var C=document.body,k=C&&C.style;r0=Math.max(r0-1,0),u&&r0<1&&ET.forEach(function(N){var F=d.current[N];k&&(k[N]=F)}),C&&IT()&&(C.removeEventListener("touchmove",AT,fg),E&&(E.removeEventListener("touchstart",DT,fg),E.removeEventListener("touchmove",CT,fg)))}},[u]);return K.useEffect(function(){if(e){var E=m.current;return y(E),function(){l(E)}}},[e,y,l]),function(E){m.current=E}}var Oz=function(e){var r=e.target;return r.ownerDocument.activeElement&&r.ownerDocument.activeElement.blur()},Lz={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function Nz(n){var e=n.children,r=n.lockEnabled,u=n.captureEnabled,d=u===void 0?!0:u,m=n.onBottomArrive,y=n.onBottomLeave,l=n.onTopArrive,E=n.onTopLeave,C=kz({isEnabled:d,onBottomArrive:m,onBottomLeave:y,onTopArrive:l,onTopLeave:E}),k=Pz({isEnabled:r}),N=function(B){C(B),k(B)};return nn(K.Fragment,null,r&&nn("div",{onClick:Oz,css:Lz}),e(N))}var zz={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},jz=function(e){var r=e.name,u=e.onFocus;return nn("input",{required:!0,name:r,tabIndex:-1,"aria-hidden":"true",onFocus:u,css:zz,value:"",onChange:function(){}})},Fz=jz;function gw(n){var e;return typeof window<"u"&&window.navigator!=null?n.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Bz(){return gw(/^iPhone/i)}function oA(){return gw(/^Mac/i)}function Uz(){return gw(/^iPad/i)||oA()&&navigator.maxTouchPoints>1}function Vz(){return Bz()||Uz()}function Gz(){return oA()||Vz()}var $z=function(e){return e.label},Zz=function(e){return e.label},Yz=function(e){return e.value},Hz=function(e){return!!e.isDisabled},qz={clearIndicator:IN,container:vN,control:zN,dropdownIndicator:CN,group:UN,groupHeading:GN,indicatorsContainer:TN,indicatorSeparator:kN,input:HN,loadingIndicator:LN,loadingMessage:pN,menu:sN,menuList:hN,menuPortal:yN,multiValue:KN,multiValueLabel:JN,multiValueRemove:ez,noOptionsMessage:fN,option:oz,placeholder:cz,singleValue:dz,valueContainer:xN},Xz={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},Wz=4,sA=4,Qz=38,Kz=sA*2,Jz={baseUnit:sA,controlHeight:Qz,menuGutter:Kz},Mx={borderRadius:Wz,colors:Xz,spacing:Jz},e5={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:bT(),captureMenuScroll:!bT(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:Cz(),formatGroupLabel:$z,getOptionLabel:Zz,getOptionValue:Yz,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:Hz,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!QL(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var r=e.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function kT(n,e,r,u){var d=uA(n,e,r),m=hA(n,e,r),y=cA(n,e),l=Gv(n,e);return{type:"option",data:e,isDisabled:d,isSelected:m,label:y,value:l,index:u}}function Av(n,e){return n.options.map(function(r,u){if("options"in r){var d=r.options.map(function(y,l){return kT(n,y,e,l)}).filter(function(y){return OT(n,y)});return d.length>0?{type:"group",data:r,options:d,index:u}:void 0}var m=kT(n,r,e,u);return OT(n,m)?m:void 0}).filter(eN)}function lA(n){return n.reduce(function(e,r){return r.type==="group"?e.push.apply(e,ow(r.options.map(function(u){return u.data}))):e.push(r.data),e},[])}function PT(n,e){return n.reduce(function(r,u){return u.type==="group"?r.push.apply(r,ow(u.options.map(function(d){return{data:d.data,id:"".concat(e,"-").concat(u.index,"-").concat(d.index)}}))):r.push({data:u.data,id:"".concat(e,"-").concat(u.index)}),r},[])}function t5(n,e){return lA(Av(n,e))}function OT(n,e){var r=n.inputValue,u=r===void 0?"":r,d=e.data,m=e.isSelected,y=e.label,l=e.value;return(!fA(n)||!m)&&dA(n,{label:y,value:l,data:d},u)}function n5(n,e){var r=n.focusedValue,u=n.selectValue,d=u.indexOf(r);if(d>-1){var m=e.indexOf(r);if(m>-1)return r;if(d<e.length)return e[d]}return null}function i5(n,e){var r=n.focusedOption;return r&&e.indexOf(r)>-1?r:e[0]}var Ax=function(e,r){var u,d=(u=e.find(function(m){return m.data===r}))===null||u===void 0?void 0:u.id;return d||null},cA=function(e,r){return e.getOptionLabel(r)},Gv=function(e,r){return e.getOptionValue(r)};function uA(n,e,r){return typeof n.isOptionDisabled=="function"?n.isOptionDisabled(e,r):!1}function hA(n,e,r){if(r.indexOf(e)>-1)return!0;if(typeof n.isOptionSelected=="function")return n.isOptionSelected(e,r);var u=Gv(n,e);return r.some(function(d){return Gv(n,d)===u})}function dA(n,e,r){return n.filterOption?n.filterOption(e,r):!0}var fA=function(e){var r=e.hideSelectedOptions,u=e.isMulti;return r===void 0?u:r},r5=1,pA=function(n){MO(r,n);var e=DO(r);function r(u){var d;if(SO(this,r),d=e.call(this,u),d.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},d.blockOptionHover=!1,d.isComposing=!1,d.commonProps=void 0,d.initialTouchX=0,d.initialTouchY=0,d.openAfterFocus=!1,d.scrollToFocusedOptionOnUpdate=!1,d.userIsDragging=void 0,d.controlRef=null,d.getControlRef=function(E){d.controlRef=E},d.focusedOptionRef=null,d.getFocusedOptionRef=function(E){d.focusedOptionRef=E},d.menuListRef=null,d.getMenuListRef=function(E){d.menuListRef=E},d.inputRef=null,d.getInputRef=function(E){d.inputRef=E},d.focus=d.focusInput,d.blur=d.blurInput,d.onChange=function(E,C){var k=d.props,N=k.onChange,F=k.name;C.name=F,d.ariaOnChange(E,C),N(E,C)},d.setValue=function(E,C,k){var N=d.props,F=N.closeMenuOnSelect,B=N.isMulti,W=N.inputValue;d.onInputChange("",{action:"set-value",prevInputValue:W}),F&&(d.setState({inputIsHiddenAfterUpdate:!B}),d.onMenuClose()),d.setState({clearFocusValueOnUpdate:!0}),d.onChange(E,{action:C,option:k})},d.selectOption=function(E){var C=d.props,k=C.blurInputOnSelect,N=C.isMulti,F=C.name,B=d.state.selectValue,W=N&&d.isOptionSelected(E,B),re=d.isOptionDisabled(E,B);if(W){var ie=d.getOptionValue(E);d.setValue(B.filter(function(de){return d.getOptionValue(de)!==ie}),"deselect-option",E)}else if(!re)N?d.setValue([].concat(ow(B),[E]),"select-option",E):d.setValue(E,"select-option");else{d.ariaOnChange(E,{action:"select-option",option:E,name:F});return}k&&d.blurInput()},d.removeValue=function(E){var C=d.props.isMulti,k=d.state.selectValue,N=d.getOptionValue(E),F=k.filter(function(W){return d.getOptionValue(W)!==N}),B=yv(C,F,F[0]||null);d.onChange(B,{action:"remove-value",removedValue:E}),d.focusInput()},d.clearValue=function(){var E=d.state.selectValue;d.onChange(yv(d.props.isMulti,[],null),{action:"clear",removedValues:E})},d.popValue=function(){var E=d.props.isMulti,C=d.state.selectValue,k=C[C.length-1],N=C.slice(0,C.length-1),F=yv(E,N,N[0]||null);k&&d.onChange(F,{action:"pop-value",removedValue:k})},d.getFocusedOptionId=function(E){return Ax(d.state.focusableOptionsWithIds,E)},d.getFocusableOptionsWithIds=function(){return PT(Av(d.props,d.state.selectValue),d.getElementId("option"))},d.getValue=function(){return d.state.selectValue},d.cx=function(){for(var E=arguments.length,C=new Array(E),k=0;k<E;k++)C[k]=arguments[k];return YL.apply(void 0,[d.props.classNamePrefix].concat(C))},d.getOptionLabel=function(E){return cA(d.props,E)},d.getOptionValue=function(E){return Gv(d.props,E)},d.getStyles=function(E,C){var k=d.props.unstyled,N=qz[E](C,k);N.boxSizing="border-box";var F=d.props.styles[E];return F?F(N,C):N},d.getClassNames=function(E,C){var k,N;return(k=(N=d.props.classNames)[E])===null||k===void 0?void 0:k.call(N,C)},d.getElementId=function(E){return"".concat(d.state.instancePrefix,"-").concat(E)},d.getComponents=function(){return gz(d.props)},d.buildCategorizedOptions=function(){return Av(d.props,d.state.selectValue)},d.getCategorizedOptions=function(){return d.props.menuIsOpen?d.buildCategorizedOptions():[]},d.buildFocusableOptions=function(){return lA(d.buildCategorizedOptions())},d.getFocusableOptions=function(){return d.props.menuIsOpen?d.buildFocusableOptions():[]},d.ariaOnChange=function(E,C){d.setState({ariaSelection:dn({value:E},C)})},d.onMenuMouseDown=function(E){E.button===0&&(E.stopPropagation(),E.preventDefault(),d.focusInput())},d.onMenuMouseMove=function(E){d.blockOptionHover=!1},d.onControlMouseDown=function(E){if(!E.defaultPrevented){var C=d.props.openMenuOnClick;d.state.isFocused?d.props.menuIsOpen?E.target.tagName!=="INPUT"&&E.target.tagName!=="TEXTAREA"&&d.onMenuClose():C&&d.openMenu("first"):(C&&(d.openAfterFocus=!0),d.focusInput()),E.target.tagName!=="INPUT"&&E.target.tagName!=="TEXTAREA"&&E.preventDefault()}},d.onDropdownIndicatorMouseDown=function(E){if(!(E&&E.type==="mousedown"&&E.button!==0)&&!d.props.isDisabled){var C=d.props,k=C.isMulti,N=C.menuIsOpen;d.focusInput(),N?(d.setState({inputIsHiddenAfterUpdate:!k}),d.onMenuClose()):d.openMenu("first"),E.preventDefault()}},d.onClearIndicatorMouseDown=function(E){E&&E.type==="mousedown"&&E.button!==0||(d.clearValue(),E.preventDefault(),d.openAfterFocus=!1,E.type==="touchend"?d.focusInput():setTimeout(function(){return d.focusInput()}))},d.onScroll=function(E){typeof d.props.closeMenuOnScroll=="boolean"?E.target instanceof HTMLElement&&bb(E.target)&&d.props.onMenuClose():typeof d.props.closeMenuOnScroll=="function"&&d.props.closeMenuOnScroll(E)&&d.props.onMenuClose()},d.onCompositionStart=function(){d.isComposing=!0},d.onCompositionEnd=function(){d.isComposing=!1},d.onTouchStart=function(E){var C=E.touches,k=C&&C.item(0);k&&(d.initialTouchX=k.clientX,d.initialTouchY=k.clientY,d.userIsDragging=!1)},d.onTouchMove=function(E){var C=E.touches,k=C&&C.item(0);if(k){var N=Math.abs(k.clientX-d.initialTouchX),F=Math.abs(k.clientY-d.initialTouchY),B=5;d.userIsDragging=N>B||F>B}},d.onTouchEnd=function(E){d.userIsDragging||(d.controlRef&&!d.controlRef.contains(E.target)&&d.menuListRef&&!d.menuListRef.contains(E.target)&&d.blurInput(),d.initialTouchX=0,d.initialTouchY=0)},d.onControlTouchEnd=function(E){d.userIsDragging||d.onControlMouseDown(E)},d.onClearIndicatorTouchEnd=function(E){d.userIsDragging||d.onClearIndicatorMouseDown(E)},d.onDropdownIndicatorTouchEnd=function(E){d.userIsDragging||d.onDropdownIndicatorMouseDown(E)},d.handleInputChange=function(E){var C=d.props.inputValue,k=E.currentTarget.value;d.setState({inputIsHiddenAfterUpdate:!1}),d.onInputChange(k,{action:"input-change",prevInputValue:C}),d.props.menuIsOpen||d.onMenuOpen()},d.onInputFocus=function(E){d.props.onFocus&&d.props.onFocus(E),d.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(d.openAfterFocus||d.props.openMenuOnFocus)&&d.openMenu("first"),d.openAfterFocus=!1},d.onInputBlur=function(E){var C=d.props.inputValue;if(d.menuListRef&&d.menuListRef.contains(document.activeElement)){d.inputRef.focus();return}d.props.onBlur&&d.props.onBlur(E),d.onInputChange("",{action:"input-blur",prevInputValue:C}),d.onMenuClose(),d.setState({focusedValue:null,isFocused:!1})},d.onOptionHover=function(E){if(!(d.blockOptionHover||d.state.focusedOption===E)){var C=d.getFocusableOptions(),k=C.indexOf(E);d.setState({focusedOption:E,focusedOptionId:k>-1?d.getFocusedOptionId(E):null})}},d.shouldHideSelectedOptions=function(){return fA(d.props)},d.onValueInputFocus=function(E){E.preventDefault(),E.stopPropagation(),d.focus()},d.onKeyDown=function(E){var C=d.props,k=C.isMulti,N=C.backspaceRemovesValue,F=C.escapeClearsValue,B=C.inputValue,W=C.isClearable,re=C.isDisabled,ie=C.menuIsOpen,de=C.onKeyDown,Ee=C.tabSelectsValue,we=C.openMenuOnFocus,ke=d.state,ge=ke.focusedOption,Ae=ke.focusedValue,Ge=ke.selectValue;if(!re&&!(typeof de=="function"&&(de(E),E.defaultPrevented))){switch(d.blockOptionHover=!0,E.key){case"ArrowLeft":if(!k||B)return;d.focusValue("previous");break;case"ArrowRight":if(!k||B)return;d.focusValue("next");break;case"Delete":case"Backspace":if(B)return;if(Ae)d.removeValue(Ae);else{if(!N)return;k?d.popValue():W&&d.clearValue()}break;case"Tab":if(d.isComposing||E.shiftKey||!ie||!Ee||!ge||we&&d.isOptionSelected(ge,Ge))return;d.selectOption(ge);break;case"Enter":if(E.keyCode===229)break;if(ie){if(!ge||d.isComposing)return;d.selectOption(ge);break}return;case"Escape":ie?(d.setState({inputIsHiddenAfterUpdate:!1}),d.onInputChange("",{action:"menu-close",prevInputValue:B}),d.onMenuClose()):W&&F&&d.clearValue();break;case" ":if(B)return;if(!ie){d.openMenu("first");break}if(!ge)return;d.selectOption(ge);break;case"ArrowUp":ie?d.focusOption("up"):d.openMenu("last");break;case"ArrowDown":ie?d.focusOption("down"):d.openMenu("first");break;case"PageUp":if(!ie)return;d.focusOption("pageup");break;case"PageDown":if(!ie)return;d.focusOption("pagedown");break;case"Home":if(!ie)return;d.focusOption("first");break;case"End":if(!ie)return;d.focusOption("last");break;default:return}E.preventDefault()}},d.state.instancePrefix="react-select-"+(d.props.instanceId||++r5),d.state.selectValue=_T(u.value),u.menuIsOpen&&d.state.selectValue.length){var m=d.getFocusableOptionsWithIds(),y=d.buildFocusableOptions(),l=y.indexOf(d.state.selectValue[0]);d.state.focusableOptionsWithIds=m,d.state.focusedOption=y[l],d.state.focusedOptionId=Ax(m,y[l])}return d}return EO(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&vT(this.menuListRef,this.focusedOptionRef),Gz()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(d){var m=this.props,y=m.isDisabled,l=m.menuIsOpen,E=this.state.isFocused;(E&&!y&&d.isDisabled||E&&l&&!d.menuIsOpen)&&this.focusInput(),E&&y&&!d.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!E&&!y&&d.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(vT(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(d,m){this.props.onInputChange(d,m)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(d){var m=this,y=this.state,l=y.selectValue,E=y.isFocused,C=this.buildFocusableOptions(),k=d==="first"?0:C.length-1;if(!this.props.isMulti){var N=C.indexOf(l[0]);N>-1&&(k=N)}this.scrollToFocusedOptionOnUpdate=!(E&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:C[k],focusedOptionId:this.getFocusedOptionId(C[k])},function(){return m.onMenuOpen()})}},{key:"focusValue",value:function(d){var m=this.state,y=m.selectValue,l=m.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var E=y.indexOf(l);l||(E=-1);var C=y.length-1,k=-1;if(y.length){switch(d){case"previous":E===0?k=0:E===-1?k=C:k=E-1;break;case"next":E>-1&&E<C&&(k=E+1);break}this.setState({inputIsHidden:k!==-1,focusedValue:y[k]})}}}},{key:"focusOption",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",m=this.props.pageSize,y=this.state.focusedOption,l=this.getFocusableOptions();if(l.length){var E=0,C=l.indexOf(y);y||(C=-1),d==="up"?E=C>0?C-1:l.length-1:d==="down"?E=(C+1)%l.length:d==="pageup"?(E=C-m,E<0&&(E=0)):d==="pagedown"?(E=C+m,E>l.length-1&&(E=l.length-1)):d==="last"&&(E=l.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:l[E],focusedValue:null,focusedOptionId:this.getFocusedOptionId(l[E])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Mx):dn(dn({},Mx),this.props.theme):Mx}},{key:"getCommonProps",value:function(){var d=this.clearValue,m=this.cx,y=this.getStyles,l=this.getClassNames,E=this.getValue,C=this.selectOption,k=this.setValue,N=this.props,F=N.isMulti,B=N.isRtl,W=N.options,re=this.hasValue();return{clearValue:d,cx:m,getStyles:y,getClassNames:l,getValue:E,hasValue:re,isMulti:F,isRtl:B,options:W,selectOption:C,selectProps:N,setValue:k,theme:this.getTheme()}}},{key:"hasValue",value:function(){var d=this.state.selectValue;return d.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var d=this.props,m=d.isClearable,y=d.isMulti;return m===void 0?y:m}},{key:"isOptionDisabled",value:function(d,m){return uA(this.props,d,m)}},{key:"isOptionSelected",value:function(d,m){return hA(this.props,d,m)}},{key:"filterOption",value:function(d,m){return dA(this.props,d,m)}},{key:"formatOptionLabel",value:function(d,m){if(typeof this.props.formatOptionLabel=="function"){var y=this.props.inputValue,l=this.state.selectValue;return this.props.formatOptionLabel(d,{context:m,inputValue:y,selectValue:l})}else return this.getOptionLabel(d)}},{key:"formatGroupLabel",value:function(d){return this.props.formatGroupLabel(d)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var d=this.props,m=d.isDisabled,y=d.isSearchable,l=d.inputId,E=d.inputValue,C=d.tabIndex,k=d.form,N=d.menuIsOpen,F=d.required,B=this.getComponents(),W=B.Input,re=this.state,ie=re.inputIsHidden,de=re.ariaSelection,Ee=this.commonProps,we=l||this.getElementId("input"),ke=dn(dn(dn({"aria-autocomplete":"list","aria-expanded":N,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":F,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},N&&{"aria-controls":this.getElementId("listbox")}),!y&&{"aria-readonly":!0}),this.hasValue()?de?.action==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return y?K.createElement(W,pn({},Ee,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:we,innerRef:this.getInputRef,isDisabled:m,isHidden:ie,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:C,form:k,type:"text",value:E},ke)):K.createElement(Iz,pn({id:we,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Uv,onFocus:this.onInputFocus,disabled:m,tabIndex:C,inputMode:"none",form:k,value:""},ke))}},{key:"renderPlaceholderOrValue",value:function(){var d=this,m=this.getComponents(),y=m.MultiValue,l=m.MultiValueContainer,E=m.MultiValueLabel,C=m.MultiValueRemove,k=m.SingleValue,N=m.Placeholder,F=this.commonProps,B=this.props,W=B.controlShouldRenderValue,re=B.isDisabled,ie=B.isMulti,de=B.inputValue,Ee=B.placeholder,we=this.state,ke=we.selectValue,ge=we.focusedValue,Ae=we.isFocused;if(!this.hasValue()||!W)return de?null:K.createElement(N,pn({},F,{key:"placeholder",isDisabled:re,isFocused:Ae,innerProps:{id:this.getElementId("placeholder")}}),Ee);if(ie)return ke.map(function(at,Me){var Qe=at===ge,St="".concat(d.getOptionLabel(at),"-").concat(d.getOptionValue(at));return K.createElement(y,pn({},F,{components:{Container:l,Label:E,Remove:C},isFocused:Qe,isDisabled:re,key:St,index:Me,removeProps:{onClick:function(){return d.removeValue(at)},onTouchEnd:function(){return d.removeValue(at)},onMouseDown:function(zt){zt.preventDefault()}},data:at}),d.formatOptionLabel(at,"value"))});if(de)return null;var Ge=ke[0];return K.createElement(k,pn({},F,{data:Ge,isDisabled:re}),this.formatOptionLabel(Ge,"value"))}},{key:"renderClearIndicator",value:function(){var d=this.getComponents(),m=d.ClearIndicator,y=this.commonProps,l=this.props,E=l.isDisabled,C=l.isLoading,k=this.state.isFocused;if(!this.isClearable()||!m||E||!this.hasValue()||C)return null;var N={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return K.createElement(m,pn({},y,{innerProps:N,isFocused:k}))}},{key:"renderLoadingIndicator",value:function(){var d=this.getComponents(),m=d.LoadingIndicator,y=this.commonProps,l=this.props,E=l.isDisabled,C=l.isLoading,k=this.state.isFocused;if(!m||!C)return null;var N={"aria-hidden":"true"};return K.createElement(m,pn({},y,{innerProps:N,isDisabled:E,isFocused:k}))}},{key:"renderIndicatorSeparator",value:function(){var d=this.getComponents(),m=d.DropdownIndicator,y=d.IndicatorSeparator;if(!m||!y)return null;var l=this.commonProps,E=this.props.isDisabled,C=this.state.isFocused;return K.createElement(y,pn({},l,{isDisabled:E,isFocused:C}))}},{key:"renderDropdownIndicator",value:function(){var d=this.getComponents(),m=d.DropdownIndicator;if(!m)return null;var y=this.commonProps,l=this.props.isDisabled,E=this.state.isFocused,C={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return K.createElement(m,pn({},y,{innerProps:C,isDisabled:l,isFocused:E}))}},{key:"renderMenu",value:function(){var d=this,m=this.getComponents(),y=m.Group,l=m.GroupHeading,E=m.Menu,C=m.MenuList,k=m.MenuPortal,N=m.LoadingMessage,F=m.NoOptionsMessage,B=m.Option,W=this.commonProps,re=this.state.focusedOption,ie=this.props,de=ie.captureMenuScroll,Ee=ie.inputValue,we=ie.isLoading,ke=ie.loadingMessage,ge=ie.minMenuHeight,Ae=ie.maxMenuHeight,Ge=ie.menuIsOpen,at=ie.menuPlacement,Me=ie.menuPosition,Qe=ie.menuPortalTarget,St=ie.menuShouldBlockScroll,bt=ie.menuShouldScrollIntoView,zt=ie.noOptionsMessage,Zt=ie.onMenuScrollToTop,Ft=ie.onMenuScrollToBottom;if(!Ge)return null;var Be=function(pt,Et){var Ut=pt.type,Ot=pt.data,Ln=pt.isDisabled,Wt=pt.isSelected,Xn=pt.label,br=pt.value,ir=re===Ot,yi=Ln?void 0:function(){return d.onOptionHover(Ot)},Un=Ln?void 0:function(){return d.selectOption(Ot)},Vn="".concat(d.getElementId("option"),"-").concat(Et),Dn={id:Vn,onClick:Un,onMouseMove:yi,onMouseOver:yi,tabIndex:-1,role:"option","aria-selected":d.state.isAppleDevice?void 0:Wt};return K.createElement(B,pn({},W,{innerProps:Dn,data:Ot,isDisabled:Ln,isSelected:Wt,key:Vn,label:Xn,type:Ut,value:br,isFocused:ir,innerRef:ir?d.getFocusedOptionRef:void 0}),d.formatOptionLabel(pt.data,"menu"))},lt;if(this.hasOptions())lt=this.getCategorizedOptions().map(function(yt){if(yt.type==="group"){var pt=yt.data,Et=yt.options,Ut=yt.index,Ot="".concat(d.getElementId("group"),"-").concat(Ut),Ln="".concat(Ot,"-heading");return K.createElement(y,pn({},W,{key:Ot,data:pt,options:Et,Heading:l,headingProps:{id:Ln,data:yt.data},label:d.formatGroupLabel(yt.data)}),yt.options.map(function(Wt){return Be(Wt,"".concat(Ut,"-").concat(Wt.index))}))}else if(yt.type==="option")return Be(yt,"".concat(yt.index))});else if(we){var _t=ke({inputValue:Ee});if(_t===null)return null;lt=K.createElement(N,W,_t)}else{var ut=zt({inputValue:Ee});if(ut===null)return null;lt=K.createElement(F,W,ut)}var Te={minMenuHeight:ge,maxMenuHeight:Ae,menuPlacement:at,menuPosition:Me,menuShouldScrollIntoView:bt},nt=K.createElement(lN,pn({},W,Te),function(yt){var pt=yt.ref,Et=yt.placerProps,Ut=Et.placement,Ot=Et.maxHeight;return K.createElement(E,pn({},W,Te,{innerRef:pt,innerProps:{onMouseDown:d.onMenuMouseDown,onMouseMove:d.onMenuMouseMove},isLoading:we,placement:Ut}),K.createElement(Nz,{captureEnabled:de,onTopArrive:Zt,onBottomArrive:Ft,lockEnabled:St},function(Ln){return K.createElement(C,pn({},W,{innerRef:function(Xn){d.getMenuListRef(Xn),Ln(Xn)},innerProps:{role:"listbox","aria-multiselectable":W.isMulti,id:d.getElementId("listbox")},isLoading:we,maxHeight:Ot,focusedOption:re}),lt)}))});return Qe||Me==="fixed"?K.createElement(k,pn({},W,{appendTo:Qe,controlElement:this.controlRef,menuPlacement:at,menuPosition:Me}),nt):nt}},{key:"renderFormField",value:function(){var d=this,m=this.props,y=m.delimiter,l=m.isDisabled,E=m.isMulti,C=m.name,k=m.required,N=this.state.selectValue;if(k&&!this.hasValue()&&!l)return K.createElement(Fz,{name:C,onFocus:this.onValueInputFocus});if(!(!C||l))if(E)if(y){var F=N.map(function(re){return d.getOptionValue(re)}).join(y);return K.createElement("input",{name:C,type:"hidden",value:F})}else{var B=N.length>0?N.map(function(re,ie){return K.createElement("input",{key:"i-".concat(ie),name:C,type:"hidden",value:d.getOptionValue(re)})}):K.createElement("input",{name:C,type:"hidden",value:""});return K.createElement("div",null,B)}else{var W=N[0]?this.getOptionValue(N[0]):"";return K.createElement("input",{name:C,type:"hidden",value:W})}}},{key:"renderLiveRegion",value:function(){var d=this.commonProps,m=this.state,y=m.ariaSelection,l=m.focusedOption,E=m.focusedValue,C=m.isFocused,k=m.selectValue,N=this.getFocusableOptions();return K.createElement(Sz,pn({},d,{id:this.getElementId("live-region"),ariaSelection:y,focusedOption:l,focusedValue:E,isFocused:C,selectValue:k,focusableOptions:N,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var d=this.getComponents(),m=d.Control,y=d.IndicatorsContainer,l=d.SelectContainer,E=d.ValueContainer,C=this.props,k=C.className,N=C.id,F=C.isDisabled,B=C.menuIsOpen,W=this.state.isFocused,re=this.commonProps=this.getCommonProps();return K.createElement(l,pn({},re,{className:k,innerProps:{id:N,onKeyDown:this.onKeyDown},isDisabled:F,isFocused:W}),this.renderLiveRegion(),K.createElement(m,pn({},re,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:F,isFocused:W,menuIsOpen:B}),K.createElement(E,pn({},re,{isDisabled:F}),this.renderPlaceholderOrValue(),this.renderInput()),K.createElement(y,pn({},re,{isDisabled:F}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(d,m){var y=m.prevProps,l=m.clearFocusValueOnUpdate,E=m.inputIsHiddenAfterUpdate,C=m.ariaSelection,k=m.isFocused,N=m.prevWasFocused,F=m.instancePrefix,B=d.options,W=d.value,re=d.menuIsOpen,ie=d.inputValue,de=d.isMulti,Ee=_T(W),we={};if(y&&(W!==y.value||B!==y.options||re!==y.menuIsOpen||ie!==y.inputValue)){var ke=re?t5(d,Ee):[],ge=re?PT(Av(d,Ee),"".concat(F,"-option")):[],Ae=l?n5(m,Ee):null,Ge=i5(m,ke),at=Ax(ge,Ge);we={selectValue:Ee,focusedOption:Ge,focusedOptionId:at,focusableOptionsWithIds:ge,focusedValue:Ae,clearFocusValueOnUpdate:!1}}var Me=E!=null&&d!==y?{inputIsHidden:E,inputIsHiddenAfterUpdate:void 0}:{},Qe=C,St=k&&N;return k&&!St&&(Qe={value:yv(de,Ee,Ee[0]||null),options:Ee,action:"initial-input-focus"},St=!N),C?.action==="initial-input-focus"&&(Qe=null),dn(dn(dn({},we),Me),{},{prevProps:d,ariaSelection:Qe,prevWasFocused:St})}}]),r}(K.Component);pA.defaultProps=e5;var a5=K.forwardRef(function(n,e){var r=TO(n);return K.createElement(pA,pn({ref:e},r))}),LT=a5;function o5({itinerary1Legs:n,itinerary2Legs:e,selectedLeg1Ids:r,selectedLeg2Ids:u,setSelectedLeg1Ids:d,setSelectedLeg2Ids:m,selectedIndexes:y,timeZone:l}){const E=iT(n,1,l),C=iT(e,2,l);return H.jsx("div",{className:"compare-section-divider",children:H.jsxs("div",{className:"compare-legs-select-container",children:[H.jsxs("div",{className:"compare-leg-select-column",children:[H.jsxs("label",{className:"compare-leg-select-label",children:["Itinerary #",y[0]+1," Legs:"]}),H.jsx(LT,{isMulti:!0,options:E,value:E.filter(k=>r.includes(k.value)),onChange:k=>{const N=k?k.map(F=>F.value):[];d(N)},placeholder:"Select legs to compare...",className:"compare-leg-select",classNamePrefix:"compare-leg-select"})]}),H.jsxs("div",{className:"compare-leg-select-column",children:[H.jsxs("label",{className:"compare-leg-select-label",children:["Itinerary #",y[1]+1," Legs:"]}),H.jsx(LT,{isMulti:!0,options:C,value:C.filter(k=>u.includes(k.value)),onChange:k=>{const N=k?k.map(F=>F.value):[];m(N)},placeholder:"Select legs to compare...",className:"compare-leg-select",classNamePrefix:"compare-leg-select"})]})]})})}const s5=(n,e)=>{if(!n)return`itinerary_${e}_leg_invalid`;if(n.id)return`itinerary_${e}_leg_${n.id}`;const r=`${n.mode}_${n.aimedStartTime}_${n.aimedEndTime}_${n.fromPlace?.name||"unknown"}_${n.toPlace?.name||"unknown"}`;return`itinerary_${e}_leg_${r}`};function l5({itinerary1:n,itinerary2:e,selectedLegIds:r,selectedIndexes:u,timeZone:d}){return r.length===0?null:H.jsxs("div",{className:"compare-selected-legs-section",children:[H.jsx("h6",{className:"compare-selected-legs-title",children:"Selected Legs Comparison"}),H.jsxs(mb,{striped:!0,bordered:!0,hover:!0,children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("th",{children:"Itinerary"}),H.jsx("th",{children:"From"}),H.jsx("th",{children:"To"}),H.jsx("th",{children:"Mode"}),H.jsx("th",{children:"Line"}),H.jsx("th",{children:"Start Time"}),H.jsx("th",{children:"End Time"}),H.jsx("th",{children:"Duration"}),H.jsx("th",{children:"Distance"}),H.jsx("th",{children:"Cost"})]})}),H.jsx("tbody",{children:[n,e].map((m,y)=>m.legs.filter(l=>l&&r.includes(l.id||`leg${y+1}_${m.legs.indexOf(l)}`)).map(l=>H.jsxs("tr",{children:[H.jsx("td",{children:H.jsxs("strong",{children:["#",u[y]+1]})}),H.jsx("td",{children:l.fromPlace?.name||"-"}),H.jsx("td",{children:l.toPlace?.name||"-"}),H.jsx("td",{children:l.mode}),H.jsx("td",{children:l.line?.publicCode||l.line?.name||"-"}),H.jsx("td",{children:Zc(l.aimedStartTime,d,"short")}),H.jsx("td",{children:Zc(l.aimedEndTime,d,"short")}),H.jsx("td",{children:aw(l.duration)}),H.jsx("td",{children:rw(l.distance)}),H.jsxs("td",{children:["¢",l.generalizedCost]})]},s5(l,y))))})]})]})}function c5({show:n,onHide:e,tripQueryResult:r,selectedIndexes:u}){const d=K.useContext(Xg),[m,y]=K.useState([]),[l,E]=K.useState([]),C=[...m,...l];if(!r||u.length!==2)return null;const k=r.trip.tripPatterns[u[0]],N=r.trip.tripPatterns[u[1]],F=nT(k,d),B=nT(N,d);return H.jsxs(hv,{show:n,onHide:e,centered:!0,className:"full-width-modal",children:[H.jsx(hv.Header,{closeButton:!0,children:H.jsx(hv.Title,{children:"Compare Itineraries"})}),H.jsxs(hv.Body,{children:[H.jsx(yO,{itinerary1:k,itinerary2:N,summary1:F,summary2:B,selectedIndexes:u}),H.jsx(o5,{itinerary1Legs:k.legs,itinerary2Legs:N.legs,selectedLeg1Ids:m,selectedLeg2Ids:l,setSelectedLeg1Ids:y,setSelectedLeg2Ids:E,selectedIndexes:u,timeZone:d}),H.jsx(l5,{itinerary1:k,itinerary2:N,selectedLegIds:C,selectedIndexes:u,timeZone:d})]})]})}const u5=Zg(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        generalizedCost
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            generalizedCost
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            fromEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),h5=hs(u5);function d5(n){const e={};return C1(n,{OperationDefinition(r){r.operation==="query"&&r.variableDefinitions&&r.variableDefinitions.forEach(u=>{const d=u.variable.name.value;e[d]=hs(u.type)})}}),e}function mA(n){const e=US(h5),r=d5(e),u=Object.keys(n).filter(m=>n[m]!==void 0),d=C1(e,{OperationDefinition(m){if(m.operation==="query"){const y=m.variableDefinitions?.filter(l=>{const E=l.variable.name.value;return u.includes(E)&&r[E]});return{...m,variableDefinitions:y||[]}}return m},Field(m){if(m.name.value==="trip"&&m.arguments){const y=m.arguments.filter(l=>{if(l.value.kind==="Variable"){const E=l.value.name.value;return u.includes(E)&&r[E]}return!0});return{...m,arguments:y}}return m}});return hs(d)}function gA(n){const e={};return Object.keys(n).forEach(r=>{const u=n[r];u!==void 0&&(e[r]=u)}),e}const f5=n=>{const[e,r]=K.useState(null),[u,d]=K.useState(!1),[m,y]=K.useState(null),l=K.useCallback(async E=>{if(u)console.warn("Wait for previous search to finish");else if(n){d(!0),y(null);try{const C=E?{...n,pageCursor:E}:n,k=gA(C),N=mA(C);r(await k1(cb(),N,k))}catch(C){console.error("Error at useTripQuery",C),y(C),r(null)}d(!1)}else console.warn("Can't search without variables")},[r,n,u]);return K.useEffect(()=>{NT(n?.from)&&NT(n?.to)&&l()},[n?.from,n?.to]),[e,u,l,m]};function NT(n){return n&&(n.coordinates||n.place)}const p5=Zg(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),m5=()=>{const[n,e]=K.useState(null);return K.useEffect(()=>{(async()=>{e(await k1(cb(),p5))})()},[]),n?.serverInfo},g5={from:{},to:{},dateTime:new Date().toISOString()},y5=()=>{const e=new URLSearchParams(window.location.search).get("variables");return e?JSON.parse(decodeURIComponent(e)):g5},_5=n=>{const e=new URLSearchParams(window.location.search);e.set("variables",encodeURIComponent(JSON.stringify(n))),history.pushState({},"","?"+e.toString()+window.location.hash)},v5=()=>{const[n,e]=K.useState(y5());return K.useEffect(()=>{_5(n)},[n]),{tripQueryVariables:n,setTripQueryVariables:e}};function b5({target:n,serverInfo:e}){return H.jsx(EM,{target:n.current,show:!!e,placement:"right",children:H.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:H.jsx("pre",{children:JSON.stringify(e,null,2)})})})}const x5="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function w5({serverInfo:n}){const[e,r]=K.useState(!1),u=K.useRef(null);return H.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[H.jsx(o3.Brand,{onClick:()=>r(d=>!d),children:H.jsxs("div",{ref:u,children:[H.jsx("img",{alt:"",src:x5,width:"50",height:"50",className:"logo-image"}),"OTP Debug",e&&H.jsx(b5,{serverInfo:n,target:u})]})}),H.jsxs("div",{className:"details",children:[H.jsxs("div",{children:["Version: ",n?.version]}),H.jsxs("div",{children:["Time zone: ",n?.internalTransitModelTimeZone]})]})]})}const zT=7,jT="-{0,1}\\d+(\\.\\d+){0,1}",T5="("+jT+")(\\s+)("+jT+")";function S5(n){const e=n.match(T5);return e?{coordinates:{latitude:+e[1],longitude:+e[4]}}:{place:n}}function E5(n){return n.coordinates?`${n.coordinates?.latitude.toPrecision(zT)} ${n.coordinates?.longitude.toPrecision(zT)}`:n.place?n.place:null}function FT({id:n,label:e,tripQueryVariables:r,setTripQueryVariables:u,locationFieldKey:d}){const m=r[d],y=E5(m)||"",[l,E]=K.useState(y),[C,k]=K.useState(m);C!==m&&(k(m),E(y));const N=K.useCallback(F=>{const B=S5(F)||{};u({...r,[d]:B})},[r,u,d]);return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:n,children:e}),H.jsx(Ri.Control,{type:"text",id:n,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:F=>{E(F.target.value)},onBlur:F=>{N(F.target.value)},value:l})]})}const M5="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function A5({tripQueryVariables:n,setTripQueryVariables:e}){const r=()=>{e({...n,from:n.to,to:n.from})};return H.jsx("button",{className:"swap-from-to",onClick:r,title:"Swap from/to",children:H.jsx("img",{alt:"Swap from/to",src:M5})})}function C5({tripQueryVariables:n,setTripQueryVariables:e}){const r=u=>{if(u===void 0){const d={...n};delete d.arriveBy,e(d)}else e({...n,arriveBy:u})};return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Depart/Arrive"}),H.jsxs(Ri.Select,{size:"sm",className:"input-medium",onChange:u=>u.target.value==="arrival"?r(!0):r(void 0),value:n.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[H.jsx("option",{value:"arrival",children:"Arrive by"}),H.jsx("option",{value:"departure",children:"Depart after"})]})]})}class J extends Array{constructor(e,r){if(super(e),this.sign=r,Object.setPrototypeOf(this,J.prototype),e>J.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(e){var r=Math.floor,u=Number.isFinite;if(typeof e=="number"){if(e===0)return J.__zero();if(J.__isOneDigitInt(e))return 0>e?J.__oneDigit(-e,!0):J.__oneDigit(e,!1);if(!u(e)||r(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return J.__fromDouble(e)}if(typeof e=="string"){const d=J.__fromString(e);if(d===null)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return d}if(typeof e=="boolean")return e===!0?J.__oneDigit(1,!1):J.__zero();if(typeof e=="object"){if(e.constructor===J)return e;const d=J.__toPrimitive(e);return J.BigInt(d)}throw new TypeError("Cannot convert "+e+" to a BigInt")}toDebugString(){const e=["BigInt["];for(const r of this)e.push((r&&(r>>>0).toString(16))+", ");return e.push("]"),e.join("")}toString(e=10){if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(e&e-1)==0?J.__toStringBasePowerOfTwo(this,e):J.__toStringGeneric(this,e,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(e){const r=e.length;if(r===0)return 0;if(r===1){const ie=e.__unsignedDigit(0);return e.sign?-ie:ie}const u=e.__digit(r-1),d=J.__clz30(u),m=30*r-d;if(1024<m)return e.sign?-1/0:1/0;let y=m-1,l=u,E=r-1;const C=d+3;let k=C===32?0:l<<C;k>>>=12;const N=C-12;let F=12<=C?0:l<<20+C,B=20+C;for(0<N&&0<E&&(E--,l=e.__digit(E),k|=l>>>30-N,F=l<<N+2,B=N+2);0<B&&0<E;)E--,l=e.__digit(E),F|=30<=B?l<<B-30:l>>>30-B,B-=30;const W=J.__decideRounding(e,B,E,l);if((W===1||W===0&&(1&F)==1)&&(F=F+1>>>0,F===0&&(k++,k>>>20!=0&&(k=0,y++,1023<y))))return e.sign?-1/0:1/0;const re=e.sign?-2147483648:0;return y=y+1023<<20,J.__kBitConversionInts[1]=re|y|k,J.__kBitConversionInts[0]=F,J.__kBitConversionDouble[0]}static unaryMinus(e){if(e.length===0)return e;const r=e.__copy();return r.sign=!e.sign,r}static bitwiseNot(e){return e.sign?J.__absoluteSubOne(e).__trim():J.__absoluteAddOne(e,!0)}static exponentiate(e,r){if(r.sign)throw new RangeError("Exponent must be positive");if(r.length===0)return J.__oneDigit(1,!1);if(e.length===0)return e;if(e.length===1&&e.__digit(0)===1)return e.sign&&(1&r.__digit(0))==0?J.unaryMinus(e):e;if(1<r.length)throw new RangeError("BigInt too big");let u=r.__unsignedDigit(0);if(u===1)return e;if(u>=J.__kMaxLengthBits)throw new RangeError("BigInt too big");if(e.length===1&&e.__digit(0)===2){const y=1+(0|u/30),l=e.sign&&(1&u)!=0,E=new J(y,l);E.__initializeDigits();const C=1<<u%30;return E.__setDigit(y-1,C),E}let d=null,m=e;for((1&u)!=0&&(d=e),u>>=1;u!==0;u>>=1)m=J.multiply(m,m),(1&u)!=0&&(d===null?d=m:d=J.multiply(d,m));return d}static multiply(e,r){if(e.length===0)return e;if(r.length===0)return r;let u=e.length+r.length;30<=e.__clzmsd()+r.__clzmsd()&&u--;const d=new J(u,e.sign!==r.sign);d.__initializeDigits();for(let m=0;m<e.length;m++)J.__multiplyAccumulate(r,e.__digit(m),d,m);return d.__trim()}static divide(e,r){if(r.length===0)throw new RangeError("Division by zero");if(0>J.__absoluteCompare(e,r))return J.__zero();const u=e.sign!==r.sign,d=r.__unsignedDigit(0);let m;if(r.length===1&&32767>=d){if(d===1)return u===e.sign?e:J.unaryMinus(e);m=J.__absoluteDivSmall(e,d,null)}else m=J.__absoluteDivLarge(e,r,!0,!1);return m.sign=u,m.__trim()}static remainder(e,r){if(r.length===0)throw new RangeError("Division by zero");if(0>J.__absoluteCompare(e,r))return e;const u=r.__unsignedDigit(0);if(r.length===1&&32767>=u){if(u===1)return J.__zero();const m=J.__absoluteModSmall(e,u);return m===0?J.__zero():J.__oneDigit(m,e.sign)}const d=J.__absoluteDivLarge(e,r,!1,!0);return d.sign=e.sign,d.__trim()}static add(e,r){const u=e.sign;return u===r.sign?J.__absoluteAdd(e,r,u):0<=J.__absoluteCompare(e,r)?J.__absoluteSub(e,r,u):J.__absoluteSub(r,e,!u)}static subtract(e,r){const u=e.sign;return u===r.sign?0<=J.__absoluteCompare(e,r)?J.__absoluteSub(e,r,u):J.__absoluteSub(r,e,!u):J.__absoluteAdd(e,r,u)}static leftShift(e,r){return r.length===0||e.length===0?e:r.sign?J.__rightShiftByAbsolute(e,r):J.__leftShiftByAbsolute(e,r)}static signedRightShift(e,r){return r.length===0||e.length===0?e:r.sign?J.__leftShiftByAbsolute(e,r):J.__rightShiftByAbsolute(e,r)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(e,r){return 0>J.__compareToBigInt(e,r)}static lessThanOrEqual(e,r){return 0>=J.__compareToBigInt(e,r)}static greaterThan(e,r){return 0<J.__compareToBigInt(e,r)}static greaterThanOrEqual(e,r){return 0<=J.__compareToBigInt(e,r)}static equal(e,r){if(e.sign!==r.sign||e.length!==r.length)return!1;for(let u=0;u<e.length;u++)if(e.__digit(u)!==r.__digit(u))return!1;return!0}static notEqual(e,r){return!J.equal(e,r)}static bitwiseAnd(e,r){var u=Math.max;if(!e.sign&&!r.sign)return J.__absoluteAnd(e,r).__trim();if(e.sign&&r.sign){const d=u(e.length,r.length)+1;let m=J.__absoluteSubOne(e,d);const y=J.__absoluteSubOne(r);return m=J.__absoluteOr(m,y,m),J.__absoluteAddOne(m,!0,m).__trim()}return e.sign&&([e,r]=[r,e]),J.__absoluteAndNot(e,J.__absoluteSubOne(r)).__trim()}static bitwiseXor(e,r){var u=Math.max;if(!e.sign&&!r.sign)return J.__absoluteXor(e,r).__trim();if(e.sign&&r.sign){const y=u(e.length,r.length),l=J.__absoluteSubOne(e,y),E=J.__absoluteSubOne(r);return J.__absoluteXor(l,E,l).__trim()}const d=u(e.length,r.length)+1;e.sign&&([e,r]=[r,e]);let m=J.__absoluteSubOne(r,d);return m=J.__absoluteXor(m,e,m),J.__absoluteAddOne(m,!0,m).__trim()}static bitwiseOr(e,r){var u=Math.max;const d=u(e.length,r.length);if(!e.sign&&!r.sign)return J.__absoluteOr(e,r).__trim();if(e.sign&&r.sign){let y=J.__absoluteSubOne(e,d);const l=J.__absoluteSubOne(r);return y=J.__absoluteAnd(y,l,y),J.__absoluteAddOne(y,!0,y).__trim()}e.sign&&([e,r]=[r,e]);let m=J.__absoluteSubOne(r,d);return m=J.__absoluteAndNot(m,e,m),J.__absoluteAddOne(m,!0,m).__trim()}static asIntN(e,r){var u=Math.floor;if(r.length===0)return r;if(e=u(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return J.__zero();if(e>=J.__kMaxLengthBits)return r;const d=0|(e+29)/30;if(r.length<d)return r;const m=r.__unsignedDigit(d-1),y=1<<(e-1)%30;if(r.length===d&&m<y)return r;if((m&y)!==y)return J.__truncateToNBits(e,r);if(!r.sign)return J.__truncateAndSubFromPowerOfTwo(e,r,!0);if((m&y-1)==0){for(let l=d-2;0<=l;l--)if(r.__digit(l)!==0)return J.__truncateAndSubFromPowerOfTwo(e,r,!1);return r.length===d&&m===y?r:J.__truncateToNBits(e,r)}return J.__truncateAndSubFromPowerOfTwo(e,r,!1)}static asUintN(e,r){var u=Math.floor;if(r.length===0)return r;if(e=u(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return J.__zero();if(r.sign){if(e>J.__kMaxLengthBits)throw new RangeError("BigInt too big");return J.__truncateAndSubFromPowerOfTwo(e,r,!1)}if(e>=J.__kMaxLengthBits)return r;const d=0|(e+29)/30;if(r.length<d)return r;const m=e%30;return r.length==d&&(m===0||!(r.__digit(d-1)>>>m))?r:J.__truncateToNBits(e,r)}static ADD(e,r){if(e=J.__toPrimitive(e),r=J.__toPrimitive(r),typeof e=="string")return typeof r!="string"&&(r=r.toString()),e+r;if(typeof r=="string")return e.toString()+r;if(e=J.__toNumeric(e),r=J.__toNumeric(r),J.__isBigInt(e)&&J.__isBigInt(r))return J.add(e,r);if(typeof e=="number"&&typeof r=="number")return e+r;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(e,r){return J.__compare(e,r,0)}static LE(e,r){return J.__compare(e,r,1)}static GT(e,r){return J.__compare(e,r,2)}static GE(e,r){return J.__compare(e,r,3)}static EQ(e,r){for(;;){if(J.__isBigInt(e))return J.__isBigInt(r)?J.equal(e,r):J.EQ(r,e);if(typeof e=="number"){if(J.__isBigInt(r))return J.__equalToNumber(r,e);if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="string"){if(J.__isBigInt(r))return e=J.__fromString(e),e!==null&&J.equal(e,r);if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="boolean"){if(J.__isBigInt(r))return J.__equalToNumber(r,+e);if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="symbol"){if(J.__isBigInt(r))return!1;if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="object"){if(typeof r=="object"&&r.constructor!==J)return e==r;e=J.__toPrimitive(e)}else return e==r}}static NE(e,r){return!J.EQ(e,r)}static DataViewGetBigInt64(e,r,u=!1){return J.asIntN(64,J.DataViewGetBigUint64(e,r,u))}static DataViewGetBigUint64(e,r,u=!1){const[d,m]=u?[4,0]:[0,4],y=e.getUint32(r+d,u),l=e.getUint32(r+m,u),E=new J(3,!1);return E.__setDigit(0,1073741823&l),E.__setDigit(1,(268435455&y)<<2|l>>>30),E.__setDigit(2,y>>>28),E.__trim()}static DataViewSetBigInt64(e,r,u,d=!1){J.DataViewSetBigUint64(e,r,u,d)}static DataViewSetBigUint64(e,r,u,d=!1){u=J.asUintN(64,u);let m=0,y=0;if(0<u.length&&(y=u.__digit(0),1<u.length)){const C=u.__digit(1);y|=C<<30,m=C>>>2,2<u.length&&(m|=u.__digit(2)<<28)}const[l,E]=d?[4,0]:[0,4];e.setUint32(r+l,m,d),e.setUint32(r+E,y,d)}static __zero(){return new J(0,!1)}static __oneDigit(e,r){const u=new J(1,r);return u.__setDigit(0,e),u}__copy(){const e=new J(this.length,this.sign);for(let r=0;r<this.length;r++)e[r]=this[r];return e}__trim(){let e=this.length,r=this[e-1];for(;r===0;)e--,r=this[e-1],this.pop();return e===0&&(this.sign=!1),this}__initializeDigits(){for(let e=0;e<this.length;e++)this[e]=0}static __decideRounding(e,r,u,d){if(0<r)return-1;let m;if(0>r)m=-r-1;else{if(u===0)return-1;u--,d=e.__digit(u),m=29}let y=1<<m;if((d&y)==0)return-1;if(y-=1,(d&y)!=0)return 1;for(;0<u;)if(u--,e.__digit(u)!==0)return 1;return 0}static __fromDouble(e){J.__kBitConversionDouble[0]=e;const r=2047&J.__kBitConversionInts[1]>>>20,u=r-1023,d=(0|u/30)+1,m=new J(d,0>e);let y=1048575&J.__kBitConversionInts[1]|1048576,l=J.__kBitConversionInts[0];const E=20,C=u%30;let k,N=0;if(C<20){const F=E-C;N=F+32,k=y>>>F,y=y<<32-F|l>>>F,l<<=32-F}else if(C===20)N=32,k=y,y=l,l=0;else{const F=C-E;N=32-F,k=y<<F|l>>>32-F,y=l<<F,l=0}m.__setDigit(d-1,k);for(let F=d-2;0<=F;F--)0<N?(N-=30,k=y>>>2,y=y<<30|l>>>2,l<<=30):k=0,m.__setDigit(F,k);return m.__trim()}static __isWhitespace(e){return 13>=e&&9<=e||(159>=e?e==32:131071>=e?e==160||e==5760:196607>=e?(e&=131071,10>=e||e==40||e==41||e==47||e==95||e==4096):e==65279)}static __fromString(e,r=0){let u=0;const d=e.length;let m=0;if(m===d)return J.__zero();let y=e.charCodeAt(m);for(;J.__isWhitespace(y);){if(++m===d)return J.__zero();y=e.charCodeAt(m)}if(y===43){if(++m===d)return null;y=e.charCodeAt(m),u=1}else if(y===45){if(++m===d)return null;y=e.charCodeAt(m),u=-1}if(r===0){if(r=10,y===48){if(++m===d)return J.__zero();if(y=e.charCodeAt(m),y===88||y===120){if(r=16,++m===d)return null;y=e.charCodeAt(m)}else if(y===79||y===111){if(r=8,++m===d)return null;y=e.charCodeAt(m)}else if(y===66||y===98){if(r=2,++m===d)return null;y=e.charCodeAt(m)}}}else if(r===16&&y===48){if(++m===d)return J.__zero();if(y=e.charCodeAt(m),y===88||y===120){if(++m===d)return null;y=e.charCodeAt(m)}}if(u!=0&&r!==10)return null;for(;y===48;){if(++m===d)return J.__zero();y=e.charCodeAt(m)}const l=d-m;let E=J.__kMaxBitsPerChar[r],C=J.__kBitsPerCharTableMultiplier-1;if(l>1073741824/E)return null;const k=E*l+C>>>J.__kBitsPerCharTableShift,N=new J(0|(k+29)/30,!1),F=10>r?r:10,B=10<r?r-10:0;if((r&r-1)==0){E>>=J.__kBitsPerCharTableShift;const W=[],re=[];let ie=!1;do{let de=0,Ee=0;for(;;){let we;if(y-48>>>0<F)we=y-48;else if((32|y)-97>>>0<B)we=(32|y)-87;else{ie=!0;break}if(Ee+=E,de=de<<E|we,++m===d){ie=!0;break}if(y=e.charCodeAt(m),30<Ee+E)break}W.push(de),re.push(Ee)}while(!ie);J.__fillFromParts(N,W,re)}else{N.__initializeDigits();let W=!1,re=0;do{let ie=0,de=1;for(;;){let we;if(y-48>>>0<F)we=y-48;else if((32|y)-97>>>0<B)we=(32|y)-87;else{W=!0;break}const ke=de*r;if(1073741823<ke)break;if(de=ke,ie=ie*r+we,re++,++m===d){W=!0;break}y=e.charCodeAt(m)}C=30*J.__kBitsPerCharTableMultiplier-1;const Ee=0|(E*re+C>>>J.__kBitsPerCharTableShift)/30;N.__inplaceMultiplyAdd(de,ie,Ee)}while(!W)}if(m!==d){if(!J.__isWhitespace(y))return null;for(m++;m<d;m++)if(y=e.charCodeAt(m),!J.__isWhitespace(y))return null}return N.sign=u==-1,N.__trim()}static __fillFromParts(e,r,u){let d=0,m=0,y=0;for(let l=r.length-1;0<=l;l--){const E=r[l],C=u[l];m|=E<<y,y+=C,y===30?(e.__setDigit(d++,m),y=0,m=0):30<y&&(e.__setDigit(d++,1073741823&m),y-=30,m=E>>>C-y)}if(m!==0){if(d>=e.length)throw new Error("implementation bug");e.__setDigit(d++,m)}for(;d<e.length;d++)e.__setDigit(d,0)}static __toStringBasePowerOfTwo(e,r){const u=e.length;let d=r-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);const m=d,y=r-1,l=e.__digit(u-1),E=J.__clz30(l);let C=0|(30*u-E+m-1)/m;if(e.sign&&C++,268435456<C)throw new Error("string too long");const k=Array(C);let N=C-1,F=0,B=0;for(let re=0;re<u-1;re++){const ie=e.__digit(re),de=(F|ie<<B)&y;k[N--]=J.__kConversionChars[de];const Ee=m-B;for(F=ie>>>Ee,B=30-Ee;B>=m;)k[N--]=J.__kConversionChars[F&y],F>>>=m,B-=m}const W=(F|l<<B)&y;for(k[N--]=J.__kConversionChars[W],F=l>>>m-B;F!==0;)k[N--]=J.__kConversionChars[F&y],F>>>=m;if(e.sign&&(k[N--]="-"),N!=-1)throw new Error("implementation bug");return k.join("")}static __toStringGeneric(e,r,u){const d=e.length;if(d===0)return"";if(d===1){let re=e.__unsignedDigit(0).toString(r);return u===!1&&e.sign&&(re="-"+re),re}const m=30*d-J.__clz30(e.__digit(d-1)),y=J.__kMaxBitsPerChar[r],l=y-1;let E=m*J.__kBitsPerCharTableMultiplier;E+=l-1,E=0|E/l;const C=E+1>>1,k=J.exponentiate(J.__oneDigit(r,!1),J.__oneDigit(C,!1));let N,F;const B=k.__unsignedDigit(0);if(k.length===1&&32767>=B){N=new J(e.length,!1),N.__initializeDigits();let re=0;for(let ie=2*e.length-1;0<=ie;ie--){const de=re<<15|e.__halfDigit(ie);N.__setHalfDigit(ie,0|de/B),re=0|de%B}F=re.toString(r)}else{const re=J.__absoluteDivLarge(e,k,!0,!0);N=re.quotient;const ie=re.remainder.__trim();F=J.__toStringGeneric(ie,r,!0)}N.__trim();let W=J.__toStringGeneric(N,r,!0);for(;F.length<C;)F="0"+F;return u===!1&&e.sign&&(W="-"+W),W+F}static __unequalSign(e){return e?-1:1}static __absoluteGreater(e){return e?-1:1}static __absoluteLess(e){return e?1:-1}static __compareToBigInt(e,r){const u=e.sign;if(u!==r.sign)return J.__unequalSign(u);const d=J.__absoluteCompare(e,r);return 0<d?J.__absoluteGreater(u):0>d?J.__absoluteLess(u):0}static __compareToNumber(e,r){if(J.__isOneDigitInt(r)){const u=e.sign,d=0>r;if(u!==d)return J.__unequalSign(u);if(e.length===0){if(d)throw new Error("implementation bug");return r===0?0:-1}if(1<e.length)return J.__absoluteGreater(u);const m=Math.abs(r),y=e.__unsignedDigit(0);return y>m?J.__absoluteGreater(u):y<m?J.__absoluteLess(u):0}return J.__compareToDouble(e,r)}static __compareToDouble(e,r){if(r!==r)return r;if(r===1/0)return-1;if(r===-1/0)return 1;const u=e.sign;if(u!==0>r)return J.__unequalSign(u);if(r===0)throw new Error("implementation bug: should be handled elsewhere");if(e.length===0)return-1;J.__kBitConversionDouble[0]=r;const d=2047&J.__kBitConversionInts[1]>>>20;if(d==2047)throw new Error("implementation bug: handled elsewhere");const m=d-1023;if(0>m)return J.__absoluteGreater(u);const y=e.length;let l=e.__digit(y-1);const E=J.__clz30(l),C=30*y-E,k=m+1;if(C<k)return J.__absoluteLess(u);if(C>k)return J.__absoluteGreater(u);let N=1048576|1048575&J.__kBitConversionInts[1],F=J.__kBitConversionInts[0];const B=20,W=29-E;if(W!==(0|(C-1)%30))throw new Error("implementation bug");let re,ie=0;if(20>W){const de=B-W;ie=de+32,re=N>>>de,N=N<<32-de|F>>>de,F<<=32-de}else if(W===20)ie=32,re=N,N=F,F=0;else{const de=W-B;ie=32-de,re=N<<de|F>>>32-de,N=F<<de,F=0}if(l>>>=0,re>>>=0,l>re)return J.__absoluteGreater(u);if(l<re)return J.__absoluteLess(u);for(let de=y-2;0<=de;de--){0<ie?(ie-=30,re=N>>>2,N=N<<30|F>>>2,F<<=30):re=0;const Ee=e.__unsignedDigit(de);if(Ee>re)return J.__absoluteGreater(u);if(Ee<re)return J.__absoluteLess(u)}if(N!==0||F!==0){if(ie===0)throw new Error("implementation bug");return J.__absoluteLess(u)}return 0}static __equalToNumber(e,r){var u=Math.abs;return J.__isOneDigitInt(r)?r===0?e.length===0:e.length===1&&e.sign===0>r&&e.__unsignedDigit(0)===u(r):J.__compareToDouble(e,r)===0}static __comparisonResultToBool(e,r){return r===0?0>e:r===1?0>=e:r===2?0<e:r===3?0<=e:void 0}static __compare(e,r,u){if(e=J.__toPrimitive(e),r=J.__toPrimitive(r),typeof e=="string"&&typeof r=="string")switch(u){case 0:return e<r;case 1:return e<=r;case 2:return e>r;case 3:return e>=r}if(J.__isBigInt(e)&&typeof r=="string")return r=J.__fromString(r),r!==null&&J.__comparisonResultToBool(J.__compareToBigInt(e,r),u);if(typeof e=="string"&&J.__isBigInt(r))return e=J.__fromString(e),e!==null&&J.__comparisonResultToBool(J.__compareToBigInt(e,r),u);if(e=J.__toNumeric(e),r=J.__toNumeric(r),J.__isBigInt(e)){if(J.__isBigInt(r))return J.__comparisonResultToBool(J.__compareToBigInt(e,r),u);if(typeof r!="number")throw new Error("implementation bug");return J.__comparisonResultToBool(J.__compareToNumber(e,r),u)}if(typeof e!="number")throw new Error("implementation bug");if(J.__isBigInt(r))return J.__comparisonResultToBool(J.__compareToNumber(r,e),2^u);if(typeof r!="number")throw new Error("implementation bug");return u===0?e<r:u===1?e<=r:u===2?e>r:u===3?e>=r:void 0}__clzmsd(){return J.__clz30(this.__digit(this.length-1))}static __absoluteAdd(e,r,u){if(e.length<r.length)return J.__absoluteAdd(r,e,u);if(e.length===0)return e;if(r.length===0)return e.sign===u?e:J.unaryMinus(e);let d=e.length;(e.__clzmsd()===0||r.length===e.length&&r.__clzmsd()===0)&&d++;const m=new J(d,u);let y=0,l=0;for(;l<r.length;l++){const E=e.__digit(l)+r.__digit(l)+y;y=E>>>30,m.__setDigit(l,1073741823&E)}for(;l<e.length;l++){const E=e.__digit(l)+y;y=E>>>30,m.__setDigit(l,1073741823&E)}return l<m.length&&m.__setDigit(l,y),m.__trim()}static __absoluteSub(e,r,u){if(e.length===0)return e;if(r.length===0)return e.sign===u?e:J.unaryMinus(e);const d=new J(e.length,u);let m=0,y=0;for(;y<r.length;y++){const l=e.__digit(y)-r.__digit(y)-m;m=1&l>>>30,d.__setDigit(y,1073741823&l)}for(;y<e.length;y++){const l=e.__digit(y)-m;m=1&l>>>30,d.__setDigit(y,1073741823&l)}return d.__trim()}static __absoluteAddOne(e,r,u=null){const d=e.length;u===null?u=new J(d,r):u.sign=r;let m=1;for(let y=0;y<d;y++){const l=e.__digit(y)+m;m=l>>>30,u.__setDigit(y,1073741823&l)}return m!=0&&u.__setDigitGrow(d,1),u}static __absoluteSubOne(e,r){const u=e.length;r=r||u;const d=new J(r,!1);let m=1;for(let y=0;y<u;y++){const l=e.__digit(y)-m;m=1&l>>>30,d.__setDigit(y,1073741823&l)}if(m!=0)throw new Error("implementation bug");for(let y=u;y<r;y++)d.__setDigit(y,0);return d}static __absoluteAnd(e,r,u=null){let d=e.length,m=r.length,y=m;if(d<m){y=d;const C=e,k=d;e=r,d=m,r=C,m=k}let l=y;u===null?u=new J(l,!1):l=u.length;let E=0;for(;E<y;E++)u.__setDigit(E,e.__digit(E)&r.__digit(E));for(;E<l;E++)u.__setDigit(E,0);return u}static __absoluteAndNot(e,r,u=null){const d=e.length,m=r.length;let y=m;d<m&&(y=d);let l=d;u===null?u=new J(l,!1):l=u.length;let E=0;for(;E<y;E++)u.__setDigit(E,e.__digit(E)&~r.__digit(E));for(;E<d;E++)u.__setDigit(E,e.__digit(E));for(;E<l;E++)u.__setDigit(E,0);return u}static __absoluteOr(e,r,u=null){let d=e.length,m=r.length,y=m;if(d<m){y=d;const C=e,k=d;e=r,d=m,r=C,m=k}let l=d;u===null?u=new J(l,!1):l=u.length;let E=0;for(;E<y;E++)u.__setDigit(E,e.__digit(E)|r.__digit(E));for(;E<d;E++)u.__setDigit(E,e.__digit(E));for(;E<l;E++)u.__setDigit(E,0);return u}static __absoluteXor(e,r,u=null){let d=e.length,m=r.length,y=m;if(d<m){y=d;const C=e,k=d;e=r,d=m,r=C,m=k}let l=d;u===null?u=new J(l,!1):l=u.length;let E=0;for(;E<y;E++)u.__setDigit(E,e.__digit(E)^r.__digit(E));for(;E<d;E++)u.__setDigit(E,e.__digit(E));for(;E<l;E++)u.__setDigit(E,0);return u}static __absoluteCompare(e,r){const u=e.length-r.length;if(u!=0)return u;let d=e.length-1;for(;0<=d&&e.__digit(d)===r.__digit(d);)d--;return 0>d?0:e.__unsignedDigit(d)>r.__unsignedDigit(d)?1:-1}static __multiplyAccumulate(e,r,u,d){if(r===0)return;const m=32767&r,y=r>>>15;let l=0,E=0;for(let C,k=0;k<e.length;k++,d++){C=u.__digit(d);const N=e.__digit(k),F=32767&N,B=N>>>15,W=J.__imul(F,m),re=J.__imul(F,y),ie=J.__imul(B,m),de=J.__imul(B,y);C+=E+W+l,l=C>>>30,C&=1073741823,C+=((32767&re)<<15)+((32767&ie)<<15),l+=C>>>30,E=de+(re>>>15)+(ie>>>15),u.__setDigit(d,1073741823&C)}for(;l!=0||E!==0;d++){let C=u.__digit(d);C+=l+E,E=0,l=C>>>30,u.__setDigit(d,1073741823&C)}}static __internalMultiplyAdd(e,r,u,d,m){let y=u,l=0;for(let E=0;E<d;E++){const C=e.__digit(E),k=J.__imul(32767&C,r),N=J.__imul(C>>>15,r),F=k+((32767&N)<<15)+l+y;y=F>>>30,l=N>>>15,m.__setDigit(E,1073741823&F)}if(m.length>d)for(m.__setDigit(d++,y+l);d<m.length;)m.__setDigit(d++,0);else if(y+l!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(e,r,u){u>this.length&&(u=this.length);const d=32767&e,m=e>>>15;let y=0,l=r;for(let E=0;E<u;E++){const C=this.__digit(E),k=32767&C,N=C>>>15,F=J.__imul(k,d),B=J.__imul(k,m),W=J.__imul(N,d),re=J.__imul(N,m);let ie=l+F+y;y=ie>>>30,ie&=1073741823,ie+=((32767&B)<<15)+((32767&W)<<15),y+=ie>>>30,l=re+(B>>>15)+(W>>>15),this.__setDigit(E,1073741823&ie)}if(y!=0||l!==0)throw new Error("implementation bug")}static __absoluteDivSmall(e,r,u=null){u===null&&(u=new J(e.length,!1));let d=0;for(let m,y=2*e.length-1;0<=y;y-=2){m=(d<<15|e.__halfDigit(y))>>>0;const l=0|m/r;d=0|m%r,m=(d<<15|e.__halfDigit(y-1))>>>0;const E=0|m/r;d=0|m%r,u.__setDigit(y>>>1,l<<15|E)}return u}static __absoluteModSmall(e,r){let u=0;for(let d=2*e.length-1;0<=d;d--)u=0|((u<<15|e.__halfDigit(d))>>>0)%r;return u}static __absoluteDivLarge(e,r,u,d){const m=r.__halfDigitLength(),y=r.length,l=e.__halfDigitLength()-m;let E=null;u&&(E=new J(l+2>>>1,!1),E.__initializeDigits());const C=new J(m+2>>>1,!1);C.__initializeDigits();const k=J.__clz15(r.__halfDigit(m-1));0<k&&(r=J.__specialLeftShift(r,k,0));const N=J.__specialLeftShift(e,k,1),F=r.__halfDigit(m-1);let B=0;for(let W,re=l;0<=re;re--){W=32767;const ie=N.__halfDigit(re+m);if(ie!==F){const Ee=(ie<<15|N.__halfDigit(re+m-1))>>>0;W=0|Ee/F;let we=0|Ee%F;const ke=r.__halfDigit(m-2),ge=N.__halfDigit(re+m-2);for(;J.__imul(W,ke)>>>0>(we<<16|ge)>>>0&&(W--,we+=F,!(32767<we)););}J.__internalMultiplyAdd(r,W,0,y,C);let de=N.__inplaceSub(C,re,m+1);de!==0&&(de=N.__inplaceAdd(r,re,m),N.__setHalfDigit(re+m,32767&N.__halfDigit(re+m)+de),W--),u&&(1&re?B=W<<15:E.__setDigit(re>>>1,B|W))}if(d)return N.__inplaceRightShift(k),u?{quotient:E,remainder:N}:N;if(u)return E;throw new Error("unreachable")}static __clz15(e){return J.__clz30(e)-15}__inplaceAdd(e,r,u){let d=0;for(let m=0;m<u;m++){const y=this.__halfDigit(r+m)+e.__halfDigit(m)+d;d=y>>>15,this.__setHalfDigit(r+m,32767&y)}return d}__inplaceSub(e,r,u){let d=0;if(1&r){r>>=1;let m=this.__digit(r),y=32767&m,l=0;for(;l<u-1>>>1;l++){const k=e.__digit(l),N=(m>>>15)-(32767&k)-d;d=1&N>>>15,this.__setDigit(r+l,(32767&N)<<15|32767&y),m=this.__digit(r+l+1),y=(32767&m)-(k>>>15)-d,d=1&y>>>15}const E=e.__digit(l),C=(m>>>15)-(32767&E)-d;if(d=1&C>>>15,this.__setDigit(r+l,(32767&C)<<15|32767&y),r+l+1>=this.length)throw new RangeError("out of bounds");(1&u)==0&&(m=this.__digit(r+l+1),y=(32767&m)-(E>>>15)-d,d=1&y>>>15,this.__setDigit(r+e.length,1073709056&m|32767&y))}else{r>>=1;let m=0;for(;m<e.length-1;m++){const k=this.__digit(r+m),N=e.__digit(m),F=(32767&k)-(32767&N)-d;d=1&F>>>15;const B=(k>>>15)-(N>>>15)-d;d=1&B>>>15,this.__setDigit(r+m,(32767&B)<<15|32767&F)}const y=this.__digit(r+m),l=e.__digit(m),E=(32767&y)-(32767&l)-d;d=1&E>>>15;let C=0;(1&u)==0&&(C=(y>>>15)-(l>>>15)-d,d=1&C>>>15),this.__setDigit(r+m,(32767&C)<<15|32767&E)}return d}__inplaceRightShift(e){if(e===0)return;let r=this.__digit(0)>>>e;const u=this.length-1;for(let d=0;d<u;d++){const m=this.__digit(d+1);this.__setDigit(d,1073741823&m<<30-e|r),r=m>>>e}this.__setDigit(u,r)}static __specialLeftShift(e,r,u){const d=e.length,m=new J(d+u,!1);if(r===0){for(let l=0;l<d;l++)m.__setDigit(l,e.__digit(l));return 0<u&&m.__setDigit(d,0),m}let y=0;for(let l=0;l<d;l++){const E=e.__digit(l);m.__setDigit(l,1073741823&E<<r|y),y=E>>>30-r}return 0<u&&m.__setDigit(d,y),m}static __leftShiftByAbsolute(e,r){const u=J.__toShiftAmount(r);if(0>u)throw new RangeError("BigInt too big");const d=0|u/30,m=u%30,y=e.length,l=m!==0&&e.__digit(y-1)>>>30-m!=0,E=y+d+(l?1:0),C=new J(E,e.sign);if(m===0){let k=0;for(;k<d;k++)C.__setDigit(k,0);for(;k<E;k++)C.__setDigit(k,e.__digit(k-d))}else{let k=0;for(let N=0;N<d;N++)C.__setDigit(N,0);for(let N=0;N<y;N++){const F=e.__digit(N);C.__setDigit(N+d,1073741823&F<<m|k),k=F>>>30-m}if(l)C.__setDigit(y+d,k);else if(k!==0)throw new Error("implementation bug")}return C.__trim()}static __rightShiftByAbsolute(e,r){const u=e.length,d=e.sign,m=J.__toShiftAmount(r);if(0>m)return J.__rightShiftByMaximum(d);const y=0|m/30,l=m%30;let E=u-y;if(0>=E)return J.__rightShiftByMaximum(d);let C=!1;if(d){if((e.__digit(y)&(1<<l)-1)!=0)C=!0;else for(let N=0;N<y;N++)if(e.__digit(N)!==0){C=!0;break}}C&&l===0&&~e.__digit(u-1)==0&&E++;let k=new J(E,d);if(l===0){k.__setDigit(E-1,0);for(let N=y;N<u;N++)k.__setDigit(N-y,e.__digit(N))}else{let N=e.__digit(y)>>>l;const F=u-y-1;for(let B=0;B<F;B++){const W=e.__digit(B+y+1);k.__setDigit(B,1073741823&W<<30-l|N),N=W>>>l}k.__setDigit(F,N)}return C&&(k=J.__absoluteAddOne(k,!0,k)),k.__trim()}static __rightShiftByMaximum(e){return e?J.__oneDigit(1,!0):J.__zero()}static __toShiftAmount(e){if(1<e.length)return-1;const r=e.__unsignedDigit(0);return r>J.__kMaxLengthBits?-1:r}static __toPrimitive(e,r="default"){if(typeof e!="object"||e.constructor===J)return e;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const m=e[Symbol.toPrimitive];if(m){const y=m(r);if(typeof y!="object")return y;throw new TypeError("Cannot convert object to primitive value")}}const u=e.valueOf;if(u){const m=u.call(e);if(typeof m!="object")return m}const d=e.toString;if(d){const m=d.call(e);if(typeof m!="object")return m}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(e){return J.__isBigInt(e)?e:+e}static __isBigInt(e){return typeof e=="object"&&e!==null&&e.constructor===J}static __truncateToNBits(e,r){const u=0|(e+29)/30,d=new J(u,r.sign),m=u-1;for(let l=0;l<m;l++)d.__setDigit(l,r.__digit(l));let y=r.__digit(m);if(e%30!=0){const l=32-e%30;y=y<<l>>>l}return d.__setDigit(m,y),d.__trim()}static __truncateAndSubFromPowerOfTwo(e,r,u){var d=Math.min;const m=0|(e+29)/30,y=new J(m,u);let l=0;const E=m-1;let C=0;for(const B=d(E,r.length);l<B;l++){const W=0-r.__digit(l)-C;C=1&W>>>30,y.__setDigit(l,1073741823&W)}for(;l<E;l++)y.__setDigit(l,0|1073741823&-C);let k=E<r.length?r.__digit(E):0;const N=e%30;let F;if(N==0)F=0-k-C,F&=1073741823;else{const B=32-N;k=k<<B>>>B;const W=1<<32-B;F=W-k-C,F&=W-1}return y.__setDigit(E,F),y.__trim()}__digit(e){return this[e]}__unsignedDigit(e){return this[e]>>>0}__setDigit(e,r){this[e]=0|r}__setDigitGrow(e,r){this[e]=0|r}__halfDigitLength(){const e=this.length;return 32767>=this.__unsignedDigit(e-1)?2*e-1:2*e}__halfDigit(e){return 32767&this[e>>>1]>>>15*(1&e)}__setHalfDigit(e,r){const u=e>>>1,d=this.__digit(u),m=1&e?32767&d|r<<15:1073709056&d|32767&r;this.__setDigit(u,m)}static __digitPow(e,r){let u=1;for(;0<r;)1&r&&(u*=e),r>>>=1,e*=e;return u}static __isOneDigitInt(e){return(1073741823&e)===e}}J.__kMaxLength=33554432,J.__kMaxLengthBits=J.__kMaxLength<<5,J.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],J.__kBitsPerCharTableShift=5,J.__kBitsPerCharTableMultiplier=1<<J.__kBitsPerCharTableShift,J.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],J.__kBitConversionBuffer=new ArrayBuffer(8),J.__kBitConversionDouble=new Float64Array(J.__kBitConversionBuffer),J.__kBitConversionInts=new Int32Array(J.__kBitConversionBuffer),J.__clz30=Math.clz32?function(n){return Math.clz32(n)-2}:function(n){return n===0?30:0|29-(0|Math.log(n>>>0)/Math.LN2)},J.__imul=Math.imul||function(n,e){return 0|n*e};const dl=J.BigInt(0),z0=J.BigInt(1),yw=J.BigInt(2),D5=J.BigInt(10),I5=J.BigInt(24),R5=J.BigInt(60),k5=J.BigInt(1e3),e_=J.BigInt(1e6),S0=J.BigInt(1e9),yA=J.multiply(J.BigInt(3600),S0),P5=J.multiply(R5,S0),kf=J.multiply(yA,I5);function td(n){return typeof n=="bigint"?J.BigInt(n.toString(10)):n}function _A(n){return J.equal(J.remainder(n,yw),dl)}function Cp(n){return J.lessThan(n,dl)?J.unaryMinus(n):n}function $v(n,e){return J.lessThan(n,e)?-1:J.greaterThan(n,e)?1:0}function f0(n,e){return{quotient:J.divide(n,e),remainder:J.remainder(n,e)}}var BT,UT;const wn="slot-epochNanoSeconds",Tn="slot-iso-date",dr="slot-iso-date-time",Rr="slot-time",Rt="slot-calendar",vA="slot-date-brand",bA="slot-year-month-brand",xA="slot-month-day-brand",Si="slot-time-zone",Jo="slot-years",es="slot-months",Ps="slot-weeks",ts="slot-days",ns="slot-hours",is="slot-minutes",rs="slot-seconds",as="slot-milliseconds",os="slot-microseconds",Os="slot-nanoseconds",wA="date",TA="ym",SA="md",EA="time",MA="datetime",AA="instant",Qp="original",yg="timezone-canonical",a1="timezone-original",p0="calendar-id",CA="locale",o1="options",DA=new WeakMap,s1=Symbol.for("@@Temporal__GetSlots");(BT=globalThis)[s1]||(BT[s1]=function(n){return DA.get(n)});const xb=globalThis[s1],l1=Symbol.for("@@Temporal__CreateSlots");(UT=globalThis)[l1]||(UT[l1]=function(n){DA.set(n,Object.create(null))});const Md=globalThis[l1];function ds(n,...e){if(!n||typeof n!="object")return!1;const r=xb(n);return!!r&&e.every(u=>u in r)}function oe(n,e){const r=xb(n)?.[e];if(r===void 0)throw new TypeError(`Missing internal slot ${e}`);return r}function Bn(n,e,r){const u=xb(n);if(u===void 0)throw new TypeError("Missing slots for the given container");if(u[e])throw new TypeError(`${e} already has set`);u[e]=r}const c1={};function Ad(n,e){Object.defineProperty(n.prototype,Symbol.toStringTag,{value:e,writable:!1,enumerable:!1,configurable:!0});const r=Object.getOwnPropertyNames(n);for(let d=0;d<r.length;d++){const m=r[d],y=Object.getOwnPropertyDescriptor(n,m);y.configurable&&y.enumerable&&(y.enumerable=!1,Object.defineProperty(n,m,y))}const u=Object.getOwnPropertyNames(n.prototype);for(let d=0;d<u.length;d++){const m=u[d],y=Object.getOwnPropertyDescriptor(n.prototype,m);y.configurable&&y.enumerable&&(y.enumerable=!1,Object.defineProperty(n.prototype,m,y))}u1(e,n),u1(`${e}.prototype`,n.prototype)}function u1(n,e){const r=`%${n}%`;if(c1[r]!==void 0)throw new Error(`intrinsic ${n} already exists`);c1[r]=e}function ho(n){return c1[n]}function vg(n,e){let r=n;if(r===0)return{div:r,mod:r};const u=Math.sign(r);r=Math.abs(r);const d=Math.trunc(1+Math.log10(r));if(e>=d)return{div:0*u,mod:u*r};if(e===0)return{div:u*r,mod:0*u};const m=r.toPrecision(d);return{div:u*Number.parseInt(m.slice(0,d-e),10),mod:u*Number.parseInt(m.slice(d-e),10)}}function Cx(n,e,r){let u=n,d=r;if(u===0)return d;const m=Math.sign(u)||Math.sign(d);u=Math.abs(u),d=Math.abs(d);const y=u.toPrecision(Math.trunc(1+Math.log10(u)));if(d===0)return m*Number.parseInt(y+"0".repeat(e),10);const l=y+d.toPrecision(Math.trunc(1+Math.log10(d))).padStart(e,"0");return m*Number.parseInt(l,10)}function wb(n,e){const r=e==="negative";switch(n){case"ceil":return r?"zero":"infinity";case"floor":return r?"infinity":"zero";case"expand":return"infinity";case"trunc":return"zero";case"halfCeil":return r?"half-zero":"half-infinity";case"halfFloor":return r?"half-infinity":"half-zero";case"halfExpand":return"half-infinity";case"halfTrunc":return"half-zero";case"halfEven":return"half-even"}}function Tb(n,e,r,u,d){return d==="zero"?n:d==="infinity"?e:r<0?n:r>0?e:d==="half-zero"?n:d==="half-infinity"?e:u?n:e}class Hn{constructor(e){this.totalNs=td(e),this.sec=J.toNumber(J.divide(this.totalNs,S0)),this.subsec=J.toNumber(J.remainder(this.totalNs,S0))}static validateNew(e,r){if(J.greaterThan(Cp(e),Hn.MAX))throw new RangeError(`${r} of duration time units cannot exceed ${Hn.MAX} s`);return new Hn(e)}static fromEpochNsDiff(e,r){const u=J.subtract(td(e),td(r));return new Hn(u)}static fromComponents(e,r,u,d,m,y){const l=J.add(J.add(J.add(J.add(J.add(J.BigInt(y),J.multiply(J.BigInt(m),k5)),J.multiply(J.BigInt(d),e_)),J.multiply(J.BigInt(u),S0)),J.multiply(J.BigInt(r),P5)),J.multiply(J.BigInt(e),yA));return Hn.validateNew(l,"total")}abs(){return new Hn(Cp(this.totalNs))}add(e){return Hn.validateNew(J.add(this.totalNs,e.totalNs),"sum")}add24HourDays(e){return Hn.validateNew(J.add(this.totalNs,J.multiply(J.BigInt(e),kf)),"sum")}addToEpochNs(e){return J.add(td(e),this.totalNs)}cmp(e){return $v(this.totalNs,e.totalNs)}divmod(e){const{quotient:r,remainder:u}=f0(this.totalNs,J.BigInt(e));return{quotient:J.toNumber(r),remainder:new Hn(u)}}fdiv(e){const r=td(e),u=J.BigInt(r);let{quotient:d,remainder:m}=f0(this.totalNs,u);const y=[];let l;const E=(J.lessThan(this.totalNs,dl)?-1:1)*Math.sign(J.toNumber(r));for(;!J.equal(m,dl)&&y.length<50;)m=J.multiply(m,D5),{quotient:l,remainder:m}=f0(m,u),y.push(Math.abs(J.toNumber(l)));return E*+(Cp(d).toString()+"."+y.join(""))}isZero(){return J.equal(this.totalNs,dl)}round(e,r){const u=td(e);if(J.equal(u,z0))return this;const{quotient:d,remainder:m}=f0(this.totalNs,u),y=J.lessThan(this.totalNs,dl)?"negative":"positive",l=J.multiply(Cp(d),u),E=J.add(l,u),C=$v(Cp(J.multiply(m,yw)),u),k=wb(r,y),N=J.equal(Cp(this.totalNs),l)?l:Tb(l,E,C,_A(d),k),F=y==="positive"?N:J.unaryMinus(N);return Hn.validateNew(F,"rounding")}sign(){return this.cmp(new Hn(dl))}subtract(e){return Hn.validateNew(J.subtract(this.totalNs,e.totalNs),"difference")}}Hn.MAX=J.BigInt("9007199254740991999999999"),Hn.ZERO=new Hn(dl);const VT=/[A-Za-z._][A-Za-z._0-9+-]*/,t_=new RegExp(`(?:${/(?:[+-](?:[01][0-9]|2[0-3])(?::?[0-5][0-9])?)/.source}|(?:${VT.source})(?:\\/(?:${VT.source}))*)`),IA=/(?:[+-]\d{6}|\d{4})/,Zv=/(?:0[1-9]|1[0-2])/,h1=/(?:0[1-9]|[12]\d|3[01])/,O5=new RegExp(`(${IA.source})(?:-(${Zv.source})-(${h1.source})|(${Zv.source})(${h1.source}))`),RA=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,kA=/((?:[+-])(?:[01][0-9]|2[0-3])(?::?(?:[0-5][0-9])(?::?(?:[0-5][0-9])(?:[.,](?:\d{1,9}))?)?)?)/,PA=new RegExp(`([zZ])|${kA.source}?`),Og=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,L5=new RegExp([`^${O5.source}`,`(?:(?:[tT]|\\s+)${RA.source}(?:${PA.source})?)?`,`(?:\\[!?(${t_.source})\\])?`,`((?:${Og.source})*)$`].join("")),N5=new RegExp([`^[tT]?${RA.source}`,`(?:${PA.source})?`,`(?:\\[!?${t_.source}\\])?`,`((?:${Og.source})*)$`].join("")),z5=new RegExp(`^(${IA.source})-?(${Zv.source})(?:\\[!?${t_.source}\\])?((?:${Og.source})*)$`),j5=new RegExp(`^(?:--)?(${Zv.source})-?(${h1.source})(?:\\[!?${t_.source}\\])?((?:${Og.source})*)$`),Dx=/(\d+)(?:[.,](\d{1,9}))?/,F5=new RegExp(`(?:${Dx.source}H)?(?:${Dx.source}M)?(?:${Dx.source}S)?`),B5=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${F5.source})?$`,"i"),Pf=864e5,Yv=1e6*Pf,U5=6e10,OA=1e8*Pf,Lg=qu(OA),j0=J.unaryMinus(Lg),V5=J.add(J.subtract(j0,kf),z0),G5=J.subtract(J.add(Lg,kf),z0),$5=146097*Pf,GT=-271821,$T=275760,E0=Date.UTC(1847,0,1),Z5=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","ethiopic-amete-alem","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"],Y5=new Set(["ACT","AET","AGT","ART","AST","BET","BST","CAT","CNT","CST","CTT","EAT","ECT","IET","IST","JST","MIT","NET","NST","PLT","PNT","PRT","PST","SST","VST"]);function kr(n){return typeof n=="object"&&n!==null||typeof n=="function"}function Sb(n){if(typeof n=="bigint")throw new TypeError("Cannot convert BigInt to number");return Number(n)}function Eb(n){if(typeof n=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return String(n)}function Cn(n){const e=Sb(n);if(e===0)return 0;if(Number.isNaN(e)||e===1/0||e===-1/0)throw new RangeError("invalid number value");const r=Math.trunc(e);return r===0?0:r}function ZT(n,e){const r=Cn(n);if(r<=0)throw e!==void 0?new RangeError(`property '${e}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return r}function Uc(n){const e=Sb(n);if(Number.isNaN(e))throw new RangeError("not a number");if(e===1/0||e===-1/0)throw new RangeError("infinity is out of range");if(!function(r){if(typeof r!="number"||Number.isNaN(r)||r===1/0||r===-1/0)return!1;const u=Math.abs(r);return Math.floor(u)===u}(e))throw new RangeError(`unsupported fractional value ${n}`);return e===0?0:e}function F0(n,e){return String(n).padStart(e,"0")}function Ma(n){if(typeof n!="string")throw new TypeError(`expected a string, not ${String(n)}`);return n}function d1(n,e){if(kr(n)){const r=n?.toString();if(typeof r=="string"||typeof r=="number")return r;throw new TypeError("Cannot convert object to primitive value")}return n}const f1=["era","eraYear","year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],H5={era:Eb,eraYear:Cn,year:Cn,month:ZT,monthCode:function(n){const e=Ma(d1(n));if(e.length<3||e.length>4||e[0]!=="M"||"0123456789".indexOf(e[1])===-1||"0123456789".indexOf(e[2])===-1||e[1]+e[2]==="00"&&e[3]!=="L"||e[3]!=="L"&&e[3]!==void 0)throw new RangeError(`bad month code ${e}; must match M01-M99 or M00L-M99L`);return e},day:ZT,hour:Cn,minute:Cn,second:Cn,millisecond:Cn,microsecond:Cn,nanosecond:Cn,offset:function(n){const e=Ma(d1(n));return ey(e),e},timeZone:cs},q5={hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},Ng=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],YT=Object.fromEntries(Ng.map(n=>[n[0],n[1]])),X5=Object.fromEntries(Ng.map(([n,e])=>[e,n])),M0=Ng.map(([,n])=>n),zg={day:Yv,hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},Hv=["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],W5=Intl.DateTimeFormat,HT=new Map;function LA(n){const e=$0(n);let r=HT.get(e);return r===void 0&&(r=new W5("en-us",{timeZone:e,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),HT.set(e,r)),r}function so(n){return ds(n,wn)&&!ds(n,Si,Rt)}function Dr(n){return ds(n,Jo,es,ts,ns,is,rs,as,os,Os)}function Ir(n){return ds(n,vA)}function Ur(n){return ds(n,Rr)}function nr(n){return ds(n,dr)}function lo(n){return ds(n,bA)}function hl(n){return ds(n,xA)}function Yn(n){return ds(n,wn,Si,Rt)}function rt(n,e){if(!e(n))throw new TypeError("invalid receiver: method called with the wrong type of this-object")}function Qg(n){if(ds(n,Rt)||ds(n,Si))throw new TypeError("with() does not support a calendar or timeZone property");if(Ur(n))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(n.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(n.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function n_(n,e){return e==="never"||e==="auto"&&n==="iso8601"?"":`[${e==="critical"?"!":""}u-ca=${n}]`}function Mb(n){let e,r,u=!1;for(Og.lastIndex=0;r=Og.exec(n);){const{1:d,2:m,3:y}=r;if(m==="u-ca"){if(e===void 0)e=y,u=d==="!";else if(d==="!"||u)throw new RangeError(`Invalid annotations in ${n}: more than one u-ca present with critical flag`)}else if(d==="!")throw new RangeError(`Unrecognized annotation: !${m}=${y}`)}return e}function ih(n){const e=L5.exec(n);if(!e)throw new RangeError(`invalid RFC 9557 string: ${n}`);const r=Mb(e[16]);let u=e[1];if(u==="-000000")throw new RangeError(`invalid RFC 9557 string: ${n}`);const d=+u,m=+(e[2]??e[4]??1),y=+(e[3]??e[5]??1),l=e[6]!==void 0,E=+(e[6]??0),C=+(e[7]??e[10]??0);let k=+(e[8]??e[11]??0);k===60&&(k=59);const N=(e[9]??e[12]??"")+"000000000",F=+N.slice(0,3),B=+N.slice(3,6),W=+N.slice(6,9);let re,ie=!1;e[13]?(re=void 0,ie=!0):e[14]&&(re=e[14]);const de=e[15];return Tw(d,m,y,E,C,k,F,B,W),{year:d,month:m,day:y,time:l?{hour:E,minute:C,second:k,millisecond:F,microsecond:B,nanosecond:W}:"start-of-day",tzAnnotation:de,offset:re,z:ie,calendar:r}}function NA(n){const e=N5.exec(n);let r,u,d,m,y,l,E;if(e){E=Mb(e[10]),r=+(e[1]??0),u=+(e[2]??e[5]??0),d=+(e[3]??e[6]??0),d===60&&(d=59);const C=(e[4]??e[7]??"")+"000000000";if(m=+C.slice(0,3),y=+C.slice(3,6),l=+C.slice(6,9),e[8])throw new RangeError("Z designator not supported for PlainTime")}else{let C,k;if({time:C,z:k,calendar:E}=ih(n),C==="start-of-day")throw new RangeError(`time is missing in string: ${n}`);if(k)throw new RangeError("Z designator not supported for PlainTime");({hour:r,minute:u,second:d,millisecond:m,microsecond:y,nanosecond:l}=C)}if(Ib(r,u,d,m,y,l),/[tT ][0-9][0-9]/.test(n))return{hour:r,minute:u,second:d,millisecond:m,microsecond:y,nanosecond:l,calendar:E};try{const{month:C,day:k}=vw(n);Vp(1972,C,k)}catch{try{const{year:C,month:k}=_w(n);Vp(C,k,1)}catch{return{hour:r,minute:u,second:d,millisecond:m,microsecond:y,nanosecond:l,calendar:E}}}throw new RangeError(`invalid RFC 9557 time-only string ${n}; may need a T prefix`)}function _w(n){const e=z5.exec(n);let r,u,d,m;if(e){d=Mb(e[3]);let y=e[1];if(y==="-000000")throw new RangeError(`invalid RFC 9557 string: ${n}`);if(r=+y,u=+e[2],m=1,d!==void 0&&d!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let y;if({year:r,month:u,calendar:d,day:m,z:y}=ih(n),y)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:r,month:u,calendar:d,referenceISODay:m}}function vw(n){const e=j5.exec(n);let r,u,d,m;if(e){if(d=Mb(e[3]),r=+e[1],u=+e[2],d!==void 0&&d!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let y;if({month:r,day:u,calendar:d,year:m,z:y}=ih(n),y)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:r,day:u,calendar:d,referenceISOYear:m}}const zA=new RegExp(`^${t_.source}$`,"i"),jA=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])?)?/.source}$`);function FA(n){const e=K5.test(n)?"Seconds not allowed in offset time zone":"Invalid time zone";throw new RangeError(`${e}: ${n}`)}function Df(n){return zA.test(n)||FA(n),jA.test(n)?{offsetMinutes:ey(n)/6e10}:{tzName:n}}function A0(n,e,r,u){let d=n,m=e,y=r;switch(u){case"reject":Vp(d,m,y);break;case"constrain":({year:d,month:m,day:y}=nC(d,m,y))}return{year:d,month:m,day:y}}function Ab(n,e,r,u,d,m,y){let l=n,E=e,C=r,k=u,N=d,F=m;switch(y){case"reject":Ib(l,E,C,k,N,F);break;case"constrain":l=ss(l,0,23),E=ss(E,0,59),C=ss(C,0,59),k=ss(k,0,999),N=ss(N,0,999),F=ss(F,0,999)}return{hour:l,minute:E,second:C,millisecond:k,microsecond:N,nanosecond:F}}function BA(n){if(!kr(n))throw new TypeError("invalid duration-like");const e={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let r=!1;for(let u=0;u<Hv.length;u++){const d=Hv[u],m=n[d];m!==void 0&&(r=!0,e[d]=Uc(m))}if(!r)throw new TypeError("invalid duration-like");return e}function Oo({years:n,months:e,weeks:r,days:u},d,m,y){return{years:n,months:y??e,weeks:m??r,days:d??u}}function hi(n,e){return{isoDate:n,time:e}}function li(n){return gd(n,"overflow",["constrain","reject"],"constrain")}function C0(n){return gd(n,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function Yc(n,e){return gd(n,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],e)}function Cv(n,e){return gd(n,"offset",["prefer","use","ignore","reject"],e)}function i_(n){return gd(n,"calendarName",["auto","always","never","critical"],"auto")}function Kg(n){let e=n.roundingIncrement;if(e===void 0)return 1;const r=Cn(e);if(r<1||r>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${e}`);return r}function Jg(n,e,r){const u=r?e:e-1;if(n>u)throw new RangeError(`roundingIncrement must be at least 1 and less than ${u}, not ${n}`);if(e%n!=0)throw new RangeError(`Rounding increment must divide evenly into ${e}`)}function r_(n){const e=n.fractionalSecondDigits;if(e===void 0)return"auto";if(typeof e!="number"){if(Eb(e)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`);return"auto"}const r=Math.floor(e);if(!Number.isFinite(r)||r<0||r>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`);return r}function a_(n,e){switch(n){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(e){case"auto":return{precision:e,unit:"nanosecond",increment:1};case 0:return{precision:e,unit:"second",increment:1};case 1:case 2:case 3:return{precision:e,unit:"millisecond",increment:10**(3-e)};case 4:case 5:case 6:return{precision:e,unit:"microsecond",increment:10**(6-e)};case 7:case 8:case 9:return{precision:e,unit:"nanosecond",increment:10**(9-e)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`)}}const wd=Symbol("~required~");function Ns(n,e,r,u,d=[]){let m=[];for(let C=0;C<Ng.length;C++){const k=Ng[C],N=k[1],F=k[2];r!=="datetime"&&r!==F||m.push(N)}m=m.concat(d);let y=u;y===wd?y=void 0:y!==void 0&&m.push(y);let l=[];l=l.concat(m);for(let C=0;C<m.length;C++){const k=m[C],N=X5[k];N!==void 0&&l.push(N)}let E=gd(n,e,l,y);if(E===void 0&&u===wd)throw new RangeError(`${e} is required`);return E&&E in YT?YT[E]:E}function Ix(n){const e=n.relativeTo;if(e===void 0)return{};let r,u,d,m,y,l="option",E=!1;if(kr(e)){if(Yn(e))return{zonedRelativeTo:e};if(Ir(e))return{plainRelativeTo:e};if(nr(e))return{plainRelativeTo:ls(oe(e,dr).isoDate,oe(e,Rt))};d=u_(e);const C=vl(d,e,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],[]);({isoDate:r,time:u}=s_(d,C,"constrain")),{offset:y,timeZone:m}=C,y===void 0&&(l="wall")}else{let C,k,N,F,B;if({year:N,month:F,day:B,time:u,calendar:d,tzAnnotation:C,offset:y,z:k}=ih(Ma(e)),C)m=cs(C),k?l="exact":y||(l="wall"),E=!0;else if(k)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");d||(d="iso8601"),d=fs(d),r={year:N,month:F,day:B}}return m===void 0?{plainRelativeTo:ls(r,d)}:{zonedRelativeTo:Po(qv(r,u,l,l==="option"?ey(y):0,m,"compatible","reject",E),m,d)}}function id(n){return oe(n,Jo)!==0?"year":oe(n,es)!==0?"month":oe(n,Ps)!==0?"week":oe(n,ts)!==0?"day":oe(n,ns)!==0?"hour":oe(n,is)!==0?"minute":oe(n,rs)!==0?"second":oe(n,as)!==0?"millisecond":oe(n,os)!==0?"microsecond":"nanosecond"}function pd(n,e){return M0.indexOf(n)>M0.indexOf(e)?e:n}function Vu(n){return n==="year"||n==="month"||n==="week"}function rd(n){return Vu(n)||n==="day"?"date":"time"}function jf(n){return ho("%calendarImpl%")(n)}function o_(n){return ho("%calendarImpl%")(oe(n,Rt))}function us(n,e,r="date"){const u=Object.create(null),d=jf(n).isoToDate(e,{year:!0,monthCode:!0,day:!0});return u.monthCode=d.monthCode,r!=="month-day"&&r!=="date"||(u.day=d.day),r!=="year-month"&&r!=="date"||(u.year=d.year),u}function vl(n,e,r,u,d){const m=jf(n).extraFields(r),y=r.concat(u,m),l=Object.create(null);let E=!1;y.sort();for(let C=0;C<y.length;C++){const k=y[C],N=e[k];if(N!==void 0)E=!0,l[k]=(0,H5[k])(N);else if(d!=="partial"){if(d.includes(k))throw new TypeError(`required property '${k}' missing or undefined`);l[k]=q5[k]}}if(d==="partial"&&!E)throw new TypeError("no supported properties found");return l}function p1(n,e="complete"){const r=["hour","microsecond","millisecond","minute","nanosecond","second"];let u=!1;const d=Object.create(null);for(let m=0;m<r.length;m++){const y=r[m],l=n[y];l!==void 0?(d[y]=Cn(l),u=!0):e==="complete"&&(d[y]=0)}if(!u)throw new TypeError("invalid time-like");return d}function m0(n,e){if(kr(n)){if(Ir(n))return li(tn(e)),ls(oe(n,Tn),oe(n,Rt));if(Yn(n)){const E=Xl(oe(n,Si),oe(n,wn));return li(tn(e)),ls(E.isoDate,oe(n,Rt))}if(nr(n))return li(tn(e)),ls(oe(n,dr).isoDate,oe(n,Rt));const l=u_(n);return ls(Of(l,vl(l,n,["year","month","monthCode","day"],[],[]),li(tn(e))),l)}let{year:r,month:u,day:d,calendar:m,z:y}=ih(Ma(n));if(y)throw new RangeError("Z designator not supported for PlainDate");return m||(m="iso8601"),m=fs(m),li(tn(e)),ls({year:r,month:u,day:d},m)}function s_(n,e,r){return hi(Of(n,e,r),Ab(e.hour,e.minute,e.second,e.millisecond,e.microsecond,e.nanosecond,r))}function g0(n,e){let r,u,d;if(kr(n)){if(nr(n))return li(tn(e)),Gl(oe(n,dr),oe(n,Rt));if(Yn(n)){const l=Xl(oe(n,Si),oe(n,wn));return li(tn(e)),Gl(l,oe(n,Rt))}if(Ir(n))return li(tn(e)),Gl(hi(oe(n,Tn),{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),oe(n,Rt));d=u_(n);const m=vl(d,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],[]),y=li(tn(e));({isoDate:r,time:u}=s_(d,m,y))}else{let m,y,l,E;if({year:y,month:l,day:E,time:u,calendar:d,z:m}=ih(Ma(n)),m)throw new RangeError("Z designator not supported for PlainDateTime");u==="start-of-day"&&(u={deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),Tw(y,l,E,u.hour,u.minute,u.second,u.millisecond,u.microsecond,u.nanosecond),d||(d="iso8601"),d=fs(d),li(tn(e)),r={year:y,month:l,day:E}}return Gl(hi(r,u),d)}function Yl(n){const e=ho("%Temporal.Duration%");if(Dr(n))return new e(oe(n,Jo),oe(n,es),oe(n,Ps),oe(n,ts),oe(n,ns),oe(n,is),oe(n,rs),oe(n,as),oe(n,os),oe(n,Os));if(!kr(n))return function(d){const{years:m,months:y,weeks:l,days:E,hours:C,minutes:k,seconds:N,milliseconds:F,microseconds:B,nanoseconds:W}=function(re){const ie=B5.exec(re);if(!ie)throw new RangeError(`invalid duration: ${re}`);if(ie.every((_t,ut)=>ut<2||_t===void 0))throw new RangeError(`invalid duration: ${re}`);const de=ie[1]==="-"?-1:1,Ee=ie[2]===void 0?0:Cn(ie[2])*de,we=ie[3]===void 0?0:Cn(ie[3])*de,ke=ie[4]===void 0?0:Cn(ie[4])*de,ge=ie[5]===void 0?0:Cn(ie[5])*de,Ae=ie[6]===void 0?0:Cn(ie[6])*de,Ge=ie[7],at=ie[8],Me=ie[9],Qe=ie[10],St=ie[11];let bt=0,zt=0,Zt=0;if(Ge!==void 0){if(at??Me??Qe??St)throw new RangeError("only the smallest unit can be fractional");Zt=3600*Cn((Ge+"000000000").slice(0,9))*de}else if(bt=at===void 0?0:Cn(at)*de,Me!==void 0){if(Qe??St)throw new RangeError("only the smallest unit can be fractional");Zt=60*Cn((Me+"000000000").slice(0,9))*de}else zt=Qe===void 0?0:Cn(Qe)*de,St!==void 0&&(Zt=Cn((St+"000000000").slice(0,9))*de);const Ft=Zt%1e3,Be=Math.trunc(Zt/1e3)%1e3,lt=Math.trunc(Zt/1e6)%1e3;return zt+=Math.trunc(Zt/1e9)%60,bt+=Math.trunc(Zt/6e10),Rb(Ee,we,ke,ge,Ae,bt,zt,lt,Be,Ft),{years:Ee,months:we,weeks:ke,days:ge,hours:Ae,minutes:bt,seconds:zt,milliseconds:lt,microseconds:Be,nanoseconds:Ft}}(d);return new(ho("%Temporal.Duration%"))(m,y,l,E,C,k,N,F,B,W)}(Ma(n));const r={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let u=BA(n);for(let d=0;d<Hv.length;d++){const m=Hv[d],y=u[m];y!==void 0&&(r[m]=y)}return new e(r.years,r.months,r.weeks,r.days,r.hours,r.minutes,r.seconds,r.milliseconds,r.microseconds,r.nanoseconds)}function y0(n){let e;if(kr(n)){if(so(n)||Yn(n))return Yu(oe(n,wn));e=d1(n)}else e=n;const{year:r,month:u,day:d,time:m,offset:y,z:l}=function(re){const ie=ih(re);if(!ie.z&&!ie.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return ie}(Ma(e)),{hour:E=0,minute:C=0,second:k=0,millisecond:N=0,microsecond:F=0,nanosecond:B=0}=m==="start-of-day"?{}:m,W=G0(r,u,d,E,C,k,N,F,B-(l?0:ey(y)));return Eg(W.isoDate),Yu(uo(W))}function qT(n,e){if(kr(n)){if(hl(n))return li(tn(e)),bg(oe(n,Tn),oe(n,Rt));let l;return ds(n,Rt)?l=oe(n,Rt):(l=n.calendar,l===void 0&&(l="iso8601"),l=c_(l)),bg(Xv(l,vl(l,n,["year","month","monthCode","day"],[],[]),li(tn(e))),l)}let{month:r,day:u,referenceISOYear:d,calendar:m}=vw(Ma(n));if(m===void 0&&(m="iso8601"),m=fs(m),li(tn(e)),m==="iso8601")return bg({year:1972,month:r,day:u},m);let y={year:d,month:r,day:u};return Kp(y),y=Xv(m,us(m,y,"month-day"),"constrain"),bg(y,m)}function Ef(n,e){let r;if(kr(n)){if(Ur(n))return li(tn(e)),sd(oe(n,Rr));if(nr(n))return li(tn(e)),sd(oe(n,dr).time);if(Yn(n)){const C=Xl(oe(n,Si),oe(n,wn));return li(tn(e)),sd(C.time)}const{hour:u,minute:d,second:m,millisecond:y,microsecond:l,nanosecond:E}=p1(n);r=Ab(u,d,m,y,l,E,li(tn(e)))}else r=NA(Ma(n)),li(tn(e));return sd(r)}function UA(n){return n===void 0?{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}:oe(Ef(n),Rr)}function _0(n,e){if(kr(n)){if(lo(n))return li(tn(e)),Sg(oe(n,Tn),oe(n,Rt));const l=u_(n);return Sg(B0(l,vl(l,n,["year","month","monthCode"],[],[]),li(tn(e))),l)}let{year:r,month:u,referenceISODay:d,calendar:m}=_w(Ma(n));m===void 0&&(m="iso8601"),m=fs(m),li(tn(e));let y={year:r,month:u,day:d};return Sw(y),y=B0(m,us(m,y,"year-month"),"constrain"),Sg(y,m)}function qv(n,e,r,u,d,m,y,l){if(e==="start-of-day")return Tf(d,n);const E=hi(n,e);if(r==="wall"||y==="ignore")return Lo(d,E,m);if(r==="exact"||y==="use"){const N=G0(n.year,n.month,n.day,e.hour,e.minute,e.second,e.millisecond,e.microsecond,e.nanosecond-u);Eg(N.isoDate);const F=uo(N);return eh(F),F}Eg(n);const C=uo(E),k=U0(d,E);for(let N=0;N<k.length;N++){const F=k[N],B=J.toNumber(J.subtract(C,F)),W=Mf(B,6e10,"halfExpand");if(B===u||l&&W===u)return F}if(y==="reject"){const N=m1(u),F=V0(E,"iso8601","auto");throw new RangeError(`Offset ${N} is invalid for ${F} in ${d}`)}return WA(k,d,E,m)}function v0(n,e){let r,u,d,m,y,l,E,C=!1,k="option";if(kr(n)){if(Yn(n)){const re=tn(e);return C0(re),Cv(re,"reject"),li(re),Po(oe(n,wn),oe(n,Si),oe(n,Rt))}y=u_(n);const F=vl(y,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],["timeZone"]);({offset:m,timeZone:d}=F),m===void 0&&(k="wall");const B=tn(e);l=C0(B),E=Cv(B,"reject");const W=li(B);({isoDate:r,time:u}=s_(y,F,W))}else{let F,B,W,re,ie;({year:W,month:re,day:ie,time:u,tzAnnotation:F,offset:m,z:B,calendar:y}=function(Ee){const we=ih(Ee);if(!we.tzAnnotation)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return we}(Ma(n))),d=cs(F),B?k="exact":m||(k="wall"),y||(y="iso8601"),y=fs(y),C=!0;const de=tn(e);l=C0(de),E=Cv(de,"reject"),li(de),r={year:W,month:re,day:ie}}let N=0;return k==="option"&&(N=ey(m)),Po(qv(r,u,k,N,d,l,E,C),d,y)}function VA(n,e,r){Kp(e),Md(n),Bn(n,Tn,e),Bn(n,Rt,r),Bn(n,vA,!0)}function ls(n,e){const r=ho("%Temporal.PlainDate%"),u=Object.create(r.prototype);return VA(u,n,e),u}function GA(n,e,r){Gp(e),Md(n),Bn(n,dr,e),Bn(n,Rt,r)}function Gl(n,e){const r=ho("%Temporal.PlainDateTime%"),u=Object.create(r.prototype);return GA(u,n,e),u}function $A(n,e,r){Kp(e),Md(n),Bn(n,Tn,e),Bn(n,Rt,r),Bn(n,xA,!0)}function bg(n,e){const r=ho("%Temporal.PlainMonthDay%"),u=Object.create(r.prototype);return $A(u,n,e),u}function ZA(n,e){Md(n),Bn(n,Rr,e)}function sd(n){const e=ho("%Temporal.PlainTime%"),r=Object.create(e.prototype);return ZA(r,n),r}function YA(n,e,r){Sw(e),Md(n),Bn(n,Tn,e),Bn(n,Rt,r),Bn(n,bA,!0)}function Sg(n,e){const r=ho("%Temporal.PlainYearMonth%"),u=Object.create(r.prototype);return YA(u,n,e),u}function HA(n,e){eh(e),Md(n),Bn(n,wn,e)}function Yu(n){const e=ho("%Temporal.Instant%"),r=Object.create(e.prototype);return HA(r,n),r}function qA(n,e,r,u){eh(e),Md(n),Bn(n,wn,e),Bn(n,Si,r),Bn(n,Rt,u)}function Po(n,e,r="iso8601"){const u=ho("%Temporal.ZonedDateTime%"),d=Object.create(u.prototype);return qA(d,n,e,r),d}function XT(n){return f1.filter(e=>n[e]!==void 0)}function Up(n,e,r){const u=XT(r),d=jf(n).fieldKeysToIgnore(u),m=Object.create(null),y=XT(e);for(let l=0;l<f1.length;l++){let E;const C=f1[l];y.includes(C)&&!d.includes(C)&&(E=e[C]),u.includes(C)&&(E=r[C]),E!==void 0&&(m[C]=E)}return m}function gl(n,e,r,u){const d=jf(n).dateAdd(e,r,u);return Kp(d),d}function l_(n,e,r,u){return jf(n).dateUntil(e,r,u)}function c_(n){if(kr(n)&&ds(n,Rt))return oe(n,Rt);const e=Ma(n);try{return fs(e)}catch{}let r;try{({calendar:r}=ih(e))}catch{try{({calendar:r}=NA(e))}catch{try{({calendar:r}=_w(e))}catch{({calendar:r}=vw(e))}}}return r||(r="iso8601"),fs(r)}function u_(n){if(ds(n,Rt))return oe(n,Rt);const{calendar:e}=n;return e===void 0?"iso8601":c_(e)}function Ju(n,e){return fs(n)===fs(e)}function Of(n,e,r){const u=jf(n);u.resolveFields(e,"date");const d=u.dateToISO(e,r);return Kp(d),d}function B0(n,e,r){const u=jf(n);u.resolveFields(e,"year-month"),e.day=1;const d=u.dateToISO(e,r);return Sw(d),d}function Xv(n,e,r){const u=jf(n);u.resolveFields(e,"month-day");const d=u.monthDayToISOReferenceDate(e,r);return Kp(d),d}function cs(n){if(kr(n)&&Yn(n))return oe(n,Si);const e=Ma(n);if(e==="UTC")return"UTC";const{tzName:r,offsetMinutes:u}=function(m){const{tzAnnotation:y,offset:l,z:E}=function(C){if(zA.test(C))return{tzAnnotation:C,offset:void 0,z:!1};try{const{tzAnnotation:k,offset:N,z:F}=ih(C);if(F||k||N)return{tzAnnotation:k,offset:N,z:F}}catch{}FA(C)}(m);return y?Df(y):E?Df("UTC"):l?Df(l):void 0}(e);if(u!==void 0)return bw(u);const d=Wv(r);if(!d)throw new RangeError(`Unrecognized time zone ${r}`);return d.identifier}function XA(n,e){if(n===e)return!0;const r=Df(n).offsetMinutes,u=Df(e).offsetMinutes;if(r===void 0&&u===void 0){const d=Wv(e);if(!d)return!1;const m=Wv(n);return!!m&&m.primaryIdentifier===d.primaryIdentifier}return r===u}function ld(n,e){const r=Df(n).offsetMinutes;return r!==void 0?6e10*r:g1(n,e)}function m1(n){const e=n<0?"-":"+",r=Math.abs(n),u=Math.floor(r/36e11),d=Math.floor(r/6e10)%60,m=Math.floor(r/1e9)%60,y=r%1e9;return`${e}${Cb(u,d,m,y,m===0&&y===0?"minute":"auto")}`}function Xl(n,e){const r=ld(n,e);let{isoDate:{year:u,month:d,day:m},time:{hour:y,minute:l,second:E,millisecond:C,microsecond:k,nanosecond:N}}=JA(e);return G0(u,d,m,y,l,E,C,k,N+r)}function Lo(n,e,r){return WA(U0(n,e),n,e,r)}function WA(n,e,r,u){const d=n.length;if(d===1)return n[0];if(d)switch(u){case"compatible":case"earlier":return n[0];case"later":return n[d-1];case"reject":throw new RangeError("multiple instants found")}if(u==="reject")throw new RangeError("multiple instants found");const m=uo(r),y=J.subtract(m,kf);eh(y);const l=ld(e,y),E=J.add(m,kf);eh(E);const C=ld(e,E)-l;switch(u){case"earlier":{const k=Hn.fromComponents(0,0,0,0,0,-C),N=jg(r.time,k);return U0(e,hi(Bs(r.isoDate.year,r.isoDate.month,r.isoDate.day+N.deltaDays),N))[0]}case"compatible":case"later":{const k=Hn.fromComponents(0,0,0,0,0,C),N=jg(r.time,k),F=U0(e,hi(Bs(r.isoDate.year,r.isoDate.month,r.isoDate.day+N.deltaDays),N));return F[F.length-1]}}}function U0(n,e){if(n==="UTC")return Eg(e.isoDate),[uo(e)];const r=Df(n).offsetMinutes;if(r!==void 0){const u=G0(e.isoDate.year,e.isoDate.month,e.isoDate.day,e.time.hour,e.time.minute-r,e.time.second,e.time.millisecond,e.time.microsecond,e.time.nanosecond);Eg(u.isoDate);const d=uo(u);return eh(d),[d]}return Eg(e.isoDate),function(u,d){let m=uo(d),y=J.subtract(m,kf);J.lessThan(y,j0)&&(y=m);let l=J.add(m,kf);J.greaterThan(l,Lg)&&(l=m);const E=g1(u,y),C=g1(u,l);return(E===C?[E]:[E,C]).map(N=>{const F=J.subtract(m,J.BigInt(N)),B=function(W,re){const{epochMilliseconds:ie,time:{millisecond:de,microsecond:Ee,nanosecond:we}}=JA(re),{year:ke,month:ge,day:Ae,hour:Ge,minute:at,second:Me}=eC(W,ie);return G0(ke,ge,Ae,Ge,at,Me,de,Ee,we)}(u,F);if(Fg(d,B)===0)return eh(F),F}).filter(N=>N!==void 0)}(n,e)}function Tf(n,e){const r=hi(e,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),u=U0(n,r);if(u.length)return u[0];const d=uo(r),m=J.subtract(d,kf);return eh(m),ww(n,m)}function h_(n){let e;return e=n<0||n>9999?(n<0?"-":"+")+F0(Math.abs(n),6):F0(n,4),e}function yl(n){return F0(n,2)}function QA(n,e){let r;if(e==="auto"){if(n===0)return"";r=F0(n,9).replace(/0+$/,"")}else{if(e===0)return"";r=F0(n,9).slice(0,e)}return`.${r}`}function Cb(n,e,r,u,d){let m=`${yl(n)}:${yl(e)}`;return d==="minute"||(m+=`:${yl(r)}`,m+=QA(u,d)),m}function WT(n,e,r){let u=e;u===void 0&&(u="UTC");const d=oe(n,wn),m=V0(Xl(u,d),"iso8601",r,"never");let y="Z";return e!==void 0&&(y=KA(ld(u,d))),`${m}${y}`}function _v(n,e){const r=oe(n,Jo),u=oe(n,es),d=oe(n,Ps),m=oe(n,ts),y=oe(n,ns),l=oe(n,is),E=Kv(n);let C="";r!==0&&(C+=`${Math.abs(r)}Y`),u!==0&&(C+=`${Math.abs(u)}M`),d!==0&&(C+=`${Math.abs(d)}W`),m!==0&&(C+=`${Math.abs(m)}D`);let k="";y!==0&&(k+=`${Math.abs(y)}H`),l!==0&&(k+=`${Math.abs(l)}M`);const N=Hn.fromComponents(0,0,oe(n,rs),oe(n,as),oe(n,os),oe(n,Os));N.isZero()&&!["second","millisecond","microsecond","nanosecond"].includes(id(n))&&e==="auto"||(k+=`${Math.abs(N.sec)}${QA(Math.abs(N.subsec),e)}S`);let F=`${E<0?"-":""}P${C}`;return k&&(F=`${F}T${k}`),F}function QT(n,e="auto"){const{year:r,month:u,day:d}=oe(n,Tn);return`${h_(r)}-${yl(u)}-${yl(d)}${n_(oe(n,Rt),e)}`}function KT({hour:n,minute:e,second:r,millisecond:u,microsecond:d,nanosecond:m},y){return Cb(n,e,r,1e6*u+1e3*d+m,y)}function V0(n,e,r,u="auto"){const{isoDate:{year:d,month:m,day:y},time:{hour:l,minute:E,second:C,millisecond:k,microsecond:N,nanosecond:F}}=n;return`${h_(d)}-${yl(m)}-${yl(y)}T${Cb(l,E,C,1e6*k+1e3*N+F,r)}${n_(e,u)}`}function JT(n,e="auto"){const{year:r,month:u,day:d}=oe(n,Tn);let m=`${yl(u)}-${yl(d)}`;const y=oe(n,Rt);e!=="always"&&e!=="critical"&&y==="iso8601"||(m=`${h_(r)}-${m}`);const l=n_(y,e);return l&&(m+=l),m}function eS(n,e="auto"){const{year:r,month:u,day:d}=oe(n,Tn);let m=`${h_(r)}-${yl(u)}`;const y=oe(n,Rt);e!=="always"&&e!=="critical"&&y==="iso8601"||(m+=`-${yl(d)}`);const l=n_(y,e);return l&&(m+=l),m}function tS(n,e,r="auto",u="auto",d="auto",m=void 0){let y=oe(n,wn);if(m){const{unit:k,increment:N,roundingMode:F}=m;y=b1(y,N,k,F)}const l=oe(n,Si),E=ld(l,y);let C=V0(Xl(l,y),"iso8601",e,"never");return d!=="never"&&(C+=KA(E)),u!=="never"&&(C+=`[${u==="critical"?"!":""}${l}]`),C+=n_(oe(n,Rt),r),C}function nS(n){return jA.test(n)}function ey(n){const e=J5.exec(n);if(!e)throw new RangeError(`invalid time zone offset: ${n}; must match ±HH:MM[:SS.SSSSSSSSS]`);return(e[1]==="-"?-1:1)*(1e9*(60*(60*+e[2]+ +(e[3]||0))+ +(e[4]||0))+ +((e[5]||0)+"000000000").slice(0,9))}let a0;const Q5=Object.assign(Object.create(null),{"/":!0,"-":!0,_:!0});function Wv(n){if(a0===void 0){const m=Intl.supportedValuesOf?.("timeZone");if(m){a0=new Map;for(let y=0;y<m.length;y++){const l=m[y];a0.set($0(l),l)}}else a0=null}const e=$0(n);let r=a0?.get(e);if(r)return{identifier:r,primaryIdentifier:r};try{r=LA(n).resolvedOptions().timeZone}catch{return}if(e==="antarctica/south_pole"&&(r="Antarctica/McMurdo"),Y5.has(n))throw new RangeError(`${n} is a legacy time zone identifier from ICU. Use ${r} instead`);const u=[...e].map((m,y)=>y===0||Q5[e[y-1]]?m.toUpperCase():m).join("").split("/");if(u.length===1)return e==="gb-eire"?{identifier:"GB-Eire",primaryIdentifier:r}:{identifier:e.length<=3||/[-0-9]/.test(e)?e.toUpperCase():u[0],primaryIdentifier:r};if(u[0]==="Etc")return{identifier:`Etc/${["Zulu","Greenwich","Universal"].includes(u[1])?u[1]:u[1].toUpperCase()}`,primaryIdentifier:r};if(u[0]==="Us")return{identifier:`US/${u[1]}`,primaryIdentifier:r};const d=new Map([["Act","ACT"],["Lhi","LHI"],["Nsw","NSW"],["Dar_Es_Salaam","Dar_es_Salaam"],["Port_Of_Spain","Port_of_Spain"],["Port-Au-Prince","Port-au-Prince"],["Isle_Of_Man","Isle_of_Man"],["Comodrivadavia","ComodRivadavia"],["Knox_In","Knox_IN"],["Dumontdurville","DumontDUrville"],["Mcmurdo","McMurdo"],["Denoronha","DeNoronha"],["Easterisland","EasterIsland"],["Bajanorte","BajaNorte"],["Bajasur","BajaSur"]]);return u[1]=d.get(u[1])??u[1],u.length>2&&(u[2]=d.get(u[2])??u[2]),{identifier:u.join("/"),primaryIdentifier:r}}function Op(n,e){const{year:r,month:u,day:d,hour:m,minute:y,second:l}=eC(n,e);let E=e%1e3;return E<0&&(E+=1e3),1e6*(xw({isoDate:{year:r,month:u,day:d},time:{hour:m,minute:y,second:l,millisecond:E}})-e)}function g1(n,e){return Op(n,Wl(e,"floor"))}function bw(n){const e=n<0?"-":"+",r=Math.abs(n);return`${e}${Cb(Math.floor(r/60),r%60,0,0,"minute")}`}function KA(n){return bw(Mf(n,U5,"halfExpand")/6e10)}function xw({isoDate:{year:n,month:e,day:r},time:{hour:u,minute:d,second:m,millisecond:y}}){const l=n%400,E=(n-l)/400,C=new Date;return C.setUTCHours(u,d,m,y),C.setUTCFullYear(l,e-1,r),C.getTime()+$5*E}function uo(n){const e=xw(n),r=1e3*n.time.microsecond+n.time.nanosecond;return J.add(qu(e),J.BigInt(r))}function JA(n){let e=Wl(n,"trunc"),r=J.toNumber(J.remainder(n,e_));r<0&&(r+=1e6,e-=1);const u=Math.floor(r/1e3)%1e3,d=r%1e3,m=new Date(e);return{epochMilliseconds:e,isoDate:{year:m.getUTCFullYear(),month:m.getUTCMonth()+1,day:m.getUTCDate()},time:{hour:m.getUTCHours(),minute:m.getUTCMinutes(),second:m.getUTCSeconds(),millisecond:m.getUTCMilliseconds(),microsecond:u,nanosecond:d}}}function ww(n,e){if(n==="UTC")return null;const r=Wl(e,"floor");if(r<E0)return ww(n,qu(E0));const u=Date.now(),d=Math.max(r,u)+366*Pf*3;let m=r,y=Op(n,m),l=m,E=y;for(;y===E&&m<d;){if(l=m+2*Pf*7,l>OA)return null;E=Op(n,l),y===E&&(m=l)}return y===E?null:qu(uC(C=>Op(n,C),m,l,y,E))}function y1(n,e){if(n==="UTC")return null;const r=Wl(e,"ceil"),u=Date.now(),d=u+366*Pf*3;if(r>d){const C=y1(n,qu(d));if(C===null||J.lessThan(C,qu(u)))return C}if(n==="Africa/Casablanca"||n==="Africa/El_Aaiun"){const C=Date.UTC(2088,0,1);if(C<r)return y1(n,qu(C))}let m=r-1;if(m<E0)return null;let y=Op(n,m),l=m,E=y;for(;y===E&&m>E0;){if(l=m-2*Pf*7,l<E0)return null;E=Op(n,l),y===E&&(m=l)}return y===E?null:qu(uC(C=>Op(n,C),l,m,E,y))}function eC(n,e){return function(r){const u=r.split(/[^\w]+/);if(u.length!==7)throw new RangeError(`expected 7 parts in "${r}`);const d=+u[0],m=+u[1];let y=+u[2];const l=u[3];if(l[0]==="b"||l[0]==="B")y=1-y;else if(l[0]!=="a"&&l[0]!=="A")throw new RangeError(`Unknown era ${l} in "${r}`);const E=u[4]==="24"?0:+u[4],C=+u[5],k=+u[6];if(!(Number.isFinite(y)&&Number.isFinite(d)&&Number.isFinite(m)&&Number.isFinite(E)&&Number.isFinite(C)&&Number.isFinite(k)))throw new RangeError(`Invalid number in "${r}`);return{year:y,month:d,day:m,hour:E,minute:C,second:k}}(LA(n).format(e))}function Qv(n){return n!==void 0&&!(n%4!=0||n%100==0&&n%400!=0)}function Lp(n,e){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[Qv(n)?"leapyear":"standard"][e-1]}function Kv(n){const e=[oe(n,Jo),oe(n,es),oe(n,Ps),oe(n,ts),oe(n,ns),oe(n,is),oe(n,rs),oe(n,as),oe(n,os),oe(n,Os)];for(let r=0;r<e.length;r++){const u=e[r];if(u!==0)return u<0?-1:1}return 0}function Db(n){const e=["years","months","weeks","days"];for(let r=0;r<e.length;r++){const u=n[e[r]];if(u!==0)return u<0?-1:1}return 0}function tC(n){const e=Db(n.date);return e!==0?e:n.time.sign()}function kp(n,e){let r=n,u=e;if(!Number.isFinite(r)||!Number.isFinite(u))throw new RangeError("infinity is out of range");return u-=1,r+=Math.floor(u/12),u%=12,u<0&&(u+=12),u+=1,{year:r,month:u}}function Bs(n,e,r){let u=n,d=e,m=r;if(!Number.isFinite(m))throw new RangeError("infinity is out of range");({year:u,month:d}=kp(u,d));const y=146097;if(Math.abs(m)>y){const C=Math.trunc(m/y);u+=400*C,m-=C*y}let l=0,E=d>2?u:u-1;for(;l=Qv(E)?366:365,m<-l;)u-=1,E-=1,m+=l;for(E+=1;l=Qv(E)?366:365,m>l;)u+=1,E+=1,m-=l;for(;m<1;)({year:u,month:d}=kp(u,d-1)),m+=Lp(u,d);for(;m>Lp(u,d);)m-=Lp(u,d),{year:u,month:d}=kp(u,d+1);return{year:u,month:d,day:m}}function G0(n,e,r,u,d,m,y,l,E){const C=Sf(u,d,m,y,l,E);return hi(Bs(n,e,r+C.deltaDays),C)}function Sf(n,e,r,u,d,m){let y,l=n,E=e,C=r,k=u,N=d,F=m;({div:y,mod:F}=vg(F,3)),N+=y,F<0&&(N-=1,F+=1e3),{div:y,mod:N}=vg(N,3),k+=y,N<0&&(k-=1,N+=1e3),C+=Math.trunc(k/1e3),k%=1e3,k<0&&(C-=1,k+=1e3),E+=Math.trunc(C/60),C%=60,C<0&&(E-=1,C+=60),l+=Math.trunc(E/60),E%=60,E<0&&(l-=1,E+=60);let B=Math.trunc(l/24);return l%=24,l<0&&(B-=1,l+=24),B+=0,l+=0,E+=0,C+=0,k+=0,N+=0,F+=0,{deltaDays:B,hour:l,minute:E,second:C,millisecond:k,microsecond:N,nanosecond:F}}function iS(n,e){const r=Oo(n,0);if(Db(r)===0)return n.days;const u=oe(e,Tn),d=gl(oe(e,Rt),u,r,"constrain"),m=$p(u.year,u.month-1,u.day),y=$p(d.year,d.month-1,d.day)-m;return n.days+y}function Us(n){return new(ho("%Temporal.Duration%"))(-oe(n,Jo),-oe(n,es),-oe(n,Ps),-oe(n,ts),-oe(n,ns),-oe(n,is),-oe(n,rs),-oe(n,as),-oe(n,os),-oe(n,Os))}function ss(n,e,r){return Math.min(r,Math.max(e,n))}function nC(n,e,r){const u=ss(e,1,12);return{year:n,month:u,day:ss(r,1,Lp(n,u))}}function Ua(n,e,r){if(n<e||n>r)throw new RangeError(`value out of range: ${e} <= ${n} <= ${r}`)}function Vp(n,e,r){Ua(e,1,12),Ua(r,1,Lp(n,e))}function Kp(n){Gp(hi(n,{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}))}function Ib(n,e,r,u,d,m){Ua(n,0,23),Ua(e,0,59),Ua(r,0,59),Ua(u,0,999),Ua(d,0,999),Ua(m,0,999)}function Tw(n,e,r,u,d,m,y,l,E){Vp(n,e,r),Ib(u,d,m,y,l,E)}function Gp(n){const e=uo(n);(J.lessThan(e,V5)||J.greaterThan(e,G5))&&eh(e)}function _1(n){uo(n)}function eh(n){if(J.lessThan(n,j0)||J.greaterThan(n,Lg))throw new RangeError("date/time value is outside of supported range")}function Sw({year:n,month:e}){Ua(n,GT,$T),n===GT?Ua(e,4,12):n===$T&&Ua(e,1,9)}function Rb(n,e,r,u,d,m,y,l,E,C){let k=0;const N=[n,e,r,u,d,m,y,l,E,C];for(let de=0;de<N.length;de++){const Ee=N[de];if(Ee===1/0||Ee===-1/0)throw new RangeError("infinite values not allowed as duration fields");if(Ee!==0){const we=Ee<0?-1:1;if(k!==0&&we!==k)throw new RangeError("mixed-sign values not allowed as duration fields");k=we}}if(Math.abs(n)>=2**32||Math.abs(e)>=2**32||Math.abs(r)>=2**32)throw new RangeError("years, months, and weeks must be < 2³²");const F=vg(l,3),B=vg(E,6),W=vg(C,9),re=vg(1e6*F.mod+1e3*B.mod+W.mod,9).div,ie=86400*u+3600*d+60*m+y+F.div+B.div+W.div+re;if(!Number.isSafeInteger(ie))throw new RangeError("total of duration time units cannot exceed 9007199254740991.999999999 s")}function _g(n){return{date:{years:oe(n,Jo),months:oe(n,es),weeks:oe(n,Ps),days:oe(n,ts)},time:Hn.fromComponents(oe(n,ns),oe(n,is),oe(n,rs),oe(n,as),oe(n,os),oe(n,Os))}}function Hu(n){const e=Hn.fromComponents(oe(n,ns),oe(n,is),oe(n,rs),oe(n,as),oe(n,os),oe(n,Os)).add24HourDays(oe(n,ts));return{date:{years:oe(n,Jo),months:oe(n,es),weeks:oe(n,Ps),days:0},time:e}}function iC(n){const e=Hu(n),r=Math.trunc(e.time.sec/86400);return Rb(e.date.years,e.date.months,e.date.weeks,r,0,0,0,0,0,0),{...e.date,days:r}}function $l(n,e){const r=n.time.sign();let u=n.time.abs().subsec,d=0,m=0,y=n.time.abs().sec,l=0,E=0,C=0;switch(e){case"year":case"month":case"week":case"day":d=Math.trunc(u/1e3),u%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3,l=Math.trunc(y/60),y%=60,E=Math.trunc(l/60),l%=60,C=Math.trunc(E/24),E%=24;break;case"hour":d=Math.trunc(u/1e3),u%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3,l=Math.trunc(y/60),y%=60,E=Math.trunc(l/60),l%=60;break;case"minute":d=Math.trunc(u/1e3),u%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3,l=Math.trunc(y/60),y%=60;break;case"second":d=Math.trunc(u/1e3),u%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3;break;case"millisecond":d=Math.trunc(u/1e3),u%=1e3,m=Cx(y,3,Math.trunc(d/1e3)),d%=1e3,y=0;break;case"microsecond":d=Cx(y,6,Math.trunc(u/1e3)),u%=1e3,y=0;break;case"nanosecond":u=Cx(y,9,u),y=0}return new(ho("%Temporal.Duration%"))(n.date.years,n.date.months,n.date.weeks,n.date.days+r*C,r*E,r*l,r*y,r*m,r*d,r*u)}function md(n,e){return Db(n),e.sign(),{date:n,time:e}}function $p(n,e,r){return xw({isoDate:{year:n,month:e+1,day:r},time:{hour:0,minute:0,second:0,millisecond:0}})/Pf}function Eg({year:n,month:e,day:r}){if(Math.abs($p(n,e-1,r))>1e8)throw new RangeError("date/time value is outside the supported range")}function Ew(n,e){const r=e.hour-n.hour,u=e.minute-n.minute,d=e.second-n.second,m=e.millisecond-n.millisecond,y=e.microsecond-n.microsecond,l=e.nanosecond-n.nanosecond;return Hn.fromComponents(r,u,d,m,y,l)}function Mw(n,e,r,u,d){let m=Hn.fromEpochNsDiff(e,n);return m=Jv(m,r,u,d),md({years:0,months:0,weeks:0,days:0},m)}function rC(n,e,r,u){_1(n),_1(e);let d=Ew(n.time,e.time);const m=d.sign(),y=th(n.isoDate,e.isoDate);let l=e.isoDate;y===m&&(l=Bs(l.year,l.month,l.day+m),d=d.add24HourDays(-m));const E=pd("day",u),C=l_(r,n.isoDate,l,E);return u!==E&&(d=d.add24HourDays(C.days),C.days=0),md(C,d)}function aC(n,e,r,u,d){const m=J.subtract(e,n);if(J.equal(m,dl))return{date:{years:0,months:0,weeks:0,days:0},time:Hn.ZERO};const y=J.lessThan(m,dl)?-1:1,l=Xl(r,n),E=Xl(r,e);let C,k=0,N=y===1?2:1,F=Ew(l.time,E.time);for(F.sign()===-y&&k++;k<=N;k++){C=hi(Bs(E.isoDate.year,E.isoDate.month,E.isoDate.day-k*y),l.time);const W=Lo(r,C,"compatible");if(F=Hn.fromEpochNsDiff(e,W),F.sign()!==-y)break}const B=pd("day",d);return md(l_(u,l.isoDate,C.isoDate,B),F)}function oC(n,e,r,u,d,m,y,l,E){let C,k,N,F,B=e;switch(l){case"year":{const bt=Mf(B.date.years,y,"trunc");C=bt,k=bt+y*n,N={years:C,months:0,weeks:0,days:0},F={...N,years:k};break}case"month":{const bt=Mf(B.date.months,y,"trunc");C=bt,k=bt+y*n,N=Oo(B.date,0,0,C),F=Oo(B.date,0,0,k);break}case"week":{const bt=Oo(B.date,0,0),zt=gl(m,u.isoDate,bt,"constrain"),Zt=l_(m,zt,Bs(zt.year,zt.month,zt.day+B.date.days),"week"),Ft=Mf(B.date.weeks+Zt.weeks,y,"trunc");C=Ft,k=Ft+y*n,N=Oo(B.date,0,C),F=Oo(B.date,0,k);break}case"day":{const bt=Mf(B.date.days,y,"trunc");C=bt,k=bt+y*n,N=Oo(B.date,C),F=Oo(B.date,k);break}}const W=gl(m,u.isoDate,N,"constrain"),re=gl(m,u.isoDate,F,"constrain");let ie,de;const Ee=hi(W,u.time),we=hi(re,u.time);d?(ie=Lo(d,Ee,"compatible"),de=Lo(d,we,"compatible")):(ie=uo(Ee),de=uo(we));const ke=Hn.fromEpochNsDiff(r,ie),ge=Hn.fromEpochNsDiff(de,ie),Ae=wb(E,n<0?"negative":"positive"),Ge=ke.add(ke).abs().subtract(ge.abs()).sign(),at=Math.abs(C)/y%2==0,Me=ke.isZero()?Math.abs(C):ke.cmp(ge)?Tb(Math.abs(C),Math.abs(k),Ge,at,Ae):Math.abs(k),Qe=new Hn(J.add(J.multiply(ge.totalNs,J.BigInt(C)),J.multiply(ke.totalNs,J.BigInt(y*n)))).fdiv(ge.totalNs),St=Me===Math.abs(k);return B={date:St?F:N,time:Hn.ZERO},{nudgeResult:{duration:B,nudgedEpochNs:St?de:ie,didExpandCalendarUnit:St},total:Qe}}function kb(n,e,r,u,d,m,y,l,E){let C=n;const k=Vu(l)||u&&l==="day",N=tC(C)<0?-1:1;let F;return k?{nudgeResult:F}=oC(N,C,e,r,u,d,y,l,E):F=u?function(B,W,re,ie,de,Ee,we,ke){let ge=W;const Ae=gl(de,re.isoDate,ge.date,"constrain"),Ge=hi(Ae,re.time),at=hi(Bs(Ae.year,Ae.month,Ae.day+B),re.time),Me=Lo(ie,Ge,"compatible"),Qe=Lo(ie,at,"compatible"),St=Hn.fromEpochNsDiff(Qe,Me);if(St.sign()!==B)throw new RangeError("time zone returned inconsistent Instants");const bt=J.BigInt(zg[we]*Ee);let zt=ge.time.round(bt,ke);const Zt=zt.subtract(St),Ft=Zt.sign()!==-B;let Be,lt;return Ft?(Be=B,zt=Zt.round(bt,ke),lt=zt.addToEpochNs(Qe)):(Be=0,lt=zt.addToEpochNs(Me)),{duration:md(Oo(ge.date,ge.date.days+Be),zt),nudgedEpochNs:lt,didExpandCalendarUnit:Ft}}(N,C,r,u,d,y,l,E):function(B,W,re,ie,de,Ee){let we=B;const ke=we.time.add24HourDays(we.date.days),ge=ke.round(J.BigInt(ie*zg[de]),Ee),Ae=ge.subtract(ke),{quotient:Ge}=ke.divmod(Yv),{quotient:at}=ge.divmod(Yv),Me=Math.sign(at-Ge)===ke.sign(),Qe=Ae.addToEpochNs(W);let St=0,bt=ge;return rd(re)==="date"&&(St=at,bt=ge.add(Hn.fromComponents(24*-at,0,0,0,0,0))),{duration:{date:Oo(we.date,St),time:bt},nudgedEpochNs:Qe,didExpandCalendarUnit:Me}}(C,e,m,y,l,E),C=F.duration,F.didExpandCalendarUnit&&l!=="week"&&(C=function(B,W,re,ie,de,Ee,we,ke){let ge=W;if(ke===we)return ge;const Ae=M0.indexOf(we);for(let Ge=M0.indexOf(ke)-1;Ge>=Ae;Ge--){const at=M0[Ge];if(at==="week"&&we!=="week")continue;let Me;switch(at){case"year":Me={years:ge.date.years+B,months:0,weeks:0,days:0};break;case"month":{const bt=ge.date.months+B;Me=Oo(ge.date,0,0,bt);break}case"week":{const bt=ge.date.weeks+B;Me=Oo(ge.date,0,bt);break}}const Qe=hi(gl(Ee,ie.isoDate,Me,"constrain"),ie.time);let St;if(St=de?Lo(de,Qe,"compatible"):uo(Qe),$v(re,St)===-B)break;ge={date:Me,time:Hn.ZERO}}return ge}(N,C,F.nudgedEpochNs,r,u,d,m,pd(l,"day"))),C}function rS(n,e,r,u,d,m){return Vu(m)||u&&m==="day"?oC(tC(n)<0?-1:1,n,e,r,u,d,1,m,"trunc").total:D0(n.time.add24HourDays(n.date.days),m)}function sC(n,e,r,u,d,m,y){if(Fg(n,e)==0)return{date:{years:0,months:0,weeks:0,days:0},time:Hn.ZERO};Gp(n),Gp(e);const l=rC(n,e,r,u);return m==="nanosecond"&&d===1?l:kb(l,uo(e),n,null,r,u,d,m,y)}function lC(n,e,r,u,d,m,y,l){if(rd(d)==="time")return Mw(n,e,m,y,l);const E=aC(n,e,r,u,d);return y==="nanosecond"&&m===1?E:kb(E,e,Xl(r,n),r,u,d,m,y,l)}function ty(n,e,r,u,d,m){const y=Ng.reduce((B,W)=>{const re=W[0],ie=W[1],de=W[2];return r!=="datetime"&&de!==r||u.includes(ie)||B.push(ie,re),B},[]);let l=Ns(e,"largestUnit",r,"auto");if(u.includes(l))throw new RangeError(`largestUnit must be one of ${y.join(", ")}, not ${l}`);const E=Kg(e);let C=Yc(e,"trunc");n==="since"&&(C=function(B){switch(B){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return B}}(C));const k=Ns(e,"smallestUnit",r,d);if(u.includes(k))throw new RangeError(`smallestUnit must be one of ${y.join(", ")}, not ${k}`);const N=pd(m,k);if(l==="auto"&&(l=N),pd(l,k)!==l)throw new RangeError(`largestUnit ${l} cannot be smaller than smallestUnit ${k}`);const F={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[k];return F!==void 0&&Jg(E,F,!1),{largestUnit:l,roundingIncrement:E,roundingMode:C,smallestUnit:k}}function aS(n,e,r,u){const d=y0(r),m=ty(n,tn(u),"time",[],"nanosecond","second");let y=$l(Mw(oe(e,wn),oe(d,wn),m.roundingIncrement,m.smallestUnit,m.roundingMode),m.largestUnit);return n==="since"&&(y=Us(y)),y}function oS(n,e,r,u){const d=m0(r),m=oe(e,Rt),y=oe(d,Rt);if(!Ju(m,y))throw new RangeError(`cannot compute difference between dates of ${m} and ${y} calendars`);const l=ty(n,tn(u),"date",[],"day","day"),E=ho("%Temporal.Duration%"),C=oe(e,Tn),k=oe(d,Tn);if(th(C,k)===0)return new E;let N={date:l_(m,C,k,l.largestUnit),time:Hn.ZERO};if(l.smallestUnit!=="day"||l.roundingIncrement!==1){const B=hi(C,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});N=kb(N,uo(hi(k,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),B,null,m,l.largestUnit,l.roundingIncrement,l.smallestUnit,l.roundingMode)}let F=$l(N,"day");return n==="since"&&(F=Us(F)),F}function sS(n,e,r,u){const d=g0(r),m=oe(e,Rt),y=oe(d,Rt);if(!Ju(m,y))throw new RangeError(`cannot compute difference between dates of ${m} and ${y} calendars`);const l=ty(n,tn(u),"datetime",[],"nanosecond","day"),E=ho("%Temporal.Duration%"),C=oe(e,dr),k=oe(d,dr);if(Fg(C,k)===0)return new E;let N=$l(sC(C,k,m,l.largestUnit,l.roundingIncrement,l.smallestUnit,l.roundingMode),l.largestUnit);return n==="since"&&(N=Us(N)),N}function lS(n,e,r,u){const d=Ef(r),m=ty(n,tn(u),"time",[],"nanosecond","hour");let y=Ew(oe(e,Rr),oe(d,Rr));y=Jv(y,m.roundingIncrement,m.smallestUnit,m.roundingMode);let l=$l(md({years:0,months:0,weeks:0,days:0},y),m.largestUnit);return n==="since"&&(l=Us(l)),l}function cS(n,e,r,u){const d=_0(r),m=oe(e,Rt),y=oe(d,Rt);if(!Ju(m,y))throw new RangeError(`cannot compute difference between months of ${m} and ${y} calendars`);const l=ty(n,tn(u),"date",["week","day"],"month","year"),E=ho("%Temporal.Duration%");if(th(oe(e,Tn),oe(d,Tn))==0)return new E;const C=us(m,oe(e,Tn),"year-month");C.day=1;const k=Of(m,C,"constrain"),N=us(m,oe(d,Tn),"year-month");N.day=1;const F=Of(m,N,"constrain");let B={date:Oo(l_(m,k,F,l.largestUnit),0,0),time:Hn.ZERO};if(l.smallestUnit!=="month"||l.roundingIncrement!==1){const re=hi(k,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});B=kb(B,uo(hi(F,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),re,null,m,l.largestUnit,l.roundingIncrement,l.smallestUnit,l.roundingMode)}let W=$l(B,"day");return n==="since"&&(W=Us(W)),W}function uS(n,e,r,u){const d=v0(r),m=oe(e,Rt),y=oe(d,Rt);if(!Ju(m,y))throw new RangeError(`cannot compute difference between dates of ${m} and ${y} calendars`);const l=ty(n,tn(u),"datetime",[],"nanosecond","hour"),E=oe(e,wn),C=oe(d,wn),k=ho("%Temporal.Duration%");let N;if(rd(l.largestUnit)!=="date")N=$l(Mw(E,C,l.roundingIncrement,l.smallestUnit,l.roundingMode),l.largestUnit);else{const F=oe(e,Si);if(!XA(F,oe(d,Si)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");if(J.equal(E,C))return new k;N=$l(lC(E,C,F,m,l.largestUnit,l.roundingIncrement,l.smallestUnit,l.roundingMode),"hour")}return n==="since"&&(N=Us(N)),N}function jg({hour:n,minute:e,second:r,millisecond:u,microsecond:d,nanosecond:m},y){let l=r,E=m;return l+=y.sec,E+=y.subsec,Sf(n,e,l,u,d,E)}function v1(n,e){const r=e.addToEpochNs(n);return eh(r),r}function b0(n,e,r,u,d="constrain"){if(Db(u.date)===0)return v1(n,u.time);const m=Xl(e,n);return v1(Lo(e,hi(gl(r,m.isoDate,u.date,d),m.time),"compatible"),u.time)}function hS(n,e,r){let u=Yl(r);n==="subtract"&&(u=Us(u));const d=pd(id(e),id(u));if(Vu(d))throw new RangeError("For years, months, or weeks arithmetic, use date arithmetic relative to a starting point");const m=Hu(e),y=Hu(u);return $l(md({years:0,months:0,weeks:0,days:0},m.time.add(y.time)),d)}function dS(n,e,r){let u=Yl(r);n==="subtract"&&(u=Us(u));const d=id(u);if(rd(d)==="date")throw new RangeError(`Duration field ${d} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);const m=Hu(u);return Yu(v1(oe(e,wn),m.time))}function fS(n,e,r,u){const d=oe(e,Rt);let m=Yl(r);n==="subtract"&&(m=Us(m));const y=iC(m),l=li(tn(u));return ls(gl(d,oe(e,Tn),y,l),d)}function pS(n,e,r,u){let d=Yl(r);n==="subtract"&&(d=Us(d));const m=li(tn(u)),y=oe(e,Rt),l=Hu(d),E=oe(e,dr),C=jg(E.time,l.time),k=Oo(l.date,C.deltaDays);return Rb(k.years,k.months,k.weeks,k.days,0,0,0,0,0,0),Gl(hi(gl(y,E.isoDate,k,m),C),y)}function mS(n,e,r){let u=Yl(r);n==="subtract"&&(u=Us(u));const d=Hu(u),{hour:m,minute:y,second:l,millisecond:E,microsecond:C,nanosecond:k}=jg(oe(e,Rr),d.time);return sd(Ab(m,y,l,E,C,k,"reject"))}function gS(n,e,r,u){let d=Yl(r);n==="subtract"&&(d=Us(d));const m=li(tn(u)),y=Kv(d),l=oe(e,Rt),E=us(l,oe(e,Tn),"year-month");E.day=1;let C=Of(l,E,"constrain");if(y<0){const N=gl(l,C,{months:1},"constrain");C=Bs(N.year,N.month,N.day-1)}const k=iC(d);return Kp(C),Sg(B0(l,us(l,gl(l,C,k,m),"year-month"),m),l)}function yS(n,e,r,u){let d=Yl(r);n==="subtract"&&(d=Us(d));const m=li(tn(u)),y=oe(e,Si),l=oe(e,Rt),E=_g(d);return Po(b0(oe(e,wn),y,l,E,m),y,l)}function Mf(n,e,r){const u=Math.trunc(n/e),d=n%e,m=n<0?"negative":"positive",y=Math.abs(u),l=y+1,E=Ls(Math.abs(2*d)-e),C=y%2==0,k=wb(r,m),N=d===0?y:Tb(y,l,E,C,k);return e*(m==="positive"?N:-N)}function b1(n,e,r,u){const d=zg[r]*e;return function(m,y,l){const E=td(m),C=td(y),k=J.divide(E,C),N=J.remainder(E,C),F=wb(l,"positive");let B,W;J.lessThan(E,dl)?(B=J.subtract(k,z0),W=k):(B=k,W=J.add(k,z0));const re=$v(Cp(J.multiply(N,yw)),C)*(J.lessThan(E,dl)?-1:1)+0,ie=J.equal(N,dl)?k:Tb(B,W,re,_A(B),F);return J.multiply(ie,C)}(n,J.BigInt(d),u)}function x1(n,e,r,u){_1(n);const{year:d,month:m,day:y}=n.isoDate,l=w1(n.time,e,r,u);return hi(Bs(d,m,y+l.deltaDays),l)}function w1({hour:n,minute:e,second:r,millisecond:u,microsecond:d,nanosecond:m},y,l,E){let C;switch(l){case"day":case"hour":C=1e3*(1e3*(1e3*(60*(60*n+e)+r)+u)+d)+m;break;case"minute":C=1e3*(1e3*(1e3*(60*e+r)+u)+d)+m;break;case"second":C=1e3*(1e3*(1e3*r+u)+d)+m;break;case"millisecond":C=1e3*(1e3*u+d)+m;break;case"microsecond":C=1e3*d+m;break;case"nanosecond":C=m}const k=zg[l],N=Mf(C,k*y,E)/k;switch(l){case"day":return{deltaDays:N,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return Sf(N,0,0,0,0,0);case"minute":return Sf(n,N,0,0,0,0);case"second":return Sf(n,e,N,0,0,0);case"millisecond":return Sf(n,e,r,N,0,0);case"microsecond":return Sf(n,e,r,u,N,0);case"nanosecond":return Sf(n,e,r,u,d,N);default:throw new Error(`Invalid unit ${l}`)}}function Jv(n,e,r,u){const d=zg[r];return n.round(J.BigInt(d*e),u)}function D0(n,e){const r=zg[e];return n.fdiv(J.BigInt(r))}function th(n,e){return n.year!==e.year?Ls(n.year-e.year):n.month!==e.month?Ls(n.month-e.month):n.day!==e.day?Ls(n.day-e.day):0}function T1(n,e){return n.hour!==e.hour?Ls(n.hour-e.hour):n.minute!==e.minute?Ls(n.minute-e.minute):n.second!==e.second?Ls(n.second-e.second):n.millisecond!==e.millisecond?Ls(n.millisecond-e.millisecond):n.microsecond!==e.microsecond?Ls(n.microsecond-e.microsecond):n.nanosecond!==e.nanosecond?Ls(n.nanosecond-e.nanosecond):0}function Fg(n,e){const r=th(n.isoDate,e.isoDate);return r!==0?r:T1(n.time,e.time)}function cC(n){const e=eb(n);return globalThis.BigInt!==void 0?globalThis.BigInt(e.toString(10)):e}function Wl(n,e){const r=td(n),{quotient:u,remainder:d}=f0(r,e_);let m=J.toNumber(u);return e==="floor"&&J.toNumber(d)<0&&(m-=1),e==="ceil"&&J.toNumber(d)>0&&(m+=1),m}function qu(n){if(!Number.isInteger(n))throw new RangeError("epoch milliseconds must be an integer");return J.multiply(J.BigInt(n),e_)}function eb(n){let e=n;if(typeof n=="object"){const r=n[Symbol.toPrimitive];r&&typeof r=="function"&&(e=r.call(n,"number"))}if(typeof e=="number")throw new TypeError("cannot convert number to bigint");return typeof e=="bigint"?J.BigInt(e.toString(10)):J.BigInt(e)}const S1=(()=>{let n=J.BigInt(Date.now()%1e6);return()=>{const e=Date.now(),r=J.BigInt(e),u=J.add(qu(e),n);return n=J.remainder(r,e_),J.greaterThan(u,Lg)?Lg:J.lessThan(u,j0)?j0:u}})();function o0(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function Ls(n){return n<0?-1:n>0?1:n}function tn(n){if(n===void 0)return Object.create(null);if(kr(n)&&n!==null)return n;throw new TypeError("Options parameter must be an object, not "+(n===null?"null":typeof n))}function Zp(n,e){const r=Object.create(null);return r[n]=e,r}function gd(n,e,r,u){let d=n[e];if(d!==void 0){if(d=Eb(d),!r.includes(d))throw new RangeError(`${e} must be one of ${r.join(", ")}, not ${d}`);return d}if(u===wd)throw new RangeError(`${e} option is required`);return u}function fs(n){const e=$0(n);if(!Z5.includes($0(e)))throw new RangeError(`invalid calendar identifier ${e}`);switch(e){case"ethiopic-amete-alem":return"ethioaa";case"islamicc":return"islamic-civil"}return e}function $0(n){let e="";for(let r=0;r<n.length;r++){const u=n.charCodeAt(r);e+=u>=65&&u<=90?String.fromCharCode(u+32):String.fromCharCode(u)}return e}function Ff(n){throw new TypeError(`Do not use built-in arithmetic operators with Temporal objects. When comparing, use ${n==="PlainMonthDay"?"Temporal.PlainDate.compare(obj1.toPlainDate(year), obj2.toPlainDate(year))":`Temporal.${n}.compare(obj1, obj2)`}, not obj1 > obj2. When coercing to strings, use \`\${obj}\` or String(obj), not '' + obj. When coercing to numbers, use properties or methods of the object, not \`+obj\`. When concatenating with strings, use \`\${str}\${obj}\` or str.concat(obj), not str + obj. In React, coerce to a string before rendering a Temporal object.`)}const K5=new RegExp(`^${kA.source}$`),J5=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/.source}$`);function uC(n,e,r,u=n(e),d=n(r)){let m=e,y=r,l=u,E=d;for(;y-m>1;){let C=Math.trunc((m+y)/2);const k=n(C);k===l?(m=C,l=k):k===E&&(y=C,E=k)}return y}function hC(n){return[...n]}function dC(n,e){if(n!=="gregory"&&n!=="iso8601")return;const r=d_[n];let u=e.year;const{dayOfWeek:d,dayOfYear:m,daysInYear:y}=r.isoToDate(e,{dayOfWeek:!0,dayOfYear:!0,daysInYear:!0}),l=r.getFirstDayOfWeek(),E=r.getMinimalDaysInFirstWeek();let C=(d+7-l)%7,k=(d-m+7001-l)%7,N=Math.floor((m-1+k)/7);if(7-k>=E&&++N,N==0)N=function(F,B,W,re){let ie=(re-F-W+1)%7;ie<0&&(ie+=7);let de=Math.floor((W+ie-1)/7);return 7-ie>=B&&++de,de}(l,E,m+r.isoToDate(r.dateAdd(e,{years:-1},"constrain"),{daysInYear:!0}).daysInYear,d),u--;else if(m>=y-5){let F=(C+y-m)%7;F<0&&(F+=7),6-F>=E&&m+7-C>y&&(N=1,u++)}return{week:N,year:u}}function _S(n,e,r,u,d){if(e!==d.year){if(n*(e-d.year)>0)return!0}else if(r!==d.month){if(n*(r-d.month)>0)return!0}else if(u!==d.day&&n*(u-d.day)>0)return!0;return!1}const d_={};function Yp(n){if(!n.startsWith("M"))throw new RangeError(`Invalid month code: ${n}.  Month codes must start with M.`);const e=+n.slice(1);if(Number.isNaN(e))throw new RangeError(`Invalid month code: ${n}`);return e}function Ku(n,e=!1){return`M${`${n}`.padStart(2,"0")}${e?"L":""}`}function Aw(n,e=void 0,r=12){let{month:u,monthCode:d}=n;if(d===void 0){if(u===void 0)throw new TypeError("Either month or monthCode are required");e==="reject"&&Ua(u,1,r),e==="constrain"&&(u=ss(u,1,r)),d=Ku(u)}else{const m=Yp(d);if(d!==Ku(m))throw new RangeError(`Invalid month code: ${d}`);if(u!==void 0&&u!==m)throw new RangeError(`monthCode ${d} and month ${u} must match if both are present`);if(u=m,u<1||u>r)throw new RangeError(`Invalid monthCode: ${d}`)}return{...n,month:u,monthCode:d}}d_.iso8601={resolveFields(n,e){if((e==="date"||e==="year-month")&&n.year===void 0)throw new TypeError("year is required");if((e==="date"||e==="month-day")&&n.day===void 0)throw new TypeError("day is required");Object.assign(n,Aw(n))},dateToISO:(n,e)=>A0(n.year,n.month,n.day,e),monthDayToISOReferenceDate(n,e){const{month:r,day:u}=A0(n.year??1972,n.month,n.day,e);return{month:r,day:u,year:1972}},extraFields:()=>[],fieldKeysToIgnore(n){const e=new Set;for(let r=0;r<n.length;r++){const u=n[r];e.add(u),u==="month"?e.add("monthCode"):u==="monthCode"&&e.add("month")}return hC(e)},dateAdd(n,{years:e=0,months:r=0,weeks:u=0,days:d=0},m){let{year:y,month:l,day:E}=n;return y+=e,l+=r,{year:y,month:l}=kp(y,l),{year:y,month:l,day:E}=A0(y,l,E,m),E+=d+7*u,Bs(y,l,E)},dateUntil(n,e,r){const u=-th(n,e);if(u===0)return{years:0,months:0,weeks:0,days:0};let d,m=0,y=0;if(r==="year"||r==="month"){let k=e.year-n.year;for(k!==0&&(k-=u);!_S(u,n.year+k,n.month,n.day,e);)m=k,k+=u;let N=u;for(d=kp(n.year+m,n.month+N);!_S(u,d.year,d.month,n.day,e);)y=N,N+=u,d=kp(d.year,d.month+u);r==="month"&&(y+=12*m,m=0)}d=kp(n.year+m,n.month+y);const l=nC(d.year,d.month,n.day);let E=0,C=$p(e.year,e.month-1,e.day)-$p(l.year,l.month-1,l.day);return r==="week"&&(E=Math.trunc(C/7),C%=7),{years:m,months:y,weeks:E,days:C}},isoToDate({year:n,month:e,day:r},u){const d={era:void 0,eraYear:void 0,year:n,month:e,day:r,daysInWeek:7,monthsInYear:12};if(u.monthCode&&(d.monthCode=Ku(e)),u.dayOfWeek){const m=e+(e<3?10:-2),y=n-(e<3?1:0),l=Math.floor(y/100),E=y-100*l,C=(r+Math.floor(2.6*m-.2)+(E+Math.floor(E/4))+(Math.floor(l/4)-2*l))%7;d.dayOfWeek=C+(C<=0?7:0)}if(u.dayOfYear){let m=r;for(let y=e-1;y>0;y--)m+=Lp(n,y);d.dayOfYear=m}return u.weekOfYear&&(d.weekOfYear=dC("iso8601",{year:n,month:e,day:r})),u.daysInMonth&&(d.daysInMonth=Lp(n,e)),(u.daysInYear||u.inLeapYear)&&(d.inLeapYear=Qv(n),d.daysInYear=d.inLeapYear?366:365),d},getFirstDayOfWeek:()=>1,getMinimalDaysInFirstWeek:()=>4};class Fa{constructor(e){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,e!==void 0){let r=0;for(const u of e.map.entries()){if(++r>Fa.MAX_CACHE_ENTRIES)break;this.map.set(...u)}}}get(e){const r=this.map.get(e);return r&&(this.hits++,this.report()),this.calls++,r}set(e,r){this.map.set(e,r),this.misses++,this.report()}report(){}setObject(e){if(Fa.objectMap.get(e))throw new RangeError("object already cached");Fa.objectMap.set(e,this),this.report()}static getCacheForObject(e){let r=Fa.objectMap.get(e);return r||(r=new Fa,Fa.objectMap.set(e,r)),r}}function fC({isoYear:n,isoMonth:e,isoDay:r}){return`${h_(n)}-${yl(e)}-${yl(r)}T00:00Z`}function Rx(n,e){return{years:n.year-e.year,months:n.month-e.month,days:n.day-e.day}}Fa.objectMap=new WeakMap,Fa.MAX_CACHE_ENTRIES=1e3;class Jp{constructor(){this.eras=[],this.hasEra=!1,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new Intl.DateTimeFormat(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:"short",timeZone:"UTC"})),this.formatter}getCalendarParts(e){let r=this.getFormatter(),u=new Date(e);if(e==="-271821-04-19T00:00Z"){const d=r.resolvedOptions();r=new Intl.DateTimeFormat(d.locale,{...d,timeZone:"Etc/GMT+1"}),u=new Date("-271821-04-20T00:00Z")}try{return r.formatToParts(u)}catch{throw new RangeError(`Invalid ISO date: ${e}`)}}isoToCalendarDate(e,r){const{year:u,month:d,day:m}=e,y=JSON.stringify({func:"isoToCalendarDate",isoYear:u,isoMonth:d,isoDay:m,id:this.id}),l=r.get(y);if(l)return l;const E=fC({isoYear:u,isoMonth:d,isoDay:m}),C=this.getCalendarParts(E),k={};for(let F=0;F<C.length;F++){const{type:B,value:W}=C[F];if(B!=="year"&&B!=="relatedYear"||(this.hasEra?k.eraYear=+W:k.year=+W),B==="month"){const re=/^([0-9]*)(.*?)$/.exec(W);if(!re||re.length!=3||!re[1]&&!re[2])throw new RangeError(`Unexpected month: ${W}`);if(k.month=re[1]?+re[1]:1,k.month<1)throw new RangeError(`Invalid month ${W} from ${E}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(k.month>13)throw new RangeError(`Invalid month ${W} from ${E}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);re[2]&&(k.monthExtra=re[2])}B==="day"&&(k.day=+W),this.hasEra&&B==="era"&&W!=null&&W!==""&&(k.era=W.split(" (")[0].normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(/ /g,"-").toLowerCase())}if(this.hasEra&&k.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.hasEra){const F=this.eras.find(B=>k.era===B.genericName);F&&(k.era=F.code)}if(this.reviseIntlEra){const{era:F,eraYear:B}=this.reviseIntlEra(k,e);k.era=F,k.eraYear=B}this.checkIcuBugs&&this.checkIcuBugs(e);const N=this.adjustCalendarDate(k,r,"constrain",!0);if(N.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(e)}`);if(N.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(e)}`);if(N.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(e)}`);return r.set(y,N),["constrain","reject"].forEach(F=>{const B=JSON.stringify({func:"calendarToIsoDate",year:N.year,month:N.month,day:N.day,overflow:F,id:this.id});r.set(B,e)}),N}validateCalendarDate(e){const{month:r,year:u,day:d,eraYear:m,monthCode:y,monthExtra:l}=e;if(l!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(u===void 0&&m===void 0)throw new TypeError("year or eraYear is required");if(r===void 0&&y===void 0)throw new TypeError("month or monthCode is required");if(d===void 0)throw new RangeError("Missing day");if(y!==void 0){if(typeof y!="string")throw new RangeError("monthCode must be a string, not "+typeof y);if(!/^M([01]?\d)(L?)$/.test(y))throw new RangeError(`Invalid monthCode: ${y}`)}if(this.hasEra&&e.era===void 0!=(e.eraYear===void 0))throw new TypeError("properties era and eraYear must be provided together")}adjustCalendarDate(e,r=void 0,u="constrain",d=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let m=e;this.validateCalendarDate(m);const y=this.monthsInYear(m,r);let{month:l,monthCode:E}=m;return{month:l,monthCode:E}=Aw(m,u,y),{...m,month:l,monthCode:E}}regulateMonthDayNaive(e,r,u){const d=this.monthsInYear(e,u);let{month:m,day:y}=e;return r==="reject"?(Ua(m,1,d),Ua(y,1,this.maximumMonthLength(e))):(m=ss(m,1,d),y=ss(y,1,this.maximumMonthLength({...e,month:m}))),{...e,month:m,day:y}}calendarToIsoDate(e,r="constrain",u){const d=e;let m=this.adjustCalendarDate(e,u,r,!1);m=this.regulateMonthDayNaive(m,r,u);const{year:y,month:l,day:E}=m,C=JSON.stringify({func:"calendarToIsoDate",year:y,month:l,day:E,overflow:r,id:this.id});let k,N=u.get(C);if(N||d.year!==void 0&&d.month!==void 0&&d.day!==void 0&&(d.year!==m.year||d.month!==m.month||d.day!==m.day)&&(k=JSON.stringify({func:"calendarToIsoDate",year:d.year,month:d.month,day:d.day,overflow:r,id:this.id}),N=u.get(k),N))return N;let F=this.estimateIsoDate({year:y,month:l,day:E});const B=Ee=>{let we=this.addDaysIso(F,Ee);if(m.day>this.minimumMonthLength(m)){let ke=this.isoToCalendarDate(we,u);for(;ke.month!==l||ke.year!==y;){if(r==="reject")throw new RangeError(`day ${E} does not exist in month ${l} of year ${y}`);we=this.addDaysIso(we,-1),ke=this.isoToCalendarDate(we,u)}}return we};let W=0,re=this.isoToCalendarDate(F,u),ie=Rx(m,re);if(ie.years!==0||ie.months!==0||ie.days!==0){const Ee=365*ie.years+30*ie.months+ie.days;F=this.addDaysIso(F,Ee),re=this.isoToCalendarDate(F,u),ie=Rx(m,re),ie.years===0&&ie.months===0?F=B(ie.days):W=this.compareCalendarDates(m,re)}let de=8;for(;W;){F=this.addDaysIso(F,W*de);const Ee=re;re=this.isoToCalendarDate(F,u);const we=W;if(W=this.compareCalendarDates(m,re),W){if(ie=Rx(m,re),ie.years===0&&ie.months===0)F=B(ie.days),W=0;else if(we&&W!==we)if(de>1)de/=2;else{if(r==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...d})}`);this.compareCalendarDates(re,Ee)>0&&(F=this.addDaysIso(F,-1)),W=0}}}if(u.set(C,F),k&&u.set(k,F),m.year===void 0||m.month===void 0||m.day===void 0||m.monthCode===void 0||this.hasEra&&(m.era===void 0||m.eraYear===void 0))throw new RangeError("Unexpected missing property");return F}compareCalendarDates(e,r){return e.year!==r.year?Ls(e.year-r.year):e.month!==r.month?Ls(e.month-r.month):e.day!==r.day?Ls(e.day-r.day):0}regulateDate(e,r="constrain",u){const d=this.calendarToIsoDate(e,r,u);return this.isoToCalendarDate(d,u)}addDaysIso(e,r){return Bs(e.year,e.month,e.day+r)}addDaysCalendar(e,r,u){const d=this.calendarToIsoDate(e,"constrain",u),m=this.addDaysIso(d,r);return this.isoToCalendarDate(m,u)}addMonthsCalendar(e,r,u,d){let m=e;const{day:y}=m;for(let l=0,E=Math.abs(r);l<E;l++){const{month:C}=m,k=m,N=r<0?-Math.max(y,this.daysInPreviousMonth(m,d)):this.daysInMonth(m,d),F=this.calendarToIsoDate(m,"constrain",d);let B=this.addDaysIso(F,N);if(m=this.isoToCalendarDate(B,d),r>0){const W=this.monthsInYear(k,d);for(;m.month-1!=C%W;)B=this.addDaysIso(B,-1),m=this.isoToCalendarDate(B,d)}m.day!==y&&(m=this.regulateDate({...m,day:y},"constrain",d))}if(u==="reject"&&m.day!==y)throw new RangeError(`Day ${y} does not exist in resulting calendar month`);return m}addCalendar(e,{years:r=0,months:u=0,weeks:d=0,days:m=0},y,l){const{year:E,day:C,monthCode:k}=e,N=this.adjustCalendarDate({year:E+r,monthCode:k,day:C},l),F=this.addMonthsCalendar(N,u,y,l),B=m+7*d;return this.addDaysCalendar(F,B,l)}untilCalendar(e,r,u,d){let m=0,y=0,l=0,E=0;switch(u){case"day":m=this.calendarDaysUntil(e,r,d);break;case"week":{const C=this.calendarDaysUntil(e,r,d);m=C%7,y=(C-m)/7;break}case"month":case"year":{const C=this.compareCalendarDates(r,e);if(!C)return{years:0,months:0,weeks:0,days:0};const k=r.year-e.year,N=r.day-e.day;if(u==="year"&&k){let W=0;r.monthCode>e.monthCode&&(W=1),r.monthCode<e.monthCode&&(W=-1),W||(W=Math.sign(N)),E=W*C<0?k-C:k}let F,B=E?this.addCalendar(e,{years:E},"constrain",d):e;do l+=C,F=B,B=this.addMonthsCalendar(F,C,"constrain",d),B.day!==e.day&&(B=this.regulateDate({...B,day:e.day},"constrain",d));while(this.compareCalendarDates(r,B)*C>=0);l-=C,m=this.calendarDaysUntil(F,r,d);break}}return{years:E,months:l,weeks:y,days:m}}daysInMonth(e,r){const{day:u}=e,d=this.maximumMonthLength(e),m=this.minimumMonthLength(e);if(m===d)return m;const y=u<=d-m?d:m,l=this.calendarToIsoDate(e,"constrain",r),E=this.addDaysIso(l,y),C=this.isoToCalendarDate(E,r),k=this.addDaysIso(E,-C.day);return this.isoToCalendarDate(k,r).day}daysInPreviousMonth(e,r){const{day:u,month:d,year:m}=e;let y={year:d>1?m:m-1,month:d,day:1};const l=d>1?d-1:this.monthsInYear(y,r);y={...y,month:l};const E=this.minimumMonthLength(y),C=this.maximumMonthLength(y);if(E===C)return C;const k=this.calendarToIsoDate(e,"constrain",r),N=this.addDaysIso(k,-u);return this.isoToCalendarDate(N,r).day}startOfCalendarYear(e){return{year:e.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(e){return{year:e.year,month:e.month,day:1}}calendarDaysUntil(e,r,u){const d=this.calendarToIsoDate(e,"constrain",u),m=this.calendarToIsoDate(r,"constrain",u);return $p(m.year,m.month-1,m.day)-$p(d.year,d.month-1,d.day)}monthDaySearchStartYear(e,r){return 1972}monthDayFromFields(e,r,u){let d,m,y,l,E,{era:C,eraYear:k,year:N,month:F,monthCode:B,day:W}=e;if(F!==void 0&&N===void 0&&(!this.hasEra||C===void 0||k===void 0))throw new TypeError("when month is present, year (or era and eraYear) are required");(B===void 0||N!==void 0||this.hasEra&&k!==void 0)&&({monthCode:B,day:W}=this.isoToCalendarDate(this.calendarToIsoDate(e,r,u),u));const re={year:this.monthDaySearchStartYear(B,W),month:12,day:31},ie=this.isoToCalendarDate(re,u),de=ie.monthCode>B||ie.monthCode===B&&ie.day>=W?ie.year:ie.year-1;for(let Ee=0;Ee<20;Ee++){const we=this.adjustCalendarDate({day:W,monthCode:B,year:de-Ee},u),ke=this.calendarToIsoDate(we,"constrain",u),ge=this.isoToCalendarDate(ke,u);if({year:d,month:m,day:y}=ke,ge.monthCode===B&&ge.day===W)return{month:m,day:y,year:d};if(r==="constrain"){const Ae=this.maxLengthOfMonthCodeInAnyYear(ge.monthCode);if(ge.monthCode===B&&ge.day===Ae&&W>Ae)return{month:m,day:y,year:d};(l===void 0||ge.monthCode===l.monthCode&&ge.day>l.day)&&(l=ge,E=ke)}}if(r==="constrain"&&E!==void 0)return E;throw new RangeError(`No recent ${this.id} year with monthCode ${B} and day ${W}`)}getFirstDayOfWeek(){}getMinimalDaysInFirstWeek(){}}class e4 extends Jp{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}}}inLeapYear(e){const{year:r}=e;return(7*r+1)%19<7}monthsInYear(e){return this.inLeapYear(e)?13:12}minimumMonthLength(e){return this.minMaxMonthLength(e,"min")}maximumMonthLength(e){return this.minMaxMonthLength(e,"max")}minMaxMonthLength(e,r){const{month:u,year:d}=e,m=this.getMonthCode(d,u),y=Object.entries(this.months).find(E=>E[1].monthCode===m);if(y===void 0)throw new RangeError(`unmatched Hebrew month: ${u}`);const l=y[1].days;return typeof l=="number"?l:l[r]}maxLengthOfMonthCodeInAnyYear(e){return["M04","M06","M08","M10","M12"].includes(e)?29:30}estimateIsoDate(e){const{year:r}=e;return{year:r-3760,month:1,day:1}}getMonthCode(e,r){return this.inLeapYear({year:e})?r===6?Ku(5,!0):Ku(r<6?r:r-1):Ku(r)}adjustCalendarDate(e,r,u="constrain",d=!1){let{year:m,month:y,monthCode:l,day:E,monthExtra:C}=e;if(m===void 0)throw new TypeError("Missing property: year");if(d){if(C){const k=this.months[C];if(!k)throw new RangeError(`Unrecognized month from formatToParts: ${C}`);y=this.inLeapYear({year:m})?k.leap:k.regular}return l=this.getMonthCode(m,y),{year:m,month:y,day:E,monthCode:l}}if(this.validateCalendarDate(e),y===void 0)if(l.endsWith("L")){if(l!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${l}`);if(y=6,!this.inLeapYear({year:m})){if(u==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${m} which is not a leap year`);y=6,l="M06"}}else{y=Yp(l),this.inLeapYear({year:m})&&y>=6&&y++;const k=this.monthsInYear({year:m});if(y<1||y>k)throw new RangeError(`Invalid monthCode: ${l}`)}else if(u==="reject"?(Ua(y,1,this.monthsInYear({year:m})),Ua(E,1,this.maximumMonthLength({year:m,month:y}))):(y=ss(y,1,this.monthsInYear({year:m})),E=ss(E,1,this.maximumMonthLength({year:m,month:y}))),l===void 0)l=this.getMonthCode(m,y);else if(this.getMonthCode(m,y)!==l)throw new RangeError(`monthCode ${l} doesn't correspond to month ${y} in Hebrew year ${m}`);return{...e,day:E,month:y,monthCode:l,year:m}}}class ny extends Jp{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425}inLeapYear(e,r){const u={year:e.year,month:1,monthCode:"M01",day:1},d={year:e.year+1,month:1,monthCode:"M01",day:1};return this.calendarDaysUntil(u,d,r)===355}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(){return 30}estimateIsoDate(e){const{year:r}=this.adjustCalendarDate(e);return{year:Math.floor(r*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class t4 extends ny{constructor(){super(...arguments),this.id="islamic"}}class n4 extends ny{constructor(){super(...arguments),this.id="islamic-umalqura"}}class i4 extends ny{constructor(){super(...arguments),this.id="islamic-tbla"}}class r4 extends ny{constructor(){super(...arguments),this.id="islamic-civil"}}class a4 extends ny{constructor(){super(...arguments),this.id="islamic-rgsa"}}class o4 extends ny{constructor(){super(...arguments),this.id="islamicc"}}class s4 extends Jp{constructor(){super(...arguments),this.id="persian",this.calendarType="solar"}inLeapYear(e,r){return this.daysInMonth({year:e.year,month:12,day:1},r)===30}monthsInYear(){return 12}minimumMonthLength(e){const{month:r}=e;return r===12?29:r<=6?31:30}maximumMonthLength(e){const{month:r}=e;return r===12?30:r<=6?31:30}maxLengthOfMonthCodeInAnyYear(e){return Yp(e)<=6?31:30}estimateIsoDate(e){const{year:r}=this.adjustCalendarDate(e);return{year:r+621,month:1,day:1}}}class l4 extends Jp{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(e){return Cw(e.year+78)}monthsInYear(){return 12}minimumMonthLength(e){return this.getMonthInfo(e).length}maximumMonthLength(e){return this.getMonthInfo(e).length}maxLengthOfMonthCodeInAnyYear(e){const r=Yp(e);let u=this.months[r];return u=u.leap??u,u.length}getMonthInfo(e){const{month:r}=e;let u=this.months[r];if(u===void 0)throw new RangeError(`Invalid month: ${r}`);return this.inLeapYear(e)&&u.leap&&(u=u.leap),u}estimateIsoDate(e){const r=this.adjustCalendarDate(e),u=this.getMonthInfo(r);return Bs(r.year+78+(u.nextYear?1:0),u.month,u.day+r.day-1)}checkIcuBugs(e){if(this.vulnerableToBceBug&&e.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function Cw(n){return n%4==0&&(n%100!=0||n%400==0)}class pC extends Jp{constructor(e,r){super(),this.calendarType="solar",this.id=e,this.isoEpoch=r}inLeapYear(e){const{year:r}=this.estimateIsoDate({month:1,day:1,year:e.year});return Cw(r)}monthsInYear(){return 12}minimumMonthLength(e){const{month:r}=e;return r===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(r)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}maxLengthOfMonthCodeInAnyYear(e){return[31,29,31,30,31,30,31,31,30,31,30,31][Yp(e)-1]}estimateIsoDate(e){const r=this.adjustCalendarDate(e);return A0(r.year+this.isoEpoch.year,r.month+this.isoEpoch.month,r.day+this.isoEpoch.day,"constrain")}}class mC extends Jp{constructor(e,r){super(),this.hasEra=!0,this.calendarType="solar",this.id=e;const{eras:u,anchorEra:d}=function(m){let y,l=m;if(l.length===0)throw new RangeError("Invalid era data: eras are required");if(l.length===1&&l[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(l.length===1&&!l[0].code)throw new RangeError("Invalid era data: at least one named era is required");if(l.filter(C=>C.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");l.forEach(C=>{if(C.isAnchor||!C.anchorEpoch&&!C.reverseOf){if(y)throw new RangeError("Invalid era data: cannot have multiple anchor eras");y=C,C.anchorEpoch={year:C.hasYearZero?0:1}}else if(!C.code)throw new RangeError("If era name is blank, it must be the anchor era")}),l=l.filter(C=>C.code),l.forEach(C=>{const{reverseOf:k}=C;if(k){const N=l.find(F=>F.code===k);if(N===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${k}`);C.reverseOf=N,C.anchorEpoch=N.anchorEpoch,C.isoEpoch=N.isoEpoch}C.anchorEpoch.month===void 0&&(C.anchorEpoch.month=1),C.anchorEpoch.day===void 0&&(C.anchorEpoch.day=1)}),l.sort((C,k)=>{if(C.reverseOf)return 1;if(k.reverseOf)return-1;if(!C.isoEpoch||!k.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return k.isoEpoch.year-C.isoEpoch.year});const E=l[l.length-1].reverseOf;if(E&&E!==l[l.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return l.forEach((C,k)=>{C.genericName="era"+(l.length-1-k)}),{eras:l,anchorEra:y||l[0]}}(r);this.anchorEra=d,this.eras=u}inLeapYear(e){const{year:r}=this.estimateIsoDate({month:1,day:1,year:e.year});return Cw(r)}monthsInYear(){return 12}minimumMonthLength(e){const{month:r}=e;return r===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(r)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}maxLengthOfMonthCodeInAnyYear(e){return[31,29,31,30,31,30,31,31,30,31,30,31][Yp(e)-1]}completeEraYear(e){const r=(l,E,C)=>{const k=e[l];if(k!=null&&k!=E&&!(C||[]).includes(k)){const N=C?.[0];throw new RangeError(`Input ${l} ${k} doesn't match calculated value ${N?`${E} (also called ${N})`:E}`)}},u=l=>{let E;const C={...e,year:l},k=this.eras.find((N,F)=>{if(F===this.eras.length-1){if(N.reverseOf){if(l>0)throw new RangeError(`Signed year ${l} is invalid for era ${N.code}`);return E=N.anchorEpoch.year-l,!0}return E=l-N.anchorEpoch.year+(N.hasYearZero?0:1),!0}return this.compareCalendarDates(C,N.anchorEpoch)>=0&&(E=l-N.anchorEpoch.year+(N.hasYearZero?0:1),!0)});if(!k)throw new RangeError(`Year ${l} was not matched by any era`);return{eraYear:E,era:k.code,eraNames:k.names}};let{year:d,eraYear:m,era:y}=e;if(d!=null){const l=u(d);({eraYear:m,era:y}=l),r("era",y,l?.eraNames),r("eraYear",m)}else{if(m==null)throw new RangeError("Either year or eraYear and era are required");{if(y===void 0)throw new RangeError("era and eraYear must be provided together");const l=this.eras.find(({code:E,names:C=[]})=>E===y||C.includes(y));if(!l)throw new RangeError(`Era ${y} (ISO year ${m}) was not matched by any era`);d=l.reverseOf?l.anchorEpoch.year-m:m+l.anchorEpoch.year-(l.hasYearZero?0:1),r("year",d),{eraYear:m,era:y}=u(d)}}return{...e,year:d,eraYear:m,era:y}}adjustCalendarDate(e,r,u="constrain"){let d=e;const{month:m,monthCode:y}=d;return m===void 0&&(d={...d,month:Yp(y)}),this.validateCalendarDate(d),d=this.completeEraYear(d),super.adjustCalendarDate(d,r,u)}estimateIsoDate(e){const r=this.adjustCalendarDate(e),{year:u,month:d,day:m}=r,{anchorEra:y}=this;return A0(u+y.isoEpoch.year-(y.hasYearZero?0:1),d,m,"constrain")}}class Dw extends mC{constructor(e,r){super(e,r)}isoToCalendarDate(e){const{year:r,month:u,day:d}=e,m=Ku(u),y=r-this.anchorEra.isoEpoch.year+1;return this.completeEraYear({year:y,month:u,monthCode:m,day:d})}}const $u={inLeapYear(n){const{year:e}=n;return(e+1)%4==0},monthsInYear:()=>13,minimumMonthLength(n){const{month:e}=n;return e===13?this.inLeapYear(n)?6:5:30},maximumMonthLength(n){return this.minimumMonthLength(n)},maxLengthOfMonthCodeInAnyYear:n=>n==="M13"?6:30};class c4 extends pC{constructor(e,r){super(e,r),this.inLeapYear=$u.inLeapYear,this.monthsInYear=$u.monthsInYear,this.minimumMonthLength=$u.minimumMonthLength,this.maximumMonthLength=$u.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=$u.maxLengthOfMonthCodeInAnyYear}}class gC extends mC{constructor(e,r){super(e,r),this.inLeapYear=$u.inLeapYear,this.monthsInYear=$u.monthsInYear,this.minimumMonthLength=$u.minimumMonthLength,this.maximumMonthLength=$u.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=$u.maxLengthOfMonthCodeInAnyYear}}class u4 extends c4{constructor(){super("ethioaa",{year:-5492,month:7,day:17})}}class h4 extends gC{constructor(){super("coptic",[{code:"coptic",isoEpoch:{year:284,month:8,day:29}},{code:"coptic-inverse",reverseOf:"coptic"}])}}class d4 extends gC{constructor(){super("ethiopic",[{code:"ethioaa",names:["ethiopic-amete-alem","mundi"],isoEpoch:{year:-5492,month:7,day:17}},{code:"ethiopic",names:["incar"],isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class f4 extends Dw{constructor(){super("roc",[{code:"roc",names:["minguo"],isoEpoch:{year:1912,month:1,day:1}},{code:"roc-inverse",names:["before-roc"],reverseOf:"roc"}])}}class p4 extends pC{constructor(){super("buddhist",{year:-543,month:1,day:1})}}class m4 extends Dw{constructor(){super("gregory",[{code:"gregory",names:["ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"gregory-inverse",names:["be","bce"],reverseOf:"gregory"}])}reviseIntlEra(e){let{era:r,eraYear:u}=e;return r==="b"&&(r="gregory-inverse"),r==="a"&&(r="gregory"),{era:r,eraYear:u}}getFirstDayOfWeek(){return 1}getMinimalDaysInFirstWeek(){return 1}}class g4 extends Dw{constructor(){super("japanese",[{code:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{code:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{code:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{code:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{code:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{code:"japanese",names:["japanese","gregory","ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"japanese-inverse",names:["japanese-inverse","gregory-inverse","bc","bce"],reverseOf:"japanese"}]),this.erasBeginMidYear=!0}reviseIntlEra(e,r){const{era:u,eraYear:d}=e,{year:m}=r;return this.eras.find(y=>y.code===u)?{era:u,eraYear:d}:m<1?{era:"japanese-inverse",eraYear:1-m}:{era:"japanese",eraYear:m}}}class yC extends Jp{constructor(){super(...arguments),this.calendarType="lunisolar"}inLeapYear(e,r){const u=this.getMonthList(e.year,r);return Object.entries(u).length===13}monthsInYear(e,r){return this.inLeapYear(e,r)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(e){return["M01L","M09L","M10L","M11L","M12L"].includes(e)?29:30}monthDaySearchStartYear(e,r){const u={M01L:[1651,1651],M02L:[1947,1765],M03L:[1966,1955],M04L:[1963,1944],M05L:[1971,1952],M06L:[1960,1941],M07L:[1968,1938],M08L:[1957,1718],M09L:[1832,1832],M10L:[1870,1870],M11L:[1814,1814],M12L:[1890,1890]}[e]??[1972,1972];return r<30?u[0]:u[1]}getMonthList(e,r){if(e===void 0)throw new TypeError("Missing year");const u=JSON.stringify({func:"getMonthList",calendarYear:e,id:this.id}),d=r.get(u);if(d)return d;const m=this.getFormatter(),y=(ie,de)=>{const Ee=fC({isoYear:ie,isoMonth:2,isoDay:1}),we=new Date(Ee);we.setUTCDate(de+1);const ke=m.formatToParts(we),ge=ke.find(Me=>Me.type==="month").value,Ae=+ke.find(Me=>Me.type==="day").value,Ge=ke.find(Me=>Me.type==="relatedYear");let at;if(Ge===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return at=+Ge.value,{calendarMonthString:ge,calendarDay:Ae,calendarYearToVerify:at}};let l=17,{calendarMonthString:E,calendarDay:C,calendarYearToVerify:k}=y(e,l);E!=="1"&&(l+=29,{calendarMonthString:E,calendarDay:C}=y(e,l)),l-=C-5;const N={};let F,B,W=1,re=!1;do({calendarMonthString:E,calendarDay:C,calendarYearToVerify:k}=y(e,l)),F&&(N[B].daysInMonth=F+30-C),k!==e?re=!0:(N[E]={monthIndex:W++},l+=30),F=C,B=E;while(!re);return N[B].daysInMonth=F+30-C,r.set(u,N),N}estimateIsoDate(e){const{year:r,month:u}=e;return{year:r,month:u>=12?12:u+1,day:1}}adjustCalendarDate(e,r,u="constrain",d=!1){let{year:m,month:y,monthExtra:l,day:E,monthCode:C}=e;if(m===void 0)throw new TypeError("Missing property: year");if(d){if(l&&l!=="bis")throw new RangeError(`Unexpected leap month suffix: ${l}`);const k=Ku(y,l!==void 0),N=`${y}${l||""}`,F=this.getMonthList(m,r)[N];if(F===void 0)throw new RangeError(`Unmatched month ${N} in Chinese year ${m}`);return y=F.monthIndex,{year:m,month:y,day:E,monthCode:k}}if(this.validateCalendarDate(e),y===void 0){const k=this.getMonthList(m,r);let N=C.replace(/^M|L$/g,B=>B==="L"?"bis":"");N[0]==="0"&&(N=N.slice(1));let F=k[N];if(y=F&&F.monthIndex,y===void 0&&C.endsWith("L")&&C!="M13L"&&u==="constrain"){const B=+C.replace(/^M0?|L$/g,"");F=k[B],F&&(y=F.monthIndex,C=Ku(B))}if(y===void 0)throw new RangeError(`Unmatched month ${C} in Chinese year ${m}`)}else if(C===void 0){const k=this.getMonthList(m,r),N=Object.entries(k),F=N.length;u==="reject"?(Ua(y,1,F),Ua(E,1,this.maximumMonthLength())):(y=ss(y,1,F),E=ss(E,1,this.maximumMonthLength()));const B=N.find(W=>W[1].monthIndex===y);if(B===void 0)throw new RangeError(`Invalid month ${y} in Chinese year ${m}`);C=Ku(+B[0].replace("bis",""),B[0].indexOf("bis")!==-1)}else{const k=this.getMonthList(m,r);let N=C.replace(/^M|L$/g,B=>B==="L"?"bis":"");N[0]==="0"&&(N=N.slice(1));const F=k[N];if(!F)throw new RangeError(`Unmatched monthCode ${C} in Chinese year ${m}`);if(y!==F.monthIndex)throw new RangeError(`monthCode ${C} doesn't correspond to month ${y} in Chinese year ${m}`)}return{...e,year:m,month:y,monthCode:C,day:E}}}class y4 extends yC{constructor(){super(...arguments),this.id="chinese"}}class _4 extends yC{constructor(){super(...arguments),this.id="dangi"}}class v4{constructor(e){this.helper=e}extraFields(e){return this.helper.hasEra&&e.includes("year")?["era","eraYear"]:[]}resolveFields(e){if(this.helper.calendarType!=="lunisolar"){const r=new Fa;Aw(e,void 0,this.helper.monthsInYear({year:e.year??1972},r))}}dateToISO(e,r){const u=new Fa,d=this.helper.calendarToIsoDate(e,r,u);return u.setObject(d),d}monthDayToISOReferenceDate(e,r){const u=new Fa,d=this.helper.monthDayFromFields(e,r,u);return u.setObject(d),d}fieldKeysToIgnore(e){const r=new Set;for(let u=0;u<e.length;u++){const d=e[u];switch(r.add(d),d){case"era":r.add("eraYear"),r.add("year");break;case"eraYear":r.add("era"),r.add("year");break;case"year":r.add("era"),r.add("eraYear");break;case"month":r.add("monthCode"),this.helper.erasBeginMidYear&&(r.add("era"),r.add("eraYear"));break;case"monthCode":r.add("month"),this.helper.erasBeginMidYear&&(r.add("era"),r.add("eraYear"));break;case"day":this.helper.erasBeginMidYear&&(r.add("era"),r.add("eraYear"))}}return hC(r)}dateAdd(e,{years:r,months:u,weeks:d,days:m},y){const l=Fa.getCacheForObject(e),E=this.helper.isoToCalendarDate(e,l),C=this.helper.addCalendar(E,{years:r,months:u,weeks:d,days:m},y,l),k=this.helper.calendarToIsoDate(C,"constrain",l);return Fa.getCacheForObject(k)||new Fa(l).setObject(k),k}dateUntil(e,r,u){const d=Fa.getCacheForObject(e),m=Fa.getCacheForObject(r),y=this.helper.isoToCalendarDate(e,d),l=this.helper.isoToCalendarDate(r,m);return this.helper.untilCalendar(y,l,u,d)}isoToDate(e,r){const u=Fa.getCacheForObject(e),d=this.helper.isoToCalendarDate(e,u);if(r.dayOfWeek&&(d.dayOfWeek=d_.iso8601.isoToDate(e,{dayOfWeek:!0}).dayOfWeek),r.dayOfYear){const m=this.helper.startOfCalendarYear(d),y=this.helper.calendarDaysUntil(m,d,u);d.dayOfYear=y+1}if(r.weekOfYear&&(d.weekOfYear=dC(this.helper.id,e)),d.daysInWeek=7,r.daysInMonth&&(d.daysInMonth=this.helper.daysInMonth(d,u)),r.daysInYear){const m=this.helper.startOfCalendarYear(d),y=this.helper.addCalendar(m,{years:1},"constrain",u);d.daysInYear=this.helper.calendarDaysUntil(m,y,u)}return r.monthsInYear&&(d.monthsInYear=this.helper.monthsInYear(d,u)),r.inLeapYear&&(d.inLeapYear=this.helper.inLeapYear(d,u)),d}getFirstDayOfWeek(){return this.helper.getFirstDayOfWeek()}getMinimalDaysInFirstWeek(){return this.helper.getMinimalDaysInFirstWeek()}}for(const n of[e4,s4,d4,u4,h4,y4,_4,f4,l4,p4,m4,g4,t4,n4,i4,r4,a4,o4]){const e=new n;d_[e.id]=new v4(e)}u1("calendarImpl",function(n){return d_[n]});const Z0=Intl.DateTimeFormat;function pg(n,e){let r=oe(n,e);return typeof r=="function"&&(r=new Z0(oe(n,CA),r(oe(n,o1))),function(u,d,m){const y=xb(u);if(y===void 0)throw new TypeError("Missing slots for the given container");if(y[d]===void 0)throw new TypeError(`tried to reset ${d} which was not set`);y[d]=m}(n,e,r)),r}function s0(n){return ds(n,Qp)}class Y0{constructor(e=void 0,r=void 0){(function(u,d,m){const y=m!==void 0;let l;if(y){const N=["localeMatcher","calendar","numberingSystem","hour12","hourCycle","timeZone","weekday","era","year","month","day","dayPeriod","hour","minute","second","fractionalSecondDigits","timeZoneName","formatMatcher","dateStyle","timeStyle"];l=function(B){if(B==null)throw new TypeError(`Expected object not ${B}`);return Object(B)}(m);const F=Object.create(null);for(let B=0;B<N.length;B++){const W=N[B];Object.prototype.hasOwnProperty.call(l,W)&&(F[W]=l[W])}l=F}else l=Object.create(null);const E=new Z0(d,l),C=E.resolvedOptions();if(Md(u),y){const N=Object.assign(Object.create(null),C);for(const F in N)Object.prototype.hasOwnProperty.call(l,F)||delete N[F];N.hour12=l.hour12,N.hourCycle=l.hourCycle,Bn(u,o1,N)}else Bn(u,o1,l);Bn(u,CA,C.locale),Bn(u,Qp,E),Bn(u,yg,C.timeZone),Bn(u,p0,C.calendar),Bn(u,wA,C4),Bn(u,TA,M4),Bn(u,SA,A4),Bn(u,EA,E4),Bn(u,MA,D4),Bn(u,AA,I4);const k=y?l.timeZone:void 0;if(k===void 0)Bn(u,a1,C.timeZone);else{const N=Eb(k);if(N.startsWith("−"))throw new RangeError("Unicode minus (U+2212) is not supported in time zone offsets");Bn(u,a1,cs(N))}})(this,e,r)}get format(){rt(this,s0);const e=x4.bind(this);return Object.defineProperties(e,{length:{value:1,enumerable:!1,writable:!1,configurable:!0},name:{value:"",enumerable:!1,writable:!1,configurable:!0}}),e}formatRange(e,r){return rt(this,s0),T4.call(this,e,r)}formatToParts(e,...r){return rt(this,s0),w4.call(this,e,...r)}formatRangeToParts(e,r){return rt(this,s0),S4.call(this,e,r)}resolvedOptions(){return rt(this,s0),b4.call(this)}}"formatToParts"in Z0.prototype||delete Y0.prototype.formatToParts,"formatRangeToParts"in Z0.prototype||delete Y0.prototype.formatRangeToParts;const Zl=function(n=void 0,e=void 0){return new Y0(n,e)};function b4(){const n=oe(this,Qp).resolvedOptions();return n.timeZone=oe(this,a1),n}function x4(n,...e){let r,u,d=Bg(n,this);return d.formatter?(r=d.formatter,u=[Wl(d.epochNs,"floor")]):(r=oe(this,Qp),u=[n,...e]),r.format(...u)}function w4(n,...e){let r,u,d=Bg(n,this);return d.formatter?(r=d.formatter,u=[Wl(d.epochNs,"floor")]):(r=oe(this,Qp),u=[n,...e]),r.formatToParts(...u)}function T4(n,e){if(n===void 0||e===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const r=tb(n),u=tb(e);let d,m=[r,u];if(yd(r)!==yd(u))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");if(yd(r)){if(!_C(r,u))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{epochNs:y,formatter:l}=Bg(r,this),{epochNs:E,formatter:C}=Bg(u,this);l&&(d=l,m=[Wl(y,"floor"),Wl(E,"floor")])}return d||(d=oe(this,Qp)),d.formatRange(...m)}function S4(n,e){if(n===void 0||e===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const r=tb(n),u=tb(e);let d,m=[r,u];if(yd(r)!==yd(u))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");if(yd(r)){if(!_C(r,u))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{epochNs:y,formatter:l}=Bg(r,this),{epochNs:E,formatter:C}=Bg(u,this);l&&(d=l,m=[Wl(y,"floor"),Wl(E,"floor")])}return d||(d=oe(this,Qp)),d.formatRangeToParts(...m)}function f_(n={},e={}){const r=Object.assign({},n),u=["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"];for(let d=0;d<u.length;d++){const m=u[d];r[m]=m in e?e[m]:r[m],r[m]!==!1&&r[m]!==void 0||delete r[m]}return r}function E4(n){const e=f_(n,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});if(e.timeStyle!=="long"&&e.timeStyle!=="full"||(delete e.timeStyle,Object.assign(e,{hour:"numeric",minute:"2-digit",second:"2-digit"})),!Ob(e)){if(p_(n))throw new TypeError(`cannot format Temporal.PlainTime with options [${Object.keys(n)}]`);Object.assign(e,{hour:"numeric",minute:"numeric",second:"numeric"})}return e}function M4(n){const e={short:{year:"2-digit",month:"numeric"},medium:{year:"numeric",month:"short"},long:{year:"numeric",month:"long"},full:{year:"numeric",month:"long"}},r=f_(n,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in r&&r.dateStyle){const u=r.dateStyle;delete r.dateStyle,Object.assign(r,e[u])}if(!("year"in r||"month"in r||"era"in r)){if(p_(n))throw new TypeError(`cannot format PlainYearMonth with options [${Object.keys(n)}]`);Object.assign(r,{year:"numeric",month:"numeric"})}return r}function A4(n){const e={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric"},long:{month:"long",day:"numeric"},full:{month:"long",day:"numeric"}},r=f_(n,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in r&&r.dateStyle){const u=r.dateStyle;delete r.dateStyle,Object.assign(r,e[u])}if(!("month"in r)&&!("day"in r)){if(p_(n))throw new TypeError(`cannot format PlainMonthDay with options [${Object.keys(n)}]`);Object.assign(r,{month:"numeric",day:"numeric"})}return r}function C4(n){const e=f_(n,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if(!Pb(e)){if(p_(n))throw new TypeError(`cannot format PlainDate with options [${Object.keys(n)}]`);Object.assign(e,{year:"numeric",month:"numeric",day:"numeric"})}return e}function D4(n){const e=f_(n,{timeZoneName:!1});if((e.timeStyle==="long"||e.timeStyle==="full")&&(delete e.timeStyle,Object.assign(e,{hour:"numeric",minute:"2-digit",second:"2-digit"}),e.dateStyle)&&(Object.assign(e,{short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"long",day:"numeric"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long"}}[e.dateStyle]),delete e.dateStyle),!Ob(e)&&!Pb(e)){if(p_(n))throw new TypeError(`cannot format PlainDateTime with options [${Object.keys(n)}]`);Object.assign(e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}return e}function I4(n){let e=n;return Ob(e)||Pb(e)||(e=Object.assign({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function Pb(n){return"year"in n||"month"in n||"day"in n||"weekday"in n||"dateStyle"in n||"era"in n}function Ob(n){return"hour"in n||"minute"in n||"second"in n||"timeStyle"in n||"dayPeriod"in n||"fractionalSecondDigits"in n}function p_(n){return Pb(n)||Ob(n)||"dateStyle"in n||"timeStyle"in n||"timeZoneName"in n}function yd(n){return Ir(n)||Ur(n)||nr(n)||Yn(n)||lo(n)||hl(n)||so(n)}function tb(n){return yd(n)?n:Sb(n)}function _C(n,e){return!(!yd(n)||!yd(e)||Ur(n)&&!Ur(e)||Ir(n)&&!Ir(e)||nr(n)&&!nr(e)||Yn(n)&&!Yn(e)||lo(n)&&!lo(e)||hl(n)&&!hl(e)||so(n)&&!so(e))}function Bg(n,e){if(Ur(n)){const r={isoDate:{year:1970,month:1,day:1},time:oe(n,Rr)};return{epochNs:Lo(oe(e,yg),r,"compatible"),formatter:pg(e,EA)}}if(lo(n)){const r=oe(n,Rt),u=oe(e,p0);if(r!==u)throw new RangeError(`cannot format PlainYearMonth with calendar ${r} in locale with calendar ${u}`);const d=hi(oe(n,Tn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:Lo(oe(e,yg),d,"compatible"),formatter:pg(e,TA)}}if(hl(n)){const r=oe(n,Rt),u=oe(e,p0);if(r!==u)throw new RangeError(`cannot format PlainMonthDay with calendar ${r} in locale with calendar ${u}`);const d=hi(oe(n,Tn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:Lo(oe(e,yg),d,"compatible"),formatter:pg(e,SA)}}if(Ir(n)){const r=oe(n,Rt),u=oe(e,p0);if(r!=="iso8601"&&r!==u)throw new RangeError(`cannot format PlainDate with calendar ${r} in locale with calendar ${u}`);const d=hi(oe(n,Tn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:Lo(oe(e,yg),d,"compatible"),formatter:pg(e,wA)}}if(nr(n)){const r=oe(n,Rt),u=oe(e,p0);if(r!=="iso8601"&&r!==u)throw new RangeError(`cannot format PlainDateTime with calendar ${r} in locale with calendar ${u}`);const d=oe(n,dr);return{epochNs:Lo(oe(e,yg),d,"compatible"),formatter:pg(e,MA)}}if(Yn(n))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return so(n)?{epochNs:oe(n,wn),formatter:pg(e,AA)}:{}}function vC(n){const e=Object.create(null);return e.years=oe(n,Jo),e.months=oe(n,es),e.weeks=oe(n,Ps),e.days=oe(n,ts),e.hours=oe(n,ns),e.minutes=oe(n,is),e.seconds=oe(n,rs),e.milliseconds=oe(n,as),e.microseconds=oe(n,os),e.nanoseconds=oe(n,Os),e}Y0.prototype.constructor=Zl,Object.defineProperty(Zl,"prototype",{value:Y0.prototype,writable:!1,enumerable:!1,configurable:!1}),Zl.supportedLocalesOf=Z0.supportedLocalesOf,Ad(Zl,"Intl.DateTimeFormat");const{format:R4,formatToParts:k4}=Intl.DurationFormat?.prototype??Object.create(null);function bC(n){Intl.DurationFormat.prototype.resolvedOptions.call(this);const e=vC(Yl(n));return R4.call(this,e)}Intl.DurationFormat?.prototype&&(Intl.DurationFormat.prototype.format=bC,Intl.DurationFormat.prototype.formatToParts=function(n){Intl.DurationFormat.prototype.resolvedOptions.call(this);const e=vC(Yl(n));return k4.call(this,e)});class Iw{constructor(e){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");HA(this,eb(e))}get epochMilliseconds(){return rt(this,so),Wl(oe(this,wn),"floor")}get epochNanoseconds(){return rt(this,so),cC(J.BigInt(oe(this,wn)))}add(e){return rt(this,so),dS("add",this,e)}subtract(e){return rt(this,so),dS("subtract",this,e)}until(e,r=void 0){return rt(this,so),aS("until",this,e,r)}since(e,r=void 0){return rt(this,so),aS("since",this,e,r)}round(e){if(rt(this,so),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?Zp("smallestUnit",e):tn(e),u=Kg(r),d=Yc(r,"halfExpand"),m=Ns(r,"smallestUnit","time",wd);return Jg(u,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[m],!0),Yu(b1(oe(this,wn),u,m,d))}equals(e){rt(this,so);const r=y0(e),u=oe(this,wn),d=oe(r,wn);return J.equal(J.BigInt(u),J.BigInt(d))}toString(e=void 0){rt(this,so);const r=tn(e),u=r_(r),d=Yc(r,"trunc"),m=Ns(r,"smallestUnit","time",void 0);if(m==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let y=r.timeZone;y!==void 0&&(y=cs(y));const{precision:l,unit:E,increment:C}=a_(m,u);return WT(Yu(b1(oe(this,wn),C,E,d)),y,l)}toJSON(){return rt(this,so),WT(this,void 0,"auto")}toLocaleString(e=void 0,r=void 0){return rt(this,so),new Zl(e,r).format(this)}valueOf(){Ff("Instant")}toZonedDateTimeISO(e){rt(this,so);const r=cs(e);return Po(oe(this,wn),r,"iso8601")}static fromEpochMilliseconds(e){return Yu(qu(Sb(e)))}static fromEpochNanoseconds(e){return Yu(eb(e))}static from(e){return y0(e)}static compare(e,r){const u=y0(e),d=y0(r),m=oe(u,wn),y=oe(d,wn);return J.lessThan(m,y)?-1:J.greaterThan(m,y)?1:0}}Ad(Iw,"Temporal.Instant");class Rw{constructor(e,r,u,d="iso8601"){const m=Cn(e),y=Cn(r),l=Cn(u),E=fs(d===void 0?"iso8601":Ma(d));Vp(m,y,l),VA(this,{year:m,month:y,day:l},E)}get calendarId(){return rt(this,Ir),oe(this,Rt)}get era(){return Wo(this,"era")}get eraYear(){return Wo(this,"eraYear")}get year(){return Wo(this,"year")}get month(){return Wo(this,"month")}get monthCode(){return Wo(this,"monthCode")}get day(){return Wo(this,"day")}get dayOfWeek(){return Wo(this,"dayOfWeek")}get dayOfYear(){return Wo(this,"dayOfYear")}get weekOfYear(){return Wo(this,"weekOfYear")?.week}get yearOfWeek(){return Wo(this,"weekOfYear")?.year}get daysInWeek(){return Wo(this,"daysInWeek")}get daysInMonth(){return Wo(this,"daysInMonth")}get daysInYear(){return Wo(this,"daysInYear")}get monthsInYear(){return Wo(this,"monthsInYear")}get inLeapYear(){return Wo(this,"inLeapYear")}with(e,r=void 0){if(rt(this,Ir),!kr(e))throw new TypeError("invalid argument");Qg(e);const u=oe(this,Rt);let d=us(u,oe(this,Tn));return d=Up(u,d,vl(u,e,["year","month","monthCode","day"],[],"partial")),ls(Of(u,d,li(tn(r))),u)}withCalendar(e){rt(this,Ir);const r=c_(e);return ls(oe(this,Tn),r)}add(e,r=void 0){return rt(this,Ir),fS("add",this,e,r)}subtract(e,r=void 0){return rt(this,Ir),fS("subtract",this,e,r)}until(e,r=void 0){return rt(this,Ir),oS("until",this,e,r)}since(e,r=void 0){return rt(this,Ir),oS("since",this,e,r)}equals(e){rt(this,Ir);const r=m0(e);return th(oe(this,Tn),oe(r,Tn))===0&&Ju(oe(this,Rt),oe(r,Rt))}toString(e=void 0){return rt(this,Ir),QT(this,i_(tn(e)))}toJSON(){return rt(this,Ir),QT(this)}toLocaleString(e=void 0,r=void 0){return rt(this,Ir),new Zl(e,r).format(this)}valueOf(){Ff("PlainDate")}toPlainDateTime(e=void 0){rt(this,Ir);const r=UA(e);return Gl(hi(oe(this,Tn),r),oe(this,Rt))}toZonedDateTime(e){let r,u;if(rt(this,Ir),kr(e)){const y=e.timeZone;y===void 0?r=cs(e):(r=cs(y),u=e.plainTime)}else r=cs(e);const d=oe(this,Tn);let m;return u===void 0?m=Tf(r,d):(u=Ef(u),m=Lo(r,hi(d,oe(u,Rr)),"compatible")),Po(m,r,oe(this,Rt))}toPlainYearMonth(){rt(this,Ir);const e=oe(this,Rt);return Sg(B0(e,us(e,oe(this,Tn)),"constrain"),e)}toPlainMonthDay(){rt(this,Ir);const e=oe(this,Rt);return bg(Xv(e,us(e,oe(this,Tn)),"constrain"),e)}static from(e,r=void 0){return m0(e,r)}static compare(e,r){const u=m0(e),d=m0(r);return th(oe(u,Tn),oe(d,Tn))}}function Wo(n,e){rt(n,Ir);const r=oe(n,Tn);return o_(n).isoToDate(r,{[e]:!0})[e]}Ad(Rw,"Temporal.PlainDate");class kw{constructor(e,r,u,d=0,m=0,y=0,l=0,E=0,C=0,k="iso8601"){const N=Cn(e),F=Cn(r),B=Cn(u),W=d===void 0?0:Cn(d),re=m===void 0?0:Cn(m),ie=y===void 0?0:Cn(y),de=l===void 0?0:Cn(l),Ee=E===void 0?0:Cn(E),we=C===void 0?0:Cn(C),ke=fs(k===void 0?"iso8601":Ma(k));Tw(N,F,B,W,re,ie,de,Ee,we),GA(this,{isoDate:{year:N,month:F,day:B},time:{hour:W,minute:re,second:ie,millisecond:de,microsecond:Ee,nanosecond:we}},ke)}get calendarId(){return rt(this,nr),oe(this,Rt)}get year(){return Qo(this,"year")}get month(){return Qo(this,"month")}get monthCode(){return Qo(this,"monthCode")}get day(){return Qo(this,"day")}get hour(){return mg(this,"hour")}get minute(){return mg(this,"minute")}get second(){return mg(this,"second")}get millisecond(){return mg(this,"millisecond")}get microsecond(){return mg(this,"microsecond")}get nanosecond(){return mg(this,"nanosecond")}get era(){return Qo(this,"era")}get eraYear(){return Qo(this,"eraYear")}get dayOfWeek(){return Qo(this,"dayOfWeek")}get dayOfYear(){return Qo(this,"dayOfYear")}get weekOfYear(){return Qo(this,"weekOfYear")?.week}get yearOfWeek(){return Qo(this,"weekOfYear")?.year}get daysInWeek(){return Qo(this,"daysInWeek")}get daysInYear(){return Qo(this,"daysInYear")}get daysInMonth(){return Qo(this,"daysInMonth")}get monthsInYear(){return Qo(this,"monthsInYear")}get inLeapYear(){return Qo(this,"inLeapYear")}with(e,r=void 0){if(rt(this,nr),!kr(e))throw new TypeError("invalid argument");Qg(e);const u=oe(this,Rt),d=oe(this,dr);let m={...us(u,d.isoDate),...d.time};return m=Up(u,m,vl(u,e,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],"partial")),Gl(s_(u,m,li(tn(r))),u)}withPlainTime(e=void 0){rt(this,nr);const r=UA(e);return Gl(hi(oe(this,dr).isoDate,r),oe(this,Rt))}withCalendar(e){rt(this,nr);const r=c_(e);return Gl(oe(this,dr),r)}add(e,r=void 0){return rt(this,nr),pS("add",this,e,r)}subtract(e,r=void 0){return rt(this,nr),pS("subtract",this,e,r)}until(e,r=void 0){return rt(this,nr),sS("until",this,e,r)}since(e,r=void 0){return rt(this,nr),sS("since",this,e,r)}round(e){if(rt(this,nr),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?Zp("smallestUnit",e):tn(e),u=Kg(r),d=Yc(r,"halfExpand"),m=Ns(r,"smallestUnit","time",wd,["day"]),y={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[m];Jg(u,y,y===1);const l=oe(this,dr);return Gl(u===1&&m==="nanosecond"?l:x1(l,u,m,d),oe(this,Rt))}equals(e){rt(this,nr);const r=g0(e);return Fg(oe(this,dr),oe(r,dr))===0&&Ju(oe(this,Rt),oe(r,Rt))}toString(e=void 0){rt(this,nr);const r=tn(e),u=i_(r),d=r_(r),m=Yc(r,"trunc"),y=Ns(r,"smallestUnit","time",void 0);if(y==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:l,unit:E,increment:C}=a_(y,d),k=x1(oe(this,dr),C,E,m);return Gp(k),V0(k,oe(this,Rt),l,u)}toJSON(){return rt(this,nr),V0(oe(this,dr),oe(this,Rt),"auto")}toLocaleString(e=void 0,r=void 0){return rt(this,nr),new Zl(e,r).format(this)}valueOf(){Ff("PlainDateTime")}toZonedDateTime(e,r=void 0){rt(this,nr);const u=cs(e),d=C0(tn(r));return Po(Lo(u,oe(this,dr),d),u,oe(this,Rt))}toPlainDate(){return rt(this,nr),ls(oe(this,dr).isoDate,oe(this,Rt))}toPlainTime(){return rt(this,nr),sd(oe(this,dr).time)}static from(e,r=void 0){return g0(e,r)}static compare(e,r){const u=g0(e),d=g0(r);return Fg(oe(u,dr),oe(d,dr))}}function Qo(n,e){rt(n,nr);const r=oe(n,dr).isoDate;return o_(n).isoToDate(r,{[e]:!0})[e]}function mg(n,e){return rt(n,nr),oe(n,dr).time[e]}Ad(kw,"Temporal.PlainDateTime");class Ug{constructor(e=0,r=0,u=0,d=0,m=0,y=0,l=0,E=0,C=0,k=0){const N=e===void 0?0:Uc(e),F=r===void 0?0:Uc(r),B=u===void 0?0:Uc(u),W=d===void 0?0:Uc(d),re=m===void 0?0:Uc(m),ie=y===void 0?0:Uc(y),de=l===void 0?0:Uc(l),Ee=E===void 0?0:Uc(E),we=C===void 0?0:Uc(C),ke=k===void 0?0:Uc(k);Rb(N,F,B,W,re,ie,de,Ee,we,ke),Md(this),Bn(this,Jo,N),Bn(this,es,F),Bn(this,Ps,B),Bn(this,ts,W),Bn(this,ns,re),Bn(this,is,ie),Bn(this,rs,de),Bn(this,as,Ee),Bn(this,os,we),Bn(this,Os,ke)}get years(){return rt(this,Dr),oe(this,Jo)}get months(){return rt(this,Dr),oe(this,es)}get weeks(){return rt(this,Dr),oe(this,Ps)}get days(){return rt(this,Dr),oe(this,ts)}get hours(){return rt(this,Dr),oe(this,ns)}get minutes(){return rt(this,Dr),oe(this,is)}get seconds(){return rt(this,Dr),oe(this,rs)}get milliseconds(){return rt(this,Dr),oe(this,as)}get microseconds(){return rt(this,Dr),oe(this,os)}get nanoseconds(){return rt(this,Dr),oe(this,Os)}get sign(){return rt(this,Dr),Kv(this)}get blank(){return rt(this,Dr),Kv(this)===0}with(e){rt(this,Dr);const r=BA(e),{years:u=oe(this,Jo),months:d=oe(this,es),weeks:m=oe(this,Ps),days:y=oe(this,ts),hours:l=oe(this,ns),minutes:E=oe(this,is),seconds:C=oe(this,rs),milliseconds:k=oe(this,as),microseconds:N=oe(this,os),nanoseconds:F=oe(this,Os)}=r;return new Ug(u,d,m,y,l,E,C,k,N,F)}negated(){return rt(this,Dr),Us(this)}abs(){return rt(this,Dr),new Ug(Math.abs(oe(this,Jo)),Math.abs(oe(this,es)),Math.abs(oe(this,Ps)),Math.abs(oe(this,ts)),Math.abs(oe(this,ns)),Math.abs(oe(this,is)),Math.abs(oe(this,rs)),Math.abs(oe(this,as)),Math.abs(oe(this,os)),Math.abs(oe(this,Os)))}add(e){return rt(this,Dr),hS("add",this,e)}subtract(e){return rt(this,Dr),hS("subtract",this,e)}round(e){if(rt(this,Dr),e===void 0)throw new TypeError("options parameter is required");const r=id(this),u=typeof e=="string"?Zp("smallestUnit",e):tn(e);let d=Ns(u,"largestUnit","datetime",void 0,["auto"]),{plainRelativeTo:m,zonedRelativeTo:y}=Ix(u);const l=Kg(u),E=Yc(u,"halfExpand");let C=Ns(u,"smallestUnit","datetime",void 0),k=!0;C||(k=!1,C="nanosecond");const N=pd(r,C);let F=!0;if(d||(F=!1,d=N),d==="auto"&&(d=N),!k&&!F)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(pd(d,C)!==d)throw new RangeError(`largestUnit ${d} cannot be smaller than smallestUnit ${C}`);const B={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[C];if(B!==void 0&&Jg(l,B,!1),l>1&&rd(C)==="date"&&d!==C)throw new RangeError("For calendar units with roundingIncrement > 1, use largestUnit = smallestUnit");if(y){let re=_g(this);const ie=oe(y,Si),de=oe(y,Rt),Ee=oe(y,wn);return re=lC(Ee,b0(Ee,ie,de,re),ie,de,d,l,C,E),rd(d)==="date"&&(d="hour"),$l(re,d)}if(m){let re=Hu(this);const ie=jg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},re.time),de=oe(m,Tn),Ee=oe(m,Rt),we=gl(Ee,de,Oo(re.date,ie.deltaDays),"constrain");return re=sC(hi(de,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),hi(we,ie),Ee,d,l,C,E),$l(re,d)}if(Vu(r))throw new RangeError(`a starting point is required for ${r}s balancing`);if(Vu(d))throw new RangeError(`a starting point is required for ${d}s balancing`);let W=Hu(this);if(C==="day"){const{quotient:re,remainder:ie}=W.time.divmod(Yv);let de=W.date.days+re+D0(ie,"day");de=Mf(de,l,E),W=md({years:0,months:0,weeks:0,days:de},Hn.ZERO)}else W=md({years:0,months:0,weeks:0,days:0},Jv(W.time,l,C,E));return $l(W,d)}total(e){if(rt(this,Dr),e===void 0)throw new TypeError("options argument is required");const r=typeof e=="string"?Zp("unit",e):tn(e);let{plainRelativeTo:u,zonedRelativeTo:d}=Ix(r);const m=Ns(r,"unit","datetime",wd);if(d){const l=_g(this),E=oe(d,Si),C=oe(d,Rt),k=oe(d,wn);return function(N,F,B,W,re){return rd(re)==="time"?D0(Hn.fromEpochNsDiff(F,N),re):rS(aC(N,F,B,W,re),F,Xl(B,N),B,W,re)}(k,b0(k,E,C,l),E,C,m)}if(u){const l=Hu(this);let E=jg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},l.time);const C=oe(u,Tn),k=oe(u,Rt),N=gl(k,C,Oo(l.date,E.deltaDays),"constrain");return function(F,B,W,re){if(Fg(F,B)==0)return 0;Gp(F),Gp(B);const ie=rC(F,B,W,re);return re==="nanosecond"?J.toNumber(ie.time.totalNs):rS(ie,uo(B),F,null,W,re)}(hi(C,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),hi(N,E),k,m)}const y=id(this);if(Vu(y))throw new RangeError(`a starting point is required for ${y}s total`);if(Vu(m))throw new RangeError(`a starting point is required for ${m}s total`);return D0(Hu(this).time,m)}toString(e=void 0){rt(this,Dr);const r=tn(e),u=r_(r),d=Yc(r,"trunc"),m=Ns(r,"smallestUnit","time",void 0);if(m==="hour"||m==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:y,unit:l,increment:E}=a_(m,u);if(l==="nanosecond"&&E===1)return _v(this,y);const C=id(this);let k=_g(this);const N=Jv(k.time,E,l,d);return k=md(k.date,N),_v($l(k,pd(C,"second")),y)}toJSON(){return rt(this,Dr),_v(this,"auto")}toLocaleString(e=void 0,r=void 0){if(rt(this,Dr),typeof Intl.DurationFormat=="function"){const u=new Intl.DurationFormat(e,r);return bC.call(u,this)}return console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),_v(this,"auto")}valueOf(){Ff("Duration")}static from(e){return Yl(e)}static compare(e,r,u=void 0){const d=Yl(e),m=Yl(r),y=tn(u),{plainRelativeTo:l,zonedRelativeTo:E}=Ix(y);if(oe(d,Jo)===oe(m,Jo)&&oe(d,es)===oe(m,es)&&oe(d,Ps)===oe(m,Ps)&&oe(d,ts)===oe(m,ts)&&oe(d,ns)===oe(m,ns)&&oe(d,is)===oe(m,is)&&oe(d,rs)===oe(m,rs)&&oe(d,as)===oe(m,as)&&oe(d,os)===oe(m,os)&&oe(d,Os)===oe(m,Os))return 0;const C=id(d),k=id(m),N=_g(d),F=_g(m);if(E&&(rd(C)==="date"||rd(k)==="date")){const de=oe(E,Si),Ee=oe(E,Rt),we=oe(E,wn),ke=b0(we,de,Ee,N),ge=b0(we,de,Ee,F);return Ls(J.toNumber(J.subtract(ke,ge)))}let B=N.date.days,W=F.date.days;if(Vu(C)||Vu(k)){if(!l)throw new RangeError("A starting point is required for years, months, or weeks comparison");B=iS(N.date,l),W=iS(F.date,l)}const re=N.time.add24HourDays(B),ie=F.time.add24HourDays(W);return re.cmp(ie)}}Ad(Ug,"Temporal.Duration");class Pw{constructor(e,r,u="iso8601",d=1972){const m=Cn(e),y=Cn(r),l=fs(u===void 0?"iso8601":Ma(u)),E=Cn(d);Vp(E,m,y),$A(this,{year:E,month:m,day:y},l)}get monthCode(){return vS(this,"monthCode")}get day(){return vS(this,"day")}get calendarId(){return rt(this,hl),oe(this,Rt)}with(e,r=void 0){if(rt(this,hl),!kr(e))throw new TypeError("invalid argument");Qg(e);const u=oe(this,Rt);let d=us(u,oe(this,Tn),"month-day");return d=Up(u,d,vl(u,e,["year","month","monthCode","day"],[],"partial")),bg(Xv(u,d,li(tn(r))),u)}equals(e){rt(this,hl);const r=qT(e);return th(oe(this,Tn),oe(r,Tn))===0&&Ju(oe(this,Rt),oe(r,Rt))}toString(e=void 0){return rt(this,hl),JT(this,i_(tn(e)))}toJSON(){return rt(this,hl),JT(this)}toLocaleString(e=void 0,r=void 0){return rt(this,hl),new Zl(e,r).format(this)}valueOf(){Ff("PlainMonthDay")}toPlainDate(e){if(rt(this,hl),!kr(e))throw new TypeError("argument should be an object");const r=oe(this,Rt);return ls(Of(r,Up(r,us(r,oe(this,Tn),"month-day"),vl(r,e,["year"],[],[])),"constrain"),r)}static from(e,r=void 0){return qT(e,r)}}function vS(n,e){rt(n,hl);const r=oe(n,Tn);return o_(n).isoToDate(r,{[e]:!0})[e]}function kx(n){return Xl(n,S1())}Ad(Pw,"Temporal.PlainMonthDay");const xC={instant:()=>Yu(S1()),plainDateTimeISO:(n=o0())=>Gl(kx(cs(n)),"iso8601"),plainDateISO:(n=o0())=>ls(kx(cs(n)).isoDate,"iso8601"),plainTimeISO:(n=o0())=>sd(kx(cs(n)).time),timeZoneId:()=>o0(),zonedDateTimeISO:(n=o0())=>{const e=cs(n);return Po(S1(),e,"iso8601")},[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(xC,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});class m_{constructor(e=0,r=0,u=0,d=0,m=0,y=0){const l=e===void 0?0:Cn(e),E=r===void 0?0:Cn(r),C=u===void 0?0:Cn(u),k=d===void 0?0:Cn(d),N=m===void 0?0:Cn(m),F=y===void 0?0:Cn(y);Ib(l,E,C,k,N,F),ZA(this,{hour:l,minute:E,second:C,millisecond:k,microsecond:N,nanosecond:F})}get hour(){return rt(this,Ur),oe(this,Rr).hour}get minute(){return rt(this,Ur),oe(this,Rr).minute}get second(){return rt(this,Ur),oe(this,Rr).second}get millisecond(){return rt(this,Ur),oe(this,Rr).millisecond}get microsecond(){return rt(this,Ur),oe(this,Rr).microsecond}get nanosecond(){return rt(this,Ur),oe(this,Rr).nanosecond}with(e,r=void 0){if(rt(this,Ur),!kr(e))throw new TypeError("invalid argument");Qg(e);const u=p1(e,"partial"),d=p1(this);let{hour:m,minute:y,second:l,millisecond:E,microsecond:C,nanosecond:k}=Object.assign(d,u);const N=li(tn(r));return{hour:m,minute:y,second:l,millisecond:E,microsecond:C,nanosecond:k}=Ab(m,y,l,E,C,k,N),new m_(m,y,l,E,C,k)}add(e){return rt(this,Ur),mS("add",this,e)}subtract(e){return rt(this,Ur),mS("subtract",this,e)}until(e,r=void 0){return rt(this,Ur),lS("until",this,e,r)}since(e,r=void 0){return rt(this,Ur),lS("since",this,e,r)}round(e){if(rt(this,Ur),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?Zp("smallestUnit",e):tn(e),u=Kg(r),d=Yc(r,"halfExpand"),m=Ns(r,"smallestUnit","time",wd);return Jg(u,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[m],!1),sd(w1(oe(this,Rr),u,m,d))}equals(e){rt(this,Ur);const r=Ef(e);return T1(oe(this,Rr),oe(r,Rr))===0}toString(e=void 0){rt(this,Ur);const r=tn(e),u=r_(r),d=Yc(r,"trunc"),m=Ns(r,"smallestUnit","time",void 0);if(m==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:y,unit:l,increment:E}=a_(m,u);return KT(w1(oe(this,Rr),E,l,d),y)}toJSON(){return rt(this,Ur),KT(oe(this,Rr),"auto")}toLocaleString(e=void 0,r=void 0){return rt(this,Ur),new Zl(e,r).format(this)}valueOf(){Ff("PlainTime")}static from(e,r=void 0){return Ef(e,r)}static compare(e,r){const u=Ef(e),d=Ef(r);return T1(oe(u,Rr),oe(d,Rr))}}Ad(m_,"Temporal.PlainTime");class Ow{constructor(e,r,u="iso8601",d=1){const m=Cn(e),y=Cn(r),l=fs(u===void 0?"iso8601":Ma(u)),E=Cn(d);Vp(m,y,E),YA(this,{year:m,month:y,day:E},l)}get year(){return ed(this,"year")}get month(){return ed(this,"month")}get monthCode(){return ed(this,"monthCode")}get calendarId(){return rt(this,lo),oe(this,Rt)}get era(){return ed(this,"era")}get eraYear(){return ed(this,"eraYear")}get daysInMonth(){return ed(this,"daysInMonth")}get daysInYear(){return ed(this,"daysInYear")}get monthsInYear(){return ed(this,"monthsInYear")}get inLeapYear(){return ed(this,"inLeapYear")}with(e,r=void 0){if(rt(this,lo),!kr(e))throw new TypeError("invalid argument");Qg(e);const u=oe(this,Rt);let d=us(u,oe(this,Tn),"year-month");return d=Up(u,d,vl(u,e,["year","month","monthCode"],[],"partial")),Sg(B0(u,d,li(tn(r))),u)}add(e,r=void 0){return rt(this,lo),gS("add",this,e,r)}subtract(e,r=void 0){return rt(this,lo),gS("subtract",this,e,r)}until(e,r=void 0){return rt(this,lo),cS("until",this,e,r)}since(e,r=void 0){return rt(this,lo),cS("since",this,e,r)}equals(e){rt(this,lo);const r=_0(e);return th(oe(this,Tn),oe(r,Tn))===0&&Ju(oe(this,Rt),oe(r,Rt))}toString(e=void 0){return rt(this,lo),eS(this,i_(tn(e)))}toJSON(){return rt(this,lo),eS(this)}toLocaleString(e=void 0,r=void 0){return rt(this,lo),new Zl(e,r).format(this)}valueOf(){Ff("PlainYearMonth")}toPlainDate(e){if(rt(this,lo),!kr(e))throw new TypeError("argument should be an object");const r=oe(this,Rt);return ls(Of(r,Up(r,us(r,oe(this,Tn),"year-month"),vl(r,e,["day"],[],[])),"constrain"),r)}static from(e,r=void 0){return _0(e,r)}static compare(e,r){const u=_0(e),d=_0(r);return th(oe(u,Tn),oe(d,Tn))}}function ed(n,e){rt(n,lo);const r=oe(n,Tn);return o_(n).isoToDate(r,{[e]:!0})[e]}Ad(Ow,"Temporal.PlainYearMonth");const P4=Zl.prototype.resolvedOptions;class Lw{constructor(e,r,u="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const d=eb(e);let m=Ma(r);const{tzName:y,offsetMinutes:l}=Df(m);if(l===void 0){const E=Wv(y);if(!E)throw new RangeError(`unknown time zone ${y}`);m=E.identifier}else m=bw(l);qA(this,d,m,fs(u===void 0?"iso8601":Ma(u)))}get calendarId(){return rt(this,Yn),oe(this,Rt)}get timeZoneId(){return rt(this,Yn),oe(this,Si)}get year(){return Ko(this,"year")}get month(){return Ko(this,"month")}get monthCode(){return Ko(this,"monthCode")}get day(){return Ko(this,"day")}get hour(){return gg(this,"hour")}get minute(){return gg(this,"minute")}get second(){return gg(this,"second")}get millisecond(){return gg(this,"millisecond")}get microsecond(){return gg(this,"microsecond")}get nanosecond(){return gg(this,"nanosecond")}get era(){return Ko(this,"era")}get eraYear(){return Ko(this,"eraYear")}get epochMilliseconds(){return rt(this,Yn),Wl(oe(this,wn),"floor")}get epochNanoseconds(){return rt(this,Yn),cC(oe(this,wn))}get dayOfWeek(){return Ko(this,"dayOfWeek")}get dayOfYear(){return Ko(this,"dayOfYear")}get weekOfYear(){return Ko(this,"weekOfYear")?.week}get yearOfWeek(){return Ko(this,"weekOfYear")?.year}get hoursInDay(){rt(this,Yn);const e=oe(this,Si),r=Fu(this).isoDate,u=Bs(r.year,r.month,r.day+1),d=Tf(e,r),m=Tf(e,u);return D0(Hn.fromEpochNsDiff(m,d),"hour")}get daysInWeek(){return Ko(this,"daysInWeek")}get daysInMonth(){return Ko(this,"daysInMonth")}get daysInYear(){return Ko(this,"daysInYear")}get monthsInYear(){return Ko(this,"monthsInYear")}get inLeapYear(){return Ko(this,"inLeapYear")}get offset(){return rt(this,Yn),m1(ld(oe(this,Si),oe(this,wn)))}get offsetNanoseconds(){return rt(this,Yn),ld(oe(this,Si),oe(this,wn))}with(e,r=void 0){if(rt(this,Yn),!kr(e))throw new TypeError("invalid zoned-date-time-like");Qg(e);const u=oe(this,Rt),d=oe(this,Si),m=ld(d,oe(this,wn)),y=Fu(this);let l={...us(u,y.isoDate),...y.time,offset:m1(m)};l=Up(u,l,vl(u,e,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset"],"partial"));const E=tn(r),C=C0(E),k=Cv(E,"prefer"),N=s_(u,l,li(E)),F=ey(l.offset);return Po(qv(N.isoDate,N.time,"option",F,d,C,k,!1),d,u)}withPlainTime(e=void 0){rt(this,Yn);const r=oe(this,Si),u=oe(this,Rt),d=Fu(this).isoDate;let m;return m=e===void 0?Tf(r,d):Lo(r,hi(d,oe(Ef(e),Rr)),"compatible"),Po(m,r,u)}withTimeZone(e){rt(this,Yn);const r=cs(e);return Po(oe(this,wn),r,oe(this,Rt))}withCalendar(e){rt(this,Yn);const r=c_(e);return Po(oe(this,wn),oe(this,Si),r)}add(e,r=void 0){return rt(this,Yn),yS("add",this,e,r)}subtract(e,r=void 0){return rt(this,Yn),yS("subtract",this,e,r)}until(e,r=void 0){return rt(this,Yn),uS("until",this,e,r)}since(e,r=void 0){return rt(this,Yn),uS("since",this,e,r)}round(e){if(rt(this,Yn),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?Zp("smallestUnit",e):tn(e),u=Kg(r),d=Yc(r,"halfExpand"),m=Ns(r,"smallestUnit","time",wd,["day"]),y={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[m];if(Jg(u,y,y===1),m==="nanosecond"&&u===1)return Po(oe(this,wn),oe(this,Si),oe(this,Rt));const l=oe(this,Si),E=oe(this,wn),C=Fu(this);let k;if(m==="day"){const N=C.isoDate,F=Bs(N.year,N.month,N.day+1),B=Tf(l,N),W=Tf(l,F),re=J.subtract(W,B);k=Hn.fromEpochNsDiff(E,B).round(re,d).addToEpochNs(B)}else{const N=x1(C,u,m,d),F=ld(l,E);k=qv(N.isoDate,N.time,"option",F,l,"compatible","prefer",!1)}return Po(k,l,oe(this,Rt))}equals(e){rt(this,Yn);const r=v0(e),u=oe(this,wn),d=oe(r,wn);return!!J.equal(J.BigInt(u),J.BigInt(d))&&!!XA(oe(this,Si),oe(r,Si))&&Ju(oe(this,Rt),oe(r,Rt))}toString(e=void 0){rt(this,Yn);const r=tn(e),u=i_(r),d=r_(r),m=function(F){return gd(F,"offset",["auto","never"],"auto")}(r),y=Yc(r,"trunc"),l=Ns(r,"smallestUnit","time",void 0);if(l==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const E=function(F){return gd(F,"timeZoneName",["auto","never","critical"],"auto")}(r),{precision:C,unit:k,increment:N}=a_(l,d);return tS(this,C,u,E,m,{unit:k,increment:N,roundingMode:y})}toLocaleString(e=void 0,r=void 0){rt(this,Yn);const u=tn(r),d=Object.create(null);if(function(E,C,k,N){if(C==null)return;const F=Reflect.ownKeys(C);for(let B=0;B<F.length;B++){const W=F[B];if(!k.some(re=>Object.is(re,W))&&Object.prototype.propertyIsEnumerable.call(C,W)){const re=C[W];E[W]=re}}}(d,u,["timeZone"]),u.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");if(d.year===void 0&&d.month===void 0&&d.day===void 0&&d.era===void 0&&d.weekday===void 0&&d.dateStyle===void 0&&d.hour===void 0&&d.minute===void 0&&d.second===void 0&&d.fractionalSecondDigits===void 0&&d.timeStyle===void 0&&d.dayPeriod===void 0&&d.timeZoneName===void 0&&(d.timeZoneName="short"),d.timeZone=oe(this,Si),nS(d.timeZone))throw new RangeError("toLocaleString does not currently support offset time zones");const m=new Zl(e,d),y=P4.call(m).calendar,l=oe(this,Rt);if(l!=="iso8601"&&y!=="iso8601"&&!Ju(y,l))throw new RangeError(`cannot format ZonedDateTime with calendar ${l} in locale with calendar ${y}`);return m.format(Yu(oe(this,wn)))}toJSON(){return rt(this,Yn),tS(this,"auto")}valueOf(){Ff("ZonedDateTime")}startOfDay(){rt(this,Yn);const e=oe(this,Si);return Po(Tf(e,Fu(this).isoDate),e,oe(this,Rt))}getTimeZoneTransition(e){rt(this,Yn);const r=oe(this,Si);if(e===void 0)throw new TypeError("options parameter is required");const u=gd(typeof e=="string"?Zp("direction",e):tn(e),"direction",["next","previous"],wd);if(u===void 0)throw new TypeError("direction option is required");if(nS(r)||r==="UTC")return null;const d=oe(this,wn),m=u==="next"?ww(r,d):y1(r,d);return m===null?null:Po(m,r,oe(this,Rt))}toInstant(){return rt(this,Yn),Yu(oe(this,wn))}toPlainDate(){return rt(this,Yn),ls(Fu(this).isoDate,oe(this,Rt))}toPlainTime(){return rt(this,Yn),sd(Fu(this).time)}toPlainDateTime(){return rt(this,Yn),Gl(Fu(this),oe(this,Rt))}static from(e,r=void 0){return v0(e,r)}static compare(e,r){const u=v0(e),d=v0(r),m=oe(u,wn),y=oe(d,wn);return J.lessThan(J.BigInt(m),J.BigInt(y))?-1:J.greaterThan(J.BigInt(m),J.BigInt(y))?1:0}}function Fu(n){return Xl(oe(n,Si),oe(n,wn))}function Ko(n,e){rt(n,Yn);const r=Fu(n).isoDate;return o_(n).isoToDate(r,{[e]:!0})[e]}function gg(n,e){return rt(n,Yn),Fu(n).time[e]}Ad(Lw,"Temporal.ZonedDateTime");var bS=Object.freeze({__proto__:null,Duration:Ug,Instant:Iw,Now:xC,PlainDate:Rw,PlainDateTime:kw,PlainMonthDay:Pw,PlainTime:m_,PlainYearMonth:Ow,ZonedDateTime:Lw});const O4=[Iw,Rw,kw,Ug,Pw,m_,Ow,Lw];for(const n of O4){const e=Object.getOwnPropertyDescriptor(n,"prototype");(e.configurable||e.enumerable||e.writable)&&(e.configurable=!1,e.enumerable=!1,e.writable=!1,Object.defineProperty(n,"prototype",e))}function L4({tripQueryVariables:n,setTripQueryVariables:e}){const r=K.useContext(Xg),u=bS.Instant.from(n.dateTime).toZonedDateTimeISO(r).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),d=K.useCallback(m=>{const y=bS.PlainDateTime.from(m.target.value).toZonedDateTime(r).toString({calendarName:"never",timeZoneName:"never"});e({...n,dateTime:y})},[n,e,r]);return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+r,children:"Time"}),H.jsx(Ri.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:d,value:u})]})}function N4({tripQueryVariables:n,setTripQueryVariables:e}){return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),H.jsx(Ri.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:n.searchWindow||"",onChange:r=>e({...n,searchWindow:Number(r.target.value)>0?Number(r.target.value):void 0})})]})}function z4({tripQueryVariables:n,setTripQueryVariables:e}){return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),H.jsxs(Ri.Select,{id:"accessSelect",size:"sm",className:"input-medium",onChange:r=>{r.target.value!=="not_selected"?e({...n,modes:{...n.modes,accessMode:r.target.value}}):e({...n,modes:n.modes?.directMode||n.modes?.transportModes?{...n.modes,accessMode:void 0}:void 0})},value:n.modes?.accessMode||"not_selected",children:[H.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Ag).map(r=>H.jsx("option",{value:r,children:r},r))]})]})}function j4({tripQueryVariables:n,setTripQueryVariables:e}){return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),H.jsxs(Ri.Select,{id:"egressSelect",size:"sm",className:"input-medium",onChange:r=>{r.target.value!=="not_selected"?e({...n,modes:{...n.modes,egressMode:r.target.value}}):e({...n,modes:n.modes?.directMode||n.modes?.transportModes?{...n.modes,egressMode:void 0}:void 0})},value:n.modes?.egressMode||"not_selected",children:[H.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Ag).map(r=>H.jsx("option",{value:r,children:r},r))]})]})}function F4({tripQueryVariables:n,setTripQueryVariables:e}){return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),H.jsxs(Ri.Select,{id:"directModeSelect",size:"sm",className:"input-medium",onChange:r=>{r.target.value!=="not_selected"?e({...n,modes:{...n.modes,directMode:r.target.value}}):e({...n,modes:n.modes?.accessMode||n.modes?.egressMode||n.modes?.transportModes?{...n.modes,directMode:void 0}:void 0})},value:n.modes?.directMode||"not_selected",children:[H.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Ag).map(r=>H.jsx("option",{value:r,children:r},r))]})]})}const B4=({label:n,options:e,values:r,onChange:u})=>{const[d,m]=K.useState(!1),y=K.useRef(null),l=()=>{m(!d)},E=C=>{const k=C.target.value,N=C.target.checked;u(N?[...r,k]:r.filter(F=>F!==k))};return K.useEffect(()=>{const C=k=>{y.current&&!y.current.contains(k.target)&&m(!1)};return d&&document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[d]),H.jsxs("div",{className:`dropdown ${d?"show":""}`,ref:y,children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:n}),H.jsx(Ri.Control,{type:"text",id:"multiSelectDropdown",size:"sm",className:"input-medium",value:r.length>0?r.join(", "):"Not selected",onClick:l,onChange:()=>{}}),H.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${d?"show":""}`,children:e.map(C=>H.jsx(Ri.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${C.id}`,label:C.label,checked:r.includes(C.id),onChange:E,value:`${C.id}`},`${C.id}`))})]})};function U4({tripQueryVariables:n,setTripQueryVariables:e}){const r=K.useMemo(()=>n?.modes?.transportModes?.map(d=>d?.transportMode).filter(d=>!!d)||[],[n.modes?.transportModes]),u=K.useCallback(d=>{const m=d.filter(y=>y!=null).map(y=>({transportMode:y}));if(m.length===0){const y={...n.modes};delete y.transportModes;const l=y.directMode||y.accessMode||y.egressMode;e({...n,modes:l?y:void 0})}else{const y=n.modes?.accessMode||Ag.Foot,l=n.modes?.egressMode||Ag.Foot;e({...n,modes:{...n.modes,transportModes:m,accessMode:y,egressMode:l}})}},[n,e]);return H.jsx(B4,{label:"Transit mode",options:Object.values(mE).map(d=>({id:d,label:d.toString()})),values:r,onChange:u})}function V4({tripQueryVariables:n,setTripQueryVariables:e}){return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),H.jsx(Ri.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:n.numTripPatterns||"",onChange:r=>e({...n,numTripPatterns:Number(r.target.value)>0?Number(r.target.value):void 0})})]})}function G4({tripQueryVariables:n,setTripQueryVariables:e}){return H.jsxs(Ri.Group,{children:[H.jsx(Ri.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),H.jsxs(Ri.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-medium",onChange:r=>{if(r.target.value==="not_selected"){const u={...n.itineraryFilters};delete u.debug;const d=Object.keys(u).length>0;e({...n,itineraryFilters:d?u:void 0})}else e({...n,itineraryFilters:{...n.itineraryFilters,debug:r.target.value}})},value:n.itineraryFilters?.debug||"not_selected",children:[H.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(pE).map(r=>H.jsx("option",{value:r,children:r},r))]})]})}const $4="https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-13T09:56/assets/graphql-solid-B1mrnAEK.svg",xS="/graphiql?flavor=transmodel";function Z4({tripQueryVariables:n}){const e=gA(n),r=encodeURIComponent(JSON.stringify(e)),u=mA(n),d=encodeURIComponent(u),m="Open in GraphiQL",y=xS.includes("?")?"&":"?",l=`${xS}${y}query=${d}&variables=${r}`;return H.jsx(Cf,{title:m,href:l,target:"_blank",children:H.jsx("img",{alt:m,title:m,src:$4,width:"20",height:"20",className:"d-inline-block align-middle"})})}function Y4({tripQueryVariables:n,setTripQueryVariables:e,onRoute:r,loading:u}){return H.jsxs("div",{className:"box input-group search-bar",children:[H.jsxs("div",{className:"input-family",children:[H.jsx(FT,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(A5,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(FT,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:n,setTripQueryVariables:e})]}),H.jsxs("div",{className:"input-family",children:[H.jsx(C5,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(L4,{tripQueryVariables:n,setTripQueryVariables:e})]}),H.jsxs("div",{className:"input-family",children:[H.jsx(V4,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(N4,{tripQueryVariables:n,setTripQueryVariables:e})]}),H.jsxs("div",{className:"input-family",children:[H.jsx(z4,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(U4,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(j4,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx(F4,{tripQueryVariables:n,setTripQueryVariables:e})]}),H.jsx(G4,{tripQueryVariables:n,setTripQueryVariables:e}),H.jsx("div",{className:"search-bar-route-button-wrapper",children:H.jsxs(U1,{children:[H.jsxs(Cf,{variant:"primary",onClick:()=>r(),disabled:u,children:[u&&H.jsxs(H.Fragment,{children:[H.jsx(MM,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),H.jsx(Z4,{tripQueryVariables:n})]})})]})}const wC=K.createContext(void 0);function H4(){const n=K.useContext(wC);if(!n)throw new Error("useTripSchema must be used within a TripSchemaProvider");return n}function Rs(n,e){return e.split(".").reduce((r,u)=>{if(r!=null){if(Array.isArray(r)){const d=Number(u);return Number.isNaN(d)?void 0:r[d]}else if(typeof r=="object")return r[u]}},n)}function Dp(n,e,r){const u=e.split(".");function d(m,y){const l=u[y],E=!isNaN(Number(l));if(y===u.length-1){if(Array.isArray(m)&&E){const F=[...m];return F[Number(l)]=r,F}if(Px(m)&&!E)return{...m,[l]:r};if(E){const F=Array.isArray(m)?[...m]:[];return F[Number(l)]=r,F}else return{...Px(m)?m:{},[l]:r}}const C=y+1,k=u[C],N=!isNaN(Number(k));if(Array.isArray(m)&&E){const F=[...m],B=m[Number(l)];return F[Number(l)]=d(B!==void 0?B:N?[]:{},C),F}else if(Px(m)&&!E){const F={...m},B=m[l];return F[l]=d(B!==void 0?B:N?[]:{},C),F}else if(E){const F=[];return F[Number(l)]=d(N?[]:{},C),F}else return{[l]:d(N?[]:{},C)}}return n==null&&(n=!isNaN(Number(u[0]))?[]:{}),d(n,0)}function Px(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const q4="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",X4="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",W4="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",Q4=({defaultValue:n,type:e})=>H.jsxs("span",{children:[n!=null&&H.jsx("span",{title:`Default: ${n??"None"}`,children:H.jsx("img",{alt:"Info",src:q4,className:"default-tooltip-icon"})}),e!=null&&e.subtype==="DoubleFunction"&&H.jsx("span",{title:`Type: ${e.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:H.jsx("img",{alt:"Info",src:X4,className:"default-tooltip-icon"})}),e!=null&&e.subtype==="Duration"&&H.jsx("span",{className:"default-tooltip-icon",title:`Type: ${e.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:H.jsx("img",{alt:"Info",src:W4,className:"default-tooltip-icon"})})]}),TC=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),SC=({tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:r})=>{function u(){let d={};TC.forEach(m=>{const y=Rs(n,m);y!==void 0&&(d=Dp(d,m,y))}),e(d),r&&r({})}return H.jsx("button",{className:"reset-button",onClick:u,children:"Reset"})};function Ox(n){if(!n)return" ";const e=n.split(".");return e[e.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,u=>u.toUpperCase())+" "}function Dv(n,e=[]){let r=[];return n?(Object.entries(n).forEach(([u,d])=>{const m=[...e,u].join(".");r=r.concat(K4(u,d,m,e))}),r):[]}function K4(n,e,r,u){let d=[];if(typeof e=="object"&&e.type)if(e.type.type==="Enum"){const m=["Not selected",...e.type.values||[]],y=e.defaultValue!==void 0?e.defaultValue:"Not selected";d.push({path:r,type:{type:"Enum"},defaultValue:y,enumValues:m,isList:e.isList})}else e.type.type==="InputObject"&&e.isList?(d.push({path:r,type:{type:"Group",name:e.type.name},defaultValue:e.defaultValue,isComplex:!0,isList:!0}),d=d.concat(Dv(e.type.fields,[...u,`${n}.*`]))):e.type.type==="InputObject"?(d.push({path:r,type:{type:"Group",name:e.type.name},isComplex:!0,isList:!1}),d=d.concat(Dv(e.type.fields,[...u,n]))):e.type.type==="Scalar"&&d.push({path:r,type:{type:e.type.type,subtype:e.type.subtype},defaultValue:e.defaultValue,isList:e.isList});else typeof e=="object"&&e.type?.fields?(d.push({path:r,type:{type:"Group"},isComplex:!0}),d=d.concat(Dv(e.type.fields,[...u,n]))):d.push({path:r,type:e.type??typeof e,defaultValue:e.defaultValue});return d}const J4=({tripQueryVariables:n,setTripQueryVariables:e,expandedArguments:r,setExpandedArguments:u})=>{const[d]=K.useState(""),{tripArgs:m,loading:y,error:l}=H4(),E=m&&!y&&!l?Dv(m.trip.arguments):[];function C(Ae){return Ae.replace(/\.\d+/g,".*")}function k(Ae,Ge){const at=C(Ae),Me=E.find(St=>St.path===at);if(!Me){console.error(`No matching argumentConfig found for path: ${Ae}`);return}if(Me.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Me.type.subtype)&&Me.isList&&typeof Ge=="string"){const St=Ge.split(",").map(zt=>zt.trim());let bt=Dp(n,Ae,St);bt=B(bt,Ae),e(bt);return}let Qe=Dp(n,Ae,Ge);Qe=B(Qe,Ae),e(Qe)}function N(Ae){return typeof Ae=="object"&&Ae!==null&&!Array.isArray(Ae)}function F(Ae){return Ae==null?!0:Array.isArray(Ae)?Ae.length===0:N(Ae)?Object.values(Ae).every(F):!1}function B(Ae,Ge){if(!Ge.includes(".")){const Me=Rs(Ae,Ge);if(F(Me)){const Qe={...Ae};return delete Qe[Ge],Qe}return Ae}const at=Ge.split(".");for(let Me=at.length-1;Me>0;Me--){const Qe=at.slice(0,Me).join("."),St=Rs(Ae,Qe);F(St)&&(Ae=Dp(Ae,Qe,void 0))}return Ae}function W(Ae){u({...r,[Ae]:!r[Ae]})}function re(){u({})}const ie=E.filter(({path:Ae})=>Ox(Ae).toLowerCase().includes(d.toLowerCase())).filter(({path:Ae})=>!TC.has(Ae));function de(Ae,Ge,at,Me){const Qe=Rs(n,Ae)??[],St=Me.name;return H.jsxs("div",{children:[Qe.map((bt,zt)=>{const Zt=`${Ae}.${zt}`,Ft=Ge.filter(_t=>_t.path.startsWith(`${Ae}.*.`)&&_t.path!==`${Ae}.*`).map(_t=>({..._t,path:_t.path.replace(`${Ae}.*`,Zt)})),Be=Ft.filter(_t=>_t.path.split(".").length===Zt.split(".").length+1),lt=r[Zt];return H.jsxs("div",{style:{marginLeft:15},children:[H.jsxs("span",{style:{cursor:"pointer"},onClick:()=>W(Zt),children:[lt?"▼ ":"▶ "," [#",zt+1,"]"]}),H.jsx("button",{style:{marginLeft:10},onClick:()=>we(Ae,zt),children:"Remove"}),lt&&H.jsx("div",{style:{marginLeft:20},children:ge(Be,at+1,Ft)})]},Zt)}),H.jsxs("button",{onClick:()=>Ee(Ae),children:["+ Add ",St]})]})}function Ee(Ae){const at=[...Rs(n,Ae)??[],{}],Me=Dp(n,Ae,at);e(Me)}function we(Ae,Ge){const Me=(Rs(n,Ae)??[]).filter((St,bt)=>bt!==Ge);let Qe=Dp(n,Ae,Me);Qe=B(Qe,Ae),e(Qe)}function ke(Ae){let Ge=Dp(n,Ae,void 0);Ge=B(Ge,Ae),e(Ge)}function ge(Ae,Ge,at){return Ae.map(({path:Me,type:Qe,defaultValue:St,enumValues:bt,isComplex:zt,isList:Zt})=>{const Ft=r[Me],Be=Me.split(".").length,lt=at.filter(ut=>{const Te=ut.path.split(".").length;return ut.path.startsWith(`${Me}.`)&&ut.path!==Me&&Te===Be+1}),_t=Ge+1;return H.jsx("div",{style:{marginLeft:`${Ge*15}px`,marginBottom:"10px"},children:zt?H.jsxs("div",{children:[H.jsxs("span",{style:{cursor:"pointer"},onClick:()=>W(Me),children:[Ft?"▼ ":"▶ "," ",Ox(Me)]}),Ft&&Zt?H.jsx("div",{style:{marginLeft:20},children:de(Me,at,_t,Qe)}):Ft?ge(lt,_t,at):null]}):H.jsxs("div",{children:[H.jsxs("label",{className:"argument-label",htmlFor:Me,children:[Ox(Me)," ",H.jsx(Q4,{defaultValue:St,type:Qe})]}),Qe.subtype==="Boolean"&&(()=>{const ut=Rs(n,Me),Te=ut!==void 0;return H.jsxs("span",{children:[H.jsx("input",{type:"checkbox",id:Me,checked:ut??!1,onChange:nt=>k(Me,nt.target.checked)}),Te&&H.jsx("button",{onClick:()=>ke(Me),className:"remove-argument",style:{fontSize:"10px",paddingTop:"2px",marginLeft:"8px",marginBottom:"0px",marginTop:"-5px",height:"14px",width:"45px",verticalAlign:"middle"},children:"Clear"})]})})(),Qe.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Qe.subtype)&&Zt&&H.jsx("input",{className:"comma-separated-input",type:"text",id:Me,value:(()=>{const ut=Rs(n,Me);return Array.isArray(ut)?ut.join(", "):""})(),onChange:ut=>k(Me,ut.target.value),placeholder:"Comma-separated list"}),Qe.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Qe.subtype)&&!Zt&&H.jsx("input",{type:"text",id:Me,value:Rs(n,Me)??"",onChange:ut=>k(Me,ut.target.value||void 0)}),Qe.subtype==="Int"&&H.jsx("input",{type:"number",id:Me,value:Rs(n,Me)??"",onChange:ut=>{const Te=parseInt(ut.target.value,10);k(Me,Number.isNaN(Te)?void 0:Te)}}),Qe.subtype==="Float"&&H.jsx("input",{type:"number",id:Me,step:"any",value:Rs(n,Me)??"",onChange:ut=>{const Te=parseFloat(ut.target.value);k(Me,Number.isNaN(Te)?void 0:Te)}}),Qe.subtype==="DateTime"&&H.jsx("input",{type:"datetime-local",id:Me,value:(Rs(n,Me)??"").slice(0,16),onChange:ut=>{const Te=ut.target.value?new Date(ut.target.value).toISOString():void 0;k(Me,Te)}}),Qe.type==="Enum"&&bt&&Zt&&H.jsx("select",{id:Me,multiple:!0,value:(()=>{const ut=Rs(n,Me);return Array.isArray(ut)?ut:[]})(),onChange:ut=>{const Te=Array.from(ut.target.selectedOptions,nt=>nt.value);k(Me,Te)},children:bt.map(ut=>H.jsx("option",{value:ut,children:ut},ut))}),Qe.type==="Enum"&&bt&&!Zt&&H.jsx("select",{id:Me,value:Rs(n,Me)??"Not selected",onChange:ut=>{const Te=ut.target.value==="Not selected"?void 0:ut.target.value;k(Me,Te)},children:bt.map(ut=>H.jsx("option",{value:ut,children:ut},ut))})]})},Me)})}return H.jsxs("div",{className:"left-pane-container below-content",children:[H.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",position:"relative"},children:[H.jsx("button",{className:"collapse-all-button",onClick:re,style:{padding:"4px 8px"},children:"Collapse all"}),H.jsx("span",{className:"panel-header-title-with-left-button",children:"Arguments"}),H.jsx("div",{style:{marginLeft:"auto"},children:H.jsx(SC,{tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:u})})]}),ie.length===0?H.jsx("p",{children:"No arguments found."}):H.jsx("div",{className:"argument-list",children:ge(ie.filter(Ae=>Ae.path.split(".").length===1),0,ie)})]})},e6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",t6="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",n6="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",i6=({children:n})=>{const[e,r]=K.useState(0),u=m=>{switch(m){case 0:return H.jsx("img",{src:e6,alt:"Itinerary results",title:"Itinerary results"});case 1:return H.jsx("img",{src:t6,alt:"Arguments",title:"Arguments"});case 2:return H.jsx("img",{width:"25",height:"25",src:n6,alt:"Arguments raw",title:"Arguments raw"});default:return null}},d=fl.Children.toArray(n).filter(m=>fl.isValidElement(m));return H.jsxs("div",{className:"sidebar-container",children:[H.jsx("div",{className:"sidebar",children:d.map((m,y)=>H.jsx("div",{className:`sidebar-button ${y===e?"active":""}`,onClick:()=>r(y),children:u(y)},y))}),H.jsx("div",{className:"sidebar-content",children:d.map((m,y)=>y===e?H.jsx("div",{children:m},y):null)})]})},r6=({tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:r})=>H.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[H.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",position:"relative"},children:[H.jsx("span",{className:"panel-header-title-simple",children:"Arguments raw"}),H.jsx("div",{style:{marginLeft:"auto"},children:H.jsx(SC,{tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:r})})]}),H.jsx("pre",{children:JSON.stringify(n,null,2)})]});function a6(n){let e=n;for(;;)if(ud(e))e=e.ofType;else if(Lf(e))e=e.ofType;else break;return e}function EC(n){const e=a6(n);if($g(e))return{type:"Scalar",subtype:e.name};if(If(e))return{type:"Enum",values:e.getValues().map(r=>r.name)};if(cd(e)){const r=e.getFields(),u={};for(const d of Object.keys(r)){const m=r[d];if(m.deprecationReason)continue;const y=Lf(m.type),l=m.defaultValue!==void 0?m.defaultValue:null;u[d]={type:EC(m.type),defaultValue:l,isList:y}}return{type:"InputObject",name:e.name,fields:u}}return{type:"Scalar",subtype:"String"}}function o6(n){const e=n.getQueryType();if(!e)throw new Error("No Query type found in the schema.");const r=e.getFields().trip;if(!r)throw new Error("No trip query found in the schema.");const u={};return r.args.forEach(d=>{if(d.deprecationReason)return;const m=d.name,y=EC(d.type),l=d.defaultValue!==null?d.defaultValue:null,E=Lf(d.type);u[m]={type:y,...l!==null&&{defaultValue:l},isList:E}}),{trip:{arguments:u}}}async function s6(n){const e=OI(),r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})});if(!r.ok)throw new Error(`Failed to fetch schema. HTTP error: ${r.status}`);const{data:u}=await r.json(),d=LI(u);return o6(d)}function l6({endpoint:n,children:e}){const[r,u]=K.useState(null),[d,m]=K.useState(!0),[y,l]=K.useState(null);K.useEffect(()=>{let C=!0;async function k(){m(!0),l(null);try{const N=await s6(n);C&&u(N)}catch(N){console.error("Error loading trip arguments:",N),C&&l("Failed to load trip schema")}finally{C&&m(!1)}}return k(),()=>{C=!1}},[n]);const E={tripArgs:r,loading:d,error:y};return H.jsx(wC.Provider,{value:E,children:e})}function c6(){const n=m5(),{tripQueryVariables:e,setTripQueryVariables:r}=v5(),[u,d]=K.useState([]),[m,y]=K.useState(!1),[l,E,C]=f5(e),[k,N]=K.useState([0]),[F,B]=K.useState({}),W=n?.internalTransitModelTimeZone||Intl.DateTimeFormat().resolvedOptions().timeZone;return K.useEffect(()=>{l?.trip.tripPatterns.length&&N([0])},[l]),H.jsx("div",{className:"app",children:H.jsxs(Xg.Provider,{value:W,children:[H.jsxs("div",{className:"layout",children:[H.jsx("div",{className:"box logo-section",children:H.jsx(w5,{serverInfo:n})}),H.jsx("div",{className:"box input-section",children:H.jsx(Y4,{onRoute:C,tripQueryVariables:e,setTripQueryVariables:r,loading:E})}),H.jsx("div",{className:"box trip-section",children:H.jsxs(i6,{children:[H.jsx(gO,{tripQueryResult:l,selectedTripPatternIndexes:k,setSelectedTripPatternIndexes:N,pageResults:C,loading:E,comparisonSelectedIndexes:u,setComparisonSelectedIndexes:d,onCompare:()=>y(!0)}),H.jsx(l6,{endpoint:cb(),children:H.jsx(J4,{tripQueryVariables:e,setTripQueryVariables:r,expandedArguments:F,setExpandedArguments:B})}),H.jsx(r6,{tripQueryVariables:e,setTripQueryVariables:r,setExpandedArguments:B})]})}),H.jsx("div",{className:"box map-section",children:H.jsx(v3,{tripQueryResult:l,tripQueryVariables:e,setTripQueryVariables:r,selectedTripPatternIndexes:k,loading:E})})]}),H.jsx(c5,{show:m,onHide:()=>y(!1),tripQueryResult:l,selectedIndexes:u})]})})}jC.createRoot(document.getElementById("root")).render(H.jsx(fl.StrictMode,{children:H.jsx(c6,{})}));
