function kS(n,e){for(var r=0;r<e.length;r++){const h=e[r];if(typeof h!="string"&&!Array.isArray(h)){for(const d in h)if(d!=="default"&&!(d in n)){const m=Object.getOwnPropertyDescriptor(h,d);m&&Object.defineProperty(n,d,m.get?m:{enumerable:!0,get:()=>h[d]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))h(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const y of m.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&h(y)}).observe(document,{childList:!0,subtree:!0});function r(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function h(d){if(d.ep)return;d.ep=!0;const m=r(d);fetch(d.href,m)}})();function fm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var sx={exports:{}},u_={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hw;function zC(){if(Hw)return u_;Hw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(h,d,m){var y=null;if(m!==void 0&&(y=""+m),d.key!==void 0&&(y=""+d.key),"key"in d){m={};for(var c in d)c!=="key"&&(m[c]=d[c])}else m=d;return d=m.ref,{$$typeof:n,type:h,key:y,ref:d!==void 0?d:null,props:m}}return u_.Fragment=e,u_.jsx=r,u_.jsxs=r,u_}var qw;function NC(){return qw||(qw=1,sx.exports=zC()),sx.exports}var X=NC(),lx={exports:{}},On={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xw;function jC(){if(Xw)return On;Xw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),C=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),F=Symbol.iterator;function B(De){return De===null||typeof De!="object"?null:(De=F&&De[F]||De["@@iterator"],typeof De=="function"?De:null)}var Q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ie=Object.assign,ne={};function ue(De,Qe,dt){this.props=De,this.context=Qe,this.refs=ne,this.updater=dt||Q}ue.prototype.isReactComponent={},ue.prototype.setState=function(De,Qe){if(typeof De!="object"&&typeof De!="function"&&De!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,De,Qe,"setState")},ue.prototype.forceUpdate=function(De){this.updater.enqueueForceUpdate(this,De,"forceUpdate")};function Ae(){}Ae.prototype=ue.prototype;function Te(De,Qe,dt){this.props=De,this.context=Qe,this.refs=ne,this.updater=dt||Q}var ke=Te.prototype=new Ae;ke.constructor=Te,ie(ke,ue.prototype),ke.isPureReactComponent=!0;var be=Array.isArray;function Me(){}var Fe={H:null,A:null,T:null,S:null},ot=Object.prototype.hasOwnProperty;function Ee(De,Qe,dt){var _t=dt.ref;return{$$typeof:n,type:De,key:Qe,ref:_t!==void 0?_t:null,props:dt}}function Je(De,Qe){return Ee(De.type,Qe,De.props)}function Et(De){return typeof De=="object"&&De!==null&&De.$$typeof===n}function Tt(De){var Qe={"=":"=0",":":"=2"};return"$"+De.replace(/[=:]/g,function(dt){return Qe[dt]})}var zt=/\/+/g;function Zt(De,Qe){return typeof De=="object"&&De!==null&&De.key!=null?Tt(""+De.key):Qe.toString(36)}function Gt(De){switch(De.status){case"fulfilled":return De.value;case"rejected":throw De.reason;default:switch(typeof De.status=="string"?De.then(Me,Me):(De.status="pending",De.then(function(Qe){De.status==="pending"&&(De.status="fulfilled",De.value=Qe)},function(Qe){De.status==="pending"&&(De.status="rejected",De.reason=Qe)})),De.status){case"fulfilled":return De.value;case"rejected":throw De.reason}}throw De}function Ue(De,Qe,dt,_t,Ot){var jt=typeof De;(jt==="undefined"||jt==="boolean")&&(De=null);var Kt=!1;if(De===null)Kt=!0;else switch(jt){case"bigint":case"string":case"number":Kt=!0;break;case"object":switch(De.$$typeof){case n:case e:Kt=!0;break;case k:return Kt=De._init,Ue(Kt(De._payload),Qe,dt,_t,Ot)}}if(Kt)return Ot=Ot(De),Kt=_t===""?"."+Zt(De,0):_t,be(Ot)?(dt="",Kt!=null&&(dt=Kt.replace(zt,"$&/")+"/"),Ue(Ot,Qe,dt,"",function(lr){return lr})):Ot!=null&&(Et(Ot)&&(Ot=Je(Ot,dt+(Ot.key==null||De&&De.key===Ot.key?"":(""+Ot.key).replace(zt,"$&/")+"/")+Kt)),Qe.push(Ot)),1;Kt=0;var cn=_t===""?".":_t+":";if(be(De))for(var mn=0;mn<De.length;mn++)_t=De[mn],jt=cn+Zt(_t,mn),Kt+=Ue(_t,Qe,dt,jt,Ot);else if(mn=B(De),typeof mn=="function")for(De=mn.call(De),mn=0;!(_t=De.next()).done;)_t=_t.value,jt=cn+Zt(_t,mn++),Kt+=Ue(_t,Qe,dt,jt,Ot);else if(jt==="object"){if(typeof De.then=="function")return Ue(Gt(De),Qe,dt,_t,Ot);throw Qe=String(De),Error("Objects are not valid as a React child (found: "+(Qe==="[object Object]"?"object with keys {"+Object.keys(De).join(", ")+"}":Qe)+"). If you meant to render a collection of children, use an array instead.")}return Kt}function st(De,Qe,dt){if(De==null)return De;var _t=[],Ot=0;return Ue(De,_t,"","",function(jt){return Qe.call(dt,jt,Ot++)}),_t}function xt(De){if(De._status===-1){var Qe=De._result;Qe=Qe(),Qe.then(function(dt){(De._status===0||De._status===-1)&&(De._status=1,De._result=dt)},function(dt){(De._status===0||De._status===-1)&&(De._status=2,De._result=dt)}),De._status===-1&&(De._status=0,De._result=Qe)}if(De._status===1)return De._result.default;throw De._result}var ut=typeof reportError=="function"?reportError:function(De){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Qe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof De=="object"&&De!==null&&typeof De.message=="string"?String(De.message):String(De),error:De});if(!window.dispatchEvent(Qe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",De);return}console.error(De)},Ut={map:st,forEach:function(De,Qe,dt){st(De,function(){Qe.apply(this,arguments)},dt)},count:function(De){var Qe=0;return st(De,function(){Qe++}),Qe},toArray:function(De){return st(De,function(Qe){return Qe})||[]},only:function(De){if(!Et(De))throw Error("React.Children.only expected to receive a single React element child.");return De}};return On.Activity=z,On.Children=Ut,On.Component=ue,On.Fragment=r,On.Profiler=d,On.PureComponent=Te,On.StrictMode=h,On.Suspense=E,On.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Fe,On.__COMPILER_RUNTIME={__proto__:null,c:function(De){return Fe.H.useMemoCache(De)}},On.cache=function(De){return function(){return De.apply(null,arguments)}},On.cacheSignal=function(){return null},On.cloneElement=function(De,Qe,dt){if(De==null)throw Error("The argument must be a React element, but you passed "+De+".");var _t=ie({},De.props),Ot=De.key;if(Qe!=null)for(jt in Qe.key!==void 0&&(Ot=""+Qe.key),Qe)!ot.call(Qe,jt)||jt==="key"||jt==="__self"||jt==="__source"||jt==="ref"&&Qe.ref===void 0||(_t[jt]=Qe[jt]);var jt=arguments.length-2;if(jt===1)_t.children=dt;else if(1<jt){for(var Kt=Array(jt),cn=0;cn<jt;cn++)Kt[cn]=arguments[cn+2];_t.children=Kt}return Ee(De.type,Ot,_t)},On.createContext=function(De){return De={$$typeof:y,_currentValue:De,_currentValue2:De,_threadCount:0,Provider:null,Consumer:null},De.Provider=De,De.Consumer={$$typeof:m,_context:De},De},On.createElement=function(De,Qe,dt){var _t,Ot={},jt=null;if(Qe!=null)for(_t in Qe.key!==void 0&&(jt=""+Qe.key),Qe)ot.call(Qe,_t)&&_t!=="key"&&_t!=="__self"&&_t!=="__source"&&(Ot[_t]=Qe[_t]);var Kt=arguments.length-2;if(Kt===1)Ot.children=dt;else if(1<Kt){for(var cn=Array(Kt),mn=0;mn<Kt;mn++)cn[mn]=arguments[mn+2];Ot.children=cn}if(De&&De.defaultProps)for(_t in Kt=De.defaultProps,Kt)Ot[_t]===void 0&&(Ot[_t]=Kt[_t]);return Ee(De,jt,Ot)},On.createRef=function(){return{current:null}},On.forwardRef=function(De){return{$$typeof:c,render:De}},On.isValidElement=Et,On.lazy=function(De){return{$$typeof:k,_payload:{_status:-1,_result:De},_init:xt}},On.memo=function(De,Qe){return{$$typeof:C,type:De,compare:Qe===void 0?null:Qe}},On.startTransition=function(De){var Qe=Fe.T,dt={};Fe.T=dt;try{var _t=De(),Ot=Fe.S;Ot!==null&&Ot(dt,_t),typeof _t=="object"&&_t!==null&&typeof _t.then=="function"&&_t.then(Me,ut)}catch(jt){ut(jt)}finally{Qe!==null&&dt.types!==null&&(Qe.types=dt.types),Fe.T=Qe}},On.unstable_useCacheRefresh=function(){return Fe.H.useCacheRefresh()},On.use=function(De){return Fe.H.use(De)},On.useActionState=function(De,Qe,dt){return Fe.H.useActionState(De,Qe,dt)},On.useCallback=function(De,Qe){return Fe.H.useCallback(De,Qe)},On.useContext=function(De){return Fe.H.useContext(De)},On.useDebugValue=function(){},On.useDeferredValue=function(De,Qe){return Fe.H.useDeferredValue(De,Qe)},On.useEffect=function(De,Qe){return Fe.H.useEffect(De,Qe)},On.useEffectEvent=function(De){return Fe.H.useEffectEvent(De)},On.useId=function(){return Fe.H.useId()},On.useImperativeHandle=function(De,Qe,dt){return Fe.H.useImperativeHandle(De,Qe,dt)},On.useInsertionEffect=function(De,Qe){return Fe.H.useInsertionEffect(De,Qe)},On.useLayoutEffect=function(De,Qe){return Fe.H.useLayoutEffect(De,Qe)},On.useMemo=function(De,Qe){return Fe.H.useMemo(De,Qe)},On.useOptimistic=function(De,Qe){return Fe.H.useOptimistic(De,Qe)},On.useReducer=function(De,Qe,dt){return Fe.H.useReducer(De,Qe,dt)},On.useRef=function(De){return Fe.H.useRef(De)},On.useState=function(De){return Fe.H.useState(De)},On.useSyncExternalStore=function(De,Qe,dt){return Fe.H.useSyncExternalStore(De,Qe,dt)},On.useTransition=function(){return Fe.H.useTransition()},On.version="19.2.0",On}var Ww;function z1(){return Ww||(Ww=1,lx.exports=jC()),lx.exports}var K=z1();const El=fm(K),Qw=kS({__proto__:null,default:El},[K]);var cx={exports:{}},h_={},ux={exports:{}},hx={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kw;function FC(){return Kw||(Kw=1,function(n){function e(Ue,st){var xt=Ue.length;Ue.push(st);e:for(;0<xt;){var ut=xt-1>>>1,Ut=Ue[ut];if(0<d(Ut,st))Ue[ut]=st,Ue[xt]=Ut,xt=ut;else break e}}function r(Ue){return Ue.length===0?null:Ue[0]}function h(Ue){if(Ue.length===0)return null;var st=Ue[0],xt=Ue.pop();if(xt!==st){Ue[0]=xt;e:for(var ut=0,Ut=Ue.length,De=Ut>>>1;ut<De;){var Qe=2*(ut+1)-1,dt=Ue[Qe],_t=Qe+1,Ot=Ue[_t];if(0>d(dt,xt))_t<Ut&&0>d(Ot,dt)?(Ue[ut]=Ot,Ue[_t]=xt,ut=_t):(Ue[ut]=dt,Ue[Qe]=xt,ut=Qe);else if(_t<Ut&&0>d(Ot,xt))Ue[ut]=Ot,Ue[_t]=xt,ut=_t;else break e}}return st}function d(Ue,st){var xt=Ue.sortIndex-st.sortIndex;return xt!==0?xt:Ue.id-st.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;n.unstable_now=function(){return m.now()}}else{var y=Date,c=y.now();n.unstable_now=function(){return y.now()-c}}var E=[],C=[],k=1,z=null,F=3,B=!1,Q=!1,ie=!1,ne=!1,ue=typeof setTimeout=="function"?setTimeout:null,Ae=typeof clearTimeout=="function"?clearTimeout:null,Te=typeof setImmediate<"u"?setImmediate:null;function ke(Ue){for(var st=r(C);st!==null;){if(st.callback===null)h(C);else if(st.startTime<=Ue)h(C),st.sortIndex=st.expirationTime,e(E,st);else break;st=r(C)}}function be(Ue){if(ie=!1,ke(Ue),!Q)if(r(E)!==null)Q=!0,Me||(Me=!0,Tt());else{var st=r(C);st!==null&&Gt(be,st.startTime-Ue)}}var Me=!1,Fe=-1,ot=5,Ee=-1;function Je(){return ne?!0:!(n.unstable_now()-Ee<ot)}function Et(){if(ne=!1,Me){var Ue=n.unstable_now();Ee=Ue;var st=!0;try{e:{Q=!1,ie&&(ie=!1,Ae(Fe),Fe=-1),B=!0;var xt=F;try{t:{for(ke(Ue),z=r(E);z!==null&&!(z.expirationTime>Ue&&Je());){var ut=z.callback;if(typeof ut=="function"){z.callback=null,F=z.priorityLevel;var Ut=ut(z.expirationTime<=Ue);if(Ue=n.unstable_now(),typeof Ut=="function"){z.callback=Ut,ke(Ue),st=!0;break t}z===r(E)&&h(E),ke(Ue)}else h(E);z=r(E)}if(z!==null)st=!0;else{var De=r(C);De!==null&&Gt(be,De.startTime-Ue),st=!1}}break e}finally{z=null,F=xt,B=!1}st=void 0}}finally{st?Tt():Me=!1}}}var Tt;if(typeof Te=="function")Tt=function(){Te(Et)};else if(typeof MessageChannel<"u"){var zt=new MessageChannel,Zt=zt.port2;zt.port1.onmessage=Et,Tt=function(){Zt.postMessage(null)}}else Tt=function(){ue(Et,0)};function Gt(Ue,st){Fe=ue(function(){Ue(n.unstable_now())},st)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Ue){Ue.callback=null},n.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ot=0<Ue?Math.floor(1e3/Ue):5},n.unstable_getCurrentPriorityLevel=function(){return F},n.unstable_next=function(Ue){switch(F){case 1:case 2:case 3:var st=3;break;default:st=F}var xt=F;F=st;try{return Ue()}finally{F=xt}},n.unstable_requestPaint=function(){ne=!0},n.unstable_runWithPriority=function(Ue,st){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var xt=F;F=Ue;try{return st()}finally{F=xt}},n.unstable_scheduleCallback=function(Ue,st,xt){var ut=n.unstable_now();switch(typeof xt=="object"&&xt!==null?(xt=xt.delay,xt=typeof xt=="number"&&0<xt?ut+xt:ut):xt=ut,Ue){case 1:var Ut=-1;break;case 2:Ut=250;break;case 5:Ut=1073741823;break;case 4:Ut=1e4;break;default:Ut=5e3}return Ut=xt+Ut,Ue={id:k++,callback:st,priorityLevel:Ue,startTime:xt,expirationTime:Ut,sortIndex:-1},xt>ut?(Ue.sortIndex=xt,e(C,Ue),r(E)===null&&Ue===r(C)&&(ie?(Ae(Fe),Fe=-1):ie=!0,Gt(be,xt-ut))):(Ue.sortIndex=Ut,e(E,Ue),Q||B||(Q=!0,Me||(Me=!0,Tt()))),Ue},n.unstable_shouldYield=Je,n.unstable_wrapCallback=function(Ue){var st=F;return function(){var xt=F;F=st;try{return Ue.apply(this,arguments)}finally{F=xt}}}}(hx)),hx}var Jw;function BC(){return Jw||(Jw=1,ux.exports=FC()),ux.exports}var dx={exports:{}},Io={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e2;function UC(){if(e2)return Io;e2=1;var n=z1();function e(E){var C="https://react.dev/errors/"+E;if(1<arguments.length){C+="?args[]="+encodeURIComponent(arguments[1]);for(var k=2;k<arguments.length;k++)C+="&args[]="+encodeURIComponent(arguments[k])}return"Minified React error #"+E+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var h={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},d=Symbol.for("react.portal");function m(E,C,k){var z=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:z==null?null:""+z,children:E,containerInfo:C,implementation:k}}var y=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(E,C){if(E==="font")return"";if(typeof C=="string")return C==="use-credentials"?C:""}return Io.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=h,Io.createPortal=function(E,C){var k=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C||C.nodeType!==1&&C.nodeType!==9&&C.nodeType!==11)throw Error(e(299));return m(E,C,null,k)},Io.flushSync=function(E){var C=y.T,k=h.p;try{if(y.T=null,h.p=2,E)return E()}finally{y.T=C,h.p=k,h.d.f()}},Io.preconnect=function(E,C){typeof E=="string"&&(C?(C=C.crossOrigin,C=typeof C=="string"?C==="use-credentials"?C:"":void 0):C=null,h.d.C(E,C))},Io.prefetchDNS=function(E){typeof E=="string"&&h.d.D(E)},Io.preinit=function(E,C){if(typeof E=="string"&&C&&typeof C.as=="string"){var k=C.as,z=c(k,C.crossOrigin),F=typeof C.integrity=="string"?C.integrity:void 0,B=typeof C.fetchPriority=="string"?C.fetchPriority:void 0;k==="style"?h.d.S(E,typeof C.precedence=="string"?C.precedence:void 0,{crossOrigin:z,integrity:F,fetchPriority:B}):k==="script"&&h.d.X(E,{crossOrigin:z,integrity:F,fetchPriority:B,nonce:typeof C.nonce=="string"?C.nonce:void 0})}},Io.preinitModule=function(E,C){if(typeof E=="string")if(typeof C=="object"&&C!==null){if(C.as==null||C.as==="script"){var k=c(C.as,C.crossOrigin);h.d.M(E,{crossOrigin:k,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0})}}else C==null&&h.d.M(E)},Io.preload=function(E,C){if(typeof E=="string"&&typeof C=="object"&&C!==null&&typeof C.as=="string"){var k=C.as,z=c(k,C.crossOrigin);h.d.L(E,k,{crossOrigin:z,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0,type:typeof C.type=="string"?C.type:void 0,fetchPriority:typeof C.fetchPriority=="string"?C.fetchPriority:void 0,referrerPolicy:typeof C.referrerPolicy=="string"?C.referrerPolicy:void 0,imageSrcSet:typeof C.imageSrcSet=="string"?C.imageSrcSet:void 0,imageSizes:typeof C.imageSizes=="string"?C.imageSizes:void 0,media:typeof C.media=="string"?C.media:void 0})}},Io.preloadModule=function(E,C){if(typeof E=="string")if(C){var k=c(C.as,C.crossOrigin);h.d.m(E,{as:typeof C.as=="string"&&C.as!=="script"?C.as:void 0,crossOrigin:k,integrity:typeof C.integrity=="string"?C.integrity:void 0})}else h.d.m(E)},Io.requestFormReset=function(E){h.d.r(E)},Io.unstable_batchedUpdates=function(E,C){return E(C)},Io.useFormState=function(E,C,k){return y.H.useFormState(E,C,k)},Io.useFormStatus=function(){return y.H.useHostTransitionStatus()},Io.version="19.2.0",Io}var t2;function OS(){if(t2)return dx.exports;t2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dx.exports=UC(),dx.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n2;function VC(){if(n2)return h_;n2=1;var n=BC(),e=z1(),r=OS();function h(a){var u="https://react.dev/errors/"+a;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function m(a){var u=a,g=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,(u.flags&4098)!==0&&(g=u.return),a=u.return;while(a)}return u.tag===3?g:null}function y(a){if(a.tag===13){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function c(a){if(a.tag===31){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function E(a){if(m(a)!==a)throw Error(h(188))}function C(a){var u=a.alternate;if(!u){if(u=m(a),u===null)throw Error(h(188));return u!==a?null:a}for(var g=a,w=u;;){var I=g.return;if(I===null)break;var P=I.alternate;if(P===null){if(w=I.return,w!==null){g=w;continue}break}if(I.child===P.child){for(P=I.child;P;){if(P===g)return E(I),a;if(P===w)return E(I),u;P=P.sibling}throw Error(h(188))}if(g.return!==w.return)g=I,w=P;else{for(var Z=!1,se=I.child;se;){if(se===g){Z=!0,g=I,w=P;break}if(se===w){Z=!0,w=I,g=P;break}se=se.sibling}if(!Z){for(se=P.child;se;){if(se===g){Z=!0,g=P,w=I;break}if(se===w){Z=!0,w=P,g=I;break}se=se.sibling}if(!Z)throw Error(h(189))}}if(g.alternate!==w)throw Error(h(190))}if(g.tag!==3)throw Error(h(188));return g.stateNode.current===g?a:u}function k(a){var u=a.tag;if(u===5||u===26||u===27||u===6)return a;for(a=a.child;a!==null;){if(u=k(a),u!==null)return u;a=a.sibling}return null}var z=Object.assign,F=Symbol.for("react.element"),B=Symbol.for("react.transitional.element"),Q=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),ne=Symbol.for("react.strict_mode"),ue=Symbol.for("react.profiler"),Ae=Symbol.for("react.consumer"),Te=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),Me=Symbol.for("react.suspense_list"),Fe=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),Ee=Symbol.for("react.activity"),Je=Symbol.for("react.memo_cache_sentinel"),Et=Symbol.iterator;function Tt(a){return a===null||typeof a!="object"?null:(a=Et&&a[Et]||a["@@iterator"],typeof a=="function"?a:null)}var zt=Symbol.for("react.client.reference");function Zt(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===zt?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case ie:return"Fragment";case ue:return"Profiler";case ne:return"StrictMode";case be:return"Suspense";case Me:return"SuspenseList";case Ee:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case Q:return"Portal";case Te:return a.displayName||"Context";case Ae:return(a._context.displayName||"Context")+".Consumer";case ke:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Fe:return u=a.displayName||null,u!==null?u:Zt(a.type)||"Memo";case ot:u=a._payload,a=a._init;try{return Zt(a(u))}catch{}}return null}var Gt=Array.isArray,Ue=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xt={pending:!1,data:null,method:null,action:null},ut=[],Ut=-1;function De(a){return{current:a}}function Qe(a){0>Ut||(a.current=ut[Ut],ut[Ut]=null,Ut--)}function dt(a,u){Ut++,ut[Ut]=a.current,a.current=u}var _t=De(null),Ot=De(null),jt=De(null),Kt=De(null);function cn(a,u){switch(dt(jt,u),dt(Ot,a),dt(_t,null),u.nodeType){case 9:case 11:a=(a=u.documentElement)&&(a=a.namespaceURI)?e_(a):0;break;default:if(a=u.tagName,u=u.namespaceURI)u=e_(u),a=ru(u,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}Qe(_t),dt(_t,a)}function mn(){Qe(_t),Qe(Ot),Qe(jt)}function lr(a){a.memoizedState!==null&&dt(Kt,a);var u=_t.current,g=ru(u,a.type);u!==g&&(dt(Ot,a),dt(_t,g))}function cr(a){Ot.current===a&&(Qe(_t),Qe(Ot)),Kt.current===a&&(Qe(Kt),Ke._currentValue=xt)}var xi,Wn;function Ln(a){if(xi===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);xi=u&&u[1]||"",Wn=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xi+a+Wn}var Sn=!1;function gr(a,u){if(!a||Sn)return"";Sn=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(u){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(nt){var et=nt}Reflect.construct(a,[],mt)}else{try{mt.call()}catch(nt){et=nt}a.call(mt.prototype)}}else{try{throw Error()}catch(nt){et=nt}(mt=a())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(nt){if(nt&&et&&typeof nt.stack=="string")return[nt.stack,et.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=w.DetermineComponentFrameRoot(),Z=P[0],se=P[1];if(Z&&se){var Ie=Z.split(`
`),We=se.split(`
`);for(I=w=0;w<Ie.length&&!Ie[w].includes("DetermineComponentFrameRoot");)w++;for(;I<We.length&&!We[I].includes("DetermineComponentFrameRoot");)I++;if(w===Ie.length||I===We.length)for(w=Ie.length-1,I=We.length-1;1<=w&&0<=I&&Ie[w]!==We[I];)I--;for(;1<=w&&0<=I;w--,I--)if(Ie[w]!==We[I]){if(w!==1||I!==1)do if(w--,I--,0>I||Ie[w]!==We[I]){var lt=`
`+Ie[w].replace(" at new "," at ");return a.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",a.displayName)),lt}while(1<=w&&0<=I);break}}}finally{Sn=!1,Error.prepareStackTrace=g}return(g=a?a.displayName||a.name:"")?Ln(g):""}function oa(a,u){switch(a.tag){case 26:case 27:case 5:return Ln(a.type);case 16:return Ln("Lazy");case 13:return a.child!==u&&u!==null?Ln("Suspense Fallback"):Ln("Suspense");case 19:return Ln("SuspenseList");case 0:case 15:return gr(a.type,!1);case 11:return gr(a.type.render,!1);case 1:return gr(a.type,!0);case 31:return Ln("Activity");default:return""}}function po(a){try{var u="",g=null;do u+=oa(a,g),g=a,a=a.return;while(a);return u}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var Ar=Object.prototype.hasOwnProperty,Br=n.unstable_scheduleCallback,Ea=n.unstable_cancelCallback,Ua=n.unstable_shouldYield,ga=n.unstable_requestPaint,Oi=n.unstable_now,ys=n.unstable_getCurrentPriorityLevel,dn=n.unstable_ImmediatePriority,Mr=n.unstable_UserBlockingPriority,ur=n.unstable_NormalPriority,Pe=n.unstable_LowPriority,ee=n.unstable_IdlePriority,te=n.log,ce=n.unstable_setDisableYieldValue,xe=null,we=null;function Oe(a){if(typeof te=="function"&&ce(a),we&&typeof we.setStrictMode=="function")try{we.setStrictMode(xe,a)}catch{}}var Ge=Math.clz32?Math.clz32:yt,je=Math.log,tt=Math.LN2;function yt(a){return a>>>=0,a===0?32:31-(je(a)/tt|0)|0}var rt=256,Nt=262144,Ht=4194304;function Be(a){var u=a&42;if(u!==0)return u;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Cn(a,u,g){var w=a.pendingLanes;if(w===0)return 0;var I=0,P=a.suspendedLanes,Z=a.pingedLanes;a=a.warmLanes;var se=w&134217727;return se!==0?(w=se&~P,w!==0?I=Be(w):(Z&=se,Z!==0?I=Be(Z):g||(g=se&~a,g!==0&&(I=Be(g))))):(se=w&~P,se!==0?I=Be(se):Z!==0?I=Be(Z):g||(g=w&~a,g!==0&&(I=Be(g)))),I===0?0:u!==0&&u!==I&&(u&P)===0&&(P=I&-I,g=u&-u,P>=g||P===32&&(g&4194048)!==0)?u:I}function Un(a,u){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&u)===0}function Vt(a,u){switch(a){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jn(){var a=Ht;return Ht<<=1,(Ht&62914560)===0&&(Ht=4194304),a}function hr(a){for(var u=[],g=0;31>g;g++)u.push(a);return u}function Wi(a,u){a.pendingLanes|=u,u!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function yr(a,u,g,w,I,P){var Z=a.pendingLanes;a.pendingLanes=g,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=g,a.entangledLanes&=g,a.errorRecoveryDisabledLanes&=g,a.shellSuspendCounter=0;var se=a.entanglements,Ie=a.expirationTimes,We=a.hiddenUpdates;for(g=Z&~g;0<g;){var lt=31-Ge(g),mt=1<<lt;se[lt]=0,Ie[lt]=-1;var et=We[lt];if(et!==null)for(We[lt]=null,lt=0;lt<et.length;lt++){var nt=et[lt];nt!==null&&(nt.lane&=-536870913)}g&=~mt}w!==0&&Ur(a,w,0),P!==0&&I===0&&a.tag!==0&&(a.suspendedLanes|=P&~(Z&~u))}function Ur(a,u,g){a.pendingLanes|=u,a.suspendedLanes&=~u;var w=31-Ge(u);a.entangledLanes|=u,a.entanglements[w]=a.entanglements[w]|1073741824|g&261930}function pi(a,u){var g=a.entangledLanes|=u;for(a=a.entanglements;g;){var w=31-Ge(g),I=1<<w;I&u|a[w]&u&&(a[w]|=u),g&=~I}}function _r(a,u){var g=u&-u;return g=(g&42)!==0?1:Kn(g),(g&(a.suspendedLanes|u))!==0?0:g}function Kn(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function pt(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Lo(){var a=st.p;return a!==0?a:(a=window.event,a===void 0?32:ra(a.type))}function Aa(a,u){var g=st.p;try{return st.p=a,u()}finally{st.p=g}}var vr=Math.random().toString(36).slice(2),$n="__reactFiber$"+vr,vt="__reactProps$"+vr,gn="__reactContainer$"+vr,_n="__reactEvents$"+vr,Va="__reactListeners$"+vr,_s="__reactHandles$"+vr,zo="__reactResources$"+vr,un="__reactMarker$"+vr;function kl(a){delete a[$n],delete a[vt],delete a[_n],delete a[Va],delete a[_s]}function vs(a){var u=a[$n];if(u)return u;for(var g=a.parentNode;g;){if(u=g[gn]||g[$n]){if(g=u.alternate,u.child!==null||g!==null&&g.child!==null)for(a=fg(a);a!==null;){if(g=a[$n])return g;a=fg(a)}return u}a=g,g=a.parentNode}return null}function mo(a){if(a=a[$n]||a[gn]){var u=a.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return a}return null}function qs(a){var u=a.tag;if(u===5||u===26||u===27||u===6)return a.stateNode;throw Error(h(33))}function Ma(a){var u=a[zo];return u||(u=a[zo]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function $i(a){a[un]=!0}var Ji=new Set,Ca={};function ri(a,u){bs(a,u),bs(a+"Capture",u)}function bs(a,u){for(Ca[a]=u,a=0;a<u.length;a++)Ji.add(u[a])}var pu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nd={},Ol={};function Xs(a){return Ar.call(Ol,a)?!0:Ar.call(Nd,a)?!1:pu.test(a)?Ol[a]=!0:(Nd[a]=!0,!1)}function mh(a,u,g){if(Xs(u))if(g===null)a.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":a.removeAttribute(u);return;case"boolean":var w=u.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){a.removeAttribute(u);return}}a.setAttribute(u,""+g)}}function mu(a,u,g){if(g===null)a.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(u);return}a.setAttribute(u,""+g)}}function xs(a,u,g,w){if(w===null)a.removeAttribute(g);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(g);return}a.setAttributeNS(u,g,""+w)}}function Jr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Zf(a){var u=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function uy(a,u,g){var w=Object.getOwnPropertyDescriptor(a.constructor.prototype,u);if(!a.hasOwnProperty(u)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var I=w.get,P=w.set;return Object.defineProperty(a,u,{configurable:!0,get:function(){return I.call(this)},set:function(Z){g=""+Z,P.call(this,Z)}}),Object.defineProperty(a,u,{enumerable:w.enumerable}),{getValue:function(){return g},setValue:function(Z){g=""+Z},stopTracking:function(){a._valueTracker=null,delete a[u]}}}}function Yf(a){if(!a._valueTracker){var u=Zf(a)?"checked":"value";a._valueTracker=uy(a,u,""+a[u])}}function bm(a){if(!a)return!1;var u=a._valueTracker;if(!u)return!0;var g=u.getValue(),w="";return a&&(w=Zf(a)?a.checked?"true":"false":a.value),a=w,a!==g?(u.setValue(a),!0):!1}function gh(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Hf=/[\n"\\]/g;function Vr(a){return a.replace(Hf,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function yh(a,u,g,w,I,P,Z,se){a.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?a.type=Z:a.removeAttribute("type"),u!=null?Z==="number"?(u===0&&a.value===""||a.value!=u)&&(a.value=""+Jr(u)):a.value!==""+Jr(u)&&(a.value=""+Jr(u)):Z!=="submit"&&Z!=="reset"||a.removeAttribute("value"),u!=null?Ws(a,Z,Jr(u)):g!=null?Ws(a,Z,Jr(g)):w!=null&&a.removeAttribute("value"),I==null&&P!=null&&(a.defaultChecked=!!P),I!=null&&(a.checked=I&&typeof I!="function"&&typeof I!="symbol"),se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?a.name=""+Jr(se):a.removeAttribute("name")}function qf(a,u,g,w,I,P,Z,se){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(a.type=P),u!=null||g!=null){if(!(P!=="submit"&&P!=="reset"||u!=null)){Yf(a);return}g=g!=null?""+Jr(g):"",u=u!=null?""+Jr(u):g,se||u===a.value||(a.value=u),a.defaultValue=u}w=w??I,w=typeof w!="function"&&typeof w!="symbol"&&!!w,a.checked=se?a.checked:!!w,a.defaultChecked=!!w,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(a.name=Z),Yf(a)}function Ws(a,u,g){u==="number"&&gh(a.ownerDocument)===a||a.defaultValue===""+g||(a.defaultValue=""+g)}function Pl(a,u,g,w){if(a=a.options,u){u={};for(var I=0;I<g.length;I++)u["$"+g[I]]=!0;for(g=0;g<a.length;g++)I=u.hasOwnProperty("$"+a[g].value),a[g].selected!==I&&(a[g].selected=I),I&&w&&(a[g].defaultSelected=!0)}else{for(g=""+Jr(g),u=null,I=0;I<a.length;I++){if(a[I].value===g){a[I].selected=!0,w&&(a[I].defaultSelected=!0);return}u!==null||a[I].disabled||(u=a[I])}u!==null&&(u.selected=!0)}}function xm(a,u,g){if(u!=null&&(u=""+Jr(u),u!==a.value&&(a.value=u),g==null)){a.defaultValue!==u&&(a.defaultValue=u);return}a.defaultValue=g!=null?""+Jr(g):""}function gu(a,u,g,w){if(u==null){if(w!=null){if(g!=null)throw Error(h(92));if(Gt(w)){if(1<w.length)throw Error(h(93));w=w[0]}g=w}g==null&&(g=""),u=g}g=Jr(u),a.defaultValue=g,w=a.textContent,w===g&&w!==""&&w!==null&&(a.value=w),Yf(a)}function ws(a,u){if(u){var g=a.firstChild;if(g&&g===a.lastChild&&g.nodeType===3){g.nodeValue=u;return}}a.textContent=u}var Xf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sa(a,u,g){var w=u.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?w?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="":w?a.setProperty(u,g):typeof g!="number"||g===0||Xf.has(u)?u==="float"?a.cssFloat=g:a[u]=(""+g).trim():a[u]=g+"px"}function zn(a,u,g){if(u!=null&&typeof u!="object")throw Error(h(62));if(a=a.style,g!=null){for(var w in g)!g.hasOwnProperty(w)||u!=null&&u.hasOwnProperty(w)||(w.indexOf("--")===0?a.setProperty(w,""):w==="float"?a.cssFloat="":a[w]="");for(var I in u)w=u[I],u.hasOwnProperty(I)&&g[I]!==w&&sa(a,I,w)}else for(var P in u)u.hasOwnProperty(P)&&sa(a,P,u[P])}function Ll(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ya=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xn(a){return Sc.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ga(){}var Ec=null;function zl(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Cr=null,er=null;function Dr(a){var u=mo(a);if(u&&(a=u.stateNode)){var g=a[vt]||null;e:switch(a=u.stateNode,u.type){case"input":if(yh(a,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),u=g.name,g.type==="radio"&&u!=null){for(g=a;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Vr(""+u)+'"][type="radio"]'),u=0;u<g.length;u++){var w=g[u];if(w!==a&&w.form===a.form){var I=w[vt]||null;if(!I)throw Error(h(90));yh(w,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(u=0;u<g.length;u++)w=g[u],w.form===a.form&&bm(w)}break e;case"textarea":xm(a,g.value,g.defaultValue);break e;case"select":u=g.value,u!=null&&Pl(a,!!g.multiple,u,!1)}}}var Ir=!1;function wi(a,u,g){if(Ir)return a(u,g);Ir=!0;try{var w=a(u);return w}finally{if(Ir=!1,(Cr!==null||er!==null)&&(Xm(),Cr&&(u=Cr,a=er,er=Cr=null,Dr(u),a)))for(u=0;u<a.length;u++)Dr(a[u])}}function Ts(a,u){var g=a.stateNode;if(g===null)return null;var w=g[vt]||null;if(w===null)return null;g=w[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(a=a.type,w=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!w;break e;default:a=!1}if(a)return null;if(g&&typeof g!="function")throw Error(h(231,u,typeof g));return g}var Qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_a=!1;if(Qi)try{var Gr={};Object.defineProperty(Gr,"passive",{get:function(){_a=!0}}),window.addEventListener("test",Gr,Gr),window.removeEventListener("test",Gr,Gr)}catch{_a=!1}var go=null,ai=null,Pi=null;function Dn(){if(Pi)return Pi;var a,u=ai,g=u.length,w,I="value"in go?go.value:go.textContent,P=I.length;for(a=0;a<g&&u[a]===I[a];a++);var Z=g-a;for(w=1;w<=Z&&u[g-w]===I[P-w];w++);return Pi=I.slice(a,1<w?1-w:void 0)}function tn(a){var u=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&u===13&&(a=13)):a=u,a===10&&(a=13),32<=a||a===13?a:0}function Qs(){return!0}function vn(){return!1}function ea(a){function u(g,w,I,P,Z){this._reactName=g,this._targetInst=I,this.type=w,this.nativeEvent=P,this.target=Z,this.currentTarget=null;for(var se in a)a.hasOwnProperty(se)&&(g=a[se],this[se]=g?g(P):P[se]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Qs:vn,this.isPropagationStopped=vn,this}return z(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Qs)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Qs)},persist:function(){},isPersistent:Qs}),u}var tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yu=ea(tr),Ks=z({},tr,{view:0,detail:0}),_h=ea(Ks),Nl,Ac,Mc,Cc=z({},Ks,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vh,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Mc&&(Mc&&a.type==="mousemove"?(Nl=a.screenX-Mc.screenX,Ac=a.screenY-Mc.screenY):Ac=Nl=0,Mc=a),Nl)},movementY:function(a){return"movementY"in a?a.movementY:Ac}}),_u=ea(Cc),Ss=z({},Cc,{dataTransfer:0}),$r=ea(Ss),Dc=z({},Ks,{relatedTarget:0}),Ic=ea(Dc),jl=z({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),Zr=ea(jl),jd=z({},tr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Fd=ea(jd),wm=z({},tr,{data:0}),Tm=ea(wm),Rr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bd(a){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(a):(a=yo[a])?!!u[a]:!1}function vh(){return Bd}var bh=z({},Ks,{key:function(a){if(a.key){var u=Rr[a.key]||a.key;if(u!=="Unidentified")return u}return a.type==="keypress"?(a=tn(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?vu[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vh,charCode:function(a){return a.type==="keypress"?tn(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?tn(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Js=ea(bh),No=z({},Cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wf=ea(No),Ud=z({},Ks,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vh}),hy=ea(Ud),Qf=z({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),dy=ea(Qf),Vd=z({},Cc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Kf=ea(Vd),Gd=z({},tr,{newState:0,oldState:0}),bu=ea(Gd),Jf=[9,13,27,32],$a=Qi&&"CompositionEvent"in window,xu=null;Qi&&"documentMode"in document&&(xu=document.documentMode);var ep=Qi&&"TextEvent"in window&&!xu,Rc=Qi&&(!$a||xu&&8<xu&&11>=xu),wu=" ",Sm=!1;function xh(a,u){switch(a){case"keyup":return Jf.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Em(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var jo=!1;function Am(a,u){switch(a){case"compositionend":return Em(u);case"keypress":return u.which!==32?null:(Sm=!0,wu);case"textInput":return a=u.data,a===wu&&Sm?null:a;default:return null}}function tp(a,u){if(jo)return a==="compositionend"||!$a&&xh(a,u)?(a=Dn(),Pi=ai=go=null,jo=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Rc&&u.locale!=="ko"?null:u.data;default:return null}}var Mm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function np(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u==="input"?!!Mm[a.type]:u==="textarea"}function $d(a,u,g,w){Cr?er?er.push(w):er=[w]:Cr=w,u=Gp(u,"onChange"),0<u.length&&(g=new yu("onChange","change",null,g,w),a.push({event:g,listeners:u}))}var Tu=null,Su=null;function wh(a){ev(a,0)}function Th(a){var u=qs(a);if(bm(u))return a}function Fl(a,u){if(a==="change")return u}var ip=!1;if(Qi){var Zd;if(Qi){var el="oninput"in document;if(!el){var rp=document.createElement("div");rp.setAttribute("oninput","return;"),el=typeof rp.oninput=="function"}Zd=el}else Zd=!1;ip=Zd&&(!document.documentMode||9<document.documentMode)}function Sh(){Tu&&(Tu.detachEvent("onpropertychange",Cm),Su=Tu=null)}function Cm(a){if(a.propertyName==="value"&&Th(Su)){var u=[];$d(u,Su,a,zl(a)),wi(wh,u)}}function Dm(a,u,g){a==="focusin"?(Sh(),Tu=u,Su=g,Tu.attachEvent("onpropertychange",Cm)):a==="focusout"&&Sh()}function ap(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Th(Su)}function Im(a,u){if(a==="click")return Th(u)}function Rm(a,u){if(a==="input"||a==="change")return Th(u)}function op(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var va=typeof Object.is=="function"?Object.is:op;function Bl(a,u){if(va(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var g=Object.keys(a),w=Object.keys(u);if(g.length!==w.length)return!1;for(w=0;w<g.length;w++){var I=g[w];if(!Ar.call(u,I)||!va(a[I],u[I]))return!1}return!0}function Es(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Yd(a,u){var g=Es(a);a=0;for(var w;g;){if(g.nodeType===3){if(w=a+g.textContent.length,a<=u&&w>=u)return{node:g,offset:u-a};a=w}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Es(g)}}function Hd(a,u){return a&&u?a===u?!0:a&&a.nodeType===3?!1:u&&u.nodeType===3?Hd(a,u.parentNode):"contains"in a?a.contains(u):a.compareDocumentPosition?!!(a.compareDocumentPosition(u)&16):!1:!1}function Zn(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var u=gh(a.document);u instanceof a.HTMLIFrameElement;){try{var g=typeof u.contentWindow.location.href=="string"}catch{g=!1}if(g)a=u.contentWindow;else break;u=gh(a.document)}return u}function qd(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u&&(u==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||u==="textarea"||a.contentEditable==="true")}var sp=Qi&&"documentMode"in document&&11>=document.documentMode,_o=null,Eh=null,Ah=null,lp=!1;function km(a,u,g){var w=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;lp||_o==null||_o!==gh(w)||(w=_o,"selectionStart"in w&&qd(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Ah&&Bl(Ah,w)||(Ah=w,w=Gp(Eh,"onSelect"),0<w.length&&(u=new yu("onSelect","select",null,u,g),a.push({event:u,listeners:w}),u.target=_o)))}function kc(a,u){var g={};return g[a.toLowerCase()]=u.toLowerCase(),g["Webkit"+a]="webkit"+u,g["Moz"+a]="moz"+u,g}var Oc={animationend:kc("Animation","AnimationEnd"),animationiteration:kc("Animation","AnimationIteration"),animationstart:kc("Animation","AnimationStart"),transitionrun:kc("Transition","TransitionRun"),transitionstart:kc("Transition","TransitionStart"),transitioncancel:kc("Transition","TransitionCancel"),transitionend:kc("Transition","TransitionEnd")},cp={},up={};Qi&&(up=document.createElement("div").style,"AnimationEvent"in window||(delete Oc.animationend.animation,delete Oc.animationiteration.animation,delete Oc.animationstart.animation),"TransitionEvent"in window||delete Oc.transitionend.transition);function As(a){if(cp[a])return cp[a];if(!Oc[a])return a;var u=Oc[a],g;for(g in u)if(u.hasOwnProperty(g)&&g in up)return cp[a]=u[g];return a}var Mh=As("animationend"),Ch=As("animationiteration"),Xd=As("animationstart"),Pc=As("transitionrun"),Dh=As("transitionstart"),Eu=As("transitioncancel"),Za=As("transitionend"),hp=new Map,Wd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wd.push("scrollEnd");function Ya(a,u){hp.set(a,u),ri(u,[a])}var Ms=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},ba=[],tl=0,Lc=0;function zc(){for(var a=tl,u=Lc=tl=0;u<a;){var g=ba[u];ba[u++]=null;var w=ba[u];ba[u++]=null;var I=ba[u];ba[u++]=null;var P=ba[u];if(ba[u++]=null,w!==null&&I!==null){var Z=w.pending;Z===null?I.next=I:(I.next=Z.next,Z.next=I),w.pending=I}P!==0&&dp(g,I,P)}}function Ih(a,u,g,w){ba[tl++]=a,ba[tl++]=u,ba[tl++]=g,ba[tl++]=w,Lc|=w,a.lanes|=w,a=a.alternate,a!==null&&(a.lanes|=w)}function Ul(a,u,g,w){return Ih(a,u,g,w),Vl(a)}function vo(a,u){return Ih(a,null,null,u),Vl(a)}function dp(a,u,g){a.lanes|=g;var w=a.alternate;w!==null&&(w.lanes|=g);for(var I=!1,P=a.return;P!==null;)P.childLanes|=g,w=P.alternate,w!==null&&(w.childLanes|=g),P.tag===22&&(a=P.stateNode,a===null||a._visibility&1||(I=!0)),a=P,P=P.return;return a.tag===3?(P=a.stateNode,I&&u!==null&&(I=31-Ge(g),a=P.hiddenUpdates,w=a[I],w===null?a[I]=[u]:w.push(u),u.lane=g|536870912),P):null}function Vl(a){if(50<rr)throw rr=0,Lp=null,Error(h(185));for(var u=a.return;u!==null;)a=u,u=a.return;return a.tag===3?a.stateNode:null}var bn={};function Qd(a,u,g,w){this.tag=a,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ha(a,u,g,w){return new Qd(a,u,g,w)}function Rh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function qa(a,u){var g=a.alternate;return g===null?(g=Ha(a.tag,u,a.key,a.mode),g.elementType=a.elementType,g.type=a.type,g.stateNode=a.stateNode,g.alternate=a,a.alternate=g):(g.pendingProps=u,g.type=a.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=a.flags&65011712,g.childLanes=a.childLanes,g.lanes=a.lanes,g.child=a.child,g.memoizedProps=a.memoizedProps,g.memoizedState=a.memoizedState,g.updateQueue=a.updateQueue,u=a.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=a.sibling,g.index=a.index,g.ref=a.ref,g.refCleanup=a.refCleanup,g}function Om(a,u){a.flags&=65011714;var g=a.alternate;return g===null?(a.childLanes=0,a.lanes=u,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=g.childLanes,a.lanes=g.lanes,a.child=g.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=g.memoizedProps,a.memoizedState=g.memoizedState,a.updateQueue=g.updateQueue,a.type=g.type,u=g.dependencies,a.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),a}function Nc(a,u,g,w,I,P){var Z=0;if(w=a,typeof a=="function")Rh(a)&&(Z=1);else if(typeof a=="string")Z=H(a,g,_t.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case Ee:return a=Ha(31,g,u,I),a.elementType=Ee,a.lanes=P,a;case ie:return nl(g.children,I,P,u);case ne:Z=8,I|=24;break;case ue:return a=Ha(12,g,u,I|2),a.elementType=ue,a.lanes=P,a;case be:return a=Ha(13,g,u,I),a.elementType=be,a.lanes=P,a;case Me:return a=Ha(19,g,u,I),a.elementType=Me,a.lanes=P,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Te:Z=10;break e;case Ae:Z=9;break e;case ke:Z=11;break e;case Fe:Z=14;break e;case ot:Z=16,w=null;break e}Z=29,g=Error(h(130,a===null?"null":typeof a,"")),w=null}return u=Ha(Z,g,u,I),u.elementType=a,u.type=w,u.lanes=P,u}function nl(a,u,g,w){return a=Ha(7,a,w,u),a.lanes=g,a}function fp(a,u,g){return a=Ha(6,a,null,u),a.lanes=g,a}function Kd(a){var u=Ha(18,null,null,0);return u.stateNode=a,u}function Au(a,u,g){return u=Ha(4,a.children!==null?a.children:[],a.key,u),u.lanes=g,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}var kh=new WeakMap;function xa(a,u){if(typeof a=="object"&&a!==null){var g=kh.get(a);return g!==void 0?g:(u={value:a,source:u,stack:po(u)},kh.set(a,u),u)}return{value:a,source:u,stack:po(u)}}var il=[],Gl=0,jc=null,$l=0,la=[],Yr=0,Fo=null,Cs=1,Da="";function rl(a,u){il[Gl++]=$l,il[Gl++]=jc,jc=a,$l=u}function pp(a,u,g){la[Yr++]=Cs,la[Yr++]=Da,la[Yr++]=Fo,Fo=a;var w=Cs;a=Da;var I=32-Ge(w)-1;w&=~(1<<I),g+=1;var P=32-Ge(u)+I;if(30<P){var Z=I-I%5;P=(w&(1<<Z)-1).toString(32),w>>=Z,I-=Z,Cs=1<<32-Ge(u)+I|g<<I|w,Da=P+a}else Cs=1<<P|g<<I|w,Da=a}function Fc(a){a.return!==null&&(rl(a,1),pp(a,1,0))}function Mu(a){for(;a===jc;)jc=il[--Gl],il[Gl]=null,$l=il[--Gl],il[Gl]=null;for(;a===Fo;)Fo=la[--Yr],la[Yr]=null,Da=la[--Yr],la[Yr]=null,Cs=la[--Yr],la[Yr]=null}function Oh(a,u){la[Yr++]=Cs,la[Yr++]=Da,la[Yr++]=Fo,Cs=u.id,Da=u.overflow,Fo=a}var br=null,li=null,Nn=!1,Bo=null,Xa=!1,Zi=Error(h(519));function Ia(a){var u=Error(h(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ds(xa(u,a)),Zi}function Wa(a){var u=a.stateNode,g=a.type,w=a.memoizedProps;switch(u[$n]=a,u[vt]=w,g){case"dialog":Hn("cancel",u),Hn("close",u);break;case"iframe":case"object":case"embed":Hn("load",u);break;case"video":case"audio":for(g=0;g<Up.length;g++)Hn(Up[g],u);break;case"source":Hn("error",u);break;case"img":case"image":case"link":Hn("error",u),Hn("load",u);break;case"details":Hn("toggle",u);break;case"input":Hn("invalid",u),qf(u,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":Hn("invalid",u);break;case"textarea":Hn("invalid",u),gu(u,w.value,w.defaultValue,w.children)}g=w.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||u.textContent===""+g||w.suppressHydrationWarning===!0||Ky(u.textContent,g)?(w.popover!=null&&(Hn("beforetoggle",u),Hn("toggle",u)),w.onScroll!=null&&Hn("scroll",u),w.onScrollEnd!=null&&Hn("scrollend",u),w.onClick!=null&&(u.onclick=Ga),u=!0):u=!1,u||Ia(a,!0)}function Jd(a){for(br=a.return;br;)switch(br.tag){case 5:case 31:case 13:Xa=!1;return;case 27:case 3:Xa=!0;return;default:br=br.return}}function al(a){if(a!==br)return!1;if(!Nn)return Jd(a),Nn=!0,!1;var u=a.tag,g;if((g=u!==3&&u!==27)&&((g=u===5)&&(g=a.type,g=!(g!=="form"&&g!=="button")||cg(a.type,a.memoizedProps)),g=!g),g&&li&&Ia(a),Jd(a),u===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(h(317));li=r_(a)}else if(u===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(h(317));li=r_(a)}else u===27?(u=li,xl(a.type)?(a=dg,dg=null,li=a):li=u):li=br?Ao(a.stateNode.nextSibling):null;return!0}function ol(){li=br=null,Nn=!1}function sl(){var a=Bo;return a!==null&&(ro===null?ro=a:ro.push.apply(ro,a),Bo=null),a}function Ds(a){Bo===null?Bo=[a]:Bo.push(a)}var Bc=De(null),Is=null,Uo=null;function ll(a,u,g){dt(Bc,u._currentValue),u._currentValue=g}function Vo(a){a._currentValue=Bc.current,Qe(Bc)}function Ph(a,u,g){for(;a!==null;){var w=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,w!==null&&(w.childLanes|=u)):w!==null&&(w.childLanes&u)!==u&&(w.childLanes|=u),a===g)break;a=a.return}}function Zl(a,u,g,w){var I=a.child;for(I!==null&&(I.return=a);I!==null;){var P=I.dependencies;if(P!==null){var Z=I.child;P=P.firstContext;e:for(;P!==null;){var se=P;P=I;for(var Ie=0;Ie<u.length;Ie++)if(se.context===u[Ie]){P.lanes|=g,se=P.alternate,se!==null&&(se.lanes|=g),Ph(P.return,g,a),w||(Z=null);break e}P=se.next}}else if(I.tag===18){if(Z=I.return,Z===null)throw Error(h(341));Z.lanes|=g,P=Z.alternate,P!==null&&(P.lanes|=g),Ph(Z,g,a),Z=null}else Z=I.child;if(Z!==null)Z.return=I;else for(Z=I;Z!==null;){if(Z===a){Z=null;break}if(I=Z.sibling,I!==null){I.return=Z.return,Z=I;break}Z=Z.return}I=Z}}function bo(a,u,g,w){a=null;for(var I=u,P=!1;I!==null;){if(!P){if((I.flags&524288)!==0)P=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var Z=I.alternate;if(Z===null)throw Error(h(387));if(Z=Z.memoizedProps,Z!==null){var se=I.type;va(I.pendingProps.value,Z.value)||(a!==null?a.push(se):a=[se])}}else if(I===Kt.current){if(Z=I.alternate,Z===null)throw Error(h(387));Z.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(a!==null?a.push(Ke):a=[Ke])}I=I.return}a!==null&&Zl(u,a,g,w),u.flags|=262144}function Lh(a){for(a=a.firstContext;a!==null;){if(!va(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Yl(a){Is=a,Uo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Hr(a){return mp(Is,a)}function zh(a,u){return Is===null&&Yl(a),mp(a,u)}function mp(a,u){var g=u._currentValue;if(u={context:u,memoizedValue:g,next:null},Uo===null){if(a===null)throw Error(h(308));Uo=u,a.dependencies={lanes:0,firstContext:u},a.flags|=524288}else Uo=Uo.next=u;return g}var Cu=typeof AbortController<"u"?AbortController:function(){var a=[],u=this.signal={aborted:!1,addEventListener:function(g,w){a.push(w)}};this.abort=function(){u.aborted=!0,a.forEach(function(g){return g()})}},Du=n.unstable_scheduleCallback,Ra=n.unstable_NormalPriority,Ti={$$typeof:Te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nh(){return{controller:new Cu,data:new Map,refCount:0}}function ca(a){a.refCount--,a.refCount===0&&Du(Ra,function(){a.controller.abort()})}var wa=null,Hl=0,ta=0,Qa=null;function fy(a,u){if(wa===null){var g=wa=[];Hl=0,ta=Yu(),Qa={status:"pending",value:void 0,then:function(w){g.push(w)}}}return Hl++,u.then(ef,ef),u}function ef(){if(--Hl===0&&wa!==null){Qa!==null&&(Qa.status="fulfilled");var a=wa;wa=null,ta=0,Qa=null;for(var u=0;u<a.length;u++)(0,a[u])()}}function py(a,u){var g=[],w={status:"pending",value:null,reason:null,then:function(I){g.push(I)}};return a.then(function(){w.status="fulfilled",w.value=u;for(var I=0;I<g.length;I++)(0,g[I])(u)},function(I){for(w.status="rejected",w.reason=I,I=0;I<g.length;I++)(0,g[I])(void 0)}),w}var Iu=Ue.S;Ue.S=function(a,u){$0=Oi(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&fy(a,u),Iu!==null&&Iu(a,u)};var ql=De(null);function Uc(){var a=ql.current;return a!==null?a:Mi.pooledCache}function xo(a,u){u===null?dt(ql,ql.current):dt(ql,u.pool)}function Rt(){var a=Uc();return a===null?null:{parent:Ti._currentValue,pool:a}}var Vc=Error(h(460)),jh=Error(h(474)),Xl=Error(h(542)),Wl={then:function(){}};function Ql(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Gc(a,u,g){switch(g=a[g],g===void 0?a.push(u):g!==u&&(u.then(Ga,Ga),u=g),u.status){case"fulfilled":return u.value;case"rejected":throw a=u.reason,Fh(a),a;default:if(typeof u.status=="string")u.then(Ga,Ga);else{if(a=Mi,a!==null&&100<a.shellSuspendCounter)throw Error(h(482));a=u,a.status="pending",a.then(function(w){if(u.status==="pending"){var I=u;I.status="fulfilled",I.value=w}},function(w){if(u.status==="pending"){var I=u;I.status="rejected",I.reason=w}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw a=u.reason,Fh(a),a}throw Rs=u,Vc}}function yn(a){try{var u=a._init;return u(a._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(Rs=g,Vc):g}}var Rs=null;function gp(){if(Rs===null)throw Error(h(459));var a=Rs;return Rs=null,a}function Fh(a){if(a===Vc||a===Xl)throw Error(h(483))}var Kl=null,Ru=0;function Bh(a){var u=Ru;return Ru+=1,Kl===null&&(Kl=[]),Gc(Kl,a,u)}function Jl(a,u){u=u.props.ref,a.ref=u!==void 0?u:null}function Uh(a,u){throw u.$$typeof===F?Error(h(525)):(a=Object.prototype.toString.call(u),Error(h(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a)))}function yp(a){function u(Ve,ze){if(a){var Xe=Ve.deletions;Xe===null?(Ve.deletions=[ze],Ve.flags|=16):Xe.push(ze)}}function g(Ve,ze){if(!a)return null;for(;ze!==null;)u(Ve,ze),ze=ze.sibling;return null}function w(Ve){for(var ze=new Map;Ve!==null;)Ve.key!==null?ze.set(Ve.key,Ve):ze.set(Ve.index,Ve),Ve=Ve.sibling;return ze}function I(Ve,ze){return Ve=qa(Ve,ze),Ve.index=0,Ve.sibling=null,Ve}function P(Ve,ze,Xe){return Ve.index=Xe,a?(Xe=Ve.alternate,Xe!==null?(Xe=Xe.index,Xe<ze?(Ve.flags|=67108866,ze):Xe):(Ve.flags|=67108866,ze)):(Ve.flags|=1048576,ze)}function Z(Ve){return a&&Ve.alternate===null&&(Ve.flags|=67108866),Ve}function se(Ve,ze,Xe,ht){return ze===null||ze.tag!==6?(ze=fp(Xe,Ve.mode,ht),ze.return=Ve,ze):(ze=I(ze,Xe),ze.return=Ve,ze)}function Ie(Ve,ze,Xe,ht){var en=Xe.type;return en===ie?lt(Ve,ze,Xe.props.children,ht,Xe.key):ze!==null&&(ze.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===ot&&yn(en)===ze.type)?(ze=I(ze,Xe.props),Jl(ze,Xe),ze.return=Ve,ze):(ze=Nc(Xe.type,Xe.key,Xe.props,null,Ve.mode,ht),Jl(ze,Xe),ze.return=Ve,ze)}function We(Ve,ze,Xe,ht){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==Xe.containerInfo||ze.stateNode.implementation!==Xe.implementation?(ze=Au(Xe,Ve.mode,ht),ze.return=Ve,ze):(ze=I(ze,Xe.children||[]),ze.return=Ve,ze)}function lt(Ve,ze,Xe,ht,en){return ze===null||ze.tag!==7?(ze=nl(Xe,Ve.mode,ht,en),ze.return=Ve,ze):(ze=I(ze,Xe),ze.return=Ve,ze)}function mt(Ve,ze,Xe){if(typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint")return ze=fp(""+ze,Ve.mode,Xe),ze.return=Ve,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case B:return Xe=Nc(ze.type,ze.key,ze.props,null,Ve.mode,Xe),Jl(Xe,ze),Xe.return=Ve,Xe;case Q:return ze=Au(ze,Ve.mode,Xe),ze.return=Ve,ze;case ot:return ze=yn(ze),mt(Ve,ze,Xe)}if(Gt(ze)||Tt(ze))return ze=nl(ze,Ve.mode,Xe,null),ze.return=Ve,ze;if(typeof ze.then=="function")return mt(Ve,Bh(ze),Xe);if(ze.$$typeof===Te)return mt(Ve,zh(Ve,ze),Xe);Uh(Ve,ze)}return null}function et(Ve,ze,Xe,ht){var en=ze!==null?ze.key:null;if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number"||typeof Xe=="bigint")return en!==null?null:se(Ve,ze,""+Xe,ht);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case B:return Xe.key===en?Ie(Ve,ze,Xe,ht):null;case Q:return Xe.key===en?We(Ve,ze,Xe,ht):null;case ot:return Xe=yn(Xe),et(Ve,ze,Xe,ht)}if(Gt(Xe)||Tt(Xe))return en!==null?null:lt(Ve,ze,Xe,ht,null);if(typeof Xe.then=="function")return et(Ve,ze,Bh(Xe),ht);if(Xe.$$typeof===Te)return et(Ve,ze,zh(Ve,Xe),ht);Uh(Ve,Xe)}return null}function nt(Ve,ze,Xe,ht,en){if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return Ve=Ve.get(Xe)||null,se(ze,Ve,""+ht,en);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case B:return Ve=Ve.get(ht.key===null?Xe:ht.key)||null,Ie(ze,Ve,ht,en);case Q:return Ve=Ve.get(ht.key===null?Xe:ht.key)||null,We(ze,Ve,ht,en);case ot:return ht=yn(ht),nt(Ve,ze,Xe,ht,en)}if(Gt(ht)||Tt(ht))return Ve=Ve.get(Xe)||null,lt(ze,Ve,ht,en,null);if(typeof ht.then=="function")return nt(Ve,ze,Xe,Bh(ht),en);if(ht.$$typeof===Te)return nt(Ve,ze,Xe,zh(ze,ht),en);Uh(ze,ht)}return null}function Yt(Ve,ze,Xe,ht){for(var en=null,hi=null,Pt=ze,rn=ze=0,Rn=null;Pt!==null&&rn<Xe.length;rn++){Pt.index>rn?(Rn=Pt,Pt=null):Rn=Pt.sibling;var kn=et(Ve,Pt,Xe[rn],ht);if(kn===null){Pt===null&&(Pt=Rn);break}a&&Pt&&kn.alternate===null&&u(Ve,Pt),ze=P(kn,ze,rn),hi===null?en=kn:hi.sibling=kn,hi=kn,Pt=Rn}if(rn===Xe.length)return g(Ve,Pt),Nn&&rl(Ve,rn),en;if(Pt===null){for(;rn<Xe.length;rn++)Pt=mt(Ve,Xe[rn],ht),Pt!==null&&(ze=P(Pt,ze,rn),hi===null?en=Pt:hi.sibling=Pt,hi=Pt);return Nn&&rl(Ve,rn),en}for(Pt=w(Pt);rn<Xe.length;rn++)Rn=nt(Pt,Ve,rn,Xe[rn],ht),Rn!==null&&(a&&Rn.alternate!==null&&Pt.delete(Rn.key===null?rn:Rn.key),ze=P(Rn,ze,rn),hi===null?en=Rn:hi.sibling=Rn,hi=Rn);return a&&Pt.forEach(function(Do){return u(Ve,Do)}),Nn&&rl(Ve,rn),en}function ln(Ve,ze,Xe,ht){if(Xe==null)throw Error(h(151));for(var en=null,hi=null,Pt=ze,rn=ze=0,Rn=null,kn=Xe.next();Pt!==null&&!kn.done;rn++,kn=Xe.next()){Pt.index>rn?(Rn=Pt,Pt=null):Rn=Pt.sibling;var Do=et(Ve,Pt,kn.value,ht);if(Do===null){Pt===null&&(Pt=Rn);break}a&&Pt&&Do.alternate===null&&u(Ve,Pt),ze=P(Do,ze,rn),hi===null?en=Do:hi.sibling=Do,hi=Do,Pt=Rn}if(kn.done)return g(Ve,Pt),Nn&&rl(Ve,rn),en;if(Pt===null){for(;!kn.done;rn++,kn=Xe.next())kn=mt(Ve,kn.value,ht),kn!==null&&(ze=P(kn,ze,rn),hi===null?en=kn:hi.sibling=kn,hi=kn);return Nn&&rl(Ve,rn),en}for(Pt=w(Pt);!kn.done;rn++,kn=Xe.next())kn=nt(Pt,Ve,rn,kn.value,ht),kn!==null&&(a&&kn.alternate!==null&&Pt.delete(kn.key===null?rn:kn.key),ze=P(kn,ze,rn),hi===null?en=kn:hi.sibling=kn,hi=kn);return a&&Pt.forEach(function(fc){return u(Ve,fc)}),Nn&&rl(Ve,rn),en}function Ni(Ve,ze,Xe,ht){if(typeof Xe=="object"&&Xe!==null&&Xe.type===ie&&Xe.key===null&&(Xe=Xe.props.children),typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case B:e:{for(var en=Xe.key;ze!==null;){if(ze.key===en){if(en=Xe.type,en===ie){if(ze.tag===7){g(Ve,ze.sibling),ht=I(ze,Xe.props.children),ht.return=Ve,Ve=ht;break e}}else if(ze.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===ot&&yn(en)===ze.type){g(Ve,ze.sibling),ht=I(ze,Xe.props),Jl(ht,Xe),ht.return=Ve,Ve=ht;break e}g(Ve,ze);break}else u(Ve,ze);ze=ze.sibling}Xe.type===ie?(ht=nl(Xe.props.children,Ve.mode,ht,Xe.key),ht.return=Ve,Ve=ht):(ht=Nc(Xe.type,Xe.key,Xe.props,null,Ve.mode,ht),Jl(ht,Xe),ht.return=Ve,Ve=ht)}return Z(Ve);case Q:e:{for(en=Xe.key;ze!==null;){if(ze.key===en)if(ze.tag===4&&ze.stateNode.containerInfo===Xe.containerInfo&&ze.stateNode.implementation===Xe.implementation){g(Ve,ze.sibling),ht=I(ze,Xe.children||[]),ht.return=Ve,Ve=ht;break e}else{g(Ve,ze);break}else u(Ve,ze);ze=ze.sibling}ht=Au(Xe,Ve.mode,ht),ht.return=Ve,Ve=ht}return Z(Ve);case ot:return Xe=yn(Xe),Ni(Ve,ze,Xe,ht)}if(Gt(Xe))return Yt(Ve,ze,Xe,ht);if(Tt(Xe)){if(en=Tt(Xe),typeof en!="function")throw Error(h(150));return Xe=en.call(Xe),ln(Ve,ze,Xe,ht)}if(typeof Xe.then=="function")return Ni(Ve,ze,Bh(Xe),ht);if(Xe.$$typeof===Te)return Ni(Ve,ze,zh(Ve,Xe),ht);Uh(Ve,Xe)}return typeof Xe=="string"&&Xe!==""||typeof Xe=="number"||typeof Xe=="bigint"?(Xe=""+Xe,ze!==null&&ze.tag===6?(g(Ve,ze.sibling),ht=I(ze,Xe),ht.return=Ve,Ve=ht):(g(Ve,ze),ht=fp(Xe,Ve.mode,ht),ht.return=Ve,Ve=ht),Z(Ve)):g(Ve,ze)}return function(Ve,ze,Xe,ht){try{Ru=0;var en=Ni(Ve,ze,Xe,ht);return Kl=null,en}catch(Pt){if(Pt===Vc||Pt===Xl)throw Pt;var hi=Ha(29,Pt,null,Ve.mode);return hi.lanes=ht,hi.return=Ve,hi}finally{}}}var ec=yp(!0),_p=yp(!1),cl=!1;function ks(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ci(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ul(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function wo(a,u,g){var w=a.updateQueue;if(w===null)return null;if(w=w.shared,(ei&2)!==0){var I=w.pending;return I===null?u.next=u:(u.next=I.next,I.next=u),w.pending=u,u=Vl(a),dp(a,null,g),u}return Ih(a,w,u,g),Vl(a)}function tc(a,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194048)!==0)){var w=u.lanes;w&=a.pendingLanes,g|=w,u.lanes=g,pi(a,g)}}function Vh(a,u){var g=a.updateQueue,w=a.alternate;if(w!==null&&(w=w.updateQueue,g===w)){var I=null,P=null;if(g=g.firstBaseUpdate,g!==null){do{var Z={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};P===null?I=P=Z:P=P.next=Z,g=g.next}while(g!==null);P===null?I=P=u:P=P.next=u}else I=P=u;g={baseState:w.baseState,firstBaseUpdate:I,lastBaseUpdate:P,shared:w.shared,callbacks:w.callbacks},a.updateQueue=g;return}a=g.lastBaseUpdate,a===null?g.firstBaseUpdate=u:a.next=u,g.lastBaseUpdate=u}var $c=!1;function ku(){if($c){var a=Qa;if(a!==null)throw a}}function Zc(a,u,g,w){$c=!1;var I=a.updateQueue;cl=!1;var P=I.firstBaseUpdate,Z=I.lastBaseUpdate,se=I.shared.pending;if(se!==null){I.shared.pending=null;var Ie=se,We=Ie.next;Ie.next=null,Z===null?P=We:Z.next=We,Z=Ie;var lt=a.alternate;lt!==null&&(lt=lt.updateQueue,se=lt.lastBaseUpdate,se!==Z&&(se===null?lt.firstBaseUpdate=We:se.next=We,lt.lastBaseUpdate=Ie))}if(P!==null){var mt=I.baseState;Z=0,lt=We=Ie=null,se=P;do{var et=se.lane&-536870913,nt=et!==se.lane;if(nt?(Qn&et)===et:(w&et)===et){et!==0&&et===ta&&($c=!0),lt!==null&&(lt=lt.next={lane:0,tag:se.tag,payload:se.payload,callback:null,next:null});e:{var Yt=a,ln=se;et=u;var Ni=g;switch(ln.tag){case 1:if(Yt=ln.payload,typeof Yt=="function"){mt=Yt.call(Ni,mt,et);break e}mt=Yt;break e;case 3:Yt.flags=Yt.flags&-65537|128;case 0:if(Yt=ln.payload,et=typeof Yt=="function"?Yt.call(Ni,mt,et):Yt,et==null)break e;mt=z({},mt,et);break e;case 2:cl=!0}}et=se.callback,et!==null&&(a.flags|=64,nt&&(a.flags|=8192),nt=I.callbacks,nt===null?I.callbacks=[et]:nt.push(et))}else nt={lane:et,tag:se.tag,payload:se.payload,callback:se.callback,next:null},lt===null?(We=lt=nt,Ie=mt):lt=lt.next=nt,Z|=et;if(se=se.next,se===null){if(se=I.shared.pending,se===null)break;nt=se,se=nt.next,nt.next=null,I.lastBaseUpdate=nt,I.shared.pending=null}}while(!0);lt===null&&(Ie=mt),I.baseState=Ie,I.firstBaseUpdate=We,I.lastBaseUpdate=lt,P===null&&(I.shared.lanes=0),Gu|=Z,a.lanes=Z,a.memoizedState=mt}}function Go(a,u){if(typeof a!="function")throw Error(h(191,a));a.call(u)}function Gh(a,u){var g=a.callbacks;if(g!==null)for(a.callbacks=null,a=0;a<g.length;a++)Go(g[a],u)}var Lt=De(null),qt=De(0);function Yc(a,u){a=lc,dt(qt,a),dt(Lt,u),lc=a|u.baseLanes}function tf(){dt(qt,lc),dt(Lt,Lt.current)}function Ou(){lc=qt.current,Qe(Lt),Qe(qt)}var Si=De(null),Ka=null;function qr(a){var u=a.alternate;dt(Li,Li.current&1),dt(Si,a),Ka===null&&(u===null||Lt.current!==null||u.memoizedState!==null)&&(Ka=a)}function hl(a){dt(Li,Li.current),dt(Si,a),Ka===null&&(Ka=a)}function Pm(a){a.tag===22?(dt(Li,Li.current),dt(Si,a),Ka===null&&(Ka=a)):nc()}function nc(){dt(Li,Li.current),dt(Si,Si.current)}function Ja(a){Qe(Si),Ka===a&&(Ka=null),Qe(Li)}var Li=De(0);function Ei(a){for(var u=a;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||i_(g)||qu(g)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var ui=0,sn=null,Jn=null,Ui=null,Hc=!1,Os=!1,dl=!1,$o=0,Zo=0,ic=null,nf=0;function _i(){throw Error(h(321))}function $h(a,u){if(u===null)return!1;for(var g=0;g<u.length&&g<a.length;g++)if(!va(a[g],u[g]))return!1;return!0}function Zh(a,u,g,w,I,P){return ui=P,sn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Ue.H=a===null||a.memoizedState===null?af:Ls,dl=!1,P=g(w,I),dl=!1,Os&&(P=rf(u,g,w,I)),Yh(a),P}function Yh(a){Ue.H=Xc;var u=Jn!==null&&Jn.next!==null;if(ui=0,Ui=Jn=sn=null,Hc=!1,Zo=0,ic=null,u)throw Error(h(300));a===null||kr||(a=a.dependencies,a!==null&&Lh(a)&&(kr=!0))}function rf(a,u,g,w){sn=a;var I=0;do{if(Os&&(ic=null),Zo=0,Os=!1,25<=I)throw Error(h(301));if(I+=1,Ui=Jn=null,a.updateQueue!=null){var P=a.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}Ue.H=of,P=u(g,w)}while(Os);return P}function b(){var a=Ue.H,u=a.useState()[0];return u=typeof u.then=="function"?R(u):u,a=a.useState()[0],(Jn!==null?Jn.memoizedState:null)!==a&&(sn.flags|=1024),u}function t(){var a=$o!==0;return $o=0,a}function l(a,u,g){u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~g}function p(a){if(Hc){for(a=a.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}Hc=!1}ui=0,Ui=Jn=sn=null,Os=!1,Zo=$o=0,ic=null}function v(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ui===null?sn.memoizedState=Ui=a:Ui=Ui.next=a,Ui}function x(){if(Jn===null){var a=sn.alternate;a=a!==null?a.memoizedState:null}else a=Jn.next;var u=Ui===null?sn.memoizedState:Ui.next;if(u!==null)Ui=u,Jn=a;else{if(a===null)throw sn.alternate===null?Error(h(467)):Error(h(310));Jn=a,a={memoizedState:Jn.memoizedState,baseState:Jn.baseState,baseQueue:Jn.baseQueue,queue:Jn.queue,next:null},Ui===null?sn.memoizedState=Ui=a:Ui=Ui.next=a}return Ui}function A(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function R(a){var u=Zo;return Zo+=1,ic===null&&(ic=[]),a=Gc(ic,a,u),u=sn,(Ui===null?u.memoizedState:Ui.next)===null&&(u=u.alternate,Ue.H=u===null||u.memoizedState===null?af:Ls),a}function O(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return R(a);if(a.$$typeof===Te)return Hr(a)}throw Error(h(438,String(a)))}function j(a){var u=null,g=sn.updateQueue;if(g!==null&&(u=g.memoCache),u==null){var w=sn.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(u={data:w.data.map(function(I){return I.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),g===null&&(g=A(),sn.updateQueue=g),g.memoCache=u,g=u.data[u.index],g===void 0)for(g=u.data[u.index]=Array(a),w=0;w<a;w++)g[w]=Je;return u.index++,g}function U(a,u){return typeof u=="function"?u(a):u}function $(a){var u=x();return G(u,Jn,a)}function G(a,u,g){var w=a.queue;if(w===null)throw Error(h(311));w.lastRenderedReducer=g;var I=a.baseQueue,P=w.pending;if(P!==null){if(I!==null){var Z=I.next;I.next=P.next,P.next=Z}u.baseQueue=I=P,w.pending=null}if(P=a.baseState,I===null)a.memoizedState=P;else{u=I.next;var se=Z=null,Ie=null,We=u,lt=!1;do{var mt=We.lane&-536870913;if(mt!==We.lane?(Qn&mt)===mt:(ui&mt)===mt){var et=We.revertLane;if(et===0)Ie!==null&&(Ie=Ie.next={lane:0,revertLane:0,gesture:null,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null}),mt===ta&&(lt=!0);else if((ui&et)===et){We=We.next,et===ta&&(lt=!0);continue}else mt={lane:0,revertLane:We.revertLane,gesture:null,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null},Ie===null?(se=Ie=mt,Z=P):Ie=Ie.next=mt,sn.lanes|=et,Gu|=et;mt=We.action,dl&&g(P,mt),P=We.hasEagerState?We.eagerState:g(P,mt)}else et={lane:mt,revertLane:We.revertLane,gesture:We.gesture,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null},Ie===null?(se=Ie=et,Z=P):Ie=Ie.next=et,sn.lanes|=mt,Gu|=mt;We=We.next}while(We!==null&&We!==u);if(Ie===null?Z=P:Ie.next=se,!va(P,a.memoizedState)&&(kr=!0,lt&&(g=Qa,g!==null)))throw g;a.memoizedState=P,a.baseState=Z,a.baseQueue=Ie,w.lastRenderedState=P}return I===null&&(w.lanes=0),[a.memoizedState,w.dispatch]}function q(a){var u=x(),g=u.queue;if(g===null)throw Error(h(311));g.lastRenderedReducer=a;var w=g.dispatch,I=g.pending,P=u.memoizedState;if(I!==null){g.pending=null;var Z=I=I.next;do P=a(P,Z.action),Z=Z.next;while(Z!==I);va(P,u.memoizedState)||(kr=!0),u.memoizedState=P,u.baseQueue===null&&(u.baseState=P),g.lastRenderedState=P}return[P,w]}function re(a,u,g){var w=sn,I=x(),P=Nn;if(P){if(g===void 0)throw Error(h(407));g=g()}else g=u();var Z=!va((Jn||I).memoizedState,g);if(Z&&(I.memoizedState=g,kr=!0),I=I.queue,In(fe.bind(null,w,I,a),[a]),I.getSnapshot!==u||Z||Ui!==null&&Ui.memoizedState.tag&1){if(w.flags|=2048,Vn(9,{destroy:void 0},de.bind(null,w,I,g,u),null),Mi===null)throw Error(h(349));P||(ui&127)!==0||he(w,u,g)}return g}function he(a,u,g){a.flags|=16384,a={getSnapshot:u,value:g},u=sn.updateQueue,u===null?(u=A(),sn.updateQueue=u,u.stores=[a]):(g=u.stores,g===null?u.stores=[a]:g.push(a))}function de(a,u,g,w){u.value=g,u.getSnapshot=w,me(u)&&ye(a)}function fe(a,u,g){return g(function(){me(u)&&ye(a)})}function me(a){var u=a.getSnapshot;a=a.value;try{var g=u();return!va(a,g)}catch{return!0}}function ye(a){var u=vo(a,2);u!==null&&La(u,a,2)}function ge(a){var u=v();if(typeof a=="function"){var g=a;if(a=g(),dl){Oe(!0);try{g()}finally{Oe(!1)}}}return u.memoizedState=u.baseState=a,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:U,lastRenderedState:a},u}function Se(a,u,g,w){return a.baseState=g,G(a,Jn,typeof w=="function"?w:U)}function Re(a,u,g,w,I){if(Pa(a))throw Error(h(485));if(a=u.action,a!==null){var P={payload:I,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){P.listeners.push(Z)}};Ue.T!==null?g(!0):P.isTransition=!1,w(P),g=u.pending,g===null?(P.next=u.pending=P,_e(u,P)):(P.next=g.next,u.pending=g.next=P)}}function _e(a,u){var g=u.action,w=u.payload,I=a.state;if(u.isTransition){var P=Ue.T,Z={};Ue.T=Z;try{var se=g(I,w),Ie=Ue.S;Ie!==null&&Ie(Z,se),Le(a,u,se)}catch(We){$e(a,u,We)}finally{P!==null&&Z.types!==null&&(P.types=Z.types),Ue.T=P}}else try{P=g(I,w),Le(a,u,P)}catch(We){$e(a,u,We)}}function Le(a,u,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(w){qe(a,u,w)},function(w){return $e(a,u,w)}):qe(a,u,g)}function qe(a,u,g){u.status="fulfilled",u.value=g,Ye(u),a.state=g,u=a.pending,u!==null&&(g=u.next,g===u?a.pending=null:(g=g.next,u.next=g,_e(a,g)))}function $e(a,u,g){var w=a.pending;if(a.pending=null,w!==null){w=w.next;do u.status="rejected",u.reason=g,Ye(u),u=u.next;while(u!==w)}a.action=null}function Ye(a){a=a.listeners;for(var u=0;u<a.length;u++)(0,a[u])()}function He(a,u){return u}function bt(a,u){if(Nn){var g=Mi.formState;if(g!==null){e:{var w=sn;if(Nn){if(li){t:{for(var I=li,P=Xa;I.nodeType!==8;){if(!P){I=null;break t}if(I=Ao(I.nextSibling),I===null){I=null;break t}}P=I.data,I=P==="F!"||P==="F"?I:null}if(I){li=Ao(I.nextSibling),w=I.data==="F!";break e}}Ia(w)}w=!1}w&&(u=g[0])}}return g=v(),g.memoizedState=g.baseState=u,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:He,lastRenderedState:u},g.queue=w,g=Lu.bind(null,sn,w),w.dispatch=g,w=ge(!1),P=qo.bind(null,sn,!1,w.queue),w=v(),I={state:u,dispatch:null,action:a,pending:null},w.queue=I,g=Re.bind(null,sn,I,P,g),I.dispatch=g,w.memoizedState=a,[u,g,!1]}function wt(a){var u=x();return ct(u,Jn,a)}function ct(a,u,g){if(u=G(a,u,He)[0],a=$(U)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var w=R(u)}catch(Z){throw Z===Vc?Xl:Z}else w=u;u=x();var I=u.queue,P=I.dispatch;return g!==u.memoizedState&&(sn.flags|=2048,Vn(9,{destroy:void 0},Ft.bind(null,I,g),null)),[w,P,a]}function Ft(a,u){a.action=u}function on(a){var u=x(),g=Jn;if(g!==null)return ct(u,g,a);x(),u=u.memoizedState,g=x();var w=g.queue.dispatch;return g.memoizedState=a,[u,w,!1]}function Vn(a,u,g,w){return a={tag:a,create:g,deps:w,inst:u,next:null},u=sn.updateQueue,u===null&&(u=A(),sn.updateQueue=u),g=u.lastEffect,g===null?u.lastEffect=a.next=a:(w=g.next,g.next=a,a.next=w,u.lastEffect=a),a}function ti(){return x().memoizedState}function ni(a,u,g,w){var I=v();sn.flags|=a,I.memoizedState=Vn(1|u,{destroy:void 0},g,w===void 0?null:w)}function Ai(a,u,g,w){var I=x();w=w===void 0?null:w;var P=I.memoizedState.inst;Jn!==null&&w!==null&&$h(w,Jn.memoizedState.deps)?I.memoizedState=Vn(u,P,g,w):(sn.flags|=a,I.memoizedState=Vn(1|u,P,g,w))}function vi(a,u){ni(8390656,8,a,u)}function In(a,u){Ai(2048,8,a,u)}function Vi(a){sn.flags|=4;var u=sn.updateQueue;if(u===null)u=A(),sn.updateQueue=u,u.events=[a];else{var g=u.events;g===null?u.events=[a]:g.push(a)}}function Xr(a){var u=x().memoizedState;return Vi({ref:u,nextImpl:a}),function(){if((ei&2)!==0)throw Error(h(440));return u.impl.apply(void 0,arguments)}}function nr(a,u){return Ai(4,2,a,u)}function ir(a,u){return Ai(4,4,a,u)}function ua(a,u){if(typeof u=="function"){a=a();var g=u(a);return function(){typeof g=="function"?g():u(null)}}if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function fl(a,u,g){g=g!=null?g.concat([a]):null,Ai(4,4,ua.bind(null,u,a),g)}function eo(){}function pl(a,u){var g=x();u=u===void 0?null:u;var w=g.memoizedState;return u!==null&&$h(u,w[1])?w[0]:(g.memoizedState=[a,u],a)}function rc(a,u){var g=x();u=u===void 0?null:u;var w=g.memoizedState;if(u!==null&&$h(u,w[1]))return w[0];if(w=a(),dl){Oe(!0);try{a()}finally{Oe(!1)}}return g.memoizedState=[w,u],w}function Pu(a,u,g){return g===void 0||(ui&1073741824)!==0&&(Qn&261930)===0?a.memoizedState=u:(a.memoizedState=g,a=Py(),sn.lanes|=a,Gu|=a,g)}function qc(a,u,g,w){return va(g,u)?g:Lt.current!==null?(a=Pu(a,g,w),va(a,u)||(kr=!0),a):(ui&42)===0||(ui&1073741824)!==0&&(Qn&261930)===0?(kr=!0,a.memoizedState=g):(a=Py(),sn.lanes|=a,Gu|=a,u)}function Ps(a,u,g,w,I){var P=st.p;st.p=P!==0&&8>P?P:8;var Z=Ue.T,se={};Ue.T=se,qo(a,!1,u,g);try{var Ie=I(),We=Ue.S;if(We!==null&&We(se,Ie),Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var lt=py(Ie,w);Ho(a,u,lt,Eo(a))}else Ho(a,u,w,Eo(a))}catch(mt){Ho(a,u,{then:function(){},status:"rejected",reason:mt},Eo())}finally{st.p=P,Z!==null&&se.types!==null&&(Z.types=se.types),Ue.T=Z}}function to(){}function To(a,u,g,w){if(a.tag!==5)throw Error(h(476));var I=Yo(a).queue;Ps(a,I,u,xt,g===null?to:function(){return ka(a),g(w)})}function Yo(a){var u=a.memoizedState;if(u!==null)return u;u={memoizedState:xt,baseState:xt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:U,lastRenderedState:xt},next:null};var g={};return u.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:U,lastRenderedState:g},next:null},a.memoizedState=u,a=a.alternate,a!==null&&(a.memoizedState=u),u}function ka(a){var u=Yo(a);u.next===null&&(u=a.alternate.memoizedState),Ho(a,u.next.queue,{},Eo())}function Yi(){return Hr(Ke)}function xr(){return x().memoizedState}function Oa(){return x().memoizedState}function Wr(a){for(var u=a.return;u!==null;){switch(u.tag){case 24:case 3:var g=Eo();a=ul(g);var w=wo(u,a,g);w!==null&&(La(w,u,g),tc(w,u,g)),u={cache:Nh()},a.payload=u;return}u=u.return}}function vp(a,u,g){var w=Eo();g={lane:w,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Pa(a)?ml(u,g):(g=Ul(a,u,g,w),g!==null&&(La(g,a,w),gl(g,u,w)))}function Lu(a,u,g){var w=Eo();Ho(a,u,g,w)}function Ho(a,u,g,w){var I={lane:w,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Pa(a))ml(u,I);else{var P=a.alternate;if(a.lanes===0&&(P===null||P.lanes===0)&&(P=u.lastRenderedReducer,P!==null))try{var Z=u.lastRenderedState,se=P(Z,g);if(I.hasEagerState=!0,I.eagerState=se,va(se,Z))return Ih(a,u,I,0),Mi===null&&zc(),!1}catch{}finally{}if(g=Ul(a,u,I,w),g!==null)return La(g,a,w),gl(g,u,w),!0}return!1}function qo(a,u,g,w){if(w={lane:2,revertLane:Yu(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},Pa(a)){if(u)throw Error(h(479))}else u=Ul(a,g,w,2),u!==null&&La(u,a,2)}function Pa(a){var u=a.alternate;return a===sn||u!==null&&u===sn}function ml(a,u){Os=Hc=!0;var g=a.pending;g===null?u.next=u:(u.next=g.next,g.next=u),a.pending=u}function gl(a,u,g){if((g&4194048)!==0){var w=u.lanes;w&=a.pendingLanes,g|=w,u.lanes=g,pi(a,g)}}var Xc={readContext:Hr,use:O,useCallback:_i,useContext:_i,useEffect:_i,useImperativeHandle:_i,useLayoutEffect:_i,useInsertionEffect:_i,useMemo:_i,useReducer:_i,useRef:_i,useState:_i,useDebugValue:_i,useDeferredValue:_i,useTransition:_i,useSyncExternalStore:_i,useId:_i,useHostTransitionStatus:_i,useFormState:_i,useActionState:_i,useOptimistic:_i,useMemoCache:_i,useCacheRefresh:_i};Xc.useEffectEvent=_i;var af={readContext:Hr,use:O,useCallback:function(a,u){return v().memoizedState=[a,u===void 0?null:u],a},useContext:Hr,useEffect:vi,useImperativeHandle:function(a,u,g){g=g!=null?g.concat([a]):null,ni(4194308,4,ua.bind(null,u,a),g)},useLayoutEffect:function(a,u){return ni(4194308,4,a,u)},useInsertionEffect:function(a,u){ni(4,2,a,u)},useMemo:function(a,u){var g=v();u=u===void 0?null:u;var w=a();if(dl){Oe(!0);try{a()}finally{Oe(!1)}}return g.memoizedState=[w,u],w},useReducer:function(a,u,g){var w=v();if(g!==void 0){var I=g(u);if(dl){Oe(!0);try{g(u)}finally{Oe(!1)}}}else I=u;return w.memoizedState=w.baseState=I,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:I},w.queue=a,a=a.dispatch=vp.bind(null,sn,a),[w.memoizedState,a]},useRef:function(a){var u=v();return a={current:a},u.memoizedState=a},useState:function(a){a=ge(a);var u=a.queue,g=Lu.bind(null,sn,u);return u.dispatch=g,[a.memoizedState,g]},useDebugValue:eo,useDeferredValue:function(a,u){var g=v();return Pu(g,a,u)},useTransition:function(){var a=ge(!1);return a=Ps.bind(null,sn,a.queue,!0,!1),v().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,u,g){var w=sn,I=v();if(Nn){if(g===void 0)throw Error(h(407));g=g()}else{if(g=u(),Mi===null)throw Error(h(349));(Qn&127)!==0||he(w,u,g)}I.memoizedState=g;var P={value:g,getSnapshot:u};return I.queue=P,vi(fe.bind(null,w,P,a),[a]),w.flags|=2048,Vn(9,{destroy:void 0},de.bind(null,w,P,g,u),null),g},useId:function(){var a=v(),u=Mi.identifierPrefix;if(Nn){var g=Da,w=Cs;g=(w&~(1<<32-Ge(w)-1)).toString(32)+g,u="_"+u+"R_"+g,g=$o++,0<g&&(u+="H"+g.toString(32)),u+="_"}else g=nf++,u="_"+u+"r_"+g.toString(32)+"_";return a.memoizedState=u},useHostTransitionStatus:Yi,useFormState:bt,useActionState:bt,useOptimistic:function(a){var u=v();u.memoizedState=u.baseState=a;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=g,u=qo.bind(null,sn,!0,g),g.dispatch=u,[a,u]},useMemoCache:j,useCacheRefresh:function(){return v().memoizedState=Wr.bind(null,sn)},useEffectEvent:function(a){var u=v(),g={impl:a};return u.memoizedState=g,function(){if((ei&2)!==0)throw Error(h(440));return g.impl.apply(void 0,arguments)}}},Ls={readContext:Hr,use:O,useCallback:pl,useContext:Hr,useEffect:In,useImperativeHandle:fl,useInsertionEffect:nr,useLayoutEffect:ir,useMemo:rc,useReducer:$,useRef:ti,useState:function(){return $(U)},useDebugValue:eo,useDeferredValue:function(a,u){var g=x();return qc(g,Jn.memoizedState,a,u)},useTransition:function(){var a=$(U)[0],u=x().memoizedState;return[typeof a=="boolean"?a:R(a),u]},useSyncExternalStore:re,useId:xr,useHostTransitionStatus:Yi,useFormState:wt,useActionState:wt,useOptimistic:function(a,u){var g=x();return Se(g,Jn,a,u)},useMemoCache:j,useCacheRefresh:Oa};Ls.useEffectEvent=Xr;var of={readContext:Hr,use:O,useCallback:pl,useContext:Hr,useEffect:In,useImperativeHandle:fl,useInsertionEffect:nr,useLayoutEffect:ir,useMemo:rc,useReducer:q,useRef:ti,useState:function(){return q(U)},useDebugValue:eo,useDeferredValue:function(a,u){var g=x();return Jn===null?Pu(g,a,u):qc(g,Jn.memoizedState,a,u)},useTransition:function(){var a=q(U)[0],u=x().memoizedState;return[typeof a=="boolean"?a:R(a),u]},useSyncExternalStore:re,useId:xr,useHostTransitionStatus:Yi,useFormState:on,useActionState:on,useOptimistic:function(a,u){var g=x();return Jn!==null?Se(g,Jn,a,u):(g.baseState=a,[a,g.queue.dispatch])},useMemoCache:j,useCacheRefresh:Oa};of.useEffectEvent=Xr;function Hh(a,u,g,w){u=a.memoizedState,g=g(w,u),g=g==null?u:z({},u,g),a.memoizedState=g,a.lanes===0&&(a.updateQueue.baseState=g)}var Wc={enqueueSetState:function(a,u,g){a=a._reactInternals;var w=Eo(),I=ul(w);I.payload=u,g!=null&&(I.callback=g),u=wo(a,I,w),u!==null&&(La(u,a,w),tc(u,a,w))},enqueueReplaceState:function(a,u,g){a=a._reactInternals;var w=Eo(),I=ul(w);I.tag=1,I.payload=u,g!=null&&(I.callback=g),u=wo(a,I,w),u!==null&&(La(u,a,w),tc(u,a,w))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var g=Eo(),w=ul(g);w.tag=2,u!=null&&(w.callback=u),u=wo(a,w,g),u!==null&&(La(u,a,g),tc(u,a,g))}};function my(a,u,g,w,I,P,Z){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(w,P,Z):u.prototype&&u.prototype.isPureReactComponent?!Bl(g,w)||!Bl(I,P):!0}function zu(a,u,g,w){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,w),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,w),u.state!==a&&Wc.enqueueReplaceState(u,u.state,null)}function Xo(a,u){var g=u;if("ref"in u){g={};for(var w in u)w!=="ref"&&(g[w]=u[w])}if(a=a.defaultProps){g===u&&(g=z({},g));for(var I in a)g[I]===void 0&&(g[I]=a[I])}return g}function gy(a){Ms(a)}function M0(a){console.error(a)}function Lm(a){Ms(a)}function bp(a,u){try{var g=a.onUncaughtError;g(u.value,{componentStack:u.stack})}catch(w){setTimeout(function(){throw w})}}function xp(a,u,g){try{var w=a.onCaughtError;w(g.value,{componentStack:g.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function zm(a,u,g){return g=ul(g),g.tag=3,g.payload={element:null},g.callback=function(){bp(a,u)},g}function C0(a){return a=ul(a),a.tag=3,a}function Nm(a,u,g,w){var I=g.type.getDerivedStateFromError;if(typeof I=="function"){var P=w.value;a.payload=function(){return I(P)},a.callback=function(){xp(u,g,w)}}var Z=g.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(a.callback=function(){xp(u,g,w),typeof I!="function"&&(tu===null?tu=new Set([this]):tu.add(this));var se=w.stack;this.componentDidCatch(w.value,{componentStack:se!==null?se:""})})}function Zb(a,u,g,w,I){if(g.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(u=g.alternate,u!==null&&bo(u,g,I,!0),g=Si.current,g!==null){switch(g.tag){case 31:case 13:return Ka===null?Wm():g.alternate===null&&wr===0&&(wr=3),g.flags&=-257,g.flags|=65536,g.lanes=I,w===Wl?g.flags|=16384:(u=g.updateQueue,u===null?g.updateQueue=new Set([w]):u.add(w),jp(a,w,I)),!1;case 22:return g.flags|=65536,w===Wl?g.flags|=16384:(u=g.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([w])},g.updateQueue=u):(g=u.retryQueue,g===null?u.retryQueue=new Set([w]):g.add(w)),jp(a,w,I)),!1}throw Error(h(435,g.tag))}return jp(a,w,I),Wm(),!1}if(Nn)return u=Si.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=I,w!==Zi&&(a=Error(h(422),{cause:w}),Ds(xa(a,g)))):(w!==Zi&&(u=Error(h(423),{cause:w}),Ds(xa(u,g))),a=a.current.alternate,a.flags|=65536,I&=-I,a.lanes|=I,w=xa(w,g),I=zm(a.stateNode,w,I),Vh(a,I),wr!==4&&(wr=2)),!1;var P=Error(h(520),{cause:w});if(P=xa(P,g),nd===null?nd=[P]:nd.push(P),wr!==4&&(wr=2),u===null)return!0;w=xa(w,g),g=u;do{switch(g.tag){case 3:return g.flags|=65536,a=I&-I,g.lanes|=a,a=zm(g.stateNode,w,a),Vh(g,a),!1;case 1:if(u=g.type,P=g.stateNode,(g.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(tu===null||!tu.has(P))))return g.flags|=65536,I&=-I,g.lanes|=I,I=C0(I),Nm(I,a,g,w),Vh(g,I),!1}g=g.return}while(g!==null);return!1}var wp=Error(h(461)),kr=!1;function ha(a,u,g,w){u.child=a===null?_p(u,null,g,w):ec(u,a.child,g,w)}function qh(a,u,g,w,I){g=g.render;var P=u.ref;if("ref"in w){var Z={};for(var se in w)se!=="ref"&&(Z[se]=w[se])}else Z=w;return Yl(u),w=Zh(a,u,g,Z,P,I),se=t(),a!==null&&!kr?(l(a,u,I),yl(a,u,I)):(Nn&&se&&Fc(u),u.flags|=1,ha(a,u,w,I),u.child)}function D0(a,u,g,w,I){if(a===null){var P=g.type;return typeof P=="function"&&!Rh(P)&&P.defaultProps===void 0&&g.compare===null?(u.tag=15,u.type=P,Xh(a,u,P,w,I)):(a=Nc(g.type,null,w,u,u.mode,I),a.ref=u.ref,a.return=u,u.child=a)}if(P=a.child,!xy(a,I)){var Z=P.memoizedProps;if(g=g.compare,g=g!==null?g:Bl,g(Z,w)&&a.ref===u.ref)return yl(a,u,I)}return u.flags|=1,a=qa(P,w),a.ref=u.ref,a.return=u,u.child=a}function Xh(a,u,g,w,I){if(a!==null){var P=a.memoizedProps;if(Bl(P,w)&&a.ref===u.ref)if(kr=!1,u.pendingProps=w=P,xy(a,I))(a.flags&131072)!==0&&(kr=!0);else return u.lanes=a.lanes,yl(a,u,I)}return Ep(a,u,g,w,I)}function Tp(a,u,g,w){var I=w.children,P=a!==null?a.memoizedState:null;if(a===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((u.flags&128)!==0){if(P=P!==null?P.baseLanes|g:g,a!==null){for(w=u.child=a.child,I=0;w!==null;)I=I|w.lanes|w.childLanes,w=w.sibling;w=I&~P}else w=0,u.child=null;return I0(a,u,P,g,w)}if((g&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},a!==null&&xo(u,P!==null?P.cachePool:null),P!==null?Yc(u,P):tf(),Pm(u);else return w=u.lanes=536870912,I0(a,u,P!==null?P.baseLanes|g:g,g,w)}else P!==null?(xo(u,P.cachePool),Yc(u,P),nc(),u.memoizedState=null):(a!==null&&xo(u,null),tf(),nc());return ha(a,u,I,g),u.child}function Nu(a,u){return a!==null&&a.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function I0(a,u,g,w,I){var P=Uc();return P=P===null?null:{parent:Ti._currentValue,pool:P},u.memoizedState={baseLanes:g,cachePool:P},a!==null&&xo(u,null),tf(),Pm(u),a!==null&&bo(a,u,w,!0),u.childLanes=I,null}function jm(a,u){return u=Mp({mode:u.mode,children:u.children},a.mode),u.ref=a.ref,a.child=u,u.return=a,u}function R0(a,u,g){return ec(u,a.child,null,g),a=jm(u,u.pendingProps),a.flags|=2,Ja(u),u.memoizedState=null,a}function Yb(a,u,g){var w=u.pendingProps,I=(u.flags&128)!==0;if(u.flags&=-129,a===null){if(Nn){if(w.mode==="hidden")return a=jm(u,w),u.lanes=536870912,Nu(null,a);if(hl(u),(a=li)?(a=sv(a,Xa),a=a!==null&&a.data==="&"?a:null,a!==null&&(u.memoizedState={dehydrated:a,treeContext:Fo!==null?{id:Cs,overflow:Da}:null,retryLane:536870912,hydrationErrors:null},g=Kd(a),g.return=u,u.child=g,br=u,li=null)):a=null,a===null)throw Ia(u);return u.lanes=536870912,null}return jm(u,w)}var P=a.memoizedState;if(P!==null){var Z=P.dehydrated;if(hl(u),I)if(u.flags&256)u.flags&=-257,u=R0(a,u,g);else if(u.memoizedState!==null)u.child=a.child,u.flags|=128,u=null;else throw Error(h(558));else if(kr||bo(a,u,g,!1),I=(g&a.childLanes)!==0,kr||I){if(w=Mi,w!==null&&(Z=_r(w,g),Z!==0&&Z!==P.retryLane))throw P.retryLane=Z,vo(a,Z),La(w,a,Z),wp;Wm(),u=R0(a,u,g)}else a=P.treeContext,li=Ao(Z.nextSibling),br=u,Nn=!0,Bo=null,Xa=!1,a!==null&&Oh(u,a),u=jm(u,w),u.flags|=4096;return u}return a=qa(a.child,{mode:w.mode,children:w.children}),a.ref=u.ref,u.child=a,a.return=u,a}function Sp(a,u){var g=u.ref;if(g===null)a!==null&&a.ref!==null&&(u.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(h(284));(a===null||a.ref!==g)&&(u.flags|=4194816)}}function Ep(a,u,g,w,I){return Yl(u),g=Zh(a,u,g,w,void 0,I),w=t(),a!==null&&!kr?(l(a,u,I),yl(a,u,I)):(Nn&&w&&Fc(u),u.flags|=1,ha(a,u,g,I),u.child)}function yy(a,u,g,w,I,P){return Yl(u),u.updateQueue=null,g=rf(u,w,g,I),Yh(a),w=t(),a!==null&&!kr?(l(a,u,P),yl(a,u,P)):(Nn&&w&&Fc(u),u.flags|=1,ha(a,u,g,P),u.child)}function _y(a,u,g,w,I){if(Yl(u),u.stateNode===null){var P=bn,Z=g.contextType;typeof Z=="object"&&Z!==null&&(P=Hr(Z)),P=new g(w,P),u.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=Wc,u.stateNode=P,P._reactInternals=u,P=u.stateNode,P.props=w,P.state=u.memoizedState,P.refs={},ks(u),Z=g.contextType,P.context=typeof Z=="object"&&Z!==null?Hr(Z):bn,P.state=u.memoizedState,Z=g.getDerivedStateFromProps,typeof Z=="function"&&(Hh(u,g,Z,w),P.state=u.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(Z=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),Z!==P.state&&Wc.enqueueReplaceState(P,P.state,null),Zc(u,w,P,I),ku(),P.state=u.memoizedState),typeof P.componentDidMount=="function"&&(u.flags|=4194308),w=!0}else if(a===null){P=u.stateNode;var se=u.memoizedProps,Ie=Xo(g,se);P.props=Ie;var We=P.context,lt=g.contextType;Z=bn,typeof lt=="object"&&lt!==null&&(Z=Hr(lt));var mt=g.getDerivedStateFromProps;lt=typeof mt=="function"||typeof P.getSnapshotBeforeUpdate=="function",se=u.pendingProps!==se,lt||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(se||We!==Z)&&zu(u,P,w,Z),cl=!1;var et=u.memoizedState;P.state=et,Zc(u,w,P,I),ku(),We=u.memoizedState,se||et!==We||cl?(typeof mt=="function"&&(Hh(u,g,mt,w),We=u.memoizedState),(Ie=cl||my(u,g,Ie,w,et,We,Z))?(lt||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(u.flags|=4194308)):(typeof P.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=w,u.memoizedState=We),P.props=w,P.state=We,P.context=Z,w=Ie):(typeof P.componentDidMount=="function"&&(u.flags|=4194308),w=!1)}else{P=u.stateNode,ci(a,u),Z=u.memoizedProps,lt=Xo(g,Z),P.props=lt,mt=u.pendingProps,et=P.context,We=g.contextType,Ie=bn,typeof We=="object"&&We!==null&&(Ie=Hr(We)),se=g.getDerivedStateFromProps,(We=typeof se=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Z!==mt||et!==Ie)&&zu(u,P,w,Ie),cl=!1,et=u.memoizedState,P.state=et,Zc(u,w,P,I),ku();var nt=u.memoizedState;Z!==mt||et!==nt||cl||a!==null&&a.dependencies!==null&&Lh(a.dependencies)?(typeof se=="function"&&(Hh(u,g,se,w),nt=u.memoizedState),(lt=cl||my(u,g,lt,w,et,nt,Ie)||a!==null&&a.dependencies!==null&&Lh(a.dependencies))?(We||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(w,nt,Ie),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(w,nt,Ie)),typeof P.componentDidUpdate=="function"&&(u.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof P.componentDidUpdate!="function"||Z===a.memoizedProps&&et===a.memoizedState||(u.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&et===a.memoizedState||(u.flags|=1024),u.memoizedProps=w,u.memoizedState=nt),P.props=w,P.state=nt,P.context=Ie,w=lt):(typeof P.componentDidUpdate!="function"||Z===a.memoizedProps&&et===a.memoizedState||(u.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&et===a.memoizedState||(u.flags|=1024),w=!1)}return P=w,Sp(a,u),w=(u.flags&128)!==0,P||w?(P=u.stateNode,g=w&&typeof g.getDerivedStateFromError!="function"?null:P.render(),u.flags|=1,a!==null&&w?(u.child=ec(u,a.child,null,I),u.child=ec(u,null,g,I)):ha(a,u,g,I),u.memoizedState=P.state,a=u.child):a=yl(a,u,I),a}function k0(a,u,g,w){return ol(),u.flags|=256,ha(a,u,g,w),u.child}var vy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fm(a){return{baseLanes:a,cachePool:Rt()}}function Bm(a,u,g){return a=a!==null?a.childLanes&~g:0,u&&(a|=Qo),a}function O0(a,u,g){var w=u.pendingProps,I=!1,P=(u.flags&128)!==0,Z;if((Z=P)||(Z=a!==null&&a.memoizedState===null?!1:(Li.current&2)!==0),Z&&(I=!0,u.flags&=-129),Z=(u.flags&32)!==0,u.flags&=-33,a===null){if(Nn){if(I?qr(u):nc(),(a=li)?(a=sv(a,Xa),a=a!==null&&a.data!=="&"?a:null,a!==null&&(u.memoizedState={dehydrated:a,treeContext:Fo!==null?{id:Cs,overflow:Da}:null,retryLane:536870912,hydrationErrors:null},g=Kd(a),g.return=u,u.child=g,br=u,li=null)):a=null,a===null)throw Ia(u);return qu(a)?u.lanes=32:u.lanes=536870912,null}var se=w.children;return w=w.fallback,I?(nc(),I=u.mode,se=Mp({mode:"hidden",children:se},I),w=nl(w,I,g,null),se.return=u,w.return=u,se.sibling=w,u.child=se,w=u.child,w.memoizedState=Fm(g),w.childLanes=Bm(a,Z,g),u.memoizedState=vy,Nu(null,w)):(qr(u),Ap(u,se))}var Ie=a.memoizedState;if(Ie!==null&&(se=Ie.dehydrated,se!==null)){if(P)u.flags&256?(qr(u),u.flags&=-257,u=Cp(a,u,g)):u.memoizedState!==null?(nc(),u.child=a.child,u.flags|=128,u=null):(nc(),se=w.fallback,I=u.mode,w=Mp({mode:"visible",children:w.children},I),se=nl(se,I,g,null),se.flags|=2,w.return=u,se.return=u,w.sibling=se,u.child=w,ec(u,a.child,null,g),w=u.child,w.memoizedState=Fm(g),w.childLanes=Bm(a,Z,g),u.memoizedState=vy,u=Nu(null,w));else if(qr(u),qu(se)){if(Z=se.nextSibling&&se.nextSibling.dataset,Z)var We=Z.dgst;Z=We,w=Error(h(419)),w.stack="",w.digest=Z,Ds({value:w,source:null,stack:null}),u=Cp(a,u,g)}else if(kr||bo(a,u,g,!1),Z=(g&a.childLanes)!==0,kr||Z){if(Z=Mi,Z!==null&&(w=_r(Z,g),w!==0&&w!==Ie.retryLane))throw Ie.retryLane=w,vo(a,w),La(Z,a,w),wp;i_(se)||Wm(),u=Cp(a,u,g)}else i_(se)?(u.flags|=192,u.child=a.child,u=null):(a=Ie.treeContext,li=Ao(se.nextSibling),br=u,Nn=!0,Bo=null,Xa=!1,a!==null&&Oh(u,a),u=Ap(u,w.children),u.flags|=4096);return u}return I?(nc(),se=w.fallback,I=u.mode,Ie=a.child,We=Ie.sibling,w=qa(Ie,{mode:"hidden",children:w.children}),w.subtreeFlags=Ie.subtreeFlags&65011712,We!==null?se=qa(We,se):(se=nl(se,I,g,null),se.flags|=2),se.return=u,w.return=u,w.sibling=se,u.child=w,Nu(null,w),w=u.child,se=a.child.memoizedState,se===null?se=Fm(g):(I=se.cachePool,I!==null?(Ie=Ti._currentValue,I=I.parent!==Ie?{parent:Ie,pool:Ie}:I):I=Rt(),se={baseLanes:se.baseLanes|g,cachePool:I}),w.memoizedState=se,w.childLanes=Bm(a,Z,g),u.memoizedState=vy,Nu(a.child,w)):(qr(u),g=a.child,a=g.sibling,g=qa(g,{mode:"visible",children:w.children}),g.return=u,g.sibling=null,a!==null&&(Z=u.deletions,Z===null?(u.deletions=[a],u.flags|=16):Z.push(a)),u.child=g,u.memoizedState=null,g)}function Ap(a,u){return u=Mp({mode:"visible",children:u},a.mode),u.return=a,a.child=u}function Mp(a,u){return a=Ha(22,a,null,u),a.lanes=0,a}function Cp(a,u,g){return ec(u,a.child,null,g),a=Ap(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function sf(a,u,g){a.lanes|=u;var w=a.alternate;w!==null&&(w.lanes|=u),Ph(a.return,u,g)}function Ta(a,u,g,w,I,P){var Z=a.memoizedState;Z===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:w,tail:g,tailMode:I,treeForkCount:P}:(Z.isBackwards=u,Z.rendering=null,Z.renderingStartTime=0,Z.last=w,Z.tail=g,Z.tailMode=I,Z.treeForkCount=P)}function by(a,u,g){var w=u.pendingProps,I=w.revealOrder,P=w.tail;w=w.children;var Z=Li.current,se=(Z&2)!==0;if(se?(Z=Z&1|2,u.flags|=128):Z&=1,dt(Li,Z),ha(a,u,w,g),w=Nn?$l:0,!se&&a!==null&&(a.flags&128)!==0)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&sf(a,g,u);else if(a.tag===19)sf(a,g,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(I){case"forwards":for(g=u.child,I=null;g!==null;)a=g.alternate,a!==null&&Ei(a)===null&&(I=g),g=g.sibling;g=I,g===null?(I=u.child,u.child=null):(I=g.sibling,g.sibling=null),Ta(u,!1,I,g,P,w);break;case"backwards":case"unstable_legacy-backwards":for(g=null,I=u.child,u.child=null;I!==null;){if(a=I.alternate,a!==null&&Ei(a)===null){u.child=I;break}a=I.sibling,I.sibling=g,g=I,I=a}Ta(u,!0,g,null,P,w);break;case"together":Ta(u,!1,null,null,void 0,w);break;default:u.memoizedState=null}return u.child}function yl(a,u,g){if(a!==null&&(u.dependencies=a.dependencies),Gu|=u.lanes,(g&u.childLanes)===0)if(a!==null){if(bo(a,u,g,!1),(g&u.childLanes)===0)return null}else return null;if(a!==null&&u.child!==a.child)throw Error(h(153));if(u.child!==null){for(a=u.child,g=qa(a,a.pendingProps),u.child=g,g.return=u;a.sibling!==null;)a=a.sibling,g=g.sibling=qa(a,a.pendingProps),g.return=u;g.sibling=null}return u.child}function xy(a,u){return(a.lanes&u)!==0?!0:(a=a.dependencies,!!(a!==null&&Lh(a)))}function P0(a,u,g){switch(u.tag){case 3:cn(u,u.stateNode.containerInfo),ll(u,Ti,a.memoizedState.cache),ol();break;case 27:case 5:lr(u);break;case 4:cn(u,u.stateNode.containerInfo);break;case 10:ll(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,hl(u),null;break;case 13:var w=u.memoizedState;if(w!==null)return w.dehydrated!==null?(qr(u),u.flags|=128,null):(g&u.child.childLanes)!==0?O0(a,u,g):(qr(u),a=yl(a,u,g),a!==null?a.sibling:null);qr(u);break;case 19:var I=(a.flags&128)!==0;if(w=(g&u.childLanes)!==0,w||(bo(a,u,g,!1),w=(g&u.childLanes)!==0),I){if(w)return by(a,u,g);u.flags|=128}if(I=u.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),dt(Li,Li.current),w)break;return null;case 22:return u.lanes=0,Tp(a,u,g,u.pendingProps);case 24:ll(u,Ti,a.memoizedState.cache)}return yl(a,u,g)}function L0(a,u,g){if(a!==null)if(a.memoizedProps!==u.pendingProps)kr=!0;else{if(!xy(a,g)&&(u.flags&128)===0)return kr=!1,P0(a,u,g);kr=(a.flags&131072)!==0}else kr=!1,Nn&&(u.flags&1048576)!==0&&pp(u,$l,u.index);switch(u.lanes=0,u.tag){case 16:e:{var w=u.pendingProps;if(a=yn(u.elementType),u.type=a,typeof a=="function")Rh(a)?(w=Xo(a,w),u.tag=1,u=_y(null,u,a,w,g)):(u.tag=0,u=Ep(null,u,a,w,g));else{if(a!=null){var I=a.$$typeof;if(I===ke){u.tag=11,u=qh(null,u,a,w,g);break e}else if(I===Fe){u.tag=14,u=D0(null,u,a,w,g);break e}}throw u=Zt(a)||a,Error(h(306,u,""))}}return u;case 0:return Ep(a,u,u.type,u.pendingProps,g);case 1:return w=u.type,I=Xo(w,u.pendingProps),_y(a,u,w,I,g);case 3:e:{if(cn(u,u.stateNode.containerInfo),a===null)throw Error(h(387));w=u.pendingProps;var P=u.memoizedState;I=P.element,ci(a,u),Zc(u,w,null,g);var Z=u.memoizedState;if(w=Z.cache,ll(u,Ti,w),w!==P.cache&&Zl(u,[Ti],g,!0),ku(),w=Z.element,P.isDehydrated)if(P={element:w,isDehydrated:!1,cache:Z.cache},u.updateQueue.baseState=P,u.memoizedState=P,u.flags&256){u=k0(a,u,w,g);break e}else if(w!==I){I=xa(Error(h(424)),u),Ds(I),u=k0(a,u,w,g);break e}else{switch(a=u.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(li=Ao(a.firstChild),br=u,Nn=!0,Bo=null,Xa=!0,g=_p(u,null,w,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(ol(),w===I){u=yl(a,u,g);break e}ha(a,u,w,g)}u=u.child}return u;case 26:return Sp(a,u),a===null?(g=dv(u.type,null,u.pendingProps,null))?u.memoizedState=g:Nn||(g=u.type,a=u.pendingProps,w=lg(jt.current).createElement(g),w[$n]=u,w[vt]=a,Pr(w,g,a),$i(w),u.stateNode=w):u.memoizedState=dv(u.type,a.memoizedProps,u.pendingProps,a.memoizedState),null;case 27:return lr(u),a===null&&Nn&&(w=u.stateNode=lv(u.type,u.pendingProps,jt.current),br=u,Xa=!0,I=li,xl(u.type)?(dg=I,li=Ao(w.firstChild)):li=I),ha(a,u,u.pendingProps.children,g),Sp(a,u),a===null&&(u.flags|=4194304),u.child;case 5:return a===null&&Nn&&((I=w=li)&&(w=hg(w,u.type,u.pendingProps,Xa),w!==null?(u.stateNode=w,br=u,li=Ao(w.firstChild),Xa=!1,I=!0):I=!1),I||Ia(u)),lr(u),I=u.type,P=u.pendingProps,Z=a!==null?a.memoizedProps:null,w=P.children,cg(I,P)?w=null:Z!==null&&cg(I,Z)&&(u.flags|=32),u.memoizedState!==null&&(I=Zh(a,u,b,null,null,g),Ke._currentValue=I),Sp(a,u),ha(a,u,w,g),u.child;case 6:return a===null&&Nn&&((a=g=li)&&(g=ox(g,u.pendingProps,Xa),g!==null?(u.stateNode=g,br=u,li=null,a=!0):a=!1),a||Ia(u)),null;case 13:return O0(a,u,g);case 4:return cn(u,u.stateNode.containerInfo),w=u.pendingProps,a===null?u.child=ec(u,null,w,g):ha(a,u,w,g),u.child;case 11:return qh(a,u,u.type,u.pendingProps,g);case 7:return ha(a,u,u.pendingProps,g),u.child;case 8:return ha(a,u,u.pendingProps.children,g),u.child;case 12:return ha(a,u,u.pendingProps.children,g),u.child;case 10:return w=u.pendingProps,ll(u,u.type,w.value),ha(a,u,w.children,g),u.child;case 9:return I=u.type._context,w=u.pendingProps.children,Yl(u),I=Hr(I),w=w(I),u.flags|=1,ha(a,u,w,g),u.child;case 14:return D0(a,u,u.type,u.pendingProps,g);case 15:return Xh(a,u,u.type,u.pendingProps,g);case 19:return by(a,u,g);case 31:return Yb(a,u,g);case 22:return Tp(a,u,g,u.pendingProps);case 24:return Yl(u),w=Hr(Ti),a===null?(I=Uc(),I===null&&(I=Mi,P=Nh(),I.pooledCache=P,P.refCount++,P!==null&&(I.pooledCacheLanes|=g),I=P),u.memoizedState={parent:w,cache:I},ks(u),ll(u,Ti,I)):((a.lanes&g)!==0&&(ci(a,u),Zc(u,null,null,g),ku()),I=a.memoizedState,P=u.memoizedState,I.parent!==w?(I={parent:w,cache:w},u.memoizedState=I,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=I),ll(u,Ti,w)):(w=P.cache,ll(u,Ti,w),w!==I.cache&&Zl(u,[Ti],g,!0))),ha(a,u,u.pendingProps.children,g),u.child;case 29:throw u.pendingProps}throw Error(h(156,u.tag))}function Qc(a){a.flags|=4}function Um(a,u,g,w,I){if((u=(a.mode&32)!==0)&&(u=!1),u){if(a.flags|=16777216,(I&335544128)===I)if(a.stateNode.complete)a.flags|=8192;else if(Y0())a.flags|=8192;else throw Rs=Wl,jh}else a.flags&=-16777217}function z0(a,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!W(u))if(Y0())a.flags|=8192;else throw Rs=Wl,jh}function lf(a,u){u!==null&&(a.flags|=4),a.flags&16384&&(u=a.tag!==22?jn():536870912,a.lanes|=u,td|=u)}function cf(a,u){if(!Nn)switch(a.tailMode){case"hidden":u=a.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?a.tail=null:g.sibling=null;break;case"collapsed":g=a.tail;for(var w=null;g!==null;)g.alternate!==null&&(w=g),g=g.sibling;w===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:w.sibling=null}}function Hi(a){var u=a.alternate!==null&&a.alternate.child===a.child,g=0,w=0;if(u)for(var I=a.child;I!==null;)g|=I.lanes|I.childLanes,w|=I.subtreeFlags&65011712,w|=I.flags&65011712,I.return=a,I=I.sibling;else for(I=a.child;I!==null;)g|=I.lanes|I.childLanes,w|=I.subtreeFlags,w|=I.flags,I.return=a,I=I.sibling;return a.subtreeFlags|=w,a.childLanes=g,u}function Hb(a,u,g){var w=u.pendingProps;switch(Mu(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hi(u),null;case 1:return Hi(u),null;case 3:return g=u.stateNode,w=null,a!==null&&(w=a.memoizedState.cache),u.memoizedState.cache!==w&&(u.flags|=2048),Vo(Ti),mn(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(al(u)?Qc(u):a===null||a.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,sl())),Hi(u),null;case 26:var I=u.type,P=u.memoizedState;return a===null?(Qc(u),P!==null?(Hi(u),z0(u,P)):(Hi(u),Um(u,I,null,w,g))):P?P!==a.memoizedState?(Qc(u),Hi(u),z0(u,P)):(Hi(u),u.flags&=-16777217):(a=a.memoizedProps,a!==w&&Qc(u),Hi(u),Um(u,I,a,w,g)),null;case 27:if(cr(u),g=jt.current,I=u.type,a!==null&&u.stateNode!=null)a.memoizedProps!==w&&Qc(u);else{if(!w){if(u.stateNode===null)throw Error(h(166));return Hi(u),null}a=_t.current,al(u)?Wa(u):(a=lv(I,w,g),u.stateNode=a,Qc(u))}return Hi(u),null;case 5:if(cr(u),I=u.type,a!==null&&u.stateNode!=null)a.memoizedProps!==w&&Qc(u);else{if(!w){if(u.stateNode===null)throw Error(h(166));return Hi(u),null}if(P=_t.current,al(u))Wa(u);else{var Z=lg(jt.current);switch(P){case 1:P=Z.createElementNS("http://www.w3.org/2000/svg",I);break;case 2:P=Z.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;default:switch(I){case"svg":P=Z.createElementNS("http://www.w3.org/2000/svg",I);break;case"math":P=Z.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;case"script":P=Z.createElement("div"),P.innerHTML="<script><\/script>",P=P.removeChild(P.firstChild);break;case"select":P=typeof w.is=="string"?Z.createElement("select",{is:w.is}):Z.createElement("select"),w.multiple?P.multiple=!0:w.size&&(P.size=w.size);break;default:P=typeof w.is=="string"?Z.createElement(I,{is:w.is}):Z.createElement(I)}}P[$n]=u,P[vt]=w;e:for(Z=u.child;Z!==null;){if(Z.tag===5||Z.tag===6)P.appendChild(Z.stateNode);else if(Z.tag!==4&&Z.tag!==27&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===u)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===u)break e;Z=Z.return}Z.sibling.return=Z.return,Z=Z.sibling}u.stateNode=P;e:switch(Pr(P,I,w),I){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&Qc(u)}}return Hi(u),Um(u,u.type,a===null?null:a.memoizedProps,u.pendingProps,g),null;case 6:if(a&&u.stateNode!=null)a.memoizedProps!==w&&Qc(u);else{if(typeof w!="string"&&u.stateNode===null)throw Error(h(166));if(a=jt.current,al(u)){if(a=u.stateNode,g=u.memoizedProps,w=null,I=br,I!==null)switch(I.tag){case 27:case 5:w=I.memoizedProps}a[$n]=u,a=!!(a.nodeValue===g||w!==null&&w.suppressHydrationWarning===!0||Ky(a.nodeValue,g)),a||Ia(u,!0)}else a=lg(a).createTextNode(w),a[$n]=u,u.stateNode=a}return Hi(u),null;case 31:if(g=u.memoizedState,a===null||a.memoizedState!==null){if(w=al(u),g!==null){if(a===null){if(!w)throw Error(h(318));if(a=u.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(h(557));a[$n]=u}else ol(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Hi(u),a=!1}else g=sl(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),a=!0;if(!a)return u.flags&256?(Ja(u),u):(Ja(u),null);if((u.flags&128)!==0)throw Error(h(558))}return Hi(u),null;case 13:if(w=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(I=al(u),w!==null&&w.dehydrated!==null){if(a===null){if(!I)throw Error(h(318));if(I=u.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(h(317));I[$n]=u}else ol(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Hi(u),I=!1}else I=sl(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=I),I=!0;if(!I)return u.flags&256?(Ja(u),u):(Ja(u),null)}return Ja(u),(u.flags&128)!==0?(u.lanes=g,u):(g=w!==null,a=a!==null&&a.memoizedState!==null,g&&(w=u.child,I=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(I=w.alternate.memoizedState.cachePool.pool),P=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(P=w.memoizedState.cachePool.pool),P!==I&&(w.flags|=2048)),g!==a&&g&&(u.child.flags|=8192),lf(u,u.updateQueue),Hi(u),null);case 4:return mn(),a===null&&ig(u.stateNode.containerInfo),Hi(u),null;case 10:return Vo(u.type),Hi(u),null;case 19:if(Qe(Li),w=u.memoizedState,w===null)return Hi(u),null;if(I=(u.flags&128)!==0,P=w.rendering,P===null)if(I)cf(w,!1);else{if(wr!==0||a!==null&&(a.flags&128)!==0)for(a=u.child;a!==null;){if(P=Ei(a),P!==null){for(u.flags|=128,cf(w,!1),a=P.updateQueue,u.updateQueue=a,lf(u,a),u.subtreeFlags=0,a=g,g=u.child;g!==null;)Om(g,a),g=g.sibling;return dt(Li,Li.current&1|2),Nn&&rl(u,w.treeForkCount),u.child}a=a.sibling}w.tail!==null&&Oi()>id&&(u.flags|=128,I=!0,cf(w,!1),u.lanes=4194304)}else{if(!I)if(a=Ei(P),a!==null){if(u.flags|=128,I=!0,a=a.updateQueue,u.updateQueue=a,lf(u,a),cf(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Nn)return Hi(u),null}else 2*Oi()-w.renderingStartTime>id&&g!==536870912&&(u.flags|=128,I=!0,cf(w,!1),u.lanes=4194304);w.isBackwards?(P.sibling=u.child,u.child=P):(a=w.last,a!==null?a.sibling=P:u.child=P,w.last=P)}return w.tail!==null?(a=w.tail,w.rendering=a,w.tail=a.sibling,w.renderingStartTime=Oi(),a.sibling=null,g=Li.current,dt(Li,I?g&1|2:g&1),Nn&&rl(u,w.treeForkCount),a):(Hi(u),null);case 22:case 23:return Ja(u),Ou(),w=u.memoizedState!==null,a!==null?a.memoizedState!==null!==w&&(u.flags|=8192):w&&(u.flags|=8192),w?(g&536870912)!==0&&(u.flags&128)===0&&(Hi(u),u.subtreeFlags&6&&(u.flags|=8192)):Hi(u),g=u.updateQueue,g!==null&&lf(u,g.retryQueue),g=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),w=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(w=u.memoizedState.cachePool.pool),w!==g&&(u.flags|=2048),a!==null&&Qe(ql),null;case 24:return g=null,a!==null&&(g=a.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),Vo(Ti),Hi(u),null;case 25:return null;case 30:return null}throw Error(h(156,u.tag))}function qb(a,u){switch(Mu(u),u.tag){case 1:return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return Vo(Ti),mn(),a=u.flags,(a&65536)!==0&&(a&128)===0?(u.flags=a&-65537|128,u):null;case 26:case 27:case 5:return cr(u),null;case 31:if(u.memoizedState!==null){if(Ja(u),u.alternate===null)throw Error(h(340));ol()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 13:if(Ja(u),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(h(340));ol()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return Qe(Li),null;case 4:return mn(),null;case 10:return Vo(u.type),null;case 22:case 23:return Ja(u),Ou(),a!==null&&Qe(ql),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 24:return Vo(Ti),null;case 25:return null;default:return null}}function N0(a,u){switch(Mu(u),u.tag){case 3:Vo(Ti),mn();break;case 26:case 27:case 5:cr(u);break;case 4:mn();break;case 31:u.memoizedState!==null&&Ja(u);break;case 13:Ja(u);break;case 19:Qe(Li);break;case 10:Vo(u.type);break;case 22:case 23:Ja(u),Ou(),a!==null&&Qe(ql);break;case 24:Vo(Ti)}}function ju(a,u){try{var g=u.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var I=w.next;g=I;do{if((g.tag&a)===a){w=void 0;var P=g.create,Z=g.inst;w=P(),Z.destroy=w}g=g.next}while(g!==I)}}catch(se){mi(u,u.return,se)}}function ac(a,u,g){try{var w=u.updateQueue,I=w!==null?w.lastEffect:null;if(I!==null){var P=I.next;w=P;do{if((w.tag&a)===a){var Z=w.inst,se=Z.destroy;if(se!==void 0){Z.destroy=void 0,I=u;var Ie=g,We=se;try{We()}catch(lt){mi(I,Ie,lt)}}}w=w.next}while(w!==P)}}catch(lt){mi(u,u.return,lt)}}function wy(a){var u=a.updateQueue;if(u!==null){var g=a.stateNode;try{Gh(u,g)}catch(w){mi(a,a.return,w)}}}function Fu(a,u,g){g.props=Xo(a.type,a.memoizedProps),g.state=a.memoizedState;try{g.componentWillUnmount()}catch(w){mi(a,u,w)}}function Kc(a,u){try{var g=a.ref;if(g!==null){switch(a.tag){case 26:case 27:case 5:var w=a.stateNode;break;case 30:w=a.stateNode;break;default:w=a.stateNode}typeof g=="function"?a.refCleanup=g(w):g.current=w}}catch(I){mi(a,u,I)}}function oc(a,u){var g=a.ref,w=a.refCleanup;if(g!==null)if(typeof w=="function")try{w()}catch(I){mi(a,u,I)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(I){mi(a,u,I)}else g.current=null}function j0(a){var u=a.type,g=a.memoizedProps,w=a.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":g.autoFocus&&w.focus();break e;case"img":g.src?w.src=g.src:g.srcSet&&(w.srcset=g.srcSet)}}catch(I){mi(a,a.return,I)}}function Ty(a,u,g){try{var w=a.stateNode;od(w,a.type,g,u),w[vt]=u}catch(I){mi(a,a.return,I)}}function F0(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&xl(a.type)||a.tag===4}function Sy(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||F0(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&xl(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Ey(a,u,g){var w=a.tag;if(w===5||w===6)a=a.stateNode,u?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(a,u):(u=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,u.appendChild(a),g=g._reactRootContainer,g!=null||u.onclick!==null||(u.onclick=Ga));else if(w!==4&&(w===27&&xl(a.type)&&(g=a.stateNode,u=null),a=a.child,a!==null))for(Ey(a,u,g),a=a.sibling;a!==null;)Ey(a,u,g),a=a.sibling}function Vm(a,u,g){var w=a.tag;if(w===5||w===6)a=a.stateNode,u?g.insertBefore(a,u):g.appendChild(a);else if(w!==4&&(w===27&&xl(a.type)&&(g=a.stateNode),a=a.child,a!==null))for(Vm(a,u,g),a=a.sibling;a!==null;)Vm(a,u,g),a=a.sibling}function Gm(a){var u=a.stateNode,g=a.memoizedProps;try{for(var w=a.type,I=u.attributes;I.length;)u.removeAttributeNode(I[0]);Pr(u,w,g),u[$n]=a,u[vt]=g}catch(P){mi(a,a.return,P)}}var Jc=!1,Or=!1,Wh=!1,B0=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function uf(a,u){if(a=a.containerInfo,og=Qt,a=Zn(a),qd(a)){if("selectionStart"in a)var g={start:a.selectionStart,end:a.selectionEnd};else e:{g=(g=a.ownerDocument)&&g.defaultView||window;var w=g.getSelection&&g.getSelection();if(w&&w.rangeCount!==0){g=w.anchorNode;var I=w.anchorOffset,P=w.focusNode;w=w.focusOffset;try{g.nodeType,P.nodeType}catch{g=null;break e}var Z=0,se=-1,Ie=-1,We=0,lt=0,mt=a,et=null;t:for(;;){for(var nt;mt!==g||I!==0&&mt.nodeType!==3||(se=Z+I),mt!==P||w!==0&&mt.nodeType!==3||(Ie=Z+w),mt.nodeType===3&&(Z+=mt.nodeValue.length),(nt=mt.firstChild)!==null;)et=mt,mt=nt;for(;;){if(mt===a)break t;if(et===g&&++We===I&&(se=Z),et===P&&++lt===w&&(Ie=Z),(nt=mt.nextSibling)!==null)break;mt=et,et=mt.parentNode}mt=nt}g=se===-1||Ie===-1?null:{start:se,end:Ie}}else g=null}g=g||{start:0,end:0}}else g=null;for(sg={focusedElem:a,selectionRange:g},Qt=!1,Fn=u;Fn!==null;)if(u=Fn,a=u.child,(u.subtreeFlags&1028)!==0&&a!==null)a.return=u,Fn=a;else for(;Fn!==null;){switch(u=Fn,P=u.alternate,a=u.flags,u.tag){case 0:if((a&4)!==0&&(a=u.updateQueue,a=a!==null?a.events:null,a!==null))for(g=0;g<a.length;g++)I=a[g],I.ref.impl=I.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&P!==null){a=void 0,g=u,I=P.memoizedProps,P=P.memoizedState,w=g.stateNode;try{var Yt=Xo(g.type,I);a=w.getSnapshotBeforeUpdate(Yt,P),w.__reactInternalSnapshotBeforeUpdate=a}catch(ln){mi(g,g.return,ln)}}break;case 3:if((a&1024)!==0){if(a=u.stateNode.containerInfo,g=a.nodeType,g===9)wf(a);else if(g===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":wf(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(h(163))}if(a=u.sibling,a!==null){a.return=u.return,Fn=a;break}Fn=u.return}}function Ay(a,u,g){var w=g.flags;switch(g.tag){case 0:case 11:case 15:eu(a,g),w&4&&ju(5,g);break;case 1:if(eu(a,g),w&4)if(a=g.stateNode,u===null)try{a.componentDidMount()}catch(Z){mi(g,g.return,Z)}else{var I=Xo(g.type,u.memoizedProps);u=u.memoizedState;try{a.componentDidUpdate(I,u,a.__reactInternalSnapshotBeforeUpdate)}catch(Z){mi(g,g.return,Z)}}w&64&&wy(g),w&512&&Kc(g,g.return);break;case 3:if(eu(a,g),w&64&&(a=g.updateQueue,a!==null)){if(u=null,g.child!==null)switch(g.child.tag){case 27:case 5:u=g.child.stateNode;break;case 1:u=g.child.stateNode}try{Gh(a,u)}catch(Z){mi(g,g.return,Z)}}break;case 27:u===null&&w&4&&Gm(g);case 26:case 5:eu(a,g),u===null&&w&4&&j0(g),w&512&&Kc(g,g.return);break;case 12:eu(a,g);break;case 31:eu(a,g),w&4&&hf(a,g);break;case 13:eu(a,g),w&4&&$m(a,g),w&64&&(a=g.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(g=Jb.bind(null,g),fa(a,g))));break;case 22:if(w=g.memoizedState!==null||Jc,!w){u=u!==null&&u.memoizedState!==null||Or,I=Jc;var P=Or;Jc=w,(Or=u)&&!P?Wo(a,g,(g.subtreeFlags&8772)!==0):eu(a,g),Jc=I,Or=P}break;case 30:break;default:eu(a,g)}}function Dp(a){var u=a.alternate;u!==null&&(a.alternate=null,Dp(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&kl(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Gi=null,da=!1;function sc(a,u,g){for(g=g.child;g!==null;)My(a,u,g),g=g.sibling}function My(a,u,g){if(we&&typeof we.onCommitFiberUnmount=="function")try{we.onCommitFiberUnmount(xe,g)}catch{}switch(g.tag){case 26:Or||oc(g,u),sc(a,u,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Or||oc(g,u);var w=Gi,I=da;xl(g.type)&&(Gi=g.stateNode,da=!1),sc(a,u,g),Tf(g.stateNode),Gi=w,da=I;break;case 5:Or||oc(g,u);case 6:if(w=Gi,I=da,Gi=null,sc(a,u,g),Gi=w,da=I,Gi!==null)if(da)try{(Gi.nodeType===9?Gi.body:Gi.nodeName==="HTML"?Gi.ownerDocument.body:Gi).removeChild(g.stateNode)}catch(P){mi(g,u,P)}else try{Gi.removeChild(g.stateNode)}catch(P){mi(g,u,P)}break;case 18:Gi!==null&&(da?(a=Gi,n_(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,g.stateNode),Na(a)):n_(Gi,g.stateNode));break;case 4:w=Gi,I=da,Gi=g.stateNode.containerInfo,da=!0,sc(a,u,g),Gi=w,da=I;break;case 0:case 11:case 14:case 15:ac(2,g,u),Or||ac(4,g,u),sc(a,u,g);break;case 1:Or||(oc(g,u),w=g.stateNode,typeof w.componentWillUnmount=="function"&&Fu(g,u,w)),sc(a,u,g);break;case 21:sc(a,u,g);break;case 22:Or=(w=Or)||g.memoizedState!==null,sc(a,u,g),Or=w;break;default:sc(a,u,g)}}function hf(a,u){if(u.memoizedState===null&&(a=u.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Na(a)}catch(g){mi(u,u.return,g)}}}function $m(a,u){if(u.memoizedState===null&&(a=u.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Na(a)}catch(g){mi(u,u.return,g)}}function df(a){switch(a.tag){case 31:case 13:case 19:var u=a.stateNode;return u===null&&(u=a.stateNode=new B0),u;case 22:return a=a.stateNode,u=a._retryCache,u===null&&(u=a._retryCache=new B0),u;default:throw Error(h(435,a.tag))}}function Qh(a,u){var g=df(a);u.forEach(function(w){if(!g.has(w)){g.add(w);var I=ex.bind(null,a,w);w.then(I,I)}})}function na(a,u){var g=u.deletions;if(g!==null)for(var w=0;w<g.length;w++){var I=g[w],P=a,Z=u,se=Z;e:for(;se!==null;){switch(se.tag){case 27:if(xl(se.type)){Gi=se.stateNode,da=!1;break e}break;case 5:Gi=se.stateNode,da=!1;break e;case 3:case 4:Gi=se.stateNode.containerInfo,da=!0;break e}se=se.return}if(Gi===null)throw Error(h(160));My(P,Z,I),Gi=null,da=!1,P=I.alternate,P!==null&&(P.return=null),I.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)U0(u,a),u=u.sibling}var no=null;function U0(a,u){var g=a.alternate,w=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:na(u,a),io(a),w&4&&(ac(3,a,a.return),ju(3,a),ac(5,a,a.return));break;case 1:na(u,a),io(a),w&512&&(Or||g===null||oc(g,g.return)),w&64&&Jc&&(a=a.updateQueue,a!==null&&(w=a.callbacks,w!==null&&(g=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=g===null?w:g.concat(w))));break;case 26:var I=no;if(na(u,a),io(a),w&512&&(Or||g===null||oc(g,g.return)),w&4){var P=g!==null?g.memoizedState:null;if(w=a.memoizedState,g===null)if(w===null)if(a.stateNode===null){e:{w=a.type,g=a.memoizedProps,I=I.ownerDocument||I;t:switch(w){case"title":P=I.getElementsByTagName("title")[0],(!P||P[un]||P[$n]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=I.createElement(w),I.head.insertBefore(P,I.querySelector("head > title"))),Pr(P,w,g),P[$n]=a,$i(P),w=P;break e;case"link":var Z=V("link","href",I).get(w+(g.href||""));if(Z){for(var se=0;se<Z.length;se++)if(P=Z[se],P.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&P.getAttribute("rel")===(g.rel==null?null:g.rel)&&P.getAttribute("title")===(g.title==null?null:g.title)&&P.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){Z.splice(se,1);break t}}P=I.createElement(w),Pr(P,w,g),I.head.appendChild(P);break;case"meta":if(Z=V("meta","content",I).get(w+(g.content||""))){for(se=0;se<Z.length;se++)if(P=Z[se],P.getAttribute("content")===(g.content==null?null:""+g.content)&&P.getAttribute("name")===(g.name==null?null:g.name)&&P.getAttribute("property")===(g.property==null?null:g.property)&&P.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&P.getAttribute("charset")===(g.charSet==null?null:g.charSet)){Z.splice(se,1);break t}}P=I.createElement(w),Pr(P,w,g),I.head.appendChild(P);break;default:throw Error(h(468,w))}P[$n]=a,$i(P),w=P}a.stateNode=w}else Y(I,a.type,a.stateNode);else a.stateNode=S(I,w,a.memoizedProps);else P!==w?(P===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):P.count--,w===null?Y(I,a.type,a.stateNode):S(I,w,a.memoizedProps)):w===null&&a.stateNode!==null&&Ty(a,a.memoizedProps,g.memoizedProps)}break;case 27:na(u,a),io(a),w&512&&(Or||g===null||oc(g,g.return)),g!==null&&w&4&&Ty(a,a.memoizedProps,g.memoizedProps);break;case 5:if(na(u,a),io(a),w&512&&(Or||g===null||oc(g,g.return)),a.flags&32){I=a.stateNode;try{ws(I,"")}catch(Yt){mi(a,a.return,Yt)}}w&4&&a.stateNode!=null&&(I=a.memoizedProps,Ty(a,I,g!==null?g.memoizedProps:I)),w&1024&&(Wh=!0);break;case 6:if(na(u,a),io(a),w&4){if(a.stateNode===null)throw Error(h(162));w=a.memoizedProps,g=a.stateNode;try{g.nodeValue=w}catch(Yt){mi(a,a.return,Yt)}}break;case 3:if(N=null,I=no,no=Yp(u.containerInfo),na(u,a),no=I,io(a),w&4&&g!==null&&g.memoizedState.isDehydrated)try{Na(u.containerInfo)}catch(Yt){mi(a,a.return,Yt)}Wh&&(Wh=!1,Bu(a));break;case 4:w=no,no=Yp(a.stateNode.containerInfo),na(u,a),io(a),no=w;break;case 12:na(u,a),io(a);break;case 31:na(u,a),io(a),w&4&&(w=a.updateQueue,w!==null&&(a.updateQueue=null,Qh(a,w)));break;case 13:na(u,a),io(a),a.child.flags&8192&&a.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Pp=Oi()),w&4&&(w=a.updateQueue,w!==null&&(a.updateQueue=null,Qh(a,w)));break;case 22:I=a.memoizedState!==null;var Ie=g!==null&&g.memoizedState!==null,We=Jc,lt=Or;if(Jc=We||I,Or=lt||Ie,na(u,a),Or=lt,Jc=We,io(a),w&8192)e:for(u=a.stateNode,u._visibility=I?u._visibility&-2:u._visibility|1,I&&(g===null||Ie||Jc||Or||Uu(a)),g=null,u=a;;){if(u.tag===5||u.tag===26){if(g===null){Ie=g=u;try{if(P=Ie.stateNode,I)Z=P.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{se=Ie.stateNode;var mt=Ie.memoizedProps.style,et=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;se.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(Yt){mi(Ie,Ie.return,Yt)}}}else if(u.tag===6){if(g===null){Ie=u;try{Ie.stateNode.nodeValue=I?"":Ie.memoizedProps}catch(Yt){mi(Ie,Ie.return,Yt)}}}else if(u.tag===18){if(g===null){Ie=u;try{var nt=Ie.stateNode;I?Zp(nt,!0):Zp(Ie.stateNode,!1)}catch(Yt){mi(Ie,Ie.return,Yt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break e;for(;u.sibling===null;){if(u.return===null||u.return===a)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}w&4&&(w=a.updateQueue,w!==null&&(g=w.retryQueue,g!==null&&(w.retryQueue=null,Qh(a,g))));break;case 19:na(u,a),io(a),w&4&&(w=a.updateQueue,w!==null&&(a.updateQueue=null,Qh(a,w)));break;case 30:break;case 21:break;default:na(u,a),io(a)}}function io(a){var u=a.flags;if(u&2){try{for(var g,w=a.return;w!==null;){if(F0(w)){g=w;break}w=w.return}if(g==null)throw Error(h(160));switch(g.tag){case 27:var I=g.stateNode,P=Sy(a);Vm(a,P,I);break;case 5:var Z=g.stateNode;g.flags&32&&(ws(Z,""),g.flags&=-33);var se=Sy(a);Vm(a,se,Z);break;case 3:case 4:var Ie=g.stateNode.containerInfo,We=Sy(a);Ey(a,We,Ie);break;default:throw Error(h(161))}}catch(lt){mi(a,a.return,lt)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function Bu(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var u=a;Bu(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),a=a.sibling}}function eu(a,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Ay(a,u.alternate,u),u=u.sibling}function Uu(a){for(a=a.child;a!==null;){var u=a;switch(u.tag){case 0:case 11:case 14:case 15:ac(4,u,u.return),Uu(u);break;case 1:oc(u,u.return);var g=u.stateNode;typeof g.componentWillUnmount=="function"&&Fu(u,u.return,g),Uu(u);break;case 27:Tf(u.stateNode);case 26:case 5:oc(u,u.return),Uu(u);break;case 22:u.memoizedState===null&&Uu(u);break;case 30:Uu(u);break;default:Uu(u)}a=a.sibling}}function Wo(a,u,g){for(g=g&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var w=u.alternate,I=a,P=u,Z=P.flags;switch(P.tag){case 0:case 11:case 15:Wo(I,P,g),ju(4,P);break;case 1:if(Wo(I,P,g),w=P,I=w.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(We){mi(w,w.return,We)}if(w=P,I=w.updateQueue,I!==null){var se=w.stateNode;try{var Ie=I.shared.hiddenCallbacks;if(Ie!==null)for(I.shared.hiddenCallbacks=null,I=0;I<Ie.length;I++)Go(Ie[I],se)}catch(We){mi(w,w.return,We)}}g&&Z&64&&wy(P),Kc(P,P.return);break;case 27:Gm(P);case 26:case 5:Wo(I,P,g),g&&w===null&&Z&4&&j0(P),Kc(P,P.return);break;case 12:Wo(I,P,g);break;case 31:Wo(I,P,g),g&&Z&4&&hf(I,P);break;case 13:Wo(I,P,g),g&&Z&4&&$m(I,P);break;case 22:P.memoizedState===null&&Wo(I,P,g),Kc(P,P.return);break;case 30:break;default:Wo(I,P,g)}u=u.sibling}}function Ip(a,u){var g=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),a=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(a=u.memoizedState.cachePool.pool),a!==g&&(a!=null&&a.refCount++,g!=null&&ca(g))}function Zm(a,u){a=null,u.alternate!==null&&(a=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==a&&(u.refCount++,a!=null&&ca(a))}function zs(a,u,g,w){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)V0(a,u,g,w),u=u.sibling}function V0(a,u,g,w){var I=u.flags;switch(u.tag){case 0:case 11:case 15:zs(a,u,g,w),I&2048&&ju(9,u);break;case 1:zs(a,u,g,w);break;case 3:zs(a,u,g,w),I&2048&&(a=null,u.alternate!==null&&(a=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==a&&(u.refCount++,a!=null&&ca(a)));break;case 12:if(I&2048){zs(a,u,g,w),a=u.stateNode;try{var P=u.memoizedProps,Z=P.id,se=P.onPostCommit;typeof se=="function"&&se(Z,u.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(Ie){mi(u,u.return,Ie)}}else zs(a,u,g,w);break;case 31:zs(a,u,g,w);break;case 13:zs(a,u,g,w);break;case 23:break;case 22:P=u.stateNode,Z=u.alternate,u.memoizedState!==null?P._visibility&2?zs(a,u,g,w):Rp(a,u):P._visibility&2?zs(a,u,g,w):(P._visibility|=2,ff(a,u,g,w,(u.subtreeFlags&10256)!==0||!1)),I&2048&&Ip(Z,u);break;case 24:zs(a,u,g,w),I&2048&&Zm(u.alternate,u);break;default:zs(a,u,g,w)}}function ff(a,u,g,w,I){for(I=I&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var P=a,Z=u,se=g,Ie=w,We=Z.flags;switch(Z.tag){case 0:case 11:case 15:ff(P,Z,se,Ie,I),ju(8,Z);break;case 23:break;case 22:var lt=Z.stateNode;Z.memoizedState!==null?lt._visibility&2?ff(P,Z,se,Ie,I):Rp(P,Z):(lt._visibility|=2,ff(P,Z,se,Ie,I)),I&&We&2048&&Ip(Z.alternate,Z);break;case 24:ff(P,Z,se,Ie,I),I&&We&2048&&Zm(Z.alternate,Z);break;default:ff(P,Z,se,Ie,I)}u=u.sibling}}function Rp(a,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var g=a,w=u,I=w.flags;switch(w.tag){case 22:Rp(g,w),I&2048&&Ip(w.alternate,w);break;case 24:Rp(g,w),I&2048&&Zm(w.alternate,w);break;default:Rp(g,w)}u=u.sibling}}var kp=8192;function pf(a,u,g){if(a.subtreeFlags&kp)for(a=a.child;a!==null;)Kh(a,u,g),a=a.sibling}function Kh(a,u,g){switch(a.tag){case 26:pf(a,u,g),a.flags&kp&&a.memoizedState!==null&&ae(g,no,a.memoizedState,a.memoizedProps);break;case 5:pf(a,u,g);break;case 3:case 4:var w=no;no=Yp(a.stateNode.containerInfo),pf(a,u,g),no=w;break;case 22:a.memoizedState===null&&(w=a.alternate,w!==null&&w.memoizedState!==null?(w=kp,kp=16777216,pf(a,u,g),kp=w):pf(a,u,g));break;default:pf(a,u,g)}}function G0(a){var u=a.alternate;if(u!==null&&(a=u.child,a!==null)){u.child=null;do u=a.sibling,a.sibling=null,a=u;while(a!==null)}}function Op(a){var u=a.deletions;if((a.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var w=u[g];Fn=w,Dy(w,a)}G0(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Cy(a),a=a.sibling}function Cy(a){switch(a.tag){case 0:case 11:case 15:Op(a),a.flags&2048&&ac(9,a,a.return);break;case 3:Op(a);break;case 12:Op(a);break;case 22:var u=a.stateNode;a.memoizedState!==null&&u._visibility&2&&(a.return===null||a.return.tag!==13)?(u._visibility&=-3,Ym(a)):Op(a);break;default:Op(a)}}function Ym(a){var u=a.deletions;if((a.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var w=u[g];Fn=w,Dy(w,a)}G0(a)}for(a=a.child;a!==null;){switch(u=a,u.tag){case 0:case 11:case 15:ac(8,u,u.return),Ym(u);break;case 22:g=u.stateNode,g._visibility&2&&(g._visibility&=-3,Ym(u));break;default:Ym(u)}a=a.sibling}}function Dy(a,u){for(;Fn!==null;){var g=Fn;switch(g.tag){case 0:case 11:case 15:ac(8,g,u);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var w=g.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:ca(g.memoizedState.cache)}if(w=g.child,w!==null)w.return=g,Fn=w;else e:for(g=a;Fn!==null;){w=Fn;var I=w.sibling,P=w.return;if(Dp(w),w===g){Fn=null;break e}if(I!==null){I.return=P,Fn=I;break e}Fn=P}}}var Xb={getCacheForType:function(a){var u=Hr(Ti),g=u.data.get(a);return g===void 0&&(g=a(),u.data.set(a,g)),g},cacheSignal:function(){return Hr(Ti).controller.signal}},Iy=typeof WeakMap=="function"?WeakMap:Map,ei=0,Mi=null,Yn=null,Qn=0,bi=0,So=null,Vu=!1,mf=!1,Jh=!1,lc=0,wr=0,Gu=0,ed=0,Ry=0,Qo=0,td=0,nd=null,ro=null,Hm=!1,Pp=0,$0=0,id=1/0,qm=null,tu=null,ia=0,$u=null,gf=null,cc=0,ky=0,Oy=null,yf=null,rr=0,Lp=null;function Eo(){return(ei&2)!==0&&Qn!==0?Qn&-Qn:Ue.T!==null?Yu():Lo()}function Py(){if(Qo===0)if((Qn&536870912)===0||Nn){var a=Nt;Nt<<=1,(Nt&3932160)===0&&(Nt=262144),Qo=a}else Qo=536870912;return a=Si.current,a!==null&&(a.flags|=32),Qo}function La(a,u,g){(a===Mi&&(bi===2||bi===9)||a.cancelPendingCommit!==null)&&(_f(a,0),Zu(a,Qn,Qo,!1)),Wi(a,g),((ei&2)===0||a!==Mi)&&(a===Mi&&((ei&2)===0&&(ed|=g),wr===4&&Zu(a,Qn,Qo,!1)),vl(a))}function rd(a,u,g){if((ei&6)!==0)throw Error(h(327));var w=!g&&(u&127)===0&&(u&a.expiredLanes)===0||Un(a,u),I=w?X0(a,u):Ny(a,u,!0),P=w;do{if(I===0){mf&&!w&&Zu(a,u,0,!1);break}else{if(g=a.current.alternate,P&&!Wb(g)){I=Ny(a,u,!1),P=!1;continue}if(I===2){if(P=u,a.errorRecoveryDisabledLanes&P)var Z=0;else Z=a.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){u=Z;e:{var se=a;I=nd;var Ie=se.current.memoizedState.isDehydrated;if(Ie&&(_f(se,Z).flags|=256),Z=Ny(se,Z,!1),Z!==2){if(Jh&&!Ie){se.errorRecoveryDisabledLanes|=P,ed|=P,I=4;break e}P=ro,ro=I,P!==null&&(ro===null?ro=P:ro.push.apply(ro,P))}I=Z}if(P=!1,I!==2)continue}}if(I===1){_f(a,0),Zu(a,u,0,!0);break}e:{switch(w=a,P=I,P){case 0:case 1:throw Error(h(345));case 4:if((u&4194048)!==u)break;case 6:Zu(w,u,Qo,!Vu);break e;case 2:ro=null;break;case 3:case 5:break;default:throw Error(h(329))}if((u&62914560)===u&&(I=Pp+300-Oi(),10<I)){if(Zu(w,u,Qo,!Vu),Cn(w,0,!0)!==0)break e;cc=u,w.timeoutHandle=t_(Ly.bind(null,w,g,ro,qm,Hm,u,Qo,ed,td,Vu,P,"Throttled",-0,0),I);break e}Ly(w,g,ro,qm,Hm,u,Qo,ed,td,Vu,P,null,-0,0)}}break}while(!0);vl(a)}function Ly(a,u,g,w,I,P,Z,se,Ie,We,lt,mt,et,nt){if(a.timeoutHandle=-1,mt=u.subtreeFlags,mt&8192||(mt&16785408)===16785408){mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ga},Kh(u,P,mt);var Yt=(P&62914560)===P?Pp-Oi():(P&4194048)===P?$0-Oi():0;if(Yt=pe(mt,Yt),Yt!==null){cc=P,a.cancelPendingCommit=Yt(Np.bind(null,a,u,P,g,w,I,Z,se,Ie,lt,mt,null,et,nt)),Zu(a,P,Z,!We);return}}Np(a,u,P,g,w,I,Z,se,Ie)}function Wb(a){for(var u=a;;){var g=u.tag;if((g===0||g===11||g===15)&&u.flags&16384&&(g=u.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var w=0;w<g.length;w++){var I=g[w],P=I.getSnapshot;I=I.value;try{if(!va(P(),I))return!1}catch{return!1}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Zu(a,u,g,w){u&=~Ry,u&=~ed,a.suspendedLanes|=u,a.pingedLanes&=~u,w&&(a.warmLanes|=u),w=a.expirationTimes;for(var I=u;0<I;){var P=31-Ge(I),Z=1<<P;w[P]=-1,I&=~Z}g!==0&&Ur(a,g,u)}function Xm(){return(ei&6)===0?(ad(0),!1):!0}function zy(){if(Yn!==null){if(bi===0)var a=Yn.return;else a=Yn,Uo=Is=null,p(a),Kl=null,Ru=0,a=Yn;for(;a!==null;)N0(a.alternate,a),a=a.return;Yn=null}}function _f(a,u){var g=a.timeoutHandle;g!==-1&&(a.timeoutHandle=-1,ax(g)),g=a.cancelPendingCommit,g!==null&&(a.cancelPendingCommit=null,g()),cc=0,zy(),Mi=a,Yn=g=qa(a.current,null),Qn=u,bi=0,So=null,Vu=!1,mf=Un(a,u),Jh=!1,td=Qo=Ry=ed=Gu=wr=0,ro=nd=null,Hm=!1,(u&8)!==0&&(u|=u&32);var w=a.entangledLanes;if(w!==0)for(a=a.entanglements,w&=u;0<w;){var I=31-Ge(w),P=1<<I;u|=a[I],w&=~P}return lc=u,zc(),g}function Z0(a,u){sn=null,Ue.H=Xc,u===Vc||u===Xl?(u=gp(),bi=3):u===jh?(u=gp(),bi=4):bi=u===wp?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,So=u,Yn===null&&(wr=1,bp(a,xa(u,a.current)))}function Y0(){var a=Si.current;return a===null?!0:(Qn&4194048)===Qn?Ka===null:(Qn&62914560)===Qn||(Qn&536870912)!==0?a===Ka:!1}function H0(){var a=Ue.H;return Ue.H=Xc,a===null?Xc:a}function q0(){var a=Ue.A;return Ue.A=Xb,a}function Wm(){wr=4,Vu||(Qn&4194048)!==Qn&&Si.current!==null||(mf=!0),(Gu&134217727)===0&&(ed&134217727)===0||Mi===null||Zu(Mi,Qn,Qo,!1)}function Ny(a,u,g){var w=ei;ei|=2;var I=H0(),P=q0();(Mi!==a||Qn!==u)&&(qm=null,_f(a,u)),u=!1;var Z=wr;e:do try{if(bi!==0&&Yn!==null){var se=Yn,Ie=So;switch(bi){case 8:zy(),Z=6;break e;case 3:case 2:case 9:case 6:Si.current===null&&(u=!0);var We=bi;if(bi=0,So=null,uc(a,se,Ie,We),g&&mf){Z=0;break e}break;default:We=bi,bi=0,So=null,uc(a,se,Ie,We)}}Qb(),Z=wr;break}catch(lt){Z0(a,lt)}while(!0);return u&&a.shellSuspendCounter++,Uo=Is=null,ei=w,Ue.H=I,Ue.A=P,Yn===null&&(Mi=null,Qn=0,zc()),Z}function Qb(){for(;Yn!==null;)Fy(Yn)}function X0(a,u){var g=ei;ei|=2;var w=H0(),I=q0();Mi!==a||Qn!==u?(qm=null,id=Oi()+500,_f(a,u)):mf=Un(a,u);e:do try{if(bi!==0&&Yn!==null){u=Yn;var P=So;t:switch(bi){case 1:bi=0,So=null,uc(a,u,P,1);break;case 2:case 9:if(Ql(P)){bi=0,So=null,nu(u);break}u=function(){bi!==2&&bi!==9||Mi!==a||(bi=7),vl(a)},P.then(u,u);break e;case 3:bi=7;break e;case 4:bi=5;break e;case 7:Ql(P)?(bi=0,So=null,nu(u)):(bi=0,So=null,uc(a,u,P,7));break;case 5:var Z=null;switch(Yn.tag){case 26:Z=Yn.memoizedState;case 5:case 27:var se=Yn;if(Z?W(Z):se.stateNode.complete){bi=0,So=null;var Ie=se.sibling;if(Ie!==null)Yn=Ie;else{var We=se.return;We!==null?(Yn=We,iu(We)):Yn=null}break t}}bi=0,So=null,uc(a,u,P,5);break;case 6:bi=0,So=null,uc(a,u,P,6);break;case 8:zy(),wr=6;break e;default:throw Error(h(462))}}jy();break}catch(lt){Z0(a,lt)}while(!0);return Uo=Is=null,Ue.H=w,Ue.A=I,ei=g,Yn!==null?0:(Mi=null,Qn=0,zc(),wr)}function jy(){for(;Yn!==null&&!Ua();)Fy(Yn)}function Fy(a){var u=L0(a.alternate,a,lc);a.memoizedProps=a.pendingProps,u===null?iu(a):Yn=u}function nu(a){var u=a,g=u.alternate;switch(u.tag){case 15:case 0:u=yy(g,u,u.pendingProps,u.type,void 0,Qn);break;case 11:u=yy(g,u,u.pendingProps,u.type.render,u.ref,Qn);break;case 5:p(u);default:N0(g,u),u=Yn=Om(u,lc),u=L0(g,u,lc)}a.memoizedProps=a.pendingProps,u===null?iu(a):Yn=u}function uc(a,u,g,w){Uo=Is=null,p(u),Kl=null,Ru=0;var I=u.return;try{if(Zb(a,I,u,g,Qn)){wr=1,bp(a,xa(g,a.current)),Yn=null;return}}catch(P){if(I!==null)throw Yn=I,P;wr=1,bp(a,xa(g,a.current)),Yn=null;return}u.flags&32768?(Nn||w===1?a=!0:mf||(Qn&536870912)!==0?a=!1:(Vu=a=!0,(w===2||w===9||w===3||w===6)&&(w=Si.current,w!==null&&w.tag===13&&(w.flags|=16384))),zp(u,a)):iu(u)}function iu(a){var u=a;do{if((u.flags&32768)!==0){zp(u,Vu);return}a=u.return;var g=Hb(u.alternate,u,lc);if(g!==null){Yn=g;return}if(u=u.sibling,u!==null){Yn=u;return}Yn=u=a}while(u!==null);wr===0&&(wr=5)}function zp(a,u){do{var g=qb(a.alternate,a);if(g!==null){g.flags&=32767,Yn=g;return}if(g=a.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!u&&(a=a.sibling,a!==null)){Yn=a;return}Yn=a=g}while(a!==null);wr=6,Yn=null}function Np(a,u,g,w,I,P,Z,se,Ie){a.cancelPendingCommit=null;do Qm();while(ia!==0);if((ei&6)!==0)throw Error(h(327));if(u!==null){if(u===a.current)throw Error(h(177));if(P=u.lanes|u.childLanes,P|=Lc,yr(a,g,P,Z,se,Ie),a===Mi&&(Yn=Mi=null,Qn=0),gf=u,$u=a,cc=g,ky=P,Oy=I,yf=w,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,tx(ur,function(){return Vy(),null})):(a.callbackNode=null,a.callbackPriority=0),w=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||w){w=Ue.T,Ue.T=null,I=st.p,st.p=2,Z=ei,ei|=4;try{uf(a,u,g)}finally{ei=Z,st.p=I,Ue.T=w}}ia=1,W0(),Q0(),By()}}function W0(){if(ia===1){ia=0;var a=$u,u=gf,g=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||g){g=Ue.T,Ue.T=null;var w=st.p;st.p=2;var I=ei;ei|=4;try{U0(u,a);var P=sg,Z=Zn(a.containerInfo),se=P.focusedElem,Ie=P.selectionRange;if(Z!==se&&se&&se.ownerDocument&&Hd(se.ownerDocument.documentElement,se)){if(Ie!==null&&qd(se)){var We=Ie.start,lt=Ie.end;if(lt===void 0&&(lt=We),"selectionStart"in se)se.selectionStart=We,se.selectionEnd=Math.min(lt,se.value.length);else{var mt=se.ownerDocument||document,et=mt&&mt.defaultView||window;if(et.getSelection){var nt=et.getSelection(),Yt=se.textContent.length,ln=Math.min(Ie.start,Yt),Ni=Ie.end===void 0?ln:Math.min(Ie.end,Yt);!nt.extend&&ln>Ni&&(Z=Ni,Ni=ln,ln=Z);var Ve=Yd(se,ln),ze=Yd(se,Ni);if(Ve&&ze&&(nt.rangeCount!==1||nt.anchorNode!==Ve.node||nt.anchorOffset!==Ve.offset||nt.focusNode!==ze.node||nt.focusOffset!==ze.offset)){var Xe=mt.createRange();Xe.setStart(Ve.node,Ve.offset),nt.removeAllRanges(),ln>Ni?(nt.addRange(Xe),nt.extend(ze.node,ze.offset)):(Xe.setEnd(ze.node,ze.offset),nt.addRange(Xe))}}}}for(mt=[],nt=se;nt=nt.parentNode;)nt.nodeType===1&&mt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof se.focus=="function"&&se.focus(),se=0;se<mt.length;se++){var ht=mt[se];ht.element.scrollLeft=ht.left,ht.element.scrollTop=ht.top}}Qt=!!og,sg=og=null}finally{ei=I,st.p=w,Ue.T=g}}a.current=u,ia=2}}function Q0(){if(ia===2){ia=0;var a=$u,u=gf,g=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||g){g=Ue.T,Ue.T=null;var w=st.p;st.p=2;var I=ei;ei|=4;try{Ay(a,u.alternate,u)}finally{ei=I,st.p=w,Ue.T=g}}ia=3}}function By(){if(ia===4||ia===3){ia=0,ga();var a=$u,u=gf,g=cc,w=yf;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?ia=5:(ia=0,gf=$u=null,Uy(a,a.pendingLanes));var I=a.pendingLanes;if(I===0&&(tu=null),pt(g),u=u.stateNode,we&&typeof we.onCommitFiberRoot=="function")try{we.onCommitFiberRoot(xe,u,void 0,(u.current.flags&128)===128)}catch{}if(w!==null){u=Ue.T,I=st.p,st.p=2,Ue.T=null;try{for(var P=a.onRecoverableError,Z=0;Z<w.length;Z++){var se=w[Z];P(se.value,{componentStack:se.stack})}}finally{Ue.T=u,st.p=I}}(cc&3)!==0&&Qm(),vl(a),I=a.pendingLanes,(g&261930)!==0&&(I&42)!==0?a===Lp?rr++:(rr=0,Lp=a):rr=0,ad(0)}}function Uy(a,u){(a.pooledCacheLanes&=u)===0&&(u=a.pooledCache,u!=null&&(a.pooledCache=null,ca(u)))}function Qm(){return W0(),Q0(),By(),Vy()}function Vy(){if(ia!==5)return!1;var a=$u,u=ky;ky=0;var g=pt(cc),w=Ue.T,I=st.p;try{st.p=32>g?32:g,Ue.T=null,g=Oy,Oy=null;var P=$u,Z=cc;if(ia=0,gf=$u=null,cc=0,(ei&6)!==0)throw Error(h(331));var se=ei;if(ei|=4,Cy(P.current),V0(P,P.current,Z,g),ei=se,ad(0,!1),we&&typeof we.onPostCommitFiberRoot=="function")try{we.onPostCommitFiberRoot(xe,P)}catch{}return!0}finally{st.p=I,Ue.T=w,Uy(a,u)}}function Gy(a,u,g){u=xa(g,u),u=zm(a.stateNode,u,2),a=wo(a,u,2),a!==null&&(Wi(a,2),vl(a))}function mi(a,u,g){if(a.tag===3)Gy(a,a,g);else for(;u!==null;){if(u.tag===3){Gy(u,a,g);break}else if(u.tag===1){var w=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(tu===null||!tu.has(w))){a=xa(g,a),g=C0(2),w=wo(u,g,2),w!==null&&(Nm(g,w,u,a),Wi(w,2),vl(w));break}}u=u.return}}function jp(a,u,g){var w=a.pingCache;if(w===null){w=a.pingCache=new Iy;var I=new Set;w.set(u,I)}else I=w.get(u),I===void 0&&(I=new Set,w.set(u,I));I.has(g)||(Jh=!0,I.add(g),a=Kb.bind(null,a,u,g),u.then(a,a))}function Kb(a,u,g){var w=a.pingCache;w!==null&&w.delete(u),a.pingedLanes|=a.suspendedLanes&g,a.warmLanes&=~g,Mi===a&&(Qn&g)===g&&(wr===4||wr===3&&(Qn&62914560)===Qn&&300>Oi()-Pp?(ei&2)===0&&_f(a,0):Ry|=g,td===Qn&&(td=0)),vl(a)}function $y(a,u){u===0&&(u=jn()),a=vo(a,u),a!==null&&(Wi(a,u),vl(a))}function Jb(a){var u=a.memoizedState,g=0;u!==null&&(g=u.retryLane),$y(a,g)}function ex(a,u){var g=0;switch(a.tag){case 31:case 13:var w=a.stateNode,I=a.memoizedState;I!==null&&(g=I.retryLane);break;case 19:w=a.stateNode;break;case 22:w=a.stateNode._retryCache;break;default:throw Error(h(314))}w!==null&&w.delete(u),$y(a,g)}function tx(a,u){return Br(a,u)}var Km=null,vf=null,Jm=!1,Fp=!1,_l=!1,ao=0;function vl(a){a!==vf&&a.next===null&&(vf===null?Km=vf=a:vf=vf.next=a),Fp=!0,Jm||(Jm=!0,Zy())}function ad(a,u){if(!_l&&Fp){_l=!0;do for(var g=!1,w=Km;w!==null;){if(a!==0){var I=w.pendingLanes;if(I===0)var P=0;else{var Z=w.suspendedLanes,se=w.pingedLanes;P=(1<<31-Ge(42|a)+1)-1,P&=I&~(Z&~se),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(g=!0,tg(w,P))}else P=Qn,P=Cn(w,w===Mi?P:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(P&3)===0||Un(w,P)||(g=!0,tg(w,P));w=w.next}while(g);_l=!1}}function nx(){Bp()}function Bp(){Fp=Jm=!1;var a=0;ao!==0&&iv()&&(a=ao);for(var u=Oi(),g=null,w=Km;w!==null;){var I=w.next,P=eg(w,u);P===0?(w.next=null,g===null?Km=I:g.next=I,I===null&&(vf=g)):(g=w,(a!==0||(P&3)!==0)&&(Fp=!0)),w=I}ia!==0&&ia!==5||ad(a),ao!==0&&(ao=0)}function eg(a,u){for(var g=a.suspendedLanes,w=a.pingedLanes,I=a.expirationTimes,P=a.pendingLanes&-62914561;0<P;){var Z=31-Ge(P),se=1<<Z,Ie=I[Z];Ie===-1?((se&g)===0||(se&w)!==0)&&(I[Z]=Vt(se,u)):Ie<=u&&(a.expiredLanes|=se),P&=~se}if(u=Mi,g=Qn,g=Cn(a,a===u?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),w=a.callbackNode,g===0||a===u&&(bi===2||bi===9)||a.cancelPendingCommit!==null)return w!==null&&w!==null&&Ea(w),a.callbackNode=null,a.callbackPriority=0;if((g&3)===0||Un(a,g)){if(u=g&-g,u===a.callbackPriority)return u;switch(w!==null&&Ea(w),pt(g)){case 2:case 8:g=Mr;break;case 32:g=ur;break;case 268435456:g=ee;break;default:g=ur}return w=K0.bind(null,a),g=Br(g,w),a.callbackPriority=u,a.callbackNode=g,u}return w!==null&&w!==null&&Ea(w),a.callbackPriority=2,a.callbackNode=null,2}function K0(a,u){if(ia!==0&&ia!==5)return a.callbackNode=null,a.callbackPriority=0,null;var g=a.callbackNode;if(Qm()&&a.callbackNode!==g)return null;var w=Qn;return w=Cn(a,a===Mi?w:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),w===0?null:(rd(a,w,u),eg(a,Oi()),a.callbackNode!=null&&a.callbackNode===g?K0.bind(null,a):null)}function tg(a,u){if(Qm())return null;rd(a,u,!0)}function Zy(){av(function(){(ei&6)!==0?Br(dn,nx):Bp()})}function Yu(){if(ao===0){var a=ta;a===0&&(a=rt,rt<<=1,(rt&261888)===0&&(rt=256)),ao=a}return ao}function Yy(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:xn(""+a)}function Hy(a,u){var g=u.ownerDocument.createElement("input");return g.name=u.name,g.value=u.value,a.id&&g.setAttribute("form",a.id),u.parentNode.insertBefore(g,u),a=new FormData(a),g.parentNode.removeChild(g),a}function qy(a,u,g,w,I){if(u==="submit"&&g&&g.stateNode===I){var P=Yy((I[vt]||null).action),Z=w.submitter;Z&&(u=(u=Z[vt]||null)?Yy(u.formAction):Z.getAttribute("formAction"),u!==null&&(P=u,Z=null));var se=new yu("action","action",null,w,I);a.push({event:se,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(ao!==0){var Ie=Z?Hy(I,Z):new FormData(I);To(g,{pending:!0,data:Ie,method:I.method,action:P},null,Ie)}}else typeof P=="function"&&(se.preventDefault(),Ie=Z?Hy(I,Z):new FormData(I),To(g,{pending:!0,data:Ie,method:I.method,action:P},P,Ie))},currentTarget:I}]})}}for(var ng=0;ng<Wd.length;ng++){var bf=Wd[ng],J0=bf.toLowerCase(),ix=bf[0].toUpperCase()+bf.slice(1);Ya(J0,"on"+ix)}Ya(Mh,"onAnimationEnd"),Ya(Ch,"onAnimationIteration"),Ya(Xd,"onAnimationStart"),Ya("dblclick","onDoubleClick"),Ya("focusin","onFocus"),Ya("focusout","onBlur"),Ya(Pc,"onTransitionRun"),Ya(Dh,"onTransitionStart"),Ya(Eu,"onTransitionCancel"),Ya(Za,"onTransitionEnd"),bs("onMouseEnter",["mouseout","mouseover"]),bs("onMouseLeave",["mouseout","mouseover"]),bs("onPointerEnter",["pointerout","pointerover"]),bs("onPointerLeave",["pointerout","pointerover"]),ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ri("onBeforeInput",["compositionend","keypress","textInput","paste"]),ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Up="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Up));function ev(a,u){u=(u&4)!==0;for(var g=0;g<a.length;g++){var w=a[g],I=w.event;w=w.listeners;e:{var P=void 0;if(u)for(var Z=w.length-1;0<=Z;Z--){var se=w[Z],Ie=se.instance,We=se.currentTarget;if(se=se.listener,Ie!==P&&I.isPropagationStopped())break e;P=se,I.currentTarget=We;try{P(I)}catch(lt){Ms(lt)}I.currentTarget=null,P=Ie}else for(Z=0;Z<w.length;Z++){if(se=w[Z],Ie=se.instance,We=se.currentTarget,se=se.listener,Ie!==P&&I.isPropagationStopped())break e;P=se,I.currentTarget=We;try{P(I)}catch(lt){Ms(lt)}I.currentTarget=null,P=Ie}}}}function Hn(a,u){var g=u[_n];g===void 0&&(g=u[_n]=new Set);var w=a+"__bubble";g.has(w)||(Xy(u,a,2,!1),g.add(w))}function Vp(a,u,g){var w=0;u&&(w|=4),Xy(g,a,w,u)}var bl="_reactListening"+Math.random().toString(36).slice(2);function ig(a){if(!a[bl]){a[bl]=!0,Ji.forEach(function(g){g!=="selectionchange"&&(rx.has(g)||Vp(g,!1,a),Vp(g,!0,a))});var u=a.nodeType===9?a:a.ownerDocument;u===null||u[bl]||(u[bl]=!0,Vp("selectionchange",!1,u))}}function Xy(a,u,g,w){switch(ra(u)){case 2:var I=nn;break;case 8:I=Xt;break;default:I=Bt}g=I.bind(null,u,g,a),I=void 0,!_a||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(I=!0),w?I!==void 0?a.addEventListener(u,g,{capture:!0,passive:I}):a.addEventListener(u,g,!0):I!==void 0?a.addEventListener(u,g,{passive:I}):a.addEventListener(u,g,!1)}function rg(a,u,g,w,I){var P=w;if((u&1)===0&&(u&2)===0&&w!==null)e:for(;;){if(w===null)return;var Z=w.tag;if(Z===3||Z===4){var se=w.stateNode.containerInfo;if(se===I)break;if(Z===4)for(Z=w.return;Z!==null;){var Ie=Z.tag;if((Ie===3||Ie===4)&&Z.stateNode.containerInfo===I)return;Z=Z.return}for(;se!==null;){if(Z=vs(se),Z===null)return;if(Ie=Z.tag,Ie===5||Ie===6||Ie===26||Ie===27){w=P=Z;continue e}se=se.parentNode}}w=w.return}wi(function(){var We=P,lt=zl(g),mt=[];e:{var et=hp.get(a);if(et!==void 0){var nt=yu,Yt=a;switch(a){case"keypress":if(tn(g)===0)break e;case"keydown":case"keyup":nt=Js;break;case"focusin":Yt="focus",nt=Ic;break;case"focusout":Yt="blur",nt=Ic;break;case"beforeblur":case"afterblur":nt=Ic;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=_u;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=$r;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=hy;break;case Mh:case Ch:case Xd:nt=Zr;break;case Za:nt=dy;break;case"scroll":case"scrollend":nt=_h;break;case"wheel":nt=Kf;break;case"copy":case"cut":case"paste":nt=Fd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Wf;break;case"toggle":case"beforetoggle":nt=bu}var ln=(u&4)!==0,Ni=!ln&&(a==="scroll"||a==="scrollend"),Ve=ln?et!==null?et+"Capture":null:et;ln=[];for(var ze=We,Xe;ze!==null;){var ht=ze;if(Xe=ht.stateNode,ht=ht.tag,ht!==5&&ht!==26&&ht!==27||Xe===null||Ve===null||(ht=Ts(ze,Ve),ht!=null&&ln.push(xf(ze,ht,Xe))),Ni)break;ze=ze.return}0<ln.length&&(et=new nt(et,Yt,null,g,lt),mt.push({event:et,listeners:ln}))}}if((u&7)===0){e:{if(et=a==="mouseover"||a==="pointerover",nt=a==="mouseout"||a==="pointerout",et&&g!==Ec&&(Yt=g.relatedTarget||g.fromElement)&&(vs(Yt)||Yt[gn]))break e;if((nt||et)&&(et=lt.window===lt?lt:(et=lt.ownerDocument)?et.defaultView||et.parentWindow:window,nt?(Yt=g.relatedTarget||g.toElement,nt=We,Yt=Yt?vs(Yt):null,Yt!==null&&(Ni=m(Yt),ln=Yt.tag,Yt!==Ni||ln!==5&&ln!==27&&ln!==6)&&(Yt=null)):(nt=null,Yt=We),nt!==Yt)){if(ln=_u,ht="onMouseLeave",Ve="onMouseEnter",ze="mouse",(a==="pointerout"||a==="pointerover")&&(ln=Wf,ht="onPointerLeave",Ve="onPointerEnter",ze="pointer"),Ni=nt==null?et:qs(nt),Xe=Yt==null?et:qs(Yt),et=new ln(ht,ze+"leave",nt,g,lt),et.target=Ni,et.relatedTarget=Xe,ht=null,vs(lt)===We&&(ln=new ln(Ve,ze+"enter",Yt,g,lt),ln.target=Xe,ln.relatedTarget=Ni,ht=ln),Ni=ht,nt&&Yt)t:{for(ln=Wy,Ve=nt,ze=Yt,Xe=0,ht=Ve;ht;ht=ln(ht))Xe++;ht=0;for(var en=ze;en;en=ln(en))ht++;for(;0<Xe-ht;)Ve=ln(Ve),Xe--;for(;0<ht-Xe;)ze=ln(ze),ht--;for(;Xe--;){if(Ve===ze||ze!==null&&Ve===ze.alternate){ln=Ve;break t}Ve=ln(Ve),ze=ln(ze)}ln=null}else ln=null;nt!==null&&Qy(mt,et,nt,ln,!1),Yt!==null&&Ni!==null&&Qy(mt,Ni,Yt,ln,!0)}}e:{if(et=We?qs(We):window,nt=et.nodeName&&et.nodeName.toLowerCase(),nt==="select"||nt==="input"&&et.type==="file")var hi=Fl;else if(np(et))if(ip)hi=Rm;else{hi=ap;var Pt=Dm}else nt=et.nodeName,!nt||nt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?We&&Ll(We.elementType)&&(hi=Fl):hi=Im;if(hi&&(hi=hi(a,We))){$d(mt,hi,g,lt);break e}Pt&&Pt(a,et,We),a==="focusout"&&We&&et.type==="number"&&We.memoizedProps.value!=null&&Ws(et,"number",et.value)}switch(Pt=We?qs(We):window,a){case"focusin":(np(Pt)||Pt.contentEditable==="true")&&(_o=Pt,Eh=We,Ah=null);break;case"focusout":Ah=Eh=_o=null;break;case"mousedown":lp=!0;break;case"contextmenu":case"mouseup":case"dragend":lp=!1,km(mt,g,lt);break;case"selectionchange":if(sp)break;case"keydown":case"keyup":km(mt,g,lt)}var rn;if($a)e:{switch(a){case"compositionstart":var Rn="onCompositionStart";break e;case"compositionend":Rn="onCompositionEnd";break e;case"compositionupdate":Rn="onCompositionUpdate";break e}Rn=void 0}else jo?xh(a,g)&&(Rn="onCompositionEnd"):a==="keydown"&&g.keyCode===229&&(Rn="onCompositionStart");Rn&&(Rc&&g.locale!=="ko"&&(jo||Rn!=="onCompositionStart"?Rn==="onCompositionEnd"&&jo&&(rn=Dn()):(go=lt,ai="value"in go?go.value:go.textContent,jo=!0)),Pt=Gp(We,Rn),0<Pt.length&&(Rn=new Tm(Rn,a,null,g,lt),mt.push({event:Rn,listeners:Pt}),rn?Rn.data=rn:(rn=Em(g),rn!==null&&(Rn.data=rn)))),(rn=ep?Am(a,g):tp(a,g))&&(Rn=Gp(We,"onBeforeInput"),0<Rn.length&&(Pt=new Tm("onBeforeInput","beforeinput",null,g,lt),mt.push({event:Pt,listeners:Rn}),Pt.data=rn)),qy(mt,a,We,g,lt)}ev(mt,u)})}function xf(a,u,g){return{instance:a,listener:u,currentTarget:g}}function Gp(a,u){for(var g=u+"Capture",w=[];a!==null;){var I=a,P=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||P===null||(I=Ts(a,g),I!=null&&w.unshift(xf(a,I,P)),I=Ts(a,u),I!=null&&w.push(xf(a,I,P))),a.tag===3)return w;a=a.return}return[]}function Wy(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Qy(a,u,g,w,I){for(var P=u._reactName,Z=[];g!==null&&g!==w;){var se=g,Ie=se.alternate,We=se.stateNode;if(se=se.tag,Ie!==null&&Ie===w)break;se!==5&&se!==26&&se!==27||We===null||(Ie=We,I?(We=Ts(g,P),We!=null&&Z.unshift(xf(g,We,Ie))):I||(We=Ts(g,P),We!=null&&Z.push(xf(g,We,Ie)))),g=g.return}Z.length!==0&&a.push({event:u,listeners:Z})}var $p=/\r\n?/g,tv=/\u0000|\uFFFD/g;function ag(a){return(typeof a=="string"?a:""+a).replace($p,`
`).replace(tv,"")}function Ky(a,u){return u=ag(u),ag(a)===u}function Bn(a,u,g,w,I,P){switch(g){case"children":typeof w=="string"?u==="body"||u==="textarea"&&w===""||ws(a,w):(typeof w=="number"||typeof w=="bigint")&&u!=="body"&&ws(a,""+w);break;case"className":mu(a,"class",w);break;case"tabIndex":mu(a,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":mu(a,g,w);break;case"style":zn(a,w,P);break;case"data":if(u!=="object"){mu(a,"data",w);break}case"src":case"href":if(w===""&&(u!=="a"||g!=="href")){a.removeAttribute(g);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){a.removeAttribute(g);break}w=xn(""+w),a.setAttribute(g,w);break;case"action":case"formAction":if(typeof w=="function"){a.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(g==="formAction"?(u!=="input"&&Bn(a,u,"name",I.name,I,null),Bn(a,u,"formEncType",I.formEncType,I,null),Bn(a,u,"formMethod",I.formMethod,I,null),Bn(a,u,"formTarget",I.formTarget,I,null)):(Bn(a,u,"encType",I.encType,I,null),Bn(a,u,"method",I.method,I,null),Bn(a,u,"target",I.target,I,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){a.removeAttribute(g);break}w=xn(""+w),a.setAttribute(g,w);break;case"onClick":w!=null&&(a.onclick=Ga);break;case"onScroll":w!=null&&Hn("scroll",a);break;case"onScrollEnd":w!=null&&Hn("scrollend",a);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(h(61));if(g=w.__html,g!=null){if(I.children!=null)throw Error(h(60));a.innerHTML=g}}break;case"multiple":a.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":a.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){a.removeAttribute("xlink:href");break}g=xn(""+w),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?a.setAttribute(g,""+w):a.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?a.setAttribute(g,""):a.removeAttribute(g);break;case"capture":case"download":w===!0?a.setAttribute(g,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?a.setAttribute(g,w):a.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?a.setAttribute(g,w):a.removeAttribute(g);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?a.removeAttribute(g):a.setAttribute(g,w);break;case"popover":Hn("beforetoggle",a),Hn("toggle",a),mh(a,"popover",w);break;case"xlinkActuate":xs(a,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":xs(a,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":xs(a,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":xs(a,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":xs(a,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":xs(a,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":xs(a,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":xs(a,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":xs(a,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":mh(a,"is",w);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=ya.get(g)||g,mh(a,g,w))}}function Hu(a,u,g,w,I,P){switch(g){case"style":zn(a,w,P);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(h(61));if(g=w.__html,g!=null){if(I.children!=null)throw Error(h(60));a.innerHTML=g}}break;case"children":typeof w=="string"?ws(a,w):(typeof w=="number"||typeof w=="bigint")&&ws(a,""+w);break;case"onScroll":w!=null&&Hn("scroll",a);break;case"onScrollEnd":w!=null&&Hn("scrollend",a);break;case"onClick":w!=null&&(a.onclick=Ga);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ca.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(I=g.endsWith("Capture"),u=g.slice(2,I?g.length-7:void 0),P=a[vt]||null,P=P!=null?P[g]:null,typeof P=="function"&&a.removeEventListener(u,P,I),typeof w=="function")){typeof P!="function"&&P!==null&&(g in a?a[g]=null:a.hasAttribute(g)&&a.removeAttribute(g)),a.addEventListener(u,w,I);break e}g in a?a[g]=w:w===!0?a.setAttribute(g,""):mh(a,g,w)}}}function Pr(a,u,g){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Hn("error",a),Hn("load",a);var w=!1,I=!1,P;for(P in g)if(g.hasOwnProperty(P)){var Z=g[P];if(Z!=null)switch(P){case"src":w=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:Bn(a,u,P,Z,g,null)}}I&&Bn(a,u,"srcSet",g.srcSet,g,null),w&&Bn(a,u,"src",g.src,g,null);return;case"input":Hn("invalid",a);var se=P=Z=I=null,Ie=null,We=null;for(w in g)if(g.hasOwnProperty(w)){var lt=g[w];if(lt!=null)switch(w){case"name":I=lt;break;case"type":Z=lt;break;case"checked":Ie=lt;break;case"defaultChecked":We=lt;break;case"value":P=lt;break;case"defaultValue":se=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(h(137,u));break;default:Bn(a,u,w,lt,g,null)}}qf(a,P,se,Ie,We,Z,I,!1);return;case"select":Hn("invalid",a),w=Z=P=null;for(I in g)if(g.hasOwnProperty(I)&&(se=g[I],se!=null))switch(I){case"value":P=se;break;case"defaultValue":Z=se;break;case"multiple":w=se;default:Bn(a,u,I,se,g,null)}u=P,g=Z,a.multiple=!!w,u!=null?Pl(a,!!w,u,!1):g!=null&&Pl(a,!!w,g,!0);return;case"textarea":Hn("invalid",a),P=I=w=null;for(Z in g)if(g.hasOwnProperty(Z)&&(se=g[Z],se!=null))switch(Z){case"value":w=se;break;case"defaultValue":I=se;break;case"children":P=se;break;case"dangerouslySetInnerHTML":if(se!=null)throw Error(h(91));break;default:Bn(a,u,Z,se,g,null)}gu(a,w,I,P);return;case"option":for(Ie in g)if(g.hasOwnProperty(Ie)&&(w=g[Ie],w!=null))switch(Ie){case"selected":a.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:Bn(a,u,Ie,w,g,null)}return;case"dialog":Hn("beforetoggle",a),Hn("toggle",a),Hn("cancel",a),Hn("close",a);break;case"iframe":case"object":Hn("load",a);break;case"video":case"audio":for(w=0;w<Up.length;w++)Hn(Up[w],a);break;case"image":Hn("error",a),Hn("load",a);break;case"details":Hn("toggle",a);break;case"embed":case"source":case"link":Hn("error",a),Hn("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(We in g)if(g.hasOwnProperty(We)&&(w=g[We],w!=null))switch(We){case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:Bn(a,u,We,w,g,null)}return;default:if(Ll(u)){for(lt in g)g.hasOwnProperty(lt)&&(w=g[lt],w!==void 0&&Hu(a,u,lt,w,g,void 0));return}}for(se in g)g.hasOwnProperty(se)&&(w=g[se],w!=null&&Bn(a,u,se,w,g,null))}function od(a,u,g,w){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,P=null,Z=null,se=null,Ie=null,We=null,lt=null;for(nt in g){var mt=g[nt];if(g.hasOwnProperty(nt)&&mt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":Ie=mt;default:w.hasOwnProperty(nt)||Bn(a,u,nt,null,w,mt)}}for(var et in w){var nt=w[et];if(mt=g[et],w.hasOwnProperty(et)&&(nt!=null||mt!=null))switch(et){case"type":P=nt;break;case"name":I=nt;break;case"checked":We=nt;break;case"defaultChecked":lt=nt;break;case"value":Z=nt;break;case"defaultValue":se=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(h(137,u));break;default:nt!==mt&&Bn(a,u,et,nt,w,mt)}}yh(a,Z,se,Ie,We,lt,P,I);return;case"select":nt=Z=se=et=null;for(P in g)if(Ie=g[P],g.hasOwnProperty(P)&&Ie!=null)switch(P){case"value":break;case"multiple":nt=Ie;default:w.hasOwnProperty(P)||Bn(a,u,P,null,w,Ie)}for(I in w)if(P=w[I],Ie=g[I],w.hasOwnProperty(I)&&(P!=null||Ie!=null))switch(I){case"value":et=P;break;case"defaultValue":se=P;break;case"multiple":Z=P;default:P!==Ie&&Bn(a,u,I,P,w,Ie)}u=se,g=Z,w=nt,et!=null?Pl(a,!!g,et,!1):!!w!=!!g&&(u!=null?Pl(a,!!g,u,!0):Pl(a,!!g,g?[]:"",!1));return;case"textarea":nt=et=null;for(se in g)if(I=g[se],g.hasOwnProperty(se)&&I!=null&&!w.hasOwnProperty(se))switch(se){case"value":break;case"children":break;default:Bn(a,u,se,null,w,I)}for(Z in w)if(I=w[Z],P=g[Z],w.hasOwnProperty(Z)&&(I!=null||P!=null))switch(Z){case"value":et=I;break;case"defaultValue":nt=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(h(91));break;default:I!==P&&Bn(a,u,Z,I,w,P)}xm(a,et,nt);return;case"option":for(var Yt in g)if(et=g[Yt],g.hasOwnProperty(Yt)&&et!=null&&!w.hasOwnProperty(Yt))switch(Yt){case"selected":a.selected=!1;break;default:Bn(a,u,Yt,null,w,et)}for(Ie in w)if(et=w[Ie],nt=g[Ie],w.hasOwnProperty(Ie)&&et!==nt&&(et!=null||nt!=null))switch(Ie){case"selected":a.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:Bn(a,u,Ie,et,w,nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ln in g)et=g[ln],g.hasOwnProperty(ln)&&et!=null&&!w.hasOwnProperty(ln)&&Bn(a,u,ln,null,w,et);for(We in w)if(et=w[We],nt=g[We],w.hasOwnProperty(We)&&et!==nt&&(et!=null||nt!=null))switch(We){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(h(137,u));break;default:Bn(a,u,We,et,w,nt)}return;default:if(Ll(u)){for(var Ni in g)et=g[Ni],g.hasOwnProperty(Ni)&&et!==void 0&&!w.hasOwnProperty(Ni)&&Hu(a,u,Ni,void 0,w,et);for(lt in w)et=w[lt],nt=g[lt],!w.hasOwnProperty(lt)||et===nt||et===void 0&&nt===void 0||Hu(a,u,lt,et,w,nt);return}}for(var Ve in g)et=g[Ve],g.hasOwnProperty(Ve)&&et!=null&&!w.hasOwnProperty(Ve)&&Bn(a,u,Ve,null,w,et);for(mt in w)et=w[mt],nt=g[mt],!w.hasOwnProperty(mt)||et===nt||et==null&&nt==null||Bn(a,u,mt,et,w,nt)}function Jy(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nv(){if(typeof performance.getEntriesByType=="function"){for(var a=0,u=0,g=performance.getEntriesByType("resource"),w=0;w<g.length;w++){var I=g[w],P=I.transferSize,Z=I.initiatorType,se=I.duration;if(P&&se&&Jy(Z)){for(Z=0,se=I.responseEnd,w+=1;w<g.length;w++){var Ie=g[w],We=Ie.startTime;if(We>se)break;var lt=Ie.transferSize,mt=Ie.initiatorType;lt&&Jy(mt)&&(Ie=Ie.responseEnd,Z+=lt*(Ie<se?1:(se-We)/(Ie-We)))}if(--w,u+=8*(P+Z)/(I.duration/1e3),a++,10<a)break}}if(0<a)return u/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var og=null,sg=null;function lg(a){return a.nodeType===9?a:a.ownerDocument}function e_(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ru(a,u){if(a===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&u==="foreignObject"?0:a}function cg(a,u){return a==="textarea"||a==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var ug=null;function iv(){var a=window.event;return a&&a.type==="popstate"?a===ug?!1:(ug=a,!0):(ug=null,!1)}var t_=typeof setTimeout=="function"?setTimeout:void 0,ax=typeof clearTimeout=="function"?clearTimeout:void 0,rv=typeof Promise=="function"?Promise:void 0,av=typeof queueMicrotask=="function"?queueMicrotask:typeof rv<"u"?function(a){return rv.resolve(null).then(a).catch(ov)}:t_;function ov(a){setTimeout(function(){throw a})}function xl(a){return a==="head"}function n_(a,u){var g=u,w=0;do{var I=g.nextSibling;if(a.removeChild(g),I&&I.nodeType===8)if(g=I.data,g==="/$"||g==="/&"){if(w===0){a.removeChild(I),Na(u);return}w--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")w++;else if(g==="html")Tf(a.ownerDocument.documentElement);else if(g==="head"){g=a.ownerDocument.head,Tf(g);for(var P=g.firstChild;P;){var Z=P.nextSibling,se=P.nodeName;P[un]||se==="SCRIPT"||se==="STYLE"||se==="LINK"&&P.rel.toLowerCase()==="stylesheet"||g.removeChild(P),P=Z}}else g==="body"&&Tf(a.ownerDocument.body);g=I}while(g);Na(u)}function Zp(a,u){var g=a;a=0;do{var w=g.nextSibling;if(g.nodeType===1?u?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(u?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),w&&w.nodeType===8)if(g=w.data,g==="/$"){if(a===0)break;a--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||a++;g=w}while(g)}function wf(a){var u=a.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var g=u;switch(u=u.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":wf(g),kl(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}a.removeChild(g)}}function hg(a,u,g,w){for(;a.nodeType===1;){var I=g;if(a.nodeName.toLowerCase()!==u.toLowerCase()){if(!w&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(w){if(!a[un])switch(u){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(P=a.getAttribute("rel"),P==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(P!==I.rel||a.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||a.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||a.getAttribute("title")!==(I.title==null?null:I.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(P=a.getAttribute("src"),(P!==(I.src==null?null:I.src)||a.getAttribute("type")!==(I.type==null?null:I.type)||a.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&P&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(u==="input"&&a.type==="hidden"){var P=I.name==null?null:""+I.name;if(I.type==="hidden"&&a.getAttribute("name")===P)return a}else return a;if(a=Ao(a.nextSibling),a===null)break}return null}function ox(a,u,g){if(u==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!g||(a=Ao(a.nextSibling),a===null))return null;return a}function sv(a,u){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!u||(a=Ao(a.nextSibling),a===null))return null;return a}function i_(a){return a.data==="$?"||a.data==="$~"}function qu(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function fa(a,u){var g=a.ownerDocument;if(a.data==="$~")a._reactRetry=u;else if(a.data!=="$?"||g.readyState!=="loading")u();else{var w=function(){u(),g.removeEventListener("DOMContentLoaded",w)};g.addEventListener("DOMContentLoaded",w),a._reactRetry=w}}function Ao(a){for(;a!=null;a=a.nextSibling){var u=a.nodeType;if(u===1||u===3)break;if(u===8){if(u=a.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return a}var dg=null;function r_(a){a=a.nextSibling;for(var u=0;a;){if(a.nodeType===8){var g=a.data;if(g==="/$"||g==="/&"){if(u===0)return Ao(a.nextSibling);u--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||u++}a=a.nextSibling}return null}function fg(a){a=a.previousSibling;for(var u=0;a;){if(a.nodeType===8){var g=a.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(u===0)return a;u--}else g!=="/$"&&g!=="/&"||u++}a=a.previousSibling}return null}function lv(a,u,g){switch(u=lg(g),a){case"html":if(a=u.documentElement,!a)throw Error(h(452));return a;case"head":if(a=u.head,!a)throw Error(h(453));return a;case"body":if(a=u.body,!a)throw Error(h(454));return a;default:throw Error(h(451))}}function Tf(a){for(var u=a.attributes;u.length;)a.removeAttributeNode(u[0]);kl(a)}var Ko=new Map,cv=new Set;function Yp(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var wl=st.d;st.d={f:a_,r:uv,D:hv,C:o_,L:mg,m:Hp,X:l_,S:s_,M:c_};function a_(){var a=wl.f(),u=Xm();return a||u}function uv(a){var u=mo(a);u!==null&&u.tag===5&&u.type==="form"?ka(u):wl.r(a)}var hc=typeof document>"u"?null:document;function pg(a,u,g){var w=hc;if(w&&typeof u=="string"&&u){var I=Vr(u);I='link[rel="'+a+'"][href="'+I+'"]',typeof g=="string"&&(I+='[crossorigin="'+g+'"]'),cv.has(I)||(cv.add(I),a={rel:a,crossOrigin:g,href:u},w.querySelector(I)===null&&(u=w.createElement("link"),Pr(u,"link",a),$i(u),w.head.appendChild(u)))}}function hv(a){wl.D(a),pg("dns-prefetch",a,null)}function o_(a,u){wl.C(a,u),pg("preconnect",a,u)}function mg(a,u,g){wl.L(a,u,g);var w=hc;if(w&&a&&u){var I='link[rel="preload"][as="'+Vr(u)+'"]';u==="image"&&g&&g.imageSrcSet?(I+='[imagesrcset="'+Vr(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(I+='[imagesizes="'+Vr(g.imageSizes)+'"]')):I+='[href="'+Vr(a)+'"]';var P=I;switch(u){case"style":P=s(a);break;case"script":P=_(a)}Ko.has(P)||(a=z({rel:"preload",href:u==="image"&&g&&g.imageSrcSet?void 0:a,as:u},g),Ko.set(P,a),w.querySelector(I)!==null||u==="style"&&w.querySelector(i(P))||u==="script"&&w.querySelector(T(P))||(u=w.createElement("link"),Pr(u,"link",a),$i(u),w.head.appendChild(u)))}}function Hp(a,u){wl.m(a,u);var g=hc;if(g&&a){var w=u&&typeof u.as=="string"?u.as:"script",I='link[rel="modulepreload"][as="'+Vr(w)+'"][href="'+Vr(a)+'"]',P=I;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=_(a)}if(!Ko.has(P)&&(a=z({rel:"modulepreload",href:a},u),Ko.set(P,a),g.querySelector(I)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(T(P)))return}w=g.createElement("link"),Pr(w,"link",a),$i(w),g.head.appendChild(w)}}}function s_(a,u,g){wl.S(a,u,g);var w=hc;if(w&&a){var I=Ma(w).hoistableStyles,P=s(a);u=u||"default";var Z=I.get(P);if(!Z){var se={loading:0,preload:null};if(Z=w.querySelector(i(P)))se.loading=5;else{a=z({rel:"stylesheet",href:a,"data-precedence":u},g),(g=Ko.get(P))&&D(a,g);var Ie=Z=w.createElement("link");$i(Ie),Pr(Ie,"link",a),Ie._p=new Promise(function(We,lt){Ie.onload=We,Ie.onerror=lt}),Ie.addEventListener("load",function(){se.loading|=1}),Ie.addEventListener("error",function(){se.loading|=2}),se.loading|=4,M(Z,u,w)}Z={type:"stylesheet",instance:Z,count:1,state:se},I.set(P,Z)}}}function l_(a,u){wl.X(a,u);var g=hc;if(g&&a){var w=Ma(g).hoistableScripts,I=_(a),P=w.get(I);P||(P=g.querySelector(T(I)),P||(a=z({src:a,async:!0},u),(u=Ko.get(I))&&L(a,u),P=g.createElement("script"),$i(P),Pr(P,"link",a),g.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},w.set(I,P))}}function c_(a,u){wl.M(a,u);var g=hc;if(g&&a){var w=Ma(g).hoistableScripts,I=_(a),P=w.get(I);P||(P=g.querySelector(T(I)),P||(a=z({src:a,async:!0,type:"module"},u),(u=Ko.get(I))&&L(a,u),P=g.createElement("script"),$i(P),Pr(P,"link",a),g.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},w.set(I,P))}}function dv(a,u,g,w){var I=(I=jt.current)?Yp(I):null;if(!I)throw Error(h(446));switch(a){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(u=s(g.href),g=Ma(I).hoistableStyles,w=g.get(u),w||(w={type:"style",instance:null,count:0,state:null},g.set(u,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){a=s(g.href);var P=Ma(I).hoistableStyles,Z=P.get(a);if(Z||(I=I.ownerDocument||I,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(a,Z),(P=I.querySelector(i(a)))&&!P._p&&(Z.instance=P,Z.state.loading=5),Ko.has(a)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Ko.set(a,g),P||f(I,a,g,Z.state))),u&&w===null)throw Error(h(528,""));return Z}if(u&&w!==null)throw Error(h(529,""));return null;case"script":return u=g.async,g=g.src,typeof g=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=_(g),g=Ma(I).hoistableScripts,w=g.get(u),w||(w={type:"script",instance:null,count:0,state:null},g.set(u,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(h(444,a))}}function s(a){return'href="'+Vr(a)+'"'}function i(a){return'link[rel="stylesheet"]['+a+"]"}function o(a){return z({},a,{"data-precedence":a.precedence,precedence:null})}function f(a,u,g,w){a.querySelector('link[rel="preload"][as="style"]['+u+"]")?w.loading=1:(u=a.createElement("link"),w.preload=u,u.addEventListener("load",function(){return w.loading|=1}),u.addEventListener("error",function(){return w.loading|=2}),Pr(u,"link",g),$i(u),a.head.appendChild(u))}function _(a){return'[src="'+Vr(a)+'"]'}function T(a){return"script[async]"+a}function S(a,u,g){if(u.count++,u.instance===null)switch(u.type){case"style":var w=a.querySelector('style[data-href~="'+Vr(g.href)+'"]');if(w)return u.instance=w,$i(w),w;var I=z({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return w=(a.ownerDocument||a).createElement("style"),$i(w),Pr(w,"style",I),M(w,g.precedence,a),u.instance=w;case"stylesheet":I=s(g.href);var P=a.querySelector(i(I));if(P)return u.state.loading|=4,u.instance=P,$i(P),P;w=o(g),(I=Ko.get(I))&&D(w,I),P=(a.ownerDocument||a).createElement("link"),$i(P);var Z=P;return Z._p=new Promise(function(se,Ie){Z.onload=se,Z.onerror=Ie}),Pr(P,"link",w),u.state.loading|=4,M(P,g.precedence,a),u.instance=P;case"script":return P=_(g.src),(I=a.querySelector(T(P)))?(u.instance=I,$i(I),I):(w=g,(I=Ko.get(P))&&(w=z({},g),L(w,I)),a=a.ownerDocument||a,I=a.createElement("script"),$i(I),Pr(I,"link",w),a.head.appendChild(I),u.instance=I);case"void":return null;default:throw Error(h(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(w=u.instance,u.state.loading|=4,M(w,g.precedence,a));return u.instance}function M(a,u,g){for(var w=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=w.length?w[w.length-1]:null,P=I,Z=0;Z<w.length;Z++){var se=w[Z];if(se.dataset.precedence===u)P=se;else if(P!==I)break}P?P.parentNode.insertBefore(a,P.nextSibling):(u=g.nodeType===9?g.head:g,u.insertBefore(a,u.firstChild))}function D(a,u){a.crossOrigin==null&&(a.crossOrigin=u.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=u.referrerPolicy),a.title==null&&(a.title=u.title)}function L(a,u){a.crossOrigin==null&&(a.crossOrigin=u.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=u.referrerPolicy),a.integrity==null&&(a.integrity=u.integrity)}var N=null;function V(a,u,g){if(N===null){var w=new Map,I=N=new Map;I.set(g,w)}else I=N,w=I.get(g),w||(w=new Map,I.set(g,w));if(w.has(a))return w;for(w.set(a,null),g=g.getElementsByTagName(a),I=0;I<g.length;I++){var P=g[I];if(!(P[un]||P[$n]||a==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=P.getAttribute(u)||"";Z=a+Z;var se=w.get(Z);se?se.push(P):w.set(Z,[P])}}return w}function Y(a,u,g){a=a.ownerDocument||a,a.head.insertBefore(g,u==="title"?a.querySelector("head > title"):null)}function H(a,u,g){if(g===1||u.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return a=u.disabled,typeof u.precedence=="string"&&a==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function W(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function ae(a,u,g,w){if(g.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var I=s(w.href),P=u.querySelector(i(I));if(P){u=P._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(a.count++,a=Ne.bind(a),u.then(a,a)),g.state.loading|=4,g.instance=P,$i(P);return}P=u.ownerDocument||u,w=o(w),(I=Ko.get(I))&&D(w,I),P=P.createElement("link"),$i(P);var Z=P;Z._p=new Promise(function(se,Ie){Z.onload=se,Z.onerror=Ie}),Pr(P,"link",w),g.instance=P}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(g,u),(u=g.state.preload)&&(g.state.loading&3)===0&&(a.count++,g=Ne.bind(a),u.addEventListener("load",g),u.addEventListener("error",g))}}var le=0;function pe(a,u){return a.stylesheets&&a.count===0&&Ce(a,a.stylesheets),0<a.count||0<a.imgCount?function(g){var w=setTimeout(function(){if(a.stylesheets&&Ce(a,a.stylesheets),a.unsuspend){var P=a.unsuspend;a.unsuspend=null,P()}},6e4+u);0<a.imgBytes&&le===0&&(le=62500*nv());var I=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Ce(a,a.stylesheets),a.unsuspend)){var P=a.unsuspend;a.unsuspend=null,P()}},(a.imgBytes>le?50:800)+u);return a.unsuspend=g,function(){a.unsuspend=null,clearTimeout(w),clearTimeout(I)}}:null}function Ne(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ce(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var ve=null;function Ce(a,u){a.stylesheets=null,a.unsuspend!==null&&(a.count++,ve=new Map,u.forEach(Ze,a),ve=null,Ne.call(a))}function Ze(a,u){if(!(u.state.loading&4)){var g=ve.get(a);if(g)var w=g.get(null);else{g=new Map,ve.set(a,g);for(var I=a.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<I.length;P++){var Z=I[P];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(g.set(Z.dataset.precedence,Z),w=Z)}w&&g.set(null,w)}I=u.instance,Z=I.getAttribute("data-precedence"),P=g.get(Z)||w,P===w&&g.set(null,I),g.set(Z,I),this.count++,w=Ne.bind(this),I.addEventListener("load",w),I.addEventListener("error",w),P?P.parentNode.insertBefore(I,P.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(I,a.firstChild)),u.state.loading|=4}}var Ke={$$typeof:Te,Provider:null,Consumer:null,_currentValue:xt,_currentValue2:xt,_threadCount:0};function ft(a,u,g,w,I,P,Z,se,Ie){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=hr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hr(0),this.hiddenUpdates=hr(null),this.identifierPrefix=w,this.onUncaughtError=I,this.onCaughtError=P,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ie,this.incompleteTransitions=new Map}function Dt(a,u,g,w,I,P,Z,se,Ie,We,lt,mt){return a=new ft(a,u,g,Z,Ie,We,lt,mt,se),u=1,P===!0&&(u|=24),P=Ha(3,null,null,u),a.current=P,P.stateNode=a,u=Nh(),u.refCount++,a.pooledCache=u,u.refCount++,P.memoizedState={element:w,isDehydrated:g,cache:u},ks(P),a}function St(a){return a?(a=bn,a):bn}function Mt(a,u,g,w,I,P){I=St(I),w.context===null?w.context=I:w.pendingContext=I,w=ul(u),w.payload={element:g},P=P===void 0?null:P,P!==null&&(w.callback=P),g=wo(a,w,u),g!==null&&(La(g,a,u),tc(g,a,u))}function $t(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var g=a.retryLane;a.retryLane=g!==0&&g<u?g:u}}function At(a,u){$t(a,u),(a=a.alternate)&&$t(a,u)}function Ct(a){if(a.tag===13||a.tag===31){var u=vo(a,67108864);u!==null&&La(u,a,67108864),At(a,67108864)}}function at(a){if(a.tag===13||a.tag===31){var u=Eo();u=Kn(u);var g=vo(a,u);g!==null&&La(g,a,u),At(a,u)}}var Qt=!0;function nn(a,u,g,w){var I=Ue.T;Ue.T=null;var P=st.p;try{st.p=2,Bt(a,u,g,w)}finally{st.p=P,Ue.T=I}}function Xt(a,u,g,w){var I=Ue.T;Ue.T=null;var P=st.p;try{st.p=8,Bt(a,u,g,w)}finally{st.p=P,Ue.T=I}}function Bt(a,u,g,w){if(Qt){var I=An(w);if(I===null)rg(a,u,w,zi,g),Mo(a,w);else if(so(I,a,u,g,w))w.stopPropagation();else if(Mo(a,w),u&4&&-1<za.indexOf(a)){for(;I!==null;){var P=mo(I);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var Z=Be(P.pendingLanes);if(Z!==0){var se=P;for(se.pendingLanes|=2,se.entangledLanes|=2;Z;){var Ie=1<<31-Ge(Z);se.entanglements[1]|=Ie,Z&=~Ie}vl(P),(ei&6)===0&&(id=Oi()+500,ad(0))}}break;case 31:case 13:se=vo(P,2),se!==null&&La(se,P,2),Xm(),At(P,2)}if(P=An(w),P===null&&rg(a,u,w,zi,g),P===I)break;I=P}I!==null&&w.stopPropagation()}else rg(a,u,w,null,g)}}function An(a){return a=zl(a),dr(a)}var zi=null;function dr(a){if(zi=null,a=vs(a),a!==null){var u=m(a);if(u===null)a=null;else{var g=u.tag;if(g===13){if(a=y(u),a!==null)return a;a=null}else if(g===31){if(a=c(u),a!==null)return a;a=null}else if(g===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;a=null}else u!==a&&(a=null)}}return zi=a,null}function ra(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ys()){case dn:return 2;case Mr:return 8;case ur:case Pe:return 32;case ee:return 268435456;default:return 32}default:return 32}}var oo=!1,Tr=null,qi=null,oi=null,ar=new Map,fr=new Map,Xi=[],za="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mo(a,u){switch(a){case"focusin":case"focusout":Tr=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":ar.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":fr.delete(u.pointerId)}}function or(a,u,g,w,I,P){return a===null||a.nativeEvent!==P?(a={blockedOn:u,domEventName:g,eventSystemFlags:w,nativeEvent:P,targetContainers:[I]},u!==null&&(u=mo(u),u!==null&&Ct(u)),a):(a.eventSystemFlags|=w,u=a.targetContainers,I!==null&&u.indexOf(I)===-1&&u.push(I),a)}function so(a,u,g,w,I){switch(u){case"focusin":return Tr=or(Tr,a,u,g,w,I),!0;case"dragenter":return qi=or(qi,a,u,g,w,I),!0;case"mouseover":return oi=or(oi,a,u,g,w,I),!0;case"pointerover":var P=I.pointerId;return ar.set(P,or(ar.get(P)||null,a,u,g,w,I)),!0;case"gotpointercapture":return P=I.pointerId,fr.set(P,or(fr.get(P)||null,a,u,g,w,I)),!0}return!1}function Sr(a){var u=vs(a.target);if(u!==null){var g=m(u);if(g!==null){if(u=g.tag,u===13){if(u=y(g),u!==null){a.blockedOn=u,Aa(a.priority,function(){at(g)});return}}else if(u===31){if(u=c(g),u!==null){a.blockedOn=u,Aa(a.priority,function(){at(g)});return}}else if(u===3&&g.stateNode.current.memoizedState.isDehydrated){a.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pr(a){if(a.blockedOn!==null)return!1;for(var u=a.targetContainers;0<u.length;){var g=An(a.nativeEvent);if(g===null){g=a.nativeEvent;var w=new g.constructor(g.type,g);Ec=w,g.target.dispatchEvent(w),Ec=null}else return u=mo(g),u!==null&&Ct(u),a.blockedOn=g,!1;u.shift()}return!0}function Lr(a,u,g){pr(a)&&g.delete(u)}function Er(){oo=!1,Tr!==null&&pr(Tr)&&(Tr=null),qi!==null&&pr(qi)&&(qi=null),oi!==null&&pr(oi)&&(oi=null),ar.forEach(Lr),fr.forEach(Lr)}function gi(a,u){a.blockedOn===u&&(a.blockedOn=null,oo||(oo=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Er)))}var Co=null;function sd(a){Co!==a&&(Co=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Co===a&&(Co=null);for(var u=0;u<a.length;u+=3){var g=a[u],w=a[u+1],I=a[u+2];if(typeof w!="function"){if(dr(w||g)===null)continue;break}var P=mo(g);P!==null&&(a.splice(u,3),u-=3,To(P,{pending:!0,data:I,method:g.method,action:w},w,I))}}))}function Na(a){function u(Ie){return gi(Ie,a)}Tr!==null&&gi(Tr,a),qi!==null&&gi(qi,a),oi!==null&&gi(oi,a),ar.forEach(u),fr.forEach(u);for(var g=0;g<Xi.length;g++){var w=Xi[g];w.blockedOn===a&&(w.blockedOn=null)}for(;0<Xi.length&&(g=Xi[0],g.blockedOn===null);)Sr(g),g.blockedOn===null&&Xi.shift();if(g=(a.ownerDocument||a).$$reactFormReplay,g!=null)for(w=0;w<g.length;w+=3){var I=g[w],P=g[w+1],Z=I[vt]||null;if(typeof P=="function")Z||sd(g);else if(Z){var se=null;if(P&&P.hasAttribute("formAction")){if(I=P,Z=P[vt]||null)se=Z.formAction;else if(dr(I)!==null)continue}else se=Z.action;typeof se=="function"?g[w+1]=se:(g.splice(w,3),w-=3),sd(g)}}}function fv(){function a(P){P.canIntercept&&P.info==="react-transition"&&P.intercept({handler:function(){return new Promise(function(Z){return I=Z})},focusReset:"manual",scroll:"manual"})}function u(){I!==null&&(I(),I=null),w||setTimeout(g,20)}function g(){if(!w&&!navigation.transition){var P=navigation.currentEntry;P&&P.url!=null&&navigation.navigate(P.url,{state:P.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,I=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(g,100),function(){w=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),I!==null&&(I(),I=null)}}}function Xu(a){this._internalRoot=a}dc.prototype.render=Xu.prototype.render=function(a){var u=this._internalRoot;if(u===null)throw Error(h(409));var g=u.current,w=Eo();Mt(g,w,a,u,null,null)},dc.prototype.unmount=Xu.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var u=a.containerInfo;Mt(a.current,2,null,a,null,null),Xm(),u[gn]=null}};function dc(a){this._internalRoot=a}dc.prototype.unstable_scheduleHydration=function(a){if(a){var u=Lo();a={blockedOn:null,target:a,priority:u};for(var g=0;g<Xi.length&&u!==0&&u<Xi[g].priority;g++);Xi.splice(g,0,a),g===0&&Sr(a)}};var ld=e.version;if(ld!=="19.2.0")throw Error(h(527,ld,"19.2.0"));st.findDOMNode=function(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(h(188)):(a=Object.keys(a).join(","),Error(h(268,a)));return a=C(u),a=a!==null?k(a):null,a=a===null?null:a.stateNode,a};var Sf={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Ue,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{xe=au.inject(Sf),we=au}catch{}}return h_.createRoot=function(a,u){if(!d(a))throw Error(h(299));var g=!1,w="",I=gy,P=M0,Z=Lm;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onUncaughtError!==void 0&&(I=u.onUncaughtError),u.onCaughtError!==void 0&&(P=u.onCaughtError),u.onRecoverableError!==void 0&&(Z=u.onRecoverableError)),u=Dt(a,1,!1,null,null,g,w,null,I,P,Z,fv),a[gn]=u.current,ig(a),new Xu(u)},h_.hydrateRoot=function(a,u,g){if(!d(a))throw Error(h(299));var w=!1,I="",P=gy,Z=M0,se=Lm,Ie=null;return g!=null&&(g.unstable_strictMode===!0&&(w=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onUncaughtError!==void 0&&(P=g.onUncaughtError),g.onCaughtError!==void 0&&(Z=g.onCaughtError),g.onRecoverableError!==void 0&&(se=g.onRecoverableError),g.formState!==void 0&&(Ie=g.formState)),u=Dt(a,1,!0,u,g??null,w,I,Ie,P,Z,se,fv),u.context=St(null),g=u.current,w=Eo(),w=Kn(w),I=ul(w),I.callback=null,wo(g,I,w),g=w,u.current.lanes=g,Wi(u,g),vl(u),a[gn]=u.current,ig(a),new dc(u)},h_.version="19.2.0",h_}var i2;function GC(){if(i2)return cx.exports;i2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),cx.exports=VC(),cx.exports}var $C=GC();const ZC=fm($C),YC="modulepreload",HC=function(n){return"https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-24T10:45/"+n},r2={},PS=function(e,r,h){let d=Promise.resolve();if(r&&r.length>0){let C=function(k){return Promise.all(k.map(z=>Promise.resolve(z).then(F=>({status:"fulfilled",value:F}),F=>({status:"rejected",reason:F}))))};var y=C;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),E=c?.nonce||c?.getAttribute("nonce");d=C(r.map(k=>{if(k=HC(k),k in r2)return;r2[k]=!0;const z=k.endsWith(".css"),F=z?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${k}"]${F}`))return;const B=document.createElement("link");if(B.rel=z?"stylesheet":YC,z||(B.as="script"),B.crossOrigin="",B.href=k,E&&B.setAttribute("nonce",E),document.head.appendChild(B),z)return new Promise((Q,ie)=>{B.addEventListener("load",Q),B.addEventListener("error",()=>ie(new Error(`Unable to preload CSS for ${k}`)))})}))}function m(c){const E=new Event("vite:preloadError",{cancelable:!0});if(E.payload=c,window.dispatchEvent(E),!E.defaultPrevented)throw c}return d.then(c=>{for(const E of c||[])E.status==="rejected"&&m(E.reason);return e().catch(m)})},qC=K.createContext(null);function XC(n,e){const r=Array.isArray(n)?n[0]:n?n.x:0,h=Array.isArray(n)?n[1]:n?n.y:0,d=Array.isArray(e)?e[0]:e?e.x:0,m=Array.isArray(e)?e[1]:e?e.y:0;return r===d&&h===m}function js(n,e){if(n===e)return!0;if(!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!js(n[r],e[r]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const r=Object.keys(n),h=Object.keys(e);if(r.length!==h.length)return!1;for(const d of r)if(!e.hasOwnProperty(d)||!js(n[d],e[d]))return!1;return!0}return!1}function a2(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function o2(n,e){const r=e.viewState||e,h={};if("longitude"in r&&"latitude"in r&&(r.longitude!==n.center.lng||r.latitude!==n.center.lat)){const d=n.center.constructor;h.center=new d(r.longitude,r.latitude)}return"zoom"in r&&r.zoom!==n.zoom&&(h.zoom=r.zoom),"bearing"in r&&r.bearing!==n.bearing&&(h.bearing=r.bearing),"pitch"in r&&r.pitch!==n.pitch&&(h.pitch=r.pitch),r.padding&&n.padding&&!js(r.padding,n.padding)&&(h.padding=r.padding),h}const WC=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function s2(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const e={};for(const h of n.layers)e[h.id]=h;const r=n.layers.map(h=>{let d=null;"interactive"in h&&(d=Object.assign({},h),delete d.interactive);const m=e[h.ref];if(m){d=d||Object.assign({},h),delete d.ref;for(const y of WC)y in m&&(d[y]=m[y])}return d||h});return{...n,layers:r}}const l2={version:8,sources:{},layers:[]},c2={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},u2={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},h2={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},QC=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],KC=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Og{constructor(e,r,h){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=d=>{const m=this.props[h2[d.type]];m?m(d):d.type==="error"&&console.error(d.error)},this._onCameraEvent=d=>{if(this._internalUpdate)return;d.viewState=this._propsedCameraUpdate||a2(this._map.transform);const m=this.props[u2[d.type]];m&&m(d)},this._onCameraUpdate=d=>this._internalUpdate?d:(this._propsedCameraUpdate=a2(d),o2(d,this.props)),this._onPointerEvent=d=>{(d.type==="mousemove"||d.type==="mouseout")&&this._updateHover(d);const m=this.props[c2[d.type]];m&&(this.props.interactiveLayerIds&&d.type!=="mouseover"&&d.type!=="mouseout"&&(d.features=this._hoveredFeatures||this._queryRenderedFeatures(d.point)),m(d),delete d.features)},this._MapClass=e,this.props=r,this._initialize(h)}get map(){return this._map}setProps(e){const r=this.props;this.props=e;const h=this._updateSettings(e,r),d=this._updateSize(e),m=this._updateViewState(e);this._updateStyle(e,r),this._updateStyleComponents(e),this._updateHandlers(e,r),(h||d||m&&!this._map.isMoving())&&this.redraw()}static reuse(e,r){const h=Og.savedMaps.pop();if(!h)return null;const d=h.map,m=d.getContainer();for(r.className=m.className;m.childNodes.length>0;)r.appendChild(m.childNodes[0]);d._container=r;const y=d._resizeObserver;y&&(y.disconnect(),y.observe(r)),h.setProps({...e,styleDiffing:!1}),d.resize();const{initialViewState:c}=e;return c&&(c.bounds?d.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):h._updateViewState(c)),d.isStyleLoaded()?d.fire("load"):d.once("style.load",()=>d.fire("load")),d._update(),h}_initialize(e){const{props:r}=this,{mapStyle:h=l2}=r,d={...r,...r.initialViewState,container:e,style:s2(h)},m=d.initialViewState||d.viewState||d;if(Object.assign(d,{center:[m.longitude||0,m.latitude||0],zoom:m.zoom||0,pitch:m.pitch||0,bearing:m.bearing||0}),r.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,r.gl)}const y=new this._MapClass(d);m.padding&&y.setPadding(m.padding),r.cursor&&(y.getCanvas().style.cursor=r.cursor),y.transformCameraUpdate=this._onCameraUpdate,y.on("style.load",()=>{this._styleComponents={light:y.getLight(),sky:y.getSky(),projection:y.getProjection?.(),terrain:y.getTerrain()},this._updateStyleComponents(this.props)}),y.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in c2)y.on(c,this._onPointerEvent);for(const c in u2)y.on(c,this._onCameraEvent);for(const c in h2)y.on(c,this._onEvent);this._map=y}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),Og.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){const{viewState:r}=e;if(r){const h=this._map;if(r.width!==h.transform.width||r.height!==h.transform.height)return h.resize(),!0}return!1}_updateViewState(e){const r=this._map,h=r.transform;if(!r.isMoving()){const m=o2(h,e);if(Object.keys(m).length>0)return this._internalUpdate=!0,r.jumpTo(m),this._internalUpdate=!1,!0}return!1}_updateSettings(e,r){const h=this._map;let d=!1;for(const m of QC)m in e&&!js(e[m],r[m])&&(d=!0,h[`set${m[0].toUpperCase()}${m.slice(1)}`]?.call(h,e[m]));return d}_updateStyle(e,r){if(e.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==r.mapStyle){const{mapStyle:h=l2,styleDiffing:d=!0}=e,m={diff:d};"localIdeographFontFamily"in e&&(m.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(s2(h),m)}}_updateStyleComponents({light:e,projection:r,sky:h,terrain:d}){const m=this._map,y=this._styleComponents;m.style._loaded&&(e&&!js(e,y.light)&&(y.light=e,m.setLight(e)),r&&!js(r,y.projection)&&r!==y.projection?.type&&(y.projection=typeof r=="string"?{type:r}:r,m.setProjection?.(y.projection)),h&&!js(h,y.sky)&&(y.sky=h,m.setSky(h)),d!==void 0&&!js(d,y.terrain)&&(!d||m.getSource(d.source))&&(y.terrain=d,m.setTerrain(d)))}_updateHandlers(e,r){const h=this._map;for(const d of KC){const m=e[d]??!0,y=r[d]??!0;js(m,y)||(m?h[d].enable(m):h[d].disable())}}_queryRenderedFeatures(e){const r=this._map,{interactiveLayerIds:h=[]}=this.props;try{return r.queryRenderedFeatures(e,{layers:h.filter(r.getLayer.bind(r))})}catch{return[]}}_updateHover(e){const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const d=e.type,m=this._hoveredFeatures?.length>0,y=this._queryRenderedFeatures(e.point),c=y.length>0;!c&&m&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=y,c&&!m&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=d}else this._hoveredFeatures=null}}Og.savedMaps=[];const JC=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function eD(n){if(!n)return null;const e=n.map,r={getMap:()=>e};for(const h of tD(e))!(h in r)&&!JC.includes(h)&&(r[h]=e[h].bind(e));return r}function tD(n){const e=new Set;let r=n;for(;r;){for(const h of Object.getOwnPropertyNames(r))h[0]!=="_"&&typeof n[h]=="function"&&h!=="fire"&&h!=="setEventedParent"&&e.add(h);r=Object.getPrototypeOf(r)}return Array.from(e)}const nD=typeof document<"u"?K.useLayoutEffect:K.useEffect;function iD(n,e){const{RTLTextPlugin:r,maxParallelImageRequests:h,workerCount:d,workerUrl:m}=e;if(r&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:y,lazy:c=!0}=typeof r=="string"?{pluginUrl:r}:r;n.setRTLTextPlugin(y,E=>{E&&console.error(E)},c)}h!==void 0&&n.setMaxParallelImageRequests(h),d!==void 0&&n.setWorkerCount(d),m!==void 0&&n.setWorkerUrl(m)}const Xg=K.createContext(null);function rD(n,e){const r=K.useContext(qC),[h,d]=K.useState(null),m=K.useRef(),{current:y}=K.useRef({mapLib:null,map:null});K.useEffect(()=>{const C=n.mapLib;let k=!0,z;return Promise.resolve(C||PS(()=>Promise.resolve().then(()=>BS),void 0)).then(F=>{if(!k)return;if(!F)throw new Error("Invalid mapLib");const B="Map"in F?F:F.default;if(!B.Map)throw new Error("Invalid mapLib");iD(B,n),n.reuseMaps&&(z=Og.reuse(n,m.current)),z||(z=new Og(B.Map,n,m.current)),y.map=eD(z),y.mapLib=B,d(z),r?.onMapMount(y.map,n.id)}).catch(F=>{const{onError:B}=n;B?B({type:"error",target:null,originalEvent:null,error:F}):console.error(F)}),()=>{k=!1,z&&(r?.onMapUnmount(n.id),n.reuseMaps?z.recycle():z.destroy())}},[]),nD(()=>{h&&h.setProps(n)}),K.useImperativeHandle(e,()=>y.map,[h]);const c=K.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),E={height:"100%"};return K.createElement("div",{id:n.id,ref:m,style:c},h&&K.createElement(Xg.Provider,{value:y},K.createElement("div",{"mapboxgl-children":"",style:E},n.children)))}const aD=K.forwardRef(rD);var db=OS();const Wp=fm(db),oD=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function kd(n,e){if(!n||!e)return;const r=n.style;for(const h in e){const d=e[h];Number.isFinite(d)&&!oD.test(h)?r[h]=`${d}px`:r[h]=d}}function LS(n,e){if(n===e)return null;const r=d2(n),h=d2(e),d=[];for(const m of h)r.has(m)||d.push(m);for(const m of r)h.has(m)||d.push(m);return d.length===0?null:d}function d2(n){return new Set(n?n.trim().split(/\s+/):[])}const f2=K.memo(K.forwardRef((n,e)=>{const{map:r,mapLib:h}=K.useContext(Xg),d=K.useRef({props:n}),m=K.useMemo(()=>{let ue=!1;K.Children.forEach(n.children,ke=>{ke&&(ue=!0)});const Ae={...n,element:ue?document.createElement("div"):void 0},Te=new h.Marker(Ae);return Te.setLngLat([n.longitude,n.latitude]),Te.getElement().addEventListener("click",ke=>{d.current.props.onClick?.({type:"click",target:Te,originalEvent:ke})}),Te.on("dragstart",ke=>{const be=ke;be.lngLat=m.getLngLat(),d.current.props.onDragStart?.(be)}),Te.on("drag",ke=>{const be=ke;be.lngLat=m.getLngLat(),d.current.props.onDrag?.(be)}),Te.on("dragend",ke=>{const be=ke;be.lngLat=m.getLngLat(),d.current.props.onDragEnd?.(be)}),Te},[]);K.useEffect(()=>(m.addTo(r.getMap()),()=>{m.remove()}),[]);const{longitude:y,latitude:c,offset:E,style:C,draggable:k=!1,popup:z=null,rotation:F=0,rotationAlignment:B="auto",pitchAlignment:Q="auto"}=n;K.useEffect(()=>{kd(m.getElement(),C)},[C]),K.useImperativeHandle(e,()=>m,[]);const ie=d.current.props;(m.getLngLat().lng!==y||m.getLngLat().lat!==c)&&m.setLngLat([y,c]),E&&!XC(m.getOffset(),E)&&m.setOffset(E),m.isDraggable()!==k&&m.setDraggable(k),m.getRotation()!==F&&m.setRotation(F),m.getRotationAlignment()!==B&&m.setRotationAlignment(B),m.getPitchAlignment()!==Q&&m.setPitchAlignment(Q),m.getPopup()!==z&&m.setPopup(z);const ne=LS(ie.className,n.className);if(ne)for(const ue of ne)m.toggleClassName(ue);return d.current.props=n,db.createPortal(n.children,m.getElement())})),zS=K.memo(K.forwardRef((n,e)=>{const{map:r,mapLib:h}=K.useContext(Xg),d=K.useMemo(()=>document.createElement("div"),[]),m=K.useRef({props:n}),y=K.useMemo(()=>{const c={...n},E=new h.Popup(c);return E.setLngLat([n.longitude,n.latitude]),E.once("open",C=>{m.current.props.onOpen?.(C)}),E},[]);if(K.useEffect(()=>{const c=E=>{m.current.props.onClose?.(E)};return y.on("close",c),y.setDOMContent(d).addTo(r.getMap()),()=>{y.off("close",c),y.isOpen()&&y.remove()}},[]),K.useEffect(()=>{kd(y.getElement(),n.style)},[n.style]),K.useImperativeHandle(e,()=>y,[]),y.isOpen()){const c=m.current.props;(y.getLngLat().lng!==n.longitude||y.getLngLat().lat!==n.latitude)&&y.setLngLat([n.longitude,n.latitude]),n.offset&&!js(c.offset,n.offset)&&y.setOffset(n.offset),(c.anchor!==n.anchor||c.maxWidth!==n.maxWidth)&&(y.options.anchor=n.anchor,y.setMaxWidth(n.maxWidth));const E=LS(c.className,n.className);if(E)for(const C of E)y.toggleClassName(C);m.current.props=n}return db.createPortal(n.children,d)}));function pm(n,e,r,h){const d=K.useContext(Xg),m=K.useMemo(()=>n(d),[]);return K.useEffect(()=>{const y=e,c=null,E=typeof e=="function"?e:null,{map:C}=d;return C.hasControl(m)||(C.addControl(m,y?.position),c&&c(d)),()=>{E&&E(d),C.hasControl(m)&&C.removeControl(m)}},[]),m}function sD(n){const e=pm(({mapLib:r})=>new r.AttributionControl(n),{position:n.position});return K.useEffect(()=>{kd(e._container,n.style)},[n.style]),null}K.memo(sD);function lD(n){const e=pm(({mapLib:r})=>new r.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return K.useEffect(()=>{kd(e._controlContainer,n.style)},[n.style]),null}K.memo(lD);function cD(n,e){const r=K.useRef({props:n}),h=pm(({mapLib:d})=>{const m=new d.GeolocateControl(n),y=m._setupUI;return m._setupUI=()=>{m._container.hasChildNodes()||y()},m.on("geolocate",c=>{r.current.props.onGeolocate?.(c)}),m.on("error",c=>{r.current.props.onError?.(c)}),m.on("outofmaxbounds",c=>{r.current.props.onOutOfMaxBounds?.(c)}),m.on("trackuserlocationstart",c=>{r.current.props.onTrackUserLocationStart?.(c)}),m.on("trackuserlocationend",c=>{r.current.props.onTrackUserLocationEnd?.(c)}),m},{position:n.position});return r.current.props=n,K.useImperativeHandle(e,()=>h,[]),K.useEffect(()=>{kd(h._container,n.style)},[n.style]),null}K.memo(K.forwardRef(cD));function uD(n){const e=pm(({mapLib:r})=>new r.NavigationControl(n),{position:n.position});return K.useEffect(()=>{kd(e._container,n.style)},[n.style]),null}const hD=K.memo(uD);function dD(n){const e=pm(({mapLib:m})=>new m.ScaleControl(n),{position:n.position}),r=K.useRef(n),h=r.current;r.current=n;const{style:d}=n;return n.maxWidth!==void 0&&n.maxWidth!==h.maxWidth&&(e.options.maxWidth=n.maxWidth),n.unit!==void 0&&n.unit!==h.unit&&e.setUnit(n.unit),K.useEffect(()=>{kd(e._container,d)},[d]),null}K.memo(dD);function fD(n){const e=pm(({mapLib:r})=>new r.TerrainControl(n),{position:n.position});return K.useEffect(()=>{kd(e._container,n.style)},[n.style]),null}K.memo(fD);function pD(n){const e=pm(({mapLib:r})=>new r.LogoControl(n),{position:n.position});return K.useEffect(()=>{kd(e._container,n.style)},[n.style]),null}K.memo(pD);function Bv(n,e){if(!n)throw new Error(e)}let mD=0;function gD(n,e,r){if(n.style&&n.style._loaded){const h={...r};return delete h.id,delete h.children,n.addSource(e,h),n.getSource(e)}return null}function yD(n,e,r){Bv(e.id===r.id,"source id changed"),Bv(e.type===r.type,"source type changed");let h="",d=0;for(const y in e)y!=="children"&&y!=="id"&&!js(r[y],e[y])&&(h=y,d++);if(!d)return;const m=e.type;if(m==="geojson")n.setData(e.data);else if(m==="image")n.updateImage({url:e.url,coordinates:e.coordinates});else switch(h){case"coordinates":n.setCoordinates?.(e.coordinates);break;case"url":n.setUrl?.(e.url);break;case"tiles":n.setTiles?.(e.tiles);break;default:console.warn(`Unable to update <Source> prop: ${h}`)}}function _D(n){const e=K.useContext(Xg).map.getMap(),r=K.useRef(n),[,h]=K.useState(0),d=K.useMemo(()=>n.id||`jsx-source-${mD++}`,[]);K.useEffect(()=>{if(e){const y=()=>setTimeout(()=>h(c=>c+1),0);return e.on("styledata",y),y(),()=>{if(e.off("styledata",y),e.style&&e.style._loaded&&e.getSource(d)){const c=e.getStyle()?.layers;if(c)for(const E of c)E.source===d&&e.removeLayer(E.id);e.removeSource(d)}}}},[e]);let m=e&&e.style&&e.getSource(d);return m?yD(m,n,r.current):m=gD(e,d,n),r.current=n,m&&K.Children.map(n.children,y=>y&&K.cloneElement(y,{source:d}))||null}function vD(n,e,r,h){if(Bv(r.id===h.id,"layer id changed"),Bv(r.type===h.type,"layer type changed"),r.type==="custom"||h.type==="custom")return;const{layout:d={},paint:m={},filter:y,minzoom:c,maxzoom:E,beforeId:C}=r;if(C!==h.beforeId&&n.moveLayer(e,C),d!==h.layout){const k=h.layout||{};for(const z in d)js(d[z],k[z])||n.setLayoutProperty(e,z,d[z]);for(const z in k)d.hasOwnProperty(z)||n.setLayoutProperty(e,z,void 0)}if(m!==h.paint){const k=h.paint||{};for(const z in m)js(m[z],k[z])||n.setPaintProperty(e,z,m[z]);for(const z in k)m.hasOwnProperty(z)||n.setPaintProperty(e,z,void 0)}js(y,h.filter)||n.setFilter(e,y),(c!==h.minzoom||E!==h.maxzoom)&&n.setLayerZoomRange(e,c,E)}function bD(n,e,r){if(n.style&&n.style._loaded&&(!("source"in r)||n.getSource(r.source))){const h={...r,id:e};delete h.beforeId,n.addLayer(h,r.beforeId)}}let xD=0;function p2(n){const e=K.useContext(Xg).map.getMap(),r=K.useRef(n),[,h]=K.useState(0),d=K.useMemo(()=>n.id||`jsx-layer-${xD++}`,[]);if(K.useEffect(()=>{if(e){const y=()=>h(c=>c+1);return e.on("styledata",y),y(),()=>{e.off("styledata",y),e.style&&e.style._loaded&&e.getLayer(d)&&e.removeLayer(d)}}},[e]),e&&e.style&&e.getLayer(d))try{vD(e,d,n,r.current)}catch(y){console.warn(y)}else bD(e,d,n);return r.current=n,null}var Dv={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.9.0/LICENSE.txt
 */var wD=Dv.exports,m2;function TD(){return m2||(m2=1,function(n,e){(function(r,h){n.exports=h()})(wD,function(){var r={},h={};function d(y,c,E){if(h[y]=E,y==="index"){var C="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",k={};return h.shared(k),h.index(r,k),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([C],{type:"text/javascript"}))),r}}d("shared",["exports"],function(y){function c(s,i,o,f){return new(o||(o=Promise))(function(_,T){function S(L){try{D(f.next(L))}catch(N){T(N)}}function M(L){try{D(f.throw(L))}catch(N){T(N)}}function D(L){var N;L.done?_(L.value):(N=L.value,N instanceof o?N:new o(function(V){V(N)})).then(S,M)}D((f=f.apply(s,i||[])).next())})}function E(s,i){this.x=s,this.y=i}function C(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var k,z;typeof SuppressedError=="function"&&SuppressedError,E.prototype={clone(){return new E(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,i){return this.clone()._rotateAround(s,i)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const i=s.x-this.x,o=s.y-this.y;return i*i+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult(s){const i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const i=Math.cos(s),o=Math.sin(s),f=o*this.x+i*this.y;return this.x=i*this.x-o*this.y,this.y=f,this},_rotateAround(s,i){const o=Math.cos(s),f=Math.sin(s),_=i.y+f*(this.x-i.x)+o*(this.y-i.y);return this.x=i.x+o*(this.x-i.x)-f*(this.y-i.y),this.y=_,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:E},E.convert=function(s){if(s instanceof E)return s;if(Array.isArray(s))return new E(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new E(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};var F=function(){if(z)return k;function s(i,o,f,_){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(_-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=_}return z=1,k=s,s.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,_=0;_<8;_++){var T=this.sampleCurveX(f)-i;if(Math.abs(T)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=T/S}var M=0,D=1;for(f=i,_=0;_<20&&(T=this.sampleCurveX(f),!(Math.abs(T-i)<o));_++)i>T?M=f:D=f,f=.5*(D-M)+M;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},k}(),B=C(F);let Q,ie;function ne(){return Q==null&&(Q=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Q}function ue(){if(ie==null&&(ie=!1,ne())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let f=0;f<5*5;f++){const _=4*f;i.fillStyle=`rgb(${_},${_+1},${_+2})`,i.fillRect(f%5,Math.floor(f/5),1,1)}const o=i.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&o[f]!==f){ie=!0;break}}}return ie||!1}var Ae=1e-6,Te=typeof Float32Array<"u"?Float32Array:Array;function ke(){var s=new Te(9);return Te!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function be(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Me(){var s=new Te(3);return Te!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Fe(s){var i=s[0],o=s[1],f=s[2];return Math.sqrt(i*i+o*o+f*f)}function ot(s,i,o){var f=new Te(3);return f[0]=s,f[1]=i,f[2]=o,f}function Ee(s,i,o){return s[0]=i[0]+o[0],s[1]=i[1]+o[1],s[2]=i[2]+o[2],s}function Je(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s}function Et(s,i,o){var f=i[0],_=i[1],T=i[2],S=o[0],M=o[1],D=o[2];return s[0]=_*D-T*M,s[1]=T*S-f*D,s[2]=f*M-_*S,s}var Tt,zt=Fe;function Zt(s,i,o){var f=i[0],_=i[1],T=i[2],S=i[3];return s[0]=o[0]*f+o[4]*_+o[8]*T+o[12]*S,s[1]=o[1]*f+o[5]*_+o[9]*T+o[13]*S,s[2]=o[2]*f+o[6]*_+o[10]*T+o[14]*S,s[3]=o[3]*f+o[7]*_+o[11]*T+o[15]*S,s}function Gt(){var s=new Te(4);return Te!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ue(s,i,o,f){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",T=Math.PI/360;i*=T,f*=T,o*=T;var S=Math.sin(i),M=Math.cos(i),D=Math.sin(o),L=Math.cos(o),N=Math.sin(f),V=Math.cos(f);switch(_){case"xyz":s[0]=S*L*V+M*D*N,s[1]=M*D*V-S*L*N,s[2]=M*L*N+S*D*V,s[3]=M*L*V-S*D*N;break;case"xzy":s[0]=S*L*V-M*D*N,s[1]=M*D*V-S*L*N,s[2]=M*L*N+S*D*V,s[3]=M*L*V+S*D*N;break;case"yxz":s[0]=S*L*V+M*D*N,s[1]=M*D*V-S*L*N,s[2]=M*L*N-S*D*V,s[3]=M*L*V+S*D*N;break;case"yzx":s[0]=S*L*V+M*D*N,s[1]=M*D*V+S*L*N,s[2]=M*L*N-S*D*V,s[3]=M*L*V-S*D*N;break;case"zxy":s[0]=S*L*V-M*D*N,s[1]=M*D*V+S*L*N,s[2]=M*L*N+S*D*V,s[3]=M*L*V-S*D*N;break;case"zyx":s[0]=S*L*V-M*D*N,s[1]=M*D*V+S*L*N,s[2]=M*L*N-S*D*V,s[3]=M*L*V+S*D*N;break;default:throw new Error("Unknown angle order "+_)}return s}function st(){var s=new Te(2);return Te!=Float32Array&&(s[0]=0,s[1]=0),s}function xt(s,i){var o=new Te(2);return o[0]=s,o[1]=i,o}Me(),Tt=new Te(4),Te!=Float32Array&&(Tt[0]=0,Tt[1]=0,Tt[2]=0,Tt[3]=0),Me(),ot(1,0,0),ot(0,1,0),Gt(),Gt(),ke(),st();const ut=8192;function Ut(s,i,o){return i*(ut/(s.tileSize*Math.pow(2,o-s.tileID.overscaledZ)))}function De(s,i){return(s%i+i)%i}function Qe(s,i,o){return s*(1-o)+i*o}function dt(s){if(s<=0)return 0;if(s>=1)return 1;const i=s*s,o=i*s;return 4*(s<.5?o:3*(s-i)+o-.75)}function _t(s,i,o,f){const _=new B(s,i,o,f);return T=>_.solve(T)}const Ot=_t(.25,.1,.25,1);function jt(s,i,o){return Math.min(o,Math.max(i,s))}function Kt(s,i,o){const f=o-i,_=((s-i)%f+f)%f+i;return _===i?o:_}function cn(s,...i){for(const o of i)for(const f in o)s[f]=o[f];return s}let mn=1;function lr(s,i,o){const f={};for(const _ in s)f[_]=i.call(this,s[_],_,s);return f}function cr(s,i,o){const f={};for(const _ in s)i.call(this,s[_],_,s)&&(f[_]=s[_]);return f}function xi(s){return Array.isArray(s)?s.map(xi):typeof s=="object"&&s?lr(s,xi):s}const Wn={};function Ln(s){Wn[s]||(typeof console<"u"&&console.warn(s),Wn[s]=!0)}function Sn(s,i,o){return(o.y-s.y)*(i.x-s.x)>(i.y-s.y)*(o.x-s.x)}function gr(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let oa=null;function po(s){if(oa==null){const i=s.navigator?s.navigator.userAgent:null;oa=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return oa}function Ar(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const Br="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ea(s,i,o,f,_){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(s,{timestamp:0});try{const S=T?.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const M=S.startsWith("BGR"),D=new Uint8ClampedArray(f*_*4);if(yield T.copyTo(D,function(L,N,V,Y,H){const W=4*Math.max(-N,0),ae=(Math.max(0,V)-V)*Y*4+W,le=4*Y,pe=Math.max(0,N),Ne=Math.max(0,V);return{rect:{x:pe,y:Ne,width:Math.min(L.width,N+Y)-pe,height:Math.min(L.height,V+H)-Ne},layout:[{offset:ae,stride:le}]}}(s,i,o,f,_)),M)for(let L=0;L<D.length;L+=4){const N=D[L];D[L]=D[L+2],D[L+2]=N}return D}finally{T.close()}})}let Ua,ga;function Oi(s,i,o,f){return s.addEventListener(i,o,f),{unsubscribe:()=>{s.removeEventListener(i,o,f)}}}function ys(s){return s*Math.PI/180}function dn(s){return s/Math.PI*180}const Mr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ur={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Pe="AbortError";function ee(){return new Error(Pe)}const te={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ce(s){return te.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const xe="global-dispatcher";class we extends Error{constructor(i,o,f,_){super(`AJAXError: ${o} (${i}): ${f}`),this.status=i,this.statusText=o,this.url=f,this.body=_}}const Oe=()=>gr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ge=function(s,i){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const f=ce(s.url);if(f)return f(s,i);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:xe},i)}if(!(/^file:/.test(o=s.url)||/^file:/.test(Oe())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,_){return c(this,void 0,void 0,function*(){const T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Oe(),signal:_.signal});let S,M;f.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{S=yield fetch(T)}catch(L){throw new we(0,L.message,f.url,new Blob)}if(!S.ok){const L=yield S.blob();throw new we(S.status,S.statusText,f.url,L)}M=f.type==="arrayBuffer"||f.type==="image"?S.arrayBuffer():f.type==="json"?S.json():S.text();const D=yield M;if(_.signal.aborted)throw ee();return{data:D,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(s,i);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:xe},i)}var o;return function(f,_){return new Promise((T,S)=>{var M;const D=new XMLHttpRequest;D.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(D.responseType="arraybuffer");for(const L in f.headers)D.setRequestHeader(L,f.headers[L]);f.type==="json"&&(D.responseType="text",!((M=f.headers)===null||M===void 0)&&M.Accept||D.setRequestHeader("Accept","application/json")),D.withCredentials=f.credentials==="include",D.onerror=()=>{S(new Error(D.statusText))},D.onload=()=>{if(!_.signal.aborted)if((D.status>=200&&D.status<300||D.status===0)&&D.response!==null){let L=D.response;if(f.type==="json")try{L=JSON.parse(D.response)}catch(N){return void S(N)}T({data:L,cacheControl:D.getResponseHeader("Cache-Control"),expires:D.getResponseHeader("Expires")})}else{const L=new Blob([D.response],{type:D.getResponseHeader("Content-Type")});S(new we(D.status,D.statusText,f.url,L))}},_.signal.addEventListener("abort",()=>{D.abort(),S(ee())}),D.send(f.body)})}(s,i)};function je(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const i=new URL(s),o=window.location;return i.protocol===o.protocol&&i.host===o.host}function tt(s,i,o){o[s]&&o[s].indexOf(i)!==-1||(o[s]=o[s]||[],o[s].push(i))}function yt(s,i,o){if(o&&o[s]){const f=o[s].indexOf(i);f!==-1&&o[s].splice(f,1)}}class rt{constructor(i,o={}){cn(this,o),this.type=i}}class Nt extends rt{constructor(i,o={}){super("error",cn({error:i},o))}}class Ht{on(i,o){return this._listeners=this._listeners||{},tt(i,o,this._listeners),{unsubscribe:()=>{this.off(i,o)}}}off(i,o){return yt(i,o,this._listeners),yt(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},tt(i,o,this._oneTimeListeners),this):new Promise(f=>this.once(i,f))}fire(i,o){typeof i=="string"&&(i=new rt(i,o||{}));const f=i.type;if(this.listens(f)){i.target=this;const _=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const M of _)M.call(this,i);const T=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const M of T)yt(f,M,this._oneTimeListeners),M.call(this,i);const S=this._eventedParent;S&&(cn(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(i))}else i instanceof Nt&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var Be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Cn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Un(s,i){const o={};for(const f in s)f!=="ref"&&(o[f]=s[f]);return Cn.forEach(f=>{f in i&&(o[f]=i[f])}),o}function Vt(s,i){if(Array.isArray(s)){if(!Array.isArray(i)||s.length!==i.length)return!1;for(let o=0;o<s.length;o++)if(!Vt(s[o],i[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&i!==null){if(typeof i!="object"||Object.keys(s).length!==Object.keys(i).length)return!1;for(const o in s)if(!Vt(s[o],i[o]))return!1;return!0}return s===i}function jn(s,i){s.push(i)}function hr(s,i,o){jn(o,{command:"addSource",args:[s,i[s]]})}function Wi(s,i,o){jn(i,{command:"removeSource",args:[s]}),o[s]=!0}function yr(s,i,o,f){Wi(s,o,f),hr(s,i,o)}function Ur(s,i,o){let f;for(f in s[o])if(Object.prototype.hasOwnProperty.call(s[o],f)&&f!=="data"&&!Vt(s[o][f],i[o][f]))return!1;for(f in i[o])if(Object.prototype.hasOwnProperty.call(i[o],f)&&f!=="data"&&!Vt(s[o][f],i[o][f]))return!1;return!0}function pi(s,i,o,f,_,T){s=s||{},i=i||{};for(const S in s)Object.prototype.hasOwnProperty.call(s,S)&&(Vt(s[S],i[S])||o.push({command:T,args:[f,S,i[S],_]}));for(const S in i)Object.prototype.hasOwnProperty.call(i,S)&&!Object.prototype.hasOwnProperty.call(s,S)&&(Vt(s[S],i[S])||o.push({command:T,args:[f,S,i[S],_]}))}function _r(s){return s.id}function Kn(s,i){return s[i.id]=i,s}class pt{constructor(i,o,f,_){this.message=(i?`${i}: `:"")+f,_&&(this.identifier=_),o!=null&&o.__line__&&(this.line=o.__line__)}}function Lo(s,...i){for(const o of i)for(const f in o)s[f]=o[f];return s}class Aa extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class vr{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[f,_]of o)this.bindings[f]=_}concat(i){return new vr(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const $n={kind:"null"},vt={kind:"number"},gn={kind:"string"},_n={kind:"boolean"},Va={kind:"color"},_s={kind:"projectionDefinition"},zo={kind:"object"},un={kind:"value"},kl={kind:"collator"},vs={kind:"formatted"},mo={kind:"padding"},qs={kind:"colorArray"},Ma={kind:"numberArray"},$i={kind:"resolvedImage"},Ji={kind:"variableAnchorOffsetCollection"};function Ca(s,i){return{kind:"array",itemType:s,N:i}}function ri(s){if(s.kind==="array"){const i=ri(s.itemType);return typeof s.N=="number"?`array<${i}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${i}>`}return s.kind}const bs=[$n,vt,gn,_n,Va,_s,vs,zo,Ca(un),mo,Ma,qs,$i,Ji];function pu(s,i){if(i.kind==="error")return null;if(s.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!pu(s.itemType,i.itemType))&&(typeof s.N!="number"||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if(s.kind==="value"){for(const o of bs)if(!pu(o,i))return null}}return`Expected ${ri(s)} but found ${ri(i)} instead.`}function Nd(s,i){return i.some(o=>o.kind===s.kind)}function Ol(s,i){return i.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function Xs(s,i){return s.kind==="array"&&i.kind==="array"?s.itemType.kind===i.itemType.kind&&typeof s.N=="number":s.kind===i.kind}const mh=.96422,mu=.82521,xs=4/29,Jr=6/29,Zf=3*Jr*Jr,uy=Jr*Jr*Jr,Yf=Math.PI/180,bm=180/Math.PI;function gh(s){return(s%=360)<0&&(s+=360),s}function Hf([s,i,o,f]){let _,T;const S=yh((.2225045*(s=Vr(s))+.7168786*(i=Vr(i))+.0606169*(o=Vr(o)))/1);s===i&&i===o?_=T=S:(_=yh((.4360747*s+.3850649*i+.1430804*o)/mh),T=yh((.0139322*s+.0971045*i+.7141733*o)/mu));const M=116*S-16;return[M<0?0:M,500*(_-S),200*(S-T),f]}function Vr(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function yh(s){return s>uy?Math.pow(s,1/3):s/Zf+xs}function qf([s,i,o,f]){let _=(s+16)/116,T=isNaN(i)?_:_+i/500,S=isNaN(o)?_:_-o/200;return _=1*Pl(_),T=mh*Pl(T),S=mu*Pl(S),[Ws(3.1338561*T-1.6168667*_-.4906146*S),Ws(-.9787684*T+1.9161415*_+.033454*S),Ws(.0719453*T-.2289914*_+1.4052427*S),f]}function Ws(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Pl(s){return s>Jr?s*s*s:Zf*(s-xs)}const xm=Object.hasOwn||function(s,i){return Object.prototype.hasOwnProperty.call(s,i)};function gu(s,i){return xm(s,i)?s[i]:void 0}function ws(s){return parseInt(s.padEnd(2,s),16)/255}function Xf(s,i){return sa(i?s/100:s,0,1)}function sa(s,i,o){return Math.min(Math.max(i,s),o)}function zn(s){return!s.some(Number.isNaN)}const Ll={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ya(s,i,o){return s+o*(i-s)}function Sc(s,i,o){return s.map((f,_)=>ya(f,i[_],o))}class xn{constructor(i,o,f,_=1,T=!0){this.r=i,this.g=o,this.b=f,this.a=_,T||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[i,o,f,_]))}static parse(i){if(i instanceof xn)return i;if(typeof i!="string")return;const o=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=gu(Ll,f);if(_){const[S,M,D]=_;return[S/255,M/255,D/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const S=f.length<6?1:2;let M=1;return[ws(f.slice(M,M+=S)),ws(f.slice(M,M+=S)),ws(f.slice(M,M+=S)),ws(f.slice(M,M+S)||"ff")]}if(f.startsWith("rgb")){const S=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[M,D,L,N,V,Y,H,W,ae,le,pe,Ne]=S,ve=[N||" ",H||" ",le].join("");if(ve==="  "||ve==="  /"||ve===",,"||ve===",,,"){const Ce=[L,Y,ae].join(""),Ze=Ce==="%%%"?100:Ce===""?255:0;if(Ze){const Ke=[sa(+D/Ze,0,1),sa(+V/Ze,0,1),sa(+W/Ze,0,1),pe?Xf(+pe,Ne):1];if(zn(Ke))return Ke}}return}}const T=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[S,M,D,L,N,V,Y,H,W]=T,ae=[D||" ",N||" ",Y].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const le=[+M,sa(+L,0,100),sa(+V,0,100),H?Xf(+H,W):1];if(zn(le))return function([pe,Ne,ve,Ce]){function Ze(Ke){const ft=(Ke+pe/30)%12,Dt=Ne*Math.min(ve,1-ve);return ve-Dt*Math.max(-1,Math.min(ft-3,9-ft,1))}return pe=gh(pe),Ne/=100,ve/=100,[Ze(0),Ze(8),Ze(4),Ce]}(le)}}}(i);return o?new xn(...o,!1):void 0}get rgb(){const{r:i,g:o,b:f,a:_}=this,T=_||1/0;return this.overwriteGetter("rgb",[i/T,o/T,f/T,_])}get hcl(){return this.overwriteGetter("hcl",function(i){const[o,f,_,T]=Hf(i),S=Math.sqrt(f*f+_*_);return[Math.round(1e4*S)?gh(Math.atan2(_,f)*bm):NaN,S,o,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Hf(this.rgb))}overwriteGetter(i,o){return Object.defineProperty(this,i,{value:o}),o}toString(){const[i,o,f,_]=this.rgb;return`rgba(${[i,o,f].map(T=>Math.round(255*T)).join(",")},${_})`}static interpolate(i,o,f,_="rgb"){switch(_){case"rgb":{const[T,S,M,D]=Sc(i.rgb,o.rgb,f);return new xn(T,S,M,D,!1)}case"hcl":{const[T,S,M,D]=i.hcl,[L,N,V,Y]=o.hcl;let H,W;if(isNaN(T)||isNaN(L))isNaN(T)?isNaN(L)?H=NaN:(H=L,M!==1&&M!==0||(W=N)):(H=T,V!==1&&V!==0||(W=S));else{let ve=L-T;L>T&&ve>180?ve-=360:L<T&&T-L>180&&(ve+=360),H=T+f*ve}const[ae,le,pe,Ne]=function([ve,Ce,Ze,Ke]){return ve=isNaN(ve)?0:ve*Yf,qf([Ze,Math.cos(ve)*Ce,Math.sin(ve)*Ce,Ke])}([H,W??ya(S,N,f),ya(M,V,f),ya(D,Y,f)]);return new xn(ae,le,pe,Ne,!1)}case"lab":{const[T,S,M,D]=qf(Sc(i.lab,o.lab,f));return new xn(T,S,M,D,!1)}}}}xn.black=new xn(0,0,0,1),xn.white=new xn(1,1,1,1),xn.transparent=new xn(0,0,0,0),xn.red=new xn(1,0,0,1);class Ga{constructor(i,o,f){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ec=["bottom","center","top"];class zl{constructor(i,o,f,_,T,S){this.text=i,this.image=o,this.scale=f,this.fontStack=_,this.textColor=T,this.verticalAlign=S}}class Cr{constructor(i){this.sections=i}static fromString(i){return new Cr([new zl(i,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Cr?i:Cr.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class er{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof er)return i;if(typeof i=="number")return new er([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const o of i)if(typeof o!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new er(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new er(Sc(i.values,o.values,f))}}class Dr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Dr)return i;if(typeof i=="number")return new Dr([i]);if(Array.isArray(i)){for(const o of i)if(typeof o!="number")return;return new Dr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){return new Dr(Sc(i.values,o.values,f))}}class Ir{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Ir)return i;if(typeof i=="string"){const f=xn.parse(i);return f?new Ir([f]):void 0}if(!Array.isArray(i))return;const o=[];for(const f of i){if(typeof f!="string")return;const _=xn.parse(f);if(!_)return;o.push(_)}return new Ir(o)}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f,_="rgb"){const T=[];if(i.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let S=0;S<i.values.length;S++)T.push(xn.interpolate(i.values[S],o.values[S],f,_));return new Ir(T)}}class wi extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const Ts=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Qi{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Qi)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let o=0;o<i.length;o+=2){const f=i[o],_=i[o+1];if(typeof f!="string"||!Ts.has(f)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new Qi(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,o,f){const _=i.values,T=o.values;if(_.length!==T.length)throw new wi(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${o.toString()}`);const S=[];for(let M=0;M<_.length;M+=2){if(_[M]!==T[M])throw new wi(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${_[M]}, to[${M}]: ${T[M]}`);S.push(_[M]);const[D,L]=_[M+1],[N,V]=T[M+1];S.push([ya(D,N,f),ya(L,V,f)])}return new Qi(S)}}class _a{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new _a({name:i,available:!1}):null}}class Gr{constructor(i,o,f){this.from=i,this.to=o,this.transition=f}static interpolate(i,o,f){return new Gr(i,o,f)}static parse(i){return i instanceof Gr?i:Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"?new Gr(i[0],i[1],i[2]):typeof i=="object"&&typeof i.from=="string"&&typeof i.to=="string"&&typeof i.transition=="number"?new Gr(i.from,i.to,i.transition):typeof i=="string"?new Gr(i,i,1):void 0}}function go(s,i,o,f){return typeof s=="number"&&s>=0&&s<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[s,i,o,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[s,i,o,f]:[s,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ai(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Gr||s instanceof xn||s instanceof Ga||s instanceof Cr||s instanceof er||s instanceof Dr||s instanceof Ir||s instanceof Qi||s instanceof _a)return!0;if(Array.isArray(s)){for(const i of s)if(!ai(i))return!1;return!0}if(typeof s=="object"){for(const i in s)if(!ai(s[i]))return!1;return!0}return!1}function Pi(s){if(s===null)return $n;if(typeof s=="string")return gn;if(typeof s=="boolean")return _n;if(typeof s=="number")return vt;if(s instanceof xn)return Va;if(s instanceof Gr)return _s;if(s instanceof Ga)return kl;if(s instanceof Cr)return vs;if(s instanceof er)return mo;if(s instanceof Dr)return Ma;if(s instanceof Ir)return qs;if(s instanceof Qi)return Ji;if(s instanceof _a)return $i;if(Array.isArray(s)){const i=s.length;let o;for(const f of s){const _=Pi(f);if(o){if(o===_)continue;o=un;break}o=_}return Ca(o||un,i)}return zo}function Dn(s){const i=typeof s;return s===null?"":i==="string"||i==="number"||i==="boolean"?String(s):s instanceof xn||s instanceof Gr||s instanceof Cr||s instanceof er||s instanceof Dr||s instanceof Ir||s instanceof Qi||s instanceof _a?s.toString():JSON.stringify(s)}class tn{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!ai(i[1]))return o.error("invalid value");const f=i[1];let _=Pi(f);const T=o.expectedType;return _.kind!=="array"||_.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(_=T),new tn(_,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Qs={string:gn,number:vt,boolean:_n,object:zo};class vn{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f,_=1;const T=i[0];if(T==="array"){let M,D;if(i.length>2){const L=i[1];if(typeof L!="string"||!(L in Qs)||L==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);M=Qs[L],_++}else M=un;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);D=i[2],_++}f=Ca(M,D)}else{if(!Qs[T])throw new Error(`Types doesn't contain name = ${T}`);f=Qs[T]}const S=[];for(;_<i.length;_++){const M=o.parse(i[_],_,un);if(!M)return null;S.push(M)}return new vn(f,S)}evaluate(i){for(let o=0;o<this.args.length;o++){const f=this.args[o].evaluate(i);if(!pu(this.type,Pi(f)))return f;if(o===this.args.length-1)throw new wi(`Expected value to be of type ${ri(this.type)}, but found ${ri(Pi(f))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const ea={"to-boolean":_n,"to-color":Va,"to-number":vt,"to-string":gn};class tr{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[0];if(!ea[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&i.length!==2)return o.error("Expected one argument.");const _=ea[f],T=[];for(let S=1;S<i.length;S++){const M=o.parse(i[S],S,un);if(!M)return null;T.push(M)}return new tr(_,T)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let o,f;for(const _ of this.args){if(o=_.evaluate(i),f=null,o instanceof xn)return o;if(typeof o=="string"){const T=i.parseColor(o);if(T)return T}else if(Array.isArray(o)&&(f=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:go(o[0],o[1],o[2],o[3]),!f))return new xn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new wi(f||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const f of this.args){o=f.evaluate(i);const _=er.parse(o);if(_)return _}throw new wi(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const f of this.args){o=f.evaluate(i);const _=Dr.parse(o);if(_)return _}throw new wi(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const f of this.args){o=f.evaluate(i);const _=Ir.parse(o);if(_)return _}throw new wi(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const f of this.args){o=f.evaluate(i);const _=Qi.parse(o);if(_)return _}throw new wi(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const f of this.args){if(o=f.evaluate(i),o===null)return 0;const _=Number(o);if(!isNaN(_))return _}throw new wi(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Cr.fromString(Dn(this.args[0].evaluate(i)));case"resolvedImage":return _a.fromString(Dn(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return Dn(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const yu=["Unknown","Point","LineString","Polygon"];class Ks{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?yu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let o=this._parseColorCache.get(i);return o||(o=xn.parse(i),this._parseColorCache.set(i,o)),o}}class _h{constructor(i,o,f=[],_,T=new vr,S=[]){this.registry=i,this.path=f,this.key=f.map(M=>`[${M}]`).join(""),this.scope=T,this.errors=S,this.expectedType=_,this._isConstant=o}parse(i,o,f,_,T={}){return o?this.concat(o,f,_)._parse(i,T):this._parse(i,T)}_parse(i,o){function f(_,T,S){return S==="assert"?new vn(T,[_]):S==="coerce"?new tr(T,[_]):_}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=i[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[_];if(T){let S=T.parse(i,this);if(!S)return null;if(this.expectedType){const M=this.expectedType,D=S.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||D.kind!=="value"){if(M.kind==="projectionDefinition"&&["string","array"].includes(D.kind)||["color","formatted","resolvedImage"].includes(M.kind)&&["value","string"].includes(D.kind)||["padding","numberArray"].includes(M.kind)&&["value","number","array"].includes(D.kind)||M.kind==="colorArray"&&["value","string","array"].includes(D.kind)||M.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(D.kind))S=f(S,M,o.typeAnnotation||"coerce");else if(this.checkSubtype(M,D))return null}else S=f(S,M,o.typeAnnotation||"assert")}if(!(S instanceof tn)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const M=new Ks;try{S=new tn(S.type,S.evaluate(M))}catch(D){return this.error(D.message),null}}return S}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,f){const _=typeof i=="number"?this.path.concat(i):this.path,T=f?this.scope.concat(f):this.scope;return new _h(this.registry,this._isConstant,_,o||null,T,this.errors)}error(i,...o){const f=`${this.key}${o.map(_=>`[${_}]`).join("")}`;this.errors.push(new Aa(f,i))}checkSubtype(i,o){const f=pu(i,o);return f&&this.error(f),f}}class Nl{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let T=1;T<i.length-1;T+=2){const S=i[T];if(typeof S!="string")return o.error(`Expected string, but found ${typeof S} instead.`,T);if(/[^a-zA-Z0-9_]/.test(S))return o.error("Variable names must contain only alphanumeric characters or '_'.",T);const M=o.parse(i[T+1],T+1);if(!M)return null;f.push([S,M])}const _=o.parse(i[i.length-1],i.length-1,o.expectedType,f);return _?new Nl(f,_):null}outputDefined(){return this.result.outputDefined()}}class Ac{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const f=i[1];return o.scope.has(f)?new Ac(f,o.scope.get(f)):o.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Mc{constructor(i,o,f){this.type=i,this.index=o,this.input=f}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,vt),_=o.parse(i[2],2,Ca(o.expectedType||un));return f&&_?new Mc(_.type.itemType,f,_):null}evaluate(i){const o=this.index.evaluate(i),f=this.input.evaluate(i);if(o<0)throw new wi(`Array index out of bounds: ${o} < 0.`);if(o>=f.length)throw new wi(`Array index out of bounds: ${o} > ${f.length-1}.`);if(o!==Math.floor(o))throw new wi(`Array index must be an integer, but found ${o} instead.`);return f[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class Cc{constructor(i,o){this.type=_n,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,un),_=o.parse(i[2],2,un);return f&&_?Nd(f.type,[_n,gn,vt,$n,un])?new Cc(f,_):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ri(f.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!f)return!1;if(!Ol(o,["boolean","string","number","null"]))throw new wi(`Expected first argument to be of type boolean, string, number or null, but found ${ri(Pi(o))} instead.`);if(!Ol(f,["string","array"]))throw new wi(`Expected second argument to be of type array or string, but found ${ri(Pi(f))} instead.`);return f.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class _u{constructor(i,o,f){this.type=vt,this.needle=i,this.haystack=o,this.fromIndex=f}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,un),_=o.parse(i[2],2,un);if(!f||!_)return null;if(!Nd(f.type,[_n,gn,vt,$n,un]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ri(f.type)} instead`);if(i.length===4){const T=o.parse(i[3],3,vt);return T?new _u(f,_,T):null}return new _u(f,_)}evaluate(i){const o=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!Ol(o,["boolean","string","number","null"]))throw new wi(`Expected first argument to be of type boolean, string, number or null, but found ${ri(Pi(o))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(i)),Ol(f,["string"])){const T=f.indexOf(o,_);return T===-1?-1:[...f.slice(0,T)].length}if(Ol(f,["array"]))return f.indexOf(o,_);throw new wi(`Expected second argument to be of type array or string, but found ${ri(Pi(f))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Ss{constructor(i,o,f,_,T,S){this.inputType=i,this.type=o,this.input=f,this.cases=_,this.outputs=T,this.otherwise=S}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let f,_;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);const T={},S=[];for(let L=2;L<i.length-1;L+=2){let N=i[L];const V=i[L+1];Array.isArray(N)||(N=[N]);const Y=o.concat(L);if(N.length===0)return Y.error("Expected at least one branch label.");for(const W of N){if(typeof W!="number"&&typeof W!="string")return Y.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return Y.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return Y.error("Numeric branch labels must be integer values.");if(f){if(Y.checkSubtype(f,Pi(W)))return null}else f=Pi(W);if(T[String(W)]!==void 0)return Y.error("Branch labels must be unique.");T[String(W)]=S.length}const H=o.parse(V,L,_);if(!H)return null;_=_||H.type,S.push(H)}const M=o.parse(i[1],1,un);if(!M)return null;const D=o.parse(i[i.length-1],i.length-1,_);return D?M.type.kind!=="value"&&o.concat(1).checkSubtype(f,M.type)?null:new Ss(f,_,M,T,S,D):null}evaluate(i){const o=this.input.evaluate(i);return(Pi(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class $r{constructor(i,o,f){this.type=i,this.branches=o,this.otherwise=f}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const _=[];for(let S=1;S<i.length-1;S+=2){const M=o.parse(i[S],S,_n);if(!M)return null;const D=o.parse(i[S+1],S+1,f);if(!D)return null;_.push([M,D]),f=f||D.type}const T=o.parse(i[i.length-1],i.length-1,f);if(!T)return null;if(!f)throw new Error("Can't infer output type");return new $r(f,_,T)}evaluate(i){for(const[o,f]of this.branches)if(o.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,f]of this.branches)i(o),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Dc{constructor(i,o,f,_){this.type=i,this.input=o,this.beginIndex=f,this.endIndex=_}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${i.length-1} instead.`);const f=o.parse(i[1],1,un),_=o.parse(i[2],2,vt);if(!f||!_)return null;if(!Nd(f.type,[Ca(un),gn,un]))return o.error(`Expected first argument to be of type array or string, but found ${ri(f.type)} instead`);if(i.length===4){const T=o.parse(i[3],3,vt);return T?new Dc(f.type,f,_,T):null}return new Dc(f.type,f,_)}evaluate(i){const o=this.input.evaluate(i),f=this.beginIndex.evaluate(i);let _;if(this.endIndex&&(_=this.endIndex.evaluate(i)),Ol(o,["string"]))return[...o].slice(f,_).join("");if(Ol(o,["array"]))return o.slice(f,_);throw new wi(`Expected first argument to be of type array or string, but found ${ri(Pi(o))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function Ic(s,i){const o=s.length-1;let f,_,T=0,S=o,M=0;for(;T<=S;)if(M=Math.floor((T+S)/2),f=s[M],_=s[M+1],f<=i){if(M===o||i<_)return M;T=M+1}else{if(!(f>i))throw new wi("Input is not a number.");S=M-1}return 0}class jl{constructor(i,o,f){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[_,T]of f)this.labels.push(_),this.outputs.push(T)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const f=o.parse(i[1],1,vt);if(!f)return null;const _=[];let T=null;o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let S=1;S<i.length;S+=2){const M=S===1?-1/0:i[S],D=i[S+1],L=S,N=S+1;if(typeof M!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(_.length&&_[_.length-1][0]>=M)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const V=o.parse(D,N,T);if(!V)return null;T=T||V.type,_.push([M,V])}return new jl(T,f,_)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const _=this.input.evaluate(i);if(_<=o[0])return f[0].evaluate(i);const T=o.length;return _>=o[T-1]?f[T-1].evaluate(i):f[Ic(o,_)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Zr(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var jd,Fd,wm=function(){if(Fd)return jd;function s(i,o,f,_){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(_-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=f,this.p2y=_}return Fd=1,jd=s,s.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,_=0;_<8;_++){var T=this.sampleCurveX(f)-i;if(Math.abs(T)<o)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=T/S}var M=0,D=1;for(f=i,_=0;_<20&&(T=this.sampleCurveX(f),!(Math.abs(T-i)<o));_++)i>T?M=f:D=f,f=.5*(D-M)+M;return f},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},jd}(),Tm=Zr(wm);class Rr{constructor(i,o,f,_,T){this.type=i,this.operator=o,this.interpolation=f,this.input=_,this.labels=[],this.outputs=[];for(const[S,M]of T)this.labels.push(S),this.outputs.push(M)}static interpolationFactor(i,o,f,_){let T=0;if(i.name==="exponential")T=vu(o,i.base,f,_);else if(i.name==="linear")T=vu(o,1,f,_);else if(i.name==="cubic-bezier"){const S=i.controlPoints;T=new Tm(S[0],S[1],S[2],S[3]).solve(vu(o,1,f,_))}return T}static parse(i,o){let[f,_,T,...S]=i;if(!Array.isArray(_)||_.length===0)return o.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const L=_[1];if(typeof L!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:L}}else{if(_[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const L=_.slice(1);if(L.length!==4||L.some(N=>typeof N!="number"||N<0||N>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:L}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(T=o.parse(T,2,vt),!T)return null;const M=[];let D=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||o.expectedType==qs?o.expectedType&&o.expectedType.kind!=="value"&&(D=o.expectedType):D=Va;for(let L=0;L<S.length;L+=2){const N=S[L],V=S[L+1],Y=L+3,H=L+4;if(typeof N!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Y);if(M.length&&M[M.length-1][0]>=N)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Y);const W=o.parse(V,H,D);if(!W)return null;D=D||W.type,M.push([N,W])}return Xs(D,vt)||Xs(D,_s)||Xs(D,Va)||Xs(D,mo)||Xs(D,Ma)||Xs(D,qs)||Xs(D,Ji)||Xs(D,Ca(vt))?new Rr(D,f,_,T,M):o.error(`Type ${ri(D)} is not interpolatable.`)}evaluate(i){const o=this.labels,f=this.outputs;if(o.length===1)return f[0].evaluate(i);const _=this.input.evaluate(i);if(_<=o[0])return f[0].evaluate(i);const T=o.length;if(_>=o[T-1])return f[T-1].evaluate(i);const S=Ic(o,_),M=Rr.interpolationFactor(this.interpolation,_,o[S],o[S+1]),D=f[S].evaluate(i),L=f[S+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ya(D,L,M);case"color":return xn.interpolate(D,L,M);case"padding":return er.interpolate(D,L,M);case"colorArray":return Ir.interpolate(D,L,M);case"numberArray":return Dr.interpolate(D,L,M);case"variableAnchorOffsetCollection":return Qi.interpolate(D,L,M);case"array":return Sc(D,L,M);case"projectionDefinition":return Gr.interpolate(D,L,M)}case"interpolate-hcl":switch(this.type.kind){case"color":return xn.interpolate(D,L,M,"hcl");case"colorArray":return Ir.interpolate(D,L,M,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return xn.interpolate(D,L,M,"lab");case"colorArray":return Ir.interpolate(D,L,M,"lab")}}}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function vu(s,i,o,f){const _=f-o,T=s-o;return _===0?0:i===1?T/_:(Math.pow(i,T)-1)/(Math.pow(i,_)-1)}const yo={color:xn.interpolate,number:ya,padding:er.interpolate,numberArray:Dr.interpolate,colorArray:Ir.interpolate,variableAnchorOffsetCollection:Qi.interpolate,array:Sc};class Bd{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let f=null;const _=o.expectedType;_&&_.kind!=="value"&&(f=_);const T=[];for(const M of i.slice(1)){const D=o.parse(M,1+T.length,f,void 0,{typeAnnotation:"omit"});if(!D)return null;f=f||D.type,T.push(D)}if(!f)throw new Error("No output type");const S=_&&T.some(M=>pu(_,M.type));return new Bd(S?un:f,T)}evaluate(i){let o,f=null,_=0;for(const T of this.args)if(_++,f=T.evaluate(i),f&&f instanceof _a&&!f.available&&(o||(o=f.name),f=null,_===this.args.length&&(f=o)),f!==null)break;return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function vh(s,i){return s==="=="||s==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function bh(s,i,o,f){return f.compare(i,o)===0}function Js(s,i,o){const f=s!=="=="&&s!=="!=";return class NS{constructor(T,S,M){this.type=_n,this.lhs=T,this.rhs=S,this.collator=M,this.hasUntypedArgument=T.type.kind==="value"||S.type.kind==="value"}static parse(T,S){if(T.length!==3&&T.length!==4)return S.error("Expected two or three arguments.");const M=T[0];let D=S.parse(T[1],1,un);if(!D)return null;if(!vh(M,D.type))return S.concat(1).error(`"${M}" comparisons are not supported for type '${ri(D.type)}'.`);let L=S.parse(T[2],2,un);if(!L)return null;if(!vh(M,L.type))return S.concat(2).error(`"${M}" comparisons are not supported for type '${ri(L.type)}'.`);if(D.type.kind!==L.type.kind&&D.type.kind!=="value"&&L.type.kind!=="value")return S.error(`Cannot compare types '${ri(D.type)}' and '${ri(L.type)}'.`);f&&(D.type.kind==="value"&&L.type.kind!=="value"?D=new vn(L.type,[D]):D.type.kind!=="value"&&L.type.kind==="value"&&(L=new vn(D.type,[L])));let N=null;if(T.length===4){if(D.type.kind!=="string"&&L.type.kind!=="string"&&D.type.kind!=="value"&&L.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(N=S.parse(T[3],3,kl),!N)return null}return new NS(D,L,N)}evaluate(T){const S=this.lhs.evaluate(T),M=this.rhs.evaluate(T);if(f&&this.hasUntypedArgument){const D=Pi(S),L=Pi(M);if(D.kind!==L.kind||D.kind!=="string"&&D.kind!=="number")throw new wi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${D.kind}, ${L.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const D=Pi(S),L=Pi(M);if(D.kind!=="string"||L.kind!=="string")return i(T,S,M)}return this.collator?o(T,S,M,this.collator.evaluate(T)):i(T,S,M)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const No=Js("==",function(s,i,o){return i===o},bh),Wf=Js("!=",function(s,i,o){return i!==o},function(s,i,o,f){return!bh(0,i,o,f)}),Ud=Js("<",function(s,i,o){return i<o},function(s,i,o,f){return f.compare(i,o)<0}),hy=Js(">",function(s,i,o){return i>o},function(s,i,o,f){return f.compare(i,o)>0}),Qf=Js("<=",function(s,i,o){return i<=o},function(s,i,o,f){return f.compare(i,o)<=0}),dy=Js(">=",function(s,i,o){return i>=o},function(s,i,o,f){return f.compare(i,o)>=0});class Vd{constructor(i,o,f){this.type=kl,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return o.error("Collator options argument must be an object.");const _=o.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,_n);if(!_)return null;const T=o.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,_n);if(!T)return null;let S=null;return f.locale&&(S=o.parse(f.locale,1,gn),!S)?null:new Vd(_,T,S)}evaluate(i){return new Ga(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class Kf{constructor(i,o,f,_,T){this.type=gn,this.number=i,this.locale=o,this.currency=f,this.minFractionDigits=_,this.maxFractionDigits=T}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const f=o.parse(i[1],1,vt);if(!f)return null;const _=i[2];if(typeof _!="object"||Array.isArray(_))return o.error("NumberFormat options argument must be an object.");let T=null;if(_.locale&&(T=o.parse(_.locale,1,gn),!T))return null;let S=null;if(_.currency&&(S=o.parse(_.currency,1,gn),!S))return null;let M=null;if(_["min-fraction-digits"]&&(M=o.parse(_["min-fraction-digits"],1,vt),!M))return null;let D=null;return _["max-fraction-digits"]&&(D=o.parse(_["max-fraction-digits"],1,vt),!D)?null:new Kf(f,T,S,M,D)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class Gd{constructor(i){this.type=vs,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return o.error("First argument must be an image or text section.");const _=[];let T=!1;for(let S=1;S<=i.length-1;++S){const M=i[S];if(T&&typeof M=="object"&&!Array.isArray(M)){T=!1;let D=null;if(M["font-scale"]&&(D=o.parse(M["font-scale"],1,vt),!D))return null;let L=null;if(M["text-font"]&&(L=o.parse(M["text-font"],1,Ca(gn)),!L))return null;let N=null;if(M["text-color"]&&(N=o.parse(M["text-color"],1,Va),!N))return null;let V=null;if(M["vertical-align"]){if(typeof M["vertical-align"]=="string"&&!Ec.includes(M["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${M["vertical-align"]}' instead.`);if(V=o.parse(M["vertical-align"],1,gn),!V)return null}const Y=_[_.length-1];Y.scale=D,Y.font=L,Y.textColor=N,Y.verticalAlign=V}else{const D=o.parse(i[S],1,un);if(!D)return null;const L=D.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,_.push({content:D,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Gd(_)}evaluate(i){return new Cr(this.sections.map(o=>{const f=o.content.evaluate(i);return Pi(f)===$i?new zl("",f,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(i):null):new zl(Dn(f),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null,o.verticalAlign?o.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor),o.verticalAlign&&i(o.verticalAlign)}outputDefined(){return!1}}class bu{constructor(i){this.type=$i,this.input=i}static parse(i,o){if(i.length!==2)return o.error("Expected two arguments.");const f=o.parse(i[1],1,gn);return f?new bu(f):o.error("No image name provided.")}evaluate(i){const o=this.input.evaluate(i),f=_a.fromString(o);return f&&i.availableImages&&(f.available=i.availableImages.indexOf(o)>-1),f}eachChild(i){i(this.input)}outputDefined(){return!1}}class Jf{constructor(i){this.type=vt,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=o.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ri(f.type)} instead.`):new Jf(f):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new wi(`Expected value to be of type string or array, but found ${ri(Pi(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const $a=8192;function xu(s,i){const o=(180+s[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,_=Math.pow(2,i.z);return[Math.round(o*_*$a),Math.round(f*_*$a)]}function ep(s,i){const o=Math.pow(2,i.z);return[(_=(s[0]/$a+i.x)/o,360*_-180),(f=(s[1]/$a+i.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,_}function Rc(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function wu(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function Sm(s,i,o){const f=s[0]-i[0],_=s[1]-i[1],T=s[0]-o[0],S=s[1]-o[1];return f*S-T*_==0&&f*T<=0&&_*S<=0}function xh(s,i,o,f){return(_=[f[0]-o[0],f[1]-o[1]])[0]*(T=[i[0]-s[0],i[1]-s[1]])[1]-_[1]*T[0]!=0&&!(!np(s,i,o,f)||!np(o,f,s,i));var _,T}function Em(s,i,o){for(const f of o)for(let _=0;_<f.length-1;++_)if(xh(s,i,f[_],f[_+1]))return!0;return!1}function jo(s,i,o=!1){let f=!1;for(const M of i)for(let D=0;D<M.length-1;D++){if(Sm(s,M[D],M[D+1]))return o;(T=M[D])[1]>(_=s)[1]!=(S=M[D+1])[1]>_[1]&&_[0]<(S[0]-T[0])*(_[1]-T[1])/(S[1]-T[1])+T[0]&&(f=!f)}var _,T,S;return f}function Am(s,i){for(const o of i)if(jo(s,o))return!0;return!1}function tp(s,i){for(const o of s)if(!jo(o,i))return!1;for(let o=0;o<s.length-1;++o)if(Em(s[o],s[o+1],i))return!1;return!0}function Mm(s,i){for(const o of i)if(tp(s,o))return!0;return!1}function np(s,i,o,f){const _=f[0]-o[0],T=f[1]-o[1],S=(s[0]-o[0])*T-_*(s[1]-o[1]),M=(i[0]-o[0])*T-_*(i[1]-o[1]);return S>0&&M<0||S<0&&M>0}function $d(s,i,o){const f=[];for(let _=0;_<s.length;_++){const T=[];for(let S=0;S<s[_].length;S++){const M=xu(s[_][S],o);Rc(i,M),T.push(M)}f.push(T)}return f}function Tu(s,i,o){const f=[];for(let _=0;_<s.length;_++){const T=$d(s[_],i,o);f.push(T)}return f}function Su(s,i,o,f){if(s[0]<o[0]||s[0]>o[2]){const _=.5*f;let T=s[0]-o[0]>_?-f:o[0]-s[0]>_?f:0;T===0&&(T=s[0]-o[2]>_?-f:o[2]-s[0]>_?f:0),s[0]+=T}Rc(i,s)}function wh(s,i,o,f){const _=Math.pow(2,f.z)*$a,T=[f.x*$a,f.y*$a],S=[];for(const M of s)for(const D of M){const L=[D.x+T[0],D.y+T[1]];Su(L,i,o,_),S.push(L)}return S}function Th(s,i,o,f){const _=Math.pow(2,f.z)*$a,T=[f.x*$a,f.y*$a],S=[];for(const D of s){const L=[];for(const N of D){const V=[N.x+T[0],N.y+T[1]];Rc(i,V),L.push(V)}S.push(L)}if(i[2]-i[0]<=_/2){(M=i)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const D of S)for(const L of D)Su(L,i,o,_)}var M;return S}class Fl{constructor(i,o){this.type=_n,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(ai(i[1])){const f=i[1];if(f.type==="FeatureCollection"){const _=[];for(const T of f.features){const{type:S,coordinates:M}=T.geometry;S==="Polygon"&&_.push(M),S==="MultiPolygon"&&_.push(...M)}if(_.length)return new Fl(f,{type:"MultiPolygon",coordinates:_})}else if(f.type==="Feature"){const _=f.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Fl(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Fl(f,f)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const _=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const M=$d(f.coordinates,T,S),D=wh(o.geometry(),_,T,S);if(!wu(_,T))return!1;for(const L of D)if(!jo(L,M))return!1}if(f.type==="MultiPolygon"){const M=Tu(f.coordinates,T,S),D=wh(o.geometry(),_,T,S);if(!wu(_,T))return!1;for(const L of D)if(!Am(L,M))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const _=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=o.canonicalID();if(f.type==="Polygon"){const M=$d(f.coordinates,T,S),D=Th(o.geometry(),_,T,S);if(!wu(_,T))return!1;for(const L of D)if(!tp(L,M))return!1}if(f.type==="MultiPolygon"){const M=Tu(f.coordinates,T,S),D=Th(o.geometry(),_,T,S);if(!wu(_,T))return!1;for(const L of D)if(!Mm(L,M))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let ip=class{constructor(s=[],i=(o,f)=>o<f?-1:o>f?1:0){if(this.data=s,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:i,compare:o}=this,f=i[s];for(;s>0;){const _=s-1>>1,T=i[_];if(o(f,T)>=0)break;i[s]=T,s=_}i[s]=f}_down(s){const{data:i,compare:o}=this,f=this.length>>1,_=i[s];for(;s<f;){let T=1+(s<<1);const S=T+1;if(S<this.length&&o(i[S],i[T])<0&&(T=S),o(i[T],_)>=0)break;i[s]=i[T],s=T}i[s]=_}};function Zd(s,i,o=0,f=s.length-1,_=rp){for(;f>o;){if(f-o>600){const D=f-o+1,L=i-o+1,N=Math.log(D),V=.5*Math.exp(2*N/3),Y=.5*Math.sqrt(N*V*(D-V)/D)*(L-D/2<0?-1:1);Zd(s,i,Math.max(o,Math.floor(i-L*V/D+Y)),Math.min(f,Math.floor(i+(D-L)*V/D+Y)),_)}const T=s[i];let S=o,M=f;for(el(s,o,i),_(s[f],T)>0&&el(s,o,f);S<M;){for(el(s,S,M),S++,M--;_(s[S],T)<0;)S++;for(;_(s[M],T)>0;)M--}_(s[o],T)===0?el(s,o,M):(M++,el(s,M,f)),M<=i&&(o=M+1),i<=M&&(f=M-1)}}function el(s,i,o){const f=s[i];s[i]=s[o],s[o]=f}function rp(s,i){return s<i?-1:s>i?1:0}function Sh(s,i){if(s.length<=1)return[s];const o=[];let f,_;for(const T of s){const S=Dm(T);S!==0&&(T.area=Math.abs(S),_===void 0&&(_=S<0),_===S<0?(f&&o.push(f),f=[T]):f.push(T))}if(f&&o.push(f),i>1)for(let T=0;T<o.length;T++)o[T].length<=i||(Zd(o[T],i,1,o[T].length-1,Cm),o[T]=o[T].slice(0,i));return o}function Cm(s,i){return i.area-s.area}function Dm(s){let i=0;for(let o,f,_=0,T=s.length,S=T-1;_<T;S=_++)o=s[_],f=s[S],i+=(f.x-o.x)*(o.y+f.y);return i}const ap=1/298.257223563,Im=ap*(2-ap),Rm=Math.PI/180;class op{constructor(i){const o=6378.137*Rm*1e3,f=Math.cos(i*Rm),_=1/(1-Im*(1-f*f)),T=Math.sqrt(_);this.kx=o*T*f,this.ky=o*T*_*(1-Im)}distance(i,o){const f=this.wrap(i[0]-o[0])*this.kx,_=(i[1]-o[1])*this.ky;return Math.sqrt(f*f+_*_)}pointOnLine(i,o){let f,_,T,S,M=1/0;for(let D=0;D<i.length-1;D++){let L=i[D][0],N=i[D][1],V=this.wrap(i[D+1][0]-L)*this.kx,Y=(i[D+1][1]-N)*this.ky,H=0;V===0&&Y===0||(H=(this.wrap(o[0]-L)*this.kx*V+(o[1]-N)*this.ky*Y)/(V*V+Y*Y),H>1?(L=i[D+1][0],N=i[D+1][1]):H>0&&(L+=V/this.kx*H,N+=Y/this.ky*H)),V=this.wrap(o[0]-L)*this.kx,Y=(o[1]-N)*this.ky;const W=V*V+Y*Y;W<M&&(M=W,f=L,_=N,T=D,S=H)}return{point:[f,_],index:T,t:Math.max(0,Math.min(1,S))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function va(s,i){return i[0]-s[0]}function Bl(s){return s[1]-s[0]+1}function Es(s,i){return s[1]>=s[0]&&s[1]<i}function Yd(s,i){if(s[0]>s[1])return[null,null];const o=Bl(s);if(i){if(o===2)return[s,null];const _=Math.floor(o/2);return[[s[0],s[0]+_],[s[0]+_,s[1]]]}if(o===1)return[s,null];const f=Math.floor(o/2)-1;return[[s[0],s[0]+f],[s[0]+f+1,s[1]]]}function Hd(s,i){if(!Es(i,s.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let f=i[0];f<=i[1];++f)Rc(o,s[f]);return o}function Zn(s){const i=[1/0,1/0,-1/0,-1/0];for(const o of s)for(const f of o)Rc(i,f);return i}function qd(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function sp(s,i,o){if(!qd(s)||!qd(i))return NaN;let f=0,_=0;return s[2]<i[0]&&(f=i[0]-s[2]),s[0]>i[2]&&(f=s[0]-i[2]),s[1]>i[3]&&(_=s[1]-i[3]),s[3]<i[1]&&(_=i[1]-s[3]),o.distance([0,0],[f,_])}function _o(s,i,o){const f=o.pointOnLine(i,s);return o.distance(s,f.point)}function Eh(s,i,o,f,_){const T=Math.min(_o(s,[o,f],_),_o(i,[o,f],_)),S=Math.min(_o(o,[s,i],_),_o(f,[s,i],_));return Math.min(T,S)}function Ah(s,i,o,f,_){if(!Es(i,s.length)||!Es(f,o.length))return 1/0;let T=1/0;for(let S=i[0];S<i[1];++S){const M=s[S],D=s[S+1];for(let L=f[0];L<f[1];++L){const N=o[L],V=o[L+1];if(xh(M,D,N,V))return 0;T=Math.min(T,Eh(M,D,N,V,_))}}return T}function lp(s,i,o,f,_){if(!Es(i,s.length)||!Es(f,o.length))return NaN;let T=1/0;for(let S=i[0];S<=i[1];++S)for(let M=f[0];M<=f[1];++M)if(T=Math.min(T,_.distance(s[S],o[M])),T===0)return T;return T}function km(s,i,o){if(jo(s,i,!0))return 0;let f=1/0;for(const _ of i){const T=_[0],S=_[_.length-1];if(T!==S&&(f=Math.min(f,_o(s,[S,T],o)),f===0))return f;const M=o.pointOnLine(_,s);if(f=Math.min(f,o.distance(s,M.point)),f===0)return f}return f}function kc(s,i,o,f){if(!Es(i,s.length))return NaN;for(let T=i[0];T<=i[1];++T)if(jo(s[T],o,!0))return 0;let _=1/0;for(let T=i[0];T<i[1];++T){const S=s[T],M=s[T+1];for(const D of o)for(let L=0,N=D.length,V=N-1;L<N;V=L++){const Y=D[V],H=D[L];if(xh(S,M,Y,H))return 0;_=Math.min(_,Eh(S,M,Y,H,f))}}return _}function Oc(s,i){for(const o of s)for(const f of o)if(jo(f,i,!0))return!0;return!1}function cp(s,i,o,f=1/0){const _=Zn(s),T=Zn(i);if(f!==1/0&&sp(_,T,o)>=f)return f;if(wu(_,T)){if(Oc(s,i))return 0}else if(Oc(i,s))return 0;let S=1/0;for(const M of s)for(let D=0,L=M.length,N=L-1;D<L;N=D++){const V=M[N],Y=M[D];for(const H of i)for(let W=0,ae=H.length,le=ae-1;W<ae;le=W++){const pe=H[le],Ne=H[W];if(xh(V,Y,pe,Ne))return 0;S=Math.min(S,Eh(V,Y,pe,Ne,o))}}return S}function up(s,i,o,f,_,T){if(!T)return;const S=sp(Hd(f,T),_,o);S<i&&s.push([S,T,[0,0]])}function As(s,i,o,f,_,T,S){if(!T||!S)return;const M=sp(Hd(f,T),Hd(_,S),o);M<i&&s.push([M,T,S])}function Mh(s,i,o,f,_=1/0){let T=Math.min(f.distance(s[0],o[0][0]),_);if(T===0)return T;const S=new ip([[0,[0,s.length-1],[0,0]]],va),M=Zn(o);for(;S.length>0;){const D=S.pop();if(D[0]>=T)continue;const L=D[1],N=i?50:100;if(Bl(L)<=N){if(!Es(L,s.length))return NaN;if(i){const V=kc(s,L,o,f);if(isNaN(V)||V===0)return V;T=Math.min(T,V)}else for(let V=L[0];V<=L[1];++V){const Y=km(s[V],o,f);if(T=Math.min(T,Y),T===0)return 0}}else{const V=Yd(L,i);up(S,T,f,s,M,V[0]),up(S,T,f,s,M,V[1])}}return T}function Ch(s,i,o,f,_,T=1/0){let S=Math.min(T,_.distance(s[0],o[0]));if(S===0)return S;const M=new ip([[0,[0,s.length-1],[0,o.length-1]]],va);for(;M.length>0;){const D=M.pop();if(D[0]>=S)continue;const L=D[1],N=D[2],V=i?50:100,Y=f?50:100;if(Bl(L)<=V&&Bl(N)<=Y){if(!Es(L,s.length)&&Es(N,o.length))return NaN;let H;if(i&&f)H=Ah(s,L,o,N,_),S=Math.min(S,H);else if(i&&!f){const W=s.slice(L[0],L[1]+1);for(let ae=N[0];ae<=N[1];++ae)if(H=_o(o[ae],W,_),S=Math.min(S,H),S===0)return S}else if(!i&&f){const W=o.slice(N[0],N[1]+1);for(let ae=L[0];ae<=L[1];++ae)if(H=_o(s[ae],W,_),S=Math.min(S,H),S===0)return S}else H=lp(s,L,o,N,_),S=Math.min(S,H)}else{const H=Yd(L,i),W=Yd(N,f);As(M,S,_,s,o,H[0],W[0]),As(M,S,_,s,o,H[0],W[1]),As(M,S,_,s,o,H[1],W[0]),As(M,S,_,s,o,H[1],W[1])}}return S}function Xd(s){return s.type==="MultiPolygon"?s.coordinates.map(i=>({type:"Polygon",coordinates:i})):s.type==="MultiLineString"?s.coordinates.map(i=>({type:"LineString",coordinates:i})):s.type==="MultiPoint"?s.coordinates.map(i=>({type:"Point",coordinates:i})):[s]}class Pc{constructor(i,o){this.type=vt,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(ai(i[1])){const f=i[1];if(f.type==="FeatureCollection")return new Pc(f,f.features.map(_=>Xd(_.geometry)).flat());if(f.type==="Feature")return new Pc(f,Xd(f.geometry));if("type"in f&&"coordinates"in f)return new Pc(f,Xd(f))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,f){const _=o.geometry(),T=_.flat().map(D=>ep([D.x,D.y],o.canonical));if(_.length===0)return NaN;const S=new op(T[0][1]);let M=1/0;for(const D of f){switch(D.type){case"Point":M=Math.min(M,Ch(T,!1,[D.coordinates],!1,S,M));break;case"LineString":M=Math.min(M,Ch(T,!1,D.coordinates,!0,S,M));break;case"Polygon":M=Math.min(M,Mh(T,!1,D.coordinates,S,M))}if(M===0)return M}return M}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,f){const _=o.geometry(),T=_.flat().map(D=>ep([D.x,D.y],o.canonical));if(_.length===0)return NaN;const S=new op(T[0][1]);let M=1/0;for(const D of f){switch(D.type){case"Point":M=Math.min(M,Ch(T,!0,[D.coordinates],!1,S,M));break;case"LineString":M=Math.min(M,Ch(T,!0,D.coordinates,!0,S,M));break;case"Polygon":M=Math.min(M,Mh(T,!0,D.coordinates,S,M))}if(M===0)return M}return M}(i,this.geometries);if(i.geometryType()==="Polygon")return function(o,f){const _=o.geometry();if(_.length===0||_[0].length===0)return NaN;const T=Sh(_,0).map(D=>D.map(L=>L.map(N=>ep([N.x,N.y],o.canonical)))),S=new op(T[0][0][0][1]);let M=1/0;for(const D of f)for(const L of T){switch(D.type){case"Point":M=Math.min(M,Mh([D.coordinates],!1,L,S,M));break;case"LineString":M=Math.min(M,Mh(D.coordinates,!0,L,S,M));break;case"Polygon":M=Math.min(M,cp(L,D.coordinates,S,M))}if(M===0)return M}return M}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Dh{constructor(i){this.type=un,this.key=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=i[1];return f==null?o.error("Global state property must be defined."):typeof f!="string"?o.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new Dh(f)}evaluate(i){var o;const f=(o=i.globals)===null||o===void 0?void 0:o.globalState;return f&&Object.keys(f).length!==0?gu(f,this.key):null}eachChild(){}outputDefined(){return!1}}const Eu={"==":No,"!=":Wf,">":hy,"<":Ud,">=":dy,"<=":Qf,array:vn,at:Mc,boolean:vn,case:$r,coalesce:Bd,collator:Vd,format:Gd,image:bu,in:Cc,"index-of":_u,interpolate:Rr,"interpolate-hcl":Rr,"interpolate-lab":Rr,length:Jf,let:Nl,literal:tn,match:Ss,number:vn,"number-format":Kf,object:vn,slice:Dc,step:jl,string:vn,"to-boolean":tr,"to-color":tr,"to-number":tr,"to-string":tr,var:Ac,within:Fl,distance:Pc,"global-state":Dh};class Za{constructor(i,o,f,_){this.name=i,this.type=o,this._evaluate=f,this.args=_}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,o){const f=i[0],_=Za.definitions[f];if(!_)return o.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,M=S.filter(([L])=>!Array.isArray(L)||L.length===i.length-1);let D=null;for(const[L,N]of M){D=new _h(o.registry,ba,o.path,null,o.scope);const V=[];let Y=!1;for(let H=1;H<i.length;H++){const W=i[H],ae=Array.isArray(L)?L[H-1]:L.type,le=D.parse(W,1+V.length,ae);if(!le){Y=!0;break}V.push(le)}if(!Y)if(Array.isArray(L)&&L.length!==V.length)D.error(`Expected ${L.length} arguments, but found ${V.length} instead.`);else{for(let H=0;H<V.length;H++){const W=Array.isArray(L)?L[H]:L.type,ae=V[H];D.concat(H+1).checkSubtype(W,ae.type)}if(D.errors.length===0)return new Za(f,T,N,V)}}if(M.length===1)o.errors.push(...D.errors);else{const L=(M.length?M:S).map(([V])=>{return Y=V,Array.isArray(Y)?`(${Y.map(ri).join(", ")})`:`(${ri(Y.type)}...)`;var Y}).join(" | "),N=[];for(let V=1;V<i.length;V++){const Y=o.parse(i[V],1+N.length);if(!Y)return null;N.push(ri(Y.type))}o.error(`Expected arguments of type ${L}, but found (${N.join(", ")}) instead.`)}return null}static register(i,o){Za.definitions=o;for(const f in o)i[f]=Za}}function hp(s,[i,o,f,_]){i=i.evaluate(s),o=o.evaluate(s),f=f.evaluate(s);const T=_?_.evaluate(s):1,S=go(i,o,f,T);if(S)throw new wi(S);return new xn(i/255,o/255,f/255,T,!1)}function Wd(s,i){return s in i}function Ya(s,i){const o=i[s];return o===void 0?null:o}function Ms(s){return{type:s}}function ba(s){if(s instanceof Ac)return ba(s.boundExpression);if(s instanceof Za&&s.name==="error"||s instanceof Vd||s instanceof Fl||s instanceof Pc||s instanceof Dh)return!1;const i=s instanceof tr||s instanceof vn;let o=!0;return s.eachChild(f=>{o=i?o&&ba(f):o&&f instanceof tn}),!!o&&tl(s)&&zc(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function tl(s){if(s instanceof Za&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Fl||s instanceof Pc)return!1;let i=!0;return s.eachChild(o=>{i&&!tl(o)&&(i=!1)}),i}function Lc(s){if(s instanceof Za&&s.name==="feature-state")return!1;let i=!0;return s.eachChild(o=>{i&&!Lc(o)&&(i=!1)}),i}function zc(s,i){if(s instanceof Za&&i.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(f=>{o&&!zc(f,i)&&(o=!1)}),o}function Ih(s){return{result:"success",value:s}}function Ul(s){return{result:"error",value:s}}function vo(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function dp(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Vl(s){return!!s.expression&&s.expression.interpolated}function bn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Qd(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&Pi(s)===zo}function Ha(s){return s}function Rh(s,i){const o=s.stops&&typeof s.stops[0][0]=="object",f=o||!(o||s.property!==void 0),_=s.type||(Vl(i)?"exponential":"interval"),T=function(N){switch(N.type){case"color":return xn.parse;case"padding":return er.parse;case"numberArray":return Dr.parse;case"colorArray":return Ir.parse;default:return null}}(i);if(T&&((s=Lo({},s)).stops&&(s.stops=s.stops.map(N=>[N[0],T(N[1])])),s.default=T(s.default?s.default:i.default)),s.colorSpace&&(S=s.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var S;const M=function(N){switch(N){case"exponential":return nl;case"interval":return Nc;case"categorical":return Om;case"identity":return fp;default:throw new Error(`Unknown function type "${N}"`)}}(_);let D,L;if(_==="categorical"){D=Object.create(null);for(const N of s.stops)D[N[0]]=N[1];L=typeof s.stops[0][0]}if(o){const N={},V=[];for(let W=0;W<s.stops.length;W++){const ae=s.stops[W],le=ae[0].zoom;N[le]===void 0&&(N[le]={zoom:le,type:s.type,property:s.property,default:s.default,stops:[]},V.push(le)),N[le].stops.push([ae[0].value,ae[1]])}const Y=[];for(const W of V)Y.push([N[W].zoom,Rh(N[W],i)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Rr.interpolationFactor.bind(void 0,H),zoomStops:Y.map(W=>W[0]),evaluate:({zoom:W},ae)=>nl({stops:Y,base:s.base},i,W).evaluate(W,ae)}}if(f){const N=_==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:Rr.interpolationFactor.bind(void 0,N),zoomStops:s.stops.map(V=>V[0]),evaluate:({zoom:V})=>M(s,i,V,D,L)}}return{kind:"source",evaluate(N,V){const Y=V&&V.properties?V.properties[s.property]:void 0;return Y===void 0?qa(s.default,i.default):M(s,i,Y,D,L)}}}function qa(s,i,o){return s!==void 0?s:i!==void 0?i:o!==void 0?o:void 0}function Om(s,i,o,f,_){return qa(typeof o===_?f[o]:void 0,s.default,i.default)}function Nc(s,i,o){if(bn(o)!=="number")return qa(s.default,i.default);const f=s.stops.length;if(f===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[f-1][0])return s.stops[f-1][1];const _=Ic(s.stops.map(T=>T[0]),o);return s.stops[_][1]}function nl(s,i,o){const f=s.base!==void 0?s.base:1;if(bn(o)!=="number")return qa(s.default,i.default);const _=s.stops.length;if(_===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[_-1][0])return s.stops[_-1][1];const T=Ic(s.stops.map(N=>N[0]),o),S=function(N,V,Y,H){const W=H-Y,ae=N-Y;return W===0?0:V===1?ae/W:(Math.pow(V,ae)-1)/(Math.pow(V,W)-1)}(o,f,s.stops[T][0],s.stops[T+1][0]),M=s.stops[T][1],D=s.stops[T+1][1],L=yo[i.type]||Ha;return typeof M.evaluate=="function"?{evaluate(...N){const V=M.evaluate.apply(void 0,N),Y=D.evaluate.apply(void 0,N);if(V!==void 0&&Y!==void 0)return L(V,Y,S,s.colorSpace)}}:L(M,D,S,s.colorSpace)}function fp(s,i,o){switch(i.type){case"color":o=xn.parse(o);break;case"formatted":o=Cr.fromString(o.toString());break;case"resolvedImage":o=_a.fromString(o.toString());break;case"padding":o=er.parse(o);break;case"colorArray":o=Ir.parse(o);break;case"numberArray":o=Dr.parse(o);break;default:bn(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0)}return qa(o,s.default,i.default)}Za.register(Eu,{error:[{kind:"error"},[gn],(s,[i])=>{throw new wi(i.evaluate(s))}],typeof:[gn,[un],(s,[i])=>ri(Pi(i.evaluate(s)))],"to-rgba":[Ca(vt,4),[Va],(s,[i])=>{const[o,f,_,T]=i.evaluate(s).rgb;return[255*o,255*f,255*_,T]}],rgb:[Va,[vt,vt,vt],hp],rgba:[Va,[vt,vt,vt,vt],hp],has:{type:_n,overloads:[[[gn],(s,[i])=>Wd(i.evaluate(s),s.properties())],[[gn,zo],(s,[i,o])=>Wd(i.evaluate(s),o.evaluate(s))]]},get:{type:un,overloads:[[[gn],(s,[i])=>Ya(i.evaluate(s),s.properties())],[[gn,zo],(s,[i,o])=>Ya(i.evaluate(s),o.evaluate(s))]]},"feature-state":[un,[gn],(s,[i])=>Ya(i.evaluate(s),s.featureState||{})],properties:[zo,[],s=>s.properties()],"geometry-type":[gn,[],s=>s.geometryType()],id:[un,[],s=>s.id()],zoom:[vt,[],s=>s.globals.zoom],"heatmap-density":[vt,[],s=>s.globals.heatmapDensity||0],elevation:[vt,[],s=>s.globals.elevation||0],"line-progress":[vt,[],s=>s.globals.lineProgress||0],accumulated:[un,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[vt,Ms(vt),(s,i)=>{let o=0;for(const f of i)o+=f.evaluate(s);return o}],"*":[vt,Ms(vt),(s,i)=>{let o=1;for(const f of i)o*=f.evaluate(s);return o}],"-":{type:vt,overloads:[[[vt,vt],(s,[i,o])=>i.evaluate(s)-o.evaluate(s)],[[vt],(s,[i])=>-i.evaluate(s)]]},"/":[vt,[vt,vt],(s,[i,o])=>i.evaluate(s)/o.evaluate(s)],"%":[vt,[vt,vt],(s,[i,o])=>i.evaluate(s)%o.evaluate(s)],ln2:[vt,[],()=>Math.LN2],pi:[vt,[],()=>Math.PI],e:[vt,[],()=>Math.E],"^":[vt,[vt,vt],(s,[i,o])=>Math.pow(i.evaluate(s),o.evaluate(s))],sqrt:[vt,[vt],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[vt,[vt],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[vt,[vt],(s,[i])=>Math.log(i.evaluate(s))],log2:[vt,[vt],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[vt,[vt],(s,[i])=>Math.sin(i.evaluate(s))],cos:[vt,[vt],(s,[i])=>Math.cos(i.evaluate(s))],tan:[vt,[vt],(s,[i])=>Math.tan(i.evaluate(s))],asin:[vt,[vt],(s,[i])=>Math.asin(i.evaluate(s))],acos:[vt,[vt],(s,[i])=>Math.acos(i.evaluate(s))],atan:[vt,[vt],(s,[i])=>Math.atan(i.evaluate(s))],min:[vt,Ms(vt),(s,i)=>Math.min(...i.map(o=>o.evaluate(s)))],max:[vt,Ms(vt),(s,i)=>Math.max(...i.map(o=>o.evaluate(s)))],abs:[vt,[vt],(s,[i])=>Math.abs(i.evaluate(s))],round:[vt,[vt],(s,[i])=>{const o=i.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[vt,[vt],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[vt,[vt],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[_n,[gn,un],(s,[i,o])=>s.properties()[i.value]===o.value],"filter-id-==":[_n,[un],(s,[i])=>s.id()===i.value],"filter-type-==":[_n,[gn],(s,[i])=>s.geometryType()===i.value],"filter-<":[_n,[gn,un],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f<_}],"filter-id-<":[_n,[un],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o<f}],"filter->":[_n,[gn,un],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f>_}],"filter-id->":[_n,[un],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o>f}],"filter-<=":[_n,[gn,un],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f<=_}],"filter-id-<=":[_n,[un],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o<=f}],"filter->=":[_n,[gn,un],(s,[i,o])=>{const f=s.properties()[i.value],_=o.value;return typeof f==typeof _&&f>=_}],"filter-id->=":[_n,[un],(s,[i])=>{const o=s.id(),f=i.value;return typeof o==typeof f&&o>=f}],"filter-has":[_n,[un],(s,[i])=>i.value in s.properties()],"filter-has-id":[_n,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[_n,[Ca(gn)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[_n,[Ca(un)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[_n,[gn,Ca(un)],(s,[i,o])=>o.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[_n,[gn,Ca(un)],(s,[i,o])=>function(f,_,T,S){for(;T<=S;){const M=T+S>>1;if(_[M]===f)return!0;_[M]>f?S=M-1:T=M+1}return!1}(s.properties()[i.value],o.value,0,o.value.length-1)],all:{type:_n,overloads:[[[_n,_n],(s,[i,o])=>i.evaluate(s)&&o.evaluate(s)],[Ms(_n),(s,i)=>{for(const o of i)if(!o.evaluate(s))return!1;return!0}]]},any:{type:_n,overloads:[[[_n,_n],(s,[i,o])=>i.evaluate(s)||o.evaluate(s)],[Ms(_n),(s,i)=>{for(const o of i)if(o.evaluate(s))return!0;return!1}]]},"!":[_n,[_n],(s,[i])=>!i.evaluate(s)],"is-supported-script":[_n,[gn],(s,[i])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(i.evaluate(s))}],upcase:[gn,[gn],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[gn,[gn],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[gn,Ms(un),(s,i)=>i.map(o=>Dn(o.evaluate(s))).join("")],"resolved-locale":[gn,[kl],(s,[i])=>i.evaluate(s).resolvedLocale()]});class Kd{constructor(i,o,f){this.expression=i,this._warningHistory={},this._evaluator=new Ks,this._defaultValue=o?function(_){if(_.type==="color"&&Qd(_.default))return new xn(0,0,0,0);switch(_.type){case"color":return xn.parse(_.default)||null;case"padding":return er.parse(_.default)||null;case"numberArray":return Dr.parse(_.default)||null;case"colorArray":return Ir.parse(_.default)||null;case"variableAnchorOffsetCollection":return Qi.parse(_.default)||null;case"projectionDefinition":return Gr.parse(_.default)||null;default:return _.default===void 0?null:_.default}}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this._globalState=f}evaluateWithoutErrorHandling(i,o,f,_,T,S){return this._globalState&&(i=Yr(i,this._globalState)),this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=f,this._evaluator.canonical=_,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(i,o,f,_,T,S){this._globalState&&(i=Yr(i,this._globalState)),this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=f||null,this._evaluator.canonical=_,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new wi(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Au(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Eu}function kh(s,i,o){const f=new _h(Eu,ba,[],i?function(T){const S={color:Va,string:gn,number:vt,enum:gn,boolean:_n,formatted:vs,padding:mo,numberArray:Ma,colorArray:qs,projectionDefinition:_s,resolvedImage:$i,variableAnchorOffsetCollection:Ji};return T.type==="array"?Ca(S[T.value]||un,T.length):S[T.type]}(i):void 0),_=f.parse(s,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?Ih(new Kd(_,i,o)):Ul(f.errors)}class xa{constructor(i,o,f){this.kind=i,this._styleExpression=o,this.isStateDependent=i!=="constant"&&!Lc(o.expression),this.globalStateRefs=la(o.expression),this._globalState=f}evaluateWithoutErrorHandling(i,o,f,_,T,S){return this._globalState&&(i=Yr(i,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(i,o,f,_,T,S)}evaluate(i,o,f,_,T,S){return this._globalState&&(i=Yr(i,this._globalState)),this._styleExpression.evaluate(i,o,f,_,T,S)}}class il{constructor(i,o,f,_,T){this.kind=i,this.zoomStops=f,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!Lc(o.expression),this.globalStateRefs=la(o.expression),this.interpolationType=_,this._globalState=T}evaluateWithoutErrorHandling(i,o,f,_,T,S){return this._globalState&&(i=Yr(i,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(i,o,f,_,T,S)}evaluate(i,o,f,_,T,S){return this._globalState&&(i=Yr(i,this._globalState)),this._styleExpression.evaluate(i,o,f,_,T,S)}interpolationFactor(i,o,f){return this.interpolationType?Rr.interpolationFactor(this.interpolationType,i,o,f):0}}function Gl(s,i,o){const f=kh(s,i,o);if(f.result==="error")return f;const _=f.value.expression,T=tl(_);if(!T&&!vo(i))return Ul([new Aa("","data expressions not supported")]);const S=zc(_,["zoom"]);if(!S&&!dp(i))return Ul([new Aa("","zoom expressions not supported")]);const M=$l(_);return M||S?M instanceof Aa?Ul([M]):M instanceof Rr&&!Vl(i)?Ul([new Aa("",'"interpolate" expressions cannot be used with this property')]):Ih(M?new il(T?"camera":"composite",f.value,M.labels,M instanceof Rr?M.interpolation:void 0,o):new xa(T?"constant":"source",f.value,o)):Ul([new Aa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class jc{constructor(i,o){this._parameters=i,this._specification=o,Lo(this,Rh(this._parameters,this._specification))}static deserialize(i){return new jc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function $l(s){let i=null;if(s instanceof Nl)i=$l(s.result);else if(s instanceof Bd){for(const o of s.args)if(i=$l(o),i)break}else(s instanceof jl||s instanceof Rr)&&s.input instanceof Za&&s.input.name==="zoom"&&(i=s);return i instanceof Aa||s.eachChild(o=>{const f=$l(o);f instanceof Aa?i=f:!i&&f?i=new Aa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new Aa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function la(s,i=new Set){return s instanceof Dh&&i.add(s.key),s.eachChild(o=>{la(o,i)}),i}function Yr(s,i){const{zoom:o,heatmapDensity:f,elevation:_,lineProgress:T,isSupportedScript:S,accumulated:M}=s??{};return{zoom:o,heatmapDensity:f,elevation:_,lineProgress:T,isSupportedScript:S,accumulated:M,globalState:i}}function Fo(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!Fo(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Cs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Da(s,i){if(s==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Fo(s)||(s=Fc(s));const o=kh(s,Cs,i);if(o.result==="error")throw new Error(o.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,_,T)=>o.value.evaluate(f,_,{},T),needGeometry:pp(s),getGlobalStateRefs:()=>la(o.value.expression)}}function rl(s,i){return s<i?-1:s>i?1:0}function pp(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let i=1;i<s.length;i++)if(pp(s[i]))return!0;return!1}function Fc(s){if(!s)return!0;const i=s[0];return s.length<=1?i!=="any":i==="=="?Mu(s[1],s[2],"=="):i==="!="?li(Mu(s[1],s[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Mu(s[1],s[2],i):i==="any"?(o=s.slice(1),["any"].concat(o.map(Fc))):i==="all"?["all"].concat(s.slice(1).map(Fc)):i==="none"?["all"].concat(s.slice(1).map(Fc).map(li)):i==="in"?Oh(s[1],s.slice(2)):i==="!in"?li(Oh(s[1],s.slice(2))):i==="has"?br(s[1]):i!=="!has"||li(br(s[1]));var o}function Mu(s,i,o){switch(s){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,s,i]}}function Oh(s,i){if(i.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",s,["literal",i.sort(rl)]]:["filter-in-small",s,["literal",i]]}}function br(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function li(s){return["!",s]}function Nn(s){const i=typeof s;if(i==="number"||i==="boolean"||i==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let _="[";for(const T of s)_+=`${Nn(T)},`;return`${_}]`}const o=Object.keys(s).sort();let f="{";for(let _=0;_<o.length;_++)f+=`${JSON.stringify(o[_])}:${Nn(s[o[_]])},`;return`${f}}`}function Bo(s){let i="";for(const o of Cn)i+=`/${Nn(s[o])}`;return i}function Xa(s){const i=s.value;return i?[new pt(s.key,i,"constants have been deprecated as of v8")]:[]}function Zi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Ia(s){if(Array.isArray(s))return s.map(Ia);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const o in s)i[o]=Ia(s[o]);return i}return Zi(s)}function Wa(s){const i=s.key,o=s.value,f=s.valueSpec||{},_=s.objectElementValidators||{},T=s.style,S=s.styleSpec,M=s.validateSpec;let D=[];const L=bn(o);if(L!=="object")return[new pt(i,o,`object expected, ${L} found`)];for(const N in o){const V=N.split(".")[0],Y=gu(f,V)||f["*"];let H;if(gu(_,V))H=_[V];else if(gu(f,V))H=M;else if(_["*"])H=_["*"];else{if(!f["*"]){D.push(new pt(i,o[N],`unknown property "${N}"`));continue}H=M}D=D.concat(H({key:(i&&`${i}.`)+N,value:o[N],valueSpec:Y,style:T,styleSpec:S,object:o,objectKey:N,validateSpec:M},o))}for(const N in f)_[N]||f[N].required&&f[N].default===void 0&&o[N]===void 0&&D.push(new pt(i,o,`missing required property "${N}"`));return D}function Jd(s){const i=s.value,o=s.valueSpec,f=s.style,_=s.styleSpec,T=s.key,S=s.arrayElementValidator||s.validateSpec;if(bn(i)!=="array")return[new pt(T,i,`array expected, ${bn(i)} found`)];if(o.length&&i.length!==o.length)return[new pt(T,i,`array length ${o.length} expected, length ${i.length} found`)];if(o["min-length"]&&i.length<o["min-length"])return[new pt(T,i,`array length at least ${o["min-length"]} expected, length ${i.length} found`)];let M={type:o.value,values:o.values};_.$version<7&&(M.function=o.function),bn(o.value)==="object"&&(M=o.value);let D=[];for(let L=0;L<i.length;L++)D=D.concat(S({array:i,arrayIndex:L,value:i[L],valueSpec:M,validateSpec:s.validateSpec,style:f,styleSpec:_,key:`${T}[${L}]`}));return D}function al(s){const i=s.key,o=s.value,f=s.valueSpec;let _=bn(o);return _==="number"&&o!=o&&(_="NaN"),_!=="number"?[new pt(i,o,`number expected, ${_} found`)]:"minimum"in f&&o<f.minimum?[new pt(i,o,`${o} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&o>f.maximum?[new pt(i,o,`${o} is greater than the maximum value ${f.maximum}`)]:[]}function ol(s){const i=s.valueSpec,o=Zi(s.value.type);let f,_,T,S={};const M=o!=="categorical"&&s.value.property===void 0,D=!M,L=bn(s.value.stops)==="array"&&bn(s.value.stops[0])==="array"&&bn(s.value.stops[0][0])==="object",N=Wa({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(H){if(o==="identity")return[new pt(H.key,H.value,'identity function may not have a "stops" property')];let W=[];const ae=H.value;return W=W.concat(Jd({key:H.key,value:ae,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:V})),bn(ae)==="array"&&ae.length===0&&W.push(new pt(H.key,ae,"array must have at least one stop")),W},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:i,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return o==="identity"&&M&&N.push(new pt(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||N.push(new pt(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!Vl(s.valueSpec)&&N.push(new pt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(D&&!vo(s.valueSpec)?N.push(new pt(s.key,s.value,"property functions not supported")):M&&!dp(s.valueSpec)&&N.push(new pt(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!L||s.value.property!==void 0||N.push(new pt(s.key,s.value,'"property" property is required')),N;function V(H){let W=[];const ae=H.value,le=H.key;if(bn(ae)!=="array")return[new pt(le,ae,`array expected, ${bn(ae)} found`)];if(ae.length!==2)return[new pt(le,ae,`array length 2 expected, length ${ae.length} found`)];if(L){if(bn(ae[0])!=="object")return[new pt(le,ae,`object expected, ${bn(ae[0])} found`)];if(ae[0].zoom===void 0)return[new pt(le,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new pt(le,ae,"object stop key must have value")];if(T&&T>Zi(ae[0].zoom))return[new pt(le,ae[0].zoom,"stop zoom values must appear in ascending order")];Zi(ae[0].zoom)!==T&&(T=Zi(ae[0].zoom),_=void 0,S={}),W=W.concat(Wa({key:`${le}[0]`,value:ae[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:al,value:Y}}))}else W=W.concat(Y({key:`${le}[0]`,value:ae[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},ae));return Au(Ia(ae[1]))?W.concat([new pt(`${le}[1]`,ae[1],"expressions are not allowed in function stops.")]):W.concat(H.validateSpec({key:`${le}[1]`,value:ae[1],valueSpec:i,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function Y(H,W){const ae=bn(H.value),le=Zi(H.value),pe=H.value!==null?H.value:W;if(f){if(ae!==f)return[new pt(H.key,pe,`${ae} stop domain type must match previous stop domain type ${f}`)]}else f=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean")return[new pt(H.key,pe,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&o!=="categorical"){let Ne=`number expected, ${ae} found`;return vo(i)&&o===void 0&&(Ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(H.key,pe,Ne)]}return o!=="categorical"||ae!=="number"||isFinite(le)&&Math.floor(le)===le?o!=="categorical"&&ae==="number"&&_!==void 0&&le<_?[new pt(H.key,pe,"stop domain values must appear in ascending order")]:(_=le,o==="categorical"&&le in S?[new pt(H.key,pe,"stop domain values must be unique")]:(S[le]=!0,[])):[new pt(H.key,pe,`integer expected, found ${le}`)]}}function sl(s){const i=(s.expressionContext==="property"?Gl:kh)(Ia(s.value),s.valueSpec);if(i.result==="error")return i.value.map(f=>new pt(`${s.key}${f.key}`,s.value,f.message));const o=i.value.expression||i.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new pt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Lc(o))return[new pt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Lc(o))return[new pt(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!zc(o,["zoom","feature-state"]))return[new pt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!tl(o))return[new pt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ds(s){const i=s.key,o=s.value,f=bn(o);return f!=="string"?[new pt(i,o,`color expected, ${f} found`)]:xn.parse(String(o))?[]:[new pt(i,o,`color expected, "${o}" found`)]}function Bc(s){const i=s.key,o=s.value,f=s.valueSpec,_=[];return Array.isArray(f.values)?f.values.indexOf(Zi(o))===-1&&_.push(new pt(i,o,`expected one of [${f.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(f.values).indexOf(Zi(o))===-1&&_.push(new pt(i,o,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(o)} found`)),_}function Is(s){return Fo(Ia(s.value))?sl(Lo({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Uo(s)}function Uo(s){const i=s.value,o=s.key;if(bn(i)!=="array")return[new pt(o,i,`array expected, ${bn(i)} found`)];const f=s.styleSpec;let _,T=[];if(i.length<1)return[new pt(o,i,"filter array must have at least 1 element")];switch(T=T.concat(Bc({key:`${o}[0]`,value:i[0],valueSpec:f.filter_operator,style:s.style,styleSpec:s.styleSpec})),Zi(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Zi(i[1])==="$type"&&T.push(new pt(o,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&T.push(new pt(o,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(_=bn(i[1]),_!=="string"&&T.push(new pt(`${o}[1]`,i[1],`string expected, ${_} found`)));for(let S=2;S<i.length;S++)_=bn(i[S]),Zi(i[1])==="$type"?T=T.concat(Bc({key:`${o}[${S}]`,value:i[S],valueSpec:f.geometry_type,style:s.style,styleSpec:s.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&T.push(new pt(`${o}[${S}]`,i[S],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let S=1;S<i.length;S++)T=T.concat(Uo({key:`${o}[${S}]`,value:i[S],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":_=bn(i[1]),i.length!==2?T.push(new pt(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):_!=="string"&&T.push(new pt(`${o}[1]`,i[1],`string expected, ${_} found`))}return T}function ll(s,i){const o=s.key,f=s.validateSpec,_=s.style,T=s.styleSpec,S=s.value,M=s.objectKey,D=T[`${i}_${s.layerType}`];if(!D)return[];const L=M.match(/^(.*)-transition$/);if(i==="paint"&&L&&D[L[1]]&&D[L[1]].transition)return f({key:o,value:S,valueSpec:T.transition,style:_,styleSpec:T});const N=s.valueSpec||D[M];if(!N)return[new pt(o,S,`unknown property "${M}"`)];let V;if(bn(S)==="string"&&vo(N)&&!N.tokens&&(V=/^{([^}]+)}$/.exec(S)))return[new pt(o,S,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const Y=[];return s.layerType==="symbol"&&(M==="text-field"&&_&&!_.glyphs&&Y.push(new pt(o,S,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&Qd(Ia(S))&&Zi(S.type)==="identity"&&Y.push(new pt(o,S,'"text-font" does not support identity functions'))),Y.concat(f({key:s.key,value:S,valueSpec:N,style:_,styleSpec:T,expressionContext:"property",propertyType:i,propertyKey:M}))}function Vo(s){return ll(s,"paint")}function Ph(s){return ll(s,"layout")}function Zl(s){let i=[];const o=s.value,f=s.key,_=s.style,T=s.styleSpec;if(bn(o)!=="object")return[new pt(f,o,`object expected, ${bn(o)} found`)];o.type||o.ref||i.push(new pt(f,o,'either "type" or "ref" is required'));let S=Zi(o.type);const M=Zi(o.ref);if(o.id){const D=Zi(o.id);for(let L=0;L<s.arrayIndex;L++){const N=_.layers[L];Zi(N.id)===D&&i.push(new pt(f,o.id,`duplicate layer id "${o.id}", previously used at line ${N.id.__line__}`))}}if("ref"in o){let D;["type","source","source-layer","filter","layout"].forEach(L=>{L in o&&i.push(new pt(f,o[L],`"${L}" is prohibited for ref layers`))}),_.layers.forEach(L=>{Zi(L.id)===M&&(D=L)}),D?D.ref?i.push(new pt(f,o.ref,"ref cannot reference another ref layer")):S=Zi(D.type):i.push(new pt(f,o.ref,`ref layer "${M}" not found`))}else if(S!=="background")if(o.source){const D=_.sources&&_.sources[o.source],L=D&&Zi(D.type);D?L==="vector"&&S==="raster"?i.push(new pt(f,o.source,`layer "${o.id}" requires a raster source`)):L!=="raster-dem"&&S==="hillshade"||L!=="raster-dem"&&S==="color-relief"?i.push(new pt(f,o.source,`layer "${o.id}" requires a raster-dem source`)):L==="raster"&&S!=="raster"?i.push(new pt(f,o.source,`layer "${o.id}" requires a vector source`)):L!=="vector"||o["source-layer"]?L==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?i.push(new pt(f,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!o.paint||!o.paint["line-gradient"]||L==="geojson"&&D.lineMetrics||i.push(new pt(f,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new pt(f,o,`layer "${o.id}" must specify a "source-layer"`)):i.push(new pt(f,o.source,`source "${o.source}" not found`))}else i.push(new pt(f,o,'missing required property "source"'));return i=i.concat(Wa({key:f,value:o,valueSpec:T.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${f}.type`,value:o.type,valueSpec:T.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:Is,layout:D=>Wa({layer:o,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":L=>Ph(Lo({layerType:S},L))}}),paint:D=>Wa({layer:o,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":L=>Vo(Lo({layerType:S},L))}})}})),i}function bo(s){const i=s.value,o=s.key,f=bn(i);return f!=="string"?[new pt(o,i,`string expected, ${f} found`)]:[]}const Lh={promoteId:function({key:s,value:i}){if(bn(i)==="string")return bo({key:s,value:i});{const o=[];for(const f in i)o.push(...bo({key:`${s}.${f}`,value:i[f]}));return o}}};function Yl(s){const i=s.value,o=s.key,f=s.styleSpec,_=s.style,T=s.validateSpec;if(!i.type)return[new pt(o,i,'"type" is required')];const S=Zi(i.type);let M;switch(S){case"vector":case"raster":return M=Wa({key:o,value:i,valueSpec:f[`source_${S.replace("-","_")}`],style:s.style,styleSpec:f,objectElementValidators:Lh,validateSpec:T}),M;case"raster-dem":return M=function(D){var L;const N=(L=D.sourceName)!==null&&L!==void 0?L:"",V=D.value,Y=D.styleSpec,H=Y.source_raster_dem,W=D.style;let ae=[];const le=bn(V);if(V===void 0)return ae;if(le!=="object")return ae.push(new pt("source_raster_dem",V,`object expected, ${le} found`)),ae;const pe=Zi(V.encoding)==="custom",Ne=["redFactor","greenFactor","blueFactor","baseShift"],ve=D.value.encoding?`"${D.value.encoding}"`:"Default";for(const Ce in V)!pe&&Ne.includes(Ce)?ae.push(new pt(Ce,V[Ce],`In "${N}": "${Ce}" is only valid when "encoding" is set to "custom". ${ve} encoding found`)):H[Ce]?ae=ae.concat(D.validateSpec({key:Ce,value:V[Ce],valueSpec:H[Ce],validateSpec:D.validateSpec,style:W,styleSpec:Y})):ae.push(new pt(Ce,V[Ce],`unknown property "${Ce}"`));return ae}({sourceName:o,value:i,style:s.style,styleSpec:f,validateSpec:T}),M;case"geojson":if(M=Wa({key:o,value:i,valueSpec:f.source_geojson,style:_,styleSpec:f,validateSpec:T,objectElementValidators:Lh}),i.cluster)for(const D in i.clusterProperties){const[L,N]=i.clusterProperties[D],V=typeof L=="string"?[L,["accumulated"],["get",D]]:L;M.push(...sl({key:`${o}.${D}.map`,value:N,expressionContext:"cluster-map"})),M.push(...sl({key:`${o}.${D}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return M;case"video":return Wa({key:o,value:i,valueSpec:f.source_video,style:_,validateSpec:T,styleSpec:f});case"image":return Wa({key:o,value:i,valueSpec:f.source_image,style:_,validateSpec:T,styleSpec:f});case"canvas":return[new pt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bc({key:`${o}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Hr(s){const i=s.value,o=s.styleSpec,f=o.light,_=s.style;let T=[];const S=bn(i);if(i===void 0)return T;if(S!=="object")return T=T.concat([new pt("light",i,`object expected, ${S} found`)]),T;for(const M in i){const D=M.match(/^(.*)-transition$/);T=T.concat(D&&f[D[1]]&&f[D[1]].transition?s.validateSpec({key:M,value:i[M],valueSpec:o.transition,validateSpec:s.validateSpec,style:_,styleSpec:o}):f[M]?s.validateSpec({key:M,value:i[M],valueSpec:f[M],validateSpec:s.validateSpec,style:_,styleSpec:o}):[new pt(M,i[M],`unknown property "${M}"`)])}return T}function zh(s){const i=s.value,o=s.styleSpec,f=o.sky,_=s.style,T=bn(i);if(i===void 0)return[];if(T!=="object")return[new pt("sky",i,`object expected, ${T} found`)];let S=[];for(const M in i)S=S.concat(f[M]?s.validateSpec({key:M,value:i[M],valueSpec:f[M],style:_,styleSpec:o}):[new pt(M,i[M],`unknown property "${M}"`)]);return S}function mp(s){const i=s.value,o=s.styleSpec,f=o.terrain,_=s.style;let T=[];const S=bn(i);if(i===void 0)return T;if(S!=="object")return T=T.concat([new pt("terrain",i,`object expected, ${S} found`)]),T;for(const M in i)T=T.concat(f[M]?s.validateSpec({key:M,value:i[M],valueSpec:f[M],validateSpec:s.validateSpec,style:_,styleSpec:o}):[new pt(M,i[M],`unknown property "${M}"`)]);return T}function Cu(s){let i=[];const o=s.value,f=s.key;if(Array.isArray(o)){const _=[],T=[];for(const S in o)o[S].id&&_.includes(o[S].id)&&i.push(new pt(f,o,`all the sprites' ids must be unique, but ${o[S].id} is duplicated`)),_.push(o[S].id),o[S].url&&T.includes(o[S].url)&&i.push(new pt(f,o,`all the sprites' URLs must be unique, but ${o[S].url} is duplicated`)),T.push(o[S].url),i=i.concat(Wa({key:`${f}[${S}]`,value:o[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return i}return bo({key:f,value:o})}function Du(s){return i=s.value,i&&i.constructor===Object?[]:[new pt(s.key,s.value,`object expected, ${bn(s.value)} found`)];var i}const Ra={"*":()=>[],array:Jd,boolean:function(s){const i=s.value,o=s.key,f=bn(i);return f!=="boolean"?[new pt(o,i,`boolean expected, ${f} found`)]:[]},number:al,color:Ds,constants:Xa,enum:Bc,filter:Is,function:ol,layer:Zl,object:Wa,source:Yl,light:Hr,sky:zh,terrain:mp,projection:function(s){const i=s.value,o=s.styleSpec,f=o.projection,_=s.style,T=bn(i);if(i===void 0)return[];if(T!=="object")return[new pt("projection",i,`object expected, ${T} found`)];let S=[];for(const M in i)S=S.concat(f[M]?s.validateSpec({key:M,value:i[M],valueSpec:f[M],style:_,styleSpec:o}):[new pt(M,i[M],`unknown property "${M}"`)]);return S},projectionDefinition:function(s){const i=s.key;let o=s.value;o=o instanceof String?o.valueOf():o;const f=bn(o);return f!=="array"||function(_){return Array.isArray(_)&&_.length===3&&typeof _[0]=="string"&&typeof _[1]=="string"&&typeof _[2]=="number"}(o)||function(_){return!!["interpolate","step","literal"].includes(_[0])}(o)?["array","string"].includes(f)?[]:[new pt(i,o,`projection expected, invalid type "${f}" found`)]:[new pt(i,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:bo,formatted:function(s){return bo(s).length===0?[]:sl(s)},resolvedImage:function(s){return bo(s).length===0?[]:sl(s)},padding:function(s){const i=s.key,o=s.value;if(bn(o)==="array"){if(o.length<1||o.length>4)return[new pt(i,o,`padding requires 1 to 4 values; ${o.length} values found`)];const f={type:"number"};let _=[];for(let T=0;T<o.length;T++)_=_.concat(s.validateSpec({key:`${i}[${T}]`,value:o[T],validateSpec:s.validateSpec,valueSpec:f}));return _}return al({key:i,value:o,valueSpec:{}})},numberArray:function(s){const i=s.key,o=s.value;if(bn(o)==="array"){const f={type:"number"};if(o.length<1)return[new pt(i,o,"array length at least 1 expected, length 0 found")];let _=[];for(let T=0;T<o.length;T++)_=_.concat(s.validateSpec({key:`${i}[${T}]`,value:o[T],validateSpec:s.validateSpec,valueSpec:f}));return _}return al({key:i,value:o,valueSpec:{}})},colorArray:function(s){const i=s.key,o=s.value;if(bn(o)==="array"){if(o.length<1)return[new pt(i,o,"array length at least 1 expected, length 0 found")];let f=[];for(let _=0;_<o.length;_++)f=f.concat(Ds({key:`${i}[${_}]`,value:o[_]}));return f}return Ds({key:i,value:o})},variableAnchorOffsetCollection:function(s){const i=s.key,o=s.value,f=bn(o),_=s.styleSpec;if(f!=="array"||o.length<1||o.length%2!=0)return[new pt(i,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let S=0;S<o.length;S+=2)T=T.concat(Bc({key:`${i}[${S}]`,value:o[S],valueSpec:_.layout_symbol["text-anchor"]})),T=T.concat(Jd({key:`${i}[${S+1}]`,value:o[S+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:_}));return T},sprite:Cu,state:Du};function Ti(s){const i=s.value,o=s.valueSpec,f=s.styleSpec;return s.validateSpec=Ti,o.expression&&Qd(Zi(i))?ol(s):o.expression&&Au(Ia(i))?sl(s):o.type&&Ra[o.type]?Ra[o.type](s):Wa(Lo({},s,{valueSpec:o.type?f[o.type]:o}))}function Nh(s){const i=s.value,o=s.key,f=bo(s);return f.length||(i.indexOf("{fontstack}")===-1&&f.push(new pt(o,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&f.push(new pt(o,i,'"glyphs" url must include a "{range}" token'))),f}function ca(s,i=Be){let o=[];return o=o.concat(Ti({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,validateSpec:Ti,objectElementValidators:{glyphs:Nh,"*":()=>[]}})),s.constants&&(o=o.concat(Xa({key:"constants",value:s.constants}))),Hl(o)}function wa(s){return function(i){return s(Object.assign({},i,{validateSpec:Ti}))}}function Hl(s){return[].concat(s).sort((i,o)=>i.line-o.line)}function ta(s){return function(...i){return Hl(s.apply(this,i))}}ca.source=ta(wa(Yl)),ca.sprite=ta(wa(Cu)),ca.glyphs=ta(wa(Nh)),ca.light=ta(wa(Hr)),ca.sky=ta(wa(zh)),ca.terrain=ta(wa(mp)),ca.state=ta(wa(Du)),ca.layer=ta(wa(Zl)),ca.filter=ta(wa(Is)),ca.paintProperty=ta(wa(Vo)),ca.layoutProperty=ta(wa(Ph));const Qa=ca,fy=Qa.light,ef=Qa.sky,py=Qa.paintProperty,Iu=Qa.layoutProperty;function ql(s,i){let o=!1;if(i&&i.length)for(const f of i)s.fire(new Nt(new Error(f.message))),o=!0;return o}class Uc{constructor(i,o,f){const _=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const S=new Int32Array(this.arrayBuffer);i=S[0],this.d=(o=S[1])+2*(f=S[2]);for(let D=0;D<this.d*this.d;D++){const L=S[3+D],N=S[3+D+1];_.push(L===N?null:S.subarray(L,N))}const M=S[3+_.length+1];this.keys=S.subarray(S[3+_.length],M),this.bboxes=S.subarray(M),this.insert=this._insertReadonly}else{this.d=o+2*f;for(let S=0;S<this.d*this.d;S++)_.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=i,this.padding=f,this.scale=o/i,this.uid=0;const T=f/o*i;this.min=-T,this.max=i+T}insert(i,o,f,_,T){this._forEachCell(o,f,_,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,o,f,_,T,S){this.cells[T].push(S)}query(i,o,f,_,T){const S=this.min,M=this.max;if(i<=S&&o<=S&&M<=f&&M<=_&&!T)return Array.prototype.slice.call(this.keys);{const D=[];return this._forEachCell(i,o,f,_,this._queryCell,D,{},T),D}}_queryCell(i,o,f,_,T,S,M,D){const L=this.cells[T];if(L!==null){const N=this.keys,V=this.bboxes;for(let Y=0;Y<L.length;Y++){const H=L[Y];if(M[H]===void 0){const W=4*H;(D?D(V[W+0],V[W+1],V[W+2],V[W+3]):i<=V[W+2]&&o<=V[W+3]&&f>=V[W+0]&&_>=V[W+1])?(M[H]=!0,S.push(N[H])):M[H]=!1}}}}_forEachCell(i,o,f,_,T,S,M,D){const L=this._convertToCellCoord(i),N=this._convertToCellCoord(o),V=this._convertToCellCoord(f),Y=this._convertToCellCoord(_);for(let H=L;H<=V;H++)for(let W=N;W<=Y;W++){const ae=this.d*W+H;if((!D||D(this._convertFromCellCoord(H),this._convertFromCellCoord(W),this._convertFromCellCoord(H+1),this._convertFromCellCoord(W+1)))&&T.call(this,i,o,f,_,ae,S,M,D))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,o=3+this.cells.length+1+1;let f=0;for(let S=0;S<this.cells.length;S++)f+=this.cells[S].length;const _=new Int32Array(o+f+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let T=o;for(let S=0;S<i.length;S++){const M=i[S];_[3+S]=T,_.set(M,T),T+=M.length}return _[3+i.length]=T,_.set(this.keys,T),T+=this.keys.length,_[3+i.length+1]=T,_.set(this.bboxes,T),T+=this.bboxes.length,_.buffer}static serialize(i,o){const f=i.toArrayBuffer();return o&&o.push(f),{buffer:f}}static deserialize(i){return new Uc(i.buffer)}}const xo={};function Rt(s,i,o={}){if(xo[s])throw new Error(`${s} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:s,writeable:!1}),xo[s]={klass:i,omit:o.omit||[],shallow:o.shallow||[]}}Rt("Object",Object),Rt("Set",Set),Rt("TransferableGridIndex",Uc),Rt("Color",xn),Rt("Error",Error),Rt("AJAXError",we),Rt("ResolvedImage",_a),Rt("StylePropertyFunction",jc),Rt("StyleExpression",Kd,{omit:["_evaluator"]}),Rt("ZoomDependentExpression",il),Rt("ZoomConstantExpression",xa),Rt("CompoundExpression",Za,{omit:["_evaluate"]});for(const s in Eu)Eu[s]._classRegistryKey||Rt(`Expression_${s}`,Eu[s]);function Vc(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function jh(s){return s.$name||s.constructor._classRegistryKey}function Xl(s){return!function(i){if(i===null||typeof i!="object")return!1;const o=jh(i);return!(!o||o==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||Vc(s)||Ar(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function Wl(s,i){if(Xl(s))return(Vc(s)||Ar(s))&&i&&i.push(s),ArrayBuffer.isView(s)&&i&&i.push(s.buffer),s instanceof ImageData&&i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const T=[];for(const S of s)T.push(Wl(S,i));return T}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const o=jh(s);if(!o)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!xo[o])throw new Error(`${o} is not registered.`);const{klass:f}=xo[o],_=f.serialize?f.serialize(s,i):{};if(f.serialize){if(i&&_===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in s){if(!s.hasOwnProperty(T)||xo[o].omit.indexOf(T)>=0)continue;const S=s[T];_[T]=xo[o].shallow.indexOf(T)>=0?S:Wl(S,i)}s instanceof Error&&(_.message=s.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(_.$name=o),_}function Ql(s){if(Xl(s))return s;if(Array.isArray(s))return s.map(Ql);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const i=jh(s)||"Object";if(!xo[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:o}=xo[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(s);const f=Object.create(o.prototype);for(const _ of Object.keys(s)){if(_==="$name")continue;const T=s[_];f[_]=xo[i].shallow.indexOf(_)>=0?T:Ql(T)}return f}class Gc{constructor(){this.first=!0}update(i,o){const f=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=o),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=f,!0))}}const yn={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Hangul Syllables":s=>s>=44032&&s<=55215,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Rs(s){for(const i of s)if(Jl(i.charCodeAt(0)))return!0;return!1}function gp(s){for(const i of s)if(!Ru(i.charCodeAt(0)))return!1;return!0}function Fh(s){const i=s.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(i.join("|"),"u")}const Kl=Fh(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ru(s){return!Kl.test(String.fromCodePoint(s))}const Bh=Fh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Jl(s){return!(s!==746&&s!==747&&(s<4352||!(yn["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||yn["CJK Compatibility"](s)||yn["CJK Strokes"](s)||!(!yn["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||yn["Enclosed CJK Letters and Months"](s)||yn["Ideographic Description Characters"](s)||yn.Kanbun(s)||yn.Katakana(s)&&s!==12540||!(!yn["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!yn["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||yn["Vertical Forms"](s)||yn["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||Bh.test(String.fromCodePoint(s)))))}function Uh(s){return!(Jl(s)||function(i){return!!(yn["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||yn["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||yn["Letterlike Symbols"](i)||yn["Number Forms"](i)||yn["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||yn["Control Pictures"](i)&&i!==9251||yn["Optical Character Recognition"](i)||yn["Enclosed Alphanumerics"](i)||yn["Geometric Shapes"](i)||yn["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||yn["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||yn["CJK Symbols and Punctuation"](i)||yn.Katakana(i)||yn["Private Use Area"](i)||yn["CJK Compatibility Forms"](i)||yn["Small Form Variants"](i)||yn["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(s))}const yp=Fh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ec(s){return yp.test(String.fromCodePoint(s))}function _p(s,i){return!(!i&&ec(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||yn.Khmer(s))}function cl(s){for(const i of s)if(ec(i.charCodeAt(0)))return!0;return!1}const ks=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(ks.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,i){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const o=s.pluginURL,f=new Promise(T=>{this.loadScriptResolve=T});i(o);const _=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([f,_]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:o};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)})}};class ci{constructor(i,o){this.isSupportedScript=ul,this.zoom=i,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new Gc,this.transition=o.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gc,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,o=i-Math.floor(i),f=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*o}}}function ul(s){return function(i,o){for(const f of i)if(!_p(f.charCodeAt(0),o))return!1;return!0}(s,ks.getRTLTextPluginStatus()==="loaded")}class wo{constructor(i,o,f){this.property=i,this.value=o,this.expression=function(_,T,S){if(Qd(_))return new jc(_,T);if(Au(_)){const M=Gl(_,T,S);if(M.result==="error")throw new Error(M.value.map(D=>`${D.key}: ${D.message}`).join(", "));return M.value}{let M=_;return T.type==="color"&&typeof _=="string"?M=xn.parse(_):T.type!=="padding"||typeof _!="number"&&!Array.isArray(_)?T.type!=="numberArray"||typeof _!="number"&&!Array.isArray(_)?T.type!=="colorArray"||typeof _!="string"&&!Array.isArray(_)?T.type==="variableAnchorOffsetCollection"&&Array.isArray(_)?M=Qi.parse(_):T.type==="projectionDefinition"&&typeof _=="string"&&(M=Gr.parse(_)):M=Ir.parse(_):M=Dr.parse(_):M=er.parse(_),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>M}}}(o===void 0?i.specification.default:o,i.specification,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,o,f){return this.property.possiblyEvaluate(this,i,o,f)}}class tc{constructor(i,o){this.property=i,this.value=new wo(i,void 0,o)}transitioned(i,o){return new $c(this.property,this.value,o,cn({},i.transition,this.transition),i.now)}untransitioned(){return new $c(this.property,this.value,null,{},0)}}class Vh{constructor(i,o){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._globalState=o}getValue(i){return xi(this._values[i].value.value)}setValue(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new tc(this._values[i].property,this._globalState)),this._values[i].value=new wo(this._values[i].property,o===null?void 0:xi(o),this._globalState)}getTransition(i){return xi(this._values[i].transition)}setTransition(i,o){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new tc(this._values[i].property,this._globalState)),this._values[i].transition=xi(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f);const _=this.getTransition(o);_!==void 0&&(i[`${o}-transition`]=_)}return i}transitioned(i,o){const f=new ku(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].transitioned(i,o._values[_]);return f}untransitioned(){const i=new ku(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class $c{constructor(i,o,f,_,T){this.property=i,this.value=o,this.begin=T+_.delay||0,this.end=this.begin+_.duration||0,i.specification.transition&&(_.delay||_.duration)&&(this.prior=f)}possiblyEvaluate(i,o,f){const _=i.now||0,T=this.value.possiblyEvaluate(i,o,f),S=this.prior;if(S){if(_>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(_<this.begin)return S.possiblyEvaluate(i,o,f);{const M=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(i,o,f),T,dt(M))}}return T}}class ku{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,f){const _=new Gh(this._properties);for(const T of Object.keys(this._values))_._values[T]=this._values[T].possiblyEvaluate(i,o,f);return _}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Zc{constructor(i,o){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._globalState=o}hasValue(i){return this._values[i].value!==void 0}getValue(i){return xi(this._values[i].value)}setValue(i,o){this._values[i]=new wo(this._values[i].property,o===null?void 0:xi(o),this._globalState)}serialize(){const i={};for(const o of Object.keys(this._values)){const f=this.getValue(o);f!==void 0&&(i[o]=f)}return i}possiblyEvaluate(i,o,f){const _=new Gh(this._properties);for(const T of Object.keys(this._values))_._values[T]=this._values[T].possiblyEvaluate(i,o,f);return _}}class Go{constructor(i,o,f){this.property=i,this.value=o,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,f,_){return this.property.evaluate(this.value,this.parameters,i,o,f,_)}}class Gh{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Lt{constructor(i){this.specification=i}possiblyEvaluate(i,o){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(o)}interpolate(i,o,f){const _=yo[this.specification.type];return _?_(i,o,f):i}}class qt{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,f,_){return new Go(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},f,_)}:i.expression,o)}interpolate(i,o,f){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new Go(this,{kind:"constant",value:void 0},i.parameters);const _=yo[this.specification.type];if(_){const T=_(i.value.value,o.value.value,f);return new Go(this,{kind:"constant",value:T},i.parameters)}return i}evaluate(i,o,f,_,T,S){return i.kind==="constant"?i.value:i.evaluate(o,f,_,T,S)}}class Yc extends qt{possiblyEvaluate(i,o,f,_){if(i.value===void 0)return new Go(this,{kind:"constant",value:void 0},o);if(i.expression.kind==="constant"){const T=i.expression.evaluate(o,null,{},f,_),S=i.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,M=this._calculate(S,S,S,o);return new Go(this,{kind:"constant",value:M},o)}if(i.expression.kind==="camera"){const T=this._calculate(i.expression.evaluate({zoom:o.zoom-1}),i.expression.evaluate({zoom:o.zoom}),i.expression.evaluate({zoom:o.zoom+1}),o);return new Go(this,{kind:"constant",value:T},o)}return new Go(this,i.expression,o)}evaluate(i,o,f,_,T,S){if(i.kind==="source"){const M=i.evaluate(o,f,_,T,S);return this._calculate(M,M,M,o)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(o.zoom)-1},f,_),i.evaluate({zoom:Math.floor(o.zoom)},f,_),i.evaluate({zoom:Math.floor(o.zoom)+1},f,_),o):i.value}_calculate(i,o,f,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class tf{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,_){if(i.value!==void 0){if(i.expression.kind==="constant"){const T=i.expression.evaluate(o,null,{},f,_);return this._calculate(T,T,T,o)}return this._calculate(i.expression.evaluate(new ci(Math.floor(o.zoom-1),o)),i.expression.evaluate(new ci(Math.floor(o.zoom),o)),i.expression.evaluate(new ci(Math.floor(o.zoom+1),o)),o)}}_calculate(i,o,f,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:f,to:o}}interpolate(i){return i}}class Ou{constructor(i){this.specification=i}possiblyEvaluate(i,o,f,_){return!!i.expression.evaluate(o,null,{},f,_)}interpolate(){return!1}}class Si{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in i){const f=i[o];f.specification.overridable&&this.overridableProperties.push(o);const _=this.defaultPropertyValues[o]=new wo(f,void 0,void 0),T=this.defaultTransitionablePropertyValues[o]=new tc(f,void 0);this.defaultTransitioningPropertyValues[o]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=_.possiblyEvaluate({})}}}Rt("DataDrivenProperty",qt),Rt("DataConstantProperty",Lt),Rt("CrossFadedDataDrivenProperty",Yc),Rt("CrossFadedProperty",tf),Rt("ColorRampProperty",Ou);const Ka="-transition";class qr extends Ht{constructor(i,o,f){if(super(),this.id=i.id,this.type=i.type,this._globalState=f,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=Da(i.filter,f)),o.layout&&(this._unevaluatedLayout=new Zc(o.layout,f)),o.paint)){this._transitionablePaint=new Vh(o.paint,f);for(const _ in i.paint)this.setPaintProperty(_,i.paint[_],{validate:!1});for(const _ in i.layout)this.setLayoutProperty(_,i.layout[_],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gh(o.paint)}}setFilter(i){this.filter=i,this._featureFilter=Da(i,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[o];for(const _ of f.getGlobalStateRefs())i.add(_)}for(const o of this._featureFilter.getGlobalStateRefs())i.add(o);return i}getPaintAffectingGlobalStateRefs(){var i;const o=new globalThis.Map;if(this._transitionablePaint)for(const f in this._transitionablePaint._values){const _=this._transitionablePaint._values[f].value;for(const T of _.getGlobalStateRefs()){const S=(i=o.get(T))!==null&&i!==void 0?i:[];S.push({name:f,value:_.value}),o.set(T,S)}}return o}setLayoutProperty(i,o,f={}){o!=null&&this._validate(Iu,`layers.${this.id}.layout.${i}`,i,o,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,o):this.visibility=o)}getPaintProperty(i){return i.endsWith(Ka)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o,f={}){if(o!=null&&this._validate(py,`layers.${this.id}.paint.${i}`,i,o,f))return!1;if(i.endsWith(Ka))return this._transitionablePaint.setTransition(i.slice(0,-11),o||void 0),!1;{const _=this._transitionablePaint._values[i],T=_.property.specification["property-type"]==="cross-faded-data-driven",S=_.value.isDataDriven(),M=_.value;this._transitionablePaint.setValue(i,o),this._handleSpecialPaintPropertyUpdate(i);const D=this._transitionablePaint._values[i].value;return D.isDataDriven()||S||T||this._handleOverridablePaintPropertyUpdate(i,M,D)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,o,f){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),cr(i,(o,f)=>!(o===void 0||f==="layout"&&!Object.keys(o).length||f==="paint"&&!Object.keys(o).length))}_validate(i,o,f,_,T={}){return(!T||T.validate!==!1)&&ql(this,i.call(Qa,{key:o,layerType:this.type,objectKey:f,value:_,styleSpec:Be,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof Go&&vo(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}let hl;var Pm={get paint(){return hl=hl||new Si({"raster-opacity":new Lt(Be.paint_raster["raster-opacity"]),"raster-hue-rotate":new Lt(Be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Lt(Be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Lt(Be.paint_raster["raster-brightness-max"]),"raster-saturation":new Lt(Be.paint_raster["raster-saturation"]),"raster-contrast":new Lt(Be.paint_raster["raster-contrast"]),"raster-resampling":new Lt(Be.paint_raster["raster-resampling"]),"raster-fade-duration":new Lt(Be.paint_raster["raster-fade-duration"])})}};class nc extends qr{constructor(i,o){super(i,Pm,o)}}const Ja={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Li{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ui(s,i=1){let o=0,f=0;return{members:s.map(_=>{const T=Ja[_.type].BYTES_PER_ELEMENT,S=o=sn(o,Math.max(i,T)),M=_.components||1;return f=Math.max(f,T),o+=T*M,{name:_.name,type:_.type,components:M,offset:S}}),size:sn(o,Math.max(f,i)),alignment:i}}function sn(s,i){return Math.ceil(s/i)*i}class Jn extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const _=2*i;return this.int16[_+0]=o,this.int16[_+1]=f,i}}Jn.prototype.bytesPerElement=4,Rt("StructArrayLayout2i4",Jn);class Ui extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const T=3*i;return this.int16[T+0]=o,this.int16[T+1]=f,this.int16[T+2]=_,i}}Ui.prototype.bytesPerElement=6,Rt("StructArrayLayout3i6",Ui);class Hc extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,f,_)}emplace(i,o,f,_,T){const S=4*i;return this.int16[S+0]=o,this.int16[S+1]=f,this.int16[S+2]=_,this.int16[S+3]=T,i}}Hc.prototype.bytesPerElement=8,Rt("StructArrayLayout4i8",Hc);class Os extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S){const M=this.length;return this.resize(M+1),this.emplace(M,i,o,f,_,T,S)}emplace(i,o,f,_,T,S,M){const D=6*i;return this.int16[D+0]=o,this.int16[D+1]=f,this.int16[D+2]=_,this.int16[D+3]=T,this.int16[D+4]=S,this.int16[D+5]=M,i}}Os.prototype.bytesPerElement=12,Rt("StructArrayLayout2i4i12",Os);class dl extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S){const M=this.length;return this.resize(M+1),this.emplace(M,i,o,f,_,T,S)}emplace(i,o,f,_,T,S,M){const D=4*i,L=8*i;return this.int16[D+0]=o,this.int16[D+1]=f,this.uint8[L+4]=_,this.uint8[L+5]=T,this.uint8[L+6]=S,this.uint8[L+7]=M,i}}dl.prototype.bytesPerElement=8,Rt("StructArrayLayout2i4ub8",dl);class $o extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const _=2*i;return this.float32[_+0]=o,this.float32[_+1]=f,i}}$o.prototype.bytesPerElement=8,Rt("StructArrayLayout2f8",$o);class Zo extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S,M,D,L,N){const V=this.length;return this.resize(V+1),this.emplace(V,i,o,f,_,T,S,M,D,L,N)}emplace(i,o,f,_,T,S,M,D,L,N,V){const Y=10*i;return this.uint16[Y+0]=o,this.uint16[Y+1]=f,this.uint16[Y+2]=_,this.uint16[Y+3]=T,this.uint16[Y+4]=S,this.uint16[Y+5]=M,this.uint16[Y+6]=D,this.uint16[Y+7]=L,this.uint16[Y+8]=N,this.uint16[Y+9]=V,i}}Zo.prototype.bytesPerElement=20,Rt("StructArrayLayout10ui20",Zo);class ic extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S,M,D){const L=this.length;return this.resize(L+1),this.emplace(L,i,o,f,_,T,S,M,D)}emplace(i,o,f,_,T,S,M,D,L){const N=8*i;return this.uint16[N+0]=o,this.uint16[N+1]=f,this.uint16[N+2]=_,this.uint16[N+3]=T,this.uint16[N+4]=S,this.uint16[N+5]=M,this.uint16[N+6]=D,this.uint16[N+7]=L,i}}ic.prototype.bytesPerElement=16,Rt("StructArrayLayout8ui16",ic);class nf extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S,M,D,L,N,V,Y){const H=this.length;return this.resize(H+1),this.emplace(H,i,o,f,_,T,S,M,D,L,N,V,Y)}emplace(i,o,f,_,T,S,M,D,L,N,V,Y,H){const W=12*i;return this.int16[W+0]=o,this.int16[W+1]=f,this.int16[W+2]=_,this.int16[W+3]=T,this.uint16[W+4]=S,this.uint16[W+5]=M,this.uint16[W+6]=D,this.uint16[W+7]=L,this.int16[W+8]=N,this.int16[W+9]=V,this.int16[W+10]=Y,this.int16[W+11]=H,i}}nf.prototype.bytesPerElement=24,Rt("StructArrayLayout4i4ui4i24",nf);class _i extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const T=3*i;return this.float32[T+0]=o,this.float32[T+1]=f,this.float32[T+2]=_,i}}_i.prototype.bytesPerElement=12,Rt("StructArrayLayout3f12",_i);class $h extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}$h.prototype.bytesPerElement=4,Rt("StructArrayLayout1ul4",$h);class Zh extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S,M,D,L){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,f,_,T,S,M,D,L)}emplace(i,o,f,_,T,S,M,D,L,N){const V=10*i,Y=5*i;return this.int16[V+0]=o,this.int16[V+1]=f,this.int16[V+2]=_,this.int16[V+3]=T,this.int16[V+4]=S,this.int16[V+5]=M,this.uint32[Y+3]=D,this.uint16[V+8]=L,this.uint16[V+9]=N,i}}Zh.prototype.bytesPerElement=20,Rt("StructArrayLayout6i1ul2ui20",Zh);class Yh extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S){const M=this.length;return this.resize(M+1),this.emplace(M,i,o,f,_,T,S)}emplace(i,o,f,_,T,S,M){const D=6*i;return this.int16[D+0]=o,this.int16[D+1]=f,this.int16[D+2]=_,this.int16[D+3]=T,this.int16[D+4]=S,this.int16[D+5]=M,i}}Yh.prototype.bytesPerElement=12,Rt("StructArrayLayout2i2i2i12",Yh);class rf extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,f,_,T)}emplace(i,o,f,_,T,S){const M=4*i,D=8*i;return this.float32[M+0]=o,this.float32[M+1]=f,this.float32[M+2]=_,this.int16[D+6]=T,this.int16[D+7]=S,i}}rf.prototype.bytesPerElement=16,Rt("StructArrayLayout2f1f2i16",rf);class b extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S){const M=this.length;return this.resize(M+1),this.emplace(M,i,o,f,_,T,S)}emplace(i,o,f,_,T,S,M){const D=16*i,L=4*i,N=8*i;return this.uint8[D+0]=o,this.uint8[D+1]=f,this.float32[L+1]=_,this.float32[L+2]=T,this.int16[N+6]=S,this.int16[N+7]=M,i}}b.prototype.bytesPerElement=16,Rt("StructArrayLayout2ub2f2i16",b);class t extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const T=3*i;return this.uint16[T+0]=o,this.uint16[T+1]=f,this.uint16[T+2]=_,i}}t.prototype.bytesPerElement=6,Rt("StructArrayLayout3ui6",t);class l extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,i,o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe)}emplace(i,o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe,Ne){const ve=24*i,Ce=12*i,Ze=48*i;return this.int16[ve+0]=o,this.int16[ve+1]=f,this.uint16[ve+2]=_,this.uint16[ve+3]=T,this.uint32[Ce+2]=S,this.uint32[Ce+3]=M,this.uint32[Ce+4]=D,this.uint16[ve+10]=L,this.uint16[ve+11]=N,this.uint16[ve+12]=V,this.float32[Ce+7]=Y,this.float32[Ce+8]=H,this.uint8[Ze+36]=W,this.uint8[Ze+37]=ae,this.uint8[Ze+38]=le,this.uint32[Ce+10]=pe,this.int16[ve+22]=Ne,i}}l.prototype.bytesPerElement=48,Rt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",l);class p extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe,Ne,ve,Ce,Ze,Ke,ft,Dt,St,Mt,$t,At){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,i,o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe,Ne,ve,Ce,Ze,Ke,ft,Dt,St,Mt,$t,At)}emplace(i,o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe,Ne,ve,Ce,Ze,Ke,ft,Dt,St,Mt,$t,At,Ct){const at=32*i,Qt=16*i;return this.int16[at+0]=o,this.int16[at+1]=f,this.int16[at+2]=_,this.int16[at+3]=T,this.int16[at+4]=S,this.int16[at+5]=M,this.int16[at+6]=D,this.int16[at+7]=L,this.uint16[at+8]=N,this.uint16[at+9]=V,this.uint16[at+10]=Y,this.uint16[at+11]=H,this.uint16[at+12]=W,this.uint16[at+13]=ae,this.uint16[at+14]=le,this.uint16[at+15]=pe,this.uint16[at+16]=Ne,this.uint16[at+17]=ve,this.uint16[at+18]=Ce,this.uint16[at+19]=Ze,this.uint16[at+20]=Ke,this.uint16[at+21]=ft,this.uint16[at+22]=Dt,this.uint32[Qt+12]=St,this.float32[Qt+13]=Mt,this.float32[Qt+14]=$t,this.uint16[at+30]=At,this.uint16[at+31]=Ct,i}}p.prototype.bytesPerElement=64,Rt("StructArrayLayout8i15ui1ul2f2ui64",p);class v extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}v.prototype.bytesPerElement=4,Rt("StructArrayLayout1f4",v);class x extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const T=3*i;return this.uint16[6*i+0]=o,this.float32[T+1]=f,this.float32[T+2]=_,i}}x.prototype.bytesPerElement=12,Rt("StructArrayLayout1ui2f12",x);class A extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,f)}emplace(i,o,f,_){const T=4*i;return this.uint32[2*i+0]=o,this.uint16[T+2]=f,this.uint16[T+3]=_,i}}A.prototype.bytesPerElement=8,Rt("StructArrayLayout1ul2ui8",A);class R extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const f=this.length;return this.resize(f+1),this.emplace(f,i,o)}emplace(i,o,f){const _=2*i;return this.uint16[_+0]=o,this.uint16[_+1]=f,i}}R.prototype.bytesPerElement=4,Rt("StructArrayLayout2ui4",R);class O extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}O.prototype.bytesPerElement=2,Rt("StructArrayLayout1ui2",O);class j extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,f,_){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,f,_)}emplace(i,o,f,_,T){const S=4*i;return this.float32[S+0]=o,this.float32[S+1]=f,this.float32[S+2]=_,this.float32[S+3]=T,i}}j.prototype.bytesPerElement=16,Rt("StructArrayLayout4f16",j);class U extends Li{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new E(this.anchorPointX,this.anchorPointY)}}U.prototype.size=20;class $ extends Zh{get(i){return new U(this,i)}}Rt("CollisionBoxArray",$);class G extends Li{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}G.prototype.size=48;class q extends l{get(i){return new G(this,i)}}Rt("PlacedSymbolArray",q);class re extends Li{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}re.prototype.size=64;class he extends p{get(i){return new re(this,i)}}Rt("SymbolInstanceArray",he);class de extends v{getoffsetX(i){return this.float32[1*i+0]}}Rt("GlyphOffsetArray",de);class fe extends Ui{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Rt("SymbolLineVertexArray",fe);class me extends Li{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}me.prototype.size=12;class ye extends x{get(i){return new me(this,i)}}Rt("TextAnchorOffsetArray",ye);class ge extends Li{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ge.prototype.size=8;class Se extends A{get(i){return new ge(this,i)}}Rt("FeatureIndexArray",Se);class Re extends Jn{}class _e extends Jn{}class Le extends Jn{}class qe extends Os{}class $e extends dl{}class Ye extends $o{}class He extends Zo{}class bt extends ic{}class wt extends nf{}class ct extends _i{}class Ft extends $h{}class on extends Yh{}class Vn extends b{}class ti extends t{}class ni extends R{}const Ai=ui([{name:"a_pos",components:2,type:"Int16"}],4),{members:vi}=Ai;class In{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,o,f,_){const T=this.segments[this.segments.length-1];return i>In.MAX_VERTEX_ARRAY_LENGTH&&Ln(`Max vertices per segment is ${In.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${In.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+i>In.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==_?this.createNewSegment(o,f,_):T}createNewSegment(i,o,f){const _={vertexOffset:i.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(_.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(_),_}getOrCreateLatestSegment(i,o,f){return this.prepareSegment(0,i,o,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,f,_){return new In([{vertexOffset:i,primitiveOffset:o,vertexLength:f,primitiveLength:_,vaos:{},sortKey:0}])}}function Vi(s,i){return 256*(s=jt(Math.floor(s),0,255))+jt(Math.floor(i),0,255)}In.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rt("SegmentVector",In);const Xr=ui([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),nr=ui([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var ir,ua,fl,eo={exports:{}},pl={exports:{}},rc={exports:{}},Pu=function(){if(fl)return eo.exports;fl=1;var s=(ir||(ir=1,pl.exports=function(o,f){var _,T,S,M,D,L,N,V;for(T=o.length-(_=3&o.length),S=f,D=3432918353,L=461845907,V=0;V<T;)N=255&o.charCodeAt(V)|(255&o.charCodeAt(++V))<<8|(255&o.charCodeAt(++V))<<16|(255&o.charCodeAt(++V))<<24,++V,S=27492+(65535&(M=5*(65535&(S=(S^=N=(65535&(N=(N=(65535&N)*D+(((N>>>16)*D&65535)<<16)&4294967295)<<15|N>>>17))*L+(((N>>>16)*L&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(N=0,_){case 3:N^=(255&o.charCodeAt(V+2))<<16;case 2:N^=(255&o.charCodeAt(V+1))<<8;case 1:S^=N=(65535&(N=(N=(65535&(N^=255&o.charCodeAt(V)))*D+(((N>>>16)*D&65535)<<16)&4294967295)<<15|N>>>17))*L+(((N>>>16)*L&65535)<<16)&4294967295}return S^=o.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),pl.exports),i=(ua||(ua=1,rc.exports=function(o,f){for(var _,T=o.length,S=f^T,M=0;T>=4;)_=1540483477*(65535&(_=255&o.charCodeAt(M)|(255&o.charCodeAt(++M))<<8|(255&o.charCodeAt(++M))<<16|(255&o.charCodeAt(++M))<<24))+((1540483477*(_>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),T-=4,++M;switch(T){case 3:S^=(255&o.charCodeAt(M+2))<<16;case 2:S^=(255&o.charCodeAt(M+1))<<8;case 1:S=1540483477*(65535&(S^=255&o.charCodeAt(M)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),rc.exports);return eo.exports=s,eo.exports.murmur3=s,eo.exports.murmur2=i,eo.exports}(),qc=C(Pu);class Ps{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,o,f,_){this.ids.push(to(i)),this.positions.push(o,f,_)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=to(i);let f=0,_=this.ids.length-1;for(;f<_;){const S=f+_>>1;this.ids[S]>=o?_=S:f=S+1}const T=[];for(;this.ids[f]===o;)T.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return T}static serialize(i,o){const f=new Float64Array(i.ids),_=new Uint32Array(i.positions);return To(f,_,0,f.length-1),o&&o.push(f.buffer,_.buffer),{ids:f,positions:_}}static deserialize(i){const o=new Ps;return o.ids=i.ids,o.positions=i.positions,o.indexed=!0,o}}function to(s){const i=+s;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:qc(String(s))}function To(s,i,o,f){for(;o<f;){const _=s[o+f>>1];let T=o-1,S=f+1;for(;;){do T++;while(s[T]<_);do S--;while(s[S]>_);if(T>=S)break;Yo(s,T,S),Yo(i,3*T,3*S),Yo(i,3*T+1,3*S+1),Yo(i,3*T+2,3*S+2)}S-o<f-S?(To(s,i,o,S),o=S+1):(To(s,i,S+1,f),f=S)}}function Yo(s,i,o){const f=s[i];s[i]=s[o],s[o]=f}Rt("FeaturePositionMap",Ps);class ka{constructor(i,o){this.gl=i.gl,this.location=o}}class Yi extends ka{constructor(i,o){super(i,o),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class xr extends ka{constructor(i,o){super(i,o),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Oa extends ka{constructor(i,o){super(i,o),this.current=xn.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const Wr=new Float32Array(16);function vp(s){return[Vi(255*s.r,255*s.g),Vi(255*s.b,255*s.a)]}class Lu{constructor(i,o,f){this.value=i,this.uniformNames=o.map(_=>`u_${_}`),this.type=f}setUniform(i,o,f){i.set(f.constantOr(this.value))}getBinding(i,o,f){return this.type==="color"?new Oa(i,o):new Yi(i,o)}}class Ho{constructor(i,o){this.uniformNames=o.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=i.tlbr}setConstantDashPositions(i,o){this.dashTo=[0,i.y,i.height,i.width],this.dashFrom=[0,o.y,o.height,o.width]}setUniform(i,o,f,_){let T=null;_==="u_pattern_to"?T=this.patternTo:_==="u_pattern_from"?T=this.patternFrom:_==="u_dasharray_to"?T=this.dashTo:_==="u_dasharray_from"?T=this.dashFrom:_==="u_pixel_ratio_to"?T=this.pixelRatioTo:_==="u_pixel_ratio_from"&&(T=this.pixelRatioFrom),T!==null&&i.set(T)}getBinding(i,o,f){return f.substr(0,9)==="u_pattern"||f.substr(0,12)==="u_dasharray_"?new xr(i,o):new Yi(i,o)}}class qo{constructor(i,o,f,_){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=o.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(i,o,f){const _=this.paintVertexArray.length,T=this.expression.evaluate(new ci(0,f),o,{},f.canonical,[],f.formattedSection);this.paintVertexArray.resize(i),this._setPaintValue(_,i,T)}updatePaintArray(i,o,f,_,T){const S=this.expression.evaluate(new ci(0,T),f,_);this._setPaintValue(i,o,S)}_setPaintValue(i,o,f){if(this.type==="color"){const _=vp(f);for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,_[0],_[1])}else{for(let _=i;_<o;_++)this.paintVertexArray.emplace(_,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Pa{constructor(i,o,f,_,T,S){this.expression=i,this.uniformNames=o.map(M=>`u_${M}_t`),this.type=f,this.useIntegerZoom=_,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=o.map(M=>({name:`a_${M}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(i,o,f){const _=this.expression.evaluate(new ci(this.zoom,f),o,{},f.canonical,[],f.formattedSection),T=this.expression.evaluate(new ci(this.zoom+1,f),o,{},f.canonical,[],f.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(S,i,_,T)}updatePaintArray(i,o,f,_,T){const S=this.expression.evaluate(new ci(this.zoom,T),f,_),M=this.expression.evaluate(new ci(this.zoom+1,T),f,_);this._setPaintValue(i,o,S,M)}_setPaintValue(i,o,f,_){if(this.type==="color"){const T=vp(f),S=vp(_);for(let M=i;M<o;M++)this.paintVertexArray.emplace(M,T[0],T[1],S[0],S[1])}else{for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,f,_);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(_))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o){const f=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,_=jt(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(_)}getBinding(i,o,f){return new Yi(i,o)}}class ml{constructor(i,o,f,_,T,S){this.expression=i,this.type=o,this.useIntegerZoom=f,this.zoom=_,this.layerId=S,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(i,o,f){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(_,i,this.getPositionIds(o),f)}updatePaintArray(i,o,f,_,T){this._setPaintValues(i,o,this.getPositionIds(f),T)}_setPaintValues(i,o,f,_){const T=this.getPositions(_);if(!T||!f)return;const S=T[f.min],M=T[f.mid],D=T[f.max];if(S&&M&&D)for(let L=i;L<o;L++)this.emplace(this.zoomInPaintVertexArray,L,M,S),this.emplace(this.zoomOutPaintVertexArray,L,M,D)}upload(i){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const o=this.getVertexAttributes();this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,o,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,o,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class gl extends ml{getPositions(i){return i.imagePositions}getPositionIds(i){return i.patterns&&i.patterns[this.layerId]}getVertexAttributes(){return Xr.members}emplace(i,o,f,_){i.emplace(o,f.tlbr[0],f.tlbr[1],f.tlbr[2],f.tlbr[3],_.tlbr[0],_.tlbr[1],_.tlbr[2],_.tlbr[3],f.pixelRatio,_.pixelRatio)}}class Xc extends ml{getPositions(i){return i.dashPositions}getPositionIds(i){return i.dashes&&i.dashes[this.layerId]}getVertexAttributes(){return nr.members}emplace(i,o,f,_){i.emplace(o,0,f.y,f.height,f.width,0,_.y,_.height,_.width)}}class af{constructor(i,o,f){this.binders={},this._buffers=[];const _=[];for(const T in i.paint._values){if(!f(T))continue;const S=i.paint.get(T);if(!(S instanceof Go&&vo(S.property.specification)))continue;const M=of(T,i.type),D=S.value,L=S.property.specification.type,N=S.property.useIntegerZoom,V=S.property.specification["property-type"],Y=V==="cross-faded"||V==="cross-faded-data-driven";if(D.kind==="constant")this.binders[T]=Y?new Ho(D.value,M):new Lu(D.value,M,L),_.push(`/u_${T}`);else if(D.kind==="source"||Y){const H=Hh(T,L,"source");this.binders[T]=Y?T==="line-dasharray"?new Xc(D,L,N,o,H,i.id):new gl(D,L,N,o,H,i.id):new qo(D,M,L,H),_.push(`/a_${T}`)}else{const H=Hh(T,L,"composite");this.binders[T]=new Pa(D,M,L,N,o,H),_.push(`/z_${T}`)}}this.cacheKey=_.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof qo||o instanceof Pa?o.maxValue:0}populatePaintArrays(i,o,f){for(const _ in this.binders){const T=this.binders[_];(T instanceof qo||T instanceof Pa||T instanceof ml)&&T.populatePaintArray(i,o,f)}}setConstantPatternPositions(i,o){for(const f in this.binders){const _=this.binders[f];_ instanceof Ho&&_.setConstantPatternPositions(i,o)}}setConstantDashPositions(i,o){for(const f in this.binders){const _=this.binders[f];_ instanceof Ho&&_.setConstantDashPositions(i,o)}}updatePaintArrays(i,o,f,_,T){let S=!1;for(const M in i){const D=o.getPositions(M);for(const L of D){const N=f.feature(L.index);for(const V in this.binders){const Y=this.binders[V];if((Y instanceof qo||Y instanceof Pa||Y instanceof ml)&&Y.expression.isStateDependent===!0){const H=_.paint.get(V);Y.expression=H.value,Y.updatePaintArray(L.start,L.end,N,i[M],T),S=!0}}}}return S}defines(){const i=[];for(const o in this.binders){const f=this.binders[o];(f instanceof Lu||f instanceof Ho)&&i.push(...f.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof qo||f instanceof Pa)for(let _=0;_<f.paintVertexAttributes.length;_++)i.push(f.paintVertexAttributes[_].name);else if(f instanceof ml){const _=f.getVertexAttributes();for(const T of _)i.push(T.name)}}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const f=this.binders[o];if(f instanceof Lu||f instanceof Ho||f instanceof Pa)for(const _ of f.uniformNames)i.push(_)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,o){const f=[];for(const _ in this.binders){const T=this.binders[_];if(T instanceof Lu||T instanceof Ho||T instanceof Pa){for(const S of T.uniformNames)if(o[S]){const M=T.getBinding(i,o[S],S);f.push({name:S,property:_,binding:M})}}}return f}setUniforms(i,o,f,_){for(const{name:T,property:S,binding:M}of o)this.binders[S].setUniform(M,_,f.get(S),T)}updatePaintBuffers(i){this._buffers=[];for(const o in this.binders){const f=this.binders[o];if(i&&f instanceof ml){const _=i.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(f instanceof qo||f instanceof Pa)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(i){for(const o in this.binders){const f=this.binders[o];(f instanceof qo||f instanceof Pa||f instanceof ml)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof qo||o instanceof Pa||o instanceof ml)&&o.destroy()}}}class Ls{constructor(i,o,f=()=>!0){this.programConfigurations={};for(const _ of i)this.programConfigurations[_.id]=new af(_,o,f);this.needsUpload=!1,this._featureMap=new Ps,this._bufferOffset=0}populatePaintArrays(i,o,f,_){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(i,o,_);o.id!==void 0&&this._featureMap.add(o.id,f,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,f,_){for(const T of f)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(i,this._featureMap,o,T,_)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function of(s,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}function Hh(s,i,o){const f={color:{source:$o,composite:j},number:{source:v,composite:$o}},_=function(T){return{"line-pattern":{source:He,composite:He},"fill-pattern":{source:He,composite:He},"fill-extrusion-pattern":{source:He,composite:He},"line-dasharray":{source:bt,composite:bt}}[T]}(s);return _&&_[o]||f[i][o]}Rt("ConstantBinder",Lu),Rt("CrossFadedConstantBinder",Ho),Rt("SourceExpressionBinder",qo),Rt("CrossFadedPatternBinder",gl),Rt("CrossFadedDasharrayBinder",Xc),Rt("CompositeExpressionBinder",Pa),Rt("ProgramConfiguration",af,{omit:["_buffers"]}),Rt("ProgramConfigurationSet",Ls);const Wc=Math.pow(2,14)-1,my=-Wc-1;function zu(s){const i=ut/s.extent,o=s.loadGeometry();for(let f=0;f<o.length;f++){const _=o[f];for(let T=0;T<_.length;T++){const S=_[T],M=Math.round(S.x*i),D=Math.round(S.y*i);S.x=jt(M,my,Wc),S.y=jt(D,my,Wc),(M<S.x||M>S.x+1||D<S.y||D>S.y+1)&&Ln("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Xo(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?zu(s):[]}}const gy=-32768;function M0(s,i,o,f,_){s.emplaceBack(gy+8*i+f,gy+8*o+_)}class Lm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasDependencies=!1,this.layoutVertexArray=new _e,this.indexArray=new ti,this.segments=new In,this.programConfigurations=new Ls(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){const _=this.layers[0],T=[];let S=null,M=!1,D=_.type==="heatmap";if(_.type==="circle"){const N=_;S=N.layout.get("circle-sort-key"),M=!S.isConstant(),D=D||N.paint.get("circle-pitch-alignment")==="map"}const L=D?o.subdivisionGranularity.circle:1;for(const{feature:N,id:V,index:Y,sourceLayerIndex:H}of i){const W=this.layers[0]._featureFilter.needGeometry,ae=Xo(N,W);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),ae,f))continue;const le=M?S.evaluate(ae,{},f):void 0,pe={id:V,properties:N.properties,type:N.type,sourceLayerIndex:H,index:Y,geometry:W?ae.geometry:zu(N),patterns:{},sortKey:le};T.push(pe)}M&&T.sort((N,V)=>N.sortKey-V.sortKey);for(const N of T){const{geometry:V,index:Y,sourceLayerIndex:H}=N,W=i[Y].feature;this.addFeature(N,V,Y,f,L),o.featureIndex.insert(W,V,Y,H,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,vi),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,f,_,T=1){let S;switch(T){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const M=S.length;for(const D of o)for(const L of D){const N=L.x,V=L.y;if(N<0||N>=ut||V<0||V>=ut)continue;const Y=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,i.sortKey),H=Y.vertexLength;for(let W=0;W<M;W++)for(let ae=0;ae<M;ae++)M0(this.layoutVertexArray,N,V,S[ae],S[W]);for(let W=0;W<M-1;W++)for(let ae=0;ae<M-1;ae++){const le=H+W*M+ae,pe=H+(W+1)*M+ae;this.indexArray.emplaceBack(le,pe+1,le+1),this.indexArray.emplaceBack(le,pe,pe+1)}Y.vertexLength+=M*M,Y.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:{},canonical:_})}}function bp(s,i){for(let o=0;o<s.length;o++)if(qh(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(qh(s,i[o]))return!0;return!!Nm(s,i)}function xp(s,i,o){return!!qh(s,i)||!!wp(i,s,o)}function zm(s,i){if(s.length===1)return ha(i,s[0]);for(let o=0;o<i.length;o++){const f=i[o];for(let _=0;_<f.length;_++)if(qh(s,f[_]))return!0}for(let o=0;o<s.length;o++)if(ha(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(Nm(s,i[o]))return!0;return!1}function C0(s,i,o){if(s.length>1){if(Nm(s,i))return!0;for(let f=0;f<i.length;f++)if(wp(i[f],s,o))return!0}for(let f=0;f<s.length;f++)if(wp(s[f],i,o))return!0;return!1}function Nm(s,i){if(s.length===0||i.length===0)return!1;for(let o=0;o<s.length-1;o++){const f=s[o],_=s[o+1];for(let T=0;T<i.length-1;T++)if(Zb(f,_,i[T],i[T+1]))return!0}return!1}function Zb(s,i,o,f){return Sn(s,o,f)!==Sn(i,o,f)&&Sn(s,i,o)!==Sn(s,i,f)}function wp(s,i,o){const f=o*o;if(i.length===1)return s.distSqr(i[0])<f;for(let _=1;_<i.length;_++)if(kr(s,i[_-1],i[_])<f)return!0;return!1}function kr(s,i,o){const f=i.distSqr(o);if(f===0)return s.distSqr(i);const _=((s.x-i.x)*(o.x-i.x)+(s.y-i.y)*(o.y-i.y))/f;return s.distSqr(_<0?i:_>1?o:o.sub(i)._mult(_)._add(i))}function ha(s,i){let o,f,_,T=!1;for(let S=0;S<s.length;S++){o=s[S];for(let M=0,D=o.length-1;M<o.length;D=M++)f=o[M],_=o[D],f.y>i.y!=_.y>i.y&&i.x<(_.x-f.x)*(i.y-f.y)/(_.y-f.y)+f.x&&(T=!T)}return T}function qh(s,i){let o=!1;for(let f=0,_=s.length-1;f<s.length;_=f++){const T=s[f],S=s[_];T.y>i.y!=S.y>i.y&&i.x<(S.x-T.x)*(i.y-T.y)/(S.y-T.y)+T.x&&(o=!o)}return o}function D0(s,i,o){const f=o[0],_=o[2];if(s.x<f.x&&i.x<f.x||s.x>_.x&&i.x>_.x||s.y<f.y&&i.y<f.y||s.y>_.y&&i.y>_.y)return!1;const T=Sn(s,i,o[0]);return T!==Sn(s,i,o[1])||T!==Sn(s,i,o[2])||T!==Sn(s,i,o[3])}function Xh(s,i,o){const f=i.paint.get(s).value;return f.kind==="constant"?f.value:o.programConfigurations.get(i.id).getMaxValue(s)}function Tp(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Nu(s,i,o,f,_){if(!i[0]&&!i[1])return s;const T=E.convert(i)._mult(_);o==="viewport"&&T._rotate(-f);const S=[];for(let M=0;M<s.length;M++)S.push(s[M].sub(T));return S}function I0({queryGeometry:s,size:i},o){return xp(s,o,i)}function jm({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_},T){return xp(s,T,i*(o.projectTileCoordinates(T.x,T.y,f,_).signedDistanceFromCamera/o.cameraToCenterDistance))}function R0({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_},T){const S=o.projectTileCoordinates(T.x,T.y,f,_).signedDistanceFromCamera,M=i*(o.cameraToCenterDistance/S);return xp(s,Ep(T,o,f,_),M)}function Yb({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_},T){return xp(s,Ep(T,o,f,_),i)}function Sp({queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_,pitchAlignment:T="map",pitchScale:S="map"},M){const D=T==="map"?S==="map"?I0:jm:S==="map"?R0:Yb,L={queryGeometry:s,size:i,transform:o,unwrappedTileID:f,getElevation:_};for(const N of M)for(const V of N)if(D(L,V))return!0;return!1}function Ep(s,i,o,f){const _=i.projectTileCoordinates(s.x,s.y,o,f).point;return new E((.5*_.x+.5)*i.width,(.5*-_.y+.5)*i.height)}let yy,_y;Rt("CircleBucket",Lm,{omit:["layers"]});var k0={get paint(){return _y=_y||new Si({"circle-radius":new qt(Be.paint_circle["circle-radius"]),"circle-color":new qt(Be.paint_circle["circle-color"]),"circle-blur":new qt(Be.paint_circle["circle-blur"]),"circle-opacity":new qt(Be.paint_circle["circle-opacity"]),"circle-translate":new Lt(Be.paint_circle["circle-translate"]),"circle-translate-anchor":new Lt(Be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Lt(Be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Lt(Be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(Be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(Be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(Be.paint_circle["circle-stroke-opacity"])})},get layout(){return yy=yy||new Si({"circle-sort-key":new qt(Be.layout_circle["circle-sort-key"])})}};class vy extends qr{constructor(i,o){super(i,k0,o)}createBucket(i){return new Lm(i)}queryRadius(i){const o=i;return Xh("circle-radius",this,o)+Xh("circle-stroke-width",this,o)+Tp(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:T,pixelsToTileUnits:S,unwrappedTileID:M,getElevation:D}){const L=Nu(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,S),N=this.paint.get("circle-radius").evaluate(o,f)+this.paint.get("circle-stroke-width").evaluate(o,f),V=this.paint.get("circle-pitch-scale"),Y=this.paint.get("circle-pitch-alignment");let H,W;return Y==="map"?(H=L,W=N*S):(H=function(ae,le,pe,Ne){return ae.map(ve=>Ep(ve,le,pe,Ne))}(L,T,M,D),W=N),Sp({queryGeometry:H,size:W,transform:T,unwrappedTileID:M,getElevation:D,pitchAlignment:Y,pitchScale:V},_)}}class Fm extends Lm{}let Bm;Rt("HeatmapBucket",Fm,{omit:["layers"]});var O0={get paint(){return Bm=Bm||new Si({"heatmap-radius":new qt(Be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(Be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Lt(Be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ou(Be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Lt(Be.paint_heatmap["heatmap-opacity"])})}};function Ap(s,{width:i,height:o},f,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==i*o*f)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${i*o*f}`)}else _=new Uint8Array(i*o*f);return s.width=i,s.height=o,s.data=_,s}function Mp(s,{width:i,height:o},f){if(i===s.width&&o===s.height)return;const _=Ap({},{width:i,height:o},f);Cp(s,_,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,i),height:Math.min(s.height,o)},f),s.width=i,s.height=o,s.data=_.data}function Cp(s,i,o,f,_,T){if(_.width===0||_.height===0)return i;if(_.width>s.width||_.height>s.height||o.x>s.width-_.width||o.y>s.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>i.width||_.height>i.height||f.x>i.width-_.width||f.y>i.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const S=s.data,M=i.data;if(S===M)throw new Error("srcData equals dstData, so image is already copied");for(let D=0;D<_.height;D++){const L=((o.y+D)*s.width+o.x)*T,N=((f.y+D)*i.width+f.x)*T;for(let V=0;V<_.width*T;V++)M[N+V]=S[L+V]}return i}class sf{constructor(i,o){Ap(this,i,1,o)}resize(i){Mp(this,i,1)}clone(){return new sf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,_,T){Cp(i,o,f,_,T,1)}}class Ta{constructor(i,o){Ap(this,i,4,o)}resize(i){Mp(this,i,4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,f,_,T){Cp(i,o,f,_,T,4)}setPixel(i,o,f){const _=4*(i*this.width+o);this.data[_+0]=Math.round(255*f.r/f.a),this.data[_+1]=Math.round(255*f.g/f.a),this.data[_+2]=Math.round(255*f.b/f.a),this.data[_+3]=Math.round(255*f.a)}}function by(s){const i={},o=s.resolution||256,f=s.clips?s.clips.length:1,_=s.image||new Ta({width:o,height:f});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const T=(S,M,D)=>{i[s.evaluationKey]=D;const L=s.expression.evaluate(i);_.setPixel(S/4/o,M/4,L)};if(s.clips)for(let S=0,M=0;S<f;++S,M+=4*o)for(let D=0,L=0;D<o;D++,L+=4){const N=D/(o-1),{start:V,end:Y}=s.clips[S];T(M,L,V*(1-N)+Y*N)}else for(let S=0,M=0;S<o;S++,M+=4)T(0,M,S/(o-1));return _}Rt("AlphaImage",sf),Rt("RGBAImage",Ta);const yl="big-fb";class xy extends qr{createBucket(i){return new Fm(i)}constructor(i,o){super(i,O0,o),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=by({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(yl)&&this.heatmapFbos.delete(yl)}queryRadius(i){return Xh("heatmap-radius",this,i)}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:T,pixelsToTileUnits:S,unwrappedTileID:M,getElevation:D}){return Sp({queryGeometry:i,size:this.paint.get("heatmap-radius").evaluate(o,f)*S,transform:T,unwrappedTileID:M,getElevation:D},_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let P0;var L0={get paint(){return P0=P0||new Si({"hillshade-illumination-direction":new Lt(Be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Lt(Be.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Lt(Be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Lt(Be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Lt(Be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Lt(Be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Lt(Be.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Lt(Be.paint_hillshade["hillshade-method"])})}};class Qc extends qr{constructor(i,o){super(i,L0,o),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,_=this.paint.get("hillshade-shadow-color").values;const T=Math.max(i.length,o.length,f.length,_.length);i=i.concat(Array(T-i.length).fill(i.at(-1))),o=o.concat(Array(T-o.length).fill(o.at(-1))),f=f.concat(Array(T-f.length).fill(f.at(-1))),_=_.concat(Array(T-_.length).fill(_.at(-1)));const S=o.map(ys);return{directionRadians:i.map(ys),altitudeRadians:S,shadowColor:_,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Um;var z0={get paint(){return Um=Um||new Si({"color-relief-opacity":new Lt(Be["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Ou(Be["paint_color-relief"]["color-relief-color"])})}};class lf{constructor(i,o,f,_){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(o,_)}update(i,o,f){const{width:_,height:T}=i,S=!(this.size&&this.size[0]===_&&this.size[1]===T||f),{context:M}=this,{gl:D}=M;if(this.useMipmap=!!(o&&o.useMipmap),D.bindTexture(D.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===D.RGBA&&(!o||o.premultiply!==!1)),S)this.size=[_,T],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Ar(i)?D.texImage2D(D.TEXTURE_2D,0,this.format,this.format,D.UNSIGNED_BYTE,i):D.texImage2D(D.TEXTURE_2D,0,this.format,_,T,0,this.format,D.UNSIGNED_BYTE,i.data);else{const{x:L,y:N}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Ar(i)?D.texSubImage2D(D.TEXTURE_2D,0,L,N,D.RGBA,D.UNSIGNED_BYTE,i):D.texSubImage2D(D.TEXTURE_2D,0,L,N,_,T,D.RGBA,D.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&D.generateMipmap(D.TEXTURE_2D),M.pixelStoreUnpackFlipY.setDefault(),M.pixelStoreUnpack.setDefault(),M.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,o,f){const{context:_}=this,{gl:T}=_;T.bindTexture(T.TEXTURE_2D,this.texture),f!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=T.LINEAR),i!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,i),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,f||i),this.filter=i),o!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,o),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class cf{constructor(i,o,f,_=1,T=1,S=1,M=0){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Ln(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const D=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=T,this.blueFactor=S,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let L=0;L<D;L++)this.data[this._idx(-1,L)]=this.data[this._idx(0,L)],this.data[this._idx(D,L)]=this.data[this._idx(D-1,L)],this.data[this._idx(L,-1)]=this.data[this._idx(L,0)],this.data[this._idx(L,D)]=this.data[this._idx(L,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let L=0;L<D;L++)for(let N=0;N<D;N++){const V=this.get(L,N);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(i,o){const f=new Uint8Array(this.data.buffer),_=4*this._idx(i,o);return this.unpack(f[_],f[_+1],f[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}unpack(i,o,f){return i*this.redFactor+o*this.greenFactor+f*this.blueFactor-this.baseShift}pack(i){return Hi(i,this.getUnpackVector())}getPixels(){return new Ta({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,o,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let _=o*this.dim,T=o*this.dim+this.dim,S=f*this.dim,M=f*this.dim+this.dim;switch(o){case-1:_=T-1;break;case 1:T=_+1}switch(f){case-1:S=M-1;break;case 1:M=S+1}const D=-o*this.dim,L=-f*this.dim;for(let N=S;N<M;N++)for(let V=_;V<T;V++)this.data[this._idx(V,N)]=i.data[this._idx(V+D,N+L)]}}function Hi(s,i){const o=i[0],f=i[1],_=i[2],T=i[3],S=Math.min(o,f,_),M=Math.round((s+T)/S);return{r:Math.floor(M*S/o)%256,g:Math.floor(M*S/f)%256,b:Math.floor(M*S/_)%256}}Rt("DEMData",cf);class Hb extends qr{constructor(i,o){super(i,z0,o)}_createColorRamp(i){const o={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof xa&&f._styleExpression.expression instanceof Rr){this.colorRampExpression=f;const S=f._styleExpression.expression;o.elevationStops=S.labels,o.colorStops=[];for(const M of o.elevationStops)o.colorStops.push(S.evaluate({globals:{elevation:M}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[xn.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=i)return o;const _={elevationStops:[],colorStops:[]},T=(o.elevationStops.length-1)/(i-1);for(let S=0;S<o.elevationStops.length-.5;S+=T)_.elevationStops.push(o.elevationStops[Math.round(S)]),_.colorStops.push(o.colorStops[Math.round(S)]);return Ln(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),_}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,o,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const _=this._createColorRamp(o),T=new Ta({width:_.colorStops.length,height:1}),S=new Ta({width:_.colorStops.length,height:1});for(let M=0;M<_.elevationStops.length;M++){const D=Hi(_.elevationStops[M],f);S.setPixel(0,M,new xn(D.r/255,D.g/255,D.b/255,1)),T.setPixel(0,M,_.colorStops[M])}return this.colorRampTextures={elevationTexture:new lf(i,S,i.gl.RGBA),colorTexture:new lf(i,T,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const qb=ui([{name:"a_pos",components:2,type:"Int16"}],4),{members:N0}=qb;function ju(s,i,o){const f=o.patternDependencies;let _=!1;for(const T of i){const S=T.paint.get(`${s}-pattern`);S.isConstant()||(_=!0);const M=S.constantOr(null);M&&(_=!0,f[M.to]=!0,f[M.from]=!0)}return _}function ac(s,i,o,f,_){const{zoom:T}=f,S=_.patternDependencies;for(const M of i){const D=M.paint.get(`${s}-pattern`).value;if(D.kind!=="constant"){let L=D.evaluate({zoom:T-1},o,{},_.availableImages),N=D.evaluate({zoom:T},o,{},_.availableImages),V=D.evaluate({zoom:T+1},o,{},_.availableImages);L=L&&L.name?L.name:L,N=N&&N.name?N.name:N,V=V&&V.name?V.name:V,S[L]=!0,S[N]=!0,S[V]=!0,o.patterns[M.id]={min:L,mid:N,max:V}}}return o}function wy(s,i,o,f,_){let T;if(_===function(S,M,D,L){let N=0;for(let V=M,Y=D-L;V<D;V+=L)N+=(S[Y]-S[V])*(S[V+1]+S[Y+1]),Y=V;return N}(s,i,o,f)>0)for(let S=i;S<o;S+=f)T=My(S/f|0,s[S],s[S+1],T);else for(let S=o-f;S>=i;S-=f)T=My(S/f|0,s[S],s[S+1],T);return T&&uf(T,T.next)&&(hf(T),T=T.next),T}function Fu(s,i){if(!s)return s;i||(i=s);let o,f=s;do if(o=!1,f.steiner||!uf(f,f.next)&&Fn(f.prev,f,f.next)!==0)f=f.next;else{if(hf(f),f=i=f.prev,f===f.next)break;o=!0}while(o||f!==i);return i}function Kc(s,i,o,f,_,T,S){if(!s)return;!S&&T&&function(D,L,N,V){let Y=D;do Y.z===0&&(Y.z=Gm(Y.x,Y.y,L,N,V)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==D);Y.prevZ.nextZ=null,Y.prevZ=null,function(H){let W,ae=1;do{let le,pe=H;H=null;let Ne=null;for(W=0;pe;){W++;let ve=pe,Ce=0;for(let Ke=0;Ke<ae&&(Ce++,ve=ve.nextZ,ve);Ke++);let Ze=ae;for(;Ce>0||Ze>0&&ve;)Ce!==0&&(Ze===0||!ve||pe.z<=ve.z)?(le=pe,pe=pe.nextZ,Ce--):(le=ve,ve=ve.nextZ,Ze--),Ne?Ne.nextZ=le:H=le,le.prevZ=Ne,Ne=le;pe=ve}Ne.nextZ=null,ae*=2}while(W>1)}(Y)}(s,f,_,T);let M=s;for(;s.prev!==s.next;){const D=s.prev,L=s.next;if(T?j0(s,f,_,T):oc(s))i.push(D.i,s.i,L.i),hf(s),s=L.next,M=L.next;else if((s=L)===M){S?S===1?Kc(s=Ty(Fu(s),i),i,o,f,_,T,2):S===2&&F0(s,i,o,f,_,T):Kc(Fu(s),i,o,f,_,T,1);break}}}function oc(s){const i=s.prev,o=s,f=s.next;if(Fn(i,o,f)>=0)return!1;const _=i.x,T=o.x,S=f.x,M=i.y,D=o.y,L=f.y,N=Math.min(_,T,S),V=Math.min(M,D,L),Y=Math.max(_,T,S),H=Math.max(M,D,L);let W=f.next;for(;W!==i;){if(W.x>=N&&W.x<=Y&&W.y>=V&&W.y<=H&&Wh(_,M,T,D,S,L,W.x,W.y)&&Fn(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function j0(s,i,o,f){const _=s.prev,T=s,S=s.next;if(Fn(_,T,S)>=0)return!1;const M=_.x,D=T.x,L=S.x,N=_.y,V=T.y,Y=S.y,H=Math.min(M,D,L),W=Math.min(N,V,Y),ae=Math.max(M,D,L),le=Math.max(N,V,Y),pe=Gm(H,W,i,o,f),Ne=Gm(ae,le,i,o,f);let ve=s.prevZ,Ce=s.nextZ;for(;ve&&ve.z>=pe&&Ce&&Ce.z<=Ne;){if(ve.x>=H&&ve.x<=ae&&ve.y>=W&&ve.y<=le&&ve!==_&&ve!==S&&Wh(M,N,D,V,L,Y,ve.x,ve.y)&&Fn(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Ce.x>=H&&Ce.x<=ae&&Ce.y>=W&&Ce.y<=le&&Ce!==_&&Ce!==S&&Wh(M,N,D,V,L,Y,Ce.x,Ce.y)&&Fn(Ce.prev,Ce,Ce.next)>=0))return!1;Ce=Ce.nextZ}for(;ve&&ve.z>=pe;){if(ve.x>=H&&ve.x<=ae&&ve.y>=W&&ve.y<=le&&ve!==_&&ve!==S&&Wh(M,N,D,V,L,Y,ve.x,ve.y)&&Fn(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Ce&&Ce.z<=Ne;){if(Ce.x>=H&&Ce.x<=ae&&Ce.y>=W&&Ce.y<=le&&Ce!==_&&Ce!==S&&Wh(M,N,D,V,L,Y,Ce.x,Ce.y)&&Fn(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function Ty(s,i){let o=s;do{const f=o.prev,_=o.next.next;!uf(f,_)&&Ay(f,o,o.next,_)&&da(f,_)&&da(_,f)&&(i.push(f.i,o.i,_.i),hf(o),hf(o.next),o=s=_),o=o.next}while(o!==s);return Fu(o)}function F0(s,i,o,f,_,T){let S=s;do{let M=S.next.next;for(;M!==S.prev;){if(S.i!==M.i&&B0(S,M)){let D=sc(S,M);return S=Fu(S,S.next),D=Fu(D,D.next),Kc(S,i,o,f,_,T,0),void Kc(D,i,o,f,_,T,0)}M=M.next}S=S.next}while(S!==s)}function Sy(s,i){let o=s.x-i.x;return o===0&&(o=s.y-i.y,o===0)&&(o=(s.next.y-s.y)/(s.next.x-s.x)-(i.next.y-i.y)/(i.next.x-i.x)),o}function Ey(s,i){const o=function(_,T){let S=T;const M=_.x,D=_.y;let L,N=-1/0;if(uf(_,S))return S;do{if(uf(_,S.next))return S.next;if(D<=S.y&&D>=S.next.y&&S.next.y!==S.y){const ae=S.x+(D-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(ae<=M&&ae>N&&(N=ae,L=S.x<S.next.x?S:S.next,ae===M))return L}S=S.next}while(S!==T);if(!L)return null;const V=L,Y=L.x,H=L.y;let W=1/0;S=L;do{if(M>=S.x&&S.x>=Y&&M!==S.x&&Or(D<H?M:N,D,Y,H,D<H?N:M,D,S.x,S.y)){const ae=Math.abs(D-S.y)/(M-S.x);da(S,_)&&(ae<W||ae===W&&(S.x>L.x||S.x===L.x&&Vm(L,S)))&&(L=S,W=ae)}S=S.next}while(S!==V);return L}(s,i);if(!o)return i;const f=sc(o,s);return Fu(f,f.next),Fu(o,o.next)}function Vm(s,i){return Fn(s.prev,s,i.prev)<0&&Fn(i.next,s,s.next)<0}function Gm(s,i,o,f,_){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*_|0)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*_|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Jc(s){let i=s,o=s;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==s);return o}function Or(s,i,o,f,_,T,S,M){return(_-S)*(i-M)>=(s-S)*(T-M)&&(s-S)*(f-M)>=(o-S)*(i-M)&&(o-S)*(T-M)>=(_-S)*(f-M)}function Wh(s,i,o,f,_,T,S,M){return!(s===S&&i===M)&&Or(s,i,o,f,_,T,S,M)}function B0(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(o,f){let _=o;do{if(_.i!==o.i&&_.next.i!==o.i&&_.i!==f.i&&_.next.i!==f.i&&Ay(_,_.next,o,f))return!0;_=_.next}while(_!==o);return!1}(s,i)&&(da(s,i)&&da(i,s)&&function(o,f){let _=o,T=!1;const S=(o.x+f.x)/2,M=(o.y+f.y)/2;do _.y>M!=_.next.y>M&&_.next.y!==_.y&&S<(_.next.x-_.x)*(M-_.y)/(_.next.y-_.y)+_.x&&(T=!T),_=_.next;while(_!==o);return T}(s,i)&&(Fn(s.prev,s,i.prev)||Fn(s,i.prev,i))||uf(s,i)&&Fn(s.prev,s,s.next)>0&&Fn(i.prev,i,i.next)>0)}function Fn(s,i,o){return(i.y-s.y)*(o.x-i.x)-(i.x-s.x)*(o.y-i.y)}function uf(s,i){return s.x===i.x&&s.y===i.y}function Ay(s,i,o,f){const _=Gi(Fn(s,i,o)),T=Gi(Fn(s,i,f)),S=Gi(Fn(o,f,s)),M=Gi(Fn(o,f,i));return _!==T&&S!==M||!(_!==0||!Dp(s,o,i))||!(T!==0||!Dp(s,f,i))||!(S!==0||!Dp(o,s,f))||!(M!==0||!Dp(o,i,f))}function Dp(s,i,o){return i.x<=Math.max(s.x,o.x)&&i.x>=Math.min(s.x,o.x)&&i.y<=Math.max(s.y,o.y)&&i.y>=Math.min(s.y,o.y)}function Gi(s){return s>0?1:s<0?-1:0}function da(s,i){return Fn(s.prev,s,s.next)<0?Fn(s,i,s.next)>=0&&Fn(s,s.prev,i)>=0:Fn(s,i,s.prev)<0||Fn(s,s.next,i)<0}function sc(s,i){const o=$m(s.i,s.x,s.y),f=$m(i.i,i.x,i.y),_=s.next,T=i.prev;return s.next=i,i.prev=s,o.next=_,_.prev=o,f.next=o,o.prev=f,T.next=f,f.prev=T,f}function My(s,i,o,f){const _=$m(s,i,o);return f?(_.next=f.next,_.prev=f,f.next.prev=_,f.next=_):(_.prev=_,_.next=_),_}function hf(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function $m(s,i,o){return{i:s,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class df{constructor(i,o){if(o>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=o}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class Qh{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}Qh.noSubdivision=new Qh({fill:new df(0,0),line:new df(0,0),tile:new df(0,0),stencil:new df(0,0),circle:1}),Rt("SubdivisionGranularityExpression",df),Rt("SubdivisionGranularitySetting",Qh);const na=-32768,no=32767;class U0{constructor(i,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=ut/i,this._canonical=o}_getKey(i,o){return(i+=32768)<<16|o+32768}_vertexToIndex(i,o){if(i<-32768||o<-32768||i>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(i),_=0|Math.round(o),T=this._getKey(f,_);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,S),this._vertexBuffer.push(f,_),S}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(_,T){const S=[];for(let M=0;M<T.length;M+=3){const D=T[M],L=T[M+1],N=T[M+2],V=_[2*D],Y=_[2*D+1];(_[2*L]-V)*(_[2*N+1]-Y)-(_[2*L+1]-Y)*(_[2*N]-V)>0?(S.push(D),S.push(N),S.push(L)):(S.push(D),S.push(L),S.push(N))}return S}(this._vertexBuffer,i);const o=[],f=i.length;for(let _=0;_<f;_+=3){const T=[i[_+0],i[_+1],i[_+2]],S=[this._vertexBuffer[2*i[_+0]+0],this._vertexBuffer[2*i[_+0]+1],this._vertexBuffer[2*i[_+1]+0],this._vertexBuffer[2*i[_+1]+1],this._vertexBuffer[2*i[_+2]+0],this._vertexBuffer[2*i[_+2]+1]];let M=1/0,D=1/0,L=-1/0,N=-1/0;for(let ae=0;ae<3;ae++){const le=S[2*ae],pe=S[2*ae+1];M=Math.min(M,le),L=Math.max(L,le),D=Math.min(D,pe),N=Math.max(N,pe)}if(M===L||D===N)continue;const V=Math.floor(M/this._granularityCellSize),Y=Math.ceil(L/this._granularityCellSize),H=Math.floor(D/this._granularityCellSize),W=Math.ceil(N/this._granularityCellSize);if(V!==Y||H!==W)for(let ae=H;ae<W;ae++){const le=this._scanlineGenerateVertexRingForCellRow(ae,S,T);eu(this._vertexBuffer,le,o)}else o.push(...T)}return o}_scanlineGenerateVertexRingForCellRow(i,o,f){const _=i*this._granularityCellSize,T=_+this._granularityCellSize,S=[];for(let M=0;M<3;M++){const D=o[2*M],L=o[2*M+1],N=o[2*(M+1)%6],V=o[(2*(M+1)+1)%6],Y=o[2*(M+2)%6],H=o[(2*(M+2)+1)%6],W=N-D,ae=V-L,le=W===0,pe=ae===0,Ne=(_-L)/ae,ve=(T-L)/ae,Ce=Math.min(Ne,ve),Ze=Math.max(Ne,ve);if(!pe&&(Ce>=1||Ze<=0)||pe&&(L<_||L>T)){V>=_&&V<=T&&S.push(f[(M+1)%3]);continue}!pe&&Ce>0&&S.push(this._vertexToIndex(D+W*Ce,L+ae*Ce));const Ke=D+W*Math.max(Ce,0),ft=D+W*Math.min(Ze,1);le||this._generateIntraEdgeVertices(S,D,L,N,V,Ke,ft),!pe&&Ze<1&&S.push(this._vertexToIndex(D+W*Ze,L+ae*Ze)),(pe||V>=_&&V<=T)&&S.push(f[(M+1)%3]),!pe&&(V<=_||V>=T)&&this._generateInterEdgeVertices(S,D,L,N,V,Y,H,ft,_,T)}return S}_generateIntraEdgeVertices(i,o,f,_,T,S,M){const D=_-o,L=T-f,N=L===0,V=N?Math.min(o,_):Math.min(S,M),Y=N?Math.max(o,_):Math.max(S,M),H=Math.floor(V/this._granularityCellSize)+1,W=Math.ceil(Y/this._granularityCellSize)-1;if(N?o<_:S<M)for(let ae=H;ae<=W;ae++){const le=ae*this._granularityCellSize;i.push(this._vertexToIndex(le,f+L*(le-o)/D))}else for(let ae=W;ae>=H;ae--){const le=ae*this._granularityCellSize;i.push(this._vertexToIndex(le,f+L*(le-o)/D))}}_generateInterEdgeVertices(i,o,f,_,T,S,M,D,L,N){const V=T-f,Y=S-_,H=M-T,W=(L-T)/H,ae=(N-T)/H,le=Math.min(W,ae),pe=Math.max(W,ae),Ne=_+Y*le;let ve=Math.floor(Math.min(Ne,D)/this._granularityCellSize)+1,Ce=Math.ceil(Math.max(Ne,D)/this._granularityCellSize)-1,Ze=D<Ne;const Ke=H===0;if(Ke&&(M===L||M===N))return;if(Ke||le>=1||pe<=0){const Dt=f-M,St=S+(o-S)*Math.min((L-M)/Dt,(N-M)/Dt);ve=Math.floor(Math.min(St,D)/this._granularityCellSize)+1,Ce=Math.ceil(Math.max(St,D)/this._granularityCellSize)-1,Ze=D<St}const ft=V>0?N:L;if(Ze)for(let Dt=ve;Dt<=Ce;Dt++)i.push(this._vertexToIndex(Dt*this._granularityCellSize,ft));else for(let Dt=Ce;Dt>=ve;Dt--)i.push(this._vertexToIndex(Dt*this._granularityCellSize,ft))}_generateOutline(i){const o=[];for(const f of i){const _=Bu(f,this._granularity,!0),T=this._pointArrayToIndices(_),S=[];for(let M=1;M<T.length;M++)S.push(T[M-1]),S.push(T[M]);o.push(S)}return o}_handlePoles(i){let o=!1,f=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(o||f)&&this._fillPoles(i,o,f)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let o=0;o<i.length;o+=2){const f=i[o+1];f===na&&(i[o+1]=-32767),f===no&&(i[o+1]=32766)}}_generatePoleQuad(i,o,f,_,T,S){_>T!=(S===na)?(i.push(o),i.push(f),i.push(this._vertexToIndex(_,S)),i.push(f),i.push(this._vertexToIndex(T,S)),i.push(this._vertexToIndex(_,S))):(i.push(f),i.push(o),i.push(this._vertexToIndex(_,S)),i.push(this._vertexToIndex(T,S)),i.push(f),i.push(this._vertexToIndex(_,S)))}_fillPoles(i,o,f){const _=this._vertexBuffer,T=ut,S=i.length;for(let M=2;M<S;M+=3){const D=i[M-2],L=i[M-1],N=i[M],V=_[2*D],Y=_[2*D+1],H=_[2*L],W=_[2*L+1],ae=_[2*N],le=_[2*N+1];o&&(Y===0&&W===0&&this._generatePoleQuad(i,D,L,V,H,na),W===0&&le===0&&this._generatePoleQuad(i,L,N,H,ae,na),le===0&&Y===0&&this._generatePoleQuad(i,N,D,ae,V,na)),f&&(Y===T&&W===T&&this._generatePoleQuad(i,D,L,V,H,no),W===T&&le===T&&this._generatePoleQuad(i,L,N,H,ae,no),le===T&&Y===T&&this._generatePoleQuad(i,N,D,ae,V,no))}}_initializeVertices(i){for(let o=0;o<i.length;o+=2)this._vertexToIndex(i[o],i[o+1])}subdividePolygonInternal(i,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:_}=function(M){const D=[],L=[];for(const N of M)if(N.length!==0){N!==M[0]&&D.push(L.length/2);for(let V=0;V<N.length;V++)L.push(N[V].x),L.push(N[V].y)}return{flattened:L,holeIndices:D}}(i);let T;this._initializeVertices(f);try{const M=function(L,N,V=2){const Y=N&&N.length,H=Y?N[0]*V:L.length;let W=wy(L,0,H,V,!0);const ae=[];if(!W||W.next===W.prev)return ae;let le,pe,Ne;if(Y&&(W=function(ve,Ce,Ze,Ke){const ft=[];for(let Dt=0,St=Ce.length;Dt<St;Dt++){const Mt=wy(ve,Ce[Dt]*Ke,Dt<St-1?Ce[Dt+1]*Ke:ve.length,Ke,!1);Mt===Mt.next&&(Mt.steiner=!0),ft.push(Jc(Mt))}ft.sort(Sy);for(let Dt=0;Dt<ft.length;Dt++)Ze=Ey(ft[Dt],Ze);return Ze}(L,N,W,V)),L.length>80*V){le=L[0],pe=L[1];let ve=le,Ce=pe;for(let Ze=V;Ze<H;Ze+=V){const Ke=L[Ze],ft=L[Ze+1];Ke<le&&(le=Ke),ft<pe&&(pe=ft),Ke>ve&&(ve=Ke),ft>Ce&&(Ce=ft)}Ne=Math.max(ve-le,Ce-pe),Ne=Ne!==0?32767/Ne:0}return Kc(W,ae,V,le,pe,Ne,0),ae}(f,_),D=this._convertIndices(f,M);T=this._subdivideTrianglesScanline(D)}catch(M){console.error(M)}let S=[];return o&&(S=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:S}}_convertIndices(i,o){const f=[];for(let _=0;_<o.length;_++)f.push(this._vertexToIndex(i[2*o[_]],i[2*o[_]+1]));return f}_pointArrayToIndices(i){const o=[];for(let f=0;f<i.length;f++){const _=i[f];o.push(this._vertexToIndex(_.x,_.y))}return o}}function io(s,i,o,f=!0){return new U0(o,i).subdividePolygonInternal(s,f)}function Bu(s,i,o=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const f=s[0],_=s[s.length-1],T=o&&(f.x!==_.x||f.y!==_.y);if(i<2)return T?[...s,s[0]]:[...s];const S=Math.floor(ut/i),M=[];M.push(new E(s[0].x,s[0].y));const D=s.length,L=T?D:D-1;for(let N=0;N<L;N++){const V=s[N],Y=N<D-1?s[N+1]:s[0],H=V.x,W=V.y,ae=Y.x,le=Y.y,pe=H!==ae,Ne=W!==le;if(!pe&&!Ne)continue;const ve=ae-H,Ce=le-W,Ze=Math.abs(ve),Ke=Math.abs(Ce);let ft=H,Dt=W;for(;;){const Mt=ve>0?(Math.floor(ft/S)+1)*S:(Math.ceil(ft/S)-1)*S,$t=Ce>0?(Math.floor(Dt/S)+1)*S:(Math.ceil(Dt/S)-1)*S,At=Math.abs(ft-Mt),Ct=Math.abs(Dt-$t),at=Math.abs(ft-ae),Qt=Math.abs(Dt-le),nn=pe?At/Ze:Number.POSITIVE_INFINITY,Xt=Ne?Ct/Ke:Number.POSITIVE_INFINITY;if((at<=At||!pe)&&(Qt<=Ct||!Ne))break;if(nn<Xt&&pe||!Ne){ft=Mt,Dt+=Ce*nn;const Bt=new E(ft,Math.round(Dt));M[M.length-1].x===Bt.x&&M[M.length-1].y===Bt.y||M.push(Bt)}else{ft+=ve*Xt,Dt=$t;const Bt=new E(Math.round(ft),Dt);M[M.length-1].x===Bt.x&&M[M.length-1].y===Bt.y||M.push(Bt)}}const St=new E(ae,le);M[M.length-1].x===St.x&&M[M.length-1].y===St.y||M.push(St)}return M}function eu(s,i,o){if(i.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,_=s[2*i[0]];for(let D=1;D<i.length;D++){const L=s[2*i[D]];L<_&&(_=L,f=D)}const T=i.length;let S=f,M=(S+1)%T;for(;;){const D=S-1>=0?S-1:T-1,L=(M+1)%T,N=s[2*i[D]],V=s[2*i[L]],Y=s[2*i[S]],H=s[2*i[S]+1],W=s[2*i[M]+1];let ae=!1;if(N<V)ae=!0;else if(N>V)ae=!1;else{const le=W-H,pe=-(s[2*i[M]]-Y),Ne=H<W?1:-1;((N-Y)*le+(s[2*i[D]+1]-H)*pe)*Ne>((V-Y)*le+(s[2*i[L]+1]-H)*pe)*Ne&&(ae=!0)}if(ae){const le=i[D],pe=i[S],Ne=i[M];le!==pe&&le!==Ne&&pe!==Ne&&o.push(Ne,pe,le),S--,S<0&&(S=T-1)}else{const le=i[L],pe=i[S],Ne=i[M];le!==pe&&le!==Ne&&pe!==Ne&&o.push(Ne,pe,le),M++,M>=T&&(M=0)}if(D===L)break}}function Uu(s,i,o,f,_,T,S,M,D){const L=_.length/2,N=S&&M&&D;if(L<In.MAX_VERTEX_ARRAY_LENGTH){const V=i.prepareSegment(L,o,f),Y=V.vertexLength;for(let ae=0;ae<T.length;ae+=3)f.emplaceBack(Y+T[ae],Y+T[ae+1],Y+T[ae+2]);let H,W;V.vertexLength+=L,V.primitiveLength+=T.length/3,N&&(W=S.prepareSegment(L,o,M),H=W.vertexLength,W.vertexLength+=L);for(let ae=0;ae<_.length;ae+=2)s(_[ae],_[ae+1]);if(N)for(let ae=0;ae<D.length;ae++){const le=D[ae];for(let pe=1;pe<le.length;pe+=2)M.emplaceBack(H+le[pe-1],H+le[pe]);W.primitiveLength+=le.length/2}}else(function(V,Y,H,W,ae,le){const pe=[];for(let Ke=0;Ke<W.length/2;Ke++)pe.push(-1);const Ne={count:0};let ve=0,Ce=V.getOrCreateLatestSegment(Y,H),Ze=Ce.vertexLength;for(let Ke=2;Ke<ae.length;Ke+=3){const ft=ae[Ke-2],Dt=ae[Ke-1],St=ae[Ke];let Mt=pe[ft]<ve,$t=pe[Dt]<ve,At=pe[St]<ve;Ce.vertexLength+((Mt?1:0)+($t?1:0)+(At?1:0))>In.MAX_VERTEX_ARRAY_LENGTH&&(Ce=V.createNewSegment(Y,H),ve=Ne.count,Mt=!0,$t=!0,At=!0,Ze=0);const Ct=Wo(pe,W,le,Ne,ft,Mt,Ce),at=Wo(pe,W,le,Ne,Dt,$t,Ce),Qt=Wo(pe,W,le,Ne,St,At,Ce);H.emplaceBack(Ze+Ct-ve,Ze+at-ve,Ze+Qt-ve),Ce.primitiveLength++}})(i,o,f,_,T,s),N&&function(V,Y,H,W,ae,le){const pe=[];for(let Ke=0;Ke<W.length/2;Ke++)pe.push(-1);const Ne={count:0};let ve=0,Ce=V.getOrCreateLatestSegment(Y,H),Ze=Ce.vertexLength;for(let Ke=0;Ke<ae.length;Ke++){const ft=ae[Ke];for(let Dt=1;Dt<ae[Ke].length;Dt+=2){const St=ft[Dt-1],Mt=ft[Dt];let $t=pe[St]<ve,At=pe[Mt]<ve;Ce.vertexLength+(($t?1:0)+(At?1:0))>In.MAX_VERTEX_ARRAY_LENGTH&&(Ce=V.createNewSegment(Y,H),ve=Ne.count,$t=!0,At=!0,Ze=0);const Ct=Wo(pe,W,le,Ne,St,$t,Ce),at=Wo(pe,W,le,Ne,Mt,At,Ce);H.emplaceBack(Ze+Ct-ve,Ze+at-ve),Ce.primitiveLength++}}}(S,o,M,_,D,s),i.forceNewSegmentOnNextPrepare(),S?.forceNewSegmentOnNextPrepare()}function Wo(s,i,o,f,_,T,S){if(T){const M=f.count;return o(i[2*_],i[2*_+1]),s[_]=f.count,f.count++,S.vertexLength++,M}return s[_]}class Ip{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Le,this.indexArray=new ti,this.indexArray2=new ni,this.programConfigurations=new Ls(i.layers,i.zoom),this.segments=new In,this.segments2=new In,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasDependencies=ju("fill",this.layers,o);const _=this.layers[0].layout.get("fill-sort-key"),T=!_.isConstant(),S=[];for(const{feature:M,id:D,index:L,sourceLayerIndex:N}of i){const V=this.layers[0]._featureFilter.needGeometry,Y=Xo(M,V);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),Y,f))continue;const H=T?_.evaluate(Y,{},f,o.availableImages):void 0,W={id:D,properties:M.properties,type:M.type,sourceLayerIndex:N,index:L,geometry:V?Y.geometry:zu(M),patterns:{},sortKey:H};S.push(W)}T&&S.sort((M,D)=>M.sortKey-D.sortKey);for(const M of S){const{geometry:D,index:L,sourceLayerIndex:N}=M;if(this.hasDependencies){const V=ac("fill",this.layers,M,{zoom:this.zoom},o);this.patternFeatures.push(V)}else this.addFeature(M,D,L,f,{},o.subdivisionGranularity);o.featureIndex.insert(i[L].feature,D,L,N,this.index)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}addFeatures(i,o,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,o,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,N0),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,f,_,T,S){for(const M of Sh(o,500)){const D=io(M,_,S.fill.getGranularityForZoomLevel(_.z)),L=this.layoutVertexArray;Uu((N,V)=>{L.emplaceBack(N,V)},this.segments,this.layoutVertexArray,this.indexArray,D.verticesFlattened,D.indicesTriangles,this.segments2,this.indexArray2,D.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:T,canonical:_})}}let Zm,zs;Rt("FillBucket",Ip,{omit:["layers","patternFeatures"]});var V0={get paint(){return zs=zs||new Si({"fill-antialias":new Lt(Be.paint_fill["fill-antialias"]),"fill-opacity":new qt(Be.paint_fill["fill-opacity"]),"fill-color":new qt(Be.paint_fill["fill-color"]),"fill-outline-color":new qt(Be.paint_fill["fill-outline-color"]),"fill-translate":new Lt(Be.paint_fill["fill-translate"]),"fill-translate-anchor":new Lt(Be.paint_fill["fill-translate-anchor"]),"fill-pattern":new Yc(Be.paint_fill["fill-pattern"])})},get layout(){return Zm=Zm||new Si({"fill-sort-key":new qt(Be.layout_fill["fill-sort-key"])})}};class ff extends qr{constructor(i,o){super(i,V0,o)}recalculate(i,o){super.recalculate(i,o);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Ip(i)}queryRadius(){return Tp(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:o,transform:f,pixelsToTileUnits:_}){return zm(Nu(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,_),o)}isTileClipped(){return!0}}const Rp=ui([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),kp=ui([{name:"a_centroid",components:2,type:"Int16"}],4),{members:pf}=Rp;class Kh{constructor(i,o,f,_,T){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=_,this._values=T,i.readFields(G0,this,o)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const o=i.readVarint()+i.pos,f=[];let _,T=1,S=0,M=0,D=0;for(;i.pos<o;){if(S<=0){const L=i.readVarint();T=7&L,S=L>>3}if(S--,T===1||T===2)M+=i.readSVarint(),D+=i.readSVarint(),T===1&&(_&&f.push(_),_=[]),_&&_.push(new E(M,D));else{if(T!==7)throw new Error(`unknown command ${T}`);_&&_.push(_[0].clone())}}return _&&f.push(_),f}bbox(){const i=this._pbf;i.pos=this._geometry;const o=i.readVarint()+i.pos;let f=1,_=0,T=0,S=0,M=1/0,D=-1/0,L=1/0,N=-1/0;for(;i.pos<o;){if(_<=0){const V=i.readVarint();f=7&V,_=V>>3}if(_--,f===1||f===2)T+=i.readSVarint(),S+=i.readSVarint(),T<M&&(M=T),T>D&&(D=T),S<L&&(L=S),S>N&&(N=S);else if(f!==7)throw new Error(`unknown command ${f}`)}return[M,L,D,N]}toGeoJSON(i,o,f){const _=this.extent*Math.pow(2,f),T=this.extent*i,S=this.extent*o,M=this.loadGeometry();function D(Y){return[360*(Y.x+T)/_-180,360/Math.PI*Math.atan(Math.exp((1-2*(Y.y+S)/_)*Math.PI))-90]}function L(Y){return Y.map(D)}let N;if(this.type===1){const Y=[];for(const W of M)Y.push(W[0]);const H=L(Y);N=Y.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const Y=M.map(L);N=Y.length===1?{type:"LineString",coordinates:Y[0]}:{type:"MultiLineString",coordinates:Y}}else{if(this.type!==3)throw new Error("unknown feature type");{const Y=function(W){const ae=W.length;if(ae<=1)return[W];const le=[];let pe,Ne;for(let ve=0;ve<ae;ve++){const Ce=Op(W[ve]);Ce!==0&&(Ne===void 0&&(Ne=Ce<0),Ne===Ce<0?(pe&&le.push(pe),pe=[W[ve]]):pe&&pe.push(W[ve]))}return pe&&le.push(pe),le}(M),H=[];for(const W of Y)H.push(W.map(L));N=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const V={type:"Feature",geometry:N,properties:this.properties};return this.id!=null&&(V.id=this.id),V}}function G0(s,i,o){s===1?i.id=o.readVarint():s===2?function(f,_){const T=f.readVarint()+f.pos;for(;f.pos<T;){const S=_._keys[f.readVarint()],M=_._values[f.readVarint()];_.properties[S]=M}}(o,i):s===3?i.type=o.readVarint():s===4&&(i._geometry=o.pos)}function Op(s){let i=0;for(let o,f,_=0,T=s.length,S=T-1;_<T;S=_++)o=s[_],f=s[S],i+=(f.x-o.x)*(o.y+f.y);return i}Kh.types=["Unknown","Point","LineString","Polygon"];class Cy{constructor(i,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Ym,this,o),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const o=this._pbf.readVarint()+this._pbf.pos;return new Kh(this._pbf,o,this.extent,this._keys,this._values)}}function Ym(s,i,o){s===15?i.version=o.readVarint():s===1?i.name=o.readString():s===5?i.extent=o.readVarint():s===2?i._features.push(o.pos):s===3?i._keys.push(o.readString()):s===4&&i._values.push(function(f){let _=null;const T=f.readVarint()+f.pos;for(;f.pos<T;){const S=f.readVarint()>>3;_=S===1?f.readString():S===2?f.readFloat():S===3?f.readDouble():S===4?f.readVarint64():S===5?f.readVarint():S===6?f.readSVarint():S===7?f.readBoolean():null}if(_==null)throw new Error("unknown feature value");return _}(o))}class Dy{constructor(i,o){this.layers=i.readFields(Xb,{},o)}}function Xb(s,i,o){if(s===3){const f=new Cy(o,o.readVarint()+o.pos);f.length&&(i[f.name]=f)}}const Iy=Math.pow(2,13);function ei(s,i,o,f,_,T,S,M){s.emplaceBack(i,o,2*Math.floor(f*Iy)+S,_*Iy*2,T*Iy*2,Math.round(M))}class Mi{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasDependencies=!1,this.layoutVertexArray=new qe,this.centroidVertexArray=new Re,this.indexArray=new ti,this.programConfigurations=new Ls(i.layers,i.zoom),this.segments=new In,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.features=[],this.hasDependencies=ju("fill-extrusion",this.layers,o);for(const{feature:_,id:T,index:S,sourceLayerIndex:M}of i){const D=this.layers[0]._featureFilter.needGeometry,L=Xo(_,D);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),L,f))continue;const N={id:T,sourceLayerIndex:M,index:S,geometry:D?L.geometry:zu(_),properties:_.properties,type:_.type,patterns:{}};this.hasDependencies?this.features.push(ac("fill-extrusion",this.layers,N,{zoom:this.zoom},o)):this.addFeature(N,N.geometry,S,f,{},o.subdivisionGranularity),o.featureIndex.insert(_,N.geometry,S,M,this.index,!0)}}addFeatures(i,o,f){for(const _ of this.features){const{geometry:T}=_;this.addFeature(_,T,_.index,o,f,i.subdivisionGranularity)}}update(i,o,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,pf),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,kp.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,o,f,_,T,S){for(const M of Sh(o,500)){const D={x:0,y:0,sampleCount:0},L=this.layoutVertexArray.length;this.processPolygon(D,_,i,M,S);const N=this.layoutVertexArray.length-L,V=Math.floor(D.x/D.sampleCount),Y=Math.floor(D.y/D.sampleCount);for(let H=0;H<N;H++)this.centroidVertexArray.emplaceBack(V,Y)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:T,canonical:_})}processPolygon(i,o,f,_,T){if(_.length<1||bi(_[0]))return;for(const V of _)V.length!==0&&Yn(i,V);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=T.fill.getGranularityForZoomLevel(o.z),D=Kh.types[f.type]==="Polygon";for(const V of _){if(V.length===0||bi(V))continue;const Y=Bu(V,M,D);this._generateSideFaces(Y,S)}if(!D)return;const L=io(_,o,M,!1),N=this.layoutVertexArray;Uu((V,Y)=>{ei(N,V,Y,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,L.verticesFlattened,L.indicesTriangles)}_generateSideFaces(i,o){let f=0;for(let _=1;_<i.length;_++){const T=i[_],S=i[_-1];if(Qn(T,S))continue;o.segment.vertexLength+4>In.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=T.sub(S)._perp()._unit(),D=S.dist(T);f+D>32768&&(f=0),ei(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,0,f),ei(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,1,f),f+=D,ei(this.layoutVertexArray,S.x,S.y,M.x,M.y,0,0,f),ei(this.layoutVertexArray,S.x,S.y,M.x,M.y,0,1,f);const L=o.segment.vertexLength;this.indexArray.emplaceBack(L,L+2,L+1),this.indexArray.emplaceBack(L+1,L+2,L+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function Yn(s,i){for(let o=0;o<i.length;o++){const f=i[o];o===i.length-1&&i[0].x===f.x&&i[0].y===f.y||(s.x+=f.x,s.y+=f.y,s.sampleCount++)}}function Qn(s,i){return s.x===i.x&&(s.x<0||s.x>ut)||s.y===i.y&&(s.y<0||s.y>ut)}function bi(s){return s.every(i=>i.x<0)||s.every(i=>i.x>ut)||s.every(i=>i.y<0)||s.every(i=>i.y>ut)}let So;Rt("FillExtrusionBucket",Mi,{omit:["layers","features"]});var Vu={get paint(){return So=So||new Si({"fill-extrusion-opacity":new Lt(Be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(Be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Lt(Be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Lt(Be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Yc(Be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(Be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(Be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Lt(Be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class mf extends qr{constructor(i,o){super(i,Vu,o)}createBucket(i){return new Mi(i)}queryRadius(){return Tp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:T,pixelsToTileUnits:S,pixelPosMatrix:M}){const D=Nu(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,S),L=this.paint.get("fill-extrusion-height").evaluate(o,f),N=this.paint.get("fill-extrusion-base").evaluate(o,f),V=function(H,W){const ae=[];for(const le of H){const pe=[le.x,le.y,0,1];Zt(pe,pe,W),ae.push(new E(pe[0]/pe[3],pe[1]/pe[3]))}return ae}(D,M),Y=function(H,W,ae,le){const pe=[],Ne=[],ve=le[8]*W,Ce=le[9]*W,Ze=le[10]*W,Ke=le[11]*W,ft=le[8]*ae,Dt=le[9]*ae,St=le[10]*ae,Mt=le[11]*ae;for(const $t of H){const At=[],Ct=[];for(const at of $t){const Qt=at.x,nn=at.y,Xt=le[0]*Qt+le[4]*nn+le[12],Bt=le[1]*Qt+le[5]*nn+le[13],An=le[2]*Qt+le[6]*nn+le[14],zi=le[3]*Qt+le[7]*nn+le[15],dr=An+Ze,ra=zi+Ke,oo=Xt+ft,Tr=Bt+Dt,qi=An+St,oi=zi+Mt,ar=new E((Xt+ve)/ra,(Bt+Ce)/ra);ar.z=dr/ra,At.push(ar);const fr=new E(oo/oi,Tr/oi);fr.z=qi/oi,Ct.push(fr)}pe.push(At),Ne.push(Ct)}return[pe,Ne]}(_,N,L,M);return function(H,W,ae){let le=1/0;zm(ae,W)&&(le=lc(ae,W[0]));for(let pe=0;pe<W.length;pe++){const Ne=W[pe],ve=H[pe];for(let Ce=0;Ce<Ne.length-1;Ce++){const Ze=Ne[Ce],Ke=[Ze,Ne[Ce+1],ve[Ce+1],ve[Ce],Ze];bp(ae,Ke)&&(le=Math.min(le,lc(ae,Ke)))}}return le!==1/0&&le}(Y[0],Y[1],V)}}function Jh(s,i){return s.x*i.x+s.y*i.y}function lc(s,i){if(s.length===1){let o=0;const f=i[o++];let _;for(;!_||f.equals(_);)if(_=i[o++],!_)return 1/0;for(;o<i.length;o++){const T=i[o],S=s[0],M=_.sub(f),D=T.sub(f),L=S.sub(f),N=Jh(M,M),V=Jh(M,D),Y=Jh(D,D),H=Jh(L,M),W=Jh(L,D),ae=N*Y-V*V,le=(Y*H-V*W)/ae,pe=(N*W-V*H)/ae,Ne=f.z*(1-le-pe)+_.z*le+T.z*pe;if(isFinite(Ne))return Ne}return 1/0}{let o=1/0;for(const f of i)o=Math.min(o,f.z);return o}}const wr=ui([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Gu}=wr,ed=ui([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ry}=ed,Qo=Math.cos(Math.PI/180*37.5),td=Math.pow(2,14)/.5;class nd{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new $e,this.layoutVertexArray2=new Ye,this.indexArray=new ti,this.programConfigurations=new Ls(i.layers,i.zoom),this.segments=new In,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,f){this.hasDependencies=ju("line",this.layers,o)||this.hasLineDasharray(this.layers);const _=this.layers[0].layout.get("line-sort-key"),T=!_.isConstant(),S=[];for(const{feature:M,id:D,index:L,sourceLayerIndex:N}of i){const V=this.layers[0]._featureFilter.needGeometry,Y=Xo(M,V);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),Y,f))continue;const H=T?_.evaluate(Y,{},f):void 0,W={id:D,properties:M.properties,type:M.type,sourceLayerIndex:N,index:L,geometry:V?Y.geometry:zu(M),patterns:{},dashes:{},sortKey:H};S.push(W)}T&&S.sort((M,D)=>M.sortKey-D.sortKey);for(const M of S){const{geometry:D,index:L,sourceLayerIndex:N}=M;this.hasDependencies?(ju("line",this.layers,o)?ac("line",this.layers,M,{zoom:this.zoom},o):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,M,this.zoom,o),this.patternFeatures.push(M)):this.addFeature(M,D,L,f,{},{},o.subdivisionGranularity),o.featureIndex.insert(i[L].feature,D,L,N,this.index)}}update(i,o,f,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,{imagePositions:f,dashPositions:_})}addFeatures(i,o,f,_){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,o,f,_,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Ry)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Gu),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,f,_,T,S,M){const D=this.layers[0].layout,L=D.get("line-join").evaluate(i,{}),N=D.get("line-cap"),V=D.get("line-miter-limit"),Y=D.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const H of o)this.addLine(H,i,L,N,V,Y,_,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:T,dashPositions:S,canonical:_})}addLine(i,o,f,_,T,S,M,D){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=Bu(i,M?D.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<i.length-1;ve++)this.totalDistance+=i[ve].dist(i[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=Kh.types[o.type]==="Polygon";let N=i.length;for(;N>=2&&i[N-1].equals(i[N-2]);)N--;let V=0;for(;V<N-1&&i[V].equals(i[V+1]);)V++;if(N<(L?3:2))return;f==="bevel"&&(T=1.05);const Y=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let W,ae,le,pe,Ne;this.e1=this.e2=-1,L&&(W=i[N-2],Ne=i[V].sub(W)._unit()._perp());for(let ve=V;ve<N;ve++){if(le=ve===N-1?L?i[V+1]:void 0:i[ve+1],le&&i[ve].equals(le))continue;Ne&&(pe=Ne),W&&(ae=W),W=i[ve],Ne=le?le.sub(W)._unit()._perp():pe,pe=pe||Ne;let Ce=pe.add(Ne);Ce.x===0&&Ce.y===0||Ce._unit();const Ze=pe.x*Ne.x+pe.y*Ne.y,Ke=Ce.x*Ne.x+Ce.y*Ne.y,ft=Ke!==0?1/Ke:1/0,Dt=2*Math.sqrt(2-2*Ke),St=Ke<Qo&&ae&&le,Mt=pe.x*Ne.y-pe.y*Ne.x>0;if(St&&ve>V){const Ct=W.dist(ae);if(Ct>2*Y){const at=W.sub(W.sub(ae)._mult(Y/Ct)._round());this.updateDistance(ae,at),this.addCurrentVertex(at,pe,0,0,H),ae=at}}const $t=ae&&le;let At=$t?f:L?"butt":_;if($t&&At==="round"&&(ft<S?At="miter":ft<=2&&(At="fakeround")),At==="miter"&&ft>T&&(At="bevel"),At==="bevel"&&(ft>2&&(At="flipbevel"),ft<T&&(At="miter")),ae&&this.updateDistance(ae,W),At==="miter")Ce._mult(ft),this.addCurrentVertex(W,Ce,0,0,H);else if(At==="flipbevel"){if(ft>100)Ce=Ne.mult(-1);else{const Ct=ft*pe.add(Ne).mag()/pe.sub(Ne).mag();Ce._perp()._mult(Ct*(Mt?-1:1))}this.addCurrentVertex(W,Ce,0,0,H),this.addCurrentVertex(W,Ce.mult(-1),0,0,H)}else if(At==="bevel"||At==="fakeround"){const Ct=-Math.sqrt(ft*ft-1),at=Mt?Ct:0,Qt=Mt?0:Ct;if(ae&&this.addCurrentVertex(W,pe,at,Qt,H),At==="fakeround"){const nn=Math.round(180*Dt/Math.PI/20);for(let Xt=1;Xt<nn;Xt++){let Bt=Xt/nn;if(Bt!==.5){const zi=Bt-.5;Bt+=Bt*zi*(Bt-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*zi*zi+(.848013+Ze*(.215638*Ze-1.06021)))}const An=Ne.sub(pe)._mult(Bt)._add(pe)._unit()._mult(Mt?-1:1);this.addHalfVertex(W,An.x,An.y,!1,Mt,0,H)}}le&&this.addCurrentVertex(W,Ne,-at,-Qt,H)}else if(At==="butt")this.addCurrentVertex(W,Ce,0,0,H);else if(At==="square"){const Ct=ae?1:-1;this.addCurrentVertex(W,Ce,Ct,Ct,H)}else At==="round"&&(ae&&(this.addCurrentVertex(W,pe,0,0,H),this.addCurrentVertex(W,pe,1,1,H,!0)),le&&(this.addCurrentVertex(W,Ne,-1,-1,H,!0),this.addCurrentVertex(W,Ne,0,0,H)));if(St&&ve<N-1){const Ct=W.dist(le);if(Ct>2*Y){const at=W.add(le.sub(W)._mult(Y/Ct)._round());this.updateDistance(W,at),this.addCurrentVertex(at,Ne,0,0,H),W=at}}}}addCurrentVertex(i,o,f,_,T,S=!1){const M=o.y*_-o.x,D=-o.y-o.x*_;this.addHalfVertex(i,o.x+o.y*f,o.y-o.x*f,S,!1,f,T),this.addHalfVertex(i,M,D,S,!0,-_,T),this.distance>td/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,o,f,_,T,S))}addHalfVertex({x:i,y:o},f,_,T,S,M,D){const L=.5*(this.lineClips?this.scaledDistance*(td-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(T?1:0),(o<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*_)+128,1+(M===0?0:M<0?-1:1)|(63&L)<<2,L>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,N,this.e2),D.primitiveLength++),S?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}hasLineDasharray(i){for(const o of i){const f=o.paint.get("line-dasharray");if(f&&!f.isConstant())return!0}return!1}addLineDashDependencies(i,o,f,_){for(const T of i){const S=T.paint.get("line-dasharray");if(!S||S.value.kind==="constant")continue;const M=T.layout.get("line-cap")==="round",D={dasharray:S.value.evaluate({zoom:f-1},o,{}),round:M},L={dasharray:S.value.evaluate({zoom:f},o,{}),round:M},N={dasharray:S.value.evaluate({zoom:f+1},o,{}),round:M},V=`${D.dasharray.join(",")},${D.round}`,Y=`${L.dasharray.join(",")},${L.round}`,H=`${N.dasharray.join(",")},${N.round}`;_.dashDependencies[V]=D,_.dashDependencies[Y]=L,_.dashDependencies[H]=N,o.dashes[T.id]={min:V,mid:Y,max:H}}}}let ro,Hm;Rt("LineBucket",nd,{omit:["layers","patternFeatures"]});var Pp={get paint(){return Hm=Hm||new Si({"line-opacity":new qt(Be.paint_line["line-opacity"]),"line-color":new qt(Be.paint_line["line-color"]),"line-translate":new Lt(Be.paint_line["line-translate"]),"line-translate-anchor":new Lt(Be.paint_line["line-translate-anchor"]),"line-width":new qt(Be.paint_line["line-width"]),"line-gap-width":new qt(Be.paint_line["line-gap-width"]),"line-offset":new qt(Be.paint_line["line-offset"]),"line-blur":new qt(Be.paint_line["line-blur"]),"line-dasharray":new Yc(Be.paint_line["line-dasharray"]),"line-pattern":new Yc(Be.paint_line["line-pattern"]),"line-gradient":new Ou(Be.paint_line["line-gradient"])})},get layout(){return ro=ro||new Si({"line-cap":new Lt(Be.layout_line["line-cap"]),"line-join":new qt(Be.layout_line["line-join"]),"line-miter-limit":new Lt(Be.layout_line["line-miter-limit"]),"line-round-limit":new Lt(Be.layout_line["line-round-limit"]),"line-sort-key":new qt(Be.layout_line["line-sort-key"])})}};class $0 extends qt{possiblyEvaluate(i,o){return o=new ci(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(i,o)}evaluate(i,o,f,_){return o=cn({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,f,_)}}let id;class qm extends qr{constructor(i,o){super(i,Pp,o),this.gradientVersion=0,id||(id=new $0(Pp.paint.properties["line-width"].specification),id.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof jl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,o){super.recalculate(i,o),this.paint._values["line-floorwidth"]=id.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new nd(i)}queryRadius(i){const o=i,f=tu(Xh("line-width",this,o),Xh("line-gap-width",this,o)),_=Xh("line-offset",this,o);return f/2+Math.abs(_)+Tp(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:o,featureState:f,geometry:_,transform:T,pixelsToTileUnits:S}){const M=Nu(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,S),D=S/2*tu(this.paint.get("line-width").evaluate(o,f),this.paint.get("line-gap-width").evaluate(o,f)),L=this.paint.get("line-offset").evaluate(o,f);return L&&(_=function(N,V){const Y=[];for(let H=0;H<N.length;H++){const W=N[H],ae=[];for(let le=0;le<W.length;le++){const pe=W[le-1],Ne=W[le],ve=W[le+1],Ce=le===0?new E(0,0):Ne.sub(pe)._unit()._perp(),Ze=le===W.length-1?new E(0,0):ve.sub(Ne)._unit()._perp(),Ke=Ce._add(Ze)._unit(),ft=Ke.x*Ze.x+Ke.y*Ze.y;ft!==0&&Ke._mult(1/ft),ae.push(Ke._mult(V)._add(Ne))}Y.push(ae)}return Y}(_,L*S)),function(N,V,Y){for(let H=0;H<V.length;H++){const W=V[H];if(N.length>=3){for(let ae=0;ae<W.length;ae++)if(qh(N,W[ae]))return!0}if(C0(N,W,Y))return!0}return!1}(M,_,D)}isTileClipped(){return!0}}function tu(s,i){return i>0?i+2*s:s}const ia=ui([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$u=ui([{name:"a_projected_pos",components:3,type:"Float32"}],4);ui([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gf=ui([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ui([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cc=ui([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ky=ui([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Oy(s,i,o){return s.sections.forEach(f=>{f.text=function(_,T,S){const M=T.layout.get("text-transform").evaluate(S,{});return M==="uppercase"?_=_.toLocaleUpperCase():M==="lowercase"&&(_=_.toLocaleLowerCase()),ks.applyArabicShaping&&(_=ks.applyArabicShaping(_)),_}(f.text,i,o)}),s}ui([{name:"triangle",components:3,type:"Uint16"}]),ui([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ui([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ui([{type:"Float32",name:"offsetX"}]),ui([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ui([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const yf={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var rr=24;const Lp=4294967296,Eo=1/Lp,Py=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class La{constructor(i=new Uint8Array(16)){this.buf=ArrayBuffer.isView(i)?i:new Uint8Array(i),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(i,o,f=this.length){for(;this.pos<f;){const _=this.readVarint(),T=_>>3,S=this.pos;this.type=7&_,i(T,o,this),this.pos===S&&this.skip(_)}return o}readMessage(i,o){return this.readFields(i,o,this.readVarint()+this.pos)}readFixed32(){const i=this.dataView.getUint32(this.pos,!0);return this.pos+=4,i}readSFixed32(){const i=this.dataView.getInt32(this.pos,!0);return this.pos+=4,i}readFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Lp;return this.pos+=8,i}readSFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Lp;return this.pos+=8,i}readFloat(){const i=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,i}readDouble(){const i=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,i}readVarint(i){const o=this.buf;let f,_;return _=o[this.pos++],f=127&_,_<128?f:(_=o[this.pos++],f|=(127&_)<<7,_<128?f:(_=o[this.pos++],f|=(127&_)<<14,_<128?f:(_=o[this.pos++],f|=(127&_)<<21,_<128?f:(_=o[this.pos],f|=(15&_)<<28,function(T,S,M){const D=M.buf;let L,N;if(N=D[M.pos++],L=(112&N)>>4,N<128||(N=D[M.pos++],L|=(127&N)<<3,N<128)||(N=D[M.pos++],L|=(127&N)<<10,N<128)||(N=D[M.pos++],L|=(127&N)<<17,N<128)||(N=D[M.pos++],L|=(127&N)<<24,N<128)||(N=D[M.pos++],L|=(1&N)<<31,N<128))return rd(T,L,S);throw new Error("Expected varint not more than 10 bytes")}(f,i,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const i=this.readVarint();return i%2==1?(i+1)/-2:i/2}readBoolean(){return!!this.readVarint()}readString(){const i=this.readVarint()+this.pos,o=this.pos;return this.pos=i,i-o>=12&&Py?Py.decode(this.buf.subarray(o,i)):function(f,_,T){let S="",M=_;for(;M<T;){const D=f[M];let L,N,V,Y=null,H=D>239?4:D>223?3:D>191?2:1;if(M+H>T)break;H===1?D<128&&(Y=D):H===2?(L=f[M+1],(192&L)==128&&(Y=(31&D)<<6|63&L,Y<=127&&(Y=null))):H===3?(L=f[M+1],N=f[M+2],(192&L)==128&&(192&N)==128&&(Y=(15&D)<<12|(63&L)<<6|63&N,(Y<=2047||Y>=55296&&Y<=57343)&&(Y=null))):H===4&&(L=f[M+1],N=f[M+2],V=f[M+3],(192&L)==128&&(192&N)==128&&(192&V)==128&&(Y=(15&D)<<18|(63&L)<<12|(63&N)<<6|63&V,(Y<=65535||Y>=1114112)&&(Y=null))),Y===null?(Y=65533,H=1):Y>65535&&(Y-=65536,S+=String.fromCharCode(Y>>>10&1023|55296),Y=56320|1023&Y),S+=String.fromCharCode(Y),M+=H}return S}(this.buf,o,i)}readBytes(){const i=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,i);return this.pos=i,o}readPackedVarint(i=[],o){const f=this.readPackedEnd();for(;this.pos<f;)i.push(this.readVarint(o));return i}readPackedSVarint(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readSVarint());return i}readPackedBoolean(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readBoolean());return i}readPackedFloat(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readFloat());return i}readPackedDouble(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readDouble());return i}readPackedFixed32(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readFixed32());return i}readPackedSFixed32(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readSFixed32());return i}readPackedFixed64(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readFixed64());return i}readPackedSFixed64(i=[]){const o=this.readPackedEnd();for(;this.pos<o;)i.push(this.readSFixed64());return i}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(i){const o=7&i;if(o===0)for(;this.buf[this.pos++]>127;);else if(o===2)this.pos=this.readVarint()+this.pos;else if(o===5)this.pos+=4;else{if(o!==1)throw new Error(`Unimplemented type: ${o}`);this.pos+=8}}writeTag(i,o){this.writeVarint(i<<3|o)}realloc(i){let o=this.length||16;for(;o<this.pos+i;)o*=2;if(o!==this.length){const f=new Uint8Array(o);f.set(this.buf),this.buf=f,this.dataView=new DataView(f.buffer),this.length=o}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeSFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*Eo),!0),this.pos+=8}writeSFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*Eo),!0),this.pos+=8}writeVarint(i){(i=+i||0)>268435455||i<0?function(o,f){let _,T;if(o>=0?(_=o%4294967296|0,T=o/4294967296|0):(_=~(-o%4294967296),T=~(-o/4294967296),4294967295^_?_=_+1|0:(_=0,T=T+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(S,M,D){D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,D.buf[D.pos]=127&(S>>>=7)}(_,0,f),function(S,M){const D=(7&S)<<4;M.buf[M.pos++]|=D|((S>>>=3)?128:0),S&&(M.buf[M.pos++]=127&S|((S>>>=7)?128:0),S&&(M.buf[M.pos++]=127&S|((S>>>=7)?128:0),S&&(M.buf[M.pos++]=127&S|((S>>>=7)?128:0),S&&(M.buf[M.pos++]=127&S|((S>>>=7)?128:0),S&&(M.buf[M.pos++]=127&S)))))}(T,f)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))}writeSVarint(i){this.writeVarint(i<0?2*-i-1:2*i)}writeBoolean(i){this.writeVarint(+i)}writeString(i){i=String(i),this.realloc(4*i.length),this.pos++;const o=this.pos;this.pos=function(_,T,S){for(let M,D,L=0;L<T.length;L++){if(M=T.charCodeAt(L),M>55295&&M<57344){if(!D){M>56319||L+1===T.length?(_[S++]=239,_[S++]=191,_[S++]=189):D=M;continue}if(M<56320){_[S++]=239,_[S++]=191,_[S++]=189,D=M;continue}M=D-55296<<10|M-56320|65536,D=null}else D&&(_[S++]=239,_[S++]=191,_[S++]=189,D=null);M<128?_[S++]=M:(M<2048?_[S++]=M>>6|192:(M<65536?_[S++]=M>>12|224:(_[S++]=M>>18|240,_[S++]=M>>12&63|128),_[S++]=M>>6&63|128),_[S++]=63&M|128)}return S}(this.buf,i,this.pos);const f=this.pos-o;f>=128&&Ly(o,f,this),this.pos=o-1,this.writeVarint(f),this.pos+=f}writeFloat(i){this.realloc(4),this.dataView.setFloat32(this.pos,i,!0),this.pos+=4}writeDouble(i){this.realloc(8),this.dataView.setFloat64(this.pos,i,!0),this.pos+=8}writeBytes(i){const o=i.length;this.writeVarint(o),this.realloc(o);for(let f=0;f<o;f++)this.buf[this.pos++]=i[f]}writeRawMessage(i,o){this.pos++;const f=this.pos;i(o,this);const _=this.pos-f;_>=128&&Ly(f,_,this),this.pos=f-1,this.writeVarint(_),this.pos+=_}writeMessage(i,o,f){this.writeTag(i,2),this.writeRawMessage(o,f)}writePackedVarint(i,o){o.length&&this.writeMessage(i,Wb,o)}writePackedSVarint(i,o){o.length&&this.writeMessage(i,Zu,o)}writePackedBoolean(i,o){o.length&&this.writeMessage(i,_f,o)}writePackedFloat(i,o){o.length&&this.writeMessage(i,Xm,o)}writePackedDouble(i,o){o.length&&this.writeMessage(i,zy,o)}writePackedFixed32(i,o){o.length&&this.writeMessage(i,Z0,o)}writePackedSFixed32(i,o){o.length&&this.writeMessage(i,Y0,o)}writePackedFixed64(i,o){o.length&&this.writeMessage(i,H0,o)}writePackedSFixed64(i,o){o.length&&this.writeMessage(i,q0,o)}writeBytesField(i,o){this.writeTag(i,2),this.writeBytes(o)}writeFixed32Field(i,o){this.writeTag(i,5),this.writeFixed32(o)}writeSFixed32Field(i,o){this.writeTag(i,5),this.writeSFixed32(o)}writeFixed64Field(i,o){this.writeTag(i,1),this.writeFixed64(o)}writeSFixed64Field(i,o){this.writeTag(i,1),this.writeSFixed64(o)}writeVarintField(i,o){this.writeTag(i,0),this.writeVarint(o)}writeSVarintField(i,o){this.writeTag(i,0),this.writeSVarint(o)}writeStringField(i,o){this.writeTag(i,2),this.writeString(o)}writeFloatField(i,o){this.writeTag(i,5),this.writeFloat(o)}writeDoubleField(i,o){this.writeTag(i,1),this.writeDouble(o)}writeBooleanField(i,o){this.writeVarintField(i,+o)}}function rd(s,i,o){return o?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}function Ly(s,i,o){const f=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));o.realloc(f);for(let _=o.pos-1;_>=s;_--)o.buf[_+f]=o.buf[_]}function Wb(s,i){for(let o=0;o<s.length;o++)i.writeVarint(s[o])}function Zu(s,i){for(let o=0;o<s.length;o++)i.writeSVarint(s[o])}function Xm(s,i){for(let o=0;o<s.length;o++)i.writeFloat(s[o])}function zy(s,i){for(let o=0;o<s.length;o++)i.writeDouble(s[o])}function _f(s,i){for(let o=0;o<s.length;o++)i.writeBoolean(s[o])}function Z0(s,i){for(let o=0;o<s.length;o++)i.writeFixed32(s[o])}function Y0(s,i){for(let o=0;o<s.length;o++)i.writeSFixed32(s[o])}function H0(s,i){for(let o=0;o<s.length;o++)i.writeFixed64(s[o])}function q0(s,i){for(let o=0;o<s.length;o++)i.writeSFixed64(s[o])}function Wm(s,i,o){s===1&&o.readMessage(Ny,i)}function Ny(s,i,o){if(s===3){const{id:f,bitmap:_,width:T,height:S,left:M,top:D,advance:L}=o.readMessage(Qb,{});i.push({id:f,bitmap:new sf({width:T+6,height:S+6},_),metrics:{width:T,height:S,left:M,top:D,advance:L}})}}function Qb(s,i,o){s===1?i.id=o.readVarint():s===2?i.bitmap=o.readBytes():s===3?i.width=o.readVarint():s===4?i.height=o.readVarint():s===5?i.left=o.readSVarint():s===6?i.top=o.readSVarint():s===7&&(i.advance=o.readVarint())}function X0(s){let i=0,o=0;for(const S of s)i+=S.w*S.h,o=Math.max(o,S.w);s.sort((S,M)=>M.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let _=0,T=0;for(const S of s)for(let M=f.length-1;M>=0;M--){const D=f[M];if(!(S.w>D.w||S.h>D.h)){if(S.x=D.x,S.y=D.y,T=Math.max(T,S.y+S.h),_=Math.max(_,S.x+S.w),S.w===D.w&&S.h===D.h){const L=f.pop();L&&M<f.length&&(f[M]=L)}else S.h===D.h?(D.x+=S.w,D.w-=S.w):S.w===D.w?(D.y+=S.h,D.h-=S.h):(f.push({x:D.x+S.w,y:D.y,w:D.w-S.w,h:S.h}),D.y+=S.h,D.h-=S.h);break}}return{w:_,h:T,fill:i/(_*T)||0}}class jy{constructor(i,{pixelRatio:o,version:f,stretchX:_,stretchY:T,content:S,textFitWidth:M,textFitHeight:D}){this.paddedRect=i,this.pixelRatio=o,this.stretchX=_,this.stretchY=T,this.content=S,this.version=f,this.textFitWidth=M,this.textFitHeight=D}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Fy{constructor(i,o){const f={},_={};this.haveRenderCallbacks=[];const T=[];this.addImages(i,f,T),this.addImages(o,_,T);const{w:S,h:M}=X0(T),D=new Ta({width:S||1,height:M||1});for(const L in i){const N=i[L],V=f[L].paddedRect;Ta.copy(N.data,D,{x:0,y:0},{x:V.x+1,y:V.y+1},N.data)}for(const L in o){const N=o[L],V=_[L].paddedRect,Y=V.x+1,H=V.y+1,W=N.data.width,ae=N.data.height;Ta.copy(N.data,D,{x:0,y:0},{x:Y,y:H},N.data),Ta.copy(N.data,D,{x:0,y:ae-1},{x:Y,y:H-1},{width:W,height:1}),Ta.copy(N.data,D,{x:0,y:0},{x:Y,y:H+ae},{width:W,height:1}),Ta.copy(N.data,D,{x:W-1,y:0},{x:Y-1,y:H},{width:1,height:ae}),Ta.copy(N.data,D,{x:0,y:0},{x:Y+W,y:H},{width:1,height:ae})}this.image=D,this.iconPositions=f,this.patternPositions=_}addImages(i,o,f){for(const _ in i){const T=i[_],S={x:0,y:0,w:T.data.width+2,h:T.data.height+2};f.push(S),o[_]=new jy(S,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(i,o){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in i.updatedImages)this.patchUpdatedImage(this.iconPositions[f],i.getImage(f),o),this.patchUpdatedImage(this.patternPositions[f],i.getImage(f),o)}patchUpdatedImage(i,o,f){if(!i||!o||i.version===o.version)return;i.version=o.version;const[_,T]=i.tl;f.update(o.data,void 0,{x:_,y:T})}}var nu;Rt("ImagePosition",jy),Rt("ImageAtlas",Fy),y.ao=void 0,(nu=y.ao||(y.ao={}))[nu.none=0]="none",nu[nu.horizontal=1]="horizontal",nu[nu.vertical=2]="vertical",nu[nu.horizontalOnly=3]="horizontalOnly";class uc{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(i,o,f){const _=new uc;return _.scale=i||1,_.fontStack=o,_.verticalAlign=f||"bottom",_}static forImage(i,o){const f=new uc;return f.imageName=i,f.verticalAlign=o||"bottom",f}}class iu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const f=new iu;for(let _=0;_<i.sections.length;_++){const T=i.sections[_];T.image?f.addImageSection(T):f.addTextSection(T,o)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let o="";for(let f=0;f<i.length;f++){const _=i.charCodeAt(f+1)||null,T=i.charCodeAt(f-1)||null;o+=_&&Uh(_)&&!yf[i[f+1]]||T&&Uh(T)&&!yf[i[f-1]]||!yf[i[f]]?i[f]:yf[i[f]]}return o}(this.text)}trim(){let i=0;for(let f=0;f<this.text.length&&Np[this.text.charCodeAt(f)];f++)i++;let o=this.text.length;for(let f=this.text.length-1;f>=0&&f>=i&&Np[this.text.charCodeAt(f)];f--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const f=new iu;return f.text=this.text.substring(i,o),f.sectionIndex=this.sectionIndex.slice(i,o),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}getMaxImageSize(i){let o=0,f=0;for(let _=0;_<this.length();_++){const T=this.getSection(_);if(T.imageName){const S=i[T.imageName];if(!S)continue;const M=S.displaySize;o=Math.max(o,M[0]),f=Math.max(f,M[1])}}return{maxImageWidth:o,maxImageHeight:f}}addTextSection(i,o){this.text+=i.text,this.sections.push(uc.forText(i.scale,i.fontStack||o,i.verticalAlign));const f=this.sections.length-1;for(let _=0;_<i.text.length;++_)this.sectionIndex.push(f)}addImageSection(i){const o=i.image?i.image.name:"";if(o.length===0)return void Ln("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(uc.forImage(o,i.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Ln("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function zp(s,i,o,f,_,T,S,M,D,L,N,V,Y,H,W){const ae=iu.fromFeature(s,_);let le;V===y.ao.vertical&&ae.verticalizePunctuation();const{processBidirectionalText:pe,processStyledBidirectionalText:Ne}=ks;if(pe&&ae.sections.length===1){le=[];const Ze=pe(ae.toString(),mi(ae,L,T,i,f,H));for(const Ke of Ze){const ft=new iu;ft.text=Ke,ft.sections=ae.sections;for(let Dt=0;Dt<Ke.length;Dt++)ft.sectionIndex.push(0);le.push(ft)}}else if(Ne){le=[];const Ze=Ne(ae.text,ae.sectionIndex,mi(ae,L,T,i,f,H));for(const Ke of Ze){const ft=new iu;ft.text=Ke[0],ft.sectionIndex=Ke[1],ft.sections=ae.sections,le.push(ft)}}else le=function(Ze,Ke){const ft=[],Dt=Ze.text;let St=0;for(const Mt of Ke)ft.push(Ze.substring(St,Mt)),St=Mt;return St<Dt.length&&ft.push(Ze.substring(St,Dt.length)),ft}(ae,mi(ae,L,T,i,f,H));const ve=[],Ce={positionedLines:ve,text:ae.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:V,iconsInText:!1,verticalizable:!1};return function(Ze,Ke,ft,Dt,St,Mt,$t,At,Ct,at,Qt,nn){let Xt=0,Bt=0,An=0,zi=0;const dr=At==="right"?1:At==="left"?0:.5,ra=rr/nn;let oo=0;for(const oi of St){oi.trim();const ar=oi.getMaxScale(),fr={positionedGlyphs:[],lineOffset:0};Ze.positionedLines[oo]=fr;const Xi=fr.positionedGlyphs;let za=0;if(!oi.length()){Bt+=Mt,++oo;continue}const Mo=Kb(Dt,oi,ra);for(let so=0;so<oi.length();so++){const Sr=oi.getSection(so),pr=oi.getSectionIndex(so),Lr=oi.getCharCode(so),Er=Jb(Ct,Qt,Lr);let gi;if(Sr.imageName){if(Ze.iconsInText=!0,Sr.scale=Sr.scale*ra,gi=tx(Sr,Er,ar,Mo,Dt),!gi)continue;za=Math.max(za,gi.imageOffset)}else if(gi=ex(Sr,Lr,Er,Mo,Ke,ft),!gi)continue;const{rect:Co,metrics:sd,baselineOffset:Na}=gi;Xi.push({glyph:Lr,imageName:Sr.imageName,x:Xt,y:Bt+Na+-17,vertical:Er,scale:Sr.scale,fontStack:Sr.fontStack,sectionIndex:pr,metrics:sd,rect:Co}),Er?(Ze.verticalizable=!0,Xt+=(Sr.imageName?sd.advance:rr)*Sr.scale+at):Xt+=sd.advance*Sr.scale+at}Xi.length!==0&&(An=Math.max(Xt-at,An),Km(Xi,0,Xi.length-1,dr)),Xt=0,fr.lineOffset=Math.max(za,(ar-1)*rr);const or=Mt*ar+za;Bt+=or,zi=Math.max(or,zi),++oo}const{horizontalAlign:Tr,verticalAlign:qi}=jp($t);(function(oi,ar,fr,Xi,za,Mo,or,so,Sr){const pr=(ar-fr)*za;let Lr=0;Lr=Mo!==or?-so*Xi- -17:-Xi*Sr*or+.5*or;for(const Er of oi)for(const gi of Er.positionedGlyphs)gi.x+=pr,gi.y+=Lr})(Ze.positionedLines,dr,Tr,qi,An,zi,Mt,Bt,St.length),Ze.top+=-qi*Bt,Ze.bottom=Ze.top+Bt,Ze.left+=-Tr*An,Ze.right=Ze.left+An}(Ce,i,o,f,le,S,M,D,V,L,Y,W),!function(Ze){for(const Ke of Ze)if(Ke.positionedGlyphs.length!==0)return!1;return!0}(ve)&&Ce}const Np={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},W0={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Q0={40:!0};function By(s,i,o,f,_,T){if(i.imageName){const S=f[i.imageName];return S?S.displaySize[0]*i.scale*rr/T+_:0}{const S=o[i.fontStack],M=S&&S[s];return M?M.metrics.advance*i.scale+_:0}}function Uy(s,i,o,f){const _=Math.pow(s-i,2);return f?s<i?_/2:2*_:_+Math.abs(o)*o}function Qm(s,i,o){let f=0;return s===10&&(f-=1e4),o&&(f+=150),s!==40&&s!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function Vy(s,i,o,f,_,T){let S=null,M=Uy(i,o,_,T);for(const D of f){const L=Uy(i-D.x,o,_,T)+D.badness;L<=M&&(S=D,M=L)}return{index:s,x:i,priorBreak:S,badness:M}}function Gy(s){return s?Gy(s.priorBreak).concat(s.index):[]}function mi(s,i,o,f,_,T){if(!s)return[];const S=[],M=function(V,Y,H,W,ae,le){let pe=0;for(let Ne=0;Ne<V.length();Ne++){const ve=V.getSection(Ne);pe+=By(V.getCharCode(Ne),ve,W,ae,Y,le)}return pe/Math.max(1,Math.ceil(pe/H))}(s,i,o,f,_,T),D=s.text.indexOf("​")>=0;let L=0;for(let V=0;V<s.length();V++){const Y=s.getSection(V),H=s.getCharCode(V);if(Np[H]||(L+=By(H,Y,f,_,i,T)),V<s.length()-1){const W=!((N=H)<11904)&&(!!yn["CJK Compatibility Forms"](N)||!!yn["CJK Compatibility"](N)||!!yn["CJK Strokes"](N)||!!yn["CJK Symbols and Punctuation"](N)||!!yn["Enclosed CJK Letters and Months"](N)||!!yn["Halfwidth and Fullwidth Forms"](N)||!!yn["Ideographic Description Characters"](N)||!!yn["Vertical Forms"](N)||Bh.test(String.fromCodePoint(N)));(W0[H]||W||Y.imageName||V!==s.length()-2&&Q0[s.getCharCode(V+1)])&&S.push(Vy(V+1,L,M,S,Qm(H,s.getCharCode(V+1),W&&D),!1))}}var N;return Gy(Vy(s.length(),L,M,S,0,!0))}function jp(s){let i=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function Kb(s,i,o){const f=i.getMaxScale()*rr,{maxImageWidth:_,maxImageHeight:T}=i.getMaxImageSize(s),S=Math.max(f,T*o);return{verticalLineContentWidth:Math.max(f,_*o),horizontalLineContentHeight:S}}function $y(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function Jb(s,i,o){return!(s===y.ao.horizontal||!i&&!Jl(o)||i&&(Np[o]||(f=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function ex(s,i,o,f,_,T){const S=T[s.fontStack],M=function(L,N,V,Y){if(L&&L.rect)return L;const H=N[V.fontStack],W=H&&H[Y];return W?{rect:null,metrics:W.metrics}:null}(S&&S[i],_,s,i);if(M===null)return null;let D;if(o)D=f.verticalLineContentWidth-s.scale*rr;else{const L=$y(s.verticalAlign);D=(f.horizontalLineContentHeight-s.scale*rr)*L}return{rect:M.rect,metrics:M.metrics,baselineOffset:D}}function tx(s,i,o,f,_){const T=_[s.imageName];if(!T)return null;const S=T.paddedRect,M=T.displaySize,D={width:M[0],height:M[1],left:1,top:-3,advance:i?M[1]:M[0]};let L;if(i)L=f.verticalLineContentWidth-M[1]*s.scale;else{const N=$y(s.verticalAlign);L=(f.horizontalLineContentHeight-M[1]*s.scale)*N}return{rect:S,metrics:D,baselineOffset:L,imageOffset:(i?M[0]:M[1])*s.scale-rr*o}}function Km(s,i,o,f){if(f===0)return;const _=s[o],T=(s[o].x+_.metrics.advance*_.scale)*f;for(let S=i;S<=o;S++)s[S].x-=T}function vf(s,i,o){const{horizontalAlign:f,verticalAlign:_}=jp(o),T=i[0]-s.displaySize[0]*f,S=i[1]-s.displaySize[1]*_;return{image:s,top:S,bottom:S+s.displaySize[1],left:T,right:T+s.displaySize[0]}}function Jm(s){var i,o;let f=s.left,_=s.top,T=s.right-f,S=s.bottom-_;const M=(i=s.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",D=(o=s.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",L=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(D==="proportional"){if(M==="stretchOnly"&&T/S<L||M==="proportional"){const N=Math.ceil(S*L);f*=N/T,T=N}}else if(M==="proportional"&&D==="stretchOnly"&&L!==0&&T/S>L){const N=Math.ceil(T/L);_*=N/S,S=N}return{x1:f,y1:_,x2:f+T,y2:_+S}}function Fp(s,i,o,f,_,T){const S=s.image;let M;if(S.content){const le=S.content,pe=S.pixelRatio||1;M=[le[0]/pe,le[1]/pe,S.displaySize[0]-le[2]/pe,S.displaySize[1]-le[3]/pe]}const D=i.left*T,L=i.right*T;let N,V,Y,H;o==="width"||o==="both"?(H=_[0]+D-f[3],V=_[0]+L+f[1]):(H=_[0]+(D+L-S.displaySize[0])/2,V=H+S.displaySize[0]);const W=i.top*T,ae=i.bottom*T;return o==="height"||o==="both"?(N=_[1]+W-f[0],Y=_[1]+ae+f[2]):(N=_[1]+(W+ae-S.displaySize[1])/2,Y=N+S.displaySize[1]),{image:S,top:N,right:V,bottom:Y,left:H,collisionPadding:M}}const _l=128,ao=32640;function vl(s,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new ci(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:_}=o;let T=0;for(;T<f.length&&f[T]<=s;)T++;T=Math.max(0,T-1);let S=T;for(;S<f.length&&f[S]<s+1;)S++;S=Math.min(f.length-1,S);const M=f[T],D=f[S];return o.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:D,interpolationType:_}:{kind:"camera",minZoom:M,maxZoom:D,minSize:o.evaluate(new ci(M)),maxSize:o.evaluate(new ci(D)),interpolationType:_}}}function ad(s,i,o){let f="never";const _=s.get(i);return _?f=_:s.get(o)&&(f="always"),f}const nx=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bp(s,i,o,f,_,T,S,M,D,L,N,V,Y){const H=M?Math.min(ao,Math.round(M[0])):0,W=M?Math.min(ao,Math.round(M[1])):0;s.emplaceBack(i,o,Math.round(32*f),Math.round(32*_),T,S,(H<<1)+(D?1:0),W,16*L,16*N,256*V,256*Y)}function eg(s,i,o){s.emplaceBack(i.x,i.y,o),s.emplaceBack(i.x,i.y,o),s.emplaceBack(i.x,i.y,o),s.emplaceBack(i.x,i.y,o)}function K0(s){for(const i of s.sections)if(cl(i.text))return!0;return!1}class tg{constructor(i){this.layoutVertexArray=new wt,this.indexArray=new ti,this.programConfigurations=i,this.segments=new In,this.dynamicLayoutVertexArray=new ct,this.opacityVertexArray=new Ft,this.hasVisibleVertices=!1,this.placedSymbolArray=new q}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,o,f,_){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ia.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,$u.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,nx,!0),this.opacityVertexBuffer.itemSize=1),(f||_)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Rt("SymbolBuffers",tg);class Zy{constructor(i,o,f){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new f,this.segments=new In,this.collisionVertexArray=new Vn}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,gf.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Rt("CollisionBuffers",Zy);class Yu{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=po(globalThis)?Math.min(i.overscaling,128):i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(S=>S.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=vl(this.zoom,o["text-size"]),this.iconSizeData=vl(this.zoom,o["icon-size"]);const f=this.layers[0].layout,_=f.get("symbol-sort-key"),T=f.get("symbol-z-order");this.canOverlap=ad(f,"text-overlap","text-allow-overlap")!=="never"||ad(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(S=>y.ao[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=i.sourceID}createArrays(){this.text=new tg(new Ls(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new tg(new Ls(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new de,this.lineVertexArray=new fe,this.symbolInstances=new he,this.textAnchorOffsets=new ye}calculateGlyphDependencies(i,o,f,_,T){for(let S=0;S<i.length;S++)if(o[i.charCodeAt(S)]=!0,(f||_)&&T){const M=yf[i.charAt(S)];M&&(o[M.charCodeAt(0)]=!0)}}populate(i,o,f){const _=this.layers[0],T=_.layout,S=T.get("text-font"),M=T.get("text-field"),D=T.get("icon-image"),L=(M.value.kind!=="constant"||M.value.value instanceof Cr&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),N=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,V=T.get("symbol-sort-key");if(this.features=[],!L&&!N)return;const Y=o.iconDependencies,H=o.glyphDependencies,W=o.availableImages,ae=new ci(this.zoom);for(const{feature:le,id:pe,index:Ne,sourceLayerIndex:ve}of i){const Ce=_._featureFilter.needGeometry,Ze=Xo(le,Ce);if(!_._featureFilter.filter(ae,Ze,f))continue;let Ke,ft;if(Ce||(Ze.geometry=zu(le)),L){const St=_.getValueAndResolveTokens("text-field",Ze,f,W),Mt=Cr.factory(St),$t=this.hasRTLText=this.hasRTLText||K0(Mt);(!$t||ks.getRTLTextPluginStatus()==="unavailable"||$t&&ks.isParsed())&&(Ke=Oy(Mt,_,Ze))}if(N){const St=_.getValueAndResolveTokens("icon-image",Ze,f,W);ft=St instanceof _a?St:_a.fromString(St)}if(!Ke&&!ft)continue;const Dt=this.sortFeaturesByKey?V.evaluate(Ze,{},f):void 0;if(this.features.push({id:pe,text:Ke,icon:ft,index:Ne,sourceLayerIndex:ve,geometry:Ze.geometry,properties:le.properties,type:Kh.types[le.type],sortKey:Dt}),ft&&(Y[ft.name]=!0),Ke){const St=S.evaluate(Ze,{},f).join(","),Mt=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ao.vertical)>=0;for(const $t of Ke.sections)if($t.image)Y[$t.image.name]=!0;else{const At=Rs(Ke.toString()),Ct=$t.fontStack||St,at=H[Ct]=H[Ct]||{};this.calculateGlyphDependencies($t.text,at,Mt,this.allowVerticalPlacement,At)}}}T.get("symbol-placement")==="line"&&(this.features=function(le){const pe={},Ne={},ve=[];let Ce=0;function Ze(St){ve.push(le[St]),Ce++}function Ke(St,Mt,$t){const At=Ne[St];return delete Ne[St],Ne[Mt]=At,ve[At].geometry[0].pop(),ve[At].geometry[0]=ve[At].geometry[0].concat($t[0]),At}function ft(St,Mt,$t){const At=pe[Mt];return delete pe[Mt],pe[St]=At,ve[At].geometry[0].shift(),ve[At].geometry[0]=$t[0].concat(ve[At].geometry[0]),At}function Dt(St,Mt,$t){const At=$t?Mt[0][Mt[0].length-1]:Mt[0][0];return`${St}:${At.x}:${At.y}`}for(let St=0;St<le.length;St++){const Mt=le[St],$t=Mt.geometry,At=Mt.text?Mt.text.toString():null;if(!At){Ze(St);continue}const Ct=Dt(At,$t),at=Dt(At,$t,!0);if(Ct in Ne&&at in pe&&Ne[Ct]!==pe[at]){const Qt=ft(Ct,at,$t),nn=Ke(Ct,at,ve[Qt].geometry);delete pe[Ct],delete Ne[at],Ne[Dt(At,ve[nn].geometry,!0)]=nn,ve[Qt].geometry=null}else Ct in Ne?Ke(Ct,at,$t):at in pe?ft(Ct,at,$t):(Ze(St),pe[Ct]=Ce-1,Ne[at]=Ce-1)}return ve.filter(St=>St.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,pe)=>le.sortKey-pe.sortKey)}update(i,o,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,o,this.layers,{imagePositions:f}),this.icon.programConfigurations.updatePaintArrays(i,o,this.layers,{imagePositions:f}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const f=this.lineVertexArray.length;if(i.segment!==void 0){let _=i.dist(o[i.segment+1]),T=i.dist(o[i.segment]);const S={};for(let M=i.segment+1;M<o.length;M++)S[M]={x:o[M].x,y:o[M].y,tileUnitDistanceFromAnchor:_},M<o.length-1&&(_+=o[M+1].dist(o[M]));for(let M=i.segment||0;M>=0;M--)S[M]={x:o[M].x,y:o[M].y,tileUnitDistanceFromAnchor:T},M>0&&(T+=o[M-1].dist(o[M]));for(let M=0;M<o.length;M++){const D=S[M];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,o,f,_,T,S,M,D,L,N,V,Y){const H=i.indexArray,W=i.layoutVertexArray,ae=i.segments.prepareSegment(4*o.length,W,H,this.canOverlap?S.sortKey:void 0),le=this.glyphOffsetArray.length,pe=ae.vertexLength,Ne=this.allowVerticalPlacement&&M===y.ao.vertical?Math.PI/2:0,ve=S.text&&S.text.sections;for(let Ce=0;Ce<o.length;Ce++){const{tl:Ze,tr:Ke,bl:ft,br:Dt,tex:St,pixelOffsetTL:Mt,pixelOffsetBR:$t,minFontScaleX:At,minFontScaleY:Ct,glyphOffset:at,isSDF:Qt,sectionIndex:nn}=o[Ce],Xt=ae.vertexLength,Bt=at[1];Bp(W,D.x,D.y,Ze.x,Bt+Ze.y,St.x,St.y,f,Qt,Mt.x,Mt.y,At,Ct),Bp(W,D.x,D.y,Ke.x,Bt+Ke.y,St.x+St.w,St.y,f,Qt,$t.x,Mt.y,At,Ct),Bp(W,D.x,D.y,ft.x,Bt+ft.y,St.x,St.y+St.h,f,Qt,Mt.x,$t.y,At,Ct),Bp(W,D.x,D.y,Dt.x,Bt+Dt.y,St.x+St.w,St.y+St.h,f,Qt,$t.x,$t.y,At,Ct),eg(i.dynamicLayoutVertexArray,D,Ne),H.emplaceBack(Xt,Xt+2,Xt+1),H.emplaceBack(Xt+1,Xt+2,Xt+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(at[0]),Ce!==o.length-1&&nn===o[Ce+1].sectionIndex||i.programConfigurations.populatePaintArrays(W.length,S,S.index,{imagePositions:{},canonical:Y,formattedSection:ve&&ve[nn]})}i.placedSymbolArray.emplaceBack(D.x,D.y,le,this.glyphOffsetArray.length-le,pe,L,N,D.segment,f?f[0]:0,f?f[1]:0,_[0],_[1],M,0,!1,0,V)}_addCollisionDebugVertex(i,o,f,_,T,S){return o.emplaceBack(0,0),i.emplaceBack(f.x,f.y,_,T,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(i,o,f,_,T,S,M){const D=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),L=D.vertexLength,N=T.layoutVertexArray,V=T.collisionVertexArray,Y=M.anchorX,H=M.anchorY;this._addCollisionDebugVertex(N,V,S,Y,H,new E(i,o)),this._addCollisionDebugVertex(N,V,S,Y,H,new E(f,o)),this._addCollisionDebugVertex(N,V,S,Y,H,new E(f,_)),this._addCollisionDebugVertex(N,V,S,Y,H,new E(i,_)),D.vertexLength+=4;const W=T.indexArray;W.emplaceBack(L,L+1),W.emplaceBack(L+1,L+2),W.emplaceBack(L+2,L+3),W.emplaceBack(L+3,L),D.primitiveLength+=4}addDebugCollisionBoxes(i,o,f,_){for(let T=i;T<o;T++){const S=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,_?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Zy(on,cc.members,ni),this.iconCollisionBox=new Zy(on,cc.members,ni);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(i,o,f,_,T,S,M,D,L){const N={};for(let V=o;V<f;V++){const Y=i.get(V);N.textBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},N.textFeatureIndex=Y.featureIndex;break}for(let V=_;V<T;V++){const Y=i.get(V);N.verticalTextBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},N.verticalTextFeatureIndex=Y.featureIndex;break}for(let V=S;V<M;V++){const Y=i.get(V);N.iconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},N.iconFeatureIndex=Y.featureIndex;break}for(let V=D;V<L;V++){const Y=i.get(V);N.verticalIconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},N.verticalIconFeatureIndex=Y.featureIndex;break}return N}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const f=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,o){const f=i.placedSymbolArray.get(o),_=f.vertexStartIndex+4*f.numGlyphs;for(let T=f.vertexStartIndex;T<_;T+=4)i.indexArray.emplaceBack(T,T+2,T+1),i.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),f=Math.cos(i),_=[],T=[],S=[];for(let M=0;M<this.symbolInstances.length;++M){S.push(M);const D=this.symbolInstances.get(M);_.push(0|Math.round(o*D.anchorX+f*D.anchorY)),T.push(D.featureIndex)}return S.sort((M,D)=>_[M]-_[D]||T[D]-T[M]),S}addToSortKeyRanges(i,o){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===o?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const f=this.symbolInstances.get(o);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((_,T,S)=>{_>=0&&S.indexOf(_)===T&&this.addIndicesForPlacedSymbol(this.text,_)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Yy,Hy;Rt("SymbolBucket",Yu,{omit:["layers","collisionBoxArray","features","compareText"]}),Yu.MAX_GLYPHS=65535,Yu.addDynamicAttributes=eg;var qy={get paint(){return Hy=Hy||new Si({"icon-opacity":new qt(Be.paint_symbol["icon-opacity"]),"icon-color":new qt(Be.paint_symbol["icon-color"]),"icon-halo-color":new qt(Be.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(Be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(Be.paint_symbol["icon-halo-blur"]),"icon-translate":new Lt(Be.paint_symbol["icon-translate"]),"icon-translate-anchor":new Lt(Be.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(Be.paint_symbol["text-opacity"]),"text-color":new qt(Be.paint_symbol["text-color"],{runtimeType:Va,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new qt(Be.paint_symbol["text-halo-color"]),"text-halo-width":new qt(Be.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(Be.paint_symbol["text-halo-blur"]),"text-translate":new Lt(Be.paint_symbol["text-translate"]),"text-translate-anchor":new Lt(Be.paint_symbol["text-translate-anchor"])})},get layout(){return Yy=Yy||new Si({"symbol-placement":new Lt(Be.layout_symbol["symbol-placement"]),"symbol-spacing":new Lt(Be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Lt(Be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(Be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Lt(Be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Lt(Be.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Lt(Be.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Lt(Be.layout_symbol["icon-ignore-placement"]),"icon-optional":new Lt(Be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Lt(Be.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(Be.layout_symbol["icon-size"]),"icon-text-fit":new Lt(Be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Lt(Be.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(Be.layout_symbol["icon-image"]),"icon-rotate":new qt(Be.layout_symbol["icon-rotate"]),"icon-padding":new qt(Be.layout_symbol["icon-padding"]),"icon-keep-upright":new Lt(Be.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(Be.layout_symbol["icon-offset"]),"icon-anchor":new qt(Be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Lt(Be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Lt(Be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Lt(Be.layout_symbol["text-rotation-alignment"]),"text-field":new qt(Be.layout_symbol["text-field"]),"text-font":new qt(Be.layout_symbol["text-font"]),"text-size":new qt(Be.layout_symbol["text-size"]),"text-max-width":new qt(Be.layout_symbol["text-max-width"]),"text-line-height":new Lt(Be.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(Be.layout_symbol["text-letter-spacing"]),"text-justify":new qt(Be.layout_symbol["text-justify"]),"text-radial-offset":new qt(Be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Lt(Be.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new qt(Be.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new qt(Be.layout_symbol["text-anchor"]),"text-max-angle":new Lt(Be.layout_symbol["text-max-angle"]),"text-writing-mode":new Lt(Be.layout_symbol["text-writing-mode"]),"text-rotate":new qt(Be.layout_symbol["text-rotate"]),"text-padding":new Lt(Be.layout_symbol["text-padding"]),"text-keep-upright":new Lt(Be.layout_symbol["text-keep-upright"]),"text-transform":new qt(Be.layout_symbol["text-transform"]),"text-offset":new qt(Be.layout_symbol["text-offset"]),"text-allow-overlap":new Lt(Be.layout_symbol["text-allow-overlap"]),"text-overlap":new Lt(Be.layout_symbol["text-overlap"]),"text-ignore-placement":new Lt(Be.layout_symbol["text-ignore-placement"]),"text-optional":new Lt(Be.layout_symbol["text-optional"])})}};class ng{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:$n,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rt("FormatSectionOverride",ng,{omit:["defaultValue"]});class bf extends qr{constructor(i,o){super(i,qy,o)}recalculate(i,o){if(super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const _=[];for(const T of f)_.indexOf(T)<0&&_.push(T);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,o,f,_){const T=this.layout.get(i).evaluate(o,{},f,_),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||Au(S.value)||!T?T:function(M,D){return D.replace(/{([^{}]+)}/g,(L,N)=>M&&N in M?String(M[N]):"")}(o.properties,T)}createBucket(i){return new Yu(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of qy.paint.overridableProperties){if(!bf.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),f=new ng(o),_=new Kd(f,o.property.specification);let T=null;T=o.value.kind==="constant"||o.value.kind==="source"?new xa("source",_):new il("composite",_,o.value.zoomStops),this.paint._values[i]=new Go(o.property,T,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,f){return!(!this.layout||o.isDataDriven()||f.isDataDriven())&&bf.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const f=i.get("text-field"),_=qy.paint.properties[o];let T=!1;const S=M=>{for(const D of M)if(_.overrides&&_.overrides.hasOverride(D))return void(T=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Cr)S(f.value.value.sections);else if(f.value.kind==="source"||f.value.kind==="composite"){const M=L=>{T||(L instanceof tn&&Pi(L.value)===vs?S(L.value.sections):L instanceof Gd?S(L.sections):L.eachChild(M))},D=f.value;D._styleExpression&&M(D._styleExpression.expression)}return T}}let J0;var ix={get paint(){return J0=J0||new Si({"background-color":new Lt(Be.paint_background["background-color"]),"background-pattern":new tf(Be.paint_background["background-pattern"]),"background-opacity":new Lt(Be.paint_background["background-opacity"])})}};class Up extends qr{constructor(i,o){super(i,ix,o)}}class rx extends qr{constructor(i,o){super(i,{},o),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class ev{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Hn={once:!0},Vp=63710088e-1;class bl{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bl(Kt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,f=this.lat*o,_=i.lat*o,T=Math.sin(f)*Math.sin(_)+Math.cos(f)*Math.cos(_)*Math.cos((i.lng-this.lng)*o);return Vp*Math.acos(Math.min(T,1))}static convert(i){if(i instanceof bl)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new bl(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new bl(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ig=2*Math.PI*Vp;function Xy(s){return ig*Math.cos(s*Math.PI/180)}function rg(s){return(180+s)/360}function xf(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Gp(s,i){return s/Xy(i)}function Wy(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Qy(s,i){return s*Xy(Wy(i))}class $p{constructor(i,o,f=0){this.x=+i,this.y=+o,this.z=+f}static fromLngLat(i,o=0){const f=bl.convert(i);return new $p(rg(f.lng),xf(f.lat),Gp(o,f.lat))}toLngLat(){return new bl(360*this.x-180,Wy(this.y))}toAltitude(){return Qy(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ig*(i=Wy(this.y),1/Math.cos(i*Math.PI/180));var i}}function tv(s,i,o){var f=2*Math.PI*6378137/256/Math.pow(2,o);return[s*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}class ag{constructor(i,o,f){if(!function(_,T,S){return!(_<0||_>25||S<0||S>=Math.pow(2,_)||T<0||T>=Math.pow(2,_))}(i,o,f))throw new Error(`x=${o}, y=${f}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=o,this.y=f,this.key=Hu(0,i,i,o,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o,f){const _=(S=this.y,M=this.z,D=tv(256*(T=this.x),256*(S=Math.pow(2,M)-S-1),M),L=tv(256*(T+1),256*(S+1),M),D[0]+","+D[1]+","+L[0]+","+L[1]);var T,S,M,D,L;const N=function(V,Y,H){let W,ae="";for(let le=V;le>0;le--)W=1<<le-1,ae+=(Y&W?1:0)+(H&W?2:0);return ae}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,_)}isChildOf(i){const o=this.z-i.z;return o>0&&i.x===this.x>>o&&i.y===this.y>>o}getTilePoint(i){const o=Math.pow(2,this.z);return new E((i.x*o-this.x)*ut,(i.y*o-this.y)*ut)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ky{constructor(i,o){this.wrap=i,this.canonical=o,this.key=Hu(i,o.z,o.z,o.x,o.y)}}class Bn{constructor(i,o,f,_,T){if(this.terrainRttPosMatrix32f=null,i<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${f}`);this.overscaledZ=i,this.wrap=o,this.canonical=new ag(f,+_,+T),this.key=Hu(o,i,f,_,T)}clone(){return new Bn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-i;return i>this.canonical.z?new Bn(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bn(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(i,o){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-i;return i>this.canonical.z?Hu(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y):Hu(this.wrap*+o,i,i,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(i){if(i.wrap!==this.wrap||this.overscaledZ-i.overscaledZ<=0)return!1;if(i.overscaledZ===0)return this.overscaledZ>0;const o=this.canonical.z-i.canonical.z;return!(o<0)&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new Bn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,f=2*this.canonical.x,_=2*this.canonical.y;return[new Bn(o,this.wrap,o,f,_),new Bn(o,this.wrap,o,f+1,_),new Bn(o,this.wrap,o,f,_+1),new Bn(o,this.wrap,o,f+1,_+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Bn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Bn(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ky(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new $p(i.x-this.wrap,i.y))}}function Hu(s,i,o,f,_){(s*=2)<0&&(s=-1*s-1);const T=1<<o;return(T*T*s+T*_+f).toString(36)+o.toString(36)+i.toString(36)}function Pr(s,i){return i?s.properties[i]:s.id}Rt("CanonicalTileID",ag),Rt("OverscaledTileID",Bn,{omit:["terrainRttPosMatrix32f"]});class od{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const o=new od;return o.extend(i(new E(this.minX,this.minY))),o.extend(i(new E(this.maxX,this.minY))),o.extend(i(new E(this.minX,this.maxY))),o.extend(i(new E(this.maxX,this.maxY))),o}static fromPoints(i){const o=new od;for(const f of i)o.extend(f);return o}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class Jy{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const f=i[o];this._stringToNumber[f]=o,this._numberToString[o]=f}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class nv{constructor(i,o,f,_,T){this.type="Feature",this._vectorTileFeature=i,i._z=o,i._x=f,i._y=_,this.properties=i.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(i[o]=this[o]);return i}}class og{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Uc(ut,16,0),this.grid3D=new Uc(ut,16,0),this.featureIndexArray=new Se,this.promoteId=o}insert(i,o,f,_,T,S){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,_,T);const D=S?this.grid3D:this.grid;for(let L=0;L<o.length;L++){const N=o[L],V=[1/0,1/0,-1/0,-1/0];for(let Y=0;Y<N.length;Y++){const H=N[Y];V[0]=Math.min(V[0],H.x),V[1]=Math.min(V[1],H.y),V[2]=Math.max(V[2],H.x),V[3]=Math.max(V[3],H.y)}V[0]<ut&&V[1]<ut&&V[2]>=0&&V[3]>=0&&D.insert(M,V[0],V[1],V[2],V[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Dy(new La(this.rawTileData)).layers,this.sourceLayerCoder=new Jy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,o,f,_){this.loadVTLayers();const T=i.params,S=ut/i.tileSize/i.scale,M=Da(T.filter,T.globalState),D=i.queryGeometry,L=i.queryPadding*S,N=od.fromPoints(D),V=this.grid.query(N.minX-L,N.minY-L,N.maxX+L,N.maxY+L),Y=od.fromPoints(i.cameraQueryGeometry).expandBy(L),H=this.grid3D.query(Y.minX,Y.minY,Y.maxX,Y.maxY,(le,pe,Ne,ve)=>function(Ce,Ze,Ke,ft,Dt){for(const Mt of Ce)if(Ze<=Mt.x&&Ke<=Mt.y&&ft>=Mt.x&&Dt>=Mt.y)return!0;const St=[new E(Ze,Ke),new E(Ze,Dt),new E(ft,Dt),new E(ft,Ke)];if(Ce.length>2){for(const Mt of St)if(qh(Ce,Mt))return!0}for(let Mt=0;Mt<Ce.length-1;Mt++)if(D0(Ce[Mt],Ce[Mt+1],St))return!0;return!1}(i.cameraQueryGeometry,le-L,pe-L,Ne+L,ve+L));for(const le of H)V.push(le);V.sort(lg);const W={};let ae;for(let le=0;le<V.length;le++){const pe=V[le];if(pe===ae)continue;ae=pe;const Ne=this.featureIndexArray.get(pe);let ve=null;this.loadMatchingFeature(W,Ne.bucketIndex,Ne.sourceLayerIndex,Ne.featureIndex,M,T.layers,T.availableImages,o,f,_,(Ce,Ze,Ke)=>(ve||(ve=zu(Ce)),Ze.queryIntersectsFeature({queryGeometry:D,feature:Ce,featureState:Ke,geometry:ve,zoom:this.z,transform:i.transform,pixelsToTileUnits:S,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return W}loadMatchingFeature(i,o,f,_,T,S,M,D,L,N,V){const Y=this.bucketLayerIDs[o];if(S&&!Y.some(le=>S.has(le)))return;const H=this.sourceLayerCoder.decode(f),W=this.vtLayers[H].feature(_);if(T.needGeometry){const le=Xo(W,!0);if(!T.filter(new ci(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!T.filter(new ci(this.tileID.overscaledZ),W))return;const ae=this.getId(W,H);for(let le=0;le<Y.length;le++){const pe=Y[le];if(S&&!S.has(pe))continue;const Ne=D[pe];if(!Ne)continue;let ve={};ae&&N&&(ve=N.getState(Ne.sourceLayer||"_geojsonTileLayer",ae));const Ce=cn({},L[pe]);Ce.paint=sg(Ce.paint,Ne.paint,W,ve,M),Ce.layout=sg(Ce.layout,Ne.layout,W,ve,M);const Ze=!V||V(W,Ne,ve);if(!Ze)continue;const Ke=new nv(W,this.z,this.x,this.y,ae);Ke.layer=Ce;let ft=i[pe];ft===void 0&&(ft=i[pe]=[]),ft.push({featureIndex:_,feature:Ke,intersectionZ:Ze})}}lookupSymbolFeatures(i,o,f,_,T,S,M,D){const L={};this.loadVTLayers();const N=Da(T.filterSpec,T.globalState);for(const V of i)this.loadMatchingFeature(L,f,_,V,N,S,M,D,o);return L}hasLayer(i){for(const o of this.bucketLayerIDs)for(const f of o)if(i===f)return!0;return!1}getId(i,o){var f;let _=i.id;return this.promoteId&&(_=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof _=="boolean"&&(_=Number(_)),_===void 0&&(!((f=i.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(_=Number(i.properties.cluster_id))),_}}function sg(s,i,o,f,_){return lr(s,(T,S)=>{const M=i instanceof Gh?i.get(S):null;return M&&M.evaluate?M.evaluate(o,f,_):M})}function lg(s,i){return i-s}function e_(s,i,o,f,_){const T=[];for(let S=0;S<s.length;S++){const M=s[S];let D;for(let L=0;L<M.length-1;L++){let N=M[L],V=M[L+1];N.x<i&&V.x<i||(N.x<i?N=new E(i,N.y+(i-N.x)/(V.x-N.x)*(V.y-N.y))._round():V.x<i&&(V=new E(i,N.y+(i-N.x)/(V.x-N.x)*(V.y-N.y))._round()),N.y<o&&V.y<o||(N.y<o?N=new E(N.x+(o-N.y)/(V.y-N.y)*(V.x-N.x),o)._round():V.y<o&&(V=new E(N.x+(o-N.y)/(V.y-N.y)*(V.x-N.x),o)._round()),N.x>=f&&V.x>=f||(N.x>=f?N=new E(f,N.y+(f-N.x)/(V.x-N.x)*(V.y-N.y))._round():V.x>=f&&(V=new E(f,N.y+(f-N.x)/(V.x-N.x)*(V.y-N.y))._round()),N.y>=_&&V.y>=_||(N.y>=_?N=new E(N.x+(_-N.y)/(V.y-N.y)*(V.x-N.x),_)._round():V.y>=_&&(V=new E(N.x+(_-N.y)/(V.y-N.y)*(V.x-N.x),_)._round()),D&&N.equals(D[D.length-1])||(D=[N],T.push(D)),D.push(V)))))}}return T}Rt("FeatureIndex",og,{omit:["rawTileData","sourceLayerCoder"]});class ru extends E{constructor(i,o,f,_){super(i,o),this.angle=f,_!==void 0&&(this.segment=_)}clone(){return new ru(this.x,this.y,this.angle,this.segment)}}function cg(s,i,o,f,_){if(i.segment===void 0||o===0)return!0;let T=i,S=i.segment+1,M=0;for(;M>-o/2;){if(S--,S<0)return!1;M-=s[S].dist(T),T=s[S]}M+=s[S].dist(s[S+1]),S++;const D=[];let L=0;for(;M<o/2;){const N=s[S],V=s[S+1];if(!V)return!1;let Y=s[S-1].angleTo(N)-N.angleTo(V);for(Y=Math.abs((Y+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:M,angleDelta:Y}),L+=Y;M-D[0].distance>f;)L-=D.shift().angleDelta;if(L>_)return!1;S++,M+=N.dist(V)}return!0}function ug(s){let i=0;for(let o=0;o<s.length-1;o++)i+=s[o].dist(s[o+1]);return i}function iv(s,i,o){return s?.6*i*o:0}function t_(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function ax(s,i,o,f,_,T){const S=iv(o,_,T),M=t_(o,f)*T;let D=0;const L=ug(s)/2;for(let N=0;N<s.length-1;N++){const V=s[N],Y=s[N+1],H=V.dist(Y);if(D+H>L){const W=(L-D)/H,ae=yo.number(V.x,Y.x,W),le=yo.number(V.y,Y.y,W),pe=new ru(ae,le,Y.angleTo(V),N);return pe._round(),!S||cg(s,pe,M,S,i)?pe:void 0}D+=H}}function rv(s,i,o,f,_,T,S,M,D){const L=iv(f,T,S),N=t_(f,_),V=N*S,Y=s[0].x===0||s[0].x===D||s[0].y===0||s[0].y===D;return i-V<i/4&&(i=V+i/4),av(s,Y?i/2*M%i:(N/2+2*T)*S*M%i,i,L,o,V,Y,!1,D)}function av(s,i,o,f,_,T,S,M,D){const L=T/2,N=ug(s);let V=0,Y=i-o,H=[];for(let W=0;W<s.length-1;W++){const ae=s[W],le=s[W+1],pe=ae.dist(le),Ne=le.angleTo(ae);for(;Y+o<V+pe;){Y+=o;const ve=(Y-V)/pe,Ce=yo.number(ae.x,le.x,ve),Ze=yo.number(ae.y,le.y,ve);if(Ce>=0&&Ce<D&&Ze>=0&&Ze<D&&Y-L>=0&&Y+L<=N){const Ke=new ru(Ce,Ze,Ne,W);Ke._round(),f&&!cg(s,Ke,T,f,_)||H.push(Ke)}}V+=pe}return M||H.length||S||(H=av(s,V/2,o,f,_,T,S,!0,D)),H}function ov(s,i,o,f){const _=[],T=s.image,S=T.pixelRatio,M=T.paddedRect.w-2,D=T.paddedRect.h-2;let L={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const N=T.stretchX||[[0,M]],V=T.stretchY||[[0,D]],Y=(at,Qt)=>at+Qt[1]-Qt[0],H=N.reduce(Y,0),W=V.reduce(Y,0),ae=M-H,le=D-W;let pe=0,Ne=H,ve=0,Ce=W,Ze=0,Ke=ae,ft=0,Dt=le;if(T.content&&f){const at=T.content,Qt=at[2]-at[0],nn=at[3]-at[1];(T.textFitWidth||T.textFitHeight)&&(L=Jm(s)),pe=xl(N,0,at[0]),ve=xl(V,0,at[1]),Ne=xl(N,at[0],at[2]),Ce=xl(V,at[1],at[3]),Ze=at[0]-pe,ft=at[1]-ve,Ke=Qt-Ne,Dt=nn-Ce}const St=L.x1,Mt=L.y1,$t=L.x2-St,At=L.y2-Mt,Ct=(at,Qt,nn,Xt)=>{const Bt=Zp(at.stretch-pe,Ne,$t,St),An=wf(at.fixed-Ze,Ke,at.stretch,H),zi=Zp(Qt.stretch-ve,Ce,At,Mt),dr=wf(Qt.fixed-ft,Dt,Qt.stretch,W),ra=Zp(nn.stretch-pe,Ne,$t,St),oo=wf(nn.fixed-Ze,Ke,nn.stretch,H),Tr=Zp(Xt.stretch-ve,Ce,At,Mt),qi=wf(Xt.fixed-ft,Dt,Xt.stretch,W),oi=new E(Bt,zi),ar=new E(ra,zi),fr=new E(ra,Tr),Xi=new E(Bt,Tr),za=new E(An/S,dr/S),Mo=new E(oo/S,qi/S),or=i*Math.PI/180;if(or){const pr=Math.sin(or),Lr=Math.cos(or),Er=[Lr,-pr,pr,Lr];oi._matMult(Er),ar._matMult(Er),Xi._matMult(Er),fr._matMult(Er)}const so=at.stretch+at.fixed,Sr=Qt.stretch+Qt.fixed;return{tl:oi,tr:ar,bl:Xi,br:fr,tex:{x:T.paddedRect.x+1+so,y:T.paddedRect.y+1+Sr,w:nn.stretch+nn.fixed-so,h:Xt.stretch+Xt.fixed-Sr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:za,pixelOffsetBR:Mo,minFontScaleX:Ke/S/$t,minFontScaleY:Dt/S/At,isSDF:o}};if(f&&(T.stretchX||T.stretchY)){const at=n_(N,ae,H),Qt=n_(V,le,W);for(let nn=0;nn<at.length-1;nn++){const Xt=at[nn],Bt=at[nn+1];for(let An=0;An<Qt.length-1;An++)_.push(Ct(Xt,Qt[An],Bt,Qt[An+1]))}}else _.push(Ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:D+1}));return _}function xl(s,i,o){let f=0;for(const _ of s)f+=Math.max(i,Math.min(o,_[1]))-Math.max(i,Math.min(o,_[0]));return f}function n_(s,i,o){const f=[{fixed:-1,stretch:0}];for(const[_,T]of s){const S=f[f.length-1];f.push({fixed:_-S.stretch,stretch:S.stretch}),f.push({fixed:_-S.stretch,stretch:S.stretch+(T-_)})}return f.push({fixed:i+1,stretch:o}),f}function Zp(s,i,o,f){return s/i*o+f}function wf(s,i,o,f){return s-i*o/f}Rt("Anchor",ru);class hg{constructor(i,o,f,_,T,S,M,D,L,N){var V;if(this.boxStartIndex=i.length,L){let Y=S.top,H=S.bottom;const W=S.collisionPadding;W&&(Y-=W[1],H+=W[3]);let ae=H-Y;ae>0&&(ae=Math.max(10,ae),this.circleDiameter=ae)}else{const Y=!((V=S.image)===null||V===void 0)&&V.content&&(S.image.textFitWidth||S.image.textFitHeight)?Jm(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};Y.y1=Y.y1*M-D[0],Y.y2=Y.y2*M+D[2],Y.x1=Y.x1*M-D[3],Y.x2=Y.x2*M+D[1];const H=S.collisionPadding;if(H&&(Y.x1-=H[0]*M,Y.y1-=H[1]*M,Y.x2+=H[2]*M,Y.y2+=H[3]*M),N){const W=new E(Y.x1,Y.y1),ae=new E(Y.x2,Y.y1),le=new E(Y.x1,Y.y2),pe=new E(Y.x2,Y.y2),Ne=N*Math.PI/180;W._rotate(Ne),ae._rotate(Ne),le._rotate(Ne),pe._rotate(Ne),Y.x1=Math.min(W.x,ae.x,le.x,pe.x),Y.x2=Math.max(W.x,ae.x,le.x,pe.x),Y.y1=Math.min(W.y,ae.y,le.y,pe.y),Y.y2=Math.max(W.y,ae.y,le.y,pe.y)}i.emplaceBack(o.x,o.y,Y.x1,Y.y1,Y.x2,Y.y2,f,_,T)}this.boxEndIndex=i.length}}class ox{constructor(i=[],o=(f,_)=>f<_?-1:f>_?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:f}=this,_=o[i];for(;i>0;){const T=i-1>>1,S=o[T];if(f(_,S)>=0)break;o[i]=S,i=T}o[i]=_}_down(i){const{data:o,compare:f}=this,_=this.length>>1,T=o[i];for(;i<_;){let S=1+(i<<1);const M=S+1;if(M<this.length&&f(o[M],o[S])<0&&(S=M),f(o[S],T)>=0)break;o[i]=o[S],i=S}o[i]=T}}function sv(s,i=1,o=!1){const f=od.fromPoints(s[0]),_=Math.min(f.width(),f.height());let T=_/2;const S=new ox([],i_),{minX:M,minY:D,maxX:L,maxY:N}=f;if(_===0)return new E(M,D);for(let H=M;H<L;H+=_)for(let W=D;W<N;W+=_)S.push(new qu(H+T,W+T,T,s));let V=function(H){let W=0,ae=0,le=0;const pe=H[0];for(let Ne=0,ve=pe.length,Ce=ve-1;Ne<ve;Ce=Ne++){const Ze=pe[Ne],Ke=pe[Ce],ft=Ze.x*Ke.y-Ke.x*Ze.y;ae+=(Ze.x+Ke.x)*ft,le+=(Ze.y+Ke.y)*ft,W+=3*ft}return new qu(ae/W,le/W,0,H)}(s),Y=S.length;for(;S.length;){const H=S.pop();(H.d>V.d||!V.d)&&(V=H,o&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,Y)),H.max-V.d<=i||(T=H.h/2,S.push(new qu(H.p.x-T,H.p.y-T,T,s)),S.push(new qu(H.p.x+T,H.p.y-T,T,s)),S.push(new qu(H.p.x-T,H.p.y+T,T,s)),S.push(new qu(H.p.x+T,H.p.y+T,T,s)),Y+=4)}return o&&(console.log(`num probes: ${Y}`),console.log(`best distance: ${V.d}`)),V.p}function i_(s,i){return i.max-s.max}function qu(s,i,o,f){this.p=new E(s,i),this.h=o,this.d=function(_,T){let S=!1,M=1/0;for(let D=0;D<T.length;D++){const L=T[D];for(let N=0,V=L.length,Y=V-1;N<V;Y=N++){const H=L[N],W=L[Y];H.y>_.y!=W.y>_.y&&_.x<(W.x-H.x)*(_.y-H.y)/(W.y-H.y)+H.x&&(S=!S),M=Math.min(M,kr(_,H,W))}}return(S?1:-1)*Math.sqrt(M)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var fa;y.aE=void 0,(fa=y.aE||(y.aE={}))[fa.center=1]="center",fa[fa.left=2]="left",fa[fa.right=3]="right",fa[fa.top=4]="top",fa[fa.bottom=5]="bottom",fa[fa["top-left"]=6]="top-left",fa[fa["top-right"]=7]="top-right",fa[fa["bottom-left"]=8]="bottom-left",fa[fa["bottom-right"]=9]="bottom-right";const Ao=Number.POSITIVE_INFINITY;function dg(s,i){return i[1]!==Ao?function(o,f,_){let T=0,S=0;switch(f=Math.abs(f),_=Math.abs(_),o){case"top-right":case"top-left":case"top":S=_-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-_}switch(o){case"top-right":case"bottom-right":case"right":T=-f;break;case"top-left":case"bottom-left":case"left":T=f}return[T,S]}(s,i[0],i[1]):function(o,f){let _=0,T=0;f<0&&(f=0);const S=f/Math.SQRT2;switch(o){case"top-right":case"top-left":T=S-7;break;case"bottom-right":case"bottom-left":T=7-S;break;case"bottom":T=7-f;break;case"top":T=f-7}switch(o){case"top-right":case"bottom-right":_=-S;break;case"top-left":case"bottom-left":_=S;break;case"left":_=f;break;case"right":_=-f}return[_,T]}(s,i[0])}function r_(s,i,o){var f;const _=s.layout,T=(f=_.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(i,{},o);if(T){const M=T.values,D=[];for(let L=0;L<M.length;L+=2){const N=D[L]=M[L],V=M[L+1].map(Y=>Y*rr);N.startsWith("top")?V[1]-=7:N.startsWith("bottom")&&(V[1]+=7),D[L+1]=V}return new Qi(D)}const S=_.get("text-variable-anchor");if(S){let M;M=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(i,{},o)*rr,Ao]:_.get("text-offset").evaluate(i,{},o).map(L=>L*rr);const D=[];for(const L of S)D.push(L,dg(L,M));return new Qi(D)}return null}function fg(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lv(s,i,o,f,_,T,S,M,D,L,N,V){let Y=T.textMaxSize.evaluate(i,{});Y===void 0&&(Y=S);const H=s.layers[0].layout,W=H.get("icon-offset").evaluate(i,{},N),ae=Ko(o.horizontal),le=S/24,pe=s.tilePixelRatio*le,Ne=s.tilePixelRatio*Y/24,ve=s.tilePixelRatio*M,Ce=s.tilePixelRatio*H.get("symbol-spacing"),Ze=H.get("text-padding")*s.tilePixelRatio,Ke=function(nn,Xt,Bt,An=1){const zi=nn.get("icon-padding").evaluate(Xt,{},Bt),dr=zi&&zi.values;return[dr[0]*An,dr[1]*An,dr[2]*An,dr[3]*An]}(H,i,N,s.tilePixelRatio),ft=H.get("text-max-angle")/180*Math.PI,Dt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",St=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",Mt=H.get("symbol-placement"),$t=Ce/2,At=H.get("icon-text-fit");let Ct;f&&At!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(Ct=Fp(f,o.vertical,At,H.get("icon-text-fit-padding"),W,le)),ae&&(f=Fp(f,ae,At,H.get("icon-text-fit-padding"),W,le)));const at=N?V.line.getGranularityForZoomLevel(N.z):1,Qt=(nn,Xt)=>{Xt.x<0||Xt.x>=ut||Xt.y<0||Xt.y>=ut||function(Bt,An,zi,dr,ra,oo,Tr,qi,oi,ar,fr,Xi,za,Mo,or,so,Sr,pr,Lr,Er,gi,Co,sd,Na,fv){const Xu=Bt.addToLineVertexArray(An,zi);let dc,ld,Sf,au,a=0,u=0,g=0,w=0,I=-1,P=-1;const Z={};let se=qc("");if(Bt.allowVerticalPlacement&&dr.vertical){const Pt=qi.layout.get("text-rotate").evaluate(gi,{},Na)+90;Sf=new hg(oi,An,ar,fr,Xi,dr.vertical,za,Mo,or,Pt),Tr&&(au=new hg(oi,An,ar,fr,Xi,Tr,Sr,pr,or,Pt))}if(ra){const Pt=qi.layout.get("icon-rotate").evaluate(gi,{}),rn=qi.layout.get("icon-text-fit")!=="none",Rn=ov(ra,Pt,sd,rn),kn=Tr?ov(Tr,Pt,sd,rn):void 0;ld=new hg(oi,An,ar,fr,Xi,ra,Sr,pr,!1,Pt),a=4*Rn.length;const Do=Bt.iconSizeData;let fc=null;Do.kind==="source"?(fc=[_l*qi.layout.get("icon-size").evaluate(gi,{})],fc[0]>ao&&Ln(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Do.kind==="composite"&&(fc=[_l*Co.compositeIconSizes[0].evaluate(gi,{},Na),_l*Co.compositeIconSizes[1].evaluate(gi,{},Na)],(fc[0]>ao||fc[1]>ao)&&Ln(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Bt.addSymbols(Bt.icon,Rn,fc,Er,Lr,gi,y.ao.none,An,Xu.lineStartIndex,Xu.lineLength,-1,Na),I=Bt.icon.placedSymbolArray.length-1,kn&&(u=4*kn.length,Bt.addSymbols(Bt.icon,kn,fc,Er,Lr,gi,y.ao.vertical,An,Xu.lineStartIndex,Xu.lineLength,-1,Na),P=Bt.icon.placedSymbolArray.length-1)}const Ie=Object.keys(dr.horizontal);for(const Pt of Ie){const rn=dr.horizontal[Pt];if(!dc){se=qc(rn.text);const kn=qi.layout.get("text-rotate").evaluate(gi,{},Na);dc=new hg(oi,An,ar,fr,Xi,rn,za,Mo,or,kn)}const Rn=rn.positionedLines.length===1;if(g+=Tf(Bt,An,rn,oo,qi,or,gi,so,Xu,dr.vertical?y.ao.horizontal:y.ao.horizontalOnly,Rn?Ie:[Pt],Z,I,Co,Na),Rn)break}dr.vertical&&(w+=Tf(Bt,An,dr.vertical,oo,qi,or,gi,so,Xu,y.ao.vertical,["vertical"],Z,P,Co,Na));const We=dc?dc.boxStartIndex:Bt.collisionBoxArray.length,lt=dc?dc.boxEndIndex:Bt.collisionBoxArray.length,mt=Sf?Sf.boxStartIndex:Bt.collisionBoxArray.length,et=Sf?Sf.boxEndIndex:Bt.collisionBoxArray.length,nt=ld?ld.boxStartIndex:Bt.collisionBoxArray.length,Yt=ld?ld.boxEndIndex:Bt.collisionBoxArray.length,ln=au?au.boxStartIndex:Bt.collisionBoxArray.length,Ni=au?au.boxEndIndex:Bt.collisionBoxArray.length;let Ve=-1;const ze=(Pt,rn)=>Pt&&Pt.circleDiameter?Math.max(Pt.circleDiameter,rn):rn;Ve=ze(dc,Ve),Ve=ze(Sf,Ve),Ve=ze(ld,Ve),Ve=ze(au,Ve);const Xe=Ve>-1?1:0;Xe&&(Ve*=fv/rr),Bt.glyphOffsetArray.length>=Yu.MAX_GLYPHS&&Ln("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gi.sortKey!==void 0&&Bt.addToSortKeyRanges(Bt.symbolInstances.length,gi.sortKey);const ht=r_(qi,gi,Na),[en,hi]=function(Pt,rn){const Rn=Pt.length,kn=rn?.values;if(kn?.length>0)for(let Do=0;Do<kn.length;Do+=2){const fc=kn[Do+1];Pt.emplaceBack(y.aE[kn[Do]],fc[0],fc[1])}return[Rn,Pt.length]}(Bt.textAnchorOffsets,ht);Bt.symbolInstances.emplaceBack(An.x,An.y,Z.right>=0?Z.right:-1,Z.center>=0?Z.center:-1,Z.left>=0?Z.left:-1,Z.vertical||-1,I,P,se,We,lt,mt,et,nt,Yt,ln,Ni,ar,g,w,a,u,Xe,0,za,Ve,en,hi)}(s,Xt,nn,o,f,_,Ct,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,pe,[Ze,Ze,Ze,Ze],Dt,D,ve,Ke,St,W,i,T,L,N,S)};if(Mt==="line")for(const nn of e_(i.geometry,0,0,ut,ut)){const Xt=Bu(nn,at),Bt=rv(Xt,Ce,ft,o.vertical||ae,f,24,Ne,s.overscaling,ut);for(const An of Bt)ae&&cv(s,ae.text,$t,An)||Qt(Xt,An)}else if(Mt==="line-center"){for(const nn of i.geometry)if(nn.length>1){const Xt=Bu(nn,at),Bt=ax(Xt,ft,o.vertical||ae,f,24,Ne);Bt&&Qt(Xt,Bt)}}else if(i.type==="Polygon")for(const nn of Sh(i.geometry,0)){const Xt=sv(nn,16);Qt(Bu(nn[0],at,!0),new ru(Xt.x,Xt.y,0))}else if(i.type==="LineString")for(const nn of i.geometry){const Xt=Bu(nn,at);Qt(Xt,new ru(Xt[0].x,Xt[0].y,0))}else if(i.type==="Point")for(const nn of i.geometry)for(const Xt of nn)Qt([Xt],new ru(Xt.x,Xt.y,0))}function Tf(s,i,o,f,_,T,S,M,D,L,N,V,Y,H,W){const ae=function(Ne,ve,Ce,Ze,Ke,ft,Dt,St){const Mt=Ze.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,$t=[];for(const At of ve.positionedLines)for(const Ct of At.positionedGlyphs){if(!Ct.rect)continue;const at=Ct.rect||{};let Qt=4,nn=!0,Xt=1,Bt=0;const An=(Ke||St)&&Ct.vertical,zi=Ct.metrics.advance*Ct.scale/2;if(St&&ve.verticalizable&&(Bt=At.lineOffset/2-(Ct.imageName?-(rr-Ct.metrics.width*Ct.scale)/2:(Ct.scale-1)*rr)),Ct.imageName){const pr=Dt[Ct.imageName];nn=pr.sdf,Xt=pr.pixelRatio,Qt=1/Xt}const dr=Ke?[Ct.x+zi,Ct.y]:[0,0];let ra=Ke?[0,0]:[Ct.x+zi+Ce[0],Ct.y+Ce[1]-Bt],oo=[0,0];An&&(oo=ra,ra=[0,0]);const Tr=Ct.metrics.isDoubleResolution?2:1,qi=(Ct.metrics.left-Qt)*Ct.scale-zi+ra[0],oi=(-Ct.metrics.top-Qt)*Ct.scale+ra[1],ar=qi+at.w/Tr*Ct.scale/Xt,fr=oi+at.h/Tr*Ct.scale/Xt,Xi=new E(qi,oi),za=new E(ar,oi),Mo=new E(qi,fr),or=new E(ar,fr);if(An){const pr=new E(-zi,zi- -17),Lr=-Math.PI/2,Er=12-zi,gi=new E(22-Er,-(Ct.imageName?Er:0)),Co=new E(...oo);Xi._rotateAround(Lr,pr)._add(gi)._add(Co),za._rotateAround(Lr,pr)._add(gi)._add(Co),Mo._rotateAround(Lr,pr)._add(gi)._add(Co),or._rotateAround(Lr,pr)._add(gi)._add(Co)}if(Mt){const pr=Math.sin(Mt),Lr=Math.cos(Mt),Er=[Lr,-pr,pr,Lr];Xi._matMult(Er),za._matMult(Er),Mo._matMult(Er),or._matMult(Er)}const so=new E(0,0),Sr=new E(0,0);$t.push({tl:Xi,tr:za,bl:Mo,br:or,tex:at,writingMode:ve.writingMode,glyphOffset:dr,sectionIndex:Ct.sectionIndex,isSDF:nn,pixelOffsetTL:so,pixelOffsetBR:Sr,minFontScaleX:0,minFontScaleY:0})}return $t}(0,o,M,_,T,S,f,s.allowVerticalPlacement),le=s.textSizeData;let pe=null;le.kind==="source"?(pe=[_l*_.layout.get("text-size").evaluate(S,{})],pe[0]>ao&&Ln(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):le.kind==="composite"&&(pe=[_l*H.compositeTextSizes[0].evaluate(S,{},W),_l*H.compositeTextSizes[1].evaluate(S,{},W)],(pe[0]>ao||pe[1]>ao)&&Ln(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,ae,pe,M,T,S,L,i,D.lineStartIndex,D.lineLength,Y,W);for(const Ne of N)V[Ne]=s.text.placedSymbolArray.length-1;return 4*ae.length}function Ko(s){for(const i in s)return s[i];return null}function cv(s,i,o,f){const _=s.compareText;if(i in _){const T=_[i];for(let S=T.length-1;S>=0;S--)if(f.dist(T[S])<o)return!0}else _[i]=[];return _[i].push(f),!1}const Yp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wl{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,f]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=f>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const T=Yp[15&f];if(!T)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(i,2,1),[M]=new Uint32Array(i,4,1);return new wl(M,S,T,i)}constructor(i,o=64,f=Float64Array,_){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=f,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const T=Yp.indexOf(this.ArrayType),S=2*i*this.ArrayType.BYTES_PER_ELEMENT,M=i*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-M%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${f}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+M+D,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+S+M+D),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+M+D,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=i,this.coords[this._pos++]=o,f}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return a_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,f,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:S,nodeSize:M}=this,D=[0,T.length-1,0],L=[];for(;D.length;){const N=D.pop()||0,V=D.pop()||0,Y=D.pop()||0;if(V-Y<=M){for(let le=Y;le<=V;le++){const pe=S[2*le],Ne=S[2*le+1];pe>=i&&pe<=f&&Ne>=o&&Ne<=_&&L.push(T[le])}continue}const H=Y+V>>1,W=S[2*H],ae=S[2*H+1];W>=i&&W<=f&&ae>=o&&ae<=_&&L.push(T[H]),(N===0?i<=W:o<=ae)&&(D.push(Y),D.push(H-1),D.push(1-N)),(N===0?f>=W:_>=ae)&&(D.push(H+1),D.push(V),D.push(1-N))}return L}within(i,o,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:T,nodeSize:S}=this,M=[0,_.length-1,0],D=[],L=f*f;for(;M.length;){const N=M.pop()||0,V=M.pop()||0,Y=M.pop()||0;if(V-Y<=S){for(let le=Y;le<=V;le++)hv(T[2*le],T[2*le+1],i,o)<=L&&D.push(_[le]);continue}const H=Y+V>>1,W=T[2*H],ae=T[2*H+1];hv(W,ae,i,o)<=L&&D.push(_[H]),(N===0?i-f<=W:o-f<=ae)&&(M.push(Y),M.push(H-1),M.push(1-N)),(N===0?i+f>=W:o+f>=ae)&&(M.push(H+1),M.push(V),M.push(1-N))}return D}}function a_(s,i,o,f,_,T){if(_-f<=o)return;const S=f+_>>1;uv(s,i,S,f,_,T),a_(s,i,o,f,S-1,1-T),a_(s,i,o,S+1,_,1-T)}function uv(s,i,o,f,_,T){for(;_>f;){if(_-f>600){const L=_-f+1,N=o-f+1,V=Math.log(L),Y=.5*Math.exp(2*V/3),H=.5*Math.sqrt(V*Y*(L-Y)/L)*(N-L/2<0?-1:1);uv(s,i,o,Math.max(f,Math.floor(o-N*Y/L+H)),Math.min(_,Math.floor(o+(L-N)*Y/L+H)),T)}const S=i[2*o+T];let M=f,D=_;for(hc(s,i,f,o),i[2*_+T]>S&&hc(s,i,f,_);M<D;){for(hc(s,i,M,D),M++,D--;i[2*M+T]<S;)M++;for(;i[2*D+T]>S;)D--}i[2*f+T]===S?hc(s,i,f,D):(D++,hc(s,i,D,_)),D<=o&&(f=D+1),o<=D&&(_=D-1)}}function hc(s,i,o,f){pg(s,o,f),pg(i,2*o,2*f),pg(i,2*o+1,2*f+1)}function pg(s,i,o){const f=s[i];s[i]=s[o],s[o]=f}function hv(s,i,o,f){const _=s-o,T=i-f;return _*_+T*T}var o_;y.cx=void 0,(o_=y.cx||(y.cx={})).create="create",o_.load="load",o_.fullLoad="fullLoad";let mg=null,Hp=[];const s_=1e3/60,l_="loadTime",c_="fullLoadTime",dv={mark(s){performance.mark(s)},frame(s){const i=s;mg!=null&&Hp.push(i-mg),mg=i},clearMetrics(){mg=null,Hp=[],performance.clearMeasures(l_),performance.clearMeasures(c_);for(const s in y.cx)performance.clearMarks(y.cx[s])},getPerformanceMetrics(){performance.measure(l_,y.cx.create,y.cx.load),performance.measure(c_,y.cx.create,y.cx.fullLoad);const s=performance.getEntriesByName(l_)[0].duration,i=performance.getEntriesByName(c_)[0].duration,o=Hp.length,f=1/(Hp.reduce((T,S)=>T+S,0)/o/1e3),_=Hp.filter(T=>T>s_).reduce((T,S)=>T+(S-s_)/s_,0);return{loadTime:s,fullLoadTime:i,fps:f,percentDroppedFrames:_/(o+_)*100,totalFrames:o}}};y.$=ut,y.A=Te,y.B=function([s,i,o]){return i+=90,i*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(i)*Math.sin(o),y:s*Math.sin(i)*Math.sin(o),z:s*Math.cos(o)}},y.C=yo,y.D=Lt,y.E=Ht,y.F=ci,y.G=ef,y.H=po,y.I=jy,y.J=class{constructor(s,i){this.target=s,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new ev(()=>this.process()),this.subscription=Oi(this.target,"message",o=>this.receive(o),!1),this.globalScope=gr(self)?s:window}registerMessageHandler(s,i){this.messageHandlers[s]=i}sendAsync(s,i){return new Promise((o,f)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=i?Oi(i.signal,"abort",()=>{T?.unsubscribe(),delete this.resolveRejects[_];const D={id:_,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(D)},Hn):null;this.resolveRejects[_]={resolve:D=>{T?.unsubscribe(),o(D)},reject:D=>{T?.unsubscribe(),f(D)}};const S=[],M=Object.assign(Object.assign({},s),{id:_,sourceMapId:this.mapId,origin:location.origin,data:Wl(s.data,S)});this.target.postMessage(M,{transfer:S})})}receive(s){const i=s.data,o=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[o];const f=this.abortControllers[o];return delete this.abortControllers[o],void(f&&f.abort())}if(gr(self)||i.mustQueue)return this.tasks[o]=i,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,i)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),i=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(s,i)}processTask(s,i){return c(this,void 0,void 0,function*(){if(i.type==="<response>"){const _=this.resolveRejects[s];return delete this.resolveRejects[s],_?void(i.error?_.reject(Ql(i.error)):_.resolve(Ql(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=Ql(i.data),f=new AbortController;this.abortControllers[s]=f;try{const _=yield this.messageHandlers[i.type](i.sourceMapId,o,f);this.completeTask(s,null,_)}catch(_){this.completeTask(s,_)}})}completeTask(s,i,o){const f=[];delete this.abortControllers[s];const _={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?Wl(i):null,data:Wl(o,f)};this.target.postMessage(_,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.K=xe,y.L=function(){var s=new Te(16);return Te!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},y.M=function(s,i,o){var f,_,T,S,M,D,L,N,V,Y,H,W,ae=o[0],le=o[1],pe=o[2];return i===s?(s[12]=i[0]*ae+i[4]*le+i[8]*pe+i[12],s[13]=i[1]*ae+i[5]*le+i[9]*pe+i[13],s[14]=i[2]*ae+i[6]*le+i[10]*pe+i[14],s[15]=i[3]*ae+i[7]*le+i[11]*pe+i[15]):(_=i[1],T=i[2],S=i[3],M=i[4],D=i[5],L=i[6],N=i[7],V=i[8],Y=i[9],H=i[10],W=i[11],s[0]=f=i[0],s[1]=_,s[2]=T,s[3]=S,s[4]=M,s[5]=D,s[6]=L,s[7]=N,s[8]=V,s[9]=Y,s[10]=H,s[11]=W,s[12]=f*ae+M*le+V*pe+i[12],s[13]=_*ae+D*le+Y*pe+i[13],s[14]=T*ae+L*le+H*pe+i[14],s[15]=S*ae+N*le+W*pe+i[15]),s},y.N=function(s,i,o){var f=o[0],_=o[1],T=o[2];return s[0]=i[0]*f,s[1]=i[1]*f,s[2]=i[2]*f,s[3]=i[3]*f,s[4]=i[4]*_,s[5]=i[5]*_,s[6]=i[6]*_,s[7]=i[7]*_,s[8]=i[8]*T,s[9]=i[9]*T,s[10]=i[10]*T,s[11]=i[11]*T,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},y.O=function(s,i,o){var f=i[0],_=i[1],T=i[2],S=i[3],M=i[4],D=i[5],L=i[6],N=i[7],V=i[8],Y=i[9],H=i[10],W=i[11],ae=i[12],le=i[13],pe=i[14],Ne=i[15],ve=o[0],Ce=o[1],Ze=o[2],Ke=o[3];return s[0]=ve*f+Ce*M+Ze*V+Ke*ae,s[1]=ve*_+Ce*D+Ze*Y+Ke*le,s[2]=ve*T+Ce*L+Ze*H+Ke*pe,s[3]=ve*S+Ce*N+Ze*W+Ke*Ne,s[4]=(ve=o[4])*f+(Ce=o[5])*M+(Ze=o[6])*V+(Ke=o[7])*ae,s[5]=ve*_+Ce*D+Ze*Y+Ke*le,s[6]=ve*T+Ce*L+Ze*H+Ke*pe,s[7]=ve*S+Ce*N+Ze*W+Ke*Ne,s[8]=(ve=o[8])*f+(Ce=o[9])*M+(Ze=o[10])*V+(Ke=o[11])*ae,s[9]=ve*_+Ce*D+Ze*Y+Ke*le,s[10]=ve*T+Ce*L+Ze*H+Ke*pe,s[11]=ve*S+Ce*N+Ze*W+Ke*Ne,s[12]=(ve=o[12])*f+(Ce=o[13])*M+(Ze=o[14])*V+(Ke=o[15])*ae,s[13]=ve*_+Ce*D+Ze*Y+Ke*le,s[14]=ve*T+Ce*L+Ze*H+Ke*pe,s[15]=ve*S+Ce*N+Ze*W+Ke*Ne,s},y.P=E,y.Q=function(s,i){const o={};for(let f=0;f<i.length;f++){const _=i[f];_ in s&&(o[_]=s[_])}return o},y.R=Ta,y.S=bl,y.T=lf,y.U=xf,y.V=rg,y.W=ne,y.X=ue,y.Y=Ea,y.Z=Bn,y._=c,y.a=te,y.a$=zt,y.a0=function(s,i){var o,f,_,T,S;if(!s)return i??{};if(!i)return s;let M=Object.assign({},s);if(i.removeAll&&(M={removeAll:!0}),i.remove){const D=new Set(i.remove);M.add&&(M.add=M.add.filter(N=>!D.has(N.id))),M.update&&(M.update=M.update.filter(N=>!D.has(N.id)));const L=new Set(((o=s.add)!==null&&o!==void 0?o:[]).map(N=>N.id));i.remove=i.remove.filter(N=>!L.has(N))}if(i.remove){const D=new Set(M.remove?M.remove.concat(i.remove):i.remove);M.remove=Array.from(D.values())}if(i.add){const D=M.add?M.add.concat(i.add):i.add,L=new Map(D.map(N=>[N.id,N]));M.add=Array.from(L.values())}if(i.update){const D=new Map((f=M.update)===null||f===void 0?void 0:f.map(L=>[L.id,L]));for(const L of i.update){const N=(_=D.get(L.id))!==null&&_!==void 0?_:{id:L.id};L.newGeometry&&(N.newGeometry=L.newGeometry),L.addOrUpdateProperties&&(N.addOrUpdateProperties=((T=N.addOrUpdateProperties)!==null&&T!==void 0?T:[]).concat(L.addOrUpdateProperties)),L.removeProperties&&(N.removeProperties=((S=N.removeProperties)!==null&&S!==void 0?S:[]).concat(L.removeProperties)),L.removeAllProperties&&(N.removeAllProperties=!0),D.set(L.id,N)}M.update=Array.from(D.values())}return M.remove&&M.add&&(M.remove=M.remove.filter(D=>M.add.findIndex(L=>L.id===D)===-1)),M},y.a1=$p,y.a2=od,y.a3=25,y.a4=ag,y.a5=s=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(o=>{i.onloadstart=()=>{o(i)};for(const f of s){const _=window.document.createElement("source");je(f)||(i.crossOrigin="Anonymous"),_.src=f,i.appendChild(_)}})},y.a6=pt,y.a7=function(){return mn++},y.a8=$,y.a9=Yu,y.aA=function(s){let i=1/0,o=1/0,f=-1/0,_=-1/0;for(const T of s)i=Math.min(i,T.x),o=Math.min(o,T.y),f=Math.max(f,T.x),_=Math.max(_,T.y);return[i,o,f,_]},y.aB=rr,y.aC=Ut,y.aD=function(s,i,o,f,_=!1){if(!o[0]&&!o[1])return[0,0];const T=_?f==="map"?-s.bearingInRadians:0:f==="viewport"?s.bearingInRadians:0;if(T){const S=Math.sin(T),M=Math.cos(T);o=[o[0]*M-o[1]*S,o[0]*S+o[1]*M]}return[_?o[0]:Ut(i,o[0],s.zoom),_?o[1]:Ut(i,o[1],s.zoom)]},y.aF=ad,y.aG=fg,y.aH=jp,y.aI=wl,y.aJ=ui,y.aK=Qh,y.aL=Re,y.aM=In,y.aN=ti,y.aO=Kt,y.aP=dn,y.aQ=Qy,y.aR=Je,y.aS=Ee,y.aT=function(s){var i=new Te(3);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i},y.aU=function(s,i,o){return s[0]=i[0]-o[0],s[1]=i[1]-o[1],s[2]=i[2]-o[2],s},y.aV=function(s,i){var o=i[0],f=i[1],_=i[2],T=o*o+f*f+_*_;return T>0&&(T=1/Math.sqrt(T)),s[0]=i[0]*T,s[1]=i[1]*T,s[2]=i[2]*T,s},y.aW=Et,y.aX=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]},y.aY=function(s,i,o){return s[0]=i[0]*o[0],s[1]=i[1]*o[1],s[2]=i[2]*o[2],s[3]=i[3]*o[3],s},y.aZ=Fe,y.a_=function(s,i,o){const f=i[0]*o[0]+i[1]*o[1]+i[2]*o[2];return f===0?null:(-(s[0]*o[0]+s[1]*o[1]+s[2]*o[2])-o[3])/f},y.aa=Da,y.ab=Xo,y.ac=nv,y.ad=function(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,f,_,T)=>{const S=_||T;return i[f]=!S||S.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i},y.ae=ys,y.af=function(s){return Math.pow(2,s)},y.ag=be,y.ah=jt,y.ai=85.051129,y.aj=Gp,y.ak=function(s){return Math.log(s)/Math.LN2},y.al=function(s){var i=s[0],o=s[1];return i*i+o*o},y.am=function(s){if(!s.length)return new Set;const i=Math.max(...s.map(D=>D.canonical.z));let o=1/0,f=-1/0,_=1/0,T=-1/0;const S=[];for(const D of s){const{x:L,y:N,z:V}=D.canonical,Y=Math.pow(2,i-V),H=L*Y,W=N*Y;S.push({id:D,x:H,y:W}),H<o&&(o=H),H>f&&(f=H),W<_&&(_=W),W>T&&(T=W)}const M=new Set;for(const D of S)D.x!==o&&D.x!==f&&D.y!==_&&D.y!==T||M.add(D.id);return M},y.an=function(s,i){let o=0,f=0;if(s.kind==="constant")f=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:_,minZoom:T,maxZoom:S}=s,M=_?jt(Rr.interpolationFactor(_,i,T,S),0,1):0;s.kind==="camera"?f=yo.number(s.minSize,s.maxSize,M):o=M}return{uSizeT:o,uSize:f}},y.ap=function(s,{uSize:i,uSizeT:o},{lowerSize:f,upperSize:_}){return s.kind==="source"?f/_l:s.kind==="composite"?yo.number(f/_l,_/_l,o):i},y.aq=function(s,i){var o=i[0],f=i[1],_=i[2],T=i[3],S=i[4],M=i[5],D=i[6],L=i[7],N=i[8],V=i[9],Y=i[10],H=i[11],W=i[12],ae=i[13],le=i[14],pe=i[15],Ne=o*M-f*S,ve=o*D-_*S,Ce=o*L-T*S,Ze=f*D-_*M,Ke=f*L-T*M,ft=_*L-T*D,Dt=N*ae-V*W,St=N*le-Y*W,Mt=N*pe-H*W,$t=V*le-Y*ae,At=V*pe-H*ae,Ct=Y*pe-H*le,at=Ne*Ct-ve*At+Ce*$t+Ze*Mt-Ke*St+ft*Dt;return at?(s[0]=(M*Ct-D*At+L*$t)*(at=1/at),s[1]=(_*At-f*Ct-T*$t)*at,s[2]=(ae*ft-le*Ke+pe*Ze)*at,s[3]=(Y*Ke-V*ft-H*Ze)*at,s[4]=(D*Mt-S*Ct-L*St)*at,s[5]=(o*Ct-_*Mt+T*St)*at,s[6]=(le*Ce-W*ft-pe*ve)*at,s[7]=(N*ft-Y*Ce+H*ve)*at,s[8]=(S*At-M*Mt+L*Dt)*at,s[9]=(f*Mt-o*At-T*Dt)*at,s[10]=(W*Ke-ae*Ce+pe*Ne)*at,s[11]=(V*Ce-N*Ke-H*Ne)*at,s[12]=(M*St-S*$t-D*Dt)*at,s[13]=(o*$t-f*St+_*Dt)*at,s[14]=(ae*ve-W*Ze-le*Ne)*at,s[15]=(N*Ze-V*ve+Y*Ne)*at,s):null},y.ar=st,y.as=function(s){var i=s[0],o=s[1];return Math.sqrt(i*i+o*o)},y.at=function(s){return s[0]=0,s[1]=0,s},y.au=function(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s},y.av=eg,y.aw=Zt,y.ax=function(s,i,o,f){const _=i.y-s.y,T=i.x-s.x,S=f.y-o.y,M=f.x-o.x,D=S*T-M*_;if(D===0)return null;const L=(M*(s.y-o.y)-S*(s.x-o.x))/D;return new E(s.x+L*T,s.y+L*_)},y.ay=e_,y.az=bp,y.b=Ar,y.b$=class extends ka{constructor(s,i){super(s,i),this.current=new Array}set(s){if(s!=this.current){this.current=s;const i=new Float32Array(s);this.gl.uniform1fv(this.location,i)}}},y.b0=function(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s[3]=i[3]*o,s},y.b1=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]+s[3]},y.b2=Ky,y.b3=Hu,y.b4=function(s,i,o,f,_){var T=1/Math.tan(i/2);if(s[0]=T/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=T,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,_!=null&&_!==1/0){var S=1/(f-_);s[10]=(_+f)*S,s[14]=2*_*f*S}else s[10]=-1,s[14]=-2*f;return s},y.b5=function(s){var i=new Te(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},y.b6=function(s,i,o){var f=Math.sin(o),_=Math.cos(o),T=i[0],S=i[1],M=i[2],D=i[3],L=i[4],N=i[5],V=i[6],Y=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=T*_+L*f,s[1]=S*_+N*f,s[2]=M*_+V*f,s[3]=D*_+Y*f,s[4]=L*_-T*f,s[5]=N*_-S*f,s[6]=V*_-M*f,s[7]=Y*_-D*f,s},y.b7=function(s,i,o){var f=Math.sin(o),_=Math.cos(o),T=i[4],S=i[5],M=i[6],D=i[7],L=i[8],N=i[9],V=i[10],Y=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=T*_+L*f,s[5]=S*_+N*f,s[6]=M*_+V*f,s[7]=D*_+Y*f,s[8]=L*_-T*f,s[9]=N*_-S*f,s[10]=V*_-M*f,s[11]=Y*_-D*f,s},y.b8=function(){const s=new Float32Array(16);return be(s),s},y.b9=function(){const s=new Float64Array(16);return be(s),s},y.bA=function(s,i){const o=De(s,360),f=De(i,360),_=f-o,T=f>o?_-360:_+360;return Math.abs(_)<Math.abs(T)?_:T},y.bB=function(s){return s[0]=0,s[1]=0,s[2]=0,s},y.bC=function(s,i,o,f){const _=Math.sqrt(s*s+i*i),T=Math.sqrt(o*o+f*f);s/=_,i/=_,o/=T,f/=T;const S=Math.acos(s*o+i*f);return-i*o+s*f>0?S:-S},y.bD=function(s,i){const o=De(s,2*Math.PI),f=De(i,2*Math.PI);return Math.min(Math.abs(o-f),Math.abs(o-f+2*Math.PI),Math.abs(o-f-2*Math.PI))},y.bE=function(){const s={},i=Be.$version;for(const o in Be.$root){const f=Be.$root[o];if(f.required){let _=null;_=o==="version"?i:f.type==="array"?[]:{},_!=null&&(s[o]=_)}}return s},y.bF=Gc,y.bG=Oe,y.bH=function s(i,o){if(Array.isArray(i)){if(!Array.isArray(o)||i.length!==o.length)return!1;for(let f=0;f<i.length;f++)if(!s(i[f],o[f]))return!1;return!0}if(typeof i=="object"&&i!==null&&o!==null){if(typeof o!="object"||Object.keys(i).length!==Object.keys(o).length)return!1;for(const f in i)if(!s(i[f],o[f]))return!1;return!0}return i===o},y.bI=function(s){s=s.slice();const i=Object.create(null);for(let o=0;o<s.length;o++)i[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=Un(s[o],i[s[o].ref]));return s},y.bJ=function(s,i){if(s.type==="custom")return new rx(s,i);switch(s.type){case"background":return new Up(s,i);case"circle":return new vy(s,i);case"color-relief":return new Hb(s,i);case"fill":return new ff(s,i);case"fill-extrusion":return new mf(s,i);case"heatmap":return new xy(s,i);case"hillshade":return new Qc(s,i);case"line":return new qm(s,i);case"raster":return new nc(s,i);case"symbol":return new bf(s,i)}},y.bK=s=>s.type==="raster",y.bL=xi,y.bM=function(s,i){if(!s)return[{command:"setStyle",args:[i]}];let o=[];try{if(!Vt(s.version,i.version))return[{command:"setStyle",args:[i]}];Vt(s.center,i.center)||o.push({command:"setCenter",args:[i.center]}),Vt(s.state,i.state)||o.push({command:"setGlobalState",args:[i.state]}),Vt(s.centerAltitude,i.centerAltitude)||o.push({command:"setCenterAltitude",args:[i.centerAltitude]}),Vt(s.zoom,i.zoom)||o.push({command:"setZoom",args:[i.zoom]}),Vt(s.bearing,i.bearing)||o.push({command:"setBearing",args:[i.bearing]}),Vt(s.pitch,i.pitch)||o.push({command:"setPitch",args:[i.pitch]}),Vt(s.roll,i.roll)||o.push({command:"setRoll",args:[i.roll]}),Vt(s.sprite,i.sprite)||o.push({command:"setSprite",args:[i.sprite]}),Vt(s.glyphs,i.glyphs)||o.push({command:"setGlyphs",args:[i.glyphs]}),Vt(s.transition,i.transition)||o.push({command:"setTransition",args:[i.transition]}),Vt(s.light,i.light)||o.push({command:"setLight",args:[i.light]}),Vt(s.terrain,i.terrain)||o.push({command:"setTerrain",args:[i.terrain]}),Vt(s.sky,i.sky)||o.push({command:"setSky",args:[i.sky]}),Vt(s.projection,i.projection)||o.push({command:"setProjection",args:[i.projection]});const f={},_=[];(function(S,M,D,L){let N;for(N in M=M||{},S=S||{})Object.prototype.hasOwnProperty.call(S,N)&&(Object.prototype.hasOwnProperty.call(M,N)||Wi(N,D,L));for(N in M)Object.prototype.hasOwnProperty.call(M,N)&&(Object.prototype.hasOwnProperty.call(S,N)?Vt(S[N],M[N])||(S[N].type==="geojson"&&M[N].type==="geojson"&&Ur(S,M,N)?jn(D,{command:"setGeoJSONSourceData",args:[N,M[N].data]}):yr(N,M,D,L)):hr(N,M,D))})(s.sources,i.sources,_,f);const T=[];s.layers&&s.layers.forEach(S=>{"source"in S&&f[S.source]?o.push({command:"removeLayer",args:[S.id]}):T.push(S)}),o=o.concat(_),function(S,M,D){M=M||[];const L=(S=S||[]).map(_r),N=M.map(_r),V=S.reduce(Kn,{}),Y=M.reduce(Kn,{}),H=L.slice(),W=Object.create(null);let ae,le,pe,Ne,ve;for(let Ce=0,Ze=0;Ce<L.length;Ce++)ae=L[Ce],Object.prototype.hasOwnProperty.call(Y,ae)?Ze++:(jn(D,{command:"removeLayer",args:[ae]}),H.splice(H.indexOf(ae,Ze),1));for(let Ce=0,Ze=0;Ce<N.length;Ce++)ae=N[N.length-1-Ce],H[H.length-1-Ce]!==ae&&(Object.prototype.hasOwnProperty.call(V,ae)?(jn(D,{command:"removeLayer",args:[ae]}),H.splice(H.lastIndexOf(ae,H.length-Ze),1)):Ze++,Ne=H[H.length-Ce],jn(D,{command:"addLayer",args:[Y[ae],Ne]}),H.splice(H.length-Ce,0,ae),W[ae]=!0);for(let Ce=0;Ce<N.length;Ce++)if(ae=N[Ce],le=V[ae],pe=Y[ae],!W[ae]&&!Vt(le,pe))if(Vt(le.source,pe.source)&&Vt(le["source-layer"],pe["source-layer"])&&Vt(le.type,pe.type)){for(ve in pi(le.layout,pe.layout,D,ae,null,"setLayoutProperty"),pi(le.paint,pe.paint,D,ae,null,"setPaintProperty"),Vt(le.filter,pe.filter)||jn(D,{command:"setFilter",args:[ae,pe.filter]}),Vt(le.minzoom,pe.minzoom)&&Vt(le.maxzoom,pe.maxzoom)||jn(D,{command:"setLayerZoomRange",args:[ae,pe.minzoom,pe.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?pi(le[ve],pe[ve],D,ae,ve.slice(6),"setPaintProperty"):Vt(le[ve],pe[ve])||jn(D,{command:"setLayerProperty",args:[ae,ve,pe[ve]]}));for(ve in pe)Object.prototype.hasOwnProperty.call(pe,ve)&&!Object.prototype.hasOwnProperty.call(le,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?pi(le[ve],pe[ve],D,ae,ve.slice(6),"setPaintProperty"):Vt(le[ve],pe[ve])||jn(D,{command:"setLayerProperty",args:[ae,ve,pe[ve]]}))}else jn(D,{command:"removeLayer",args:[ae]}),Ne=H[H.lastIndexOf(ae)+1],jn(D,{command:"addLayer",args:[pe,Ne]})}(T,i.layers,o)}catch(f){console.warn("Unable to compute style diff:",f),o=[{command:"setStyle",args:[i]}]}return o},y.bN=function(s){const i=[],o=s.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},y.bO=lr,y.bP=cr,y.bQ=class extends ka{constructor(s,i){super(s,i),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},y.bR=Oa,y.bS=class extends ka{constructor(s,i){super(s,i),this.current=Wr}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let i=1;i<16;i++)if(s[i]!==this.current[i]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},y.bT=xr,y.bU=class extends ka{constructor(s,i){super(s,i),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},y.bV=class extends ka{constructor(s,i){super(s,i),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},y.bW=ke,y.bX=function(s,i){var o=Math.sin(i),f=Math.cos(i);return s[0]=f,s[1]=o,s[2]=0,s[3]=-o,s[4]=f,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},y.bY=function(s,i,o){var f=i[0],_=i[1],T=i[2];return s[0]=f*o[0]+_*o[3]+T*o[6],s[1]=f*o[1]+_*o[4]+T*o[7],s[2]=f*o[2]+_*o[5]+T*o[8],s},y.bZ=function(s,i,o,f,_,T,S){var M=1/(i-o),D=1/(f-_),L=1/(T-S);return s[0]=-2*M,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*D,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*L,s[11]=0,s[12]=(i+o)*M,s[13]=(_+f)*D,s[14]=(S+T)*L,s[15]=1,s},y.b_=class extends ka{constructor(s,i){super(s,i),this.current=new Array}set(s){if(s!=this.current){this.current=s;const i=new Float32Array(4*s.length);for(let o=0;o<s.length;o++)i[4*o]=s[o].r,i[4*o+1]=s[o].g,i[4*o+2]=s[o].b,i[4*o+3]=s[o].a;this.gl.uniform4fv(this.location,i)}}},y.ba=function(){return new Float64Array(16)},y.bb=function(s,i,o){const f=new Float64Array(4);return Ue(f,s,i-90,o),f},y.bc=function(s,i,o,f){var _,T,S,M,D,L=i[0],N=i[1],V=i[2],Y=i[3],H=o[0],W=o[1],ae=o[2],le=o[3];return(T=L*H+N*W+V*ae+Y*le)<0&&(T=-T,H=-H,W=-W,ae=-ae,le=-le),1-T>Ae?(_=Math.acos(T),S=Math.sin(_),M=Math.sin((1-f)*_)/S,D=Math.sin(f*_)/S):(M=1-f,D=f),s[0]=M*L+D*H,s[1]=M*N+D*W,s[2]=M*V+D*ae,s[3]=M*Y+D*le,s},y.bd=function(s){const i=new Float64Array(9);var o,f,_,T,S,M,D,L,N,V,Y,H,W,ae,le,pe,Ne,ve;V=(_=(f=s)[0])*(D=_+_),Y=(T=f[1])*D,W=(S=f[2])*D,ae=S*(L=T+T),pe=(M=f[3])*D,Ne=M*L,ve=M*(N=S+S),(o=i)[0]=1-(H=T*L)-(le=S*N),o[3]=Y-ve,o[6]=W+Ne,o[1]=Y+ve,o[4]=1-V-le,o[7]=ae-pe,o[2]=W-Ne,o[5]=ae+pe,o[8]=1-V-H;const Ce=dn(-Math.asin(jt(i[2],-1,1)));let Ze,Ke;return Math.hypot(i[5],i[8])<.001?(Ze=0,Ke=-dn(Math.atan2(i[3],i[4]))):(Ze=dn(i[5]===0&&i[8]===0?0:Math.atan2(i[5],i[8])),Ke=dn(i[1]===0&&i[0]===0?0:Math.atan2(i[1],i[0]))),{roll:Ze,pitch:Ce+90,bearing:Ke}},y.be=function(s,i){return s.roll==i.roll&&s.pitch==i.pitch&&s.bearing==i.bearing},y.bf=xn,y.bg=Yi,y.bh=na,y.bi=no,y.bj=df,y.bk=Qe,y.bl=dt,y.bm=Gr,y.bn=function(s,i,o,f,_){return Qe(f,_,jt((s-i)/(o-i),0,1))},y.bo=De,y.bp=function(){return new Float64Array(3)},y.bq=function(s,i,o,f){return s[0]=i[0]+o[0]*f,s[1]=i[1]+o[1]*f,s[2]=i[2]+o[2]*f,s},y.br=Ue,y.bs=function(s,i,o){var f=o[0],_=o[1],T=o[2],S=o[3],M=i[0],D=i[1],L=i[2],N=_*L-T*D,V=T*M-f*L,Y=f*D-_*M;return s[0]=M+S*(N+=N)+_*(Y+=Y)-T*(V+=V),s[1]=D+S*V+T*N-f*Y,s[2]=L+S*Y+f*V-_*N,s},y.bt=function(s,i,o){const f=(_=[s[0],s[1],s[2],i[0],i[1],i[2],o[0],o[1],o[2]])[0]*((N=_[8])*(S=_[4])-(M=_[5])*(L=_[7]))+_[1]*(-N*(T=_[3])+M*(D=_[6]))+_[2]*(L*T-S*D);var _,T,S,M,D,L,N;if(f===0)return null;const V=Et([],[i[0],i[1],i[2]],[o[0],o[1],o[2]]),Y=Et([],[o[0],o[1],o[2]],[s[0],s[1],s[2]]),H=Et([],[s[0],s[1],s[2]],[i[0],i[1],i[2]]),W=Je([],V,-s[3]);return Ee(W,W,Je([],Y,-i[3])),Ee(W,W,Je([],H,-o[3])),Je(W,W,1/f),W},y.bu=Vp,y.bv=function(){return new Float64Array(4)},y.bw=function(s,i,o,f){var _=[],T=[];return _[0]=i[0]-o[0],_[1]=i[1]-o[1],_[2]=i[2]-o[2],T[0]=_[0]*Math.cos(f)-_[1]*Math.sin(f),T[1]=_[0]*Math.sin(f)+_[1]*Math.cos(f),T[2]=_[2],s[0]=T[0]+o[0],s[1]=T[1]+o[1],s[2]=T[2]+o[2],s},y.bx=function(s,i,o,f){var _=[],T=[];return _[0]=i[0]-o[0],_[1]=i[1]-o[1],_[2]=i[2]-o[2],T[0]=_[0],T[1]=_[1]*Math.cos(f)-_[2]*Math.sin(f),T[2]=_[1]*Math.sin(f)+_[2]*Math.cos(f),s[0]=T[0]+o[0],s[1]=T[1]+o[1],s[2]=T[2]+o[2],s},y.by=function(s,i,o,f){var _=[],T=[];return _[0]=i[0]-o[0],_[1]=i[1]-o[1],_[2]=i[2]-o[2],T[0]=_[2]*Math.sin(f)+_[0]*Math.cos(f),T[1]=_[1],T[2]=_[2]*Math.cos(f)-_[0]*Math.sin(f),s[0]=T[0]+o[0],s[1]=T[1]+o[1],s[2]=T[2]+o[2],s},y.bz=function(s,i,o){var f=Math.sin(o),_=Math.cos(o),T=i[0],S=i[1],M=i[2],D=i[3],L=i[8],N=i[9],V=i[10],Y=i[11];return i!==s&&(s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=T*_-L*f,s[1]=S*_-N*f,s[2]=M*_-V*f,s[3]=D*_-Y*f,s[8]=T*f+L*_,s[9]=S*f+N*_,s[10]=M*f+V*_,s[11]=D*f+Y*_,s},y.c=ee,y.c0=class extends rf{},y.c1=ky,y.c2=class extends t{},y.c3=yl,y.c4=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},y.c5=by,y.c6=function(s,i,o){var f=i[0],_=i[1],T=i[2],S=o[3]*f+o[7]*_+o[11]*T+o[15];return s[0]=(o[0]*f+o[4]*_+o[8]*T+o[12])/(S=S||1),s[1]=(o[1]*f+o[5]*_+o[9]*T+o[13])/S,s[2]=(o[2]*f+o[6]*_+o[10]*T+o[14])/S,s},y.c7=class extends Hc{},y.c8=class extends O{},y.c9=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]&&s[3]===i[3]&&s[4]===i[4]&&s[5]===i[5]&&s[6]===i[6]&&s[7]===i[7]&&s[8]===i[8]&&s[9]===i[9]&&s[10]===i[10]&&s[11]===i[11]&&s[12]===i[12]&&s[13]===i[13]&&s[14]===i[14]&&s[15]===i[15]},y.cA=function(s,i){te.REGISTERED_PROTOCOLS[s]=i},y.cB=function(s){delete te.REGISTERED_PROTOCOLS[s]},y.cC=function(s,i){const o={};for(let _=0;_<s.length;_++){const T=i&&i[s[_].id]||Bo(s[_]);i&&(i[s[_].id]=T);let S=o[T];S||(S=o[T]=[]),S.push(s[_])}const f=[];for(const _ in o)f.push(o[_]);return f},y.cD=Rt,y.cE=Jy,y.cF=og,y.cG=Fy,y.cH=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=ut/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const i=s.bucket.layers[0],o=i.layout,f=i._unevaluatedLayout._values,_={layoutIconSize:f["icon-size"].possiblyEvaluate(new ci(s.bucket.zoom+1),s.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new ci(s.bucket.zoom+1),s.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new ci(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:L,maxZoom:N}=s.bucket.textSizeData;_.compositeTextSizes=[f["text-size"].possiblyEvaluate(new ci(L),s.canonical),f["text-size"].possiblyEvaluate(new ci(N),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:L,maxZoom:N}=s.bucket.iconSizeData;_.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new ci(L),s.canonical),f["icon-size"].possiblyEvaluate(new ci(N),s.canonical)]}const T=o.get("text-line-height")*rr,S=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",M=o.get("text-keep-upright"),D=o.get("text-size");for(const L of s.bucket.features){const N=o.get("text-font").evaluate(L,{},s.canonical).join(","),V=D.evaluate(L,{},s.canonical),Y=_.layoutTextSize.evaluate(L,{},s.canonical),H=_.layoutIconSize.evaluate(L,{},s.canonical),W={horizontal:{},vertical:void 0},ae=L.text;let le,pe=[0,0];if(ae){const Ce=ae.toString(),Ze=o.get("text-letter-spacing").evaluate(L,{},s.canonical)*rr,Ke=gp(Ce)?Ze:0,ft=o.get("text-anchor").evaluate(L,{},s.canonical),Dt=r_(i,L,s.canonical);if(!Dt){const At=o.get("text-radial-offset").evaluate(L,{},s.canonical);pe=At?dg(ft,[At*rr,Ao]):o.get("text-offset").evaluate(L,{},s.canonical).map(Ct=>Ct*rr)}let St=S?"center":o.get("text-justify").evaluate(L,{},s.canonical);const Mt=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(L,{},s.canonical)*rr:1/0,$t=()=>{s.bucket.allowVerticalPlacement&&Rs(Ce)&&(W.vertical=zp(ae,s.glyphMap,s.glyphPositions,s.imagePositions,N,Mt,T,ft,"left",Ke,pe,y.ao.vertical,!0,Y,V))};if(!S&&Dt){const At=new Set;if(St==="auto")for(let at=0;at<Dt.values.length;at+=2)At.add(fg(Dt.values[at]));else At.add(St);let Ct=!1;for(const at of At)if(!W.horizontal[at])if(Ct)W.horizontal[at]=W.horizontal[0];else{const Qt=zp(ae,s.glyphMap,s.glyphPositions,s.imagePositions,N,Mt,T,"center",at,Ke,pe,y.ao.horizontal,!1,Y,V);Qt&&(W.horizontal[at]=Qt,Ct=Qt.positionedLines.length===1)}$t()}else{St==="auto"&&(St=fg(ft));const At=zp(ae,s.glyphMap,s.glyphPositions,s.imagePositions,N,Mt,T,ft,St,Ke,pe,y.ao.horizontal,!1,Y,V);At&&(W.horizontal[St]=At),$t(),Rs(Ce)&&S&&M&&(W.vertical=zp(ae,s.glyphMap,s.glyphPositions,s.imagePositions,N,Mt,T,ft,St,Ke,pe,y.ao.vertical,!1,Y,V))}}let Ne=!1;if(L.icon&&L.icon.name){const Ce=s.imageMap[L.icon.name];Ce&&(le=vf(s.imagePositions[L.icon.name],o.get("icon-offset").evaluate(L,{},s.canonical),o.get("icon-anchor").evaluate(L,{},s.canonical)),Ne=!!Ce.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=Ne:s.bucket.sdfIcons!==Ne&&Ln("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ce.pixelRatio!==s.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ve=Ko(W.horizontal)||W.vertical;s.bucket.iconsInText=!!ve&&ve.iconsInText,(ve||le)&&lv(s.bucket,L,W,le,s.imageMap,_,Y,H,pe,Ne,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},y.cI=Ip,y.cJ=Mi,y.cK=nd,y.cL=Dy,y.cM=La,y.cN=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},y.cO=function(s,i,o,f,_){return c(this,void 0,void 0,function*(){if(ue())try{return yield Ea(s,i,o,f,_)}catch{}return function(T,S,M,D,L){const N=T.width,V=T.height;Ua&&ga||(Ua=new OffscreenCanvas(N,V),ga=Ua.getContext("2d",{willReadFrequently:!0})),Ua.width=N,Ua.height=V,ga.drawImage(T,0,0,N,V);const Y=ga.getImageData(S,M,D,L);return ga.clearRect(0,0,N,V),Y.data}(s,i,o,f,_)})},y.cP=cf,y.cQ=C,y.cR=Cy,y.cS=Kh,y.cT=kh,y.cU=function(s,i){const o=new Map;if(s!=null)if(s.type==="Feature")o.set(Pr(s,i),s);else for(const f of s.features)o.set(Pr(f,i),f);return o},y.cV=function(s,i){if(s==null)return!0;if(s.type==="Feature")return Pr(s,i)!=null;if(s.type==="FeatureCollection"){const o=new Set;for(const f of s.features){const _=Pr(f,i);if(_==null||o.has(_))return!1;o.add(_)}return!0}return!1},y.cW=function(s,i,o){var f,_,T,S;if(i.removeAll&&s.clear(),i.remove)for(const M of i.remove)s.delete(M);if(i.add)for(const M of i.add){const D=Pr(M,o);D!=null&&s.set(D,M)}if(i.update)for(const M of i.update){let D=s.get(M.id);if(D==null)continue;const L=!M.removeAllProperties&&(((f=M.removeProperties)===null||f===void 0?void 0:f.length)>0||((_=M.addOrUpdateProperties)===null||_===void 0?void 0:_.length)>0);if((M.newGeometry||M.removeAllProperties||L)&&(D=Object.assign({},D),s.set(M.id,D),L&&(D.properties=Object.assign({},D.properties))),M.newGeometry&&(D.geometry=M.newGeometry),M.removeAllProperties)D.properties={};else if(((T=M.removeProperties)===null||T===void 0?void 0:T.length)>0)for(const N of M.removeProperties)Object.prototype.hasOwnProperty.call(D.properties,N)&&delete D.properties[N];if(((S=M.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0)for(const{key:N,value:V}of M.addOrUpdateProperties)D.properties[N]=V}},y.cX=ks,y.ca=function(s,i){var o=s[0],f=s[1],_=s[2],T=s[3],S=s[4],M=s[5],D=s[6],L=s[7],N=s[8],V=s[9],Y=s[10],H=s[11],W=s[12],ae=s[13],le=s[14],pe=s[15],Ne=i[0],ve=i[1],Ce=i[2],Ze=i[3],Ke=i[4],ft=i[5],Dt=i[6],St=i[7],Mt=i[8],$t=i[9],At=i[10],Ct=i[11],at=i[12],Qt=i[13],nn=i[14],Xt=i[15];return Math.abs(o-Ne)<=Ae*Math.max(1,Math.abs(o),Math.abs(Ne))&&Math.abs(f-ve)<=Ae*Math.max(1,Math.abs(f),Math.abs(ve))&&Math.abs(_-Ce)<=Ae*Math.max(1,Math.abs(_),Math.abs(Ce))&&Math.abs(T-Ze)<=Ae*Math.max(1,Math.abs(T),Math.abs(Ze))&&Math.abs(S-Ke)<=Ae*Math.max(1,Math.abs(S),Math.abs(Ke))&&Math.abs(M-ft)<=Ae*Math.max(1,Math.abs(M),Math.abs(ft))&&Math.abs(D-Dt)<=Ae*Math.max(1,Math.abs(D),Math.abs(Dt))&&Math.abs(L-St)<=Ae*Math.max(1,Math.abs(L),Math.abs(St))&&Math.abs(N-Mt)<=Ae*Math.max(1,Math.abs(N),Math.abs(Mt))&&Math.abs(V-$t)<=Ae*Math.max(1,Math.abs(V),Math.abs($t))&&Math.abs(Y-At)<=Ae*Math.max(1,Math.abs(Y),Math.abs(At))&&Math.abs(H-Ct)<=Ae*Math.max(1,Math.abs(H),Math.abs(Ct))&&Math.abs(W-at)<=Ae*Math.max(1,Math.abs(W),Math.abs(at))&&Math.abs(ae-Qt)<=Ae*Math.max(1,Math.abs(ae),Math.abs(Qt))&&Math.abs(le-nn)<=Ae*Math.max(1,Math.abs(le),Math.abs(nn))&&Math.abs(pe-Xt)<=Ae*Math.max(1,Math.abs(pe),Math.abs(Xt))},y.cb=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},y.cc=s=>s.type==="symbol",y.cd=s=>s.type==="circle",y.ce=s=>s.type==="heatmap",y.cf=s=>s.type==="line",y.cg=s=>s.type==="fill",y.ch=s=>s.type==="fill-extrusion",y.ci=s=>s.type==="hillshade",y.cj=s=>s.type==="color-relief",y.ck=s=>s.type==="background",y.cl=s=>s.type==="custom",y.cm=_t,y.cn=function(s,i,o){const f=xt(i.x-o.x,i.y-o.y),_=xt(s.x-o.x,s.y-o.y);var T,S;return dn(Math.atan2(f[0]*_[1]-f[1]*_[0],(T=f)[0]*(S=_)[0]+T[1]*S[1]))},y.co=Ot,y.cp=function(s,i){return ur[i]&&(s instanceof MouseEvent||s instanceof WheelEvent)},y.cq=function(s,i){return Mr[i]&&"touches"in s},y.cr=function(s){return Mr[s]||ur[s]},y.cs=function(s,i,o){var f=i[0],_=i[1];return s[0]=o[0]*f+o[4]*_+o[12],s[1]=o[1]*f+o[5]*_+o[13],s},y.ct=function(s,i){const{x:o,y:f}=$p.fromLngLat(i);return!(s<0||s>25||f<0||f>=1||o<0||o>=1)},y.cu=function(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},y.cv=class extends Ui{},y.cw=dv,y.cy=function(s){return s.message===Pe},y.cz=we,y.d=je,y.e=cn,y.f=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(i)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),y.g=ce,y.h=s=>new Promise((i,o)=>{const f=new Image;f.onload=()=>{i(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Br})},f.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(s)],{type:"image/png"});f.src=s.byteLength?URL.createObjectURL(_):Br}),y.i=gr,y.j=(s,i)=>Ge(cn(s,{type:"json"}),i),y.k=Nt,y.l=rt,y.m=Ge,y.n=(s,i)=>Ge(cn(s,{type:"arrayBuffer"}),i),y.o=function(s){return new La(s).readFields(Wm,[])},y.p=X0,y.q=sf,y.r=Si,y.s=Oi,y.t=Vh,y.u=yn,y.v=Be,y.w=Ln,y.x=fy,y.y=ql,y.z=Qa}),d("worker",["./shared"],function(y){class c{constructor(ee,te){this.keyCache={},ee&&this.replace(ee,te)}replace(ee,te){this._layerConfigs={},this._layers={},this.update(ee,[],te)}update(ee,te,ce){for(const we of ee){this._layerConfigs[we.id]=we;const Oe=this._layers[we.id]=y.bJ(we,ce);Oe._featureFilter=y.aa(Oe.filter,ce),this.keyCache[we.id]&&delete this.keyCache[we.id]}for(const we of te)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const xe=y.cC(Object.values(this._layerConfigs),this.keyCache);for(const we of xe){const Oe=we.map(Nt=>this._layers[Nt.id]),Ge=Oe[0];if(Ge.visibility==="none")continue;const je=Ge.source||"";let tt=this.familiesBySource[je];tt||(tt=this.familiesBySource[je]={});const yt=Ge.sourceLayer||"_geojsonTileLayer";let rt=tt[yt];rt||(rt=tt[yt]=[]),rt.push(Oe)}}}class E{constructor(ee){const te={},ce=[];for(const Ge in ee){const je=ee[Ge],tt=te[Ge]={};for(const yt in je){const rt=je[+yt];if(!rt||rt.bitmap.width===0||rt.bitmap.height===0)continue;const Nt={x:0,y:0,w:rt.bitmap.width+2,h:rt.bitmap.height+2};ce.push(Nt),tt[yt]={rect:Nt,metrics:rt.metrics}}}const{w:xe,h:we}=y.p(ce),Oe=new y.q({width:xe||1,height:we||1});for(const Ge in ee){const je=ee[Ge];for(const tt in je){const yt=je[+tt];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const rt=te[Ge][tt].rect;y.q.copy(yt.bitmap,Oe,{x:0,y:0},{x:rt.x+1,y:rt.y+1},yt.bitmap)}}this.image=Oe,this.positions=te}}y.cD("GlyphAtlas",E);class C{constructor(ee){this.tileID=new y.Z(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,te,ce,xe,we){return y._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new y.a8;const Oe=new y.cE(Object.keys(ee.layers).sort()),Ge=new y.cF(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];const je={},tt={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ce,subdivisionGranularity:we},yt=te.familiesBySource[this.source];for(const Kn in yt){const pt=ee.layers[Kn];if(!pt)continue;pt.version===1&&y.w(`Vector tile source "${this.source}" layer "${Kn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Lo=Oe.encode(Kn),Aa=[];for(let vr=0;vr<pt.length;vr++){const $n=pt.feature(vr),vt=Ge.getId($n,Kn);Aa.push({feature:$n,id:vt,index:vr,sourceLayerIndex:Lo})}for(const vr of yt[Kn]){const $n=vr[0];$n.source!==this.source&&y.w(`layer.source = ${$n.source} does not equal this.source = ${this.source}`),$n.minzoom&&this.zoom<Math.floor($n.minzoom)||$n.maxzoom&&this.zoom>=$n.maxzoom||$n.visibility!=="none"&&(k(vr,this.zoom,ce),(je[$n.id]=$n.createBucket({index:Ge.bucketLayerIDs.length,layers:vr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Lo,sourceID:this.source})).populate(Aa,tt,this.tileID.canonical),Ge.bucketLayerIDs.push(vr.map(vt=>vt.id)))}}const rt=y.bO(tt.glyphDependencies,Kn=>Object.keys(Kn).map(Number));this.inFlightDependencies.forEach(Kn=>Kn?.abort()),this.inFlightDependencies=[];let Nt=Promise.resolve({});if(Object.keys(rt).length){const Kn=new AbortController;this.inFlightDependencies.push(Kn),Nt=xe.sendAsync({type:"GG",data:{stacks:rt,source:this.source,tileID:this.tileID,type:"glyphs"}},Kn)}const Ht=Object.keys(tt.iconDependencies);let Be=Promise.resolve({});if(Ht.length){const Kn=new AbortController;this.inFlightDependencies.push(Kn),Be=xe.sendAsync({type:"GI",data:{icons:Ht,source:this.source,tileID:this.tileID,type:"icons"}},Kn)}const Cn=Object.keys(tt.patternDependencies);let Un=Promise.resolve({});if(Cn.length){const Kn=new AbortController;this.inFlightDependencies.push(Kn),Un=xe.sendAsync({type:"GI",data:{icons:Cn,source:this.source,tileID:this.tileID,type:"patterns"}},Kn)}const Vt=tt.dashDependencies;let jn=Promise.resolve({});if(Object.keys(Vt).length){const Kn=new AbortController;this.inFlightDependencies.push(Kn),jn=xe.sendAsync({type:"GDA",data:{dashes:Vt}},Kn)}const[hr,Wi,yr,Ur]=yield Promise.all([Nt,Be,Un,jn]),pi=new E(hr),_r=new y.cG(Wi,yr);for(const Kn in je){const pt=je[Kn];pt instanceof y.a9?(k(pt.layers,this.zoom,ce),y.cH({bucket:pt,glyphMap:hr,glyphPositions:pi.positions,imageMap:Wi,imagePositions:_r.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:tt.subdivisionGranularity})):pt.hasDependencies&&(pt instanceof y.cI||pt instanceof y.cJ||pt instanceof y.cK)&&(k(pt.layers,this.zoom,ce),pt.addFeatures(tt,this.tileID.canonical,_r.patternPositions,Ur))}return this.status="done",{buckets:Object.values(je).filter(Kn=>!Kn.isEmpty()),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pi.image,imageAtlas:_r,dashPositions:Ur,glyphMap:this.returnDependencies?hr:null,iconMap:this.returnDependencies?Wi:null,glyphPositions:this.returnDependencies?pi.positions:null}})}}function k(Pe,ee,te){const ce=new y.F(ee);for(const xe of Pe)xe.recalculate(ce,te)}class z{constructor(ee,te,ce){this.actor=ee,this.layerIndex=te,this.availableImages=ce,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,te){return y._(this,void 0,void 0,function*(){const ce=yield y.n(ee.request,te);try{return{vectorTile:new y.cL(new y.cM(ce.data)),rawData:ce.data,cacheControl:ce.cacheControl,expires:ce.expires}}catch(xe){const we=new Uint8Array(ce.data);let Oe=`Unable to parse the tile at ${ee.request.url}, `;throw Oe+=we[0]===31&&we[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${xe.message}`,new Error(Oe)}})}loadTile(ee){return y._(this,void 0,void 0,function*(){const te=ee.uid,ce=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new y.cN(ee.request),xe=new C(ee);this.loading[te]=xe;const we=new AbortController;xe.abort=we;try{const Oe=yield this.loadVectorTile(ee,we);if(delete this.loading[te],!Oe)return null;const Ge=Oe.rawData,je={};Oe.expires&&(je.expires=Oe.expires),Oe.cacheControl&&(je.cacheControl=Oe.cacheControl);const tt={};if(ce){const rt=ce.finish();rt&&(tt.resourceTiming=JSON.parse(JSON.stringify(rt)))}xe.vectorTile=Oe.vectorTile;const yt=xe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[te]=xe,this.fetching[te]={rawTileData:Ge,cacheControl:je,resourceTiming:tt};try{const rt=yield yt;return y.e({rawTileData:Ge.slice(0)},rt,je,tt)}finally{delete this.fetching[te]}}catch(Oe){throw delete this.loading[te],xe.status="done",this.loaded[te]=xe,Oe}})}reloadTile(ee){return y._(this,void 0,void 0,function*(){const te=ee.uid;if(!this.loaded||!this.loaded[te])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ce=this.loaded[te];if(ce.showCollisionBoxes=ee.showCollisionBoxes,ce.status==="parsing"){const xe=yield ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let we;if(this.fetching[te]){const{rawTileData:Oe,cacheControl:Ge,resourceTiming:je}=this.fetching[te];delete this.fetching[te],we=y.e({rawTileData:Oe.slice(0)},xe,Ge,je)}else we=xe;return we}if(ce.status==="done"&&ce.vectorTile)return ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return y._(this,void 0,void 0,function*(){const te=this.loading,ce=ee.uid;te&&te[ce]&&te[ce].abort&&(te[ce].abort.abort(),delete te[ce])})}removeTile(ee){return y._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class F{constructor(){this.loaded={}}loadTile(ee){return y._(this,void 0,void 0,function*(){const{uid:te,encoding:ce,rawImageData:xe,redFactor:we,greenFactor:Oe,blueFactor:Ge,baseShift:je}=ee,tt=xe.width+2,yt=xe.height+2,rt=y.b(xe)?new y.R({width:tt,height:yt},yield y.cO(xe,-1,-1,tt,yt)):xe,Nt=new y.cP(te,rt,ce,we,Oe,Ge,je);return this.loaded=this.loaded||{},this.loaded[te]=Nt,Nt})}removeTile(ee){const te=this.loaded,ce=ee.uid;te&&te[ce]&&delete te[ce]}}var B,Q,ie=function(){if(Q)return B;function Pe(te,ce){if(te.length!==0){ee(te[0],ce);for(var xe=1;xe<te.length;xe++)ee(te[xe],!ce)}}function ee(te,ce){for(var xe=0,we=0,Oe=0,Ge=te.length,je=Ge-1;Oe<Ge;je=Oe++){var tt=(te[Oe][0]-te[je][0])*(te[je][1]+te[Oe][1]),yt=xe+tt;we+=Math.abs(xe)>=Math.abs(tt)?xe-yt+tt:tt-yt+xe,xe=yt}xe+we>=0!=!!ce&&te.reverse()}return Q=1,B=function te(ce,xe){var we,Oe=ce&&ce.type;if(Oe==="FeatureCollection")for(we=0;we<ce.features.length;we++)te(ce.features[we],xe);else if(Oe==="GeometryCollection")for(we=0;we<ce.geometries.length;we++)te(ce.geometries[we],xe);else if(Oe==="Feature")te(ce.geometry,xe);else if(Oe==="Polygon")Pe(ce.coordinates,xe);else if(Oe==="MultiPolygon")for(we=0;we<ce.coordinates.length;we++)Pe(ce.coordinates[we],xe);return ce}}(),ne=y.cQ(ie);class ue extends y.cS{constructor(ee,te){super(new y.cM,0,te,[],[]),this.feature=ee,this.type=ee.type,this.properties=ee.tags?ee.tags:{},"id"in ee&&(typeof ee.id=="string"?this.id=parseInt(ee.id,10):typeof ee.id!="number"||isNaN(ee.id)||(this.id=ee.id))}loadGeometry(){const ee=[],te=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ce of te){const xe=[];for(const we of ce)xe.push(new y.P(we[0],we[1]));ee.push(xe)}return ee}}class Ae extends y.cR{constructor(ee,te){super(new y.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=te?te.version:1,this.extent=te?te.extent:4096,this.length=ee.length,this.features=ee}feature(ee){return new ue(this.features[ee],this.extent)}}function Te(Pe,ee){ee.writeVarintField(15,Pe.version||1),ee.writeStringField(1,Pe.name||""),ee.writeVarintField(5,Pe.extent||4096);const te={keys:[],values:[],keycache:{},valuecache:{}};for(let we=0;we<Pe.length;we++)te.feature=Pe.feature(we),ee.writeMessage(2,ke,te);const ce=te.keys;for(const we of ce)ee.writeStringField(3,we);const xe=te.values;for(const we of xe)ee.writeMessage(4,Ee,we)}function ke(Pe,ee){if(!Pe.feature)return;const te=Pe.feature;te.id!==void 0&&ee.writeVarintField(1,te.id),ee.writeMessage(2,be,Pe),ee.writeVarintField(3,te.type),ee.writeMessage(4,ot,te)}function be(Pe,ee){for(const te in Pe.feature?.properties){let ce=Pe.feature.properties[te],xe=Pe.keycache[te];if(ce===null)continue;xe===void 0&&(Pe.keys.push(te),xe=Pe.keys.length-1,Pe.keycache[te]=xe),ee.writeVarint(xe),typeof ce!="string"&&typeof ce!="boolean"&&typeof ce!="number"&&(ce=JSON.stringify(ce));const we=typeof ce+":"+ce;let Oe=Pe.valuecache[we];Oe===void 0&&(Pe.values.push(ce),Oe=Pe.values.length-1,Pe.valuecache[we]=Oe),ee.writeVarint(Oe)}}function Me(Pe,ee){return(ee<<3)+(7&Pe)}function Fe(Pe){return Pe<<1^Pe>>31}function ot(Pe,ee){const te=Pe.loadGeometry(),ce=Pe.type;let xe=0,we=0;for(const Oe of te){let Ge=1;ce===1&&(Ge=Oe.length),ee.writeVarint(Me(1,Ge));const je=ce===3?Oe.length-1:Oe.length;for(let tt=0;tt<je;tt++){tt===1&&ce!==1&&ee.writeVarint(Me(2,je-1));const yt=Oe[tt].x-xe,rt=Oe[tt].y-we;ee.writeVarint(Fe(yt)),ee.writeVarint(Fe(rt)),xe+=yt,we+=rt}Pe.type===3&&ee.writeVarint(Me(7,1))}}function Ee(Pe,ee){const te=typeof Pe;te==="string"?ee.writeStringField(1,Pe):te==="boolean"?ee.writeBooleanField(7,Pe):te==="number"&&(Pe%1!=0?ee.writeDoubleField(3,Pe):Pe<0?ee.writeSVarintField(6,Pe):ee.writeVarintField(5,Pe))}const Je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Pe=>Pe},Et=Math.fround||(Tt=new Float32Array(1),Pe=>(Tt[0]=+Pe,Tt[0]));var Tt;class zt{constructor(ee){this.options=Object.assign(Object.create(Je),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:te,minZoom:ce,maxZoom:xe}=this.options;te&&console.time("total time");const we=`prepare ${ee.length} points`;te&&console.time(we),this.points=ee;const Oe=[];for(let je=0;je<ee.length;je++){const tt=ee[je];if(!tt.geometry)continue;const[yt,rt]=tt.geometry.coordinates,Nt=Et(Ue(yt)),Ht=Et(st(rt));Oe.push(Nt,Ht,1/0,je,-1,1),this.options.reduce&&Oe.push(0)}let Ge=this.trees[xe+1]=this._createTree(Oe);te&&console.timeEnd(we);for(let je=xe;je>=ce;je--){const tt=+Date.now();Ge=this.trees[je]=this._createTree(this._cluster(Ge,je)),te&&console.log("z%d: %d clusters in %dms",je,Ge.numItems,+Date.now()-tt)}return te&&console.timeEnd("total time"),this}getClusters(ee,te){let ce=((ee[0]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,ee[1]));let we=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ce=-180,we=180;else if(ce>we){const rt=this.getClusters([ce,xe,180,Oe],te),Nt=this.getClusters([-180,xe,we,Oe],te);return rt.concat(Nt)}const Ge=this.trees[this._limitZoom(te)],je=Ge.range(Ue(ce),st(Oe),Ue(we),st(xe)),tt=Ge.data,yt=[];for(const rt of je){const Nt=this.stride*rt;yt.push(tt[Nt+5]>1?Zt(tt,Nt,this.clusterProps):this.points[tt[Nt+3]])}return yt}getChildren(ee){const te=this._getOriginId(ee),ce=this._getOriginZoom(ee),xe="No cluster with the specified id.",we=this.trees[ce];if(!we)throw new Error(xe);const Oe=we.data;if(te*this.stride>=Oe.length)throw new Error(xe);const Ge=this.options.radius/(this.options.extent*Math.pow(2,ce-1)),je=we.within(Oe[te*this.stride],Oe[te*this.stride+1],Ge),tt=[];for(const yt of je){const rt=yt*this.stride;Oe[rt+4]===ee&&tt.push(Oe[rt+5]>1?Zt(Oe,rt,this.clusterProps):this.points[Oe[rt+3]])}if(tt.length===0)throw new Error(xe);return tt}getLeaves(ee,te,ce){const xe=[];return this._appendLeaves(xe,ee,te=te||10,ce=ce||0,0),xe}getTile(ee,te,ce){const xe=this.trees[this._limitZoom(ee)],we=Math.pow(2,ee),{extent:Oe,radius:Ge}=this.options,je=Ge/Oe,tt=(ce-je)/we,yt=(ce+1+je)/we,rt={features:[]};return this._addTileFeatures(xe.range((te-je)/we,tt,(te+1+je)/we,yt),xe.data,te,ce,we,rt),te===0&&this._addTileFeatures(xe.range(1-je/we,tt,1,yt),xe.data,we,ce,we,rt),te===we-1&&this._addTileFeatures(xe.range(0,tt,je/we,yt),xe.data,-1,ce,we,rt),rt.features.length?rt:null}getClusterExpansionZoom(ee){let te=this._getOriginZoom(ee)-1;for(;te<=this.options.maxZoom;){const ce=this.getChildren(ee);if(te++,ce.length!==1)break;ee=ce[0].properties.cluster_id}return te}_appendLeaves(ee,te,ce,xe,we){const Oe=this.getChildren(te);for(const Ge of Oe){const je=Ge.properties;if(je&&je.cluster?we+je.point_count<=xe?we+=je.point_count:we=this._appendLeaves(ee,je.cluster_id,ce,xe,we):we<xe?we++:ee.push(Ge),ee.length===ce)break}return we}_createTree(ee){const te=new y.aI(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ce=0;ce<ee.length;ce+=this.stride)te.add(ee[ce],ee[ce+1]);return te.finish(),te.data=ee,te}_addTileFeatures(ee,te,ce,xe,we,Oe){for(const Ge of ee){const je=Ge*this.stride,tt=te[je+5]>1;let yt,rt,Nt;if(tt)yt=Gt(te,je,this.clusterProps),rt=te[je],Nt=te[je+1];else{const Cn=this.points[te[je+3]];yt=Cn.properties;const[Un,Vt]=Cn.geometry.coordinates;rt=Ue(Un),Nt=st(Vt)}const Ht={type:1,geometry:[[Math.round(this.options.extent*(rt*we-ce)),Math.round(this.options.extent*(Nt*we-xe))]],tags:yt};let Be;Be=tt||this.options.generateId?te[je+3]:this.points[te[je+3]].id,Be!==void 0&&(Ht.id=Be),Oe.features.push(Ht)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,te){const{radius:ce,extent:xe,reduce:we,minPoints:Oe}=this.options,Ge=ce/(xe*Math.pow(2,te)),je=ee.data,tt=[],yt=this.stride;for(let rt=0;rt<je.length;rt+=yt){if(je[rt+2]<=te)continue;je[rt+2]=te;const Nt=je[rt],Ht=je[rt+1],Be=ee.within(je[rt],je[rt+1],Ge),Cn=je[rt+5];let Un=Cn;for(const Vt of Be){const jn=Vt*yt;je[jn+2]>te&&(Un+=je[jn+5])}if(Un>Cn&&Un>=Oe){let Vt,jn=Nt*Cn,hr=Ht*Cn,Wi=-1;const yr=(rt/yt<<5)+(te+1)+this.points.length;for(const Ur of Be){const pi=Ur*yt;if(je[pi+2]<=te)continue;je[pi+2]=te;const _r=je[pi+5];jn+=je[pi]*_r,hr+=je[pi+1]*_r,je[pi+4]=yr,we&&(Vt||(Vt=this._map(je,rt,!0),Wi=this.clusterProps.length,this.clusterProps.push(Vt)),we(Vt,this._map(je,pi)))}je[rt+4]=yr,tt.push(jn/Un,hr/Un,1/0,yr,-1,Un),we&&tt.push(Wi)}else{for(let Vt=0;Vt<yt;Vt++)tt.push(je[rt+Vt]);if(Un>1)for(const Vt of Be){const jn=Vt*yt;if(!(je[jn+2]<=te)){je[jn+2]=te;for(let hr=0;hr<yt;hr++)tt.push(je[jn+hr])}}}}return tt}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,te,ce){if(ee[te+5]>1){const Oe=this.clusterProps[ee[te+6]];return ce?Object.assign({},Oe):Oe}const xe=this.points[ee[te+3]].properties,we=this.options.map(xe);return ce&&we===xe?Object.assign({},we):we}}function Zt(Pe,ee,te){return{type:"Feature",id:Pe[ee+3],properties:Gt(Pe,ee,te),geometry:{type:"Point",coordinates:[(ce=Pe[ee],360*(ce-.5)),xt(Pe[ee+1])]}};var ce}function Gt(Pe,ee,te){const ce=Pe[ee+5],xe=ce>=1e4?`${Math.round(ce/1e3)}k`:ce>=1e3?Math.round(ce/100)/10+"k":ce,we=Pe[ee+6],Oe=we===-1?{}:Object.assign({},te[we]);return Object.assign(Oe,{cluster:!0,cluster_id:Pe[ee+3],point_count:ce,point_count_abbreviated:xe})}function Ue(Pe){return Pe/360+.5}function st(Pe){const ee=Math.sin(Pe*Math.PI/180),te=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return te<0?0:te>1?1:te}function xt(Pe){const ee=(180-360*Pe)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function ut(Pe,ee,te,ce){let xe=ce;const we=ee+(te-ee>>1);let Oe,Ge=te-ee;const je=Pe[ee],tt=Pe[ee+1],yt=Pe[te],rt=Pe[te+1];for(let Nt=ee+3;Nt<te;Nt+=3){const Ht=Ut(Pe[Nt],Pe[Nt+1],je,tt,yt,rt);if(Ht>xe)Oe=Nt,xe=Ht;else if(Ht===xe){const Be=Math.abs(Nt-we);Be<Ge&&(Oe=Nt,Ge=Be)}}xe>ce&&(Oe-ee>3&&ut(Pe,ee,Oe,ce),Pe[Oe+2]=xe,te-Oe>3&&ut(Pe,Oe,te,ce))}function Ut(Pe,ee,te,ce,xe,we){let Oe=xe-te,Ge=we-ce;if(Oe!==0||Ge!==0){const je=((Pe-te)*Oe+(ee-ce)*Ge)/(Oe*Oe+Ge*Ge);je>1?(te=xe,ce=we):je>0&&(te+=Oe*je,ce+=Ge*je)}return Oe=Pe-te,Ge=ee-ce,Oe*Oe+Ge*Ge}function De(Pe,ee,te,ce){const xe={id:Pe??null,type:ee,geometry:te,tags:ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Qe(xe,te);else if(ee==="Polygon")Qe(xe,te[0]);else if(ee==="MultiLineString")for(const we of te)Qe(xe,we);else if(ee==="MultiPolygon")for(const we of te)Qe(xe,we[0]);return xe}function Qe(Pe,ee){for(let te=0;te<ee.length;te+=3)Pe.minX=Math.min(Pe.minX,ee[te]),Pe.minY=Math.min(Pe.minY,ee[te+1]),Pe.maxX=Math.max(Pe.maxX,ee[te]),Pe.maxY=Math.max(Pe.maxY,ee[te+1])}function dt(Pe,ee,te,ce){if(!ee.geometry)return;const xe=ee.geometry.coordinates;if(xe&&xe.length===0)return;const we=ee.geometry.type,Oe=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2);let Ge=[],je=ee.id;if(te.promoteId?je=ee.properties[te.promoteId]:te.generateId&&(je=ce||0),we==="Point")_t(xe,Ge);else if(we==="MultiPoint")for(const tt of xe)_t(tt,Ge);else if(we==="LineString")Ot(xe,Ge,Oe,!1);else if(we==="MultiLineString"){if(te.lineMetrics){for(const tt of xe)Ge=[],Ot(tt,Ge,Oe,!1),Pe.push(De(je,"LineString",Ge,ee.properties));return}jt(xe,Ge,Oe,!1)}else if(we==="Polygon")jt(xe,Ge,Oe,!0);else{if(we!=="MultiPolygon"){if(we==="GeometryCollection"){for(const tt of ee.geometry.geometries)dt(Pe,{id:je,geometry:tt,properties:ee.properties},te,ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const tt of xe){const yt=[];jt(tt,yt,Oe,!0),Ge.push(yt)}}Pe.push(De(je,we,Ge,ee.properties))}function _t(Pe,ee){ee.push(Kt(Pe[0]),cn(Pe[1]),0)}function Ot(Pe,ee,te,ce){let xe,we,Oe=0;for(let je=0;je<Pe.length;je++){const tt=Kt(Pe[je][0]),yt=cn(Pe[je][1]);ee.push(tt,yt,0),je>0&&(Oe+=ce?(xe*yt-tt*we)/2:Math.sqrt(Math.pow(tt-xe,2)+Math.pow(yt-we,2))),xe=tt,we=yt}const Ge=ee.length-3;ee[2]=1,ut(ee,0,Ge,te),ee[Ge+2]=1,ee.size=Math.abs(Oe),ee.start=0,ee.end=ee.size}function jt(Pe,ee,te,ce){for(let xe=0;xe<Pe.length;xe++){const we=[];Ot(Pe[xe],we,te,ce),ee.push(we)}}function Kt(Pe){return Pe/360+.5}function cn(Pe){const ee=Math.sin(Pe*Math.PI/180),te=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return te<0?0:te>1?1:te}function mn(Pe,ee,te,ce,xe,we,Oe,Ge){if(ce/=ee,we>=(te/=ee)&&Oe<ce)return Pe;if(Oe<te||we>=ce)return null;const je=[];for(const tt of Pe){const yt=tt.geometry;let rt=tt.type;const Nt=xe===0?tt.minX:tt.minY,Ht=xe===0?tt.maxX:tt.maxY;if(Nt>=te&&Ht<ce){je.push(tt);continue}if(Ht<te||Nt>=ce)continue;let Be=[];if(rt==="Point"||rt==="MultiPoint")lr(yt,Be,te,ce,xe);else if(rt==="LineString")cr(yt,Be,te,ce,xe,!1,Ge.lineMetrics);else if(rt==="MultiLineString")Wn(yt,Be,te,ce,xe,!1);else if(rt==="Polygon")Wn(yt,Be,te,ce,xe,!0);else if(rt==="MultiPolygon")for(const Cn of yt){const Un=[];Wn(Cn,Un,te,ce,xe,!0),Un.length&&Be.push(Un)}if(Be.length){if(Ge.lineMetrics&&rt==="LineString"){for(const Cn of Be)je.push(De(tt.id,rt,Cn,tt.tags));continue}rt!=="LineString"&&rt!=="MultiLineString"||(Be.length===1?(rt="LineString",Be=Be[0]):rt="MultiLineString"),rt!=="Point"&&rt!=="MultiPoint"||(rt=Be.length===3?"Point":"MultiPoint"),je.push(De(tt.id,rt,Be,tt.tags))}}return je.length?je:null}function lr(Pe,ee,te,ce,xe){for(let we=0;we<Pe.length;we+=3){const Oe=Pe[we+xe];Oe>=te&&Oe<=ce&&Ln(ee,Pe[we],Pe[we+1],Pe[we+2])}}function cr(Pe,ee,te,ce,xe,we,Oe){let Ge=xi(Pe);const je=xe===0?Sn:gr;let tt,yt,rt=Pe.start;for(let Un=0;Un<Pe.length-3;Un+=3){const Vt=Pe[Un],jn=Pe[Un+1],hr=Pe[Un+2],Wi=Pe[Un+3],yr=Pe[Un+4],Ur=xe===0?Vt:jn,pi=xe===0?Wi:yr;let _r=!1;Oe&&(tt=Math.sqrt(Math.pow(Vt-Wi,2)+Math.pow(jn-yr,2))),Ur<te?pi>te&&(yt=je(Ge,Vt,jn,Wi,yr,te),Oe&&(Ge.start=rt+tt*yt)):Ur>ce?pi<ce&&(yt=je(Ge,Vt,jn,Wi,yr,ce),Oe&&(Ge.start=rt+tt*yt)):Ln(Ge,Vt,jn,hr),pi<te&&Ur>=te&&(yt=je(Ge,Vt,jn,Wi,yr,te),_r=!0),pi>ce&&Ur<=ce&&(yt=je(Ge,Vt,jn,Wi,yr,ce),_r=!0),!we&&_r&&(Oe&&(Ge.end=rt+tt*yt),ee.push(Ge),Ge=xi(Pe)),Oe&&(rt+=tt)}let Nt=Pe.length-3;const Ht=Pe[Nt],Be=Pe[Nt+1],Cn=xe===0?Ht:Be;Cn>=te&&Cn<=ce&&Ln(Ge,Ht,Be,Pe[Nt+2]),Nt=Ge.length-3,we&&Nt>=3&&(Ge[Nt]!==Ge[0]||Ge[Nt+1]!==Ge[1])&&Ln(Ge,Ge[0],Ge[1],Ge[2]),Ge.length&&ee.push(Ge)}function xi(Pe){const ee=[];return ee.size=Pe.size,ee.start=Pe.start,ee.end=Pe.end,ee}function Wn(Pe,ee,te,ce,xe,we){for(const Oe of Pe)cr(Oe,ee,te,ce,xe,we,!1)}function Ln(Pe,ee,te,ce){Pe.push(ee,te,ce)}function Sn(Pe,ee,te,ce,xe,we){const Oe=(we-ee)/(ce-ee);return Ln(Pe,we,te+(xe-te)*Oe,1),Oe}function gr(Pe,ee,te,ce,xe,we){const Oe=(we-te)/(xe-te);return Ln(Pe,ee+(ce-ee)*Oe,we,1),Oe}function oa(Pe,ee){const te=[];for(let ce=0;ce<Pe.length;ce++){const xe=Pe[ce],we=xe.type;let Oe;if(we==="Point"||we==="MultiPoint"||we==="LineString")Oe=po(xe.geometry,ee);else if(we==="MultiLineString"||we==="Polygon"){Oe=[];for(const Ge of xe.geometry)Oe.push(po(Ge,ee))}else if(we==="MultiPolygon"){Oe=[];for(const Ge of xe.geometry){const je=[];for(const tt of Ge)je.push(po(tt,ee));Oe.push(je)}}te.push(De(xe.id,we,Oe,xe.tags))}return te}function po(Pe,ee){const te=[];te.size=Pe.size,Pe.start!==void 0&&(te.start=Pe.start,te.end=Pe.end);for(let ce=0;ce<Pe.length;ce+=3)te.push(Pe[ce]+ee,Pe[ce+1],Pe[ce+2]);return te}function Ar(Pe,ee){if(Pe.transformed)return Pe;const te=1<<Pe.z,ce=Pe.x,xe=Pe.y;for(const we of Pe.features){const Oe=we.geometry,Ge=we.type;if(we.geometry=[],Ge===1)for(let je=0;je<Oe.length;je+=2)we.geometry.push(Br(Oe[je],Oe[je+1],ee,te,ce,xe));else for(let je=0;je<Oe.length;je++){const tt=[];for(let yt=0;yt<Oe[je].length;yt+=2)tt.push(Br(Oe[je][yt],Oe[je][yt+1],ee,te,ce,xe));we.geometry.push(tt)}}return Pe.transformed=!0,Pe}function Br(Pe,ee,te,ce,xe,we){return[Math.round(te*(Pe*ce-xe)),Math.round(te*(ee*ce-we))]}function Ea(Pe,ee,te,ce,xe){const we=ee===xe.maxZoom?0:xe.tolerance/((1<<ee)*xe.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:Pe.length,source:null,x:te,y:ce,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ge of Pe)Ua(Oe,Ge,we,xe);return Oe}function Ua(Pe,ee,te,ce){const xe=ee.geometry,we=ee.type,Oe=[];if(Pe.minX=Math.min(Pe.minX,ee.minX),Pe.minY=Math.min(Pe.minY,ee.minY),Pe.maxX=Math.max(Pe.maxX,ee.maxX),Pe.maxY=Math.max(Pe.maxY,ee.maxY),we==="Point"||we==="MultiPoint")for(let Ge=0;Ge<xe.length;Ge+=3)Oe.push(xe[Ge],xe[Ge+1]),Pe.numPoints++,Pe.numSimplified++;else if(we==="LineString")ga(Oe,xe,Pe,te,!1,!1);else if(we==="MultiLineString"||we==="Polygon")for(let Ge=0;Ge<xe.length;Ge++)ga(Oe,xe[Ge],Pe,te,we==="Polygon",Ge===0);else if(we==="MultiPolygon")for(let Ge=0;Ge<xe.length;Ge++){const je=xe[Ge];for(let tt=0;tt<je.length;tt++)ga(Oe,je[tt],Pe,te,!0,tt===0)}if(Oe.length){let Ge=ee.tags||null;if(we==="LineString"&&ce.lineMetrics){Ge={};for(const tt in ee.tags)Ge[tt]=ee.tags[tt];Ge.mapbox_clip_start=xe.start/xe.size,Ge.mapbox_clip_end=xe.end/xe.size}const je={geometry:Oe,type:we==="Polygon"||we==="MultiPolygon"?3:we==="LineString"||we==="MultiLineString"?2:1,tags:Ge};ee.id!==null&&(je.id=ee.id),Pe.features.push(je)}}function ga(Pe,ee,te,ce,xe,we){const Oe=ce*ce;if(ce>0&&ee.size<(xe?Oe:ce))return void(te.numPoints+=ee.length/3);const Ge=[];for(let je=0;je<ee.length;je+=3)(ce===0||ee[je+2]>Oe)&&(te.numSimplified++,Ge.push(ee[je],ee[je+1])),te.numPoints++;xe&&function(je,tt){let yt=0;for(let rt=0,Nt=je.length,Ht=Nt-2;rt<Nt;Ht=rt,rt+=2)yt+=(je[rt]-je[Ht])*(je[rt+1]+je[Ht+1]);if(yt>0===tt)for(let rt=0,Nt=je.length;rt<Nt/2;rt+=2){const Ht=je[rt],Be=je[rt+1];je[rt]=je[Nt-2-rt],je[rt+1]=je[Nt-1-rt],je[Nt-2-rt]=Ht,je[Nt-1-rt]=Be}}(Ge,we),Pe.push(Ge)}const Oi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ys{constructor(ee,te){const ce=(te=this.options=function(we,Oe){for(const Ge in Oe)we[Ge]=Oe[Ge];return we}(Object.create(Oi),te)).debug;if(ce&&console.time("preprocess data"),te.maxZoom<0||te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(te.promoteId&&te.generateId)throw new Error("promoteId and generateId cannot be used together.");let xe=function(we,Oe){const Ge=[];if(we.type==="FeatureCollection")for(let je=0;je<we.features.length;je++)dt(Ge,we.features[je],Oe,je);else dt(Ge,we.type==="Feature"?we:{geometry:we},Oe);return Ge}(ee,te);this.tiles={},this.tileCoords=[],ce&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",te.indexMaxZoom,te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),xe=function(we,Oe){const Ge=Oe.buffer/Oe.extent;let je=we;const tt=mn(we,1,-1-Ge,Ge,0,-1,2,Oe),yt=mn(we,1,1-Ge,2+Ge,0,-1,2,Oe);return(tt||yt)&&(je=mn(we,1,-Ge,1+Ge,0,-1,2,Oe)||[],tt&&(je=oa(tt,1).concat(je)),yt&&(je=je.concat(oa(yt,-1)))),je}(xe,te),xe.length&&this.splitTile(xe,0,0,0),ce&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,te,ce,xe,we,Oe,Ge){const je=[ee,te,ce,xe],tt=this.options,yt=tt.debug;for(;je.length;){xe=je.pop(),ce=je.pop(),te=je.pop(),ee=je.pop();const rt=1<<te,Nt=dn(te,ce,xe);let Ht=this.tiles[Nt];if(!Ht&&(yt>1&&console.time("creation"),Ht=this.tiles[Nt]=Ea(ee,te,ce,xe,tt),this.tileCoords.push({z:te,x:ce,y:xe}),yt)){yt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",te,ce,xe,Ht.numFeatures,Ht.numPoints,Ht.numSimplified),console.timeEnd("creation"));const _r=`z${te}`;this.stats[_r]=(this.stats[_r]||0)+1,this.total++}if(Ht.source=ee,we==null){if(te===tt.indexMaxZoom||Ht.numPoints<=tt.indexMaxPoints)continue}else{if(te===tt.maxZoom||te===we)continue;if(we!=null){const _r=we-te;if(ce!==Oe>>_r||xe!==Ge>>_r)continue}}if(Ht.source=null,ee.length===0)continue;yt>1&&console.time("clipping");const Be=.5*tt.buffer/tt.extent,Cn=.5-Be,Un=.5+Be,Vt=1+Be;let jn=null,hr=null,Wi=null,yr=null,Ur=mn(ee,rt,ce-Be,ce+Un,0,Ht.minX,Ht.maxX,tt),pi=mn(ee,rt,ce+Cn,ce+Vt,0,Ht.minX,Ht.maxX,tt);ee=null,Ur&&(jn=mn(Ur,rt,xe-Be,xe+Un,1,Ht.minY,Ht.maxY,tt),hr=mn(Ur,rt,xe+Cn,xe+Vt,1,Ht.minY,Ht.maxY,tt),Ur=null),pi&&(Wi=mn(pi,rt,xe-Be,xe+Un,1,Ht.minY,Ht.maxY,tt),yr=mn(pi,rt,xe+Cn,xe+Vt,1,Ht.minY,Ht.maxY,tt),pi=null),yt>1&&console.timeEnd("clipping"),je.push(jn||[],te+1,2*ce,2*xe),je.push(hr||[],te+1,2*ce,2*xe+1),je.push(Wi||[],te+1,2*ce+1,2*xe),je.push(yr||[],te+1,2*ce+1,2*xe+1)}}getTile(ee,te,ce){ee=+ee,te=+te,ce=+ce;const xe=this.options,{extent:we,debug:Oe}=xe;if(ee<0||ee>24)return null;const Ge=1<<ee,je=dn(ee,te=te+Ge&Ge-1,ce);if(this.tiles[je])return Ar(this.tiles[je],we);Oe>1&&console.log("drilling down to z%d-%d-%d",ee,te,ce);let tt,yt=ee,rt=te,Nt=ce;for(;!tt&&yt>0;)yt--,rt>>=1,Nt>>=1,tt=this.tiles[dn(yt,rt,Nt)];return tt&&tt.source?(Oe>1&&(console.log("found parent tile z%d-%d-%d",yt,rt,Nt),console.time("drilling down")),this.splitTile(tt.source,yt,rt,Nt,ee,te,ce),Oe>1&&console.timeEnd("drilling down"),this.tiles[je]?Ar(this.tiles[je],we):null):null}}function dn(Pe,ee,te){return 32*((1<<Pe)*te+ee)+Pe}class Mr extends z{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,te){return y._(this,void 0,void 0,function*(){const ce=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const xe=this._geoJSONIndex.getTile(ce.z,ce.x,ce.y);if(!xe)return null;const we=new Ae(xe.features,{version:2,extent:y.$});let Oe=function(Ge){const je=new y.cM;return function(tt,yt){for(const rt in tt.layers)yt.writeMessage(3,Te,tt.layers[rt])}(Ge,je),je.finish()}(we);return Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),{vectorTile:we,rawData:Oe.buffer}})}loadData(ee){return y._(this,void 0,void 0,function*(){var te;(te=this._pendingRequest)===null||te===void 0||te.abort();const ce=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new y.cN(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest);const xe=yield this._pendingData;this._geoJSONIndex=ee.cluster?new zt(function({superclusterOptions:Oe,clusterProperties:Ge}){if(!Ge||!Oe)return Oe;const je={},tt={},yt={accumulated:null,zoom:0},rt={properties:null},Nt=Object.keys(Ge);for(const Ht of Nt){const[Be,Cn]=Ge[Ht],Un=y.cT(Cn),Vt=y.cT(typeof Be=="string"?[Be,["accumulated"],["get",Ht]]:Be);je[Ht]=Un.value,tt[Ht]=Vt.value}return Oe.map=Ht=>{rt.properties=Ht;const Be={};for(const Cn of Nt)Be[Cn]=je[Cn].evaluate(yt,rt);return Be},Oe.reduce=(Ht,Be)=>{rt.properties=Be;for(const Cn of Nt)yt.accumulated=Ht[Cn],Ht[Cn]=tt[Cn].evaluate(yt,rt)},Oe}(ee)).load(xe.features):function(Oe,Ge){return new ys(Oe,Ge)}(xe,ee.geojsonVtOptions),this.loaded={};const we={data:xe};if(ce){const Oe=ce.finish();Oe&&(we.resourceTiming={},we.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Oe)))}return we}catch(xe){if(delete this._pendingRequest,y.cy(xe))return{abandoned:!0};throw xe}})}getData(){return y._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const te=this.loaded;return te&&te[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,te){return y._(this,void 0,void 0,function*(){let ce=yield this.loadGeoJSON(ee,te);if(delete this._pendingRequest,typeof ce!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(ne(ce,!0),ee.filter){const xe=y.cT(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(xe.result==="error")throw new Error(xe.value.map(Oe=>`${Oe.key}: ${Oe.message}`).join(", "));ce={type:"FeatureCollection",features:ce.features.filter(Oe=>xe.value.evaluate({zoom:0},Oe))}}return ce})}loadGeoJSON(ee,te){return y._(this,void 0,void 0,function*(){const{promoteId:ce}=ee;if(ee.request){const xe=yield y.j(ee.request,te);return this._dataUpdateable=y.cV(xe.data,ce)?y.cU(xe.data,ce):void 0,xe.data}if(typeof ee.data=="string")try{const xe=JSON.parse(ee.data);return this._dataUpdateable=y.cV(xe,ce)?y.cU(xe,ce):void 0,xe}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return y.cW(this._dataUpdateable,ee.dataDiff,ce),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return y._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class ur{constructor(ee){this.self=ee,this.actor=new y.J(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(te,ce)=>{if(this.externalWorkerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.externalWorkerSourceTypes[te]=ce},this.self.addProtocol=y.cA,this.self.removeProtocol=y.cB,this.self.registerRTLTextPlugin=te=>{y.cX.setMethods(te)},this.actor.registerMessageHandler("LDT",(te,ce)=>this._getDEMWorkerSource(te,ce.source).loadTile(ce)),this.actor.registerMessageHandler("RDT",(te,ce)=>y._(this,void 0,void 0,function*(){this._getDEMWorkerSource(te,ce.source).removeTile(ce)})),this.actor.registerMessageHandler("GCEZ",(te,ce)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(te,ce.type,ce.source).getClusterExpansionZoom(ce)})),this.actor.registerMessageHandler("GCC",(te,ce)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(te,ce.type,ce.source).getClusterChildren(ce)})),this.actor.registerMessageHandler("GCL",(te,ce)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(te,ce.type,ce.source).getClusterLeaves(ce)})),this.actor.registerMessageHandler("LD",(te,ce)=>this._getWorkerSource(te,ce.type,ce.source).loadData(ce)),this.actor.registerMessageHandler("GD",(te,ce)=>this._getWorkerSource(te,ce.type,ce.source).getData()),this.actor.registerMessageHandler("LT",(te,ce)=>this._getWorkerSource(te,ce.type,ce.source).loadTile(ce)),this.actor.registerMessageHandler("RT",(te,ce)=>this._getWorkerSource(te,ce.type,ce.source).reloadTile(ce)),this.actor.registerMessageHandler("AT",(te,ce)=>this._getWorkerSource(te,ce.type,ce.source).abortTile(ce)),this.actor.registerMessageHandler("RMT",(te,ce)=>this._getWorkerSource(te,ce.type,ce.source).removeTile(ce)),this.actor.registerMessageHandler("RS",(te,ce)=>y._(this,void 0,void 0,function*(){if(!this.workerSources[te]||!this.workerSources[te][ce.type]||!this.workerSources[te][ce.type][ce.source])return;const xe=this.workerSources[te][ce.type][ce.source];delete this.workerSources[te][ce.type][ce.source],xe.removeSource!==void 0&&xe.removeSource(ce)})),this.actor.registerMessageHandler("RM",te=>y._(this,void 0,void 0,function*(){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te],this.globalStates.delete(te)})),this.actor.registerMessageHandler("SR",(te,ce)=>y._(this,void 0,void 0,function*(){this.referrer=ce})),this.actor.registerMessageHandler("SRPS",(te,ce)=>this._syncRTLPluginState(te,ce)),this.actor.registerMessageHandler("IS",(te,ce)=>y._(this,void 0,void 0,function*(){this.self.importScripts(ce)})),this.actor.registerMessageHandler("SI",(te,ce)=>this._setImages(te,ce)),this.actor.registerMessageHandler("UL",(te,ce)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(te).update(ce.layers,ce.removedIds,this._getGlobalState(te))})),this.actor.registerMessageHandler("UGS",(te,ce)=>y._(this,void 0,void 0,function*(){const xe=this._getGlobalState(te);for(const we in ce)xe[we]=ce[we]})),this.actor.registerMessageHandler("SL",(te,ce)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(te).replace(ce,this._getGlobalState(te))}))}_getGlobalState(ee){let te=this.globalStates.get(ee);return te||(te={},this.globalStates.set(ee,te)),te}_setImages(ee,te){return y._(this,void 0,void 0,function*(){this.availableImages[ee]=te;for(const ce in this.workerSources[ee]){const xe=this.workerSources[ee][ce];for(const we in xe)xe[we].availableImages=te}})}_syncRTLPluginState(ee,te){return y._(this,void 0,void 0,function*(){return yield y.cX.syncState(te,this.self.importScripts)})}_getAvailableImages(ee){let te=this.availableImages[ee];return te||(te=[]),te}_getLayerIndex(ee){let te=this.layerIndexes[ee];return te||(te=this.layerIndexes[ee]=new c),te}_getWorkerSource(ee,te,ce){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][te]||(this.workerSources[ee][te]={}),!this.workerSources[ee][te][ce]){const xe={sendAsync:(we,Oe)=>(we.targetMapId=ee,this.actor.sendAsync(we,Oe))};switch(te){case"vector":this.workerSources[ee][te][ce]=new z(xe,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][te][ce]=new Mr(xe,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][te][ce]=new this.externalWorkerSourceTypes[te](xe,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][te][ce]}_getDEMWorkerSource(ee,te){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][te]||(this.demWorkerSources[ee][te]=new F),this.demWorkerSources[ee][te]}}return y.i(self)&&(self.worker=new ur(self)),ur}),d("index",["exports","./shared"],function(y,c){var E="5.9.0";function C(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let k,z;const F={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,t,l){const p=requestAnimationFrame(x=>{v(),t(x)}),{unsubscribe:v}=c.s(b.signal,"abort",()=>{v(),cancelAnimationFrame(p),l(c.c())},!1)},frameAsync(b){return new Promise((t,l)=>{this.frame(b,t,l)})},getImageData(b,t=0){return this.getImageCanvasContext(b).getImageData(-t,-t,b.width+2*t,b.height+2*t)},getImageCanvasContext(b){const t=window.document.createElement("canvas"),l=t.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return t.width=b.width,t.height=b.height,l.drawImage(b,0,0,b.width,b.height),l},resolveURL:b=>(k||(k=document.createElement("a")),k.href=b,k.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(z==null&&(z=matchMedia("(prefers-reduced-motion: reduce)")),z.matches)}};class B{static testProp(t){if(!B.docStyle)return t[0];for(let l=0;l<t.length;l++)if(t[l]in B.docStyle)return t[l];return t[0]}static create(t,l,p){const v=window.document.createElement(t);return l!==void 0&&(v.className=l),p&&p.appendChild(v),v}static createNS(t,l){return window.document.createElementNS(t,l)}static disableDrag(){B.docStyle&&B.selectProp&&(B.userSelect=B.docStyle[B.selectProp],B.docStyle[B.selectProp]="none")}static enableDrag(){B.docStyle&&B.selectProp&&(B.docStyle[B.selectProp]=B.userSelect)}static setTransform(t,l){t.style[B.transformProp]=l}static addEventListener(t,l,p,v={}){t.addEventListener(l,p,"passive"in v?v:v.capture)}static removeEventListener(t,l,p,v={}){t.removeEventListener(l,p,"passive"in v?v:v.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",B.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",B.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",B.suppressClickInternal,!0)},0)}static getScale(t){const l=t.getBoundingClientRect();return{x:l.width/t.offsetWidth||1,y:l.height/t.offsetHeight||1,boundingClientRect:l}}static getPoint(t,l,p){const v=l.boundingClientRect;return new c.P((p.clientX-v.left)/l.x-t.clientLeft,(p.clientY-v.top)/l.y-t.clientTop)}static mousePos(t,l){const p=B.getScale(t);return B.getPoint(t,p,l)}static touchPos(t,l){const p=[],v=B.getScale(t);for(let x=0;x<l.length;x++)p.push(B.getPoint(t,v,l[x]));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const l=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),p=l.querySelectorAll("script");for(const v of p)v.remove();return B.clean(l),l.innerHTML}static isPossiblyDangerous(t,l){const p=l.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!p.includes("javascript:")&&!p.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const l=t.children;for(const p of l)B.removeAttributes(p),B.clean(p)}static removeAttributes(t){for(const{name:l,value:p}of t.attributes)B.isPossiblyDangerous(l,p)&&t.removeAttribute(l)}}B.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,B.selectProp=B.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),B.transformProp=B.testProp(["transform","WebkitTransform"]);const Q={supported:!1,testSupport:function(b){!ue&&ne&&(Ae?Te(b):ie=b)}};let ie,ne,ue=!1,Ae=!1;function Te(b){const t=b.createTexture();b.bindTexture(b.TEXTURE_2D,t);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,ne),b.isContextLost())return;Q.supported=!0}catch{}b.deleteTexture(t),ue=!0}var ke;typeof document<"u"&&(ne=document.createElement("img"),ne.onload=()=>{ie&&Te(ie),ie=null,Ae=!0},ne.onerror=()=>{ue=!0,ie=null},ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let t,l,p,v;b.resetRequestQueue=()=>{t=[],l=0,p=0,v={}},b.addThrottleControl=O=>{const j=p++;return v[j]=O,j},b.removeThrottleControl=O=>{delete v[O],A()},b.getImage=(O,j,U=!0)=>new Promise(($,G)=>{Q.supported&&(O.headers||(O.headers={}),O.headers.accept="image/webp,*/*"),c.e(O,{type:"image"}),t.push({abortController:j,requestParameters:O,supportImageRefresh:U,state:"queued",onError:q=>{G(q)},onSuccess:q=>{$(q)}}),A()});const x=O=>c._(this,void 0,void 0,function*(){O.state="running";const{requestParameters:j,supportImageRefresh:U,onError:$,onSuccess:G,abortController:q}=O,re=U===!1&&!c.i(self)&&!c.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce((fe,me)=>fe&&me==="accept",!0));l++;const he=re?R(j,q):c.m(j,q);try{const fe=yield he;delete O.abortController,O.state="completed",fe.data instanceof HTMLImageElement||c.b(fe.data)?G(fe):fe.data&&G({data:yield(de=fe.data,typeof createImageBitmap=="function"?c.f(de):c.h(de)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete O.abortController,$(fe)}finally{l--,A()}var de}),A=()=>{const O=(()=>{for(const j of Object.keys(v))if(v[j]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=l;j<O&&t.length>0;j++){const U=t.shift();U.abortController.signal.aborted?j--:x(U)}},R=(O,j)=>new Promise((U,$)=>{const G=new Image,q=O.url,re=O.credentials;re&&re==="include"?G.crossOrigin="use-credentials":(re&&re==="same-origin"||!c.d(q))&&(G.crossOrigin="anonymous"),j.signal.addEventListener("abort",()=>{G.src="",$(c.c())}),G.fetchPriority="high",G.onload=()=>{G.onerror=G.onload=null,U({data:G})},G.onerror=()=>{G.onerror=G.onload=null,j.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},G.src=q})}(ke||(ke={})),ke.resetRequestQueue();class be{constructor(t){this._transformRequestFn=t??null}transformRequest(t,l){return this._transformRequestFn&&this._transformRequestFn(t,l)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Me(b){const t=[];if(typeof b=="string")t.push({id:"default",url:b});else if(b&&b.length>0){const l=[];for(const{id:p,url:v}of b){const x=`${p}${v}`;l.indexOf(x)===-1&&(l.push(x),t.push({id:p,url:v}))}}return t}function Fe(b,t,l){try{const p=new URL(b);return p.pathname+=`${t}${l}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ot(b){const{userImage:t}=b;return!!(t&&t.render&&t.render())&&(b.data.replace(new Uint8Array(t.data.buffer)),!0)}class Ee extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:l,promiseResolve:p}of this.requestors)p(this._getImagesForIds(l));this.requestors=[]}}getImage(t){const l=this.images[t];if(l&&!l.data&&l.spriteData){const p=l.spriteData;l.data=new c.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),l.spriteData=null}return l}addImage(t,l){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,l)&&(this.images[t]=l)}_validate(t,l){let p=!0;const v=l.data||l.spriteData;return this._validateStretch(l.stretchX,v&&v.width)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,v&&v.height)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "content" value`))),p=!1),p}_validateStretch(t,l){if(!t)return!0;let p=0;for(const v of t){if(v[0]<p||v[1]<v[0]||l<v[1])return!1;p=v[1]}return!0}_validateContent(t,l){if(!t)return!0;if(t.length!==4)return!1;const p=l.spriteData,v=p&&p.width||l.data.width,x=p&&p.height||l.data.height;return!(t[0]<0||v<t[0]||t[1]<0||x<t[1]||t[2]<0||v<t[2]||t[3]<0||x<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,l,p=!0){const v=this.getImage(t);if(p&&(v.data.width!==l.data.width||v.data.height!==l.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=v.version+1,this.images[t]=l,this.updatedImages[t]=!0}removeImage(t){const l=this.images[t];delete this.images[t],delete this.patterns[t],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((l,p)=>{let v=!0;if(!this.isLoaded())for(const x of t)this.images[x]||(v=!1);this.isLoaded()||v?l(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:l})})}_getImagesForIds(t){const l={};for(const p of t){let v=this.getImage(p);v||(this.fire(new c.l("styleimagemissing",{id:p})),v=this.getImage(p)),v?l[p]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:c.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return l}getPixelSize(){const{width:t,height:l}=this.atlasImage;return{width:t,height:l}}getPattern(t){const l=this.patterns[t],p=this.getImage(t);if(!p)return null;if(l&&l.position.version===p.version)return l.position;if(l)l.position.version=p.version;else{const v={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new c.I(v,p);this.patterns[t]={bin:v,position:x}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const l=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(t,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const x in this.patterns)t.push(this.patterns[x].bin);const{w:l,h:p}=c.p(t),v=this.atlasImage;v.resize({width:l||1,height:p||1});for(const x in this.patterns){const{bin:A}=this.patterns[x],R=A.x+1,O=A.y+1,j=this.getImage(x).data,U=j.width,$=j.height;c.R.copy(j,v,{x:0,y:0},{x:R,y:O},{width:U,height:$}),c.R.copy(j,v,{x:0,y:$-1},{x:R,y:O-1},{width:U,height:1}),c.R.copy(j,v,{x:0,y:0},{x:R,y:O+$},{width:U,height:1}),c.R.copy(j,v,{x:U-1,y:0},{x:R-1,y:O},{width:1,height:$}),c.R.copy(j,v,{x:0,y:0},{x:R+U,y:O},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const l of t){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const p=this.getImage(l);p||c.w(`Image with ID: "${l}" was not found`),ot(p)&&this.updateImage(l,p)}}}const Je=1e20;function Et(b,t,l,p,v,x,A,R,O){for(let j=t;j<t+p;j++)Tt(b,l*x+j,x,v,A,R,O);for(let j=l;j<l+v;j++)Tt(b,j*x+t,1,p,A,R,O)}function Tt(b,t,l,p,v,x,A){x[0]=0,A[0]=-Je,A[1]=Je,v[0]=b[t];for(let R=1,O=0,j=0;R<p;R++){v[R]=b[t+R*l];const U=R*R;do{const $=x[O];j=(v[R]-v[$]+U-$*$)/(R-$)/2}while(j<=A[O]&&--O>-1);O++,x[O]=R,A[O]=j,A[O+1]=Je}for(let R=0,O=0;R<p;R++){for(;A[O+1]<R;)O++;const j=x[O],U=R-j;b[t+R*l]=v[j]+U*U}}class zt{constructor(t,l,p){this.requestManager=t,this.localIdeographFontFamily=l,this.entries={},this.lang=p}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,function*(){const l=[];for(const x in t)for(const A of t[x])l.push(this._getAndCacheGlyphsPromise(x,A));const p=yield Promise.all(l),v={};for(const{stack:x,id:A,glyph:R}of p)v[x]||(v[x]={}),v[x][A]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return v})}_getAndCacheGlyphsPromise(t,l){return c._(this,void 0,void 0,function*(){let p=this.entries[t];p||(p=this.entries[t]={glyphs:{},requests:{},ranges:{}});let v=p.glyphs[l];if(v!==void 0)return{stack:t,id:l,glyph:v};if(v=this._tinySDF(p,t,l),v)return p.glyphs[l]=v,{stack:t,id:l,glyph:v};const x=Math.floor(l/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[x])return{stack:t,id:l,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[x]){const R=zt.loadGlyphRange(t,x,this.url,this.requestManager);p.requests[x]=R}const A=yield p.requests[x];for(const R in A)this._doesCharSupportLocalGlyph(+R)||(p.glyphs[+R]=A[+R]);return p.ranges[x]=!0,{stack:t,id:l,glyph:A[l]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||c.u["CJK Unified Ideographs"](t)||c.u["Hangul Syllables"](t)||c.u.Hiragana(t)||c.u.Katakana(t)||c.u["CJK Symbols and Punctuation"](t)||c.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,l,p){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let x=t.tinySDF;if(!x){let R="400";/bold/i.test(l)?R="900":/medium/i.test(l)?R="500":/light/i.test(l)&&(R="200"),x=t.tinySDF=new zt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:v,fontWeight:R})}const A=x.draw(String.fromCharCode(p));return{id:p,bitmap:new c.q({width:A.width||60,height:A.height||60},A.data),metrics:{width:A.glyphWidth/2||24,height:A.glyphHeight/2||24,left:A.glyphLeft/2+.5||0,top:A.glyphTop/2-27.5||-8,advance:A.glyphAdvance/2||24,isDoubleResolution:!0}}}}zt.loadGlyphRange=function(b,t,l,p){return c._(this,void 0,void 0,function*(){const v=256*t,x=v+255,A=p.transformRequest(l.replace("{fontstack}",b).replace("{range}",`${v}-${x}`),"Glyphs"),R=yield c.n(A,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${t}, ${v}-${x}`);const O={};for(const j of c.o(R.data))O[j.id]=j;return O})},zt.TinySDF=class{constructor({fontSize:b=24,buffer:t=3,radius:l=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:x="normal",fontStyle:A="normal",lang:R=null}={}){this.buffer=t,this.cutoff=p,this.radius=l,this.lang=R;const O=this.size=b+4*t,j=this._createCanvas(O),U=this.ctx=j.getContext("2d",{willReadFrequently:!0});U.font=`${A} ${x} ${b}px ${v}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Uint16Array(O)}_createCanvas(b){const t=document.createElement("canvas");return t.width=t.height=b,t}draw(b){const{width:t,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:x}=this.ctx.measureText(b),A=Math.ceil(l),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-v))),O=Math.min(this.size-this.buffer,A+Math.ceil(p)),j=R+2*this.buffer,U=O+2*this.buffer,$=Math.max(j*U,0),G=new Uint8ClampedArray($),q={data:G,width:j,height:U,glyphWidth:R,glyphHeight:O,glyphTop:A,glyphLeft:0,glyphAdvance:t};if(R===0||O===0)return q;const{ctx:re,buffer:he,gridInner:de,gridOuter:fe}=this;this.lang&&(re.lang=this.lang),re.clearRect(he,he,R,O),re.fillText(b,he,he+A);const me=re.getImageData(he,he,R,O);fe.fill(Je,0,$),de.fill(0,0,$);for(let ye=0;ye<O;ye++)for(let ge=0;ge<R;ge++){const Se=me.data[4*(ye*R+ge)+3]/255;if(Se===0)continue;const Re=(ye+he)*j+ge+he;if(Se===1)fe[Re]=0,de[Re]=Je;else{const _e=.5-Se;fe[Re]=_e>0?_e*_e:0,de[Re]=_e<0?_e*_e:0}}Et(fe,0,0,j,U,j,this.f,this.v,this.z),Et(de,he,he,R,O,j,this.f,this.v,this.z);for(let ye=0;ye<$;ye++){const ge=Math.sqrt(fe[ye])-Math.sqrt(de[ye]);G[ye]=Math.round(255-255*(ge/this.radius+this.cutoff))}return q}};class Zt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(t,l){return c.B(t.expression.evaluate(l))}interpolate(t,l,p){return{x:c.C.number(t.x,l.x,p),y:c.C.number(t.y,l.y,p),z:c.C.number(t.z,l.z,p)}}}let Gt;class Ue extends c.E{constructor(t){super(),Gt=Gt||new c.r({anchor:new c.D(c.v.light.anchor),position:new Zt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(Gt,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,l={}){if(!this._validate(c.x,t,l))for(const p in t){const v=t[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),v):this._transitionable.setValue(p,v)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,l,p){return(!p||p.validate!==!1)&&c.y(this,t.call(c.z,{value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const st=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class xt extends c.E{constructor(t){super(),this._transitionable=new c.t(st,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(t,l={}){if(!this._validate(c.G,t,l)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in t){const v=t[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),v):this._transitionable.setValue(p,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,l,p={}){return p?.validate!==!1&&c.y(this,t.call(c.z,c.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class ut{constructor(t,l){this.width=t,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,l){const p=t.join(",")+String(l);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(t,l)),this.dashEntry[p]}getDashRanges(t,l,p){const v=[];let x=t.length%2==1?-t[t.length-1]*p:0,A=t[0]*p,R=!0;v.push({left:x,right:A,isDash:R,zeroLength:t[0]===0});let O=t[0];for(let j=1;j<t.length;j++){R=!R;const U=t[j];x=O*p,O+=U,A=O*p,v.push({left:x,right:A,isDash:R,zeroLength:U===0})}return v}addRoundDash(t,l,p){const v=l/2;for(let x=-p;x<=p;x++){const A=this.width*(this.nextRow+p+x);let R=0,O=t[R];for(let j=0;j<this.width;j++){j/O.right>1&&(O=t[++R]);const U=Math.abs(j-O.left),$=Math.abs(j-O.right),G=Math.min(U,$);let q;const re=x/p*(v+1);if(O.isDash){const he=v-Math.abs(re);q=Math.sqrt(G*G+he*he)}else q=v-Math.sqrt(G*G+re*re);this.data[A+j]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(t){for(let R=t.length-1;R>=0;--R){const O=t[R],j=t[R+1];O.zeroLength?t.splice(R,1):j&&j.isDash===O.isDash&&(j.left=O.left,t.splice(R,1))}const l=t[0],p=t[t.length-1];l.isDash===p.isDash&&(l.left=p.left-this.width,p.right=l.right+this.width);const v=this.width*this.nextRow;let x=0,A=t[x];for(let R=0;R<this.width;R++){R/A.right>1&&(A=t[++x]);const O=Math.abs(R-A.left),j=Math.abs(R-A.right),U=Math.min(O,j);this.data[v+R]=Math.max(0,Math.min(255,(A.isDash?U:-U)+128))}}addDash(t,l){const p=l?7:0,v=2*p+1;if(this.nextRow+v>this.height)return c.w("LineAtlas out of space"),null;let x=0;for(let R=0;R<t.length;R++)x+=t[R];if(x!==0){const R=this.width/x,O=this.getDashRanges(t,this.width,R);l?this.addRoundDash(O,R,p):this.addRegularDash(O)}const A={y:this.nextRow+p,height:2*p,width:x};return this.nextRow+=v,this.dirty=!0,A}bind(t){const l=t.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}const Ut="maplibre_preloaded_worker_pool";class De{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ut]}numActive(){return Object.keys(this.active).length}}const Qe=Math.floor(F.hardwareConcurrency/2);let dt,_t;function Ot(){return dt||(dt=new De),dt}De.workerCount=c.H(globalThis)?Math.max(Math.min(Qe,3),1):1;class jt{constructor(t,l){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=l;const p=this.workerPool.acquire(l);for(let v=0;v<p.length;v++){const x=new c.J(p[v],l);x.name=`Worker ${v}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,l){const p=[];for(const v of this.actors)p.push(v.sendAsync({type:t,data:l}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,l){for(const p of this.actors)p.registerMessageHandler(t,l)}}function Kt(){return _t||(_t=new jt(Ot(),c.K),_t.registerMessageHandler("GR",(b,t,l)=>c.m(t,l))),_t}function cn(b,t){const l=c.L();return c.M(l,l,[1,1,0]),c.N(l,l,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.O(l,l,b.calculatePosMatrix(t.toUnwrapped())):l}function mn(b,t,l,p,v,x,A){var R;const O=function(G,q,re){if(G)for(const he of G){const de=q[he];if(de&&de.source===re&&de.type==="fill-extrusion")return!0}else for(const he in q){const de=q[he];if(de.source===re&&de.type==="fill-extrusion")return!0}return!1}((R=v?.layers)!==null&&R!==void 0?R:null,t,b.id),j=x.maxPitchScaleFactor(),U=b.tilesIn(p,j,O);U.sort(lr);const $=[];for(const G of U)$.push({wrappedTileID:G.tileID.wrapped().key,queryResults:G.tile.queryRenderedFeatures(t,l,b._state,G.queryGeometry,G.cameraQueryGeometry,G.scale,v,x,j,cn(b.transform,G.tileID),A?(q,re)=>A(G.tileID,q,re):void 0)});return function(G,q){for(const re in G)for(const he of G[re])cr(he,q);return G}(function(G){const q={},re={};for(const he of G){const de=he.queryResults,fe=he.wrappedTileID,me=re[fe]=re[fe]||{};for(const ye in de){const ge=de[ye],Se=me[ye]=me[ye]||{},Re=q[ye]=q[ye]||[];for(const _e of ge)Se[_e.featureIndex]||(Se[_e.featureIndex]=!0,Re.push(_e))}}return q}($),b)}function lr(b,t){const l=b.tileID,p=t.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function cr(b,t){const l=b.feature,p=t.getFeatureState(l.layer["source-layer"],l.id);l.source=l.layer.source,l.layer["source-layer"]&&(l.sourceLayer=l.layer["source-layer"]),l.state=p}function xi(b,t,l){return c._(this,void 0,void 0,function*(){let p=b;if(b.url?p=(yield c.j(t.transformRequest(b.url,"Source"),l)).data:yield F.frameAsync(l),!p)return null;const v=c.Q(c.e(p,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(v.vectorLayerIds=p.vector_layers.map(x=>x.id)),v})}class Wn{constructor(t,l){t&&(l?this.setSouthWest(t).setNorthEast(l):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.S?new c.S(t.lng,t.lat):c.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.S?new c.S(t.lng,t.lat):c.S.convert(t),this}extend(t){const l=this._sw,p=this._ne;let v,x;if(t instanceof c.S)v=t,x=t;else{if(!(t instanceof Wn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Wn.convert(t)):this.extend(c.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.S.convert(t)):this;if(v=t._sw,x=t._ne,!v||!x)return this}return l||p?(l.lng=Math.min(v.lng,l.lng),l.lat=Math.min(v.lat,l.lat),p.lng=Math.max(x.lng,p.lng),p.lat=Math.max(x.lat,p.lat)):(this._sw=new c.S(v.lng,v.lat),this._ne=new c.S(x.lng,x.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:l,lat:p}=c.S.convert(t);let v=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(t){return t instanceof Wn?t:t&&new Wn(t)}static fromLngLat(t,l=0){const p=360*l/40075017,v=p/Math.cos(Math.PI/180*t.lat);return new Wn(new c.S(t.lng-v,t.lat-p),new c.S(t.lng+v,t.lat+p))}adjustAntiMeridian(){const t=new c.S(this._sw.lng,this._sw.lat),l=new c.S(this._ne.lng,this._ne.lat);return new Wn(t,t.lng>l.lng?new c.S(l.lng+360,l.lat):l)}}class Ln{constructor(t,l,p){this.bounds=Wn.convert(this.validateBounds(t)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const l=Math.pow(2,t.z),p=Math.floor(c.V(this.bounds.getWest())*l),v=Math.floor(c.U(this.bounds.getNorth())*l),x=Math.ceil(c.V(this.bounds.getEast())*l),A=Math.ceil(c.U(this.bounds.getSouth())*l);return t.x>=p&&t.x<x&&t.y>=v&&t.y<A}}class Sn extends c.E{constructor(t,l,p,v){if(super(),this.id=t,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(l,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield xi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Ln(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,function*(){const l=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(l,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};p.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((x,A)=>{t.reloadPromise={resolve:x,reject:A}})}else t.actor=this.dispatcher.getActor(),v="LT";t.abortController=new AbortController;try{const x=yield t.actor.sendAsync({type:v,data:p},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,x)}catch(x){if(delete t.abortController,t.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,l){if(l&&l.resourceTiming&&(t.resourceTiming=l.resourceTiming),l&&this.map._refreshExpiredTiles&&t.setExpiryData(l),t.loadVectorData(l,this.map.painter),t.reloadPromise){const p=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(p.resolve).catch(p.reject)}}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class gr extends c.E{constructor(t,l,p,v){super(),this.id=t,this.dispatcher=p,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},l),c.e(this,c.Q(l,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield xi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(c.e(this,l),l.bounds&&(this.tileBounds=new Ln(l.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(l){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(l))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,function*(){const l=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const p=yield ke.getImage(this.map._requestManager.transformRequest(l,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&t.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const v=this.map.painter.context,x=v.gl,A=p.data;t.texture=this.map.painter.getTileTexture(A.width),t.texture?t.texture.update(A,{useMipmap:!0}):(t.texture=new c.T(v,A,x.RGBA,{useMipmap:!0}),t.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(p){if(delete t.abortController,t.aborted)t.state="unloaded";else if(p)throw t.state="errored",p}})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class oa extends gr{constructor(t,l,p,v){super(t,l,p,v),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(t){return c._(this,void 0,void 0,function*(){const l=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(l,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const v=yield ke.getImage(p,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(v&&v.data){const x=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&t.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const A=c.b(x)&&c.W()?x:yield this.readImageNow(x),R={type:this.type,uid:t.uid,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const O=yield t.actor.sendAsync({type:"LDT",data:R});t.dem=O,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(v){if(delete t.abortController,t.aborted)t.state="unloaded";else if(v)throw t.state="errored",v}})}readImageNow(t){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const l=t.width+2,p=t.height+2;try{return new c.R({width:l,height:p},yield c.Y(t,-1,-1,l,p))}catch{}}return F.getImageData(t,1)})}_getNeighboringTiles(t){const l=t.canonical,p=Math.pow(2,l.z),v=(l.x-1+p)%p,x=l.x===0?t.wrap-1:t.wrap,A=(l.x+1+p)%p,R=l.x+1===p?t.wrap+1:t.wrap,O={};return O[new c.Z(t.overscaledZ,x,l.z,v,l.y).key]={backfilled:!1},O[new c.Z(t.overscaledZ,R,l.z,A,l.y).key]={backfilled:!1},l.y>0&&(O[new c.Z(t.overscaledZ,x,l.z,v,l.y-1).key]={backfilled:!1},O[new c.Z(t.overscaledZ,t.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},O[new c.Z(t.overscaledZ,R,l.z,A,l.y-1).key]={backfilled:!1}),l.y+1<p&&(O[new c.Z(t.overscaledZ,x,l.z,v,l.y+1).key]={backfilled:!1},O[new c.Z(t.overscaledZ,t.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},O[new c.Z(t.overscaledZ,R,l.z,A,l.y+1).key]={backfilled:!1}),O}unloadTile(t){return c._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class po extends c.E{constructor(t,l,p,v){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:l.data},this.actor=p.getActor(),this.setEventedParent(v),this._data=l.data,this._options=c.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId,l.clusterMaxZoom!==void 0&&this.maxzoom<=l.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${l.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(l.buffer!==void 0?l.buffer:128),tolerance:this._pixelsToTileUnits(l.tolerance!==void 0?l.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(l.clusterMaxZoom),minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(l.clusterRadius||50),log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(c.$/this.tileSize)}_getClusterMaxZoom(t){const l=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${l}"`),l}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map(l=>l.coordinates).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const t=new Wn,l=yield this.getData();let p;switch(l.type){case"FeatureCollection":p=l.features.map(v=>this.getCoordinatesFromGeometry(v.geometry)).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(l.geometry);break;default:p=this.getCoordinatesFromGeometry(l)}if(p.length==0)return t;for(let v=0;v<p.length-1;v+=2)t.extend([p[v],p[v+1]]);return t})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,l,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:l,offset:p}})}_updateWorkerData(){return c._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:t,diff:l}=this._pendingWorkerUpdate;if(!t&&!l)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const p=c.e({type:this.type},this.workerOptions);t?(typeof t=="string"?(p.request=this.map._requestManager.transformRequest(F.resolveURL(t),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):l&&(p.dataDiff=l,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const v=yield this.actor.sendAsync({type:"LD",data:p});if(this._isUpdatingWorker=!1,this._removed||v.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=v.data;let x=null;v.resourceTiming&&v.resourceTiming[this.id]&&(x=v.resourceTiming[this.id].slice(0));const A={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&c.e(A,{resourceTiming:x}),this.fire(new c.l("data",Object.assign(Object.assign({},A),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},A),{sourceDataType:"content"})))}catch(v){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(v))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(t){return c._(this,void 0,void 0,function*(){const l=t.actor?"RT":"LT";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const v=yield this.actor.sendAsync({type:l,data:p},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(v,this.map.painter,l==="RT")})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Ar extends c.E{constructor(t,l,p,v){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=l}load(t){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const l=yield ke.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,l&&l.data&&(this.image=l.data,t&&(this.coordinates=t),this._finishLoading())}catch(l){this._request=null,this._loaded=!0,this.fire(new c.k(l))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const l=t.map(c.a1.fromLngLat);var p;return this.tileID=function(v){const x=c.a2.fromPoints(v),A=x.width(),R=x.height(),O=Math.max(A,R),j=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),U=Math.pow(2,j);return new c.a4(j,Math.floor((x.minX+x.maxX)/2*U),Math.floor((x.minY+x.maxY)/2*U))}(l),this.terrainTileRanges=this._getOverlappingTileRanges(l),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=l.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,l=t.gl;this.texture||(this.texture=new c.T(t,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let p=!1;for(const v in this.tiles){const x=this.tiles[v];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,p=!0)}p&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:l,minY:p,maxX:v,maxY:x}=c.a2.fromPoints(t),A={};for(let R=0;R<=c.a3;R++){const O=Math.pow(2,R),j=Math.floor(l*O),U=Math.floor(p*O),$=Math.floor(v*O),G=Math.floor(x*O);A[R]={minTileX:j,minTileY:U,maxTileX:$,maxTileY:G}}return A}}class Br extends Ar{constructor(t,l,p,v){super(t,l,p,v),this.roundZoom=!0,this.type="video",this.options=l}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const l of t.urls)this.urls.push(this.map._requestManager.transformRequest(l,"Source").url);try{const l=yield c.a5(this.urls);if(this._loaded=!0,!l)return;this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(l){this.fire(new c.k(l))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const l=this.video.seekable;t<l.start(0)||t>l.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,l=t.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(t,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let p=!1;for(const v in this.tiles){const x=this.tiles[v];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,p=!0)}p&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ea extends Ar{constructor(t,l,p,v){super(t,l,p,v),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(A=>typeof A!="number"))||this.fire(new c.k(new c.a6(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${t}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${t}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context,p=l.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(l,this.canvas,p.RGBA,{premultiply:!0});let v=!1;for(const x in this.tiles){const A=this.tiles[x];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,v=!0)}v&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Ua={},ga=b=>{switch(b){case"geojson":return po;case"image":return Ar;case"raster":return gr;case"raster-dem":return oa;case"vector":return Sn;case"video":return Br;case"canvas":return Ea}return Ua[b]},Oi="RTLPluginLoaded";class ys extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Kt()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(l=>{throw this.status="error",l})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,function*(l,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=F.resolveURL(l),!this.url)throw new Error(`requested url ${l} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Oi))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let dn=null;function Mr(){return dn||(dn=new ys),dn}var ur,Pe;(function(b){b[b.Base=0]="Base",b[b.Parent=1]="Parent"})(ur||(ur={})),function(b){b[b.Departing=0]="Departing",b[b.Incoming=1]="Incoming"}(Pe||(Pe={}));class ee{constructor(t,l){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=c.a7(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:l,fadingParentID:p,fadeEndTime:v}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=l,this.fadingParentID=p,this.fadeEndTime=v}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=F.now(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,l,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(v,x){const A={};if(!x)return A;for(const R of v){const O=R.layerIds.map(j=>x.getLayer(j)).filter(Boolean);if(O.length!==0){R.layers=O,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(j=>O.filter(U=>U.id===j)[0]));for(const j of O)A[j.id]=R}}return A}(t.buckets,l?.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const x=this.buckets[v];if(x instanceof c.a9){if(this.hasSymbolBuckets=!0,!p)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const x=this.buckets[v];if(x instanceof c.a9&&x.hasRTLText){this.hasRTLText=!0,Mr().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const x=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(v).queryRadius(x))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const p in this.buckets){const v=this.buckets[p];v.uploadPending()&&v.upload(t)}const l=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(t,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(t,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,l,p,v,x,A,R,O,j,U,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:x,scale:A,tileSize:this.tileSize,pixelPosMatrix:U,transform:O,params:R,queryPadding:this.queryPadding*j,getElevation:$},t,l,p):{}}querySourceFeatures(t,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const v=p.loadVTLayers(),x=l&&l.sourceLayer?l.sourceLayer:"",A=v._geojsonTileLayer||v[x];if(!A)return;const R=c.aa(l?.filter,l?.globalState),{z:O,x:j,y:U}=this.tileID.canonical,$={z:O,x:j,y:U};for(let G=0;G<A.length;G++){const q=A.feature(G);if(R.needGeometry){const de=c.ab(q,!0);if(!R.filter(new c.F(this.tileID.overscaledZ),de,this.tileID.canonical))continue}else if(!R.filter(new c.F(this.tileID.overscaledZ),q))continue;const re=p.getId(q,x),he=new c.ac(q,O,j,U,re);he.tile=$,t.push(he)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const l=this.expirationTime;if(t.cacheControl){const p=c.ad(t.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const p=Date.now();let v=!1;if(this.expirationTime>p)v=!1;else if(l)if(this.expirationTime<l)v=!0;else{const x=this.expirationTime-l;x?this.expirationTime=p+Math.max(x,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!l.style.hasLayer(v))continue;const x=this.buckets[v],A=x.layers[0].sourceLayer||"_geojsonTileLayer",R=p[A],O=t[A];if(!R||!O||Object.keys(O).length===0)continue;x.update(O,R,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const j=l&&l.style&&l.style.getLayer(v);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(x)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=F.now()+t}setDependencies(t,l){const p={};for(const v of l)p[v]=!0;this.dependencies[t]=p}hasDependency(t,l){for(const p of t){const v=this.dependencies[p];if(v){for(const x of l)if(v[x])return!0}}return!1}}class te{constructor(t,l){this.max=t,this.onRemove=l,this.reset()}reset(){for(const t in this.data)for(const l of this.data[t])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(t,l,p){const v=t.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const x={value:l,timeout:void 0};if(p!==void 0&&(x.timeout=setTimeout(()=>{this.remove(t,x)},p)),this.data[v].push(x),this.order.push(v),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const l=this.data[t].shift();return l.timeout&&clearTimeout(l.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),l.value}getByKey(t){const l=this.data[t];return l?l[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,l){if(!this.has(t))return this;const p=t.wrapped().key,v=l===void 0?0:this.data[p].indexOf(l),x=this.data[p][v];return this.data[p].splice(v,1),x.timeout&&clearTimeout(x.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(x.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(t){const l=[];for(const p in this.data)for(const v of this.data[p])t(v.value)||l.push(v);for(const p of l)this.remove(p.value.tileID,p)}}class ce{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,l,p){const v=String(l);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][v]=this.stateChanges[t][v]||{},c.e(this.stateChanges[t][v],p),this.deletedStates[t]===null){this.deletedStates[t]={};for(const x in this.state[t])x!==v&&(this.deletedStates[t][x]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][v]===null){this.deletedStates[t][v]={};for(const x in this.state[t][v])p[x]||(this.deletedStates[t][v][x]=null)}else for(const x in p)this.deletedStates[t]&&this.deletedStates[t][v]&&this.deletedStates[t][v][x]===null&&delete this.deletedStates[t][v][x]}removeFeatureState(t,l,p){if(this.deletedStates[t]===null)return;const v=String(l);if(this.deletedStates[t]=this.deletedStates[t]||{},p&&l!==void 0)this.deletedStates[t][v]!==null&&(this.deletedStates[t][v]=this.deletedStates[t][v]||{},this.deletedStates[t][v][p]=null);else if(l!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][v])for(p in this.deletedStates[t][v]={},this.stateChanges[t][v])this.deletedStates[t][v][p]=null;else this.deletedStates[t][v]=null;else this.deletedStates[t]=null}getState(t,l){const p=String(l),v=c.e({},(this.state[t]||{})[p],(this.stateChanges[t]||{})[p]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const x=this.deletedStates[t][l];if(x===null)return{};for(const A in x)delete v[A]}return v}initializeTileState(t,l){t.setFeatureState(this.state,l)}coalesceChanges(t,l){const p={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const x={};for(const A in this.stateChanges[v])this.state[v][A]||(this.state[v][A]={}),c.e(this.state[v][A],this.stateChanges[v][A]),x[A]=this.state[v][A];p[v]=x}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const x={};if(this.deletedStates[v]===null)for(const A in this.state[v])x[A]={},this.state[v][A]={};else for(const A in this.deletedStates[v]){if(this.deletedStates[v][A]===null)this.state[v][A]={};else for(const R of Object.keys(this.deletedStates[v][A]))delete this.state[v][A][R];x[A]=this.state[v][A]}p[v]=p[v]||{},c.e(p[v],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const v in t)t[v].setFeatureState(p,l)}}const xe=89.25;function we(b,t){const l=c.ah(t.lat,-c.ai,c.ai);return new c.P(c.V(t.lng)*b,c.U(l)*b)}function Oe(b,t){return new c.a1(t.x/b,t.y/b).toLngLat()}function Ge(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-b.pitch)),Math.tan(c.ae(xe-b.pitch)))}function je(b,t){const l=b.canonical,p=t/c.af(l.z),v=l.x+Math.pow(2,l.z)*b.wrap,x=c.ag(new Float64Array(16));return c.M(x,x,[v*p,l.y*p,0]),c.N(x,x,[p/c.$,p/c.$,1]),x}function tt(b,t,l,p,v){const x=c.a1.fromLngLat(b,t),A=v*c.aj(1,b.lat),R=A*Math.cos(c.ae(l)),O=Math.sqrt(A*A-R*R),j=O*Math.sin(c.ae(-p)),U=O*Math.cos(c.ae(-p));return new c.a1(x.x+j,x.y+U,x.z+R)}function yt(b,t,l){const p=t.intersectsFrustum(b);if(!l||p===0)return p;const v=t.intersectsPlane(l);return v===0?0:p===2&&v===2?2:1}function rt(b,t,l){let p=0;const v=(l-t)/10;for(let x=0;x<10;x++)p+=v*Math.pow(Math.cos(t+(x+.5)/10*(l-t)),b);return p}function Nt(b,t){return function(l,p,v,x,A){const R=2*((b-1)/c.ak(Math.cos(c.ae(xe-A))/Math.cos(c.ae(xe)))-1),O=Math.acos(v/x),j=2*rt(R-1,0,c.ae(A/2)),U=Math.min(c.ae(xe),O+c.ae(A/2)),$=rt(R-1,Math.min(U,O-c.ae(A/2)),U),G=Math.atan(p/v),q=Math.hypot(p,v);let re=l;return re+=c.ak(x/q/Math.max(.5,Math.cos(c.ae(A/2)))),re+=R*c.ak(Math.cos(G))/2,re-=c.ak(Math.max(1,$/j/t))/2,re}}const Ht=Nt(9.314,3);function Be(b,t){const l=(t.roundZoom?Math.round:Math.floor)(b.zoom+c.ak(b.tileSize/t.tileSize));return Math.max(0,l)}function Cn(b,t){const l=b.getCameraFrustum(),p=b.getClippingPlane(),v=b.screenPointToMercatorCoordinate(b.getCameraPoint()),x=c.a1.fromLngLat(b.center,b.elevation);v.z=x.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const A=b.getCoveringTilesDetailsProvider(),R=A.allowVariableZoom(b,t),O=Be(b,t),j=t.minzoom||0,U=t.maxzoom!==void 0?t.maxzoom:b.maxZoom,$=Math.min(Math.max(0,O),U),G=Math.pow(2,$),q=[G*v.x,G*v.y,0],re=[G*x.x,G*x.y,0],he=Math.hypot(x.x-v.x,x.y-v.y),de=Math.abs(x.z-v.z),fe=Math.hypot(he,de),me=Se=>({zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),ye=[],ge=[];if(b.renderWorldCopies&&A.allowWorldCopies())for(let Se=1;Se<=3;Se++)ye.push(me(-Se)),ye.push(me(Se));for(ye.push(me(0));ye.length>0;){const Se=ye.pop(),Re=Se.x,_e=Se.y;let Le=Se.fullyVisible;const qe={x:Re,y:_e,z:Se.zoom},$e=A.getTileBoundingVolume(qe,Se.wrap,b.elevation,t);if(!Le){const wt=yt(l,$e,p);if(wt===0)continue;Le=wt===2}const Ye=A.distanceToTile2d(v.x,v.y,qe,$e);let He=O;R&&(He=(t.calculateTileZoom||Ht)(b.zoom+c.ak(b.tileSize/t.tileSize),Ye,de,fe,b.fov)),He=(t.roundZoom?Math.round:Math.floor)(He),He=Math.max(0,He);const bt=Math.min(He,U);if(Se.wrap=A.getWrap(x,qe,Se.wrap),Se.zoom>=bt){if(Se.zoom<j)continue;const wt=$-Se.zoom,ct=q[0]-.5-(Re<<wt),Ft=q[1]-.5-(_e<<wt),on=t.reparseOverscaled?Math.max(Se.zoom,He):Se.zoom;ge.push({tileID:new c.Z(Se.zoom===U?on:Se.zoom,Se.wrap,Se.zoom,Re,_e),distanceSq:c.al([re[0]-.5-Re,re[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(ct*ct+Ft*Ft)})}else for(let wt=0;wt<4;wt++)ye.push({zoom:Se.zoom+1,x:(Re<<1)+wt%2,y:(_e<<1)+(wt>>1),wrap:Se.wrap,fullyVisible:Le})}return ge.sort((Se,Re)=>Se.distanceSq-Re.distanceSq).map(Se=>Se.tileID)}const Un=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class Vt extends c.E{constructor(t,l,p){super(),this.id=t,this.dispatcher=p,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,x,A,R)=>{const O=new(ga(x.type))(v,x,A,R);if(O.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${O.id}`);return O})(t,l,p,this),this._tiles={},this._cache=new te(0,v=>this._unloadTile(v)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new ce,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const l=this._tiles[t];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,l,p){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,l,p)}catch(v){t.state="errored",v.status!==404?this._source.fire(new c.k(v,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(t),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(jn).map(t=>t.key)}getRenderableIds(t){const l=[];for(const p in this._tiles)this._isIdRenderable(p,t)&&l.push(this._tiles[p]);return t?l.sort((p,v)=>{const x=p.tileID,A=v.tileID,R=new c.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),O=new c.P(A.canonical.x,A.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-A.overscaledZ||O.y-R.y||O.x-R.x}).map(p=>p.tileID.key):l.map(p=>p.tileID).sort(jn).map(p=>p.key)}hasRenderableParent(t){const l=t.overscaledZ-1;if(l>=this._source.minzoom){const p=this._getLoadedTile(t.scaledTo(l));if(p)return this._isIdRenderable(p.tileID.key)}return!1}_isIdRenderable(t,l=!1){var p;return(p=this._tiles[t])===null||p===void 0?void 0:p.isRenderable(l)}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)t?this._reloadTile(l,"expired"):this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(t,l){return c._(this,void 0,void 0,function*(){const p=this._tiles[t];p&&(p.state!=="loading"&&(p.state=l),yield this._loadTile(p,t,l))})}_tileLoaded(t,l,p){t.timeAdded=F.now(),p==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(l,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const l=this.getRenderableIds();for(let v=0;v<l.length;v++){const x=l[v];if(t.neighboringTiles&&t.neighboringTiles[x]){const A=this.getTileByID(x);p(t,A),p(A,t)}}function p(v,x){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let A=x.tileID.canonical.x-v.tileID.canonical.x;const R=x.tileID.canonical.y-v.tileID.canonical.y,O=Math.pow(2,v.tileID.canonical.z),j=x.tileID.key;A===0&&R===0||Math.abs(R)>1||(Math.abs(A)>1&&(Math.abs(A+O)===1?A+=O:Math.abs(A-O)===1&&(A-=O)),x.dem&&v.dem&&(v.dem.backfillBorder(x.dem,A,R),v.neighboringTiles&&v.neighboringTiles[j]&&(v.neighboringTiles[j].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,l){const p=Object.values(t),v=this._getLoadedDescendents(p),x={};for(const A of p){const R=v[A.key];if(!R?.length){x[A.key]=A;continue}const O=A.overscaledZ+Vt.maxUnderzooming,j=R.filter(G=>G.tileID.overscaledZ<=O);if(!j.length){x[A.key]=A;continue}const U=Math.min(...j.map(G=>G.tileID.overscaledZ)),$=j.filter(G=>G.tileID.overscaledZ===U).map(G=>G.tileID);for(const G of $)l[G.key]=G;this._areDescendentsComplete($,U,A.overscaledZ)||(x[A.key]=A)}return x}_getLoadedDescendents(t){var l;const p={};for(const v in this._tiles){const x=this._tiles[v];if(x.hasData())for(const A of t)x.tileID.isChildOf(A)&&(p[l=A.key]||(p[l]=[])).push(x)}return p}_areDescendentsComplete(t,l,p){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===l:Math.pow(4,l-p)===t.length}_getLoadedTile(t){const l=this._tiles[t.key];return l?.hasData()?l:null}updateCacheSize(t){const l=Math.ceil(t.width/this._source.tileSize)+1,p=Math.ceil(t.height/this._source.tileSize)+1,v=Math.floor(l*p*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(x)}handleWrapJump(t){const l=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,l){const p={};for(const v in this._tiles){const x=this._tiles[v];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+l),p[x.tileID.key]=x}this._tiles=p;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}update(t,l){if(!this._sourceLoaded||this._paused)return;let p;this.transform=t,this.terrain=l,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?p=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new c.Z(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(p=Cn(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter(O=>this._source.hasTile(O)))):p=[],this.usedForTerrain&&(p=this._addTerrainIdealTiles(p));const v=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,v&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const x=Be(t,this._source),A=this._updateRetainedTiles(p,x),R=hr(this._source.type);R&&this._rasterFadeDuration>0&&!l&&this._updateFadingTiles(p,A),R?this._cleanUpRasterTiles(A):this._cleanUpVectorTiles(A)}_cleanUpRasterTiles(t){for(const l in this._tiles)t[l]||this._removeTile(l)}_cleanUpVectorTiles(t){for(const l in this._tiles){const p=this._tiles[l];t[l]?p.clearSymbolFadeHold():p.hasSymbolBuckets?p.holdingForSymbolFade()?p.symbolFadeFinished()&&this._removeTile(l):p.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(l)}}_addTerrainIdealTiles(t){const l=[];for(const p of t)if(p.canonical.z>this._source.minzoom){const v=p.scaledTo(p.canonical.z-1);l.push(v);const x=p.scaledTo(Math.max(this._source.minzoom,Math.min(p.canonical.z,5)));l.push(x)}return t.concat(l)}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,l){var p;const v={},x={},A=Math.max(l-Vt.maxOverzooming,this._source.minzoom);let R={};for(const O of t){const j=this._addTile(O);v[O.key]=O,j.hasData()||(R[O.key]=O)}R=this._retainLoadedChildren(R,v);for(const O in R){const j=R[O];let U=this._tiles[O],$=U?.wasRequested();for(let G=j.overscaledZ-1;G>=A;--G){const q=j.scaledTo(G);if(x[q.key])break;if(x[q.key]=!0,U=this.getTile(q),!U&&$&&(U=this._addTile(q)),U){const re=U.hasData();if((re||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||$)&&(v[q.key]=q),$=U.wasRequested(),re)break}}}return v}_updateFadingTiles(t,l){const p=F.now(),v=c.am(t);for(const x of t){const A=this._tiles[x.key];A.fadingDirection!==Pe.Departing&&A.fadeOpacity!==0||A.resetFadeLogic(),this._updateFadingAncestor(A,l,p)||this._updateFadingDescendents(A,l,p)||this._updateFadingEdge(A,v,p)||A.resetFadeLogic()}}_updateFadingAncestor(t,l,p){if(!t.hasData())return!1;const{tileID:v,fadingRole:x,fadingDirection:A,fadingParentID:R}=t;if(x===ur.Base&&A===Pe.Incoming&&R)return l[R.key]=R,!0;const O=Math.max(v.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let j=v.overscaledZ-1;j>=O;j--){const U=v.scaledTo(j),$=this._getLoadedTile(U);if($)return t.setCrossFadeLogic({fadingRole:ur.Base,fadingDirection:Pe.Incoming,fadingParentID:$.tileID,fadeEndTime:p+this._rasterFadeDuration}),$.setCrossFadeLogic({fadingRole:ur.Parent,fadingDirection:Pe.Departing,fadeEndTime:p+this._rasterFadeDuration}),l[U.key]=U,!0}return!1}_updateFadingDescendents(t,l,p){if(!t.hasData())return!1;const v=t.tileID.children(this._source.maxzoom);let x=this._updateFadingChildren(t,v,l,p);if(x)return!0;for(const A of v){const R=A.children(this._source.maxzoom);this._updateFadingChildren(t,R,l,p)&&(x=!0)}return x}_updateFadingChildren(t,l,p,v){if(l[0].overscaledZ>=this._source.maxzoom)return!1;let x=!1;for(const A of l){const R=this._getLoadedTile(A);if(!R)continue;const{fadingRole:O,fadingDirection:j,fadingParentID:U}=R;O===ur.Base&&j===Pe.Departing&&U||(R.setCrossFadeLogic({fadingRole:ur.Base,fadingDirection:Pe.Departing,fadingParentID:t.tileID,fadeEndTime:v+this._rasterFadeDuration}),t.setCrossFadeLogic({fadingRole:ur.Parent,fadingDirection:Pe.Incoming,fadeEndTime:v+this._rasterFadeDuration})),p[A.key]=A,x=!0}return x}_updateFadingEdge(t,l,p){const v=t.tileID;return!!t.selfFading||!t.hasData()&&!!l.has(v)&&(t.setSelfFadeLogic(p+this._rasterFadeDuration),!0)}_addTile(t){let l=this._tiles[t.key];if(l)return l;l=this._cache.getAndRemove(t),l&&(l.resetFadeLogic(),this._setTileReloadTimer(t.key,l),l.tileID=t,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,l)));const p=l;return l||(l=new ee(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(l,t.key,l.state)),l.uses++,this._tiles[t.key]=l,p||this._source.fire(new c.l("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(t,l){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const p=l.getExpiryTimeout();p&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},p))}refreshTiles(t){for(const l in this._tiles)(this._isIdRenderable(l)||this._tiles[l].state=="errored")&&t.some(p=>p.equals(this._tiles[l].tileID.canonical))&&this._reloadTile(l,"expired")}_removeTile(t){const l=this._tiles[t];l&&(l.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,l,p){const v=[],x=this.transform;if(!x)return v;const A=x.getCoveringTilesDetailsProvider().allowWorldCopies(),R=p?x.getCameraQueryGeometry(t):t,O=q=>x.screenPointToMercatorCoordinate(q,this.terrain),j=this.transformBbox(t,O,!A),U=this.transformBbox(R,O,!A),$=this.getIds(),G=c.a2.fromPoints(U);for(let q=0;q<$.length;q++){const re=this._tiles[$[q]];if(re.holdingForSymbolFade())continue;const he=A?[re.tileID]:[re.tileID.unwrapTo(-1),re.tileID.unwrapTo(0)],de=Math.pow(2,x.zoom-re.tileID.overscaledZ),fe=l*re.queryPadding*c.$/re.tileSize/de;for(const me of he){const ye=G.map(ge=>me.getTilePoint(new c.a1(ge.x,ge.y)));if(ye.expandBy(fe),ye.intersects(Un)){const ge=j.map(Re=>me.getTilePoint(Re)),Se=U.map(Re=>me.getTilePoint(Re));v.push({tile:re,tileID:A?me:me.unwrapTo(0),queryGeometry:ge,cameraQueryGeometry:Se,scale:de})}}}return v}transformBbox(t,l,p){let v=t.map(l);if(p){const x=c.a2.fromPoints(t);x.shrinkBy(.001*Math.min(x.width(),x.height()));const A=x.map(l);c.a2.fromPoints(v).covers(A)||(v=v.map(R=>R.x>.5?new c.a1(R.x-1,R.y,R.z):R))}return v}getVisibleCoordinates(t){const l=this.getRenderableIds(t).map(p=>this._tiles[p].tileID);return this.transform&&this.transform.populateCache(l),l}hasTransition(){if(this._source.hasTransition())return!0;if(hr(this._source.type)&&this._rasterFadeDuration>0){const t=F.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=t)return!0}return!1}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,l,p){this._state.updateState(t=t||"_geojsonTileLayer",l,p)}removeFeatureState(t,l,p){this._state.removeFeatureState(t=t||"_geojsonTileLayer",l,p)}getFeatureState(t,l){return this._state.getState(t=t||"_geojsonTileLayer",l)}setDependencies(t,l,p){const v=this._tiles[t];v&&v.setDependencies(l,p)}reloadTilesForDependencies(t,l){for(const p in this._tiles)this._tiles[p].hasDependency(t,l)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(t,l))}}function jn(b,t){const l=Math.abs(2*b.wrap)-+(b.wrap<0),p=Math.abs(2*t.wrap)-+(t.wrap<0);return b.overscaledZ-t.overscaledZ||p-l||t.canonical.y-b.canonical.y||t.canonical.x-b.canonical.x}function hr(b){return b==="raster"||b==="image"||b==="video"}Vt.maxOverzooming=10,Vt.maxUnderzooming=3;class Wi{constructor(t,l){this.reset(t,l)}reset(t,l){this.points=t||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ah(t,0,1);let l=1,p=this._distances[l];const v=t*this.paddedLength+this.padding;for(;p<v&&l<this._distances.length;)p=this._distances[++l];const x=l-1,A=this._distances[x],R=p-A,O=R>0?(v-A)/R:0;return this.points[x].mult(1-O).add(this.points[l].mult(O))}}function yr(b,t){let l=!0;return b==="always"||b!=="never"&&t!=="never"||(l=!1),l}class Ur{constructor(t,l,p){const v=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(t/p),this.yCellCount=Math.ceil(l/p);for(let A=0;A<this.xCellCount*this.yCellCount;A++)v.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=l,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,l,p,v,x){this._forEachCell(l,p,v,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(x)}insertCircle(t,l,p,v){this._forEachCell(l-v,p-v,l+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(l),this.circles.push(p),this.circles.push(v)}_insertBoxCell(t,l,p,v,x,A){this.boxCells[x].push(A)}_insertCircleCell(t,l,p,v,x,A){this.circleCells[x].push(A)}_query(t,l,p,v,x,A,R){if(p<0||t>this.width||v<0||l>this.height)return[];const O=[];if(t<=0&&l<=0&&this.width<=p&&this.height<=v){if(x)return[{key:null,x1:t,y1:l,x2:p,y2:v}];for(let j=0;j<this.boxKeys.length;j++)O.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const U=this.circles[3*j],$=this.circles[3*j+1],G=this.circles[3*j+2];O.push({key:this.circleKeys[j],x1:U-G,y1:$-G,x2:U+G,y2:$+G})}}else this._forEachCell(t,l,p,v,this._queryCell,O,{hitTest:x,overlapMode:A,seenUids:{box:{},circle:{}}},R);return O}query(t,l,p,v){return this._query(t,l,p,v,!1,null)}hitTest(t,l,p,v,x,A){return this._query(t,l,p,v,!0,x,A).length>0}hitTestCircle(t,l,p,v,x){const A=t-p,R=t+p,O=l-p,j=l+p;if(R<0||A>this.width||j<0||O>this.height)return!1;const U=[];return this._forEachCell(A,O,R,j,this._queryCellCircle,U,{hitTest:!0,overlapMode:v,circle:{x:t,y:l,radius:p},seenUids:{box:{},circle:{}}},x),U.length>0}_queryCell(t,l,p,v,x,A,R,O){const{seenUids:j,hitTest:U,overlapMode:$}=R,G=this.boxCells[x];if(G!==null){const re=this.bboxes;for(const he of G)if(!j.box[he]){j.box[he]=!0;const de=4*he,fe=this.boxKeys[he];if(t<=re[de+2]&&l<=re[de+3]&&p>=re[de+0]&&v>=re[de+1]&&(!O||O(fe))&&(!U||!yr($,fe.overlapMode))&&(A.push({key:fe,x1:re[de],y1:re[de+1],x2:re[de+2],y2:re[de+3]}),U))return!0}}const q=this.circleCells[x];if(q!==null){const re=this.circles;for(const he of q)if(!j.circle[he]){j.circle[he]=!0;const de=3*he,fe=this.circleKeys[he];if(this._circleAndRectCollide(re[de],re[de+1],re[de+2],t,l,p,v)&&(!O||O(fe))&&(!U||!yr($,fe.overlapMode))){const me=re[de],ye=re[de+1],ge=re[de+2];if(A.push({key:fe,x1:me-ge,y1:ye-ge,x2:me+ge,y2:ye+ge}),U)return!0}}}return!1}_queryCellCircle(t,l,p,v,x,A,R,O){const{circle:j,seenUids:U,overlapMode:$}=R,G=this.boxCells[x];if(G!==null){const re=this.bboxes;for(const he of G)if(!U.box[he]){U.box[he]=!0;const de=4*he,fe=this.boxKeys[he];if(this._circleAndRectCollide(j.x,j.y,j.radius,re[de+0],re[de+1],re[de+2],re[de+3])&&(!O||O(fe))&&!yr($,fe.overlapMode))return A.push(!0),!0}}const q=this.circleCells[x];if(q!==null){const re=this.circles;for(const he of q)if(!U.circle[he]){U.circle[he]=!0;const de=3*he,fe=this.circleKeys[he];if(this._circlesCollide(re[de],re[de+1],re[de+2],j.x,j.y,j.radius)&&(!O||O(fe))&&!yr($,fe.overlapMode))return A.push(!0),!0}}}_forEachCell(t,l,p,v,x,A,R,O){const j=this._convertToXCellCoord(t),U=this._convertToYCellCoord(l),$=this._convertToXCellCoord(p),G=this._convertToYCellCoord(v);for(let q=j;q<=$;q++)for(let re=U;re<=G;re++)if(x.call(this,t,l,p,v,this.xCellCount*re+q,A,R,O))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,l,p,v,x,A){const R=v-t,O=x-l,j=p+A;return j*j>R*R+O*O}_circleAndRectCollide(t,l,p,v,x,A,R){const O=(A-v)/2,j=Math.abs(t-(v+O));if(j>O+p)return!1;const U=(R-x)/2,$=Math.abs(l-(x+U));if($>U+p)return!1;if(j<=O||$<=U)return!0;const G=j-O,q=$-U;return G*G+q*q<=p*p}}function pi(b,t,l){const p=c.L();if(!b){const{vecSouth:$,vecEast:G}=Kn(t),q=C();q[0]=G[0],q[1]=G[1],q[2]=$[0],q[3]=$[1],v=q,(U=(A=(x=q)[0])*(j=x[3])-(O=x[2])*(R=x[1]))&&(v[0]=j*(U=1/U),v[1]=-R*U,v[2]=-O*U,v[3]=A*U),p[0]=q[0],p[1]=q[1],p[4]=q[2],p[5]=q[3]}var v,x,A,R,O,j,U;return c.N(p,p,[1/l,1/l,1]),p}function _r(b,t,l,p){if(b){const v=c.L();if(!t){const{vecSouth:x,vecEast:A}=Kn(l);v[0]=A[0],v[1]=A[1],v[4]=x[0],v[5]=x[1]}return c.N(v,v,[p,p,1]),v}return l.pixelsToClipSpaceMatrix}function Kn(b){const t=Math.cos(b.rollInRadians),l=Math.sin(b.rollInRadians),p=Math.cos(b.pitchInRadians),v=Math.cos(b.bearingInRadians),x=Math.sin(b.bearingInRadians),A=c.ar();A[0]=-v*p*l-x*t,A[1]=-x*p*l+v*t;const R=c.as(A);R<1e-9?c.at(A):c.au(A,A,1/R);const O=c.ar();O[0]=v*p*t-x*l,O[1]=x*p*t+v*l;const j=c.as(O);return j<1e-9?c.at(O):c.au(O,O,1/j),{vecEast:O,vecSouth:A}}function pt(b,t,l,p){let v;p?(v=[b,t,p(b,t),1],c.aw(v,v,l)):(v=[b,t,0,1],$i(v,v,l));const x=v[3];return{point:new c.P(v[0]/x,v[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Lo(b,t){return .5+b/t*.5}function Aa(b,t){return b.x>=-t[0]&&b.x<=t[0]&&b.y>=-t[1]&&b.y<=t[1]}function vr(b,t,l,p,v,x,A,R,O,j,U,$,G){const q=l?b.textSizeData:b.iconSizeData,re=c.an(q,t.transform.zoom),he=[256/t.width*2+1,256/t.height*2+1],de=l?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;de.clear();const fe=b.lineVertexArray,me=l?b.text.placedSymbolArray:b.icon.placedSymbolArray,ye=t.transform.width/t.transform.height;let ge=!1;for(let Se=0;Se<me.length;Se++){const Re=me.get(Se);if(Re.hidden||Re.writingMode===c.ao.vertical&&!ge){Ma(Re.numGlyphs,de);continue}ge=!1;const _e=new c.P(Re.anchorX,Re.anchorY),Le={getElevation:G,pitchedLabelPlaneMatrix:p,lineVertexArray:fe,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:_e,unwrappedTileID:O,width:j,height:U,translation:$},qe=un(Re.anchorX,Re.anchorY,Le);if(!Aa(qe.point,he)){Ma(Re.numGlyphs,de);continue}const $e=Lo(t.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Ye=c.ap(q,re,Re),He=x?Ye*t.transform.getPitchedTextCorrection(Re.anchorX,Re.anchorY,O)/$e:Ye*$e,bt=gn({projectionContext:Le,pitchedLabelPlaneMatrixInverse:v,symbol:Re,fontSize:He,flip:!1,keepUpright:A,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:de,aspectRatio:ye,rotateToLine:R});ge=bt.useVertical,(bt.notEnoughRoom||ge||bt.needsFlipping&&gn({projectionContext:Le,pitchedLabelPlaneMatrixInverse:v,symbol:Re,fontSize:He,flip:!0,keepUpright:A,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:de,aspectRatio:ye,rotateToLine:R}).notEnoughRoom)&&Ma(Re.numGlyphs,de)}l?b.text.dynamicLayoutVertexBuffer.updateData(de):b.icon.dynamicLayoutVertexBuffer.updateData(de)}function $n(b,t,l,p,v,x,A,R){const O=x.glyphStartIndex+x.numGlyphs,j=x.lineStartIndex,U=x.lineStartIndex+x.lineLength,$=t.getoffsetX(x.glyphStartIndex),G=t.getoffsetX(O-1),q=mo(b*$,l,p,v,x.segment,j,U,R,A);if(!q)return null;const re=mo(b*G,l,p,v,x.segment,j,U,R,A);return re?R.projectionCache.anyProjectionOccluded?null:{first:q,last:re}:null}function vt(b,t,l,p){return b===c.ao.horizontal&&Math.abs(l.y-t.y)>Math.abs(l.x-t.x)*p?{useVertical:!0}:(b===c.ao.vertical?t.y<l.y:t.x>l.x)?{needsFlipping:!0}:null}function gn(b){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:l,symbol:p,fontSize:v,flip:x,keepUpright:A,glyphOffsetArray:R,dynamicLayoutVertexArray:O,aspectRatio:j,rotateToLine:U}=b,$=v/24,G=p.lineOffsetX*$,q=p.lineOffsetY*$;let re;if(p.numGlyphs>1){const he=p.glyphStartIndex+p.numGlyphs,de=p.lineStartIndex,fe=p.lineStartIndex+p.lineLength,me=$n($,R,G,q,x,p,U,t);if(!me)return{notEnoughRoom:!0};const ye=zo(me.first.point.x,me.first.point.y,t,l),ge=zo(me.last.point.x,me.last.point.y,t,l);if(A&&!x){const Se=vt(p.writingMode,ye,ge,j);if(Se)return Se}re=[me.first];for(let Se=p.glyphStartIndex+1;Se<he-1;Se++){const Re=mo($*R.getoffsetX(Se),G,q,x,p.segment,de,fe,t,U);if(!Re)return{notEnoughRoom:!0};re.push(Re)}re.push(me.last)}else{if(A&&!x){const de=_s(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,fe=p.lineStartIndex+p.segment+1,me=new c.P(t.lineVertexArray.getx(fe),t.lineVertexArray.gety(fe)),ye=_s(me.x,me.y,t),ge=ye.signedDistanceFromCamera>0?ye.point:_n(t.tileAnchorPoint,me,de,1,t),Se=zo(de.x,de.y,t,l),Re=zo(ge.x,ge.y,t,l),_e=vt(p.writingMode,Se,Re,j);if(_e)return _e}const he=mo($*R.getoffsetX(p.glyphStartIndex),G,q,x,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,t,U);if(!he||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};re=[he]}for(const he of re)c.av(O,he.point,he.angle);return{}}function _n(b,t,l,p,v){const x=b.add(b.sub(t)._unit()),A=_s(x.x,x.y,v).point,R=l.sub(A);return l.add(R._mult(p/R.mag()))}function Va(b,t,l){const p=t.projectionCache;if(p.projections[b])return p.projections[b];const v=new c.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),x=_s(v.x,v.y,t);if(x.signedDistanceFromCamera>0)return p.projections[b]=x.point,p.anyProjectionOccluded=p.anyProjectionOccluded||x.isOccluded,x.point;const A=b-l.direction;return _n(l.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(A),t.lineVertexArray.gety(A)),v,l.previousVertex,l.absOffsetX-l.distanceFromAnchor+1,t)}function _s(b,t,l){const p=b+l.translation[0],v=t+l.translation[1];let x;return l.pitchWithMap?(x=pt(p,v,l.pitchedLabelPlaneMatrix,l.getElevation),x.isOccluded=!1):(x=l.transform.projectTileCoordinates(p,v,l.unwrappedTileID,l.getElevation),x.point.x=(.5*x.point.x+.5)*l.width,x.point.y=(.5*-x.point.y+.5)*l.height),x}function zo(b,t,l,p){if(l.pitchWithMap){const v=[b,t,0,1];return c.aw(v,v,p),l.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],l.unwrappedTileID,l.getElevation).point}return{x:b/l.width*2-1,y:1-t/l.height*2}}function un(b,t,l){return l.transform.projectTileCoordinates(b,t,l.unwrappedTileID,l.getElevation)}function kl(b,t,l){return b._unit()._perp()._mult(t*l)}function vs(b,t,l,p,v,x,A,R,O){if(R.projectionCache.offsets[b])return R.projectionCache.offsets[b];const j=l.add(t);if(b+O.direction<p||b+O.direction>=v)return R.projectionCache.offsets[b]=j,j;const U=Va(b+O.direction,R,O),$=kl(U.sub(l),A,O.direction),G=l.add($),q=U.add($);return R.projectionCache.offsets[b]=c.ax(x,j,G,q)||j,R.projectionCache.offsets[b]}function mo(b,t,l,p,v,x,A,R,O){const j=p?b-t:b+t;let U=j>0?1:-1,$=0;p&&(U*=-1,$=Math.PI),U<0&&($+=Math.PI);let G,q=U>0?x+v:x+v+1;R.projectionCache.cachedAnchorPoint?G=R.projectionCache.cachedAnchorPoint:(G=_s(R.tileAnchorPoint.x,R.tileAnchorPoint.y,R).point,R.projectionCache.cachedAnchorPoint=G);let re,he,de=G,fe=G,me=0,ye=0;const ge=Math.abs(j),Se=[];let Re;for(;me+ye<=ge;){if(q+=U,q<x||q>=A)return null;me+=ye,fe=de,he=re;const qe={absOffsetX:ge,direction:U,distanceFromAnchor:me,previousVertex:fe};if(de=Va(q,R,qe),l===0)Se.push(fe),Re=de.sub(fe);else{let $e;const Ye=de.sub(fe);$e=Ye.mag()===0?kl(Va(q+U,R,qe).sub(de),l,U):kl(Ye,l,U),he||(he=fe.add($e)),re=vs(q,$e,de,x,A,he,l,R,qe),Se.push(he),Re=re.sub(he)}ye=Re.mag()}const _e=Re._mult((ge-me)/ye)._add(he||fe),Le=$+Math.atan2(de.y-fe.y,de.x-fe.x);return Se.push(_e),{point:_e,angle:O?Le:0,path:Se}}const qs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ma(b,t){for(let l=0;l<b;l++){const p=t.length;t.resize(p+4),t.float32.set(qs,3*p)}}function $i(b,t,l){const p=t[0],v=t[1];return b[0]=l[0]*p+l[4]*v+l[12],b[1]=l[1]*p+l[5]*v+l[13],b[3]=l[3]*p+l[7]*v+l[15],b}const Ji=100;class Ca{constructor(t,l=new Ur(t.width+200,t.height+200,25),p=new Ur(t.width+200,t.height+200,25)){this.transform=t,this.grid=l,this.ignoredGrid=p,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Ji,this.screenBottomBoundary=t.height+Ji,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,l,p,v,x,A,R,O,j,U,$,G){const q=this.projectAndGetPerspectiveRatio(t.anchorPointX+O[0],t.anchorPointY+O[1],x,U,G),re=p*q.perspectiveRatio;let he;if(A||R)he=this._projectCollisionBox(t,re,v,x,A,R,O,q,U,$,G);else{const Re=q.x+($?$.x*re:0),_e=q.y+($?$.y*re:0);he={allPointsOccluded:!1,box:[Re+t.x1*re,_e+t.y1*re,Re+t.x2*re,_e+t.y2*re]}}const[de,fe,me,ye]=he.box,ge=A?he.allPointsOccluded:q.isOccluded;let Se=ge;return Se||(Se=q.perspectiveRatio<this.perspectiveRatioCutoff),Se||(Se=!this.isInsideGrid(de,fe,me,ye)),Se||l!=="always"&&this.grid.hitTest(de,fe,me,ye,l,j)?{box:[de,fe,me,ye],placeable:!1,offscreen:!1,occluded:ge}:{box:[de,fe,me,ye],placeable:!0,offscreen:this.isOffscreen(de,fe,me,ye),occluded:ge}}placeCollisionCircles(t,l,p,v,x,A,R,O,j,U,$,G,q,re){const he=[],de=new c.P(l.anchorX,l.anchorY),fe=this.getPerspectiveRatio(de.x,de.y,A,re),me=(j?x*this.transform.getPitchedTextCorrection(l.anchorX,l.anchorY,A)/fe:x*fe)/c.aB,ye={getElevation:re,pitchedLabelPlaneMatrix:R,lineVertexArray:p,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:de,unwrappedTileID:A,width:this.transform.width,height:this.transform.height,translation:q},ge=$n(me,v,l.lineOffsetX*me,l.lineOffsetY*me,!1,l,!1,ye);let Se=!1,Re=!1,_e=!0;if(ge){const Le=.5*$*fe+G,qe=new c.P(-100,-100),$e=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ye=new Wi,He=ge.first,bt=ge.last;let wt=[];for(let on=He.path.length-1;on>=1;on--)wt.push(He.path[on]);for(let on=1;on<bt.path.length;on++)wt.push(bt.path[on]);const ct=2.5*Le;if(j){const on=this.projectPathToScreenSpace(wt,ye);wt=on.some(Vn=>Vn.signedDistanceFromCamera<=0)?[]:on.map(Vn=>Vn.point)}let Ft=[];if(wt.length>0){const on=wt[0].clone(),Vn=wt[0].clone();for(let ti=1;ti<wt.length;ti++)on.x=Math.min(on.x,wt[ti].x),on.y=Math.min(on.y,wt[ti].y),Vn.x=Math.max(Vn.x,wt[ti].x),Vn.y=Math.max(Vn.y,wt[ti].y);Ft=on.x>=qe.x&&Vn.x<=$e.x&&on.y>=qe.y&&Vn.y<=$e.y?[wt]:Vn.x<qe.x||on.x>$e.x||Vn.y<qe.y||on.y>$e.y?[]:c.ay([wt],qe.x,qe.y,$e.x,$e.y)}for(const on of Ft){Ye.reset(on,.25*Le);let Vn=0;Vn=Ye.length<=.5*Le?1:Math.ceil(Ye.paddedLength/ct)+1;for(let ti=0;ti<Vn;ti++){const ni=ti/Math.max(Vn-1,1),Ai=Ye.lerp(ni),vi=Ai.x+Ji,In=Ai.y+Ji;he.push(vi,In,Le,0);const Vi=vi-Le,Xr=In-Le,nr=vi+Le,ir=In+Le;if(_e=_e&&this.isOffscreen(Vi,Xr,nr,ir),Re=Re||this.isInsideGrid(Vi,Xr,nr,ir),t!=="always"&&this.grid.hitTestCircle(vi,In,Le,t,U)&&(Se=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Se}}}}return{circles:!O&&Se||!Re||fe<this.perspectiveRatioCutoff?[]:he,offscreen:_e,collisionDetected:Se}}projectPathToScreenSpace(t,l){const p=function(v,x){const A=c.L();return c.aq(A,x.pitchedLabelPlaneMatrix),v.map(R=>{const O=pt(R.x,R.y,A,x.getElevation),j=x.transform.projectTileCoordinates(O.point.x,O.point.y,x.unwrappedTileID,x.getElevation);return j.point.x=(.5*j.point.x+.5)*x.width,j.point.y=(.5*-j.point.y+.5)*x.height,j})}(t,l);return function(v){let x=0,A=0,R=0,O=0;for(let j=0;j<v.length;j++)v[j].isOccluded?(R=j+1,O=0):(O++,O>A&&(A=O,x=R));return v.slice(x,x+A)}(p)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[],p=new c.a2;for(const $ of t){const G=new c.P($.x+Ji,$.y+Ji);p.extend(G),l.push(G)}const{minX:v,minY:x,maxX:A,maxY:R}=p,O=this.grid.query(v,x,A,R).concat(this.ignoredGrid.query(v,x,A,R)),j={},U={};for(const $ of O){const G=$.key;if(j[G.bucketInstanceId]===void 0&&(j[G.bucketInstanceId]={}),j[G.bucketInstanceId][G.featureIndex])continue;const q=[new c.P($.x1,$.y1),new c.P($.x2,$.y1),new c.P($.x2,$.y2),new c.P($.x1,$.y2)];c.az(l,q)&&(j[G.bucketInstanceId][G.featureIndex]=!0,U[G.bucketInstanceId]===void 0&&(U[G.bucketInstanceId]=[]),U[G.bucketInstanceId].push(G.featureIndex))}return U}insertCollisionBox(t,l,p,v,x,A){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:x,collisionGroupID:A,overlapMode:l},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,l,p,v,x,A){const R=p?this.ignoredGrid:this.grid,O={bucketInstanceId:v,featureIndex:x,collisionGroupID:A,overlapMode:l};for(let j=0;j<t.length;j+=4)R.insertCircle(O,t[j],t[j+1],t[j+2])}projectAndGetPerspectiveRatio(t,l,p,v,x){if(x){let A;v?(A=[t,l,v(t,l),1],c.aw(A,A,x)):(A=[t,l,0,1],$i(A,A,x));const R=A[3];return{x:(A[0]/R+1)/2*this.transform.width+Ji,y:(-A[1]/R+1)/2*this.transform.height+Ji,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R*.5,isOccluded:!1,signedDistanceFromCamera:R}}{const A=this.transform.projectTileCoordinates(t,l,p,v);return{x:(A.point.x+1)/2*this.transform.width+Ji,y:(1-A.point.y)/2*this.transform.height+Ji,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A.signedDistanceFromCamera*.5,isOccluded:A.isOccluded,signedDistanceFromCamera:A.signedDistanceFromCamera}}}getPerspectiveRatio(t,l,p,v){const x=this.transform.projectTileCoordinates(t,l,p,v);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(t,l,p,v){return p<Ji||t>=this.screenRightBoundary||v<Ji||l>this.screenBottomBoundary}isInsideGrid(t,l,p,v){return p>=0&&t<this.gridRightBoundary&&v>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const t=c.ag([]);return c.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,l,p,v,x,A,R,O,j,U,$){let G=1,q=0,re=0,he=1;const de=t.anchorPointX+R[0],fe=t.anchorPointY+R[1];if(A&&!x){const wt=this.projectAndGetPerspectiveRatio(de+1,fe,v,j,$),ct=wt.x-O.x,Ft=Math.atan((wt.y-O.y)/ct)+(ct<0?Math.PI:0),on=Math.sin(Ft),Vn=Math.cos(Ft);G=Vn,q=on,re=-on,he=Vn}else if(!A&&x){const wt=Kn(this.transform);G=wt.vecEast[0],q=wt.vecEast[1],re=wt.vecSouth[0],he=wt.vecSouth[1]}let me=O.x,ye=O.y,ge=l;x&&(me=de,ye=fe,ge=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),ge*=this.transform.getPitchedTextCorrection(de,fe,v),U||(ge*=c.ah(.5+O.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(me+=G*U.x*ge+re*U.y*ge,ye+=q*U.x*ge+he*U.y*ge);const Se=t.x1*ge,Re=t.x2*ge,_e=(Se+Re)/2,Le=t.y1*ge,qe=t.y2*ge,$e=(Le+qe)/2,Ye=[{offsetX:Se,offsetY:Le},{offsetX:_e,offsetY:Le},{offsetX:Re,offsetY:Le},{offsetX:Re,offsetY:$e},{offsetX:Re,offsetY:qe},{offsetX:_e,offsetY:qe},{offsetX:Se,offsetY:qe},{offsetX:Se,offsetY:$e}];let He=[];for(const{offsetX:wt,offsetY:ct}of Ye)He.push(new c.P(me+G*wt+re*ct,ye+q*wt+he*ct));let bt=!1;if(x){const wt=He.map(ct=>this.projectAndGetPerspectiveRatio(ct.x,ct.y,v,j,$));bt=wt.some(ct=>!ct.isOccluded),He=wt.map(ct=>new c.P(ct.x,ct.y))}else bt=!0;return{box:c.aA(He),allPointsOccluded:!bt}}}class ri{constructor(t,l,p,v){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?l:-l))):v&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class bs{constructor(t,l,p,v,x){this.text=new ri(t?t.text:null,l,p,x),this.icon=new ri(t?t.icon:null,l,v,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class pu{constructor(t,l,p){this.text=t,this.icon=l,this.skipFade=p}}class Nd{constructor(t,l,p,v,x){this.bucketInstanceId=t,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=x}}class Ol{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const l=++this.maxGroupID;this.collisionGroups[t]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[t]}}function Xs(b,t,l,p,v){const{horizontalAlign:x,verticalAlign:A}=c.aH(b);return new c.P(-(x-.5)*t+p[0]*v,-(A-.5)*l+p[1]*v)}class mh{constructor(t,l,p,v,x){this.transform=t.clone(),this.terrain=l,this.collisionIndex=new Ca(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Ol(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const l=this.terrain;return l?(p,v)=>l.getElevation(t,p,v):null}getBucketParts(t,l,p,v){const x=p.getBucket(l),A=p.latestFeatureIndex;if(!x||!A||l.id!==x.layerIds[0])return;const R=p.collisionBoxArray,O=x.layers[0].layout,j=x.layers[0].paint,U=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),$=p.tileSize/c.$,G=p.tileID.toUnwrapped(),q=O.get("text-rotation-alignment")==="map",re=c.aC(p,1,this.transform.zoom),he=c.aD(this.collisionIndex.transform,p,j.get("text-translate"),j.get("text-translate-anchor")),de=c.aD(this.collisionIndex.transform,p,j.get("icon-translate"),j.get("icon-translate-anchor")),fe=pi(q,this.transform,re);this.retainedQueryData[x.bucketInstanceId]=new Nd(x.bucketInstanceId,A,x.sourceLayerIndex,x.index,p.tileID);const me={bucket:x,layout:O,translationText:he,translationIcon:de,unwrappedTileID:G,pitchedLabelPlaneMatrix:fe,scale:U,textPixelRatio:$,holdingForFade:p.holdingForSymbolFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:c.an(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(v)for(const ye of x.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Se,symbolInstanceEnd:Re}=ye;t.push({sortKey:ge,symbolInstanceStart:Se,symbolInstanceEnd:Re,parameters:me})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:me})}attemptAnchorPlacement(t,l,p,v,x,A,R,O,j,U,$,G,q,re,he,de,fe,me,ye,ge){const Se=c.aE[t.textAnchor],Re=[t.textOffset0,t.textOffset1],_e=Xs(Se,p,v,Re,x),Le=this.collisionIndex.placeCollisionBox(l,G,O,j,U,R,A,de,$.predicate,ye,_e,ge);if((!me||this.collisionIndex.placeCollisionBox(me,G,O,j,U,R,A,fe,$.predicate,ye,_e,ge).placeable)&&Le.placeable){let qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[q.crossTileID].anchor),q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[q.crossTileID]={textOffset:Re,width:p,height:v,anchor:Se,textBoxScale:x,prevAnchor:qe},this.markUsedJustification(re,Se,q,he),re.allowVerticalPlacement&&(this.markUsedOrientation(re,he,q),this.placedOrientations[q.crossTileID]=he),{shift:_e,placedGlyphBoxes:Le}}}placeLayerBucketPart(t,l,p){const{bucket:v,layout:x,translationText:A,translationIcon:R,unwrappedTileID:O,pitchedLabelPlaneMatrix:j,textPixelRatio:U,holdingForFade:$,collisionBoxArray:G,partiallyEvaluatedTextSize:q,collisionGroup:re}=t.parameters,he=x.get("text-optional"),de=x.get("icon-optional"),fe=c.aF(x,"text-overlap","text-allow-overlap"),me=fe==="always",ye=c.aF(x,"icon-overlap","icon-allow-overlap"),ge=ye==="always",Se=x.get("text-rotation-alignment")==="map",Re=x.get("text-pitch-alignment")==="map",_e=x.get("icon-text-fit")!=="none",Le=x.get("symbol-z-order")==="viewport-y",qe=me&&(ge||!v.hasIconData()||de),$e=ge&&(me||!v.hasTextData()||he);!v.collisionArrays&&G&&v.deserializeCollisionBoxes(G);const Ye=this.retainedQueryData[v.bucketInstanceId].tileID,He=this._getTerrainElevationFunc(Ye),bt=this.transform.getFastPathSimpleProjectionMatrix(Ye),wt=(ct,Ft,on)=>{var Vn,ti;if(l[ct.crossTileID])return;if($)return void(this.placements[ct.crossTileID]=new pu(!1,!1,!1));let ni=!1,Ai=!1,vi=!0,In=null,Vi={box:null,placeable:!1,offscreen:null,occluded:!1},Xr={placeable:!1},nr=null,ir=null,ua=null,fl=0,eo=0,pl=0;Ft.textFeatureIndex?fl=Ft.textFeatureIndex:ct.useRuntimeCollisionCircles&&(fl=ct.featureIndex),Ft.verticalTextFeatureIndex&&(eo=Ft.verticalTextFeatureIndex);const rc=Ft.textBox;if(rc){const to=Yi=>{let xr=c.ao.horizontal;if(v.allowVerticalPlacement&&!Yi&&this.prevPlacement){const Oa=this.prevPlacement.placedOrientations[ct.crossTileID];Oa&&(this.placedOrientations[ct.crossTileID]=Oa,xr=Oa,this.markUsedOrientation(v,xr,ct))}return xr},To=(Yi,xr)=>{if(v.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&Ft.verticalTextBox){for(const Oa of v.writingModes)if(Oa===c.ao.vertical?(Vi=xr(),Xr=Vi):Vi=Yi(),Vi&&Vi.placeable)break}else Vi=Yi()},Yo=ct.textAnchorOffsetStartIndex,ka=ct.textAnchorOffsetEndIndex;if(ka===Yo){const Yi=(xr,Oa)=>{const Wr=this.collisionIndex.placeCollisionBox(xr,fe,U,Ye,O,Re,Se,A,re.predicate,He,void 0,bt);return Wr&&Wr.placeable&&(this.markUsedOrientation(v,Oa,ct),this.placedOrientations[ct.crossTileID]=Oa),Wr};To(()=>Yi(rc,c.ao.horizontal),()=>{const xr=Ft.verticalTextBox;return v.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&xr?Yi(xr,c.ao.vertical):{box:null,offscreen:null}}),to(Vi&&Vi.placeable)}else{let Yi=c.aE[(ti=(Vn=this.prevPlacement)===null||Vn===void 0?void 0:Vn.variableOffsets[ct.crossTileID])===null||ti===void 0?void 0:ti.anchor];const xr=(Wr,vp,Lu)=>{const Ho=Wr.x2-Wr.x1,qo=Wr.y2-Wr.y1,Pa=ct.textBoxScale,ml=_e&&ye==="never"?vp:null;let gl=null,Xc=fe==="never"?1:2,af="never";Yi&&Xc++;for(let Ls=0;Ls<Xc;Ls++){for(let of=Yo;of<ka;of++){const Hh=v.textAnchorOffsets.get(of);if(Yi&&Hh.textAnchor!==Yi)continue;const Wc=this.attemptAnchorPlacement(Hh,Wr,Ho,qo,Pa,Se,Re,U,Ye,O,re,af,ct,v,Lu,A,R,ml,He);if(Wc&&(gl=Wc.placedGlyphBoxes,gl&&gl.placeable))return ni=!0,In=Wc.shift,gl}Yi?Yi=null:af=fe}return p&&!gl&&(gl={box:this.collisionIndex.placeCollisionBox(rc,"always",U,Ye,O,Re,Se,A,re.predicate,He,void 0,bt).box,offscreen:!1,placeable:!1,occluded:!1}),gl};To(()=>xr(rc,Ft.iconBox,c.ao.horizontal),()=>{const Wr=Ft.verticalTextBox;return v.allowVerticalPlacement&&(!Vi||!Vi.placeable)&&ct.numVerticalGlyphVertices>0&&Wr?xr(Wr,Ft.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}}),Vi&&(ni=Vi.placeable,vi=Vi.offscreen);const Oa=to(Vi&&Vi.placeable);if(!ni&&this.prevPlacement){const Wr=this.prevPlacement.variableOffsets[ct.crossTileID];Wr&&(this.variableOffsets[ct.crossTileID]=Wr,this.markUsedJustification(v,Wr.anchor,ct,Oa))}}}if(nr=Vi,ni=nr&&nr.placeable,vi=nr&&nr.offscreen,ct.useRuntimeCollisionCircles&&ct.centerJustifiedTextSymbolIndex>=0){const to=v.text.placedSymbolArray.get(ct.centerJustifiedTextSymbolIndex),To=c.ap(v.textSizeData,q,to),Yo=x.get("text-padding");ir=this.collisionIndex.placeCollisionCircles(fe,to,v.lineVertexArray,v.glyphOffsetArray,To,O,j,p,Re,re.predicate,ct.collisionCircleDiameter,Yo,A,He),ir.circles.length&&ir.collisionDetected&&!p&&c.w("Collisions detected, but collision boxes are not shown"),ni=me||ir.circles.length>0&&!ir.collisionDetected,vi=vi&&ir.offscreen}if(Ft.iconFeatureIndex&&(pl=Ft.iconFeatureIndex),Ft.iconBox){const to=To=>this.collisionIndex.placeCollisionBox(To,ye,U,Ye,O,Re,Se,R,re.predicate,He,_e&&In?In:void 0,bt);Xr&&Xr.placeable&&Ft.verticalIconBox?(ua=to(Ft.verticalIconBox),Ai=ua.placeable):(ua=to(Ft.iconBox),Ai=ua.placeable),vi=vi&&ua.offscreen}const Pu=he||ct.numHorizontalGlyphVertices===0&&ct.numVerticalGlyphVertices===0,qc=de||ct.numIconVertices===0;Pu||qc?qc?Pu||(Ai=Ai&&ni):ni=Ai&&ni:Ai=ni=Ai&&ni;const Ps=Ai&&ua.placeable;if(ni&&nr.placeable&&this.collisionIndex.insertCollisionBox(nr.box,fe,x.get("text-ignore-placement"),v.bucketInstanceId,Xr&&Xr.placeable&&eo?eo:fl,re.ID),Ps&&this.collisionIndex.insertCollisionBox(ua.box,ye,x.get("icon-ignore-placement"),v.bucketInstanceId,pl,re.ID),ir&&ni&&this.collisionIndex.insertCollisionCircles(ir.circles,fe,x.get("text-ignore-placement"),v.bucketInstanceId,fl,re.ID),p&&this.storeCollisionData(v.bucketInstanceId,on,Ft,nr,ua,ir),ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ct.crossTileID]=new pu((ni||qe)&&!nr?.occluded,(Ai||$e)&&!ua?.occluded,vi||v.justReloaded),l[ct.crossTileID]=!0};if(Le){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ct=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ft=ct.length-1;Ft>=0;--Ft){const on=ct[Ft];wt(v.symbolInstances.get(on),v.collisionArrays[on],on)}}else for(let ct=t.symbolInstanceStart;ct<t.symbolInstanceEnd;ct++)wt(v.symbolInstances.get(ct),v.collisionArrays[ct],ct);v.justReloaded=!1}storeCollisionData(t,l,p,v,x,A){if(p.textBox||p.iconBox){let R,O;this.collisionBoxArrays.has(t)?R=this.collisionBoxArrays.get(t):(R=new Map,this.collisionBoxArrays.set(t,R)),R.has(l)?O=R.get(l):(O={text:null,icon:null},R.set(l,O)),p.textBox&&(O.text=v.box),p.iconBox&&(O.icon=x.box)}if(A){let R=this.collisionCircleArrays[t];R===void 0&&(R=this.collisionCircleArrays[t]=[]);for(let O=0;O<A.circles.length;O+=4)R.push(A.circles[O+0]-Ji),R.push(A.circles[O+1]-Ji),R.push(A.circles[O+2]),R.push(A.collisionDetected?1:0)}}markUsedJustification(t,l,p,v){let x;x=v===c.ao.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.aG(l)];const A=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const R of A)R>=0&&(t.text.placedSymbolArray.get(R).crossTileID=x>=0&&R!==x?0:p.crossTileID)}markUsedOrientation(t,l,p){const v=l===c.ao.horizontal||l===c.ao.horizontalOnly?l:0,x=l===c.ao.vertical?l:0,A=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const R of A)t.text.placedSymbolArray.get(R).placedOrientation=v;p.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const v=l?l.symbolFadeChange(t):1,x=l?l.opacities:{},A=l?l.variableOffsets:{},R=l?l.placedOrientations:{};for(const O in this.placements){const j=this.placements[O],U=x[O];U?(this.opacities[O]=new bs(U,v,j.text,j.icon),p=p||j.text!==U.text.placed||j.icon!==U.icon.placed):(this.opacities[O]=new bs(null,v,j.text,j.icon,j.skipFade),p=p||j.text||j.icon)}for(const O in x){const j=x[O];if(!this.opacities[O]){const U=new bs(j,v,!1,!1);U.isHidden()||(this.opacities[O]=U,p=p||j.text.placed||j.icon.placed)}}for(const O in A)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=A[O]);for(const O in R)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=R[O]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:t)}updateLayerOpacities(t,l){const p={};for(const v of l){const x=v.getBucket(t);x&&v.latestFeatureIndex&&t.id===x.layerIds[0]&&this.updateBucketOpacities(x,v.tileID,p,v.collisionBoxArray)}}updateBucketOpacities(t,l,p,v){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const x=t.layers[0],A=x.layout,R=new bs(null,0,!1,!1,!0),O=A.get("text-allow-overlap"),j=A.get("icon-allow-overlap"),U=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=A.get("text-rotation-alignment")==="map",G=A.get("text-pitch-alignment")==="map",q=A.get("icon-text-fit")!=="none",re=new bs(null,0,O&&(j||!t.hasIconData()||A.get("icon-optional")),j&&(O||!t.hasTextData()||A.get("text-optional")),!0);!t.collisionArrays&&v&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(v);const he=(fe,me,ye)=>{for(let ge=0;ge<me/4;ge++)fe.opacityVertexArray.emplaceBack(ye);fe.hasVisibleVertices=fe.hasVisibleVertices||ye!==Vr},de=this.collisionBoxArrays.get(t.bucketInstanceId);for(let fe=0;fe<t.symbolInstances.length;fe++){const me=t.symbolInstances.get(fe),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:ge,crossTileID:Se}=me;let Re=this.opacities[Se];p[Se]?Re=R:Re||(Re=re,this.opacities[Se]=Re),p[Se]=!0;const _e=me.numIconVertices>0,Le=this.placedOrientations[me.crossTileID],qe=Le===c.ao.vertical,$e=Le===c.ao.horizontal||Le===c.ao.horizontalOnly;if(ye>0||ge>0){const He=Hf(Re.text);he(t.text,ye,qe?Vr:He),he(t.text,ge,$e?Vr:He);const bt=Re.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(Ft=>{Ft>=0&&(t.text.placedSymbolArray.get(Ft).hidden=bt||qe?1:0)}),me.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=bt||$e?1:0);const wt=this.variableOffsets[me.crossTileID];wt&&this.markUsedJustification(t,wt.anchor,me,Le);const ct=this.placedOrientations[me.crossTileID];ct&&(this.markUsedJustification(t,"left",me,ct),this.markUsedOrientation(t,ct,me))}if(_e){const He=Hf(Re.icon),bt=!(q&&me.verticalPlacedIconSymbolIndex&&qe);me.placedIconSymbolIndex>=0&&(he(t.icon,me.numIconVertices,bt?He:Vr),t.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=Re.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(he(t.icon,me.numVerticalIconVertices,bt?Vr:He),t.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}const Ye=de&&de.has(fe)?de.get(fe):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const He=t.collisionArrays[fe];if(He){let bt=new c.P(0,0);if(He.textBox||He.verticalTextBox){let wt=!0;if(U){const ct=this.variableOffsets[Se];ct?(bt=Xs(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),$&&bt._rotate(G?-this.transform.bearingInRadians:this.transform.bearingInRadians)):wt=!1}if(He.textBox||He.verticalTextBox){let ct;He.textBox&&(ct=qe),He.verticalTextBox&&(ct=$e),mu(t.textCollisionBox.collisionVertexArray,Re.text.placed,!wt||ct,Ye.text,bt.x,bt.y)}}if(He.iconBox||He.verticalIconBox){const wt=!!(!$e&&He.verticalIconBox);let ct;He.iconBox&&(ct=wt),He.verticalIconBox&&(ct=!wt),mu(t.iconCollisionBox.collisionVertexArray,Re.icon.placed,ct,Ye.icon,q?bt.x:0,q?bt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>t}setStale(){this.stale=!0}}function mu(b,t,l,p,v,x){p&&p.length!==0||(p=[0,0,0,0]);const A=p[0]-Ji,R=p[1]-Ji,O=p[2]-Ji,j=p[3]-Ji;b.emplaceBack(t?1:0,l?1:0,v||0,x||0,A,R),b.emplaceBack(t?1:0,l?1:0,v||0,x||0,O,R),b.emplaceBack(t?1:0,l?1:0,v||0,x||0,O,j),b.emplaceBack(t?1:0,l?1:0,v||0,x||0,A,j)}const xs=Math.pow(2,25),Jr=Math.pow(2,24),Zf=Math.pow(2,17),uy=Math.pow(2,16),Yf=Math.pow(2,9),bm=Math.pow(2,8),gh=Math.pow(2,1);function Hf(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const t=b.placed?1:0,l=Math.floor(127*b.opacity);return l*xs+t*Jr+l*Zf+t*uy+l*Yf+t*bm+l*gh+t}const Vr=0;class yh{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,l,p,v,x){const A=this._bucketParts;for(;this._currentTileIndex<t.length;)if(l.getBucketParts(A,v,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((R,O)=>R.sortKey-O.sortKey));this._currentPartIndex<A.length;)if(l.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,x())return!0;return!1}}class qf{constructor(t,l,p,v,x,A,R,O){this.placement=new mh(t,l,A,R,O),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(t,l,p){const v=F.now(),x=()=>!this._forceFullPlacement&&F.now()-v>2;for(;this._currentPlacementIndex>=0;){const A=l[t[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=R)&&(!A.maxzoom||A.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new yh(A)),this._inProgressLayer.continuePlacement(p[A.source],this.placement,this._showCollisionBoxes,A,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ws=512/c.$/2;class Pl{constructor(t,l,p){this.tileID=t,this.bucketInstanceId=p,this._symbolsByKey={};const v=new Map;for(let x=0;x<l.length;x++){const A=l.get(x),R=A.key,O=v.get(R);O?O.push(A):v.set(R,[A])}for(const[x,A]of v){const R={positions:A.map(O=>({x:Math.floor(O.anchorX*Ws),y:Math.floor(O.anchorY*Ws)})),crossTileIDs:A.map(O=>O.crossTileID)};if(R.positions.length>128){const O=new c.aI(R.positions.length,16,Uint16Array);for(const{x:j,y:U}of R.positions)O.add(j,U);O.finish(),delete R.positions,R.index=O}this._symbolsByKey[x]=R}}getScaledCoordinates(t,l){const{x:p,y:v,z:x}=this.tileID.canonical,{x:A,y:R,z:O}=l.canonical,j=Ws/Math.pow(2,O-x),U=(R*c.$+t.anchorY)*j,$=v*c.$*Ws;return{x:Math.floor((A*c.$+t.anchorX)*j-p*c.$*Ws),y:Math.floor(U-$)}}findMatches(t,l,p){const v=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let x=0;x<t.length;x++){const A=t.get(x);if(A.crossTileID)continue;const R=this._symbolsByKey[A.key];if(!R)continue;const O=this.getScaledCoordinates(A,l);if(R.index){const j=R.index.range(O.x-v,O.y-v,O.x+v,O.y+v).sort();for(const U of j){const $=R.crossTileIDs[U];if(!p[$]){p[$]=!0,A.crossTileID=$;break}}}else if(R.positions)for(let j=0;j<R.positions.length;j++){const U=R.positions[j],$=R.crossTileIDs[j];if(Math.abs(U.x-O.x)<=v&&Math.abs(U.y-O.y)<=v&&!p[$]){p[$]=!0,A.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class xm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class gu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const l=Math.round((t-this.lng)/360);if(l!==0)for(const p in this.indexes){const v=this.indexes[p],x={};for(const A in v){const R=v[A];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+l),x[R.tileID.key]=R}this.indexes[p]=x}this.lng=t}addBucket(t,l,p){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let x=0;x<l.symbolInstances.length;x++)l.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const v=this.usedCrossTileIDs[t.overscaledZ];for(const x in this.indexes){const A=this.indexes[x];if(Number(x)>t.overscaledZ)for(const R in A){const O=A[R];O.tileID.isChildOf(t)&&O.findMatches(l.symbolInstances,t,v)}else{const R=A[t.scaledTo(Number(x)).key];R&&R.findMatches(l.symbolInstances,t,v)}}for(let x=0;x<l.symbolInstances.length;x++){const A=l.symbolInstances.get(x);A.crossTileID||(A.crossTileID=p.generate(),v[A.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Pl(t,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(t,l){for(const p of l.getCrossTileIDsLists())for(const v of p)delete this.usedCrossTileIDs[t][v]}removeStaleBuckets(t){let l=!1;for(const p in this.indexes){const v=this.indexes[p];for(const x in v)t[v[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[x]),delete v[x],l=!0)}return l}}class ws{constructor(){this.layerIndexes={},this.crossTileIDs=new xm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,l,p){let v=this.layerIndexes[t.id];v===void 0&&(v=this.layerIndexes[t.id]=new gu);let x=!1;const A={};v.handleWrapJump(p);for(const R of l){const O=R.getBucket(t);O&&t.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(R.tileID,O,this.crossTileIDs)&&(x=!0),A[O.bucketInstanceId]=!0)}return v.removeStaleBuckets(A)&&(x=!0),x}pruneUnusedLayers(t){const l={};t.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}var Xf="void main() {fragColor=vec4(1.0);}";const sa={prelude:zn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:zn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:zn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:zn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:zn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:zn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:zn(Xf,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:zn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:zn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:zn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:zn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:zn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:zn(Xf,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:zn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:zn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:zn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:zn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:zn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:zn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:zn(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:zn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:zn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:zn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:zn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:zn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:zn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:zn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:zn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:zn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:zn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function zn(b,t){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=t.match(/in ([\w]+) ([\w]+)/g),v=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=x?x.concat(v):v,R={};return{fragmentSource:b=b.replace(l,(O,j,U,$,G)=>(R[G]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${G}
in ${U} ${$} ${G};
#else
uniform ${U} ${$} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${U} ${$} ${G} = u_${G};
#endif
`)),vertexSource:t=t.replace(l,(O,j,U,$,G)=>{const q=$==="float"?"vec2":"vec4",re=G.match(/color/)?"color":q;return R[G]?j==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${U} ${q} a_${G};
out ${U} ${$} ${G};
#else
uniform ${U} ${$} u_${G};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${U} ${$} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${re}(a_${G}, u_${G}_t);
#else
    ${U} ${$} ${G} = u_${G};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${U} ${q} a_${G};
#else
uniform ${U} ${$} u_${G};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${U} ${$} ${G} = a_${G};
#else
    ${U} ${$} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${U} ${$} ${G} = unpack_mix_${re}(a_${G}, u_${G}_t);
#else
    ${U} ${$} ${G} = u_${G};
#endif
`}),staticAttributes:p,staticUniforms:A}}class Ll{constructor(t,l,p){this.vertexBuffer=t,this.indexBuffer=l,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ya=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const Sc="#define PROJECTION_MERCATOR",xn="mercator";class Ga{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return xn}get shaderDefine(){return Sc}get shaderPreludeCode(){return sa.projectionMercator}get vertexShaderPreludeCode(){return sa.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,l,p,v,x){if(this._cachedMesh)return this._cachedMesh;const A=new c.aL;A.emplaceBack(0,0),A.emplaceBack(c.$,0),A.emplaceBack(0,c.$),A.emplaceBack(c.$,c.$);const R=t.createVertexBuffer(A,ya.members),O=c.aM.simpleSegment(0,0,4,2),j=new c.aN;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);const U=t.createIndexBuffer(j);return this._cachedMesh=new Ll(R,U,O),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class Ec{constructor(t=0,l=0,p=0,v=0){if(isNaN(t)||t<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=l,this.left=p,this.right=v}interpolate(t,l,p){return l.top!=null&&t.top!=null&&(this.top=c.C.number(t.top,l.top,p)),l.bottom!=null&&t.bottom!=null&&(this.bottom=c.C.number(t.bottom,l.bottom,p)),l.left!=null&&t.left!=null&&(this.left=c.C.number(t.left,l.left,p)),l.right!=null&&t.right!=null&&(this.right=c.C.number(t.right,l.right,p)),this}getCenter(t,l){const p=c.ah((this.left+t-this.right)/2,0,t),v=c.ah((this.top+l-this.bottom)/2,0,l);return new c.P(p,v)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ec(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function zl(b,t){if(!b.renderWorldCopies||b.lngRange)return;const l=t.lng-b.center.lng;t.lng+=l>180?-360:l<-180?360:0}function Cr(b){return Math.max(0,Math.floor(b))}class er{constructor(t,l,p,v,x,A){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=A===void 0||!!A,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=v??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Cr(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ec,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,l,p){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Cr(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new Ec(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!p&&t.autoCalculateNearFarZ,l&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const l=c.aO(t,-180,180)*Math.PI/180;var p,v,x,A,R,O,j,U,$;this._bearingInRadians!==l&&(this._unmodified=!1,this._bearingInRadians=l,this._calcMatrices(),this._rotationMatrix=C(),p=this._rotationMatrix,x=-this._bearingInRadians,A=(v=this._rotationMatrix)[0],R=v[1],O=v[2],j=v[3],U=Math.sin(x),$=Math.cos(x),p[0]=A*$+O*U,p[1]=R*$+j*U,p[2]=A*-U+O*$,p[3]=R*-U+j*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const l=c.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==l&&(this._unmodified=!1,this._pitchInRadians=l,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const l=t/180*Math.PI;this._rollInRadians!==l&&(this._unmodified=!1,this._rollInRadians=l,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(t){t=c.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=c.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const l=this.getConstrained(this._center,t).zoom;this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this._tileZoom=Math.max(0,Math.floor(l)),this._scale=c.af(l),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,l){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=l,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,l,p){this._unmodified=!1,this._edgeInsets.interpolate(t,l,p),this._constrain(),this._calcMatrices()}resize(t,l,p=!0){this._width=t,this._height=l,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Wn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(t,l){return this._callbacks.getConstrained(t,l)}getCameraQueryGeometry(t,l){if(l.length===1)return[l[0],t];{const{minX:p,minY:v,maxX:x,maxY:A}=c.a2.fromPoints(l).extend(t);return[new c.P(p,v),new c.P(x,v),new c.P(x,A),new c.P(p,A),new c.P(p,v)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:l,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(l),this.setZoom(p),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=c.ag(new Float64Array(16));c.N(t,t,[this._width/2,-this._height/2,1]),c.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=c.ag(new Float64Array(16)),c.N(t,t,[1,-1,1]),c.M(t,t,[-1,-1,0]),c.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,l,p,v){const x=p!==void 0?p:this.bearing,A=v=v!==void 0?v:this.pitch,R=c.a1.fromLngLat(t,l),O=-Math.cos(c.ae(A)),j=Math.sin(c.ae(A)),U=j*Math.sin(c.ae(x)),$=-j*Math.cos(c.ae(x));let G=this.elevation;const q=l-G;let re;O*q>=0||Math.abs(O)<.1?(re=1e4,G=l+re*O):re=-q/O;let he,de,fe=c.aQ(1,R.y),me=0;do{if(me+=1,me>10)break;de=re/fe,he=new c.a1(R.x+U*de,R.y+$*de),fe=1/he.meterInMercatorCoordinateUnits()}while(Math.abs(re-de*fe)>1e-12);return{center:he.toLngLat(),elevation:G,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/de/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const l=c.aj(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/l,v=c.a1.fromLngLat(this.center,this.elevation),x=tt(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=t;const A=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),c.aQ(x.z,v.y),this.bearing,this.pitch);this._elevation=A.elevation,this._center=A.center,this.setZoom(A.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=c.aj(1,this.center.lat)*this.worldSize;return tt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const l=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/l,t.canonical.y/l,1/l/c.$,1/l/c.$]}}class Dr{constructor(t,l){this.min=t,this.max=l,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(t){const l=[t%2==0,t<2],p=c.aT(this.min),v=c.aT(this.max);for(let x=0;x<l.length;x++)p[x]=l[x]?this.min[x]:this.center[x],v[x]=l[x]?this.center[x]:this.max[x];return v[2]=this.max[2],new Dr(p,v)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let l=!0;for(let p=0;p<t.planes.length;p++){const v=this.intersectsPlane(t.planes[p]);if(v===0)return 0;v===1&&(l=!1)}return l?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let l=t[3],p=t[3];for(let v=0;v<3;v++)t[v]>0?(l+=t[v]*this.min[v],p+=t[v]*this.max[v]):(p+=t[v]*this.min[v],l+=t[v]*this.max[v]);return l>=0?2:p<0?0:1}}class Ir{distanceToTile2d(t,l,p,v){const x=v.distanceX([t,l]),A=v.distanceY([t,l]);return Math.hypot(x,A)}getWrap(t,l,p){return p}getTileBoundingVolume(t,l,p,v){var x,A;let R=0,O=0;if(v?.terrain){const U=new c.Z(t.z,l,t.z,t.x,t.y),$=v.terrain.getMinMaxElevation(U);R=(x=$.minElevation)!==null&&x!==void 0?x:Math.min(0,p),O=(A=$.maxElevation)!==null&&A!==void 0?A:Math.max(0,p)}const j=1<<t.z;return new Dr([l+t.x/j,t.y/j,R],[l+(t.x+1)/j,(t.y+1)/j,O])}allowVariableZoom(t,l){const p=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,v=c.ah(78.5-p/2,0,60);return!!l.terrain||t.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class wi{constructor(t,l,p){this.points=t,this.planes=l,this.aabb=p}static fromInvProjectionMatrix(t,l=1,p=0,v,x){const A=x?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],R=Math.pow(2,p),O=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(G=>function(q,re,he,de){const fe=c.aw([],q,re),me=1/fe[3]/he*de;return c.aY(fe,fe,[me,me,1/fe[3],me])}(G,t,l,R));v&&function(G,q,re,he){const de=he?4:0,fe=he?0:4;let me=0;const ye=[],ge=[];for(let _e=0;_e<4;_e++){const Le=c.aU([],G[_e+fe],G[_e+de]),qe=c.aZ(Le);c.aR(Le,Le,1/qe),ye.push(qe),ge.push(Le)}for(let _e=0;_e<4;_e++){const Le=c.a_(G[_e+de],ge[_e],re);me=Le!==null&&Le>=0?Math.max(me,Le):Math.max(me,ye[_e])}const Se=function(_e,Le){const qe=c.aU([],_e[Le[0]],_e[Le[1]]),$e=c.aU([],_e[Le[2]],_e[Le[1]]),Ye=[0,0,0,0];return c.aV(Ye,c.aW([],qe,$e)),Ye[3]=-c.aX(Ye,_e[Le[0]]),Ye}(G,q),Re=function(_e,Le){const qe=c.a$(_e),$e=c.b0([],_e,1/qe),Ye=c.aU([],Le,c.aR([],$e,c.aX(Le,$e))),He=c.a$(Ye);if(He>0){const bt=Math.sqrt(1-$e[3]*$e[3]),wt=c.aR([],$e,-$e[3]),ct=c.aS([],wt,c.aR([],Ye,bt/He));return c.b1(Le,ct)}return null}(re,Se);if(Re!==null){const _e=Re/c.aX(ge[0],Se);me=Math.min(me,_e)}for(let _e=0;_e<4;_e++){const Le=Math.min(me,ye[_e]);G[_e+fe]=[G[_e+de][0]+ge[_e][0]*Le,G[_e+de][1]+ge[_e][1]*Le,G[_e+de][2]+ge[_e][2]*Le,1]}}(O,A[0],v,x);const j=A.map(G=>{const q=c.aU([],O[G[0]],O[G[1]]),re=c.aU([],O[G[2]],O[G[1]]),he=c.aV([],c.aW([],q,re)),de=-c.aX(he,O[G[1]]);return he.concat(de)}),U=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const G of O)for(let q=0;q<3;q++)U[q]=Math.min(U[q],G[q]),$[q]=Math.max($[q],G[q]);return new wi(O,j,new Dr(U,$))}}class Ts{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,l,p){return this._helper.interpolatePadding(t,l,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,l,p=!0){this._helper.resize(t,l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,l){this._helper.overrideNearFarZ(t,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,l){}constructor(t,l,p,v,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new er({calcMatrices:()=>{this._calcMatrices()},getConstrained:(A,R)=>this.getConstrained(A,R)},t,l,p,v,x),this._coveringTilesDetailsProvider=new Ir}clone(){const t=new Ts;return t.apply(this),t}apply(t,l,p){this._helper.apply(t,l,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const l=[new c.b2(0,t)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new c.P(0,0)),v=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),A=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),R=Math.floor(Math.min(p.x,v.x,x.x,A.x)),O=Math.floor(Math.max(p.x,v.x,x.x,A.x)),j=1;for(let U=R-j;U<=O+j;U++)U!==0&&l.push(new c.b2(U,t))}return l}getCameraFrustum(){return wi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const l=this.screenPointToLocation(this.centerPoint,t),p=t?t.getElevationForLngLatZoom(l,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(t,l){const p=c.aj(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(l,p),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),A=c.a1.fromLngLat(t),R=new c.a1(A.x-(v.x-x.x),A.y-(v.y-x.y));this.setCenter(R?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,l){return l?this.coordinatePoint(c.a1.fromLngLat(t),l.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(t))}screenPointToLocation(t,l){var p;return(p=this.screenPointToMercatorCoordinate(t,l))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(t,l){if(l){const p=l.pointCoordinate(t);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,l){const p=l||0,v=[t.x,t.y,0,1],x=[t.x,t.y,1,1];c.aw(v,v,this._pixelMatrixInverse),c.aw(x,x,this._pixelMatrixInverse);const A=v[3],R=x[3],O=v[1]/A,j=x[1]/R,U=v[2]/A,$=x[2]/R,G=U===$?0:(p-U)/($-U);return new c.a1(c.C.number(v[0]/A,x[0]/R,G)/this.worldSize,c.C.number(O,j,G)/this.worldSize,p)}coordinatePoint(t,l=0,p=this._pixelMatrix){const v=[t.x*this.worldSize,t.y*this.worldSize,l,1];return c.aw(v,v,p),new c.P(v[0]/v[3],v[1]/v[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ge(this));return new Wn().extend(this.screenPointToLocation(new c.P(0,t))).extend(this.screenPointToLocation(new c.P(this._helper._width,t))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(t,l){return l?l.pointCoordinate(t)!=null:t.y>this.height/2-Ge(this)}calculatePosMatrix(t,l=!1,p){var v;const x=(v=t.key)!==null&&v!==void 0?v:c.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),A=l?this._alignedPosMatrixCache:this._posMatrixCache;if(A.has(x)){const j=A.get(x);return p?j.f32:j.f64}const R=je(t,this.worldSize);c.O(R,l?this._alignedProjMatrix:this._viewProjMatrix,R);const O={f64:R,f32:new Float32Array(R)};return A.set(x,O),p?O.f32:O.f64}calculateFogMatrix(t){const l=t.key,p=this._fogMatrixCacheF32;if(p.has(l))return p.get(l);const v=je(t,this.worldSize);return c.O(v,this._fogMatrix,v),p.set(l,new Float32Array(v)),p.get(l)}getConstrained(t,l){l=c.ah(+l,this.minZoom,this.maxZoom);const p={center:new c.S(t.lng,t.lat),zoom:l};let v=this._helper._lngRange;if(!this._helper._renderWorldCopies&&v===null){const ye=179.9999999999;v=[-ye,ye]}const x=this.tileSize*c.af(p.zoom);let A=0,R=x,O=0,j=x,U=0,$=0;const{x:G,y:q}=this.size;if(this._helper._latRange){const ye=this._helper._latRange;A=c.U(ye[1])*x,R=c.U(ye[0])*x,R-A<q&&(U=q/(R-A))}v&&(O=c.aO(c.V(v[0])*x,0,x),j=c.aO(c.V(v[1])*x,0,x),j<O&&(j+=x),j-O<G&&($=G/(j-O)));const{x:re,y:he}=we(x,t);let de,fe;const me=Math.max($||0,U||0);if(me){const ye=new c.P($?(j+O)/2:re,U?(R+A)/2:he);return p.center=Oe(x,ye).wrap(),p.zoom+=c.ak(me),p}if(this._helper._latRange){const ye=q/2;he-ye<A&&(fe=A+ye),he+ye>R&&(fe=R-ye)}if(v){const ye=(O+j)/2;let ge=re;this._helper._renderWorldCopies&&(ge=c.aO(re,ye-x/2,ye+x/2));const Se=G/2;ge-Se<O&&(de=O+Se),ge+Se>j&&(de=j-Se)}if(de!==void 0||fe!==void 0){const ye=new c.P(de??re,fe??he);p.center=Oe(x,ye).wrap()}return p}calculateCenterFromCameraLngLatAlt(t,l,p,v){return this._helper.calculateCenterFromCameraLngLatAlt(t,l,p,v)}_calculateNearFarZIfNeeded(t,l,p){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=t-v*this._helper._pixelPerMeter/Math.cos(l),A=v<0?x:t,R=Math.PI/2+this.pitchInRadians,O=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+p.y/this.height),j=Math.sin(O)*A/Math.sin(c.ah(Math.PI-R-O,.01,Math.PI-.01)),U=Ge(this),$=Math.atan(U/this._helper.cameraToCenterDistance),G=c.ae(.75),q=$>G?2*$*(.5+p.y/(2*U)):G,re=Math.sin(q)*A/Math.sin(c.ah(Math.PI-R-q,.01,Math.PI-.01)),he=Math.min(j,re);this._helper._farZ=1.01*(Math.cos(Math.PI/2-l)*he+A),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,l=we(this.worldSize,this.center),p=l.x,v=l.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const x=c.ae(Math.min(this.pitch,xe)),A=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let R;this._calculateNearFarZIfNeeded(A,x,t),R=new Float64Array(16),c.b4(R,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,R),R[8]=2*-t.x/this._helper._width,R[9]=2*t.y/this._helper._height,this._projectionMatrix=c.b5(R),c.N(R,R,[1,-1,1]),c.M(R,R,[0,0,-this._helper.cameraToCenterDistance]),c.b6(R,R,-this.rollInRadians),c.b7(R,R,this.pitchInRadians),c.b6(R,R,-this.bearingInRadians),c.M(R,R,[-p,-v,0]),this._mercatorMatrix=c.N([],R,[this.worldSize,this.worldSize,this.worldSize]),c.N(R,R,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,R),c.M(R,R,[0,0,-this.elevation]),this._viewProjMatrix=R,this._invViewProjMatrix=c.aq([],R);const O=[0,0,-1,1];c.aw(O,O,this._invViewProjMatrix),this._cameraPosition=[O[0]/O[3],O[1]/O[3],O[2]/O[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,A,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-p,-v,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,R);const j=this._helper._width%2/2,U=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),G=Math.sin(-this.bearingInRadians),q=p-Math.round(p)+$*j+G*U,re=v-Math.round(v)+$*U+G*j,he=new Float64Array(R);if(c.M(he,he,[q>.5?q-1:q,re>.5?re-1:re,0]),this._alignedProjMatrix=he,R=c.aq(new Float64Array(16),this._pixelMatrix),!R)throw new Error("failed to invert matrix");this._pixelMatrixInverse=R,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new c.P(0,0)),l=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.aw(l,l,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=c.aj(1,this.center.lat)*this.worldSize;return tt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,l){const p=c.a1.fromLngLat(t),v=[p.x*this.worldSize,p.y*this.worldSize,l,1];return c.aw(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(t){const{overscaledTileID:l,aligned:p,applyTerrainMatrix:v}=t,x=this._helper.getMercatorTileCoordinates(l),A=l?this.calculatePosMatrix(l,p,!0):null;let R;return R=l&&l.terrainRttPosMatrix32f&&v?l.terrainRttPosMatrix32f:A||c.b8(),{mainMatrix:R,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:R}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,l,p){return 1}transformLightDirection(t){return c.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,l,p,v){const x=this.calculatePosMatrix(p);let A;v?(A=[t,l,v(t,l),1],c.aw(A,A,x)):(A=[t,l,0,1],$i(A,A,x));const R=A[3];return{point:new c.P(A[0]/R,A[1]/R),signedDistanceFromCamera:R,isOccluded:!1}}populateCache(t){for(const l of t)this.calculatePosMatrix(l)}getMatrixForModel(t,l){const p=c.a1.fromLngLat(t,l),v=p.meterInMercatorCoordinateUnits(),x=c.b9();return c.M(x,x,[p.x,p.y,p.z]),c.b6(x,x,Math.PI),c.b7(x,x,Math.PI/2),c.N(x,x,[-v,v,v]),x}getProjectionDataForCustomLayer(t=!0){const l=new c.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:l,applyGlobeMatrix:t}),v=je(l,this.worldSize);c.O(v,this._viewProjMatrix,v),p.tileMercatorCoords=[0,0,1,1];const x=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],A=c.ba();return c.N(A,v,x),p.fallbackMatrix=A,p.mainMatrix=A,p}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Qi(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function _a(b){if(b.useSlerp)if(b.k<1){const t=c.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),l=c.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),p=new Float64Array(4);c.bc(p,t,l,b.k);const v=c.bd(p);b.tr.setRoll(v.roll),b.tr.setPitch(v.pitch),b.tr.setBearing(v.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function Gr(b,t,l,p,v){const x=v.padding,A=we(v.worldSize,l.getNorthWest()),R=we(v.worldSize,l.getNorthEast()),O=we(v.worldSize,l.getSouthEast()),j=we(v.worldSize,l.getSouthWest()),U=c.ae(-p),$=A.rotate(U),G=R.rotate(U),q=O.rotate(U),re=j.rotate(U),he=new c.P(Math.max($.x,G.x,re.x,q.x),Math.max($.y,G.y,re.y,q.y)),de=new c.P(Math.min($.x,G.x,re.x,q.x),Math.min($.y,G.y,re.y,q.y)),fe=he.sub(de),me=(v.width-(x.left+x.right+t.left+t.right))/fe.x,ye=(v.height-(x.top+x.bottom+t.top+t.bottom))/fe.y;if(ye<0||me<0)return void Qi();const ge=Math.min(c.ak(v.scale*Math.min(me,ye)),b.maxZoom),Se=c.P.convert(b.offset),Re=new c.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(c.ae(p)),_e=Se.add(Re).mult(v.scale/c.af(ge));return{center:Oe(v.worldSize,A.add(O).div(2).sub(_e)),zoom:ge,bearing:p}}class go{get useGlobeControls(){return!1}handlePanInertia(t,l){const p=t.mag(),v=Math.abs(Ge(l));return{easingOffset:t.mult(Math.min(.75*v/p,1)),easingCenter:l.center}}handleMapControlsRollPitchBearingZoom(t,l){t.bearingDelta&&l.setBearing(l.bearing+t.bearingDelta),t.pitchDelta&&l.setPitch(l.pitch+t.pitchDelta),t.rollDelta&&l.setRoll(l.roll+t.rollDelta),t.zoomDelta&&l.setZoom(l.zoom+t.zoomDelta)}handleMapControlsPan(t,l,p){t.around.distSqr(l.centerPoint)<.01||l.setLocationAtPoint(p,t.around)}cameraForBoxAndBearing(t,l,p,v,x){return Gr(t,l,p,v,x)}handleJumpToCenterZoom(t,l){t.zoom!==(l.zoom!==void 0?+l.zoom:t.zoom)&&t.setZoom(+l.zoom),l.center!==void 0&&t.setCenter(c.S.convert(l.center))}handleEaseTo(t,l){const p=t.zoom,v=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},A={roll:l.roll===void 0?t.roll:l.roll,pitch:l.pitch===void 0?t.pitch:l.pitch,bearing:l.bearing===void 0?t.bearing:l.bearing},R=l.zoom!==void 0,O=!t.isPaddingEqual(l.padding);let j=!1;const U=R?+l.zoom:t.zoom;let $=t.centerPoint.add(l.offsetAsPoint);const G=t.screenPointToLocation($),{center:q,zoom:re}=t.getConstrained(c.S.convert(l.center||G),U??p);zl(t,q);const he=we(t.worldSize,G),de=we(t.worldSize,q).sub(he),fe=c.af(re-p);return j=re!==p,{easeFunc:me=>{if(j&&t.setZoom(c.C.number(p,re,me)),c.be(x,A)||_a({startEulerAngles:x,endEulerAngles:A,tr:t,k:me,useSlerp:x.roll!=A.roll}),O&&(t.interpolatePadding(v,l.padding,me),$=t.centerPoint.add(l.offsetAsPoint)),l.around)t.setLocationAtPoint(l.around,l.aroundPoint);else{const ye=c.af(t.zoom-p),ge=re>p?Math.min(2,fe):Math.max(.5,fe),Se=Math.pow(ge,1-me),Re=Oe(t.worldSize,he.add(de.mult(me*Se)).mult(ye));t.setLocationAtPoint(t.renderWorldCopies?Re.wrap():Re,$)}},isZooming:j,elevationCenter:q}}handleFlyTo(t,l){const p=l.zoom!==void 0,v=t.zoom,x=t.getConstrained(c.S.convert(l.center||l.locationAtOffset),p?+l.zoom:v),A=x.center,R=x.zoom;zl(t,A);const O=we(t.worldSize,l.locationAtOffset),j=we(t.worldSize,A).sub(O),U=j.mag(),$=c.af(R-v);let G;if(l.minZoom!==void 0){const q=Math.min(+l.minZoom,v,R),re=t.getConstrained(A,q).zoom;G=c.af(re-v)}return{easeFunc:(q,re,he,de)=>{t.setZoom(q===1?R:v+c.ak(re));const fe=q===1?A:Oe(t.worldSize,O.add(j.mult(he)).mult(re));t.setLocationAtPoint(t.renderWorldCopies?fe.wrap():fe,de)},scaleOfZoom:$,targetCenter:A,scaleOfMinZoom:G,pixelPathLength:U}}}class ai{constructor(t,l,p){this.blendFunction=t,this.blendColor=l,this.mask=p}}ai.Replace=[1,0],ai.disabled=new ai(ai.Replace,c.bf.transparent,[!1,!1,!1,!1]),ai.unblended=new ai(ai.Replace,c.bf.transparent,[!0,!0,!0,!0]),ai.alphaBlended=new ai([1,771],c.bf.transparent,[!0,!0,!0,!0]);const Pi=2305;class Dn{constructor(t,l,p){this.enable=t,this.mode=l,this.frontFace=p}}Dn.disabled=new Dn(!1,1029,Pi),Dn.backCCW=new Dn(!0,1029,Pi),Dn.frontCCW=new Dn(!0,1028,Pi);class tn{constructor(t,l,p){this.func=t,this.mask=l,this.range=p}}tn.ReadOnly=!1,tn.ReadWrite=!0,tn.disabled=new tn(519,tn.ReadOnly,[0,1]);const Qs=7680;class vn{constructor(t,l,p,v,x,A){this.test=t,this.ref=l,this.mask=p,this.fail=v,this.depthFail=x,this.pass=A}}vn.disabled=new vn({func:519,mask:0},0,0,Qs,Qs,Qs);const ea=new WeakMap;function tr(b){var t;if(ea.has(b))return ea.get(b);{const l=(t=b.getParameter(b.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ea.set(b,l),l}}class yu{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const l=t.context,p=l.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const v=new c.aL;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const x=new c.aN;x.emplaceBack(0,1,2),this._fullscreenTriangle=new Ll(l.createVertexBuffer(v,ya.members),l.createIndexBuffer(x),c.aM.simpleSegment(0,0,v.length,x.length)),this._resultBuffer=new Uint8Array(4),l.activeTexture.set(p.TEXTURE1);const A=p.createTexture();p.bindTexture(p.TEXTURE_2D,A),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=l.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(A),tr(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,l){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,l),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,l=t.gl;t.activeTexture.set(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,l){const p=this._cachedRenderContext.context,v=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,v.TRIANGLES,tn.disabled,vn.disabled,ai.unblended,Dn.disabled,((x,A)=>({u_input:x,u_output_expected:A}))(t,l),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&tr(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const x=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&tr(t)){const l=t.clientWaitSync(this._readbackQueue.sync,0,0);if(l===t.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(l===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=yu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let l=0;return l+=t[0]/256,l+=t[1]/65536,l+=t[2]/16777216,t[3]<127&&(l=-l),l/128}}const Ks=c.$/128;function _h(b,t){const l=b.granularity!==void 0?Math.max(b.granularity,1):1,p=l+(b.generateBorders?2:0),v=l+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),x=p+1,A=v+1,R=b.generateBorders?-1:0,O=b.generateBorders||b.extendToNorthPole?-1:0,j=l+(b.generateBorders?1:0),U=l+(b.generateBorders||b.extendToSouthPole?1:0),$=x*A,G=p*v*6,q=x*A>65536;if(q&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const re=q||t==="32bit",he=new Int16Array(2*$);let de=0;for(let ye=O;ye<=U;ye++)for(let ge=R;ge<=j;ge++){let Se=ge/l*c.$;ge===-1&&(Se=-Ks),ge===l+1&&(Se=c.$+Ks);let Re=ye/l*c.$;ye===-1&&(Re=b.extendToNorthPole?c.bh:-Ks),ye===l+1&&(Re=b.extendToSouthPole?c.bi:c.$+Ks),he[de++]=Se,he[de++]=Re}const fe=re?new Uint32Array(G):new Uint16Array(G);let me=0;for(let ye=0;ye<v;ye++)for(let ge=0;ge<p;ge++){const Se=ge+1+ye*x,Re=ge+(ye+1)*x,_e=ge+1+(ye+1)*x;fe[me++]=ge+ye*x,fe[me++]=Re,fe[me++]=Se,fe[me++]=Se,fe[me++]=Re,fe[me++]=_e}return{vertices:he.buffer.slice(0),indices:fe.buffer.slice(0),uses32bitIndices:re}}const Nl=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class Ac{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return sa.projectionGlobe}get vertexShaderPreludeCode(){return sa.projectionMercator.vertexSource}get subdivisionGranularity(){return Nl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new yu(t));const l=c.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-l*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(l,p),x=F.now();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=x);const A=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(A))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,l,p,v,x){const A=(x==="stencil"?Nl.stencil:Nl.tile).getGranularityForZoomLevel(l.z);return this._getMesh(t,{granularity:A,generateBorders:p,extendToNorthPole:l.y===0&&v,extendToSouthPole:l.y===(1<<l.z)-1&&v})}_getMesh(t,l){const p=this._getMeshKey(l);if(p in this._tileMeshCache)return this._tileMeshCache[p];const v=function(x,A){const R=_h(A,"16bit"),O=c.aL.deserialize({arrayBuffer:R.vertices,length:R.vertices.byteLength/2/2}),j=c.aN.deserialize({arrayBuffer:R.indices,length:R.indices.byteLength/2/3});return new Ll(x.createVertexBuffer(O,ya.members),x.createIndexBuffer(j),c.aM.simpleSegment(0,0,O.length,j.length))}(t,l);return this._tileMeshCache[p]=v,v}recalculate(t){}hasTransition(){const t=F.now();let l=!1;return l=l||(t-this._errorMeasurementLastChangeTime)/1e3<.7,l=l||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,l}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Mc=new c.r({type:new c.D(c.v.projection.type)});class Cc extends c.E{constructor(t){super(),this._transitionable=new c.t(Mc,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new Ga,this._verticalPerspectiveProjection=new Ac}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof c.bm){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,l,p,v,x){return this.currentProjection.getMeshFromTileID(t,l,p,v,x)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function _u(b){const t=Dc(b.worldSize,b.center.lat);return 2*Math.PI*t}function Ss(b,t,l,p,v){const x=1/(1<<v),A=t/c.$*x+p*x,R=c.bo((b/c.$*x+l*x)*Math.PI*2+Math.PI,2*Math.PI),O=2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI,j=Math.cos(O),U=new Float64Array(3);return U[0]=Math.sin(R)*j,U[1]=Math.sin(O),U[2]=Math.cos(R)*j,U}function $r(b){return function(t,l){const p=Math.cos(l),v=new Float64Array(3);return v[0]=Math.sin(t)*p,v[1]=Math.sin(l),v[2]=Math.cos(t)*p,v}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function Dc(b,t){return b/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Ic(b){const t=Math.asin(b[1])/Math.PI*180,l=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(l>1e-6){const p=b[0]/l,v=Math.acos(b[2]/l),x=(p>0?v:-v)/Math.PI*180;return new c.S(c.aO(x,-180,180),t)}return new c.S(0,t)}function jl(b){return Math.cos(b*Math.PI/180)}function Zr(b,t){const l=jl(b),p=jl(t);return c.ak(p/l)}function jd(b,t){const l=b.rotate(t.bearingInRadians),p=t.zoom+Zr(t.center.lat,0),v=c.bk(1/jl(t.center.lat),1/jl(Math.min(Math.abs(t.center.lat),60)),c.bn(p,7,3,0,1)),x=360/_u({worldSize:t.worldSize,center:{lat:t.center.lat}});return new c.S(t.center.lng-l.x*x*v,c.ah(t.center.lat+l.y*x,-c.ai,c.ai))}function Fd(b){const t=.5*b,l=Math.sin(t),p=Math.cos(t);return Math.log(l+p)-Math.log(p-l)}function wm(b,t,l,p){const v=b.lat+l*p;if(Math.abs(l)>1){const x=(Math.sign(b.lat+l)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,A=Math.abs(b.lat+l)*Math.PI/180,R=Fd(x+p*(A-x)),O=Fd(x),j=Fd(A);return new c.S(b.lng+t*((R-O)/(j-O)),v)}return new c.S(b.lng+t*p,v)}class Tm{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,l,p,v){const x=`${t.z}_${t.x}_${t.y}_${v?.terrain?"t":""}`,A=this._cache.get(x);if(A)return A;const R=this._cachePrevious.get(x);if(R)return this._cache.set(x,R),R;const O=this._boundingVolumeFactory(t,l,p,v);return this._cache.set(x,O),this._hadAnyChanges=!0,O}}class Rr{constructor(t,l,p,v){this.min=p,this.max=v,this.points=t,this.planes=l}static fromAabb(t,l){const p=[];for(let v=0;v<8;v++)p.push([1&~v?t[0]:l[0],(v>>1&1)==1?l[1]:t[1],(v>>2&1)==1?l[2]:t[2]]);return new Rr(p,[[-1,0,0,l[0]],[1,0,0,-t[0]],[0,-1,0,l[1]],[0,1,0,-t[1]],[0,0,-1,l[2]],[0,0,1,-t[2]]],t,l)}static fromCenterSizeAngles(t,l,p){const v=c.br([],p[0],p[1],p[2]),x=c.bs([],[l[0],0,0],v),A=c.bs([],[0,l[1],0],v),R=c.bs([],[0,0,l[2]],v),O=[...t],j=[...t];for(let $=0;$<8;$++)for(let G=0;G<3;G++){const q=t[G]+x[G]*(1&~$?-1:1)+A[G]*(($>>1&1)==1?1:-1)+R[G]*(($>>2&1)==1?1:-1);O[G]=Math.min(O[G],q),j[G]=Math.max(j[G],q)}const U=[];for(let $=0;$<8;$++){const G=[...t];c.aS(G,G,c.aR([],x,1&~$?-1:1)),c.aS(G,G,c.aR([],A,($>>1&1)==1?1:-1)),c.aS(G,G,c.aR([],R,($>>2&1)==1?1:-1)),U.push(G)}return new Rr(U,[[...x,-c.aX(x,U[0])],[...A,-c.aX(A,U[0])],[...R,-c.aX(R,U[0])],[-x[0],-x[1],-x[2],-c.aX(x,U[7])],[-A[0],-A[1],-A[2],-c.aX(A,U[7])],[-R[0],-R[1],-R[2],-c.aX(R,U[7])]],O,j)}intersectsFrustum(t){let l=!0;const p=this.points.length,v=this.planes.length,x=t.planes.length,A=t.points.length;for(let R=0;R<x;R++){const O=t.planes[R];let j=0;for(let U=0;U<p;U++){const $=this.points[U];O[0]*$[0]+O[1]*$[1]+O[2]*$[2]+O[3]>=0&&j++}if(j===0)return 0;j<p&&(l=!1)}if(l)return 2;for(let R=0;R<v;R++){const O=this.planes[R];let j=0;for(let U=0;U<A;U++){const $=t.points[U];O[0]*$[0]+O[1]*$[1]+O[2]*$[2]+O[3]>=0&&j++}if(j===0)return 0}return 1}intersectsPlane(t){const l=this.points.length;let p=0;for(let v=0;v<l;v++){const x=this.points[v];t[0]*x[0]+t[1]*x[1]+t[2]*x[2]+t[3]>=0&&p++}return p===l?2:p===0?0:1}}function vu(b,t,l){const p=b-t;return p<0?-p:Math.max(0,p-l)}function yo(b,t,l,p,v){const x=b-l;let A;return A=x<0?Math.min(-x,1+x-v):x>1?Math.min(Math.max(x-v,0),1-x):0,Math.max(A,vu(t,p,v))}class Bd{constructor(){this._boundingVolumeCache=new Tm(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,l,p,v){const x=1<<p.z,A=1/x,R=p.x/x,O=p.y/x;let j=2;return j=Math.min(j,yo(t,l,R,O,A)),j=Math.min(j,yo(t,l,R+.5,-O-A,A)),j=Math.min(j,yo(t,l,R+.5,2-O-A,A)),j}getWrap(t,l,p){const v=1<<l.z,x=1/v,A=l.x/v,R=vu(t.x,A,x),O=vu(t.x,A-1,x),j=vu(t.x,A+1,x),U=Math.min(R,O,j);return U===j?1:U===O?-1:0}allowVariableZoom(t,l){return Be(t,l)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,l,p,v){return this._boundingVolumeCache.getTileBoundingVolume(t,l,p,v)}_computeTileBoundingVolume(t,l,p,v){var x,A;let R=0,O=0;if(v?.terrain){const j=new c.Z(t.z,l,t.z,t.x,t.y),U=v.terrain.getMinMaxElevation(j);R=(x=U.minElevation)!==null&&x!==void 0?x:Math.min(0,p),O=(A=U.maxElevation)!==null&&A!==void 0?A:Math.max(0,p)}if(R/=c.bu,O/=c.bu,R+=1,O+=1,t.z<=0)return Rr.fromAabb([-O,-O,-O],[O,O,O]);if(t.z===1)return Rr.fromAabb([t.x===0?-O:0,t.y===0?0:-O,-O],[t.x===0?0:O,t.y===0?O:0,O]);{const j=[Ss(0,0,t.x,t.y,t.z),Ss(c.$,0,t.x,t.y,t.z),Ss(c.$,c.$,t.x,t.y,t.z),Ss(0,c.$,t.x,t.y,t.z)],U=[];for(const Ye of j)U.push(c.aR([],Ye,O));if(O!==R)for(const Ye of j)U.push(c.aR([],Ye,R));t.y===0&&U.push([0,1,0]),t.y===(1<<t.z)-1&&U.push([0,-1,0]);const $=[1,1,1],G=[-1,-1,-1];for(const Ye of U)for(let He=0;He<3;He++)$[He]=Math.min($[He],Ye[He]),G[He]=Math.max(G[He],Ye[He]);const q=Ss(c.$/2,c.$/2,t.x,t.y,t.z),re=c.aW([],[0,1,0],q);c.aV(re,re);const he=c.aW([],q,re);c.aV(he,he);const de=c.aW([],j[2],j[1]);c.aV(de,de);const fe=c.aW([],j[0],j[3]);c.aV(fe,fe),U.push(c.aR([],q,O)),t.y>=(1<<t.z)/2&&U.push(c.aR([],Ss(c.$/2,0,t.x,t.y,t.z),O)),t.y<(1<<t.z)/2&&U.push(c.aR([],Ss(c.$/2,c.$,t.x,t.y,t.z),O));const me=vh(q,U),ye=vh(he,U),ge=[-q[0],-q[1],-q[2],me.max],Se=[q[0],q[1],q[2],-me.min],Re=[-he[0],-he[1],-he[2],ye.max],_e=[he[0],he[1],he[2],-ye.min],Le=[...de,0],qe=[...fe,0],$e=[];return t.y===0?$e.push(c.bt(qe,Le,ge),c.bt(qe,Le,Se)):$e.push(c.bt(Re,Le,ge),c.bt(Re,Le,Se),c.bt(Re,qe,ge),c.bt(Re,qe,Se)),t.y===(1<<t.z)-1?$e.push(c.bt(qe,Le,ge),c.bt(qe,Le,Se)):$e.push(c.bt(_e,Le,ge),c.bt(_e,Le,Se),c.bt(_e,qe,ge),c.bt(_e,qe,Se)),new Rr($e,[ge,Se,Re,_e,Le,qe],$,G)}}}function vh(b,t){let l=1/0,p=-1/0;for(const v of t){const x=c.aX(b,v);l=Math.min(l,x),p=Math.max(p,x)}return{min:l,max:p}}class bh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,l,p){return this._helper.interpolatePadding(t,l,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,l){this._helper.resize(t,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,l){this._helper.overrideNearFarZ(t,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new er({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,l)=>this.getConstrained(t,l)}),this._coveringTilesDetailsProvider=new Bd}clone(){const t=new bh;return t.apply(this),t}apply(t,l){this._globeLatitudeErrorCorrectionRadians=l||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=c.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:l,applyGlobeMatrix:p}=t,v=this._helper.getMercatorTileCoordinates(l);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const l=this.pitchInRadians,p=this.cameraToCenterDistance/t,v=Math.sin(l)*p,x=Math.cos(l)*p+1,A=1/Math.sqrt(v*v+x*x)*1;let R=-v,O=x;const j=Math.sqrt(R*R+O*O);R/=j,O/=j;const U=[0,R,O];c.bw(U,U,[0,0,0],-this.bearingInRadians),c.bx(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),c.by(U,U,[0,0,0],this.center.lng*Math.PI/180);const $=1/c.aZ(U);return c.aR(U,U,$),[...U,-A*$]}isLocationOccluded(t){return!this.isSurfacePointVisible($r(t))}transformLightDirection(t){const l=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,v=Math.cos(p),x=[Math.sin(l)*v,Math.sin(p),Math.cos(l)*v],A=[x[2],0,-x[0]],R=[0,0,0];c.aW(R,A,x),c.aV(A,A),c.aV(R,R);const O=[0,0,0];return c.aV(O,[A[0]*t[0]+R[0]*t[1]+x[0]*t[2],A[1]*t[0]+R[1]*t[1]+x[1]*t[2],A[2]*t[0]+R[2]*t[1]+x[2]*t[2]]),O}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,l,p){const v=function(R,O,j){const U=1/(1<<j.z);return new c.a1(R/c.$*U+j.x*U,O/c.$*U+j.y*U)}(t,l,p.canonical),x=(A=v.y,[c.bo(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI]);var A;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(t,l,p,v){const x=p.canonical,A=Ss(t,l,x.x,x.y,x.z),R=1+(v?v(t,l):0)/c.bu,O=[A[0]*R,A[1]*R,A[2]*R,1];c.aw(O,O,this._globeViewProjMatrixNoCorrection);const j=this._cachedClippingPlane,U=j[0]*A[0]+j[1]*A[1]+j[2]*A[2]+j[3]<0;return{point:new c.P(O[0]/O[3],O[1]/O[3]),signedDistanceFromCamera:O[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Dc(this.worldSize,this.center.lat),l=c.ba(),p=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),c.b4(l,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;l[8]=2*-v.x/this._helper._width,l[9]=2*v.y/this._helper._height,this._projectionMatrix=c.b5(l),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,l),c.M(l,l,[0,0,-this.cameraToCenterDistance]),c.b6(l,l,this.rollInRadians),c.b7(l,l,-this.pitchInRadians),c.b6(l,l,this.bearingInRadians),c.M(l,l,[0,0,-t]);const x=c.bp();x[0]=t,x[1]=t,x[2]=t,c.b7(p,l,this.center.lat*Math.PI/180),c.bz(p,p,-this.center.lng*Math.PI/180),c.N(p,p,x),this._globeViewProjMatrixNoCorrection=p,c.b7(l,l,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(l,l,-this.center.lng*Math.PI/180),c.N(l,l,x),this._globeViewProjMatrix32f=new Float32Array(l),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,p);const A=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,c.bw(this._cameraPosition,this._cameraPosition,A,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,A,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,A,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,A,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,A,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const R=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(R,R,[1,1,-1]),this._cachedFrustum=wi.fromInvProjectionMatrix(R,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){c.w("calculateFogMatrix is not supported on globe projection.");const l=c.ba();return c.ag(l),l}getVisibleUnwrappedCoordinates(t){return[new c.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,l){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=$r(t);c.aR(p,p,1+l/c.bu);const v=c.bv();return c.aw(v,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(t){}getBounds(){const t=.5*this.width,l=.5*this.height,p=[new c.P(0,0),new c.P(t,0),new c.P(this.width,0),new c.P(this.width,l),new c.P(this.width,this.height),new c.P(t,this.height),new c.P(0,this.height),new c.P(0,l)],v=[];for(const $ of p)v.push(this.unprojectScreenPoint($));let x=0,A=0,R=0,O=0;const j=this.center;for(const $ of v){const G=c.bA(j.lng,$.lng),q=c.bA(j.lat,$.lat);G<A&&(A=G),G>x&&(x=G),q<O&&(O=q),q>R&&(R=q)}const U=[j.lng+A,j.lat+O,j.lng+x,j.lat+R];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new Wn(U)}getConstrained(t,l){const p=c.ah(t.lat,-c.ai,c.ai),v=c.ah(+l,this.minZoom+Zr(0,p),this.maxZoom);return{center:new c.S(t.lng,p),zoom:v}}calculateCenterFromCameraLngLatAlt(t,l,p,v){return this._helper.calculateCenterFromCameraLngLatAlt(t,l,p,v)}setLocationAtPoint(t,l){const p=$r(this.unprojectScreenPoint(l)),v=$r(t),x=c.bp();c.bB(x);const A=c.bp();c.by(A,p,x,-this.center.lng*Math.PI/180),c.bx(A,A,x,this.center.lat*Math.PI/180);const R=v[0]*v[0]+v[2]*v[2],O=A[0]*A[0];if(R<O)return;const j=Math.sqrt(R-O),U=-j,$=c.bC(v[0],v[2],A[0],j),G=c.bC(v[0],v[2],A[0],U),q=c.bp();c.by(q,v,x,-$);const re=c.bC(q[1],q[2],A[1],A[2]),he=c.bp();c.by(he,v,x,-G);const de=c.bC(he[1],he[2],A[1],A[2]),fe=.5*Math.PI,me=re>=-fe&&re<=fe,ye=de>=-fe&&de<=fe;let ge,Se;if(me&&ye){const qe=this.center.lng*Math.PI/180,$e=this.center.lat*Math.PI/180;c.bD($,qe)+c.bD(re,$e)<c.bD(G,qe)+c.bD(de,$e)?(ge=$,Se=re):(ge=G,Se=de)}else if(me)ge=$,Se=re;else{if(!ye)return;ge=G,Se=de}const Re=ge/Math.PI*180,_e=Se/Math.PI*180,Le=this.center.lat;this.setCenter(new c.S(Re,c.ah(_e,-90,90))),this.setZoom(this.zoom+Zr(Le,this.center.lat))}locationToScreenPoint(t,l){const p=$r(t);if(l){const v=l.getElevationForLngLatZoom(t,this._helper._tileZoom);c.aR(p,p,1+v/c.bu)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(t){const l=c.bv();return c.aw(l,[...t,1],this._globeViewProjMatrixNoCorrection),l[0]/=l[3],l[1]/=l[3],new c.P((.5*l[0]+.5)*this.width,(.5*-l[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,l){if(l){const p=l.pointCoordinate(t);if(p)return p}return c.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,l){var p;return(p=this.screenPointToMercatorCoordinate(t,l))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(t,l){const p=this._cameraPosition,v=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(p,v)}getRayDirectionFromPixel(t){const l=c.bv();l[0]=t.x/this.width*2-1,l[1]=-1*(t.y/this.height*2-1),l[2]=1,l[3]=1,c.aw(l,l,this._globeViewProjMatrixNoCorrectionInverted),l[0]/=l[3],l[1]/=l[3],l[2]/=l[3];const p=c.bp();p[0]=l[0]-this._cameraPosition[0],p[1]=l[1]-this._cameraPosition[1],p[2]=l[2]-this._cameraPosition[2];const v=c.bp();return c.aV(v,p),v}isSurfacePointVisible(t){const l=this._cachedClippingPlane;return l[0]*t[0]+l[1]*t[1]+l[2]*t[2]+l[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const l=c.bv();return c.aw(l,[...t,1],this._globeViewProjMatrixNoCorrection),l[0]/=l[3],l[1]/=l[3],l[2]/=l[3],l[0]>-1&&l[0]<1&&l[1]>-1&&l[1]<1&&l[2]>-1&&l[2]<1}rayPlanetIntersection(t,l){const p=c.aX(t,l),v=c.bp(),x=c.bp();c.aR(x,l,p),c.aU(v,t,x);const A=1-c.aX(v,v);if(A<0)return null;const R=c.aX(t,t)-1,O=-p+(p<0?1:-1)*Math.sqrt(A),j=R/O,U=O;return{tMin:Math.min(j,U),tMax:Math.max(j,U)}}unprojectScreenPoint(t){const l=this._cameraPosition,p=this.getRayDirectionFromPixel(t),v=this.rayPlanetIntersection(l,p);if(v){const U=c.bp();c.aS(U,l,[p[0]*v.tMin,p[1]*v.tMin,p[2]*v.tMin]);const $=c.bp();return c.aV($,U),Ic($)}const x=this._cachedClippingPlane,A=x[0]*p[0]+x[1]*p[1]+x[2]*p[2],R=-c.b1(x,l)/A,O=c.bp();if(R>0)c.aS(O,l,[p[0]*R,p[1]*R,p[2]*R]);else{const U=c.bp();c.aS(U,l,[2*p[0],2*p[1],2*p[2]]);const $=c.b1(this._cachedClippingPlane,U);c.aU(O,U,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const j=function(U){const $=c.bp();return $[0]=U[0]*-U[3],$[1]=U[1]*-U[3],$[2]=U[2]*-U[3],{center:$,radius:Math.sqrt(1-U[3]*U[3])}}(x);return Ic(function(U,$,G){const q=c.bp();c.aU(q,G,U);const re=c.bp();return c.bq(re,U,q,$/c.a$(q)),re}(j.center,j.radius,O))}getMatrixForModel(t,l){const p=c.S.convert(t),v=1/c.bu,x=c.b9();return c.bz(x,x,p.lng/180*Math.PI),c.b7(x,x,-p.lat/180*Math.PI),c.M(x,x,[0,0,1+l/c.bu]),c.b7(x,x,.5*Math.PI),c.N(x,x,[v,v,v]),x}getProjectionDataForCustomLayer(t=!0){const l=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:t});return l.tileMercatorCoords=[0,0,1,1],l}getFastPathSimpleProjectionMatrix(t){}}class Js{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,l,p){return this._helper.interpolatePadding(t,l,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,l,p=!0){this._helper.resize(t,l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,l){this._helper.overrideNearFarZ(t,l)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,l){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=l,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new er({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,l)=>this.getConstrained(t,l)}),this._globeness=1,this._mercatorTransform=new Ts,this._verticalPerspectiveTransform=new bh}clone(){const t=new Js;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const l=this._mercatorTransform.getProjectionData(t),p=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:l.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:l.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,l,p){const v=this._mercatorTransform.getPitchedTextCorrection(t,l,p),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,l,p);return c.bk(v,x,this._globeness)}projectTileCoordinates(t,l,p,v){return this.currentTransform.projectTileCoordinates(t,l,p,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,l){return this.currentTransform.lngLatToCameraDepth(t,l)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,l){return this.currentTransform.getConstrained(t,l)}calculateCenterFromCameraLngLatAlt(t,l,p,v){return this._helper.calculateCenterFromCameraLngLatAlt(t,l,p,v)}setLocationAtPoint(t,l){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,l),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,l),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,l){return this.currentTransform.locationToScreenPoint(t,l)}screenPointToMercatorCoordinate(t,l){return this.currentTransform.screenPointToMercatorCoordinate(t,l)}screenPointToLocation(t,l){return this.currentTransform.screenPointToLocation(t,l)}isPointOnMapSurface(t,l){return this.currentTransform.isPointOnMapSurface(t,l)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,l){return this.currentTransform.getMatrixForModel(t,l)}getProjectionDataForCustomLayer(t=!0){const l=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return l;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return p.fallbackMatrix=l.mainMatrix,p}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class No{get useGlobeControls(){return!0}handlePanInertia(t,l){const p=jd(t,l);return Math.abs(p.lng-l.center.lng)>180&&(p.lng=l.center.lng+179.5*Math.sign(p.lng-l.center.lng)),{easingCenter:p,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,l){const p=t.around,v=l.screenPointToLocation(p);t.bearingDelta&&l.setBearing(l.bearing+t.bearingDelta),t.pitchDelta&&l.setPitch(l.pitch+t.pitchDelta),t.rollDelta&&l.setRoll(l.roll+t.rollDelta);const x=l.zoom;t.zoomDelta&&l.setZoom(l.zoom+t.zoomDelta);const A=l.zoom-x;if(A===0)return;const R=c.bA(l.center.lng,v.lng),O=R/(Math.abs(R/180)+1),j=c.bA(l.center.lat,v.lat),U=l.getRayDirectionFromPixel(p),$=l.cameraPosition,G=-1*c.aX($,U),q=c.bp();c.aS(q,$,[U[0]*G,U[1]*G,U[2]*G]);const re=c.aZ(q)-1,he=Math.exp(.5*-Math.max(re-.3,0)),de=Dc(l.worldSize,l.center.lat)/Math.min(l.width,l.height),fe=c.bn(de,.9,.5,1,.25),me=(1-c.af(-A))*Math.min(he,fe),ye=l.center.lat,ge=l.zoom,Se=new c.S(l.center.lng+O*me,c.ah(l.center.lat+j*me,-c.ai,c.ai));l.setLocationAtPoint(v,p);const Re=l.center,_e=c.bn(Math.abs(R),45,85,0,1),Le=c.bn(de,.75,.35,0,1),qe=Math.pow(Math.max(_e,Le),.25),$e=c.bA(Re.lng,Se.lng),Ye=c.bA(Re.lat,Se.lat);l.setCenter(new c.S(Re.lng+$e*qe,Re.lat+Ye*qe).wrap()),l.setZoom(ge+Zr(ye,l.center.lat))}handleMapControlsPan(t,l,p){if(!t.panDelta)return;const v=l.center.lat,x=l.zoom;l.setCenter(jd(t.panDelta,l).wrap()),l.setZoom(x+Zr(v,l.center.lat))}cameraForBoxAndBearing(t,l,p,v,x){const A=Gr(t,l,p,v,x),R=l.left/x.width*2-1,O=(x.width-l.right)/x.width*2-1,j=l.top/x.height*-2+1,U=(x.height-l.bottom)/x.height*-2+1,$=c.bA(p.getWest(),p.getEast())<0,G=$?p.getEast():p.getWest(),q=$?p.getWest():p.getEast(),re=Math.max(p.getNorth(),p.getSouth()),he=Math.min(p.getNorth(),p.getSouth()),de=G+.5*c.bA(G,q),fe=re+.5*c.bA(re,he),me=x.clone();me.setCenter(A.center),me.setBearing(A.bearing),me.setPitch(0),me.setRoll(0),me.setZoom(A.zoom);const ye=me.modelViewProjectionMatrix,ge=[$r(p.getNorthWest()),$r(p.getNorthEast()),$r(p.getSouthWest()),$r(p.getSouthEast()),$r(new c.S(q,fe)),$r(new c.S(G,fe)),$r(new c.S(de,re)),$r(new c.S(de,he))],Se=$r(A.center);let Re=Number.POSITIVE_INFINITY;for(const _e of ge)R<0&&(Re=No.getLesserNonNegativeNonNull(Re,No.solveVectorScale(_e,Se,ye,"x",R))),O>0&&(Re=No.getLesserNonNegativeNonNull(Re,No.solveVectorScale(_e,Se,ye,"x",O))),j>0&&(Re=No.getLesserNonNegativeNonNull(Re,No.solveVectorScale(_e,Se,ye,"y",j))),U<0&&(Re=No.getLesserNonNegativeNonNull(Re,No.solveVectorScale(_e,Se,ye,"y",U)));if(Number.isFinite(Re)&&Re!==0)return A.zoom=me.zoom+c.ak(Re),A;Qi()}handleJumpToCenterZoom(t,l){const p=t.center.lat,v=t.getConstrained(l.center?c.S.convert(l.center):t.center,t.zoom).center;t.setCenter(v.wrap());const x=l.zoom!==void 0?+l.zoom:t.zoom+Zr(p,v.lat);t.zoom!==x&&t.setZoom(x)}handleEaseTo(t,l){const p=t.zoom,v=t.center,x=t.padding,A={roll:t.roll,pitch:t.pitch,bearing:t.bearing},R={roll:l.roll===void 0?t.roll:l.roll,pitch:l.pitch===void 0?t.pitch:l.pitch,bearing:l.bearing===void 0?t.bearing:l.bearing},O=l.zoom!==void 0,j=!t.isPaddingEqual(l.padding);let U=!1;const $=l.center?c.S.convert(l.center):v,G=t.getConstrained($,p).center;zl(t,G);const q=t.clone();q.setCenter(G),q.setZoom(O?+l.zoom:p+Zr(v.lat,$.lat)),q.setBearing(l.bearing);const re=new c.P(c.ah(t.centerPoint.x+l.offsetAsPoint.x,0,t.width),c.ah(t.centerPoint.y+l.offsetAsPoint.y,0,t.height));q.setLocationAtPoint(G,re);const he=(l.offset&&l.offsetAsPoint.mag())>0?q.center:G,de=O?+l.zoom:p+Zr(v.lat,he.lat),fe=p+Zr(v.lat,0),me=de+Zr(he.lat,0),ye=c.bA(v.lng,he.lng),ge=c.bA(v.lat,he.lat),Se=c.af(me-fe);return U=de!==p,{easeFunc:Re=>{if(c.be(A,R)||_a({startEulerAngles:A,endEulerAngles:R,tr:t,k:Re,useSlerp:A.roll!=R.roll}),j&&t.interpolatePadding(x,l.padding,Re),l.around)c.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(l.around,l.aroundPoint);else{const _e=me>fe?Math.min(2,Se):Math.max(.5,Se),Le=Math.pow(_e,1-Re),qe=wm(v,ye,ge,Re*Le);t.setCenter(qe.wrap())}if(U){const _e=c.C.number(fe,me,Re)+Zr(0,t.center.lat);t.setZoom(_e)}},isZooming:U,elevationCenter:he}}handleFlyTo(t,l){const p=l.zoom!==void 0,v=t.center,x=t.zoom,A=t.padding,R=!t.isPaddingEqual(l.padding),O=t.getConstrained(c.S.convert(l.center||l.locationAtOffset),x).center,j=p?+l.zoom:t.zoom+Zr(t.center.lat,O.lat),U=t.clone();U.setCenter(O),U.setZoom(j),U.setBearing(l.bearing);const $=new c.P(c.ah(t.centerPoint.x+l.offsetAsPoint.x,0,t.width),c.ah(t.centerPoint.y+l.offsetAsPoint.y,0,t.height));U.setLocationAtPoint(O,$);const G=U.center;zl(t,G);const q=function(ge,Se,Re){const _e=$r(Se),Le=$r(Re),qe=c.aX(_e,Le),$e=Math.acos(qe),Ye=_u(ge);return $e/(2*Math.PI)*Ye}(t,v,G),re=x+Zr(v.lat,0),he=j+Zr(G.lat,0),de=c.af(he-re);let fe;if(typeof l.minZoom=="number"){const ge=+l.minZoom+Zr(G.lat,0),Se=Math.min(ge,re,he)+Zr(0,G.lat),Re=t.getConstrained(G,Se).zoom+Zr(G.lat,0);fe=c.af(Re-re)}const me=c.bA(v.lng,G.lng),ye=c.bA(v.lat,G.lat);return{easeFunc:(ge,Se,Re,_e)=>{const Le=wm(v,me,ye,Re);R&&t.interpolatePadding(A,l.padding,ge);const qe=ge===1?G:Le;t.setCenter(qe.wrap());const $e=re+c.ak(Se);t.setZoom(ge===1?j:$e+Zr(0,qe.lat))},scaleOfZoom:de,targetCenter:G,scaleOfMinZoom:fe,pixelPathLength:q}}static solveVectorScale(t,l,p,v,x){const A=v==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],R=[p[3],p[7],p[11],p[15]],O=t[0]*A[0]+t[1]*A[1]+t[2]*A[2],j=t[0]*R[0]+t[1]*R[1]+t[2]*R[2],U=l[0]*A[0]+l[1]*A[1]+l[2]*A[2],$=l[0]*R[0]+l[1]*R[1]+l[2]*R[2];return U+x*j===O+x*$||R[3]*(O-U)+A[3]*($-j)+O*$==U*j?null:(U+A[3]-x*$-x*R[3])/(U-O-x*$+x*j)}static getLesserNonNegativeNonNull(t,l){return l!==null&&l>=0&&l<t?l:t}}class Wf{constructor(t){this._globe=t,this._mercatorCameraHelper=new go,this._verticalPerspectiveCameraHelper=new No}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,l){return this.currentHelper.handlePanInertia(t,l)}handleMapControlsRollPitchBearingZoom(t,l){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,l)}handleMapControlsPan(t,l,p){this.currentHelper.handleMapControlsPan(t,l,p)}cameraForBoxAndBearing(t,l,p,v,x){return this.currentHelper.cameraForBoxAndBearing(t,l,p,v,x)}handleJumpToCenterZoom(t,l){this.currentHelper.handleJumpToCenterZoom(t,l)}handleEaseTo(t,l){return this.currentHelper.handleEaseTo(t,l)}handleFlyTo(t,l){return this.currentHelper.handleFlyTo(t,l)}}const Ud=(b,t)=>c.y(b,t&&t.filter(l=>l.identifier!=="source.canvas")),hy=c.bE();class Qf extends c.E{constructor(t,l={}){var p,v;super(),this._rtlPluginLoaded=()=>{for(const A in this.sourceCaches){const R=this.sourceCaches[A].getSource().type;R!=="vector"&&R!=="geojson"||this.sourceCaches[A].reload()}},this.map=t,this.dispatcher=new jt(Ot(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(A,R)=>this.getGlyphs(A,R)),this.dispatcher.registerMessageHandler("GI",(A,R)=>this.getImages(A,R)),this.dispatcher.registerMessageHandler("GDA",(A,R)=>this.getDashes(A,R)),this.imageManager=new Ee,this.imageManager.setEventedParent(this);const x=((p=t._container)===null||p===void 0?void 0:p.lang)||typeof document<"u"&&((v=document.documentElement)===null||v===void 0?void 0:v.lang)||void 0;this.glyphManager=new zt(t._requestManager,l.localIdeographFontFamily,x),this.lineAtlas=new ut(256,512),this.crossTileSymbolIndex=new ws,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),Mr().on(Oi,this._rtlPluginLoaded),this.on("data",A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const R=this.sourceCaches[A.sourceId];if(!R)return;const O=R.getSource();if(O&&O.vectorLayerIds)for(const j in this._layers){const U=this._layers[j];U.source===O.id&&this._validateLayer(U)}})}setGlobalStateProperty(t,l){var p,v,x;this._checkLoaded();const A=l===null?(x=(v=(p=this.stylesheet.state)===null||p===void 0?void 0:p[t])===null||v===void 0?void 0:v.default)!==null&&x!==void 0?x:null:l;if(c.bH(A,this._globalState[t]))return this;this._globalState[t]=A,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const l=[];for(const p in t)!c.bH(this._globalState[p],t[p].default)&&(l.push(p),this._globalState[p]=t[p].default);this._applyGlobalStateChanges(l)}_applyGlobalStateChanges(t){if(t.length===0)return;const l=new Set,p={};for(const v of t){p[v]=this._globalState[v];for(const x in this._layers){const A=this._layers[x],R=A.getLayoutAffectingGlobalStateRefs(),O=A.getPaintAffectingGlobalStateRefs();if(R.has(v)&&l.add(A.source),O.has(v))for(const{name:j,value:U}of O.get(v))this._updatePaintProperty(A,j,U)}}this.dispatcher.broadcast("UGS",p);for(const v in this.sourceCaches)l.has(v)&&(this._reloadSource(v),this._changed=!0)}loadURL(t,l={},p){this.fire(new c.l("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const v=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;c.j(v,this._loadStyleRequest).then(A=>{this._loadStyleRequest=null,this._load(A.data,l,p)}).catch(A=>{this._loadStyleRequest=null,A&&!x.signal.aborted&&this.fire(new c.k(A))})}loadJSON(t,l={},p){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,F.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,l.validate=l.validate!==!1,this._load(t,l,p)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(hy,{validate:!1})}_load(t,l,p){var v,x;let A=l.transformStyle?l.transformStyle(p,t):t;if(!l.validate||!Ud(this,c.z(A))){A=Object.assign({},A),this._loaded=!0,this.stylesheet=A;for(const R in A.sources)this.addSource(R,A.sources[R],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs),this._createLayers(),this.light=new Ue(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new xt(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var t,l,p;const v=c.bI(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",v),this._order=v.map(x=>x.id),this._layers={},this._serializedLayers=null;for(const x of v){const A=c.bJ(x,this._globalState);if(A.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=A,c.bK(A)&&this.sourceCaches[A.source]){const R=(p=(l=x.paint)===null||l===void 0?void 0:l["raster-fade-duration"])!==null&&p!==void 0?p:A.paint.get("raster-fade-duration");this.sourceCaches[A.source].setRasterFadeDuration(R)}}}_loadSprite(t,l=!1,p=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,A,R,O){return c._(this,void 0,void 0,function*(){const j=Me(x),U=R>1?"@2x":"",$={},G={};for(const{id:q,url:re}of j){const he=A.transformRequest(Fe(re,U,".json"),"SpriteJSON");$[q]=c.j(he,O);const de=A.transformRequest(Fe(re,U,".png"),"SpriteImage");G[q]=ke.getImage(de,O)}return yield Promise.all([...Object.values($),...Object.values(G)]),function(q,re){return c._(this,void 0,void 0,function*(){const he={};for(const de in q){he[de]={};const fe=F.getImageCanvasContext((yield re[de]).data),me=(yield q[de]).data;for(const ye in me){const{width:ge,height:Se,x:Re,y:_e,sdf:Le,pixelRatio:qe,stretchX:$e,stretchY:Ye,content:He,textFitWidth:bt,textFitHeight:wt}=me[ye];he[de][ye]={data:null,pixelRatio:qe,sdf:Le,stretchX:$e,stretchY:Ye,content:He,textFitWidth:bt,textFitHeight:wt,spriteData:{width:ge,height:Se,x:Re,y:_e,context:fe}}}}return he})}($,G)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const A in x){this._spritesImagesIds[A]=[];const R=this._spritesImagesIds[A]?this._spritesImagesIds[A].filter(O=>!(O in x)):[];for(const O of R)this.imageManager.removeImage(O),this._changedImages[O]=!0;for(const O in x[A]){const j=A==="default"?O:`${A}:${O}`;this._spritesImagesIds[A].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,x[A][O],!1):this.imageManager.addImage(j,x[A][O]),l&&(this._changedImages[j]=!0)}}}).catch(x=>{this._spriteRequest=null,v=x,this.fire(new c.k(v))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),p&&p(v)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(t){const l=this.sourceCaches[t.source];if(!l)return;const p=t.sourceLayer;if(!p)return;const v=l.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(p)===-1)&&this.fire(new c.k(new Error(`Source layer "${p}" does not exist on source "${v.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,l=!1){const p=this._serializedAllLayers();if(!t||t.length===0)return Object.values(l?c.bL(p):p);const v=[];for(const x of t)if(p[x]){const A=l?c.bL(p[x]):p[x];v.push(A)}return v}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const l=Object.keys(this._layers);for(const p of l){const v=this._layers[p];v.type!=="custom"&&(t[p]=v.serialize())}return t}hasTransitions(){var t,l,p;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((l=this.sky)===null||l===void 0)&&l.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const v in this.sourceCaches)if(this.sourceCaches[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const l=this._changed;if(l){const v=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(v.length||x.length)&&this._updateWorkerLayers(v,x);for(const A in this._updatedSources){const R=this._updatedSources[A];if(R==="reload")this._reloadSource(A);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(A)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const p={};for(const v in this.sourceCaches){const x=this.sourceCaches[v];p[v]=x.used,x.used=!1}for(const v of this._order){const x=this._layers[v];x.recalculate(t,this._availableImages),!x.isHidden(t.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const v in p){const x=this.sourceCaches[v];!!p[v]!=!!x.used&&x.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,l&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,l){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,l={}){var p;this._checkLoaded();const v=this.serialize();if(t=l.transformStyle?l.transformStyle(v,t):t,((p=l.validate)===null||p===void 0||p)&&Ud(this,c.z(t)))return!1;(t=c.bL(t)).layers=c.bI(t.layers);const x=c.bM(v,t),A=this._getOperationsToPerform(x);if(A.unimplemented.length>0)throw new Error(`Unimplemented: ${A.unimplemented.join(", ")}.`);if(A.operations.length===0)return!1;for(const R of A.operations)R();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const l=[],p=[];for(const v of t)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":l.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":l.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":l.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":l.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":l.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":l.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":l.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":l.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":l.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":l.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":l.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":l.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":l.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":l.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":l.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":l.push(()=>{});break;default:p.push(v.command)}return{operations:l,unimplemented:p}}addImage(t,l){if(this.getImage(t))return this.fire(new c.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,l),this._afterImageUpdated(t)}updateImage(t,l){this.imageManager.updateImage(t,l)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,l,p={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.z.source,`sources.${t}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const v=this.sourceCaches[t]=new Vt(t,l,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:t})),v.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===t)return this.fire(new c.k(new Error(`Source "${t}" cannot be removed while layer "${p}" is using it.`)));const l=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],l.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,l){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const p=this.sourceCaches[t].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(l),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,l,p={}){this._checkLoaded();const v=t.id;if(this.getLayer(v))return void this.fire(new c.k(new Error(`Layer "${v}" already exists on this map.`)));let x;if(t.type==="custom"){if(Ud(this,c.bN(t)))return;x=c.bJ(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(v,t.source),t=c.bL(t),t=c.e(t,{source:v})),this._validate(c.z.layer,`layers.${v}`,t,{arrayIndex:-1},p))return;x=c.bJ(t,this._globalState),this._validateLayer(x),x.setEventedParent(this,{layer:{id:v}})}const A=l?this._order.indexOf(l):this._order.length;if(l&&A===-1)this.fire(new c.k(new Error(`Cannot add layer "${v}" before non-existing layer "${l}".`)));else{if(this._order.splice(A,0,v),this._layerOrderChanged=!0,this._layers[v]=x,this._removedLayers[v]&&x.source&&x.type!=="custom"){const R=this._removedLayers[v];delete this._removedLayers[v],R.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(t,l){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===l)return;const p=this._order.indexOf(t);this._order.splice(p,1);const v=l?this._order.indexOf(l):this._order.length;l&&v===-1?this.fire(new c.k(new Error(`Cannot move layer "${t}" before non-existing layer "${l}".`))):(this._order.splice(v,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const l=this._layers[t];if(!l)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${t}".`)));l.setEventedParent(null);const p=this._order.indexOf(t);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=l,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],l.onRemove&&l.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,l,p){this._checkLoaded();const v=this.getLayer(t);v?v.minzoom===l&&v.maxzoom===p||(l!=null&&(v.minzoom=l),p!=null&&(v.maxzoom=p),this._updateLayer(v)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,l,p={}){this._checkLoaded();const v=this.getLayer(t);if(v){if(!c.bH(v.filter,l))return l==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(c.z.filter,`layers.${v.id}.filter`,l,null,p)||(v.setFilter(c.bL(l)),this._updateLayer(v)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.bL(this.getLayer(t).filter)}setLayoutProperty(t,l,p,v={}){this._checkLoaded();const x=this.getLayer(t);x?c.bH(x.getLayoutProperty(l),p)||(x.setLayoutProperty(l,p,v),this._updateLayer(x)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,l){const p=this.getLayer(t);if(p)return p.getLayoutProperty(l);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,l,p,v={}){this._checkLoaded();const x=this.getLayer(t);x?c.bH(x.getPaintProperty(l),p)||this._updatePaintProperty(x,l,p,v):this.fire(new c.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,l,p,v={}){t.setPaintProperty(l,p,v)&&this._updateLayer(t),c.bK(t)&&l==="raster-fade-duration"&&this.sourceCaches[t.source].setRasterFadeDuration(p),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,l){return this.getLayer(t).getPaintProperty(l)}setFeatureState(t,l){this._checkLoaded();const p=t.source,v=t.sourceLayer,x=this.sourceCaches[p];if(x===void 0)return void this.fire(new c.k(new Error(`The source '${p}' does not exist in the map's style.`)));const A=x.getSource().type;A==="geojson"&&v?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||v?(t.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),x.setFeatureState(v,t.id,l)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,l){this._checkLoaded();const p=t.source,v=this.sourceCaches[p];if(v===void 0)return void this.fire(new c.k(new Error(`The source '${p}' does not exist in the map's style.`)));const x=v.getSource().type,A=x==="vector"?t.sourceLayer:void 0;x!=="vector"||A?l&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(A,t.id,l):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const l=t.source,p=t.sourceLayer,v=this.sourceCaches[l];if(v!==void 0)return v.getSource().type!=="vector"||p?(t.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(p,t.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.bO(this.sourceCaches,x=>x.serialize()),l=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,v=this.stylesheet;return c.bP({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:t,layers:l,terrain:p},x=>x!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const l=A=>this._layers[A].type==="fill-extrusion",p={},v=[];for(let A=this._order.length-1;A>=0;A--){const R=this._order[A];if(l(R)){p[R]=A;for(const O of t){const j=O[R];if(j)for(const U of j)v.push(U)}}}v.sort((A,R)=>R.intersectionZ-A.intersectionZ);const x=[];for(let A=this._order.length-1;A>=0;A--){const R=this._order[A];if(l(R))for(let O=v.length-1;O>=0;O--){const j=v[O].feature;if(p[j.layer.id]<A)break;x.push(j),v.pop()}else for(const O of t){const j=O[R];if(j)for(const U of j)x.push(U.feature)}}return x}queryRenderedFeatures(t,l,p){l&&l.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",l.filter,null,l);const v={};if(l&&l.layers){if(!(Array.isArray(l.layers)||l.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const j of l.layers){const U=this._layers[j];if(!U)return this.fire(new c.k(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];v[U.source]=!0}}const x=[];l.availableImages=this._availableImages;const A=this._serializedAllLayers(),R=l.layers instanceof Set?l.layers:Array.isArray(l.layers)?new Set(l.layers):null,O=Object.assign(Object.assign({},l),{layers:R,globalState:this._globalState});for(const j in this.sourceCaches)l.layers&&!v[j]||x.push(mn(this.sourceCaches[j],this._layers,A,t,O,p,this.map.terrain?(U,$,G)=>this.map.terrain.getElevation(U,$,G):void 0));return this.placement&&x.push(function(j,U,$,G,q,re,he){const de={},fe=re.queryRenderedSymbols(G),me=[];for(const ye of Object.keys(fe).map(Number))me.push(he[ye]);me.sort(lr);for(const ye of me){const ge=ye.featureIndex.lookupSymbolFeatures(fe[ye.bucketInstanceId],U,ye.bucketIndex,ye.sourceLayerIndex,{filterSpec:q.filter,globalState:q.globalState},q.layers,q.availableImages,j);for(const Se in ge){const Re=de[Se]=de[Se]||[],_e=ge[Se];_e.sort((Le,qe)=>{const $e=ye.featureSortOrder;if($e){const Ye=$e.indexOf(Le.featureIndex);return $e.indexOf(qe.featureIndex)-Ye}return qe.featureIndex-Le.featureIndex});for(const Le of _e)Re.push(Le)}}return function(ye,ge,Se){for(const Re in ye)for(const _e of ye[Re])cr(_e,Se[ge[Re].source]);return ye}(de,j,$)}(this._layers,A,this.sourceCaches,t,O,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(t,l){l?.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",l.filter,null,l);const p=this.sourceCaches[t];return p?function(v,x){const A=v.getRenderableIds().map(j=>v.getTileByID(j)),R=[],O={};for(let j=0;j<A.length;j++){const U=A[j],$=U.tileID.canonical.key;O[$]||(O[$]=!0,U.querySourceFeatures(R,x))}return R}(p,l?Object.assign(Object.assign({},l),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,l={}){this._checkLoaded();const p=this.light.getLight();let v=!1;for(const A in t)if(!c.bH(t[A],p[A])){v=!0;break}if(!v)return;const x={now:F.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,l),this.light.updateTransitions(x)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,l={}){this._checkLoaded();const p=this.getSky();let v=!1;if(!t&&!p)return;if(t&&!p)v=!0;else if(!t&&p)v=!0;else for(const A in t)if(!c.bH(t[A],p[A])){v=!0;break}if(!v)return;const x={now:F.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,l),this.sky.updateTransitions(x)}_setProjectionInternal(t){const l=function(p){if(Array.isArray(p)){const v=new Cc({type:p});return{projection:v,transform:new Js,cameraHelper:new Wf(v)}}switch(p){case"mercator":return{projection:new Ga,transform:new Ts,cameraHelper:new go};case"globe":{const v=new Cc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:v,transform:new Js,cameraHelper:new Wf(v)}}case"vertical-perspective":return{projection:new Ac,transform:new bh,cameraHelper:new No};default:return c.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new Ga,transform:new Ts,cameraHelper:new go}}}(t);this.projection=l.projection,this.map.migrateProjection(l.transform,l.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(t,l,p,v,x={}){return(!x||x.validate!==!1)&&Ud(this,t.call(c.z,c.e({key:l,style:this.serialize(),value:p,styleSpec:c.v},v)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Mr().off(Oi,this._rtlPluginLoaded);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const p=this.sourceCaches[l];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const l in this.sourceCaches)this.sourceCaches[l].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,l,p,v,x=!1){let A=!1,R=!1;const O={};for(const j of this._order){const U=this._layers[j];if(U.type!=="symbol")continue;if(!O[U.source]){const G=this.sourceCaches[U.source];O[U.source]=G.getRenderableIds(!0).map(q=>G.getTileByID(q)).sort((q,re)=>re.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan(re.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(U,O[U.source],t.center.lng);A=A||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(F.now(),t.zoom))&&(this.pauseablePlacement=new qf(t,this.map.terrain,this._order,x,l,p,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(F.now()),R=!0),A&&this.pauseablePlacement.placement.setStale()),R||A)for(const j of this._order){const U=this._layers[j];U.type==="symbol"&&this.placement.updateLayerOpacities(U,O[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(F.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,l){return c._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(l.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[l.source];return v&&v.setDependencies(l.tileID.key,l.type,l.icons),p})}getGlyphs(t,l){return c._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(l.stacks),v=this.sourceCaches[l.source];return v&&v.setDependencies(l.tileID.key,l.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,l={}){this._checkLoaded(),t&&this._validate(c.z.glyphs,"glyphs",t,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,l){return c._(this,void 0,void 0,function*(){const p={};for(const[v,x]of Object.entries(l.dashes))p[v]=this.lineAtlas.getDash(x.dasharray,x.round);return p})}addSprite(t,l,p={},v){this._checkLoaded();const x=[{id:t,url:l}],A=[...Me(this.stylesheet.sprite),...x];this._validate(c.z.sprite,"sprite",A,null,p)||(this.stylesheet.sprite=A,this._loadSprite(x,!0,v))}removeSprite(t){this._checkLoaded();const l=Me(this.stylesheet.sprite);if(l.find(p=>p.id===t)){if(this._spritesImagesIds[t])for(const p of this._spritesImagesIds[t])this.imageManager.removeImage(p),this._changedImages[p]=!0;l.splice(l.findIndex(p=>p.id===t),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Me(this.stylesheet.sprite)}setSprite(t,l={},p){this._checkLoaded(),t&&this._validate(c.z.sprite,"sprite",t,null,l)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,p):(this._unloadSprite(),p&&p(null)))}}var dy=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Vd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,l,p,v,x,A,R,O,j){this.context=t;let U=this.boundPaintVertexBuffers.length!==v.length;for(let $=0;!U&&$<v.length;$++)this.boundPaintVertexBuffers[$]!==v[$]&&(U=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||U||this.boundIndexBuffer!==x||this.boundVertexOffset!==A||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==O||this.boundDynamicVertexBuffer3!==j?this.freshBind(l,p,v,x,A,R,O,j):(t.bindVertexArray.set(this.vao),R&&R.bind(),x&&x.dynamicDraw&&x.bind(),O&&O.bind(),j&&j.bind())}freshBind(t,l,p,v,x,A,R,O){const j=t.numAttributes,U=this.context,$=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=O,l.enableAttributes($,t);for(const G of p)G.enableAttributes($,t);A&&A.enableAttributes($,t),R&&R.enableAttributes($,t),O&&O.enableAttributes($,t),l.bind(),l.setVertexAttribPointers($,t,x);for(const G of p)G.bind(),G.setVertexAttribPointers($,t,x);A&&(A.bind(),A.setVertexAttribPointers($,t,x)),v&&v.bind(),R&&(R.bind(),R.setVertexAttribPointers($,t,x)),O&&(O.bind(),O.setVertexAttribPointers($,t,x)),U.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Kf=(b,t,l,p,v)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:t,u_fog_color:l?l.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:l?l.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:l?l.calculateFogBlendOpacity(p):0,u_horizon_color:l?l.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:l?l.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),Gd={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function bu(b){const t=[];for(let l=0;l<b.length;l++){if(b[l]===null)continue;const p=b[l].split(" ");t.push(p.pop())}return t}class Jf{constructor(t,l,p,v,x,A,R,O,j=[]){const U=t.gl;this.program=U.createProgram();const $=bu(l.staticAttributes),G=p?p.getBinderAttributes():[],q=$.concat(G),re=sa.prelude.staticUniforms?bu(sa.prelude.staticUniforms):[],he=R.staticUniforms?bu(R.staticUniforms):[],de=l.staticUniforms?bu(l.staticUniforms):[],fe=p?p.getBinderUniforms():[],me=re.concat(he).concat(de).concat(fe),ye=[];for(const $e of me)ye.indexOf($e)<0&&ye.push($e);const ge=p?p.defines():[];tr(U)&&ge.unshift("#version 300 es"),x&&ge.push("#define OVERDRAW_INSPECTOR;"),A&&ge.push("#define TERRAIN3D;"),O&&ge.push(O),j&&ge.push(...j);let Se=ge.concat(sa.prelude.fragmentSource,R.fragmentSource,l.fragmentSource).join(`
`),Re=ge.concat(sa.prelude.vertexSource,R.vertexSource,l.vertexSource).join(`
`);tr(U)||(Se=function($e){return $e.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Se),Re=function($e){return $e.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Re));const _e=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);if(U.shaderSource(_e,Se),U.compileShader(_e),!U.getShaderParameter(_e,U.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${U.getShaderInfoLog(_e)}`);U.attachShader(this.program,_e);const Le=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);if(U.shaderSource(Le,Re),U.compileShader(Le),!U.getShaderParameter(Le,U.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${U.getShaderInfoLog(Le)}`);U.attachShader(this.program,Le),this.attributes={};const qe={};this.numAttributes=q.length;for(let $e=0;$e<this.numAttributes;$e++)q[$e]&&(U.bindAttribLocation(this.program,$e,q[$e]),this.attributes[q[$e]]=$e);if(U.linkProgram(this.program),!U.getProgramParameter(this.program,U.LINK_STATUS))throw new Error(`Program failed to link: ${U.getProgramInfoLog(this.program)}`);U.deleteShader(Le),U.deleteShader(_e);for(let $e=0;$e<ye.length;$e++){const Ye=ye[$e];if(Ye&&!qe[Ye]){const He=U.getUniformLocation(this.program,Ye);He&&(qe[Ye]=He)}}this.fixedUniforms=v(t,qe),this.terrainUniforms=(($e,Ye)=>({u_depth:new c.bQ($e,Ye.u_depth),u_terrain:new c.bQ($e,Ye.u_terrain),u_terrain_dim:new c.bg($e,Ye.u_terrain_dim),u_terrain_matrix:new c.bS($e,Ye.u_terrain_matrix),u_terrain_unpack:new c.bT($e,Ye.u_terrain_unpack),u_terrain_exaggeration:new c.bg($e,Ye.u_terrain_exaggeration)}))(t,qe),this.projectionUniforms=(($e,Ye)=>({u_projection_matrix:new c.bS($e,Ye.u_projection_matrix),u_projection_tile_mercator_coords:new c.bT($e,Ye.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bT($e,Ye.u_projection_clipping_plane),u_projection_transition:new c.bg($e,Ye.u_projection_transition),u_projection_fallback_matrix:new c.bS($e,Ye.u_projection_fallback_matrix)}))(t,qe),this.binderUniforms=p?p.getUniforms(t,qe):[]}draw(t,l,p,v,x,A,R,O,j,U,$,G,q,re,he,de,fe,me,ye){const ge=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(p),t.setStencilMode(v),t.setColorMode(x),t.setCullFace(A),O){t.activeTexture.set(ge.TEXTURE2),ge.bindTexture(ge.TEXTURE_2D,O.depthTexture),t.activeTexture.set(ge.TEXTURE3),ge.bindTexture(ge.TEXTURE_2D,O.texture);for(const Re in this.terrainUniforms)this.terrainUniforms[Re].set(O[Re])}if(j)for(const Re in j)this.projectionUniforms[Gd[Re]].set(j[Re]);if(R)for(const Re in this.fixedUniforms)this.fixedUniforms[Re].set(R[Re]);de&&de.setUniforms(t,this.binderUniforms,re,{zoom:he});let Se=0;switch(l){case ge.LINES:Se=2;break;case ge.TRIANGLES:Se=3;break;case ge.LINE_STRIP:Se=1}for(const Re of q.get()){const _e=Re.vaos||(Re.vaos={});(_e[U]||(_e[U]=new Vd)).bind(t,this,$,de?de.getPaintVertexBuffers():[],G,Re.vertexOffset,fe,me,ye),ge.drawElements(l,Re.primitiveLength*Se,ge.UNSIGNED_SHORT,Re.primitiveOffset*Se*2)}}}function $a(b,t,l){const p=1/c.aC(l,1,t.transform.tileZoom),v=Math.pow(2,l.tileID.overscaledZ),x=l.tileSize*Math.pow(2,t.transform.tileZoom)/v,A=x*(l.tileID.canonical.x+l.tileID.wrap*v),R=x*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[p,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[A>>16,R>>16],u_pixel_coord_lower:[65535&A,65535&R]}}const xu=(b,t,l,p)=>{const v=b.style.light,x=v.properties.get("position"),A=[x.x,x.y,x.z],R=c.bW();v.properties.get("anchor")==="viewport"&&c.bX(R,b.transform.bearingInRadians),c.bY(A,A,R);const O=b.transform.transformLightDirection(A),j=v.properties.get("color");return{u_lightpos:A,u_lightpos_globe:O,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+t,u_opacity:l,u_fill_translate:p}},ep=(b,t,l,p,v,x,A)=>c.e(xu(b,t,l,p),$a(x,b,A),{u_height_factor:-Math.pow(2,v.overscaledZ)/A.tileSize/8}),Rc=(b,t,l,p)=>c.e($a(t,b,l),{u_fill_translate:p}),wu=(b,t)=>({u_world:b,u_fill_translate:t}),Sm=(b,t,l,p,v)=>c.e(Rc(b,t,l,v),{u_world:p}),xh=(b,t,l,p,v)=>{const x=b.transform;let A,R,O=0;if(l.paint.get("circle-pitch-alignment")==="map"){const j=c.aC(t,1,x.zoom);A=!0,R=[j,j],O=j/(c.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*v}else A=!1,R=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+A,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:R,u_globe_extrude_scale:O,u_translate:p}},Em=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),jo=b=>({u_viewport_size:[b.width,b.height]}),Am=(b,t=1)=>({u_color:b,u_overlay:0,u_overlay_scale:t}),tp=(b,t,l,p)=>{const v=c.aC(b,1,t)/(c.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:c.aC(b,1,t),u_intensity:l,u_globe_extrude_scale:v}},Mm=(b,t,l,p)=>{const v=c.L();c.bZ(v,0,b.width,b.height,0,0,1);const x=b.context.gl;return{u_matrix:v,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:l,u_color_ramp:p,u_opacity:t.paint.get("heatmap-opacity")}},np=(b,t,l)=>{const p=l.paint.get("hillshade-accent-color");let v;switch(l.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const x=l.getIlluminationProperties();for(let A=0;A<x.directionRadians.length;A++)l.paint.get("hillshade-illumination-anchor")==="viewport"&&(x.directionRadians[A]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:Tu(0,t.tileID),u_exaggeration:l.paint.get("hillshade-exaggeration"),u_altitudes:x.altitudeRadians,u_azimuths:x.directionRadians,u_accent:p,u_method:v,u_highlights:x.highlightColor,u_shadows:x.shadowColor}},$d=(b,t)=>{const l=t.stride,p=c.L();return c.bZ(p,0,c.$,-c.$,0,0,1),c.M(p,p,[0,-c.$,0]),{u_matrix:p,u_image:1,u_dimension:[l,l],u_zoom:b.overscaledZ,u_unpack:t.getUnpackVector()}};function Tu(b,t){const l=Math.pow(2,t.canonical.z),p=t.canonical.y;return[new c.a1(0,p/l).toLngLat().lat,new c.a1(0,(p+1)/l).toLngLat().lat]}const Su=(b,t,l=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:l,u_opacity:b.paint.get("color-relief-opacity")}),wh=(b,t,l,p)=>{const v=b.transform;return{u_translation:rp(b,t,l),u_ratio:p/c.aC(t,1,v.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Th=(b,t,l,p,v)=>c.e(wh(b,t,l,p),{u_image:0,u_image_height:v}),Fl=(b,t,l,p,v)=>{const x=b.transform,A=el(t,x);return{u_translation:rp(b,t,l),u_texsize:t.imageAtlasTexture.size,u_ratio:p/c.aC(t,1,x.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[A,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},ip=(b,t,l,p,v)=>{const x=el(t,b.transform);return c.e(wh(b,t,l,p),{u_tileratio:x,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image:0,u_mix:v.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})},Zd=(b,t,l,p,v,x)=>{const A=el(t,b.transform);return c.e(wh(b,t,l,p),{u_image:0,u_image_height:x,u_tileratio:A,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image_dash:1,u_mix:v.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})};function el(b,t){return 1/c.aC(b,1,t.tileZoom)}function rp(b,t,l){return c.aD(b.transform,t,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const Sh=(b,t,l,p,v)=>{return{u_tl_parent:b,u_scale_parent:t,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(A=p.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(x=p.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Cm(p.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var x,A};function Cm(b){b*=Math.PI/180;const t=Math.sin(b),l=Math.cos(b);return[(2*l+1)/3,(-Math.sqrt(3)*t-l+1)/3,(Math.sqrt(3)*t-l+1)/3]}const Dm=(b,t,l,p,v,x,A,R,O,j,U,$,G)=>{const q=A.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:q.width/q.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_label_plane_matrix:R,u_coord_matrix:O,u_is_text:+U,u_pitch_with_map:+p,u_is_along_line:v,u_is_variable_anchor:x,u_texsize:$,u_texture:0,u_translation:j,u_pitched_scale:G}},ap=(b,t,l,p,v,x,A,R,O,j,U,$,G,q)=>{const re=A.transform;return c.e(Dm(b,t,l,p,v,x,A,R,O,j,U,$,q),{u_gamma_scale:p?Math.cos(re.pitch*Math.PI/180)*re.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:1})},Im=(b,t,l,p,v,x,A,R,O,j,U,$,G)=>c.e(ap(b,t,l,p,v,x,A,R,O,j,!0,U,0,G),{u_texsize_icon:$,u_texture_icon:1}),Rm=(b,t)=>({u_opacity:b,u_color:t}),op=(b,t,l,p,v)=>c.e(function(x,A,R,O){const j=R.imageManager.getPattern(x.from.toString()),U=R.imageManager.getPattern(x.to.toString()),{width:$,height:G}=R.imageManager.getPixelSize(),q=Math.pow(2,O.tileID.overscaledZ),re=O.tileSize*Math.pow(2,R.transform.tileZoom)/q,he=re*(O.tileID.canonical.x+O.tileID.wrap*q),de=re*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[$,G],u_mix:A.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/c.aC(O,1,R.transform.tileZoom),u_pixel_coord_upper:[he>>16,de>>16],u_pixel_coord_lower:[65535&he,65535&de]}}(l,v,t,p),{u_opacity:b}),va=(b,t)=>{},Bl={fillExtrusion:(b,t)=>({u_lightpos:new c.bU(b,t.u_lightpos),u_lightpos_globe:new c.bU(b,t.u_lightpos_globe),u_lightintensity:new c.bg(b,t.u_lightintensity),u_lightcolor:new c.bU(b,t.u_lightcolor),u_vertical_gradient:new c.bg(b,t.u_vertical_gradient),u_opacity:new c.bg(b,t.u_opacity),u_fill_translate:new c.bV(b,t.u_fill_translate)}),fillExtrusionPattern:(b,t)=>({u_lightpos:new c.bU(b,t.u_lightpos),u_lightpos_globe:new c.bU(b,t.u_lightpos_globe),u_lightintensity:new c.bg(b,t.u_lightintensity),u_lightcolor:new c.bU(b,t.u_lightcolor),u_vertical_gradient:new c.bg(b,t.u_vertical_gradient),u_height_factor:new c.bg(b,t.u_height_factor),u_opacity:new c.bg(b,t.u_opacity),u_fill_translate:new c.bV(b,t.u_fill_translate),u_image:new c.bQ(b,t.u_image),u_texsize:new c.bV(b,t.u_texsize),u_pixel_coord_upper:new c.bV(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.bV(b,t.u_pixel_coord_lower),u_scale:new c.bU(b,t.u_scale),u_fade:new c.bg(b,t.u_fade)}),fill:(b,t)=>({u_fill_translate:new c.bV(b,t.u_fill_translate)}),fillPattern:(b,t)=>({u_image:new c.bQ(b,t.u_image),u_texsize:new c.bV(b,t.u_texsize),u_pixel_coord_upper:new c.bV(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.bV(b,t.u_pixel_coord_lower),u_scale:new c.bU(b,t.u_scale),u_fade:new c.bg(b,t.u_fade),u_fill_translate:new c.bV(b,t.u_fill_translate)}),fillOutline:(b,t)=>({u_world:new c.bV(b,t.u_world),u_fill_translate:new c.bV(b,t.u_fill_translate)}),fillOutlinePattern:(b,t)=>({u_world:new c.bV(b,t.u_world),u_image:new c.bQ(b,t.u_image),u_texsize:new c.bV(b,t.u_texsize),u_pixel_coord_upper:new c.bV(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.bV(b,t.u_pixel_coord_lower),u_scale:new c.bU(b,t.u_scale),u_fade:new c.bg(b,t.u_fade),u_fill_translate:new c.bV(b,t.u_fill_translate)}),circle:(b,t)=>({u_camera_to_center_distance:new c.bg(b,t.u_camera_to_center_distance),u_scale_with_map:new c.bQ(b,t.u_scale_with_map),u_pitch_with_map:new c.bQ(b,t.u_pitch_with_map),u_extrude_scale:new c.bV(b,t.u_extrude_scale),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(b,t.u_globe_extrude_scale),u_translate:new c.bV(b,t.u_translate)}),collisionBox:(b,t)=>({u_pixel_extrude_scale:new c.bV(b,t.u_pixel_extrude_scale)}),collisionCircle:(b,t)=>({u_viewport_size:new c.bV(b,t.u_viewport_size)}),debug:(b,t)=>({u_color:new c.bR(b,t.u_color),u_overlay:new c.bQ(b,t.u_overlay),u_overlay_scale:new c.bg(b,t.u_overlay_scale)}),depth:va,clippingMask:va,heatmap:(b,t)=>({u_extrude_scale:new c.bg(b,t.u_extrude_scale),u_intensity:new c.bg(b,t.u_intensity),u_globe_extrude_scale:new c.bg(b,t.u_globe_extrude_scale)}),heatmapTexture:(b,t)=>({u_matrix:new c.bS(b,t.u_matrix),u_world:new c.bV(b,t.u_world),u_image:new c.bQ(b,t.u_image),u_color_ramp:new c.bQ(b,t.u_color_ramp),u_opacity:new c.bg(b,t.u_opacity)}),hillshade:(b,t)=>({u_image:new c.bQ(b,t.u_image),u_latrange:new c.bV(b,t.u_latrange),u_exaggeration:new c.bg(b,t.u_exaggeration),u_altitudes:new c.b$(b,t.u_altitudes),u_azimuths:new c.b$(b,t.u_azimuths),u_accent:new c.bR(b,t.u_accent),u_method:new c.bQ(b,t.u_method),u_shadows:new c.b_(b,t.u_shadows),u_highlights:new c.b_(b,t.u_highlights)}),hillshadePrepare:(b,t)=>({u_matrix:new c.bS(b,t.u_matrix),u_image:new c.bQ(b,t.u_image),u_dimension:new c.bV(b,t.u_dimension),u_zoom:new c.bg(b,t.u_zoom),u_unpack:new c.bT(b,t.u_unpack)}),colorRelief:(b,t)=>({u_image:new c.bQ(b,t.u_image),u_unpack:new c.bT(b,t.u_unpack),u_dimension:new c.bV(b,t.u_dimension),u_elevation_stops:new c.bQ(b,t.u_elevation_stops),u_color_stops:new c.bQ(b,t.u_color_stops),u_color_ramp_size:new c.bQ(b,t.u_color_ramp_size),u_opacity:new c.bg(b,t.u_opacity)}),line:(b,t)=>({u_translation:new c.bV(b,t.u_translation),u_ratio:new c.bg(b,t.u_ratio),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.bV(b,t.u_units_to_pixels)}),lineGradient:(b,t)=>({u_translation:new c.bV(b,t.u_translation),u_ratio:new c.bg(b,t.u_ratio),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.bV(b,t.u_units_to_pixels),u_image:new c.bQ(b,t.u_image),u_image_height:new c.bg(b,t.u_image_height)}),linePattern:(b,t)=>({u_translation:new c.bV(b,t.u_translation),u_texsize:new c.bV(b,t.u_texsize),u_ratio:new c.bg(b,t.u_ratio),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_image:new c.bQ(b,t.u_image),u_units_to_pixels:new c.bV(b,t.u_units_to_pixels),u_scale:new c.bU(b,t.u_scale),u_fade:new c.bg(b,t.u_fade)}),lineSDF:(b,t)=>({u_translation:new c.bV(b,t.u_translation),u_ratio:new c.bg(b,t.u_ratio),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.bV(b,t.u_units_to_pixels),u_image:new c.bQ(b,t.u_image),u_mix:new c.bg(b,t.u_mix),u_tileratio:new c.bg(b,t.u_tileratio),u_crossfade_from:new c.bg(b,t.u_crossfade_from),u_crossfade_to:new c.bg(b,t.u_crossfade_to),u_lineatlas_width:new c.bg(b,t.u_lineatlas_width),u_lineatlas_height:new c.bg(b,t.u_lineatlas_height)}),lineGradientSDF:(b,t)=>({u_translation:new c.bV(b,t.u_translation),u_ratio:new c.bg(b,t.u_ratio),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.bV(b,t.u_units_to_pixels),u_image:new c.bQ(b,t.u_image),u_image_height:new c.bg(b,t.u_image_height),u_tileratio:new c.bg(b,t.u_tileratio),u_crossfade_from:new c.bg(b,t.u_crossfade_from),u_crossfade_to:new c.bg(b,t.u_crossfade_to),u_image_dash:new c.bQ(b,t.u_image_dash),u_mix:new c.bg(b,t.u_mix),u_lineatlas_width:new c.bg(b,t.u_lineatlas_width),u_lineatlas_height:new c.bg(b,t.u_lineatlas_height)}),raster:(b,t)=>({u_tl_parent:new c.bV(b,t.u_tl_parent),u_scale_parent:new c.bg(b,t.u_scale_parent),u_buffer_scale:new c.bg(b,t.u_buffer_scale),u_fade_t:new c.bg(b,t.u_fade_t),u_opacity:new c.bg(b,t.u_opacity),u_image0:new c.bQ(b,t.u_image0),u_image1:new c.bQ(b,t.u_image1),u_brightness_low:new c.bg(b,t.u_brightness_low),u_brightness_high:new c.bg(b,t.u_brightness_high),u_saturation_factor:new c.bg(b,t.u_saturation_factor),u_contrast_factor:new c.bg(b,t.u_contrast_factor),u_spin_weights:new c.bU(b,t.u_spin_weights),u_coords_top:new c.bT(b,t.u_coords_top),u_coords_bottom:new c.bT(b,t.u_coords_bottom)}),symbolIcon:(b,t)=>({u_is_size_zoom_constant:new c.bQ(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bQ(b,t.u_is_size_feature_constant),u_size_t:new c.bg(b,t.u_size_t),u_size:new c.bg(b,t.u_size),u_camera_to_center_distance:new c.bg(b,t.u_camera_to_center_distance),u_pitch:new c.bg(b,t.u_pitch),u_rotate_symbol:new c.bQ(b,t.u_rotate_symbol),u_aspect_ratio:new c.bg(b,t.u_aspect_ratio),u_fade_change:new c.bg(b,t.u_fade_change),u_label_plane_matrix:new c.bS(b,t.u_label_plane_matrix),u_coord_matrix:new c.bS(b,t.u_coord_matrix),u_is_text:new c.bQ(b,t.u_is_text),u_pitch_with_map:new c.bQ(b,t.u_pitch_with_map),u_is_along_line:new c.bQ(b,t.u_is_along_line),u_is_variable_anchor:new c.bQ(b,t.u_is_variable_anchor),u_texsize:new c.bV(b,t.u_texsize),u_texture:new c.bQ(b,t.u_texture),u_translation:new c.bV(b,t.u_translation),u_pitched_scale:new c.bg(b,t.u_pitched_scale)}),symbolSDF:(b,t)=>({u_is_size_zoom_constant:new c.bQ(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bQ(b,t.u_is_size_feature_constant),u_size_t:new c.bg(b,t.u_size_t),u_size:new c.bg(b,t.u_size),u_camera_to_center_distance:new c.bg(b,t.u_camera_to_center_distance),u_pitch:new c.bg(b,t.u_pitch),u_rotate_symbol:new c.bQ(b,t.u_rotate_symbol),u_aspect_ratio:new c.bg(b,t.u_aspect_ratio),u_fade_change:new c.bg(b,t.u_fade_change),u_label_plane_matrix:new c.bS(b,t.u_label_plane_matrix),u_coord_matrix:new c.bS(b,t.u_coord_matrix),u_is_text:new c.bQ(b,t.u_is_text),u_pitch_with_map:new c.bQ(b,t.u_pitch_with_map),u_is_along_line:new c.bQ(b,t.u_is_along_line),u_is_variable_anchor:new c.bQ(b,t.u_is_variable_anchor),u_texsize:new c.bV(b,t.u_texsize),u_texture:new c.bQ(b,t.u_texture),u_gamma_scale:new c.bg(b,t.u_gamma_scale),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_is_halo:new c.bQ(b,t.u_is_halo),u_translation:new c.bV(b,t.u_translation),u_pitched_scale:new c.bg(b,t.u_pitched_scale)}),symbolTextAndIcon:(b,t)=>({u_is_size_zoom_constant:new c.bQ(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bQ(b,t.u_is_size_feature_constant),u_size_t:new c.bg(b,t.u_size_t),u_size:new c.bg(b,t.u_size),u_camera_to_center_distance:new c.bg(b,t.u_camera_to_center_distance),u_pitch:new c.bg(b,t.u_pitch),u_rotate_symbol:new c.bQ(b,t.u_rotate_symbol),u_aspect_ratio:new c.bg(b,t.u_aspect_ratio),u_fade_change:new c.bg(b,t.u_fade_change),u_label_plane_matrix:new c.bS(b,t.u_label_plane_matrix),u_coord_matrix:new c.bS(b,t.u_coord_matrix),u_is_text:new c.bQ(b,t.u_is_text),u_pitch_with_map:new c.bQ(b,t.u_pitch_with_map),u_is_along_line:new c.bQ(b,t.u_is_along_line),u_is_variable_anchor:new c.bQ(b,t.u_is_variable_anchor),u_texsize:new c.bV(b,t.u_texsize),u_texsize_icon:new c.bV(b,t.u_texsize_icon),u_texture:new c.bQ(b,t.u_texture),u_texture_icon:new c.bQ(b,t.u_texture_icon),u_gamma_scale:new c.bg(b,t.u_gamma_scale),u_device_pixel_ratio:new c.bg(b,t.u_device_pixel_ratio),u_is_halo:new c.bQ(b,t.u_is_halo),u_translation:new c.bV(b,t.u_translation),u_pitched_scale:new c.bg(b,t.u_pitched_scale)}),background:(b,t)=>({u_opacity:new c.bg(b,t.u_opacity),u_color:new c.bR(b,t.u_color)}),backgroundPattern:(b,t)=>({u_opacity:new c.bg(b,t.u_opacity),u_image:new c.bQ(b,t.u_image),u_pattern_tl_a:new c.bV(b,t.u_pattern_tl_a),u_pattern_br_a:new c.bV(b,t.u_pattern_br_a),u_pattern_tl_b:new c.bV(b,t.u_pattern_tl_b),u_pattern_br_b:new c.bV(b,t.u_pattern_br_b),u_texsize:new c.bV(b,t.u_texsize),u_mix:new c.bg(b,t.u_mix),u_pattern_size_a:new c.bV(b,t.u_pattern_size_a),u_pattern_size_b:new c.bV(b,t.u_pattern_size_b),u_scale_a:new c.bg(b,t.u_scale_a),u_scale_b:new c.bg(b,t.u_scale_b),u_pixel_coord_upper:new c.bV(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.bV(b,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(b,t.u_tile_units_to_pixels)}),terrain:(b,t)=>({u_texture:new c.bQ(b,t.u_texture),u_ele_delta:new c.bg(b,t.u_ele_delta),u_fog_matrix:new c.bS(b,t.u_fog_matrix),u_fog_color:new c.bR(b,t.u_fog_color),u_fog_ground_blend:new c.bg(b,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(b,t.u_fog_ground_blend_opacity),u_horizon_color:new c.bR(b,t.u_horizon_color),u_horizon_fog_blend:new c.bg(b,t.u_horizon_fog_blend),u_is_globe_mode:new c.bg(b,t.u_is_globe_mode)}),terrainDepth:(b,t)=>({u_ele_delta:new c.bg(b,t.u_ele_delta)}),terrainCoords:(b,t)=>({u_texture:new c.bQ(b,t.u_texture),u_terrain_coords_id:new c.bg(b,t.u_terrain_coords_id),u_ele_delta:new c.bg(b,t.u_ele_delta)}),projectionErrorMeasurement:(b,t)=>({u_input:new c.bg(b,t.u_input),u_output_expected:new c.bg(b,t.u_output_expected)}),atmosphere:(b,t)=>({u_sun_pos:new c.bU(b,t.u_sun_pos),u_atmosphere_blend:new c.bg(b,t.u_atmosphere_blend),u_globe_position:new c.bU(b,t.u_globe_position),u_globe_radius:new c.bg(b,t.u_globe_radius),u_inv_proj_matrix:new c.bS(b,t.u_inv_proj_matrix)}),sky:(b,t)=>({u_sky_color:new c.bR(b,t.u_sky_color),u_horizon_color:new c.bR(b,t.u_horizon_color),u_horizon:new c.bV(b,t.u_horizon),u_horizon_normal:new c.bV(b,t.u_horizon_normal),u_sky_horizon_blend:new c.bg(b,t.u_sky_horizon_blend),u_sky_blend:new c.bg(b,t.u_sky_blend)})};class Es{constructor(t,l,p){this.context=t;const v=t.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yd={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Hd{constructor(t,l,p,v){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=v,this.context=t;const x=t.gl;this.buffer=x.createBuffer(),t.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,l){for(let p=0;p<this.attributes.length;p++){const v=l.attributes[this.attributes[p].name];v!==void 0&&t.enableVertexAttribArray(v)}}setVertexAttribPointers(t,l,p){for(let v=0;v<this.attributes.length;v++){const x=this.attributes[v],A=l.attributes[x.name];A!==void 0&&t.vertexAttribPointer(A,x.components,t[Yd[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Zn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qd extends Zn{getDefault(){return c.bf.transparent}set(t){const l=this.current;(t.r!==l.r||t.g!==l.g||t.b!==l.b||t.a!==l.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class sp extends Zn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class _o extends Zn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Eh extends Zn{getDefault(){return[!0,!0,!0,!0]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||t[2]!==l[2]||t[3]!==l[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ah extends Zn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class lp extends Zn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class km extends Zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const l=this.current;(t.func!==l.func||t.ref!==l.ref||t.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class kc extends Zn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||t[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Oc extends Zn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=t,this.dirty=!1}}class cp extends Zn{getDefault(){return[0,1]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class up extends Zn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=t,this.dirty=!1}}class As extends Zn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Mh extends Zn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.BLEND):l.disable(l.BLEND),this.current=t,this.dirty=!1}}class Ch extends Zn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Xd extends Zn{getDefault(){return c.bf.transparent}set(t){const l=this.current;(t.r!==l.r||t.g!==l.g||t.b!==l.b||t.a!==l.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Pc extends Zn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Dh extends Zn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=t,this.dirty=!1}}class Eu extends Zn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Za extends Zn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class hp extends Zn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Wd extends Zn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Ya extends Zn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||t[2]!==l[2]||t[3]!==l[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ms extends Zn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class ba extends Zn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class tl extends Zn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Lc extends Zn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class zc extends Zn{getDefault(){return null}set(t){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ih extends Zn{getDefault(){return null}set(t){var l;if(t===this.current&&!this.dirty)return;const p=this.gl;tr(p)?p.bindVertexArray(t):(l=p.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Ul extends Zn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class vo extends Zn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class dp extends Zn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Vl extends Zn{constructor(t,l){super(t),this.context=t,this.parent=l}getDefault(){return null}}class bn extends Vl{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Qd extends Vl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ha extends Vl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Rh="Framebuffer is not complete";class qa{constructor(t,l,p,v,x){this.context=t,this.width=l,this.height=p;const A=t.gl,R=this.framebuffer=A.createFramebuffer();if(this.colorAttachment=new bn(t,R),v)this.depthAttachment=x?new Ha(t,R):new Qd(t,R);else if(x)throw new Error("Stencil cannot be set without depth");if(A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error(Rh)}destroy(){const t=this.context.gl,l=this.colorAttachment.get();if(l&&t.deleteTexture(l),this.depthAttachment){const p=this.depthAttachment.get();p&&t.deleteRenderbuffer(p)}t.deleteFramebuffer(this.framebuffer)}}class Om{constructor(t){var l,p;if(this.gl=t,this.clearColor=new qd(this),this.clearDepth=new sp(this),this.clearStencil=new _o(this),this.colorMask=new Eh(this),this.depthMask=new Ah(this),this.stencilMask=new lp(this),this.stencilFunc=new km(this),this.stencilOp=new kc(this),this.stencilTest=new Oc(this),this.depthRange=new cp(this),this.depthTest=new up(this),this.depthFunc=new As(this),this.blend=new Mh(this),this.blendFunc=new Ch(this),this.blendColor=new Xd(this),this.blendEquation=new Pc(this),this.cullFace=new Dh(this),this.cullFaceSide=new Eu(this),this.frontFace=new Za(this),this.program=new hp(this),this.activeTexture=new Wd(this),this.viewport=new Ya(this),this.bindFramebuffer=new Ms(this),this.bindRenderbuffer=new ba(this),this.bindTexture=new tl(this),this.bindVertexBuffer=new Lc(this),this.bindElementBuffer=new zc(this),this.bindVertexArray=new Ih(this),this.pixelStoreUnpack=new Ul(this),this.pixelStoreUnpackPremultiplyAlpha=new vo(this),this.pixelStoreUnpackFlipY=new dp(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),tr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const v=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=t.RGBA16F)!==null&&l!==void 0?l:v?.RGBA16F_EXT,this.RGB16F=(p=t.RGB16F)!==null&&p!==void 0?p:v?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const v=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,l){return new Es(this,t,l)}createVertexBuffer(t,l,p){return new Hd(this,t,l,p)}createRenderbuffer(t,l,p){const v=this.gl,x=v.createRenderbuffer();return this.bindRenderbuffer.set(x),v.renderbufferStorage(v.RENDERBUFFER,t,l,p),this.bindRenderbuffer.set(null),x}createFramebuffer(t,l,p,v){return new qa(this,t,l,p,v)}clear({color:t,depth:l,stencil:p}){const v=this.gl;let x=0;t&&(x|=v.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(x|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(x|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),v.clear(x)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.bH(t.blendFunction,ai.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return tr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var l;return tr(this.gl)?this.gl.deleteVertexArray(t):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Nc;function nl(b,t,l,p,v){const x=b.context,A=b.transform,R=x.gl,O=b.useProgram("collisionBox"),j=[];let U=0,$=0;for(let fe=0;fe<p.length;fe++){const me=p[fe],ye=t.getTile(me).getBucket(l);if(!ye)continue;const ge=v?ye.textCollisionBox:ye.iconCollisionBox,Se=ye.collisionCircleArray;Se.length>0&&(j.push({circleArray:Se,circleOffset:$,coord:me}),U+=Se.length/4,$=U),ge&&O.draw(x,R.LINES,tn.disabled,vn.disabled,b.colorModeForRenderPass(),Dn.disabled,Em(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(me),A.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),l.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,b.transform.zoom,null,null,ge.collisionVertexBuffer)}if(!v||!j.length)return;const G=b.useProgram("collisionCircle"),q=new c.c0;q.resize(4*U),q._trim();let re=0;for(const fe of j)for(let me=0;me<fe.circleArray.length/4;me++){const ye=4*me,ge=fe.circleArray[ye+0],Se=fe.circleArray[ye+1],Re=fe.circleArray[ye+2],_e=fe.circleArray[ye+3];q.emplace(re++,ge,Se,Re,_e,0),q.emplace(re++,ge,Se,Re,_e,1),q.emplace(re++,ge,Se,Re,_e,2),q.emplace(re++,ge,Se,Re,_e,3)}(!Nc||Nc.length<2*U)&&(Nc=function(fe){const me=2*fe,ye=new c.c2;ye.resize(me),ye._trim();for(let ge=0;ge<me;ge++){const Se=6*ge;ye.uint16[Se+0]=4*ge+0,ye.uint16[Se+1]=4*ge+1,ye.uint16[Se+2]=4*ge+2,ye.uint16[Se+3]=4*ge+2,ye.uint16[Se+4]=4*ge+3,ye.uint16[Se+5]=4*ge+0}return ye}(U));const he=x.createIndexBuffer(Nc,!0),de=x.createVertexBuffer(q,c.c1.members,!0);for(const fe of j){const me=jo(b.transform);G.draw(x,R.TRIANGLES,tn.disabled,vn.disabled,b.colorModeForRenderPass(),Dn.disabled,me,b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe.coord),null,l.id,de,he,c.aM.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,b.transform.zoom,null,null,null)}de.destroy(),he.destroy()}const fp=c.ag(new Float32Array(16));function Kd(b,t,l,p,v,x){const{horizontalAlign:A,verticalAlign:R}=c.aH(b);return new c.P((-(A-.5)*t/v+p[0])*x,(-(R-.5)*l/v+p[1])*x)}function Au(b,t,l,p,v,x){const A=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let R=p.mult(x);l||(R=R.rotate(-v));const O=A.add(R);return pt(O.x,O.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(l){const R=_s(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(b),O=Math.atan(R.y/R.x)+(R.x<0?Math.PI:0);return b.add(p.rotate(O))}return b.add(p)}function kh(b,t,l,p,v,x,A,R,O,j,U,$){const G=b.text.placedSymbolArray,q=b.text.dynamicLayoutVertexArray,re=b.icon.dynamicLayoutVertexArray,he={};q.clear();for(let de=0;de<G.length;de++){const fe=G.get(de),me=fe.hidden||!fe.crossTileID||b.allowVerticalPlacement&&!fe.placedOrientation?null:p[fe.crossTileID];if(me){const ye=new c.P(fe.anchorX,fe.anchorY),ge={getElevation:$,width:v.width,height:v.height,pitchedLabelPlaneMatrix:x,pitchWithMap:l,transform:v,tileAnchorPoint:ye,translation:j,unwrappedTileID:U},Se=l?un(ye.x,ye.y,ge):_s(ye.x,ye.y,ge),Re=Lo(v.cameraToCenterDistance,Se.signedDistanceFromCamera);let _e=c.ap(b.textSizeData,R,fe)*Re/c.aB;l&&(_e*=b.tilePixelRatio/A);const{width:Le,height:qe,anchor:$e,textOffset:Ye,textBoxScale:He}=me,bt=Kd($e,Le,qe,Ye,He,_e),wt=v.getPitchedTextCorrection(ye.x+j[0],ye.y+j[1],U),ct=Au(Se.point,ge,t,bt,-v.bearingInRadians,wt),Ft=b.allowVerticalPlacement&&fe.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let on=0;on<fe.numGlyphs;on++)c.av(q,ct,Ft);O&&fe.associatedIconIndex>=0&&(he[fe.associatedIconIndex]={shiftedAnchor:ct,angle:Ft})}else Ma(fe.numGlyphs,q)}if(O){re.clear();const de=b.icon.placedSymbolArray;for(let fe=0;fe<de.length;fe++){const me=de.get(fe);if(me.hidden)Ma(me.numGlyphs,re);else{const ye=he[fe];if(ye)for(let ge=0;ge<me.numGlyphs;ge++)c.av(re,ye.shiftedAnchor,ye.angle);else Ma(me.numGlyphs,re)}}b.icon.dynamicLayoutVertexBuffer.updateData(re)}b.text.dynamicLayoutVertexBuffer.updateData(q)}function xa(b,t,l){return l.iconsInText&&t?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function il(b,t,l,p,v,x,A,R,O,j,U,$,G){const q=b.context,re=q.gl,he=b.transform,de=R==="map",fe=O==="map",me=R!=="viewport"&&l.layout.get("symbol-placement")!=="point",ye=de&&!fe&&!me,ge=!l.layout.get("symbol-sort-key").isConstant();let Se=!1;const Re=b.getDepthModeForSublayer(0,tn.ReadOnly),_e=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Le=[],qe=he.getCircleRadiusCorrection();for(const $e of p){const Ye=t.getTile($e),He=Ye.getBucket(l);if(!He)continue;const bt=v?He.text:He.icon;if(!bt||!bt.segments.get().length||!bt.hasVisibleVertices)continue;const wt=bt.programConfigurations.get(l.id),ct=v||He.sdfIcons,Ft=v?He.textSizeData:He.iconSizeData,on=fe||he.pitch!==0,Vn=b.useProgram(xa(ct,v,He),wt),ti=c.an(Ft,he.zoom),ni=b.style.map.terrain&&b.style.map.terrain.getTerrainData($e);let Ai,vi,In,Vi,Xr=[0,0],nr=null;if(v)vi=Ye.glyphAtlasTexture,In=re.LINEAR,Ai=Ye.glyphAtlasTexture.size,He.iconsInText&&(Xr=Ye.imageAtlasTexture.size,nr=Ye.imageAtlasTexture,Vi=on||b.options.rotating||b.options.zooming||Ft.kind==="composite"||Ft.kind==="camera"?re.LINEAR:re.NEAREST);else{const Yi=l.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;vi=Ye.imageAtlasTexture,In=ct||b.options.rotating||b.options.zooming||Yi||on?re.LINEAR:re.NEAREST,Ai=Ye.imageAtlasTexture.size}const ir=c.aC(Ye,1,b.transform.zoom),ua=pi(de,b.transform,ir),fl=c.L();c.aq(fl,ua);const eo=_r(fe,de,b.transform,ir),pl=c.aD(he,Ye,x,A),rc=he.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),Pu=_e&&He.hasTextData(),qc=l.layout.get("icon-text-fit")!=="none"&&Pu&&He.hasIconData();if(me){const Yi=b.style.map.terrain?(Oa,Wr)=>b.style.map.terrain.getElevation($e,Oa,Wr):null,xr=l.layout.get("text-rotation-alignment")==="map";vr(He,b,v,ua,fl,fe,j,xr,$e.toUnwrapped(),he.width,he.height,pl,Yi)}const Ps=v&&_e||qc,to=me||Ps?fp:fe?ua:b.transform.clipSpaceToPixelsMatrix,To=ct&&l.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Yo;Yo=ct?He.iconsInText?Im(Ft.kind,ti,ye,fe,me,Ps,b,to,eo,pl,Ai,Xr,qe):ap(Ft.kind,ti,ye,fe,me,Ps,b,to,eo,pl,v,Ai,0,qe):Dm(Ft.kind,ti,ye,fe,me,Ps,b,to,eo,pl,v,Ai,qe);const ka={program:Vn,buffers:bt,uniformValues:Yo,projectionData:rc,atlasTexture:vi,atlasTextureIcon:nr,atlasInterpolation:In,atlasInterpolationIcon:Vi,isSDF:ct,hasHalo:To};if(ge&&He.canOverlap){Se=!0;const Yi=bt.segments.get();for(const xr of Yi)Le.push({segments:new c.aM([xr]),sortKey:xr.sortKey,state:ka,terrainData:ni})}else Le.push({segments:bt.segments,sortKey:0,state:ka,terrainData:ni})}Se&&Le.sort(($e,Ye)=>$e.sortKey-Ye.sortKey);for(const $e of Le){const Ye=$e.state;if(q.activeTexture.set(re.TEXTURE0),Ye.atlasTexture.bind(Ye.atlasInterpolation,re.CLAMP_TO_EDGE),Ye.atlasTextureIcon&&(q.activeTexture.set(re.TEXTURE1),Ye.atlasTextureIcon&&Ye.atlasTextureIcon.bind(Ye.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Ye.isSDF){const He=Ye.uniformValues;Ye.hasHalo&&(He.u_is_halo=1,Gl(Ye.buffers,$e.segments,l,b,Ye.program,Re,U,$,He,Ye.projectionData,$e.terrainData)),He.u_is_halo=0}Gl(Ye.buffers,$e.segments,l,b,Ye.program,Re,U,$,Ye.uniformValues,Ye.projectionData,$e.terrainData)}}function Gl(b,t,l,p,v,x,A,R,O,j,U){const $=p.context;v.draw($,$.gl.TRIANGLES,x,A,R,Dn.backCCW,O,U,j,l.id,b.layoutVertexBuffer,b.indexBuffer,t,l.paint,p.transform.zoom,b.programConfigurations.get(l.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function jc(b,t,l,p,v){const x=b.context,A=x.gl,R=vn.disabled,O=new ai([A.ONE,A.ONE],c.bf.transparent,[!0,!0,!0,!0]),j=t.getBucket(l);if(!j)return;const U=p.key;let $=l.heatmapFbos.get(U);$||($=la(x,t.tileSize,t.tileSize),l.heatmapFbos.set(U,$)),x.bindFramebuffer.set($.framebuffer),x.viewport.set([0,0,t.tileSize,t.tileSize]),x.clear({color:c.bf.transparent});const G=j.programConfigurations.get(l.id),q=b.useProgram("heatmap",G,!v),re=b.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=b.style.map.terrain.getTerrainData(p);q.draw(x,A.TRIANGLES,tn.disabled,R,O,Dn.disabled,tp(t,b.transform.zoom,l.paint.get("heatmap-intensity"),1),he,re,l.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,l.paint,b.transform.zoom,G)}function $l(b,t,l,p,v){const x=b.context,A=x.gl,R=b.transform;x.setColorMode(b.colorModeForRenderPass());const O=Yr(x,t),j=l.key,U=t.heatmapFbos.get(j);if(!U)return;x.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,U.colorAttachment.get()),x.activeTexture.set(A.TEXTURE1),O.bind(A.LINEAR,A.CLAMP_TO_EDGE);const $=R.getProjectionData({overscaledTileID:l,applyTerrainMatrix:v,applyGlobeMatrix:!p});b.useProgram("heatmapTexture").draw(x,A.TRIANGLES,tn.disabled,vn.disabled,b.colorModeForRenderPass(),Dn.disabled,Mm(b,t,0,1),null,$,t.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,t.paint,R.zoom),U.destroy(),t.heatmapFbos.delete(j)}function la(b,t,l){var p,v;const x=b.gl,A=x.createTexture();x.bindTexture(x.TEXTURE_2D,A),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const R=(p=b.HALF_FLOAT)!==null&&p!==void 0?p:x.UNSIGNED_BYTE,O=(v=b.RGBA16F)!==null&&v!==void 0?v:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,O,t,l,0,x.RGBA,R,null);const j=b.createFramebuffer(t,l,!1,!1);return j.colorAttachment.set(A),j}function Yr(b,t){return t.colorRampTexture||(t.colorRampTexture=new c.T(b,t.colorRamp,b.gl.RGBA)),t.colorRampTexture}function Fo(b,t,l,p,v,x,A,R){let O=256;if(v.stepInterpolant){const j=t.getSource().maxzoom,U=A.canonical.z===j?Math.ceil(1<<b.transform.maxZoom-A.canonical.z):1;O=c.ah(c.c4(x.maxLineLength/c.$*1024*U),256,l.maxTextureSize)}return R.gradient=c.c5({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:R.gradient||void 0,clips:x.lineClipsArray}),R.texture?R.texture.update(R.gradient):R.texture=new c.T(l,R.gradient,p.RGBA),R.version=v.gradientVersion,R.texture}function Cs(b,t,l,p,v){b.activeTexture.set(t.TEXTURE0),l.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),p.updatePaintBuffers(v)}function Da(b,t,l,p,v,x){(v||b.lineAtlas.dirty)&&(t.activeTexture.set(l.TEXTURE0),b.lineAtlas.bind(t)),p.updatePaintBuffers(x)}function rl(b,t,l,p,v,x,A){const R=x.gradients[v.id];let O=R.texture;v.gradientVersion!==R.version&&(O=Fo(b,t,l,p,v,x,A,R)),l.activeTexture.set(p.TEXTURE0),O.bind(v.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE)}function pp(b,t,l,p,v,x,A,R,O){const j=x.gradients[v.id];let U=j.texture;v.gradientVersion!==j.version&&(U=Fo(b,t,l,p,v,x,A,j)),l.activeTexture.set(p.TEXTURE0),U.bind(v.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE),l.activeTexture.set(p.TEXTURE1),b.lineAtlas.bind(l),R.updatePaintBuffers(O)}function Fc(b,t,l,p,v){if(!l||!p||!p.imageAtlas)return;const x=p.imageAtlas.patternPositions;let A=x[l.to.toString()],R=x[l.from.toString()];if(!A&&R&&(A=R),!R&&A&&(R=A),!A||!R){const O=v.getPaintProperty(t);A=x[O],R=x[O]}A&&R&&b.setConstantPatternPositions(A,R)}function Mu(b,t,l,p,v,x,A,R){const O=b.context.gl,j="fill-pattern",U=l.paint.get(j),$=U&&U.constantOr(1),G=l.getCrossfadeParameters();let q,re,he,de,fe;const me=b.transform,ye=l.paint.get("fill-translate"),ge=l.paint.get("fill-translate-anchor");A?(re=$&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=O.LINES):(re=$?"fillPattern":"fill",q=O.TRIANGLES);const Se=U.constantOr(null);for(const Re of p){const _e=t.getTile(Re);if($&&!_e.patternsLoaded())continue;const Le=_e.getBucket(l);if(!Le)continue;const qe=Le.programConfigurations.get(l.id),$e=b.useProgram(re,qe),Ye=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Re);$&&(b.context.activeTexture.set(O.TEXTURE0),_e.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),qe.updatePaintBuffers(G)),Fc(qe,j,Se,_e,l);const He=me.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),bt=c.aD(me,_e,ye,ge);if(A){de=Le.indexBuffer2,fe=Le.segments2;const ct=[O.drawingBufferWidth,O.drawingBufferHeight];he=re==="fillOutlinePattern"&&$?Sm(b,G,_e,ct,bt):wu(ct,bt)}else de=Le.indexBuffer,fe=Le.segments,he=$?Rc(b,G,_e,bt):{u_fill_translate:bt};const wt=b.stencilModeForClipping(Re);$e.draw(b.context,q,v,wt,x,Dn.backCCW,he,Ye,He,l.id,Le.layoutVertexBuffer,de,fe,l.paint,b.transform.zoom,qe)}}function Oh(b,t,l,p,v,x,A,R){const O=b.context,j=O.gl,U="fill-extrusion-pattern",$=l.paint.get(U),G=$.constantOr(1),q=l.getCrossfadeParameters(),re=l.paint.get("fill-extrusion-opacity"),he=$.constantOr(null),de=b.transform;for(const fe of p){const me=t.getTile(fe),ye=me.getBucket(l);if(!ye)continue;const ge=b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe),Se=ye.programConfigurations.get(l.id),Re=b.useProgram(G?"fillExtrusionPattern":"fillExtrusion",Se);G&&(b.context.activeTexture.set(j.TEXTURE0),me.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Se.updatePaintBuffers(q));const _e=de.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!R,applyTerrainMatrix:!0});Fc(Se,U,he,me,l);const Le=c.aD(de,me,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),qe=l.paint.get("fill-extrusion-vertical-gradient"),$e=G?ep(b,qe,re,Le,fe,q,me):xu(b,qe,re,Le);Re.draw(O,O.gl.TRIANGLES,v,x,A,Dn.backCCW,$e,ge,_e,l.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,l.paint,b.transform.zoom,Se,b.style.map.terrain&&ye.centroidVertexBuffer)}}function br(b,t,l,p,v,x,A,R,O){var j;const U=b.style.projection,$=b.context,G=b.transform,q=$.gl,re=[`#define NUM_ILLUMINATION_SOURCES ${l.paint.get("hillshade-highlight-color").values.length}`],he=b.useProgram("hillshade",null,!1,re),de=!b.options.moving;for(const fe of p){const me=t.getTile(fe),ye=me.fbo;if(!ye)continue;const ge=U.getMeshFromTileID($,fe.canonical,R,!0,"raster"),Se=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(fe);$.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,ye.colorAttachment.get());const Re=G.getProjectionData({overscaledTileID:fe,aligned:de,applyGlobeMatrix:!O,applyTerrainMatrix:!0});he.draw($,q.TRIANGLES,x,v[fe.overscaledZ],A,Dn.backCCW,np(b,me,l),Se,Re,l.id,ge.vertexBuffer,ge.indexBuffer,ge.segments)}}function li(b,t,l,p,v,x,A,R,O){var j;const U=b.style.projection,$=b.context,G=b.transform,q=$.gl,re=b.useProgram("colorRelief"),he=!b.options.moving;let de=!0,fe=0;for(const me of p){const ye=t.getTile(me),ge=ye.dem;if(de){const $e=q.getParameter(q.MAX_TEXTURE_SIZE),{elevationTexture:Ye,colorTexture:He}=l.getColorRampTextures($,$e,ge.getUnpackVector());$.activeTexture.set(q.TEXTURE1),Ye.bind(q.NEAREST,q.CLAMP_TO_EDGE),$.activeTexture.set(q.TEXTURE4),He.bind(q.LINEAR,q.CLAMP_TO_EDGE),de=!1,fe=Ye.size[0]}if(!ge||!ge.data)continue;const Se=ge.stride,Re=ge.getPixels();if($.activeTexture.set(q.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),ye.demTexture=ye.demTexture||b.getTileTexture(Se),ye.demTexture){const $e=ye.demTexture;$e.update(Re,{premultiply:!1}),$e.bind(q.LINEAR,q.CLAMP_TO_EDGE)}else ye.demTexture=new c.T($,Re,q.RGBA,{premultiply:!1}),ye.demTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE);const _e=U.getMeshFromTileID($,me.canonical,R,!0,"raster"),Le=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(me),qe=G.getProjectionData({overscaledTileID:me,aligned:he,applyGlobeMatrix:!O,applyTerrainMatrix:!0});re.draw($,q.TRIANGLES,x,v[me.overscaledZ],A,Dn.backCCW,Su(l,ye.dem,fe),Le,qe,l.id,_e.vertexBuffer,_e.indexBuffer,_e.segments)}}const Nn=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function Bo(b,t,l,p,v,x,A,R,O=!1,j=!1){const U=p[p.length-1].overscaledZ,$=b.context,G=$.gl,q=b.useProgram("raster"),re=b.transform,he=b.style.projection,de=b.colorModeForRenderPass(),fe=!b.options.moving,me=l.paint.get("raster-opacity"),ye=l.paint.get("raster-resampling"),ge=l.paint.get("raster-fade-duration"),Se=!!b.style.map.terrain;for(const Re of p){const _e=b.getDepthModeForSublayer(Re.overscaledZ-U,me===1?tn.ReadWrite:tn.ReadOnly,G.LESS),Le=t.getTile(Re),qe=ye==="nearest"?G.NEAREST:G.LINEAR;$.activeTexture.set(G.TEXTURE0),Le.texture.bind(qe,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(G.TEXTURE1);const{parentTile:$e,parentScaleBy:Ye,parentTopLeft:He,fadeValues:bt}=Xa(Le,t,ge,Se);Le.fadeOpacity=bt.tileOpacity,$e?($e.fadeOpacity=bt.parentTileOpacity,$e.texture.bind(qe,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST)):Le.texture.bind(qe,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),Le.texture.useMipmap&&$.extTextureFilterAnisotropic&&b.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const wt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Re),ct=re.getProjectionData({overscaledTileID:Re,aligned:fe,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Ft=Sh(He,Ye,bt.fadeMix,l,R),on=he.getMeshFromTileID($,Re.canonical,x,A,"raster");q.draw($,G.TRIANGLES,_e,v?v[Re.overscaledZ]:vn.disabled,de,O?Dn.frontCCW:Dn.backCCW,Ft,wt,ct,l.id,on.vertexBuffer,on.indexBuffer,on.segments)}}function Xa(b,t,l,p){const v={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(l===0||p)return v;if(b.fadingParentID){const x=t._getLoadedTile(b.fadingParentID);if(!x)return v;const A=Math.pow(2,x.tileID.overscaledZ-b.tileID.overscaledZ),R=[b.tileID.canonical.x*A%1,b.tileID.canonical.y*A%1],O=function(j,U,$){const G=F.now(),q=(G-U.timeAdded)/$,re=j.fadingDirection===Pe.Incoming,he=c.ah((G-j.timeAdded)/$,0,1),de=c.ah(1-q,0,1),fe=re?he:de;return{tileOpacity:fe,parentTileOpacity:re?de:he,fadeMix:{opacity:1,mix:1-fe}}}(b,x,l);return{parentTile:x,parentScaleBy:A,parentTopLeft:R,fadeValues:O}}if(b.selfFading){const x=function(A,R){const O=F.now(),j=c.ah((O-A.timeAdded)/R,0,1);return{tileOpacity:j,fadeMix:{opacity:j,mix:0}}}(b,l);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:x}}return v}const Zi=new c.bf(1,0,0,1),Ia=new c.bf(0,1,0,1),Wa=new c.bf(0,0,1,1),Jd=new c.bf(1,0,1,1),al=new c.bf(0,1,1,1);function ol(b,t,l,p){Ds(b,0,t+l/2,b.transform.width,l,p)}function sl(b,t,l,p){Ds(b,t-l/2,0,l,b.transform.height,p)}function Ds(b,t,l,p,v,x){const A=b.context,R=A.gl;R.enable(R.SCISSOR_TEST),R.scissor(t*b.pixelRatio,l*b.pixelRatio,p*b.pixelRatio,v*b.pixelRatio),A.clear({color:x}),R.disable(R.SCISSOR_TEST)}function Bc(b,t,l){const p=b.context,v=p.gl,x=b.useProgram("debug"),A=tn.disabled,R=vn.disabled,O=b.colorModeForRenderPass(),j="$debug",U=b.style.map.terrain&&b.style.map.terrain.getTerrainData(l);p.activeTexture.set(v.TEXTURE0);const $=t.getTileByID(l.key).latestRawTileData,G=Math.floor(($&&$.byteLength||0)/1024),q=t.getTile(l).tileSize,re=512/Math.min(q,512)*(l.overscaledZ/b.transform.zoom)*.5;let he=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(he+=` => ${l.overscaledZ}`),function(fe,me){fe.initDebugOverlayCanvas();const ye=fe.debugOverlayCanvas,ge=fe.context.gl,Se=fe.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,ye.width,ye.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(me,5,5),Se.strokeText(me,5,5),fe.debugOverlayTexture.update(ye),fe.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(b,`${he} ${G}kB`);const de=b.transform.getProjectionData({overscaledTileID:l,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(p,v.TRIANGLES,A,R,ai.alphaBlended,Dn.disabled,Am(c.bf.transparent,re),null,de,j,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),x.draw(p,v.LINE_STRIP,A,R,O,Dn.disabled,Am(c.bf.red),U,de,j,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Is(b,t,l,p){const{isRenderingGlobe:v}=p,x=b.context,A=x.gl,R=b.transform,O=b.colorModeForRenderPass(),j=b.getDepthModeFor3D(),U=b.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,b.width,b.height]);for(const $ of l){const G=t.getTerrainMesh($.tileID),q=b.renderToTexture.getTexture($),re=t.getTerrainData($.tileID);x.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,q.texture);const he=t.getMeshFrameDelta(R.zoom),de=R.calculateFogMatrix($.tileID.toUnwrapped()),fe=Kf(he,de,b.style.sky,R.pitch,v),me=R.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,A.TRIANGLES,j,vn.disabled,O,Dn.backCCW,fe,re,me,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}}function Uo(b,t){if(!t.mesh){const l=new c.aL;l.emplaceBack(-1,-1),l.emplaceBack(1,-1),l.emplaceBack(1,1),l.emplaceBack(-1,1);const p=new c.aN;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),t.mesh=new Ll(b.createVertexBuffer(l,ya.members),b.createIndexBuffer(p),c.aM.simpleSegment(0,0,l.length,p.length))}return t.mesh}class ll{constructor(t,l){this.context=new Om(t),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Vt.maxUnderzooming+Vt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ws}resize(t,l,p){if(this.width=Math.floor(t*p),this.height=Math.floor(l*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const t=this.context,l=new c.aL;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.tileExtentBuffer=t.createVertexBuffer(l,ya.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const p=new c.aL;p.emplaceBack(0,0),p.emplaceBack(c.$,0),p.emplaceBack(0,c.$),p.emplaceBack(c.$,c.$),this.debugBuffer=t.createVertexBuffer(p,ya.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const v=new c.c7;v.emplaceBack(0,0,0,0),v.emplaceBack(c.$,0,c.$,0),v.emplaceBack(0,c.$,0,c.$),v.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=t.createVertexBuffer(v,dy.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const x=new c.aL;x.emplaceBack(0,0),x.emplaceBack(c.$,0),x.emplaceBack(0,c.$),x.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(x,ya.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const A=new c.aL;A.emplaceBack(0,0),A.emplaceBack(1,0),A.emplaceBack(0,1),A.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(A,ya.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const R=new c.c8;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(R);const O=new c.aN;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(O);const j=this.context.gl;this.stencilClearMode=new vn({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new Ll(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,l=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=c.L();c.bZ(p,0,this.width,this.height,0,0,1),c.N(p,p,[l.drawingBufferWidth,l.drawingBufferHeight,0]);const v={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(t,l.TRIANGLES,tn.disabled,this.stencilClearMode,ai.disabled,Dn.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,l,p){if(this.currentStencilSource===t.source||!t.isTileClipped()||!l||!l.length)return;this.currentStencilSource=t.source,this.nextStencilID+l.length>256&&this.clearStencil();const v=this.context;v.setColorMode(ai.disabled),v.setDepthMode(tn.disabled);const x={};for(const A of l)x[A.key]=this.nextStencilID++;this._renderTileMasks(x,l,p,!0),this._renderTileMasks(x,l,p,!1),this._tileClippingMaskIDs=x}_renderTileMasks(t,l,p,v){const x=this.context,A=x.gl,R=this.style.projection,O=this.transform,j=this.useProgram("clippingMask");for(const U of l){const $=t[U.key],G=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),q=R.getMeshFromTileID(this.context,U.canonical,v,!0,"stencil"),re=O.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!p,applyTerrainMatrix:!0});j.draw(x,A.TRIANGLES,tn.disabled,new vn({func:A.ALWAYS,mask:0},$,255,A.KEEP,A.KEEP,A.REPLACE),ai.disabled,p?Dn.disabled:Dn.backCCW,null,G,re,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}_renderTilesDepthBuffer(){const t=this.context,l=t.gl,p=this.style.projection,v=this.transform,x=this.useProgram("depth"),A=this.getDepthModeFor3D(),R=Cn(v,{tileSize:v.tileSize});for(const O of R){const j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O),U=p.getMeshFromTileID(this.context,O.canonical,!0,!0,"raster"),$=v.getProjectionData({overscaledTileID:O,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(t,l.TRIANGLES,A,vn.disabled,ai.disabled,Dn.backCCW,null,j,$,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,l=this.context.gl;return new vn({func:l.NOTEQUAL,mask:255},t,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(t){const l=this.context.gl;return new vn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,l.KEEP,l.KEEP,l.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const l=this.context.gl,p=t.sort((A,R)=>R.overscaledZ-A.overscaledZ),v=p[p.length-1].overscaledZ,x=p[0].overscaledZ-v+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const A={};for(let R=0;R<x;R++)A[R+v]=new vn({func:l.GEQUAL,mask:255},R+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=x,[A,p]}return[{[v]:vn.disabled},p]}stencilConfigForOverlapTwoPass(t){const l=this.context.gl,p=t.sort((A,R)=>R.overscaledZ-A.overscaledZ),v=p[p.length-1].overscaledZ,x=p[0].overscaledZ-v+1;if(this.clearStencil(),x>1){const A={},R={};for(let O=0;O<x;O++)A[O+v]=new vn({func:l.GREATER,mask:255},x+1+O,255,l.KEEP,l.KEEP,l.REPLACE),R[O+v]=new vn({func:l.GREATER,mask:255},1+O,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID=2*x+1,[A,R,p]}return this.nextStencilID=3,[{[v]:new vn({func:l.GREATER,mask:255},2,255,l.KEEP,l.KEEP,l.REPLACE)},{[v]:new vn({func:l.GREATER,mask:255},1,255,l.KEEP,l.KEEP,l.REPLACE)},p]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new ai([t.CONSTANT_COLOR,t.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ai.unblended:ai.alphaBlended}getDepthModeForSublayer(t,l,p){if(!this.opaquePassEnabledForLayer())return tn.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new tn(p||this.context.gl.LEQUAL,l,[v,v])}getDepthModeFor3D(){return new tn(this.context.gl.LEQUAL,tn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,l){var p,v;this.style=t,this.options=l,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(F.now()),this.imageManager.beginFrame();const x=this.style._order,A=this.style.sourceCaches,R={},O={},j={},U={isRenderingToTexture:!1,isRenderingGlobe:((p=t.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const G in A){const q=A[G];q.used&&q.prepare(this.context),R[G]=q.getVisibleCoordinates(!1),O[G]=R[G].slice().reverse(),j[G]=q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<x.length;G++)if(this.style._layers[x[G]].is3D()){this.opaquePassCutoff=G;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const G of x){const q=this.style._layers[G];if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const re=O[q.source];(q.type==="custom"||re.length)&&this.renderLayer(this,A[q.source],q,re,U)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:G=>this.useProgram(G)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(G,q){const re=G.context,he=re.gl,de=((Re,_e,Le)=>{const qe=Math.cos(_e.rollInRadians),$e=Math.sin(_e.rollInRadians),Ye=Ge(_e),He=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Re.properties.get("sky-color"),u_horizon_color:Re.properties.get("horizon-color"),u_horizon:[(_e.width/2-Ye*$e)*Le,(_e.height/2+Ye*qe)*Le],u_horizon_normal:[-$e,qe],u_sky_horizon_blend:Re.properties.get("sky-horizon-blend")*_e.height/2*Le,u_sky_blend:He}})(q,G.style.map.transform,G.pixelRatio),fe=new tn(he.LEQUAL,tn.ReadWrite,[0,1]),me=vn.disabled,ye=G.colorModeForRenderPass(),ge=G.useProgram("sky"),Se=Uo(re,q);ge.draw(re,he.TRIANGLES,fe,me,ye,Dn.disabled,de,null,void 0,"sky",Se.vertexBuffer,Se.indexBuffer,Se.segments)}(this,this.style.sky),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[x[this.currentLayer]],q=A[G.source],re=R[G.source];this._renderTileClippingMasks(G,re,!1),this.renderLayer(this,q,G,re,U)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const G=this.style._layers[x[this.currentLayer]],q=A[G.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(G,U))continue;this.opaquePassEnabledForLayer()||$||($=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const re=(G.type==="symbol"?j:O)[G.source];this._renderTileClippingMasks(G,R[G.source],!!this.renderToTexture),this.renderLayer(this,q,G,re,U)}if(U.isRenderingGlobe&&function(G,q,re){const he=G.context,de=he.gl,fe=G.useProgram("atmosphere"),me=new tn(de.LEQUAL,tn.ReadOnly,[0,1]),ye=G.transform,ge=function(He,bt){const wt=He.properties.get("position"),ct=[-wt.x,-wt.y,-wt.z],Ft=c.ag(new Float64Array(16));return He.properties.get("anchor")==="map"&&(c.b6(Ft,Ft,bt.rollInRadians),c.b7(Ft,Ft,-bt.pitchInRadians),c.b6(Ft,Ft,bt.bearingInRadians),c.b7(Ft,Ft,bt.center.lat*Math.PI/180),c.bz(Ft,Ft,-bt.center.lng*Math.PI/180)),c.c6(ct,ct,Ft),ct}(re,G.transform),Se=ye.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Re=q.properties.get("atmosphere-blend")*Se.projectionTransition;if(Re===0)return;const _e=Dc(ye.worldSize,ye.center.lat),Le=ye.inverseProjectionMatrix,qe=new Float64Array(4);qe[3]=1,c.aw(qe,qe,ye.modelViewProjectionMatrix),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1,c.aw(qe,qe,Le),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1;const $e=((He,bt,wt,ct,Ft)=>({u_sun_pos:He,u_atmosphere_blend:bt,u_globe_position:wt,u_globe_radius:ct,u_inv_proj_matrix:Ft}))(ge,Re,[qe[0],qe[1],qe[2]],_e,Le),Ye=Uo(he,q);fe.draw(he,de.TRIANGLES,me,vn.disabled,ai.alphaBlended,Dn.disabled,$e,null,null,"atmosphere",Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const G=function(q,re){let he=null;const de=Object.values(q._layers).flatMap(ge=>ge.source&&!ge.isHidden(re)?[q.sourceCaches[ge.source]]:[]),fe=de.filter(ge=>ge.getSource().type==="vector"),me=de.filter(ge=>ge.getSource().type!=="vector"),ye=ge=>{(!he||he.getSource().maxzoom<ge.getSource().maxzoom)&&(he=ge)};return fe.forEach(ge=>ye(ge)),he||me.forEach(ge=>ye(ge)),he}(this.style,this.transform.zoom);G&&function(q,re,he){for(let de=0;de<he.length;de++)Bc(q,re,he[de])}(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const q=G.transform.padding;ol(G,G.transform.height-(q.top||0),3,Zi),ol(G,q.bottom||0,3,Ia),sl(G,q.left||0,3,Wa),sl(G,G.transform.width-(q.right||0),3,Jd);const re=G.transform.centerPoint;(function(he,de,fe,me){Ds(he,de-1,fe-10,2,20,me),Ds(he,de-10,fe-1,20,2,me)})(G,re.x,G.transform.height-re.y,al)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const l=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=t?!c.c9(l,p):!c.ca(l,p)),v||(v=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(c.cb(l,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,A){const R=x.context,O=R.gl,j=x.transform,U=ai.unblended,$=new tn(O.LEQUAL,tn.ReadWrite,[0,1]),G=A.sourceCache.getRenderableTiles(),q=x.useProgram("terrainDepth");R.bindFramebuffer.set(A.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),R.clear({color:c.bf.transparent,depth:1});for(const re of G){const he=A.getTerrainMesh(re.tileID),de=A.getTerrainData(re.tileID),fe=j.getProjectionData({overscaledTileID:re.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),me={u_ele_delta:A.getMeshFrameDelta(j.zoom)};q.draw(R,O.TRIANGLES,$,vn.disabled,U,Dn.backCCW,me,de,fe,"terrain",he.vertexBuffer,he.indexBuffer,he.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,A){const R=x.context,O=R.gl,j=x.transform,U=ai.unblended,$=new tn(O.LEQUAL,tn.ReadWrite,[0,1]),G=A.getCoordsTexture(),q=A.sourceCache.getRenderableTiles(),re=x.useProgram("terrainCoords");R.bindFramebuffer.set(A.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),R.clear({color:c.bf.transparent,depth:1}),A.coordsIndex=[];for(const he of q){const de=A.getTerrainMesh(he.tileID),fe=A.getTerrainData(he.tileID);R.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,G.texture);const me={u_terrain_coords_id:(255-A.coordsIndex.length)/255,u_texture:0,u_ele_delta:A.getMeshFrameDelta(j.zoom)},ye=j.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});re.draw(R,O.TRIANGLES,$,vn.disabled,U,Dn.backCCW,me,fe,ye,"terrain",de.vertexBuffer,de.indexBuffer,de.segments),A.coordsIndex.push(he.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(t,l,p,v,x){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(v||[]).length)&&(this.id=p.id,c.cc(p)?function(A,R,O,j,U,$){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:G}=$,q=vn.disabled,re=A.colorModeForRenderPass();(O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(he,de,fe,me,ye,ge,Se,Re,_e){const Le=de.transform,qe=de.style.map.terrain,$e=ye==="map",Ye=ge==="map";for(const He of he){const bt=me.getTile(He),wt=bt.getBucket(fe);if(!wt||!wt.text||!wt.text.segments.get().length)continue;const ct=c.an(wt.textSizeData,Le.zoom),Ft=c.aC(bt,1,de.transform.zoom),on=pi($e,de.transform,Ft),Vn=fe.layout.get("icon-text-fit")!=="none"&&wt.hasIconData();if(ct){const ti=Math.pow(2,Le.zoom-bt.tileID.overscaledZ),ni=qe?(Ai,vi)=>qe.getElevation(He,Ai,vi):null;kh(wt,$e,Ye,_e,Le,on,ti,ct,Vn,c.aD(Le,bt,Se,Re),He.toUnwrapped(),ni)}}}(j,A,O,R,O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),U),O.paint.get("icon-opacity").constantOr(1)!==0&&il(A,R,O,j,!1,O.paint.get("icon-translate"),O.paint.get("icon-translate-anchor"),O.layout.get("icon-rotation-alignment"),O.layout.get("icon-pitch-alignment"),O.layout.get("icon-keep-upright"),q,re,G),O.paint.get("text-opacity").constantOr(1)!==0&&il(A,R,O,j,!0,O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.layout.get("text-keep-upright"),q,re,G),R.map.showCollisionBoxes&&(nl(A,R,O,j,!0),nl(A,R,O,j,!1))}(t,l,p,v,this.style.placement.variableOffsets,x):c.cd(p)?function(A,R,O,j,U){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:$}=U,G=O.paint.get("circle-opacity"),q=O.paint.get("circle-stroke-width"),re=O.paint.get("circle-stroke-opacity"),he=!O.layout.get("circle-sort-key").isConstant();if(G.constantOr(1)===0&&(q.constantOr(1)===0||re.constantOr(1)===0))return;const de=A.context,fe=de.gl,me=A.transform,ye=A.getDepthModeForSublayer(0,tn.ReadOnly),ge=vn.disabled,Se=A.colorModeForRenderPass(),Re=[],_e=me.getCircleRadiusCorrection();for(let Le=0;Le<j.length;Le++){const qe=j[Le],$e=R.getTile(qe),Ye=$e.getBucket(O);if(!Ye)continue;const He=O.paint.get("circle-translate"),bt=O.paint.get("circle-translate-anchor"),wt=c.aD(me,$e,He,bt),ct=Ye.programConfigurations.get(O.id),Ft=A.useProgram("circle",ct),on=Ye.layoutVertexBuffer,Vn=Ye.indexBuffer,ti=A.style.map.terrain&&A.style.map.terrain.getTerrainData(qe),ni={programConfiguration:ct,program:Ft,layoutVertexBuffer:on,indexBuffer:Vn,uniformValues:xh(A,$e,O,wt,_e),terrainData:ti,projectionData:me.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(he){const Ai=Ye.segments.get();for(const vi of Ai)Re.push({segments:new c.aM([vi]),sortKey:vi.sortKey,state:ni})}else Re.push({segments:Ye.segments,sortKey:0,state:ni})}he&&Re.sort((Le,qe)=>Le.sortKey-qe.sortKey);for(const Le of Re){const{programConfiguration:qe,program:$e,layoutVertexBuffer:Ye,indexBuffer:He,uniformValues:bt,terrainData:wt,projectionData:ct}=Le.state;$e.draw(de,fe.TRIANGLES,ye,ge,Se,Dn.backCCW,bt,wt,ct,O.id,Ye,He,Le.segments,O.paint,A.transform.zoom,qe)}}(t,l,p,v,x):c.ce(p)?function(A,R,O,j,U){if(O.paint.get("heatmap-opacity")===0)return;const $=A.context,{isRenderingToTexture:G,isRenderingGlobe:q}=U;if(A.style.map.terrain){for(const re of j){const he=R.getTile(re);R.hasRenderableParent(re)||(A.renderPass==="offscreen"?jc(A,he,O,re,q):A.renderPass==="translucent"&&$l(A,O,re,G,q))}$.viewport.set([0,0,A.width,A.height])}else A.renderPass==="offscreen"?function(re,he,de,fe){const me=re.context,ye=me.gl,ge=re.transform,Se=vn.disabled,Re=new ai([ye.ONE,ye.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(_e,Le,qe){const $e=_e.gl;_e.activeTexture.set($e.TEXTURE1),_e.viewport.set([0,0,Le.width/4,Le.height/4]);let Ye=qe.heatmapFbos.get(c.c3);Ye?($e.bindTexture($e.TEXTURE_2D,Ye.colorAttachment.get()),_e.bindFramebuffer.set(Ye.framebuffer)):(Ye=la(_e,Le.width/4,Le.height/4),qe.heatmapFbos.set(c.c3,Ye))})(me,re,de),me.clear({color:c.bf.transparent});for(let _e=0;_e<fe.length;_e++){const Le=fe[_e];if(he.hasRenderableParent(Le))continue;const qe=he.getTile(Le),$e=qe.getBucket(de);if(!$e)continue;const Ye=$e.programConfigurations.get(de.id),He=re.useProgram("heatmap",Ye),bt=ge.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),wt=ge.getCircleRadiusCorrection();He.draw(me,ye.TRIANGLES,tn.disabled,Se,Re,Dn.backCCW,tp(qe,ge.zoom,de.paint.get("heatmap-intensity"),wt),null,bt,de.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,de.paint,ge.zoom,Ye)}me.viewport.set([0,0,re.width,re.height])}(A,R,O,j):A.renderPass==="translucent"&&function(re,he){const de=re.context,fe=de.gl;de.setColorMode(re.colorModeForRenderPass());const me=he.heatmapFbos.get(c.c3);me&&(de.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,me.colorAttachment.get()),de.activeTexture.set(fe.TEXTURE1),Yr(de,he).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(de,fe.TRIANGLES,tn.disabled,vn.disabled,re.colorModeForRenderPass(),Dn.disabled,Mm(re,he,0,1),null,null,he.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,he.paint,re.transform.zoom))}(A,O)}(t,l,p,v,x):c.cf(p)?function(A,R,O,j,U){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:$}=U,G=O.paint.get("line-opacity"),q=O.paint.get("line-width");if(G.constantOr(1)===0||q.constantOr(1)===0)return;const re=A.getDepthModeForSublayer(0,tn.ReadOnly),he=A.colorModeForRenderPass(),de=O.paint.get("line-dasharray"),fe=de.constantOr(1),me=O.paint.get("line-pattern"),ye=me.constantOr(1),ge=O.paint.get("line-gradient"),Se=O.getCrossfadeParameters();let Re;Re=ye?"linePattern":fe&&ge?"lineGradientSDF":fe?"lineSDF":ge?"lineGradient":"line";const _e=A.context,Le=_e.gl,qe=A.transform;let $e=!0;for(const Ye of j){const He=R.getTile(Ye);if(ye&&!He.patternsLoaded())continue;const bt=He.getBucket(O);if(!bt)continue;const wt=bt.programConfigurations.get(O.id),ct=A.context.program.get(),Ft=A.useProgram(Re,wt),on=$e||Ft.program!==ct,Vn=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Ye),ti=me.constantOr(null),ni=de&&de.constantOr(null);if(ti&&He.imageAtlas){const Xr=He.imageAtlas,nr=Xr.patternPositions[ti.to.toString()],ir=Xr.patternPositions[ti.from.toString()];nr&&ir&&wt.setConstantPatternPositions(nr,ir)}else if(ni){const Xr=O.layout.get("line-cap")==="round",nr=A.lineAtlas.getDash(ni.to,Xr),ir=A.lineAtlas.getDash(ni.from,Xr);wt.setConstantDashPositions(nr,ir)}const Ai=qe.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),vi=qe.getPixelScale();let In;ye?(In=Fl(A,He,O,vi,Se),Cs(_e,Le,He,wt,Se)):fe&&ge?(In=Zd(A,He,O,vi,Se,bt.lineClipsArray.length),pp(A,R,_e,Le,O,bt,Ye,wt,Se)):fe?(In=ip(A,He,O,vi,Se),Da(A,_e,Le,wt,on,Se)):ge?(In=Th(A,He,O,vi,bt.lineClipsArray.length),rl(A,R,_e,Le,O,bt,Ye)):In=wh(A,He,O,vi);const Vi=A.stencilModeForClipping(Ye);Ft.draw(_e,Le.TRIANGLES,re,Vi,he,Dn.disabled,In,Vn,Ai,O.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,O.paint,A.transform.zoom,wt,bt.layoutVertexBuffer2),$e=!1}}(t,l,p,v,x):c.cg(p)?function(A,R,O,j,U){const $=O.paint.get("fill-color"),G=O.paint.get("fill-opacity");if(G.constantOr(1)===0)return;const{isRenderingToTexture:q}=U,re=A.colorModeForRenderPass(),he=O.paint.get("fill-pattern"),de=A.opaquePassEnabledForLayer()&&!he.constantOr(1)&&$.constantOr(c.bf.transparent).a===1&&G.constantOr(0)===1?"opaque":"translucent";if(A.renderPass===de){const fe=A.getDepthModeForSublayer(1,A.renderPass==="opaque"?tn.ReadWrite:tn.ReadOnly);Mu(A,R,O,j,fe,re,!1,q)}if(A.renderPass==="translucent"&&O.paint.get("fill-antialias")){const fe=A.getDepthModeForSublayer(O.getPaintProperty("fill-outline-color")?2:0,tn.ReadOnly);Mu(A,R,O,j,fe,re,!0,q)}}(t,l,p,v,x):c.ch(p)?function(A,R,O,j,U){const $=O.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:G}=U;if(A.renderPass==="translucent"){const q=new tn(A.context.gl.LEQUAL,tn.ReadWrite,A.depthRangeFor3D);if($!==1||O.paint.get("fill-extrusion-pattern").constantOr(1))Oh(A,R,O,j,q,vn.disabled,ai.disabled,G),Oh(A,R,O,j,q,A.stencilModeFor3D(),A.colorModeForRenderPass(),G);else{const re=A.colorModeForRenderPass();Oh(A,R,O,j,q,vn.disabled,re,G)}}}(t,l,p,v,x):c.ci(p)?function(A,R,O,j,U){if(A.renderPass!=="offscreen"&&A.renderPass!=="translucent")return;const{isRenderingToTexture:$}=U,G=A.context,q=A.style.projection.useSubdivision,re=A.getDepthModeForSublayer(0,tn.ReadOnly),he=A.colorModeForRenderPass();if(A.renderPass==="offscreen")(function(de,fe,me,ye,ge,Se,Re){const _e=de.context,Le=_e.gl;for(const qe of me){const $e=fe.getTile(qe),Ye=$e.dem;if(!Ye||!Ye.data||!$e.needsHillshadePrepare)continue;const He=Ye.dim,bt=Ye.stride,wt=Ye.getPixels();if(_e.activeTexture.set(Le.TEXTURE1),_e.pixelStoreUnpackPremultiplyAlpha.set(!1),$e.demTexture=$e.demTexture||de.getTileTexture(bt),$e.demTexture){const Ft=$e.demTexture;Ft.update(wt,{premultiply:!1}),Ft.bind(Le.NEAREST,Le.CLAMP_TO_EDGE)}else $e.demTexture=new c.T(_e,wt,Le.RGBA,{premultiply:!1}),$e.demTexture.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);_e.activeTexture.set(Le.TEXTURE0);let ct=$e.fbo;if(!ct){const Ft=new c.T(_e,{width:He,height:He,data:null},Le.RGBA);Ft.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),ct=$e.fbo=_e.createFramebuffer(He,He,!0,!1),ct.colorAttachment.set(Ft.texture)}_e.bindFramebuffer.set(ct.framebuffer),_e.viewport.set([0,0,He,He]),de.useProgram("hillshadePrepare").draw(_e,Le.TRIANGLES,ge,Se,Re,Dn.disabled,$d($e.tileID,Ye),null,null,ye.id,de.rasterBoundsBuffer,de.quadTriangleIndexBuffer,de.rasterBoundsSegments),$e.needsHillshadePrepare=!1}})(A,R,j,O,re,vn.disabled,he),G.viewport.set([0,0,A.width,A.height]);else if(A.renderPass==="translucent")if(q){const[de,fe,me]=A.stencilConfigForOverlapTwoPass(j);br(A,R,O,me,de,re,he,!1,$),br(A,R,O,me,fe,re,he,!0,$)}else{const[de,fe]=A.getStencilConfigForOverlapAndUpdateStencilID(j);br(A,R,O,fe,de,re,he,!1,$)}}(t,l,p,v,x):c.cj(p)?function(A,R,O,j,U){if(A.renderPass!=="translucent"||!j.length)return;const{isRenderingToTexture:$}=U,G=A.style.projection.useSubdivision,q=A.getDepthModeForSublayer(0,tn.ReadOnly),re=A.colorModeForRenderPass();if(G){const[he,de,fe]=A.stencilConfigForOverlapTwoPass(j);li(A,R,O,fe,he,q,re,!1,$),li(A,R,O,fe,de,q,re,!0,$)}else{const[he,de]=A.getStencilConfigForOverlapAndUpdateStencilID(j);li(A,R,O,de,he,q,re,!1,$)}}(t,l,p,v,x):c.bK(p)?function(A,R,O,j,U){if(A.renderPass!=="translucent"||O.paint.get("raster-opacity")===0||!j.length)return;const{isRenderingToTexture:$}=U,G=R.getSource(),q=A.style.projection.useSubdivision;if(G instanceof Ar)Bo(A,R,O,j,null,!1,!1,G.tileCoords,G.flippedWindingOrder,$);else if(q){const[re,he,de]=A.stencilConfigForOverlapTwoPass(j);Bo(A,R,O,de,re,!1,!0,Nn,!1,$),Bo(A,R,O,de,he,!0,!0,Nn,!1,$)}else{const[re,he]=A.getStencilConfigForOverlapAndUpdateStencilID(j);Bo(A,R,O,he,re,!1,!0,Nn,!1,$)}}(t,l,p,v,x):c.ck(p)?function(A,R,O,j,U){const $=O.paint.get("background-color"),G=O.paint.get("background-opacity");if(G===0)return;const{isRenderingToTexture:q}=U,re=A.context,he=re.gl,de=A.style.projection,fe=A.transform,me=fe.tileSize,ye=O.paint.get("background-pattern");if(A.isPatternMissing(ye))return;const ge=!ye&&$.a===1&&G===1&&A.opaquePassEnabledForLayer()?"opaque":"translucent";if(A.renderPass!==ge)return;const Se=vn.disabled,Re=A.getDepthModeForSublayer(0,ge==="opaque"?tn.ReadWrite:tn.ReadOnly),_e=A.colorModeForRenderPass(),Le=A.useProgram(ye?"backgroundPattern":"background"),qe=j||Cn(fe,{tileSize:me,terrain:A.style.map.terrain});ye&&(re.activeTexture.set(he.TEXTURE0),A.imageManager.bind(A.context));const $e=O.getCrossfadeParameters();for(const Ye of qe){const He=fe.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),bt=ye?op(G,A,ye,{tileID:Ye,tileSize:me},$e):Rm(G,$),wt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Ye),ct=de.getMeshFromTileID(re,Ye.canonical,!1,!0,"raster");Le.draw(re,he.TRIANGLES,Re,Se,_e,Dn.backCCW,bt,wt,He,O.id,ct.vertexBuffer,ct.indexBuffer,ct.segments)}}(t,0,p,v,x):c.cl(p)&&function(A,R,O,j){const{isRenderingGlobe:U}=j,$=A.context,G=O.implementation,q=A.style.projection,re=A.transform,he=re.getProjectionDataForCustomLayer(U),de={farZ:re.farZ,nearZ:re.nearZ,fov:re.fov*Math.PI/180,modelViewProjectionMatrix:re.modelViewProjectionMatrix,projectionMatrix:re.projectionMatrix,shaderData:{variantName:q.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${q.shaderPreludeCode.vertexSource}`,define:q.shaderDefine},defaultProjectionData:he},fe=G.renderingMode?G.renderingMode:"2d";if(A.renderPass==="offscreen"){const me=G.prerender;me&&(A.setCustomLayerDefaults(),$.setColorMode(A.colorModeForRenderPass()),me.call(G,$.gl,de),$.setDirty(),A.setBaseState())}else if(A.renderPass==="translucent"){A.setCustomLayerDefaults(),$.setColorMode(A.colorModeForRenderPass()),$.setStencilMode(vn.disabled);const me=fe==="3d"?A.getDepthModeFor3D():A.getDepthModeForSublayer(0,tn.ReadOnly);$.setDepthMode(me),G.render($.gl,de),$.setDirty(),A.setBaseState(),$.bindFramebuffer.set(null)}}(t,0,p,x))}saveTileTexture(t){const l=this._tileTextures[t.size[0]];l?l.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const l=this._tileTextures[t];return l&&l.length>0?l.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const l=this.imageManager.getPattern(t.from.toString()),p=this.imageManager.getPattern(t.to.toString());return!l||!p}useProgram(t,l,p=!1,v=[]){this.cache=this.cache||{};const x=!!this.style.map.terrain,A=this.style.projection,R=p?sa.projectionMercator:A.shaderPreludeCode,O=p?Sc:A.shaderDefine,j=t+(l?l.cacheKey:"")+`/${p?xn:A.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(x?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[j]||(this.cache[j]=new Jf(this.context,sa[t],l,Bl[t],this._showOverdrawInspector,x,R,O,v)),this.cache[j]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:l}=this.context.gl;return this.width!==t||this.height!==l}}function Vo(b,t){let l,p=!1,v=null,x=null;const A=()=>{v=null,p&&(b.apply(x,l),v=setTimeout(A,t),p=!1)};return(...R)=>(p=!0,x=this,l=R,v||A(),v)}class Ph{constructor(t){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let p;return l.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(p=v)}),(p&&p[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(!this._isValidHash(l))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,l)},this._removeHash=()=>{const l=this._getCurrentHash();if(l.length===0)return;const p=l.join("/");let v=p;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${p}`);let x=window.location.hash.replace(v,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let A=window.location.href.replace(/(#.+)?$/,x);A=A.replace("&&","&"),window.history.replaceState(window.history.state,null,A)},this._updateHash=Vo(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const l=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,v),A=Math.round(l.lng*x)/x,R=Math.round(l.lat*x)/x,O=this._map.getBearing(),j=this._map.getPitch();let U="";if(U+=t?`/${A}/${R}/${p}`:`${p}/${R}/${A}`,(O||j)&&(U+="/"+Math.round(10*O)/10),j&&(U+=`/${Math.round(j)}`),this._hashName){const $=this._hashName;let G=!1;const q=window.location.hash.slice(1).split("&").map(re=>{const he=re.split("=")[0];return he===$?(G=!0,`${he}=${U}`):re}).filter(re=>re);return G||q.push(`${$}=${U}`),`#${q.join("&")}`}return`#${U}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new c.S(+t[2],+t[1])}catch{return!1}const l=+t[0],p=+(t[3]||0),v=+(t[4]||0);return l>=this._map.getMinZoom()&&l<=this._map.getMaxZoom()&&p>=-180&&p<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const Zl={linearity:.3,easing:c.cm(0,0,.3,1)},bo=c.e({deceleration:2500,maxSpeed:1400},Zl),Lh=c.e({deceleration:20,maxSpeed:1400},Zl),Yl=c.e({deceleration:1e3,maxSpeed:360},Zl),Hr=c.e({deceleration:1e3,maxSpeed:90},Zl),zh=c.e({deceleration:1e3,maxSpeed:360},Zl);class mp{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:F.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,l=F.now();for(;t.length>0&&l-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)l.zoom+=x.zoomDelta||0,l.bearing+=x.bearingDelta||0,l.pitch+=x.pitchDelta||0,l.roll+=x.rollDelta||0,x.panDelta&&l.pan._add(x.panDelta),x.around&&(l.around=x.around),x.pinchAround&&(l.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(l.pan.mag()){const x=Du(l.pan.mag(),p,c.e({},bo,t||{})),A=l.pan.mult(x.amount/l.pan.mag()),R=this._map.cameraHelper.handlePanInertia(A,this._map.transform);v.center=R.easingCenter,v.offset=R.easingOffset,Cu(v,x)}if(l.zoom){const x=Du(l.zoom,p,Lh);v.zoom=this._map.transform.zoom+x.amount,Cu(v,x)}if(l.bearing){const x=Du(l.bearing,p,Yl);v.bearing=this._map.transform.bearing+c.ah(x.amount,-179,179),Cu(v,x)}if(l.pitch){const x=Du(l.pitch,p,Hr);v.pitch=this._map.transform.pitch+x.amount,Cu(v,x)}if(l.roll){const x=Du(l.roll,p,zh);v.roll=this._map.transform.roll+c.ah(x.amount,-179,179),Cu(v,x)}if(v.zoom||v.bearing){const x=l.pinchAround===void 0?l.around:l.pinchAround;v.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),c.e(v,{noMoveStart:!0})}}function Cu(b,t){(!b.duration||b.duration<t.duration)&&(b.duration=t.duration,b.easing=t.easing)}function Du(b,t,l){const{maxSpeed:p,linearity:v,deceleration:x}=l,A=c.ah(b*v/(t/1e3),-p,p),R=Math.abs(A)/(x*v);return{easing:l.easing,duration:1e3*R,amount:A*(R/2)}}class Ra extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,l,p,v={}){p=p instanceof MouseEvent?p:new MouseEvent(t,p);const x=B.mousePos(l.getCanvas(),p),A=l.unproject(x);super(t,c.e({point:x,lngLat:A,originalEvent:p},v)),this._defaultPrevented=!1,this.target=l}}class Ti extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,l,p){const v=t==="touchend"?p.changedTouches:p.touches,x=B.touchPos(l.getCanvasContainer(),v),A=x.map(O=>l.unproject(O)),R=x.reduce((O,j,U,$)=>O.add(j.div($.length)),new c.P(0,0));super(t,{points:x,point:R,lngLats:A,lngLat:l.unproject(R),originalEvent:p}),this._defaultPrevented=!1}}class Nh extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,l,p){super(t,{originalEvent:p}),this._defaultPrevented=!1}}class ca{constructor(t,l){this._map=t,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Nh(t.type,this._map,t))}mousedown(t,l){return this._mousedownPos=l,this._firePreventable(new Ra(t.type,this._map,t))}mouseup(t){this._map.fire(new Ra(t.type,this._map,t))}click(t,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new Ra(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Ra(t.type,this._map,t))}mouseover(t){this._map.fire(new Ra(t.type,this._map,t))}mouseout(t){this._map.fire(new Ra(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Ti(t.type,this._map,t))}touchmove(t){this._map.fire(new Ti(t.type,this._map,t))}touchend(t){this._map.fire(new Ti(t.type,this._map,t))}touchcancel(t){this._map.fire(new Ti(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wa{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Ra(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ra("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Ra(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hl{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(c.P.convert(t),this._map.terrain)}}class ta{constructor(t,l){this._map=t,this._tr=new Hl(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,l){this.isEnabled()&&t.shiftKey&&t.button===0&&(B.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(t,l){if(!this._active)return;const p=l;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=p,this._box||(this._box=B.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const x=Math.min(v.x,p.x),A=Math.max(v.x,p.x),R=Math.min(v.y,p.y),O=Math.max(v.y,p.y);B.setTransform(this._box,`translate(${x}px,${R}px)`),this._box.style.width=A-x+"px",this._box.style.height=O-R+"px"}mouseupWindow(t,l){if(!this._active||t.button!==0)return;const p=this._startPos,v=l;if(this.reset(),B.suppressClick(),p.x!==v.x||p.y!==v.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:t})),{cameraAnimation:x=>x.fitScreenCoordinates(p,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(B.remove(this._box),this._box=null),B.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,l){return this._map.fire(new c.l(t,{originalEvent:l}))}}function Qa(b,t){if(b.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${t.length}`);const l={};for(let p=0;p<b.length;p++)l[b[p].identifier]=t[p];return l}class fy{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){const x=new c.P(0,0);for(const A of v)x._add(A);return x.div(v.length)}(l),this.touches=Qa(p,l)))}touchmove(t,l,p){if(this.aborted||!this.centroid)return;const v=Qa(p,l);for(const x in this.touches){const A=v[x];(!A||A.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(t,l,p){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class ef{constructor(t){this.singleTap=new fy(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,l,p){this.singleTap.touchstart(t,l,p)}touchmove(t,l,p){this.singleTap.touchmove(t,l,p)}touchend(t,l,p){const v=this.singleTap.touchend(t,l,p);if(v){const x=t.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(v)<30;if(x&&A||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class py{constructor(t){this._tr=new Hl(t),this._zoomIn=new ef({numTouches:1,numTaps:2}),this._zoomOut=new ef({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,l,p){this._zoomIn.touchstart(t,l,p),this._zoomOut.touchstart(t,l,p)}touchmove(t,l,p){this._zoomIn.touchmove(t,l,p),this._zoomOut.touchmove(t,l,p)}touchend(t,l,p){const v=this._zoomIn.touchend(t,l,p),x=this._zoomOut.touchend(t,l,p),A=this._tr;return v?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:A.zoom+1,around:A.unproject(v)},{originalEvent:t})}):x?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:A.zoom-1,around:A.unproject(x)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Iu{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const l=this._moveFunction(...t);if(l.bearingDelta||l.pitchDelta||l.rollDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(t,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(l)?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,l){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const v=Array.isArray(l)?l[0]:l;return!this._moved&&v.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(p,v))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&B.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ql=0,Uc=2,xo={[ql]:1,[Uc]:2};class Rt{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const l=B.mouseButton(t);this._eventButton=l}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(l,p){const v=xo[p];return l.buttons===void 0||(l.buttons&v)!==v}(t,this._eventButton)}isValidEndEvent(t){return B.mouseButton(t)===this._eventButton}}class Vc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class jh{constructor(t=new Rt({checkCorrectEvent:()=>!0}),l=new Vc){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=l}_executeRelevantHandler(t,l,p){return t instanceof MouseEvent?l(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?p(t):void 0}startMove(t){this._executeRelevantHandler(t,l=>this.mouseMoveStateManager.startMove(l),l=>this.oneFingerTouchMoveStateManager.startMove(l))}endMove(t){this._executeRelevantHandler(t,l=>this.mouseMoveStateManager.endMove(l),l=>this.oneFingerTouchMoveStateManager.endMove(l))}isValidStartEvent(t){return this._executeRelevantHandler(t,l=>this.mouseMoveStateManager.isValidStartEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidStartEvent(l))}isValidMoveEvent(t){return this._executeRelevantHandler(t,l=>this.mouseMoveStateManager.isValidMoveEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(l))}isValidEndEvent(t){return this._executeRelevantHandler(t,l=>this.mouseMoveStateManager.isValidEndEvent(l),l=>this.oneFingerTouchMoveStateManager.isValidEndEvent(l))}}const Xl=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=t=>{t.preventDefault()}};class Wl{constructor(t,l){this._clickTolerance=t.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,l,p){return this._calculateTransform(t,l,p)}touchmove(t,l,p){if(this._active){if(!this._shouldBePrevented(p.length))return t.preventDefault(),this._calculateTransform(t,l,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,l,p){this._calculateTransform(t,l,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,l,p){p.length>0&&(this._active=!0);const v=Qa(p,l),x=new c.P(0,0),A=new c.P(0,0);let R=0;for(const j in v){const U=v[j],$=this._touches[j];$&&(x._add(U),A._add(U.sub($)),R++,v[j]=U)}if(this._touches=v,this._shouldBePrevented(R)||!A.mag())return;const O=A.div(R);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(R),panDelta:O}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ql{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(t,l,p){if(!this._firstTwoTouches)return;t.preventDefault();const[v,x]=this._firstTwoTouches,A=Gc(p,l,v),R=Gc(p,l,x);if(!A||!R)return;const O=this._aroundCenter?null:A.add(R).div(2);return this._move([A,R],O,t)}touchend(t,l,p){if(!this._firstTwoTouches)return;const[v,x]=this._firstTwoTouches,A=Gc(p,l,v),R=Gc(p,l,x);A&&R||(this._active&&B.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Gc(b,t,l){for(let p=0;p<b.length;p++)if(b[p].identifier===l)return t[p]}function yn(b,t){return Math.log(b/t)/Math.LN2}class Rs extends Ql{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,l){const p=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(yn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:yn(this._distance,p),pinchAround:l}}}function gp(b,t){return 180*b.angleWith(t)/Math.PI}class Fh extends Ql{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,l,p){const v=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:gp(this._vector,v),pinchAround:l}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const l=25/(Math.PI*this._minDiameter)*360,p=gp(t,this._startVector);return Math.abs(p)<l}}function Kl(b){return Math.abs(b.y)>Math.abs(b.x)}class Ru extends Ql{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,l,p){super.touchstart(t,l,p),this._currentTouchCount=p.length}_start(t){this._lastPoints=t,Kl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,l,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=t[0].sub(this._lastPoints[0]),x=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,x,p.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(v.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(t,l,p){if(this._valid!==void 0)return this._valid;const v=t.mag()>=2,x=l.mag()>=2;if(!v&&!x)return;if(!v||!x)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const A=t.y>0==l.y>0;return Kl(t)&&Kl(l)&&A}}const Bh={panStep:100,bearingStep:15,pitchStep:10};class Jl{constructor(t){this._tr=new Hl(t);const l=Bh;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let l=0,p=0,v=0,x=0,A=0;switch(t.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:t.shiftKey?p=-1:(t.preventDefault(),x=-1);break;case 39:t.shiftKey?p=1:(t.preventDefault(),x=1);break;case 38:t.shiftKey?v=1:(t.preventDefault(),A=-1);break;case 40:t.shiftKey?v=-1:(t.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(p=0,v=0),{cameraAnimation:R=>{const O=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:Uh,zoom:l?Math.round(O.zoom)+l*(t.shiftKey?2:1):O.zoom,bearing:O.bearing+p*this._bearingStep,pitch:O.pitch+v*this._pitchStep,offset:[-x*this._panStep,-A*this._panStep],center:O.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Uh(b){return b*(2-b)}const yp=4.000244140625,ec=1/450;class _p{constructor(t,l){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=t,this._tr=new Hl(t),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ec}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let l=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const p=F.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%yp==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(v*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),t.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=t,this._delta-=l,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=B.mousePos(this._map.getCanvas(),t),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(c.S.convert(p.center)):l,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const R=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=R),typeof this._targetZoom=="number"&&(this._targetZoom+=R)}if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>yp?this._wheelZoomRate:this._defaultZoomRate;let O=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&O!==0&&(O=1/O);const j=typeof this._targetZoom!="number"?t.scale:c.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),c.ak(j*O)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,p=this._startZoom,v=this._easing;let x,A=!1;if(this._type==="wheel"&&p&&v){const R=F.now()-this._lastWheelEventTime,O=Math.min((R+5)/200,1),j=v(O);x=c.C.number(p,l,j),O<1?this._frameId||(this._frameId=!0):A=!0}else x=l,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!A,zoomDelta:x-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let l=c.co;if(this._prevEase){const p=this._prevEase,v=(F.now()-p.start)/p.duration,x=p.easing(v+.01)-p.easing(v),A=.27/Math.sqrt(x*x+1e-4)*.01,R=Math.sqrt(.0729-A*A);l=c.cm(A,R,.25,1)}return this._prevEase={start:F.now(),duration:t,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class cl{constructor(t,l){this._clickZoom=t,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ks{constructor(t){this._tr=new Hl(t),this.reset()}reset(){this._active=!1}dblclick(t,l){return t.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ci{constructor(){this._tap=new ef({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,l,p){if(!this._swipePoint)if(this._tapTime){const v=l[0],x=t.timeStamp-this._tapTime<500,A=this._tapPoint.dist(v)<30;x&&A?p.length>0&&(this._swipePoint=v,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(t,l,p)}touchmove(t,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const v=l[0],x=v.y-this._swipePoint.y;return this._swipePoint=v,t.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(t,l,p)}touchend(t,l,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const v=this._tap.touchend(t,l,p);v&&(this._tapTime=t.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ul{constructor(t,l,p){this._el=t,this._mousePan=l,this._touchPan=p}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wo{constructor(t,l,p,v){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=l,this._mousePitch=p,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class tc{constructor(t,l,p,v){this._el=t,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Vh{constructor(t,l){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=l,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=B.create("div","maplibregl-cooperative-gesture-screen",t);let l=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(l=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=l,this._container.appendChild(v);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=p,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(B.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,l){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:t,originalEvent:l})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const $c=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class ku extends c.l{}function Zc(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Go{constructor(t,l){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,x)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=v.type==="renderFrame"?void 0:v,R={needsRenderFrame:!1},O={},j={};for(const{handlerName:G,handler:q,allowed:re}of this._handlers){if(!q.isEnabled())continue;let he;if(this._blockedByActive(j,re,G))q.reset();else if(q[x||v.type]){if(c.cp(v,x||v.type)){const de=B.mousePos(this._map.getCanvas(),v);he=q[x||v.type](v,de)}else if(c.cq(v,x||v.type)){const de=this._getMapTouches(v.touches),fe=B.touchPos(this._map.getCanvas(),de);he=q[x||v.type](v,fe,de)}else c.cr(x||v.type)||(he=q[x||v.type](v));this.mergeHandlerResult(R,O,he,G,A),he&&he.needsRenderFrame&&this._triggerRenderFrame()}(he||q.isActive())&&(j[G]=q)}const U={};for(const G in this._previousActiveHandlers)j[G]||(U[G]=A);this._previousActiveHandlers=j,(Object.keys(U).length||Zc(R))&&(this._changes.push([R,O,U]),this._triggerRenderFrame()),(Object.keys(j).length||Zc(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=R;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mp(t),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,x,A]of this._listeners)B.addEventListener(v,x,v===document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[t,l,p]of this._listeners)B.removeEventListener(t,l,t===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(t){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new ca(l,t));const v=l.boxZoom=new ta(l,t);this._add("boxZoom",v),t.interactive&&t.boxZoom&&v.enable();const x=l.cooperativeGestures=new Vh(l,t.cooperativeGestures);this._add("cooperativeGestures",x),t.cooperativeGestures&&x.enable();const A=new py(l),R=new ks(l);l.doubleClickZoom=new cl(R,A),this._add("tapZoom",A),this._add("clickZoom",R),t.interactive&&t.doubleClickZoom&&l.doubleClickZoom.enable();const O=new ci;this._add("tapDragZoom",O);const j=l.touchPitch=new Ru(l);this._add("touchPitch",j),t.interactive&&t.touchPitch&&l.touchPitch.enable(t.touchPitch);const U=()=>l.project(l.getCenter()),$=function({enable:ge,clickTolerance:Se,aroundCenter:Re=!0,minPixelCenterThreshold:_e=100,rotateDegreesPerPixelMoved:Le=.8},qe){const $e=new Rt({checkCorrectEvent:Ye=>B.mouseButton(Ye)===0&&Ye.ctrlKey||B.mouseButton(Ye)===2&&!Ye.ctrlKey});return new Iu({clickTolerance:Se,move:(Ye,He)=>{const bt=qe();if(Re&&Math.abs(bt.y-Ye.y)>_e)return{bearingDelta:c.cn(new c.P(Ye.x,He.y),He,bt)};let wt=(He.x-Ye.x)*Le;return Re&&He.y<bt.y&&(wt=-wt),{bearingDelta:wt}},moveStateManager:$e,enable:ge,assignEvents:Xl})}(t,U),G=function({enable:ge,clickTolerance:Se,pitchDegreesPerPixelMoved:Re=-.5}){const _e=new Rt({checkCorrectEvent:Le=>B.mouseButton(Le)===0&&Le.ctrlKey||B.mouseButton(Le)===2});return new Iu({clickTolerance:Se,move:(Le,qe)=>({pitchDelta:(qe.y-Le.y)*Re}),moveStateManager:_e,enable:ge,assignEvents:Xl})}(t),q=function({enable:ge,clickTolerance:Se,rollDegreesPerPixelMoved:Re=.3},_e){const Le=new Rt({checkCorrectEvent:qe=>B.mouseButton(qe)===2&&qe.ctrlKey});return new Iu({clickTolerance:Se,move:(qe,$e)=>{const Ye=_e();let He=($e.x-qe.x)*Re;return $e.y<Ye.y&&(He=-He),{rollDelta:He}},moveStateManager:Le,enable:ge,assignEvents:Xl})}(t,U);l.dragRotate=new wo(t,$,G,q),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",G,["mouseRotate","mouseRoll"]),this._add("mouseRoll",q,["mousePitch"]),t.interactive&&t.dragRotate&&l.dragRotate.enable();const re=function({enable:ge,clickTolerance:Se}){const Re=new Rt({checkCorrectEvent:_e=>B.mouseButton(_e)===0&&!_e.ctrlKey});return new Iu({clickTolerance:Se,move:(_e,Le)=>({around:Le,panDelta:Le.sub(_e)}),activateOnStart:!0,moveStateManager:Re,enable:ge,assignEvents:Xl})}(t),he=new Wl(t,l);l.dragPan=new ul(p,re,he),this._add("mousePan",re),this._add("touchPan",he,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&l.dragPan.enable(t.dragPan);const de=new Fh,fe=new Rs;l.touchZoomRotate=new tc(p,fe,de,O),this._add("touchRotate",de,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&l.touchZoomRotate.enable(t.touchZoomRotate);const me=l.scrollZoom=new _p(l,()=>this._triggerRenderFrame());this._add("scrollZoom",me,["mousePan"]),t.interactive&&t.scrollZoom&&l.scrollZoom.enable(t.scrollZoom);const ye=l.keyboard=new Jl(l);this._add("keyboard",ye),t.interactive&&t.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new wa(l))}_add(t,l,p){this._handlers.push({handlerName:t,handler:l,allowed:p}),this._handlersById[t]=l}stop(t){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!$c(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,l,p){for(const v in t)if(v!==p&&(!l||l.indexOf(v)<0))return!0;return!1}_getMapTouches(t){const l=[];for(const p of t)this._el.contains(p.target)&&l.push(p);return l}mergeHandlerResult(t,l,p,v,x){if(!p)return;c.e(t,p);const A={handlerName:v,originalEvent:p.originalEvent||x};p.zoomDelta!==void 0&&(l.zoom=A),p.panDelta!==void 0&&(l.drag=A),p.rollDelta!==void 0&&(l.roll=A),p.pitchDelta!==void 0&&(l.pitch=A),p.bearingDelta!==void 0&&(l.rotate=A)}_applyChanges(){const t={},l={},p={};for(const[v,x,A]of this._changes)v.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(v.panDelta)),v.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(t.rollDelta=(t.rollDelta||0)+v.rollDelta),v.around!==void 0&&(t.around=v.around),v.pinchAround!==void 0&&(t.pinchAround=v.pinchAround),v.noInertia&&(t.noInertia=v.noInertia),c.e(l,x),c.e(p,A);this._updateMapTransform(t,l,p),this._changes=[]}_updateMapTransform(t,l,p){const v=this._map,x=v._getTransformForUpdate(),A=v.terrain;if(!(Zc(t)||A&&this._terrainMovement))return this._fireEvents(l,p,!0);v._stop(!0);let{panDelta:R,zoomDelta:O,bearingDelta:j,pitchDelta:U,rollDelta:$,around:G,pinchAround:q}=t;q!==void 0&&(G=q),G=G||v.transform.centerPoint,A&&!x.isPointOnMapSurface(G)&&(G=x.centerPoint);const re={panDelta:R,zoomDelta:O,rollDelta:$,pitchDelta:U,bearingDelta:j,around:G};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(G)&&(G=x.centerPoint);const he=G.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(R?G.sub(R):G);this._handleMapControls({terrain:A,tr:x,deltasForHelper:re,preZoomAroundLoc:he,combinedEventsInProgress:l,panDelta:R}),v._applyUpdatedTransform(x),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(l,p,!0)}_handleMapControls({terrain:t,tr:l,deltasForHelper:p,preZoomAroundLoc:v,combinedEventsInProgress:x,panDelta:A}){const R=this._map.cameraHelper;if(R.handleMapControlsRollPitchBearingZoom(p,l),t)return R.useGlobeControls?(this._terrainMovement||!x.drag&&!x.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void R.handleMapControlsPan(p,l,v)):this._terrainMovement||!x.drag&&!x.zoom?void(x.drag&&this._terrainMovement&&A?l.setCenter(l.screenPointToLocation(l.centerPoint.sub(A))):R.handleMapControlsPan(p,l,v)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void R.handleMapControlsPan(p,l,v));R.handleMapControlsPan(p,l,v)}_fireEvents(t,l,p){const v=$c(this._eventsInProgress),x=$c(t),A={};for(const $ in t){const{originalEvent:G}=t[$];this._eventsInProgress[$]||(A[`${$}start`]=G),this._eventsInProgress[$]=t[$]}!v&&x&&this._fireEvent("movestart",x.originalEvent);for(const $ in A)this._fireEvent($,A[$]);x&&this._fireEvent("move",x.originalEvent);for(const $ in t){const{originalEvent:G}=t[$];this._fireEvent($,G)}const R={};let O;for(const $ in this._eventsInProgress){const{handlerName:G,originalEvent:q}=this._eventsInProgress[$];this._handlersById[G].isActive()||(delete this._eventsInProgress[$],O=l[G]||q,R[`${$}end`]=O)}for(const $ in R)this._fireEvent($,R[$]);const j=$c(this._eventsInProgress),U=(v||x)&&!j;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(p&&U){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),G=q=>q!==0&&-this._bearingSnap<q&&q<this._bearingSnap;!$||!$.essential&&F.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:O})),G(this._map.getBearing())&&this._map.resetNorth()):(G($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:O})),this._updatingCamera=!1}}_fireEvent(t,l){this._map.fire(new c.l(t,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new ku("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Gh extends c.E{constructor(t,l,p){super(),this._renderFrameCallback=()=>{const v=Math.min((F.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=p.bearingSnap,this.cameraHelper=l,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,l){t.apply(this.transform),this.transform=t,this.cameraHelper=l}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,l){return this.jumpTo({center:t},l)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,l){return this.jumpTo({elevation:t},l),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,l,p){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},l),p)}panTo(t,l,p){return this.easeTo(c.e({center:t},l),p)}getZoom(){return this.transform.zoom}setZoom(t,l){return this.jumpTo({zoom:t},l),this}zoomTo(t,l,p){return this.easeTo(c.e({zoom:t},l),p)}zoomIn(t,l){return this.zoomTo(this.getZoom()+1,t,l),this}zoomOut(t,l){return this.zoomTo(this.getZoom()-1,t,l),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,l){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new c.l("movestart",l)).fire(new c.l("move",l)).fire(new c.l("moveend",l))),this}getBearing(){return this.transform.bearing}setBearing(t,l){return this.jumpTo({bearing:t},l),this}getPadding(){return this.transform.padding}setPadding(t,l){return this.jumpTo({padding:t},l),this}rotateTo(t,l,p){return this.easeTo(c.e({bearing:t},l),p)}resetNorth(t,l){return this.rotateTo(0,c.e({duration:1e3},t),l),this}resetNorthPitch(t,l){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},t),l),this}snapToNorth(t,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,l):this}getPitch(){return this.transform.pitch}setPitch(t,l){return this.jumpTo({pitch:t},l),this}getRoll(){return this.transform.roll}setRoll(t,l){return this.jumpTo({roll:t},l),this}cameraForBounds(t,l){t=Wn.convert(t).adjustAntiMeridian();const p=l&&l.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),p,l)}_cameraForBoxAndBearing(t,l,p,v){const x={top:0,bottom:0,right:0,left:0};if(typeof(v=c.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const j=v.padding;v.padding={top:j,bottom:j,right:j,left:j}}const A=c.e(x,v.padding);v.padding=A;const R=this.transform,O=new Wn(t,l);return this.cameraHelper.cameraForBoxAndBearing(v,A,O,p,R)}fitBounds(t,l,p){return this._fitInternal(this.cameraForBounds(t,l),l,p)}fitScreenCoordinates(t,l,p,v,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(t)),this.transform.screenPointToLocation(c.P.convert(l)),p,v),v,x)}_fitInternal(t,l,p){return t?(delete(l=c.e(t,l)).padding,l.linear?this.easeTo(l,p):this.flyTo(l,p)):this}jumpTo(t,l){this.stop();const p=this._getTransformForUpdate();let v=!1,x=!1,A=!1;const R=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,t);const O=p.zoom!==R;return"elevation"in t&&p.elevation!==+t.elevation&&p.setElevation(+t.elevation),"bearing"in t&&p.bearing!==+t.bearing&&(v=!0,p.setBearing(+t.bearing)),"pitch"in t&&p.pitch!==+t.pitch&&(x=!0,p.setPitch(+t.pitch)),"roll"in t&&p.roll!==+t.roll&&(A=!0,p.setRoll(+t.roll)),t.padding==null||p.isPaddingEqual(t.padding)||p.setPadding(t.padding),this._applyUpdatedTransform(p),this.fire(new c.l("movestart",l)).fire(new c.l("move",l)),O&&this.fire(new c.l("zoomstart",l)).fire(new c.l("zoom",l)).fire(new c.l("zoomend",l)),v&&this.fire(new c.l("rotatestart",l)).fire(new c.l("rotate",l)).fire(new c.l("rotateend",l)),x&&this.fire(new c.l("pitchstart",l)).fire(new c.l("pitch",l)).fire(new c.l("pitchend",l)),A&&this.fire(new c.l("rollstart",l)).fire(new c.l("roll",l)).fire(new c.l("rollend",l)),this.fire(new c.l("moveend",l))}calculateCameraOptionsFromTo(t,l,p,v=0){const x=c.a1.fromLngLat(t,l),A=c.a1.fromLngLat(p,v),R=A.x-x.x,O=A.y-x.y,j=A.z-x.z,U=Math.hypot(R,O,j);if(U===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(R,O),G=c.ak(this.transform.cameraToCenterDistance/U/this.transform.tileSize),q=180*Math.atan2(R,-O)/Math.PI;let re=180*Math.acos($/U)/Math.PI;return re=j<0?90-re:90+re,{center:A.toLngLat(),elevation:v,zoom:G,pitch:re,bearing:q}}calculateCameraOptionsFromCameraLngLatAltRotation(t,l,p,v,x){const A=this.transform.calculateCenterFromCameraLngLatAlt(t,l,p,v);return{center:A.center,elevation:A.elevation,zoom:A.zoom,bearing:p,pitch:v,roll:x}}easeTo(t,l){this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.co},t)).animate===!1||!t.essential&&F.prefersReducedMotion)&&(t.duration=0);const p=this._getTransformForUpdate(),v=this.getBearing(),x=p.pitch,A=p.roll,R="bearing"in t?this._normalizeBearing(t.bearing,v):v,O="pitch"in t?+t.pitch:x,j="roll"in t?this._normalizeBearing(t.roll,A):A,U="padding"in t?t.padding:p.padding,$=c.P.convert(t.offset);let G,q;t.around&&(G=c.S.convert(t.around),q=p.locationToScreenPoint(G));const re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},he=this.cameraHelper.handleEaseTo(p,{bearing:R,pitch:O,roll:j,padding:U,around:G,aroundPoint:q,offsetAsPoint:$,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||v!==R,this._pitching=this._pitching||O!==x,this._rolling=this._rolling||j!==A,this._padding=!p.isPaddingEqual(U),this._zooming=this._zooming||he.isZooming,this._easeId=t.easeId,this._prepareEase(l,t.noMoveStart,re),this.terrain&&this._prepareElevation(he.elevationCenter),this._ease(de=>{he.easeFunc(de),this.terrain&&!t.freezeElevation&&this._updateElevation(de),this._applyUpdatedTransform(p),this._fireMoveEvents(l)},de=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(l,de)},t),this}_prepareEase(t,l,p={}){this._moving=!0,l||p.moving||this.fire(new c.l("movestart",t)),this._zooming&&!p.zooming&&this.fire(new c.l("zoomstart",t)),this._rotating&&!p.rotating&&this.fire(new c.l("rotatestart",t)),this._pitching&&!p.pitching&&this.fire(new c.l("pitchstart",t)),this._rolling&&!p.rolling&&this.fire(new c.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&l!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(p-(l-(p*t+this._elevationStart))/(1-t)),this._elevationTarget=l}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const l=t.getCameraLngLat(),p=t.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(l,t.zoom):0;if(p<v){const x=this.calculateCameraOptionsFromTo(l,v,t.center,t.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(t){const l=[];if(l.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&l.push(v=>this.transformCameraUpdate(v)),!l.length)return;const p=t.clone();for(const v of l){const x=p.clone(),{center:A,zoom:R,roll:O,pitch:j,bearing:U,elevation:$}=v(x);A&&x.setCenter(A),$!==void 0&&x.setElevation($),R!==void 0&&x.setZoom(R),O!==void 0&&x.setRoll(O),j!==void 0&&x.setPitch(j),U!==void 0&&x.setBearing(U),p.apply(x)}this.transform.apply(p)}_fireMoveEvents(t){this.fire(new c.l("move",t)),this._zooming&&this.fire(new c.l("zoom",t)),this._rotating&&this.fire(new c.l("rotate",t)),this._pitching&&this.fire(new c.l("pitch",t)),this._rolling&&this.fire(new c.l("roll",t))}_afterEase(t,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const p=this._zooming,v=this._rotating,x=this._pitching,A=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new c.l("zoomend",t)),v&&this.fire(new c.l("rotateend",t)),x&&this.fire(new c.l("pitchend",t)),A&&this.fire(new c.l("rollend",t)),this.fire(new c.l("moveend",t))}flyTo(t,l){if(!t.essential&&F.prefersReducedMotion){const He=c.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(He,l)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},t);const p=this._getTransformForUpdate(),v=p.bearing,x=p.pitch,A=p.roll,R=p.padding,O="bearing"in t?this._normalizeBearing(t.bearing,v):v,j="pitch"in t?+t.pitch:x,U="roll"in t?this._normalizeBearing(t.roll,A):A,$="padding"in t?t.padding:p.padding,G=c.P.convert(t.offset);let q=p.centerPoint.add(G);const re=p.screenPointToLocation(q),he=this.cameraHelper.handleFlyTo(p,{bearing:O,pitch:j,roll:U,padding:$,locationAtOffset:re,offsetAsPoint:G,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let de=t.curve;const fe=Math.max(p.width,p.height),me=fe/he.scaleOfZoom,ye=he.pixelPathLength;typeof he.scaleOfMinZoom=="number"&&(de=Math.sqrt(fe/he.scaleOfMinZoom/ye*2));const ge=de*de;function Se(He){const bt=(me*me-fe*fe+(He?-1:1)*ge*ge*ye*ye)/(2*(He?me:fe)*ge*ye);return Math.log(Math.sqrt(bt*bt+1)-bt)}function Re(He){return(Math.exp(He)-Math.exp(-He))/2}function _e(He){return(Math.exp(He)+Math.exp(-He))/2}const Le=Se(!1);let qe=function(He){return _e(Le)/_e(Le+de*He)},$e=function(He){return fe*((_e(Le)*(Re(bt=Le+de*He)/_e(bt))-Re(Le))/ge)/ye;var bt},Ye=(Se(!0)-Le)/de;if(Math.abs(ye)<2e-6||!isFinite(Ye)){if(Math.abs(fe-me)<1e-6)return this.easeTo(t,l);const He=me<fe?-1:1;Ye=Math.abs(Math.log(me/fe))/de,$e=()=>0,qe=bt=>Math.exp(He*de*bt)}return t.duration="duration"in t?+t.duration:1e3*Ye/("screenSpeed"in t?+t.screenSpeed/de:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=v!==O,this._pitching=j!==x,this._rolling=U!==A,this._padding=!p.isPaddingEqual($),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(he.targetCenter),this._ease(He=>{const bt=He*Ye,wt=1/qe(bt),ct=$e(bt);this._rotating&&p.setBearing(c.C.number(v,O,He)),this._pitching&&p.setPitch(c.C.number(x,j,He)),this._rolling&&p.setRoll(c.C.number(A,U,He)),this._padding&&(p.interpolatePadding(R,$,He),q=p.centerPoint.add(G)),he.easeFunc(He,wt,ct,q),this.terrain&&!t.freezeElevation&&this._updateElevation(He),this._applyUpdatedTransform(p),this._fireMoveEvents(l)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(l)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,l){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,l)}return t||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(t,l,p){p.animate===!1||p.duration===0?(t(1),l()):(this._easeStart=F.now(),this._easeOptions=p,this._onEaseFrame=t,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,l){t=c.aO(t,-180,180);const p=Math.abs(t-l);return Math.abs(t-360-l)<p&&(t-=360),Math.abs(t+360-l)<p&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(t),this.transform.tileZoom):null}}const Lt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class qt{constructor(t=Lt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=B.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=B.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=B.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){B.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,l){const p=this._map._getUIString(`AttributionControl.${l}`);t.title=p,t.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const l=this._map.style.sourceCaches;for(const v in l){const x=l[v];if(x.used||x.usedForTerrain){const A=x.getSource();A.attribution&&t.indexOf(A.attribution)<0&&t.push(A.attribution)}}t=t.filter(v=>String(v).trim()),t.sort((v,x)=>v.length-x.length),t=t.filter((v,x)=>{for(let A=x+1;A<t.length;A++)if(t[A].indexOf(v)>=0)return!1;return!0});const p=t.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,t.length?(this._innerContainer.innerHTML=B.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yc{constructor(t={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const p=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=B.create("div","maplibregl-ctrl");const l=B.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){B.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class tf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const l=++this._id;return this._queue.push({callback:t,id:l,cancelled:!1}),l}remove(t){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const v of p)if(v.id===t)return void(v.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ou=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Si extends c.E{constructor(t){super(),this._lastTilesetChange=F.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,l){this.sourceCache.update(t,l),this._renderableTilesKeys=[];const p={};for(const v of Cn(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),c.bZ(v.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[v.key]=new ee(v,this.tileSize),this._lastTilesetChange=F.now());for(const v in this._tiles)p[v]||delete this._tiles[v]}freeRtt(t){for(const l in this._tiles){const p=this._tiles[l];(!t||p.tileID.equals(t)||p.tileID.isChildOf(t)||t.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,l){return l?this._getTerrainCoordsForTileRanges(t,l):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const l={};for(const p of this._renderableTilesKeys){const v=this._tiles[p].tileID,x=t.clone(),A=c.ba();if(v.canonical.equals(t.canonical))c.bZ(A,0,c.$,c.$,0,0,1);else if(v.canonical.isChildOf(t.canonical)){const R=v.canonical.z-t.canonical.z,O=v.canonical.x-(v.canonical.x>>R<<R),j=v.canonical.y-(v.canonical.y>>R<<R),U=c.$>>R;c.bZ(A,0,U,U,0,0,1),c.M(A,A,[-O*U,-j*U,0])}else{if(!t.canonical.isChildOf(v.canonical))continue;{const R=t.canonical.z-v.canonical.z,O=t.canonical.x-(t.canonical.x>>R<<R),j=t.canonical.y-(t.canonical.y>>R<<R),U=c.$>>R;c.bZ(A,0,c.$,c.$,0,0,1),c.M(A,A,[O*U,j*U,0]),c.N(A,A,[1/2**R,1/2**R,0])}}x.terrainRttPosMatrix32f=new Float32Array(A),l[p]=x}return l}_getTerrainCoordsForTileRanges(t,l){const p={};for(const v of this._renderableTilesKeys){const x=this._tiles[v].tileID;if(!this._isWithinTileRanges(x,l))continue;const A=t.clone(),R=c.ba();if(x.canonical.z===t.canonical.z){const O=t.canonical.x-x.canonical.x,j=t.canonical.y-x.canonical.y;c.bZ(R,0,c.$,c.$,0,0,1),c.M(R,R,[O*c.$,j*c.$,0])}else if(x.canonical.z>t.canonical.z){const O=x.canonical.z-t.canonical.z,j=x.canonical.x-(x.canonical.x>>O<<O),U=x.canonical.y-(x.canonical.y>>O<<O),$=t.canonical.x-(x.canonical.x>>O),G=t.canonical.y-(x.canonical.y>>O),q=c.$>>O;c.bZ(R,0,q,q,0,0,1),c.M(R,R,[-j*q+$*c.$,-U*q+G*c.$,0])}else{const O=t.canonical.z-x.canonical.z,j=t.canonical.x-(t.canonical.x>>O<<O),U=t.canonical.y-(t.canonical.y>>O<<O),$=(t.canonical.x>>O)-x.canonical.x,G=(t.canonical.y>>O)-x.canonical.y,q=c.$<<O;c.bZ(R,0,q,q,0,0,1),c.M(R,R,[j*c.$+$*q,U*c.$+G*q,0])}A.terrainRttPosMatrix32f=new Float32Array(R),p[v]=A}return p}getSourceTile(t,l){const p=this.sourceCache._source;let v=t.overscaledZ-this.deltaZoom;if(v>p.maxzoom&&(v=p.maxzoom),v<p.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(v).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!x||!x.dem)&&l)for(;v>=p.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(t.scaledTo(v--).key);return x}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,l){return l[t.canonical.z]&&t.canonical.x>=l[t.canonical.z].minTileX&&t.canonical.x<=l[t.canonical.z].maxTileX&&t.canonical.y>=l[t.canonical.z].minTileY&&t.canonical.y<=l[t.canonical.z].maxTileY}}class Ka{constructor(t,l,p){this._meshCache={},this.painter=t,this.sourceCache=new Si(l),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,l,p,v=c.$){var x;if(!(l>=0&&l<v&&p>=0&&p<v))return 0;const A=this.getTerrainData(t),R=(x=A.tile)===null||x===void 0?void 0:x.dem;if(!R)return 0;const O=c.cs([],[l/v*c.$,p/v*c.$],A.u_terrain_matrix),j=[O[0]*R.dim,O[1]*R.dim],U=Math.floor(j[0]),$=Math.floor(j[1]),G=j[0]-U,q=j[1]-$;return R.get(U,$)*(1-G)*(1-q)+R.get(U+1,$)*G*(1-q)+R.get(U,$+1)*(1-G)*q+R.get(U+1,$+1)*G*q}getElevationForLngLatZoom(t,l){if(!c.ct(l,t.wrap()))return 0;const{tileID:p,mercatorX:v,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(t,l);return this.getElevation(p,v%c.$,x%c.$,c.$)}getElevation(t,l,p,v=c.$){return this.getDEMElevation(t,l,p,v)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const v=this.painter.context,x=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(v,x,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(v,new c.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const l=this.sourceCache.getSourceTile(t,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const v=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new c.T(v,l.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),l.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const p=l&&l+l.tileID.key+t.key;if(p&&!this._demMatrixCache[p]){const v=this.sourceCache.sourceCache._source.maxzoom;let x=t.canonical.z-l.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=v?x=t.canonical.z-v:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=t.canonical.x-(t.canonical.x>>x<<x),R=t.canonical.y-(t.canonical.y>>x<<x),O=c.cu(new Float64Array(16),[1/(c.$<<x),1/(c.$<<x),0]);c.M(O,O,[A*c.$,R*c.$,0]),this._demMatrixCache[t.key]={matrix:O,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(t){const l=this.painter,p=l.width/devicePixelRatio,v=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(l.context,{width:p,height:v,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(l.context,{width:p,height:v,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(p,v,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,p,v))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,A=0;x<this._coordsTextureSize;x++)for(let R=0;R<this._coordsTextureSize;R++,A+=4)l[A+0]=255&R,l[A+1]=255&x,l[A+2]=R>>8<<4|x>>8,l[A+3]=0;const p=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),v=new c.T(t,p,t.gl.RGBA,{premultiply:!1});return v.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const l=new Uint8Array(4),p=this.painter.context,v=p.gl,x=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),A=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(x,R-A-1,1,1,v.RGBA,v.UNSIGNED_BYTE,l),p.bindFramebuffer.set(null);const O=l[0]+(l[2]>>4<<8),j=l[1]+((15&l[2])<<8),U=this.coordsIndex[255-l[3]],$=U&&this.sourceCache.getTileByID(U);if(!$)return null;const G=this._coordsTextureSize,q=(1<<$.tileID.canonical.z)*G;return new c.a1(($.tileID.canonical.x*G+O)/q+$.tileID.wrap,($.tileID.canonical.y*G+j)/q,this.getElevation($.tileID,O,j,G))}depthAtPoint(t){const l=new Uint8Array(4),p=this.painter.context,v=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,l),p.bindFramebuffer.set(null),(l[0]/16777216+l[1]/65536+l[2]/256+l[3])/256}getTerrainMesh(t){var l;const p=((l=this.painter.style.projection)===null||l===void 0?void 0:l.transitionState)>0,v=p&&t.canonical.y===0,x=p&&t.canonical.y===(1<<t.canonical.z)-1,A=`m_${v?"n":""}_${x?"s":""}`;if(this._meshCache[A])return this._meshCache[A];const R=this.painter.context,O=new c.cv,j=new c.aN,U=this.meshSize,$=c.$/U,G=U*U;for(let _e=0;_e<=U;_e++)for(let Le=0;Le<=U;Le++)O.emplaceBack(Le*$,_e*$,0);for(let _e=0;_e<G;_e+=U+1)for(let Le=0;Le<U;Le++)j.emplaceBack(Le+_e,U+Le+_e+1,U+Le+_e+2),j.emplaceBack(Le+_e,U+Le+_e+2,Le+_e+1);const q=O.length,re=q+(U+1),he=(U+1)*U,de=v?c.bh:0,fe=v?0:1,me=x?c.bi:c.$,ye=x?0:1;for(let _e=0;_e<=U;_e++)O.emplaceBack(_e*$,de,fe);for(let _e=0;_e<=U;_e++)O.emplaceBack(_e*$,me,ye);for(let _e=0;_e<U;_e++)j.emplaceBack(he+_e,re+_e,re+_e+1),j.emplaceBack(he+_e,re+_e+1,he+_e+1),j.emplaceBack(0+_e,q+_e+1,q+_e),j.emplaceBack(0+_e,0+_e+1,q+_e+1);const ge=O.length,Se=ge+2*(U+1);for(const _e of[0,1])for(let Le=0;Le<=U;Le++)for(const qe of[0,1])O.emplaceBack(_e*c.$,Le*$,qe);for(let _e=0;_e<2*U;_e+=2)j.emplaceBack(ge+_e,ge+_e+1,ge+_e+3),j.emplaceBack(ge+_e,ge+_e+3,ge+_e+2),j.emplaceBack(Se+_e,Se+_e+3,Se+_e+1),j.emplaceBack(Se+_e,Se+_e+2,Se+_e+3);const Re=new Ll(R.createVertexBuffer(O,Ou.members),R.createIndexBuffer(j),c.aM.simpleSegment(0,0,O.length,j.length));return this._meshCache[A]=Re,Re}getMeshFrameDelta(t){return 2*Math.PI*c.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,l){var p;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(t,l);return(p=this.getMinMaxElevation(v).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(t){const l=this.getTerrainData(t).tile,p={minElevation:null,maxElevation:null};return l&&l.dem&&(p.minElevation=l.dem.min*this.exaggeration,p.maxElevation=l.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(t,l){const p=c.a1.fromLngLat(t.wrap()),v=(1<<l)*c.$,x=p.x*v,A=p.y*v,R=Math.floor(x/c.$),O=Math.floor(A/c.$);return{tileID:new c.Z(l,0,l,R,O),mercatorX:x,mercatorY:A}}}class qr{constructor(t,l,p){this._context=t,this._size=l,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(p.texture),{id:t,fbo:l,texture:p,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>t.id!==l),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const hl={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Pm{constructor(t,l){this.painter=t,this.terrain=l,this.pool=new qr(t.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(p=>!t._layers[p].isHidden(l)),this._coordsAscending={};for(const p in t.sourceCaches){this._coordsAscending[p]={};const v=t.sourceCaches[p].getVisibleCoordinates(),x=t.sourceCaches[p].getSource(),A=x instanceof Ar?x.terrainTileRanges:null;for(const R of v){const O=this.terrain.sourceCache.getTerrainCoords(R,A);for(const j in O)this._coordsAscending[p][j]||(this._coordsAscending[p][j]=[]),this._coordsAscending[p][j].push(O[j])}}this._coordsAscendingStr={};for(const p of t._order){const v=t._layers[p],x=v.source;if(hl[v.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const A in this._coordsAscending[x])this._coordsAscendingStr[x][A]=this._coordsAscending[x][A].map(R=>R.key).sort().join()}}for(const p of this._renderableTiles)for(const v in this._coordsAscendingStr){const x=this._coordsAscendingStr[v][p.tileID.key];x&&x!==p.rttCoords[v]&&(p.rtt=[])}}renderLayer(t,l){if(t.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},l),{isRenderingToTexture:!0}),v=t.type,x=this.painter,A=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(hl[v]&&(this._prevType&&hl[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(t.id),!A))return!0;if(hl[this._prevType]||hl[v]&&A){this._prevType=v;const R=this._stacks.length-1,O=this._stacks[R]||[];for(const j of this._renderableTiles){if(this.pool.isFull()&&(Is(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[R]){const $=this.pool.getObjectForId(j.rtt[R].id);if($.stamp===j.rtt[R].stamp){this.pool.useObject($);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),j.rtt[R]={id:U.id,stamp:U.stamp},x.context.bindFramebuffer.set(U.fbo.framebuffer),x.context.clear({color:c.bf.transparent,stencil:0}),x.currentStencilSource=void 0;for(let $=0;$<O.length;$++){const G=x.style._layers[O[$]],q=G.source?this._coordsAscending[G.source][j.tileID.key]:[j.tileID];x.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),x._renderTileClippingMasks(G,q,!0),x.renderLayer(x,x.style.sourceCaches[G.source],G,q,p),G.source&&(j.rttCoords[G.source]=this._coordsAscendingStr[G.source][j.tileID.key])}}return Is(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),hl[v]}return!1}}const nc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ja=E,Li={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Lt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ei={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ui{constructor(t,l,p=!1){this.mousedown=x=>{this.startMove(x,B.mousePos(this.element,x)),B.addEventListener(window,"mousemove",this.mousemove),B.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,B.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHandler.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=B.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),B.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=B.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=l;const v=new jh;this._rotatePitchHandler=new Iu({clickTolerance:3,move:(x,A)=>{const R=l.getBoundingClientRect(),O=new c.P((R.bottom-R.top)/2,(R.right-R.left)/2);return{bearingDelta:c.cn(new c.P(x.x,A.y),A,O),pitchDelta:p?-.5*(A.y-x.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=t,B.addEventListener(l,"mousedown",this.mousedown),B.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),B.addEventListener(l,"touchcancel",this.reset)}startMove(t,l){this._rotatePitchHandler.dragStart(t,l),B.disableDrag()}move(t,l){const p=this.map,{bearingDelta:v,pitchDelta:x}=this._rotatePitchHandler.dragMove(t,l)||{};v&&p.setBearing(p.getBearing()+v),x&&p.setPitch(p.getPitch()+x)}off(){const t=this.element;B.removeEventListener(t,"mousedown",this.mousedown),B.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),B.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.removeEventListener(window,"touchend",this.touchend),B.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){B.enableDrag(),B.removeEventListener(window,"mousemove",this.mousemove),B.removeEventListener(window,"mouseup",this.mouseup),B.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.removeEventListener(window,"touchend",this.touchend)}}let sn;function Jn(b,t,l,p=!1){if(p||!l.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const v=new c.S(b.lng,b.lat);if(b=new c.S(b.lng,b.lat),t){const x=new c.S(b.lng-360,b.lat),A=new c.S(b.lng+360,b.lat),R=l.locationToScreenPoint(b).distSqr(t);l.locationToScreenPoint(x).distSqr(t)<R?b=x:l.locationToScreenPoint(A).distSqr(t)<R&&(b=A)}for(;Math.abs(b.lng-l.center.lng)>180;){const x=l.locationToScreenPoint(b);if(x.x>=0&&x.y>=0&&x.x<=l.width&&x.y<=l.height)break;b.lng>l.center.lng?b.lng-=360:b.lng+=360}return b.lng!==v.lng&&l.isPointOnMapSurface(l.locationToScreenPoint(b))?b:v}const Ui={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Hc(b,t,l){const p=b.classList;for(const v in Ui)p.remove(`maplibregl-${l}-anchor-${v}`);p.add(`maplibregl-${l}-anchor-${t}`)}class Os extends c.E{constructor(t){if(super(),this._onKeyPress=l=>{const p=l.code,v=l.charCode||l.keyCode;p!=="Space"&&p!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=l=>{const p=l.originalEvent.target,v=this._element;this._popup&&(p===v||v.contains(p))&&this.togglePopup()},this._update=l=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();(l?.type==="terrain"||l?.type==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=Jn(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||l&&l.type!=="moveend"||(this._pos=this._pos.round()),B.setTransform(this._element,`${Ui[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${v}`),F.frameAsync(new AbortController).then(()=>{this._updateOpacity(l&&l.type==="moveend")}).catch(()=>{})},this._onMove=l=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=B.create("div");const l=B.createNS("http://www.w3.org/2000/svg","svg"),p=41,v=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${p}px`),l.setAttributeNS(null,"width",`${v}px`),l.setAttributeNS(null,"viewBox",`0 0 ${v} ${p}`);const x=B.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const A=B.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");const R=B.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of O){const me=B.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",fe.rx),me.setAttributeNS(null,"ry",fe.ry),R.appendChild(me)}const j=B.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);const U=B.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(U);const $=B.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const G=B.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(G);const q=B.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const re=B.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const he=B.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");const de=B.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#FFFFFF"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962"),re.appendChild(he),re.appendChild(de),A.appendChild(R),A.appendChild(j),A.appendChild($),A.appendChild(q),A.appendChild(re),l.appendChild(A),l.setAttributeNS(null,"height",p*this._scale+"px"),l.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(l),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),Hc(this._element,this._anchor,"marker"),t&&t.className)for(const l of t.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),B.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const v=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var l,p;const v=(l=this._map)===null||l===void 0?void 0:l.terrain,x=this._map.transform.isLocationOccluded(this._lngLat);if(!v||x){const q=x?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==q&&(this._element.style.opacity=q))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const A=this._map,R=A.terrain.depthAtPoint(this._pos),O=A.terrain.getElevationForLngLatZoom(this._lngLat,A.transform.tileZoom);if(A.transform.lngLatToCameraDepth(this._lngLat,O)-R<.006)return void(this._element.style.opacity=this._opacity);const j=-this._offset.y/A.transform.pixelsPerMeter,U=Math.sin(A.getPitch()*Math.PI/180)*j,$=A.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),G=A.transform.lngLatToCameraDepth(this._lngLat,O+U)-$>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&G&&this._popup.remove(),this._element.style.opacity=G?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,l){return(this._opacity===void 0||t===void 0&&l===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),l!==void 0&&(this._opacityWhenCovered=l),this._map&&this._updateOpacity(!0),this}}const dl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $o=0,Zo=!1;const ic={maxWidth:100,unit:"metric"};function nf(b,t,l){const p=l&&l.maxWidth||100,v=b._container.clientHeight/2,x=b._container.clientWidth/2,A=b.unproject([x-p/2,v]),R=b.unproject([x+p/2,v]),O=Math.round(b.project(R).x-b.project(A).x),j=Math.min(p,O,b._container.clientWidth),U=A.distanceTo(R);if(l&&l.unit==="imperial"){const $=3.2808*U;$>5280?_i(t,j,$/5280,b._getUIString("ScaleControl.Miles")):_i(t,j,$,b._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?_i(t,j,U/1852,b._getUIString("ScaleControl.NauticalMiles")):U>=1e3?_i(t,j,U/1e3,b._getUIString("ScaleControl.Kilometers")):_i(t,j,U,b._getUIString("ScaleControl.Meters"))}function _i(b,t,l,p){const v=function(x){const A=Math.pow(10,`${Math.floor(x)}`.length-1);let R=x/A;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(O){const j=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*j)/j}(R),A*R}(l);b.style.width=t*(v/l)+"px",b.innerHTML=`${v}&nbsp;${p}`}const $h={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Zh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Yh(b){if(b){if(typeof b=="number"){const t=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-b),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const t=c.P.convert(b);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return Yh(new c.P(0,0))}const rf=E;y.AJAXError=c.cz,y.Event=c.l,y.Evented=c.E,y.LngLat=c.S,y.MercatorCoordinate=c.a1,y.Point=c.P,y.addProtocol=c.cA,y.config=c.a,y.removeProtocol=c.cB,y.AttributionControl=qt,y.BoxZoomHandler=ta,y.CanvasSource=Ea,y.CooperativeGesturesHandler=Vh,y.DoubleClickZoomHandler=cl,y.DragPanHandler=ul,y.DragRotateHandler=wo,y.EdgeInsets=Ec,y.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var t;let l=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=l?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)l=l.shadowRoot.fullscreenElement;l===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){B.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=B.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);B.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=po,y.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const l=new c.S(t.coords.longitude,t.coords.latitude),p=t.coords.accuracy,v=this._map.getBearing(),x=c.e({bearing:v},this.options.fitBoundsOptions),A=Wn.fromLngLat(l,p);this._map.fitBounds(A,x,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const l=new c.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Zo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=B.create("button","maplibregl-ctrl-geolocate",this._container),B.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Os({element:this._dotElement}),this._circleElement=B.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Os({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{const p=l?.[0]instanceof ResizeObserverEntry;l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},dl,b)}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(t=!1){if(sn!==void 0&&!t)return sn;if(window.navigator.permissions===void 0)return sn=!!window.navigator.geolocation,sn;try{sn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{sn=!!window.navigator.geolocation}return sn})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),B.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,$o=0,Zo=!1}_isOutOfMapMaxBounds(b){const t=this._map.getMaxBounds(),l=b.coords;return t&&(l.longitude<t.getWest()||l.longitude>t.getEast()||l.latitude<t.getSouth()||l.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;const t=this._map.project(b),l=this._map.unproject([t.x+100,t.y]),p=b.distanceTo(l)/100,v=2*this._accuracy/p;this._circleElement.style.width=`${v.toFixed(2)}px`,this._circleElement.style.height=`${v.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$o--,Zo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$o++,$o>1?(b={maximumAge:6e5,timeout:0},Zo=!0):(b=this.options.positionOptions,Zo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const t=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=B.create("button","maplibregl-ctrl-globe",this._container),B.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){B.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},y.Hash=Ph,y.ImageSource=Ar,y.KeyboardHandler=Jl,y.LngLatBounds=Wn,y.LogoControl=Yc,y.Map=class extends Gh{constructor(b){var t,l;c.cw.mark(c.cx.create);const p=Object.assign(Object.assign(Object.assign({},Li),b),{canvasContextAttributes:Object.assign(Object.assign({},Li.canvasContextAttributes),b.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new Ts,x=new go;if(p.minZoom!==void 0&&v.setMinZoom(p.minZoom),p.maxZoom!==void 0&&v.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&v.setMinPitch(p.minPitch),p.maxPitch!==void 0&&v.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&v.setRenderWorldCopies(p.renderWorldCopies),super(v,x,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new tf,this._controls=[],this._mapId=c.a7(),this._contextLost=R=>{R.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:R}))},this._contextRestored=R=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:R}))},this._onMapScroll=R=>{if(R.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},nc),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ke.addThrottleControl(()=>this.isMoving()),this._requestManager=new be(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let R=!1;const O=Vo(j=>{this._trackResize&&!this._removed&&(this.resize(j),this.redraw())},50);this._resizeObserver=new ResizeObserver(j=>{R?O(j):R=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Go(this,p),this._hash=p.hash&&new Ph(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,c.e({},p.fitBoundsOptions,{duration:0}))));const A=typeof p.style=="string"||((l=(t=p.style)===null||t===void 0?void 0:t.projection)===null||l===void 0?void 0:l.type)!=="globe";this.resize(null,A),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new qt(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new Yc,p.logoPosition),this.on("style.load",()=>{if(A||this._resizeTransform(),this.transform.unmodified){const R=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(R)}}),this.on("data",R=>{this._update(R.dataType==="style"),this.fire(new c.l(`${R.dataType}data`,R))}),this.on("dataloading",R=>{this.fire(new c.l(`${R.dataType}dataloading`,R))}),this.on("dataabort",R=>{this.fire(new c.l("sourcedataabort",R))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,t){return this.style.setGlobalStateProperty(b,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,t){if(t===void 0&&(t=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=b.onAdd(this);this._controls.push(b);const p=this._controlPositions[t];return t.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(b);return t>-1&&this._controls.splice(t,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return Cn(this.transform,b)}calculateCameraOptionsFromTo(b,t,l,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,t,l,p)}resize(b,t=!0){const[l,p]=this._containerDimensions(),v=this._getClampedPixelRatio(l,p);if(this._resizeCanvas(l,p,v),this.painter.resize(l,p,v),this.painter.overLimit()){const A=this.painter.context.gl;this._maxCanvasSize=[A.drawingBufferWidth,A.drawingBufferHeight];const R=this._getClampedPixelRatio(l,p);this._resizeCanvas(l,p,R),this.painter.resize(l,p,R)}this._resizeTransform(t);const x=!this._moving;return x&&(this.stop(),this.fire(new c.l("movestart",b)).fire(new c.l("move",b))),this.fire(new c.l("resize",b)),x&&this.fire(new c.l("moveend",b)),this}_resizeTransform(b=!0){var t;const[l,p]=this._containerDimensions();this.transform.resize(l,p,b),(t=this._requestedCameraState)===null||t===void 0||t.resize(l,p,b)}_getClampedPixelRatio(b,t){const{0:l,1:p}=this._maxCanvasSize,v=this.getPixelRatio(),x=b*v,A=t*v;return Math.min(x>l?l/x:1,A>p?p/A:1)*v}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Wn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,t,l){if(b==="mouseenter"||b==="mouseover"){let p=!1;return{layers:t,listener:l,delegates:{mousemove:x=>{const A=t.filter(O=>this.getLayer(O)),R=A.length!==0?this.queryRenderedFeatures(x.point,{layers:A}):[];R.length?p||(p=!0,l.call(this,new Ra(b,this,x.originalEvent,{features:R}))):p=!1},mouseout:()=>{p=!1}}}}if(b==="mouseleave"||b==="mouseout"){let p=!1;return{layers:t,listener:l,delegates:{mousemove:A=>{const R=t.filter(O=>this.getLayer(O));(R.length!==0?this.queryRenderedFeatures(A.point,{layers:R}):[]).length?p=!0:p&&(p=!1,l.call(this,new Ra(b,this,A.originalEvent)))},mouseout:A=>{p&&(p=!1,l.call(this,new Ra(b,this,A.originalEvent)))}}}}{const p=v=>{const x=t.filter(R=>this.getLayer(R)),A=x.length!==0?this.queryRenderedFeatures(v.point,{layers:x}):[];A.length&&(v.features=A,l.call(this,v),delete v.features)};return{layers:t,listener:l,delegates:{[b]:p}}}}_saveDelegatedListener(b,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(t)}_removeDelegatedListener(b,t,l){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const p=this._delegatedListeners[b];for(let v=0;v<p.length;v++){const x=p[v];if(x.listener===l&&x.layers.length===t.length&&x.layers.every(A=>t.includes(A))){for(const A in x.delegates)this.off(A,x.delegates[A]);return void p.splice(v,1)}}}on(b,t,l){if(l===void 0)return super.on(b,t);const p=typeof t=="string"?[t]:t,v=this._createDelegatedListener(b,p,l);this._saveDelegatedListener(b,v);for(const x in v.delegates)this.on(x,v.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(b,p,l)}}}once(b,t,l){if(l===void 0)return super.once(b,t);const p=typeof t=="string"?[t]:t,v=this._createDelegatedListener(b,p,l);for(const x in v.delegates){const A=v.delegates[x];v.delegates[x]=(...R)=>{this._removeDelegatedListener(b,p,l),A(...R)}}this._saveDelegatedListener(b,v);for(const x in v.delegates)this.once(x,v.delegates[x]);return this}off(b,t,l){return l===void 0?super.off(b,t):(this._removeDelegatedListener(b,typeof t=="string"?[t]:t,l),this)}queryRenderedFeatures(b,t){if(!this.style)return[];let l;const p=b instanceof c.P||Array.isArray(b),v=p?b:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(p?{}:b)||{},v instanceof c.P||typeof v[0]=="number")l=[c.P.convert(v)];else{const x=c.P.convert(v[0]),A=c.P.convert(v[1]);l=[x,new c.P(A.x,x.y),A,new c.P(x.x,A.y),x]}return this.style.queryRenderedFeatures(l,t,this.transform)}querySourceFeatures(b,t){return this.style.querySourceFeatures(b,t)}setStyle(b,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(b,t))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const t=this._locale[b];if(t==null)throw new Error(`Missing UI string '${b}'`);return t}_updateStyle(b,t){var l,p;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,t));const v=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Qf(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,t,v):this.style.loadJSON(b,t,v),this):((p=(l=this.style)===null||l===void 0?void 0:l.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Qf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,t){if(typeof b=="string"){const l=this._requestManager.transformRequest(b,"Style");c.j(l,new AbortController).then(p=>{this._updateDiff(p.data,t)}).catch(p=>{p&&this.fire(new c.k(p))})}else typeof b=="object"&&this._updateDiff(b,t)}_updateDiff(b,t){try{this.style.setState(b,t)&&this._update(!0)}catch(l){c.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(b,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,t){return this._lazyInitEmptyStyle(),this.style.addSource(b,t),this._update(!0)}isSourceLoaded(b){const t=this.style&&this.style.sourceCaches[b];if(t!==void 0)return t.loaded();this.fire(new c.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const t=this.style.sourceCaches[b.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&t.reload();for(const l in this.style._layers){const p=this.style._layers[l];p.type==="hillshade"&&p.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===b.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ka(this.painter,t,b),this.painter.renderToTexture=new Pm(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=l=>{var p;l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=l.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:b})),this}getTerrain(){var b,t;return(t=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const t in b){const l=b[t]._tiles;for(const p in l){const v=l[p];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,t,l){if(l){const p=this.getSource(l);if(!p)throw new Error(`There is no source with ID "${l}", cannot set LOD parameters`);p.calculateTileZoom=Nt(Math.max(1,b),Math.max(1,t))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=Nt(Math.max(1,b),Math.max(1,t));return this._update(!0),this}refreshTiles(b,t){const l=this.style.sourceCaches[b];if(!l)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);t===void 0?l.reload(!0):l.refreshTiles(t.map(p=>new c.a4(p.z,p.x,p.y)))}addImage(b,t,l={}){const{pixelRatio:p=1,sdf:v=!1,stretchX:x,stretchY:A,content:R,textFitWidth:O,textFitHeight:j}=l;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:$,data:G}=t,q=t;return this.style.addImage(b,{data:new c.R({width:U,height:$},new Uint8Array(G)),pixelRatio:p,stretchX:x,stretchY:A,content:R,textFitWidth:O,textFitHeight:j,sdf:v,version:0,userImage:q}),q.onAdd&&q.onAdd(this,b),this}}{const{width:U,height:$,data:G}=F.getImageData(t);this.style.addImage(b,{data:new c.R({width:U,height:$},G),pixelRatio:p,stretchX:x,stretchY:A,content:R,textFitWidth:O,textFitHeight:j,sdf:v,version:0})}}updateImage(b,t){const l=this.style.getImage(b);if(!l)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=t instanceof HTMLImageElement||c.b(t)?F.getImageData(t):t,{width:v,height:x,data:A}=p;if(v===void 0||x===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==l.data.width||x!==l.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(t instanceof HTMLImageElement||c.b(t));return l.data.replace(A,R),this.style.updateImage(b,l),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return ke.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,t){return this._lazyInitEmptyStyle(),this.style.addLayer(b,t),this._update(!0)}moveLayer(b,t){return this.style.moveLayer(b,t),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,t,l){return this.style.setLayerZoomRange(b,t,l),this._update(!0)}setFilter(b,t,l={}){return this.style.setFilter(b,t,l),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,t,l,p={}){return this.style.setPaintProperty(b,t,l,p),this._update(!0)}getPaintProperty(b,t){return this.style.getPaintProperty(b,t)}setLayoutProperty(b,t,l,p={}){return this.style.setLayoutProperty(b,t,l,p),this._update(!0)}getLayoutProperty(b,t){return this.style.getLayoutProperty(b,t)}setGlyphs(b,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,t,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,t,l,p=>{p||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,t,l=>{l||this._update(!0)}),this}setLight(b,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,t){return this.style.setFeatureState(b,t),this._update()}removeFeatureState(b,t){return this.style.removeFeatureState(b,t),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,t=0;return this._container&&(b=this._container.clientWidth||400,t=this._container.clientHeight||300),[b,t]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const t=this._canvasContainer=B.create("div","maplibregl-canvas-container",b);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=B.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),p=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],p);const v=this._controlContainer=B.create("div","maplibregl-control-container",b),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(A=>{x[A]=B.create("div",`maplibregl-ctrl-${A} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,t,l){this._canvas.width=Math.floor(l*b),this._canvas.height=Math.floor(l*t),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{t={requestedAttributes:b},p&&(t.statusMessage=p.statusMessage,t.type=p.type)},{once:!0});let l=null;if(l=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!l){const p="Failed to initialize WebGL";throw t?(t.message=p,new Error(JSON.stringify(t))):new Error(p)}this.painter=new ll(l,this.transform),Q.testSupport(l)}migrateProjection(b,t){super.migrateProjection(b,t),this.painter.transform=b,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var t,l,p,v,x;const A=this._idleTriggered?this._fadeDuration:0,R=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let O=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,G=F.now();this.style.zoomHistory.update($,G);const q=new c.F($,{now:G,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),re=q.crossFadingFactor();re===1&&re===this._crossFadingFactor||(O=!0,this._crossFadingFactor=re),this.style.update(q)}const j=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0!==R;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||O)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ke.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),B.remove(this._canvasContainer),B.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,F.frame(this._frameRequest,b=>{c.cw.frame(b),this._frameRequest=null;try{this._render(b)}catch(t){if(!c.cy(t)&&!function(l){return l.message===Rh}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Ja}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},y.MapMouseEvent=Ra,y.MapTouchEvent=Ti,y.MapWheelEvent=Nh,y.Marker=Os,y.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const t=this._map.getZoom(),l=t===this._map.getMaxZoom(),p=t===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,l)=>{const p=this._map._getUIString(`NavigationControl.${l}`);t.title=p,t.setAttribute("aria-label",p)},this.options=c.e({},Ei,b),this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),B.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),B.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=B.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ui(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){B.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,t){const l=B.create("button",b,this._container);return l.type="button",l.addEventListener("click",t),l}},y.Popup=class extends c.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&B.remove(this._content),this._container&&(B.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=B.create("div","maplibregl-popup",this._map.getContainer()),this._tip=B.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const A of this.options.className.split(" "))this._container.classList.add(A);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Jn(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const l=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const v=Yh(this.options.offset);if(!p){const A=this._container.offsetWidth,R=this._container.offsetHeight;let O;O=l.y+v.bottom.y<R?["top"]:l.y>this._map.transform.height-R?["bottom"]:[],l.x<A/2?O.push("left"):l.x>this._map.transform.width-A/2&&O.push("right"),p=O.length===0?"bottom":O.join("-")}let x=l.add(v[p]);this.options.subpixelPositioning||(x=x.round()),B.setTransform(this._container,`${Ui[p]} translate(${x.x}px,${x.y}px)`),Hc(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create($h),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const t=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=b;p=l.firstChild,p;)t.appendChild(p);return this.setDOMContent(t)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=B.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=B.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Zh);b&&b.focus()}},y.RasterDEMTileSource=oa,y.RasterTileSource=gr,y.ScaleControl=class{constructor(b){this._onMove=()=>{nf(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,nf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ic),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){B.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=_p,y.Style=Qf,y.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=B.create("button","maplibregl-ctrl-terrain",this._container),B.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){B.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Ru,y.TwoFingersTouchRotateHandler=Fh,y.TwoFingersTouchZoomHandler=Rs,y.TwoFingersTouchZoomRotateHandler=tc,y.VectorTileSource=Sn,y.VideoSource=Br,y.addSourceType=(b,t)=>c._(void 0,void 0,void 0,function*(){if(ga(b))throw new Error(`A source type called "${b}" already exists.`);((l,p)=>{Ua[l]=p})(b,t)}),y.clearPrewarmedResources=function(){const b=dt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Ut),dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.createTileMesh=_h,y.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return Mr().getRTLTextPluginStatus()},y.getVersion=function(){return rf},y.getWorkerCount=function(){return De.workerCount},y.getWorkerUrl=function(){return c.a.WORKER_URL},y.importScriptInWorkers=function(b){return Kt().broadcast("IS",b)},y.prewarm=function(){Ot().acquire(Ut)},y.setMaxParallelImageRequests=function(b){c.a.MAX_PARALLEL_IMAGE_REQUESTS=b},y.setRTLTextPlugin=function(b,t){return Mr().setRTLTextPlugin(b,t)},y.setWorkerCount=function(b){De.workerCount=b},y.setWorkerUrl=function(b){c.a.WORKER_URL=b}});var m=r;return m})}(Dv)),Dv.exports}var jS=TD();const FS=fm(jS),BS=kS({__proto__:null,default:FS},[jS]),SD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",ED="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class Cg extends Error{response;request;constructor(e,r){const h=`${Cg.extractMessage(e)}: ${JSON.stringify({response:e,request:r})}`;super(h),Object.setPrototypeOf(this,Cg.prototype),this.response=e,this.request=r,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Cg)}static extractMessage(e){return e.errors?.[0]?.message??`GraphQL Error (Code: ${String(e.status)})`}}const g2=n=>n.toUpperCase(),fx=n=>typeof n=="function"?n():n,US=(n,e)=>n.map((r,h)=>[r,e[h]]),gg=n=>{let e={};return n instanceof Headers?e=AD(n):Array.isArray(n)?n.forEach(([r,h])=>{r&&h!==void 0&&(e[r]=h)}):n&&(e=n),e},AD=n=>{const e={};return n.forEach((r,h)=>{e[h]=r}),e},MD=n=>{try{const e=n();return CD(e)?e.catch(r=>y2(r)):e}catch(e){return y2(e)}},y2=n=>n instanceof Error?n:new Error(String(n)),CD=n=>typeof n=="object"&&n!==null&&"then"in n&&typeof n.then=="function"&&"catch"in n&&typeof n.catch=="function"&&"finally"in n&&typeof n.finally=="function",N1=n=>{throw new Error(`Unhandled case: ${String(n)}`)},Iv=n=>typeof n=="object"&&n!==null&&!Array.isArray(n),DD=(n,e)=>n.documents?n:{documents:n,requestHeaders:e,signal:void 0},ID=(n,e,r)=>n.query?n:{query:n,variables:e,requestHeaders:r,signal:void 0};function ki(n,e){if(!!!n)throw new Error(e)}function Md(n){return typeof n=="object"&&n!==null}function fb(n,e){if(!!!n)throw new Error(e??"Unexpected invariant triggered.")}const RD=/\r\n|[\n\r]/g;function Yx(n,e){let r=0,h=1;for(const d of n.body.matchAll(RD)){if(typeof d.index=="number"||fb(!1),d.index>=e)break;r=d.index+d[0].length,h+=1}return{line:h,column:e+1-r}}function kD(n){return VS(n.source,Yx(n.source,n.start))}function VS(n,e){const r=n.locationOffset.column-1,h="".padStart(r)+n.body,d=e.line-1,m=n.locationOffset.line-1,y=e.line+m,c=e.line===1?r:0,E=e.column+c,C=`${n.name}:${y}:${E}
`,k=h.split(/\r\n|[\n\r]/g),z=k[d];if(z.length>120){const F=Math.floor(E/80),B=E%80,Q=[];for(let ie=0;ie<z.length;ie+=80)Q.push(z.slice(ie,ie+80));return C+_2([[`${y} |`,Q[0]],...Q.slice(1,F+1).map(ie=>["|",ie]),["|","^".padStart(B)],["|",Q[F+1]]])}return C+_2([[`${y-1} |`,k[d-1]],[`${y} |`,z],["|","^".padStart(E)],[`${y+1} |`,k[d+1]]])}function _2(n){const e=n.filter(([h,d])=>d!==void 0),r=Math.max(...e.map(([h])=>h.length));return e.map(([h,d])=>h.padStart(r)+(d?" "+d:"")).join(`
`)}function OD(n){const e=n[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:n[1],positions:n[2],path:n[3],originalError:n[4],extensions:n[5]}:e}class Fi extends Error{constructor(e,...r){var h,d,m;const{nodes:y,source:c,positions:E,path:C,originalError:k,extensions:z}=OD(r);super(e),this.name="GraphQLError",this.path=C??void 0,this.originalError=k??void 0,this.nodes=v2(Array.isArray(y)?y:y?[y]:void 0);const F=v2((h=this.nodes)===null||h===void 0?void 0:h.map(Q=>Q.loc).filter(Q=>Q!=null));this.source=c??(F==null||(d=F[0])===null||d===void 0?void 0:d.source),this.positions=E??F?.map(Q=>Q.start),this.locations=E&&c?E.map(Q=>Yx(c,Q)):F?.map(Q=>Yx(Q.source,Q.start));const B=Md(k?.extensions)?k?.extensions:void 0;this.extensions=(m=z??B)!==null&&m!==void 0?m:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),k!=null&&k.stack?Object.defineProperty(this,"stack",{value:k.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Fi):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(e+=`

`+kD(r.loc));else if(this.source&&this.locations)for(const r of this.locations)e+=`

`+VS(this.source,r);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function v2(n){return n===void 0||n.length===0?void 0:n}function Fa(n,e,r){return new Fi(`Syntax Error: ${r}`,{source:n,positions:[e]})}class PD{constructor(e,r,h){this.start=e.start,this.end=r.end,this.startToken=e,this.endToken=r,this.source=h}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class GS{constructor(e,r,h,d,m,y){this.kind=e,this.start=r,this.end=h,this.line=d,this.column=m,this.value=y,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const $S={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},LD=new Set(Object.keys($S));function b2(n){const e=n?.kind;return typeof e=="string"&&LD.has(e)}var pd;(function(n){n.QUERY="query",n.MUTATION="mutation",n.SUBSCRIPTION="subscription"})(pd||(pd={}));var di;(function(n){n.QUERY="QUERY",n.MUTATION="MUTATION",n.SUBSCRIPTION="SUBSCRIPTION",n.FIELD="FIELD",n.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",n.FRAGMENT_SPREAD="FRAGMENT_SPREAD",n.INLINE_FRAGMENT="INLINE_FRAGMENT",n.VARIABLE_DEFINITION="VARIABLE_DEFINITION",n.SCHEMA="SCHEMA",n.SCALAR="SCALAR",n.OBJECT="OBJECT",n.FIELD_DEFINITION="FIELD_DEFINITION",n.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",n.INTERFACE="INTERFACE",n.UNION="UNION",n.ENUM="ENUM",n.ENUM_VALUE="ENUM_VALUE",n.INPUT_OBJECT="INPUT_OBJECT",n.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(di||(di={}));var kt;(function(n){n.NAME="Name",n.DOCUMENT="Document",n.OPERATION_DEFINITION="OperationDefinition",n.VARIABLE_DEFINITION="VariableDefinition",n.SELECTION_SET="SelectionSet",n.FIELD="Field",n.ARGUMENT="Argument",n.FRAGMENT_SPREAD="FragmentSpread",n.INLINE_FRAGMENT="InlineFragment",n.FRAGMENT_DEFINITION="FragmentDefinition",n.VARIABLE="Variable",n.INT="IntValue",n.FLOAT="FloatValue",n.STRING="StringValue",n.BOOLEAN="BooleanValue",n.NULL="NullValue",n.ENUM="EnumValue",n.LIST="ListValue",n.OBJECT="ObjectValue",n.OBJECT_FIELD="ObjectField",n.DIRECTIVE="Directive",n.NAMED_TYPE="NamedType",n.LIST_TYPE="ListType",n.NON_NULL_TYPE="NonNullType",n.SCHEMA_DEFINITION="SchemaDefinition",n.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",n.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",n.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",n.FIELD_DEFINITION="FieldDefinition",n.INPUT_VALUE_DEFINITION="InputValueDefinition",n.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",n.UNION_TYPE_DEFINITION="UnionTypeDefinition",n.ENUM_TYPE_DEFINITION="EnumTypeDefinition",n.ENUM_VALUE_DEFINITION="EnumValueDefinition",n.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",n.DIRECTIVE_DEFINITION="DirectiveDefinition",n.SCHEMA_EXTENSION="SchemaExtension",n.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",n.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",n.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",n.UNION_TYPE_EXTENSION="UnionTypeExtension",n.ENUM_TYPE_EXTENSION="EnumTypeExtension",n.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(kt||(kt={}));function Hx(n){return n===9||n===32}function U_(n){return n>=48&&n<=57}function ZS(n){return n>=97&&n<=122||n>=65&&n<=90}function j1(n){return ZS(n)||n===95}function YS(n){return ZS(n)||U_(n)||n===95}function zD(n){var e;let r=Number.MAX_SAFE_INTEGER,h=null,d=-1;for(let y=0;y<n.length;++y){var m;const c=n[y],E=ND(c);E!==c.length&&(h=(m=h)!==null&&m!==void 0?m:y,d=y,y!==0&&E<r&&(r=E))}return n.map((y,c)=>c===0?y:y.slice(r)).slice((e=h)!==null&&e!==void 0?e:0,d+1)}function ND(n){let e=0;for(;e<n.length&&Hx(n.charCodeAt(e));)++e;return e}function jD(n,e){const r=n.replace(/"""/g,'\\"""'),h=r.split(/\r\n|[\n\r]/g),d=h.length===1,m=h.length>1&&h.slice(1).every(B=>B.length===0||Hx(B.charCodeAt(0))),y=r.endsWith('\\"""'),c=n.endsWith('"')&&!y,E=n.endsWith("\\"),C=c||E,k=!d||n.length>70||C||m||y;let z="";const F=d&&Hx(n.charCodeAt(0));return(k&&!F||m)&&(z+=`
`),z+=r,(k||C)&&(z+=`
`),'"""'+z+'"""'}var gt;(function(n){n.SOF="<SOF>",n.EOF="<EOF>",n.BANG="!",n.DOLLAR="$",n.AMP="&",n.PAREN_L="(",n.PAREN_R=")",n.SPREAD="...",n.COLON=":",n.EQUALS="=",n.AT="@",n.BRACKET_L="[",n.BRACKET_R="]",n.BRACE_L="{",n.PIPE="|",n.BRACE_R="}",n.NAME="Name",n.INT="Int",n.FLOAT="Float",n.STRING="String",n.BLOCK_STRING="BlockString",n.COMMENT="Comment"})(gt||(gt={}));class FD{constructor(e){const r=new GS(gt.SOF,0,0,0,0);this.source=e,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==gt.EOF)do if(e.next)e=e.next;else{const r=UD(this,e.end);e.next=r,r.prev=e,e=r}while(e.kind===gt.COMMENT);return e}}function BD(n){return n===gt.BANG||n===gt.DOLLAR||n===gt.AMP||n===gt.PAREN_L||n===gt.PAREN_R||n===gt.SPREAD||n===gt.COLON||n===gt.EQUALS||n===gt.AT||n===gt.BRACKET_L||n===gt.BRACKET_R||n===gt.BRACE_L||n===gt.PIPE||n===gt.BRACE_R}function Wg(n){return n>=0&&n<=55295||n>=57344&&n<=1114111}function pb(n,e){return HS(n.charCodeAt(e))&&qS(n.charCodeAt(e+1))}function HS(n){return n>=55296&&n<=56319}function qS(n){return n>=56320&&n<=57343}function nm(n,e){const r=n.source.body.codePointAt(e);if(r===void 0)return gt.EOF;if(r>=32&&r<=126){const h=String.fromCodePoint(r);return h==='"'?`'"'`:`"${h}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function pa(n,e,r,h,d){const m=n.line,y=1+r-n.lineStart;return new GS(e,r,h,m,y,d)}function UD(n,e){const r=n.source.body,h=r.length;let d=e;for(;d<h;){const m=r.charCodeAt(d);switch(m){case 65279:case 9:case 32:case 44:++d;continue;case 10:++d,++n.line,n.lineStart=d;continue;case 13:r.charCodeAt(d+1)===10?d+=2:++d,++n.line,n.lineStart=d;continue;case 35:return VD(n,d);case 33:return pa(n,gt.BANG,d,d+1);case 36:return pa(n,gt.DOLLAR,d,d+1);case 38:return pa(n,gt.AMP,d,d+1);case 40:return pa(n,gt.PAREN_L,d,d+1);case 41:return pa(n,gt.PAREN_R,d,d+1);case 46:if(r.charCodeAt(d+1)===46&&r.charCodeAt(d+2)===46)return pa(n,gt.SPREAD,d,d+3);break;case 58:return pa(n,gt.COLON,d,d+1);case 61:return pa(n,gt.EQUALS,d,d+1);case 64:return pa(n,gt.AT,d,d+1);case 91:return pa(n,gt.BRACKET_L,d,d+1);case 93:return pa(n,gt.BRACKET_R,d,d+1);case 123:return pa(n,gt.BRACE_L,d,d+1);case 124:return pa(n,gt.PIPE,d,d+1);case 125:return pa(n,gt.BRACE_R,d,d+1);case 34:return r.charCodeAt(d+1)===34&&r.charCodeAt(d+2)===34?qD(n,d):$D(n,d)}if(U_(m)||m===45)return GD(n,d,m);if(j1(m))return XD(n,d);throw Fa(n.source,d,m===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Wg(m)||pb(r,d)?`Unexpected character: ${nm(n,d)}.`:`Invalid character: ${nm(n,d)}.`)}return pa(n,gt.EOF,h,h)}function VD(n,e){const r=n.source.body,h=r.length;let d=e+1;for(;d<h;){const m=r.charCodeAt(d);if(m===10||m===13)break;if(Wg(m))++d;else if(pb(r,d))d+=2;else break}return pa(n,gt.COMMENT,e,d,r.slice(e+1,d))}function GD(n,e,r){const h=n.source.body;let d=e,m=r,y=!1;if(m===45&&(m=h.charCodeAt(++d)),m===48){if(m=h.charCodeAt(++d),U_(m))throw Fa(n.source,d,`Invalid number, unexpected digit after 0: ${nm(n,d)}.`)}else d=px(n,d,m),m=h.charCodeAt(d);if(m===46&&(y=!0,m=h.charCodeAt(++d),d=px(n,d,m),m=h.charCodeAt(d)),(m===69||m===101)&&(y=!0,m=h.charCodeAt(++d),(m===43||m===45)&&(m=h.charCodeAt(++d)),d=px(n,d,m),m=h.charCodeAt(d)),m===46||j1(m))throw Fa(n.source,d,`Invalid number, expected digit but got: ${nm(n,d)}.`);return pa(n,y?gt.FLOAT:gt.INT,e,d,h.slice(e,d))}function px(n,e,r){if(!U_(r))throw Fa(n.source,e,`Invalid number, expected digit but got: ${nm(n,e)}.`);const h=n.source.body;let d=e+1;for(;U_(h.charCodeAt(d));)++d;return d}function $D(n,e){const r=n.source.body,h=r.length;let d=e+1,m=d,y="";for(;d<h;){const c=r.charCodeAt(d);if(c===34)return y+=r.slice(m,d),pa(n,gt.STRING,e,d+1,y);if(c===92){y+=r.slice(m,d);const E=r.charCodeAt(d+1)===117?r.charCodeAt(d+2)===123?ZD(n,d):YD(n,d):HD(n,d);y+=E.value,d+=E.size,m=d;continue}if(c===10||c===13)break;if(Wg(c))++d;else if(pb(r,d))d+=2;else throw Fa(n.source,d,`Invalid character within String: ${nm(n,d)}.`)}throw Fa(n.source,d,"Unterminated string.")}function ZD(n,e){const r=n.source.body;let h=0,d=3;for(;d<12;){const m=r.charCodeAt(e+d++);if(m===125){if(d<5||!Wg(h))break;return{value:String.fromCodePoint(h),size:d}}if(h=h<<4|v_(m),h<0)break}throw Fa(n.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+d)}".`)}function YD(n,e){const r=n.source.body,h=x2(r,e+2);if(Wg(h))return{value:String.fromCodePoint(h),size:6};if(HS(h)&&r.charCodeAt(e+6)===92&&r.charCodeAt(e+7)===117){const d=x2(r,e+8);if(qS(d))return{value:String.fromCodePoint(h,d),size:12}}throw Fa(n.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+6)}".`)}function x2(n,e){return v_(n.charCodeAt(e))<<12|v_(n.charCodeAt(e+1))<<8|v_(n.charCodeAt(e+2))<<4|v_(n.charCodeAt(e+3))}function v_(n){return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:-1}function HD(n,e){const r=n.source.body;switch(r.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Fa(n.source,e,`Invalid character escape sequence: "${r.slice(e,e+2)}".`)}function qD(n,e){const r=n.source.body,h=r.length;let d=n.lineStart,m=e+3,y=m,c="";const E=[];for(;m<h;){const C=r.charCodeAt(m);if(C===34&&r.charCodeAt(m+1)===34&&r.charCodeAt(m+2)===34){c+=r.slice(y,m),E.push(c);const k=pa(n,gt.BLOCK_STRING,e,m+3,zD(E).join(`
`));return n.line+=E.length-1,n.lineStart=d,k}if(C===92&&r.charCodeAt(m+1)===34&&r.charCodeAt(m+2)===34&&r.charCodeAt(m+3)===34){c+=r.slice(y,m),y=m+1,m+=4;continue}if(C===10||C===13){c+=r.slice(y,m),E.push(c),C===13&&r.charCodeAt(m+1)===10?m+=2:++m,c="",y=m,d=m;continue}if(Wg(C))++m;else if(pb(r,m))m+=2;else throw Fa(n.source,m,`Invalid character within String: ${nm(n,m)}.`)}throw Fa(n.source,m,"Unterminated string.")}function XD(n,e){const r=n.source.body,h=r.length;let d=e+1;for(;d<h;){const m=r.charCodeAt(d);if(YS(m))++d;else break}return pa(n,gt.NAME,e,d,r.slice(e,d))}const WD=10,XS=2;function En(n){return mb(n,[])}function mb(n,e){switch(typeof n){case"string":return JSON.stringify(n);case"function":return n.name?`[function ${n.name}]`:"[function]";case"object":return QD(n,e);default:return String(n)}}function QD(n,e){if(n===null)return"null";if(e.includes(n))return"[Circular]";const r=[...e,n];if(KD(n)){const h=n.toJSON();if(h!==n)return typeof h=="string"?h:mb(h,r)}else if(Array.isArray(n))return eI(n,r);return JD(n,r)}function KD(n){return typeof n.toJSON=="function"}function JD(n,e){const r=Object.entries(n);return r.length===0?"{}":e.length>XS?"["+tI(n)+"]":"{ "+r.map(([d,m])=>d+": "+mb(m,e)).join(", ")+" }"}function eI(n,e){if(n.length===0)return"[]";if(e.length>XS)return"[Array]";const r=Math.min(WD,n.length),h=n.length-r,d=[];for(let m=0;m<r;++m)d.push(mb(n[m],e));return h===1?d.push("... 1 more item"):h>1&&d.push(`... ${h} more items`),"["+d.join(", ")+"]"}function tI(n){const e=Object.prototype.toString.call(n).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof n.constructor=="function"){const r=n.constructor.name;if(typeof r=="string"&&r!=="")return r}return e}const nI=globalThis.process&&!0,fh=nI?function(e,r){return e instanceof r}:function(e,r){if(e instanceof r)return!0;if(typeof e=="object"&&e!==null){var h;const d=r.prototype[Symbol.toStringTag],m=Symbol.toStringTag in e?e[Symbol.toStringTag]:(h=e.constructor)===null||h===void 0?void 0:h.name;if(d===m){const y=En(e);throw new Error(`Cannot use ${d} "${y}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class WS{constructor(e,r="GraphQL request",h={line:1,column:1}){typeof e=="string"||ki(!1,`Body must be a string. Received: ${En(e)}.`),this.body=e,this.name=r,this.locationOffset=h,this.locationOffset.line>0||ki(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||ki(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function iI(n){return fh(n,WS)}function QS(n,e){const r=new KS(n,e),h=r.parseDocument();return Object.defineProperty(h,"tokenCount",{enumerable:!1,value:r.tokenCount}),h}function rI(n,e){const r=new KS(n,e);r.expectToken(gt.SOF);const h=r.parseValueLiteral(!1);return r.expectToken(gt.EOF),h}class KS{constructor(e,r={}){const h=iI(e)?e:new WS(e);this._lexer=new FD(h),this._options=r,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const e=this.expectToken(gt.NAME);return this.node(e,{kind:kt.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:kt.DOCUMENT,definitions:this.many(gt.SOF,this.parseDefinition,gt.EOF)})}parseDefinition(){if(this.peek(gt.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),r=e?this._lexer.lookahead():this._lexer.token;if(r.kind===gt.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw Fa(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(gt.BRACE_L))return this.node(e,{kind:kt.OPERATION_DEFINITION,operation:pd.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let h;return this.peek(gt.NAME)&&(h=this.parseName()),this.node(e,{kind:kt.OPERATION_DEFINITION,operation:r,name:h,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(gt.NAME);switch(e.value){case"query":return pd.QUERY;case"mutation":return pd.MUTATION;case"subscription":return pd.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(gt.PAREN_L,this.parseVariableDefinition,gt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:kt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(gt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(gt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(gt.DOLLAR),this.node(e,{kind:kt.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:kt.SELECTION_SET,selections:this.many(gt.BRACE_L,this.parseSelection,gt.BRACE_R)})}parseSelection(){return this.peek(gt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,r=this.parseName();let h,d;return this.expectOptionalToken(gt.COLON)?(h=r,d=this.parseName()):d=r,this.node(e,{kind:kt.FIELD,alias:h,name:d,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(gt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const r=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(gt.PAREN_L,r,gt.PAREN_R)}parseArgument(e=!1){const r=this._lexer.token,h=this.parseName();return this.expectToken(gt.COLON),this.node(r,{kind:kt.ARGUMENT,name:h,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(gt.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(gt.NAME)?this.node(e,{kind:kt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:kt.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:kt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:kt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const r=this._lexer.token;switch(r.kind){case gt.BRACKET_L:return this.parseList(e);case gt.BRACE_L:return this.parseObject(e);case gt.INT:return this.advanceLexer(),this.node(r,{kind:kt.INT,value:r.value});case gt.FLOAT:return this.advanceLexer(),this.node(r,{kind:kt.FLOAT,value:r.value});case gt.STRING:case gt.BLOCK_STRING:return this.parseStringLiteral();case gt.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:kt.BOOLEAN,value:!0});case"false":return this.node(r,{kind:kt.BOOLEAN,value:!1});case"null":return this.node(r,{kind:kt.NULL});default:return this.node(r,{kind:kt.ENUM,value:r.value})}case gt.DOLLAR:if(e)if(this.expectToken(gt.DOLLAR),this._lexer.token.kind===gt.NAME){const h=this._lexer.token.value;throw Fa(this._lexer.source,r.start,`Unexpected variable "$${h}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:kt.STRING,value:e.value,block:e.kind===gt.BLOCK_STRING})}parseList(e){const r=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:kt.LIST,values:this.any(gt.BRACKET_L,r,gt.BRACKET_R)})}parseObject(e){const r=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:kt.OBJECT,fields:this.any(gt.BRACE_L,r,gt.BRACE_R)})}parseObjectField(e){const r=this._lexer.token,h=this.parseName();return this.expectToken(gt.COLON),this.node(r,{kind:kt.OBJECT_FIELD,name:h,value:this.parseValueLiteral(e)})}parseDirectives(e){const r=[];for(;this.peek(gt.AT);)r.push(this.parseDirective(e));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const r=this._lexer.token;return this.expectToken(gt.AT),this.node(r,{kind:kt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let r;if(this.expectOptionalToken(gt.BRACKET_L)){const h=this.parseTypeReference();this.expectToken(gt.BRACKET_R),r=this.node(e,{kind:kt.LIST_TYPE,type:h})}else r=this.parseNamedType();return this.expectOptionalToken(gt.BANG)?this.node(e,{kind:kt.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:kt.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(gt.STRING)||this.peek(gt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const h=this.parseConstDirectives(),d=this.many(gt.BRACE_L,this.parseOperationTypeDefinition,gt.BRACE_R);return this.node(e,{kind:kt.SCHEMA_DEFINITION,description:r,directives:h,operationTypes:d})}parseOperationTypeDefinition(){const e=this._lexer.token,r=this.parseOperationType();this.expectToken(gt.COLON);const h=this.parseNamedType();return this.node(e,{kind:kt.OPERATION_TYPE_DEFINITION,operation:r,type:h})}parseScalarTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const h=this.parseName(),d=this.parseConstDirectives();return this.node(e,{kind:kt.SCALAR_TYPE_DEFINITION,description:r,name:h,directives:d})}parseObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const h=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),y=this.parseFieldsDefinition();return this.node(e,{kind:kt.OBJECT_TYPE_DEFINITION,description:r,name:h,interfaces:d,directives:m,fields:y})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(gt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(gt.BRACE_L,this.parseFieldDefinition,gt.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,r=this.parseDescription(),h=this.parseName(),d=this.parseArgumentDefs();this.expectToken(gt.COLON);const m=this.parseTypeReference(),y=this.parseConstDirectives();return this.node(e,{kind:kt.FIELD_DEFINITION,description:r,name:h,arguments:d,type:m,directives:y})}parseArgumentDefs(){return this.optionalMany(gt.PAREN_L,this.parseInputValueDef,gt.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,r=this.parseDescription(),h=this.parseName();this.expectToken(gt.COLON);const d=this.parseTypeReference();let m;this.expectOptionalToken(gt.EQUALS)&&(m=this.parseConstValueLiteral());const y=this.parseConstDirectives();return this.node(e,{kind:kt.INPUT_VALUE_DEFINITION,description:r,name:h,type:d,defaultValue:m,directives:y})}parseInterfaceTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const h=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),y=this.parseFieldsDefinition();return this.node(e,{kind:kt.INTERFACE_TYPE_DEFINITION,description:r,name:h,interfaces:d,directives:m,fields:y})}parseUnionTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const h=this.parseName(),d=this.parseConstDirectives(),m=this.parseUnionMemberTypes();return this.node(e,{kind:kt.UNION_TYPE_DEFINITION,description:r,name:h,directives:d,types:m})}parseUnionMemberTypes(){return this.expectOptionalToken(gt.EQUALS)?this.delimitedMany(gt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const h=this.parseName(),d=this.parseConstDirectives(),m=this.parseEnumValuesDefinition();return this.node(e,{kind:kt.ENUM_TYPE_DEFINITION,description:r,name:h,directives:d,values:m})}parseEnumValuesDefinition(){return this.optionalMany(gt.BRACE_L,this.parseEnumValueDefinition,gt.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,r=this.parseDescription(),h=this.parseEnumValueName(),d=this.parseConstDirectives();return this.node(e,{kind:kt.ENUM_VALUE_DEFINITION,description:r,name:h,directives:d})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Fa(this._lexer.source,this._lexer.token.start,`${pv(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const h=this.parseName(),d=this.parseConstDirectives(),m=this.parseInputFieldsDefinition();return this.node(e,{kind:kt.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:h,directives:d,fields:m})}parseInputFieldsDefinition(){return this.optionalMany(gt.BRACE_L,this.parseInputValueDef,gt.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===gt.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),h=this.optionalMany(gt.BRACE_L,this.parseOperationTypeDefinition,gt.BRACE_R);if(r.length===0&&h.length===0)throw this.unexpected();return this.node(e,{kind:kt.SCHEMA_EXTENSION,directives:r,operationTypes:h})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),h=this.parseConstDirectives();if(h.length===0)throw this.unexpected();return this.node(e,{kind:kt.SCALAR_TYPE_EXTENSION,name:r,directives:h})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),h=this.parseImplementsInterfaces(),d=this.parseConstDirectives(),m=this.parseFieldsDefinition();if(h.length===0&&d.length===0&&m.length===0)throw this.unexpected();return this.node(e,{kind:kt.OBJECT_TYPE_EXTENSION,name:r,interfaces:h,directives:d,fields:m})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),h=this.parseImplementsInterfaces(),d=this.parseConstDirectives(),m=this.parseFieldsDefinition();if(h.length===0&&d.length===0&&m.length===0)throw this.unexpected();return this.node(e,{kind:kt.INTERFACE_TYPE_EXTENSION,name:r,interfaces:h,directives:d,fields:m})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),h=this.parseConstDirectives(),d=this.parseUnionMemberTypes();if(h.length===0&&d.length===0)throw this.unexpected();return this.node(e,{kind:kt.UNION_TYPE_EXTENSION,name:r,directives:h,types:d})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),h=this.parseConstDirectives(),d=this.parseEnumValuesDefinition();if(h.length===0&&d.length===0)throw this.unexpected();return this.node(e,{kind:kt.ENUM_TYPE_EXTENSION,name:r,directives:h,values:d})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),h=this.parseConstDirectives(),d=this.parseInputFieldsDefinition();if(h.length===0&&d.length===0)throw this.unexpected();return this.node(e,{kind:kt.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:h,fields:d})}parseDirectiveDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(gt.AT);const h=this.parseName(),d=this.parseArgumentDefs(),m=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const y=this.parseDirectiveLocations();return this.node(e,{kind:kt.DIRECTIVE_DEFINITION,description:r,name:h,arguments:d,repeatable:m,locations:y})}parseDirectiveLocations(){return this.delimitedMany(gt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(di,r.value))return r;throw this.unexpected(e)}node(e,r){return this._options.noLocation!==!0&&(r.loc=new PD(e,this._lexer.lastToken,this._lexer.source)),r}peek(e){return this._lexer.token.kind===e}expectToken(e){const r=this._lexer.token;if(r.kind===e)return this.advanceLexer(),r;throw Fa(this._lexer.source,r.start,`Expected ${JS(e)}, found ${pv(r)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const r=this._lexer.token;if(r.kind===gt.NAME&&r.value===e)this.advanceLexer();else throw Fa(this._lexer.source,r.start,`Expected "${e}", found ${pv(r)}.`)}expectOptionalKeyword(e){const r=this._lexer.token;return r.kind===gt.NAME&&r.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const r=e??this._lexer.token;return Fa(this._lexer.source,r.start,`Unexpected ${pv(r)}.`)}any(e,r,h){this.expectToken(e);const d=[];for(;!this.expectOptionalToken(h);)d.push(r.call(this));return d}optionalMany(e,r,h){if(this.expectOptionalToken(e)){const d=[];do d.push(r.call(this));while(!this.expectOptionalToken(h));return d}return[]}many(e,r,h){this.expectToken(e);const d=[];do d.push(r.call(this));while(!this.expectOptionalToken(h));return d}delimitedMany(e,r){this.expectOptionalToken(e);const h=[];do h.push(r.call(this));while(this.expectOptionalToken(e));return h}advanceLexer(){const{maxTokens:e}=this._options,r=this._lexer.advance();if(r.kind!==gt.EOF&&(++this._tokenCounter,e!==void 0&&this._tokenCounter>e))throw Fa(this._lexer.source,r.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function pv(n){const e=n.value;return JS(n.kind)+(e!=null?` "${e}"`:"")}function JS(n){return BD(n)?`"${n}"`:n}const aI=5;function oI(n,e){const[r,h]=e?[n,e]:[void 0,n];let d=" Did you mean ";r&&(d+=r+" ");const m=h.map(E=>`"${E}"`);switch(m.length){case 0:return"";case 1:return d+m[0]+"?";case 2:return d+m[0]+" or "+m[1]+"?"}const y=m.slice(0,aI),c=y.pop();return d+y.join(", ")+", or "+c+"?"}function w2(n){return n}function eE(n,e){const r=Object.create(null);for(const h of n)r[e(h)]=h;return r}function Qp(n,e,r){const h=Object.create(null);for(const d of n)h[e(d)]=r(d);return h}function gb(n,e){const r=Object.create(null);for(const h of Object.keys(n))r[h]=e(n[h],h);return r}function sI(n,e){let r=0,h=0;for(;r<n.length&&h<e.length;){let d=n.charCodeAt(r),m=e.charCodeAt(h);if(mv(d)&&mv(m)){let y=0;do++r,y=y*10+d-qx,d=n.charCodeAt(r);while(mv(d)&&y>0);let c=0;do++h,c=c*10+m-qx,m=e.charCodeAt(h);while(mv(m)&&c>0);if(y<c)return-1;if(y>c)return 1}else{if(d<m)return-1;if(d>m)return 1;++r,++h}}return n.length-e.length}const qx=48,lI=57;function mv(n){return!isNaN(n)&&qx<=n&&n<=lI}function cI(n,e){const r=Object.create(null),h=new uI(n),d=Math.floor(n.length*.4)+1;for(const m of e){const y=h.measure(m,d);y!==void 0&&(r[m]=y)}return Object.keys(r).sort((m,y)=>{const c=r[m]-r[y];return c!==0?c:sI(m,y)})}class uI{constructor(e){this._input=e,this._inputLowerCase=e.toLowerCase(),this._inputArray=T2(this._inputLowerCase),this._rows=[new Array(e.length+1).fill(0),new Array(e.length+1).fill(0),new Array(e.length+1).fill(0)]}measure(e,r){if(this._input===e)return 0;const h=e.toLowerCase();if(this._inputLowerCase===h)return 1;let d=T2(h),m=this._inputArray;if(d.length<m.length){const k=d;d=m,m=k}const y=d.length,c=m.length;if(y-c>r)return;const E=this._rows;for(let k=0;k<=c;k++)E[0][k]=k;for(let k=1;k<=y;k++){const z=E[(k-1)%3],F=E[k%3];let B=F[0]=k;for(let Q=1;Q<=c;Q++){const ie=d[k-1]===m[Q-1]?0:1;let ne=Math.min(z[Q]+1,F[Q-1]+1,z[Q-1]+ie);if(k>1&&Q>1&&d[k-1]===m[Q-2]&&d[k-2]===m[Q-1]){const ue=E[(k-2)%3][Q-2];ne=Math.min(ne,ue+1)}ne<B&&(B=ne),F[Q]=ne}if(B>r)return}const C=E[y%3][c];return C<=r?C:void 0}}function T2(n){const e=n.length,r=new Array(e);for(let h=0;h<e;++h)r[h]=n.charCodeAt(h);return r}function Tc(n){if(n==null)return Object.create(null);if(Object.getPrototypeOf(n)===null)return n;const e=Object.create(null);for(const[r,h]of Object.entries(n))e[r]=h;return e}function hI(n){return`"${n.replace(dI,fI)}"`}const dI=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function fI(n){return pI[n.charCodeAt(0)]}const pI=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],mI=Object.freeze({});function F1(n,e,r=$S){const h=new Map;for(const ue of Object.values(kt))h.set(ue,gI(e,ue));let d,m=Array.isArray(n),y=[n],c=-1,E=[],C=n,k,z;const F=[],B=[];do{c++;const ue=c===y.length,Ae=ue&&E.length!==0;if(ue){if(k=B.length===0?void 0:F[F.length-1],C=z,z=B.pop(),Ae)if(m){C=C.slice();let ke=0;for(const[be,Me]of E){const Fe=be-ke;Me===null?(C.splice(Fe,1),ke++):C[Fe]=Me}}else{C={...C};for(const[ke,be]of E)C[ke]=be}c=d.index,y=d.keys,E=d.edits,m=d.inArray,d=d.prev}else if(z){if(k=m?c:y[c],C=z[k],C==null)continue;F.push(k)}let Te;if(!Array.isArray(C)){var Q,ie;b2(C)||ki(!1,`Invalid AST Node: ${En(C)}.`);const ke=ue?(Q=h.get(C.kind))===null||Q===void 0?void 0:Q.leave:(ie=h.get(C.kind))===null||ie===void 0?void 0:ie.enter;if(Te=ke?.call(e,C,k,z,F,B),Te===mI)break;if(Te===!1){if(!ue){F.pop();continue}}else if(Te!==void 0&&(E.push([k,Te]),!ue))if(b2(Te))C=Te;else{F.pop();continue}}if(Te===void 0&&Ae&&E.push([k,C]),ue)F.pop();else{var ne;d={inArray:m,index:c,keys:y,edits:E,prev:d},m=Array.isArray(C),y=m?C:(ne=r[C.kind])!==null&&ne!==void 0?ne:[],c=-1,E=[],z&&B.push(z),z=C}}while(d!==void 0);return E.length!==0?E[E.length-1][1]:n}function gI(n,e){const r=n[e];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:n.enter,leave:n.leave}}function ps(n){return F1(n,_I)}const yI=80,_I={Name:{leave:n=>n.value},Variable:{leave:n=>"$"+n.name},Document:{leave:n=>Wt(n.definitions,`

`)},OperationDefinition:{leave(n){const e=ii("(",Wt(n.variableDefinitions,", "),")"),r=Wt([n.operation,Wt([n.name,e]),Wt(n.directives," ")]," ");return(r==="query"?"":r+" ")+n.selectionSet}},VariableDefinition:{leave:({variable:n,type:e,defaultValue:r,directives:h})=>n+": "+e+ii(" = ",r)+ii(" ",Wt(h," "))},SelectionSet:{leave:({selections:n})=>ou(n)},Field:{leave({alias:n,name:e,arguments:r,directives:h,selectionSet:d}){const m=ii("",n,": ")+e;let y=m+ii("(",Wt(r,", "),")");return y.length>yI&&(y=m+ii(`(
`,Rv(Wt(r,`
`)),`
)`)),Wt([y,Wt(h," "),d]," ")}},Argument:{leave:({name:n,value:e})=>n+": "+e},FragmentSpread:{leave:({name:n,directives:e})=>"..."+n+ii(" ",Wt(e," "))},InlineFragment:{leave:({typeCondition:n,directives:e,selectionSet:r})=>Wt(["...",ii("on ",n),Wt(e," "),r]," ")},FragmentDefinition:{leave:({name:n,typeCondition:e,variableDefinitions:r,directives:h,selectionSet:d})=>`fragment ${n}${ii("(",Wt(r,", "),")")} on ${e} ${ii("",Wt(h," ")," ")}`+d},IntValue:{leave:({value:n})=>n},FloatValue:{leave:({value:n})=>n},StringValue:{leave:({value:n,block:e})=>e?jD(n):hI(n)},BooleanValue:{leave:({value:n})=>n?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:n})=>n},ListValue:{leave:({values:n})=>"["+Wt(n,", ")+"]"},ObjectValue:{leave:({fields:n})=>"{"+Wt(n,", ")+"}"},ObjectField:{leave:({name:n,value:e})=>n+": "+e},Directive:{leave:({name:n,arguments:e})=>"@"+n+ii("(",Wt(e,", "),")")},NamedType:{leave:({name:n})=>n},ListType:{leave:({type:n})=>"["+n+"]"},NonNullType:{leave:({type:n})=>n+"!"},SchemaDefinition:{leave:({description:n,directives:e,operationTypes:r})=>ii("",n,`
`)+Wt(["schema",Wt(e," "),ou(r)]," ")},OperationTypeDefinition:{leave:({operation:n,type:e})=>n+": "+e},ScalarTypeDefinition:{leave:({description:n,name:e,directives:r})=>ii("",n,`
`)+Wt(["scalar",e,Wt(r," ")]," ")},ObjectTypeDefinition:{leave:({description:n,name:e,interfaces:r,directives:h,fields:d})=>ii("",n,`
`)+Wt(["type",e,ii("implements ",Wt(r," & ")),Wt(h," "),ou(d)]," ")},FieldDefinition:{leave:({description:n,name:e,arguments:r,type:h,directives:d})=>ii("",n,`
`)+e+(S2(r)?ii(`(
`,Rv(Wt(r,`
`)),`
)`):ii("(",Wt(r,", "),")"))+": "+h+ii(" ",Wt(d," "))},InputValueDefinition:{leave:({description:n,name:e,type:r,defaultValue:h,directives:d})=>ii("",n,`
`)+Wt([e+": "+r,ii("= ",h),Wt(d," ")]," ")},InterfaceTypeDefinition:{leave:({description:n,name:e,interfaces:r,directives:h,fields:d})=>ii("",n,`
`)+Wt(["interface",e,ii("implements ",Wt(r," & ")),Wt(h," "),ou(d)]," ")},UnionTypeDefinition:{leave:({description:n,name:e,directives:r,types:h})=>ii("",n,`
`)+Wt(["union",e,Wt(r," "),ii("= ",Wt(h," | "))]," ")},EnumTypeDefinition:{leave:({description:n,name:e,directives:r,values:h})=>ii("",n,`
`)+Wt(["enum",e,Wt(r," "),ou(h)]," ")},EnumValueDefinition:{leave:({description:n,name:e,directives:r})=>ii("",n,`
`)+Wt([e,Wt(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:n,name:e,directives:r,fields:h})=>ii("",n,`
`)+Wt(["input",e,Wt(r," "),ou(h)]," ")},DirectiveDefinition:{leave:({description:n,name:e,arguments:r,repeatable:h,locations:d})=>ii("",n,`
`)+"directive @"+e+(S2(r)?ii(`(
`,Rv(Wt(r,`
`)),`
)`):ii("(",Wt(r,", "),")"))+(h?" repeatable":"")+" on "+Wt(d," | ")},SchemaExtension:{leave:({directives:n,operationTypes:e})=>Wt(["extend schema",Wt(n," "),ou(e)]," ")},ScalarTypeExtension:{leave:({name:n,directives:e})=>Wt(["extend scalar",n,Wt(e," ")]," ")},ObjectTypeExtension:{leave:({name:n,interfaces:e,directives:r,fields:h})=>Wt(["extend type",n,ii("implements ",Wt(e," & ")),Wt(r," "),ou(h)]," ")},InterfaceTypeExtension:{leave:({name:n,interfaces:e,directives:r,fields:h})=>Wt(["extend interface",n,ii("implements ",Wt(e," & ")),Wt(r," "),ou(h)]," ")},UnionTypeExtension:{leave:({name:n,directives:e,types:r})=>Wt(["extend union",n,Wt(e," "),ii("= ",Wt(r," | "))]," ")},EnumTypeExtension:{leave:({name:n,directives:e,values:r})=>Wt(["extend enum",n,Wt(e," "),ou(r)]," ")},InputObjectTypeExtension:{leave:({name:n,directives:e,fields:r})=>Wt(["extend input",n,Wt(e," "),ou(r)]," ")}};function Wt(n,e=""){var r;return(r=n?.filter(h=>h).join(e))!==null&&r!==void 0?r:""}function ou(n){return ii(`{
`,Rv(Wt(n,`
`)),`
}`)}function ii(n,e,r=""){return e!=null&&e!==""?n+e+r:""}function Rv(n){return ii("  ",n.replace(/\n/g,`
  `))}function S2(n){var e;return(e=n?.some(r=>r.includes(`
`)))!==null&&e!==void 0?e:!1}function Xx(n,e){switch(n.kind){case kt.NULL:return null;case kt.INT:return parseInt(n.value,10);case kt.FLOAT:return parseFloat(n.value);case kt.STRING:case kt.ENUM:case kt.BOOLEAN:return n.value;case kt.LIST:return n.values.map(r=>Xx(r,e));case kt.OBJECT:return Qp(n.fields,r=>r.name.value,r=>Xx(r.value,e));case kt.VARIABLE:return e?.[n.name.value]}}function fu(n){if(n!=null||ki(!1,"Must provide name."),typeof n=="string"||ki(!1,"Expected name to be a string."),n.length===0)throw new Fi("Expected name to be a non-empty string.");for(let e=1;e<n.length;++e)if(!YS(n.charCodeAt(e)))throw new Fi(`Names must only contain [_a-zA-Z0-9] but "${n}" does not.`);if(!j1(n.charCodeAt(0)))throw new Fi(`Names must start with [_a-zA-Z] but "${n}" does not.`);return n}function vI(n){if(n==="true"||n==="false"||n==="null")throw new Fi(`Enum values cannot be named: ${n}`);return fu(n)}function tE(n){return Qg(n)||kf(n)||uu(n)||im(n)||Lf(n)||_d(n)||Bf(n)||vd(n)}function Qg(n){return fh(n,mm)}function kf(n){return fh(n,Uf)}function bI(n){if(!kf(n))throw new Error(`Expected ${En(n)} to be a GraphQL Object type.`);return n}function uu(n){return fh(n,fE)}function xI(n){if(!uu(n))throw new Error(`Expected ${En(n)} to be a GraphQL Interface type.`);return n}function im(n){return fh(n,pE)}function Lf(n){return fh(n,yb)}function _d(n){return fh(n,mE)}function Bf(n){return fh(n,pc)}function vd(n){return fh(n,si)}function nE(n){return Qg(n)||Lf(n)||_d(n)||B1(n)&&nE(n.ofType)}function iE(n){return Qg(n)||kf(n)||uu(n)||im(n)||Lf(n)||B1(n)&&iE(n.ofType)}function rE(n){return Qg(n)||Lf(n)}function wI(n){return uu(n)||im(n)}class pc{constructor(e){tE(e)||ki(!1,`Expected ${En(e)} to be a GraphQL type.`),this.ofType=e}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class si{constructor(e){aE(e)||ki(!1,`Expected ${En(e)} to be a GraphQL nullable type.`),this.ofType=e}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function B1(n){return Bf(n)||vd(n)}function aE(n){return tE(n)&&!vd(n)}function TI(n){if(!aE(n))throw new Error(`Expected ${En(n)} to be a GraphQL nullable type.`);return n}function SI(n){if(n){let e=n;for(;B1(e);)e=e.ofType;return e}}function oE(n){return typeof n=="function"?n():n}function sE(n){return typeof n=="function"?n():n}class mm{constructor(e){var r,h,d,m;const y=(r=e.parseValue)!==null&&r!==void 0?r:w2;this.name=fu(e.name),this.description=e.description,this.specifiedByURL=e.specifiedByURL,this.serialize=(h=e.serialize)!==null&&h!==void 0?h:w2,this.parseValue=y,this.parseLiteral=(d=e.parseLiteral)!==null&&d!==void 0?d:(c,E)=>y(Xx(c,E)),this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(m=e.extensionASTNodes)!==null&&m!==void 0?m:[],e.specifiedByURL==null||typeof e.specifiedByURL=="string"||ki(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${En(e.specifiedByURL)}.`),e.serialize==null||typeof e.serialize=="function"||ki(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),e.parseLiteral&&(typeof e.parseValue=="function"&&typeof e.parseLiteral=="function"||ki(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class Uf{constructor(e){var r;this.name=fu(e.name),this.description=e.description,this.isTypeOf=e.isTypeOf,this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._fields=()=>cE(e),this._interfaces=()=>lE(e),e.isTypeOf==null||typeof e.isTypeOf=="function"||ki(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${En(e.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:hE(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function lE(n){var e;const r=oE((e=n.interfaces)!==null&&e!==void 0?e:[]);return Array.isArray(r)||ki(!1,`${n.name} interfaces must be an Array or a function which returns an Array.`),r}function cE(n){const e=sE(n.fields);return Dg(e)||ki(!1,`${n.name} fields must be an object with field names as keys or a function which returns such an object.`),gb(e,(r,h)=>{var d;Dg(r)||ki(!1,`${n.name}.${h} field config must be an object.`),r.resolve==null||typeof r.resolve=="function"||ki(!1,`${n.name}.${h} field resolver must be a function if provided, but got: ${En(r.resolve)}.`);const m=(d=r.args)!==null&&d!==void 0?d:{};return Dg(m)||ki(!1,`${n.name}.${h} args must be an object with argument names as keys.`),{name:fu(h),description:r.description,type:r.type,args:uE(m),resolve:r.resolve,subscribe:r.subscribe,deprecationReason:r.deprecationReason,extensions:Tc(r.extensions),astNode:r.astNode}})}function uE(n){return Object.entries(n).map(([e,r])=>({name:fu(e),description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:Tc(r.extensions),astNode:r.astNode}))}function Dg(n){return Md(n)&&!Array.isArray(n)}function hE(n){return gb(n,e=>({description:e.description,type:e.type,args:dE(e.args),resolve:e.resolve,subscribe:e.subscribe,deprecationReason:e.deprecationReason,extensions:e.extensions,astNode:e.astNode}))}function dE(n){return Qp(n,e=>e.name,e=>({description:e.description,type:e.type,defaultValue:e.defaultValue,deprecationReason:e.deprecationReason,extensions:e.extensions,astNode:e.astNode}))}class fE{constructor(e){var r;this.name=fu(e.name),this.description=e.description,this.resolveType=e.resolveType,this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._fields=cE.bind(void 0,e),this._interfaces=lE.bind(void 0,e),e.resolveType==null||typeof e.resolveType=="function"||ki(!1,`${this.name} must provide "resolveType" as a function, but got: ${En(e.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:hE(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class pE{constructor(e){var r;this.name=fu(e.name),this.description=e.description,this.resolveType=e.resolveType,this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._types=EI.bind(void 0,e),e.resolveType==null||typeof e.resolveType=="function"||ki(!1,`${this.name} must provide "resolveType" as a function, but got: ${En(e.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function EI(n){const e=oE(n.types);return Array.isArray(e)||ki(!1,`Must provide Array of types or a function which returns such an array for Union ${n.name}.`),e}class yb{constructor(e){var r;this.name=fu(e.name),this.description=e.description,this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._values=typeof e.values=="function"?e.values:E2(this.name,e.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=E2(this.name,this._values())),this._values}getValue(e){return this._nameLookup===null&&(this._nameLookup=eE(this.getValues(),r=>r.name)),this._nameLookup[e]}serialize(e){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(h=>[h.value,h])));const r=this._valueLookup.get(e);if(r===void 0)throw new Fi(`Enum "${this.name}" cannot represent value: ${En(e)}`);return r.name}parseValue(e){if(typeof e!="string"){const h=En(e);throw new Fi(`Enum "${this.name}" cannot represent non-string value: ${h}.`+gv(this,h))}const r=this.getValue(e);if(r==null)throw new Fi(`Value "${e}" does not exist in "${this.name}" enum.`+gv(this,e));return r.value}parseLiteral(e,r){if(e.kind!==kt.ENUM){const d=ps(e);throw new Fi(`Enum "${this.name}" cannot represent non-enum value: ${d}.`+gv(this,d),{nodes:e})}const h=this.getValue(e.value);if(h==null){const d=ps(e);throw new Fi(`Value "${d}" does not exist in "${this.name}" enum.`+gv(this,d),{nodes:e})}return h.value}toConfig(){const e=Qp(this.getValues(),r=>r.name,r=>({description:r.description,value:r.value,deprecationReason:r.deprecationReason,extensions:r.extensions,astNode:r.astNode}));return{name:this.name,description:this.description,values:e,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function gv(n,e){const r=n.getValues().map(d=>d.name),h=cI(e,r);return oI("the enum value",h)}function E2(n,e){return Dg(e)||ki(!1,`${n} values must be an object with value names as keys.`),Object.entries(e).map(([r,h])=>(Dg(h)||ki(!1,`${n}.${r} must refer to an object with a "value" key representing an internal value but got: ${En(h)}.`),{name:vI(r),description:h.description,value:h.value!==void 0?h.value:r,deprecationReason:h.deprecationReason,extensions:Tc(h.extensions),astNode:h.astNode}))}class mE{constructor(e){var r,h;this.name=fu(e.name),this.description=e.description,this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this.isOneOf=(h=e.isOneOf)!==null&&h!==void 0?h:!1,this._fields=AI.bind(void 0,e)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const e=gb(this.getFields(),r=>({description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:r.extensions,astNode:r.astNode}));return{name:this.name,description:this.description,fields:e,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function AI(n){const e=sE(n.fields);return Dg(e)||ki(!1,`${n.name} fields must be an object with field names as keys or a function which returns such an object.`),gb(e,(r,h)=>(!("resolve"in r)||ki(!1,`${n.name}.${h} field has a resolve property, but Input Types cannot define resolvers.`),{name:fu(h),description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:Tc(r.extensions),astNode:r.astNode}))}const mx=2147483647,gx=-2147483648,MI=new mm({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(n){const e=r0(n);if(typeof e=="boolean")return e?1:0;let r=e;if(typeof e=="string"&&e!==""&&(r=Number(e)),typeof r!="number"||!Number.isInteger(r))throw new Fi(`Int cannot represent non-integer value: ${En(e)}`);if(r>mx||r<gx)throw new Fi("Int cannot represent non 32-bit signed integer value: "+En(e));return r},parseValue(n){if(typeof n!="number"||!Number.isInteger(n))throw new Fi(`Int cannot represent non-integer value: ${En(n)}`);if(n>mx||n<gx)throw new Fi(`Int cannot represent non 32-bit signed integer value: ${n}`);return n},parseLiteral(n){if(n.kind!==kt.INT)throw new Fi(`Int cannot represent non-integer value: ${ps(n)}`,{nodes:n});const e=parseInt(n.value,10);if(e>mx||e<gx)throw new Fi(`Int cannot represent non 32-bit signed integer value: ${n.value}`,{nodes:n});return e}}),CI=new mm({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(n){const e=r0(n);if(typeof e=="boolean")return e?1:0;let r=e;if(typeof e=="string"&&e!==""&&(r=Number(e)),typeof r!="number"||!Number.isFinite(r))throw new Fi(`Float cannot represent non numeric value: ${En(e)}`);return r},parseValue(n){if(typeof n!="number"||!Number.isFinite(n))throw new Fi(`Float cannot represent non numeric value: ${En(n)}`);return n},parseLiteral(n){if(n.kind!==kt.FLOAT&&n.kind!==kt.INT)throw new Fi(`Float cannot represent non numeric value: ${ps(n)}`,n);return parseFloat(n.value)}}),aa=new mm({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(n){const e=r0(n);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"true":"false";if(typeof e=="number"&&Number.isFinite(e))return e.toString();throw new Fi(`String cannot represent value: ${En(n)}`)},parseValue(n){if(typeof n!="string")throw new Fi(`String cannot represent a non string value: ${En(n)}`);return n},parseLiteral(n){if(n.kind!==kt.STRING)throw new Fi(`String cannot represent a non string value: ${ps(n)}`,{nodes:n});return n.value}}),Al=new mm({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(n){const e=r0(n);if(typeof e=="boolean")return e;if(Number.isFinite(e))return e!==0;throw new Fi(`Boolean cannot represent a non boolean value: ${En(e)}`)},parseValue(n){if(typeof n!="boolean")throw new Fi(`Boolean cannot represent a non boolean value: ${En(n)}`);return n},parseLiteral(n){if(n.kind!==kt.BOOLEAN)throw new Fi(`Boolean cannot represent a non boolean value: ${ps(n)}`,{nodes:n});return n.value}}),gE=new mm({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(n){const e=r0(n);if(typeof e=="string")return e;if(Number.isInteger(e))return String(e);throw new Fi(`ID cannot represent value: ${En(n)}`)},parseValue(n){if(typeof n=="string")return n;if(typeof n=="number"&&Number.isInteger(n))return n.toString();throw new Fi(`ID cannot represent value: ${En(n)}`)},parseLiteral(n){if(n.kind!==kt.STRING&&n.kind!==kt.INT)throw new Fi("ID cannot represent a non-string and non-integer value: "+ps(n),{nodes:n});return n.value}}),DI=Object.freeze([aa,MI,CI,Al,gE]);function r0(n){if(Md(n)){if(typeof n.valueOf=="function"){const e=n.valueOf();if(!Md(e))return e}if(typeof n.toJSON=="function")return n.toJSON()}return n}function II(n){return fh(n,gm)}class gm{constructor(e){var r,h;this.name=fu(e.name),this.description=e.description,this.locations=e.locations,this.isRepeatable=(r=e.isRepeatable)!==null&&r!==void 0?r:!1,this.extensions=Tc(e.extensions),this.astNode=e.astNode,Array.isArray(e.locations)||ki(!1,`@${e.name} locations must be an Array.`);const d=(h=e.args)!==null&&h!==void 0?h:{};Md(d)&&!Array.isArray(d)||ki(!1,`@${e.name} args must be an object with argument names as keys.`),this.args=uE(d)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:dE(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const RI=new gm({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[di.FIELD,di.FRAGMENT_SPREAD,di.INLINE_FRAGMENT],args:{if:{type:new si(Al),description:"Included when true."}}}),kI=new gm({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[di.FIELD,di.FRAGMENT_SPREAD,di.INLINE_FRAGMENT],args:{if:{type:new si(Al),description:"Skipped when true."}}}),OI="No longer supported",PI=new gm({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[di.FIELD_DEFINITION,di.ARGUMENT_DEFINITION,di.INPUT_FIELD_DEFINITION,di.ENUM_VALUE],args:{reason:{type:aa,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:OI}}}),LI=new gm({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[di.SCALAR],args:{url:{type:new si(aa),description:"The URL that specifies the behavior of this scalar."}}}),zI=new gm({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[di.INPUT_OBJECT],args:{}}),NI=Object.freeze([RI,kI,PI,LI,zI]);function jI(n){return typeof n=="object"&&typeof n?.[Symbol.iterator]=="function"}function b_(n,e){if(vd(e)){const r=b_(n,e.ofType);return r?.kind===kt.NULL?null:r}if(n===null)return{kind:kt.NULL};if(n===void 0)return null;if(Bf(e)){const r=e.ofType;if(jI(n)){const h=[];for(const d of n){const m=b_(d,r);m!=null&&h.push(m)}return{kind:kt.LIST,values:h}}return b_(n,r)}if(_d(e)){if(!Md(n))return null;const r=[];for(const h of Object.values(e.getFields())){const d=b_(n[h.name],h.type);d&&r.push({kind:kt.OBJECT_FIELD,name:{kind:kt.NAME,value:h.name},value:d})}return{kind:kt.OBJECT,fields:r}}if(rE(e)){const r=e.serialize(n);if(r==null)return null;if(typeof r=="boolean")return{kind:kt.BOOLEAN,value:r};if(typeof r=="number"&&Number.isFinite(r)){const h=String(r);return A2.test(h)?{kind:kt.INT,value:h}:{kind:kt.FLOAT,value:h}}if(typeof r=="string")return Lf(e)?{kind:kt.ENUM,value:r}:e===gE&&A2.test(r)?{kind:kt.INT,value:r}:{kind:kt.STRING,value:r};throw new TypeError(`Cannot convert value to AST: ${En(r)}.`)}fb(!1,"Unexpected input type: "+En(e))}const A2=/^-?(?:0|[1-9][0-9]*)$/,U1=new Uf({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:aa,resolve:n=>n.description},types:{description:"A list of all types supported by this server.",type:new si(new pc(new si(nh))),resolve(n){return Object.values(n.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new si(nh),resolve:n=>n.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:nh,resolve:n=>n.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:nh,resolve:n=>n.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new si(new pc(new si(yE))),resolve:n=>n.getDirectives()}})}),yE=new Uf({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new si(aa),resolve:n=>n.name},description:{type:aa,resolve:n=>n.description},isRepeatable:{type:new si(Al),resolve:n=>n.isRepeatable},locations:{type:new si(new pc(new si(_E))),resolve:n=>n.locations},args:{type:new si(new pc(new si(_b))),args:{includeDeprecated:{type:Al,defaultValue:!1}},resolve(n,{includeDeprecated:e}){return e?n.args:n.args.filter(r=>r.deprecationReason==null)}}})}),_E=new yb({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:di.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:di.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:di.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:di.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:di.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:di.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:di.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:di.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:di.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:di.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:di.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:di.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:di.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:di.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:di.UNION,description:"Location adjacent to a union definition."},ENUM:{value:di.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:di.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:di.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:di.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),nh=new Uf({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new si(xE),resolve(n){if(Qg(n))return Ki.SCALAR;if(kf(n))return Ki.OBJECT;if(uu(n))return Ki.INTERFACE;if(im(n))return Ki.UNION;if(Lf(n))return Ki.ENUM;if(_d(n))return Ki.INPUT_OBJECT;if(Bf(n))return Ki.LIST;if(vd(n))return Ki.NON_NULL;fb(!1,`Unexpected type: "${En(n)}".`)}},name:{type:aa,resolve:n=>"name"in n?n.name:void 0},description:{type:aa,resolve:n=>"description"in n?n.description:void 0},specifiedByURL:{type:aa,resolve:n=>"specifiedByURL"in n?n.specifiedByURL:void 0},fields:{type:new pc(new si(vE)),args:{includeDeprecated:{type:Al,defaultValue:!1}},resolve(n,{includeDeprecated:e}){if(kf(n)||uu(n)){const r=Object.values(n.getFields());return e?r:r.filter(h=>h.deprecationReason==null)}}},interfaces:{type:new pc(new si(nh)),resolve(n){if(kf(n)||uu(n))return n.getInterfaces()}},possibleTypes:{type:new pc(new si(nh)),resolve(n,e,r,{schema:h}){if(wI(n))return h.getPossibleTypes(n)}},enumValues:{type:new pc(new si(bE)),args:{includeDeprecated:{type:Al,defaultValue:!1}},resolve(n,{includeDeprecated:e}){if(Lf(n)){const r=n.getValues();return e?r:r.filter(h=>h.deprecationReason==null)}}},inputFields:{type:new pc(new si(_b)),args:{includeDeprecated:{type:Al,defaultValue:!1}},resolve(n,{includeDeprecated:e}){if(_d(n)){const r=Object.values(n.getFields());return e?r:r.filter(h=>h.deprecationReason==null)}}},ofType:{type:nh,resolve:n=>"ofType"in n?n.ofType:void 0},isOneOf:{type:Al,resolve:n=>{if(_d(n))return n.isOneOf}}})}),vE=new Uf({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new si(aa),resolve:n=>n.name},description:{type:aa,resolve:n=>n.description},args:{type:new si(new pc(new si(_b))),args:{includeDeprecated:{type:Al,defaultValue:!1}},resolve(n,{includeDeprecated:e}){return e?n.args:n.args.filter(r=>r.deprecationReason==null)}},type:{type:new si(nh),resolve:n=>n.type},isDeprecated:{type:new si(Al),resolve:n=>n.deprecationReason!=null},deprecationReason:{type:aa,resolve:n=>n.deprecationReason}})}),_b=new Uf({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new si(aa),resolve:n=>n.name},description:{type:aa,resolve:n=>n.description},type:{type:new si(nh),resolve:n=>n.type},defaultValue:{type:aa,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(n){const{type:e,defaultValue:r}=n,h=b_(r,e);return h?ps(h):null}},isDeprecated:{type:new si(Al),resolve:n=>n.deprecationReason!=null},deprecationReason:{type:aa,resolve:n=>n.deprecationReason}})}),bE=new Uf({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new si(aa),resolve:n=>n.name},description:{type:aa,resolve:n=>n.description},isDeprecated:{type:new si(Al),resolve:n=>n.deprecationReason!=null},deprecationReason:{type:aa,resolve:n=>n.deprecationReason}})});var Ki;(function(n){n.SCALAR="SCALAR",n.OBJECT="OBJECT",n.INTERFACE="INTERFACE",n.UNION="UNION",n.ENUM="ENUM",n.INPUT_OBJECT="INPUT_OBJECT",n.LIST="LIST",n.NON_NULL="NON_NULL"})(Ki||(Ki={}));const xE=new yb({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:Ki.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:Ki.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:Ki.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:Ki.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:Ki.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:Ki.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:Ki.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:Ki.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new si(U1);new si(aa);new si(aa);const FI=Object.freeze([U1,yE,_E,nh,vE,_b,bE,xE]);class BI{constructor(e){var r,h;this.__validationErrors=e.assumeValid===!0?[]:void 0,Md(e)||ki(!1,"Must provide configuration object."),!e.types||Array.isArray(e.types)||ki(!1,`"types" must be Array if provided but got: ${En(e.types)}.`),!e.directives||Array.isArray(e.directives)||ki(!1,`"directives" must be Array if provided but got: ${En(e.directives)}.`),this.description=e.description,this.extensions=Tc(e.extensions),this.astNode=e.astNode,this.extensionASTNodes=(r=e.extensionASTNodes)!==null&&r!==void 0?r:[],this._queryType=e.query,this._mutationType=e.mutation,this._subscriptionType=e.subscription,this._directives=(h=e.directives)!==null&&h!==void 0?h:NI;const d=new Set(e.types);if(e.types!=null)for(const m of e.types)d.delete(m),lu(m,d);this._queryType!=null&&lu(this._queryType,d),this._mutationType!=null&&lu(this._mutationType,d),this._subscriptionType!=null&&lu(this._subscriptionType,d);for(const m of this._directives)if(II(m))for(const y of m.args)lu(y.type,d);lu(U1,d),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const m of d){if(m==null)continue;const y=m.name;if(y||ki(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[y]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${y}".`);if(this._typeMap[y]=m,uu(m)){for(const c of m.getInterfaces())if(uu(c)){let E=this._implementationsMap[c.name];E===void 0&&(E=this._implementationsMap[c.name]={objects:[],interfaces:[]}),E.interfaces.push(m)}}else if(kf(m)){for(const c of m.getInterfaces())if(uu(c)){let E=this._implementationsMap[c.name];E===void 0&&(E=this._implementationsMap[c.name]={objects:[],interfaces:[]}),E.objects.push(m)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(e){switch(e){case pd.QUERY:return this.getQueryType();case pd.MUTATION:return this.getMutationType();case pd.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(e){return this.getTypeMap()[e]}getPossibleTypes(e){return im(e)?e.getTypes():this.getImplementations(e).objects}getImplementations(e){const r=this._implementationsMap[e.name];return r??{objects:[],interfaces:[]}}isSubType(e,r){let h=this._subTypeMap[e.name];if(h===void 0){if(h=Object.create(null),im(e))for(const d of e.getTypes())h[d.name]=!0;else{const d=this.getImplementations(e);for(const m of d.objects)h[m.name]=!0;for(const m of d.interfaces)h[m.name]=!0}this._subTypeMap[e.name]=h}return h[r.name]!==void 0}getDirectives(){return this._directives}getDirective(e){return this.getDirectives().find(r=>r.name===e)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function lu(n,e){const r=SI(n);if(!e.has(r)){if(e.add(r),im(r))for(const h of r.getTypes())lu(h,e);else if(kf(r)||uu(r)){for(const h of r.getInterfaces())lu(h,e);for(const h of Object.values(r.getFields())){lu(h.type,e);for(const d of h.args)lu(d.type,e)}}else if(_d(r))for(const h of Object.values(r.getFields()))lu(h.type,e)}return e}function x_(n,e,r){if(n){if(n.kind===kt.VARIABLE){n.name.value;return}if(vd(e))return n.kind===kt.NULL?void 0:x_(n,e.ofType,r);if(n.kind===kt.NULL)return null;if(Bf(e)){const h=e.ofType;if(n.kind===kt.LIST){const m=[];for(const y of n.values)if(M2(y,r)){if(vd(h))return;m.push(null)}else{const c=x_(y,h,r);if(c===void 0)return;m.push(c)}return m}const d=x_(n,h,r);return d===void 0?void 0:[d]}if(_d(e)){if(n.kind!==kt.OBJECT)return;const h=Object.create(null),d=eE(n.fields,m=>m.name.value);for(const m of Object.values(e.getFields())){const y=d[m.name];if(!y||M2(y.value,r)){if(m.defaultValue!==void 0)h[m.name]=m.defaultValue;else if(vd(m.type))return;continue}const c=x_(y.value,m.type,r);if(c===void 0)return;h[m.name]=c}if(e.isOneOf){const m=Object.keys(h);if(m.length!==1||h[m[0]]===null)return}return h}if(rE(e)){let h;try{h=e.parseLiteral(n,r)}catch{return}return h===void 0?void 0:h}fb(!1,"Unexpected input type: "+En(e))}}function M2(n,e){return n.kind===kt.VARIABLE&&e==null}function UI(n){const e={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...n},r=e.descriptions?"description":"",h=e.specifiedByUrl?"specifiedByURL":"",d=e.directiveIsRepeatable?"isRepeatable":"",m=e.schemaDescription?r:"";function y(E){return e.inputValueDeprecation?E:""}const c=e.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${m}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${r}
          ${d}
          locations
          args${y("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${r}
      ${h}
      ${c}
      fields(includeDeprecated: true) {
        name
        ${r}
        args${y("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${y("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${r}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${r}
      type { ...TypeRef }
      defaultValue
      ${y("isDeprecated")}
      ${y("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function VI(n,e){Md(n)&&Md(n.__schema)||ki(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${En(n)}.`);const r=n.__schema,h=Qp(r.types,Ee=>Ee.name,Ee=>F(Ee));for(const Ee of[...DI,...FI])h[Ee.name]&&(h[Ee.name]=Ee);const d=r.queryType?k(r.queryType):null,m=r.mutationType?k(r.mutationType):null,y=r.subscriptionType?k(r.subscriptionType):null,c=r.directives?r.directives.map(ot):[];return new BI({description:r.description,query:d,mutation:m,subscription:y,types:Object.values(h),directives:c,assumeValid:void 0});function E(Ee){if(Ee.kind===Ki.LIST){const Je=Ee.ofType;if(!Je)throw new Error("Decorated type deeper than introspection query.");return new pc(E(Je))}if(Ee.kind===Ki.NON_NULL){const Je=Ee.ofType;if(!Je)throw new Error("Decorated type deeper than introspection query.");const Et=E(Je);return new si(TI(Et))}return C(Ee)}function C(Ee){const Je=Ee.name;if(!Je)throw new Error(`Unknown type reference: ${En(Ee)}.`);const Et=h[Je];if(!Et)throw new Error(`Invalid or incomplete schema, unknown type: ${Je}. Ensure that a full introspection query is used in order to build a client schema.`);return Et}function k(Ee){return bI(C(Ee))}function z(Ee){return xI(C(Ee))}function F(Ee){if(Ee!=null&&Ee.name!=null&&Ee.kind!=null)switch(Ee.kind){case Ki.SCALAR:return B(Ee);case Ki.OBJECT:return ie(Ee);case Ki.INTERFACE:return ne(Ee);case Ki.UNION:return ue(Ee);case Ki.ENUM:return Ae(Ee);case Ki.INPUT_OBJECT:return Te(Ee)}const Je=En(Ee);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${Je}.`)}function B(Ee){return new mm({name:Ee.name,description:Ee.description,specifiedByURL:Ee.specifiedByURL})}function Q(Ee){if(Ee.interfaces===null&&Ee.kind===Ki.INTERFACE)return[];if(!Ee.interfaces){const Je=En(Ee);throw new Error(`Introspection result missing interfaces: ${Je}.`)}return Ee.interfaces.map(z)}function ie(Ee){return new Uf({name:Ee.name,description:Ee.description,interfaces:()=>Q(Ee),fields:()=>ke(Ee)})}function ne(Ee){return new fE({name:Ee.name,description:Ee.description,interfaces:()=>Q(Ee),fields:()=>ke(Ee)})}function ue(Ee){if(!Ee.possibleTypes){const Je=En(Ee);throw new Error(`Introspection result missing possibleTypes: ${Je}.`)}return new pE({name:Ee.name,description:Ee.description,types:()=>Ee.possibleTypes.map(k)})}function Ae(Ee){if(!Ee.enumValues){const Je=En(Ee);throw new Error(`Introspection result missing enumValues: ${Je}.`)}return new yb({name:Ee.name,description:Ee.description,values:Qp(Ee.enumValues,Je=>Je.name,Je=>({description:Je.description,deprecationReason:Je.deprecationReason}))})}function Te(Ee){if(!Ee.inputFields){const Je=En(Ee);throw new Error(`Introspection result missing inputFields: ${Je}.`)}return new mE({name:Ee.name,description:Ee.description,fields:()=>Me(Ee.inputFields),isOneOf:Ee.isOneOf})}function ke(Ee){if(!Ee.fields)throw new Error(`Introspection result missing fields: ${En(Ee)}.`);return Qp(Ee.fields,Je=>Je.name,be)}function be(Ee){const Je=E(Ee.type);if(!iE(Je)){const Et=En(Je);throw new Error(`Introspection must provide output type for fields, but received: ${Et}.`)}if(!Ee.args){const Et=En(Ee);throw new Error(`Introspection result missing field args: ${Et}.`)}return{description:Ee.description,deprecationReason:Ee.deprecationReason,type:Je,args:Me(Ee.args)}}function Me(Ee){return Qp(Ee,Je=>Je.name,Fe)}function Fe(Ee){const Je=E(Ee.type);if(!nE(Je)){const Tt=En(Je);throw new Error(`Introspection must provide input type for arguments, but received: ${Tt}.`)}const Et=Ee.defaultValue!=null?x_(rI(Ee.defaultValue),Je):void 0;return{description:Ee.description,type:Je,defaultValue:Et,deprecationReason:Ee.deprecationReason}}function ot(Ee){if(!Ee.args){const Je=En(Ee);throw new Error(`Introspection result missing directive args: ${Je}.`)}if(!Ee.locations){const Je=En(Ee);throw new Error(`Introspection result missing directive locations: ${Je}.`)}return new gm({name:Ee.name,description:Ee.description,isRepeatable:Ee.isRepeatable,locations:Ee.locations.slice(),args:Me(Ee.args)})}}const C2="Accept",Wx="Content-Type",Qx="application/json",wE="application/graphql-response+json",D2=n=>n.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),GI=n=>{const e=n.toLowerCase();return e.includes(wE)||e.includes(Qx)},I2=n=>{try{if(Array.isArray(n))return{_tag:"Batch",executionResults:n.map(R2)};if(Iv(n))return{_tag:"Single",executionResult:R2(n)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(n)}`)}catch(e){return e}},R2=n=>{if(typeof n!="object"||n===null)throw new Error("Invalid execution result: result is not object");let e,r,h;if("errors"in n){if(!Iv(n.errors)&&!Array.isArray(n.errors))throw new Error("Invalid execution result: errors is not plain object OR array");e=n.errors}if("data"in n){if(!Iv(n.data)&&n.data!==null)throw new Error("Invalid execution result: data is not plain object");r=n.data}if("extensions"in n){if(!Iv(n.extensions))throw new Error("Invalid execution result: extensions is not plain object");h=n.extensions}return{data:r,errors:e,extensions:h}},$I=n=>n._tag==="Batch"?n.executionResults.some(k2):k2(n.executionResult),k2=n=>Array.isArray(n.errors)?n.errors.length>0:!!n.errors,TE=n=>typeof n=="object"&&n!==null&&"kind"in n&&n.kind===kt.OPERATION_DEFINITION,ZI=n=>{let e;const r=n.definitions.filter(TE);return r.length===1&&(e=r[0].name?.value),e},YI=n=>{let e=!1;const r=n.definitions.filter(TE);return r.length===1&&(e=r[0].operation==="mutation"),e},yx=(n,e)=>{const r=typeof n=="string"?n:ps(n);let h=!1,d;if(e)return{expression:r,isMutation:h,operationName:d};const m=MD(()=>typeof n=="string"?QS(n):n);return m instanceof Error?{expression:r,isMutation:h,operationName:d}:(d=ZI(m),h=YI(m),{expression:r,operationName:d,isMutation:h})},V1=JSON,_x=async n=>{const e={...n,method:n.request._tag==="Single"?n.request.document.isMutation?"POST":g2(n.method??"post"):n.request.hasMutations?"POST":g2(n.method??"post"),fetchOptions:{...n.fetchOptions,errorPolicy:n.fetchOptions.errorPolicy??"none"}},h=await qI(e.method)(e);if(!h.ok)return new Cg({status:h.status,headers:h.headers},{query:n.request._tag==="Single"?n.request.document.expression:n.request.query,variables:n.request.variables});const d=await HI(h,n.fetchOptions.jsonSerializer??V1);if(d instanceof Error)throw d;const m={status:h.status,headers:h.headers};if($I(d)&&e.fetchOptions.errorPolicy==="none"){const y=d._tag==="Batch"?{...d.executionResults,...m}:{...d.executionResult,...m};return new Cg(y,{query:n.request._tag==="Single"?n.request.document.expression:n.request.query,variables:n.request.variables})}switch(d._tag){case"Single":return{...m,...O2(e)(d.executionResult)};case"Batch":return{...m,data:d.executionResults.map(O2(e))};default:N1(d)}},O2=n=>e=>({extensions:e.extensions,data:e.data,errors:n.fetchOptions.errorPolicy==="all"?e.errors:void 0}),HI=async(n,e)=>{const r=n.headers.get(Wx),h=await n.text();return r&&GI(r)?I2(e.parse(h)):I2(h)},qI=n=>async e=>{const r=new Headers(e.headers);let h=null,d;r.has(C2)||r.set(C2,[wE,Qx].join(", ")),n==="POST"?(d=(e.fetchOptions.jsonSerializer??V1).stringify(XI(e)),typeof d=="string"&&!r.has(Wx)&&r.set(Wx,Qx)):h=WI(e);const m={method:n,headers:r,body:d,...e.fetchOptions};let y=new URL(e.url),c=m;if(e.middleware){const C=await Promise.resolve(e.middleware({...m,url:e.url,operationName:e.request._tag==="Single"?e.request.document.operationName:void 0,variables:e.request.variables})),{url:k,...z}=C;y=new URL(k),c=z}return h&&h.forEach((C,k)=>{y.searchParams.append(k,C)}),await(e.fetch??fetch)(y,c)},XI=n=>{switch(n.request._tag){case"Single":return{query:n.request.document.expression,variables:n.request.variables,operationName:n.request.document.operationName};case"Batch":return US(n.request.query,n.request.variables??[]).map(([e,r])=>({query:e,variables:r}));default:throw N1(n.request)}},WI=n=>{const e=n.fetchOptions.jsonSerializer??V1,r=new URLSearchParams;switch(n.request._tag){case"Single":return r.append("query",D2(n.request.document.expression)),n.request.variables&&r.append("variables",e.stringify(n.request.variables)),n.request.document.operationName&&r.append("operationName",n.request.document.operationName),r;case"Batch":{const h=n.request.variables?.map(y=>e.stringify(y))??[],d=n.request.query.map(D2),m=US(d,h).map(([y,c])=>({query:y,variables:c}));return r.append("query",e.stringify(m)),r}default:throw N1(n.request)}};class QI{url;requestConfig;constructor(e,r={}){this.url=e,this.requestConfig=r}rawRequest=async(...e)=>{const[r,h,d]=e,m=ID(r,h,d),{headers:y,fetch:c=globalThis.fetch,method:E="POST",requestMiddleware:C,responseMiddleware:k,excludeOperationName:z,...F}=this.requestConfig,{url:B}=this;m.signal!==void 0&&(F.signal=m.signal);const Q=yx(m.query,z),ie=await _x({url:B,request:{_tag:"Single",document:Q,variables:m.variables},headers:{...gg(fx(y)),...gg(m.requestHeaders)},fetch:c,method:E,fetchOptions:F,middleware:C});if(k&&await k(ie,{operationName:Q.operationName,variables:h,url:this.url}),ie instanceof Error)throw ie;return ie};async request(e,...r){const[h,d]=r,m=KI(e,h,d),{headers:y,fetch:c=globalThis.fetch,method:E="POST",requestMiddleware:C,responseMiddleware:k,excludeOperationName:z,...F}=this.requestConfig,{url:B}=this;m.signal!==void 0&&(F.signal=m.signal);const Q=yx(m.document,z),ie=await _x({url:B,request:{_tag:"Single",document:Q,variables:m.variables},headers:{...gg(fx(y)),...gg(m.requestHeaders)},fetch:c,method:E,fetchOptions:F,middleware:C});if(k&&await k(ie,{operationName:Q.operationName,variables:m.variables,url:this.url}),ie instanceof Error)throw ie;return ie.data}async batchRequests(e,r){const h=DD(e,r),{headers:d,excludeOperationName:m,...y}=this.requestConfig;h.signal!==void 0&&(y.signal=h.signal);const c=h.documents.map(({document:F})=>yx(F,m)),E=c.map(({expression:F})=>F),C=c.some(({isMutation:F})=>F),k=h.documents.map(({variables:F})=>F),z=await _x({url:this.url,request:{_tag:"Batch",operationName:void 0,query:E,hasMutations:C,variables:k},headers:{...gg(fx(d)),...gg(h.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:y,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(z,{operationName:void 0,variables:k,url:this.url}),z instanceof Error)throw z;return z.data}setHeaders(e){return this.requestConfig.headers=e,this}setHeader(e,r){const{headers:h}=this.requestConfig;return h?h[e]=r:this.requestConfig.headers={[e]:r},this}setEndpoint(e){return this.url=e,this}}async function G1(n,e,...r){const h=JI(n,e,...r);return new QI(h.url).request({...h})}const KI=(n,e,r)=>n.document?n:{document:n,variables:e,requestHeaders:r,signal:void 0},JI=(n,e,...r)=>{const[h,d]=r;return typeof n=="string"?{url:n,document:e,variables:h,requestHeaders:d,signal:void 0}:n},vx="/otp/transmodel/v3",vb=()=>{try{return new URL(vx),vx}catch{return`${window.location.origin}${vx}`}};var SE=(n=>(n.LimitToNumOfItineraries="limitToNumOfItineraries",n.LimitToSearchWindow="limitToSearchWindow",n.ListAll="listAll",n.Off="off",n))(SE||{}),Ii=(n=>(n.Air="air",n.Bicycle="bicycle",n.Bus="bus",n.Cableway="cableway",n.Car="car",n.Coach="coach",n.Foot="foot",n.Funicular="funicular",n.Lift="lift",n.Metro="metro",n.Monorail="monorail",n.Rail="rail",n.Scooter="scooter",n.Taxi="taxi",n.Tram="tram",n.Trolleybus="trolleybus",n.Water="water",n))(Ii||{}),Pg=(n=>(n.Bicycle="bicycle",n.BikePark="bike_park",n.BikeRental="bike_rental",n.Car="car",n.CarPark="car_park",n.CarPickup="car_pickup",n.CarRental="car_rental",n.Flexible="flexible",n.Foot="foot",n.ScooterRental="scooter_rental",n))(Pg||{}),EE=(n=>(n.Air="air",n.Bus="bus",n.Cableway="cableway",n.Coach="coach",n.Funicular="funicular",n.Lift="lift",n.Metro="metro",n.Monorail="monorail",n.Rail="rail",n.Taxi="taxi",n.Tram="tram",n.Trolleybus="trolleybus",n.Unknown="unknown",n.Water="water",n))(EE||{});const eR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},tR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},nR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},iR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},rR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},aR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"fromEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},oR={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":eR,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":tR,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":nR,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":iR,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":rR,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        generalizedCost\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            generalizedCost\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            fromEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":aR};function Kg(n){return oR[n]??{}}const sR=Kg(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),lR=n=>{const[e,r]=K.useState(null);return K.useEffect(()=>{(async()=>{if(n.place){const d={id:n.place};try{r(await G1(vb(),sR,d))}catch(m){console.error("Error at useQuayCoordinateQuery",m)}}else r(null)})()},[n]),e?.quay};function P2(n){const e=lR(n);if(e){const{latitude:r,longitude:h}=e;if(r&&h)return{latitude:r,longitude:h}}if(n.coordinates)return{...n.coordinates}}function cR({setCursor:n,tripQueryVariables:e,setTripQueryVariables:r,loading:h}){const d=P2(e.from),m=P2(e.to);return X.jsxs(X.Fragment,{children:[d&&X.jsx(f2,{draggable:!0,latitude:d.latitude,longitude:d.longitude,onDragStart:()=>n("grabbing"),onDragEnd:y=>{n("auto"),h||r({...e,from:{coordinates:{latitude:y.lngLat.lat,longitude:y.lngLat.lng}}})},anchor:"bottom-right",children:X.jsx("img",{alt:"",src:SD,height:48,width:49})}),m&&X.jsx(f2,{draggable:!0,latitude:m.latitude,longitude:m.longitude,onDragStart:()=>n("grabbing"),onDragEnd:y=>{n("auto"),h||r({...e,to:{coordinates:{latitude:y.lngLat.lat,longitude:y.lngLat.lng}}})},anchor:"bottom-right",children:X.jsx("img",{alt:"",src:ED,height:48,width:49})})]})}var uR=function(n,e){for(var r=Math.pow(10,e),h=n.length,d=new Array(Math.floor(n.length/2)),m=0,y=0,c=0,E=0;m<h;++E){var C=1,k=0,z=void 0;do z=n.charCodeAt(m++)-63-1,C+=z<<k,k+=5;while(z>=31);y+=C&1?~(C>>1):C>>1,C=1,k=0;do z=n.charCodeAt(m++)-63-1,C+=z<<k,k+=5;while(z>=31);c+=C&1?~(C>>1):C>>1,d[E]=[y/r,c/r]}return d.length=E,d};const hR=function(n){return n===Ii.Foot?"#191616":n===Ii.Bicycle?"#5076D9":n===Ii.Scooter?"#14b7ca":n===Ii.Car?"#7e7e7e":n===Ii.Rail?"#86BF8B":n===Ii.Coach?"#25642A":n===Ii.Metro?"#D9B250":n===Ii.Bus?"#fe0000":n===Ii.Tram?"#D9B250":n===Ii.Trolleybus?"#25642A":n===Ii.Water||n===Ii.Air||n===Ii.Cableway||n===Ii.Funicular||n===Ii.Monorail||n===Ii.Taxi?"#81304C":"#aaa"},AE=function(n){return n.line?.presentation?.colour?`#${n.line.presentation.colour}`:hR(n.mode)};function dR({tripPattern:n}){return X.jsx(X.Fragment,{children:n?.legs.map((e,r)=>e.pointsOnLink&&X.jsxs(_D,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:uR(e.pointsOnLink.points,5).map(h=>h.reverse())}},children:[X.jsx(p2,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),X.jsx(p2,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":AE(e),"line-width":4}})]},e.id||`footleg_${r}`))})}const ME=(n,e,r)=>({...n,[r]:{coordinates:{latitude:e.lat,longitude:e.lng}}}),fR=(n,e)=>ME(n,e,"from"),pR=(n,e)=>ME(n,e,"to");function mR({tripQueryVariables:n,setTripQueryVariables:e}){return K.useCallback(r=>{r.preventDefault(),n.from.coordinates?e(pR(n,r.lngLat)):e(fR(n,r.lngLat))},[n,e])}var bx={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var L2;function gR(){return L2||(L2=1,function(n){(function(){var e={}.hasOwnProperty;function r(){for(var m="",y=0;y<arguments.length;y++){var c=arguments[y];c&&(m=d(m,h(c)))}return m}function h(m){if(typeof m=="string"||typeof m=="number")return m;if(typeof m!="object")return"";if(Array.isArray(m))return r.apply(null,m);if(m.toString!==Object.prototype.toString&&!m.toString.toString().includes("[native code]"))return m.toString();var y="";for(var c in m)e.call(m,c)&&m[c]&&(y=d(y,c));return y}function d(m,y){return y?m?m+" "+y:m+y:m}n.exports?(r.default=r,n.exports=r):window.classNames=r})()}(bx)),bx.exports}var yR=gR();const pn=fm(yR);function fn(){return fn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var h in r)({}).hasOwnProperty.call(r,h)&&(n[h]=r[h])}return n},fn.apply(null,arguments)}function $1(n,e){if(n==null)return{};var r={};for(var h in n)if({}.hasOwnProperty.call(n,h)){if(e.indexOf(h)!==-1)continue;r[h]=n[h]}return r}function z2(n){return"default"+n.charAt(0).toUpperCase()+n.substr(1)}function _R(n){var e=vR(n,"string");return typeof e=="symbol"?e:String(e)}function vR(n,e){if(typeof n!="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var h=r.call(n,e);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function bR(n,e,r){var h=K.useRef(n!==void 0),d=K.useState(e),m=d[0],y=d[1],c=n!==void 0,E=h.current;return h.current=c,!c&&E&&m!==e&&y(e),[c?n:m,K.useCallback(function(C){for(var k=arguments.length,z=new Array(k>1?k-1:0),F=1;F<k;F++)z[F-1]=arguments[F];r&&r.apply(void 0,[C].concat(z)),y(C)},[r])]}function CE(n,e){return Object.keys(e).reduce(function(r,h){var d,m=r,y=m[z2(h)],c=m[h],E=$1(m,[z2(h),h].map(_R)),C=e[h],k=bR(c,y,n[C]),z=k[0],F=k[1];return fn({},E,(d={},d[h]=z,d[C]=F,d))},n)}function Uv(n,e){return Uv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,h){return r.__proto__=h,r},Uv(n,e)}function xR(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Uv(n,e)}const wR=["xxl","xl","lg","md","sm","xs"],TR="xs",a0=K.createContext({prefixes:{},breakpoints:wR,minBreakpoint:TR}),{Consumer:y6,Provider:_6}=a0;function Pn(n,e){const{prefixes:r}=K.useContext(a0);return n||r[e]||e}function SR(){const{breakpoints:n}=K.useContext(a0);return n}function ER(){const{minBreakpoint:n}=K.useContext(a0);return n}function Z1(){const{dir:n}=K.useContext(a0);return n==="rtl"}function Jg(n){return n&&n.ownerDocument||document}function AR(n){var e=Jg(n);return e&&e.defaultView||window}function MR(n,e){return AR(n).getComputedStyle(n,e)}var CR=/([A-Z])/g;function DR(n){return n.replace(CR,"-$1").toLowerCase()}var IR=/^ms-/;function yv(n){return DR(n).replace(IR,"-ms-")}var RR=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function kR(n){return!!(n&&RR.test(n))}function bd(n,e){var r="",h="";if(typeof e=="string")return n.style.getPropertyValue(yv(e))||MR(n).getPropertyValue(yv(e));Object.keys(e).forEach(function(d){var m=e[d];!m&&m!==0?n.style.removeProperty(yv(d)):kR(d)?h+=d+"("+m+") ":r+=yv(d)+": "+m+";"}),h&&(r+="transform: "+h+";"),n.style.cssText+=";"+r}var xx={exports:{}},wx,N2;function OR(){if(N2)return wx;N2=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return wx=n,wx}var Tx,j2;function PR(){if(j2)return Tx;j2=1;var n=OR();function e(){}function r(){}return r.resetWarningCache=e,Tx=function(){function h(y,c,E,C,k,z){if(z!==n){var F=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw F.name="Invariant Violation",F}}h.isRequired=h;function d(){return h}var m={array:h,bigint:h,bool:h,func:h,number:h,object:h,string:h,symbol:h,any:h,arrayOf:d,element:h,elementType:h,instanceOf:d,node:h,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:r,resetWarningCache:e};return m.PropTypes=m,m},Tx}var F2;function LR(){return F2||(F2=1,xx.exports=PR()()),xx.exports}var zR=LR();const xd=fm(zR),B2={disabled:!1},DE=El.createContext(null);var NR=function(e){return e.scrollTop},w_="unmounted",Mf="exited",cu="entering",hd="entered",V_="exiting",Od=function(n){xR(e,n);function e(h,d){var m;m=n.call(this,h,d)||this;var y=d,c=y&&!y.isMounting?h.enter:h.appear,E;return m.appearStatus=null,h.in?c?(E=Mf,m.appearStatus=cu):E=hd:h.unmountOnExit||h.mountOnEnter?E=w_:E=Mf,m.state={status:E},m.nextCallback=null,m}e.getDerivedStateFromProps=function(d,m){var y=d.in;return y&&m.status===w_?{status:Mf}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(d){var m=null;if(d!==this.props){var y=this.state.status;this.props.in?y!==cu&&y!==hd&&(m=cu):(y===cu||y===hd)&&(m=V_)}this.updateStatus(!1,m)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var d=this.props.timeout,m,y,c;return m=y=c=d,d!=null&&typeof d!="number"&&(m=d.exit,y=d.enter,c=d.appear!==void 0?d.appear:y),{exit:m,enter:y,appear:c}},r.updateStatus=function(d,m){if(d===void 0&&(d=!1),m!==null)if(this.cancelNextCallback(),m===cu){if(this.props.unmountOnExit||this.props.mountOnEnter){var y=this.props.nodeRef?this.props.nodeRef.current:Wp.findDOMNode(this);y&&NR(y)}this.performEnter(d)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Mf&&this.setState({status:w_})},r.performEnter=function(d){var m=this,y=this.props.enter,c=this.context?this.context.isMounting:d,E=this.props.nodeRef?[c]:[Wp.findDOMNode(this),c],C=E[0],k=E[1],z=this.getTimeouts(),F=c?z.appear:z.enter;if(!d&&!y||B2.disabled){this.safeSetState({status:hd},function(){m.props.onEntered(C)});return}this.props.onEnter(C,k),this.safeSetState({status:cu},function(){m.props.onEntering(C,k),m.onTransitionEnd(F,function(){m.safeSetState({status:hd},function(){m.props.onEntered(C,k)})})})},r.performExit=function(){var d=this,m=this.props.exit,y=this.getTimeouts(),c=this.props.nodeRef?void 0:Wp.findDOMNode(this);if(!m||B2.disabled){this.safeSetState({status:Mf},function(){d.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:V_},function(){d.props.onExiting(c),d.onTransitionEnd(y.exit,function(){d.safeSetState({status:Mf},function(){d.props.onExited(c)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(d,m){m=this.setNextCallback(m),this.setState(d,m)},r.setNextCallback=function(d){var m=this,y=!0;return this.nextCallback=function(c){y&&(y=!1,m.nextCallback=null,d(c))},this.nextCallback.cancel=function(){y=!1},this.nextCallback},r.onTransitionEnd=function(d,m){this.setNextCallback(m);var y=this.props.nodeRef?this.props.nodeRef.current:Wp.findDOMNode(this),c=d==null&&!this.props.addEndListener;if(!y||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var E=this.props.nodeRef?[this.nextCallback]:[y,this.nextCallback],C=E[0],k=E[1];this.props.addEndListener(C,k)}d!=null&&setTimeout(this.nextCallback,d)},r.render=function(){var d=this.state.status;if(d===w_)return null;var m=this.props,y=m.children;m.in,m.mountOnEnter,m.unmountOnExit,m.appear,m.enter,m.exit,m.timeout,m.addEndListener,m.onEnter,m.onEntering,m.onEntered,m.onExit,m.onExiting,m.onExited,m.nodeRef;var c=$1(m,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return El.createElement(DE.Provider,{value:null},typeof y=="function"?y(d,c):El.cloneElement(El.Children.only(y),c))},e}(El.Component);Od.contextType=DE;Od.propTypes={};function yg(){}Od.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:yg,onEntering:yg,onEntered:yg,onExit:yg,onExiting:yg,onExited:yg};Od.UNMOUNTED=w_;Od.EXITED=Mf;Od.ENTERING=cu;Od.ENTERED=hd;Od.EXITING=V_;function IE(n){return n.code==="Escape"||n.keyCode===27}function jR(){const n=K.version.split(".");return{major:+n[0],minor:+n[1],patch:+n[2]}}function ey(n){if(!n||typeof n=="function")return null;const{major:e}=jR();return e>=19?n.props.ref:n.ref}const ty=!!(typeof window<"u"&&window.document&&window.document.createElement);var Kx=!1,Jx=!1;try{var Sx={get passive(){return Kx=!0},get once(){return Jx=Kx=!0}};ty&&(window.addEventListener("test",Sx,Sx),window.removeEventListener("test",Sx,!0))}catch{}function RE(n,e,r,h){if(h&&typeof h!="boolean"&&!Jx){var d=h.once,m=h.capture,y=r;!Jx&&d&&(y=r.__once||function c(E){this.removeEventListener(e,c,m),r.call(this,E)},r.__once=y),n.addEventListener(e,y,Kx?h:m)}n.addEventListener(e,r,h)}function e1(n,e,r,h){var d=h&&typeof h!="boolean"?h.capture:h;n.removeEventListener(e,r,d),r.__once&&n.removeEventListener(e,r.__once,d)}function md(n,e,r,h){return RE(n,e,r,h),function(){e1(n,e,r,h)}}function FR(n,e,r,h){if(h===void 0&&(h=!0),n){var d=document.createEvent("HTMLEvents");d.initEvent(e,r,h),n.dispatchEvent(d)}}function BR(n){var e=bd(n,"transitionDuration")||"",r=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*r}function UR(n,e,r){r===void 0&&(r=5);var h=!1,d=setTimeout(function(){h||FR(n,"transitionend",!0)},e+r),m=md(n,"transitionend",function(){h=!0},{once:!0});return function(){clearTimeout(d),m()}}function kE(n,e,r,h){r==null&&(r=BR(n)||0);var d=UR(n,r,h),m=md(n,"transitionend",e);return function(){d(),m()}}function U2(n,e){const r=bd(n,e)||"",h=r.indexOf("ms")===-1?1e3:1;return parseFloat(r)*h}function Y1(n,e){const r=U2(n,"transitionDuration"),h=U2(n,"transitionDelay"),d=kE(n,m=>{m.target===n&&(d(),e(m))},r+h)}function d_(...n){return n.filter(e=>e!=null).reduce((e,r)=>{if(typeof r!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return e===null?r:function(...d){e.apply(this,d),r.apply(this,d)}},null)}function OE(n){n.offsetHeight}const V2=n=>!n||typeof n=="function"?n:e=>{n.current=e};function VR(n,e){const r=V2(n),h=V2(e);return d=>{r&&r(d),h&&h(d)}}function H1(n,e){return K.useMemo(()=>VR(n,e),[n,e])}function t1(n){return n&&"setState"in n?Wp.findDOMNode(n):n??null}const bb=El.forwardRef(({onEnter:n,onEntering:e,onEntered:r,onExit:h,onExiting:d,onExited:m,addEndListener:y,children:c,childRef:E,...C},k)=>{const z=K.useRef(null),F=H1(z,E),B=Me=>{F(t1(Me))},Q=Me=>Fe=>{Me&&z.current&&Me(z.current,Fe)},ie=K.useCallback(Q(n),[n]),ne=K.useCallback(Q(e),[e]),ue=K.useCallback(Q(r),[r]),Ae=K.useCallback(Q(h),[h]),Te=K.useCallback(Q(d),[d]),ke=K.useCallback(Q(m),[m]),be=K.useCallback(Q(y),[y]);return X.jsx(Od,{ref:k,...C,onEnter:ie,onEntered:ue,onEntering:ne,onExit:Ae,onExited:ke,onExiting:Te,addEndListener:be,nodeRef:z,children:typeof c=="function"?(Me,Fe)=>c(Me,{...Fe,ref:B}):El.cloneElement(c,{ref:B})})});bb.displayName="TransitionWrapper";const GR={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function $R(n,e){const r=`offset${n[0].toUpperCase()}${n.slice(1)}`,h=e[r],d=GR[n];return h+parseInt(bd(e,d[0]),10)+parseInt(bd(e,d[1]),10)}const ZR={[Mf]:"collapse",[V_]:"collapsing",[cu]:"collapsing",[hd]:"collapse show"},q1=El.forwardRef(({onEnter:n,onEntering:e,onEntered:r,onExit:h,onExiting:d,className:m,children:y,dimension:c="height",in:E=!1,timeout:C=300,mountOnEnter:k=!1,unmountOnExit:z=!1,appear:F=!1,getDimensionValue:B=$R,...Q},ie)=>{const ne=typeof c=="function"?c():c,ue=K.useMemo(()=>d_(Me=>{Me.style[ne]="0"},n),[ne,n]),Ae=K.useMemo(()=>d_(Me=>{const Fe=`scroll${ne[0].toUpperCase()}${ne.slice(1)}`;Me.style[ne]=`${Me[Fe]}px`},e),[ne,e]),Te=K.useMemo(()=>d_(Me=>{Me.style[ne]=null},r),[ne,r]),ke=K.useMemo(()=>d_(Me=>{Me.style[ne]=`${B(ne,Me)}px`,OE(Me)},h),[h,B,ne]),be=K.useMemo(()=>d_(Me=>{Me.style[ne]=null},d),[ne,d]);return X.jsx(bb,{ref:ie,addEndListener:Y1,...Q,"aria-expanded":Q.role?E:null,onEnter:ue,onEntering:Ae,onEntered:Te,onExit:ke,onExiting:be,childRef:ey(y),in:E,timeout:C,mountOnEnter:k,unmountOnExit:z,appear:F,children:(Me,Fe)=>El.cloneElement(y,{...Fe,className:pn(m,y.props.className,ZR[Me],ne==="width"&&"collapse-horizontal")})})});q1.displayName="Collapse";function PE(n,e){return Array.isArray(n)?n.includes(e):n===e}const o0=K.createContext({});o0.displayName="AccordionContext";const X1=K.forwardRef(({as:n="div",bsPrefix:e,className:r,children:h,eventKey:d,...m},y)=>{const{activeEventKey:c}=K.useContext(o0);return e=Pn(e,"accordion-collapse"),X.jsx(q1,{ref:y,in:PE(c,d),...m,className:pn(r,e),children:X.jsx(n,{children:K.Children.only(h)})})});X1.displayName="AccordionCollapse";const xb=K.createContext({eventKey:""});xb.displayName="AccordionItemContext";const LE=K.forwardRef(({as:n="div",bsPrefix:e,className:r,onEnter:h,onEntering:d,onEntered:m,onExit:y,onExiting:c,onExited:E,...C},k)=>{e=Pn(e,"accordion-body");const{eventKey:z}=K.useContext(xb);return X.jsx(X1,{eventKey:z,onEnter:h,onEntering:d,onEntered:m,onExit:y,onExiting:c,onExited:E,children:X.jsx(n,{ref:k,...C,className:pn(r,e)})})});LE.displayName="AccordionBody";function YR(n,e){const{activeEventKey:r,onSelect:h,alwaysOpen:d}=K.useContext(o0);return m=>{let y=n===r?null:n;d&&(Array.isArray(r)?r.includes(n)?y=r.filter(c=>c!==n):y=[...r,n]:y=[n]),h?.(y,m),e?.(m)}}const W1=K.forwardRef(({as:n="button",bsPrefix:e,className:r,onClick:h,...d},m)=>{e=Pn(e,"accordion-button");const{eventKey:y}=K.useContext(xb),c=YR(y,h),{activeEventKey:E}=K.useContext(o0);return n==="button"&&(d.type="button"),X.jsx(n,{ref:m,onClick:c,...d,"aria-expanded":Array.isArray(E)?E.includes(y):y===E,className:pn(r,e,!PE(E,y)&&"collapsed")})});W1.displayName="AccordionButton";const zE=K.forwardRef(({as:n="h2","aria-controls":e,bsPrefix:r,className:h,children:d,onClick:m,...y},c)=>(r=Pn(r,"accordion-header"),X.jsx(n,{ref:c,...y,className:pn(h,r),children:X.jsx(W1,{onClick:m,"aria-controls":e,children:d})})));zE.displayName="AccordionHeader";const NE=K.forwardRef(({as:n="div",bsPrefix:e,className:r,eventKey:h,...d},m)=>{e=Pn(e,"accordion-item");const y=K.useMemo(()=>({eventKey:h}),[h]);return X.jsx(xb.Provider,{value:y,children:X.jsx(n,{ref:m,...d,className:pn(r,e)})})});NE.displayName="AccordionItem";const jE=K.forwardRef((n,e)=>{const{as:r="div",activeKey:h,bsPrefix:d,className:m,onSelect:y,flush:c,alwaysOpen:E,...C}=CE(n,{activeKey:"onSelect"}),k=Pn(d,"accordion"),z=K.useMemo(()=>({activeEventKey:h,onSelect:y,alwaysOpen:E}),[h,y,E]);return X.jsx(o0.Provider,{value:z,children:X.jsx(r,{ref:e,...C,className:pn(m,k,c&&`${k}-flush`)})})});jE.displayName="Accordion";const _v=Object.assign(jE,{Button:W1,Collapse:X1,Item:NE,Header:zE,Body:LE});function HR(n){const e=K.useRef(n);return K.useEffect(()=>{e.current=n},[n]),e}function rm(n){const e=HR(n);return K.useCallback(function(...r){return e.current&&e.current(...r)},[e])}const FE=n=>K.forwardRef((e,r)=>X.jsx("div",{...e,ref:r,className:pn(e.className,n)}));function G2(){return K.useState(null)}function qR(n){const e=K.useRef(n);return K.useEffect(()=>{e.current=n},[n]),e}function eh(n){const e=qR(n);return K.useCallback(function(...r){return e.current&&e.current(...r)},[e])}function BE(){const n=K.useRef(!0),e=K.useRef(()=>n.current);return K.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),e.current}function XR(n){const e=K.useRef(null);return K.useEffect(()=>{e.current=n}),e.current}const WR=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",QR=typeof document<"u",$2=QR||WR?K.useLayoutEffect:K.useEffect,KR=["as","disabled"];function JR(n,e){if(n==null)return{};var r={};for(var h in n)if({}.hasOwnProperty.call(n,h)){if(e.indexOf(h)>=0)continue;r[h]=n[h]}return r}function ek(n){return!n||n.trim()==="#"}function UE({tagName:n,disabled:e,href:r,target:h,rel:d,role:m,onClick:y,tabIndex:c=0,type:E}){n||(r!=null||h!=null||d!=null?n="a":n="button");const C={tagName:n};if(n==="button")return[{type:E||"button",disabled:e},C];const k=F=>{if((e||n==="a"&&ek(r))&&F.preventDefault(),e){F.stopPropagation();return}y?.(F)},z=F=>{F.key===" "&&(F.preventDefault(),k(F))};return n==="a"&&(r||(r="#"),e&&(r=void 0)),[{role:m??"button",disabled:void 0,tabIndex:e?void 0:c,href:r,target:n==="a"?h:void 0,"aria-disabled":e||void 0,rel:n==="a"?d:void 0,onClick:k,onKeyDown:z},C]}const tk=K.forwardRef((n,e)=>{let{as:r,disabled:h}=n,d=JR(n,KR);const[m,{tagName:y}]=UE(Object.assign({tagName:r,disabled:h},d));return X.jsx(y,Object.assign({},d,m,{ref:e}))});tk.displayName="Button";const nk={[cu]:"show",[hd]:"show"},Lg=K.forwardRef(({className:n,children:e,transitionClasses:r={},onEnter:h,...d},m)=>{const y={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...d},c=K.useCallback((E,C)=>{OE(E),h?.(E,C)},[h]);return X.jsx(bb,{ref:m,addEndListener:Y1,...y,onEnter:c,childRef:ey(e),children:(E,C)=>K.cloneElement(e,{...C,className:pn("fade",n,e.props.className,nk[E],r[E])})})});Lg.displayName="Fade";const ik={"aria-label":xd.string,onClick:xd.func,variant:xd.oneOf(["white"])},Q1=K.forwardRef(({className:n,variant:e,"aria-label":r="Close",...h},d)=>X.jsx("button",{ref:d,type:"button",className:pn("btn-close",e&&`btn-close-${e}`,n),"aria-label":r,...h}));Q1.displayName="CloseButton";Q1.propTypes=ik;const Of=K.forwardRef(({as:n,bsPrefix:e,variant:r="primary",size:h,active:d=!1,disabled:m=!1,className:y,...c},E)=>{const C=Pn(e,"btn"),[k,{tagName:z}]=UE({tagName:n,disabled:m,...c}),F=z;return X.jsx(F,{...k,...c,ref:E,disabled:m,className:pn(y,C,d&&"active",r&&`${C}-${r}`,h&&`${C}-${h}`,c.href&&m&&"disabled")})});Of.displayName="Button";const K1=K.forwardRef(({bsPrefix:n,size:e,vertical:r=!1,className:h,role:d="group",as:m="div",...y},c)=>{const E=Pn(n,"btn-group");let C=E;return r&&(C=`${E}-vertical`),X.jsx(m,{...y,ref:c,role:d,className:pn(h,C,e&&`${E}-${e}`)})});K1.displayName="ButtonGroup";function rk(n){const e=K.useRef(n);return e.current=n,e}function ak(n){const e=rk(n);K.useEffect(()=>()=>e.current(),[])}function ok(n,e){return K.Children.toArray(n).some(r=>K.isValidElement(r)&&r.type===e)}function sk({as:n,bsPrefix:e,className:r,...h}){e=Pn(e,"col");const d=SR(),m=ER(),y=[],c=[];return d.forEach(E=>{const C=h[E];delete h[E];let k,z,F;typeof C=="object"&&C!=null?{span:k,offset:z,order:F}=C:k=C;const B=E!==m?`-${E}`:"";k&&y.push(k===!0?`${e}${B}`:`${e}${B}-${k}`),F!=null&&c.push(`order${B}-${F}`),z!=null&&c.push(`offset${B}-${z}`)}),[{...h,className:pn(r,...y,...c)},{as:n,bsPrefix:e,spans:y}]}const VE=K.forwardRef((n,e)=>{const[{className:r,...h},{as:d="div",bsPrefix:m,spans:y}]=sk(n);return X.jsx(d,{...h,ref:e,className:pn(r,!y.length&&m)})});VE.displayName="Col";var lk=Function.prototype.bind.call(Function.prototype.call,[].slice);function _g(n,e){return lk(n.querySelectorAll(e))}var Z2=Object.prototype.hasOwnProperty;function Y2(n,e,r){for(r of n.keys())if(k_(r,e))return r}function k_(n,e){var r,h,d;if(n===e)return!0;if(n&&e&&(r=n.constructor)===e.constructor){if(r===Date)return n.getTime()===e.getTime();if(r===RegExp)return n.toString()===e.toString();if(r===Array){if((h=n.length)===e.length)for(;h--&&k_(n[h],e[h]););return h===-1}if(r===Set){if(n.size!==e.size)return!1;for(h of n)if(d=h,d&&typeof d=="object"&&(d=Y2(e,d),!d)||!e.has(d))return!1;return!0}if(r===Map){if(n.size!==e.size)return!1;for(h of n)if(d=h[0],d&&typeof d=="object"&&(d=Y2(e,d),!d)||!k_(h[1],e.get(d)))return!1;return!0}if(r===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(r===DataView){if((h=n.byteLength)===e.byteLength)for(;h--&&n.getInt8(h)===e.getInt8(h););return h===-1}if(ArrayBuffer.isView(n)){if((h=n.byteLength)===e.byteLength)for(;h--&&n[h]===e[h];);return h===-1}if(!r||typeof n=="object"){h=0;for(r in n)if(Z2.call(n,r)&&++h&&!Z2.call(e,r)||!(r in e)||!k_(n[r],e[r]))return!1;return Object.keys(e).length===h}}return n!==n&&e!==e}function ck(n){const e=BE();return[n[0],K.useCallback(r=>{if(e())return n[1](r)},[e,n[1]])]}var Gs="top",vc="bottom",bc="right",$s="left",J1="auto",s0=[Gs,vc,bc,$s],zg="start",G_="end",uk="clippingParents",GE="viewport",f_="popper",hk="reference",H2=s0.reduce(function(n,e){return n.concat([e+"-"+zg,e+"-"+G_])},[]),$E=[].concat(s0,[J1]).reduce(function(n,e){return n.concat([e,e+"-"+zg,e+"-"+G_])},[]),dk="beforeRead",fk="read",pk="afterRead",mk="beforeMain",gk="main",yk="afterMain",_k="beforeWrite",vk="write",bk="afterWrite",xk=[dk,fk,pk,mk,gk,yk,_k,vk,bk];function oh(n){return n.split("-")[0]}function Il(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function am(n){var e=Il(n).Element;return n instanceof e||n instanceof Element}function sh(n){var e=Il(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function ew(n){if(typeof ShadowRoot>"u")return!1;var e=Il(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}var Jp=Math.max,Vv=Math.min,Ng=Math.round;function n1(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ZE(){return!/^((?!chrome|android).)*safari/i.test(n1())}function jg(n,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var h=n.getBoundingClientRect(),d=1,m=1;e&&sh(n)&&(d=n.offsetWidth>0&&Ng(h.width)/n.offsetWidth||1,m=n.offsetHeight>0&&Ng(h.height)/n.offsetHeight||1);var y=am(n)?Il(n):window,c=y.visualViewport,E=!ZE()&&r,C=(h.left+(E&&c?c.offsetLeft:0))/d,k=(h.top+(E&&c?c.offsetTop:0))/m,z=h.width/d,F=h.height/m;return{width:z,height:F,top:k,right:C+z,bottom:k+F,left:C,x:C,y:k}}function tw(n){var e=jg(n),r=n.offsetWidth,h=n.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-h)<=1&&(h=e.height),{x:n.offsetLeft,y:n.offsetTop,width:r,height:h}}function YE(n,e){var r=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(r&&ew(r)){var h=e;do{if(h&&n.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function zf(n){return n?(n.nodeName||"").toLowerCase():null}function Cd(n){return Il(n).getComputedStyle(n)}function wk(n){return["table","td","th"].indexOf(zf(n))>=0}function Vf(n){return((am(n)?n.ownerDocument:n.document)||window.document).documentElement}function wb(n){return zf(n)==="html"?n:n.assignedSlot||n.parentNode||(ew(n)?n.host:null)||Vf(n)}function q2(n){return!sh(n)||Cd(n).position==="fixed"?null:n.offsetParent}function Tk(n){var e=/firefox/i.test(n1()),r=/Trident/i.test(n1());if(r&&sh(n)){var h=Cd(n);if(h.position==="fixed")return null}var d=wb(n);for(ew(d)&&(d=d.host);sh(d)&&["html","body"].indexOf(zf(d))<0;){var m=Cd(d);if(m.transform!=="none"||m.perspective!=="none"||m.contain==="paint"||["transform","perspective"].indexOf(m.willChange)!==-1||e&&m.willChange==="filter"||e&&m.filter&&m.filter!=="none")return d;d=d.parentNode}return null}function l0(n){for(var e=Il(n),r=q2(n);r&&wk(r)&&Cd(r).position==="static";)r=q2(r);return r&&(zf(r)==="html"||zf(r)==="body"&&Cd(r).position==="static")?e:r||Tk(n)||e}function nw(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function O_(n,e,r){return Jp(n,Vv(e,r))}function Sk(n,e,r){var h=O_(n,e,r);return h>r?r:h}function HE(){return{top:0,right:0,bottom:0,left:0}}function qE(n){return Object.assign({},HE(),n)}function XE(n,e){return e.reduce(function(r,h){return r[h]=n,r},{})}var Ek=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,qE(typeof e!="number"?e:XE(e,s0))};function Ak(n){var e,r=n.state,h=n.name,d=n.options,m=r.elements.arrow,y=r.modifiersData.popperOffsets,c=oh(r.placement),E=nw(c),C=[$s,bc].indexOf(c)>=0,k=C?"height":"width";if(!(!m||!y)){var z=Ek(d.padding,r),F=tw(m),B=E==="y"?Gs:$s,Q=E==="y"?vc:bc,ie=r.rects.reference[k]+r.rects.reference[E]-y[E]-r.rects.popper[k],ne=y[E]-r.rects.reference[E],ue=l0(m),Ae=ue?E==="y"?ue.clientHeight||0:ue.clientWidth||0:0,Te=ie/2-ne/2,ke=z[B],be=Ae-F[k]-z[Q],Me=Ae/2-F[k]/2+Te,Fe=O_(ke,Me,be),ot=E;r.modifiersData[h]=(e={},e[ot]=Fe,e.centerOffset=Fe-Me,e)}}function Mk(n){var e=n.state,r=n.options,h=r.element,d=h===void 0?"[data-popper-arrow]":h;d!=null&&(typeof d=="string"&&(d=e.elements.popper.querySelector(d),!d)||YE(e.elements.popper,d)&&(e.elements.arrow=d))}const Ck={name:"arrow",enabled:!0,phase:"main",fn:Ak,effect:Mk,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Fg(n){return n.split("-")[1]}var Dk={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ik(n,e){var r=n.x,h=n.y,d=e.devicePixelRatio||1;return{x:Ng(r*d)/d||0,y:Ng(h*d)/d||0}}function X2(n){var e,r=n.popper,h=n.popperRect,d=n.placement,m=n.variation,y=n.offsets,c=n.position,E=n.gpuAcceleration,C=n.adaptive,k=n.roundOffsets,z=n.isFixed,F=y.x,B=F===void 0?0:F,Q=y.y,ie=Q===void 0?0:Q,ne=typeof k=="function"?k({x:B,y:ie}):{x:B,y:ie};B=ne.x,ie=ne.y;var ue=y.hasOwnProperty("x"),Ae=y.hasOwnProperty("y"),Te=$s,ke=Gs,be=window;if(C){var Me=l0(r),Fe="clientHeight",ot="clientWidth";if(Me===Il(r)&&(Me=Vf(r),Cd(Me).position!=="static"&&c==="absolute"&&(Fe="scrollHeight",ot="scrollWidth")),Me=Me,d===Gs||(d===$s||d===bc)&&m===G_){ke=vc;var Ee=z&&Me===be&&be.visualViewport?be.visualViewport.height:Me[Fe];ie-=Ee-h.height,ie*=E?1:-1}if(d===$s||(d===Gs||d===vc)&&m===G_){Te=bc;var Je=z&&Me===be&&be.visualViewport?be.visualViewport.width:Me[ot];B-=Je-h.width,B*=E?1:-1}}var Et=Object.assign({position:c},C&&Dk),Tt=k===!0?Ik({x:B,y:ie},Il(r)):{x:B,y:ie};if(B=Tt.x,ie=Tt.y,E){var zt;return Object.assign({},Et,(zt={},zt[ke]=Ae?"0":"",zt[Te]=ue?"0":"",zt.transform=(be.devicePixelRatio||1)<=1?"translate("+B+"px, "+ie+"px)":"translate3d("+B+"px, "+ie+"px, 0)",zt))}return Object.assign({},Et,(e={},e[ke]=Ae?ie+"px":"",e[Te]=ue?B+"px":"",e.transform="",e))}function Rk(n){var e=n.state,r=n.options,h=r.gpuAcceleration,d=h===void 0?!0:h,m=r.adaptive,y=m===void 0?!0:m,c=r.roundOffsets,E=c===void 0?!0:c,C={placement:oh(e.placement),variation:Fg(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:d,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,X2(Object.assign({},C,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:y,roundOffsets:E})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,X2(Object.assign({},C,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:E})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const kk={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Rk,data:{}};var vv={passive:!0};function Ok(n){var e=n.state,r=n.instance,h=n.options,d=h.scroll,m=d===void 0?!0:d,y=h.resize,c=y===void 0?!0:y,E=Il(e.elements.popper),C=[].concat(e.scrollParents.reference,e.scrollParents.popper);return m&&C.forEach(function(k){k.addEventListener("scroll",r.update,vv)}),c&&E.addEventListener("resize",r.update,vv),function(){m&&C.forEach(function(k){k.removeEventListener("scroll",r.update,vv)}),c&&E.removeEventListener("resize",r.update,vv)}}const Pk={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ok,data:{}};var Lk={left:"right",right:"left",bottom:"top",top:"bottom"};function kv(n){return n.replace(/left|right|bottom|top/g,function(e){return Lk[e]})}var zk={start:"end",end:"start"};function W2(n){return n.replace(/start|end/g,function(e){return zk[e]})}function iw(n){var e=Il(n),r=e.pageXOffset,h=e.pageYOffset;return{scrollLeft:r,scrollTop:h}}function rw(n){return jg(Vf(n)).left+iw(n).scrollLeft}function Nk(n,e){var r=Il(n),h=Vf(n),d=r.visualViewport,m=h.clientWidth,y=h.clientHeight,c=0,E=0;if(d){m=d.width,y=d.height;var C=ZE();(C||!C&&e==="fixed")&&(c=d.offsetLeft,E=d.offsetTop)}return{width:m,height:y,x:c+rw(n),y:E}}function jk(n){var e,r=Vf(n),h=iw(n),d=(e=n.ownerDocument)==null?void 0:e.body,m=Jp(r.scrollWidth,r.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),y=Jp(r.scrollHeight,r.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),c=-h.scrollLeft+rw(n),E=-h.scrollTop;return Cd(d||r).direction==="rtl"&&(c+=Jp(r.clientWidth,d?d.clientWidth:0)-m),{width:m,height:y,x:c,y:E}}function aw(n){var e=Cd(n),r=e.overflow,h=e.overflowX,d=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+d+h)}function WE(n){return["html","body","#document"].indexOf(zf(n))>=0?n.ownerDocument.body:sh(n)&&aw(n)?n:WE(wb(n))}function P_(n,e){var r;e===void 0&&(e=[]);var h=WE(n),d=h===((r=n.ownerDocument)==null?void 0:r.body),m=Il(h),y=d?[m].concat(m.visualViewport||[],aw(h)?h:[]):h,c=e.concat(y);return d?c:c.concat(P_(wb(y)))}function i1(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Fk(n,e){var r=jg(n,!1,e==="fixed");return r.top=r.top+n.clientTop,r.left=r.left+n.clientLeft,r.bottom=r.top+n.clientHeight,r.right=r.left+n.clientWidth,r.width=n.clientWidth,r.height=n.clientHeight,r.x=r.left,r.y=r.top,r}function Q2(n,e,r){return e===GE?i1(Nk(n,r)):am(e)?Fk(e,r):i1(jk(Vf(n)))}function Bk(n){var e=P_(wb(n)),r=["absolute","fixed"].indexOf(Cd(n).position)>=0,h=r&&sh(n)?l0(n):n;return am(h)?e.filter(function(d){return am(d)&&YE(d,h)&&zf(d)!=="body"}):[]}function Uk(n,e,r,h){var d=e==="clippingParents"?Bk(n):[].concat(e),m=[].concat(d,[r]),y=m[0],c=m.reduce(function(E,C){var k=Q2(n,C,h);return E.top=Jp(k.top,E.top),E.right=Vv(k.right,E.right),E.bottom=Vv(k.bottom,E.bottom),E.left=Jp(k.left,E.left),E},Q2(n,y,h));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function QE(n){var e=n.reference,r=n.element,h=n.placement,d=h?oh(h):null,m=h?Fg(h):null,y=e.x+e.width/2-r.width/2,c=e.y+e.height/2-r.height/2,E;switch(d){case Gs:E={x:y,y:e.y-r.height};break;case vc:E={x:y,y:e.y+e.height};break;case bc:E={x:e.x+e.width,y:c};break;case $s:E={x:e.x-r.width,y:c};break;default:E={x:e.x,y:e.y}}var C=d?nw(d):null;if(C!=null){var k=C==="y"?"height":"width";switch(m){case zg:E[C]=E[C]-(e[k]/2-r[k]/2);break;case G_:E[C]=E[C]+(e[k]/2-r[k]/2);break}}return E}function $_(n,e){e===void 0&&(e={});var r=e,h=r.placement,d=h===void 0?n.placement:h,m=r.strategy,y=m===void 0?n.strategy:m,c=r.boundary,E=c===void 0?uk:c,C=r.rootBoundary,k=C===void 0?GE:C,z=r.elementContext,F=z===void 0?f_:z,B=r.altBoundary,Q=B===void 0?!1:B,ie=r.padding,ne=ie===void 0?0:ie,ue=qE(typeof ne!="number"?ne:XE(ne,s0)),Ae=F===f_?hk:f_,Te=n.rects.popper,ke=n.elements[Q?Ae:F],be=Uk(am(ke)?ke:ke.contextElement||Vf(n.elements.popper),E,k,y),Me=jg(n.elements.reference),Fe=QE({reference:Me,element:Te,placement:d}),ot=i1(Object.assign({},Te,Fe)),Ee=F===f_?ot:Me,Je={top:be.top-Ee.top+ue.top,bottom:Ee.bottom-be.bottom+ue.bottom,left:be.left-Ee.left+ue.left,right:Ee.right-be.right+ue.right},Et=n.modifiersData.offset;if(F===f_&&Et){var Tt=Et[d];Object.keys(Je).forEach(function(zt){var Zt=[bc,vc].indexOf(zt)>=0?1:-1,Gt=[Gs,vc].indexOf(zt)>=0?"y":"x";Je[zt]+=Tt[Gt]*Zt})}return Je}function Vk(n,e){e===void 0&&(e={});var r=e,h=r.placement,d=r.boundary,m=r.rootBoundary,y=r.padding,c=r.flipVariations,E=r.allowedAutoPlacements,C=E===void 0?$E:E,k=Fg(h),z=k?c?H2:H2.filter(function(Q){return Fg(Q)===k}):s0,F=z.filter(function(Q){return C.indexOf(Q)>=0});F.length===0&&(F=z);var B=F.reduce(function(Q,ie){return Q[ie]=$_(n,{placement:ie,boundary:d,rootBoundary:m,padding:y})[oh(ie)],Q},{});return Object.keys(B).sort(function(Q,ie){return B[Q]-B[ie]})}function Gk(n){if(oh(n)===J1)return[];var e=kv(n);return[W2(n),e,W2(e)]}function $k(n){var e=n.state,r=n.options,h=n.name;if(!e.modifiersData[h]._skip){for(var d=r.mainAxis,m=d===void 0?!0:d,y=r.altAxis,c=y===void 0?!0:y,E=r.fallbackPlacements,C=r.padding,k=r.boundary,z=r.rootBoundary,F=r.altBoundary,B=r.flipVariations,Q=B===void 0?!0:B,ie=r.allowedAutoPlacements,ne=e.options.placement,ue=oh(ne),Ae=ue===ne,Te=E||(Ae||!Q?[kv(ne)]:Gk(ne)),ke=[ne].concat(Te).reduce(function(_t,Ot){return _t.concat(oh(Ot)===J1?Vk(e,{placement:Ot,boundary:k,rootBoundary:z,padding:C,flipVariations:Q,allowedAutoPlacements:ie}):Ot)},[]),be=e.rects.reference,Me=e.rects.popper,Fe=new Map,ot=!0,Ee=ke[0],Je=0;Je<ke.length;Je++){var Et=ke[Je],Tt=oh(Et),zt=Fg(Et)===zg,Zt=[Gs,vc].indexOf(Tt)>=0,Gt=Zt?"width":"height",Ue=$_(e,{placement:Et,boundary:k,rootBoundary:z,altBoundary:F,padding:C}),st=Zt?zt?bc:$s:zt?vc:Gs;be[Gt]>Me[Gt]&&(st=kv(st));var xt=kv(st),ut=[];if(m&&ut.push(Ue[Tt]<=0),c&&ut.push(Ue[st]<=0,Ue[xt]<=0),ut.every(function(_t){return _t})){Ee=Et,ot=!1;break}Fe.set(Et,ut)}if(ot)for(var Ut=Q?3:1,De=function(Ot){var jt=ke.find(function(Kt){var cn=Fe.get(Kt);if(cn)return cn.slice(0,Ot).every(function(mn){return mn})});if(jt)return Ee=jt,"break"},Qe=Ut;Qe>0;Qe--){var dt=De(Qe);if(dt==="break")break}e.placement!==Ee&&(e.modifiersData[h]._skip=!0,e.placement=Ee,e.reset=!0)}}const Zk={name:"flip",enabled:!0,phase:"main",fn:$k,requiresIfExists:["offset"],data:{_skip:!1}};function K2(n,e,r){return r===void 0&&(r={x:0,y:0}),{top:n.top-e.height-r.y,right:n.right-e.width+r.x,bottom:n.bottom-e.height+r.y,left:n.left-e.width-r.x}}function J2(n){return[Gs,bc,vc,$s].some(function(e){return n[e]>=0})}function Yk(n){var e=n.state,r=n.name,h=e.rects.reference,d=e.rects.popper,m=e.modifiersData.preventOverflow,y=$_(e,{elementContext:"reference"}),c=$_(e,{altBoundary:!0}),E=K2(y,h),C=K2(c,d,m),k=J2(E),z=J2(C);e.modifiersData[r]={referenceClippingOffsets:E,popperEscapeOffsets:C,isReferenceHidden:k,hasPopperEscaped:z},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":k,"data-popper-escaped":z})}const Hk={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Yk};function qk(n,e,r){var h=oh(n),d=[$s,Gs].indexOf(h)>=0?-1:1,m=typeof r=="function"?r(Object.assign({},e,{placement:n})):r,y=m[0],c=m[1];return y=y||0,c=(c||0)*d,[$s,bc].indexOf(h)>=0?{x:c,y}:{x:y,y:c}}function Xk(n){var e=n.state,r=n.options,h=n.name,d=r.offset,m=d===void 0?[0,0]:d,y=$E.reduce(function(k,z){return k[z]=qk(z,e.rects,m),k},{}),c=y[e.placement],E=c.x,C=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=E,e.modifiersData.popperOffsets.y+=C),e.modifiersData[h]=y}const Wk={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Xk};function Qk(n){var e=n.state,r=n.name;e.modifiersData[r]=QE({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Kk={name:"popperOffsets",enabled:!0,phase:"read",fn:Qk,data:{}};function Jk(n){return n==="x"?"y":"x"}function e3(n){var e=n.state,r=n.options,h=n.name,d=r.mainAxis,m=d===void 0?!0:d,y=r.altAxis,c=y===void 0?!1:y,E=r.boundary,C=r.rootBoundary,k=r.altBoundary,z=r.padding,F=r.tether,B=F===void 0?!0:F,Q=r.tetherOffset,ie=Q===void 0?0:Q,ne=$_(e,{boundary:E,rootBoundary:C,padding:z,altBoundary:k}),ue=oh(e.placement),Ae=Fg(e.placement),Te=!Ae,ke=nw(ue),be=Jk(ke),Me=e.modifiersData.popperOffsets,Fe=e.rects.reference,ot=e.rects.popper,Ee=typeof ie=="function"?ie(Object.assign({},e.rects,{placement:e.placement})):ie,Je=typeof Ee=="number"?{mainAxis:Ee,altAxis:Ee}:Object.assign({mainAxis:0,altAxis:0},Ee),Et=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Tt={x:0,y:0};if(Me){if(m){var zt,Zt=ke==="y"?Gs:$s,Gt=ke==="y"?vc:bc,Ue=ke==="y"?"height":"width",st=Me[ke],xt=st+ne[Zt],ut=st-ne[Gt],Ut=B?-ot[Ue]/2:0,De=Ae===zg?Fe[Ue]:ot[Ue],Qe=Ae===zg?-ot[Ue]:-Fe[Ue],dt=e.elements.arrow,_t=B&&dt?tw(dt):{width:0,height:0},Ot=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:HE(),jt=Ot[Zt],Kt=Ot[Gt],cn=O_(0,Fe[Ue],_t[Ue]),mn=Te?Fe[Ue]/2-Ut-cn-jt-Je.mainAxis:De-cn-jt-Je.mainAxis,lr=Te?-Fe[Ue]/2+Ut+cn+Kt+Je.mainAxis:Qe+cn+Kt+Je.mainAxis,cr=e.elements.arrow&&l0(e.elements.arrow),xi=cr?ke==="y"?cr.clientTop||0:cr.clientLeft||0:0,Wn=(zt=Et?.[ke])!=null?zt:0,Ln=st+mn-Wn-xi,Sn=st+lr-Wn,gr=O_(B?Vv(xt,Ln):xt,st,B?Jp(ut,Sn):ut);Me[ke]=gr,Tt[ke]=gr-st}if(c){var oa,po=ke==="x"?Gs:$s,Ar=ke==="x"?vc:bc,Br=Me[be],Ea=be==="y"?"height":"width",Ua=Br+ne[po],ga=Br-ne[Ar],Oi=[Gs,$s].indexOf(ue)!==-1,ys=(oa=Et?.[be])!=null?oa:0,dn=Oi?Ua:Br-Fe[Ea]-ot[Ea]-ys+Je.altAxis,Mr=Oi?Br+Fe[Ea]+ot[Ea]-ys-Je.altAxis:ga,ur=B&&Oi?Sk(dn,Br,Mr):O_(B?dn:Ua,Br,B?Mr:ga);Me[be]=ur,Tt[be]=ur-Br}e.modifiersData[h]=Tt}}const t3={name:"preventOverflow",enabled:!0,phase:"main",fn:e3,requiresIfExists:["offset"]};function n3(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function i3(n){return n===Il(n)||!sh(n)?iw(n):n3(n)}function r3(n){var e=n.getBoundingClientRect(),r=Ng(e.width)/n.offsetWidth||1,h=Ng(e.height)/n.offsetHeight||1;return r!==1||h!==1}function a3(n,e,r){r===void 0&&(r=!1);var h=sh(e),d=sh(e)&&r3(e),m=Vf(e),y=jg(n,d,r),c={scrollLeft:0,scrollTop:0},E={x:0,y:0};return(h||!h&&!r)&&((zf(e)!=="body"||aw(m))&&(c=i3(e)),sh(e)?(E=jg(e,!0),E.x+=e.clientLeft,E.y+=e.clientTop):m&&(E.x=rw(m))),{x:y.left+c.scrollLeft-E.x,y:y.top+c.scrollTop-E.y,width:y.width,height:y.height}}function o3(n){var e=new Map,r=new Set,h=[];n.forEach(function(m){e.set(m.name,m)});function d(m){r.add(m.name);var y=[].concat(m.requires||[],m.requiresIfExists||[]);y.forEach(function(c){if(!r.has(c)){var E=e.get(c);E&&d(E)}}),h.push(m)}return n.forEach(function(m){r.has(m.name)||d(m)}),h}function s3(n){var e=o3(n);return xk.reduce(function(r,h){return r.concat(e.filter(function(d){return d.phase===h}))},[])}function l3(n){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(n())})})),e}}function c3(n){var e=n.reduce(function(r,h){var d=r[h.name];return r[h.name]=d?Object.assign({},d,h,{options:Object.assign({},d.options,h.options),data:Object.assign({},d.data,h.data)}):h,r},{});return Object.keys(e).map(function(r){return e[r]})}var eT={placement:"bottom",modifiers:[],strategy:"absolute"};function tT(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return!e.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function u3(n){n===void 0&&(n={});var e=n,r=e.defaultModifiers,h=r===void 0?[]:r,d=e.defaultOptions,m=d===void 0?eT:d;return function(c,E,C){C===void 0&&(C=m);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},eT,m),modifiersData:{},elements:{reference:c,popper:E},attributes:{},styles:{}},z=[],F=!1,B={state:k,setOptions:function(ue){var Ae=typeof ue=="function"?ue(k.options):ue;ie(),k.options=Object.assign({},m,k.options,Ae),k.scrollParents={reference:am(c)?P_(c):c.contextElement?P_(c.contextElement):[],popper:P_(E)};var Te=s3(c3([].concat(h,k.options.modifiers)));return k.orderedModifiers=Te.filter(function(ke){return ke.enabled}),Q(),B.update()},forceUpdate:function(){if(!F){var ue=k.elements,Ae=ue.reference,Te=ue.popper;if(tT(Ae,Te)){k.rects={reference:a3(Ae,l0(Te),k.options.strategy==="fixed"),popper:tw(Te)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function(Je){return k.modifiersData[Je.name]=Object.assign({},Je.data)});for(var ke=0;ke<k.orderedModifiers.length;ke++){if(k.reset===!0){k.reset=!1,ke=-1;continue}var be=k.orderedModifiers[ke],Me=be.fn,Fe=be.options,ot=Fe===void 0?{}:Fe,Ee=be.name;typeof Me=="function"&&(k=Me({state:k,options:ot,name:Ee,instance:B})||k)}}}},update:l3(function(){return new Promise(function(ne){B.forceUpdate(),ne(k)})}),destroy:function(){ie(),F=!0}};if(!tT(c,E))return B;B.setOptions(C).then(function(ne){!F&&C.onFirstUpdate&&C.onFirstUpdate(ne)});function Q(){k.orderedModifiers.forEach(function(ne){var ue=ne.name,Ae=ne.options,Te=Ae===void 0?{}:Ae,ke=ne.effect;if(typeof ke=="function"){var be=ke({state:k,name:ue,instance:B,options:Te}),Me=function(){};z.push(be||Me)}})}function ie(){z.forEach(function(ne){return ne()}),z=[]}return B}}const h3=u3({defaultModifiers:[Hk,Kk,kk,Pk,Wk,Zk,t3,Ck]}),d3=["enabled","placement","strategy","modifiers"];function f3(n,e){if(n==null)return{};var r={};for(var h in n)if({}.hasOwnProperty.call(n,h)){if(e.indexOf(h)>=0)continue;r[h]=n[h]}return r}const p3={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},m3={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:n})=>()=>{const{reference:e,popper:r}=n.elements;if("removeAttribute"in e){const h=(e.getAttribute("aria-describedby")||"").split(",").filter(d=>d.trim()!==r.id);h.length?e.setAttribute("aria-describedby",h.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:n})=>{var e;const{popper:r,reference:h}=n.elements,d=(e=r.getAttribute("role"))==null?void 0:e.toLowerCase();if(r.id&&d==="tooltip"&&"setAttribute"in h){const m=h.getAttribute("aria-describedby");if(m&&m.split(",").indexOf(r.id)!==-1)return;h.setAttribute("aria-describedby",m?`${m},${r.id}`:r.id)}}},g3=[];function y3(n,e,r={}){let{enabled:h=!0,placement:d="bottom",strategy:m="absolute",modifiers:y=g3}=r,c=f3(r,d3);const E=K.useRef(y),C=K.useRef(),k=K.useCallback(()=>{var ne;(ne=C.current)==null||ne.update()},[]),z=K.useCallback(()=>{var ne;(ne=C.current)==null||ne.forceUpdate()},[]),[F,B]=ck(K.useState({placement:d,update:k,forceUpdate:z,attributes:{},styles:{popper:{},arrow:{}}})),Q=K.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:ne})=>{const ue={},Ae={};Object.keys(ne.elements).forEach(Te=>{ue[Te]=ne.styles[Te],Ae[Te]=ne.attributes[Te]}),B({state:ne,styles:ue,attributes:Ae,update:k,forceUpdate:z,placement:ne.placement})}}),[k,z,B]),ie=K.useMemo(()=>(k_(E.current,y)||(E.current=y),E.current),[y]);return K.useEffect(()=>{!C.current||!h||C.current.setOptions({placement:d,strategy:m,modifiers:[...ie,Q,p3]})},[m,d,Q,h,ie]),K.useEffect(()=>{if(!(!h||n==null||e==null))return C.current=h3(n,e,Object.assign({},c,{placement:d,strategy:m,modifiers:[...ie,m3,Q]})),()=>{C.current!=null&&(C.current.destroy(),C.current=void 0,B(ne=>Object.assign({},ne,{attributes:{},styles:{popper:{}}})))}},[h,n,e]),F}function Gv(n,e){if(n.contains)return n.contains(e);if(n.compareDocumentPosition)return n===e||!!(n.compareDocumentPosition(e)&16)}var Ex,nT;function _3(){if(nT)return Ex;nT=1;var n=function(){};return Ex=n,Ex}var v3=_3();const b3=fm(v3),iT=()=>{};function x3(n){return n.button===0}function w3(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}const Ov=n=>n&&("current"in n?n.current:n),rT={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function T3(n,e=iT,{disabled:r,clickTrigger:h="click"}={}){const d=K.useRef(!1),m=K.useRef(!1),y=K.useCallback(C=>{const k=Ov(n);b3(!!k,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),d.current=!k||w3(C)||!x3(C)||!!Gv(k,C.target)||m.current,m.current=!1},[n]),c=eh(C=>{const k=Ov(n);k&&Gv(k,C.target)?m.current=!0:m.current=!1}),E=eh(C=>{d.current||e(C)});K.useEffect(()=>{var C,k;if(r||n==null)return;const z=Jg(Ov(n)),F=z.defaultView||window;let B=(C=F.event)!=null?C:(k=F.parent)==null?void 0:k.event,Q=null;rT[h]&&(Q=md(z,rT[h],c,!0));const ie=md(z,h,y,!0),ne=md(z,h,Ae=>{if(Ae===B){B=void 0;return}E(Ae)});let ue=[];return"ontouchstart"in z.documentElement&&(ue=[].slice.call(z.body.children).map(Ae=>md(Ae,"mousemove",iT))),()=>{Q?.(),ie(),ne(),ue.forEach(Ae=>Ae())}},[n,r,h,y,c,E])}function S3(n){const e={};return Array.isArray(n)?(n?.forEach(r=>{e[r.name]=r}),e):n||e}function E3(n={}){return Array.isArray(n)?n:Object.keys(n).map(e=>(n[e].name=e,n[e]))}function A3({enabled:n,enableEvents:e,placement:r,flip:h,offset:d,fixed:m,containerPadding:y,arrowElement:c,popperConfig:E={}}){var C,k,z,F;const B=S3(E.modifiers);return Object.assign({},E,{placement:r,enabled:n,strategy:m?"fixed":E.strategy,modifiers:E3(Object.assign({},B,{eventListeners:{enabled:e,options:(C=B.eventListeners)==null?void 0:C.options},preventOverflow:Object.assign({},B.preventOverflow,{options:Object.assign({padding:y},(k=B.preventOverflow)==null?void 0:k.options)}),offset:{options:Object.assign({offset:d},(z=B.offset)==null?void 0:z.options)},arrow:Object.assign({},B.arrow,{enabled:!!c,options:Object.assign({},(F=B.arrow)==null?void 0:F.options,{element:c})}),flip:Object.assign({enabled:!!h},B.flip)}))})}const M3=K.createContext(null),C3="data-rr-ui-";function D3(n){return`${C3}${n}`}const KE=K.createContext(ty?window:void 0);KE.Provider;function ow(){return K.useContext(KE)}const I3=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",R3=typeof document<"u",JE=R3||I3?K.useLayoutEffect:K.useEffect,c0=K.createContext(null);c0.displayName="NavbarContext";const k3={type:xd.string,tooltip:xd.bool,as:xd.elementType},Tb=K.forwardRef(({as:n="div",className:e,type:r="valid",tooltip:h=!1,...d},m)=>X.jsx(n,{...d,ref:m,className:pn(e,`${r}-${h?"tooltip":"feedback"}`)}));Tb.displayName="Feedback";Tb.propTypes=k3;const Dd=K.createContext({}),sw=K.forwardRef(({id:n,bsPrefix:e,className:r,type:h="checkbox",isValid:d=!1,isInvalid:m=!1,as:y="input",...c},E)=>{const{controlId:C}=K.useContext(Dd);return e=Pn(e,"form-check-input"),X.jsx(y,{...c,ref:E,type:h,id:n||C,className:pn(r,e,d&&"is-valid",m&&"is-invalid")})});sw.displayName="FormCheckInput";const $v=K.forwardRef(({bsPrefix:n,className:e,htmlFor:r,...h},d)=>{const{controlId:m}=K.useContext(Dd);return n=Pn(n,"form-check-label"),X.jsx("label",{...h,ref:d,htmlFor:r||m,className:pn(e,n)})});$v.displayName="FormCheckLabel";const eA=K.forwardRef(({id:n,bsPrefix:e,bsSwitchPrefix:r,inline:h=!1,reverse:d=!1,disabled:m=!1,isValid:y=!1,isInvalid:c=!1,feedbackTooltip:E=!1,feedback:C,feedbackType:k,className:z,style:F,title:B="",type:Q="checkbox",label:ie,children:ne,as:ue="input",...Ae},Te)=>{e=Pn(e,"form-check"),r=Pn(r,"form-switch");const{controlId:ke}=K.useContext(Dd),be=K.useMemo(()=>({controlId:n||ke}),[ke,n]),Me=!ne&&ie!=null&&ie!==!1||ok(ne,$v),Fe=X.jsx(sw,{...Ae,type:Q==="switch"?"checkbox":Q,ref:Te,isValid:y,isInvalid:c,disabled:m,as:ue});return X.jsx(Dd.Provider,{value:be,children:X.jsx("div",{style:F,className:pn(z,Me&&e,h&&`${e}-inline`,d&&`${e}-reverse`,Q==="switch"&&r),children:ne||X.jsxs(X.Fragment,{children:[Fe,Me&&X.jsx($v,{title:B,children:ie}),C&&X.jsx(Tb,{type:k,tooltip:E,children:C})]})})})});eA.displayName="FormCheck";const Zv=Object.assign(eA,{Input:sw,Label:$v}),tA=K.forwardRef(({bsPrefix:n,type:e,size:r,htmlSize:h,id:d,className:m,isValid:y=!1,isInvalid:c=!1,plaintext:E,readOnly:C,as:k="input",...z},F)=>{const{controlId:B}=K.useContext(Dd);return n=Pn(n,"form-control"),X.jsx(k,{...z,type:e,size:h,ref:F,readOnly:C,id:d||B,className:pn(m,E?`${n}-plaintext`:n,r&&`${n}-${r}`,e==="color"&&`${n}-color`,y&&"is-valid",c&&"is-invalid")})});tA.displayName="FormControl";const O3=Object.assign(tA,{Feedback:Tb}),nA=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...h},d)=>(e=Pn(e,"form-floating"),X.jsx(r,{ref:d,className:pn(n,e),...h})));nA.displayName="FormFloating";const lw=K.forwardRef(({controlId:n,as:e="div",...r},h)=>{const d=K.useMemo(()=>({controlId:n}),[n]);return X.jsx(Dd.Provider,{value:d,children:X.jsx(e,{...r,ref:h})})});lw.displayName="FormGroup";const iA=K.forwardRef(({as:n="label",bsPrefix:e,column:r=!1,visuallyHidden:h=!1,className:d,htmlFor:m,...y},c)=>{const{controlId:E}=K.useContext(Dd);e=Pn(e,"form-label");let C="col-form-label";typeof r=="string"&&(C=`${C} ${C}-${r}`);const k=pn(d,e,h&&"visually-hidden",r&&C);return m=m||E,r?X.jsx(VE,{ref:c,as:"label",className:k,htmlFor:m,...y}):X.jsx(n,{ref:c,className:k,htmlFor:m,...y})});iA.displayName="FormLabel";const rA=K.forwardRef(({bsPrefix:n,className:e,id:r,...h},d)=>{const{controlId:m}=K.useContext(Dd);return n=Pn(n,"form-range"),X.jsx("input",{...h,type:"range",ref:d,className:pn(e,n),id:r||m})});rA.displayName="FormRange";const aA=K.forwardRef(({bsPrefix:n,size:e,htmlSize:r,className:h,isValid:d=!1,isInvalid:m=!1,id:y,...c},E)=>{const{controlId:C}=K.useContext(Dd);return n=Pn(n,"form-select"),X.jsx("select",{...c,size:r,ref:E,className:pn(h,n,e&&`${n}-${e}`,d&&"is-valid",m&&"is-invalid"),id:y||C})});aA.displayName="FormSelect";const oA=K.forwardRef(({bsPrefix:n,className:e,as:r="small",muted:h,...d},m)=>(n=Pn(n,"form-text"),X.jsx(r,{...d,ref:m,className:pn(e,n,h&&"text-muted")})));oA.displayName="FormText";const sA=K.forwardRef((n,e)=>X.jsx(Zv,{...n,ref:e,type:"switch"}));sA.displayName="Switch";const P3=Object.assign(sA,{Input:Zv.Input,Label:Zv.Label}),lA=K.forwardRef(({bsPrefix:n,className:e,children:r,controlId:h,label:d,...m},y)=>(n=Pn(n,"form-floating"),X.jsxs(lw,{ref:y,className:pn(e,n),controlId:h,...m,children:[r,X.jsx("label",{htmlFor:h,children:d})]})));lA.displayName="FloatingLabel";const L3={_ref:xd.any,validated:xd.bool,as:xd.elementType},cw=K.forwardRef(({className:n,validated:e,as:r="form",...h},d)=>X.jsx(r,{...h,ref:d,className:pn(n,e&&"was-validated")}));cw.displayName="Form";cw.propTypes=L3;const Bi=Object.assign(cw,{Group:lw,Control:O3,Floating:nA,Check:Zv,Switch:P3,Label:iA,Text:oA,Range:rA,Select:aA,FloatingLabel:lA}),aT=n=>!n||typeof n=="function"?n:e=>{n.current=e};function z3(n,e){const r=aT(n),h=aT(e);return d=>{r&&r(d),h&&h(d)}}function Sb(n,e){return K.useMemo(()=>z3(n,e),[n,e])}var bv;function oT(n){if((!bv&&bv!==0||n)&&ty){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),bv=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return bv}function N3(){return K.useState(null)}function Ax(n){n===void 0&&(n=Jg());try{var e=n.activeElement;return!e||!e.nodeName?null:e}catch{return n.body}}function j3(n){const e=K.useRef(n);return e.current=n,e}function F3(n){const e=j3(n);K.useEffect(()=>()=>e.current(),[])}function B3(n=document){const e=n.defaultView;return Math.abs(e.innerWidth-n.documentElement.clientWidth)}const sT=D3("modal-open");class uw{constructor({ownerDocument:e,handleContainerOverflow:r=!0,isRTL:h=!1}={}){this.handleContainerOverflow=r,this.isRTL=h,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return B3(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const r={overflow:"hidden"},h=this.isRTL?"paddingLeft":"paddingRight",d=this.getElement();e.style={overflow:d.style.overflow,[h]:d.style[h]},e.scrollBarWidth&&(r[h]=`${parseInt(bd(d,h)||"0",10)+e.scrollBarWidth}px`),d.setAttribute(sT,""),bd(d,r)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const r=this.getElement();r.removeAttribute(sT),Object.assign(r.style,e.style)}add(e){let r=this.modals.indexOf(e);return r!==-1||(r=this.modals.length,this.modals.push(e),this.setModalAttributes(e),r!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),r}remove(e){const r=this.modals.indexOf(e);r!==-1&&(this.modals.splice(r,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const Mx=(n,e)=>ty?n==null?(e||Jg()).body:(typeof n=="function"&&(n=n()),n&&"current"in n&&(n=n.current),n&&("nodeType"in n||n.getBoundingClientRect)?n:null):null;function r1(n,e){const r=ow(),[h,d]=K.useState(()=>Mx(n,r?.document));if(!h){const m=Mx(n);m&&d(m)}return K.useEffect(()=>{},[e,h]),K.useEffect(()=>{const m=Mx(n);m!==h&&d(m)},[n,h]),h}function U3({children:n,in:e,onExited:r,mountOnEnter:h,unmountOnExit:d}){const m=K.useRef(null),y=K.useRef(e),c=eh(r);K.useEffect(()=>{e?y.current=!0:c(m.current)},[e,c]);const E=Sb(m,ey(n)),C=K.cloneElement(n,{ref:E});return e?C:d||!y.current&&h?null:C}const V3=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function G3(n,e){if(n==null)return{};var r={};for(var h in n)if({}.hasOwnProperty.call(n,h)){if(e.indexOf(h)>=0)continue;r[h]=n[h]}return r}function $3(n){let{onEnter:e,onEntering:r,onEntered:h,onExit:d,onExiting:m,onExited:y,addEndListener:c,children:E}=n,C=G3(n,V3);const k=K.useRef(null),z=Sb(k,ey(E)),F=ke=>be=>{ke&&k.current&&ke(k.current,be)},B=K.useCallback(F(e),[e]),Q=K.useCallback(F(r),[r]),ie=K.useCallback(F(h),[h]),ne=K.useCallback(F(d),[d]),ue=K.useCallback(F(m),[m]),Ae=K.useCallback(F(y),[y]),Te=K.useCallback(F(c),[c]);return Object.assign({},C,{nodeRef:k},e&&{onEnter:B},r&&{onEntering:Q},h&&{onEntered:ie},d&&{onExit:ne},m&&{onExiting:ue},y&&{onExited:Ae},c&&{addEndListener:Te},{children:typeof E=="function"?(ke,be)=>E(ke,Object.assign({},be,{ref:z})):K.cloneElement(E,{ref:z})})}const Z3=["component"];function Y3(n,e){if(n==null)return{};var r={};for(var h in n)if({}.hasOwnProperty.call(n,h)){if(e.indexOf(h)>=0)continue;r[h]=n[h]}return r}const H3=K.forwardRef((n,e)=>{let{component:r}=n,h=Y3(n,Z3);const d=$3(h);return X.jsx(r,Object.assign({ref:e},d))});function q3({in:n,onTransition:e}){const r=K.useRef(null),h=K.useRef(!0),d=eh(e);return $2(()=>{if(!r.current)return;let m=!1;return d({in:n,element:r.current,initial:h.current,isStale:()=>m}),()=>{m=!0}},[n,d]),$2(()=>(h.current=!1,()=>{h.current=!0}),[]),r}function X3({children:n,in:e,onExited:r,onEntered:h,transition:d}){const[m,y]=K.useState(!e);e&&m&&y(!1);const c=q3({in:!!e,onTransition:C=>{const k=()=>{C.isStale()||(C.in?h?.(C.element,C.initial):(y(!0),r?.(C.element)))};Promise.resolve(d(C)).then(k,z=>{throw C.in||y(!0),z})}}),E=Sb(c,ey(n));return m&&!e?null:K.cloneElement(n,{ref:E})}function a1(n,e,r){return n?X.jsx(H3,Object.assign({},r,{component:n})):e?X.jsx(X3,Object.assign({},r,{transition:e})):X.jsx(U3,Object.assign({},r))}const W3=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Q3(n,e){if(n==null)return{};var r={};for(var h in n)if({}.hasOwnProperty.call(n,h)){if(e.indexOf(h)>=0)continue;r[h]=n[h]}return r}let Cx;function K3(n){return Cx||(Cx=new uw({ownerDocument:n?.document})),Cx}function J3(n){const e=ow(),r=n||K3(e),h=K.useRef({dialog:null,backdrop:null});return Object.assign(h.current,{add:()=>r.add(h.current),remove:()=>r.remove(h.current),isTopModal:()=>r.isTopModal(h.current),setDialogRef:K.useCallback(d=>{h.current.dialog=d},[]),setBackdropRef:K.useCallback(d=>{h.current.backdrop=d},[])})}const cA=K.forwardRef((n,e)=>{let{show:r=!1,role:h="dialog",className:d,style:m,children:y,backdrop:c=!0,keyboard:E=!0,onBackdropClick:C,onEscapeKeyDown:k,transition:z,runTransition:F,backdropTransition:B,runBackdropTransition:Q,autoFocus:ie=!0,enforceFocus:ne=!0,restoreFocus:ue=!0,restoreFocusOptions:Ae,renderDialog:Te,renderBackdrop:ke=Sn=>X.jsx("div",Object.assign({},Sn)),manager:be,container:Me,onShow:Fe,onHide:ot=()=>{},onExit:Ee,onExited:Je,onExiting:Et,onEnter:Tt,onEntering:zt,onEntered:Zt}=n,Gt=Q3(n,W3);const Ue=ow(),st=r1(Me),xt=J3(be),ut=BE(),Ut=XR(r),[De,Qe]=K.useState(!r),dt=K.useRef(null);K.useImperativeHandle(e,()=>xt,[xt]),ty&&!Ut&&r&&(dt.current=Ax(Ue?.document)),r&&De&&Qe(!1);const _t=eh(()=>{if(xt.add(),lr.current=md(document,"keydown",cn),mn.current=md(document,"focus",()=>setTimeout(jt),!0),Fe&&Fe(),ie){var Sn,gr;const oa=Ax((Sn=(gr=xt.dialog)==null?void 0:gr.ownerDocument)!=null?Sn:Ue?.document);xt.dialog&&oa&&!Gv(xt.dialog,oa)&&(dt.current=oa,xt.dialog.focus())}}),Ot=eh(()=>{if(xt.remove(),lr.current==null||lr.current(),mn.current==null||mn.current(),ue){var Sn;(Sn=dt.current)==null||Sn.focus==null||Sn.focus(Ae),dt.current=null}});K.useEffect(()=>{!r||!st||_t()},[r,st,_t]),K.useEffect(()=>{De&&Ot()},[De,Ot]),F3(()=>{Ot()});const jt=eh(()=>{if(!ne||!ut()||!xt.isTopModal())return;const Sn=Ax(Ue?.document);xt.dialog&&Sn&&!Gv(xt.dialog,Sn)&&xt.dialog.focus()}),Kt=eh(Sn=>{Sn.target===Sn.currentTarget&&(C?.(Sn),c===!0&&ot())}),cn=eh(Sn=>{E&&IE(Sn)&&xt.isTopModal()&&(k?.(Sn),Sn.defaultPrevented||ot())}),mn=K.useRef(),lr=K.useRef(),cr=(...Sn)=>{Qe(!0),Je?.(...Sn)};if(!st)return null;const xi=Object.assign({role:h,ref:xt.setDialogRef,"aria-modal":h==="dialog"?!0:void 0},Gt,{style:m,className:d,tabIndex:-1});let Wn=Te?Te(xi):X.jsx("div",Object.assign({},xi,{children:K.cloneElement(y,{role:"document"})}));Wn=a1(z,F,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!r,onExit:Ee,onExiting:Et,onExited:cr,onEnter:Tt,onEntering:zt,onEntered:Zt,children:Wn});let Ln=null;return c&&(Ln=ke({ref:xt.setBackdropRef,onClick:Kt}),Ln=a1(B,Q,{in:!!r,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Ln})),X.jsx(X.Fragment,{children:Wp.createPortal(X.jsxs(X.Fragment,{children:[Ln,Wn]}),st)})});cA.displayName="Modal";const uA=Object.assign(cA,{Manager:uw});function o1(n,e){return n.classList?!!e&&n.classList.contains(e):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+e+" ")!==-1}function eO(n,e){n.classList?n.classList.add(e):o1(n,e)||(typeof n.className=="string"?n.className=n.className+" "+e:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+e))}function lT(n,e){return n.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function tO(n,e){n.classList?n.classList.remove(e):typeof n.className=="string"?n.className=lT(n.className,e):n.setAttribute("class",lT(n.className&&n.className.baseVal||"",e))}const vg={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class hA extends uw{adjustAndStore(e,r,h){const d=r.style[e];r.dataset[e]=d,bd(r,{[e]:`${parseFloat(bd(r,e))+h}px`})}restore(e,r){const h=r.dataset[e];h!==void 0&&(delete r.dataset[e],bd(r,{[e]:h}))}setContainerStyle(e){super.setContainerStyle(e);const r=this.getElement();if(eO(r,"modal-open"),!e.scrollBarWidth)return;const h=this.isRTL?"paddingLeft":"paddingRight",d=this.isRTL?"marginLeft":"marginRight";_g(r,vg.FIXED_CONTENT).forEach(m=>this.adjustAndStore(h,m,e.scrollBarWidth)),_g(r,vg.STICKY_CONTENT).forEach(m=>this.adjustAndStore(d,m,-e.scrollBarWidth)),_g(r,vg.NAVBAR_TOGGLER).forEach(m=>this.adjustAndStore(d,m,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const r=this.getElement();tO(r,"modal-open");const h=this.isRTL?"paddingLeft":"paddingRight",d=this.isRTL?"marginLeft":"marginRight";_g(r,vg.FIXED_CONTENT).forEach(m=>this.restore(h,m)),_g(r,vg.STICKY_CONTENT).forEach(m=>this.restore(d,m)),_g(r,vg.NAVBAR_TOGGLER).forEach(m=>this.restore(d,m))}}let Dx;function dA(n){return Dx||(Dx=new hA(n)),Dx}const fA=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...h},d)=>(e=Pn(e,"modal-body"),X.jsx(r,{ref:d,className:pn(n,e),...h})));fA.displayName="ModalBody";const hw=K.createContext({onHide(){}}),dw=K.forwardRef(({bsPrefix:n,className:e,contentClassName:r,centered:h,size:d,fullscreen:m,children:y,scrollable:c,...E},C)=>{n=Pn(n,"modal");const k=`${n}-dialog`,z=typeof m=="string"?`${n}-fullscreen-${m}`:`${n}-fullscreen`;return X.jsx("div",{...E,ref:C,className:pn(k,e,d&&`${n}-${d}`,h&&`${k}-centered`,c&&`${k}-scrollable`,m&&z),children:X.jsx("div",{className:pn(`${n}-content`,r),children:y})})});dw.displayName="ModalDialog";const pA=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...h},d)=>(e=Pn(e,"modal-footer"),X.jsx(r,{ref:d,className:pn(n,e),...h})));pA.displayName="ModalFooter";const fw=K.forwardRef(({closeLabel:n="Close",closeVariant:e,closeButton:r=!1,onHide:h,children:d,...m},y)=>{const c=K.useContext(hw),E=rm(()=>{c?.onHide(),h?.()});return X.jsxs("div",{ref:y,...m,children:[d,r&&X.jsx(Q1,{"aria-label":n,variant:e,onClick:E})]})});fw.displayName="AbstractModalHeader";const mA=K.forwardRef(({bsPrefix:n,className:e,closeLabel:r="Close",closeButton:h=!1,...d},m)=>(n=Pn(n,"modal-header"),X.jsx(fw,{ref:m,...d,className:pn(e,n),closeLabel:r,closeButton:h})));mA.displayName="ModalHeader";const nO=FE("h4"),gA=K.forwardRef(({className:n,bsPrefix:e,as:r=nO,...h},d)=>(e=Pn(e,"modal-title"),X.jsx(r,{ref:d,className:pn(n,e),...h})));gA.displayName="ModalTitle";function iO(n){return X.jsx(Lg,{...n,timeout:null})}function rO(n){return X.jsx(Lg,{...n,timeout:null})}const yA=K.forwardRef(({bsPrefix:n,className:e,style:r,dialogClassName:h,contentClassName:d,children:m,dialogAs:y=dw,"data-bs-theme":c,"aria-labelledby":E,"aria-describedby":C,"aria-label":k,show:z=!1,animation:F=!0,backdrop:B=!0,keyboard:Q=!0,onEscapeKeyDown:ie,onShow:ne,onHide:ue,container:Ae,autoFocus:Te=!0,enforceFocus:ke=!0,restoreFocus:be=!0,restoreFocusOptions:Me,onEntered:Fe,onExit:ot,onExiting:Ee,onEnter:Je,onEntering:Et,onExited:Tt,backdropClassName:zt,manager:Zt,...Gt},Ue)=>{const[st,xt]=K.useState({}),[ut,Ut]=K.useState(!1),De=K.useRef(!1),Qe=K.useRef(!1),dt=K.useRef(null),[_t,Ot]=N3(),jt=H1(Ue,Ot),Kt=rm(ue),cn=Z1();n=Pn(n,"modal");const mn=K.useMemo(()=>({onHide:Kt}),[Kt]);function lr(){return Zt||dA({isRTL:cn})}function cr(dn){if(!ty)return;const Mr=lr().getScrollbarWidth()>0,ur=dn.scrollHeight>Jg(dn).documentElement.clientHeight;xt({paddingRight:Mr&&!ur?oT():void 0,paddingLeft:!Mr&&ur?oT():void 0})}const xi=rm(()=>{_t&&cr(_t.dialog)});ak(()=>{e1(window,"resize",xi),dt.current==null||dt.current()});const Wn=()=>{De.current=!0},Ln=dn=>{De.current&&_t&&dn.target===_t.dialog&&(Qe.current=!0),De.current=!1},Sn=()=>{Ut(!0),dt.current=kE(_t.dialog,()=>{Ut(!1)})},gr=dn=>{dn.target===dn.currentTarget&&Sn()},oa=dn=>{if(B==="static"){gr(dn);return}if(Qe.current||dn.target!==dn.currentTarget){Qe.current=!1;return}ue?.()},po=dn=>{Q?ie?.(dn):(dn.preventDefault(),B==="static"&&Sn())},Ar=(dn,Mr)=>{dn&&cr(dn),Je?.(dn,Mr)},Br=dn=>{dt.current==null||dt.current(),ot?.(dn)},Ea=(dn,Mr)=>{Et?.(dn,Mr),RE(window,"resize",xi)},Ua=dn=>{dn&&(dn.style.display=""),Tt?.(dn),e1(window,"resize",xi)},ga=K.useCallback(dn=>X.jsx("div",{...dn,className:pn(`${n}-backdrop`,zt,!F&&"show")}),[F,zt,n]),Oi={...r,...st};Oi.display="block";const ys=dn=>X.jsx("div",{role:"dialog",...dn,style:Oi,className:pn(e,n,ut&&`${n}-static`,!F&&"show"),onClick:B?oa:void 0,onMouseUp:Ln,"data-bs-theme":c,"aria-label":k,"aria-labelledby":E,"aria-describedby":C,children:X.jsx(y,{...Gt,onMouseDown:Wn,className:h,contentClassName:d,children:m})});return X.jsx(hw.Provider,{value:mn,children:X.jsx(uA,{show:z,ref:jt,backdrop:B,container:Ae,keyboard:!0,autoFocus:Te,enforceFocus:ke,restoreFocus:be,restoreFocusOptions:Me,onEscapeKeyDown:po,onShow:ne,onHide:ue,onEnter:Ar,onEntering:Ea,onEntered:Fe,onExit:Br,onExiting:Ee,onExited:Ua,manager:lr(),transition:F?iO:void 0,backdropTransition:F?rO:void 0,renderBackdrop:ga,renderDialog:ys})})});yA.displayName="Modal";const xv=Object.assign(yA,{Body:fA,Header:mA,Title:gA,Footer:pA,Dialog:dw,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),_A=K.forwardRef(({bsPrefix:n,className:e,as:r,...h},d)=>{n=Pn(n,"navbar-brand");const m=r||(h.href?"a":"span");return X.jsx(m,{...h,ref:d,className:pn(e,n)})});_A.displayName="NavbarBrand";const vA=K.forwardRef(({children:n,bsPrefix:e,...r},h)=>{e=Pn(e,"navbar-collapse");const d=K.useContext(c0);return X.jsx(q1,{in:!!(d&&d.expanded),...r,children:X.jsx("div",{ref:h,className:e,children:n})})});vA.displayName="NavbarCollapse";const bA=K.forwardRef(({bsPrefix:n,className:e,children:r,label:h="Toggle navigation",as:d="button",onClick:m,...y},c)=>{n=Pn(n,"navbar-toggler");const{onToggle:E,expanded:C}=K.useContext(c0)||{},k=rm(z=>{m&&m(z),E&&E()});return d==="button"&&(y.type="button"),X.jsx(d,{...y,ref:c,onClick:k,"aria-label":h,className:pn(e,n,!C&&"collapsed"),children:r||X.jsx("span",{className:`${n}-icon`})})});bA.displayName="NavbarToggle";const s1=new WeakMap,cT=(n,e)=>{if(!n||!e)return;const r=s1.get(e)||new Map;s1.set(e,r);let h=r.get(n);return h||(h=e.matchMedia(n),h.refCount=0,r.set(h.media,h)),h};function aO(n,e=typeof window>"u"?void 0:window){const r=cT(n,e),[h,d]=K.useState(()=>r?r.matches:!1);return JE(()=>{let m=cT(n,e);if(!m)return d(!1);let y=s1.get(e);const c=()=>{d(m.matches)};return m.refCount++,m.addListener(c),c(),()=>{m.removeListener(c),m.refCount--,m.refCount<=0&&y?.delete(m.media),m=void 0}},[n]),h}function oO(n){const e=Object.keys(n);function r(c,E){return c===E?E:c?`${c} and ${E}`:E}function h(c){return e[Math.min(e.indexOf(c)+1,e.length-1)]}function d(c){const E=h(c);let C=n[E];return typeof C=="number"?C=`${C-.2}px`:C=`calc(${C} - 0.2px)`,`(max-width: ${C})`}function m(c){let E=n[c];return typeof E=="number"&&(E=`${E}px`),`(min-width: ${E})`}function y(c,E,C){let k;typeof c=="object"?(k=c,C=E,E=!0):(E=E||!0,k={[c]:E});let z=K.useMemo(()=>Object.entries(k).reduce((F,[B,Q])=>((Q==="up"||Q===!0)&&(F=r(F,m(B))),(Q==="down"||Q===!0)&&(F=r(F,d(B))),F),""),[JSON.stringify(k)]);return aO(z,C)}return y}const sO=oO({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),xA=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...h},d)=>(e=Pn(e,"offcanvas-body"),X.jsx(r,{ref:d,className:pn(n,e),...h})));xA.displayName="OffcanvasBody";const lO={[cu]:"show",[hd]:"show"},wA=K.forwardRef(({bsPrefix:n,className:e,children:r,in:h=!1,mountOnEnter:d=!1,unmountOnExit:m=!1,appear:y=!1,...c},E)=>(n=Pn(n,"offcanvas"),X.jsx(bb,{ref:E,addEndListener:Y1,in:h,mountOnEnter:d,unmountOnExit:m,appear:y,...c,childRef:ey(r),children:(C,k)=>K.cloneElement(r,{...k,className:pn(e,r.props.className,(C===cu||C===V_)&&`${n}-toggling`,lO[C])})})));wA.displayName="OffcanvasToggling";const TA=K.forwardRef(({bsPrefix:n,className:e,closeLabel:r="Close",closeButton:h=!1,...d},m)=>(n=Pn(n,"offcanvas-header"),X.jsx(fw,{ref:m,...d,className:pn(e,n),closeLabel:r,closeButton:h})));TA.displayName="OffcanvasHeader";const cO=FE("h5"),SA=K.forwardRef(({className:n,bsPrefix:e,as:r=cO,...h},d)=>(e=Pn(e,"offcanvas-title"),X.jsx(r,{ref:d,className:pn(n,e),...h})));SA.displayName="OffcanvasTitle";function uO(n){return X.jsx(wA,{...n})}function hO(n){return X.jsx(Lg,{...n})}const EA=K.forwardRef(({bsPrefix:n,className:e,children:r,"aria-labelledby":h,placement:d="start",responsive:m,show:y=!1,backdrop:c=!0,keyboard:E=!0,scroll:C=!1,onEscapeKeyDown:k,onShow:z,onHide:F,container:B,autoFocus:Q=!0,enforceFocus:ie=!0,restoreFocus:ne=!0,restoreFocusOptions:ue,onEntered:Ae,onExit:Te,onExiting:ke,onEnter:be,onEntering:Me,onExited:Fe,backdropClassName:ot,manager:Ee,renderStaticNode:Je=!1,...Et},Tt)=>{const zt=K.useRef();n=Pn(n,"offcanvas");const[Zt,Gt]=K.useState(!1),Ue=rm(F),st=sO(m||"xs","up");K.useEffect(()=>{Gt(m?y&&!st:y)},[y,m,st]);const xt=K.useMemo(()=>({onHide:Ue}),[Ue]);function ut(){return Ee||(C?(zt.current||(zt.current=new hA({handleContainerOverflow:!1})),zt.current):dA())}const Ut=(_t,...Ot)=>{_t&&(_t.style.visibility="visible"),be?.(_t,...Ot)},De=(_t,...Ot)=>{_t&&(_t.style.visibility=""),Fe?.(...Ot)},Qe=K.useCallback(_t=>X.jsx("div",{..._t,className:pn(`${n}-backdrop`,ot)}),[ot,n]),dt=_t=>X.jsx("div",{..._t,...Et,className:pn(e,m?`${n}-${m}`:n,`${n}-${d}`),"aria-labelledby":h,children:r});return X.jsxs(X.Fragment,{children:[!Zt&&(m||Je)&&dt({}),X.jsx(hw.Provider,{value:xt,children:X.jsx(uA,{show:Zt,ref:Tt,backdrop:c,container:B,keyboard:E,autoFocus:Q,enforceFocus:ie&&!C,restoreFocus:ne,restoreFocusOptions:ue,onEscapeKeyDown:k,onShow:z,onHide:Ue,onEnter:Ut,onEntering:Me,onEntered:Ae,onExit:Te,onExiting:ke,onExited:De,manager:ut(),transition:uO,backdropTransition:hO,renderBackdrop:Qe,renderDialog:dt})})]})});EA.displayName="Offcanvas";const dO=Object.assign(EA,{Body:xA,Header:TA,Title:SA}),AA=K.forwardRef(({onHide:n,...e},r)=>{const h=K.useContext(c0),d=rm(()=>{h==null||h.onToggle==null||h.onToggle(),n?.()});return X.jsx(dO,{ref:r,show:!!(h!=null&&h.expanded),...e,renderStaticNode:!0,onHide:d})});AA.displayName="NavbarOffcanvas";const MA=K.forwardRef(({className:n,bsPrefix:e,as:r="span",...h},d)=>(e=Pn(e,"navbar-text"),X.jsx(r,{ref:d,className:pn(n,e),...h})));MA.displayName="NavbarText";const CA=K.forwardRef((n,e)=>{const{bsPrefix:r,expand:h=!0,variant:d="light",bg:m,fixed:y,sticky:c,className:E,as:C="nav",expanded:k,onToggle:z,onSelect:F,collapseOnSelect:B=!1,...Q}=CE(n,{expanded:"onToggle"}),ie=Pn(r,"navbar"),ne=K.useCallback((...Te)=>{F?.(...Te),B&&k&&z?.(!1)},[F,B,k,z]);Q.role===void 0&&C!=="nav"&&(Q.role="navigation");let ue=`${ie}-expand`;typeof h=="string"&&(ue=`${ue}-${h}`);const Ae=K.useMemo(()=>({onToggle:()=>z?.(!k),bsPrefix:ie,expanded:!!k,expand:h}),[ie,k,h,z]);return X.jsx(c0.Provider,{value:Ae,children:X.jsx(M3.Provider,{value:ne,children:X.jsx(C,{ref:e,...Q,className:pn(E,ie,h&&ue,d&&`${ie}-${d}`,m&&`bg-${m}`,c&&`sticky-${c}`,y&&`fixed-${y}`)})})})});CA.displayName="Navbar";const fO=Object.assign(CA,{Brand:_A,Collapse:vA,Offcanvas:AA,Text:MA,Toggle:bA}),pO=()=>{};function mO(n,e,{disabled:r,clickTrigger:h}={}){const d=e||pO;T3(n,d,{disabled:r,clickTrigger:h});const m=eh(y=>{IE(y)&&d(y)});K.useEffect(()=>{if(r||n==null)return;const y=Jg(Ov(n));let c=(y.defaultView||window).event;const E=md(y,"keyup",C=>{if(C===c){c=void 0;return}m(C)});return()=>{E()}},[n,r,m])}const DA=K.forwardRef((n,e)=>{const{flip:r,offset:h,placement:d,containerPadding:m,popperConfig:y={},transition:c,runTransition:E}=n,[C,k]=G2(),[z,F]=G2(),B=Sb(k,e),Q=r1(n.container),ie=r1(n.target),[ne,ue]=K.useState(!n.show),Ae=y3(ie,C,A3({placement:d,enableEvents:!!n.show,containerPadding:m||5,flip:r,offset:h,arrowElement:z,popperConfig:y}));n.show&&ne&&ue(!1);const Te=(...Et)=>{ue(!0),n.onExited&&n.onExited(...Et)},ke=n.show||!ne;if(mO(C,n.onHide,{disabled:!n.rootClose||n.rootCloseDisabled,clickTrigger:n.rootCloseEvent}),!ke)return null;const{onExit:be,onExiting:Me,onEnter:Fe,onEntering:ot,onEntered:Ee}=n;let Je=n.children(Object.assign({},Ae.attributes.popper,{style:Ae.styles.popper,ref:B}),{popper:Ae,placement:d,show:!!n.show,arrowProps:Object.assign({},Ae.attributes.arrow,{style:Ae.styles.arrow,ref:F})});return Je=a1(c,E,{in:!!n.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Je,onExit:be,onExiting:Me,onExited:Te,onEnter:Fe,onEntering:ot,onEntered:Ee}),Q?Wp.createPortal(Je,Q):null});DA.displayName="Overlay";const IA=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...h},d)=>(e=Pn(e,"popover-header"),X.jsx(r,{ref:d,className:pn(n,e),...h})));IA.displayName="PopoverHeader";const pw=K.forwardRef(({className:n,bsPrefix:e,as:r="div",...h},d)=>(e=Pn(e,"popover-body"),X.jsx(r,{ref:d,className:pn(n,e),...h})));pw.displayName="PopoverBody";function RA(n,e){let r=n;return n==="left"?r=e?"end":"start":n==="right"&&(r=e?"start":"end"),r}function kA(n="absolute"){return{position:n,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const OA=K.forwardRef(({bsPrefix:n,placement:e="right",className:r,style:h,children:d,body:m,arrowProps:y,hasDoneInitialMeasure:c,popper:E,show:C,...k},z)=>{const F=Pn(n,"popover"),B=Z1(),[Q]=e?.split("-")||[],ie=RA(Q,B);let ne=h;return C&&!c&&(ne={...h,...kA(E?.strategy)}),X.jsxs("div",{ref:z,role:"tooltip",style:ne,"x-placement":Q,className:pn(r,F,Q&&`bs-popover-${ie}`),...k,children:[X.jsx("div",{className:"popover-arrow",...y}),m?X.jsx(pw,{children:d}):d]})});OA.displayName="Popover";const gO=Object.assign(OA,{Header:IA,Body:pw,POPPER_OFFSET:[0,8]}),PA=K.forwardRef(({bsPrefix:n,placement:e="right",className:r,style:h,children:d,arrowProps:m,hasDoneInitialMeasure:y,popper:c,show:E,...C},k)=>{n=Pn(n,"tooltip");const z=Z1(),[F]=e?.split("-")||[],B=RA(F,z);let Q=h;return E&&!y&&(Q={...h,...kA(c?.strategy)}),X.jsxs("div",{ref:k,style:Q,role:"tooltip","x-placement":F,className:pn(r,n,`bs-tooltip-${B}`),...C,children:[X.jsx("div",{className:"tooltip-arrow",...m}),X.jsx("div",{className:`${n}-inner`,children:d})]})});PA.displayName="Tooltip";const yO=Object.assign(PA,{TOOLTIP_OFFSET:[0,6]});function _O(n){const e=K.useRef(null),r=Pn(void 0,"popover"),h=Pn(void 0,"tooltip"),d=K.useMemo(()=>({name:"offset",options:{offset:()=>{if(n)return n;if(e.current){if(o1(e.current,r))return gO.POPPER_OFFSET;if(o1(e.current,h))return yO.TOOLTIP_OFFSET}return[0,0]}}}),[n,r,h]);return[e,[d]]}function vO(n,e){const{ref:r}=n,{ref:h}=e;n.ref=r.__wrapped||(r.__wrapped=d=>r(t1(d))),e.ref=h.__wrapped||(h.__wrapped=d=>h(t1(d)))}const LA=K.forwardRef(({children:n,transition:e=Lg,popperConfig:r={},rootClose:h=!1,placement:d="top",show:m=!1,...y},c)=>{const E=K.useRef({}),[C,k]=K.useState(null),[z,F]=_O(y.offset),B=H1(c,z),Q=e===!0?Lg:e||void 0,ie=rm(ne=>{k(ne),r==null||r.onFirstUpdate==null||r.onFirstUpdate(ne)});return JE(()=>{C&&y.target&&(E.current.scheduleUpdate==null||E.current.scheduleUpdate())},[C,y.target]),K.useEffect(()=>{m||k(null)},[m]),X.jsx(DA,{...y,ref:B,popperConfig:{...r,modifiers:F.concat(r.modifiers||[]),onFirstUpdate:ie},transition:Q,rootClose:h,placement:d,show:m,children:(ne,{arrowProps:ue,popper:Ae,show:Te})=>{var ke;vO(ne,ue);const be=Ae?.placement,Me=Object.assign(E.current,{state:Ae?.state,scheduleUpdate:Ae?.update,placement:be,outOfBoundaries:(Ae==null||(ke=Ae.state)==null||(ke=ke.modifiersData.hide)==null?void 0:ke.isReferenceHidden)||!1,strategy:r.strategy}),Fe=!!C;return typeof n=="function"?n({...ne,placement:be,show:Te,...!e&&Te&&{className:"show"},popper:Me,arrowProps:ue,hasDoneInitialMeasure:Fe}):K.cloneElement(n,{...ne,placement:be,arrowProps:ue,popper:Me,hasDoneInitialMeasure:Fe,className:pn(n.props.className,!e&&Te&&"show"),style:{...n.props.style,...ne.style}})}})});LA.displayName="Overlay";const zA=K.forwardRef(({bsPrefix:n,variant:e,animation:r="border",size:h,as:d="div",className:m,...y},c)=>{n=Pn(n,"spinner");const E=`${n}-${r}`;return X.jsx(d,{ref:c,...y,className:pn(m,E,h&&`${E}-${h}`,e&&`text-${e}`)})});zA.displayName="Spinner";const Eb=K.forwardRef(({bsPrefix:n,className:e,striped:r,bordered:h,borderless:d,hover:m,size:y,variant:c,responsive:E,...C},k)=>{const z=Pn(n,"table"),F=pn(e,z,c&&`${z}-${c}`,y&&`${z}-${y}`,r&&`${z}-${typeof r=="string"?`striped-${r}`:"striped"}`,h&&`${z}-bordered`,d&&`${z}-borderless`,m&&`${z}-hover`),B=X.jsx("table",{...C,className:F,ref:k});if(E){let Q=`${z}-responsive`;return typeof E=="string"&&(Q=`${Q}-${E}`),X.jsx("div",{className:Q,children:B})}return B});Eb.displayName="Table";function bO({tripQueryVariables:n,setTripQueryVariables:e,coordinates:r,onClose:h}){return X.jsx(zS,{longitude:r.lng,latitude:r.lat,anchor:"bottom",onClose:h,children:X.jsxs(K1,{vertical:!0,children:[X.jsx(Of,{onClick:()=>{e({...n,from:{coordinates:{latitude:r.lat,longitude:r.lng}}}),h()},children:"Start here"}),X.jsx(Of,{onClick:()=>{e({...n,to:{coordinates:{latitude:r.lat,longitude:r.lng}}}),h()},children:"End here"})]})})}function xO({coordinates:n,properties:e,onClose:r}){return X.jsxs(zS,{latitude:n.lat,longitude:n.lng,closeButton:!0,onClose:()=>r(),maxWidth:"350px",children:[X.jsx(Eb,{bordered:!0,children:X.jsx("tbody",{children:Object.entries(e).map(([h,d])=>X.jsxs("tr",{children:[X.jsx("th",{scope:"row",children:h}),X.jsx("td",{children:String(d)})]},h))})}),X.jsx("div",{className:"geometry-popup-osm-link",children:X.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${n.lat}&mlon=${n.lng}#map=18/${n.lat}/${n.lng}`,target:"_blank",rel:"noreferrer",children:"↗️ osm.org"})})]})}const NA=n=>{const e=n.getStyle();return!e||!e.layers?[]:e.layers.filter(r=>r.type!=="raster"&&!r.id.startsWith("jsx")).filter(r=>n.getLayoutProperty(r.id,"visibility")!=="none").map(r=>r.id)},wO=({mapRef:n,setInteractiveLayerIds:e})=>{const[r,h]=K.useState([]),[d,m]=K.useState({});K.useEffect(()=>{if(!n)return;const E=n.getMap(),C=()=>{const k=E.getStyle();if(!k||!k.layers)return;const z=k.layers.filter(B=>B.type==="raster").map(B=>{let Q=B.id;const ie=B.metadata?.name;return ie&&(Q=ie),{id:B.id,name:Q}});h(z);const F={};k.layers.filter(B=>B.type!=="raster"&&!B.id.startsWith("jsx")).reverse().forEach(B=>{const Q=B.metadata?.group||"Misc";F[Q]||(F[Q]=[]),F[Q].push({id:B.id,name:B.id})}),m(F)};return E.isStyleLoaded()?C():E.on("styledata",C),()=>{E.off("styledata",C)}},[n]);const y=K.useCallback((E,C)=>{if(!n)return;const k=n.getMap();k.setLayoutProperty(E,"visibility",C?"visible":"none");const z=NA(k);e(z)},[n,e]),c=K.useCallback(E=>{if(!n)return;const C=n.getMap();r.forEach(k=>{C.setLayoutProperty(k.id,"visibility",k.id===E?"visible":"none")})},[n,r]);return X.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[X.jsx("h4",{style:{marginTop:0},children:"Background"}),X.jsx("select",{onChange:E=>c(E.target.value),children:r.map(E=>X.jsx("option",{value:E.id,children:E.name},E.id))}),X.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(d).map(([E,C])=>{const k=C.every(F=>n?.getMap().getLayoutProperty(F.id,"visibility")!=="none"),z=F=>{C.forEach(B=>{y(B.id,F)})};return X.jsxs("div",{style:{marginBottom:"10px"},children:[X.jsx("h6",{style:{margin:"0 0 5px"},children:X.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[X.jsx("input",{type:"checkbox",checked:k,onChange:F=>z(F.target.checked),style:{marginRight:"5px"}}),E]})}),C.map(F=>{const B=n?.getMap().getLayoutProperty(F.id,"visibility")!=="none";return X.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[X.jsx("input",{type:"checkbox",checked:B,onChange:Q=>y(F.id,Q.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),F.name]},F.id)})]},E)})]})},TO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class SO extends K.Component{constructor(e){super(e),this.state={isSidebarOpen:!1,activeContent:null}}toggleSidebar=e=>{this.setState(r=>({isSidebarOpen:r.activeContent!==e||!r.isSidebarOpen,activeContent:r.activeContent===e?null:e}))};render(){const{isSidebarOpen:e,activeContent:r}=this.state,{position:h,setInteractiveLayerIds:d,mapRef:m}=this.props;return X.jsxs("div",{children:[X.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${r==="debugLayer"?"active":""} ${e?"open":""}`,style:{top:"20px"},children:X.jsx("img",{src:TO,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),X.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:e?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:e?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:e&&r==="debugLayer"&&X.jsx(wO,{position:h,setInteractiveLayerIds:d,mapRef:m})})]})}}const EO="/otp/debug/vectortiles/style.json";function AO({tripQueryVariables:n,setTripQueryVariables:e,tripQueryResult:r,selectedTripPatternIndexes:h,loading:d}){const m=mR({tripQueryVariables:n,setTripQueryVariables:e}),[y,c]=K.useState(null),[E,C]=K.useState(null),[k,z]=K.useState([]),[F,B]=K.useState("auto"),Q=K.useCallback(()=>B("pointer"),[]),ie=K.useCallback(()=>B("auto"),[]),ne=be=>{if(be.features){const Me=be.features[0];C({coordinates:be.lngLat,feature:Me})}},ue=be=>{const Me=be.target;if(Me.getZoom()<2){const Fe=Me.getSource("stops");Me.fitBounds(Fe.bounds,{animate:!1})}},Ae=be=>{be.target.addControl(new FS.AttributionControl,"bottom-left")};function Te(be){ue(be);const Me=NA(be.target);z(Me),Ae(be)}const ke=K.useRef(null);return X.jsx("div",{className:"map-container below-content",children:X.jsxs(aD,{attributionControl:!1,mapLib:PS(()=>Promise.resolve().then(()=>BS),void 0),mapStyle:EO,onDblClick:m,onContextMenu:be=>{c(be.lngLat)},interactiveLayerIds:k,cursor:F,onMouseEnter:Q,onMouseLeave:ie,onClick:ne,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:Te,ref:ke,children:[X.jsx(hD,{position:"top-left"}),X.jsx(cR,{setCursor:B,tripQueryVariables:n,setTripQueryVariables:e,loading:d}),X.jsx(SO,{position:"top-right",setInteractiveLayerIds:z,mapRef:ke?.current}),r?.trip.tripPatterns.length&&h.map(be=>{const Me=r.trip.tripPatterns[be];return Me?X.jsx(dR,{tripPattern:Me},`trippattern-${be}`):null}),y&&X.jsx(bO,{tripQueryVariables:n,setTripQueryVariables:e,coordinates:y,onClose:()=>c(null)}),E?.feature?.properties&&X.jsx(xO,{coordinates:E?.coordinates,properties:E?.feature?.properties,onClose:()=>C(null)})]})})}function MO(){const[n,e]=K.useState(0),r=K.useRef(null);return K.useLayoutEffect(()=>{r.current&&e(r.current.getBoundingClientRect().width)},[]),K.useEffect(()=>{const h=()=>{r.current&&e(r.current.getBoundingClientRect().width)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),{containerRef:r,containerWidth:n}}const CO=70,DO=20,l1=40;function IO(n,e,r,h){const d=K.useMemo(()=>new Date(h).getTime()-new Date(r).getTime(),[r,h]),m=K.useMemo(()=>(new Date(n.expectedStartTime).getTime()-new Date(r).getTime())/d,[n.expectedStartTime,r,d]),y=K.useMemo(()=>new Date(n.expectedEndTime).getTime()-new Date(n.expectedStartTime).getTime(),[n.expectedStartTime,n.expectedEndTime]),c=DO+l1,C=e-CO-l1-c,k=c+m*C,z=C*(y/d);return{maxSpan:d,startPx:c,pxSpan:C,widthPx:z,leftPx:k}}const RO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",kO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",OO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",PO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",LO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",zO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",NO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",jO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",FO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",BO="https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-24T10:45/assets/monorail-CEIE-7ZV.png",UO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",VO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABHNCSVQICAgIfAhkiAAAAFtJREFUKJFjYCAOCBGpDif4D8UUG8LAwMDAwESJKaOaaaj5GwOZ8fyfgYHBAomNIYkrBYkyMDD8wKaOhYGBYTEWg9CBJBax5YxYNDBiUYjNYBR1y/FoQgZwlwIAXKYUAUY5kWQAAAAASUVORK5CYII=",GO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",$O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",ZO="https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-24T10:45/assets/trolleybus-BefhFtdd.png",YO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function HO(n){return n===Ii.Rail||n===Ii.Coach||n===Ii.Metro||n===Ii.Bus||n===Ii.Tram||n===Ii.Water||n===Ii.Air||n===Ii.Cableway||n===Ii.Funicular||n===Ii.Trolleybus||n===Ii.Monorail||n===Ii.Taxi}function qO(n){const e=XO(n);function r(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const h=r(e[0]/255),d=r(e[1]/255),m=r(e[2]/255);return .2126*h+.7152*d+.0722*m>.179?"#000":"#fff"}function XO(n){return WO(n)}function WO(n){return n.length===4?QO(n):[parseInt(n.slice(1,3),16),parseInt(n.slice(3,5),16),parseInt(n.slice(5,7),16)]}function QO(n){const e=n.slice(1,2),r=n.slice(2,3),h=n.slice(3,4);return[parseInt(e+e,16),parseInt(r+r,16),parseInt(h+h,16)]}function KO(n,e,r,h,d){const m=K.useMemo(()=>(new Date(n.expectedStartTime).getTime()-new Date(e).getTime())/r,[n.expectedStartTime,e,r]),y=K.useMemo(()=>d*(new Date(n.expectedEndTime).getTime()-new Date(n.expectedStartTime).getTime())/r-1,[d,n,r]),c=h+m*d+1,E=y>40&&HO(n.mode)&&n.line?.publicCode&&n.line.publicCode.length<=6,C=AE(n),k=K.useMemo(()=>qO(C),[C]);return{widthPx:y,leftPx:c,legTextColor:k,modeColor:C,showPublicCode:E}}const JO=Object.assign({"../../static/img/mode/air.png":RO,"../../static/img/mode/bicycle.png":kO,"../../static/img/mode/bus.png":OO,"../../static/img/mode/cableway.png":PO,"../../static/img/mode/car.png":LO,"../../static/img/mode/coach.png":zO,"../../static/img/mode/foot.png":NO,"../../static/img/mode/funicular.png":jO,"../../static/img/mode/metro.png":FO,"../../static/img/mode/monorail.png":BO,"../../static/img/mode/rail.png":UO,"../../static/img/mode/scooter.png":VO,"../../static/img/mode/taxi.png":GO,"../../static/img/mode/tram.png":$O,"../../static/img/mode/trolleybus.png":ZO,"../../static/img/mode/water.png":YO});function eP(n){return JO[`../../static/img/mode/${n.mode.toLowerCase()}.png`]}function tP({leg:n,earliestStartTime:e,maxSpan:r,startPx:h,pxSpan:d}){const{widthPx:m,leftPx:y,legTextColor:c,modeColor:E,showPublicCode:C}=KO(n,e,r,h,d),k=eP(n);return X.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${m}px`,left:y,color:c,background:E},children:[X.jsx("div",{className:"itinerary-header-leg-icon",style:{background:c,maskImage:`url(${k})`,WebkitMaskImage:`url(${k})`}}),C&&X.jsx("span",{className:"itinerary-header-leg-public-code",children:n.line?.publicCode})]})}function hu(n,e,r){return new Date(n).toLocaleTimeString("en-US",{timeStyle:r,hourCycle:"h24",timeZone:e})}const ny=K.createContext("UTC");function nP({tripPattern:n,itineraryIndex:e,containerWidth:r,earliestStartTime:h,latestEndTime:d,comparisonSelectedIndexes:m,setComparisonSelectedIndexes:y}){const{maxSpan:c,pxSpan:E,startPx:C,widthPx:k,leftPx:z}=IO(n,r,h,d),F=K.useContext(ny),B=K.useMemo(()=>hu(n.expectedStartTime,F,"short"),[n.expectedStartTime,F]),Q=K.useMemo(()=>hu(n.expectedEndTime,F,"short"),[n.expectedEndTime,F]),ie=()=>{!y||!m||(m.includes(e)?y(m.filter(ue=>ue!==e)):m.length<2&&y([...m,e]))},ne=m?.includes(e)||!1;return X.jsxs("div",{className:"itinerary-header-wrapper",style:{position:"relative"},children:[m&&y&&X.jsx("div",{onClick:ue=>ue.stopPropagation(),style:{position:"absolute",top:"4px",right:"4px",zIndex:10},children:X.jsx("input",{type:"checkbox",checked:ne,onChange:ie,disabled:!ne&&m.length>=2,title:"Select for comparison"})}),X.jsxs("div",{className:"itinerary-header-itinerary-number",children:[e+1,"."]}),X.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${k+5}px`,left:`${z-2}px`}}),X.jsx("div",{title:n.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${z-l1}px`},children:B}),n.legs.map((ue,Ae)=>X.jsx(tP,{leg:ue,earliestStartTime:h,startPx:C,maxSpan:c,pxSpan:E},ue.id||`leg_${Ae}`)),X.jsx("div",{title:n.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${z+k+2}px`},children:Q})]})}function iP(n){const e=K.useMemo(()=>n?.trip.tripPatterns.reduce((h,d)=>h===null?d?.expectedStartTime:new Date(d?.expectedStartTime)<new Date(h)?d.expectedStartTime:h,null)||null,[n?.trip]),r=K.useMemo(()=>n?.trip.tripPatterns.reduce((h,d)=>h===null?d?.expectedEndTime:new Date(d?.expectedEndTime)>new Date(h)?d.expectedEndTime:h,null)||null,[n?.trip]);return[e,r]}function uT({aimedTime:n,expectedTime:e,hasRealtime:r}){const h=K.useContext(ny);return n!==e?X.jsxs(X.Fragment,{children:[X.jsx("span",{title:e,style:{color:"red"},children:hu(e,h,"short")}),X.jsx("span",{title:n,style:{textDecoration:"line-through"},children:hu(n,h,"short")})]}):X.jsxs("span",{title:e,children:[hu(e,h,"short"),r&&X.jsx("span",{children:" (on time)"})]})}function mw(n){const e=n/1e3;return e>100?`${e.toFixed(0)} km`:e>1?`${e.toFixed(1)} km`:`${n.toFixed(0)} m`}const wv=n=>{const e=parseFloat(n.replace(/[^0-9.]/g,""));return n.includes("km")?e*1e3:e};function gw(n){const e=Math.floor(n/3600),r=Math.floor(n/60)%60,h=n%60;let d="";return e>0&&(d=`${d}${e}h `),r>0&&(d=`${d}${r}min `),h>1&&(d=`${d}${h}s`),d}const rP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function aP({leg:n}){return n.interchangeFrom?.staySeated?X.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:rP,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const oP=Kg(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),sP=ps(oP),lP="/graphiql?flavor=transmodel";function cP({legId:n,legName:e}){const r={id:n},h=encodeURIComponent(sP),d=encodeURIComponent(JSON.stringify(r));return X.jsx("a",{href:lP+"&query="+h+"&variables="+d,target:"_blank",rel:"noreferrer",children:e})}const uP=Kg(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),hP=ps(uP),dP="/graphiql?flavor=transmodel";function hT({legId:n,legName:e}){const r={id:n},h=encodeURIComponent(hP),d=encodeURIComponent(JSON.stringify(r));return X.jsx("a",{href:dP+"&query="+h+"&variables="+d,target:"_blank",rel:"noreferrer",children:e})}const fP=Kg(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),pP=ps(fP),mP="/graphiql?flavor=transmodel";function gP({legId:n,legName:e}){const r={id:n},h=encodeURIComponent(pP),d=encodeURIComponent(JSON.stringify(r));return X.jsx("a",{href:mP+"&query="+h+"&variables="+d,target:"_blank",rel:"noreferrer",children:e})}function yP(n){return n.line?.publicCode?n.line.publicCode+" "+n.fromEstimatedCall?.destinationDisplay?.frontText:n.line?.name||"unknown"}function _P({leg:n,isLast:e}){return X.jsxs("div",{className:"itinerary-leg-details",children:[X.jsxs("div",{className:"times",children:[mw(n.distance),", ",gw(n.duration),","," ",X.jsxs("span",{title:"Generalized cost: ¢"+n.generalizedCost,children:["¢",n.generalizedCost]})]}),X.jsx(aP,{leg:n}),X.jsx(uT,{aimedTime:n.aimedStartTime,expectedTime:n.expectedStartTime,hasRealtime:n.realtime})," -"," ",X.jsx(uT,{aimedTime:n.aimedEndTime,expectedTime:n.expectedEndTime,hasRealtime:n.realtime}),X.jsxs("div",{className:"mode",children:[X.jsx("b",{children:n.mode})," ",n.line&&X.jsxs(X.Fragment,{children:[X.jsx(cP,{legId:n.line?.id,legName:yP(n)}),", ",X.jsx(gP,{legId:n.authority?.id,legName:n.authority?.name})]})," ",n.mode!==Ii.Foot&&X.jsxs(X.Fragment,{children:[X.jsx("br",{}),X.jsx(hT,{legId:n.fromPlace.quay?.id,legName:n.fromPlace.name})," →"," "]})," ",!e&&X.jsx(hT,{legId:n.toPlace.quay?.id,legName:n.toPlace.name})]})]})}function vP({tripPattern:n}){return X.jsxs("div",{children:[n.systemNotices.length>0&&X.jsxs("p",{children:["System tags: ",n.systemNotices.map(e=>e.tag).join(", ")]}),n.legs.map((e,r)=>X.jsx(_P,{leg:e,isLast:r===n.legs.length-1},e.id?e.id:`noid_${r}`)),X.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ¢",n.generalizedCost]})]})}function bP({previousPageCursor:n,nextPageCursor:e,onPagination:r,loading:h,comparisonSelectedIndexes:d,onCompare:m}){return X.jsxs("div",{className:"pagination-controls-container",children:[X.jsx(Of,{variant:"outline-primary",size:"sm",disabled:!n||h,onClick:()=>{n&&r(n)},children:"Previous page"}),X.jsx("div",{style:{textAlign:"center"},children:d?.length===2&&m&&X.jsx(Of,{variant:"primary",size:"sm",onClick:m,children:"Compare selected"})}),X.jsx(Of,{variant:"outline-primary",size:"sm",disabled:!e||h,onClick:()=>{e&&r(e)},children:"Next page"})]})}function xP({error:n,onDismiss:e}){if(!n)return null;const r=y=>{try{const c=y,E=String(c.message||"").toLowerCase(),C=c.code;if(E.includes("fetch")&&E.includes("failed"))return{userMessage:"Connection failed. Please check your internet connection and try again.",showRaw:!1};if(E.includes("network error")||C==="NETWORK_ERROR")return{userMessage:"Network error occurred. Please verify your internet connection and try again.",showRaw:!1};if(E.includes("enotfound")||E.includes("getaddrinfo"))return{userMessage:"Unable to reach the server. Please check your internet connection or try again later.",showRaw:!1};if(E.includes("timeout"))return{userMessage:"Request timed out. The server may be busy, please try again in a moment.",showRaw:!0};const k=c.response;if(k&&typeof k.status=="number"){const z=k.status;if(z>=500)return{userMessage:"Server error occurred. Please try again later.",showRaw:!0};if(z===404)return{userMessage:"Service not found. Please contact support if this issue persists.",showRaw:!0};if(z>=400)return{userMessage:"Request failed. Please check your search parameters and try again.",showRaw:!0}}if(k&&k.errors)return{userMessage:"Server returned an error response.",showRaw:!0}}catch{}return{userMessage:"An unexpected error occurred. Please try again.",showRaw:!0}},{userMessage:h,showRaw:d}=r(n);let m;try{const c=n.response;c&&c.errors?m=JSON.stringify(c.errors,null,2):c&&c.data?m=JSON.stringify(c.data,null,2):m=JSON.stringify(n,null,2)}catch{m="Unable to display error details"}return X.jsx("div",{className:"error-display-container",children:X.jsxs("div",{className:"flex-space-between",children:[X.jsxs("div",{className:"flex-1",children:[X.jsx("div",{className:"error-title",children:"Search Error"}),X.jsx("div",{className:"error-message",children:h}),d&&X.jsxs(X.Fragment,{children:[X.jsx("div",{className:"error-title",children:"Technical Details:"}),X.jsx("pre",{className:"error-details",children:m})]})]}),e&&X.jsx("button",{onClick:e,className:"error-dismiss-button","aria-label":"Dismiss error",children:"×"})]})})}function wP({hasSearched:n,tripQueryResult:e}){return!n||!e?null:X.jsx("div",{className:"no-results-display-container",children:X.jsx("div",{className:"flex-space-between",children:X.jsxs("div",{className:"flex-1",children:[X.jsx("div",{className:"info-title",children:"No Results Found"}),X.jsx("div",{className:"info-message",children:"No matching trips were found for your search criteria."}),X.jsx("div",{className:"info-title",children:"Raw Response:"}),X.jsx("pre",{className:"no-results-details",children:JSON.stringify(e,null,2)})]})})})}function TP({tripQueryResult:n,selectedTripPatternIndexes:e,setSelectedTripPatternIndexes:r,pageResults:h,loading:d,comparisonSelectedIndexes:m,setComparisonSelectedIndexes:y,onCompare:c,error:E}){const[C,k]=iP(n),{containerRef:z,containerWidth:F}=MO(),B=K.useContext(ny),Q=!!(n&&n.trip.tripPatterns.length===0),ie=n!==null,ne=E||ie&&!E&&Q;return X.jsxs("section",{className:"left-pane-container below-content",ref:z,children:[X.jsxs(X.Fragment,{children:[X.jsx("div",{className:"panel-header",children:"Itinerary results"}),X.jsx(xP,{error:E}),X.jsx(wP,{hasSearched:ie&&!E&&Q,tripQueryResult:n}),!ne&&X.jsx("div",{className:"pagination-controls",children:X.jsx(bP,{onPagination:h,previousPageCursor:n?.trip.previousPageCursor,nextPageCursor:n?.trip.nextPageCursor,loading:d,comparisonSelectedIndexes:m,onCompare:c})}),X.jsx(_v,{activeKey:e.map(String),onSelect:ue=>{const Ae=parseInt(ue);r(Te=>{if(Te.includes(Ae))return Te.filter(ke=>ke!==Ae);{const ke=[...Te,Ae];return ke.length>2?ke.slice(-2):ke}})},children:n&&n.trip.tripPatterns.map((ue,Ae)=>X.jsxs(_v.Item,{eventKey:`${Ae}`,bsPrefix:ue.systemNotices.length===0?"":"accordion-item-filtered",children:[X.jsx(_v.Header,{children:X.jsx(nP,{containerWidth:F,tripPattern:ue,itineraryIndex:Ae,earliestStartTime:C,latestEndTime:k,comparisonSelectedIndexes:m,setComparisonSelectedIndexes:y})}),X.jsx(_v.Body,{children:X.jsx(vP,{tripPattern:ue})})]},`${Ae}`))})]}),X.jsxs("div",{className:"time-zone-info",children:["All times in ",X.jsx("code",{children:B})]})]})}const Ef=(n,e,r="lower")=>n==null||e==null||n===e?"":(r==="lower"?n<e:n>e)?"compare-value-best":"",Af={duration:"lower",cost:"lower",legs:"lower",walkingDistance:"lower"},dT=(n,e)=>{if(!n)throw new Error("TripPattern is required");const r=hu(n.expectedStartTime,e,"short"),h=hu(n.expectedEndTime,e,"short"),d=gw(n.duration),m=n.generalizedCost,y=n.legs.filter(E=>E&&E.mode===Ii.Foot).reduce((E,C)=>E+C.distance,0),c=Math.max(0,n.legs.length-1);return{startTime:r,endTime:h,duration:d,generalizedCost:m,walkingDistance:mw(y),totalLegs:c}},fT=(n,e,r)=>n.map((h,d)=>{const m=h.id||`leg${e}_${d}`,y=h.fromPlace?.name||"Unknown",c=h.toPlace?.name||"Unknown",E=`${h.mode}${h.line?.publicCode?` (${h.line.publicCode})`:""} | ${y} → ${c} | ${hu(h.aimedStartTime,r,"short")} to ${hu(h.aimedEndTime,r,"short")}`;return{value:m,label:E}});function SP({itinerary1:n,itinerary2:e,summary1:r,summary2:h,selectedIndexes:d}){return X.jsxs(Eb,{bordered:!0,hover:!0,className:"compare-summary-table",children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{children:"Itinerary"}),X.jsx("th",{children:"Start Time"}),X.jsx("th",{children:"End Time"}),X.jsx("th",{children:"Duration"}),X.jsx("th",{children:"Cost"}),X.jsx("th",{children:"Transfers"}),X.jsx("th",{children:"Walking Distance"})]})}),X.jsxs("tbody",{children:[X.jsxs("tr",{children:[X.jsx("td",{children:X.jsxs("span",{className:"compare-itinerary-number",children:["#",d[0]+1]})}),X.jsx("td",{children:r.startTime}),X.jsx("td",{children:r.endTime}),X.jsx("td",{className:Ef(n.duration,e.duration,Af.duration),children:r.duration}),X.jsxs("td",{className:Ef(r.generalizedCost,h.generalizedCost,Af.cost),children:["¢",r.generalizedCost]}),X.jsx("td",{className:Ef(r.totalLegs,h.totalLegs,Af.legs),children:r.totalLegs}),X.jsx("td",{className:Ef(wv(r.walkingDistance),wv(h.walkingDistance),Af.walkingDistance),children:r.walkingDistance})]}),X.jsxs("tr",{children:[X.jsx("td",{children:X.jsxs("span",{className:"compare-itinerary-number",children:["#",d[1]+1]})}),X.jsx("td",{children:h.startTime}),X.jsx("td",{children:h.endTime}),X.jsx("td",{className:Ef(e.duration,n.duration,Af.duration),children:h.duration}),X.jsxs("td",{className:Ef(h.generalizedCost,r.generalizedCost,Af.cost),children:["¢",h.generalizedCost]}),X.jsx("td",{className:Ef(h.totalLegs,r.totalLegs,Af.legs),children:h.totalLegs}),X.jsx("td",{className:Ef(wv(h.walkingDistance),wv(r.walkingDistance),Af.walkingDistance),children:h.walkingDistance})]})]})]})}function om(n){"@babel/helpers - typeof";return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},om(n)}function EP(n,e){if(om(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var h=r.call(n,e);if(om(h)!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jA(n){var e=EP(n,"string");return om(e)=="symbol"?e:e+""}function T_(n,e,r){return(e=jA(e))in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function pT(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(n);e&&(h=h.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,h)}return r}function hn(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pT(Object(r),!0).forEach(function(h){T_(n,h,r[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):pT(Object(r)).forEach(function(h){Object.defineProperty(n,h,Object.getOwnPropertyDescriptor(r,h))})}return n}function AP(n){if(Array.isArray(n))return n}function MP(n,e){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var h,d,m,y,c=[],E=!0,C=!1;try{if(m=(r=r.call(n)).next,e===0){if(Object(r)!==r)return;E=!1}else for(;!(E=(h=m.call(r)).done)&&(c.push(h.value),c.length!==e);E=!0);}catch(k){C=!0,d=k}finally{try{if(!E&&r.return!=null&&(y=r.return(),Object(y)!==y))return}finally{if(C)throw d}}return c}}function c1(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,h=Array(e);r<e;r++)h[r]=n[r];return h}function FA(n,e){if(n){if(typeof n=="string")return c1(n,e);var r={}.toString.call(n).slice(8,-1);return r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set"?Array.from(n):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c1(n,e):void 0}}function CP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wd(n,e){return AP(n)||MP(n,e)||FA(n,e)||CP()}function Pd(n,e){if(n==null)return{};var r,h,d=$1(n,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(n);for(h=0;h<m.length;h++)r=m[h],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(n,r)&&(d[r]=n[r])}return d}var DP=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function IP(n){var e=n.defaultInputValue,r=e===void 0?"":e,h=n.defaultMenuIsOpen,d=h===void 0?!1:h,m=n.defaultValue,y=m===void 0?null:m,c=n.inputValue,E=n.menuIsOpen,C=n.onChange,k=n.onInputChange,z=n.onMenuClose,F=n.onMenuOpen,B=n.value,Q=Pd(n,DP),ie=K.useState(c!==void 0?c:r),ne=wd(ie,2),ue=ne[0],Ae=ne[1],Te=K.useState(E!==void 0?E:d),ke=wd(Te,2),be=ke[0],Me=ke[1],Fe=K.useState(B!==void 0?B:y),ot=wd(Fe,2),Ee=ot[0],Je=ot[1],Et=K.useCallback(function(xt,ut){typeof C=="function"&&C(xt,ut),Je(xt)},[C]),Tt=K.useCallback(function(xt,ut){var Ut;typeof k=="function"&&(Ut=k(xt,ut)),Ae(Ut!==void 0?Ut:xt)},[k]),zt=K.useCallback(function(){typeof F=="function"&&F(),Me(!0)},[F]),Zt=K.useCallback(function(){typeof z=="function"&&z(),Me(!1)},[z]),Gt=c!==void 0?c:ue,Ue=E!==void 0?E:be,st=B!==void 0?B:Ee;return hn(hn({},Q),{},{inputValue:Gt,menuIsOpen:Ue,onChange:Et,onInputChange:Tt,onMenuClose:Zt,onMenuOpen:zt,value:st})}function RP(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function mT(n,e){for(var r=0;r<e.length;r++){var h=e[r];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(n,jA(h.key),h)}}function kP(n,e,r){return e&&mT(n.prototype,e),r&&mT(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function OP(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Uv(n,e)}function Yv(n){return Yv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yv(n)}function BA(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BA=function(){return!!n})()}function PP(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function LP(n,e){if(e&&(om(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PP(n)}function zP(n){var e=BA();return function(){var r,h=Yv(n);if(e){var d=Yv(this).constructor;r=Reflect.construct(h,arguments,d)}else r=h.apply(this,arguments);return LP(this,r)}}function NP(n){if(Array.isArray(n))return c1(n)}function jP(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function FP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yw(n){return NP(n)||jP(n)||FA(n)||FP()}function BP(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function UP(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var VP=function(){function n(r){var h=this;this._insertTag=function(d){var m;h.tags.length===0?h.insertionPoint?m=h.insertionPoint.nextSibling:h.prepend?m=h.container.firstChild:m=h.before:m=h.tags[h.tags.length-1].nextSibling,h.container.insertBefore(d,m),h.tags.push(d)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(h){h.forEach(this._insertTag)},e.insert=function(h){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(UP(this));var d=this.tags[this.tags.length-1];if(this.isSpeedy){var m=BP(d);try{m.insertRule(h,m.cssRules.length)}catch{}}else d.appendChild(document.createTextNode(h));this.ctr++},e.flush=function(){this.tags.forEach(function(h){var d;return(d=h.parentNode)==null?void 0:d.removeChild(h)}),this.tags=[],this.ctr=0},n}(),Ro="-ms-",Hv="-moz-",Ci="-webkit-",UA="comm",_w="rule",vw="decl",GP="@import",VA="@keyframes",$P="@layer",ZP=Math.abs,Ab=String.fromCharCode,YP=Object.assign;function HP(n,e){return uo(n,0)^45?(((e<<2^uo(n,0))<<2^uo(n,1))<<2^uo(n,2))<<2^uo(n,3):0}function GA(n){return n.trim()}function qP(n,e){return(n=e.exec(n))?n[0]:n}function Di(n,e,r){return n.replace(e,r)}function u1(n,e){return n.indexOf(e)}function uo(n,e){return n.charCodeAt(e)|0}function Z_(n,e,r){return n.slice(e,r)}function Qu(n){return n.length}function bw(n){return n.length}function Tv(n,e){return e.push(n),n}function XP(n,e){return n.map(e).join("")}var Mb=1,Bg=1,$A=0,Zs=0,ma=0,iy="";function Cb(n,e,r,h,d,m,y){return{value:n,root:e,parent:r,type:h,props:d,children:m,line:Mb,column:Bg,length:y,return:""}}function p_(n,e){return YP(Cb("",null,null,"",null,null,0),n,{length:-n.length},e)}function WP(){return ma}function QP(){return ma=Zs>0?uo(iy,--Zs):0,Bg--,ma===10&&(Bg=1,Mb--),ma}function Ml(){return ma=Zs<$A?uo(iy,Zs++):0,Bg++,ma===10&&(Bg=1,Mb++),ma}function lh(){return uo(iy,Zs)}function Pv(){return Zs}function u0(n,e){return Z_(iy,n,e)}function Y_(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ZA(n){return Mb=Bg=1,$A=Qu(iy=n),Zs=0,[]}function YA(n){return iy="",n}function Lv(n){return GA(u0(Zs-1,h1(n===91?n+2:n===40?n+1:n)))}function KP(n){for(;(ma=lh())&&ma<33;)Ml();return Y_(n)>2||Y_(ma)>3?"":" "}function JP(n,e){for(;--e&&Ml()&&!(ma<48||ma>102||ma>57&&ma<65||ma>70&&ma<97););return u0(n,Pv()+(e<6&&lh()==32&&Ml()==32))}function h1(n){for(;Ml();)switch(ma){case n:return Zs;case 34:case 39:n!==34&&n!==39&&h1(ma);break;case 40:n===41&&h1(n);break;case 92:Ml();break}return Zs}function eL(n,e){for(;Ml()&&n+ma!==57;)if(n+ma===84&&lh()===47)break;return"/*"+u0(e,Zs-1)+"*"+Ab(n===47?n:Ml())}function tL(n){for(;!Y_(lh());)Ml();return u0(n,Zs)}function nL(n){return YA(zv("",null,null,null,[""],n=ZA(n),0,[0],n))}function zv(n,e,r,h,d,m,y,c,E){for(var C=0,k=0,z=y,F=0,B=0,Q=0,ie=1,ne=1,ue=1,Ae=0,Te="",ke=d,be=m,Me=h,Fe=Te;ne;)switch(Q=Ae,Ae=Ml()){case 40:if(Q!=108&&uo(Fe,z-1)==58){u1(Fe+=Di(Lv(Ae),"&","&\f"),"&\f")!=-1&&(ue=-1);break}case 34:case 39:case 91:Fe+=Lv(Ae);break;case 9:case 10:case 13:case 32:Fe+=KP(Q);break;case 92:Fe+=JP(Pv()-1,7);continue;case 47:switch(lh()){case 42:case 47:Tv(iL(eL(Ml(),Pv()),e,r),E);break;default:Fe+="/"}break;case 123*ie:c[C++]=Qu(Fe)*ue;case 125*ie:case 59:case 0:switch(Ae){case 0:case 125:ne=0;case 59+k:ue==-1&&(Fe=Di(Fe,/\f/g,"")),B>0&&Qu(Fe)-z&&Tv(B>32?yT(Fe+";",h,r,z-1):yT(Di(Fe," ","")+";",h,r,z-2),E);break;case 59:Fe+=";";default:if(Tv(Me=gT(Fe,e,r,C,k,d,c,Te,ke=[],be=[],z),m),Ae===123)if(k===0)zv(Fe,e,Me,Me,ke,m,z,c,be);else switch(F===99&&uo(Fe,3)===110?100:F){case 100:case 108:case 109:case 115:zv(n,Me,Me,h&&Tv(gT(n,Me,Me,0,0,d,c,Te,d,ke=[],z),be),d,be,z,c,h?ke:be);break;default:zv(Fe,Me,Me,Me,[""],be,0,c,be)}}C=k=B=0,ie=ue=1,Te=Fe="",z=y;break;case 58:z=1+Qu(Fe),B=Q;default:if(ie<1){if(Ae==123)--ie;else if(Ae==125&&ie++==0&&QP()==125)continue}switch(Fe+=Ab(Ae),Ae*ie){case 38:ue=k>0?1:(Fe+="\f",-1);break;case 44:c[C++]=(Qu(Fe)-1)*ue,ue=1;break;case 64:lh()===45&&(Fe+=Lv(Ml())),F=lh(),k=z=Qu(Te=Fe+=tL(Pv())),Ae++;break;case 45:Q===45&&Qu(Fe)==2&&(ie=0)}}return m}function gT(n,e,r,h,d,m,y,c,E,C,k){for(var z=d-1,F=d===0?m:[""],B=bw(F),Q=0,ie=0,ne=0;Q<h;++Q)for(var ue=0,Ae=Z_(n,z+1,z=ZP(ie=y[Q])),Te=n;ue<B;++ue)(Te=GA(ie>0?F[ue]+" "+Ae:Di(Ae,/&\f/g,F[ue])))&&(E[ne++]=Te);return Cb(n,e,r,d===0?_w:c,E,C,k)}function iL(n,e,r){return Cb(n,e,r,UA,Ab(WP()),Z_(n,2,-2),0)}function yT(n,e,r,h){return Cb(n,e,r,vw,Z_(n,0,h),Z_(n,h+1,-1),h)}function Ig(n,e){for(var r="",h=bw(n),d=0;d<h;d++)r+=e(n[d],d,n,e)||"";return r}function rL(n,e,r,h){switch(n.type){case $P:if(n.children.length)break;case GP:case vw:return n.return=n.return||n.value;case UA:return"";case VA:return n.return=n.value+"{"+Ig(n.children,h)+"}";case _w:n.value=n.props.join(",")}return Qu(r=Ig(n.children,h))?n.return=n.value+"{"+r+"}":""}function aL(n){var e=bw(n);return function(r,h,d,m){for(var y="",c=0;c<e;c++)y+=n[c](r,h,d,m)||"";return y}}function oL(n){return function(e){e.root||(e=e.return)&&n(e)}}function sL(n){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=n(r)),e[r]}}var lL=function(e,r,h){for(var d=0,m=0;d=m,m=lh(),d===38&&m===12&&(r[h]=1),!Y_(m);)Ml();return u0(e,Zs)},cL=function(e,r){var h=-1,d=44;do switch(Y_(d)){case 0:d===38&&lh()===12&&(r[h]=1),e[h]+=lL(Zs-1,r,h);break;case 2:e[h]+=Lv(d);break;case 4:if(d===44){e[++h]=lh()===58?"&\f":"",r[h]=e[h].length;break}default:e[h]+=Ab(d)}while(d=Ml());return e},uL=function(e,r){return YA(cL(ZA(e),r))},_T=new WeakMap,hL=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,h=e.parent,d=e.column===h.column&&e.line===h.line;h.type!=="rule";)if(h=h.parent,!h)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!_T.get(h))&&!d){_T.set(e,!0);for(var m=[],y=uL(r,m),c=h.props,E=0,C=0;E<y.length;E++)for(var k=0;k<c.length;k++,C++)e.props[C]=m[E]?y[E].replace(/&\f/g,c[k]):c[k]+" "+y[E]}}},dL=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function HA(n,e){switch(HP(n,e)){case 5103:return Ci+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ci+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Ci+n+Hv+n+Ro+n+n;case 6828:case 4268:return Ci+n+Ro+n+n;case 6165:return Ci+n+Ro+"flex-"+n+n;case 5187:return Ci+n+Di(n,/(\w+).+(:[^]+)/,Ci+"box-$1$2"+Ro+"flex-$1$2")+n;case 5443:return Ci+n+Ro+"flex-item-"+Di(n,/flex-|-self/,"")+n;case 4675:return Ci+n+Ro+"flex-line-pack"+Di(n,/align-content|flex-|-self/,"")+n;case 5548:return Ci+n+Ro+Di(n,"shrink","negative")+n;case 5292:return Ci+n+Ro+Di(n,"basis","preferred-size")+n;case 6060:return Ci+"box-"+Di(n,"-grow","")+Ci+n+Ro+Di(n,"grow","positive")+n;case 4554:return Ci+Di(n,/([^-])(transform)/g,"$1"+Ci+"$2")+n;case 6187:return Di(Di(Di(n,/(zoom-|grab)/,Ci+"$1"),/(image-set)/,Ci+"$1"),n,"")+n;case 5495:case 3959:return Di(n,/(image-set\([^]*)/,Ci+"$1$`$1");case 4968:return Di(Di(n,/(.+:)(flex-)?(.*)/,Ci+"box-pack:$3"+Ro+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ci+n+n;case 4095:case 3583:case 4068:case 2532:return Di(n,/(.+)-inline(.+)/,Ci+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qu(n)-1-e>6)switch(uo(n,e+1)){case 109:if(uo(n,e+4)!==45)break;case 102:return Di(n,/(.+:)(.+)-([^]+)/,"$1"+Ci+"$2-$3$1"+Hv+(uo(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~u1(n,"stretch")?HA(Di(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(uo(n,e+1)!==115)break;case 6444:switch(uo(n,Qu(n)-3-(~u1(n,"!important")&&10))){case 107:return Di(n,":",":"+Ci)+n;case 101:return Di(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ci+(uo(n,14)===45?"inline-":"")+"box$3$1"+Ci+"$2$3$1"+Ro+"$2box$3")+n}break;case 5936:switch(uo(n,e+11)){case 114:return Ci+n+Ro+Di(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Ci+n+Ro+Di(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Ci+n+Ro+Di(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Ci+n+Ro+n+n}return n}var fL=function(e,r,h,d){if(e.length>-1&&!e.return)switch(e.type){case vw:e.return=HA(e.value,e.length);break;case VA:return Ig([p_(e,{value:Di(e.value,"@","@"+Ci)})],d);case _w:if(e.length)return XP(e.props,function(m){switch(qP(m,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ig([p_(e,{props:[Di(m,/:(read-\w+)/,":"+Hv+"$1")]})],d);case"::placeholder":return Ig([p_(e,{props:[Di(m,/:(plac\w+)/,":"+Ci+"input-$1")]}),p_(e,{props:[Di(m,/:(plac\w+)/,":"+Hv+"$1")]}),p_(e,{props:[Di(m,/:(plac\w+)/,Ro+"input-$1")]})],d)}return""})}},pL=[fL],mL=function(e){var r=e.key;if(r==="css"){var h=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(h,function(ie){var ne=ie.getAttribute("data-emotion");ne.indexOf(" ")!==-1&&(document.head.appendChild(ie),ie.setAttribute("data-s",""))})}var d=e.stylisPlugins||pL,m={},y,c=[];y=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(ie){for(var ne=ie.getAttribute("data-emotion").split(" "),ue=1;ue<ne.length;ue++)m[ne[ue]]=!0;c.push(ie)});var E,C=[hL,dL];{var k,z=[rL,oL(function(ie){k.insert(ie)})],F=aL(C.concat(d,z)),B=function(ne){return Ig(nL(ne),F)};E=function(ne,ue,Ae,Te){k=Ae,B(ne?ne+"{"+ue.styles+"}":ue.styles),Te&&(Q.inserted[ue.name]=!0)}}var Q={key:r,sheet:new VP({key:r,container:y,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:m,registered:{},insert:E};return Q.sheet.hydrate(c),Q},Ix={exports:{}},ji={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vT;function gL(){if(vT)return ji;vT=1;var n=typeof Symbol=="function"&&Symbol.for,e=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,h=n?Symbol.for("react.fragment"):60107,d=n?Symbol.for("react.strict_mode"):60108,m=n?Symbol.for("react.profiler"):60114,y=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,E=n?Symbol.for("react.async_mode"):60111,C=n?Symbol.for("react.concurrent_mode"):60111,k=n?Symbol.for("react.forward_ref"):60112,z=n?Symbol.for("react.suspense"):60113,F=n?Symbol.for("react.suspense_list"):60120,B=n?Symbol.for("react.memo"):60115,Q=n?Symbol.for("react.lazy"):60116,ie=n?Symbol.for("react.block"):60121,ne=n?Symbol.for("react.fundamental"):60117,ue=n?Symbol.for("react.responder"):60118,Ae=n?Symbol.for("react.scope"):60119;function Te(be){if(typeof be=="object"&&be!==null){var Me=be.$$typeof;switch(Me){case e:switch(be=be.type,be){case E:case C:case h:case m:case d:case z:return be;default:switch(be=be&&be.$$typeof,be){case c:case k:case Q:case B:case y:return be;default:return Me}}case r:return Me}}}function ke(be){return Te(be)===C}return ji.AsyncMode=E,ji.ConcurrentMode=C,ji.ContextConsumer=c,ji.ContextProvider=y,ji.Element=e,ji.ForwardRef=k,ji.Fragment=h,ji.Lazy=Q,ji.Memo=B,ji.Portal=r,ji.Profiler=m,ji.StrictMode=d,ji.Suspense=z,ji.isAsyncMode=function(be){return ke(be)||Te(be)===E},ji.isConcurrentMode=ke,ji.isContextConsumer=function(be){return Te(be)===c},ji.isContextProvider=function(be){return Te(be)===y},ji.isElement=function(be){return typeof be=="object"&&be!==null&&be.$$typeof===e},ji.isForwardRef=function(be){return Te(be)===k},ji.isFragment=function(be){return Te(be)===h},ji.isLazy=function(be){return Te(be)===Q},ji.isMemo=function(be){return Te(be)===B},ji.isPortal=function(be){return Te(be)===r},ji.isProfiler=function(be){return Te(be)===m},ji.isStrictMode=function(be){return Te(be)===d},ji.isSuspense=function(be){return Te(be)===z},ji.isValidElementType=function(be){return typeof be=="string"||typeof be=="function"||be===h||be===C||be===m||be===d||be===z||be===F||typeof be=="object"&&be!==null&&(be.$$typeof===Q||be.$$typeof===B||be.$$typeof===y||be.$$typeof===c||be.$$typeof===k||be.$$typeof===ne||be.$$typeof===ue||be.$$typeof===Ae||be.$$typeof===ie)},ji.typeOf=Te,ji}var bT;function yL(){return bT||(bT=1,Ix.exports=gL()),Ix.exports}var Rx,xT;function _L(){if(xT)return Rx;xT=1;var n=yL(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},h={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},d={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},m={};m[n.ForwardRef]=h,m[n.Memo]=d;function y(Q){return n.isMemo(Q)?d:m[Q.$$typeof]||e}var c=Object.defineProperty,E=Object.getOwnPropertyNames,C=Object.getOwnPropertySymbols,k=Object.getOwnPropertyDescriptor,z=Object.getPrototypeOf,F=Object.prototype;function B(Q,ie,ne){if(typeof ie!="string"){if(F){var ue=z(ie);ue&&ue!==F&&B(Q,ue,ne)}var Ae=E(ie);C&&(Ae=Ae.concat(C(ie)));for(var Te=y(Q),ke=y(ie),be=0;be<Ae.length;++be){var Me=Ae[be];if(!r[Me]&&!(ne&&ne[Me])&&!(ke&&ke[Me])&&!(Te&&Te[Me])){var Fe=k(ie,Me);try{c(Q,Me,Fe)}catch{}}}}return Q}return Rx=B,Rx}_L();var vL=!0;function bL(n,e,r){var h="";return r.split(" ").forEach(function(d){n[d]!==void 0?e.push(n[d]+";"):d&&(h+=d+" ")}),h}var qA=function(e,r,h){var d=e.key+"-"+r.name;(h===!1||vL===!1)&&e.registered[d]===void 0&&(e.registered[d]=r.styles)},xL=function(e,r,h){qA(e,r,h);var d=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var m=r;do e.insert(r===m?"."+d:"",m,e.sheet,!0),m=m.next;while(m!==void 0)}};function wL(n){for(var e=0,r,h=0,d=n.length;d>=4;++h,d-=4)r=n.charCodeAt(h)&255|(n.charCodeAt(++h)&255)<<8|(n.charCodeAt(++h)&255)<<16|(n.charCodeAt(++h)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(d){case 3:e^=(n.charCodeAt(h+2)&255)<<16;case 2:e^=(n.charCodeAt(h+1)&255)<<8;case 1:e^=n.charCodeAt(h)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var TL={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},SL=/[A-Z]|^ms/g,EL=/_EMO_([^_]+?)_([^]*?)_EMO_/g,XA=function(e){return e.charCodeAt(1)===45},wT=function(e){return e!=null&&typeof e!="boolean"},kx=sL(function(n){return XA(n)?n:n.replace(SL,"-$&").toLowerCase()}),TT=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(EL,function(h,d,m){return Ku={name:d,styles:m,next:Ku},d})}return TL[e]!==1&&!XA(e)&&typeof r=="number"&&r!==0?r+"px":r};function H_(n,e,r){if(r==null)return"";var h=r;if(h.__emotion_styles!==void 0)return h;switch(typeof r){case"boolean":return"";case"object":{var d=r;if(d.anim===1)return Ku={name:d.name,styles:d.styles,next:Ku},d.name;var m=r;if(m.styles!==void 0){var y=m.next;if(y!==void 0)for(;y!==void 0;)Ku={name:y.name,styles:y.styles,next:Ku},y=y.next;var c=m.styles+";";return c}return AL(n,e,r)}case"function":{if(n!==void 0){var E=Ku,C=r(n);return Ku=E,H_(n,e,C)}break}}var k=r;return k}function AL(n,e,r){var h="";if(Array.isArray(r))for(var d=0;d<r.length;d++)h+=H_(n,e,r[d])+";";else for(var m in r){var y=r[m];if(typeof y!="object"){var c=y;wT(c)&&(h+=kx(m)+":"+TT(m,c)+";")}else if(Array.isArray(y)&&typeof y[0]=="string"&&e==null)for(var E=0;E<y.length;E++)wT(y[E])&&(h+=kx(m)+":"+TT(m,y[E])+";");else{var C=H_(n,e,y);switch(m){case"animation":case"animationName":{h+=kx(m)+":"+C+";";break}default:h+=m+"{"+C+"}"}}}return h}var ST=/label:\s*([^\s;{]+)\s*(;|$)/g,Ku;function WA(n,e,r){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var h=!0,d="";Ku=void 0;var m=n[0];if(m==null||m.raw===void 0)h=!1,d+=H_(r,e,m);else{var y=m;d+=y[0]}for(var c=1;c<n.length;c++)if(d+=H_(r,e,n[c]),h){var E=m;d+=E[c]}ST.lastIndex=0;for(var C="",k;(k=ST.exec(d))!==null;)C+="-"+k[1];var z=wL(d)+C;return{name:z,styles:d,next:Ku}}var ML=function(e){return e()},CL=Qw.useInsertionEffect?Qw.useInsertionEffect:!1,DL=CL||ML,QA=K.createContext(typeof HTMLElement<"u"?mL({key:"css"}):null);QA.Provider;var IL=function(e){return K.forwardRef(function(r,h){var d=K.useContext(QA);return e(r,d,h)})},RL=K.createContext({}),xw={}.hasOwnProperty,d1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",kL=function(e,r){var h={};for(var d in r)xw.call(r,d)&&(h[d]=r[d]);return h[d1]=e,h},OL=function(e){var r=e.cache,h=e.serialized,d=e.isStringTag;return qA(r,h,d),DL(function(){return xL(r,h,d)}),null},PL=IL(function(n,e,r){var h=n.css;typeof h=="string"&&e.registered[h]!==void 0&&(h=e.registered[h]);var d=n[d1],m=[h],y="";typeof n.className=="string"?y=bL(e.registered,m,n.className):n.className!=null&&(y=n.className+" ");var c=WA(m,void 0,K.useContext(RL));y+=e.key+"-"+c.name;var E={};for(var C in n)xw.call(n,C)&&C!=="css"&&C!==d1&&(E[C]=n[C]);return E.className=y,r&&(E.ref=r),K.createElement(K.Fragment,null,K.createElement(OL,{cache:e,serialized:c,isStringTag:typeof d=="string"}),K.createElement(d,E))}),LL=PL,an=function(e,r){var h=arguments;if(r==null||!xw.call(r,"css"))return K.createElement.apply(void 0,h);var d=h.length,m=new Array(d);m[0]=LL,m[1]=kL(e,r);for(var y=2;y<d;y++)m[y]=h[y];return K.createElement.apply(null,m)};(function(n){var e;e||(e=n.JSX||(n.JSX={}))})(an||(an={}));function ww(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return WA(e)}function zL(){var n=ww.apply(void 0,arguments),e="animation-"+n.name;return{name:e,styles:"@keyframes "+e+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function NL(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}const jL=Math.min,FL=Math.max,qv=Math.round,Sv=Math.floor,Xv=n=>({x:n,y:n});function BL(n){const{x:e,y:r,width:h,height:d}=n;return{width:h,height:d,top:r,left:e,right:e+h,bottom:r+d,x:e,y:r}}function Db(){return typeof window<"u"}function KA(n){return eM(n)?(n.nodeName||"").toLowerCase():"#document"}function Id(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function JA(n){var e;return(e=(eM(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function eM(n){return Db()?n instanceof Node||n instanceof Id(n).Node:!1}function UL(n){return Db()?n instanceof Element||n instanceof Id(n).Element:!1}function Tw(n){return Db()?n instanceof HTMLElement||n instanceof Id(n).HTMLElement:!1}function ET(n){return!Db()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Id(n).ShadowRoot}function tM(n){const{overflow:e,overflowX:r,overflowY:h,display:d}=Sw(n);return/auto|scroll|overlay|hidden|clip/.test(e+h+r)&&!["inline","contents"].includes(d)}function VL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function GL(n){return["html","body","#document"].includes(KA(n))}function Sw(n){return Id(n).getComputedStyle(n)}function $L(n){if(KA(n)==="html")return n;const e=n.assignedSlot||n.parentNode||ET(n)&&n.host||JA(n);return ET(e)?e.host:e}function nM(n){const e=$L(n);return GL(e)?n.ownerDocument?n.ownerDocument.body:n.body:Tw(e)&&tM(e)?e:nM(e)}function Wv(n,e,r){var h;e===void 0&&(e=[]),r===void 0&&(r=!0);const d=nM(n),m=d===((h=n.ownerDocument)==null?void 0:h.body),y=Id(d);if(m){const c=f1(y);return e.concat(y,y.visualViewport||[],tM(d)?d:[],c&&r?Wv(c):[])}return e.concat(d,Wv(d,[],r))}function f1(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function ZL(n){const e=Sw(n);let r=parseFloat(e.width)||0,h=parseFloat(e.height)||0;const d=Tw(n),m=d?n.offsetWidth:r,y=d?n.offsetHeight:h,c=qv(r)!==m||qv(h)!==y;return c&&(r=m,h=y),{width:r,height:h,$:c}}function Ew(n){return UL(n)?n:n.contextElement}function AT(n){const e=Ew(n);if(!Tw(e))return Xv(1);const r=e.getBoundingClientRect(),{width:h,height:d,$:m}=ZL(e);let y=(m?qv(r.width):r.width)/h,c=(m?qv(r.height):r.height)/d;return(!y||!Number.isFinite(y))&&(y=1),(!c||!Number.isFinite(c))&&(c=1),{x:y,y:c}}const YL=Xv(0);function HL(n){const e=Id(n);return!VL()||!e.visualViewport?YL:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function qL(n,e,r){return!1}function MT(n,e,r,h){e===void 0&&(e=!1);const d=n.getBoundingClientRect(),m=Ew(n);let y=Xv(1);e&&(y=AT(n));const c=qL()?HL(m):Xv(0);let E=(d.left+c.x)/y.x,C=(d.top+c.y)/y.y,k=d.width/y.x,z=d.height/y.y;if(m){const F=Id(m),B=h;let Q=F,ie=f1(Q);for(;ie&&h&&B!==Q;){const ne=AT(ie),ue=ie.getBoundingClientRect(),Ae=Sw(ie),Te=ue.left+(ie.clientLeft+parseFloat(Ae.paddingLeft))*ne.x,ke=ue.top+(ie.clientTop+parseFloat(Ae.paddingTop))*ne.y;E*=ne.x,C*=ne.y,k*=ne.x,z*=ne.y,E+=Te,C+=ke,Q=Id(ie),ie=f1(Q)}}return BL({width:k,height:z,x:E,y:C})}function XL(n,e){let r=null,h;const d=JA(n);function m(){var c;clearTimeout(h),(c=r)==null||c.disconnect(),r=null}function y(c,E){c===void 0&&(c=!1),E===void 0&&(E=1),m();const{left:C,top:k,width:z,height:F}=n.getBoundingClientRect();if(c||e(),!z||!F)return;const B=Sv(k),Q=Sv(d.clientWidth-(C+z)),ie=Sv(d.clientHeight-(k+F)),ne=Sv(C),Ae={rootMargin:-B+"px "+-Q+"px "+-ie+"px "+-ne+"px",threshold:FL(0,jL(1,E))||1};let Te=!0;function ke(be){const Me=be[0].intersectionRatio;if(Me!==E){if(!Te)return y();Me?y(!1,Me):h=setTimeout(()=>{y(!1,1e-7)},1e3)}Te=!1}try{r=new IntersectionObserver(ke,{...Ae,root:d.ownerDocument})}catch{r=new IntersectionObserver(ke,Ae)}r.observe(n)}return y(!0),m}function WL(n,e,r,h){h===void 0&&(h={});const{ancestorScroll:d=!0,ancestorResize:m=!0,elementResize:y=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:E=!1}=h,C=Ew(n),k=d||m?[...C?Wv(C):[],...Wv(e)]:[];k.forEach(ue=>{d&&ue.addEventListener("scroll",r,{passive:!0}),m&&ue.addEventListener("resize",r)});const z=C&&c?XL(C,r):null;let F=-1,B=null;y&&(B=new ResizeObserver(ue=>{let[Ae]=ue;Ae&&Ae.target===C&&B&&(B.unobserve(e),cancelAnimationFrame(F),F=requestAnimationFrame(()=>{var Te;(Te=B)==null||Te.observe(e)})),r()}),C&&!E&&B.observe(C),B.observe(e));let Q,ie=E?MT(n):null;E&&ne();function ne(){const ue=MT(n);ie&&(ue.x!==ie.x||ue.y!==ie.y||ue.width!==ie.width||ue.height!==ie.height)&&r(),ie=ue,Q=requestAnimationFrame(ne)}return r(),()=>{var ue;k.forEach(Ae=>{d&&Ae.removeEventListener("scroll",r),m&&Ae.removeEventListener("resize",r)}),z?.(),(ue=B)==null||ue.disconnect(),B=null,E&&cancelAnimationFrame(Q)}}var p1=K.useLayoutEffect,QL=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Qv=function(){};function KL(n,e){return e?e[0]==="-"?n+e:n+"__"+e:n}function JL(n,e){for(var r=arguments.length,h=new Array(r>2?r-2:0),d=2;d<r;d++)h[d-2]=arguments[d];var m=[].concat(h);if(e&&n)for(var y in e)e.hasOwnProperty(y)&&e[y]&&m.push("".concat(KL(n,y)));return m.filter(function(c){return c}).map(function(c){return String(c).trim()}).join(" ")}var CT=function(e){return lz(e)?e.filter(Boolean):om(e)==="object"&&e!==null?[e]:[]},iM=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var r=Pd(e,QL);return hn({},r)},Kr=function(e,r,h){var d=e.cx,m=e.getStyles,y=e.getClassNames,c=e.className;return{css:m(r,e),className:d(h??{},y(r,e),c)}};function Ib(n){return[document.documentElement,document.body,window].indexOf(n)>-1}function ez(n){return Ib(n)?window.innerHeight:n.clientHeight}function rM(n){return Ib(n)?window.pageYOffset:n.scrollTop}function Kv(n,e){if(Ib(n)){window.scrollTo(0,e);return}n.scrollTop=e}function tz(n){var e=getComputedStyle(n),r=e.position==="absolute",h=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var d=n;d=d.parentElement;)if(e=getComputedStyle(d),!(r&&e.position==="static")&&h.test(e.overflow+e.overflowY+e.overflowX))return d;return document.documentElement}function nz(n,e,r,h){return r*((n=n/h-1)*n*n+1)+e}function Ev(n,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Qv,d=rM(n),m=e-d,y=10,c=0;function E(){c+=y;var C=nz(c,d,m,r);Kv(n,C),c<r?window.requestAnimationFrame(E):h(n)}E()}function DT(n,e){var r=n.getBoundingClientRect(),h=e.getBoundingClientRect(),d=e.offsetHeight/3;h.bottom+d>r.bottom?Kv(n,Math.min(e.offsetTop+e.clientHeight-n.offsetHeight+d,n.scrollHeight)):h.top-d<r.top&&Kv(n,Math.max(e.offsetTop-d,0))}function iz(n){var e=n.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function IT(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function rz(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var aM=!1,az={get passive(){return aM=!0}},Av=typeof window<"u"?window:{};Av.addEventListener&&Av.removeEventListener&&(Av.addEventListener("p",Qv,az),Av.removeEventListener("p",Qv,!1));var oz=aM;function sz(n){return n!=null}function lz(n){return Array.isArray(n)}function Mv(n,e,r){return n?e:r}var cz=function(e){for(var r=arguments.length,h=new Array(r>1?r-1:0),d=1;d<r;d++)h[d-1]=arguments[d];var m=Object.entries(e).filter(function(y){var c=wd(y,1),E=c[0];return!h.includes(E)});return m.reduce(function(y,c){var E=wd(c,2),C=E[0],k=E[1];return y[C]=k,y},{})},uz=["children","innerProps"],hz=["children","innerProps"];function dz(n){var e=n.maxHeight,r=n.menuEl,h=n.minHeight,d=n.placement,m=n.shouldScroll,y=n.isFixedPosition,c=n.controlHeight,E=tz(r),C={placement:"bottom",maxHeight:e};if(!r||!r.offsetParent)return C;var k=E.getBoundingClientRect(),z=k.height,F=r.getBoundingClientRect(),B=F.bottom,Q=F.height,ie=F.top,ne=r.offsetParent.getBoundingClientRect(),ue=ne.top,Ae=y?window.innerHeight:ez(E),Te=rM(E),ke=parseInt(getComputedStyle(r).marginBottom,10),be=parseInt(getComputedStyle(r).marginTop,10),Me=ue-be,Fe=Ae-ie,ot=Me+Te,Ee=z-Te-ie,Je=B-Ae+Te+ke,Et=Te+ie-be,Tt=160;switch(d){case"auto":case"bottom":if(Fe>=Q)return{placement:"bottom",maxHeight:e};if(Ee>=Q&&!y)return m&&Ev(E,Je,Tt),{placement:"bottom",maxHeight:e};if(!y&&Ee>=h||y&&Fe>=h){m&&Ev(E,Je,Tt);var zt=y?Fe-ke:Ee-ke;return{placement:"bottom",maxHeight:zt}}if(d==="auto"||y){var Zt=e,Gt=y?Me:ot;return Gt>=h&&(Zt=Math.min(Gt-ke-c,e)),{placement:"top",maxHeight:Zt}}if(d==="bottom")return m&&Kv(E,Je),{placement:"bottom",maxHeight:e};break;case"top":if(Me>=Q)return{placement:"top",maxHeight:e};if(ot>=Q&&!y)return m&&Ev(E,Et,Tt),{placement:"top",maxHeight:e};if(!y&&ot>=h||y&&Me>=h){var Ue=e;return(!y&&ot>=h||y&&Me>=h)&&(Ue=y?Me-be:ot-be),m&&Ev(E,Et,Tt),{placement:"top",maxHeight:Ue}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(d,'".'))}return C}function fz(n){var e={bottom:"top",top:"bottom"};return n?e[n]:"bottom"}var oM=function(e){return e==="auto"?"bottom":e},pz=function(e,r){var h,d=e.placement,m=e.theme,y=m.borderRadius,c=m.spacing,E=m.colors;return hn((h={label:"menu"},T_(h,fz(d),"100%"),T_(h,"position","absolute"),T_(h,"width","100%"),T_(h,"zIndex",1),h),r?{}:{backgroundColor:E.neutral0,borderRadius:y,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:c.menuGutter,marginTop:c.menuGutter})},sM=K.createContext(null),mz=function(e){var r=e.children,h=e.minMenuHeight,d=e.maxMenuHeight,m=e.menuPlacement,y=e.menuPosition,c=e.menuShouldScrollIntoView,E=e.theme,C=K.useContext(sM)||{},k=C.setPortalPlacement,z=K.useRef(null),F=K.useState(d),B=wd(F,2),Q=B[0],ie=B[1],ne=K.useState(null),ue=wd(ne,2),Ae=ue[0],Te=ue[1],ke=E.spacing.controlHeight;return p1(function(){var be=z.current;if(be){var Me=y==="fixed",Fe=c&&!Me,ot=dz({maxHeight:d,menuEl:be,minHeight:h,placement:m,shouldScroll:Fe,isFixedPosition:Me,controlHeight:ke});ie(ot.maxHeight),Te(ot.placement),k?.(ot.placement)}},[d,m,y,c,h,k,ke]),r({ref:z,placerProps:hn(hn({},e),{},{placement:Ae||oM(m),maxHeight:Q})})},gz=function(e){var r=e.children,h=e.innerRef,d=e.innerProps;return an("div",fn({},Kr(e,"menu",{menu:!0}),{ref:h},d),r)},yz=gz,_z=function(e,r){var h=e.maxHeight,d=e.theme.spacing.baseUnit;return hn({maxHeight:h,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r?{}:{paddingBottom:d,paddingTop:d})},vz=function(e){var r=e.children,h=e.innerProps,d=e.innerRef,m=e.isMulti;return an("div",fn({},Kr(e,"menuList",{"menu-list":!0,"menu-list--is-multi":m}),{ref:d},h),r)},lM=function(e,r){var h=e.theme,d=h.spacing.baseUnit,m=h.colors;return hn({textAlign:"center"},r?{}:{color:m.neutral40,padding:"".concat(d*2,"px ").concat(d*3,"px")})},bz=lM,xz=lM,wz=function(e){var r=e.children,h=r===void 0?"No options":r,d=e.innerProps,m=Pd(e,uz);return an("div",fn({},Kr(hn(hn({},m),{},{children:h,innerProps:d}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),d),h)},Tz=function(e){var r=e.children,h=r===void 0?"Loading...":r,d=e.innerProps,m=Pd(e,hz);return an("div",fn({},Kr(hn(hn({},m),{},{children:h,innerProps:d}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),d),h)},Sz=function(e){var r=e.rect,h=e.offset,d=e.position;return{left:r.left,position:d,top:h,width:r.width,zIndex:1}},Ez=function(e){var r=e.appendTo,h=e.children,d=e.controlElement,m=e.innerProps,y=e.menuPlacement,c=e.menuPosition,E=K.useRef(null),C=K.useRef(null),k=K.useState(oM(y)),z=wd(k,2),F=z[0],B=z[1],Q=K.useMemo(function(){return{setPortalPlacement:B}},[]),ie=K.useState(null),ne=wd(ie,2),ue=ne[0],Ae=ne[1],Te=K.useCallback(function(){if(d){var Fe=iz(d),ot=c==="fixed"?0:window.pageYOffset,Ee=Fe[F]+ot;(Ee!==ue?.offset||Fe.left!==ue?.rect.left||Fe.width!==ue?.rect.width)&&Ae({offset:Ee,rect:Fe})}},[d,c,F,ue?.offset,ue?.rect.left,ue?.rect.width]);p1(function(){Te()},[Te]);var ke=K.useCallback(function(){typeof C.current=="function"&&(C.current(),C.current=null),d&&E.current&&(C.current=WL(d,E.current,Te,{elementResize:"ResizeObserver"in window}))},[d,Te]);p1(function(){ke()},[ke]);var be=K.useCallback(function(Fe){E.current=Fe,ke()},[ke]);if(!r&&c!=="fixed"||!ue)return null;var Me=an("div",fn({ref:be},Kr(hn(hn({},e),{},{offset:ue.offset,position:c,rect:ue.rect}),"menuPortal",{"menu-portal":!0}),m),h);return an(sM.Provider,{value:Q},r?db.createPortal(Me,r):Me)},Az=function(e){var r=e.isDisabled,h=e.isRtl;return{label:"container",direction:h?"rtl":void 0,pointerEvents:r?"none":void 0,position:"relative"}},Mz=function(e){var r=e.children,h=e.innerProps,d=e.isDisabled,m=e.isRtl;return an("div",fn({},Kr(e,"container",{"--is-disabled":d,"--is-rtl":m}),h),r)},Cz=function(e,r){var h=e.theme.spacing,d=e.isMulti,m=e.hasValue,y=e.selectProps.controlShouldRenderValue;return hn({alignItems:"center",display:d&&m&&y?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},r?{}:{padding:"".concat(h.baseUnit/2,"px ").concat(h.baseUnit*2,"px")})},Dz=function(e){var r=e.children,h=e.innerProps,d=e.isMulti,m=e.hasValue;return an("div",fn({},Kr(e,"valueContainer",{"value-container":!0,"value-container--is-multi":d,"value-container--has-value":m}),h),r)},Iz=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Rz=function(e){var r=e.children,h=e.innerProps;return an("div",fn({},Kr(e,"indicatorsContainer",{indicators:!0}),h),r)},RT,kz=["size"],Oz=["innerProps","isRtl","size"],Pz={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},cM=function(e){var r=e.size,h=Pd(e,kz);return an("svg",fn({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Pz},h))},Aw=function(e){return an(cM,fn({size:20},e),an("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},uM=function(e){return an(cM,fn({size:20},e),an("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},hM=function(e,r){var h=e.isFocused,d=e.theme,m=d.spacing.baseUnit,y=d.colors;return hn({label:"indicatorContainer",display:"flex",transition:"color 150ms"},r?{}:{color:h?y.neutral60:y.neutral20,padding:m*2,":hover":{color:h?y.neutral80:y.neutral40}})},Lz=hM,zz=function(e){var r=e.children,h=e.innerProps;return an("div",fn({},Kr(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),h),r||an(uM,null))},Nz=hM,jz=function(e){var r=e.children,h=e.innerProps;return an("div",fn({},Kr(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),h),r||an(Aw,null))},Fz=function(e,r){var h=e.isDisabled,d=e.theme,m=d.spacing.baseUnit,y=d.colors;return hn({label:"indicatorSeparator",alignSelf:"stretch",width:1},r?{}:{backgroundColor:h?y.neutral10:y.neutral20,marginBottom:m*2,marginTop:m*2})},Bz=function(e){var r=e.innerProps;return an("span",fn({},r,Kr(e,"indicatorSeparator",{"indicator-separator":!0})))},Uz=zL(RT||(RT=NL([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),Vz=function(e,r){var h=e.isFocused,d=e.size,m=e.theme,y=m.colors,c=m.spacing.baseUnit;return hn({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:d,lineHeight:1,marginRight:d,textAlign:"center",verticalAlign:"middle"},r?{}:{color:h?y.neutral60:y.neutral20,padding:c*2})},Ox=function(e){var r=e.delay,h=e.offset;return an("span",{css:ww({animation:"".concat(Uz," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:h?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Gz=function(e){var r=e.innerProps,h=e.isRtl,d=e.size,m=d===void 0?4:d,y=Pd(e,Oz);return an("div",fn({},Kr(hn(hn({},y),{},{innerProps:r,isRtl:h,size:m}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),r),an(Ox,{delay:0,offset:h}),an(Ox,{delay:160,offset:!0}),an(Ox,{delay:320,offset:!h}))},$z=function(e,r){var h=e.isDisabled,d=e.isFocused,m=e.theme,y=m.colors,c=m.borderRadius,E=m.spacing;return hn({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:E.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},r?{}:{backgroundColor:h?y.neutral5:y.neutral0,borderColor:h?y.neutral10:d?y.primary:y.neutral20,borderRadius:c,borderStyle:"solid",borderWidth:1,boxShadow:d?"0 0 0 1px ".concat(y.primary):void 0,"&:hover":{borderColor:d?y.primary:y.neutral30}})},Zz=function(e){var r=e.children,h=e.isDisabled,d=e.isFocused,m=e.innerRef,y=e.innerProps,c=e.menuIsOpen;return an("div",fn({ref:m},Kr(e,"control",{control:!0,"control--is-disabled":h,"control--is-focused":d,"control--menu-is-open":c}),y,{"aria-disabled":h||void 0}),r)},Yz=Zz,Hz=["data"],qz=function(e,r){var h=e.theme.spacing;return r?{}:{paddingBottom:h.baseUnit*2,paddingTop:h.baseUnit*2}},Xz=function(e){var r=e.children,h=e.cx,d=e.getStyles,m=e.getClassNames,y=e.Heading,c=e.headingProps,E=e.innerProps,C=e.label,k=e.theme,z=e.selectProps;return an("div",fn({},Kr(e,"group",{group:!0}),E),an(y,fn({},c,{selectProps:z,theme:k,getStyles:d,getClassNames:m,cx:h}),C),an("div",null,r))},Wz=function(e,r){var h=e.theme,d=h.colors,m=h.spacing;return hn({label:"group",cursor:"default",display:"block"},r?{}:{color:d.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:m.baseUnit*3,paddingRight:m.baseUnit*3,textTransform:"uppercase"})},Qz=function(e){var r=iM(e);r.data;var h=Pd(r,Hz);return an("div",fn({},Kr(e,"groupHeading",{"group-heading":!0}),h))},Kz=Xz,Jz=["innerRef","isDisabled","isHidden","inputClassName"],eN=function(e,r){var h=e.isDisabled,d=e.value,m=e.theme,y=m.spacing,c=m.colors;return hn(hn({visibility:h?"hidden":"visible",transform:d?"translateZ(0)":""},tN),r?{}:{margin:y.baseUnit/2,paddingBottom:y.baseUnit/2,paddingTop:y.baseUnit/2,color:c.neutral80})},dM={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},tN={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":hn({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},dM)},nN=function(e){return hn({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},dM)},iN=function(e){var r=e.cx,h=e.value,d=iM(e),m=d.innerRef,y=d.isDisabled,c=d.isHidden,E=d.inputClassName,C=Pd(d,Jz);return an("div",fn({},Kr(e,"input",{"input-container":!0}),{"data-value":h||""}),an("input",fn({className:r({input:!0},E),ref:m,style:nN(c),disabled:y},C)))},rN=iN,aN=function(e,r){var h=e.theme,d=h.spacing,m=h.borderRadius,y=h.colors;return hn({label:"multiValue",display:"flex",minWidth:0},r?{}:{backgroundColor:y.neutral10,borderRadius:m/2,margin:d.baseUnit/2})},oN=function(e,r){var h=e.theme,d=h.borderRadius,m=h.colors,y=e.cropWithEllipsis;return hn({overflow:"hidden",textOverflow:y||y===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},r?{}:{borderRadius:d/2,color:m.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},sN=function(e,r){var h=e.theme,d=h.spacing,m=h.borderRadius,y=h.colors,c=e.isFocused;return hn({alignItems:"center",display:"flex"},r?{}:{borderRadius:m/2,backgroundColor:c?y.dangerLight:void 0,paddingLeft:d.baseUnit,paddingRight:d.baseUnit,":hover":{backgroundColor:y.dangerLight,color:y.danger}})},fM=function(e){var r=e.children,h=e.innerProps;return an("div",h,r)},lN=fM,cN=fM;function uN(n){var e=n.children,r=n.innerProps;return an("div",fn({role:"button"},r),e||an(Aw,{size:14}))}var hN=function(e){var r=e.children,h=e.components,d=e.data,m=e.innerProps,y=e.isDisabled,c=e.removeProps,E=e.selectProps,C=h.Container,k=h.Label,z=h.Remove;return an(C,{data:d,innerProps:hn(hn({},Kr(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":y})),m),selectProps:E},an(k,{data:d,innerProps:hn({},Kr(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:E},r),an(z,{data:d,innerProps:hn(hn({},Kr(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(r||"option")},c),selectProps:E}))},dN=hN,fN=function(e,r){var h=e.isDisabled,d=e.isFocused,m=e.isSelected,y=e.theme,c=y.spacing,E=y.colors;return hn({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},r?{}:{backgroundColor:m?E.primary:d?E.primary25:"transparent",color:h?E.neutral20:m?E.neutral0:"inherit",padding:"".concat(c.baseUnit*2,"px ").concat(c.baseUnit*3,"px"),":active":{backgroundColor:h?void 0:m?E.primary:E.primary50}})},pN=function(e){var r=e.children,h=e.isDisabled,d=e.isFocused,m=e.isSelected,y=e.innerRef,c=e.innerProps;return an("div",fn({},Kr(e,"option",{option:!0,"option--is-disabled":h,"option--is-focused":d,"option--is-selected":m}),{ref:y,"aria-disabled":h},c),r)},mN=pN,gN=function(e,r){var h=e.theme,d=h.spacing,m=h.colors;return hn({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},r?{}:{color:m.neutral50,marginLeft:d.baseUnit/2,marginRight:d.baseUnit/2})},yN=function(e){var r=e.children,h=e.innerProps;return an("div",fn({},Kr(e,"placeholder",{placeholder:!0}),h),r)},_N=yN,vN=function(e,r){var h=e.isDisabled,d=e.theme,m=d.spacing,y=d.colors;return hn({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r?{}:{color:h?y.neutral40:y.neutral80,marginLeft:m.baseUnit/2,marginRight:m.baseUnit/2})},bN=function(e){var r=e.children,h=e.isDisabled,d=e.innerProps;return an("div",fn({},Kr(e,"singleValue",{"single-value":!0,"single-value--is-disabled":h}),d),r)},xN=bN,wN={ClearIndicator:jz,Control:Yz,DropdownIndicator:zz,DownChevron:uM,CrossIcon:Aw,Group:Kz,GroupHeading:Qz,IndicatorsContainer:Rz,IndicatorSeparator:Bz,Input:rN,LoadingIndicator:Gz,Menu:yz,MenuList:vz,MenuPortal:Ez,LoadingMessage:Tz,NoOptionsMessage:wz,MultiValue:dN,MultiValueContainer:lN,MultiValueLabel:cN,MultiValueRemove:uN,Option:mN,Placeholder:_N,SelectContainer:Mz,SingleValue:xN,ValueContainer:Dz},TN=function(e){return hn(hn({},wN),e.components)},kT=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function SN(n,e){return!!(n===e||kT(n)&&kT(e))}function EN(n,e){if(n.length!==e.length)return!1;for(var r=0;r<n.length;r++)if(!SN(n[r],e[r]))return!1;return!0}function AN(n,e){e===void 0&&(e=EN);var r=null;function h(){for(var d=[],m=0;m<arguments.length;m++)d[m]=arguments[m];if(r&&r.lastThis===this&&e(d,r.lastArgs))return r.lastResult;var y=n.apply(this,d);return r={lastResult:y,lastArgs:d,lastThis:this},y}return h.clear=function(){r=null},h}var MN={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},CN=function(e){return an("span",fn({css:MN},e))},OT=CN,DN={guidance:function(e){var r=e.isSearchable,h=e.isMulti,d=e.tabSelectsValue,m=e.context,y=e.isInitialFocus;switch(m){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(d?", press Tab to select the option and exit the menu":"",".");case"input":return y?"".concat(e["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(h?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var r=e.action,h=e.label,d=h===void 0?"":h,m=e.labels,y=e.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(d,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(m.length>1?"s":""," ").concat(m.join(","),", selected.");case"select-option":return y?"option ".concat(d," is disabled. Select another option."):"option ".concat(d,", selected.");default:return""}},onFocus:function(e){var r=e.context,h=e.focused,d=e.options,m=e.label,y=m===void 0?"":m,c=e.selectValue,E=e.isDisabled,C=e.isSelected,k=e.isAppleDevice,z=function(ie,ne){return ie&&ie.length?"".concat(ie.indexOf(ne)+1," of ").concat(ie.length):""};if(r==="value"&&c)return"value ".concat(y," focused, ").concat(z(c,h),".");if(r==="menu"&&k){var F=E?" disabled":"",B="".concat(C?" selected":"").concat(F);return"".concat(y).concat(B,", ").concat(z(d,h),".")}return""},onFilter:function(e){var r=e.inputValue,h=e.resultsMessage;return"".concat(h).concat(r?" for search term "+r:"",".")}},IN=function(e){var r=e.ariaSelection,h=e.focusedOption,d=e.focusedValue,m=e.focusableOptions,y=e.isFocused,c=e.selectValue,E=e.selectProps,C=e.id,k=e.isAppleDevice,z=E.ariaLiveMessages,F=E.getOptionLabel,B=E.inputValue,Q=E.isMulti,ie=E.isOptionDisabled,ne=E.isSearchable,ue=E.menuIsOpen,Ae=E.options,Te=E.screenReaderStatus,ke=E.tabSelectsValue,be=E.isLoading,Me=E["aria-label"],Fe=E["aria-live"],ot=K.useMemo(function(){return hn(hn({},DN),z||{})},[z]),Ee=K.useMemo(function(){var Gt="";if(r&&ot.onChange){var Ue=r.option,st=r.options,xt=r.removedValue,ut=r.removedValues,Ut=r.value,De=function(cn){return Array.isArray(cn)?null:cn},Qe=xt||Ue||De(Ut),dt=Qe?F(Qe):"",_t=st||ut||void 0,Ot=_t?_t.map(F):[],jt=hn({isDisabled:Qe&&ie(Qe,c),label:dt,labels:Ot},r);Gt=ot.onChange(jt)}return Gt},[r,ot,ie,c,F]),Je=K.useMemo(function(){var Gt="",Ue=h||d,st=!!(h&&c&&c.includes(h));if(Ue&&ot.onFocus){var xt={focused:Ue,label:F(Ue),isDisabled:ie(Ue,c),isSelected:st,options:m,context:Ue===h?"menu":"value",selectValue:c,isAppleDevice:k};Gt=ot.onFocus(xt)}return Gt},[h,d,F,ie,ot,m,c,k]),Et=K.useMemo(function(){var Gt="";if(ue&&Ae.length&&!be&&ot.onFilter){var Ue=Te({count:m.length});Gt=ot.onFilter({inputValue:B,resultsMessage:Ue})}return Gt},[m,B,ue,ot,Ae,Te,be]),Tt=r?.action==="initial-input-focus",zt=K.useMemo(function(){var Gt="";if(ot.guidance){var Ue=d?"value":ue?"menu":"input";Gt=ot.guidance({"aria-label":Me,context:Ue,isDisabled:h&&ie(h,c),isMulti:Q,isSearchable:ne,tabSelectsValue:ke,isInitialFocus:Tt})}return Gt},[Me,h,d,Q,ie,ne,ue,ot,c,ke,Tt]),Zt=an(K.Fragment,null,an("span",{id:"aria-selection"},Ee),an("span",{id:"aria-focused"},Je),an("span",{id:"aria-results"},Et),an("span",{id:"aria-guidance"},zt));return an(K.Fragment,null,an(OT,{id:C},Tt&&Zt),an(OT,{"aria-live":Fe,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},y&&!Tt&&Zt))},RN=IN,m1=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],kN=new RegExp("["+m1.map(function(n){return n.letters}).join("")+"]","g"),pM={};for(var Px=0;Px<m1.length;Px++)for(var Lx=m1[Px],zx=0;zx<Lx.letters.length;zx++)pM[Lx.letters[zx]]=Lx.base;var mM=function(e){return e.replace(kN,function(r){return pM[r]})},ON=AN(mM),PT=function(e){return e.replace(/^\s+|\s+$/g,"")},PN=function(e){return"".concat(e.label," ").concat(e.value)},LN=function(e){return function(r,h){if(r.data.__isNew__)return!0;var d=hn({ignoreCase:!0,ignoreAccents:!0,stringify:PN,trim:!0,matchFrom:"any"},e),m=d.ignoreCase,y=d.ignoreAccents,c=d.stringify,E=d.trim,C=d.matchFrom,k=E?PT(h):h,z=E?PT(c(r)):c(r);return m&&(k=k.toLowerCase(),z=z.toLowerCase()),y&&(k=ON(k),z=mM(z)),C==="start"?z.substr(0,k.length)===k:z.indexOf(k)>-1}},zN=["innerRef"];function NN(n){var e=n.innerRef,r=Pd(n,zN),h=cz(r,"onExited","in","enter","exit","appear");return an("input",fn({ref:e},h,{css:ww({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var jN=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function FN(n){var e=n.isEnabled,r=n.onBottomArrive,h=n.onBottomLeave,d=n.onTopArrive,m=n.onTopLeave,y=K.useRef(!1),c=K.useRef(!1),E=K.useRef(0),C=K.useRef(null),k=K.useCallback(function(ne,ue){if(C.current!==null){var Ae=C.current,Te=Ae.scrollTop,ke=Ae.scrollHeight,be=Ae.clientHeight,Me=C.current,Fe=ue>0,ot=ke-be-Te,Ee=!1;ot>ue&&y.current&&(h&&h(ne),y.current=!1),Fe&&c.current&&(m&&m(ne),c.current=!1),Fe&&ue>ot?(r&&!y.current&&r(ne),Me.scrollTop=ke,Ee=!0,y.current=!0):!Fe&&-ue>Te&&(d&&!c.current&&d(ne),Me.scrollTop=0,Ee=!0,c.current=!0),Ee&&jN(ne)}},[r,h,d,m]),z=K.useCallback(function(ne){k(ne,ne.deltaY)},[k]),F=K.useCallback(function(ne){E.current=ne.changedTouches[0].clientY},[]),B=K.useCallback(function(ne){var ue=E.current-ne.changedTouches[0].clientY;k(ne,ue)},[k]),Q=K.useCallback(function(ne){if(ne){var ue=oz?{passive:!1}:!1;ne.addEventListener("wheel",z,ue),ne.addEventListener("touchstart",F,ue),ne.addEventListener("touchmove",B,ue)}},[B,F,z]),ie=K.useCallback(function(ne){ne&&(ne.removeEventListener("wheel",z,!1),ne.removeEventListener("touchstart",F,!1),ne.removeEventListener("touchmove",B,!1))},[B,F,z]);return K.useEffect(function(){if(e){var ne=C.current;return Q(ne),function(){ie(ne)}}},[e,Q,ie]),function(ne){C.current=ne}}var LT=["boxSizing","height","overflow","paddingRight","position"],zT={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function NT(n){n.cancelable&&n.preventDefault()}function jT(n){n.stopPropagation()}function FT(){var n=this.scrollTop,e=this.scrollHeight,r=n+this.offsetHeight;n===0?this.scrollTop=1:r===e&&(this.scrollTop=n-1)}function BT(){return"ontouchstart"in window||navigator.maxTouchPoints}var UT=!!(typeof window<"u"&&window.document&&window.document.createElement),m_=0,bg={capture:!1,passive:!1};function BN(n){var e=n.isEnabled,r=n.accountForScrollbars,h=r===void 0?!0:r,d=K.useRef({}),m=K.useRef(null),y=K.useCallback(function(E){if(UT){var C=document.body,k=C&&C.style;if(h&&LT.forEach(function(Q){var ie=k&&k[Q];d.current[Q]=ie}),h&&m_<1){var z=parseInt(d.current.paddingRight,10)||0,F=document.body?document.body.clientWidth:0,B=window.innerWidth-F+z||0;Object.keys(zT).forEach(function(Q){var ie=zT[Q];k&&(k[Q]=ie)}),k&&(k.paddingRight="".concat(B,"px"))}C&&BT()&&(C.addEventListener("touchmove",NT,bg),E&&(E.addEventListener("touchstart",FT,bg),E.addEventListener("touchmove",jT,bg))),m_+=1}},[h]),c=K.useCallback(function(E){if(UT){var C=document.body,k=C&&C.style;m_=Math.max(m_-1,0),h&&m_<1&&LT.forEach(function(z){var F=d.current[z];k&&(k[z]=F)}),C&&BT()&&(C.removeEventListener("touchmove",NT,bg),E&&(E.removeEventListener("touchstart",FT,bg),E.removeEventListener("touchmove",jT,bg)))}},[h]);return K.useEffect(function(){if(e){var E=m.current;return y(E),function(){c(E)}}},[e,y,c]),function(E){m.current=E}}var UN=function(e){var r=e.target;return r.ownerDocument.activeElement&&r.ownerDocument.activeElement.blur()},VN={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function GN(n){var e=n.children,r=n.lockEnabled,h=n.captureEnabled,d=h===void 0?!0:h,m=n.onBottomArrive,y=n.onBottomLeave,c=n.onTopArrive,E=n.onTopLeave,C=FN({isEnabled:d,onBottomArrive:m,onBottomLeave:y,onTopArrive:c,onTopLeave:E}),k=BN({isEnabled:r}),z=function(B){C(B),k(B)};return an(K.Fragment,null,r&&an("div",{onClick:UN,css:VN}),e(z))}var $N={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},ZN=function(e){var r=e.name,h=e.onFocus;return an("input",{required:!0,name:r,tabIndex:-1,"aria-hidden":"true",onFocus:h,css:$N,value:"",onChange:function(){}})},YN=ZN;function Mw(n){var e;return typeof window<"u"&&window.navigator!=null?n.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function HN(){return Mw(/^iPhone/i)}function gM(){return Mw(/^Mac/i)}function qN(){return Mw(/^iPad/i)||gM()&&navigator.maxTouchPoints>1}function XN(){return HN()||qN()}function WN(){return gM()||XN()}var QN=function(e){return e.label},KN=function(e){return e.label},JN=function(e){return e.value},e5=function(e){return!!e.isDisabled},t5={clearIndicator:Nz,container:Az,control:$z,dropdownIndicator:Lz,group:qz,groupHeading:Wz,indicatorsContainer:Iz,indicatorSeparator:Fz,input:eN,loadingIndicator:Vz,loadingMessage:xz,menu:pz,menuList:_z,menuPortal:Sz,multiValue:aN,multiValueLabel:oN,multiValueRemove:sN,noOptionsMessage:bz,option:fN,placeholder:gN,singleValue:vN,valueContainer:Cz},n5={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},i5=4,yM=4,r5=38,a5=yM*2,o5={baseUnit:yM,controlHeight:r5,menuGutter:a5},Nx={borderRadius:i5,colors:n5,spacing:o5},s5={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:IT(),captureMenuScroll:!IT(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:LN(),formatGroupLabel:QN,getOptionLabel:KN,getOptionValue:JN,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:e5,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!rz(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var r=e.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function VT(n,e,r,h){var d=bM(n,e,r),m=xM(n,e,r),y=vM(n,e),c=Jv(n,e);return{type:"option",data:e,isDisabled:d,isSelected:m,label:y,value:c,index:h}}function Nv(n,e){return n.options.map(function(r,h){if("options"in r){var d=r.options.map(function(y,c){return VT(n,y,e,c)}).filter(function(y){return $T(n,y)});return d.length>0?{type:"group",data:r,options:d,index:h}:void 0}var m=VT(n,r,e,h);return $T(n,m)?m:void 0}).filter(sz)}function _M(n){return n.reduce(function(e,r){return r.type==="group"?e.push.apply(e,yw(r.options.map(function(h){return h.data}))):e.push(r.data),e},[])}function GT(n,e){return n.reduce(function(r,h){return h.type==="group"?r.push.apply(r,yw(h.options.map(function(d){return{data:d.data,id:"".concat(e,"-").concat(h.index,"-").concat(d.index)}}))):r.push({data:h.data,id:"".concat(e,"-").concat(h.index)}),r},[])}function l5(n,e){return _M(Nv(n,e))}function $T(n,e){var r=n.inputValue,h=r===void 0?"":r,d=e.data,m=e.isSelected,y=e.label,c=e.value;return(!TM(n)||!m)&&wM(n,{label:y,value:c,data:d},h)}function c5(n,e){var r=n.focusedValue,h=n.selectValue,d=h.indexOf(r);if(d>-1){var m=e.indexOf(r);if(m>-1)return r;if(d<e.length)return e[d]}return null}function u5(n,e){var r=n.focusedOption;return r&&e.indexOf(r)>-1?r:e[0]}var jx=function(e,r){var h,d=(h=e.find(function(m){return m.data===r}))===null||h===void 0?void 0:h.id;return d||null},vM=function(e,r){return e.getOptionLabel(r)},Jv=function(e,r){return e.getOptionValue(r)};function bM(n,e,r){return typeof n.isOptionDisabled=="function"?n.isOptionDisabled(e,r):!1}function xM(n,e,r){if(r.indexOf(e)>-1)return!0;if(typeof n.isOptionSelected=="function")return n.isOptionSelected(e,r);var h=Jv(n,e);return r.some(function(d){return Jv(n,d)===h})}function wM(n,e,r){return n.filterOption?n.filterOption(e,r):!0}var TM=function(e){var r=e.hideSelectedOptions,h=e.isMulti;return r===void 0?h:r},h5=1,SM=function(n){OP(r,n);var e=zP(r);function r(h){var d;if(RP(this,r),d=e.call(this,h),d.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},d.blockOptionHover=!1,d.isComposing=!1,d.commonProps=void 0,d.initialTouchX=0,d.initialTouchY=0,d.openAfterFocus=!1,d.scrollToFocusedOptionOnUpdate=!1,d.userIsDragging=void 0,d.controlRef=null,d.getControlRef=function(E){d.controlRef=E},d.focusedOptionRef=null,d.getFocusedOptionRef=function(E){d.focusedOptionRef=E},d.menuListRef=null,d.getMenuListRef=function(E){d.menuListRef=E},d.inputRef=null,d.getInputRef=function(E){d.inputRef=E},d.focus=d.focusInput,d.blur=d.blurInput,d.onChange=function(E,C){var k=d.props,z=k.onChange,F=k.name;C.name=F,d.ariaOnChange(E,C),z(E,C)},d.setValue=function(E,C,k){var z=d.props,F=z.closeMenuOnSelect,B=z.isMulti,Q=z.inputValue;d.onInputChange("",{action:"set-value",prevInputValue:Q}),F&&(d.setState({inputIsHiddenAfterUpdate:!B}),d.onMenuClose()),d.setState({clearFocusValueOnUpdate:!0}),d.onChange(E,{action:C,option:k})},d.selectOption=function(E){var C=d.props,k=C.blurInputOnSelect,z=C.isMulti,F=C.name,B=d.state.selectValue,Q=z&&d.isOptionSelected(E,B),ie=d.isOptionDisabled(E,B);if(Q){var ne=d.getOptionValue(E);d.setValue(B.filter(function(ue){return d.getOptionValue(ue)!==ne}),"deselect-option",E)}else if(!ie)z?d.setValue([].concat(yw(B),[E]),"select-option",E):d.setValue(E,"select-option");else{d.ariaOnChange(E,{action:"select-option",option:E,name:F});return}k&&d.blurInput()},d.removeValue=function(E){var C=d.props.isMulti,k=d.state.selectValue,z=d.getOptionValue(E),F=k.filter(function(Q){return d.getOptionValue(Q)!==z}),B=Mv(C,F,F[0]||null);d.onChange(B,{action:"remove-value",removedValue:E}),d.focusInput()},d.clearValue=function(){var E=d.state.selectValue;d.onChange(Mv(d.props.isMulti,[],null),{action:"clear",removedValues:E})},d.popValue=function(){var E=d.props.isMulti,C=d.state.selectValue,k=C[C.length-1],z=C.slice(0,C.length-1),F=Mv(E,z,z[0]||null);k&&d.onChange(F,{action:"pop-value",removedValue:k})},d.getFocusedOptionId=function(E){return jx(d.state.focusableOptionsWithIds,E)},d.getFocusableOptionsWithIds=function(){return GT(Nv(d.props,d.state.selectValue),d.getElementId("option"))},d.getValue=function(){return d.state.selectValue},d.cx=function(){for(var E=arguments.length,C=new Array(E),k=0;k<E;k++)C[k]=arguments[k];return JL.apply(void 0,[d.props.classNamePrefix].concat(C))},d.getOptionLabel=function(E){return vM(d.props,E)},d.getOptionValue=function(E){return Jv(d.props,E)},d.getStyles=function(E,C){var k=d.props.unstyled,z=t5[E](C,k);z.boxSizing="border-box";var F=d.props.styles[E];return F?F(z,C):z},d.getClassNames=function(E,C){var k,z;return(k=(z=d.props.classNames)[E])===null||k===void 0?void 0:k.call(z,C)},d.getElementId=function(E){return"".concat(d.state.instancePrefix,"-").concat(E)},d.getComponents=function(){return TN(d.props)},d.buildCategorizedOptions=function(){return Nv(d.props,d.state.selectValue)},d.getCategorizedOptions=function(){return d.props.menuIsOpen?d.buildCategorizedOptions():[]},d.buildFocusableOptions=function(){return _M(d.buildCategorizedOptions())},d.getFocusableOptions=function(){return d.props.menuIsOpen?d.buildFocusableOptions():[]},d.ariaOnChange=function(E,C){d.setState({ariaSelection:hn({value:E},C)})},d.onMenuMouseDown=function(E){E.button===0&&(E.stopPropagation(),E.preventDefault(),d.focusInput())},d.onMenuMouseMove=function(E){d.blockOptionHover=!1},d.onControlMouseDown=function(E){if(!E.defaultPrevented){var C=d.props.openMenuOnClick;d.state.isFocused?d.props.menuIsOpen?E.target.tagName!=="INPUT"&&E.target.tagName!=="TEXTAREA"&&d.onMenuClose():C&&d.openMenu("first"):(C&&(d.openAfterFocus=!0),d.focusInput()),E.target.tagName!=="INPUT"&&E.target.tagName!=="TEXTAREA"&&E.preventDefault()}},d.onDropdownIndicatorMouseDown=function(E){if(!(E&&E.type==="mousedown"&&E.button!==0)&&!d.props.isDisabled){var C=d.props,k=C.isMulti,z=C.menuIsOpen;d.focusInput(),z?(d.setState({inputIsHiddenAfterUpdate:!k}),d.onMenuClose()):d.openMenu("first"),E.preventDefault()}},d.onClearIndicatorMouseDown=function(E){E&&E.type==="mousedown"&&E.button!==0||(d.clearValue(),E.preventDefault(),d.openAfterFocus=!1,E.type==="touchend"?d.focusInput():setTimeout(function(){return d.focusInput()}))},d.onScroll=function(E){typeof d.props.closeMenuOnScroll=="boolean"?E.target instanceof HTMLElement&&Ib(E.target)&&d.props.onMenuClose():typeof d.props.closeMenuOnScroll=="function"&&d.props.closeMenuOnScroll(E)&&d.props.onMenuClose()},d.onCompositionStart=function(){d.isComposing=!0},d.onCompositionEnd=function(){d.isComposing=!1},d.onTouchStart=function(E){var C=E.touches,k=C&&C.item(0);k&&(d.initialTouchX=k.clientX,d.initialTouchY=k.clientY,d.userIsDragging=!1)},d.onTouchMove=function(E){var C=E.touches,k=C&&C.item(0);if(k){var z=Math.abs(k.clientX-d.initialTouchX),F=Math.abs(k.clientY-d.initialTouchY),B=5;d.userIsDragging=z>B||F>B}},d.onTouchEnd=function(E){d.userIsDragging||(d.controlRef&&!d.controlRef.contains(E.target)&&d.menuListRef&&!d.menuListRef.contains(E.target)&&d.blurInput(),d.initialTouchX=0,d.initialTouchY=0)},d.onControlTouchEnd=function(E){d.userIsDragging||d.onControlMouseDown(E)},d.onClearIndicatorTouchEnd=function(E){d.userIsDragging||d.onClearIndicatorMouseDown(E)},d.onDropdownIndicatorTouchEnd=function(E){d.userIsDragging||d.onDropdownIndicatorMouseDown(E)},d.handleInputChange=function(E){var C=d.props.inputValue,k=E.currentTarget.value;d.setState({inputIsHiddenAfterUpdate:!1}),d.onInputChange(k,{action:"input-change",prevInputValue:C}),d.props.menuIsOpen||d.onMenuOpen()},d.onInputFocus=function(E){d.props.onFocus&&d.props.onFocus(E),d.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(d.openAfterFocus||d.props.openMenuOnFocus)&&d.openMenu("first"),d.openAfterFocus=!1},d.onInputBlur=function(E){var C=d.props.inputValue;if(d.menuListRef&&d.menuListRef.contains(document.activeElement)){d.inputRef.focus();return}d.props.onBlur&&d.props.onBlur(E),d.onInputChange("",{action:"input-blur",prevInputValue:C}),d.onMenuClose(),d.setState({focusedValue:null,isFocused:!1})},d.onOptionHover=function(E){if(!(d.blockOptionHover||d.state.focusedOption===E)){var C=d.getFocusableOptions(),k=C.indexOf(E);d.setState({focusedOption:E,focusedOptionId:k>-1?d.getFocusedOptionId(E):null})}},d.shouldHideSelectedOptions=function(){return TM(d.props)},d.onValueInputFocus=function(E){E.preventDefault(),E.stopPropagation(),d.focus()},d.onKeyDown=function(E){var C=d.props,k=C.isMulti,z=C.backspaceRemovesValue,F=C.escapeClearsValue,B=C.inputValue,Q=C.isClearable,ie=C.isDisabled,ne=C.menuIsOpen,ue=C.onKeyDown,Ae=C.tabSelectsValue,Te=C.openMenuOnFocus,ke=d.state,be=ke.focusedOption,Me=ke.focusedValue,Fe=ke.selectValue;if(!ie&&!(typeof ue=="function"&&(ue(E),E.defaultPrevented))){switch(d.blockOptionHover=!0,E.key){case"ArrowLeft":if(!k||B)return;d.focusValue("previous");break;case"ArrowRight":if(!k||B)return;d.focusValue("next");break;case"Delete":case"Backspace":if(B)return;if(Me)d.removeValue(Me);else{if(!z)return;k?d.popValue():Q&&d.clearValue()}break;case"Tab":if(d.isComposing||E.shiftKey||!ne||!Ae||!be||Te&&d.isOptionSelected(be,Fe))return;d.selectOption(be);break;case"Enter":if(E.keyCode===229)break;if(ne){if(!be||d.isComposing)return;d.selectOption(be);break}return;case"Escape":ne?(d.setState({inputIsHiddenAfterUpdate:!1}),d.onInputChange("",{action:"menu-close",prevInputValue:B}),d.onMenuClose()):Q&&F&&d.clearValue();break;case" ":if(B)return;if(!ne){d.openMenu("first");break}if(!be)return;d.selectOption(be);break;case"ArrowUp":ne?d.focusOption("up"):d.openMenu("last");break;case"ArrowDown":ne?d.focusOption("down"):d.openMenu("first");break;case"PageUp":if(!ne)return;d.focusOption("pageup");break;case"PageDown":if(!ne)return;d.focusOption("pagedown");break;case"Home":if(!ne)return;d.focusOption("first");break;case"End":if(!ne)return;d.focusOption("last");break;default:return}E.preventDefault()}},d.state.instancePrefix="react-select-"+(d.props.instanceId||++h5),d.state.selectValue=CT(h.value),h.menuIsOpen&&d.state.selectValue.length){var m=d.getFocusableOptionsWithIds(),y=d.buildFocusableOptions(),c=y.indexOf(d.state.selectValue[0]);d.state.focusableOptionsWithIds=m,d.state.focusedOption=y[c],d.state.focusedOptionId=jx(m,y[c])}return d}return kP(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&DT(this.menuListRef,this.focusedOptionRef),WN()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(d){var m=this.props,y=m.isDisabled,c=m.menuIsOpen,E=this.state.isFocused;(E&&!y&&d.isDisabled||E&&c&&!d.menuIsOpen)&&this.focusInput(),E&&y&&!d.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!E&&!y&&d.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(DT(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(d,m){this.props.onInputChange(d,m)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(d){var m=this,y=this.state,c=y.selectValue,E=y.isFocused,C=this.buildFocusableOptions(),k=d==="first"?0:C.length-1;if(!this.props.isMulti){var z=C.indexOf(c[0]);z>-1&&(k=z)}this.scrollToFocusedOptionOnUpdate=!(E&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:C[k],focusedOptionId:this.getFocusedOptionId(C[k])},function(){return m.onMenuOpen()})}},{key:"focusValue",value:function(d){var m=this.state,y=m.selectValue,c=m.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var E=y.indexOf(c);c||(E=-1);var C=y.length-1,k=-1;if(y.length){switch(d){case"previous":E===0?k=0:E===-1?k=C:k=E-1;break;case"next":E>-1&&E<C&&(k=E+1);break}this.setState({inputIsHidden:k!==-1,focusedValue:y[k]})}}}},{key:"focusOption",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",m=this.props.pageSize,y=this.state.focusedOption,c=this.getFocusableOptions();if(c.length){var E=0,C=c.indexOf(y);y||(C=-1),d==="up"?E=C>0?C-1:c.length-1:d==="down"?E=(C+1)%c.length:d==="pageup"?(E=C-m,E<0&&(E=0)):d==="pagedown"?(E=C+m,E>c.length-1&&(E=c.length-1)):d==="last"&&(E=c.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:c[E],focusedValue:null,focusedOptionId:this.getFocusedOptionId(c[E])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Nx):hn(hn({},Nx),this.props.theme):Nx}},{key:"getCommonProps",value:function(){var d=this.clearValue,m=this.cx,y=this.getStyles,c=this.getClassNames,E=this.getValue,C=this.selectOption,k=this.setValue,z=this.props,F=z.isMulti,B=z.isRtl,Q=z.options,ie=this.hasValue();return{clearValue:d,cx:m,getStyles:y,getClassNames:c,getValue:E,hasValue:ie,isMulti:F,isRtl:B,options:Q,selectOption:C,selectProps:z,setValue:k,theme:this.getTheme()}}},{key:"hasValue",value:function(){var d=this.state.selectValue;return d.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var d=this.props,m=d.isClearable,y=d.isMulti;return m===void 0?y:m}},{key:"isOptionDisabled",value:function(d,m){return bM(this.props,d,m)}},{key:"isOptionSelected",value:function(d,m){return xM(this.props,d,m)}},{key:"filterOption",value:function(d,m){return wM(this.props,d,m)}},{key:"formatOptionLabel",value:function(d,m){if(typeof this.props.formatOptionLabel=="function"){var y=this.props.inputValue,c=this.state.selectValue;return this.props.formatOptionLabel(d,{context:m,inputValue:y,selectValue:c})}else return this.getOptionLabel(d)}},{key:"formatGroupLabel",value:function(d){return this.props.formatGroupLabel(d)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var d=this.props,m=d.isDisabled,y=d.isSearchable,c=d.inputId,E=d.inputValue,C=d.tabIndex,k=d.form,z=d.menuIsOpen,F=d.required,B=this.getComponents(),Q=B.Input,ie=this.state,ne=ie.inputIsHidden,ue=ie.ariaSelection,Ae=this.commonProps,Te=c||this.getElementId("input"),ke=hn(hn(hn({"aria-autocomplete":"list","aria-expanded":z,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":F,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},z&&{"aria-controls":this.getElementId("listbox")}),!y&&{"aria-readonly":!0}),this.hasValue()?ue?.action==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return y?K.createElement(Q,fn({},Ae,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:Te,innerRef:this.getInputRef,isDisabled:m,isHidden:ne,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:C,form:k,type:"text",value:E},ke)):K.createElement(NN,fn({id:Te,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Qv,onFocus:this.onInputFocus,disabled:m,tabIndex:C,inputMode:"none",form:k,value:""},ke))}},{key:"renderPlaceholderOrValue",value:function(){var d=this,m=this.getComponents(),y=m.MultiValue,c=m.MultiValueContainer,E=m.MultiValueLabel,C=m.MultiValueRemove,k=m.SingleValue,z=m.Placeholder,F=this.commonProps,B=this.props,Q=B.controlShouldRenderValue,ie=B.isDisabled,ne=B.isMulti,ue=B.inputValue,Ae=B.placeholder,Te=this.state,ke=Te.selectValue,be=Te.focusedValue,Me=Te.isFocused;if(!this.hasValue()||!Q)return ue?null:K.createElement(z,fn({},F,{key:"placeholder",isDisabled:ie,isFocused:Me,innerProps:{id:this.getElementId("placeholder")}}),Ae);if(ne)return ke.map(function(ot,Ee){var Je=ot===be,Et="".concat(d.getOptionLabel(ot),"-").concat(d.getOptionValue(ot));return K.createElement(y,fn({},F,{components:{Container:c,Label:E,Remove:C},isFocused:Je,isDisabled:ie,key:Et,index:Ee,removeProps:{onClick:function(){return d.removeValue(ot)},onTouchEnd:function(){return d.removeValue(ot)},onMouseDown:function(zt){zt.preventDefault()}},data:ot}),d.formatOptionLabel(ot,"value"))});if(ue)return null;var Fe=ke[0];return K.createElement(k,fn({},F,{data:Fe,isDisabled:ie}),this.formatOptionLabel(Fe,"value"))}},{key:"renderClearIndicator",value:function(){var d=this.getComponents(),m=d.ClearIndicator,y=this.commonProps,c=this.props,E=c.isDisabled,C=c.isLoading,k=this.state.isFocused;if(!this.isClearable()||!m||E||!this.hasValue()||C)return null;var z={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return K.createElement(m,fn({},y,{innerProps:z,isFocused:k}))}},{key:"renderLoadingIndicator",value:function(){var d=this.getComponents(),m=d.LoadingIndicator,y=this.commonProps,c=this.props,E=c.isDisabled,C=c.isLoading,k=this.state.isFocused;if(!m||!C)return null;var z={"aria-hidden":"true"};return K.createElement(m,fn({},y,{innerProps:z,isDisabled:E,isFocused:k}))}},{key:"renderIndicatorSeparator",value:function(){var d=this.getComponents(),m=d.DropdownIndicator,y=d.IndicatorSeparator;if(!m||!y)return null;var c=this.commonProps,E=this.props.isDisabled,C=this.state.isFocused;return K.createElement(y,fn({},c,{isDisabled:E,isFocused:C}))}},{key:"renderDropdownIndicator",value:function(){var d=this.getComponents(),m=d.DropdownIndicator;if(!m)return null;var y=this.commonProps,c=this.props.isDisabled,E=this.state.isFocused,C={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return K.createElement(m,fn({},y,{innerProps:C,isDisabled:c,isFocused:E}))}},{key:"renderMenu",value:function(){var d=this,m=this.getComponents(),y=m.Group,c=m.GroupHeading,E=m.Menu,C=m.MenuList,k=m.MenuPortal,z=m.LoadingMessage,F=m.NoOptionsMessage,B=m.Option,Q=this.commonProps,ie=this.state.focusedOption,ne=this.props,ue=ne.captureMenuScroll,Ae=ne.inputValue,Te=ne.isLoading,ke=ne.loadingMessage,be=ne.minMenuHeight,Me=ne.maxMenuHeight,Fe=ne.menuIsOpen,ot=ne.menuPlacement,Ee=ne.menuPosition,Je=ne.menuPortalTarget,Et=ne.menuShouldBlockScroll,Tt=ne.menuShouldScrollIntoView,zt=ne.noOptionsMessage,Zt=ne.onMenuScrollToTop,Gt=ne.onMenuScrollToBottom;if(!Fe)return null;var Ue=function(dt,_t){var Ot=dt.type,jt=dt.data,Kt=dt.isDisabled,cn=dt.isSelected,mn=dt.label,lr=dt.value,cr=ie===jt,xi=Kt?void 0:function(){return d.onOptionHover(jt)},Wn=Kt?void 0:function(){return d.selectOption(jt)},Ln="".concat(d.getElementId("option"),"-").concat(_t),Sn={id:Ln,onClick:Wn,onMouseMove:xi,onMouseOver:xi,tabIndex:-1,role:"option","aria-selected":d.state.isAppleDevice?void 0:cn};return K.createElement(B,fn({},Q,{innerProps:Sn,data:jt,isDisabled:Kt,isSelected:cn,key:Ln,label:mn,type:Ot,value:lr,isFocused:cr,innerRef:cr?d.getFocusedOptionRef:void 0}),d.formatOptionLabel(dt.data,"menu"))},st;if(this.hasOptions())st=this.getCategorizedOptions().map(function(Qe){if(Qe.type==="group"){var dt=Qe.data,_t=Qe.options,Ot=Qe.index,jt="".concat(d.getElementId("group"),"-").concat(Ot),Kt="".concat(jt,"-heading");return K.createElement(y,fn({},Q,{key:jt,data:dt,options:_t,Heading:c,headingProps:{id:Kt,data:Qe.data},label:d.formatGroupLabel(Qe.data)}),Qe.options.map(function(cn){return Ue(cn,"".concat(Ot,"-").concat(cn.index))}))}else if(Qe.type==="option")return Ue(Qe,"".concat(Qe.index))});else if(Te){var xt=ke({inputValue:Ae});if(xt===null)return null;st=K.createElement(z,Q,xt)}else{var ut=zt({inputValue:Ae});if(ut===null)return null;st=K.createElement(F,Q,ut)}var Ut={minMenuHeight:be,maxMenuHeight:Me,menuPlacement:ot,menuPosition:Ee,menuShouldScrollIntoView:Tt},De=K.createElement(mz,fn({},Q,Ut),function(Qe){var dt=Qe.ref,_t=Qe.placerProps,Ot=_t.placement,jt=_t.maxHeight;return K.createElement(E,fn({},Q,Ut,{innerRef:dt,innerProps:{onMouseDown:d.onMenuMouseDown,onMouseMove:d.onMenuMouseMove},isLoading:Te,placement:Ot}),K.createElement(GN,{captureEnabled:ue,onTopArrive:Zt,onBottomArrive:Gt,lockEnabled:Et},function(Kt){return K.createElement(C,fn({},Q,{innerRef:function(mn){d.getMenuListRef(mn),Kt(mn)},innerProps:{role:"listbox","aria-multiselectable":Q.isMulti,id:d.getElementId("listbox")},isLoading:Te,maxHeight:jt,focusedOption:ie}),st)}))});return Je||Ee==="fixed"?K.createElement(k,fn({},Q,{appendTo:Je,controlElement:this.controlRef,menuPlacement:ot,menuPosition:Ee}),De):De}},{key:"renderFormField",value:function(){var d=this,m=this.props,y=m.delimiter,c=m.isDisabled,E=m.isMulti,C=m.name,k=m.required,z=this.state.selectValue;if(k&&!this.hasValue()&&!c)return K.createElement(YN,{name:C,onFocus:this.onValueInputFocus});if(!(!C||c))if(E)if(y){var F=z.map(function(ie){return d.getOptionValue(ie)}).join(y);return K.createElement("input",{name:C,type:"hidden",value:F})}else{var B=z.length>0?z.map(function(ie,ne){return K.createElement("input",{key:"i-".concat(ne),name:C,type:"hidden",value:d.getOptionValue(ie)})}):K.createElement("input",{name:C,type:"hidden",value:""});return K.createElement("div",null,B)}else{var Q=z[0]?this.getOptionValue(z[0]):"";return K.createElement("input",{name:C,type:"hidden",value:Q})}}},{key:"renderLiveRegion",value:function(){var d=this.commonProps,m=this.state,y=m.ariaSelection,c=m.focusedOption,E=m.focusedValue,C=m.isFocused,k=m.selectValue,z=this.getFocusableOptions();return K.createElement(RN,fn({},d,{id:this.getElementId("live-region"),ariaSelection:y,focusedOption:c,focusedValue:E,isFocused:C,selectValue:k,focusableOptions:z,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var d=this.getComponents(),m=d.Control,y=d.IndicatorsContainer,c=d.SelectContainer,E=d.ValueContainer,C=this.props,k=C.className,z=C.id,F=C.isDisabled,B=C.menuIsOpen,Q=this.state.isFocused,ie=this.commonProps=this.getCommonProps();return K.createElement(c,fn({},ie,{className:k,innerProps:{id:z,onKeyDown:this.onKeyDown},isDisabled:F,isFocused:Q}),this.renderLiveRegion(),K.createElement(m,fn({},ie,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:F,isFocused:Q,menuIsOpen:B}),K.createElement(E,fn({},ie,{isDisabled:F}),this.renderPlaceholderOrValue(),this.renderInput()),K.createElement(y,fn({},ie,{isDisabled:F}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(d,m){var y=m.prevProps,c=m.clearFocusValueOnUpdate,E=m.inputIsHiddenAfterUpdate,C=m.ariaSelection,k=m.isFocused,z=m.prevWasFocused,F=m.instancePrefix,B=d.options,Q=d.value,ie=d.menuIsOpen,ne=d.inputValue,ue=d.isMulti,Ae=CT(Q),Te={};if(y&&(Q!==y.value||B!==y.options||ie!==y.menuIsOpen||ne!==y.inputValue)){var ke=ie?l5(d,Ae):[],be=ie?GT(Nv(d,Ae),"".concat(F,"-option")):[],Me=c?c5(m,Ae):null,Fe=u5(m,ke),ot=jx(be,Fe);Te={selectValue:Ae,focusedOption:Fe,focusedOptionId:ot,focusableOptionsWithIds:be,focusedValue:Me,clearFocusValueOnUpdate:!1}}var Ee=E!=null&&d!==y?{inputIsHidden:E,inputIsHiddenAfterUpdate:void 0}:{},Je=C,Et=k&&z;return k&&!Et&&(Je={value:Mv(ue,Ae,Ae[0]||null),options:Ae,action:"initial-input-focus"},Et=!z),C?.action==="initial-input-focus"&&(Je=null),hn(hn(hn({},Te),Ee),{},{prevProps:d,ariaSelection:Je,prevWasFocused:Et})}}]),r}(K.Component);SM.defaultProps=s5;var d5=K.forwardRef(function(n,e){var r=IP(n);return K.createElement(SM,fn({ref:e},r))}),ZT=d5;function f5({itinerary1Legs:n,itinerary2Legs:e,selectedLeg1Ids:r,selectedLeg2Ids:h,setSelectedLeg1Ids:d,setSelectedLeg2Ids:m,selectedIndexes:y,timeZone:c}){const E=fT(n,1,c),C=fT(e,2,c);return X.jsx("div",{className:"compare-section-divider",children:X.jsxs("div",{className:"compare-legs-select-container",children:[X.jsxs("div",{className:"compare-leg-select-column",children:[X.jsxs("label",{className:"compare-leg-select-label",children:["Itinerary #",y[0]+1," Legs:"]}),X.jsx(ZT,{isMulti:!0,options:E,value:E.filter(k=>r.includes(k.value)),onChange:k=>{const z=k?k.map(F=>F.value):[];d(z)},placeholder:"Select legs to compare...",className:"compare-leg-select",classNamePrefix:"compare-leg-select"})]}),X.jsxs("div",{className:"compare-leg-select-column",children:[X.jsxs("label",{className:"compare-leg-select-label",children:["Itinerary #",y[1]+1," Legs:"]}),X.jsx(ZT,{isMulti:!0,options:C,value:C.filter(k=>h.includes(k.value)),onChange:k=>{const z=k?k.map(F=>F.value):[];m(z)},placeholder:"Select legs to compare...",className:"compare-leg-select",classNamePrefix:"compare-leg-select"})]})]})})}const p5=(n,e)=>{if(!n)return`itinerary_${e}_leg_invalid`;if(n.id)return`itinerary_${e}_leg_${n.id}`;const r=`${n.mode}_${n.aimedStartTime}_${n.aimedEndTime}_${n.fromPlace?.name||"unknown"}_${n.toPlace?.name||"unknown"}`;return`itinerary_${e}_leg_${r}`};function m5({itinerary1:n,itinerary2:e,selectedLegIds:r,selectedIndexes:h,timeZone:d}){return r.length===0?null:X.jsxs("div",{className:"compare-selected-legs-section",children:[X.jsx("h6",{className:"compare-selected-legs-title",children:"Selected Legs Comparison"}),X.jsxs(Eb,{striped:!0,bordered:!0,hover:!0,children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{children:"Itinerary"}),X.jsx("th",{children:"From"}),X.jsx("th",{children:"To"}),X.jsx("th",{children:"Mode"}),X.jsx("th",{children:"Line"}),X.jsx("th",{children:"Start Time"}),X.jsx("th",{children:"End Time"}),X.jsx("th",{children:"Duration"}),X.jsx("th",{children:"Distance"}),X.jsx("th",{children:"Cost"})]})}),X.jsx("tbody",{children:[n,e].map((m,y)=>m.legs.filter(c=>c&&r.includes(c.id||`leg${y+1}_${m.legs.indexOf(c)}`)).map(c=>X.jsxs("tr",{children:[X.jsx("td",{children:X.jsxs("strong",{children:["#",h[y]+1]})}),X.jsx("td",{children:c.fromPlace?.name||"-"}),X.jsx("td",{children:c.toPlace?.name||"-"}),X.jsx("td",{children:c.mode}),X.jsx("td",{children:c.line?.publicCode||c.line?.name||"-"}),X.jsx("td",{children:hu(c.aimedStartTime,d,"short")}),X.jsx("td",{children:hu(c.aimedEndTime,d,"short")}),X.jsx("td",{children:gw(c.duration)}),X.jsx("td",{children:mw(c.distance)}),X.jsxs("td",{children:["¢",c.generalizedCost]})]},p5(c,y))))})]})]})}function g5({show:n,onHide:e,tripQueryResult:r,selectedIndexes:h}){const d=K.useContext(ny),[m,y]=K.useState([]),[c,E]=K.useState([]),C=[...m,...c];if(!r||h.length!==2)return null;const k=r.trip.tripPatterns[h[0]],z=r.trip.tripPatterns[h[1]],F=dT(k,d),B=dT(z,d);return X.jsxs(xv,{show:n,onHide:e,centered:!0,className:"full-width-modal",children:[X.jsx(xv.Header,{closeButton:!0,children:X.jsx(xv.Title,{children:"Compare Itineraries"})}),X.jsxs(xv.Body,{children:[X.jsx(SP,{itinerary1:k,itinerary2:z,summary1:F,summary2:B,selectedIndexes:h}),X.jsx(f5,{itinerary1Legs:k.legs,itinerary2Legs:z.legs,selectedLeg1Ids:m,selectedLeg2Ids:c,setSelectedLeg1Ids:y,setSelectedLeg2Ids:E,selectedIndexes:h,timeZone:d}),X.jsx(m5,{itinerary1:k,itinerary2:z,selectedLegIds:C,selectedIndexes:h,timeZone:d})]})]})}const y5=Kg(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        generalizedCost
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            generalizedCost
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            fromEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),_5=ps(y5);function v5(n){const e={};return F1(n,{OperationDefinition(r){r.operation==="query"&&r.variableDefinitions&&r.variableDefinitions.forEach(h=>{const d=h.variable.name.value;e[d]=ps(h.type)})}}),e}function EM(n){const e=QS(_5),r=v5(e),h=Object.keys(n).filter(m=>n[m]!==void 0),d=F1(e,{OperationDefinition(m){if(m.operation==="query"){const y=m.variableDefinitions?.filter(c=>{const E=c.variable.name.value;return h.includes(E)&&r[E]});return{...m,variableDefinitions:y||[]}}return m},Field(m){if(m.name.value==="trip"&&m.arguments){const y=m.arguments.filter(c=>{if(c.value.kind==="Variable"){const E=c.value.name.value;return h.includes(E)&&r[E]}return!0});return{...m,arguments:y}}return m}});return ps(d)}function AM(n){const e={};return Object.keys(n).forEach(r=>{const h=n[r];h!==void 0&&(e[r]=h)}),e}const b5=n=>{const[e,r]=K.useState(null),[h,d]=K.useState(!1),[m,y]=K.useState(null),c=K.useCallback(async E=>{if(h)console.warn("Wait for previous search to finish");else if(n){d(!0),y(null);try{const C=E?{...n,pageCursor:E}:n,k=AM(C),z=EM(C);r(await G1(vb(),z,k))}catch(C){console.error("Error at useTripQuery",C),y(C),r(null)}d(!1)}else console.warn("Can't search without variables")},[r,n,h]);return K.useEffect(()=>{YT(n?.from)&&YT(n?.to)&&c()},[n?.from,n?.to]),[e,h,c,m]};function YT(n){return n&&(n.coordinates||n.place)}const x5=Kg(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),w5=()=>{const[n,e]=K.useState(null);return K.useEffect(()=>{(async()=>{e(await G1(vb(),x5))})()},[]),n?.serverInfo},T5={from:{},to:{},dateTime:new Date().toISOString()},S5=()=>{const e=new URLSearchParams(window.location.search).get("variables");return e?JSON.parse(decodeURIComponent(e)):T5},E5=n=>{const e=new URLSearchParams(window.location.search);e.set("variables",encodeURIComponent(JSON.stringify(n))),history.pushState({},"","?"+e.toString()+window.location.hash)},A5=()=>{const[n,e]=K.useState(S5());return K.useEffect(()=>{E5(n)},[n]),{tripQueryVariables:n,setTripQueryVariables:e}};function M5({target:n,serverInfo:e}){return X.jsx(LA,{target:n.current,show:!!e,placement:"right",children:X.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:X.jsx("pre",{children:JSON.stringify(e,null,2)})})})}const C5="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function D5({serverInfo:n}){const[e,r]=K.useState(!1),h=K.useRef(null);return X.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[X.jsx(fO.Brand,{onClick:()=>r(d=>!d),children:X.jsxs("div",{ref:h,children:[X.jsx("img",{alt:"",src:C5,width:"50",height:"50",className:"logo-image"}),"OTP Debug",e&&X.jsx(M5,{serverInfo:n,target:h})]})}),X.jsxs("div",{className:"details",children:[X.jsxs("div",{children:["Version: ",n?.version]}),X.jsxs("div",{children:["Time zone: ",n?.internalTransitModelTimeZone]})]})]})}const HT=7,qT="-{0,1}\\d+(\\.\\d+){0,1}",I5="("+qT+")(\\s+)("+qT+")";function R5(n){const e=n.match(I5);return e?{coordinates:{latitude:+e[1],longitude:+e[4]}}:{place:n}}function k5(n){return n.coordinates?`${n.coordinates?.latitude.toPrecision(HT)} ${n.coordinates?.longitude.toPrecision(HT)}`:n.place?n.place:null}function XT({id:n,label:e,tripQueryVariables:r,setTripQueryVariables:h,locationFieldKey:d}){const m=r[d],y=k5(m)||"",[c,E]=K.useState(y),[C,k]=K.useState(m);C!==m&&(k(m),E(y));const z=K.useCallback(F=>{const B=R5(F)||{};h({...r,[d]:B})},[r,h,d]);return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:n,children:e}),X.jsx(Bi.Control,{type:"text",id:n,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:F=>{E(F.target.value)},onBlur:F=>{z(F.target.value)},value:c})]})}const O5="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function P5({tripQueryVariables:n,setTripQueryVariables:e}){const r=()=>{e({...n,from:n.to,to:n.from})};return X.jsx("button",{className:"swap-from-to",onClick:r,title:"Swap from/to",children:X.jsx("img",{alt:"Swap from/to",src:O5})})}function L5({tripQueryVariables:n,setTripQueryVariables:e}){const r=h=>{if(h===void 0){const d={...n};delete d.arriveBy,e(d)}else e({...n,arriveBy:h})};return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Depart/Arrive"}),X.jsxs(Bi.Select,{size:"sm",className:"input-medium",onChange:h=>h.target.value==="arrival"?r(!0):r(void 0),value:n.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[X.jsx("option",{value:"arrival",children:"Arrive by"}),X.jsx("option",{value:"departure",children:"Depart after"})]})]})}class J extends Array{constructor(e,r){if(super(e),this.sign=r,Object.setPrototypeOf(this,J.prototype),e>J.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(e){var r=Math.floor,h=Number.isFinite;if(typeof e=="number"){if(e===0)return J.__zero();if(J.__isOneDigitInt(e))return 0>e?J.__oneDigit(-e,!0):J.__oneDigit(e,!1);if(!h(e)||r(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return J.__fromDouble(e)}if(typeof e=="string"){const d=J.__fromString(e);if(d===null)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return d}if(typeof e=="boolean")return e===!0?J.__oneDigit(1,!1):J.__zero();if(typeof e=="object"){if(e.constructor===J)return e;const d=J.__toPrimitive(e);return J.BigInt(d)}throw new TypeError("Cannot convert "+e+" to a BigInt")}toDebugString(){const e=["BigInt["];for(const r of this)e.push((r&&(r>>>0).toString(16))+", ");return e.push("]"),e.join("")}toString(e=10){if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(e&e-1)==0?J.__toStringBasePowerOfTwo(this,e):J.__toStringGeneric(this,e,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(e){const r=e.length;if(r===0)return 0;if(r===1){const ne=e.__unsignedDigit(0);return e.sign?-ne:ne}const h=e.__digit(r-1),d=J.__clz30(h),m=30*r-d;if(1024<m)return e.sign?-1/0:1/0;let y=m-1,c=h,E=r-1;const C=d+3;let k=C===32?0:c<<C;k>>>=12;const z=C-12;let F=12<=C?0:c<<20+C,B=20+C;for(0<z&&0<E&&(E--,c=e.__digit(E),k|=c>>>30-z,F=c<<z+2,B=z+2);0<B&&0<E;)E--,c=e.__digit(E),F|=30<=B?c<<B-30:c>>>30-B,B-=30;const Q=J.__decideRounding(e,B,E,c);if((Q===1||Q===0&&(1&F)==1)&&(F=F+1>>>0,F===0&&(k++,k>>>20!=0&&(k=0,y++,1023<y))))return e.sign?-1/0:1/0;const ie=e.sign?-2147483648:0;return y=y+1023<<20,J.__kBitConversionInts[1]=ie|y|k,J.__kBitConversionInts[0]=F,J.__kBitConversionDouble[0]}static unaryMinus(e){if(e.length===0)return e;const r=e.__copy();return r.sign=!e.sign,r}static bitwiseNot(e){return e.sign?J.__absoluteSubOne(e).__trim():J.__absoluteAddOne(e,!0)}static exponentiate(e,r){if(r.sign)throw new RangeError("Exponent must be positive");if(r.length===0)return J.__oneDigit(1,!1);if(e.length===0)return e;if(e.length===1&&e.__digit(0)===1)return e.sign&&(1&r.__digit(0))==0?J.unaryMinus(e):e;if(1<r.length)throw new RangeError("BigInt too big");let h=r.__unsignedDigit(0);if(h===1)return e;if(h>=J.__kMaxLengthBits)throw new RangeError("BigInt too big");if(e.length===1&&e.__digit(0)===2){const y=1+(0|h/30),c=e.sign&&(1&h)!=0,E=new J(y,c);E.__initializeDigits();const C=1<<h%30;return E.__setDigit(y-1,C),E}let d=null,m=e;for((1&h)!=0&&(d=e),h>>=1;h!==0;h>>=1)m=J.multiply(m,m),(1&h)!=0&&(d===null?d=m:d=J.multiply(d,m));return d}static multiply(e,r){if(e.length===0)return e;if(r.length===0)return r;let h=e.length+r.length;30<=e.__clzmsd()+r.__clzmsd()&&h--;const d=new J(h,e.sign!==r.sign);d.__initializeDigits();for(let m=0;m<e.length;m++)J.__multiplyAccumulate(r,e.__digit(m),d,m);return d.__trim()}static divide(e,r){if(r.length===0)throw new RangeError("Division by zero");if(0>J.__absoluteCompare(e,r))return J.__zero();const h=e.sign!==r.sign,d=r.__unsignedDigit(0);let m;if(r.length===1&&32767>=d){if(d===1)return h===e.sign?e:J.unaryMinus(e);m=J.__absoluteDivSmall(e,d,null)}else m=J.__absoluteDivLarge(e,r,!0,!1);return m.sign=h,m.__trim()}static remainder(e,r){if(r.length===0)throw new RangeError("Division by zero");if(0>J.__absoluteCompare(e,r))return e;const h=r.__unsignedDigit(0);if(r.length===1&&32767>=h){if(h===1)return J.__zero();const m=J.__absoluteModSmall(e,h);return m===0?J.__zero():J.__oneDigit(m,e.sign)}const d=J.__absoluteDivLarge(e,r,!1,!0);return d.sign=e.sign,d.__trim()}static add(e,r){const h=e.sign;return h===r.sign?J.__absoluteAdd(e,r,h):0<=J.__absoluteCompare(e,r)?J.__absoluteSub(e,r,h):J.__absoluteSub(r,e,!h)}static subtract(e,r){const h=e.sign;return h===r.sign?0<=J.__absoluteCompare(e,r)?J.__absoluteSub(e,r,h):J.__absoluteSub(r,e,!h):J.__absoluteAdd(e,r,h)}static leftShift(e,r){return r.length===0||e.length===0?e:r.sign?J.__rightShiftByAbsolute(e,r):J.__leftShiftByAbsolute(e,r)}static signedRightShift(e,r){return r.length===0||e.length===0?e:r.sign?J.__leftShiftByAbsolute(e,r):J.__rightShiftByAbsolute(e,r)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(e,r){return 0>J.__compareToBigInt(e,r)}static lessThanOrEqual(e,r){return 0>=J.__compareToBigInt(e,r)}static greaterThan(e,r){return 0<J.__compareToBigInt(e,r)}static greaterThanOrEqual(e,r){return 0<=J.__compareToBigInt(e,r)}static equal(e,r){if(e.sign!==r.sign||e.length!==r.length)return!1;for(let h=0;h<e.length;h++)if(e.__digit(h)!==r.__digit(h))return!1;return!0}static notEqual(e,r){return!J.equal(e,r)}static bitwiseAnd(e,r){var h=Math.max;if(!e.sign&&!r.sign)return J.__absoluteAnd(e,r).__trim();if(e.sign&&r.sign){const d=h(e.length,r.length)+1;let m=J.__absoluteSubOne(e,d);const y=J.__absoluteSubOne(r);return m=J.__absoluteOr(m,y,m),J.__absoluteAddOne(m,!0,m).__trim()}return e.sign&&([e,r]=[r,e]),J.__absoluteAndNot(e,J.__absoluteSubOne(r)).__trim()}static bitwiseXor(e,r){var h=Math.max;if(!e.sign&&!r.sign)return J.__absoluteXor(e,r).__trim();if(e.sign&&r.sign){const y=h(e.length,r.length),c=J.__absoluteSubOne(e,y),E=J.__absoluteSubOne(r);return J.__absoluteXor(c,E,c).__trim()}const d=h(e.length,r.length)+1;e.sign&&([e,r]=[r,e]);let m=J.__absoluteSubOne(r,d);return m=J.__absoluteXor(m,e,m),J.__absoluteAddOne(m,!0,m).__trim()}static bitwiseOr(e,r){var h=Math.max;const d=h(e.length,r.length);if(!e.sign&&!r.sign)return J.__absoluteOr(e,r).__trim();if(e.sign&&r.sign){let y=J.__absoluteSubOne(e,d);const c=J.__absoluteSubOne(r);return y=J.__absoluteAnd(y,c,y),J.__absoluteAddOne(y,!0,y).__trim()}e.sign&&([e,r]=[r,e]);let m=J.__absoluteSubOne(r,d);return m=J.__absoluteAndNot(m,e,m),J.__absoluteAddOne(m,!0,m).__trim()}static asIntN(e,r){var h=Math.floor;if(r.length===0)return r;if(e=h(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return J.__zero();if(e>=J.__kMaxLengthBits)return r;const d=0|(e+29)/30;if(r.length<d)return r;const m=r.__unsignedDigit(d-1),y=1<<(e-1)%30;if(r.length===d&&m<y)return r;if((m&y)!==y)return J.__truncateToNBits(e,r);if(!r.sign)return J.__truncateAndSubFromPowerOfTwo(e,r,!0);if((m&y-1)==0){for(let c=d-2;0<=c;c--)if(r.__digit(c)!==0)return J.__truncateAndSubFromPowerOfTwo(e,r,!1);return r.length===d&&m===y?r:J.__truncateToNBits(e,r)}return J.__truncateAndSubFromPowerOfTwo(e,r,!1)}static asUintN(e,r){var h=Math.floor;if(r.length===0)return r;if(e=h(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return J.__zero();if(r.sign){if(e>J.__kMaxLengthBits)throw new RangeError("BigInt too big");return J.__truncateAndSubFromPowerOfTwo(e,r,!1)}if(e>=J.__kMaxLengthBits)return r;const d=0|(e+29)/30;if(r.length<d)return r;const m=e%30;return r.length==d&&(m===0||!(r.__digit(d-1)>>>m))?r:J.__truncateToNBits(e,r)}static ADD(e,r){if(e=J.__toPrimitive(e),r=J.__toPrimitive(r),typeof e=="string")return typeof r!="string"&&(r=r.toString()),e+r;if(typeof r=="string")return e.toString()+r;if(e=J.__toNumeric(e),r=J.__toNumeric(r),J.__isBigInt(e)&&J.__isBigInt(r))return J.add(e,r);if(typeof e=="number"&&typeof r=="number")return e+r;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(e,r){return J.__compare(e,r,0)}static LE(e,r){return J.__compare(e,r,1)}static GT(e,r){return J.__compare(e,r,2)}static GE(e,r){return J.__compare(e,r,3)}static EQ(e,r){for(;;){if(J.__isBigInt(e))return J.__isBigInt(r)?J.equal(e,r):J.EQ(r,e);if(typeof e=="number"){if(J.__isBigInt(r))return J.__equalToNumber(r,e);if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="string"){if(J.__isBigInt(r))return e=J.__fromString(e),e!==null&&J.equal(e,r);if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="boolean"){if(J.__isBigInt(r))return J.__equalToNumber(r,+e);if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="symbol"){if(J.__isBigInt(r))return!1;if(typeof r!="object")return e==r;r=J.__toPrimitive(r)}else if(typeof e=="object"){if(typeof r=="object"&&r.constructor!==J)return e==r;e=J.__toPrimitive(e)}else return e==r}}static NE(e,r){return!J.EQ(e,r)}static DataViewGetBigInt64(e,r,h=!1){return J.asIntN(64,J.DataViewGetBigUint64(e,r,h))}static DataViewGetBigUint64(e,r,h=!1){const[d,m]=h?[4,0]:[0,4],y=e.getUint32(r+d,h),c=e.getUint32(r+m,h),E=new J(3,!1);return E.__setDigit(0,1073741823&c),E.__setDigit(1,(268435455&y)<<2|c>>>30),E.__setDigit(2,y>>>28),E.__trim()}static DataViewSetBigInt64(e,r,h,d=!1){J.DataViewSetBigUint64(e,r,h,d)}static DataViewSetBigUint64(e,r,h,d=!1){h=J.asUintN(64,h);let m=0,y=0;if(0<h.length&&(y=h.__digit(0),1<h.length)){const C=h.__digit(1);y|=C<<30,m=C>>>2,2<h.length&&(m|=h.__digit(2)<<28)}const[c,E]=d?[4,0]:[0,4];e.setUint32(r+c,m,d),e.setUint32(r+E,y,d)}static __zero(){return new J(0,!1)}static __oneDigit(e,r){const h=new J(1,r);return h.__setDigit(0,e),h}__copy(){const e=new J(this.length,this.sign);for(let r=0;r<this.length;r++)e[r]=this[r];return e}__trim(){let e=this.length,r=this[e-1];for(;r===0;)e--,r=this[e-1],this.pop();return e===0&&(this.sign=!1),this}__initializeDigits(){for(let e=0;e<this.length;e++)this[e]=0}static __decideRounding(e,r,h,d){if(0<r)return-1;let m;if(0>r)m=-r-1;else{if(h===0)return-1;h--,d=e.__digit(h),m=29}let y=1<<m;if((d&y)==0)return-1;if(y-=1,(d&y)!=0)return 1;for(;0<h;)if(h--,e.__digit(h)!==0)return 1;return 0}static __fromDouble(e){J.__kBitConversionDouble[0]=e;const r=2047&J.__kBitConversionInts[1]>>>20,h=r-1023,d=(0|h/30)+1,m=new J(d,0>e);let y=1048575&J.__kBitConversionInts[1]|1048576,c=J.__kBitConversionInts[0];const E=20,C=h%30;let k,z=0;if(C<20){const F=E-C;z=F+32,k=y>>>F,y=y<<32-F|c>>>F,c<<=32-F}else if(C===20)z=32,k=y,y=c,c=0;else{const F=C-E;z=32-F,k=y<<F|c>>>32-F,y=c<<F,c=0}m.__setDigit(d-1,k);for(let F=d-2;0<=F;F--)0<z?(z-=30,k=y>>>2,y=y<<30|c>>>2,c<<=30):k=0,m.__setDigit(F,k);return m.__trim()}static __isWhitespace(e){return 13>=e&&9<=e||(159>=e?e==32:131071>=e?e==160||e==5760:196607>=e?(e&=131071,10>=e||e==40||e==41||e==47||e==95||e==4096):e==65279)}static __fromString(e,r=0){let h=0;const d=e.length;let m=0;if(m===d)return J.__zero();let y=e.charCodeAt(m);for(;J.__isWhitespace(y);){if(++m===d)return J.__zero();y=e.charCodeAt(m)}if(y===43){if(++m===d)return null;y=e.charCodeAt(m),h=1}else if(y===45){if(++m===d)return null;y=e.charCodeAt(m),h=-1}if(r===0){if(r=10,y===48){if(++m===d)return J.__zero();if(y=e.charCodeAt(m),y===88||y===120){if(r=16,++m===d)return null;y=e.charCodeAt(m)}else if(y===79||y===111){if(r=8,++m===d)return null;y=e.charCodeAt(m)}else if(y===66||y===98){if(r=2,++m===d)return null;y=e.charCodeAt(m)}}}else if(r===16&&y===48){if(++m===d)return J.__zero();if(y=e.charCodeAt(m),y===88||y===120){if(++m===d)return null;y=e.charCodeAt(m)}}if(h!=0&&r!==10)return null;for(;y===48;){if(++m===d)return J.__zero();y=e.charCodeAt(m)}const c=d-m;let E=J.__kMaxBitsPerChar[r],C=J.__kBitsPerCharTableMultiplier-1;if(c>1073741824/E)return null;const k=E*c+C>>>J.__kBitsPerCharTableShift,z=new J(0|(k+29)/30,!1),F=10>r?r:10,B=10<r?r-10:0;if((r&r-1)==0){E>>=J.__kBitsPerCharTableShift;const Q=[],ie=[];let ne=!1;do{let ue=0,Ae=0;for(;;){let Te;if(y-48>>>0<F)Te=y-48;else if((32|y)-97>>>0<B)Te=(32|y)-87;else{ne=!0;break}if(Ae+=E,ue=ue<<E|Te,++m===d){ne=!0;break}if(y=e.charCodeAt(m),30<Ae+E)break}Q.push(ue),ie.push(Ae)}while(!ne);J.__fillFromParts(z,Q,ie)}else{z.__initializeDigits();let Q=!1,ie=0;do{let ne=0,ue=1;for(;;){let Te;if(y-48>>>0<F)Te=y-48;else if((32|y)-97>>>0<B)Te=(32|y)-87;else{Q=!0;break}const ke=ue*r;if(1073741823<ke)break;if(ue=ke,ne=ne*r+Te,ie++,++m===d){Q=!0;break}y=e.charCodeAt(m)}C=30*J.__kBitsPerCharTableMultiplier-1;const Ae=0|(E*ie+C>>>J.__kBitsPerCharTableShift)/30;z.__inplaceMultiplyAdd(ue,ne,Ae)}while(!Q)}if(m!==d){if(!J.__isWhitespace(y))return null;for(m++;m<d;m++)if(y=e.charCodeAt(m),!J.__isWhitespace(y))return null}return z.sign=h==-1,z.__trim()}static __fillFromParts(e,r,h){let d=0,m=0,y=0;for(let c=r.length-1;0<=c;c--){const E=r[c],C=h[c];m|=E<<y,y+=C,y===30?(e.__setDigit(d++,m),y=0,m=0):30<y&&(e.__setDigit(d++,1073741823&m),y-=30,m=E>>>C-y)}if(m!==0){if(d>=e.length)throw new Error("implementation bug");e.__setDigit(d++,m)}for(;d<e.length;d++)e.__setDigit(d,0)}static __toStringBasePowerOfTwo(e,r){const h=e.length;let d=r-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);const m=d,y=r-1,c=e.__digit(h-1),E=J.__clz30(c);let C=0|(30*h-E+m-1)/m;if(e.sign&&C++,268435456<C)throw new Error("string too long");const k=Array(C);let z=C-1,F=0,B=0;for(let ie=0;ie<h-1;ie++){const ne=e.__digit(ie),ue=(F|ne<<B)&y;k[z--]=J.__kConversionChars[ue];const Ae=m-B;for(F=ne>>>Ae,B=30-Ae;B>=m;)k[z--]=J.__kConversionChars[F&y],F>>>=m,B-=m}const Q=(F|c<<B)&y;for(k[z--]=J.__kConversionChars[Q],F=c>>>m-B;F!==0;)k[z--]=J.__kConversionChars[F&y],F>>>=m;if(e.sign&&(k[z--]="-"),z!=-1)throw new Error("implementation bug");return k.join("")}static __toStringGeneric(e,r,h){const d=e.length;if(d===0)return"";if(d===1){let ie=e.__unsignedDigit(0).toString(r);return h===!1&&e.sign&&(ie="-"+ie),ie}const m=30*d-J.__clz30(e.__digit(d-1)),y=J.__kMaxBitsPerChar[r],c=y-1;let E=m*J.__kBitsPerCharTableMultiplier;E+=c-1,E=0|E/c;const C=E+1>>1,k=J.exponentiate(J.__oneDigit(r,!1),J.__oneDigit(C,!1));let z,F;const B=k.__unsignedDigit(0);if(k.length===1&&32767>=B){z=new J(e.length,!1),z.__initializeDigits();let ie=0;for(let ne=2*e.length-1;0<=ne;ne--){const ue=ie<<15|e.__halfDigit(ne);z.__setHalfDigit(ne,0|ue/B),ie=0|ue%B}F=ie.toString(r)}else{const ie=J.__absoluteDivLarge(e,k,!0,!0);z=ie.quotient;const ne=ie.remainder.__trim();F=J.__toStringGeneric(ne,r,!0)}z.__trim();let Q=J.__toStringGeneric(z,r,!0);for(;F.length<C;)F="0"+F;return h===!1&&e.sign&&(Q="-"+Q),Q+F}static __unequalSign(e){return e?-1:1}static __absoluteGreater(e){return e?-1:1}static __absoluteLess(e){return e?1:-1}static __compareToBigInt(e,r){const h=e.sign;if(h!==r.sign)return J.__unequalSign(h);const d=J.__absoluteCompare(e,r);return 0<d?J.__absoluteGreater(h):0>d?J.__absoluteLess(h):0}static __compareToNumber(e,r){if(J.__isOneDigitInt(r)){const h=e.sign,d=0>r;if(h!==d)return J.__unequalSign(h);if(e.length===0){if(d)throw new Error("implementation bug");return r===0?0:-1}if(1<e.length)return J.__absoluteGreater(h);const m=Math.abs(r),y=e.__unsignedDigit(0);return y>m?J.__absoluteGreater(h):y<m?J.__absoluteLess(h):0}return J.__compareToDouble(e,r)}static __compareToDouble(e,r){if(r!==r)return r;if(r===1/0)return-1;if(r===-1/0)return 1;const h=e.sign;if(h!==0>r)return J.__unequalSign(h);if(r===0)throw new Error("implementation bug: should be handled elsewhere");if(e.length===0)return-1;J.__kBitConversionDouble[0]=r;const d=2047&J.__kBitConversionInts[1]>>>20;if(d==2047)throw new Error("implementation bug: handled elsewhere");const m=d-1023;if(0>m)return J.__absoluteGreater(h);const y=e.length;let c=e.__digit(y-1);const E=J.__clz30(c),C=30*y-E,k=m+1;if(C<k)return J.__absoluteLess(h);if(C>k)return J.__absoluteGreater(h);let z=1048576|1048575&J.__kBitConversionInts[1],F=J.__kBitConversionInts[0];const B=20,Q=29-E;if(Q!==(0|(C-1)%30))throw new Error("implementation bug");let ie,ne=0;if(20>Q){const ue=B-Q;ne=ue+32,ie=z>>>ue,z=z<<32-ue|F>>>ue,F<<=32-ue}else if(Q===20)ne=32,ie=z,z=F,F=0;else{const ue=Q-B;ne=32-ue,ie=z<<ue|F>>>32-ue,z=F<<ue,F=0}if(c>>>=0,ie>>>=0,c>ie)return J.__absoluteGreater(h);if(c<ie)return J.__absoluteLess(h);for(let ue=y-2;0<=ue;ue--){0<ne?(ne-=30,ie=z>>>2,z=z<<30|F>>>2,F<<=30):ie=0;const Ae=e.__unsignedDigit(ue);if(Ae>ie)return J.__absoluteGreater(h);if(Ae<ie)return J.__absoluteLess(h)}if(z!==0||F!==0){if(ne===0)throw new Error("implementation bug");return J.__absoluteLess(h)}return 0}static __equalToNumber(e,r){var h=Math.abs;return J.__isOneDigitInt(r)?r===0?e.length===0:e.length===1&&e.sign===0>r&&e.__unsignedDigit(0)===h(r):J.__compareToDouble(e,r)===0}static __comparisonResultToBool(e,r){return r===0?0>e:r===1?0>=e:r===2?0<e:r===3?0<=e:void 0}static __compare(e,r,h){if(e=J.__toPrimitive(e),r=J.__toPrimitive(r),typeof e=="string"&&typeof r=="string")switch(h){case 0:return e<r;case 1:return e<=r;case 2:return e>r;case 3:return e>=r}if(J.__isBigInt(e)&&typeof r=="string")return r=J.__fromString(r),r!==null&&J.__comparisonResultToBool(J.__compareToBigInt(e,r),h);if(typeof e=="string"&&J.__isBigInt(r))return e=J.__fromString(e),e!==null&&J.__comparisonResultToBool(J.__compareToBigInt(e,r),h);if(e=J.__toNumeric(e),r=J.__toNumeric(r),J.__isBigInt(e)){if(J.__isBigInt(r))return J.__comparisonResultToBool(J.__compareToBigInt(e,r),h);if(typeof r!="number")throw new Error("implementation bug");return J.__comparisonResultToBool(J.__compareToNumber(e,r),h)}if(typeof e!="number")throw new Error("implementation bug");if(J.__isBigInt(r))return J.__comparisonResultToBool(J.__compareToNumber(r,e),2^h);if(typeof r!="number")throw new Error("implementation bug");return h===0?e<r:h===1?e<=r:h===2?e>r:h===3?e>=r:void 0}__clzmsd(){return J.__clz30(this.__digit(this.length-1))}static __absoluteAdd(e,r,h){if(e.length<r.length)return J.__absoluteAdd(r,e,h);if(e.length===0)return e;if(r.length===0)return e.sign===h?e:J.unaryMinus(e);let d=e.length;(e.__clzmsd()===0||r.length===e.length&&r.__clzmsd()===0)&&d++;const m=new J(d,h);let y=0,c=0;for(;c<r.length;c++){const E=e.__digit(c)+r.__digit(c)+y;y=E>>>30,m.__setDigit(c,1073741823&E)}for(;c<e.length;c++){const E=e.__digit(c)+y;y=E>>>30,m.__setDigit(c,1073741823&E)}return c<m.length&&m.__setDigit(c,y),m.__trim()}static __absoluteSub(e,r,h){if(e.length===0)return e;if(r.length===0)return e.sign===h?e:J.unaryMinus(e);const d=new J(e.length,h);let m=0,y=0;for(;y<r.length;y++){const c=e.__digit(y)-r.__digit(y)-m;m=1&c>>>30,d.__setDigit(y,1073741823&c)}for(;y<e.length;y++){const c=e.__digit(y)-m;m=1&c>>>30,d.__setDigit(y,1073741823&c)}return d.__trim()}static __absoluteAddOne(e,r,h=null){const d=e.length;h===null?h=new J(d,r):h.sign=r;let m=1;for(let y=0;y<d;y++){const c=e.__digit(y)+m;m=c>>>30,h.__setDigit(y,1073741823&c)}return m!=0&&h.__setDigitGrow(d,1),h}static __absoluteSubOne(e,r){const h=e.length;r=r||h;const d=new J(r,!1);let m=1;for(let y=0;y<h;y++){const c=e.__digit(y)-m;m=1&c>>>30,d.__setDigit(y,1073741823&c)}if(m!=0)throw new Error("implementation bug");for(let y=h;y<r;y++)d.__setDigit(y,0);return d}static __absoluteAnd(e,r,h=null){let d=e.length,m=r.length,y=m;if(d<m){y=d;const C=e,k=d;e=r,d=m,r=C,m=k}let c=y;h===null?h=new J(c,!1):c=h.length;let E=0;for(;E<y;E++)h.__setDigit(E,e.__digit(E)&r.__digit(E));for(;E<c;E++)h.__setDigit(E,0);return h}static __absoluteAndNot(e,r,h=null){const d=e.length,m=r.length;let y=m;d<m&&(y=d);let c=d;h===null?h=new J(c,!1):c=h.length;let E=0;for(;E<y;E++)h.__setDigit(E,e.__digit(E)&~r.__digit(E));for(;E<d;E++)h.__setDigit(E,e.__digit(E));for(;E<c;E++)h.__setDigit(E,0);return h}static __absoluteOr(e,r,h=null){let d=e.length,m=r.length,y=m;if(d<m){y=d;const C=e,k=d;e=r,d=m,r=C,m=k}let c=d;h===null?h=new J(c,!1):c=h.length;let E=0;for(;E<y;E++)h.__setDigit(E,e.__digit(E)|r.__digit(E));for(;E<d;E++)h.__setDigit(E,e.__digit(E));for(;E<c;E++)h.__setDigit(E,0);return h}static __absoluteXor(e,r,h=null){let d=e.length,m=r.length,y=m;if(d<m){y=d;const C=e,k=d;e=r,d=m,r=C,m=k}let c=d;h===null?h=new J(c,!1):c=h.length;let E=0;for(;E<y;E++)h.__setDigit(E,e.__digit(E)^r.__digit(E));for(;E<d;E++)h.__setDigit(E,e.__digit(E));for(;E<c;E++)h.__setDigit(E,0);return h}static __absoluteCompare(e,r){const h=e.length-r.length;if(h!=0)return h;let d=e.length-1;for(;0<=d&&e.__digit(d)===r.__digit(d);)d--;return 0>d?0:e.__unsignedDigit(d)>r.__unsignedDigit(d)?1:-1}static __multiplyAccumulate(e,r,h,d){if(r===0)return;const m=32767&r,y=r>>>15;let c=0,E=0;for(let C,k=0;k<e.length;k++,d++){C=h.__digit(d);const z=e.__digit(k),F=32767&z,B=z>>>15,Q=J.__imul(F,m),ie=J.__imul(F,y),ne=J.__imul(B,m),ue=J.__imul(B,y);C+=E+Q+c,c=C>>>30,C&=1073741823,C+=((32767&ie)<<15)+((32767&ne)<<15),c+=C>>>30,E=ue+(ie>>>15)+(ne>>>15),h.__setDigit(d,1073741823&C)}for(;c!=0||E!==0;d++){let C=h.__digit(d);C+=c+E,E=0,c=C>>>30,h.__setDigit(d,1073741823&C)}}static __internalMultiplyAdd(e,r,h,d,m){let y=h,c=0;for(let E=0;E<d;E++){const C=e.__digit(E),k=J.__imul(32767&C,r),z=J.__imul(C>>>15,r),F=k+((32767&z)<<15)+c+y;y=F>>>30,c=z>>>15,m.__setDigit(E,1073741823&F)}if(m.length>d)for(m.__setDigit(d++,y+c);d<m.length;)m.__setDigit(d++,0);else if(y+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(e,r,h){h>this.length&&(h=this.length);const d=32767&e,m=e>>>15;let y=0,c=r;for(let E=0;E<h;E++){const C=this.__digit(E),k=32767&C,z=C>>>15,F=J.__imul(k,d),B=J.__imul(k,m),Q=J.__imul(z,d),ie=J.__imul(z,m);let ne=c+F+y;y=ne>>>30,ne&=1073741823,ne+=((32767&B)<<15)+((32767&Q)<<15),y+=ne>>>30,c=ie+(B>>>15)+(Q>>>15),this.__setDigit(E,1073741823&ne)}if(y!=0||c!==0)throw new Error("implementation bug")}static __absoluteDivSmall(e,r,h=null){h===null&&(h=new J(e.length,!1));let d=0;for(let m,y=2*e.length-1;0<=y;y-=2){m=(d<<15|e.__halfDigit(y))>>>0;const c=0|m/r;d=0|m%r,m=(d<<15|e.__halfDigit(y-1))>>>0;const E=0|m/r;d=0|m%r,h.__setDigit(y>>>1,c<<15|E)}return h}static __absoluteModSmall(e,r){let h=0;for(let d=2*e.length-1;0<=d;d--)h=0|((h<<15|e.__halfDigit(d))>>>0)%r;return h}static __absoluteDivLarge(e,r,h,d){const m=r.__halfDigitLength(),y=r.length,c=e.__halfDigitLength()-m;let E=null;h&&(E=new J(c+2>>>1,!1),E.__initializeDigits());const C=new J(m+2>>>1,!1);C.__initializeDigits();const k=J.__clz15(r.__halfDigit(m-1));0<k&&(r=J.__specialLeftShift(r,k,0));const z=J.__specialLeftShift(e,k,1),F=r.__halfDigit(m-1);let B=0;for(let Q,ie=c;0<=ie;ie--){Q=32767;const ne=z.__halfDigit(ie+m);if(ne!==F){const Ae=(ne<<15|z.__halfDigit(ie+m-1))>>>0;Q=0|Ae/F;let Te=0|Ae%F;const ke=r.__halfDigit(m-2),be=z.__halfDigit(ie+m-2);for(;J.__imul(Q,ke)>>>0>(Te<<16|be)>>>0&&(Q--,Te+=F,!(32767<Te)););}J.__internalMultiplyAdd(r,Q,0,y,C);let ue=z.__inplaceSub(C,ie,m+1);ue!==0&&(ue=z.__inplaceAdd(r,ie,m),z.__setHalfDigit(ie+m,32767&z.__halfDigit(ie+m)+ue),Q--),h&&(1&ie?B=Q<<15:E.__setDigit(ie>>>1,B|Q))}if(d)return z.__inplaceRightShift(k),h?{quotient:E,remainder:z}:z;if(h)return E;throw new Error("unreachable")}static __clz15(e){return J.__clz30(e)-15}__inplaceAdd(e,r,h){let d=0;for(let m=0;m<h;m++){const y=this.__halfDigit(r+m)+e.__halfDigit(m)+d;d=y>>>15,this.__setHalfDigit(r+m,32767&y)}return d}__inplaceSub(e,r,h){let d=0;if(1&r){r>>=1;let m=this.__digit(r),y=32767&m,c=0;for(;c<h-1>>>1;c++){const k=e.__digit(c),z=(m>>>15)-(32767&k)-d;d=1&z>>>15,this.__setDigit(r+c,(32767&z)<<15|32767&y),m=this.__digit(r+c+1),y=(32767&m)-(k>>>15)-d,d=1&y>>>15}const E=e.__digit(c),C=(m>>>15)-(32767&E)-d;if(d=1&C>>>15,this.__setDigit(r+c,(32767&C)<<15|32767&y),r+c+1>=this.length)throw new RangeError("out of bounds");(1&h)==0&&(m=this.__digit(r+c+1),y=(32767&m)-(E>>>15)-d,d=1&y>>>15,this.__setDigit(r+e.length,1073709056&m|32767&y))}else{r>>=1;let m=0;for(;m<e.length-1;m++){const k=this.__digit(r+m),z=e.__digit(m),F=(32767&k)-(32767&z)-d;d=1&F>>>15;const B=(k>>>15)-(z>>>15)-d;d=1&B>>>15,this.__setDigit(r+m,(32767&B)<<15|32767&F)}const y=this.__digit(r+m),c=e.__digit(m),E=(32767&y)-(32767&c)-d;d=1&E>>>15;let C=0;(1&h)==0&&(C=(y>>>15)-(c>>>15)-d,d=1&C>>>15),this.__setDigit(r+m,(32767&C)<<15|32767&E)}return d}__inplaceRightShift(e){if(e===0)return;let r=this.__digit(0)>>>e;const h=this.length-1;for(let d=0;d<h;d++){const m=this.__digit(d+1);this.__setDigit(d,1073741823&m<<30-e|r),r=m>>>e}this.__setDigit(h,r)}static __specialLeftShift(e,r,h){const d=e.length,m=new J(d+h,!1);if(r===0){for(let c=0;c<d;c++)m.__setDigit(c,e.__digit(c));return 0<h&&m.__setDigit(d,0),m}let y=0;for(let c=0;c<d;c++){const E=e.__digit(c);m.__setDigit(c,1073741823&E<<r|y),y=E>>>30-r}return 0<h&&m.__setDigit(d,y),m}static __leftShiftByAbsolute(e,r){const h=J.__toShiftAmount(r);if(0>h)throw new RangeError("BigInt too big");const d=0|h/30,m=h%30,y=e.length,c=m!==0&&e.__digit(y-1)>>>30-m!=0,E=y+d+(c?1:0),C=new J(E,e.sign);if(m===0){let k=0;for(;k<d;k++)C.__setDigit(k,0);for(;k<E;k++)C.__setDigit(k,e.__digit(k-d))}else{let k=0;for(let z=0;z<d;z++)C.__setDigit(z,0);for(let z=0;z<y;z++){const F=e.__digit(z);C.__setDigit(z+d,1073741823&F<<m|k),k=F>>>30-m}if(c)C.__setDigit(y+d,k);else if(k!==0)throw new Error("implementation bug")}return C.__trim()}static __rightShiftByAbsolute(e,r){const h=e.length,d=e.sign,m=J.__toShiftAmount(r);if(0>m)return J.__rightShiftByMaximum(d);const y=0|m/30,c=m%30;let E=h-y;if(0>=E)return J.__rightShiftByMaximum(d);let C=!1;if(d){if((e.__digit(y)&(1<<c)-1)!=0)C=!0;else for(let z=0;z<y;z++)if(e.__digit(z)!==0){C=!0;break}}C&&c===0&&~e.__digit(h-1)==0&&E++;let k=new J(E,d);if(c===0){k.__setDigit(E-1,0);for(let z=y;z<h;z++)k.__setDigit(z-y,e.__digit(z))}else{let z=e.__digit(y)>>>c;const F=h-y-1;for(let B=0;B<F;B++){const Q=e.__digit(B+y+1);k.__setDigit(B,1073741823&Q<<30-c|z),z=Q>>>c}k.__setDigit(F,z)}return C&&(k=J.__absoluteAddOne(k,!0,k)),k.__trim()}static __rightShiftByMaximum(e){return e?J.__oneDigit(1,!0):J.__zero()}static __toShiftAmount(e){if(1<e.length)return-1;const r=e.__unsignedDigit(0);return r>J.__kMaxLengthBits?-1:r}static __toPrimitive(e,r="default"){if(typeof e!="object"||e.constructor===J)return e;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const m=e[Symbol.toPrimitive];if(m){const y=m(r);if(typeof y!="object")return y;throw new TypeError("Cannot convert object to primitive value")}}const h=e.valueOf;if(h){const m=h.call(e);if(typeof m!="object")return m}const d=e.toString;if(d){const m=d.call(e);if(typeof m!="object")return m}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(e){return J.__isBigInt(e)?e:+e}static __isBigInt(e){return typeof e=="object"&&e!==null&&e.constructor===J}static __truncateToNBits(e,r){const h=0|(e+29)/30,d=new J(h,r.sign),m=h-1;for(let c=0;c<m;c++)d.__setDigit(c,r.__digit(c));let y=r.__digit(m);if(e%30!=0){const c=32-e%30;y=y<<c>>>c}return d.__setDigit(m,y),d.__trim()}static __truncateAndSubFromPowerOfTwo(e,r,h){var d=Math.min;const m=0|(e+29)/30,y=new J(m,h);let c=0;const E=m-1;let C=0;for(const B=d(E,r.length);c<B;c++){const Q=0-r.__digit(c)-C;C=1&Q>>>30,y.__setDigit(c,1073741823&Q)}for(;c<E;c++)y.__setDigit(c,0|1073741823&-C);let k=E<r.length?r.__digit(E):0;const z=e%30;let F;if(z==0)F=0-k-C,F&=1073741823;else{const B=32-z;k=k<<B>>>B;const Q=1<<32-B;F=Q-k-C,F&=Q-1}return y.__setDigit(E,F),y.__trim()}__digit(e){return this[e]}__unsignedDigit(e){return this[e]>>>0}__setDigit(e,r){this[e]=0|r}__setDigitGrow(e,r){this[e]=0|r}__halfDigitLength(){const e=this.length;return 32767>=this.__unsignedDigit(e-1)?2*e-1:2*e}__halfDigit(e){return 32767&this[e>>>1]>>>15*(1&e)}__setHalfDigit(e,r){const h=e>>>1,d=this.__digit(h),m=1&e?32767&d|r<<15:1073709056&d|32767&r;this.__setDigit(h,m)}static __digitPow(e,r){let h=1;for(;0<r;)1&r&&(h*=e),r>>>=1,e*=e;return h}static __isOneDigitInt(e){return(1073741823&e)===e}}J.__kMaxLength=33554432,J.__kMaxLengthBits=J.__kMaxLength<<5,J.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],J.__kBitsPerCharTableShift=5,J.__kBitsPerCharTableMultiplier=1<<J.__kBitsPerCharTableShift,J.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],J.__kBitConversionBuffer=new ArrayBuffer(8),J.__kBitConversionDouble=new Float64Array(J.__kBitConversionBuffer),J.__kBitConversionInts=new Int32Array(J.__kBitConversionBuffer),J.__clz30=Math.clz32?function(n){return Math.clz32(n)-2}:function(n){return n===0?30:0|29-(0|Math.log(n>>>0)/Math.LN2)},J.__imul=Math.imul||function(n,e){return 0|n*e};const Sl=J.BigInt(0),q_=J.BigInt(1),Cw=J.BigInt(2),z5=J.BigInt(10),N5=J.BigInt(24),j5=J.BigInt(60),F5=J.BigInt(1e3),h0=J.BigInt(1e6),L_=J.BigInt(1e9),MM=J.multiply(J.BigInt(3600),L_),B5=J.multiply(j5,L_),Nf=J.multiply(MM,N5);function ud(n){return typeof n=="bigint"?J.BigInt(n.toString(10)):n}function CM(n){return J.equal(J.remainder(n,Cw),Sl)}function qp(n){return J.lessThan(n,Sl)?J.unaryMinus(n):n}function eb(n,e){return J.lessThan(n,e)?-1:J.greaterThan(n,e)?1:0}function S_(n,e){return{quotient:J.divide(n,e),remainder:J.remainder(n,e)}}var WT,QT;const wn="slot-epochNanoSeconds",Tn="slot-iso-date",mr="slot-iso-date-time",jr="slot-time",It="slot-calendar",DM="slot-date-brand",IM="slot-year-month-brand",RM="slot-month-day-brand",Ri="slot-time-zone",ns="slot-years",is="slot-months",Fs="slot-weeks",rs="slot-days",as="slot-hours",os="slot-minutes",ss="slot-seconds",ls="slot-milliseconds",cs="slot-microseconds",Bs="slot-nanoseconds",kM="date",OM="ym",PM="md",LM="time",zM="datetime",NM="instant",ym="original",Sg="timezone-canonical",g1="timezone-original",E_="calendar-id",jM="locale",y1="options",FM=new WeakMap,_1=Symbol.for("@@Temporal__GetSlots");(WT=globalThis)[_1]||(WT[_1]=function(n){return FM.get(n)});const Rb=globalThis[_1],v1=Symbol.for("@@Temporal__CreateSlots");(QT=globalThis)[v1]||(QT[v1]=function(n){FM.set(n,Object.create(null))});const Ld=globalThis[v1];function ms(n,...e){if(!n||typeof n!="object")return!1;const r=Rb(n);return!!r&&e.every(h=>h in r)}function oe(n,e){const r=Rb(n)?.[e];if(r===void 0)throw new TypeError(`Missing internal slot ${e}`);return r}function Gn(n,e,r){const h=Rb(n);if(h===void 0)throw new TypeError("Missing slots for the given container");if(h[e])throw new TypeError(`${e} already has set`);h[e]=r}const b1={};function zd(n,e){Object.defineProperty(n.prototype,Symbol.toStringTag,{value:e,writable:!1,enumerable:!1,configurable:!0});const r=Object.getOwnPropertyNames(n);for(let d=0;d<r.length;d++){const m=r[d],y=Object.getOwnPropertyDescriptor(n,m);y.configurable&&y.enumerable&&(y.enumerable=!1,Object.defineProperty(n,m,y))}const h=Object.getOwnPropertyNames(n.prototype);for(let d=0;d<h.length;d++){const m=h[d],y=Object.getOwnPropertyDescriptor(n.prototype,m);y.configurable&&y.enumerable&&(y.enumerable=!1,Object.defineProperty(n.prototype,m,y))}x1(e,n),x1(`${e}.prototype`,n.prototype)}function x1(n,e){const r=`%${n}%`;if(b1[r]!==void 0)throw new Error(`intrinsic ${n} already exists`);b1[r]=e}function fo(n){return b1[n]}function Ag(n,e){let r=n;if(r===0)return{div:r,mod:r};const h=Math.sign(r);r=Math.abs(r);const d=Math.trunc(1+Math.log10(r));if(e>=d)return{div:0*h,mod:h*r};if(e===0)return{div:h*r,mod:0*h};const m=r.toPrecision(d);return{div:h*Number.parseInt(m.slice(0,d-e),10),mod:h*Number.parseInt(m.slice(d-e),10)}}function Fx(n,e,r){let h=n,d=r;if(h===0)return d;const m=Math.sign(h)||Math.sign(d);h=Math.abs(h),d=Math.abs(d);const y=h.toPrecision(Math.trunc(1+Math.log10(h)));if(d===0)return m*Number.parseInt(y+"0".repeat(e),10);const c=y+d.toPrecision(Math.trunc(1+Math.log10(d))).padStart(e,"0");return m*Number.parseInt(c,10)}function kb(n,e){const r=e==="negative";switch(n){case"ceil":return r?"zero":"infinity";case"floor":return r?"infinity":"zero";case"expand":return"infinity";case"trunc":return"zero";case"halfCeil":return r?"half-zero":"half-infinity";case"halfFloor":return r?"half-infinity":"half-zero";case"halfExpand":return"half-infinity";case"halfTrunc":return"half-zero";case"halfEven":return"half-even"}}function Ob(n,e,r,h,d){return d==="zero"?n:d==="infinity"?e:r<0?n:r>0?e:d==="half-zero"?n:d==="half-infinity"?e:h?n:e}class Xn{constructor(e){this.totalNs=ud(e),this.sec=J.toNumber(J.divide(this.totalNs,L_)),this.subsec=J.toNumber(J.remainder(this.totalNs,L_))}static validateNew(e,r){if(J.greaterThan(qp(e),Xn.MAX))throw new RangeError(`${r} of duration time units cannot exceed ${Xn.MAX} s`);return new Xn(e)}static fromEpochNsDiff(e,r){const h=J.subtract(ud(e),ud(r));return new Xn(h)}static fromComponents(e,r,h,d,m,y){const c=J.add(J.add(J.add(J.add(J.add(J.BigInt(y),J.multiply(J.BigInt(m),F5)),J.multiply(J.BigInt(d),h0)),J.multiply(J.BigInt(h),L_)),J.multiply(J.BigInt(r),B5)),J.multiply(J.BigInt(e),MM));return Xn.validateNew(c,"total")}abs(){return new Xn(qp(this.totalNs))}add(e){return Xn.validateNew(J.add(this.totalNs,e.totalNs),"sum")}add24HourDays(e){return Xn.validateNew(J.add(this.totalNs,J.multiply(J.BigInt(e),Nf)),"sum")}addToEpochNs(e){return J.add(ud(e),this.totalNs)}cmp(e){return eb(this.totalNs,e.totalNs)}divmod(e){const{quotient:r,remainder:h}=S_(this.totalNs,J.BigInt(e));return{quotient:J.toNumber(r),remainder:new Xn(h)}}fdiv(e){const r=ud(e),h=J.BigInt(r);let{quotient:d,remainder:m}=S_(this.totalNs,h);const y=[];let c;const E=(J.lessThan(this.totalNs,Sl)?-1:1)*Math.sign(J.toNumber(r));for(;!J.equal(m,Sl)&&y.length<50;)m=J.multiply(m,z5),{quotient:c,remainder:m}=S_(m,h),y.push(Math.abs(J.toNumber(c)));return E*+(qp(d).toString()+"."+y.join(""))}isZero(){return J.equal(this.totalNs,Sl)}round(e,r){const h=ud(e);if(J.equal(h,q_))return this;const{quotient:d,remainder:m}=S_(this.totalNs,h),y=J.lessThan(this.totalNs,Sl)?"negative":"positive",c=J.multiply(qp(d),h),E=J.add(c,h),C=eb(qp(J.multiply(m,Cw)),h),k=kb(r,y),z=J.equal(qp(this.totalNs),c)?c:Ob(c,E,C,CM(d),k),F=y==="positive"?z:J.unaryMinus(z);return Xn.validateNew(F,"rounding")}sign(){return this.cmp(new Xn(Sl))}subtract(e){return Xn.validateNew(J.subtract(this.totalNs,e.totalNs),"difference")}}Xn.MAX=J.BigInt("9007199254740991999999999"),Xn.ZERO=new Xn(Sl);const KT=/[A-Za-z._][A-Za-z._0-9+-]*/,d0=new RegExp(`(?:${/(?:[+-](?:[01][0-9]|2[0-3])(?::?[0-5][0-9])?)/.source}|(?:${KT.source})(?:\\/(?:${KT.source}))*)`),BM=/(?:[+-]\d{6}|\d{4})/,tb=/(?:0[1-9]|1[0-2])/,w1=/(?:0[1-9]|[12]\d|3[01])/,U5=new RegExp(`(${BM.source})(?:-(${tb.source})-(${w1.source})|(${tb.source})(${w1.source}))`),UM=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,VM=/((?:[+-])(?:[01][0-9]|2[0-3])(?::?(?:[0-5][0-9])(?::?(?:[0-5][0-9])(?:[.,](?:\d{1,9}))?)?)?)/,GM=new RegExp(`([zZ])|${VM.source}?`),Ug=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,V5=new RegExp([`^${U5.source}`,`(?:(?:[tT]|\\s+)${UM.source}(?:${GM.source})?)?`,`(?:\\[!?(${d0.source})\\])?`,`((?:${Ug.source})*)$`].join("")),G5=new RegExp([`^[tT]?${UM.source}`,`(?:${GM.source})?`,`(?:\\[!?${d0.source}\\])?`,`((?:${Ug.source})*)$`].join("")),$5=new RegExp(`^(${BM.source})-?(${tb.source})(?:\\[!?${d0.source}\\])?((?:${Ug.source})*)$`),Z5=new RegExp(`^(?:--)?(${tb.source})-?(${w1.source})(?:\\[!?${d0.source}\\])?((?:${Ug.source})*)$`),Bx=/(\d+)(?:[.,](\d{1,9}))?/,Y5=new RegExp(`(?:${Bx.source}H)?(?:${Bx.source}M)?(?:${Bx.source}S)?`),H5=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${Y5.source})?$`,"i"),jf=864e5,nb=1e6*jf,q5=6e10,$M=1e8*jf,Vg=ah($M),X_=J.unaryMinus(Vg),X5=J.add(J.subtract(X_,Nf),q_),W5=J.subtract(J.add(Vg,Nf),q_),Q5=146097*jf,JT=-271821,eS=275760,z_=Date.UTC(1847,0,1),K5=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","ethiopic-amete-alem","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"],J5=new Set(["ACT","AET","AGT","ART","AST","BET","BST","CAT","CNT","CST","CTT","EAT","ECT","IET","IST","JST","MIT","NET","NST","PLT","PNT","PRT","PST","SST","VST"]);function Fr(n){return typeof n=="object"&&n!==null||typeof n=="function"}function Pb(n){if(typeof n=="bigint")throw new TypeError("Cannot convert BigInt to number");return Number(n)}function Lb(n){if(typeof n=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return String(n)}function Mn(n){const e=Pb(n);if(e===0)return 0;if(Number.isNaN(e)||e===1/0||e===-1/0)throw new RangeError("invalid number value");const r=Math.trunc(e);return r===0?0:r}function tS(n,e){const r=Mn(n);if(r<=0)throw e!==void 0?new RangeError(`property '${e}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return r}function su(n){const e=Pb(n);if(Number.isNaN(e))throw new RangeError("not a number");if(e===1/0||e===-1/0)throw new RangeError("infinity is out of range");if(!function(r){if(typeof r!="number"||Number.isNaN(r)||r===1/0||r===-1/0)return!1;const h=Math.abs(r);return Math.floor(h)===h}(e))throw new RangeError(`unsupported fractional value ${n}`);return e===0?0:e}function W_(n,e){return String(n).padStart(e,"0")}function Sa(n){if(typeof n!="string")throw new TypeError(`expected a string, not ${String(n)}`);return n}function T1(n,e){if(Fr(n)){const r=n?.toString();if(typeof r=="string"||typeof r=="number")return r;throw new TypeError("Cannot convert object to primitive value")}return n}const S1=["era","eraYear","year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],e4={era:Lb,eraYear:Mn,year:Mn,month:tS,monthCode:function(n){const e=Sa(T1(n));if(e.length<3||e.length>4||e[0]!=="M"||"0123456789".indexOf(e[1])===-1||"0123456789".indexOf(e[2])===-1||e[1]+e[2]==="00"&&e[3]!=="L"||e[3]!=="L"&&e[3]!==void 0)throw new RangeError(`bad month code ${e}; must match M01-M99 or M00L-M99L`);return e},day:tS,hour:Mn,minute:Mn,second:Mn,millisecond:Mn,microsecond:Mn,nanosecond:Mn,offset:function(n){const e=Sa(T1(n));return sy(e),e},timeZone:ds},t4={hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},Gg=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],nS=Object.fromEntries(Gg.map(n=>[n[0],n[1]])),n4=Object.fromEntries(Gg.map(([n,e])=>[e,n])),N_=Gg.map(([,n])=>n),$g={day:nb,hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},ib=["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],i4=Intl.DateTimeFormat,iS=new Map;function ZM(n){const e=t0(n);let r=iS.get(e);return r===void 0&&(r=new i4("en-us",{timeZone:e,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),iS.set(e,r)),r}function lo(n){return ms(n,wn)&&!ms(n,Ri,It)}function zr(n){return ms(n,ns,is,rs,as,os,ss,ls,cs,Bs)}function Nr(n){return ms(n,DM)}function Qr(n){return ms(n,jr)}function sr(n){return ms(n,mr)}function co(n){return ms(n,IM)}function Tl(n){return ms(n,RM)}function qn(n){return ms(n,wn,Ri,It)}function it(n,e){if(!e(n))throw new TypeError("invalid receiver: method called with the wrong type of this-object")}function ry(n){if(ms(n,It)||ms(n,Ri))throw new TypeError("with() does not support a calendar or timeZone property");if(Qr(n))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(n.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(n.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function f0(n,e){return e==="never"||e==="auto"&&n==="iso8601"?"":`[${e==="critical"?"!":""}u-ca=${n}]`}function zb(n){let e,r,h=!1;for(Ug.lastIndex=0;r=Ug.exec(n);){const{1:d,2:m,3:y}=r;if(m==="u-ca"){if(e===void 0)e=y,h=d==="!";else if(d==="!"||h)throw new RangeError(`Invalid annotations in ${n}: more than one u-ca present with critical flag`)}else if(d==="!")throw new RangeError(`Unrecognized annotation: !${m}=${y}`)}return e}function ph(n){const e=V5.exec(n);if(!e)throw new RangeError(`invalid RFC 9557 string: ${n}`);const r=zb(e[16]);let h=e[1];if(h==="-000000")throw new RangeError(`invalid RFC 9557 string: ${n}`);const d=+h,m=+(e[2]??e[4]??1),y=+(e[3]??e[5]??1),c=e[6]!==void 0,E=+(e[6]??0),C=+(e[7]??e[10]??0);let k=+(e[8]??e[11]??0);k===60&&(k=59);const z=(e[9]??e[12]??"")+"000000000",F=+z.slice(0,3),B=+z.slice(3,6),Q=+z.slice(6,9);let ie,ne=!1;e[13]?(ie=void 0,ne=!0):e[14]&&(ie=e[14]);const ue=e[15];return Pw(d,m,y,E,C,k,F,B,Q),{year:d,month:m,day:y,time:c?{hour:E,minute:C,second:k,millisecond:F,microsecond:B,nanosecond:Q}:"start-of-day",tzAnnotation:ue,offset:ie,z:ne,calendar:r}}function YM(n){const e=G5.exec(n);let r,h,d,m,y,c,E;if(e){E=zb(e[10]),r=+(e[1]??0),h=+(e[2]??e[5]??0),d=+(e[3]??e[6]??0),d===60&&(d=59);const C=(e[4]??e[7]??"")+"000000000";if(m=+C.slice(0,3),y=+C.slice(3,6),c=+C.slice(6,9),e[8])throw new RangeError("Z designator not supported for PlainTime")}else{let C,k;if({time:C,z:k,calendar:E}=ph(n),C==="start-of-day")throw new RangeError(`time is missing in string: ${n}`);if(k)throw new RangeError("Z designator not supported for PlainTime");({hour:r,minute:h,second:d,millisecond:m,microsecond:y,nanosecond:c}=C)}if(Bb(r,h,d,m,y,c),/[tT ][0-9][0-9]/.test(n))return{hour:r,minute:h,second:d,millisecond:m,microsecond:y,nanosecond:c,calendar:E};try{const{month:C,day:k}=Iw(n);lm(1972,C,k)}catch{try{const{year:C,month:k}=Dw(n);lm(C,k,1)}catch{return{hour:r,minute:h,second:d,millisecond:m,microsecond:y,nanosecond:c,calendar:E}}}throw new RangeError(`invalid RFC 9557 time-only string ${n}; may need a T prefix`)}function Dw(n){const e=$5.exec(n);let r,h,d,m;if(e){d=zb(e[3]);let y=e[1];if(y==="-000000")throw new RangeError(`invalid RFC 9557 string: ${n}`);if(r=+y,h=+e[2],m=1,d!==void 0&&d!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let y;if({year:r,month:h,calendar:d,day:m,z:y}=ph(n),y)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:r,month:h,calendar:d,referenceISODay:m}}function Iw(n){const e=Z5.exec(n);let r,h,d,m;if(e){if(d=zb(e[3]),r=+e[1],h=+e[2],d!==void 0&&d!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let y;if({month:r,day:h,calendar:d,year:m,z:y}=ph(n),y)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:r,day:h,calendar:d,referenceISOYear:m}}const HM=new RegExp(`^${d0.source}$`,"i"),qM=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])?)?/.source}$`);function XM(n){const e=a4.test(n)?"Seconds not allowed in offset time zone":"Invalid time zone";throw new RangeError(`${e}: ${n}`)}function Pf(n){return HM.test(n)||XM(n),qM.test(n)?{offsetMinutes:sy(n)/6e10}:{tzName:n}}function j_(n,e,r,h){let d=n,m=e,y=r;switch(h){case"reject":lm(d,m,y);break;case"constrain":({year:d,month:m,day:y}=dC(d,m,y))}return{year:d,month:m,day:y}}function Nb(n,e,r,h,d,m,y){let c=n,E=e,C=r,k=h,z=d,F=m;switch(y){case"reject":Bb(c,E,C,k,z,F);break;case"constrain":c=us(c,0,23),E=us(E,0,59),C=us(C,0,59),k=us(k,0,999),z=us(z,0,999),F=us(F,0,999)}return{hour:c,minute:E,second:C,millisecond:k,microsecond:z,nanosecond:F}}function WM(n){if(!Fr(n))throw new TypeError("invalid duration-like");const e={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let r=!1;for(let h=0;h<ib.length;h++){const d=ib[h],m=n[d];m!==void 0&&(r=!0,e[d]=su(m))}if(!r)throw new TypeError("invalid duration-like");return e}function Oo({years:n,months:e,weeks:r,days:h},d,m,y){return{years:n,months:y??e,weeks:m??r,days:d??h}}function yi(n,e){return{isoDate:n,time:e}}function fi(n){return Ed(n,"overflow",["constrain","reject"],"constrain")}function F_(n){return Ed(n,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function du(n,e){return Ed(n,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],e)}function jv(n,e){return Ed(n,"offset",["prefer","use","ignore","reject"],e)}function p0(n){return Ed(n,"calendarName",["auto","always","never","critical"],"auto")}function ay(n){let e=n.roundingIncrement;if(e===void 0)return 1;const r=Mn(e);if(r<1||r>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${e}`);return r}function oy(n,e,r){const h=r?e:e-1;if(n>h)throw new RangeError(`roundingIncrement must be at least 1 and less than ${h}, not ${n}`);if(e%n!=0)throw new RangeError(`Rounding increment must divide evenly into ${e}`)}function m0(n){const e=n.fractionalSecondDigits;if(e===void 0)return"auto";if(typeof e!="number"){if(Lb(e)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`);return"auto"}const r=Math.floor(e);if(!Number.isFinite(r)||r<0||r>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`);return r}function g0(n,e){switch(n){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(e){case"auto":return{precision:e,unit:"nanosecond",increment:1};case 0:return{precision:e,unit:"second",increment:1};case 1:case 2:case 3:return{precision:e,unit:"millisecond",increment:10**(3-e)};case 4:case 5:case 6:return{precision:e,unit:"microsecond",increment:10**(6-e)};case 7:case 8:case 9:return{precision:e,unit:"nanosecond",increment:10**(9-e)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`)}}const Rd=Symbol("~required~");function Vs(n,e,r,h,d=[]){let m=[];for(let C=0;C<Gg.length;C++){const k=Gg[C],z=k[1],F=k[2];r!=="datetime"&&r!==F||m.push(z)}m=m.concat(d);let y=h;y===Rd?y=void 0:y!==void 0&&m.push(y);let c=[];c=c.concat(m);for(let C=0;C<m.length;C++){const k=m[C],z=n4[k];z!==void 0&&c.push(z)}let E=Ed(n,e,c,y);if(E===void 0&&h===Rd)throw new RangeError(`${e} is required`);return E&&E in nS?nS[E]:E}function Ux(n){const e=n.relativeTo;if(e===void 0)return{};let r,h,d,m,y,c="option",E=!1;if(Fr(e)){if(qn(e))return{zonedRelativeTo:e};if(Nr(e))return{plainRelativeTo:e};if(sr(e))return{plainRelativeTo:hs(oe(e,mr).isoDate,oe(e,It))};d=x0(e);const C=Rl(d,e,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],[]);({isoDate:r,time:h}=_0(d,C,"constrain")),{offset:y,timeZone:m}=C,y===void 0&&(c="wall")}else{let C,k,z,F,B;if({year:z,month:F,day:B,time:h,calendar:d,tzAnnotation:C,offset:y,z:k}=ph(Sa(e)),C)m=ds(C),k?c="exact":y||(c="wall"),E=!0;else if(k)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");d||(d="iso8601"),d=gs(d),r={year:z,month:F,day:B}}return m===void 0?{plainRelativeTo:hs(r,d)}:{zonedRelativeTo:ko(rb(r,h,c,c==="option"?sy(y):0,m,"compatible","reject",E),m,d)}}function dd(n){return oe(n,ns)!==0?"year":oe(n,is)!==0?"month":oe(n,Fs)!==0?"week":oe(n,rs)!==0?"day":oe(n,as)!==0?"hour":oe(n,os)!==0?"minute":oe(n,ss)!==0?"second":oe(n,ls)!==0?"millisecond":oe(n,cs)!==0?"microsecond":"nanosecond"}function Td(n,e){return N_.indexOf(n)>N_.indexOf(e)?e:n}function Ju(n){return n==="year"||n==="month"||n==="week"}function fd(n){return Ju(n)||n==="day"?"date":"time"}function Gf(n){return fo("%calendarImpl%")(n)}function y0(n){return fo("%calendarImpl%")(oe(n,It))}function fs(n,e,r="date"){const h=Object.create(null),d=Gf(n).isoToDate(e,{year:!0,monthCode:!0,day:!0});return h.monthCode=d.monthCode,r!=="month-day"&&r!=="date"||(h.day=d.day),r!=="year-month"&&r!=="date"||(h.year=d.year),h}function Rl(n,e,r,h,d){const m=Gf(n).extraFields(r),y=r.concat(h,m),c=Object.create(null);let E=!1;y.sort();for(let C=0;C<y.length;C++){const k=y[C],z=e[k];if(z!==void 0)E=!0,c[k]=(0,e4[k])(z);else if(d!=="partial"){if(d.includes(k))throw new TypeError(`required property '${k}' missing or undefined`);c[k]=t4[k]}}if(d==="partial"&&!E)throw new TypeError("no supported properties found");return c}function E1(n,e="complete"){const r=["hour","microsecond","millisecond","minute","nanosecond","second"];let h=!1;const d=Object.create(null);for(let m=0;m<r.length;m++){const y=r[m],c=n[y];c!==void 0?(d[y]=Mn(c),h=!0):e==="complete"&&(d[y]=0)}if(!h)throw new TypeError("invalid time-like");return d}function A_(n,e){if(Fr(n)){if(Nr(n))return fi(Jt(e)),hs(oe(n,Tn),oe(n,It));if(qn(n)){const E=xc(oe(n,Ri),oe(n,wn));return fi(Jt(e)),hs(E.isoDate,oe(n,It))}if(sr(n))return fi(Jt(e)),hs(oe(n,mr).isoDate,oe(n,It));const c=x0(n);return hs(Ff(c,Rl(c,n,["year","month","monthCode","day"],[],[]),fi(Jt(e))),c)}let{year:r,month:h,day:d,calendar:m,z:y}=ph(Sa(n));if(y)throw new RangeError("Z designator not supported for PlainDate");return m||(m="iso8601"),m=gs(m),fi(Jt(e)),hs({year:r,month:h,day:d},m)}function _0(n,e,r){return yi(Ff(n,e,r),Nb(e.hour,e.minute,e.second,e.millisecond,e.microsecond,e.nanosecond,r))}function M_(n,e){let r,h,d;if(Fr(n)){if(sr(n))return fi(Jt(e)),mc(oe(n,mr),oe(n,It));if(qn(n)){const c=xc(oe(n,Ri),oe(n,wn));return fi(Jt(e)),mc(c,oe(n,It))}if(Nr(n))return fi(Jt(e)),mc(yi(oe(n,Tn),{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),oe(n,It));d=x0(n);const m=Rl(d,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],[]),y=fi(Jt(e));({isoDate:r,time:h}=_0(d,m,y))}else{let m,y,c,E;if({year:y,month:c,day:E,time:h,calendar:d,z:m}=ph(Sa(n)),m)throw new RangeError("Z designator not supported for PlainDateTime");h==="start-of-day"&&(h={deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),Pw(y,c,E,h.hour,h.minute,h.second,h.millisecond,h.microsecond,h.nanosecond),d||(d="iso8601"),d=gs(d),fi(Jt(e)),r={year:y,month:c,day:E}}return mc(yi(r,h),d)}function _c(n){const e=fo("%Temporal.Duration%");if(zr(n))return new e(oe(n,ns),oe(n,is),oe(n,Fs),oe(n,rs),oe(n,as),oe(n,os),oe(n,ss),oe(n,ls),oe(n,cs),oe(n,Bs));if(!Fr(n))return function(d){const{years:m,months:y,weeks:c,days:E,hours:C,minutes:k,seconds:z,milliseconds:F,microseconds:B,nanoseconds:Q}=function(ie){const ne=H5.exec(ie);if(!ne)throw new RangeError(`invalid duration: ${ie}`);if(ne.every((xt,ut)=>ut<2||xt===void 0))throw new RangeError(`invalid duration: ${ie}`);const ue=ne[1]==="-"?-1:1,Ae=ne[2]===void 0?0:Mn(ne[2])*ue,Te=ne[3]===void 0?0:Mn(ne[3])*ue,ke=ne[4]===void 0?0:Mn(ne[4])*ue,be=ne[5]===void 0?0:Mn(ne[5])*ue,Me=ne[6]===void 0?0:Mn(ne[6])*ue,Fe=ne[7],ot=ne[8],Ee=ne[9],Je=ne[10],Et=ne[11];let Tt=0,zt=0,Zt=0;if(Fe!==void 0){if(ot??Ee??Je??Et)throw new RangeError("only the smallest unit can be fractional");Zt=3600*Mn((Fe+"000000000").slice(0,9))*ue}else if(Tt=ot===void 0?0:Mn(ot)*ue,Ee!==void 0){if(Je??Et)throw new RangeError("only the smallest unit can be fractional");Zt=60*Mn((Ee+"000000000").slice(0,9))*ue}else zt=Je===void 0?0:Mn(Je)*ue,Et!==void 0&&(Zt=Mn((Et+"000000000").slice(0,9))*ue);const Gt=Zt%1e3,Ue=Math.trunc(Zt/1e3)%1e3,st=Math.trunc(Zt/1e6)%1e3;return zt+=Math.trunc(Zt/1e9)%60,Tt+=Math.trunc(Zt/6e10),Ub(Ae,Te,ke,be,Me,Tt,zt,st,Ue,Gt),{years:Ae,months:Te,weeks:ke,days:be,hours:Me,minutes:Tt,seconds:zt,milliseconds:st,microseconds:Ue,nanoseconds:Gt}}(d);return new(fo("%Temporal.Duration%"))(m,y,c,E,C,k,z,F,B,Q)}(Sa(n));const r={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let h=WM(n);for(let d=0;d<ib.length;d++){const m=ib[d],y=h[m];y!==void 0&&(r[m]=y)}return new e(r.years,r.months,r.weeks,r.days,r.hours,r.minutes,r.seconds,r.milliseconds,r.microseconds,r.nanoseconds)}function C_(n){let e;if(Fr(n)){if(lo(n)||qn(n))return ih(oe(n,wn));e=T1(n)}else e=n;const{year:r,month:h,day:d,time:m,offset:y,z:c}=function(ie){const ne=ph(ie);if(!ne.z&&!ne.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return ne}(Sa(e)),{hour:E=0,minute:C=0,second:k=0,millisecond:z=0,microsecond:F=0,nanosecond:B=0}=m==="start-of-day"?{}:m,Q=e0(r,h,d,E,C,k,z,F,B-(c?0:sy(y)));return kg(Q.isoDate),ih(ho(Q))}function rS(n,e){if(Fr(n)){if(Tl(n))return fi(Jt(e)),Mg(oe(n,Tn),oe(n,It));let c;return ms(n,It)?c=oe(n,It):(c=n.calendar,c===void 0&&(c="iso8601"),c=b0(c)),Mg(ab(c,Rl(c,n,["year","month","monthCode","day"],[],[]),fi(Jt(e))),c)}let{month:r,day:h,referenceISOYear:d,calendar:m}=Iw(Sa(n));if(m===void 0&&(m="iso8601"),m=gs(m),fi(Jt(e)),m==="iso8601")return Mg({year:1972,month:r,day:h},m);let y={year:d,month:r,day:h};return _m(y),y=ab(m,fs(m,y,"month-day"),"constrain"),Mg(y,m)}function If(n,e){let r;if(Fr(n)){if(Qr(n))return fi(Jt(e)),gd(oe(n,jr));if(sr(n))return fi(Jt(e)),gd(oe(n,mr).time);if(qn(n)){const C=xc(oe(n,Ri),oe(n,wn));return fi(Jt(e)),gd(C.time)}const{hour:h,minute:d,second:m,millisecond:y,microsecond:c,nanosecond:E}=E1(n);r=Nb(h,d,m,y,c,E,fi(Jt(e)))}else r=YM(Sa(n)),fi(Jt(e));return gd(r)}function QM(n){return n===void 0?{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}:oe(If(n),jr)}function D_(n,e){if(Fr(n)){if(co(n))return fi(Jt(e)),Rg(oe(n,Tn),oe(n,It));const c=x0(n);return Rg(Q_(c,Rl(c,n,["year","month","monthCode"],[],[]),fi(Jt(e))),c)}let{year:r,month:h,referenceISODay:d,calendar:m}=Dw(Sa(n));m===void 0&&(m="iso8601"),m=gs(m),fi(Jt(e));let y={year:r,month:h,day:d};return Lw(y),y=Q_(m,fs(m,y,"year-month"),"constrain"),Rg(y,m)}function rb(n,e,r,h,d,m,y,c){if(e==="start-of-day")return Cf(d,n);const E=yi(n,e);if(r==="wall"||y==="ignore")return Po(d,E,m);if(r==="exact"||y==="use"){const z=e0(n.year,n.month,n.day,e.hour,e.minute,e.second,e.millisecond,e.microsecond,e.nanosecond-h);kg(z.isoDate);const F=ho(z);return hh(F),F}kg(n);const C=ho(E),k=K_(d,E);for(let z=0;z<k.length;z++){const F=k[z],B=J.toNumber(J.subtract(C,F)),Q=Rf(B,6e10,"halfExpand");if(B===h||c&&Q===h)return F}if(y==="reject"){const z=A1(h),F=J_(E,"iso8601","auto");throw new RangeError(`Offset ${z} is invalid for ${F} in ${d}`)}return oC(k,d,E,m)}function I_(n,e){let r,h,d,m,y,c,E,C=!1,k="option";if(Fr(n)){if(qn(n)){const ie=Jt(e);return F_(ie),jv(ie,"reject"),fi(ie),ko(oe(n,wn),oe(n,Ri),oe(n,It))}y=x0(n);const F=Rl(y,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],["timeZone"]);({offset:m,timeZone:d}=F),m===void 0&&(k="wall");const B=Jt(e);c=F_(B),E=jv(B,"reject");const Q=fi(B);({isoDate:r,time:h}=_0(y,F,Q))}else{let F,B,Q,ie,ne;({year:Q,month:ie,day:ne,time:h,tzAnnotation:F,offset:m,z:B,calendar:y}=function(Ae){const Te=ph(Ae);if(!Te.tzAnnotation)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return Te}(Sa(n))),d=ds(F),B?k="exact":m||(k="wall"),y||(y="iso8601"),y=gs(y),C=!0;const ue=Jt(e);c=F_(ue),E=jv(ue,"reject"),fi(ue),r={year:Q,month:ie,day:ne}}let z=0;return k==="option"&&(z=sy(m)),ko(rb(r,h,k,z,d,c,E,C),d,y)}function KM(n,e,r){_m(e),Ld(n),Gn(n,Tn,e),Gn(n,It,r),Gn(n,DM,!0)}function hs(n,e){const r=fo("%Temporal.PlainDate%"),h=Object.create(r.prototype);return KM(h,n,e),h}function JM(n,e,r){cm(e),Ld(n),Gn(n,mr,e),Gn(n,It,r)}function mc(n,e){const r=fo("%Temporal.PlainDateTime%"),h=Object.create(r.prototype);return JM(h,n,e),h}function eC(n,e,r){_m(e),Ld(n),Gn(n,Tn,e),Gn(n,It,r),Gn(n,RM,!0)}function Mg(n,e){const r=fo("%Temporal.PlainMonthDay%"),h=Object.create(r.prototype);return eC(h,n,e),h}function tC(n,e){Ld(n),Gn(n,jr,e)}function gd(n){const e=fo("%Temporal.PlainTime%"),r=Object.create(e.prototype);return tC(r,n),r}function nC(n,e,r){Lw(e),Ld(n),Gn(n,Tn,e),Gn(n,It,r),Gn(n,IM,!0)}function Rg(n,e){const r=fo("%Temporal.PlainYearMonth%"),h=Object.create(r.prototype);return nC(h,n,e),h}function iC(n,e){hh(e),Ld(n),Gn(n,wn,e)}function ih(n){const e=fo("%Temporal.Instant%"),r=Object.create(e.prototype);return iC(r,n),r}function rC(n,e,r,h){hh(e),Ld(n),Gn(n,wn,e),Gn(n,Ri,r),Gn(n,It,h)}function ko(n,e,r="iso8601"){const h=fo("%Temporal.ZonedDateTime%"),d=Object.create(h.prototype);return rC(d,n,e,r),d}function aS(n){return S1.filter(e=>n[e]!==void 0)}function sm(n,e,r){const h=aS(r),d=Gf(n).fieldKeysToIgnore(h),m=Object.create(null),y=aS(e);for(let c=0;c<S1.length;c++){let E;const C=S1[c];y.includes(C)&&!d.includes(C)&&(E=e[C]),h.includes(C)&&(E=r[C]),E!==void 0&&(m[C]=E)}return m}function Cl(n,e,r,h){const d=Gf(n).dateAdd(e,r,h);return _m(d),d}function v0(n,e,r,h){return Gf(n).dateUntil(e,r,h)}function b0(n){if(Fr(n)&&ms(n,It))return oe(n,It);const e=Sa(n);try{return gs(e)}catch{}let r;try{({calendar:r}=ph(e))}catch{try{({calendar:r}=YM(e))}catch{try{({calendar:r}=Dw(e))}catch{({calendar:r}=Iw(e))}}}return r||(r="iso8601"),gs(r)}function x0(n){if(ms(n,It))return oe(n,It);const{calendar:e}=n;return e===void 0?"iso8601":b0(e)}function uh(n,e){return gs(n)===gs(e)}function Ff(n,e,r){const h=Gf(n);h.resolveFields(e,"date");const d=h.dateToISO(e,r);return _m(d),d}function Q_(n,e,r){const h=Gf(n);h.resolveFields(e,"year-month"),e.day=1;const d=h.dateToISO(e,r);return Lw(d),d}function ab(n,e,r){const h=Gf(n);h.resolveFields(e,"month-day");const d=h.monthDayToISOReferenceDate(e,r);return _m(d),d}function ds(n){if(Fr(n)&&qn(n))return oe(n,Ri);const e=Sa(n);if(e==="UTC")return"UTC";const{tzName:r,offsetMinutes:h}=function(m){const{tzAnnotation:y,offset:c,z:E}=function(C){if(HM.test(C))return{tzAnnotation:C,offset:void 0,z:!1};try{const{tzAnnotation:k,offset:z,z:F}=ph(C);if(F||k||z)return{tzAnnotation:k,offset:z,z:F}}catch{}XM(C)}(m);return y?Pf(y):E?Pf("UTC"):c?Pf(c):void 0}(e);if(h!==void 0)return Rw(h);const d=ob(r);if(!d)throw new RangeError(`Unrecognized time zone ${r}`);return d.identifier}function aC(n,e){if(n===e)return!0;const r=Pf(n).offsetMinutes,h=Pf(e).offsetMinutes;if(r===void 0&&h===void 0){const d=ob(e);if(!d)return!1;const m=ob(n);return!!m&&m.primaryIdentifier===d.primaryIdentifier}return r===h}function yd(n,e){const r=Pf(n).offsetMinutes;return r!==void 0?6e10*r:M1(n,e)}function A1(n){const e=n<0?"-":"+",r=Math.abs(n),h=Math.floor(r/36e11),d=Math.floor(r/6e10)%60,m=Math.floor(r/1e9)%60,y=r%1e9;return`${e}${jb(h,d,m,y,m===0&&y===0?"minute":"auto")}`}function xc(n,e){const r=yd(n,e);let{isoDate:{year:h,month:d,day:m},time:{hour:y,minute:c,second:E,millisecond:C,microsecond:k,nanosecond:z}}=cC(e);return e0(h,d,m,y,c,E,C,k,z+r)}function Po(n,e,r){return oC(K_(n,e),n,e,r)}function oC(n,e,r,h){const d=n.length;if(d===1)return n[0];if(d)switch(h){case"compatible":case"earlier":return n[0];case"later":return n[d-1];case"reject":throw new RangeError("multiple instants found")}if(h==="reject")throw new RangeError("multiple instants found");const m=ho(r),y=J.subtract(m,Nf);hh(y);const c=yd(e,y),E=J.add(m,Nf);hh(E);const C=yd(e,E)-c;switch(h){case"earlier":{const k=Xn.fromComponents(0,0,0,0,0,-C),z=Zg(r.time,k);return K_(e,yi(Ys(r.isoDate.year,r.isoDate.month,r.isoDate.day+z.deltaDays),z))[0]}case"compatible":case"later":{const k=Xn.fromComponents(0,0,0,0,0,C),z=Zg(r.time,k),F=K_(e,yi(Ys(r.isoDate.year,r.isoDate.month,r.isoDate.day+z.deltaDays),z));return F[F.length-1]}}}function K_(n,e){if(n==="UTC")return kg(e.isoDate),[ho(e)];const r=Pf(n).offsetMinutes;if(r!==void 0){const h=e0(e.isoDate.year,e.isoDate.month,e.isoDate.day,e.time.hour,e.time.minute-r,e.time.second,e.time.millisecond,e.time.microsecond,e.time.nanosecond);kg(h.isoDate);const d=ho(h);return hh(d),[d]}return kg(e.isoDate),function(h,d){let m=ho(d),y=J.subtract(m,Nf);J.lessThan(y,X_)&&(y=m);let c=J.add(m,Nf);J.greaterThan(c,Vg)&&(c=m);const E=M1(h,y),C=M1(h,c);return(E===C?[E]:[E,C]).map(z=>{const F=J.subtract(m,J.BigInt(z)),B=function(Q,ie){const{epochMilliseconds:ne,time:{millisecond:ue,microsecond:Ae,nanosecond:Te}}=cC(ie),{year:ke,month:be,day:Me,hour:Fe,minute:ot,second:Ee}=uC(Q,ne);return e0(ke,be,Me,Fe,ot,Ee,ue,Ae,Te)}(h,F);if(Yg(d,B)===0)return hh(F),F}).filter(z=>z!==void 0)}(n,e)}function Cf(n,e){const r=yi(e,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),h=K_(n,r);if(h.length)return h[0];const d=ho(r),m=J.subtract(d,Nf);return hh(m),Ow(n,m)}function w0(n){let e;return e=n<0||n>9999?(n<0?"-":"+")+W_(Math.abs(n),6):W_(n,4),e}function Dl(n){return W_(n,2)}function sC(n,e){let r;if(e==="auto"){if(n===0)return"";r=W_(n,9).replace(/0+$/,"")}else{if(e===0)return"";r=W_(n,9).slice(0,e)}return`.${r}`}function jb(n,e,r,h,d){let m=`${Dl(n)}:${Dl(e)}`;return d==="minute"||(m+=`:${Dl(r)}`,m+=sC(h,d)),m}function oS(n,e,r){let h=e;h===void 0&&(h="UTC");const d=oe(n,wn),m=J_(xc(h,d),"iso8601",r,"never");let y="Z";return e!==void 0&&(y=lC(yd(h,d))),`${m}${y}`}function Cv(n,e){const r=oe(n,ns),h=oe(n,is),d=oe(n,Fs),m=oe(n,rs),y=oe(n,as),c=oe(n,os),E=lb(n);let C="";r!==0&&(C+=`${Math.abs(r)}Y`),h!==0&&(C+=`${Math.abs(h)}M`),d!==0&&(C+=`${Math.abs(d)}W`),m!==0&&(C+=`${Math.abs(m)}D`);let k="";y!==0&&(k+=`${Math.abs(y)}H`),c!==0&&(k+=`${Math.abs(c)}M`);const z=Xn.fromComponents(0,0,oe(n,ss),oe(n,ls),oe(n,cs),oe(n,Bs));z.isZero()&&!["second","millisecond","microsecond","nanosecond"].includes(dd(n))&&e==="auto"||(k+=`${Math.abs(z.sec)}${sC(Math.abs(z.subsec),e)}S`);let F=`${E<0?"-":""}P${C}`;return k&&(F=`${F}T${k}`),F}function sS(n,e="auto"){const{year:r,month:h,day:d}=oe(n,Tn);return`${w0(r)}-${Dl(h)}-${Dl(d)}${f0(oe(n,It),e)}`}function lS({hour:n,minute:e,second:r,millisecond:h,microsecond:d,nanosecond:m},y){return jb(n,e,r,1e6*h+1e3*d+m,y)}function J_(n,e,r,h="auto"){const{isoDate:{year:d,month:m,day:y},time:{hour:c,minute:E,second:C,millisecond:k,microsecond:z,nanosecond:F}}=n;return`${w0(d)}-${Dl(m)}-${Dl(y)}T${jb(c,E,C,1e6*k+1e3*z+F,r)}${f0(e,h)}`}function cS(n,e="auto"){const{year:r,month:h,day:d}=oe(n,Tn);let m=`${Dl(h)}-${Dl(d)}`;const y=oe(n,It);e!=="always"&&e!=="critical"&&y==="iso8601"||(m=`${w0(r)}-${m}`);const c=f0(y,e);return c&&(m+=c),m}function uS(n,e="auto"){const{year:r,month:h,day:d}=oe(n,Tn);let m=`${w0(r)}-${Dl(h)}`;const y=oe(n,It);e!=="always"&&e!=="critical"&&y==="iso8601"||(m+=`-${Dl(d)}`);const c=f0(y,e);return c&&(m+=c),m}function hS(n,e,r="auto",h="auto",d="auto",m=void 0){let y=oe(n,wn);if(m){const{unit:k,increment:z,roundingMode:F}=m;y=R1(y,z,k,F)}const c=oe(n,Ri),E=yd(c,y);let C=J_(xc(c,y),"iso8601",e,"never");return d!=="never"&&(C+=lC(E)),h!=="never"&&(C+=`[${h==="critical"?"!":""}${c}]`),C+=f0(oe(n,It),r),C}function dS(n){return qM.test(n)}function sy(n){const e=o4.exec(n);if(!e)throw new RangeError(`invalid time zone offset: ${n}; must match ±HH:MM[:SS.SSSSSSSSS]`);return(e[1]==="-"?-1:1)*(1e9*(60*(60*+e[2]+ +(e[3]||0))+ +(e[4]||0))+ +((e[5]||0)+"000000000").slice(0,9))}let g_;const r4=Object.assign(Object.create(null),{"/":!0,"-":!0,_:!0});function ob(n){if(g_===void 0){const m=Intl.supportedValuesOf?.("timeZone");if(m){g_=new Map;for(let y=0;y<m.length;y++){const c=m[y];g_.set(t0(c),c)}}else g_=null}const e=t0(n);let r=g_?.get(e);if(r)return{identifier:r,primaryIdentifier:r};try{r=ZM(n).resolvedOptions().timeZone}catch{return}if(e==="antarctica/south_pole"&&(r="Antarctica/McMurdo"),J5.has(n))throw new RangeError(`${n} is a legacy time zone identifier from ICU. Use ${r} instead`);const h=[...e].map((m,y)=>y===0||r4[e[y-1]]?m.toUpperCase():m).join("").split("/");if(h.length===1)return e==="gb-eire"?{identifier:"GB-Eire",primaryIdentifier:r}:{identifier:e.length<=3||/[-0-9]/.test(e)?e.toUpperCase():h[0],primaryIdentifier:r};if(h[0]==="Etc")return{identifier:`Etc/${["Zulu","Greenwich","Universal"].includes(h[1])?h[1]:h[1].toUpperCase()}`,primaryIdentifier:r};if(h[0]==="Us")return{identifier:`US/${h[1]}`,primaryIdentifier:r};const d=new Map([["Act","ACT"],["Lhi","LHI"],["Nsw","NSW"],["Dar_Es_Salaam","Dar_es_Salaam"],["Port_Of_Spain","Port_of_Spain"],["Port-Au-Prince","Port-au-Prince"],["Isle_Of_Man","Isle_of_Man"],["Comodrivadavia","ComodRivadavia"],["Knox_In","Knox_IN"],["Dumontdurville","DumontDUrville"],["Mcmurdo","McMurdo"],["Denoronha","DeNoronha"],["Easterisland","EasterIsland"],["Bajanorte","BajaNorte"],["Bajasur","BajaSur"]]);return h[1]=d.get(h[1])??h[1],h.length>2&&(h[2]=d.get(h[2])??h[2]),{identifier:h.join("/"),primaryIdentifier:r}}function em(n,e){const{year:r,month:h,day:d,hour:m,minute:y,second:c}=uC(n,e);let E=e%1e3;return E<0&&(E+=1e3),1e6*(kw({isoDate:{year:r,month:h,day:d},time:{hour:m,minute:y,second:c,millisecond:E}})-e)}function M1(n,e){return em(n,wc(e,"floor"))}function Rw(n){const e=n<0?"-":"+",r=Math.abs(n);return`${e}${jb(Math.floor(r/60),r%60,0,0,"minute")}`}function lC(n){return Rw(Rf(n,q5,"halfExpand")/6e10)}function kw({isoDate:{year:n,month:e,day:r},time:{hour:h,minute:d,second:m,millisecond:y}}){const c=n%400,E=(n-c)/400,C=new Date;return C.setUTCHours(h,d,m,y),C.setUTCFullYear(c,e-1,r),C.getTime()+Q5*E}function ho(n){const e=kw(n),r=1e3*n.time.microsecond+n.time.nanosecond;return J.add(ah(e),J.BigInt(r))}function cC(n){let e=wc(n,"trunc"),r=J.toNumber(J.remainder(n,h0));r<0&&(r+=1e6,e-=1);const h=Math.floor(r/1e3)%1e3,d=r%1e3,m=new Date(e);return{epochMilliseconds:e,isoDate:{year:m.getUTCFullYear(),month:m.getUTCMonth()+1,day:m.getUTCDate()},time:{hour:m.getUTCHours(),minute:m.getUTCMinutes(),second:m.getUTCSeconds(),millisecond:m.getUTCMilliseconds(),microsecond:h,nanosecond:d}}}function Ow(n,e){if(n==="UTC")return null;const r=wc(e,"floor");if(r<z_)return Ow(n,ah(z_));const h=Date.now(),d=Math.max(r,h)+366*jf*3;let m=r,y=em(n,m),c=m,E=y;for(;y===E&&m<d;){if(c=m+2*jf*7,c>$M)return null;E=em(n,c),y===E&&(m=c)}return y===E?null:ah(bC(C=>em(n,C),m,c,y,E))}function C1(n,e){if(n==="UTC")return null;const r=wc(e,"ceil"),h=Date.now(),d=h+366*jf*3;if(r>d){const C=C1(n,ah(d));if(C===null||J.lessThan(C,ah(h)))return C}if(n==="Africa/Casablanca"||n==="Africa/El_Aaiun"){const C=Date.UTC(2088,0,1);if(C<r)return C1(n,ah(C))}let m=r-1;if(m<z_)return null;let y=em(n,m),c=m,E=y;for(;y===E&&m>z_;){if(c=m-2*jf*7,c<z_)return null;E=em(n,c),y===E&&(m=c)}return y===E?null:ah(bC(C=>em(n,C),c,m,E,y))}function uC(n,e){return function(r){const h=r.split(/[^\w]+/);if(h.length!==7)throw new RangeError(`expected 7 parts in "${r}`);const d=+h[0],m=+h[1];let y=+h[2];const c=h[3];if(c[0]==="b"||c[0]==="B")y=1-y;else if(c[0]!=="a"&&c[0]!=="A")throw new RangeError(`Unknown era ${c} in "${r}`);const E=h[4]==="24"?0:+h[4],C=+h[5],k=+h[6];if(!(Number.isFinite(y)&&Number.isFinite(d)&&Number.isFinite(m)&&Number.isFinite(E)&&Number.isFinite(C)&&Number.isFinite(k)))throw new RangeError(`Invalid number in "${r}`);return{year:y,month:d,day:m,hour:E,minute:C,second:k}}(ZM(n).format(e))}function sb(n){return n!==void 0&&!(n%4!=0||n%100==0&&n%400!=0)}function tm(n,e){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[sb(n)?"leapyear":"standard"][e-1]}function lb(n){const e=[oe(n,ns),oe(n,is),oe(n,Fs),oe(n,rs),oe(n,as),oe(n,os),oe(n,ss),oe(n,ls),oe(n,cs),oe(n,Bs)];for(let r=0;r<e.length;r++){const h=e[r];if(h!==0)return h<0?-1:1}return 0}function Fb(n){const e=["years","months","weeks","days"];for(let r=0;r<e.length;r++){const h=n[e[r]];if(h!==0)return h<0?-1:1}return 0}function hC(n){const e=Fb(n.date);return e!==0?e:n.time.sign()}function Kp(n,e){let r=n,h=e;if(!Number.isFinite(r)||!Number.isFinite(h))throw new RangeError("infinity is out of range");return h-=1,r+=Math.floor(h/12),h%=12,h<0&&(h+=12),h+=1,{year:r,month:h}}function Ys(n,e,r){let h=n,d=e,m=r;if(!Number.isFinite(m))throw new RangeError("infinity is out of range");({year:h,month:d}=Kp(h,d));const y=146097;if(Math.abs(m)>y){const C=Math.trunc(m/y);h+=400*C,m-=C*y}let c=0,E=d>2?h:h-1;for(;c=sb(E)?366:365,m<-c;)h-=1,E-=1,m+=c;for(E+=1;c=sb(E)?366:365,m>c;)h+=1,E+=1,m-=c;for(;m<1;)({year:h,month:d}=Kp(h,d-1)),m+=tm(h,d);for(;m>tm(h,d);)m-=tm(h,d),{year:h,month:d}=Kp(h,d+1);return{year:h,month:d,day:m}}function e0(n,e,r,h,d,m,y,c,E){const C=Df(h,d,m,y,c,E);return yi(Ys(n,e,r+C.deltaDays),C)}function Df(n,e,r,h,d,m){let y,c=n,E=e,C=r,k=h,z=d,F=m;({div:y,mod:F}=Ag(F,3)),z+=y,F<0&&(z-=1,F+=1e3),{div:y,mod:z}=Ag(z,3),k+=y,z<0&&(k-=1,z+=1e3),C+=Math.trunc(k/1e3),k%=1e3,k<0&&(C-=1,k+=1e3),E+=Math.trunc(C/60),C%=60,C<0&&(E-=1,C+=60),c+=Math.trunc(E/60),E%=60,E<0&&(c-=1,E+=60);let B=Math.trunc(c/24);return c%=24,c<0&&(B-=1,c+=24),B+=0,c+=0,E+=0,C+=0,k+=0,z+=0,F+=0,{deltaDays:B,hour:c,minute:E,second:C,millisecond:k,microsecond:z,nanosecond:F}}function fS(n,e){const r=Oo(n,0);if(Fb(r)===0)return n.days;const h=oe(e,Tn),d=Cl(oe(e,It),h,r,"constrain"),m=um(h.year,h.month-1,h.day),y=um(d.year,d.month-1,d.day)-m;return n.days+y}function Hs(n){return new(fo("%Temporal.Duration%"))(-oe(n,ns),-oe(n,is),-oe(n,Fs),-oe(n,rs),-oe(n,as),-oe(n,os),-oe(n,ss),-oe(n,ls),-oe(n,cs),-oe(n,Bs))}function us(n,e,r){return Math.min(r,Math.max(e,n))}function dC(n,e,r){const h=us(e,1,12);return{year:n,month:h,day:us(r,1,tm(n,h))}}function Ba(n,e,r){if(n<e||n>r)throw new RangeError(`value out of range: ${e} <= ${n} <= ${r}`)}function lm(n,e,r){Ba(e,1,12),Ba(r,1,tm(n,e))}function _m(n){cm(yi(n,{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}))}function Bb(n,e,r,h,d,m){Ba(n,0,23),Ba(e,0,59),Ba(r,0,59),Ba(h,0,999),Ba(d,0,999),Ba(m,0,999)}function Pw(n,e,r,h,d,m,y,c,E){lm(n,e,r),Bb(h,d,m,y,c,E)}function cm(n){const e=ho(n);(J.lessThan(e,X5)||J.greaterThan(e,W5))&&hh(e)}function D1(n){ho(n)}function hh(n){if(J.lessThan(n,X_)||J.greaterThan(n,Vg))throw new RangeError("date/time value is outside of supported range")}function Lw({year:n,month:e}){Ba(n,JT,eS),n===JT?Ba(e,4,12):n===eS&&Ba(e,1,9)}function Ub(n,e,r,h,d,m,y,c,E,C){let k=0;const z=[n,e,r,h,d,m,y,c,E,C];for(let ue=0;ue<z.length;ue++){const Ae=z[ue];if(Ae===1/0||Ae===-1/0)throw new RangeError("infinite values not allowed as duration fields");if(Ae!==0){const Te=Ae<0?-1:1;if(k!==0&&Te!==k)throw new RangeError("mixed-sign values not allowed as duration fields");k=Te}}if(Math.abs(n)>=2**32||Math.abs(e)>=2**32||Math.abs(r)>=2**32)throw new RangeError("years, months, and weeks must be < 2³²");const F=Ag(c,3),B=Ag(E,6),Q=Ag(C,9),ie=Ag(1e6*F.mod+1e3*B.mod+Q.mod,9).div,ne=86400*h+3600*d+60*m+y+F.div+B.div+Q.div+ie;if(!Number.isSafeInteger(ne))throw new RangeError("total of duration time units cannot exceed 9007199254740991.999999999 s")}function Eg(n){return{date:{years:oe(n,ns),months:oe(n,is),weeks:oe(n,Fs),days:oe(n,rs)},time:Xn.fromComponents(oe(n,as),oe(n,os),oe(n,ss),oe(n,ls),oe(n,cs),oe(n,Bs))}}function rh(n){const e=Xn.fromComponents(oe(n,as),oe(n,os),oe(n,ss),oe(n,ls),oe(n,cs),oe(n,Bs)).add24HourDays(oe(n,rs));return{date:{years:oe(n,ns),months:oe(n,is),weeks:oe(n,Fs),days:0},time:e}}function fC(n){const e=rh(n),r=Math.trunc(e.time.sec/86400);return Ub(e.date.years,e.date.months,e.date.weeks,r,0,0,0,0,0,0),{...e.date,days:r}}function gc(n,e){const r=n.time.sign();let h=n.time.abs().subsec,d=0,m=0,y=n.time.abs().sec,c=0,E=0,C=0;switch(e){case"year":case"month":case"week":case"day":d=Math.trunc(h/1e3),h%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3,c=Math.trunc(y/60),y%=60,E=Math.trunc(c/60),c%=60,C=Math.trunc(E/24),E%=24;break;case"hour":d=Math.trunc(h/1e3),h%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3,c=Math.trunc(y/60),y%=60,E=Math.trunc(c/60),c%=60;break;case"minute":d=Math.trunc(h/1e3),h%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3,c=Math.trunc(y/60),y%=60;break;case"second":d=Math.trunc(h/1e3),h%=1e3,m=Math.trunc(d/1e3),d%=1e3,y+=Math.trunc(m/1e3),m%=1e3;break;case"millisecond":d=Math.trunc(h/1e3),h%=1e3,m=Fx(y,3,Math.trunc(d/1e3)),d%=1e3,y=0;break;case"microsecond":d=Fx(y,6,Math.trunc(h/1e3)),h%=1e3,y=0;break;case"nanosecond":h=Fx(y,9,h),y=0}return new(fo("%Temporal.Duration%"))(n.date.years,n.date.months,n.date.weeks,n.date.days+r*C,r*E,r*c,r*y,r*m,r*d,r*h)}function Sd(n,e){return Fb(n),e.sign(),{date:n,time:e}}function um(n,e,r){return kw({isoDate:{year:n,month:e+1,day:r},time:{hour:0,minute:0,second:0,millisecond:0}})/jf}function kg({year:n,month:e,day:r}){if(Math.abs(um(n,e-1,r))>1e8)throw new RangeError("date/time value is outside the supported range")}function zw(n,e){const r=e.hour-n.hour,h=e.minute-n.minute,d=e.second-n.second,m=e.millisecond-n.millisecond,y=e.microsecond-n.microsecond,c=e.nanosecond-n.nanosecond;return Xn.fromComponents(r,h,d,m,y,c)}function Nw(n,e,r,h,d){let m=Xn.fromEpochNsDiff(e,n);return m=cb(m,r,h,d),Sd({years:0,months:0,weeks:0,days:0},m)}function pC(n,e,r,h){D1(n),D1(e);let d=zw(n.time,e.time);const m=d.sign(),y=dh(n.isoDate,e.isoDate);let c=e.isoDate;y===m&&(c=Ys(c.year,c.month,c.day+m),d=d.add24HourDays(-m));const E=Td("day",h),C=v0(r,n.isoDate,c,E);return h!==E&&(d=d.add24HourDays(C.days),C.days=0),Sd(C,d)}function mC(n,e,r,h,d){const m=J.subtract(e,n);if(J.equal(m,Sl))return{date:{years:0,months:0,weeks:0,days:0},time:Xn.ZERO};const y=J.lessThan(m,Sl)?-1:1,c=xc(r,n),E=xc(r,e);let C,k=0,z=y===1?2:1,F=zw(c.time,E.time);for(F.sign()===-y&&k++;k<=z;k++){C=yi(Ys(E.isoDate.year,E.isoDate.month,E.isoDate.day-k*y),c.time);const Q=Po(r,C,"compatible");if(F=Xn.fromEpochNsDiff(e,Q),F.sign()!==-y)break}const B=Td("day",d);return Sd(v0(h,c.isoDate,C.isoDate,B),F)}function gC(n,e,r,h,d,m,y,c,E){let C,k,z,F,B=e;switch(c){case"year":{const Tt=Rf(B.date.years,y,"trunc");C=Tt,k=Tt+y*n,z={years:C,months:0,weeks:0,days:0},F={...z,years:k};break}case"month":{const Tt=Rf(B.date.months,y,"trunc");C=Tt,k=Tt+y*n,z=Oo(B.date,0,0,C),F=Oo(B.date,0,0,k);break}case"week":{const Tt=Oo(B.date,0,0),zt=Cl(m,h.isoDate,Tt,"constrain"),Zt=v0(m,zt,Ys(zt.year,zt.month,zt.day+B.date.days),"week"),Gt=Rf(B.date.weeks+Zt.weeks,y,"trunc");C=Gt,k=Gt+y*n,z=Oo(B.date,0,C),F=Oo(B.date,0,k);break}case"day":{const Tt=Rf(B.date.days,y,"trunc");C=Tt,k=Tt+y*n,z=Oo(B.date,C),F=Oo(B.date,k);break}}const Q=Cl(m,h.isoDate,z,"constrain"),ie=Cl(m,h.isoDate,F,"constrain");let ne,ue;const Ae=yi(Q,h.time),Te=yi(ie,h.time);d?(ne=Po(d,Ae,"compatible"),ue=Po(d,Te,"compatible")):(ne=ho(Ae),ue=ho(Te));const ke=Xn.fromEpochNsDiff(r,ne),be=Xn.fromEpochNsDiff(ue,ne),Me=kb(E,n<0?"negative":"positive"),Fe=ke.add(ke).abs().subtract(be.abs()).sign(),ot=Math.abs(C)/y%2==0,Ee=ke.isZero()?Math.abs(C):ke.cmp(be)?Ob(Math.abs(C),Math.abs(k),Fe,ot,Me):Math.abs(k),Je=new Xn(J.add(J.multiply(be.totalNs,J.BigInt(C)),J.multiply(ke.totalNs,J.BigInt(y*n)))).fdiv(be.totalNs),Et=Ee===Math.abs(k);return B={date:Et?F:z,time:Xn.ZERO},{nudgeResult:{duration:B,nudgedEpochNs:Et?ue:ne,didExpandCalendarUnit:Et},total:Je}}function Vb(n,e,r,h,d,m,y,c,E){let C=n;const k=Ju(c)||h&&c==="day",z=hC(C)<0?-1:1;let F;return k?{nudgeResult:F}=gC(z,C,e,r,h,d,y,c,E):F=h?function(B,Q,ie,ne,ue,Ae,Te,ke){let be=Q;const Me=Cl(ue,ie.isoDate,be.date,"constrain"),Fe=yi(Me,ie.time),ot=yi(Ys(Me.year,Me.month,Me.day+B),ie.time),Ee=Po(ne,Fe,"compatible"),Je=Po(ne,ot,"compatible"),Et=Xn.fromEpochNsDiff(Je,Ee);if(Et.sign()!==B)throw new RangeError("time zone returned inconsistent Instants");const Tt=J.BigInt($g[Te]*Ae);let zt=be.time.round(Tt,ke);const Zt=zt.subtract(Et),Gt=Zt.sign()!==-B;let Ue,st;return Gt?(Ue=B,zt=Zt.round(Tt,ke),st=zt.addToEpochNs(Je)):(Ue=0,st=zt.addToEpochNs(Ee)),{duration:Sd(Oo(be.date,be.date.days+Ue),zt),nudgedEpochNs:st,didExpandCalendarUnit:Gt}}(z,C,r,h,d,y,c,E):function(B,Q,ie,ne,ue,Ae){let Te=B;const ke=Te.time.add24HourDays(Te.date.days),be=ke.round(J.BigInt(ne*$g[ue]),Ae),Me=be.subtract(ke),{quotient:Fe}=ke.divmod(nb),{quotient:ot}=be.divmod(nb),Ee=Math.sign(ot-Fe)===ke.sign(),Je=Me.addToEpochNs(Q);let Et=0,Tt=be;return fd(ie)==="date"&&(Et=ot,Tt=be.add(Xn.fromComponents(24*-ot,0,0,0,0,0))),{duration:{date:Oo(Te.date,Et),time:Tt},nudgedEpochNs:Je,didExpandCalendarUnit:Ee}}(C,e,m,y,c,E),C=F.duration,F.didExpandCalendarUnit&&c!=="week"&&(C=function(B,Q,ie,ne,ue,Ae,Te,ke){let be=Q;if(ke===Te)return be;const Me=N_.indexOf(Te);for(let Fe=N_.indexOf(ke)-1;Fe>=Me;Fe--){const ot=N_[Fe];if(ot==="week"&&Te!=="week")continue;let Ee;switch(ot){case"year":Ee={years:be.date.years+B,months:0,weeks:0,days:0};break;case"month":{const Tt=be.date.months+B;Ee=Oo(be.date,0,0,Tt);break}case"week":{const Tt=be.date.weeks+B;Ee=Oo(be.date,0,Tt);break}}const Je=yi(Cl(Ae,ne.isoDate,Ee,"constrain"),ne.time);let Et;if(Et=ue?Po(ue,Je,"compatible"):ho(Je),eb(ie,Et)===-B)break;be={date:Ee,time:Xn.ZERO}}return be}(z,C,F.nudgedEpochNs,r,h,d,m,Td(c,"day"))),C}function pS(n,e,r,h,d,m){return Ju(m)||h&&m==="day"?gC(hC(n)<0?-1:1,n,e,r,h,d,1,m,"trunc").total:B_(n.time.add24HourDays(n.date.days),m)}function yC(n,e,r,h,d,m,y){if(Yg(n,e)==0)return{date:{years:0,months:0,weeks:0,days:0},time:Xn.ZERO};cm(n),cm(e);const c=pC(n,e,r,h);return m==="nanosecond"&&d===1?c:Vb(c,ho(e),n,null,r,h,d,m,y)}function _C(n,e,r,h,d,m,y,c){if(fd(d)==="time")return Nw(n,e,m,y,c);const E=mC(n,e,r,h,d);return y==="nanosecond"&&m===1?E:Vb(E,e,xc(r,n),r,h,d,m,y,c)}function ly(n,e,r,h,d,m){const y=Gg.reduce((B,Q)=>{const ie=Q[0],ne=Q[1],ue=Q[2];return r!=="datetime"&&ue!==r||h.includes(ne)||B.push(ne,ie),B},[]);let c=Vs(e,"largestUnit",r,"auto");if(h.includes(c))throw new RangeError(`largestUnit must be one of ${y.join(", ")}, not ${c}`);const E=ay(e);let C=du(e,"trunc");n==="since"&&(C=function(B){switch(B){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return B}}(C));const k=Vs(e,"smallestUnit",r,d);if(h.includes(k))throw new RangeError(`smallestUnit must be one of ${y.join(", ")}, not ${k}`);const z=Td(m,k);if(c==="auto"&&(c=z),Td(c,k)!==c)throw new RangeError(`largestUnit ${c} cannot be smaller than smallestUnit ${k}`);const F={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[k];return F!==void 0&&oy(E,F,!1),{largestUnit:c,roundingIncrement:E,roundingMode:C,smallestUnit:k}}function mS(n,e,r,h){const d=C_(r),m=ly(n,Jt(h),"time",[],"nanosecond","second");let y=gc(Nw(oe(e,wn),oe(d,wn),m.roundingIncrement,m.smallestUnit,m.roundingMode),m.largestUnit);return n==="since"&&(y=Hs(y)),y}function gS(n,e,r,h){const d=A_(r),m=oe(e,It),y=oe(d,It);if(!uh(m,y))throw new RangeError(`cannot compute difference between dates of ${m} and ${y} calendars`);const c=ly(n,Jt(h),"date",[],"day","day"),E=fo("%Temporal.Duration%"),C=oe(e,Tn),k=oe(d,Tn);if(dh(C,k)===0)return new E;let z={date:v0(m,C,k,c.largestUnit),time:Xn.ZERO};if(c.smallestUnit!=="day"||c.roundingIncrement!==1){const B=yi(C,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});z=Vb(z,ho(yi(k,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),B,null,m,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let F=gc(z,"day");return n==="since"&&(F=Hs(F)),F}function yS(n,e,r,h){const d=M_(r),m=oe(e,It),y=oe(d,It);if(!uh(m,y))throw new RangeError(`cannot compute difference between dates of ${m} and ${y} calendars`);const c=ly(n,Jt(h),"datetime",[],"nanosecond","day"),E=fo("%Temporal.Duration%"),C=oe(e,mr),k=oe(d,mr);if(Yg(C,k)===0)return new E;let z=gc(yC(C,k,m,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);return n==="since"&&(z=Hs(z)),z}function _S(n,e,r,h){const d=If(r),m=ly(n,Jt(h),"time",[],"nanosecond","hour");let y=zw(oe(e,jr),oe(d,jr));y=cb(y,m.roundingIncrement,m.smallestUnit,m.roundingMode);let c=gc(Sd({years:0,months:0,weeks:0,days:0},y),m.largestUnit);return n==="since"&&(c=Hs(c)),c}function vS(n,e,r,h){const d=D_(r),m=oe(e,It),y=oe(d,It);if(!uh(m,y))throw new RangeError(`cannot compute difference between months of ${m} and ${y} calendars`);const c=ly(n,Jt(h),"date",["week","day"],"month","year"),E=fo("%Temporal.Duration%");if(dh(oe(e,Tn),oe(d,Tn))==0)return new E;const C=fs(m,oe(e,Tn),"year-month");C.day=1;const k=Ff(m,C,"constrain"),z=fs(m,oe(d,Tn),"year-month");z.day=1;const F=Ff(m,z,"constrain");let B={date:Oo(v0(m,k,F,c.largestUnit),0,0),time:Xn.ZERO};if(c.smallestUnit!=="month"||c.roundingIncrement!==1){const ie=yi(k,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});B=Vb(B,ho(yi(F,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),ie,null,m,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let Q=gc(B,"day");return n==="since"&&(Q=Hs(Q)),Q}function bS(n,e,r,h){const d=I_(r),m=oe(e,It),y=oe(d,It);if(!uh(m,y))throw new RangeError(`cannot compute difference between dates of ${m} and ${y} calendars`);const c=ly(n,Jt(h),"datetime",[],"nanosecond","hour"),E=oe(e,wn),C=oe(d,wn),k=fo("%Temporal.Duration%");let z;if(fd(c.largestUnit)!=="date")z=gc(Nw(E,C,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);else{const F=oe(e,Ri);if(!aC(F,oe(d,Ri)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");if(J.equal(E,C))return new k;z=gc(_C(E,C,F,m,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),"hour")}return n==="since"&&(z=Hs(z)),z}function Zg({hour:n,minute:e,second:r,millisecond:h,microsecond:d,nanosecond:m},y){let c=r,E=m;return c+=y.sec,E+=y.subsec,Df(n,e,c,h,d,E)}function I1(n,e){const r=e.addToEpochNs(n);return hh(r),r}function R_(n,e,r,h,d="constrain"){if(Fb(h.date)===0)return I1(n,h.time);const m=xc(e,n);return I1(Po(e,yi(Cl(r,m.isoDate,h.date,d),m.time),"compatible"),h.time)}function xS(n,e,r){let h=_c(r);n==="subtract"&&(h=Hs(h));const d=Td(dd(e),dd(h));if(Ju(d))throw new RangeError("For years, months, or weeks arithmetic, use date arithmetic relative to a starting point");const m=rh(e),y=rh(h);return gc(Sd({years:0,months:0,weeks:0,days:0},m.time.add(y.time)),d)}function wS(n,e,r){let h=_c(r);n==="subtract"&&(h=Hs(h));const d=dd(h);if(fd(d)==="date")throw new RangeError(`Duration field ${d} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);const m=rh(h);return ih(I1(oe(e,wn),m.time))}function TS(n,e,r,h){const d=oe(e,It);let m=_c(r);n==="subtract"&&(m=Hs(m));const y=fC(m),c=fi(Jt(h));return hs(Cl(d,oe(e,Tn),y,c),d)}function SS(n,e,r,h){let d=_c(r);n==="subtract"&&(d=Hs(d));const m=fi(Jt(h)),y=oe(e,It),c=rh(d),E=oe(e,mr),C=Zg(E.time,c.time),k=Oo(c.date,C.deltaDays);return Ub(k.years,k.months,k.weeks,k.days,0,0,0,0,0,0),mc(yi(Cl(y,E.isoDate,k,m),C),y)}function ES(n,e,r){let h=_c(r);n==="subtract"&&(h=Hs(h));const d=rh(h),{hour:m,minute:y,second:c,millisecond:E,microsecond:C,nanosecond:k}=Zg(oe(e,jr),d.time);return gd(Nb(m,y,c,E,C,k,"reject"))}function AS(n,e,r,h){let d=_c(r);n==="subtract"&&(d=Hs(d));const m=fi(Jt(h)),y=lb(d),c=oe(e,It),E=fs(c,oe(e,Tn),"year-month");E.day=1;let C=Ff(c,E,"constrain");if(y<0){const z=Cl(c,C,{months:1},"constrain");C=Ys(z.year,z.month,z.day-1)}const k=fC(d);return _m(C),Rg(Q_(c,fs(c,Cl(c,C,k,m),"year-month"),m),c)}function MS(n,e,r,h){let d=_c(r);n==="subtract"&&(d=Hs(d));const m=fi(Jt(h)),y=oe(e,Ri),c=oe(e,It),E=Eg(d);return ko(R_(oe(e,wn),y,c,E,m),y,c)}function Rf(n,e,r){const h=Math.trunc(n/e),d=n%e,m=n<0?"negative":"positive",y=Math.abs(h),c=y+1,E=Us(Math.abs(2*d)-e),C=y%2==0,k=kb(r,m),z=d===0?y:Ob(y,c,E,C,k);return e*(m==="positive"?z:-z)}function R1(n,e,r,h){const d=$g[r]*e;return function(m,y,c){const E=ud(m),C=ud(y),k=J.divide(E,C),z=J.remainder(E,C),F=kb(c,"positive");let B,Q;J.lessThan(E,Sl)?(B=J.subtract(k,q_),Q=k):(B=k,Q=J.add(k,q_));const ie=eb(qp(J.multiply(z,Cw)),C)*(J.lessThan(E,Sl)?-1:1)+0,ne=J.equal(z,Sl)?k:Ob(B,Q,ie,CM(B),F);return J.multiply(ne,C)}(n,J.BigInt(d),h)}function k1(n,e,r,h){D1(n);const{year:d,month:m,day:y}=n.isoDate,c=O1(n.time,e,r,h);return yi(Ys(d,m,y+c.deltaDays),c)}function O1({hour:n,minute:e,second:r,millisecond:h,microsecond:d,nanosecond:m},y,c,E){let C;switch(c){case"day":case"hour":C=1e3*(1e3*(1e3*(60*(60*n+e)+r)+h)+d)+m;break;case"minute":C=1e3*(1e3*(1e3*(60*e+r)+h)+d)+m;break;case"second":C=1e3*(1e3*(1e3*r+h)+d)+m;break;case"millisecond":C=1e3*(1e3*h+d)+m;break;case"microsecond":C=1e3*d+m;break;case"nanosecond":C=m}const k=$g[c],z=Rf(C,k*y,E)/k;switch(c){case"day":return{deltaDays:z,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return Df(z,0,0,0,0,0);case"minute":return Df(n,z,0,0,0,0);case"second":return Df(n,e,z,0,0,0);case"millisecond":return Df(n,e,r,z,0,0);case"microsecond":return Df(n,e,r,h,z,0);case"nanosecond":return Df(n,e,r,h,d,z);default:throw new Error(`Invalid unit ${c}`)}}function cb(n,e,r,h){const d=$g[r];return n.round(J.BigInt(d*e),h)}function B_(n,e){const r=$g[e];return n.fdiv(J.BigInt(r))}function dh(n,e){return n.year!==e.year?Us(n.year-e.year):n.month!==e.month?Us(n.month-e.month):n.day!==e.day?Us(n.day-e.day):0}function P1(n,e){return n.hour!==e.hour?Us(n.hour-e.hour):n.minute!==e.minute?Us(n.minute-e.minute):n.second!==e.second?Us(n.second-e.second):n.millisecond!==e.millisecond?Us(n.millisecond-e.millisecond):n.microsecond!==e.microsecond?Us(n.microsecond-e.microsecond):n.nanosecond!==e.nanosecond?Us(n.nanosecond-e.nanosecond):0}function Yg(n,e){const r=dh(n.isoDate,e.isoDate);return r!==0?r:P1(n.time,e.time)}function vC(n){const e=ub(n);return globalThis.BigInt!==void 0?globalThis.BigInt(e.toString(10)):e}function wc(n,e){const r=ud(n),{quotient:h,remainder:d}=S_(r,h0);let m=J.toNumber(h);return e==="floor"&&J.toNumber(d)<0&&(m-=1),e==="ceil"&&J.toNumber(d)>0&&(m+=1),m}function ah(n){if(!Number.isInteger(n))throw new RangeError("epoch milliseconds must be an integer");return J.multiply(J.BigInt(n),h0)}function ub(n){let e=n;if(typeof n=="object"){const r=n[Symbol.toPrimitive];r&&typeof r=="function"&&(e=r.call(n,"number"))}if(typeof e=="number")throw new TypeError("cannot convert number to bigint");return typeof e=="bigint"?J.BigInt(e.toString(10)):J.BigInt(e)}const L1=(()=>{let n=J.BigInt(Date.now()%1e6);return()=>{const e=Date.now(),r=J.BigInt(e),h=J.add(ah(e),n);return n=J.remainder(r,h0),J.greaterThan(h,Vg)?Vg:J.lessThan(h,X_)?X_:h}})();function y_(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function Us(n){return n<0?-1:n>0?1:n}function Jt(n){if(n===void 0)return Object.create(null);if(Fr(n)&&n!==null)return n;throw new TypeError("Options parameter must be an object, not "+(n===null?"null":typeof n))}function hm(n,e){const r=Object.create(null);return r[n]=e,r}function Ed(n,e,r,h){let d=n[e];if(d!==void 0){if(d=Lb(d),!r.includes(d))throw new RangeError(`${e} must be one of ${r.join(", ")}, not ${d}`);return d}if(h===Rd)throw new RangeError(`${e} option is required`);return h}function gs(n){const e=t0(n);if(!K5.includes(t0(e)))throw new RangeError(`invalid calendar identifier ${e}`);switch(e){case"ethiopic-amete-alem":return"ethioaa";case"islamicc":return"islamic-civil"}return e}function t0(n){let e="";for(let r=0;r<n.length;r++){const h=n.charCodeAt(r);e+=h>=65&&h<=90?String.fromCharCode(h+32):String.fromCharCode(h)}return e}function $f(n){throw new TypeError(`Do not use built-in arithmetic operators with Temporal objects. When comparing, use ${n==="PlainMonthDay"?"Temporal.PlainDate.compare(obj1.toPlainDate(year), obj2.toPlainDate(year))":`Temporal.${n}.compare(obj1, obj2)`}, not obj1 > obj2. When coercing to strings, use \`\${obj}\` or String(obj), not '' + obj. When coercing to numbers, use properties or methods of the object, not \`+obj\`. When concatenating with strings, use \`\${str}\${obj}\` or str.concat(obj), not str + obj. In React, coerce to a string before rendering a Temporal object.`)}const a4=new RegExp(`^${VM.source}$`),o4=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/.source}$`);function bC(n,e,r,h=n(e),d=n(r)){let m=e,y=r,c=h,E=d;for(;y-m>1;){let C=Math.trunc((m+y)/2);const k=n(C);k===c?(m=C,c=k):k===E&&(y=C,E=k)}return y}function xC(n){return[...n]}function wC(n,e){if(n!=="gregory"&&n!=="iso8601")return;const r=T0[n];let h=e.year;const{dayOfWeek:d,dayOfYear:m,daysInYear:y}=r.isoToDate(e,{dayOfWeek:!0,dayOfYear:!0,daysInYear:!0}),c=r.getFirstDayOfWeek(),E=r.getMinimalDaysInFirstWeek();let C=(d+7-c)%7,k=(d-m+7001-c)%7,z=Math.floor((m-1+k)/7);if(7-k>=E&&++z,z==0)z=function(F,B,Q,ie){let ne=(ie-F-Q+1)%7;ne<0&&(ne+=7);let ue=Math.floor((Q+ne-1)/7);return 7-ne>=B&&++ue,ue}(c,E,m+r.isoToDate(r.dateAdd(e,{years:-1},"constrain"),{daysInYear:!0}).daysInYear,d),h--;else if(m>=y-5){let F=(C+y-m)%7;F<0&&(F+=7),6-F>=E&&m+7-C>y&&(z=1,h++)}return{week:z,year:h}}function CS(n,e,r,h,d){if(e!==d.year){if(n*(e-d.year)>0)return!0}else if(r!==d.month){if(n*(r-d.month)>0)return!0}else if(h!==d.day&&n*(h-d.day)>0)return!0;return!1}const T0={};function dm(n){if(!n.startsWith("M"))throw new RangeError(`Invalid month code: ${n}.  Month codes must start with M.`);const e=+n.slice(1);if(Number.isNaN(e))throw new RangeError(`Invalid month code: ${n}`);return e}function ch(n,e=!1){return`M${`${n}`.padStart(2,"0")}${e?"L":""}`}function jw(n,e=void 0,r=12){let{month:h,monthCode:d}=n;if(d===void 0){if(h===void 0)throw new TypeError("Either month or monthCode are required");e==="reject"&&Ba(h,1,r),e==="constrain"&&(h=us(h,1,r)),d=ch(h)}else{const m=dm(d);if(d!==ch(m))throw new RangeError(`Invalid month code: ${d}`);if(h!==void 0&&h!==m)throw new RangeError(`monthCode ${d} and month ${h} must match if both are present`);if(h=m,h<1||h>r)throw new RangeError(`Invalid monthCode: ${d}`)}return{...n,month:h,monthCode:d}}T0.iso8601={resolveFields(n,e){if((e==="date"||e==="year-month")&&n.year===void 0)throw new TypeError("year is required");if((e==="date"||e==="month-day")&&n.day===void 0)throw new TypeError("day is required");Object.assign(n,jw(n))},dateToISO:(n,e)=>j_(n.year,n.month,n.day,e),monthDayToISOReferenceDate(n,e){const{month:r,day:h}=j_(n.year??1972,n.month,n.day,e);return{month:r,day:h,year:1972}},extraFields:()=>[],fieldKeysToIgnore(n){const e=new Set;for(let r=0;r<n.length;r++){const h=n[r];e.add(h),h==="month"?e.add("monthCode"):h==="monthCode"&&e.add("month")}return xC(e)},dateAdd(n,{years:e=0,months:r=0,weeks:h=0,days:d=0},m){let{year:y,month:c,day:E}=n;return y+=e,c+=r,{year:y,month:c}=Kp(y,c),{year:y,month:c,day:E}=j_(y,c,E,m),E+=d+7*h,Ys(y,c,E)},dateUntil(n,e,r){const h=-dh(n,e);if(h===0)return{years:0,months:0,weeks:0,days:0};let d,m=0,y=0;if(r==="year"||r==="month"){let k=e.year-n.year;for(k!==0&&(k-=h);!CS(h,n.year+k,n.month,n.day,e);)m=k,k+=h;let z=h;for(d=Kp(n.year+m,n.month+z);!CS(h,d.year,d.month,n.day,e);)y=z,z+=h,d=Kp(d.year,d.month+h);r==="month"&&(y+=12*m,m=0)}d=Kp(n.year+m,n.month+y);const c=dC(d.year,d.month,n.day);let E=0,C=um(e.year,e.month-1,e.day)-um(c.year,c.month-1,c.day);return r==="week"&&(E=Math.trunc(C/7),C%=7),{years:m,months:y,weeks:E,days:C}},isoToDate({year:n,month:e,day:r},h){const d={era:void 0,eraYear:void 0,year:n,month:e,day:r,daysInWeek:7,monthsInYear:12};if(h.monthCode&&(d.monthCode=ch(e)),h.dayOfWeek){const m=e+(e<3?10:-2),y=n-(e<3?1:0),c=Math.floor(y/100),E=y-100*c,C=(r+Math.floor(2.6*m-.2)+(E+Math.floor(E/4))+(Math.floor(c/4)-2*c))%7;d.dayOfWeek=C+(C<=0?7:0)}if(h.dayOfYear){let m=r;for(let y=e-1;y>0;y--)m+=tm(n,y);d.dayOfYear=m}return h.weekOfYear&&(d.weekOfYear=wC("iso8601",{year:n,month:e,day:r})),h.daysInMonth&&(d.daysInMonth=tm(n,e)),(h.daysInYear||h.inLeapYear)&&(d.inLeapYear=sb(n),d.daysInYear=d.inLeapYear?366:365),d},getFirstDayOfWeek:()=>1,getMinimalDaysInFirstWeek:()=>4};class ja{constructor(e){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,e!==void 0){let r=0;for(const h of e.map.entries()){if(++r>ja.MAX_CACHE_ENTRIES)break;this.map.set(...h)}}}get(e){const r=this.map.get(e);return r&&(this.hits++,this.report()),this.calls++,r}set(e,r){this.map.set(e,r),this.misses++,this.report()}report(){}setObject(e){if(ja.objectMap.get(e))throw new RangeError("object already cached");ja.objectMap.set(e,this),this.report()}static getCacheForObject(e){let r=ja.objectMap.get(e);return r||(r=new ja,ja.objectMap.set(e,r)),r}}function TC({isoYear:n,isoMonth:e,isoDay:r}){return`${w0(n)}-${Dl(e)}-${Dl(r)}T00:00Z`}function Vx(n,e){return{years:n.year-e.year,months:n.month-e.month,days:n.day-e.day}}ja.objectMap=new WeakMap,ja.MAX_CACHE_ENTRIES=1e3;class vm{constructor(){this.eras=[],this.hasEra=!1,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new Intl.DateTimeFormat(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:"short",timeZone:"UTC"})),this.formatter}getCalendarParts(e){let r=this.getFormatter(),h=new Date(e);if(e==="-271821-04-19T00:00Z"){const d=r.resolvedOptions();r=new Intl.DateTimeFormat(d.locale,{...d,timeZone:"Etc/GMT+1"}),h=new Date("-271821-04-20T00:00Z")}try{return r.formatToParts(h)}catch{throw new RangeError(`Invalid ISO date: ${e}`)}}isoToCalendarDate(e,r){const{year:h,month:d,day:m}=e,y=JSON.stringify({func:"isoToCalendarDate",isoYear:h,isoMonth:d,isoDay:m,id:this.id}),c=r.get(y);if(c)return c;const E=TC({isoYear:h,isoMonth:d,isoDay:m}),C=this.getCalendarParts(E),k={};for(let F=0;F<C.length;F++){const{type:B,value:Q}=C[F];if(B!=="year"&&B!=="relatedYear"||(this.hasEra?k.eraYear=+Q:k.year=+Q),B==="month"){const ie=/^([0-9]*)(.*?)$/.exec(Q);if(!ie||ie.length!=3||!ie[1]&&!ie[2])throw new RangeError(`Unexpected month: ${Q}`);if(k.month=ie[1]?+ie[1]:1,k.month<1)throw new RangeError(`Invalid month ${Q} from ${E}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(k.month>13)throw new RangeError(`Invalid month ${Q} from ${E}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);ie[2]&&(k.monthExtra=ie[2])}B==="day"&&(k.day=+Q),this.hasEra&&B==="era"&&Q!=null&&Q!==""&&(k.era=Q.split(" (")[0].normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(/ /g,"-").toLowerCase())}if(this.hasEra&&k.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.hasEra){const F=this.eras.find(B=>k.era===B.genericName);F&&(k.era=F.code)}if(this.reviseIntlEra){const{era:F,eraYear:B}=this.reviseIntlEra(k,e);k.era=F,k.eraYear=B}this.checkIcuBugs&&this.checkIcuBugs(e);const z=this.adjustCalendarDate(k,r,"constrain",!0);if(z.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(e)}`);if(z.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(e)}`);if(z.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(e)}`);return r.set(y,z),["constrain","reject"].forEach(F=>{const B=JSON.stringify({func:"calendarToIsoDate",year:z.year,month:z.month,day:z.day,overflow:F,id:this.id});r.set(B,e)}),z}validateCalendarDate(e){const{month:r,year:h,day:d,eraYear:m,monthCode:y,monthExtra:c}=e;if(c!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(h===void 0&&m===void 0)throw new TypeError("year or eraYear is required");if(r===void 0&&y===void 0)throw new TypeError("month or monthCode is required");if(d===void 0)throw new RangeError("Missing day");if(y!==void 0){if(typeof y!="string")throw new RangeError("monthCode must be a string, not "+typeof y);if(!/^M([01]?\d)(L?)$/.test(y))throw new RangeError(`Invalid monthCode: ${y}`)}if(this.hasEra&&e.era===void 0!=(e.eraYear===void 0))throw new TypeError("properties era and eraYear must be provided together")}adjustCalendarDate(e,r=void 0,h="constrain",d=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let m=e;this.validateCalendarDate(m);const y=this.monthsInYear(m,r);let{month:c,monthCode:E}=m;return{month:c,monthCode:E}=jw(m,h,y),{...m,month:c,monthCode:E}}regulateMonthDayNaive(e,r,h){const d=this.monthsInYear(e,h);let{month:m,day:y}=e;return r==="reject"?(Ba(m,1,d),Ba(y,1,this.maximumMonthLength(e))):(m=us(m,1,d),y=us(y,1,this.maximumMonthLength({...e,month:m}))),{...e,month:m,day:y}}calendarToIsoDate(e,r="constrain",h){const d=e;let m=this.adjustCalendarDate(e,h,r,!1);m=this.regulateMonthDayNaive(m,r,h);const{year:y,month:c,day:E}=m,C=JSON.stringify({func:"calendarToIsoDate",year:y,month:c,day:E,overflow:r,id:this.id});let k,z=h.get(C);if(z||d.year!==void 0&&d.month!==void 0&&d.day!==void 0&&(d.year!==m.year||d.month!==m.month||d.day!==m.day)&&(k=JSON.stringify({func:"calendarToIsoDate",year:d.year,month:d.month,day:d.day,overflow:r,id:this.id}),z=h.get(k),z))return z;let F=this.estimateIsoDate({year:y,month:c,day:E});const B=Ae=>{let Te=this.addDaysIso(F,Ae);if(m.day>this.minimumMonthLength(m)){let ke=this.isoToCalendarDate(Te,h);for(;ke.month!==c||ke.year!==y;){if(r==="reject")throw new RangeError(`day ${E} does not exist in month ${c} of year ${y}`);Te=this.addDaysIso(Te,-1),ke=this.isoToCalendarDate(Te,h)}}return Te};let Q=0,ie=this.isoToCalendarDate(F,h),ne=Vx(m,ie);if(ne.years!==0||ne.months!==0||ne.days!==0){const Ae=365*ne.years+30*ne.months+ne.days;F=this.addDaysIso(F,Ae),ie=this.isoToCalendarDate(F,h),ne=Vx(m,ie),ne.years===0&&ne.months===0?F=B(ne.days):Q=this.compareCalendarDates(m,ie)}let ue=8;for(;Q;){F=this.addDaysIso(F,Q*ue);const Ae=ie;ie=this.isoToCalendarDate(F,h);const Te=Q;if(Q=this.compareCalendarDates(m,ie),Q){if(ne=Vx(m,ie),ne.years===0&&ne.months===0)F=B(ne.days),Q=0;else if(Te&&Q!==Te)if(ue>1)ue/=2;else{if(r==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...d})}`);this.compareCalendarDates(ie,Ae)>0&&(F=this.addDaysIso(F,-1)),Q=0}}}if(h.set(C,F),k&&h.set(k,F),m.year===void 0||m.month===void 0||m.day===void 0||m.monthCode===void 0||this.hasEra&&(m.era===void 0||m.eraYear===void 0))throw new RangeError("Unexpected missing property");return F}compareCalendarDates(e,r){return e.year!==r.year?Us(e.year-r.year):e.month!==r.month?Us(e.month-r.month):e.day!==r.day?Us(e.day-r.day):0}regulateDate(e,r="constrain",h){const d=this.calendarToIsoDate(e,r,h);return this.isoToCalendarDate(d,h)}addDaysIso(e,r){return Ys(e.year,e.month,e.day+r)}addDaysCalendar(e,r,h){const d=this.calendarToIsoDate(e,"constrain",h),m=this.addDaysIso(d,r);return this.isoToCalendarDate(m,h)}addMonthsCalendar(e,r,h,d){let m=e;const{day:y}=m;for(let c=0,E=Math.abs(r);c<E;c++){const{month:C}=m,k=m,z=r<0?-Math.max(y,this.daysInPreviousMonth(m,d)):this.daysInMonth(m,d),F=this.calendarToIsoDate(m,"constrain",d);let B=this.addDaysIso(F,z);if(m=this.isoToCalendarDate(B,d),r>0){const Q=this.monthsInYear(k,d);for(;m.month-1!=C%Q;)B=this.addDaysIso(B,-1),m=this.isoToCalendarDate(B,d)}m.day!==y&&(m=this.regulateDate({...m,day:y},"constrain",d))}if(h==="reject"&&m.day!==y)throw new RangeError(`Day ${y} does not exist in resulting calendar month`);return m}addCalendar(e,{years:r=0,months:h=0,weeks:d=0,days:m=0},y,c){const{year:E,day:C,monthCode:k}=e,z=this.adjustCalendarDate({year:E+r,monthCode:k,day:C},c),F=this.addMonthsCalendar(z,h,y,c),B=m+7*d;return this.addDaysCalendar(F,B,c)}untilCalendar(e,r,h,d){let m=0,y=0,c=0,E=0;switch(h){case"day":m=this.calendarDaysUntil(e,r,d);break;case"week":{const C=this.calendarDaysUntil(e,r,d);m=C%7,y=(C-m)/7;break}case"month":case"year":{const C=this.compareCalendarDates(r,e);if(!C)return{years:0,months:0,weeks:0,days:0};const k=r.year-e.year,z=r.day-e.day;if(h==="year"&&k){let Q=0;r.monthCode>e.monthCode&&(Q=1),r.monthCode<e.monthCode&&(Q=-1),Q||(Q=Math.sign(z)),E=Q*C<0?k-C:k}let F,B=E?this.addCalendar(e,{years:E},"constrain",d):e;do c+=C,F=B,B=this.addMonthsCalendar(F,C,"constrain",d),B.day!==e.day&&(B=this.regulateDate({...B,day:e.day},"constrain",d));while(this.compareCalendarDates(r,B)*C>=0);c-=C,m=this.calendarDaysUntil(F,r,d);break}}return{years:E,months:c,weeks:y,days:m}}daysInMonth(e,r){const{day:h}=e,d=this.maximumMonthLength(e),m=this.minimumMonthLength(e);if(m===d)return m;const y=h<=d-m?d:m,c=this.calendarToIsoDate(e,"constrain",r),E=this.addDaysIso(c,y),C=this.isoToCalendarDate(E,r),k=this.addDaysIso(E,-C.day);return this.isoToCalendarDate(k,r).day}daysInPreviousMonth(e,r){const{day:h,month:d,year:m}=e;let y={year:d>1?m:m-1,month:d,day:1};const c=d>1?d-1:this.monthsInYear(y,r);y={...y,month:c};const E=this.minimumMonthLength(y),C=this.maximumMonthLength(y);if(E===C)return C;const k=this.calendarToIsoDate(e,"constrain",r),z=this.addDaysIso(k,-h);return this.isoToCalendarDate(z,r).day}startOfCalendarYear(e){return{year:e.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(e){return{year:e.year,month:e.month,day:1}}calendarDaysUntil(e,r,h){const d=this.calendarToIsoDate(e,"constrain",h),m=this.calendarToIsoDate(r,"constrain",h);return um(m.year,m.month-1,m.day)-um(d.year,d.month-1,d.day)}monthDaySearchStartYear(e,r){return 1972}monthDayFromFields(e,r,h){let d,m,y,c,E,{era:C,eraYear:k,year:z,month:F,monthCode:B,day:Q}=e;if(F!==void 0&&z===void 0&&(!this.hasEra||C===void 0||k===void 0))throw new TypeError("when month is present, year (or era and eraYear) are required");(B===void 0||z!==void 0||this.hasEra&&k!==void 0)&&({monthCode:B,day:Q}=this.isoToCalendarDate(this.calendarToIsoDate(e,r,h),h));const ie={year:this.monthDaySearchStartYear(B,Q),month:12,day:31},ne=this.isoToCalendarDate(ie,h),ue=ne.monthCode>B||ne.monthCode===B&&ne.day>=Q?ne.year:ne.year-1;for(let Ae=0;Ae<20;Ae++){const Te=this.adjustCalendarDate({day:Q,monthCode:B,year:ue-Ae},h),ke=this.calendarToIsoDate(Te,"constrain",h),be=this.isoToCalendarDate(ke,h);if({year:d,month:m,day:y}=ke,be.monthCode===B&&be.day===Q)return{month:m,day:y,year:d};if(r==="constrain"){const Me=this.maxLengthOfMonthCodeInAnyYear(be.monthCode);if(be.monthCode===B&&be.day===Me&&Q>Me)return{month:m,day:y,year:d};(c===void 0||be.monthCode===c.monthCode&&be.day>c.day)&&(c=be,E=ke)}}if(r==="constrain"&&E!==void 0)return E;throw new RangeError(`No recent ${this.id} year with monthCode ${B} and day ${Q}`)}getFirstDayOfWeek(){}getMinimalDaysInFirstWeek(){}}class s4 extends vm{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}}}inLeapYear(e){const{year:r}=e;return(7*r+1)%19<7}monthsInYear(e){return this.inLeapYear(e)?13:12}minimumMonthLength(e){return this.minMaxMonthLength(e,"min")}maximumMonthLength(e){return this.minMaxMonthLength(e,"max")}minMaxMonthLength(e,r){const{month:h,year:d}=e,m=this.getMonthCode(d,h),y=Object.entries(this.months).find(E=>E[1].monthCode===m);if(y===void 0)throw new RangeError(`unmatched Hebrew month: ${h}`);const c=y[1].days;return typeof c=="number"?c:c[r]}maxLengthOfMonthCodeInAnyYear(e){return["M04","M06","M08","M10","M12"].includes(e)?29:30}estimateIsoDate(e){const{year:r}=e;return{year:r-3760,month:1,day:1}}getMonthCode(e,r){return this.inLeapYear({year:e})?r===6?ch(5,!0):ch(r<6?r:r-1):ch(r)}adjustCalendarDate(e,r,h="constrain",d=!1){let{year:m,month:y,monthCode:c,day:E,monthExtra:C}=e;if(m===void 0)throw new TypeError("Missing property: year");if(d){if(C){const k=this.months[C];if(!k)throw new RangeError(`Unrecognized month from formatToParts: ${C}`);y=this.inLeapYear({year:m})?k.leap:k.regular}return c=this.getMonthCode(m,y),{year:m,month:y,day:E,monthCode:c}}if(this.validateCalendarDate(e),y===void 0)if(c.endsWith("L")){if(c!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${c}`);if(y=6,!this.inLeapYear({year:m})){if(h==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${m} which is not a leap year`);y=6,c="M06"}}else{y=dm(c),this.inLeapYear({year:m})&&y>=6&&y++;const k=this.monthsInYear({year:m});if(y<1||y>k)throw new RangeError(`Invalid monthCode: ${c}`)}else if(h==="reject"?(Ba(y,1,this.monthsInYear({year:m})),Ba(E,1,this.maximumMonthLength({year:m,month:y}))):(y=us(y,1,this.monthsInYear({year:m})),E=us(E,1,this.maximumMonthLength({year:m,month:y}))),c===void 0)c=this.getMonthCode(m,y);else if(this.getMonthCode(m,y)!==c)throw new RangeError(`monthCode ${c} doesn't correspond to month ${y} in Hebrew year ${m}`);return{...e,day:E,month:y,monthCode:c,year:m}}}class cy extends vm{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425}inLeapYear(e,r){const h={year:e.year,month:1,monthCode:"M01",day:1},d={year:e.year+1,month:1,monthCode:"M01",day:1};return this.calendarDaysUntil(h,d,r)===355}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(){return 30}estimateIsoDate(e){const{year:r}=this.adjustCalendarDate(e);return{year:Math.floor(r*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class l4 extends cy{constructor(){super(...arguments),this.id="islamic"}}class c4 extends cy{constructor(){super(...arguments),this.id="islamic-umalqura"}}class u4 extends cy{constructor(){super(...arguments),this.id="islamic-tbla"}}class h4 extends cy{constructor(){super(...arguments),this.id="islamic-civil"}}class d4 extends cy{constructor(){super(...arguments),this.id="islamic-rgsa"}}class f4 extends cy{constructor(){super(...arguments),this.id="islamicc"}}class p4 extends vm{constructor(){super(...arguments),this.id="persian",this.calendarType="solar"}inLeapYear(e,r){return this.daysInMonth({year:e.year,month:12,day:1},r)===30}monthsInYear(){return 12}minimumMonthLength(e){const{month:r}=e;return r===12?29:r<=6?31:30}maximumMonthLength(e){const{month:r}=e;return r===12?30:r<=6?31:30}maxLengthOfMonthCodeInAnyYear(e){return dm(e)<=6?31:30}estimateIsoDate(e){const{year:r}=this.adjustCalendarDate(e);return{year:r+621,month:1,day:1}}}class m4 extends vm{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(e){return Fw(e.year+78)}monthsInYear(){return 12}minimumMonthLength(e){return this.getMonthInfo(e).length}maximumMonthLength(e){return this.getMonthInfo(e).length}maxLengthOfMonthCodeInAnyYear(e){const r=dm(e);let h=this.months[r];return h=h.leap??h,h.length}getMonthInfo(e){const{month:r}=e;let h=this.months[r];if(h===void 0)throw new RangeError(`Invalid month: ${r}`);return this.inLeapYear(e)&&h.leap&&(h=h.leap),h}estimateIsoDate(e){const r=this.adjustCalendarDate(e),h=this.getMonthInfo(r);return Ys(r.year+78+(h.nextYear?1:0),h.month,h.day+r.day-1)}checkIcuBugs(e){if(this.vulnerableToBceBug&&e.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function Fw(n){return n%4==0&&(n%100!=0||n%400==0)}class SC extends vm{constructor(e,r){super(),this.calendarType="solar",this.id=e,this.isoEpoch=r}inLeapYear(e){const{year:r}=this.estimateIsoDate({month:1,day:1,year:e.year});return Fw(r)}monthsInYear(){return 12}minimumMonthLength(e){const{month:r}=e;return r===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(r)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}maxLengthOfMonthCodeInAnyYear(e){return[31,29,31,30,31,30,31,31,30,31,30,31][dm(e)-1]}estimateIsoDate(e){const r=this.adjustCalendarDate(e);return j_(r.year+this.isoEpoch.year,r.month+this.isoEpoch.month,r.day+this.isoEpoch.day,"constrain")}}class EC extends vm{constructor(e,r){super(),this.hasEra=!0,this.calendarType="solar",this.id=e;const{eras:h,anchorEra:d}=function(m){let y,c=m;if(c.length===0)throw new RangeError("Invalid era data: eras are required");if(c.length===1&&c[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(c.length===1&&!c[0].code)throw new RangeError("Invalid era data: at least one named era is required");if(c.filter(C=>C.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");c.forEach(C=>{if(C.isAnchor||!C.anchorEpoch&&!C.reverseOf){if(y)throw new RangeError("Invalid era data: cannot have multiple anchor eras");y=C,C.anchorEpoch={year:C.hasYearZero?0:1}}else if(!C.code)throw new RangeError("If era name is blank, it must be the anchor era")}),c=c.filter(C=>C.code),c.forEach(C=>{const{reverseOf:k}=C;if(k){const z=c.find(F=>F.code===k);if(z===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${k}`);C.reverseOf=z,C.anchorEpoch=z.anchorEpoch,C.isoEpoch=z.isoEpoch}C.anchorEpoch.month===void 0&&(C.anchorEpoch.month=1),C.anchorEpoch.day===void 0&&(C.anchorEpoch.day=1)}),c.sort((C,k)=>{if(C.reverseOf)return 1;if(k.reverseOf)return-1;if(!C.isoEpoch||!k.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return k.isoEpoch.year-C.isoEpoch.year});const E=c[c.length-1].reverseOf;if(E&&E!==c[c.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return c.forEach((C,k)=>{C.genericName="era"+(c.length-1-k)}),{eras:c,anchorEra:y||c[0]}}(r);this.anchorEra=d,this.eras=h}inLeapYear(e){const{year:r}=this.estimateIsoDate({month:1,day:1,year:e.year});return Fw(r)}monthsInYear(){return 12}minimumMonthLength(e){const{month:r}=e;return r===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(r)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}maxLengthOfMonthCodeInAnyYear(e){return[31,29,31,30,31,30,31,31,30,31,30,31][dm(e)-1]}completeEraYear(e){const r=(c,E,C)=>{const k=e[c];if(k!=null&&k!=E&&!(C||[]).includes(k)){const z=C?.[0];throw new RangeError(`Input ${c} ${k} doesn't match calculated value ${z?`${E} (also called ${z})`:E}`)}},h=c=>{let E;const C={...e,year:c},k=this.eras.find((z,F)=>{if(F===this.eras.length-1){if(z.reverseOf){if(c>0)throw new RangeError(`Signed year ${c} is invalid for era ${z.code}`);return E=z.anchorEpoch.year-c,!0}return E=c-z.anchorEpoch.year+(z.hasYearZero?0:1),!0}return this.compareCalendarDates(C,z.anchorEpoch)>=0&&(E=c-z.anchorEpoch.year+(z.hasYearZero?0:1),!0)});if(!k)throw new RangeError(`Year ${c} was not matched by any era`);return{eraYear:E,era:k.code,eraNames:k.names}};let{year:d,eraYear:m,era:y}=e;if(d!=null){const c=h(d);({eraYear:m,era:y}=c),r("era",y,c?.eraNames),r("eraYear",m)}else{if(m==null)throw new RangeError("Either year or eraYear and era are required");{if(y===void 0)throw new RangeError("era and eraYear must be provided together");const c=this.eras.find(({code:E,names:C=[]})=>E===y||C.includes(y));if(!c)throw new RangeError(`Era ${y} (ISO year ${m}) was not matched by any era`);d=c.reverseOf?c.anchorEpoch.year-m:m+c.anchorEpoch.year-(c.hasYearZero?0:1),r("year",d),{eraYear:m,era:y}=h(d)}}return{...e,year:d,eraYear:m,era:y}}adjustCalendarDate(e,r,h="constrain"){let d=e;const{month:m,monthCode:y}=d;return m===void 0&&(d={...d,month:dm(y)}),this.validateCalendarDate(d),d=this.completeEraYear(d),super.adjustCalendarDate(d,r,h)}estimateIsoDate(e){const r=this.adjustCalendarDate(e),{year:h,month:d,day:m}=r,{anchorEra:y}=this;return j_(h+y.isoEpoch.year-(y.hasYearZero?0:1),d,m,"constrain")}}class Bw extends EC{constructor(e,r){super(e,r)}isoToCalendarDate(e){const{year:r,month:h,day:d}=e,m=ch(h),y=r-this.anchorEra.isoEpoch.year+1;return this.completeEraYear({year:y,month:h,monthCode:m,day:d})}}const th={inLeapYear(n){const{year:e}=n;return(e+1)%4==0},monthsInYear:()=>13,minimumMonthLength(n){const{month:e}=n;return e===13?this.inLeapYear(n)?6:5:30},maximumMonthLength(n){return this.minimumMonthLength(n)},maxLengthOfMonthCodeInAnyYear:n=>n==="M13"?6:30};class g4 extends SC{constructor(e,r){super(e,r),this.inLeapYear=th.inLeapYear,this.monthsInYear=th.monthsInYear,this.minimumMonthLength=th.minimumMonthLength,this.maximumMonthLength=th.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=th.maxLengthOfMonthCodeInAnyYear}}class AC extends EC{constructor(e,r){super(e,r),this.inLeapYear=th.inLeapYear,this.monthsInYear=th.monthsInYear,this.minimumMonthLength=th.minimumMonthLength,this.maximumMonthLength=th.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=th.maxLengthOfMonthCodeInAnyYear}}class y4 extends g4{constructor(){super("ethioaa",{year:-5492,month:7,day:17})}}class _4 extends AC{constructor(){super("coptic",[{code:"coptic",isoEpoch:{year:284,month:8,day:29}},{code:"coptic-inverse",reverseOf:"coptic"}])}}class v4 extends AC{constructor(){super("ethiopic",[{code:"ethioaa",names:["ethiopic-amete-alem","mundi"],isoEpoch:{year:-5492,month:7,day:17}},{code:"ethiopic",names:["incar"],isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class b4 extends Bw{constructor(){super("roc",[{code:"roc",names:["minguo"],isoEpoch:{year:1912,month:1,day:1}},{code:"roc-inverse",names:["before-roc"],reverseOf:"roc"}])}}class x4 extends SC{constructor(){super("buddhist",{year:-543,month:1,day:1})}}class w4 extends Bw{constructor(){super("gregory",[{code:"gregory",names:["ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"gregory-inverse",names:["be","bce"],reverseOf:"gregory"}])}reviseIntlEra(e){let{era:r,eraYear:h}=e;return r==="b"&&(r="gregory-inverse"),r==="a"&&(r="gregory"),{era:r,eraYear:h}}getFirstDayOfWeek(){return 1}getMinimalDaysInFirstWeek(){return 1}}class T4 extends Bw{constructor(){super("japanese",[{code:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{code:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{code:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{code:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{code:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{code:"japanese",names:["japanese","gregory","ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"japanese-inverse",names:["japanese-inverse","gregory-inverse","bc","bce"],reverseOf:"japanese"}]),this.erasBeginMidYear=!0}reviseIntlEra(e,r){const{era:h,eraYear:d}=e,{year:m}=r;return this.eras.find(y=>y.code===h)?{era:h,eraYear:d}:m<1?{era:"japanese-inverse",eraYear:1-m}:{era:"japanese",eraYear:m}}}class MC extends vm{constructor(){super(...arguments),this.calendarType="lunisolar"}inLeapYear(e,r){const h=this.getMonthList(e.year,r);return Object.entries(h).length===13}monthsInYear(e,r){return this.inLeapYear(e,r)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(e){return["M01L","M09L","M10L","M11L","M12L"].includes(e)?29:30}monthDaySearchStartYear(e,r){const h={M01L:[1651,1651],M02L:[1947,1765],M03L:[1966,1955],M04L:[1963,1944],M05L:[1971,1952],M06L:[1960,1941],M07L:[1968,1938],M08L:[1957,1718],M09L:[1832,1832],M10L:[1870,1870],M11L:[1814,1814],M12L:[1890,1890]}[e]??[1972,1972];return r<30?h[0]:h[1]}getMonthList(e,r){if(e===void 0)throw new TypeError("Missing year");const h=JSON.stringify({func:"getMonthList",calendarYear:e,id:this.id}),d=r.get(h);if(d)return d;const m=this.getFormatter(),y=(ne,ue)=>{const Ae=TC({isoYear:ne,isoMonth:2,isoDay:1}),Te=new Date(Ae);Te.setUTCDate(ue+1);const ke=m.formatToParts(Te),be=ke.find(Ee=>Ee.type==="month").value,Me=+ke.find(Ee=>Ee.type==="day").value,Fe=ke.find(Ee=>Ee.type==="relatedYear");let ot;if(Fe===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return ot=+Fe.value,{calendarMonthString:be,calendarDay:Me,calendarYearToVerify:ot}};let c=17,{calendarMonthString:E,calendarDay:C,calendarYearToVerify:k}=y(e,c);E!=="1"&&(c+=29,{calendarMonthString:E,calendarDay:C}=y(e,c)),c-=C-5;const z={};let F,B,Q=1,ie=!1;do({calendarMonthString:E,calendarDay:C,calendarYearToVerify:k}=y(e,c)),F&&(z[B].daysInMonth=F+30-C),k!==e?ie=!0:(z[E]={monthIndex:Q++},c+=30),F=C,B=E;while(!ie);return z[B].daysInMonth=F+30-C,r.set(h,z),z}estimateIsoDate(e){const{year:r,month:h}=e;return{year:r,month:h>=12?12:h+1,day:1}}adjustCalendarDate(e,r,h="constrain",d=!1){let{year:m,month:y,monthExtra:c,day:E,monthCode:C}=e;if(m===void 0)throw new TypeError("Missing property: year");if(d){if(c&&c!=="bis")throw new RangeError(`Unexpected leap month suffix: ${c}`);const k=ch(y,c!==void 0),z=`${y}${c||""}`,F=this.getMonthList(m,r)[z];if(F===void 0)throw new RangeError(`Unmatched month ${z} in Chinese year ${m}`);return y=F.monthIndex,{year:m,month:y,day:E,monthCode:k}}if(this.validateCalendarDate(e),y===void 0){const k=this.getMonthList(m,r);let z=C.replace(/^M|L$/g,B=>B==="L"?"bis":"");z[0]==="0"&&(z=z.slice(1));let F=k[z];if(y=F&&F.monthIndex,y===void 0&&C.endsWith("L")&&C!="M13L"&&h==="constrain"){const B=+C.replace(/^M0?|L$/g,"");F=k[B],F&&(y=F.monthIndex,C=ch(B))}if(y===void 0)throw new RangeError(`Unmatched month ${C} in Chinese year ${m}`)}else if(C===void 0){const k=this.getMonthList(m,r),z=Object.entries(k),F=z.length;h==="reject"?(Ba(y,1,F),Ba(E,1,this.maximumMonthLength())):(y=us(y,1,F),E=us(E,1,this.maximumMonthLength()));const B=z.find(Q=>Q[1].monthIndex===y);if(B===void 0)throw new RangeError(`Invalid month ${y} in Chinese year ${m}`);C=ch(+B[0].replace("bis",""),B[0].indexOf("bis")!==-1)}else{const k=this.getMonthList(m,r);let z=C.replace(/^M|L$/g,B=>B==="L"?"bis":"");z[0]==="0"&&(z=z.slice(1));const F=k[z];if(!F)throw new RangeError(`Unmatched monthCode ${C} in Chinese year ${m}`);if(y!==F.monthIndex)throw new RangeError(`monthCode ${C} doesn't correspond to month ${y} in Chinese year ${m}`)}return{...e,year:m,month:y,monthCode:C,day:E}}}class S4 extends MC{constructor(){super(...arguments),this.id="chinese"}}class E4 extends MC{constructor(){super(...arguments),this.id="dangi"}}class A4{constructor(e){this.helper=e}extraFields(e){return this.helper.hasEra&&e.includes("year")?["era","eraYear"]:[]}resolveFields(e){if(this.helper.calendarType!=="lunisolar"){const r=new ja;jw(e,void 0,this.helper.monthsInYear({year:e.year??1972},r))}}dateToISO(e,r){const h=new ja,d=this.helper.calendarToIsoDate(e,r,h);return h.setObject(d),d}monthDayToISOReferenceDate(e,r){const h=new ja,d=this.helper.monthDayFromFields(e,r,h);return h.setObject(d),d}fieldKeysToIgnore(e){const r=new Set;for(let h=0;h<e.length;h++){const d=e[h];switch(r.add(d),d){case"era":r.add("eraYear"),r.add("year");break;case"eraYear":r.add("era"),r.add("year");break;case"year":r.add("era"),r.add("eraYear");break;case"month":r.add("monthCode"),this.helper.erasBeginMidYear&&(r.add("era"),r.add("eraYear"));break;case"monthCode":r.add("month"),this.helper.erasBeginMidYear&&(r.add("era"),r.add("eraYear"));break;case"day":this.helper.erasBeginMidYear&&(r.add("era"),r.add("eraYear"))}}return xC(r)}dateAdd(e,{years:r,months:h,weeks:d,days:m},y){const c=ja.getCacheForObject(e),E=this.helper.isoToCalendarDate(e,c),C=this.helper.addCalendar(E,{years:r,months:h,weeks:d,days:m},y,c),k=this.helper.calendarToIsoDate(C,"constrain",c);return ja.getCacheForObject(k)||new ja(c).setObject(k),k}dateUntil(e,r,h){const d=ja.getCacheForObject(e),m=ja.getCacheForObject(r),y=this.helper.isoToCalendarDate(e,d),c=this.helper.isoToCalendarDate(r,m);return this.helper.untilCalendar(y,c,h,d)}isoToDate(e,r){const h=ja.getCacheForObject(e),d=this.helper.isoToCalendarDate(e,h);if(r.dayOfWeek&&(d.dayOfWeek=T0.iso8601.isoToDate(e,{dayOfWeek:!0}).dayOfWeek),r.dayOfYear){const m=this.helper.startOfCalendarYear(d),y=this.helper.calendarDaysUntil(m,d,h);d.dayOfYear=y+1}if(r.weekOfYear&&(d.weekOfYear=wC(this.helper.id,e)),d.daysInWeek=7,r.daysInMonth&&(d.daysInMonth=this.helper.daysInMonth(d,h)),r.daysInYear){const m=this.helper.startOfCalendarYear(d),y=this.helper.addCalendar(m,{years:1},"constrain",h);d.daysInYear=this.helper.calendarDaysUntil(m,y,h)}return r.monthsInYear&&(d.monthsInYear=this.helper.monthsInYear(d,h)),r.inLeapYear&&(d.inLeapYear=this.helper.inLeapYear(d,h)),d}getFirstDayOfWeek(){return this.helper.getFirstDayOfWeek()}getMinimalDaysInFirstWeek(){return this.helper.getMinimalDaysInFirstWeek()}}for(const n of[s4,p4,v4,y4,_4,S4,E4,b4,m4,x4,w4,T4,l4,c4,u4,h4,d4,f4]){const e=new n;T0[e.id]=new A4(e)}x1("calendarImpl",function(n){return T0[n]});const n0=Intl.DateTimeFormat;function xg(n,e){let r=oe(n,e);return typeof r=="function"&&(r=new n0(oe(n,jM),r(oe(n,y1))),function(h,d,m){const y=Rb(h);if(y===void 0)throw new TypeError("Missing slots for the given container");if(y[d]===void 0)throw new TypeError(`tried to reset ${d} which was not set`);y[d]=m}(n,e,r)),r}function __(n){return ms(n,ym)}class i0{constructor(e=void 0,r=void 0){(function(h,d,m){const y=m!==void 0;let c;if(y){const z=["localeMatcher","calendar","numberingSystem","hour12","hourCycle","timeZone","weekday","era","year","month","day","dayPeriod","hour","minute","second","fractionalSecondDigits","timeZoneName","formatMatcher","dateStyle","timeStyle"];c=function(B){if(B==null)throw new TypeError(`Expected object not ${B}`);return Object(B)}(m);const F=Object.create(null);for(let B=0;B<z.length;B++){const Q=z[B];Object.prototype.hasOwnProperty.call(c,Q)&&(F[Q]=c[Q])}c=F}else c=Object.create(null);const E=new n0(d,c),C=E.resolvedOptions();if(Ld(h),y){const z=Object.assign(Object.create(null),C);for(const F in z)Object.prototype.hasOwnProperty.call(c,F)||delete z[F];z.hour12=c.hour12,z.hourCycle=c.hourCycle,Gn(h,y1,z)}else Gn(h,y1,c);Gn(h,jM,C.locale),Gn(h,ym,E),Gn(h,Sg,C.timeZone),Gn(h,E_,C.calendar),Gn(h,kM,L4),Gn(h,OM,O4),Gn(h,PM,P4),Gn(h,LM,k4),Gn(h,zM,z4),Gn(h,NM,N4);const k=y?c.timeZone:void 0;if(k===void 0)Gn(h,g1,C.timeZone);else{const z=Lb(k);if(z.startsWith("−"))throw new RangeError("Unicode minus (U+2212) is not supported in time zone offsets");Gn(h,g1,ds(z))}})(this,e,r)}get format(){it(this,__);const e=C4.bind(this);return Object.defineProperties(e,{length:{value:1,enumerable:!1,writable:!1,configurable:!0},name:{value:"",enumerable:!1,writable:!1,configurable:!0}}),e}formatRange(e,r){return it(this,__),I4.call(this,e,r)}formatToParts(e,...r){return it(this,__),D4.call(this,e,...r)}formatRangeToParts(e,r){return it(this,__),R4.call(this,e,r)}resolvedOptions(){return it(this,__),M4.call(this)}}"formatToParts"in n0.prototype||delete i0.prototype.formatToParts,"formatRangeToParts"in n0.prototype||delete i0.prototype.formatRangeToParts;const yc=function(n=void 0,e=void 0){return new i0(n,e)};function M4(){const n=oe(this,ym).resolvedOptions();return n.timeZone=oe(this,g1),n}function C4(n,...e){let r,h,d=Hg(n,this);return d.formatter?(r=d.formatter,h=[wc(d.epochNs,"floor")]):(r=oe(this,ym),h=[n,...e]),r.format(...h)}function D4(n,...e){let r,h,d=Hg(n,this);return d.formatter?(r=d.formatter,h=[wc(d.epochNs,"floor")]):(r=oe(this,ym),h=[n,...e]),r.formatToParts(...h)}function I4(n,e){if(n===void 0||e===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const r=hb(n),h=hb(e);let d,m=[r,h];if(Ad(r)!==Ad(h))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");if(Ad(r)){if(!CC(r,h))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{epochNs:y,formatter:c}=Hg(r,this),{epochNs:E,formatter:C}=Hg(h,this);c&&(d=c,m=[wc(y,"floor"),wc(E,"floor")])}return d||(d=oe(this,ym)),d.formatRange(...m)}function R4(n,e){if(n===void 0||e===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const r=hb(n),h=hb(e);let d,m=[r,h];if(Ad(r)!==Ad(h))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");if(Ad(r)){if(!CC(r,h))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{epochNs:y,formatter:c}=Hg(r,this),{epochNs:E,formatter:C}=Hg(h,this);c&&(d=c,m=[wc(y,"floor"),wc(E,"floor")])}return d||(d=oe(this,ym)),d.formatRangeToParts(...m)}function S0(n={},e={}){const r=Object.assign({},n),h=["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"];for(let d=0;d<h.length;d++){const m=h[d];r[m]=m in e?e[m]:r[m],r[m]!==!1&&r[m]!==void 0||delete r[m]}return r}function k4(n){const e=S0(n,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});if(e.timeStyle!=="long"&&e.timeStyle!=="full"||(delete e.timeStyle,Object.assign(e,{hour:"numeric",minute:"2-digit",second:"2-digit"})),!$b(e)){if(E0(n))throw new TypeError(`cannot format Temporal.PlainTime with options [${Object.keys(n)}]`);Object.assign(e,{hour:"numeric",minute:"numeric",second:"numeric"})}return e}function O4(n){const e={short:{year:"2-digit",month:"numeric"},medium:{year:"numeric",month:"short"},long:{year:"numeric",month:"long"},full:{year:"numeric",month:"long"}},r=S0(n,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in r&&r.dateStyle){const h=r.dateStyle;delete r.dateStyle,Object.assign(r,e[h])}if(!("year"in r||"month"in r||"era"in r)){if(E0(n))throw new TypeError(`cannot format PlainYearMonth with options [${Object.keys(n)}]`);Object.assign(r,{year:"numeric",month:"numeric"})}return r}function P4(n){const e={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric"},long:{month:"long",day:"numeric"},full:{month:"long",day:"numeric"}},r=S0(n,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in r&&r.dateStyle){const h=r.dateStyle;delete r.dateStyle,Object.assign(r,e[h])}if(!("month"in r)&&!("day"in r)){if(E0(n))throw new TypeError(`cannot format PlainMonthDay with options [${Object.keys(n)}]`);Object.assign(r,{month:"numeric",day:"numeric"})}return r}function L4(n){const e=S0(n,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if(!Gb(e)){if(E0(n))throw new TypeError(`cannot format PlainDate with options [${Object.keys(n)}]`);Object.assign(e,{year:"numeric",month:"numeric",day:"numeric"})}return e}function z4(n){const e=S0(n,{timeZoneName:!1});if((e.timeStyle==="long"||e.timeStyle==="full")&&(delete e.timeStyle,Object.assign(e,{hour:"numeric",minute:"2-digit",second:"2-digit"}),e.dateStyle)&&(Object.assign(e,{short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"long",day:"numeric"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long"}}[e.dateStyle]),delete e.dateStyle),!$b(e)&&!Gb(e)){if(E0(n))throw new TypeError(`cannot format PlainDateTime with options [${Object.keys(n)}]`);Object.assign(e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}return e}function N4(n){let e=n;return $b(e)||Gb(e)||(e=Object.assign({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function Gb(n){return"year"in n||"month"in n||"day"in n||"weekday"in n||"dateStyle"in n||"era"in n}function $b(n){return"hour"in n||"minute"in n||"second"in n||"timeStyle"in n||"dayPeriod"in n||"fractionalSecondDigits"in n}function E0(n){return Gb(n)||$b(n)||"dateStyle"in n||"timeStyle"in n||"timeZoneName"in n}function Ad(n){return Nr(n)||Qr(n)||sr(n)||qn(n)||co(n)||Tl(n)||lo(n)}function hb(n){return Ad(n)?n:Pb(n)}function CC(n,e){return!(!Ad(n)||!Ad(e)||Qr(n)&&!Qr(e)||Nr(n)&&!Nr(e)||sr(n)&&!sr(e)||qn(n)&&!qn(e)||co(n)&&!co(e)||Tl(n)&&!Tl(e)||lo(n)&&!lo(e))}function Hg(n,e){if(Qr(n)){const r={isoDate:{year:1970,month:1,day:1},time:oe(n,jr)};return{epochNs:Po(oe(e,Sg),r,"compatible"),formatter:xg(e,LM)}}if(co(n)){const r=oe(n,It),h=oe(e,E_);if(r!==h)throw new RangeError(`cannot format PlainYearMonth with calendar ${r} in locale with calendar ${h}`);const d=yi(oe(n,Tn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:Po(oe(e,Sg),d,"compatible"),formatter:xg(e,OM)}}if(Tl(n)){const r=oe(n,It),h=oe(e,E_);if(r!==h)throw new RangeError(`cannot format PlainMonthDay with calendar ${r} in locale with calendar ${h}`);const d=yi(oe(n,Tn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:Po(oe(e,Sg),d,"compatible"),formatter:xg(e,PM)}}if(Nr(n)){const r=oe(n,It),h=oe(e,E_);if(r!=="iso8601"&&r!==h)throw new RangeError(`cannot format PlainDate with calendar ${r} in locale with calendar ${h}`);const d=yi(oe(n,Tn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:Po(oe(e,Sg),d,"compatible"),formatter:xg(e,kM)}}if(sr(n)){const r=oe(n,It),h=oe(e,E_);if(r!=="iso8601"&&r!==h)throw new RangeError(`cannot format PlainDateTime with calendar ${r} in locale with calendar ${h}`);const d=oe(n,mr);return{epochNs:Po(oe(e,Sg),d,"compatible"),formatter:xg(e,zM)}}if(qn(n))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return lo(n)?{epochNs:oe(n,wn),formatter:xg(e,NM)}:{}}function DC(n){const e=Object.create(null);return e.years=oe(n,ns),e.months=oe(n,is),e.weeks=oe(n,Fs),e.days=oe(n,rs),e.hours=oe(n,as),e.minutes=oe(n,os),e.seconds=oe(n,ss),e.milliseconds=oe(n,ls),e.microseconds=oe(n,cs),e.nanoseconds=oe(n,Bs),e}i0.prototype.constructor=yc,Object.defineProperty(yc,"prototype",{value:i0.prototype,writable:!1,enumerable:!1,configurable:!1}),yc.supportedLocalesOf=n0.supportedLocalesOf,zd(yc,"Intl.DateTimeFormat");const{format:j4,formatToParts:F4}=Intl.DurationFormat?.prototype??Object.create(null);function IC(n){Intl.DurationFormat.prototype.resolvedOptions.call(this);const e=DC(_c(n));return j4.call(this,e)}Intl.DurationFormat?.prototype&&(Intl.DurationFormat.prototype.format=IC,Intl.DurationFormat.prototype.formatToParts=function(n){Intl.DurationFormat.prototype.resolvedOptions.call(this);const e=DC(_c(n));return F4.call(this,e)});class Uw{constructor(e){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");iC(this,ub(e))}get epochMilliseconds(){return it(this,lo),wc(oe(this,wn),"floor")}get epochNanoseconds(){return it(this,lo),vC(J.BigInt(oe(this,wn)))}add(e){return it(this,lo),wS("add",this,e)}subtract(e){return it(this,lo),wS("subtract",this,e)}until(e,r=void 0){return it(this,lo),mS("until",this,e,r)}since(e,r=void 0){return it(this,lo),mS("since",this,e,r)}round(e){if(it(this,lo),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?hm("smallestUnit",e):Jt(e),h=ay(r),d=du(r,"halfExpand"),m=Vs(r,"smallestUnit","time",Rd);return oy(h,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[m],!0),ih(R1(oe(this,wn),h,m,d))}equals(e){it(this,lo);const r=C_(e),h=oe(this,wn),d=oe(r,wn);return J.equal(J.BigInt(h),J.BigInt(d))}toString(e=void 0){it(this,lo);const r=Jt(e),h=m0(r),d=du(r,"trunc"),m=Vs(r,"smallestUnit","time",void 0);if(m==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let y=r.timeZone;y!==void 0&&(y=ds(y));const{precision:c,unit:E,increment:C}=g0(m,h);return oS(ih(R1(oe(this,wn),C,E,d)),y,c)}toJSON(){return it(this,lo),oS(this,void 0,"auto")}toLocaleString(e=void 0,r=void 0){return it(this,lo),new yc(e,r).format(this)}valueOf(){$f("Instant")}toZonedDateTimeISO(e){it(this,lo);const r=ds(e);return ko(oe(this,wn),r,"iso8601")}static fromEpochMilliseconds(e){return ih(ah(Pb(e)))}static fromEpochNanoseconds(e){return ih(ub(e))}static from(e){return C_(e)}static compare(e,r){const h=C_(e),d=C_(r),m=oe(h,wn),y=oe(d,wn);return J.lessThan(m,y)?-1:J.greaterThan(m,y)?1:0}}zd(Uw,"Temporal.Instant");class Vw{constructor(e,r,h,d="iso8601"){const m=Mn(e),y=Mn(r),c=Mn(h),E=gs(d===void 0?"iso8601":Sa(d));lm(m,y,c),KM(this,{year:m,month:y,day:c},E)}get calendarId(){return it(this,Nr),oe(this,It)}get era(){return Jo(this,"era")}get eraYear(){return Jo(this,"eraYear")}get year(){return Jo(this,"year")}get month(){return Jo(this,"month")}get monthCode(){return Jo(this,"monthCode")}get day(){return Jo(this,"day")}get dayOfWeek(){return Jo(this,"dayOfWeek")}get dayOfYear(){return Jo(this,"dayOfYear")}get weekOfYear(){return Jo(this,"weekOfYear")?.week}get yearOfWeek(){return Jo(this,"weekOfYear")?.year}get daysInWeek(){return Jo(this,"daysInWeek")}get daysInMonth(){return Jo(this,"daysInMonth")}get daysInYear(){return Jo(this,"daysInYear")}get monthsInYear(){return Jo(this,"monthsInYear")}get inLeapYear(){return Jo(this,"inLeapYear")}with(e,r=void 0){if(it(this,Nr),!Fr(e))throw new TypeError("invalid argument");ry(e);const h=oe(this,It);let d=fs(h,oe(this,Tn));return d=sm(h,d,Rl(h,e,["year","month","monthCode","day"],[],"partial")),hs(Ff(h,d,fi(Jt(r))),h)}withCalendar(e){it(this,Nr);const r=b0(e);return hs(oe(this,Tn),r)}add(e,r=void 0){return it(this,Nr),TS("add",this,e,r)}subtract(e,r=void 0){return it(this,Nr),TS("subtract",this,e,r)}until(e,r=void 0){return it(this,Nr),gS("until",this,e,r)}since(e,r=void 0){return it(this,Nr),gS("since",this,e,r)}equals(e){it(this,Nr);const r=A_(e);return dh(oe(this,Tn),oe(r,Tn))===0&&uh(oe(this,It),oe(r,It))}toString(e=void 0){return it(this,Nr),sS(this,p0(Jt(e)))}toJSON(){return it(this,Nr),sS(this)}toLocaleString(e=void 0,r=void 0){return it(this,Nr),new yc(e,r).format(this)}valueOf(){$f("PlainDate")}toPlainDateTime(e=void 0){it(this,Nr);const r=QM(e);return mc(yi(oe(this,Tn),r),oe(this,It))}toZonedDateTime(e){let r,h;if(it(this,Nr),Fr(e)){const y=e.timeZone;y===void 0?r=ds(e):(r=ds(y),h=e.plainTime)}else r=ds(e);const d=oe(this,Tn);let m;return h===void 0?m=Cf(r,d):(h=If(h),m=Po(r,yi(d,oe(h,jr)),"compatible")),ko(m,r,oe(this,It))}toPlainYearMonth(){it(this,Nr);const e=oe(this,It);return Rg(Q_(e,fs(e,oe(this,Tn)),"constrain"),e)}toPlainMonthDay(){it(this,Nr);const e=oe(this,It);return Mg(ab(e,fs(e,oe(this,Tn)),"constrain"),e)}static from(e,r=void 0){return A_(e,r)}static compare(e,r){const h=A_(e),d=A_(r);return dh(oe(h,Tn),oe(d,Tn))}}function Jo(n,e){it(n,Nr);const r=oe(n,Tn);return y0(n).isoToDate(r,{[e]:!0})[e]}zd(Vw,"Temporal.PlainDate");class Gw{constructor(e,r,h,d=0,m=0,y=0,c=0,E=0,C=0,k="iso8601"){const z=Mn(e),F=Mn(r),B=Mn(h),Q=d===void 0?0:Mn(d),ie=m===void 0?0:Mn(m),ne=y===void 0?0:Mn(y),ue=c===void 0?0:Mn(c),Ae=E===void 0?0:Mn(E),Te=C===void 0?0:Mn(C),ke=gs(k===void 0?"iso8601":Sa(k));Pw(z,F,B,Q,ie,ne,ue,Ae,Te),JM(this,{isoDate:{year:z,month:F,day:B},time:{hour:Q,minute:ie,second:ne,millisecond:ue,microsecond:Ae,nanosecond:Te}},ke)}get calendarId(){return it(this,sr),oe(this,It)}get year(){return es(this,"year")}get month(){return es(this,"month")}get monthCode(){return es(this,"monthCode")}get day(){return es(this,"day")}get hour(){return wg(this,"hour")}get minute(){return wg(this,"minute")}get second(){return wg(this,"second")}get millisecond(){return wg(this,"millisecond")}get microsecond(){return wg(this,"microsecond")}get nanosecond(){return wg(this,"nanosecond")}get era(){return es(this,"era")}get eraYear(){return es(this,"eraYear")}get dayOfWeek(){return es(this,"dayOfWeek")}get dayOfYear(){return es(this,"dayOfYear")}get weekOfYear(){return es(this,"weekOfYear")?.week}get yearOfWeek(){return es(this,"weekOfYear")?.year}get daysInWeek(){return es(this,"daysInWeek")}get daysInYear(){return es(this,"daysInYear")}get daysInMonth(){return es(this,"daysInMonth")}get monthsInYear(){return es(this,"monthsInYear")}get inLeapYear(){return es(this,"inLeapYear")}with(e,r=void 0){if(it(this,sr),!Fr(e))throw new TypeError("invalid argument");ry(e);const h=oe(this,It),d=oe(this,mr);let m={...fs(h,d.isoDate),...d.time};return m=sm(h,m,Rl(h,e,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],"partial")),mc(_0(h,m,fi(Jt(r))),h)}withPlainTime(e=void 0){it(this,sr);const r=QM(e);return mc(yi(oe(this,mr).isoDate,r),oe(this,It))}withCalendar(e){it(this,sr);const r=b0(e);return mc(oe(this,mr),r)}add(e,r=void 0){return it(this,sr),SS("add",this,e,r)}subtract(e,r=void 0){return it(this,sr),SS("subtract",this,e,r)}until(e,r=void 0){return it(this,sr),yS("until",this,e,r)}since(e,r=void 0){return it(this,sr),yS("since",this,e,r)}round(e){if(it(this,sr),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?hm("smallestUnit",e):Jt(e),h=ay(r),d=du(r,"halfExpand"),m=Vs(r,"smallestUnit","time",Rd,["day"]),y={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[m];oy(h,y,y===1);const c=oe(this,mr);return mc(h===1&&m==="nanosecond"?c:k1(c,h,m,d),oe(this,It))}equals(e){it(this,sr);const r=M_(e);return Yg(oe(this,mr),oe(r,mr))===0&&uh(oe(this,It),oe(r,It))}toString(e=void 0){it(this,sr);const r=Jt(e),h=p0(r),d=m0(r),m=du(r,"trunc"),y=Vs(r,"smallestUnit","time",void 0);if(y==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:c,unit:E,increment:C}=g0(y,d),k=k1(oe(this,mr),C,E,m);return cm(k),J_(k,oe(this,It),c,h)}toJSON(){return it(this,sr),J_(oe(this,mr),oe(this,It),"auto")}toLocaleString(e=void 0,r=void 0){return it(this,sr),new yc(e,r).format(this)}valueOf(){$f("PlainDateTime")}toZonedDateTime(e,r=void 0){it(this,sr);const h=ds(e),d=F_(Jt(r));return ko(Po(h,oe(this,mr),d),h,oe(this,It))}toPlainDate(){return it(this,sr),hs(oe(this,mr).isoDate,oe(this,It))}toPlainTime(){return it(this,sr),gd(oe(this,mr).time)}static from(e,r=void 0){return M_(e,r)}static compare(e,r){const h=M_(e),d=M_(r);return Yg(oe(h,mr),oe(d,mr))}}function es(n,e){it(n,sr);const r=oe(n,mr).isoDate;return y0(n).isoToDate(r,{[e]:!0})[e]}function wg(n,e){return it(n,sr),oe(n,mr).time[e]}zd(Gw,"Temporal.PlainDateTime");class qg{constructor(e=0,r=0,h=0,d=0,m=0,y=0,c=0,E=0,C=0,k=0){const z=e===void 0?0:su(e),F=r===void 0?0:su(r),B=h===void 0?0:su(h),Q=d===void 0?0:su(d),ie=m===void 0?0:su(m),ne=y===void 0?0:su(y),ue=c===void 0?0:su(c),Ae=E===void 0?0:su(E),Te=C===void 0?0:su(C),ke=k===void 0?0:su(k);Ub(z,F,B,Q,ie,ne,ue,Ae,Te,ke),Ld(this),Gn(this,ns,z),Gn(this,is,F),Gn(this,Fs,B),Gn(this,rs,Q),Gn(this,as,ie),Gn(this,os,ne),Gn(this,ss,ue),Gn(this,ls,Ae),Gn(this,cs,Te),Gn(this,Bs,ke)}get years(){return it(this,zr),oe(this,ns)}get months(){return it(this,zr),oe(this,is)}get weeks(){return it(this,zr),oe(this,Fs)}get days(){return it(this,zr),oe(this,rs)}get hours(){return it(this,zr),oe(this,as)}get minutes(){return it(this,zr),oe(this,os)}get seconds(){return it(this,zr),oe(this,ss)}get milliseconds(){return it(this,zr),oe(this,ls)}get microseconds(){return it(this,zr),oe(this,cs)}get nanoseconds(){return it(this,zr),oe(this,Bs)}get sign(){return it(this,zr),lb(this)}get blank(){return it(this,zr),lb(this)===0}with(e){it(this,zr);const r=WM(e),{years:h=oe(this,ns),months:d=oe(this,is),weeks:m=oe(this,Fs),days:y=oe(this,rs),hours:c=oe(this,as),minutes:E=oe(this,os),seconds:C=oe(this,ss),milliseconds:k=oe(this,ls),microseconds:z=oe(this,cs),nanoseconds:F=oe(this,Bs)}=r;return new qg(h,d,m,y,c,E,C,k,z,F)}negated(){return it(this,zr),Hs(this)}abs(){return it(this,zr),new qg(Math.abs(oe(this,ns)),Math.abs(oe(this,is)),Math.abs(oe(this,Fs)),Math.abs(oe(this,rs)),Math.abs(oe(this,as)),Math.abs(oe(this,os)),Math.abs(oe(this,ss)),Math.abs(oe(this,ls)),Math.abs(oe(this,cs)),Math.abs(oe(this,Bs)))}add(e){return it(this,zr),xS("add",this,e)}subtract(e){return it(this,zr),xS("subtract",this,e)}round(e){if(it(this,zr),e===void 0)throw new TypeError("options parameter is required");const r=dd(this),h=typeof e=="string"?hm("smallestUnit",e):Jt(e);let d=Vs(h,"largestUnit","datetime",void 0,["auto"]),{plainRelativeTo:m,zonedRelativeTo:y}=Ux(h);const c=ay(h),E=du(h,"halfExpand");let C=Vs(h,"smallestUnit","datetime",void 0),k=!0;C||(k=!1,C="nanosecond");const z=Td(r,C);let F=!0;if(d||(F=!1,d=z),d==="auto"&&(d=z),!k&&!F)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(Td(d,C)!==d)throw new RangeError(`largestUnit ${d} cannot be smaller than smallestUnit ${C}`);const B={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[C];if(B!==void 0&&oy(c,B,!1),c>1&&fd(C)==="date"&&d!==C)throw new RangeError("For calendar units with roundingIncrement > 1, use largestUnit = smallestUnit");if(y){let ie=Eg(this);const ne=oe(y,Ri),ue=oe(y,It),Ae=oe(y,wn);return ie=_C(Ae,R_(Ae,ne,ue,ie),ne,ue,d,c,C,E),fd(d)==="date"&&(d="hour"),gc(ie,d)}if(m){let ie=rh(this);const ne=Zg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},ie.time),ue=oe(m,Tn),Ae=oe(m,It),Te=Cl(Ae,ue,Oo(ie.date,ne.deltaDays),"constrain");return ie=yC(yi(ue,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),yi(Te,ne),Ae,d,c,C,E),gc(ie,d)}if(Ju(r))throw new RangeError(`a starting point is required for ${r}s balancing`);if(Ju(d))throw new RangeError(`a starting point is required for ${d}s balancing`);let Q=rh(this);if(C==="day"){const{quotient:ie,remainder:ne}=Q.time.divmod(nb);let ue=Q.date.days+ie+B_(ne,"day");ue=Rf(ue,c,E),Q=Sd({years:0,months:0,weeks:0,days:ue},Xn.ZERO)}else Q=Sd({years:0,months:0,weeks:0,days:0},cb(Q.time,c,C,E));return gc(Q,d)}total(e){if(it(this,zr),e===void 0)throw new TypeError("options argument is required");const r=typeof e=="string"?hm("unit",e):Jt(e);let{plainRelativeTo:h,zonedRelativeTo:d}=Ux(r);const m=Vs(r,"unit","datetime",Rd);if(d){const c=Eg(this),E=oe(d,Ri),C=oe(d,It),k=oe(d,wn);return function(z,F,B,Q,ie){return fd(ie)==="time"?B_(Xn.fromEpochNsDiff(F,z),ie):pS(mC(z,F,B,Q,ie),F,xc(B,z),B,Q,ie)}(k,R_(k,E,C,c),E,C,m)}if(h){const c=rh(this);let E=Zg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},c.time);const C=oe(h,Tn),k=oe(h,It),z=Cl(k,C,Oo(c.date,E.deltaDays),"constrain");return function(F,B,Q,ie){if(Yg(F,B)==0)return 0;cm(F),cm(B);const ne=pC(F,B,Q,ie);return ie==="nanosecond"?J.toNumber(ne.time.totalNs):pS(ne,ho(B),F,null,Q,ie)}(yi(C,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),yi(z,E),k,m)}const y=dd(this);if(Ju(y))throw new RangeError(`a starting point is required for ${y}s total`);if(Ju(m))throw new RangeError(`a starting point is required for ${m}s total`);return B_(rh(this).time,m)}toString(e=void 0){it(this,zr);const r=Jt(e),h=m0(r),d=du(r,"trunc"),m=Vs(r,"smallestUnit","time",void 0);if(m==="hour"||m==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:y,unit:c,increment:E}=g0(m,h);if(c==="nanosecond"&&E===1)return Cv(this,y);const C=dd(this);let k=Eg(this);const z=cb(k.time,E,c,d);return k=Sd(k.date,z),Cv(gc(k,Td(C,"second")),y)}toJSON(){return it(this,zr),Cv(this,"auto")}toLocaleString(e=void 0,r=void 0){if(it(this,zr),typeof Intl.DurationFormat=="function"){const h=new Intl.DurationFormat(e,r);return IC.call(h,this)}return console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),Cv(this,"auto")}valueOf(){$f("Duration")}static from(e){return _c(e)}static compare(e,r,h=void 0){const d=_c(e),m=_c(r),y=Jt(h),{plainRelativeTo:c,zonedRelativeTo:E}=Ux(y);if(oe(d,ns)===oe(m,ns)&&oe(d,is)===oe(m,is)&&oe(d,Fs)===oe(m,Fs)&&oe(d,rs)===oe(m,rs)&&oe(d,as)===oe(m,as)&&oe(d,os)===oe(m,os)&&oe(d,ss)===oe(m,ss)&&oe(d,ls)===oe(m,ls)&&oe(d,cs)===oe(m,cs)&&oe(d,Bs)===oe(m,Bs))return 0;const C=dd(d),k=dd(m),z=Eg(d),F=Eg(m);if(E&&(fd(C)==="date"||fd(k)==="date")){const ue=oe(E,Ri),Ae=oe(E,It),Te=oe(E,wn),ke=R_(Te,ue,Ae,z),be=R_(Te,ue,Ae,F);return Us(J.toNumber(J.subtract(ke,be)))}let B=z.date.days,Q=F.date.days;if(Ju(C)||Ju(k)){if(!c)throw new RangeError("A starting point is required for years, months, or weeks comparison");B=fS(z.date,c),Q=fS(F.date,c)}const ie=z.time.add24HourDays(B),ne=F.time.add24HourDays(Q);return ie.cmp(ne)}}zd(qg,"Temporal.Duration");class $w{constructor(e,r,h="iso8601",d=1972){const m=Mn(e),y=Mn(r),c=gs(h===void 0?"iso8601":Sa(h)),E=Mn(d);lm(E,m,y),eC(this,{year:E,month:m,day:y},c)}get monthCode(){return DS(this,"monthCode")}get day(){return DS(this,"day")}get calendarId(){return it(this,Tl),oe(this,It)}with(e,r=void 0){if(it(this,Tl),!Fr(e))throw new TypeError("invalid argument");ry(e);const h=oe(this,It);let d=fs(h,oe(this,Tn),"month-day");return d=sm(h,d,Rl(h,e,["year","month","monthCode","day"],[],"partial")),Mg(ab(h,d,fi(Jt(r))),h)}equals(e){it(this,Tl);const r=rS(e);return dh(oe(this,Tn),oe(r,Tn))===0&&uh(oe(this,It),oe(r,It))}toString(e=void 0){return it(this,Tl),cS(this,p0(Jt(e)))}toJSON(){return it(this,Tl),cS(this)}toLocaleString(e=void 0,r=void 0){return it(this,Tl),new yc(e,r).format(this)}valueOf(){$f("PlainMonthDay")}toPlainDate(e){if(it(this,Tl),!Fr(e))throw new TypeError("argument should be an object");const r=oe(this,It);return hs(Ff(r,sm(r,fs(r,oe(this,Tn),"month-day"),Rl(r,e,["year"],[],[])),"constrain"),r)}static from(e,r=void 0){return rS(e,r)}}function DS(n,e){it(n,Tl);const r=oe(n,Tn);return y0(n).isoToDate(r,{[e]:!0})[e]}function Gx(n){return xc(n,L1())}zd($w,"Temporal.PlainMonthDay");const RC={instant:()=>ih(L1()),plainDateTimeISO:(n=y_())=>mc(Gx(ds(n)),"iso8601"),plainDateISO:(n=y_())=>hs(Gx(ds(n)).isoDate,"iso8601"),plainTimeISO:(n=y_())=>gd(Gx(ds(n)).time),timeZoneId:()=>y_(),zonedDateTimeISO:(n=y_())=>{const e=ds(n);return ko(L1(),e,"iso8601")},[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(RC,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});class A0{constructor(e=0,r=0,h=0,d=0,m=0,y=0){const c=e===void 0?0:Mn(e),E=r===void 0?0:Mn(r),C=h===void 0?0:Mn(h),k=d===void 0?0:Mn(d),z=m===void 0?0:Mn(m),F=y===void 0?0:Mn(y);Bb(c,E,C,k,z,F),tC(this,{hour:c,minute:E,second:C,millisecond:k,microsecond:z,nanosecond:F})}get hour(){return it(this,Qr),oe(this,jr).hour}get minute(){return it(this,Qr),oe(this,jr).minute}get second(){return it(this,Qr),oe(this,jr).second}get millisecond(){return it(this,Qr),oe(this,jr).millisecond}get microsecond(){return it(this,Qr),oe(this,jr).microsecond}get nanosecond(){return it(this,Qr),oe(this,jr).nanosecond}with(e,r=void 0){if(it(this,Qr),!Fr(e))throw new TypeError("invalid argument");ry(e);const h=E1(e,"partial"),d=E1(this);let{hour:m,minute:y,second:c,millisecond:E,microsecond:C,nanosecond:k}=Object.assign(d,h);const z=fi(Jt(r));return{hour:m,minute:y,second:c,millisecond:E,microsecond:C,nanosecond:k}=Nb(m,y,c,E,C,k,z),new A0(m,y,c,E,C,k)}add(e){return it(this,Qr),ES("add",this,e)}subtract(e){return it(this,Qr),ES("subtract",this,e)}until(e,r=void 0){return it(this,Qr),_S("until",this,e,r)}since(e,r=void 0){return it(this,Qr),_S("since",this,e,r)}round(e){if(it(this,Qr),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?hm("smallestUnit",e):Jt(e),h=ay(r),d=du(r,"halfExpand"),m=Vs(r,"smallestUnit","time",Rd);return oy(h,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[m],!1),gd(O1(oe(this,jr),h,m,d))}equals(e){it(this,Qr);const r=If(e);return P1(oe(this,jr),oe(r,jr))===0}toString(e=void 0){it(this,Qr);const r=Jt(e),h=m0(r),d=du(r,"trunc"),m=Vs(r,"smallestUnit","time",void 0);if(m==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:y,unit:c,increment:E}=g0(m,h);return lS(O1(oe(this,jr),E,c,d),y)}toJSON(){return it(this,Qr),lS(oe(this,jr),"auto")}toLocaleString(e=void 0,r=void 0){return it(this,Qr),new yc(e,r).format(this)}valueOf(){$f("PlainTime")}static from(e,r=void 0){return If(e,r)}static compare(e,r){const h=If(e),d=If(r);return P1(oe(h,jr),oe(d,jr))}}zd(A0,"Temporal.PlainTime");class Zw{constructor(e,r,h="iso8601",d=1){const m=Mn(e),y=Mn(r),c=gs(h===void 0?"iso8601":Sa(h)),E=Mn(d);lm(m,y,E),nC(this,{year:m,month:y,day:E},c)}get year(){return cd(this,"year")}get month(){return cd(this,"month")}get monthCode(){return cd(this,"monthCode")}get calendarId(){return it(this,co),oe(this,It)}get era(){return cd(this,"era")}get eraYear(){return cd(this,"eraYear")}get daysInMonth(){return cd(this,"daysInMonth")}get daysInYear(){return cd(this,"daysInYear")}get monthsInYear(){return cd(this,"monthsInYear")}get inLeapYear(){return cd(this,"inLeapYear")}with(e,r=void 0){if(it(this,co),!Fr(e))throw new TypeError("invalid argument");ry(e);const h=oe(this,It);let d=fs(h,oe(this,Tn),"year-month");return d=sm(h,d,Rl(h,e,["year","month","monthCode"],[],"partial")),Rg(Q_(h,d,fi(Jt(r))),h)}add(e,r=void 0){return it(this,co),AS("add",this,e,r)}subtract(e,r=void 0){return it(this,co),AS("subtract",this,e,r)}until(e,r=void 0){return it(this,co),vS("until",this,e,r)}since(e,r=void 0){return it(this,co),vS("since",this,e,r)}equals(e){it(this,co);const r=D_(e);return dh(oe(this,Tn),oe(r,Tn))===0&&uh(oe(this,It),oe(r,It))}toString(e=void 0){return it(this,co),uS(this,p0(Jt(e)))}toJSON(){return it(this,co),uS(this)}toLocaleString(e=void 0,r=void 0){return it(this,co),new yc(e,r).format(this)}valueOf(){$f("PlainYearMonth")}toPlainDate(e){if(it(this,co),!Fr(e))throw new TypeError("argument should be an object");const r=oe(this,It);return hs(Ff(r,sm(r,fs(r,oe(this,Tn),"year-month"),Rl(r,e,["day"],[],[])),"constrain"),r)}static from(e,r=void 0){return D_(e,r)}static compare(e,r){const h=D_(e),d=D_(r);return dh(oe(h,Tn),oe(d,Tn))}}function cd(n,e){it(n,co);const r=oe(n,Tn);return y0(n).isoToDate(r,{[e]:!0})[e]}zd(Zw,"Temporal.PlainYearMonth");const B4=yc.prototype.resolvedOptions;class Yw{constructor(e,r,h="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const d=ub(e);let m=Sa(r);const{tzName:y,offsetMinutes:c}=Pf(m);if(c===void 0){const E=ob(y);if(!E)throw new RangeError(`unknown time zone ${y}`);m=E.identifier}else m=Rw(c);rC(this,d,m,gs(h===void 0?"iso8601":Sa(h)))}get calendarId(){return it(this,qn),oe(this,It)}get timeZoneId(){return it(this,qn),oe(this,Ri)}get year(){return ts(this,"year")}get month(){return ts(this,"month")}get monthCode(){return ts(this,"monthCode")}get day(){return ts(this,"day")}get hour(){return Tg(this,"hour")}get minute(){return Tg(this,"minute")}get second(){return Tg(this,"second")}get millisecond(){return Tg(this,"millisecond")}get microsecond(){return Tg(this,"microsecond")}get nanosecond(){return Tg(this,"nanosecond")}get era(){return ts(this,"era")}get eraYear(){return ts(this,"eraYear")}get epochMilliseconds(){return it(this,qn),wc(oe(this,wn),"floor")}get epochNanoseconds(){return it(this,qn),vC(oe(this,wn))}get dayOfWeek(){return ts(this,"dayOfWeek")}get dayOfYear(){return ts(this,"dayOfYear")}get weekOfYear(){return ts(this,"weekOfYear")?.week}get yearOfWeek(){return ts(this,"weekOfYear")?.year}get hoursInDay(){it(this,qn);const e=oe(this,Ri),r=Wu(this).isoDate,h=Ys(r.year,r.month,r.day+1),d=Cf(e,r),m=Cf(e,h);return B_(Xn.fromEpochNsDiff(m,d),"hour")}get daysInWeek(){return ts(this,"daysInWeek")}get daysInMonth(){return ts(this,"daysInMonth")}get daysInYear(){return ts(this,"daysInYear")}get monthsInYear(){return ts(this,"monthsInYear")}get inLeapYear(){return ts(this,"inLeapYear")}get offset(){return it(this,qn),A1(yd(oe(this,Ri),oe(this,wn)))}get offsetNanoseconds(){return it(this,qn),yd(oe(this,Ri),oe(this,wn))}with(e,r=void 0){if(it(this,qn),!Fr(e))throw new TypeError("invalid zoned-date-time-like");ry(e);const h=oe(this,It),d=oe(this,Ri),m=yd(d,oe(this,wn)),y=Wu(this);let c={...fs(h,y.isoDate),...y.time,offset:A1(m)};c=sm(h,c,Rl(h,e,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset"],"partial"));const E=Jt(r),C=F_(E),k=jv(E,"prefer"),z=_0(h,c,fi(E)),F=sy(c.offset);return ko(rb(z.isoDate,z.time,"option",F,d,C,k,!1),d,h)}withPlainTime(e=void 0){it(this,qn);const r=oe(this,Ri),h=oe(this,It),d=Wu(this).isoDate;let m;return m=e===void 0?Cf(r,d):Po(r,yi(d,oe(If(e),jr)),"compatible"),ko(m,r,h)}withTimeZone(e){it(this,qn);const r=ds(e);return ko(oe(this,wn),r,oe(this,It))}withCalendar(e){it(this,qn);const r=b0(e);return ko(oe(this,wn),oe(this,Ri),r)}add(e,r=void 0){return it(this,qn),MS("add",this,e,r)}subtract(e,r=void 0){return it(this,qn),MS("subtract",this,e,r)}until(e,r=void 0){return it(this,qn),bS("until",this,e,r)}since(e,r=void 0){return it(this,qn),bS("since",this,e,r)}round(e){if(it(this,qn),e===void 0)throw new TypeError("options parameter is required");const r=typeof e=="string"?hm("smallestUnit",e):Jt(e),h=ay(r),d=du(r,"halfExpand"),m=Vs(r,"smallestUnit","time",Rd,["day"]),y={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[m];if(oy(h,y,y===1),m==="nanosecond"&&h===1)return ko(oe(this,wn),oe(this,Ri),oe(this,It));const c=oe(this,Ri),E=oe(this,wn),C=Wu(this);let k;if(m==="day"){const z=C.isoDate,F=Ys(z.year,z.month,z.day+1),B=Cf(c,z),Q=Cf(c,F),ie=J.subtract(Q,B);k=Xn.fromEpochNsDiff(E,B).round(ie,d).addToEpochNs(B)}else{const z=k1(C,h,m,d),F=yd(c,E);k=rb(z.isoDate,z.time,"option",F,c,"compatible","prefer",!1)}return ko(k,c,oe(this,It))}equals(e){it(this,qn);const r=I_(e),h=oe(this,wn),d=oe(r,wn);return!!J.equal(J.BigInt(h),J.BigInt(d))&&!!aC(oe(this,Ri),oe(r,Ri))&&uh(oe(this,It),oe(r,It))}toString(e=void 0){it(this,qn);const r=Jt(e),h=p0(r),d=m0(r),m=function(F){return Ed(F,"offset",["auto","never"],"auto")}(r),y=du(r,"trunc"),c=Vs(r,"smallestUnit","time",void 0);if(c==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const E=function(F){return Ed(F,"timeZoneName",["auto","never","critical"],"auto")}(r),{precision:C,unit:k,increment:z}=g0(c,d);return hS(this,C,h,E,m,{unit:k,increment:z,roundingMode:y})}toLocaleString(e=void 0,r=void 0){it(this,qn);const h=Jt(r),d=Object.create(null);if(function(E,C,k,z){if(C==null)return;const F=Reflect.ownKeys(C);for(let B=0;B<F.length;B++){const Q=F[B];if(!k.some(ie=>Object.is(ie,Q))&&Object.prototype.propertyIsEnumerable.call(C,Q)){const ie=C[Q];E[Q]=ie}}}(d,h,["timeZone"]),h.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");if(d.year===void 0&&d.month===void 0&&d.day===void 0&&d.era===void 0&&d.weekday===void 0&&d.dateStyle===void 0&&d.hour===void 0&&d.minute===void 0&&d.second===void 0&&d.fractionalSecondDigits===void 0&&d.timeStyle===void 0&&d.dayPeriod===void 0&&d.timeZoneName===void 0&&(d.timeZoneName="short"),d.timeZone=oe(this,Ri),dS(d.timeZone))throw new RangeError("toLocaleString does not currently support offset time zones");const m=new yc(e,d),y=B4.call(m).calendar,c=oe(this,It);if(c!=="iso8601"&&y!=="iso8601"&&!uh(y,c))throw new RangeError(`cannot format ZonedDateTime with calendar ${c} in locale with calendar ${y}`);return m.format(ih(oe(this,wn)))}toJSON(){return it(this,qn),hS(this,"auto")}valueOf(){$f("ZonedDateTime")}startOfDay(){it(this,qn);const e=oe(this,Ri);return ko(Cf(e,Wu(this).isoDate),e,oe(this,It))}getTimeZoneTransition(e){it(this,qn);const r=oe(this,Ri);if(e===void 0)throw new TypeError("options parameter is required");const h=Ed(typeof e=="string"?hm("direction",e):Jt(e),"direction",["next","previous"],Rd);if(h===void 0)throw new TypeError("direction option is required");if(dS(r)||r==="UTC")return null;const d=oe(this,wn),m=h==="next"?Ow(r,d):C1(r,d);return m===null?null:ko(m,r,oe(this,It))}toInstant(){return it(this,qn),ih(oe(this,wn))}toPlainDate(){return it(this,qn),hs(Wu(this).isoDate,oe(this,It))}toPlainTime(){return it(this,qn),gd(Wu(this).time)}toPlainDateTime(){return it(this,qn),mc(Wu(this),oe(this,It))}static from(e,r=void 0){return I_(e,r)}static compare(e,r){const h=I_(e),d=I_(r),m=oe(h,wn),y=oe(d,wn);return J.lessThan(J.BigInt(m),J.BigInt(y))?-1:J.greaterThan(J.BigInt(m),J.BigInt(y))?1:0}}function Wu(n){return xc(oe(n,Ri),oe(n,wn))}function ts(n,e){it(n,qn);const r=Wu(n).isoDate;return y0(n).isoToDate(r,{[e]:!0})[e]}function Tg(n,e){return it(n,qn),Wu(n).time[e]}zd(Yw,"Temporal.ZonedDateTime");var IS=Object.freeze({__proto__:null,Duration:qg,Instant:Uw,Now:RC,PlainDate:Vw,PlainDateTime:Gw,PlainMonthDay:$w,PlainTime:A0,PlainYearMonth:Zw,ZonedDateTime:Yw});const U4=[Uw,Vw,Gw,qg,$w,A0,Zw,Yw];for(const n of U4){const e=Object.getOwnPropertyDescriptor(n,"prototype");(e.configurable||e.enumerable||e.writable)&&(e.configurable=!1,e.enumerable=!1,e.writable=!1,Object.defineProperty(n,"prototype",e))}function V4({tripQueryVariables:n,setTripQueryVariables:e}){const r=K.useContext(ny),h=IS.Instant.from(n.dateTime).toZonedDateTimeISO(r).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),d=K.useCallback(m=>{const y=IS.PlainDateTime.from(m.target.value).toZonedDateTime(r).toString({calendarName:"never",timeZoneName:"never"});e({...n,dateTime:y})},[n,e,r]);return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+r,children:"Time"}),X.jsx(Bi.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:d,value:h})]})}function G4({tripQueryVariables:n,setTripQueryVariables:e}){return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),X.jsx(Bi.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:n.searchWindow||"",onChange:r=>e({...n,searchWindow:Number(r.target.value)>0?Number(r.target.value):void 0})})]})}function $4({tripQueryVariables:n,setTripQueryVariables:e}){return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),X.jsxs(Bi.Select,{id:"accessSelect",size:"sm",className:"input-medium",onChange:r=>{r.target.value!=="not_selected"?e({...n,modes:{...n.modes,accessMode:r.target.value}}):e({...n,modes:n.modes?.directMode||n.modes?.transportModes?{...n.modes,accessMode:void 0}:void 0})},value:n.modes?.accessMode||"not_selected",children:[X.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Pg).map(r=>X.jsx("option",{value:r,children:r},r))]})]})}function Z4({tripQueryVariables:n,setTripQueryVariables:e}){return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),X.jsxs(Bi.Select,{id:"egressSelect",size:"sm",className:"input-medium",onChange:r=>{r.target.value!=="not_selected"?e({...n,modes:{...n.modes,egressMode:r.target.value}}):e({...n,modes:n.modes?.directMode||n.modes?.transportModes?{...n.modes,egressMode:void 0}:void 0})},value:n.modes?.egressMode||"not_selected",children:[X.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Pg).map(r=>X.jsx("option",{value:r,children:r},r))]})]})}function Y4({tripQueryVariables:n,setTripQueryVariables:e}){return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),X.jsxs(Bi.Select,{id:"directModeSelect",size:"sm",className:"input-medium",onChange:r=>{r.target.value!=="not_selected"?e({...n,modes:{...n.modes,directMode:r.target.value}}):e({...n,modes:n.modes?.accessMode||n.modes?.egressMode||n.modes?.transportModes?{...n.modes,directMode:void 0}:void 0})},value:n.modes?.directMode||"not_selected",children:[X.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Pg).map(r=>X.jsx("option",{value:r,children:r},r))]})]})}const H4=({label:n,options:e,values:r,onChange:h})=>{const[d,m]=K.useState(!1),y=K.useRef(null),c=()=>{m(!d)},E=C=>{const k=C.target.value,z=C.target.checked;h(z?[...r,k]:r.filter(F=>F!==k))};return K.useEffect(()=>{const C=k=>{y.current&&!y.current.contains(k.target)&&m(!1)};return d&&document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[d]),X.jsxs("div",{className:`dropdown ${d?"show":""}`,ref:y,children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:n}),X.jsx(Bi.Control,{type:"text",id:"multiSelectDropdown",size:"sm",className:"input-medium",value:r.length>0?r.join(", "):"Not selected",onClick:c,onChange:()=>{}}),X.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${d?"show":""}`,children:e.map(C=>X.jsx(Bi.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${C.id}`,label:C.label,checked:r.includes(C.id),onChange:E,value:`${C.id}`},`${C.id}`))})]})};function q4({tripQueryVariables:n,setTripQueryVariables:e}){const r=K.useMemo(()=>n?.modes?.transportModes?.map(d=>d?.transportMode).filter(d=>!!d)||[],[n.modes?.transportModes]),h=K.useCallback(d=>{const m=d.filter(y=>y!=null).map(y=>({transportMode:y}));if(m.length===0){const y={...n.modes};delete y.transportModes;const c=y.directMode||y.accessMode||y.egressMode;e({...n,modes:c?y:void 0})}else{const y=n.modes?.accessMode||Pg.Foot,c=n.modes?.egressMode||Pg.Foot;e({...n,modes:{...n.modes,transportModes:m,accessMode:y,egressMode:c}})}},[n,e]);return X.jsx(H4,{label:"Transit mode",options:Object.values(EE).map(d=>({id:d,label:d.toString()})),values:r,onChange:h})}function X4({tripQueryVariables:n,setTripQueryVariables:e}){return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),X.jsx(Bi.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:n.numTripPatterns||"",onChange:r=>e({...n,numTripPatterns:Number(r.target.value)>0?Number(r.target.value):void 0})})]})}function W4({tripQueryVariables:n,setTripQueryVariables:e}){return X.jsxs(Bi.Group,{children:[X.jsx(Bi.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),X.jsxs(Bi.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-medium",onChange:r=>{if(r.target.value==="not_selected"){const h={...n.itineraryFilters};delete h.debug;const d=Object.keys(h).length>0;e({...n,itineraryFilters:d?h:void 0})}else e({...n,itineraryFilters:{...n.itineraryFilters,debug:r.target.value}})},value:n.itineraryFilters?.debug||"not_selected",children:[X.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(SE).map(r=>X.jsx("option",{value:r,children:r},r))]})]})}const Q4="https://www.opentripplanner.org/debug-client-assets/2025/10/2025-10-24T10:45/assets/graphql-solid-B1mrnAEK.svg",RS="/graphiql?flavor=transmodel";function K4({tripQueryVariables:n}){const e=AM(n),r=encodeURIComponent(JSON.stringify(e)),h=EM(n),d=encodeURIComponent(h),m="Open in GraphiQL",y=RS.includes("?")?"&":"?",c=`${RS}${y}query=${d}&variables=${r}`;return X.jsx(Of,{title:m,href:c,target:"_blank",children:X.jsx("img",{alt:m,title:m,src:Q4,width:"20",height:"20",className:"d-inline-block align-middle"})})}function J4({tripQueryVariables:n,setTripQueryVariables:e,onRoute:r,loading:h}){return X.jsxs("div",{className:"box input-group search-bar",children:[X.jsxs("div",{className:"input-family",children:[X.jsx(XT,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(P5,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(XT,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:n,setTripQueryVariables:e})]}),X.jsxs("div",{className:"input-family",children:[X.jsx(L5,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(V4,{tripQueryVariables:n,setTripQueryVariables:e})]}),X.jsxs("div",{className:"input-family",children:[X.jsx(X4,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(G4,{tripQueryVariables:n,setTripQueryVariables:e})]}),X.jsxs("div",{className:"input-family",children:[X.jsx($4,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(q4,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(Z4,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx(Y4,{tripQueryVariables:n,setTripQueryVariables:e})]}),X.jsx(W4,{tripQueryVariables:n,setTripQueryVariables:e}),X.jsx("div",{className:"search-bar-route-button-wrapper",children:X.jsxs(K1,{children:[X.jsxs(Of,{variant:"primary",onClick:()=>r(),disabled:h,children:[h&&X.jsxs(X.Fragment,{children:[X.jsx(zA,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),X.jsx(K4,{tripQueryVariables:n})]})})]})}const kC=K.createContext(void 0);function e6(){const n=K.useContext(kC);if(!n)throw new Error("useTripSchema must be used within a TripSchemaProvider");return n}function Ns(n,e){return e.split(".").reduce((r,h)=>{if(r!=null){if(Array.isArray(r)){const d=Number(h);return Number.isNaN(d)?void 0:r[d]}else if(typeof r=="object")return r[h]}},n)}function Xp(n,e,r){const h=e.split(".");function d(m,y){const c=h[y],E=!isNaN(Number(c));if(y===h.length-1){if(Array.isArray(m)&&E){const F=[...m];return F[Number(c)]=r,F}if($x(m)&&!E)return{...m,[c]:r};if(E){const F=Array.isArray(m)?[...m]:[];return F[Number(c)]=r,F}else return{...$x(m)?m:{},[c]:r}}const C=y+1,k=h[C],z=!isNaN(Number(k));if(Array.isArray(m)&&E){const F=[...m],B=m[Number(c)];return F[Number(c)]=d(B!==void 0?B:z?[]:{},C),F}else if($x(m)&&!E){const F={...m},B=m[c];return F[c]=d(B!==void 0?B:z?[]:{},C),F}else if(E){const F=[];return F[Number(c)]=d(z?[]:{},C),F}else return{[c]:d(z?[]:{},C)}}return n==null&&(n=!isNaN(Number(h[0]))?[]:{}),d(n,0)}function $x(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const t6="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",n6="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",i6="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",r6=({defaultValue:n,type:e})=>X.jsxs("span",{children:[n!=null&&X.jsx("span",{title:`Default: ${n??"None"}`,children:X.jsx("img",{alt:"Info",src:t6,className:"default-tooltip-icon"})}),e!=null&&e.subtype==="DoubleFunction"&&X.jsx("span",{title:`Type: ${e.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:X.jsx("img",{alt:"Info",src:n6,className:"default-tooltip-icon"})}),e!=null&&e.subtype==="Duration"&&X.jsx("span",{className:"default-tooltip-icon",title:`Type: ${e.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:X.jsx("img",{alt:"Info",src:i6,className:"default-tooltip-icon"})})]}),OC=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),PC=({tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:r})=>{function h(){let d={};OC.forEach(m=>{const y=Ns(n,m);y!==void 0&&(d=Xp(d,m,y))}),e(d),r&&r({})}return X.jsx("button",{className:"reset-button",onClick:h,children:"Reset"})};function Zx(n){if(!n)return" ";const e=n.split(".");return e[e.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,h=>h.toUpperCase())+" "}function Fv(n,e=[]){let r=[];return n?(Object.entries(n).forEach(([h,d])=>{const m=[...e,h].join(".");r=r.concat(a6(h,d,m,e))}),r):[]}function a6(n,e,r,h){let d=[];if(typeof e=="object"&&e.type)if(e.type.type==="Enum"){const m=["Not selected",...e.type.values||[]],y=e.defaultValue!==void 0?e.defaultValue:"Not selected";d.push({path:r,type:{type:"Enum"},defaultValue:y,enumValues:m,isList:e.isList})}else e.type.type==="InputObject"&&e.isList?(d.push({path:r,type:{type:"Group",name:e.type.name},defaultValue:e.defaultValue,isComplex:!0,isList:!0}),d=d.concat(Fv(e.type.fields,[...h,`${n}.*`]))):e.type.type==="InputObject"?(d.push({path:r,type:{type:"Group",name:e.type.name},isComplex:!0,isList:!1}),d=d.concat(Fv(e.type.fields,[...h,n]))):e.type.type==="Scalar"&&d.push({path:r,type:{type:e.type.type,subtype:e.type.subtype},defaultValue:e.defaultValue,isList:e.isList});else typeof e=="object"&&e.type?.fields?(d.push({path:r,type:{type:"Group"},isComplex:!0}),d=d.concat(Fv(e.type.fields,[...h,n]))):d.push({path:r,type:e.type??typeof e,defaultValue:e.defaultValue});return d}const o6=({tripQueryVariables:n,setTripQueryVariables:e,expandedArguments:r,setExpandedArguments:h})=>{const[d]=K.useState(""),{tripArgs:m,loading:y,error:c}=e6(),E=m&&!y&&!c?Fv(m.trip.arguments):[];function C(Me){return Me.replace(/\.\d+/g,".*")}function k(Me,Fe){const ot=C(Me),Ee=E.find(Et=>Et.path===ot);if(!Ee){console.error(`No matching argumentConfig found for path: ${Me}`);return}if(Ee.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Ee.type.subtype)&&Ee.isList&&typeof Fe=="string"){const Et=Fe.split(",").map(zt=>zt.trim());let Tt=Xp(n,Me,Et);Tt=B(Tt,Me),e(Tt);return}let Je=Xp(n,Me,Fe);Je=B(Je,Me),e(Je)}function z(Me){return typeof Me=="object"&&Me!==null&&!Array.isArray(Me)}function F(Me){return Me==null?!0:Array.isArray(Me)?Me.length===0:z(Me)?Object.values(Me).every(F):!1}function B(Me,Fe){if(!Fe.includes(".")){const Ee=Ns(Me,Fe);if(F(Ee)){const Je={...Me};return delete Je[Fe],Je}return Me}const ot=Fe.split(".");for(let Ee=ot.length-1;Ee>0;Ee--){const Je=ot.slice(0,Ee).join("."),Et=Ns(Me,Je);F(Et)&&(Me=Xp(Me,Je,void 0))}return Me}function Q(Me){h({...r,[Me]:!r[Me]})}function ie(){h({})}const ne=E.filter(({path:Me})=>Zx(Me).toLowerCase().includes(d.toLowerCase())).filter(({path:Me})=>!OC.has(Me));function ue(Me,Fe,ot,Ee){const Je=Ns(n,Me)??[],Et=Ee.name;return X.jsxs("div",{children:[Je.map((Tt,zt)=>{const Zt=`${Me}.${zt}`,Gt=Fe.filter(xt=>xt.path.startsWith(`${Me}.*.`)&&xt.path!==`${Me}.*`).map(xt=>({...xt,path:xt.path.replace(`${Me}.*`,Zt)})),Ue=Gt.filter(xt=>xt.path.split(".").length===Zt.split(".").length+1),st=r[Zt];return X.jsxs("div",{style:{marginLeft:15},children:[X.jsxs("span",{style:{cursor:"pointer"},onClick:()=>Q(Zt),children:[st?"▼ ":"▶ "," [#",zt+1,"]"]}),X.jsx("button",{style:{marginLeft:10},onClick:()=>Te(Me,zt),children:"Remove"}),st&&X.jsx("div",{style:{marginLeft:20},children:be(Ue,ot+1,Gt)})]},Zt)}),X.jsxs("button",{onClick:()=>Ae(Me),children:["+ Add ",Et]})]})}function Ae(Me){const ot=[...Ns(n,Me)??[],{}],Ee=Xp(n,Me,ot);e(Ee)}function Te(Me,Fe){const Ee=(Ns(n,Me)??[]).filter((Et,Tt)=>Tt!==Fe);let Je=Xp(n,Me,Ee);Je=B(Je,Me),e(Je)}function ke(Me){let Fe=Xp(n,Me,void 0);Fe=B(Fe,Me),e(Fe)}function be(Me,Fe,ot){return Me.map(({path:Ee,type:Je,defaultValue:Et,enumValues:Tt,isComplex:zt,isList:Zt})=>{const Gt=r[Ee],Ue=Ee.split(".").length,st=ot.filter(ut=>{const Ut=ut.path.split(".").length;return ut.path.startsWith(`${Ee}.`)&&ut.path!==Ee&&Ut===Ue+1}),xt=Fe+1;return X.jsx("div",{style:{marginLeft:`${Fe*15}px`,marginBottom:"10px"},children:zt?X.jsxs("div",{children:[X.jsxs("span",{style:{cursor:"pointer"},onClick:()=>Q(Ee),children:[Gt?"▼ ":"▶ "," ",Zx(Ee)]}),Gt&&Zt?X.jsx("div",{style:{marginLeft:20},children:ue(Ee,ot,xt,Je)}):Gt?be(st,xt,ot):null]}):X.jsxs("div",{children:[X.jsxs("label",{className:"argument-label",htmlFor:Ee,children:[Zx(Ee)," ",X.jsx(r6,{defaultValue:Et,type:Je})]}),Je.subtype==="Boolean"&&(()=>{const ut=Ns(n,Ee),Ut=ut!==void 0;return X.jsxs("span",{children:[X.jsx("input",{type:"checkbox",id:Ee,checked:ut??!1,onChange:De=>k(Ee,De.target.checked)}),Ut&&X.jsx("button",{onClick:()=>ke(Ee),className:"remove-argument",style:{fontSize:"10px",paddingTop:"2px",marginLeft:"8px",marginBottom:"0px",marginTop:"-5px",height:"14px",width:"45px",verticalAlign:"middle"},children:"Clear"})]})})(),Je.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Je.subtype)&&Zt&&X.jsx("input",{className:"comma-separated-input",type:"text",id:Ee,value:(()=>{const ut=Ns(n,Ee);return Array.isArray(ut)?ut.join(", "):""})(),onChange:ut=>k(Ee,ut.target.value),placeholder:"Comma-separated list"}),Je.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Je.subtype)&&!Zt&&X.jsx("input",{type:"text",id:Ee,value:Ns(n,Ee)??"",onChange:ut=>k(Ee,ut.target.value||void 0)}),Je.subtype==="Int"&&X.jsx("input",{type:"number",id:Ee,value:Ns(n,Ee)??"",onChange:ut=>{const Ut=parseInt(ut.target.value,10);k(Ee,Number.isNaN(Ut)?void 0:Ut)}}),Je.subtype==="Float"&&X.jsx("input",{type:"number",id:Ee,step:"any",value:Ns(n,Ee)??"",onChange:ut=>{const Ut=parseFloat(ut.target.value);k(Ee,Number.isNaN(Ut)?void 0:Ut)}}),Je.subtype==="DateTime"&&X.jsx("input",{type:"datetime-local",id:Ee,value:(Ns(n,Ee)??"").slice(0,16),onChange:ut=>{const Ut=ut.target.value?new Date(ut.target.value).toISOString():void 0;k(Ee,Ut)}}),Je.type==="Enum"&&Tt&&Zt&&X.jsx("select",{id:Ee,multiple:!0,value:(()=>{const ut=Ns(n,Ee);return Array.isArray(ut)?ut:[]})(),onChange:ut=>{const Ut=Array.from(ut.target.selectedOptions,De=>De.value);k(Ee,Ut)},children:Tt.map(ut=>X.jsx("option",{value:ut,children:ut},ut))}),Je.type==="Enum"&&Tt&&!Zt&&X.jsx("select",{id:Ee,value:Ns(n,Ee)??"Not selected",onChange:ut=>{const Ut=ut.target.value==="Not selected"?void 0:ut.target.value;k(Ee,Ut)},children:Tt.map(ut=>X.jsx("option",{value:ut,children:ut},ut))})]})},Ee)})}return X.jsxs("div",{className:"left-pane-container below-content",children:[X.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",position:"relative"},children:[X.jsx("button",{className:"collapse-all-button",onClick:ie,style:{padding:"4px 8px"},children:"Collapse all"}),X.jsx("span",{className:"panel-header-title-with-left-button",children:"Arguments"}),X.jsx("div",{style:{marginLeft:"auto"},children:X.jsx(PC,{tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:h})})]}),ne.length===0?X.jsx("p",{children:"No arguments found."}):X.jsx("div",{className:"argument-list",children:be(ne.filter(Me=>Me.path.split(".").length===1),0,ne)})]})},s6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",l6="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",c6="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",u6=({children:n})=>{const[e,r]=K.useState(0),h=m=>{switch(m){case 0:return X.jsx("img",{src:s6,alt:"Itinerary results",title:"Itinerary results"});case 1:return X.jsx("img",{src:l6,alt:"Arguments",title:"Arguments"});case 2:return X.jsx("img",{width:"25",height:"25",src:c6,alt:"Arguments raw",title:"Arguments raw"});default:return null}},d=El.Children.toArray(n).filter(m=>El.isValidElement(m));return X.jsxs("div",{className:"sidebar-container",children:[X.jsx("div",{className:"sidebar",children:d.map((m,y)=>X.jsx("div",{className:`sidebar-button ${y===e?"active":""}`,onClick:()=>r(y),children:h(y)},y))}),X.jsx("div",{className:"sidebar-content",children:d.map((m,y)=>y===e?X.jsx("div",{children:m},y):null)})]})},h6=({tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:r})=>X.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[X.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",position:"relative"},children:[X.jsx("span",{className:"panel-header-title-simple",children:"Arguments raw"}),X.jsx("div",{style:{marginLeft:"auto"},children:X.jsx(PC,{tripQueryVariables:n,setTripQueryVariables:e,setExpandedArguments:r})})]}),X.jsx("pre",{children:JSON.stringify(n,null,2)})]});function d6(n){let e=n;for(;;)if(vd(e))e=e.ofType;else if(Bf(e))e=e.ofType;else break;return e}function LC(n){const e=d6(n);if(Qg(e))return{type:"Scalar",subtype:e.name};if(Lf(e))return{type:"Enum",values:e.getValues().map(r=>r.name)};if(_d(e)){const r=e.getFields(),h={};for(const d of Object.keys(r)){const m=r[d];if(m.deprecationReason)continue;const y=Bf(m.type),c=m.defaultValue!==void 0?m.defaultValue:null;h[d]={type:LC(m.type),defaultValue:c,isList:y}}return{type:"InputObject",name:e.name,fields:h}}return{type:"Scalar",subtype:"String"}}function f6(n){const e=n.getQueryType();if(!e)throw new Error("No Query type found in the schema.");const r=e.getFields().trip;if(!r)throw new Error("No trip query found in the schema.");const h={};return r.args.forEach(d=>{if(d.deprecationReason)return;const m=d.name,y=LC(d.type),c=d.defaultValue!==null?d.defaultValue:null,E=Bf(d.type);h[m]={type:y,...c!==null&&{defaultValue:c},isList:E}}),{trip:{arguments:h}}}async function p6(n){const e=UI(),r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})});if(!r.ok)throw new Error(`Failed to fetch schema. HTTP error: ${r.status}`);const{data:h}=await r.json(),d=VI(h);return f6(d)}function m6({endpoint:n,children:e}){const[r,h]=K.useState(null),[d,m]=K.useState(!0),[y,c]=K.useState(null);K.useEffect(()=>{let C=!0;async function k(){m(!0),c(null);try{const z=await p6(n);C&&h(z)}catch(z){console.error("Error loading trip arguments:",z),C&&c("Failed to load trip schema")}finally{C&&m(!1)}}return k(),()=>{C=!1}},[n]);const E={tripArgs:r,loading:d,error:y};return X.jsx(kC.Provider,{value:E,children:e})}function g6(){const n=w5(),{tripQueryVariables:e,setTripQueryVariables:r}=A5(),[h,d]=K.useState([]),[m,y]=K.useState(!1),[c,E,C]=b5(e),[k,z]=K.useState([0]),[F,B]=K.useState({}),Q=n?.internalTransitModelTimeZone||Intl.DateTimeFormat().resolvedOptions().timeZone;return K.useEffect(()=>{c?.trip.tripPatterns.length&&z([0])},[c]),X.jsx("div",{className:"app",children:X.jsxs(ny.Provider,{value:Q,children:[X.jsxs("div",{className:"layout",children:[X.jsx("div",{className:"box logo-section",children:X.jsx(D5,{serverInfo:n})}),X.jsx("div",{className:"box input-section",children:X.jsx(J4,{onRoute:C,tripQueryVariables:e,setTripQueryVariables:r,loading:E})}),X.jsx("div",{className:"box trip-section",children:X.jsxs(u6,{children:[X.jsx(TP,{tripQueryResult:c,selectedTripPatternIndexes:k,setSelectedTripPatternIndexes:z,pageResults:C,loading:E,comparisonSelectedIndexes:h,setComparisonSelectedIndexes:d,onCompare:()=>y(!0)}),X.jsx(m6,{endpoint:vb(),children:X.jsx(o6,{tripQueryVariables:e,setTripQueryVariables:r,expandedArguments:F,setExpandedArguments:B})}),X.jsx(h6,{tripQueryVariables:e,setTripQueryVariables:r,setExpandedArguments:B})]})}),X.jsx("div",{className:"box map-section",children:X.jsx(AO,{tripQueryResult:c,tripQueryVariables:e,setTripQueryVariables:r,selectedTripPatternIndexes:k,loading:E})})]}),X.jsx(g5,{show:m,onHide:()=>y(!1),tripQueryResult:c,selectedIndexes:h})]})})}ZC.createRoot(document.getElementById("root")).render(X.jsx(El.StrictMode,{children:X.jsx(g6,{})}));
