var hE=Object.defineProperty;var dE=(i,n,o)=>n in i?hE(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o;var vp=(i,n,o)=>dE(i,typeof n!="symbol"?n+"":n,o);function fE(i,n){for(var o=0;o<n.length;o++){const h=n[o];if(typeof h!="string"&&!Array.isArray(h)){for(const p in h)if(p!=="default"&&!(p in i)){const _=Object.getOwnPropertyDescriptor(h,p);_&&Object.defineProperty(i,p,_.get?_:{enumerable:!0,get:()=>h[p]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))h(p);new MutationObserver(p=>{for(const _ of p)if(_.type==="childList")for(const v of _.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&h(v)}).observe(document,{childList:!0,subtree:!0});function o(p){const _={};return p.integrity&&(_.integrity=p.integrity),p.referrerPolicy&&(_.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?_.credentials="include":p.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function h(p){if(p.ep)return;p.ep=!0;const _=o(p);fetch(p.href,_)}})();function jp(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Zv={exports:{}},zy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wb;function pE(){if(Wb)return zy;Wb=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function o(h,p,_){var v=null;if(_!==void 0&&(v=""+_),p.key!==void 0&&(v=""+p.key),"key"in p){_={};for(var c in p)c!=="key"&&(_[c]=p[c])}else _=p;return p=_.ref,{$$typeof:i,type:h,key:v,ref:p!==void 0?p:null,props:_}}return zy.Fragment=n,zy.jsx=o,zy.jsxs=o,zy}var Qb;function mE(){return Qb||(Qb=1,Zv.exports=pE()),Zv.exports}var ae=mE(),$v={exports:{}},Nn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kb;function gE(){if(Kb)return Nn;Kb=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),v=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),B=Symbol.iterator;function U(Ce){return Ce===null||typeof Ce!="object"?null:(Ce=B&&Ce[B]||Ce["@@iterator"],typeof Ce=="function"?Ce:null)}var Z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ne=Object.assign,ye={};function me(Ce,ut,wt){this.props=Ce,this.context=ut,this.refs=ye,this.updater=wt||Z}me.prototype.isReactComponent={},me.prototype.setState=function(Ce,ut){if(typeof Ce!="object"&&typeof Ce!="function"&&Ce!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ce,ut,"setState")},me.prototype.forceUpdate=function(Ce){this.updater.enqueueForceUpdate(this,Ce,"forceUpdate")};function Pe(){}Pe.prototype=me.prototype;function tt(Ce,ut,wt){this.props=Ce,this.context=ut,this.refs=ye,this.updater=wt||Z}var Je=tt.prototype=new Pe;Je.constructor=tt,ne(Je,me.prototype),Je.isPureReactComponent=!0;var $e=Array.isArray,Me={H:null,A:null,T:null,S:null,V:null},Ve=Object.prototype.hasOwnProperty;function ct(Ce,ut,wt,Mt,Rt,Jt){return wt=Jt.ref,{$$typeof:i,type:Ce,key:ut,ref:wt!==void 0?wt:null,props:Jt}}function ot(Ce,ut){return ct(Ce.type,ut,void 0,void 0,void 0,Ce.props)}function Re(Ce){return typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===i}function mt(Ce){var ut={"=":"=0",":":"=2"};return"$"+Ce.replace(/[=:]/g,function(wt){return ut[wt]})}var It=/\/+/g;function Lt(Ce,ut){return typeof Ce=="object"&&Ce!==null&&Ce.key!=null?mt(""+Ce.key):ut.toString(36)}function Ut(){}function sn(Ce){switch(Ce.status){case"fulfilled":return Ce.value;case"rejected":throw Ce.reason;default:switch(typeof Ce.status=="string"?Ce.then(Ut,Ut):(Ce.status="pending",Ce.then(function(ut){Ce.status==="pending"&&(Ce.status="fulfilled",Ce.value=ut)},function(ut){Ce.status==="pending"&&(Ce.status="rejected",Ce.reason=ut)})),Ce.status){case"fulfilled":return Ce.value;case"rejected":throw Ce.reason}}throw Ce}function on(Ce,ut,wt,Mt,Rt){var Jt=typeof Ce;(Jt==="undefined"||Jt==="boolean")&&(Ce=null);var Wt=!1;if(Ce===null)Wt=!0;else switch(Jt){case"bigint":case"string":case"number":Wt=!0;break;case"object":switch(Ce.$$typeof){case i:case n:Wt=!0;break;case P:return Wt=Ce._init,on(Wt(Ce._payload),ut,wt,Mt,Rt)}}if(Wt)return Rt=Rt(Ce),Wt=Mt===""?"."+Lt(Ce,0):Mt,$e(Rt)?(wt="",Wt!=null&&(wt=Wt.replace(It,"$&/")+"/"),on(Rt,ut,wt,"",function(Gn){return Gn})):Rt!=null&&(Re(Rt)&&(Rt=ot(Rt,wt+(Rt.key==null||Ce&&Ce.key===Rt.key?"":(""+Rt.key).replace(It,"$&/")+"/")+Wt)),ut.push(Rt)),1;Wt=0;var Ri=Mt===""?".":Mt+":";if($e(Ce))for(var zn=0;zn<Ce.length;zn++)Mt=Ce[zn],Jt=Ri+Lt(Mt,zn),Wt+=on(Mt,ut,wt,Jt,Rt);else if(zn=U(Ce),typeof zn=="function")for(Ce=zn.call(Ce),zn=0;!(Mt=Ce.next()).done;)Mt=Mt.value,Jt=Ri+Lt(Mt,zn++),Wt+=on(Mt,ut,wt,Jt,Rt);else if(Jt==="object"){if(typeof Ce.then=="function")return on(sn(Ce),ut,wt,Mt,Rt);throw ut=String(Ce),Error("Objects are not valid as a React child (found: "+(ut==="[object Object]"?"object with keys {"+Object.keys(Ce).join(", ")+"}":ut)+"). If you meant to render a collection of children, use an array instead.")}return Wt}function Ye(Ce,ut,wt){if(Ce==null)return Ce;var Mt=[],Rt=0;return on(Ce,Mt,"","",function(Jt){return ut.call(wt,Jt,Rt++)}),Mt}function gt(Ce){if(Ce._status===-1){var ut=Ce._result;ut=ut(),ut.then(function(wt){(Ce._status===0||Ce._status===-1)&&(Ce._status=1,Ce._result=wt)},function(wt){(Ce._status===0||Ce._status===-1)&&(Ce._status=2,Ce._result=wt)}),Ce._status===-1&&(Ce._status=0,Ce._result=ut)}if(Ce._status===1)return Ce._result.default;throw Ce._result}var _t=typeof reportError=="function"?reportError:function(Ce){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ut=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ce=="object"&&Ce!==null&&typeof Ce.message=="string"?String(Ce.message):String(Ce),error:Ce});if(!window.dispatchEvent(ut))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ce);return}console.error(Ce)};function qt(){}return Nn.Children={map:Ye,forEach:function(Ce,ut,wt){Ye(Ce,function(){ut.apply(this,arguments)},wt)},count:function(Ce){var ut=0;return Ye(Ce,function(){ut++}),ut},toArray:function(Ce){return Ye(Ce,function(ut){return ut})||[]},only:function(Ce){if(!Re(Ce))throw Error("React.Children.only expected to receive a single React element child.");return Ce}},Nn.Component=me,Nn.Fragment=o,Nn.Profiler=p,Nn.PureComponent=tt,Nn.StrictMode=h,Nn.Suspense=D,Nn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Me,Nn.__COMPILER_RUNTIME={__proto__:null,c:function(Ce){return Me.H.useMemoCache(Ce)}},Nn.cache=function(Ce){return function(){return Ce.apply(null,arguments)}},Nn.cloneElement=function(Ce,ut,wt){if(Ce==null)throw Error("The argument must be a React element, but you passed "+Ce+".");var Mt=ne({},Ce.props),Rt=Ce.key,Jt=void 0;if(ut!=null)for(Wt in ut.ref!==void 0&&(Jt=void 0),ut.key!==void 0&&(Rt=""+ut.key),ut)!Ve.call(ut,Wt)||Wt==="key"||Wt==="__self"||Wt==="__source"||Wt==="ref"&&ut.ref===void 0||(Mt[Wt]=ut[Wt]);var Wt=arguments.length-2;if(Wt===1)Mt.children=wt;else if(1<Wt){for(var Ri=Array(Wt),zn=0;zn<Wt;zn++)Ri[zn]=arguments[zn+2];Mt.children=Ri}return ct(Ce.type,Rt,void 0,void 0,Jt,Mt)},Nn.createContext=function(Ce){return Ce={$$typeof:v,_currentValue:Ce,_currentValue2:Ce,_threadCount:0,Provider:null,Consumer:null},Ce.Provider=Ce,Ce.Consumer={$$typeof:_,_context:Ce},Ce},Nn.createElement=function(Ce,ut,wt){var Mt,Rt={},Jt=null;if(ut!=null)for(Mt in ut.key!==void 0&&(Jt=""+ut.key),ut)Ve.call(ut,Mt)&&Mt!=="key"&&Mt!=="__self"&&Mt!=="__source"&&(Rt[Mt]=ut[Mt]);var Wt=arguments.length-2;if(Wt===1)Rt.children=wt;else if(1<Wt){for(var Ri=Array(Wt),zn=0;zn<Wt;zn++)Ri[zn]=arguments[zn+2];Rt.children=Ri}if(Ce&&Ce.defaultProps)for(Mt in Wt=Ce.defaultProps,Wt)Rt[Mt]===void 0&&(Rt[Mt]=Wt[Mt]);return ct(Ce,Jt,void 0,void 0,null,Rt)},Nn.createRef=function(){return{current:null}},Nn.forwardRef=function(Ce){return{$$typeof:c,render:Ce}},Nn.isValidElement=Re,Nn.lazy=function(Ce){return{$$typeof:P,_payload:{_status:-1,_result:Ce},_init:gt}},Nn.memo=function(Ce,ut){return{$$typeof:I,type:Ce,compare:ut===void 0?null:ut}},Nn.startTransition=function(Ce){var ut=Me.T,wt={};Me.T=wt;try{var Mt=Ce(),Rt=Me.S;Rt!==null&&Rt(wt,Mt),typeof Mt=="object"&&Mt!==null&&typeof Mt.then=="function"&&Mt.then(qt,_t)}catch(Jt){_t(Jt)}finally{Me.T=ut}},Nn.unstable_useCacheRefresh=function(){return Me.H.useCacheRefresh()},Nn.use=function(Ce){return Me.H.use(Ce)},Nn.useActionState=function(Ce,ut,wt){return Me.H.useActionState(Ce,ut,wt)},Nn.useCallback=function(Ce,ut){return Me.H.useCallback(Ce,ut)},Nn.useContext=function(Ce){return Me.H.useContext(Ce)},Nn.useDebugValue=function(){},Nn.useDeferredValue=function(Ce,ut){return Me.H.useDeferredValue(Ce,ut)},Nn.useEffect=function(Ce,ut,wt){var Mt=Me.H;if(typeof wt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Mt.useEffect(Ce,ut)},Nn.useId=function(){return Me.H.useId()},Nn.useImperativeHandle=function(Ce,ut,wt){return Me.H.useImperativeHandle(Ce,ut,wt)},Nn.useInsertionEffect=function(Ce,ut){return Me.H.useInsertionEffect(Ce,ut)},Nn.useLayoutEffect=function(Ce,ut){return Me.H.useLayoutEffect(Ce,ut)},Nn.useMemo=function(Ce,ut){return Me.H.useMemo(Ce,ut)},Nn.useOptimistic=function(Ce,ut){return Me.H.useOptimistic(Ce,ut)},Nn.useReducer=function(Ce,ut,wt){return Me.H.useReducer(Ce,ut,wt)},Nn.useRef=function(Ce){return Me.H.useRef(Ce)},Nn.useState=function(Ce){return Me.H.useState(Ce)},Nn.useSyncExternalStore=function(Ce,ut,wt){return Me.H.useSyncExternalStore(Ce,ut,wt)},Nn.useTransition=function(){return Me.H.useTransition()},Nn.version="19.1.0",Nn}var Jb;function ab(){return Jb||(Jb=1,$v.exports=gE()),$v.exports}var he=ab();const Fl=jp(he);var Yv={exports:{}},Ny={},qv={exports:{}},Hv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function yE(){return e1||(e1=1,function(i){function n(Ye,gt){var _t=Ye.length;Ye.push(gt);e:for(;0<_t;){var qt=_t-1>>>1,Ce=Ye[qt];if(0<p(Ce,gt))Ye[qt]=gt,Ye[_t]=Ce,_t=qt;else break e}}function o(Ye){return Ye.length===0?null:Ye[0]}function h(Ye){if(Ye.length===0)return null;var gt=Ye[0],_t=Ye.pop();if(_t!==gt){Ye[0]=_t;e:for(var qt=0,Ce=Ye.length,ut=Ce>>>1;qt<ut;){var wt=2*(qt+1)-1,Mt=Ye[wt],Rt=wt+1,Jt=Ye[Rt];if(0>p(Mt,_t))Rt<Ce&&0>p(Jt,Mt)?(Ye[qt]=Jt,Ye[Rt]=_t,qt=Rt):(Ye[qt]=Mt,Ye[wt]=_t,qt=wt);else if(Rt<Ce&&0>p(Jt,_t))Ye[qt]=Jt,Ye[Rt]=_t,qt=Rt;else break e}}return gt}function p(Ye,gt){var _t=Ye.sortIndex-gt.sortIndex;return _t!==0?_t:Ye.id-gt.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;i.unstable_now=function(){return _.now()}}else{var v=Date,c=v.now();i.unstable_now=function(){return v.now()-c}}var D=[],I=[],P=1,B=null,U=3,Z=!1,ne=!1,ye=!1,me=!1,Pe=typeof setTimeout=="function"?setTimeout:null,tt=typeof clearTimeout=="function"?clearTimeout:null,Je=typeof setImmediate<"u"?setImmediate:null;function $e(Ye){for(var gt=o(I);gt!==null;){if(gt.callback===null)h(I);else if(gt.startTime<=Ye)h(I),gt.sortIndex=gt.expirationTime,n(D,gt);else break;gt=o(I)}}function Me(Ye){if(ye=!1,$e(Ye),!ne)if(o(D)!==null)ne=!0,Ve||(Ve=!0,Lt());else{var gt=o(I);gt!==null&&on(Me,gt.startTime-Ye)}}var Ve=!1,ct=-1,ot=5,Re=-1;function mt(){return me?!0:!(i.unstable_now()-Re<ot)}function It(){if(me=!1,Ve){var Ye=i.unstable_now();Re=Ye;var gt=!0;try{e:{ne=!1,ye&&(ye=!1,tt(ct),ct=-1),Z=!0;var _t=U;try{t:{for($e(Ye),B=o(D);B!==null&&!(B.expirationTime>Ye&&mt());){var qt=B.callback;if(typeof qt=="function"){B.callback=null,U=B.priorityLevel;var Ce=qt(B.expirationTime<=Ye);if(Ye=i.unstable_now(),typeof Ce=="function"){B.callback=Ce,$e(Ye),gt=!0;break t}B===o(D)&&h(D),$e(Ye)}else h(D);B=o(D)}if(B!==null)gt=!0;else{var ut=o(I);ut!==null&&on(Me,ut.startTime-Ye),gt=!1}}break e}finally{B=null,U=_t,Z=!1}gt=void 0}}finally{gt?Lt():Ve=!1}}}var Lt;if(typeof Je=="function")Lt=function(){Je(It)};else if(typeof MessageChannel<"u"){var Ut=new MessageChannel,sn=Ut.port2;Ut.port1.onmessage=It,Lt=function(){sn.postMessage(null)}}else Lt=function(){Pe(It,0)};function on(Ye,gt){ct=Pe(function(){Ye(i.unstable_now())},gt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ye){Ye.callback=null},i.unstable_forceFrameRate=function(Ye){0>Ye||125<Ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ot=0<Ye?Math.floor(1e3/Ye):5},i.unstable_getCurrentPriorityLevel=function(){return U},i.unstable_next=function(Ye){switch(U){case 1:case 2:case 3:var gt=3;break;default:gt=U}var _t=U;U=gt;try{return Ye()}finally{U=_t}},i.unstable_requestPaint=function(){me=!0},i.unstable_runWithPriority=function(Ye,gt){switch(Ye){case 1:case 2:case 3:case 4:case 5:break;default:Ye=3}var _t=U;U=Ye;try{return gt()}finally{U=_t}},i.unstable_scheduleCallback=function(Ye,gt,_t){var qt=i.unstable_now();switch(typeof _t=="object"&&_t!==null?(_t=_t.delay,_t=typeof _t=="number"&&0<_t?qt+_t:qt):_t=qt,Ye){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=_t+Ce,Ye={id:P++,callback:gt,priorityLevel:Ye,startTime:_t,expirationTime:Ce,sortIndex:-1},_t>qt?(Ye.sortIndex=_t,n(I,Ye),o(D)===null&&Ye===o(I)&&(ye?(tt(ct),ct=-1):ye=!0,on(Me,_t-qt))):(Ye.sortIndex=Ce,n(D,Ye),ne||Z||(ne=!0,Ve||(Ve=!0,Lt()))),Ye},i.unstable_shouldYield=mt,i.unstable_wrapCallback=function(Ye){var gt=U;return function(){var _t=U;U=gt;try{return Ye.apply(this,arguments)}finally{U=_t}}}}(Hv)),Hv}var t1;function _E(){return t1||(t1=1,qv.exports=yE()),qv.exports}var Xv={exports:{}},ds={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function vE(){if(n1)return ds;n1=1;var i=ab();function n(D){var I="https://react.dev/errors/"+D;if(1<arguments.length){I+="?args[]="+encodeURIComponent(arguments[1]);for(var P=2;P<arguments.length;P++)I+="&args[]="+encodeURIComponent(arguments[P])}return"Minified React error #"+D+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var h={d:{f:o,r:function(){throw Error(n(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},p=Symbol.for("react.portal");function _(D,I,P){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:B==null?null:""+B,children:D,containerInfo:I,implementation:P}}var v=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(D,I){if(D==="font")return"";if(typeof I=="string")return I==="use-credentials"?I:""}return ds.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=h,ds.createPortal=function(D,I){var P=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I||I.nodeType!==1&&I.nodeType!==9&&I.nodeType!==11)throw Error(n(299));return _(D,I,null,P)},ds.flushSync=function(D){var I=v.T,P=h.p;try{if(v.T=null,h.p=2,D)return D()}finally{v.T=I,h.p=P,h.d.f()}},ds.preconnect=function(D,I){typeof D=="string"&&(I?(I=I.crossOrigin,I=typeof I=="string"?I==="use-credentials"?I:"":void 0):I=null,h.d.C(D,I))},ds.prefetchDNS=function(D){typeof D=="string"&&h.d.D(D)},ds.preinit=function(D,I){if(typeof D=="string"&&I&&typeof I.as=="string"){var P=I.as,B=c(P,I.crossOrigin),U=typeof I.integrity=="string"?I.integrity:void 0,Z=typeof I.fetchPriority=="string"?I.fetchPriority:void 0;P==="style"?h.d.S(D,typeof I.precedence=="string"?I.precedence:void 0,{crossOrigin:B,integrity:U,fetchPriority:Z}):P==="script"&&h.d.X(D,{crossOrigin:B,integrity:U,fetchPriority:Z,nonce:typeof I.nonce=="string"?I.nonce:void 0})}},ds.preinitModule=function(D,I){if(typeof D=="string")if(typeof I=="object"&&I!==null){if(I.as==null||I.as==="script"){var P=c(I.as,I.crossOrigin);h.d.M(D,{crossOrigin:P,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0})}}else I==null&&h.d.M(D)},ds.preload=function(D,I){if(typeof D=="string"&&typeof I=="object"&&I!==null&&typeof I.as=="string"){var P=I.as,B=c(P,I.crossOrigin);h.d.L(D,P,{crossOrigin:B,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0,type:typeof I.type=="string"?I.type:void 0,fetchPriority:typeof I.fetchPriority=="string"?I.fetchPriority:void 0,referrerPolicy:typeof I.referrerPolicy=="string"?I.referrerPolicy:void 0,imageSrcSet:typeof I.imageSrcSet=="string"?I.imageSrcSet:void 0,imageSizes:typeof I.imageSizes=="string"?I.imageSizes:void 0,media:typeof I.media=="string"?I.media:void 0})}},ds.preloadModule=function(D,I){if(typeof D=="string")if(I){var P=c(I.as,I.crossOrigin);h.d.m(D,{as:typeof I.as=="string"&&I.as!=="script"?I.as:void 0,crossOrigin:P,integrity:typeof I.integrity=="string"?I.integrity:void 0})}else h.d.m(D)},ds.requestFormReset=function(D){h.d.r(D)},ds.unstable_batchedUpdates=function(D,I){return D(I)},ds.useFormState=function(D,I,P){return v.H.useFormState(D,I,P)},ds.useFormStatus=function(){return v.H.useHostTransitionStatus()},ds.version="19.1.0",ds}var i1;function e2(){if(i1)return Xv.exports;i1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Xv.exports=vE(),Xv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function xE(){if(r1)return Ny;r1=1;var i=_E(),n=ab(),o=e2();function h(r){var u="https://react.dev/errors/"+r;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+r+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function _(r){var u=r,m=r;if(r.alternate)for(;u.return;)u=u.return;else{r=u;do u=r,(u.flags&4098)!==0&&(m=u.return),r=u.return;while(r)}return u.tag===3?m:null}function v(r){if(r.tag===13){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function c(r){if(_(r)!==r)throw Error(h(188))}function D(r){var u=r.alternate;if(!u){if(u=_(r),u===null)throw Error(h(188));return u!==r?null:r}for(var m=r,b=u;;){var M=m.return;if(M===null)break;var z=M.alternate;if(z===null){if(b=M.return,b!==null){m=b;continue}break}if(M.child===z.child){for(z=M.child;z;){if(z===m)return c(M),r;if(z===b)return c(M),u;z=z.sibling}throw Error(h(188))}if(m.return!==b.return)m=M,b=z;else{for(var X=!1,re=M.child;re;){if(re===m){X=!0,m=M,b=z;break}if(re===b){X=!0,b=M,m=z;break}re=re.sibling}if(!X){for(re=z.child;re;){if(re===m){X=!0,m=z,b=M;break}if(re===b){X=!0,b=z,m=M;break}re=re.sibling}if(!X)throw Error(h(189))}}if(m.alternate!==b)throw Error(h(190))}if(m.tag!==3)throw Error(h(188));return m.stateNode.current===m?r:u}function I(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r;for(r=r.child;r!==null;){if(u=I(r),u!==null)return u;r=r.sibling}return null}var P=Object.assign,B=Symbol.for("react.element"),U=Symbol.for("react.transitional.element"),Z=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),ye=Symbol.for("react.strict_mode"),me=Symbol.for("react.profiler"),Pe=Symbol.for("react.provider"),tt=Symbol.for("react.consumer"),Je=Symbol.for("react.context"),$e=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),Ve=Symbol.for("react.suspense_list"),ct=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),Re=Symbol.for("react.activity"),mt=Symbol.for("react.memo_cache_sentinel"),It=Symbol.iterator;function Lt(r){return r===null||typeof r!="object"?null:(r=It&&r[It]||r["@@iterator"],typeof r=="function"?r:null)}var Ut=Symbol.for("react.client.reference");function sn(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Ut?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case ne:return"Fragment";case me:return"Profiler";case ye:return"StrictMode";case Me:return"Suspense";case Ve:return"SuspenseList";case Re:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case Z:return"Portal";case Je:return(r.displayName||"Context")+".Provider";case tt:return(r._context.displayName||"Context")+".Consumer";case $e:var u=r.render;return r=r.displayName,r||(r=u.displayName||u.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ct:return u=r.displayName||null,u!==null?u:sn(r.type)||"Memo";case ot:u=r._payload,r=r._init;try{return sn(r(u))}catch{}}return null}var on=Array.isArray,Ye=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_t={pending:!1,data:null,method:null,action:null},qt=[],Ce=-1;function ut(r){return{current:r}}function wt(r){0>Ce||(r.current=qt[Ce],qt[Ce]=null,Ce--)}function Mt(r,u){Ce++,qt[Ce]=r.current,r.current=u}var Rt=ut(null),Jt=ut(null),Wt=ut(null),Ri=ut(null);function zn(r,u){switch(Mt(Wt,u),Mt(Jt,r),Mt(Rt,null),u.nodeType){case 9:case 11:r=(r=u.documentElement)&&(r=r.namespaceURI)?vy(r):0;break;default:if(r=u.tagName,u=u.namespaceURI)u=vy(u),r=xy(u,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}wt(Rt),Mt(Rt,r)}function Gn(){wt(Rt),wt(Jt),wt(Wt)}function Ca(r){r.memoizedState!==null&&Mt(Ri,r);var u=Rt.current,m=xy(u,r.type);u!==m&&(Mt(Jt,r),Mt(Rt,m))}function Hi(r){Jt.current===r&&(wt(Rt),wt(Jt)),Ri.current===r&&(wt(Ri),oe._currentValue=_t)}var Xa=Object.prototype.hasOwnProperty,Xn=i.unstable_scheduleCallback,br=i.unstable_cancelCallback,Pn=i.unstable_shouldYield,Wa=i.unstable_requestPaint,qn=i.unstable_now,aa=i.unstable_getCurrentPriorityLevel,Or=i.unstable_ImmediatePriority,Yr=i.unstable_UserBlockingPriority,qr=i.unstable_NormalPriority,ol=i.unstable_LowPriority,gs=i.unstable_IdlePriority,Da=i.log,Js=i.unstable_setDisableYieldValue,Hr=null,ci=null;function dr(r){if(typeof Da=="function"&&Js(r),ci&&typeof ci.setStrictMode=="function")try{ci.setStrictMode(Hr,r)}catch{}}var jr=Math.clz32?Math.clz32:Oe,ad=Math.log,Do=Math.LN2;function Oe(r){return r>>>=0,r===0?32:31-(ad(r)/Do|0)|0}var ee=256,ie=4194304;function le(r){var u=r&42;if(u!==0)return u;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ve(r,u,m){var b=r.pendingLanes;if(b===0)return 0;var M=0,z=r.suspendedLanes,X=r.pingedLanes;r=r.warmLanes;var re=b&134217727;return re!==0?(b=re&~z,b!==0?M=le(b):(X&=re,X!==0?M=le(X):m||(m=re&~r,m!==0&&(M=le(m))))):(re=b&~z,re!==0?M=le(re):X!==0?M=le(X):m||(m=b&~r,m!==0&&(M=le(m)))),M===0?0:u!==0&&u!==M&&(u&z)===0&&(z=M&-M,m=u&-u,z>=m||z===32&&(m&4194048)!==0)?u:M}function De(r,u){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&u)===0}function Le(r,u){switch(r){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ze(){var r=ee;return ee<<=1,(ee&4194048)===0&&(ee=256),r}function ze(){var r=ie;return ie<<=1,(ie&62914560)===0&&(ie=4194304),r}function rt(r){for(var u=[],m=0;31>m;m++)u.push(r);return u}function Ke(r,u){r.pendingLanes|=u,u!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function je(r,u,m,b,M,z){var X=r.pendingLanes;r.pendingLanes=m,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=m,r.entangledLanes&=m,r.errorRecoveryDisabledLanes&=m,r.shellSuspendCounter=0;var re=r.entanglements,Se=r.expirationTimes,Xe=r.hiddenUpdates;for(m=X&~m;0<m;){var dt=31-jr(m),vt=1<<dt;re[dt]=0,Se[dt]=-1;var et=Xe[dt];if(et!==null)for(Xe[dt]=null,dt=0;dt<et.length;dt++){var nt=et[dt];nt!==null&&(nt.lane&=-536870913)}m&=~vt}b!==0&&lt(r,b,0),z!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=z&~(X&~u))}function lt(r,u,m){r.pendingLanes|=u,r.suspendedLanes&=~u;var b=31-jr(u);r.entangledLanes|=u,r.entanglements[b]=r.entanglements[b]|1073741824|m&4194090}function Ae(r,u){var m=r.entangledLanes|=u;for(r=r.entanglements;m;){var b=31-jr(m),M=1<<b;M&u|r[b]&u&&(r[b]|=u),m&=~M}}function Dt(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Kt(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Pt(){var r=gt.p;return r!==0?r:(r=window.event,r===void 0?32:Ft(r.type))}function Gt(r,u){var m=gt.p;try{return gt.p=r,u()}finally{gt.p=m}}var Qt=Math.random().toString(36).slice(2),xn="__reactFiber$"+Qt,yn="__reactProps$"+Qt,Dn="__reactContainer$"+Qt,en="__reactEvents$"+Qt,In="__reactListeners$"+Qt,Ir="__reactHandles$"+Qt,St="__reactResources$"+Qt,Ji="__reactMarker$"+Qt;function Si(r){delete r[xn],delete r[yn],delete r[en],delete r[In],delete r[Ir]}function ka(r){var u=r[xn];if(u)return u;for(var m=r.parentNode;m;){if(u=m[Dn]||m[xn]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(r=w0(r);r!==null;){if(m=r[xn])return m;r=w0(r)}return u}r=m,m=r.parentNode}return null}function Qa(r){if(r=r[xn]||r[Dn]){var u=r.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return r}return null}function At(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r.stateNode;throw Error(h(33))}function cn(r){var u=r[St];return u||(u=r[St]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Ht(r){r[Ji]=!0}var ma=new Set,Yu={};function Xr(r,u){un(r,u),un(r+"Capture",u)}function un(r,u){for(Yu[r]=u,r=0;r<u.length;r++)ma.add(u[r])}var ko=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ll={},Xi={};function qu(r){return Xa.call(Xi,r)?!0:Xa.call(ll,r)?!1:ko.test(r)?Xi[r]=!0:(ll[r]=!0,!1)}function cl(r,u,m){if(qu(u))if(m===null)r.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":r.removeAttribute(u);return;case"boolean":var b=u.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){r.removeAttribute(u);return}}r.setAttribute(u,""+m)}}function Ka(r,u,m){if(m===null)r.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttribute(u,""+m)}}function Ia(r,u,m,b){if(b===null)r.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(m);return}r.setAttributeNS(u,m,""+b)}}var sa,zi;function Wl(r){if(sa===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);sa=u&&u[1]||"",zi=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sa+r+zi}var Ql=!1;function $c(r,u){if(!r||Ql)return"";Ql=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(nt){var et=nt}Reflect.construct(r,[],vt)}else{try{vt.call()}catch(nt){et=nt}r.call(vt.prototype)}}else{try{throw Error()}catch(nt){et=nt}(vt=r())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(nt){if(nt&&et&&typeof nt.stack=="string")return[nt.stack,et.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=b.DetermineComponentFrameRoot(),X=z[0],re=z[1];if(X&&re){var Se=X.split(`
`),Xe=re.split(`
`);for(M=b=0;b<Se.length&&!Se[b].includes("DetermineComponentFrameRoot");)b++;for(;M<Xe.length&&!Xe[M].includes("DetermineComponentFrameRoot");)M++;if(b===Se.length||M===Xe.length)for(b=Se.length-1,M=Xe.length-1;1<=b&&0<=M&&Se[b]!==Xe[M];)M--;for(;1<=b&&0<=M;b--,M--)if(Se[b]!==Xe[M]){if(b!==1||M!==1)do if(b--,M--,0>M||Se[b]!==Xe[M]){var dt=`
`+Se[b].replace(" at new "," at ");return r.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",r.displayName)),dt}while(1<=b&&0<=M);break}}}finally{Ql=!1,Error.prepareStackTrace=m}return(m=r?r.displayName||r.name:"")?Wl(m):""}function Kl(r){switch(r.tag){case 26:case 27:case 5:return Wl(r.type);case 16:return Wl("Lazy");case 13:return Wl("Suspense");case 19:return Wl("SuspenseList");case 0:case 15:return $c(r.type,!1);case 11:return $c(r.type.render,!1);case 1:return $c(r.type,!0);case 31:return Wl("Activity");default:return""}}function Io(r){try{var u="";do u+=Kl(r),r=r.return;while(r);return u}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function Ra(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function gf(r){var u=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function $p(r){var u=gf(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,u),b=""+r[u];if(!r.hasOwnProperty(u)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var M=m.get,z=m.set;return Object.defineProperty(r,u,{configurable:!0,get:function(){return M.call(this)},set:function(X){b=""+X,z.call(this,X)}}),Object.defineProperty(r,u,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(X){b=""+X},stopTracking:function(){r._valueTracker=null,delete r[u]}}}}function Ro(r){r._valueTracker||(r._valueTracker=$p(r))}function yf(r){if(!r)return!1;var u=r._valueTracker;if(!u)return!0;var m=u.getValue(),b="";return r&&(b=gf(r)?r.checked?"true":"false":r.value),r=b,r!==m?(u.setValue(r),!0):!1}function Hu(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Xu=/[\n"\\]/g;function Ja(r){return r.replace(Xu,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function sd(r,u,m,b,M,z,X,re){r.name="",X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?r.type=X:r.removeAttribute("type"),u!=null?X==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+Ra(u)):r.value!==""+Ra(u)&&(r.value=""+Ra(u)):X!=="submit"&&X!=="reset"||r.removeAttribute("value"),u!=null?Wu(r,X,Ra(u)):m!=null?Wu(r,X,Ra(m)):b!=null&&r.removeAttribute("value"),M==null&&z!=null&&(r.defaultChecked=!!z),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?r.name=""+Ra(re):r.removeAttribute("name")}function Jl(r,u,m,b,M,z,X,re){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(r.type=z),u!=null||m!=null){if(!(z!=="submit"&&z!=="reset"||u!=null))return;m=m!=null?""+Ra(m):"",u=u!=null?""+Ra(u):m,re||u===r.value||(r.value=u),r.defaultValue=u}b=b??M,b=typeof b!="function"&&typeof b!="symbol"&&!!b,r.checked=re?r.checked:!!b,r.defaultChecked=!!b,X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(r.name=X)}function Wu(r,u,m){u==="number"&&Hu(r.ownerDocument)===r||r.defaultValue===""+m||(r.defaultValue=""+m)}function ul(r,u,m,b){if(r=r.options,u){u={};for(var M=0;M<m.length;M++)u["$"+m[M]]=!0;for(m=0;m<r.length;m++)M=u.hasOwnProperty("$"+r[m].value),r[m].selected!==M&&(r[m].selected=M),M&&b&&(r[m].defaultSelected=!0)}else{for(m=""+Ra(m),u=null,M=0;M<r.length;M++){if(r[M].value===m){r[M].selected=!0,b&&(r[M].defaultSelected=!0);return}u!==null||r[M].disabled||(u=r[M])}u!==null&&(u.selected=!0)}}function _f(r,u,m){if(u!=null&&(u=""+Ra(u),u!==r.value&&(r.value=u),m==null)){r.defaultValue!==u&&(r.defaultValue=u);return}r.defaultValue=m!=null?""+Ra(m):""}function Qu(r,u,m,b){if(u==null){if(b!=null){if(m!=null)throw Error(h(92));if(on(b)){if(1<b.length)throw Error(h(93));b=b[0]}m=b}m==null&&(m=""),u=m}m=Ra(u),r.defaultValue=m,b=r.textContent,b===m&&b!==""&&b!==null&&(r.value=b)}function zo(r,u){if(u){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=u;return}}r.textContent=u}var eo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function En(r,u,m){var b=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="":b?r.setProperty(u,m):typeof m!="number"||m===0||eo.has(u)?u==="float"?r.cssFloat=m:r[u]=(""+m).trim():r[u]=m+"px"}function to(r,u,m){if(u!=null&&typeof u!="object")throw Error(h(62));if(r=r.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||u!=null&&u.hasOwnProperty(b)||(b.indexOf("--")===0?r.setProperty(b,""):b==="float"?r.cssFloat="":r[b]="");for(var M in u)b=u[M],u.hasOwnProperty(M)&&m[M]!==b&&En(r,M,b)}else for(var z in u)u.hasOwnProperty(z)&&En(r,z,u[z])}function ys(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ec=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yc(r){return vf.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var ga=null;function _s(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var mn=null,no=null;function Ku(r){var u=Qa(r);if(u&&(r=u.stateNode)){var m=r[yn]||null;e:switch(r=u.stateNode,u.type){case"input":if(sd(r,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Ja(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var b=m[u];if(b!==r&&b.form===r.form){var M=b[yn]||null;if(!M)throw Error(h(90));sd(b,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(u=0;u<m.length;u++)b=m[u],b.form===r.form&&yf(b)}break e;case"textarea":_f(r,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&ul(r,!!m.multiple,u,!1)}}}var Ju=!1;function Br(r,u,m){if(Ju)return r(u,m);Ju=!0;try{var b=r(u);return b}finally{if(Ju=!1,(mn!==null||no!==null)&&(sr(),mn&&(u=mn,r=no,no=mn=null,Ku(u),r)))for(u=0;u<r.length;u++)Ku(r[u])}}function Li(r,u){var m=r.stateNode;if(m===null)return null;var b=m[yn]||null;if(b===null)return null;m=b[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(r=r.type,b=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!b;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(h(231,u,typeof m));return m}var Oi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fr=!1;if(Oi)try{var ui={};Object.defineProperty(ui,"passive",{get:function(){fr=!0}}),window.addEventListener("test",ui,ui),window.removeEventListener("test",ui,ui)}catch{fr=!1}var vs=null,Cn=null,Fr=null;function hn(){if(Fr)return Fr;var r,u=Cn,m=u.length,b,M="value"in vs?vs.value:vs.textContent,z=M.length;for(r=0;r<m&&u[r]===M[r];r++);var X=m-r;for(b=1;b<=X&&u[m-b]===M[z-b];b++);return Fr=M.slice(r,1<b?1-b:void 0)}function fn(r){var u=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&u===13&&(r=13)):r=u,r===10&&(r=13),32<=r||r===13?r:0}function io(){return!0}function tn(){return!1}function pr(r){function u(m,b,M,z,X){this._reactName=m,this._targetInst=M,this.type=b,this.nativeEvent=z,this.target=X,this.currentTarget=null;for(var re in r)r.hasOwnProperty(re)&&(m=r[re],this[re]=m?m(z):z[re]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?io:tn,this.isPropagationStopped=tn,this}return P(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=io)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=io)},persist:function(){},isPersistent:io}),u}var er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},No=pr(er),Wr=P({},er,{view:0,detail:0}),xf=pr(Wr),es,od,qc,hl=P({},Wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ur,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==qc&&(qc&&r.type==="mousemove"?(es=r.screenX-qc.screenX,od=r.screenY-qc.screenY):od=es=0,qc=r),es)},movementY:function(r){return"movementY"in r?r.movementY:od}}),Hc=pr(hl),xs=P({},hl,{dataTransfer:0}),Rr=pr(xs),Xc=P({},Wr,{relatedTarget:0}),tc=pr(Xc),Wc=P({},er,{animationName:0,elapsedTime:0,pseudoElement:0}),mr=pr(Wc),eh=P({},er,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Qc=pr(eh),Kc=P({},er,{data:0}),Yp=pr(Kc),dl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},th={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bg(r){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(r):(r=bf[r])?!!u[r]:!1}function Ur(){return bg}var Jc=P({},Wr,{key:function(r){if(r.key){var u=dl[r.key]||r.key;if(u!=="Unidentified")return u}return r.type==="keypress"?(r=fn(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?th[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ur,charCode:function(r){return r.type==="keypress"?fn(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?fn(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),za=pr(Jc),ya=P({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ld=pr(ya),nh=P({},Wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ur}),eu=pr(nh),wf=P({},er,{propertyName:0,elapsedTime:0,pseudoElement:0}),wg=pr(wf),Tg=P({},hl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Sg=pr(Tg),Eg=P({},er,{newState:0,oldState:0}),cd=pr(Eg),ud=[9,13,27,32],tu=Oi&&"CompositionEvent"in window,Po=null;Oi&&"documentMode"in document&&(Po=document.documentMode);var Tf=Oi&&"TextEvent"in window&&!Po,ih=Oi&&(!tu||Po&&8<Po&&11>=Po),bs=" ",qp=!1;function hd(r,u){switch(r){case"keyup":return ud.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nu(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ro=!1;function Hp(r,u){switch(r){case"compositionend":return nu(u);case"keypress":return u.which!==32?null:(qp=!0,bs);case"textInput":return r=u.data,r===bs&&qp?null:r;default:return null}}function rh(r,u){if(ro)return r==="compositionend"||!tu&&hd(r,u)?(r=hn(),Fr=Cn=vs=null,ro=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return ih&&u.locale!=="ko"?null:u.data;default:return null}}var Xp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nc(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u==="input"?!!Xp[r.type]:u==="textarea"}function Wp(r,u,m,b){mn?no?no.push(b):no=[b]:mn=b,u=dp(u,"onChange"),0<u.length&&(m=new No("onChange","change",null,m,b),r.push({event:m,listeners:u}))}var iu=null,ah=null;function dd(r){y0(r,0)}function ru(r){var u=At(r);if(yf(u))return r}function Sf(r,u){if(r==="change")return u}var Ef=!1;if(Oi){var sh;if(Oi){var oh="oninput"in document;if(!oh){var fl=document.createElement("div");fl.setAttribute("oninput","return;"),oh=typeof fl.oninput=="function"}sh=oh}else sh=!1;Ef=sh&&(!document.documentMode||9<document.documentMode)}function Af(){iu&&(iu.detachEvent("onpropertychange",fd),ah=iu=null)}function fd(r){if(r.propertyName==="value"&&ru(ah)){var u=[];Wp(u,ah,r,_s(r)),Br(dd,u)}}function au(r,u,m){r==="focusin"?(Af(),iu=u,ah=m,iu.attachEvent("onpropertychange",fd)):r==="focusout"&&Af()}function Ag(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ru(ah)}function pd(r,u){if(r==="click")return ru(u)}function Mg(r,u){if(r==="input"||r==="change")return ru(u)}function Qp(r,u){return r===u&&(r!==0||1/r===1/u)||r!==r&&u!==u}var _a=typeof Object.is=="function"?Object.is:Qp;function su(r,u){if(_a(r,u))return!0;if(typeof r!="object"||r===null||typeof u!="object"||u===null)return!1;var m=Object.keys(r),b=Object.keys(u);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var M=m[b];if(!Xa.call(u,M)||!_a(r[M],u[M]))return!1}return!0}function Mf(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function md(r,u){var m=Mf(r);r=0;for(var b;m;){if(m.nodeType===3){if(b=r+m.textContent.length,r<=u&&b>=u)return{node:m,offset:u-r};r=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=Mf(m)}}function Zn(r,u){return r&&u?r===u?!0:r&&r.nodeType===3?!1:u&&u.nodeType===3?Zn(r,u.parentNode):"contains"in r?r.contains(u):r.compareDocumentPosition?!!(r.compareDocumentPosition(u)&16):!1:!1}function lh(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var u=Hu(r.document);u instanceof r.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)r=u.contentWindow;else break;u=Hu(r.document)}return u}function ws(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u&&(u==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||u==="textarea"||r.contentEditable==="true")}var Cf=Oi&&"documentMode"in document&&11>=document.documentMode,pl=null,ch=null,ou=null,uh=!1;function ml(r,u,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;uh||pl==null||pl!==Hu(b)||(b=pl,"selectionStart"in b&&ws(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),ou&&su(ou,b)||(ou=b,b=dp(ch,"onSelect"),0<b.length&&(u=new No("onSelect","select",null,u,m),r.push({event:u,listeners:b}),u.target=pl)))}function Lo(r,u){var m={};return m[r.toLowerCase()]=u.toLowerCase(),m["Webkit"+r]="webkit"+u,m["Moz"+r]="moz"+u,m}var lu={animationend:Lo("Animation","AnimationEnd"),animationiteration:Lo("Animation","AnimationIteration"),animationstart:Lo("Animation","AnimationStart"),transitionrun:Lo("Transition","TransitionRun"),transitionstart:Lo("Transition","TransitionStart"),transitioncancel:Lo("Transition","TransitionCancel"),transitionend:Lo("Transition","TransitionEnd")},Df={},Kp={};Oi&&(Kp=document.createElement("div").style,"AnimationEvent"in window||(delete lu.animationend.animation,delete lu.animationiteration.animation,delete lu.animationstart.animation),"TransitionEvent"in window||delete lu.transitionend.transition);function ic(r){if(Df[r])return Df[r];if(!lu[r])return r;var u=lu[r],m;for(m in u)if(u.hasOwnProperty(m)&&m in Kp)return Df[r]=u[m];return r}var kf=ic("animationend"),Jp=ic("animationiteration"),If=ic("animationstart"),gd=ic("transitionrun"),yd=ic("transitionstart"),_d=ic("transitioncancel"),vd=ic("transitionend"),gl=new Map,rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rc.push("scrollEnd");function Qr(r,u){gl.set(r,u),Xr(u,[r])}var Na=new WeakMap;function Pa(r,u){if(typeof r=="object"&&r!==null){var m=Na.get(r);return m!==void 0?m:(u={value:r,source:u,stack:Io(u)},Na.set(r,u),u)}return{value:r,source:u,stack:Io(u)}}var La=[],yl=0,Oo=0;function ac(){for(var r=yl,u=Oo=yl=0;u<r;){var m=La[u];La[u++]=null;var b=La[u];La[u++]=null;var M=La[u];La[u++]=null;var z=La[u];if(La[u++]=null,b!==null&&M!==null){var X=b.pending;X===null?M.next=M:(M.next=X.next,X.next=M),b.pending=M}z!==0&&Rf(m,M,z)}}function sc(r,u,m,b){La[yl++]=r,La[yl++]=u,La[yl++]=m,La[yl++]=b,Oo|=b,r.lanes|=b,r=r.alternate,r!==null&&(r.lanes|=b)}function oc(r,u,m,b){return sc(r,u,m,b),jo(r)}function Ts(r,u){return sc(r,null,null,u),jo(r)}function Rf(r,u,m){r.lanes|=m;var b=r.alternate;b!==null&&(b.lanes|=m);for(var M=!1,z=r.return;z!==null;)z.childLanes|=m,b=z.alternate,b!==null&&(b.childLanes|=m),z.tag===22&&(r=z.stateNode,r===null||r._visibility&1||(M=!0)),r=z,z=z.return;return r.tag===3?(z=r.stateNode,M&&u!==null&&(M=31-jr(m),r=z.hiddenUpdates,b=r[M],b===null?r[M]=[u]:b.push(u),u.lane=m|536870912),z):null}function jo(r){if(50<ap)throw ap=0,Kg=null,Error(h(185));for(var u=r.return;u!==null;)r=u,u=r.return;return r.tag===3?r.stateNode:null}var Ss={};function zf(r,u,m,b){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oa(r,u,m,b){return new zf(r,u,m,b)}function bn(r){return r=r.prototype,!(!r||!r.isReactComponent)}function la(r,u){var m=r.alternate;return m===null?(m=oa(r.tag,u,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=u,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&65011712,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,u=r.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m.refCleanup=r.refCleanup,m}function Nf(r,u){r.flags&=65011714;var m=r.alternate;return m===null?(r.childLanes=0,r.lanes=u,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=m.childLanes,r.lanes=m.lanes,r.child=m.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=m.memoizedProps,r.memoizedState=m.memoizedState,r.updateQueue=m.updateQueue,r.type=m.type,u=m.dependencies,r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),r}function hh(r,u,m,b,M,z){var X=0;if(b=r,typeof r=="function")bn(r)&&(X=1);else if(typeof r=="string")X=S(r,m,Rt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Re:return r=oa(31,m,u,M),r.elementType=Re,r.lanes=z,r;case ne:return Es(m.children,M,z,u);case ye:X=8,M|=24;break;case me:return r=oa(12,m,u,M|2),r.elementType=me,r.lanes=z,r;case Me:return r=oa(13,m,u,M),r.elementType=Me,r.lanes=z,r;case Ve:return r=oa(19,m,u,M),r.elementType=Ve,r.lanes=z,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Pe:case Je:X=10;break e;case tt:X=9;break e;case $e:X=11;break e;case ct:X=14;break e;case ot:X=16,b=null;break e}X=29,m=Error(h(130,r===null?"null":typeof r,"")),b=null}return u=oa(X,m,u,M),u.elementType=r,u.type=b,u.lanes=z,u}function Es(r,u,m,b){return r=oa(7,r,b,u),r.lanes=m,r}function Pf(r,u,m){return r=oa(6,r,null,u),r.lanes=m,r}function Lf(r,u,m){return u=oa(4,r.children!==null?r.children:[],r.key,u),u.lanes=m,u.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},u}var lc=[],cc=0,uc=null,hc=0,ca=[],Kr=0,ao=null,As=1,Oa="";function ts(r,u){lc[cc++]=hc,lc[cc++]=uc,uc=r,hc=u}function dc(r,u,m){ca[Kr++]=As,ca[Kr++]=Oa,ca[Kr++]=ao,ao=r;var b=As;r=Oa;var M=32-jr(b)-1;b&=~(1<<M),m+=1;var z=32-jr(u)+M;if(30<z){var X=M-M%5;z=(b&(1<<X)-1).toString(32),b>>=X,M-=X,As=1<<32-jr(u)+M|m<<M|b,Oa=z+r}else As=1<<z|m<<M|b,Oa=r}function fc(r){r.return!==null&&(ts(r,1),dc(r,1,0))}function dh(r){for(;r===uc;)uc=lc[--cc],lc[cc]=null,hc=lc[--cc],lc[cc]=null;for(;r===ao;)ao=ca[--Kr],ca[Kr]=null,Oa=ca[--Kr],ca[Kr]=null,As=ca[--Kr],ca[Kr]=null}var Wi=null,Qi=null,Wn=!1,so=null,ns=!1,xd=Error(h(519));function _l(r){var u=Error(h(418,""));throw is(Pa(u,r)),xd}function cu(r){var u=r.stateNode,m=r.type,b=r.memoizedProps;switch(u[xn]=r,u[yn]=b,m){case"dialog":Fn("cancel",u),Fn("close",u);break;case"iframe":case"object":case"embed":Fn("load",u);break;case"video":case"audio":for(m=0;m<hp.length;m++)Fn(hp[m],u);break;case"source":Fn("error",u);break;case"img":case"image":case"link":Fn("error",u),Fn("load",u);break;case"details":Fn("toggle",u);break;case"input":Fn("invalid",u),Jl(u,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0),Ro(u);break;case"select":Fn("invalid",u);break;case"textarea":Fn("invalid",u),Qu(u,b.value,b.defaultValue,b.children),Ro(u)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||b.suppressHydrationWarning===!0||qd(u.textContent,m)?(b.popover!=null&&(Fn("beforetoggle",u),Fn("toggle",u)),b.onScroll!=null&&Fn("scroll",u),b.onScrollEnd!=null&&Fn("scrollend",u),b.onClick!=null&&(u.onclick=fp),u=!0):u=!1,u||_l(r)}function fh(r){for(Wi=r.return;Wi;)switch(Wi.tag){case 5:case 13:ns=!1;return;case 27:case 3:ns=!0;return;default:Wi=Wi.return}}function vl(r){if(r!==Wi)return!1;if(!Wn)return fh(r),Wn=!0,!1;var u=r.tag,m;if((m=u!==3&&u!==27)&&((m=u===5)&&(m=r.type,m=!(m!=="form"&&m!=="button")||by(r.type,r.memoizedProps)),m=!m),m&&Qi&&_l(r),fh(r),u===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(h(317));e:{for(r=r.nextSibling,u=0;r;){if(r.nodeType===8)if(m=r.data,m==="/$"){if(u===0){Qi=us(r.nextSibling);break e}u--}else m!=="$"&&m!=="$!"&&m!=="$?"||u++;r=r.nextSibling}Qi=null}}else u===27?(u=Qi,Eu(r.type)?(r=Ey,Ey=null,Qi=r):Qi=u):Qi=Wi?us(r.stateNode.nextSibling):null;return!0}function uu(){Qi=Wi=null,Wn=!1}function ji(){var r=so;return r!==null&&(ls===null?ls=r:ls.push.apply(ls,r),so=null),r}function is(r){so===null?so=[r]:so.push(r)}var va=ut(null),oo=null,ja=null;function Ba(r,u,m){Mt(va,u._currentValue),u._currentValue=m}function xa(r){r._currentValue=va.current,wt(va)}function ph(r,u,m){for(;r!==null;){var b=r.alternate;if((r.childLanes&u)!==u?(r.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),r===m)break;r=r.return}}function pc(r,u,m,b){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var z=M.dependencies;if(z!==null){var X=M.child;z=z.firstContext;e:for(;z!==null;){var re=z;z=M;for(var Se=0;Se<u.length;Se++)if(re.context===u[Se]){z.lanes|=m,re=z.alternate,re!==null&&(re.lanes|=m),ph(z.return,m,r),b||(X=null);break e}z=re.next}}else if(M.tag===18){if(X=M.return,X===null)throw Error(h(341));X.lanes|=m,z=X.alternate,z!==null&&(z.lanes|=m),ph(X,m,r),X=null}else X=M.child;if(X!==null)X.return=M;else for(X=M;X!==null;){if(X===r){X=null;break}if(M=X.sibling,M!==null){M.return=X.return,X=M;break}X=X.return}M=X}}function mc(r,u,m,b){r=null;for(var M=u,z=!1;M!==null;){if(!z){if((M.flags&524288)!==0)z=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var X=M.alternate;if(X===null)throw Error(h(387));if(X=X.memoizedProps,X!==null){var re=M.type;_a(M.pendingProps.value,X.value)||(r!==null?r.push(re):r=[re])}}else if(M===Ri.current){if(X=M.alternate,X===null)throw Error(h(387));X.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push(oe):r=[oe])}M=M.return}r!==null&&pc(u,r,m,b),u.flags|=262144}function mh(r){for(r=r.firstContext;r!==null;){if(!_a(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function xl(r){oo=r,ja=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function tr(r){return ua(oo,r)}function Bo(r,u){return oo===null&&xl(r),ua(r,u)}function ua(r,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},ja===null){if(r===null)throw Error(h(308));ja=u,r.dependencies={lanes:0,firstContext:u},r.flags|=524288}else ja=ja.next=u;return m}var Ms=typeof AbortController<"u"?AbortController:function(){var r=[],u=this.signal={aborted:!1,addEventListener:function(m,b){r.push(b)}};this.abort=function(){u.aborted=!0,r.forEach(function(m){return m()})}},Of=i.unstable_scheduleCallback,em=i.unstable_NormalPriority,gr={$$typeof:Je,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function bl(){return{controller:new Ms,data:new Map,refCount:0}}function gc(r){r.refCount--,r.refCount===0&&Of(em,function(){r.controller.abort()})}var wl=null,bd=0,Fo=0,Uo=null;function hu(r,u){if(wl===null){var m=wl=[];bd=0,Fo=Tu(),Uo={status:"pending",value:void 0,then:function(b){m.push(b)}}}return bd++,u.then(Fa,Fa),u}function Fa(){if(--bd===0&&wl!==null){Uo!==null&&(Uo.status="fulfilled");var r=wl;wl=null,Fo=0,Uo=null;for(var u=0;u<r.length;u++)(0,r[u])()}}function Cs(r,u){var m=[],b={status:"pending",value:null,reason:null,then:function(M){m.push(M)}};return r.then(function(){b.status="fulfilled",b.value=u;for(var M=0;M<m.length;M++)(0,m[M])(u)},function(M){for(b.status="rejected",b.reason=M,M=0;M<m.length;M++)(0,m[M])(void 0)}),b}var jf=Ye.S;Ye.S=function(r,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&hu(r,u),jf!==null&&jf(r,u)};var nr=ut(null);function Tl(){var r=nr.current;return r!==null?r:di.pooledCache}function wd(r,u){u===null?Mt(nr,nr.current):Mt(nr,u.pool)}function gh(){var r=Tl();return r===null?null:{parent:gr._currentValue,pool:r}}var yh=Error(h(460)),Td=Error(h(474)),Sl=Error(h(542)),El={then:function(){}};function Ds(r){return r=r.status,r==="fulfilled"||r==="rejected"}function zt(){}function Sd(r,u,m){switch(m=r[m],m===void 0?r.push(u):m!==u&&(u.then(zt,zt),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,du(r),r;default:if(typeof u.status=="string")u.then(zt,zt);else{if(r=di,r!==null&&100<r.shellSuspendCounter)throw Error(h(482));r=u,r.status="pending",r.then(function(b){if(u.status==="pending"){var M=u;M.status="fulfilled",M.value=b}},function(b){if(u.status==="pending"){var M=u;M.status="rejected",M.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,du(r),r}throw Vo=u,yh}}var Vo=null;function Ed(){if(Vo===null)throw Error(h(459));var r=Vo;return Vo=null,r}function du(r){if(r===yh||r===Sl)throw Error(h(483))}var Ua=!1;function _h(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wn(r,u){r=r.updateQueue,u.updateQueue===r&&(u.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function lo(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Go(r,u,m){var b=r.updateQueue;if(b===null)return null;if(b=b.shared,(hi&2)!==0){var M=b.pending;return M===null?u.next=u:(u.next=M.next,M.next=u),b.pending=u,u=jo(r),Rf(r,null,m),u}return sc(r,b,u,m),jo(r)}function Al(r,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194048)!==0)){var b=u.lanes;b&=r.pendingLanes,m|=b,u.lanes=m,Ae(r,m)}}function Bf(r,u){var m=r.updateQueue,b=r.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var M=null,z=null;if(m=m.firstBaseUpdate,m!==null){do{var X={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};z===null?M=z=X:z=z.next=X,m=m.next}while(m!==null);z===null?M=z=u:z=z.next=u}else M=z=u;m={baseState:b.baseState,firstBaseUpdate:M,lastBaseUpdate:z,shared:b.shared,callbacks:b.callbacks},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=u:r.next=u,m.lastBaseUpdate=u}var Ff=!1;function yc(){if(Ff){var r=Uo;if(r!==null)throw r}}function Ml(r,u,m,b){Ff=!1;var M=r.updateQueue;Ua=!1;var z=M.firstBaseUpdate,X=M.lastBaseUpdate,re=M.shared.pending;if(re!==null){M.shared.pending=null;var Se=re,Xe=Se.next;Se.next=null,X===null?z=Xe:X.next=Xe,X=Se;var dt=r.alternate;dt!==null&&(dt=dt.updateQueue,re=dt.lastBaseUpdate,re!==X&&(re===null?dt.firstBaseUpdate=Xe:re.next=Xe,dt.lastBaseUpdate=Se))}if(z!==null){var vt=M.baseState;X=0,dt=Xe=Se=null,re=z;do{var et=re.lane&-536870913,nt=et!==re.lane;if(nt?($n&et)===et:(b&et)===et){et!==0&&et===Fo&&(Ff=!0),dt!==null&&(dt=dt.next={lane:0,tag:re.tag,payload:re.payload,callback:null,next:null});e:{var rn=r,ln=re;et=u;var bi=m;switch(ln.tag){case 1:if(rn=ln.payload,typeof rn=="function"){vt=rn.call(bi,vt,et);break e}vt=rn;break e;case 3:rn.flags=rn.flags&-65537|128;case 0:if(rn=ln.payload,et=typeof rn=="function"?rn.call(bi,vt,et):rn,et==null)break e;vt=P({},vt,et);break e;case 2:Ua=!0}}et=re.callback,et!==null&&(r.flags|=64,nt&&(r.flags|=8192),nt=M.callbacks,nt===null?M.callbacks=[et]:nt.push(et))}else nt={lane:et,tag:re.tag,payload:re.payload,callback:re.callback,next:null},dt===null?(Xe=dt=nt,Se=vt):dt=dt.next=nt,X|=et;if(re=re.next,re===null){if(re=M.shared.pending,re===null)break;nt=re,re=nt.next,nt.next=null,M.lastBaseUpdate=nt,M.shared.pending=null}}while(!0);dt===null&&(Se=vt),M.baseState=Se,M.firstBaseUpdate=Xe,M.lastBaseUpdate=dt,z===null&&(M.shared.lanes=0),bu|=X,r.lanes=X,r.memoizedState=vt}}function Ad(r,u){if(typeof r!="function")throw Error(h(191,r));r.call(u)}function Uf(r,u){var m=r.callbacks;if(m!==null)for(r.callbacks=null,r=0;r<m.length;r++)Ad(m[r],u)}var co=ut(null),Md=ut(0);function Cd(r,u){r=Nl,Mt(Md,r),Mt(co,u),Nl=r|u.baseLanes}function uo(){Mt(Md,Nl),Mt(co,co.current)}function pi(){Nl=Md.current,wt(co),wt(Md)}var rs=0,Tn=null,ei=null,ir=null,vh=!1,fu=!1,Jr=!1,_c=0,Ot=0,Zt=null,Dd=0;function Ui(){throw Error(h(321))}function vc(r,u){if(u===null)return!1;for(var m=0;m<u.length&&m<r.length;m++)if(!_a(r[m],u[m]))return!1;return!0}function Vr(r,u,m,b,M,z){return rs=z,Tn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Ye.H=r===null||r.memoizedState===null?os:qo,Jr=!1,z=m(b,M),Jr=!1,fu&&(z=zr(u,m,b,M)),Vf(r),z}function Vf(r){Ye.H=Zr;var u=ei!==null&&ei.next!==null;if(rs=0,ir=ei=Tn=null,vh=!1,Ot=0,Zt=null,u)throw Error(h(300));r===null||ta||(r=r.dependencies,r!==null&&mh(r)&&(ta=!0))}function zr(r,u,m,b){Tn=r;var M=0;do{if(fu&&(Zt=null),Ot=0,fu=!1,25<=M)throw Error(h(301));if(M+=1,ir=ei=null,r.updateQueue!=null){var z=r.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}Ye.H=Tc,z=u(m,b)}while(fu);return z}function tm(){var r=Ye.H,u=r.useState()[0];return u=typeof u.then=="function"?xc(u):u,r=r.useState()[0],(ei!==null?ei.memoizedState:null)!==r&&(Tn.flags|=1024),u}function Zo(){var r=_c!==0;return _c=0,r}function Ei(r,u,m){u.updateQueue=r.updateQueue,u.flags&=-2053,r.lanes&=~m}function Ni(r){if(vh){for(r=r.memoizedState;r!==null;){var u=r.queue;u!==null&&(u.pending=null),r=r.next}vh=!1}rs=0,ir=ei=Tn=null,fu=!1,Ot=_c=0,Zt=null}function ha(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ir===null?Tn.memoizedState=ir=r:ir=ir.next=r,ir}function mi(){if(ei===null){var r=Tn.alternate;r=r!==null?r.memoizedState:null}else r=ei.next;var u=ir===null?Tn.memoizedState:ir.next;if(u!==null)ir=u,ei=r;else{if(r===null)throw Tn.alternate===null?Error(h(467)):Error(h(310));ei=r,r={memoizedState:ei.memoizedState,baseState:ei.baseState,baseQueue:ei.baseQueue,queue:ei.queue,next:null},ir===null?Tn.memoizedState=ir=r:ir=ir.next=r}return ir}function ho(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xc(r){var u=Ot;return Ot+=1,Zt===null&&(Zt=[]),r=Sd(Zt,r,u),u=Tn,(ir===null?u.memoizedState:ir.next)===null&&(u=u.alternate,Ye.H=u===null||u.memoizedState===null?os:qo),r}function bc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return xc(r);if(r.$$typeof===Je)return tr(r)}throw Error(h(438,String(r)))}function $o(r){var u=null,m=Tn.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var b=Tn.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(M){return M.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=ho(),Tn.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(r),b=0;b<r;b++)m[b]=mt;return u.index++,m}function Va(r,u){return typeof u=="function"?u(r):u}function pu(r){var u=mi();return mu(u,ei,r)}function mu(r,u,m){var b=r.queue;if(b===null)throw Error(h(311));b.lastRenderedReducer=m;var M=r.baseQueue,z=b.pending;if(z!==null){if(M!==null){var X=M.next;M.next=z.next,z.next=X}u.baseQueue=M=z,b.pending=null}if(z=r.baseState,M===null)r.memoizedState=z;else{u=M.next;var re=X=null,Se=null,Xe=u,dt=!1;do{var vt=Xe.lane&-536870913;if(vt!==Xe.lane?($n&vt)===vt:(rs&vt)===vt){var et=Xe.revertLane;if(et===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null}),vt===Fo&&(dt=!0);else if((rs&et)===et){Xe=Xe.next,et===Fo&&(dt=!0);continue}else vt={lane:0,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},Se===null?(re=Se=vt,X=z):Se=Se.next=vt,Tn.lanes|=et,bu|=et;vt=Xe.action,Jr&&m(z,vt),z=Xe.hasEagerState?Xe.eagerState:m(z,vt)}else et={lane:vt,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},Se===null?(re=Se=et,X=z):Se=Se.next=et,Tn.lanes|=vt,bu|=vt;Xe=Xe.next}while(Xe!==null&&Xe!==u);if(Se===null?X=z:Se.next=re,!_a(z,r.memoizedState)&&(ta=!0,dt&&(m=Uo,m!==null)))throw m;r.memoizedState=z,r.baseState=X,r.baseQueue=Se,b.lastRenderedState=z}return M===null&&(b.lanes=0),[r.memoizedState,b.dispatch]}function xh(r){var u=mi(),m=u.queue;if(m===null)throw Error(h(311));m.lastRenderedReducer=r;var b=m.dispatch,M=m.pending,z=u.memoizedState;if(M!==null){m.pending=null;var X=M=M.next;do z=r(z,X.action),X=X.next;while(X!==M);_a(z,u.memoizedState)||(ta=!0),u.memoizedState=z,u.baseQueue===null&&(u.baseState=z),m.lastRenderedState=z}return[z,b]}function x(r,u,m){var b=Tn,M=mi(),z=Wn;if(z){if(m===void 0)throw Error(h(407));m=m()}else m=u();var X=!_a((ei||M).memoizedState,m);X&&(M.memoizedState=m,ta=!0),M=M.queue;var re=f.bind(null,b,M,r);if(Ie(2048,8,re,[r]),M.getSnapshot!==u||X||ir!==null&&ir.memoizedState.tag&1){if(b.flags|=2048,ge(9,Te(),s.bind(null,b,M,m,u),null),di===null)throw Error(h(349));z||(rs&124)!==0||e(b,u,m)}return m}function e(r,u,m){r.flags|=16384,r={getSnapshot:u,value:m},u=Tn.updateQueue,u===null?(u=ho(),Tn.updateQueue=u,u.stores=[r]):(m=u.stores,m===null?u.stores=[r]:m.push(r))}function s(r,u,m,b){u.value=m,u.getSnapshot=b,g(u)&&w(r)}function f(r,u,m){return m(function(){g(u)&&w(r)})}function g(r){var u=r.getSnapshot;r=r.value;try{var m=u();return!_a(r,m)}catch{return!0}}function w(r){var u=Ts(r,2);u!==null&&zs(u,r,2)}function E(r){var u=ha();if(typeof r=="function"){var m=r;if(r=m(),Jr){dr(!0);try{m()}finally{dr(!1)}}}return u.memoizedState=u.baseState=r,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:r},u}function C(r,u,m,b){return r.baseState=m,mu(r,ei,typeof b=="function"?b:Va)}function R(r,u,m,b,M){if(Dl(r))throw Error(h(485));if(r=u.action,r!==null){var z={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){z.listeners.push(X)}};Ye.T!==null?m(!0):z.isTransition=!1,b(z),m=u.pending,m===null?(z.next=u.pending=z,L(u,z)):(z.next=m.next,u.pending=m.next=z)}}function L(r,u){var m=u.action,b=u.payload,M=r.state;if(u.isTransition){var z=Ye.T,X={};Ye.T=X;try{var re=m(M,b),Se=Ye.S;Se!==null&&Se(X,re),j(r,u,re)}catch(Xe){V(r,u,Xe)}finally{Ye.T=z}}else try{z=m(M,b),j(r,u,z)}catch(Xe){V(r,u,Xe)}}function j(r,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){G(r,u,b)},function(b){return V(r,u,b)}):G(r,u,m)}function G(r,u,m){u.status="fulfilled",u.value=m,Y(u),r.state=m,u=r.pending,u!==null&&(m=u.next,m===u?r.pending=null:(m=m.next,u.next=m,L(r,m)))}function V(r,u,m){var b=r.pending;if(r.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=m,Y(u),u=u.next;while(u!==b)}r.action=null}function Y(r){r=r.listeners;for(var u=0;u<r.length;u++)(0,r[u])()}function K(r,u){return u}function ue(r,u){if(Wn){var m=di.formState;if(m!==null){e:{var b=Tn;if(Wn){if(Qi){t:{for(var M=Qi,z=ns;M.nodeType!==8;){if(!z){M=null;break t}if(M=us(M.nextSibling),M===null){M=null;break t}}z=M.data,M=z==="F!"||z==="F"?M:null}if(M){Qi=us(M.nextSibling),b=M.data==="F!";break e}}_l(b)}b=!1}b&&(u=m[0])}}return m=ha(),m.memoizedState=m.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:K,lastRenderedState:u},m.queue=b,m=Yo.bind(null,Tn,b),b.dispatch=m,b=E(!1),z=ss.bind(null,Tn,!1,b.queue),b=ha(),M={state:u,dispatch:null,action:r,pending:null},b.queue=M,m=R.bind(null,Tn,M,z,m),M.dispatch=m,b.memoizedState=r,[u,m,!1]}function ce(r){var u=mi();return de(u,ei,r)}function de(r,u,m){if(u=mu(r,u,K)[0],r=pu(Va)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=xc(u)}catch(X){throw X===yh?Sl:X}else b=u;u=mi();var M=u.queue,z=M.dispatch;return m!==u.memoizedState&&(Tn.flags|=2048,ge(9,Te(),pe.bind(null,M,m),null)),[b,z,r]}function pe(r,u){r.action=u}function be(r){var u=mi(),m=ei;if(m!==null)return de(u,m,r);mi(),u=u.memoizedState,m=mi();var b=m.queue.dispatch;return m.memoizedState=r,[u,b,!1]}function ge(r,u,m,b){return r={tag:r,create:m,deps:b,inst:u,next:null},u=Tn.updateQueue,u===null&&(u=ho(),Tn.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=r.next=r:(b=m.next,m.next=r,r.next=b,u.lastEffect=r),r}function Te(){return{destroy:void 0,resource:void 0}}function Ee(){return mi().memoizedState}function _e(r,u,m,b){var M=ha();b=b===void 0?null:b,Tn.flags|=r,M.memoizedState=ge(1|u,Te(),m,b)}function Ie(r,u,m,b){var M=mi();b=b===void 0?null:b;var z=M.memoizedState.inst;ei!==null&&b!==null&&vc(b,ei.memoizedState.deps)?M.memoizedState=ge(u,z,m,b):(Tn.flags|=r,M.memoizedState=ge(1|u,z,m,b))}function qe(r,u){_e(8390656,8,r,u)}function Fe(r,u){Ie(2048,8,r,u)}function Ue(r,u){return Ie(4,2,r,u)}function We(r,u){return Ie(4,4,r,u)}function Ct(r,u){if(typeof u=="function"){r=r();var m=u(r);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return r=r(),u.current=r,function(){u.current=null}}function Et(r,u,m){m=m!=null?m.concat([r]):null,Ie(4,4,Ct.bind(null,u,r),m)}function ft(){}function Bt(r,u){var m=mi();u=u===void 0?null:u;var b=m.memoizedState;return u!==null&&vc(u,b[1])?b[0]:(m.memoizedState=[r,u],r)}function gn(r,u){var m=mi();u=u===void 0?null:u;var b=m.memoizedState;if(u!==null&&vc(u,b[1]))return b[0];if(b=r(),Jr){dr(!0);try{r()}finally{dr(!1)}}return m.memoizedState=[b,u],b}function jn(r,u,m){return m===void 0||(rs&1073741824)!==0?r.memoizedState=u:(r.memoizedState=m,r=o0(),Tn.lanes|=r,bu|=r,m)}function Pi(r,u,m,b){return _a(m,u)?m:co.current!==null?(r=jn(r,m,b),_a(r,u)||(ta=!0),r):(rs&42)===0?(ta=!0,r.memoizedState=m):(r=o0(),Tn.lanes|=r,bu|=r,u)}function ti(r,u,m,b,M){var z=gt.p;gt.p=z!==0&&8>z?z:8;var X=Ye.T,re={};Ye.T=re,ss(r,!1,u,m);try{var Se=M(),Xe=Ye.S;if(Xe!==null&&Xe(re,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var dt=Cs(Se,b);as(r,u,dt,cs(r))}else as(r,u,b,cs(r))}catch(vt){as(r,u,{then:function(){},status:"rejected",reason:vt},cs())}finally{gt.p=z,Ye.T=X}}function Bi(){}function ni(r,u,m,b){if(r.tag!==5)throw Error(h(476));var M=ii(r).queue;ti(r,M,u,_t,m===null?Bi:function(){return oi(r),m(b)})}function ii(r){var u=r.memoizedState;if(u!==null)return u;u={memoizedState:_t,baseState:_t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:_t},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:m},next:null},r.memoizedState=u,r=r.alternate,r!==null&&(r.memoizedState=u),u}function oi(r){var u=ii(r).next.queue;as(r,u,{},cs())}function wr(){return tr(oe)}function Rn(){return mi().memoizedState}function Tr(){return mi().memoizedState}function Gr(r){for(var u=r.return;u!==null;){switch(u.tag){case 24:case 3:var m=cs();r=lo(m);var b=Go(u,r,m);b!==null&&(zs(b,u,m),Al(b,u,m)),u={cache:bl()},r.payload=u;return}u=u.return}}function Cl(r,u,m){var b=cs();m={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},Dl(r)?gu(u,m):(m=oc(r,u,m,b),m!==null&&(zs(m,r,b),wc(m,u,b)))}function Yo(r,u,m){var b=cs();as(r,u,m,b)}function as(r,u,m,b){var M={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(Dl(r))gu(u,M);else{var z=r.alternate;if(r.lanes===0&&(z===null||z.lanes===0)&&(z=u.lastRenderedReducer,z!==null))try{var X=u.lastRenderedState,re=z(X,m);if(M.hasEagerState=!0,M.eagerState=re,_a(re,X))return sc(r,u,M,0),di===null&&ac(),!1}catch{}finally{}if(m=oc(r,u,M,b),m!==null)return zs(m,r,b),wc(m,u,b),!0}return!1}function ss(r,u,m,b){if(b={lane:2,revertLane:Tu(),action:b,hasEagerState:!1,eagerState:null,next:null},Dl(r)){if(u)throw Error(h(479))}else u=oc(r,m,b,2),u!==null&&zs(u,r,2)}function Dl(r){var u=r.alternate;return r===Tn||u!==null&&u===Tn}function gu(r,u){fu=vh=!0;var m=r.pending;m===null?u.next=u:(u.next=m.next,m.next=u),r.pending=u}function wc(r,u,m){if((m&4194048)!==0){var b=u.lanes;b&=r.pendingLanes,m|=b,u.lanes=m,Ae(r,m)}}var Zr={readContext:tr,use:bc,useCallback:Ui,useContext:Ui,useEffect:Ui,useImperativeHandle:Ui,useLayoutEffect:Ui,useInsertionEffect:Ui,useMemo:Ui,useReducer:Ui,useRef:Ui,useState:Ui,useDebugValue:Ui,useDeferredValue:Ui,useTransition:Ui,useSyncExternalStore:Ui,useId:Ui,useHostTransitionStatus:Ui,useFormState:Ui,useActionState:Ui,useOptimistic:Ui,useMemoCache:Ui,useCacheRefresh:Ui},os={readContext:tr,use:bc,useCallback:function(r,u){return ha().memoizedState=[r,u===void 0?null:u],r},useContext:tr,useEffect:qe,useImperativeHandle:function(r,u,m){m=m!=null?m.concat([r]):null,_e(4194308,4,Ct.bind(null,u,r),m)},useLayoutEffect:function(r,u){return _e(4194308,4,r,u)},useInsertionEffect:function(r,u){_e(4,2,r,u)},useMemo:function(r,u){var m=ha();u=u===void 0?null:u;var b=r();if(Jr){dr(!0);try{r()}finally{dr(!1)}}return m.memoizedState=[b,u],b},useReducer:function(r,u,m){var b=ha();if(m!==void 0){var M=m(u);if(Jr){dr(!0);try{m(u)}finally{dr(!1)}}}else M=u;return b.memoizedState=b.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},b.queue=r,r=r.dispatch=Cl.bind(null,Tn,r),[b.memoizedState,r]},useRef:function(r){var u=ha();return r={current:r},u.memoizedState=r},useState:function(r){r=E(r);var u=r.queue,m=Yo.bind(null,Tn,u);return u.dispatch=m,[r.memoizedState,m]},useDebugValue:ft,useDeferredValue:function(r,u){var m=ha();return jn(m,r,u)},useTransition:function(){var r=E(!1);return r=ti.bind(null,Tn,r.queue,!0,!1),ha().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,u,m){var b=Tn,M=ha();if(Wn){if(m===void 0)throw Error(h(407));m=m()}else{if(m=u(),di===null)throw Error(h(349));($n&124)!==0||e(b,u,m)}M.memoizedState=m;var z={value:m,getSnapshot:u};return M.queue=z,qe(f.bind(null,b,z,r),[r]),b.flags|=2048,ge(9,Te(),s.bind(null,b,z,m,u),null),m},useId:function(){var r=ha(),u=di.identifierPrefix;if(Wn){var m=Oa,b=As;m=(b&~(1<<32-jr(b)-1)).toString(32)+m,u="«"+u+"R"+m,m=_c++,0<m&&(u+="H"+m.toString(32)),u+="»"}else m=Dd++,u="«"+u+"r"+m.toString(32)+"»";return r.memoizedState=u},useHostTransitionStatus:wr,useFormState:ue,useActionState:ue,useOptimistic:function(r){var u=ha();u.memoizedState=u.baseState=r;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=ss.bind(null,Tn,!0,m),m.dispatch=u,[r,u]},useMemoCache:$o,useCacheRefresh:function(){return ha().memoizedState=Gr.bind(null,Tn)}},qo={readContext:tr,use:bc,useCallback:Bt,useContext:tr,useEffect:Fe,useImperativeHandle:Et,useInsertionEffect:Ue,useLayoutEffect:We,useMemo:gn,useReducer:pu,useRef:Ee,useState:function(){return pu(Va)},useDebugValue:ft,useDeferredValue:function(r,u){var m=mi();return Pi(m,ei.memoizedState,r,u)},useTransition:function(){var r=pu(Va)[0],u=mi().memoizedState;return[typeof r=="boolean"?r:xc(r),u]},useSyncExternalStore:x,useId:Rn,useHostTransitionStatus:wr,useFormState:ce,useActionState:ce,useOptimistic:function(r,u){var m=mi();return C(m,ei,r,u)},useMemoCache:$o,useCacheRefresh:Tr},Tc={readContext:tr,use:bc,useCallback:Bt,useContext:tr,useEffect:Fe,useImperativeHandle:Et,useInsertionEffect:Ue,useLayoutEffect:We,useMemo:gn,useReducer:xh,useRef:Ee,useState:function(){return xh(Va)},useDebugValue:ft,useDeferredValue:function(r,u){var m=mi();return ei===null?jn(m,r,u):Pi(m,ei.memoizedState,r,u)},useTransition:function(){var r=xh(Va)[0],u=mi().memoizedState;return[typeof r=="boolean"?r:xc(r),u]},useSyncExternalStore:x,useId:Rn,useHostTransitionStatus:wr,useFormState:be,useActionState:be,useOptimistic:function(r,u){var m=mi();return ei!==null?C(m,ei,r,u):(m.baseState=r,[r,m.queue.dispatch])},useMemoCache:$o,useCacheRefresh:Tr},gi=null,ri=0;function Nr(r){var u=ri;return ri+=1,gi===null&&(gi=[]),Sd(gi,r,u)}function Vi(r,u){u=u.props.ref,r.ref=u!==void 0?u:null}function bh(r,u){throw u.$$typeof===B?Error(h(525)):(r=Object.prototype.toString.call(u),Error(h(31,r==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":r)))}function nm(r){var u=r._init;return u(r._payload)}function kd(r){function u(Be,Ne){if(r){var He=Be.deletions;He===null?(Be.deletions=[Ne],Be.flags|=16):He.push(Ne)}}function m(Be,Ne){if(!r)return null;for(;Ne!==null;)u(Be,Ne),Ne=Ne.sibling;return null}function b(Be){for(var Ne=new Map;Be!==null;)Be.key!==null?Ne.set(Be.key,Be):Ne.set(Be.index,Be),Be=Be.sibling;return Ne}function M(Be,Ne){return Be=la(Be,Ne),Be.index=0,Be.sibling=null,Be}function z(Be,Ne,He){return Be.index=He,r?(He=Be.alternate,He!==null?(He=He.index,He<Ne?(Be.flags|=67108866,Ne):He):(Be.flags|=67108866,Ne)):(Be.flags|=1048576,Ne)}function X(Be){return r&&Be.alternate===null&&(Be.flags|=67108866),Be}function re(Be,Ne,He,yt){return Ne===null||Ne.tag!==6?(Ne=Pf(He,Be.mode,yt),Ne.return=Be,Ne):(Ne=M(Ne,He),Ne.return=Be,Ne)}function Se(Be,Ne,He,yt){var $t=He.type;return $t===ne?dt(Be,Ne,He.props.children,yt,He.key):Ne!==null&&(Ne.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===ot&&nm($t)===Ne.type)?(Ne=M(Ne,He.props),Vi(Ne,He),Ne.return=Be,Ne):(Ne=hh(He.type,He.key,He.props,null,Be.mode,yt),Vi(Ne,He),Ne.return=Be,Ne)}function Xe(Be,Ne,He,yt){return Ne===null||Ne.tag!==4||Ne.stateNode.containerInfo!==He.containerInfo||Ne.stateNode.implementation!==He.implementation?(Ne=Lf(He,Be.mode,yt),Ne.return=Be,Ne):(Ne=M(Ne,He.children||[]),Ne.return=Be,Ne)}function dt(Be,Ne,He,yt,$t){return Ne===null||Ne.tag!==7?(Ne=Es(He,Be.mode,yt,$t),Ne.return=Be,Ne):(Ne=M(Ne,He),Ne.return=Be,Ne)}function vt(Be,Ne,He){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return Ne=Pf(""+Ne,Be.mode,He),Ne.return=Be,Ne;if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case U:return He=hh(Ne.type,Ne.key,Ne.props,null,Be.mode,He),Vi(He,Ne),He.return=Be,He;case Z:return Ne=Lf(Ne,Be.mode,He),Ne.return=Be,Ne;case ot:var yt=Ne._init;return Ne=yt(Ne._payload),vt(Be,Ne,He)}if(on(Ne)||Lt(Ne))return Ne=Es(Ne,Be.mode,He,null),Ne.return=Be,Ne;if(typeof Ne.then=="function")return vt(Be,Nr(Ne),He);if(Ne.$$typeof===Je)return vt(Be,Bo(Be,Ne),He);bh(Be,Ne)}return null}function et(Be,Ne,He,yt){var $t=Ne!==null?Ne.key:null;if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return $t!==null?null:re(Be,Ne,""+He,yt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case U:return He.key===$t?Se(Be,Ne,He,yt):null;case Z:return He.key===$t?Xe(Be,Ne,He,yt):null;case ot:return $t=He._init,He=$t(He._payload),et(Be,Ne,He,yt)}if(on(He)||Lt(He))return $t!==null?null:dt(Be,Ne,He,yt,null);if(typeof He.then=="function")return et(Be,Ne,Nr(He),yt);if(He.$$typeof===Je)return et(Be,Ne,Bo(Be,He),yt);bh(Be,He)}return null}function nt(Be,Ne,He,yt,$t){if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return Be=Be.get(He)||null,re(Ne,Be,""+yt,$t);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case U:return Be=Be.get(yt.key===null?He:yt.key)||null,Se(Ne,Be,yt,$t);case Z:return Be=Be.get(yt.key===null?He:yt.key)||null,Xe(Ne,Be,yt,$t);case ot:var Ln=yt._init;return yt=Ln(yt._payload),nt(Be,Ne,He,yt,$t)}if(on(yt)||Lt(yt))return Be=Be.get(He)||null,dt(Ne,Be,yt,$t,null);if(typeof yt.then=="function")return nt(Be,Ne,He,Nr(yt),$t);if(yt.$$typeof===Je)return nt(Be,Ne,He,Bo(Ne,yt),$t);bh(Ne,yt)}return null}function rn(Be,Ne,He,yt){for(var $t=null,Ln=null,nn=Ne,dn=Ne=0,Ci=null;nn!==null&&dn<He.length;dn++){nn.index>dn?(Ci=nn,nn=null):Ci=nn.sibling;var Hn=et(Be,nn,He[dn],yt);if(Hn===null){nn===null&&(nn=Ci);break}r&&nn&&Hn.alternate===null&&u(Be,nn),Ne=z(Hn,Ne,dn),Ln===null?$t=Hn:Ln.sibling=Hn,Ln=Hn,nn=Ci}if(dn===He.length)return m(Be,nn),Wn&&ts(Be,dn),$t;if(nn===null){for(;dn<He.length;dn++)nn=vt(Be,He[dn],yt),nn!==null&&(Ne=z(nn,Ne,dn),Ln===null?$t=nn:Ln.sibling=nn,Ln=nn);return Wn&&ts(Be,dn),$t}for(nn=b(nn);dn<He.length;dn++)Ci=nt(nn,Be,dn,He[dn],yt),Ci!==null&&(r&&Ci.alternate!==null&&nn.delete(Ci.key===null?dn:Ci.key),Ne=z(Ci,Ne,dn),Ln===null?$t=Ci:Ln.sibling=Ci,Ln=Ci);return r&&nn.forEach(function(Lc){return u(Be,Lc)}),Wn&&ts(Be,dn),$t}function ln(Be,Ne,He,yt){if(He==null)throw Error(h(151));for(var $t=null,Ln=null,nn=Ne,dn=Ne=0,Ci=null,Hn=He.next();nn!==null&&!Hn.done;dn++,Hn=He.next()){nn.index>dn?(Ci=nn,nn=null):Ci=nn.sibling;var Lc=et(Be,nn,Hn.value,yt);if(Lc===null){nn===null&&(nn=Ci);break}r&&nn&&Lc.alternate===null&&u(Be,nn),Ne=z(Lc,Ne,dn),Ln===null?$t=Lc:Ln.sibling=Lc,Ln=Lc,nn=Ci}if(Hn.done)return m(Be,nn),Wn&&ts(Be,dn),$t;if(nn===null){for(;!Hn.done;dn++,Hn=He.next())Hn=vt(Be,Hn.value,yt),Hn!==null&&(Ne=z(Hn,Ne,dn),Ln===null?$t=Hn:Ln.sibling=Hn,Ln=Hn);return Wn&&ts(Be,dn),$t}for(nn=b(nn);!Hn.done;dn++,Hn=He.next())Hn=nt(nn,Be,dn,Hn.value,yt),Hn!==null&&(r&&Hn.alternate!==null&&nn.delete(Hn.key===null?dn:Hn.key),Ne=z(Hn,Ne,dn),Ln===null?$t=Hn:Ln.sibling=Hn,Ln=Hn);return r&&nn.forEach(function(Gv){return u(Be,Gv)}),Wn&&ts(Be,dn),$t}function bi(Be,Ne,He,yt){if(typeof He=="object"&&He!==null&&He.type===ne&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case U:e:{for(var $t=He.key;Ne!==null;){if(Ne.key===$t){if($t=He.type,$t===ne){if(Ne.tag===7){m(Be,Ne.sibling),yt=M(Ne,He.props.children),yt.return=Be,Be=yt;break e}}else if(Ne.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===ot&&nm($t)===Ne.type){m(Be,Ne.sibling),yt=M(Ne,He.props),Vi(yt,He),yt.return=Be,Be=yt;break e}m(Be,Ne);break}else u(Be,Ne);Ne=Ne.sibling}He.type===ne?(yt=Es(He.props.children,Be.mode,yt,He.key),yt.return=Be,Be=yt):(yt=hh(He.type,He.key,He.props,null,Be.mode,yt),Vi(yt,He),yt.return=Be,Be=yt)}return X(Be);case Z:e:{for($t=He.key;Ne!==null;){if(Ne.key===$t)if(Ne.tag===4&&Ne.stateNode.containerInfo===He.containerInfo&&Ne.stateNode.implementation===He.implementation){m(Be,Ne.sibling),yt=M(Ne,He.children||[]),yt.return=Be,Be=yt;break e}else{m(Be,Ne);break}else u(Be,Ne);Ne=Ne.sibling}yt=Lf(He,Be.mode,yt),yt.return=Be,Be=yt}return X(Be);case ot:return $t=He._init,He=$t(He._payload),bi(Be,Ne,He,yt)}if(on(He))return rn(Be,Ne,He,yt);if(Lt(He)){if($t=Lt(He),typeof $t!="function")throw Error(h(150));return He=$t.call(He),ln(Be,Ne,He,yt)}if(typeof He.then=="function")return bi(Be,Ne,Nr(He),yt);if(He.$$typeof===Je)return bi(Be,Ne,Bo(Be,He),yt);bh(Be,He)}return typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint"?(He=""+He,Ne!==null&&Ne.tag===6?(m(Be,Ne.sibling),yt=M(Ne,He),yt.return=Be,Be=yt):(m(Be,Ne),yt=Pf(He,Be.mode,yt),yt.return=Be,Be=yt),X(Be)):m(Be,Ne)}return function(Be,Ne,He,yt){try{ri=0;var $t=bi(Be,Ne,He,yt);return gi=null,$t}catch(nn){if(nn===yh||nn===Sl)throw nn;var Ln=oa(29,nn,null,Be.mode);return Ln.lanes=yt,Ln.return=Be,Ln}finally{}}}var fo=kd(!0),Sc=kd(!1),yr=ut(null),Ai=null;function ea(r){var u=r.alternate;Mt(rr,rr.current&1),Mt(yr,r),Ai===null&&(u===null||co.current!==null||u.memoizedState!==null)&&(Ai=r)}function Id(r){if(r.tag===22){if(Mt(rr,rr.current),Mt(yr,r),Ai===null){var u=r.alternate;u!==null&&u.memoizedState!==null&&(Ai=r)}}else da()}function da(){Mt(rr,rr.current),Mt(yr,yr.current)}function ks(r){wt(yr),Ai===r&&(Ai=null),wt(rr)}var rr=ut(0);function kl(r){for(var u=r;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||Xd(m)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function im(r,u,m,b){u=r.memoizedState,m=m(b,u),m=m==null?u:P({},u,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Ec={enqueueSetState:function(r,u,m){r=r._reactInternals;var b=cs(),M=lo(b);M.payload=u,m!=null&&(M.callback=m),u=Go(r,M,b),u!==null&&(zs(u,r,b),Al(u,r,b))},enqueueReplaceState:function(r,u,m){r=r._reactInternals;var b=cs(),M=lo(b);M.tag=1,M.payload=u,m!=null&&(M.callback=m),u=Go(r,M,b),u!==null&&(zs(u,r,b),Al(u,r,b))},enqueueForceUpdate:function(r,u){r=r._reactInternals;var m=cs(),b=lo(m);b.tag=2,u!=null&&(b.callback=u),u=Go(r,b,m),u!==null&&(zs(u,r,m),Al(u,r,m))}};function yu(r,u,m,b,M,z,X){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(b,z,X):u.prototype&&u.prototype.isPureReactComponent?!su(m,b)||!su(M,z):!0}function Cg(r,u,m,b){r=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,b),u.state!==r&&Ec.enqueueReplaceState(u,u.state,null)}function wh(r,u){var m=u;if("ref"in u){m={};for(var b in u)b!=="ref"&&(m[b]=u[b])}if(r=r.defaultProps){m===u&&(m=P({},m));for(var M in r)m[M]===void 0&&(m[M]=r[M])}return m}var Rd=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Dg(r){Rd(r)}function q_(r){console.error(r)}function kg(r){Rd(r)}function rm(r,u){try{var m=r.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function am(r,u,m){try{var b=r.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Ig(r,u,m){return m=lo(m),m.tag=3,m.payload={element:null},m.callback=function(){rm(r,u)},m}function sm(r){return r=lo(r),r.tag=3,r}function Rg(r,u,m,b){var M=m.type.getDerivedStateFromError;if(typeof M=="function"){var z=b.value;r.payload=function(){return M(z)},r.callback=function(){am(u,m,b)}}var X=m.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(r.callback=function(){am(u,m,b),typeof M!="function"&&(kc===null?kc=new Set([this]):kc.add(this));var re=b.stack;this.componentDidCatch(b.value,{componentStack:re!==null?re:""})})}function H_(r,u,m,b,M){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=m.alternate,u!==null&&mc(u,m,M,!0),m=yr.current,m!==null){switch(m.tag){case 13:return Ai===null?ny():m.alternate===null&&_r===0&&(_r=3),m.flags&=-257,m.flags|=65536,m.lanes=M,b===El?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([b]):u.add(b),cy(r,b,M)),!1;case 22:return m.flags|=65536,b===El?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([b]):m.add(b)),cy(r,b,M)),!1}throw Error(h(435,m.tag))}return cy(r,b,M),ny(),!1}if(Wn)return u=yr.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=M,b!==xd&&(r=Error(h(422),{cause:b}),is(Pa(r,m)))):(b!==xd&&(u=Error(h(423),{cause:b}),is(Pa(u,m))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,b=Pa(b,m),M=Ig(r.stateNode,b,M),Bf(r,M),_r!==4&&(_r=2)),!1;var z=Error(h(520),{cause:b});if(z=Pa(z,m),ip===null?ip=[z]:ip.push(z),_r!==4&&(_r=2),u===null)return!0;b=Pa(b,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,r=M&-M,m.lanes|=r,r=Ig(m.stateNode,b,r),Bf(m,r),!1;case 1:if(u=m.type,z=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(kc===null||!kc.has(z))))return m.flags|=65536,M&=-M,m.lanes|=M,M=sm(M),Rg(M,r,m,b),Bf(m,M),!1}m=m.return}while(m!==null);return!1}var Th=Error(h(461)),ta=!1;function Sr(r,u,m,b){u.child=r===null?Sc(u,null,m,b):fo(u,r.child,m,b)}function Gf(r,u,m,b,M){m=m.render;var z=u.ref;if("ref"in b){var X={};for(var re in b)re!=="ref"&&(X[re]=b[re])}else X=b;return xl(u),b=Vr(r,u,m,X,z,M),re=Zo(),r!==null&&!ta?(Ei(r,u,M),Ac(r,u,M)):(Wn&&re&&fc(u),u.flags|=1,Sr(r,u,b,M),u.child)}function Zf(r,u,m,b,M){if(r===null){var z=m.type;return typeof z=="function"&&!bn(z)&&z.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=z,zg(r,u,z,b,M)):(r=hh(m.type,null,b,u,u.mode,M),r.ref=u.ref,r.return=u,u.child=r)}if(z=r.child,!hm(r,M)){var X=z.memoizedProps;if(m=m.compare,m=m!==null?m:su,m(X,b)&&r.ref===u.ref)return Ac(r,u,M)}return u.flags|=1,r=la(z,b),r.ref=u.ref,r.return=u,u.child=r}function zg(r,u,m,b,M){if(r!==null){var z=r.memoizedProps;if(su(z,b)&&r.ref===u.ref)if(ta=!1,u.pendingProps=b=z,hm(r,M))(r.flags&131072)!==0&&(ta=!0);else return u.lanes=r.lanes,Ac(r,u,M)}return lm(r,u,m,b,M)}function Ng(r,u,m){var b=u.pendingProps,M=b.children,z=r!==null?r.memoizedState:null;if(b.mode==="hidden"){if((u.flags&128)!==0){if(b=z!==null?z.baseLanes|m:m,r!==null){for(M=u.child=r.child,z=0;M!==null;)z=z|M.lanes|M.childLanes,M=M.sibling;u.childLanes=z&~b}else u.childLanes=0,u.child=null;return X_(r,u,b,m)}if((m&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},r!==null&&wd(u,z!==null?z.cachePool:null),z!==null?Cd(u,z):uo(),Id(u);else return u.lanes=u.childLanes=536870912,X_(r,u,z!==null?z.baseLanes|m:m,m)}else z!==null?(wd(u,z.cachePool),Cd(u,z),da(),u.memoizedState=null):(r!==null&&wd(u,null),uo(),da());return Sr(r,u,M,m),u.child}function X_(r,u,m,b){var M=Tl();return M=M===null?null:{parent:gr._currentValue,pool:M},u.memoizedState={baseLanes:m,cachePool:M},r!==null&&wd(u,null),uo(),Id(u),r!==null&&mc(r,u,b,!0),null}function om(r,u){var m=u.ref;if(m===null)r!==null&&r.ref!==null&&(u.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(h(284));(r===null||r.ref!==m)&&(u.flags|=4194816)}}function lm(r,u,m,b,M){return xl(u),m=Vr(r,u,m,b,void 0,M),b=Zo(),r!==null&&!ta?(Ei(r,u,M),Ac(r,u,M)):(Wn&&b&&fc(u),u.flags|=1,Sr(r,u,m,M),u.child)}function Pg(r,u,m,b,M,z){return xl(u),u.updateQueue=null,m=zr(u,b,m,M),Vf(r),b=Zo(),r!==null&&!ta?(Ei(r,u,z),Ac(r,u,z)):(Wn&&b&&fc(u),u.flags|=1,Sr(r,u,m,z),u.child)}function Lg(r,u,m,b,M){if(xl(u),u.stateNode===null){var z=Ss,X=m.contextType;typeof X=="object"&&X!==null&&(z=tr(X)),z=new m(b,z),u.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=Ec,u.stateNode=z,z._reactInternals=u,z=u.stateNode,z.props=b,z.state=u.memoizedState,z.refs={},_h(u),X=m.contextType,z.context=typeof X=="object"&&X!==null?tr(X):Ss,z.state=u.memoizedState,X=m.getDerivedStateFromProps,typeof X=="function"&&(im(u,m,X,b),z.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(X=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),X!==z.state&&Ec.enqueueReplaceState(z,z.state,null),Ml(u,b,z,M),yc(),z.state=u.memoizedState),typeof z.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(r===null){z=u.stateNode;var re=u.memoizedProps,Se=wh(m,re);z.props=Se;var Xe=z.context,dt=m.contextType;X=Ss,typeof dt=="object"&&dt!==null&&(X=tr(dt));var vt=m.getDerivedStateFromProps;dt=typeof vt=="function"||typeof z.getSnapshotBeforeUpdate=="function",re=u.pendingProps!==re,dt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(re||Xe!==X)&&Cg(u,z,b,X),Ua=!1;var et=u.memoizedState;z.state=et,Ml(u,b,z,M),yc(),Xe=u.memoizedState,re||et!==Xe||Ua?(typeof vt=="function"&&(im(u,m,vt,b),Xe=u.memoizedState),(Se=Ua||yu(u,m,Se,b,et,Xe,X))?(dt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(u.flags|=4194308)):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=Xe),z.props=b,z.state=Xe,z.context=X,b=Se):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{z=u.stateNode,wn(r,u),X=u.memoizedProps,dt=wh(m,X),z.props=dt,vt=u.pendingProps,et=z.context,Xe=m.contextType,Se=Ss,typeof Xe=="object"&&Xe!==null&&(Se=tr(Xe)),re=m.getDerivedStateFromProps,(Xe=typeof re=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(X!==vt||et!==Se)&&Cg(u,z,b,Se),Ua=!1,et=u.memoizedState,z.state=et,Ml(u,b,z,M),yc();var nt=u.memoizedState;X!==vt||et!==nt||Ua||r!==null&&r.dependencies!==null&&mh(r.dependencies)?(typeof re=="function"&&(im(u,m,re,b),nt=u.memoizedState),(dt=Ua||yu(u,m,dt,b,et,nt,Se)||r!==null&&r.dependencies!==null&&mh(r.dependencies))?(Xe||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(b,nt,Se),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(b,nt,Se)),typeof z.componentDidUpdate=="function"&&(u.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof z.componentDidUpdate!="function"||X===r.memoizedProps&&et===r.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||X===r.memoizedProps&&et===r.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=nt),z.props=b,z.state=nt,z.context=Se,b=dt):(typeof z.componentDidUpdate!="function"||X===r.memoizedProps&&et===r.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||X===r.memoizedProps&&et===r.memoizedState||(u.flags|=1024),b=!1)}return z=b,om(r,u),b=(u.flags&128)!==0,z||b?(z=u.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:z.render(),u.flags|=1,r!==null&&b?(u.child=fo(u,r.child,null,M),u.child=fo(u,null,m,M)):Sr(r,u,m,M),u.memoizedState=z.state,r=u.child):r=Ac(r,u,M),r}function W_(r,u,m,b){return uu(),u.flags|=256,Sr(r,u,m,b),u.child}var $f={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cm(r){return{baseLanes:r,cachePool:gh()}}function Yf(r,u,m){return r=r!==null?r.childLanes&~m:0,u&&(r|=yo),r}function zd(r,u,m){var b=u.pendingProps,M=!1,z=(u.flags&128)!==0,X;if((X=z)||(X=r!==null&&r.memoizedState===null?!1:(rr.current&2)!==0),X&&(M=!0,u.flags&=-129),X=(u.flags&32)!==0,u.flags&=-33,r===null){if(Wn){if(M?ea(u):da(),Wn){var re=Qi,Se;if(Se=re){e:{for(Se=re,re=ns;Se.nodeType!==8;){if(!re){re=null;break e}if(Se=us(Se.nextSibling),Se===null){re=null;break e}}re=Se}re!==null?(u.memoizedState={dehydrated:re,treeContext:ao!==null?{id:As,overflow:Oa}:null,retryLane:536870912,hydrationErrors:null},Se=oa(18,null,null,0),Se.stateNode=re,Se.return=u,u.child=Se,Wi=u,Qi=null,Se=!0):Se=!1}Se||_l(u)}if(re=u.memoizedState,re!==null&&(re=re.dehydrated,re!==null))return Xd(re)?u.lanes=32:u.lanes=536870912,null;ks(u)}return re=b.children,b=b.fallback,M?(da(),M=u.mode,re=qf({mode:"hidden",children:re},M),b=Es(b,M,m,null),re.return=u,b.return=u,re.sibling=b,u.child=re,M=u.child,M.memoizedState=cm(m),M.childLanes=Yf(r,X,m),u.memoizedState=$f,b):(ea(u),fa(u,re))}if(Se=r.memoizedState,Se!==null&&(re=Se.dehydrated,re!==null)){if(z)u.flags&256?(ea(u),u.flags&=-257,u=Hf(r,u,m)):u.memoizedState!==null?(da(),u.child=r.child,u.flags|=128,u=null):(da(),M=b.fallback,re=u.mode,b=qf({mode:"visible",children:b.children},re),M=Es(M,re,m,null),M.flags|=2,b.return=u,M.return=u,b.sibling=M,u.child=b,fo(u,r.child,null,m),b=u.child,b.memoizedState=cm(m),b.childLanes=Yf(r,X,m),u.memoizedState=$f,u=M);else if(ea(u),Xd(re)){if(X=re.nextSibling&&re.nextSibling.dataset,X)var Xe=X.dgst;X=Xe,b=Error(h(419)),b.stack="",b.digest=X,is({value:b,source:null,stack:null}),u=Hf(r,u,m)}else if(ta||mc(r,u,m,!1),X=(m&r.childLanes)!==0,ta||X){if(X=di,X!==null&&(b=m&-m,b=(b&42)!==0?1:Dt(b),b=(b&(X.suspendedLanes|m))!==0?0:b,b!==0&&b!==Se.retryLane))throw Se.retryLane=b,Ts(r,b),zs(X,r,b),Th;re.data==="$?"||ny(),u=Hf(r,u,m)}else re.data==="$?"?(u.flags|=192,u.child=r.child,u=null):(r=Se.treeContext,Qi=us(re.nextSibling),Wi=u,Wn=!0,so=null,ns=!1,r!==null&&(ca[Kr++]=As,ca[Kr++]=Oa,ca[Kr++]=ao,As=r.id,Oa=r.overflow,ao=u),u=fa(u,b.children),u.flags|=4096);return u}return M?(da(),M=b.fallback,re=u.mode,Se=r.child,Xe=Se.sibling,b=la(Se,{mode:"hidden",children:b.children}),b.subtreeFlags=Se.subtreeFlags&65011712,Xe!==null?M=la(Xe,M):(M=Es(M,re,m,null),M.flags|=2),M.return=u,b.return=u,b.sibling=M,u.child=b,b=M,M=u.child,re=r.child.memoizedState,re===null?re=cm(m):(Se=re.cachePool,Se!==null?(Xe=gr._currentValue,Se=Se.parent!==Xe?{parent:Xe,pool:Xe}:Se):Se=gh(),re={baseLanes:re.baseLanes|m,cachePool:Se}),M.memoizedState=re,M.childLanes=Yf(r,X,m),u.memoizedState=$f,b):(ea(u),m=r.child,r=m.sibling,m=la(m,{mode:"visible",children:b.children}),m.return=u,m.sibling=null,r!==null&&(X=u.deletions,X===null?(u.deletions=[r],u.flags|=16):X.push(r)),u.child=m,u.memoizedState=null,m)}function fa(r,u){return u=qf({mode:"visible",children:u},r.mode),u.return=r,r.child=u}function qf(r,u){return r=oa(22,r,null,u),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Hf(r,u,m){return fo(u,r.child,null,m),r=fa(u,u.pendingProps.children),r.flags|=2,u.memoizedState=null,r}function Q_(r,u,m){r.lanes|=u;var b=r.alternate;b!==null&&(b.lanes|=u),ph(r.return,u,m)}function um(r,u,m,b,M){var z=r.memoizedState;z===null?r.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:M}:(z.isBackwards=u,z.rendering=null,z.renderingStartTime=0,z.last=b,z.tail=m,z.tailMode=M)}function K_(r,u,m){var b=u.pendingProps,M=b.revealOrder,z=b.tail;if(Sr(r,u,b.children,m),b=rr.current,(b&2)!==0)b=b&1|2,u.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=u.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Q_(r,m,u);else if(r.tag===19)Q_(r,m,u);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===u)break e;for(;r.sibling===null;){if(r.return===null||r.return===u)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}b&=1}switch(Mt(rr,b),M){case"forwards":for(m=u.child,M=null;m!==null;)r=m.alternate,r!==null&&kl(r)===null&&(M=m),m=m.sibling;m=M,m===null?(M=u.child,u.child=null):(M=m.sibling,m.sibling=null),um(u,!1,M,m,z);break;case"backwards":for(m=null,M=u.child,u.child=null;M!==null;){if(r=M.alternate,r!==null&&kl(r)===null){u.child=M;break}r=M.sibling,M.sibling=m,m=M,M=r}um(u,!0,m,null,z);break;case"together":um(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Ac(r,u,m){if(r!==null&&(u.dependencies=r.dependencies),bu|=u.lanes,(m&u.childLanes)===0)if(r!==null){if(mc(r,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(r!==null&&u.child!==r.child)throw Error(h(153));if(u.child!==null){for(r=u.child,m=la(r,r.pendingProps),u.child=m,m.return=u;r.sibling!==null;)r=r.sibling,m=m.sibling=la(r,r.pendingProps),m.return=u;m.sibling=null}return u.child}function hm(r,u){return(r.lanes&u)!==0?!0:(r=r.dependencies,!!(r!==null&&mh(r)))}function zv(r,u,m){switch(u.tag){case 3:zn(u,u.stateNode.containerInfo),Ba(u,gr,r.memoizedState.cache),uu();break;case 27:case 5:Ca(u);break;case 4:zn(u,u.stateNode.containerInfo);break;case 10:Ba(u,u.type,u.memoizedProps.value);break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(ea(u),u.flags|=128,null):(m&u.child.childLanes)!==0?zd(r,u,m):(ea(u),r=Ac(r,u,m),r!==null?r.sibling:null);ea(u);break;case 19:var M=(r.flags&128)!==0;if(b=(m&u.childLanes)!==0,b||(mc(r,u,m,!1),b=(m&u.childLanes)!==0),M){if(b)return K_(r,u,m);u.flags|=128}if(M=u.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Mt(rr,rr.current),b)break;return null;case 22:case 23:return u.lanes=0,Ng(r,u,m);case 24:Ba(u,gr,r.memoizedState.cache)}return Ac(r,u,m)}function dm(r,u,m){if(r!==null)if(r.memoizedProps!==u.pendingProps)ta=!0;else{if(!hm(r,m)&&(u.flags&128)===0)return ta=!1,zv(r,u,m);ta=(r.flags&131072)!==0}else ta=!1,Wn&&(u.flags&1048576)!==0&&dc(u,hc,u.index);switch(u.lanes=0,u.tag){case 16:e:{r=u.pendingProps;var b=u.elementType,M=b._init;if(b=M(b._payload),u.type=b,typeof b=="function")bn(b)?(r=wh(b,r),u.tag=1,u=Lg(null,u,b,r,m)):(u.tag=0,u=lm(null,u,b,r,m));else{if(b!=null){if(M=b.$$typeof,M===$e){u.tag=11,u=Gf(null,u,b,r,m);break e}else if(M===ct){u.tag=14,u=Zf(null,u,b,r,m);break e}}throw u=sn(b)||b,Error(h(306,u,""))}}return u;case 0:return lm(r,u,u.type,u.pendingProps,m);case 1:return b=u.type,M=wh(b,u.pendingProps),Lg(r,u,b,M,m);case 3:e:{if(zn(u,u.stateNode.containerInfo),r===null)throw Error(h(387));b=u.pendingProps;var z=u.memoizedState;M=z.element,wn(r,u),Ml(u,b,null,m);var X=u.memoizedState;if(b=X.cache,Ba(u,gr,b),b!==z.cache&&pc(u,[gr],m,!0),yc(),b=X.element,z.isDehydrated)if(z={element:b,isDehydrated:!1,cache:X.cache},u.updateQueue.baseState=z,u.memoizedState=z,u.flags&256){u=W_(r,u,b,m);break e}else if(b!==M){M=Pa(Error(h(424)),u),is(M),u=W_(r,u,b,m);break e}else{switch(r=u.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Qi=us(r.firstChild),Wi=u,Wn=!0,so=null,ns=!0,m=Sc(u,null,b,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(uu(),b===M){u=Ac(r,u,m);break e}Sr(r,u,b,m)}u=u.child}return u;case 26:return om(r,u),r===null?(m=Iy(u.type,null,u.pendingProps,null))?u.memoizedState=m:Wn||(m=u.type,r=u.pendingProps,b=pp(Wt.current).createElement(m),b[xn]=u,b[yn]=r,_i(b,m,r),Ht(b),u.stateNode=b):u.memoizedState=Iy(u.type,r.memoizedProps,u.pendingProps,r.memoizedState),null;case 27:return Ca(u),r===null&&Wn&&(b=u.stateNode=T0(u.type,u.pendingProps,Wt.current),Wi=u,ns=!0,M=Qi,Eu(u.type)?(Ey=M,Qi=us(b.firstChild)):Qi=M),Sr(r,u,u.pendingProps.children,m),om(r,u),r===null&&(u.flags|=4194304),u.child;case 5:return r===null&&Wn&&((M=b=Qi)&&(b=zm(b,u.type,u.pendingProps,ns),b!==null?(u.stateNode=b,Wi=u,Qi=us(b.firstChild),ns=!1,M=!0):M=!1),M||_l(u)),Ca(u),M=u.type,z=u.pendingProps,X=r!==null?r.memoizedProps:null,b=z.children,by(M,z)?b=null:X!==null&&by(M,X)&&(u.flags|=32),u.memoizedState!==null&&(M=Vr(r,u,tm,null,null,m),oe._currentValue=M),om(r,u),Sr(r,u,b,m),u.child;case 6:return r===null&&Wn&&((r=m=Qi)&&(m=b0(m,u.pendingProps,ns),m!==null?(u.stateNode=m,Wi=u,Qi=null,r=!0):r=!1),r||_l(u)),null;case 13:return zd(r,u,m);case 4:return zn(u,u.stateNode.containerInfo),b=u.pendingProps,r===null?u.child=fo(u,null,b,m):Sr(r,u,b,m),u.child;case 11:return Gf(r,u,u.type,u.pendingProps,m);case 7:return Sr(r,u,u.pendingProps,m),u.child;case 8:return Sr(r,u,u.pendingProps.children,m),u.child;case 12:return Sr(r,u,u.pendingProps.children,m),u.child;case 10:return b=u.pendingProps,Ba(u,u.type,b.value),Sr(r,u,b.children,m),u.child;case 9:return M=u.type._context,b=u.pendingProps.children,xl(u),M=tr(M),b=b(M),u.flags|=1,Sr(r,u,b,m),u.child;case 14:return Zf(r,u,u.type,u.pendingProps,m);case 15:return zg(r,u,u.type,u.pendingProps,m);case 19:return K_(r,u,m);case 31:return b=u.pendingProps,m=u.mode,b={mode:b.mode,children:b.children},r===null?(m=qf(b,m),m.ref=u.ref,u.child=m,m.return=u,u=m):(m=la(r.child,b),m.ref=u.ref,u.child=m,m.return=u,u=m),u;case 22:return Ng(r,u,m);case 24:return xl(u),b=tr(gr),r===null?(M=Tl(),M===null&&(M=di,z=bl(),M.pooledCache=z,z.refCount++,z!==null&&(M.pooledCacheLanes|=m),M=z),u.memoizedState={parent:b,cache:M},_h(u),Ba(u,gr,M)):((r.lanes&m)!==0&&(wn(r,u),Ml(u,null,null,m),yc()),M=r.memoizedState,z=u.memoizedState,M.parent!==b?(M={parent:b,cache:b},u.memoizedState=M,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=M),Ba(u,gr,b)):(b=z.cache,Ba(u,gr,b),b!==M.cache&&pc(u,[gr],m,!0))),Sr(r,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(h(156,u.tag))}function Il(r){r.flags|=4}function Og(r,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!A(u)){if(u=yr.current,u!==null&&(($n&4194048)===$n?Ai!==null:($n&62914560)!==$n&&($n&536870912)===0||u!==Ai))throw Vo=El,Td;r.flags|=8192}}function fm(r,u){u!==null&&(r.flags|=4),r.flags&16384&&(u=r.tag!==22?ze():536870912,r.lanes|=u,Bd|=u)}function Xf(r,u){if(!Wn)switch(r.tailMode){case"hidden":u=r.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u||r.tail===null?r.tail=null:r.tail.sibling=null:b.sibling=null}}function ar(r){var u=r.alternate!==null&&r.alternate.child===r.child,m=0,b=0;if(u)for(var M=r.child;M!==null;)m|=M.lanes|M.childLanes,b|=M.subtreeFlags&65011712,b|=M.flags&65011712,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)m|=M.lanes|M.childLanes,b|=M.subtreeFlags,b|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=b,r.childLanes=m,u}function jg(r,u,m){var b=u.pendingProps;switch(dh(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ar(u),null;case 1:return ar(u),null;case 3:return m=u.stateNode,b=null,r!==null&&(b=r.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),xa(gr),Gn(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(r===null||r.child===null)&&(vl(u)?Il(u):r===null||r.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,ji())),ar(u),null;case 26:return m=u.memoizedState,r===null?(Il(u),m!==null?(ar(u),Og(u,m)):(ar(u),u.flags&=-16777217)):m?m!==r.memoizedState?(Il(u),ar(u),Og(u,m)):(ar(u),u.flags&=-16777217):(r.memoizedProps!==b&&Il(u),ar(u),u.flags&=-16777217),null;case 27:Hi(u),m=Wt.current;var M=u.type;if(r!==null&&u.stateNode!=null)r.memoizedProps!==b&&Il(u);else{if(!b){if(u.stateNode===null)throw Error(h(166));return ar(u),null}r=Rt.current,vl(u)?cu(u):(r=T0(M,b,m),u.stateNode=r,Il(u))}return ar(u),null;case 5:if(Hi(u),m=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==b&&Il(u);else{if(!b){if(u.stateNode===null)throw Error(h(166));return ar(u),null}if(r=Rt.current,vl(u))cu(u);else{switch(M=pp(Wt.current),r){case 1:r=M.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:r=M.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":r=M.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":r=M.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof b.is=="string"?M.createElement("select",{is:b.is}):M.createElement("select"),b.multiple?r.multiple=!0:b.size&&(r.size=b.size);break;default:r=typeof b.is=="string"?M.createElement(m,{is:b.is}):M.createElement(m)}}r[xn]=u,r[yn]=b;e:for(M=u.child;M!==null;){if(M.tag===5||M.tag===6)r.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===u)break e;for(;M.sibling===null;){if(M.return===null||M.return===u)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}u.stateNode=r;e:switch(_i(r,m,b),m){case"button":case"input":case"select":case"textarea":r=!!b.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Il(u)}}return ar(u),u.flags&=-16777217,null;case 6:if(r&&u.stateNode!=null)r.memoizedProps!==b&&Il(u);else{if(typeof b!="string"&&u.stateNode===null)throw Error(h(166));if(r=Wt.current,vl(u)){if(r=u.stateNode,m=u.memoizedProps,b=null,M=Wi,M!==null)switch(M.tag){case 27:case 5:b=M.memoizedProps}r[xn]=u,r=!!(r.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||qd(r.nodeValue,m)),r||_l(u)}else r=pp(r).createTextNode(b),r[xn]=u,u.stateNode=r}return ar(u),null;case 13:if(b=u.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=vl(u),b!==null&&b.dehydrated!==null){if(r===null){if(!M)throw Error(h(318));if(M=u.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(h(317));M[xn]=u}else uu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;ar(u),M=!1}else M=ji(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=M),M=!0;if(!M)return u.flags&256?(ks(u),u):(ks(u),null)}if(ks(u),(u.flags&128)!==0)return u.lanes=m,u;if(m=b!==null,r=r!==null&&r.memoizedState!==null,m){b=u.child,M=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(M=b.alternate.memoizedState.cachePool.pool);var z=null;b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(z=b.memoizedState.cachePool.pool),z!==M&&(b.flags|=2048)}return m!==r&&m&&(u.child.flags|=8192),fm(u,u.updateQueue),ar(u),null;case 4:return Gn(),r===null&&my(u.stateNode.containerInfo),ar(u),null;case 10:return xa(u.type),ar(u),null;case 19:if(wt(rr),M=u.memoizedState,M===null)return ar(u),null;if(b=(u.flags&128)!==0,z=M.rendering,z===null)if(b)Xf(M,!1);else{if(_r!==0||r!==null&&(r.flags&128)!==0)for(r=u.child;r!==null;){if(z=kl(r),z!==null){for(u.flags|=128,Xf(M,!1),r=z.updateQueue,u.updateQueue=r,fm(u,r),u.subtreeFlags=0,r=m,m=u.child;m!==null;)Nf(m,r),m=m.sibling;return Mt(rr,rr.current&1|2),u.child}r=r.sibling}M.tail!==null&&qn()>rp&&(u.flags|=128,b=!0,Xf(M,!1),u.lanes=4194304)}else{if(!b)if(r=kl(z),r!==null){if(u.flags|=128,b=!0,r=r.updateQueue,u.updateQueue=r,fm(u,r),Xf(M,!0),M.tail===null&&M.tailMode==="hidden"&&!z.alternate&&!Wn)return ar(u),null}else 2*qn()-M.renderingStartTime>rp&&m!==536870912&&(u.flags|=128,b=!0,Xf(M,!1),u.lanes=4194304);M.isBackwards?(z.sibling=u.child,u.child=z):(r=M.last,r!==null?r.sibling=z:u.child=z,M.last=z)}return M.tail!==null?(u=M.tail,M.rendering=u,M.tail=u.sibling,M.renderingStartTime=qn(),u.sibling=null,r=rr.current,Mt(rr,b?r&1|2:r&1),u):(ar(u),null);case 22:case 23:return ks(u),pi(),b=u.memoizedState!==null,r!==null?r.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(m&536870912)!==0&&(u.flags&128)===0&&(ar(u),u.subtreeFlags&6&&(u.flags|=8192)):ar(u),m=u.updateQueue,m!==null&&fm(u,m.retryQueue),m=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==m&&(u.flags|=2048),r!==null&&wt(nr),null;case 24:return m=null,r!==null&&(m=r.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),xa(gr),ar(u),null;case 25:return null;case 30:return null}throw Error(h(156,u.tag))}function Bg(r,u){switch(dh(u),u.tag){case 1:return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 3:return xa(gr),Gn(),r=u.flags,(r&65536)!==0&&(r&128)===0?(u.flags=r&-65537|128,u):null;case 26:case 27:case 5:return Hi(u),null;case 13:if(ks(u),r=u.memoizedState,r!==null&&r.dehydrated!==null){if(u.alternate===null)throw Error(h(340));uu()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 19:return wt(rr),null;case 4:return Gn(),null;case 10:return xa(u.type),null;case 22:case 23:return ks(u),pi(),r!==null&&wt(nr),r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 24:return xa(gr),null;case 25:return null;default:return null}}function Fg(r,u){switch(dh(u),u.tag){case 3:xa(gr),Gn();break;case 26:case 27:case 5:Hi(u);break;case 4:Gn();break;case 13:ks(u);break;case 19:wt(rr);break;case 10:xa(u.type);break;case 22:case 23:ks(u),pi(),r!==null&&wt(nr);break;case 24:xa(gr)}}function Ho(r,u){try{var m=u.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var M=b.next;m=M;do{if((m.tag&r)===r){b=void 0;var z=m.create,X=m.inst;b=z(),X.destroy=b}m=m.next}while(m!==M)}}catch(re){yi(u,u.return,re)}}function po(r,u,m){try{var b=u.updateQueue,M=b!==null?b.lastEffect:null;if(M!==null){var z=M.next;b=z;do{if((b.tag&r)===r){var X=b.inst,re=X.destroy;if(re!==void 0){X.destroy=void 0,M=u;var Se=m,Xe=re;try{Xe()}catch(dt){yi(M,Se,dt)}}}b=b.next}while(b!==z)}}catch(dt){yi(u,u.return,dt)}}function J_(r){var u=r.updateQueue;if(u!==null){var m=r.stateNode;try{Uf(u,m)}catch(b){yi(r,r.return,b)}}}function e0(r,u,m){m.props=wh(r.type,r.memoizedProps),m.state=r.memoizedState;try{m.componentWillUnmount()}catch(b){yi(r,u,b)}}function Wf(r,u){try{var m=r.ref;if(m!==null){switch(r.tag){case 26:case 27:case 5:var b=r.stateNode;break;case 30:b=r.stateNode;break;default:b=r.stateNode}typeof m=="function"?r.refCleanup=m(b):m.current=b}}catch(M){yi(r,u,M)}}function Rl(r,u){var m=r.ref,b=r.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(M){yi(r,u,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(M){yi(r,u,M)}else m.current=null}function t0(r){var u=r.type,m=r.memoizedProps,b=r.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(M){yi(r,r.return,M)}}function Ug(r,u,m){try{var b=r.stateNode;Hd(b,r.type,m,u),b[yn]=u}catch(M){yi(r,r.return,M)}}function n0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Eu(r.type)||r.tag===4}function Qf(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||n0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Eu(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Vg(r,u,m){var b=r.tag;if(b===5||b===6)r=r.stateNode,u?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(r,u):(u=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,u.appendChild(r),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=fp));else if(b!==4&&(b===27&&Eu(r.type)&&(m=r.stateNode,u=null),r=r.child,r!==null))for(Vg(r,u,m),r=r.sibling;r!==null;)Vg(r,u,m),r=r.sibling}function Kf(r,u,m){var b=r.tag;if(b===5||b===6)r=r.stateNode,u?m.insertBefore(r,u):m.appendChild(r);else if(b!==4&&(b===27&&Eu(r.type)&&(m=r.stateNode),r=r.child,r!==null))for(Kf(r,u,m),r=r.sibling;r!==null;)Kf(r,u,m),r=r.sibling}function Nd(r){var u=r.stateNode,m=r.memoizedProps;try{for(var b=r.type,M=u.attributes;M.length;)u.removeAttributeNode(M[0]);_i(u,b,m),u[xn]=r,u[yn]=m}catch(z){yi(r,r.return,z)}}var Mc=!1,An=!1,_u=!1,Gg=typeof WeakSet=="function"?WeakSet:Set,Er=null;function pm(r,u){if(r=r.containerInfo,Pc=ht,r=lh(r),ws(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var M=b.anchorOffset,z=b.focusNode;b=b.focusOffset;try{m.nodeType,z.nodeType}catch{m=null;break e}var X=0,re=-1,Se=-1,Xe=0,dt=0,vt=r,et=null;t:for(;;){for(var nt;vt!==m||M!==0&&vt.nodeType!==3||(re=X+M),vt!==z||b!==0&&vt.nodeType!==3||(Se=X+b),vt.nodeType===3&&(X+=vt.nodeValue.length),(nt=vt.firstChild)!==null;)et=vt,vt=nt;for(;;){if(vt===r)break t;if(et===m&&++Xe===M&&(re=X),et===z&&++dt===b&&(Se=X),(nt=vt.nextSibling)!==null)break;vt=et,et=vt.parentNode}vt=nt}m=re===-1||Se===-1?null:{start:re,end:Se}}else m=null}m=m||{start:0,end:0}}else m=null;for(km={focusedElem:r,selectionRange:m},ht=!1,Er=u;Er!==null;)if(u=Er,r=u.child,(u.subtreeFlags&1024)!==0&&r!==null)r.return=u,Er=r;else for(;Er!==null;){switch(u=Er,z=u.alternate,r=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&z!==null){r=void 0,m=u,M=z.memoizedProps,z=z.memoizedState,b=m.stateNode;try{var rn=wh(m.type,M,m.elementType===m.type);r=b.getSnapshotBeforeUpdate(rn,z),b.__reactInternalSnapshotBeforeUpdate=r}catch(ln){yi(m,m.return,ln)}}break;case 3:if((r&1024)!==0){if(r=u.stateNode.containerInfo,m=r.nodeType,m===9)Rm(r);else if(m===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Rm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(h(163))}if(r=u.sibling,r!==null){r.return=u.return,Er=r;break}Er=u.return}}function Pd(r,u,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:go(r,m),b&4&&Ho(5,m);break;case 1:if(go(r,m),b&4)if(r=m.stateNode,u===null)try{r.componentDidMount()}catch(X){yi(m,m.return,X)}else{var M=wh(m.type,u.memoizedProps);u=u.memoizedState;try{r.componentDidUpdate(M,u,r.__reactInternalSnapshotBeforeUpdate)}catch(X){yi(m,m.return,X)}}b&64&&J_(m),b&512&&Wf(m,m.return);break;case 3:if(go(r,m),b&64&&(r=m.updateQueue,r!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{Uf(r,u)}catch(X){yi(m,m.return,X)}}break;case 27:u===null&&b&4&&Nd(m);case 26:case 5:go(r,m),u===null&&b&4&&t0(m),b&512&&Wf(m,m.return);break;case 12:go(r,m);break;case 13:go(r,m),b&4&&Jf(r,m),b&64&&(r=m.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(m=Pv.bind(null,m),Nm(r,m))));break;case 22:if(b=m.memoizedState!==null||Mc,!b){u=u!==null&&u.memoizedState!==null||An,M=Mc;var z=An;Mc=b,(An=u)&&!z?Dc(r,m,(m.subtreeFlags&8772)!==0):go(r,m),Mc=M,An=z}break;case 30:break;default:go(r,m)}}function Zg(r){var u=r.alternate;u!==null&&(r.alternate=null,Zg(u)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(u=r.stateNode,u!==null&&Si(u)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Gi=null,na=!1;function Xo(r,u,m){for(m=m.child;m!==null;)Sh(r,u,m),m=m.sibling}function Sh(r,u,m){if(ci&&typeof ci.onCommitFiberUnmount=="function")try{ci.onCommitFiberUnmount(Hr,m)}catch{}switch(m.tag){case 26:An||Rl(m,u),Xo(r,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:An||Rl(m,u);var b=Gi,M=na;Eu(m.type)&&(Gi=m.stateNode,na=!1),Xo(r,u,m),Ol(m.stateNode),Gi=b,na=M;break;case 5:An||Rl(m,u);case 6:if(b=Gi,M=na,Gi=null,Xo(r,u,m),Gi=b,na=M,Gi!==null)if(na)try{(Gi.nodeType===9?Gi.body:Gi.nodeName==="HTML"?Gi.ownerDocument.body:Gi).removeChild(m.stateNode)}catch(z){yi(m,u,z)}else try{Gi.removeChild(m.stateNode)}catch(z){yi(m,u,z)}break;case 18:Gi!==null&&(na?(r=Gi,Sy(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,m.stateNode),Yi(r)):Sy(Gi,m.stateNode));break;case 4:b=Gi,M=na,Gi=m.stateNode.containerInfo,na=!0,Xo(r,u,m),Gi=b,na=M;break;case 0:case 11:case 14:case 15:An||po(2,m,u),An||po(4,m,u),Xo(r,u,m);break;case 1:An||(Rl(m,u),b=m.stateNode,typeof b.componentWillUnmount=="function"&&e0(m,u,b)),Xo(r,u,m);break;case 21:Xo(r,u,m);break;case 22:An=(b=An)||m.memoizedState!==null,Xo(r,u,m),An=b;break;default:Xo(r,u,m)}}function Jf(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Yi(r)}catch(m){yi(u,u.return,m)}}function Ld(r){switch(r.tag){case 13:case 19:var u=r.stateNode;return u===null&&(u=r.stateNode=new Gg),u;case 22:return r=r.stateNode,u=r._retryCache,u===null&&(u=r._retryCache=new Gg),u;default:throw Error(h(435,r.tag))}}function Eh(r,u){var m=Ld(r);u.forEach(function(b){var M=Lv.bind(null,r,b);m.has(b)||(m.add(b),b.then(M,M))})}function Is(r,u){var m=u.deletions;if(m!==null)for(var b=0;b<m.length;b++){var M=m[b],z=r,X=u,re=X;e:for(;re!==null;){switch(re.tag){case 27:if(Eu(re.type)){Gi=re.stateNode,na=!1;break e}break;case 5:Gi=re.stateNode,na=!1;break e;case 3:case 4:Gi=re.stateNode.containerInfo,na=!0;break e}re=re.return}if(Gi===null)throw Error(h(160));Sh(z,X,M),Gi=null,na=!1,z=M.alternate,z!==null&&(z.return=null),M.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)vu(u,r),u=u.sibling}var mo=null;function vu(r,u){var m=r.alternate,b=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Is(u,r),Rs(r),b&4&&(po(3,r,r.return),Ho(3,r),po(5,r,r.return));break;case 1:Is(u,r),Rs(r),b&512&&(An||m===null||Rl(m,m.return)),b&64&&Mc&&(r=r.updateQueue,r!==null&&(b=r.callbacks,b!==null&&(m=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var M=mo;if(Is(u,r),Rs(r),b&512&&(An||m===null||Rl(m,m.return)),b&4){var z=m!==null?m.memoizedState:null;if(b=r.memoizedState,m===null)if(b===null)if(r.stateNode===null){e:{b=r.type,m=r.memoizedProps,M=M.ownerDocument||M;t:switch(b){case"title":z=M.getElementsByTagName("title")[0],(!z||z[Ji]||z[xn]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=M.createElement(b),M.head.insertBefore(z,M.querySelector("head > title"))),_i(z,b,m),z[xn]=r,Ht(z),b=z;break e;case"link":var X=y("link","href",M).get(b+(m.href||""));if(X){for(var re=0;re<X.length;re++)if(z=X[re],z.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&z.getAttribute("rel")===(m.rel==null?null:m.rel)&&z.getAttribute("title")===(m.title==null?null:m.title)&&z.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){X.splice(re,1);break t}}z=M.createElement(b),_i(z,b,m),M.head.appendChild(z);break;case"meta":if(X=y("meta","content",M).get(b+(m.content||""))){for(re=0;re<X.length;re++)if(z=X[re],z.getAttribute("content")===(m.content==null?null:""+m.content)&&z.getAttribute("name")===(m.name==null?null:m.name)&&z.getAttribute("property")===(m.property==null?null:m.property)&&z.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&z.getAttribute("charset")===(m.charSet==null?null:m.charSet)){X.splice(re,1);break t}}z=M.createElement(b),_i(z,b,m),M.head.appendChild(z);break;default:throw Error(h(468,b))}z[xn]=r,Ht(z),b=z}r.stateNode=b}else T(M,r.type,r.stateNode);else r.stateNode=A0(M,b,r.memoizedProps);else z!==b?(z===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):z.count--,b===null?T(M,r.type,r.stateNode):A0(M,b,r.memoizedProps)):b===null&&r.stateNode!==null&&Ug(r,r.memoizedProps,m.memoizedProps)}break;case 27:Is(u,r),Rs(r),b&512&&(An||m===null||Rl(m,m.return)),m!==null&&b&4&&Ug(r,r.memoizedProps,m.memoizedProps);break;case 5:if(Is(u,r),Rs(r),b&512&&(An||m===null||Rl(m,m.return)),r.flags&32){M=r.stateNode;try{zo(M,"")}catch(nt){yi(r,r.return,nt)}}b&4&&r.stateNode!=null&&(M=r.memoizedProps,Ug(r,M,m!==null?m.memoizedProps:M)),b&1024&&(_u=!0);break;case 6:if(Is(u,r),Rs(r),b&4){if(r.stateNode===null)throw Error(h(162));b=r.memoizedProps,m=r.stateNode;try{m.nodeValue=b}catch(nt){yi(r,r.return,nt)}}break;case 3:if(d=null,M=mo,mo=mp(u.containerInfo),Is(u,r),mo=M,Rs(r),b&4&&m!==null&&m.memoizedState.isDehydrated)try{Yi(u.containerInfo)}catch(nt){yi(r,r.return,nt)}_u&&(_u=!1,$g(r));break;case 4:b=mo,mo=mp(r.stateNode.containerInfo),Is(u,r),Rs(r),mo=b;break;case 12:Is(u,r),Rs(r);break;case 13:Is(u,r),Rs(r),r.child.flags&8192&&r.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(Wg=qn()),b&4&&(b=r.updateQueue,b!==null&&(r.updateQueue=null,Eh(r,b)));break;case 22:M=r.memoizedState!==null;var Se=m!==null&&m.memoizedState!==null,Xe=Mc,dt=An;if(Mc=Xe||M,An=dt||Se,Is(u,r),An=dt,Mc=Xe,Rs(r),b&8192)e:for(u=r.stateNode,u._visibility=M?u._visibility&-2:u._visibility|1,M&&(m===null||Se||Mc||An||Cc(r)),m=null,u=r;;){if(u.tag===5||u.tag===26){if(m===null){Se=m=u;try{if(z=Se.stateNode,M)X=z.style,typeof X.setProperty=="function"?X.setProperty("display","none","important"):X.display="none";else{re=Se.stateNode;var vt=Se.memoizedProps.style,et=vt!=null&&vt.hasOwnProperty("display")?vt.display:null;re.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(nt){yi(Se,Se.return,nt)}}}else if(u.tag===6){if(m===null){Se=u;try{Se.stateNode.nodeValue=M?"":Se.memoizedProps}catch(nt){yi(Se,Se.return,nt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===r)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break e;for(;u.sibling===null;){if(u.return===null||u.return===r)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}b&4&&(b=r.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,Eh(r,m))));break;case 19:Is(u,r),Rs(r),b&4&&(b=r.updateQueue,b!==null&&(r.updateQueue=null,Eh(r,b)));break;case 30:break;case 21:break;default:Is(u,r),Rs(r)}}function Rs(r){var u=r.flags;if(u&2){try{for(var m,b=r.return;b!==null;){if(n0(b)){m=b;break}b=b.return}if(m==null)throw Error(h(160));switch(m.tag){case 27:var M=m.stateNode,z=Qf(r);Kf(r,z,M);break;case 5:var X=m.stateNode;m.flags&32&&(zo(X,""),m.flags&=-33);var re=Qf(r);Kf(r,re,X);break;case 3:case 4:var Se=m.stateNode.containerInfo,Xe=Qf(r);Vg(r,Xe,Se);break;default:throw Error(h(161))}}catch(dt){yi(r,r.return,dt)}r.flags&=-3}u&4096&&(r.flags&=-4097)}function $g(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var u=r;$g(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),r=r.sibling}}function go(r,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Pd(r,u.alternate,u),u=u.sibling}function Cc(r){for(r=r.child;r!==null;){var u=r;switch(u.tag){case 0:case 11:case 14:case 15:po(4,u,u.return),Cc(u);break;case 1:Rl(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&e0(u,u.return,m),Cc(u);break;case 27:Ol(u.stateNode);case 26:case 5:Rl(u,u.return),Cc(u);break;case 22:u.memoizedState===null&&Cc(u);break;case 30:Cc(u);break;default:Cc(u)}r=r.sibling}}function Dc(r,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,M=r,z=u,X=z.flags;switch(z.tag){case 0:case 11:case 15:Dc(M,z,m),Ho(4,z);break;case 1:if(Dc(M,z,m),b=z,M=b.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Xe){yi(b,b.return,Xe)}if(b=z,M=b.updateQueue,M!==null){var re=b.stateNode;try{var Se=M.shared.hiddenCallbacks;if(Se!==null)for(M.shared.hiddenCallbacks=null,M=0;M<Se.length;M++)Ad(Se[M],re)}catch(Xe){yi(b,b.return,Xe)}}m&&X&64&&J_(z),Wf(z,z.return);break;case 27:Nd(z);case 26:case 5:Dc(M,z,m),m&&b===null&&X&4&&t0(z),Wf(z,z.return);break;case 12:Dc(M,z,m);break;case 13:Dc(M,z,m),m&&X&4&&Jf(M,z);break;case 22:z.memoizedState===null&&Dc(M,z,m),Wf(z,z.return);break;case 30:break;default:Dc(M,z,m)}u=u.sibling}}function mm(r,u){var m=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),r=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(r=u.memoizedState.cachePool.pool),r!==m&&(r!=null&&r.refCount++,m!=null&&gc(m))}function Yg(r,u){r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&gc(r))}function zl(r,u,m,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)i0(r,u,m,b),u=u.sibling}function i0(r,u,m,b){var M=u.flags;switch(u.tag){case 0:case 11:case 15:zl(r,u,m,b),M&2048&&Ho(9,u);break;case 1:zl(r,u,m,b);break;case 3:zl(r,u,m,b),M&2048&&(r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&gc(r)));break;case 12:if(M&2048){zl(r,u,m,b),r=u.stateNode;try{var z=u.memoizedProps,X=z.id,re=z.onPostCommit;typeof re=="function"&&re(X,u.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Se){yi(u,u.return,Se)}}else zl(r,u,m,b);break;case 13:zl(r,u,m,b);break;case 23:break;case 22:z=u.stateNode,X=u.alternate,u.memoizedState!==null?z._visibility&2?zl(r,u,m,b):ep(r,u):z._visibility&2?zl(r,u,m,b):(z._visibility|=2,Od(r,u,m,b,(u.subtreeFlags&10256)!==0)),M&2048&&mm(X,u);break;case 24:zl(r,u,m,b),M&2048&&Yg(u.alternate,u);break;default:zl(r,u,m,b)}}function Od(r,u,m,b,M){for(M=M&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var z=r,X=u,re=m,Se=b,Xe=X.flags;switch(X.tag){case 0:case 11:case 15:Od(z,X,re,Se,M),Ho(8,X);break;case 23:break;case 22:var dt=X.stateNode;X.memoizedState!==null?dt._visibility&2?Od(z,X,re,Se,M):ep(z,X):(dt._visibility|=2,Od(z,X,re,Se,M)),M&&Xe&2048&&mm(X.alternate,X);break;case 24:Od(z,X,re,Se,M),M&&Xe&2048&&Yg(X.alternate,X);break;default:Od(z,X,re,Se,M)}u=u.sibling}}function ep(r,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=r,b=u,M=b.flags;switch(b.tag){case 22:ep(m,b),M&2048&&mm(b.alternate,b);break;case 24:ep(m,b),M&2048&&Yg(b.alternate,b);break;default:ep(m,b)}u=u.sibling}}var Ah=8192;function Mh(r){if(r.subtreeFlags&Ah)for(r=r.child;r!==null;)gm(r),r=r.sibling}function gm(r){switch(r.tag){case 26:Mh(r),r.flags&Ah&&r.memoizedState!==null&&O(mo,r.memoizedState,r.memoizedProps);break;case 5:Mh(r);break;case 3:case 4:var u=mo;mo=mp(r.stateNode.containerInfo),Mh(r),mo=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Ah,Ah=16777216,Mh(r),Ah=u):Mh(r));break;default:Mh(r)}}function qg(r){var u=r.alternate;if(u!==null&&(r=u.child,r!==null)){u.child=null;do u=r.sibling,r.sibling=null,r=u;while(r!==null)}}function Ch(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];Er=b,np(b,r)}qg(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Hg(r),r=r.sibling}function Hg(r){switch(r.tag){case 0:case 11:case 15:Ch(r),r.flags&2048&&po(9,r,r.return);break;case 3:Ch(r);break;case 12:Ch(r);break;case 22:var u=r.stateNode;r.memoizedState!==null&&u._visibility&2&&(r.return===null||r.return.tag!==13)?(u._visibility&=-3,tp(r)):Ch(r);break;default:Ch(r)}}function tp(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];Er=b,np(b,r)}qg(r)}for(r=r.child;r!==null;){switch(u=r,u.tag){case 0:case 11:case 15:po(8,u,u.return),tp(u);break;case 22:m=u.stateNode,m._visibility&2&&(m._visibility&=-3,tp(u));break;default:tp(u)}r=r.sibling}}function np(r,u){for(;Er!==null;){var m=Er;switch(m.tag){case 0:case 11:case 15:po(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:gc(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,Er=b;else e:for(m=r;Er!==null;){b=Er;var M=b.sibling,z=b.return;if(Zg(b),b===m){Er=null;break e}if(M!==null){M.return=z,Er=M;break e}Er=z}}}var r0={getCacheForType:function(r){var u=tr(gr),m=u.data.get(r);return m===void 0&&(m=r(),u.data.set(r,m)),m}},a0=typeof WeakMap=="function"?WeakMap:Map,hi=0,di=null,Bn=null,$n=0,Kn=0,Ga=null,xu=!1,jd=!1,ym=!1,Nl=0,_r=0,bu=0,Wo=0,_m=0,yo=0,Bd=0,ip=null,ls=null,Xg=!1,Wg=0,rp=1/0,Fd=null,kc=null,ia=0,Ic=null,Ud=null,Rc=0,Qg=0,vm=null,s0=null,ap=0,Kg=null;function cs(){if((hi&2)!==0&&$n!==0)return $n&-$n;if(Ye.T!==null){var r=Fo;return r!==0?r:Tu()}return Pt()}function o0(){yo===0&&(yo=($n&536870912)===0||Wn?Ze():536870912);var r=yr.current;return r!==null&&(r.flags|=32),yo}function zs(r,u,m){(r===di&&(Kn===2||Kn===9)||r.cancelPendingCommit!==null)&&(Gd(r,0),zc(r,$n,yo,!1)),Ke(r,m),((hi&2)===0||r!==di)&&(r===di&&((hi&2)===0&&(Wo|=m),_r===4&&zc(r,$n,yo,!1)),vo(r))}function Vd(r,u,m){if((hi&6)!==0)throw Error(h(327));var b=!m&&(u&124)===0&&(u&r.expiredLanes)===0||De(r,u),M=b?l0(r,u):iy(r,u,!0),z=b;do{if(M===0){jd&&!b&&zc(r,u,0,!1);break}else{if(m=r.current.alternate,z&&!ey(m)){M=iy(r,u,!1),z=!1;continue}if(M===2){if(z=u,r.errorRecoveryDisabledLanes&z)var X=0;else X=r.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){u=X;e:{var re=r;M=ip;var Se=re.current.memoizedState.isDehydrated;if(Se&&(Gd(re,X).flags|=256),X=iy(re,X,!1),X!==2){if(ym&&!Se){re.errorRecoveryDisabledLanes|=z,Wo|=z,M=4;break e}z=ls,ls=M,z!==null&&(ls===null?ls=z:ls.push.apply(ls,z))}M=X}if(z=!1,M!==2)continue}}if(M===1){Gd(r,0),zc(r,u,0,!0);break}e:{switch(b=r,z=M,z){case 0:case 1:throw Error(h(345));case 4:if((u&4194048)!==u)break;case 6:zc(b,u,yo,!xu);break e;case 2:ls=null;break;case 3:case 5:break;default:throw Error(h(329))}if((u&62914560)===u&&(M=Wg+300-qn(),10<M)){if(zc(b,u,yo,!xu),ve(b,0,!0)!==0)break e;b.timeoutHandle=wy(Jg.bind(null,b,m,ls,Fd,Xg,u,yo,Wo,Bd,xu,z,2,-0,0),M);break e}Jg(b,m,ls,Fd,Xg,u,yo,Wo,Bd,xu,z,0,-0,0)}}break}while(!0);vo(r)}function Jg(r,u,m,b,M,z,X,re,Se,Xe,dt,vt,et,nt){if(r.timeoutHandle=-1,vt=u.subtreeFlags,(vt&8192||(vt&16785408)===16785408)&&(k={stylesheets:null,count:0,unsuspend:N},gm(u),vt=F(),vt!==null)){r.cancelPendingCommit=vt(c0.bind(null,r,u,z,m,b,M,X,re,Se,dt,1,et,nt)),zc(r,z,X,!Xe);return}c0(r,u,z,m,b,M,X,re,Se)}function ey(r){for(var u=r;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var M=m[b],z=M.getSnapshot;M=M.value;try{if(!_a(z(),M))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function zc(r,u,m,b){u&=~_m,u&=~Wo,r.suspendedLanes|=u,r.pingedLanes&=~u,b&&(r.warmLanes|=u),b=r.expirationTimes;for(var M=u;0<M;){var z=31-jr(M),X=1<<z;b[z]=-1,M&=~X}m!==0&&lt(r,m,u)}function sr(){return(hi&6)===0?(cp(0),!1):!0}function sp(){if(Bn!==null){if(Kn===0)var r=Bn.return;else r=Bn,ja=oo=null,Ni(r),gi=null,ri=0,r=Bn;for(;r!==null;)Fg(r.alternate,r),r=r.return;Bn=null}}function Gd(r,u){var m=r.timeoutHandle;m!==-1&&(r.timeoutHandle=-1,v0(m)),m=r.cancelPendingCommit,m!==null&&(r.cancelPendingCommit=null,m()),sp(),di=r,Bn=m=la(r.current,null),$n=u,Kn=0,Ga=null,xu=!1,jd=De(r,u),ym=!1,Bd=yo=_m=Wo=bu=_r=0,ls=ip=null,Xg=!1,(u&8)!==0&&(u|=u&32);var b=r.entangledLanes;if(b!==0)for(r=r.entanglements,b&=u;0<b;){var M=31-jr(b),z=1<<M;u|=r[M],b&=~z}return Nl=u,ac(),m}function ty(r,u){Tn=null,Ye.H=Zr,u===yh||u===Sl?(u=Ed(),Kn=3):u===Td?(u=Ed(),Kn=4):Kn=u===Th?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ga=u,Bn===null&&(_r=1,rm(r,Pa(u,r.current)))}function Nc(){var r=Ye.H;return Ye.H=Zr,r===null?Zr:r}function xm(){var r=Ye.A;return Ye.A=r0,r}function ny(){_r=4,xu||($n&4194048)!==$n&&yr.current!==null||(jd=!0),(bu&134217727)===0&&(Wo&134217727)===0||di===null||zc(di,$n,yo,!1)}function iy(r,u,m){var b=hi;hi|=2;var M=Nc(),z=xm();(di!==r||$n!==u)&&(Fd=null,Gd(r,u)),u=!1;var X=_r;e:do try{if(Kn!==0&&Bn!==null){var re=Bn,Se=Ga;switch(Kn){case 8:sp(),X=6;break e;case 3:case 2:case 9:case 6:yr.current===null&&(u=!0);var Xe=Kn;if(Kn=0,Ga=null,Qo(r,re,Se,Xe),m&&jd){X=0;break e}break;default:Xe=Kn,Kn=0,Ga=null,Qo(r,re,Se,Xe)}}Nv(),X=_r;break}catch(dt){ty(r,dt)}while(!0);return u&&r.shellSuspendCounter++,ja=oo=null,hi=b,Ye.H=M,Ye.A=z,Bn===null&&(di=null,$n=0,ac()),X}function Nv(){for(;Bn!==null;)ay(Bn)}function l0(r,u){var m=hi;hi|=2;var b=Nc(),M=xm();di!==r||$n!==u?(Fd=null,rp=qn()+500,Gd(r,u)):jd=De(r,u);e:do try{if(Kn!==0&&Bn!==null){u=Bn;var z=Ga;t:switch(Kn){case 1:Kn=0,Ga=null,Qo(r,u,z,1);break;case 2:case 9:if(Ds(z)){Kn=0,Ga=null,Zd(u);break}u=function(){Kn!==2&&Kn!==9||di!==r||(Kn=7),vo(r)},z.then(u,u);break e;case 3:Kn=7;break e;case 4:Kn=5;break e;case 7:Ds(z)?(Kn=0,Ga=null,Zd(u)):(Kn=0,Ga=null,Qo(r,u,z,7));break;case 5:var X=null;switch(Bn.tag){case 26:X=Bn.memoizedState;case 5:case 27:var re=Bn;if(!X||A(X)){Kn=0,Ga=null;var Se=re.sibling;if(Se!==null)Bn=Se;else{var Xe=re.return;Xe!==null?(Bn=Xe,Dh(Xe)):Bn=null}break t}}Kn=0,Ga=null,Qo(r,u,z,5);break;case 6:Kn=0,Ga=null,Qo(r,u,z,6);break;case 8:sp(),_r=6;break e;default:throw Error(h(462))}}ry();break}catch(dt){ty(r,dt)}while(!0);return ja=oo=null,Ye.H=b,Ye.A=M,hi=m,Bn!==null?0:(di=null,$n=0,ac(),_r)}function ry(){for(;Bn!==null&&!Pn();)ay(Bn)}function ay(r){var u=dm(r.alternate,r,Nl);r.memoizedProps=r.pendingProps,u===null?Dh(r):Bn=u}function Zd(r){var u=r,m=u.alternate;switch(u.tag){case 15:case 0:u=Pg(m,u,u.pendingProps,u.type,void 0,$n);break;case 11:u=Pg(m,u,u.pendingProps,u.type.render,u.ref,$n);break;case 5:Ni(u);default:Fg(m,u),u=Bn=Nf(u,Nl),u=dm(m,u,Nl)}r.memoizedProps=r.pendingProps,u===null?Dh(r):Bn=u}function Qo(r,u,m,b){ja=oo=null,Ni(u),gi=null,ri=0;var M=u.return;try{if(H_(r,M,u,m,$n)){_r=1,rm(r,Pa(m,r.current)),Bn=null;return}}catch(z){if(M!==null)throw Bn=M,z;_r=1,rm(r,Pa(m,r.current)),Bn=null;return}u.flags&32768?(Wn||b===1?r=!0:jd||($n&536870912)!==0?r=!1:(xu=r=!0,(b===2||b===9||b===3||b===6)&&(b=yr.current,b!==null&&b.tag===13&&(b.flags|=16384))),op(u,r)):Dh(u)}function Dh(r){var u=r;do{if((u.flags&32768)!==0){op(u,xu);return}r=u.return;var m=jg(u.alternate,u,Nl);if(m!==null){Bn=m;return}if(u=u.sibling,u!==null){Bn=u;return}Bn=u=r}while(u!==null);_r===0&&(_r=5)}function op(r,u){do{var m=Bg(r.alternate,r);if(m!==null){m.flags&=32767,Bn=m;return}if(m=r.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(r=r.sibling,r!==null)){Bn=r;return}Bn=r=m}while(r!==null);_r=6,Bn=null}function c0(r,u,m,b,M,z,X,re,Se){r.cancelPendingCommit=null;do lp();while(ia!==0);if((hi&6)!==0)throw Error(h(327));if(u!==null){if(u===r.current)throw Error(h(177));if(z=u.lanes|u.childLanes,z|=Oo,je(r,m,z,X,re,Se),r===di&&(Bn=di=null,$n=0),Ud=u,Ic=r,Rc=m,Qg=z,vm=M,s0=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Ov(qr,function(){return ly(),null})):(r.callbackNode=null,r.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=Ye.T,Ye.T=null,M=gt.p,gt.p=2,X=hi,hi|=4;try{pm(r,u,m)}finally{hi=X,gt.p=M,Ye.T=b}}ia=1,u0(),sy(),oy()}}function u0(){if(ia===1){ia=0;var r=Ic,u=Ud,m=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||m){m=Ye.T,Ye.T=null;var b=gt.p;gt.p=2;var M=hi;hi|=4;try{vu(u,r);var z=km,X=lh(r.containerInfo),re=z.focusedElem,Se=z.selectionRange;if(X!==re&&re&&re.ownerDocument&&Zn(re.ownerDocument.documentElement,re)){if(Se!==null&&ws(re)){var Xe=Se.start,dt=Se.end;if(dt===void 0&&(dt=Xe),"selectionStart"in re)re.selectionStart=Xe,re.selectionEnd=Math.min(dt,re.value.length);else{var vt=re.ownerDocument||document,et=vt&&vt.defaultView||window;if(et.getSelection){var nt=et.getSelection(),rn=re.textContent.length,ln=Math.min(Se.start,rn),bi=Se.end===void 0?ln:Math.min(Se.end,rn);!nt.extend&&ln>bi&&(X=bi,bi=ln,ln=X);var Be=md(re,ln),Ne=md(re,bi);if(Be&&Ne&&(nt.rangeCount!==1||nt.anchorNode!==Be.node||nt.anchorOffset!==Be.offset||nt.focusNode!==Ne.node||nt.focusOffset!==Ne.offset)){var He=vt.createRange();He.setStart(Be.node,Be.offset),nt.removeAllRanges(),ln>bi?(nt.addRange(He),nt.extend(Ne.node,Ne.offset)):(He.setEnd(Ne.node,Ne.offset),nt.addRange(He))}}}}for(vt=[],nt=re;nt=nt.parentNode;)nt.nodeType===1&&vt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof re.focus=="function"&&re.focus(),re=0;re<vt.length;re++){var yt=vt[re];yt.element.scrollLeft=yt.left,yt.element.scrollTop=yt.top}}ht=!!Pc,km=Pc=null}finally{hi=M,gt.p=b,Ye.T=m}}r.current=u,ia=2}}function sy(){if(ia===2){ia=0;var r=Ic,u=Ud,m=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||m){m=Ye.T,Ye.T=null;var b=gt.p;gt.p=2;var M=hi;hi|=4;try{Pd(r,u.alternate,u)}finally{hi=M,gt.p=b,Ye.T=m}}ia=3}}function oy(){if(ia===4||ia===3){ia=0,Wa();var r=Ic,u=Ud,m=Rc,b=s0;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?ia=5:(ia=0,Ud=Ic=null,h0(r,r.pendingLanes));var M=r.pendingLanes;if(M===0&&(kc=null),Kt(m),u=u.stateNode,ci&&typeof ci.onCommitFiberRoot=="function")try{ci.onCommitFiberRoot(Hr,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=Ye.T,M=gt.p,gt.p=2,Ye.T=null;try{for(var z=r.onRecoverableError,X=0;X<b.length;X++){var re=b[X];z(re.value,{componentStack:re.stack})}}finally{Ye.T=u,gt.p=M}}(Rc&3)!==0&&lp(),vo(r),M=r.pendingLanes,(m&4194090)!==0&&(M&42)!==0?r===Kg?ap++:(ap=0,Kg=r):ap=0,cp(0)}}function h0(r,u){(r.pooledCacheLanes&=u)===0&&(u=r.pooledCache,u!=null&&(r.pooledCache=null,gc(u)))}function lp(r){return u0(),sy(),oy(),ly()}function ly(){if(ia!==5)return!1;var r=Ic,u=Qg;Qg=0;var m=Kt(Rc),b=Ye.T,M=gt.p;try{gt.p=32>m?32:m,Ye.T=null,m=vm,vm=null;var z=Ic,X=Rc;if(ia=0,Ud=Ic=null,Rc=0,(hi&6)!==0)throw Error(h(331));var re=hi;if(hi|=4,Hg(z.current),i0(z,z.current,X,m),hi=re,cp(0,!1),ci&&typeof ci.onPostCommitFiberRoot=="function")try{ci.onPostCommitFiberRoot(Hr,z)}catch{}return!0}finally{gt.p=M,Ye.T=b,h0(r,u)}}function bm(r,u,m){u=Pa(m,u),u=Ig(r.stateNode,u,2),r=Go(r,u,2),r!==null&&(Ke(r,2),vo(r))}function yi(r,u,m){if(r.tag===3)bm(r,r,m);else for(;u!==null;){if(u.tag===3){bm(u,r,m);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(kc===null||!kc.has(b))){r=Pa(m,r),m=sm(2),b=Go(u,m,2),b!==null&&(Rg(m,b,u,r),Ke(b,2),vo(b));break}}u=u.return}}function cy(r,u,m){var b=r.pingCache;if(b===null){b=r.pingCache=new a0;var M=new Set;b.set(u,M)}else M=b.get(u),M===void 0&&(M=new Set,b.set(u,M));M.has(m)||(ym=!0,M.add(m),r=d0.bind(null,r,u,m),u.then(r,r))}function d0(r,u,m){var b=r.pingCache;b!==null&&b.delete(u),r.pingedLanes|=r.suspendedLanes&m,r.warmLanes&=~m,di===r&&($n&m)===m&&(_r===4||_r===3&&($n&62914560)===$n&&300>qn()-Wg?(hi&2)===0&&Gd(r,0):_m|=m,Bd===$n&&(Bd=0)),vo(r)}function f0(r,u){u===0&&(u=ze()),r=Ts(r,u),r!==null&&(Ke(r,u),vo(r))}function Pv(r){var u=r.memoizedState,m=0;u!==null&&(m=u.retryLane),f0(r,m)}function Lv(r,u){var m=0;switch(r.tag){case 13:var b=r.stateNode,M=r.memoizedState;M!==null&&(m=M.retryLane);break;case 19:b=r.stateNode;break;case 22:b=r.stateNode._retryCache;break;default:throw Error(h(314))}b!==null&&b.delete(u),f0(r,m)}function Ov(r,u){return Xn(r,u)}var wm=null,kh=null,Tm=!1,_o=!1,Pl=!1,wu=0;function vo(r){r!==kh&&r.next===null&&(kh===null?wm=kh=r:kh=kh.next=r),_o=!0,Tm||(Tm=!0,uy())}function cp(r,u){if(!Pl&&_o){Pl=!0;do for(var m=!1,b=wm;b!==null;){if(r!==0){var M=b.pendingLanes;if(M===0)var z=0;else{var X=b.suspendedLanes,re=b.pingedLanes;z=(1<<31-jr(42|r)+1)-1,z&=M&~(X&~re),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(m=!0,Em(b,z))}else z=$n,z=ve(b,b===di?z:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(z&3)===0||De(b,z)||(m=!0,Em(b,z));b=b.next}while(m);Pl=!1}}function jv(){up()}function up(){_o=Tm=!1;var r=0;wu!==0&&(Su()&&(r=wu),wu=0);for(var u=qn(),m=null,b=wm;b!==null;){var M=b.next,z=Sm(b,u);z===0?(b.next=null,m===null?wm=M:m.next=M,M===null&&(kh=m)):(m=b,(r!==0||(z&3)!==0)&&(_o=!0)),b=M}cp(r)}function Sm(r,u){for(var m=r.suspendedLanes,b=r.pingedLanes,M=r.expirationTimes,z=r.pendingLanes&-62914561;0<z;){var X=31-jr(z),re=1<<X,Se=M[X];Se===-1?((re&m)===0||(re&b)!==0)&&(M[X]=Le(re,u)):Se<=u&&(r.expiredLanes|=re),z&=~re}if(u=di,m=$n,m=ve(r,r===u?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),b=r.callbackNode,m===0||r===u&&(Kn===2||Kn===9)||r.cancelPendingCommit!==null)return b!==null&&b!==null&&br(b),r.callbackNode=null,r.callbackPriority=0;if((m&3)===0||De(r,m)){if(u=m&-m,u===r.callbackPriority)return u;switch(b!==null&&br(b),Kt(m)){case 2:case 8:m=Yr;break;case 32:m=qr;break;case 268435456:m=gs;break;default:m=qr}return b=p0.bind(null,r),m=Xn(m,b),r.callbackPriority=u,r.callbackNode=m,u}return b!==null&&b!==null&&br(b),r.callbackPriority=2,r.callbackNode=null,2}function p0(r,u){if(ia!==0&&ia!==5)return r.callbackNode=null,r.callbackPriority=0,null;var m=r.callbackNode;if(lp()&&r.callbackNode!==m)return null;var b=$n;return b=ve(r,r===di?b:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),b===0?null:(Vd(r,b,u),Sm(r,qn()),r.callbackNode!=null&&r.callbackNode===m?p0.bind(null,r):null)}function Em(r,u){if(lp())return null;Vd(r,u,!0)}function uy(){x0(function(){(hi&6)!==0?Xn(Or,jv):up()})}function Tu(){return wu===0&&(wu=Ze()),wu}function hy(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Yc(""+r)}function dy(r,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,r.id&&m.setAttribute("form",r.id),u.parentNode.insertBefore(m,u),r=new FormData(r),m.parentNode.removeChild(m),r}function fy(r,u,m,b,M){if(u==="submit"&&m&&m.stateNode===M){var z=hy((M[yn]||null).action),X=b.submitter;X&&(u=(u=X[yn]||null)?hy(u.formAction):X.getAttribute("formAction"),u!==null&&(z=u,X=null));var re=new No("action","action",null,b,M);r.push({event:re,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(wu!==0){var Se=X?dy(M,X):new FormData(M);ni(m,{pending:!0,data:Se,method:M.method,action:z},null,Se)}}else typeof z=="function"&&(re.preventDefault(),Se=X?dy(M,X):new FormData(M),ni(m,{pending:!0,data:Se,method:M.method,action:z},z,Se))},currentTarget:M}]})}}for(var Am=0;Am<rc.length;Am++){var $d=rc[Am],m0=$d.toLowerCase(),Bv=$d[0].toUpperCase()+$d.slice(1);Qr(m0,"on"+Bv)}Qr(kf,"onAnimationEnd"),Qr(Jp,"onAnimationIteration"),Qr(If,"onAnimationStart"),Qr("dblclick","onDoubleClick"),Qr("focusin","onFocus"),Qr("focusout","onBlur"),Qr(gd,"onTransitionRun"),Qr(yd,"onTransitionStart"),Qr(_d,"onTransitionCancel"),Qr(vd,"onTransitionEnd"),un("onMouseEnter",["mouseout","mouseover"]),un("onMouseLeave",["mouseout","mouseover"]),un("onPointerEnter",["pointerout","pointerover"]),un("onPointerLeave",["pointerout","pointerover"]),Xr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hp));function y0(r,u){u=(u&4)!==0;for(var m=0;m<r.length;m++){var b=r[m],M=b.event;b=b.listeners;e:{var z=void 0;if(u)for(var X=b.length-1;0<=X;X--){var re=b[X],Se=re.instance,Xe=re.currentTarget;if(re=re.listener,Se!==z&&M.isPropagationStopped())break e;z=re,M.currentTarget=Xe;try{z(M)}catch(dt){Rd(dt)}M.currentTarget=null,z=Se}else for(X=0;X<b.length;X++){if(re=b[X],Se=re.instance,Xe=re.currentTarget,re=re.listener,Se!==z&&M.isPropagationStopped())break e;z=re,M.currentTarget=Xe;try{z(M)}catch(dt){Rd(dt)}M.currentTarget=null,z=Se}}}}function Fn(r,u){var m=u[en];m===void 0&&(m=u[en]=new Set);var b=r+"__bubble";m.has(b)||(Cm(u,r,2,!1),m.add(b))}function py(r,u,m){var b=0;u&&(b|=4),Cm(m,r,b,u)}var Mm="_reactListening"+Math.random().toString(36).slice(2);function my(r){if(!r[Mm]){r[Mm]=!0,ma.forEach(function(m){m!=="selectionchange"&&(g0.has(m)||py(m,!1,r),py(m,!0,r))});var u=r.nodeType===9?r:r.ownerDocument;u===null||u[Mm]||(u[Mm]=!0,py("selectionchange",!1,u))}}function Cm(r,u,m,b){switch(Ft(u)){case 2:var M=Qe;break;case 8:M=it;break;default:M=bt}m=M.bind(null,u,m,r),M=void 0,!fr||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(M=!0),b?M!==void 0?r.addEventListener(u,m,{capture:!0,passive:M}):r.addEventListener(u,m,!0):M!==void 0?r.addEventListener(u,m,{passive:M}):r.addEventListener(u,m,!1)}function Ll(r,u,m,b,M){var z=b;if((u&1)===0&&(u&2)===0&&b!==null)e:for(;;){if(b===null)return;var X=b.tag;if(X===3||X===4){var re=b.stateNode.containerInfo;if(re===M)break;if(X===4)for(X=b.return;X!==null;){var Se=X.tag;if((Se===3||Se===4)&&X.stateNode.containerInfo===M)return;X=X.return}for(;re!==null;){if(X=ka(re),X===null)return;if(Se=X.tag,Se===5||Se===6||Se===26||Se===27){b=z=X;continue e}re=re.parentNode}}b=b.return}Br(function(){var Xe=z,dt=_s(m),vt=[];e:{var et=gl.get(r);if(et!==void 0){var nt=No,rn=r;switch(r){case"keypress":if(fn(m)===0)break e;case"keydown":case"keyup":nt=za;break;case"focusin":rn="focus",nt=tc;break;case"focusout":rn="blur",nt=tc;break;case"beforeblur":case"afterblur":nt=tc;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=Rr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=eu;break;case kf:case Jp:case If:nt=mr;break;case vd:nt=wg;break;case"scroll":case"scrollend":nt=xf;break;case"wheel":nt=Sg;break;case"copy":case"cut":case"paste":nt=Qc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=ld;break;case"toggle":case"beforetoggle":nt=cd}var ln=(u&4)!==0,bi=!ln&&(r==="scroll"||r==="scrollend"),Be=ln?et!==null?et+"Capture":null:et;ln=[];for(var Ne=Xe,He;Ne!==null;){var yt=Ne;if(He=yt.stateNode,yt=yt.tag,yt!==5&&yt!==26&&yt!==27||He===null||Be===null||(yt=Li(Ne,Be),yt!=null&&ln.push(Yd(Ne,yt,He))),bi)break;Ne=Ne.return}0<ln.length&&(et=new nt(et,rn,null,m,dt),vt.push({event:et,listeners:ln}))}}if((u&7)===0){e:{if(et=r==="mouseover"||r==="pointerover",nt=r==="mouseout"||r==="pointerout",et&&m!==ga&&(rn=m.relatedTarget||m.fromElement)&&(ka(rn)||rn[Dn]))break e;if((nt||et)&&(et=dt.window===dt?dt:(et=dt.ownerDocument)?et.defaultView||et.parentWindow:window,nt?(rn=m.relatedTarget||m.toElement,nt=Xe,rn=rn?ka(rn):null,rn!==null&&(bi=_(rn),ln=rn.tag,rn!==bi||ln!==5&&ln!==27&&ln!==6)&&(rn=null)):(nt=null,rn=Xe),nt!==rn)){if(ln=Hc,yt="onMouseLeave",Be="onMouseEnter",Ne="mouse",(r==="pointerout"||r==="pointerover")&&(ln=ld,yt="onPointerLeave",Be="onPointerEnter",Ne="pointer"),bi=nt==null?et:At(nt),He=rn==null?et:At(rn),et=new ln(yt,Ne+"leave",nt,m,dt),et.target=bi,et.relatedTarget=He,yt=null,ka(dt)===Xe&&(ln=new ln(Be,Ne+"enter",rn,m,dt),ln.target=He,ln.relatedTarget=bi,yt=ln),bi=yt,nt&&rn)t:{for(ln=nt,Be=rn,Ne=0,He=ln;He;He=Ih(He))Ne++;for(He=0,yt=Be;yt;yt=Ih(yt))He++;for(;0<Ne-He;)ln=Ih(ln),Ne--;for(;0<He-Ne;)Be=Ih(Be),He--;for(;Ne--;){if(ln===Be||Be!==null&&ln===Be.alternate)break t;ln=Ih(ln),Be=Ih(Be)}ln=null}else ln=null;nt!==null&&gy(vt,et,nt,ln,!1),rn!==null&&bi!==null&&gy(vt,bi,rn,ln,!0)}}e:{if(et=Xe?At(Xe):window,nt=et.nodeName&&et.nodeName.toLowerCase(),nt==="select"||nt==="input"&&et.type==="file")var $t=Sf;else if(nc(et))if(Ef)$t=Mg;else{$t=Ag;var Ln=au}else nt=et.nodeName,!nt||nt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?Xe&&ys(Xe.elementType)&&($t=Sf):$t=pd;if($t&&($t=$t(r,Xe))){Wp(vt,$t,m,dt);break e}Ln&&Ln(r,et,Xe),r==="focusout"&&Xe&&et.type==="number"&&Xe.memoizedProps.value!=null&&Wu(et,"number",et.value)}switch(Ln=Xe?At(Xe):window,r){case"focusin":(nc(Ln)||Ln.contentEditable==="true")&&(pl=Ln,ch=Xe,ou=null);break;case"focusout":ou=ch=pl=null;break;case"mousedown":uh=!0;break;case"contextmenu":case"mouseup":case"dragend":uh=!1,ml(vt,m,dt);break;case"selectionchange":if(Cf)break;case"keydown":case"keyup":ml(vt,m,dt)}var nn;if(tu)e:{switch(r){case"compositionstart":var dn="onCompositionStart";break e;case"compositionend":dn="onCompositionEnd";break e;case"compositionupdate":dn="onCompositionUpdate";break e}dn=void 0}else ro?hd(r,m)&&(dn="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(dn="onCompositionStart");dn&&(ih&&m.locale!=="ko"&&(ro||dn!=="onCompositionStart"?dn==="onCompositionEnd"&&ro&&(nn=hn()):(vs=dt,Cn="value"in vs?vs.value:vs.textContent,ro=!0)),Ln=dp(Xe,dn),0<Ln.length&&(dn=new Yp(dn,r,null,m,dt),vt.push({event:dn,listeners:Ln}),nn?dn.data=nn:(nn=nu(m),nn!==null&&(dn.data=nn)))),(nn=Tf?Hp(r,m):rh(r,m))&&(dn=dp(Xe,"onBeforeInput"),0<dn.length&&(Ln=new Yp("onBeforeInput","beforeinput",null,m,dt),vt.push({event:Ln,listeners:dn}),Ln.data=nn)),fy(vt,r,Xe,m,dt)}y0(vt,u)})}function Yd(r,u,m){return{instance:r,listener:u,currentTarget:m}}function dp(r,u){for(var m=u+"Capture",b=[];r!==null;){var M=r,z=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||z===null||(M=Li(r,m),M!=null&&b.unshift(Yd(r,M,z)),M=Li(r,u),M!=null&&b.push(Yd(r,M,z))),r.tag===3)return b;r=r.return}return[]}function Ih(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function gy(r,u,m,b,M){for(var z=u._reactName,X=[];m!==null&&m!==b;){var re=m,Se=re.alternate,Xe=re.stateNode;if(re=re.tag,Se!==null&&Se===b)break;re!==5&&re!==26&&re!==27||Xe===null||(Se=Xe,M?(Xe=Li(m,z),Xe!=null&&X.unshift(Yd(m,Xe,Se))):M||(Xe=Li(m,z),Xe!=null&&X.push(Yd(m,Xe,Se)))),m=m.return}X.length!==0&&r.push({event:u,listeners:X})}var _0=/\r\n?/g,yy=/\u0000|\uFFFD/g;function _y(r){return(typeof r=="string"?r:""+r).replace(_0,`
`).replace(yy,"")}function qd(r,u){return u=_y(u),_y(r)===u}function fp(){}function fi(r,u,m,b,M,z){switch(m){case"children":typeof b=="string"?u==="body"||u==="textarea"&&b===""||zo(r,b):(typeof b=="number"||typeof b=="bigint")&&u!=="body"&&zo(r,""+b);break;case"className":Ka(r,"class",b);break;case"tabIndex":Ka(r,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":Ka(r,m,b);break;case"style":to(r,b,z);break;case"data":if(u!=="object"){Ka(r,"data",b);break}case"src":case"href":if(b===""&&(u!=="a"||m!=="href")){r.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){r.removeAttribute(m);break}b=Yc(""+b),r.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){r.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(m==="formAction"?(u!=="input"&&fi(r,u,"name",M.name,M,null),fi(r,u,"formEncType",M.formEncType,M,null),fi(r,u,"formMethod",M.formMethod,M,null),fi(r,u,"formTarget",M.formTarget,M,null)):(fi(r,u,"encType",M.encType,M,null),fi(r,u,"method",M.method,M,null),fi(r,u,"target",M.target,M,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){r.removeAttribute(m);break}b=Yc(""+b),r.setAttribute(m,b);break;case"onClick":b!=null&&(r.onclick=fp);break;case"onScroll":b!=null&&Fn("scroll",r);break;case"onScrollEnd":b!=null&&Fn("scrollend",r);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(h(61));if(m=b.__html,m!=null){if(M.children!=null)throw Error(h(60));r.innerHTML=m}}break;case"multiple":r.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":r.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){r.removeAttribute("xlink:href");break}m=Yc(""+b),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?r.setAttribute(m,""+b):r.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?r.setAttribute(m,""):r.removeAttribute(m);break;case"capture":case"download":b===!0?r.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?r.setAttribute(m,b):r.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?r.setAttribute(m,b):r.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?r.removeAttribute(m):r.setAttribute(m,b);break;case"popover":Fn("beforetoggle",r),Fn("toggle",r),cl(r,"popover",b);break;case"xlinkActuate":Ia(r,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Ia(r,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Ia(r,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Ia(r,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Ia(r,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Ia(r,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Ia(r,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Ia(r,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Ia(r,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":cl(r,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=ec.get(m)||m,cl(r,m,b))}}function Dm(r,u,m,b,M,z){switch(m){case"style":to(r,b,z);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(h(61));if(m=b.__html,m!=null){if(M.children!=null)throw Error(h(60));r.innerHTML=m}}break;case"children":typeof b=="string"?zo(r,b):(typeof b=="number"||typeof b=="bigint")&&zo(r,""+b);break;case"onScroll":b!=null&&Fn("scroll",r);break;case"onScrollEnd":b!=null&&Fn("scrollend",r);break;case"onClick":b!=null&&(r.onclick=fp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yu.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(M=m.endsWith("Capture"),u=m.slice(2,M?m.length-7:void 0),z=r[yn]||null,z=z!=null?z[m]:null,typeof z=="function"&&r.removeEventListener(u,z,M),typeof b=="function")){typeof z!="function"&&z!==null&&(m in r?r[m]=null:r.hasAttribute(m)&&r.removeAttribute(m)),r.addEventListener(u,b,M);break e}m in r?r[m]=b:b===!0?r.setAttribute(m,""):cl(r,m,b)}}}function _i(r,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fn("error",r),Fn("load",r);var b=!1,M=!1,z;for(z in m)if(m.hasOwnProperty(z)){var X=m[z];if(X!=null)switch(z){case"src":b=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:fi(r,u,z,X,m,null)}}M&&fi(r,u,"srcSet",m.srcSet,m,null),b&&fi(r,u,"src",m.src,m,null);return;case"input":Fn("invalid",r);var re=z=X=M=null,Se=null,Xe=null;for(b in m)if(m.hasOwnProperty(b)){var dt=m[b];if(dt!=null)switch(b){case"name":M=dt;break;case"type":X=dt;break;case"checked":Se=dt;break;case"defaultChecked":Xe=dt;break;case"value":z=dt;break;case"defaultValue":re=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(h(137,u));break;default:fi(r,u,b,dt,m,null)}}Jl(r,z,re,Se,Xe,X,M,!1),Ro(r);return;case"select":Fn("invalid",r),b=X=z=null;for(M in m)if(m.hasOwnProperty(M)&&(re=m[M],re!=null))switch(M){case"value":z=re;break;case"defaultValue":X=re;break;case"multiple":b=re;default:fi(r,u,M,re,m,null)}u=z,m=X,r.multiple=!!b,u!=null?ul(r,!!b,u,!1):m!=null&&ul(r,!!b,m,!0);return;case"textarea":Fn("invalid",r),z=M=b=null;for(X in m)if(m.hasOwnProperty(X)&&(re=m[X],re!=null))switch(X){case"value":b=re;break;case"defaultValue":M=re;break;case"children":z=re;break;case"dangerouslySetInnerHTML":if(re!=null)throw Error(h(91));break;default:fi(r,u,X,re,m,null)}Qu(r,b,M,z),Ro(r);return;case"option":for(Se in m)if(m.hasOwnProperty(Se)&&(b=m[Se],b!=null))switch(Se){case"selected":r.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:fi(r,u,Se,b,m,null)}return;case"dialog":Fn("beforetoggle",r),Fn("toggle",r),Fn("cancel",r),Fn("close",r);break;case"iframe":case"object":Fn("load",r);break;case"video":case"audio":for(b=0;b<hp.length;b++)Fn(hp[b],r);break;case"image":Fn("error",r),Fn("load",r);break;case"details":Fn("toggle",r);break;case"embed":case"source":case"link":Fn("error",r),Fn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Xe in m)if(m.hasOwnProperty(Xe)&&(b=m[Xe],b!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:fi(r,u,Xe,b,m,null)}return;default:if(ys(u)){for(dt in m)m.hasOwnProperty(dt)&&(b=m[dt],b!==void 0&&Dm(r,u,dt,b,m,void 0));return}}for(re in m)m.hasOwnProperty(re)&&(b=m[re],b!=null&&fi(r,u,re,b,m,null))}function Hd(r,u,m,b){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,z=null,X=null,re=null,Se=null,Xe=null,dt=null;for(nt in m){var vt=m[nt];if(m.hasOwnProperty(nt)&&vt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":Se=vt;default:b.hasOwnProperty(nt)||fi(r,u,nt,null,b,vt)}}for(var et in b){var nt=b[et];if(vt=m[et],b.hasOwnProperty(et)&&(nt!=null||vt!=null))switch(et){case"type":z=nt;break;case"name":M=nt;break;case"checked":Xe=nt;break;case"defaultChecked":dt=nt;break;case"value":X=nt;break;case"defaultValue":re=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(h(137,u));break;default:nt!==vt&&fi(r,u,et,nt,b,vt)}}sd(r,X,re,Se,Xe,dt,z,M);return;case"select":nt=X=re=et=null;for(z in m)if(Se=m[z],m.hasOwnProperty(z)&&Se!=null)switch(z){case"value":break;case"multiple":nt=Se;default:b.hasOwnProperty(z)||fi(r,u,z,null,b,Se)}for(M in b)if(z=b[M],Se=m[M],b.hasOwnProperty(M)&&(z!=null||Se!=null))switch(M){case"value":et=z;break;case"defaultValue":re=z;break;case"multiple":X=z;default:z!==Se&&fi(r,u,M,z,b,Se)}u=re,m=X,b=nt,et!=null?ul(r,!!m,et,!1):!!b!=!!m&&(u!=null?ul(r,!!m,u,!0):ul(r,!!m,m?[]:"",!1));return;case"textarea":nt=et=null;for(re in m)if(M=m[re],m.hasOwnProperty(re)&&M!=null&&!b.hasOwnProperty(re))switch(re){case"value":break;case"children":break;default:fi(r,u,re,null,b,M)}for(X in b)if(M=b[X],z=m[X],b.hasOwnProperty(X)&&(M!=null||z!=null))switch(X){case"value":et=M;break;case"defaultValue":nt=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(h(91));break;default:M!==z&&fi(r,u,X,M,b,z)}_f(r,et,nt);return;case"option":for(var rn in m)if(et=m[rn],m.hasOwnProperty(rn)&&et!=null&&!b.hasOwnProperty(rn))switch(rn){case"selected":r.selected=!1;break;default:fi(r,u,rn,null,b,et)}for(Se in b)if(et=b[Se],nt=m[Se],b.hasOwnProperty(Se)&&et!==nt&&(et!=null||nt!=null))switch(Se){case"selected":r.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:fi(r,u,Se,et,b,nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ln in m)et=m[ln],m.hasOwnProperty(ln)&&et!=null&&!b.hasOwnProperty(ln)&&fi(r,u,ln,null,b,et);for(Xe in b)if(et=b[Xe],nt=m[Xe],b.hasOwnProperty(Xe)&&et!==nt&&(et!=null||nt!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(h(137,u));break;default:fi(r,u,Xe,et,b,nt)}return;default:if(ys(u)){for(var bi in m)et=m[bi],m.hasOwnProperty(bi)&&et!==void 0&&!b.hasOwnProperty(bi)&&Dm(r,u,bi,void 0,b,et);for(dt in b)et=b[dt],nt=m[dt],!b.hasOwnProperty(dt)||et===nt||et===void 0&&nt===void 0||Dm(r,u,dt,et,b,nt);return}}for(var Be in m)et=m[Be],m.hasOwnProperty(Be)&&et!=null&&!b.hasOwnProperty(Be)&&fi(r,u,Be,null,b,et);for(vt in b)et=b[vt],nt=m[vt],!b.hasOwnProperty(vt)||et===nt||et==null&&nt==null||fi(r,u,vt,et,b,nt)}var Pc=null,km=null;function pp(r){return r.nodeType===9?r:r.ownerDocument}function vy(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function xy(r,u){if(r===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&u==="foreignObject"?0:r}function by(r,u){return r==="textarea"||r==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Im=null;function Su(){var r=window.event;return r&&r.type==="popstate"?r===Im?!1:(Im=r,!0):(Im=null,!1)}var wy=typeof setTimeout=="function"?setTimeout:void 0,v0=typeof clearTimeout=="function"?clearTimeout:void 0,Ty=typeof Promise=="function"?Promise:void 0,x0=typeof queueMicrotask=="function"?queueMicrotask:typeof Ty<"u"?function(r){return Ty.resolve(null).then(r).catch(Fv)}:wy;function Fv(r){setTimeout(function(){throw r})}function Eu(r){return r==="head"}function Sy(r,u){var m=u,b=0,M=0;do{var z=m.nextSibling;if(r.removeChild(m),z&&z.nodeType===8)if(m=z.data,m==="/$"){if(0<b&&8>b){m=b;var X=r.ownerDocument;if(m&1&&Ol(X.documentElement),m&2&&Ol(X.body),m&4)for(m=X.head,Ol(m),X=m.firstChild;X;){var re=X.nextSibling,Se=X.nodeName;X[Ji]||Se==="SCRIPT"||Se==="STYLE"||Se==="LINK"&&X.rel.toLowerCase()==="stylesheet"||m.removeChild(X),X=re}}if(M===0){r.removeChild(z),Yi(u);return}M--}else m==="$"||m==="$?"||m==="$!"?M++:b=m.charCodeAt(0)-48;else b=0;m=z}while(m);Yi(u)}function Rm(r){var u=r.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Rm(m),Si(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}r.removeChild(m)}}function zm(r,u,m,b){for(;r.nodeType===1;){var M=m;if(r.nodeName.toLowerCase()!==u.toLowerCase()){if(!b&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(b){if(!r[Ji])switch(u){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(z=r.getAttribute("rel"),z==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(z!==M.rel||r.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(z=r.getAttribute("src"),(z!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&z&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(u==="input"&&r.type==="hidden"){var z=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===z)return r}else return r;if(r=us(r.nextSibling),r===null)break}return null}function b0(r,u,m){if(u==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!m||(r=us(r.nextSibling),r===null))return null;return r}function Xd(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function Nm(r,u){var m=r.ownerDocument;if(r.data!=="$?"||m.readyState==="complete")u();else{var b=function(){u(),m.removeEventListener("DOMContentLoaded",b)};m.addEventListener("DOMContentLoaded",b),r._reactRetry=b}}function us(r){for(;r!=null;r=r.nextSibling){var u=r.nodeType;if(u===1||u===3)break;if(u===8){if(u=r.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return r}var Ey=null;function w0(r){r=r.previousSibling;for(var u=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(u===0)return r;u--}else m==="/$"&&u++}r=r.previousSibling}return null}function T0(r,u,m){switch(u=pp(m),r){case"html":if(r=u.documentElement,!r)throw Error(h(452));return r;case"head":if(r=u.head,!r)throw Error(h(453));return r;case"body":if(r=u.body,!r)throw Error(h(454));return r;default:throw Error(h(451))}}function Ol(r){for(var u=r.attributes;u.length;)r.removeAttributeNode(u[0]);Si(r)}var vi=new Map,Pm=new Set;function mp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var jl=gt.d;gt.d={f:Ay,r:Uv,D:Vv,C:S0,L:Cy,m:Dy,X:gp,S:E0,M:ky};function Ay(){var r=jl.f(),u=sr();return r||u}function Uv(r){var u=Qa(r);u!==null&&u.tag===5&&u.type==="form"?oi(u):jl.r(r)}var Rh=typeof document>"u"?null:document;function My(r,u,m){var b=Rh;if(b&&typeof u=="string"&&u){var M=Ja(u);M='link[rel="'+r+'"][href="'+M+'"]',typeof m=="string"&&(M+='[crossorigin="'+m+'"]'),Pm.has(M)||(Pm.add(M),r={rel:r,crossOrigin:m,href:u},b.querySelector(M)===null&&(u=b.createElement("link"),_i(u,"link",r),Ht(u),b.head.appendChild(u)))}}function Vv(r){jl.D(r),My("dns-prefetch",r,null)}function S0(r,u){jl.C(r,u),My("preconnect",r,u)}function Cy(r,u,m){jl.L(r,u,m);var b=Rh;if(b&&r&&u){var M='link[rel="preload"][as="'+Ja(u)+'"]';u==="image"&&m&&m.imageSrcSet?(M+='[imagesrcset="'+Ja(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(M+='[imagesizes="'+Ja(m.imageSizes)+'"]')):M+='[href="'+Ja(r)+'"]';var z=M;switch(u){case"style":z=Au(r);break;case"script":z=Cu(r)}vi.has(z)||(r=P({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:r,as:u},m),vi.set(z,r),b.querySelector(M)!==null||u==="style"&&b.querySelector(Mu(z))||u==="script"&&b.querySelector(zh(z))||(u=b.createElement("link"),_i(u,"link",r),Ht(u),b.head.appendChild(u)))}}function Dy(r,u){jl.m(r,u);var m=Rh;if(m&&r){var b=u&&typeof u.as=="string"?u.as:"script",M='link[rel="modulepreload"][as="'+Ja(b)+'"][href="'+Ja(r)+'"]',z=M;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=Cu(r)}if(!vi.has(z)&&(r=P({rel:"modulepreload",href:r},u),vi.set(z,r),m.querySelector(M)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(zh(z)))return}b=m.createElement("link"),_i(b,"link",r),Ht(b),m.head.appendChild(b)}}}function E0(r,u,m){jl.S(r,u,m);var b=Rh;if(b&&r){var M=cn(b).hoistableStyles,z=Au(r);u=u||"default";var X=M.get(z);if(!X){var re={loading:0,preload:null};if(X=b.querySelector(Mu(z)))re.loading=5;else{r=P({rel:"stylesheet",href:r,"data-precedence":u},m),(m=vi.get(z))&&t(r,m);var Se=X=b.createElement("link");Ht(Se),_i(Se,"link",r),Se._p=new Promise(function(Xe,dt){Se.onload=Xe,Se.onerror=dt}),Se.addEventListener("load",function(){re.loading|=1}),Se.addEventListener("error",function(){re.loading|=2}),re.loading|=4,l(X,u,b)}X={type:"stylesheet",instance:X,count:1,state:re},M.set(z,X)}}}function gp(r,u){jl.X(r,u);var m=Rh;if(m&&r){var b=cn(m).hoistableScripts,M=Cu(r),z=b.get(M);z||(z=m.querySelector(zh(M)),z||(r=P({src:r,async:!0},u),(u=vi.get(M))&&a(r,u),z=m.createElement("script"),Ht(z),_i(z,"link",r),m.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},b.set(M,z))}}function ky(r,u){jl.M(r,u);var m=Rh;if(m&&r){var b=cn(m).hoistableScripts,M=Cu(r),z=b.get(M);z||(z=m.querySelector(zh(M)),z||(r=P({src:r,async:!0,type:"module"},u),(u=vi.get(M))&&a(r,u),z=m.createElement("script"),Ht(z),_i(z,"link",r),m.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},b.set(M,z))}}function Iy(r,u,m,b){var M=(M=Wt.current)?mp(M):null;if(!M)throw Error(h(446));switch(r){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=Au(m.href),m=cn(M).hoistableStyles,b=m.get(u),b||(b={type:"style",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){r=Au(m.href);var z=cn(M).hoistableStyles,X=z.get(r);if(X||(M=M.ownerDocument||M,X={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(r,X),(z=M.querySelector(Mu(r)))&&!z._p&&(X.instance=z,X.state.loading=5),vi.has(r)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},vi.set(r,m),z||Ry(M,r,m,X.state))),u&&b===null)throw Error(h(528,""));return X}if(u&&b!==null)throw Error(h(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Cu(m),m=cn(M).hoistableScripts,b=m.get(u),b||(b={type:"script",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(h(444,r))}}function Au(r){return'href="'+Ja(r)+'"'}function Mu(r){return'link[rel="stylesheet"]['+r+"]"}function Wd(r){return P({},r,{"data-precedence":r.precedence,precedence:null})}function Ry(r,u,m,b){r.querySelector('link[rel="preload"][as="style"]['+u+"]")?b.loading=1:(u=r.createElement("link"),b.preload=u,u.addEventListener("load",function(){return b.loading|=1}),u.addEventListener("error",function(){return b.loading|=2}),_i(u,"link",m),Ht(u),r.head.appendChild(u))}function Cu(r){return'[src="'+Ja(r)+'"]'}function zh(r){return"script[async]"+r}function A0(r,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var b=r.querySelector('style[data-href~="'+Ja(m.href)+'"]');if(b)return u.instance=b,Ht(b),b;var M=P({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(r.ownerDocument||r).createElement("style"),Ht(b),_i(b,"style",M),l(b,m.precedence,r),u.instance=b;case"stylesheet":M=Au(m.href);var z=r.querySelector(Mu(M));if(z)return u.state.loading|=4,u.instance=z,Ht(z),z;b=Wd(m),(M=vi.get(M))&&t(b,M),z=(r.ownerDocument||r).createElement("link"),Ht(z);var X=z;return X._p=new Promise(function(re,Se){X.onload=re,X.onerror=Se}),_i(z,"link",b),u.state.loading|=4,l(z,m.precedence,r),u.instance=z;case"script":return z=Cu(m.src),(M=r.querySelector(zh(z)))?(u.instance=M,Ht(M),M):(b=m,(M=vi.get(z))&&(b=P({},m),a(b,M)),r=r.ownerDocument||r,M=r.createElement("script"),Ht(M),_i(M,"link",b),r.head.appendChild(M),u.instance=M);case"void":return null;default:throw Error(h(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(b=u.instance,u.state.loading|=4,l(b,m.precedence,r));return u.instance}function l(r,u,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=b.length?b[b.length-1]:null,z=M,X=0;X<b.length;X++){var re=b[X];if(re.dataset.precedence===u)z=re;else if(z!==M)break}z?z.parentNode.insertBefore(r,z.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(r,u.firstChild))}function t(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.title==null&&(r.title=u.title)}function a(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.integrity==null&&(r.integrity=u.integrity)}var d=null;function y(r,u,m){if(d===null){var b=new Map,M=d=new Map;M.set(m,b)}else M=d,b=M.get(m),b||(b=new Map,M.set(m,b));if(b.has(r))return b;for(b.set(r,null),m=m.getElementsByTagName(r),M=0;M<m.length;M++){var z=m[M];if(!(z[Ji]||z[xn]||r==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var X=z.getAttribute(u)||"";X=r+X;var re=b.get(X);re?re.push(z):b.set(X,[z])}}return b}function T(r,u,m){r=r.ownerDocument||r,r.head.insertBefore(m,u==="title"?r.querySelector("head > title"):null)}function S(r,u,m){if(m===1||u.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return r=u.disabled,typeof u.precedence=="string"&&r==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function A(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var k=null;function N(){}function O(r,u,m){if(k===null)throw Error(h(475));var b=k;if(u.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var M=Au(m.href),z=r.querySelector(Mu(M));if(z){r=z._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(b.count++,b=$.bind(b),r.then(b,b)),u.state.loading|=4,u.instance=z,Ht(z);return}z=r.ownerDocument||r,m=Wd(m),(M=vi.get(M))&&t(m,M),z=z.createElement("link"),Ht(z);var X=z;X._p=new Promise(function(re,Se){X.onload=re,X.onerror=Se}),_i(z,"link",m),u.instance=z}b.stylesheets===null&&(b.stylesheets=new Map),b.stylesheets.set(u,r),(r=u.state.preload)&&(u.state.loading&3)===0&&(b.count++,u=$.bind(b),r.addEventListener("load",u),r.addEventListener("error",u))}}function F(){if(k===null)throw Error(h(475));var r=k;return r.stylesheets&&r.count===0&&W(r,r.stylesheets),0<r.count?function(u){var m=setTimeout(function(){if(r.stylesheets&&W(r,r.stylesheets),r.unsuspend){var b=r.unsuspend;r.unsuspend=null,b()}},6e4);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(m)}}:null}function $(){if(this.count--,this.count===0){if(this.stylesheets)W(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var H=null;function W(r,u){r.stylesheets=null,r.unsuspend!==null&&(r.count++,H=new Map,u.forEach(J,r),H=null,$.call(r))}function J(r,u){if(!(u.state.loading&4)){var m=H.get(r);if(m)var b=m.get(null);else{m=new Map,H.set(r,m);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<M.length;z++){var X=M[z];(X.nodeName==="LINK"||X.getAttribute("media")!=="not all")&&(m.set(X.dataset.precedence,X),b=X)}b&&m.set(null,b)}M=u.instance,X=M.getAttribute("data-precedence"),z=m.get(X)||b,z===b&&m.set(null,M),m.set(X,M),this.count++,b=$.bind(this),M.addEventListener("load",b),M.addEventListener("error",b),z?z.parentNode.insertBefore(M,z.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),u.state.loading|=4}}var oe={$$typeof:Je,Provider:null,Consumer:null,_currentValue:_t,_currentValue2:_t,_threadCount:0};function fe(r,u,m,b,M,z,X,re){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rt(0),this.hiddenUpdates=rt(null),this.identifierPrefix=b,this.onUncaughtError=M,this.onCaughtError=z,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function ke(r,u,m,b,M,z,X,re,Se,Xe,dt,vt){return r=new fe(r,u,m,X,re,Se,Xe,vt),u=1,z===!0&&(u|=24),z=oa(3,null,null,u),r.current=z,z.stateNode=r,u=bl(),u.refCount++,r.pooledCache=u,u.refCount++,z.memoizedState={element:b,isDehydrated:m,cache:u},_h(z),r}function xe(r){return r?(r=Ss,r):Ss}function q(r,u,m,b,M,z){M=xe(M),b.context===null?b.context=M:b.pendingContext=M,b=lo(u),b.payload={element:m},z=z===void 0?null:z,z!==null&&(b.callback=z),m=Go(r,b,u),m!==null&&(zs(m,r,u),Al(m,r,u))}function se(r,u){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<u?m:u}}function we(r,u){se(r,u),(r=r.alternate)&&se(r,u)}function Ge(r){if(r.tag===13){var u=Ts(r,67108864);u!==null&&zs(u,r,67108864),we(r,67108864)}}var ht=!0;function Qe(r,u,m,b){var M=Ye.T;Ye.T=null;var z=gt.p;try{gt.p=2,bt(r,u,m,b)}finally{gt.p=z,Ye.T=M}}function it(r,u,m,b){var M=Ye.T;Ye.T=null;var z=gt.p;try{gt.p=8,bt(r,u,m,b)}finally{gt.p=z,Ye.T=M}}function bt(r,u,m,b){if(ht){var M=pt(b);if(M===null)Ll(r,u,b,Tt,m),ba(r,b);else if(Fi(M,r,u,m,b))b.stopPropagation();else if(ba(r,b),u&4&&-1<Ns.indexOf(r)){for(;M!==null;){var z=Qa(M);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var X=le(z.pendingLanes);if(X!==0){var re=z;for(re.pendingLanes|=2,re.entangledLanes|=2;X;){var Se=1<<31-jr(X);re.entanglements[1]|=Se,X&=~Se}vo(z),(hi&6)===0&&(rp=qn()+500,cp(0))}}break;case 13:re=Ts(z,2),re!==null&&zs(re,z,2),sr(),we(z,2)}if(z=pt(b),z===null&&Ll(r,u,b,Tt,m),z===M)break;M=z}M!==null&&b.stopPropagation()}else Ll(r,u,b,null,m)}}function pt(r){return r=_s(r),at(r)}var Tt=null;function at(r){if(Tt=null,r=ka(r),r!==null){var u=_(r);if(u===null)r=null;else{var m=u.tag;if(m===13){if(r=v(u),r!==null)return r;r=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;r=null}else u!==r&&(r=null)}}return Tt=r,null}function Ft(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(aa()){case Or:return 2;case Yr:return 8;case qr:case ol:return 32;case gs:return 268435456;default:return 32}default:return 32}}var Yt=!1,Vt=null,jt=null,pn=null,xi=new Map,Zi=new Map,$i=[],Ns="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ba(r,u){switch(r){case"focusin":case"focusout":Vt=null;break;case"dragenter":case"dragleave":jt=null;break;case"mouseover":case"mouseout":pn=null;break;case"pointerover":case"pointerout":xi.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zi.delete(u.pointerId)}}function or(r,u,m,b,M,z){return r===null||r.nativeEvent!==z?(r={blockedOn:u,domEventName:m,eventSystemFlags:b,nativeEvent:z,targetContainers:[M]},u!==null&&(u=Qa(u),u!==null&&Ge(u)),r):(r.eventSystemFlags|=b,u=r.targetContainers,M!==null&&u.indexOf(M)===-1&&u.push(M),r)}function Fi(r,u,m,b,M){switch(u){case"focusin":return Vt=or(Vt,r,u,m,b,M),!0;case"dragenter":return jt=or(jt,r,u,m,b,M),!0;case"mouseover":return pn=or(pn,r,u,m,b,M),!0;case"pointerover":var z=M.pointerId;return xi.set(z,or(xi.get(z)||null,r,u,m,b,M)),!0;case"gotpointercapture":return z=M.pointerId,Zi.set(z,or(Zi.get(z)||null,r,u,m,b,M)),!0}return!1}function Ar(r){var u=ka(r.target);if(u!==null){var m=_(u);if(m!==null){if(u=m.tag,u===13){if(u=v(m),u!==null){r.blockedOn=u,Gt(r.priority,function(){if(m.tag===13){var b=cs();b=Dt(b);var M=Ts(m,b);M!==null&&zs(M,m,b),we(m,b)}});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function vr(r){if(r.blockedOn!==null)return!1;for(var u=r.targetContainers;0<u.length;){var m=pt(r.nativeEvent);if(m===null){m=r.nativeEvent;var b=new m.constructor(m.type,m);ga=b,m.target.dispatchEvent(b),ga=null}else return u=Qa(m),u!==null&&Ge(u),r.blockedOn=m,!1;u.shift()}return!0}function Pr(r,u,m){vr(r)&&m.delete(u)}function wa(){Yt=!1,Vt!==null&&vr(Vt)&&(Vt=null),jt!==null&&vr(jt)&&(jt=null),pn!==null&&vr(pn)&&(pn=null),xi.forEach(Pr),Zi.forEach(Pr)}function Ta(r,u){r.blockedOn===u&&(r.blockedOn=null,Yt||(Yt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,wa)))}var lr=null;function Sa(r){lr!==r&&(lr=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){lr===r&&(lr=null);for(var u=0;u<r.length;u+=3){var m=r[u],b=r[u+1],M=r[u+2];if(typeof b!="function"){if(at(b||m)===null)continue;break}var z=Qa(m);z!==null&&(r.splice(u,3),u-=3,ni(z,{pending:!0,data:M,method:m.method,action:b},b,M))}}))}function Yi(r){function u(Se){return Ta(Se,r)}Vt!==null&&Ta(Vt,r),jt!==null&&Ta(jt,r),pn!==null&&Ta(pn,r),xi.forEach(u),Zi.forEach(u);for(var m=0;m<$i.length;m++){var b=$i[m];b.blockedOn===r&&(b.blockedOn=null)}for(;0<$i.length&&(m=$i[0],m.blockedOn===null);)Ar(m),m.blockedOn===null&&$i.shift();if(m=(r.ownerDocument||r).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var M=m[b],z=m[b+1],X=M[yn]||null;if(typeof z=="function")X||Sa(m);else if(X){var re=null;if(z&&z.hasAttribute("formAction")){if(M=z,X=z[yn]||null)re=X.formAction;else if(at(M)!==null)continue}else re=X.action;typeof re=="function"?m[b+1]=re:(m.splice(b,3),b-=3),Sa(m)}}}function xr(r){this._internalRoot=r}cr.prototype.render=xr.prototype.render=function(r){var u=this._internalRoot;if(u===null)throw Error(h(409));var m=u.current,b=cs();q(m,b,r,u,null,null)},cr.prototype.unmount=xr.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var u=r.containerInfo;q(r.current,2,null,r,null,null),sr(),u[Dn]=null}};function cr(r){this._internalRoot=r}cr.prototype.unstable_scheduleHydration=function(r){if(r){var u=Pt();r={blockedOn:null,target:r,priority:u};for(var m=0;m<$i.length&&u!==0&&u<$i[m].priority;m++);$i.splice(m,0,r),m===0&&Ar(r)}};var ur=n.version;if(ur!=="19.1.0")throw Error(h(527,ur,"19.1.0"));gt.findDOMNode=function(r){var u=r._reactInternals;if(u===void 0)throw typeof r.render=="function"?Error(h(188)):(r=Object.keys(r).join(","),Error(h(268,r)));return r=D(u),r=r!==null?I(r):null,r=r===null?null:r.stateNode,r};var Mi={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Ye,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hs.isDisabled&&hs.supportsFiber)try{Hr=hs.inject(Mi),ci=hs}catch{}}return Ny.createRoot=function(r,u){if(!p(r))throw Error(h(299));var m=!1,b="",M=Dg,z=q_,X=kg,re=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(M=u.onUncaughtError),u.onCaughtError!==void 0&&(z=u.onCaughtError),u.onRecoverableError!==void 0&&(X=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(re=u.unstable_transitionCallbacks)),u=ke(r,1,!1,null,null,m,b,M,z,X,re,null),r[Dn]=u.current,my(r),new xr(u)},Ny.hydrateRoot=function(r,u,m){if(!p(r))throw Error(h(299));var b=!1,M="",z=Dg,X=q_,re=kg,Se=null,Xe=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onUncaughtError!==void 0&&(z=m.onUncaughtError),m.onCaughtError!==void 0&&(X=m.onCaughtError),m.onRecoverableError!==void 0&&(re=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(Se=m.unstable_transitionCallbacks),m.formState!==void 0&&(Xe=m.formState)),u=ke(r,1,!0,u,m??null,b,M,z,X,re,Se,Xe),u.context=xe(null),m=u.current,b=cs(),b=Dt(b),M=lo(b),M.callback=null,Go(m,M,b),m=b,u.current.lanes=m,Ke(u,m),vo(u),r[Dn]=u.current,my(r),new cr(u)},Ny.version="19.1.0",Ny}var a1;function bE(){if(a1)return Yv.exports;a1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Yv.exports=xE(),Yv.exports}var wE=bE();const TE=jp(wE),SE="modulepreload",EE=function(i){return"https://www.opentripplanner.org/debug-client-assets/2025/06/2025-06-19T11:08/"+i},s1={},t2=function(n,o,h){let p=Promise.resolve();if(o&&o.length>0){let v=function(I){return Promise.all(I.map(P=>Promise.resolve(P).then(B=>({status:"fulfilled",value:B}),B=>({status:"rejected",reason:B}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),D=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));p=v(o.map(I=>{if(I=EE(I),I in s1)return;s1[I]=!0;const P=I.endsWith(".css"),B=P?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${I}"]${B}`))return;const U=document.createElement("link");if(U.rel=P?"stylesheet":SE,P||(U.as="script"),U.crossOrigin="",U.href=I,D&&U.setAttribute("nonce",D),document.head.appendChild(U),P)return new Promise((Z,ne)=>{U.addEventListener("load",Z),U.addEventListener("error",()=>ne(new Error(`Unable to preload CSS for ${I}`)))})}))}function _(v){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=v,window.dispatchEvent(c),!c.defaultPrevented)throw v}return p.then(v=>{for(const c of v||[])c.status==="rejected"&&_(c.reason);return n().catch(_)})},AE=he.createContext(null);function ME(i,n){const o=Array.isArray(i)?i[0]:i?i.x:0,h=Array.isArray(i)?i[1]:i?i.y:0,p=Array.isArray(n)?n[0]:n?n.x:0,_=Array.isArray(n)?n[1]:n?n.y:0;return o===p&&h===_}function xo(i,n){if(i===n)return!0;if(!i||!n)return!1;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let o=0;o<i.length;o++)if(!xo(i[o],n[o]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof i=="object"&&typeof n=="object"){const o=Object.keys(i),h=Object.keys(n);if(o.length!==h.length)return!1;for(const p of o)if(!n.hasOwnProperty(p)||!xo(i[p],n[p]))return!1;return!0}return!1}function o1(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function l1(i,n){const o=n.viewState||n,h={};if("longitude"in o&&"latitude"in o&&(o.longitude!==i.center.lng||o.latitude!==i.center.lat)){const p=i.center.constructor;h.center=new p(o.longitude,o.latitude)}return"zoom"in o&&o.zoom!==i.zoom&&(h.zoom=o.zoom),"bearing"in o&&o.bearing!==i.bearing&&(h.bearing=o.bearing),"pitch"in o&&o.pitch!==i.pitch&&(h.pitch=o.pitch),o.padding&&i.padding&&!xo(o.padding,i.padding)&&(h.padding=o.padding),h}const CE=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function c1(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const n={};for(const h of i.layers)n[h.id]=h;const o=i.layers.map(h=>{let p=null;"interactive"in h&&(p=Object.assign({},h),delete p.interactive);const _=n[h.ref];if(_){p=p||Object.assign({},h),delete p.ref;for(const v of CE)v in _&&(p[v]=_[v])}return p||h});return{...i,layers:o}}const u1={version:8,sources:{},layers:[]},h1={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},d1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},f1={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},DE=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],kE=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Qm{constructor(n,o,h){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=p=>{const _=this.props[f1[p.type]];_?_(p):p.type==="error"&&console.error(p.error)},this._onCameraEvent=p=>{if(this._internalUpdate)return;p.viewState=this._propsedCameraUpdate||o1(this._map.transform);const _=this.props[d1[p.type]];_&&_(p)},this._onCameraUpdate=p=>this._internalUpdate?p:(this._propsedCameraUpdate=o1(p),l1(p,this.props)),this._onPointerEvent=p=>{(p.type==="mousemove"||p.type==="mouseout")&&this._updateHover(p);const _=this.props[h1[p.type]];_&&(this.props.interactiveLayerIds&&p.type!=="mouseover"&&p.type!=="mouseout"&&(p.features=this._hoveredFeatures||this._queryRenderedFeatures(p.point)),_(p),delete p.features)},this._MapClass=n,this.props=o,this._initialize(h)}get map(){return this._map}setProps(n){const o=this.props;this.props=n;const h=this._updateSettings(n,o),p=this._updateSize(n),_=this._updateViewState(n);this._updateStyle(n,o),this._updateStyleComponents(n),this._updateHandlers(n,o),(h||p||_&&!this._map.isMoving())&&this.redraw()}static reuse(n,o){const h=Qm.savedMaps.pop();if(!h)return null;const p=h.map,_=p.getContainer();for(o.className=_.className;_.childNodes.length>0;)o.appendChild(_.childNodes[0]);p._container=o;const v=p._resizeObserver;v&&(v.disconnect(),v.observe(o)),h.setProps({...n,styleDiffing:!1}),p.resize();const{initialViewState:c}=n;return c&&(c.bounds?p.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):h._updateViewState(c)),p.isStyleLoaded()?p.fire("load"):p.once("style.load",()=>p.fire("load")),p._update(),h}_initialize(n){const{props:o}=this,{mapStyle:h=u1}=o,p={...o,...o.initialViewState,container:n,style:c1(h)},_=p.initialViewState||p.viewState||p;if(Object.assign(p,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),o.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,o.gl)}const v=new this._MapClass(p);_.padding&&v.setPadding(_.padding),o.cursor&&(v.getCanvas().style.cursor=o.cursor),v.transformCameraUpdate=this._onCameraUpdate,v.on("style.load",()=>{var c;this._styleComponents={light:v.getLight(),sky:v.getSky(),projection:(c=v.getProjection)==null?void 0:c.call(v),terrain:v.getTerrain()},this._updateStyleComponents(this.props)}),v.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in h1)v.on(c,this._onPointerEvent);for(const c in d1)v.on(c,this._onCameraEvent);for(const c in f1)v.on(c,this._onEvent);this._map=v}recycle(){const o=this.map.getContainer().querySelector("[mapboxgl-children]");o==null||o.remove(),Qm.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_updateSize(n){const{viewState:o}=n;if(o){const h=this._map;if(o.width!==h.transform.width||o.height!==h.transform.height)return h.resize(),!0}return!1}_updateViewState(n){const o=this._map,h=o.transform;if(!o.isMoving()){const _=l1(h,n);if(Object.keys(_).length>0)return this._internalUpdate=!0,o.jumpTo(_),this._internalUpdate=!1,!0}return!1}_updateSettings(n,o){const h=this._map;let p=!1;for(const _ of DE)if(_ in n&&!xo(n[_],o[_])){p=!0;const v=h[`set${_[0].toUpperCase()}${_.slice(1)}`];v==null||v.call(h,n[_])}return p}_updateStyle(n,o){if(n.cursor!==o.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==o.mapStyle){const{mapStyle:h=u1,styleDiffing:p=!0}=n,_={diff:p};"localIdeographFontFamily"in n&&(_.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(c1(h),_)}}_updateStyleComponents({light:n,projection:o,sky:h,terrain:p}){var c,D;const _=this._map,v=this._styleComponents;_.style._loaded&&(n&&!xo(n,v.light)&&(v.light=n,_.setLight(n)),o&&!xo(o,v.projection)&&o!==((c=v.projection)==null?void 0:c.type)&&(v.projection=typeof o=="string"?{type:o}:o,(D=_.setProjection)==null||D.call(_,v.projection)),h&&!xo(h,v.sky)&&(v.sky=h,_.setSky(h)),p!==void 0&&!xo(p,v.terrain)&&(!p||_.getSource(p.source))&&(v.terrain=p,_.setTerrain(p)))}_updateHandlers(n,o){const h=this._map;for(const p of kE){const _=n[p]??!0,v=o[p]??!0;xo(_,v)||(_?h[p].enable(_):h[p].disable())}}_queryRenderedFeatures(n){const o=this._map,{interactiveLayerIds:h=[]}=this.props;try{return o.queryRenderedFeatures(n,{layers:h.filter(o.getLayer.bind(o))})}catch{return[]}}_updateHover(n){var p;const{props:o}=this;if(o.interactiveLayerIds&&(o.onMouseMove||o.onMouseEnter||o.onMouseLeave)){const _=n.type,v=((p=this._hoveredFeatures)==null?void 0:p.length)>0,c=this._queryRenderedFeatures(n.point),D=c.length>0;!D&&v&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=c,D&&!v&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=_}else this._hoveredFeatures=null}}Qm.savedMaps=[];const IE=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function RE(i){if(!i)return null;const n=i.map,o={getMap:()=>n};for(const h of zE(n))!(h in o)&&!IE.includes(h)&&(o[h]=n[h].bind(n));return o}function zE(i){const n=new Set;let o=i;for(;o;){for(const h of Object.getOwnPropertyNames(o))h[0]!=="_"&&typeof i[h]=="function"&&h!=="fire"&&h!=="setEventedParent"&&n.add(h);o=Object.getPrototypeOf(o)}return Array.from(n)}const NE=typeof document<"u"?he.useLayoutEffect:he.useEffect;function PE(i,n){const{RTLTextPlugin:o,maxParallelImageRequests:h,workerCount:p,workerUrl:_}=n;if(o&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:v,lazy:c=!0}=typeof o=="string"?{pluginUrl:o}:o;i.setRTLTextPlugin(v,D=>{D&&console.error(D)},c)}h!==void 0&&i.setMaxParallelImageRequests(h),p!==void 0&&i.setWorkerCount(p),_!==void 0&&i.setWorkerUrl(_)}const ug=he.createContext(null);function LE(i,n){const o=he.useContext(AE),[h,p]=he.useState(null),_=he.useRef(),{current:v}=he.useRef({mapLib:null,map:null});he.useEffect(()=>{const I=i.mapLib;let P=!0,B;return Promise.resolve(I||t2(()=>Promise.resolve().then(()=>o2),void 0)).then(U=>{if(!P)return;if(!U)throw new Error("Invalid mapLib");const Z="Map"in U?U:U.default;if(!Z.Map)throw new Error("Invalid mapLib");PE(Z,i),i.reuseMaps&&(B=Qm.reuse(i,_.current)),B||(B=new Qm(Z.Map,i,_.current)),v.map=RE(B),v.mapLib=Z,p(B),o==null||o.onMapMount(v.map,i.id)}).catch(U=>{const{onError:Z}=i;Z?Z({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{P=!1,B&&(o==null||o.onMapUnmount(i.id),i.reuseMaps?B.recycle():B.destroy())}},[]),NE(()=>{h&&h.setProps(i)}),he.useImperativeHandle(n,()=>v.map,[h]);const c=he.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),D={height:"100%"};return he.createElement("div",{id:i.id,ref:_,style:c},h&&he.createElement(ug.Provider,{value:v},he.createElement("div",{"mapboxgl-children":"",style:D},i.children)))}const OE=he.forwardRef(LE);var sb=e2();const wp=jp(sb),jE=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function td(i,n){if(!i||!n)return;const o=i.style;for(const h in n){const p=n[h];Number.isFinite(p)&&!jE.test(h)?o[h]=`${p}px`:o[h]=p}}function n2(i,n){if(i===n)return null;const o=p1(i),h=p1(n),p=[];for(const _ of h)o.has(_)||p.push(_);for(const _ of o)h.has(_)||p.push(_);return p.length===0?null:p}function p1(i){return new Set(i?i.trim().split(/\s+/):[])}const m1=he.memo(he.forwardRef((i,n)=>{const{map:o,mapLib:h}=he.useContext(ug),p=he.useRef({props:i}),_=he.useMemo(()=>{let Pe=!1;he.Children.forEach(i.children,$e=>{$e&&(Pe=!0)});const tt={...i,element:Pe?document.createElement("div"):void 0},Je=new h.Marker(tt);return Je.setLngLat([i.longitude,i.latitude]),Je.getElement().addEventListener("click",$e=>{var Me,Ve;(Ve=(Me=p.current.props).onClick)==null||Ve.call(Me,{type:"click",target:Je,originalEvent:$e})}),Je.on("dragstart",$e=>{var Ve,ct;const Me=$e;Me.lngLat=_.getLngLat(),(ct=(Ve=p.current.props).onDragStart)==null||ct.call(Ve,Me)}),Je.on("drag",$e=>{var Ve,ct;const Me=$e;Me.lngLat=_.getLngLat(),(ct=(Ve=p.current.props).onDrag)==null||ct.call(Ve,Me)}),Je.on("dragend",$e=>{var Ve,ct;const Me=$e;Me.lngLat=_.getLngLat(),(ct=(Ve=p.current.props).onDragEnd)==null||ct.call(Ve,Me)}),Je},[]);he.useEffect(()=>(_.addTo(o.getMap()),()=>{_.remove()}),[]);const{longitude:v,latitude:c,offset:D,style:I,draggable:P=!1,popup:B=null,rotation:U=0,rotationAlignment:Z="auto",pitchAlignment:ne="auto"}=i;he.useEffect(()=>{td(_.getElement(),I)},[I]),he.useImperativeHandle(n,()=>_,[]);const ye=p.current.props;(_.getLngLat().lng!==v||_.getLngLat().lat!==c)&&_.setLngLat([v,c]),D&&!ME(_.getOffset(),D)&&_.setOffset(D),_.isDraggable()!==P&&_.setDraggable(P),_.getRotation()!==U&&_.setRotation(U),_.getRotationAlignment()!==Z&&_.setRotationAlignment(Z),_.getPitchAlignment()!==ne&&_.setPitchAlignment(ne),_.getPopup()!==B&&_.setPopup(B);const me=n2(ye.className,i.className);if(me)for(const Pe of me)_.toggleClassName(Pe);return p.current.props=i,sb.createPortal(i.children,_.getElement())})),i2=he.memo(he.forwardRef((i,n)=>{const{map:o,mapLib:h}=he.useContext(ug),p=he.useMemo(()=>document.createElement("div"),[]),_=he.useRef({props:i}),v=he.useMemo(()=>{const c={...i},D=new h.Popup(c);return D.setLngLat([i.longitude,i.latitude]),D.once("open",I=>{var P,B;(B=(P=_.current.props).onOpen)==null||B.call(P,I)}),D},[]);if(he.useEffect(()=>{const c=D=>{var I,P;(P=(I=_.current.props).onClose)==null||P.call(I,D)};return v.on("close",c),v.setDOMContent(p).addTo(o.getMap()),()=>{v.off("close",c),v.isOpen()&&v.remove()}},[]),he.useEffect(()=>{td(v.getElement(),i.style)},[i.style]),he.useImperativeHandle(n,()=>v,[]),v.isOpen()){const c=_.current.props;(v.getLngLat().lng!==i.longitude||v.getLngLat().lat!==i.latitude)&&v.setLngLat([i.longitude,i.latitude]),i.offset&&!xo(c.offset,i.offset)&&v.setOffset(i.offset),(c.anchor!==i.anchor||c.maxWidth!==i.maxWidth)&&(v.options.anchor=i.anchor,v.setMaxWidth(i.maxWidth));const D=n2(c.className,i.className);if(D)for(const I of D)v.toggleClassName(I);_.current.props=i}return sb.createPortal(i.children,p)}));function Bp(i,n,o,h){const p=he.useContext(ug),_=he.useMemo(()=>i(p),[]);return he.useEffect(()=>{const v=n,c=null,D=typeof n=="function"?n:null,{map:I}=p;return I.hasControl(_)||(I.addControl(_,v==null?void 0:v.position),c&&c(p)),()=>{D&&D(p),I.hasControl(_)&&I.removeControl(_)}},[]),_}function BE(i){const n=Bp(({mapLib:o})=>new o.AttributionControl(i),{position:i.position});return he.useEffect(()=>{td(n._container,i.style)},[i.style]),null}he.memo(BE);function FE(i){const n=Bp(({mapLib:o})=>new o.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return he.useEffect(()=>{td(n._controlContainer,i.style)},[i.style]),null}he.memo(FE);function UE(i,n){const o=he.useRef({props:i}),h=Bp(({mapLib:p})=>{const _=new p.GeolocateControl(i),v=_._setupUI;return _._setupUI=()=>{_._container.hasChildNodes()||v()},_.on("geolocate",c=>{var D,I;(I=(D=o.current.props).onGeolocate)==null||I.call(D,c)}),_.on("error",c=>{var D,I;(I=(D=o.current.props).onError)==null||I.call(D,c)}),_.on("outofmaxbounds",c=>{var D,I;(I=(D=o.current.props).onOutOfMaxBounds)==null||I.call(D,c)}),_.on("trackuserlocationstart",c=>{var D,I;(I=(D=o.current.props).onTrackUserLocationStart)==null||I.call(D,c)}),_.on("trackuserlocationend",c=>{var D,I;(I=(D=o.current.props).onTrackUserLocationEnd)==null||I.call(D,c)}),_},{position:i.position});return o.current.props=i,he.useImperativeHandle(n,()=>h,[]),he.useEffect(()=>{td(h._container,i.style)},[i.style]),null}he.memo(he.forwardRef(UE));function VE(i){const n=Bp(({mapLib:o})=>new o.NavigationControl(i),{position:i.position});return he.useEffect(()=>{td(n._container,i.style)},[i.style]),null}const GE=he.memo(VE);function ZE(i){const n=Bp(({mapLib:_})=>new _.ScaleControl(i),{position:i.position}),o=he.useRef(i),h=o.current;o.current=i;const{style:p}=i;return i.maxWidth!==void 0&&i.maxWidth!==h.maxWidth&&(n.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==h.unit&&n.setUnit(i.unit),he.useEffect(()=>{td(n._container,p)},[p]),null}he.memo(ZE);function $E(i){const n=Bp(({mapLib:o})=>new o.TerrainControl(i),{position:i.position});return he.useEffect(()=>{td(n._container,i.style)},[i.style]),null}he.memo($E);function YE(i){const n=Bp(({mapLib:o})=>new o.LogoControl(i),{position:i.position});return he.useEffect(()=>{td(n._container,i.style)},[i.style]),null}he.memo(YE);function U0(i,n){if(!i)throw new Error(n)}let qE=0;function HE(i,n,o){if(i.style&&i.style._loaded){const h={...o};return delete h.id,delete h.children,i.addSource(n,h),i.getSource(n)}return null}function XE(i,n,o){var v,c,D;U0(n.id===o.id,"source id changed"),U0(n.type===o.type,"source type changed");let h="",p=0;for(const I in n)I!=="children"&&I!=="id"&&!xo(o[I],n[I])&&(h=I,p++);if(!p)return;const _=n.type;if(_==="geojson")i.setData(n.data);else if(_==="image")i.updateImage({url:n.url,coordinates:n.coordinates});else switch(h){case"coordinates":(v=i.setCoordinates)==null||v.call(i,n.coordinates);break;case"url":(c=i.setUrl)==null||c.call(i,n.url);break;case"tiles":(D=i.setTiles)==null||D.call(i,n.tiles);break;default:console.warn(`Unable to update <Source> prop: ${h}`)}}function WE(i){const n=he.useContext(ug).map.getMap(),o=he.useRef(i),[,h]=he.useState(0),p=he.useMemo(()=>i.id||`jsx-source-${qE++}`,[]);he.useEffect(()=>{if(n){const v=()=>setTimeout(()=>h(c=>c+1),0);return n.on("styledata",v),v(),()=>{var c;if(n.off("styledata",v),n.style&&n.style._loaded&&n.getSource(p)){const D=(c=n.getStyle())==null?void 0:c.layers;if(D)for(const I of D)I.source===p&&n.removeLayer(I.id);n.removeSource(p)}}}},[n]);let _=n&&n.style&&n.getSource(p);return _?XE(_,i,o.current):_=HE(n,p,i),o.current=i,_&&he.Children.map(i.children,v=>v&&he.cloneElement(v,{source:p}))||null}function QE(i,n,o,h){if(U0(o.id===h.id,"layer id changed"),U0(o.type===h.type,"layer type changed"),o.type==="custom"||h.type==="custom")return;const{layout:p={},paint:_={},filter:v,minzoom:c,maxzoom:D,beforeId:I}=o;if(I!==h.beforeId&&i.moveLayer(n,I),p!==h.layout){const P=h.layout||{};for(const B in p)xo(p[B],P[B])||i.setLayoutProperty(n,B,p[B]);for(const B in P)p.hasOwnProperty(B)||i.setLayoutProperty(n,B,void 0)}if(_!==h.paint){const P=h.paint||{};for(const B in _)xo(_[B],P[B])||i.setPaintProperty(n,B,_[B]);for(const B in P)_.hasOwnProperty(B)||i.setPaintProperty(n,B,void 0)}xo(v,h.filter)||i.setFilter(n,v),(c!==h.minzoom||D!==h.maxzoom)&&i.setLayerZoomRange(n,c,D)}function KE(i,n,o){if(i.style&&i.style._loaded&&(!("source"in o)||i.getSource(o.source))){const h={...o,id:n};delete h.beforeId,i.addLayer(h,o.beforeId)}}let JE=0;function g1(i){const n=he.useContext(ug).map.getMap(),o=he.useRef(i),[,h]=he.useState(0),p=he.useMemo(()=>i.id||`jsx-layer-${JE++}`,[]);if(he.useEffect(()=>{if(n){const v=()=>h(c=>c+1);return n.on("styledata",v),v(),()=>{n.off("styledata",v),n.style&&n.style._loaded&&n.getLayer(p)&&n.removeLayer(p)}}},[n]),n&&n.style&&n.getLayer(p))try{QE(n,p,i,o.current)}catch(v){console.warn(v)}else KE(n,p,i);return o.current=i,null}var N0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.0/LICENSE.txt
 */var eA=N0.exports,y1;function tA(){return y1||(y1=1,function(i,n){(function(o,h){i.exports=h()})(eA,function(){var o={},h={};function p(v,c,D){if(h[v]=D,v==="index"){var I="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",P={};return h.shared(P),h.index(o,P),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([I],{type:"text/javascript"}))),o}}p("shared",["exports"],function(v){function c(l,t,a,d){return new(a||(a=Promise))(function(y,T){function S(N){try{k(d.next(N))}catch(O){T(O)}}function A(N){try{k(d.throw(N))}catch(O){T(O)}}function k(N){var O;N.done?y(N.value):(O=N.value,O instanceof a?O:new a(function(F){F(O)})).then(S,A)}k((d=d.apply(l,t||[])).next())})}function D(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var I,P;function B(){if(P)return I;function l(t,a){this.x=t,this.y=a}return P=1,I=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,a){return this.clone()._rotateAround(t,a)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var a=t.x-this.x,d=t.y-this.y;return a*a+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,a){return Math.atan2(this.x*a-this.y*t,this.x*t+this.y*a)},_matMult:function(t){var a=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=a,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var a=Math.cos(t),d=Math.sin(t),y=d*this.x+a*this.y;return this.x=a*this.x-d*this.y,this.y=y,this},_rotateAround:function(t,a){var d=Math.cos(t),y=Math.sin(t),T=a.y+y*(this.x-a.x)+d*(this.y-a.y);return this.x=a.x+d*(this.x-a.x)-y*(this.y-a.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(t){return t instanceof l?t:Array.isArray(t)?new l(t[0],t[1]):t},I}typeof SuppressedError=="function"&&SuppressedError;var U,Z,ne=D(B()),ye=function(){if(Z)return U;function l(t,a,d,y){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(y-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=d,this.p2y=y}return Z=1,U=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,y=0;y<8;y++){var T=this.sampleCurveX(d)-t;if(Math.abs(T)<a)return d;var S=this.sampleCurveDerivativeX(d);if(Math.abs(S)<1e-6)break;d-=T/S}var A=0,k=1;for(d=t,y=0;y<20&&(T=this.sampleCurveX(d),!(Math.abs(T-t)<a));y++)t>T?A=d:k=d,d=.5*(k-A)+A;return d},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},U}(),me=D(ye);let Pe,tt;function Je(){return Pe==null&&(Pe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Pe}function $e(){if(tt==null&&(tt=!1,Je())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let d=0;d<5*5;d++){const y=4*d;t.fillStyle=`rgb(${y},${y+1},${y+2})`,t.fillRect(d%5,Math.floor(d/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let d=0;d<5*5*4;d++)if(d%4!=3&&a[d]!==d){tt=!0;break}}}return tt||!1}var Me=1e-6,Ve=typeof Float32Array<"u"?Float32Array:Array;function ct(){var l=new Ve(9);return Ve!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function ot(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Re(){var l=new Ve(3);return Ve!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function mt(l){return Math.hypot(l[0],l[1],l[2])}function It(l,t,a){var d=new Ve(3);return d[0]=l,d[1]=t,d[2]=a,d}function Lt(l,t,a){return l[0]=t[0]+a[0],l[1]=t[1]+a[1],l[2]=t[2]+a[2],l}function Ut(l,t,a){return l[0]=t[0]*a,l[1]=t[1]*a,l[2]=t[2]*a,l}function sn(l,t,a){var d=t[0],y=t[1],T=t[2],S=a[0],A=a[1],k=a[2];return l[0]=y*k-T*A,l[1]=T*S-d*k,l[2]=d*A-y*S,l}Math.hypot||(Math.hypot=function(){for(var l=0,t=arguments.length;t--;)l+=arguments[t]*arguments[t];return Math.sqrt(l)});var on,Ye=mt;function gt(l,t,a){var d=t[0],y=t[1],T=t[2],S=t[3];return l[0]=a[0]*d+a[4]*y+a[8]*T+a[12]*S,l[1]=a[1]*d+a[5]*y+a[9]*T+a[13]*S,l[2]=a[2]*d+a[6]*y+a[10]*T+a[14]*S,l[3]=a[3]*d+a[7]*y+a[11]*T+a[15]*S,l}function _t(){var l=new Ve(4);return Ve!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function qt(l,t,a,d){var y=.5*Math.PI/180;t*=y,a*=y,d*=y;var T=Math.sin(t),S=Math.cos(t),A=Math.sin(a),k=Math.cos(a),N=Math.sin(d),O=Math.cos(d);return l[0]=T*k*O-S*A*N,l[1]=S*A*O+T*k*N,l[2]=S*k*N-T*A*O,l[3]=S*k*O+T*A*N,l}function Ce(){var l=new Ve(2);return Ve!=Float32Array&&(l[0]=0,l[1]=0),l}function ut(l,t){var a=new Ve(2);return a[0]=l,a[1]=t,a}Re(),on=new Ve(4),Ve!=Float32Array&&(on[0]=0,on[1]=0,on[2]=0,on[3]=0),Re(),It(1,0,0),It(0,1,0),_t(),_t(),ct(),Ce();const wt=8192;function Mt(l,t,a){return t*(wt/(l.tileSize*Math.pow(2,a-l.tileID.overscaledZ)))}function Rt(l,t){return(l%t+t)%t}function Jt(l,t,a){return l*(1-a)+t*a}function Wt(l){if(l<=0)return 0;if(l>=1)return 1;const t=l*l,a=t*l;return 4*(l<.5?a:3*(l-t)+a-.75)}function Ri(l,t,a,d){const y=new me(l,t,a,d);return T=>y.solve(T)}const zn=Ri(.25,.1,.25,1);function Gn(l,t,a){return Math.min(a,Math.max(t,l))}function Ca(l,t,a){const d=a-t,y=((l-t)%d+d)%d+t;return y===t?a:y}function Hi(l,...t){for(const a of t)for(const d in a)l[d]=a[d];return l}let Xa=1;function Xn(l,t,a){const d={};for(const y in l)d[y]=t.call(this,l[y],y,l);return d}function br(l,t,a){const d={};for(const y in l)t.call(this,l[y],y,l)&&(d[y]=l[y]);return d}function Pn(l){return Array.isArray(l)?l.map(Pn):typeof l=="object"&&l?Xn(l,Pn):l}const Wa={};function qn(l){Wa[l]||(typeof console<"u"&&console.warn(l),Wa[l]=!0)}function aa(l,t,a){return(a.y-l.y)*(t.x-l.x)>(t.y-l.y)*(a.x-l.x)}function Or(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let Yr=null;function qr(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gs(l,t,a,d,y){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(l,{timestamp:0});try{const S=T==null?void 0:T.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const A=S.startsWith("BGR"),k=new Uint8ClampedArray(d*y*4);if(yield T.copyTo(k,function(N,O,F,$,H){const W=4*Math.max(1,0),J=(Math.max(0,F)-F)*$*4+W,oe=4*$,fe=Math.max(0,O),ke=Math.max(0,F);return{rect:{x:fe,y:ke,width:Math.min(N.width,O+$)-fe,height:Math.min(N.height,F+H)-ke},layout:[{offset:J,stride:oe}]}}(l,t,a,d,y)),A)for(let N=0;N<k.length;N+=4){const O=k[N];k[N]=k[N+2],k[N+2]=O}return k}finally{T.close()}})}let Da,Js;function Hr(l,t,a,d){return l.addEventListener(t,a,d),{unsubscribe:()=>{l.removeEventListener(t,a,d)}}}function ci(l){return l*Math.PI/180}function dr(l){return l/Math.PI*180}const jr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ad={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Do="AbortError";function Oe(){return new Error(Do)}const ee={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ie(l){return ee.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const le="global-dispatcher";class ve extends Error{constructor(t,a,d,y){super(`AJAXError: ${a} (${t}): ${d}`),this.status=t,this.statusText=a,this.url=d,this.body=y}}const De=()=>Or(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Le=function(l,t){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const d=ie(l.url);if(d)return d(l,t);if(Or(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,targetMapId:le},t)}if(!(/^file:/.test(a=l.url)||/^file:/.test(De())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,y){return c(this,void 0,void 0,function*(){const T=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:De(),signal:y.signal});let S,A;d.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{S=yield fetch(T)}catch(N){throw new ve(0,N.message,d.url,new Blob)}if(!S.ok){const N=yield S.blob();throw new ve(S.status,S.statusText,d.url,N)}A=d.type==="arrayBuffer"||d.type==="image"?S.arrayBuffer():d.type==="json"?S.json():S.text();const k=yield A;if(y.signal.aborted)throw Oe();return{data:k,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(l,t);if(Or(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,mustQueue:!0,targetMapId:le},t)}var a;return function(d,y){return new Promise((T,S)=>{var A;const k=new XMLHttpRequest;k.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(k.responseType="arraybuffer");for(const N in d.headers)k.setRequestHeader(N,d.headers[N]);d.type==="json"&&(k.responseType="text",!((A=d.headers)===null||A===void 0)&&A.Accept||k.setRequestHeader("Accept","application/json")),k.withCredentials=d.credentials==="include",k.onerror=()=>{S(new Error(k.statusText))},k.onload=()=>{if(!y.signal.aborted)if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let N=k.response;if(d.type==="json")try{N=JSON.parse(k.response)}catch(O){return void S(O)}T({data:N,cacheControl:k.getResponseHeader("Cache-Control"),expires:k.getResponseHeader("Expires")})}else{const N=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});S(new ve(k.status,k.statusText,d.url,N))}},y.signal.addEventListener("abort",()=>{k.abort(),S(Oe())}),k.send(d.body)})}(l,t)};function Ze(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const t=new URL(l),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function ze(l,t,a){a[l]&&a[l].indexOf(t)!==-1||(a[l]=a[l]||[],a[l].push(t))}function rt(l,t,a){if(a&&a[l]){const d=a[l].indexOf(t);d!==-1&&a[l].splice(d,1)}}class Ke{constructor(t,a={}){Hi(this,a),this.type=t}}class je extends Ke{constructor(t,a={}){super("error",Hi({error:t},a))}}class lt{on(t,a){return this._listeners=this._listeners||{},ze(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return rt(t,a,this._listeners),rt(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},ze(t,a,this._oneTimeListeners),this):new Promise(d=>this.once(t,d))}fire(t,a){typeof t=="string"&&(t=new Ke(t,a||{}));const d=t.type;if(this.listens(d)){t.target=this;const y=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const A of y)A.call(this,t);const T=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const A of T)rt(d,A,this._oneTimeListeners),A.call(this,t);const S=this._eventedParent;S&&(Hi(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(t))}else t instanceof je&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Dt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Kt(l,t){const a={};for(const d in l)d!=="ref"&&(a[d]=l[d]);return Dt.forEach(d=>{d in t&&(a[d]=t[d])}),a}function Pt(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let a=0;a<l.length;a++)if(!Pt(l[a],t[a]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const a in l)if(!Pt(l[a],t[a]))return!1;return!0}return l===t}function Gt(l,t){l.push(t)}function Qt(l,t,a){Gt(a,{command:"addSource",args:[l,t[l]]})}function xn(l,t,a){Gt(t,{command:"removeSource",args:[l]}),a[l]=!0}function yn(l,t,a,d){xn(l,a,d),Qt(l,t,a)}function Dn(l,t,a){let d;for(d in l[a])if(Object.prototype.hasOwnProperty.call(l[a],d)&&d!=="data"&&!Pt(l[a][d],t[a][d]))return!1;for(d in t[a])if(Object.prototype.hasOwnProperty.call(t[a],d)&&d!=="data"&&!Pt(l[a][d],t[a][d]))return!1;return!0}function en(l,t,a,d,y,T){l=l||{},t=t||{};for(const S in l)Object.prototype.hasOwnProperty.call(l,S)&&(Pt(l[S],t[S])||a.push({command:T,args:[d,S,t[S],y]}));for(const S in t)Object.prototype.hasOwnProperty.call(t,S)&&!Object.prototype.hasOwnProperty.call(l,S)&&(Pt(l[S],t[S])||a.push({command:T,args:[d,S,t[S],y]}))}function In(l){return l.id}function Ir(l,t){return l[t.id]=t,l}class St{constructor(t,a,d,y){this.message=(t?`${t}: `:"")+d,y&&(this.identifier=y),a!=null&&a.__line__&&(this.line=a.__line__)}}function Ji(l,...t){for(const a of t)for(const d in a)l[d]=a[d];return l}class Si extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class ka{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[d,y]of a)this.bindings[d]=y}concat(t){return new ka(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Qa={kind:"null"},At={kind:"number"},cn={kind:"string"},Ht={kind:"boolean"},ma={kind:"color"},Yu={kind:"projectionDefinition"},Xr={kind:"object"},un={kind:"value"},ko={kind:"collator"},ll={kind:"formatted"},Xi={kind:"padding"},qu={kind:"colorArray"},cl={kind:"numberArray"},Ka={kind:"resolvedImage"},Ia={kind:"variableAnchorOffsetCollection"};function sa(l,t){return{kind:"array",itemType:l,N:t}}function zi(l){if(l.kind==="array"){const t=zi(l.itemType);return typeof l.N=="number"?`array<${t}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${t}>`}return l.kind}const Wl=[Qa,At,cn,Ht,ma,Yu,ll,Xr,sa(un),Xi,cl,qu,Ka,Ia];function Ql(l,t){if(t.kind==="error")return null;if(l.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ql(l.itemType,t.itemType))&&(typeof l.N!="number"||l.N===t.N))return null}else{if(l.kind===t.kind)return null;if(l.kind==="value"){for(const a of Wl)if(!Ql(a,t))return null}}return`Expected ${zi(l)} but found ${zi(t)} instead.`}function $c(l,t){return t.some(a=>a.kind===l.kind)}function Kl(l,t){return t.some(a=>a==="null"?l===null:a==="array"?Array.isArray(l):a==="object"?l&&!Array.isArray(l)&&typeof l=="object":a===typeof l)}function Io(l,t){return l.kind==="array"&&t.kind==="array"?l.itemType.kind===t.itemType.kind&&typeof l.N=="number":l.kind===t.kind}const Ra=.96422,gf=.82521,$p=4/29,Ro=6/29,yf=3*Ro*Ro,Hu=Ro*Ro*Ro,Xu=Math.PI/180,Ja=180/Math.PI;function sd(l){return(l%=360)<0&&(l+=360),l}function Jl([l,t,a,d]){let y,T;const S=ul((.2225045*(l=Wu(l))+.7168786*(t=Wu(t))+.0606169*(a=Wu(a)))/1);l===t&&t===a?y=T=S:(y=ul((.4360747*l+.3850649*t+.1430804*a)/Ra),T=ul((.0139322*l+.0971045*t+.7141733*a)/gf));const A=116*S-16;return[A<0?0:A,500*(y-S),200*(S-T),d]}function Wu(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function ul(l){return l>Hu?Math.pow(l,1/3):l/yf+$p}function _f([l,t,a,d]){let y=(l+16)/116,T=isNaN(t)?y:y+t/500,S=isNaN(a)?y:y-a/200;return y=1*zo(y),T=Ra*zo(T),S=gf*zo(S),[Qu(3.1338561*T-1.6168667*y-.4906146*S),Qu(-.9787684*T+1.9161415*y+.033454*S),Qu(.0719453*T-.2289914*y+1.4052427*S),d]}function Qu(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function zo(l){return l>Ro?l*l*l:yf*(l-$p)}const eo=Object.hasOwn||function(l,t){return Object.prototype.hasOwnProperty.call(l,t)};function En(l,t){return eo(l,t)?l[t]:void 0}function to(l){return parseInt(l.padEnd(2,l),16)/255}function ys(l,t){return ec(t?l/100:l,0,1)}function ec(l,t,a){return Math.min(Math.max(t,l),a)}function vf(l){return!l.some(Number.isNaN)}const Yc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ga(l,t,a){return l+a*(t-l)}function _s(l,t,a){return l.map((d,y)=>ga(d,t[y],a))}class mn{constructor(t,a,d,y=1,T=!0){this.r=t,this.g=a,this.b=d,this.a=y,T||(this.r*=y,this.g*=y,this.b*=y,y||this.overwriteGetter("rgb",[t,a,d,y]))}static parse(t){if(t instanceof mn)return t;if(typeof t!="string")return;const a=function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];const y=En(Yc,d);if(y){const[S,A,k]=y;return[S/255,A/255,k/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const S=d.length<6?1:2;let A=1;return[to(d.slice(A,A+=S)),to(d.slice(A,A+=S)),to(d.slice(A,A+=S)),to(d.slice(A,A+S)||"ff")]}if(d.startsWith("rgb")){const S=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[A,k,N,O,F,$,H,W,J,oe,fe,ke]=S,xe=[O||" ",H||" ",oe].join("");if(xe==="  "||xe==="  /"||xe===",,"||xe===",,,"){const q=[N,$,J].join(""),se=q==="%%%"?100:q===""?255:0;if(se){const we=[ec(+k/se,0,1),ec(+F/se,0,1),ec(+W/se,0,1),fe?ys(+fe,ke):1];if(vf(we))return we}}return}}const T=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[S,A,k,N,O,F,$,H,W]=T,J=[k||" ",O||" ",$].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const oe=[+A,ec(+N,0,100),ec(+F,0,100),H?ys(+H,W):1];if(vf(oe))return function([fe,ke,xe,q]){function se(we){const Ge=(we+fe/30)%12,ht=ke*Math.min(xe,1-xe);return xe-ht*Math.max(-1,Math.min(Ge-3,9-Ge,1))}return fe=sd(fe),ke/=100,xe/=100,[se(0),se(8),se(4),q]}(oe)}}}(t);return a?new mn(...a,!1):void 0}get rgb(){const{r:t,g:a,b:d,a:y}=this,T=y||1/0;return this.overwriteGetter("rgb",[t/T,a/T,d/T,y])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,d,y,T]=Jl(t),S=Math.sqrt(d*d+y*y);return[Math.round(1e4*S)?sd(Math.atan2(y,d)*Ja):NaN,S,a,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Jl(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,d,y]=this.rgb;return`rgba(${[t,a,d].map(T=>Math.round(255*T)).join(",")},${y})`}static interpolate(t,a,d,y="rgb"){switch(y){case"rgb":{const[T,S,A,k]=_s(t.rgb,a.rgb,d);return new mn(T,S,A,k,!1)}case"hcl":{const[T,S,A,k]=t.hcl,[N,O,F,$]=a.hcl;let H,W;if(isNaN(T)||isNaN(N))isNaN(T)?isNaN(N)?H=NaN:(H=N,A!==1&&A!==0||(W=O)):(H=T,F!==1&&F!==0||(W=S));else{let xe=N-T;N>T&&xe>180?xe-=360:N<T&&T-N>180&&(xe+=360),H=T+d*xe}const[J,oe,fe,ke]=function([xe,q,se,we]){return xe=isNaN(xe)?0:xe*Xu,_f([se,Math.cos(xe)*q,Math.sin(xe)*q,we])}([H,W??ga(S,O,d),ga(A,F,d),ga(k,$,d)]);return new mn(J,oe,fe,ke,!1)}case"lab":{const[T,S,A,k]=_f(_s(t.lab,a.lab,d));return new mn(T,S,A,k,!1)}}}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);class no{constructor(t,a,d){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ku=["bottom","center","top"];class Ju{constructor(t,a,d,y,T,S){this.text=t,this.image=a,this.scale=d,this.fontStack=y,this.textColor=T,this.verticalAlign=S}}class Br{constructor(t){this.sections=t}static fromString(t){return new Br([new Ju(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Br?t:Br.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Li{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Li)return t;if(typeof t=="number")return new Li([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Li(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,d){return new Li(_s(t.values,a.values,d))}}class Oi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Oi)return t;if(typeof t=="number")return new Oi([t]);if(Array.isArray(t)){for(const a of t)if(typeof a!="number")return;return new Oi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,d){return new Oi(_s(t.values,a.values,d))}}class fr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof fr)return t;if(typeof t=="string"){const d=mn.parse(t);return d?new fr([d]):void 0}if(!Array.isArray(t))return;const a=[];for(const d of t){if(typeof d!="string")return;const y=mn.parse(d);if(!y)return;a.push(y)}return new fr(a)}toString(){return JSON.stringify(this.values)}static interpolate(t,a,d,y="rgb"){const T=[];if(t.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let S=0;S<t.values.length;S++)T.push(mn.interpolate(t.values[S],a.values[S],d,y));return new fr(T)}}class ui extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const vs=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Cn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Cn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const d=t[a],y=t[a+1];if(typeof d!="string"||!vs.has(d)||!Array.isArray(y)||y.length!==2||typeof y[0]!="number"||typeof y[1]!="number")return}return new Cn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,d){const y=t.values,T=a.values;if(y.length!==T.length)throw new ui(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const S=[];for(let A=0;A<y.length;A+=2){if(y[A]!==T[A])throw new ui(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${y[A]}, to[${A}]: ${T[A]}`);S.push(y[A]);const[k,N]=y[A+1],[O,F]=T[A+1];S.push([ga(k,O,d),ga(N,F,d)])}return new Cn(S)}}class Fr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Fr({name:t,available:!1}):null}}class hn{constructor(t,a,d){this.from=t,this.to=a,this.transition=d}static interpolate(t,a,d){return new hn(t,a,d)}static parse(t){return t instanceof hn?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new hn(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new hn(t.from,t.to,t.transition):typeof t=="string"?new hn(t,t,1):void 0}}function fn(l,t,a,d){return typeof l=="number"&&l>=0&&l<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[l,t,a,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[l,t,a,d]:[l,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function io(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof hn||l instanceof mn||l instanceof no||l instanceof Br||l instanceof Li||l instanceof Oi||l instanceof fr||l instanceof Cn||l instanceof Fr)return!0;if(Array.isArray(l)){for(const t of l)if(!io(t))return!1;return!0}if(typeof l=="object"){for(const t in l)if(!io(l[t]))return!1;return!0}return!1}function tn(l){if(l===null)return Qa;if(typeof l=="string")return cn;if(typeof l=="boolean")return Ht;if(typeof l=="number")return At;if(l instanceof mn)return ma;if(l instanceof hn)return Yu;if(l instanceof no)return ko;if(l instanceof Br)return ll;if(l instanceof Li)return Xi;if(l instanceof Oi)return cl;if(l instanceof fr)return qu;if(l instanceof Cn)return Ia;if(l instanceof Fr)return Ka;if(Array.isArray(l)){const t=l.length;let a;for(const d of l){const y=tn(d);if(a){if(a===y)continue;a=un;break}a=y}return sa(a||un,t)}return Xr}function pr(l){const t=typeof l;return l===null?"":t==="string"||t==="number"||t==="boolean"?String(l):l instanceof mn||l instanceof hn||l instanceof Br||l instanceof Li||l instanceof Oi||l instanceof fr||l instanceof Cn||l instanceof Fr?l.toString():JSON.stringify(l)}class er{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!io(t[1]))return a.error("invalid value");const d=t[1];let y=tn(d);const T=a.expectedType;return y.kind!=="array"||y.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(y=T),new er(y,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const No={string:cn,number:At,boolean:Ht,object:Xr};class Wr{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let d,y=1;const T=t[0];if(T==="array"){let A,k;if(t.length>2){const N=t[1];if(typeof N!="string"||!(N in No)||N==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);A=No[N],y++}else A=un;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);k=t[2],y++}d=sa(A,k)}else{if(!No[T])throw new Error(`Types doesn't contain name = ${T}`);d=No[T]}const S=[];for(;y<t.length;y++){const A=a.parse(t[y],y,un);if(!A)return null;S.push(A)}return new Wr(d,S)}evaluate(t){for(let a=0;a<this.args.length;a++){const d=this.args[a].evaluate(t);if(!Ql(this.type,tn(d)))return d;if(a===this.args.length-1)throw new ui(`Expected value to be of type ${zi(this.type)}, but found ${zi(tn(d))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const xf={"to-boolean":Ht,"to-color":ma,"to-number":At,"to-string":cn};class es{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const d=t[0];if(!xf[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&t.length!==2)return a.error("Expected one argument.");const y=xf[d],T=[];for(let S=1;S<t.length;S++){const A=a.parse(t[S],S,un);if(!A)return null;T.push(A)}return new es(y,T)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,d;for(const y of this.args){if(a=y.evaluate(t),d=null,a instanceof mn)return a;if(typeof a=="string"){const T=t.parseColor(a);if(T)return T}else if(Array.isArray(a)&&(d=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:fn(a[0],a[1],a[2],a[3]),!d))return new mn(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new ui(d||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const d of this.args){a=d.evaluate(t);const y=Li.parse(a);if(y)return y}throw new ui(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const d of this.args){a=d.evaluate(t);const y=Oi.parse(a);if(y)return y}throw new ui(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const d of this.args){a=d.evaluate(t);const y=fr.parse(a);if(y)return y}throw new ui(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const d of this.args){a=d.evaluate(t);const y=Cn.parse(a);if(y)return y}throw new ui(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const d of this.args){if(a=d.evaluate(t),a===null)return 0;const y=Number(a);if(!isNaN(y))return y}throw new ui(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Br.fromString(pr(this.args[0].evaluate(t)));case"resolvedImage":return Fr.fromString(pr(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return pr(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const od=["Unknown","Point","LineString","Polygon"];class qc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?od[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache.get(t);return a||(a=mn.parse(t),this._parseColorCache.set(t,a)),a}}class hl{constructor(t,a,d=[],y,T=new ka,S=[]){this.registry=t,this.path=d,this.key=d.map(A=>`[${A}]`).join(""),this.scope=T,this.errors=S,this.expectedType=y,this._isConstant=a}parse(t,a,d,y,T={}){return a?this.concat(a,d,y)._parse(t,T):this._parse(t,T)}_parse(t,a){function d(y,T,S){return S==="assert"?new Wr(T,[y]):S==="coerce"?new es(T,[y]):y}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=t[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[y];if(T){let S=T.parse(t,this);if(!S)return null;if(this.expectedType){const A=this.expectedType,k=S.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||k.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(k.kind)||A.kind==="colorArray"&&["value","string","array"].includes(k.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))S=d(S,A,a.typeAnnotation||"coerce");else if(this.checkSubtype(A,k))return null}else S=d(S,A,a.typeAnnotation||"assert")}if(!(S instanceof er)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const A=new qc;try{S=new er(S.type,S.evaluate(A))}catch(k){return this.error(k.message),null}}return S}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,d){const y=typeof t=="number"?this.path.concat(t):this.path,T=d?this.scope.concat(d):this.scope;return new hl(this.registry,this._isConstant,y,a||null,T,this.errors)}error(t,...a){const d=`${this.key}${a.map(y=>`[${y}]`).join("")}`;this.errors.push(new Si(d,t))}checkSubtype(t,a){const d=Ql(t,a);return d&&this.error(d),d}}class Hc{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const d=[];for(let T=1;T<t.length-1;T+=2){const S=t[T];if(typeof S!="string")return a.error(`Expected string, but found ${typeof S} instead.`,T);if(/[^a-zA-Z0-9_]/.test(S))return a.error("Variable names must contain only alphanumeric characters or '_'.",T);const A=a.parse(t[T+1],T+1);if(!A)return null;d.push([S,A])}const y=a.parse(t[t.length-1],t.length-1,a.expectedType,d);return y?new Hc(d,y):null}outputDefined(){return this.result.outputDefined()}}class xs{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const d=t[1];return a.scope.has(d)?new xs(d,a.scope.get(d)):a.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Rr{constructor(t,a,d){this.type=t,this.index=a,this.input=d}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const d=a.parse(t[1],1,At),y=a.parse(t[2],2,sa(a.expectedType||un));return d&&y?new Rr(y.type.itemType,d,y):null}evaluate(t){const a=this.index.evaluate(t),d=this.input.evaluate(t);if(a<0)throw new ui(`Array index out of bounds: ${a} < 0.`);if(a>=d.length)throw new ui(`Array index out of bounds: ${a} > ${d.length-1}.`);if(a!==Math.floor(a))throw new ui(`Array index must be an integer, but found ${a} instead.`);return d[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Xc{constructor(t,a){this.type=Ht,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const d=a.parse(t[1],1,un),y=a.parse(t[2],2,un);return d&&y?$c(d.type,[Ht,cn,At,Qa,un])?new Xc(d,y):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(d.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!d)return!1;if(!Kl(a,["boolean","string","number","null"]))throw new ui(`Expected first argument to be of type boolean, string, number or null, but found ${zi(tn(a))} instead.`);if(!Kl(d,["string","array"]))throw new ui(`Expected second argument to be of type array or string, but found ${zi(tn(d))} instead.`);return d.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class tc{constructor(t,a,d){this.type=At,this.needle=t,this.haystack=a,this.fromIndex=d}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const d=a.parse(t[1],1,un),y=a.parse(t[2],2,un);if(!d||!y)return null;if(!$c(d.type,[Ht,cn,At,Qa,un]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(d.type)} instead`);if(t.length===4){const T=a.parse(t[3],3,At);return T?new tc(d,y,T):null}return new tc(d,y)}evaluate(t){const a=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!Kl(a,["boolean","string","number","null"]))throw new ui(`Expected first argument to be of type boolean, string, number or null, but found ${zi(tn(a))} instead.`);let y;if(this.fromIndex&&(y=this.fromIndex.evaluate(t)),Kl(d,["string"])){const T=d.indexOf(a,y);return T===-1?-1:[...d.slice(0,T)].length}if(Kl(d,["array"]))return d.indexOf(a,y);throw new ui(`Expected second argument to be of type array or string, but found ${zi(tn(d))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Wc{constructor(t,a,d,y,T,S){this.inputType=t,this.type=a,this.input=d,this.cases=y,this.outputs=T,this.otherwise=S}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let d,y;a.expectedType&&a.expectedType.kind!=="value"&&(y=a.expectedType);const T={},S=[];for(let N=2;N<t.length-1;N+=2){let O=t[N];const F=t[N+1];Array.isArray(O)||(O=[O]);const $=a.concat(N);if(O.length===0)return $.error("Expected at least one branch label.");for(const W of O){if(typeof W!="number"&&typeof W!="string")return $.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return $.error("Numeric branch labels must be integer values.");if(d){if($.checkSubtype(d,tn(W)))return null}else d=tn(W);if(T[String(W)]!==void 0)return $.error("Branch labels must be unique.");T[String(W)]=S.length}const H=a.parse(F,N,y);if(!H)return null;y=y||H.type,S.push(H)}const A=a.parse(t[1],1,un);if(!A)return null;const k=a.parse(t[t.length-1],t.length-1,y);return k?A.type.kind!=="value"&&a.concat(1).checkSubtype(d,A.type)?null:new Wc(d,y,A,T,S,k):null}evaluate(t){const a=this.input.evaluate(t);return(tn(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class mr{constructor(t,a,d){this.type=t,this.branches=a,this.otherwise=d}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let d;a.expectedType&&a.expectedType.kind!=="value"&&(d=a.expectedType);const y=[];for(let S=1;S<t.length-1;S+=2){const A=a.parse(t[S],S,Ht);if(!A)return null;const k=a.parse(t[S+1],S+1,d);if(!k)return null;y.push([A,k]),d=d||k.type}const T=a.parse(t[t.length-1],t.length-1,d);if(!T)return null;if(!d)throw new Error("Can't infer output type");return new mr(d,y,T)}evaluate(t){for(const[a,d]of this.branches)if(a.evaluate(t))return d.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,d]of this.branches)t(a),t(d);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class eh{constructor(t,a,d,y){this.type=t,this.input=a,this.beginIndex=d,this.endIndex=y}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const d=a.parse(t[1],1,un),y=a.parse(t[2],2,At);if(!d||!y)return null;if(!$c(d.type,[sa(un),cn,un]))return a.error(`Expected first argument to be of type array or string, but found ${zi(d.type)} instead`);if(t.length===4){const T=a.parse(t[3],3,At);return T?new eh(d.type,d,y,T):null}return new eh(d.type,d,y)}evaluate(t){const a=this.input.evaluate(t),d=this.beginIndex.evaluate(t);let y;if(this.endIndex&&(y=this.endIndex.evaluate(t)),Kl(a,["string"]))return[...a].slice(d,y).join("");if(Kl(a,["array"]))return a.slice(d,y);throw new ui(`Expected first argument to be of type array or string, but found ${zi(tn(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Qc(l,t){const a=l.length-1;let d,y,T=0,S=a,A=0;for(;T<=S;)if(A=Math.floor((T+S)/2),d=l[A],y=l[A+1],d<=t){if(A===a||t<y)return A;T=A+1}else{if(!(d>t))throw new ui("Input is not a number.");S=A-1}return 0}class Kc{constructor(t,a,d){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[y,T]of d)this.labels.push(y),this.outputs.push(T)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const d=a.parse(t[1],1,At);if(!d)return null;const y=[];let T=null;a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType);for(let S=1;S<t.length;S+=2){const A=S===1?-1/0:t[S],k=t[S+1],N=S,O=S+1;if(typeof A!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(y.length&&y[y.length-1][0]>=A)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);const F=a.parse(k,O,T);if(!F)return null;T=T||F.type,y.push([A,F])}return new Kc(T,d,y)}evaluate(t){const a=this.labels,d=this.outputs;if(a.length===1)return d[0].evaluate(t);const y=this.input.evaluate(t);if(y<=a[0])return d[0].evaluate(t);const T=a.length;return y>=a[T-1]?d[T-1].evaluate(t):d[Qc(a,y)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Yp(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var dl,th,bf=function(){if(th)return dl;function l(t,a,d,y){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(y-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=d,this.p2y=y}return th=1,dl=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,y=0;y<8;y++){var T=this.sampleCurveX(d)-t;if(Math.abs(T)<a)return d;var S=this.sampleCurveDerivativeX(d);if(Math.abs(S)<1e-6)break;d-=T/S}var A=0,k=1;for(d=t,y=0;y<20&&(T=this.sampleCurveX(d),!(Math.abs(T-t)<a));y++)t>T?A=d:k=d,d=.5*(k-A)+A;return d},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},dl}(),bg=Yp(bf);class Ur{constructor(t,a,d,y,T){this.type=t,this.operator=a,this.interpolation=d,this.input=y,this.labels=[],this.outputs=[];for(const[S,A]of T)this.labels.push(S),this.outputs.push(A)}static interpolationFactor(t,a,d,y){let T=0;if(t.name==="exponential")T=Jc(a,t.base,d,y);else if(t.name==="linear")T=Jc(a,1,d,y);else if(t.name==="cubic-bezier"){const S=t.controlPoints;T=new bg(S[0],S[1],S[2],S[3]).solve(Jc(a,1,d,y))}return T}static parse(t,a){let[d,y,T,...S]=t;if(!Array.isArray(y)||y.length===0)return a.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const N=y[1];if(typeof N!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:N}}else{if(y[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const N=y.slice(1);if(N.length!==4||N.some(O=>typeof O!="number"||O<0||O>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:N}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(T=a.parse(T,2,At),!T)return null;const A=[];let k=null;d!=="interpolate-hcl"&&d!=="interpolate-lab"||a.expectedType==qu?a.expectedType&&a.expectedType.kind!=="value"&&(k=a.expectedType):k=ma;for(let N=0;N<S.length;N+=2){const O=S[N],F=S[N+1],$=N+3,H=N+4;if(typeof O!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(A.length&&A[A.length-1][0]>=O)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const W=a.parse(F,H,k);if(!W)return null;k=k||W.type,A.push([O,W])}return Io(k,At)||Io(k,Yu)||Io(k,ma)||Io(k,Xi)||Io(k,cl)||Io(k,qu)||Io(k,Ia)||Io(k,sa(At))?new Ur(k,d,y,T,A):a.error(`Type ${zi(k)} is not interpolatable.`)}evaluate(t){const a=this.labels,d=this.outputs;if(a.length===1)return d[0].evaluate(t);const y=this.input.evaluate(t);if(y<=a[0])return d[0].evaluate(t);const T=a.length;if(y>=a[T-1])return d[T-1].evaluate(t);const S=Qc(a,y),A=Ur.interpolationFactor(this.interpolation,y,a[S],a[S+1]),k=d[S].evaluate(t),N=d[S+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ga(k,N,A);case"color":return mn.interpolate(k,N,A);case"padding":return Li.interpolate(k,N,A);case"colorArray":return fr.interpolate(k,N,A);case"numberArray":return Oi.interpolate(k,N,A);case"variableAnchorOffsetCollection":return Cn.interpolate(k,N,A);case"array":return _s(k,N,A);case"projectionDefinition":return hn.interpolate(k,N,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return mn.interpolate(k,N,A,"hcl");case"colorArray":return fr.interpolate(k,N,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return mn.interpolate(k,N,A,"lab");case"colorArray":return fr.interpolate(k,N,A,"lab")}}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Jc(l,t,a,d){const y=d-a,T=l-a;return y===0?0:t===1?T/y:(Math.pow(t,T)-1)/(Math.pow(t,y)-1)}const za={color:mn.interpolate,number:ga,padding:Li.interpolate,numberArray:Oi.interpolate,colorArray:fr.interpolate,variableAnchorOffsetCollection:Cn.interpolate,array:_s};class ya{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let d=null;const y=a.expectedType;y&&y.kind!=="value"&&(d=y);const T=[];for(const A of t.slice(1)){const k=a.parse(A,1+T.length,d,void 0,{typeAnnotation:"omit"});if(!k)return null;d=d||k.type,T.push(k)}if(!d)throw new Error("No output type");const S=y&&T.some(A=>Ql(y,A.type));return new ya(S?un:d,T)}evaluate(t){let a,d=null,y=0;for(const T of this.args)if(y++,d=T.evaluate(t),d&&d instanceof Fr&&!d.available&&(a||(a=d.name),d=null,y===this.args.length&&(d=a)),d!==null)break;return d}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function ld(l,t){return l==="=="||l==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function nh(l,t,a,d){return d.compare(t,a)===0}function eu(l,t,a){const d=l!=="=="&&l!=="!=";return class r2{constructor(T,S,A){this.type=Ht,this.lhs=T,this.rhs=S,this.collator=A,this.hasUntypedArgument=T.type.kind==="value"||S.type.kind==="value"}static parse(T,S){if(T.length!==3&&T.length!==4)return S.error("Expected two or three arguments.");const A=T[0];let k=S.parse(T[1],1,un);if(!k)return null;if(!ld(A,k.type))return S.concat(1).error(`"${A}" comparisons are not supported for type '${zi(k.type)}'.`);let N=S.parse(T[2],2,un);if(!N)return null;if(!ld(A,N.type))return S.concat(2).error(`"${A}" comparisons are not supported for type '${zi(N.type)}'.`);if(k.type.kind!==N.type.kind&&k.type.kind!=="value"&&N.type.kind!=="value")return S.error(`Cannot compare types '${zi(k.type)}' and '${zi(N.type)}'.`);d&&(k.type.kind==="value"&&N.type.kind!=="value"?k=new Wr(N.type,[k]):k.type.kind!=="value"&&N.type.kind==="value"&&(N=new Wr(k.type,[N])));let O=null;if(T.length===4){if(k.type.kind!=="string"&&N.type.kind!=="string"&&k.type.kind!=="value"&&N.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(O=S.parse(T[3],3,ko),!O)return null}return new r2(k,N,O)}evaluate(T){const S=this.lhs.evaluate(T),A=this.rhs.evaluate(T);if(d&&this.hasUntypedArgument){const k=tn(S),N=tn(A);if(k.kind!==N.kind||k.kind!=="string"&&k.kind!=="number")throw new ui(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${k.kind}, ${N.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const k=tn(S),N=tn(A);if(k.kind!=="string"||N.kind!=="string")return t(T,S,A)}return this.collator?a(T,S,A,this.collator.evaluate(T)):t(T,S,A)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const wf=eu("==",function(l,t,a){return t===a},nh),wg=eu("!=",function(l,t,a){return t!==a},function(l,t,a,d){return!nh(0,t,a,d)}),Tg=eu("<",function(l,t,a){return t<a},function(l,t,a,d){return d.compare(t,a)<0}),Sg=eu(">",function(l,t,a){return t>a},function(l,t,a,d){return d.compare(t,a)>0}),Eg=eu("<=",function(l,t,a){return t<=a},function(l,t,a,d){return d.compare(t,a)<=0}),cd=eu(">=",function(l,t,a){return t>=a},function(l,t,a,d){return d.compare(t,a)>=0});class ud{constructor(t,a,d){this.type=ko,this.locale=d,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const d=t[1];if(typeof d!="object"||Array.isArray(d))return a.error("Collator options argument must be an object.");const y=a.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Ht);if(!y)return null;const T=a.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Ht);if(!T)return null;let S=null;return d.locale&&(S=a.parse(d.locale,1,cn),!S)?null:new ud(y,T,S)}evaluate(t){return new no(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class tu{constructor(t,a,d,y,T){this.type=cn,this.number=t,this.locale=a,this.currency=d,this.minFractionDigits=y,this.maxFractionDigits=T}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const d=a.parse(t[1],1,At);if(!d)return null;const y=t[2];if(typeof y!="object"||Array.isArray(y))return a.error("NumberFormat options argument must be an object.");let T=null;if(y.locale&&(T=a.parse(y.locale,1,cn),!T))return null;let S=null;if(y.currency&&(S=a.parse(y.currency,1,cn),!S))return null;let A=null;if(y["min-fraction-digits"]&&(A=a.parse(y["min-fraction-digits"],1,At),!A))return null;let k=null;return y["max-fraction-digits"]&&(k=a.parse(y["max-fraction-digits"],1,At),!k)?null:new tu(d,T,S,A,k)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Po{constructor(t){this.type=ll,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const d=t[1];if(!Array.isArray(d)&&typeof d=="object")return a.error("First argument must be an image or text section.");const y=[];let T=!1;for(let S=1;S<=t.length-1;++S){const A=t[S];if(T&&typeof A=="object"&&!Array.isArray(A)){T=!1;let k=null;if(A["font-scale"]&&(k=a.parse(A["font-scale"],1,At),!k))return null;let N=null;if(A["text-font"]&&(N=a.parse(A["text-font"],1,sa(cn)),!N))return null;let O=null;if(A["text-color"]&&(O=a.parse(A["text-color"],1,ma),!O))return null;let F=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!Ku.includes(A["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(F=a.parse(A["vertical-align"],1,cn),!F)return null}const $=y[y.length-1];$.scale=k,$.font=N,$.textColor=O,$.verticalAlign=F}else{const k=a.parse(t[S],1,un);if(!k)return null;const N=k.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,y.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Po(y)}evaluate(t){return new Br(this.sections.map(a=>{const d=a.content.evaluate(t);return tn(d)===Ka?new Ju("",d,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new Ju(pr(d),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class Tf{constructor(t){this.type=Ka,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const d=a.parse(t[1],1,cn);return d?new Tf(d):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),d=Fr.fromString(a);return d&&t.availableImages&&(d.available=t.availableImages.indexOf(a)>-1),d}eachChild(t){t(this.input)}outputDefined(){return!1}}class ih{constructor(t){this.type=At,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const d=a.parse(t[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${zi(d.type)} instead.`):new ih(d):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new ui(`Expected value to be of type string or array, but found ${zi(tn(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const bs=8192;function qp(l,t){const a=(180+l[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,y=Math.pow(2,t.z);return[Math.round(a*y*bs),Math.round(d*y*bs)]}function hd(l,t){const a=Math.pow(2,t.z);return[(y=(l[0]/bs+t.x)/a,360*y-180),(d=(l[1]/bs+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,y}function nu(l,t){l[0]=Math.min(l[0],t[0]),l[1]=Math.min(l[1],t[1]),l[2]=Math.max(l[2],t[0]),l[3]=Math.max(l[3],t[1])}function ro(l,t){return!(l[0]<=t[0]||l[2]>=t[2]||l[1]<=t[1]||l[3]>=t[3])}function Hp(l,t,a){const d=l[0]-t[0],y=l[1]-t[1],T=l[0]-a[0],S=l[1]-a[1];return d*S-T*y==0&&d*T<=0&&y*S<=0}function rh(l,t,a,d){return(y=[d[0]-a[0],d[1]-a[1]])[0]*(T=[t[0]-l[0],t[1]-l[1]])[1]-y[1]*T[0]!=0&&!(!dd(l,t,a,d)||!dd(a,d,l,t));var y,T}function Xp(l,t,a){for(const d of a)for(let y=0;y<d.length-1;++y)if(rh(l,t,d[y],d[y+1]))return!0;return!1}function nc(l,t,a=!1){let d=!1;for(const A of t)for(let k=0;k<A.length-1;k++){if(Hp(l,A[k],A[k+1]))return a;(T=A[k])[1]>(y=l)[1]!=(S=A[k+1])[1]>y[1]&&y[0]<(S[0]-T[0])*(y[1]-T[1])/(S[1]-T[1])+T[0]&&(d=!d)}var y,T,S;return d}function Wp(l,t){for(const a of t)if(nc(l,a))return!0;return!1}function iu(l,t){for(const a of l)if(!nc(a,t))return!1;for(let a=0;a<l.length-1;++a)if(Xp(l[a],l[a+1],t))return!1;return!0}function ah(l,t){for(const a of t)if(iu(l,a))return!0;return!1}function dd(l,t,a,d){const y=d[0]-a[0],T=d[1]-a[1],S=(l[0]-a[0])*T-y*(l[1]-a[1]),A=(t[0]-a[0])*T-y*(t[1]-a[1]);return S>0&&A<0||S<0&&A>0}function ru(l,t,a){const d=[];for(let y=0;y<l.length;y++){const T=[];for(let S=0;S<l[y].length;S++){const A=qp(l[y][S],a);nu(t,A),T.push(A)}d.push(T)}return d}function Sf(l,t,a){const d=[];for(let y=0;y<l.length;y++){const T=ru(l[y],t,a);d.push(T)}return d}function Ef(l,t,a,d){if(l[0]<a[0]||l[0]>a[2]){const y=.5*d;let T=l[0]-a[0]>y?-d:a[0]-l[0]>y?d:0;T===0&&(T=l[0]-a[2]>y?-d:a[2]-l[0]>y?d:0),l[0]+=T}nu(t,l)}function sh(l,t,a,d){const y=Math.pow(2,d.z)*bs,T=[d.x*bs,d.y*bs],S=[];for(const A of l)for(const k of A){const N=[k.x+T[0],k.y+T[1]];Ef(N,t,a,y),S.push(N)}return S}function oh(l,t,a,d){const y=Math.pow(2,d.z)*bs,T=[d.x*bs,d.y*bs],S=[];for(const k of l){const N=[];for(const O of k){const F=[O.x+T[0],O.y+T[1]];nu(t,F),N.push(F)}S.push(N)}if(t[2]-t[0]<=y/2){(A=t)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const k of S)for(const N of k)Ef(N,t,a,y)}var A;return S}class fl{constructor(t,a){this.type=Ht,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(io(t[1])){const d=t[1];if(d.type==="FeatureCollection"){const y=[];for(const T of d.features){const{type:S,coordinates:A}=T.geometry;S==="Polygon"&&y.push(A),S==="MultiPolygon"&&y.push(...A)}if(y.length)return new fl(d,{type:"MultiPolygon",coordinates:y})}else if(d.type==="Feature"){const y=d.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new fl(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new fl(d,d)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,d){const y=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(d.type==="Polygon"){const A=ru(d.coordinates,T,S),k=sh(a.geometry(),y,T,S);if(!ro(y,T))return!1;for(const N of k)if(!nc(N,A))return!1}if(d.type==="MultiPolygon"){const A=Sf(d.coordinates,T,S),k=sh(a.geometry(),y,T,S);if(!ro(y,T))return!1;for(const N of k)if(!Wp(N,A))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,d){const y=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(d.type==="Polygon"){const A=ru(d.coordinates,T,S),k=oh(a.geometry(),y,T,S);if(!ro(y,T))return!1;for(const N of k)if(!iu(N,A))return!1}if(d.type==="MultiPolygon"){const A=Sf(d.coordinates,T,S),k=oh(a.geometry(),y,T,S);if(!ro(y,T))return!1;for(const N of k)if(!ah(N,A))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Af=class{constructor(l=[],t=(a,d)=>a<d?-1:a>d?1:0){if(this.data=l,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:t,compare:a}=this,d=t[l];for(;l>0;){const y=l-1>>1,T=t[y];if(a(d,T)>=0)break;t[l]=T,l=y}t[l]=d}_down(l){const{data:t,compare:a}=this,d=this.length>>1,y=t[l];for(;l<d;){let T=1+(l<<1);const S=T+1;if(S<this.length&&a(t[S],t[T])<0&&(T=S),a(t[T],y)>=0)break;t[l]=t[T],l=T}t[l]=y}};function fd(l,t,a=0,d=l.length-1,y=Ag){for(;d>a;){if(d-a>600){const k=d-a+1,N=t-a+1,O=Math.log(k),F=.5*Math.exp(2*O/3),$=.5*Math.sqrt(O*F*(k-F)/k)*(N-k/2<0?-1:1);fd(l,t,Math.max(a,Math.floor(t-N*F/k+$)),Math.min(d,Math.floor(t+(k-N)*F/k+$)),y)}const T=l[t];let S=a,A=d;for(au(l,a,t),y(l[d],T)>0&&au(l,a,d);S<A;){for(au(l,S,A),S++,A--;y(l[S],T)<0;)S++;for(;y(l[A],T)>0;)A--}y(l[a],T)===0?au(l,a,A):(A++,au(l,A,d)),A<=t&&(a=A+1),t<=A&&(d=A-1)}}function au(l,t,a){const d=l[t];l[t]=l[a],l[a]=d}function Ag(l,t){return l<t?-1:l>t?1:0}function pd(l,t){if(l.length<=1)return[l];const a=[];let d,y;for(const T of l){const S=Qp(T);S!==0&&(T.area=Math.abs(S),y===void 0&&(y=S<0),y===S<0?(d&&a.push(d),d=[T]):d.push(T))}if(d&&a.push(d),t>1)for(let T=0;T<a.length;T++)a[T].length<=t||(fd(a[T],t,1,a[T].length-1,Mg),a[T]=a[T].slice(0,t));return a}function Mg(l,t){return t.area-l.area}function Qp(l){let t=0;for(let a,d,y=0,T=l.length,S=T-1;y<T;S=y++)a=l[y],d=l[S],t+=(d.x-a.x)*(a.y+d.y);return t}const _a=1/298.257223563,su=_a*(2-_a),Mf=Math.PI/180;class md{constructor(t){const a=6378.137*Mf*1e3,d=Math.cos(t*Mf),y=1/(1-su*(1-d*d)),T=Math.sqrt(y);this.kx=a*T*d,this.ky=a*T*y*(1-su)}distance(t,a){const d=this.wrap(t[0]-a[0])*this.kx,y=(t[1]-a[1])*this.ky;return Math.sqrt(d*d+y*y)}pointOnLine(t,a){let d,y,T,S,A=1/0;for(let k=0;k<t.length-1;k++){let N=t[k][0],O=t[k][1],F=this.wrap(t[k+1][0]-N)*this.kx,$=(t[k+1][1]-O)*this.ky,H=0;F===0&&$===0||(H=(this.wrap(a[0]-N)*this.kx*F+(a[1]-O)*this.ky*$)/(F*F+$*$),H>1?(N=t[k+1][0],O=t[k+1][1]):H>0&&(N+=F/this.kx*H,O+=$/this.ky*H)),F=this.wrap(a[0]-N)*this.kx,$=(a[1]-O)*this.ky;const W=F*F+$*$;W<A&&(A=W,d=N,y=O,T=k,S=H)}return{point:[d,y],index:T,t:Math.max(0,Math.min(1,S))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Zn(l,t){return t[0]-l[0]}function lh(l){return l[1]-l[0]+1}function ws(l,t){return l[1]>=l[0]&&l[1]<t}function Cf(l,t){if(l[0]>l[1])return[null,null];const a=lh(l);if(t){if(a===2)return[l,null];const y=Math.floor(a/2);return[[l[0],l[0]+y],[l[0]+y,l[1]]]}if(a===1)return[l,null];const d=Math.floor(a/2)-1;return[[l[0],l[0]+d],[l[0]+d+1,l[1]]]}function pl(l,t){if(!ws(t,l.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let d=t[0];d<=t[1];++d)nu(a,l[d]);return a}function ch(l){const t=[1/0,1/0,-1/0,-1/0];for(const a of l)for(const d of a)nu(t,d);return t}function ou(l){return l[0]!==-1/0&&l[1]!==-1/0&&l[2]!==1/0&&l[3]!==1/0}function uh(l,t,a){if(!ou(l)||!ou(t))return NaN;let d=0,y=0;return l[2]<t[0]&&(d=t[0]-l[2]),l[0]>t[2]&&(d=l[0]-t[2]),l[1]>t[3]&&(y=l[1]-t[3]),l[3]<t[1]&&(y=t[1]-l[3]),a.distance([0,0],[d,y])}function ml(l,t,a){const d=a.pointOnLine(t,l);return a.distance(l,d.point)}function Lo(l,t,a,d,y){const T=Math.min(ml(l,[a,d],y),ml(t,[a,d],y)),S=Math.min(ml(a,[l,t],y),ml(d,[l,t],y));return Math.min(T,S)}function lu(l,t,a,d,y){if(!ws(t,l.length)||!ws(d,a.length))return 1/0;let T=1/0;for(let S=t[0];S<t[1];++S){const A=l[S],k=l[S+1];for(let N=d[0];N<d[1];++N){const O=a[N],F=a[N+1];if(rh(A,k,O,F))return 0;T=Math.min(T,Lo(A,k,O,F,y))}}return T}function Df(l,t,a,d,y){if(!ws(t,l.length)||!ws(d,a.length))return NaN;let T=1/0;for(let S=t[0];S<=t[1];++S)for(let A=d[0];A<=d[1];++A)if(T=Math.min(T,y.distance(l[S],a[A])),T===0)return T;return T}function Kp(l,t,a){if(nc(l,t,!0))return 0;let d=1/0;for(const y of t){const T=y[0],S=y[y.length-1];if(T!==S&&(d=Math.min(d,ml(l,[S,T],a)),d===0))return d;const A=a.pointOnLine(y,l);if(d=Math.min(d,a.distance(l,A.point)),d===0)return d}return d}function ic(l,t,a,d){if(!ws(t,l.length))return NaN;for(let T=t[0];T<=t[1];++T)if(nc(l[T],a,!0))return 0;let y=1/0;for(let T=t[0];T<t[1];++T){const S=l[T],A=l[T+1];for(const k of a)for(let N=0,O=k.length,F=O-1;N<O;F=N++){const $=k[F],H=k[N];if(rh(S,A,$,H))return 0;y=Math.min(y,Lo(S,A,$,H,d))}}return y}function kf(l,t){for(const a of l)for(const d of a)if(nc(d,t,!0))return!0;return!1}function Jp(l,t,a,d=1/0){const y=ch(l),T=ch(t);if(d!==1/0&&uh(y,T,a)>=d)return d;if(ro(y,T)){if(kf(l,t))return 0}else if(kf(t,l))return 0;let S=1/0;for(const A of l)for(let k=0,N=A.length,O=N-1;k<N;O=k++){const F=A[O],$=A[k];for(const H of t)for(let W=0,J=H.length,oe=J-1;W<J;oe=W++){const fe=H[oe],ke=H[W];if(rh(F,$,fe,ke))return 0;S=Math.min(S,Lo(F,$,fe,ke,a))}}return S}function If(l,t,a,d,y,T){if(!T)return;const S=uh(pl(d,T),y,a);S<t&&l.push([S,T,[0,0]])}function gd(l,t,a,d,y,T,S){if(!T||!S)return;const A=uh(pl(d,T),pl(y,S),a);A<t&&l.push([A,T,S])}function yd(l,t,a,d,y=1/0){let T=Math.min(d.distance(l[0],a[0][0]),y);if(T===0)return T;const S=new Af([[0,[0,l.length-1],[0,0]]],Zn),A=ch(a);for(;S.length>0;){const k=S.pop();if(k[0]>=T)continue;const N=k[1],O=t?50:100;if(lh(N)<=O){if(!ws(N,l.length))return NaN;if(t){const F=ic(l,N,a,d);if(isNaN(F)||F===0)return F;T=Math.min(T,F)}else for(let F=N[0];F<=N[1];++F){const $=Kp(l[F],a,d);if(T=Math.min(T,$),T===0)return 0}}else{const F=Cf(N,t);If(S,T,d,l,A,F[0]),If(S,T,d,l,A,F[1])}}return T}function _d(l,t,a,d,y,T=1/0){let S=Math.min(T,y.distance(l[0],a[0]));if(S===0)return S;const A=new Af([[0,[0,l.length-1],[0,a.length-1]]],Zn);for(;A.length>0;){const k=A.pop();if(k[0]>=S)continue;const N=k[1],O=k[2],F=t?50:100,$=d?50:100;if(lh(N)<=F&&lh(O)<=$){if(!ws(N,l.length)&&ws(O,a.length))return NaN;let H;if(t&&d)H=lu(l,N,a,O,y),S=Math.min(S,H);else if(t&&!d){const W=l.slice(N[0],N[1]+1);for(let J=O[0];J<=O[1];++J)if(H=ml(a[J],W,y),S=Math.min(S,H),S===0)return S}else if(!t&&d){const W=a.slice(O[0],O[1]+1);for(let J=N[0];J<=N[1];++J)if(H=ml(l[J],W,y),S=Math.min(S,H),S===0)return S}else H=Df(l,N,a,O,y),S=Math.min(S,H)}else{const H=Cf(N,t),W=Cf(O,d);gd(A,S,y,l,a,H[0],W[0]),gd(A,S,y,l,a,H[0],W[1]),gd(A,S,y,l,a,H[1],W[0]),gd(A,S,y,l,a,H[1],W[1])}}return S}function vd(l){return l.type==="MultiPolygon"?l.coordinates.map(t=>({type:"Polygon",coordinates:t})):l.type==="MultiLineString"?l.coordinates.map(t=>({type:"LineString",coordinates:t})):l.type==="MultiPoint"?l.coordinates.map(t=>({type:"Point",coordinates:t})):[l]}class gl{constructor(t,a){this.type=At,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(io(t[1])){const d=t[1];if(d.type==="FeatureCollection")return new gl(d,d.features.map(y=>vd(y.geometry)).flat());if(d.type==="Feature")return new gl(d,vd(d.geometry));if("type"in d&&"coordinates"in d)return new gl(d,vd(d))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,d){const y=a.geometry(),T=y.flat().map(k=>hd([k.x,k.y],a.canonical));if(y.length===0)return NaN;const S=new md(T[0][1]);let A=1/0;for(const k of d){switch(k.type){case"Point":A=Math.min(A,_d(T,!1,[k.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,_d(T,!1,k.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,yd(T,!1,k.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,d){const y=a.geometry(),T=y.flat().map(k=>hd([k.x,k.y],a.canonical));if(y.length===0)return NaN;const S=new md(T[0][1]);let A=1/0;for(const k of d){switch(k.type){case"Point":A=Math.min(A,_d(T,!0,[k.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,_d(T,!0,k.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,yd(T,!0,k.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,d){const y=a.geometry();if(y.length===0||y[0].length===0)return NaN;const T=pd(y,0).map(k=>k.map(N=>N.map(O=>hd([O.x,O.y],a.canonical)))),S=new md(T[0][0][0][1]);let A=1/0;for(const k of d)for(const N of T){switch(k.type){case"Point":A=Math.min(A,yd([k.coordinates],!1,N,S,A));break;case"LineString":A=Math.min(A,yd(k.coordinates,!0,N,S,A));break;case"Polygon":A=Math.min(A,Jp(N,k.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class rc{constructor(t){this.type=un,this.key=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const d=t[1];return d==null?a.error("Global state property must be defined."):typeof d!="string"?a.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new rc(d)}evaluate(t){var a;const d=(a=t.globals)===null||a===void 0?void 0:a.globalState;return d&&Object.keys(d).length!==0?En(d,this.key):null}eachChild(){}outputDefined(){return!1}}const Qr={"==":wf,"!=":wg,">":Sg,"<":Tg,">=":cd,"<=":Eg,array:Wr,at:Rr,boolean:Wr,case:mr,coalesce:ya,collator:ud,format:Po,image:Tf,in:Xc,"index-of":tc,interpolate:Ur,"interpolate-hcl":Ur,"interpolate-lab":Ur,length:ih,let:Hc,literal:er,match:Wc,number:Wr,"number-format":tu,object:Wr,slice:eh,step:Kc,string:Wr,"to-boolean":es,"to-color":es,"to-number":es,"to-string":es,var:xs,within:fl,distance:gl,"global-state":rc};class Na{constructor(t,a,d,y){this.name=t,this.type=a,this._evaluate=d,this.args=y}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const d=t[0],y=Na.definitions[d];if(!y)return a.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(y)?y[0]:y.type,S=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,A=S.filter(([N])=>!Array.isArray(N)||N.length===t.length-1);let k=null;for(const[N,O]of A){k=new hl(a.registry,ac,a.path,null,a.scope);const F=[];let $=!1;for(let H=1;H<t.length;H++){const W=t[H],J=Array.isArray(N)?N[H-1]:N.type,oe=k.parse(W,1+F.length,J);if(!oe){$=!0;break}F.push(oe)}if(!$)if(Array.isArray(N)&&N.length!==F.length)k.error(`Expected ${N.length} arguments, but found ${F.length} instead.`);else{for(let H=0;H<F.length;H++){const W=Array.isArray(N)?N[H]:N.type,J=F[H];k.concat(H+1).checkSubtype(W,J.type)}if(k.errors.length===0)return new Na(d,T,O,F)}}if(A.length===1)a.errors.push(...k.errors);else{const N=(A.length?A:S).map(([F])=>{return $=F,Array.isArray($)?`(${$.map(zi).join(", ")})`:`(${zi($.type)}...)`;var $}).join(" | "),O=[];for(let F=1;F<t.length;F++){const $=a.parse(t[F],1+O.length);if(!$)return null;O.push(zi($.type))}a.error(`Expected arguments of type ${N}, but found (${O.join(", ")}) instead.`)}return null}static register(t,a){Na.definitions=a;for(const d in a)t[d]=Na}}function Pa(l,[t,a,d,y]){t=t.evaluate(l),a=a.evaluate(l),d=d.evaluate(l);const T=y?y.evaluate(l):1,S=fn(t,a,d,T);if(S)throw new ui(S);return new mn(t/255,a/255,d/255,T,!1)}function La(l,t){return l in t}function yl(l,t){const a=t[l];return a===void 0?null:a}function Oo(l){return{type:l}}function ac(l){if(l instanceof xs)return ac(l.boundExpression);if(l instanceof Na&&l.name==="error"||l instanceof ud||l instanceof fl||l instanceof gl||l instanceof rc)return!1;const t=l instanceof es||l instanceof Wr;let a=!0;return l.eachChild(d=>{a=t?a&&ac(d):a&&d instanceof er}),!!a&&sc(l)&&Ts(l,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function sc(l){if(l instanceof Na&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof fl||l instanceof gl)return!1;let t=!0;return l.eachChild(a=>{t&&!sc(a)&&(t=!1)}),t}function oc(l){if(l instanceof Na&&l.name==="feature-state")return!1;let t=!0;return l.eachChild(a=>{t&&!oc(a)&&(t=!1)}),t}function Ts(l,t){if(l instanceof Na&&t.indexOf(l.name)>=0)return!1;let a=!0;return l.eachChild(d=>{a&&!Ts(d,t)&&(a=!1)}),a}function Rf(l){return{result:"success",value:l}}function jo(l){return{result:"error",value:l}}function Ss(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function zf(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function oa(l){return!!l.expression&&l.expression.interpolated}function bn(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function la(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)&&tn(l)===Xr}function Nf(l){return l}function hh(l,t){const a=l.stops&&typeof l.stops[0][0]=="object",d=a||!(a||l.property!==void 0),y=l.type||(oa(t)?"exponential":"interval"),T=function(O){switch(O.type){case"color":return mn.parse;case"padding":return Li.parse;case"numberArray":return Oi.parse;case"colorArray":return fr.parse;default:return null}}(t);if(T&&((l=Ji({},l)).stops&&(l.stops=l.stops.map(O=>[O[0],T(O[1])])),l.default=T(l.default?l.default:t.default)),l.colorSpace&&(S=l.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var S;const A=function(O){switch(O){case"exponential":return lc;case"interval":return Lf;case"categorical":return Pf;case"identity":return cc;default:throw new Error(`Unknown function type "${O}"`)}}(y);let k,N;if(y==="categorical"){k=Object.create(null);for(const O of l.stops)k[O[0]]=O[1];N=typeof l.stops[0][0]}if(a){const O={},F=[];for(let W=0;W<l.stops.length;W++){const J=l.stops[W],oe=J[0].zoom;O[oe]===void 0&&(O[oe]={zoom:oe,type:l.type,property:l.property,default:l.default,stops:[]},F.push(oe)),O[oe].stops.push([J[0].value,J[1]])}const $=[];for(const W of F)$.push([O[W].zoom,hh(O[W],t)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Ur.interpolationFactor.bind(void 0,H),zoomStops:$.map(W=>W[0]),evaluate:({zoom:W},J)=>lc({stops:$,base:l.base},t,W).evaluate(W,J)}}if(d){const O=y==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Ur.interpolationFactor.bind(void 0,O),zoomStops:l.stops.map(F=>F[0]),evaluate:({zoom:F})=>A(l,t,F,k,N)}}return{kind:"source",evaluate(O,F){const $=F&&F.properties?F.properties[l.property]:void 0;return $===void 0?Es(l.default,t.default):A(l,t,$,k,N)}}}function Es(l,t,a){return l!==void 0?l:t!==void 0?t:a!==void 0?a:void 0}function Pf(l,t,a,d,y){return Es(typeof a===y?d[a]:void 0,l.default,t.default)}function Lf(l,t,a){if(bn(a)!=="number")return Es(l.default,t.default);const d=l.stops.length;if(d===1||a<=l.stops[0][0])return l.stops[0][1];if(a>=l.stops[d-1][0])return l.stops[d-1][1];const y=Qc(l.stops.map(T=>T[0]),a);return l.stops[y][1]}function lc(l,t,a){const d=l.base!==void 0?l.base:1;if(bn(a)!=="number")return Es(l.default,t.default);const y=l.stops.length;if(y===1||a<=l.stops[0][0])return l.stops[0][1];if(a>=l.stops[y-1][0])return l.stops[y-1][1];const T=Qc(l.stops.map(O=>O[0]),a),S=function(O,F,$,H){const W=H-$,J=O-$;return W===0?0:F===1?J/W:(Math.pow(F,J)-1)/(Math.pow(F,W)-1)}(a,d,l.stops[T][0],l.stops[T+1][0]),A=l.stops[T][1],k=l.stops[T+1][1],N=za[t.type]||Nf;return typeof A.evaluate=="function"?{evaluate(...O){const F=A.evaluate.apply(void 0,O),$=k.evaluate.apply(void 0,O);if(F!==void 0&&$!==void 0)return N(F,$,S,l.colorSpace)}}:N(A,k,S,l.colorSpace)}function cc(l,t,a){switch(t.type){case"color":a=mn.parse(a);break;case"formatted":a=Br.fromString(a.toString());break;case"resolvedImage":a=Fr.fromString(a.toString());break;case"padding":a=Li.parse(a);break;case"colorArray":a=fr.parse(a);break;case"numberArray":a=Oi.parse(a);break;default:bn(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return Es(a,l.default,t.default)}Na.register(Qr,{error:[{kind:"error"},[cn],(l,[t])=>{throw new ui(t.evaluate(l))}],typeof:[cn,[un],(l,[t])=>zi(tn(t.evaluate(l)))],"to-rgba":[sa(At,4),[ma],(l,[t])=>{const[a,d,y,T]=t.evaluate(l).rgb;return[255*a,255*d,255*y,T]}],rgb:[ma,[At,At,At],Pa],rgba:[ma,[At,At,At,At],Pa],has:{type:Ht,overloads:[[[cn],(l,[t])=>La(t.evaluate(l),l.properties())],[[cn,Xr],(l,[t,a])=>La(t.evaluate(l),a.evaluate(l))]]},get:{type:un,overloads:[[[cn],(l,[t])=>yl(t.evaluate(l),l.properties())],[[cn,Xr],(l,[t,a])=>yl(t.evaluate(l),a.evaluate(l))]]},"feature-state":[un,[cn],(l,[t])=>yl(t.evaluate(l),l.featureState||{})],properties:[Xr,[],l=>l.properties()],"geometry-type":[cn,[],l=>l.geometryType()],id:[un,[],l=>l.id()],zoom:[At,[],l=>l.globals.zoom],"heatmap-density":[At,[],l=>l.globals.heatmapDensity||0],elevation:[At,[],l=>l.globals.elevation||0],"line-progress":[At,[],l=>l.globals.lineProgress||0],accumulated:[un,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[At,Oo(At),(l,t)=>{let a=0;for(const d of t)a+=d.evaluate(l);return a}],"*":[At,Oo(At),(l,t)=>{let a=1;for(const d of t)a*=d.evaluate(l);return a}],"-":{type:At,overloads:[[[At,At],(l,[t,a])=>t.evaluate(l)-a.evaluate(l)],[[At],(l,[t])=>-t.evaluate(l)]]},"/":[At,[At,At],(l,[t,a])=>t.evaluate(l)/a.evaluate(l)],"%":[At,[At,At],(l,[t,a])=>t.evaluate(l)%a.evaluate(l)],ln2:[At,[],()=>Math.LN2],pi:[At,[],()=>Math.PI],e:[At,[],()=>Math.E],"^":[At,[At,At],(l,[t,a])=>Math.pow(t.evaluate(l),a.evaluate(l))],sqrt:[At,[At],(l,[t])=>Math.sqrt(t.evaluate(l))],log10:[At,[At],(l,[t])=>Math.log(t.evaluate(l))/Math.LN10],ln:[At,[At],(l,[t])=>Math.log(t.evaluate(l))],log2:[At,[At],(l,[t])=>Math.log(t.evaluate(l))/Math.LN2],sin:[At,[At],(l,[t])=>Math.sin(t.evaluate(l))],cos:[At,[At],(l,[t])=>Math.cos(t.evaluate(l))],tan:[At,[At],(l,[t])=>Math.tan(t.evaluate(l))],asin:[At,[At],(l,[t])=>Math.asin(t.evaluate(l))],acos:[At,[At],(l,[t])=>Math.acos(t.evaluate(l))],atan:[At,[At],(l,[t])=>Math.atan(t.evaluate(l))],min:[At,Oo(At),(l,t)=>Math.min(...t.map(a=>a.evaluate(l)))],max:[At,Oo(At),(l,t)=>Math.max(...t.map(a=>a.evaluate(l)))],abs:[At,[At],(l,[t])=>Math.abs(t.evaluate(l))],round:[At,[At],(l,[t])=>{const a=t.evaluate(l);return a<0?-Math.round(-a):Math.round(a)}],floor:[At,[At],(l,[t])=>Math.floor(t.evaluate(l))],ceil:[At,[At],(l,[t])=>Math.ceil(t.evaluate(l))],"filter-==":[Ht,[cn,un],(l,[t,a])=>l.properties()[t.value]===a.value],"filter-id-==":[Ht,[un],(l,[t])=>l.id()===t.value],"filter-type-==":[Ht,[cn],(l,[t])=>l.geometryType()===t.value],"filter-<":[Ht,[cn,un],(l,[t,a])=>{const d=l.properties()[t.value],y=a.value;return typeof d==typeof y&&d<y}],"filter-id-<":[Ht,[un],(l,[t])=>{const a=l.id(),d=t.value;return typeof a==typeof d&&a<d}],"filter->":[Ht,[cn,un],(l,[t,a])=>{const d=l.properties()[t.value],y=a.value;return typeof d==typeof y&&d>y}],"filter-id->":[Ht,[un],(l,[t])=>{const a=l.id(),d=t.value;return typeof a==typeof d&&a>d}],"filter-<=":[Ht,[cn,un],(l,[t,a])=>{const d=l.properties()[t.value],y=a.value;return typeof d==typeof y&&d<=y}],"filter-id-<=":[Ht,[un],(l,[t])=>{const a=l.id(),d=t.value;return typeof a==typeof d&&a<=d}],"filter->=":[Ht,[cn,un],(l,[t,a])=>{const d=l.properties()[t.value],y=a.value;return typeof d==typeof y&&d>=y}],"filter-id->=":[Ht,[un],(l,[t])=>{const a=l.id(),d=t.value;return typeof a==typeof d&&a>=d}],"filter-has":[Ht,[un],(l,[t])=>t.value in l.properties()],"filter-has-id":[Ht,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Ht,[sa(cn)],(l,[t])=>t.value.indexOf(l.geometryType())>=0],"filter-id-in":[Ht,[sa(un)],(l,[t])=>t.value.indexOf(l.id())>=0],"filter-in-small":[Ht,[cn,sa(un)],(l,[t,a])=>a.value.indexOf(l.properties()[t.value])>=0],"filter-in-large":[Ht,[cn,sa(un)],(l,[t,a])=>function(d,y,T,S){for(;T<=S;){const A=T+S>>1;if(y[A]===d)return!0;y[A]>d?S=A-1:T=A+1}return!1}(l.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Ht,overloads:[[[Ht,Ht],(l,[t,a])=>t.evaluate(l)&&a.evaluate(l)],[Oo(Ht),(l,t)=>{for(const a of t)if(!a.evaluate(l))return!1;return!0}]]},any:{type:Ht,overloads:[[[Ht,Ht],(l,[t,a])=>t.evaluate(l)||a.evaluate(l)],[Oo(Ht),(l,t)=>{for(const a of t)if(a.evaluate(l))return!0;return!1}]]},"!":[Ht,[Ht],(l,[t])=>!t.evaluate(l)],"is-supported-script":[Ht,[cn],(l,[t])=>{const a=l.globals&&l.globals.isSupportedScript;return!a||a(t.evaluate(l))}],upcase:[cn,[cn],(l,[t])=>t.evaluate(l).toUpperCase()],downcase:[cn,[cn],(l,[t])=>t.evaluate(l).toLowerCase()],concat:[cn,Oo(un),(l,t)=>t.map(a=>pr(a.evaluate(l))).join("")],"resolved-locale":[cn,[ko],(l,[t])=>t.evaluate(l).resolvedLocale()]});class uc{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new qc,this._defaultValue=a?function(d){if(d.type==="color"&&la(d.default))return new mn(0,0,0,0);switch(d.type){case"color":return mn.parse(d.default)||null;case"padding":return Li.parse(d.default)||null;case"numberArray":return Oi.parse(d.default)||null;case"colorArray":return fr.parse(d.default)||null;case"variableAnchorOffsetCollection":return Cn.parse(d.default)||null;case"projectionDefinition":return hn.parse(d.default)||null;default:return d.default===void 0?null:d.default}}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,d,y,T,S){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=d,this._evaluator.canonical=y,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(t,a,d,y,T,S){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=d||null,this._evaluator.canonical=y,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new ui(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function hc(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Qr}function ca(l,t){const a=new hl(Qr,ac,[],t?function(y){const T={color:ma,string:cn,number:At,enum:cn,boolean:Ht,formatted:ll,padding:Xi,numberArray:cl,colorArray:qu,projectionDefinition:Yu,resolvedImage:Ka,variableAnchorOffsetCollection:Ia};return y.type==="array"?sa(T[y.value]||un,y.length):T[y.type]}(t):void 0),d=a.parse(l,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Rf(new uc(d,t)):jo(a.errors)}class Kr{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!oc(a.expression),this.globalStateRefs=dc(a.expression)}evaluateWithoutErrorHandling(t,a,d,y,T,S){return this._styleExpression.evaluateWithoutErrorHandling(t,a,d,y,T,S)}evaluate(t,a,d,y,T,S){return this._styleExpression.evaluate(t,a,d,y,T,S)}}class ao{constructor(t,a,d,y){this.kind=t,this.zoomStops=d,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!oc(a.expression),this.globalStateRefs=dc(a.expression),this.interpolationType=y}evaluateWithoutErrorHandling(t,a,d,y,T,S){return this._styleExpression.evaluateWithoutErrorHandling(t,a,d,y,T,S)}evaluate(t,a,d,y,T,S){return this._styleExpression.evaluate(t,a,d,y,T,S)}interpolationFactor(t,a,d){return this.interpolationType?Ur.interpolationFactor(this.interpolationType,t,a,d):0}}function As(l,t){const a=ca(l,t);if(a.result==="error")return a;const d=a.value.expression,y=sc(d);if(!y&&!Ss(t))return jo([new Si("","data expressions not supported")]);const T=Ts(d,["zoom"]);if(!T&&!zf(t))return jo([new Si("","zoom expressions not supported")]);const S=ts(d);return S||T?S instanceof Si?jo([S]):S instanceof Ur&&!oa(t)?jo([new Si("",'"interpolate" expressions cannot be used with this property')]):Rf(S?new ao(y?"camera":"composite",a.value,S.labels,S instanceof Ur?S.interpolation:void 0):new Kr(y?"constant":"source",a.value)):jo([new Si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Oa{constructor(t,a){this._parameters=t,this._specification=a,Ji(this,hh(this._parameters,this._specification))}static deserialize(t){return new Oa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function ts(l){let t=null;if(l instanceof Hc)t=ts(l.result);else if(l instanceof ya){for(const a of l.args)if(t=ts(a),t)break}else(l instanceof Kc||l instanceof Ur)&&l.input instanceof Na&&l.input.name==="zoom"&&(t=l);return t instanceof Si||l.eachChild(a=>{const d=ts(a);d instanceof Si?t=d:!t&&d?t=new Si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&d&&t!==d&&(t=new Si("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function dc(l,t=new Set){return l instanceof rc&&t.add(l.key),l.eachChild(a=>{dc(a,t)}),t}function fc(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const t of l.slice(1))if(!fc(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const dh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Wi(l){if(l==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};fc(l)||(l=so(l));const t=ca(l,dh);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,d,y)=>t.value.evaluate(a,d,{},y),needGeometry:Wn(l),getGlobalStateRefs:()=>dc(t.value.expression)}}function Qi(l,t){return l<t?-1:l>t?1:0}function Wn(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let t=1;t<l.length;t++)if(Wn(l[t]))return!0;return!1}function so(l){if(!l)return!0;const t=l[0];return l.length<=1?t!=="any":t==="=="?ns(l[1],l[2],"=="):t==="!="?cu(ns(l[1],l[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ns(l[1],l[2],t):t==="any"?(a=l.slice(1),["any"].concat(a.map(so))):t==="all"?["all"].concat(l.slice(1).map(so)):t==="none"?["all"].concat(l.slice(1).map(so).map(cu)):t==="in"?xd(l[1],l.slice(2)):t==="!in"?cu(xd(l[1],l.slice(2))):t==="has"?_l(l[1]):t!=="!has"||cu(_l(l[1]));var a}function ns(l,t,a){switch(l){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,l,t]}}function xd(l,t){if(t.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",l,["literal",t.sort(Qi)]]:["filter-in-small",l,["literal",t]]}}function _l(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function cu(l){return["!",l]}function fh(l){const t=typeof l;if(t==="number"||t==="boolean"||t==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let y="[";for(const T of l)y+=`${fh(T)},`;return`${y}]`}const a=Object.keys(l).sort();let d="{";for(let y=0;y<a.length;y++)d+=`${JSON.stringify(a[y])}:${fh(l[a[y]])},`;return`${d}}`}function vl(l){let t="";for(const a of Dt)t+=`/${fh(l[a])}`;return t}function uu(l){const t=l.value;return t?[new St(l.key,t,"constants have been deprecated as of v8")]:[]}function ji(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function is(l){if(Array.isArray(l))return l.map(is);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const t={};for(const a in l)t[a]=is(l[a]);return t}return ji(l)}function va(l){const t=l.key,a=l.value,d=l.valueSpec||{},y=l.objectElementValidators||{},T=l.style,S=l.styleSpec,A=l.validateSpec;let k=[];const N=bn(a);if(N!=="object")return[new St(t,a,`object expected, ${N} found`)];for(const O in a){const F=O.split(".")[0],$=En(d,F)||d["*"];let H;if(En(y,F))H=y[F];else if(En(d,F))H=A;else if(y["*"])H=y["*"];else{if(!d["*"]){k.push(new St(t,a[O],`unknown property "${O}"`));continue}H=A}k=k.concat(H({key:(t&&`${t}.`)+O,value:a[O],valueSpec:$,style:T,styleSpec:S,object:a,objectKey:O,validateSpec:A},a))}for(const O in d)y[O]||d[O].required&&d[O].default===void 0&&a[O]===void 0&&k.push(new St(t,a,`missing required property "${O}"`));return k}function oo(l){const t=l.value,a=l.valueSpec,d=l.style,y=l.styleSpec,T=l.key,S=l.arrayElementValidator||l.validateSpec;if(bn(t)!=="array")return[new St(T,t,`array expected, ${bn(t)} found`)];if(a.length&&t.length!==a.length)return[new St(T,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new St(T,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let A={type:a.value,values:a.values};y.$version<7&&(A.function=a.function),bn(a.value)==="object"&&(A=a.value);let k=[];for(let N=0;N<t.length;N++)k=k.concat(S({array:t,arrayIndex:N,value:t[N],valueSpec:A,validateSpec:l.validateSpec,style:d,styleSpec:y,key:`${T}[${N}]`}));return k}function ja(l){const t=l.key,a=l.value,d=l.valueSpec;let y=bn(a);return y==="number"&&a!=a&&(y="NaN"),y!=="number"?[new St(t,a,`number expected, ${y} found`)]:"minimum"in d&&a<d.minimum?[new St(t,a,`${a} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&a>d.maximum?[new St(t,a,`${a} is greater than the maximum value ${d.maximum}`)]:[]}function Ba(l){const t=l.valueSpec,a=ji(l.value.type);let d,y,T,S={};const A=a!=="categorical"&&l.value.property===void 0,k=!A,N=bn(l.value.stops)==="array"&&bn(l.value.stops[0])==="array"&&bn(l.value.stops[0][0])==="object",O=va({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(H){if(a==="identity")return[new St(H.key,H.value,'identity function may not have a "stops" property')];let W=[];const J=H.value;return W=W.concat(oo({key:H.key,value:J,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:F})),bn(J)==="array"&&J.length===0&&W.push(new St(H.key,J,"array must have at least one stop")),W},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:t,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return a==="identity"&&A&&O.push(new St(l.key,l.value,'missing required property "property"')),a==="identity"||l.value.stops||O.push(new St(l.key,l.value,'missing required property "stops"')),a==="exponential"&&l.valueSpec.expression&&!oa(l.valueSpec)&&O.push(new St(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(k&&!Ss(l.valueSpec)?O.push(new St(l.key,l.value,"property functions not supported")):A&&!zf(l.valueSpec)&&O.push(new St(l.key,l.value,"zoom functions not supported"))),a!=="categorical"&&!N||l.value.property!==void 0||O.push(new St(l.key,l.value,'"property" property is required')),O;function F(H){let W=[];const J=H.value,oe=H.key;if(bn(J)!=="array")return[new St(oe,J,`array expected, ${bn(J)} found`)];if(J.length!==2)return[new St(oe,J,`array length 2 expected, length ${J.length} found`)];if(N){if(bn(J[0])!=="object")return[new St(oe,J,`object expected, ${bn(J[0])} found`)];if(J[0].zoom===void 0)return[new St(oe,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new St(oe,J,"object stop key must have value")];if(T&&T>ji(J[0].zoom))return[new St(oe,J[0].zoom,"stop zoom values must appear in ascending order")];ji(J[0].zoom)!==T&&(T=ji(J[0].zoom),y=void 0,S={}),W=W.concat(va({key:`${oe}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:ja,value:$}}))}else W=W.concat($({key:`${oe}[0]`,value:J[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},J));return hc(is(J[1]))?W.concat([new St(`${oe}[1]`,J[1],"expressions are not allowed in function stops.")]):W.concat(H.validateSpec({key:`${oe}[1]`,value:J[1],valueSpec:t,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function $(H,W){const J=bn(H.value),oe=ji(H.value),fe=H.value!==null?H.value:W;if(d){if(J!==d)return[new St(H.key,fe,`${J} stop domain type must match previous stop domain type ${d}`)]}else d=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new St(H.key,fe,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&a!=="categorical"){let ke=`number expected, ${J} found`;return Ss(t)&&a===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new St(H.key,fe,ke)]}return a!=="categorical"||J!=="number"||isFinite(oe)&&Math.floor(oe)===oe?a!=="categorical"&&J==="number"&&y!==void 0&&oe<y?[new St(H.key,fe,"stop domain values must appear in ascending order")]:(y=oe,a==="categorical"&&oe in S?[new St(H.key,fe,"stop domain values must be unique")]:(S[oe]=!0,[])):[new St(H.key,fe,`integer expected, found ${oe}`)]}}function xa(l){const t=(l.expressionContext==="property"?As:ca)(is(l.value),l.valueSpec);if(t.result==="error")return t.value.map(d=>new St(`${l.key}${d.key}`,l.value,d.message));const a=t.value.expression||t.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!a.outputDefined())return[new St(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!oc(a))return[new St(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!oc(a))return[new St(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Ts(a,["zoom","feature-state"]))return[new St(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!sc(a))return[new St(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ph(l){const t=l.key,a=l.value,d=bn(a);return d!=="string"?[new St(t,a,`color expected, ${d} found`)]:mn.parse(String(a))?[]:[new St(t,a,`color expected, "${a}" found`)]}function pc(l){const t=l.key,a=l.value,d=l.valueSpec,y=[];return Array.isArray(d.values)?d.values.indexOf(ji(a))===-1&&y.push(new St(t,a,`expected one of [${d.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(d.values).indexOf(ji(a))===-1&&y.push(new St(t,a,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(a)} found`)),y}function mc(l){return fc(is(l.value))?xa(Ji({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):mh(l)}function mh(l){const t=l.value,a=l.key;if(bn(t)!=="array")return[new St(a,t,`array expected, ${bn(t)} found`)];const d=l.styleSpec;let y,T=[];if(t.length<1)return[new St(a,t,"filter array must have at least 1 element")];switch(T=T.concat(pc({key:`${a}[0]`,value:t[0],valueSpec:d.filter_operator,style:l.style,styleSpec:l.styleSpec})),ji(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ji(t[1])==="$type"&&T.push(new St(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&T.push(new St(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(y=bn(t[1]),y!=="string"&&T.push(new St(`${a}[1]`,t[1],`string expected, ${y} found`)));for(let S=2;S<t.length;S++)y=bn(t[S]),ji(t[1])==="$type"?T=T.concat(pc({key:`${a}[${S}]`,value:t[S],valueSpec:d.geometry_type,style:l.style,styleSpec:l.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&T.push(new St(`${a}[${S}]`,t[S],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let S=1;S<t.length;S++)T=T.concat(mh({key:`${a}[${S}]`,value:t[S],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":y=bn(t[1]),t.length!==2?T.push(new St(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):y!=="string"&&T.push(new St(`${a}[1]`,t[1],`string expected, ${y} found`))}return T}function xl(l,t){const a=l.key,d=l.validateSpec,y=l.style,T=l.styleSpec,S=l.value,A=l.objectKey,k=T[`${t}_${l.layerType}`];if(!k)return[];const N=A.match(/^(.*)-transition$/);if(t==="paint"&&N&&k[N[1]]&&k[N[1]].transition)return d({key:a,value:S,valueSpec:T.transition,style:y,styleSpec:T});const O=l.valueSpec||k[A];if(!O)return[new St(a,S,`unknown property "${A}"`)];let F;if(bn(S)==="string"&&Ss(O)&&!O.tokens&&(F=/^{([^}]+)}$/.exec(S)))return[new St(a,S,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const $=[];return l.layerType==="symbol"&&(A==="text-field"&&y&&!y.glyphs&&$.push(new St(a,S,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&la(is(S))&&ji(S.type)==="identity"&&$.push(new St(a,S,'"text-font" does not support identity functions'))),$.concat(d({key:l.key,value:S,valueSpec:O,style:y,styleSpec:T,expressionContext:"property",propertyType:t,propertyKey:A}))}function tr(l){return xl(l,"paint")}function Bo(l){return xl(l,"layout")}function ua(l){let t=[];const a=l.value,d=l.key,y=l.style,T=l.styleSpec;if(bn(a)!=="object")return[new St(d,a,`object expected, ${bn(a)} found`)];a.type||a.ref||t.push(new St(d,a,'either "type" or "ref" is required'));let S=ji(a.type);const A=ji(a.ref);if(a.id){const k=ji(a.id);for(let N=0;N<l.arrayIndex;N++){const O=y.layers[N];ji(O.id)===k&&t.push(new St(d,a.id,`duplicate layer id "${a.id}", previously used at line ${O.id.__line__}`))}}if("ref"in a){let k;["type","source","source-layer","filter","layout"].forEach(N=>{N in a&&t.push(new St(d,a[N],`"${N}" is prohibited for ref layers`))}),y.layers.forEach(N=>{ji(N.id)===A&&(k=N)}),k?k.ref?t.push(new St(d,a.ref,"ref cannot reference another ref layer")):S=ji(k.type):t.push(new St(d,a.ref,`ref layer "${A}" not found`))}else if(S!=="background")if(a.source){const k=y.sources&&y.sources[a.source],N=k&&ji(k.type);k?N==="vector"&&S==="raster"?t.push(new St(d,a.source,`layer "${a.id}" requires a raster source`)):N!=="raster-dem"&&S==="hillshade"||N!=="raster-dem"&&S==="color-relief"?t.push(new St(d,a.source,`layer "${a.id}" requires a raster-dem source`)):N==="raster"&&S!=="raster"?t.push(new St(d,a.source,`layer "${a.id}" requires a vector source`)):N!=="vector"||a["source-layer"]?N==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?t.push(new St(d,a.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!a.paint||!a.paint["line-gradient"]||N==="geojson"&&k.lineMetrics||t.push(new St(d,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new St(d,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new St(d,a.source,`source "${a.source}" not found`))}else t.push(new St(d,a,'missing required property "source"'));return t=t.concat(va({key:d,value:a,valueSpec:T.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${d}.type`,value:a.type,valueSpec:T.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:a,objectKey:"type"}),filter:mc,layout:k=>va({layer:a,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":N=>Bo(Ji({layerType:S},N))}}),paint:k=>va({layer:a,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":N=>tr(Ji({layerType:S},N))}})}})),t}function Ms(l){const t=l.value,a=l.key,d=bn(t);return d!=="string"?[new St(a,t,`string expected, ${d} found`)]:[]}const Of={promoteId:function({key:l,value:t}){if(bn(t)==="string")return Ms({key:l,value:t});{const a=[];for(const d in t)a.push(...Ms({key:`${l}.${d}`,value:t[d]}));return a}}};function em(l){const t=l.value,a=l.key,d=l.styleSpec,y=l.style,T=l.validateSpec;if(!t.type)return[new St(a,t,'"type" is required')];const S=ji(t.type);let A;switch(S){case"vector":case"raster":return A=va({key:a,value:t,valueSpec:d[`source_${S.replace("-","_")}`],style:l.style,styleSpec:d,objectElementValidators:Of,validateSpec:T}),A;case"raster-dem":return A=function(k){var N;const O=(N=k.sourceName)!==null&&N!==void 0?N:"",F=k.value,$=k.styleSpec,H=$.source_raster_dem,W=k.style;let J=[];const oe=bn(F);if(F===void 0)return J;if(oe!=="object")return J.push(new St("source_raster_dem",F,`object expected, ${oe} found`)),J;const fe=ji(F.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],xe=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const q in F)!fe&&ke.includes(q)?J.push(new St(q,F[q],`In "${O}": "${q}" is only valid when "encoding" is set to "custom". ${xe} encoding found`)):H[q]?J=J.concat(k.validateSpec({key:q,value:F[q],valueSpec:H[q],validateSpec:k.validateSpec,style:W,styleSpec:$})):J.push(new St(q,F[q],`unknown property "${q}"`));return J}({sourceName:a,value:t,style:l.style,styleSpec:d,validateSpec:T}),A;case"geojson":if(A=va({key:a,value:t,valueSpec:d.source_geojson,style:y,styleSpec:d,validateSpec:T,objectElementValidators:Of}),t.cluster)for(const k in t.clusterProperties){const[N,O]=t.clusterProperties[k],F=typeof N=="string"?[N,["accumulated"],["get",k]]:N;A.push(...xa({key:`${a}.${k}.map`,value:O,expressionContext:"cluster-map"})),A.push(...xa({key:`${a}.${k}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return A;case"video":return va({key:a,value:t,valueSpec:d.source_video,style:y,validateSpec:T,styleSpec:d});case"image":return va({key:a,value:t,valueSpec:d.source_image,style:y,validateSpec:T,styleSpec:d});case"canvas":return[new St(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return pc({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function gr(l){const t=l.value,a=l.styleSpec,d=a.light,y=l.style;let T=[];const S=bn(t);if(t===void 0)return T;if(S!=="object")return T=T.concat([new St("light",t,`object expected, ${S} found`)]),T;for(const A in t){const k=A.match(/^(.*)-transition$/);T=T.concat(k&&d[k[1]]&&d[k[1]].transition?l.validateSpec({key:A,value:t[A],valueSpec:a.transition,validateSpec:l.validateSpec,style:y,styleSpec:a}):d[A]?l.validateSpec({key:A,value:t[A],valueSpec:d[A],validateSpec:l.validateSpec,style:y,styleSpec:a}):[new St(A,t[A],`unknown property "${A}"`)])}return T}function bl(l){const t=l.value,a=l.styleSpec,d=a.sky,y=l.style,T=bn(t);if(t===void 0)return[];if(T!=="object")return[new St("sky",t,`object expected, ${T} found`)];let S=[];for(const A in t)S=S.concat(d[A]?l.validateSpec({key:A,value:t[A],valueSpec:d[A],style:y,styleSpec:a}):[new St(A,t[A],`unknown property "${A}"`)]);return S}function gc(l){const t=l.value,a=l.styleSpec,d=a.terrain,y=l.style;let T=[];const S=bn(t);if(t===void 0)return T;if(S!=="object")return T=T.concat([new St("terrain",t,`object expected, ${S} found`)]),T;for(const A in t)T=T.concat(d[A]?l.validateSpec({key:A,value:t[A],valueSpec:d[A],validateSpec:l.validateSpec,style:y,styleSpec:a}):[new St(A,t[A],`unknown property "${A}"`)]);return T}function wl(l){let t=[];const a=l.value,d=l.key;if(Array.isArray(a)){const y=[],T=[];for(const S in a)a[S].id&&y.includes(a[S].id)&&t.push(new St(d,a,`all the sprites' ids must be unique, but ${a[S].id} is duplicated`)),y.push(a[S].id),a[S].url&&T.includes(a[S].url)&&t.push(new St(d,a,`all the sprites' URLs must be unique, but ${a[S].url} is duplicated`)),T.push(a[S].url),t=t.concat(va({key:`${d}[${S}]`,value:a[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return t}return Ms({key:d,value:a})}function bd(l){return t=l.value,t&&t.constructor===Object?[]:[new St(l.key,l.value,`object expected, ${bn(l.value)} found`)];var t}const Fo={"*":()=>[],array:oo,boolean:function(l){const t=l.value,a=l.key,d=bn(t);return d!=="boolean"?[new St(a,t,`boolean expected, ${d} found`)]:[]},number:ja,color:ph,constants:uu,enum:pc,filter:mc,function:Ba,layer:ua,object:va,source:em,light:gr,sky:bl,terrain:gc,projection:function(l){const t=l.value,a=l.styleSpec,d=a.projection,y=l.style,T=bn(t);if(t===void 0)return[];if(T!=="object")return[new St("projection",t,`object expected, ${T} found`)];let S=[];for(const A in t)S=S.concat(d[A]?l.validateSpec({key:A,value:t[A],valueSpec:d[A],style:y,styleSpec:a}):[new St(A,t[A],`unknown property "${A}"`)]);return S},projectionDefinition:function(l){const t=l.key;let a=l.value;a=a instanceof String?a.valueOf():a;const d=bn(a);return d!=="array"||function(y){return Array.isArray(y)&&y.length===3&&typeof y[0]=="string"&&typeof y[1]=="string"&&typeof y[2]=="number"}(a)||function(y){return!!["interpolate","step","literal"].includes(y[0])}(a)?["array","string"].includes(d)?[]:[new St(t,a,`projection expected, invalid type "${d}" found`)]:[new St(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:Ms,formatted:function(l){return Ms(l).length===0?[]:xa(l)},resolvedImage:function(l){return Ms(l).length===0?[]:xa(l)},padding:function(l){const t=l.key,a=l.value;if(bn(a)==="array"){if(a.length<1||a.length>4)return[new St(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const d={type:"number"};let y=[];for(let T=0;T<a.length;T++)y=y.concat(l.validateSpec({key:`${t}[${T}]`,value:a[T],validateSpec:l.validateSpec,valueSpec:d}));return y}return ja({key:t,value:a,valueSpec:{}})},numberArray:function(l){const t=l.key,a=l.value;if(bn(a)==="array"){const d={type:"number"};if(a.length<1)return[new St(t,a,"array length at least 1 expected, length 0 found")];let y=[];for(let T=0;T<a.length;T++)y=y.concat(l.validateSpec({key:`${t}[${T}]`,value:a[T],validateSpec:l.validateSpec,valueSpec:d}));return y}return ja({key:t,value:a,valueSpec:{}})},colorArray:function(l){const t=l.key,a=l.value;if(bn(a)==="array"){if(a.length<1)return[new St(t,a,"array length at least 1 expected, length 0 found")];let d=[];for(let y=0;y<a.length;y++)d=d.concat(ph({key:`${t}[${y}]`,value:a[y]}));return d}return ph({key:t,value:a})},variableAnchorOffsetCollection:function(l){const t=l.key,a=l.value,d=bn(a),y=l.styleSpec;if(d!=="array"||a.length<1||a.length%2!=0)return[new St(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let S=0;S<a.length;S+=2)T=T.concat(pc({key:`${t}[${S}]`,value:a[S],valueSpec:y.layout_symbol["text-anchor"]})),T=T.concat(oo({key:`${t}[${S+1}]`,value:a[S+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:y}));return T},sprite:wl,state:bd};function Uo(l){const t=l.value,a=l.valueSpec,d=l.styleSpec;return l.validateSpec=Uo,a.expression&&la(ji(t))?Ba(l):a.expression&&hc(is(t))?xa(l):a.type&&Fo[a.type]?Fo[a.type](l):va(Ji({},l,{valueSpec:a.type?d[a.type]:a}))}function hu(l){const t=l.value,a=l.key,d=Ms(l);return d.length||(t.indexOf("{fontstack}")===-1&&d.push(new St(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&d.push(new St(a,t,'"glyphs" url must include a "{range}" token'))),d}function Fa(l,t=Ae){let a=[];return a=a.concat(Uo({key:"",value:l,valueSpec:t.$root,styleSpec:t,style:l,validateSpec:Uo,objectElementValidators:{glyphs:hu,"*":()=>[]}})),l.constants&&(a=a.concat(uu({key:"constants",value:l.constants}))),jf(a)}function Cs(l){return function(t){return l({...t,validateSpec:Uo})}}function jf(l){return[].concat(l).sort((t,a)=>t.line-a.line)}function nr(l){return function(...t){return jf(l.apply(this,t))}}Fa.source=nr(Cs(em)),Fa.sprite=nr(Cs(wl)),Fa.glyphs=nr(Cs(hu)),Fa.light=nr(Cs(gr)),Fa.sky=nr(Cs(bl)),Fa.terrain=nr(Cs(gc)),Fa.state=nr(Cs(bd)),Fa.layer=nr(Cs(ua)),Fa.filter=nr(Cs(mc)),Fa.paintProperty=nr(Cs(tr)),Fa.layoutProperty=nr(Cs(Bo));const Tl=Fa,wd=Tl.light,gh=Tl.sky,yh=Tl.paintProperty,Td=Tl.layoutProperty;function Sl(l,t){let a=!1;if(t&&t.length)for(const d of t)l.fire(new je(new Error(d.message))),a=!0;return a}class El{constructor(t,a,d){const y=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const S=new Int32Array(this.arrayBuffer);t=S[0],this.d=(a=S[1])+2*(d=S[2]);for(let k=0;k<this.d*this.d;k++){const N=S[3+k],O=S[3+k+1];y.push(N===O?null:S.subarray(N,O))}const A=S[3+y.length+1];this.keys=S.subarray(S[3+y.length],A),this.bboxes=S.subarray(A),this.insert=this._insertReadonly}else{this.d=a+2*d;for(let S=0;S<this.d*this.d;S++)y.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=d,this.scale=a/t,this.uid=0;const T=d/a*t;this.min=-T,this.max=t+T}insert(t,a,d,y,T){this._forEachCell(a,d,y,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,d,y,T,S){this.cells[T].push(S)}query(t,a,d,y,T){const S=this.min,A=this.max;if(t<=S&&a<=S&&A<=d&&A<=y&&!T)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(t,a,d,y,this._queryCell,k,{},T),k}}_queryCell(t,a,d,y,T,S,A,k){const N=this.cells[T];if(N!==null){const O=this.keys,F=this.bboxes;for(let $=0;$<N.length;$++){const H=N[$];if(A[H]===void 0){const W=4*H;(k?k(F[W+0],F[W+1],F[W+2],F[W+3]):t<=F[W+2]&&a<=F[W+3]&&d>=F[W+0]&&y>=F[W+1])?(A[H]=!0,S.push(O[H])):A[H]=!1}}}}_forEachCell(t,a,d,y,T,S,A,k){const N=this._convertToCellCoord(t),O=this._convertToCellCoord(a),F=this._convertToCellCoord(d),$=this._convertToCellCoord(y);for(let H=N;H<=F;H++)for(let W=O;W<=$;W++){const J=this.d*W+H;if((!k||k(this._convertFromCellCoord(H),this._convertFromCellCoord(W),this._convertFromCellCoord(H+1),this._convertFromCellCoord(W+1)))&&T.call(this,t,a,d,y,J,S,A,k))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let d=0;for(let S=0;S<this.cells.length;S++)d+=this.cells[S].length;const y=new Int32Array(a+d+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;let T=a;for(let S=0;S<t.length;S++){const A=t[S];y[3+S]=T,y.set(A,T),T+=A.length}return y[3+t.length]=T,y.set(this.keys,T),T+=this.keys.length,y[3+t.length+1]=T,y.set(this.bboxes,T),T+=this.bboxes.length,y.buffer}static serialize(t,a){const d=t.toArrayBuffer();return a&&a.push(d),{buffer:d}}static deserialize(t){return new El(t.buffer)}}const Ds={};function zt(l,t,a={}){if(Ds[l])throw new Error(`${l} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:l,writeable:!1}),Ds[l]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}zt("Object",Object),zt("Set",Set),zt("TransferableGridIndex",El),zt("Color",mn),zt("Error",Error),zt("AJAXError",ve),zt("ResolvedImage",Fr),zt("StylePropertyFunction",Oa),zt("StyleExpression",uc,{omit:["_evaluator"]}),zt("ZoomDependentExpression",ao),zt("ZoomConstantExpression",Kr),zt("CompoundExpression",Na,{omit:["_evaluate"]});for(const l in Qr)Qr[l]._classRegistryKey||zt(`Expression_${l}`,Qr[l]);function Sd(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Vo(l){return l.$name||l.constructor._classRegistryKey}function Ed(l){return!function(t){if(t===null||typeof t!="object")return!1;const a=Vo(t);return!(!a||a==="Object")}(l)&&(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||Sd(l)||qr(l)||ArrayBuffer.isView(l)||l instanceof ImageData)}function du(l,t){if(Ed(l))return(Sd(l)||qr(l))&&t&&t.push(l),ArrayBuffer.isView(l)&&t&&t.push(l.buffer),l instanceof ImageData&&t&&t.push(l.data.buffer),l;if(Array.isArray(l)){const T=[];for(const S of l)T.push(du(S,t));return T}if(typeof l!="object")throw new Error("can't serialize object of type "+typeof l);const a=Vo(l);if(!a)throw new Error(`can't serialize object of unregistered class ${l.constructor.name}`);if(!Ds[a])throw new Error(`${a} is not registered.`);const{klass:d}=Ds[a],y=d.serialize?d.serialize(l,t):{};if(d.serialize){if(t&&y===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in l){if(!l.hasOwnProperty(T)||Ds[a].omit.indexOf(T)>=0)continue;const S=l[T];y[T]=Ds[a].shallow.indexOf(T)>=0?S:du(S,t)}l instanceof Error&&(y.message=l.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(y.$name=a),y}function Ua(l){if(Ed(l))return l;if(Array.isArray(l))return l.map(Ua);if(typeof l!="object")throw new Error("can't deserialize object of type "+typeof l);const t=Vo(l)||"Object";if(!Ds[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=Ds[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(l);const d=Object.create(a.prototype);for(const y of Object.keys(l)){if(y==="$name")continue;const T=l[y];d[y]=Ds[t].shallow.indexOf(y)>=0?T:Ua(T)}return d}class _h{constructor(){this.first=!0}update(t,a){const d=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=d,!0))}}const wn={"Latin-1 Supplement":l=>l>=128&&l<=255,"Hangul Jamo":l=>l>=4352&&l<=4607,Khmer:l=>l>=6016&&l<=6143,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Kanbun:l=>l>=12688&&l<=12703,"CJK Strokes":l=>l>=12736&&l<=12783,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Hangul Syllables":l=>l>=44032&&l<=55215,"Private Use Area":l=>l>=57344&&l<=63743,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function lo(l){for(const t of l)if(Ml(t.charCodeAt(0)))return!0;return!1}function Go(l){for(const t of l)if(!Ff(t.charCodeAt(0)))return!1;return!0}function Al(l){const t=l.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const Bf=Al(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ff(l){return!Bf.test(String.fromCodePoint(l))}const yc=Al(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ml(l){return!(l!==746&&l!==747&&(l<4352||!(wn["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||wn["CJK Compatibility"](l)||wn["CJK Strokes"](l)||!(!wn["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||wn["Enclosed CJK Letters and Months"](l)||wn["Ideographic Description Characters"](l)||wn.Kanbun(l)||wn.Katakana(l)&&l!==12540||!(!wn["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!wn["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||wn["Vertical Forms"](l)||wn["Yijing Hexagram Symbols"](l)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(l))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(l))||yc.test(String.fromCodePoint(l)))))}function Ad(l){return!(Ml(l)||function(t){return!!(wn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||wn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||wn["Letterlike Symbols"](t)||wn["Number Forms"](t)||wn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||wn["Control Pictures"](t)&&t!==9251||wn["Optical Character Recognition"](t)||wn["Enclosed Alphanumerics"](t)||wn["Geometric Shapes"](t)||wn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||wn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||wn["CJK Symbols and Punctuation"](t)||wn.Katakana(t)||wn["Private Use Area"](t)||wn["CJK Compatibility Forms"](t)||wn["Small Form Variants"](t)||wn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(l))}const Uf=Al(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function co(l){return Uf.test(String.fromCodePoint(l))}function Md(l,t){return!(!t&&co(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||wn.Khmer(l))}function Cd(l){for(const t of l)if(co(t.charCodeAt(0)))return!0;return!1}const uo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){if(uo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(l,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(l.pluginStatus!=="loading")return this.setState(l),l;const a=l.pluginURL,d=new Promise(T=>{this.loadScriptResolve=T});t(a);const y=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([d,y]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:a};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class pi{constructor(t,a){this.zoom=t,a?(this.now=a.now||0,this.fadeDuration=a.fadeDuration||0,this.zoomHistory=a.zoomHistory||new _h,this.transition=a.transition||{},this.globalState=a.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new _h,this.transition={},this.globalState={})}isSupportedScript(t){return function(a,d){for(const y of a)if(!Md(y.charCodeAt(0),d))return!1;return!0}(t,uo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),d=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*a}}}class rs{constructor(t,a){this.property=t,this.value=a,this.expression=function(d,y){if(la(d))return new Oa(d,y);if(hc(d)){const T=As(d,y);if(T.result==="error")throw new Error(T.value.map(S=>`${S.key}: ${S.message}`).join(", "));return T.value}{let T=d;return y.type==="color"&&typeof d=="string"?T=mn.parse(d):y.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?y.type!=="numberArray"||typeof d!="number"&&!Array.isArray(d)?y.type!=="colorArray"||typeof d!="string"&&!Array.isArray(d)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?T=Cn.parse(d):y.type==="projectionDefinition"&&typeof d=="string"&&(T=hn.parse(d)):T=fr.parse(d):T=Oi.parse(d):T=Li.parse(d),{globalStateRefs:new Set,kind:"constant",evaluate:()=>T}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,a,d){return this.property.possiblyEvaluate(this,t,a,d)}}class Tn{constructor(t){this.property=t,this.value=new rs(t,void 0)}transitioned(t,a){return new ir(this.property,this.value,a,Hi({},t.transition,this.transition),t.now)}untransitioned(){return new ir(this.property,this.value,null,{},0)}}class ei{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Pn(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Tn(this._values[t].property)),this._values[t].value=new rs(this._values[t].property,a===null?void 0:Pn(a))}getTransition(t){return Pn(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Tn(this._values[t].property)),this._values[t].transition=Pn(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const d=this.getValue(a);d!==void 0&&(t[a]=d);const y=this.getTransition(a);y!==void 0&&(t[`${a}-transition`]=y)}return t}transitioned(t,a){const d=new vh(this._properties);for(const y of Object.keys(this._values))d._values[y]=this._values[y].transitioned(t,a._values[y]);return d}untransitioned(){const t=new vh(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class ir{constructor(t,a,d,y,T){this.property=t,this.value=a,this.begin=T+y.delay||0,this.end=this.begin+y.duration||0,t.specification.transition&&(y.delay||y.duration)&&(this.prior=d)}possiblyEvaluate(t,a,d){const y=t.now||0,T=this.value.possiblyEvaluate(t,a,d),S=this.prior;if(S){if(y>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(y<this.begin)return S.possiblyEvaluate(t,a,d);{const A=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(t,a,d),T,Wt(A))}}return T}}class vh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,d){const y=new _c(this._properties);for(const T of Object.keys(this._values))y._values[T]=this._values[T].possiblyEvaluate(t,a,d);return y}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class fu{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Pn(this._values[t].value)}setValue(t,a){this._values[t]=new rs(this._values[t].property,a===null?void 0:Pn(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const d=this.getValue(a);d!==void 0&&(t[a]=d)}return t}possiblyEvaluate(t,a,d){const y=new _c(this._properties);for(const T of Object.keys(this._values))y._values[T]=this._values[T].possiblyEvaluate(t,a,d);return y}}class Jr{constructor(t,a,d){this.property=t,this.value=a,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,d,y){return this.property.evaluate(this.value,this.parameters,t,a,d,y)}}class _c{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ot{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,d){const y=za[this.specification.type];return y?y(t,a,d):t}}class Zt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,d,y){return new Jr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},d,y)}:t.expression,a)}interpolate(t,a,d){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new Jr(this,{kind:"constant",value:void 0},t.parameters);const y=za[this.specification.type];if(y){const T=y(t.value.value,a.value.value,d);return new Jr(this,{kind:"constant",value:T},t.parameters)}return t}evaluate(t,a,d,y,T,S){return t.kind==="constant"?t.value:t.evaluate(a,d,y,T,S)}}class Dd extends Zt{possiblyEvaluate(t,a,d,y){if(t.value===void 0)return new Jr(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const T=t.expression.evaluate(a,null,{},d,y),S=t.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,A=this._calculate(S,S,S,a);return new Jr(this,{kind:"constant",value:A},a)}if(t.expression.kind==="camera"){const T=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new Jr(this,{kind:"constant",value:T},a)}return new Jr(this,t.expression,a)}evaluate(t,a,d,y,T,S){if(t.kind==="source"){const A=t.evaluate(a,d,y,T,S);return this._calculate(A,A,A,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},d,y),t.evaluate({zoom:Math.floor(a.zoom)},d,y),t.evaluate({zoom:Math.floor(a.zoom)+1},d,y),a):t.value}_calculate(t,a,d,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:d,to:a}}interpolate(t){return t}}class Ui{constructor(t){this.specification=t}possiblyEvaluate(t,a,d,y){if(t.value!==void 0){if(t.expression.kind==="constant"){const T=t.expression.evaluate(a,null,{},d,y);return this._calculate(T,T,T,a)}return this._calculate(t.expression.evaluate(new pi(Math.floor(a.zoom-1),a)),t.expression.evaluate(new pi(Math.floor(a.zoom),a)),t.expression.evaluate(new pi(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,d,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:d,to:a}}interpolate(t){return t}}class vc{constructor(t){this.specification=t}possiblyEvaluate(t,a,d,y){return!!t.expression.evaluate(a,null,{},d,y)}interpolate(){return!1}}class Vr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const d=t[a];d.specification.overridable&&this.overridableProperties.push(a);const y=this.defaultPropertyValues[a]=new rs(d,void 0),T=this.defaultTransitionablePropertyValues[a]=new Tn(d);this.defaultTransitioningPropertyValues[a]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=y.possiblyEvaluate({})}}}zt("DataDrivenProperty",Zt),zt("DataConstantProperty",Ot),zt("CrossFadedDataDrivenProperty",Dd),zt("CrossFadedProperty",Ui),zt("ColorRampProperty",vc);const Vf="-transition";class zr extends lt{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=Wi(t.filter)),a.layout&&(this._unevaluatedLayout=new fu(a.layout)),a.paint)){this._transitionablePaint=new ei(a.paint);for(const d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(const d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _c(a.paint)}}setFilter(t){this.filter=t,this._featureFilter=Wi(t)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const a in this._unevaluatedLayout._values){const d=this._unevaluatedLayout._values[a];for(const y of d.getGlobalStateRefs())t.add(y)}for(const a of this._featureFilter.getGlobalStateRefs())t.add(a);return t}setLayoutProperty(t,a,d={}){a!=null&&this._validate(Td,`layers.${this.id}.layout.${t}`,t,a,d)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(Vf)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,d={}){if(a!=null&&this._validate(yh,`layers.${this.id}.paint.${t}`,t,a,d))return!1;if(t.endsWith(Vf))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const y=this._transitionablePaint._values[t],T=y.property.specification["property-type"]==="cross-faded-data-driven",S=y.value.isDataDriven(),A=y.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const k=this._transitionablePaint._values[t].value;return k.isDataDriven()||S||T||this._handleOverridablePaintPropertyUpdate(t,A,k)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,d){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),br(t,(a,d)=>!(a===void 0||d==="layout"&&!Object.keys(a).length||d==="paint"&&!Object.keys(a).length))}_validate(t,a,d,y,T={}){return(!T||T.validate!==!1)&&Sl(this,t.call(Tl,{key:a,layerType:this.type,objectKey:d,value:y,styleSpec:Ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof Jr&&Ss(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const tm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Zo{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ni(l,t=1){let a=0,d=0;return{members:l.map(y=>{const T=tm[y.type].BYTES_PER_ELEMENT,S=a=ha(a,Math.max(t,T)),A=y.components||1;return d=Math.max(d,T),a+=T*A,{name:y.name,type:y.type,components:A,offset:S}}),size:ha(a,Math.max(d,t)),alignment:t}}function ha(l,t){return Math.ceil(l/t)*t}class mi extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const d=this.length;return this.resize(d+1),this.emplace(d,t,a)}emplace(t,a,d){const y=2*t;return this.int16[y+0]=a,this.int16[y+1]=d,t}}mi.prototype.bytesPerElement=4,zt("StructArrayLayout2i4",mi);class ho extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,d)}emplace(t,a,d,y){const T=3*t;return this.int16[T+0]=a,this.int16[T+1]=d,this.int16[T+2]=y,t}}ho.prototype.bytesPerElement=6,zt("StructArrayLayout3i6",ho);class xc extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,d,y)}emplace(t,a,d,y,T){const S=4*t;return this.int16[S+0]=a,this.int16[S+1]=d,this.int16[S+2]=y,this.int16[S+3]=T,t}}xc.prototype.bytesPerElement=8,zt("StructArrayLayout4i8",xc);class bc extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,d,y,T,S)}emplace(t,a,d,y,T,S,A){const k=6*t;return this.int16[k+0]=a,this.int16[k+1]=d,this.int16[k+2]=y,this.int16[k+3]=T,this.int16[k+4]=S,this.int16[k+5]=A,t}}bc.prototype.bytesPerElement=12,zt("StructArrayLayout2i4i12",bc);class $o extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,d,y,T,S)}emplace(t,a,d,y,T,S,A){const k=4*t,N=8*t;return this.int16[k+0]=a,this.int16[k+1]=d,this.uint8[N+4]=y,this.uint8[N+5]=T,this.uint8[N+6]=S,this.uint8[N+7]=A,t}}$o.prototype.bytesPerElement=8,zt("StructArrayLayout2i4ub8",$o);class Va extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const d=this.length;return this.resize(d+1),this.emplace(d,t,a)}emplace(t,a,d){const y=2*t;return this.float32[y+0]=a,this.float32[y+1]=d,t}}Va.prototype.bytesPerElement=8,zt("StructArrayLayout2f8",Va);class pu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S,A,k,N,O){const F=this.length;return this.resize(F+1),this.emplace(F,t,a,d,y,T,S,A,k,N,O)}emplace(t,a,d,y,T,S,A,k,N,O,F){const $=10*t;return this.uint16[$+0]=a,this.uint16[$+1]=d,this.uint16[$+2]=y,this.uint16[$+3]=T,this.uint16[$+4]=S,this.uint16[$+5]=A,this.uint16[$+6]=k,this.uint16[$+7]=N,this.uint16[$+8]=O,this.uint16[$+9]=F,t}}pu.prototype.bytesPerElement=20,zt("StructArrayLayout10ui20",pu);class mu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S,A,k,N,O,F,$){const H=this.length;return this.resize(H+1),this.emplace(H,t,a,d,y,T,S,A,k,N,O,F,$)}emplace(t,a,d,y,T,S,A,k,N,O,F,$,H){const W=12*t;return this.int16[W+0]=a,this.int16[W+1]=d,this.int16[W+2]=y,this.int16[W+3]=T,this.uint16[W+4]=S,this.uint16[W+5]=A,this.uint16[W+6]=k,this.uint16[W+7]=N,this.int16[W+8]=O,this.int16[W+9]=F,this.int16[W+10]=$,this.int16[W+11]=H,t}}mu.prototype.bytesPerElement=24,zt("StructArrayLayout4i4ui4i24",mu);class xh extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,d)}emplace(t,a,d,y){const T=3*t;return this.float32[T+0]=a,this.float32[T+1]=d,this.float32[T+2]=y,t}}xh.prototype.bytesPerElement=12,zt("StructArrayLayout3f12",xh);class x extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}x.prototype.bytesPerElement=4,zt("StructArrayLayout1ul4",x);class e extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S,A,k,N){const O=this.length;return this.resize(O+1),this.emplace(O,t,a,d,y,T,S,A,k,N)}emplace(t,a,d,y,T,S,A,k,N,O){const F=10*t,$=5*t;return this.int16[F+0]=a,this.int16[F+1]=d,this.int16[F+2]=y,this.int16[F+3]=T,this.int16[F+4]=S,this.int16[F+5]=A,this.uint32[$+3]=k,this.uint16[F+8]=N,this.uint16[F+9]=O,t}}e.prototype.bytesPerElement=20,zt("StructArrayLayout6i1ul2ui20",e);class s extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,d,y,T,S)}emplace(t,a,d,y,T,S,A){const k=6*t;return this.int16[k+0]=a,this.int16[k+1]=d,this.int16[k+2]=y,this.int16[k+3]=T,this.int16[k+4]=S,this.int16[k+5]=A,t}}s.prototype.bytesPerElement=12,zt("StructArrayLayout2i2i2i12",s);class f extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T){const S=this.length;return this.resize(S+1),this.emplace(S,t,a,d,y,T)}emplace(t,a,d,y,T,S){const A=4*t,k=8*t;return this.float32[A+0]=a,this.float32[A+1]=d,this.float32[A+2]=y,this.int16[k+6]=T,this.int16[k+7]=S,t}}f.prototype.bytesPerElement=16,zt("StructArrayLayout2f1f2i16",f);class g extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,d,y,T,S)}emplace(t,a,d,y,T,S,A){const k=16*t,N=4*t,O=8*t;return this.uint8[k+0]=a,this.uint8[k+1]=d,this.float32[N+1]=y,this.float32[N+2]=T,this.int16[O+6]=S,this.int16[O+7]=A,t}}g.prototype.bytesPerElement=16,zt("StructArrayLayout2ub2f2i16",g);class w extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,d)}emplace(t,a,d,y){const T=3*t;return this.uint16[T+0]=a,this.uint16[T+1]=d,this.uint16[T+2]=y,t}}w.prototype.bytesPerElement=6,zt("StructArrayLayout3ui6",w);class E extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe){const ke=this.length;return this.resize(ke+1),this.emplace(ke,t,a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe)}emplace(t,a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe,ke){const xe=24*t,q=12*t,se=48*t;return this.int16[xe+0]=a,this.int16[xe+1]=d,this.uint16[xe+2]=y,this.uint16[xe+3]=T,this.uint32[q+2]=S,this.uint32[q+3]=A,this.uint32[q+4]=k,this.uint16[xe+10]=N,this.uint16[xe+11]=O,this.uint16[xe+12]=F,this.float32[q+7]=$,this.float32[q+8]=H,this.uint8[se+36]=W,this.uint8[se+37]=J,this.uint8[se+38]=oe,this.uint32[q+10]=fe,this.int16[xe+22]=ke,t}}E.prototype.bytesPerElement=48,zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",E);class C extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe,ke,xe,q,se,we,Ge,ht,Qe,it,bt,pt){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,t,a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe,ke,xe,q,se,we,Ge,ht,Qe,it,bt,pt)}emplace(t,a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe,ke,xe,q,se,we,Ge,ht,Qe,it,bt,pt,Tt){const at=32*t,Ft=16*t;return this.int16[at+0]=a,this.int16[at+1]=d,this.int16[at+2]=y,this.int16[at+3]=T,this.int16[at+4]=S,this.int16[at+5]=A,this.int16[at+6]=k,this.int16[at+7]=N,this.uint16[at+8]=O,this.uint16[at+9]=F,this.uint16[at+10]=$,this.uint16[at+11]=H,this.uint16[at+12]=W,this.uint16[at+13]=J,this.uint16[at+14]=oe,this.uint16[at+15]=fe,this.uint16[at+16]=ke,this.uint16[at+17]=xe,this.uint16[at+18]=q,this.uint16[at+19]=se,this.uint16[at+20]=we,this.uint16[at+21]=Ge,this.uint16[at+22]=ht,this.uint32[Ft+12]=Qe,this.float32[Ft+13]=it,this.float32[Ft+14]=bt,this.uint16[at+30]=pt,this.uint16[at+31]=Tt,t}}C.prototype.bytesPerElement=64,zt("StructArrayLayout8i15ui1ul2f2ui64",C);class R extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}R.prototype.bytesPerElement=4,zt("StructArrayLayout1f4",R);class L extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,d)}emplace(t,a,d,y){const T=3*t;return this.uint16[6*t+0]=a,this.float32[T+1]=d,this.float32[T+2]=y,t}}L.prototype.bytesPerElement=12,zt("StructArrayLayout1ui2f12",L);class j extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,d){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,d)}emplace(t,a,d,y){const T=4*t;return this.uint32[2*t+0]=a,this.uint16[T+2]=d,this.uint16[T+3]=y,t}}j.prototype.bytesPerElement=8,zt("StructArrayLayout1ul2ui8",j);class G extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const d=this.length;return this.resize(d+1),this.emplace(d,t,a)}emplace(t,a,d){const y=2*t;return this.uint16[y+0]=a,this.uint16[y+1]=d,t}}G.prototype.bytesPerElement=4,zt("StructArrayLayout2ui4",G);class V extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}V.prototype.bytesPerElement=2,zt("StructArrayLayout1ui2",V);class Y extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,d,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,d,y)}emplace(t,a,d,y,T){const S=4*t;return this.float32[S+0]=a,this.float32[S+1]=d,this.float32[S+2]=y,this.float32[S+3]=T,t}}Y.prototype.bytesPerElement=16,zt("StructArrayLayout4f16",Y);class K extends Zo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ne(this.anchorPointX,this.anchorPointY)}}K.prototype.size=20;class ue extends e{get(t){return new K(this,t)}}zt("CollisionBoxArray",ue);class ce extends Zo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ce.prototype.size=48;class de extends E{get(t){return new ce(this,t)}}zt("PlacedSymbolArray",de);class pe extends Zo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}pe.prototype.size=64;class be extends C{get(t){return new pe(this,t)}}zt("SymbolInstanceArray",be);class ge extends R{getoffsetX(t){return this.float32[1*t+0]}}zt("GlyphOffsetArray",ge);class Te extends ho{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}zt("SymbolLineVertexArray",Te);class Ee extends Zo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ee.prototype.size=12;class _e extends L{get(t){return new Ee(this,t)}}zt("TextAnchorOffsetArray",_e);class Ie extends Zo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ie.prototype.size=8;class qe extends j{get(t){return new Ie(this,t)}}zt("FeatureIndexArray",qe);class Fe extends mi{}class Ue extends mi{}class We extends mi{}class Ct extends bc{}class Et extends $o{}class ft extends Va{}class Bt extends pu{}class gn extends mu{}class jn extends xh{}class Pi extends x{}class ti extends s{}class Bi extends g{}class ni extends w{}class ii extends G{}const oi=Ni([{name:"a_pos",components:2,type:"Int16"}],4),{members:wr}=oi;class Rn{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,d,y){const T=this.segments[this.segments.length-1];return t>Rn.MAX_VERTEX_ARRAY_LENGTH&&qn(`Max vertices per segment is ${Rn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Rn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+t>Rn.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==y?this.createNewSegment(a,d,y):T}createNewSegment(t,a,d){const y={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(y.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(y),y}getOrCreateLatestSegment(t,a,d){return this.prepareSegment(0,t,a,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,d,y){return new Rn([{vertexOffset:t,primitiveOffset:a,vertexLength:d,primitiveLength:y,vaos:{},sortKey:0}])}}function Tr(l,t){return 256*(l=Gn(Math.floor(l),0,255))+Gn(Math.floor(t),0,255)}Rn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zt("SegmentVector",Rn);const Gr=Ni([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Cl,Yo,as,ss={exports:{}},Dl={exports:{}},gu={exports:{}},wc=function(){if(as)return ss.exports;as=1;var l=(Cl||(Cl=1,Dl.exports=function(a,d){var y,T,S,A,k,N,O,F;for(T=a.length-(y=3&a.length),S=d,k=3432918353,N=461845907,F=0;F<T;)O=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,S=27492+(65535&(A=5*(65535&(S=(S^=O=(65535&(O=(O=(65535&O)*k+(((O>>>16)*k&65535)<<16)&4294967295)<<15|O>>>17))*N+(((O>>>16)*N&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(O=0,y){case 3:O^=(255&a.charCodeAt(F+2))<<16;case 2:O^=(255&a.charCodeAt(F+1))<<8;case 1:S^=O=(65535&(O=(O=(65535&(O^=255&a.charCodeAt(F)))*k+(((O>>>16)*k&65535)<<16)&4294967295)<<15|O>>>17))*N+(((O>>>16)*N&65535)<<16)&4294967295}return S^=a.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),Dl.exports),t=(Yo||(Yo=1,gu.exports=function(a,d){for(var y,T=a.length,S=d^T,A=0;T>=4;)y=1540483477*(65535&(y=255&a.charCodeAt(A)|(255&a.charCodeAt(++A))<<8|(255&a.charCodeAt(++A))<<16|(255&a.charCodeAt(++A))<<24))+((1540483477*(y>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),T-=4,++A;switch(T){case 3:S^=(255&a.charCodeAt(A+2))<<16;case 2:S^=(255&a.charCodeAt(A+1))<<8;case 1:S=1540483477*(65535&(S^=255&a.charCodeAt(A)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),gu.exports);return ss.exports=l,ss.exports.murmur3=l,ss.exports.murmur2=t,ss.exports}(),Zr=D(wc);class os{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,d,y){this.ids.push(qo(t)),this.positions.push(a,d,y)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=qo(t);let d=0,y=this.ids.length-1;for(;d<y;){const S=d+y>>1;this.ids[S]>=a?y=S:d=S+1}const T=[];for(;this.ids[d]===a;)T.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return T}static serialize(t,a){const d=new Float64Array(t.ids),y=new Uint32Array(t.positions);return Tc(d,y,0,d.length-1),a&&a.push(d.buffer,y.buffer),{ids:d,positions:y}}static deserialize(t){const a=new os;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function qo(l){const t=+l;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Zr(String(l))}function Tc(l,t,a,d){for(;a<d;){const y=l[a+d>>1];let T=a-1,S=d+1;for(;;){do T++;while(l[T]<y);do S--;while(l[S]>y);if(T>=S)break;gi(l,T,S),gi(t,3*T,3*S),gi(t,3*T+1,3*S+1),gi(t,3*T+2,3*S+2)}S-a<d-S?(Tc(l,t,a,S),a=S+1):(Tc(l,t,S+1,d),d=S)}}function gi(l,t,a){const d=l[t];l[t]=l[a],l[a]=d}zt("FeaturePositionMap",os);class ri{constructor(t,a){this.gl=t.gl,this.location=a}}class Nr extends ri{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Vi extends ri{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class bh extends ri{constructor(t,a){super(t,a),this.current=mn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const nm=new Float32Array(16);function kd(l){return[Tr(255*l.r,255*l.g),Tr(255*l.b,255*l.a)]}class fo{constructor(t,a,d){this.value=t,this.uniformNames=a.map(y=>`u_${y}`),this.type=d}setUniform(t,a,d){t.set(d.constantOr(this.value))}getBinding(t,a,d){return this.type==="color"?new bh(t,a):new Nr(t,a)}}class Sc{constructor(t,a){this.uniformNames=a.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,d,y){const T=y==="u_pattern_to"?this.patternTo:y==="u_pattern_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&t.set(T)}getBinding(t,a,d){return d.substr(0,9)==="u_pattern"?new Vi(t,a):new Nr(t,a)}}class yr{constructor(t,a,d,y){this.expression=t,this.type=d,this.maxValue=0,this.paintVertexAttributes=a.map(T=>({name:`a_${T}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,a,d,y,T){const S=this.paintVertexArray.length,A=this.expression.evaluate(new pi(0),a,{},y,[],T);this.paintVertexArray.resize(t),this._setPaintValue(S,t,A)}updatePaintArray(t,a,d,y){const T=this.expression.evaluate({zoom:0},d,y);this._setPaintValue(t,a,T)}_setPaintValue(t,a,d){if(this.type==="color"){const y=kd(d);for(let T=t;T<a;T++)this.paintVertexArray.emplace(T,y[0],y[1])}else{for(let y=t;y<a;y++)this.paintVertexArray.emplace(y,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ai{constructor(t,a,d,y,T,S){this.expression=t,this.uniformNames=a.map(A=>`u_${A}_t`),this.type=d,this.useIntegerZoom=y,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=a.map(A=>({name:`a_${A}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(t,a,d,y,T){const S=this.expression.evaluate(new pi(this.zoom),a,{},y,[],T),A=this.expression.evaluate(new pi(this.zoom+1),a,{},y,[],T),k=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(k,t,S,A)}updatePaintArray(t,a,d,y){const T=this.expression.evaluate({zoom:this.zoom},d,y),S=this.expression.evaluate({zoom:this.zoom+1},d,y);this._setPaintValue(t,a,T,S)}_setPaintValue(t,a,d,y){if(this.type==="color"){const T=kd(d),S=kd(y);for(let A=t;A<a;A++)this.paintVertexArray.emplace(A,T[0],T[1],S[0],S[1])}else{for(let T=t;T<a;T++)this.paintVertexArray.emplace(T,d,y);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(y))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const d=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,y=Gn(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);t.set(y)}getBinding(t,a,d){return new Nr(t,a)}}class ea{constructor(t,a,d,y,T,S){this.expression=t,this.type=a,this.useIntegerZoom=d,this.zoom=y,this.layerId=S,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(t,a,d){const y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(y,t,a.patterns&&a.patterns[this.layerId],d)}updatePaintArray(t,a,d,y,T){this._setPaintValues(t,a,d.patterns&&d.patterns[this.layerId],T)}_setPaintValues(t,a,d,y){if(!y||!d)return;const{min:T,mid:S,max:A}=d,k=y[T],N=y[S],O=y[A];if(k&&N&&O)for(let F=t;F<a;F++)this.zoomInPaintVertexArray.emplace(F,N.tl[0],N.tl[1],N.br[0],N.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],N.pixelRatio,k.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,N.tl[0],N.tl[1],N.br[0],N.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],N.pixelRatio,O.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Gr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Gr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Id{constructor(t,a,d){this.binders={},this._buffers=[];const y=[];for(const T in t.paint._values){if(!d(T))continue;const S=t.paint.get(T);if(!(S instanceof Jr&&Ss(S.property.specification)))continue;const A=ks(T,t.type),k=S.value,N=S.property.specification.type,O=S.property.useIntegerZoom,F=S.property.specification["property-type"],$=F==="cross-faded"||F==="cross-faded-data-driven";if(k.kind==="constant")this.binders[T]=$?new Sc(k.value,A):new fo(k.value,A,N),y.push(`/u_${T}`);else if(k.kind==="source"||$){const H=rr(T,N,"source");this.binders[T]=$?new ea(k,N,O,a,H,t.id):new yr(k,A,N,H),y.push(`/a_${T}`)}else{const H=rr(T,N,"composite");this.binders[T]=new Ai(k,A,N,O,a,H),y.push(`/z_${T}`)}}this.cacheKey=y.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof yr||a instanceof Ai?a.maxValue:0}populatePaintArrays(t,a,d,y,T){for(const S in this.binders){const A=this.binders[S];(A instanceof yr||A instanceof Ai||A instanceof ea)&&A.populatePaintArray(t,a,d,y,T)}}setConstantPatternPositions(t,a){for(const d in this.binders){const y=this.binders[d];y instanceof Sc&&y.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,d,y,T){let S=!1;for(const A in t){const k=a.getPositions(A);for(const N of k){const O=d.feature(N.index);for(const F in this.binders){const $=this.binders[F];if(($ instanceof yr||$ instanceof Ai||$ instanceof ea)&&$.expression.isStateDependent===!0){const H=y.paint.get(F);$.expression=H.value,$.updatePaintArray(N.start,N.end,O,t[A],T),S=!0}}}}return S}defines(){const t=[];for(const a in this.binders){const d=this.binders[a];(d instanceof fo||d instanceof Sc)&&t.push(...d.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const d=this.binders[a];if(d instanceof yr||d instanceof Ai)for(let y=0;y<d.paintVertexAttributes.length;y++)t.push(d.paintVertexAttributes[y].name);else if(d instanceof ea)for(let y=0;y<Gr.members.length;y++)t.push(Gr.members[y].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const d=this.binders[a];if(d instanceof fo||d instanceof Sc||d instanceof Ai)for(const y of d.uniformNames)t.push(y)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const d=[];for(const y in this.binders){const T=this.binders[y];if(T instanceof fo||T instanceof Sc||T instanceof Ai){for(const S of T.uniformNames)if(a[S]){const A=T.getBinding(t,a[S],S);d.push({name:S,property:y,binding:A})}}}return d}setUniforms(t,a,d,y){for(const{name:T,property:S,binding:A}of a)this.binders[S].setUniform(A,y,d.get(S),T)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const d=this.binders[a];if(t&&d instanceof ea){const y=t.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(d instanceof yr||d instanceof Ai)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(t){for(const a in this.binders){const d=this.binders[a];(d instanceof yr||d instanceof Ai||d instanceof ea)&&d.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof yr||a instanceof Ai||a instanceof ea)&&a.destroy()}}}class da{constructor(t,a,d=()=>!0){this.programConfigurations={};for(const y of t)this.programConfigurations[y.id]=new Id(y,a,d);this.needsUpload=!1,this._featureMap=new os,this._bufferOffset=0}populatePaintArrays(t,a,d,y,T,S){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(t,a,y,T,S);a.id!==void 0&&this._featureMap.add(a.id,d,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,d,y){for(const T of d)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(t,this._featureMap,a,T,y)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function ks(l,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${t}-`,"").replace(/-/g,"_")]}function rr(l,t,a){const d={color:{source:Va,composite:Y},number:{source:R,composite:Va}},y=function(T){return{"line-pattern":{source:Bt,composite:Bt},"fill-pattern":{source:Bt,composite:Bt},"fill-extrusion-pattern":{source:Bt,composite:Bt}}[T]}(l);return y&&y[a]||d[t][a]}zt("ConstantBinder",fo),zt("CrossFadedConstantBinder",Sc),zt("SourceExpressionBinder",yr),zt("CrossFadedCompositeBinder",ea),zt("CompositeExpressionBinder",Ai),zt("ProgramConfiguration",Id,{omit:["_buffers"]}),zt("ProgramConfigurationSet",da);const kl=Math.pow(2,14)-1,im=-kl-1;function Ec(l){const t=wt/l.extent,a=l.loadGeometry();for(let d=0;d<a.length;d++){const y=a[d];for(let T=0;T<y.length;T++){const S=y[T],A=Math.round(S.x*t),k=Math.round(S.y*t);S.x=Gn(A,im,kl),S.y=Gn(k,im,kl),(A<S.x||A>S.x+1||k<S.y||k>S.y+1)&&qn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function yu(l,t){return{type:l.type,id:l.id,properties:l.properties,geometry:t?Ec(l):[]}}const Cg=-32768;function wh(l,t,a,d,y){l.emplaceBack(Cg+8*t+d,Cg+8*a+y)}class Rd{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ue,this.indexArray=new ni,this.segments=new Rn,this.programConfigurations=new da(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,d){const y=this.layers[0],T=[];let S=null,A=!1,k=y.type==="heatmap";if(y.type==="circle"){const O=y;S=O.layout.get("circle-sort-key"),A=!S.isConstant(),k=k||O.paint.get("circle-pitch-alignment")==="map"}const N=k?a.subdivisionGranularity.circle:1;for(const{feature:O,id:F,index:$,sourceLayerIndex:H}of t){const W=this.layers[0]._featureFilter.needGeometry,J=yu(O,W);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{globalState:this.globalState}),J,d))continue;const oe=A?S.evaluate(J,{},d):void 0,fe={id:F,properties:O.properties,type:O.type,sourceLayerIndex:H,index:$,geometry:W?J.geometry:Ec(O),patterns:{},sortKey:oe};T.push(fe)}A&&T.sort((O,F)=>O.sortKey-F.sortKey);for(const O of T){const{geometry:F,index:$,sourceLayerIndex:H}=O,W=t[$].feature;this.addFeature(O,F,$,d,N),a.featureIndex.insert(W,F,$,H,this.index)}}update(t,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wr),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,d,y,T=1){let S;switch(T){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const A=S.length;for(const k of a)for(const N of k){const O=N.x,F=N.y;if(O<0||O>=wt||F<0||F>=wt)continue;const $=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,t.sortKey),H=$.vertexLength;for(let W=0;W<A;W++)for(let J=0;J<A;J++)wh(this.layoutVertexArray,O,F,S[J],S[W]);for(let W=0;W<A-1;W++)for(let J=0;J<A-1;J++){const oe=H+W*A+J,fe=H+(W+1)*A+J;this.indexArray.emplaceBack(oe,fe+1,oe+1),this.indexArray.emplaceBack(oe,fe,fe+1)}$.vertexLength+=A*A,$.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,{},y)}}function Dg(l,t){for(let a=0;a<l.length;a++)if(Th(t,l[a]))return!0;for(let a=0;a<t.length;a++)if(Th(l,t[a]))return!0;return!!am(l,t)}function q_(l,t,a){return!!Th(l,t)||!!sm(t,l,a)}function kg(l,t){if(l.length===1)return H_(t,l[0]);for(let a=0;a<t.length;a++){const d=t[a];for(let y=0;y<d.length;y++)if(Th(l,d[y]))return!0}for(let a=0;a<l.length;a++)if(H_(t,l[a]))return!0;for(let a=0;a<t.length;a++)if(am(l,t[a]))return!0;return!1}function rm(l,t,a){if(l.length>1){if(am(l,t))return!0;for(let d=0;d<t.length;d++)if(sm(t[d],l,a))return!0}for(let d=0;d<l.length;d++)if(sm(l[d],t,a))return!0;return!1}function am(l,t){if(l.length===0||t.length===0)return!1;for(let a=0;a<l.length-1;a++){const d=l[a],y=l[a+1];for(let T=0;T<t.length-1;T++)if(Ig(d,y,t[T],t[T+1]))return!0}return!1}function Ig(l,t,a,d){return aa(l,a,d)!==aa(t,a,d)&&aa(l,t,a)!==aa(l,t,d)}function sm(l,t,a){const d=a*a;if(t.length===1)return l.distSqr(t[0])<d;for(let y=1;y<t.length;y++)if(Rg(l,t[y-1],t[y])<d)return!0;return!1}function Rg(l,t,a){const d=t.distSqr(a);if(d===0)return l.distSqr(t);const y=((l.x-t.x)*(a.x-t.x)+(l.y-t.y)*(a.y-t.y))/d;return l.distSqr(y<0?t:y>1?a:a.sub(t)._mult(y)._add(t))}function H_(l,t){let a,d,y,T=!1;for(let S=0;S<l.length;S++){a=l[S];for(let A=0,k=a.length-1;A<a.length;k=A++)d=a[A],y=a[k],d.y>t.y!=y.y>t.y&&t.x<(y.x-d.x)*(t.y-d.y)/(y.y-d.y)+d.x&&(T=!T)}return T}function Th(l,t){let a=!1;for(let d=0,y=l.length-1;d<l.length;y=d++){const T=l[d],S=l[y];T.y>t.y!=S.y>t.y&&t.x<(S.x-T.x)*(t.y-T.y)/(S.y-T.y)+T.x&&(a=!a)}return a}function ta(l,t,a){const d=a[0],y=a[2];if(l.x<d.x&&t.x<d.x||l.x>y.x&&t.x>y.x||l.y<d.y&&t.y<d.y||l.y>y.y&&t.y>y.y)return!1;const T=aa(l,t,a[0]);return T!==aa(l,t,a[1])||T!==aa(l,t,a[2])||T!==aa(l,t,a[3])}function Sr(l,t,a){const d=t.paint.get(l).value;return d.kind==="constant"?d.value:a.programConfigurations.get(t.id).getMaxValue(l)}function Gf(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Zf(l,t,a,d,y){if(!t[0]&&!t[1])return l;const T=ne.convert(t)._mult(y);a==="viewport"&&T._rotate(-d);const S=[];for(let A=0;A<l.length;A++)S.push(l[A].sub(T));return S}let zg,Ng;zt("CircleBucket",Rd,{omit:["layers"]});var X_={get paint(){return Ng=Ng||new Vr({"circle-radius":new Zt(Ae.paint_circle["circle-radius"]),"circle-color":new Zt(Ae.paint_circle["circle-color"]),"circle-blur":new Zt(Ae.paint_circle["circle-blur"]),"circle-opacity":new Zt(Ae.paint_circle["circle-opacity"]),"circle-translate":new Ot(Ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Ot(Ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ot(Ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ot(Ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zt(Ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zt(Ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zt(Ae.paint_circle["circle-stroke-opacity"])})},get layout(){return zg=zg||new Vr({"circle-sort-key":new Zt(Ae.layout_circle["circle-sort-key"])})}};class om extends zr{constructor(t){super(t,X_)}createBucket(t){return new Rd(t)}queryRadius(t){const a=t;return Sr("circle-radius",this,a)+Sr("circle-stroke-width",this,a)+Gf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:d,geometry:y,transform:T,pixelsToTileUnits:S,unwrappedTileID:A,getElevation:k}){const N=Zf(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,S),O=this.paint.get("circle-radius").evaluate(a,d)+this.paint.get("circle-stroke-width").evaluate(a,d),F=this.paint.get("circle-pitch-alignment")==="map",$=F?N:function(W,J,oe,fe){return W.map(ke=>lm(ke,J,oe,fe))}(N,T,A,k),H=F?O*S:O;for(const W of y)for(const J of W){const oe=F?J:lm(J,T,A,k);let fe=H;const ke=T.projectTileCoordinates(J.x,J.y,A,k).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?fe*=ke/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(fe*=T.cameraToCenterDistance/ke),q_($,oe,fe))return!0}return!1}}function lm(l,t,a,d){const y=t.projectTileCoordinates(l.x,l.y,a,d).point;return new ne((.5*y.x+.5)*t.width,(.5*-y.y+.5)*t.height)}class Pg extends Rd{}let Lg;zt("HeatmapBucket",Pg,{omit:["layers"]});var W_={get paint(){return Lg=Lg||new Vr({"heatmap-radius":new Zt(Ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zt(Ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ot(Ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new vc(Ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ot(Ae.paint_heatmap["heatmap-opacity"])})}};function $f(l,{width:t,height:a},d,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==t*a*d)throw new RangeError(`mismatched image size. expected: ${y.length} but got: ${t*a*d}`)}else y=new Uint8Array(t*a*d);return l.width=t,l.height=a,l.data=y,l}function cm(l,{width:t,height:a},d){if(t===l.width&&a===l.height)return;const y=$f({},{width:t,height:a},d);Yf(l,y,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,t),height:Math.min(l.height,a)},d),l.width=t,l.height=a,l.data=y.data}function Yf(l,t,a,d,y,T){if(y.width===0||y.height===0)return t;if(y.width>l.width||y.height>l.height||a.x>l.width-y.width||a.y>l.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>t.width||y.height>t.height||d.x>t.width-y.width||d.y>t.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const S=l.data,A=t.data;if(S===A)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<y.height;k++){const N=((a.y+k)*l.width+a.x)*T,O=((d.y+k)*t.width+d.x)*T;for(let F=0;F<y.width*T;F++)A[O+F]=S[N+F]}return t}class zd{constructor(t,a){$f(this,t,1,a)}resize(t){cm(this,t,1)}clone(){return new zd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,d,y,T){Yf(t,a,d,y,T,1)}}class fa{constructor(t,a){$f(this,t,4,a)}resize(t){cm(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new fa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,d,y,T){Yf(t,a,d,y,T,4)}setPixel(t,a,d){const y=4*(t*this.width+a);this.data[y+0]=Math.round(255*d.r/d.a),this.data[y+1]=Math.round(255*d.g/d.a),this.data[y+2]=Math.round(255*d.b/d.a),this.data[y+3]=Math.round(255*d.a)}}function qf(l){const t={},a=l.resolution||256,d=l.clips?l.clips.length:1,y=l.image||new fa({width:a,height:d});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const T=(S,A,k)=>{t[l.evaluationKey]=k;const N=l.expression.evaluate(t);y.setPixel(S/4/a,A/4,N)};if(l.clips)for(let S=0,A=0;S<d;++S,A+=4*a)for(let k=0,N=0;k<a;k++,N+=4){const O=k/(a-1),{start:F,end:$}=l.clips[S];T(A,N,F*(1-O)+$*O)}else for(let S=0,A=0;S<a;S++,A+=4)T(0,A,S/(a-1));return y}zt("AlphaImage",zd),zt("RGBAImage",fa);const Hf="big-fb";class Q_ extends zr{createBucket(t){return new Pg(t)}constructor(t){super(t,W_),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Hf)&&this.heatmapFbos.delete(Hf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let um;var K_={get paint(){return um=um||new Vr({"hillshade-illumination-direction":new Ot(Ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Ot(Ae.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Ot(Ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ot(Ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ot(Ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ot(Ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ot(Ae.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Ot(Ae.paint_hillshade["hillshade-method"])})}};class Ac extends zr{constructor(t){super(t,K_),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,d=this.paint.get("hillshade-highlight-color").values,y=this.paint.get("hillshade-shadow-color").values;const T=Math.max(t.length,a.length,d.length,y.length);t=t.concat(Array(T-t.length).fill(t.at(-1))),a=a.concat(Array(T-a.length).fill(a.at(-1))),d=d.concat(Array(T-d.length).fill(d.at(-1))),y=y.concat(Array(T-y.length).fill(y.at(-1)));const S=a.map(ci);return{directionRadians:t.map(ci),altitudeRadians:S,shadowColor:y,highlightColor:d}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let hm;var zv={get paint(){return hm=hm||new Vr({"color-relief-opacity":new Ot(Ae["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new vc(Ae["paint_color-relief"]["color-relief-color"])})}};class dm{constructor(t,a,d,y){this.context=t,this.format=d,this.texture=t.gl.createTexture(),this.update(a,y)}update(t,a,d){const{width:y,height:T}=t,S=!(this.size&&this.size[0]===y&&this.size[1]===T||d),{context:A}=this,{gl:k}=A;if(this.useMipmap=!!(a&&a.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!a||a.premultiply!==!1)),S)this.size=[y,T],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||qr(t)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,t):k.texImage2D(k.TEXTURE_2D,0,this.format,y,T,0,this.format,k.UNSIGNED_BYTE,t.data);else{const{x:N,y:O}=d||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||qr(t)?k.texSubImage2D(k.TEXTURE_2D,0,N,O,k.RGBA,k.UNSIGNED_BYTE,t):k.texSubImage2D(k.TEXTURE_2D,0,N,O,y,T,k.RGBA,k.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,a,d){const{context:y}=this,{gl:T}=y;T.bindTexture(T.TEXTURE_2D,this.texture),d!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=T.LINEAR),t!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,t),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,d||t),this.filter=t),a!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,a),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Il{constructor(t,a,d,y=1,T=1,S=1,A=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void qn(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const k=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=y,this.greenFactor=T,this.blueFactor=S,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let N=0;N<k;N++)this.data[this._idx(-1,N)]=this.data[this._idx(0,N)],this.data[this._idx(k,N)]=this.data[this._idx(k-1,N)],this.data[this._idx(N,-1)]=this.data[this._idx(N,0)],this.data[this._idx(N,k)]=this.data[this._idx(N,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let N=0;N<k;N++)for(let O=0;O<k;O++){const F=this.get(N,O);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(t,a){const d=new Uint8Array(this.data.buffer),y=4*this._idx(t,a);return this.unpack(d[y],d[y+1],d[y+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,d){return t*this.redFactor+a*this.greenFactor+d*this.blueFactor-this.baseShift}pack(t){return Og(t,this.getUnpackVector())}getPixels(){return new fa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,d){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let y=a*this.dim,T=a*this.dim+this.dim,S=d*this.dim,A=d*this.dim+this.dim;switch(a){case-1:y=T-1;break;case 1:T=y+1}switch(d){case-1:S=A-1;break;case 1:A=S+1}const k=-a*this.dim,N=-d*this.dim;for(let O=S;O<A;O++)for(let F=y;F<T;F++)this.data[this._idx(F,O)]=t.data[this._idx(F+k,O+N)]}}function Og(l,t){const a=t[0],d=t[1],y=t[2],T=t[3],S=Math.min(a,d,y),A=Math.round((l+T)/S);return{r:Math.floor(A*S/a)%256,g:Math.floor(A*S/d)%256,b:Math.floor(A*S/y)%256}}zt("DEMData",Il);class fm extends zr{constructor(t){super(t,zv)}_createColorRamp(t){const a={elevationStops:[],colorStops:[]},d=this._transitionablePaint._values["color-relief-color"].value.expression;if(d instanceof Kr&&d._styleExpression.expression instanceof Ur){this.colorRampExpression=d;const S=d._styleExpression.expression;a.elevationStops=S.labels,a.colorStops=[];for(const A of a.elevationStops)a.colorStops.push(S.evaluate({globals:{elevation:A}}))}if(a.elevationStops.length<1&&(a.elevationStops=[0],a.colorStops=[mn.transparent]),a.elevationStops.length<2&&(a.elevationStops.push(a.elevationStops[0]+1),a.colorStops.push(a.colorStops[0])),a.elevationStops.length<=t)return a;const y={elevationStops:[],colorStops:[]},T=(a.elevationStops.length-1)/(t-1);for(let S=0;S<a.elevationStops.length-.5;S+=T)y.elevationStops.push(a.elevationStops[Math.round(S)]),y.colorStops.push(a.colorStops[Math.round(S)]);return qn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),y}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,a,d){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const y=this._createColorRamp(a),T=new fa({width:y.colorStops.length,height:1}),S=new fa({width:y.colorStops.length,height:1});for(let A=0;A<y.elevationStops.length;A++){const k=Og(y.elevationStops[A],d);S.setPixel(0,A,new mn(k.r/255,k.g/255,k.b/255,1)),T.setPixel(0,A,y.colorStops[A])}return this.colorRampTextures={elevationTexture:new dm(t,S,t.gl.RGBA),colorTexture:new dm(t,T,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Xf=Ni([{name:"a_pos",components:2,type:"Int16"}],4),{members:ar}=Xf;function jg(l,t,a){const d=a.patternDependencies;let y=!1;for(const T of t){const S=T.paint.get(`${l}-pattern`);S.isConstant()||(y=!0);const A=S.constantOr(null);A&&(y=!0,d[A.to]=!0,d[A.from]=!0)}return y}function Bg(l,t,a,d,y){const T=y.patternDependencies;for(const S of t){const A=S.paint.get(`${l}-pattern`).value;if(A.kind!=="constant"){let k=A.evaluate({zoom:d-1},a,{},y.availableImages),N=A.evaluate({zoom:d},a,{},y.availableImages),O=A.evaluate({zoom:d+1},a,{},y.availableImages);k=k&&k.name?k.name:k,N=N&&N.name?N.name:N,O=O&&O.name?O.name:O,T[k]=!0,T[N]=!0,T[O]=!0,a.patterns[S.id]={min:k,mid:N,max:O}}}return a}function Fg(l,t,a,d,y){let T;if(y===function(S,A,k,N){let O=0;for(let F=A,$=k-N;F<k;F+=N)O+=(S[$]-S[F])*(S[F+1]+S[$+1]),$=F;return O}(l,t,a,d)>0)for(let S=t;S<a;S+=d)T=Gi(S/d|0,l[S],l[S+1],T);else for(let S=a-d;S>=t;S-=d)T=Gi(S/d|0,l[S],l[S+1],T);return T&&_u(T,T.next)&&(na(T),T=T.next),T}function Ho(l,t){if(!l)return l;t||(t=l);let a,d=l;do if(a=!1,d.steiner||!_u(d,d.next)&&An(d.prev,d,d.next)!==0)d=d.next;else{if(na(d),d=t=d.prev,d===d.next)break;a=!0}while(a||d!==t);return t}function po(l,t,a,d,y,T,S){if(!l)return;!S&&T&&function(k,N,O,F){let $=k;do $.z===0&&($.z=Qf($.x,$.y,N,O,F)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==k);$.prevZ.nextZ=null,$.prevZ=null,function(H){let W,J=1;do{let oe,fe=H;H=null;let ke=null;for(W=0;fe;){W++;let xe=fe,q=0;for(let we=0;we<J&&(q++,xe=xe.nextZ,xe);we++);let se=J;for(;q>0||se>0&&xe;)q!==0&&(se===0||!xe||fe.z<=xe.z)?(oe=fe,fe=fe.nextZ,q--):(oe=xe,xe=xe.nextZ,se--),ke?ke.nextZ=oe:H=oe,oe.prevZ=ke,ke=oe;fe=xe}ke.nextZ=null,J*=2}while(W>1)}($)}(l,d,y,T);let A=l;for(;l.prev!==l.next;){const k=l.prev,N=l.next;if(T?e0(l,d,y,T):J_(l))t.push(k.i,l.i,N.i),na(l),l=N.next,A=N.next;else if((l=N)===A){S?S===1?po(l=Wf(Ho(l),t),t,a,d,y,T,2):S===2&&Rl(l,t,a,d,y,T):po(Ho(l),t,a,d,y,T,1);break}}}function J_(l){const t=l.prev,a=l,d=l.next;if(An(t,a,d)>=0)return!1;const y=t.x,T=a.x,S=d.x,A=t.y,k=a.y,N=d.y,O=Math.min(y,T,S),F=Math.min(A,k,N),$=Math.max(y,T,S),H=Math.max(A,k,N);let W=d.next;for(;W!==t;){if(W.x>=O&&W.x<=$&&W.y>=F&&W.y<=H&&Nd(y,A,T,k,S,N,W.x,W.y)&&An(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function e0(l,t,a,d){const y=l.prev,T=l,S=l.next;if(An(y,T,S)>=0)return!1;const A=y.x,k=T.x,N=S.x,O=y.y,F=T.y,$=S.y,H=Math.min(A,k,N),W=Math.min(O,F,$),J=Math.max(A,k,N),oe=Math.max(O,F,$),fe=Qf(H,W,t,a,d),ke=Qf(J,oe,t,a,d);let xe=l.prevZ,q=l.nextZ;for(;xe&&xe.z>=fe&&q&&q.z<=ke;){if(xe.x>=H&&xe.x<=J&&xe.y>=W&&xe.y<=oe&&xe!==y&&xe!==S&&Nd(A,O,k,F,N,$,xe.x,xe.y)&&An(xe.prev,xe,xe.next)>=0||(xe=xe.prevZ,q.x>=H&&q.x<=J&&q.y>=W&&q.y<=oe&&q!==y&&q!==S&&Nd(A,O,k,F,N,$,q.x,q.y)&&An(q.prev,q,q.next)>=0))return!1;q=q.nextZ}for(;xe&&xe.z>=fe;){if(xe.x>=H&&xe.x<=J&&xe.y>=W&&xe.y<=oe&&xe!==y&&xe!==S&&Nd(A,O,k,F,N,$,xe.x,xe.y)&&An(xe.prev,xe,xe.next)>=0)return!1;xe=xe.prevZ}for(;q&&q.z<=ke;){if(q.x>=H&&q.x<=J&&q.y>=W&&q.y<=oe&&q!==y&&q!==S&&Nd(A,O,k,F,N,$,q.x,q.y)&&An(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function Wf(l,t){let a=l;do{const d=a.prev,y=a.next.next;!_u(d,y)&&Gg(d,a,a.next,y)&&Pd(d,y)&&Pd(y,d)&&(t.push(d.i,a.i,y.i),na(a),na(a.next),a=l=y),a=a.next}while(a!==l);return Ho(a)}function Rl(l,t,a,d,y,T){let S=l;do{let A=S.next.next;for(;A!==S.prev;){if(S.i!==A.i&&Mc(S,A)){let k=Zg(S,A);return S=Ho(S,S.next),k=Ho(k,k.next),po(S,t,a,d,y,T,0),void po(k,t,a,d,y,T,0)}A=A.next}S=S.next}while(S!==l)}function t0(l,t){let a=l.x-t.x;return a===0&&(a=l.y-t.y,a===0)&&(a=(l.next.y-l.y)/(l.next.x-l.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function Ug(l,t){const a=function(y,T){let S=T;const A=y.x,k=y.y;let N,O=-1/0;if(_u(y,S))return S;do{if(_u(y,S.next))return S.next;if(k<=S.y&&k>=S.next.y&&S.next.y!==S.y){const J=S.x+(k-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(J<=A&&J>O&&(O=J,N=S.x<S.next.x?S:S.next,J===A))return N}S=S.next}while(S!==T);if(!N)return null;const F=N,$=N.x,H=N.y;let W=1/0;S=N;do{if(A>=S.x&&S.x>=$&&A!==S.x&&Kf(k<H?A:O,k,$,H,k<H?O:A,k,S.x,S.y)){const J=Math.abs(k-S.y)/(A-S.x);Pd(S,y)&&(J<W||J===W&&(S.x>N.x||S.x===N.x&&n0(N,S)))&&(N=S,W=J)}S=S.next}while(S!==F);return N}(l,t);if(!a)return t;const d=Zg(a,l);return Ho(d,d.next),Ho(a,a.next)}function n0(l,t){return An(l.prev,l,t.prev)<0&&An(t.next,l,l.next)<0}function Qf(l,t,a,d,y){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-a)*y|0)|l<<8))|l<<4))|l<<2))|l<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-d)*y|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Vg(l){let t=l,a=l;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==l);return a}function Kf(l,t,a,d,y,T,S,A){return(y-S)*(t-A)>=(l-S)*(T-A)&&(l-S)*(d-A)>=(a-S)*(t-A)&&(a-S)*(T-A)>=(y-S)*(d-A)}function Nd(l,t,a,d,y,T,S,A){return!(l===S&&t===A)&&Kf(l,t,a,d,y,T,S,A)}function Mc(l,t){return l.next.i!==t.i&&l.prev.i!==t.i&&!function(a,d){let y=a;do{if(y.i!==a.i&&y.next.i!==a.i&&y.i!==d.i&&y.next.i!==d.i&&Gg(y,y.next,a,d))return!0;y=y.next}while(y!==a);return!1}(l,t)&&(Pd(l,t)&&Pd(t,l)&&function(a,d){let y=a,T=!1;const S=(a.x+d.x)/2,A=(a.y+d.y)/2;do y.y>A!=y.next.y>A&&y.next.y!==y.y&&S<(y.next.x-y.x)*(A-y.y)/(y.next.y-y.y)+y.x&&(T=!T),y=y.next;while(y!==a);return T}(l,t)&&(An(l.prev,l,t.prev)||An(l,t.prev,t))||_u(l,t)&&An(l.prev,l,l.next)>0&&An(t.prev,t,t.next)>0)}function An(l,t,a){return(t.y-l.y)*(a.x-t.x)-(t.x-l.x)*(a.y-t.y)}function _u(l,t){return l.x===t.x&&l.y===t.y}function Gg(l,t,a,d){const y=pm(An(l,t,a)),T=pm(An(l,t,d)),S=pm(An(a,d,l)),A=pm(An(a,d,t));return y!==T&&S!==A||!(y!==0||!Er(l,a,t))||!(T!==0||!Er(l,d,t))||!(S!==0||!Er(a,l,d))||!(A!==0||!Er(a,t,d))}function Er(l,t,a){return t.x<=Math.max(l.x,a.x)&&t.x>=Math.min(l.x,a.x)&&t.y<=Math.max(l.y,a.y)&&t.y>=Math.min(l.y,a.y)}function pm(l){return l>0?1:l<0?-1:0}function Pd(l,t){return An(l.prev,l,l.next)<0?An(l,t,l.next)>=0&&An(l,l.prev,t)>=0:An(l,t,l.prev)<0||An(l,l.next,t)<0}function Zg(l,t){const a=Xo(l.i,l.x,l.y),d=Xo(t.i,t.x,t.y),y=l.next,T=t.prev;return l.next=t,t.prev=l,a.next=y,y.prev=a,d.next=a,a.prev=d,T.next=d,d.prev=T,d}function Gi(l,t,a,d){const y=Xo(l,t,a);return d?(y.next=d.next,y.prev=d,d.next.prev=y,d.next=y):(y.prev=y,y.next=y),y}function na(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Xo(l,t,a){return{i:l,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Sh{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Jf{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Jf.noSubdivision=new Jf({fill:new Sh(0,0),line:new Sh(0,0),tile:new Sh(0,0),stencil:new Sh(0,0),circle:1}),zt("SubdivisionGranularityExpression",Sh),zt("SubdivisionGranularitySetting",Jf);const Ld=-32768,Eh=32767;class Is{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=wt/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|a+32768}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const d=0|Math.round(t),y=0|Math.round(a),T=this._getKey(d,y);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,S),this._vertexBuffer.push(d,y),S}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(y,T){const S=[];for(let A=0;A<T.length;A+=3){const k=T[A],N=T[A+1],O=T[A+2],F=y[2*k],$=y[2*k+1];(y[2*N]-F)*(y[2*O+1]-$)-(y[2*N+1]-$)*(y[2*O]-F)>0?(S.push(k),S.push(O),S.push(N)):(S.push(k),S.push(N),S.push(O))}return S}(this._vertexBuffer,t);const a=[],d=t.length;for(let y=0;y<d;y+=3){const T=[t[y+0],t[y+1],t[y+2]],S=[this._vertexBuffer[2*t[y+0]+0],this._vertexBuffer[2*t[y+0]+1],this._vertexBuffer[2*t[y+1]+0],this._vertexBuffer[2*t[y+1]+1],this._vertexBuffer[2*t[y+2]+0],this._vertexBuffer[2*t[y+2]+1]];let A=1/0,k=1/0,N=-1/0,O=-1/0;for(let J=0;J<3;J++){const oe=S[2*J],fe=S[2*J+1];A=Math.min(A,oe),N=Math.max(N,oe),k=Math.min(k,fe),O=Math.max(O,fe)}if(A===N||k===O)continue;const F=Math.floor(A/this._granularityCellSize),$=Math.ceil(N/this._granularityCellSize),H=Math.floor(k/this._granularityCellSize),W=Math.ceil(O/this._granularityCellSize);if(F!==$||H!==W)for(let J=H;J<W;J++){const oe=this._scanlineGenerateVertexRingForCellRow(J,S,T);Rs(this._vertexBuffer,oe,a)}else a.push(...T)}return a}_scanlineGenerateVertexRingForCellRow(t,a,d){const y=t*this._granularityCellSize,T=y+this._granularityCellSize,S=[];for(let A=0;A<3;A++){const k=a[2*A],N=a[2*A+1],O=a[2*(A+1)%6],F=a[(2*(A+1)+1)%6],$=a[2*(A+2)%6],H=a[(2*(A+2)+1)%6],W=O-k,J=F-N,oe=W===0,fe=J===0,ke=(y-N)/J,xe=(T-N)/J,q=Math.min(ke,xe),se=Math.max(ke,xe);if(!fe&&(q>=1||se<=0)||fe&&(N<y||N>T)){F>=y&&F<=T&&S.push(d[(A+1)%3]);continue}!fe&&q>0&&S.push(this._vertexToIndex(k+W*q,N+J*q));const we=k+W*Math.max(q,0),Ge=k+W*Math.min(se,1);oe||this._generateIntraEdgeVertices(S,k,N,O,F,we,Ge),!fe&&se<1&&S.push(this._vertexToIndex(k+W*se,N+J*se)),(fe||F>=y&&F<=T)&&S.push(d[(A+1)%3]),!fe&&(F<=y||F>=T)&&this._generateInterEdgeVertices(S,k,N,O,F,$,H,Ge,y,T)}return S}_generateIntraEdgeVertices(t,a,d,y,T,S,A){const k=y-a,N=T-d,O=N===0,F=O?Math.min(a,y):Math.min(S,A),$=O?Math.max(a,y):Math.max(S,A),H=Math.floor(F/this._granularityCellSize)+1,W=Math.ceil($/this._granularityCellSize)-1;if(O?a<y:S<A)for(let J=H;J<=W;J++){const oe=J*this._granularityCellSize;t.push(this._vertexToIndex(oe,d+N*(oe-a)/k))}else for(let J=W;J>=H;J--){const oe=J*this._granularityCellSize;t.push(this._vertexToIndex(oe,d+N*(oe-a)/k))}}_generateInterEdgeVertices(t,a,d,y,T,S,A,k,N,O){const F=T-d,$=S-y,H=A-T,W=(N-T)/H,J=(O-T)/H,oe=Math.min(W,J),fe=Math.max(W,J),ke=y+$*oe;let xe=Math.floor(Math.min(ke,k)/this._granularityCellSize)+1,q=Math.ceil(Math.max(ke,k)/this._granularityCellSize)-1,se=k<ke;const we=H===0;if(we&&(A===N||A===O))return;if(we||oe>=1||fe<=0){const ht=d-A,Qe=S+(a-S)*Math.min((N-A)/ht,(O-A)/ht);xe=Math.floor(Math.min(Qe,k)/this._granularityCellSize)+1,q=Math.ceil(Math.max(Qe,k)/this._granularityCellSize)-1,se=k<Qe}const Ge=F>0?O:N;if(se)for(let ht=xe;ht<=q;ht++)t.push(this._vertexToIndex(ht*this._granularityCellSize,Ge));else for(let ht=q;ht>=xe;ht--)t.push(this._vertexToIndex(ht*this._granularityCellSize,Ge))}_generateOutline(t){const a=[];for(const d of t){const y=vu(d,this._granularity,!0),T=this._pointArrayToIndices(y),S=[];for(let A=1;A<T.length;A++)S.push(T[A-1]),S.push(T[A]);a.push(S)}return a}_handlePoles(t){let a=!1,d=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(a||d)&&this._fillPoles(t,a,d)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const d=t[a+1];d===Ld&&(t[a+1]=-32767),d===Eh&&(t[a+1]=32766)}}_generatePoleQuad(t,a,d,y,T,S){y>T!=(S===Ld)?(t.push(a),t.push(d),t.push(this._vertexToIndex(y,S)),t.push(d),t.push(this._vertexToIndex(T,S)),t.push(this._vertexToIndex(y,S))):(t.push(d),t.push(a),t.push(this._vertexToIndex(y,S)),t.push(this._vertexToIndex(T,S)),t.push(d),t.push(this._vertexToIndex(y,S)))}_fillPoles(t,a,d){const y=this._vertexBuffer,T=wt,S=t.length;for(let A=2;A<S;A+=3){const k=t[A-2],N=t[A-1],O=t[A],F=y[2*k],$=y[2*k+1],H=y[2*N],W=y[2*N+1],J=y[2*O],oe=y[2*O+1];a&&($===0&&W===0&&this._generatePoleQuad(t,k,N,F,H,Ld),W===0&&oe===0&&this._generatePoleQuad(t,N,O,H,J,Ld),oe===0&&$===0&&this._generatePoleQuad(t,O,k,J,F,Ld)),d&&($===T&&W===T&&this._generatePoleQuad(t,k,N,F,H,Eh),W===T&&oe===T&&this._generatePoleQuad(t,N,O,H,J,Eh),oe===T&&$===T&&this._generatePoleQuad(t,O,k,J,F,Eh))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:d,holeIndices:y}=function(A){const k=[],N=[];for(const O of A)if(O.length!==0){O!==A[0]&&k.push(N.length/2);for(let F=0;F<O.length;F++)N.push(O[F].x),N.push(O[F].y)}return{flattened:N,holeIndices:k}}(t);let T;this._initializeVertices(d);try{const A=function(N,O,F=2){const $=O&&O.length,H=$?O[0]*F:N.length;let W=Fg(N,0,H,F,!0);const J=[];if(!W||W.next===W.prev)return J;let oe,fe,ke;if($&&(W=function(xe,q,se,we){const Ge=[];for(let ht=0,Qe=q.length;ht<Qe;ht++){const it=Fg(xe,q[ht]*we,ht<Qe-1?q[ht+1]*we:xe.length,we,!1);it===it.next&&(it.steiner=!0),Ge.push(Vg(it))}Ge.sort(t0);for(let ht=0;ht<Ge.length;ht++)se=Ug(Ge[ht],se);return se}(N,O,W,F)),N.length>80*F){oe=1/0,fe=1/0;let xe=-1/0,q=-1/0;for(let se=F;se<H;se+=F){const we=N[se],Ge=N[se+1];we<oe&&(oe=we),Ge<fe&&(fe=Ge),we>xe&&(xe=we),Ge>q&&(q=Ge)}ke=Math.max(xe-oe,q-fe),ke=ke!==0?32767/ke:0}return po(W,J,F,oe,fe,ke,0),J}(d,y),k=this._convertIndices(d,A);T=this._subdivideTrianglesScanline(k)}catch(A){console.error(A)}let S=[];return a&&(S=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:S}}_convertIndices(t,a){const d=[];for(let y=0;y<a.length;y++)d.push(this._vertexToIndex(t[2*a[y]],t[2*a[y]+1]));return d}_pointArrayToIndices(t){const a=[];for(let d=0;d<t.length;d++){const y=t[d];a.push(this._vertexToIndex(y.x,y.y))}return a}}function mo(l,t,a,d=!0){return new Is(a,t).subdividePolygonInternal(l,d)}function vu(l,t,a=!1){if(!l||l.length<1)return[];if(l.length<2)return[];const d=l[0],y=l[l.length-1],T=a&&(d.x!==y.x||d.y!==y.y);if(t<2)return T?[...l,l[0]]:[...l];const S=Math.floor(wt/t),A=[];A.push(new ne(l[0].x,l[0].y));const k=l.length,N=T?k:k-1;for(let O=0;O<N;O++){const F=l[O],$=O<k-1?l[O+1]:l[0],H=F.x,W=F.y,J=$.x,oe=$.y,fe=H!==J,ke=W!==oe;if(!fe&&!ke)continue;const xe=J-H,q=oe-W,se=Math.abs(xe),we=Math.abs(q);let Ge=H,ht=W;for(;;){const it=xe>0?(Math.floor(Ge/S)+1)*S:(Math.ceil(Ge/S)-1)*S,bt=q>0?(Math.floor(ht/S)+1)*S:(Math.ceil(ht/S)-1)*S,pt=Math.abs(Ge-it),Tt=Math.abs(ht-bt),at=Math.abs(Ge-J),Ft=Math.abs(ht-oe),Yt=fe?pt/se:Number.POSITIVE_INFINITY,Vt=ke?Tt/we:Number.POSITIVE_INFINITY;if((at<=pt||!fe)&&(Ft<=Tt||!ke))break;if(Yt<Vt&&fe||!ke){Ge=it,ht+=q*Yt;const jt=new ne(Ge,Math.round(ht));A[A.length-1].x===jt.x&&A[A.length-1].y===jt.y||A.push(jt)}else{Ge+=xe*Vt,ht=bt;const jt=new ne(Math.round(Ge),ht);A[A.length-1].x===jt.x&&A[A.length-1].y===jt.y||A.push(jt)}}const Qe=new ne(J,oe);A[A.length-1].x===Qe.x&&A[A.length-1].y===Qe.y||A.push(Qe)}return A}function Rs(l,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,y=l[2*t[0]];for(let k=1;k<t.length;k++){const N=l[2*t[k]];N<y&&(y=N,d=k)}const T=t.length;let S=d,A=(S+1)%T;for(;;){const k=S-1>=0?S-1:T-1,N=(A+1)%T,O=l[2*t[k]],F=l[2*t[N]],$=l[2*t[S]],H=l[2*t[S]+1],W=l[2*t[A]+1];let J=!1;if(O<F)J=!0;else if(O>F)J=!1;else{const oe=W-H,fe=-(l[2*t[A]]-$),ke=H<W?1:-1;((O-$)*oe+(l[2*t[k]+1]-H)*fe)*ke>((F-$)*oe+(l[2*t[N]+1]-H)*fe)*ke&&(J=!0)}if(J){const oe=t[k],fe=t[S],ke=t[A];oe!==fe&&oe!==ke&&fe!==ke&&a.push(ke,fe,oe),S--,S<0&&(S=T-1)}else{const oe=t[N],fe=t[S],ke=t[A];oe!==fe&&oe!==ke&&fe!==ke&&a.push(ke,fe,oe),A++,A>=T&&(A=0)}if(k===N)break}}function $g(l,t,a,d,y,T,S,A,k){const N=y.length/2,O=S&&A&&k;if(N<Rn.MAX_VERTEX_ARRAY_LENGTH){const F=t.prepareSegment(N,a,d),$=F.vertexLength;for(let J=0;J<T.length;J+=3)d.emplaceBack($+T[J],$+T[J+1],$+T[J+2]);let H,W;F.vertexLength+=N,F.primitiveLength+=T.length/3,O&&(W=S.prepareSegment(N,a,A),H=W.vertexLength,W.vertexLength+=N);for(let J=0;J<y.length;J+=2)l(y[J],y[J+1]);if(O)for(let J=0;J<k.length;J++){const oe=k[J];for(let fe=1;fe<oe.length;fe+=2)A.emplaceBack(H+oe[fe-1],H+oe[fe]);W.primitiveLength+=oe.length/2}}else(function(F,$,H,W,J,oe){const fe=[];for(let we=0;we<W.length/2;we++)fe.push(-1);const ke={count:0};let xe=0,q=F.getOrCreateLatestSegment($,H),se=q.vertexLength;for(let we=2;we<J.length;we+=3){const Ge=J[we-2],ht=J[we-1],Qe=J[we];let it=fe[Ge]<xe,bt=fe[ht]<xe,pt=fe[Qe]<xe;q.vertexLength+((it?1:0)+(bt?1:0)+(pt?1:0))>Rn.MAX_VERTEX_ARRAY_LENGTH&&(q=F.createNewSegment($,H),xe=ke.count,it=!0,bt=!0,pt=!0,se=0);const Tt=go(fe,W,oe,ke,Ge,it,q),at=go(fe,W,oe,ke,ht,bt,q),Ft=go(fe,W,oe,ke,Qe,pt,q);H.emplaceBack(se+Tt-xe,se+at-xe,se+Ft-xe),q.primitiveLength++}})(t,a,d,y,T,l),O&&function(F,$,H,W,J,oe){const fe=[];for(let we=0;we<W.length/2;we++)fe.push(-1);const ke={count:0};let xe=0,q=F.getOrCreateLatestSegment($,H),se=q.vertexLength;for(let we=0;we<J.length;we++){const Ge=J[we];for(let ht=1;ht<J[we].length;ht+=2){const Qe=Ge[ht-1],it=Ge[ht];let bt=fe[Qe]<xe,pt=fe[it]<xe;q.vertexLength+((bt?1:0)+(pt?1:0))>Rn.MAX_VERTEX_ARRAY_LENGTH&&(q=F.createNewSegment($,H),xe=ke.count,bt=!0,pt=!0,se=0);const Tt=go(fe,W,oe,ke,Qe,bt,q),at=go(fe,W,oe,ke,it,pt,q);H.emplaceBack(se+Tt-xe,se+at-xe),q.primitiveLength++}}}(S,a,A,y,k,l),t.forceNewSegmentOnNextPrepare(),S==null||S.forceNewSegmentOnNextPrepare()}function go(l,t,a,d,y,T,S){if(T){const A=d.count;return a(t[2*y],t[2*y+1]),l[y]=d.count,d.count++,S.vertexLength++,A}return l[y]}class Cc{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new We,this.indexArray=new ni,this.indexArray2=new ii,this.programConfigurations=new da(t.layers,t.zoom),this.segments=new Rn,this.segments2=new Rn,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,d){this.hasPattern=jg("fill",this.layers,a);const y=this.layers[0].layout.get("fill-sort-key"),T=!y.isConstant(),S=[];for(const{feature:A,id:k,index:N,sourceLayerIndex:O}of t){const F=this.layers[0]._featureFilter.needGeometry,$=yu(A,F);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{globalState:this.globalState}),$,d))continue;const H=T?y.evaluate($,{},d,a.availableImages):void 0,W={id:k,properties:A.properties,type:A.type,sourceLayerIndex:O,index:N,geometry:F?$.geometry:Ec(A),patterns:{},sortKey:H};S.push(W)}T&&S.sort((A,k)=>A.sortKey-k.sortKey);for(const A of S){const{geometry:k,index:N,sourceLayerIndex:O}=A;if(this.hasPattern){const F=Bg("fill",this.layers,A,this.zoom,a);this.patternFeatures.push(F)}else this.addFeature(A,k,N,d,{},a.subdivisionGranularity);a.featureIndex.insert(t[N].feature,k,N,O,this.index)}}update(t,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,d)}addFeatures(t,a,d){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ar),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,d,y,T,S){for(const A of pd(a,500)){const k=mo(A,y,S.fill.getGranularityForZoomLevel(y.z)),N=this.layoutVertexArray;$g((O,F)=>{N.emplaceBack(O,F)},this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles,this.segments2,this.indexArray2,k.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,y)}}let Dc,mm;zt("FillBucket",Cc,{omit:["layers","patternFeatures"]});var Yg={get paint(){return mm=mm||new Vr({"fill-antialias":new Ot(Ae.paint_fill["fill-antialias"]),"fill-opacity":new Zt(Ae.paint_fill["fill-opacity"]),"fill-color":new Zt(Ae.paint_fill["fill-color"]),"fill-outline-color":new Zt(Ae.paint_fill["fill-outline-color"]),"fill-translate":new Ot(Ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Ot(Ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new Dd(Ae.paint_fill["fill-pattern"])})},get layout(){return Dc=Dc||new Vr({"fill-sort-key":new Zt(Ae.layout_fill["fill-sort-key"])})}};class zl extends zr{constructor(t){super(t,Yg)}recalculate(t,a){super.recalculate(t,a);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Cc(t)}queryRadius(){return Gf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:d,pixelsToTileUnits:y}){return kg(Zf(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,y),a)}isTileClipped(){return!0}}const i0=Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Od=Ni([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ep}=i0;var Ah,Mh,gm,qg,Ch,Hg,tp,np={};function r0(){if(Mh)return Ah;Mh=1;var l=B();function t(y,T,S,A,k){this.properties={},this.extent=S,this.type=0,this._pbf=y,this._geometry=-1,this._keys=A,this._values=k,y.readFields(a,this,T)}function a(y,T,S){y==1?T.id=S.readVarint():y==2?function(A,k){for(var N=A.readVarint()+A.pos;A.pos<N;){var O=k._keys[A.readVarint()],F=k._values[A.readVarint()];k.properties[O]=F}}(S,T):y==3?T.type=S.readVarint():y==4&&(T._geometry=S.pos)}function d(y){for(var T,S,A=0,k=0,N=y.length,O=N-1;k<N;O=k++)A+=((S=y[O]).x-(T=y[k]).x)*(T.y+S.y);return A}return Ah=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var T,S=y.readVarint()+y.pos,A=1,k=0,N=0,O=0,F=[];y.pos<S;){if(k<=0){var $=y.readVarint();A=7&$,k=$>>3}if(k--,A===1||A===2)N+=y.readSVarint(),O+=y.readSVarint(),A===1&&(T&&F.push(T),T=[]),T.push(new l(N,O));else{if(A!==7)throw new Error("unknown command "+A);T&&T.push(T[0].clone())}}return T&&F.push(T),F},t.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var T=y.readVarint()+y.pos,S=1,A=0,k=0,N=0,O=1/0,F=-1/0,$=1/0,H=-1/0;y.pos<T;){if(A<=0){var W=y.readVarint();S=7&W,A=W>>3}if(A--,S===1||S===2)(k+=y.readSVarint())<O&&(O=k),k>F&&(F=k),(N+=y.readSVarint())<$&&($=N),N>H&&(H=N);else if(S!==7)throw new Error("unknown command "+S)}return[O,$,F,H]},t.prototype.toGeoJSON=function(y,T,S){var A,k,N=this.extent*Math.pow(2,S),O=this.extent*y,F=this.extent*T,$=this.loadGeometry(),H=t.types[this.type];function W(fe){for(var ke=0;ke<fe.length;ke++){var xe=fe[ke];fe[ke]=[360*(xe.x+O)/N-180,360/Math.PI*Math.atan(Math.exp((180-360*(xe.y+F)/N)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(A=0;A<$.length;A++)J[A]=$[A][0];W($=J);break;case 2:for(A=0;A<$.length;A++)W($[A]);break;case 3:for($=function(fe){var ke=fe.length;if(ke<=1)return[fe];for(var xe,q,se=[],we=0;we<ke;we++){var Ge=d(fe[we]);Ge!==0&&(q===void 0&&(q=Ge<0),q===Ge<0?(xe&&se.push(xe),xe=[fe[we]]):xe.push(fe[we]))}return xe&&se.push(xe),se}($),A=0;A<$.length;A++)for(k=0;k<$[A].length;k++)W($[A][k])}$.length===1?$=$[0]:H="Multi"+H;var oe={type:"Feature",geometry:{type:H,coordinates:$},properties:this.properties};return"id"in this&&(oe.id=this.id),oe},Ah}function a0(){if(qg)return gm;qg=1;var l=r0();function t(d,y){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(a,this,y),this.length=this._features.length}function a(d,y,T){d===15?y.version=T.readVarint():d===1?y.name=T.readString():d===5?y.extent=T.readVarint():d===2?y._features.push(T.pos):d===3?y._keys.push(T.readString()):d===4&&y._values.push(function(S){for(var A=null,k=S.readVarint()+S.pos;S.pos<k;){var N=S.readVarint()>>3;A=N===1?S.readString():N===2?S.readFloat():N===3?S.readDouble():N===4?S.readVarint64():N===5?S.readVarint():N===6?S.readSVarint():N===7?S.readBoolean():null}return A}(T))}return gm=t,t.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var y=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,y,this.extent,this._keys,this._values)},gm}function hi(){return tp||(tp=1,np.VectorTile=function(){if(Hg)return Ch;Hg=1;var l=a0();function t(a,d,y){if(a===3){var T=new l(y,y.readVarint()+y.pos);T.length&&(d[T.name]=T)}}return Ch=function(a,d){this.layers=a.readFields(t,{},d)},Ch}(),np.VectorTileFeature=r0(),np.VectorTileLayer=a0()),np}var di=D(hi());const Bn=di.VectorTileFeature.types,$n=Math.pow(2,13);function Kn(l,t,a,d,y,T,S,A){l.emplaceBack(t,a,2*Math.floor(d*$n)+S,y*$n*2,T*$n*2,Math.round(A))}class Ga{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ct,this.centroidVertexArray=new Fe,this.indexArray=new ni,this.programConfigurations=new da(t.layers,t.zoom),this.segments=new Rn,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,d){this.features=[],this.hasPattern=jg("fill-extrusion",this.layers,a);for(const{feature:y,id:T,index:S,sourceLayerIndex:A}of t){const k=this.layers[0]._featureFilter.needGeometry,N=yu(y,k);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{globalState:this.globalState}),N,d))continue;const O={id:T,sourceLayerIndex:A,index:S,geometry:k?N.geometry:Ec(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(Bg("fill-extrusion",this.layers,O,this.zoom,a)):this.addFeature(O,O.geometry,S,d,{},a.subdivisionGranularity),a.featureIndex.insert(y,O.geometry,S,A,this.index,!0)}}addFeatures(t,a,d){for(const y of this.features){const{geometry:T}=y;this.addFeature(y,T,y.index,a,d,t.subdivisionGranularity)}}update(t,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ep),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Od.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,d,y,T,S){for(const A of pd(a,500)){const k={x:0,y:0,sampleCount:0},N=this.layoutVertexArray.length;this.processPolygon(k,y,t,A,S);const O=this.layoutVertexArray.length-N,F=Math.floor(k.x/k.sampleCount),$=Math.floor(k.y/k.sampleCount);for(let H=0;H<O;H++)this.centroidVertexArray.emplaceBack(F,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,y)}processPolygon(t,a,d,y,T){if(y.length<1||ym(y[0]))return;for(const F of y)F.length!==0&&xu(t,F);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=T.fill.getGranularityForZoomLevel(a.z),k=Bn[d.type]==="Polygon";for(const F of y){if(F.length===0||ym(F))continue;const $=vu(F,A,k);this._generateSideFaces($,S)}if(!k)return;const N=mo(y,a,A,!1),O=this.layoutVertexArray;$g((F,$)=>{Kn(O,F,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,N.verticesFlattened,N.indicesTriangles)}_generateSideFaces(t,a){let d=0;for(let y=1;y<t.length;y++){const T=t[y],S=t[y-1];if(jd(T,S))continue;a.segment.vertexLength+4>Rn.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=T.sub(S)._perp()._unit(),k=S.dist(T);d+k>32768&&(d=0),Kn(this.layoutVertexArray,T.x,T.y,A.x,A.y,0,0,d),Kn(this.layoutVertexArray,T.x,T.y,A.x,A.y,0,1,d),d+=k,Kn(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,0,d),Kn(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,1,d);const N=a.segment.vertexLength;this.indexArray.emplaceBack(N,N+2,N+1),this.indexArray.emplaceBack(N+1,N+2,N+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function xu(l,t){for(let a=0;a<t.length;a++){const d=t[a];a===t.length-1&&t[0].x===d.x&&t[0].y===d.y||(l.x+=d.x,l.y+=d.y,l.sampleCount++)}}function jd(l,t){return l.x===t.x&&(l.x<0||l.x>wt)||l.y===t.y&&(l.y<0||l.y>wt)}function ym(l){return l.every(t=>t.x<0)||l.every(t=>t.x>wt)||l.every(t=>t.y<0)||l.every(t=>t.y>wt)}let Nl;zt("FillExtrusionBucket",Ga,{omit:["layers","features"]});var _r={get paint(){return Nl=Nl||new Vr({"fill-extrusion-opacity":new Ot(Ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ot(Ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ot(Ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Dd(Ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ot(Ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class bu extends zr{constructor(t){super(t,_r)}createBucket(t){return new Ga(t)}queryRadius(){return Gf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:d,geometry:y,transform:T,pixelsToTileUnits:S,pixelPosMatrix:A}){const k=Zf(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,S),N=this.paint.get("fill-extrusion-height").evaluate(a,d),O=this.paint.get("fill-extrusion-base").evaluate(a,d),F=function(H,W){const J=[];for(const oe of H){const fe=[oe.x,oe.y,0,1];gt(fe,fe,W),J.push(new ne(fe[0]/fe[3],fe[1]/fe[3]))}return J}(k,A),$=function(H,W,J,oe){const fe=[],ke=[],xe=oe[8]*W,q=oe[9]*W,se=oe[10]*W,we=oe[11]*W,Ge=oe[8]*J,ht=oe[9]*J,Qe=oe[10]*J,it=oe[11]*J;for(const bt of H){const pt=[],Tt=[];for(const at of bt){const Ft=at.x,Yt=at.y,Vt=oe[0]*Ft+oe[4]*Yt+oe[12],jt=oe[1]*Ft+oe[5]*Yt+oe[13],pn=oe[2]*Ft+oe[6]*Yt+oe[14],xi=oe[3]*Ft+oe[7]*Yt+oe[15],Zi=pn+se,$i=xi+we,Ns=Vt+Ge,ba=jt+ht,or=pn+Qe,Fi=xi+it,Ar=new ne((Vt+xe)/$i,(jt+q)/$i);Ar.z=Zi/$i,pt.push(Ar);const vr=new ne(Ns/Fi,ba/Fi);vr.z=or/Fi,Tt.push(vr)}fe.push(pt),ke.push(Tt)}return[fe,ke]}(y,O,N,A);return function(H,W,J){let oe=1/0;kg(J,W)&&(oe=_m(J,W[0]));for(let fe=0;fe<W.length;fe++){const ke=W[fe],xe=H[fe];for(let q=0;q<ke.length-1;q++){const se=ke[q],we=[se,ke[q+1],xe[q+1],xe[q],se];Dg(J,we)&&(oe=Math.min(oe,_m(J,we)))}}return oe!==1/0&&oe}($[0],$[1],F)}}function Wo(l,t){return l.x*t.x+l.y*t.y}function _m(l,t){if(l.length===1){let a=0;const d=t[a++];let y;for(;!y||d.equals(y);)if(y=t[a++],!y)return 1/0;for(;a<t.length;a++){const T=t[a],S=l[0],A=y.sub(d),k=T.sub(d),N=S.sub(d),O=Wo(A,A),F=Wo(A,k),$=Wo(k,k),H=Wo(N,A),W=Wo(N,k),J=O*$-F*F,oe=($*H-F*W)/J,fe=(O*W-F*H)/J,ke=d.z*(1-oe-fe)+y.z*oe+T.z*fe;if(isFinite(ke))return ke}return 1/0}{let a=1/0;for(const d of t)a=Math.min(a,d.z);return a}}const yo=Ni([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Bd}=yo,ip=Ni([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:ls}=ip,Xg=di.VectorTileFeature.types,Wg=Math.cos(Math.PI/180*37.5),rp=Math.pow(2,14)/.5;class Fd{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Et,this.layoutVertexArray2=new ft,this.indexArray=new ni,this.programConfigurations=new da(t.layers,t.zoom),this.segments=new Rn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,d){this.hasPattern=jg("line",this.layers,a);const y=this.layers[0].layout.get("line-sort-key"),T=!y.isConstant(),S=[];for(const{feature:A,id:k,index:N,sourceLayerIndex:O}of t){const F=this.layers[0]._featureFilter.needGeometry,$=yu(A,F);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{globalState:this.globalState}),$,d))continue;const H=T?y.evaluate($,{},d):void 0,W={id:k,properties:A.properties,type:A.type,sourceLayerIndex:O,index:N,geometry:F?$.geometry:Ec(A),patterns:{},sortKey:H};S.push(W)}T&&S.sort((A,k)=>A.sortKey-k.sortKey);for(const A of S){const{geometry:k,index:N,sourceLayerIndex:O}=A;if(this.hasPattern){const F=Bg("line",this.layers,A,this.zoom,a);this.patternFeatures.push(F)}else this.addFeature(A,k,N,d,{},a.subdivisionGranularity);a.featureIndex.insert(t[N].feature,k,N,O,this.index)}}update(t,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,d)}addFeatures(t,a,d){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,ls)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,d,y,T,S){const A=this.layers[0].layout,k=A.get("line-join").evaluate(t,{}),N=A.get("line-cap"),O=A.get("line-miter-limit"),F=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const $ of a)this.addLine($,t,k,N,O,F,y,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,y)}addLine(t,a,d,y,T,S,A,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=vu(t,A?k.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let xe=0;xe<t.length-1;xe++)this.totalDistance+=t[xe].dist(t[xe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const N=Xg[a.type]==="Polygon";let O=t.length;for(;O>=2&&t[O-1].equals(t[O-2]);)O--;let F=0;for(;F<O-1&&t[F].equals(t[F+1]);)F++;if(O<(N?3:2))return;d==="bevel"&&(T=1.05);const $=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let W,J,oe,fe,ke;this.e1=this.e2=-1,N&&(W=t[O-2],ke=t[F].sub(W)._unit()._perp());for(let xe=F;xe<O;xe++){if(oe=xe===O-1?N?t[F+1]:void 0:t[xe+1],oe&&t[xe].equals(oe))continue;ke&&(fe=ke),W&&(J=W),W=t[xe],ke=oe?oe.sub(W)._unit()._perp():fe,fe=fe||ke;let q=fe.add(ke);q.x===0&&q.y===0||q._unit();const se=fe.x*ke.x+fe.y*ke.y,we=q.x*ke.x+q.y*ke.y,Ge=we!==0?1/we:1/0,ht=2*Math.sqrt(2-2*we),Qe=we<Wg&&J&&oe,it=fe.x*ke.y-fe.y*ke.x>0;if(Qe&&xe>F){const Tt=W.dist(J);if(Tt>2*$){const at=W.sub(W.sub(J)._mult($/Tt)._round());this.updateDistance(J,at),this.addCurrentVertex(at,fe,0,0,H),J=at}}const bt=J&&oe;let pt=bt?d:N?"butt":y;if(bt&&pt==="round"&&(Ge<S?pt="miter":Ge<=2&&(pt="fakeround")),pt==="miter"&&Ge>T&&(pt="bevel"),pt==="bevel"&&(Ge>2&&(pt="flipbevel"),Ge<T&&(pt="miter")),J&&this.updateDistance(J,W),pt==="miter")q._mult(Ge),this.addCurrentVertex(W,q,0,0,H);else if(pt==="flipbevel"){if(Ge>100)q=ke.mult(-1);else{const Tt=Ge*fe.add(ke).mag()/fe.sub(ke).mag();q._perp()._mult(Tt*(it?-1:1))}this.addCurrentVertex(W,q,0,0,H),this.addCurrentVertex(W,q.mult(-1),0,0,H)}else if(pt==="bevel"||pt==="fakeround"){const Tt=-Math.sqrt(Ge*Ge-1),at=it?Tt:0,Ft=it?0:Tt;if(J&&this.addCurrentVertex(W,fe,at,Ft,H),pt==="fakeround"){const Yt=Math.round(180*ht/Math.PI/20);for(let Vt=1;Vt<Yt;Vt++){let jt=Vt/Yt;if(jt!==.5){const xi=jt-.5;jt+=jt*xi*(jt-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*xi*xi+(.848013+se*(.215638*se-1.06021)))}const pn=ke.sub(fe)._mult(jt)._add(fe)._unit()._mult(it?-1:1);this.addHalfVertex(W,pn.x,pn.y,!1,it,0,H)}}oe&&this.addCurrentVertex(W,ke,-at,-Ft,H)}else if(pt==="butt")this.addCurrentVertex(W,q,0,0,H);else if(pt==="square"){const Tt=J?1:-1;this.addCurrentVertex(W,q,Tt,Tt,H)}else pt==="round"&&(J&&(this.addCurrentVertex(W,fe,0,0,H),this.addCurrentVertex(W,fe,1,1,H,!0)),oe&&(this.addCurrentVertex(W,ke,-1,-1,H,!0),this.addCurrentVertex(W,ke,0,0,H)));if(Qe&&xe<O-1){const Tt=W.dist(oe);if(Tt>2*$){const at=W.add(oe.sub(W)._mult($/Tt)._round());this.updateDistance(W,at),this.addCurrentVertex(at,ke,0,0,H),W=at}}}}addCurrentVertex(t,a,d,y,T,S=!1){const A=a.y*y-a.x,k=-a.y-a.x*y;this.addHalfVertex(t,a.x+a.y*d,a.y-a.x*d,S,!1,d,T),this.addHalfVertex(t,A,k,S,!0,-y,T),this.distance>rp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,d,y,T,S))}addHalfVertex({x:t,y:a},d,y,T,S,A,k){const N=.5*(this.lineClips?this.scaledDistance*(rp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(T?1:0),(a<<1)+(S?1:0),Math.round(63*d)+128,Math.round(63*y)+128,1+(A===0?0:A<0?-1:1)|(63&N)<<2,N>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,O,this.e2),k.primitiveLength++),S?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let kc,ia;zt("LineBucket",Fd,{omit:["layers","patternFeatures"]});var Ic={get paint(){return ia=ia||new Vr({"line-opacity":new Zt(Ae.paint_line["line-opacity"]),"line-color":new Zt(Ae.paint_line["line-color"]),"line-translate":new Ot(Ae.paint_line["line-translate"]),"line-translate-anchor":new Ot(Ae.paint_line["line-translate-anchor"]),"line-width":new Zt(Ae.paint_line["line-width"]),"line-gap-width":new Zt(Ae.paint_line["line-gap-width"]),"line-offset":new Zt(Ae.paint_line["line-offset"]),"line-blur":new Zt(Ae.paint_line["line-blur"]),"line-dasharray":new Ui(Ae.paint_line["line-dasharray"]),"line-pattern":new Dd(Ae.paint_line["line-pattern"]),"line-gradient":new vc(Ae.paint_line["line-gradient"])})},get layout(){return kc=kc||new Vr({"line-cap":new Ot(Ae.layout_line["line-cap"]),"line-join":new Zt(Ae.layout_line["line-join"]),"line-miter-limit":new Ot(Ae.layout_line["line-miter-limit"]),"line-round-limit":new Ot(Ae.layout_line["line-round-limit"]),"line-sort-key":new Zt(Ae.layout_line["line-sort-key"])})}};class Ud extends Zt{possiblyEvaluate(t,a){return a=new pi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,d,y){return a=Hi({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,d,y)}}let Rc;class Qg extends zr{constructor(t){super(t,Ic),this.gradientVersion=0,Rc||(Rc=new Ud(Ic.paint.properties["line-width"].specification),Rc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(d){return d._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Kc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=Rc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Fd(t)}queryRadius(t){const a=t,d=vm(Sr("line-width",this,a),Sr("line-gap-width",this,a)),y=Sr("line-offset",this,a);return d/2+Math.abs(y)+Gf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:d,geometry:y,transform:T,pixelsToTileUnits:S}){const A=Zf(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,S),k=S/2*vm(this.paint.get("line-width").evaluate(a,d),this.paint.get("line-gap-width").evaluate(a,d)),N=this.paint.get("line-offset").evaluate(a,d);return N&&(y=function(O,F){const $=[];for(let H=0;H<O.length;H++){const W=O[H],J=[];for(let oe=0;oe<W.length;oe++){const fe=W[oe-1],ke=W[oe],xe=W[oe+1],q=oe===0?new ne(0,0):ke.sub(fe)._unit()._perp(),se=oe===W.length-1?new ne(0,0):xe.sub(ke)._unit()._perp(),we=q._add(se)._unit(),Ge=we.x*se.x+we.y*se.y;Ge!==0&&we._mult(1/Ge),J.push(we._mult(F)._add(ke))}$.push(J)}return $}(y,N*S)),function(O,F,$){for(let H=0;H<F.length;H++){const W=F[H];if(O.length>=3){for(let J=0;J<W.length;J++)if(Th(O,W[J]))return!0}if(rm(O,W,$))return!0}return!1}(A,y,k)}isTileClipped(){return!0}}function vm(l,t){return t>0?t+2*l:l}const s0=Ni([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ap=Ni([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ni([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Kg=Ni([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ni([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cs=Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),o0=Ni([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zs(l,t,a){return l.sections.forEach(d=>{d.text=function(y,T,S){const A=T.layout.get("text-transform").evaluate(S,{});return A==="uppercase"?y=y.toLocaleUpperCase():A==="lowercase"&&(y=y.toLocaleLowerCase()),uo.applyArabicShaping&&(y=uo.applyArabicShaping(y)),y}(d.text,t,a)}),l}Ni([{name:"triangle",components:3,type:"Uint16"}]),Ni([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ni([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ni([{type:"Float32",name:"offsetX"}]),Ni([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ni([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Vd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Jg,ey,zc,sr=24,sp={};function Gd(){return Jg||(Jg=1,sp.read=function(l,t,a,d,y){var T,S,A=8*y-d-1,k=(1<<A)-1,N=k>>1,O=-7,F=a?y-1:0,$=a?-1:1,H=l[t+F];for(F+=$,T=H&(1<<-O)-1,H>>=-O,O+=A;O>0;T=256*T+l[t+F],F+=$,O-=8);for(S=T&(1<<-O)-1,T>>=-O,O+=d;O>0;S=256*S+l[t+F],F+=$,O-=8);if(T===0)T=1-N;else{if(T===k)return S?NaN:1/0*(H?-1:1);S+=Math.pow(2,d),T-=N}return(H?-1:1)*S*Math.pow(2,T-d)},sp.write=function(l,t,a,d,y,T){var S,A,k,N=8*T-y-1,O=(1<<N)-1,F=O>>1,$=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=d?0:T-1,W=d?1:-1,J=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(A=isNaN(t)?1:0,S=O):(S=Math.floor(Math.log(t)/Math.LN2),t*(k=Math.pow(2,-S))<1&&(S--,k*=2),(t+=S+F>=1?$/k:$*Math.pow(2,1-F))*k>=2&&(S++,k/=2),S+F>=O?(A=0,S=O):S+F>=1?(A=(t*k-1)*Math.pow(2,y),S+=F):(A=t*Math.pow(2,F-1)*Math.pow(2,y),S=0));y>=8;l[a+H]=255&A,H+=W,A/=256,y-=8);for(S=S<<y|A,N+=y;N>0;l[a+H]=255&S,H+=W,S/=256,N-=8);l[a+H-W]|=128*J}),sp}function ty(){if(zc)return ey;zc=1,ey=t;var l=Gd();function t(q){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(q)?q:new Uint8Array(q||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var a=4294967296,d=1/a,y=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function T(q){return q.type===t.Bytes?q.readVarint()+q.pos:q.pos+1}function S(q,se,we){return we?4294967296*se+(q>>>0):4294967296*(se>>>0)+(q>>>0)}function A(q,se,we){var Ge=se<=16383?1:se<=2097151?2:se<=268435455?3:Math.floor(Math.log(se)/(7*Math.LN2));we.realloc(Ge);for(var ht=we.pos-1;ht>=q;ht--)we.buf[ht+Ge]=we.buf[ht]}function k(q,se){for(var we=0;we<q.length;we++)se.writeVarint(q[we])}function N(q,se){for(var we=0;we<q.length;we++)se.writeSVarint(q[we])}function O(q,se){for(var we=0;we<q.length;we++)se.writeFloat(q[we])}function F(q,se){for(var we=0;we<q.length;we++)se.writeDouble(q[we])}function $(q,se){for(var we=0;we<q.length;we++)se.writeBoolean(q[we])}function H(q,se){for(var we=0;we<q.length;we++)se.writeFixed32(q[we])}function W(q,se){for(var we=0;we<q.length;we++)se.writeSFixed32(q[we])}function J(q,se){for(var we=0;we<q.length;we++)se.writeFixed64(q[we])}function oe(q,se){for(var we=0;we<q.length;we++)se.writeSFixed64(q[we])}function fe(q,se){return(q[se]|q[se+1]<<8|q[se+2]<<16)+16777216*q[se+3]}function ke(q,se,we){q[we]=se,q[we+1]=se>>>8,q[we+2]=se>>>16,q[we+3]=se>>>24}function xe(q,se){return(q[se]|q[se+1]<<8|q[se+2]<<16)+(q[se+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(q,se,we){for(we=we||this.length;this.pos<we;){var Ge=this.readVarint(),ht=Ge>>3,Qe=this.pos;this.type=7&Ge,q(ht,se,this),this.pos===Qe&&this.skip(Ge)}return se},readMessage:function(q,se){return this.readFields(q,se,this.readVarint()+this.pos)},readFixed32:function(){var q=fe(this.buf,this.pos);return this.pos+=4,q},readSFixed32:function(){var q=xe(this.buf,this.pos);return this.pos+=4,q},readFixed64:function(){var q=fe(this.buf,this.pos)+fe(this.buf,this.pos+4)*a;return this.pos+=8,q},readSFixed64:function(){var q=fe(this.buf,this.pos)+xe(this.buf,this.pos+4)*a;return this.pos+=8,q},readFloat:function(){var q=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,q},readDouble:function(){var q=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,q},readVarint:function(q){var se,we,Ge=this.buf;return se=127&(we=Ge[this.pos++]),we<128?se:(se|=(127&(we=Ge[this.pos++]))<<7,we<128?se:(se|=(127&(we=Ge[this.pos++]))<<14,we<128?se:(se|=(127&(we=Ge[this.pos++]))<<21,we<128?se:function(ht,Qe,it){var bt,pt,Tt=it.buf;if(bt=(112&(pt=Tt[it.pos++]))>>4,pt<128||(bt|=(127&(pt=Tt[it.pos++]))<<3,pt<128)||(bt|=(127&(pt=Tt[it.pos++]))<<10,pt<128)||(bt|=(127&(pt=Tt[it.pos++]))<<17,pt<128)||(bt|=(127&(pt=Tt[it.pos++]))<<24,pt<128)||(bt|=(1&(pt=Tt[it.pos++]))<<31,pt<128))return S(ht,bt,Qe);throw new Error("Expected varint not more than 10 bytes")}(se|=(15&(we=Ge[this.pos]))<<28,q,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var q=this.readVarint();return q%2==1?(q+1)/-2:q/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var q=this.readVarint()+this.pos,se=this.pos;return this.pos=q,q-se>=12&&y?function(we,Ge,ht){return y.decode(we.subarray(Ge,ht))}(this.buf,se,q):function(we,Ge,ht){for(var Qe="",it=Ge;it<ht;){var bt,pt,Tt,at=we[it],Ft=null,Yt=at>239?4:at>223?3:at>191?2:1;if(it+Yt>ht)break;Yt===1?at<128&&(Ft=at):Yt===2?(192&(bt=we[it+1]))==128&&(Ft=(31&at)<<6|63&bt)<=127&&(Ft=null):Yt===3?(pt=we[it+2],(192&(bt=we[it+1]))==128&&(192&pt)==128&&((Ft=(15&at)<<12|(63&bt)<<6|63&pt)<=2047||Ft>=55296&&Ft<=57343)&&(Ft=null)):Yt===4&&(pt=we[it+2],Tt=we[it+3],(192&(bt=we[it+1]))==128&&(192&pt)==128&&(192&Tt)==128&&((Ft=(15&at)<<18|(63&bt)<<12|(63&pt)<<6|63&Tt)<=65535||Ft>=1114112)&&(Ft=null)),Ft===null?(Ft=65533,Yt=1):Ft>65535&&(Ft-=65536,Qe+=String.fromCharCode(Ft>>>10&1023|55296),Ft=56320|1023&Ft),Qe+=String.fromCharCode(Ft),it+=Yt}return Qe}(this.buf,se,q)},readBytes:function(){var q=this.readVarint()+this.pos,se=this.buf.subarray(this.pos,q);return this.pos=q,se},readPackedVarint:function(q,se){if(this.type!==t.Bytes)return q.push(this.readVarint(se));var we=T(this);for(q=q||[];this.pos<we;)q.push(this.readVarint(se));return q},readPackedSVarint:function(q){if(this.type!==t.Bytes)return q.push(this.readSVarint());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readSVarint());return q},readPackedBoolean:function(q){if(this.type!==t.Bytes)return q.push(this.readBoolean());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readBoolean());return q},readPackedFloat:function(q){if(this.type!==t.Bytes)return q.push(this.readFloat());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readFloat());return q},readPackedDouble:function(q){if(this.type!==t.Bytes)return q.push(this.readDouble());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readDouble());return q},readPackedFixed32:function(q){if(this.type!==t.Bytes)return q.push(this.readFixed32());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readFixed32());return q},readPackedSFixed32:function(q){if(this.type!==t.Bytes)return q.push(this.readSFixed32());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readSFixed32());return q},readPackedFixed64:function(q){if(this.type!==t.Bytes)return q.push(this.readFixed64());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readFixed64());return q},readPackedSFixed64:function(q){if(this.type!==t.Bytes)return q.push(this.readSFixed64());var se=T(this);for(q=q||[];this.pos<se;)q.push(this.readSFixed64());return q},skip:function(q){var se=7&q;if(se===t.Varint)for(;this.buf[this.pos++]>127;);else if(se===t.Bytes)this.pos=this.readVarint()+this.pos;else if(se===t.Fixed32)this.pos+=4;else{if(se!==t.Fixed64)throw new Error("Unimplemented type: "+se);this.pos+=8}},writeTag:function(q,se){this.writeVarint(q<<3|se)},realloc:function(q){for(var se=this.length||16;se<this.pos+q;)se*=2;if(se!==this.length){var we=new Uint8Array(se);we.set(this.buf),this.buf=we,this.length=se}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(q){this.realloc(4),ke(this.buf,q,this.pos),this.pos+=4},writeSFixed32:function(q){this.realloc(4),ke(this.buf,q,this.pos),this.pos+=4},writeFixed64:function(q){this.realloc(8),ke(this.buf,-1&q,this.pos),ke(this.buf,Math.floor(q*d),this.pos+4),this.pos+=8},writeSFixed64:function(q){this.realloc(8),ke(this.buf,-1&q,this.pos),ke(this.buf,Math.floor(q*d),this.pos+4),this.pos+=8},writeVarint:function(q){(q=+q||0)>268435455||q<0?function(se,we){var Ge,ht;if(se>=0?(Ge=se%4294967296|0,ht=se/4294967296|0):(ht=~(-se/4294967296),4294967295^(Ge=~(-se%4294967296))?Ge=Ge+1|0:(Ge=0,ht=ht+1|0)),se>=18446744073709552e3||se<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");we.realloc(10),function(Qe,it,bt){bt.buf[bt.pos++]=127&Qe|128,Qe>>>=7,bt.buf[bt.pos++]=127&Qe|128,Qe>>>=7,bt.buf[bt.pos++]=127&Qe|128,Qe>>>=7,bt.buf[bt.pos++]=127&Qe|128,bt.buf[bt.pos]=127&(Qe>>>=7)}(Ge,0,we),function(Qe,it){var bt=(7&Qe)<<4;it.buf[it.pos++]|=bt|((Qe>>>=3)?128:0),Qe&&(it.buf[it.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(it.buf[it.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(it.buf[it.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(it.buf[it.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(it.buf[it.pos++]=127&Qe)))))}(ht,we)}(q,this):(this.realloc(4),this.buf[this.pos++]=127&q|(q>127?128:0),q<=127||(this.buf[this.pos++]=127&(q>>>=7)|(q>127?128:0),q<=127||(this.buf[this.pos++]=127&(q>>>=7)|(q>127?128:0),q<=127||(this.buf[this.pos++]=q>>>7&127))))},writeSVarint:function(q){this.writeVarint(q<0?2*-q-1:2*q)},writeBoolean:function(q){this.writeVarint(!!q)},writeString:function(q){q=String(q),this.realloc(4*q.length),this.pos++;var se=this.pos;this.pos=function(Ge,ht,Qe){for(var it,bt,pt=0;pt<ht.length;pt++){if((it=ht.charCodeAt(pt))>55295&&it<57344){if(!bt){it>56319||pt+1===ht.length?(Ge[Qe++]=239,Ge[Qe++]=191,Ge[Qe++]=189):bt=it;continue}if(it<56320){Ge[Qe++]=239,Ge[Qe++]=191,Ge[Qe++]=189,bt=it;continue}it=bt-55296<<10|it-56320|65536,bt=null}else bt&&(Ge[Qe++]=239,Ge[Qe++]=191,Ge[Qe++]=189,bt=null);it<128?Ge[Qe++]=it:(it<2048?Ge[Qe++]=it>>6|192:(it<65536?Ge[Qe++]=it>>12|224:(Ge[Qe++]=it>>18|240,Ge[Qe++]=it>>12&63|128),Ge[Qe++]=it>>6&63|128),Ge[Qe++]=63&it|128)}return Qe}(this.buf,q,this.pos);var we=this.pos-se;we>=128&&A(se,we,this),this.pos=se-1,this.writeVarint(we),this.pos+=we},writeFloat:function(q){this.realloc(4),l.write(this.buf,q,this.pos,!0,23,4),this.pos+=4},writeDouble:function(q){this.realloc(8),l.write(this.buf,q,this.pos,!0,52,8),this.pos+=8},writeBytes:function(q){var se=q.length;this.writeVarint(se),this.realloc(se);for(var we=0;we<se;we++)this.buf[this.pos++]=q[we]},writeRawMessage:function(q,se){this.pos++;var we=this.pos;q(se,this);var Ge=this.pos-we;Ge>=128&&A(we,Ge,this),this.pos=we-1,this.writeVarint(Ge),this.pos+=Ge},writeMessage:function(q,se,we){this.writeTag(q,t.Bytes),this.writeRawMessage(se,we)},writePackedVarint:function(q,se){se.length&&this.writeMessage(q,k,se)},writePackedSVarint:function(q,se){se.length&&this.writeMessage(q,N,se)},writePackedBoolean:function(q,se){se.length&&this.writeMessage(q,$,se)},writePackedFloat:function(q,se){se.length&&this.writeMessage(q,O,se)},writePackedDouble:function(q,se){se.length&&this.writeMessage(q,F,se)},writePackedFixed32:function(q,se){se.length&&this.writeMessage(q,H,se)},writePackedSFixed32:function(q,se){se.length&&this.writeMessage(q,W,se)},writePackedFixed64:function(q,se){se.length&&this.writeMessage(q,J,se)},writePackedSFixed64:function(q,se){se.length&&this.writeMessage(q,oe,se)},writeBytesField:function(q,se){this.writeTag(q,t.Bytes),this.writeBytes(se)},writeFixed32Field:function(q,se){this.writeTag(q,t.Fixed32),this.writeFixed32(se)},writeSFixed32Field:function(q,se){this.writeTag(q,t.Fixed32),this.writeSFixed32(se)},writeFixed64Field:function(q,se){this.writeTag(q,t.Fixed64),this.writeFixed64(se)},writeSFixed64Field:function(q,se){this.writeTag(q,t.Fixed64),this.writeSFixed64(se)},writeVarintField:function(q,se){this.writeTag(q,t.Varint),this.writeVarint(se)},writeSVarintField:function(q,se){this.writeTag(q,t.Varint),this.writeSVarint(se)},writeStringField:function(q,se){this.writeTag(q,t.Bytes),this.writeString(se)},writeFloatField:function(q,se){this.writeTag(q,t.Fixed32),this.writeFloat(se)},writeDoubleField:function(q,se){this.writeTag(q,t.Fixed64),this.writeDouble(se)},writeBooleanField:function(q,se){this.writeVarintField(q,!!se)}},ey}var Nc,xm=D(ty());function ny(l,t,a){l===1&&a.readMessage(iy,t)}function iy(l,t,a){if(l===3){const{id:d,bitmap:y,width:T,height:S,left:A,top:k,advance:N}=a.readMessage(Nv,{});t.push({id:d,bitmap:new zd({width:T+6,height:S+6},y),metrics:{width:T,height:S,left:A,top:k,advance:N}})}}function Nv(l,t,a){l===1?t.id=a.readVarint():l===2?t.bitmap=a.readBytes():l===3?t.width=a.readVarint():l===4?t.height=a.readVarint():l===5?t.left=a.readSVarint():l===6?t.top=a.readSVarint():l===7&&(t.advance=a.readVarint())}function l0(l){let t=0,a=0;for(const S of l)t+=S.w*S.h,a=Math.max(a,S.w);l.sort((S,A)=>A.h-S.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let y=0,T=0;for(const S of l)for(let A=d.length-1;A>=0;A--){const k=d[A];if(!(S.w>k.w||S.h>k.h)){if(S.x=k.x,S.y=k.y,T=Math.max(T,S.y+S.h),y=Math.max(y,S.x+S.w),S.w===k.w&&S.h===k.h){const N=d.pop();A<d.length&&(d[A]=N)}else S.h===k.h?(k.x+=S.w,k.w-=S.w):S.w===k.w?(k.y+=S.h,k.h-=S.h):(d.push({x:k.x+S.w,y:k.y,w:k.w-S.w,h:S.h}),k.y+=S.h,k.h-=S.h);break}}return{w:y,h:T,fill:t/(y*T)||0}}class ry{constructor(t,{pixelRatio:a,version:d,stretchX:y,stretchY:T,content:S,textFitWidth:A,textFitHeight:k}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=y,this.stretchY=T,this.content=S,this.version=d,this.textFitWidth=A,this.textFitHeight=k}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ay{constructor(t,a){const d={},y={};this.haveRenderCallbacks=[];const T=[];this.addImages(t,d,T),this.addImages(a,y,T);const{w:S,h:A}=l0(T),k=new fa({width:S||1,height:A||1});for(const N in t){const O=t[N],F=d[N].paddedRect;fa.copy(O.data,k,{x:0,y:0},{x:F.x+1,y:F.y+1},O.data)}for(const N in a){const O=a[N],F=y[N].paddedRect,$=F.x+1,H=F.y+1,W=O.data.width,J=O.data.height;fa.copy(O.data,k,{x:0,y:0},{x:$,y:H},O.data),fa.copy(O.data,k,{x:0,y:J-1},{x:$,y:H-1},{width:W,height:1}),fa.copy(O.data,k,{x:0,y:0},{x:$,y:H+J},{width:W,height:1}),fa.copy(O.data,k,{x:W-1,y:0},{x:$-1,y:H},{width:1,height:J}),fa.copy(O.data,k,{x:0,y:0},{x:$+W,y:H},{width:1,height:J})}this.image=k,this.iconPositions=d,this.patternPositions=y}addImages(t,a,d){for(const y in t){const T=t[y],S={x:0,y:0,w:T.data.width+2,h:T.data.height+2};d.push(S),a[y]=new ry(S,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in t.updatedImages)this.patchUpdatedImage(this.iconPositions[d],t.getImage(d),a),this.patchUpdatedImage(this.patternPositions[d],t.getImage(d),a)}patchUpdatedImage(t,a,d){if(!t||!a||t.version===a.version)return;t.version=a.version;const[y,T]=t.tl;d.update(a.data,void 0,{x:y,y:T})}}zt("ImagePosition",ry),zt("ImageAtlas",ay),v.an=void 0,(Nc=v.an||(v.an={}))[Nc.none=0]="none",Nc[Nc.horizontal=1]="horizontal",Nc[Nc.vertical=2]="vertical",Nc[Nc.horizontalOnly=3]="horizontalOnly";class Zd{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,d){const y=new Zd;return y.scale=t||1,y.fontStack=a,y.verticalAlign=d||"bottom",y}static forImage(t,a){const d=new Zd;return d.imageName=t,d.verticalAlign=a||"bottom",d}}class Qo{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const d=new Qo;for(let y=0;y<t.sections.length;y++){const T=t.sections[y];T.image?d.addImageSection(T):d.addTextSection(T,a)}return d}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let d=0;d<t.length;d++){const y=t.charCodeAt(d+1)||null,T=t.charCodeAt(d-1)||null;a+=y&&Ad(y)&&!Vd[t[d+1]]||T&&Ad(T)&&!Vd[t[d-1]]||!Vd[t[d]]?t[d]:Vd[t[d]]}return a}(this.text)}trim(){let t=0;for(let d=0;d<this.text.length&&op[this.text.charCodeAt(d)];d++)t++;let a=this.text.length;for(let d=this.text.length-1;d>=0&&d>=t&&op[this.text.charCodeAt(d)];d--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const d=new Qo;return d.text=this.text.substring(t,a),d.sectionIndex=this.sectionIndex.slice(t,a),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}getMaxImageSize(t){let a=0,d=0;for(let y=0;y<this.length();y++){const T=this.getSection(y);if(T.imageName){const S=t[T.imageName];if(!S)continue;const A=S.displaySize;a=Math.max(a,A[0]),d=Math.max(d,A[1])}}return{maxImageWidth:a,maxImageHeight:d}}addTextSection(t,a){this.text+=t.text,this.sections.push(Zd.forText(t.scale,t.fontStack||a,t.verticalAlign));const d=this.sections.length-1;for(let y=0;y<t.text.length;++y)this.sectionIndex.push(d)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void qn("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(Zd.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):qn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Dh(l,t,a,d,y,T,S,A,k,N,O,F,$,H,W){const J=Qo.fromFeature(l,y);let oe;F===v.an.vertical&&J.verticalizePunctuation();const{processBidirectionalText:fe,processStyledBidirectionalText:ke}=uo;if(fe&&J.sections.length===1){oe=[];const se=fe(J.toString(),bm(J,N,T,t,d,H));for(const we of se){const Ge=new Qo;Ge.text=we,Ge.sections=J.sections;for(let ht=0;ht<we.length;ht++)Ge.sectionIndex.push(0);oe.push(Ge)}}else if(ke){oe=[];const se=ke(J.text,J.sectionIndex,bm(J,N,T,t,d,H));for(const we of se){const Ge=new Qo;Ge.text=we[0],Ge.sectionIndex=we[1],Ge.sections=J.sections,oe.push(Ge)}}else oe=function(se,we){const Ge=[],ht=se.text;let Qe=0;for(const it of we)Ge.push(se.substring(Qe,it)),Qe=it;return Qe<ht.length&&Ge.push(se.substring(Qe,ht.length)),Ge}(J,bm(J,N,T,t,d,H));const xe=[],q={positionedLines:xe,text:J.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(se,we,Ge,ht,Qe,it,bt,pt,Tt,at,Ft,Yt){let Vt=0,jt=0,pn=0,xi=0;const Zi=pt==="right"?1:pt==="left"?0:.5,$i=sr/Yt;let Ns=0;for(const Fi of Qe){Fi.trim();const Ar=Fi.getMaxScale(),vr={positionedGlyphs:[],lineOffset:0};se.positionedLines[Ns]=vr;const Pr=vr.positionedGlyphs;let wa=0;if(!Fi.length()){jt+=it,++Ns;continue}const Ta=cy(ht,Fi,$i);for(let Sa=0;Sa<Fi.length();Sa++){const Yi=Fi.getSection(Sa),xr=Fi.getSectionIndex(Sa),cr=Fi.getCharCode(Sa),ur=f0(Tt,Ft,cr);let Mi;if(Yi.imageName){if(se.iconsInText=!0,Yi.scale=Yi.scale*$i,Mi=Lv(Yi,ur,Ar,Ta,ht),!Mi)continue;wa=Math.max(wa,Mi.imageOffset)}else if(Mi=Pv(Yi,cr,ur,Ta,we,Ge),!Mi)continue;const{rect:hs,metrics:r,baselineOffset:u}=Mi;Pr.push({glyph:cr,imageName:Yi.imageName,x:Vt,y:jt+u+-17,vertical:ur,scale:Yi.scale,fontStack:Yi.fontStack,sectionIndex:xr,metrics:r,rect:hs}),ur?(se.verticalizable=!0,Vt+=(Yi.imageName?r.advance:sr)*Yi.scale+at):Vt+=r.advance*Yi.scale+at}Pr.length!==0&&(pn=Math.max(Vt-at,pn),Ov(Pr,0,Pr.length-1,Zi)),Vt=0,vr.lineOffset=Math.max(wa,(Ar-1)*sr);const lr=it*Ar+wa;jt+=lr,xi=Math.max(lr,xi),++Ns}const{horizontalAlign:ba,verticalAlign:or}=yi(bt);(function(Fi,Ar,vr,Pr,wa,Ta,lr,Sa,Yi){const xr=(Ar-vr)*wa;let cr=0;cr=Ta!==lr?-Sa*Pr- -17:-Pr*Yi*lr+.5*lr;for(const ur of Fi)for(const Mi of ur.positionedGlyphs)Mi.x+=xr,Mi.y+=cr})(se.positionedLines,Zi,ba,or,pn,xi,it,jt,Qe.length),se.top+=-or*jt,se.bottom=se.top+jt,se.left+=-ba*pn,se.right=se.left+pn}(q,t,a,d,oe,S,A,k,F,N,$,W),!function(se){for(const we of se)if(we.positionedGlyphs.length!==0)return!1;return!0}(xe)&&q}const op={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},c0={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},u0={40:!0};function sy(l,t,a,d,y,T){if(t.imageName){const S=d[t.imageName];return S?S.displaySize[0]*t.scale*sr/T+y:0}{const S=a[t.fontStack],A=S&&S[l];return A?A.metrics.advance*t.scale+y:0}}function oy(l,t,a,d){const y=Math.pow(l-t,2);return d?l<t?y/2:2*y:y+Math.abs(a)*a}function h0(l,t,a){let d=0;return l===10&&(d-=1e4),a&&(d+=150),l!==40&&l!==65288||(d+=50),t!==41&&t!==65289||(d+=50),d}function lp(l,t,a,d,y,T){let S=null,A=oy(t,a,y,T);for(const k of d){const N=oy(t-k.x,a,y,T)+k.badness;N<=A&&(S=k,A=N)}return{index:l,x:t,priorBreak:S,badness:A}}function ly(l){return l?ly(l.priorBreak).concat(l.index):[]}function bm(l,t,a,d,y,T){if(!l)return[];const S=[],A=function(F,$,H,W,J,oe){let fe=0;for(let ke=0;ke<F.length();ke++){const xe=F.getSection(ke);fe+=sy(F.getCharCode(ke),xe,W,J,$,oe)}return fe/Math.max(1,Math.ceil(fe/H))}(l,t,a,d,y,T),k=l.text.indexOf("​")>=0;let N=0;for(let F=0;F<l.length();F++){const $=l.getSection(F),H=l.getCharCode(F);if(op[H]||(N+=sy(H,$,d,y,t,T)),F<l.length()-1){const W=!((O=H)<11904)&&(!!wn["CJK Compatibility Forms"](O)||!!wn["CJK Compatibility"](O)||!!wn["CJK Strokes"](O)||!!wn["CJK Symbols and Punctuation"](O)||!!wn["Enclosed CJK Letters and Months"](O)||!!wn["Halfwidth and Fullwidth Forms"](O)||!!wn["Ideographic Description Characters"](O)||!!wn["Vertical Forms"](O)||yc.test(String.fromCodePoint(O)));(c0[H]||W||$.imageName||F!==l.length()-2&&u0[l.getCharCode(F+1)])&&S.push(lp(F+1,N,A,S,h0(H,l.getCharCode(F+1),W&&k),!1))}}var O;return ly(lp(l.length(),N,A,S,0,!0))}function yi(l){let t=.5,a=.5;switch(l){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function cy(l,t,a){const d=t.getMaxScale()*sr,{maxImageWidth:y,maxImageHeight:T}=t.getMaxImageSize(l),S=Math.max(d,T*a);return{verticalLineContentWidth:Math.max(d,y*a),horizontalLineContentHeight:S}}function d0(l){switch(l){case"top":return 0;case"center":return .5;default:return 1}}function f0(l,t,a){return!(l===v.an.horizontal||!t&&!Ml(a)||t&&(op[a]||(d=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function Pv(l,t,a,d,y,T){const S=T[l.fontStack],A=function(N,O,F,$){if(N&&N.rect)return N;const H=O[F.fontStack],W=H&&H[$];return W?{rect:null,metrics:W.metrics}:null}(S&&S[t],y,l,t);if(A===null)return null;let k;if(a)k=d.verticalLineContentWidth-l.scale*sr;else{const N=d0(l.verticalAlign);k=(d.horizontalLineContentHeight-l.scale*sr)*N}return{rect:A.rect,metrics:A.metrics,baselineOffset:k}}function Lv(l,t,a,d,y){const T=y[l.imageName];if(!T)return null;const S=T.paddedRect,A=T.displaySize,k={width:A[0],height:A[1],left:1,top:-3,advance:t?A[1]:A[0]};let N;if(t)N=d.verticalLineContentWidth-A[1]*l.scale;else{const O=d0(l.verticalAlign);N=(d.horizontalLineContentHeight-A[1]*l.scale)*O}return{rect:S,metrics:k,baselineOffset:N,imageOffset:(t?A[0]:A[1])*l.scale-sr*a}}function Ov(l,t,a,d){if(d===0)return;const y=l[a],T=(l[a].x+y.metrics.advance*y.scale)*d;for(let S=t;S<=a;S++)l[S].x-=T}function wm(l,t,a){const{horizontalAlign:d,verticalAlign:y}=yi(a),T=t[0]-l.displaySize[0]*d,S=t[1]-l.displaySize[1]*y;return{image:l,top:S,bottom:S+l.displaySize[1],left:T,right:T+l.displaySize[0]}}function kh(l){var t,a;let d=l.left,y=l.top,T=l.right-d,S=l.bottom-y;const A=(t=l.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",k=(a=l.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",N=(l.image.content[2]-l.image.content[0])/(l.image.content[3]-l.image.content[1]);if(k==="proportional"){if(A==="stretchOnly"&&T/S<N||A==="proportional"){const O=Math.ceil(S*N);d*=O/T,T=O}}else if(A==="proportional"&&k==="stretchOnly"&&N!==0&&T/S>N){const O=Math.ceil(T/N);y*=O/S,S=O}return{x1:d,y1:y,x2:d+T,y2:y+S}}function Tm(l,t,a,d,y,T){const S=l.image;let A;if(S.content){const oe=S.content,fe=S.pixelRatio||1;A=[oe[0]/fe,oe[1]/fe,S.displaySize[0]-oe[2]/fe,S.displaySize[1]-oe[3]/fe]}const k=t.left*T,N=t.right*T;let O,F,$,H;a==="width"||a==="both"?(H=y[0]+k-d[3],F=y[0]+N+d[1]):(H=y[0]+(k+N-S.displaySize[0])/2,F=H+S.displaySize[0]);const W=t.top*T,J=t.bottom*T;return a==="height"||a==="both"?(O=y[1]+W-d[0],$=y[1]+J+d[2]):(O=y[1]+(W+J-S.displaySize[1])/2,$=O+S.displaySize[1]),{image:S,top:O,right:F,bottom:$,left:H,collisionPadding:A}}const _o=128,Pl=32640;function wu(l,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new pi(l+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:y}=a;let T=0;for(;T<d.length&&d[T]<=l;)T++;T=Math.max(0,T-1);let S=T;for(;S<d.length&&d[S]<l+1;)S++;S=Math.min(d.length-1,S);const A=d[T],k=d[S];return a.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:A,maxZoom:k,minSize:a.evaluate(new pi(A)),maxSize:a.evaluate(new pi(k)),interpolationType:y}}}function vo(l,t,a){let d="never";const y=l.get(t);return y?d=y:l.get(a)&&(d="always"),d}const cp=di.VectorTileFeature.types,jv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function up(l,t,a,d,y,T,S,A,k,N,O,F,$){const H=A?Math.min(Pl,Math.round(A[0])):0,W=A?Math.min(Pl,Math.round(A[1])):0;l.emplaceBack(t,a,Math.round(32*d),Math.round(32*y),T,S,(H<<1)+(k?1:0),W,16*N,16*O,256*F,256*$)}function Sm(l,t,a){l.emplaceBack(t.x,t.y,a),l.emplaceBack(t.x,t.y,a),l.emplaceBack(t.x,t.y,a),l.emplaceBack(t.x,t.y,a)}function p0(l){for(const t of l.sections)if(Cd(t.text))return!0;return!1}class Em{constructor(t){this.layoutVertexArray=new gn,this.indexArray=new ni,this.programConfigurations=t,this.segments=new Rn,this.dynamicLayoutVertexArray=new jn,this.opacityVertexArray=new Pi,this.hasVisibleVertices=!1,this.placedSymbolArray=new de}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,d,y){this.isEmpty()||(d&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,s0.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ap.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,jv,!0),this.opacityVertexBuffer.itemSize=1),(d||y)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zt("SymbolBuffers",Em);class uy{constructor(t,a,d){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new d,this.segments=new Rn,this.collisionVertexArray=new Bi}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Kg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zt("CollisionBuffers",uy);class Tu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(S=>S.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wu(this.zoom,a["text-size"]),this.iconSizeData=wu(this.zoom,a["icon-size"]);const d=this.layers[0].layout,y=d.get("symbol-sort-key"),T=d.get("symbol-z-order");this.canOverlap=vo(d,"text-overlap","text-allow-overlap")!=="never"||vo(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!y.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(S=>v.an[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=t.sourceID}createArrays(){this.text=new Em(new da(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Em(new da(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ge,this.lineVertexArray=new Te,this.symbolInstances=new be,this.textAnchorOffsets=new _e}calculateGlyphDependencies(t,a,d,y,T){for(let S=0;S<t.length;S++)if(a[t.charCodeAt(S)]=!0,(d||y)&&T){const A=Vd[t.charAt(S)];A&&(a[A.charCodeAt(0)]=!0)}}populate(t,a,d){const y=this.layers[0],T=y.layout,S=T.get("text-font"),A=T.get("text-field"),k=T.get("icon-image"),N=(A.value.kind!=="constant"||A.value.value instanceof Br&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),O=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,F=T.get("symbol-sort-key");if(this.features=[],!N&&!O)return;const $=a.iconDependencies,H=a.glyphDependencies,W=a.availableImages,J=new pi(this.zoom,{globalState:this.globalState});for(const{feature:oe,id:fe,index:ke,sourceLayerIndex:xe}of t){const q=y._featureFilter.needGeometry,se=yu(oe,q);if(!y._featureFilter.filter(J,se,d))continue;let we,Ge;if(q||(se.geometry=Ec(oe)),N){const Qe=y.getValueAndResolveTokens("text-field",se,d,W),it=Br.factory(Qe),bt=this.hasRTLText=this.hasRTLText||p0(it);(!bt||uo.getRTLTextPluginStatus()==="unavailable"||bt&&uo.isParsed())&&(we=zs(it,y,se))}if(O){const Qe=y.getValueAndResolveTokens("icon-image",se,d,W);Ge=Qe instanceof Fr?Qe:Fr.fromString(Qe)}if(!we&&!Ge)continue;const ht=this.sortFeaturesByKey?F.evaluate(se,{},d):void 0;if(this.features.push({id:fe,text:we,icon:Ge,index:ke,sourceLayerIndex:xe,geometry:se.geometry,properties:oe.properties,type:cp[oe.type],sortKey:ht}),Ge&&($[Ge.name]=!0),we){const Qe=S.evaluate(se,{},d).join(","),it=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.an.vertical)>=0;for(const bt of we.sections)if(bt.image)$[bt.image.name]=!0;else{const pt=lo(we.toString()),Tt=bt.fontStack||Qe,at=H[Tt]=H[Tt]||{};this.calculateGlyphDependencies(bt.text,at,it,this.allowVerticalPlacement,pt)}}}T.get("symbol-placement")==="line"&&(this.features=function(oe){const fe={},ke={},xe=[];let q=0;function se(Qe){xe.push(oe[Qe]),q++}function we(Qe,it,bt){const pt=ke[Qe];return delete ke[Qe],ke[it]=pt,xe[pt].geometry[0].pop(),xe[pt].geometry[0]=xe[pt].geometry[0].concat(bt[0]),pt}function Ge(Qe,it,bt){const pt=fe[it];return delete fe[it],fe[Qe]=pt,xe[pt].geometry[0].shift(),xe[pt].geometry[0]=bt[0].concat(xe[pt].geometry[0]),pt}function ht(Qe,it,bt){const pt=bt?it[0][it[0].length-1]:it[0][0];return`${Qe}:${pt.x}:${pt.y}`}for(let Qe=0;Qe<oe.length;Qe++){const it=oe[Qe],bt=it.geometry,pt=it.text?it.text.toString():null;if(!pt){se(Qe);continue}const Tt=ht(pt,bt),at=ht(pt,bt,!0);if(Tt in ke&&at in fe&&ke[Tt]!==fe[at]){const Ft=Ge(Tt,at,bt),Yt=we(Tt,at,xe[Ft].geometry);delete fe[Tt],delete ke[at],ke[ht(pt,xe[Yt].geometry,!0)]=Yt,xe[Ft].geometry=null}else Tt in ke?we(Tt,at,bt):at in fe?Ge(Tt,at,bt):(se(Qe),fe[Tt]=q-1,ke[at]=q-1)}return xe.filter(Qe=>Qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((oe,fe)=>oe.sortKey-fe.sortKey)}update(t,a,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,d),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const d=this.lineVertexArray.length;if(t.segment!==void 0){let y=t.dist(a[t.segment+1]),T=t.dist(a[t.segment]);const S={};for(let A=t.segment+1;A<a.length;A++)S[A]={x:a[A].x,y:a[A].y,tileUnitDistanceFromAnchor:y},A<a.length-1&&(y+=a[A+1].dist(a[A]));for(let A=t.segment||0;A>=0;A--)S[A]={x:a[A].x,y:a[A].y,tileUnitDistanceFromAnchor:T},A>0&&(T+=a[A-1].dist(a[A]));for(let A=0;A<a.length;A++){const k=S[A];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(t,a,d,y,T,S,A,k,N,O,F,$){const H=t.indexArray,W=t.layoutVertexArray,J=t.segments.prepareSegment(4*a.length,W,H,this.canOverlap?S.sortKey:void 0),oe=this.glyphOffsetArray.length,fe=J.vertexLength,ke=this.allowVerticalPlacement&&A===v.an.vertical?Math.PI/2:0,xe=S.text&&S.text.sections;for(let q=0;q<a.length;q++){const{tl:se,tr:we,bl:Ge,br:ht,tex:Qe,pixelOffsetTL:it,pixelOffsetBR:bt,minFontScaleX:pt,minFontScaleY:Tt,glyphOffset:at,isSDF:Ft,sectionIndex:Yt}=a[q],Vt=J.vertexLength,jt=at[1];up(W,k.x,k.y,se.x,jt+se.y,Qe.x,Qe.y,d,Ft,it.x,it.y,pt,Tt),up(W,k.x,k.y,we.x,jt+we.y,Qe.x+Qe.w,Qe.y,d,Ft,bt.x,it.y,pt,Tt),up(W,k.x,k.y,Ge.x,jt+Ge.y,Qe.x,Qe.y+Qe.h,d,Ft,it.x,bt.y,pt,Tt),up(W,k.x,k.y,ht.x,jt+ht.y,Qe.x+Qe.w,Qe.y+Qe.h,d,Ft,bt.x,bt.y,pt,Tt),Sm(t.dynamicLayoutVertexArray,k,ke),H.emplaceBack(Vt,Vt+2,Vt+1),H.emplaceBack(Vt+1,Vt+2,Vt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(at[0]),q!==a.length-1&&Yt===a[q+1].sectionIndex||t.programConfigurations.populatePaintArrays(W.length,S,S.index,{},$,xe&&xe[Yt])}t.placedSymbolArray.emplaceBack(k.x,k.y,oe,this.glyphOffsetArray.length-oe,fe,N,O,k.segment,d?d[0]:0,d?d[1]:0,y[0],y[1],A,0,!1,0,F)}_addCollisionDebugVertex(t,a,d,y,T,S){return a.emplaceBack(0,0),t.emplaceBack(d.x,d.y,y,T,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(t,a,d,y,T,S,A){const k=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),N=k.vertexLength,O=T.layoutVertexArray,F=T.collisionVertexArray,$=A.anchorX,H=A.anchorY;this._addCollisionDebugVertex(O,F,S,$,H,new ne(t,a)),this._addCollisionDebugVertex(O,F,S,$,H,new ne(d,a)),this._addCollisionDebugVertex(O,F,S,$,H,new ne(d,y)),this._addCollisionDebugVertex(O,F,S,$,H,new ne(t,y)),k.vertexLength+=4;const W=T.indexArray;W.emplaceBack(N,N+1),W.emplaceBack(N+1,N+2),W.emplaceBack(N+2,N+3),W.emplaceBack(N+3,N),k.primitiveLength+=4}addDebugCollisionBoxes(t,a,d,y){for(let T=t;T<a;T++){const S=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,y?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new uy(ti,cs.members,ii),this.iconCollisionBox=new uy(ti,cs.members,ii);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,d,y,T,S,A,k,N){const O={};for(let F=a;F<d;F++){const $=t.get(F);O.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.textFeatureIndex=$.featureIndex;break}for(let F=y;F<T;F++){const $=t.get(F);O.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalTextFeatureIndex=$.featureIndex;break}for(let F=S;F<A;F++){const $=t.get(F);O.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.iconFeatureIndex=$.featureIndex;break}for(let F=k;F<N;F++){const $=t.get(F);O.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalIconFeatureIndex=$.featureIndex;break}return O}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const d=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const d=t.placedSymbolArray.get(a),y=d.vertexStartIndex+4*d.numGlyphs;for(let T=d.vertexStartIndex;T<y;T+=4)t.indexArray.emplaceBack(T,T+2,T+1),t.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),d=Math.cos(t),y=[],T=[],S=[];for(let A=0;A<this.symbolInstances.length;++A){S.push(A);const k=this.symbolInstances.get(A);y.push(0|Math.round(a*k.anchorX+d*k.anchorY)),T.push(k.featureIndex)}return S.sort((A,k)=>y[A]-y[k]||T[k]-T[A]),S}addToSortKeyRanges(t,a){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===a?d.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const d=this.symbolInstances.get(a);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((y,T,S)=>{y>=0&&S.indexOf(y)===T&&this.addIndicesForPlacedSymbol(this.text,y)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hy,dy;zt("SymbolBucket",Tu,{omit:["layers","collisionBoxArray","features","compareText"]}),Tu.MAX_GLYPHS=65535,Tu.addDynamicAttributes=Sm;var fy={get paint(){return dy=dy||new Vr({"icon-opacity":new Zt(Ae.paint_symbol["icon-opacity"]),"icon-color":new Zt(Ae.paint_symbol["icon-color"]),"icon-halo-color":new Zt(Ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zt(Ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zt(Ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Ot(Ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ot(Ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zt(Ae.paint_symbol["text-opacity"]),"text-color":new Zt(Ae.paint_symbol["text-color"],{runtimeType:ma,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Zt(Ae.paint_symbol["text-halo-color"]),"text-halo-width":new Zt(Ae.paint_symbol["text-halo-width"]),"text-halo-blur":new Zt(Ae.paint_symbol["text-halo-blur"]),"text-translate":new Ot(Ae.paint_symbol["text-translate"]),"text-translate-anchor":new Ot(Ae.paint_symbol["text-translate-anchor"])})},get layout(){return hy=hy||new Vr({"symbol-placement":new Ot(Ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Ot(Ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ot(Ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zt(Ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ot(Ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ot(Ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ot(Ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ot(Ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ot(Ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ot(Ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zt(Ae.layout_symbol["icon-size"]),"icon-text-fit":new Ot(Ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ot(Ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zt(Ae.layout_symbol["icon-image"]),"icon-rotate":new Zt(Ae.layout_symbol["icon-rotate"]),"icon-padding":new Zt(Ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Ot(Ae.layout_symbol["icon-keep-upright"]),"icon-offset":new Zt(Ae.layout_symbol["icon-offset"]),"icon-anchor":new Zt(Ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ot(Ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ot(Ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ot(Ae.layout_symbol["text-rotation-alignment"]),"text-field":new Zt(Ae.layout_symbol["text-field"]),"text-font":new Zt(Ae.layout_symbol["text-font"]),"text-size":new Zt(Ae.layout_symbol["text-size"]),"text-max-width":new Zt(Ae.layout_symbol["text-max-width"]),"text-line-height":new Ot(Ae.layout_symbol["text-line-height"]),"text-letter-spacing":new Zt(Ae.layout_symbol["text-letter-spacing"]),"text-justify":new Zt(Ae.layout_symbol["text-justify"]),"text-radial-offset":new Zt(Ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ot(Ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Zt(Ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Zt(Ae.layout_symbol["text-anchor"]),"text-max-angle":new Ot(Ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Ot(Ae.layout_symbol["text-writing-mode"]),"text-rotate":new Zt(Ae.layout_symbol["text-rotate"]),"text-padding":new Ot(Ae.layout_symbol["text-padding"]),"text-keep-upright":new Ot(Ae.layout_symbol["text-keep-upright"]),"text-transform":new Zt(Ae.layout_symbol["text-transform"]),"text-offset":new Zt(Ae.layout_symbol["text-offset"]),"text-allow-overlap":new Ot(Ae.layout_symbol["text-allow-overlap"]),"text-overlap":new Ot(Ae.layout_symbol["text-overlap"]),"text-ignore-placement":new Ot(Ae.layout_symbol["text-ignore-placement"]),"text-optional":new Ot(Ae.layout_symbol["text-optional"])})}};class Am{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Qa,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zt("FormatSectionOverride",Am,{omit:["defaultValue"]});class $d extends zr{constructor(t){super(t,fy)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const y=[];for(const T of d)y.indexOf(T)<0&&y.push(T);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,d,y){const T=this.layout.get(t).evaluate(a,{},d,y),S=this._unevaluatedLayout._values[t];return S.isDataDriven()||hc(S.value)||!T?T:function(A,k){return k.replace(/{([^{}]+)}/g,(N,O)=>A&&O in A?String(A[O]):"")}(a.properties,T)}createBucket(t){return new Tu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of fy.paint.overridableProperties){if(!$d.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),d=new Am(a),y=new uc(d,a.property.specification);let T=null;T=a.value.kind==="constant"||a.value.kind==="source"?new Kr("source",y):new ao("composite",y,a.value.zoomStops),this.paint._values[t]=new Jr(a.property,T,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,d){return!(!this.layout||a.isDataDriven()||d.isDataDriven())&&$d.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const d=t.get("text-field"),y=fy.paint.properties[a];let T=!1;const S=A=>{for(const k of A)if(y.overrides&&y.overrides.hasOverride(k))return void(T=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Br)S(d.value.value.sections);else if(d.value.kind==="source"){const A=N=>{T||(N instanceof er&&tn(N.value)===ll?S(N.value.sections):N instanceof Po?S(N.sections):N.eachChild(A))},k=d.value;k._styleExpression&&A(k._styleExpression.expression)}return T}}let m0;var Bv={get paint(){return m0=m0||new Vr({"background-color":new Ot(Ae.paint_background["background-color"]),"background-pattern":new Ui(Ae.paint_background["background-pattern"]),"background-opacity":new Ot(Ae.paint_background["background-opacity"])})}};class hp extends zr{constructor(t){super(t,Bv)}}let g0;var y0={get paint(){return g0=g0||new Vr({"raster-opacity":new Ot(Ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ot(Ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ot(Ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ot(Ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Ot(Ae.paint_raster["raster-saturation"]),"raster-contrast":new Ot(Ae.paint_raster["raster-contrast"]),"raster-resampling":new Ot(Ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Ot(Ae.paint_raster["raster-fade-duration"])})}};class Fn extends zr{constructor(t){super(t,y0)}}class py extends zr{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Mm{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const my={once:!0},Cm=63710088e-1;class Ll{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ll(Ca(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,d=this.lat*a,y=t.lat*a,T=Math.sin(d)*Math.sin(y)+Math.cos(d)*Math.cos(y)*Math.cos((t.lng-this.lng)*a);return Cm*Math.acos(Math.min(T,1))}static convert(t){if(t instanceof Ll)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ll(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ll(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Yd=2*Math.PI*Cm;function dp(l){return Yd*Math.cos(l*Math.PI/180)}function Ih(l){return(180+l)/360}function gy(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function _0(l,t){return l/dp(t)}function yy(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function _y(l,t){return l*dp(yy(t))}class qd{constructor(t,a,d=0){this.x=+t,this.y=+a,this.z=+d}static fromLngLat(t,a=0){const d=Ll.convert(t);return new qd(Ih(d.lng),gy(d.lat),_0(a,d.lat))}toLngLat(){return new Ll(360*this.x-180,yy(this.y))}toAltitude(){return _y(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Yd*(t=yy(this.y),1/Math.cos(t*Math.PI/180));var t}}function fp(l,t,a){var d=2*Math.PI*6378137/256/Math.pow(2,a);return[l*d-2*Math.PI*6378137/2,t*d-2*Math.PI*6378137/2]}class fi{constructor(t,a,d){if(!function(y,T,S){return!(y<0||y>25||S<0||S>=Math.pow(2,y)||T<0||T>=Math.pow(2,y))}(t,a,d))throw new Error(`x=${a}, y=${d}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=d,this.key=Hd(0,t,t,a,d)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,d){const y=(S=this.y,A=this.z,k=fp(256*(T=this.x),256*(S=Math.pow(2,A)-S-1),A),N=fp(256*(T+1),256*(S+1),A),k[0]+","+k[1]+","+N[0]+","+N[1]);var T,S,A,k,N;const O=function(F,$,H){let W,J="";for(let oe=F;oe>0;oe--)W=1<<oe-1,J+=($&W?1:0)+(H&W?2:0);return J}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,y)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new ne((t.x*a-this.x)*wt,(t.y*a-this.y)*wt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dm{constructor(t,a){this.wrap=t,this.canonical=a,this.key=Hd(t,a.z,a.z,a.x,a.y)}}class _i{constructor(t,a,d,y,T){if(this.terrainRttPosMatrix32f=null,t<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${d}`);this.overscaledZ=t,this.wrap=a,this.canonical=new fi(d,+y,+T),this.key=Hd(a,t,d,y,T)}clone(){return new _i(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new _i(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _i(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-t;return t>this.canonical.z?Hd(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):Hd(this.wrap*+a,t,t,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new _i(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,d=2*this.canonical.x,y=2*this.canonical.y;return[new _i(a,this.wrap,a,d,y),new _i(a,this.wrap,a,d+1,y),new _i(a,this.wrap,a,d,y+1),new _i(a,this.wrap,a,d+1,y+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new _i(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new _i(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new qd(t.x-this.wrap,t.y))}}function Hd(l,t,a,d,y){(l*=2)<0&&(l=-1*l-1);const T=1<<a;return(T*T*l+T*y+d).toString(36)+a.toString(36)+t.toString(36)}zt("CanonicalTileID",fi),zt("OverscaledTileID",_i,{omit:["terrainRttPosMatrix32f"]});class Pc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const a=new Pc;return a.extend(t(new ne(this.minX,this.minY))),a.extend(t(new ne(this.maxX,this.minY))),a.extend(t(new ne(this.minX,this.maxY))),a.extend(t(new ne(this.maxX,this.maxY))),a}static fromPoints(t){const a=new Pc;for(const d of t)a.extend(d);return a}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class km{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const d=t[a];this._stringToNumber[d]=a,this._numberToString[a]=d}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class pp{constructor(t,a,d,y,T){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=d,t._y=y,this.properties=t.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class vy{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new El(wt,16,0),this.grid3D=new El(wt,16,0),this.featureIndexArray=new qe,this.promoteId=a}insert(t,a,d,y,T,S){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,y,T);const k=S?this.grid3D:this.grid;for(let N=0;N<a.length;N++){const O=a[N],F=[1/0,1/0,-1/0,-1/0];for(let $=0;$<O.length;$++){const H=O[$];F[0]=Math.min(F[0],H.x),F[1]=Math.min(F[1],H.y),F[2]=Math.max(F[2],H.x),F[3]=Math.max(F[3],H.y)}F[0]<wt&&F[1]<wt&&F[2]>=0&&F[3]>=0&&k.insert(A,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new di.VectorTile(new xm(this.rawTileData)).layers,this.sourceLayerCoder=new km(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,d,y){this.loadVTLayers();const T=t.params,S=wt/t.tileSize/t.scale,A=Wi(T.filter),k=t.queryGeometry,N=t.queryPadding*S,O=Pc.fromPoints(k),F=this.grid.query(O.minX-N,O.minY-N,O.maxX+N,O.maxY+N),$=Pc.fromPoints(t.cameraQueryGeometry).expandBy(N),H=this.grid3D.query($.minX,$.minY,$.maxX,$.maxY,(oe,fe,ke,xe)=>function(q,se,we,Ge,ht){for(const it of q)if(se<=it.x&&we<=it.y&&Ge>=it.x&&ht>=it.y)return!0;const Qe=[new ne(se,we),new ne(se,ht),new ne(Ge,ht),new ne(Ge,we)];if(q.length>2){for(const it of Qe)if(Th(q,it))return!0}for(let it=0;it<q.length-1;it++)if(ta(q[it],q[it+1],Qe))return!0;return!1}(t.cameraQueryGeometry,oe-N,fe-N,ke+N,xe+N));for(const oe of H)F.push(oe);F.sort(by);const W={};let J;for(let oe=0;oe<F.length;oe++){const fe=F[oe];if(fe===J)continue;J=fe;const ke=this.featureIndexArray.get(fe);let xe=null;this.loadMatchingFeature(W,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,A,T.layers,T.availableImages,a,d,y,(q,se,we)=>(xe||(xe=Ec(q)),se.queryIntersectsFeature({queryGeometry:k,feature:q,featureState:we,geometry:xe,zoom:this.z,transform:t.transform,pixelsToTileUnits:S,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return W}loadMatchingFeature(t,a,d,y,T,S,A,k,N,O,F){const $=this.bucketLayerIDs[a];if(S&&!$.some(oe=>S.has(oe)))return;const H=this.sourceLayerCoder.decode(d),W=this.vtLayers[H].feature(y);if(T.needGeometry){const oe=yu(W,!0);if(!T.filter(new pi(this.tileID.overscaledZ),oe,this.tileID.canonical))return}else if(!T.filter(new pi(this.tileID.overscaledZ),W))return;const J=this.getId(W,H);for(let oe=0;oe<$.length;oe++){const fe=$[oe];if(S&&!S.has(fe))continue;const ke=k[fe];if(!ke)continue;let xe={};J&&O&&(xe=O.getState(ke.sourceLayer||"_geojsonTileLayer",J));const q=Hi({},N[fe]);q.paint=xy(q.paint,ke.paint,W,xe,A),q.layout=xy(q.layout,ke.layout,W,xe,A);const se=!F||F(W,ke,xe);if(!se)continue;const we=new pp(W,this.z,this.x,this.y,J);we.layer=q;let Ge=t[fe];Ge===void 0&&(Ge=t[fe]=[]),Ge.push({featureIndex:y,feature:we,intersectionZ:se})}}lookupSymbolFeatures(t,a,d,y,T,S,A,k){const N={};this.loadVTLayers();const O=Wi(T);for(const F of t)this.loadMatchingFeature(N,d,y,F,O,S,A,k,a);return N}hasLayer(t){for(const a of this.bucketLayerIDs)for(const d of a)if(t===d)return!0;return!1}getId(t,a){var d;let y=t.id;return this.promoteId&&(y=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof y=="boolean"&&(y=Number(y)),y===void 0&&(!((d=t.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(y=Number(t.properties.cluster_id))),y}}function xy(l,t,a,d,y){return Xn(l,(T,S)=>{const A=t instanceof _c?t.get(S):null;return A&&A.evaluate?A.evaluate(a,d,y):A})}function by(l,t){return t-l}function Im(l,t,a,d,y){const T=[];for(let S=0;S<l.length;S++){const A=l[S];let k;for(let N=0;N<A.length-1;N++){let O=A[N],F=A[N+1];O.x<t&&F.x<t||(O.x<t?O=new ne(t,O.y+(t-O.x)/(F.x-O.x)*(F.y-O.y))._round():F.x<t&&(F=new ne(t,O.y+(t-O.x)/(F.x-O.x)*(F.y-O.y))._round()),O.y<a&&F.y<a||(O.y<a?O=new ne(O.x+(a-O.y)/(F.y-O.y)*(F.x-O.x),a)._round():F.y<a&&(F=new ne(O.x+(a-O.y)/(F.y-O.y)*(F.x-O.x),a)._round()),O.x>=d&&F.x>=d||(O.x>=d?O=new ne(d,O.y+(d-O.x)/(F.x-O.x)*(F.y-O.y))._round():F.x>=d&&(F=new ne(d,O.y+(d-O.x)/(F.x-O.x)*(F.y-O.y))._round()),O.y>=y&&F.y>=y||(O.y>=y?O=new ne(O.x+(y-O.y)/(F.y-O.y)*(F.x-O.x),y)._round():F.y>=y&&(F=new ne(O.x+(y-O.y)/(F.y-O.y)*(F.x-O.x),y)._round()),k&&O.equals(k[k.length-1])||(k=[O],T.push(k)),k.push(F)))))}}return T}zt("FeatureIndex",vy,{omit:["rawTileData","sourceLayerCoder"]});class Su extends ne{constructor(t,a,d,y){super(t,a),this.angle=d,y!==void 0&&(this.segment=y)}clone(){return new Su(this.x,this.y,this.angle,this.segment)}}function wy(l,t,a,d,y){if(t.segment===void 0||a===0)return!0;let T=t,S=t.segment+1,A=0;for(;A>-a/2;){if(S--,S<0)return!1;A-=l[S].dist(T),T=l[S]}A+=l[S].dist(l[S+1]),S++;const k=[];let N=0;for(;A<a/2;){const O=l[S],F=l[S+1];if(!F)return!1;let $=l[S-1].angleTo(O)-O.angleTo(F);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:A,angleDelta:$}),N+=$;A-k[0].distance>d;)N-=k.shift().angleDelta;if(N>y)return!1;S++,A+=O.dist(F)}return!0}function v0(l){let t=0;for(let a=0;a<l.length-1;a++)t+=l[a].dist(l[a+1]);return t}function Ty(l,t,a){return l?.6*t*a:0}function x0(l,t){return Math.max(l?l.right-l.left:0,t?t.right-t.left:0)}function Fv(l,t,a,d,y,T){const S=Ty(a,y,T),A=x0(a,d)*T;let k=0;const N=v0(l)/2;for(let O=0;O<l.length-1;O++){const F=l[O],$=l[O+1],H=F.dist($);if(k+H>N){const W=(N-k)/H,J=za.number(F.x,$.x,W),oe=za.number(F.y,$.y,W),fe=new Su(J,oe,$.angleTo(F),O);return fe._round(),!S||wy(l,fe,A,S,t)?fe:void 0}k+=H}}function Eu(l,t,a,d,y,T,S,A,k){const N=Ty(d,T,S),O=x0(d,y),F=O*S,$=l[0].x===0||l[0].x===k||l[0].y===0||l[0].y===k;return t-F<t/4&&(t=F+t/4),Sy(l,$?t/2*A%t:(O/2+2*T)*S*A%t,t,N,a,F,$,!1,k)}function Sy(l,t,a,d,y,T,S,A,k){const N=T/2,O=v0(l);let F=0,$=t-a,H=[];for(let W=0;W<l.length-1;W++){const J=l[W],oe=l[W+1],fe=J.dist(oe),ke=oe.angleTo(J);for(;$+a<F+fe;){$+=a;const xe=($-F)/fe,q=za.number(J.x,oe.x,xe),se=za.number(J.y,oe.y,xe);if(q>=0&&q<k&&se>=0&&se<k&&$-N>=0&&$+N<=O){const we=new Su(q,se,ke,W);we._round(),d&&!wy(l,we,T,d,y)||H.push(we)}}F+=fe}return A||H.length||S||(H=Sy(l,F/2,a,d,y,T,S,!0,k)),H}function Rm(l,t,a,d){const y=[],T=l.image,S=T.pixelRatio,A=T.paddedRect.w-2,k=T.paddedRect.h-2;let N={x1:l.left,y1:l.top,x2:l.right,y2:l.bottom};const O=T.stretchX||[[0,A]],F=T.stretchY||[[0,k]],$=(at,Ft)=>at+Ft[1]-Ft[0],H=O.reduce($,0),W=F.reduce($,0),J=A-H,oe=k-W;let fe=0,ke=H,xe=0,q=W,se=0,we=J,Ge=0,ht=oe;if(T.content&&d){const at=T.content,Ft=at[2]-at[0],Yt=at[3]-at[1];(T.textFitWidth||T.textFitHeight)&&(N=kh(l)),fe=zm(O,0,at[0]),xe=zm(F,0,at[1]),ke=zm(O,at[0],at[2]),q=zm(F,at[1],at[3]),se=at[0]-fe,Ge=at[1]-xe,we=Ft-ke,ht=Yt-q}const Qe=N.x1,it=N.y1,bt=N.x2-Qe,pt=N.y2-it,Tt=(at,Ft,Yt,Vt)=>{const jt=Xd(at.stretch-fe,ke,bt,Qe),pn=Nm(at.fixed-se,we,at.stretch,H),xi=Xd(Ft.stretch-xe,q,pt,it),Zi=Nm(Ft.fixed-Ge,ht,Ft.stretch,W),$i=Xd(Yt.stretch-fe,ke,bt,Qe),Ns=Nm(Yt.fixed-se,we,Yt.stretch,H),ba=Xd(Vt.stretch-xe,q,pt,it),or=Nm(Vt.fixed-Ge,ht,Vt.stretch,W),Fi=new ne(jt,xi),Ar=new ne($i,xi),vr=new ne($i,ba),Pr=new ne(jt,ba),wa=new ne(pn/S,Zi/S),Ta=new ne(Ns/S,or/S),lr=t*Math.PI/180;if(lr){const xr=Math.sin(lr),cr=Math.cos(lr),ur=[cr,-xr,xr,cr];Fi._matMult(ur),Ar._matMult(ur),Pr._matMult(ur),vr._matMult(ur)}const Sa=at.stretch+at.fixed,Yi=Ft.stretch+Ft.fixed;return{tl:Fi,tr:Ar,bl:Pr,br:vr,tex:{x:T.paddedRect.x+1+Sa,y:T.paddedRect.y+1+Yi,w:Yt.stretch+Yt.fixed-Sa,h:Vt.stretch+Vt.fixed-Yi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wa,pixelOffsetBR:Ta,minFontScaleX:we/S/bt,minFontScaleY:ht/S/pt,isSDF:a}};if(d&&(T.stretchX||T.stretchY)){const at=b0(O,J,H),Ft=b0(F,oe,W);for(let Yt=0;Yt<at.length-1;Yt++){const Vt=at[Yt],jt=at[Yt+1];for(let pn=0;pn<Ft.length-1;pn++)y.push(Tt(Vt,Ft[pn],jt,Ft[pn+1]))}}else y.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:k+1}));return y}function zm(l,t,a){let d=0;for(const y of l)d+=Math.max(t,Math.min(a,y[1]))-Math.max(t,Math.min(a,y[0]));return d}function b0(l,t,a){const d=[{fixed:-1,stretch:0}];for(const[y,T]of l){const S=d[d.length-1];d.push({fixed:y-S.stretch,stretch:S.stretch}),d.push({fixed:y-S.stretch,stretch:S.stretch+(T-y)})}return d.push({fixed:t+1,stretch:a}),d}function Xd(l,t,a,d){return l/t*a+d}function Nm(l,t,a,d){return l-t*a/d}zt("Anchor",Su);class us{constructor(t,a,d,y,T,S,A,k,N,O){var F;if(this.boxStartIndex=t.length,N){let $=S.top,H=S.bottom;const W=S.collisionPadding;W&&($-=W[1],H+=W[3]);let J=H-$;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const $=!((F=S.image)===null||F===void 0)&&F.content&&(S.image.textFitWidth||S.image.textFitHeight)?kh(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};$.y1=$.y1*A-k[0],$.y2=$.y2*A+k[2],$.x1=$.x1*A-k[3],$.x2=$.x2*A+k[1];const H=S.collisionPadding;if(H&&($.x1-=H[0]*A,$.y1-=H[1]*A,$.x2+=H[2]*A,$.y2+=H[3]*A),O){const W=new ne($.x1,$.y1),J=new ne($.x2,$.y1),oe=new ne($.x1,$.y2),fe=new ne($.x2,$.y2),ke=O*Math.PI/180;W._rotate(ke),J._rotate(ke),oe._rotate(ke),fe._rotate(ke),$.x1=Math.min(W.x,J.x,oe.x,fe.x),$.x2=Math.max(W.x,J.x,oe.x,fe.x),$.y1=Math.min(W.y,J.y,oe.y,fe.y),$.y2=Math.max(W.y,J.y,oe.y,fe.y)}t.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,d,y,T)}this.boxEndIndex=t.length}}class Ey{constructor(t=[],a=(d,y)=>d<y?-1:d>y?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:d}=this,y=a[t];for(;t>0;){const T=t-1>>1,S=a[T];if(d(y,S)>=0)break;a[t]=S,t=T}a[t]=y}_down(t){const{data:a,compare:d}=this,y=this.length>>1,T=a[t];for(;t<y;){let S=1+(t<<1);const A=S+1;if(A<this.length&&d(a[A],a[S])<0&&(S=A),d(a[S],T)>=0)break;a[t]=a[S],t=S}a[t]=T}}function w0(l,t=1,a=!1){const d=Pc.fromPoints(l[0]),y=Math.min(d.width(),d.height());let T=y/2;const S=new Ey([],T0),{minX:A,minY:k,maxX:N,maxY:O}=d;if(y===0)return new ne(A,k);for(let H=A;H<N;H+=y)for(let W=k;W<O;W+=y)S.push(new Ol(H+T,W+T,T,l));let F=function(H){let W=0,J=0,oe=0;const fe=H[0];for(let ke=0,xe=fe.length,q=xe-1;ke<xe;q=ke++){const se=fe[ke],we=fe[q],Ge=se.x*we.y-we.x*se.y;J+=(se.x+we.x)*Ge,oe+=(se.y+we.y)*Ge,W+=3*Ge}return new Ol(J/W,oe/W,0,H)}(l),$=S.length;for(;S.length;){const H=S.pop();(H.d>F.d||!F.d)&&(F=H,a&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,$)),H.max-F.d<=t||(T=H.h/2,S.push(new Ol(H.p.x-T,H.p.y-T,T,l)),S.push(new Ol(H.p.x+T,H.p.y-T,T,l)),S.push(new Ol(H.p.x-T,H.p.y+T,T,l)),S.push(new Ol(H.p.x+T,H.p.y+T,T,l)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${F.d}`)),F.p}function T0(l,t){return t.max-l.max}function Ol(l,t,a,d){this.p=new ne(l,t),this.h=a,this.d=function(y,T){let S=!1,A=1/0;for(let k=0;k<T.length;k++){const N=T[k];for(let O=0,F=N.length,$=F-1;O<F;$=O++){const H=N[O],W=N[$];H.y>y.y!=W.y>y.y&&y.x<(W.x-H.x)*(y.y-H.y)/(W.y-H.y)+H.x&&(S=!S),A=Math.min(A,Rg(y,H,W))}}return(S?1:-1)*Math.sqrt(A)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var vi;v.aD=void 0,(vi=v.aD||(v.aD={}))[vi.center=1]="center",vi[vi.left=2]="left",vi[vi.right=3]="right",vi[vi.top=4]="top",vi[vi.bottom=5]="bottom",vi[vi["top-left"]=6]="top-left",vi[vi["top-right"]=7]="top-right",vi[vi["bottom-left"]=8]="bottom-left",vi[vi["bottom-right"]=9]="bottom-right";const Pm=Number.POSITIVE_INFINITY;function mp(l,t){return t[1]!==Pm?function(a,d,y){let T=0,S=0;switch(d=Math.abs(d),y=Math.abs(y),a){case"top-right":case"top-left":case"top":S=y-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-y}switch(a){case"top-right":case"bottom-right":case"right":T=-d;break;case"top-left":case"bottom-left":case"left":T=d}return[T,S]}(l,t[0],t[1]):function(a,d){let y=0,T=0;d<0&&(d=0);const S=d/Math.SQRT2;switch(a){case"top-right":case"top-left":T=S-7;break;case"bottom-right":case"bottom-left":T=7-S;break;case"bottom":T=7-d;break;case"top":T=d-7}switch(a){case"top-right":case"bottom-right":y=-S;break;case"top-left":case"bottom-left":y=S;break;case"left":y=d;break;case"right":y=-d}return[y,T]}(l,t[0])}function jl(l,t,a){var d;const y=l.layout,T=(d=y.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(t,{},a);if(T){const A=T.values,k=[];for(let N=0;N<A.length;N+=2){const O=k[N]=A[N],F=A[N+1].map($=>$*sr);O.startsWith("top")?F[1]-=7:O.startsWith("bottom")&&(F[1]+=7),k[N+1]=F}return new Cn(k)}const S=y.get("text-variable-anchor");if(S){let A;A=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[y.get("text-radial-offset").evaluate(t,{},a)*sr,Pm]:y.get("text-offset").evaluate(t,{},a).map(N=>N*sr);const k=[];for(const N of S)k.push(N,mp(N,A));return new Cn(k)}return null}function Ay(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uv(l,t,a,d,y,T,S,A,k,N,O,F){let $=T.textMaxSize.evaluate(t,{});$===void 0&&($=S);const H=l.layers[0].layout,W=H.get("icon-offset").evaluate(t,{},O),J=My(a.horizontal),oe=S/24,fe=l.tilePixelRatio*oe,ke=l.tilePixelRatio*$/24,xe=l.tilePixelRatio*A,q=l.tilePixelRatio*H.get("symbol-spacing"),se=H.get("text-padding")*l.tilePixelRatio,we=function(Yt,Vt,jt,pn=1){const xi=Yt.get("icon-padding").evaluate(Vt,{},jt),Zi=xi&&xi.values;return[Zi[0]*pn,Zi[1]*pn,Zi[2]*pn,Zi[3]*pn]}(H,t,O,l.tilePixelRatio),Ge=H.get("text-max-angle")/180*Math.PI,ht=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Qe=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",it=H.get("symbol-placement"),bt=q/2,pt=H.get("icon-text-fit");let Tt;d&&pt!=="none"&&(l.allowVerticalPlacement&&a.vertical&&(Tt=Tm(d,a.vertical,pt,H.get("icon-text-fit-padding"),W,oe)),J&&(d=Tm(d,J,pt,H.get("icon-text-fit-padding"),W,oe)));const at=O?F.line.getGranularityForZoomLevel(O.z):1,Ft=(Yt,Vt)=>{Vt.x<0||Vt.x>=wt||Vt.y<0||Vt.y>=wt||function(jt,pn,xi,Zi,$i,Ns,ba,or,Fi,Ar,vr,Pr,wa,Ta,lr,Sa,Yi,xr,cr,ur,Mi,hs,r,u,m){const b=jt.addToLineVertexArray(pn,xi);let M,z,X,re,Se=0,Xe=0,dt=0,vt=0,et=-1,nt=-1;const rn={};let ln=Zr("");if(jt.allowVerticalPlacement&&Zi.vertical){const Za=or.layout.get("text-rotate").evaluate(Mi,{},u)+90;X=new us(Fi,pn,Ar,vr,Pr,Zi.vertical,wa,Ta,lr,Za),ba&&(re=new us(Fi,pn,Ar,vr,Pr,ba,Yi,xr,lr,Za))}if($i){const Za=or.layout.get("icon-rotate").evaluate(Mi,{}),Ko=or.layout.get("icon-text-fit")!=="none",yp=Rm($i,Za,r,Ko),Oc=ba?Rm(ba,Za,r,Ko):void 0;z=new us(Fi,pn,Ar,vr,Pr,$i,Yi,xr,!1,Za),Se=4*yp.length;const _p=jt.iconSizeData;let Du=null;_p.kind==="source"?(Du=[_o*or.layout.get("icon-size").evaluate(Mi,{})],Du[0]>Pl&&qn(`${jt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):_p.kind==="composite"&&(Du=[_o*hs.compositeIconSizes[0].evaluate(Mi,{},u),_o*hs.compositeIconSizes[1].evaluate(Mi,{},u)],(Du[0]>Pl||Du[1]>Pl)&&qn(`${jt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),jt.addSymbols(jt.icon,yp,Du,ur,cr,Mi,v.an.none,pn,b.lineStartIndex,b.lineLength,-1,u),et=jt.icon.placedSymbolArray.length-1,Oc&&(Xe=4*Oc.length,jt.addSymbols(jt.icon,Oc,Du,ur,cr,Mi,v.an.vertical,pn,b.lineStartIndex,b.lineLength,-1,u),nt=jt.icon.placedSymbolArray.length-1)}const bi=Object.keys(Zi.horizontal);for(const Za of bi){const Ko=Zi.horizontal[Za];if(!M){ln=Zr(Ko.text);const Oc=or.layout.get("text-rotate").evaluate(Mi,{},u);M=new us(Fi,pn,Ar,vr,Pr,Ko,wa,Ta,lr,Oc)}const yp=Ko.positionedLines.length===1;if(dt+=Rh(jt,pn,Ko,Ns,or,lr,Mi,Sa,b,Zi.vertical?v.an.horizontal:v.an.horizontalOnly,yp?bi:[Za],rn,et,hs,u),yp)break}Zi.vertical&&(vt+=Rh(jt,pn,Zi.vertical,Ns,or,lr,Mi,Sa,b,v.an.vertical,["vertical"],rn,nt,hs,u));const Be=M?M.boxStartIndex:jt.collisionBoxArray.length,Ne=M?M.boxEndIndex:jt.collisionBoxArray.length,He=X?X.boxStartIndex:jt.collisionBoxArray.length,yt=X?X.boxEndIndex:jt.collisionBoxArray.length,$t=z?z.boxStartIndex:jt.collisionBoxArray.length,Ln=z?z.boxEndIndex:jt.collisionBoxArray.length,nn=re?re.boxStartIndex:jt.collisionBoxArray.length,dn=re?re.boxEndIndex:jt.collisionBoxArray.length;let Ci=-1;const Hn=(Za,Ko)=>Za&&Za.circleDiameter?Math.max(Za.circleDiameter,Ko):Ko;Ci=Hn(M,Ci),Ci=Hn(X,Ci),Ci=Hn(z,Ci),Ci=Hn(re,Ci);const Lc=Ci>-1?1:0;Lc&&(Ci*=m/sr),jt.glyphOffsetArray.length>=Tu.MAX_GLYPHS&&qn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mi.sortKey!==void 0&&jt.addToSortKeyRanges(jt.symbolInstances.length,Mi.sortKey);const Gv=jl(or,Mi,u),[cE,uE]=function(Za,Ko){const yp=Za.length,Oc=Ko==null?void 0:Ko.values;if((Oc==null?void 0:Oc.length)>0)for(let _p=0;_p<Oc.length;_p+=2){const Du=Oc[_p+1];Za.emplaceBack(v.aD[Oc[_p]],Du[0],Du[1])}return[yp,Za.length]}(jt.textAnchorOffsets,Gv);jt.symbolInstances.emplaceBack(pn.x,pn.y,rn.right>=0?rn.right:-1,rn.center>=0?rn.center:-1,rn.left>=0?rn.left:-1,rn.vertical||-1,et,nt,ln,Be,Ne,He,yt,$t,Ln,nn,dn,Ar,dt,vt,Se,Xe,Lc,0,wa,Ci,cE,uE)}(l,Vt,Yt,a,d,y,Tt,l.layers[0],l.collisionBoxArray,t.index,t.sourceLayerIndex,l.index,fe,[se,se,se,se],ht,k,xe,we,Qe,W,t,T,N,O,S)};if(it==="line")for(const Yt of Im(t.geometry,0,0,wt,wt)){const Vt=vu(Yt,at),jt=Eu(Vt,q,Ge,a.vertical||J,d,24,ke,l.overscaling,wt);for(const pn of jt)J&&Vv(l,J.text,bt,pn)||Ft(Vt,pn)}else if(it==="line-center"){for(const Yt of t.geometry)if(Yt.length>1){const Vt=vu(Yt,at),jt=Fv(Vt,Ge,a.vertical||J,d,24,ke);jt&&Ft(Vt,jt)}}else if(t.type==="Polygon")for(const Yt of pd(t.geometry,0)){const Vt=w0(Yt,16);Ft(vu(Yt[0],at,!0),new Su(Vt.x,Vt.y,0))}else if(t.type==="LineString")for(const Yt of t.geometry){const Vt=vu(Yt,at);Ft(Vt,new Su(Vt[0].x,Vt[0].y,0))}else if(t.type==="Point")for(const Yt of t.geometry)for(const Vt of Yt)Ft([Vt],new Su(Vt.x,Vt.y,0))}function Rh(l,t,a,d,y,T,S,A,k,N,O,F,$,H,W){const J=function(ke,xe,q,se,we,Ge,ht,Qe){const it=se.layout.get("text-rotate").evaluate(Ge,{})*Math.PI/180,bt=[];for(const pt of xe.positionedLines)for(const Tt of pt.positionedGlyphs){if(!Tt.rect)continue;const at=Tt.rect||{};let Ft=4,Yt=!0,Vt=1,jt=0;const pn=(we||Qe)&&Tt.vertical,xi=Tt.metrics.advance*Tt.scale/2;if(Qe&&xe.verticalizable&&(jt=pt.lineOffset/2-(Tt.imageName?-(sr-Tt.metrics.width*Tt.scale)/2:(Tt.scale-1)*sr)),Tt.imageName){const xr=ht[Tt.imageName];Yt=xr.sdf,Vt=xr.pixelRatio,Ft=1/Vt}const Zi=we?[Tt.x+xi,Tt.y]:[0,0];let $i=we?[0,0]:[Tt.x+xi+q[0],Tt.y+q[1]-jt],Ns=[0,0];pn&&(Ns=$i,$i=[0,0]);const ba=Tt.metrics.isDoubleResolution?2:1,or=(Tt.metrics.left-Ft)*Tt.scale-xi+$i[0],Fi=(-Tt.metrics.top-Ft)*Tt.scale+$i[1],Ar=or+at.w/ba*Tt.scale/Vt,vr=Fi+at.h/ba*Tt.scale/Vt,Pr=new ne(or,Fi),wa=new ne(Ar,Fi),Ta=new ne(or,vr),lr=new ne(Ar,vr);if(pn){const xr=new ne(-xi,xi- -17),cr=-Math.PI/2,ur=12-xi,Mi=new ne(22-ur,-(Tt.imageName?ur:0)),hs=new ne(...Ns);Pr._rotateAround(cr,xr)._add(Mi)._add(hs),wa._rotateAround(cr,xr)._add(Mi)._add(hs),Ta._rotateAround(cr,xr)._add(Mi)._add(hs),lr._rotateAround(cr,xr)._add(Mi)._add(hs)}if(it){const xr=Math.sin(it),cr=Math.cos(it),ur=[cr,-xr,xr,cr];Pr._matMult(ur),wa._matMult(ur),Ta._matMult(ur),lr._matMult(ur)}const Sa=new ne(0,0),Yi=new ne(0,0);bt.push({tl:Pr,tr:wa,bl:Ta,br:lr,tex:at,writingMode:xe.writingMode,glyphOffset:Zi,sectionIndex:Tt.sectionIndex,isSDF:Yt,pixelOffsetTL:Sa,pixelOffsetBR:Yi,minFontScaleX:0,minFontScaleY:0})}return bt}(0,a,A,y,T,S,d,l.allowVerticalPlacement),oe=l.textSizeData;let fe=null;oe.kind==="source"?(fe=[_o*y.layout.get("text-size").evaluate(S,{})],fe[0]>Pl&&qn(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):oe.kind==="composite"&&(fe=[_o*H.compositeTextSizes[0].evaluate(S,{},W),_o*H.compositeTextSizes[1].evaluate(S,{},W)],(fe[0]>Pl||fe[1]>Pl)&&qn(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,J,fe,A,T,S,N,t,k.lineStartIndex,k.lineLength,$,W);for(const ke of O)F[ke]=l.text.placedSymbolArray.length-1;return 4*J.length}function My(l){for(const t in l)return l[t];return null}function Vv(l,t,a,d){const y=l.compareText;if(t in y){const T=y[t];for(let S=T.length-1;S>=0;S--)if(d.dist(T[S])<a)return!0}else y[t]=[];return y[t].push(d),!1}const S0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Cy{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,d]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=d>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const T=S0[15&d];if(!T)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(t,2,1),[A]=new Uint32Array(t,4,1);return new Cy(A,S,T,t)}constructor(t,a=64,d=Float64Array,y){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=d,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const T=S0.indexOf(this.ArrayType),S=2*t*this.ArrayType.BYTES_PER_ELEMENT,A=t*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-A%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${d}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+k,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+S+A+k),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+k,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=t,this.coords[this._pos++]=a,d}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Dy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,d,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:S,nodeSize:A}=this,k=[0,T.length-1,0],N=[];for(;k.length;){const O=k.pop()||0,F=k.pop()||0,$=k.pop()||0;if(F-$<=A){for(let oe=$;oe<=F;oe++){const fe=S[2*oe],ke=S[2*oe+1];fe>=t&&fe<=d&&ke>=a&&ke<=y&&N.push(T[oe])}continue}const H=$+F>>1,W=S[2*H],J=S[2*H+1];W>=t&&W<=d&&J>=a&&J<=y&&N.push(T[H]),(O===0?t<=W:a<=J)&&(k.push($),k.push(H-1),k.push(1-O)),(O===0?d>=W:y>=J)&&(k.push(H+1),k.push(F),k.push(1-O))}return N}within(t,a,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:T,nodeSize:S}=this,A=[0,y.length-1,0],k=[],N=d*d;for(;A.length;){const O=A.pop()||0,F=A.pop()||0,$=A.pop()||0;if(F-$<=S){for(let oe=$;oe<=F;oe++)Iy(T[2*oe],T[2*oe+1],t,a)<=N&&k.push(y[oe]);continue}const H=$+F>>1,W=T[2*H],J=T[2*H+1];Iy(W,J,t,a)<=N&&k.push(y[H]),(O===0?t-d<=W:a-d<=J)&&(A.push($),A.push(H-1),A.push(1-O)),(O===0?t+d>=W:a+d>=J)&&(A.push(H+1),A.push(F),A.push(1-O))}return k}}function Dy(l,t,a,d,y,T){if(y-d<=a)return;const S=d+y>>1;E0(l,t,S,d,y,T),Dy(l,t,a,d,S-1,1-T),Dy(l,t,a,S+1,y,1-T)}function E0(l,t,a,d,y,T){for(;y>d;){if(y-d>600){const N=y-d+1,O=a-d+1,F=Math.log(N),$=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*$*(N-$)/N)*(O-N/2<0?-1:1);E0(l,t,a,Math.max(d,Math.floor(a-O*$/N+H)),Math.min(y,Math.floor(a+(N-O)*$/N+H)),T)}const S=t[2*a+T];let A=d,k=y;for(gp(l,t,d,a),t[2*y+T]>S&&gp(l,t,d,y);A<k;){for(gp(l,t,A,k),A++,k--;t[2*A+T]<S;)A++;for(;t[2*k+T]>S;)k--}t[2*d+T]===S?gp(l,t,d,k):(k++,gp(l,t,k,y)),k<=a&&(d=k+1),a<=k&&(y=k-1)}}function gp(l,t,a,d){ky(l,a,d),ky(t,2*a,2*d),ky(t,2*a+1,2*d+1)}function ky(l,t,a){const d=l[t];l[t]=l[a],l[a]=d}function Iy(l,t,a,d){const y=l-a,T=t-d;return y*y+T*T}var Au;v.cw=void 0,(Au=v.cw||(v.cw={})).create="create",Au.load="load",Au.fullLoad="fullLoad";let Mu=null,Wd=[];const Ry=1e3/60,Cu="loadTime",zh="fullLoadTime",A0={mark(l){performance.mark(l)},frame(l){const t=l;Mu!=null&&Wd.push(t-Mu),Mu=t},clearMetrics(){Mu=null,Wd=[],performance.clearMeasures(Cu),performance.clearMeasures(zh);for(const l in v.cw)performance.clearMarks(v.cw[l])},getPerformanceMetrics(){performance.measure(Cu,v.cw.create,v.cw.load),performance.measure(zh,v.cw.create,v.cw.fullLoad);const l=performance.getEntriesByName(Cu)[0].duration,t=performance.getEntriesByName(zh)[0].duration,a=Wd.length,d=1/(Wd.reduce((T,S)=>T+S,0)/a/1e3),y=Wd.filter(T=>T>Ry).reduce((T,S)=>T+(S-Ry)/Ry,0);return{loadTime:l,fullLoadTime:t,fps:d,percentDroppedFrames:y/(a+y)*100,totalFrames:a}}};v.$=wt,v.A=Ve,v.B=function([l,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:l*Math.cos(t)*Math.sin(a),y:l*Math.sin(t)*Math.sin(a),z:l*Math.cos(a)}},v.C=za,v.D=Ot,v.E=lt,v.F=pi,v.G=gh,v.H=function(l){if(Yr==null){const t=l.navigator?l.navigator.userAgent:null;Yr=!!l.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Yr},v.I=ry,v.J=class{constructor(l,t){this.target=l,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Mm(()=>this.process()),this.subscription=Hr(this.target,"message",a=>this.receive(a),!1),this.globalScope=Or(self)?l:window}registerMessageHandler(l,t){this.messageHandlers[l]=t}sendAsync(l,t){return new Promise((a,d)=>{const y=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=t?Hr(t.signal,"abort",()=>{T==null||T.unsubscribe(),delete this.resolveRejects[y];const k={id:y,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(k)},my):null;this.resolveRejects[y]={resolve:k=>{T==null||T.unsubscribe(),a(k)},reject:k=>{T==null||T.unsubscribe(),d(k)}};const S=[],A=Object.assign(Object.assign({},l),{id:y,sourceMapId:this.mapId,origin:location.origin,data:du(l.data,S)});this.target.postMessage(A,{transfer:S})})}receive(l){const t=l.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const d=this.abortControllers[a];return delete this.abortControllers[a],void(d&&d.abort())}if(Or(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),t=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(l,t)}processTask(l,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const y=this.resolveRejects[l];return delete this.resolveRejects[l],y?void(t.error?y.reject(Ua(t.error)):y.resolve(Ua(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=Ua(t.data),d=new AbortController;this.abortControllers[l]=d;try{const y=yield this.messageHandlers[t.type](t.sourceMapId,a,d);this.completeTask(l,null,y)}catch(y){this.completeTask(l,y)}})}completeTask(l,t,a){const d=[];delete this.abortControllers[l];const y={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?du(t):null,data:du(a,d)};this.target.postMessage(y,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.K=le,v.L=function(){var l=new Ve(16);return Ve!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},v.M=function(l,t,a){var d,y,T,S,A,k,N,O,F,$,H,W,J=a[0],oe=a[1],fe=a[2];return t===l?(l[12]=t[0]*J+t[4]*oe+t[8]*fe+t[12],l[13]=t[1]*J+t[5]*oe+t[9]*fe+t[13],l[14]=t[2]*J+t[6]*oe+t[10]*fe+t[14],l[15]=t[3]*J+t[7]*oe+t[11]*fe+t[15]):(y=t[1],T=t[2],S=t[3],A=t[4],k=t[5],N=t[6],O=t[7],F=t[8],$=t[9],H=t[10],W=t[11],l[0]=d=t[0],l[1]=y,l[2]=T,l[3]=S,l[4]=A,l[5]=k,l[6]=N,l[7]=O,l[8]=F,l[9]=$,l[10]=H,l[11]=W,l[12]=d*J+A*oe+F*fe+t[12],l[13]=y*J+k*oe+$*fe+t[13],l[14]=T*J+N*oe+H*fe+t[14],l[15]=S*J+O*oe+W*fe+t[15]),l},v.N=function(l,t,a){var d=a[0],y=a[1],T=a[2];return l[0]=t[0]*d,l[1]=t[1]*d,l[2]=t[2]*d,l[3]=t[3]*d,l[4]=t[4]*y,l[5]=t[5]*y,l[6]=t[6]*y,l[7]=t[7]*y,l[8]=t[8]*T,l[9]=t[9]*T,l[10]=t[10]*T,l[11]=t[11]*T,l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15],l},v.O=function(l,t,a){var d=t[0],y=t[1],T=t[2],S=t[3],A=t[4],k=t[5],N=t[6],O=t[7],F=t[8],$=t[9],H=t[10],W=t[11],J=t[12],oe=t[13],fe=t[14],ke=t[15],xe=a[0],q=a[1],se=a[2],we=a[3];return l[0]=xe*d+q*A+se*F+we*J,l[1]=xe*y+q*k+se*$+we*oe,l[2]=xe*T+q*N+se*H+we*fe,l[3]=xe*S+q*O+se*W+we*ke,l[4]=(xe=a[4])*d+(q=a[5])*A+(se=a[6])*F+(we=a[7])*J,l[5]=xe*y+q*k+se*$+we*oe,l[6]=xe*T+q*N+se*H+we*fe,l[7]=xe*S+q*O+se*W+we*ke,l[8]=(xe=a[8])*d+(q=a[9])*A+(se=a[10])*F+(we=a[11])*J,l[9]=xe*y+q*k+se*$+we*oe,l[10]=xe*T+q*N+se*H+we*fe,l[11]=xe*S+q*O+se*W+we*ke,l[12]=(xe=a[12])*d+(q=a[13])*A+(se=a[14])*F+(we=a[15])*J,l[13]=xe*y+q*k+se*$+we*oe,l[14]=xe*T+q*N+se*H+we*fe,l[15]=xe*S+q*O+se*W+we*ke,l},v.P=ne,v.Q=function(l,t){const a={};for(let d=0;d<t.length;d++){const y=t[d];y in l&&(a[y]=l[y])}return a},v.R=fa,v.S=Ll,v.T=dm,v.U=gy,v.V=Ih,v.W=Je,v.X=$e,v.Y=gs,v.Z=_i,v._=c,v.a=ee,v.a$=function(l,t,a){return l[0]=t[0]*a,l[1]=t[1]*a,l[2]=t[2]*a,l[3]=t[3]*a,l},v.a0=qd,v.a1=Pc,v.a2=25,v.a3=fi,v.a4=l=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const d of l){const y=window.document.createElement("source");Ze(d)||(t.crossOrigin="Anonymous"),y.src=d,t.appendChild(y)}})},v.a5=St,v.a6=function(){return Xa++},v.a7=ue,v.a8=Tu,v.a9=Wi,v.aA=sr,v.aB=Mt,v.aC=function(l,t,a,d,y=!1){if(!a[0]&&!a[1])return[0,0];const T=y?d==="map"?-l.bearingInRadians:0:d==="viewport"?l.bearingInRadians:0;if(T){const S=Math.sin(T),A=Math.cos(T);a=[a[0]*A-a[1]*S,a[0]*S+a[1]*A]}return[y?a[0]:Mt(t,a[0],l.zoom),y?a[1]:Mt(t,a[1],l.zoom)]},v.aE=vo,v.aF=Ay,v.aG=yi,v.aH=Cy,v.aI=Ni,v.aJ=Jf,v.aK=Fe,v.aL=Rn,v.aM=ni,v.aN=Ca,v.aO=dr,v.aP=_y,v.aQ=Ut,v.aR=Lt,v.aS=function(l){var t=new Ve(3);return t[0]=l[0],t[1]=l[1],t[2]=l[2],t},v.aT=function(l,t,a){return l[0]=t[0]-a[0],l[1]=t[1]-a[1],l[2]=t[2]-a[2],l},v.aU=function(l,t){var a=t[0],d=t[1],y=t[2],T=a*a+d*d+y*y;return T>0&&(T=1/Math.sqrt(T)),l[0]=t[0]*T,l[1]=t[1]*T,l[2]=t[2]*T,l},v.aV=sn,v.aW=function(l,t){return l[0]*t[0]+l[1]*t[1]+l[2]*t[2]},v.aX=function(l,t,a){return l[0]=t[0]*a[0],l[1]=t[1]*a[1],l[2]=t[2]*a[2],l[3]=t[3]*a[3],l},v.aY=mt,v.aZ=function(l,t,a){const d=t[0]*a[0]+t[1]*a[1]+t[2]*a[2];return d===0?null:(-(l[0]*a[0]+l[1]*a[1]+l[2]*a[2])-a[3])/d},v.a_=Ye,v.aa=yu,v.ab=pp,v.ac=function(l){const t={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,d,y,T)=>{const S=y||T;return t[d]=!S||S.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},v.ad=ci,v.ae=function(l){return Math.pow(2,l)},v.af=ot,v.ag=Gn,v.ah=85.051129,v.ai=_0,v.aj=function(l){return Math.log(l)/Math.LN2},v.ak=function(l){var t=l[0],a=l[1];return t*t+a*a},v.al=function(l,t){const a=[];for(const d in l)d in t||a.push(d);return a},v.am=function(l,t){let a=0,d=0;if(l.kind==="constant")d=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:y,minZoom:T,maxZoom:S}=l,A=y?Gn(Ur.interpolationFactor(y,t,T,S),0,1):0;l.kind==="camera"?d=za.number(l.minSize,l.maxSize,A):a=A}return{uSizeT:a,uSize:d}},v.ao=function(l,{uSize:t,uSizeT:a},{lowerSize:d,upperSize:y}){return l.kind==="source"?d/_o:l.kind==="composite"?za.number(d/_o,y/_o,a):t},v.ap=function(l,t){var a=t[0],d=t[1],y=t[2],T=t[3],S=t[4],A=t[5],k=t[6],N=t[7],O=t[8],F=t[9],$=t[10],H=t[11],W=t[12],J=t[13],oe=t[14],fe=t[15],ke=a*A-d*S,xe=a*k-y*S,q=a*N-T*S,se=d*k-y*A,we=d*N-T*A,Ge=y*N-T*k,ht=O*J-F*W,Qe=O*oe-$*W,it=O*fe-H*W,bt=F*oe-$*J,pt=F*fe-H*J,Tt=$*fe-H*oe,at=ke*Tt-xe*pt+q*bt+se*it-we*Qe+Ge*ht;return at?(l[0]=(A*Tt-k*pt+N*bt)*(at=1/at),l[1]=(y*pt-d*Tt-T*bt)*at,l[2]=(J*Ge-oe*we+fe*se)*at,l[3]=($*we-F*Ge-H*se)*at,l[4]=(k*it-S*Tt-N*Qe)*at,l[5]=(a*Tt-y*it+T*Qe)*at,l[6]=(oe*q-W*Ge-fe*xe)*at,l[7]=(O*Ge-$*q+H*xe)*at,l[8]=(S*pt-A*it+N*ht)*at,l[9]=(d*it-a*pt-T*ht)*at,l[10]=(W*we-J*q+fe*ke)*at,l[11]=(F*q-O*we-H*ke)*at,l[12]=(A*Qe-S*bt-k*ht)*at,l[13]=(a*bt-d*Qe+y*ht)*at,l[14]=(J*xe-W*se-oe*ke)*at,l[15]=(O*se-F*xe+$*ke)*at,l):null},v.aq=Ce,v.ar=function(l){return Math.hypot(l[0],l[1])},v.as=function(l){return l[0]=0,l[1]=0,l},v.at=function(l,t,a){return l[0]=t[0]*a,l[1]=t[1]*a,l},v.au=Sm,v.av=gt,v.aw=function(l,t,a,d){const y=t.y-l.y,T=t.x-l.x,S=d.y-a.y,A=d.x-a.x,k=S*T-A*y;if(k===0)return null;const N=(A*(l.y-a.y)-S*(l.x-a.x))/k;return new ne(l.x+N*T,l.y+N*y)},v.ax=Im,v.ay=Dg,v.az=function(l){let t=1/0,a=1/0,d=-1/0,y=-1/0;for(const T of l)t=Math.min(t,T.x),a=Math.min(a,T.y),d=Math.max(d,T.x),y=Math.max(y,T.y);return[t,a,d,y]},v.b=qr,v.b$=o0,v.b0=function(l,t){return l[0]*t[0]+l[1]*t[1]+l[2]*t[2]+l[3]},v.b1=Dm,v.b2=Hd,v.b3=function(l,t,a,d,y){var T,S=1/Math.tan(t/2);return l[0]=S/a,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=S,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,y!=null&&y!==1/0?(l[10]=(y+d)*(T=1/(d-y)),l[14]=2*y*d*T):(l[10]=-1,l[14]=-2*d),l},v.b4=function(l){var t=new Ve(16);return t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=l[3],t[4]=l[4],t[5]=l[5],t[6]=l[6],t[7]=l[7],t[8]=l[8],t[9]=l[9],t[10]=l[10],t[11]=l[11],t[12]=l[12],t[13]=l[13],t[14]=l[14],t[15]=l[15],t},v.b5=function(l,t,a){var d=Math.sin(a),y=Math.cos(a),T=t[0],S=t[1],A=t[2],k=t[3],N=t[4],O=t[5],F=t[6],$=t[7];return t!==l&&(l[8]=t[8],l[9]=t[9],l[10]=t[10],l[11]=t[11],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[0]=T*y+N*d,l[1]=S*y+O*d,l[2]=A*y+F*d,l[3]=k*y+$*d,l[4]=N*y-T*d,l[5]=O*y-S*d,l[6]=F*y-A*d,l[7]=$*y-k*d,l},v.b6=function(l,t,a){var d=Math.sin(a),y=Math.cos(a),T=t[4],S=t[5],A=t[6],k=t[7],N=t[8],O=t[9],F=t[10],$=t[11];return t!==l&&(l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[3],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[4]=T*y+N*d,l[5]=S*y+O*d,l[6]=A*y+F*d,l[7]=k*y+$*d,l[8]=N*y-T*d,l[9]=O*y-S*d,l[10]=F*y-A*d,l[11]=$*y-k*d,l},v.b7=function(){const l=new Float32Array(16);return ot(l),l},v.b8=function(){const l=new Float64Array(16);return ot(l),l},v.b9=function(){return new Float64Array(16)},v.bA=function(l){return l[0]=0,l[1]=0,l[2]=0,l},v.bB=function(l,t,a,d){const y=Math.sqrt(l*l+t*t),T=Math.sqrt(a*a+d*d);l/=y,t/=y,a/=T,d/=T;const S=Math.acos(l*a+t*d);return-t*a+l*d>0?S:-S},v.bC=function(l,t){const a=Rt(l,2*Math.PI),d=Rt(t,2*Math.PI);return Math.min(Math.abs(a-d),Math.abs(a-d+2*Math.PI),Math.abs(a-d-2*Math.PI))},v.bD=function(){const l={},t=Ae.$version;for(const a in Ae.$root){const d=Ae.$root[a];if(d.required){let y=null;y=a==="version"?t:d.type==="array"?[]:{},y!=null&&(l[a]=y)}}return l},v.bE=_h,v.bF=De,v.bG=function l(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let d=0;d<t.length;d++)if(!l(t[d],a[d]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const d in t)if(!l(t[d],a[d]))return!1;return!0}return t===a},v.bH=function(l){l=l.slice();const t=Object.create(null);for(let a=0;a<l.length;a++)t[l[a].id]=l[a];for(let a=0;a<l.length;a++)"ref"in l[a]&&(l[a]=Kt(l[a],t[l[a].ref]));return l},v.bI=function(l){if(l.type==="custom")return new py(l);switch(l.type){case"background":return new hp(l);case"circle":return new om(l);case"color-relief":return new fm(l);case"fill":return new zl(l);case"fill-extrusion":return new bu(l);case"heatmap":return new Q_(l);case"hillshade":return new Ac(l);case"line":return new Qg(l);case"raster":return new Fn(l);case"symbol":return new $d(l)}},v.bJ=Pn,v.bK=function(l,t){if(!l)return[{command:"setStyle",args:[t]}];let a=[];try{if(!Pt(l.version,t.version))return[{command:"setStyle",args:[t]}];Pt(l.center,t.center)||a.push({command:"setCenter",args:[t.center]}),Pt(l.state,t.state)||a.push({command:"setGlobalState",args:[t.state]}),Pt(l.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Pt(l.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),Pt(l.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),Pt(l.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),Pt(l.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),Pt(l.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),Pt(l.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),Pt(l.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),Pt(l.light,t.light)||a.push({command:"setLight",args:[t.light]}),Pt(l.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),Pt(l.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),Pt(l.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const d={},y=[];(function(S,A,k,N){let O;for(O in A=A||{},S=S||{})Object.prototype.hasOwnProperty.call(S,O)&&(Object.prototype.hasOwnProperty.call(A,O)||xn(O,k,N));for(O in A)Object.prototype.hasOwnProperty.call(A,O)&&(Object.prototype.hasOwnProperty.call(S,O)?Pt(S[O],A[O])||(S[O].type==="geojson"&&A[O].type==="geojson"&&Dn(S,A,O)?Gt(k,{command:"setGeoJSONSourceData",args:[O,A[O].data]}):yn(O,A,k,N)):Qt(O,A,k))})(l.sources,t.sources,y,d);const T=[];l.layers&&l.layers.forEach(S=>{"source"in S&&d[S.source]?a.push({command:"removeLayer",args:[S.id]}):T.push(S)}),a=a.concat(y),function(S,A,k){A=A||[];const N=(S=S||[]).map(In),O=A.map(In),F=S.reduce(Ir,{}),$=A.reduce(Ir,{}),H=N.slice(),W=Object.create(null);let J,oe,fe,ke,xe;for(let q=0,se=0;q<N.length;q++)J=N[q],Object.prototype.hasOwnProperty.call($,J)?se++:(Gt(k,{command:"removeLayer",args:[J]}),H.splice(H.indexOf(J,se),1));for(let q=0,se=0;q<O.length;q++)J=O[O.length-1-q],H[H.length-1-q]!==J&&(Object.prototype.hasOwnProperty.call(F,J)?(Gt(k,{command:"removeLayer",args:[J]}),H.splice(H.lastIndexOf(J,H.length-se),1)):se++,ke=H[H.length-q],Gt(k,{command:"addLayer",args:[$[J],ke]}),H.splice(H.length-q,0,J),W[J]=!0);for(let q=0;q<O.length;q++)if(J=O[q],oe=F[J],fe=$[J],!W[J]&&!Pt(oe,fe))if(Pt(oe.source,fe.source)&&Pt(oe["source-layer"],fe["source-layer"])&&Pt(oe.type,fe.type)){for(xe in en(oe.layout,fe.layout,k,J,null,"setLayoutProperty"),en(oe.paint,fe.paint,k,J,null,"setPaintProperty"),Pt(oe.filter,fe.filter)||Gt(k,{command:"setFilter",args:[J,fe.filter]}),Pt(oe.minzoom,fe.minzoom)&&Pt(oe.maxzoom,fe.maxzoom)||Gt(k,{command:"setLayerZoomRange",args:[J,fe.minzoom,fe.maxzoom]}),oe)Object.prototype.hasOwnProperty.call(oe,xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?en(oe[xe],fe[xe],k,J,xe.slice(6),"setPaintProperty"):Pt(oe[xe],fe[xe])||Gt(k,{command:"setLayerProperty",args:[J,xe,fe[xe]]}));for(xe in fe)Object.prototype.hasOwnProperty.call(fe,xe)&&!Object.prototype.hasOwnProperty.call(oe,xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?en(oe[xe],fe[xe],k,J,xe.slice(6),"setPaintProperty"):Pt(oe[xe],fe[xe])||Gt(k,{command:"setLayerProperty",args:[J,xe,fe[xe]]}))}else Gt(k,{command:"removeLayer",args:[J]}),ke=H[H.lastIndexOf(J)+1],Gt(k,{command:"addLayer",args:[fe,ke]})}(T,t.layers,a)}catch(d){console.warn("Unable to compute style diff:",d),a=[{command:"setStyle",args:[t]}]}return a},v.bL=function(l){const t=[],a=l.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),l.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},v.bM=Xn,v.bN=br,v.bO=class extends ri{constructor(l,t){super(l,t),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},v.bP=bh,v.bQ=class extends ri{constructor(l,t){super(l,t),this.current=nm}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let t=1;t<16;t++)if(l[t]!==this.current[t]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},v.bR=Vi,v.bS=class extends ri{constructor(l,t){super(l,t),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},v.bT=class extends ri{constructor(l,t){super(l,t),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},v.bU=ct,v.bV=function(l,t){var a=Math.sin(t),d=Math.cos(t);return l[0]=d,l[1]=a,l[2]=0,l[3]=-a,l[4]=d,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},v.bW=function(l,t,a){var d=t[0],y=t[1],T=t[2];return l[0]=d*a[0]+y*a[3]+T*a[6],l[1]=d*a[1]+y*a[4]+T*a[7],l[2]=d*a[2]+y*a[5]+T*a[8],l},v.bX=function(l,t,a,d,y,T,S){var A=1/(t-a),k=1/(d-y),N=1/(T-S);return l[0]=-2*A,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*k,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*N,l[11]=0,l[12]=(t+a)*A,l[13]=(y+d)*k,l[14]=(S+T)*N,l[15]=1,l},v.bY=class extends ri{constructor(l,t){super(l,t),this.current=new Array}set(l){if(l!=this.current){this.current=l;const t=new Float32Array(4*l.length);for(let a=0;a<l.length;a++)t[4*a]=l[a].r,t[4*a+1]=l[a].g,t[4*a+2]=l[a].b,t[4*a+3]=l[a].a;this.gl.uniform4fv(this.location,t)}}},v.bZ=class extends ri{constructor(l,t){super(l,t),this.current=new Array}set(l){if(l!=this.current){this.current=l;const t=new Float32Array(l);this.gl.uniform1fv(this.location,t)}}},v.b_=class extends f{},v.ba=function(l,t,a){const d=new Float64Array(4);return qt(d,l,t-90,a),d},v.bb=function(l,t,a,d){var y,T,S,A,k,N=t[0],O=t[1],F=t[2],$=t[3],H=a[0],W=a[1],J=a[2],oe=a[3];return(T=N*H+O*W+F*J+$*oe)<0&&(T=-T,H=-H,W=-W,J=-J,oe=-oe),1-T>Me?(y=Math.acos(T),S=Math.sin(y),A=Math.sin((1-d)*y)/S,k=Math.sin(d*y)/S):(A=1-d,k=d),l[0]=A*N+k*H,l[1]=A*O+k*W,l[2]=A*F+k*J,l[3]=A*$+k*oe,l},v.bc=function(l){const t=new Float64Array(9);var a,d,y,T,S,A,k,N,O,F,$,H,W,J,oe,fe,ke,xe;F=(y=(d=l)[0])*(k=y+y),$=(T=d[1])*k,W=(S=d[2])*k,J=S*(N=T+T),fe=(A=d[3])*k,ke=A*N,xe=A*(O=S+S),(a=t)[0]=1-(H=T*N)-(oe=S*O),a[3]=$-xe,a[6]=W+ke,a[1]=$+xe,a[4]=1-F-oe,a[7]=J-fe,a[2]=W-ke,a[5]=J+fe,a[8]=1-F-H;const q=dr(-Math.asin(Gn(t[2],-1,1)));let se,we;return Math.hypot(t[5],t[8])<.001?(se=0,we=-dr(Math.atan2(t[3],t[4]))):(se=dr(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),we=dr(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:se,pitch:q+90,bearing:we}},v.bd=function(l,t){return l.roll==t.roll&&l.pitch==t.pitch&&l.bearing==t.bearing},v.be=mn,v.bf=Nr,v.bg=Ld,v.bh=Eh,v.bi=Sh,v.bj=Jt,v.bk=Wt,v.bl=hn,v.bm=function(l,t,a,d,y){return Jt(d,y,Gn((l-t)/(a-t),0,1))},v.bn=Rt,v.bo=function(){return new Float64Array(3)},v.bp=function(l,t,a,d){return l[0]=t[0]+a[0]*d,l[1]=t[1]+a[1]*d,l[2]=t[2]+a[2]*d,l},v.bq=qt,v.br=function(l,t,a){var d=a[0],y=a[1],T=a[2],S=t[0],A=t[1],k=t[2],N=y*k-T*A,O=T*S-d*k,F=d*A-y*S,$=y*F-T*O,H=T*N-d*F,W=d*O-y*N,J=2*a[3];return O*=J,F*=J,H*=2,W*=2,l[0]=S+(N*=J)+($*=2),l[1]=A+O+H,l[2]=k+F+W,l},v.bs=function(l,t,a){const d=(y=[l[0],l[1],l[2],t[0],t[1],t[2],a[0],a[1],a[2]])[0]*((O=y[8])*(S=y[4])-(A=y[5])*(N=y[7]))+y[1]*(-O*(T=y[3])+A*(k=y[6]))+y[2]*(N*T-S*k);var y,T,S,A,k,N,O;if(d===0)return null;const F=sn([],[t[0],t[1],t[2]],[a[0],a[1],a[2]]),$=sn([],[a[0],a[1],a[2]],[l[0],l[1],l[2]]),H=sn([],[l[0],l[1],l[2]],[t[0],t[1],t[2]]),W=Ut([],F,-l[3]);return Lt(W,W,Ut([],$,-t[3])),Lt(W,W,Ut([],H,-a[3])),Ut(W,W,1/d),W},v.bt=Cm,v.bu=function(){return new Float64Array(4)},v.bv=function(l,t,a,d){var y=[],T=[];return y[0]=t[0]-a[0],y[1]=t[1]-a[1],y[2]=t[2]-a[2],T[0]=y[0]*Math.cos(d)-y[1]*Math.sin(d),T[1]=y[0]*Math.sin(d)+y[1]*Math.cos(d),T[2]=y[2],l[0]=T[0]+a[0],l[1]=T[1]+a[1],l[2]=T[2]+a[2],l},v.bw=function(l,t,a,d){var y=[],T=[];return y[0]=t[0]-a[0],y[1]=t[1]-a[1],y[2]=t[2]-a[2],T[0]=y[0],T[1]=y[1]*Math.cos(d)-y[2]*Math.sin(d),T[2]=y[1]*Math.sin(d)+y[2]*Math.cos(d),l[0]=T[0]+a[0],l[1]=T[1]+a[1],l[2]=T[2]+a[2],l},v.bx=function(l,t,a,d){var y=[],T=[];return y[0]=t[0]-a[0],y[1]=t[1]-a[1],y[2]=t[2]-a[2],T[0]=y[2]*Math.sin(d)+y[0]*Math.cos(d),T[1]=y[1],T[2]=y[2]*Math.cos(d)-y[0]*Math.sin(d),l[0]=T[0]+a[0],l[1]=T[1]+a[1],l[2]=T[2]+a[2],l},v.by=function(l,t,a){var d=Math.sin(a),y=Math.cos(a),T=t[0],S=t[1],A=t[2],k=t[3],N=t[8],O=t[9],F=t[10],$=t[11];return t!==l&&(l[4]=t[4],l[5]=t[5],l[6]=t[6],l[7]=t[7],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[0]=T*y-N*d,l[1]=S*y-O*d,l[2]=A*y-F*d,l[3]=k*y-$*d,l[8]=T*d+N*y,l[9]=S*d+O*y,l[10]=A*d+F*y,l[11]=k*d+$*y,l},v.bz=function(l,t){const a=Rt(l,360),d=Rt(t,360),y=d-a,T=d>a?y-360:y+360;return Math.abs(y)<Math.abs(T)?y:T},v.c=Oe,v.c0=class extends w{},v.c1=Hf,v.c2=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},v.c3=qf,v.c4=function(l,t,a){var d=t[0],y=t[1],T=t[2],S=a[3]*d+a[7]*y+a[11]*T+a[15];return l[0]=(a[0]*d+a[4]*y+a[8]*T+a[12])/(S=S||1),l[1]=(a[1]*d+a[5]*y+a[9]*T+a[13])/S,l[2]=(a[2]*d+a[6]*y+a[10]*T+a[14])/S,l},v.c5=class extends xc{},v.c6=class extends V{},v.c7=function(l,t){return l[0]===t[0]&&l[1]===t[1]&&l[2]===t[2]&&l[3]===t[3]&&l[4]===t[4]&&l[5]===t[5]&&l[6]===t[6]&&l[7]===t[7]&&l[8]===t[8]&&l[9]===t[9]&&l[10]===t[10]&&l[11]===t[11]&&l[12]===t[12]&&l[13]===t[13]&&l[14]===t[14]&&l[15]===t[15]},v.c8=function(l,t){var a=l[0],d=l[1],y=l[2],T=l[3],S=l[4],A=l[5],k=l[6],N=l[7],O=l[8],F=l[9],$=l[10],H=l[11],W=l[12],J=l[13],oe=l[14],fe=l[15],ke=t[0],xe=t[1],q=t[2],se=t[3],we=t[4],Ge=t[5],ht=t[6],Qe=t[7],it=t[8],bt=t[9],pt=t[10],Tt=t[11],at=t[12],Ft=t[13],Yt=t[14],Vt=t[15];return Math.abs(a-ke)<=Me*Math.max(1,Math.abs(a),Math.abs(ke))&&Math.abs(d-xe)<=Me*Math.max(1,Math.abs(d),Math.abs(xe))&&Math.abs(y-q)<=Me*Math.max(1,Math.abs(y),Math.abs(q))&&Math.abs(T-se)<=Me*Math.max(1,Math.abs(T),Math.abs(se))&&Math.abs(S-we)<=Me*Math.max(1,Math.abs(S),Math.abs(we))&&Math.abs(A-Ge)<=Me*Math.max(1,Math.abs(A),Math.abs(Ge))&&Math.abs(k-ht)<=Me*Math.max(1,Math.abs(k),Math.abs(ht))&&Math.abs(N-Qe)<=Me*Math.max(1,Math.abs(N),Math.abs(Qe))&&Math.abs(O-it)<=Me*Math.max(1,Math.abs(O),Math.abs(it))&&Math.abs(F-bt)<=Me*Math.max(1,Math.abs(F),Math.abs(bt))&&Math.abs($-pt)<=Me*Math.max(1,Math.abs($),Math.abs(pt))&&Math.abs(H-Tt)<=Me*Math.max(1,Math.abs(H),Math.abs(Tt))&&Math.abs(W-at)<=Me*Math.max(1,Math.abs(W),Math.abs(at))&&Math.abs(J-Ft)<=Me*Math.max(1,Math.abs(J),Math.abs(Ft))&&Math.abs(oe-Yt)<=Me*Math.max(1,Math.abs(oe),Math.abs(Yt))&&Math.abs(fe-Vt)<=Me*Math.max(1,Math.abs(fe),Math.abs(Vt))},v.c9=function(l,t){return l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[3],l[4]=t[4],l[5]=t[5],l[6]=t[6],l[7]=t[7],l[8]=t[8],l[9]=t[9],l[10]=t[10],l[11]=t[11],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15],l},v.cA=function(l){delete ee.REGISTERED_PROTOCOLS[l]},v.cB=function(l,t){const a={};for(let y=0;y<l.length;y++){const T=t&&t[l[y].id]||vl(l[y]);t&&(t[l[y].id]=T);let S=a[T];S||(S=a[T]=[]),S.push(l[y])}const d=[];for(const y in a)d.push(a[y]);return d},v.cC=zt,v.cD=km,v.cE=vy,v.cF=ay,v.cG=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=wt/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const t=l.bucket.layers[0],a=t.layout,d=t._unevaluatedLayout._values,y={layoutIconSize:d["icon-size"].possiblyEvaluate(new pi(l.bucket.zoom+1),l.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new pi(l.bucket.zoom+1),l.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new pi(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:N,maxZoom:O}=l.bucket.textSizeData;y.compositeTextSizes=[d["text-size"].possiblyEvaluate(new pi(N),l.canonical),d["text-size"].possiblyEvaluate(new pi(O),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:N,maxZoom:O}=l.bucket.iconSizeData;y.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new pi(N),l.canonical),d["icon-size"].possiblyEvaluate(new pi(O),l.canonical)]}const T=a.get("text-line-height")*sr,S=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",A=a.get("text-keep-upright"),k=a.get("text-size");for(const N of l.bucket.features){const O=a.get("text-font").evaluate(N,{},l.canonical).join(","),F=k.evaluate(N,{},l.canonical),$=y.layoutTextSize.evaluate(N,{},l.canonical),H=y.layoutIconSize.evaluate(N,{},l.canonical),W={horizontal:{},vertical:void 0},J=N.text;let oe,fe=[0,0];if(J){const q=J.toString(),se=a.get("text-letter-spacing").evaluate(N,{},l.canonical)*sr,we=Go(q)?se:0,Ge=a.get("text-anchor").evaluate(N,{},l.canonical),ht=jl(t,N,l.canonical);if(!ht){const pt=a.get("text-radial-offset").evaluate(N,{},l.canonical);fe=pt?mp(Ge,[pt*sr,Pm]):a.get("text-offset").evaluate(N,{},l.canonical).map(Tt=>Tt*sr)}let Qe=S?"center":a.get("text-justify").evaluate(N,{},l.canonical);const it=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(N,{},l.canonical)*sr:1/0,bt=()=>{l.bucket.allowVerticalPlacement&&lo(q)&&(W.vertical=Dh(J,l.glyphMap,l.glyphPositions,l.imagePositions,O,it,T,Ge,"left",we,fe,v.an.vertical,!0,$,F))};if(!S&&ht){const pt=new Set;if(Qe==="auto")for(let at=0;at<ht.values.length;at+=2)pt.add(Ay(ht.values[at]));else pt.add(Qe);let Tt=!1;for(const at of pt)if(!W.horizontal[at])if(Tt)W.horizontal[at]=W.horizontal[0];else{const Ft=Dh(J,l.glyphMap,l.glyphPositions,l.imagePositions,O,it,T,"center",at,we,fe,v.an.horizontal,!1,$,F);Ft&&(W.horizontal[at]=Ft,Tt=Ft.positionedLines.length===1)}bt()}else{Qe==="auto"&&(Qe=Ay(Ge));const pt=Dh(J,l.glyphMap,l.glyphPositions,l.imagePositions,O,it,T,Ge,Qe,we,fe,v.an.horizontal,!1,$,F);pt&&(W.horizontal[Qe]=pt),bt(),lo(q)&&S&&A&&(W.vertical=Dh(J,l.glyphMap,l.glyphPositions,l.imagePositions,O,it,T,Ge,Qe,we,fe,v.an.vertical,!1,$,F))}}let ke=!1;if(N.icon&&N.icon.name){const q=l.imageMap[N.icon.name];q&&(oe=wm(l.imagePositions[N.icon.name],a.get("icon-offset").evaluate(N,{},l.canonical),a.get("icon-anchor").evaluate(N,{},l.canonical)),ke=!!q.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=ke:l.bucket.sdfIcons!==ke&&qn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(q.pixelRatio!==l.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const xe=My(W.horizontal)||W.vertical;l.bucket.iconsInText=!!xe&&xe.iconsInText,(xe||oe)&&Uv(l.bucket,N,W,oe,l.imageMap,y,$,H,fe,ke,l.canonical,l.subdivisionGranularity)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},v.cH=Fd,v.cI=Cc,v.cJ=Ga,v.cK=di,v.cL=xm,v.cM=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},v.cN=function(l,t,a,d,y){return c(this,void 0,void 0,function*(){if($e())try{return yield gs(l,t,a,d,y)}catch{}return function(T,S,A,k,N){const O=T.width,F=T.height;Da&&Js||(Da=new OffscreenCanvas(O,F),Js=Da.getContext("2d",{willReadFrequently:!0})),Da.width=O,Da.height=F,Js.drawImage(T,0,0,O,F);const $=Js.getImageData(S,A,k,N);return Js.clearRect(0,0,O,F),$.data}(l,t,a,d,y)})},v.cO=Il,v.cP=D,v.cQ=B,v.cR=hi,v.cS=ty,v.cT=ca,v.cU=uo,v.ca=l=>l.type==="symbol",v.cb=l=>l.type==="circle",v.cc=l=>l.type==="heatmap",v.cd=l=>l.type==="line",v.ce=l=>l.type==="fill",v.cf=l=>l.type==="fill-extrusion",v.cg=l=>l.type==="hillshade",v.ch=l=>l.type==="color-relief",v.ci=l=>l.type==="raster",v.cj=l=>l.type==="background",v.ck=l=>l.type==="custom",v.cl=Ri,v.cm=function(l,t,a){const d=ut(t.x-a.x,t.y-a.y),y=ut(l.x-a.x,l.y-a.y);var T,S;return dr(Math.atan2(d[0]*y[1]-d[1]*y[0],(T=d)[0]*(S=y)[0]+T[1]*S[1]))},v.cn=zn,v.co=function(l,t){return ad[t]&&(l instanceof MouseEvent||l instanceof WheelEvent)},v.cp=function(l,t){return jr[t]&&"touches"in l},v.cq=function(l){return jr[l]||ad[l]},v.cr=function(l,t,a){var d=t[0],y=t[1];return l[0]=a[0]*d+a[4]*y+a[12],l[1]=a[1]*d+a[5]*y+a[13],l},v.cs=function(l,t){const{x:a,y:d}=qd.fromLngLat(t);return!(l<0||l>25||d<0||d>=1||a<0||a>=1)},v.ct=function(l,t){return l[0]=t[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=t[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=t[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},v.cu=class extends ho{},v.cv=A0,v.cx=function(l){return l.message===Do},v.cy=ve,v.cz=function(l,t){ee.REGISTERED_PROTOCOLS[l]=t},v.d=Ze,v.e=Hi,v.f=l=>c(void 0,void 0,void 0,function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.g=ie,v.h=l=>new Promise((t,a)=>{const d=new Image;d.onload=()=>{t(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=ol})},d.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const y=new Blob([new Uint8Array(l)],{type:"image/png"});d.src=l.byteLength?URL.createObjectURL(y):ol}),v.i=Or,v.j=(l,t)=>Le(Hi(l,{type:"json"}),t),v.k=je,v.l=Ke,v.m=Le,v.n=(l,t)=>Le(Hi(l,{type:"arrayBuffer"}),t),v.o=function(l){return new xm(l).readFields(ny,[])},v.p=l0,v.q=zd,v.r=Vr,v.s=Hr,v.t=ei,v.u=wn,v.v=Ae,v.w=qn,v.x=wd,v.y=Sl,v.z=Tl}),p("worker",["./shared"],function(v){class c{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,ie){for(const ve of ee){this._layerConfigs[ve.id]=ve;const De=this._layers[ve.id]=v.bI(ve);De._featureFilter=v.a9(De.filter),this.keyCache[ve.id]&&delete this.keyCache[ve.id]}for(const ve of ie)delete this.keyCache[ve],delete this._layerConfigs[ve],delete this._layers[ve];this.familiesBySource={};const le=v.cB(Object.values(this._layerConfigs),this.keyCache);for(const ve of le){const De=ve.map(je=>this._layers[je.id]),Le=De[0];if(Le.visibility==="none")continue;const Ze=Le.source||"";let ze=this.familiesBySource[Ze];ze||(ze=this.familiesBySource[Ze]={});const rt=Le.sourceLayer||"_geojsonTileLayer";let Ke=ze[rt];Ke||(Ke=ze[rt]=[]),Ke.push(De)}}}class D{constructor(ee){const ie={},le=[];for(const Ze in ee){const ze=ee[Ze],rt=ie[Ze]={};for(const Ke in ze){const je=ze[+Ke];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const lt={x:0,y:0,w:je.bitmap.width+2,h:je.bitmap.height+2};le.push(lt),rt[Ke]={rect:lt,metrics:je.metrics}}}const{w:ve,h:De}=v.p(le),Le=new v.q({width:ve||1,height:De||1});for(const Ze in ee){const ze=ee[Ze];for(const rt in ze){const Ke=ze[+rt];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const je=ie[Ze][rt].rect;v.q.copy(Ke.bitmap,Le,{x:0,y:0},{x:je.x+1,y:je.y+1},Ke.bitmap)}}this.image=Le,this.positions=ie}}v.cC("GlyphAtlas",D);class I{constructor(ee){this.tileID=new v.Z(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[],this.globalState=ee.globalState}parse(ee,ie,le,ve,De){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new v.a7;const Le=new v.cD(Object.keys(ee.layers).sort()),Ze=new v.cE(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];const ze={},rt={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le,subdivisionGranularity:De},Ke=ie.familiesBySource[this.source];for(const en in Ke){const In=ee.layers[en];if(!In)continue;In.version===1&&v.w(`Vector tile source "${this.source}" layer "${en}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ir=Le.encode(en),St=[];for(let Ji=0;Ji<In.length;Ji++){const Si=In.feature(Ji),ka=Ze.getId(Si,en);St.push({feature:Si,id:ka,index:Ji,sourceLayerIndex:Ir})}for(const Ji of Ke[en]){const Si=Ji[0];Si.source!==this.source&&v.w(`layer.source = ${Si.source} does not equal this.source = ${this.source}`),Si.minzoom&&this.zoom<Math.floor(Si.minzoom)||Si.maxzoom&&this.zoom>=Si.maxzoom||Si.visibility!=="none"&&(P(Ji,this.zoom,le),(ze[Si.id]=Si.createBucket({index:Ze.bucketLayerIDs.length,layers:Ji,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ir,sourceID:this.source,globalState:this.globalState})).populate(St,rt,this.tileID.canonical),Ze.bucketLayerIDs.push(Ji.map(ka=>ka.id)))}}const je=v.bM(rt.glyphDependencies,en=>Object.keys(en).map(Number));this.inFlightDependencies.forEach(en=>en==null?void 0:en.abort()),this.inFlightDependencies=[];let lt=Promise.resolve({});if(Object.keys(je).length){const en=new AbortController;this.inFlightDependencies.push(en),lt=ve.sendAsync({type:"GG",data:{stacks:je,source:this.source,tileID:this.tileID,type:"glyphs"}},en)}const Ae=Object.keys(rt.iconDependencies);let Dt=Promise.resolve({});if(Ae.length){const en=new AbortController;this.inFlightDependencies.push(en),Dt=ve.sendAsync({type:"GI",data:{icons:Ae,source:this.source,tileID:this.tileID,type:"icons"}},en)}const Kt=Object.keys(rt.patternDependencies);let Pt=Promise.resolve({});if(Kt.length){const en=new AbortController;this.inFlightDependencies.push(en),Pt=ve.sendAsync({type:"GI",data:{icons:Kt,source:this.source,tileID:this.tileID,type:"patterns"}},en)}const[Gt,Qt,xn]=yield Promise.all([lt,Dt,Pt]),yn=new D(Gt),Dn=new v.cF(Qt,xn);for(const en in ze){const In=ze[en];In instanceof v.a8?(P(In.layers,this.zoom,le),v.cG({bucket:In,glyphMap:Gt,glyphPositions:yn.positions,imageMap:Qt,imagePositions:Dn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:rt.subdivisionGranularity})):In.hasPattern&&(In instanceof v.cH||In instanceof v.cI||In instanceof v.cJ)&&(P(In.layers,this.zoom,le),In.addFeatures(rt,this.tileID.canonical,Dn.patternPositions))}return this.status="done",{buckets:Object.values(ze).filter(en=>!en.isEmpty()),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yn.image,imageAtlas:Dn,glyphMap:this.returnDependencies?Gt:null,iconMap:this.returnDependencies?Qt:null,glyphPositions:this.returnDependencies?yn.positions:null}})}}function P(Oe,ee,ie){const le=new v.F(ee);for(const ve of Oe)ve.recalculate(le,ie)}class B{constructor(ee,ie,le){this.actor=ee,this.layerIndex=ie,this.availableImages=le,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,ie){return v._(this,void 0,void 0,function*(){const le=yield v.n(ee.request,ie);try{return{vectorTile:new v.cK.VectorTile(new v.cL(le.data)),rawData:le.data,cacheControl:le.cacheControl,expires:le.expires}}catch(ve){const De=new Uint8Array(le.data);let Le=`Unable to parse the tile at ${ee.request.url}, `;throw Le+=De[0]===31&&De[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ve.message}`,new Error(Le)}})}loadTile(ee){return v._(this,void 0,void 0,function*(){const ie=ee.uid,le=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new v.cM(ee.request),ve=new I(ee);this.loading[ie]=ve;const De=new AbortController;ve.abort=De;try{const Le=yield this.loadVectorTile(ee,De);if(delete this.loading[ie],!Le)return null;const Ze=Le.rawData,ze={};Le.expires&&(ze.expires=Le.expires),Le.cacheControl&&(ze.cacheControl=Le.cacheControl);const rt={};if(le){const je=le.finish();je&&(rt.resourceTiming=JSON.parse(JSON.stringify(je)))}ve.vectorTile=Le.vectorTile;const Ke=ve.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[ie]=ve,this.fetching[ie]={rawTileData:Ze,cacheControl:ze,resourceTiming:rt};try{const je=yield Ke;return v.e({rawTileData:Ze.slice(0)},je,ze,rt)}finally{delete this.fetching[ie]}}catch(Le){throw delete this.loading[ie],ve.status="done",this.loaded[ie]=ve,Le}})}reloadTile(ee){return v._(this,void 0,void 0,function*(){const ie=ee.uid;if(!this.loaded||!this.loaded[ie])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const le=this.loaded[ie];if(le.showCollisionBoxes=ee.showCollisionBoxes,le.globalState=ee.globalState,le.status==="parsing"){const ve=yield le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let De;if(this.fetching[ie]){const{rawTileData:Le,cacheControl:Ze,resourceTiming:ze}=this.fetching[ie];delete this.fetching[ie],De=v.e({rawTileData:Le.slice(0)},ve,Ze,ze)}else De=ve;return De}if(le.status==="done"&&le.vectorTile)return le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return v._(this,void 0,void 0,function*(){const ie=this.loading,le=ee.uid;ie&&ie[le]&&ie[le].abort&&(ie[le].abort.abort(),delete ie[le])})}removeTile(ee){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class U{constructor(){this.loaded={}}loadTile(ee){return v._(this,void 0,void 0,function*(){const{uid:ie,encoding:le,rawImageData:ve,redFactor:De,greenFactor:Le,blueFactor:Ze,baseShift:ze}=ee,rt=ve.width+2,Ke=ve.height+2,je=v.b(ve)?new v.R({width:rt,height:Ke},yield v.cN(ve,-1,-1,rt,Ke)):ve,lt=new v.cO(ie,je,le,De,Le,Ze,ze);return this.loaded=this.loaded||{},this.loaded[ie]=lt,lt})}removeTile(ee){const ie=this.loaded,le=ee.uid;ie&&ie[le]&&delete ie[le]}}var Z,ne,ye=function(){if(ne)return Z;function Oe(ie,le){if(ie.length!==0){ee(ie[0],le);for(var ve=1;ve<ie.length;ve++)ee(ie[ve],!le)}}function ee(ie,le){for(var ve=0,De=0,Le=0,Ze=ie.length,ze=Ze-1;Le<Ze;ze=Le++){var rt=(ie[Le][0]-ie[ze][0])*(ie[ze][1]+ie[Le][1]),Ke=ve+rt;De+=Math.abs(ve)>=Math.abs(rt)?ve-Ke+rt:rt-Ke+ve,ve=Ke}ve+De>=0!=!!le&&ie.reverse()}return ne=1,Z=function ie(le,ve){var De,Le=le&&le.type;if(Le==="FeatureCollection")for(De=0;De<le.features.length;De++)ie(le.features[De],ve);else if(Le==="GeometryCollection")for(De=0;De<le.geometries.length;De++)ie(le.geometries[De],ve);else if(Le==="Feature")ie(le.geometry,ve);else if(Le==="Polygon")Oe(le.coordinates,ve);else if(Le==="MultiPolygon")for(De=0;De<le.coordinates.length;De++)Oe(le.coordinates[De],ve);return le}}(),me=v.cP(ye);const Pe=v.cK.VectorTileFeature.prototype.toGeoJSON;class tt{constructor(ee){this._feature=ee,this.extent=v.$,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){const ee=[];for(const ie of this._feature.geometry)ee.push([new v.P(ie[0],ie[1])]);return ee}{const ee=[];for(const ie of this._feature.geometry){const le=[];for(const ve of ie)le.push(new v.P(ve[0],ve[1]));ee.push(le)}return ee}}toGeoJSON(ee,ie,le){return Pe.call(this,ee,ie,le)}}class Je{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.$,this.length=ee.length,this._features=ee}feature(ee){return new tt(this._features[ee])}}var $e,Me,Ve,ct={exports:{}},ot=function(){if(Ve)return ct.exports;Ve=1;var Oe=v.cS(),ee=function(){if(Me)return $e;Me=1;var Ke=v.cQ(),je=v.cR().VectorTileFeature;function lt(Dt,Kt){this.options=Kt||{},this.features=Dt,this.length=Dt.length}function Ae(Dt,Kt){this.id=typeof Dt.id=="number"?Dt.id:void 0,this.type=Dt.type,this.rawGeometry=Dt.type===1?[Dt.geometry]:Dt.geometry,this.properties=Dt.tags,this.extent=Kt||4096}return $e=lt,lt.prototype.feature=function(Dt){return new Ae(this.features[Dt],this.options.extent)},Ae.prototype.loadGeometry=function(){var Dt=this.rawGeometry;this.geometry=[];for(var Kt=0;Kt<Dt.length;Kt++){for(var Pt=Dt[Kt],Gt=[],Qt=0;Qt<Pt.length;Qt++)Gt.push(new Ke(Pt[Qt][0],Pt[Qt][1]));this.geometry.push(Gt)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Dt=this.geometry,Kt=1/0,Pt=-1/0,Gt=1/0,Qt=-1/0,xn=0;xn<Dt.length;xn++)for(var yn=Dt[xn],Dn=0;Dn<yn.length;Dn++){var en=yn[Dn];Kt=Math.min(Kt,en.x),Pt=Math.max(Pt,en.x),Gt=Math.min(Gt,en.y),Qt=Math.max(Qt,en.y)}return[Kt,Gt,Pt,Qt]},Ae.prototype.toGeoJSON=je.prototype.toGeoJSON,$e}();function ie(Ke){var je=new Oe;return function(lt,Ae){for(var Dt in lt.layers)Ae.writeMessage(3,le,lt.layers[Dt])}(Ke,je),je.finish()}function le(Ke,je){var lt;je.writeVarintField(15,Ke.version||1),je.writeStringField(1,Ke.name||""),je.writeVarintField(5,Ke.extent||4096);var Ae={keys:[],values:[],keycache:{},valuecache:{}};for(lt=0;lt<Ke.length;lt++)Ae.feature=Ke.feature(lt),je.writeMessage(2,ve,Ae);var Dt=Ae.keys;for(lt=0;lt<Dt.length;lt++)je.writeStringField(3,Dt[lt]);var Kt=Ae.values;for(lt=0;lt<Kt.length;lt++)je.writeMessage(4,rt,Kt[lt])}function ve(Ke,je){var lt=Ke.feature;lt.id!==void 0&&je.writeVarintField(1,lt.id),je.writeMessage(2,De,Ke),je.writeVarintField(3,lt.type),je.writeMessage(4,ze,lt)}function De(Ke,je){var lt=Ke.feature,Ae=Ke.keys,Dt=Ke.values,Kt=Ke.keycache,Pt=Ke.valuecache;for(var Gt in lt.properties){var Qt=lt.properties[Gt],xn=Kt[Gt];if(Qt!==null){xn===void 0&&(Ae.push(Gt),Kt[Gt]=xn=Ae.length-1),je.writeVarint(xn);var yn=typeof Qt;yn!=="string"&&yn!=="boolean"&&yn!=="number"&&(Qt=JSON.stringify(Qt));var Dn=yn+":"+Qt,en=Pt[Dn];en===void 0&&(Dt.push(Qt),Pt[Dn]=en=Dt.length-1),je.writeVarint(en)}}}function Le(Ke,je){return(je<<3)+(7&Ke)}function Ze(Ke){return Ke<<1^Ke>>31}function ze(Ke,je){for(var lt=Ke.loadGeometry(),Ae=Ke.type,Dt=0,Kt=0,Pt=lt.length,Gt=0;Gt<Pt;Gt++){var Qt=lt[Gt],xn=1;Ae===1&&(xn=Qt.length),je.writeVarint(Le(1,xn));for(var yn=Ae===3?Qt.length-1:Qt.length,Dn=0;Dn<yn;Dn++){Dn===1&&Ae!==1&&je.writeVarint(Le(2,yn-1));var en=Qt[Dn].x-Dt,In=Qt[Dn].y-Kt;je.writeVarint(Ze(en)),je.writeVarint(Ze(In)),Dt+=en,Kt+=In}Ae===3&&je.writeVarint(Le(7,1))}}function rt(Ke,je){var lt=typeof Ke;lt==="string"?je.writeStringField(1,Ke):lt==="boolean"?je.writeBooleanField(7,Ke):lt==="number"&&(Ke%1!=0?je.writeDoubleField(3,Ke):Ke<0?je.writeSVarintField(6,Ke):je.writeVarintField(5,Ke))}return ct.exports=ie,ct.exports.fromVectorTileJs=ie,ct.exports.fromGeojsonVt=function(Ke,je){je=je||{};var lt={};for(var Ae in Ke)lt[Ae]=new ee(Ke[Ae].features,je),lt[Ae].name=Ae,lt[Ae].version=je.version,lt[Ae].extent=je.extent;return ie({layers:lt})},ct.exports.GeoJSONWrapper=ee,ct.exports}(),Re=v.cP(ot);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Oe=>Oe},It=Math.fround||(Lt=new Float32Array(1),Oe=>(Lt[0]=+Oe,Lt[0]));var Lt;class Ut{constructor(ee){this.options=Object.assign(Object.create(mt),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:ie,minZoom:le,maxZoom:ve}=this.options;ie&&console.time("total time");const De=`prepare ${ee.length} points`;ie&&console.time(De),this.points=ee;const Le=[];for(let ze=0;ze<ee.length;ze++){const rt=ee[ze];if(!rt.geometry)continue;const[Ke,je]=rt.geometry.coordinates,lt=It(Ye(Ke)),Ae=It(gt(je));Le.push(lt,Ae,1/0,ze,-1,1),this.options.reduce&&Le.push(0)}let Ze=this.trees[ve+1]=this._createTree(Le);ie&&console.timeEnd(De);for(let ze=ve;ze>=le;ze--){const rt=+Date.now();Ze=this.trees[ze]=this._createTree(this._cluster(Ze,ze)),ie&&console.log("z%d: %d clusters in %dms",ze,Ze.numItems,+Date.now()-rt)}return ie&&console.timeEnd("total time"),this}getClusters(ee,ie){let le=((ee[0]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,ee[1]));let De=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)le=-180,De=180;else if(le>De){const je=this.getClusters([le,ve,180,Le],ie),lt=this.getClusters([-180,ve,De,Le],ie);return je.concat(lt)}const Ze=this.trees[this._limitZoom(ie)],ze=Ze.range(Ye(le),gt(Le),Ye(De),gt(ve)),rt=Ze.data,Ke=[];for(const je of ze){const lt=this.stride*je;Ke.push(rt[lt+5]>1?sn(rt,lt,this.clusterProps):this.points[rt[lt+3]])}return Ke}getChildren(ee){const ie=this._getOriginId(ee),le=this._getOriginZoom(ee),ve="No cluster with the specified id.",De=this.trees[le];if(!De)throw new Error(ve);const Le=De.data;if(ie*this.stride>=Le.length)throw new Error(ve);const Ze=this.options.radius/(this.options.extent*Math.pow(2,le-1)),ze=De.within(Le[ie*this.stride],Le[ie*this.stride+1],Ze),rt=[];for(const Ke of ze){const je=Ke*this.stride;Le[je+4]===ee&&rt.push(Le[je+5]>1?sn(Le,je,this.clusterProps):this.points[Le[je+3]])}if(rt.length===0)throw new Error(ve);return rt}getLeaves(ee,ie,le){const ve=[];return this._appendLeaves(ve,ee,ie=ie||10,le=le||0,0),ve}getTile(ee,ie,le){const ve=this.trees[this._limitZoom(ee)],De=Math.pow(2,ee),{extent:Le,radius:Ze}=this.options,ze=Ze/Le,rt=(le-ze)/De,Ke=(le+1+ze)/De,je={features:[]};return this._addTileFeatures(ve.range((ie-ze)/De,rt,(ie+1+ze)/De,Ke),ve.data,ie,le,De,je),ie===0&&this._addTileFeatures(ve.range(1-ze/De,rt,1,Ke),ve.data,De,le,De,je),ie===De-1&&this._addTileFeatures(ve.range(0,rt,ze/De,Ke),ve.data,-1,le,De,je),je.features.length?je:null}getClusterExpansionZoom(ee){let ie=this._getOriginZoom(ee)-1;for(;ie<=this.options.maxZoom;){const le=this.getChildren(ee);if(ie++,le.length!==1)break;ee=le[0].properties.cluster_id}return ie}_appendLeaves(ee,ie,le,ve,De){const Le=this.getChildren(ie);for(const Ze of Le){const ze=Ze.properties;if(ze&&ze.cluster?De+ze.point_count<=ve?De+=ze.point_count:De=this._appendLeaves(ee,ze.cluster_id,le,ve,De):De<ve?De++:ee.push(Ze),ee.length===le)break}return De}_createTree(ee){const ie=new v.aH(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let le=0;le<ee.length;le+=this.stride)ie.add(ee[le],ee[le+1]);return ie.finish(),ie.data=ee,ie}_addTileFeatures(ee,ie,le,ve,De,Le){for(const Ze of ee){const ze=Ze*this.stride,rt=ie[ze+5]>1;let Ke,je,lt;if(rt)Ke=on(ie,ze,this.clusterProps),je=ie[ze],lt=ie[ze+1];else{const Kt=this.points[ie[ze+3]];Ke=Kt.properties;const[Pt,Gt]=Kt.geometry.coordinates;je=Ye(Pt),lt=gt(Gt)}const Ae={type:1,geometry:[[Math.round(this.options.extent*(je*De-le)),Math.round(this.options.extent*(lt*De-ve))]],tags:Ke};let Dt;Dt=rt||this.options.generateId?ie[ze+3]:this.points[ie[ze+3]].id,Dt!==void 0&&(Ae.id=Dt),Le.features.push(Ae)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,ie){const{radius:le,extent:ve,reduce:De,minPoints:Le}=this.options,Ze=le/(ve*Math.pow(2,ie)),ze=ee.data,rt=[],Ke=this.stride;for(let je=0;je<ze.length;je+=Ke){if(ze[je+2]<=ie)continue;ze[je+2]=ie;const lt=ze[je],Ae=ze[je+1],Dt=ee.within(ze[je],ze[je+1],Ze),Kt=ze[je+5];let Pt=Kt;for(const Gt of Dt){const Qt=Gt*Ke;ze[Qt+2]>ie&&(Pt+=ze[Qt+5])}if(Pt>Kt&&Pt>=Le){let Gt,Qt=lt*Kt,xn=Ae*Kt,yn=-1;const Dn=(je/Ke<<5)+(ie+1)+this.points.length;for(const en of Dt){const In=en*Ke;if(ze[In+2]<=ie)continue;ze[In+2]=ie;const Ir=ze[In+5];Qt+=ze[In]*Ir,xn+=ze[In+1]*Ir,ze[In+4]=Dn,De&&(Gt||(Gt=this._map(ze,je,!0),yn=this.clusterProps.length,this.clusterProps.push(Gt)),De(Gt,this._map(ze,In)))}ze[je+4]=Dn,rt.push(Qt/Pt,xn/Pt,1/0,Dn,-1,Pt),De&&rt.push(yn)}else{for(let Gt=0;Gt<Ke;Gt++)rt.push(ze[je+Gt]);if(Pt>1)for(const Gt of Dt){const Qt=Gt*Ke;if(!(ze[Qt+2]<=ie)){ze[Qt+2]=ie;for(let xn=0;xn<Ke;xn++)rt.push(ze[Qt+xn])}}}}return rt}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,ie,le){if(ee[ie+5]>1){const Le=this.clusterProps[ee[ie+6]];return le?Object.assign({},Le):Le}const ve=this.points[ee[ie+3]].properties,De=this.options.map(ve);return le&&De===ve?Object.assign({},De):De}}function sn(Oe,ee,ie){return{type:"Feature",id:Oe[ee+3],properties:on(Oe,ee,ie),geometry:{type:"Point",coordinates:[(le=Oe[ee],360*(le-.5)),_t(Oe[ee+1])]}};var le}function on(Oe,ee,ie){const le=Oe[ee+5],ve=le>=1e4?`${Math.round(le/1e3)}k`:le>=1e3?Math.round(le/100)/10+"k":le,De=Oe[ee+6],Le=De===-1?{}:Object.assign({},ie[De]);return Object.assign(Le,{cluster:!0,cluster_id:Oe[ee+3],point_count:le,point_count_abbreviated:ve})}function Ye(Oe){return Oe/360+.5}function gt(Oe){const ee=Math.sin(Oe*Math.PI/180),ie=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ie<0?0:ie>1?1:ie}function _t(Oe){const ee=(180-360*Oe)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function qt(Oe,ee,ie,le){let ve=le;const De=ee+(ie-ee>>1);let Le,Ze=ie-ee;const ze=Oe[ee],rt=Oe[ee+1],Ke=Oe[ie],je=Oe[ie+1];for(let lt=ee+3;lt<ie;lt+=3){const Ae=Ce(Oe[lt],Oe[lt+1],ze,rt,Ke,je);if(Ae>ve)Le=lt,ve=Ae;else if(Ae===ve){const Dt=Math.abs(lt-De);Dt<Ze&&(Le=lt,Ze=Dt)}}ve>le&&(Le-ee>3&&qt(Oe,ee,Le,le),Oe[Le+2]=ve,ie-Le>3&&qt(Oe,Le,ie,le))}function Ce(Oe,ee,ie,le,ve,De){let Le=ve-ie,Ze=De-le;if(Le!==0||Ze!==0){const ze=((Oe-ie)*Le+(ee-le)*Ze)/(Le*Le+Ze*Ze);ze>1?(ie=ve,le=De):ze>0&&(ie+=Le*ze,le+=Ze*ze)}return Le=Oe-ie,Ze=ee-le,Le*Le+Ze*Ze}function ut(Oe,ee,ie,le){const ve={id:Oe??null,type:ee,geometry:ie,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")wt(ve,ie);else if(ee==="Polygon")wt(ve,ie[0]);else if(ee==="MultiLineString")for(const De of ie)wt(ve,De);else if(ee==="MultiPolygon")for(const De of ie)wt(ve,De[0]);return ve}function wt(Oe,ee){for(let ie=0;ie<ee.length;ie+=3)Oe.minX=Math.min(Oe.minX,ee[ie]),Oe.minY=Math.min(Oe.minY,ee[ie+1]),Oe.maxX=Math.max(Oe.maxX,ee[ie]),Oe.maxY=Math.max(Oe.maxY,ee[ie+1])}function Mt(Oe,ee,ie,le){if(!ee.geometry)return;const ve=ee.geometry.coordinates;if(ve&&ve.length===0)return;const De=ee.geometry.type,Le=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2);let Ze=[],ze=ee.id;if(ie.promoteId?ze=ee.properties[ie.promoteId]:ie.generateId&&(ze=le||0),De==="Point")Rt(ve,Ze);else if(De==="MultiPoint")for(const rt of ve)Rt(rt,Ze);else if(De==="LineString")Jt(ve,Ze,Le,!1);else if(De==="MultiLineString"){if(ie.lineMetrics){for(const rt of ve)Ze=[],Jt(rt,Ze,Le,!1),Oe.push(ut(ze,"LineString",Ze,ee.properties));return}Wt(ve,Ze,Le,!1)}else if(De==="Polygon")Wt(ve,Ze,Le,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(const rt of ee.geometry.geometries)Mt(Oe,{id:ze,geometry:rt,properties:ee.properties},ie,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const rt of ve){const Ke=[];Wt(rt,Ke,Le,!0),Ze.push(Ke)}}Oe.push(ut(ze,De,Ze,ee.properties))}function Rt(Oe,ee){ee.push(Ri(Oe[0]),zn(Oe[1]),0)}function Jt(Oe,ee,ie,le){let ve,De,Le=0;for(let ze=0;ze<Oe.length;ze++){const rt=Ri(Oe[ze][0]),Ke=zn(Oe[ze][1]);ee.push(rt,Ke,0),ze>0&&(Le+=le?(ve*Ke-rt*De)/2:Math.sqrt(Math.pow(rt-ve,2)+Math.pow(Ke-De,2))),ve=rt,De=Ke}const Ze=ee.length-3;ee[2]=1,qt(ee,0,Ze,ie),ee[Ze+2]=1,ee.size=Math.abs(Le),ee.start=0,ee.end=ee.size}function Wt(Oe,ee,ie,le){for(let ve=0;ve<Oe.length;ve++){const De=[];Jt(Oe[ve],De,ie,le),ee.push(De)}}function Ri(Oe){return Oe/360+.5}function zn(Oe){const ee=Math.sin(Oe*Math.PI/180),ie=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ie<0?0:ie>1?1:ie}function Gn(Oe,ee,ie,le,ve,De,Le,Ze){if(le/=ee,De>=(ie/=ee)&&Le<le)return Oe;if(Le<ie||De>=le)return null;const ze=[];for(const rt of Oe){const Ke=rt.geometry;let je=rt.type;const lt=ve===0?rt.minX:rt.minY,Ae=ve===0?rt.maxX:rt.maxY;if(lt>=ie&&Ae<le){ze.push(rt);continue}if(Ae<ie||lt>=le)continue;let Dt=[];if(je==="Point"||je==="MultiPoint")Ca(Ke,Dt,ie,le,ve);else if(je==="LineString")Hi(Ke,Dt,ie,le,ve,!1,Ze.lineMetrics);else if(je==="MultiLineString")Xn(Ke,Dt,ie,le,ve,!1);else if(je==="Polygon")Xn(Ke,Dt,ie,le,ve,!0);else if(je==="MultiPolygon")for(const Kt of Ke){const Pt=[];Xn(Kt,Pt,ie,le,ve,!0),Pt.length&&Dt.push(Pt)}if(Dt.length){if(Ze.lineMetrics&&je==="LineString"){for(const Kt of Dt)ze.push(ut(rt.id,je,Kt,rt.tags));continue}je!=="LineString"&&je!=="MultiLineString"||(Dt.length===1?(je="LineString",Dt=Dt[0]):je="MultiLineString"),je!=="Point"&&je!=="MultiPoint"||(je=Dt.length===3?"Point":"MultiPoint"),ze.push(ut(rt.id,je,Dt,rt.tags))}}return ze.length?ze:null}function Ca(Oe,ee,ie,le,ve){for(let De=0;De<Oe.length;De+=3){const Le=Oe[De+ve];Le>=ie&&Le<=le&&br(ee,Oe[De],Oe[De+1],Oe[De+2])}}function Hi(Oe,ee,ie,le,ve,De,Le){let Ze=Xa(Oe);const ze=ve===0?Pn:Wa;let rt,Ke,je=Oe.start;for(let Pt=0;Pt<Oe.length-3;Pt+=3){const Gt=Oe[Pt],Qt=Oe[Pt+1],xn=Oe[Pt+2],yn=Oe[Pt+3],Dn=Oe[Pt+4],en=ve===0?Gt:Qt,In=ve===0?yn:Dn;let Ir=!1;Le&&(rt=Math.sqrt(Math.pow(Gt-yn,2)+Math.pow(Qt-Dn,2))),en<ie?In>ie&&(Ke=ze(Ze,Gt,Qt,yn,Dn,ie),Le&&(Ze.start=je+rt*Ke)):en>le?In<le&&(Ke=ze(Ze,Gt,Qt,yn,Dn,le),Le&&(Ze.start=je+rt*Ke)):br(Ze,Gt,Qt,xn),In<ie&&en>=ie&&(Ke=ze(Ze,Gt,Qt,yn,Dn,ie),Ir=!0),In>le&&en<=le&&(Ke=ze(Ze,Gt,Qt,yn,Dn,le),Ir=!0),!De&&Ir&&(Le&&(Ze.end=je+rt*Ke),ee.push(Ze),Ze=Xa(Oe)),Le&&(je+=rt)}let lt=Oe.length-3;const Ae=Oe[lt],Dt=Oe[lt+1],Kt=ve===0?Ae:Dt;Kt>=ie&&Kt<=le&&br(Ze,Ae,Dt,Oe[lt+2]),lt=Ze.length-3,De&&lt>=3&&(Ze[lt]!==Ze[0]||Ze[lt+1]!==Ze[1])&&br(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ee.push(Ze)}function Xa(Oe){const ee=[];return ee.size=Oe.size,ee.start=Oe.start,ee.end=Oe.end,ee}function Xn(Oe,ee,ie,le,ve,De){for(const Le of Oe)Hi(Le,ee,ie,le,ve,De,!1)}function br(Oe,ee,ie,le){Oe.push(ee,ie,le)}function Pn(Oe,ee,ie,le,ve,De){const Le=(De-ee)/(le-ee);return br(Oe,De,ie+(ve-ie)*Le,1),Le}function Wa(Oe,ee,ie,le,ve,De){const Le=(De-ie)/(ve-ie);return br(Oe,ee+(le-ee)*Le,De,1),Le}function qn(Oe,ee){const ie=[];for(let le=0;le<Oe.length;le++){const ve=Oe[le],De=ve.type;let Le;if(De==="Point"||De==="MultiPoint"||De==="LineString")Le=aa(ve.geometry,ee);else if(De==="MultiLineString"||De==="Polygon"){Le=[];for(const Ze of ve.geometry)Le.push(aa(Ze,ee))}else if(De==="MultiPolygon"){Le=[];for(const Ze of ve.geometry){const ze=[];for(const rt of Ze)ze.push(aa(rt,ee));Le.push(ze)}}ie.push(ut(ve.id,De,Le,ve.tags))}return ie}function aa(Oe,ee){const ie=[];ie.size=Oe.size,Oe.start!==void 0&&(ie.start=Oe.start,ie.end=Oe.end);for(let le=0;le<Oe.length;le+=3)ie.push(Oe[le]+ee,Oe[le+1],Oe[le+2]);return ie}function Or(Oe,ee){if(Oe.transformed)return Oe;const ie=1<<Oe.z,le=Oe.x,ve=Oe.y;for(const De of Oe.features){const Le=De.geometry,Ze=De.type;if(De.geometry=[],Ze===1)for(let ze=0;ze<Le.length;ze+=2)De.geometry.push(Yr(Le[ze],Le[ze+1],ee,ie,le,ve));else for(let ze=0;ze<Le.length;ze++){const rt=[];for(let Ke=0;Ke<Le[ze].length;Ke+=2)rt.push(Yr(Le[ze][Ke],Le[ze][Ke+1],ee,ie,le,ve));De.geometry.push(rt)}}return Oe.transformed=!0,Oe}function Yr(Oe,ee,ie,le,ve,De){return[Math.round(ie*(Oe*le-ve)),Math.round(ie*(ee*le-De))]}function qr(Oe,ee,ie,le,ve){const De=ee===ve.maxZoom?0:ve.tolerance/((1<<ee)*ve.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:Oe.length,source:null,x:ie,y:le,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ze of Oe)ol(Le,Ze,De,ve);return Le}function ol(Oe,ee,ie,le){const ve=ee.geometry,De=ee.type,Le=[];if(Oe.minX=Math.min(Oe.minX,ee.minX),Oe.minY=Math.min(Oe.minY,ee.minY),Oe.maxX=Math.max(Oe.maxX,ee.maxX),Oe.maxY=Math.max(Oe.maxY,ee.maxY),De==="Point"||De==="MultiPoint")for(let Ze=0;Ze<ve.length;Ze+=3)Le.push(ve[Ze],ve[Ze+1]),Oe.numPoints++,Oe.numSimplified++;else if(De==="LineString")gs(Le,ve,Oe,ie,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(let Ze=0;Ze<ve.length;Ze++)gs(Le,ve[Ze],Oe,ie,De==="Polygon",Ze===0);else if(De==="MultiPolygon")for(let Ze=0;Ze<ve.length;Ze++){const ze=ve[Ze];for(let rt=0;rt<ze.length;rt++)gs(Le,ze[rt],Oe,ie,!0,rt===0)}if(Le.length){let Ze=ee.tags||null;if(De==="LineString"&&le.lineMetrics){Ze={};for(const rt in ee.tags)Ze[rt]=ee.tags[rt];Ze.mapbox_clip_start=ve.start/ve.size,Ze.mapbox_clip_end=ve.end/ve.size}const ze={geometry:Le,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:Ze};ee.id!==null&&(ze.id=ee.id),Oe.features.push(ze)}}function gs(Oe,ee,ie,le,ve,De){const Le=le*le;if(le>0&&ee.size<(ve?Le:le))return void(ie.numPoints+=ee.length/3);const Ze=[];for(let ze=0;ze<ee.length;ze+=3)(le===0||ee[ze+2]>Le)&&(ie.numSimplified++,Ze.push(ee[ze],ee[ze+1])),ie.numPoints++;ve&&function(ze,rt){let Ke=0;for(let je=0,lt=ze.length,Ae=lt-2;je<lt;Ae=je,je+=2)Ke+=(ze[je]-ze[Ae])*(ze[je+1]+ze[Ae+1]);if(Ke>0===rt)for(let je=0,lt=ze.length;je<lt/2;je+=2){const Ae=ze[je],Dt=ze[je+1];ze[je]=ze[lt-2-je],ze[je+1]=ze[lt-1-je],ze[lt-2-je]=Ae,ze[lt-1-je]=Dt}}(Ze,De),Oe.push(Ze)}const Da={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Js{constructor(ee,ie){const le=(ie=this.options=function(De,Le){for(const Ze in Le)De[Ze]=Le[Ze];return De}(Object.create(Da),ie)).debug;if(le&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let ve=function(De,Le){const Ze=[];if(De.type==="FeatureCollection")for(let ze=0;ze<De.features.length;ze++)Mt(Ze,De.features[ze],Le,ze);else Mt(Ze,De.type==="Feature"?De:{geometry:De},Le);return Ze}(ee,ie);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ve=function(De,Le){const Ze=Le.buffer/Le.extent;let ze=De;const rt=Gn(De,1,-1-Ze,Ze,0,-1,2,Le),Ke=Gn(De,1,1-Ze,2+Ze,0,-1,2,Le);return(rt||Ke)&&(ze=Gn(De,1,-Ze,1+Ze,0,-1,2,Le)||[],rt&&(ze=qn(rt,1).concat(ze)),Ke&&(ze=ze.concat(qn(Ke,-1)))),ze}(ve,ie),ve.length&&this.splitTile(ve,0,0,0),le&&(ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,ie,le,ve,De,Le,Ze){const ze=[ee,ie,le,ve],rt=this.options,Ke=rt.debug;for(;ze.length;){ve=ze.pop(),le=ze.pop(),ie=ze.pop(),ee=ze.pop();const je=1<<ie,lt=Hr(ie,le,ve);let Ae=this.tiles[lt];if(!Ae&&(Ke>1&&console.time("creation"),Ae=this.tiles[lt]=qr(ee,ie,le,ve,rt),this.tileCoords.push({z:ie,x:le,y:ve}),Ke)){Ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,le,ve,Ae.numFeatures,Ae.numPoints,Ae.numSimplified),console.timeEnd("creation"));const Ir=`z${ie}`;this.stats[Ir]=(this.stats[Ir]||0)+1,this.total++}if(Ae.source=ee,De==null){if(ie===rt.indexMaxZoom||Ae.numPoints<=rt.indexMaxPoints)continue}else{if(ie===rt.maxZoom||ie===De)continue;if(De!=null){const Ir=De-ie;if(le!==Le>>Ir||ve!==Ze>>Ir)continue}}if(Ae.source=null,ee.length===0)continue;Ke>1&&console.time("clipping");const Dt=.5*rt.buffer/rt.extent,Kt=.5-Dt,Pt=.5+Dt,Gt=1+Dt;let Qt=null,xn=null,yn=null,Dn=null,en=Gn(ee,je,le-Dt,le+Pt,0,Ae.minX,Ae.maxX,rt),In=Gn(ee,je,le+Kt,le+Gt,0,Ae.minX,Ae.maxX,rt);ee=null,en&&(Qt=Gn(en,je,ve-Dt,ve+Pt,1,Ae.minY,Ae.maxY,rt),xn=Gn(en,je,ve+Kt,ve+Gt,1,Ae.minY,Ae.maxY,rt),en=null),In&&(yn=Gn(In,je,ve-Dt,ve+Pt,1,Ae.minY,Ae.maxY,rt),Dn=Gn(In,je,ve+Kt,ve+Gt,1,Ae.minY,Ae.maxY,rt),In=null),Ke>1&&console.timeEnd("clipping"),ze.push(Qt||[],ie+1,2*le,2*ve),ze.push(xn||[],ie+1,2*le,2*ve+1),ze.push(yn||[],ie+1,2*le+1,2*ve),ze.push(Dn||[],ie+1,2*le+1,2*ve+1)}}getTile(ee,ie,le){ee=+ee,ie=+ie,le=+le;const ve=this.options,{extent:De,debug:Le}=ve;if(ee<0||ee>24)return null;const Ze=1<<ee,ze=Hr(ee,ie=ie+Ze&Ze-1,le);if(this.tiles[ze])return Or(this.tiles[ze],De);Le>1&&console.log("drilling down to z%d-%d-%d",ee,ie,le);let rt,Ke=ee,je=ie,lt=le;for(;!rt&&Ke>0;)Ke--,je>>=1,lt>>=1,rt=this.tiles[Hr(Ke,je,lt)];return rt&&rt.source?(Le>1&&(console.log("found parent tile z%d-%d-%d",Ke,je,lt),console.time("drilling down")),this.splitTile(rt.source,Ke,je,lt,ee,ie,le),Le>1&&console.timeEnd("drilling down"),this.tiles[ze]?Or(this.tiles[ze],De):null):null}}function Hr(Oe,ee,ie){return 32*((1<<Oe)*ie+ee)+Oe}function ci(Oe,ee){return ee?Oe.properties[ee]:Oe.id}function dr(Oe,ee){if(Oe==null)return!0;if(Oe.type==="Feature")return ci(Oe,ee)!=null;if(Oe.type==="FeatureCollection"){const ie=new Set;for(const le of Oe.features){const ve=ci(le,ee);if(ve==null||ie.has(ve))return!1;ie.add(ve)}return!0}return!1}function jr(Oe,ee){const ie=new Map;if(Oe!=null)if(Oe.type==="Feature")ie.set(ci(Oe,ee),Oe);else for(const le of Oe.features)ie.set(ci(le,ee),le);return ie}class ad extends B{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,ie){return v._(this,void 0,void 0,function*(){const le=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ve=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!ve)return null;const De=new Je(ve.features);let Le=Re(De);return Le.byteOffset===0&&Le.byteLength===Le.buffer.byteLength||(Le=new Uint8Array(Le)),{vectorTile:De,rawData:Le.buffer}})}loadData(ee){return v._(this,void 0,void 0,function*(){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.abort();const le=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new v.cM(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new Ut(function({superclusterOptions:Le,clusterProperties:Ze}){if(!Ze||!Le)return Le;const ze={},rt={},Ke={accumulated:null,zoom:0},je={properties:null},lt=Object.keys(Ze);for(const Ae of lt){const[Dt,Kt]=Ze[Ae],Pt=v.cT(Kt),Gt=v.cT(typeof Dt=="string"?[Dt,["accumulated"],["get",Ae]]:Dt);ze[Ae]=Pt.value,rt[Ae]=Gt.value}return Le.map=Ae=>{je.properties=Ae;const Dt={};for(const Kt of lt)Dt[Kt]=ze[Kt].evaluate(Ke,je);return Dt},Le.reduce=(Ae,Dt)=>{je.properties=Dt;for(const Kt of lt)Ke.accumulated=Ae[Kt],Ae[Kt]=rt[Kt].evaluate(Ke,je)},Le}(ee)).load((yield this._pendingData).features):(ve=yield this._pendingData,new Js(ve,ee.geojsonVtOptions)),this.loaded={};const De={};if(le){const Le=le.finish();Le&&(De.resourceTiming={},De.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Le)))}return De}catch(De){if(delete this._pendingRequest,v.cx(De))return{abandoned:!0};throw De}var ve})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const ie=this.loaded;return ie&&ie[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,ie){return v._(this,void 0,void 0,function*(){let le=yield this.loadGeoJSON(ee,ie);if(delete this._pendingRequest,typeof le!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(me(le,!0),ee.filter){const ve=v.cT(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map(Le=>`${Le.key}: ${Le.message}`).join(", "));le={type:"FeatureCollection",features:le.features.filter(Le=>ve.value.evaluate({zoom:0},Le))}}return le})}loadGeoJSON(ee,ie){return v._(this,void 0,void 0,function*(){const{promoteId:le}=ee;if(ee.request){const ve=yield v.j(ee.request,ie);return this._dataUpdateable=dr(ve.data,le)?jr(ve.data,le):void 0,ve.data}if(typeof ee.data=="string")try{const ve=JSON.parse(ee.data);return this._dataUpdateable=dr(ve,le)?jr(ve,le):void 0,ve}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(ve,De,Le){var Ze,ze,rt,Ke;if(De.removeAll&&ve.clear(),De.remove)for(const je of De.remove)ve.delete(je);if(De.add)for(const je of De.add){const lt=ci(je,Le);lt!=null&&ve.set(lt,je)}if(De.update)for(const je of De.update){let lt=ve.get(je.id);if(lt==null)continue;const Ae=!je.removeAllProperties&&(((Ze=je.removeProperties)===null||Ze===void 0?void 0:Ze.length)>0||((ze=je.addOrUpdateProperties)===null||ze===void 0?void 0:ze.length)>0);if((je.newGeometry||je.removeAllProperties||Ae)&&(lt=Object.assign({},lt),ve.set(je.id,lt),Ae&&(lt.properties=Object.assign({},lt.properties))),je.newGeometry&&(lt.geometry=je.newGeometry),je.removeAllProperties)lt.properties={};else if(((rt=je.removeProperties)===null||rt===void 0?void 0:rt.length)>0)for(const Dt of je.removeProperties)Object.prototype.hasOwnProperty.call(lt.properties,Dt)&&delete lt.properties[Dt];if(((Ke=je.addOrUpdateProperties)===null||Ke===void 0?void 0:Ke.length)>0)for(const{key:Dt,value:Kt}of je.addOrUpdateProperties)lt.properties[Dt]=Kt}}(this._dataUpdateable,ee.dataDiff,le),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class Do{constructor(ee){this.self=ee,this.actor=new v.J(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ie,le)=>{if(this.externalWorkerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.externalWorkerSourceTypes[ie]=le},this.self.addProtocol=v.cz,this.self.removeProtocol=v.cA,this.self.registerRTLTextPlugin=ie=>{v.cU.setMethods(ie)},this.actor.registerMessageHandler("LDT",(ie,le)=>this._getDEMWorkerSource(ie,le.source).loadTile(le)),this.actor.registerMessageHandler("RDT",(ie,le)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ie,le.source).removeTile(le)})),this.actor.registerMessageHandler("GCEZ",(ie,le)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,le.type,le.source).getClusterExpansionZoom(le)})),this.actor.registerMessageHandler("GCC",(ie,le)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,le.type,le.source).getClusterChildren(le)})),this.actor.registerMessageHandler("GCL",(ie,le)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,le.type,le.source).getClusterLeaves(le)})),this.actor.registerMessageHandler("LD",(ie,le)=>this._getWorkerSource(ie,le.type,le.source).loadData(le)),this.actor.registerMessageHandler("GD",(ie,le)=>this._getWorkerSource(ie,le.type,le.source).getData()),this.actor.registerMessageHandler("LT",(ie,le)=>this._getWorkerSource(ie,le.type,le.source).loadTile(le)),this.actor.registerMessageHandler("RT",(ie,le)=>this._getWorkerSource(ie,le.type,le.source).reloadTile(le)),this.actor.registerMessageHandler("AT",(ie,le)=>this._getWorkerSource(ie,le.type,le.source).abortTile(le)),this.actor.registerMessageHandler("RMT",(ie,le)=>this._getWorkerSource(ie,le.type,le.source).removeTile(le)),this.actor.registerMessageHandler("RS",(ie,le)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[ie]||!this.workerSources[ie][le.type]||!this.workerSources[ie][le.type][le.source])return;const ve=this.workerSources[ie][le.type][le.source];delete this.workerSources[ie][le.type][le.source],ve.removeSource!==void 0&&ve.removeSource(le)})),this.actor.registerMessageHandler("RM",ie=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie]})),this.actor.registerMessageHandler("SR",(ie,le)=>v._(this,void 0,void 0,function*(){this.referrer=le})),this.actor.registerMessageHandler("SRPS",(ie,le)=>this._syncRTLPluginState(ie,le)),this.actor.registerMessageHandler("IS",(ie,le)=>v._(this,void 0,void 0,function*(){this.self.importScripts(le)})),this.actor.registerMessageHandler("SI",(ie,le)=>this._setImages(ie,le)),this.actor.registerMessageHandler("UL",(ie,le)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(ie).update(le.layers,le.removedIds)})),this.actor.registerMessageHandler("SL",(ie,le)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(ie).replace(le)}))}_setImages(ee,ie){return v._(this,void 0,void 0,function*(){this.availableImages[ee]=ie;for(const le in this.workerSources[ee]){const ve=this.workerSources[ee][le];for(const De in ve)ve[De].availableImages=ie}})}_syncRTLPluginState(ee,ie){return v._(this,void 0,void 0,function*(){return yield v.cU.syncState(ie,this.self.importScripts)})}_getAvailableImages(ee){let ie=this.availableImages[ee];return ie||(ie=[]),ie}_getLayerIndex(ee){let ie=this.layerIndexes[ee];return ie||(ie=this.layerIndexes[ee]=new c),ie}_getWorkerSource(ee,ie,le){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][ie]||(this.workerSources[ee][ie]={}),!this.workerSources[ee][ie][le]){const ve={sendAsync:(De,Le)=>(De.targetMapId=ee,this.actor.sendAsync(De,Le))};switch(ie){case"vector":this.workerSources[ee][ie][le]=new B(ve,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][ie][le]=new ad(ve,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][ie][le]=new this.externalWorkerSourceTypes[ie](ve,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][ie][le]}_getDEMWorkerSource(ee,ie){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][ie]||(this.demWorkerSources[ee][ie]=new U),this.demWorkerSources[ee][ie]}}return v.i(self)&&(self.worker=new Do(self)),Do}),p("index",["exports","./shared"],function(v,c){var D="5.6.0";function I(){var x=new c.A(4);return c.A!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x}let P,B;const U={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(x,e,s){const f=requestAnimationFrame(w=>{g(),e(w)}),{unsubscribe:g}=c.s(x.signal,"abort",()=>{g(),cancelAnimationFrame(f),s(c.c())},!1)},frameAsync(x){return new Promise((e,s)=>{this.frame(x,e,s)})},getImageData(x,e=0){return this.getImageCanvasContext(x).getImageData(-e,-e,x.width+2*e,x.height+2*e)},getImageCanvasContext(x){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=x.width,e.height=x.height,s.drawImage(x,0,0,x.width,x.height),s},resolveURL:x=>(P||(P=document.createElement("a")),P.href=x,P.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class Z{static testProp(e){if(!Z.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in Z.docStyle)return e[s];return e[0]}static create(e,s,f){const g=window.document.createElement(e);return s!==void 0&&(g.className=s),f&&f.appendChild(g),g}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){Z.docStyle&&Z.selectProp&&(Z.userSelect=Z.docStyle[Z.selectProp],Z.docStyle[Z.selectProp]="none")}static enableDrag(){Z.docStyle&&Z.selectProp&&(Z.docStyle[Z.selectProp]=Z.userSelect)}static setTransform(e,s){e.style[Z.transformProp]=s}static addEventListener(e,s,f,g={}){e.addEventListener(s,f,"passive"in g?g:g.capture)}static removeEventListener(e,s,f,g={}){e.removeEventListener(s,f,"passive"in g?g:g.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",Z.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Z.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Z.suppressClickInternal,!0)},0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,f){const g=s.boundingClientRect;return new c.P((f.clientX-g.left)/s.x-e.clientLeft,(f.clientY-g.top)/s.y-e.clientTop)}static mousePos(e,s){const f=Z.getScale(e);return Z.getPoint(e,f,s)}static touchPos(e,s){const f=[],g=Z.getScale(e);for(let w=0;w<s.length;w++)f.push(Z.getPoint(e,g,s[w]));return f}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const s=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),f=s.querySelectorAll("script");for(const g of f)g.remove();return Z.clean(s),s.innerHTML}static isPossiblyDangerous(e,s){const f=s.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!f.includes("javascript:")&&!f.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const s=e.children;for(const f of s)Z.removeAttributes(f),Z.clean(f)}static removeAttributes(e){for(const{name:s,value:f}of e.attributes)Z.isPossiblyDangerous(s,f)&&e.removeAttribute(s)}}Z.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Z.selectProp=Z.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Z.transformProp=Z.testProp(["transform","WebkitTransform"]);const ne={supported:!1,testSupport:function(x){!Pe&&me&&(tt?Je(x):ye=x)}};let ye,me,Pe=!1,tt=!1;function Je(x){const e=x.createTexture();x.bindTexture(x.TEXTURE_2D,e);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,me),x.isContextLost())return;ne.supported=!0}catch{}x.deleteTexture(e),Pe=!0}var $e;typeof document<"u"&&(me=document.createElement("img"),me.onload=()=>{ye&&Je(ye),ye=null,tt=!0},me.onerror=()=>{Pe=!0,ye=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(x){let e,s,f,g;x.resetRequestQueue=()=>{e=[],s=0,f=0,g={}},x.addThrottleControl=R=>{const L=f++;return g[L]=R,L},x.removeThrottleControl=R=>{delete g[R],E()},x.getImage=(R,L,j=!0)=>new Promise((G,V)=>{ne.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),c.e(R,{type:"image"}),e.push({abortController:L,requestParameters:R,supportImageRefresh:j,state:"queued",onError:Y=>{V(Y)},onSuccess:Y=>{G(Y)}}),E()});const w=R=>c._(this,void 0,void 0,function*(){R.state="running";const{requestParameters:L,supportImageRefresh:j,onError:G,onSuccess:V,abortController:Y}=R,K=j===!1&&!c.i(self)&&!c.g(L.url)&&(!L.headers||Object.keys(L.headers).reduce((de,pe)=>de&&pe==="accept",!0));s++;const ue=K?C(L,Y):c.m(L,Y);try{const de=yield ue;delete R.abortController,R.state="completed",de.data instanceof HTMLImageElement||c.b(de.data)?V(de):de.data&&V({data:yield(ce=de.data,typeof createImageBitmap=="function"?c.f(ce):c.h(ce)),cacheControl:de.cacheControl,expires:de.expires})}catch(de){delete R.abortController,G(de)}finally{s--,E()}var ce}),E=()=>{const R=(()=>{for(const L of Object.keys(g))if(g[L]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=s;L<R&&e.length>0;L++){const j=e.shift();j.abortController.signal.aborted?L--:w(j)}},C=(R,L)=>new Promise((j,G)=>{const V=new Image,Y=R.url,K=R.credentials;K&&K==="include"?V.crossOrigin="use-credentials":(K&&K==="same-origin"||!c.d(Y))&&(V.crossOrigin="anonymous"),L.signal.addEventListener("abort",()=>{V.src="",G(c.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,j({data:V})},V.onerror=()=>{V.onerror=V.onload=null,L.signal.aborted||G(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=Y})}($e||($e={})),$e.resetRequestQueue();class Me{constructor(e){this._transformRequestFn=e}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ve(x){const e=[];if(typeof x=="string")e.push({id:"default",url:x});else if(x&&x.length>0){const s=[];for(const{id:f,url:g}of x){const w=`${f}${g}`;s.indexOf(w)===-1&&(s.push(w),e.push({id:f,url:g}))}}return e}function ct(x,e,s){try{const f=new URL(x);return f.pathname+=`${e}${s}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${x}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ot(x){const{userImage:e}=x;return!!(e&&e.render&&e.render())&&(x.data.replace(new Uint8Array(e.data.buffer)),!0)}class Re extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:f}of this.requestors)f(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const f=s.spriteData;s.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let f=!0;const g=s.data||s.spriteData;return this._validateStretch(s.stretchX,g&&g.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),f=!1),this._validateStretch(s.stretchY,g&&g.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),f=!1),this._validateContent(s.content,s)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),f=!1),f}_validateStretch(e,s){if(!e)return!0;let f=0;for(const g of e){if(g[0]<f||g[1]<g[0]||s<g[1])return!1;f=g[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const f=s.spriteData,g=f&&f.width||s.data.width,w=f&&f.height||s.data.height;return!(e[0]<0||g<e[0]||e[1]<0||w<e[1]||e[2]<0||g<e[2]||e[3]<0||w<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,f=!0){const g=this.getImage(e);if(f&&(g.data.width!==s.data.width||g.data.height!==s.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=g.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((s,f)=>{let g=!0;if(!this.isLoaded())for(const w of e)this.images[w]||(g=!1);this.isLoaded()||g?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})})}_getImagesForIds(e){const s={};for(const f of e){let g=this.getImage(f);g||(this.fire(new c.l("styleimagemissing",{id:f})),g=this.getImage(f)),g?s[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],f=this.getImage(e);if(!f)return null;if(s&&s.position.version===f.version)return s.position;if(s)s.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},w=new c.I(g,f);this.patterns[e]={bin:g,position:w}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const w in this.patterns)e.push(this.patterns[w].bin);const{w:s,h:f}=c.p(e),g=this.atlasImage;g.resize({width:s||1,height:f||1});for(const w in this.patterns){const{bin:E}=this.patterns[w],C=E.x+1,R=E.y+1,L=this.getImage(w).data,j=L.width,G=L.height;c.R.copy(L,g,{x:0,y:0},{x:C,y:R},{width:j,height:G}),c.R.copy(L,g,{x:0,y:G-1},{x:C,y:R-1},{width:j,height:1}),c.R.copy(L,g,{x:0,y:0},{x:C,y:R+G},{width:j,height:1}),c.R.copy(L,g,{x:j-1,y:0},{x:C-1,y:R},{width:1,height:G}),c.R.copy(L,g,{x:0,y:0},{x:C+j,y:R},{width:1,height:G})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const f=this.getImage(s);f||c.w(`Image with ID: "${s}" was not found`),ot(f)&&this.updateImage(s,f)}}}const mt=1e20;function It(x,e,s,f,g,w,E,C,R){for(let L=e;L<e+f;L++)Lt(x,s*w+L,w,g,E,C,R);for(let L=s;L<s+g;L++)Lt(x,L*w+e,1,f,E,C,R)}function Lt(x,e,s,f,g,w,E){w[0]=0,E[0]=-1e20,E[1]=mt,g[0]=x[e];for(let C=1,R=0,L=0;C<f;C++){g[C]=x[e+C*s];const j=C*C;do{const G=w[R];L=(g[C]-g[G]+j-G*G)/(C-G)/2}while(L<=E[R]&&--R>-1);R++,w[R]=C,E[R]=L,E[R+1]=mt}for(let C=0,R=0;C<f;C++){for(;E[R+1]<C;)R++;const L=w[R],j=C-L;x[e+C*s]=g[L]+j*j}}class Ut{constructor(e,s){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const s=[];for(const w in e)for(const E of e[w])s.push(this._getAndCacheGlyphsPromise(w,E));const f=yield Promise.all(s),g={};for(const{stack:w,id:E,glyph:C}of f)g[w]||(g[w]={}),g[w][E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return g})}_getAndCacheGlyphsPromise(e,s){return c._(this,void 0,void 0,function*(){let f=this.entries[e];f||(f=this.entries[e]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[s];if(g!==void 0)return{stack:e,id:s,glyph:g};if(g=this._tinySDF(f,e,s),g)return f.glyphs[s]=g,{stack:e,id:s,glyph:g};const w=Math.floor(s/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[w])return{stack:e,id:s,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[w]){const C=Ut.loadGlyphRange(e,w,this.url,this.requestManager);f.requests[w]=C}const E=yield f.requests[w];for(const C in E)this._doesCharSupportLocalGlyph(+C)||(f.glyphs[+C]=E[+C]);return f.ranges[w]=!0,{stack:e,id:s,glyph:E[s]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,s,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let w=e.tinySDF;if(!w){let C="400";/bold/i.test(s)?C="900":/medium/i.test(s)?C="500":/light/i.test(s)&&(C="200"),w=e.tinySDF=new Ut.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:C})}const E=w.draw(String.fromCharCode(f));return{id:f,bitmap:new c.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ut.loadGlyphRange=function(x,e,s,f){return c._(this,void 0,void 0,function*(){const g=256*e,w=g+255,E=f.transformRequest(s.replace("{fontstack}",x).replace("{range}",`${g}-${w}`),"Glyphs"),C=yield c.n(E,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${e}, ${g}-${w}`);const R={};for(const L of c.o(C.data))R[L.id]=L;return R})},Ut.TinySDF=class{constructor({fontSize:x=24,buffer:e=3,radius:s=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:w="normal",fontStyle:E="normal"}={}){this.buffer=e,this.cutoff=f,this.radius=s;const C=this.size=x+4*e,R=this._createCanvas(C),L=this.ctx=R.getContext("2d",{willReadFrequently:!0});L.font=`${E} ${w} ${x}px ${g}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(x){const e=document.createElement("canvas");return e.width=e.height=x,e}draw(x){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:w}=this.ctx.measureText(x),E=Math.ceil(s),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-g))),R=Math.min(this.size-this.buffer,E+Math.ceil(f)),L=C+2*this.buffer,j=R+2*this.buffer,G=Math.max(L*j,0),V=new Uint8ClampedArray(G),Y={data:V,width:L,height:j,glyphWidth:C,glyphHeight:R,glyphTop:E,glyphLeft:0,glyphAdvance:e};if(C===0||R===0)return Y;const{ctx:K,buffer:ue,gridInner:ce,gridOuter:de}=this;K.clearRect(ue,ue,C,R),K.fillText(x,ue,ue+E);const pe=K.getImageData(ue,ue,C,R);de.fill(mt,0,G),ce.fill(0,0,G);for(let be=0;be<R;be++)for(let ge=0;ge<C;ge++){const Te=pe.data[4*(be*C+ge)+3]/255;if(Te===0)continue;const Ee=(be+ue)*L+ge+ue;if(Te===1)de[Ee]=0,ce[Ee]=mt;else{const _e=.5-Te;de[Ee]=_e>0?_e*_e:0,ce[Ee]=_e<0?_e*_e:0}}It(de,0,0,L,j,L,this.f,this.v,this.z),It(ce,ue,ue,C,R,L,this.f,this.v,this.z);for(let be=0;be<G;be++){const ge=Math.sqrt(de[be])-Math.sqrt(ce[be]);V[be]=Math.round(255-255*(ge/this.radius+this.cutoff))}return Y}};class sn{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,s){return c.B(e.expression.evaluate(s))}interpolate(e,s,f){return{x:c.C.number(e.x,s.x,f),y:c.C.number(e.y,s.y,f),z:c.C.number(e.z,s.z,f)}}}let on;class Ye extends c.E{constructor(e){super(),on=on||new c.r({anchor:new c.D(c.v.light.anchor),position:new sn,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(on),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(c.x,e,s))for(const f in e){const g=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,f){return(!f||f.validate!==!1)&&c.y(this,e.call(c.z,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const gt=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class _t extends c.E{constructor(e){super(),this._transitionable=new c.t(gt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,s={}){if(!this._validate(c.G,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in e){const g=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,f={}){return(f==null?void 0:f.validate)!==!1&&c.y(this,e.call(c.z,c.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class qt{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const f=e.join(",")+String(s);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(e,s)),this.dashEntry[f]}getDashRanges(e,s,f){const g=[];let w=e.length%2==1?-e[e.length-1]*f:0,E=e[0]*f,C=!0;g.push({left:w,right:E,isDash:C,zeroLength:e[0]===0});let R=e[0];for(let L=1;L<e.length;L++){C=!C;const j=e[L];w=R*f,R+=j,E=R*f,g.push({left:w,right:E,isDash:C,zeroLength:j===0})}return g}addRoundDash(e,s,f){const g=s/2;for(let w=-f;w<=f;w++){const E=this.width*(this.nextRow+f+w);let C=0,R=e[C];for(let L=0;L<this.width;L++){L/R.right>1&&(R=e[++C]);const j=Math.abs(L-R.left),G=Math.abs(L-R.right),V=Math.min(j,G);let Y;const K=w/f*(g+1);if(R.isDash){const ue=g-Math.abs(K);Y=Math.sqrt(V*V+ue*ue)}else Y=g-Math.sqrt(V*V+K*K);this.data[E+L]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(e){for(let C=e.length-1;C>=0;--C){const R=e[C],L=e[C+1];R.zeroLength?e.splice(C,1):L&&L.isDash===R.isDash&&(L.left=R.left,e.splice(C,1))}const s=e[0],f=e[e.length-1];s.isDash===f.isDash&&(s.left=f.left-this.width,f.right=s.right+this.width);const g=this.width*this.nextRow;let w=0,E=e[w];for(let C=0;C<this.width;C++){C/E.right>1&&(E=e[++w]);const R=Math.abs(C-E.left),L=Math.abs(C-E.right),j=Math.min(R,L);this.data[g+C]=Math.max(0,Math.min(255,(E.isDash?j:-j)+128))}}addDash(e,s){const f=s?7:0,g=2*f+1;if(this.nextRow+g>this.height)return c.w("LineAtlas out of space"),null;let w=0;for(let C=0;C<e.length;C++)w+=e[C];if(w!==0){const C=this.width/w,R=this.getDashRanges(e,this.width,C);s?this.addRoundDash(R,C,f):this.addRegularDash(R)}const E={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:w};return this.nextRow+=g,this.dirty=!0,E}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const Ce="maplibre_preloaded_worker_pool";class ut{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<ut.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ce]}numActive(){return Object.keys(this.active).length}}const wt=Math.floor(U.hardwareConcurrency/2);let Mt,Rt;function Jt(){return Mt||(Mt=new ut),Mt}ut.workerCount=c.H(globalThis)?Math.max(Math.min(wt,3),1):1;class Wt{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const f=this.workerPool.acquire(s);for(let g=0;g<f.length;g++){const w=new c.J(f[g],s);w.name=`Worker ${g}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:e,data:s}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const f of this.actors)f.registerMessageHandler(e,s)}}function Ri(){return Rt||(Rt=new Wt(Jt(),c.K),Rt.registerMessageHandler("GR",(x,e,s)=>c.m(e,s))),Rt}function zn(x,e){const s=c.L();return c.M(s,s,[1,1,0]),c.N(s,s,[.5*x.width,.5*x.height,1]),x.calculatePosMatrix?c.O(s,s,x.calculatePosMatrix(e.toUnwrapped())):s}function Gn(x,e,s,f,g,w,E){var C;const R=function(V,Y,K){if(V)for(const ue of V){const ce=Y[ue];if(ce&&ce.source===K&&ce.type==="fill-extrusion")return!0}else for(const ue in Y){const ce=Y[ue];if(ce.source===K&&ce.type==="fill-extrusion")return!0}return!1}((C=g==null?void 0:g.layers)!==null&&C!==void 0?C:null,e,x.id),L=w.maxPitchScaleFactor(),j=x.tilesIn(f,L,R);j.sort(Ca);const G=[];for(const V of j)G.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(e,s,x._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,g,w,L,zn(x.transform,V.tileID),E?(Y,K)=>E(V.tileID,Y,K):void 0)});return function(V,Y){for(const K in V)for(const ue of V[K])Hi(ue,Y);return V}(function(V){const Y={},K={};for(const ue of V){const ce=ue.queryResults,de=ue.wrappedTileID,pe=K[de]=K[de]||{};for(const be in ce){const ge=ce[be],Te=pe[be]=pe[be]||{},Ee=Y[be]=Y[be]||[];for(const _e of ge)Te[_e.featureIndex]||(Te[_e.featureIndex]=!0,Ee.push(_e))}}return Y}(G),x)}function Ca(x,e){const s=x.tileID,f=e.tileID;return s.overscaledZ-f.overscaledZ||s.canonical.y-f.canonical.y||s.wrap-f.wrap||s.canonical.x-f.canonical.x}function Hi(x,e){const s=x.feature,f=e.getFeatureState(s.layer["source-layer"],s.id);s.source=s.layer.source,s.layer["source-layer"]&&(s.sourceLayer=s.layer["source-layer"]),s.state=f}function Xa(x,e,s){return c._(this,void 0,void 0,function*(){let f=x;if(x.url?f=(yield c.j(e.transformRequest(x.url,"Source"),s)).data:yield U.frameAsync(s),!f)return null;const g=c.Q(c.e(f,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map(w=>w.id)),g})}class Xn{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const s=this._sw,f=this._ne;let g,w;if(e instanceof c.S)g=e,w=e;else{if(!(e instanceof Xn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Xn.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(g=e._sw,w=e._ne,!g||!w)return this}return s||f?(s.lng=Math.min(g.lng,s.lng),s.lat=Math.min(g.lat,s.lat),f.lng=Math.max(w.lng,f.lng),f.lat=Math.max(w.lat,f.lat)):(this._sw=new c.S(g.lng,g.lat),this._ne=new c.S(w.lng,w.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:f}=c.S.convert(e);let g=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(e){return e instanceof Xn?e:e&&new Xn(e)}static fromLngLat(e,s=0){const f=360*s/40075017,g=f/Math.cos(Math.PI/180*e.lat);return new Xn(new c.S(e.lng-g,e.lat-f),new c.S(e.lng+g,e.lat+f))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),s=new c.S(this._ne.lng,this._ne.lat);return new Xn(e,e.lng>s.lng?new c.S(s.lng+360,s.lat):s)}}class br{constructor(e,s,f){this.bounds=Xn.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=f||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),f=Math.floor(c.V(this.bounds.getWest())*s),g=Math.floor(c.U(this.bounds.getNorth())*s),w=Math.ceil(c.V(this.bounds.getEast())*s),E=Math.ceil(c.U(this.bounds.getSouth())*s);return e.x>=f&&e.x<w&&e.y>=g&&e.y<E}}class Pn extends c.E{constructor(e,s,f,g){if(super(),this.id=e,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(s,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Xa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new br(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((w,E)=>{e.reloadPromise={resolve:w,reject:E}})}else e.actor=this.dispatcher.getActor(),g="LT";e.abortController=new AbortController;try{const w=yield e.actor.sendAsync({type:g,data:f},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,w)}catch(w){if(delete e.abortController,e.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const f=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(f.resolve).catch(f.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Wa extends c.E{constructor(e,s,f,g){super(),this.id=e,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},s),c.e(this,c.Q(s,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield Xa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(c.e(this,s),s.bounds&&(this.tileBounds=new br(s.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(s){this._tileJSONRequest=null,this.fire(new c.k(s))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const f=yield $e.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,w=g.gl,E=f.data;e.texture=this.map.painter.getTileTexture(E.width),e.texture?e.texture.update(E,{useMipmap:!0}):(e.texture=new c.T(g,E,w.RGBA,{useMipmap:!0}),e.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class qn extends Wa{constructor(e,s,f,g){super(e,s,f,g),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const g=yield $e.getImage(f,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(g&&g.data){const w=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&e.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const E=c.b(w)&&c.W()?w:yield this.readImageNow(w),C={type:this.type,uid:e.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const R=yield e.actor.sendAsync({type:"LDT",data:C});e.dem=R,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(g){if(delete e.abortController,e.aborted)e.state="unloaded";else if(g)throw e.state="errored",g}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const s=e.width+2,f=e.height+2;try{return new c.R({width:s,height:f},yield c.Y(e,-1,-1,s,f))}catch{}}return U.getImageData(e,1)})}_getNeighboringTiles(e){const s=e.canonical,f=Math.pow(2,s.z),g=(s.x-1+f)%f,w=s.x===0?e.wrap-1:e.wrap,E=(s.x+1+f)%f,C=s.x+1===f?e.wrap+1:e.wrap,R={};return R[new c.Z(e.overscaledZ,w,s.z,g,s.y).key]={backfilled:!1},R[new c.Z(e.overscaledZ,C,s.z,E,s.y).key]={backfilled:!1},s.y>0&&(R[new c.Z(e.overscaledZ,w,s.z,g,s.y-1).key]={backfilled:!1},R[new c.Z(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},R[new c.Z(e.overscaledZ,C,s.z,E,s.y-1).key]={backfilled:!1}),s.y+1<f&&(R[new c.Z(e.overscaledZ,w,s.z,g,s.y+1).key]={backfilled:!1},R[new c.Z(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},R[new c.Z(e.overscaledZ,C,s.z,E,s.y+1).key]={backfilled:!1}),R}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class aa extends c.E{constructor(e,s,f,g){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(g),this._data=s.data,this._options=c.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId,s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(s.buffer!==void 0?s.buffer:128),tolerance:this._pixelsToTileUnits(s.tolerance!==void 0?s.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(s.clusterMaxZoom),minPoints:Math.max(2,s.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(s.clusterRadius||50),log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const s=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${s}"`),s}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(s=>s.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const e=new Xn,s=yield this.getData();let f;switch(s.type){case"FeatureCollection":f=s.features.map(g=>this.getCoordinatesFromGeometry(g.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(s.geometry);break;default:f=this.getCoordinatesFromGeometry(s)}if(f.length==0)return e;for(let g=0;g<f.length-1;g+=2)e.extend([f[g],f[g+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:f}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const s=c.e({type:this.type},this.workerOptions);e?s.dataDiff=e:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(U.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let g=null;f.resourceTiming&&f.resourceTiming[this.id]&&(g=f.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(w,{resourceTiming:g}),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(f))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const f={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;const g=yield this.actor.sendAsync({type:s,data:f},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(g,this.map.painter,s==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Or extends c.E{constructor(e,s,f,g){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=f,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=s}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield $e.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new c.k(s))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(c.a0.fromLngLat);var f;return this.tileID=function(g){const w=c.a1.fromPoints(g),E=w.width(),C=w.height(),R=Math.max(E,C),L=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),j=Math.pow(2,L);return new c.a3(L,Math.floor((w.minX+w.maxX)/2*j),Math.floor((w.minY+w.maxY)/2*j))}(s),this.terrainTileRanges=this._getOverlappingTileRanges(s),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=s.map(g=>this.tileID.getTilePoint(g)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.texture||(this.texture=new c.T(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:s,minY:f,maxX:g,maxY:w}=c.a1.fromPoints(e),E={};for(let C=0;C<=c.a2;C++){const R=Math.pow(2,C),L=Math.floor(s*R),j=Math.floor(f*R),G=Math.floor(g*R),V=Math.floor(w*R);E[C]={minTileX:L,minTileY:j,maxTileX:G,maxTileY:V}}return E}}class Yr extends Or{constructor(e,s,f,g){super(e,s,f,g),this.roundZoom=!0,this.type="video",this.options=s}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield c.a4(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new c.k(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new c.k(new c.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class qr extends Or{constructor(e,s,f,g){super(e,s,f,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new c.k(new c.a5(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a5(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new c.k(new c.a5(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a5(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a5(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,f=s.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(s,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const w in this.tiles){const E=this.tiles[w];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,g=!0)}g&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ol={},gs=x=>{switch(x){case"geojson":return aa;case"image":return Or;case"raster":return Wa;case"raster-dem":return qn;case"vector":return Pn;case"video":return Yr;case"canvas":return qr}return ol[x]},Da="RTLPluginLoaded";class Js extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ri()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(s,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=U.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Da))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Hr=null;function ci(){return Hr||(Hr=new Js),Hr}class dr{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a6(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(g,w){const E={};if(!w)return E;for(const C of g){const R=C.layerIds.map(L=>w.getLayer(L)).filter(Boolean);if(R.length!==0){C.layers=R,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(L=>R.filter(j=>j.id===L)[0]));for(const L of R)E[L.id]=C}}return E}(e.buckets,s==null?void 0:s.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const w=this.buckets[g];if(w instanceof c.a8){if(this.hasSymbolBuckets=!0,!f)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const w=this.buckets[g];if(w instanceof c.a8&&w.hasRTLText){this.hasRTLText=!0,ci().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const w=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(g).queryRadius(w))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a7}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,f,g,w,E,C,R,L,j,G){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:w,scale:E,tileSize:this.tileSize,pixelPosMatrix:j,transform:R,params:C,queryPadding:this.queryPadding*L,getElevation:G},e,s,f):{}}querySourceFeatures(e,s){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),w=s&&s.sourceLayer?s.sourceLayer:"",E=g._geojsonTileLayer||g[w];if(!E)return;const C=c.a9(s&&s.filter),{z:R,x:L,y:j}=this.tileID.canonical,G={z:R,x:L,y:j};for(let V=0;V<E.length;V++){const Y=E.feature(V);if(C.needGeometry){const ce=c.aa(Y,!0);if(!C.filter(new c.F(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!C.filter(new c.F(this.tileID.overscaledZ),Y))continue;const K=f.getId(Y,w),ue=new c.ab(Y,R,L,j,K);ue.tile=G,e.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const f=c.ac(e.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(s)if(this.expirationTime<s)g=!0;else{const w=this.expirationTime-s;w?this.expirationTime=f+Math.max(w,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!s.style.hasLayer(g))continue;const w=this.buckets[g],E=w.layers[0].sourceLayer||"_geojsonTileLayer",C=f[E],R=e[E];if(!C||!R||Object.keys(R).length===0)continue;w.update(R,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const L=s&&s.style&&s.style.getLayer(g);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<U.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=U.now()+e}setDependencies(e,s){const f={};for(const g of s)f[g]=!0;this.dependencies[e]=f}hasDependency(e,s){for(const f of e){const g=this.dependencies[f];if(g){for(const w of s)if(g[w])return!0}}return!1}}class jr{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,f){const g=e.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const w={value:s,timeout:void 0};if(f!==void 0&&(w.timeout=setTimeout(()=>{this.remove(e,w)},f)),this.data[g].push(w),this.order.push(g),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const f=e.wrapped().key,g=s===void 0?0:this.data[f].indexOf(s),w=this.data[f][g];return this.data[f].splice(g,1),w.timeout&&clearTimeout(w.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(w.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const f in this.data)for(const g of this.data[f])e(g.value)||s.push(g);for(const f of s)this.remove(f.value.tileID,f)}}class ad{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,f){const g=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][g]=this.stateChanges[e][g]||{},c.e(this.stateChanges[e][g],f),this.deletedStates[e]===null){this.deletedStates[e]={};for(const w in this.state[e])w!==g&&(this.deletedStates[e][w]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][g]===null){this.deletedStates[e][g]={};for(const w in this.state[e][g])f[w]||(this.deletedStates[e][g][w]=null)}else for(const w in f)this.deletedStates[e]&&this.deletedStates[e][g]&&this.deletedStates[e][g][w]===null&&delete this.deletedStates[e][g][w]}removeFeatureState(e,s,f){if(this.deletedStates[e]===null)return;const g=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},f&&s!==void 0)this.deletedStates[e][g]!==null&&(this.deletedStates[e][g]=this.deletedStates[e][g]||{},this.deletedStates[e][g][f]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][g])for(f in this.deletedStates[e][g]={},this.stateChanges[e][g])this.deletedStates[e][g][f]=null;else this.deletedStates[e][g]=null;else this.deletedStates[e]=null}getState(e,s){const f=String(s),g=c.e({},(this.state[e]||{})[f],(this.stateChanges[e]||{})[f]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const w=this.deletedStates[e][s];if(w===null)return{};for(const E in w)delete g[E]}return g}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const w={};for(const E in this.stateChanges[g])this.state[g][E]||(this.state[g][E]={}),c.e(this.state[g][E],this.stateChanges[g][E]),w[E]=this.state[g][E];f[g]=w}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const w={};if(this.deletedStates[g]===null)for(const E in this.state[g])w[E]={},this.state[g][E]={};else for(const E in this.deletedStates[g]){if(this.deletedStates[g][E]===null)this.state[g][E]={};else for(const C of Object.keys(this.deletedStates[g][E]))delete this.state[g][E][C];w[E]=this.state[g][E]}f[g]=f[g]||{},c.e(f[g],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in e)e[g].setFeatureState(f,s)}}const Do=89.25;function Oe(x,e){const s=c.ag(e.lat,-85.051129,c.ah);return new c.P(c.V(e.lng)*x,c.U(s)*x)}function ee(x,e){return new c.a0(e.x/x,e.y/x).toLngLat()}function ie(x){return x.cameraToCenterDistance*Math.min(.85*Math.tan(c.ad(90-x.pitch)),Math.tan(c.ad(Do-x.pitch)))}function le(x,e){const s=x.canonical,f=e/c.ae(s.z),g=s.x+Math.pow(2,s.z)*x.wrap,w=c.af(new Float64Array(16));return c.M(w,w,[g*f,s.y*f,0]),c.N(w,w,[f/c.$,f/c.$,1]),w}function ve(x,e,s,f,g){const w=c.a0.fromLngLat(x,e),E=g*c.ai(1,x.lat),C=E*Math.cos(c.ad(s)),R=Math.sqrt(E*E-C*C),L=R*Math.sin(c.ad(-f)),j=R*Math.cos(c.ad(-f));return new c.a0(w.x+L,w.y+j,w.z+C)}function De(x,e,s){const f=e.intersectsFrustum(x);if(!s||f===0)return f;const g=e.intersectsPlane(s);return g===0?0:f===2&&g===2?2:1}function Le(x,e,s){let f=0;const g=(s-e)/10;for(let w=0;w<10;w++)f+=g*Math.pow(Math.cos(e+(w+.5)/10*(s-e)),x);return f}function Ze(x,e){return function(s,f,g,w,E){const C=2*((x-1)/c.aj(Math.cos(c.ad(Do-E))/Math.cos(c.ad(Do)))-1),R=Math.acos(g/w),L=2*Le(C-1,0,c.ad(E/2)),j=Math.min(c.ad(Do),R+c.ad(E/2)),G=Le(C-1,Math.min(j,R-c.ad(E/2)),j),V=Math.atan(f/g),Y=Math.hypot(f,g);let K=s;return K+=c.aj(w/Y/Math.max(.5,Math.cos(c.ad(E/2)))),K+=C*c.aj(Math.cos(V))/2,K-=c.aj(Math.max(1,G/L/e))/2,K}}const ze=Ze(9.314,3);function rt(x,e){const s=(e.roundZoom?Math.round:Math.floor)(x.zoom+c.aj(x.tileSize/e.tileSize));return Math.max(0,s)}function Ke(x,e){const s=x.getCameraFrustum(),f=x.getClippingPlane(),g=x.screenPointToMercatorCoordinate(x.getCameraPoint()),w=c.a0.fromLngLat(x.center,x.elevation);g.z=w.z+Math.cos(x.pitchInRadians)*x.cameraToCenterDistance/x.worldSize;const E=x.getCoveringTilesDetailsProvider(),C=E.allowVariableZoom(x,e),R=rt(x,e),L=e.minzoom||0,j=e.maxzoom!==void 0?e.maxzoom:x.maxZoom,G=Math.min(Math.max(0,R),j),V=Math.pow(2,G),Y=[V*g.x,V*g.y,0],K=[V*w.x,V*w.y,0],ue=Math.hypot(w.x-g.x,w.y-g.y),ce=Math.abs(w.z-g.z),de=Math.hypot(ue,ce),pe=Te=>({zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),be=[],ge=[];if(x.renderWorldCopies&&E.allowWorldCopies())for(let Te=1;Te<=3;Te++)be.push(pe(-Te)),be.push(pe(Te));for(be.push(pe(0));be.length>0;){const Te=be.pop(),Ee=Te.x,_e=Te.y;let Ie=Te.fullyVisible;const qe={x:Ee,y:_e,z:Te.zoom},Fe=E.getTileBoundingVolume(qe,Te.wrap,x.elevation,e);if(!Ie){const Et=De(s,Fe,f);if(Et===0)continue;Ie=Et===2}const Ue=E.distanceToTile2d(g.x,g.y,qe,Fe);let We=R;C&&(We=(e.calculateTileZoom||ze)(x.zoom+c.aj(x.tileSize/e.tileSize),Ue,ce,de,x.fov)),We=(e.roundZoom?Math.round:Math.floor)(We),We=Math.max(0,We);const Ct=Math.min(We,j);if(Te.wrap=E.getWrap(w,qe,Te.wrap),Te.zoom>=Ct){if(Te.zoom<L)continue;const Et=G-Te.zoom,ft=Y[0]-.5-(Ee<<Et),Bt=Y[1]-.5-(_e<<Et),gn=e.reparseOverscaled?Math.max(Te.zoom,We):Te.zoom;ge.push({tileID:new c.Z(Te.zoom===j?gn:Te.zoom,Te.wrap,Te.zoom,Ee,_e),distanceSq:c.ak([K[0]-.5-Ee,K[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(ft*ft+Bt*Bt)})}else for(let Et=0;Et<4;Et++)be.push({zoom:Te.zoom+1,x:(Ee<<1)+Et%2,y:(_e<<1)+(Et>>1),wrap:Te.wrap,fullyVisible:Ie})}return ge.sort((Te,Ee)=>Te.distanceSq-Ee.distanceSq).map(Te=>Te.tileID)}const je=c.a1.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class lt extends c.E{constructor(e,s,f){super(),this.id=e,this.dispatcher=f,this.on("data",g=>this._dataHandler(g)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,w,E,C)=>{const R=new(gs(w.type))(g,w,E,C);if(R.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${R.id}`);return R})(e,s,f,this),this._tiles={},this._cache=new jr(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ad,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,f)}catch(g){e.state="errored",g.status!==404?this._source.fire(new c.k(g,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const f=this._tiles[s];f.upload(e),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Ae).map(e=>e.key)}getRenderableIds(e){const s=[];for(const f in this._tiles)this._isIdRenderable(f,e)&&s.push(this._tiles[f]);return e?s.sort((f,g)=>{const w=f.tileID,E=g.tileID,C=new c.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),R=new c.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-E.overscaledZ||R.y-C.y||R.x-C.x}).map(f=>f.tileID.key):s.map(f=>f.tileID).sort(Ae).map(f=>f.key)}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)e?this._reloadTile(s,"expired"):this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(e,s){return c._(this,void 0,void 0,function*(){const f=this._tiles[e];f&&(f.state!=="loading"&&(f.state=s),yield this._loadTile(f,e,s))})}_tileLoaded(e,s,f){e.timeAdded=U.now(),f==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let g=0;g<s.length;g++){const w=s[g];if(e.neighboringTiles&&e.neighboringTiles[w]){const E=this.getTileByID(w);f(e,E),f(E,e)}}function f(g,w){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let E=w.tileID.canonical.x-g.tileID.canonical.x;const C=w.tileID.canonical.y-g.tileID.canonical.y,R=Math.pow(2,g.tileID.canonical.z),L=w.tileID.key;E===0&&C===0||Math.abs(C)>1||(Math.abs(E)>1&&(Math.abs(E+R)===1?E+=R:Math.abs(E-R)===1&&(E-=R)),w.dem&&g.dem&&(g.dem.backfillBorder(w.dem,E,C),g.neighboringTiles&&g.neighboringTiles[L]&&(g.neighboringTiles[L].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,f,g){for(const w in this._tiles){let E=this._tiles[w];if(g[w]||!E.hasData()||E.tileID.overscaledZ<=s||E.tileID.overscaledZ>f)continue;let C=E.tileID;for(;E&&E.tileID.overscaledZ>s+1;){const L=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[L.key],E&&E.hasData()&&(C=L)}let R=C;for(;R.overscaledZ>s;)if(R=R.scaledTo(R.overscaledZ-1),e[R.key]||e[R.canonical.key]){g[C.key]=C;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const f=this._loadedParentTiles[e.key];return f&&f.tileID.overscaledZ>=s?f:null}for(let f=e.overscaledZ-1;f>=s;f--){const g=e.scaledTo(f),w=this._getLoadedTile(g);if(w)return w}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,f=Math.ceil(e.height/this._source.tileSize)+1,g=Math.floor(s*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(w)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const f={};for(const g in this._tiles){const w=this._tiles[g];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+s),f[w.tileID.key]=w}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(e,s,f,g,w,E){const C={},R={},L=Object.keys(e),j=U.now();for(const G of L){const V=e[G],Y=this._tiles[G];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=j)continue;const K=this.findLoadedParent(V,s),ue=this.findLoadedSibling(V),ce=K||ue||null;ce&&(this._addTile(ce.tileID),C[ce.tileID.key]=ce.tileID),R[G]=V}this._retainLoadedChildren(R,g,f,e);for(const G in C)e[G]||(this._coveredTiles[G]=!0,e[G]=C[G]);if(E){const G={},V={};for(const Y of w)this._tiles[Y.key].hasData()?G[Y.key]=Y:V[Y.key]=Y;for(const Y in V){const K=V[Y].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(G[K[0].key]=e[K[0].key]=K[0],G[K[1].key]=e[K[1].key]=K[1],G[K[2].key]=e[K[2].key]=K[2],G[K[3].key]=e[K[3].key]=K[3],delete V[Y])}for(const Y in V){const K=V[Y],ue=this.findLoadedParent(K,this._source.minzoom),ce=this.findLoadedSibling(K),de=ue||ce||null;if(de){G[de.tileID.key]=e[de.tileID.key]=de.tileID;for(const pe in G)G[pe].isChildOf(de.tileID)&&delete G[pe]}}for(const Y in this._tiles)G[Y]||(this._coveredTiles[Y]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let f;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new c.Z(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(f=Ke(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(j=>this._source.hasTile(j)))):f=[];const g=rt(e,this._source),w=Math.max(g-lt.maxOverzooming,this._source.minzoom),E=Math.max(g+lt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const G of f)if(G.canonical.z>this._source.minzoom){const V=G.scaledTo(G.canonical.z-1);j[V.key]=V;const Y=G.scaledTo(Math.max(this._source.minzoom,Math.min(G.canonical.z,5)));j[Y.key]=Y}f=f.concat(Object.values(j))}const C=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const R=this._updateRetainedTiles(f,g);Dt(this._source.type)&&this._updateCoveredAndRetainedTiles(R,w,E,g,f,s);for(const j in R)this._tiles[j].clearFadeHold();const L=c.al(this._tiles,R);for(const j of L){const G=this._tiles[j];G.hasSymbolBuckets&&!G.holdingForFade()?G.setHoldDuration(this.map._fadeDuration):G.hasSymbolBuckets&&!G.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var f;const g={},w={},E=Math.max(s-lt.maxOverzooming,this._source.minzoom),C=Math.max(s+lt.maxUnderzooming,this._source.minzoom),R={};for(const L of e){const j=this._addTile(L);g[L.key]=L,j.hasData()||s<this._source.maxzoom&&(R[L.key]=L)}this._retainLoadedChildren(R,s,C,g);for(const L of e){let j=this._tiles[L.key];if(j.hasData())continue;if(s+1>this._source.maxzoom){const V=L.children(this._source.maxzoom)[0],Y=this.getTile(V);if(Y&&Y.hasData()){g[V.key]=V;continue}}else{const V=L.children(this._source.maxzoom);if(g[V[0].key]&&g[V[1].key]&&g[V[2].key]&&g[V[3].key])continue}let G=j.wasRequested();for(let V=L.overscaledZ-1;V>=E;--V){const Y=L.scaledTo(V);if(w[Y.key])break;if(w[Y.key]=!0,j=this.getTile(Y),!j&&G&&(j=this._addTile(Y)),j){const K=j.hasData();if((K||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||G)&&(g[Y.key]=Y),G=j.wasRequested(),K)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let f,g=this._tiles[e].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}s.push(g.key);const w=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(w),f)break;g=w}for(const w of s)this._loadedParentTiles[w]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,f=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=f}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const f=s;return s||(s=new dr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,f||this._source.fire(new c.l("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const f=s.getExpiryTimeout();f&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},f))}refreshTiles(e){for(const s in this._tiles)(this._isIdRenderable(s)||this._tiles[s].state=="errored")&&e.some(f=>f.equals(this._tiles[s].tileID.canonical))&&this._reloadTile(s,"expired")}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,f){const g=[],w=this.transform;if(!w)return g;const E=w.getCoveringTilesDetailsProvider().allowWorldCopies(),C=f?w.getCameraQueryGeometry(e):e,R=Y=>w.screenPointToMercatorCoordinate(Y,this.terrain),L=this.transformBbox(e,R,!E),j=this.transformBbox(C,R,!E),G=this.getIds(),V=c.a1.fromPoints(j);for(let Y=0;Y<G.length;Y++){const K=this._tiles[G[Y]];if(K.holdingForFade())continue;const ue=E?[K.tileID]:[K.tileID.unwrapTo(-1),K.tileID.unwrapTo(0)],ce=Math.pow(2,w.zoom-K.tileID.overscaledZ),de=s*K.queryPadding*c.$/K.tileSize/ce;for(const pe of ue){const be=V.map(ge=>pe.getTilePoint(new c.a0(ge.x,ge.y)));if(be.expandBy(de),be.intersects(je)){const ge=L.map(Ee=>pe.getTilePoint(Ee)),Te=j.map(Ee=>pe.getTilePoint(Ee));g.push({tile:K,tileID:E?pe:pe.unwrapTo(0),queryGeometry:ge,cameraQueryGeometry:Te,scale:ce})}}}return g}transformBbox(e,s,f){let g=e.map(s);if(f){const w=c.a1.fromPoints(e);w.shrinkBy(.001*Math.min(w.width(),w.height()));const E=w.map(s);c.a1.fromPoints(g).covers(E)||(g=g.map(C=>C.x>.5?new c.a0(C.x-1,C.y,C.z):C))}return g}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(s),s}hasTransition(){if(this._source.hasTransition())return!0;if(Dt(this._source.type)){const e=U.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,f){this._state.updateState(e=e||"_geojsonTileLayer",s,f)}removeFeatureState(e,s,f){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,f)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,f){const g=this._tiles[e];g&&g.setDependencies(s,f)}reloadTilesForDependencies(e,s){for(const f in this._tiles)this._tiles[f].hasDependency(e,s)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(e,s))}}function Ae(x,e){const s=Math.abs(2*x.wrap)-+(x.wrap<0),f=Math.abs(2*e.wrap)-+(e.wrap<0);return x.overscaledZ-e.overscaledZ||f-s||e.canonical.y-x.canonical.y||e.canonical.x-x.canonical.x}function Dt(x){return x==="raster"||x==="image"||x==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;class Kt{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ag(e,0,1);let s=1,f=this._distances[s];const g=e*this.paddedLength+this.padding;for(;f<g&&s<this._distances.length;)f=this._distances[++s];const w=s-1,E=this._distances[w],C=f-E,R=C>0?(g-E)/C:0;return this.points[w].mult(1-R).add(this.points[s].mult(R))}}function Pt(x,e){let s=!0;return x==="always"||x!=="never"&&e!=="never"||(s=!1),s}class Gt{constructor(e,s,f){const g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(e/f),this.yCellCount=Math.ceil(s/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,f,g,w){this._forEachCell(s,f,g,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(w)}insertCircle(e,s,f,g){this._forEachCell(s-g,f-g,s+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(f),this.circles.push(g)}_insertBoxCell(e,s,f,g,w,E){this.boxCells[w].push(E)}_insertCircleCell(e,s,f,g,w,E){this.circleCells[w].push(E)}_query(e,s,f,g,w,E,C){if(f<0||e>this.width||g<0||s>this.height)return[];const R=[];if(e<=0&&s<=0&&this.width<=f&&this.height<=g){if(w)return[{key:null,x1:e,y1:s,x2:f,y2:g}];for(let L=0;L<this.boxKeys.length;L++)R.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const j=this.circles[3*L],G=this.circles[3*L+1],V=this.circles[3*L+2];R.push({key:this.circleKeys[L],x1:j-V,y1:G-V,x2:j+V,y2:G+V})}}else this._forEachCell(e,s,f,g,this._queryCell,R,{hitTest:w,overlapMode:E,seenUids:{box:{},circle:{}}},C);return R}query(e,s,f,g){return this._query(e,s,f,g,!1,null)}hitTest(e,s,f,g,w,E){return this._query(e,s,f,g,!0,w,E).length>0}hitTestCircle(e,s,f,g,w){const E=e-f,C=e+f,R=s-f,L=s+f;if(C<0||E>this.width||L<0||R>this.height)return!1;const j=[];return this._forEachCell(E,R,C,L,this._queryCellCircle,j,{hitTest:!0,overlapMode:g,circle:{x:e,y:s,radius:f},seenUids:{box:{},circle:{}}},w),j.length>0}_queryCell(e,s,f,g,w,E,C,R){const{seenUids:L,hitTest:j,overlapMode:G}=C,V=this.boxCells[w];if(V!==null){const K=this.bboxes;for(const ue of V)if(!L.box[ue]){L.box[ue]=!0;const ce=4*ue,de=this.boxKeys[ue];if(e<=K[ce+2]&&s<=K[ce+3]&&f>=K[ce+0]&&g>=K[ce+1]&&(!R||R(de))&&(!j||!Pt(G,de.overlapMode))&&(E.push({key:de,x1:K[ce],y1:K[ce+1],x2:K[ce+2],y2:K[ce+3]}),j))return!0}}const Y=this.circleCells[w];if(Y!==null){const K=this.circles;for(const ue of Y)if(!L.circle[ue]){L.circle[ue]=!0;const ce=3*ue,de=this.circleKeys[ue];if(this._circleAndRectCollide(K[ce],K[ce+1],K[ce+2],e,s,f,g)&&(!R||R(de))&&(!j||!Pt(G,de.overlapMode))){const pe=K[ce],be=K[ce+1],ge=K[ce+2];if(E.push({key:de,x1:pe-ge,y1:be-ge,x2:pe+ge,y2:be+ge}),j)return!0}}}return!1}_queryCellCircle(e,s,f,g,w,E,C,R){const{circle:L,seenUids:j,overlapMode:G}=C,V=this.boxCells[w];if(V!==null){const K=this.bboxes;for(const ue of V)if(!j.box[ue]){j.box[ue]=!0;const ce=4*ue,de=this.boxKeys[ue];if(this._circleAndRectCollide(L.x,L.y,L.radius,K[ce+0],K[ce+1],K[ce+2],K[ce+3])&&(!R||R(de))&&!Pt(G,de.overlapMode))return E.push(!0),!0}}const Y=this.circleCells[w];if(Y!==null){const K=this.circles;for(const ue of Y)if(!j.circle[ue]){j.circle[ue]=!0;const ce=3*ue,de=this.circleKeys[ue];if(this._circlesCollide(K[ce],K[ce+1],K[ce+2],L.x,L.y,L.radius)&&(!R||R(de))&&!Pt(G,de.overlapMode))return E.push(!0),!0}}}_forEachCell(e,s,f,g,w,E,C,R){const L=this._convertToXCellCoord(e),j=this._convertToYCellCoord(s),G=this._convertToXCellCoord(f),V=this._convertToYCellCoord(g);for(let Y=L;Y<=G;Y++)for(let K=j;K<=V;K++)if(w.call(this,e,s,f,g,this.xCellCount*K+Y,E,C,R))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,f,g,w,E){const C=g-e,R=w-s,L=f+E;return L*L>C*C+R*R}_circleAndRectCollide(e,s,f,g,w,E,C){const R=(E-g)/2,L=Math.abs(e-(g+R));if(L>R+f)return!1;const j=(C-w)/2,G=Math.abs(s-(w+j));if(G>j+f)return!1;if(L<=R||G<=j)return!0;const V=L-R,Y=G-j;return V*V+Y*Y<=f*f}}function Qt(x,e,s){const f=c.L();if(!x){const{vecSouth:G,vecEast:V}=yn(e),Y=I();Y[0]=V[0],Y[1]=V[1],Y[2]=G[0],Y[3]=G[1],g=Y,(j=(E=(w=Y)[0])*(L=w[3])-(R=w[2])*(C=w[1]))&&(g[0]=L*(j=1/j),g[1]=-C*j,g[2]=-R*j,g[3]=E*j),f[0]=Y[0],f[1]=Y[1],f[4]=Y[2],f[5]=Y[3]}var g,w,E,C,R,L,j;return c.N(f,f,[1/s,1/s,1]),f}function xn(x,e,s,f){if(x){const g=c.L();if(!e){const{vecSouth:w,vecEast:E}=yn(s);g[0]=E[0],g[1]=E[1],g[4]=w[0],g[5]=w[1]}return c.N(g,g,[f,f,1]),g}return s.pixelsToClipSpaceMatrix}function yn(x){const e=Math.cos(x.rollInRadians),s=Math.sin(x.rollInRadians),f=Math.cos(x.pitchInRadians),g=Math.cos(x.bearingInRadians),w=Math.sin(x.bearingInRadians),E=c.aq();E[0]=-g*f*s-w*e,E[1]=-w*f*s+g*e;const C=c.ar(E);C<1e-9?c.as(E):c.at(E,E,1/C);const R=c.aq();R[0]=g*f*e-w*s,R[1]=w*f*e+g*s;const L=c.ar(R);return L<1e-9?c.as(R):c.at(R,R,1/L),{vecEast:R,vecSouth:E}}function Dn(x,e,s,f){let g;f?(g=[x,e,f(x,e),1],c.av(g,g,s)):(g=[x,e,0,1],ll(g,g,s));const w=g[3];return{point:new c.P(g[0]/w,g[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function en(x,e){return .5+x/e*.5}function In(x,e){return x.x>=-e[0]&&x.x<=e[0]&&x.y>=-e[1]&&x.y<=e[1]}function Ir(x,e,s,f,g,w,E,C,R,L,j,G,V){const Y=s?x.textSizeData:x.iconSizeData,K=c.am(Y,e.transform.zoom),ue=[256/e.width*2+1,256/e.height*2+1],ce=s?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;ce.clear();const de=x.lineVertexArray,pe=s?x.text.placedSymbolArray:x.icon.placedSymbolArray,be=e.transform.width/e.transform.height;let ge=!1;for(let Te=0;Te<pe.length;Te++){const Ee=pe.get(Te);if(Ee.hidden||Ee.writingMode===c.an.vertical&&!ge){ko(Ee.numGlyphs,ce);continue}ge=!1;const _e=new c.P(Ee.anchorX,Ee.anchorY),Ie={getElevation:V,pitchedLabelPlaneMatrix:f,lineVertexArray:de,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:_e,unwrappedTileID:R,width:L,height:j,translation:G},qe=Ht(Ee.anchorX,Ee.anchorY,Ie);if(!In(qe.point,ue)){ko(Ee.numGlyphs,ce);continue}const Fe=en(e.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Ue=c.ao(Y,K,Ee),We=w?Ue*e.transform.getPitchedTextCorrection(Ee.anchorX,Ee.anchorY,R)/Fe:Ue*Fe,Ct=Si({projectionContext:Ie,pitchedLabelPlaneMatrixInverse:g,symbol:Ee,fontSize:We,flip:!1,keepUpright:E,glyphOffsetArray:x.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:be,rotateToLine:C});ge=Ct.useVertical,(Ct.notEnoughRoom||ge||Ct.needsFlipping&&Si({projectionContext:Ie,pitchedLabelPlaneMatrixInverse:g,symbol:Ee,fontSize:We,flip:!0,keepUpright:E,glyphOffsetArray:x.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:be,rotateToLine:C}).notEnoughRoom)&&ko(Ee.numGlyphs,ce)}s?x.text.dynamicLayoutVertexBuffer.updateData(ce):x.icon.dynamicLayoutVertexBuffer.updateData(ce)}function St(x,e,s,f,g,w,E,C){const R=w.glyphStartIndex+w.numGlyphs,L=w.lineStartIndex,j=w.lineStartIndex+w.lineLength,G=e.getoffsetX(w.glyphStartIndex),V=e.getoffsetX(R-1),Y=Xr(x*G,s,f,g,w.segment,L,j,C,E);if(!Y)return null;const K=Xr(x*V,s,f,g,w.segment,L,j,C,E);return K?C.projectionCache.anyProjectionOccluded?null:{first:Y,last:K}:null}function Ji(x,e,s,f){return x===c.an.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*f?{useVertical:!0}:(x===c.an.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function Si(x){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:s,symbol:f,fontSize:g,flip:w,keepUpright:E,glyphOffsetArray:C,dynamicLayoutVertexArray:R,aspectRatio:L,rotateToLine:j}=x,G=g/24,V=f.lineOffsetX*G,Y=f.lineOffsetY*G;let K;if(f.numGlyphs>1){const ue=f.glyphStartIndex+f.numGlyphs,ce=f.lineStartIndex,de=f.lineStartIndex+f.lineLength,pe=St(G,C,V,Y,w,f,j,e);if(!pe)return{notEnoughRoom:!0};const be=cn(pe.first.point.x,pe.first.point.y,e,s),ge=cn(pe.last.point.x,pe.last.point.y,e,s);if(E&&!w){const Te=Ji(f.writingMode,be,ge,L);if(Te)return Te}K=[pe.first];for(let Te=f.glyphStartIndex+1;Te<ue-1;Te++){const Ee=Xr(G*C.getoffsetX(Te),V,Y,w,f.segment,ce,de,e,j);if(!Ee)return{notEnoughRoom:!0};K.push(Ee)}K.push(pe.last)}else{if(E&&!w){const ce=At(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,de=f.lineStartIndex+f.segment+1,pe=new c.P(e.lineVertexArray.getx(de),e.lineVertexArray.gety(de)),be=At(pe.x,pe.y,e),ge=be.signedDistanceFromCamera>0?be.point:ka(e.tileAnchorPoint,pe,ce,1,e),Te=cn(ce.x,ce.y,e,s),Ee=cn(ge.x,ge.y,e,s),_e=Ji(f.writingMode,Te,Ee,L);if(_e)return _e}const ue=Xr(G*C.getoffsetX(f.glyphStartIndex),V,Y,w,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,e,j);if(!ue||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};K=[ue]}for(const ue of K)c.au(R,ue.point,ue.angle);return{}}function ka(x,e,s,f,g){const w=x.add(x.sub(e)._unit()),E=At(w.x,w.y,g).point,C=s.sub(E);return s.add(C._mult(f/C.mag()))}function Qa(x,e,s){const f=e.projectionCache;if(f.projections[x])return f.projections[x];const g=new c.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),w=At(g.x,g.y,e);if(w.signedDistanceFromCamera>0)return f.projections[x]=w.point,f.anyProjectionOccluded=f.anyProjectionOccluded||w.isOccluded,w.point;const E=x-s.direction;return ka(s.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(E),e.lineVertexArray.gety(E)),g,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function At(x,e,s){const f=x+s.translation[0],g=e+s.translation[1];let w;return s.pitchWithMap?(w=Dn(f,g,s.pitchedLabelPlaneMatrix,s.getElevation),w.isOccluded=!1):(w=s.transform.projectTileCoordinates(f,g,s.unwrappedTileID,s.getElevation),w.point.x=(.5*w.point.x+.5)*s.width,w.point.y=(.5*-w.point.y+.5)*s.height),w}function cn(x,e,s,f){if(s.pitchWithMap){const g=[x,e,0,1];return c.av(g,g,f),s.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],s.unwrappedTileID,s.getElevation).point}return{x:x/s.width*2-1,y:e/s.height*2-1}}function Ht(x,e,s){return s.transform.projectTileCoordinates(x,e,s.unwrappedTileID,s.getElevation)}function ma(x,e,s){return x._unit()._perp()._mult(e*s)}function Yu(x,e,s,f,g,w,E,C,R){if(C.projectionCache.offsets[x])return C.projectionCache.offsets[x];const L=s.add(e);if(x+R.direction<f||x+R.direction>=g)return C.projectionCache.offsets[x]=L,L;const j=Qa(x+R.direction,C,R),G=ma(j.sub(s),E,R.direction),V=s.add(G),Y=j.add(G);return C.projectionCache.offsets[x]=c.aw(w,L,V,Y)||L,C.projectionCache.offsets[x]}function Xr(x,e,s,f,g,w,E,C,R){const L=f?x-e:x+e;let j=L>0?1:-1,G=0;f&&(j*=-1,G=Math.PI),j<0&&(G+=Math.PI);let V,Y=j>0?w+g:w+g+1;C.projectionCache.cachedAnchorPoint?V=C.projectionCache.cachedAnchorPoint:(V=At(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=V);let K,ue,ce=V,de=V,pe=0,be=0;const ge=Math.abs(L),Te=[];let Ee;for(;pe+be<=ge;){if(Y+=j,Y<w||Y>=E)return null;pe+=be,de=ce,ue=K;const qe={absOffsetX:ge,direction:j,distanceFromAnchor:pe,previousVertex:de};if(ce=Qa(Y,C,qe),s===0)Te.push(de),Ee=ce.sub(de);else{let Fe;const Ue=ce.sub(de);Fe=Ue.mag()===0?ma(Qa(Y+j,C,qe).sub(ce),s,j):ma(Ue,s,j),ue||(ue=de.add(Fe)),K=Yu(Y,Fe,ce,w,E,ue,s,C,qe),Te.push(ue),Ee=K.sub(ue)}be=Ee.mag()}const _e=Ee._mult((ge-pe)/be)._add(ue||de),Ie=G+Math.atan2(ce.y-de.y,ce.x-de.x);return Te.push(_e),{point:_e,angle:R?Ie:0,path:Te}}const un=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ko(x,e){for(let s=0;s<x;s++){const f=e.length;e.resize(f+4),e.float32.set(un,3*f)}}function ll(x,e,s){const f=e[0],g=e[1];return x[0]=s[0]*f+s[4]*g+s[12],x[1]=s[1]*f+s[5]*g+s[13],x[3]=s[3]*f+s[7]*g+s[15],x}const Xi=100;class qu{constructor(e,s=new Gt(e.width+200,e.height+200,25),f=new Gt(e.width+200,e.height+200,25)){this.transform=e,this.grid=s,this.ignoredGrid=f,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Xi,this.screenBottomBoundary=e.height+Xi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,f,g,w,E,C,R,L,j,G,V){const Y=this.projectAndGetPerspectiveRatio(e.anchorPointX+R[0],e.anchorPointY+R[1],w,j,V),K=f*Y.perspectiveRatio;let ue;if(E||C)ue=this._projectCollisionBox(e,K,g,w,E,C,R,Y,j,G,V);else{const Ee=Y.x+(G?G.x*K:0),_e=Y.y+(G?G.y*K:0);ue={allPointsOccluded:!1,box:[Ee+e.x1*K,_e+e.y1*K,Ee+e.x2*K,_e+e.y2*K]}}const[ce,de,pe,be]=ue.box,ge=E?ue.allPointsOccluded:Y.isOccluded;let Te=ge;return Te||(Te=Y.perspectiveRatio<this.perspectiveRatioCutoff),Te||(Te=!this.isInsideGrid(ce,de,pe,be)),Te||s!=="always"&&this.grid.hitTest(ce,de,pe,be,s,L)?{box:[ce,de,pe,be],placeable:!1,offscreen:!1,occluded:ge}:{box:[ce,de,pe,be],placeable:!0,offscreen:this.isOffscreen(ce,de,pe,be),occluded:ge}}placeCollisionCircles(e,s,f,g,w,E,C,R,L,j,G,V,Y,K){const ue=[],ce=new c.P(s.anchorX,s.anchorY),de=this.getPerspectiveRatio(ce.x,ce.y,E,K),pe=(L?w*this.transform.getPitchedTextCorrection(s.anchorX,s.anchorY,E)/de:w*de)/c.aA,be={getElevation:K,pitchedLabelPlaneMatrix:C,lineVertexArray:f,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ce,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:Y},ge=St(pe,g,s.lineOffsetX*pe,s.lineOffsetY*pe,!1,s,!1,be);let Te=!1,Ee=!1,_e=!0;if(ge){const Ie=.5*G*de+V,qe=new c.P(-100,-100),Fe=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ue=new Kt,We=ge.first,Ct=ge.last;let Et=[];for(let gn=We.path.length-1;gn>=1;gn--)Et.push(We.path[gn]);for(let gn=1;gn<Ct.path.length;gn++)Et.push(Ct.path[gn]);const ft=2.5*Ie;if(L){const gn=this.projectPathToScreenSpace(Et,be);Et=gn.some(jn=>jn.signedDistanceFromCamera<=0)?[]:gn.map(jn=>jn.point)}let Bt=[];if(Et.length>0){const gn=Et[0].clone(),jn=Et[0].clone();for(let Pi=1;Pi<Et.length;Pi++)gn.x=Math.min(gn.x,Et[Pi].x),gn.y=Math.min(gn.y,Et[Pi].y),jn.x=Math.max(jn.x,Et[Pi].x),jn.y=Math.max(jn.y,Et[Pi].y);Bt=gn.x>=qe.x&&jn.x<=Fe.x&&gn.y>=qe.y&&jn.y<=Fe.y?[Et]:jn.x<qe.x||gn.x>Fe.x||jn.y<qe.y||gn.y>Fe.y?[]:c.ax([Et],qe.x,qe.y,Fe.x,Fe.y)}for(const gn of Bt){Ue.reset(gn,.25*Ie);let jn=0;jn=Ue.length<=.5*Ie?1:Math.ceil(Ue.paddedLength/ft)+1;for(let Pi=0;Pi<jn;Pi++){const ti=Pi/Math.max(jn-1,1),Bi=Ue.lerp(ti),ni=Bi.x+Xi,ii=Bi.y+Xi;ue.push(ni,ii,Ie,0);const oi=ni-Ie,wr=ii-Ie,Rn=ni+Ie,Tr=ii+Ie;if(_e=_e&&this.isOffscreen(oi,wr,Rn,Tr),Ee=Ee||this.isInsideGrid(oi,wr,Rn,Tr),e!=="always"&&this.grid.hitTestCircle(ni,ii,Ie,e,j)&&(Te=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!R&&Te||!Ee||de<this.perspectiveRatioCutoff?[]:ue,offscreen:_e,collisionDetected:Te}}projectPathToScreenSpace(e,s){const f=function(g,w){const E=c.L();return c.ap(E,w.pitchedLabelPlaneMatrix),g.map(C=>{const R=Dn(C.x,C.y,E,w.getElevation),L=w.transform.projectTileCoordinates(R.point.x,R.point.y,w.unwrappedTileID,w.getElevation);return L.point.x=(.5*L.point.x+.5)*w.width,L.point.y=(.5*-L.point.y+.5)*w.height,L})}(e,s);return function(g){let w=0,E=0,C=0,R=0;for(let L=0;L<g.length;L++)g[L].isOccluded?(C=L+1,R=0):(R++,R>E&&(E=R,w=C));return g.slice(w,w+E)}(f)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[],f=new c.a1;for(const G of e){const V=new c.P(G.x+Xi,G.y+Xi);f.extend(V),s.push(V)}const{minX:g,minY:w,maxX:E,maxY:C}=f,R=this.grid.query(g,w,E,C).concat(this.ignoredGrid.query(g,w,E,C)),L={},j={};for(const G of R){const V=G.key;if(L[V.bucketInstanceId]===void 0&&(L[V.bucketInstanceId]={}),L[V.bucketInstanceId][V.featureIndex])continue;const Y=[new c.P(G.x1,G.y1),new c.P(G.x2,G.y1),new c.P(G.x2,G.y2),new c.P(G.x1,G.y2)];c.ay(s,Y)&&(L[V.bucketInstanceId][V.featureIndex]=!0,j[V.bucketInstanceId]===void 0&&(j[V.bucketInstanceId]=[]),j[V.bucketInstanceId].push(V.featureIndex))}return j}insertCollisionBox(e,s,f,g,w,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:w,collisionGroupID:E,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,f,g,w,E){const C=f?this.ignoredGrid:this.grid,R={bucketInstanceId:g,featureIndex:w,collisionGroupID:E,overlapMode:s};for(let L=0;L<e.length;L+=4)C.insertCircle(R,e[L],e[L+1],e[L+2])}projectAndGetPerspectiveRatio(e,s,f,g,w){if(w){let E;g?(E=[e,s,g(e,s),1],c.av(E,E,w)):(E=[e,s,0,1],ll(E,E,w));const C=E[3];return{x:(E[0]/C+1)/2*this.transform.width+Xi,y:(-E[1]/C+1)/2*this.transform.height+Xi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}{const E=this.transform.projectTileCoordinates(e,s,f,g);return{x:(E.point.x+1)/2*this.transform.width+Xi,y:(1-E.point.y)/2*this.transform.height+Xi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(e,s,f,g){const w=this.transform.projectTileCoordinates(e,s,f,g);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(e,s,f,g){return f<Xi||e>=this.screenRightBoundary||g<Xi||s>this.screenBottomBoundary}isInsideGrid(e,s,f,g){return f>=0&&e<this.gridRightBoundary&&g>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=c.af([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,f,g,w,E,C,R,L,j,G){let V=1,Y=0,K=0,ue=1;const ce=e.anchorPointX+C[0],de=e.anchorPointY+C[1];if(E&&!w){const Et=this.projectAndGetPerspectiveRatio(ce+1,de,g,L,G),ft=Et.x-R.x,Bt=Math.atan((Et.y-R.y)/ft)+(ft<0?Math.PI:0),gn=Math.sin(Bt),jn=Math.cos(Bt);V=jn,Y=gn,K=-gn,ue=jn}else if(!E&&w){const Et=yn(this.transform);V=Et.vecEast[0],Y=Et.vecEast[1],K=Et.vecSouth[0],ue=Et.vecSouth[1]}let pe=R.x,be=R.y,ge=s;w&&(pe=ce,be=de,ge=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),ge*=this.transform.getPitchedTextCorrection(ce,de,g),j||(ge*=c.ag(.5+R.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(pe+=V*j.x*ge+K*j.y*ge,be+=Y*j.x*ge+ue*j.y*ge);const Te=e.x1*ge,Ee=e.x2*ge,_e=(Te+Ee)/2,Ie=e.y1*ge,qe=e.y2*ge,Fe=(Ie+qe)/2,Ue=[{offsetX:Te,offsetY:Ie},{offsetX:_e,offsetY:Ie},{offsetX:Ee,offsetY:Ie},{offsetX:Ee,offsetY:Fe},{offsetX:Ee,offsetY:qe},{offsetX:_e,offsetY:qe},{offsetX:Te,offsetY:qe},{offsetX:Te,offsetY:Fe}];let We=[];for(const{offsetX:Et,offsetY:ft}of Ue)We.push(new c.P(pe+V*Et+K*ft,be+Y*Et+ue*ft));let Ct=!1;if(w){const Et=We.map(ft=>this.projectAndGetPerspectiveRatio(ft.x,ft.y,g,L,G));Ct=Et.some(ft=>!ft.isOccluded),We=Et.map(ft=>new c.P(ft.x,ft.y))}else Ct=!0;return{box:c.az(We),allPointsOccluded:!Ct}}}class cl{constructor(e,s,f,g){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Ka{constructor(e,s,f,g,w){this.text=new cl(e?e.text:null,s,f,w),this.icon=new cl(e?e.icon:null,s,g,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ia{constructor(e,s,f){this.text=e,this.icon=s,this.skipFade=f}}class sa{constructor(e,s,f,g,w){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=w}}class zi{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:f=>f.collisionGroupID===s}}return this.collisionGroups[e]}}function Wl(x,e,s,f,g){const{horizontalAlign:w,verticalAlign:E}=c.aG(x);return new c.P(-(w-.5)*e+f[0]*g,-(E-.5)*s+f[1]*g)}class Ql{constructor(e,s,f,g,w){this.transform=e.clone(),this.terrain=s,this.collisionIndex=new qu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new zi(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(f,g)=>s.getElevation(e,f,g):null}getBucketParts(e,s,f,g){const w=f.getBucket(s),E=f.latestFeatureIndex;if(!w||!E||s.id!==w.layerIds[0])return;const C=f.collisionBoxArray,R=w.layers[0].layout,L=w.layers[0].paint,j=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),G=f.tileSize/c.$,V=f.tileID.toUnwrapped(),Y=R.get("text-rotation-alignment")==="map",K=c.aB(f,1,this.transform.zoom),ue=c.aC(this.collisionIndex.transform,f,L.get("text-translate"),L.get("text-translate-anchor")),ce=c.aC(this.collisionIndex.transform,f,L.get("icon-translate"),L.get("icon-translate-anchor")),de=Qt(Y,this.transform,K);this.retainedQueryData[w.bucketInstanceId]=new sa(w.bucketInstanceId,E,w.sourceLayerIndex,w.index,f.tileID);const pe={bucket:w,layout:R,translationText:ue,translationIcon:ce,unwrappedTileID:V,pitchedLabelPlaneMatrix:de,scale:j,textPixelRatio:G,holdingForFade:f.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:c.am(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(g)for(const be of w.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Te,symbolInstanceEnd:Ee}=be;e.push({sortKey:ge,symbolInstanceStart:Te,symbolInstanceEnd:Ee,parameters:pe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(e,s,f,g,w,E,C,R,L,j,G,V,Y,K,ue,ce,de,pe,be,ge){const Te=c.aD[e.textAnchor],Ee=[e.textOffset0,e.textOffset1],_e=Wl(Te,f,g,Ee,w),Ie=this.collisionIndex.placeCollisionBox(s,V,R,L,j,C,E,ce,G.predicate,be,_e,ge);if((!pe||this.collisionIndex.placeCollisionBox(pe,V,R,L,j,C,E,de,G.predicate,be,_e,ge).placeable)&&Ie.placeable){let qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Ee,width:f,height:g,anchor:Te,textBoxScale:w,prevAnchor:qe},this.markUsedJustification(K,Te,Y,ue),K.allowVerticalPlacement&&(this.markUsedOrientation(K,ue,Y),this.placedOrientations[Y.crossTileID]=ue),{shift:_e,placedGlyphBoxes:Ie}}}placeLayerBucketPart(e,s,f){const{bucket:g,layout:w,translationText:E,translationIcon:C,unwrappedTileID:R,pitchedLabelPlaneMatrix:L,textPixelRatio:j,holdingForFade:G,collisionBoxArray:V,partiallyEvaluatedTextSize:Y,collisionGroup:K}=e.parameters,ue=w.get("text-optional"),ce=w.get("icon-optional"),de=c.aE(w,"text-overlap","text-allow-overlap"),pe=de==="always",be=c.aE(w,"icon-overlap","icon-allow-overlap"),ge=be==="always",Te=w.get("text-rotation-alignment")==="map",Ee=w.get("text-pitch-alignment")==="map",_e=w.get("icon-text-fit")!=="none",Ie=w.get("symbol-z-order")==="viewport-y",qe=pe&&(ge||!g.hasIconData()||ce),Fe=ge&&(pe||!g.hasTextData()||ue);!g.collisionArrays&&V&&g.deserializeCollisionBoxes(V);const Ue=this.retainedQueryData[g.bucketInstanceId].tileID,We=this._getTerrainElevationFunc(Ue),Ct=this.transform.getFastPathSimpleProjectionMatrix(Ue),Et=(ft,Bt,gn)=>{var jn,Pi;if(s[ft.crossTileID])return;if(G)return void(this.placements[ft.crossTileID]=new Ia(!1,!1,!1));let ti=!1,Bi=!1,ni=!0,ii=null,oi={box:null,placeable:!1,offscreen:null,occluded:!1},wr={placeable:!1},Rn=null,Tr=null,Gr=null,Cl=0,Yo=0,as=0;Bt.textFeatureIndex?Cl=Bt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(Cl=ft.featureIndex),Bt.verticalTextFeatureIndex&&(Yo=Bt.verticalTextFeatureIndex);const ss=Bt.textBox;if(ss){const Zr=gi=>{let ri=c.an.horizontal;if(g.allowVerticalPlacement&&!gi&&this.prevPlacement){const Nr=this.prevPlacement.placedOrientations[ft.crossTileID];Nr&&(this.placedOrientations[ft.crossTileID]=Nr,ri=Nr,this.markUsedOrientation(g,ri,ft))}return ri},os=(gi,ri)=>{if(g.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Bt.verticalTextBox){for(const Nr of g.writingModes)if(Nr===c.an.vertical?(oi=ri(),wr=oi):oi=gi(),oi&&oi.placeable)break}else oi=gi()},qo=ft.textAnchorOffsetStartIndex,Tc=ft.textAnchorOffsetEndIndex;if(Tc===qo){const gi=(ri,Nr)=>{const Vi=this.collisionIndex.placeCollisionBox(ri,de,j,Ue,R,Ee,Te,E,K.predicate,We,void 0,Ct);return Vi&&Vi.placeable&&(this.markUsedOrientation(g,Nr,ft),this.placedOrientations[ft.crossTileID]=Nr),Vi};os(()=>gi(ss,c.an.horizontal),()=>{const ri=Bt.verticalTextBox;return g.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&ri?gi(ri,c.an.vertical):{box:null,offscreen:null}}),Zr(oi&&oi.placeable)}else{let gi=c.aD[(Pi=(jn=this.prevPlacement)===null||jn===void 0?void 0:jn.variableOffsets[ft.crossTileID])===null||Pi===void 0?void 0:Pi.anchor];const ri=(Vi,bh,nm)=>{const kd=Vi.x2-Vi.x1,fo=Vi.y2-Vi.y1,Sc=ft.textBoxScale,yr=_e&&be==="never"?bh:null;let Ai=null,ea=de==="never"?1:2,Id="never";gi&&ea++;for(let da=0;da<ea;da++){for(let ks=qo;ks<Tc;ks++){const rr=g.textAnchorOffsets.get(ks);if(gi&&rr.textAnchor!==gi)continue;const kl=this.attemptAnchorPlacement(rr,Vi,kd,fo,Sc,Te,Ee,j,Ue,R,K,Id,ft,g,nm,E,C,yr,We);if(kl&&(Ai=kl.placedGlyphBoxes,Ai&&Ai.placeable))return ti=!0,ii=kl.shift,Ai}gi?gi=null:Id=de}return f&&!Ai&&(Ai={box:this.collisionIndex.placeCollisionBox(ss,"always",j,Ue,R,Ee,Te,E,K.predicate,We,void 0,Ct).box,offscreen:!1,placeable:!1,occluded:!1}),Ai};os(()=>ri(ss,Bt.iconBox,c.an.horizontal),()=>{const Vi=Bt.verticalTextBox;return g.allowVerticalPlacement&&(!oi||!oi.placeable)&&ft.numVerticalGlyphVertices>0&&Vi?ri(Vi,Bt.verticalIconBox,c.an.vertical):{box:null,occluded:!0,offscreen:null}}),oi&&(ti=oi.placeable,ni=oi.offscreen);const Nr=Zr(oi&&oi.placeable);if(!ti&&this.prevPlacement){const Vi=this.prevPlacement.variableOffsets[ft.crossTileID];Vi&&(this.variableOffsets[ft.crossTileID]=Vi,this.markUsedJustification(g,Vi.anchor,ft,Nr))}}}if(Rn=oi,ti=Rn&&Rn.placeable,ni=Rn&&Rn.offscreen,ft.useRuntimeCollisionCircles){const Zr=g.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),os=c.ao(g.textSizeData,Y,Zr),qo=w.get("text-padding");Tr=this.collisionIndex.placeCollisionCircles(de,Zr,g.lineVertexArray,g.glyphOffsetArray,os,R,L,f,Ee,K.predicate,ft.collisionCircleDiameter,qo,E,We),Tr.circles.length&&Tr.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),ti=pe||Tr.circles.length>0&&!Tr.collisionDetected,ni=ni&&Tr.offscreen}if(Bt.iconFeatureIndex&&(as=Bt.iconFeatureIndex),Bt.iconBox){const Zr=os=>this.collisionIndex.placeCollisionBox(os,be,j,Ue,R,Ee,Te,C,K.predicate,We,_e&&ii?ii:void 0,Ct);wr&&wr.placeable&&Bt.verticalIconBox?(Gr=Zr(Bt.verticalIconBox),Bi=Gr.placeable):(Gr=Zr(Bt.iconBox),Bi=Gr.placeable),ni=ni&&Gr.offscreen}const Dl=ue||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,gu=ce||ft.numIconVertices===0;Dl||gu?gu?Dl||(Bi=Bi&&ti):ti=Bi&&ti:Bi=ti=Bi&&ti;const wc=Bi&&Gr.placeable;if(ti&&Rn.placeable&&this.collisionIndex.insertCollisionBox(Rn.box,de,w.get("text-ignore-placement"),g.bucketInstanceId,wr&&wr.placeable&&Yo?Yo:Cl,K.ID),wc&&this.collisionIndex.insertCollisionBox(Gr.box,be,w.get("icon-ignore-placement"),g.bucketInstanceId,as,K.ID),Tr&&ti&&this.collisionIndex.insertCollisionCircles(Tr.circles,de,w.get("text-ignore-placement"),g.bucketInstanceId,Cl,K.ID),f&&this.storeCollisionData(g.bucketInstanceId,gn,Bt,Rn,Gr,Tr),ft.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ft.crossTileID]=new Ia((ti||qe)&&!(Rn!=null&&Rn.occluded),(Bi||Fe)&&!(Gr!=null&&Gr.occluded),ni||g.justReloaded),s[ft.crossTileID]=!0};if(Ie){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ft=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Bt=ft.length-1;Bt>=0;--Bt){const gn=ft[Bt];Et(g.symbolInstances.get(gn),g.collisionArrays[gn],gn)}}else for(let ft=e.symbolInstanceStart;ft<e.symbolInstanceEnd;ft++)Et(g.symbolInstances.get(ft),g.collisionArrays[ft],ft);g.justReloaded=!1}storeCollisionData(e,s,f,g,w,E){if(f.textBox||f.iconBox){let C,R;this.collisionBoxArrays.has(e)?C=this.collisionBoxArrays.get(e):(C=new Map,this.collisionBoxArrays.set(e,C)),C.has(s)?R=C.get(s):(R={text:null,icon:null},C.set(s,R)),f.textBox&&(R.text=g.box),f.iconBox&&(R.icon=w.box)}if(E){let C=this.collisionCircleArrays[e];C===void 0&&(C=this.collisionCircleArrays[e]=[]);for(let R=0;R<E.circles.length;R+=4)C.push(E.circles[R+0]-Xi),C.push(E.circles[R+1]-Xi),C.push(E.circles[R+2]),C.push(E.collisionDetected?1:0)}}markUsedJustification(e,s,f,g){let w;w=g===c.an.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.aF(s)];const E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const C of E)C>=0&&(e.text.placedSymbolArray.get(C).crossTileID=w>=0&&C!==w?0:f.crossTileID)}markUsedOrientation(e,s,f){const g=s===c.an.horizontal||s===c.an.horizontalOnly?s:0,w=s===c.an.vertical?s:0,E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const C of E)e.text.placedSymbolArray.get(C).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let f=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const g=s?s.symbolFadeChange(e):1,w=s?s.opacities:{},E=s?s.variableOffsets:{},C=s?s.placedOrientations:{};for(const R in this.placements){const L=this.placements[R],j=w[R];j?(this.opacities[R]=new Ka(j,g,L.text,L.icon),f=f||L.text!==j.text.placed||L.icon!==j.icon.placed):(this.opacities[R]=new Ka(null,g,L.text,L.icon,L.skipFade),f=f||L.text||L.icon)}for(const R in w){const L=w[R];if(!this.opacities[R]){const j=new Ka(L,g,!1,!1);j.isHidden()||(this.opacities[R]=j,f=f||L.text.placed||L.icon.placed)}}for(const R in E)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=E[R]);for(const R in C)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=C[R]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const f={};for(const g of s){const w=g.getBucket(e);w&&g.latestFeatureIndex&&e.id===w.layerIds[0]&&this.updateBucketOpacities(w,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(e,s,f,g){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const w=e.layers[0],E=w.layout,C=new Ka(null,0,!1,!1,!0),R=E.get("text-allow-overlap"),L=E.get("icon-allow-overlap"),j=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),G=E.get("text-rotation-alignment")==="map",V=E.get("text-pitch-alignment")==="map",Y=E.get("icon-text-fit")!=="none",K=new Ka(null,0,R&&(L||!e.hasIconData()||E.get("icon-optional")),L&&(R||!e.hasTextData()||E.get("text-optional")),!0);!e.collisionArrays&&g&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(g);const ue=(de,pe,be)=>{for(let ge=0;ge<pe/4;ge++)de.opacityVertexArray.emplaceBack(be);de.hasVisibleVertices=de.hasVisibleVertices||be!==Xu},ce=this.collisionBoxArrays.get(e.bucketInstanceId);for(let de=0;de<e.symbolInstances.length;de++){const pe=e.symbolInstances.get(de),{numHorizontalGlyphVertices:be,numVerticalGlyphVertices:ge,crossTileID:Te}=pe;let Ee=this.opacities[Te];f[Te]?Ee=C:Ee||(Ee=K,this.opacities[Te]=Ee),f[Te]=!0;const _e=pe.numIconVertices>0,Ie=this.placedOrientations[pe.crossTileID],qe=Ie===c.an.vertical,Fe=Ie===c.an.horizontal||Ie===c.an.horizontalOnly;if(be>0||ge>0){const We=Hu(Ee.text);ue(e.text,be,qe?Xu:We),ue(e.text,ge,Fe?Xu:We);const Ct=Ee.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach(Bt=>{Bt>=0&&(e.text.placedSymbolArray.get(Bt).hidden=Ct||qe?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=Ct||Fe?1:0);const Et=this.variableOffsets[pe.crossTileID];Et&&this.markUsedJustification(e,Et.anchor,pe,Ie);const ft=this.placedOrientations[pe.crossTileID];ft&&(this.markUsedJustification(e,"left",pe,ft),this.markUsedOrientation(e,ft,pe))}if(_e){const We=Hu(Ee.icon),Ct=!(Y&&pe.verticalPlacedIconSymbolIndex&&qe);pe.placedIconSymbolIndex>=0&&(ue(e.icon,pe.numIconVertices,Ct?We:Xu),e.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=Ee.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(ue(e.icon,pe.numVerticalIconVertices,Ct?Xu:We),e.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=Ee.icon.isHidden())}const Ue=ce&&ce.has(de)?ce.get(de):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const We=e.collisionArrays[de];if(We){let Ct=new c.P(0,0);if(We.textBox||We.verticalTextBox){let Et=!0;if(j){const ft=this.variableOffsets[Te];ft?(Ct=Wl(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textBoxScale),G&&Ct._rotate(V?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Et=!1}if(We.textBox||We.verticalTextBox){let ft;We.textBox&&(ft=qe),We.verticalTextBox&&(ft=Fe),$c(e.textCollisionBox.collisionVertexArray,Ee.text.placed,!Et||ft,Ue.text,Ct.x,Ct.y)}}if(We.iconBox||We.verticalIconBox){const Et=!!(!Fe&&We.verticalIconBox);let ft;We.iconBox&&(ft=Et),We.verticalIconBox&&(ft=!Et),$c(e.iconCollisionBox.collisionVertexArray,Ee.icon.placed,ft,Ue.icon,Y?Ct.x:0,Y?Ct.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const f=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*f>e}setStale(){this.stale=!0}}function $c(x,e,s,f,g,w){f&&f.length!==0||(f=[0,0,0,0]);const E=f[0]-Xi,C=f[1]-Xi,R=f[2]-Xi,L=f[3]-Xi;x.emplaceBack(e?1:0,s?1:0,g||0,w||0,E,C),x.emplaceBack(e?1:0,s?1:0,g||0,w||0,R,C),x.emplaceBack(e?1:0,s?1:0,g||0,w||0,R,L),x.emplaceBack(e?1:0,s?1:0,g||0,w||0,E,L)}const Kl=Math.pow(2,25),Io=Math.pow(2,24),Ra=Math.pow(2,17),gf=Math.pow(2,16),$p=Math.pow(2,9),Ro=Math.pow(2,8),yf=Math.pow(2,1);function Hu(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const e=x.placed?1:0,s=Math.floor(127*x.opacity);return s*Kl+e*Io+s*Ra+e*gf+s*$p+e*Ro+s*yf+e}const Xu=0;class Ja{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,f,g,w){const E=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(E,g,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((C,R)=>C.sortKey-R.sortKey));this._currentPartIndex<E.length;)if(s.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,w())return!0;return!1}}class sd{constructor(e,s,f,g,w,E,C,R){this.placement=new Ql(e,s,E,C,R),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(e,s,f){const g=U.now(),w=()=>!this._forceFullPlacement&&U.now()-g>2;for(;this._currentPlacementIndex>=0;){const E=s[e[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=C)&&(!E.maxzoom||E.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Ja(E)),this._inProgressLayer.continuePlacement(f[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Jl=512/c.$/2;class Wu{constructor(e,s,f){this.tileID=e,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let w=0;w<s.length;w++){const E=s.get(w),C=E.key,R=g.get(C);R?R.push(E):g.set(C,[E])}for(const[w,E]of g){const C={positions:E.map(R=>({x:Math.floor(R.anchorX*Jl),y:Math.floor(R.anchorY*Jl)})),crossTileIDs:E.map(R=>R.crossTileID)};if(C.positions.length>128){const R=new c.aH(C.positions.length,16,Uint16Array);for(const{x:L,y:j}of C.positions)R.add(L,j);R.finish(),delete C.positions,C.index=R}this._symbolsByKey[w]=C}}getScaledCoordinates(e,s){const{x:f,y:g,z:w}=this.tileID.canonical,{x:E,y:C,z:R}=s.canonical,L=Jl/Math.pow(2,R-w),j=(C*c.$+e.anchorY)*L,G=g*c.$*Jl;return{x:Math.floor((E*c.$+e.anchorX)*L-f*c.$*Jl),y:Math.floor(j-G)}}findMatches(e,s,f){const g=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let w=0;w<e.length;w++){const E=e.get(w);if(E.crossTileID)continue;const C=this._symbolsByKey[E.key];if(!C)continue;const R=this.getScaledCoordinates(E,s);if(C.index){const L=C.index.range(R.x-g,R.y-g,R.x+g,R.y+g).sort();for(const j of L){const G=C.crossTileIDs[j];if(!f[G]){f[G]=!0,E.crossTileID=G;break}}}else if(C.positions)for(let L=0;L<C.positions.length;L++){const j=C.positions[L],G=C.crossTileIDs[L];if(Math.abs(j.x-R.x)<=g&&Math.abs(j.y-R.y)<=g&&!f[G]){f[G]=!0,E.crossTileID=G;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class ul{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _f{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const f in this.indexes){const g=this.indexes[f],w={};for(const E in g){const C=g[E];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+s),w[C.tileID.key]=C}this.indexes[f]=w}this.lng=e}addBucket(e,s,f){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let w=0;w<s.symbolInstances.length;w++)s.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const g=this.usedCrossTileIDs[e.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>e.overscaledZ)for(const C in E){const R=E[C];R.tileID.isChildOf(e)&&R.findMatches(s.symbolInstances,e,g)}else{const C=E[e.scaledTo(Number(w)).key];C&&C.findMatches(s.symbolInstances,e,g)}}for(let w=0;w<s.symbolInstances.length;w++){const E=s.symbolInstances.get(w);E.crossTileID||(E.crossTileID=f.generate(),g[E.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Wu(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const f of s.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[e][g]}removeStaleBuckets(e){let s=!1;for(const f in this.indexes){const g=this.indexes[f];for(const w in g)e[g[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[w]),delete g[w],s=!0)}return s}}class Qu{constructor(){this.layerIndexes={},this.crossTileIDs=new ul,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,f){let g=this.layerIndexes[e.id];g===void 0&&(g=this.layerIndexes[e.id]=new _f);let w=!1;const E={};g.handleWrapJump(f);for(const C of s){const R=C.getBucket(e);R&&e.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(C.tileID,R,this.crossTileIDs)&&(w=!0),E[R.bucketInstanceId]=!0)}return g.removeStaleBuckets(E)&&(w=!0),w}pruneUnusedLayers(e){const s={};e.forEach(f=>{s[f]=!0});for(const f in this.layerIndexes)s[f]||delete this.layerIndexes[f]}}var zo="void main() {fragColor=vec4(1.0);}";const eo={prelude:En(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:En("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:En("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:En(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:En(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:En(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:En(zo,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:En(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:En(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:En("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:En("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:En(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:En("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:En(zo,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:En(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:En(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:En(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:En(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:En(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:En(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:En(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:En(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:En(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:En(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:En(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:En(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:En(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:En(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:En(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:En(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:En("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:En("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:En("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:En("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:En(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:En("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function En(x,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=e.match(/in ([\w]+) ([\w]+)/g),g=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=w?w.concat(g):g,C={};return{fragmentSource:x=x.replace(s,(R,L,j,G,V)=>(C[V]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${V}
in ${j} ${G} ${V};
#else
uniform ${j} ${G} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${j} ${G} ${V} = u_${V};
#endif
`)),vertexSource:e=e.replace(s,(R,L,j,G,V)=>{const Y=G==="float"?"vec2":"vec4",K=V.match(/color/)?"color":Y;return C[V]?L==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
in ${j} ${Y} a_${V};
out ${j} ${G} ${V};
#else
uniform ${j} ${G} u_${V};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${j} ${G} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${K}(a_${V}, u_${V}_t);
#else
    ${j} ${G} ${V} = u_${V};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
in ${j} ${Y} a_${V};
#else
uniform ${j} ${G} u_${V};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${j} ${G} ${V} = a_${V};
#else
    ${j} ${G} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${j} ${G} ${V} = unpack_mix_${K}(a_${V}, u_${V}_t);
#else
    ${j} ${G} ${V} = u_${V};
#endif
`}),staticAttributes:f,staticUniforms:E}}class to{constructor(e,s,f){this.vertexBuffer=e,this.indexBuffer=s,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ys=c.aI([{name:"a_pos",type:"Int16",components:2}]);const ec="#define PROJECTION_MERCATOR",vf="mercator";class Yc{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return vf}get shaderDefine(){return ec}get shaderPreludeCode(){return eo.projectionMercator}get vertexShaderPreludeCode(){return eo.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,s,f,g,w){if(this._cachedMesh)return this._cachedMesh;const E=new c.aK;E.emplaceBack(0,0),E.emplaceBack(c.$,0),E.emplaceBack(0,c.$),E.emplaceBack(c.$,c.$);const C=e.createVertexBuffer(E,ys.members),R=c.aL.simpleSegment(0,0,4,2),L=new c.aM;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3);const j=e.createIndexBuffer(L);return this._cachedMesh=new to(C,j,R),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class ga{constructor(e=0,s=0,f=0,g=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=f,this.right=g}interpolate(e,s,f){return s.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,s.top,f)),s.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,s.bottom,f)),s.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,s.left,f)),s.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,s.right,f)),this}getCenter(e,s){const f=c.ag((this.left+e-this.right)/2,0,e),g=c.ag((this.top+s-this.bottom)/2,0,s);return new c.P(f,g)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new ga(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function _s(x,e){if(!x.renderWorldCopies||x.lngRange)return;const s=e.lng-x.center.lng;e.lng+=s>180?-360:s<-180?360:0}function mn(x){return Math.max(0,Math.floor(x))}class no{constructor(e,s,f,g,w,E){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=s||0,this._maxZoom=f||22,this._minPitch=g??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=mn(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ga,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,s,f){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=mn(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new ga(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!f&&e.autoCalculateNearFarZ,s&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const s=c.aN(e,-180,180)*Math.PI/180;var f,g,w,E,C,R,L,j,G;this._bearingInRadians!==s&&(this._unmodified=!1,this._bearingInRadians=s,this._calcMatrices(),this._rotationMatrix=I(),f=this._rotationMatrix,w=-this._bearingInRadians,E=(g=this._rotationMatrix)[0],C=g[1],R=g[2],L=g[3],j=Math.sin(w),G=Math.cos(w),f[0]=E*G+R*j,f[1]=C*G+L*j,f[2]=E*-j+R*G,f[3]=C*-j+L*G)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const s=c.ag(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==s&&(this._unmodified=!1,this._pitchInRadians=s,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const s=e/180*Math.PI;this._rollInRadians!==s&&(this._unmodified=!1,this._rollInRadians=s,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aO(this._fovInRadians)}setFov(e){e=c.ag(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ad(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const s=this.getConstrained(this._center,e).zoom;this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this._tileZoom=Math.max(0,Math.floor(s)),this._scale=c.ae(s),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,s){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=s,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,f){this._unmodified=!1,this._edgeInsets.interpolate(e,s,f),this._constrain(),this._calcMatrices()}resize(e,s,f=!0){this._width=e,this._height=s,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Xn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.ah])}getConstrained(e,s){return this._callbacks.getConstrained(e,s)}getCameraQueryGeometry(e,s){if(s.length===1)return[s[0],e];{const{minX:f,minY:g,maxX:w,maxY:E}=c.a1.fromPoints(s).extend(e);return[new c.P(f,g),new c.P(w,g),new c.P(w,E),new c.P(f,E),new c.P(f,g)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(s),this.setZoom(f),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.af(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.af(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,s,f,g){const w=f!==void 0?f:this.bearing,E=g=g!==void 0?g:this.pitch,C=c.a0.fromLngLat(e,s),R=-Math.cos(c.ad(E)),L=Math.sin(c.ad(E)),j=L*Math.sin(c.ad(w)),G=-L*Math.cos(c.ad(w));let V=this.elevation;const Y=s-V;let K;R*Y>=0||Math.abs(R)<.1?(K=1e4,V=s+K*R):K=-Y/R;let ue,ce,de=c.aP(1,C.y),pe=0;do{if(pe+=1,pe>10)break;ce=K/de,ue=new c.a0(C.x+j*ce,C.y+G*ce),de=1/ue.meterInMercatorCoordinateUnits()}while(Math.abs(K-ce*de)>1e-12);return{center:ue.toLngLat(),elevation:V,zoom:c.aj(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const s=c.ai(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/s,g=c.a0.fromLngLat(this.center,this.elevation),w=ve(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=e;const E=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),c.aP(w.z,g.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.ai(1,this.center.lat)*this.worldSize;return ve(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const s=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/s,e.canonical.y/s,1/s/c.$,1/s/c.$]}}class Ku{constructor(e,s){this.min=e,this.max=s,this.center=c.aQ([],c.aR([],this.min,this.max),.5)}quadrant(e){const s=[e%2==0,e<2],f=c.aS(this.min),g=c.aS(this.max);for(let w=0;w<s.length;w++)f[w]=s[w]?this.min[w]:this.center[w],g[w]=s[w]?this.center[w]:this.max[w];return g[2]=this.max[2],new Ku(f,g)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let s=!0;for(let f=0;f<e.planes.length;f++){const g=this.intersectsPlane(e.planes[f]);if(g===0)return 0;g===1&&(s=!1)}return s?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let s=e[3],f=e[3];for(let g=0;g<3;g++)e[g]>0?(s+=e[g]*this.min[g],f+=e[g]*this.max[g]):(f+=e[g]*this.min[g],s+=e[g]*this.max[g]);return s>=0?2:f<0?0:1}}class Ju{distanceToTile2d(e,s,f,g){const w=g.distanceX([e,s]),E=g.distanceY([e,s]);return Math.hypot(w,E)}getWrap(e,s,f){return f}getTileBoundingVolume(e,s,f,g){var w,E;let C=f,R=f;if(g!=null&&g.terrain){const j=new c.Z(e.z,s,e.z,e.x,e.y),G=g.terrain.getMinMaxElevation(j);C=(w=G.minElevation)!==null&&w!==void 0?w:f,R=(E=G.maxElevation)!==null&&E!==void 0?E:f}const L=1<<e.z;return new Ku([s+e.x/L,e.y/L,C],[s+(e.x+1)/L,(e.y+1)/L,R])}allowVariableZoom(e,s){const f=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,g=c.ag(78.5-f/2,0,60);return!!s.terrain||e.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class Br{constructor(e,s,f){this.points=e,this.planes=s,this.aabb=f}static fromInvProjectionMatrix(e,s=1,f=0,g,w){const E=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],C=Math.pow(2,f),R=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>function(Y,K,ue,ce){const de=c.av([],Y,K),pe=1/de[3]/ue*ce;return c.aX(de,de,[pe,pe,1/de[3],pe])}(V,e,s,C));g&&function(V,Y,K,ue){const ce=ue?4:0,de=ue?0:4;let pe=0;const be=[],ge=[];for(let _e=0;_e<4;_e++){const Ie=c.aT([],V[_e+de],V[_e+ce]),qe=c.aY(Ie);c.aQ(Ie,Ie,1/qe),be.push(qe),ge.push(Ie)}for(let _e=0;_e<4;_e++){const Ie=c.aZ(V[_e+ce],ge[_e],K);pe=Ie!==null&&Ie>=0?Math.max(pe,Ie):Math.max(pe,be[_e])}const Te=function(_e,Ie){const qe=c.aT([],_e[Ie[0]],_e[Ie[1]]),Fe=c.aT([],_e[Ie[2]],_e[Ie[1]]),Ue=[0,0,0,0];return c.aU(Ue,c.aV([],qe,Fe)),Ue[3]=-c.aW(Ue,_e[Ie[0]]),Ue}(V,Y),Ee=function(_e,Ie){const qe=c.a_(_e),Fe=c.a$([],_e,1/qe),Ue=c.aT([],Ie,c.aQ([],Fe,c.aW(Ie,Fe))),We=c.a_(Ue);if(We>0){const Ct=Math.sqrt(1-Fe[3]*Fe[3]),Et=c.aQ([],Fe,-Fe[3]),ft=c.aR([],Et,c.aQ([],Ue,Ct/We));return c.b0(Ie,ft)}return null}(K,Te);if(Ee!==null){const _e=Ee/c.aW(ge[0],Te);pe=Math.min(pe,_e)}for(let _e=0;_e<4;_e++){const Ie=Math.min(pe,be[_e]);V[_e+de]=[V[_e+ce][0]+ge[_e][0]*Ie,V[_e+ce][1]+ge[_e][1]*Ie,V[_e+ce][2]+ge[_e][2]*Ie,1]}}(R,E[0],g,w);const L=E.map(V=>{const Y=c.aT([],R[V[0]],R[V[1]]),K=c.aT([],R[V[2]],R[V[1]]),ue=c.aU([],c.aV([],Y,K)),ce=-c.aW(ue,R[V[1]]);return ue.concat(ce)}),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],G=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const V of R)for(let Y=0;Y<3;Y++)j[Y]=Math.min(j[Y],V[Y]),G[Y]=Math.max(G[Y],V[Y]);return new Br(R,L,new Ku(j,G))}}class Li{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,f){return this._helper.interpolatePadding(e,s,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s,f=!0){this._helper.resize(e,s,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,s){}constructor(e,s,f,g,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new no({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,C)=>this.getConstrained(E,C)},e,s,f,g,w),this._coveringTilesDetailsProvider=new Ju}clone(){const e=new Li;return e.apply(this),e}apply(e,s,f){this._helper.apply(e,s,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const s=[new c.b1(0,e)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new c.P(0,0)),g=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),C=Math.floor(Math.min(f.x,g.x,w.x,E.x)),R=Math.floor(Math.max(f.x,g.x,w.x,E.x)),L=1;for(let j=C-L;j<=R+L;j++)j!==0&&s.push(new c.b1(j,e))}return s}getCameraFrustum(){return Br.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const s=this.screenPointToLocation(this.centerPoint,e),f=e?e.getElevationForLngLatZoom(s,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(e,s){const f=c.ai(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(s,f),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),E=c.a0.fromLngLat(e),C=new c.a0(E.x-(g.x-w.x),E.y-(g.y-w.y));this.setCenter(C==null?void 0:C.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,s){return s?this.coordinatePoint(c.a0.fromLngLat(e),s.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a0.fromLngLat(e))}screenPointToLocation(e,s){var f;return(f=this.screenPointToMercatorCoordinate(e,s))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(e,s){if(s){const f=s.pointCoordinate(e);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,s){const f=s||0,g=[e.x,e.y,0,1],w=[e.x,e.y,1,1];c.av(g,g,this._pixelMatrixInverse),c.av(w,w,this._pixelMatrixInverse);const E=g[3],C=w[3],R=g[1]/E,L=w[1]/C,j=g[2]/E,G=w[2]/C,V=j===G?0:(f-j)/(G-j);return new c.a0(c.C.number(g[0]/E,w[0]/C,V)/this.worldSize,c.C.number(R,L,V)/this.worldSize,f)}coordinatePoint(e,s=0,f=this._pixelMatrix){const g=[e.x*this.worldSize,e.y*this.worldSize,s,1];return c.av(g,g,f),new c.P(g[0]/g[3],g[1]/g[3])}getBounds(){const e=Math.max(0,this._helper._height/2-ie(this));return new Xn().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,s){return s?s.pointCoordinate(e)!=null:e.y>this.height/2-ie(this)}calculatePosMatrix(e,s=!1,f){var g;const w=(g=e.key)!==null&&g!==void 0?g:c.b2(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),E=s?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(w)){const L=E.get(w);return f?L.f32:L.f64}const C=le(e,this.worldSize);c.O(C,s?this._alignedProjMatrix:this._viewProjMatrix,C);const R={f64:C,f32:new Float32Array(C)};return E.set(w,R),f?R.f32:R.f64}calculateFogMatrix(e){const s=e.key,f=this._fogMatrixCacheF32;if(f.has(s))return f.get(s);const g=le(e,this.worldSize);return c.O(g,this._fogMatrix,g),f.set(s,new Float32Array(g)),f.get(s)}getConstrained(e,s){s=c.ag(+s,this.minZoom,this.maxZoom);const f={center:new c.S(e.lng,e.lat),zoom:s};let g=this._helper._lngRange;this._helper._renderWorldCopies||g!==null||(g=[-179.9999999999,180-1e-10]);const w=this.tileSize*c.ae(f.zoom);let E=0,C=w,R=0,L=w,j=0,G=0;const{x:V,y:Y}=this.size;if(this._helper._latRange){const be=this._helper._latRange;E=c.U(be[1])*w,C=c.U(be[0])*w,C-E<Y&&(j=Y/(C-E))}g&&(R=c.aN(c.V(g[0])*w,0,w),L=c.aN(c.V(g[1])*w,0,w),L<R&&(L+=w),L-R<V&&(G=V/(L-R)));const{x:K,y:ue}=Oe(w,e);let ce,de;const pe=Math.max(G||0,j||0);if(pe){const be=new c.P(G?(L+R)/2:K,j?(C+E)/2:ue);return f.center=ee(w,be).wrap(),f.zoom+=c.aj(pe),f}if(this._helper._latRange){const be=Y/2;ue-be<E&&(de=E+be),ue+be>C&&(de=C-be)}if(g){const be=(R+L)/2;let ge=K;this._helper._renderWorldCopies&&(ge=c.aN(K,be-w/2,be+w/2));const Te=V/2;ge-Te<R&&(ce=R+Te),ge+Te>L&&(ce=L-Te)}if(ce!==void 0||de!==void 0){const be=new c.P(ce??K,de??ue);f.center=ee(w,be).wrap()}return f}calculateCenterFromCameraLngLatAlt(e,s,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,f,g)}_calculateNearFarZIfNeeded(e,s,f){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=e-g*this._helper._pixelPerMeter/Math.cos(s),E=g<0?w:e,C=Math.PI/2+this.pitchInRadians,R=c.ad(this.fov)*(Math.abs(Math.cos(c.ad(this.roll)))*this.height+Math.abs(Math.sin(c.ad(this.roll)))*this.width)/this.height*(.5+f.y/this.height),L=Math.sin(R)*E/Math.sin(c.ag(Math.PI-C-R,.01,Math.PI-.01)),j=ie(this),G=Math.atan(j/this._helper.cameraToCenterDistance),V=c.ad(.75),Y=G>V?2*G*(.5+f.y/(2*j)):V,K=Math.sin(Y)*E/Math.sin(c.ag(Math.PI-C-Y,.01,Math.PI-.01)),ue=Math.min(L,K);this._helper._farZ=1.01*(Math.cos(Math.PI/2-s)*ue+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,s=Oe(this.worldSize,this.center),f=s.x,g=s.y;this._helper._pixelPerMeter=c.ai(1,this.center.lat)*this.worldSize;const w=c.ad(Math.min(this.pitch,Do)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let C;this._calculateNearFarZIfNeeded(E,w,e),C=new Float64Array(16),c.b3(C,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ap(this._invProjMatrix,C),C[8]=2*-e.x/this._helper._width,C[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b4(C),c.N(C,C,[1,-1,1]),c.M(C,C,[0,0,-this._helper.cameraToCenterDistance]),c.b5(C,C,-this.rollInRadians),c.b6(C,C,this.pitchInRadians),c.b5(C,C,-this.bearingInRadians),c.M(C,C,[-f,-g,0]),this._mercatorMatrix=c.N([],C,[this.worldSize,this.worldSize,this.worldSize]),c.N(C,C,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C),c.M(C,C,[0,0,-this.elevation]),this._viewProjMatrix=C,this._invViewProjMatrix=c.ap([],C);const R=[0,0,-1,1];c.av(R,R,this._invViewProjMatrix),this._cameraPosition=[R[0]/R[3],R[1]/R[3],R[2]/R[3]],this._fogMatrix=new Float64Array(16),c.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-f,-g,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C);const L=this._helper._width%2/2,j=this._helper._height%2/2,G=Math.cos(this.bearingInRadians),V=Math.sin(-this.bearingInRadians),Y=f-Math.round(f)+G*L+V*j,K=g-Math.round(g)+G*j+V*L,ue=new Float64Array(C);if(c.M(ue,ue,[Y>.5?Y-1:Y,K>.5?K-1:K,0]),this._alignedProjMatrix=ue,C=c.ap(new Float64Array(16),this._pixelMatrix),!C)throw new Error("failed to invert matrix");this._pixelMatrixInverse=C,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.av(s,s,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.ai(1,this.center.lat)*this.worldSize;return ve(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,s){const f=c.a0.fromLngLat(e),g=[f.x*this.worldSize,f.y*this.worldSize,s,1];return c.av(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(e){const{overscaledTileID:s,aligned:f,applyTerrainMatrix:g}=e,w=this._helper.getMercatorTileCoordinates(s),E=s?this.calculatePosMatrix(s,f,!0):null;let C;return C=s&&s.terrainRttPosMatrix32f&&g?s.terrainRttPosMatrix32f:E||c.b7(),{mainMatrix:C,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,s,f){return 1}transformLightDirection(e){return c.aS(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,s,f,g){const w=this.calculatePosMatrix(f);let E;g?(E=[e,s,g(e,s),1],c.av(E,E,w)):(E=[e,s,0,1],ll(E,E,w));const C=E[3];return{point:new c.P(E[0]/C,E[1]/C),signedDistanceFromCamera:C,isOccluded:!1}}populateCache(e){for(const s of e)this.calculatePosMatrix(s)}getMatrixForModel(e,s){const f=c.a0.fromLngLat(e,s),g=f.meterInMercatorCoordinateUnits(),w=c.b8();return c.M(w,w,[f.x,f.y,f.z]),c.b5(w,w,Math.PI),c.b6(w,w,Math.PI/2),c.N(w,w,[-g,g,g]),w}getProjectionDataForCustomLayer(e=!0){const s=new c.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:s,applyGlobeMatrix:e}),g=le(s,this.worldSize);c.O(g,this._viewProjMatrix,g),f.tileMercatorCoords=[0,0,1,1];const w=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],E=c.b9();return c.N(E,g,w),f.fallbackMatrix=E,f.mainMatrix=E,f}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Oi(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function fr(x){if(x.useSlerp)if(x.k<1){const e=c.ba(x.startEulerAngles.roll,x.startEulerAngles.pitch,x.startEulerAngles.bearing),s=c.ba(x.endEulerAngles.roll,x.endEulerAngles.pitch,x.endEulerAngles.bearing),f=new Float64Array(4);c.bb(f,e,s,x.k);const g=c.bc(f);x.tr.setRoll(g.roll),x.tr.setPitch(g.pitch),x.tr.setBearing(g.bearing)}else x.tr.setRoll(x.endEulerAngles.roll),x.tr.setPitch(x.endEulerAngles.pitch),x.tr.setBearing(x.endEulerAngles.bearing);else x.tr.setRoll(c.C.number(x.startEulerAngles.roll,x.endEulerAngles.roll,x.k)),x.tr.setPitch(c.C.number(x.startEulerAngles.pitch,x.endEulerAngles.pitch,x.k)),x.tr.setBearing(c.C.number(x.startEulerAngles.bearing,x.endEulerAngles.bearing,x.k))}function ui(x,e,s,f,g){const w=g.padding,E=Oe(g.worldSize,s.getNorthWest()),C=Oe(g.worldSize,s.getNorthEast()),R=Oe(g.worldSize,s.getSouthEast()),L=Oe(g.worldSize,s.getSouthWest()),j=c.ad(-f),G=E.rotate(j),V=C.rotate(j),Y=R.rotate(j),K=L.rotate(j),ue=new c.P(Math.max(G.x,V.x,K.x,Y.x),Math.max(G.y,V.y,K.y,Y.y)),ce=new c.P(Math.min(G.x,V.x,K.x,Y.x),Math.min(G.y,V.y,K.y,Y.y)),de=ue.sub(ce),pe=(g.width-(w.left+w.right+e.left+e.right))/de.x,be=(g.height-(w.top+w.bottom+e.top+e.bottom))/de.y;if(be<0||pe<0)return void Oi();const ge=Math.min(c.aj(g.scale*Math.min(pe,be)),x.maxZoom),Te=c.P.convert(x.offset),Ee=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ad(f)),_e=Te.add(Ee).mult(g.scale/c.ae(ge));return{center:ee(g.worldSize,E.add(R).div(2).sub(_e)),zoom:ge,bearing:f}}class vs{get useGlobeControls(){return!1}handlePanInertia(e,s){return{easingOffset:e,easingCenter:s.center}}handleMapControlsRollPitchBearingZoom(e,s){e.bearingDelta&&s.setBearing(s.bearing+e.bearingDelta),e.pitchDelta&&s.setPitch(s.pitch+e.pitchDelta),e.rollDelta&&s.setRoll(s.roll+e.rollDelta),e.zoomDelta&&s.setZoom(s.zoom+e.zoomDelta)}handleMapControlsPan(e,s,f){e.around.distSqr(s.centerPoint)<.01||s.setLocationAtPoint(f,e.around)}cameraForBoxAndBearing(e,s,f,g,w){return ui(e,s,f,g,w)}handleJumpToCenterZoom(e,s){e.zoom!==(s.zoom!==void 0?+s.zoom:e.zoom)&&e.setZoom(+s.zoom),s.center!==void 0&&e.setCenter(c.S.convert(s.center))}handleEaseTo(e,s){const f=e.zoom,g=e.padding,w={roll:e.roll,pitch:e.pitch,bearing:e.bearing},E={roll:s.roll===void 0?e.roll:s.roll,pitch:s.pitch===void 0?e.pitch:s.pitch,bearing:s.bearing===void 0?e.bearing:s.bearing},C=s.zoom!==void 0,R=!e.isPaddingEqual(s.padding);let L=!1;const j=C?+s.zoom:e.zoom;let G=e.centerPoint.add(s.offsetAsPoint);const V=e.screenPointToLocation(G),{center:Y,zoom:K}=e.getConstrained(c.S.convert(s.center||V),j??f);_s(e,Y);const ue=Oe(e.worldSize,V),ce=Oe(e.worldSize,Y).sub(ue),de=c.ae(K-f);return L=K!==f,{easeFunc:pe=>{if(L&&e.setZoom(c.C.number(f,K,pe)),c.bd(w,E)||fr({startEulerAngles:w,endEulerAngles:E,tr:e,k:pe,useSlerp:w.roll!=E.roll}),R&&(e.interpolatePadding(g,s.padding,pe),G=e.centerPoint.add(s.offsetAsPoint)),s.around)e.setLocationAtPoint(s.around,s.aroundPoint);else{const be=c.ae(e.zoom-f),ge=K>f?Math.min(2,de):Math.max(.5,de),Te=Math.pow(ge,1-pe),Ee=ee(e.worldSize,ue.add(ce.mult(pe*Te)).mult(be));e.setLocationAtPoint(e.renderWorldCopies?Ee.wrap():Ee,G)}},isZooming:L,elevationCenter:Y}}handleFlyTo(e,s){const f=s.zoom!==void 0,g=e.zoom,w=e.getConstrained(c.S.convert(s.center||s.locationAtOffset),f?+s.zoom:g),E=w.center,C=w.zoom;_s(e,E);const R=Oe(e.worldSize,s.locationAtOffset),L=Oe(e.worldSize,E).sub(R),j=L.mag(),G=c.ae(C-g);let V;if(s.minZoom!==void 0){const Y=Math.min(+s.minZoom,g,C),K=e.getConstrained(E,Y).zoom;V=c.ae(K-g)}return{easeFunc:(Y,K,ue,ce)=>{e.setZoom(Y===1?C:g+c.aj(K));const de=Y===1?E:ee(e.worldSize,R.add(L.mult(ue)).mult(K));e.setLocationAtPoint(e.renderWorldCopies?de.wrap():de,ce)},scaleOfZoom:G,targetCenter:E,scaleOfMinZoom:V,pixelPathLength:j}}}class Cn{constructor(e,s,f){this.blendFunction=e,this.blendColor=s,this.mask=f}}Cn.Replace=[1,0],Cn.disabled=new Cn(Cn.Replace,c.be.transparent,[!1,!1,!1,!1]),Cn.unblended=new Cn(Cn.Replace,c.be.transparent,[!0,!0,!0,!0]),Cn.alphaBlended=new Cn([1,771],c.be.transparent,[!0,!0,!0,!0]);const Fr=2305;class hn{constructor(e,s,f){this.enable=e,this.mode=s,this.frontFace=f}}hn.disabled=new hn(!1,1029,Fr),hn.backCCW=new hn(!0,1029,Fr),hn.frontCCW=new hn(!0,1028,Fr);class fn{constructor(e,s,f){this.func=e,this.mask=s,this.range=f}}fn.ReadOnly=!1,fn.ReadWrite=!0,fn.disabled=new fn(519,fn.ReadOnly,[0,1]);const io=7680;class tn{constructor(e,s,f,g,w,E){this.test=e,this.ref=s,this.mask=f,this.fail=g,this.depthFail=w,this.pass=E}}tn.disabled=new tn({func:519,mask:0},0,0,io,io,io);const pr=new WeakMap;function er(x){var e;if(pr.has(x))return pr.get(x);{const s=(e=x.getParameter(x.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return pr.set(x,s),s}}class No{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const s=e.context,f=s.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const g=new c.aK;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const w=new c.aM;w.emplaceBack(0,1,2),this._fullscreenTriangle=new to(s.createVertexBuffer(g,ys.members),s.createIndexBuffer(w),c.aL.simpleSegment(0,0,g.length,w.length)),this._resultBuffer=new Uint8Array(4),s.activeTexture.set(f.TEXTURE1);const E=f.createTexture();f.bindTexture(f.TEXTURE_2D,E),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=s.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),er(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,s){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,s),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,s=e.gl;e.activeTexture.set(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,s){const f=this._cachedRenderContext.context,g=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:c.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,g.TRIANGLES,fn.disabled,tn.disabled,Cn.unblended,hn.disabled,((w,E)=>({u_input:w,u_output_expected:E}))(e,s),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&er(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const w=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&er(e)){const s=e.clientWaitSync(this._readbackQueue.sync,0,0);if(s===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(s===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=No._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let s=0;return s+=e[0]/256,s+=e[1]/65536,s+=e[2]/16777216,e[3]<127&&(s=-s),s/128}}const Wr=c.$/128;function xf(x,e){const s=x.granularity!==void 0?Math.max(x.granularity,1):1,f=s+(x.generateBorders?2:0),g=s+(x.extendToNorthPole||x.generateBorders?1:0)+(x.extendToSouthPole||x.generateBorders?1:0),w=f+1,E=g+1,C=x.generateBorders?-1:0,R=x.generateBorders||x.extendToNorthPole?-1:0,L=s+(x.generateBorders?1:0),j=s+(x.generateBorders||x.extendToSouthPole?1:0),G=w*E,V=f*g*6,Y=w*E>65536;if(Y&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const K=Y||e==="32bit",ue=new Int16Array(2*G);let ce=0;for(let be=R;be<=j;be++)for(let ge=C;ge<=L;ge++){let Te=ge/s*c.$;ge===-1&&(Te=-64),ge===s+1&&(Te=c.$+Wr);let Ee=be/s*c.$;be===-1&&(Ee=x.extendToNorthPole?c.bg:-64),be===s+1&&(Ee=x.extendToSouthPole?c.bh:c.$+Wr),ue[ce++]=Te,ue[ce++]=Ee}const de=K?new Uint32Array(V):new Uint16Array(V);let pe=0;for(let be=0;be<g;be++)for(let ge=0;ge<f;ge++){const Te=ge+1+be*w,Ee=ge+(be+1)*w,_e=ge+1+(be+1)*w;de[pe++]=ge+be*w,de[pe++]=Ee,de[pe++]=Te,de[pe++]=Te,de[pe++]=Ee,de[pe++]=_e}return{vertices:ue.buffer.slice(0),indices:de.buffer.slice(0),uses32bitIndices:K}}const es=new c.aJ({fill:new c.bi(128,2),line:new c.bi(512,0),tile:new c.bi(128,32),stencil:new c.bi(128,1),circle:3});class od{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return eo.projectionGlobe}get vertexShaderPreludeCode(){return eo.projectionMercator.vertexSource}get subdivisionGranularity(){return es}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new No(e));const s=c.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(s,f),w=U.now();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=w);const E=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bk(E))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,s,f,g,w){const E=(w==="stencil"?es.stencil:es.tile).getGranularityForZoomLevel(s.z);return this._getMesh(e,{granularity:E,generateBorders:f,extendToNorthPole:s.y===0&&g,extendToSouthPole:s.y===(1<<s.z)-1&&g})}_getMesh(e,s){const f=this._getMeshKey(s);if(f in this._tileMeshCache)return this._tileMeshCache[f];const g=function(w,E){const C=xf(E,"16bit"),R=c.aK.deserialize({arrayBuffer:C.vertices,length:C.vertices.byteLength/2/2}),L=c.aM.deserialize({arrayBuffer:C.indices,length:C.indices.byteLength/2/3});return new to(w.createVertexBuffer(R,ys.members),w.createIndexBuffer(L),c.aL.simpleSegment(0,0,R.length,L.length))}(e,s);return this._tileMeshCache[f]=g,g}recalculate(e){}hasTransition(){const e=U.now();let s=!1;return s=s||(e-this._errorMeasurementLastChangeTime)/1e3<.7,s=s||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,s}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const qc=new c.r({type:new c.D(c.v.projection.type)});class hl extends c.E{constructor(e){super(),this._transitionable=new c.t(qc),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new Yc,this._verticalPerspectiveProjection=new od}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bl){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,s,f,g,w){return this.currentProjection.getMeshFromTileID(e,s,f,g,w)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Hc(x){const e=Xc(x.worldSize,x.center.lat);return 2*Math.PI*e}function xs(x,e,s,f,g){const w=1/(1<<g),E=e/c.$*w+f*w,C=c.bn((x/c.$*w+s*w)*Math.PI*2+Math.PI,2*Math.PI),R=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,L=Math.cos(R),j=new Float64Array(3);return j[0]=Math.sin(C)*L,j[1]=Math.sin(R),j[2]=Math.cos(C)*L,j}function Rr(x){return function(e,s){const f=Math.cos(s),g=new Float64Array(3);return g[0]=Math.sin(e)*f,g[1]=Math.sin(s),g[2]=Math.cos(e)*f,g}(x.lng*Math.PI/180,x.lat*Math.PI/180)}function Xc(x,e){return x/(2*Math.PI)/Math.cos(e*Math.PI/180)}function tc(x){const e=Math.asin(x[1])/Math.PI*180,s=Math.sqrt(x[0]*x[0]+x[2]*x[2]);if(s>1e-6){const f=x[0]/s,g=Math.acos(x[2]/s),w=(f>0?g:-g)/Math.PI*180;return new c.S(c.aN(w,-180,180),e)}return new c.S(0,e)}function Wc(x){return Math.cos(x*Math.PI/180)}function mr(x,e){const s=Wc(x),f=Wc(e);return c.aj(f/s)}function eh(x,e){const s=x.rotate(e.bearingInRadians),f=e.zoom+mr(e.center.lat,0),g=c.bj(1/Wc(e.center.lat),1/Wc(Math.min(Math.abs(e.center.lat),60)),c.bm(f,7,3,0,1)),w=360/Hc({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-s.x*w*g,c.ag(e.center.lat+s.y*w,-85.051129,c.ah))}function Qc(x){const e=.5*x,s=Math.sin(e),f=Math.cos(e);return Math.log(s+f)-Math.log(f-s)}function Kc(x,e,s,f){const g=x.lat+s*f;if(Math.abs(s)>1){const w=(Math.sign(x.lat+s)!==Math.sign(x.lat)?-Math.abs(x.lat):Math.abs(x.lat))*Math.PI/180,E=Math.abs(x.lat+s)*Math.PI/180,C=Qc(w+f*(E-w)),R=Qc(w),L=Qc(E);return new c.S(x.lng+e*((C-R)/(L-R)),g)}return new c.S(x.lng+e*f,g)}class Yp{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,s,f,g){const w=`${e.z}_${e.x}_${e.y}_${g!=null&&g.terrain?"t":""}`,E=this._cache.get(w);if(E)return E;const C=this._cachePrevious.get(w);if(C)return this._cache.set(w,C),C;const R=this._boundingVolumeFactory(e,s,f,g);return this._cache.set(w,R),this._hadAnyChanges=!0,R}}class dl{constructor(e,s,f,g){this.min=f,this.max=g,this.points=e,this.planes=s}static fromAabb(e,s){const f=[];for(let g=0;g<8;g++)f.push([1&~g?e[0]:s[0],(g>>1&1)==1?s[1]:e[1],(g>>2&1)==1?s[2]:e[2]]);return new dl(f,[[-1,0,0,s[0]],[1,0,0,-e[0]],[0,-1,0,s[1]],[0,1,0,-e[1]],[0,0,-1,s[2]],[0,0,1,-e[2]]],e,s)}static fromCenterSizeAngles(e,s,f){const g=c.bq([],f[0],f[1],f[2]),w=c.br([],[s[0],0,0],g),E=c.br([],[0,s[1],0],g),C=c.br([],[0,0,s[2]],g),R=[...e],L=[...e];for(let G=0;G<8;G++)for(let V=0;V<3;V++){const Y=e[V]+w[V]*(1&~G?-1:1)+E[V]*((G>>1&1)==1?1:-1)+C[V]*((G>>2&1)==1?1:-1);R[V]=Math.min(R[V],Y),L[V]=Math.max(L[V],Y)}const j=[];for(let G=0;G<8;G++){const V=[...e];c.aR(V,V,c.aQ([],w,1&~G?-1:1)),c.aR(V,V,c.aQ([],E,(G>>1&1)==1?1:-1)),c.aR(V,V,c.aQ([],C,(G>>2&1)==1?1:-1)),j.push(V)}return new dl(j,[[...w,-c.aW(w,j[0])],[...E,-c.aW(E,j[0])],[...C,-c.aW(C,j[0])],[-w[0],-w[1],-w[2],-c.aW(w,j[7])],[-E[0],-E[1],-E[2],-c.aW(E,j[7])],[-C[0],-C[1],-C[2],-c.aW(C,j[7])]],R,L)}intersectsFrustum(e){let s=!0;const f=this.points.length,g=this.planes.length,w=e.planes.length,E=e.points.length;for(let C=0;C<w;C++){const R=e.planes[C];let L=0;for(let j=0;j<f;j++){const G=this.points[j];R[0]*G[0]+R[1]*G[1]+R[2]*G[2]+R[3]>=0&&L++}if(L===0)return 0;L<f&&(s=!1)}if(s)return 2;for(let C=0;C<g;C++){const R=this.planes[C];let L=0;for(let j=0;j<E;j++){const G=e.points[j];R[0]*G[0]+R[1]*G[1]+R[2]*G[2]+R[3]>=0&&L++}if(L===0)return 0}return 1}intersectsPlane(e){const s=this.points.length;let f=0;for(let g=0;g<s;g++){const w=this.points[g];e[0]*w[0]+e[1]*w[1]+e[2]*w[2]+e[3]>=0&&f++}return f===s?2:f===0?0:1}}function th(x,e,s){const f=x-e;return f<0?-f:Math.max(0,f-s)}function bf(x,e,s,f,g){const w=x-s;let E;return E=w<0?Math.min(-w,1+w-g):w>1?Math.min(Math.max(w-g,0),1-w):0,Math.max(E,th(e,f,g))}class bg{constructor(){this._boundingVolumeCache=new Yp(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,s,f,g){const w=1<<f.z,E=1/w,C=f.x/w,R=f.y/w;let L=2;return L=Math.min(L,bf(e,s,C,R,E)),L=Math.min(L,bf(e,s,C+.5,-R-E,E)),L=Math.min(L,bf(e,s,C+.5,2-R-E,E)),L}getWrap(e,s,f){const g=1<<s.z,w=1/g,E=s.x/g,C=th(e.x,E,w),R=th(e.x,E-1,w),L=th(e.x,E+1,w),j=Math.min(C,R,L);return j===L?1:j===R?-1:0}allowVariableZoom(e,s){return rt(e,s)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,s,f,g){return this._boundingVolumeCache.getTileBoundingVolume(e,s,f,g)}_computeTileBoundingVolume(e,s,f,g){var w,E;let C=f,R=f;if(g!=null&&g.terrain){const L=new c.Z(e.z,s,e.z,e.x,e.y),j=g.terrain.getMinMaxElevation(L);C=(w=j.minElevation)!==null&&w!==void 0?w:f,R=(E=j.maxElevation)!==null&&E!==void 0?E:f}if(C/=c.bt,R/=c.bt,C+=1,R+=1,e.z<=0)return dl.fromAabb([-R,-R,-R],[R,R,R]);if(e.z===1)return dl.fromAabb([e.x===0?-R:0,e.y===0?0:-R,-R],[e.x===0?0:R,e.y===0?R:0,R]);{const L=[xs(0,0,e.x,e.y,e.z),xs(c.$,0,e.x,e.y,e.z),xs(c.$,c.$,e.x,e.y,e.z),xs(0,c.$,e.x,e.y,e.z)],j=[];for(const Ue of L)j.push(c.aQ([],Ue,R));if(R!==C)for(const Ue of L)j.push(c.aQ([],Ue,C));e.y===0&&j.push([0,1,0]),e.y===(1<<e.z)-1&&j.push([0,-1,0]);const G=[1,1,1],V=[-1,-1,-1];for(const Ue of j)for(let We=0;We<3;We++)G[We]=Math.min(G[We],Ue[We]),V[We]=Math.max(V[We],Ue[We]);const Y=xs(c.$/2,c.$/2,e.x,e.y,e.z),K=c.aV([],[0,1,0],Y);c.aU(K,K);const ue=c.aV([],Y,K);c.aU(ue,ue);const ce=c.aV([],L[2],L[1]);c.aU(ce,ce);const de=c.aV([],L[0],L[3]);c.aU(de,de),j.push(c.aQ([],Y,R)),e.y>=(1<<e.z)/2&&j.push(c.aQ([],xs(c.$/2,0,e.x,e.y,e.z),R)),e.y<(1<<e.z)/2&&j.push(c.aQ([],xs(c.$/2,c.$,e.x,e.y,e.z),R));const pe=Ur(Y,j),be=Ur(ue,j),ge=[-Y[0],-Y[1],-Y[2],pe.max],Te=[Y[0],Y[1],Y[2],-pe.min],Ee=[-ue[0],-ue[1],-ue[2],be.max],_e=[ue[0],ue[1],ue[2],-be.min],Ie=[...ce,0],qe=[...de,0],Fe=[];return e.y===0?Fe.push(c.bs(qe,Ie,ge),c.bs(qe,Ie,Te)):Fe.push(c.bs(Ee,Ie,ge),c.bs(Ee,Ie,Te),c.bs(Ee,qe,ge),c.bs(Ee,qe,Te)),e.y===(1<<e.z)-1?Fe.push(c.bs(qe,Ie,ge),c.bs(qe,Ie,Te)):Fe.push(c.bs(_e,Ie,ge),c.bs(_e,Ie,Te),c.bs(_e,qe,ge),c.bs(_e,qe,Te)),new dl(Fe,[ge,Te,Ee,_e,Ie,qe],G,V)}}}function Ur(x,e){let s=1/0,f=-1/0;for(const g of e){const w=c.aW(x,g);s=Math.min(s,w),f=Math.max(f,w)}return{min:s,max:f}}class Jc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,f){return this._helper.interpolatePadding(e,s,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s){this._helper.resize(e,s)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bu(),this._projectionMatrix=c.b8(),this._globeViewProjMatrix32f=c.b7(),this._globeViewProjMatrixNoCorrection=c.b8(),this._globeViewProjMatrixNoCorrectionInverted=c.b8(),this._globeProjMatrixInverted=c.b8(),this._cameraPosition=c.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new no({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,s)=>this.getConstrained(e,s)}),this._coveringTilesDetailsProvider=new bg}clone(){const e=new Jc;return e.apply(this),e}apply(e,s){this._globeLatitudeErrorCorrectionRadians=s||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bo();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:s,applyGlobeMatrix:f}=e,g=this._helper.getMercatorTileCoordinates(s);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const s=this.pitchInRadians,f=this.cameraToCenterDistance/e,g=Math.sin(s)*f,w=Math.cos(s)*f+1,E=1/Math.sqrt(g*g+w*w)*1;let C=-g,R=w;const L=Math.sqrt(C*C+R*R);C/=L,R/=L;const j=[0,C,R];c.bv(j,j,[0,0,0],-this.bearingInRadians),c.bw(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),c.bx(j,j,[0,0,0],this.center.lng*Math.PI/180);const G=1/c.aY(j);return c.aQ(j,j,G),[...j,-E*G]}isLocationOccluded(e){return!this.isSurfacePointVisible(Rr(e))}transformLightDirection(e){const s=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,g=Math.cos(f),w=[Math.sin(s)*g,Math.sin(f),Math.cos(s)*g],E=[w[2],0,-w[0]],C=[0,0,0];c.aV(C,E,w),c.aU(E,E),c.aU(C,C);const R=[0,0,0];return c.aU(R,[E[0]*e[0]+C[0]*e[1]+w[0]*e[2],E[1]*e[0]+C[1]*e[1]+w[1]*e[2],E[2]*e[0]+C[2]*e[1]+w[2]*e[2]]),R}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,s,f){const g=function(C,R,L){const j=1/(1<<L.z);return new c.a0(C/c.$*j+L.x*j,R/c.$*j+L.y*j)}(e,s,f.canonical),w=(E=g.y,[c.bn(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(e,s,f,g){const w=f.canonical,E=xs(e,s,w.x,w.y,w.z),C=1+(g?g(e,s):0)/c.bt,R=[E[0]*C,E[1]*C,E[2]*C,1];c.av(R,R,this._globeViewProjMatrixNoCorrection);const L=this._cachedClippingPlane,j=L[0]*E[0]+L[1]*E[1]+L[2]*E[2]+L[3]<0;return{point:new c.P(R[0]/R[3],R[1]/R[3]),signedDistanceFromCamera:R[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Xc(this.worldSize,this.center.lat),s=c.b9(),f=c.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b3(s,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;s[8]=2*-g.x/this._helper._width,s[9]=2*g.y/this._helper._height,this._projectionMatrix=c.b4(s),this._globeProjMatrixInverted=c.b9(),c.ap(this._globeProjMatrixInverted,s),c.M(s,s,[0,0,-this.cameraToCenterDistance]),c.b5(s,s,this.rollInRadians),c.b6(s,s,-this.pitchInRadians),c.b5(s,s,this.bearingInRadians),c.M(s,s,[0,0,-e]);const w=c.bo();w[0]=e,w[1]=e,w[2]=e,c.b6(f,s,this.center.lat*Math.PI/180),c.by(f,f,-this.center.lng*Math.PI/180),c.N(f,f,w),this._globeViewProjMatrixNoCorrection=f,c.b6(s,s,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.by(s,s,-this.center.lng*Math.PI/180),c.N(s,s,w),this._globeViewProjMatrix32f=new Float32Array(s),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),c.ap(this._globeViewProjMatrixNoCorrectionInverted,f);const E=c.bo();this._cameraPosition=c.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bv(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),c.bw(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),c.bv(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),c.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bw(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),c.bx(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const C=c.b4(this._globeViewProjMatrixNoCorrectionInverted);c.N(C,C,[1,1,-1]),this._cachedFrustum=Br.fromInvProjectionMatrix(C,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const s=c.b9();return c.af(s),s}getVisibleUnwrappedCoordinates(e){return[new c.b1(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,s){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=Rr(e);c.aQ(f,f,1+s/c.bt);const g=c.bu();return c.av(g,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(e){}getBounds(){const e=.5*this.width,s=.5*this.height,f=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,s),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,s)],g=[];for(const G of f)g.push(this.unprojectScreenPoint(G));let w=0,E=0,C=0,R=0;const L=this.center;for(const G of g){const V=c.bz(L.lng,G.lng),Y=c.bz(L.lat,G.lat);V<E&&(E=V),V>w&&(w=V),Y<R&&(R=Y),Y>C&&(C=Y)}const j=[L.lng+E,L.lat+R,L.lng+w,L.lat+C];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new Xn(j)}getConstrained(e,s){const f=c.ag(e.lat,-85.051129,c.ah),g=c.ag(+s,this.minZoom+mr(0,f),this.maxZoom);return{center:new c.S(e.lng,f),zoom:g}}calculateCenterFromCameraLngLatAlt(e,s,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,f,g)}setLocationAtPoint(e,s){const f=Rr(this.unprojectScreenPoint(s)),g=Rr(e),w=c.bo();c.bA(w);const E=c.bo();c.bx(E,f,w,-this.center.lng*Math.PI/180),c.bw(E,E,w,this.center.lat*Math.PI/180);const C=g[0]*g[0]+g[2]*g[2],R=E[0]*E[0];if(C<R)return;const L=Math.sqrt(C-R),j=-L,G=c.bB(g[0],g[2],E[0],L),V=c.bB(g[0],g[2],E[0],j),Y=c.bo();c.bx(Y,g,w,-G);const K=c.bB(Y[1],Y[2],E[1],E[2]),ue=c.bo();c.bx(ue,g,w,-V);const ce=c.bB(ue[1],ue[2],E[1],E[2]),de=.5*Math.PI,pe=K>=-de&&K<=de,be=ce>=-de&&ce<=de;let ge,Te;if(pe&&be){const qe=this.center.lng*Math.PI/180,Fe=this.center.lat*Math.PI/180;c.bC(G,qe)+c.bC(K,Fe)<c.bC(V,qe)+c.bC(ce,Fe)?(ge=G,Te=K):(ge=V,Te=ce)}else if(pe)ge=G,Te=K;else{if(!be)return;ge=V,Te=ce}const Ee=ge/Math.PI*180,_e=Te/Math.PI*180,Ie=this.center.lat;this.setCenter(new c.S(Ee,c.ag(_e,-90,90))),this.setZoom(this.zoom+mr(Ie,this.center.lat))}locationToScreenPoint(e,s){const f=Rr(e);if(s){const g=s.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aQ(f,f,1+g/c.bt)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(e){const s=c.bu();return c.av(s,[...e,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],new c.P((.5*s[0]+.5)*this.width,(.5*-s[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,s){if(s){const f=s.pointCoordinate(e);if(f)return f}return c.a0.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,s){var f;return(f=this.screenPointToMercatorCoordinate(e,s))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(e,s){const f=this._cameraPosition,g=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(f,g)}getRayDirectionFromPixel(e){const s=c.bu();s[0]=e.x/this.width*2-1,s[1]=-1*(e.y/this.height*2-1),s[2]=1,s[3]=1,c.av(s,s,this._globeViewProjMatrixNoCorrectionInverted),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3];const f=c.bo();f[0]=s[0]-this._cameraPosition[0],f[1]=s[1]-this._cameraPosition[1],f[2]=s[2]-this._cameraPosition[2];const g=c.bo();return c.aU(g,f),g}isSurfacePointVisible(e){const s=this._cachedClippingPlane;return s[0]*e[0]+s[1]*e[1]+s[2]*e[2]+s[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const s=c.bu();return c.av(s,[...e,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3],s[0]>-1&&s[0]<1&&s[1]>-1&&s[1]<1&&s[2]>-1&&s[2]<1}rayPlanetIntersection(e,s){const f=c.aW(e,s),g=c.bo(),w=c.bo();c.aQ(w,s,f),c.aT(g,e,w);const E=1-c.aW(g,g);if(E<0)return null;const C=c.aW(e,e)-1,R=-f+(f<0?1:-1)*Math.sqrt(E),L=C/R,j=R;return{tMin:Math.min(L,j),tMax:Math.max(L,j)}}unprojectScreenPoint(e){const s=this._cameraPosition,f=this.getRayDirectionFromPixel(e),g=this.rayPlanetIntersection(s,f);if(g){const j=c.bo();c.aR(j,s,[f[0]*g.tMin,f[1]*g.tMin,f[2]*g.tMin]);const G=c.bo();return c.aU(G,j),tc(G)}const w=this._cachedClippingPlane,E=w[0]*f[0]+w[1]*f[1]+w[2]*f[2],C=-c.b0(w,s)/E,R=c.bo();if(C>0)c.aR(R,s,[f[0]*C,f[1]*C,f[2]*C]);else{const j=c.bo();c.aR(j,s,[2*f[0],2*f[1],2*f[2]]);const G=c.b0(this._cachedClippingPlane,j);c.aT(R,j,[this._cachedClippingPlane[0]*G,this._cachedClippingPlane[1]*G,this._cachedClippingPlane[2]*G])}const L=function(j){const G=c.bo();return G[0]=j[0]*-j[3],G[1]=j[1]*-j[3],G[2]=j[2]*-j[3],{center:G,radius:Math.sqrt(1-j[3]*j[3])}}(w);return tc(function(j,G,V){const Y=c.bo();c.aT(Y,V,j);const K=c.bo();return c.bp(K,j,Y,G/c.a_(Y)),K}(L.center,L.radius,R))}getMatrixForModel(e,s){const f=c.S.convert(e),g=1/c.bt,w=c.b8();return c.by(w,w,f.lng/180*Math.PI),c.b6(w,w,-f.lat/180*Math.PI),c.M(w,w,[0,0,1+s/c.bt]),c.b6(w,w,.5*Math.PI),c.N(w,w,[g,g,g]),w}getProjectionDataForCustomLayer(e=!0){const s=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return s.tileMercatorCoords=[0,0,1,1],s}getFastPathSimpleProjectionMatrix(e){}}class za{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,f){return this._helper.interpolatePadding(e,s,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s,f=!0){this._helper.resize(e,s,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,s){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=s,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new no({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,s)=>this.getConstrained(e,s)}),this._globeness=1,this._mercatorTransform=new Li,this._verticalPerspectiveTransform=new Jc}clone(){const e=new za;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const s=this._mercatorTransform.getProjectionData(e),f=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:s.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:s.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,s,f){const g=this._mercatorTransform.getPitchedTextCorrection(e,s,f),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,s,f);return c.bj(g,w,this._globeness)}projectTileCoordinates(e,s,f,g){return this.currentTransform.projectTileCoordinates(e,s,f,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,s){return this.currentTransform.lngLatToCameraDepth(e,s)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,s){return this.currentTransform.getConstrained(e,s)}calculateCenterFromCameraLngLatAlt(e,s,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,f,g)}setLocationAtPoint(e,s){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,s),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,s),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,s){return this.currentTransform.locationToScreenPoint(e,s)}screenPointToMercatorCoordinate(e,s){return this.currentTransform.screenPointToMercatorCoordinate(e,s)}screenPointToLocation(e,s){return this.currentTransform.screenPointToLocation(e,s)}isPointOnMapSurface(e,s){return this.currentTransform.isPointOnMapSurface(e,s)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,s){return this.currentTransform.getMatrixForModel(e,s)}getProjectionDataForCustomLayer(e=!0){const s=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return s;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return f.fallbackMatrix=s.mainMatrix,f}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class ya{get useGlobeControls(){return!0}handlePanInertia(e,s){const f=eh(e,s);return Math.abs(f.lng-s.center.lng)>180&&(f.lng=s.center.lng+179.5*Math.sign(f.lng-s.center.lng)),{easingCenter:f,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,s){const f=e.around,g=s.screenPointToLocation(f);e.bearingDelta&&s.setBearing(s.bearing+e.bearingDelta),e.pitchDelta&&s.setPitch(s.pitch+e.pitchDelta),e.rollDelta&&s.setRoll(s.roll+e.rollDelta);const w=s.zoom;e.zoomDelta&&s.setZoom(s.zoom+e.zoomDelta);const E=s.zoom-w;if(E===0)return;const C=c.bz(s.center.lng,g.lng),R=C/(Math.abs(C/180)+1),L=c.bz(s.center.lat,g.lat),j=s.getRayDirectionFromPixel(f),G=s.cameraPosition,V=-1*c.aW(G,j),Y=c.bo();c.aR(Y,G,[j[0]*V,j[1]*V,j[2]*V]);const K=c.aY(Y)-1,ue=Math.exp(.5*-Math.max(K-.3,0)),ce=Xc(s.worldSize,s.center.lat)/Math.min(s.width,s.height),de=c.bm(ce,.9,.5,1,.25),pe=(1-c.ae(-E))*Math.min(ue,de),be=s.center.lat,ge=s.zoom,Te=new c.S(s.center.lng+R*pe,c.ag(s.center.lat+L*pe,-85.051129,c.ah));s.setLocationAtPoint(g,f);const Ee=s.center,_e=c.bm(Math.abs(C),45,85,0,1),Ie=c.bm(ce,.75,.35,0,1),qe=Math.pow(Math.max(_e,Ie),.25),Fe=c.bz(Ee.lng,Te.lng),Ue=c.bz(Ee.lat,Te.lat);s.setCenter(new c.S(Ee.lng+Fe*qe,Ee.lat+Ue*qe).wrap()),s.setZoom(ge+mr(be,s.center.lat))}handleMapControlsPan(e,s,f){if(!e.panDelta)return;const g=s.center.lat,w=s.zoom;s.setCenter(eh(e.panDelta,s).wrap()),s.setZoom(w+mr(g,s.center.lat))}cameraForBoxAndBearing(e,s,f,g,w){const E=ui(e,s,f,g,w),C=s.left/w.width*2-1,R=(w.width-s.right)/w.width*2-1,L=s.top/w.height*-2+1,j=(w.height-s.bottom)/w.height*-2+1,G=c.bz(f.getWest(),f.getEast())<0,V=G?f.getEast():f.getWest(),Y=G?f.getWest():f.getEast(),K=Math.max(f.getNorth(),f.getSouth()),ue=Math.min(f.getNorth(),f.getSouth()),ce=V+.5*c.bz(V,Y),de=K+.5*c.bz(K,ue),pe=w.clone();pe.setCenter(E.center),pe.setBearing(E.bearing),pe.setPitch(0),pe.setRoll(0),pe.setZoom(E.zoom);const be=pe.modelViewProjectionMatrix,ge=[Rr(f.getNorthWest()),Rr(f.getNorthEast()),Rr(f.getSouthWest()),Rr(f.getSouthEast()),Rr(new c.S(Y,de)),Rr(new c.S(V,de)),Rr(new c.S(ce,K)),Rr(new c.S(ce,ue))],Te=Rr(E.center);let Ee=Number.POSITIVE_INFINITY;for(const _e of ge)C<0&&(Ee=ya.getLesserNonNegativeNonNull(Ee,ya.solveVectorScale(_e,Te,be,"x",C))),R>0&&(Ee=ya.getLesserNonNegativeNonNull(Ee,ya.solveVectorScale(_e,Te,be,"x",R))),L>0&&(Ee=ya.getLesserNonNegativeNonNull(Ee,ya.solveVectorScale(_e,Te,be,"y",L))),j<0&&(Ee=ya.getLesserNonNegativeNonNull(Ee,ya.solveVectorScale(_e,Te,be,"y",j)));if(Number.isFinite(Ee)&&Ee!==0)return E.zoom=pe.zoom+c.aj(Ee),E;Oi()}handleJumpToCenterZoom(e,s){const f=e.center.lat,g=e.getConstrained(s.center?c.S.convert(s.center):e.center,e.zoom).center;e.setCenter(g.wrap());const w=s.zoom!==void 0?+s.zoom:e.zoom+mr(f,g.lat);e.zoom!==w&&e.setZoom(w)}handleEaseTo(e,s){const f=e.zoom,g=e.center,w=e.padding,E={roll:e.roll,pitch:e.pitch,bearing:e.bearing},C={roll:s.roll===void 0?e.roll:s.roll,pitch:s.pitch===void 0?e.pitch:s.pitch,bearing:s.bearing===void 0?e.bearing:s.bearing},R=s.zoom!==void 0,L=!e.isPaddingEqual(s.padding);let j=!1;const G=s.center?c.S.convert(s.center):g,V=e.getConstrained(G,f).center;_s(e,V);const Y=e.clone();Y.setCenter(V),Y.setZoom(R?+s.zoom:f+mr(g.lat,G.lat)),Y.setBearing(s.bearing);const K=new c.P(c.ag(e.centerPoint.x+s.offsetAsPoint.x,0,e.width),c.ag(e.centerPoint.y+s.offsetAsPoint.y,0,e.height));Y.setLocationAtPoint(V,K);const ue=(s.offset&&s.offsetAsPoint.mag())>0?Y.center:V,ce=R?+s.zoom:f+mr(g.lat,ue.lat),de=f+mr(g.lat,0),pe=ce+mr(ue.lat,0),be=c.bz(g.lng,ue.lng),ge=c.bz(g.lat,ue.lat),Te=c.ae(pe-de);return j=ce!==f,{easeFunc:Ee=>{if(c.bd(E,C)||fr({startEulerAngles:E,endEulerAngles:C,tr:e,k:Ee,useSlerp:E.roll!=C.roll}),L&&e.interpolatePadding(w,s.padding,Ee),s.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(s.around,s.aroundPoint);else{const _e=pe>de?Math.min(2,Te):Math.max(.5,Te),Ie=Math.pow(_e,1-Ee),qe=Kc(g,be,ge,Ee*Ie);e.setCenter(qe.wrap())}if(j){const _e=c.C.number(de,pe,Ee)+mr(0,e.center.lat);e.setZoom(_e)}},isZooming:j,elevationCenter:ue}}handleFlyTo(e,s){const f=s.zoom!==void 0,g=e.center,w=e.zoom,E=e.padding,C=!e.isPaddingEqual(s.padding),R=e.getConstrained(c.S.convert(s.center||s.locationAtOffset),w).center,L=f?+s.zoom:e.zoom+mr(e.center.lat,R.lat),j=e.clone();j.setCenter(R),j.setZoom(L),j.setBearing(s.bearing);const G=new c.P(c.ag(e.centerPoint.x+s.offsetAsPoint.x,0,e.width),c.ag(e.centerPoint.y+s.offsetAsPoint.y,0,e.height));j.setLocationAtPoint(R,G);const V=j.center;_s(e,V);const Y=function(ge,Te,Ee){const _e=Rr(Te),Ie=Rr(Ee),qe=c.aW(_e,Ie),Fe=Math.acos(qe),Ue=Hc(ge);return Fe/(2*Math.PI)*Ue}(e,g,V),K=w+mr(g.lat,0),ue=L+mr(V.lat,0),ce=c.ae(ue-K);let de;if(typeof s.minZoom=="number"){const ge=+s.minZoom+mr(V.lat,0),Te=Math.min(ge,K,ue)+mr(0,V.lat),Ee=e.getConstrained(V,Te).zoom+mr(V.lat,0);de=c.ae(Ee-K)}const pe=c.bz(g.lng,V.lng),be=c.bz(g.lat,V.lat);return{easeFunc:(ge,Te,Ee,_e)=>{const Ie=Kc(g,pe,be,Ee);C&&e.interpolatePadding(E,s.padding,ge);const qe=ge===1?V:Ie;e.setCenter(qe.wrap());const Fe=K+c.aj(Te);e.setZoom(ge===1?L:Fe+mr(0,qe.lat))},scaleOfZoom:ce,targetCenter:V,scaleOfMinZoom:de,pixelPathLength:Y}}static solveVectorScale(e,s,f,g,w){const E=g==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],C=[f[3],f[7],f[11],f[15]],R=e[0]*E[0]+e[1]*E[1]+e[2]*E[2],L=e[0]*C[0]+e[1]*C[1]+e[2]*C[2],j=s[0]*E[0]+s[1]*E[1]+s[2]*E[2],G=s[0]*C[0]+s[1]*C[1]+s[2]*C[2];return j+w*L===R+w*G||C[3]*(R-j)+E[3]*(G-L)+R*G==j*L?null:(j+E[3]-w*G-w*C[3])/(j-R-w*G+w*L)}static getLesserNonNegativeNonNull(e,s){return s!==null&&s>=0&&s<e?s:e}}class ld{constructor(e){this._globe=e,this._mercatorCameraHelper=new vs,this._verticalPerspectiveCameraHelper=new ya}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,s){return this.currentHelper.handlePanInertia(e,s)}handleMapControlsRollPitchBearingZoom(e,s){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,s)}handleMapControlsPan(e,s,f){this.currentHelper.handleMapControlsPan(e,s,f)}cameraForBoxAndBearing(e,s,f,g,w){return this.currentHelper.cameraForBoxAndBearing(e,s,f,g,w)}handleJumpToCenterZoom(e,s){this.currentHelper.handleJumpToCenterZoom(e,s)}handleEaseTo(e,s){return this.currentHelper.handleEaseTo(e,s)}handleFlyTo(e,s){return this.currentHelper.handleFlyTo(e,s)}}const nh=(x,e)=>c.y(x,e&&e.filter(s=>s.identifier!=="source.canvas")),eu=c.bD();class wf extends c.E{constructor(e,s={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const g=this.sourceCaches[f].getSource().type;g!=="vector"&&g!=="geojson"||this.sourceCaches[f].reload()}},this.map=e,this.dispatcher=new Wt(Jt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,g)=>this.getGlyphs(f,g)),this.dispatcher.registerMessageHandler("GI",(f,g)=>this.getImages(f,g)),this.imageManager=new Re,this.imageManager.setEventedParent(this),this.glyphManager=new Ut(e._requestManager,s.localIdeographFontFamily),this.lineAtlas=new qt(256,512),this.crossTileSymbolIndex=new Qu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bF()),ci().on(Da,this._rtlPluginLoaded),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const g=this.sourceCaches[f.sourceId];if(!g)return;const w=g.getSource();if(w&&w.vectorLayerIds)for(const E in this._layers){const C=this._layers[E];C.source===w.id&&this._validateLayer(C)}})}setGlobalStateProperty(e,s){var f,g,w;this._checkLoaded();const E=s===null?(w=(g=(f=this.stylesheet.state)===null||f===void 0?void 0:f[e])===null||g===void 0?void 0:g.default)!==null&&w!==void 0?w:null:s;if(c.bG(E,this._globalState[e]))return this;this._globalState[e]=E;const C=this._findGlobalStateAffectedSources([e]);for(const R in this.sourceCaches)C.has(R)&&(this._reloadSource(R),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const s=[];for(const g in e)!c.bG(this._globalState[g],e[g].default)&&(s.push(g),this._globalState[g]=e[g].default);const f=this._findGlobalStateAffectedSources(s);for(const g in this.sourceCaches)f.has(g)&&(this._reloadSource(g),this._changed=!0)}_findGlobalStateAffectedSources(e){if(e.length===0)return new Set;const s=new Set;for(const f in this._layers){const g=this._layers[f],w=g.getLayoutAffectingGlobalStateRefs();for(const E of e)w.has(E)&&s.add(g.source)}return s}loadURL(e,s={},f){this.fire(new c.l("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const g=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;c.j(g,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,s,f)}).catch(E=>{this._loadStyleRequest=null,E&&!w.signal.aborted&&this.fire(new c.k(E))})}loadJSON(e,s={},f){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,U.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(eu,{validate:!1})}_load(e,s,f){var g,w,E;const C=s.transformStyle?s.transformStyle(f,e):e;if(!s.validate||!nh(this,c.z(C))){this._loaded=!0,this.stylesheet=C;for(const R in C.sources)this.addSource(R,C.sources[R],{validate:!1});C.sprite?this._loadSprite(C.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(C.glyphs),this._createLayers(),this.light=new Ye(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new _t(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.setGlobalState((E=this.stylesheet.state)!==null&&E!==void 0?E:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const e=c.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of e){const f=c.bI(s);f.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=f}}_loadSprite(e,s=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,E,C,R){return c._(this,void 0,void 0,function*(){const L=Ve(w),j=C>1?"@2x":"",G={},V={};for(const{id:Y,url:K}of L){const ue=E.transformRequest(ct(K,j,".json"),"SpriteJSON");G[Y]=c.j(ue,R);const ce=E.transformRequest(ct(K,j,".png"),"SpriteImage");V[Y]=$e.getImage(ce,R)}return yield Promise.all([...Object.values(G),...Object.values(V)]),function(Y,K){return c._(this,void 0,void 0,function*(){const ue={};for(const ce in Y){ue[ce]={};const de=U.getImageCanvasContext((yield K[ce]).data),pe=(yield Y[ce]).data;for(const be in pe){const{width:ge,height:Te,x:Ee,y:_e,sdf:Ie,pixelRatio:qe,stretchX:Fe,stretchY:Ue,content:We,textFitWidth:Ct,textFitHeight:Et}=pe[be];ue[ce][be]={data:null,pixelRatio:qe,sdf:Ie,stretchX:Fe,stretchY:Ue,content:We,textFitWidth:Ct,textFitHeight:Et,spriteData:{width:ge,height:Te,x:Ee,y:_e,context:de}}}}return ue})}(G,V)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const E in w){this._spritesImagesIds[E]=[];const C=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(R=>!(R in w)):[];for(const R of C)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(const R in w[E]){const L=E==="default"?R:`${E}:${R}`;this._spritesImagesIds[E].push(L),L in this.imageManager.images?this.imageManager.updateImage(L,w[E][R],!1):this.imageManager.addImage(L,w[E][R]),s&&(this._changedImages[L]=!0)}}}).catch(w=>{this._spriteRequest=null,g=w,this.fire(new c.k(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),f&&f(g)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const f=e.sourceLayer;if(!f)return;const g=s.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.k(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const f=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?c.bJ(f):f);const g=[];for(const w of e)if(f[w]){const E=s?c.bJ(f[w]):f[w];g.push(E)}return g}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const f of s){const g=this._layers[f];g.type!=="custom"&&(e[f]=g.serialize())}return e}hasTransitions(){var e,s,f;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((s=this.sky)===null||s===void 0)&&s.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const g in this.sourceCaches)if(this.sourceCaches[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const g=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(g.length||w.length)&&this._updateWorkerLayers(g,w);for(const E in this._updatedSources){const C=this._updatedSources[E];if(C==="reload")this._reloadSource(E);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const w=this.sourceCaches[g];f[g]=w.used,w.used=!1}for(const g of this._order){const w=this._layers[g];w.recalculate(e,this._availableImages),!w.isHidden(e.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const g in f){const w=this.sourceCaches[g];!!f[g]!=!!w.used&&w.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,s&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var f;this._checkLoaded();const g=this.serialize();if(e=s.transformStyle?s.transformStyle(g,e):e,((f=s.validate)===null||f===void 0||f)&&nh(this,c.z(e)))return!1;(e=c.bJ(e)).layers=c.bH(e.layers);const w=c.bK(g,e),E=this._getOperationsToPerform(w);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const C of E.operations)C();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],f=[];for(const g of e)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":s.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":s.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setSky":s.push(()=>this.setSky.apply(this,g.args));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":s.push(()=>this.setGlobalState.apply(this,g.args));break;case"setTransition":s.push(()=>{});break;default:f.push(g.command)}return{operations:s,unimplemented:f}}addImage(e,s){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,f={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(c.z.source,`sources.${e}`,s,null,f))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const g=this.sourceCaches[e]=new lt(e,s,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:e})),g.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${f}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const f=this.sourceCaches[e].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,f={}){this._checkLoaded();const g=e.id;if(this.getLayer(g))return void this.fire(new c.k(new Error(`Layer "${g}" already exists on this map.`)));let w;if(e.type==="custom"){if(nh(this,c.bL(e)))return;w=c.bI(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(g,e.source),e=c.bJ(e),e=c.e(e,{source:g})),this._validate(c.z.layer,`layers.${g}`,e,{arrayIndex:-1},f))return;w=c.bI(e),this._validateLayer(w),w.setEventedParent(this,{layer:{id:g}})}const E=s?this._order.indexOf(s):this._order.length;if(s&&E===-1)this.fire(new c.k(new Error(`Cannot add layer "${g}" before non-existing layer "${s}".`)));else{if(this._order.splice(E,0,g),this._layerOrderChanged=!0,this._layers[g]=w,this._removedLayers[g]&&w.source&&w.type!=="custom"){const C=this._removedLayers[g];delete this._removedLayers[g],C.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const f=this._order.indexOf(e);this._order.splice(f,1);const g=s?this._order.indexOf(s):this._order.length;s&&g===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(g,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const f=this._order.indexOf(e);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,f){this._checkLoaded();const g=this.getLayer(e);g?g.minzoom===s&&g.maxzoom===f||(s!=null&&(g.minzoom=s),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,f={}){this._checkLoaded();const g=this.getLayer(e);if(g){if(!c.bG(g.filter,s))return s==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(c.z.filter,`layers.${g.id}.filter`,s,null,f)||(g.setFilter(c.bJ(s)),this._updateLayer(g)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bJ(this.getLayer(e).filter)}setLayoutProperty(e,s,f,g={}){this._checkLoaded();const w=this.getLayer(e);w?c.bG(w.getLayoutProperty(s),f)||(w.setLayoutProperty(s,f,g),this._updateLayer(w)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const f=this.getLayer(e);if(f)return f.getLayoutProperty(s);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,f,g={}){this._checkLoaded();const w=this.getLayer(e);w?c.bG(w.getPaintProperty(s),f)||(w.setPaintProperty(s,f,g)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const f=e.source,g=e.sourceLayer,w=this.sourceCaches[f];if(w===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const E=w.getSource().type;E==="geojson"&&g?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||g?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(g,e.id,s)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const f=e.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const w=g.getSource().type,E=w==="vector"?e.sourceLayer:void 0;w!=="vector"||E?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(E,e.id,s):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,f=e.sourceLayer,g=this.sourceCaches[s];if(g!==void 0)return g.getSource().type!=="vector"||f?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bM(this.sourceCaches,w=>w.serialize()),s=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,g=this.stylesheet;return c.bN({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:e,layers:s,terrain:f},w=>w!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=E=>this._layers[E].type==="fill-extrusion",f={},g=[];for(let E=this._order.length-1;E>=0;E--){const C=this._order[E];if(s(C)){f[C]=E;for(const R of e){const L=R[C];if(L)for(const j of L)g.push(j)}}}g.sort((E,C)=>C.intersectionZ-E.intersectionZ);const w=[];for(let E=this._order.length-1;E>=0;E--){const C=this._order[E];if(s(C))for(let R=g.length-1;R>=0;R--){const L=g[R].feature;if(f[L.layer.id]<E)break;w.push(L),g.pop()}else for(const R of e){const L=R[C];if(L)for(const j of L)w.push(j.feature)}}return w}queryRenderedFeatures(e,s,f){s&&s.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",s.filter,null,s);const g={};if(s&&s.layers){if(!(Array.isArray(s.layers)||s.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const L of s.layers){const j=this._layers[L];if(!j)return this.fire(new c.k(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];g[j.source]=!0}}const w=[];s.availableImages=this._availableImages;const E=this._serializedAllLayers(),C=s.layers instanceof Set?s.layers:Array.isArray(s.layers)?new Set(s.layers):null,R=Object.assign(Object.assign({},s),{layers:C});for(const L in this.sourceCaches)s.layers&&!g[L]||w.push(Gn(this.sourceCaches[L],this._layers,E,e,R,f,this.map.terrain?(j,G,V)=>this.map.terrain.getElevation(j,G,V):void 0));return this.placement&&w.push(function(L,j,G,V,Y,K,ue){const ce={},de=K.queryRenderedSymbols(V),pe=[];for(const be of Object.keys(de).map(Number))pe.push(ue[be]);pe.sort(Ca);for(const be of pe){const ge=be.featureIndex.lookupSymbolFeatures(de[be.bucketInstanceId],j,be.bucketIndex,be.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,L);for(const Te in ge){const Ee=ce[Te]=ce[Te]||[],_e=ge[Te];_e.sort((Ie,qe)=>{const Fe=be.featureSortOrder;if(Fe){const Ue=Fe.indexOf(Ie.featureIndex);return Fe.indexOf(qe.featureIndex)-Ue}return qe.featureIndex-Ie.featureIndex});for(const Ie of _e)Ee.push(Ie)}}return function(be,ge,Te){for(const Ee in be)for(const _e of be[Ee])Hi(_e,Te[ge[Ee].source]);return be}(ce,L,G)}(this._layers,E,this.sourceCaches,e,R,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(e,s){s&&s.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",s.filter,null,s);const f=this.sourceCaches[e];return f?function(g,w){const E=g.getRenderableIds().map(L=>g.getTileByID(L)),C=[],R={};for(let L=0;L<E.length;L++){const j=E[L],G=j.tileID.canonical.key;R[G]||(R[G]=!0,j.querySourceFeatures(C,w))}return C}(f,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const E in e)if(!c.bG(e[E],f[E])){g=!0;break}if(!g)return;const w={now:U.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(w)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){this._checkLoaded();const f=this.getSky();let g=!1;if(!e&&!f)return;if(e&&!f)g=!0;else if(!e&&f)g=!0;else for(const E in e)if(!c.bG(e[E],f[E])){g=!0;break}if(!g)return;const w={now:U.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(w)}_setProjectionInternal(e){const s=function(f){if(Array.isArray(f)){const g=new hl({type:f});return{projection:g,transform:new za,cameraHelper:new ld(g)}}switch(f){case"mercator":return{projection:new Yc,transform:new Li,cameraHelper:new vs};case"globe":{const g=new hl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new za,cameraHelper:new ld(g)}}case"vertical-perspective":return{projection:new od,transform:new Jc,cameraHelper:new ya};default:return c.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Yc,transform:new Li,cameraHelper:new vs}}}(e);this.projection=s.projection,this.map.migrateProjection(s.transform,s.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(e,s,f,g,w={}){return(!w||w.validate!==!1)&&nh(this,e.call(c.z,c.e({key:s,style:this.serialize(),value:f,styleSpec:c.v},g)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ci().off(Da,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const f=this.sourceCaches[s];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,f,g,w=!1){let E=!1,C=!1;const R={};for(const L of this._order){const j=this._layers[L];if(j.type!=="symbol")continue;if(!R[j.source]){const V=this.sourceCaches[j.source];R[j.source]=V.getRenderableIds(!0).map(Y=>V.getTileByID(Y)).sort((Y,K)=>K.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(K.tileID)?-1:1))}const G=this.crossTileSymbolIndex.addLayer(j,R[j.source],e.center.lng);E=E||G}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(U.now(),e.zoom))&&(this.pauseablePlacement=new sd(e,this.map.terrain,this._order,w,s,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(U.now()),C=!0),E&&this.pauseablePlacement.placement.setStale()),C||E)for(const L of this._order){const j=this._layers[L];j.type==="symbol"&&this.placement.updateLayerOpacities(j,R[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(U.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[s.source];return g&&g.setDependencies(s.tileID.key,s.type,s.icons),f})}getGlyphs(e,s){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(s.stacks),g=this.sourceCaches[s.source];return g&&g.setDependencies(s.tileID.key,s.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,f={},g){this._checkLoaded();const w=[{id:e,url:s}],E=[...Ve(this.stylesheet.sprite),...w];this._validate(c.z.sprite,"sprite",E,null,f)||(this.stylesheet.sprite=E,this._loadSprite(w,!0,g))}removeSprite(e){this._checkLoaded();const s=Ve(this.stylesheet.sprite);if(s.find(f=>f.id===e)){if(this._spritesImagesIds[e])for(const f of this._spritesImagesIds[e])this.imageManager.removeImage(f),this._changedImages[f]=!0;s.splice(s.findIndex(f=>f.id===e),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ve(this.stylesheet.sprite)}setSprite(e,s={},f){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,f):(this._unloadSprite(),f&&f(null)))}}var wg=c.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Tg{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,f,g,w,E,C,R,L){this.context=e;let j=this.boundPaintVertexBuffers.length!==g.length;for(let G=0;!j&&G<g.length;G++)this.boundPaintVertexBuffers[G]!==g[G]&&(j=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==f||j||this.boundIndexBuffer!==w||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==L?this.freshBind(s,f,g,w,E,C,R,L):(e.bindVertexArray.set(this.vao),C&&C.bind(),w&&w.dynamicDraw&&w.bind(),R&&R.bind(),L&&L.bind())}freshBind(e,s,f,g,w,E,C,R){const L=e.numAttributes,j=this.context,G=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=R,s.enableAttributes(G,e);for(const V of f)V.enableAttributes(G,e);E&&E.enableAttributes(G,e),C&&C.enableAttributes(G,e),R&&R.enableAttributes(G,e),s.bind(),s.setVertexAttribPointers(G,e,w);for(const V of f)V.bind(),V.setVertexAttribPointers(G,e,w);E&&(E.bind(),E.setVertexAttribPointers(G,e,w)),g&&g.bind(),C&&(C.bind(),C.setVertexAttribPointers(G,e,w)),R&&(R.bind(),R.setVertexAttribPointers(G,e,w)),j.currentNumAttributes=L}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Sg=(x,e,s,f,g)=>({u_texture:0,u_ele_delta:x,u_fog_matrix:e,u_fog_color:s?s.properties.get("fog-color"):c.be.white,u_fog_ground_blend:s?s.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:s?s.calculateFogBlendOpacity(f):0,u_horizon_color:s?s.properties.get("horizon-color"):c.be.white,u_horizon_fog_blend:s?s.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),Eg={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function cd(x){const e=[];for(let s=0;s<x.length;s++){if(x[s]===null)continue;const f=x[s].split(" ");e.push(f.pop())}return e}class ud{constructor(e,s,f,g,w,E,C,R,L=[]){const j=e.gl;this.program=j.createProgram();const G=cd(s.staticAttributes),V=f?f.getBinderAttributes():[],Y=G.concat(V),K=eo.prelude.staticUniforms?cd(eo.prelude.staticUniforms):[],ue=C.staticUniforms?cd(C.staticUniforms):[],ce=s.staticUniforms?cd(s.staticUniforms):[],de=f?f.getBinderUniforms():[],pe=K.concat(ue).concat(ce).concat(de),be=[];for(const Fe of pe)be.indexOf(Fe)<0&&be.push(Fe);const ge=f?f.defines():[];er(j)&&ge.unshift("#version 300 es"),w&&ge.push("#define OVERDRAW_INSPECTOR;"),E&&ge.push("#define TERRAIN3D;"),R&&ge.push(R),L&&ge.push(...L);let Te=ge.concat(eo.prelude.fragmentSource,C.fragmentSource,s.fragmentSource).join(`
`),Ee=ge.concat(eo.prelude.vertexSource,C.vertexSource,s.vertexSource).join(`
`);er(j)||(Te=function(Fe){return Fe.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Te),Ee=function(Fe){return Fe.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ee));const _e=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(_e,Te),j.compileShader(_e),!j.getShaderParameter(_e,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(_e)}`);j.attachShader(this.program,_e);const Ie=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(Ie,Ee),j.compileShader(Ie),!j.getShaderParameter(Ie,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(Ie)}`);j.attachShader(this.program,Ie),this.attributes={};const qe={};this.numAttributes=Y.length;for(let Fe=0;Fe<this.numAttributes;Fe++)Y[Fe]&&(j.bindAttribLocation(this.program,Fe,Y[Fe]),this.attributes[Y[Fe]]=Fe);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(Ie),j.deleteShader(_e);for(let Fe=0;Fe<be.length;Fe++){const Ue=be[Fe];if(Ue&&!qe[Ue]){const We=j.getUniformLocation(this.program,Ue);We&&(qe[Ue]=We)}}this.fixedUniforms=g(e,qe),this.terrainUniforms=((Fe,Ue)=>({u_depth:new c.bO(Fe,Ue.u_depth),u_terrain:new c.bO(Fe,Ue.u_terrain),u_terrain_dim:new c.bf(Fe,Ue.u_terrain_dim),u_terrain_matrix:new c.bQ(Fe,Ue.u_terrain_matrix),u_terrain_unpack:new c.bR(Fe,Ue.u_terrain_unpack),u_terrain_exaggeration:new c.bf(Fe,Ue.u_terrain_exaggeration)}))(e,qe),this.projectionUniforms=((Fe,Ue)=>({u_projection_matrix:new c.bQ(Fe,Ue.u_projection_matrix),u_projection_tile_mercator_coords:new c.bR(Fe,Ue.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bR(Fe,Ue.u_projection_clipping_plane),u_projection_transition:new c.bf(Fe,Ue.u_projection_transition),u_projection_fallback_matrix:new c.bQ(Fe,Ue.u_projection_fallback_matrix)}))(e,qe),this.binderUniforms=f?f.getUniforms(e,qe):[]}draw(e,s,f,g,w,E,C,R,L,j,G,V,Y,K,ue,ce,de,pe,be){const ge=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(f),e.setStencilMode(g),e.setColorMode(w),e.setCullFace(E),R){e.activeTexture.set(ge.TEXTURE2),ge.bindTexture(ge.TEXTURE_2D,R.depthTexture),e.activeTexture.set(ge.TEXTURE3),ge.bindTexture(ge.TEXTURE_2D,R.texture);for(const Ee in this.terrainUniforms)this.terrainUniforms[Ee].set(R[Ee])}if(L)for(const Ee in L)this.projectionUniforms[Eg[Ee]].set(L[Ee]);if(C)for(const Ee in this.fixedUniforms)this.fixedUniforms[Ee].set(C[Ee]);ce&&ce.setUniforms(e,this.binderUniforms,K,{zoom:ue});let Te=0;switch(s){case ge.LINES:Te=2;break;case ge.TRIANGLES:Te=3;break;case ge.LINE_STRIP:Te=1}for(const Ee of Y.get()){const _e=Ee.vaos||(Ee.vaos={});(_e[j]||(_e[j]=new Tg)).bind(e,this,G,ce?ce.getPaintVertexBuffers():[],V,Ee.vertexOffset,de,pe,be),ge.drawElements(s,Ee.primitiveLength*Te,ge.UNSIGNED_SHORT,Ee.primitiveOffset*Te*2)}}}function tu(x,e,s){const f=1/c.aB(s,1,e.transform.tileZoom),g=Math.pow(2,s.tileID.overscaledZ),w=s.tileSize*Math.pow(2,e.transform.tileZoom)/g,E=w*(s.tileID.canonical.x+s.tileID.wrap*g),C=w*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[f,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[E>>16,C>>16],u_pixel_coord_lower:[65535&E,65535&C]}}const Po=(x,e,s,f)=>{const g=x.style.light,w=g.properties.get("position"),E=[w.x,w.y,w.z],C=c.bU();g.properties.get("anchor")==="viewport"&&c.bV(C,x.transform.bearingInRadians),c.bW(E,E,C);const R=x.transform.transformLightDirection(E),L=g.properties.get("color");return{u_lightpos:E,u_lightpos_globe:R,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+e,u_opacity:s,u_fill_translate:f}},Tf=(x,e,s,f,g,w,E)=>c.e(Po(x,e,s,f),tu(w,x,E),{u_height_factor:-Math.pow(2,g.overscaledZ)/E.tileSize/8}),ih=(x,e,s,f)=>c.e(tu(e,x,s),{u_fill_translate:f}),bs=(x,e)=>({u_world:x,u_fill_translate:e}),qp=(x,e,s,f,g)=>c.e(ih(x,e,s,g),{u_world:f}),hd=(x,e,s,f,g)=>{const w=x.transform;let E,C,R=0;if(s.paint.get("circle-pitch-alignment")==="map"){const L=c.aB(e,1,w.zoom);E=!0,C=[L,L],R=L/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*g}else E=!1,C=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:C,u_globe_extrude_scale:R,u_translate:f}},nu=x=>({u_pixel_extrude_scale:[1/x.width,1/x.height]}),ro=x=>({u_viewport_size:[x.width,x.height]}),Hp=(x,e=1)=>({u_color:x,u_overlay:0,u_overlay_scale:e}),rh=(x,e,s,f)=>{const g=c.aB(x,1,e)/(c.$*Math.pow(2,x.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:c.aB(x,1,e),u_intensity:s,u_globe_extrude_scale:g}},Xp=(x,e,s,f)=>{const g=c.L();c.bX(g,0,x.width,x.height,0,0,1);const w=x.context.gl;return{u_matrix:g,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:s,u_color_ramp:f,u_opacity:e.paint.get("heatmap-opacity")}},nc=(x,e,s)=>{const f=s.paint.get("hillshade-accent-color");let g;switch(s.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const w=s.getIlluminationProperties();for(let E=0;E<w.directionRadians.length;E++)s.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[E]+=x.transform.bearingInRadians);return{u_image:0,u_latrange:iu(0,e.tileID),u_exaggeration:s.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:f,u_method:g,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},Wp=(x,e)=>{const s=e.stride,f=c.L();return c.bX(f,0,c.$,-8192,0,0,1),c.M(f,f,[0,-8192,0]),{u_matrix:f,u_image:1,u_dimension:[s,s],u_zoom:x.overscaledZ,u_unpack:e.getUnpackVector()}};function iu(x,e){const s=Math.pow(2,e.canonical.z),f=e.canonical.y;return[new c.a0(0,f/s).toLngLat().lat,new c.a0(0,(f+1)/s).toLngLat().lat]}const ah=(x,e)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:x.paint.get("color-relief-opacity")}),dd=(x,e,s,f)=>{const g=x.transform;return{u_translation:oh(x,e,s),u_ratio:f/c.aB(e,1,g.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},ru=(x,e,s,f,g)=>c.e(dd(x,e,s,f),{u_image:0,u_image_height:g}),Sf=(x,e,s,f,g)=>{const w=x.transform,E=sh(e,w);return{u_translation:oh(x,e,s),u_texsize:e.imageAtlasTexture.size,u_ratio:f/c.aB(e,1,w.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[E,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Ef=(x,e,s,f,g,w)=>{const E=x.lineAtlas,C=sh(e,x.transform),R=s.layout.get("line-cap")==="round",L=E.getDash(g.from,R),j=E.getDash(g.to,R),G=L.width*w.fromScale,V=j.width*w.toScale;return c.e(dd(x,e,s,f),{u_patternscale_a:[C/G,-L.height/2],u_patternscale_b:[C/V,-j.height/2],u_sdfgamma:E.width/(256*Math.min(G,V)*x.pixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:j.y,u_mix:w.t})};function sh(x,e){return 1/c.aB(x,1,e.tileZoom)}function oh(x,e,s){return c.aC(x.transform,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const fl=(x,e,s,f,g)=>{return{u_tl_parent:x,u_scale_parent:e,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(E=f.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=f.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Af(f.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var w,E};function Af(x){x*=Math.PI/180;const e=Math.sin(x),s=Math.cos(x);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const fd=(x,e,s,f,g,w,E,C,R,L,j,G,V)=>{const Y=E.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:Y.width/Y.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:C,u_coord_matrix:R,u_is_text:+j,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:w,u_texsize:G,u_texture:0,u_translation:L,u_pitched_scale:V}},au=(x,e,s,f,g,w,E,C,R,L,j,G,V,Y)=>{const K=E.transform;return c.e(fd(x,e,s,f,g,w,E,C,R,L,j,G,Y),{u_gamma_scale:f?Math.cos(K.pitch*Math.PI/180)*K.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Ag=(x,e,s,f,g,w,E,C,R,L,j,G,V)=>c.e(au(x,e,s,f,g,w,E,C,R,L,!0,j,0,V),{u_texsize_icon:G,u_texture_icon:1}),pd=(x,e)=>({u_opacity:x,u_color:e}),Mg=(x,e,s,f,g)=>c.e(function(w,E,C,R){const L=C.imageManager.getPattern(w.from.toString()),j=C.imageManager.getPattern(w.to.toString()),{width:G,height:V}=C.imageManager.getPixelSize(),Y=Math.pow(2,R.tileID.overscaledZ),K=R.tileSize*Math.pow(2,C.transform.tileZoom)/Y,ue=K*(R.tileID.canonical.x+R.tileID.wrap*Y),ce=K*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[G,V],u_mix:E.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/c.aB(R,1,C.transform.tileZoom),u_pixel_coord_upper:[ue>>16,ce>>16],u_pixel_coord_lower:[65535&ue,65535&ce]}}(s,g,e,f),{u_opacity:x}),Qp=(x,e)=>{},_a={fillExtrusion:(x,e)=>({u_lightpos:new c.bS(x,e.u_lightpos),u_lightpos_globe:new c.bS(x,e.u_lightpos_globe),u_lightintensity:new c.bf(x,e.u_lightintensity),u_lightcolor:new c.bS(x,e.u_lightcolor),u_vertical_gradient:new c.bf(x,e.u_vertical_gradient),u_opacity:new c.bf(x,e.u_opacity),u_fill_translate:new c.bT(x,e.u_fill_translate)}),fillExtrusionPattern:(x,e)=>({u_lightpos:new c.bS(x,e.u_lightpos),u_lightpos_globe:new c.bS(x,e.u_lightpos_globe),u_lightintensity:new c.bf(x,e.u_lightintensity),u_lightcolor:new c.bS(x,e.u_lightcolor),u_vertical_gradient:new c.bf(x,e.u_vertical_gradient),u_height_factor:new c.bf(x,e.u_height_factor),u_opacity:new c.bf(x,e.u_opacity),u_fill_translate:new c.bT(x,e.u_fill_translate),u_image:new c.bO(x,e.u_image),u_texsize:new c.bT(x,e.u_texsize),u_pixel_coord_upper:new c.bT(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(x,e.u_pixel_coord_lower),u_scale:new c.bS(x,e.u_scale),u_fade:new c.bf(x,e.u_fade)}),fill:(x,e)=>({u_fill_translate:new c.bT(x,e.u_fill_translate)}),fillPattern:(x,e)=>({u_image:new c.bO(x,e.u_image),u_texsize:new c.bT(x,e.u_texsize),u_pixel_coord_upper:new c.bT(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(x,e.u_pixel_coord_lower),u_scale:new c.bS(x,e.u_scale),u_fade:new c.bf(x,e.u_fade),u_fill_translate:new c.bT(x,e.u_fill_translate)}),fillOutline:(x,e)=>({u_world:new c.bT(x,e.u_world),u_fill_translate:new c.bT(x,e.u_fill_translate)}),fillOutlinePattern:(x,e)=>({u_world:new c.bT(x,e.u_world),u_image:new c.bO(x,e.u_image),u_texsize:new c.bT(x,e.u_texsize),u_pixel_coord_upper:new c.bT(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(x,e.u_pixel_coord_lower),u_scale:new c.bS(x,e.u_scale),u_fade:new c.bf(x,e.u_fade),u_fill_translate:new c.bT(x,e.u_fill_translate)}),circle:(x,e)=>({u_camera_to_center_distance:new c.bf(x,e.u_camera_to_center_distance),u_scale_with_map:new c.bO(x,e.u_scale_with_map),u_pitch_with_map:new c.bO(x,e.u_pitch_with_map),u_extrude_scale:new c.bT(x,e.u_extrude_scale),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bf(x,e.u_globe_extrude_scale),u_translate:new c.bT(x,e.u_translate)}),collisionBox:(x,e)=>({u_pixel_extrude_scale:new c.bT(x,e.u_pixel_extrude_scale)}),collisionCircle:(x,e)=>({u_viewport_size:new c.bT(x,e.u_viewport_size)}),debug:(x,e)=>({u_color:new c.bP(x,e.u_color),u_overlay:new c.bO(x,e.u_overlay),u_overlay_scale:new c.bf(x,e.u_overlay_scale)}),depth:Qp,clippingMask:Qp,heatmap:(x,e)=>({u_extrude_scale:new c.bf(x,e.u_extrude_scale),u_intensity:new c.bf(x,e.u_intensity),u_globe_extrude_scale:new c.bf(x,e.u_globe_extrude_scale)}),heatmapTexture:(x,e)=>({u_matrix:new c.bQ(x,e.u_matrix),u_world:new c.bT(x,e.u_world),u_image:new c.bO(x,e.u_image),u_color_ramp:new c.bO(x,e.u_color_ramp),u_opacity:new c.bf(x,e.u_opacity)}),hillshade:(x,e)=>({u_image:new c.bO(x,e.u_image),u_latrange:new c.bT(x,e.u_latrange),u_exaggeration:new c.bf(x,e.u_exaggeration),u_altitudes:new c.bZ(x,e.u_altitudes),u_azimuths:new c.bZ(x,e.u_azimuths),u_accent:new c.bP(x,e.u_accent),u_method:new c.bO(x,e.u_method),u_shadows:new c.bY(x,e.u_shadows),u_highlights:new c.bY(x,e.u_highlights)}),hillshadePrepare:(x,e)=>({u_matrix:new c.bQ(x,e.u_matrix),u_image:new c.bO(x,e.u_image),u_dimension:new c.bT(x,e.u_dimension),u_zoom:new c.bf(x,e.u_zoom),u_unpack:new c.bR(x,e.u_unpack)}),colorRelief:(x,e)=>({u_image:new c.bO(x,e.u_image),u_unpack:new c.bR(x,e.u_unpack),u_dimension:new c.bT(x,e.u_dimension),u_elevation_stops:new c.bO(x,e.u_elevation_stops),u_color_stops:new c.bO(x,e.u_color_stops),u_opacity:new c.bf(x,e.u_opacity)}),line:(x,e)=>({u_translation:new c.bT(x,e.u_translation),u_ratio:new c.bf(x,e.u_ratio),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_units_to_pixels:new c.bT(x,e.u_units_to_pixels)}),lineGradient:(x,e)=>({u_translation:new c.bT(x,e.u_translation),u_ratio:new c.bf(x,e.u_ratio),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_units_to_pixels:new c.bT(x,e.u_units_to_pixels),u_image:new c.bO(x,e.u_image),u_image_height:new c.bf(x,e.u_image_height)}),linePattern:(x,e)=>({u_translation:new c.bT(x,e.u_translation),u_texsize:new c.bT(x,e.u_texsize),u_ratio:new c.bf(x,e.u_ratio),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_image:new c.bO(x,e.u_image),u_units_to_pixels:new c.bT(x,e.u_units_to_pixels),u_scale:new c.bS(x,e.u_scale),u_fade:new c.bf(x,e.u_fade)}),lineSDF:(x,e)=>({u_translation:new c.bT(x,e.u_translation),u_ratio:new c.bf(x,e.u_ratio),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_units_to_pixels:new c.bT(x,e.u_units_to_pixels),u_patternscale_a:new c.bT(x,e.u_patternscale_a),u_patternscale_b:new c.bT(x,e.u_patternscale_b),u_sdfgamma:new c.bf(x,e.u_sdfgamma),u_image:new c.bO(x,e.u_image),u_tex_y_a:new c.bf(x,e.u_tex_y_a),u_tex_y_b:new c.bf(x,e.u_tex_y_b),u_mix:new c.bf(x,e.u_mix)}),raster:(x,e)=>({u_tl_parent:new c.bT(x,e.u_tl_parent),u_scale_parent:new c.bf(x,e.u_scale_parent),u_buffer_scale:new c.bf(x,e.u_buffer_scale),u_fade_t:new c.bf(x,e.u_fade_t),u_opacity:new c.bf(x,e.u_opacity),u_image0:new c.bO(x,e.u_image0),u_image1:new c.bO(x,e.u_image1),u_brightness_low:new c.bf(x,e.u_brightness_low),u_brightness_high:new c.bf(x,e.u_brightness_high),u_saturation_factor:new c.bf(x,e.u_saturation_factor),u_contrast_factor:new c.bf(x,e.u_contrast_factor),u_spin_weights:new c.bS(x,e.u_spin_weights),u_coords_top:new c.bR(x,e.u_coords_top),u_coords_bottom:new c.bR(x,e.u_coords_bottom)}),symbolIcon:(x,e)=>({u_is_size_zoom_constant:new c.bO(x,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(x,e.u_is_size_feature_constant),u_size_t:new c.bf(x,e.u_size_t),u_size:new c.bf(x,e.u_size),u_camera_to_center_distance:new c.bf(x,e.u_camera_to_center_distance),u_pitch:new c.bf(x,e.u_pitch),u_rotate_symbol:new c.bO(x,e.u_rotate_symbol),u_aspect_ratio:new c.bf(x,e.u_aspect_ratio),u_fade_change:new c.bf(x,e.u_fade_change),u_label_plane_matrix:new c.bQ(x,e.u_label_plane_matrix),u_coord_matrix:new c.bQ(x,e.u_coord_matrix),u_is_text:new c.bO(x,e.u_is_text),u_pitch_with_map:new c.bO(x,e.u_pitch_with_map),u_is_along_line:new c.bO(x,e.u_is_along_line),u_is_variable_anchor:new c.bO(x,e.u_is_variable_anchor),u_texsize:new c.bT(x,e.u_texsize),u_texture:new c.bO(x,e.u_texture),u_translation:new c.bT(x,e.u_translation),u_pitched_scale:new c.bf(x,e.u_pitched_scale)}),symbolSDF:(x,e)=>({u_is_size_zoom_constant:new c.bO(x,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(x,e.u_is_size_feature_constant),u_size_t:new c.bf(x,e.u_size_t),u_size:new c.bf(x,e.u_size),u_camera_to_center_distance:new c.bf(x,e.u_camera_to_center_distance),u_pitch:new c.bf(x,e.u_pitch),u_rotate_symbol:new c.bO(x,e.u_rotate_symbol),u_aspect_ratio:new c.bf(x,e.u_aspect_ratio),u_fade_change:new c.bf(x,e.u_fade_change),u_label_plane_matrix:new c.bQ(x,e.u_label_plane_matrix),u_coord_matrix:new c.bQ(x,e.u_coord_matrix),u_is_text:new c.bO(x,e.u_is_text),u_pitch_with_map:new c.bO(x,e.u_pitch_with_map),u_is_along_line:new c.bO(x,e.u_is_along_line),u_is_variable_anchor:new c.bO(x,e.u_is_variable_anchor),u_texsize:new c.bT(x,e.u_texsize),u_texture:new c.bO(x,e.u_texture),u_gamma_scale:new c.bf(x,e.u_gamma_scale),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_is_halo:new c.bO(x,e.u_is_halo),u_translation:new c.bT(x,e.u_translation),u_pitched_scale:new c.bf(x,e.u_pitched_scale)}),symbolTextAndIcon:(x,e)=>({u_is_size_zoom_constant:new c.bO(x,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(x,e.u_is_size_feature_constant),u_size_t:new c.bf(x,e.u_size_t),u_size:new c.bf(x,e.u_size),u_camera_to_center_distance:new c.bf(x,e.u_camera_to_center_distance),u_pitch:new c.bf(x,e.u_pitch),u_rotate_symbol:new c.bO(x,e.u_rotate_symbol),u_aspect_ratio:new c.bf(x,e.u_aspect_ratio),u_fade_change:new c.bf(x,e.u_fade_change),u_label_plane_matrix:new c.bQ(x,e.u_label_plane_matrix),u_coord_matrix:new c.bQ(x,e.u_coord_matrix),u_is_text:new c.bO(x,e.u_is_text),u_pitch_with_map:new c.bO(x,e.u_pitch_with_map),u_is_along_line:new c.bO(x,e.u_is_along_line),u_is_variable_anchor:new c.bO(x,e.u_is_variable_anchor),u_texsize:new c.bT(x,e.u_texsize),u_texsize_icon:new c.bT(x,e.u_texsize_icon),u_texture:new c.bO(x,e.u_texture),u_texture_icon:new c.bO(x,e.u_texture_icon),u_gamma_scale:new c.bf(x,e.u_gamma_scale),u_device_pixel_ratio:new c.bf(x,e.u_device_pixel_ratio),u_is_halo:new c.bO(x,e.u_is_halo),u_translation:new c.bT(x,e.u_translation),u_pitched_scale:new c.bf(x,e.u_pitched_scale)}),background:(x,e)=>({u_opacity:new c.bf(x,e.u_opacity),u_color:new c.bP(x,e.u_color)}),backgroundPattern:(x,e)=>({u_opacity:new c.bf(x,e.u_opacity),u_image:new c.bO(x,e.u_image),u_pattern_tl_a:new c.bT(x,e.u_pattern_tl_a),u_pattern_br_a:new c.bT(x,e.u_pattern_br_a),u_pattern_tl_b:new c.bT(x,e.u_pattern_tl_b),u_pattern_br_b:new c.bT(x,e.u_pattern_br_b),u_texsize:new c.bT(x,e.u_texsize),u_mix:new c.bf(x,e.u_mix),u_pattern_size_a:new c.bT(x,e.u_pattern_size_a),u_pattern_size_b:new c.bT(x,e.u_pattern_size_b),u_scale_a:new c.bf(x,e.u_scale_a),u_scale_b:new c.bf(x,e.u_scale_b),u_pixel_coord_upper:new c.bT(x,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(x,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bf(x,e.u_tile_units_to_pixels)}),terrain:(x,e)=>({u_texture:new c.bO(x,e.u_texture),u_ele_delta:new c.bf(x,e.u_ele_delta),u_fog_matrix:new c.bQ(x,e.u_fog_matrix),u_fog_color:new c.bP(x,e.u_fog_color),u_fog_ground_blend:new c.bf(x,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bf(x,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bP(x,e.u_horizon_color),u_horizon_fog_blend:new c.bf(x,e.u_horizon_fog_blend),u_is_globe_mode:new c.bf(x,e.u_is_globe_mode)}),terrainDepth:(x,e)=>({u_ele_delta:new c.bf(x,e.u_ele_delta)}),terrainCoords:(x,e)=>({u_texture:new c.bO(x,e.u_texture),u_terrain_coords_id:new c.bf(x,e.u_terrain_coords_id),u_ele_delta:new c.bf(x,e.u_ele_delta)}),projectionErrorMeasurement:(x,e)=>({u_input:new c.bf(x,e.u_input),u_output_expected:new c.bf(x,e.u_output_expected)}),atmosphere:(x,e)=>({u_sun_pos:new c.bS(x,e.u_sun_pos),u_atmosphere_blend:new c.bf(x,e.u_atmosphere_blend),u_globe_position:new c.bS(x,e.u_globe_position),u_globe_radius:new c.bf(x,e.u_globe_radius),u_inv_proj_matrix:new c.bQ(x,e.u_inv_proj_matrix)}),sky:(x,e)=>({u_sky_color:new c.bP(x,e.u_sky_color),u_horizon_color:new c.bP(x,e.u_horizon_color),u_horizon:new c.bT(x,e.u_horizon),u_horizon_normal:new c.bT(x,e.u_horizon_normal),u_sky_horizon_blend:new c.bf(x,e.u_sky_horizon_blend),u_sky_blend:new c.bf(x,e.u_sky_blend)})};class su{constructor(e,s,f){this.context=e;const g=e.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Mf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class md{constructor(e,s,f,g){this.length=s.length,this.attributes=f,this.itemSize=s.bytesPerElement,this.dynamicDraw=g,this.context=e;const w=e.gl;this.buffer=w.createBuffer(),e.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let f=0;f<this.attributes.length;f++){const g=s.attributes[this.attributes[f].name];g!==void 0&&e.enableVertexAttribArray(g)}}setVertexAttribPointers(e,s,f){for(let g=0;g<this.attributes.length;g++){const w=this.attributes[g],E=s.attributes[w.name];E!==void 0&&e.vertexAttribPointer(E,w.components,e[Mf[w.type]],!1,this.itemSize,w.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Zn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class lh extends Zn{getDefault(){return c.be.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ws extends Zn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Cf extends Zn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class pl extends Zn{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ch extends Zn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class ou extends Zn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class uh extends Zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class ml extends Zn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Lo extends Zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class lu extends Zn{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Df extends Zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class Kp extends Zn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class ic extends Zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class kf extends Zn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Jp extends Zn{getDefault(){return c.be.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class If extends Zn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class gd extends Zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class yd extends Zn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class _d extends Zn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class vd extends Zn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class gl extends Zn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class rc extends Zn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Qr extends Zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Na extends Zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Pa extends Zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class La extends Zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class yl extends Zn{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Oo extends Zn{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const f=this.gl;er(f)?f.bindVertexArray(e):(s=f.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ac extends Zn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class sc extends Zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class oc extends Zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Ts extends Zn{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class Rf extends Ts{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class jo extends Ts{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ss extends Ts{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const zf="Framebuffer is not complete";class oa{constructor(e,s,f,g,w){this.context=e,this.width=s,this.height=f;const E=e.gl,C=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Rf(e,C),g)this.depthAttachment=w?new Ss(e,C):new jo(e,C);else if(w)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(zf)}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const f=this.depthAttachment.get();f&&e.deleteRenderbuffer(f)}e.deleteFramebuffer(this.framebuffer)}}class bn{constructor(e){var s,f;if(this.gl=e,this.clearColor=new lh(this),this.clearDepth=new ws(this),this.clearStencil=new Cf(this),this.colorMask=new pl(this),this.depthMask=new ch(this),this.stencilMask=new ou(this),this.stencilFunc=new uh(this),this.stencilOp=new ml(this),this.stencilTest=new Lo(this),this.depthRange=new lu(this),this.depthTest=new Df(this),this.depthFunc=new Kp(this),this.blend=new ic(this),this.blendFunc=new kf(this),this.blendColor=new Jp(this),this.blendEquation=new If(this),this.cullFace=new gd(this),this.cullFaceSide=new yd(this),this.frontFace=new _d(this),this.program=new vd(this),this.activeTexture=new gl(this),this.viewport=new rc(this),this.bindFramebuffer=new Qr(this),this.bindRenderbuffer=new Na(this),this.bindTexture=new Pa(this),this.bindVertexBuffer=new La(this),this.bindElementBuffer=new yl(this),this.bindVertexArray=new Oo(this),this.pixelStoreUnpack=new ac(this),this.pixelStoreUnpackPremultiplyAlpha=new sc(this),this.pixelStoreUnpackFlipY=new oc(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),er(e)){this.HALF_FLOAT=e.HALF_FLOAT;const g=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(f=e.RGB16F)!==null&&f!==void 0?f:g==null?void 0:g.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const g=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new su(this,e,s)}createVertexBuffer(e,s,f){return new md(this,e,s,f)}createRenderbuffer(e,s,f){const g=this.gl,w=g.createRenderbuffer();return this.bindRenderbuffer.set(w),g.renderbufferStorage(g.RENDERBUFFER,e,s,f),this.bindRenderbuffer.set(null),w}createFramebuffer(e,s,f,g){return new oa(this,e,s,f,g)}clear({color:e,depth:s,stencil:f}){const g=this.gl;let w=0;e&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),f!==void 0&&(w|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(w)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bG(e.blendFunction,Cn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return er(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return er(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let la;function Nf(x,e,s,f,g){const w=x.context,E=x.transform,C=w.gl,R=x.useProgram("collisionBox"),L=[];let j=0,G=0;for(let de=0;de<f.length;de++){const pe=f[de],be=e.getTile(pe).getBucket(s);if(!be)continue;const ge=g?be.textCollisionBox:be.iconCollisionBox,Te=be.collisionCircleArray;Te.length>0&&(L.push({circleArray:Te,circleOffset:G,coord:pe}),j+=Te.length/4,G=j),ge&&R.draw(w,C.LINES,fn.disabled,tn.disabled,x.colorModeForRenderPass(),hn.disabled,nu(x.transform),x.style.map.terrain&&x.style.map.terrain.getTerrainData(pe),E.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),s.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,x.transform.zoom,null,null,ge.collisionVertexBuffer)}if(!g||!L.length)return;const V=x.useProgram("collisionCircle"),Y=new c.b_;Y.resize(4*j),Y._trim();let K=0;for(const de of L)for(let pe=0;pe<de.circleArray.length/4;pe++){const be=4*pe,ge=de.circleArray[be+0],Te=de.circleArray[be+1],Ee=de.circleArray[be+2],_e=de.circleArray[be+3];Y.emplace(K++,ge,Te,Ee,_e,0),Y.emplace(K++,ge,Te,Ee,_e,1),Y.emplace(K++,ge,Te,Ee,_e,2),Y.emplace(K++,ge,Te,Ee,_e,3)}(!la||la.length<2*j)&&(la=function(de){const pe=2*de,be=new c.c0;be.resize(pe),be._trim();for(let ge=0;ge<pe;ge++){const Te=6*ge;be.uint16[Te+0]=4*ge+0,be.uint16[Te+1]=4*ge+1,be.uint16[Te+2]=4*ge+2,be.uint16[Te+3]=4*ge+2,be.uint16[Te+4]=4*ge+3,be.uint16[Te+5]=4*ge+0}return be}(j));const ue=w.createIndexBuffer(la,!0),ce=w.createVertexBuffer(Y,c.b$.members,!0);for(const de of L){const pe=ro(x.transform);V.draw(w,C.TRIANGLES,fn.disabled,tn.disabled,x.colorModeForRenderPass(),hn.disabled,pe,x.style.map.terrain&&x.style.map.terrain.getTerrainData(de.coord),null,s.id,ce,ue,c.aL.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,x.transform.zoom,null,null,null)}ce.destroy(),ue.destroy()}const hh=c.af(new Float32Array(16));function Es(x,e,s,f,g,w){const{horizontalAlign:E,verticalAlign:C}=c.aG(x);return new c.P((-(E-.5)*e/g+f[0])*w,(-(C-.5)*s/g+f[1])*w)}function Pf(x,e,s,f,g,w){const E=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let C=f.mult(w);s||(C=C.rotate(-g));const R=E.add(C);return Dn(R.x,R.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(s){const C=At(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(x),R=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return x.add(f.rotate(R))}return x.add(f)}function Lf(x,e,s,f,g,w,E,C,R,L,j,G){const V=x.text.placedSymbolArray,Y=x.text.dynamicLayoutVertexArray,K=x.icon.dynamicLayoutVertexArray,ue={};Y.clear();for(let ce=0;ce<V.length;ce++){const de=V.get(ce),pe=de.hidden||!de.crossTileID||x.allowVerticalPlacement&&!de.placedOrientation?null:f[de.crossTileID];if(pe){const be=new c.P(de.anchorX,de.anchorY),ge={getElevation:G,width:g.width,height:g.height,pitchedLabelPlaneMatrix:w,pitchWithMap:s,transform:g,tileAnchorPoint:be,translation:L,unwrappedTileID:j},Te=s?Ht(be.x,be.y,ge):At(be.x,be.y,ge),Ee=en(g.cameraToCenterDistance,Te.signedDistanceFromCamera);let _e=c.ao(x.textSizeData,C,de)*Ee/c.aA;s&&(_e*=x.tilePixelRatio/E);const{width:Ie,height:qe,anchor:Fe,textOffset:Ue,textBoxScale:We}=pe,Ct=Es(Fe,Ie,qe,Ue,We,_e),Et=g.getPitchedTextCorrection(be.x+L[0],be.y+L[1],j),ft=Pf(Te.point,ge,e,Ct,-g.bearingInRadians,Et),Bt=x.allowVerticalPlacement&&de.placedOrientation===c.an.vertical?Math.PI/2:0;for(let gn=0;gn<de.numGlyphs;gn++)c.au(Y,ft,Bt);R&&de.associatedIconIndex>=0&&(ue[de.associatedIconIndex]={shiftedAnchor:ft,angle:Bt})}else ko(de.numGlyphs,Y)}if(R){K.clear();const ce=x.icon.placedSymbolArray;for(let de=0;de<ce.length;de++){const pe=ce.get(de);if(pe.hidden)ko(pe.numGlyphs,K);else{const be=ue[de];if(be)for(let ge=0;ge<pe.numGlyphs;ge++)c.au(K,be.shiftedAnchor,be.angle);else ko(pe.numGlyphs,K)}}x.icon.dynamicLayoutVertexBuffer.updateData(K)}x.text.dynamicLayoutVertexBuffer.updateData(Y)}function lc(x,e,s){return s.iconsInText&&e?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function cc(x,e,s,f,g,w,E,C,R,L,j,G,V){const Y=x.context,K=Y.gl,ue=x.transform,ce=C==="map",de=R==="map",pe=C!=="viewport"&&s.layout.get("symbol-placement")!=="point",be=ce&&!de&&!pe,ge=!s.layout.get("symbol-sort-key").isConstant();let Te=!1;const Ee=x.getDepthModeForSublayer(0,fn.ReadOnly),_e=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ie=[],qe=ue.getCircleRadiusCorrection();for(const Fe of f){const Ue=e.getTile(Fe),We=Ue.getBucket(s);if(!We)continue;const Ct=g?We.text:We.icon;if(!Ct||!Ct.segments.get().length||!Ct.hasVisibleVertices)continue;const Et=Ct.programConfigurations.get(s.id),ft=g||We.sdfIcons,Bt=g?We.textSizeData:We.iconSizeData,gn=de||ue.pitch!==0,jn=x.useProgram(lc(ft,g,We),Et),Pi=c.am(Bt,ue.zoom),ti=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Fe);let Bi,ni,ii,oi,wr=[0,0],Rn=null;if(g)ni=Ue.glyphAtlasTexture,ii=K.LINEAR,Bi=Ue.glyphAtlasTexture.size,We.iconsInText&&(wr=Ue.imageAtlasTexture.size,Rn=Ue.imageAtlasTexture,oi=gn||x.options.rotating||x.options.zooming||Bt.kind==="composite"||Bt.kind==="camera"?K.LINEAR:K.NEAREST);else{const gi=s.layout.get("icon-size").constantOr(0)!==1||We.iconsNeedLinear;ni=Ue.imageAtlasTexture,ii=ft||x.options.rotating||x.options.zooming||gi||gn?K.LINEAR:K.NEAREST,Bi=Ue.imageAtlasTexture.size}const Tr=c.aB(Ue,1,x.transform.zoom),Gr=Qt(ce,x.transform,Tr),Cl=c.L();c.ap(Cl,Gr);const Yo=xn(de,ce,x.transform,Tr),as=c.aC(ue,Ue,w,E),ss=ue.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),Dl=_e&&We.hasTextData(),gu=s.layout.get("icon-text-fit")!=="none"&&Dl&&We.hasIconData();if(pe){const gi=x.style.map.terrain?(Nr,Vi)=>x.style.map.terrain.getElevation(Fe,Nr,Vi):null,ri=s.layout.get("text-rotation-alignment")==="map";Ir(We,x,g,Gr,Cl,de,L,ri,Fe.toUnwrapped(),ue.width,ue.height,as,gi)}const wc=g&&_e||gu,Zr=pe||wc?hh:de?Gr:x.transform.clipSpaceToPixelsMatrix,os=ft&&s.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let qo;qo=ft?We.iconsInText?Ag(Bt.kind,Pi,be,de,pe,wc,x,Zr,Yo,as,Bi,wr,qe):au(Bt.kind,Pi,be,de,pe,wc,x,Zr,Yo,as,g,Bi,0,qe):fd(Bt.kind,Pi,be,de,pe,wc,x,Zr,Yo,as,g,Bi,qe);const Tc={program:jn,buffers:Ct,uniformValues:qo,projectionData:ss,atlasTexture:ni,atlasTextureIcon:Rn,atlasInterpolation:ii,atlasInterpolationIcon:oi,isSDF:ft,hasHalo:os};if(ge&&We.canOverlap){Te=!0;const gi=Ct.segments.get();for(const ri of gi)Ie.push({segments:new c.aL([ri]),sortKey:ri.sortKey,state:Tc,terrainData:ti})}else Ie.push({segments:Ct.segments,sortKey:0,state:Tc,terrainData:ti})}Te&&Ie.sort((Fe,Ue)=>Fe.sortKey-Ue.sortKey);for(const Fe of Ie){const Ue=Fe.state;if(Y.activeTexture.set(K.TEXTURE0),Ue.atlasTexture.bind(Ue.atlasInterpolation,K.CLAMP_TO_EDGE),Ue.atlasTextureIcon&&(Y.activeTexture.set(K.TEXTURE1),Ue.atlasTextureIcon&&Ue.atlasTextureIcon.bind(Ue.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),Ue.isSDF){const We=Ue.uniformValues;Ue.hasHalo&&(We.u_is_halo=1,uc(Ue.buffers,Fe.segments,s,x,Ue.program,Ee,j,G,We,Ue.projectionData,Fe.terrainData)),We.u_is_halo=0}uc(Ue.buffers,Fe.segments,s,x,Ue.program,Ee,j,G,Ue.uniformValues,Ue.projectionData,Fe.terrainData)}}function uc(x,e,s,f,g,w,E,C,R,L,j){const G=f.context;g.draw(G,G.gl.TRIANGLES,w,E,C,hn.backCCW,R,j,L,s.id,x.layoutVertexBuffer,x.indexBuffer,e,s.paint,f.transform.zoom,x.programConfigurations.get(s.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function hc(x,e,s,f,g){const w=x.context,E=w.gl,C=tn.disabled,R=new Cn([E.ONE,E.ONE],c.be.transparent,[!0,!0,!0,!0]),L=e.getBucket(s);if(!L)return;const j=f.key;let G=s.heatmapFbos.get(j);G||(G=Kr(w,e.tileSize,e.tileSize),s.heatmapFbos.set(j,G)),w.bindFramebuffer.set(G.framebuffer),w.viewport.set([0,0,e.tileSize,e.tileSize]),w.clear({color:c.be.transparent});const V=L.programConfigurations.get(s.id),Y=x.useProgram("heatmap",V,!g),K=x.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ue=x.style.map.terrain.getTerrainData(f);Y.draw(w,E.TRIANGLES,fn.disabled,C,R,hn.disabled,rh(e,x.transform.zoom,s.paint.get("heatmap-intensity"),1),ue,K,s.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,s.paint,x.transform.zoom,V)}function ca(x,e,s,f,g){const w=x.context,E=w.gl,C=x.transform;w.setColorMode(x.colorModeForRenderPass());const R=ao(w,e),L=s.key,j=e.heatmapFbos.get(L);if(!j)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,j.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1),R.bind(E.LINEAR,E.CLAMP_TO_EDGE);const G=C.getProjectionData({overscaledTileID:s,applyTerrainMatrix:g,applyGlobeMatrix:!f});x.useProgram("heatmapTexture").draw(w,E.TRIANGLES,fn.disabled,tn.disabled,x.colorModeForRenderPass(),hn.disabled,Xp(x,e,0,1),null,G,e.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments,e.paint,C.zoom),j.destroy(),e.heatmapFbos.delete(L)}function Kr(x,e,s){var f,g;const w=x.gl,E=w.createTexture();w.bindTexture(w.TEXTURE_2D,E),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const C=(f=x.HALF_FLOAT)!==null&&f!==void 0?f:w.UNSIGNED_BYTE,R=(g=x.RGBA16F)!==null&&g!==void 0?g:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,R,e,s,0,w.RGBA,C,null);const L=x.createFramebuffer(e,s,!1,!1);return L.colorAttachment.set(E),L}function ao(x,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(x,e.colorRamp,x.gl.RGBA)),e.colorRampTexture}function As(x,e,s,f,g){if(!s||!f||!f.imageAtlas)return;const w=f.imageAtlas.patternPositions;let E=w[s.to.toString()],C=w[s.from.toString()];if(!E&&C&&(E=C),!C&&E&&(C=E),!E||!C){const R=g.getPaintProperty(e);E=w[R],C=w[R]}E&&C&&x.setConstantPatternPositions(E,C)}function Oa(x,e,s,f,g,w,E,C){const R=x.context.gl,L="fill-pattern",j=s.paint.get(L),G=j&&j.constantOr(1),V=s.getCrossfadeParameters();let Y,K,ue,ce,de;const pe=x.transform,be=s.paint.get("fill-translate"),ge=s.paint.get("fill-translate-anchor");E?(K=G&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=R.LINES):(K=G?"fillPattern":"fill",Y=R.TRIANGLES);const Te=j.constantOr(null);for(const Ee of f){const _e=e.getTile(Ee);if(G&&!_e.patternsLoaded())continue;const Ie=_e.getBucket(s);if(!Ie)continue;const qe=Ie.programConfigurations.get(s.id),Fe=x.useProgram(K,qe),Ue=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ee);G&&(x.context.activeTexture.set(R.TEXTURE0),_e.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),qe.updatePaintBuffers(V)),As(qe,L,Te,_e,s);const We=pe.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),Ct=c.aC(pe,_e,be,ge);if(E){ce=Ie.indexBuffer2,de=Ie.segments2;const ft=[R.drawingBufferWidth,R.drawingBufferHeight];ue=K==="fillOutlinePattern"&&G?qp(x,V,_e,ft,Ct):bs(ft,Ct)}else ce=Ie.indexBuffer,de=Ie.segments,ue=G?ih(x,V,_e,Ct):{u_fill_translate:Ct};const Et=x.stencilModeForClipping(Ee);Fe.draw(x.context,Y,g,Et,w,hn.backCCW,ue,Ue,We,s.id,Ie.layoutVertexBuffer,ce,de,s.paint,x.transform.zoom,qe)}}function ts(x,e,s,f,g,w,E,C){const R=x.context,L=R.gl,j="fill-extrusion-pattern",G=s.paint.get(j),V=G.constantOr(1),Y=s.getCrossfadeParameters(),K=s.paint.get("fill-extrusion-opacity"),ue=G.constantOr(null),ce=x.transform;for(const de of f){const pe=e.getTile(de),be=pe.getBucket(s);if(!be)continue;const ge=x.style.map.terrain&&x.style.map.terrain.getTerrainData(de),Te=be.programConfigurations.get(s.id),Ee=x.useProgram(V?"fillExtrusionPattern":"fillExtrusion",Te);V&&(x.context.activeTexture.set(L.TEXTURE0),pe.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Te.updatePaintBuffers(Y));const _e=ce.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!C,applyTerrainMatrix:!0});As(Te,j,ue,pe,s);const Ie=c.aC(ce,pe,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),qe=s.paint.get("fill-extrusion-vertical-gradient"),Fe=V?Tf(x,qe,K,Ie,de,Y,pe):Po(x,qe,K,Ie);Ee.draw(R,R.gl.TRIANGLES,g,w,E,hn.backCCW,Fe,ge,_e,s.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,s.paint,x.transform.zoom,Te,x.style.map.terrain&&be.centroidVertexBuffer)}}function dc(x,e,s,f,g,w,E,C,R){var L;const j=x.style.projection,G=x.context,V=x.transform,Y=G.gl,K=[`#define NUM_ILLUMINATION_SOURCES ${s.paint.get("hillshade-highlight-color").values.length}`],ue=x.useProgram("hillshade",null,!1,K),ce=!x.options.moving;for(const de of f){const pe=e.getTile(de),be=pe.fbo;if(!be)continue;const ge=j.getMeshFromTileID(G,de.canonical,C,!0,"raster"),Te=(L=x.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(de);G.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,be.colorAttachment.get());const Ee=V.getProjectionData({overscaledTileID:de,aligned:ce,applyGlobeMatrix:!R,applyTerrainMatrix:!0});ue.draw(G,Y.TRIANGLES,w,g[de.overscaledZ],E,hn.backCCW,nc(x,pe,s),Te,Ee,s.id,ge.vertexBuffer,ge.indexBuffer,ge.segments)}}function fc(x,e,s,f,g,w,E,C,R){var L;const j=x.style.projection,G=x.context,V=x.transform,Y=G.gl,K=x.useProgram("colorRelief"),ue=!x.options.moving;let ce=!0;for(const de of f){const pe=e.getTile(de),be=pe.dem;if(ce){const qe=Y.getParameter(Y.MAX_TEXTURE_SIZE),{elevationTexture:Fe,colorTexture:Ue}=s.getColorRampTextures(G,qe,be.getUnpackVector());G.activeTexture.set(Y.TEXTURE1),Fe.bind(Y.NEAREST,Y.CLAMP_TO_EDGE),G.activeTexture.set(Y.TEXTURE4),Ue.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),ce=!1}if(!be||!be.data)continue;const ge=be.stride,Te=be.getPixels();if(G.activeTexture.set(Y.TEXTURE0),G.pixelStoreUnpackPremultiplyAlpha.set(!1),pe.demTexture=pe.demTexture||x.getTileTexture(ge),pe.demTexture){const qe=pe.demTexture;qe.update(Te,{premultiply:!1}),qe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}else pe.demTexture=new c.T(G,Te,Y.RGBA,{premultiply:!1}),pe.demTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Ee=j.getMeshFromTileID(G,de.canonical,C,!0,"raster"),_e=(L=x.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(de),Ie=V.getProjectionData({overscaledTileID:de,aligned:ue,applyGlobeMatrix:!R,applyTerrainMatrix:!0});K.draw(G,Y.TRIANGLES,w,g[de.overscaledZ],E,hn.backCCW,ah(s,pe.dem),_e,Ie,s.id,Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)}}const dh=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function Wi(x,e,s,f,g,w,E,C,R=!1,L=!1){const j=f[f.length-1].overscaledZ,G=x.context,V=G.gl,Y=x.useProgram("raster"),K=x.transform,ue=x.style.projection,ce=x.colorModeForRenderPass(),de=!x.options.moving;for(const pe of f){const be=x.getDepthModeForSublayer(pe.overscaledZ-j,s.paint.get("raster-opacity")===1?fn.ReadWrite:fn.ReadOnly,V.LESS),ge=e.getTile(pe);ge.registerFadeDuration(s.paint.get("raster-fade-duration"));const Te=e.findLoadedParent(pe,0),Ee=e.findLoadedSibling(pe),_e=Qi(ge,Te||Ee||null,e,s,x.transform,x.style.map.terrain);let Ie,qe;const Fe=s.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;G.activeTexture.set(V.TEXTURE0),ge.texture.bind(Fe,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),G.activeTexture.set(V.TEXTURE1),Te?(Te.texture.bind(Fe,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),Ie=Math.pow(2,Te.tileID.overscaledZ-ge.tileID.overscaledZ),qe=[ge.tileID.canonical.x*Ie%1,ge.tileID.canonical.y*Ie%1]):ge.texture.bind(Fe,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),ge.texture.useMipmap&&G.extTextureFilterAnisotropic&&x.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax);const Ue=x.style.map.terrain&&x.style.map.terrain.getTerrainData(pe),We=K.getProjectionData({overscaledTileID:pe,aligned:de,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),Ct=fl(qe||[0,0],Ie||1,_e,s,C),Et=ue.getMeshFromTileID(G,pe.canonical,w,E,"raster");Y.draw(G,V.TRIANGLES,be,g?g[pe.overscaledZ]:tn.disabled,ce,R?hn.frontCCW:hn.backCCW,Ct,Ue,We,s.id,Et.vertexBuffer,Et.indexBuffer,Et.segments)}}function Qi(x,e,s,f,g,w){const E=f.paint.get("raster-fade-duration");if(!w&&E>0){const C=U.now(),R=(C-x.timeAdded)/E,L=e?(C-e.timeAdded)/E:-1,j=s.getSource(),G=rt(g,{tileSize:j.tileSize,roundZoom:j.roundZoom}),V=!e||Math.abs(e.tileID.overscaledZ-G)>Math.abs(x.tileID.overscaledZ-G),Y=V&&x.refreshedUponExpiration?1:c.ag(V?R:1-L,0,1);return x.refreshedUponExpiration&&R>=1&&(x.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Wn=new c.be(1,0,0,1),so=new c.be(0,1,0,1),ns=new c.be(0,0,1,1),xd=new c.be(1,0,1,1),_l=new c.be(0,1,1,1);function cu(x,e,s,f){vl(x,0,e+s/2,x.transform.width,s,f)}function fh(x,e,s,f){vl(x,e-s/2,0,s,x.transform.height,f)}function vl(x,e,s,f,g,w){const E=x.context,C=E.gl;C.enable(C.SCISSOR_TEST),C.scissor(e*x.pixelRatio,s*x.pixelRatio,f*x.pixelRatio,g*x.pixelRatio),E.clear({color:w}),C.disable(C.SCISSOR_TEST)}function uu(x,e,s){const f=x.context,g=f.gl,w=x.useProgram("debug"),E=fn.disabled,C=tn.disabled,R=x.colorModeForRenderPass(),L="$debug",j=x.style.map.terrain&&x.style.map.terrain.getTerrainData(s);f.activeTexture.set(g.TEXTURE0);const G=e.getTileByID(s.key).latestRawTileData,V=Math.floor((G&&G.byteLength||0)/1024),Y=e.getTile(s).tileSize,K=512/Math.min(Y,512)*(s.overscaledZ/x.transform.zoom)*.5;let ue=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ue+=` => ${s.overscaledZ}`),function(de,pe){de.initDebugOverlayCanvas();const be=de.debugOverlayCanvas,ge=de.context.gl,Te=de.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,be.width,be.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(pe,5,5),Te.strokeText(pe,5,5),de.debugOverlayTexture.update(be),de.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(x,`${ue} ${V}kB`);const ce=x.transform.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(f,g.TRIANGLES,E,C,Cn.alphaBlended,hn.disabled,Hp(c.be.transparent,K),null,ce,L,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),w.draw(f,g.LINE_STRIP,E,C,R,hn.disabled,Hp(c.be.red),j,ce,L,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function ji(x,e,s,f){const{isRenderingGlobe:g}=f,w=x.context,E=w.gl,C=x.transform,R=x.colorModeForRenderPass(),L=x.getDepthModeFor3D(),j=x.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,x.width,x.height]);for(const G of s){const V=e.getTerrainMesh(G.tileID),Y=x.renderToTexture.getTexture(G),K=e.getTerrainData(G.tileID);w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,Y.texture);const ue=e.getMeshFrameDelta(C.zoom),ce=C.calculateFogMatrix(G.tileID.toUnwrapped()),de=Sg(ue,ce,x.style.sky,C.pitch,g),pe=C.getProjectionData({overscaledTileID:G.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(w,E.TRIANGLES,L,tn.disabled,R,hn.backCCW,de,K,pe,"terrain",V.vertexBuffer,V.indexBuffer,V.segments)}}function is(x,e){if(!e.mesh){const s=new c.aK;s.emplaceBack(-1,-1),s.emplaceBack(1,-1),s.emplaceBack(1,1),s.emplaceBack(-1,1);const f=new c.aM;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),e.mesh=new to(x.createVertexBuffer(s,ys.members),x.createIndexBuffer(f),c.aL.simpleSegment(0,0,s.length,f.length))}return e.mesh}class va{constructor(e,s){this.context=new bn(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qu}resize(e,s,f){if(this.width=Math.floor(e*f),this.height=Math.floor(s*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const e=this.context,s=new c.aK;s.emplaceBack(0,0),s.emplaceBack(c.$,0),s.emplaceBack(0,c.$),s.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(s,ys.members),this.tileExtentSegments=c.aL.simpleSegment(0,0,4,2);const f=new c.aK;f.emplaceBack(0,0),f.emplaceBack(c.$,0),f.emplaceBack(0,c.$),f.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(f,ys.members),this.debugSegments=c.aL.simpleSegment(0,0,4,5);const g=new c.c5;g.emplaceBack(0,0,0,0),g.emplaceBack(c.$,0,c.$,0),g.emplaceBack(0,c.$,0,c.$),g.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(g,wg.members),this.rasterBoundsSegments=c.aL.simpleSegment(0,0,4,2);const w=new c.aK;w.emplaceBack(0,0),w.emplaceBack(c.$,0),w.emplaceBack(0,c.$),w.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(w,ys.members),this.rasterBoundsSegmentsPosOnly=c.aL.simpleSegment(0,0,4,5);const E=new c.aK;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(E,ys.members),this.viewportSegments=c.aL.simpleSegment(0,0,4,2);const C=new c.c6;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(C);const R=new c.aM;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(R);const L=this.context.gl;this.stencilClearMode=new tn({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.tileExtentMesh=new to(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.L();c.bX(f,0,this.width,this.height,0,0,1),c.N(f,f,[s.drawingBufferWidth,s.drawingBufferHeight,0]);const g={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(e,s.TRIANGLES,fn.disabled,this.stencilClearMode,Cn.disabled,hn.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s,f){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source,this.nextStencilID+s.length>256&&this.clearStencil();const g=this.context;g.setColorMode(Cn.disabled),g.setDepthMode(fn.disabled);const w={};for(const E of s)w[E.key]=this.nextStencilID++;this._renderTileMasks(w,s,f,!0),this._renderTileMasks(w,s,f,!1),this._tileClippingMaskIDs=w}_renderTileMasks(e,s,f,g){const w=this.context,E=w.gl,C=this.style.projection,R=this.transform,L=this.useProgram("clippingMask");for(const j of s){const G=e[j.key],V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),Y=C.getMeshFromTileID(this.context,j.canonical,g,!0,"stencil"),K=R.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!f,applyTerrainMatrix:!0});L.draw(w,E.TRIANGLES,fn.disabled,new tn({func:E.ALWAYS,mask:0},G,255,E.KEEP,E.KEEP,E.REPLACE),Cn.disabled,f?hn.disabled:hn.backCCW,null,V,K,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}_renderTilesDepthBuffer(){const e=this.context,s=e.gl,f=this.style.projection,g=this.transform,w=this.useProgram("depth"),E=this.getDepthModeFor3D(),C=Ke(g,{tileSize:g.tileSize});for(const R of C){const L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),j=f.getMeshFromTileID(this.context,R.canonical,!0,!0,"raster"),G=g.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(e,s.TRIANGLES,E,tn.disabled,Cn.disabled,hn.backCCW,null,L,G,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new tn({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new tn({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const s=this.context.gl,f=e.sort((E,C)=>C.overscaledZ-E.overscaledZ),g=f[f.length-1].overscaledZ,w=f[0].overscaledZ-g+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let C=0;C<w;C++)E[C+g]=new tn({func:s.GEQUAL,mask:255},C+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=w,[E,f]}return[{[g]:tn.disabled},f]}stencilConfigForOverlapTwoPass(e){const s=this.context.gl,f=e.sort((E,C)=>C.overscaledZ-E.overscaledZ),g=f[f.length-1].overscaledZ,w=f[0].overscaledZ-g+1;if(this.clearStencil(),w>1){const E={},C={};for(let R=0;R<w;R++)E[R+g]=new tn({func:s.GREATER,mask:255},w+1+R,255,s.KEEP,s.KEEP,s.REPLACE),C[R+g]=new tn({func:s.GREATER,mask:255},1+R,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID=2*w+1,[E,C,f]}return this.nextStencilID=3,[{[g]:new tn({func:s.GREATER,mask:255},2,255,s.KEEP,s.KEEP,s.REPLACE)},{[g]:new tn({func:s.GREATER,mask:255},1,255,s.KEEP,s.KEEP,s.REPLACE)},f]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Cn([e.CONSTANT_COLOR,e.ONE],new c.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Cn.unblended:Cn.alphaBlended}getDepthModeForSublayer(e,s,f){if(!this.opaquePassEnabledForLayer())return fn.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new fn(f||this.context.gl.LEQUAL,s,[g,g])}getDepthModeFor3D(){return new fn(this.context.gl.LEQUAL,fn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){var f,g;this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(U.now()),this.imageManager.beginFrame();const w=this.style._order,E=this.style.sourceCaches,C={},R={},L={},j={isRenderingToTexture:!1,isRenderingGlobe:((f=e.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const V in E){const Y=E[V];Y.used&&Y.prepare(this.context),C[V]=Y.getVisibleCoordinates(!1),R[V]=C[V].slice().reverse(),L[V]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let V=0;V<w.length;V++)if(this.style._layers[w[V]].is3D()){this.opaquePassCutoff=V;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const V of w){const Y=this.style._layers[V];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const K=R[Y.source];(Y.type==="custom"||K.length)&&this.renderLayer(this,E[Y.source],Y,K,j)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:V=>this.useProgram(V)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?c.be.black:c.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(V,Y){const K=V.context,ue=K.gl,ce=((Ee,_e,Ie)=>{const qe=Math.cos(_e.rollInRadians),Fe=Math.sin(_e.rollInRadians),Ue=ie(_e),We=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ee.properties.get("sky-color"),u_horizon_color:Ee.properties.get("horizon-color"),u_horizon:[(_e.width/2-Ue*Fe)*Ie,(_e.height/2+Ue*qe)*Ie],u_horizon_normal:[-Fe,qe],u_sky_horizon_blend:Ee.properties.get("sky-horizon-blend")*_e.height/2*Ie,u_sky_blend:We}})(Y,V.style.map.transform,V.pixelRatio),de=new fn(ue.LEQUAL,fn.ReadWrite,[0,1]),pe=tn.disabled,be=V.colorModeForRenderPass(),ge=V.useProgram("sky"),Te=is(K,Y);ge.draw(K,ue.TRIANGLES,de,pe,be,hn.disabled,ce,null,void 0,"sky",Te.vertexBuffer,Te.indexBuffer,Te.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const V=this.style._layers[w[this.currentLayer]],Y=E[V.source],K=C[V.source];this._renderTileClippingMasks(V,K,!1),this.renderLayer(this,Y,V,K,j)}this.renderPass="translucent";let G=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const V=this.style._layers[w[this.currentLayer]],Y=E[V.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(V,j))continue;this.opaquePassEnabledForLayer()||G||(G=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const K=(V.type==="symbol"?L:R)[V.source];this._renderTileClippingMasks(V,C[V.source],!!this.renderToTexture),this.renderLayer(this,Y,V,K,j)}if(j.isRenderingGlobe&&function(V,Y,K){const ue=V.context,ce=ue.gl,de=V.useProgram("atmosphere"),pe=new fn(ce.LEQUAL,fn.ReadOnly,[0,1]),be=V.transform,ge=function(We,Ct){const Et=We.properties.get("position"),ft=[-Et.x,-Et.y,-Et.z],Bt=c.af(new Float64Array(16));return We.properties.get("anchor")==="map"&&(c.b5(Bt,Bt,Ct.rollInRadians),c.b6(Bt,Bt,-Ct.pitchInRadians),c.b5(Bt,Bt,Ct.bearingInRadians),c.b6(Bt,Bt,Ct.center.lat*Math.PI/180),c.by(Bt,Bt,-Ct.center.lng*Math.PI/180)),c.c4(ft,ft,Bt),ft}(K,V.transform),Te=be.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ee=Y.properties.get("atmosphere-blend")*Te.projectionTransition;if(Ee===0)return;const _e=Xc(be.worldSize,be.center.lat),Ie=be.inverseProjectionMatrix,qe=new Float64Array(4);qe[3]=1,c.av(qe,qe,be.modelViewProjectionMatrix),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1,c.av(qe,qe,Ie),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1;const Fe=((We,Ct,Et,ft,Bt)=>({u_sun_pos:We,u_atmosphere_blend:Ct,u_globe_position:Et,u_globe_radius:ft,u_inv_proj_matrix:Bt}))(ge,Ee,[qe[0],qe[1],qe[2]],_e,Ie),Ue=is(ue,Y);de.draw(ue,ce.TRIANGLES,pe,tn.disabled,Cn.alphaBlended,hn.disabled,Fe,null,null,"atmosphere",Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const V=function(Y,K){let ue=null;const ce=Object.values(Y._layers).flatMap(ge=>ge.source&&!ge.isHidden(K)?[Y.sourceCaches[ge.source]]:[]),de=ce.filter(ge=>ge.getSource().type==="vector"),pe=ce.filter(ge=>ge.getSource().type!=="vector"),be=ge=>{(!ue||ue.getSource().maxzoom<ge.getSource().maxzoom)&&(ue=ge)};return de.forEach(ge=>be(ge)),ue||pe.forEach(ge=>be(ge)),ue}(this.style,this.transform.zoom);V&&function(Y,K,ue){for(let ce=0;ce<ue.length;ce++)uu(Y,K,ue[ce])}(this,V,V.getVisibleCoordinates())}this.options.showPadding&&function(V){const Y=V.transform.padding;cu(V,V.transform.height-(Y.top||0),3,Wn),cu(V,Y.bottom||0,3,so),fh(V,Y.left||0,3,ns),fh(V,V.transform.width-(Y.right||0),3,xd);const K=V.transform.centerPoint;(function(ue,ce,de,pe){vl(ue,ce-1,de-10,2,20,pe),vl(ue,ce-10,de-1,20,2,pe)})(V,K.x,V.transform.height-K.y,_l)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=e?!c.c7(s,f):!c.c8(s,f)),g||(g=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(c.c9(s,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,E){const C=w.context,R=C.gl,L=w.transform,j=Cn.unblended,G=new fn(R.LEQUAL,fn.ReadWrite,[0,1]),V=E.sourceCache.getRenderableTiles(),Y=w.useProgram("terrainDepth");C.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),C.clear({color:c.be.transparent,depth:1});for(const K of V){const ue=E.getTerrainMesh(K.tileID),ce=E.getTerrainData(K.tileID),de=L.getProjectionData({overscaledTileID:K.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),pe={u_ele_delta:E.getMeshFrameDelta(L.zoom)};Y.draw(C,R.TRIANGLES,G,tn.disabled,j,hn.backCCW,pe,ce,de,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,E){const C=w.context,R=C.gl,L=w.transform,j=Cn.unblended,G=new fn(R.LEQUAL,fn.ReadWrite,[0,1]),V=E.getCoordsTexture(),Y=E.sourceCache.getRenderableTiles(),K=w.useProgram("terrainCoords");C.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),C.clear({color:c.be.transparent,depth:1}),E.coordsIndex=[];for(const ue of Y){const ce=E.getTerrainMesh(ue.tileID),de=E.getTerrainData(ue.tileID);C.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,V.texture);const pe={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(L.zoom)},be=L.getProjectionData({overscaledTileID:ue.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});K.draw(C,R.TRIANGLES,G,tn.disabled,j,hn.backCCW,pe,de,be,"terrain",ce.vertexBuffer,ce.indexBuffer,ce.segments),E.coordsIndex.push(ue.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(e,s,f,g,w){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(g||[]).length)&&(this.id=f.id,c.ca(f)?function(E,C,R,L,j,G){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:V}=G,Y=tn.disabled,K=E.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ue,ce,de,pe,be,ge,Te,Ee,_e){const Ie=ce.transform,qe=ce.style.map.terrain,Fe=be==="map",Ue=ge==="map";for(const We of ue){const Ct=pe.getTile(We),Et=Ct.getBucket(de);if(!Et||!Et.text||!Et.text.segments.get().length)continue;const ft=c.am(Et.textSizeData,Ie.zoom),Bt=c.aB(Ct,1,ce.transform.zoom),gn=Qt(Fe,ce.transform,Bt),jn=de.layout.get("icon-text-fit")!=="none"&&Et.hasIconData();if(ft){const Pi=Math.pow(2,Ie.zoom-Ct.tileID.overscaledZ),ti=qe?(Bi,ni)=>qe.getElevation(We,Bi,ni):null;Lf(Et,Fe,Ue,_e,Ie,gn,Pi,ft,jn,c.aC(Ie,Ct,Te,Ee),We.toUnwrapped(),ti)}}}(L,E,R,C,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),j),R.paint.get("icon-opacity").constantOr(1)!==0&&cc(E,C,R,L,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),Y,K,V),R.paint.get("text-opacity").constantOr(1)!==0&&cc(E,C,R,L,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),Y,K,V),C.map.showCollisionBoxes&&(Nf(E,C,R,L,!0),Nf(E,C,R,L,!1))}(e,s,f,g,this.style.placement.variableOffsets,w):c.cb(f)?function(E,C,R,L,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:G}=j,V=R.paint.get("circle-opacity"),Y=R.paint.get("circle-stroke-width"),K=R.paint.get("circle-stroke-opacity"),ue=!R.layout.get("circle-sort-key").isConstant();if(V.constantOr(1)===0&&(Y.constantOr(1)===0||K.constantOr(1)===0))return;const ce=E.context,de=ce.gl,pe=E.transform,be=E.getDepthModeForSublayer(0,fn.ReadOnly),ge=tn.disabled,Te=E.colorModeForRenderPass(),Ee=[],_e=pe.getCircleRadiusCorrection();for(let Ie=0;Ie<L.length;Ie++){const qe=L[Ie],Fe=C.getTile(qe),Ue=Fe.getBucket(R);if(!Ue)continue;const We=R.paint.get("circle-translate"),Ct=R.paint.get("circle-translate-anchor"),Et=c.aC(pe,Fe,We,Ct),ft=Ue.programConfigurations.get(R.id),Bt=E.useProgram("circle",ft),gn=Ue.layoutVertexBuffer,jn=Ue.indexBuffer,Pi=E.style.map.terrain&&E.style.map.terrain.getTerrainData(qe),ti={programConfiguration:ft,program:Bt,layoutVertexBuffer:gn,indexBuffer:jn,uniformValues:hd(E,Fe,R,Et,_e),terrainData:Pi,projectionData:pe.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!G,applyTerrainMatrix:!0})};if(ue){const Bi=Ue.segments.get();for(const ni of Bi)Ee.push({segments:new c.aL([ni]),sortKey:ni.sortKey,state:ti})}else Ee.push({segments:Ue.segments,sortKey:0,state:ti})}ue&&Ee.sort((Ie,qe)=>Ie.sortKey-qe.sortKey);for(const Ie of Ee){const{programConfiguration:qe,program:Fe,layoutVertexBuffer:Ue,indexBuffer:We,uniformValues:Ct,terrainData:Et,projectionData:ft}=Ie.state;Fe.draw(ce,de.TRIANGLES,be,ge,Te,hn.backCCW,Ct,Et,ft,R.id,Ue,We,Ie.segments,R.paint,E.transform.zoom,qe)}}(e,s,f,g,w):c.cc(f)?function(E,C,R,L,j){if(R.paint.get("heatmap-opacity")===0)return;const G=E.context,{isRenderingToTexture:V,isRenderingGlobe:Y}=j;if(E.style.map.terrain){for(const K of L){const ue=C.getTile(K);C.hasRenderableParent(K)||(E.renderPass==="offscreen"?hc(E,ue,R,K,Y):E.renderPass==="translucent"&&ca(E,R,K,V,Y))}G.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(K,ue,ce,de){const pe=K.context,be=pe.gl,ge=K.transform,Te=tn.disabled,Ee=new Cn([be.ONE,be.ONE],c.be.transparent,[!0,!0,!0,!0]);(function(_e,Ie,qe){const Fe=_e.gl;_e.activeTexture.set(Fe.TEXTURE1),_e.viewport.set([0,0,Ie.width/4,Ie.height/4]);let Ue=qe.heatmapFbos.get(c.c1);Ue?(Fe.bindTexture(Fe.TEXTURE_2D,Ue.colorAttachment.get()),_e.bindFramebuffer.set(Ue.framebuffer)):(Ue=Kr(_e,Ie.width/4,Ie.height/4),qe.heatmapFbos.set(c.c1,Ue))})(pe,K,ce),pe.clear({color:c.be.transparent});for(let _e=0;_e<de.length;_e++){const Ie=de[_e];if(ue.hasRenderableParent(Ie))continue;const qe=ue.getTile(Ie),Fe=qe.getBucket(ce);if(!Fe)continue;const Ue=Fe.programConfigurations.get(ce.id),We=K.useProgram("heatmap",Ue),Ct=ge.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Et=ge.getCircleRadiusCorrection();We.draw(pe,be.TRIANGLES,fn.disabled,Te,Ee,hn.backCCW,rh(qe,ge.zoom,ce.paint.get("heatmap-intensity"),Et),null,Ct,ce.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,ce.paint,ge.zoom,Ue)}pe.viewport.set([0,0,K.width,K.height])}(E,C,R,L):E.renderPass==="translucent"&&function(K,ue){const ce=K.context,de=ce.gl;ce.setColorMode(K.colorModeForRenderPass());const pe=ue.heatmapFbos.get(c.c1);pe&&(ce.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,pe.colorAttachment.get()),ce.activeTexture.set(de.TEXTURE1),ao(ce,ue).bind(de.LINEAR,de.CLAMP_TO_EDGE),K.useProgram("heatmapTexture").draw(ce,de.TRIANGLES,fn.disabled,tn.disabled,K.colorModeForRenderPass(),hn.disabled,Xp(K,ue,0,1),null,null,ue.id,K.viewportBuffer,K.quadTriangleIndexBuffer,K.viewportSegments,ue.paint,K.transform.zoom))}(E,R)}(e,s,f,g,w):c.cd(f)?function(E,C,R,L,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:G}=j,V=R.paint.get("line-opacity"),Y=R.paint.get("line-width");if(V.constantOr(1)===0||Y.constantOr(1)===0)return;const K=E.getDepthModeForSublayer(0,fn.ReadOnly),ue=E.colorModeForRenderPass(),ce=R.paint.get("line-dasharray"),de=R.paint.get("line-pattern"),pe=de.constantOr(1),be=R.paint.get("line-gradient"),ge=R.getCrossfadeParameters(),Te=pe?"linePattern":ce?"lineSDF":be?"lineGradient":"line",Ee=E.context,_e=Ee.gl,Ie=E.transform;let qe=!0;for(const Fe of L){const Ue=C.getTile(Fe);if(pe&&!Ue.patternsLoaded())continue;const We=Ue.getBucket(R);if(!We)continue;const Ct=We.programConfigurations.get(R.id),Et=E.context.program.get(),ft=E.useProgram(Te,Ct),Bt=qe||ft.program!==Et,gn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Fe),jn=de.constantOr(null);if(jn&&Ue.imageAtlas){const ii=Ue.imageAtlas,oi=ii.patternPositions[jn.to.toString()],wr=ii.patternPositions[jn.from.toString()];oi&&wr&&Ct.setConstantPatternPositions(oi,wr)}const Pi=Ie.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),ti=Ie.getPixelScale(),Bi=pe?Sf(E,Ue,R,ti,ge):ce?Ef(E,Ue,R,ti,ce,ge):be?ru(E,Ue,R,ti,We.lineClipsArray.length):dd(E,Ue,R,ti);if(pe)Ee.activeTexture.set(_e.TEXTURE0),Ue.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),Ct.updatePaintBuffers(ge);else if(ce&&(Bt||E.lineAtlas.dirty))Ee.activeTexture.set(_e.TEXTURE0),E.lineAtlas.bind(Ee);else if(be){const ii=We.gradients[R.id];let oi=ii.texture;if(R.gradientVersion!==ii.version){let wr=256;if(R.stepInterpolant){const Rn=C.getSource().maxzoom,Tr=Fe.canonical.z===Rn?Math.ceil(1<<E.transform.maxZoom-Fe.canonical.z):1;wr=c.ag(c.c2(We.maxLineLength/c.$*1024*Tr),256,Ee.maxTextureSize)}ii.gradient=c.c3({expression:R.gradientExpression(),evaluationKey:"lineProgress",resolution:wr,image:ii.gradient||void 0,clips:We.lineClipsArray}),ii.texture?ii.texture.update(ii.gradient):ii.texture=new c.T(Ee,ii.gradient,_e.RGBA),ii.version=R.gradientVersion,oi=ii.texture}Ee.activeTexture.set(_e.TEXTURE0),oi.bind(R.stepInterpolant?_e.NEAREST:_e.LINEAR,_e.CLAMP_TO_EDGE)}const ni=E.stencilModeForClipping(Fe);ft.draw(Ee,_e.TRIANGLES,K,ni,ue,hn.disabled,Bi,gn,Pi,R.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,R.paint,E.transform.zoom,Ct,We.layoutVertexBuffer2),qe=!1}}(e,s,f,g,w):c.ce(f)?function(E,C,R,L,j){const G=R.paint.get("fill-color"),V=R.paint.get("fill-opacity");if(V.constantOr(1)===0)return;const{isRenderingToTexture:Y}=j,K=E.colorModeForRenderPass(),ue=R.paint.get("fill-pattern"),ce=E.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&G.constantOr(c.be.transparent).a===1&&V.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===ce){const de=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?fn.ReadWrite:fn.ReadOnly);Oa(E,C,R,L,de,K,!1,Y)}if(E.renderPass==="translucent"&&R.paint.get("fill-antialias")){const de=E.getDepthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,fn.ReadOnly);Oa(E,C,R,L,de,K,!0,Y)}}(e,s,f,g,w):c.cf(f)?function(E,C,R,L,j){const G=R.paint.get("fill-extrusion-opacity");if(G===0)return;const{isRenderingToTexture:V}=j;if(E.renderPass==="translucent"){const Y=new fn(E.context.gl.LEQUAL,fn.ReadWrite,E.depthRangeFor3D);if(G!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))ts(E,C,R,L,Y,tn.disabled,Cn.disabled,V),ts(E,C,R,L,Y,E.stencilModeFor3D(),E.colorModeForRenderPass(),V);else{const K=E.colorModeForRenderPass();ts(E,C,R,L,Y,tn.disabled,K,V)}}}(e,s,f,g,w):c.cg(f)?function(E,C,R,L,j){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:G}=j,V=E.context,Y=E.style.projection.useSubdivision,K=E.getDepthModeForSublayer(0,fn.ReadOnly),ue=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(ce,de,pe,be,ge,Te,Ee){const _e=ce.context,Ie=_e.gl;for(const qe of pe){const Fe=de.getTile(qe),Ue=Fe.dem;if(!Ue||!Ue.data||!Fe.needsHillshadePrepare)continue;const We=Ue.dim,Ct=Ue.stride,Et=Ue.getPixels();if(_e.activeTexture.set(Ie.TEXTURE1),_e.pixelStoreUnpackPremultiplyAlpha.set(!1),Fe.demTexture=Fe.demTexture||ce.getTileTexture(Ct),Fe.demTexture){const Bt=Fe.demTexture;Bt.update(Et,{premultiply:!1}),Bt.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE)}else Fe.demTexture=new c.T(_e,Et,Ie.RGBA,{premultiply:!1}),Fe.demTexture.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE);_e.activeTexture.set(Ie.TEXTURE0);let ft=Fe.fbo;if(!ft){const Bt=new c.T(_e,{width:We,height:We,data:null},Ie.RGBA);Bt.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),ft=Fe.fbo=_e.createFramebuffer(We,We,!0,!1),ft.colorAttachment.set(Bt.texture)}_e.bindFramebuffer.set(ft.framebuffer),_e.viewport.set([0,0,We,We]),ce.useProgram("hillshadePrepare").draw(_e,Ie.TRIANGLES,ge,Te,Ee,hn.disabled,Wp(Fe.tileID,Ue),null,null,be.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),Fe.needsHillshadePrepare=!1}})(E,C,L,R,K,tn.disabled,ue),V.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(Y){const[ce,de,pe]=E.stencilConfigForOverlapTwoPass(L);dc(E,C,R,pe,ce,K,ue,!1,G),dc(E,C,R,pe,de,K,ue,!0,G)}else{const[ce,de]=E.getStencilConfigForOverlapAndUpdateStencilID(L);dc(E,C,R,de,ce,K,ue,!1,G)}}(e,s,f,g,w):c.ch(f)?function(E,C,R,L,j){if(E.renderPass!=="translucent"||!L.length)return;const{isRenderingToTexture:G}=j,V=E.style.projection.useSubdivision,Y=E.getDepthModeForSublayer(0,fn.ReadOnly),K=E.colorModeForRenderPass();if(V){const[ue,ce,de]=E.stencilConfigForOverlapTwoPass(L);fc(E,C,R,de,ue,Y,K,!1,G),fc(E,C,R,de,ce,Y,K,!0,G)}else{const[ue,ce]=E.getStencilConfigForOverlapAndUpdateStencilID(L);fc(E,C,R,ce,ue,Y,K,!1,G)}}(e,s,f,g,w):c.ci(f)?function(E,C,R,L,j){if(E.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!L.length)return;const{isRenderingToTexture:G}=j,V=C.getSource(),Y=E.style.projection.useSubdivision;if(V instanceof Or)Wi(E,C,R,L,null,!1,!1,V.tileCoords,V.flippedWindingOrder,G);else if(Y){const[K,ue,ce]=E.stencilConfigForOverlapTwoPass(L);Wi(E,C,R,ce,K,!1,!0,dh,!1,G),Wi(E,C,R,ce,ue,!0,!0,dh,!1,G)}else{const[K,ue]=E.getStencilConfigForOverlapAndUpdateStencilID(L);Wi(E,C,R,ue,K,!1,!0,dh,!1,G)}}(e,s,f,g,w):c.cj(f)?function(E,C,R,L,j){const G=R.paint.get("background-color"),V=R.paint.get("background-opacity");if(V===0)return;const{isRenderingToTexture:Y}=j,K=E.context,ue=K.gl,ce=E.style.projection,de=E.transform,pe=de.tileSize,be=R.paint.get("background-pattern");if(E.isPatternMissing(be))return;const ge=!be&&G.a===1&&V===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==ge)return;const Te=tn.disabled,Ee=E.getDepthModeForSublayer(0,ge==="opaque"?fn.ReadWrite:fn.ReadOnly),_e=E.colorModeForRenderPass(),Ie=E.useProgram(be?"backgroundPattern":"background"),qe=L||Ke(de,{tileSize:pe,terrain:E.style.map.terrain});be&&(K.activeTexture.set(ue.TEXTURE0),E.imageManager.bind(E.context));const Fe=R.getCrossfadeParameters();for(const Ue of qe){const We=de.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),Ct=be?Mg(V,E,be,{tileID:Ue,tileSize:pe},Fe):pd(V,G),Et=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ue),ft=ce.getMeshFromTileID(K,Ue.canonical,!1,!0,"raster");Ie.draw(K,ue.TRIANGLES,Ee,Te,_e,hn.backCCW,Ct,Et,We,R.id,ft.vertexBuffer,ft.indexBuffer,ft.segments)}}(e,0,f,g,w):c.ck(f)&&function(E,C,R,L){const{isRenderingGlobe:j}=L,G=E.context,V=R.implementation,Y=E.style.projection,K=E.transform,ue=K.getProjectionDataForCustomLayer(j),ce={farZ:K.farZ,nearZ:K.nearZ,fov:K.fov*Math.PI/180,modelViewProjectionMatrix:K.modelViewProjectionMatrix,projectionMatrix:K.projectionMatrix,shaderData:{variantName:Y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Y.shaderPreludeCode.vertexSource}`,define:Y.shaderDefine},defaultProjectionData:ue},de=V.renderingMode?V.renderingMode:"2d";if(E.renderPass==="offscreen"){const pe=V.prerender;pe&&(E.setCustomLayerDefaults(),G.setColorMode(E.colorModeForRenderPass()),pe.call(V,G.gl,ce),G.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),G.setColorMode(E.colorModeForRenderPass()),G.setStencilMode(tn.disabled);const pe=de==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,fn.ReadOnly);G.setDepthMode(pe),V.render(G.gl,ce),G.setDirty(),E.setBaseState(),G.bindFramebuffer.set(null)}}(e,0,f,w))}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),f=this.imageManager.getPattern(e.to.toString());return!s||!f}useProgram(e,s,f=!1,g=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,E=this.style.projection,C=f?eo.projectionMercator:E.shaderPreludeCode,R=f?ec:E.shaderDefine,L=e+(s?s.cacheKey:"")+`/${f?vf:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[L]||(this.cache[L]=new ud(this.context,eo[e],s,_a[e],this._showOverdrawInspector,w,C,R,g)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}function oo(x,e){let s,f=!1,g=null,w=null;const E=()=>{g=null,f&&(x.apply(w,s),g=setTimeout(E,e),f=!1)};return(...C)=>(f=!0,w=this,s=C,g||E(),g)}class ja{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let f;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(!this._isValidHash(s))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:f,pitch:+(s[4]||0)}),!0},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const f=s.join("/");let g=f;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${f}`);let w=window.location.hash.replace(g,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let E=window.location.href.replace(/(#.+)?$/,w);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=oo(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,g),E=Math.round(s.lng*w)/w,C=Math.round(s.lat*w)/w,R=this._map.getBearing(),L=this._map.getPitch();let j="";if(j+=e?`/${E}/${C}/${f}`:`${f}/${C}/${E}`,(R||L)&&(j+="/"+Math.round(10*R)/10),L&&(j+=`/${Math.round(L)}`),this._hashName){const G=this._hashName;let V=!1;const Y=window.location.hash.slice(1).split("&").map(K=>{const ue=K.split("=")[0];return ue===G?(V=!0,`${ue}=${j}`):K}).filter(K=>K);return V||Y.push(`${G}=${j}`),`#${Y.join("&")}`}return`#${j}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const s=+e[0],f=+(e[3]||0),g=+(e[4]||0);return s>=this._map.getMinZoom()&&s<=this._map.getMaxZoom()&&f>=-180&&f<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const Ba={linearity:.3,easing:c.cl(0,0,.3,1)},xa=c.e({deceleration:2500,maxSpeed:1400},Ba),ph=c.e({deceleration:20,maxSpeed:1400},Ba),pc=c.e({deceleration:1e3,maxSpeed:360},Ba),mc=c.e({deceleration:1e3,maxSpeed:90},Ba),mh=c.e({deceleration:1e3,maxSpeed:360},Ba);class xl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:U.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=U.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)s.zoom+=w.zoomDelta||0,s.bearing+=w.bearingDelta||0,s.pitch+=w.pitchDelta||0,s.roll+=w.rollDelta||0,w.panDelta&&s.pan._add(w.panDelta),w.around&&(s.around=w.around),w.pinchAround&&(s.pinchAround=w.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(s.pan.mag()){const w=Bo(s.pan.mag(),f,c.e({},xa,e||{})),E=s.pan.mult(w.amount/s.pan.mag()),C=this._map.cameraHelper.handlePanInertia(E,this._map.transform);g.center=C.easingCenter,g.offset=C.easingOffset,tr(g,w)}if(s.zoom){const w=Bo(s.zoom,f,ph);g.zoom=this._map.transform.zoom+w.amount,tr(g,w)}if(s.bearing){const w=Bo(s.bearing,f,pc);g.bearing=this._map.transform.bearing+c.ag(w.amount,-179,179),tr(g,w)}if(s.pitch){const w=Bo(s.pitch,f,mc);g.pitch=this._map.transform.pitch+w.amount,tr(g,w)}if(s.roll){const w=Bo(s.roll,f,mh);g.roll=this._map.transform.roll+c.ag(w.amount,-179,179),tr(g,w)}if(g.zoom||g.bearing){const w=s.pinchAround===void 0?s.around:s.pinchAround;g.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),c.e(g,{noMoveStart:!0})}}function tr(x,e){(!x.duration||x.duration<e.duration)&&(x.duration=e.duration,x.easing=e.easing)}function Bo(x,e,s){const{maxSpeed:f,linearity:g,deceleration:w}=s,E=c.ag(x*g/(e/1e3),-f,f),C=Math.abs(E)/(w*g);return{easing:s.easing,duration:1e3*C,amount:E*(C/2)}}class ua extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,f,g={}){f=f instanceof MouseEvent?f:new MouseEvent(e,f);const w=Z.mousePos(s.getCanvas(),f),E=s.unproject(w);super(e,c.e({point:w,lngLat:E,originalEvent:f},g)),this._defaultPrevented=!1,this.target=s}}class Ms extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,f){const g=e==="touchend"?f.changedTouches:f.touches,w=Z.touchPos(s.getCanvasContainer(),g),E=w.map(R=>s.unproject(R)),C=w.reduce((R,L,j,G)=>R.add(L.div(G.length)),new c.P(0,0));super(e,{points:w,point:C,lngLats:E,lngLat:s.unproject(C),originalEvent:f}),this._defaultPrevented=!1}}class Of extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,f){super(e,{originalEvent:f}),this._defaultPrevented=!1}}class em{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Of(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new ua(e.type,this._map,e))}mouseup(e){this._map.fire(new ua(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new ua(e.type,this._map,e))}dblclick(e){return this._firePreventable(new ua(e.type,this._map,e))}mouseover(e){this._map.fire(new ua(e.type,this._map,e))}mouseout(e){this._map.fire(new ua(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Ms(e.type,this._map,e))}touchmove(e){this._map.fire(new Ms(e.type,this._map,e))}touchend(e){this._map.fire(new Ms(e.type,this._map,e))}touchcancel(e){this._map.fire(new Ms(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gr{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new ua(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ua("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new ua(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class gc{constructor(e,s){this._map=e,this._tr=new bl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(Z.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const f=s;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=Z.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const w=Math.min(g.x,f.x),E=Math.max(g.x,f.x),C=Math.min(g.y,f.y),R=Math.max(g.y,f.y);Z.setTransform(this._box,`translate(${w}px,${C}px)`),this._box.style.width=E-w+"px",this._box.style.height=R-C+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const f=this._startPos,g=s;if(this.reset(),Z.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:w=>w.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Z.remove(this._box),this._box=null),Z.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new c.l(e,{originalEvent:s}))}}function wl(x,e){if(x.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${e.length}`);const s={};for(let f=0;f<x.length;f++)s[x[f].identifier]=e[f];return s}class bd{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const w=new c.P(0,0);for(const E of g)w._add(E);return w.div(g.length)}(s),this.touches=wl(f,s)))}touchmove(e,s,f){if(this.aborted||!this.centroid)return;const g=wl(f,s);for(const w in this.touches){const E=g[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(e,s,f){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Fo{constructor(e){this.singleTap=new bd(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,f){this.singleTap.touchstart(e,s,f)}touchmove(e,s,f){this.singleTap.touchmove(e,s,f)}touchend(e,s,f){const g=this.singleTap.touchend(e,s,f);if(g){const w=e.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(g)<30;if(w&&E||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Uo{constructor(e){this._tr=new bl(e),this._zoomIn=new Fo({numTouches:1,numTaps:2}),this._zoomOut=new Fo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,f){this._zoomIn.touchstart(e,s,f),this._zoomOut.touchstart(e,s,f)}touchmove(e,s,f){this._zoomIn.touchmove(e,s,f),this._zoomOut.touchmove(e,s,f)}touchend(e,s,f){const g=this._zoomIn.touchend(e,s,f),w=this._zoomOut.touchend(e,s,f),E=this._tr;return g?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(g)},{originalEvent:e})}):w?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(w)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hu{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.rollDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(s)?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const g=Array.isArray(s)?s[0]:s;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&Z.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Fa=0,Cs=2,jf={[Fa]:1,[Cs]:2};class nr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=Z.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(s,f){const g=jf[f];return s.buttons===void 0||(s.buttons&g)!==g}(e,this._eventButton)}isValidEndEvent(e){return Z.mouseButton(e)===this._eventButton}}class Tl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class wd{constructor(e=new nr({checkCorrectEvent:()=>!0}),s=new Tl){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=s}_executeRelevantHandler(e,s,f){return e instanceof MouseEvent?s(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?f(e):void 0}startMove(e){this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.startMove(s),s=>this.oneFingerTouchMoveStateManager.startMove(s))}endMove(e){this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.endMove(s),s=>this.oneFingerTouchMoveStateManager.endMove(s))}isValidStartEvent(e){return this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.isValidStartEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidStartEvent(s))}isValidMoveEvent(e){return this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.isValidMoveEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(s))}isValidEndEvent(e){return this._executeRelevantHandler(e,s=>this.mouseMoveStateManager.isValidEndEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidEndEvent(s))}}const gh=x=>{x.mousedown=x.dragStart,x.mousemoveWindow=x.dragMove,x.mouseup=x.dragEnd,x.contextmenu=e=>{e.preventDefault()}};class yh{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,f){return this._calculateTransform(e,s,f)}touchmove(e,s,f){if(this._active){if(!this._shouldBePrevented(f.length))return e.preventDefault(),this._calculateTransform(e,s,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,f){this._calculateTransform(e,s,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,f){f.length>0&&(this._active=!0);const g=wl(f,s),w=new c.P(0,0),E=new c.P(0,0);let C=0;for(const L in g){const j=g[L],G=this._touches[L];G&&(w._add(j),E._add(j.sub(G)),C++,g[L]=j)}if(this._touches=g,this._shouldBePrevented(C)||!E.mag())return;const R=E.div(C);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(C),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Td{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,f){if(!this._firstTwoTouches)return;e.preventDefault();const[g,w]=this._firstTwoTouches,E=Sl(f,s,g),C=Sl(f,s,w);if(!E||!C)return;const R=this._aroundCenter?null:E.add(C).div(2);return this._move([E,C],R,e)}touchend(e,s,f){if(!this._firstTwoTouches)return;const[g,w]=this._firstTwoTouches,E=Sl(f,s,g),C=Sl(f,s,w);E&&C||(this._active&&Z.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Sl(x,e,s){for(let f=0;f<x.length;f++)if(x[f].identifier===s)return e[f]}function El(x,e){return Math.log(x/e)/Math.LN2}class Ds extends Td{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const f=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(El(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:El(this._distance,f),pinchAround:s}}}function zt(x,e){return 180*x.angleWith(e)/Math.PI}class Sd extends Td{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,f){const g=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zt(this._vector,g),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,f=zt(e,this._startVector);return Math.abs(f)<s}}function Vo(x){return Math.abs(x.y)>Math.abs(x.x)}class Ed extends Td{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,f){super.touchstart(e,s,f),this._currentTouchCount=f.length}_start(e){this._lastPoints=e,Vo(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=e[0].sub(this._lastPoints[0]),w=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,w,f.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(g.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,f){if(this._valid!==void 0)return this._valid;const g=e.mag()>=2,w=s.mag()>=2;if(!g&&!w)return;if(!g||!w)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=e.y>0==s.y>0;return Vo(e)&&Vo(s)&&E}}const du={panStep:100,bearingStep:15,pitchStep:10};class Ua{constructor(e){this._tr=new bl(e);const s=du;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,f=0,g=0,w=0,E=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?f=-1:(e.preventDefault(),w=-1);break;case 39:e.shiftKey?f=1:(e.preventDefault(),w=1);break;case 38:e.shiftKey?g=1:(e.preventDefault(),E=-1);break;case 40:e.shiftKey?g=-1:(e.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:C=>{const R=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:_h,zoom:s?Math.round(R.zoom)+s*(e.shiftKey?2:1):R.zoom,bearing:R.bearing+f*this._bearingStep,pitch:R.pitch+g*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:R.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _h(x){return x*(2-x)}const wn=4.000244140625,lo=1/450;class Go{constructor(e,s){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=e,this._tr=new bl(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=lo}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const f=U.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,s!==0&&s%wn==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(g*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Z.mousePos(this._map.getCanvas(),e),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(c.S.convert(f.center)):s,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const C=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=C),typeof this._targetZoom=="number"&&(this._targetZoom+=C)}if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>wn?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&R!==0&&(R=1/R);const L=typeof this._targetZoom!="number"?e.scale:c.ae(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.aj(L*R)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,f=this._startZoom,g=this._easing;let w,E=!1;if(this._type==="wheel"&&f&&g){const C=U.now()-this._lastWheelEventTime,R=Math.min((C+5)/200,1),L=g(R);w=c.C.number(f,s,L),R<1?this._frameId||(this._frameId=!0):E=!0}else w=s,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!E,zoomDelta:w-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=c.cn;if(this._prevEase){const f=this._prevEase,g=(U.now()-f.start)/f.duration,w=f.easing(g+.01)-f.easing(g),E=.27/Math.sqrt(w*w+1e-4)*.01,C=Math.sqrt(.0729-E*E);s=c.cl(E,C,.25,1)}return this._prevEase={start:U.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Al{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bf{constructor(e){this._tr=new bl(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ff{constructor(){this._tap=new Fo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,f){if(!this._swipePoint)if(this._tapTime){const g=s[0],w=e.timeStamp-this._tapTime<500,E=this._tapPoint.dist(g)<30;w&&E?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(e,s,f)}touchmove(e,s,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=s[0],w=g.y-this._swipePoint.y;return this._swipePoint=g,e.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(e,s,f)}touchend(e,s,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(e,s,f);g&&(this._tapTime=e.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yc{constructor(e,s,f){this._el=e,this._mousePan=s,this._touchPan=f}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ml{constructor(e,s,f,g){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=s,this._mousePitch=f,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ad{constructor(e,s,f,g){this._el=e,this._touchZoom=s,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Uf{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=Z.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=s,this._container.appendChild(g);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=f,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(Z.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const co=x=>x.zoom||x.drag||x.roll||x.pitch||x.rotate;class Md extends c.l{}function Cd(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta||x.rollDelta}class uo{constructor(e,s){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,w)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=g.type==="renderFrame"?void 0:g,C={needsRenderFrame:!1},R={},L={};for(const{handlerName:V,handler:Y,allowed:K}of this._handlers){if(!Y.isEnabled())continue;let ue;if(this._blockedByActive(L,K,V))Y.reset();else if(Y[w||g.type]){if(c.co(g,w||g.type)){const ce=Z.mousePos(this._map.getCanvas(),g);ue=Y[w||g.type](g,ce)}else if(c.cp(g,w||g.type)){const ce=this._getMapTouches(g.touches),de=Z.touchPos(this._map.getCanvas(),ce);ue=Y[w||g.type](g,de,ce)}else c.cq(w||g.type)||(ue=Y[w||g.type](g));this.mergeHandlerResult(C,R,ue,V,E),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()}(ue||Y.isActive())&&(L[V]=Y)}const j={};for(const V in this._previousActiveHandlers)L[V]||(j[V]=E);this._previousActiveHandlers=L,(Object.keys(j).length||Cd(C))&&(this._changes.push([C,R,j]),this._triggerRenderFrame()),(Object.keys(L).length||Cd(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=C;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xl(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,w,E]of this._listeners)Z.addEventListener(g,w,g===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[e,s,f]of this._listeners)Z.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(e){const s=this._map,f=s.getCanvasContainer();this._add("mapEvent",new em(s,e));const g=s.boxZoom=new gc(s,e);this._add("boxZoom",g),e.interactive&&e.boxZoom&&g.enable();const w=s.cooperativeGestures=new Uf(s,e.cooperativeGestures);this._add("cooperativeGestures",w),e.cooperativeGestures&&w.enable();const E=new Uo(s),C=new Bf(s);s.doubleClickZoom=new Al(C,E),this._add("tapZoom",E),this._add("clickZoom",C),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const R=new Ff;this._add("tapDragZoom",R);const L=s.touchPitch=new Ed(s);this._add("touchPitch",L),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const j=()=>s.project(s.getCenter()),G=function({enable:ge,clickTolerance:Te,aroundCenter:Ee=!0,minPixelCenterThreshold:_e=100,rotateDegreesPerPixelMoved:Ie=.8},qe){const Fe=new nr({checkCorrectEvent:Ue=>Z.mouseButton(Ue)===0&&Ue.ctrlKey||Z.mouseButton(Ue)===2&&!Ue.ctrlKey});return new hu({clickTolerance:Te,move:(Ue,We)=>{const Ct=qe();if(Ee&&Math.abs(Ct.y-Ue.y)>_e)return{bearingDelta:c.cm(new c.P(Ue.x,We.y),We,Ct)};let Et=(We.x-Ue.x)*Ie;return Ee&&We.y<Ct.y&&(Et=-Et),{bearingDelta:Et}},moveStateManager:Fe,enable:ge,assignEvents:gh})}(e,j),V=function({enable:ge,clickTolerance:Te,pitchDegreesPerPixelMoved:Ee=-.5}){const _e=new nr({checkCorrectEvent:Ie=>Z.mouseButton(Ie)===0&&Ie.ctrlKey||Z.mouseButton(Ie)===2});return new hu({clickTolerance:Te,move:(Ie,qe)=>({pitchDelta:(qe.y-Ie.y)*Ee}),moveStateManager:_e,enable:ge,assignEvents:gh})}(e),Y=function({enable:ge,clickTolerance:Te,rollDegreesPerPixelMoved:Ee=.3},_e){const Ie=new nr({checkCorrectEvent:qe=>Z.mouseButton(qe)===2&&qe.ctrlKey});return new hu({clickTolerance:Te,move:(qe,Fe)=>{const Ue=_e();let We=(Fe.x-qe.x)*Ee;return Fe.y<Ue.y&&(We=-We),{rollDelta:We}},moveStateManager:Ie,enable:ge,assignEvents:gh})}(e,j);s.dragRotate=new Ml(e,G,V,Y),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",V,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Y,["mousePitch"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const K=function({enable:ge,clickTolerance:Te}){const Ee=new nr({checkCorrectEvent:_e=>Z.mouseButton(_e)===0&&!_e.ctrlKey});return new hu({clickTolerance:Te,move:(_e,Ie)=>({around:Ie,panDelta:Ie.sub(_e)}),activateOnStart:!0,moveStateManager:Ee,enable:ge,assignEvents:gh})}(e),ue=new yh(e,s);s.dragPan=new yc(f,K,ue),this._add("mousePan",K),this._add("touchPan",ue,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const ce=new Sd,de=new Ds;s.touchZoomRotate=new Ad(f,de,ce,R),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const pe=s.scrollZoom=new Go(s,()=>this._triggerRenderFrame());this._add("scrollZoom",pe,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const be=s.keyboard=new Ua(s);this._add("keyboard",be),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new gr(s))}_add(e,s,f){this._handlers.push({handlerName:e,handler:s,allowed:f}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!co(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,f){for(const g in e)if(g!==f&&(!s||s.indexOf(g)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const f of e)this._el.contains(f.target)&&s.push(f);return s}mergeHandlerResult(e,s,f,g,w){if(!f)return;c.e(e,f);const E={handlerName:g,originalEvent:f.originalEvent||w};f.zoomDelta!==void 0&&(s.zoom=E),f.panDelta!==void 0&&(s.drag=E),f.rollDelta!==void 0&&(s.roll=E),f.pitchDelta!==void 0&&(s.pitch=E),f.bearingDelta!==void 0&&(s.rotate=E)}_applyChanges(){const e={},s={},f={};for(const[g,w,E]of this._changes)g.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(g.panDelta)),g.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(e.rollDelta=(e.rollDelta||0)+g.rollDelta),g.around!==void 0&&(e.around=g.around),g.pinchAround!==void 0&&(e.pinchAround=g.pinchAround),g.noInertia&&(e.noInertia=g.noInertia),c.e(s,w),c.e(f,E);this._updateMapTransform(e,s,f),this._changes=[]}_updateMapTransform(e,s,f){const g=this._map,w=g._getTransformForUpdate(),E=g.terrain;if(!(Cd(e)||E&&this._terrainMovement))return this._fireEvents(s,f,!0);g._stop(!0);let{panDelta:C,zoomDelta:R,bearingDelta:L,pitchDelta:j,rollDelta:G,around:V,pinchAround:Y}=e;Y!==void 0&&(V=Y),V=V||g.transform.centerPoint,E&&!w.isPointOnMapSurface(V)&&(V=w.centerPoint);const K={panDelta:C,zoomDelta:R,rollDelta:G,pitchDelta:j,bearingDelta:L,around:V};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(V)&&(V=w.centerPoint);const ue=V.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(C?V.sub(C):V);E?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(K,w),this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(C))):this._map.cameraHelper.handleMapControlsPan(K,w,ue):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(K,w,ue))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(K,w),this._map.cameraHelper.handleMapControlsPan(K,w,ue)),g._applyUpdatedTransform(w),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,f,!0)}_fireEvents(e,s,f){const g=co(this._eventsInProgress),w=co(e),E={};for(const G in e){const{originalEvent:V}=e[G];this._eventsInProgress[G]||(E[`${G}start`]=V),this._eventsInProgress[G]=e[G]}!g&&w&&this._fireEvent("movestart",w.originalEvent);for(const G in E)this._fireEvent(G,E[G]);w&&this._fireEvent("move",w.originalEvent);for(const G in e){const{originalEvent:V}=e[G];this._fireEvent(G,V)}const C={};let R;for(const G in this._eventsInProgress){const{handlerName:V,originalEvent:Y}=this._eventsInProgress[G];this._handlersById[V].isActive()||(delete this._eventsInProgress[G],R=s[V]||Y,C[`${G}end`]=R)}for(const G in C)this._fireEvent(G,C[G]);const L=co(this._eventsInProgress),j=(g||w)&&!L;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const G=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&G.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(G)}if(f&&j){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!G||!G.essential&&U.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:R})),V(this._map.getBearing())&&this._map.resetNorth()):(V(G.bearing||this._map.getBearing())&&(G.bearing=0),G.freezeElevation=!0,this._map.easeTo(G,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new c.l(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Md("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class pi extends c.E{constructor(e,s,f){super(),this._renderFrameCallback=()=>{const g=Math.min((U.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=f.bearingSnap,this.cameraHelper=s,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,s){e.apply(this.transform),this.transform=e,this.cameraHelper=s}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,s){return this.jumpTo({elevation:e},s),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,s,f){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},s),f)}panTo(e,s,f){return this.easeTo(c.e({center:e},s),f)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,f){return this.easeTo(c.e({zoom:e},s),f)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,s){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",s)).fire(new c.l("move",s)).fire(new c.l("moveend",s))),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,f){return this.easeTo(c.e({bearing:e},s),f)}resetNorth(e,s){return this.rotateTo(0,c.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}getRoll(){return this.transform.roll}setRoll(e,s){return this.jumpTo({roll:e},s),this}cameraForBounds(e,s){e=Xn.convert(e).adjustAntiMeridian();const f=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),f,s)}_cameraForBoxAndBearing(e,s,f,g){const w={top:0,bottom:0,right:0,left:0};if(typeof(g=c.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const L=g.padding;g.padding={top:L,bottom:L,right:L,left:L}}const E=c.e(w,g.padding);g.padding=E;const C=this.transform,R=new Xn(e,s);return this.cameraHelper.cameraForBoxAndBearing(g,E,R,f,C)}fitBounds(e,s,f){return this._fitInternal(this.cameraForBounds(e,s),s,f)}fitScreenCoordinates(e,s,f,g,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(s)),f,g),g,w)}_fitInternal(e,s,f){return e?(delete(s=c.e(e,s)).padding,s.linear?this.easeTo(s,f):this.flyTo(s,f)):this}jumpTo(e,s){this.stop();const f=this._getTransformForUpdate();let g=!1,w=!1,E=!1;const C=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,e);const R=f.zoom!==C;return"elevation"in e&&f.elevation!==+e.elevation&&f.setElevation(+e.elevation),"bearing"in e&&f.bearing!==+e.bearing&&(g=!0,f.setBearing(+e.bearing)),"pitch"in e&&f.pitch!==+e.pitch&&(w=!0,f.setPitch(+e.pitch)),"roll"in e&&f.roll!==+e.roll&&(E=!0,f.setRoll(+e.roll)),e.padding==null||f.isPaddingEqual(e.padding)||f.setPadding(e.padding),this._applyUpdatedTransform(f),this.fire(new c.l("movestart",s)).fire(new c.l("move",s)),R&&this.fire(new c.l("zoomstart",s)).fire(new c.l("zoom",s)).fire(new c.l("zoomend",s)),g&&this.fire(new c.l("rotatestart",s)).fire(new c.l("rotate",s)).fire(new c.l("rotateend",s)),w&&this.fire(new c.l("pitchstart",s)).fire(new c.l("pitch",s)).fire(new c.l("pitchend",s)),E&&this.fire(new c.l("rollstart",s)).fire(new c.l("roll",s)).fire(new c.l("rollend",s)),this.fire(new c.l("moveend",s))}calculateCameraOptionsFromTo(e,s,f,g=0){const w=c.a0.fromLngLat(e,s),E=c.a0.fromLngLat(f,g),C=E.x-w.x,R=E.y-w.y,L=E.z-w.z,j=Math.hypot(C,R,L);if(j===0)throw new Error("Can't calculate camera options with same From and To");const G=Math.hypot(C,R),V=c.aj(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Y=180*Math.atan2(C,-R)/Math.PI;let K=180*Math.acos(G/j)/Math.PI;return K=L<0?90-K:90+K,{center:E.toLngLat(),elevation:g,zoom:V,pitch:K,bearing:Y}}calculateCameraOptionsFromCameraLngLatAltRotation(e,s,f,g,w){const E=this.transform.calculateCenterFromCameraLngLatAlt(e,s,f,g);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:f,pitch:g,roll:w}}easeTo(e,s){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.cn},e)).animate===!1||!e.essential&&U.prefersReducedMotion)&&(e.duration=0);const f=this._getTransformForUpdate(),g=this.getBearing(),w=f.pitch,E=f.roll,C="bearing"in e?this._normalizeBearing(e.bearing,g):g,R="pitch"in e?+e.pitch:w,L="roll"in e?this._normalizeBearing(e.roll,E):E,j="padding"in e?e.padding:f.padding,G=c.P.convert(e.offset);let V,Y;e.around&&(V=c.S.convert(e.around),Y=f.locationToScreenPoint(V));const K={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ue=this.cameraHelper.handleEaseTo(f,{bearing:C,pitch:R,roll:L,padding:j,around:V,aroundPoint:Y,offsetAsPoint:G,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||g!==C,this._pitching=this._pitching||R!==w,this._rolling=this._rolling||L!==E,this._padding=!f.isPaddingEqual(j),this._zooming=this._zooming||ue.isZooming,this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,K),this.terrain&&this._prepareElevation(ue.elevationCenter),this._ease(ce=>{ue.easeFunc(ce),this.terrain&&!e.freezeElevation&&this._updateElevation(ce),this._applyUpdatedTransform(f),this._fireMoveEvents(s)},ce=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,ce)},e),this}_prepareEase(e,s,f={}){this._moving=!0,s||f.moving||this.fire(new c.l("movestart",e)),this._zooming&&!f.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!f.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!f.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!f.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(f-(s-(f*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const s=e.getCameraLngLat(),f=e.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(s,e.zoom):0;if(f<g){const w=this.calculateCameraOptionsFromTo(s,g,e.center,e.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(s.push(g=>this._elevateCameraIfInsideTerrain(g)),this.transformCameraUpdate&&s.push(g=>this.transformCameraUpdate(g)),!s.length)return;const f=e.clone();for(const g of s){const w=f.clone(),{center:E,zoom:C,roll:R,pitch:L,bearing:j,elevation:G}=g(w);E&&w.setCenter(E),G!==void 0&&w.setElevation(G),C!==void 0&&w.setZoom(C),R!==void 0&&w.setRoll(R),L!==void 0&&w.setPitch(L),j!==void 0&&w.setBearing(j),f.apply(w)}this.transform.apply(f)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const f=this._zooming,g=this._rotating,w=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new c.l("zoomend",e)),g&&this.fire(new c.l("rotateend",e)),w&&this.fire(new c.l("pitchend",e)),E&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,s){if(!e.essential&&U.prefersReducedMotion){const We=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(We,s)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cn},e);const f=this._getTransformForUpdate(),g=f.bearing,w=f.pitch,E=f.roll,C=f.padding,R="bearing"in e?this._normalizeBearing(e.bearing,g):g,L="pitch"in e?+e.pitch:w,j="roll"in e?this._normalizeBearing(e.roll,E):E,G="padding"in e?e.padding:f.padding,V=c.P.convert(e.offset);let Y=f.centerPoint.add(V);const K=f.screenPointToLocation(Y),ue=this.cameraHelper.handleFlyTo(f,{bearing:R,pitch:L,roll:j,padding:G,locationAtOffset:K,offsetAsPoint:V,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ce=e.curve;const de=Math.max(f.width,f.height),pe=de/ue.scaleOfZoom,be=ue.pixelPathLength;typeof ue.scaleOfMinZoom=="number"&&(ce=Math.sqrt(de/ue.scaleOfMinZoom/be*2));const ge=ce*ce;function Te(We){const Ct=(pe*pe-de*de+(We?-1:1)*ge*ge*be*be)/(2*(We?pe:de)*ge*be);return Math.log(Math.sqrt(Ct*Ct+1)-Ct)}function Ee(We){return(Math.exp(We)-Math.exp(-We))/2}function _e(We){return(Math.exp(We)+Math.exp(-We))/2}const Ie=Te(!1);let qe=function(We){return _e(Ie)/_e(Ie+ce*We)},Fe=function(We){return de*((_e(Ie)*(Ee(Ct=Ie+ce*We)/_e(Ct))-Ee(Ie))/ge)/be;var Ct},Ue=(Te(!0)-Ie)/ce;if(Math.abs(be)<2e-6||!isFinite(Ue)){if(Math.abs(de-pe)<1e-6)return this.easeTo(e,s);const We=pe<de?-1:1;Ue=Math.abs(Math.log(pe/de))/ce,Fe=()=>0,qe=Ct=>Math.exp(We*ce*Ct)}return e.duration="duration"in e?+e.duration:1e3*Ue/("screenSpeed"in e?+e.screenSpeed/ce:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=g!==R,this._pitching=L!==w,this._rolling=j!==E,this._padding=!f.isPaddingEqual(G),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(ue.targetCenter),this._ease(We=>{const Ct=We*Ue,Et=1/qe(Ct),ft=Fe(Ct);this._rotating&&f.setBearing(c.C.number(g,R,We)),this._pitching&&f.setPitch(c.C.number(w,L,We)),this._rolling&&f.setRoll(c.C.number(E,j,We)),this._padding&&(f.interpolatePadding(C,G,We),Y=f.centerPoint.add(V)),ue.easeFunc(We,Et,ft,Y),this.terrain&&!e.freezeElevation&&this._updateElevation(We),this._applyUpdatedTransform(f),this._fireMoveEvents(s)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,s)}return e||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(e,s,f){f.animate===!1||f.duration===0?(e(1),s()):(this._easeStart=U.now(),this._easeOptions=f,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=c.aN(e,-180,180);const f=Math.abs(e-s);return Math.abs(e-360-s)<f&&(e-=360),Math.abs(e+360-s)<f&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const rs={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Tn{constructor(e=rs){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=Z.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Z.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Z.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Z.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const f=this._map._getUIString(`AttributionControl.${s}`);e.title=f,e.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const s=this._map.style.sourceCaches;for(const g in s){const w=s[g];if(w.used||w.usedForTerrain){const E=w.getSource();E.attribution&&e.indexOf(E.attribution)<0&&e.push(E.attribution)}}e=e.filter(g=>String(g).trim()),e.sort((g,w)=>g.length-w.length),e=e.filter((g,w)=>{for(let E=w+1;E<e.length;E++)if(e[E].indexOf(g)>=0)return!1;return!0});const f=e.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,e.length?(this._innerContainer.innerHTML=Z.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ei{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const f=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=Z.create("div","maplibregl-ctrl");const s=Z.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Z.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ir{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,f=s?this._queue.concat(s):this._queue;for(const g of f)if(g.id===e)return void(g.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const f of s)if(!f.cancelled&&(f.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var vh=c.aI([{name:"a_pos3d",type:"Int16",components:3}]);class fu extends c.E{constructor(e){super(),this._lastTilesetChange=U.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const f={};for(const g of Ke(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),c.bX(g.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[g.key]=new dr(g,this.tileSize),this._lastTilesetChange=U.now());for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(e){for(const s in this._tiles){const f=this._tiles[s];(!e||f.tileID.equals(e)||f.tileID.isChildOf(e)||e.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,s){return s?this._getTerrainCoordsForTileRanges(e,s):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const s={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID,w=e.clone(),E=c.b9();if(g.canonical.equals(e.canonical))c.bX(E,0,c.$,c.$,0,0,1);else if(g.canonical.isChildOf(e.canonical)){const C=g.canonical.z-e.canonical.z,R=g.canonical.x-(g.canonical.x>>C<<C),L=g.canonical.y-(g.canonical.y>>C<<C),j=c.$>>C;c.bX(E,0,j,j,0,0,1),c.M(E,E,[-R*j,-L*j,0])}else{if(!e.canonical.isChildOf(g.canonical))continue;{const C=e.canonical.z-g.canonical.z,R=e.canonical.x-(e.canonical.x>>C<<C),L=e.canonical.y-(e.canonical.y>>C<<C),j=c.$>>C;c.bX(E,0,c.$,c.$,0,0,1),c.M(E,E,[R*j,L*j,0]),c.N(E,E,[1/2**C,1/2**C,0])}}w.terrainRttPosMatrix32f=new Float32Array(E),s[f]=w}return s}_getTerrainCoordsForTileRanges(e,s){const f={};for(const g of this._renderableTilesKeys){const w=this._tiles[g].tileID;if(!this._isWithinTileRanges(w,s))continue;const E=e.clone(),C=c.b9();if(w.canonical.z===e.canonical.z){const R=e.canonical.x-w.canonical.x,L=e.canonical.y-w.canonical.y;c.bX(C,0,c.$,c.$,0,0,1),c.M(C,C,[R*c.$,L*c.$,0])}else if(w.canonical.z>e.canonical.z){const R=w.canonical.z-e.canonical.z,L=w.canonical.x-(w.canonical.x>>R<<R),j=w.canonical.y-(w.canonical.y>>R<<R),G=e.canonical.x-(w.canonical.x>>R),V=e.canonical.y-(w.canonical.y>>R),Y=c.$>>R;c.bX(C,0,Y,Y,0,0,1),c.M(C,C,[-L*Y+G*c.$,-j*Y+V*c.$,0])}else{const R=e.canonical.z-w.canonical.z,L=e.canonical.x-(e.canonical.x>>R<<R),j=e.canonical.y-(e.canonical.y>>R<<R),G=(e.canonical.x>>R)-w.canonical.x,V=(e.canonical.y>>R)-w.canonical.y,Y=c.$<<R;c.bX(C,0,Y,Y,0,0,1),c.M(C,C,[L*c.$+G*Y,j*c.$+V*Y,0])}E.terrainRttPosMatrix32f=new Float32Array(C),f[g]=E}return f}getSourceTile(e,s){const f=this.sourceCache._source;let g=e.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(g).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!w||!w.dem)&&s)for(;g>=f.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(e.scaledTo(g--).key);return w}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,s){return s[e.canonical.z]&&e.canonical.x>=s[e.canonical.z].minTileX&&e.canonical.x<=s[e.canonical.z].maxTileX&&e.canonical.y>=s[e.canonical.z].minTileY&&e.canonical.y<=s[e.canonical.z].maxTileY}}class Jr{constructor(e,s,f){this._meshCache={},this.painter=e,this.sourceCache=new fu(s),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,f,g=c.$){var w;if(!(s>=0&&s<g&&f>=0&&f<g))return 0;const E=this.getTerrainData(e),C=(w=E.tile)===null||w===void 0?void 0:w.dem;if(!C)return 0;const R=c.cr([],[s/g*c.$,f/g*c.$],E.u_terrain_matrix),L=[R[0]*C.dim,R[1]*C.dim],j=Math.floor(L[0]),G=Math.floor(L[1]),V=L[0]-j,Y=L[1]-G;return C.get(j,G)*(1-V)*(1-Y)+C.get(j+1,G)*V*(1-Y)+C.get(j,G+1)*(1-V)*Y+C.get(j+1,G+1)*V*Y}getElevationForLngLatZoom(e,s){if(!c.cs(s,e.wrap()))return 0;const{tileID:f,mercatorX:g,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(f,g%c.$,w%c.$,c.$)}getElevation(e,s,f,g=c.$){return this.getDEMElevation(e,s,f,g)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const g=this.painter.context,w=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(g,w,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(g,new c.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.af([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const g=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new c.T(g,s.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),s.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const f=s&&s+s.tileID.key+e.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let w=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=g?w=e.canonical.z-g:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=e.canonical.x-(e.canonical.x>>w<<w),C=e.canonical.y-(e.canonical.y>>w<<w),R=c.ct(new Float64Array(16),[1/(c.$<<w),1/(c.$<<w),0]);c.M(R,R,[E*c.$,C*c.$,0]),this._demMatrixCache[e.key]={matrix:R,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,f=s.width/devicePixelRatio,g=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(s.context,{width:f,height:g,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(s.context,{width:f,height:g,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,E=0;w<this._coordsTextureSize;w++)for(let C=0;C<this._coordsTextureSize;C++,E+=4)s[E+0]=255&C,s[E+1]=255&w,s[E+2]=C>>8<<4|w>>8,s[E+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),g=new c.T(e,f,e.gl.RGBA,{premultiply:!1});return g.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),f=this.painter.context,g=f.gl,w=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(w,C-E-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),f.bindFramebuffer.set(null);const R=s[0]+(s[2]>>4<<8),L=s[1]+((15&s[2])<<8),j=this.coordsIndex[255-s[3]],G=j&&this.sourceCache.getTileByID(j);if(!G)return null;const V=this._coordsTextureSize,Y=(1<<G.tileID.canonical.z)*V;return new c.a0((G.tileID.canonical.x*V+R)/Y+G.tileID.wrap,(G.tileID.canonical.y*V+L)/Y,this.getElevation(G.tileID,R,L,V))}depthAtPoint(e){const s=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),f.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(e){var s;const f=((s=this.painter.style.projection)===null||s===void 0?void 0:s.transitionState)>0,g=f&&e.canonical.y===0,w=f&&e.canonical.y===(1<<e.canonical.z)-1,E=`m_${g?"n":""}_${w?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const C=this.painter.context,R=new c.cu,L=new c.aM,j=this.meshSize,G=c.$/j,V=j*j;for(let _e=0;_e<=j;_e++)for(let Ie=0;Ie<=j;Ie++)R.emplaceBack(Ie*G,_e*G,0);for(let _e=0;_e<V;_e+=j+1)for(let Ie=0;Ie<j;Ie++)L.emplaceBack(Ie+_e,j+Ie+_e+1,j+Ie+_e+2),L.emplaceBack(Ie+_e,j+Ie+_e+2,Ie+_e+1);const Y=R.length,K=Y+(j+1),ue=(j+1)*j,ce=g?c.bg:0,de=g?0:1,pe=w?c.bh:c.$,be=w?0:1;for(let _e=0;_e<=j;_e++)R.emplaceBack(_e*G,ce,de);for(let _e=0;_e<=j;_e++)R.emplaceBack(_e*G,pe,be);for(let _e=0;_e<j;_e++)L.emplaceBack(ue+_e,K+_e,K+_e+1),L.emplaceBack(ue+_e,K+_e+1,ue+_e+1),L.emplaceBack(0+_e,Y+_e+1,Y+_e),L.emplaceBack(0+_e,0+_e+1,Y+_e+1);const ge=R.length,Te=ge+2*(j+1);for(const _e of[0,1])for(let Ie=0;Ie<=j;Ie++)for(const qe of[0,1])R.emplaceBack(_e*c.$,Ie*G,qe);for(let _e=0;_e<2*j;_e+=2)L.emplaceBack(ge+_e,ge+_e+1,ge+_e+3),L.emplaceBack(ge+_e,ge+_e+3,ge+_e+2),L.emplaceBack(Te+_e,Te+_e+3,Te+_e+1),L.emplaceBack(Te+_e,Te+_e+2,Te+_e+3);const Ee=new to(C.createVertexBuffer(R,vh.members),C.createIndexBuffer(L),c.aL.simpleSegment(0,0,R.length,L.length));return this._meshCache[E]=Ee,Ee}getMeshFrameDelta(e){return 2*Math.PI*c.bt/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,s){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,f={minElevation:null,maxElevation:null};return s&&s.dem&&(f.minElevation=s.dem.min*this.exaggeration,f.maxElevation=s.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(e,s){const f=c.a0.fromLngLat(e.wrap()),g=(1<<s)*c.$,w=f.x*g,E=f.y*g,C=Math.floor(w/c.$),R=Math.floor(E/c.$);return{tileID:new c.Z(s,0,s,C,R),mercatorX:w,mercatorY:E}}}class _c{constructor(e,s,f){this._context=e,this._size=s,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(f.texture),{id:e,fbo:s,texture:f,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>e.id!==s),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Ot={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Zt{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new _c(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(f=>!e._layers[f].isHidden(s)),this._coordsAscending={};for(const f in e.sourceCaches){this._coordsAscending[f]={};const g=e.sourceCaches[f].getVisibleCoordinates(),w=e.sourceCaches[f].getSource(),E=w instanceof Or?w.terrainTileRanges:null;for(const C of g){const R=this.terrain.sourceCache.getTerrainCoords(C,E);for(const L in R)this._coordsAscending[f][L]||(this._coordsAscending[f][L]=[]),this._coordsAscending[f][L].push(R[L])}}this._coordsAscendingStr={};for(const f of e._order){const g=e._layers[f],w=g.source;if(Ot[g.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const E in this._coordsAscending[w])this._coordsAscendingStr[w][E]=this._coordsAscending[w][E].map(C=>C.key).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsAscendingStr){const w=this._coordsAscendingStr[g][f.tileID.key];w&&w!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(e,s){if(e.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},s),{isRenderingToTexture:!0}),g=e.type,w=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Ot[g]&&(this._prevType&&Ot[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(e.id),!E))return!0;if(Ot[this._prevType]||Ot[g]&&E){this._prevType=g;const C=this._stacks.length-1,R=this._stacks[C]||[];for(const L of this._renderableTiles){if(this.pool.isFull()&&(ji(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(L),L.rtt[C]){const G=this.pool.getObjectForId(L.rtt[C].id);if(G.stamp===L.rtt[C].stamp){this.pool.useObject(G);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),L.rtt[C]={id:j.id,stamp:j.stamp},w.context.bindFramebuffer.set(j.fbo.framebuffer),w.context.clear({color:c.be.transparent,stencil:0}),w.currentStencilSource=void 0;for(let G=0;G<R.length;G++){const V=w.style._layers[R[G]],Y=V.source?this._coordsAscending[V.source][L.tileID.key]:[L.tileID];w.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),w._renderTileClippingMasks(V,Y,!0),w.renderLayer(w,w.style.sourceCaches[V.source],V,Y,f),V.source&&(L.rttCoords[V.source]=this._coordsAscendingStr[V.source][L.tileID.key])}}return ji(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),Ot[g]}return!1}}const Dd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ui=D,vc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:rs,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Vr={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Vf{constructor(e,s,f=!1){this.mousedown=w=>{this.startMove(w,Z.mousePos(this.element,w)),Z.addEventListener(window,"mousemove",this.mousemove),Z.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,Z.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Z.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),Z.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Z.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=Z.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=s;const g=new wd;this._rotatePitchHanlder=new hu({clickTolerance:3,move:(w,E)=>{const C=s.getBoundingClientRect(),R=new c.P((C.bottom-C.top)/2,(C.right-C.left)/2);return{bearingDelta:c.cm(new c.P(w.x,E.y),E,R),pitchDelta:f?-.5*(E.y-w.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=e,Z.addEventListener(s,"mousedown",this.mousedown),Z.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),Z.addEventListener(s,"touchcancel",this.reset)}startMove(e,s){this._rotatePitchHanlder.dragStart(e,s),Z.disableDrag()}move(e,s){const f=this.map,{bearingDelta:g,pitchDelta:w}=this._rotatePitchHanlder.dragMove(e,s)||{};g&&f.setBearing(f.getBearing()+g),w&&f.setPitch(f.getPitch()+w)}off(){const e=this.element;Z.removeEventListener(e,"mousedown",this.mousedown),Z.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),Z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Z.removeEventListener(window,"touchend",this.touchend),Z.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){Z.enableDrag(),Z.removeEventListener(window,"mousemove",this.mousemove),Z.removeEventListener(window,"mouseup",this.mouseup),Z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Z.removeEventListener(window,"touchend",this.touchend)}}let zr;function tm(x,e,s,f=!1){if(f||!s.getCoveringTilesDetailsProvider().allowWorldCopies())return x==null?void 0:x.wrap();const g=new c.S(x.lng,x.lat);if(x=new c.S(x.lng,x.lat),e){const w=new c.S(x.lng-360,x.lat),E=new c.S(x.lng+360,x.lat),C=s.locationToScreenPoint(x).distSqr(e);s.locationToScreenPoint(w).distSqr(e)<C?x=w:s.locationToScreenPoint(E).distSqr(e)<C&&(x=E)}for(;Math.abs(x.lng-s.center.lng)>180;){const w=s.locationToScreenPoint(x);if(w.x>=0&&w.y>=0&&w.x<=s.width&&w.y<=s.height)break;x.lng>s.center.lng?x.lng-=360:x.lng+=360}return x.lng!==g.lng&&s.isPointOnMapSurface(s.locationToScreenPoint(x))?x:g}const Zo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ei(x,e,s){const f=x.classList;for(const g in Zo)f.remove(`maplibregl-${s}-anchor-${g}`);f.add(`maplibregl-${s}-anchor-${e}`)}class Ni extends c.E{constructor(e){if(super(),this._onKeyPress=s=>{const f=s.code,g=s.charCode||s.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=s=>{const f=s.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=s=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=tm(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),Z.setTransform(this._element,`${Zo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${g}`),U.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=Z.create("div");const s=Z.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${f}px`),s.setAttributeNS(null,"width",`${g}px`),s.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const w=Z.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const E=Z.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const C=Z.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of R){const pe=Z.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",de.rx),pe.setAttributeNS(null,"ry",de.ry),C.appendChild(pe)}const L=Z.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const j=Z.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(j);const G=Z.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"fill","#000000");const V=Z.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),G.appendChild(V);const Y=Z.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const K=Z.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=Z.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const ce=Z.createNS("http://www.w3.org/2000/svg","circle");ce.setAttributeNS(null,"fill","#FFFFFF"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962"),K.appendChild(ue),K.appendChild(ce),E.appendChild(C),E.appendChild(L),E.appendChild(G),E.appendChild(Y),E.appendChild(K),s.appendChild(E),s.setAttributeNS(null,"height",f*this._scale+"px"),s.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(s),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),Ei(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Z.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const g=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,f;const g=(s=this._map)===null||s===void 0?void 0:s.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!g||w){const Y=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,C=E.terrain.depthAtPoint(this._pos),R=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,R)-C<.006)return void(this._element.style.opacity=this._opacity);const L=-this._offset.y/E.transform.pixelsPerMeter,j=Math.sin(E.getPitch()*Math.PI/180)*L,G=E.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),V=E.transform.lngLatToCameraDepth(this._lngLat,R+j)-G>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&V&&this._popup.remove(),this._element.style.opacity=V?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return(this._opacity===void 0||e===void 0&&s===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const ha={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let mi=0,ho=!1;const xc={maxWidth:100,unit:"metric"};function bc(x,e,s){const f=s&&s.maxWidth||100,g=x._container.clientHeight/2,w=x._container.clientWidth/2,E=x.unproject([w-f/2,g]),C=x.unproject([w+f/2,g]),R=Math.round(x.project(C).x-x.project(E).x),L=Math.min(f,R,x._container.clientWidth),j=E.distanceTo(C);if(s&&s.unit==="imperial"){const G=3.2808*j;G>5280?$o(e,L,G/5280,x._getUIString("ScaleControl.Miles")):$o(e,L,G,x._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?$o(e,L,j/1852,x._getUIString("ScaleControl.NauticalMiles")):j>=1e3?$o(e,L,j/1e3,x._getUIString("ScaleControl.Kilometers")):$o(e,L,j,x._getUIString("ScaleControl.Meters"))}function $o(x,e,s,f){const g=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let C=w/E;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(R){const L=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*L)/L}(C),E*C}(s);x.style.width=e*(g/s)+"px",x.innerHTML=`${g}&nbsp;${f}`}const Va={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},pu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function mu(x){if(x){if(typeof x=="number"){const e=Math.round(Math.abs(x)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,x),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-x),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(x,0),right:new c.P(-x,0)}}if(x instanceof c.P||Array.isArray(x)){const e=c.P.convert(x);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(x.center||[0,0]),top:c.P.convert(x.top||[0,0]),"top-left":c.P.convert(x["top-left"]||[0,0]),"top-right":c.P.convert(x["top-right"]||[0,0]),bottom:c.P.convert(x.bottom||[0,0]),"bottom-left":c.P.convert(x["bottom-left"]||[0,0]),"bottom-right":c.P.convert(x["bottom-right"]||[0,0]),left:c.P.convert(x.left||[0,0]),right:c.P.convert(x.right||[0,0])}}return mu(new c.P(0,0))}const xh=D;v.AJAXError=c.cy,v.Event=c.l,v.Evented=c.E,v.LngLat=c.S,v.MercatorCoordinate=c.a0,v.Point=c.P,v.addProtocol=c.cz,v.config=c.a,v.removeProtocol=c.cA,v.AttributionControl=Tn,v.BoxZoomHandler=gc,v.CanvasSource=qr,v.CooperativeGesturesHandler=Uf,v.DoubleClickZoomHandler=Al,v.DragPanHandler=yc,v.DragRotateHandler=Ml,v.EdgeInsets=ga,v.FullscreenControl=class extends c.E{constructor(x={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Z.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const x=this._fullscreenButton=Z.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Z.create("span","maplibregl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=aa,v.GeolocateControl=class extends c.E{constructor(x){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new c.S(e.coords.longitude,e.coords.latitude),f=e.coords.accuracy,g=this._map.getBearing(),w=c.e({bearing:g},this.options.fitBoundsOptions),E=Xn.fromLngLat(s,f);this._map.fitBounds(E,w,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ho)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=Z.create("button","maplibregl-ctrl-geolocate",this._container),Z.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ni({element:this._dotElement}),this._circleElement=Z.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ni({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},ha,x)}onAdd(x){return this._map=x,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(zr!==void 0&&!e)return zr;if(window.navigator.permissions===void 0)return zr=!!window.navigator.geolocation,zr;try{zr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{zr=!!window.navigator.geolocation}return zr})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Z.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,mi=0,ho=!1}_isOutOfMapMaxBounds(x){const e=this._map.getMaxBounds(),s=x.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const x=this._map.getBounds(),e=x.getSouthEast(),s=x.getNorthEast(),f=e.distanceTo(s),g=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":mi--,ho=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),mi++,mi>1?(x={maximumAge:6e5,timeout:0},ho=!0):(x=this.options.positionOptions,ho=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.GlobeControl=class{constructor(){this._toggleProjection=()=>{var x;const e=(x=this._map.getProjection())===null||x===void 0?void 0:x.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var x;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((x=this._map.getProjection())===null||x===void 0?void 0:x.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(x){return this._map=x,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=Z.create("button","maplibregl-ctrl-globe",this._container),Z.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){Z.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},v.Hash=ja,v.ImageSource=Or,v.KeyboardHandler=Ua,v.LngLatBounds=Xn,v.LogoControl=ei,v.Map=class extends pi{constructor(x){var e,s;c.cv.mark(c.cw.create);const f=Object.assign(Object.assign(Object.assign({},vc),x),{canvasContextAttributes:Object.assign(Object.assign({},vc.canvasContextAttributes),x.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new Li,w=new vs;if(f.minZoom!==void 0&&g.setMinZoom(f.minZoom),f.maxZoom!==void 0&&g.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&g.setMinPitch(f.minPitch),f.maxPitch!==void 0&&g.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&g.setRenderWorldCopies(f.renderWorldCopies),super(g,w,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ir,this._controls=[],this._mapId=c.a6(),this._contextLost=C=>{C.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:C}))},this._contextRestored=C=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:C}))},this._onMapScroll=C=>{if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Dd),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=$e.addThrottleControl(()=>this.isMoving()),this._requestManager=new Me(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let C=!1;const R=oo(L=>{this._trackResize&&!this._removed&&(this.resize(L),this.redraw())},50);this._resizeObserver=new ResizeObserver(L=>{C?R(L):C=!0}),this._resizeObserver.observe(this._container)}this.handlers=new uo(this,f),this._hash=f.hash&&new ja(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.e({},f.fitBoundsOptions,{duration:0}))));const E=typeof f.style=="string"||((s=(e=f.style)===null||e===void 0?void 0:e.projection)===null||s===void 0?void 0:s.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Tn(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new ei,f.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const C=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(C)}}),this.on("data",C=>{this._update(C.dataType==="style"),this.fire(new c.l(`${C.dataType}data`,C))}),this.on("dataloading",C=>{this.fire(new c.l(`${C.dataType}dataloading`,C))}),this.on("dataabort",C=>{this.fire(new c.l("sourcedataabort",C))})}_getMapId(){return this._mapId}setGlobalStateProperty(x,e){return this.style.setGlobalStateProperty(x,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(x,e){if(e===void 0&&(e=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=x.onAdd(this);this._controls.push(x);const f=this._controlPositions[e];return e.indexOf("bottom")!==-1?f.insertBefore(s,f.firstChild):f.appendChild(s),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(x);return e>-1&&this._controls.splice(e,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}calculateCameraOptionsFromTo(x,e,s,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(x,e,s,f)}resize(x,e=!0){const[s,f]=this._containerDimensions(),g=this._getClampedPixelRatio(s,f);if(this._resizeCanvas(s,f,g),this.painter.resize(s,f,g),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const C=this._getClampedPixelRatio(s,f);this._resizeCanvas(s,f,C),this.painter.resize(s,f,C)}this._resizeTransform(e);const w=!this._moving;return w&&(this.stop(),this.fire(new c.l("movestart",x)).fire(new c.l("move",x))),this.fire(new c.l("resize",x)),w&&this.fire(new c.l("moveend",x)),this}_resizeTransform(x=!0){var e;const[s,f]=this._containerDimensions();this.transform.resize(s,f,x),(e=this._requestedCameraState)===null||e===void 0||e.resize(s,f,x)}_getClampedPixelRatio(x,e){const{0:s,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),w=x*g,E=e*g;return Math.min(w>s?s/w:1,E>f?f/E:1)*g}getPixelRatio(){var x;return(x=this._overridePixelRatio)!==null&&x!==void 0?x:devicePixelRatio}setPixelRatio(x){this._overridePixelRatio=x,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(Xn.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.setMinZoom(x),this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.setMaxZoom(x),this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.setMinPitch(x),this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(x>=this.transform.minPitch)return this.transform.setMaxPitch(x),this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.setRenderWorldCopies(x),this._update()}project(x){return this.transform.locationToScreenPoint(c.S.convert(x),this.style&&this.terrain)}unproject(x){return this.transform.screenPointToLocation(c.P.convert(x),this.terrain)}isMoving(){var x;return this._moving||((x=this.handlers)===null||x===void 0?void 0:x.isMoving())}isZooming(){var x;return this._zooming||((x=this.handlers)===null||x===void 0?void 0:x.isZooming())}isRotating(){var x;return this._rotating||((x=this.handlers)===null||x===void 0?void 0:x.isRotating())}_createDelegatedListener(x,e,s){if(x==="mouseenter"||x==="mouseover"){let f=!1;return{layers:e,listener:s,delegates:{mousemove:w=>{const E=e.filter(R=>this.getLayer(R)),C=E.length!==0?this.queryRenderedFeatures(w.point,{layers:E}):[];C.length?f||(f=!0,s.call(this,new ua(x,this,w.originalEvent,{features:C}))):f=!1},mouseout:()=>{f=!1}}}}if(x==="mouseleave"||x==="mouseout"){let f=!1;return{layers:e,listener:s,delegates:{mousemove:E=>{const C=e.filter(R=>this.getLayer(R));(C.length!==0?this.queryRenderedFeatures(E.point,{layers:C}):[]).length?f=!0:f&&(f=!1,s.call(this,new ua(x,this,E.originalEvent)))},mouseout:E=>{f&&(f=!1,s.call(this,new ua(x,this,E.originalEvent)))}}}}{const f=g=>{const w=e.filter(C=>this.getLayer(C)),E=w.length!==0?this.queryRenderedFeatures(g.point,{layers:w}):[];E.length&&(g.features=E,s.call(this,g),delete g.features)};return{layers:e,listener:s,delegates:{[x]:f}}}}_saveDelegatedListener(x,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(e)}_removeDelegatedListener(x,e,s){if(!this._delegatedListeners||!this._delegatedListeners[x])return;const f=this._delegatedListeners[x];for(let g=0;g<f.length;g++){const w=f[g];if(w.listener===s&&w.layers.length===e.length&&w.layers.every(E=>e.includes(E))){for(const E in w.delegates)this.off(E,w.delegates[E]);return void f.splice(g,1)}}}on(x,e,s){if(s===void 0)return super.on(x,e);const f=typeof e=="string"?[e]:e,g=this._createDelegatedListener(x,f,s);this._saveDelegatedListener(x,g);for(const w in g.delegates)this.on(w,g.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(x,f,s)}}}once(x,e,s){if(s===void 0)return super.once(x,e);const f=typeof e=="string"?[e]:e,g=this._createDelegatedListener(x,f,s);for(const w in g.delegates){const E=g.delegates[w];g.delegates[w]=(...C)=>{this._removeDelegatedListener(x,f,s),E(...C)}}this._saveDelegatedListener(x,g);for(const w in g.delegates)this.once(w,g.delegates[w]);return this}off(x,e,s){return s===void 0?super.off(x,e):(this._removeDelegatedListener(x,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(x,e){if(!this.style)return[];let s;const f=x instanceof c.P||Array.isArray(x),g=f?x:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(f?{}:x)||{},g instanceof c.P||typeof g[0]=="number")s=[c.P.convert(g)];else{const w=c.P.convert(g[0]),E=c.P.convert(g[1]);s=[w,new c.P(E.x,w.y),E,new c.P(w.x,E.y),w]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(x,e){return this.style.querySourceFeatures(x,e)}setStyle(x,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(x,e))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const e=this._locale[x];if(e==null)throw new Error(`Missing UI string '${x}'`);return e}_updateStyle(x,e){var s,f;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(x,e));const g=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!x)),x?(this.style=new wf(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x,e,g):this.style.loadJSON(x,e,g),this):((f=(s=this.style)===null||s===void 0?void 0:s.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new wf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,e){if(typeof x=="string"){const s=this._requestManager.transformRequest(x,"Style");c.j(s,new AbortController).then(f=>{this._updateDiff(f.data,e)}).catch(f=>{f&&this.fire(new c.k(f))})}else typeof x=="object"&&this._updateDiff(x,e)}_updateDiff(x,e){try{this.style.setState(x,e)&&this._update(!0)}catch(s){c.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(x,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(x,e){return this._lazyInitEmptyStyle(),this.style.addSource(x,e),this._update(!0)}isSourceLoaded(x){const e=this.style&&this.style.sourceCaches[x];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),x){const e=this.style.sourceCaches[x.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${x.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const f=this.style._layers[s];f.type==="hillshade"&&f.source===x.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===x.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Jr(this.painter,e,x),this.painter.renderToTexture=new Zt(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=s=>{var f;s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==x.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=s.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:x})),this}getTerrain(){var x,e;return(e=(x=this.terrain)===null||x===void 0?void 0:x.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const e in x){const s=x[e]._tiles;for(const f in s){const g=s[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}setSourceTileLodParams(x,e,s){if(s){const f=this.getSource(s);if(!f)throw new Error(`There is no source with ID "${s}", cannot set LOD parameters`);f.calculateTileZoom=Ze(Math.max(1,x),Math.max(1,e))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Ze(Math.max(1,x),Math.max(1,e));return this._update(!0),this}refreshTiles(x,e){const s=this.style.sourceCaches[x];if(!s)throw new Error(`There is no source cache with ID "${x}", cannot refresh tile`);e===void 0?s.reload(!0):s.refreshTiles(e.map(f=>new c.a3(f.z,f.x,f.y)))}addImage(x,e,s={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:w,stretchY:E,content:C,textFitWidth:R,textFitHeight:L}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:G,data:V}=e,Y=e;return this.style.addImage(x,{data:new c.R({width:j,height:G},new Uint8Array(V)),pixelRatio:f,stretchX:w,stretchY:E,content:C,textFitWidth:R,textFitHeight:L,sdf:g,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,x),this}}{const{width:j,height:G,data:V}=U.getImageData(e);this.style.addImage(x,{data:new c.R({width:j,height:G},V),pixelRatio:f,stretchX:w,stretchY:E,content:C,textFitWidth:R,textFitHeight:L,sdf:g,version:0})}}updateImage(x,e){const s=this.style.getImage(x);if(!s)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=e instanceof HTMLImageElement||c.b(e)?U.getImageData(e):e,{width:g,height:w,data:E}=f;if(g===void 0||w===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==s.data.width||w!==s.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(e instanceof HTMLImageElement||c.b(e));return s.data.replace(E,C),this.style.updateImage(x,s),this}getImage(x){return this.style.getImage(x)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x){return $e.getImage(this._requestManager.transformRequest(x,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(x,e){return this._lazyInitEmptyStyle(),this.style.addLayer(x,e),this._update(!0)}moveLayer(x,e){return this.style.moveLayer(x,e),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(x,e,s){return this.style.setLayerZoomRange(x,e,s),this._update(!0)}setFilter(x,e,s={}){return this.style.setFilter(x,e,s),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,e,s,f={}){return this.style.setPaintProperty(x,e,s,f),this._update(!0)}getPaintProperty(x,e){return this.style.getPaintProperty(x,e)}setLayoutProperty(x,e,s,f={}){return this.style.setLayoutProperty(x,e,s,f),this._update(!0)}getLayoutProperty(x,e){return this.style.getLayoutProperty(x,e)}setGlyphs(x,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(x,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(x,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(x,e,s,f=>{f||this._update(!0)}),this}removeSprite(x){return this._lazyInitEmptyStyle(),this.style.removeSprite(x),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(x,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(x,e,s=>{s||this._update(!0)}),this}setLight(x,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(x,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(x,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(x,e){return this.style.setFeatureState(x,e),this._update()}removeFeatureState(x,e){return this.style.removeFeatureState(x,e),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,e=0;return this._container&&(x=this._container.clientWidth||400,e=this._container.clientHeight||300),[x,e]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map");const e=this._canvasContainer=Z.create("div","maplibregl-canvas-container",x);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=Z.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),f=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],f);const g=this._controlContainer=Z.create("div","maplibregl-control-container",x),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{w[E]=Z.create("div",`maplibregl-ctrl-${E} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,e,s){this._canvas.width=Math.floor(s*x),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const x=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{e={requestedAttributes:x},f&&(e.statusMessage=f.statusMessage,e.type=f.type)},{once:!0});let s=null;if(s=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,x):this._canvas.getContext("webgl2",x)||this._canvas.getContext("webgl",x),!s){const f="Failed to initialize WebGL";throw e?(e.message=f,new Error(JSON.stringify(e))):new Error(f)}this.painter=new va(s,this.transform),ne.testSupport(s)}migrateProjection(x,e){super.migrateProjection(x,e),this.painter.transform=x,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){var e,s,f,g,w;const E=this._idleTriggered?this._fadeDuration:0,C=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,V=U.now();this.style.zoomHistory.update(G,V);const Y=new c.F(G,{now:V,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),K=Y.crossFadingFactor();K===1&&K===this._crossFadingFactor||(R=!0,this._crossFadingFactor=K),this.style.update(Y)}const L=((s=this.style.projection)===null||s===void 0?void 0:s.transitionState)>0!==C;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||L)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,L),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cv.mark(c.cw.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,c.cv.mark(c.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var x;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),$e.removeThrottleControl(this._imageQueueHandle),(x=this._resizeObserver)===null||x===void 0||x.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Z.remove(this._canvasContainer),Z.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cv.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,U.frame(this._frameRequest,x=>{c.cv.frame(x),this._frameRequest=null;try{this._render(x)}catch(e){if(!c.cx(e)&&!function(s){return s.message===zf}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get version(){return Ui}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(x){return this._lazyInitEmptyStyle(),this.style.setProjection(x),this._update(!0)}},v.MapMouseEvent=ua,v.MapTouchEvent=Ms,v.MapWheelEvent=Of,v.Marker=Ni,v.NavigationControl=class{constructor(x){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),f=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,s)=>{const f=this._map._getUIString(`NavigationControl.${s}`);e.title=f,e.setAttribute("aria-label",f)},this.options=c.e({},Vr,x),this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),Z.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),Z.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=Z.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vf(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Z.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,e){const s=Z.create("button",x,this._container);return s.type="button",s.addEventListener("click",e),s}},v.Popup=class extends c.E{constructor(x){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&Z.remove(this._content),this._container&&(Z.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=Z.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Z.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=tm(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const s=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const g=mu(this.options.offset);if(!f){const E=this._container.offsetWidth,C=this._container.offsetHeight;let R;R=s.y+g.bottom.y<C?["top"]:s.y>this._map.transform.height-C?["bottom"]:[],s.x<E/2?R.push("left"):s.x>this._map.transform.width-E/2&&R.push("right"),f=R.length===0?"bottom":R.join("-")}let w=s.add(g[f]);this.options.subpixelPositioning||(w=w.round()),Z.setTransform(this._container,`${Zo[f]} translate(${w.x}px,${w.y}px)`),Ei(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Va),x)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=c.S.convert(x),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const e=document.createDocumentFragment(),s=document.createElement("body");let f;for(s.innerHTML=x;f=s.firstChild,f;)e.appendChild(f);return this.setDOMContent(e)}getMaxWidth(){var x;return(x=this._container)===null||x===void 0?void 0:x.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Z.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){return this._container&&this._container.classList.add(x),this}removeClassName(x){return this._container&&this._container.classList.remove(x),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}setSubpixelPositioning(x){this.options.subpixelPositioning=x}_createCloseButton(){this.options.closeButton&&(this._closeButton=Z.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(pu);x&&x.focus()}},v.RasterDEMTileSource=qn,v.RasterTileSource=Wa,v.ScaleControl=class{constructor(x){this._onMove=()=>{bc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,bc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},xc),x)}getDefaultPosition(){return"bottom-left"}onAdd(x){return this._map=x,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Z.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Go,v.Style=wf,v.TerrainControl=class{constructor(x){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=x}onAdd(x){return this._map=x,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Z.create("button","maplibregl-ctrl-terrain",this._container),Z.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Z.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=Ed,v.TwoFingersTouchRotateHandler=Sd,v.TwoFingersTouchZoomHandler=Ds,v.TwoFingersTouchZoomRotateHandler=Ad,v.VectorTileSource=Pn,v.VideoSource=Yr,v.addSourceType=(x,e)=>c._(void 0,void 0,void 0,function*(){if(gs(x))throw new Error(`A source type called "${x}" already exists.`);((s,f)=>{ol[s]=f})(x,e)}),v.clearPrewarmedResources=function(){const x=Mt;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(Ce),Mt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.createTileMesh=xf,v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return ci().getRTLTextPluginStatus()},v.getVersion=function(){return xh},v.getWorkerCount=function(){return ut.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(x){return Ri().broadcast("IS",x)},v.prewarm=function(){Jt().acquire(Ce)},v.setMaxParallelImageRequests=function(x){c.a.MAX_PARALLEL_IMAGE_REQUESTS=x},v.setRTLTextPlugin=function(x,e){return ci().setRTLTextPlugin(x,e)},v.setWorkerCount=function(x){ut.workerCount=x},v.setWorkerUrl=function(x){c.a.WORKER_URL=x}});var _=o;return _})}(N0)),N0.exports}var a2=tA();const s2=jp(a2),o2=fE({__proto__:null,default:s2},[a2]),nA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",iA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class qm extends Error{constructor(o,h){const p=`${qm.extractMessage(o)}: ${JSON.stringify({response:o,request:h})}`;super(p);vp(this,"response");vp(this,"request");Object.setPrototypeOf(this,qm.prototype),this.response=o,this.request=h,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,qm)}static extractMessage(o){var h,p;return((p=(h=o.errors)==null?void 0:h[0])==null?void 0:p.message)??`GraphQL Error (Code: ${String(o.status)})`}}const _1=i=>i.toUpperCase(),Wv=i=>typeof i=="function"?i():i,l2=(i,n)=>i.map((o,h)=>[o,n[h]]),Lm=i=>{let n={};return i instanceof Headers?n=rA(i):Array.isArray(i)?i.forEach(([o,h])=>{o&&h!==void 0&&(n[o]=h)}):i&&(n=i),n},rA=i=>{const n={};return i.forEach((o,h)=>{n[h]=o}),n},aA=i=>{try{const n=i();return sA(n)?n.catch(o=>v1(o)):n}catch(n){return v1(n)}},v1=i=>i instanceof Error?i:new Error(String(i)),sA=i=>typeof i=="object"&&i!==null&&"then"in i&&typeof i.then=="function"&&"catch"in i&&typeof i.catch=="function"&&"finally"in i&&typeof i.finally=="function",ob=i=>{throw new Error(`Unhandled case: ${String(i)}`)},P0=i=>typeof i=="object"&&i!==null&&!Array.isArray(i),oA=(i,n)=>i.documents?i:{documents:i,requestHeaders:n,signal:void 0},lA=(i,n,o)=>i.query?i:{query:i,variables:n,requestHeaders:o,signal:void 0};function Ti(i,n){if(!!!i)throw new Error(n)}function Qh(i){return typeof i=="object"&&i!==null}function sv(i,n){if(!!!i)throw new Error(n??"Unexpected invariant triggered.")}const cA=/\r\n|[\n\r]/g;function xx(i,n){let o=0,h=1;for(const p of i.body.matchAll(cA)){if(typeof p.index=="number"||sv(!1),p.index>=n)break;o=p.index+p[0].length,h+=1}return{line:h,column:n+1-o}}function uA(i){return c2(i.source,xx(i.source,i.start))}function c2(i,n){const o=i.locationOffset.column-1,h="".padStart(o)+i.body,p=n.line-1,_=i.locationOffset.line-1,v=n.line+_,c=n.line===1?o:0,D=n.column+c,I=`${i.name}:${v}:${D}
`,P=h.split(/\r\n|[\n\r]/g),B=P[p];if(B.length>120){const U=Math.floor(D/80),Z=D%80,ne=[];for(let ye=0;ye<B.length;ye+=80)ne.push(B.slice(ye,ye+80));return I+x1([[`${v} |`,ne[0]],...ne.slice(1,U+1).map(ye=>["|",ye]),["|","^".padStart(Z)],["|",ne[U+1]]])}return I+x1([[`${v-1} |`,P[p-1]],[`${v} |`,B],["|","^".padStart(D)],[`${v+1} |`,P[p+1]]])}function x1(i){const n=i.filter(([h,p])=>p!==void 0),o=Math.max(...n.map(([h])=>h.length));return n.map(([h,p])=>h.padStart(o)+(p?" "+p:"")).join(`
`)}function hA(i){const n=i[0];return n==null||"kind"in n||"length"in n?{nodes:n,source:i[1],positions:i[2],path:i[3],originalError:i[4],extensions:i[5]}:n}class ki extends Error{constructor(n,...o){var h,p,_;const{nodes:v,source:c,positions:D,path:I,originalError:P,extensions:B}=hA(o);super(n),this.name="GraphQLError",this.path=I??void 0,this.originalError=P??void 0,this.nodes=b1(Array.isArray(v)?v:v?[v]:void 0);const U=b1((h=this.nodes)===null||h===void 0?void 0:h.map(ne=>ne.loc).filter(ne=>ne!=null));this.source=c??(U==null||(p=U[0])===null||p===void 0?void 0:p.source),this.positions=D??(U==null?void 0:U.map(ne=>ne.start)),this.locations=D&&c?D.map(ne=>xx(c,ne)):U==null?void 0:U.map(ne=>xx(ne.source,ne.start));const Z=Qh(P==null?void 0:P.extensions)?P==null?void 0:P.extensions:void 0;this.extensions=(_=B??Z)!==null&&_!==void 0?_:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),P!=null&&P.stack?Object.defineProperty(this,"stack",{value:P.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,ki):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let n=this.message;if(this.nodes)for(const o of this.nodes)o.loc&&(n+=`

`+uA(o.loc));else if(this.source&&this.locations)for(const o of this.locations)n+=`

`+c2(this.source,o);return n}toJSON(){const n={message:this.message};return this.locations!=null&&(n.locations=this.locations),this.path!=null&&(n.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(n.extensions=this.extensions),n}}function b1(i){return i===void 0||i.length===0?void 0:i}function Aa(i,n,o){return new ki(`Syntax Error: ${o}`,{source:i,positions:[n]})}class dA{constructor(n,o,h){this.start=n.start,this.end=o.end,this.startToken=n,this.endToken=o,this.source=h}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class u2{constructor(n,o,h,p,_,v){this.kind=n,this.start=o,this.end=h,this.line=p,this.column=_,this.value=v,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const h2={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},fA=new Set(Object.keys(h2));function w1(i){const n=i==null?void 0:i.kind;return typeof n=="string"&&fA.has(n)}var Bh;(function(i){i.QUERY="query",i.MUTATION="mutation",i.SUBSCRIPTION="subscription"})(Bh||(Bh={}));var ai;(function(i){i.QUERY="QUERY",i.MUTATION="MUTATION",i.SUBSCRIPTION="SUBSCRIPTION",i.FIELD="FIELD",i.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",i.FRAGMENT_SPREAD="FRAGMENT_SPREAD",i.INLINE_FRAGMENT="INLINE_FRAGMENT",i.VARIABLE_DEFINITION="VARIABLE_DEFINITION",i.SCHEMA="SCHEMA",i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.FIELD_DEFINITION="FIELD_DEFINITION",i.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.ENUM_VALUE="ENUM_VALUE",i.INPUT_OBJECT="INPUT_OBJECT",i.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(ai||(ai={}));var Nt;(function(i){i.NAME="Name",i.DOCUMENT="Document",i.OPERATION_DEFINITION="OperationDefinition",i.VARIABLE_DEFINITION="VariableDefinition",i.SELECTION_SET="SelectionSet",i.FIELD="Field",i.ARGUMENT="Argument",i.FRAGMENT_SPREAD="FragmentSpread",i.INLINE_FRAGMENT="InlineFragment",i.FRAGMENT_DEFINITION="FragmentDefinition",i.VARIABLE="Variable",i.INT="IntValue",i.FLOAT="FloatValue",i.STRING="StringValue",i.BOOLEAN="BooleanValue",i.NULL="NullValue",i.ENUM="EnumValue",i.LIST="ListValue",i.OBJECT="ObjectValue",i.OBJECT_FIELD="ObjectField",i.DIRECTIVE="Directive",i.NAMED_TYPE="NamedType",i.LIST_TYPE="ListType",i.NON_NULL_TYPE="NonNullType",i.SCHEMA_DEFINITION="SchemaDefinition",i.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",i.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",i.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",i.FIELD_DEFINITION="FieldDefinition",i.INPUT_VALUE_DEFINITION="InputValueDefinition",i.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",i.UNION_TYPE_DEFINITION="UnionTypeDefinition",i.ENUM_TYPE_DEFINITION="EnumTypeDefinition",i.ENUM_VALUE_DEFINITION="EnumValueDefinition",i.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",i.DIRECTIVE_DEFINITION="DirectiveDefinition",i.SCHEMA_EXTENSION="SchemaExtension",i.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",i.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",i.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",i.UNION_TYPE_EXTENSION="UnionTypeExtension",i.ENUM_TYPE_EXTENSION="EnumTypeExtension",i.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(Nt||(Nt={}));function bx(i){return i===9||i===32}function o_(i){return i>=48&&i<=57}function d2(i){return i>=97&&i<=122||i>=65&&i<=90}function lb(i){return d2(i)||i===95}function f2(i){return d2(i)||o_(i)||i===95}function pA(i){var n;let o=Number.MAX_SAFE_INTEGER,h=null,p=-1;for(let v=0;v<i.length;++v){var _;const c=i[v],D=mA(c);D!==c.length&&(h=(_=h)!==null&&_!==void 0?_:v,p=v,v!==0&&D<o&&(o=D))}return i.map((v,c)=>c===0?v:v.slice(o)).slice((n=h)!==null&&n!==void 0?n:0,p+1)}function mA(i){let n=0;for(;n<i.length&&bx(i.charCodeAt(n));)++n;return n}function gA(i,n){const o=i.replace(/"""/g,'\\"""'),h=o.split(/\r\n|[\n\r]/g),p=h.length===1,_=h.length>1&&h.slice(1).every(Z=>Z.length===0||bx(Z.charCodeAt(0))),v=o.endsWith('\\"""'),c=i.endsWith('"')&&!v,D=i.endsWith("\\"),I=c||D,P=!p||i.length>70||I||_||v;let B="";const U=p&&bx(i.charCodeAt(0));return(P&&!U||_)&&(B+=`
`),B+=o,(P||I)&&(B+=`
`),'"""'+B+'"""'}var xt;(function(i){i.SOF="<SOF>",i.EOF="<EOF>",i.BANG="!",i.DOLLAR="$",i.AMP="&",i.PAREN_L="(",i.PAREN_R=")",i.SPREAD="...",i.COLON=":",i.EQUALS="=",i.AT="@",i.BRACKET_L="[",i.BRACKET_R="]",i.BRACE_L="{",i.PIPE="|",i.BRACE_R="}",i.NAME="Name",i.INT="Int",i.FLOAT="Float",i.STRING="String",i.BLOCK_STRING="BlockString",i.COMMENT="Comment"})(xt||(xt={}));class yA{constructor(n){const o=new u2(xt.SOF,0,0,0,0);this.source=n,this.lastToken=o,this.token=o,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let n=this.token;if(n.kind!==xt.EOF)do if(n.next)n=n.next;else{const o=vA(this,n.end);n.next=o,o.prev=n,n=o}while(n.kind===xt.COMMENT);return n}}function _A(i){return i===xt.BANG||i===xt.DOLLAR||i===xt.AMP||i===xt.PAREN_L||i===xt.PAREN_R||i===xt.SPREAD||i===xt.COLON||i===xt.EQUALS||i===xt.AT||i===xt.BRACKET_L||i===xt.BRACKET_R||i===xt.BRACE_L||i===xt.PIPE||i===xt.BRACE_R}function hg(i){return i>=0&&i<=55295||i>=57344&&i<=1114111}function ov(i,n){return p2(i.charCodeAt(n))&&m2(i.charCodeAt(n+1))}function p2(i){return i>=55296&&i<=56319}function m2(i){return i>=56320&&i<=57343}function Cp(i,n){const o=i.source.body.codePointAt(n);if(o===void 0)return xt.EOF;if(o>=32&&o<=126){const h=String.fromCodePoint(o);return h==='"'?`'"'`:`"${h}"`}return"U+"+o.toString(16).toUpperCase().padStart(4,"0")}function ra(i,n,o,h,p){const _=i.line,v=1+o-i.lineStart;return new u2(n,o,h,_,v,p)}function vA(i,n){const o=i.source.body,h=o.length;let p=n;for(;p<h;){const _=o.charCodeAt(p);switch(_){case 65279:case 9:case 32:case 44:++p;continue;case 10:++p,++i.line,i.lineStart=p;continue;case 13:o.charCodeAt(p+1)===10?p+=2:++p,++i.line,i.lineStart=p;continue;case 35:return xA(i,p);case 33:return ra(i,xt.BANG,p,p+1);case 36:return ra(i,xt.DOLLAR,p,p+1);case 38:return ra(i,xt.AMP,p,p+1);case 40:return ra(i,xt.PAREN_L,p,p+1);case 41:return ra(i,xt.PAREN_R,p,p+1);case 46:if(o.charCodeAt(p+1)===46&&o.charCodeAt(p+2)===46)return ra(i,xt.SPREAD,p,p+3);break;case 58:return ra(i,xt.COLON,p,p+1);case 61:return ra(i,xt.EQUALS,p,p+1);case 64:return ra(i,xt.AT,p,p+1);case 91:return ra(i,xt.BRACKET_L,p,p+1);case 93:return ra(i,xt.BRACKET_R,p,p+1);case 123:return ra(i,xt.BRACE_L,p,p+1);case 124:return ra(i,xt.PIPE,p,p+1);case 125:return ra(i,xt.BRACE_R,p,p+1);case 34:return o.charCodeAt(p+1)===34&&o.charCodeAt(p+2)===34?AA(i,p):wA(i,p)}if(o_(_)||_===45)return bA(i,p,_);if(lb(_))return MA(i,p);throw Aa(i.source,p,_===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:hg(_)||ov(o,p)?`Unexpected character: ${Cp(i,p)}.`:`Invalid character: ${Cp(i,p)}.`)}return ra(i,xt.EOF,h,h)}function xA(i,n){const o=i.source.body,h=o.length;let p=n+1;for(;p<h;){const _=o.charCodeAt(p);if(_===10||_===13)break;if(hg(_))++p;else if(ov(o,p))p+=2;else break}return ra(i,xt.COMMENT,n,p,o.slice(n+1,p))}function bA(i,n,o){const h=i.source.body;let p=n,_=o,v=!1;if(_===45&&(_=h.charCodeAt(++p)),_===48){if(_=h.charCodeAt(++p),o_(_))throw Aa(i.source,p,`Invalid number, unexpected digit after 0: ${Cp(i,p)}.`)}else p=Qv(i,p,_),_=h.charCodeAt(p);if(_===46&&(v=!0,_=h.charCodeAt(++p),p=Qv(i,p,_),_=h.charCodeAt(p)),(_===69||_===101)&&(v=!0,_=h.charCodeAt(++p),(_===43||_===45)&&(_=h.charCodeAt(++p)),p=Qv(i,p,_),_=h.charCodeAt(p)),_===46||lb(_))throw Aa(i.source,p,`Invalid number, expected digit but got: ${Cp(i,p)}.`);return ra(i,v?xt.FLOAT:xt.INT,n,p,h.slice(n,p))}function Qv(i,n,o){if(!o_(o))throw Aa(i.source,n,`Invalid number, expected digit but got: ${Cp(i,n)}.`);const h=i.source.body;let p=n+1;for(;o_(h.charCodeAt(p));)++p;return p}function wA(i,n){const o=i.source.body,h=o.length;let p=n+1,_=p,v="";for(;p<h;){const c=o.charCodeAt(p);if(c===34)return v+=o.slice(_,p),ra(i,xt.STRING,n,p+1,v);if(c===92){v+=o.slice(_,p);const D=o.charCodeAt(p+1)===117?o.charCodeAt(p+2)===123?TA(i,p):SA(i,p):EA(i,p);v+=D.value,p+=D.size,_=p;continue}if(c===10||c===13)break;if(hg(c))++p;else if(ov(o,p))p+=2;else throw Aa(i.source,p,`Invalid character within String: ${Cp(i,p)}.`)}throw Aa(i.source,p,"Unterminated string.")}function TA(i,n){const o=i.source.body;let h=0,p=3;for(;p<12;){const _=o.charCodeAt(n+p++);if(_===125){if(p<5||!hg(h))break;return{value:String.fromCodePoint(h),size:p}}if(h=h<<4|By(_),h<0)break}throw Aa(i.source,n,`Invalid Unicode escape sequence: "${o.slice(n,n+p)}".`)}function SA(i,n){const o=i.source.body,h=T1(o,n+2);if(hg(h))return{value:String.fromCodePoint(h),size:6};if(p2(h)&&o.charCodeAt(n+6)===92&&o.charCodeAt(n+7)===117){const p=T1(o,n+8);if(m2(p))return{value:String.fromCodePoint(h,p),size:12}}throw Aa(i.source,n,`Invalid Unicode escape sequence: "${o.slice(n,n+6)}".`)}function T1(i,n){return By(i.charCodeAt(n))<<12|By(i.charCodeAt(n+1))<<8|By(i.charCodeAt(n+2))<<4|By(i.charCodeAt(n+3))}function By(i){return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:-1}function EA(i,n){const o=i.source.body;switch(o.charCodeAt(n+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Aa(i.source,n,`Invalid character escape sequence: "${o.slice(n,n+2)}".`)}function AA(i,n){const o=i.source.body,h=o.length;let p=i.lineStart,_=n+3,v=_,c="";const D=[];for(;_<h;){const I=o.charCodeAt(_);if(I===34&&o.charCodeAt(_+1)===34&&o.charCodeAt(_+2)===34){c+=o.slice(v,_),D.push(c);const P=ra(i,xt.BLOCK_STRING,n,_+3,pA(D).join(`
`));return i.line+=D.length-1,i.lineStart=p,P}if(I===92&&o.charCodeAt(_+1)===34&&o.charCodeAt(_+2)===34&&o.charCodeAt(_+3)===34){c+=o.slice(v,_),v=_+1,_+=4;continue}if(I===10||I===13){c+=o.slice(v,_),D.push(c),I===13&&o.charCodeAt(_+1)===10?_+=2:++_,c="",v=_,p=_;continue}if(hg(I))++_;else if(ov(o,_))_+=2;else throw Aa(i.source,_,`Invalid character within String: ${Cp(i,_)}.`)}throw Aa(i.source,_,"Unterminated string.")}function MA(i,n){const o=i.source.body,h=o.length;let p=n+1;for(;p<h;){const _=o.charCodeAt(p);if(f2(_))++p;else break}return ra(i,xt.NAME,n,p,o.slice(n,p))}const CA=10,g2=2;function Sn(i){return lv(i,[])}function lv(i,n){switch(typeof i){case"string":return JSON.stringify(i);case"function":return i.name?`[function ${i.name}]`:"[function]";case"object":return DA(i,n);default:return String(i)}}function DA(i,n){if(i===null)return"null";if(n.includes(i))return"[Circular]";const o=[...n,i];if(kA(i)){const h=i.toJSON();if(h!==i)return typeof h=="string"?h:lv(h,o)}else if(Array.isArray(i))return RA(i,o);return IA(i,o)}function kA(i){return typeof i.toJSON=="function"}function IA(i,n){const o=Object.entries(i);return o.length===0?"{}":n.length>g2?"["+zA(i)+"]":"{ "+o.map(([p,_])=>p+": "+lv(_,n)).join(", ")+" }"}function RA(i,n){if(i.length===0)return"[]";if(n.length>g2)return"[Array]";const o=Math.min(CA,i.length),h=i.length-o,p=[];for(let _=0;_<o;++_)p.push(lv(i[_],n));return h===1?p.push("... 1 more item"):h>1&&p.push(`... ${h} more items`),"["+p.join(", ")+"]"}function zA(i){const n=Object.prototype.toString.call(i).replace(/^\[object /,"").replace(/]$/,"");if(n==="Object"&&typeof i.constructor=="function"){const o=i.constructor.name;if(typeof o=="string"&&o!=="")return o}return n}const NA=globalThis.process&&!0,Zu=NA?function(n,o){return n instanceof o}:function(n,o){if(n instanceof o)return!0;if(typeof n=="object"&&n!==null){var h;const p=o.prototype[Symbol.toStringTag],_=Symbol.toStringTag in n?n[Symbol.toStringTag]:(h=n.constructor)===null||h===void 0?void 0:h.name;if(p===_){const v=Sn(n);throw new Error(`Cannot use ${p} "${v}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class y2{constructor(n,o="GraphQL request",h={line:1,column:1}){typeof n=="string"||Ti(!1,`Body must be a string. Received: ${Sn(n)}.`),this.body=n,this.name=o,this.locationOffset=h,this.locationOffset.line>0||Ti(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Ti(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function PA(i){return Zu(i,y2)}function LA(i,n){const o=new _2(i,n),h=o.parseDocument();return Object.defineProperty(h,"tokenCount",{enumerable:!1,value:o.tokenCount}),h}function OA(i,n){const o=new _2(i,n);o.expectToken(xt.SOF);const h=o.parseValueLiteral(!1);return o.expectToken(xt.EOF),h}class _2{constructor(n,o={}){const h=PA(n)?n:new y2(n);this._lexer=new yA(h),this._options=o,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const n=this.expectToken(xt.NAME);return this.node(n,{kind:Nt.NAME,value:n.value})}parseDocument(){return this.node(this._lexer.token,{kind:Nt.DOCUMENT,definitions:this.many(xt.SOF,this.parseDefinition,xt.EOF)})}parseDefinition(){if(this.peek(xt.BRACE_L))return this.parseOperationDefinition();const n=this.peekDescription(),o=n?this._lexer.lookahead():this._lexer.token;if(o.kind===xt.NAME){switch(o.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(n)throw Aa(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(o.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(o)}parseOperationDefinition(){const n=this._lexer.token;if(this.peek(xt.BRACE_L))return this.node(n,{kind:Nt.OPERATION_DEFINITION,operation:Bh.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const o=this.parseOperationType();let h;return this.peek(xt.NAME)&&(h=this.parseName()),this.node(n,{kind:Nt.OPERATION_DEFINITION,operation:o,name:h,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const n=this.expectToken(xt.NAME);switch(n.value){case"query":return Bh.QUERY;case"mutation":return Bh.MUTATION;case"subscription":return Bh.SUBSCRIPTION}throw this.unexpected(n)}parseVariableDefinitions(){return this.optionalMany(xt.PAREN_L,this.parseVariableDefinition,xt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:Nt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(xt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(xt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const n=this._lexer.token;return this.expectToken(xt.DOLLAR),this.node(n,{kind:Nt.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:Nt.SELECTION_SET,selections:this.many(xt.BRACE_L,this.parseSelection,xt.BRACE_R)})}parseSelection(){return this.peek(xt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const n=this._lexer.token,o=this.parseName();let h,p;return this.expectOptionalToken(xt.COLON)?(h=o,p=this.parseName()):p=o,this.node(n,{kind:Nt.FIELD,alias:h,name:p,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(xt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(n){const o=n?this.parseConstArgument:this.parseArgument;return this.optionalMany(xt.PAREN_L,o,xt.PAREN_R)}parseArgument(n=!1){const o=this._lexer.token,h=this.parseName();return this.expectToken(xt.COLON),this.node(o,{kind:Nt.ARGUMENT,name:h,value:this.parseValueLiteral(n)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const n=this._lexer.token;this.expectToken(xt.SPREAD);const o=this.expectOptionalKeyword("on");return!o&&this.peek(xt.NAME)?this.node(n,{kind:Nt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(n,{kind:Nt.INLINE_FRAGMENT,typeCondition:o?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const n=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(n,{kind:Nt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(n,{kind:Nt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(n){const o=this._lexer.token;switch(o.kind){case xt.BRACKET_L:return this.parseList(n);case xt.BRACE_L:return this.parseObject(n);case xt.INT:return this.advanceLexer(),this.node(o,{kind:Nt.INT,value:o.value});case xt.FLOAT:return this.advanceLexer(),this.node(o,{kind:Nt.FLOAT,value:o.value});case xt.STRING:case xt.BLOCK_STRING:return this.parseStringLiteral();case xt.NAME:switch(this.advanceLexer(),o.value){case"true":return this.node(o,{kind:Nt.BOOLEAN,value:!0});case"false":return this.node(o,{kind:Nt.BOOLEAN,value:!1});case"null":return this.node(o,{kind:Nt.NULL});default:return this.node(o,{kind:Nt.ENUM,value:o.value})}case xt.DOLLAR:if(n)if(this.expectToken(xt.DOLLAR),this._lexer.token.kind===xt.NAME){const h=this._lexer.token.value;throw Aa(this._lexer.source,o.start,`Unexpected variable "$${h}" in constant value.`)}else throw this.unexpected(o);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const n=this._lexer.token;return this.advanceLexer(),this.node(n,{kind:Nt.STRING,value:n.value,block:n.kind===xt.BLOCK_STRING})}parseList(n){const o=()=>this.parseValueLiteral(n);return this.node(this._lexer.token,{kind:Nt.LIST,values:this.any(xt.BRACKET_L,o,xt.BRACKET_R)})}parseObject(n){const o=()=>this.parseObjectField(n);return this.node(this._lexer.token,{kind:Nt.OBJECT,fields:this.any(xt.BRACE_L,o,xt.BRACE_R)})}parseObjectField(n){const o=this._lexer.token,h=this.parseName();return this.expectToken(xt.COLON),this.node(o,{kind:Nt.OBJECT_FIELD,name:h,value:this.parseValueLiteral(n)})}parseDirectives(n){const o=[];for(;this.peek(xt.AT);)o.push(this.parseDirective(n));return o}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(n){const o=this._lexer.token;return this.expectToken(xt.AT),this.node(o,{kind:Nt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(n)})}parseTypeReference(){const n=this._lexer.token;let o;if(this.expectOptionalToken(xt.BRACKET_L)){const h=this.parseTypeReference();this.expectToken(xt.BRACKET_R),o=this.node(n,{kind:Nt.LIST_TYPE,type:h})}else o=this.parseNamedType();return this.expectOptionalToken(xt.BANG)?this.node(n,{kind:Nt.NON_NULL_TYPE,type:o}):o}parseNamedType(){return this.node(this._lexer.token,{kind:Nt.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(xt.STRING)||this.peek(xt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("schema");const h=this.parseConstDirectives(),p=this.many(xt.BRACE_L,this.parseOperationTypeDefinition,xt.BRACE_R);return this.node(n,{kind:Nt.SCHEMA_DEFINITION,description:o,directives:h,operationTypes:p})}parseOperationTypeDefinition(){const n=this._lexer.token,o=this.parseOperationType();this.expectToken(xt.COLON);const h=this.parseNamedType();return this.node(n,{kind:Nt.OPERATION_TYPE_DEFINITION,operation:o,type:h})}parseScalarTypeDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("scalar");const h=this.parseName(),p=this.parseConstDirectives();return this.node(n,{kind:Nt.SCALAR_TYPE_DEFINITION,description:o,name:h,directives:p})}parseObjectTypeDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("type");const h=this.parseName(),p=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:Nt.OBJECT_TYPE_DEFINITION,description:o,name:h,interfaces:p,directives:_,fields:v})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(xt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(xt.BRACE_L,this.parseFieldDefinition,xt.BRACE_R)}parseFieldDefinition(){const n=this._lexer.token,o=this.parseDescription(),h=this.parseName(),p=this.parseArgumentDefs();this.expectToken(xt.COLON);const _=this.parseTypeReference(),v=this.parseConstDirectives();return this.node(n,{kind:Nt.FIELD_DEFINITION,description:o,name:h,arguments:p,type:_,directives:v})}parseArgumentDefs(){return this.optionalMany(xt.PAREN_L,this.parseInputValueDef,xt.PAREN_R)}parseInputValueDef(){const n=this._lexer.token,o=this.parseDescription(),h=this.parseName();this.expectToken(xt.COLON);const p=this.parseTypeReference();let _;this.expectOptionalToken(xt.EQUALS)&&(_=this.parseConstValueLiteral());const v=this.parseConstDirectives();return this.node(n,{kind:Nt.INPUT_VALUE_DEFINITION,description:o,name:h,type:p,defaultValue:_,directives:v})}parseInterfaceTypeDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("interface");const h=this.parseName(),p=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:Nt.INTERFACE_TYPE_DEFINITION,description:o,name:h,interfaces:p,directives:_,fields:v})}parseUnionTypeDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("union");const h=this.parseName(),p=this.parseConstDirectives(),_=this.parseUnionMemberTypes();return this.node(n,{kind:Nt.UNION_TYPE_DEFINITION,description:o,name:h,directives:p,types:_})}parseUnionMemberTypes(){return this.expectOptionalToken(xt.EQUALS)?this.delimitedMany(xt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("enum");const h=this.parseName(),p=this.parseConstDirectives(),_=this.parseEnumValuesDefinition();return this.node(n,{kind:Nt.ENUM_TYPE_DEFINITION,description:o,name:h,directives:p,values:_})}parseEnumValuesDefinition(){return this.optionalMany(xt.BRACE_L,this.parseEnumValueDefinition,xt.BRACE_R)}parseEnumValueDefinition(){const n=this._lexer.token,o=this.parseDescription(),h=this.parseEnumValueName(),p=this.parseConstDirectives();return this.node(n,{kind:Nt.ENUM_VALUE_DEFINITION,description:o,name:h,directives:p})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Aa(this._lexer.source,this._lexer.token.start,`${M0(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("input");const h=this.parseName(),p=this.parseConstDirectives(),_=this.parseInputFieldsDefinition();return this.node(n,{kind:Nt.INPUT_OBJECT_TYPE_DEFINITION,description:o,name:h,directives:p,fields:_})}parseInputFieldsDefinition(){return this.optionalMany(xt.BRACE_L,this.parseInputValueDef,xt.BRACE_R)}parseTypeSystemExtension(){const n=this._lexer.lookahead();if(n.kind===xt.NAME)switch(n.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(n)}parseSchemaExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const o=this.parseConstDirectives(),h=this.optionalMany(xt.BRACE_L,this.parseOperationTypeDefinition,xt.BRACE_R);if(o.length===0&&h.length===0)throw this.unexpected();return this.node(n,{kind:Nt.SCHEMA_EXTENSION,directives:o,operationTypes:h})}parseScalarTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const o=this.parseName(),h=this.parseConstDirectives();if(h.length===0)throw this.unexpected();return this.node(n,{kind:Nt.SCALAR_TYPE_EXTENSION,name:o,directives:h})}parseObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const o=this.parseName(),h=this.parseImplementsInterfaces(),p=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(h.length===0&&p.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:Nt.OBJECT_TYPE_EXTENSION,name:o,interfaces:h,directives:p,fields:_})}parseInterfaceTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const o=this.parseName(),h=this.parseImplementsInterfaces(),p=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(h.length===0&&p.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:Nt.INTERFACE_TYPE_EXTENSION,name:o,interfaces:h,directives:p,fields:_})}parseUnionTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const o=this.parseName(),h=this.parseConstDirectives(),p=this.parseUnionMemberTypes();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Nt.UNION_TYPE_EXTENSION,name:o,directives:h,types:p})}parseEnumTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const o=this.parseName(),h=this.parseConstDirectives(),p=this.parseEnumValuesDefinition();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Nt.ENUM_TYPE_EXTENSION,name:o,directives:h,values:p})}parseInputObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const o=this.parseName(),h=this.parseConstDirectives(),p=this.parseInputFieldsDefinition();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Nt.INPUT_OBJECT_TYPE_EXTENSION,name:o,directives:h,fields:p})}parseDirectiveDefinition(){const n=this._lexer.token,o=this.parseDescription();this.expectKeyword("directive"),this.expectToken(xt.AT);const h=this.parseName(),p=this.parseArgumentDefs(),_=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const v=this.parseDirectiveLocations();return this.node(n,{kind:Nt.DIRECTIVE_DEFINITION,description:o,name:h,arguments:p,repeatable:_,locations:v})}parseDirectiveLocations(){return this.delimitedMany(xt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const n=this._lexer.token,o=this.parseName();if(Object.prototype.hasOwnProperty.call(ai,o.value))return o;throw this.unexpected(n)}node(n,o){return this._options.noLocation!==!0&&(o.loc=new dA(n,this._lexer.lastToken,this._lexer.source)),o}peek(n){return this._lexer.token.kind===n}expectToken(n){const o=this._lexer.token;if(o.kind===n)return this.advanceLexer(),o;throw Aa(this._lexer.source,o.start,`Expected ${v2(n)}, found ${M0(o)}.`)}expectOptionalToken(n){return this._lexer.token.kind===n?(this.advanceLexer(),!0):!1}expectKeyword(n){const o=this._lexer.token;if(o.kind===xt.NAME&&o.value===n)this.advanceLexer();else throw Aa(this._lexer.source,o.start,`Expected "${n}", found ${M0(o)}.`)}expectOptionalKeyword(n){const o=this._lexer.token;return o.kind===xt.NAME&&o.value===n?(this.advanceLexer(),!0):!1}unexpected(n){const o=n??this._lexer.token;return Aa(this._lexer.source,o.start,`Unexpected ${M0(o)}.`)}any(n,o,h){this.expectToken(n);const p=[];for(;!this.expectOptionalToken(h);)p.push(o.call(this));return p}optionalMany(n,o,h){if(this.expectOptionalToken(n)){const p=[];do p.push(o.call(this));while(!this.expectOptionalToken(h));return p}return[]}many(n,o,h){this.expectToken(n);const p=[];do p.push(o.call(this));while(!this.expectOptionalToken(h));return p}delimitedMany(n,o){this.expectOptionalToken(n);const h=[];do h.push(o.call(this));while(this.expectOptionalToken(n));return h}advanceLexer(){const{maxTokens:n}=this._options,o=this._lexer.advance();if(o.kind!==xt.EOF&&(++this._tokenCounter,n!==void 0&&this._tokenCounter>n))throw Aa(this._lexer.source,o.start,`Document contains more that ${n} tokens. Parsing aborted.`)}}function M0(i){const n=i.value;return v2(i.kind)+(n!=null?` "${n}"`:"")}function v2(i){return _A(i)?`"${i}"`:i}const jA=5;function BA(i,n){const[o,h]=n?[i,n]:[void 0,i];let p=" Did you mean ";o&&(p+=o+" ");const _=h.map(D=>`"${D}"`);switch(_.length){case 0:return"";case 1:return p+_[0]+"?";case 2:return p+_[0]+" or "+_[1]+"?"}const v=_.slice(0,jA),c=v.pop();return p+v.join(", ")+", or "+c+"?"}function S1(i){return i}function x2(i,n){const o=Object.create(null);for(const h of i)o[n(h)]=h;return o}function Tp(i,n,o){const h=Object.create(null);for(const p of i)h[n(p)]=o(p);return h}function cv(i,n){const o=Object.create(null);for(const h of Object.keys(i))o[h]=n(i[h],h);return o}function FA(i,n){let o=0,h=0;for(;o<i.length&&h<n.length;){let p=i.charCodeAt(o),_=n.charCodeAt(h);if(C0(p)&&C0(_)){let v=0;do++o,v=v*10+p-wx,p=i.charCodeAt(o);while(C0(p)&&v>0);let c=0;do++h,c=c*10+_-wx,_=n.charCodeAt(h);while(C0(_)&&c>0);if(v<c)return-1;if(v>c)return 1}else{if(p<_)return-1;if(p>_)return 1;++o,++h}}return i.length-n.length}const wx=48,UA=57;function C0(i){return!isNaN(i)&&wx<=i&&i<=UA}function VA(i,n){const o=Object.create(null),h=new GA(i),p=Math.floor(i.length*.4)+1;for(const _ of n){const v=h.measure(_,p);v!==void 0&&(o[_]=v)}return Object.keys(o).sort((_,v)=>{const c=o[_]-o[v];return c!==0?c:FA(_,v)})}class GA{constructor(n){this._input=n,this._inputLowerCase=n.toLowerCase(),this._inputArray=E1(this._inputLowerCase),this._rows=[new Array(n.length+1).fill(0),new Array(n.length+1).fill(0),new Array(n.length+1).fill(0)]}measure(n,o){if(this._input===n)return 0;const h=n.toLowerCase();if(this._inputLowerCase===h)return 1;let p=E1(h),_=this._inputArray;if(p.length<_.length){const P=p;p=_,_=P}const v=p.length,c=_.length;if(v-c>o)return;const D=this._rows;for(let P=0;P<=c;P++)D[0][P]=P;for(let P=1;P<=v;P++){const B=D[(P-1)%3],U=D[P%3];let Z=U[0]=P;for(let ne=1;ne<=c;ne++){const ye=p[P-1]===_[ne-1]?0:1;let me=Math.min(B[ne]+1,U[ne-1]+1,B[ne-1]+ye);if(P>1&&ne>1&&p[P-1]===_[ne-2]&&p[P-2]===_[ne-1]){const Pe=D[(P-2)%3][ne-2];me=Math.min(me,Pe+1)}me<Z&&(Z=me),U[ne]=me}if(Z>o)return}const I=D[v%3][c];return I<=o?I:void 0}}function E1(i){const n=i.length,o=new Array(n);for(let h=0;h<n;++h)o[h]=i.charCodeAt(h);return o}function Xl(i){if(i==null)return Object.create(null);if(Object.getPrototypeOf(i)===null)return i;const n=Object.create(null);for(const[o,h]of Object.entries(i))n[o]=h;return n}function ZA(i){return`"${i.replace($A,YA)}"`}const $A=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function YA(i){return qA[i.charCodeAt(0)]}const qA=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],HA=Object.freeze({});function XA(i,n,o=h2){const h=new Map;for(const Pe of Object.values(Nt))h.set(Pe,WA(n,Pe));let p,_=Array.isArray(i),v=[i],c=-1,D=[],I=i,P,B;const U=[],Z=[];do{c++;const Pe=c===v.length,tt=Pe&&D.length!==0;if(Pe){if(P=Z.length===0?void 0:U[U.length-1],I=B,B=Z.pop(),tt)if(_){I=I.slice();let $e=0;for(const[Me,Ve]of D){const ct=Me-$e;Ve===null?(I.splice(ct,1),$e++):I[ct]=Ve}}else{I={...I};for(const[$e,Me]of D)I[$e]=Me}c=p.index,v=p.keys,D=p.edits,_=p.inArray,p=p.prev}else if(B){if(P=_?c:v[c],I=B[P],I==null)continue;U.push(P)}let Je;if(!Array.isArray(I)){var ne,ye;w1(I)||Ti(!1,`Invalid AST Node: ${Sn(I)}.`);const $e=Pe?(ne=h.get(I.kind))===null||ne===void 0?void 0:ne.leave:(ye=h.get(I.kind))===null||ye===void 0?void 0:ye.enter;if(Je=$e==null?void 0:$e.call(n,I,P,B,U,Z),Je===HA)break;if(Je===!1){if(!Pe){U.pop();continue}}else if(Je!==void 0&&(D.push([P,Je]),!Pe))if(w1(Je))I=Je;else{U.pop();continue}}if(Je===void 0&&tt&&D.push([P,I]),Pe)U.pop();else{var me;p={inArray:_,index:c,keys:v,edits:D,prev:p},_=Array.isArray(I),v=_?I:(me=o[I.kind])!==null&&me!==void 0?me:[],c=-1,D=[],B&&Z.push(B),B=I}}while(p!==void 0);return D.length!==0?D[D.length-1][1]:i}function WA(i,n){const o=i[n];return typeof o=="object"?o:typeof o=="function"?{enter:o,leave:void 0}:{enter:i.enter,leave:i.leave}}function rl(i){return XA(i,KA)}const QA=80,KA={Name:{leave:i=>i.value},Variable:{leave:i=>"$"+i.name},Document:{leave:i=>Xt(i.definitions,`

`)},OperationDefinition:{leave(i){const n=Qn("(",Xt(i.variableDefinitions,", "),")"),o=Xt([i.operation,Xt([i.name,n]),Xt(i.directives," ")]," ");return(o==="query"?"":o+" ")+i.selectionSet}},VariableDefinition:{leave:({variable:i,type:n,defaultValue:o,directives:h})=>i+": "+n+Qn(" = ",o)+Qn(" ",Xt(h," "))},SelectionSet:{leave:({selections:i})=>jc(i)},Field:{leave({alias:i,name:n,arguments:o,directives:h,selectionSet:p}){const _=Qn("",i,": ")+n;let v=_+Qn("(",Xt(o,", "),")");return v.length>QA&&(v=_+Qn(`(
`,L0(Xt(o,`
`)),`
)`)),Xt([v,Xt(h," "),p]," ")}},Argument:{leave:({name:i,value:n})=>i+": "+n},FragmentSpread:{leave:({name:i,directives:n})=>"..."+i+Qn(" ",Xt(n," "))},InlineFragment:{leave:({typeCondition:i,directives:n,selectionSet:o})=>Xt(["...",Qn("on ",i),Xt(n," "),o]," ")},FragmentDefinition:{leave:({name:i,typeCondition:n,variableDefinitions:o,directives:h,selectionSet:p})=>`fragment ${i}${Qn("(",Xt(o,", "),")")} on ${n} ${Qn("",Xt(h," ")," ")}`+p},IntValue:{leave:({value:i})=>i},FloatValue:{leave:({value:i})=>i},StringValue:{leave:({value:i,block:n})=>n?gA(i):ZA(i)},BooleanValue:{leave:({value:i})=>i?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:i})=>i},ListValue:{leave:({values:i})=>"["+Xt(i,", ")+"]"},ObjectValue:{leave:({fields:i})=>"{"+Xt(i,", ")+"}"},ObjectField:{leave:({name:i,value:n})=>i+": "+n},Directive:{leave:({name:i,arguments:n})=>"@"+i+Qn("(",Xt(n,", "),")")},NamedType:{leave:({name:i})=>i},ListType:{leave:({type:i})=>"["+i+"]"},NonNullType:{leave:({type:i})=>i+"!"},SchemaDefinition:{leave:({description:i,directives:n,operationTypes:o})=>Qn("",i,`
`)+Xt(["schema",Xt(n," "),jc(o)]," ")},OperationTypeDefinition:{leave:({operation:i,type:n})=>i+": "+n},ScalarTypeDefinition:{leave:({description:i,name:n,directives:o})=>Qn("",i,`
`)+Xt(["scalar",n,Xt(o," ")]," ")},ObjectTypeDefinition:{leave:({description:i,name:n,interfaces:o,directives:h,fields:p})=>Qn("",i,`
`)+Xt(["type",n,Qn("implements ",Xt(o," & ")),Xt(h," "),jc(p)]," ")},FieldDefinition:{leave:({description:i,name:n,arguments:o,type:h,directives:p})=>Qn("",i,`
`)+n+(A1(o)?Qn(`(
`,L0(Xt(o,`
`)),`
)`):Qn("(",Xt(o,", "),")"))+": "+h+Qn(" ",Xt(p," "))},InputValueDefinition:{leave:({description:i,name:n,type:o,defaultValue:h,directives:p})=>Qn("",i,`
`)+Xt([n+": "+o,Qn("= ",h),Xt(p," ")]," ")},InterfaceTypeDefinition:{leave:({description:i,name:n,interfaces:o,directives:h,fields:p})=>Qn("",i,`
`)+Xt(["interface",n,Qn("implements ",Xt(o," & ")),Xt(h," "),jc(p)]," ")},UnionTypeDefinition:{leave:({description:i,name:n,directives:o,types:h})=>Qn("",i,`
`)+Xt(["union",n,Xt(o," "),Qn("= ",Xt(h," | "))]," ")},EnumTypeDefinition:{leave:({description:i,name:n,directives:o,values:h})=>Qn("",i,`
`)+Xt(["enum",n,Xt(o," "),jc(h)]," ")},EnumValueDefinition:{leave:({description:i,name:n,directives:o})=>Qn("",i,`
`)+Xt([n,Xt(o," ")]," ")},InputObjectTypeDefinition:{leave:({description:i,name:n,directives:o,fields:h})=>Qn("",i,`
`)+Xt(["input",n,Xt(o," "),jc(h)]," ")},DirectiveDefinition:{leave:({description:i,name:n,arguments:o,repeatable:h,locations:p})=>Qn("",i,`
`)+"directive @"+n+(A1(o)?Qn(`(
`,L0(Xt(o,`
`)),`
)`):Qn("(",Xt(o,", "),")"))+(h?" repeatable":"")+" on "+Xt(p," | ")},SchemaExtension:{leave:({directives:i,operationTypes:n})=>Xt(["extend schema",Xt(i," "),jc(n)]," ")},ScalarTypeExtension:{leave:({name:i,directives:n})=>Xt(["extend scalar",i,Xt(n," ")]," ")},ObjectTypeExtension:{leave:({name:i,interfaces:n,directives:o,fields:h})=>Xt(["extend type",i,Qn("implements ",Xt(n," & ")),Xt(o," "),jc(h)]," ")},InterfaceTypeExtension:{leave:({name:i,interfaces:n,directives:o,fields:h})=>Xt(["extend interface",i,Qn("implements ",Xt(n," & ")),Xt(o," "),jc(h)]," ")},UnionTypeExtension:{leave:({name:i,directives:n,types:o})=>Xt(["extend union",i,Xt(n," "),Qn("= ",Xt(o," | "))]," ")},EnumTypeExtension:{leave:({name:i,directives:n,values:o})=>Xt(["extend enum",i,Xt(n," "),jc(o)]," ")},InputObjectTypeExtension:{leave:({name:i,directives:n,fields:o})=>Xt(["extend input",i,Xt(n," "),jc(o)]," ")}};function Xt(i,n=""){var o;return(o=i==null?void 0:i.filter(h=>h).join(n))!==null&&o!==void 0?o:""}function jc(i){return Qn(`{
`,L0(Xt(i,`
`)),`
}`)}function Qn(i,n,o=""){return n!=null&&n!==""?i+n+o:""}function L0(i){return Qn("  ",i.replace(/\n/g,`
  `))}function A1(i){var n;return(n=i==null?void 0:i.some(o=>o.includes(`
`)))!==null&&n!==void 0?n:!1}function Tx(i,n){switch(i.kind){case Nt.NULL:return null;case Nt.INT:return parseInt(i.value,10);case Nt.FLOAT:return parseFloat(i.value);case Nt.STRING:case Nt.ENUM:case Nt.BOOLEAN:return i.value;case Nt.LIST:return i.values.map(o=>Tx(o,n));case Nt.OBJECT:return Tp(i.fields,o=>o.name.value,o=>Tx(o.value,n));case Nt.VARIABLE:return n==null?void 0:n[i.name.value]}}function Zc(i){if(i!=null||Ti(!1,"Must provide name."),typeof i=="string"||Ti(!1,"Expected name to be a string."),i.length===0)throw new ki("Expected name to be a non-empty string.");for(let n=1;n<i.length;++n)if(!f2(i.charCodeAt(n)))throw new ki(`Names must only contain [_a-zA-Z0-9] but "${i}" does not.`);if(!lb(i.charCodeAt(0)))throw new ki(`Names must start with [_a-zA-Z] but "${i}" does not.`);return i}function JA(i){if(i==="true"||i==="false"||i==="null")throw new ki(`Enum values cannot be named: ${i}`);return Zc(i)}function b2(i){return dg(i)||rf(i)||Vc(i)||Dp(i)||sf(i)||Gh(i)||hf(i)||Zh(i)}function dg(i){return Zu(i,Fp)}function rf(i){return Zu(i,df)}function eM(i){if(!rf(i))throw new Error(`Expected ${Sn(i)} to be a GraphQL Object type.`);return i}function Vc(i){return Zu(i,z2)}function tM(i){if(!Vc(i))throw new Error(`Expected ${Sn(i)} to be a GraphQL Interface type.`);return i}function Dp(i){return Zu(i,N2)}function sf(i){return Zu(i,uv)}function Gh(i){return Zu(i,P2)}function hf(i){return Zu(i,Bl)}function Zh(i){return Zu(i,Jn)}function w2(i){return dg(i)||sf(i)||Gh(i)||cb(i)&&w2(i.ofType)}function T2(i){return dg(i)||rf(i)||Vc(i)||Dp(i)||sf(i)||cb(i)&&T2(i.ofType)}function S2(i){return dg(i)||sf(i)}function nM(i){return Vc(i)||Dp(i)}class Bl{constructor(n){b2(n)||Ti(!1,`Expected ${Sn(n)} to be a GraphQL type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class Jn{constructor(n){E2(n)||Ti(!1,`Expected ${Sn(n)} to be a GraphQL nullable type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function cb(i){return hf(i)||Zh(i)}function E2(i){return b2(i)&&!Zh(i)}function iM(i){if(!E2(i))throw new Error(`Expected ${Sn(i)} to be a GraphQL nullable type.`);return i}function rM(i){if(i){let n=i;for(;cb(n);)n=n.ofType;return n}}function A2(i){return typeof i=="function"?i():i}function M2(i){return typeof i=="function"?i():i}class Fp{constructor(n){var o,h,p,_;const v=(o=n.parseValue)!==null&&o!==void 0?o:S1;this.name=Zc(n.name),this.description=n.description,this.specifiedByURL=n.specifiedByURL,this.serialize=(h=n.serialize)!==null&&h!==void 0?h:S1,this.parseValue=v,this.parseLiteral=(p=n.parseLiteral)!==null&&p!==void 0?p:(c,D)=>v(Tx(c,D)),this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(_=n.extensionASTNodes)!==null&&_!==void 0?_:[],n.specifiedByURL==null||typeof n.specifiedByURL=="string"||Ti(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${Sn(n.specifiedByURL)}.`),n.serialize==null||typeof n.serialize=="function"||Ti(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),n.parseLiteral&&(typeof n.parseValue=="function"&&typeof n.parseLiteral=="function"||Ti(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class df{constructor(n){var o;this.name=Zc(n.name),this.description=n.description,this.isTypeOf=n.isTypeOf,this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(o=n.extensionASTNodes)!==null&&o!==void 0?o:[],this._fields=()=>D2(n),this._interfaces=()=>C2(n),n.isTypeOf==null||typeof n.isTypeOf=="function"||Ti(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${Sn(n.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:I2(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function C2(i){var n;const o=A2((n=i.interfaces)!==null&&n!==void 0?n:[]);return Array.isArray(o)||Ti(!1,`${i.name} interfaces must be an Array or a function which returns an Array.`),o}function D2(i){const n=M2(i.fields);return Hm(n)||Ti(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),cv(n,(o,h)=>{var p;Hm(o)||Ti(!1,`${i.name}.${h} field config must be an object.`),o.resolve==null||typeof o.resolve=="function"||Ti(!1,`${i.name}.${h} field resolver must be a function if provided, but got: ${Sn(o.resolve)}.`);const _=(p=o.args)!==null&&p!==void 0?p:{};return Hm(_)||Ti(!1,`${i.name}.${h} args must be an object with argument names as keys.`),{name:Zc(h),description:o.description,type:o.type,args:k2(_),resolve:o.resolve,subscribe:o.subscribe,deprecationReason:o.deprecationReason,extensions:Xl(o.extensions),astNode:o.astNode}})}function k2(i){return Object.entries(i).map(([n,o])=>({name:Zc(n),description:o.description,type:o.type,defaultValue:o.defaultValue,deprecationReason:o.deprecationReason,extensions:Xl(o.extensions),astNode:o.astNode}))}function Hm(i){return Qh(i)&&!Array.isArray(i)}function I2(i){return cv(i,n=>({description:n.description,type:n.type,args:R2(n.args),resolve:n.resolve,subscribe:n.subscribe,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function R2(i){return Tp(i,n=>n.name,n=>({description:n.description,type:n.type,defaultValue:n.defaultValue,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}class z2{constructor(n){var o;this.name=Zc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(o=n.extensionASTNodes)!==null&&o!==void 0?o:[],this._fields=D2.bind(void 0,n),this._interfaces=C2.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||Ti(!1,`${this.name} must provide "resolveType" as a function, but got: ${Sn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:I2(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class N2{constructor(n){var o;this.name=Zc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(o=n.extensionASTNodes)!==null&&o!==void 0?o:[],this._types=aM.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||Ti(!1,`${this.name} must provide "resolveType" as a function, but got: ${Sn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function aM(i){const n=A2(i.types);return Array.isArray(n)||Ti(!1,`Must provide Array of types or a function which returns such an array for Union ${i.name}.`),n}class uv{constructor(n){var o;this.name=Zc(n.name),this.description=n.description,this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(o=n.extensionASTNodes)!==null&&o!==void 0?o:[],this._values=typeof n.values=="function"?n.values:M1(this.name,n.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=M1(this.name,this._values())),this._values}getValue(n){return this._nameLookup===null&&(this._nameLookup=x2(this.getValues(),o=>o.name)),this._nameLookup[n]}serialize(n){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(h=>[h.value,h])));const o=this._valueLookup.get(n);if(o===void 0)throw new ki(`Enum "${this.name}" cannot represent value: ${Sn(n)}`);return o.name}parseValue(n){if(typeof n!="string"){const h=Sn(n);throw new ki(`Enum "${this.name}" cannot represent non-string value: ${h}.`+D0(this,h))}const o=this.getValue(n);if(o==null)throw new ki(`Value "${n}" does not exist in "${this.name}" enum.`+D0(this,n));return o.value}parseLiteral(n,o){if(n.kind!==Nt.ENUM){const p=rl(n);throw new ki(`Enum "${this.name}" cannot represent non-enum value: ${p}.`+D0(this,p),{nodes:n})}const h=this.getValue(n.value);if(h==null){const p=rl(n);throw new ki(`Value "${p}" does not exist in "${this.name}" enum.`+D0(this,p),{nodes:n})}return h.value}toConfig(){const n=Tp(this.getValues(),o=>o.name,o=>({description:o.description,value:o.value,deprecationReason:o.deprecationReason,extensions:o.extensions,astNode:o.astNode}));return{name:this.name,description:this.description,values:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function D0(i,n){const o=i.getValues().map(p=>p.name),h=VA(n,o);return BA("the enum value",h)}function M1(i,n){return Hm(n)||Ti(!1,`${i} values must be an object with value names as keys.`),Object.entries(n).map(([o,h])=>(Hm(h)||Ti(!1,`${i}.${o} must refer to an object with a "value" key representing an internal value but got: ${Sn(h)}.`),{name:JA(o),description:h.description,value:h.value!==void 0?h.value:o,deprecationReason:h.deprecationReason,extensions:Xl(h.extensions),astNode:h.astNode}))}class P2{constructor(n){var o,h;this.name=Zc(n.name),this.description=n.description,this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(o=n.extensionASTNodes)!==null&&o!==void 0?o:[],this.isOneOf=(h=n.isOneOf)!==null&&h!==void 0?h:!1,this._fields=sM.bind(void 0,n)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const n=cv(this.getFields(),o=>({description:o.description,type:o.type,defaultValue:o.defaultValue,deprecationReason:o.deprecationReason,extensions:o.extensions,astNode:o.astNode}));return{name:this.name,description:this.description,fields:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function sM(i){const n=M2(i.fields);return Hm(n)||Ti(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),cv(n,(o,h)=>(!("resolve"in o)||Ti(!1,`${i.name}.${h} field has a resolve property, but Input Types cannot define resolvers.`),{name:Zc(h),description:o.description,type:o.type,defaultValue:o.defaultValue,deprecationReason:o.deprecationReason,extensions:Xl(o.extensions),astNode:o.astNode}))}const Kv=2147483647,Jv=-2147483648,oM=new Fp({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(i){const n=w_(i);if(typeof n=="boolean")return n?1:0;let o=n;if(typeof n=="string"&&n!==""&&(o=Number(n)),typeof o!="number"||!Number.isInteger(o))throw new ki(`Int cannot represent non-integer value: ${Sn(n)}`);if(o>Kv||o<Jv)throw new ki("Int cannot represent non 32-bit signed integer value: "+Sn(n));return o},parseValue(i){if(typeof i!="number"||!Number.isInteger(i))throw new ki(`Int cannot represent non-integer value: ${Sn(i)}`);if(i>Kv||i<Jv)throw new ki(`Int cannot represent non 32-bit signed integer value: ${i}`);return i},parseLiteral(i){if(i.kind!==Nt.INT)throw new ki(`Int cannot represent non-integer value: ${rl(i)}`,{nodes:i});const n=parseInt(i.value,10);if(n>Kv||n<Jv)throw new ki(`Int cannot represent non 32-bit signed integer value: ${i.value}`,{nodes:i});return n}}),lM=new Fp({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(i){const n=w_(i);if(typeof n=="boolean")return n?1:0;let o=n;if(typeof n=="string"&&n!==""&&(o=Number(n)),typeof o!="number"||!Number.isFinite(o))throw new ki(`Float cannot represent non numeric value: ${Sn(n)}`);return o},parseValue(i){if(typeof i!="number"||!Number.isFinite(i))throw new ki(`Float cannot represent non numeric value: ${Sn(i)}`);return i},parseLiteral(i){if(i.kind!==Nt.FLOAT&&i.kind!==Nt.INT)throw new ki(`Float cannot represent non numeric value: ${rl(i)}`,i);return parseFloat(i.value)}}),$r=new Fp({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(i){const n=w_(i);if(typeof n=="string")return n;if(typeof n=="boolean")return n?"true":"false";if(typeof n=="number"&&Number.isFinite(n))return n.toString();throw new ki(`String cannot represent value: ${Sn(i)}`)},parseValue(i){if(typeof i!="string")throw new ki(`String cannot represent a non string value: ${Sn(i)}`);return i},parseLiteral(i){if(i.kind!==Nt.STRING)throw new ki(`String cannot represent a non string value: ${rl(i)}`,{nodes:i});return i.value}}),tl=new Fp({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(i){const n=w_(i);if(typeof n=="boolean")return n;if(Number.isFinite(n))return n!==0;throw new ki(`Boolean cannot represent a non boolean value: ${Sn(n)}`)},parseValue(i){if(typeof i!="boolean")throw new ki(`Boolean cannot represent a non boolean value: ${Sn(i)}`);return i},parseLiteral(i){if(i.kind!==Nt.BOOLEAN)throw new ki(`Boolean cannot represent a non boolean value: ${rl(i)}`,{nodes:i});return i.value}}),L2=new Fp({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(i){const n=w_(i);if(typeof n=="string")return n;if(Number.isInteger(n))return String(n);throw new ki(`ID cannot represent value: ${Sn(i)}`)},parseValue(i){if(typeof i=="string")return i;if(typeof i=="number"&&Number.isInteger(i))return i.toString();throw new ki(`ID cannot represent value: ${Sn(i)}`)},parseLiteral(i){if(i.kind!==Nt.STRING&&i.kind!==Nt.INT)throw new ki("ID cannot represent a non-string and non-integer value: "+rl(i),{nodes:i});return i.value}}),cM=Object.freeze([$r,oM,lM,tl,L2]);function w_(i){if(Qh(i)){if(typeof i.valueOf=="function"){const n=i.valueOf();if(!Qh(n))return n}if(typeof i.toJSON=="function")return i.toJSON()}return i}function uM(i){return Zu(i,Up)}class Up{constructor(n){var o,h;this.name=Zc(n.name),this.description=n.description,this.locations=n.locations,this.isRepeatable=(o=n.isRepeatable)!==null&&o!==void 0?o:!1,this.extensions=Xl(n.extensions),this.astNode=n.astNode,Array.isArray(n.locations)||Ti(!1,`@${n.name} locations must be an Array.`);const p=(h=n.args)!==null&&h!==void 0?h:{};Qh(p)&&!Array.isArray(p)||Ti(!1,`@${n.name} args must be an object with argument names as keys.`),this.args=k2(p)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:R2(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const hM=new Up({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[ai.FIELD,ai.FRAGMENT_SPREAD,ai.INLINE_FRAGMENT],args:{if:{type:new Jn(tl),description:"Included when true."}}}),dM=new Up({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[ai.FIELD,ai.FRAGMENT_SPREAD,ai.INLINE_FRAGMENT],args:{if:{type:new Jn(tl),description:"Skipped when true."}}}),fM="No longer supported",pM=new Up({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[ai.FIELD_DEFINITION,ai.ARGUMENT_DEFINITION,ai.INPUT_FIELD_DEFINITION,ai.ENUM_VALUE],args:{reason:{type:$r,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:fM}}}),mM=new Up({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[ai.SCALAR],args:{url:{type:new Jn($r),description:"The URL that specifies the behavior of this scalar."}}}),gM=new Up({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[ai.INPUT_OBJECT],args:{}}),yM=Object.freeze([hM,dM,pM,mM,gM]);function _M(i){return typeof i=="object"&&typeof(i==null?void 0:i[Symbol.iterator])=="function"}function Fy(i,n){if(Zh(n)){const o=Fy(i,n.ofType);return(o==null?void 0:o.kind)===Nt.NULL?null:o}if(i===null)return{kind:Nt.NULL};if(i===void 0)return null;if(hf(n)){const o=n.ofType;if(_M(i)){const h=[];for(const p of i){const _=Fy(p,o);_!=null&&h.push(_)}return{kind:Nt.LIST,values:h}}return Fy(i,o)}if(Gh(n)){if(!Qh(i))return null;const o=[];for(const h of Object.values(n.getFields())){const p=Fy(i[h.name],h.type);p&&o.push({kind:Nt.OBJECT_FIELD,name:{kind:Nt.NAME,value:h.name},value:p})}return{kind:Nt.OBJECT,fields:o}}if(S2(n)){const o=n.serialize(i);if(o==null)return null;if(typeof o=="boolean")return{kind:Nt.BOOLEAN,value:o};if(typeof o=="number"&&Number.isFinite(o)){const h=String(o);return C1.test(h)?{kind:Nt.INT,value:h}:{kind:Nt.FLOAT,value:h}}if(typeof o=="string")return sf(n)?{kind:Nt.ENUM,value:o}:n===L2&&C1.test(o)?{kind:Nt.INT,value:o}:{kind:Nt.STRING,value:o};throw new TypeError(`Cannot convert value to AST: ${Sn(o)}.`)}sv(!1,"Unexpected input type: "+Sn(n))}const C1=/^-?(?:0|[1-9][0-9]*)$/,ub=new df({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:$r,resolve:i=>i.description},types:{description:"A list of all types supported by this server.",type:new Jn(new Bl(new Jn(Nu))),resolve(i){return Object.values(i.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new Jn(Nu),resolve:i=>i.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:Nu,resolve:i=>i.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:Nu,resolve:i=>i.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new Jn(new Bl(new Jn(O2))),resolve:i=>i.getDirectives()}})}),O2=new df({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new Jn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},isRepeatable:{type:new Jn(tl),resolve:i=>i.isRepeatable},locations:{type:new Jn(new Bl(new Jn(j2))),resolve:i=>i.locations},args:{type:new Jn(new Bl(new Jn(hv))),args:{includeDeprecated:{type:tl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(o=>o.deprecationReason==null)}}})}),j2=new uv({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:ai.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:ai.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:ai.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:ai.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:ai.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:ai.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:ai.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:ai.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:ai.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:ai.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:ai.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:ai.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:ai.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:ai.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:ai.UNION,description:"Location adjacent to a union definition."},ENUM:{value:ai.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:ai.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:ai.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:ai.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),Nu=new df({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new Jn(U2),resolve(i){if(dg(i))return qi.SCALAR;if(rf(i))return qi.OBJECT;if(Vc(i))return qi.INTERFACE;if(Dp(i))return qi.UNION;if(sf(i))return qi.ENUM;if(Gh(i))return qi.INPUT_OBJECT;if(hf(i))return qi.LIST;if(Zh(i))return qi.NON_NULL;sv(!1,`Unexpected type: "${Sn(i)}".`)}},name:{type:$r,resolve:i=>"name"in i?i.name:void 0},description:{type:$r,resolve:i=>"description"in i?i.description:void 0},specifiedByURL:{type:$r,resolve:i=>"specifiedByURL"in i?i.specifiedByURL:void 0},fields:{type:new Bl(new Jn(B2)),args:{includeDeprecated:{type:tl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(rf(i)||Vc(i)){const o=Object.values(i.getFields());return n?o:o.filter(h=>h.deprecationReason==null)}}},interfaces:{type:new Bl(new Jn(Nu)),resolve(i){if(rf(i)||Vc(i))return i.getInterfaces()}},possibleTypes:{type:new Bl(new Jn(Nu)),resolve(i,n,o,{schema:h}){if(nM(i))return h.getPossibleTypes(i)}},enumValues:{type:new Bl(new Jn(F2)),args:{includeDeprecated:{type:tl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(sf(i)){const o=i.getValues();return n?o:o.filter(h=>h.deprecationReason==null)}}},inputFields:{type:new Bl(new Jn(hv)),args:{includeDeprecated:{type:tl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(Gh(i)){const o=Object.values(i.getFields());return n?o:o.filter(h=>h.deprecationReason==null)}}},ofType:{type:Nu,resolve:i=>"ofType"in i?i.ofType:void 0},isOneOf:{type:tl,resolve:i=>{if(Gh(i))return i.isOneOf}}})}),B2=new df({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new Jn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},args:{type:new Jn(new Bl(new Jn(hv))),args:{includeDeprecated:{type:tl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(o=>o.deprecationReason==null)}},type:{type:new Jn(Nu),resolve:i=>i.type},isDeprecated:{type:new Jn(tl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:$r,resolve:i=>i.deprecationReason}})}),hv=new df({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new Jn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},type:{type:new Jn(Nu),resolve:i=>i.type},defaultValue:{type:$r,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(i){const{type:n,defaultValue:o}=i,h=Fy(o,n);return h?rl(h):null}},isDeprecated:{type:new Jn(tl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:$r,resolve:i=>i.deprecationReason}})}),F2=new df({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new Jn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},isDeprecated:{type:new Jn(tl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:$r,resolve:i=>i.deprecationReason}})});var qi;(function(i){i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.INPUT_OBJECT="INPUT_OBJECT",i.LIST="LIST",i.NON_NULL="NON_NULL"})(qi||(qi={}));const U2=new uv({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:qi.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:qi.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:qi.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:qi.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:qi.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:qi.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:qi.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:qi.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new Jn(ub);new Jn($r);new Jn($r);const vM=Object.freeze([ub,O2,j2,Nu,B2,hv,F2,U2]);class xM{constructor(n){var o,h;this.__validationErrors=n.assumeValid===!0?[]:void 0,Qh(n)||Ti(!1,"Must provide configuration object."),!n.types||Array.isArray(n.types)||Ti(!1,`"types" must be Array if provided but got: ${Sn(n.types)}.`),!n.directives||Array.isArray(n.directives)||Ti(!1,`"directives" must be Array if provided but got: ${Sn(n.directives)}.`),this.description=n.description,this.extensions=Xl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(o=n.extensionASTNodes)!==null&&o!==void 0?o:[],this._queryType=n.query,this._mutationType=n.mutation,this._subscriptionType=n.subscription,this._directives=(h=n.directives)!==null&&h!==void 0?h:yM;const p=new Set(n.types);if(n.types!=null)for(const _ of n.types)p.delete(_),Fc(_,p);this._queryType!=null&&Fc(this._queryType,p),this._mutationType!=null&&Fc(this._mutationType,p),this._subscriptionType!=null&&Fc(this._subscriptionType,p);for(const _ of this._directives)if(uM(_))for(const v of _.args)Fc(v.type,p);Fc(ub,p),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const _ of p){if(_==null)continue;const v=_.name;if(v||Ti(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[v]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${v}".`);if(this._typeMap[v]=_,Vc(_)){for(const c of _.getInterfaces())if(Vc(c)){let D=this._implementationsMap[c.name];D===void 0&&(D=this._implementationsMap[c.name]={objects:[],interfaces:[]}),D.interfaces.push(_)}}else if(rf(_)){for(const c of _.getInterfaces())if(Vc(c)){let D=this._implementationsMap[c.name];D===void 0&&(D=this._implementationsMap[c.name]={objects:[],interfaces:[]}),D.objects.push(_)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(n){switch(n){case Bh.QUERY:return this.getQueryType();case Bh.MUTATION:return this.getMutationType();case Bh.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(n){return this.getTypeMap()[n]}getPossibleTypes(n){return Dp(n)?n.getTypes():this.getImplementations(n).objects}getImplementations(n){const o=this._implementationsMap[n.name];return o??{objects:[],interfaces:[]}}isSubType(n,o){let h=this._subTypeMap[n.name];if(h===void 0){if(h=Object.create(null),Dp(n))for(const p of n.getTypes())h[p.name]=!0;else{const p=this.getImplementations(n);for(const _ of p.objects)h[_.name]=!0;for(const _ of p.interfaces)h[_.name]=!0}this._subTypeMap[n.name]=h}return h[o.name]!==void 0}getDirectives(){return this._directives}getDirective(n){return this.getDirectives().find(o=>o.name===n)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function Fc(i,n){const o=rM(i);if(!n.has(o)){if(n.add(o),Dp(o))for(const h of o.getTypes())Fc(h,n);else if(rf(o)||Vc(o)){for(const h of o.getInterfaces())Fc(h,n);for(const h of Object.values(o.getFields())){Fc(h.type,n);for(const p of h.args)Fc(p.type,n)}}else if(Gh(o))for(const h of Object.values(o.getFields()))Fc(h.type,n)}return n}function Uy(i,n,o){if(i){if(i.kind===Nt.VARIABLE){i.name.value;return}if(Zh(n))return i.kind===Nt.NULL?void 0:Uy(i,n.ofType,o);if(i.kind===Nt.NULL)return null;if(hf(n)){const h=n.ofType;if(i.kind===Nt.LIST){const _=[];for(const v of i.values)if(D1(v,o)){if(Zh(h))return;_.push(null)}else{const c=Uy(v,h,o);if(c===void 0)return;_.push(c)}return _}const p=Uy(i,h,o);return p===void 0?void 0:[p]}if(Gh(n)){if(i.kind!==Nt.OBJECT)return;const h=Object.create(null),p=x2(i.fields,_=>_.name.value);for(const _ of Object.values(n.getFields())){const v=p[_.name];if(!v||D1(v.value,o)){if(_.defaultValue!==void 0)h[_.name]=_.defaultValue;else if(Zh(_.type))return;continue}const c=Uy(v.value,_.type,o);if(c===void 0)return;h[_.name]=c}if(n.isOneOf){const _=Object.keys(h);if(_.length!==1||h[_[0]]===null)return}return h}if(S2(n)){let h;try{h=n.parseLiteral(i,o)}catch{return}return h===void 0?void 0:h}sv(!1,"Unexpected input type: "+Sn(n))}}function D1(i,n){return i.kind===Nt.VARIABLE&&n==null}function bM(i){const n={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...i},o=n.descriptions?"description":"",h=n.specifiedByUrl?"specifiedByURL":"",p=n.directiveIsRepeatable?"isRepeatable":"",_=n.schemaDescription?o:"";function v(D){return n.inputValueDeprecation?D:""}const c=n.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${_}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${o}
          ${p}
          locations
          args${v("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${o}
      ${h}
      ${c}
      fields(includeDeprecated: true) {
        name
        ${o}
        args${v("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${v("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${o}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${o}
      type { ...TypeRef }
      defaultValue
      ${v("isDeprecated")}
      ${v("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function wM(i,n){Qh(i)&&Qh(i.__schema)||Ti(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${Sn(i)}.`);const o=i.__schema,h=Tp(o.types,Re=>Re.name,Re=>U(Re));for(const Re of[...cM,...vM])h[Re.name]&&(h[Re.name]=Re);const p=o.queryType?P(o.queryType):null,_=o.mutationType?P(o.mutationType):null,v=o.subscriptionType?P(o.subscriptionType):null,c=o.directives?o.directives.map(ot):[];return new xM({description:o.description,query:p,mutation:_,subscription:v,types:Object.values(h),directives:c,assumeValid:void 0});function D(Re){if(Re.kind===qi.LIST){const mt=Re.ofType;if(!mt)throw new Error("Decorated type deeper than introspection query.");return new Bl(D(mt))}if(Re.kind===qi.NON_NULL){const mt=Re.ofType;if(!mt)throw new Error("Decorated type deeper than introspection query.");const It=D(mt);return new Jn(iM(It))}return I(Re)}function I(Re){const mt=Re.name;if(!mt)throw new Error(`Unknown type reference: ${Sn(Re)}.`);const It=h[mt];if(!It)throw new Error(`Invalid or incomplete schema, unknown type: ${mt}. Ensure that a full introspection query is used in order to build a client schema.`);return It}function P(Re){return eM(I(Re))}function B(Re){return tM(I(Re))}function U(Re){if(Re!=null&&Re.name!=null&&Re.kind!=null)switch(Re.kind){case qi.SCALAR:return Z(Re);case qi.OBJECT:return ye(Re);case qi.INTERFACE:return me(Re);case qi.UNION:return Pe(Re);case qi.ENUM:return tt(Re);case qi.INPUT_OBJECT:return Je(Re)}const mt=Sn(Re);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${mt}.`)}function Z(Re){return new Fp({name:Re.name,description:Re.description,specifiedByURL:Re.specifiedByURL})}function ne(Re){if(Re.interfaces===null&&Re.kind===qi.INTERFACE)return[];if(!Re.interfaces){const mt=Sn(Re);throw new Error(`Introspection result missing interfaces: ${mt}.`)}return Re.interfaces.map(B)}function ye(Re){return new df({name:Re.name,description:Re.description,interfaces:()=>ne(Re),fields:()=>$e(Re)})}function me(Re){return new z2({name:Re.name,description:Re.description,interfaces:()=>ne(Re),fields:()=>$e(Re)})}function Pe(Re){if(!Re.possibleTypes){const mt=Sn(Re);throw new Error(`Introspection result missing possibleTypes: ${mt}.`)}return new N2({name:Re.name,description:Re.description,types:()=>Re.possibleTypes.map(P)})}function tt(Re){if(!Re.enumValues){const mt=Sn(Re);throw new Error(`Introspection result missing enumValues: ${mt}.`)}return new uv({name:Re.name,description:Re.description,values:Tp(Re.enumValues,mt=>mt.name,mt=>({description:mt.description,deprecationReason:mt.deprecationReason}))})}function Je(Re){if(!Re.inputFields){const mt=Sn(Re);throw new Error(`Introspection result missing inputFields: ${mt}.`)}return new P2({name:Re.name,description:Re.description,fields:()=>Ve(Re.inputFields),isOneOf:Re.isOneOf})}function $e(Re){if(!Re.fields)throw new Error(`Introspection result missing fields: ${Sn(Re)}.`);return Tp(Re.fields,mt=>mt.name,Me)}function Me(Re){const mt=D(Re.type);if(!T2(mt)){const It=Sn(mt);throw new Error(`Introspection must provide output type for fields, but received: ${It}.`)}if(!Re.args){const It=Sn(Re);throw new Error(`Introspection result missing field args: ${It}.`)}return{description:Re.description,deprecationReason:Re.deprecationReason,type:mt,args:Ve(Re.args)}}function Ve(Re){return Tp(Re,mt=>mt.name,ct)}function ct(Re){const mt=D(Re.type);if(!w2(mt)){const Lt=Sn(mt);throw new Error(`Introspection must provide input type for arguments, but received: ${Lt}.`)}const It=Re.defaultValue!=null?Uy(OA(Re.defaultValue),mt):void 0;return{description:Re.description,type:mt,defaultValue:It,deprecationReason:Re.deprecationReason}}function ot(Re){if(!Re.args){const mt=Sn(Re);throw new Error(`Introspection result missing directive args: ${mt}.`)}if(!Re.locations){const mt=Sn(Re);throw new Error(`Introspection result missing directive locations: ${mt}.`)}return new Up({name:Re.name,description:Re.description,isRepeatable:Re.isRepeatable,locations:Re.locations.slice(),args:Ve(Re.args)})}}const k1="Accept",Sx="Content-Type",Ex="application/json",V2="application/graphql-response+json",I1=i=>i.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),TM=i=>{const n=i.toLowerCase();return n.includes(V2)||n.includes(Ex)},R1=i=>{try{if(Array.isArray(i))return{_tag:"Batch",executionResults:i.map(z1)};if(P0(i))return{_tag:"Single",executionResult:z1(i)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(i)}`)}catch(n){return n}},z1=i=>{if(typeof i!="object"||i===null)throw new Error("Invalid execution result: result is not object");let n,o,h;if("errors"in i){if(!P0(i.errors)&&!Array.isArray(i.errors))throw new Error("Invalid execution result: errors is not plain object OR array");n=i.errors}if("data"in i){if(!P0(i.data)&&i.data!==null)throw new Error("Invalid execution result: data is not plain object");o=i.data}if("extensions"in i){if(!P0(i.extensions))throw new Error("Invalid execution result: extensions is not plain object");h=i.extensions}return{data:o,errors:n,extensions:h}},SM=i=>i._tag==="Batch"?i.executionResults.some(N1):N1(i.executionResult),N1=i=>Array.isArray(i.errors)?i.errors.length>0:!!i.errors,G2=i=>typeof i=="object"&&i!==null&&"kind"in i&&i.kind===Nt.OPERATION_DEFINITION,EM=i=>{var h;let n;const o=i.definitions.filter(G2);return o.length===1&&(n=(h=o[0].name)==null?void 0:h.value),n},AM=i=>{let n=!1;const o=i.definitions.filter(G2);return o.length===1&&(n=o[0].operation==="mutation"),n},ex=(i,n)=>{const o=typeof i=="string"?i:rl(i);let h=!1,p;if(n)return{expression:o,isMutation:h,operationName:p};const _=aA(()=>typeof i=="string"?LA(i):i);return _ instanceof Error?{expression:o,isMutation:h,operationName:p}:(p=EM(_),h=AM(_),{expression:o,operationName:p,isMutation:h})},hb=JSON,tx=async i=>{const n={...i,method:i.request._tag==="Single"?i.request.document.isMutation?"POST":_1(i.method??"post"):i.request.hasMutations?"POST":_1(i.method??"post"),fetchOptions:{...i.fetchOptions,errorPolicy:i.fetchOptions.errorPolicy??"none"}},h=await CM(n.method)(n);if(!h.ok)return new qm({status:h.status,headers:h.headers},{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables});const p=await MM(h,i.fetchOptions.jsonSerializer??hb);if(p instanceof Error)throw p;const _={status:h.status,headers:h.headers};if(SM(p)&&n.fetchOptions.errorPolicy==="none"){const v=p._tag==="Batch"?{...p.executionResults,..._}:{...p.executionResult,..._};return new qm(v,{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables})}switch(p._tag){case"Single":return{..._,...P1(n)(p.executionResult)};case"Batch":return{..._,data:p.executionResults.map(P1(n))};default:ob(p)}},P1=i=>n=>({extensions:n.extensions,data:n.data,errors:i.fetchOptions.errorPolicy==="all"?n.errors:void 0}),MM=async(i,n)=>{const o=i.headers.get(Sx),h=await i.text();return o&&TM(o)?R1(n.parse(h)):R1(h)},CM=i=>async n=>{const o=new Headers(n.headers);let h=null,p;o.has(k1)||o.set(k1,[V2,Ex].join(", ")),i==="POST"?(p=(n.fetchOptions.jsonSerializer??hb).stringify(DM(n)),typeof p=="string"&&!o.has(Sx)&&o.set(Sx,Ex)):h=kM(n);const _={method:i,headers:o,body:p,...n.fetchOptions};let v=new URL(n.url),c=_;if(n.middleware){const I=await Promise.resolve(n.middleware({..._,url:n.url,operationName:n.request._tag==="Single"?n.request.document.operationName:void 0,variables:n.request.variables})),{url:P,...B}=I;v=new URL(P),c=B}return h&&h.forEach((I,P)=>{v.searchParams.append(P,I)}),await(n.fetch??fetch)(v,c)},DM=i=>{switch(i.request._tag){case"Single":return{query:i.request.document.expression,variables:i.request.variables,operationName:i.request.document.operationName};case"Batch":return l2(i.request.query,i.request.variables??[]).map(([n,o])=>({query:n,variables:o}));default:throw ob(i.request)}},kM=i=>{var h;const n=i.fetchOptions.jsonSerializer??hb,o=new URLSearchParams;switch(i.request._tag){case"Single":return o.append("query",I1(i.request.document.expression)),i.request.variables&&o.append("variables",n.stringify(i.request.variables)),i.request.document.operationName&&o.append("operationName",i.request.document.operationName),o;case"Batch":{const p=((h=i.request.variables)==null?void 0:h.map(c=>n.stringify(c)))??[],_=i.request.query.map(I1),v=l2(_,p).map(([c,D])=>({query:c,variables:D}));return o.append("query",n.stringify(v)),o}default:throw ob(i.request)}};class IM{constructor(n,o={}){vp(this,"url");vp(this,"requestConfig");vp(this,"rawRequest",async(...n)=>{const[o,h,p]=n,_=lA(o,h,p),{headers:v,fetch:c=globalThis.fetch,method:D="POST",requestMiddleware:I,responseMiddleware:P,excludeOperationName:B,...U}=this.requestConfig,{url:Z}=this;_.signal!==void 0&&(U.signal=_.signal);const ne=ex(_.query,B),ye=await tx({url:Z,request:{_tag:"Single",document:ne,variables:_.variables},headers:{...Lm(Wv(v)),...Lm(_.requestHeaders)},fetch:c,method:D,fetchOptions:U,middleware:I});if(P&&await P(ye,{operationName:ne.operationName,variables:h,url:this.url}),ye instanceof Error)throw ye;return ye});this.url=n,this.requestConfig=o}async request(n,...o){const[h,p]=o,_=RM(n,h,p),{headers:v,fetch:c=globalThis.fetch,method:D="POST",requestMiddleware:I,responseMiddleware:P,excludeOperationName:B,...U}=this.requestConfig,{url:Z}=this;_.signal!==void 0&&(U.signal=_.signal);const ne=ex(_.document,B),ye=await tx({url:Z,request:{_tag:"Single",document:ne,variables:_.variables},headers:{...Lm(Wv(v)),...Lm(_.requestHeaders)},fetch:c,method:D,fetchOptions:U,middleware:I});if(P&&await P(ye,{operationName:ne.operationName,variables:_.variables,url:this.url}),ye instanceof Error)throw ye;return ye.data}async batchRequests(n,o){const h=oA(n,o),{headers:p,excludeOperationName:_,...v}=this.requestConfig;h.signal!==void 0&&(v.signal=h.signal);const c=h.documents.map(({document:U})=>ex(U,_)),D=c.map(({expression:U})=>U),I=c.some(({isMutation:U})=>U),P=h.documents.map(({variables:U})=>U),B=await tx({url:this.url,request:{_tag:"Batch",operationName:void 0,query:D,hasMutations:I,variables:P},headers:{...Lm(Wv(p)),...Lm(h.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:v,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(B,{operationName:void 0,variables:P,url:this.url}),B instanceof Error)throw B;return B.data}setHeaders(n){return this.requestConfig.headers=n,this}setHeader(n,o){const{headers:h}=this.requestConfig;return h?h[n]=o:this.requestConfig.headers={[n]:o},this}setEndpoint(n){return this.url=n,this}}async function V0(i,n,...o){const h=zM(i,n,...o);return new IM(h.url).request({...h})}const RM=(i,n,o)=>i.document?i:{document:i,variables:n,requestHeaders:o,signal:void 0},zM=(i,n,...o)=>{const[h,p]=o;return typeof i=="string"?{url:i,document:n,variables:h,requestHeaders:p,signal:void 0}:i},nx="/otp/transmodel/v3",l_=()=>{try{return new URL(nx),nx}catch{return`${window.location.origin}${nx}`}};var Z2=(i=>(i.LimitToNumOfItineraries="limitToNumOfItineraries",i.LimitToSearchWindow="limitToSearchWindow",i.ListAll="listAll",i.Off="off",i))(Z2||{}),Di=(i=>(i.Air="air",i.Bicycle="bicycle",i.Bus="bus",i.Cableway="cableway",i.Car="car",i.Coach="coach",i.Foot="foot",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Scooter="scooter",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Water="water",i))(Di||{}),dv=(i=>(i.Bicycle="bicycle",i.BikePark="bike_park",i.BikeRental="bike_rental",i.Car="car",i.CarPark="car_park",i.CarPickup="car_pickup",i.CarRental="car_rental",i.Flexible="flexible",i.Foot="foot",i.ScooterRental="scooter_rental",i))(dv||{}),$2=(i=>(i.Air="air",i.Bus="bus",i.Cableway="cableway",i.Coach="coach",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Unknown="unknown",i.Water="water",i))($2||{});const NM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},PM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},LM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},OM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},jM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},BM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},FM={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":NM,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":PM,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":LM,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":OM,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":jM,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        generalizedCost\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            generalizedCost\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":BM};function fg(i){return FM[i]??{}}const UM=fg(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),VM=i=>{const[n,o]=he.useState(null);return he.useEffect(()=>{(async()=>{if(i.place){const p={id:i.place};try{o(await V0(l_(),UM,p))}catch(_){console.error("Error at useQuayCoordinateQuery",_)}}else o(null)})()},[i]),n==null?void 0:n.quay};function L1(i){const n=VM(i);if(n){const{latitude:o,longitude:h}=n;if(o&&h)return{latitude:o,longitude:h}}if(i.coordinates)return{...i.coordinates}}function GM({setCursor:i,tripQueryVariables:n,setTripQueryVariables:o,loading:h}){const p=L1(n.from),_=L1(n.to);return ae.jsxs(ae.Fragment,{children:[p&&ae.jsx(m1,{draggable:!0,latitude:p.latitude,longitude:p.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),h||o({...n,from:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:ae.jsx("img",{alt:"",src:nA,height:48,width:49})}),_&&ae.jsx(m1,{draggable:!0,latitude:_.latitude,longitude:_.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),h||o({...n,to:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:ae.jsx("img",{alt:"",src:iA,height:48,width:49})})]})}var ZM=function(i,n){for(var o=Math.pow(10,n),h=i.length,p=new Array(Math.floor(i.length/2)),_=0,v=0,c=0,D=0;_<h;++D){var I=1,P=0,B=void 0;do B=i.charCodeAt(_++)-63-1,I+=B<<P,P+=5;while(B>=31);v+=I&1?~(I>>1):I>>1,I=1,P=0;do B=i.charCodeAt(_++)-63-1,I+=B<<P,P+=5;while(B>=31);c+=I&1?~(I>>1):I>>1,p[D]=[v/o,c/o]}return p.length=D,p};const $M=function(i){return i===Di.Foot?"#191616":i===Di.Bicycle?"#5076D9":i===Di.Scooter?"#253664":i===Di.Car?"#7e7e7e":i===Di.Rail?"#86BF8B":i===Di.Coach?"#25642A":i===Di.Metro?"#D9B250":i===Di.Bus?"#fe0000":i===Di.Tram?"#D9B250":i===Di.Trolleybus?"#25642A":i===Di.Water||i===Di.Air||i===Di.Cableway||i===Di.Funicular||i===Di.Monorail||i===Di.Taxi?"#81304C":"#aaa"},Y2=function(i){var n,o;return(o=(n=i.line)==null?void 0:n.presentation)!=null&&o.colour?`#${i.line.presentation.colour}`:$M(i.mode)};function YM({tripPattern:i}){return ae.jsx(ae.Fragment,{children:i==null?void 0:i.legs.map((n,o)=>n.pointsOnLink&&ae.jsxs(WE,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:ZM(n.pointsOnLink.points,5).map(h=>h.reverse())}},children:[ae.jsx(g1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),ae.jsx(g1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":Y2(n),"line-width":4}})]},n.id||`footleg_${o}`))})}const q2=(i,n,o)=>({...i,[o]:{coordinates:{latitude:n.lat,longitude:n.lng}}}),qM=(i,n)=>q2(i,n,"from"),HM=(i,n)=>q2(i,n,"to");function XM({tripQueryVariables:i,setTripQueryVariables:n}){return he.useCallback(o=>{o.preventDefault(),i.from.coordinates?n(HM(i,o.lngLat)):n(qM(i,o.lngLat))},[i,n])}var ix={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var O1;function WM(){return O1||(O1=1,function(i){(function(){var n={}.hasOwnProperty;function o(){for(var _="",v=0;v<arguments.length;v++){var c=arguments[v];c&&(_=p(_,h(c)))}return _}function h(_){if(typeof _=="string"||typeof _=="number")return _;if(typeof _!="object")return"";if(Array.isArray(_))return o.apply(null,_);if(_.toString!==Object.prototype.toString&&!_.toString.toString().includes("[native code]"))return _.toString();var v="";for(var c in _)n.call(_,c)&&_[c]&&(v=p(v,c));return v}function p(_,v){return v?_?_+" "+v:_+v:_}i.exports?(o.default=o,i.exports=o):window.classNames=o})()}(ix)),ix.exports}var QM=WM();const kn=jp(QM);function Ax(){return Ax=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var h in o)({}).hasOwnProperty.call(o,h)&&(i[h]=o[h])}return i},Ax.apply(null,arguments)}function H2(i,n){if(i==null)return{};var o={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.includes(h))continue;o[h]=i[h]}return o}function j1(i){return"default"+i.charAt(0).toUpperCase()+i.substr(1)}function KM(i){var n=JM(i,"string");return typeof n=="symbol"?n:String(n)}function JM(i,n){if(typeof i!="object"||i===null)return i;var o=i[Symbol.toPrimitive];if(o!==void 0){var h=o.call(i,n);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function eC(i,n,o){var h=he.useRef(i!==void 0),p=he.useState(n),_=p[0],v=p[1],c=i!==void 0,D=h.current;return h.current=c,!c&&D&&_!==n&&v(n),[c?i:_,he.useCallback(function(I){for(var P=arguments.length,B=new Array(P>1?P-1:0),U=1;U<P;U++)B[U-1]=arguments[U];o&&o.apply(void 0,[I].concat(B)),v(I)},[o])]}function X2(i,n){return Object.keys(n).reduce(function(o,h){var p,_=o,v=_[j1(h)],c=_[h],D=H2(_,[j1(h),h].map(KM)),I=n[h],P=eC(c,v,i[I]),B=P[0],U=P[1];return Ax({},D,(p={},p[h]=B,p[I]=U,p))},i)}function Mx(i,n){return Mx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},Mx(i,n)}function tC(i,n){i.prototype=Object.create(n.prototype),i.prototype.constructor=i,Mx(i,n)}const nC=["xxl","xl","lg","md","sm","xs"],iC="xs",T_=he.createContext({prefixes:{},breakpoints:nC,minBreakpoint:iC}),{Consumer:iz,Provider:rz}=T_;function Yn(i,n){const{prefixes:o}=he.useContext(T_);return i||o[n]||n}function rC(){const{breakpoints:i}=he.useContext(T_);return i}function aC(){const{minBreakpoint:i}=he.useContext(T_);return i}function W2(){const{dir:i}=he.useContext(T_);return i==="rtl"}function S_(i){return i&&i.ownerDocument||document}function sC(i){var n=S_(i);return n&&n.defaultView||window}function oC(i,n){return sC(i).getComputedStyle(i,n)}var lC=/([A-Z])/g;function cC(i){return i.replace(lC,"-$1").toLowerCase()}var uC=/^ms-/;function k0(i){return cC(i).replace(uC,"-ms-")}var hC=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function dC(i){return!!(i&&hC.test(i))}function $h(i,n){var o="",h="";if(typeof n=="string")return i.style.getPropertyValue(k0(n))||oC(i).getPropertyValue(k0(n));Object.keys(n).forEach(function(p){var _=n[p];!_&&_!==0?i.style.removeProperty(k0(p)):dC(p)?h+=p+"("+_+") ":o+=k0(p)+": "+_+";"}),h&&(o+="transform: "+h+";"),i.style.cssText+=";"+o}var rx={exports:{}},ax,B1;function fC(){if(B1)return ax;B1=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ax=i,ax}var sx,F1;function pC(){if(F1)return sx;F1=1;var i=fC();function n(){}function o(){}return o.resetWarningCache=n,sx=function(){function h(v,c,D,I,P,B){if(B!==i){var U=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw U.name="Invariant Violation",U}}h.isRequired=h;function p(){return h}var _={array:h,bigint:h,bool:h,func:h,number:h,object:h,string:h,symbol:h,any:h,arrayOf:p,element:h,elementType:h,instanceOf:p,node:h,objectOf:p,oneOf:p,oneOfType:p,shape:p,exact:p,checkPropTypes:o,resetWarningCache:n};return _.PropTypes=_,_},sx}var U1;function mC(){return U1||(U1=1,rx.exports=pC()()),rx.exports}var gC=mC();const Yh=jp(gC),V1={disabled:!1},Q2=Fl.createContext(null);var yC=function(n){return n.scrollTop},Vy="unmounted",Kd="exited",Uc="entering",Lh="entered",c_="exiting",nd=function(i){tC(n,i);function n(h,p){var _;_=i.call(this,h,p)||this;var v=p,c=v&&!v.isMounting?h.enter:h.appear,D;return _.appearStatus=null,h.in?c?(D=Kd,_.appearStatus=Uc):D=Lh:h.unmountOnExit||h.mountOnEnter?D=Vy:D=Kd,_.state={status:D},_.nextCallback=null,_}n.getDerivedStateFromProps=function(p,_){var v=p.in;return v&&_.status===Vy?{status:Kd}:null};var o=n.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(p){var _=null;if(p!==this.props){var v=this.state.status;this.props.in?v!==Uc&&v!==Lh&&(_=Uc):(v===Uc||v===Lh)&&(_=c_)}this.updateStatus(!1,_)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var p=this.props.timeout,_,v,c;return _=v=c=p,p!=null&&typeof p!="number"&&(_=p.exit,v=p.enter,c=p.appear!==void 0?p.appear:v),{exit:_,enter:v,appear:c}},o.updateStatus=function(p,_){if(p===void 0&&(p=!1),_!==null)if(this.cancelNextCallback(),_===Uc){if(this.props.unmountOnExit||this.props.mountOnEnter){var v=this.props.nodeRef?this.props.nodeRef.current:wp.findDOMNode(this);v&&yC(v)}this.performEnter(p)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Kd&&this.setState({status:Vy})},o.performEnter=function(p){var _=this,v=this.props.enter,c=this.context?this.context.isMounting:p,D=this.props.nodeRef?[c]:[wp.findDOMNode(this),c],I=D[0],P=D[1],B=this.getTimeouts(),U=c?B.appear:B.enter;if(!p&&!v||V1.disabled){this.safeSetState({status:Lh},function(){_.props.onEntered(I)});return}this.props.onEnter(I,P),this.safeSetState({status:Uc},function(){_.props.onEntering(I,P),_.onTransitionEnd(U,function(){_.safeSetState({status:Lh},function(){_.props.onEntered(I,P)})})})},o.performExit=function(){var p=this,_=this.props.exit,v=this.getTimeouts(),c=this.props.nodeRef?void 0:wp.findDOMNode(this);if(!_||V1.disabled){this.safeSetState({status:Kd},function(){p.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:c_},function(){p.props.onExiting(c),p.onTransitionEnd(v.exit,function(){p.safeSetState({status:Kd},function(){p.props.onExited(c)})})})},o.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(p,_){_=this.setNextCallback(_),this.setState(p,_)},o.setNextCallback=function(p){var _=this,v=!0;return this.nextCallback=function(c){v&&(v=!1,_.nextCallback=null,p(c))},this.nextCallback.cancel=function(){v=!1},this.nextCallback},o.onTransitionEnd=function(p,_){this.setNextCallback(_);var v=this.props.nodeRef?this.props.nodeRef.current:wp.findDOMNode(this),c=p==null&&!this.props.addEndListener;if(!v||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var D=this.props.nodeRef?[this.nextCallback]:[v,this.nextCallback],I=D[0],P=D[1];this.props.addEndListener(I,P)}p!=null&&setTimeout(this.nextCallback,p)},o.render=function(){var p=this.state.status;if(p===Vy)return null;var _=this.props,v=_.children;_.in,_.mountOnEnter,_.unmountOnExit,_.appear,_.enter,_.exit,_.timeout,_.addEndListener,_.onEnter,_.onEntering,_.onEntered,_.onExit,_.onExiting,_.onExited,_.nodeRef;var c=H2(_,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Fl.createElement(Q2.Provider,{value:null},typeof v=="function"?v(p,c):Fl.cloneElement(Fl.Children.only(v),c))},n}(Fl.Component);nd.contextType=Q2;nd.propTypes={};function Om(){}nd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Om,onEntering:Om,onEntered:Om,onExit:Om,onExiting:Om,onExited:Om};nd.UNMOUNTED=Vy;nd.EXITED=Kd;nd.ENTERING=Uc;nd.ENTERED=Lh;nd.EXITING=c_;function K2(i){return i.code==="Escape"||i.keyCode===27}function _C(){const i=he.version.split(".");return{major:+i[0],minor:+i[1],patch:+i[2]}}function pg(i){if(!i||typeof i=="function")return null;const{major:n}=_C();return n>=19?i.props.ref:i.ref}const fv=!!(typeof window<"u"&&window.document&&window.document.createElement);var Cx=!1,Dx=!1;try{var ox={get passive(){return Cx=!0},get once(){return Dx=Cx=!0}};fv&&(window.addEventListener("test",ox,ox),window.removeEventListener("test",ox,!0))}catch{}function vC(i,n,o,h){if(h&&typeof h!="boolean"&&!Dx){var p=h.once,_=h.capture,v=o;!Dx&&p&&(v=o.__once||function c(D){this.removeEventListener(n,c,_),o.call(this,D)},o.__once=v),i.addEventListener(n,v,Cx?h:_)}i.addEventListener(n,o,h)}function xC(i,n,o,h){var p=h&&typeof h!="boolean"?h.capture:h;i.removeEventListener(n,o,p),o.__once&&i.removeEventListener(n,o.__once,p)}function Fh(i,n,o,h){return vC(i,n,o,h),function(){xC(i,n,o,h)}}function bC(i,n,o,h){if(h===void 0&&(h=!0),i){var p=document.createEvent("HTMLEvents");p.initEvent(n,o,h),i.dispatchEvent(p)}}function wC(i){var n=$h(i,"transitionDuration")||"",o=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*o}function TC(i,n,o){o===void 0&&(o=5);var h=!1,p=setTimeout(function(){h||bC(i,"transitionend",!0)},n+o),_=Fh(i,"transitionend",function(){h=!0},{once:!0});return function(){clearTimeout(p),_()}}function SC(i,n,o,h){o==null&&(o=wC(i)||0);var p=TC(i,o,h),_=Fh(i,"transitionend",n);return function(){p(),_()}}function G1(i,n){const o=$h(i,n)||"",h=o.indexOf("ms")===-1?1e3:1;return parseFloat(o)*h}function db(i,n){const o=G1(i,"transitionDuration"),h=G1(i,"transitionDelay"),p=SC(i,_=>{_.target===i&&(p(),n(_))},o+h)}function Py(...i){return i.filter(n=>n!=null).reduce((n,o)=>{if(typeof o!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return n===null?o:function(...p){n.apply(this,p),o.apply(this,p)}},null)}function J2(i){i.offsetHeight}const Z1=i=>!i||typeof i=="function"?i:n=>{i.current=n};function EC(i,n){const o=Z1(i),h=Z1(n);return p=>{o&&o(p),h&&h(p)}}function eT(i,n){return he.useMemo(()=>EC(i,n),[i,n])}function kx(i){return i&&"setState"in i?wp.findDOMNode(i):i??null}const pv=Fl.forwardRef(({onEnter:i,onEntering:n,onEntered:o,onExit:h,onExiting:p,onExited:_,addEndListener:v,children:c,childRef:D,...I},P)=>{const B=he.useRef(null),U=eT(B,D),Z=Ve=>{U(kx(Ve))},ne=Ve=>ct=>{Ve&&B.current&&Ve(B.current,ct)},ye=he.useCallback(ne(i),[i]),me=he.useCallback(ne(n),[n]),Pe=he.useCallback(ne(o),[o]),tt=he.useCallback(ne(h),[h]),Je=he.useCallback(ne(p),[p]),$e=he.useCallback(ne(_),[_]),Me=he.useCallback(ne(v),[v]);return ae.jsx(nd,{ref:P,...I,onEnter:ye,onEntered:Pe,onEntering:me,onExit:tt,onExited:$e,onExiting:Je,addEndListener:Me,nodeRef:B,children:typeof c=="function"?(Ve,ct)=>c(Ve,{...ct,ref:Z}):Fl.cloneElement(c,{ref:Z})})});pv.displayName="TransitionWrapper";const AC={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function MC(i,n){const o=`offset${i[0].toUpperCase()}${i.slice(1)}`,h=n[o],p=AC[i];return h+parseInt($h(n,p[0]),10)+parseInt($h(n,p[1]),10)}const CC={[Kd]:"collapse",[c_]:"collapsing",[Uc]:"collapsing",[Lh]:"collapse show"},fb=Fl.forwardRef(({onEnter:i,onEntering:n,onEntered:o,onExit:h,onExiting:p,className:_,children:v,dimension:c="height",in:D=!1,timeout:I=300,mountOnEnter:P=!1,unmountOnExit:B=!1,appear:U=!1,getDimensionValue:Z=MC,...ne},ye)=>{const me=typeof c=="function"?c():c,Pe=he.useMemo(()=>Py(Ve=>{Ve.style[me]="0"},i),[me,i]),tt=he.useMemo(()=>Py(Ve=>{const ct=`scroll${me[0].toUpperCase()}${me.slice(1)}`;Ve.style[me]=`${Ve[ct]}px`},n),[me,n]),Je=he.useMemo(()=>Py(Ve=>{Ve.style[me]=null},o),[me,o]),$e=he.useMemo(()=>Py(Ve=>{Ve.style[me]=`${Z(me,Ve)}px`,J2(Ve)},h),[h,Z,me]),Me=he.useMemo(()=>Py(Ve=>{Ve.style[me]=null},p),[me,p]);return ae.jsx(pv,{ref:ye,addEndListener:db,...ne,"aria-expanded":ne.role?D:null,onEnter:Pe,onEntering:tt,onEntered:Je,onExit:$e,onExiting:Me,childRef:pg(v),in:D,timeout:I,mountOnEnter:P,unmountOnExit:B,appear:U,children:(Ve,ct)=>Fl.cloneElement(v,{...ct,className:kn(_,v.props.className,CC[Ve],me==="width"&&"collapse-horizontal")})})});fb.displayName="Collapse";function tT(i,n){return Array.isArray(i)?i.includes(n):i===n}const E_=he.createContext({});E_.displayName="AccordionContext";const pb=he.forwardRef(({as:i="div",bsPrefix:n,className:o,children:h,eventKey:p,..._},v)=>{const{activeEventKey:c}=he.useContext(E_);return n=Yn(n,"accordion-collapse"),ae.jsx(fb,{ref:v,in:tT(c,p),..._,className:kn(o,n),children:ae.jsx(i,{children:he.Children.only(h)})})});pb.displayName="AccordionCollapse";const mv=he.createContext({eventKey:""});mv.displayName="AccordionItemContext";const nT=he.forwardRef(({as:i="div",bsPrefix:n,className:o,onEnter:h,onEntering:p,onEntered:_,onExit:v,onExiting:c,onExited:D,...I},P)=>{n=Yn(n,"accordion-body");const{eventKey:B}=he.useContext(mv);return ae.jsx(pb,{eventKey:B,onEnter:h,onEntering:p,onEntered:_,onExit:v,onExiting:c,onExited:D,children:ae.jsx(i,{ref:P,...I,className:kn(o,n)})})});nT.displayName="AccordionBody";function DC(i,n){const{activeEventKey:o,onSelect:h,alwaysOpen:p}=he.useContext(E_);return _=>{let v=i===o?null:i;p&&(Array.isArray(o)?o.includes(i)?v=o.filter(c=>c!==i):v=[...o,i]:v=[i]),h==null||h(v,_),n==null||n(_)}}const mb=he.forwardRef(({as:i="button",bsPrefix:n,className:o,onClick:h,...p},_)=>{n=Yn(n,"accordion-button");const{eventKey:v}=he.useContext(mv),c=DC(v,h),{activeEventKey:D}=he.useContext(E_);return i==="button"&&(p.type="button"),ae.jsx(i,{ref:_,onClick:c,...p,"aria-expanded":Array.isArray(D)?D.includes(v):v===D,className:kn(o,n,!tT(D,v)&&"collapsed")})});mb.displayName="AccordionButton";const iT=he.forwardRef(({as:i="h2","aria-controls":n,bsPrefix:o,className:h,children:p,onClick:_,...v},c)=>(o=Yn(o,"accordion-header"),ae.jsx(i,{ref:c,...v,className:kn(h,o),children:ae.jsx(mb,{onClick:_,"aria-controls":n,children:p})})));iT.displayName="AccordionHeader";const rT=he.forwardRef(({as:i="div",bsPrefix:n,className:o,eventKey:h,...p},_)=>{n=Yn(n,"accordion-item");const v=he.useMemo(()=>({eventKey:h}),[h]);return ae.jsx(mv.Provider,{value:v,children:ae.jsx(i,{ref:_,...p,className:kn(o,n)})})});rT.displayName="AccordionItem";const aT=he.forwardRef((i,n)=>{const{as:o="div",activeKey:h,bsPrefix:p,className:_,onSelect:v,flush:c,alwaysOpen:D,...I}=X2(i,{activeKey:"onSelect"}),P=Yn(p,"accordion"),B=he.useMemo(()=>({activeEventKey:h,onSelect:v,alwaysOpen:D}),[h,v,D]);return ae.jsx(E_.Provider,{value:B,children:ae.jsx(o,{ref:n,...I,className:kn(_,P,c&&`${P}-flush`)})})});aT.displayName="Accordion";const I0=Object.assign(aT,{Button:mb,Collapse:pb,Item:rT,Header:iT,Body:nT});function kC(i){const n=he.useRef(i);return he.useEffect(()=>{n.current=i},[i]),n}function A_(i){const n=kC(i);return he.useCallback(function(...o){return n.current&&n.current(...o)},[n])}const IC=i=>he.forwardRef((n,o)=>ae.jsx("div",{...n,ref:o,className:kn(n.className,i)}));function $1(){return he.useState(null)}function RC(i){const n=he.useRef(i);return he.useEffect(()=>{n.current=i},[i]),n}function Ru(i){const n=RC(i);return he.useCallback(function(...o){return n.current&&n.current(...o)},[n])}function sT(){const i=he.useRef(!0),n=he.useRef(()=>i.current);return he.useEffect(()=>(i.current=!0,()=>{i.current=!1}),[]),n.current}function zC(i){const n=he.useRef(null);return he.useEffect(()=>{n.current=i}),n.current}const NC=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",PC=typeof document<"u",Y1=PC||NC?he.useLayoutEffect:he.useEffect,LC=["as","disabled"];function OC(i,n){if(i==null)return{};var o={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;o[h]=i[h]}return o}function jC(i){return!i||i.trim()==="#"}function oT({tagName:i,disabled:n,href:o,target:h,rel:p,role:_,onClick:v,tabIndex:c=0,type:D}){i||(o!=null||h!=null||p!=null?i="a":i="button");const I={tagName:i};if(i==="button")return[{type:D||"button",disabled:n},I];const P=U=>{if((n||i==="a"&&jC(o))&&U.preventDefault(),n){U.stopPropagation();return}v==null||v(U)},B=U=>{U.key===" "&&(U.preventDefault(),P(U))};return i==="a"&&(o||(o="#"),n&&(o=void 0)),[{role:_??"button",disabled:void 0,tabIndex:n?void 0:c,href:o,target:i==="a"?h:void 0,"aria-disabled":n||void 0,rel:i==="a"?p:void 0,onClick:P,onKeyDown:B},I]}const BC=he.forwardRef((i,n)=>{let{as:o,disabled:h}=i,p=OC(i,LC);const[_,{tagName:v}]=oT(Object.assign({tagName:o,disabled:h},p));return ae.jsx(v,Object.assign({},p,_,{ref:n}))});BC.displayName="Button";const FC={[Uc]:"show",[Lh]:"show"},G0=he.forwardRef(({className:i,children:n,transitionClasses:o={},onEnter:h,...p},_)=>{const v={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...p},c=he.useCallback((D,I)=>{J2(D),h==null||h(D,I)},[h]);return ae.jsx(pv,{ref:_,addEndListener:db,...v,onEnter:c,childRef:pg(n),children:(D,I)=>he.cloneElement(n,{...I,className:kn("fade",i,n.props.className,FC[D],o[D])})})});G0.displayName="Fade";const UC={"aria-label":Yh.string,onClick:Yh.func,variant:Yh.oneOf(["white"])},gb=he.forwardRef(({className:i,variant:n,"aria-label":o="Close",...h},p)=>ae.jsx("button",{ref:p,type:"button",className:kn("btn-close",n&&`btn-close-${n}`,i),"aria-label":o,...h}));gb.displayName="CloseButton";gb.propTypes=UC;const kp=he.forwardRef(({as:i,bsPrefix:n,variant:o="primary",size:h,active:p=!1,disabled:_=!1,className:v,...c},D)=>{const I=Yn(n,"btn"),[P,{tagName:B}]=oT({tagName:i,disabled:_,...c}),U=B;return ae.jsx(U,{...P,...c,ref:D,disabled:_,className:kn(v,I,p&&"active",o&&`${I}-${o}`,h&&`${I}-${h}`,c.href&&_&&"disabled")})});kp.displayName="Button";const yb=he.forwardRef(({bsPrefix:i,size:n,vertical:o=!1,className:h,role:p="group",as:_="div",...v},c)=>{const D=Yn(i,"btn-group");let I=D;return o&&(I=`${D}-vertical`),ae.jsx(_,{...v,ref:c,role:p,className:kn(h,I,n&&`${D}-${n}`)})});yb.displayName="ButtonGroup";function VC(i,n){return he.Children.toArray(i).some(o=>he.isValidElement(o)&&o.type===n)}function GC({as:i,bsPrefix:n,className:o,...h}){n=Yn(n,"col");const p=rC(),_=aC(),v=[],c=[];return p.forEach(D=>{const I=h[D];delete h[D];let P,B,U;typeof I=="object"&&I!=null?{span:P,offset:B,order:U}=I:P=I;const Z=D!==_?`-${D}`:"";P&&v.push(P===!0?`${n}${Z}`:`${n}${Z}-${P}`),U!=null&&c.push(`order${Z}-${U}`),B!=null&&c.push(`offset${Z}-${B}`)}),[{...h,className:kn(o,...v,...c)},{as:i,bsPrefix:n,spans:v}]}const lT=he.forwardRef((i,n)=>{const[{className:o,...h},{as:p="div",bsPrefix:_,spans:v}]=GC(i);return ae.jsx(p,{...h,ref:n,className:kn(o,!v.length&&_)})});lT.displayName="Col";var ZC=Function.prototype.bind.call(Function.prototype.call,[].slice);function jm(i,n){return ZC(i.querySelectorAll(n))}var q1=Object.prototype.hasOwnProperty;function H1(i,n,o){for(o of i.keys())if(Qy(o,n))return o}function Qy(i,n){var o,h,p;if(i===n)return!0;if(i&&n&&(o=i.constructor)===n.constructor){if(o===Date)return i.getTime()===n.getTime();if(o===RegExp)return i.toString()===n.toString();if(o===Array){if((h=i.length)===n.length)for(;h--&&Qy(i[h],n[h]););return h===-1}if(o===Set){if(i.size!==n.size)return!1;for(h of i)if(p=h,p&&typeof p=="object"&&(p=H1(n,p),!p)||!n.has(p))return!1;return!0}if(o===Map){if(i.size!==n.size)return!1;for(h of i)if(p=h[0],p&&typeof p=="object"&&(p=H1(n,p),!p)||!Qy(h[1],n.get(p)))return!1;return!0}if(o===ArrayBuffer)i=new Uint8Array(i),n=new Uint8Array(n);else if(o===DataView){if((h=i.byteLength)===n.byteLength)for(;h--&&i.getInt8(h)===n.getInt8(h););return h===-1}if(ArrayBuffer.isView(i)){if((h=i.byteLength)===n.byteLength)for(;h--&&i[h]===n[h];);return h===-1}if(!o||typeof i=="object"){h=0;for(o in i)if(q1.call(i,o)&&++h&&!q1.call(n,o)||!(o in n)||!Qy(i[o],n[o]))return!1;return Object.keys(n).length===h}}return i!==i&&n!==n}function $C(i){const n=sT();return[i[0],he.useCallback(o=>{if(n())return i[1](o)},[n,i[1]])]}var Eo="top",$l="bottom",Yl="right",Ao="left",_b="auto",M_=[Eo,$l,Yl,Ao],Km="start",u_="end",YC="clippingParents",cT="viewport",Ly="popper",qC="reference",X1=M_.reduce(function(i,n){return i.concat([n+"-"+Km,n+"-"+u_])},[]),uT=[].concat(M_,[_b]).reduce(function(i,n){return i.concat([n,n+"-"+Km,n+"-"+u_])},[]),HC="beforeRead",XC="read",WC="afterRead",QC="beforeMain",KC="main",JC="afterMain",eD="beforeWrite",tD="write",nD="afterWrite",iD=[HC,XC,WC,QC,KC,JC,eD,tD,nD];function ju(i){return i.split("-")[0]}function al(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var n=i.ownerDocument;return n&&n.defaultView||window}return i}function Ip(i){var n=al(i).Element;return i instanceof n||i instanceof Element}function Bu(i){var n=al(i).HTMLElement;return i instanceof n||i instanceof HTMLElement}function vb(i){if(typeof ShadowRoot>"u")return!1;var n=al(i).ShadowRoot;return i instanceof n||i instanceof ShadowRoot}var Ep=Math.max,Z0=Math.min,Jm=Math.round;function Ix(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function hT(){return!/^((?!chrome|android).)*safari/i.test(Ix())}function eg(i,n,o){n===void 0&&(n=!1),o===void 0&&(o=!1);var h=i.getBoundingClientRect(),p=1,_=1;n&&Bu(i)&&(p=i.offsetWidth>0&&Jm(h.width)/i.offsetWidth||1,_=i.offsetHeight>0&&Jm(h.height)/i.offsetHeight||1);var v=Ip(i)?al(i):window,c=v.visualViewport,D=!hT()&&o,I=(h.left+(D&&c?c.offsetLeft:0))/p,P=(h.top+(D&&c?c.offsetTop:0))/_,B=h.width/p,U=h.height/_;return{width:B,height:U,top:P,right:I+B,bottom:P+U,left:I,x:I,y:P}}function xb(i){var n=eg(i),o=i.offsetWidth,h=i.offsetHeight;return Math.abs(n.width-o)<=1&&(o=n.width),Math.abs(n.height-h)<=1&&(h=n.height),{x:i.offsetLeft,y:i.offsetTop,width:o,height:h}}function dT(i,n){var o=n.getRootNode&&n.getRootNode();if(i.contains(n))return!0;if(o&&vb(o)){var h=n;do{if(h&&i.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function of(i){return i?(i.nodeName||"").toLowerCase():null}function Kh(i){return al(i).getComputedStyle(i)}function rD(i){return["table","td","th"].indexOf(of(i))>=0}function ff(i){return((Ip(i)?i.ownerDocument:i.document)||window.document).documentElement}function gv(i){return of(i)==="html"?i:i.assignedSlot||i.parentNode||(vb(i)?i.host:null)||ff(i)}function W1(i){return!Bu(i)||Kh(i).position==="fixed"?null:i.offsetParent}function aD(i){var n=/firefox/i.test(Ix()),o=/Trident/i.test(Ix());if(o&&Bu(i)){var h=Kh(i);if(h.position==="fixed")return null}var p=gv(i);for(vb(p)&&(p=p.host);Bu(p)&&["html","body"].indexOf(of(p))<0;){var _=Kh(p);if(_.transform!=="none"||_.perspective!=="none"||_.contain==="paint"||["transform","perspective"].indexOf(_.willChange)!==-1||n&&_.willChange==="filter"||n&&_.filter&&_.filter!=="none")return p;p=p.parentNode}return null}function C_(i){for(var n=al(i),o=W1(i);o&&rD(o)&&Kh(o).position==="static";)o=W1(o);return o&&(of(o)==="html"||of(o)==="body"&&Kh(o).position==="static")?n:o||aD(i)||n}function bb(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Ky(i,n,o){return Ep(i,Z0(n,o))}function sD(i,n,o){var h=Ky(i,n,o);return h>o?o:h}function fT(){return{top:0,right:0,bottom:0,left:0}}function pT(i){return Object.assign({},fT(),i)}function mT(i,n){return n.reduce(function(o,h){return o[h]=i,o},{})}var oD=function(n,o){return n=typeof n=="function"?n(Object.assign({},o.rects,{placement:o.placement})):n,pT(typeof n!="number"?n:mT(n,M_))};function lD(i){var n,o=i.state,h=i.name,p=i.options,_=o.elements.arrow,v=o.modifiersData.popperOffsets,c=ju(o.placement),D=bb(c),I=[Ao,Yl].indexOf(c)>=0,P=I?"height":"width";if(!(!_||!v)){var B=oD(p.padding,o),U=xb(_),Z=D==="y"?Eo:Ao,ne=D==="y"?$l:Yl,ye=o.rects.reference[P]+o.rects.reference[D]-v[D]-o.rects.popper[P],me=v[D]-o.rects.reference[D],Pe=C_(_),tt=Pe?D==="y"?Pe.clientHeight||0:Pe.clientWidth||0:0,Je=ye/2-me/2,$e=B[Z],Me=tt-U[P]-B[ne],Ve=tt/2-U[P]/2+Je,ct=Ky($e,Ve,Me),ot=D;o.modifiersData[h]=(n={},n[ot]=ct,n.centerOffset=ct-Ve,n)}}function cD(i){var n=i.state,o=i.options,h=o.element,p=h===void 0?"[data-popper-arrow]":h;p!=null&&(typeof p=="string"&&(p=n.elements.popper.querySelector(p),!p)||dT(n.elements.popper,p)&&(n.elements.arrow=p))}const uD={name:"arrow",enabled:!0,phase:"main",fn:lD,effect:cD,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function tg(i){return i.split("-")[1]}var hD={top:"auto",right:"auto",bottom:"auto",left:"auto"};function dD(i,n){var o=i.x,h=i.y,p=n.devicePixelRatio||1;return{x:Jm(o*p)/p||0,y:Jm(h*p)/p||0}}function Q1(i){var n,o=i.popper,h=i.popperRect,p=i.placement,_=i.variation,v=i.offsets,c=i.position,D=i.gpuAcceleration,I=i.adaptive,P=i.roundOffsets,B=i.isFixed,U=v.x,Z=U===void 0?0:U,ne=v.y,ye=ne===void 0?0:ne,me=typeof P=="function"?P({x:Z,y:ye}):{x:Z,y:ye};Z=me.x,ye=me.y;var Pe=v.hasOwnProperty("x"),tt=v.hasOwnProperty("y"),Je=Ao,$e=Eo,Me=window;if(I){var Ve=C_(o),ct="clientHeight",ot="clientWidth";if(Ve===al(o)&&(Ve=ff(o),Kh(Ve).position!=="static"&&c==="absolute"&&(ct="scrollHeight",ot="scrollWidth")),Ve=Ve,p===Eo||(p===Ao||p===Yl)&&_===u_){$e=$l;var Re=B&&Ve===Me&&Me.visualViewport?Me.visualViewport.height:Ve[ct];ye-=Re-h.height,ye*=D?1:-1}if(p===Ao||(p===Eo||p===$l)&&_===u_){Je=Yl;var mt=B&&Ve===Me&&Me.visualViewport?Me.visualViewport.width:Ve[ot];Z-=mt-h.width,Z*=D?1:-1}}var It=Object.assign({position:c},I&&hD),Lt=P===!0?dD({x:Z,y:ye},al(o)):{x:Z,y:ye};if(Z=Lt.x,ye=Lt.y,D){var Ut;return Object.assign({},It,(Ut={},Ut[$e]=tt?"0":"",Ut[Je]=Pe?"0":"",Ut.transform=(Me.devicePixelRatio||1)<=1?"translate("+Z+"px, "+ye+"px)":"translate3d("+Z+"px, "+ye+"px, 0)",Ut))}return Object.assign({},It,(n={},n[$e]=tt?ye+"px":"",n[Je]=Pe?Z+"px":"",n.transform="",n))}function fD(i){var n=i.state,o=i.options,h=o.gpuAcceleration,p=h===void 0?!0:h,_=o.adaptive,v=_===void 0?!0:_,c=o.roundOffsets,D=c===void 0?!0:c,I={placement:ju(n.placement),variation:tg(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:p,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,Q1(Object.assign({},I,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:v,roundOffsets:D})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,Q1(Object.assign({},I,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:D})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const pD={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:fD,data:{}};var R0={passive:!0};function mD(i){var n=i.state,o=i.instance,h=i.options,p=h.scroll,_=p===void 0?!0:p,v=h.resize,c=v===void 0?!0:v,D=al(n.elements.popper),I=[].concat(n.scrollParents.reference,n.scrollParents.popper);return _&&I.forEach(function(P){P.addEventListener("scroll",o.update,R0)}),c&&D.addEventListener("resize",o.update,R0),function(){_&&I.forEach(function(P){P.removeEventListener("scroll",o.update,R0)}),c&&D.removeEventListener("resize",o.update,R0)}}const gD={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:mD,data:{}};var yD={left:"right",right:"left",bottom:"top",top:"bottom"};function O0(i){return i.replace(/left|right|bottom|top/g,function(n){return yD[n]})}var _D={start:"end",end:"start"};function K1(i){return i.replace(/start|end/g,function(n){return _D[n]})}function wb(i){var n=al(i),o=n.pageXOffset,h=n.pageYOffset;return{scrollLeft:o,scrollTop:h}}function Tb(i){return eg(ff(i)).left+wb(i).scrollLeft}function vD(i,n){var o=al(i),h=ff(i),p=o.visualViewport,_=h.clientWidth,v=h.clientHeight,c=0,D=0;if(p){_=p.width,v=p.height;var I=hT();(I||!I&&n==="fixed")&&(c=p.offsetLeft,D=p.offsetTop)}return{width:_,height:v,x:c+Tb(i),y:D}}function xD(i){var n,o=ff(i),h=wb(i),p=(n=i.ownerDocument)==null?void 0:n.body,_=Ep(o.scrollWidth,o.clientWidth,p?p.scrollWidth:0,p?p.clientWidth:0),v=Ep(o.scrollHeight,o.clientHeight,p?p.scrollHeight:0,p?p.clientHeight:0),c=-h.scrollLeft+Tb(i),D=-h.scrollTop;return Kh(p||o).direction==="rtl"&&(c+=Ep(o.clientWidth,p?p.clientWidth:0)-_),{width:_,height:v,x:c,y:D}}function Sb(i){var n=Kh(i),o=n.overflow,h=n.overflowX,p=n.overflowY;return/auto|scroll|overlay|hidden/.test(o+p+h)}function gT(i){return["html","body","#document"].indexOf(of(i))>=0?i.ownerDocument.body:Bu(i)&&Sb(i)?i:gT(gv(i))}function Jy(i,n){var o;n===void 0&&(n=[]);var h=gT(i),p=h===((o=i.ownerDocument)==null?void 0:o.body),_=al(h),v=p?[_].concat(_.visualViewport||[],Sb(h)?h:[]):h,c=n.concat(v);return p?c:c.concat(Jy(gv(v)))}function Rx(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function bD(i,n){var o=eg(i,!1,n==="fixed");return o.top=o.top+i.clientTop,o.left=o.left+i.clientLeft,o.bottom=o.top+i.clientHeight,o.right=o.left+i.clientWidth,o.width=i.clientWidth,o.height=i.clientHeight,o.x=o.left,o.y=o.top,o}function J1(i,n,o){return n===cT?Rx(vD(i,o)):Ip(n)?bD(n,o):Rx(xD(ff(i)))}function wD(i){var n=Jy(gv(i)),o=["absolute","fixed"].indexOf(Kh(i).position)>=0,h=o&&Bu(i)?C_(i):i;return Ip(h)?n.filter(function(p){return Ip(p)&&dT(p,h)&&of(p)!=="body"}):[]}function TD(i,n,o,h){var p=n==="clippingParents"?wD(i):[].concat(n),_=[].concat(p,[o]),v=_[0],c=_.reduce(function(D,I){var P=J1(i,I,h);return D.top=Ep(P.top,D.top),D.right=Z0(P.right,D.right),D.bottom=Z0(P.bottom,D.bottom),D.left=Ep(P.left,D.left),D},J1(i,v,h));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function yT(i){var n=i.reference,o=i.element,h=i.placement,p=h?ju(h):null,_=h?tg(h):null,v=n.x+n.width/2-o.width/2,c=n.y+n.height/2-o.height/2,D;switch(p){case Eo:D={x:v,y:n.y-o.height};break;case $l:D={x:v,y:n.y+n.height};break;case Yl:D={x:n.x+n.width,y:c};break;case Ao:D={x:n.x-o.width,y:c};break;default:D={x:n.x,y:n.y}}var I=p?bb(p):null;if(I!=null){var P=I==="y"?"height":"width";switch(_){case Km:D[I]=D[I]-(n[P]/2-o[P]/2);break;case u_:D[I]=D[I]+(n[P]/2-o[P]/2);break}}return D}function h_(i,n){n===void 0&&(n={});var o=n,h=o.placement,p=h===void 0?i.placement:h,_=o.strategy,v=_===void 0?i.strategy:_,c=o.boundary,D=c===void 0?YC:c,I=o.rootBoundary,P=I===void 0?cT:I,B=o.elementContext,U=B===void 0?Ly:B,Z=o.altBoundary,ne=Z===void 0?!1:Z,ye=o.padding,me=ye===void 0?0:ye,Pe=pT(typeof me!="number"?me:mT(me,M_)),tt=U===Ly?qC:Ly,Je=i.rects.popper,$e=i.elements[ne?tt:U],Me=TD(Ip($e)?$e:$e.contextElement||ff(i.elements.popper),D,P,v),Ve=eg(i.elements.reference),ct=yT({reference:Ve,element:Je,placement:p}),ot=Rx(Object.assign({},Je,ct)),Re=U===Ly?ot:Ve,mt={top:Me.top-Re.top+Pe.top,bottom:Re.bottom-Me.bottom+Pe.bottom,left:Me.left-Re.left+Pe.left,right:Re.right-Me.right+Pe.right},It=i.modifiersData.offset;if(U===Ly&&It){var Lt=It[p];Object.keys(mt).forEach(function(Ut){var sn=[Yl,$l].indexOf(Ut)>=0?1:-1,on=[Eo,$l].indexOf(Ut)>=0?"y":"x";mt[Ut]+=Lt[on]*sn})}return mt}function SD(i,n){n===void 0&&(n={});var o=n,h=o.placement,p=o.boundary,_=o.rootBoundary,v=o.padding,c=o.flipVariations,D=o.allowedAutoPlacements,I=D===void 0?uT:D,P=tg(h),B=P?c?X1:X1.filter(function(ne){return tg(ne)===P}):M_,U=B.filter(function(ne){return I.indexOf(ne)>=0});U.length===0&&(U=B);var Z=U.reduce(function(ne,ye){return ne[ye]=h_(i,{placement:ye,boundary:p,rootBoundary:_,padding:v})[ju(ye)],ne},{});return Object.keys(Z).sort(function(ne,ye){return Z[ne]-Z[ye]})}function ED(i){if(ju(i)===_b)return[];var n=O0(i);return[K1(i),n,K1(n)]}function AD(i){var n=i.state,o=i.options,h=i.name;if(!n.modifiersData[h]._skip){for(var p=o.mainAxis,_=p===void 0?!0:p,v=o.altAxis,c=v===void 0?!0:v,D=o.fallbackPlacements,I=o.padding,P=o.boundary,B=o.rootBoundary,U=o.altBoundary,Z=o.flipVariations,ne=Z===void 0?!0:Z,ye=o.allowedAutoPlacements,me=n.options.placement,Pe=ju(me),tt=Pe===me,Je=D||(tt||!ne?[O0(me)]:ED(me)),$e=[me].concat(Je).reduce(function(Rt,Jt){return Rt.concat(ju(Jt)===_b?SD(n,{placement:Jt,boundary:P,rootBoundary:B,padding:I,flipVariations:ne,allowedAutoPlacements:ye}):Jt)},[]),Me=n.rects.reference,Ve=n.rects.popper,ct=new Map,ot=!0,Re=$e[0],mt=0;mt<$e.length;mt++){var It=$e[mt],Lt=ju(It),Ut=tg(It)===Km,sn=[Eo,$l].indexOf(Lt)>=0,on=sn?"width":"height",Ye=h_(n,{placement:It,boundary:P,rootBoundary:B,altBoundary:U,padding:I}),gt=sn?Ut?Yl:Ao:Ut?$l:Eo;Me[on]>Ve[on]&&(gt=O0(gt));var _t=O0(gt),qt=[];if(_&&qt.push(Ye[Lt]<=0),c&&qt.push(Ye[gt]<=0,Ye[_t]<=0),qt.every(function(Rt){return Rt})){Re=It,ot=!1;break}ct.set(It,qt)}if(ot)for(var Ce=ne?3:1,ut=function(Jt){var Wt=$e.find(function(Ri){var zn=ct.get(Ri);if(zn)return zn.slice(0,Jt).every(function(Gn){return Gn})});if(Wt)return Re=Wt,"break"},wt=Ce;wt>0;wt--){var Mt=ut(wt);if(Mt==="break")break}n.placement!==Re&&(n.modifiersData[h]._skip=!0,n.placement=Re,n.reset=!0)}}const MD={name:"flip",enabled:!0,phase:"main",fn:AD,requiresIfExists:["offset"],data:{_skip:!1}};function ew(i,n,o){return o===void 0&&(o={x:0,y:0}),{top:i.top-n.height-o.y,right:i.right-n.width+o.x,bottom:i.bottom-n.height+o.y,left:i.left-n.width-o.x}}function tw(i){return[Eo,Yl,$l,Ao].some(function(n){return i[n]>=0})}function CD(i){var n=i.state,o=i.name,h=n.rects.reference,p=n.rects.popper,_=n.modifiersData.preventOverflow,v=h_(n,{elementContext:"reference"}),c=h_(n,{altBoundary:!0}),D=ew(v,h),I=ew(c,p,_),P=tw(D),B=tw(I);n.modifiersData[o]={referenceClippingOffsets:D,popperEscapeOffsets:I,isReferenceHidden:P,hasPopperEscaped:B},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":P,"data-popper-escaped":B})}const DD={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:CD};function kD(i,n,o){var h=ju(i),p=[Ao,Eo].indexOf(h)>=0?-1:1,_=typeof o=="function"?o(Object.assign({},n,{placement:i})):o,v=_[0],c=_[1];return v=v||0,c=(c||0)*p,[Ao,Yl].indexOf(h)>=0?{x:c,y:v}:{x:v,y:c}}function ID(i){var n=i.state,o=i.options,h=i.name,p=o.offset,_=p===void 0?[0,0]:p,v=uT.reduce(function(P,B){return P[B]=kD(B,n.rects,_),P},{}),c=v[n.placement],D=c.x,I=c.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=D,n.modifiersData.popperOffsets.y+=I),n.modifiersData[h]=v}const RD={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ID};function zD(i){var n=i.state,o=i.name;n.modifiersData[o]=yT({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const ND={name:"popperOffsets",enabled:!0,phase:"read",fn:zD,data:{}};function PD(i){return i==="x"?"y":"x"}function LD(i){var n=i.state,o=i.options,h=i.name,p=o.mainAxis,_=p===void 0?!0:p,v=o.altAxis,c=v===void 0?!1:v,D=o.boundary,I=o.rootBoundary,P=o.altBoundary,B=o.padding,U=o.tether,Z=U===void 0?!0:U,ne=o.tetherOffset,ye=ne===void 0?0:ne,me=h_(n,{boundary:D,rootBoundary:I,padding:B,altBoundary:P}),Pe=ju(n.placement),tt=tg(n.placement),Je=!tt,$e=bb(Pe),Me=PD($e),Ve=n.modifiersData.popperOffsets,ct=n.rects.reference,ot=n.rects.popper,Re=typeof ye=="function"?ye(Object.assign({},n.rects,{placement:n.placement})):ye,mt=typeof Re=="number"?{mainAxis:Re,altAxis:Re}:Object.assign({mainAxis:0,altAxis:0},Re),It=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Lt={x:0,y:0};if(Ve){if(_){var Ut,sn=$e==="y"?Eo:Ao,on=$e==="y"?$l:Yl,Ye=$e==="y"?"height":"width",gt=Ve[$e],_t=gt+me[sn],qt=gt-me[on],Ce=Z?-ot[Ye]/2:0,ut=tt===Km?ct[Ye]:ot[Ye],wt=tt===Km?-ot[Ye]:-ct[Ye],Mt=n.elements.arrow,Rt=Z&&Mt?xb(Mt):{width:0,height:0},Jt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:fT(),Wt=Jt[sn],Ri=Jt[on],zn=Ky(0,ct[Ye],Rt[Ye]),Gn=Je?ct[Ye]/2-Ce-zn-Wt-mt.mainAxis:ut-zn-Wt-mt.mainAxis,Ca=Je?-ct[Ye]/2+Ce+zn+Ri+mt.mainAxis:wt+zn+Ri+mt.mainAxis,Hi=n.elements.arrow&&C_(n.elements.arrow),Xa=Hi?$e==="y"?Hi.clientTop||0:Hi.clientLeft||0:0,Xn=(Ut=It==null?void 0:It[$e])!=null?Ut:0,br=gt+Gn-Xn-Xa,Pn=gt+Ca-Xn,Wa=Ky(Z?Z0(_t,br):_t,gt,Z?Ep(qt,Pn):qt);Ve[$e]=Wa,Lt[$e]=Wa-gt}if(c){var qn,aa=$e==="x"?Eo:Ao,Or=$e==="x"?$l:Yl,Yr=Ve[Me],qr=Me==="y"?"height":"width",ol=Yr+me[aa],gs=Yr-me[Or],Da=[Eo,Ao].indexOf(Pe)!==-1,Js=(qn=It==null?void 0:It[Me])!=null?qn:0,Hr=Da?ol:Yr-ct[qr]-ot[qr]-Js+mt.altAxis,ci=Da?Yr+ct[qr]+ot[qr]-Js-mt.altAxis:gs,dr=Z&&Da?sD(Hr,Yr,ci):Ky(Z?Hr:ol,Yr,Z?ci:gs);Ve[Me]=dr,Lt[Me]=dr-Yr}n.modifiersData[h]=Lt}}const OD={name:"preventOverflow",enabled:!0,phase:"main",fn:LD,requiresIfExists:["offset"]};function jD(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function BD(i){return i===al(i)||!Bu(i)?wb(i):jD(i)}function FD(i){var n=i.getBoundingClientRect(),o=Jm(n.width)/i.offsetWidth||1,h=Jm(n.height)/i.offsetHeight||1;return o!==1||h!==1}function UD(i,n,o){o===void 0&&(o=!1);var h=Bu(n),p=Bu(n)&&FD(n),_=ff(n),v=eg(i,p,o),c={scrollLeft:0,scrollTop:0},D={x:0,y:0};return(h||!h&&!o)&&((of(n)!=="body"||Sb(_))&&(c=BD(n)),Bu(n)?(D=eg(n,!0),D.x+=n.clientLeft,D.y+=n.clientTop):_&&(D.x=Tb(_))),{x:v.left+c.scrollLeft-D.x,y:v.top+c.scrollTop-D.y,width:v.width,height:v.height}}function VD(i){var n=new Map,o=new Set,h=[];i.forEach(function(_){n.set(_.name,_)});function p(_){o.add(_.name);var v=[].concat(_.requires||[],_.requiresIfExists||[]);v.forEach(function(c){if(!o.has(c)){var D=n.get(c);D&&p(D)}}),h.push(_)}return i.forEach(function(_){o.has(_.name)||p(_)}),h}function GD(i){var n=VD(i);return iD.reduce(function(o,h){return o.concat(n.filter(function(p){return p.phase===h}))},[])}function ZD(i){var n;return function(){return n||(n=new Promise(function(o){Promise.resolve().then(function(){n=void 0,o(i())})})),n}}function $D(i){var n=i.reduce(function(o,h){var p=o[h.name];return o[h.name]=p?Object.assign({},p,h,{options:Object.assign({},p.options,h.options),data:Object.assign({},p.data,h.data)}):h,o},{});return Object.keys(n).map(function(o){return n[o]})}var nw={placement:"bottom",modifiers:[],strategy:"absolute"};function iw(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return!n.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function YD(i){i===void 0&&(i={});var n=i,o=n.defaultModifiers,h=o===void 0?[]:o,p=n.defaultOptions,_=p===void 0?nw:p;return function(c,D,I){I===void 0&&(I=_);var P={placement:"bottom",orderedModifiers:[],options:Object.assign({},nw,_),modifiersData:{},elements:{reference:c,popper:D},attributes:{},styles:{}},B=[],U=!1,Z={state:P,setOptions:function(Pe){var tt=typeof Pe=="function"?Pe(P.options):Pe;ye(),P.options=Object.assign({},_,P.options,tt),P.scrollParents={reference:Ip(c)?Jy(c):c.contextElement?Jy(c.contextElement):[],popper:Jy(D)};var Je=GD($D([].concat(h,P.options.modifiers)));return P.orderedModifiers=Je.filter(function($e){return $e.enabled}),ne(),Z.update()},forceUpdate:function(){if(!U){var Pe=P.elements,tt=Pe.reference,Je=Pe.popper;if(iw(tt,Je)){P.rects={reference:UD(tt,C_(Je),P.options.strategy==="fixed"),popper:xb(Je)},P.reset=!1,P.placement=P.options.placement,P.orderedModifiers.forEach(function(mt){return P.modifiersData[mt.name]=Object.assign({},mt.data)});for(var $e=0;$e<P.orderedModifiers.length;$e++){if(P.reset===!0){P.reset=!1,$e=-1;continue}var Me=P.orderedModifiers[$e],Ve=Me.fn,ct=Me.options,ot=ct===void 0?{}:ct,Re=Me.name;typeof Ve=="function"&&(P=Ve({state:P,options:ot,name:Re,instance:Z})||P)}}}},update:ZD(function(){return new Promise(function(me){Z.forceUpdate(),me(P)})}),destroy:function(){ye(),U=!0}};if(!iw(c,D))return Z;Z.setOptions(I).then(function(me){!U&&I.onFirstUpdate&&I.onFirstUpdate(me)});function ne(){P.orderedModifiers.forEach(function(me){var Pe=me.name,tt=me.options,Je=tt===void 0?{}:tt,$e=me.effect;if(typeof $e=="function"){var Me=$e({state:P,name:Pe,instance:Z,options:Je}),Ve=function(){};B.push(Me||Ve)}})}function ye(){B.forEach(function(me){return me()}),B=[]}return Z}}const qD=YD({defaultModifiers:[DD,ND,pD,gD,RD,MD,OD,uD]}),HD=["enabled","placement","strategy","modifiers"];function XD(i,n){if(i==null)return{};var o={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;o[h]=i[h]}return o}const WD={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},QD={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:i})=>()=>{const{reference:n,popper:o}=i.elements;if("removeAttribute"in n){const h=(n.getAttribute("aria-describedby")||"").split(",").filter(p=>p.trim()!==o.id);h.length?n.setAttribute("aria-describedby",h.join(",")):n.removeAttribute("aria-describedby")}},fn:({state:i})=>{var n;const{popper:o,reference:h}=i.elements,p=(n=o.getAttribute("role"))==null?void 0:n.toLowerCase();if(o.id&&p==="tooltip"&&"setAttribute"in h){const _=h.getAttribute("aria-describedby");if(_&&_.split(",").indexOf(o.id)!==-1)return;h.setAttribute("aria-describedby",_?`${_},${o.id}`:o.id)}}},KD=[];function JD(i,n,o={}){let{enabled:h=!0,placement:p="bottom",strategy:_="absolute",modifiers:v=KD}=o,c=XD(o,HD);const D=he.useRef(v),I=he.useRef(),P=he.useCallback(()=>{var me;(me=I.current)==null||me.update()},[]),B=he.useCallback(()=>{var me;(me=I.current)==null||me.forceUpdate()},[]),[U,Z]=$C(he.useState({placement:p,update:P,forceUpdate:B,attributes:{},styles:{popper:{},arrow:{}}})),ne=he.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:me})=>{const Pe={},tt={};Object.keys(me.elements).forEach(Je=>{Pe[Je]=me.styles[Je],tt[Je]=me.attributes[Je]}),Z({state:me,styles:Pe,attributes:tt,update:P,forceUpdate:B,placement:me.placement})}}),[P,B,Z]),ye=he.useMemo(()=>(Qy(D.current,v)||(D.current=v),D.current),[v]);return he.useEffect(()=>{!I.current||!h||I.current.setOptions({placement:p,strategy:_,modifiers:[...ye,ne,WD]})},[_,p,ne,h,ye]),he.useEffect(()=>{if(!(!h||i==null||n==null))return I.current=qD(i,n,Object.assign({},c,{placement:p,strategy:_,modifiers:[...ye,QD,ne]})),()=>{I.current!=null&&(I.current.destroy(),I.current=void 0,Z(me=>Object.assign({},me,{attributes:{},styles:{popper:{}}})))}},[h,i,n]),U}function $0(i,n){if(i.contains)return i.contains(n);if(i.compareDocumentPosition)return i===n||!!(i.compareDocumentPosition(n)&16)}var lx,rw;function ek(){if(rw)return lx;rw=1;var i=function(){};return lx=i,lx}var tk=ek();const nk=jp(tk),aw=()=>{};function ik(i){return i.button===0}function rk(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}const j0=i=>i&&("current"in i?i.current:i),sw={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function ak(i,n=aw,{disabled:o,clickTrigger:h="click"}={}){const p=he.useRef(!1),_=he.useRef(!1),v=he.useCallback(I=>{const P=j0(i);nk(!!P,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),p.current=!P||rk(I)||!ik(I)||!!$0(P,I.target)||_.current,_.current=!1},[i]),c=Ru(I=>{const P=j0(i);P&&$0(P,I.target)?_.current=!0:_.current=!1}),D=Ru(I=>{p.current||n(I)});he.useEffect(()=>{var I,P;if(o||i==null)return;const B=S_(j0(i)),U=B.defaultView||window;let Z=(I=U.event)!=null?I:(P=U.parent)==null?void 0:P.event,ne=null;sw[h]&&(ne=Fh(B,sw[h],c,!0));const ye=Fh(B,h,v,!0),me=Fh(B,h,tt=>{if(tt===Z){Z=void 0;return}D(tt)});let Pe=[];return"ontouchstart"in B.documentElement&&(Pe=[].slice.call(B.body.children).map(tt=>Fh(tt,"mousemove",aw))),()=>{ne==null||ne(),ye(),me(),Pe.forEach(tt=>tt())}},[i,o,h,v,c,D])}function sk(i){const n={};return Array.isArray(i)?(i==null||i.forEach(o=>{n[o.name]=o}),n):i||n}function ok(i={}){return Array.isArray(i)?i:Object.keys(i).map(n=>(i[n].name=n,i[n]))}function lk({enabled:i,enableEvents:n,placement:o,flip:h,offset:p,fixed:_,containerPadding:v,arrowElement:c,popperConfig:D={}}){var I,P,B,U;const Z=sk(D.modifiers);return Object.assign({},D,{placement:o,enabled:i,strategy:_?"fixed":D.strategy,modifiers:ok(Object.assign({},Z,{eventListeners:{enabled:n,options:(I=Z.eventListeners)==null?void 0:I.options},preventOverflow:Object.assign({},Z.preventOverflow,{options:Object.assign({padding:v},(P=Z.preventOverflow)==null?void 0:P.options)}),offset:{options:Object.assign({offset:p},(B=Z.offset)==null?void 0:B.options)},arrow:Object.assign({},Z.arrow,{enabled:!!c,options:Object.assign({},(U=Z.arrow)==null?void 0:U.options,{element:c})}),flip:Object.assign({enabled:!!h},Z.flip)}))})}const ck=he.createContext(null),uk="data-rr-ui-";function hk(i){return`${uk}${i}`}const _T=he.createContext(fv?window:void 0);_T.Provider;function Eb(){return he.useContext(_T)}const dk=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",fk=typeof document<"u",vT=fk||dk?he.useLayoutEffect:he.useEffect,D_=he.createContext(null);D_.displayName="NavbarContext";const pk={type:Yh.string,tooltip:Yh.bool,as:Yh.elementType},yv=he.forwardRef(({as:i="div",className:n,type:o="valid",tooltip:h=!1,...p},_)=>ae.jsx(i,{...p,ref:_,className:kn(n,`${o}-${h?"tooltip":"feedback"}`)}));yv.displayName="Feedback";yv.propTypes=pk;const Jh=he.createContext({}),Ab=he.forwardRef(({id:i,bsPrefix:n,className:o,type:h="checkbox",isValid:p=!1,isInvalid:_=!1,as:v="input",...c},D)=>{const{controlId:I}=he.useContext(Jh);return n=Yn(n,"form-check-input"),ae.jsx(v,{...c,ref:D,type:h,id:i||I,className:kn(o,n,p&&"is-valid",_&&"is-invalid")})});Ab.displayName="FormCheckInput";const Y0=he.forwardRef(({bsPrefix:i,className:n,htmlFor:o,...h},p)=>{const{controlId:_}=he.useContext(Jh);return i=Yn(i,"form-check-label"),ae.jsx("label",{...h,ref:p,htmlFor:o||_,className:kn(n,i)})});Y0.displayName="FormCheckLabel";const xT=he.forwardRef(({id:i,bsPrefix:n,bsSwitchPrefix:o,inline:h=!1,reverse:p=!1,disabled:_=!1,isValid:v=!1,isInvalid:c=!1,feedbackTooltip:D=!1,feedback:I,feedbackType:P,className:B,style:U,title:Z="",type:ne="checkbox",label:ye,children:me,as:Pe="input",...tt},Je)=>{n=Yn(n,"form-check"),o=Yn(o,"form-switch");const{controlId:$e}=he.useContext(Jh),Me=he.useMemo(()=>({controlId:i||$e}),[$e,i]),Ve=!me&&ye!=null&&ye!==!1||VC(me,Y0),ct=ae.jsx(Ab,{...tt,type:ne==="switch"?"checkbox":ne,ref:Je,isValid:v,isInvalid:c,disabled:_,as:Pe});return ae.jsx(Jh.Provider,{value:Me,children:ae.jsx("div",{style:U,className:kn(B,Ve&&n,h&&`${n}-inline`,p&&`${n}-reverse`,ne==="switch"&&o),children:me||ae.jsxs(ae.Fragment,{children:[ct,Ve&&ae.jsx(Y0,{title:Z,children:ye}),I&&ae.jsx(yv,{type:P,tooltip:D,children:I})]})})})});xT.displayName="FormCheck";const q0=Object.assign(xT,{Input:Ab,Label:Y0}),bT=he.forwardRef(({bsPrefix:i,type:n,size:o,htmlSize:h,id:p,className:_,isValid:v=!1,isInvalid:c=!1,plaintext:D,readOnly:I,as:P="input",...B},U)=>{const{controlId:Z}=he.useContext(Jh);return i=Yn(i,"form-control"),ae.jsx(P,{...B,type:n,size:h,ref:U,readOnly:I,id:p||Z,className:kn(_,D?`${i}-plaintext`:i,o&&`${i}-${o}`,n==="color"&&`${i}-color`,v&&"is-valid",c&&"is-invalid")})});bT.displayName="FormControl";const mk=Object.assign(bT,{Feedback:yv}),wT=he.forwardRef(({className:i,bsPrefix:n,as:o="div",...h},p)=>(n=Yn(n,"form-floating"),ae.jsx(o,{ref:p,className:kn(i,n),...h})));wT.displayName="FormFloating";const Mb=he.forwardRef(({controlId:i,as:n="div",...o},h)=>{const p=he.useMemo(()=>({controlId:i}),[i]);return ae.jsx(Jh.Provider,{value:p,children:ae.jsx(n,{...o,ref:h})})});Mb.displayName="FormGroup";const TT=he.forwardRef(({as:i="label",bsPrefix:n,column:o=!1,visuallyHidden:h=!1,className:p,htmlFor:_,...v},c)=>{const{controlId:D}=he.useContext(Jh);n=Yn(n,"form-label");let I="col-form-label";typeof o=="string"&&(I=`${I} ${I}-${o}`);const P=kn(p,n,h&&"visually-hidden",o&&I);return _=_||D,o?ae.jsx(lT,{ref:c,as:"label",className:P,htmlFor:_,...v}):ae.jsx(i,{ref:c,className:P,htmlFor:_,...v})});TT.displayName="FormLabel";const ST=he.forwardRef(({bsPrefix:i,className:n,id:o,...h},p)=>{const{controlId:_}=he.useContext(Jh);return i=Yn(i,"form-range"),ae.jsx("input",{...h,type:"range",ref:p,className:kn(n,i),id:o||_})});ST.displayName="FormRange";const ET=he.forwardRef(({bsPrefix:i,size:n,htmlSize:o,className:h,isValid:p=!1,isInvalid:_=!1,id:v,...c},D)=>{const{controlId:I}=he.useContext(Jh);return i=Yn(i,"form-select"),ae.jsx("select",{...c,size:o,ref:D,className:kn(h,i,n&&`${i}-${n}`,p&&"is-valid",_&&"is-invalid"),id:v||I})});ET.displayName="FormSelect";const AT=he.forwardRef(({bsPrefix:i,className:n,as:o="small",muted:h,...p},_)=>(i=Yn(i,"form-text"),ae.jsx(o,{...p,ref:_,className:kn(n,i,h&&"text-muted")})));AT.displayName="FormText";const MT=he.forwardRef((i,n)=>ae.jsx(q0,{...i,ref:n,type:"switch"}));MT.displayName="Switch";const gk=Object.assign(MT,{Input:q0.Input,Label:q0.Label}),CT=he.forwardRef(({bsPrefix:i,className:n,children:o,controlId:h,label:p,..._},v)=>(i=Yn(i,"form-floating"),ae.jsxs(Mb,{ref:v,className:kn(n,i),controlId:h,..._,children:[o,ae.jsx("label",{htmlFor:h,children:p})]})));CT.displayName="FloatingLabel";const yk={_ref:Yh.any,validated:Yh.bool,as:Yh.elementType},Cb=he.forwardRef(({className:i,validated:n,as:o="form",...h},p)=>ae.jsx(o,{...h,ref:p,className:kn(i,n&&"was-validated")}));Cb.displayName="Form";Cb.propTypes=yk;const Ii=Object.assign(Cb,{Group:Mb,Control:mk,Floating:wT,Check:q0,Switch:gk,Label:TT,Text:AT,Range:ST,Select:ET,FloatingLabel:CT}),ow=i=>!i||typeof i=="function"?i:n=>{i.current=n};function _k(i,n){const o=ow(i),h=ow(n);return p=>{o&&o(p),h&&h(p)}}function _v(i,n){return he.useMemo(()=>_k(i,n),[i,n])}function cx(i){i===void 0&&(i=S_());try{var n=i.activeElement;return!n||!n.nodeName?null:n}catch{return i.body}}function vk(i){const n=he.useRef(i);return n.current=i,n}function xk(i){const n=vk(i);he.useEffect(()=>()=>n.current(),[])}function bk(i=document){const n=i.defaultView;return Math.abs(n.innerWidth-i.documentElement.clientWidth)}const lw=hk("modal-open");class Db{constructor({ownerDocument:n,handleContainerOverflow:o=!0,isRTL:h=!1}={}){this.handleContainerOverflow=o,this.isRTL=h,this.modals=[],this.ownerDocument=n}getScrollbarWidth(){return bk(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(n){}removeModalAttributes(n){}setContainerStyle(n){const o={overflow:"hidden"},h=this.isRTL?"paddingLeft":"paddingRight",p=this.getElement();n.style={overflow:p.style.overflow,[h]:p.style[h]},n.scrollBarWidth&&(o[h]=`${parseInt($h(p,h)||"0",10)+n.scrollBarWidth}px`),p.setAttribute(lw,""),$h(p,o)}reset(){[...this.modals].forEach(n=>this.remove(n))}removeContainerStyle(n){const o=this.getElement();o.removeAttribute(lw),Object.assign(o.style,n.style)}add(n){let o=this.modals.indexOf(n);return o!==-1||(o=this.modals.length,this.modals.push(n),this.setModalAttributes(n),o!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),o}remove(n){const o=this.modals.indexOf(n);o!==-1&&(this.modals.splice(o,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(n))}isTopModal(n){return!!this.modals.length&&this.modals[this.modals.length-1]===n}}const ux=(i,n)=>fv?i==null?(n||S_()).body:(typeof i=="function"&&(i=i()),i&&"current"in i&&(i=i.current),i&&("nodeType"in i||i.getBoundingClientRect)?i:null):null;function zx(i,n){const o=Eb(),[h,p]=he.useState(()=>ux(i,o==null?void 0:o.document));if(!h){const _=ux(i);_&&p(_)}return he.useEffect(()=>{},[n,h]),he.useEffect(()=>{const _=ux(i);_!==h&&p(_)},[i,h]),h}function wk({children:i,in:n,onExited:o,mountOnEnter:h,unmountOnExit:p}){const _=he.useRef(null),v=he.useRef(n),c=Ru(o);he.useEffect(()=>{n?v.current=!0:c(_.current)},[n,c]);const D=_v(_,pg(i)),I=he.cloneElement(i,{ref:D});return n?I:p||!v.current&&h?null:I}const Tk=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function Sk(i,n){if(i==null)return{};var o={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;o[h]=i[h]}return o}function Ek(i){let{onEnter:n,onEntering:o,onEntered:h,onExit:p,onExiting:_,onExited:v,addEndListener:c,children:D}=i,I=Sk(i,Tk);const P=he.useRef(null),B=_v(P,pg(D)),U=$e=>Me=>{$e&&P.current&&$e(P.current,Me)},Z=he.useCallback(U(n),[n]),ne=he.useCallback(U(o),[o]),ye=he.useCallback(U(h),[h]),me=he.useCallback(U(p),[p]),Pe=he.useCallback(U(_),[_]),tt=he.useCallback(U(v),[v]),Je=he.useCallback(U(c),[c]);return Object.assign({},I,{nodeRef:P},n&&{onEnter:Z},o&&{onEntering:ne},h&&{onEntered:ye},p&&{onExit:me},_&&{onExiting:Pe},v&&{onExited:tt},c&&{addEndListener:Je},{children:typeof D=="function"?($e,Me)=>D($e,Object.assign({},Me,{ref:B})):he.cloneElement(D,{ref:B})})}const Ak=["component"];function Mk(i,n){if(i==null)return{};var o={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;o[h]=i[h]}return o}const Ck=he.forwardRef((i,n)=>{let{component:o}=i,h=Mk(i,Ak);const p=Ek(h);return ae.jsx(o,Object.assign({ref:n},p))});function Dk({in:i,onTransition:n}){const o=he.useRef(null),h=he.useRef(!0),p=Ru(n);return Y1(()=>{if(!o.current)return;let _=!1;return p({in:i,element:o.current,initial:h.current,isStale:()=>_}),()=>{_=!0}},[i,p]),Y1(()=>(h.current=!1,()=>{h.current=!0}),[]),o}function kk({children:i,in:n,onExited:o,onEntered:h,transition:p}){const[_,v]=he.useState(!n);n&&_&&v(!1);const c=Dk({in:!!n,onTransition:I=>{const P=()=>{I.isStale()||(I.in?h==null||h(I.element,I.initial):(v(!0),o==null||o(I.element)))};Promise.resolve(p(I)).then(P,B=>{throw I.in||v(!0),B})}}),D=_v(c,pg(i));return _&&!n?null:he.cloneElement(i,{ref:D})}function Nx(i,n,o){return i?ae.jsx(Ck,Object.assign({},o,{component:i})):n?ae.jsx(kk,Object.assign({},o,{transition:n})):ae.jsx(wk,Object.assign({},o))}const Ik=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Rk(i,n){if(i==null)return{};var o={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;o[h]=i[h]}return o}let hx;function zk(i){return hx||(hx=new Db({ownerDocument:i==null?void 0:i.document})),hx}function Nk(i){const n=Eb(),o=i||zk(n),h=he.useRef({dialog:null,backdrop:null});return Object.assign(h.current,{add:()=>o.add(h.current),remove:()=>o.remove(h.current),isTopModal:()=>o.isTopModal(h.current),setDialogRef:he.useCallback(p=>{h.current.dialog=p},[]),setBackdropRef:he.useCallback(p=>{h.current.backdrop=p},[])})}const DT=he.forwardRef((i,n)=>{let{show:o=!1,role:h="dialog",className:p,style:_,children:v,backdrop:c=!0,keyboard:D=!0,onBackdropClick:I,onEscapeKeyDown:P,transition:B,runTransition:U,backdropTransition:Z,runBackdropTransition:ne,autoFocus:ye=!0,enforceFocus:me=!0,restoreFocus:Pe=!0,restoreFocusOptions:tt,renderDialog:Je,renderBackdrop:$e=Pn=>ae.jsx("div",Object.assign({},Pn)),manager:Me,container:Ve,onShow:ct,onHide:ot=()=>{},onExit:Re,onExited:mt,onExiting:It,onEnter:Lt,onEntering:Ut,onEntered:sn}=i,on=Rk(i,Ik);const Ye=Eb(),gt=zx(Ve),_t=Nk(Me),qt=sT(),Ce=zC(o),[ut,wt]=he.useState(!o),Mt=he.useRef(null);he.useImperativeHandle(n,()=>_t,[_t]),fv&&!Ce&&o&&(Mt.current=cx(Ye==null?void 0:Ye.document)),o&&ut&&wt(!1);const Rt=Ru(()=>{if(_t.add(),Ca.current=Fh(document,"keydown",zn),Gn.current=Fh(document,"focus",()=>setTimeout(Wt),!0),ct&&ct(),ye){var Pn,Wa;const qn=cx((Pn=(Wa=_t.dialog)==null?void 0:Wa.ownerDocument)!=null?Pn:Ye==null?void 0:Ye.document);_t.dialog&&qn&&!$0(_t.dialog,qn)&&(Mt.current=qn,_t.dialog.focus())}}),Jt=Ru(()=>{if(_t.remove(),Ca.current==null||Ca.current(),Gn.current==null||Gn.current(),Pe){var Pn;(Pn=Mt.current)==null||Pn.focus==null||Pn.focus(tt),Mt.current=null}});he.useEffect(()=>{!o||!gt||Rt()},[o,gt,Rt]),he.useEffect(()=>{ut&&Jt()},[ut,Jt]),xk(()=>{Jt()});const Wt=Ru(()=>{if(!me||!qt()||!_t.isTopModal())return;const Pn=cx(Ye==null?void 0:Ye.document);_t.dialog&&Pn&&!$0(_t.dialog,Pn)&&_t.dialog.focus()}),Ri=Ru(Pn=>{Pn.target===Pn.currentTarget&&(I==null||I(Pn),c===!0&&ot())}),zn=Ru(Pn=>{D&&K2(Pn)&&_t.isTopModal()&&(P==null||P(Pn),Pn.defaultPrevented||ot())}),Gn=he.useRef(),Ca=he.useRef(),Hi=(...Pn)=>{wt(!0),mt==null||mt(...Pn)};if(!gt)return null;const Xa=Object.assign({role:h,ref:_t.setDialogRef,"aria-modal":h==="dialog"?!0:void 0},on,{style:_,className:p,tabIndex:-1});let Xn=Je?Je(Xa):ae.jsx("div",Object.assign({},Xa,{children:he.cloneElement(v,{role:"document"})}));Xn=Nx(B,U,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!o,onExit:Re,onExiting:It,onExited:Hi,onEnter:Lt,onEntering:Ut,onEntered:sn,children:Xn});let br=null;return c&&(br=$e({ref:_t.setBackdropRef,onClick:Ri}),br=Nx(Z,ne,{in:!!o,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:br})),ae.jsx(ae.Fragment,{children:wp.createPortal(ae.jsxs(ae.Fragment,{children:[br,Xn]}),gt)})});DT.displayName="Modal";const Pk=Object.assign(DT,{Manager:Db});function Px(i,n){return i.classList?!!n&&i.classList.contains(n):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+n+" ")!==-1}function Lk(i,n){i.classList?i.classList.add(n):Px(i,n)||(typeof i.className=="string"?i.className=i.className+" "+n:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+n))}function cw(i,n){return i.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Ok(i,n){i.classList?i.classList.remove(n):typeof i.className=="string"?i.className=cw(i.className,n):i.setAttribute("class",cw(i.className&&i.className.baseVal||"",n))}const Bm={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class kT extends Db{adjustAndStore(n,o,h){const p=o.style[n];o.dataset[n]=p,$h(o,{[n]:`${parseFloat($h(o,n))+h}px`})}restore(n,o){const h=o.dataset[n];h!==void 0&&(delete o.dataset[n],$h(o,{[n]:h}))}setContainerStyle(n){super.setContainerStyle(n);const o=this.getElement();if(Lk(o,"modal-open"),!n.scrollBarWidth)return;const h=this.isRTL?"paddingLeft":"paddingRight",p=this.isRTL?"marginLeft":"marginRight";jm(o,Bm.FIXED_CONTENT).forEach(_=>this.adjustAndStore(h,_,n.scrollBarWidth)),jm(o,Bm.STICKY_CONTENT).forEach(_=>this.adjustAndStore(p,_,-n.scrollBarWidth)),jm(o,Bm.NAVBAR_TOGGLER).forEach(_=>this.adjustAndStore(p,_,n.scrollBarWidth))}removeContainerStyle(n){super.removeContainerStyle(n);const o=this.getElement();Ok(o,"modal-open");const h=this.isRTL?"paddingLeft":"paddingRight",p=this.isRTL?"marginLeft":"marginRight";jm(o,Bm.FIXED_CONTENT).forEach(_=>this.restore(h,_)),jm(o,Bm.STICKY_CONTENT).forEach(_=>this.restore(p,_)),jm(o,Bm.NAVBAR_TOGGLER).forEach(_=>this.restore(p,_))}}let dx;function jk(i){return dx||(dx=new kT(i)),dx}const IT=he.createContext({onHide(){}}),RT=he.forwardRef(({closeLabel:i="Close",closeVariant:n,closeButton:o=!1,onHide:h,children:p,..._},v)=>{const c=he.useContext(IT),D=A_(()=>{c==null||c.onHide(),h==null||h()});return ae.jsxs("div",{ref:v,..._,children:[p,o&&ae.jsx(gb,{"aria-label":i,variant:n,onClick:D})]})});RT.displayName="AbstractModalHeader";const zT=he.forwardRef(({bsPrefix:i,className:n,as:o,...h},p)=>{i=Yn(i,"navbar-brand");const _=o||(h.href?"a":"span");return ae.jsx(_,{...h,ref:p,className:kn(n,i)})});zT.displayName="NavbarBrand";const NT=he.forwardRef(({children:i,bsPrefix:n,...o},h)=>{n=Yn(n,"navbar-collapse");const p=he.useContext(D_);return ae.jsx(fb,{in:!!(p&&p.expanded),...o,children:ae.jsx("div",{ref:h,className:n,children:i})})});NT.displayName="NavbarCollapse";const PT=he.forwardRef(({bsPrefix:i,className:n,children:o,label:h="Toggle navigation",as:p="button",onClick:_,...v},c)=>{i=Yn(i,"navbar-toggler");const{onToggle:D,expanded:I}=he.useContext(D_)||{},P=A_(B=>{_&&_(B),D&&D()});return p==="button"&&(v.type="button"),ae.jsx(p,{...v,ref:c,onClick:P,"aria-label":h,className:kn(n,i,!I&&"collapsed"),children:o||ae.jsx("span",{className:`${i}-icon`})})});PT.displayName="NavbarToggle";const Lx=new WeakMap,uw=(i,n)=>{if(!i||!n)return;const o=Lx.get(n)||new Map;Lx.set(n,o);let h=o.get(i);return h||(h=n.matchMedia(i),h.refCount=0,o.set(h.media,h)),h};function Bk(i,n=typeof window>"u"?void 0:window){const o=uw(i,n),[h,p]=he.useState(()=>o?o.matches:!1);return vT(()=>{let _=uw(i,n);if(!_)return p(!1);let v=Lx.get(n);const c=()=>{p(_.matches)};return _.refCount++,_.addListener(c),c(),()=>{_.removeListener(c),_.refCount--,_.refCount<=0&&(v==null||v.delete(_.media)),_=void 0}},[i]),h}function Fk(i){const n=Object.keys(i);function o(c,D){return c===D?D:c?`${c} and ${D}`:D}function h(c){return n[Math.min(n.indexOf(c)+1,n.length-1)]}function p(c){const D=h(c);let I=i[D];return typeof I=="number"?I=`${I-.2}px`:I=`calc(${I} - 0.2px)`,`(max-width: ${I})`}function _(c){let D=i[c];return typeof D=="number"&&(D=`${D}px`),`(min-width: ${D})`}function v(c,D,I){let P;typeof c=="object"?(P=c,I=D,D=!0):(D=D||!0,P={[c]:D});let B=he.useMemo(()=>Object.entries(P).reduce((U,[Z,ne])=>((ne==="up"||ne===!0)&&(U=o(U,_(Z))),(ne==="down"||ne===!0)&&(U=o(U,p(Z))),U),""),[JSON.stringify(P)]);return Bk(B,I)}return v}const Uk=Fk({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),LT=he.forwardRef(({className:i,bsPrefix:n,as:o="div",...h},p)=>(n=Yn(n,"offcanvas-body"),ae.jsx(o,{ref:p,className:kn(i,n),...h})));LT.displayName="OffcanvasBody";const Vk={[Uc]:"show",[Lh]:"show"},OT=he.forwardRef(({bsPrefix:i,className:n,children:o,in:h=!1,mountOnEnter:p=!1,unmountOnExit:_=!1,appear:v=!1,...c},D)=>(i=Yn(i,"offcanvas"),ae.jsx(pv,{ref:D,addEndListener:db,in:h,mountOnEnter:p,unmountOnExit:_,appear:v,...c,childRef:pg(o),children:(I,P)=>he.cloneElement(o,{...P,className:kn(n,o.props.className,(I===Uc||I===c_)&&`${i}-toggling`,Vk[I])})})));OT.displayName="OffcanvasToggling";const jT=he.forwardRef(({bsPrefix:i,className:n,closeLabel:o="Close",closeButton:h=!1,...p},_)=>(i=Yn(i,"offcanvas-header"),ae.jsx(RT,{ref:_,...p,className:kn(n,i),closeLabel:o,closeButton:h})));jT.displayName="OffcanvasHeader";const Gk=IC("h5"),BT=he.forwardRef(({className:i,bsPrefix:n,as:o=Gk,...h},p)=>(n=Yn(n,"offcanvas-title"),ae.jsx(o,{ref:p,className:kn(i,n),...h})));BT.displayName="OffcanvasTitle";function Zk(i){return ae.jsx(OT,{...i})}function $k(i){return ae.jsx(G0,{...i})}const FT=he.forwardRef(({bsPrefix:i,className:n,children:o,"aria-labelledby":h,placement:p="start",responsive:_,show:v=!1,backdrop:c=!0,keyboard:D=!0,scroll:I=!1,onEscapeKeyDown:P,onShow:B,onHide:U,container:Z,autoFocus:ne=!0,enforceFocus:ye=!0,restoreFocus:me=!0,restoreFocusOptions:Pe,onEntered:tt,onExit:Je,onExiting:$e,onEnter:Me,onEntering:Ve,onExited:ct,backdropClassName:ot,manager:Re,renderStaticNode:mt=!1,...It},Lt)=>{const Ut=he.useRef();i=Yn(i,"offcanvas");const[sn,on]=he.useState(!1),Ye=A_(U),gt=Uk(_||"xs","up");he.useEffect(()=>{on(_?v&&!gt:v)},[v,_,gt]);const _t=he.useMemo(()=>({onHide:Ye}),[Ye]);function qt(){return Re||(I?(Ut.current||(Ut.current=new kT({handleContainerOverflow:!1})),Ut.current):jk())}const Ce=(Rt,...Jt)=>{Rt&&(Rt.style.visibility="visible"),Me==null||Me(Rt,...Jt)},ut=(Rt,...Jt)=>{Rt&&(Rt.style.visibility=""),ct==null||ct(...Jt)},wt=he.useCallback(Rt=>ae.jsx("div",{...Rt,className:kn(`${i}-backdrop`,ot)}),[ot,i]),Mt=Rt=>ae.jsx("div",{...Rt,...It,className:kn(n,_?`${i}-${_}`:i,`${i}-${p}`),"aria-labelledby":h,children:o});return ae.jsxs(ae.Fragment,{children:[!sn&&(_||mt)&&Mt({}),ae.jsx(IT.Provider,{value:_t,children:ae.jsx(Pk,{show:sn,ref:Lt,backdrop:c,container:Z,keyboard:D,autoFocus:ne,enforceFocus:ye&&!I,restoreFocus:me,restoreFocusOptions:Pe,onEscapeKeyDown:P,onShow:B,onHide:Ye,onEnter:Ce,onEntering:Ve,onEntered:tt,onExit:Je,onExiting:$e,onExited:ut,manager:qt(),transition:Zk,backdropTransition:$k,renderBackdrop:wt,renderDialog:Mt})})]})});FT.displayName="Offcanvas";const Yk=Object.assign(FT,{Body:LT,Header:jT,Title:BT}),UT=he.forwardRef(({onHide:i,...n},o)=>{const h=he.useContext(D_),p=A_(()=>{h==null||h.onToggle==null||h.onToggle(),i==null||i()});return ae.jsx(Yk,{ref:o,show:!!(h!=null&&h.expanded),...n,renderStaticNode:!0,onHide:p})});UT.displayName="NavbarOffcanvas";const VT=he.forwardRef(({className:i,bsPrefix:n,as:o="span",...h},p)=>(n=Yn(n,"navbar-text"),ae.jsx(o,{ref:p,className:kn(i,n),...h})));VT.displayName="NavbarText";const GT=he.forwardRef((i,n)=>{const{bsPrefix:o,expand:h=!0,variant:p="light",bg:_,fixed:v,sticky:c,className:D,as:I="nav",expanded:P,onToggle:B,onSelect:U,collapseOnSelect:Z=!1,...ne}=X2(i,{expanded:"onToggle"}),ye=Yn(o,"navbar"),me=he.useCallback((...Je)=>{U==null||U(...Je),Z&&P&&(B==null||B(!1))},[U,Z,P,B]);ne.role===void 0&&I!=="nav"&&(ne.role="navigation");let Pe=`${ye}-expand`;typeof h=="string"&&(Pe=`${Pe}-${h}`);const tt=he.useMemo(()=>({onToggle:()=>B==null?void 0:B(!P),bsPrefix:ye,expanded:!!P,expand:h}),[ye,P,h,B]);return ae.jsx(D_.Provider,{value:tt,children:ae.jsx(ck.Provider,{value:me,children:ae.jsx(I,{ref:n,...ne,className:kn(D,ye,h&&Pe,p&&`${ye}-${p}`,_&&`bg-${_}`,c&&`sticky-${c}`,v&&`fixed-${v}`)})})})});GT.displayName="Navbar";const qk=Object.assign(GT,{Brand:zT,Collapse:NT,Offcanvas:UT,Text:VT,Toggle:PT}),Hk=()=>{};function Xk(i,n,{disabled:o,clickTrigger:h}={}){const p=n||Hk;ak(i,p,{disabled:o,clickTrigger:h});const _=Ru(v=>{K2(v)&&p(v)});he.useEffect(()=>{if(o||i==null)return;const v=S_(j0(i));let c=(v.defaultView||window).event;const D=Fh(v,"keyup",I=>{if(I===c){c=void 0;return}_(I)});return()=>{D()}},[i,o,_])}const ZT=he.forwardRef((i,n)=>{const{flip:o,offset:h,placement:p,containerPadding:_,popperConfig:v={},transition:c,runTransition:D}=i,[I,P]=$1(),[B,U]=$1(),Z=_v(P,n),ne=zx(i.container),ye=zx(i.target),[me,Pe]=he.useState(!i.show),tt=JD(ye,I,lk({placement:p,enableEvents:!!i.show,containerPadding:_||5,flip:o,offset:h,arrowElement:B,popperConfig:v}));i.show&&me&&Pe(!1);const Je=(...It)=>{Pe(!0),i.onExited&&i.onExited(...It)},$e=i.show||!me;if(Xk(I,i.onHide,{disabled:!i.rootClose||i.rootCloseDisabled,clickTrigger:i.rootCloseEvent}),!$e)return null;const{onExit:Me,onExiting:Ve,onEnter:ct,onEntering:ot,onEntered:Re}=i;let mt=i.children(Object.assign({},tt.attributes.popper,{style:tt.styles.popper,ref:Z}),{popper:tt,placement:p,show:!!i.show,arrowProps:Object.assign({},tt.attributes.arrow,{style:tt.styles.arrow,ref:U})});return mt=Nx(c,D,{in:!!i.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:mt,onExit:Me,onExiting:Ve,onExited:Je,onEnter:ct,onEntering:ot,onEntered:Re}),ne?wp.createPortal(mt,ne):null});ZT.displayName="Overlay";const $T=he.forwardRef(({className:i,bsPrefix:n,as:o="div",...h},p)=>(n=Yn(n,"popover-header"),ae.jsx(o,{ref:p,className:kn(i,n),...h})));$T.displayName="PopoverHeader";const kb=he.forwardRef(({className:i,bsPrefix:n,as:o="div",...h},p)=>(n=Yn(n,"popover-body"),ae.jsx(o,{ref:p,className:kn(i,n),...h})));kb.displayName="PopoverBody";function YT(i,n){let o=i;return i==="left"?o=n?"end":"start":i==="right"&&(o=n?"start":"end"),o}function qT(i="absolute"){return{position:i,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const HT=he.forwardRef(({bsPrefix:i,placement:n="right",className:o,style:h,children:p,body:_,arrowProps:v,hasDoneInitialMeasure:c,popper:D,show:I,...P},B)=>{const U=Yn(i,"popover"),Z=W2(),[ne]=(n==null?void 0:n.split("-"))||[],ye=YT(ne,Z);let me=h;return I&&!c&&(me={...h,...qT(D==null?void 0:D.strategy)}),ae.jsxs("div",{ref:B,role:"tooltip",style:me,"x-placement":ne,className:kn(o,U,ne&&`bs-popover-${ye}`),...P,children:[ae.jsx("div",{className:"popover-arrow",...v}),_?ae.jsx(kb,{children:p}):p]})});HT.displayName="Popover";const Wk=Object.assign(HT,{Header:$T,Body:kb,POPPER_OFFSET:[0,8]}),XT=he.forwardRef(({bsPrefix:i,placement:n="right",className:o,style:h,children:p,arrowProps:_,hasDoneInitialMeasure:v,popper:c,show:D,...I},P)=>{i=Yn(i,"tooltip");const B=W2(),[U]=(n==null?void 0:n.split("-"))||[],Z=YT(U,B);let ne=h;return D&&!v&&(ne={...h,...qT(c==null?void 0:c.strategy)}),ae.jsxs("div",{ref:P,style:ne,role:"tooltip","x-placement":U,className:kn(o,i,`bs-tooltip-${Z}`),...I,children:[ae.jsx("div",{className:"tooltip-arrow",..._}),ae.jsx("div",{className:`${i}-inner`,children:p})]})});XT.displayName="Tooltip";const Qk=Object.assign(XT,{TOOLTIP_OFFSET:[0,6]});function Kk(i){const n=he.useRef(null),o=Yn(void 0,"popover"),h=Yn(void 0,"tooltip"),p=he.useMemo(()=>({name:"offset",options:{offset:()=>{if(i)return i;if(n.current){if(Px(n.current,o))return Wk.POPPER_OFFSET;if(Px(n.current,h))return Qk.TOOLTIP_OFFSET}return[0,0]}}}),[i,o,h]);return[n,[p]]}function Jk(i,n){const{ref:o}=i,{ref:h}=n;i.ref=o.__wrapped||(o.__wrapped=p=>o(kx(p))),n.ref=h.__wrapped||(h.__wrapped=p=>h(kx(p)))}const WT=he.forwardRef(({children:i,transition:n=G0,popperConfig:o={},rootClose:h=!1,placement:p="top",show:_=!1,...v},c)=>{const D=he.useRef({}),[I,P]=he.useState(null),[B,U]=Kk(v.offset),Z=eT(c,B),ne=n===!0?G0:n||void 0,ye=A_(me=>{P(me),o==null||o.onFirstUpdate==null||o.onFirstUpdate(me)});return vT(()=>{I&&v.target&&(D.current.scheduleUpdate==null||D.current.scheduleUpdate())},[I,v.target]),he.useEffect(()=>{_||P(null)},[_]),ae.jsx(ZT,{...v,ref:Z,popperConfig:{...o,modifiers:U.concat(o.modifiers||[]),onFirstUpdate:ye},transition:ne,rootClose:h,placement:p,show:_,children:(me,{arrowProps:Pe,popper:tt,show:Je})=>{var $e;Jk(me,Pe);const Me=tt==null?void 0:tt.placement,Ve=Object.assign(D.current,{state:tt==null?void 0:tt.state,scheduleUpdate:tt==null?void 0:tt.update,placement:Me,outOfBoundaries:(tt==null||($e=tt.state)==null||($e=$e.modifiersData.hide)==null?void 0:$e.isReferenceHidden)||!1,strategy:o.strategy}),ct=!!I;return typeof i=="function"?i({...me,placement:Me,show:Je,...!n&&Je&&{className:"show"},popper:Ve,arrowProps:Pe,hasDoneInitialMeasure:ct}):he.cloneElement(i,{...me,placement:Me,arrowProps:Pe,popper:Ve,hasDoneInitialMeasure:ct,className:kn(i.props.className,!n&&Je&&"show"),style:{...i.props.style,...me.style}})}})});WT.displayName="Overlay";const QT=he.forwardRef(({bsPrefix:i,variant:n,animation:o="border",size:h,as:p="div",className:_,...v},c)=>{i=Yn(i,"spinner");const D=`${i}-${o}`;return ae.jsx(p,{ref:c,...v,className:kn(_,D,h&&`${D}-${h}`,n&&`text-${n}`)})});QT.displayName="Spinner";const KT=he.forwardRef(({bsPrefix:i,className:n,striped:o,bordered:h,borderless:p,hover:_,size:v,variant:c,responsive:D,...I},P)=>{const B=Yn(i,"table"),U=kn(n,B,c&&`${B}-${c}`,v&&`${B}-${v}`,o&&`${B}-${typeof o=="string"?`striped-${o}`:"striped"}`,h&&`${B}-bordered`,p&&`${B}-borderless`,_&&`${B}-hover`),Z=ae.jsx("table",{...I,className:U,ref:P});if(D){let ne=`${B}-responsive`;return typeof D=="string"&&(ne=`${ne}-${D}`),ae.jsx("div",{className:ne,children:Z})}return Z});KT.displayName="Table";function eI({tripQueryVariables:i,setTripQueryVariables:n,coordinates:o,onClose:h}){return ae.jsx(i2,{longitude:o.lng,latitude:o.lat,anchor:"bottom",onClose:h,children:ae.jsxs(yb,{vertical:!0,children:[ae.jsx(kp,{onClick:()=>{n({...i,from:{coordinates:{latitude:o.lat,longitude:o.lng}}}),h()},children:"Start here"}),ae.jsx(kp,{onClick:()=>{n({...i,to:{coordinates:{latitude:o.lat,longitude:o.lng}}}),h()},children:"End here"})]})})}function tI({coordinates:i,properties:n,onClose:o}){return ae.jsxs(i2,{latitude:i.lat,longitude:i.lng,closeButton:!0,onClose:()=>o(),maxWidth:"350px",children:[ae.jsx(KT,{bordered:!0,children:ae.jsx("tbody",{children:Object.entries(n).map(([h,p])=>ae.jsxs("tr",{children:[ae.jsx("th",{scope:"row",children:h}),ae.jsx("td",{children:String(p)})]},h))})}),ae.jsx("div",{className:"geometry-popup-osm-link",children:ae.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${i.lat}&mlon=${i.lng}#map=18/${i.lat}/${i.lng}`,target:"_blank",rel:"noreferrer",children:"↗️ osm.org"})})]})}const JT=i=>{const n=i.getStyle();return!n||!n.layers?[]:n.layers.filter(o=>o.type!=="raster"&&!o.id.startsWith("jsx")).filter(o=>i.getLayoutProperty(o.id,"visibility")!=="none").map(o=>o.id)},nI=({mapRef:i,setInteractiveLayerIds:n})=>{const[o,h]=he.useState([]),[p,_]=he.useState({});he.useEffect(()=>{if(!i)return;const D=i.getMap(),I=()=>{const P=D.getStyle();if(!P||!P.layers)return;const B=P.layers.filter(Z=>Z.type==="raster").map(Z=>{var me;let ne=Z.id;const ye=(me=Z.metadata)==null?void 0:me.name;return ye&&(ne=ye),{id:Z.id,name:ne}});h(B);const U={};P.layers.filter(Z=>Z.type!=="raster"&&!Z.id.startsWith("jsx")).reverse().forEach(Z=>{var ye;const ne=((ye=Z.metadata)==null?void 0:ye.group)||"Misc";U[ne]||(U[ne]=[]),U[ne].push({id:Z.id,name:Z.id})}),_(U)};return D.isStyleLoaded()?I():D.on("styledata",I),()=>{D.off("styledata",I)}},[i]);const v=he.useCallback((D,I)=>{if(!i)return;const P=i.getMap();P.setLayoutProperty(D,"visibility",I?"visible":"none");const B=JT(P);n(B)},[i,n]),c=he.useCallback(D=>{if(!i)return;const I=i.getMap();o.forEach(P=>{I.setLayoutProperty(P.id,"visibility",P.id===D?"visible":"none")})},[i,o]);return ae.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[ae.jsx("h4",{style:{marginTop:0},children:"Background"}),ae.jsx("select",{onChange:D=>c(D.target.value),children:o.map(D=>ae.jsx("option",{value:D.id,children:D.name},D.id))}),ae.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(p).map(([D,I])=>{const P=I.every(U=>(i==null?void 0:i.getMap().getLayoutProperty(U.id,"visibility"))!=="none"),B=U=>{I.forEach(Z=>{v(Z.id,U)})};return ae.jsxs("div",{style:{marginBottom:"10px"},children:[ae.jsx("h6",{style:{margin:"0 0 5px"},children:ae.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[ae.jsx("input",{type:"checkbox",checked:P,onChange:U=>B(U.target.checked),style:{marginRight:"5px"}}),D]})}),I.map(U=>{const Z=(i==null?void 0:i.getMap().getLayoutProperty(U.id,"visibility"))!=="none";return ae.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[ae.jsx("input",{type:"checkbox",checked:Z,onChange:ne=>v(U.id,ne.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),U.name]},U.id)})]},D)})]})},iI="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class rI extends he.Component{constructor(o){super(o);vp(this,"toggleSidebar",o=>{this.setState(h=>({isSidebarOpen:h.activeContent!==o||!h.isSidebarOpen,activeContent:h.activeContent===o?null:o}))});this.state={isSidebarOpen:!1,activeContent:null}}render(){const{isSidebarOpen:o,activeContent:h}=this.state,{position:p,setInteractiveLayerIds:_,mapRef:v}=this.props;return ae.jsxs("div",{children:[ae.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${h==="debugLayer"?"active":""} ${o?"open":""}`,style:{top:"20px"},children:ae.jsx("img",{src:iI,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),ae.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:o?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:o?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:o&&h==="debugLayer"&&ae.jsx(nI,{position:p,setInteractiveLayerIds:_,mapRef:v})})]})}}const aI="/otp/debug/vectortiles/style.json";function sI({tripQueryVariables:i,setTripQueryVariables:n,tripQueryResult:o,selectedTripPatternIndex:h,loading:p}){var Me,Ve;const _=XM({tripQueryVariables:i,setTripQueryVariables:n}),[v,c]=he.useState(null),[D,I]=he.useState(null),[P,B]=he.useState([]),[U,Z]=he.useState("auto"),ne=he.useCallback(()=>Z("pointer"),[]),ye=he.useCallback(()=>Z("auto"),[]),me=ct=>{if(ct.features){const ot=ct.features[0];I({coordinates:ct.lngLat,feature:ot})}},Pe=ct=>{const ot=ct.target;if(ot.getZoom()<2){const Re=ot.getSource("stops");ot.fitBounds(Re.bounds,{animate:!1})}},tt=ct=>{ct.target.addControl(new s2.AttributionControl,"bottom-left")};function Je(ct){Pe(ct);const ot=JT(ct.target);B(ot),tt(ct)}const $e=he.useRef(null);return ae.jsx("div",{className:"map-container below-content",children:ae.jsxs(OE,{attributionControl:!1,mapLib:t2(()=>Promise.resolve().then(()=>o2),void 0),mapStyle:aI,onDblClick:_,onContextMenu:ct=>{c(ct.lngLat)},interactiveLayerIds:P,cursor:U,onMouseEnter:ne,onMouseLeave:ye,onClick:me,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:Je,ref:$e,children:[ae.jsx(GE,{position:"top-left"}),ae.jsx(GM,{setCursor:Z,tripQueryVariables:i,setTripQueryVariables:n,loading:p}),ae.jsx(rI,{position:"top-right",setInteractiveLayerIds:B,mapRef:$e==null?void 0:$e.current}),(o==null?void 0:o.trip.tripPatterns.length)&&ae.jsx(YM,{tripPattern:o.trip.tripPatterns[h]}),v&&ae.jsx(eI,{tripQueryVariables:i,setTripQueryVariables:n,coordinates:v,onClose:()=>c(null)}),((Me=D==null?void 0:D.feature)==null?void 0:Me.properties)&&ae.jsx(tI,{coordinates:D==null?void 0:D.coordinates,properties:(Ve=D==null?void 0:D.feature)==null?void 0:Ve.properties,onClose:()=>I(null)})]})})}function oI(){const[i,n]=he.useState(0),o=he.useRef(null);return he.useLayoutEffect(()=>{o.current&&n(o.current.getBoundingClientRect().width)},[]),he.useEffect(()=>{const h=()=>{o.current&&n(o.current.getBoundingClientRect().width)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),{containerRef:o,containerWidth:i}}const lI=70,cI=20,Ox=40;function uI(i,n,o,h){const p=he.useMemo(()=>new Date(h).getTime()-new Date(o).getTime(),[o,h]),_=he.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(o).getTime())/p,[i.expectedStartTime,o,p]),v=he.useMemo(()=>new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime(),[i.expectedStartTime,i.expectedEndTime]),c=cI+Ox,I=n-lI-Ox-c,P=c+_*I,B=I*(v/p);return{maxSpan:p,startPx:c,pxSpan:I,widthPx:B,leftPx:P}}const hI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",dI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",fI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",pI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",mI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",gI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",yI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",_I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",vI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",xI="https://www.opentripplanner.org/debug-client-assets/2025/06/2025-06-19T11:08/assets/monorail-CEIE-7ZV.png",bI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",wI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",TI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",SI="https://www.opentripplanner.org/debug-client-assets/2025/06/2025-06-19T11:08/assets/trolleybus-BefhFtdd.png",EI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function AI(i){return i===Di.Rail||i===Di.Coach||i===Di.Metro||i===Di.Bus||i===Di.Tram||i===Di.Water||i===Di.Air||i===Di.Cableway||i===Di.Funicular||i===Di.Trolleybus||i===Di.Monorail||i===Di.Taxi}function MI(i){const n=CI(i);function o(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const h=o(n[0]/255),p=o(n[1]/255),_=o(n[2]/255);return .2126*h+.7152*p+.0722*_>.179?"#000":"#fff"}function CI(i){return DI(i)}function DI(i){return i.length===4?kI(i):[parseInt(i.slice(1,3),16),parseInt(i.slice(3,5),16),parseInt(i.slice(5,7),16)]}function kI(i){const n=i.slice(1,2),o=i.slice(2,3),h=i.slice(3,4);return[parseInt(n+n,16),parseInt(o+o,16),parseInt(h+h,16)]}function II(i,n,o,h,p){var B;const _=he.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(n).getTime())/o,[i.expectedStartTime,n,o]),v=he.useMemo(()=>p*(new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime())/o-1,[p,i,o]),c=h+_*p+1,D=v>40&&AI(i.mode)&&((B=i.line)==null?void 0:B.publicCode)&&i.line.publicCode.length<=6,I=Y2(i),P=he.useMemo(()=>MI(I),[I]);return{widthPx:v,leftPx:c,legTextColor:P,modeColor:I,showPublicCode:D}}const RI=Object.assign({"../../static/img/mode/air.png":hI,"../../static/img/mode/bicycle.png":dI,"../../static/img/mode/bus.png":fI,"../../static/img/mode/cableway.png":pI,"../../static/img/mode/car.png":mI,"../../static/img/mode/coach.png":gI,"../../static/img/mode/foot.png":yI,"../../static/img/mode/funicular.png":_I,"../../static/img/mode/metro.png":vI,"../../static/img/mode/monorail.png":xI,"../../static/img/mode/rail.png":bI,"../../static/img/mode/taxi.png":wI,"../../static/img/mode/tram.png":TI,"../../static/img/mode/trolleybus.png":SI,"../../static/img/mode/water.png":EI});function zI(i){return RI[`../../static/img/mode/${i.mode.toLowerCase()}.png`]}function NI({leg:i,earliestStartTime:n,maxSpan:o,startPx:h,pxSpan:p}){var B;const{widthPx:_,leftPx:v,legTextColor:c,modeColor:D,showPublicCode:I}=II(i,n,o,h,p),P=zI(i);return ae.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${_}px`,left:v,color:c,background:D},children:[ae.jsx("div",{className:"itinerary-header-leg-icon",style:{background:c,maskImage:`url(${P})`,WebkitMaskImage:`url(${P})`}}),I&&ae.jsx("span",{className:"itinerary-header-leg-public-code",children:(B=i.line)==null?void 0:B.publicCode})]})}function e_(i,n,o){return new Date(i).toLocaleTimeString("en-US",{timeStyle:o,hourCycle:"h24",timeZone:n})}const k_=he.createContext("UTC");function PI({tripPattern:i,itineraryIndex:n,containerWidth:o,earliestStartTime:h,latestEndTime:p}){const{maxSpan:_,pxSpan:v,startPx:c,widthPx:D,leftPx:I}=uI(i,o,h,p),P=he.useContext(k_),B=he.useMemo(()=>e_(i.expectedStartTime,P,"short"),[i.expectedStartTime,P]),U=he.useMemo(()=>e_(i.expectedEndTime,P,"short"),[i.expectedEndTime,P]);return ae.jsxs("div",{className:"itinerary-header-wrapper",children:[ae.jsxs("div",{className:"itinerary-header-itinerary-number",children:[n+1,"."]}),ae.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${D+5}px`,left:`${I-2}px`}}),ae.jsx("div",{title:i.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${I-Ox}px`},children:B}),i.legs.map((Z,ne)=>ae.jsx(NI,{leg:Z,earliestStartTime:h,startPx:c,maxSpan:_,pxSpan:v},Z.id||`leg_${ne}`)),ae.jsx("div",{title:i.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${I+D+2}px`},children:U})]})}function LI(i){const n=he.useMemo(()=>(i==null?void 0:i.trip.tripPatterns.reduce((h,p)=>h===null?p==null?void 0:p.expectedStartTime:new Date(p==null?void 0:p.expectedStartTime)<new Date(h)?p.expectedStartTime:h,null))||null,[i==null?void 0:i.trip]),o=he.useMemo(()=>(i==null?void 0:i.trip.tripPatterns.reduce((h,p)=>h===null?p==null?void 0:p.expectedEndTime:new Date(p==null?void 0:p.expectedEndTime)>new Date(h)?p.expectedEndTime:h,null))||null,[i==null?void 0:i.trip]);return[n,o]}function hw({aimedTime:i,expectedTime:n,hasRealtime:o}){const h=he.useContext(k_);return i!==n?ae.jsxs(ae.Fragment,{children:[ae.jsx("span",{title:n,style:{color:"red"},children:e_(n,h,"short")}),ae.jsx("span",{title:i,style:{textDecoration:"line-through"},children:e_(i,h,"short")})]}):ae.jsxs("span",{title:n,children:[e_(n,h,"short"),o&&ae.jsx("span",{children:" (on time)"})]})}function OI(i){const n=i/1e3;return n>100?`${n.toFixed(0)} km`:n>1?`${n.toFixed(1)} km`:`${i.toFixed(0)} m`}function jI(i){const n=Math.floor(i/3600),o=Math.floor(i/60)%60,h=i%60;let p="";return n>0&&(p=`${p}${n}h `),o>0&&(p=`${p}${o}min `),h>1&&(p=`${p}${h}s`),p}const BI="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function FI({leg:i}){var n;return(n=i.interchangeFrom)!=null&&n.staySeated?ae.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:BI,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const UI=fg(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),VI=rl(UI),GI="/graphiql?flavor=transmodel";function ZI({legId:i,legName:n}){const o={id:i},h=encodeURIComponent(VI),p=encodeURIComponent(JSON.stringify(o));return ae.jsx("a",{href:GI+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}const $I=fg(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),YI=rl($I),qI="/graphiql?flavor=transmodel";function dw({legId:i,legName:n}){const o={id:i},h=encodeURIComponent(YI),p=encodeURIComponent(JSON.stringify(o));return ae.jsx("a",{href:qI+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}const HI=fg(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),XI=rl(HI),WI="/graphiql?flavor=transmodel";function QI({legId:i,legName:n}){const o={id:i},h=encodeURIComponent(XI),p=encodeURIComponent(JSON.stringify(o));return ae.jsx("a",{href:WI+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}function KI(i){var n,o,h,p;return(n=i.line)!=null&&n.publicCode?i.line.publicCode+" "+((h=(o=i.toEstimatedCall)==null?void 0:o.destinationDisplay)==null?void 0:h.frontText):((p=i.line)==null?void 0:p.name)||"unknown"}function JI({leg:i,isLast:n}){var o,h,p,_,v;return ae.jsxs("div",{className:"itinerary-leg-details",children:[ae.jsxs("div",{className:"times",children:[OI(i.distance),", ",jI(i.duration),","," ",ae.jsxs("span",{title:"Generalized cost: ¢"+i.generalizedCost,children:["¢",i.generalizedCost]})]}),ae.jsx(FI,{leg:i}),ae.jsx(hw,{aimedTime:i.aimedStartTime,expectedTime:i.expectedStartTime,hasRealtime:i.realtime})," -"," ",ae.jsx(hw,{aimedTime:i.aimedEndTime,expectedTime:i.expectedEndTime,hasRealtime:i.realtime}),ae.jsxs("div",{className:"mode",children:[ae.jsx("b",{children:i.mode})," ",i.line&&ae.jsxs(ae.Fragment,{children:[ae.jsx(ZI,{legId:(o=i.line)==null?void 0:o.id,legName:KI(i)}),", ",ae.jsx(QI,{legId:(h=i.authority)==null?void 0:h.id,legName:(p=i.authority)==null?void 0:p.name})]})," ",i.mode!==Di.Foot&&ae.jsxs(ae.Fragment,{children:[ae.jsx("br",{}),ae.jsx(dw,{legId:(_=i.fromPlace.quay)==null?void 0:_.id,legName:i.fromPlace.name})," →"," "]})," ",!n&&ae.jsx(dw,{legId:(v=i.toPlace.quay)==null?void 0:v.id,legName:i.toPlace.name})]})]})}function eR({tripPattern:i}){return ae.jsxs("div",{children:[i.systemNotices.length>0&&ae.jsxs("p",{children:["System tags: ",i.systemNotices.map(n=>n.tag).join(", ")]}),i.legs.map((n,o)=>ae.jsx(JI,{leg:n,isLast:o===i.legs.length-1},n.id?n.id:`noid_${o}`)),ae.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ¢",i.generalizedCost]})]})}function tR({previousPageCursor:i,nextPageCursor:n,onPagination:o,loading:h}){return ae.jsxs("div",{style:{display:"flex",justifyContent:"space-evenly"},children:[ae.jsx(kp,{variant:"outline-primary",size:"sm",disabled:!i||h,onClick:()=>{i&&o(i)},children:"Previous page"})," ",ae.jsx(kp,{variant:"outline-primary",size:"sm",disabled:!n||h,onClick:()=>{n&&o(n)},children:"Next page"})]})}function nR({tripQueryResult:i,selectedTripPatternIndex:n,setSelectedTripPatternIndex:o,pageResults:h,loading:p}){const[_,v]=LI(i),{containerRef:c,containerWidth:D}=oI(),I=he.useContext(k_);return ae.jsxs("section",{className:"left-pane-container below-content",ref:c,children:[ae.jsxs(ae.Fragment,{children:[ae.jsx("div",{className:"panel-header",children:"Itinerary results"}),ae.jsx("div",{className:"pagination-controls",children:ae.jsx(tR,{onPagination:h,previousPageCursor:i==null?void 0:i.trip.previousPageCursor,nextPageCursor:i==null?void 0:i.trip.nextPageCursor,loading:p})}),ae.jsx(I0,{activeKey:`${n}`,onSelect:P=>o(parseInt(P)),children:i&&i.trip.tripPatterns.map((P,B)=>ae.jsxs(I0.Item,{eventKey:`${B}`,bsPrefix:P.systemNotices.length===0?"":"accordion-item-filtered",children:[ae.jsx(I0.Header,{children:ae.jsx(PI,{containerWidth:D,tripPattern:P,itineraryIndex:B,earliestStartTime:_,latestEndTime:v})}),ae.jsx(I0.Body,{children:ae.jsx(eR,{tripPattern:P})})]},`${B}`))})]}),ae.jsxs("div",{className:"time-zone-info",children:["All times in ",ae.jsx("code",{children:I})]})]})}const jx=fg(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        generalizedCost
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            generalizedCost
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            toEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),iR=rl(jx),rR=i=>{const[n,o]=he.useState(null),[h,p]=he.useState(!1),_=he.useCallback(async v=>{if(h)console.warn("Wait for previous search to finish");else if(i){p(!0);try{o(v?await V0(l_(),jx,{...i,pageCursor:v}):await V0(l_(),jx,i))}catch(c){console.error("Error at useTripQuery",c)}p(!1)}else console.warn("Can't search without variables")},[o,i,h]);return he.useEffect(()=>{fw(i==null?void 0:i.from)&&fw(i==null?void 0:i.to)&&_()},[i==null?void 0:i.from,i==null?void 0:i.to]),[n,h,_]};function fw(i){return i&&(i.coordinates||i.place)}const aR=fg(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),sR=()=>{const[i,n]=he.useState(null);return he.useEffect(()=>{(async()=>{n(await V0(l_(),aR))})()},[]),i==null?void 0:i.serverInfo},oR={from:{},to:{},dateTime:new Date().toISOString()},lR=()=>{const n=new URLSearchParams(window.location.search).get("variables");return n?JSON.parse(decodeURIComponent(n)):oR},cR=i=>{const n=new URLSearchParams(window.location.search);n.set("variables",encodeURIComponent(JSON.stringify(i))),history.pushState({},"","?"+n.toString()+window.location.hash)},uR=()=>{const[i,n]=he.useState(lR());return he.useEffect(()=>{cR(i)},[i]),{tripQueryVariables:i,setTripQueryVariables:n}};function hR({target:i,serverInfo:n}){return ae.jsx(WT,{target:i.current,show:!!n,placement:"right",children:ae.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:ae.jsx("pre",{children:JSON.stringify(n,null,2)})})})}const dR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function fR({serverInfo:i}){const[n,o]=he.useState(!1),h=he.useRef(null);return ae.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[ae.jsx(qk.Brand,{onClick:()=>o(p=>!p),children:ae.jsxs("div",{ref:h,children:[ae.jsx("img",{alt:"",src:dR,width:"50",height:"50",className:"logo-image"}),"OTP Debug",n&&ae.jsx(hR,{serverInfo:i,target:h})]})}),ae.jsxs("div",{className:"details",children:[ae.jsxs("div",{children:["Version: ",i==null?void 0:i.version]}),ae.jsxs("div",{children:["Time zone: ",i==null?void 0:i.internalTransitModelTimeZone]})]})]})}const pw=7,mw="-{0,1}\\d+(\\.\\d+){0,1}",pR="("+mw+")(\\s+)("+mw+")";function mR(i){const n=i.match(pR);return n?{coordinates:{latitude:+n[1],longitude:+n[4]}}:{place:i}}function gR(i){var n,o;return i.coordinates?`${(n=i.coordinates)==null?void 0:n.latitude.toPrecision(pw)} ${(o=i.coordinates)==null?void 0:o.longitude.toPrecision(pw)}`:i.place?i.place:null}function gw({id:i,label:n,tripQueryVariables:o,setTripQueryVariables:h,locationFieldKey:p}){const[_,v]=he.useState("");he.useEffect(()=>{const D=o[p];v(gR(D)||"")},[o,p]);const c=he.useCallback(D=>{const I=mR(D)||{};h({...o,[p]:I})},[o,h,p]);return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:i,children:n}),ae.jsx(Ii.Control,{type:"text",id:i,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:D=>{v(D.target.value)},onBlur:D=>{c(D.target.value)},value:_})]})}const yR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function _R({tripQueryVariables:i,setTripQueryVariables:n}){const o=()=>{n({...i,from:i.to,to:i.from})};return ae.jsx("button",{className:"swap-from-to",onClick:o,title:"Swap from/to",children:ae.jsx("img",{alt:"Swap from/to",src:yR})})}function vR({tripQueryVariables:i,setTripQueryVariables:n}){const o=h=>{n({...i,arriveBy:h})};return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Departure/Arrival"}),ae.jsxs(Ii.Select,{size:"sm",onChange:h=>h.target.value==="arrival"?o(!0):o(!1),value:i.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[ae.jsx("option",{value:"arrival",children:"Arrive before"}),ae.jsx("option",{value:"departure",children:"Depart after"})]})]})}class Q extends Array{constructor(n,o){if(super(n),this.sign=o,Object.setPrototypeOf(this,Q.prototype),n>Q.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(n){var o=Math.floor,h=Number.isFinite;if(typeof n=="number"){if(n===0)return Q.__zero();if(Q.__isOneDigitInt(n))return 0>n?Q.__oneDigit(-n,!0):Q.__oneDigit(n,!1);if(!h(n)||o(n)!==n)throw new RangeError("The number "+n+" cannot be converted to BigInt because it is not an integer");return Q.__fromDouble(n)}if(typeof n=="string"){const p=Q.__fromString(n);if(p===null)throw new SyntaxError("Cannot convert "+n+" to a BigInt");return p}if(typeof n=="boolean")return n===!0?Q.__oneDigit(1,!1):Q.__zero();if(typeof n=="object"){if(n.constructor===Q)return n;const p=Q.__toPrimitive(n);return Q.BigInt(p)}throw new TypeError("Cannot convert "+n+" to a BigInt")}toDebugString(){const n=["BigInt["];for(const o of this)n.push((o&&(o>>>0).toString(16))+", ");return n.push("]"),n.join("")}toString(n=10){if(2>n||36<n)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(n&n-1)==0?Q.__toStringBasePowerOfTwo(this,n):Q.__toStringGeneric(this,n,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(n){const o=n.length;if(o===0)return 0;if(o===1){const me=n.__unsignedDigit(0);return n.sign?-me:me}const h=n.__digit(o-1),p=Q.__clz30(h),_=30*o-p;if(1024<_)return n.sign?-1/0:1/0;let v=_-1,c=h,D=o-1;const I=p+3;let P=I===32?0:c<<I;P>>>=12;const B=I-12;let U=12<=I?0:c<<20+I,Z=20+I;for(0<B&&0<D&&(D--,c=n.__digit(D),P|=c>>>30-B,U=c<<B+2,Z=B+2);0<Z&&0<D;)D--,c=n.__digit(D),U|=30<=Z?c<<Z-30:c>>>30-Z,Z-=30;const ne=Q.__decideRounding(n,Z,D,c);if((ne===1||ne===0&&(1&U)==1)&&(U=U+1>>>0,U===0&&(P++,P>>>20!=0&&(P=0,v++,1023<v))))return n.sign?-1/0:1/0;const ye=n.sign?-2147483648:0;return v=v+1023<<20,Q.__kBitConversionInts[1]=ye|v|P,Q.__kBitConversionInts[0]=U,Q.__kBitConversionDouble[0]}static unaryMinus(n){if(n.length===0)return n;const o=n.__copy();return o.sign=!n.sign,o}static bitwiseNot(n){return n.sign?Q.__absoluteSubOne(n).__trim():Q.__absoluteAddOne(n,!0)}static exponentiate(n,o){if(o.sign)throw new RangeError("Exponent must be positive");if(o.length===0)return Q.__oneDigit(1,!1);if(n.length===0)return n;if(n.length===1&&n.__digit(0)===1)return n.sign&&(1&o.__digit(0))==0?Q.unaryMinus(n):n;if(1<o.length)throw new RangeError("BigInt too big");let h=o.__unsignedDigit(0);if(h===1)return n;if(h>=Q.__kMaxLengthBits)throw new RangeError("BigInt too big");if(n.length===1&&n.__digit(0)===2){const v=1+(0|h/30),c=n.sign&&(1&h)!=0,D=new Q(v,c);D.__initializeDigits();const I=1<<h%30;return D.__setDigit(v-1,I),D}let p=null,_=n;for((1&h)!=0&&(p=n),h>>=1;h!==0;h>>=1)_=Q.multiply(_,_),(1&h)!=0&&(p===null?p=_:p=Q.multiply(p,_));return p}static multiply(n,o){if(n.length===0)return n;if(o.length===0)return o;let h=n.length+o.length;30<=n.__clzmsd()+o.__clzmsd()&&h--;const p=new Q(h,n.sign!==o.sign);p.__initializeDigits();for(let _=0;_<n.length;_++)Q.__multiplyAccumulate(o,n.__digit(_),p,_);return p.__trim()}static divide(n,o){if(o.length===0)throw new RangeError("Division by zero");if(0>Q.__absoluteCompare(n,o))return Q.__zero();const h=n.sign!==o.sign,p=o.__unsignedDigit(0);let _;if(o.length===1&&32767>=p){if(p===1)return h===n.sign?n:Q.unaryMinus(n);_=Q.__absoluteDivSmall(n,p,null)}else _=Q.__absoluteDivLarge(n,o,!0,!1);return _.sign=h,_.__trim()}static remainder(n,o){if(o.length===0)throw new RangeError("Division by zero");if(0>Q.__absoluteCompare(n,o))return n;const h=o.__unsignedDigit(0);if(o.length===1&&32767>=h){if(h===1)return Q.__zero();const _=Q.__absoluteModSmall(n,h);return _===0?Q.__zero():Q.__oneDigit(_,n.sign)}const p=Q.__absoluteDivLarge(n,o,!1,!0);return p.sign=n.sign,p.__trim()}static add(n,o){const h=n.sign;return h===o.sign?Q.__absoluteAdd(n,o,h):0<=Q.__absoluteCompare(n,o)?Q.__absoluteSub(n,o,h):Q.__absoluteSub(o,n,!h)}static subtract(n,o){const h=n.sign;return h===o.sign?0<=Q.__absoluteCompare(n,o)?Q.__absoluteSub(n,o,h):Q.__absoluteSub(o,n,!h):Q.__absoluteAdd(n,o,h)}static leftShift(n,o){return o.length===0||n.length===0?n:o.sign?Q.__rightShiftByAbsolute(n,o):Q.__leftShiftByAbsolute(n,o)}static signedRightShift(n,o){return o.length===0||n.length===0?n:o.sign?Q.__leftShiftByAbsolute(n,o):Q.__rightShiftByAbsolute(n,o)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(n,o){return 0>Q.__compareToBigInt(n,o)}static lessThanOrEqual(n,o){return 0>=Q.__compareToBigInt(n,o)}static greaterThan(n,o){return 0<Q.__compareToBigInt(n,o)}static greaterThanOrEqual(n,o){return 0<=Q.__compareToBigInt(n,o)}static equal(n,o){if(n.sign!==o.sign||n.length!==o.length)return!1;for(let h=0;h<n.length;h++)if(n.__digit(h)!==o.__digit(h))return!1;return!0}static notEqual(n,o){return!Q.equal(n,o)}static bitwiseAnd(n,o){var h=Math.max;if(!n.sign&&!o.sign)return Q.__absoluteAnd(n,o).__trim();if(n.sign&&o.sign){const p=h(n.length,o.length)+1;let _=Q.__absoluteSubOne(n,p);const v=Q.__absoluteSubOne(o);return _=Q.__absoluteOr(_,v,_),Q.__absoluteAddOne(_,!0,_).__trim()}return n.sign&&([n,o]=[o,n]),Q.__absoluteAndNot(n,Q.__absoluteSubOne(o)).__trim()}static bitwiseXor(n,o){var h=Math.max;if(!n.sign&&!o.sign)return Q.__absoluteXor(n,o).__trim();if(n.sign&&o.sign){const v=h(n.length,o.length),c=Q.__absoluteSubOne(n,v),D=Q.__absoluteSubOne(o);return Q.__absoluteXor(c,D,c).__trim()}const p=h(n.length,o.length)+1;n.sign&&([n,o]=[o,n]);let _=Q.__absoluteSubOne(o,p);return _=Q.__absoluteXor(_,n,_),Q.__absoluteAddOne(_,!0,_).__trim()}static bitwiseOr(n,o){var h=Math.max;const p=h(n.length,o.length);if(!n.sign&&!o.sign)return Q.__absoluteOr(n,o).__trim();if(n.sign&&o.sign){let v=Q.__absoluteSubOne(n,p);const c=Q.__absoluteSubOne(o);return v=Q.__absoluteAnd(v,c,v),Q.__absoluteAddOne(v,!0,v).__trim()}n.sign&&([n,o]=[o,n]);let _=Q.__absoluteSubOne(o,p);return _=Q.__absoluteAndNot(_,n,_),Q.__absoluteAddOne(_,!0,_).__trim()}static asIntN(n,o){var h=Math.floor;if(o.length===0)return o;if(n=h(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return Q.__zero();if(n>=Q.__kMaxLengthBits)return o;const p=0|(n+29)/30;if(o.length<p)return o;const _=o.__unsignedDigit(p-1),v=1<<(n-1)%30;if(o.length===p&&_<v)return o;if((_&v)!==v)return Q.__truncateToNBits(n,o);if(!o.sign)return Q.__truncateAndSubFromPowerOfTwo(n,o,!0);if((_&v-1)==0){for(let c=p-2;0<=c;c--)if(o.__digit(c)!==0)return Q.__truncateAndSubFromPowerOfTwo(n,o,!1);return o.length===p&&_===v?o:Q.__truncateToNBits(n,o)}return Q.__truncateAndSubFromPowerOfTwo(n,o,!1)}static asUintN(n,o){var h=Math.floor;if(o.length===0)return o;if(n=h(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return Q.__zero();if(o.sign){if(n>Q.__kMaxLengthBits)throw new RangeError("BigInt too big");return Q.__truncateAndSubFromPowerOfTwo(n,o,!1)}if(n>=Q.__kMaxLengthBits)return o;const p=0|(n+29)/30;if(o.length<p)return o;const _=n%30;return o.length==p&&(_===0||!(o.__digit(p-1)>>>_))?o:Q.__truncateToNBits(n,o)}static ADD(n,o){if(n=Q.__toPrimitive(n),o=Q.__toPrimitive(o),typeof n=="string")return typeof o!="string"&&(o=o.toString()),n+o;if(typeof o=="string")return n.toString()+o;if(n=Q.__toNumeric(n),o=Q.__toNumeric(o),Q.__isBigInt(n)&&Q.__isBigInt(o))return Q.add(n,o);if(typeof n=="number"&&typeof o=="number")return n+o;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(n,o){return Q.__compare(n,o,0)}static LE(n,o){return Q.__compare(n,o,1)}static GT(n,o){return Q.__compare(n,o,2)}static GE(n,o){return Q.__compare(n,o,3)}static EQ(n,o){for(;;){if(Q.__isBigInt(n))return Q.__isBigInt(o)?Q.equal(n,o):Q.EQ(o,n);if(typeof n=="number"){if(Q.__isBigInt(o))return Q.__equalToNumber(o,n);if(typeof o!="object")return n==o;o=Q.__toPrimitive(o)}else if(typeof n=="string"){if(Q.__isBigInt(o))return n=Q.__fromString(n),n!==null&&Q.equal(n,o);if(typeof o!="object")return n==o;o=Q.__toPrimitive(o)}else if(typeof n=="boolean"){if(Q.__isBigInt(o))return Q.__equalToNumber(o,+n);if(typeof o!="object")return n==o;o=Q.__toPrimitive(o)}else if(typeof n=="symbol"){if(Q.__isBigInt(o))return!1;if(typeof o!="object")return n==o;o=Q.__toPrimitive(o)}else if(typeof n=="object"){if(typeof o=="object"&&o.constructor!==Q)return n==o;n=Q.__toPrimitive(n)}else return n==o}}static NE(n,o){return!Q.EQ(n,o)}static DataViewGetBigInt64(n,o,h=!1){return Q.asIntN(64,Q.DataViewGetBigUint64(n,o,h))}static DataViewGetBigUint64(n,o,h=!1){const[p,_]=h?[4,0]:[0,4],v=n.getUint32(o+p,h),c=n.getUint32(o+_,h),D=new Q(3,!1);return D.__setDigit(0,1073741823&c),D.__setDigit(1,(268435455&v)<<2|c>>>30),D.__setDigit(2,v>>>28),D.__trim()}static DataViewSetBigInt64(n,o,h,p=!1){Q.DataViewSetBigUint64(n,o,h,p)}static DataViewSetBigUint64(n,o,h,p=!1){h=Q.asUintN(64,h);let _=0,v=0;if(0<h.length&&(v=h.__digit(0),1<h.length)){const I=h.__digit(1);v|=I<<30,_=I>>>2,2<h.length&&(_|=h.__digit(2)<<28)}const[c,D]=p?[4,0]:[0,4];n.setUint32(o+c,_,p),n.setUint32(o+D,v,p)}static __zero(){return new Q(0,!1)}static __oneDigit(n,o){const h=new Q(1,o);return h.__setDigit(0,n),h}__copy(){const n=new Q(this.length,this.sign);for(let o=0;o<this.length;o++)n[o]=this[o];return n}__trim(){let n=this.length,o=this[n-1];for(;o===0;)n--,o=this[n-1],this.pop();return n===0&&(this.sign=!1),this}__initializeDigits(){for(let n=0;n<this.length;n++)this[n]=0}static __decideRounding(n,o,h,p){if(0<o)return-1;let _;if(0>o)_=-o-1;else{if(h===0)return-1;h--,p=n.__digit(h),_=29}let v=1<<_;if((p&v)==0)return-1;if(v-=1,(p&v)!=0)return 1;for(;0<h;)if(h--,n.__digit(h)!==0)return 1;return 0}static __fromDouble(n){Q.__kBitConversionDouble[0]=n;const o=2047&Q.__kBitConversionInts[1]>>>20,h=o-1023,p=(0|h/30)+1,_=new Q(p,0>n);let v=1048575&Q.__kBitConversionInts[1]|1048576,c=Q.__kBitConversionInts[0];const D=20,I=h%30;let P,B=0;if(I<20){const U=D-I;B=U+32,P=v>>>U,v=v<<32-U|c>>>U,c<<=32-U}else if(I===20)B=32,P=v,v=c,c=0;else{const U=I-D;B=32-U,P=v<<U|c>>>32-U,v=c<<U,c=0}_.__setDigit(p-1,P);for(let U=p-2;0<=U;U--)0<B?(B-=30,P=v>>>2,v=v<<30|c>>>2,c<<=30):P=0,_.__setDigit(U,P);return _.__trim()}static __isWhitespace(n){return 13>=n&&9<=n||(159>=n?n==32:131071>=n?n==160||n==5760:196607>=n?(n&=131071,10>=n||n==40||n==41||n==47||n==95||n==4096):n==65279)}static __fromString(n,o=0){let h=0;const p=n.length;let _=0;if(_===p)return Q.__zero();let v=n.charCodeAt(_);for(;Q.__isWhitespace(v);){if(++_===p)return Q.__zero();v=n.charCodeAt(_)}if(v===43){if(++_===p)return null;v=n.charCodeAt(_),h=1}else if(v===45){if(++_===p)return null;v=n.charCodeAt(_),h=-1}if(o===0){if(o=10,v===48){if(++_===p)return Q.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(o=16,++_===p)return null;v=n.charCodeAt(_)}else if(v===79||v===111){if(o=8,++_===p)return null;v=n.charCodeAt(_)}else if(v===66||v===98){if(o=2,++_===p)return null;v=n.charCodeAt(_)}}}else if(o===16&&v===48){if(++_===p)return Q.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(++_===p)return null;v=n.charCodeAt(_)}}if(h!=0&&o!==10)return null;for(;v===48;){if(++_===p)return Q.__zero();v=n.charCodeAt(_)}const c=p-_;let D=Q.__kMaxBitsPerChar[o],I=Q.__kBitsPerCharTableMultiplier-1;if(c>1073741824/D)return null;const P=D*c+I>>>Q.__kBitsPerCharTableShift,B=new Q(0|(P+29)/30,!1),U=10>o?o:10,Z=10<o?o-10:0;if((o&o-1)==0){D>>=Q.__kBitsPerCharTableShift;const ne=[],ye=[];let me=!1;do{let Pe=0,tt=0;for(;;){let Je;if(v-48>>>0<U)Je=v-48;else if((32|v)-97>>>0<Z)Je=(32|v)-87;else{me=!0;break}if(tt+=D,Pe=Pe<<D|Je,++_===p){me=!0;break}if(v=n.charCodeAt(_),30<tt+D)break}ne.push(Pe),ye.push(tt)}while(!me);Q.__fillFromParts(B,ne,ye)}else{B.__initializeDigits();let ne=!1,ye=0;do{let me=0,Pe=1;for(;;){let Je;if(v-48>>>0<U)Je=v-48;else if((32|v)-97>>>0<Z)Je=(32|v)-87;else{ne=!0;break}const $e=Pe*o;if(1073741823<$e)break;if(Pe=$e,me=me*o+Je,ye++,++_===p){ne=!0;break}v=n.charCodeAt(_)}I=30*Q.__kBitsPerCharTableMultiplier-1;const tt=0|(D*ye+I>>>Q.__kBitsPerCharTableShift)/30;B.__inplaceMultiplyAdd(Pe,me,tt)}while(!ne)}if(_!==p){if(!Q.__isWhitespace(v))return null;for(_++;_<p;_++)if(v=n.charCodeAt(_),!Q.__isWhitespace(v))return null}return B.sign=h==-1,B.__trim()}static __fillFromParts(n,o,h){let p=0,_=0,v=0;for(let c=o.length-1;0<=c;c--){const D=o[c],I=h[c];_|=D<<v,v+=I,v===30?(n.__setDigit(p++,_),v=0,_=0):30<v&&(n.__setDigit(p++,1073741823&_),v-=30,_=D>>>I-v)}if(_!==0){if(p>=n.length)throw new Error("implementation bug");n.__setDigit(p++,_)}for(;p<n.length;p++)n.__setDigit(p,0)}static __toStringBasePowerOfTwo(n,o){const h=n.length;let p=o-1;p=(85&p>>>1)+(85&p),p=(51&p>>>2)+(51&p),p=(15&p>>>4)+(15&p);const _=p,v=o-1,c=n.__digit(h-1),D=Q.__clz30(c);let I=0|(30*h-D+_-1)/_;if(n.sign&&I++,268435456<I)throw new Error("string too long");const P=Array(I);let B=I-1,U=0,Z=0;for(let ye=0;ye<h-1;ye++){const me=n.__digit(ye),Pe=(U|me<<Z)&v;P[B--]=Q.__kConversionChars[Pe];const tt=_-Z;for(U=me>>>tt,Z=30-tt;Z>=_;)P[B--]=Q.__kConversionChars[U&v],U>>>=_,Z-=_}const ne=(U|c<<Z)&v;for(P[B--]=Q.__kConversionChars[ne],U=c>>>_-Z;U!==0;)P[B--]=Q.__kConversionChars[U&v],U>>>=_;if(n.sign&&(P[B--]="-"),B!=-1)throw new Error("implementation bug");return P.join("")}static __toStringGeneric(n,o,h){const p=n.length;if(p===0)return"";if(p===1){let ye=n.__unsignedDigit(0).toString(o);return h===!1&&n.sign&&(ye="-"+ye),ye}const _=30*p-Q.__clz30(n.__digit(p-1)),v=Q.__kMaxBitsPerChar[o],c=v-1;let D=_*Q.__kBitsPerCharTableMultiplier;D+=c-1,D=0|D/c;const I=D+1>>1,P=Q.exponentiate(Q.__oneDigit(o,!1),Q.__oneDigit(I,!1));let B,U;const Z=P.__unsignedDigit(0);if(P.length===1&&32767>=Z){B=new Q(n.length,!1),B.__initializeDigits();let ye=0;for(let me=2*n.length-1;0<=me;me--){const Pe=ye<<15|n.__halfDigit(me);B.__setHalfDigit(me,0|Pe/Z),ye=0|Pe%Z}U=ye.toString(o)}else{const ye=Q.__absoluteDivLarge(n,P,!0,!0);B=ye.quotient;const me=ye.remainder.__trim();U=Q.__toStringGeneric(me,o,!0)}B.__trim();let ne=Q.__toStringGeneric(B,o,!0);for(;U.length<I;)U="0"+U;return h===!1&&n.sign&&(ne="-"+ne),ne+U}static __unequalSign(n){return n?-1:1}static __absoluteGreater(n){return n?-1:1}static __absoluteLess(n){return n?1:-1}static __compareToBigInt(n,o){const h=n.sign;if(h!==o.sign)return Q.__unequalSign(h);const p=Q.__absoluteCompare(n,o);return 0<p?Q.__absoluteGreater(h):0>p?Q.__absoluteLess(h):0}static __compareToNumber(n,o){if(Q.__isOneDigitInt(o)){const h=n.sign,p=0>o;if(h!==p)return Q.__unequalSign(h);if(n.length===0){if(p)throw new Error("implementation bug");return o===0?0:-1}if(1<n.length)return Q.__absoluteGreater(h);const _=Math.abs(o),v=n.__unsignedDigit(0);return v>_?Q.__absoluteGreater(h):v<_?Q.__absoluteLess(h):0}return Q.__compareToDouble(n,o)}static __compareToDouble(n,o){if(o!==o)return o;if(o===1/0)return-1;if(o===-1/0)return 1;const h=n.sign;if(h!==0>o)return Q.__unequalSign(h);if(o===0)throw new Error("implementation bug: should be handled elsewhere");if(n.length===0)return-1;Q.__kBitConversionDouble[0]=o;const p=2047&Q.__kBitConversionInts[1]>>>20;if(p==2047)throw new Error("implementation bug: handled elsewhere");const _=p-1023;if(0>_)return Q.__absoluteGreater(h);const v=n.length;let c=n.__digit(v-1);const D=Q.__clz30(c),I=30*v-D,P=_+1;if(I<P)return Q.__absoluteLess(h);if(I>P)return Q.__absoluteGreater(h);let B=1048576|1048575&Q.__kBitConversionInts[1],U=Q.__kBitConversionInts[0];const Z=20,ne=29-D;if(ne!==(0|(I-1)%30))throw new Error("implementation bug");let ye,me=0;if(20>ne){const Pe=Z-ne;me=Pe+32,ye=B>>>Pe,B=B<<32-Pe|U>>>Pe,U<<=32-Pe}else if(ne===20)me=32,ye=B,B=U,U=0;else{const Pe=ne-Z;me=32-Pe,ye=B<<Pe|U>>>32-Pe,B=U<<Pe,U=0}if(c>>>=0,ye>>>=0,c>ye)return Q.__absoluteGreater(h);if(c<ye)return Q.__absoluteLess(h);for(let Pe=v-2;0<=Pe;Pe--){0<me?(me-=30,ye=B>>>2,B=B<<30|U>>>2,U<<=30):ye=0;const tt=n.__unsignedDigit(Pe);if(tt>ye)return Q.__absoluteGreater(h);if(tt<ye)return Q.__absoluteLess(h)}if(B!==0||U!==0){if(me===0)throw new Error("implementation bug");return Q.__absoluteLess(h)}return 0}static __equalToNumber(n,o){var h=Math.abs;return Q.__isOneDigitInt(o)?o===0?n.length===0:n.length===1&&n.sign===0>o&&n.__unsignedDigit(0)===h(o):Q.__compareToDouble(n,o)===0}static __comparisonResultToBool(n,o){return o===0?0>n:o===1?0>=n:o===2?0<n:o===3?0<=n:void 0}static __compare(n,o,h){if(n=Q.__toPrimitive(n),o=Q.__toPrimitive(o),typeof n=="string"&&typeof o=="string")switch(h){case 0:return n<o;case 1:return n<=o;case 2:return n>o;case 3:return n>=o}if(Q.__isBigInt(n)&&typeof o=="string")return o=Q.__fromString(o),o!==null&&Q.__comparisonResultToBool(Q.__compareToBigInt(n,o),h);if(typeof n=="string"&&Q.__isBigInt(o))return n=Q.__fromString(n),n!==null&&Q.__comparisonResultToBool(Q.__compareToBigInt(n,o),h);if(n=Q.__toNumeric(n),o=Q.__toNumeric(o),Q.__isBigInt(n)){if(Q.__isBigInt(o))return Q.__comparisonResultToBool(Q.__compareToBigInt(n,o),h);if(typeof o!="number")throw new Error("implementation bug");return Q.__comparisonResultToBool(Q.__compareToNumber(n,o),h)}if(typeof n!="number")throw new Error("implementation bug");if(Q.__isBigInt(o))return Q.__comparisonResultToBool(Q.__compareToNumber(o,n),2^h);if(typeof o!="number")throw new Error("implementation bug");return h===0?n<o:h===1?n<=o:h===2?n>o:h===3?n>=o:void 0}__clzmsd(){return Q.__clz30(this.__digit(this.length-1))}static __absoluteAdd(n,o,h){if(n.length<o.length)return Q.__absoluteAdd(o,n,h);if(n.length===0)return n;if(o.length===0)return n.sign===h?n:Q.unaryMinus(n);let p=n.length;(n.__clzmsd()===0||o.length===n.length&&o.__clzmsd()===0)&&p++;const _=new Q(p,h);let v=0,c=0;for(;c<o.length;c++){const D=n.__digit(c)+o.__digit(c)+v;v=D>>>30,_.__setDigit(c,1073741823&D)}for(;c<n.length;c++){const D=n.__digit(c)+v;v=D>>>30,_.__setDigit(c,1073741823&D)}return c<_.length&&_.__setDigit(c,v),_.__trim()}static __absoluteSub(n,o,h){if(n.length===0)return n;if(o.length===0)return n.sign===h?n:Q.unaryMinus(n);const p=new Q(n.length,h);let _=0,v=0;for(;v<o.length;v++){const c=n.__digit(v)-o.__digit(v)-_;_=1&c>>>30,p.__setDigit(v,1073741823&c)}for(;v<n.length;v++){const c=n.__digit(v)-_;_=1&c>>>30,p.__setDigit(v,1073741823&c)}return p.__trim()}static __absoluteAddOne(n,o,h=null){const p=n.length;h===null?h=new Q(p,o):h.sign=o;let _=1;for(let v=0;v<p;v++){const c=n.__digit(v)+_;_=c>>>30,h.__setDigit(v,1073741823&c)}return _!=0&&h.__setDigitGrow(p,1),h}static __absoluteSubOne(n,o){const h=n.length;o=o||h;const p=new Q(o,!1);let _=1;for(let v=0;v<h;v++){const c=n.__digit(v)-_;_=1&c>>>30,p.__setDigit(v,1073741823&c)}if(_!=0)throw new Error("implementation bug");for(let v=h;v<o;v++)p.__setDigit(v,0);return p}static __absoluteAnd(n,o,h=null){let p=n.length,_=o.length,v=_;if(p<_){v=p;const I=n,P=p;n=o,p=_,o=I,_=P}let c=v;h===null?h=new Q(c,!1):c=h.length;let D=0;for(;D<v;D++)h.__setDigit(D,n.__digit(D)&o.__digit(D));for(;D<c;D++)h.__setDigit(D,0);return h}static __absoluteAndNot(n,o,h=null){const p=n.length,_=o.length;let v=_;p<_&&(v=p);let c=p;h===null?h=new Q(c,!1):c=h.length;let D=0;for(;D<v;D++)h.__setDigit(D,n.__digit(D)&~o.__digit(D));for(;D<p;D++)h.__setDigit(D,n.__digit(D));for(;D<c;D++)h.__setDigit(D,0);return h}static __absoluteOr(n,o,h=null){let p=n.length,_=o.length,v=_;if(p<_){v=p;const I=n,P=p;n=o,p=_,o=I,_=P}let c=p;h===null?h=new Q(c,!1):c=h.length;let D=0;for(;D<v;D++)h.__setDigit(D,n.__digit(D)|o.__digit(D));for(;D<p;D++)h.__setDigit(D,n.__digit(D));for(;D<c;D++)h.__setDigit(D,0);return h}static __absoluteXor(n,o,h=null){let p=n.length,_=o.length,v=_;if(p<_){v=p;const I=n,P=p;n=o,p=_,o=I,_=P}let c=p;h===null?h=new Q(c,!1):c=h.length;let D=0;for(;D<v;D++)h.__setDigit(D,n.__digit(D)^o.__digit(D));for(;D<p;D++)h.__setDigit(D,n.__digit(D));for(;D<c;D++)h.__setDigit(D,0);return h}static __absoluteCompare(n,o){const h=n.length-o.length;if(h!=0)return h;let p=n.length-1;for(;0<=p&&n.__digit(p)===o.__digit(p);)p--;return 0>p?0:n.__unsignedDigit(p)>o.__unsignedDigit(p)?1:-1}static __multiplyAccumulate(n,o,h,p){if(o===0)return;const _=32767&o,v=o>>>15;let c=0,D=0;for(let I,P=0;P<n.length;P++,p++){I=h.__digit(p);const B=n.__digit(P),U=32767&B,Z=B>>>15,ne=Q.__imul(U,_),ye=Q.__imul(U,v),me=Q.__imul(Z,_),Pe=Q.__imul(Z,v);I+=D+ne+c,c=I>>>30,I&=1073741823,I+=((32767&ye)<<15)+((32767&me)<<15),c+=I>>>30,D=Pe+(ye>>>15)+(me>>>15),h.__setDigit(p,1073741823&I)}for(;c!=0||D!==0;p++){let I=h.__digit(p);I+=c+D,D=0,c=I>>>30,h.__setDigit(p,1073741823&I)}}static __internalMultiplyAdd(n,o,h,p,_){let v=h,c=0;for(let D=0;D<p;D++){const I=n.__digit(D),P=Q.__imul(32767&I,o),B=Q.__imul(I>>>15,o),U=P+((32767&B)<<15)+c+v;v=U>>>30,c=B>>>15,_.__setDigit(D,1073741823&U)}if(_.length>p)for(_.__setDigit(p++,v+c);p<_.length;)_.__setDigit(p++,0);else if(v+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(n,o,h){h>this.length&&(h=this.length);const p=32767&n,_=n>>>15;let v=0,c=o;for(let D=0;D<h;D++){const I=this.__digit(D),P=32767&I,B=I>>>15,U=Q.__imul(P,p),Z=Q.__imul(P,_),ne=Q.__imul(B,p),ye=Q.__imul(B,_);let me=c+U+v;v=me>>>30,me&=1073741823,me+=((32767&Z)<<15)+((32767&ne)<<15),v+=me>>>30,c=ye+(Z>>>15)+(ne>>>15),this.__setDigit(D,1073741823&me)}if(v!=0||c!==0)throw new Error("implementation bug")}static __absoluteDivSmall(n,o,h=null){h===null&&(h=new Q(n.length,!1));let p=0;for(let _,v=2*n.length-1;0<=v;v-=2){_=(p<<15|n.__halfDigit(v))>>>0;const c=0|_/o;p=0|_%o,_=(p<<15|n.__halfDigit(v-1))>>>0;const D=0|_/o;p=0|_%o,h.__setDigit(v>>>1,c<<15|D)}return h}static __absoluteModSmall(n,o){let h=0;for(let p=2*n.length-1;0<=p;p--)h=0|((h<<15|n.__halfDigit(p))>>>0)%o;return h}static __absoluteDivLarge(n,o,h,p){const _=o.__halfDigitLength(),v=o.length,c=n.__halfDigitLength()-_;let D=null;h&&(D=new Q(c+2>>>1,!1),D.__initializeDigits());const I=new Q(_+2>>>1,!1);I.__initializeDigits();const P=Q.__clz15(o.__halfDigit(_-1));0<P&&(o=Q.__specialLeftShift(o,P,0));const B=Q.__specialLeftShift(n,P,1),U=o.__halfDigit(_-1);let Z=0;for(let ne,ye=c;0<=ye;ye--){ne=32767;const me=B.__halfDigit(ye+_);if(me!==U){const tt=(me<<15|B.__halfDigit(ye+_-1))>>>0;ne=0|tt/U;let Je=0|tt%U;const $e=o.__halfDigit(_-2),Me=B.__halfDigit(ye+_-2);for(;Q.__imul(ne,$e)>>>0>(Je<<16|Me)>>>0&&(ne--,Je+=U,!(32767<Je)););}Q.__internalMultiplyAdd(o,ne,0,v,I);let Pe=B.__inplaceSub(I,ye,_+1);Pe!==0&&(Pe=B.__inplaceAdd(o,ye,_),B.__setHalfDigit(ye+_,32767&B.__halfDigit(ye+_)+Pe),ne--),h&&(1&ye?Z=ne<<15:D.__setDigit(ye>>>1,Z|ne))}if(p)return B.__inplaceRightShift(P),h?{quotient:D,remainder:B}:B;if(h)return D;throw new Error("unreachable")}static __clz15(n){return Q.__clz30(n)-15}__inplaceAdd(n,o,h){let p=0;for(let _=0;_<h;_++){const v=this.__halfDigit(o+_)+n.__halfDigit(_)+p;p=v>>>15,this.__setHalfDigit(o+_,32767&v)}return p}__inplaceSub(n,o,h){let p=0;if(1&o){o>>=1;let _=this.__digit(o),v=32767&_,c=0;for(;c<h-1>>>1;c++){const P=n.__digit(c),B=(_>>>15)-(32767&P)-p;p=1&B>>>15,this.__setDigit(o+c,(32767&B)<<15|32767&v),_=this.__digit(o+c+1),v=(32767&_)-(P>>>15)-p,p=1&v>>>15}const D=n.__digit(c),I=(_>>>15)-(32767&D)-p;if(p=1&I>>>15,this.__setDigit(o+c,(32767&I)<<15|32767&v),o+c+1>=this.length)throw new RangeError("out of bounds");(1&h)==0&&(_=this.__digit(o+c+1),v=(32767&_)-(D>>>15)-p,p=1&v>>>15,this.__setDigit(o+n.length,1073709056&_|32767&v))}else{o>>=1;let _=0;for(;_<n.length-1;_++){const P=this.__digit(o+_),B=n.__digit(_),U=(32767&P)-(32767&B)-p;p=1&U>>>15;const Z=(P>>>15)-(B>>>15)-p;p=1&Z>>>15,this.__setDigit(o+_,(32767&Z)<<15|32767&U)}const v=this.__digit(o+_),c=n.__digit(_),D=(32767&v)-(32767&c)-p;p=1&D>>>15;let I=0;(1&h)==0&&(I=(v>>>15)-(c>>>15)-p,p=1&I>>>15),this.__setDigit(o+_,(32767&I)<<15|32767&D)}return p}__inplaceRightShift(n){if(n===0)return;let o=this.__digit(0)>>>n;const h=this.length-1;for(let p=0;p<h;p++){const _=this.__digit(p+1);this.__setDigit(p,1073741823&_<<30-n|o),o=_>>>n}this.__setDigit(h,o)}static __specialLeftShift(n,o,h){const p=n.length,_=new Q(p+h,!1);if(o===0){for(let c=0;c<p;c++)_.__setDigit(c,n.__digit(c));return 0<h&&_.__setDigit(p,0),_}let v=0;for(let c=0;c<p;c++){const D=n.__digit(c);_.__setDigit(c,1073741823&D<<o|v),v=D>>>30-o}return 0<h&&_.__setDigit(p,v),_}static __leftShiftByAbsolute(n,o){const h=Q.__toShiftAmount(o);if(0>h)throw new RangeError("BigInt too big");const p=0|h/30,_=h%30,v=n.length,c=_!==0&&n.__digit(v-1)>>>30-_!=0,D=v+p+(c?1:0),I=new Q(D,n.sign);if(_===0){let P=0;for(;P<p;P++)I.__setDigit(P,0);for(;P<D;P++)I.__setDigit(P,n.__digit(P-p))}else{let P=0;for(let B=0;B<p;B++)I.__setDigit(B,0);for(let B=0;B<v;B++){const U=n.__digit(B);I.__setDigit(B+p,1073741823&U<<_|P),P=U>>>30-_}if(c)I.__setDigit(v+p,P);else if(P!==0)throw new Error("implementation bug")}return I.__trim()}static __rightShiftByAbsolute(n,o){const h=n.length,p=n.sign,_=Q.__toShiftAmount(o);if(0>_)return Q.__rightShiftByMaximum(p);const v=0|_/30,c=_%30;let D=h-v;if(0>=D)return Q.__rightShiftByMaximum(p);let I=!1;if(p){if((n.__digit(v)&(1<<c)-1)!=0)I=!0;else for(let B=0;B<v;B++)if(n.__digit(B)!==0){I=!0;break}}I&&c===0&&~n.__digit(h-1)==0&&D++;let P=new Q(D,p);if(c===0){P.__setDigit(D-1,0);for(let B=v;B<h;B++)P.__setDigit(B-v,n.__digit(B))}else{let B=n.__digit(v)>>>c;const U=h-v-1;for(let Z=0;Z<U;Z++){const ne=n.__digit(Z+v+1);P.__setDigit(Z,1073741823&ne<<30-c|B),B=ne>>>c}P.__setDigit(U,B)}return I&&(P=Q.__absoluteAddOne(P,!0,P)),P.__trim()}static __rightShiftByMaximum(n){return n?Q.__oneDigit(1,!0):Q.__zero()}static __toShiftAmount(n){if(1<n.length)return-1;const o=n.__unsignedDigit(0);return o>Q.__kMaxLengthBits?-1:o}static __toPrimitive(n,o="default"){if(typeof n!="object"||n.constructor===Q)return n;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const _=n[Symbol.toPrimitive];if(_){const v=_(o);if(typeof v!="object")return v;throw new TypeError("Cannot convert object to primitive value")}}const h=n.valueOf;if(h){const _=h.call(n);if(typeof _!="object")return _}const p=n.toString;if(p){const _=p.call(n);if(typeof _!="object")return _}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(n){return Q.__isBigInt(n)?n:+n}static __isBigInt(n){return typeof n=="object"&&n!==null&&n.constructor===Q}static __truncateToNBits(n,o){const h=0|(n+29)/30,p=new Q(h,o.sign),_=h-1;for(let c=0;c<_;c++)p.__setDigit(c,o.__digit(c));let v=o.__digit(_);if(n%30!=0){const c=32-n%30;v=v<<c>>>c}return p.__setDigit(_,v),p.__trim()}static __truncateAndSubFromPowerOfTwo(n,o,h){var p=Math.min;const _=0|(n+29)/30,v=new Q(_,h);let c=0;const D=_-1;let I=0;for(const Z=p(D,o.length);c<Z;c++){const ne=0-o.__digit(c)-I;I=1&ne>>>30,v.__setDigit(c,1073741823&ne)}for(;c<D;c++)v.__setDigit(c,0|1073741823&-I);let P=D<o.length?o.__digit(D):0;const B=n%30;let U;if(B==0)U=0-P-I,U&=1073741823;else{const Z=32-B;P=P<<Z>>>Z;const ne=1<<32-Z;U=ne-P-I,U&=ne-1}return v.__setDigit(D,U),v.__trim()}__digit(n){return this[n]}__unsignedDigit(n){return this[n]>>>0}__setDigit(n,o){this[n]=0|o}__setDigitGrow(n,o){this[n]=0|o}__halfDigitLength(){const n=this.length;return 32767>=this.__unsignedDigit(n-1)?2*n-1:2*n}__halfDigit(n){return 32767&this[n>>>1]>>>15*(1&n)}__setHalfDigit(n,o){const h=n>>>1,p=this.__digit(h),_=1&n?32767&p|o<<15:1073709056&p|32767&o;this.__setDigit(h,_)}static __digitPow(n,o){let h=1;for(;0<o;)1&o&&(h*=n),o>>>=1,n*=n;return h}static __isOneDigitInt(n){return(1073741823&n)===n}}Q.__kMaxLength=33554432,Q.__kMaxLengthBits=Q.__kMaxLength<<5,Q.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],Q.__kBitsPerCharTableShift=5,Q.__kBitsPerCharTableMultiplier=1<<Q.__kBitsPerCharTableShift,Q.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Q.__kBitConversionBuffer=new ArrayBuffer(8),Q.__kBitConversionDouble=new Float64Array(Q.__kBitConversionBuffer),Q.__kBitConversionInts=new Int32Array(Q.__kBitConversionBuffer),Q.__clz30=Math.clz32?function(i){return Math.clz32(i)-2}:function(i){return i===0?30:0|29-(0|Math.log(i>>>0)/Math.LN2)},Q.__imul=Math.imul||function(i,n){return 0|i*n};const el=Q.BigInt(0),d_=Q.BigInt(1),Ib=Q.BigInt(2),xR=Q.BigInt(10),bR=Q.BigInt(24),wR=Q.BigInt(60),TR=Q.BigInt(1e3),I_=Q.BigInt(1e6),t_=Q.BigInt(1e9),eS=Q.multiply(Q.BigInt(3600),t_),SR=Q.multiply(wR,t_),lf=Q.multiply(eS,bR);function Ph(i){return typeof i=="bigint"?Q.BigInt(i.toString(10)):i}function tS(i){return Q.equal(Q.remainder(i,Ib),el)}function bp(i){return Q.lessThan(i,el)?Q.unaryMinus(i):i}function H0(i,n){return Q.lessThan(i,n)?-1:Q.greaterThan(i,n)?1:0}function Gy(i,n){return{quotient:Q.divide(i,n),remainder:Q.remainder(i,n)}}var yw,_w;const _n="slot-epochNanoSeconds",vn="slot-iso-date",hr="slot-iso-date-time",Dr="slot-time",kt="slot-calendar",nS="slot-date-brand",iS="slot-year-month-brand",rS="slot-month-day-brand",wi="slot-time-zone",Bs="slot-years",Fs="slot-months",bo="slot-weeks",Us="slot-days",Vs="slot-hours",Gs="slot-minutes",Zs="slot-seconds",$s="slot-milliseconds",Ys="slot-microseconds",wo="slot-nanoseconds",aS="date",sS="ym",oS="md",lS="time",cS="datetime",uS="instant",Vp="original",Gm="timezone-canonical",Bx="timezone-original",Zy="calendar-id",hS="locale",Fx="options",dS=new WeakMap,Ux=Symbol.for("@@Temporal__GetSlots");(yw=globalThis)[Ux]||(yw[Ux]=function(i){return dS.get(i)});const vv=globalThis[Ux],Vx=Symbol.for("@@Temporal__CreateSlots");(_w=globalThis)[Vx]||(_w[Vx]=function(i){dS.set(i,Object.create(null))});const id=globalThis[Vx];function Qs(i,...n){if(!i||typeof i!="object")return!1;const o=vv(i);return!!o&&n.every(h=>h in o)}function te(i,n){var h;const o=(h=vv(i))==null?void 0:h[n];if(o===void 0)throw new TypeError(`Missing internal slot ${n}`);return o}function On(i,n,o){const h=vv(i);if(h===void 0)throw new TypeError("Missing slots for the given container");if(h[n])throw new TypeError(`${n} already has set`);h[n]=o}const Gx={};function rd(i,n){Object.defineProperty(i.prototype,Symbol.toStringTag,{value:n,writable:!1,enumerable:!1,configurable:!0});const o=Object.getOwnPropertyNames(i);for(let p=0;p<o.length;p++){const _=o[p],v=Object.getOwnPropertyDescriptor(i,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i,_,v))}const h=Object.getOwnPropertyNames(i.prototype);for(let p=0;p<h.length;p++){const _=h[p],v=Object.getOwnPropertyDescriptor(i.prototype,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i.prototype,_,v))}Zx(n,i),Zx(`${n}.prototype`,i.prototype)}function Zx(i,n){const o=`%${i}%`;if(Gx[o]!==void 0)throw new Error(`intrinsic ${i} already exists`);Gx[o]=n}function Ha(i){return Gx[i]}function $m(i,n){let o=i;if(o===0)return{div:o,mod:o};const h=Math.sign(o);o=Math.abs(o);const p=Math.trunc(1+Math.log10(o));if(n>=p)return{div:0*h,mod:h*o};if(n===0)return{div:h*o,mod:0*h};const _=o.toPrecision(p);return{div:h*Number.parseInt(_.slice(0,p-n),10),mod:h*Number.parseInt(_.slice(p-n),10)}}function fx(i,n,o){let h=i,p=o;if(h===0)return p;const _=Math.sign(h)||Math.sign(p);h=Math.abs(h),p=Math.abs(p);const v=h.toPrecision(Math.trunc(1+Math.log10(h)));if(p===0)return _*Number.parseInt(v+"0".repeat(n),10);const c=v+p.toPrecision(Math.trunc(1+Math.log10(p))).padStart(n,"0");return _*Number.parseInt(c,10)}function xv(i,n){const o=n==="negative";switch(i){case"ceil":return o?"zero":"infinity";case"floor":return o?"infinity":"zero";case"expand":return"infinity";case"trunc":return"zero";case"halfCeil":return o?"half-zero":"half-infinity";case"halfFloor":return o?"half-infinity":"half-zero";case"halfExpand":return"half-infinity";case"halfTrunc":return"half-zero";case"halfEven":return"half-even"}}function bv(i,n,o,h,p){return p==="zero"?i:p==="infinity"?n:o<0?i:o>0?n:p==="half-zero"?i:p==="half-infinity"?n:h?i:n}class Vn{constructor(n){this.totalNs=Ph(n),this.sec=Q.toNumber(Q.divide(this.totalNs,t_)),this.subsec=Q.toNumber(Q.remainder(this.totalNs,t_))}static validateNew(n,o){if(Q.greaterThan(bp(n),Vn.MAX))throw new RangeError(`${o} of duration time units cannot exceed ${Vn.MAX} s`);return new Vn(n)}static fromEpochNsDiff(n,o){const h=Q.subtract(Ph(n),Ph(o));return new Vn(h)}static fromComponents(n,o,h,p,_,v){const c=Q.add(Q.add(Q.add(Q.add(Q.add(Q.BigInt(v),Q.multiply(Q.BigInt(_),TR)),Q.multiply(Q.BigInt(p),I_)),Q.multiply(Q.BigInt(h),t_)),Q.multiply(Q.BigInt(o),SR)),Q.multiply(Q.BigInt(n),eS));return Vn.validateNew(c,"total")}abs(){return new Vn(bp(this.totalNs))}add(n){return Vn.validateNew(Q.add(this.totalNs,n.totalNs),"sum")}add24HourDays(n){return Vn.validateNew(Q.add(this.totalNs,Q.multiply(Q.BigInt(n),lf)),"sum")}addToEpochNs(n){return Q.add(Ph(n),this.totalNs)}cmp(n){return H0(this.totalNs,n.totalNs)}divmod(n){const{quotient:o,remainder:h}=Gy(this.totalNs,Q.BigInt(n));return{quotient:Q.toNumber(o),remainder:new Vn(h)}}fdiv(n){const o=Ph(n),h=Q.BigInt(o);let{quotient:p,remainder:_}=Gy(this.totalNs,h);const v=[];let c;const D=(Q.lessThan(this.totalNs,el)?-1:1)*Math.sign(Q.toNumber(o));for(;!Q.equal(_,el)&&v.length<50;)_=Q.multiply(_,xR),{quotient:c,remainder:_}=Gy(_,h),v.push(Math.abs(Q.toNumber(c)));return D*+(bp(p).toString()+"."+v.join(""))}isZero(){return Q.equal(this.totalNs,el)}round(n,o){const h=Ph(n);if(Q.equal(h,d_))return this;const{quotient:p,remainder:_}=Gy(this.totalNs,h),v=Q.lessThan(this.totalNs,el)?"negative":"positive",c=Q.multiply(bp(p),h),D=Q.add(c,h),I=H0(bp(Q.multiply(_,Ib)),h),P=xv(o,v),B=Q.equal(bp(this.totalNs),c)?c:bv(c,D,I,tS(p),P),U=v==="positive"?B:Q.unaryMinus(B);return Vn.validateNew(U,"rounding")}sign(){return this.cmp(new Vn(el))}subtract(n){return Vn.validateNew(Q.subtract(this.totalNs,n.totalNs),"difference")}}Vn.MAX=Q.BigInt("9007199254740991999999999"),Vn.ZERO=new Vn(el);const vw=/[A-Za-z._][A-Za-z._0-9+-]*/,R_=new RegExp(`(?:${/(?:[+-](?:[01][0-9]|2[0-3])(?::?[0-5][0-9])?)/.source}|(?:${vw.source})(?:\\/(?:${vw.source}))*)`),fS=/(?:[+-]\d{6}|\d{4})/,X0=/(?:0[1-9]|1[0-2])/,$x=/(?:0[1-9]|[12]\d|3[01])/,ER=new RegExp(`(${fS.source})(?:-(${X0.source})-(${$x.source})|(${X0.source})(${$x.source}))`),pS=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,mS=/((?:[+-])(?:[01][0-9]|2[0-3])(?::?(?:[0-5][0-9])(?::?(?:[0-5][0-9])(?:[.,](?:\d{1,9}))?)?)?)/,gS=new RegExp(`([zZ])|${mS.source}?`),ng=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,AR=new RegExp([`^${ER.source}`,`(?:(?:[tT]|\\s+)${pS.source}(?:${gS.source})?)?`,`(?:\\[!?(${R_.source})\\])?`,`((?:${ng.source})*)$`].join("")),MR=new RegExp([`^[tT]?${pS.source}`,`(?:${gS.source})?`,`(?:\\[!?${R_.source}\\])?`,`((?:${ng.source})*)$`].join("")),CR=new RegExp(`^(${fS.source})-?(${X0.source})(?:\\[!?${R_.source}\\])?((?:${ng.source})*)$`),DR=new RegExp(`^(?:--)?(${X0.source})-?(${$x.source})(?:\\[!?${R_.source}\\])?((?:${ng.source})*)$`),px=/(\d+)(?:[.,](\d{1,9}))?/,kR=new RegExp(`(?:${px.source}H)?(?:${px.source}M)?(?:${px.source}S)?`),IR=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${kR.source})?$`,"i"),cf=864e5,W0=1e6*cf,RR=6e10,yS=1e8*cf,ig=Ou(yS),f_=Q.unaryMinus(ig),zR=Q.add(Q.subtract(f_,lf),d_),NR=Q.subtract(Q.add(ig,lf),d_),PR=146097*cf,xw=-271821,bw=275760,n_=Date.UTC(1847,0,1),LR=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","ethiopic-amete-alem","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"],OR=new Set(["ACT","AET","AGT","ART","AST","BET","BST","CAT","CNT","CST","CTT","EAT","ECT","IET","IST","JST","MIT","NET","NST","PLT","PNT","PRT","PST","SST","VST"]);function kr(i){return typeof i=="object"&&i!==null||typeof i=="function"}function wv(i){if(typeof i=="bigint")throw new TypeError("Cannot convert BigInt to number");return Number(i)}function Tv(i){if(typeof i=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return String(i)}function Mn(i){const n=wv(i);if(n===0)return 0;if(Number.isNaN(n)||n===1/0||n===-1/0)throw new RangeError("invalid number value");const o=Math.trunc(n);return o===0?0:o}function ww(i,n){const o=Mn(i);if(o<=0)throw n!==void 0?new RangeError(`property '${n}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return o}function Bc(i){const n=wv(i);if(Number.isNaN(n))throw new RangeError("not a number");if(n===1/0||n===-1/0)throw new RangeError("infinity is out of range");if(!function(o){if(typeof o!="number"||Number.isNaN(o)||o===1/0||o===-1/0)return!1;const h=Math.abs(o);return Math.floor(h)===h}(n))throw new RangeError(`unsupported fractional value ${i}`);return n===0?0:n}function p_(i,n){return String(i).padStart(n,"0")}function pa(i){if(typeof i!="string")throw new TypeError(`expected a string, not ${String(i)}`);return i}function Yx(i,n){if(kr(i)){const o=i==null?void 0:i.toString();if(typeof o=="string"||typeof o=="number")return o;throw new TypeError("Cannot convert object to primitive value")}return i}const qx=["era","eraYear","year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],jR={era:Tv,eraYear:Mn,year:Mn,month:ww,monthCode:function(i){const n=pa(Yx(i));if(n.length<3||n.length>4||n[0]!=="M"||"0123456789".indexOf(n[1])===-1||"0123456789".indexOf(n[2])===-1||n[1]+n[2]==="00"&&n[3]!=="L"||n[3]!=="L"&&n[3]!==void 0)throw new RangeError(`bad month code ${n}; must match M01-M99 or M00L-M99L`);return n},day:ww,hour:Mn,minute:Mn,second:Mn,millisecond:Mn,microsecond:Mn,nanosecond:Mn,offset:function(i){const n=pa(Yx(i));return _g(n),n},timeZone:Xs},BR={hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},rg=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],Tw=Object.fromEntries(rg.map(i=>[i[0],i[1]])),FR=Object.fromEntries(rg.map(([i,n])=>[n,i])),i_=rg.map(([,i])=>i),ag={day:W0,hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},Q0=["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],UR=Intl.DateTimeFormat,Sw=new Map;function _S(i){const n=v_(i);let o=Sw.get(n);return o===void 0&&(o=new UR("en-us",{timeZone:n,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),Sw.set(n,o)),o}function $a(i){return Qs(i,_n)&&!Qs(i,wi,kt)}function Mr(i){return Qs(i,Bs,Fs,Us,Vs,Gs,Zs,$s,Ys,wo)}function Cr(i){return Qs(i,nS)}function Lr(i){return Qs(i,Dr)}function Ki(i){return Qs(i,hr)}function Ya(i){return Qs(i,iS)}function Jo(i){return Qs(i,rS)}function Un(i){return Qs(i,_n,wi,kt)}function st(i,n){if(!n(i))throw new TypeError("invalid receiver: method called with the wrong type of this-object")}function mg(i){if(Qs(i,kt)||Qs(i,wi))throw new TypeError("with() does not support a calendar or timeZone property");if(Lr(i))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(i.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(i.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function z_(i,n){return n==="never"||n==="auto"&&i==="iso8601"?"":`[${n==="critical"?"!":""}u-ca=${i}]`}function Sv(i){let n,o,h=!1;for(ng.lastIndex=0;o=ng.exec(i);){const{1:p,2:_,3:v}=o;if(_==="u-ca"){if(n===void 0)n=v,h=p==="!";else if(p==="!"||h)throw new RangeError(`Invalid annotations in ${i}: more than one u-ca present with critical flag`)}else if(p==="!")throw new RangeError(`Unrecognized annotation: !${_}=${v}`)}return n}function $u(i){const n=AR.exec(i);if(!n)throw new RangeError(`invalid RFC 9557 string: ${i}`);const o=Sv(n[16]);let h=n[1];if(h==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);const p=+h,_=+(n[2]??n[4]??1),v=+(n[3]??n[5]??1),c=n[6]!==void 0,D=+(n[6]??0),I=+(n[7]??n[10]??0);let P=+(n[8]??n[11]??0);P===60&&(P=59);const B=(n[9]??n[12]??"")+"000000000",U=+B.slice(0,3),Z=+B.slice(3,6),ne=+B.slice(6,9);let ye,me=!1;n[13]?(ye=void 0,me=!0):n[14]&&(ye=n[14]);const Pe=n[15];return Ob(p,_,v,D,I,P,U,Z,ne),{year:p,month:_,day:v,time:c?{hour:D,minute:I,second:P,millisecond:U,microsecond:Z,nanosecond:ne}:"start-of-day",tzAnnotation:Pe,offset:ye,z:me,calendar:o}}function vS(i){const n=MR.exec(i);let o,h,p,_,v,c,D;if(n){D=Sv(n[10]),o=+(n[1]??0),h=+(n[2]??n[5]??0),p=+(n[3]??n[6]??0),p===60&&(p=59);const I=(n[4]??n[7]??"")+"000000000";if(_=+I.slice(0,3),v=+I.slice(3,6),c=+I.slice(6,9),n[8])throw new RangeError("Z designator not supported for PlainTime")}else{let I,P;if({time:I,z:P,calendar:D}=$u(i),I==="start-of-day")throw new RangeError(`time is missing in string: ${i}`);if(P)throw new RangeError("Z designator not supported for PlainTime");({hour:o,minute:h,second:p,millisecond:_,microsecond:v,nanosecond:c}=I)}if(Cv(o,h,p,_,v,c),/[tT ][0-9][0-9]/.test(i))return{hour:o,minute:h,second:p,millisecond:_,microsecond:v,nanosecond:c,calendar:D};try{const{month:I,day:P}=zb(i);zp(1972,I,P)}catch{try{const{year:I,month:P}=Rb(i);zp(I,P,1)}catch{return{hour:o,minute:h,second:p,millisecond:_,microsecond:v,nanosecond:c,calendar:D}}}throw new RangeError(`invalid RFC 9557 time-only string ${i}; may need a T prefix`)}function Rb(i){const n=CR.exec(i);let o,h,p,_;if(n){p=Sv(n[3]);let v=n[1];if(v==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);if(o=+v,h=+n[2],_=1,p!==void 0&&p!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let v;if({year:o,month:h,calendar:p,day:_,z:v}=$u(i),v)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:o,month:h,calendar:p,referenceISODay:_}}function zb(i){const n=DR.exec(i);let o,h,p,_;if(n){if(p=Sv(n[3]),o=+n[1],h=+n[2],p!==void 0&&p!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let v;if({month:o,day:h,calendar:p,year:_,z:v}=$u(i),v)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:o,day:h,calendar:p,referenceISOYear:_}}const xS=new RegExp(`^${R_.source}$`,"i"),bS=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])?)?/.source}$`);function wS(i){const n=GR.test(i)?"Seconds not allowed in offset time zone":"Invalid time zone";throw new RangeError(`${n}: ${i}`)}function af(i){return xS.test(i)||wS(i),bS.test(i)?{offsetMinutes:_g(i)/6e10}:{tzName:i}}function r_(i,n,o,h){let p=i,_=n,v=o;switch(h){case"reject":zp(p,_,v);break;case"constrain":({year:p,month:_,day:v}=BS(p,_,v))}return{year:p,month:_,day:v}}function Ev(i,n,o,h,p,_,v){let c=i,D=n,I=o,P=h,B=p,U=_;switch(v){case"reject":Cv(c,D,I,P,B,U);break;case"constrain":c=qs(c,0,23),D=qs(D,0,59),I=qs(I,0,59),P=qs(P,0,999),B=qs(B,0,999),U=qs(U,0,999)}return{hour:c,minute:D,second:I,millisecond:P,microsecond:B,nanosecond:U}}function TS(i){if(!kr(i))throw new TypeError("invalid duration-like");const n={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let o=!1;for(let h=0;h<Q0.length;h++){const p=Q0[h],_=i[p];_!==void 0&&(o=!0,n[p]=Bc(_))}if(!o)throw new TypeError("invalid duration-like");return n}function ps({years:i,months:n,weeks:o,days:h},p,_,v){return{years:i,months:v??n,weeks:_??o,days:p??h}}function li(i,n){return{isoDate:i,time:n}}function si(i){return Xh(i,"overflow",["constrain","reject"],"constrain")}function a_(i){return Xh(i,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function Gc(i,n){return Xh(i,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],n)}function B0(i,n){return Xh(i,"offset",["prefer","use","ignore","reject"],n)}function N_(i){return Xh(i,"calendarName",["auto","always","never","critical"],"auto")}function gg(i){let n=i.roundingIncrement;if(n===void 0)return 1;const o=Mn(n);if(o<1||o>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${n}`);return o}function yg(i,n,o){const h=o?n:n-1;if(i>h)throw new RangeError(`roundingIncrement must be at least 1 and less than ${h}, not ${i}`);if(n%i!=0)throw new RangeError(`Rounding increment must divide evenly into ${n}`)}function P_(i){const n=i.fractionalSecondDigits;if(n===void 0)return"auto";if(typeof n!="number"){if(Tv(n)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return"auto"}const o=Math.floor(n);if(!Number.isFinite(o)||o<0||o>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return o}function L_(i,n){switch(i){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(n){case"auto":return{precision:n,unit:"nanosecond",increment:1};case 0:return{precision:n,unit:"second",increment:1};case 1:case 2:case 3:return{precision:n,unit:"millisecond",increment:10**(3-n)};case 4:case 5:case 6:return{precision:n,unit:"microsecond",increment:10**(6-n)};case 7:case 8:case 9:return{precision:n,unit:"nanosecond",increment:10**(9-n)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`)}}const ed=Symbol("~required~");function So(i,n,o,h,p=[]){let _=[];for(let I=0;I<rg.length;I++){const P=rg[I],B=P[1],U=P[2];o!=="datetime"&&o!==U||_.push(B)}_=_.concat(p);let v=h;v===ed?v=void 0:v!==void 0&&_.push(v);let c=[];c=c.concat(_);for(let I=0;I<_.length;I++){const P=_[I],B=FR[P];B!==void 0&&c.push(B)}let D=Xh(i,n,c,v);if(D===void 0&&h===ed)throw new RangeError(`${n} is required`);return D&&D in Tw?Tw[D]:D}function mx(i){const n=i.relativeTo;if(n===void 0)return{};let o,h,p,_,v,c="option",D=!1;if(kr(n)){if(Un(n))return{zonedRelativeTo:n};if(Cr(n))return{plainRelativeTo:n};if(Ki(n))return{plainRelativeTo:Hs(te(n,hr).isoDate,te(n,kt))};p=U_(n);const I=sl(p,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],[]);({isoDate:o,time:h}=j_(p,I,"constrain")),{offset:v,timeZone:_}=I,v===void 0&&(c="wall")}else{let I,P,B,U,Z;if({year:B,month:U,day:Z,time:h,calendar:p,tzAnnotation:I,offset:v,z:P}=$u(pa(n)),I)_=Xs(I),P?c="exact":v||(c="wall"),D=!0;else if(P)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");p||(p="iso8601"),p=Ks(p),o={year:B,month:U,day:Z}}return _===void 0?{plainRelativeTo:Hs(o,p)}:{zonedRelativeTo:fs(K0(o,h,c,c==="option"?_g(v):0,_,"compatible","reject",D),_,p)}}function Oh(i){return te(i,Bs)!==0?"year":te(i,Fs)!==0?"month":te(i,bo)!==0?"week":te(i,Us)!==0?"day":te(i,Vs)!==0?"hour":te(i,Gs)!==0?"minute":te(i,Zs)!==0?"second":te(i,$s)!==0?"millisecond":te(i,Ys)!==0?"microsecond":"nanosecond"}function qh(i,n){return i_.indexOf(i)>i_.indexOf(n)?n:i}function Iu(i){return i==="year"||i==="month"||i==="week"}function jh(i){return Iu(i)||i==="day"?"date":"time"}function pf(i){return Ha("%calendarImpl%")(i)}function O_(i){return Ha("%calendarImpl%")(te(i,kt))}function Ws(i,n,o="date"){const h=Object.create(null),p=pf(i).isoToDate(n,{year:!0,monthCode:!0,day:!0});return h.monthCode=p.monthCode,o!=="month-day"&&o!=="date"||(h.day=p.day),o!=="year-month"&&o!=="date"||(h.year=p.year),h}function sl(i,n,o,h,p){const _=pf(i).extraFields(o),v=o.concat(h,_),c=Object.create(null);let D=!1;v.sort();for(let I=0;I<v.length;I++){const P=v[I],B=n[P];if(B!==void 0)D=!0,c[P]=(0,jR[P])(B);else if(p!=="partial"){if(p.includes(P))throw new TypeError(`required property '${P}' missing or undefined`);c[P]=BR[P]}}if(p==="partial"&&!D)throw new TypeError("no supported properties found");return c}function Hx(i,n="complete"){const o=["hour","microsecond","millisecond","minute","nanosecond","second"];let h=!1;const p=Object.create(null);for(let _=0;_<o.length;_++){const v=o[_],c=i[v];c!==void 0?(p[v]=Mn(c),h=!0):n==="complete"&&(p[v]=0)}if(!h)throw new TypeError("invalid time-like");return p}function $y(i,n){if(kr(i)){if(Cr(i))return si(an(n)),Hs(te(i,vn),te(i,kt));if(Un(i)){const D=ql(te(i,wi),te(i,_n));return si(an(n)),Hs(D.isoDate,te(i,kt))}if(Ki(i))return si(an(n)),Hs(te(i,hr).isoDate,te(i,kt));const c=U_(i);return Hs(uf(c,sl(c,i,["year","month","monthCode","day"],[],[]),si(an(n))),c)}let{year:o,month:h,day:p,calendar:_,z:v}=$u(pa(i));if(v)throw new RangeError("Z designator not supported for PlainDate");return _||(_="iso8601"),_=Ks(_),si(an(n)),Hs({year:o,month:h,day:p},_)}function j_(i,n,o){return li(uf(i,n,o),Ev(n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond,o))}function Yy(i,n){let o,h,p;if(kr(i)){if(Ki(i))return si(an(n)),Ul(te(i,hr),te(i,kt));if(Un(i)){const c=ql(te(i,wi),te(i,_n));return si(an(n)),Ul(c,te(i,kt))}if(Cr(i))return si(an(n)),Ul(li(te(i,vn),{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),te(i,kt));p=U_(i);const _=sl(p,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],[]),v=si(an(n));({isoDate:o,time:h}=j_(p,_,v))}else{let _,v,c,D;if({year:v,month:c,day:D,time:h,calendar:p,z:_}=$u(pa(i)),_)throw new RangeError("Z designator not supported for PlainDateTime");h==="start-of-day"&&(h={deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),Ob(v,c,D,h.hour,h.minute,h.second,h.millisecond,h.microsecond,h.nanosecond),p||(p="iso8601"),p=Ks(p),si(an(n)),o={year:v,month:c,day:D}}return Ul(li(o,h),p)}function Zl(i){const n=Ha("%Temporal.Duration%");if(Mr(i))return new n(te(i,Bs),te(i,Fs),te(i,bo),te(i,Us),te(i,Vs),te(i,Gs),te(i,Zs),te(i,$s),te(i,Ys),te(i,wo));if(!kr(i))return function(p){const{years:_,months:v,weeks:c,days:D,hours:I,minutes:P,seconds:B,milliseconds:U,microseconds:Z,nanoseconds:ne}=function(ye){const me=IR.exec(ye);if(!me)throw new RangeError(`invalid duration: ${ye}`);if(me.every((_t,qt)=>qt<2||_t===void 0))throw new RangeError(`invalid duration: ${ye}`);const Pe=me[1]==="-"?-1:1,tt=me[2]===void 0?0:Mn(me[2])*Pe,Je=me[3]===void 0?0:Mn(me[3])*Pe,$e=me[4]===void 0?0:Mn(me[4])*Pe,Me=me[5]===void 0?0:Mn(me[5])*Pe,Ve=me[6]===void 0?0:Mn(me[6])*Pe,ct=me[7],ot=me[8],Re=me[9],mt=me[10],It=me[11];let Lt=0,Ut=0,sn=0;if(ct!==void 0){if(ot??Re??mt??It)throw new RangeError("only the smallest unit can be fractional");sn=3600*Mn((ct+"000000000").slice(0,9))*Pe}else if(Lt=ot===void 0?0:Mn(ot)*Pe,Re!==void 0){if(mt??It)throw new RangeError("only the smallest unit can be fractional");sn=60*Mn((Re+"000000000").slice(0,9))*Pe}else Ut=mt===void 0?0:Mn(mt)*Pe,It!==void 0&&(sn=Mn((It+"000000000").slice(0,9))*Pe);const on=sn%1e3,Ye=Math.trunc(sn/1e3)%1e3,gt=Math.trunc(sn/1e6)%1e3;return Ut+=Math.trunc(sn/1e9)%60,Lt+=Math.trunc(sn/6e10),Dv(tt,Je,$e,Me,Ve,Lt,Ut,gt,Ye,on),{years:tt,months:Je,weeks:$e,days:Me,hours:Ve,minutes:Lt,seconds:Ut,milliseconds:gt,microseconds:Ye,nanoseconds:on}}(p);return new(Ha("%Temporal.Duration%"))(_,v,c,D,I,P,B,U,Z,ne)}(pa(i));const o={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let h=TS(i);for(let p=0;p<Q0.length;p++){const _=Q0[p],v=h[_];v!==void 0&&(o[_]=v)}return new n(o.years,o.months,o.weeks,o.days,o.hours,o.minutes,o.seconds,o.milliseconds,o.microseconds,o.nanoseconds)}function qy(i){let n;if(kr(i)){if($a(i)||Un(i))return Pu(te(i,_n));n=Yx(i)}else n=i;const{year:o,month:h,day:p,time:_,offset:v,z:c}=function(ye){const me=$u(ye);if(!me.z&&!me.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return me}(pa(n)),{hour:D=0,minute:I=0,second:P=0,millisecond:B=0,microsecond:U=0,nanosecond:Z=0}=_==="start-of-day"?{}:_,ne=__(o,h,p,D,I,P,B,U,Z-(c?0:_g(v)));return Wm(ne.isoDate),Pu(qa(ne))}function Ew(i,n){if(kr(i)){if(Jo(i))return si(an(n)),Ym(te(i,vn),te(i,kt));let c;return Qs(i,kt)?c=te(i,kt):(c=i.calendar,c===void 0&&(c="iso8601"),c=F_(c)),Ym(J0(c,sl(c,i,["year","month","monthCode","day"],[],[]),si(an(n))),c)}let{month:o,day:h,referenceISOYear:p,calendar:_}=zb(pa(i));if(_===void 0&&(_="iso8601"),_=Ks(_),si(an(n)),_==="iso8601")return Ym({year:1972,month:o,day:h},_);let v={year:p,month:o,day:h};return Gp(v),v=J0(_,Ws(_,v,"month-day"),"constrain"),Ym(v,_)}function tf(i,n){let o;if(kr(i)){if(Lr(i))return si(an(n)),Uh(te(i,Dr));if(Ki(i))return si(an(n)),Uh(te(i,hr).time);if(Un(i)){const I=ql(te(i,wi),te(i,_n));return si(an(n)),Uh(I.time)}const{hour:h,minute:p,second:_,millisecond:v,microsecond:c,nanosecond:D}=Hx(i);o=Ev(h,p,_,v,c,D,si(an(n)))}else o=vS(pa(i)),si(an(n));return Uh(o)}function SS(i){return i===void 0?{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}:te(tf(i),Dr)}function Hy(i,n){if(kr(i)){if(Ya(i))return si(an(n)),Xm(te(i,vn),te(i,kt));const c=U_(i);return Xm(m_(c,sl(c,i,["year","month","monthCode"],[],[]),si(an(n))),c)}let{year:o,month:h,referenceISODay:p,calendar:_}=Rb(pa(i));_===void 0&&(_="iso8601"),_=Ks(_),si(an(n));let v={year:o,month:h,day:p};return jb(v),v=m_(_,Ws(_,v,"year-month"),"constrain"),Xm(v,_)}function K0(i,n,o,h,p,_,v,c){if(n==="start-of-day")return Jd(p,i);const D=li(i,n);if(o==="wall"||v==="ignore")return ms(p,D,_);if(o==="exact"||v==="use"){const B=__(i.year,i.month,i.day,n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond-h);Wm(B.isoDate);const U=qa(B);return Vu(U),U}Wm(i);const I=qa(D),P=g_(p,D);for(let B=0;B<P.length;B++){const U=P[B],Z=Q.toNumber(Q.subtract(I,U)),ne=nf(Z,6e10,"halfExpand");if(Z===h||c&&ne===h)return U}if(v==="reject"){const B=Xx(h),U=y_(D,"iso8601","auto");throw new RangeError(`Offset ${B} is invalid for ${U} in ${p}`)}return zS(P,p,D,_)}function Xy(i,n){let o,h,p,_,v,c,D,I=!1,P="option";if(kr(i)){if(Un(i)){const ye=an(n);return a_(ye),B0(ye,"reject"),si(ye),fs(te(i,_n),te(i,wi),te(i,kt))}v=U_(i);const U=sl(v,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],["timeZone"]);({offset:_,timeZone:p}=U),_===void 0&&(P="wall");const Z=an(n);c=a_(Z),D=B0(Z,"reject");const ne=si(Z);({isoDate:o,time:h}=j_(v,U,ne))}else{let U,Z,ne,ye,me;({year:ne,month:ye,day:me,time:h,tzAnnotation:U,offset:_,z:Z,calendar:v}=function(tt){const Je=$u(tt);if(!Je.tzAnnotation)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return Je}(pa(i))),p=Xs(U),Z?P="exact":_||(P="wall"),v||(v="iso8601"),v=Ks(v),I=!0;const Pe=an(n);c=a_(Pe),D=B0(Pe,"reject"),si(Pe),o={year:ne,month:ye,day:me}}let B=0;return P==="option"&&(B=_g(_)),fs(K0(o,h,P,B,p,c,D,I),p,v)}function ES(i,n,o){Gp(n),id(i),On(i,vn,n),On(i,kt,o),On(i,nS,!0)}function Hs(i,n){const o=Ha("%Temporal.PlainDate%"),h=Object.create(o.prototype);return ES(h,i,n),h}function AS(i,n,o){Np(n),id(i),On(i,hr,n),On(i,kt,o)}function Ul(i,n){const o=Ha("%Temporal.PlainDateTime%"),h=Object.create(o.prototype);return AS(h,i,n),h}function MS(i,n,o){Gp(n),id(i),On(i,vn,n),On(i,kt,o),On(i,rS,!0)}function Ym(i,n){const o=Ha("%Temporal.PlainMonthDay%"),h=Object.create(o.prototype);return MS(h,i,n),h}function CS(i,n){id(i),On(i,Dr,n)}function Uh(i){const n=Ha("%Temporal.PlainTime%"),o=Object.create(n.prototype);return CS(o,i),o}function DS(i,n,o){jb(n),id(i),On(i,vn,n),On(i,kt,o),On(i,iS,!0)}function Xm(i,n){const o=Ha("%Temporal.PlainYearMonth%"),h=Object.create(o.prototype);return DS(h,i,n),h}function kS(i,n){Vu(n),id(i),On(i,_n,n)}function Pu(i){const n=Ha("%Temporal.Instant%"),o=Object.create(n.prototype);return kS(o,i),o}function IS(i,n,o,h){Vu(n),id(i),On(i,_n,n),On(i,wi,o),On(i,kt,h)}function fs(i,n,o="iso8601"){const h=Ha("%Temporal.ZonedDateTime%"),p=Object.create(h.prototype);return IS(p,i,n,o),p}function Aw(i){return qx.filter(n=>i[n]!==void 0)}function Rp(i,n,o){const h=Aw(o),p=pf(i).fieldKeysToIgnore(h),_=Object.create(null),v=Aw(n);for(let c=0;c<qx.length;c++){let D;const I=qx[c];v.includes(I)&&!p.includes(I)&&(D=n[I]),h.includes(I)&&(D=o[I]),D!==void 0&&(_[I]=D)}return _}function nl(i,n,o,h){const p=pf(i).dateAdd(n,o,h);return Gp(p),p}function B_(i,n,o,h){return pf(i).dateUntil(n,o,h)}function F_(i){if(kr(i)&&Qs(i,kt))return te(i,kt);const n=pa(i);try{return Ks(n)}catch{}let o;try{({calendar:o}=$u(n))}catch{try{({calendar:o}=vS(n))}catch{try{({calendar:o}=Rb(n))}catch{({calendar:o}=zb(n))}}}return o||(o="iso8601"),Ks(o)}function U_(i){if(Qs(i,kt))return te(i,kt);const{calendar:n}=i;return n===void 0?"iso8601":F_(n)}function Uu(i,n){return Ks(i)===Ks(n)}function uf(i,n,o){const h=pf(i);h.resolveFields(n,"date");const p=h.dateToISO(n,o);return Gp(p),p}function m_(i,n,o){const h=pf(i);h.resolveFields(n,"year-month"),n.day=1;const p=h.dateToISO(n,o);return jb(p),p}function J0(i,n,o){const h=pf(i);h.resolveFields(n,"month-day");const p=h.monthDayToISOReferenceDate(n,o);return Gp(p),p}function Xs(i){if(kr(i)&&Un(i))return te(i,wi);const n=pa(i);if(n==="UTC")return"UTC";const{tzName:o,offsetMinutes:h}=function(_){const{tzAnnotation:v,offset:c,z:D}=function(I){if(xS.test(I))return{tzAnnotation:I,offset:void 0,z:!1};try{const{tzAnnotation:P,offset:B,z:U}=$u(I);if(U||P||B)return{tzAnnotation:P,offset:B,z:U}}catch{}wS(I)}(_);return v?af(v):D?af("UTC"):c?af(c):void 0}(n);if(h!==void 0)return Nb(h);const p=ev(o);if(!p)throw new RangeError(`Unrecognized time zone ${o}`);return p.identifier}function RS(i,n){if(i===n)return!0;const o=af(i).offsetMinutes,h=af(n).offsetMinutes;if(o===void 0&&h===void 0){const p=ev(n);if(!p)return!1;const _=ev(i);return!!_&&_.primaryIdentifier===p.primaryIdentifier}return o===h}function Vh(i,n){const o=af(i).offsetMinutes;return o!==void 0?6e10*o:Wx(i,n)}function Xx(i){const n=i<0?"-":"+",o=Math.abs(i),h=Math.floor(o/36e11),p=Math.floor(o/6e10)%60,_=Math.floor(o/1e9)%60,v=o%1e9;return`${n}${Av(h,p,_,v,_===0&&v===0?"minute":"auto")}`}function ql(i,n){const o=Vh(i,n);let{isoDate:{year:h,month:p,day:_},time:{hour:v,minute:c,second:D,millisecond:I,microsecond:P,nanosecond:B}}=LS(n);return __(h,p,_,v,c,D,I,P,B+o)}function ms(i,n,o){return zS(g_(i,n),i,n,o)}function zS(i,n,o,h){const p=i.length;if(p===1)return i[0];if(p)switch(h){case"compatible":case"earlier":return i[0];case"later":return i[p-1];case"reject":throw new RangeError("multiple instants found")}if(h==="reject")throw new RangeError("multiple instants found");const _=qa(o),v=Q.subtract(_,lf);Vu(v);const c=Vh(n,v),D=Q.add(_,lf);Vu(D);const I=Vh(n,D)-c;switch(h){case"earlier":{const P=Vn.fromComponents(0,0,0,0,0,-I),B=sg(o.time,P);return g_(n,li(Mo(o.isoDate.year,o.isoDate.month,o.isoDate.day+B.deltaDays),B))[0]}case"compatible":case"later":{const P=Vn.fromComponents(0,0,0,0,0,I),B=sg(o.time,P),U=g_(n,li(Mo(o.isoDate.year,o.isoDate.month,o.isoDate.day+B.deltaDays),B));return U[U.length-1]}}}function g_(i,n){if(i==="UTC")return Wm(n.isoDate),[qa(n)];const o=af(i).offsetMinutes;if(o!==void 0){const h=__(n.isoDate.year,n.isoDate.month,n.isoDate.day,n.time.hour,n.time.minute-o,n.time.second,n.time.millisecond,n.time.microsecond,n.time.nanosecond);Wm(h.isoDate);const p=qa(h);return Vu(p),[p]}return Wm(n.isoDate),function(h,p){let _=qa(p),v=Q.subtract(_,lf);Q.lessThan(v,f_)&&(v=_);let c=Q.add(_,lf);Q.greaterThan(c,ig)&&(c=_);const D=Wx(h,v),I=Wx(h,c);return(D===I?[D]:[D,I]).map(B=>{const U=Q.subtract(_,Q.BigInt(B)),Z=function(ne,ye){const{epochMilliseconds:me,time:{millisecond:Pe,microsecond:tt,nanosecond:Je}}=LS(ye),{year:$e,month:Me,day:Ve,hour:ct,minute:ot,second:Re}=OS(ne,me);return __($e,Me,Ve,ct,ot,Re,Pe,tt,Je)}(h,U);if(og(p,Z)===0)return Vu(U),U}).filter(B=>B!==void 0)}(i,n)}function Jd(i,n){const o=li(n,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),h=g_(i,o);if(h.length)return h[0];const p=qa(o),_=Q.subtract(p,lf);return Vu(_),Lb(i,_)}function V_(i){let n;return n=i<0||i>9999?(i<0?"-":"+")+p_(Math.abs(i),6):p_(i,4),n}function il(i){return p_(i,2)}function NS(i,n){let o;if(n==="auto"){if(i===0)return"";o=p_(i,9).replace(/0+$/,"")}else{if(n===0)return"";o=p_(i,9).slice(0,n)}return`.${o}`}function Av(i,n,o,h,p){let _=`${il(i)}:${il(n)}`;return p==="minute"||(_+=`:${il(o)}`,_+=NS(h,p)),_}function Mw(i,n,o){let h=n;h===void 0&&(h="UTC");const p=te(i,_n),_=y_(ql(h,p),"iso8601",o,"never");let v="Z";return n!==void 0&&(v=PS(Vh(h,p))),`${_}${v}`}function z0(i,n){const o=te(i,Bs),h=te(i,Fs),p=te(i,bo),_=te(i,Us),v=te(i,Vs),c=te(i,Gs),D=nv(i);let I="";o!==0&&(I+=`${Math.abs(o)}Y`),h!==0&&(I+=`${Math.abs(h)}M`),p!==0&&(I+=`${Math.abs(p)}W`),_!==0&&(I+=`${Math.abs(_)}D`);let P="";v!==0&&(P+=`${Math.abs(v)}H`),c!==0&&(P+=`${Math.abs(c)}M`);const B=Vn.fromComponents(0,0,te(i,Zs),te(i,$s),te(i,Ys),te(i,wo));B.isZero()&&!["second","millisecond","microsecond","nanosecond"].includes(Oh(i))&&n==="auto"||(P+=`${Math.abs(B.sec)}${NS(Math.abs(B.subsec),n)}S`);let U=`${D<0?"-":""}P${I}`;return P&&(U=`${U}T${P}`),U}function Cw(i,n="auto"){const{year:o,month:h,day:p}=te(i,vn);return`${V_(o)}-${il(h)}-${il(p)}${z_(te(i,kt),n)}`}function Dw({hour:i,minute:n,second:o,millisecond:h,microsecond:p,nanosecond:_},v){return Av(i,n,o,1e6*h+1e3*p+_,v)}function y_(i,n,o,h="auto"){const{isoDate:{year:p,month:_,day:v},time:{hour:c,minute:D,second:I,millisecond:P,microsecond:B,nanosecond:U}}=i;return`${V_(p)}-${il(_)}-${il(v)}T${Av(c,D,I,1e6*P+1e3*B+U,o)}${z_(n,h)}`}function kw(i,n="auto"){const{year:o,month:h,day:p}=te(i,vn);let _=`${il(h)}-${il(p)}`;const v=te(i,kt);n!=="always"&&n!=="critical"&&v==="iso8601"||(_=`${V_(o)}-${_}`);const c=z_(v,n);return c&&(_+=c),_}function Iw(i,n="auto"){const{year:o,month:h,day:p}=te(i,vn);let _=`${V_(o)}-${il(h)}`;const v=te(i,kt);n!=="always"&&n!=="critical"&&v==="iso8601"||(_+=`-${il(p)}`);const c=z_(v,n);return c&&(_+=c),_}function Rw(i,n,o="auto",h="auto",p="auto",_=void 0){let v=te(i,_n);if(_){const{unit:P,increment:B,roundingMode:U}=_;v=eb(v,B,P,U)}const c=te(i,wi),D=Vh(c,v);let I=y_(ql(c,v),"iso8601",n,"never");return p!=="never"&&(I+=PS(D)),h!=="never"&&(I+=`[${h==="critical"?"!":""}${c}]`),I+=z_(te(i,kt),o),I}function zw(i){return bS.test(i)}function _g(i){const n=ZR.exec(i);if(!n)throw new RangeError(`invalid time zone offset: ${i}; must match ±HH:MM[:SS.SSSSSSSSS]`);return(n[1]==="-"?-1:1)*(1e9*(60*(60*+n[2]+ +(n[3]||0))+ +(n[4]||0))+ +((n[5]||0)+"000000000").slice(0,9))}let xp;const VR=Object.assign(Object.create(null),{"/":!0,"-":!0,_:!0});function ev(i){var _;if(xp===void 0){const v=(_=Intl.supportedValuesOf)==null?void 0:_.call(Intl,"timeZone");if(v){xp=new Map;for(let c=0;c<v.length;c++){const D=v[c];xp.set(v_(D),D)}}else xp=null}const n=v_(i);let o=xp==null?void 0:xp.get(n);if(o)return{identifier:o,primaryIdentifier:o};try{o=_S(i).resolvedOptions().timeZone}catch{return}if(n==="antarctica/south_pole"&&(o="Antarctica/McMurdo"),OR.has(i))throw new RangeError(`${i} is a legacy time zone identifier from ICU. Use ${o} instead`);const h=[...n].map((v,c)=>c===0||VR[n[c-1]]?v.toUpperCase():v).join("").split("/");if(h.length===1)return n==="gb-eire"?{identifier:"GB-Eire",primaryIdentifier:o}:{identifier:n.length<=3||/[-0-9]/.test(n)?n.toUpperCase():h[0],primaryIdentifier:o};if(h[0]==="Etc")return{identifier:`Etc/${["Zulu","Greenwich","Universal"].includes(h[1])?h[1]:h[1].toUpperCase()}`,primaryIdentifier:o};if(h[0]==="Us")return{identifier:`US/${h[1]}`,primaryIdentifier:o};const p=new Map([["Act","ACT"],["Lhi","LHI"],["Nsw","NSW"],["Dar_Es_Salaam","Dar_es_Salaam"],["Port_Of_Spain","Port_of_Spain"],["Port-Au-Prince","Port-au-Prince"],["Isle_Of_Man","Isle_of_Man"],["Comodrivadavia","ComodRivadavia"],["Knox_In","Knox_IN"],["Dumontdurville","DumontDUrville"],["Mcmurdo","McMurdo"],["Denoronha","DeNoronha"],["Easterisland","EasterIsland"],["Bajanorte","BajaNorte"],["Bajasur","BajaSur"]]);return h[1]=p.get(h[1])??h[1],h.length>2&&(h[2]=p.get(h[2])??h[2]),{identifier:h.join("/"),primaryIdentifier:o}}function Ap(i,n){const{year:o,month:h,day:p,hour:_,minute:v,second:c}=OS(i,n);let D=n%1e3;return D<0&&(D+=1e3),1e6*(Pb({isoDate:{year:o,month:h,day:p},time:{hour:_,minute:v,second:c,millisecond:D}})-n)}function Wx(i,n){return Ap(i,Hl(n,"floor"))}function Nb(i){const n=i<0?"-":"+",o=Math.abs(i);return`${n}${Av(Math.floor(o/60),o%60,0,0,"minute")}`}function PS(i){return Nb(nf(i,RR,"halfExpand")/6e10)}function Pb({isoDate:{year:i,month:n,day:o},time:{hour:h,minute:p,second:_,millisecond:v}}){const c=i%400,D=(i-c)/400,I=new Date;return I.setUTCHours(h,p,_,v),I.setUTCFullYear(c,n-1,o),I.getTime()+PR*D}function qa(i){const n=Pb(i),o=1e3*i.time.microsecond+i.time.nanosecond;return Q.add(Ou(n),Q.BigInt(o))}function LS(i){let n=Hl(i,"trunc"),o=Q.toNumber(Q.remainder(i,I_));o<0&&(o+=1e6,n-=1);const h=Math.floor(o/1e3)%1e3,p=o%1e3,_=new Date(n);return{epochMilliseconds:n,isoDate:{year:_.getUTCFullYear(),month:_.getUTCMonth()+1,day:_.getUTCDate()},time:{hour:_.getUTCHours(),minute:_.getUTCMinutes(),second:_.getUTCSeconds(),millisecond:_.getUTCMilliseconds(),microsecond:h,nanosecond:p}}}function Lb(i,n){if(i==="UTC")return null;const o=Hl(n,"floor");if(o<n_)return Lb(i,Ou(n_));const h=Date.now(),p=Math.max(o,h)+366*cf*3;let _=o,v=Ap(i,_),c=_,D=v;for(;v===D&&_<p;){if(c=_+2*cf*7,c>yS)return null;D=Ap(i,c),v===D&&(_=c)}return v===D?null:Ou(qS(I=>Ap(i,I),_,c,v,D))}function Qx(i,n){if(i==="UTC")return null;const o=Hl(n,"ceil"),h=Date.now(),p=h+366*cf*3;if(o>p){const I=Qx(i,Ou(p));if(I===null||Q.lessThan(I,Ou(h)))return I}if(i==="Africa/Casablanca"||i==="Africa/El_Aaiun"){const I=Date.UTC(2088,0,1);if(I<o)return Qx(i,Ou(I))}let _=o-1;if(_<n_)return null;let v=Ap(i,_),c=_,D=v;for(;v===D&&_>n_;){if(c=_-2*cf*7,c<n_)return null;D=Ap(i,c),v===D&&(_=c)}return v===D?null:Ou(qS(I=>Ap(i,I),c,_,D,v))}function OS(i,n){return function(o){const h=o.split(/[^\w]+/);if(h.length!==7)throw new RangeError(`expected 7 parts in "${o}`);const p=+h[0],_=+h[1];let v=+h[2];const c=h[3];if(c[0]==="b"||c[0]==="B")v=1-v;else if(c[0]!=="a"&&c[0]!=="A")throw new RangeError(`Unknown era ${c} in "${o}`);const D=h[4]==="24"?0:+h[4],I=+h[5],P=+h[6];if(!(Number.isFinite(v)&&Number.isFinite(p)&&Number.isFinite(_)&&Number.isFinite(D)&&Number.isFinite(I)&&Number.isFinite(P)))throw new RangeError(`Invalid number in "${o}`);return{year:v,month:p,day:_,hour:D,minute:I,second:P}}(_S(i).format(n))}function tv(i){return i!==void 0&&!(i%4!=0||i%100==0&&i%400!=0)}function Mp(i,n){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[tv(i)?"leapyear":"standard"][n-1]}function nv(i){const n=[te(i,Bs),te(i,Fs),te(i,bo),te(i,Us),te(i,Vs),te(i,Gs),te(i,Zs),te(i,$s),te(i,Ys),te(i,wo)];for(let o=0;o<n.length;o++){const h=n[o];if(h!==0)return h<0?-1:1}return 0}function Mv(i){const n=["years","months","weeks","days"];for(let o=0;o<n.length;o++){const h=i[n[o]];if(h!==0)return h<0?-1:1}return 0}function jS(i){const n=Mv(i.date);return n!==0?n:i.time.sign()}function Sp(i,n){let o=i,h=n;if(!Number.isFinite(o)||!Number.isFinite(h))throw new RangeError("infinity is out of range");return h-=1,o+=Math.floor(h/12),h%=12,h<0&&(h+=12),h+=1,{year:o,month:h}}function Mo(i,n,o){let h=i,p=n,_=o;if(!Number.isFinite(_))throw new RangeError("infinity is out of range");({year:h,month:p}=Sp(h,p));const v=146097;if(Math.abs(_)>v){const I=Math.trunc(_/v);h+=400*I,_-=I*v}let c=0,D=p>2?h:h-1;for(;c=tv(D)?366:365,_<-c;)h-=1,D-=1,_+=c;for(D+=1;c=tv(D)?366:365,_>c;)h+=1,D+=1,_-=c;for(;_<1;)({year:h,month:p}=Sp(h,p-1)),_+=Mp(h,p);for(;_>Mp(h,p);)_-=Mp(h,p),{year:h,month:p}=Sp(h,p+1);return{year:h,month:p,day:_}}function __(i,n,o,h,p,_,v,c,D){const I=ef(h,p,_,v,c,D);return li(Mo(i,n,o+I.deltaDays),I)}function ef(i,n,o,h,p,_){let v,c=i,D=n,I=o,P=h,B=p,U=_;({div:v,mod:U}=$m(U,3)),B+=v,U<0&&(B-=1,U+=1e3),{div:v,mod:B}=$m(B,3),P+=v,B<0&&(P-=1,B+=1e3),I+=Math.trunc(P/1e3),P%=1e3,P<0&&(I-=1,P+=1e3),D+=Math.trunc(I/60),I%=60,I<0&&(D-=1,I+=60),c+=Math.trunc(D/60),D%=60,D<0&&(c-=1,D+=60);let Z=Math.trunc(c/24);return c%=24,c<0&&(Z-=1,c+=24),Z+=0,c+=0,D+=0,I+=0,P+=0,B+=0,U+=0,{deltaDays:Z,hour:c,minute:D,second:I,millisecond:P,microsecond:B,nanosecond:U}}function Nw(i,n){const o=ps(i,0);if(Mv(o)===0)return i.days;const h=te(n,vn),p=nl(te(n,kt),h,o,"constrain"),_=Pp(h.year,h.month-1,h.day),v=Pp(p.year,p.month-1,p.day)-_;return i.days+v}function Co(i){return new(Ha("%Temporal.Duration%"))(-te(i,Bs),-te(i,Fs),-te(i,bo),-te(i,Us),-te(i,Vs),-te(i,Gs),-te(i,Zs),-te(i,$s),-te(i,Ys),-te(i,wo))}function qs(i,n,o){return Math.min(o,Math.max(n,i))}function BS(i,n,o){const h=qs(n,1,12);return{year:i,month:h,day:qs(o,1,Mp(i,h))}}function Ma(i,n,o){if(i<n||i>o)throw new RangeError(`value out of range: ${n} <= ${i} <= ${o}`)}function zp(i,n,o){Ma(n,1,12),Ma(o,1,Mp(i,n))}function Gp(i){Np(li(i,{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}))}function Cv(i,n,o,h,p,_){Ma(i,0,23),Ma(n,0,59),Ma(o,0,59),Ma(h,0,999),Ma(p,0,999),Ma(_,0,999)}function Ob(i,n,o,h,p,_,v,c,D){zp(i,n,o),Cv(h,p,_,v,c,D)}function Np(i){const n=qa(i);(Q.lessThan(n,zR)||Q.greaterThan(n,NR))&&Vu(n)}function Kx(i){qa(i)}function Vu(i){if(Q.lessThan(i,f_)||Q.greaterThan(i,ig))throw new RangeError("date/time value is outside of supported range")}function jb({year:i,month:n}){Ma(i,xw,bw),i===xw?Ma(n,4,12):i===bw&&Ma(n,1,9)}function Dv(i,n,o,h,p,_,v,c,D,I){let P=0;const B=[i,n,o,h,p,_,v,c,D,I];for(let Pe=0;Pe<B.length;Pe++){const tt=B[Pe];if(tt===1/0||tt===-1/0)throw new RangeError("infinite values not allowed as duration fields");if(tt!==0){const Je=tt<0?-1:1;if(P!==0&&Je!==P)throw new RangeError("mixed-sign values not allowed as duration fields");P=Je}}if(Math.abs(i)>=2**32||Math.abs(n)>=2**32||Math.abs(o)>=2**32)throw new RangeError("years, months, and weeks must be < 2³²");const U=$m(c,3),Z=$m(D,6),ne=$m(I,9),ye=$m(1e6*U.mod+1e3*Z.mod+ne.mod,9).div,me=86400*h+3600*p+60*_+v+U.div+Z.div+ne.div+ye;if(!Number.isSafeInteger(me))throw new RangeError("total of duration time units cannot exceed 9007199254740991.999999999 s")}function Zm(i){return{date:{years:te(i,Bs),months:te(i,Fs),weeks:te(i,bo),days:te(i,Us)},time:Vn.fromComponents(te(i,Vs),te(i,Gs),te(i,Zs),te(i,$s),te(i,Ys),te(i,wo))}}function Lu(i){const n=Vn.fromComponents(te(i,Vs),te(i,Gs),te(i,Zs),te(i,$s),te(i,Ys),te(i,wo)).add24HourDays(te(i,Us));return{date:{years:te(i,Bs),months:te(i,Fs),weeks:te(i,bo),days:0},time:n}}function FS(i){const n=Lu(i),o=Math.trunc(n.time.sec/86400);return Dv(n.date.years,n.date.months,n.date.weeks,o,0,0,0,0,0,0),{...n.date,days:o}}function Vl(i,n){const o=i.time.sign();let h=i.time.abs().subsec,p=0,_=0,v=i.time.abs().sec,c=0,D=0,I=0;switch(n){case"year":case"month":case"week":case"day":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,D=Math.trunc(c/60),c%=60,I=Math.trunc(D/24),D%=24;break;case"hour":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,D=Math.trunc(c/60),c%=60;break;case"minute":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60;break;case"second":p=Math.trunc(h/1e3),h%=1e3,_=Math.trunc(p/1e3),p%=1e3,v+=Math.trunc(_/1e3),_%=1e3;break;case"millisecond":p=Math.trunc(h/1e3),h%=1e3,_=fx(v,3,Math.trunc(p/1e3)),p%=1e3,v=0;break;case"microsecond":p=fx(v,6,Math.trunc(h/1e3)),h%=1e3,v=0;break;case"nanosecond":h=fx(v,9,h),v=0}return new(Ha("%Temporal.Duration%"))(i.date.years,i.date.months,i.date.weeks,i.date.days+o*I,o*D,o*c,o*v,o*_,o*p,o*h)}function Hh(i,n){return Mv(i),n.sign(),{date:i,time:n}}function Pp(i,n,o){return Pb({isoDate:{year:i,month:n+1,day:o},time:{hour:0,minute:0,second:0,millisecond:0}})/cf}function Wm({year:i,month:n,day:o}){if(Math.abs(Pp(i,n-1,o))>1e8)throw new RangeError("date/time value is outside the supported range")}function Bb(i,n){const o=n.hour-i.hour,h=n.minute-i.minute,p=n.second-i.second,_=n.millisecond-i.millisecond,v=n.microsecond-i.microsecond,c=n.nanosecond-i.nanosecond;return Vn.fromComponents(o,h,p,_,v,c)}function Fb(i,n,o,h,p){let _=Vn.fromEpochNsDiff(n,i);return _=iv(_,o,h,p),Hh({years:0,months:0,weeks:0,days:0},_)}function US(i,n,o,h){Kx(i),Kx(n);let p=Bb(i.time,n.time);const _=p.sign(),v=Gu(i.isoDate,n.isoDate);let c=n.isoDate;v===_&&(c=Mo(c.year,c.month,c.day+_),p=p.add24HourDays(-_));const D=qh("day",h),I=B_(o,i.isoDate,c,D);return h!==D&&(p=p.add24HourDays(I.days),I.days=0),Hh(I,p)}function VS(i,n,o,h,p){const _=Q.subtract(n,i);if(Q.equal(_,el))return{date:{years:0,months:0,weeks:0,days:0},time:Vn.ZERO};const v=Q.lessThan(_,el)?-1:1,c=ql(o,i),D=ql(o,n);let I,P=0,B=v===1?2:1,U=Bb(c.time,D.time);for(U.sign()===-v&&P++;P<=B;P++){I=li(Mo(D.isoDate.year,D.isoDate.month,D.isoDate.day-P*v),c.time);const ne=ms(o,I,"compatible");if(U=Vn.fromEpochNsDiff(n,ne),U.sign()!==-v)break}const Z=qh("day",p);return Hh(B_(h,c.isoDate,I.isoDate,Z),U)}function GS(i,n,o,h,p,_,v,c,D){let I,P,B,U,Z=n;switch(c){case"year":{const Lt=nf(Z.date.years,v,"trunc");I=Lt,P=Lt+v*i,B={years:I,months:0,weeks:0,days:0},U={...B,years:P};break}case"month":{const Lt=nf(Z.date.months,v,"trunc");I=Lt,P=Lt+v*i,B=ps(Z.date,0,0,I),U=ps(Z.date,0,0,P);break}case"week":{const Lt=ps(Z.date,0,0),Ut=nl(_,h.isoDate,Lt,"constrain"),sn=B_(_,Ut,Mo(Ut.year,Ut.month,Ut.day+Z.date.days),"week"),on=nf(Z.date.weeks+sn.weeks,v,"trunc");I=on,P=on+v*i,B=ps(Z.date,0,I),U=ps(Z.date,0,P);break}case"day":{const Lt=nf(Z.date.days,v,"trunc");I=Lt,P=Lt+v*i,B=ps(Z.date,I),U=ps(Z.date,P);break}}const ne=nl(_,h.isoDate,B,"constrain"),ye=nl(_,h.isoDate,U,"constrain");let me,Pe;const tt=li(ne,h.time),Je=li(ye,h.time);p?(me=ms(p,tt,"compatible"),Pe=ms(p,Je,"compatible")):(me=qa(tt),Pe=qa(Je));const $e=Vn.fromEpochNsDiff(o,me),Me=Vn.fromEpochNsDiff(Pe,me),Ve=xv(D,i<0?"negative":"positive"),ct=$e.add($e).abs().subtract(Me.abs()).sign(),ot=Math.abs(I)/v%2==0,Re=$e.isZero()?Math.abs(I):$e.cmp(Me)?bv(Math.abs(I),Math.abs(P),ct,ot,Ve):Math.abs(P),mt=new Vn(Q.add(Q.multiply(Me.totalNs,Q.BigInt(I)),Q.multiply($e.totalNs,Q.BigInt(v*i)))).fdiv(Me.totalNs),It=Re===Math.abs(P);return Z={date:It?U:B,time:Vn.ZERO},{nudgeResult:{duration:Z,nudgedEpochNs:It?Pe:me,didExpandCalendarUnit:It},total:mt}}function kv(i,n,o,h,p,_,v,c,D){let I=i;const P=Iu(c)||h&&c==="day",B=jS(I)<0?-1:1;let U;return P?{nudgeResult:U}=GS(B,I,n,o,h,p,v,c,D):U=h?function(Z,ne,ye,me,Pe,tt,Je,$e){let Me=ne;const Ve=nl(Pe,ye.isoDate,Me.date,"constrain"),ct=li(Ve,ye.time),ot=li(Mo(Ve.year,Ve.month,Ve.day+Z),ye.time),Re=ms(me,ct,"compatible"),mt=ms(me,ot,"compatible"),It=Vn.fromEpochNsDiff(mt,Re);if(It.sign()!==Z)throw new RangeError("time zone returned inconsistent Instants");const Lt=Q.BigInt(ag[Je]*tt);let Ut=Me.time.round(Lt,$e);const sn=Ut.subtract(It),on=sn.sign()!==-Z;let Ye,gt;return on?(Ye=Z,Ut=sn.round(Lt,$e),gt=Ut.addToEpochNs(mt)):(Ye=0,gt=Ut.addToEpochNs(Re)),{duration:Hh(ps(Me.date,Me.date.days+Ye),Ut),nudgedEpochNs:gt,didExpandCalendarUnit:on}}(B,I,o,h,p,v,c,D):function(Z,ne,ye,me,Pe,tt){let Je=Z;const $e=Je.time.add24HourDays(Je.date.days),Me=$e.round(Q.BigInt(me*ag[Pe]),tt),Ve=Me.subtract($e),{quotient:ct}=$e.divmod(W0),{quotient:ot}=Me.divmod(W0),Re=Math.sign(ot-ct)===$e.sign(),mt=Ve.addToEpochNs(ne);let It=0,Lt=Me;return jh(ye)==="date"&&(It=ot,Lt=Me.add(Vn.fromComponents(24*-ot,0,0,0,0,0))),{duration:{date:ps(Je.date,It),time:Lt},nudgedEpochNs:mt,didExpandCalendarUnit:Re}}(I,n,_,v,c,D),I=U.duration,U.didExpandCalendarUnit&&c!=="week"&&(I=function(Z,ne,ye,me,Pe,tt,Je,$e){let Me=ne;if($e===Je)return Me;const Ve=i_.indexOf(Je);for(let ct=i_.indexOf($e)-1;ct>=Ve;ct--){const ot=i_[ct];if(ot==="week"&&Je!=="week")continue;let Re;switch(ot){case"year":Re={years:Me.date.years+Z,months:0,weeks:0,days:0};break;case"month":{const Lt=Me.date.months+Z;Re=ps(Me.date,0,0,Lt);break}case"week":{const Lt=Me.date.weeks+Z;Re=ps(Me.date,0,Lt);break}}const mt=li(nl(tt,me.isoDate,Re,"constrain"),me.time);let It;if(It=Pe?ms(Pe,mt,"compatible"):qa(mt),H0(ye,It)===-Z)break;Me={date:Re,time:Vn.ZERO}}return Me}(B,I,U.nudgedEpochNs,o,h,p,_,qh(c,"day"))),I}function Pw(i,n,o,h,p,_){return Iu(_)||h&&_==="day"?GS(jS(i)<0?-1:1,i,n,o,h,p,1,_,"trunc").total:s_(i.time.add24HourDays(i.date.days),_)}function ZS(i,n,o,h,p,_,v){if(og(i,n)==0)return{date:{years:0,months:0,weeks:0,days:0},time:Vn.ZERO};Np(i),Np(n);const c=US(i,n,o,h);return _==="nanosecond"&&p===1?c:kv(c,qa(n),i,null,o,h,p,_,v)}function $S(i,n,o,h,p,_,v,c){if(jh(p)==="time")return Fb(i,n,_,v,c);const D=VS(i,n,o,h,p);return v==="nanosecond"&&_===1?D:kv(D,n,ql(o,i),o,h,p,_,v,c)}function vg(i,n,o,h,p,_){const v=rg.reduce((Z,ne)=>{const ye=ne[0],me=ne[1],Pe=ne[2];return o!=="datetime"&&Pe!==o||h.includes(me)||Z.push(me,ye),Z},[]);let c=So(n,"largestUnit",o,"auto");if(h.includes(c))throw new RangeError(`largestUnit must be one of ${v.join(", ")}, not ${c}`);const D=gg(n);let I=Gc(n,"trunc");i==="since"&&(I=function(Z){switch(Z){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return Z}}(I));const P=So(n,"smallestUnit",o,p);if(h.includes(P))throw new RangeError(`smallestUnit must be one of ${v.join(", ")}, not ${P}`);const B=qh(_,P);if(c==="auto"&&(c=B),qh(c,P)!==c)throw new RangeError(`largestUnit ${c} cannot be smaller than smallestUnit ${P}`);const U={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[P];return U!==void 0&&yg(D,U,!1),{largestUnit:c,roundingIncrement:D,roundingMode:I,smallestUnit:P}}function Lw(i,n,o,h){const p=qy(o),_=vg(i,an(h),"time",[],"nanosecond","second");let v=Vl(Fb(te(n,_n),te(p,_n),_.roundingIncrement,_.smallestUnit,_.roundingMode),_.largestUnit);return i==="since"&&(v=Co(v)),v}function Ow(i,n,o,h){const p=$y(o),_=te(n,kt),v=te(p,kt);if(!Uu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=vg(i,an(h),"date",[],"day","day"),D=Ha("%Temporal.Duration%"),I=te(n,vn),P=te(p,vn);if(Gu(I,P)===0)return new D;let B={date:B_(_,I,P,c.largestUnit),time:Vn.ZERO};if(c.smallestUnit!=="day"||c.roundingIncrement!==1){const Z=li(I,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});B=kv(B,qa(li(P,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),Z,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let U=Vl(B,"day");return i==="since"&&(U=Co(U)),U}function jw(i,n,o,h){const p=Yy(o),_=te(n,kt),v=te(p,kt);if(!Uu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=vg(i,an(h),"datetime",[],"nanosecond","day"),D=Ha("%Temporal.Duration%"),I=te(n,hr),P=te(p,hr);if(og(I,P)===0)return new D;let B=Vl(ZS(I,P,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);return i==="since"&&(B=Co(B)),B}function Bw(i,n,o,h){const p=tf(o),_=vg(i,an(h),"time",[],"nanosecond","hour");let v=Bb(te(n,Dr),te(p,Dr));v=iv(v,_.roundingIncrement,_.smallestUnit,_.roundingMode);let c=Vl(Hh({years:0,months:0,weeks:0,days:0},v),_.largestUnit);return i==="since"&&(c=Co(c)),c}function Fw(i,n,o,h){const p=Hy(o),_=te(n,kt),v=te(p,kt);if(!Uu(_,v))throw new RangeError(`cannot compute difference between months of ${_} and ${v} calendars`);const c=vg(i,an(h),"date",["week","day"],"month","year"),D=Ha("%Temporal.Duration%");if(Gu(te(n,vn),te(p,vn))==0)return new D;const I=Ws(_,te(n,vn),"year-month");I.day=1;const P=uf(_,I,"constrain"),B=Ws(_,te(p,vn),"year-month");B.day=1;const U=uf(_,B,"constrain");let Z={date:ps(B_(_,P,U,c.largestUnit),0,0),time:Vn.ZERO};if(c.smallestUnit!=="month"||c.roundingIncrement!==1){const ye=li(P,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});Z=kv(Z,qa(li(U,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),ye,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let ne=Vl(Z,"day");return i==="since"&&(ne=Co(ne)),ne}function Uw(i,n,o,h){const p=Xy(o),_=te(n,kt),v=te(p,kt);if(!Uu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=vg(i,an(h),"datetime",[],"nanosecond","hour"),D=te(n,_n),I=te(p,_n),P=Ha("%Temporal.Duration%");let B;if(jh(c.largestUnit)!=="date")B=Vl(Fb(D,I,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);else{const U=te(n,wi);if(!RS(U,te(p,wi)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");if(Q.equal(D,I))return new P;B=Vl($S(D,I,U,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),"hour")}return i==="since"&&(B=Co(B)),B}function sg({hour:i,minute:n,second:o,millisecond:h,microsecond:p,nanosecond:_},v){let c=o,D=_;return c+=v.sec,D+=v.subsec,ef(i,n,c,h,p,D)}function Jx(i,n){const o=n.addToEpochNs(i);return Vu(o),o}function Wy(i,n,o,h,p="constrain"){if(Mv(h.date)===0)return Jx(i,h.time);const _=ql(n,i);return Jx(ms(n,li(nl(o,_.isoDate,h.date,p),_.time),"compatible"),h.time)}function Vw(i,n,o){let h=Zl(o);i==="subtract"&&(h=Co(h));const p=qh(Oh(n),Oh(h));if(Iu(p))throw new RangeError("For years, months, or weeks arithmetic, use date arithmetic relative to a starting point");const _=Lu(n),v=Lu(h);return Vl(Hh({years:0,months:0,weeks:0,days:0},_.time.add(v.time)),p)}function Gw(i,n,o){let h=Zl(o);i==="subtract"&&(h=Co(h));const p=Oh(h);if(jh(p)==="date")throw new RangeError(`Duration field ${p} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);const _=Lu(h);return Pu(Jx(te(n,_n),_.time))}function Zw(i,n,o,h){const p=te(n,kt);let _=Zl(o);i==="subtract"&&(_=Co(_));const v=FS(_),c=si(an(h));return Hs(nl(p,te(n,vn),v,c),p)}function $w(i,n,o,h){let p=Zl(o);i==="subtract"&&(p=Co(p));const _=si(an(h)),v=te(n,kt),c=Lu(p),D=te(n,hr),I=sg(D.time,c.time),P=ps(c.date,I.deltaDays);return Dv(P.years,P.months,P.weeks,P.days,0,0,0,0,0,0),Ul(li(nl(v,D.isoDate,P,_),I),v)}function Yw(i,n,o){let h=Zl(o);i==="subtract"&&(h=Co(h));const p=Lu(h),{hour:_,minute:v,second:c,millisecond:D,microsecond:I,nanosecond:P}=sg(te(n,Dr),p.time);return Uh(Ev(_,v,c,D,I,P,"reject"))}function qw(i,n,o,h){let p=Zl(o);i==="subtract"&&(p=Co(p));const _=si(an(h)),v=nv(p),c=te(n,kt),D=Ws(c,te(n,vn),"year-month");D.day=1;let I=uf(c,D,"constrain");if(v<0){const B=nl(c,I,{months:1},"constrain");I=Mo(B.year,B.month,B.day-1)}const P=FS(p);return Gp(I),Xm(m_(c,Ws(c,nl(c,I,P,_),"year-month"),_),c)}function Hw(i,n,o,h){let p=Zl(o);i==="subtract"&&(p=Co(p));const _=si(an(h)),v=te(n,wi),c=te(n,kt),D=Zm(p);return fs(Wy(te(n,_n),v,c,D,_),v,c)}function nf(i,n,o){const h=Math.trunc(i/n),p=i%n,_=i<0?"negative":"positive",v=Math.abs(h),c=v+1,D=To(Math.abs(2*p)-n),I=v%2==0,P=xv(o,_),B=p===0?v:bv(v,c,D,I,P);return n*(_==="positive"?B:-B)}function eb(i,n,o,h){const p=ag[o]*n;return function(_,v,c){const D=Ph(_),I=Ph(v),P=Q.divide(D,I),B=Q.remainder(D,I),U=xv(c,"positive");let Z,ne;Q.lessThan(D,el)?(Z=Q.subtract(P,d_),ne=P):(Z=P,ne=Q.add(P,d_));const ye=H0(bp(Q.multiply(B,Ib)),I)*(Q.lessThan(D,el)?-1:1)+0,me=Q.equal(B,el)?P:bv(Z,ne,ye,tS(Z),U);return Q.multiply(me,I)}(i,Q.BigInt(p),h)}function tb(i,n,o,h){Kx(i);const{year:p,month:_,day:v}=i.isoDate,c=nb(i.time,n,o,h);return li(Mo(p,_,v+c.deltaDays),c)}function nb({hour:i,minute:n,second:o,millisecond:h,microsecond:p,nanosecond:_},v,c,D){let I;switch(c){case"day":case"hour":I=1e3*(1e3*(1e3*(60*(60*i+n)+o)+h)+p)+_;break;case"minute":I=1e3*(1e3*(1e3*(60*n+o)+h)+p)+_;break;case"second":I=1e3*(1e3*(1e3*o+h)+p)+_;break;case"millisecond":I=1e3*(1e3*h+p)+_;break;case"microsecond":I=1e3*p+_;break;case"nanosecond":I=_}const P=ag[c],B=nf(I,P*v,D)/P;switch(c){case"day":return{deltaDays:B,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return ef(B,0,0,0,0,0);case"minute":return ef(i,B,0,0,0,0);case"second":return ef(i,n,B,0,0,0);case"millisecond":return ef(i,n,o,B,0,0);case"microsecond":return ef(i,n,o,h,B,0);case"nanosecond":return ef(i,n,o,h,p,B);default:throw new Error(`Invalid unit ${c}`)}}function iv(i,n,o,h){const p=ag[o];return i.round(Q.BigInt(p*n),h)}function s_(i,n){const o=ag[n];return i.fdiv(Q.BigInt(o))}function Gu(i,n){return i.year!==n.year?To(i.year-n.year):i.month!==n.month?To(i.month-n.month):i.day!==n.day?To(i.day-n.day):0}function ib(i,n){return i.hour!==n.hour?To(i.hour-n.hour):i.minute!==n.minute?To(i.minute-n.minute):i.second!==n.second?To(i.second-n.second):i.millisecond!==n.millisecond?To(i.millisecond-n.millisecond):i.microsecond!==n.microsecond?To(i.microsecond-n.microsecond):i.nanosecond!==n.nanosecond?To(i.nanosecond-n.nanosecond):0}function og(i,n){const o=Gu(i.isoDate,n.isoDate);return o!==0?o:ib(i.time,n.time)}function YS(i){const n=rv(i);return globalThis.BigInt!==void 0?globalThis.BigInt(n.toString(10)):n}function Hl(i,n){const o=Ph(i),{quotient:h,remainder:p}=Gy(o,I_);let _=Q.toNumber(h);return n==="floor"&&Q.toNumber(p)<0&&(_-=1),n==="ceil"&&Q.toNumber(p)>0&&(_+=1),_}function Ou(i){if(!Number.isInteger(i))throw new RangeError("epoch milliseconds must be an integer");return Q.multiply(Q.BigInt(i),I_)}function rv(i){let n=i;if(typeof i=="object"){const o=i[Symbol.toPrimitive];o&&typeof o=="function"&&(n=o.call(i,"number"))}if(typeof n=="number")throw new TypeError("cannot convert number to bigint");return typeof n=="bigint"?Q.BigInt(n.toString(10)):Q.BigInt(n)}const rb=(()=>{let i=Q.BigInt(Date.now()%1e6);return()=>{const n=Date.now(),o=Q.BigInt(n),h=Q.add(Ou(n),i);return i=Q.remainder(o,I_),Q.greaterThan(h,ig)?ig:Q.lessThan(h,f_)?f_:h}})();function Oy(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function To(i){return i<0?-1:i>0?1:i}function an(i){if(i===void 0)return Object.create(null);if(kr(i)&&i!==null)return i;throw new TypeError("Options parameter must be an object, not "+(i===null?"null":typeof i))}function Lp(i,n){const o=Object.create(null);return o[i]=n,o}function Xh(i,n,o,h){let p=i[n];if(p!==void 0){if(p=Tv(p),!o.includes(p))throw new RangeError(`${n} must be one of ${o.join(", ")}, not ${p}`);return p}if(h===ed)throw new RangeError(`${n} option is required`);return h}function Ks(i){const n=v_(i);if(!LR.includes(v_(n)))throw new RangeError(`invalid calendar identifier ${n}`);switch(n){case"ethiopic-amete-alem":return"ethioaa";case"islamicc":return"islamic-civil"}return n}function v_(i){let n="";for(let o=0;o<i.length;o++){const h=i.charCodeAt(o);n+=h>=65&&h<=90?String.fromCharCode(h+32):String.fromCharCode(h)}return n}function mf(i){throw new TypeError(`Do not use built-in arithmetic operators with Temporal objects. When comparing, use ${i==="PlainMonthDay"?"Temporal.PlainDate.compare(obj1.toPlainDate(year), obj2.toPlainDate(year))":`Temporal.${i}.compare(obj1, obj2)`}, not obj1 > obj2. When coercing to strings, use \`\${obj}\` or String(obj), not '' + obj. When coercing to numbers, use properties or methods of the object, not \`+obj\`. When concatenating with strings, use \`\${str}\${obj}\` or str.concat(obj), not str + obj. In React, coerce to a string before rendering a Temporal object.`)}const GR=new RegExp(`^${mS.source}$`),ZR=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/.source}$`);function qS(i,n,o,h=i(n),p=i(o)){let _=n,v=o,c=h,D=p;for(;v-_>1;){let I=Math.trunc((_+v)/2);const P=i(I);P===c?(_=I,c=P):P===D&&(v=I,D=P)}return v}function HS(i){return[...i]}function XS(i,n){if(i!=="gregory"&&i!=="iso8601")return;const o=G_[i];let h=n.year;const{dayOfWeek:p,dayOfYear:_,daysInYear:v}=o.isoToDate(n,{dayOfWeek:!0,dayOfYear:!0,daysInYear:!0}),c=o.getFirstDayOfWeek(),D=o.getMinimalDaysInFirstWeek();let I=(p+7-c)%7,P=(p-_+7001-c)%7,B=Math.floor((_-1+P)/7);if(7-P>=D&&++B,B==0)B=function(U,Z,ne,ye){let me=(ye-U-ne+1)%7;me<0&&(me+=7);let Pe=Math.floor((ne+me-1)/7);return 7-me>=Z&&++Pe,Pe}(c,D,_+o.isoToDate(o.dateAdd(n,{years:-1},"constrain"),{daysInYear:!0}).daysInYear,p),h--;else if(_>=v-5){let U=(I+v-_)%7;U<0&&(U+=7),6-U>=D&&_+7-I>v&&(B=1,h++)}return{week:B,year:h}}function Xw(i,n,o,h,p){if(n!==p.year){if(i*(n-p.year)>0)return!0}else if(o!==p.month){if(i*(o-p.month)>0)return!0}else if(h!==p.day&&i*(h-p.day)>0)return!0;return!1}const G_={};function Op(i){if(!i.startsWith("M"))throw new RangeError(`Invalid month code: ${i}.  Month codes must start with M.`);const n=+i.slice(1);if(Number.isNaN(n))throw new RangeError(`Invalid month code: ${i}`);return n}function Fu(i,n=!1){return`M${`${i}`.padStart(2,"0")}${n?"L":""}`}function Ub(i,n=void 0,o=12){let{month:h,monthCode:p}=i;if(p===void 0){if(h===void 0)throw new TypeError("Either month or monthCode are required");n==="reject"&&Ma(h,1,o),n==="constrain"&&(h=qs(h,1,o)),p=Fu(h)}else{const _=Op(p);if(p!==Fu(_))throw new RangeError(`Invalid month code: ${p}`);if(h!==void 0&&h!==_)throw new RangeError(`monthCode ${p} and month ${h} must match if both are present`);if(h=_,h<1||h>o)throw new RangeError(`Invalid monthCode: ${p}`)}return{...i,month:h,monthCode:p}}G_.iso8601={resolveFields(i,n){if((n==="date"||n==="year-month")&&i.year===void 0)throw new TypeError("year is required");if((n==="date"||n==="month-day")&&i.day===void 0)throw new TypeError("day is required");Object.assign(i,Ub(i))},dateToISO:(i,n)=>r_(i.year,i.month,i.day,n),monthDayToISOReferenceDate(i,n){const{month:o,day:h}=r_(i.year??1972,i.month,i.day,n);return{month:o,day:h,year:1972}},extraFields:()=>[],fieldKeysToIgnore(i){const n=new Set;for(let o=0;o<i.length;o++){const h=i[o];n.add(h),h==="month"?n.add("monthCode"):h==="monthCode"&&n.add("month")}return HS(n)},dateAdd(i,{years:n=0,months:o=0,weeks:h=0,days:p=0},_){let{year:v,month:c,day:D}=i;return v+=n,c+=o,{year:v,month:c}=Sp(v,c),{year:v,month:c,day:D}=r_(v,c,D,_),D+=p+7*h,Mo(v,c,D)},dateUntil(i,n,o){const h=-Gu(i,n);if(h===0)return{years:0,months:0,weeks:0,days:0};let p,_=0,v=0;if(o==="year"||o==="month"){let P=n.year-i.year;for(P!==0&&(P-=h);!Xw(h,i.year+P,i.month,i.day,n);)_=P,P+=h;let B=h;for(p=Sp(i.year+_,i.month+B);!Xw(h,p.year,p.month,i.day,n);)v=B,B+=h,p=Sp(p.year,p.month+h);o==="month"&&(v+=12*_,_=0)}p=Sp(i.year+_,i.month+v);const c=BS(p.year,p.month,i.day);let D=0,I=Pp(n.year,n.month-1,n.day)-Pp(c.year,c.month-1,c.day);return o==="week"&&(D=Math.trunc(I/7),I%=7),{years:_,months:v,weeks:D,days:I}},isoToDate({year:i,month:n,day:o},h){const p={era:void 0,eraYear:void 0,year:i,month:n,day:o,daysInWeek:7,monthsInYear:12};if(h.monthCode&&(p.monthCode=Fu(n)),h.dayOfWeek){const _=n+(n<3?10:-2),v=i-(n<3?1:0),c=Math.floor(v/100),D=v-100*c,I=(o+Math.floor(2.6*_-.2)+(D+Math.floor(D/4))+(Math.floor(c/4)-2*c))%7;p.dayOfWeek=I+(I<=0?7:0)}if(h.dayOfYear){let _=o;for(let v=n-1;v>0;v--)_+=Mp(i,v);p.dayOfYear=_}return h.weekOfYear&&(p.weekOfYear=XS("iso8601",{year:i,month:n,day:o})),h.daysInMonth&&(p.daysInMonth=Mp(i,n)),(h.daysInYear||h.inLeapYear)&&(p.inLeapYear=tv(i),p.daysInYear=p.inLeapYear?366:365),p},getFirstDayOfWeek:()=>1,getMinimalDaysInFirstWeek:()=>4};class Ea{constructor(n){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,n!==void 0){let o=0;for(const h of n.map.entries()){if(++o>Ea.MAX_CACHE_ENTRIES)break;this.map.set(...h)}}}get(n){const o=this.map.get(n);return o&&(this.hits++,this.report()),this.calls++,o}set(n,o){this.map.set(n,o),this.misses++,this.report()}report(){}setObject(n){if(Ea.objectMap.get(n))throw new RangeError("object already cached");Ea.objectMap.set(n,this),this.report()}static getCacheForObject(n){let o=Ea.objectMap.get(n);return o||(o=new Ea,Ea.objectMap.set(n,o)),o}}function WS({isoYear:i,isoMonth:n,isoDay:o}){return`${V_(i)}-${il(n)}-${il(o)}T00:00Z`}function gx(i,n){return{years:i.year-n.year,months:i.month-n.month,days:i.day-n.day}}Ea.objectMap=new WeakMap,Ea.MAX_CACHE_ENTRIES=1e3;class Zp{constructor(){this.eras=[],this.hasEra=!1,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new Intl.DateTimeFormat(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:"short",timeZone:"UTC"})),this.formatter}getCalendarParts(n){let o=this.getFormatter(),h=new Date(n);if(n==="-271821-04-19T00:00Z"){const p=o.resolvedOptions();o=new Intl.DateTimeFormat(p.locale,{...p,timeZone:"Etc/GMT+1"}),h=new Date("-271821-04-20T00:00Z")}try{return o.formatToParts(h)}catch{throw new RangeError(`Invalid ISO date: ${n}`)}}isoToCalendarDate(n,o){const{year:h,month:p,day:_}=n,v=JSON.stringify({func:"isoToCalendarDate",isoYear:h,isoMonth:p,isoDay:_,id:this.id}),c=o.get(v);if(c)return c;const D=WS({isoYear:h,isoMonth:p,isoDay:_}),I=this.getCalendarParts(D),P={};for(let U=0;U<I.length;U++){const{type:Z,value:ne}=I[U];if(Z!=="year"&&Z!=="relatedYear"||(this.hasEra?P.eraYear=+ne:P.year=+ne),Z==="month"){const ye=/^([0-9]*)(.*?)$/.exec(ne);if(!ye||ye.length!=3||!ye[1]&&!ye[2])throw new RangeError(`Unexpected month: ${ne}`);if(P.month=ye[1]?+ye[1]:1,P.month<1)throw new RangeError(`Invalid month ${ne} from ${D}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(P.month>13)throw new RangeError(`Invalid month ${ne} from ${D}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);ye[2]&&(P.monthExtra=ye[2])}Z==="day"&&(P.day=+ne),this.hasEra&&Z==="era"&&ne!=null&&ne!==""&&(P.era=ne.split(" (")[0].normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(/ /g,"-").toLowerCase())}if(this.hasEra&&P.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.hasEra){const U=this.eras.find(Z=>P.era===Z.genericName);U&&(P.era=U.code)}if(this.reviseIntlEra){const{era:U,eraYear:Z}=this.reviseIntlEra(P,n);P.era=U,P.eraYear=Z}this.checkIcuBugs&&this.checkIcuBugs(n);const B=this.adjustCalendarDate(P,o,"constrain",!0);if(B.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(n)}`);if(B.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(n)}`);if(B.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(n)}`);return o.set(v,B),["constrain","reject"].forEach(U=>{const Z=JSON.stringify({func:"calendarToIsoDate",year:B.year,month:B.month,day:B.day,overflow:U,id:this.id});o.set(Z,n)}),B}validateCalendarDate(n){const{month:o,year:h,day:p,eraYear:_,monthCode:v,monthExtra:c}=n;if(c!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(h===void 0&&_===void 0)throw new TypeError("year or eraYear is required");if(o===void 0&&v===void 0)throw new TypeError("month or monthCode is required");if(p===void 0)throw new RangeError("Missing day");if(v!==void 0){if(typeof v!="string")throw new RangeError("monthCode must be a string, not "+typeof v);if(!/^M([01]?\d)(L?)$/.test(v))throw new RangeError(`Invalid monthCode: ${v}`)}if(this.hasEra&&n.era===void 0!=(n.eraYear===void 0))throw new TypeError("properties era and eraYear must be provided together")}adjustCalendarDate(n,o=void 0,h="constrain",p=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let _=n;this.validateCalendarDate(_);const v=this.monthsInYear(_,o);let{month:c,monthCode:D}=_;return{month:c,monthCode:D}=Ub(_,h,v),{..._,month:c,monthCode:D}}regulateMonthDayNaive(n,o,h){const p=this.monthsInYear(n,h);let{month:_,day:v}=n;return o==="reject"?(Ma(_,1,p),Ma(v,1,this.maximumMonthLength(n))):(_=qs(_,1,p),v=qs(v,1,this.maximumMonthLength({...n,month:_}))),{...n,month:_,day:v}}calendarToIsoDate(n,o="constrain",h){const p=n;let _=this.adjustCalendarDate(n,h,o,!1);_=this.regulateMonthDayNaive(_,o,h);const{year:v,month:c,day:D}=_,I=JSON.stringify({func:"calendarToIsoDate",year:v,month:c,day:D,overflow:o,id:this.id});let P,B=h.get(I);if(B||p.year!==void 0&&p.month!==void 0&&p.day!==void 0&&(p.year!==_.year||p.month!==_.month||p.day!==_.day)&&(P=JSON.stringify({func:"calendarToIsoDate",year:p.year,month:p.month,day:p.day,overflow:o,id:this.id}),B=h.get(P),B))return B;let U=this.estimateIsoDate({year:v,month:c,day:D});const Z=tt=>{let Je=this.addDaysIso(U,tt);if(_.day>this.minimumMonthLength(_)){let $e=this.isoToCalendarDate(Je,h);for(;$e.month!==c||$e.year!==v;){if(o==="reject")throw new RangeError(`day ${D} does not exist in month ${c} of year ${v}`);Je=this.addDaysIso(Je,-1),$e=this.isoToCalendarDate(Je,h)}}return Je};let ne=0,ye=this.isoToCalendarDate(U,h),me=gx(_,ye);if(me.years!==0||me.months!==0||me.days!==0){const tt=365*me.years+30*me.months+me.days;U=this.addDaysIso(U,tt),ye=this.isoToCalendarDate(U,h),me=gx(_,ye),me.years===0&&me.months===0?U=Z(me.days):ne=this.compareCalendarDates(_,ye)}let Pe=8;for(;ne;){U=this.addDaysIso(U,ne*Pe);const tt=ye;ye=this.isoToCalendarDate(U,h);const Je=ne;if(ne=this.compareCalendarDates(_,ye),ne){if(me=gx(_,ye),me.years===0&&me.months===0)U=Z(me.days),ne=0;else if(Je&&ne!==Je)if(Pe>1)Pe/=2;else{if(o==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...p})}`);this.compareCalendarDates(ye,tt)>0&&(U=this.addDaysIso(U,-1)),ne=0}}}if(h.set(I,U),P&&h.set(P,U),_.year===void 0||_.month===void 0||_.day===void 0||_.monthCode===void 0||this.hasEra&&(_.era===void 0||_.eraYear===void 0))throw new RangeError("Unexpected missing property");return U}compareCalendarDates(n,o){return n.year!==o.year?To(n.year-o.year):n.month!==o.month?To(n.month-o.month):n.day!==o.day?To(n.day-o.day):0}regulateDate(n,o="constrain",h){const p=this.calendarToIsoDate(n,o,h);return this.isoToCalendarDate(p,h)}addDaysIso(n,o){return Mo(n.year,n.month,n.day+o)}addDaysCalendar(n,o,h){const p=this.calendarToIsoDate(n,"constrain",h),_=this.addDaysIso(p,o);return this.isoToCalendarDate(_,h)}addMonthsCalendar(n,o,h,p){let _=n;const{day:v}=_;for(let c=0,D=Math.abs(o);c<D;c++){const{month:I}=_,P=_,B=o<0?-Math.max(v,this.daysInPreviousMonth(_,p)):this.daysInMonth(_,p),U=this.calendarToIsoDate(_,"constrain",p);let Z=this.addDaysIso(U,B);if(_=this.isoToCalendarDate(Z,p),o>0){const ne=this.monthsInYear(P,p);for(;_.month-1!=I%ne;)Z=this.addDaysIso(Z,-1),_=this.isoToCalendarDate(Z,p)}_.day!==v&&(_=this.regulateDate({..._,day:v},"constrain",p))}if(h==="reject"&&_.day!==v)throw new RangeError(`Day ${v} does not exist in resulting calendar month`);return _}addCalendar(n,{years:o=0,months:h=0,weeks:p=0,days:_=0},v,c){const{year:D,day:I,monthCode:P}=n,B=this.adjustCalendarDate({year:D+o,monthCode:P,day:I},c),U=this.addMonthsCalendar(B,h,v,c),Z=_+7*p;return this.addDaysCalendar(U,Z,c)}untilCalendar(n,o,h,p){let _=0,v=0,c=0,D=0;switch(h){case"day":_=this.calendarDaysUntil(n,o,p);break;case"week":{const I=this.calendarDaysUntil(n,o,p);_=I%7,v=(I-_)/7;break}case"month":case"year":{const I=this.compareCalendarDates(o,n);if(!I)return{years:0,months:0,weeks:0,days:0};const P=o.year-n.year,B=o.day-n.day;if(h==="year"&&P){let ne=0;o.monthCode>n.monthCode&&(ne=1),o.monthCode<n.monthCode&&(ne=-1),ne||(ne=Math.sign(B)),D=ne*I<0?P-I:P}let U,Z=D?this.addCalendar(n,{years:D},"constrain",p):n;do c+=I,U=Z,Z=this.addMonthsCalendar(U,I,"constrain",p),Z.day!==n.day&&(Z=this.regulateDate({...Z,day:n.day},"constrain",p));while(this.compareCalendarDates(o,Z)*I>=0);c-=I,_=this.calendarDaysUntil(U,o,p);break}}return{years:D,months:c,weeks:v,days:_}}daysInMonth(n,o){const{day:h}=n,p=this.maximumMonthLength(n),_=this.minimumMonthLength(n);if(_===p)return _;const v=h<=p-_?p:_,c=this.calendarToIsoDate(n,"constrain",o),D=this.addDaysIso(c,v),I=this.isoToCalendarDate(D,o),P=this.addDaysIso(D,-I.day);return this.isoToCalendarDate(P,o).day}daysInPreviousMonth(n,o){const{day:h,month:p,year:_}=n;let v={year:p>1?_:_-1,month:p,day:1};const c=p>1?p-1:this.monthsInYear(v,o);v={...v,month:c};const D=this.minimumMonthLength(v),I=this.maximumMonthLength(v);if(D===I)return I;const P=this.calendarToIsoDate(n,"constrain",o),B=this.addDaysIso(P,-h);return this.isoToCalendarDate(B,o).day}startOfCalendarYear(n){return{year:n.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(n){return{year:n.year,month:n.month,day:1}}calendarDaysUntil(n,o,h){const p=this.calendarToIsoDate(n,"constrain",h),_=this.calendarToIsoDate(o,"constrain",h);return Pp(_.year,_.month-1,_.day)-Pp(p.year,p.month-1,p.day)}monthDaySearchStartYear(n,o){return 1972}monthDayFromFields(n,o,h){let p,_,v,c,D,{era:I,eraYear:P,year:B,month:U,monthCode:Z,day:ne}=n;if(U!==void 0&&B===void 0&&(!this.hasEra||I===void 0||P===void 0))throw new TypeError("when month is present, year (or era and eraYear) are required");(Z===void 0||B!==void 0||this.hasEra&&P!==void 0)&&({monthCode:Z,day:ne}=this.isoToCalendarDate(this.calendarToIsoDate(n,o,h),h));const ye={year:this.monthDaySearchStartYear(Z,ne),month:12,day:31},me=this.isoToCalendarDate(ye,h),Pe=me.monthCode>Z||me.monthCode===Z&&me.day>=ne?me.year:me.year-1;for(let tt=0;tt<20;tt++){const Je=this.adjustCalendarDate({day:ne,monthCode:Z,year:Pe-tt},h),$e=this.calendarToIsoDate(Je,"constrain",h),Me=this.isoToCalendarDate($e,h);if({year:p,month:_,day:v}=$e,Me.monthCode===Z&&Me.day===ne)return{month:_,day:v,year:p};if(o==="constrain"){const Ve=this.maxLengthOfMonthCodeInAnyYear(Me.monthCode);if(Me.monthCode===Z&&Me.day===Ve&&ne>Ve)return{month:_,day:v,year:p};(c===void 0||Me.monthCode===c.monthCode&&Me.day>c.day)&&(c=Me,D=$e)}}if(o==="constrain"&&D!==void 0)return D;throw new RangeError(`No recent ${this.id} year with monthCode ${Z} and day ${ne}`)}getFirstDayOfWeek(){}getMinimalDaysInFirstWeek(){}}class $R extends Zp{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}}}inLeapYear(n){const{year:o}=n;return(7*o+1)%19<7}monthsInYear(n){return this.inLeapYear(n)?13:12}minimumMonthLength(n){return this.minMaxMonthLength(n,"min")}maximumMonthLength(n){return this.minMaxMonthLength(n,"max")}minMaxMonthLength(n,o){const{month:h,year:p}=n,_=this.getMonthCode(p,h),v=Object.entries(this.months).find(D=>D[1].monthCode===_);if(v===void 0)throw new RangeError(`unmatched Hebrew month: ${h}`);const c=v[1].days;return typeof c=="number"?c:c[o]}maxLengthOfMonthCodeInAnyYear(n){return["M04","M06","M08","M10","M12"].includes(n)?29:30}estimateIsoDate(n){const{year:o}=n;return{year:o-3760,month:1,day:1}}getMonthCode(n,o){return this.inLeapYear({year:n})?o===6?Fu(5,!0):Fu(o<6?o:o-1):Fu(o)}adjustCalendarDate(n,o,h="constrain",p=!1){let{year:_,month:v,monthCode:c,day:D,monthExtra:I}=n;if(_===void 0)throw new TypeError("Missing property: year");if(p){if(I){const P=this.months[I];if(!P)throw new RangeError(`Unrecognized month from formatToParts: ${I}`);v=this.inLeapYear({year:_})?P.leap:P.regular}return c=this.getMonthCode(_,v),{year:_,month:v,day:D,monthCode:c}}if(this.validateCalendarDate(n),v===void 0)if(c.endsWith("L")){if(c!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${c}`);if(v=6,!this.inLeapYear({year:_})){if(h==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${_} which is not a leap year`);v=6,c="M06"}}else{v=Op(c),this.inLeapYear({year:_})&&v>=6&&v++;const P=this.monthsInYear({year:_});if(v<1||v>P)throw new RangeError(`Invalid monthCode: ${c}`)}else if(h==="reject"?(Ma(v,1,this.monthsInYear({year:_})),Ma(D,1,this.maximumMonthLength({year:_,month:v}))):(v=qs(v,1,this.monthsInYear({year:_})),D=qs(D,1,this.maximumMonthLength({year:_,month:v}))),c===void 0)c=this.getMonthCode(_,v);else if(this.getMonthCode(_,v)!==c)throw new RangeError(`monthCode ${c} doesn't correspond to month ${v} in Hebrew year ${_}`);return{...n,day:D,month:v,monthCode:c,year:_}}}class xg extends Zp{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425}inLeapYear(n,o){const h={year:n.year,month:1,monthCode:"M01",day:1},p={year:n.year+1,month:1,monthCode:"M01",day:1};return this.calendarDaysUntil(h,p,o)===355}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(){return 30}estimateIsoDate(n){const{year:o}=this.adjustCalendarDate(n);return{year:Math.floor(o*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class YR extends xg{constructor(){super(...arguments),this.id="islamic"}}class qR extends xg{constructor(){super(...arguments),this.id="islamic-umalqura"}}class HR extends xg{constructor(){super(...arguments),this.id="islamic-tbla"}}class XR extends xg{constructor(){super(...arguments),this.id="islamic-civil"}}class WR extends xg{constructor(){super(...arguments),this.id="islamic-rgsa"}}class QR extends xg{constructor(){super(...arguments),this.id="islamicc"}}class KR extends Zp{constructor(){super(...arguments),this.id="persian",this.calendarType="solar"}inLeapYear(n,o){return this.daysInMonth({year:n.year,month:12,day:1},o)===30}monthsInYear(){return 12}minimumMonthLength(n){const{month:o}=n;return o===12?29:o<=6?31:30}maximumMonthLength(n){const{month:o}=n;return o===12?30:o<=6?31:30}maxLengthOfMonthCodeInAnyYear(n){return Op(n)<=6?31:30}estimateIsoDate(n){const{year:o}=this.adjustCalendarDate(n);return{year:o+621,month:1,day:1}}}class JR extends Zp{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(n){return Vb(n.year+78)}monthsInYear(){return 12}minimumMonthLength(n){return this.getMonthInfo(n).length}maximumMonthLength(n){return this.getMonthInfo(n).length}maxLengthOfMonthCodeInAnyYear(n){const o=Op(n);let h=this.months[o];return h=h.leap??h,h.length}getMonthInfo(n){const{month:o}=n;let h=this.months[o];if(h===void 0)throw new RangeError(`Invalid month: ${o}`);return this.inLeapYear(n)&&h.leap&&(h=h.leap),h}estimateIsoDate(n){const o=this.adjustCalendarDate(n),h=this.getMonthInfo(o);return Mo(o.year+78+(h.nextYear?1:0),h.month,h.day+o.day-1)}checkIcuBugs(n){if(this.vulnerableToBceBug&&n.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function Vb(i){return i%4==0&&(i%100!=0||i%400==0)}class QS extends Zp{constructor(n,o){super(),this.calendarType="solar",this.id=n,this.isoEpoch=o}inLeapYear(n){const{year:o}=this.estimateIsoDate({month:1,day:1,year:n.year});return Vb(o)}monthsInYear(){return 12}minimumMonthLength(n){const{month:o}=n;return o===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(o)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][Op(n)-1]}estimateIsoDate(n){const o=this.adjustCalendarDate(n);return r_(o.year+this.isoEpoch.year,o.month+this.isoEpoch.month,o.day+this.isoEpoch.day,"constrain")}}class KS extends Zp{constructor(n,o){super(),this.hasEra=!0,this.calendarType="solar",this.id=n;const{eras:h,anchorEra:p}=function(_){let v,c=_;if(c.length===0)throw new RangeError("Invalid era data: eras are required");if(c.length===1&&c[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(c.length===1&&!c[0].code)throw new RangeError("Invalid era data: at least one named era is required");if(c.filter(I=>I.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");c.forEach(I=>{if(I.isAnchor||!I.anchorEpoch&&!I.reverseOf){if(v)throw new RangeError("Invalid era data: cannot have multiple anchor eras");v=I,I.anchorEpoch={year:I.hasYearZero?0:1}}else if(!I.code)throw new RangeError("If era name is blank, it must be the anchor era")}),c=c.filter(I=>I.code),c.forEach(I=>{const{reverseOf:P}=I;if(P){const B=c.find(U=>U.code===P);if(B===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${P}`);I.reverseOf=B,I.anchorEpoch=B.anchorEpoch,I.isoEpoch=B.isoEpoch}I.anchorEpoch.month===void 0&&(I.anchorEpoch.month=1),I.anchorEpoch.day===void 0&&(I.anchorEpoch.day=1)}),c.sort((I,P)=>{if(I.reverseOf)return 1;if(P.reverseOf)return-1;if(!I.isoEpoch||!P.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return P.isoEpoch.year-I.isoEpoch.year});const D=c[c.length-1].reverseOf;if(D&&D!==c[c.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return c.forEach((I,P)=>{I.genericName="era"+(c.length-1-P)}),{eras:c,anchorEra:v||c[0]}}(o);this.anchorEra=p,this.eras=h}inLeapYear(n){const{year:o}=this.estimateIsoDate({month:1,day:1,year:n.year});return Vb(o)}monthsInYear(){return 12}minimumMonthLength(n){const{month:o}=n;return o===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(o)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][Op(n)-1]}completeEraYear(n){const o=(c,D,I)=>{const P=n[c];if(P!=null&&P!=D&&!(I||[]).includes(P)){const B=I==null?void 0:I[0];throw new RangeError(`Input ${c} ${P} doesn't match calculated value ${B?`${D} (also called ${B})`:D}`)}},h=c=>{let D;const I={...n,year:c},P=this.eras.find((B,U)=>{if(U===this.eras.length-1){if(B.reverseOf){if(c>0)throw new RangeError(`Signed year ${c} is invalid for era ${B.code}`);return D=B.anchorEpoch.year-c,!0}return D=c-B.anchorEpoch.year+(B.hasYearZero?0:1),!0}return this.compareCalendarDates(I,B.anchorEpoch)>=0&&(D=c-B.anchorEpoch.year+(B.hasYearZero?0:1),!0)});if(!P)throw new RangeError(`Year ${c} was not matched by any era`);return{eraYear:D,era:P.code,eraNames:P.names}};let{year:p,eraYear:_,era:v}=n;if(p!=null){const c=h(p);({eraYear:_,era:v}=c),o("era",v,c==null?void 0:c.eraNames),o("eraYear",_)}else{if(_==null)throw new RangeError("Either year or eraYear and era are required");{if(v===void 0)throw new RangeError("era and eraYear must be provided together");const c=this.eras.find(({code:D,names:I=[]})=>D===v||I.includes(v));if(!c)throw new RangeError(`Era ${v} (ISO year ${_}) was not matched by any era`);p=c.reverseOf?c.anchorEpoch.year-_:_+c.anchorEpoch.year-(c.hasYearZero?0:1),o("year",p),{eraYear:_,era:v}=h(p)}}return{...n,year:p,eraYear:_,era:v}}adjustCalendarDate(n,o,h="constrain"){let p=n;const{month:_,monthCode:v}=p;return _===void 0&&(p={...p,month:Op(v)}),this.validateCalendarDate(p),p=this.completeEraYear(p),super.adjustCalendarDate(p,o,h)}estimateIsoDate(n){const o=this.adjustCalendarDate(n),{year:h,month:p,day:_}=o,{anchorEra:v}=this;return r_(h+v.isoEpoch.year-(v.hasYearZero?0:1),p,_,"constrain")}}class Gb extends KS{constructor(n,o){super(n,o)}isoToCalendarDate(n){const{year:o,month:h,day:p}=n,_=Fu(h),v=o-this.anchorEra.isoEpoch.year+1;return this.completeEraYear({year:v,month:h,monthCode:_,day:p})}}const zu={inLeapYear(i){const{year:n}=i;return(n+1)%4==0},monthsInYear:()=>13,minimumMonthLength(i){const{month:n}=i;return n===13?this.inLeapYear(i)?6:5:30},maximumMonthLength(i){return this.minimumMonthLength(i)},maxLengthOfMonthCodeInAnyYear:i=>i==="M13"?6:30};class e3 extends QS{constructor(n,o){super(n,o),this.inLeapYear=zu.inLeapYear,this.monthsInYear=zu.monthsInYear,this.minimumMonthLength=zu.minimumMonthLength,this.maximumMonthLength=zu.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=zu.maxLengthOfMonthCodeInAnyYear}}class JS extends KS{constructor(n,o){super(n,o),this.inLeapYear=zu.inLeapYear,this.monthsInYear=zu.monthsInYear,this.minimumMonthLength=zu.minimumMonthLength,this.maximumMonthLength=zu.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=zu.maxLengthOfMonthCodeInAnyYear}}class t3 extends e3{constructor(){super("ethioaa",{year:-5492,month:7,day:17})}}class n3 extends JS{constructor(){super("coptic",[{code:"coptic",isoEpoch:{year:284,month:8,day:29}},{code:"coptic-inverse",reverseOf:"coptic"}])}}class i3 extends JS{constructor(){super("ethiopic",[{code:"ethioaa",names:["ethiopic-amete-alem","mundi"],isoEpoch:{year:-5492,month:7,day:17}},{code:"ethiopic",names:["incar"],isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class r3 extends Gb{constructor(){super("roc",[{code:"roc",names:["minguo"],isoEpoch:{year:1912,month:1,day:1}},{code:"roc-inverse",names:["before-roc"],reverseOf:"roc"}])}}class a3 extends QS{constructor(){super("buddhist",{year:-543,month:1,day:1})}}class s3 extends Gb{constructor(){super("gregory",[{code:"gregory",names:["ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"gregory-inverse",names:["be","bce"],reverseOf:"gregory"}])}reviseIntlEra(n){let{era:o,eraYear:h}=n;return o==="b"&&(o="gregory-inverse"),o==="a"&&(o="gregory"),{era:o,eraYear:h}}getFirstDayOfWeek(){return 1}getMinimalDaysInFirstWeek(){return 1}}class o3 extends Gb{constructor(){super("japanese",[{code:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{code:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{code:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{code:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{code:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{code:"japanese",names:["japanese","gregory","ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"japanese-inverse",names:["japanese-inverse","gregory-inverse","bc","bce"],reverseOf:"japanese"}]),this.erasBeginMidYear=!0}reviseIntlEra(n,o){const{era:h,eraYear:p}=n,{year:_}=o;return this.eras.find(v=>v.code===h)?{era:h,eraYear:p}:_<1?{era:"japanese-inverse",eraYear:1-_}:{era:"japanese",eraYear:_}}}class eE extends Zp{constructor(){super(...arguments),this.calendarType="lunisolar"}inLeapYear(n,o){const h=this.getMonthList(n.year,o);return Object.entries(h).length===13}monthsInYear(n,o){return this.inLeapYear(n,o)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(n){return["M01L","M09L","M10L","M11L","M12L"].includes(n)?29:30}monthDaySearchStartYear(n,o){const h={M01L:[1651,1651],M02L:[1947,1765],M03L:[1966,1955],M04L:[1963,1944],M05L:[1971,1952],M06L:[1960,1941],M07L:[1968,1938],M08L:[1957,1718],M09L:[1832,1832],M10L:[1870,1870],M11L:[1814,1814],M12L:[1890,1890]}[n]??[1972,1972];return o<30?h[0]:h[1]}getMonthList(n,o){if(n===void 0)throw new TypeError("Missing year");const h=JSON.stringify({func:"getMonthList",calendarYear:n,id:this.id}),p=o.get(h);if(p)return p;const _=this.getFormatter(),v=(me,Pe)=>{const tt=WS({isoYear:me,isoMonth:2,isoDay:1}),Je=new Date(tt);Je.setUTCDate(Pe+1);const $e=_.formatToParts(Je),Me=$e.find(Re=>Re.type==="month").value,Ve=+$e.find(Re=>Re.type==="day").value,ct=$e.find(Re=>Re.type==="relatedYear");let ot;if(ct===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return ot=+ct.value,{calendarMonthString:Me,calendarDay:Ve,calendarYearToVerify:ot}};let c=17,{calendarMonthString:D,calendarDay:I,calendarYearToVerify:P}=v(n,c);D!=="1"&&(c+=29,{calendarMonthString:D,calendarDay:I}=v(n,c)),c-=I-5;const B={};let U,Z,ne=1,ye=!1;do({calendarMonthString:D,calendarDay:I,calendarYearToVerify:P}=v(n,c)),U&&(B[Z].daysInMonth=U+30-I),P!==n?ye=!0:(B[D]={monthIndex:ne++},c+=30),U=I,Z=D;while(!ye);return B[Z].daysInMonth=U+30-I,o.set(h,B),B}estimateIsoDate(n){const{year:o,month:h}=n;return{year:o,month:h>=12?12:h+1,day:1}}adjustCalendarDate(n,o,h="constrain",p=!1){let{year:_,month:v,monthExtra:c,day:D,monthCode:I}=n;if(_===void 0)throw new TypeError("Missing property: year");if(p){if(c&&c!=="bis")throw new RangeError(`Unexpected leap month suffix: ${c}`);const P=Fu(v,c!==void 0),B=`${v}${c||""}`,U=this.getMonthList(_,o)[B];if(U===void 0)throw new RangeError(`Unmatched month ${B} in Chinese year ${_}`);return v=U.monthIndex,{year:_,month:v,day:D,monthCode:P}}if(this.validateCalendarDate(n),v===void 0){const P=this.getMonthList(_,o);let B=I.replace(/^M|L$/g,Z=>Z==="L"?"bis":"");B[0]==="0"&&(B=B.slice(1));let U=P[B];if(v=U&&U.monthIndex,v===void 0&&I.endsWith("L")&&I!="M13L"&&h==="constrain"){const Z=+I.replace(/^M0?|L$/g,"");U=P[Z],U&&(v=U.monthIndex,I=Fu(Z))}if(v===void 0)throw new RangeError(`Unmatched month ${I} in Chinese year ${_}`)}else if(I===void 0){const P=this.getMonthList(_,o),B=Object.entries(P),U=B.length;h==="reject"?(Ma(v,1,U),Ma(D,1,this.maximumMonthLength())):(v=qs(v,1,U),D=qs(D,1,this.maximumMonthLength()));const Z=B.find(ne=>ne[1].monthIndex===v);if(Z===void 0)throw new RangeError(`Invalid month ${v} in Chinese year ${_}`);I=Fu(+Z[0].replace("bis",""),Z[0].indexOf("bis")!==-1)}else{const P=this.getMonthList(_,o);let B=I.replace(/^M|L$/g,Z=>Z==="L"?"bis":"");B[0]==="0"&&(B=B.slice(1));const U=P[B];if(!U)throw new RangeError(`Unmatched monthCode ${I} in Chinese year ${_}`);if(v!==U.monthIndex)throw new RangeError(`monthCode ${I} doesn't correspond to month ${v} in Chinese year ${_}`)}return{...n,year:_,month:v,monthCode:I,day:D}}}class l3 extends eE{constructor(){super(...arguments),this.id="chinese"}}class c3 extends eE{constructor(){super(...arguments),this.id="dangi"}}class u3{constructor(n){this.helper=n}extraFields(n){return this.helper.hasEra&&n.includes("year")?["era","eraYear"]:[]}resolveFields(n){if(this.helper.calendarType!=="lunisolar"){const o=new Ea;Ub(n,void 0,this.helper.monthsInYear({year:n.year??1972},o))}}dateToISO(n,o){const h=new Ea,p=this.helper.calendarToIsoDate(n,o,h);return h.setObject(p),p}monthDayToISOReferenceDate(n,o){const h=new Ea,p=this.helper.monthDayFromFields(n,o,h);return h.setObject(p),p}fieldKeysToIgnore(n){const o=new Set;for(let h=0;h<n.length;h++){const p=n[h];switch(o.add(p),p){case"era":o.add("eraYear"),o.add("year");break;case"eraYear":o.add("era"),o.add("year");break;case"year":o.add("era"),o.add("eraYear");break;case"month":o.add("monthCode"),this.helper.erasBeginMidYear&&(o.add("era"),o.add("eraYear"));break;case"monthCode":o.add("month"),this.helper.erasBeginMidYear&&(o.add("era"),o.add("eraYear"));break;case"day":this.helper.erasBeginMidYear&&(o.add("era"),o.add("eraYear"))}}return HS(o)}dateAdd(n,{years:o,months:h,weeks:p,days:_},v){const c=Ea.getCacheForObject(n),D=this.helper.isoToCalendarDate(n,c),I=this.helper.addCalendar(D,{years:o,months:h,weeks:p,days:_},v,c),P=this.helper.calendarToIsoDate(I,"constrain",c);return Ea.getCacheForObject(P)||new Ea(c).setObject(P),P}dateUntil(n,o,h){const p=Ea.getCacheForObject(n),_=Ea.getCacheForObject(o),v=this.helper.isoToCalendarDate(n,p),c=this.helper.isoToCalendarDate(o,_);return this.helper.untilCalendar(v,c,h,p)}isoToDate(n,o){const h=Ea.getCacheForObject(n),p=this.helper.isoToCalendarDate(n,h);if(o.dayOfWeek&&(p.dayOfWeek=G_.iso8601.isoToDate(n,{dayOfWeek:!0}).dayOfWeek),o.dayOfYear){const _=this.helper.startOfCalendarYear(p),v=this.helper.calendarDaysUntil(_,p,h);p.dayOfYear=v+1}if(o.weekOfYear&&(p.weekOfYear=XS(this.helper.id,n)),p.daysInWeek=7,o.daysInMonth&&(p.daysInMonth=this.helper.daysInMonth(p,h)),o.daysInYear){const _=this.helper.startOfCalendarYear(p),v=this.helper.addCalendar(_,{years:1},"constrain",h);p.daysInYear=this.helper.calendarDaysUntil(_,v,h)}return o.monthsInYear&&(p.monthsInYear=this.helper.monthsInYear(p,h)),o.inLeapYear&&(p.inLeapYear=this.helper.inLeapYear(p,h)),p}getFirstDayOfWeek(){return this.helper.getFirstDayOfWeek()}getMinimalDaysInFirstWeek(){return this.helper.getMinimalDaysInFirstWeek()}}for(const i of[$R,KR,i3,t3,n3,l3,c3,r3,JR,a3,s3,o3,YR,qR,HR,XR,WR,QR]){const n=new i;G_[n.id]=new u3(n)}Zx("calendarImpl",function(i){return G_[i]});const x_=Intl.DateTimeFormat;function Fm(i,n){let o=te(i,n);return typeof o=="function"&&(o=new x_(te(i,hS),o(te(i,Fx))),function(h,p,_){const v=vv(h);if(v===void 0)throw new TypeError("Missing slots for the given container");if(v[p]===void 0)throw new TypeError(`tried to reset ${p} which was not set`);v[p]=_}(i,n,o)),o}function jy(i){return Qs(i,Vp)}class b_{constructor(n=void 0,o=void 0){(function(h,p,_){const v=_!==void 0;let c;if(v){const B=["localeMatcher","calendar","numberingSystem","hour12","hourCycle","timeZone","weekday","era","year","month","day","dayPeriod","hour","minute","second","fractionalSecondDigits","timeZoneName","formatMatcher","dateStyle","timeStyle"];c=function(Z){if(Z==null)throw new TypeError(`Expected object not ${Z}`);return Object(Z)}(_);const U=Object.create(null);for(let Z=0;Z<B.length;Z++){const ne=B[Z];Object.prototype.hasOwnProperty.call(c,ne)&&(U[ne]=c[ne])}c=U}else c=Object.create(null);const D=new x_(p,c),I=D.resolvedOptions();if(id(h),v){const B=Object.assign(Object.create(null),I);for(const U in B)Object.prototype.hasOwnProperty.call(c,U)||delete B[U];B.hour12=c.hour12,B.hourCycle=c.hourCycle,On(h,Fx,B)}else On(h,Fx,c);On(h,hS,I.locale),On(h,Vp,D),On(h,Gm,I.timeZone),On(h,Zy,I.calendar),On(h,aS,v3),On(h,sS,y3),On(h,oS,_3),On(h,lS,g3),On(h,cS,x3),On(h,uS,b3);const P=v?c.timeZone:void 0;if(P===void 0)On(h,Bx,I.timeZone);else{const B=Tv(P);if(B.startsWith("−"))throw new RangeError("Unicode minus (U+2212) is not supported in time zone offsets");On(h,Bx,Xs(B))}})(this,n,o)}get format(){st(this,jy);const n=d3.bind(this);return Object.defineProperties(n,{length:{value:1,enumerable:!1,writable:!1,configurable:!0},name:{value:"",enumerable:!1,writable:!1,configurable:!0}}),n}formatRange(n,o){return st(this,jy),p3.call(this,n,o)}formatToParts(n,...o){return st(this,jy),f3.call(this,n,...o)}formatRangeToParts(n,o){return st(this,jy),m3.call(this,n,o)}resolvedOptions(){return st(this,jy),h3.call(this)}}"formatToParts"in x_.prototype||delete b_.prototype.formatToParts,"formatRangeToParts"in x_.prototype||delete b_.prototype.formatRangeToParts;const Gl=function(i=void 0,n=void 0){return new b_(i,n)};function h3(){const i=te(this,Vp).resolvedOptions();return i.timeZone=te(this,Bx),i}function d3(i,...n){let o,h,p=lg(i,this);return p.formatter?(o=p.formatter,h=[Hl(p.epochNs,"floor")]):(o=te(this,Vp),h=[i,...n]),o.format(...h)}function f3(i,...n){let o,h,p=lg(i,this);return p.formatter?(o=p.formatter,h=[Hl(p.epochNs,"floor")]):(o=te(this,Vp),h=[i,...n]),o.formatToParts(...h)}function p3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const o=av(i),h=av(n);let p,_=[o,h];if(Wh(o)!==Wh(h))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");if(Wh(o)){if(!tE(o,h))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{epochNs:v,formatter:c}=lg(o,this),{epochNs:D,formatter:I}=lg(h,this);c&&(p=c,_=[Hl(v,"floor"),Hl(D,"floor")])}return p||(p=te(this,Vp)),p.formatRange(..._)}function m3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const o=av(i),h=av(n);let p,_=[o,h];if(Wh(o)!==Wh(h))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");if(Wh(o)){if(!tE(o,h))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{epochNs:v,formatter:c}=lg(o,this),{epochNs:D,formatter:I}=lg(h,this);c&&(p=c,_=[Hl(v,"floor"),Hl(D,"floor")])}return p||(p=te(this,Vp)),p.formatRangeToParts(..._)}function Z_(i={},n={}){const o=Object.assign({},i),h=["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"];for(let p=0;p<h.length;p++){const _=h[p];o[_]=_ in n?n[_]:o[_],o[_]!==!1&&o[_]!==void 0||delete o[_]}return o}function g3(i){const n=Z_(i,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});if(n.timeStyle!=="long"&&n.timeStyle!=="full"||(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"})),!Rv(n)){if($_(i))throw new TypeError(`cannot format Temporal.PlainTime with options [${Object.keys(i)}]`);Object.assign(n,{hour:"numeric",minute:"numeric",second:"numeric"})}return n}function y3(i){const n={short:{year:"2-digit",month:"numeric"},medium:{year:"numeric",month:"short"},long:{year:"numeric",month:"long"},full:{year:"numeric",month:"long"}},o=Z_(i,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in o&&o.dateStyle){const h=o.dateStyle;delete o.dateStyle,Object.assign(o,n[h])}if(!("year"in o||"month"in o||"era"in o)){if($_(i))throw new TypeError(`cannot format PlainYearMonth with options [${Object.keys(i)}]`);Object.assign(o,{year:"numeric",month:"numeric"})}return o}function _3(i){const n={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric"},long:{month:"long",day:"numeric"},full:{month:"long",day:"numeric"}},o=Z_(i,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in o&&o.dateStyle){const h=o.dateStyle;delete o.dateStyle,Object.assign(o,n[h])}if(!("month"in o)&&!("day"in o)){if($_(i))throw new TypeError(`cannot format PlainMonthDay with options [${Object.keys(i)}]`);Object.assign(o,{month:"numeric",day:"numeric"})}return o}function v3(i){const n=Z_(i,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if(!Iv(n)){if($_(i))throw new TypeError(`cannot format PlainDate with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric"})}return n}function x3(i){const n=Z_(i,{timeZoneName:!1});if((n.timeStyle==="long"||n.timeStyle==="full")&&(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"}),n.dateStyle)&&(Object.assign(n,{short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"long",day:"numeric"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long"}}[n.dateStyle]),delete n.dateStyle),!Rv(n)&&!Iv(n)){if($_(i))throw new TypeError(`cannot format PlainDateTime with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}return n}function b3(i){let n=i;return Rv(n)||Iv(n)||(n=Object.assign({},n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),n}function Iv(i){return"year"in i||"month"in i||"day"in i||"weekday"in i||"dateStyle"in i||"era"in i}function Rv(i){return"hour"in i||"minute"in i||"second"in i||"timeStyle"in i||"dayPeriod"in i||"fractionalSecondDigits"in i}function $_(i){return Iv(i)||Rv(i)||"dateStyle"in i||"timeStyle"in i||"timeZoneName"in i}function Wh(i){return Cr(i)||Lr(i)||Ki(i)||Un(i)||Ya(i)||Jo(i)||$a(i)}function av(i){return Wh(i)?i:wv(i)}function tE(i,n){return!(!Wh(i)||!Wh(n)||Lr(i)&&!Lr(n)||Cr(i)&&!Cr(n)||Ki(i)&&!Ki(n)||Un(i)&&!Un(n)||Ya(i)&&!Ya(n)||Jo(i)&&!Jo(n)||$a(i)&&!$a(n))}function lg(i,n){if(Lr(i)){const o={isoDate:{year:1970,month:1,day:1},time:te(i,Dr)};return{epochNs:ms(te(n,Gm),o,"compatible"),formatter:Fm(n,lS)}}if(Ya(i)){const o=te(i,kt),h=te(n,Zy);if(o!==h)throw new RangeError(`cannot format PlainYearMonth with calendar ${o} in locale with calendar ${h}`);const p=li(te(i,vn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:ms(te(n,Gm),p,"compatible"),formatter:Fm(n,sS)}}if(Jo(i)){const o=te(i,kt),h=te(n,Zy);if(o!==h)throw new RangeError(`cannot format PlainMonthDay with calendar ${o} in locale with calendar ${h}`);const p=li(te(i,vn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:ms(te(n,Gm),p,"compatible"),formatter:Fm(n,oS)}}if(Cr(i)){const o=te(i,kt),h=te(n,Zy);if(o!=="iso8601"&&o!==h)throw new RangeError(`cannot format PlainDate with calendar ${o} in locale with calendar ${h}`);const p=li(te(i,vn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:ms(te(n,Gm),p,"compatible"),formatter:Fm(n,aS)}}if(Ki(i)){const o=te(i,kt),h=te(n,Zy);if(o!=="iso8601"&&o!==h)throw new RangeError(`cannot format PlainDateTime with calendar ${o} in locale with calendar ${h}`);const p=te(i,hr);return{epochNs:ms(te(n,Gm),p,"compatible"),formatter:Fm(n,cS)}}if(Un(i))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return $a(i)?{epochNs:te(i,_n),formatter:Fm(n,uS)}:{}}function nE(i){const n=Object.create(null);return n.years=te(i,Bs),n.months=te(i,Fs),n.weeks=te(i,bo),n.days=te(i,Us),n.hours=te(i,Vs),n.minutes=te(i,Gs),n.seconds=te(i,Zs),n.milliseconds=te(i,$s),n.microseconds=te(i,Ys),n.nanoseconds=te(i,wo),n}b_.prototype.constructor=Gl,Object.defineProperty(Gl,"prototype",{value:b_.prototype,writable:!1,enumerable:!1,configurable:!1}),Gl.supportedLocalesOf=x_.supportedLocalesOf,rd(Gl,"Intl.DateTimeFormat");var Kw;const{format:w3,formatToParts:T3}=((Kw=Intl.DurationFormat)==null?void 0:Kw.prototype)??Object.create(null);function iE(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=nE(Zl(i));return w3.call(this,n)}var Jw;(Jw=Intl.DurationFormat)!=null&&Jw.prototype&&(Intl.DurationFormat.prototype.format=iE,Intl.DurationFormat.prototype.formatToParts=function(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=nE(Zl(i));return T3.call(this,n)});class Zb{constructor(n){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");kS(this,rv(n))}get epochMilliseconds(){return st(this,$a),Hl(te(this,_n),"floor")}get epochNanoseconds(){return st(this,$a),YS(Q.BigInt(te(this,_n)))}add(n){return st(this,$a),Gw("add",this,n)}subtract(n){return st(this,$a),Gw("subtract",this,n)}until(n,o=void 0){return st(this,$a),Lw("until",this,n,o)}since(n,o=void 0){return st(this,$a),Lw("since",this,n,o)}round(n){if(st(this,$a),n===void 0)throw new TypeError("options parameter is required");const o=typeof n=="string"?Lp("smallestUnit",n):an(n),h=gg(o),p=Gc(o,"halfExpand"),_=So(o,"smallestUnit","time",ed);return yg(h,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[_],!0),Pu(eb(te(this,_n),h,_,p))}equals(n){st(this,$a);const o=qy(n),h=te(this,_n),p=te(o,_n);return Q.equal(Q.BigInt(h),Q.BigInt(p))}toString(n=void 0){st(this,$a);const o=an(n),h=P_(o),p=Gc(o,"trunc"),_=So(o,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let v=o.timeZone;v!==void 0&&(v=Xs(v));const{precision:c,unit:D,increment:I}=L_(_,h);return Mw(Pu(eb(te(this,_n),I,D,p)),v,c)}toJSON(){return st(this,$a),Mw(this,void 0,"auto")}toLocaleString(n=void 0,o=void 0){return st(this,$a),new Gl(n,o).format(this)}valueOf(){mf("Instant")}toZonedDateTimeISO(n){st(this,$a);const o=Xs(n);return fs(te(this,_n),o,"iso8601")}static fromEpochMilliseconds(n){return Pu(Ou(wv(n)))}static fromEpochNanoseconds(n){return Pu(rv(n))}static from(n){return qy(n)}static compare(n,o){const h=qy(n),p=qy(o),_=te(h,_n),v=te(p,_n);return Q.lessThan(_,v)?-1:Q.greaterThan(_,v)?1:0}}rd(Zb,"Temporal.Instant");class $b{constructor(n,o,h,p="iso8601"){const _=Mn(n),v=Mn(o),c=Mn(h),D=Ks(p===void 0?"iso8601":pa(p));zp(_,v,c),ES(this,{year:_,month:v,day:c},D)}get calendarId(){return st(this,Cr),te(this,kt)}get era(){return Ps(this,"era")}get eraYear(){return Ps(this,"eraYear")}get year(){return Ps(this,"year")}get month(){return Ps(this,"month")}get monthCode(){return Ps(this,"monthCode")}get day(){return Ps(this,"day")}get dayOfWeek(){return Ps(this,"dayOfWeek")}get dayOfYear(){return Ps(this,"dayOfYear")}get weekOfYear(){var n;return(n=Ps(this,"weekOfYear"))==null?void 0:n.week}get yearOfWeek(){var n;return(n=Ps(this,"weekOfYear"))==null?void 0:n.year}get daysInWeek(){return Ps(this,"daysInWeek")}get daysInMonth(){return Ps(this,"daysInMonth")}get daysInYear(){return Ps(this,"daysInYear")}get monthsInYear(){return Ps(this,"monthsInYear")}get inLeapYear(){return Ps(this,"inLeapYear")}with(n,o=void 0){if(st(this,Cr),!kr(n))throw new TypeError("invalid argument");mg(n);const h=te(this,kt);let p=Ws(h,te(this,vn));return p=Rp(h,p,sl(h,n,["year","month","monthCode","day"],[],"partial")),Hs(uf(h,p,si(an(o))),h)}withCalendar(n){st(this,Cr);const o=F_(n);return Hs(te(this,vn),o)}add(n,o=void 0){return st(this,Cr),Zw("add",this,n,o)}subtract(n,o=void 0){return st(this,Cr),Zw("subtract",this,n,o)}until(n,o=void 0){return st(this,Cr),Ow("until",this,n,o)}since(n,o=void 0){return st(this,Cr),Ow("since",this,n,o)}equals(n){st(this,Cr);const o=$y(n);return Gu(te(this,vn),te(o,vn))===0&&Uu(te(this,kt),te(o,kt))}toString(n=void 0){return st(this,Cr),Cw(this,N_(an(n)))}toJSON(){return st(this,Cr),Cw(this)}toLocaleString(n=void 0,o=void 0){return st(this,Cr),new Gl(n,o).format(this)}valueOf(){mf("PlainDate")}toPlainDateTime(n=void 0){st(this,Cr);const o=SS(n);return Ul(li(te(this,vn),o),te(this,kt))}toZonedDateTime(n){let o,h;if(st(this,Cr),kr(n)){const v=n.timeZone;v===void 0?o=Xs(n):(o=Xs(v),h=n.plainTime)}else o=Xs(n);const p=te(this,vn);let _;return h===void 0?_=Jd(o,p):(h=tf(h),_=ms(o,li(p,te(h,Dr)),"compatible")),fs(_,o,te(this,kt))}toPlainYearMonth(){st(this,Cr);const n=te(this,kt);return Xm(m_(n,Ws(n,te(this,vn)),"constrain"),n)}toPlainMonthDay(){st(this,Cr);const n=te(this,kt);return Ym(J0(n,Ws(n,te(this,vn)),"constrain"),n)}static from(n,o=void 0){return $y(n,o)}static compare(n,o){const h=$y(n),p=$y(o);return Gu(te(h,vn),te(p,vn))}}function Ps(i,n){st(i,Cr);const o=te(i,vn);return O_(i).isoToDate(o,{[n]:!0})[n]}rd($b,"Temporal.PlainDate");class Yb{constructor(n,o,h,p=0,_=0,v=0,c=0,D=0,I=0,P="iso8601"){const B=Mn(n),U=Mn(o),Z=Mn(h),ne=p===void 0?0:Mn(p),ye=_===void 0?0:Mn(_),me=v===void 0?0:Mn(v),Pe=c===void 0?0:Mn(c),tt=D===void 0?0:Mn(D),Je=I===void 0?0:Mn(I),$e=Ks(P===void 0?"iso8601":pa(P));Ob(B,U,Z,ne,ye,me,Pe,tt,Je),AS(this,{isoDate:{year:B,month:U,day:Z},time:{hour:ne,minute:ye,second:me,millisecond:Pe,microsecond:tt,nanosecond:Je}},$e)}get calendarId(){return st(this,Ki),te(this,kt)}get year(){return Ls(this,"year")}get month(){return Ls(this,"month")}get monthCode(){return Ls(this,"monthCode")}get day(){return Ls(this,"day")}get hour(){return Um(this,"hour")}get minute(){return Um(this,"minute")}get second(){return Um(this,"second")}get millisecond(){return Um(this,"millisecond")}get microsecond(){return Um(this,"microsecond")}get nanosecond(){return Um(this,"nanosecond")}get era(){return Ls(this,"era")}get eraYear(){return Ls(this,"eraYear")}get dayOfWeek(){return Ls(this,"dayOfWeek")}get dayOfYear(){return Ls(this,"dayOfYear")}get weekOfYear(){var n;return(n=Ls(this,"weekOfYear"))==null?void 0:n.week}get yearOfWeek(){var n;return(n=Ls(this,"weekOfYear"))==null?void 0:n.year}get daysInWeek(){return Ls(this,"daysInWeek")}get daysInYear(){return Ls(this,"daysInYear")}get daysInMonth(){return Ls(this,"daysInMonth")}get monthsInYear(){return Ls(this,"monthsInYear")}get inLeapYear(){return Ls(this,"inLeapYear")}with(n,o=void 0){if(st(this,Ki),!kr(n))throw new TypeError("invalid argument");mg(n);const h=te(this,kt),p=te(this,hr);let _={...Ws(h,p.isoDate),...p.time};return _=Rp(h,_,sl(h,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],"partial")),Ul(j_(h,_,si(an(o))),h)}withPlainTime(n=void 0){st(this,Ki);const o=SS(n);return Ul(li(te(this,hr).isoDate,o),te(this,kt))}withCalendar(n){st(this,Ki);const o=F_(n);return Ul(te(this,hr),o)}add(n,o=void 0){return st(this,Ki),$w("add",this,n,o)}subtract(n,o=void 0){return st(this,Ki),$w("subtract",this,n,o)}until(n,o=void 0){return st(this,Ki),jw("until",this,n,o)}since(n,o=void 0){return st(this,Ki),jw("since",this,n,o)}round(n){if(st(this,Ki),n===void 0)throw new TypeError("options parameter is required");const o=typeof n=="string"?Lp("smallestUnit",n):an(n),h=gg(o),p=Gc(o,"halfExpand"),_=So(o,"smallestUnit","time",ed,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];yg(h,v,v===1);const c=te(this,hr);return Ul(h===1&&_==="nanosecond"?c:tb(c,h,_,p),te(this,kt))}equals(n){st(this,Ki);const o=Yy(n);return og(te(this,hr),te(o,hr))===0&&Uu(te(this,kt),te(o,kt))}toString(n=void 0){st(this,Ki);const o=an(n),h=N_(o),p=P_(o),_=Gc(o,"trunc"),v=So(o,"smallestUnit","time",void 0);if(v==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:c,unit:D,increment:I}=L_(v,p),P=tb(te(this,hr),I,D,_);return Np(P),y_(P,te(this,kt),c,h)}toJSON(){return st(this,Ki),y_(te(this,hr),te(this,kt),"auto")}toLocaleString(n=void 0,o=void 0){return st(this,Ki),new Gl(n,o).format(this)}valueOf(){mf("PlainDateTime")}toZonedDateTime(n,o=void 0){st(this,Ki);const h=Xs(n),p=a_(an(o));return fs(ms(h,te(this,hr),p),h,te(this,kt))}toPlainDate(){return st(this,Ki),Hs(te(this,hr).isoDate,te(this,kt))}toPlainTime(){return st(this,Ki),Uh(te(this,hr).time)}static from(n,o=void 0){return Yy(n,o)}static compare(n,o){const h=Yy(n),p=Yy(o);return og(te(h,hr),te(p,hr))}}function Ls(i,n){st(i,Ki);const o=te(i,hr).isoDate;return O_(i).isoToDate(o,{[n]:!0})[n]}function Um(i,n){return st(i,Ki),te(i,hr).time[n]}rd(Yb,"Temporal.PlainDateTime");class cg{constructor(n=0,o=0,h=0,p=0,_=0,v=0,c=0,D=0,I=0,P=0){const B=n===void 0?0:Bc(n),U=o===void 0?0:Bc(o),Z=h===void 0?0:Bc(h),ne=p===void 0?0:Bc(p),ye=_===void 0?0:Bc(_),me=v===void 0?0:Bc(v),Pe=c===void 0?0:Bc(c),tt=D===void 0?0:Bc(D),Je=I===void 0?0:Bc(I),$e=P===void 0?0:Bc(P);Dv(B,U,Z,ne,ye,me,Pe,tt,Je,$e),id(this),On(this,Bs,B),On(this,Fs,U),On(this,bo,Z),On(this,Us,ne),On(this,Vs,ye),On(this,Gs,me),On(this,Zs,Pe),On(this,$s,tt),On(this,Ys,Je),On(this,wo,$e)}get years(){return st(this,Mr),te(this,Bs)}get months(){return st(this,Mr),te(this,Fs)}get weeks(){return st(this,Mr),te(this,bo)}get days(){return st(this,Mr),te(this,Us)}get hours(){return st(this,Mr),te(this,Vs)}get minutes(){return st(this,Mr),te(this,Gs)}get seconds(){return st(this,Mr),te(this,Zs)}get milliseconds(){return st(this,Mr),te(this,$s)}get microseconds(){return st(this,Mr),te(this,Ys)}get nanoseconds(){return st(this,Mr),te(this,wo)}get sign(){return st(this,Mr),nv(this)}get blank(){return st(this,Mr),nv(this)===0}with(n){st(this,Mr);const o=TS(n),{years:h=te(this,Bs),months:p=te(this,Fs),weeks:_=te(this,bo),days:v=te(this,Us),hours:c=te(this,Vs),minutes:D=te(this,Gs),seconds:I=te(this,Zs),milliseconds:P=te(this,$s),microseconds:B=te(this,Ys),nanoseconds:U=te(this,wo)}=o;return new cg(h,p,_,v,c,D,I,P,B,U)}negated(){return st(this,Mr),Co(this)}abs(){return st(this,Mr),new cg(Math.abs(te(this,Bs)),Math.abs(te(this,Fs)),Math.abs(te(this,bo)),Math.abs(te(this,Us)),Math.abs(te(this,Vs)),Math.abs(te(this,Gs)),Math.abs(te(this,Zs)),Math.abs(te(this,$s)),Math.abs(te(this,Ys)),Math.abs(te(this,wo)))}add(n){return st(this,Mr),Vw("add",this,n)}subtract(n){return st(this,Mr),Vw("subtract",this,n)}round(n){if(st(this,Mr),n===void 0)throw new TypeError("options parameter is required");const o=Oh(this),h=typeof n=="string"?Lp("smallestUnit",n):an(n);let p=So(h,"largestUnit","datetime",void 0,["auto"]),{plainRelativeTo:_,zonedRelativeTo:v}=mx(h);const c=gg(h),D=Gc(h,"halfExpand");let I=So(h,"smallestUnit","datetime",void 0),P=!0;I||(P=!1,I="nanosecond");const B=qh(o,I);let U=!0;if(p||(U=!1,p=B),p==="auto"&&(p=B),!P&&!U)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(qh(p,I)!==p)throw new RangeError(`largestUnit ${p} cannot be smaller than smallestUnit ${I}`);const Z={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[I];if(Z!==void 0&&yg(c,Z,!1),c>1&&jh(I)==="date"&&p!==I)throw new RangeError("For calendar units with roundingIncrement > 1, use largestUnit = smallestUnit");if(v){let ye=Zm(this);const me=te(v,wi),Pe=te(v,kt),tt=te(v,_n);return ye=$S(tt,Wy(tt,me,Pe,ye),me,Pe,p,c,I,D),jh(p)==="date"&&(p="hour"),Vl(ye,p)}if(_){let ye=Lu(this);const me=sg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},ye.time),Pe=te(_,vn),tt=te(_,kt),Je=nl(tt,Pe,ps(ye.date,me.deltaDays),"constrain");return ye=ZS(li(Pe,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),li(Je,me),tt,p,c,I,D),Vl(ye,p)}if(Iu(o))throw new RangeError(`a starting point is required for ${o}s balancing`);if(Iu(p))throw new RangeError(`a starting point is required for ${p}s balancing`);let ne=Lu(this);if(I==="day"){const{quotient:ye,remainder:me}=ne.time.divmod(W0);let Pe=ne.date.days+ye+s_(me,"day");Pe=nf(Pe,c,D),ne=Hh({years:0,months:0,weeks:0,days:Pe},Vn.ZERO)}else ne=Hh({years:0,months:0,weeks:0,days:0},iv(ne.time,c,I,D));return Vl(ne,p)}total(n){if(st(this,Mr),n===void 0)throw new TypeError("options argument is required");const o=typeof n=="string"?Lp("unit",n):an(n);let{plainRelativeTo:h,zonedRelativeTo:p}=mx(o);const _=So(o,"unit","datetime",ed);if(p){const c=Zm(this),D=te(p,wi),I=te(p,kt),P=te(p,_n);return function(B,U,Z,ne,ye){return jh(ye)==="time"?s_(Vn.fromEpochNsDiff(U,B),ye):Pw(VS(B,U,Z,ne,ye),U,ql(Z,B),Z,ne,ye)}(P,Wy(P,D,I,c),D,I,_)}if(h){const c=Lu(this);let D=sg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},c.time);const I=te(h,vn),P=te(h,kt),B=nl(P,I,ps(c.date,D.deltaDays),"constrain");return function(U,Z,ne,ye){if(og(U,Z)==0)return 0;Np(U),Np(Z);const me=US(U,Z,ne,ye);return ye==="nanosecond"?Q.toNumber(me.time.totalNs):Pw(me,qa(Z),U,null,ne,ye)}(li(I,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),li(B,D),P,_)}const v=Oh(this);if(Iu(v))throw new RangeError(`a starting point is required for ${v}s total`);if(Iu(_))throw new RangeError(`a starting point is required for ${_}s total`);return s_(Lu(this).time,_)}toString(n=void 0){st(this,Mr);const o=an(n),h=P_(o),p=Gc(o,"trunc"),_=So(o,"smallestUnit","time",void 0);if(_==="hour"||_==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:v,unit:c,increment:D}=L_(_,h);if(c==="nanosecond"&&D===1)return z0(this,v);const I=Oh(this);let P=Zm(this);const B=iv(P.time,D,c,p);return P=Hh(P.date,B),z0(Vl(P,qh(I,"second")),v)}toJSON(){return st(this,Mr),z0(this,"auto")}toLocaleString(n=void 0,o=void 0){if(st(this,Mr),typeof Intl.DurationFormat=="function"){const h=new Intl.DurationFormat(n,o);return iE.call(h,this)}return console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),z0(this,"auto")}valueOf(){mf("Duration")}static from(n){return Zl(n)}static compare(n,o,h=void 0){const p=Zl(n),_=Zl(o),v=an(h),{plainRelativeTo:c,zonedRelativeTo:D}=mx(v);if(te(p,Bs)===te(_,Bs)&&te(p,Fs)===te(_,Fs)&&te(p,bo)===te(_,bo)&&te(p,Us)===te(_,Us)&&te(p,Vs)===te(_,Vs)&&te(p,Gs)===te(_,Gs)&&te(p,Zs)===te(_,Zs)&&te(p,$s)===te(_,$s)&&te(p,Ys)===te(_,Ys)&&te(p,wo)===te(_,wo))return 0;const I=Oh(p),P=Oh(_),B=Zm(p),U=Zm(_);if(D&&(jh(I)==="date"||jh(P)==="date")){const Pe=te(D,wi),tt=te(D,kt),Je=te(D,_n),$e=Wy(Je,Pe,tt,B),Me=Wy(Je,Pe,tt,U);return To(Q.toNumber(Q.subtract($e,Me)))}let Z=B.date.days,ne=U.date.days;if(Iu(I)||Iu(P)){if(!c)throw new RangeError("A starting point is required for years, months, or weeks comparison");Z=Nw(B.date,c),ne=Nw(U.date,c)}const ye=B.time.add24HourDays(Z),me=U.time.add24HourDays(ne);return ye.cmp(me)}}rd(cg,"Temporal.Duration");class qb{constructor(n,o,h="iso8601",p=1972){const _=Mn(n),v=Mn(o),c=Ks(h===void 0?"iso8601":pa(h)),D=Mn(p);zp(D,_,v),MS(this,{year:D,month:_,day:v},c)}get monthCode(){return Ww(this,"monthCode")}get day(){return Ww(this,"day")}get calendarId(){return st(this,Jo),te(this,kt)}with(n,o=void 0){if(st(this,Jo),!kr(n))throw new TypeError("invalid argument");mg(n);const h=te(this,kt);let p=Ws(h,te(this,vn),"month-day");return p=Rp(h,p,sl(h,n,["year","month","monthCode","day"],[],"partial")),Ym(J0(h,p,si(an(o))),h)}equals(n){st(this,Jo);const o=Ew(n);return Gu(te(this,vn),te(o,vn))===0&&Uu(te(this,kt),te(o,kt))}toString(n=void 0){return st(this,Jo),kw(this,N_(an(n)))}toJSON(){return st(this,Jo),kw(this)}toLocaleString(n=void 0,o=void 0){return st(this,Jo),new Gl(n,o).format(this)}valueOf(){mf("PlainMonthDay")}toPlainDate(n){if(st(this,Jo),!kr(n))throw new TypeError("argument should be an object");const o=te(this,kt);return Hs(uf(o,Rp(o,Ws(o,te(this,vn),"month-day"),sl(o,n,["year"],[],[])),"constrain"),o)}static from(n,o=void 0){return Ew(n,o)}}function Ww(i,n){st(i,Jo);const o=te(i,vn);return O_(i).isoToDate(o,{[n]:!0})[n]}function yx(i){return ql(i,rb())}rd(qb,"Temporal.PlainMonthDay");const rE={instant:()=>Pu(rb()),plainDateTimeISO:(i=Oy())=>Ul(yx(Xs(i)),"iso8601"),plainDateISO:(i=Oy())=>Hs(yx(Xs(i)).isoDate,"iso8601"),plainTimeISO:(i=Oy())=>Uh(yx(Xs(i)).time),timeZoneId:()=>Oy(),zonedDateTimeISO:(i=Oy())=>{const n=Xs(i);return fs(rb(),n,"iso8601")},[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(rE,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});class Y_{constructor(n=0,o=0,h=0,p=0,_=0,v=0){const c=n===void 0?0:Mn(n),D=o===void 0?0:Mn(o),I=h===void 0?0:Mn(h),P=p===void 0?0:Mn(p),B=_===void 0?0:Mn(_),U=v===void 0?0:Mn(v);Cv(c,D,I,P,B,U),CS(this,{hour:c,minute:D,second:I,millisecond:P,microsecond:B,nanosecond:U})}get hour(){return st(this,Lr),te(this,Dr).hour}get minute(){return st(this,Lr),te(this,Dr).minute}get second(){return st(this,Lr),te(this,Dr).second}get millisecond(){return st(this,Lr),te(this,Dr).millisecond}get microsecond(){return st(this,Lr),te(this,Dr).microsecond}get nanosecond(){return st(this,Lr),te(this,Dr).nanosecond}with(n,o=void 0){if(st(this,Lr),!kr(n))throw new TypeError("invalid argument");mg(n);const h=Hx(n,"partial"),p=Hx(this);let{hour:_,minute:v,second:c,millisecond:D,microsecond:I,nanosecond:P}=Object.assign(p,h);const B=si(an(o));return{hour:_,minute:v,second:c,millisecond:D,microsecond:I,nanosecond:P}=Ev(_,v,c,D,I,P,B),new Y_(_,v,c,D,I,P)}add(n){return st(this,Lr),Yw("add",this,n)}subtract(n){return st(this,Lr),Yw("subtract",this,n)}until(n,o=void 0){return st(this,Lr),Bw("until",this,n,o)}since(n,o=void 0){return st(this,Lr),Bw("since",this,n,o)}round(n){if(st(this,Lr),n===void 0)throw new TypeError("options parameter is required");const o=typeof n=="string"?Lp("smallestUnit",n):an(n),h=gg(o),p=Gc(o,"halfExpand"),_=So(o,"smallestUnit","time",ed);return yg(h,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_],!1),Uh(nb(te(this,Dr),h,_,p))}equals(n){st(this,Lr);const o=tf(n);return ib(te(this,Dr),te(o,Dr))===0}toString(n=void 0){st(this,Lr);const o=an(n),h=P_(o),p=Gc(o,"trunc"),_=So(o,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:v,unit:c,increment:D}=L_(_,h);return Dw(nb(te(this,Dr),D,c,p),v)}toJSON(){return st(this,Lr),Dw(te(this,Dr),"auto")}toLocaleString(n=void 0,o=void 0){return st(this,Lr),new Gl(n,o).format(this)}valueOf(){mf("PlainTime")}static from(n,o=void 0){return tf(n,o)}static compare(n,o){const h=tf(n),p=tf(o);return ib(te(h,Dr),te(p,Dr))}}rd(Y_,"Temporal.PlainTime");class Hb{constructor(n,o,h="iso8601",p=1){const _=Mn(n),v=Mn(o),c=Ks(h===void 0?"iso8601":pa(h)),D=Mn(p);zp(_,v,D),DS(this,{year:_,month:v,day:D},c)}get year(){return Nh(this,"year")}get month(){return Nh(this,"month")}get monthCode(){return Nh(this,"monthCode")}get calendarId(){return st(this,Ya),te(this,kt)}get era(){return Nh(this,"era")}get eraYear(){return Nh(this,"eraYear")}get daysInMonth(){return Nh(this,"daysInMonth")}get daysInYear(){return Nh(this,"daysInYear")}get monthsInYear(){return Nh(this,"monthsInYear")}get inLeapYear(){return Nh(this,"inLeapYear")}with(n,o=void 0){if(st(this,Ya),!kr(n))throw new TypeError("invalid argument");mg(n);const h=te(this,kt);let p=Ws(h,te(this,vn),"year-month");return p=Rp(h,p,sl(h,n,["year","month","monthCode"],[],"partial")),Xm(m_(h,p,si(an(o))),h)}add(n,o=void 0){return st(this,Ya),qw("add",this,n,o)}subtract(n,o=void 0){return st(this,Ya),qw("subtract",this,n,o)}until(n,o=void 0){return st(this,Ya),Fw("until",this,n,o)}since(n,o=void 0){return st(this,Ya),Fw("since",this,n,o)}equals(n){st(this,Ya);const o=Hy(n);return Gu(te(this,vn),te(o,vn))===0&&Uu(te(this,kt),te(o,kt))}toString(n=void 0){return st(this,Ya),Iw(this,N_(an(n)))}toJSON(){return st(this,Ya),Iw(this)}toLocaleString(n=void 0,o=void 0){return st(this,Ya),new Gl(n,o).format(this)}valueOf(){mf("PlainYearMonth")}toPlainDate(n){if(st(this,Ya),!kr(n))throw new TypeError("argument should be an object");const o=te(this,kt);return Hs(uf(o,Rp(o,Ws(o,te(this,vn),"year-month"),sl(o,n,["day"],[],[])),"constrain"),o)}static from(n,o=void 0){return Hy(n,o)}static compare(n,o){const h=Hy(n),p=Hy(o);return Gu(te(h,vn),te(p,vn))}}function Nh(i,n){st(i,Ya);const o=te(i,vn);return O_(i).isoToDate(o,{[n]:!0})[n]}rd(Hb,"Temporal.PlainYearMonth");const S3=Gl.prototype.resolvedOptions;class Xb{constructor(n,o,h="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const p=rv(n);let _=pa(o);const{tzName:v,offsetMinutes:c}=af(_);if(c===void 0){const D=ev(v);if(!D)throw new RangeError(`unknown time zone ${v}`);_=D.identifier}else _=Nb(c);IS(this,p,_,Ks(h===void 0?"iso8601":pa(h)))}get calendarId(){return st(this,Un),te(this,kt)}get timeZoneId(){return st(this,Un),te(this,wi)}get year(){return Os(this,"year")}get month(){return Os(this,"month")}get monthCode(){return Os(this,"monthCode")}get day(){return Os(this,"day")}get hour(){return Vm(this,"hour")}get minute(){return Vm(this,"minute")}get second(){return Vm(this,"second")}get millisecond(){return Vm(this,"millisecond")}get microsecond(){return Vm(this,"microsecond")}get nanosecond(){return Vm(this,"nanosecond")}get era(){return Os(this,"era")}get eraYear(){return Os(this,"eraYear")}get epochMilliseconds(){return st(this,Un),Hl(te(this,_n),"floor")}get epochNanoseconds(){return st(this,Un),YS(te(this,_n))}get dayOfWeek(){return Os(this,"dayOfWeek")}get dayOfYear(){return Os(this,"dayOfYear")}get weekOfYear(){var n;return(n=Os(this,"weekOfYear"))==null?void 0:n.week}get yearOfWeek(){var n;return(n=Os(this,"weekOfYear"))==null?void 0:n.year}get hoursInDay(){st(this,Un);const n=te(this,wi),o=ku(this).isoDate,h=Mo(o.year,o.month,o.day+1),p=Jd(n,o),_=Jd(n,h);return s_(Vn.fromEpochNsDiff(_,p),"hour")}get daysInWeek(){return Os(this,"daysInWeek")}get daysInMonth(){return Os(this,"daysInMonth")}get daysInYear(){return Os(this,"daysInYear")}get monthsInYear(){return Os(this,"monthsInYear")}get inLeapYear(){return Os(this,"inLeapYear")}get offset(){return st(this,Un),Xx(Vh(te(this,wi),te(this,_n)))}get offsetNanoseconds(){return st(this,Un),Vh(te(this,wi),te(this,_n))}with(n,o=void 0){if(st(this,Un),!kr(n))throw new TypeError("invalid zoned-date-time-like");mg(n);const h=te(this,kt),p=te(this,wi),_=Vh(p,te(this,_n)),v=ku(this);let c={...Ws(h,v.isoDate),...v.time,offset:Xx(_)};c=Rp(h,c,sl(h,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset"],"partial"));const D=an(o),I=a_(D),P=B0(D,"prefer"),B=j_(h,c,si(D)),U=_g(c.offset);return fs(K0(B.isoDate,B.time,"option",U,p,I,P,!1),p,h)}withPlainTime(n=void 0){st(this,Un);const o=te(this,wi),h=te(this,kt),p=ku(this).isoDate;let _;return _=n===void 0?Jd(o,p):ms(o,li(p,te(tf(n),Dr)),"compatible"),fs(_,o,h)}withTimeZone(n){st(this,Un);const o=Xs(n);return fs(te(this,_n),o,te(this,kt))}withCalendar(n){st(this,Un);const o=F_(n);return fs(te(this,_n),te(this,wi),o)}add(n,o=void 0){return st(this,Un),Hw("add",this,n,o)}subtract(n,o=void 0){return st(this,Un),Hw("subtract",this,n,o)}until(n,o=void 0){return st(this,Un),Uw("until",this,n,o)}since(n,o=void 0){return st(this,Un),Uw("since",this,n,o)}round(n){if(st(this,Un),n===void 0)throw new TypeError("options parameter is required");const o=typeof n=="string"?Lp("smallestUnit",n):an(n),h=gg(o),p=Gc(o,"halfExpand"),_=So(o,"smallestUnit","time",ed,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];if(yg(h,v,v===1),_==="nanosecond"&&h===1)return fs(te(this,_n),te(this,wi),te(this,kt));const c=te(this,wi),D=te(this,_n),I=ku(this);let P;if(_==="day"){const B=I.isoDate,U=Mo(B.year,B.month,B.day+1),Z=Jd(c,B),ne=Jd(c,U),ye=Q.subtract(ne,Z);P=Vn.fromEpochNsDiff(D,Z).round(ye,p).addToEpochNs(Z)}else{const B=tb(I,h,_,p),U=Vh(c,D);P=K0(B.isoDate,B.time,"option",U,c,"compatible","prefer",!1)}return fs(P,c,te(this,kt))}equals(n){st(this,Un);const o=Xy(n),h=te(this,_n),p=te(o,_n);return!!Q.equal(Q.BigInt(h),Q.BigInt(p))&&!!RS(te(this,wi),te(o,wi))&&Uu(te(this,kt),te(o,kt))}toString(n=void 0){st(this,Un);const o=an(n),h=N_(o),p=P_(o),_=function(U){return Xh(U,"offset",["auto","never"],"auto")}(o),v=Gc(o,"trunc"),c=So(o,"smallestUnit","time",void 0);if(c==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const D=function(U){return Xh(U,"timeZoneName",["auto","never","critical"],"auto")}(o),{precision:I,unit:P,increment:B}=L_(c,p);return Rw(this,I,h,D,_,{unit:P,increment:B,roundingMode:v})}toLocaleString(n=void 0,o=void 0){st(this,Un);const h=an(o),p=Object.create(null);if(function(D,I,P,B){if(I==null)return;const U=Reflect.ownKeys(I);for(let Z=0;Z<U.length;Z++){const ne=U[Z];if(!P.some(ye=>Object.is(ye,ne))&&Object.prototype.propertyIsEnumerable.call(I,ne)){const ye=I[ne];D[ne]=ye}}}(p,h,["timeZone"]),h.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");if(p.year===void 0&&p.month===void 0&&p.day===void 0&&p.era===void 0&&p.weekday===void 0&&p.dateStyle===void 0&&p.hour===void 0&&p.minute===void 0&&p.second===void 0&&p.fractionalSecondDigits===void 0&&p.timeStyle===void 0&&p.dayPeriod===void 0&&p.timeZoneName===void 0&&(p.timeZoneName="short"),p.timeZone=te(this,wi),zw(p.timeZone))throw new RangeError("toLocaleString does not currently support offset time zones");const _=new Gl(n,p),v=S3.call(_).calendar,c=te(this,kt);if(c!=="iso8601"&&v!=="iso8601"&&!Uu(v,c))throw new RangeError(`cannot format ZonedDateTime with calendar ${c} in locale with calendar ${v}`);return _.format(Pu(te(this,_n)))}toJSON(){return st(this,Un),Rw(this,"auto")}valueOf(){mf("ZonedDateTime")}startOfDay(){st(this,Un);const n=te(this,wi);return fs(Jd(n,ku(this).isoDate),n,te(this,kt))}getTimeZoneTransition(n){st(this,Un);const o=te(this,wi);if(n===void 0)throw new TypeError("options parameter is required");const h=Xh(typeof n=="string"?Lp("direction",n):an(n),"direction",["next","previous"],ed);if(h===void 0)throw new TypeError("direction option is required");if(zw(o)||o==="UTC")return null;const p=te(this,_n),_=h==="next"?Lb(o,p):Qx(o,p);return _===null?null:fs(_,o,te(this,kt))}toInstant(){return st(this,Un),Pu(te(this,_n))}toPlainDate(){return st(this,Un),Hs(ku(this).isoDate,te(this,kt))}toPlainTime(){return st(this,Un),Uh(ku(this).time)}toPlainDateTime(){return st(this,Un),Ul(ku(this),te(this,kt))}static from(n,o=void 0){return Xy(n,o)}static compare(n,o){const h=Xy(n),p=Xy(o),_=te(h,_n),v=te(p,_n);return Q.lessThan(Q.BigInt(_),Q.BigInt(v))?-1:Q.greaterThan(Q.BigInt(_),Q.BigInt(v))?1:0}}function ku(i){return ql(te(i,wi),te(i,_n))}function Os(i,n){st(i,Un);const o=ku(i).isoDate;return O_(i).isoToDate(o,{[n]:!0})[n]}function Vm(i,n){return st(i,Un),ku(i).time[n]}rd(Xb,"Temporal.ZonedDateTime");var Qw=Object.freeze({__proto__:null,Duration:cg,Instant:Zb,Now:rE,PlainDate:$b,PlainDateTime:Yb,PlainMonthDay:qb,PlainTime:Y_,PlainYearMonth:Hb,ZonedDateTime:Xb});const E3=[Zb,$b,Yb,cg,qb,Y_,Hb,Xb];for(const i of E3){const n=Object.getOwnPropertyDescriptor(i,"prototype");(n.configurable||n.enumerable||n.writable)&&(n.configurable=!1,n.enumerable=!1,n.writable=!1,Object.defineProperty(i,"prototype",n))}function A3({tripQueryVariables:i,setTripQueryVariables:n}){const o=he.useContext(k_),h=Qw.Instant.from(i.dateTime).toZonedDateTimeISO(o).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),p=he.useCallback(_=>{const v=Qw.PlainDateTime.from(_.target.value).toZonedDateTime(o).toString({calendarName:"never",timeZoneName:"never"});n({...i,dateTime:v})},[i,n,o]);return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+o,children:"Time"}),ae.jsx(Ii.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:p,value:h})]})}function M3({tripQueryVariables:i,setTripQueryVariables:n}){return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),ae.jsx(Ii.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:i.searchWindow||"",onChange:o=>n({...i,searchWindow:Number(o.target.value)>0?Number(o.target.value):void 0})})]})}function C3({tripQueryVariables:i,setTripQueryVariables:n}){var o;return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),ae.jsxs(Ii.Select,{id:"accessSelect",size:"sm",onChange:h=>{var p,_;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,accessMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.directMode||(_=i.modes)!=null&&_.transportModes?{...i.modes,accessMode:void 0}:void 0})},value:((o=i.modes)==null?void 0:o.accessMode)||"not_selected",children:[ae.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(dv).map(h=>ae.jsx("option",{value:h,children:h},h))]})]})}function D3({tripQueryVariables:i,setTripQueryVariables:n}){var o;return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),ae.jsxs(Ii.Select,{id:"egressSelect",size:"sm",onChange:h=>{var p,_;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,egressMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.directMode||(_=i.modes)!=null&&_.transportModes?{...i.modes,egressMode:void 0}:void 0})},value:((o=i.modes)==null?void 0:o.egressMode)||"not_selected",children:[ae.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(dv).map(h=>ae.jsx("option",{value:h,children:h},h))]})]})}function k3({tripQueryVariables:i,setTripQueryVariables:n}){var o;return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),ae.jsxs(Ii.Select,{id:"directModeSelect",size:"sm",onChange:h=>{var p,_,v;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,directMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.accessMode||(_=i.modes)!=null&&_.egressMode||(v=i.modes)!=null&&v.transportModes?{...i.modes,directMode:void 0}:void 0})},value:((o=i.modes)==null?void 0:o.directMode)||"not_selected",children:[ae.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(dv).map(h=>ae.jsx("option",{value:h,children:h},h))]})]})}const I3=({label:i,options:n,values:o,onChange:h})=>{const[p,_]=he.useState(!1),v=()=>{_(!p)},c=D=>{const I=D.target.value,P=D.target.checked;h(P?[...o,I]:o.filter(B=>B!==I))};return ae.jsxs("div",{className:`dropdown ${p?"show":""}`,children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:i}),ae.jsx(Ii.Control,{type:"text",id:"multiSelectDropdown",size:"sm",value:o.length>0?o.join(", "):"Not selected",onClick:v,onChange:()=>{}}),ae.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${p?"show":""}`,children:n.map(D=>ae.jsx(Ii.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${D.id}`,label:D.label,checked:o.includes(D.id),onChange:c,value:`${D.id}`},`${D.id}`))})]})};function R3({tripQueryVariables:i,setTripQueryVariables:n}){var p;const o=he.useMemo(()=>{var _,v;return((v=(_=i==null?void 0:i.modes)==null?void 0:_.transportModes)==null?void 0:v.map(c=>c==null?void 0:c.transportMode).filter(c=>!!c))||[]},[(p=i.modes)==null?void 0:p.transportModes]),h=he.useCallback(_=>{var c,D,I;const v=_.map(P=>({transportMode:P}));v.length===0?n({...i,modes:(c=i.modes)!=null&&c.directMode||(D=i.modes)!=null&&D.accessMode||(I=i.modes)!=null&&I.egressMode?{...i.modes}:void 0}):n({...i,modes:{...i.modes,transportModes:v.length>0?v:void 0}})},[i,n]);return ae.jsx(I3,{label:"Transit mode",options:Object.values($2).map(_=>({id:_,label:_.toString()})),values:o,onChange:h})}function z3({tripQueryVariables:i,setTripQueryVariables:n}){return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),ae.jsx(Ii.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:i.numTripPatterns||"",onChange:o=>n({...i,numTripPatterns:Number(o.target.value)>0?Number(o.target.value):void 0})})]})}function N3({tripQueryVariables:i,setTripQueryVariables:n}){var o;return ae.jsxs(Ii.Group,{children:[ae.jsx(Ii.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),ae.jsxs(Ii.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-medium",onChange:h=>{n({...i,itineraryFilters:{debug:h.target.value}})},value:((o=i.itineraryFilters)==null?void 0:o.debug)||"not_selected",children:[ae.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Z2).map(h=>ae.jsx("option",{value:h,children:h},h))]})]})}const P3="https://www.opentripplanner.org/debug-client-assets/2025/06/2025-06-19T11:08/assets/graphql-solid-B1mrnAEK.svg",L3="/graphiql?flavor=transmodel";function O3({tripQueryVariables:i}){const n=encodeURIComponent(JSON.stringify(i)),o=encodeURIComponent(iR),h="Open in GraphiQL";return ae.jsx(kp,{title:h,href:L3+"&query="+o+"&variables="+n,target:"_blank",children:ae.jsx("img",{alt:h,title:h,src:P3,width:"20",height:"20",className:"d-inline-block align-middle"})})}function j3({tripQueryVariables:i,setTripQueryVariables:n,onRoute:o,loading:h}){return ae.jsxs("div",{className:"box input-group search-bar",children:[ae.jsxs("div",{className:"input-family",children:[ae.jsx(gw,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(_R,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(gw,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:i,setTripQueryVariables:n})]}),ae.jsxs("div",{className:"input-family",children:[ae.jsx(vR,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(A3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ae.jsxs("div",{className:"input-family",children:[ae.jsx(z3,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(M3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ae.jsxs("div",{className:"input-family",children:[ae.jsx(C3,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(R3,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(D3,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx(k3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ae.jsx(N3,{tripQueryVariables:i,setTripQueryVariables:n}),ae.jsx("div",{className:"search-bar-route-button-wrapper",children:ae.jsxs(yb,{children:[ae.jsxs(kp,{variant:"primary",onClick:()=>o(),disabled:h,children:[h&&ae.jsxs(ae.Fragment,{children:[ae.jsx(QT,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),ae.jsx(O3,{tripQueryVariables:i})]})})]})}const aE=he.createContext(void 0);function B3(){const i=he.useContext(aE);if(!i)throw new Error("useTripSchema must be used within a TripSchemaProvider");return i}function js(i,n){return n.split(".").reduce((o,h)=>{if(o!=null){if(Array.isArray(o)){const p=Number(h);return Number.isNaN(p)?void 0:o[p]}else if(typeof o=="object")return o[h]}},i)}function Qd(i,n,o){const h=n.split(".");function p(_,v){const c=h[v],D=!isNaN(Number(c));if(v===h.length-1){if(Array.isArray(_)&&D){const U=[..._];return U[Number(c)]=o,U}if(_x(_)&&!D)return{..._,[c]:o};if(D){const U=Array.isArray(_)?[..._]:[];return U[Number(c)]=o,U}else return{..._x(_)?_:{},[c]:o}}const I=v+1,P=h[I],B=!isNaN(Number(P));if(Array.isArray(_)&&D){const U=[..._],Z=_[Number(c)];return U[Number(c)]=p(Z!==void 0?Z:B?[]:{},I),U}else if(_x(_)&&!D){const U={..._},Z=_[c];return U[c]=p(Z!==void 0?Z:B?[]:{},I),U}else if(D){const U=[];return U[Number(c)]=p(B?[]:{},I),U}else return{[c]:p(B?[]:{},I)}}return i==null&&(i=!isNaN(Number(h[0]))?[]:{}),p(i,0)}function _x(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}const F3="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",U3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",V3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",G3=({defaultValue:i,type:n})=>ae.jsxs("span",{children:[i!=null&&ae.jsx("span",{title:`Default: ${i??"None"}`,children:ae.jsx("img",{alt:"Info",src:F3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="DoubleFunction"&&ae.jsx("span",{title:`Type: ${n.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:ae.jsx("img",{alt:"Info",src:U3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="Duration"&&ae.jsx("span",{className:"default-tooltip-icon",title:`Type: ${n.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:ae.jsx("img",{alt:"Info",src:V3,className:"default-tooltip-icon"})})]}),sE=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),oE=({tripQueryVariables:i,setTripQueryVariables:n})=>{function o(){let h={};sE.forEach(p=>{const _=js(i,p);_!==void 0&&(h=Qd(h,p,_))}),n(h)}return ae.jsx("button",{className:"reset-button",onClick:o,children:"Reset"})};function vx(i){if(!i)return" ";const n=i.split(".");return n[n.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,h=>h.toUpperCase())+" "}function F0(i,n=[]){let o=[];return i?(Object.entries(i).forEach(([h,p])=>{const _=[...n,h].join(".");o=o.concat(Z3(h,p,_,n))}),o):[]}function Z3(i,n,o,h){var _;let p=[];if(typeof n=="object"&&n.type)if(n.type.type==="Enum"){const v=["Not selected",...n.type.values||[]],c=n.defaultValue!==void 0?n.defaultValue:"Not selected";p.push({path:o,type:{type:"Enum"},defaultValue:c,enumValues:v,isList:n.isList})}else n.type.type==="InputObject"&&n.isList?(p.push({path:o,type:{type:"Group",name:n.type.name},defaultValue:n.defaultValue,isComplex:!0,isList:!0}),p=p.concat(F0(n.type.fields,[...h,`${i}.*`]))):n.type.type==="InputObject"?(p.push({path:o,type:{type:"Group",name:n.type.name},isComplex:!0,isList:!1}),p=p.concat(F0(n.type.fields,[...h,i]))):n.type.type==="Scalar"&&p.push({path:o,type:{type:n.type.type,subtype:n.type.subtype},defaultValue:n.defaultValue,isList:n.isList});else typeof n=="object"&&((_=n.type)!=null&&_.fields)?(p.push({path:o,type:{type:"Group"},isComplex:!0}),p=p.concat(F0(n.type.fields,[...h,i]))):p.push({path:o,type:n.type??typeof n,defaultValue:n.defaultValue});return p}const $3=({tripQueryVariables:i,setTripQueryVariables:n})=>{const[o,h]=he.useState([]),[p,_]=he.useState({}),[v]=he.useState(""),{tripArgs:c,loading:D,error:I}=B3();he.useEffect(()=>{if(!c||D||I)return;const Me=F0(c.trip.arguments);h(Me)},[c,D,I]);function P(Me){return Me.replace(/\.\d+/g,".*")}function B(Me,Ve){const ct=P(Me),ot=o.find(mt=>mt.path===ct);if(!ot){console.error(`No matching argumentConfig found for path: ${Me}`);return}if(ot.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(ot.type.subtype)&&ot.isList&&typeof Ve=="string"){const mt=Ve.split(",").map(Lt=>Lt.trim());let It=Qd(i,Me,mt);It=Z(It,Me),n(It);return}let Re=Qd(i,Me,Ve);Re=Z(Re,Me),n(Re)}function U(Me){return typeof Me=="object"&&Me!==null&&!Array.isArray(Me)}function Z(Me,Ve){if(!Ve.includes(".")){const ot=js(Me,Ve);if(Array.isArray(ot)&&ot.length===0){const Re={...Me};return delete Re[Ve],Re}if(U(ot)&&Object.keys(ot).every(mt=>{const It=ot[mt];return It==null||Array.isArray(It)&&It.length===0})){const mt={...Me};return delete mt[Ve],mt}return Me}const ct=Ve.split(".");for(let ot=ct.length-1;ot>0;ot--){const Re=ct.slice(0,ot).join("."),mt=js(Me,Re);mt!=null&&(Array.isArray(mt)?mt.length===0&&(Me=Qd(Me,Re,void 0)):U(mt)&&Object.keys(mt).every(Lt=>{const Ut=`${Re}.${Lt}`,sn=js(Me,Ut);return sn==null||Array.isArray(sn)&&sn.length===0})&&(Me=Qd(Me,Re,void 0)))}return Me}function ne(Me){_(Ve=>({...Ve,[Me]:!Ve[Me]}))}const ye=o.filter(({path:Me})=>vx(Me).toLowerCase().includes(v.toLowerCase())).filter(({path:Me})=>!sE.has(Me));function me(Me,Ve,ct,ot){const Re=js(i,Me)??[],mt=ot.name;return ae.jsxs("div",{children:[Re.map((It,Lt)=>{const Ut=`${Me}.${Lt}`,sn=Ve.filter(gt=>gt.path.startsWith(`${Me}.*.`)&&gt.path!==`${Me}.*`).map(gt=>({...gt,path:gt.path.replace(`${Me}.*`,Ut)})),on=sn.filter(gt=>gt.path.split(".").length===Ut.split(".").length+1),Ye=p[Ut];return ae.jsxs("div",{style:{marginLeft:15},children:[ae.jsxs("span",{style:{cursor:"pointer"},onClick:()=>ne(Ut),children:[Ye?"▼ ":"▶ "," [#",Lt+1,"]"]}),ae.jsx("button",{style:{marginLeft:10},onClick:()=>tt(Me,Lt),children:"Remove"}),Ye&&ae.jsx("div",{style:{marginLeft:20},children:$e(on,ct+1,sn)})]},Ut)}),ae.jsxs("button",{onClick:()=>Pe(Me),children:["+ Add ",mt]})]})}function Pe(Me){const ct=[...js(i,Me)??[],{}],ot=Qd(i,Me,ct);n(ot)}function tt(Me,Ve){const ot=(js(i,Me)??[]).filter((mt,It)=>It!==Ve);let Re=Qd(i,Me,ot);Re=Z(Re,Me),n(Re)}function Je(Me){let Ve=Qd(i,Me,void 0);Ve=Z(Ve,Me),n(Ve)}function $e(Me,Ve,ct){return Me.map(({path:ot,type:Re,defaultValue:mt,enumValues:It,isComplex:Lt,isList:Ut})=>{const sn=p[ot],on=ot.split(".").length,Ye=ct.filter(_t=>{const qt=_t.path.split(".").length;return _t.path.startsWith(`${ot}.`)&&_t.path!==ot&&qt===on+1}),gt=Ve+1;return ae.jsx("div",{style:{marginLeft:`${Ve*15}px`,marginBottom:"10px"},children:Lt?ae.jsxs("div",{children:[ae.jsxs("span",{style:{cursor:"pointer"},onClick:()=>ne(ot),children:[sn?"▼ ":"▶ "," ",vx(ot)]}),sn&&Ut?ae.jsx("div",{style:{marginLeft:20},children:me(ot,ct,gt,Re)}):sn?$e(Ye,gt,ct):null]}):ae.jsxs("div",{children:[ae.jsxs("label",{className:"argument-label",htmlFor:ot,children:[vx(ot)," ",ae.jsx(G3,{defaultValue:mt,type:Re})]}),Re.subtype==="Boolean"&&(()=>{const _t=js(i,ot),qt=_t!==void 0;return ae.jsxs("span",{children:[ae.jsx("input",{type:"checkbox",id:ot,checked:_t??!1,onChange:Ce=>B(ot,Ce.target.checked)}),qt&&ae.jsx("a",{onClick:()=>Je(ot),className:"remove-argument",children:"x"})]})})(),Re.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Re.subtype)&&Ut&&ae.jsx("input",{className:"comma-separated-input",type:"text",id:ot,value:(()=>{const _t=js(i,ot);return Array.isArray(_t)?_t.join(", "):""})(),onChange:_t=>B(ot,_t.target.value),placeholder:"Comma-separated list"}),Re.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Re.subtype)&&!Ut&&ae.jsx("input",{type:"text",id:ot,value:js(i,ot)??"",onChange:_t=>B(ot,_t.target.value||void 0)}),Re.subtype==="Int"&&ae.jsx("input",{type:"number",id:ot,value:js(i,ot)??"",onChange:_t=>{const qt=parseInt(_t.target.value,10);B(ot,Number.isNaN(qt)?void 0:qt)}}),Re.subtype==="Float"&&ae.jsx("input",{type:"number",id:ot,step:"any",value:js(i,ot)??"",onChange:_t=>{const qt=parseFloat(_t.target.value);B(ot,Number.isNaN(qt)?void 0:qt)}}),Re.subtype==="DateTime"&&ae.jsx("input",{type:"datetime-local",id:ot,value:(js(i,ot)??"").slice(0,16),onChange:_t=>{const qt=_t.target.value?new Date(_t.target.value).toISOString():void 0;B(ot,qt)}}),Re.type==="Enum"&&It&&Ut&&ae.jsx("select",{id:ot,multiple:!0,value:(()=>{const _t=js(i,ot);return Array.isArray(_t)?_t:[]})(),onChange:_t=>{const qt=Array.from(_t.target.selectedOptions,Ce=>Ce.value);B(ot,qt)},children:It.map(_t=>ae.jsx("option",{value:_t,children:_t},_t))}),Re.type==="Enum"&&It&&!Ut&&ae.jsx("select",{id:ot,value:js(i,ot)??"Not selected",onChange:_t=>{B(ot,_t.target.value||void 0)},children:It.map(_t=>ae.jsx("option",{value:_t,children:_t},_t))})]})},ot)})}return ae.jsxs("div",{className:"left-pane-container below-content",children:[ae.jsxs("div",{className:"panel-header",children:["Filters",ae.jsx(oE,{tripQueryVariables:i,setTripQueryVariables:n})]}),ye.length===0?ae.jsx("p",{children:"No arguments found."}):ae.jsx("div",{className:"argument-list",children:$e(ye.filter(Me=>Me.path.split(".").length===1),0,ye)})]})},Y3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",q3="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",H3="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",X3=({children:i})=>{const[n,o]=he.useState(0),h=_=>{switch(_){case 0:return ae.jsx("img",{src:Y3,alt:"Itineray list",title:"Itineray"});case 1:return ae.jsx("img",{src:q3,alt:"Filters",title:"Filters"});case 2:return ae.jsx("img",{width:"25",height:"25",src:H3,alt:"Filters",title:"Filters"});default:return null}},p=Fl.Children.toArray(i).filter(_=>Fl.isValidElement(_));return ae.jsxs("div",{className:"sidebar-container",children:[ae.jsx("div",{className:"sidebar",children:p.map((_,v)=>ae.jsx("div",{className:`sidebar-button ${v===n?"active":""}`,onClick:()=>o(v),children:h(v)},v))}),ae.jsx("div",{className:"sidebar-content",children:p.map((_,v)=>v===n?ae.jsx("div",{children:_},v):null)})]})},W3=({tripQueryVariables:i,setTripQueryVariables:n})=>ae.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[ae.jsxs("div",{className:"panel-header",children:["Arguments raw",ae.jsx(oE,{tripQueryVariables:i,setTripQueryVariables:n})]}),ae.jsx("pre",{children:JSON.stringify(i,null,2)})]});function Q3(i){let n=i;for(;;)if(Zh(n))n=n.ofType;else if(hf(n))n=n.ofType;else break;return n}function lE(i){const n=Q3(i);if(dg(n))return{type:"Scalar",subtype:n.name};if(sf(n))return{type:"Enum",values:n.getValues().map(o=>o.name)};if(Gh(n)){const o=n.getFields(),h={};for(const p of Object.keys(o)){const _=o[p];if(_.deprecationReason)continue;const v=hf(_.type),c=_.defaultValue!==void 0?_.defaultValue:null;h[p]={type:lE(_.type),defaultValue:c,isList:v}}return{type:"InputObject",name:n.name,fields:h}}return{type:"Scalar",subtype:"String"}}function K3(i){const n=i.getQueryType();if(!n)throw new Error("No Query type found in the schema.");const o=n.getFields().trip;if(!o)throw new Error("No trip query found in the schema.");const h={};return o.args.forEach(p=>{if(p.deprecationReason)return;const _=p.name,v=lE(p.type),c=p.defaultValue!==null?p.defaultValue:null,D=hf(p.type);h[_]={type:v,...c!==null&&{defaultValue:c},isList:D}}),{trip:{arguments:h}}}async function J3(i){const n=bM(),o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!o.ok)throw new Error(`Failed to fetch schema. HTTP error: ${o.status}`);const{data:h}=await o.json(),p=wM(h);return K3(p)}function ez({endpoint:i,children:n}){const[o,h]=he.useState(null),[p,_]=he.useState(!0),[v,c]=he.useState(null);he.useEffect(()=>{let I=!0;async function P(){_(!0),c(null);try{const B=await J3(i);I&&h(B)}catch(B){console.error("Error loading trip arguments:",B),I&&c("Failed to load trip schema")}finally{I&&_(!1)}}return P(),()=>{I=!1}},[i]);const D={tripArgs:o,loading:p,error:v};return ae.jsx(aE.Provider,{value:D,children:n})}function tz(){const i=sR(),{tripQueryVariables:n,setTripQueryVariables:o}=uR(),[h,p,_]=rR(n),[v,c]=he.useState(0),D=(i==null?void 0:i.internalTransitModelTimeZone)||Intl.DateTimeFormat().resolvedOptions().timeZone;return ae.jsx("div",{className:"app",children:ae.jsx(k_.Provider,{value:D,children:ae.jsxs("div",{className:"layout",children:[ae.jsx("div",{className:"box logo-section",children:ae.jsx(fR,{serverInfo:i})}),ae.jsx("div",{className:"box input-section",children:ae.jsx(j3,{onRoute:_,tripQueryVariables:n,setTripQueryVariables:o,loading:p})}),ae.jsx("div",{className:"box trip-section",children:ae.jsxs(X3,{children:[ae.jsx(nR,{tripQueryResult:h,selectedTripPatternIndex:v,setSelectedTripPatternIndex:c,pageResults:_,loading:p}),ae.jsx(ez,{endpoint:l_(),children:ae.jsx($3,{tripQueryVariables:n,setTripQueryVariables:o})}),ae.jsx(W3,{tripQueryVariables:n,setTripQueryVariables:o})]})}),ae.jsx("div",{className:"box map-section",children:ae.jsx(sI,{tripQueryResult:h,tripQueryVariables:n,setTripQueryVariables:o,selectedTripPatternIndex:v,loading:p})})]})})})}TE.createRoot(document.getElementById("root")).render(ae.jsx(Fl.StrictMode,{children:ae.jsx(tz,{})}));
