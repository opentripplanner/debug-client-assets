function gE(i,n){for(var l=0;l<n.length;l++){const d=n[l];if(typeof d!="string"&&!Array.isArray(d)){for(const m in d)if(m!=="default"&&!(m in i)){const _=Object.getOwnPropertyDescriptor(d,m);_&&Object.defineProperty(i,m,_.get?_:{enumerable:!0,get:()=>d[m]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))d(m);new MutationObserver(m=>{for(const _ of m)if(_.type==="childList")for(const v of _.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&d(v)}).observe(document,{childList:!0,subtree:!0});function l(m){const _={};return m.integrity&&(_.integrity=m.integrity),m.referrerPolicy&&(_.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?_.credentials="include":m.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function d(m){if(m.ep)return;m.ep=!0;const _=l(m);fetch(m.href,_)}})();function Sp(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Zv={exports:{}},wy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx;function yE(){if(Kx)return wy;Kx=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function l(d,m,_){var v=null;if(_!==void 0&&(v=""+_),m.key!==void 0&&(v=""+m.key),"key"in m){_={};for(var c in m)c!=="key"&&(_[c]=m[c])}else _=m;return m=_.ref,{$$typeof:i,type:d,key:v,ref:m!==void 0?m:null,props:_}}return wy.Fragment=n,wy.jsx=l,wy.jsxs=l,wy}var Jx;function _E(){return Jx||(Jx=1,Zv.exports=yE()),Zv.exports}var ne=_E(),$v={exports:{}},kn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function vE(){if(e1)return kn;e1=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),v=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),R=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),B=Symbol.iterator;function V(be){return be===null||typeof be!="object"?null:(be=B&&be[B]||be["@@iterator"],typeof be=="function"?be:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},re=Object.assign,fe={};function pe(be,et,Et){this.props=be,this.context=et,this.refs=fe,this.updater=Et||G}pe.prototype.isReactComponent={},pe.prototype.setState=function(be,et){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,et,"setState")},pe.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function Ie(){}Ie.prototype=pe.prototype;function Ge(be,et,Et){this.props=be,this.context=et,this.refs=fe,this.updater=Et||G}var je=Ge.prototype=new Ie;je.constructor=Ge,re(je,pe.prototype),je.isPureReactComponent=!0;var He=Array.isArray,Ve={H:null,A:null,T:null,S:null,V:null},rt=Object.prototype.hasOwnProperty;function Je(be,et,Et,bt,Pt,Xt){return Et=Xt.ref,{$$typeof:i,type:be,key:et,ref:Et!==void 0?Et:null,props:Xt}}function Mt(be,et){return Je(be.type,et,void 0,void 0,void 0,be.props)}function Ne(be){return typeof be=="object"&&be!==null&&be.$$typeof===i}function Xe(be){var et={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(Et){return et[Et]})}var _t=/\/+/g;function Rt(be,et){return typeof be=="object"&&be!==null&&be.key!=null?Xe(""+be.key):et.toString(36)}function Ut(){}function un(be){switch(be.status){case"fulfilled":return be.value;case"rejected":throw be.reason;default:switch(typeof be.status=="string"?be.then(Ut,Ut):(be.status="pending",be.then(function(et){be.status==="pending"&&(be.status="fulfilled",be.value=et)},function(et){be.status==="pending"&&(be.status="rejected",be.reason=et)})),be.status){case"fulfilled":return be.value;case"rejected":throw be.reason}}throw be}function Ht(be,et,Et,bt,Pt){var Xt=typeof be;(Xt==="undefined"||Xt==="boolean")&&(be=null);var Bt=!1;if(be===null)Bt=!0;else switch(Xt){case"bigint":case"string":case"number":Bt=!0;break;case"object":switch(be.$$typeof){case i:case n:Bt=!0;break;case z:return Bt=be._init,Ht(Bt(be._payload),et,Et,bt,Pt)}}if(Bt)return Pt=Pt(be),Bt=bt===""?"."+Rt(be,0):bt,He(Pt)?(Et="",Bt!=null&&(Et=Bt.replace(_t,"$&/")+"/"),Ht(Pt,et,Et,"",function(mi){return mi})):Pt!=null&&(Ne(Pt)&&(Pt=Mt(Pt,Et+(Pt.key==null||be&&be.key===Pt.key?"":(""+Pt.key).replace(_t,"$&/")+"/")+Bt)),et.push(Pt)),1;Bt=0;var wi=bt===""?".":bt+":";if(He(be))for(var fn=0;fn<be.length;fn++)bt=be[fn],Xt=wi+Rt(bt,fn),Bt+=Ht(bt,et,Et,Xt,Pt);else if(fn=V(be),typeof fn=="function")for(be=fn.call(be),fn=0;!(bt=be.next()).done;)bt=bt.value,Xt=wi+Rt(bt,fn++),Bt+=Ht(bt,et,Et,Xt,Pt);else if(Xt==="object"){if(typeof be.then=="function")return Ht(un(be),et,Et,bt,Pt);throw et=String(be),Error("Objects are not valid as a React child (found: "+(et==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":et)+"). If you meant to render a collection of children, use an array instead.")}return Bt}function Ue(be,et,Et){if(be==null)return be;var bt=[],Pt=0;return Ht(be,bt,"","",function(Xt){return et.call(Et,Xt,Pt++)}),bt}function ft(be){if(be._status===-1){var et=be._result;et=et(),et.then(function(Et){(be._status===0||be._status===-1)&&(be._status=1,be._result=Et)},function(Et){(be._status===0||be._status===-1)&&(be._status=2,be._result=Et)}),be._status===-1&&(be._status=0,be._result=et)}if(be._status===1)return be._result.default;throw be._result}var Dt=typeof reportError=="function"?reportError:function(be){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var et=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof be=="object"&&be!==null&&typeof be.message=="string"?String(be.message):String(be),error:be});if(!window.dispatchEvent(et))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",be);return}console.error(be)};function It(){}return kn.Children={map:Ue,forEach:function(be,et,Et){Ue(be,function(){et.apply(this,arguments)},Et)},count:function(be){var et=0;return Ue(be,function(){et++}),et},toArray:function(be){return Ue(be,function(et){return et})||[]},only:function(be){if(!Ne(be))throw Error("React.Children.only expected to receive a single React element child.");return be}},kn.Component=pe,kn.Fragment=l,kn.Profiler=m,kn.PureComponent=Ge,kn.StrictMode=d,kn.Suspense=C,kn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ve,kn.__COMPILER_RUNTIME={__proto__:null,c:function(be){return Ve.H.useMemoCache(be)}},kn.cache=function(be){return function(){return be.apply(null,arguments)}},kn.cloneElement=function(be,et,Et){if(be==null)throw Error("The argument must be a React element, but you passed "+be+".");var bt=re({},be.props),Pt=be.key,Xt=void 0;if(et!=null)for(Bt in et.ref!==void 0&&(Xt=void 0),et.key!==void 0&&(Pt=""+et.key),et)!rt.call(et,Bt)||Bt==="key"||Bt==="__self"||Bt==="__source"||Bt==="ref"&&et.ref===void 0||(bt[Bt]=et[Bt]);var Bt=arguments.length-2;if(Bt===1)bt.children=Et;else if(1<Bt){for(var wi=Array(Bt),fn=0;fn<Bt;fn++)wi[fn]=arguments[fn+2];bt.children=wi}return Je(be.type,Pt,void 0,void 0,Xt,bt)},kn.createContext=function(be){return be={$$typeof:v,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null},be.Provider=be,be.Consumer={$$typeof:_,_context:be},be},kn.createElement=function(be,et,Et){var bt,Pt={},Xt=null;if(et!=null)for(bt in et.key!==void 0&&(Xt=""+et.key),et)rt.call(et,bt)&&bt!=="key"&&bt!=="__self"&&bt!=="__source"&&(Pt[bt]=et[bt]);var Bt=arguments.length-2;if(Bt===1)Pt.children=Et;else if(1<Bt){for(var wi=Array(Bt),fn=0;fn<Bt;fn++)wi[fn]=arguments[fn+2];Pt.children=wi}if(be&&be.defaultProps)for(bt in Bt=be.defaultProps,Bt)Pt[bt]===void 0&&(Pt[bt]=Bt[bt]);return Je(be,Xt,void 0,void 0,null,Pt)},kn.createRef=function(){return{current:null}},kn.forwardRef=function(be){return{$$typeof:c,render:be}},kn.isValidElement=Ne,kn.lazy=function(be){return{$$typeof:z,_payload:{_status:-1,_result:be},_init:ft}},kn.memo=function(be,et){return{$$typeof:R,type:be,compare:et===void 0?null:et}},kn.startTransition=function(be){var et=Ve.T,Et={};Ve.T=Et;try{var bt=be(),Pt=Ve.S;Pt!==null&&Pt(Et,bt),typeof bt=="object"&&bt!==null&&typeof bt.then=="function"&&bt.then(It,Dt)}catch(Xt){Dt(Xt)}finally{Ve.T=et}},kn.unstable_useCacheRefresh=function(){return Ve.H.useCacheRefresh()},kn.use=function(be){return Ve.H.use(be)},kn.useActionState=function(be,et,Et){return Ve.H.useActionState(be,et,Et)},kn.useCallback=function(be,et){return Ve.H.useCallback(be,et)},kn.useContext=function(be){return Ve.H.useContext(be)},kn.useDebugValue=function(){},kn.useDeferredValue=function(be,et){return Ve.H.useDeferredValue(be,et)},kn.useEffect=function(be,et,Et){var bt=Ve.H;if(typeof Et=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return bt.useEffect(be,et)},kn.useId=function(){return Ve.H.useId()},kn.useImperativeHandle=function(be,et,Et){return Ve.H.useImperativeHandle(be,et,Et)},kn.useInsertionEffect=function(be,et){return Ve.H.useInsertionEffect(be,et)},kn.useLayoutEffect=function(be,et){return Ve.H.useLayoutEffect(be,et)},kn.useMemo=function(be,et){return Ve.H.useMemo(be,et)},kn.useOptimistic=function(be,et){return Ve.H.useOptimistic(be,et)},kn.useReducer=function(be,et,Et){return Ve.H.useReducer(be,et,Et)},kn.useRef=function(be){return Ve.H.useRef(be)},kn.useState=function(be){return Ve.H.useState(be)},kn.useSyncExternalStore=function(be,et,Et){return Ve.H.useSyncExternalStore(be,et,Et)},kn.useTransition=function(){return Ve.H.useTransition()},kn.version="19.1.1",kn}var t1;function rx(){return t1||(t1=1,$v.exports=vE()),$v.exports}var ce=rx();const kl=Sp(ce);var Yv={exports:{}},Ty={},qv={exports:{}},Hv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function bE(){return n1||(n1=1,function(i){function n(Ue,ft){var Dt=Ue.length;Ue.push(ft);e:for(;0<Dt;){var It=Dt-1>>>1,be=Ue[It];if(0<m(be,ft))Ue[It]=ft,Ue[Dt]=be,Dt=It;else break e}}function l(Ue){return Ue.length===0?null:Ue[0]}function d(Ue){if(Ue.length===0)return null;var ft=Ue[0],Dt=Ue.pop();if(Dt!==ft){Ue[0]=Dt;e:for(var It=0,be=Ue.length,et=be>>>1;It<et;){var Et=2*(It+1)-1,bt=Ue[Et],Pt=Et+1,Xt=Ue[Pt];if(0>m(bt,Dt))Pt<be&&0>m(Xt,bt)?(Ue[It]=Xt,Ue[Pt]=Dt,It=Pt):(Ue[It]=bt,Ue[Et]=Dt,It=Et);else if(Pt<be&&0>m(Xt,Dt))Ue[It]=Xt,Ue[Pt]=Dt,It=Pt;else break e}}return ft}function m(Ue,ft){var Dt=Ue.sortIndex-ft.sortIndex;return Dt!==0?Dt:Ue.id-ft.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;i.unstable_now=function(){return _.now()}}else{var v=Date,c=v.now();i.unstable_now=function(){return v.now()-c}}var C=[],R=[],z=1,B=null,V=3,G=!1,re=!1,fe=!1,pe=!1,Ie=typeof setTimeout=="function"?setTimeout:null,Ge=typeof clearTimeout=="function"?clearTimeout:null,je=typeof setImmediate<"u"?setImmediate:null;function He(Ue){for(var ft=l(R);ft!==null;){if(ft.callback===null)d(R);else if(ft.startTime<=Ue)d(R),ft.sortIndex=ft.expirationTime,n(C,ft);else break;ft=l(R)}}function Ve(Ue){if(fe=!1,He(Ue),!re)if(l(C)!==null)re=!0,rt||(rt=!0,Rt());else{var ft=l(R);ft!==null&&Ht(Ve,ft.startTime-Ue)}}var rt=!1,Je=-1,Mt=5,Ne=-1;function Xe(){return pe?!0:!(i.unstable_now()-Ne<Mt)}function _t(){if(pe=!1,rt){var Ue=i.unstable_now();Ne=Ue;var ft=!0;try{e:{re=!1,fe&&(fe=!1,Ge(Je),Je=-1),G=!0;var Dt=V;try{t:{for(He(Ue),B=l(C);B!==null&&!(B.expirationTime>Ue&&Xe());){var It=B.callback;if(typeof It=="function"){B.callback=null,V=B.priorityLevel;var be=It(B.expirationTime<=Ue);if(Ue=i.unstable_now(),typeof be=="function"){B.callback=be,He(Ue),ft=!0;break t}B===l(C)&&d(C),He(Ue)}else d(C);B=l(C)}if(B!==null)ft=!0;else{var et=l(R);et!==null&&Ht(Ve,et.startTime-Ue),ft=!1}}break e}finally{B=null,V=Dt,G=!1}ft=void 0}}finally{ft?Rt():rt=!1}}}var Rt;if(typeof je=="function")Rt=function(){je(_t)};else if(typeof MessageChannel<"u"){var Ut=new MessageChannel,un=Ut.port2;Ut.port1.onmessage=_t,Rt=function(){un.postMessage(null)}}else Rt=function(){Ie(_t,0)};function Ht(Ue,ft){Je=Ie(function(){Ue(i.unstable_now())},ft)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ue){Ue.callback=null},i.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Mt=0<Ue?Math.floor(1e3/Ue):5},i.unstable_getCurrentPriorityLevel=function(){return V},i.unstable_next=function(Ue){switch(V){case 1:case 2:case 3:var ft=3;break;default:ft=V}var Dt=V;V=ft;try{return Ue()}finally{V=Dt}},i.unstable_requestPaint=function(){pe=!0},i.unstable_runWithPriority=function(Ue,ft){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var Dt=V;V=Ue;try{return ft()}finally{V=Dt}},i.unstable_scheduleCallback=function(Ue,ft,Dt){var It=i.unstable_now();switch(typeof Dt=="object"&&Dt!==null?(Dt=Dt.delay,Dt=typeof Dt=="number"&&0<Dt?It+Dt:It):Dt=It,Ue){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=Dt+be,Ue={id:z++,callback:ft,priorityLevel:Ue,startTime:Dt,expirationTime:be,sortIndex:-1},Dt>It?(Ue.sortIndex=Dt,n(R,Ue),l(C)===null&&Ue===l(R)&&(fe?(Ge(Je),Je=-1):fe=!0,Ht(Ve,Dt-It))):(Ue.sortIndex=be,n(C,Ue),re||G||(re=!0,rt||(rt=!0,Rt()))),Ue},i.unstable_shouldYield=Xe,i.unstable_wrapCallback=function(Ue){var ft=V;return function(){var Dt=V;V=ft;try{return Ue.apply(this,arguments)}finally{V=Dt}}}}(Hv)),Hv}var i1;function xE(){return i1||(i1=1,qv.exports=bE()),qv.exports}var Xv={exports:{}},_s={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function wE(){if(r1)return _s;r1=1;var i=rx();function n(C){var R="https://react.dev/errors/"+C;if(1<arguments.length){R+="?args[]="+encodeURIComponent(arguments[1]);for(var z=2;z<arguments.length;z++)R+="&args[]="+encodeURIComponent(arguments[z])}return"Minified React error #"+C+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var d={d:{f:l,r:function(){throw Error(n(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},m=Symbol.for("react.portal");function _(C,R,z){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m,key:B==null?null:""+B,children:C,containerInfo:R,implementation:z}}var v=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(C,R){if(C==="font")return"";if(typeof R=="string")return R==="use-credentials"?R:""}return _s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=d,_s.createPortal=function(C,R){var z=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!R||R.nodeType!==1&&R.nodeType!==9&&R.nodeType!==11)throw Error(n(299));return _(C,R,null,z)},_s.flushSync=function(C){var R=v.T,z=d.p;try{if(v.T=null,d.p=2,C)return C()}finally{v.T=R,d.p=z,d.d.f()}},_s.preconnect=function(C,R){typeof C=="string"&&(R?(R=R.crossOrigin,R=typeof R=="string"?R==="use-credentials"?R:"":void 0):R=null,d.d.C(C,R))},_s.prefetchDNS=function(C){typeof C=="string"&&d.d.D(C)},_s.preinit=function(C,R){if(typeof C=="string"&&R&&typeof R.as=="string"){var z=R.as,B=c(z,R.crossOrigin),V=typeof R.integrity=="string"?R.integrity:void 0,G=typeof R.fetchPriority=="string"?R.fetchPriority:void 0;z==="style"?d.d.S(C,typeof R.precedence=="string"?R.precedence:void 0,{crossOrigin:B,integrity:V,fetchPriority:G}):z==="script"&&d.d.X(C,{crossOrigin:B,integrity:V,fetchPriority:G,nonce:typeof R.nonce=="string"?R.nonce:void 0})}},_s.preinitModule=function(C,R){if(typeof C=="string")if(typeof R=="object"&&R!==null){if(R.as==null||R.as==="script"){var z=c(R.as,R.crossOrigin);d.d.M(C,{crossOrigin:z,integrity:typeof R.integrity=="string"?R.integrity:void 0,nonce:typeof R.nonce=="string"?R.nonce:void 0})}}else R==null&&d.d.M(C)},_s.preload=function(C,R){if(typeof C=="string"&&typeof R=="object"&&R!==null&&typeof R.as=="string"){var z=R.as,B=c(z,R.crossOrigin);d.d.L(C,z,{crossOrigin:B,integrity:typeof R.integrity=="string"?R.integrity:void 0,nonce:typeof R.nonce=="string"?R.nonce:void 0,type:typeof R.type=="string"?R.type:void 0,fetchPriority:typeof R.fetchPriority=="string"?R.fetchPriority:void 0,referrerPolicy:typeof R.referrerPolicy=="string"?R.referrerPolicy:void 0,imageSrcSet:typeof R.imageSrcSet=="string"?R.imageSrcSet:void 0,imageSizes:typeof R.imageSizes=="string"?R.imageSizes:void 0,media:typeof R.media=="string"?R.media:void 0})}},_s.preloadModule=function(C,R){if(typeof C=="string")if(R){var z=c(R.as,R.crossOrigin);d.d.m(C,{as:typeof R.as=="string"&&R.as!=="script"?R.as:void 0,crossOrigin:z,integrity:typeof R.integrity=="string"?R.integrity:void 0})}else d.d.m(C)},_s.requestFormReset=function(C){d.d.r(C)},_s.unstable_batchedUpdates=function(C,R){return C(R)},_s.useFormState=function(C,R,z){return v.H.useFormState(C,R,z)},_s.useFormStatus=function(){return v.H.useHostTransitionStatus()},_s.version="19.1.1",_s}var a1;function t2(){if(a1)return Xv.exports;a1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Xv.exports=wE(),Xv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1;function TE(){if(s1)return Ty;s1=1;var i=xE(),n=rx(),l=t2();function d(r){var u="https://react.dev/errors/"+r;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+r+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function _(r){var u=r,p=r;if(r.alternate)for(;u.return;)u=u.return;else{r=u;do u=r,(u.flags&4098)!==0&&(p=u.return),r=u.return;while(r)}return u.tag===3?p:null}function v(r){if(r.tag===13){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function c(r){if(_(r)!==r)throw Error(d(188))}function C(r){var u=r.alternate;if(!u){if(u=_(r),u===null)throw Error(d(188));return u!==r?null:r}for(var p=r,w=u;;){var M=p.return;if(M===null)break;var N=M.alternate;if(N===null){if(w=M.return,w!==null){p=w;continue}break}if(M.child===N.child){for(N=M.child;N;){if(N===p)return c(M),r;if(N===w)return c(M),u;N=N.sibling}throw Error(d(188))}if(p.return!==w.return)p=M,w=N;else{for(var q=!1,ie=M.child;ie;){if(ie===p){q=!0,p=M,w=N;break}if(ie===w){q=!0,w=M,p=N;break}ie=ie.sibling}if(!q){for(ie=N.child;ie;){if(ie===p){q=!0,p=N,w=M;break}if(ie===w){q=!0,w=N,p=M;break}ie=ie.sibling}if(!q)throw Error(d(189))}}if(p.alternate!==w)throw Error(d(190))}if(p.tag!==3)throw Error(d(188));return p.stateNode.current===p?r:u}function R(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r;for(r=r.child;r!==null;){if(u=R(r),u!==null)return u;r=r.sibling}return null}var z=Object.assign,B=Symbol.for("react.element"),V=Symbol.for("react.transitional.element"),G=Symbol.for("react.portal"),re=Symbol.for("react.fragment"),fe=Symbol.for("react.strict_mode"),pe=Symbol.for("react.profiler"),Ie=Symbol.for("react.provider"),Ge=Symbol.for("react.consumer"),je=Symbol.for("react.context"),He=Symbol.for("react.forward_ref"),Ve=Symbol.for("react.suspense"),rt=Symbol.for("react.suspense_list"),Je=Symbol.for("react.memo"),Mt=Symbol.for("react.lazy"),Ne=Symbol.for("react.activity"),Xe=Symbol.for("react.memo_cache_sentinel"),_t=Symbol.iterator;function Rt(r){return r===null||typeof r!="object"?null:(r=_t&&r[_t]||r["@@iterator"],typeof r=="function"?r:null)}var Ut=Symbol.for("react.client.reference");function un(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Ut?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case re:return"Fragment";case pe:return"Profiler";case fe:return"StrictMode";case Ve:return"Suspense";case rt:return"SuspenseList";case Ne:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case G:return"Portal";case je:return(r.displayName||"Context")+".Provider";case Ge:return(r._context.displayName||"Context")+".Consumer";case He:var u=r.render;return r=r.displayName,r||(r=u.displayName||u.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Je:return u=r.displayName||null,u!==null?u:un(r.type)||"Memo";case Mt:u=r._payload,r=r._init;try{return un(r(u))}catch{}}return null}var Ht=Array.isArray,Ue=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ft=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Dt={pending:!1,data:null,method:null,action:null},It=[],be=-1;function et(r){return{current:r}}function Et(r){0>be||(r.current=It[be],It[be]=null,be--)}function bt(r,u){be++,It[be]=r.current,r.current=u}var Pt=et(null),Xt=et(null),Bt=et(null),wi=et(null);function fn(r,u){switch(bt(Bt,u),bt(Xt,r),bt(Pt,null),u.nodeType){case 9:case 11:r=(r=u.documentElement)&&(r=r.namespaceURI)?Qd(r):0;break;default:if(r=u.tagName,u=u.namespaceURI)u=Qd(u),r=vu(u,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Et(Pt),bt(Pt,r)}function mi(){Et(Pt),Et(Xt),Et(Bt)}function ya(r){r.memoizedState!==null&&bt(wi,r);var u=Pt.current,p=vu(u,r.type);u!==p&&(bt(Xt,r),bt(Pt,p))}function sa(r){Xt.current===r&&(Et(Pt),Et(Xt)),wi.current===r&&(Et(wi),$._currentValue=Dt)}var rr=Object.prototype.hasOwnProperty,Yn=i.unstable_scheduleCallback,Wn=i.unstable_cancelCallback,Nn=i.unstable_shouldYield,Br=i.unstable_requestPaint,Li=i.unstable_now,Ka=i.unstable_getCurrentPriorityLevel,ka=i.unstable_ImmediatePriority,oa=i.unstable_UserBlockingPriority,Fr=i.unstable_NormalPriority,ws=i.unstable_LowPriority,Ja=i.unstable_IdlePriority,Ts=i.log,Ss=i.unstable_setDisableYieldValue,la=null,Oi=null;function Ur(r){if(typeof Ts=="function"&&Ss(r),Oi&&typeof Oi.setStrictMode=="function")try{Oi.setStrictMode(la,r)}catch{}}var Ae=Math.clz32?Math.clz32:ae,K=Math.log,J=Math.LN2;function ae(r){return r>>>=0,r===0?32:31-(K(r)/J|0)|0}var _e=256,Te=4194304;function Me(r){var u=r&42;if(u!==0)return u;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Fe(r,u,p){var w=r.pendingLanes;if(w===0)return 0;var M=0,N=r.suspendedLanes,q=r.pingedLanes;r=r.warmLanes;var ie=w&134217727;return ie!==0?(w=ie&~N,w!==0?M=Me(w):(q&=ie,q!==0?M=Me(q):p||(p=ie&~r,p!==0&&(M=Me(p))))):(ie=w&~N,ie!==0?M=Me(ie):q!==0?M=Me(q):p||(p=w&~r,p!==0&&(M=Me(p)))),M===0?0:u!==0&&u!==M&&(u&N)===0&&(N=M&-M,p=u&-u,N>=p||N===32&&(p&4194048)!==0)?u:M}function Re(r,u){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&u)===0}function tt(r,u){switch(r){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ht(){var r=_e;return _e<<=1,(_e&4194048)===0&&(_e=256),r}function at(){var r=Te;return Te<<=1,(Te&62914560)===0&&(Te=4194304),r}function Lt(r){for(var u=[],p=0;31>p;p++)u.push(r);return u}function Pe(r,u){r.pendingLanes|=u,u!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function en(r,u,p,w,M,N){var q=r.pendingLanes;r.pendingLanes=p,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=p,r.entangledLanes&=p,r.errorRecoveryDisabledLanes&=p,r.shellSuspendCounter=0;var ie=r.entanglements,we=r.expirationTimes,Ze=r.hiddenUpdates;for(p=q&~p;0<p;){var st=31-Ae(p),ut=1<<st;ie[st]=0,we[st]=-1;var We=Ze[st];if(We!==null)for(Ze[st]=null,st=0;st<We.length;st++){var Ke=We[st];Ke!==null&&(Ke.lane&=-536870913)}p&=~ut}w!==0&&vn(r,w,0),N!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=N&~(q&~u))}function vn(r,u,p){r.pendingLanes|=u,r.suspendedLanes&=~u;var w=31-Ae(u);r.entangledLanes|=u,r.entanglements[w]=r.entanglements[w]|1073741824|p&4194090}function Vt(r,u){var p=r.entangledLanes|=u;for(r=r.entanglements;p;){var w=31-Ae(p),M=1<<w;M&u|r[w]&u&&(r[w]|=u),p&=~M}}function sn(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ni(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ar(){var r=ft.p;return r!==0?r:(r=window.event,r===void 0?32:jt(r.type))}function dr(r,u){var p=ft.p;try{return ft.p=r,u()}finally{ft.p=p}}var ai=Math.random().toString(36).slice(2),Wt="__reactFiber$"+ai,tn="__reactProps$"+ai,Ti="__reactContainer$"+ai,gt="__reactEvents$"+ai,Vr="__reactListeners$"+ai,ji="__reactHandles$"+ai,Ro="__reactResources$"+ai,io="__reactMarker$"+ai;function St(r){delete r[Wt],delete r[tn],delete r[gt],delete r[Vr],delete r[ji]}function hn(r){var u=r[Wt];if(u)return u;for(var p=r.parentNode;p;){if(u=p[Ti]||p[Wt]){if(p=u.alternate,u.child!==null||p!==null&&p.child!==null)for(r=ep(r);r!==null;){if(p=r[Wt])return p;r=ep(r)}return u}r=p,p=r.parentNode}return null}function an(r){if(r=r[Wt]||r[Ti]){var u=r.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return r}return null}function Xi(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r.stateNode;throw Error(d(33))}function es(r){var u=r[Ro];return u||(u=r[Ro]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Si(r){r[io]=!0}var dn=new Set,Vu={};function _a(r,u){Io(r,u),Io(r+"Capture",u)}function Io(r,u){for(Vu[r]=u,r=0;r<u.length;r++)dn.add(u[r])}var ro=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fl={},Bi={};function cd(r){return rr.call(Bi,r)?!0:rr.call(Fl,r)?!1:ro.test(r)?Bi[r]=!0:(Fl[r]=!0,!1)}function kr(r,u,p){if(cd(u))if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":r.removeAttribute(u);return;case"boolean":var w=u.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){r.removeAttribute(u);return}}r.setAttribute(u,""+p)}}function qn(r,u,p){if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttribute(u,""+p)}}function ao(r,u,p,w){if(w===null)r.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(p);return}r.setAttributeNS(u,p,""+w)}}var Ul,ud;function Ra(r){if(Ul===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Ul=u&&u[1]||"",ud=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ul+r+ud}var so=!1;function Gu(r,u){if(!r||so)return"";so=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(u){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Ke){var We=Ke}Reflect.construct(r,[],ut)}else{try{ut.call()}catch(Ke){We=Ke}r.call(ut.prototype)}}else{try{throw Error()}catch(Ke){We=Ke}(ut=r())&&typeof ut.catch=="function"&&ut.catch(function(){})}}catch(Ke){if(Ke&&We&&typeof Ke.stack=="string")return[Ke.stack,We.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=w.DetermineComponentFrameRoot(),q=N[0],ie=N[1];if(q&&ie){var we=q.split(`
`),Ze=ie.split(`
`);for(M=w=0;w<we.length&&!we[w].includes("DetermineComponentFrameRoot");)w++;for(;M<Ze.length&&!Ze[M].includes("DetermineComponentFrameRoot");)M++;if(w===we.length||M===Ze.length)for(w=we.length-1,M=Ze.length-1;1<=w&&0<=M&&we[w]!==Ze[M];)M--;for(;1<=w&&0<=M;w--,M--)if(we[w]!==Ze[M]){if(w!==1||M!==1)do if(w--,M--,0>M||we[w]!==Ze[M]){var st=`
`+we[w].replace(" at new "," at ");return r.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",r.displayName)),st}while(1<=w&&0<=M);break}}}finally{so=!1,Error.prepareStackTrace=p}return(p=r?r.displayName||r.name:"")?Ra(p):""}function Rp(r){switch(r.tag){case 26:case 27:case 5:return Ra(r.type);case 16:return Ra("Lazy");case 13:return Ra("Suspense");case 19:return Ra("SuspenseList");case 0:case 15:return Gu(r.type,!1);case 11:return Gu(r.type.render,!1);case 1:return Gu(r.type,!0);case 31:return Ra("Activity");default:return""}}function _f(r){try{var u="";do u+=Rp(r),r=r.return;while(r);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Rr(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function vf(r){var u=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Ag(r){var u=vf(r)?"checked":"value",p=Object.getOwnPropertyDescriptor(r.constructor.prototype,u),w=""+r[u];if(!r.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var M=p.get,N=p.set;return Object.defineProperty(r,u,{configurable:!0,get:function(){return M.call(this)},set:function(q){w=""+q,N.call(this,q)}}),Object.defineProperty(r,u,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(q){w=""+q},stopTracking:function(){r._valueTracker=null,delete r[u]}}}}function hd(r){r._valueTracker||(r._valueTracker=Ag(r))}function Ip(r){if(!r)return!1;var u=r._valueTracker;if(!u)return!0;var p=u.getValue(),w="";return r&&(w=vf(r)?r.checked?"true":"false":r.value),r=w,r!==p?(u.setValue(r),!0):!1}function zc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Lc=/[\n"\\]/g;function va(r){return r.replace(Lc,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function Zu(r,u,p,w,M,N,q,ie){r.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?r.type=q:r.removeAttribute("type"),u!=null?q==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+Rr(u)):r.value!==""+Rr(u)&&(r.value=""+Rr(u)):q!=="submit"&&q!=="reset"||r.removeAttribute("value"),u!=null?$u(r,q,Rr(u)):p!=null?$u(r,q,Rr(p)):w!=null&&r.removeAttribute("value"),M==null&&N!=null&&(r.defaultChecked=!!N),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?r.name=""+Rr(ie):r.removeAttribute("name")}function Vl(r,u,p,w,M,N,q,ie){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(r.type=N),u!=null||p!=null){if(!(N!=="submit"&&N!=="reset"||u!=null))return;p=p!=null?""+Rr(p):"",u=u!=null?""+Rr(u):p,ie||u===r.value||(r.value=u),r.defaultValue=u}w=w??M,w=typeof w!="function"&&typeof w!="symbol"&&!!w,r.checked=ie?r.checked:!!w,r.defaultChecked=!!w,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(r.name=q)}function $u(r,u,p){u==="number"&&zc(r.ownerDocument)===r||r.defaultValue===""+p||(r.defaultValue=""+p)}function ol(r,u,p,w){if(r=r.options,u){u={};for(var M=0;M<p.length;M++)u["$"+p[M]]=!0;for(p=0;p<r.length;p++)M=u.hasOwnProperty("$"+r[p].value),r[p].selected!==M&&(r[p].selected=M),M&&w&&(r[p].defaultSelected=!0)}else{for(p=""+Rr(p),u=null,M=0;M<r.length;M++){if(r[M].value===p){r[M].selected=!0,w&&(r[M].defaultSelected=!0);return}u!==null||r[M].disabled||(u=r[M])}u!==null&&(u.selected=!0)}}function Pp(r,u,p){if(u!=null&&(u=""+Rr(u),u!==r.value&&(r.value=u),p==null)){r.defaultValue!==u&&(r.defaultValue=u);return}r.defaultValue=p!=null?""+Rr(p):""}function Gl(r,u,p,w){if(u==null){if(w!=null){if(p!=null)throw Error(d(92));if(Ht(w)){if(1<w.length)throw Error(d(93));w=w[0]}p=w}p==null&&(p=""),u=p}p=Rr(u),r.defaultValue=p,w=r.textContent,w===p&&w!==""&&w!==null&&(r.value=w)}function oo(r,u){if(u){var p=r.firstChild;if(p&&p===r.lastChild&&p.nodeType===3){p.nodeValue=u;return}}r.textContent=u}var Es=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bn(r,u,p){var w=u.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?w?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="":w?r.setProperty(u,p):typeof p!="number"||p===0||Es.has(u)?u==="float"?r.cssFloat=p:r[u]=(""+p).trim():r[u]=p+"px"}function ll(r,u,p){if(u!=null&&typeof u!="object")throw Error(d(62));if(r=r.style,p!=null){for(var w in p)!p.hasOwnProperty(w)||u!=null&&u.hasOwnProperty(w)||(w.indexOf("--")===0?r.setProperty(w,""):w==="float"?r.cssFloat="":r[w]="");for(var M in u)w=u[M],u.hasOwnProperty(M)&&p[M]!==w&&bn(r,M,w)}else for(var N in u)u.hasOwnProperty(N)&&bn(r,N,u[N])}function lo(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Po=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gn(r){return Zl.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var No=null;function Oc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var zo=null,sr=null;function fr(r){var u=an(r);if(u&&(r=u.stateNode)){var p=r[tn]||null;e:switch(r=u.stateNode,u.type){case"input":if(Zu(r,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),u=p.name,p.type==="radio"&&u!=null){for(p=r;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+va(""+u)+'"][type="radio"]'),u=0;u<p.length;u++){var w=p[u];if(w!==r&&w.form===r.form){var M=w[tn]||null;if(!M)throw Error(d(90));Zu(w,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(u=0;u<p.length;u++)w=p[u],w.form===r.form&&Ip(w)}break e;case"textarea":Pp(r,p.value,p.defaultValue);break e;case"select":u=p.value,u!=null&&ol(r,!!p.multiple,u,!1)}}}var Ir=!1;function Wi(r,u,p){if(Ir)return r(u,p);Ir=!0;try{var w=r(u);return w}finally{if(Ir=!1,(zo!==null||sr!==null)&&(ym(),zo&&(u=zo,r=sr,sr=zo=null,fr(u),r)))for(u=0;u<r.length;u++)fr(r[u])}}function Vn(r,u){var p=r.stateNode;if(p===null)return null;var w=p[tn]||null;if(w===null)return null;p=w[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(r=r.type,w=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!w;break e;default:r=!1}if(r)return null;if(p&&typeof p!="function")throw Error(d(231,u,typeof p));return p}var co=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pr=!1;if(co)try{var Nr={};Object.defineProperty(Nr,"passive",{get:function(){Pr=!0}}),window.addEventListener("test",Nr,Nr),window.removeEventListener("test",Nr,Nr)}catch{Pr=!1}var Fi=null,si=null,uo=null;function qt(){if(uo)return uo;var r,u=si,p=u.length,w,M="value"in Fi?Fi.value:Fi.textContent,N=M.length;for(r=0;r<p&&u[r]===M[r];r++);var q=p-r;for(w=1;w<=q&&u[p-w]===M[N-w];w++);return uo=M.slice(r,1<w?1-w:void 0)}function nn(r){var u=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&u===13&&(r=13)):r=u,r===10&&(r=13),32<=r||r===13?r:0}function ts(){return!0}function Mn(){return!1}function gi(r){function u(p,w,M,N,q){this._reactName=p,this._targetInst=M,this.type=w,this.nativeEvent=N,this.target=q,this.currentTarget=null;for(var ie in r)r.hasOwnProperty(ie)&&(p=r[ie],this[ie]=p?p(N):N[ie]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?ts:Mn,this.isPropagationStopped=Mn,this}return z(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=ts)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=ts)},persist:function(){},isPersistent:ts}),u}var Gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ia=gi(Gr),cl=z({},Gr,{view:0,detail:0}),bf=gi(cl),ul,$l,hl,Yl=z({},cl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xl,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==hl&&(hl&&r.type==="mousemove"?(ul=r.screenX-hl.screenX,$l=r.screenY-hl.screenY):$l=ul=0,hl=r),ul)},movementY:function(r){return"movementY"in r?r.movementY:$l}}),Yu=gi(Yl),As=z({},Yl,{dataTransfer:0}),Tr=gi(As),jc=z({},cl,{relatedTarget:0}),ql=gi(jc),Hl=z({},Gr,{animationName:0,elapsedTime:0,pseudoElement:0}),Zi=gi(Hl),Np=z({},Gr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),qu=gi(Np),xf=z({},Gr,{data:0}),zp=gi(xf),Bc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ho(r){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(r):(r=Hu[r])?!!u[r]:!1}function Xl(){return ho}var Xu=z({},cl,{key:function(r){if(r.key){var u=Bc[r.key]||r.key;if(u!=="Unidentified")return u}return r.type==="keypress"?(r=nn(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?zr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xl,charCode:function(r){return r.type==="keypress"?nn(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?nn(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Wu=gi(Xu),Zr=z({},Yl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wf=gi(Zr),dd=z({},cl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xl}),Mg=gi(dd),Tf=z({},Gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cg=gi(Tf),Dg=z({},Yl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),fd=gi(Dg),Sf=z({},Gr,{newState:0,oldState:0}),Wl=gi(Sf),Ef=[9,13,27,32],Fc=co&&"CompositionEvent"in window,ca=null;co&&"documentMode"in document&&(ca=document.documentMode);var kg=co&&"TextEvent"in window&&!ca,Qu=co&&(!Fc||ca&&8<ca&&11>=ca),Uc=" ",Vc=!1;function Lp(r,u){switch(r){case"keyup":return Ef.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ku(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Gc=!1;function Ql(r,u){switch(r){case"compositionend":return Ku(u);case"keypress":return u.which!==32?null:(Vc=!0,Uc);case"textInput":return r=u.data,r===Uc&&Vc?null:r;default:return null}}function Op(r,u){if(Gc)return r==="compositionend"||!Fc&&Lp(r,u)?(r=qt(),uo=si=Fi=null,Gc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Qu&&u.locale!=="ko"?null:u.data;default:return null}}var Af={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jp(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u==="input"?!!Af[r.type]:u==="textarea"}function Mf(r,u,p,w){zo?sr?sr.push(w):sr=[w]:zo=w,u=Xd(u,"onChange"),0<u.length&&(p=new Ia("onChange","change",null,p,w),r.push({event:p,listeners:u}))}var Kl=null,Zc=null;function pd(r){h0(r,0)}function Ju(r){var u=Xi(r);if(Ip(u))return r}function Cf(r,u){if(r==="change")return u}var dl=!1;if(co){var eh;if(co){var th="oninput"in document;if(!th){var $c=document.createElement("div");$c.setAttribute("oninput","return;"),th=typeof $c.oninput=="function"}eh=th}else eh=!1;dl=eh&&(!document.documentMode||9<document.documentMode)}function Bp(){Kl&&(Kl.detachEvent("onpropertychange",Yc),Zc=Kl=null)}function Yc(r){if(r.propertyName==="value"&&Ju(Zc)){var u=[];Mf(u,Zc,r,Oc(r)),Wi(pd,u)}}function Fp(r,u,p){r==="focusin"?(Bp(),Kl=u,Zc=p,Kl.attachEvent("onpropertychange",Yc)):r==="focusout"&&Bp()}function Rg(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ju(Zc)}function Up(r,u){if(r==="click")return Ju(u)}function Vp(r,u){if(r==="input"||r==="change")return Ju(u)}function Df(r,u){return r===u&&(r!==0||1/r===1/u)||r!==r&&u!==u}var ua=typeof Object.is=="function"?Object.is:Df;function qc(r,u){if(ua(r,u))return!0;if(typeof r!="object"||r===null||typeof u!="object"||u===null)return!1;var p=Object.keys(r),w=Object.keys(u);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var M=p[w];if(!rr.call(u,M)||!ua(r[M],u[M]))return!1}return!0}function nh(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function fo(r,u){var p=nh(r);r=0;for(var w;p;){if(p.nodeType===3){if(w=r+p.textContent.length,r<=u&&w>=u)return{node:p,offset:u-r};r=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=nh(p)}}function zn(r,u){return r&&u?r===u?!0:r&&r.nodeType===3?!1:u&&u.nodeType===3?zn(r,u.parentNode):"contains"in r?r.contains(u):r.compareDocumentPosition?!!(r.compareDocumentPosition(u)&16):!1:!1}function md(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var u=zc(r.document);u instanceof r.HTMLIFrameElement;){try{var p=typeof u.contentWindow.location.href=="string"}catch{p=!1}if(p)r=u.contentWindow;else break;u=zc(r.document)}return u}function ih(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u&&(u==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||u==="textarea"||r.contentEditable==="true")}var Gp=co&&"documentMode"in document&&11>=document.documentMode,fl=null,Lo=null,Jl=null,kf=!1;function Zp(r,u,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;kf||fl==null||fl!==zc(w)||(w=fl,"selectionStart"in w&&ih(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Jl&&qc(Jl,w)||(Jl=w,w=Xd(Lo,"onSelect"),0<w.length&&(u=new Ia("onSelect","select",null,u,p),r.push({event:u,listeners:w}),u.target=fl)))}function ec(r,u){var p={};return p[r.toLowerCase()]=u.toLowerCase(),p["Webkit"+r]="webkit"+u,p["Moz"+r]="moz"+u,p}var Hc={animationend:ec("Animation","AnimationEnd"),animationiteration:ec("Animation","AnimationIteration"),animationstart:ec("Animation","AnimationStart"),transitionrun:ec("Transition","TransitionRun"),transitionstart:ec("Transition","TransitionStart"),transitioncancel:ec("Transition","TransitionCancel"),transitionend:ec("Transition","TransitionEnd")},gd={},$p={};co&&($p=document.createElement("div").style,"AnimationEvent"in window||(delete Hc.animationend.animation,delete Hc.animationiteration.animation,delete Hc.animationstart.animation),"TransitionEvent"in window||delete Hc.transitionend.transition);function pl(r){if(gd[r])return gd[r];if(!Hc[r])return r;var u=Hc[r],p;for(p in u)if(u.hasOwnProperty(p)&&p in $p)return gd[r]=u[p];return r}var rh=pl("animationend"),ah=pl("animationiteration"),sh=pl("animationstart"),Rf=pl("transitionrun"),tc=pl("transitionstart"),oh=pl("transitioncancel"),nc=pl("transitionend"),Pa=new Map,yd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");yd.push("scrollEnd");function ns(r,u){Pa.set(r,u),_a(u,[r])}var _d=new WeakMap;function Sr(r,u){if(typeof r=="object"&&r!==null){var p=_d.get(r);return p!==void 0?p:(u={value:r,source:u,stack:_f(u)},_d.set(r,u),u)}return{value:r,source:u,stack:_f(u)}}var ha=[],Oo=0,ic=0;function rc(){for(var r=Oo,u=ic=Oo=0;u<r;){var p=ha[u];ha[u++]=null;var w=ha[u];ha[u++]=null;var M=ha[u];ha[u++]=null;var N=ha[u];if(ha[u++]=null,w!==null&&M!==null){var q=w.pending;q===null?M.next=M:(M.next=q.next,q.next=M),w.pending=M}N!==0&&If(p,M,N)}}function lh(r,u,p,w){ha[Oo++]=r,ha[Oo++]=u,ha[Oo++]=p,ha[Oo++]=w,ic|=w,r.lanes|=w,r=r.alternate,r!==null&&(r.lanes|=w)}function ml(r,u,p,w){return lh(r,u,p,w),Xc(r)}function Na(r,u){return lh(r,null,null,u),Xc(r)}function If(r,u,p){r.lanes|=p;var w=r.alternate;w!==null&&(w.lanes|=p);for(var M=!1,N=r.return;N!==null;)N.childLanes|=p,w=N.alternate,w!==null&&(w.childLanes|=p),N.tag===22&&(r=N.stateNode,r===null||r._visibility&1||(M=!0)),r=N,N=N.return;return r.tag===3?(N=r.stateNode,M&&u!==null&&(M=31-Ae(p),r=N.hiddenUpdates,w=r[M],w===null?r[M]=[u]:w.push(u),u.lane=p|536870912),N):null}function Xc(r){if(50<Hf)throw Hf=0,Ph=null,Error(d(185));for(var u=r.return;u!==null;)r=u,u=r.return;return r.tag===3?r.stateNode:null}var pn={};function ch(r,u,p,w){this.tag=r,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function za(r,u,p,w){return new ch(r,u,p,w)}function vd(r){return r=r.prototype,!(!r||!r.isReactComponent)}function $r(r,u){var p=r.alternate;return p===null?(p=za(r.tag,u,r.key,r.mode),p.elementType=r.elementType,p.type=r.type,p.stateNode=r.stateNode,p.alternate=r,r.alternate=p):(p.pendingProps=u,p.type=r.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=r.flags&65011712,p.childLanes=r.childLanes,p.lanes=r.lanes,p.child=r.child,p.memoizedProps=r.memoizedProps,p.memoizedState=r.memoizedState,p.updateQueue=r.updateQueue,u=r.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=r.sibling,p.index=r.index,p.ref=r.ref,p.refCleanup=r.refCleanup,p}function Pf(r,u){r.flags&=65011714;var p=r.alternate;return p===null?(r.childLanes=0,r.lanes=u,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=p.childLanes,r.lanes=p.lanes,r.child=p.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=p.memoizedProps,r.memoizedState=p.memoizedState,r.updateQueue=p.updateQueue,r.type=p.type,u=p.dependencies,r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),r}function bd(r,u,p,w,M,N){var q=0;if(w=r,typeof r=="function")vd(r)&&(q=1);else if(typeof r=="string")q=a(r,p,Pt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Ne:return r=za(31,p,u,M),r.elementType=Ne,r.lanes=N,r;case re:return gl(p.children,M,N,u);case fe:q=8,M|=24;break;case pe:return r=za(12,p,u,M|2),r.elementType=pe,r.lanes=N,r;case Ve:return r=za(13,p,u,M),r.elementType=Ve,r.lanes=N,r;case rt:return r=za(19,p,u,M),r.elementType=rt,r.lanes=N,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Ie:case je:q=10;break e;case Ge:q=9;break e;case He:q=11;break e;case Je:q=14;break e;case Mt:q=16,w=null;break e}q=29,p=Error(d(130,r===null?"null":typeof r,"")),w=null}return u=za(q,p,u,M),u.elementType=r,u.type=w,u.lanes=N,u}function gl(r,u,p,w){return r=za(7,r,w,u),r.lanes=p,r}function Nf(r,u,p){return r=za(6,r,null,u),r.lanes=p,r}function uh(r,u,p){return u=za(4,r.children!==null?r.children:[],r.key,u),u.lanes=p,u.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},u}var jo=[],po=0,yl=null,Wc=0,La=[],Yr=0,Ms=null,Oa=1,is="";function Bo(r,u){jo[po++]=Wc,jo[po++]=yl,yl=r,Wc=u}function _l(r,u,p){La[Yr++]=Oa,La[Yr++]=is,La[Yr++]=Ms,Ms=r;var w=Oa;r=is;var M=32-Ae(w)-1;w&=~(1<<M),p+=1;var N=32-Ae(u)+M;if(30<N){var q=M-M%5;N=(w&(1<<q)-1).toString(32),w>>=q,M-=q,Oa=1<<32-Ae(u)+M|p<<M|w,is=N+r}else Oa=1<<N|p<<M|w,is=r}function hh(r){r.return!==null&&(Bo(r,1),_l(r,1,0))}function Qc(r){for(;r===yl;)yl=jo[--po],jo[po]=null,Wc=jo[--po],jo[po]=null;for(;r===Ms;)Ms=La[--Yr],La[Yr]=null,is=La[--Yr],La[Yr]=null,Oa=La[--Yr],La[Yr]=null}var Qi=null,Ri=null,Gn=!1,vl=null,ja=!1,dh=Error(d(519));function ac(r){var u=Error(d(418,""));throw Fo(Sr(u,r)),dh}function xd(r){var u=r.stateNode,p=r.type,w=r.memoizedProps;switch(u[Wt]=r,u[tn]=w,p){case"dialog":On("cancel",u),On("close",u);break;case"iframe":case"object":case"embed":On("load",u);break;case"video":case"audio":for(p=0;p<_u.length;p++)On(_u[p],u);break;case"source":On("error",u);break;case"img":case"image":case"link":On("error",u),On("load",u);break;case"details":On("toggle",u);break;case"input":On("invalid",u),Vl(u,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0),hd(u);break;case"select":On("invalid",u);break;case"textarea":On("invalid",u),Gl(u,w.value,w.defaultValue,w.children),hd(u)}p=w.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||u.textContent===""+p||w.suppressHydrationWarning===!0||fy(u.textContent,p)?(w.popover!=null&&(On("beforetoggle",u),On("toggle",u)),w.onScroll!=null&&On("scroll",u),w.onScrollEnd!=null&&On("scrollend",u),w.onClick!=null&&(u.onclick=Wd),u=!0):u=!1,u||ac(r)}function Ii(r){for(Qi=r.return;Qi;)switch(Qi.tag){case 5:case 13:ja=!1;return;case 27:case 3:ja=!0;return;default:Qi=Qi.return}}function ba(r){if(r!==Qi)return!1;if(!Gn)return Ii(r),Gn=!0,!1;var u=r.tag,p;if((p=u!==3&&u!==27)&&((p=u===5)&&(p=r.type,p=!(p!=="form"&&p!=="button")||Rm(r.type,r.memoizedProps)),p=!p),p&&Ri&&ac(r),Ii(r),u===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(d(317));e:{for(r=r.nextSibling,u=0;r;){if(r.nodeType===8)if(p=r.data,p==="/$"){if(u===0){Ri=ms(r.nextSibling);break e}u--}else p!=="$"&&p!=="$!"&&p!=="$?"||u++;r=r.nextSibling}Ri=null}}else u===27?(u=Ri,Sc(r.type)?(r=zm,zm=null,Ri=r):Ri=u):Ri=Qi?ms(r.stateNode.nextSibling):null;return!0}function qr(){Ri=Qi=null,Gn=!1}function fh(){var r=vl;return r!==null&&(Ea===null?Ea=r:Ea.push.apply(Ea,r),vl=null),r}function Fo(r){vl===null?vl=[r]:vl.push(r)}var wd=et(null),Ba=null,rs=null;function Hr(r,u,p){bt(wd,u._currentValue),u._currentValue=p}function Cs(r){r._currentValue=wd.current,Et(wd)}function Td(r,u,p){for(;r!==null;){var w=r.alternate;if((r.childLanes&u)!==u?(r.childLanes|=u,w!==null&&(w.childLanes|=u)):w!==null&&(w.childLanes&u)!==u&&(w.childLanes|=u),r===p)break;r=r.return}}function Sd(r,u,p,w){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var N=M.dependencies;if(N!==null){var q=M.child;N=N.firstContext;e:for(;N!==null;){var ie=N;N=M;for(var we=0;we<u.length;we++)if(ie.context===u[we]){N.lanes|=p,ie=N.alternate,ie!==null&&(ie.lanes|=p),Td(N.return,p,r),w||(q=null);break e}N=ie.next}}else if(M.tag===18){if(q=M.return,q===null)throw Error(d(341));q.lanes|=p,N=q.alternate,N!==null&&(N.lanes|=p),Td(q,p,r),q=null}else q=M.child;if(q!==null)q.return=M;else for(q=M;q!==null;){if(q===r){q=null;break}if(M=q.sibling,M!==null){M.return=q.return,q=M;break}q=q.return}M=q}}function Kc(r,u,p,w){r=null;for(var M=u,N=!1;M!==null;){if(!N){if((M.flags&524288)!==0)N=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var q=M.alternate;if(q===null)throw Error(d(387));if(q=q.memoizedProps,q!==null){var ie=M.type;ua(M.pendingProps.value,q.value)||(r!==null?r.push(ie):r=[ie])}}else if(M===wi.current){if(q=M.alternate,q===null)throw Error(d(387));q.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push($):r=[$])}M=M.return}r!==null&&Sd(u,r,p,w),u.flags|=262144}function ph(r){for(r=r.firstContext;r!==null;){if(!ua(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function bl(r){Ba=r,rs=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function yi(r){return da(Ba,r)}function Uo(r,u){return Ba===null&&bl(r),da(r,u)}function da(r,u){var p=u._currentValue;if(u={context:u,memoizedValue:p,next:null},rs===null){if(r===null)throw Error(d(308));rs=u,r.dependencies={lanes:0,firstContext:u},r.flags|=524288}else rs=rs.next=u;return p}var Jc=typeof AbortController<"u"?AbortController:function(){var r=[],u=this.signal={aborted:!1,addEventListener:function(p,w){r.push(w)}};this.abort=function(){u.aborted=!0,r.forEach(function(p){return p()})}},zf=i.unstable_scheduleCallback,Yp=i.unstable_NormalPriority,or={$$typeof:je,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xl(){return{controller:new Jc,data:new Map,refCount:0}}function sc(r){r.refCount--,r.refCount===0&&zf(Yp,function(){r.controller.abort()})}var mo=null,Ed=0,pr=0,Xr=null;function eu(r,u){if(mo===null){var p=mo=[];Ed=0,pr=oy(),Xr={status:"pending",value:void 0,then:function(w){p.push(w)}}}return Ed++,u.then(as,as),u}function as(){if(--Ed===0&&mo!==null){Xr!==null&&(Xr.status="fulfilled");var r=mo;mo=null,pr=0,Xr=null;for(var u=0;u<r.length;u++)(0,r[u])()}}function tu(r,u){var p=[],w={status:"pending",value:null,reason:null,then:function(M){p.push(M)}};return r.then(function(){w.status="fulfilled",w.value=u;for(var M=0;M<p.length;M++)(0,p[M])(u)},function(M){for(w.status="rejected",w.reason=M,M=0;M<p.length;M++)(0,p[M])(void 0)}),w}var qp=Ue.S;Ue.S=function(r,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&eu(r,u),qp!==null&&qp(r,u)};var Ds=et(null);function Lf(){var r=Ds.current;return r!==null?r:li.pooledCache}function Ad(r,u){u===null?bt(Ds,Ds.current):bt(Ds,u.pool)}function nu(){var r=Lf();return r===null?null:{parent:or._currentValue,pool:r}}var Vo=Error(d(460)),ss=Error(d(474)),Ct=Error(d(542)),mh={then:function(){}};function gh(r){return r=r.status,r==="fulfilled"||r==="rejected"}function iu(){}function oc(r,u,p){switch(p=r[p],p===void 0?r.push(u):p!==u&&(u.then(iu,iu),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,Sn(r),r;default:if(typeof u.status=="string")u.then(iu,iu);else{if(r=li,r!==null&&100<r.shellSuspendCounter)throw Error(d(482));r=u,r.status="pending",r.then(function(w){if(u.status==="pending"){var M=u;M.status="fulfilled",M.value=w}},function(w){if(u.status==="pending"){var M=u;M.status="rejected",M.reason=w}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,Sn(r),r}throw ks=u,Vo}}var ks=null;function yh(){if(ks===null)throw Error(d(459));var r=ks;return ks=null,r}function Sn(r){if(r===Vo||r===Ct)throw Error(d(483))}var Rs=!1;function Of(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ru(r,u){r=r.updateQueue,u.updateQueue===r&&(u.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function wl(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Go(r,u,p){var w=r.updateQueue;if(w===null)return null;if(w=w.shared,(ii&2)!==0){var M=w.pending;return M===null?u.next=u:(u.next=M.next,M.next=u),w.pending=u,u=Xc(r),If(r,null,p),u}return lh(r,w,u,p),Xc(r)}function lc(r,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var w=u.lanes;w&=r.pendingLanes,p|=w,u.lanes=p,Vt(r,p)}}function _h(r,u){var p=r.updateQueue,w=r.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var M=null,N=null;if(p=p.firstBaseUpdate,p!==null){do{var q={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};N===null?M=N=q:N=N.next=q,p=p.next}while(p!==null);N===null?M=N=u:N=N.next=u}else M=N=u;p={baseState:w.baseState,firstBaseUpdate:M,lastBaseUpdate:N,shared:w.shared,callbacks:w.callbacks},r.updateQueue=p;return}r=p.lastBaseUpdate,r===null?p.firstBaseUpdate=u:r.next=u,p.lastBaseUpdate=u}var Md=!1;function au(){if(Md){var r=Xr;if(r!==null)throw r}}function cc(r,u,p,w){Md=!1;var M=r.updateQueue;Rs=!1;var N=M.firstBaseUpdate,q=M.lastBaseUpdate,ie=M.shared.pending;if(ie!==null){M.shared.pending=null;var we=ie,Ze=we.next;we.next=null,q===null?N=Ze:q.next=Ze,q=we;var st=r.alternate;st!==null&&(st=st.updateQueue,ie=st.lastBaseUpdate,ie!==q&&(ie===null?st.firstBaseUpdate=Ze:ie.next=Ze,st.lastBaseUpdate=we))}if(N!==null){var ut=M.baseState;q=0,st=Ze=we=null,ie=N;do{var We=ie.lane&-536870913,Ke=We!==ie.lane;if(Ke?(Zn&We)===We:(w&We)===We){We!==0&&We===pr&&(Md=!0),st!==null&&(st=st.next={lane:0,tag:ie.tag,payload:ie.payload,callback:null,next:null});e:{var cn=r,rn=ie;We=u;var ci=p;switch(rn.tag){case 1:if(cn=rn.payload,typeof cn=="function"){ut=cn.call(ci,ut,We);break e}ut=cn;break e;case 3:cn.flags=cn.flags&-65537|128;case 0:if(cn=rn.payload,We=typeof cn=="function"?cn.call(ci,ut,We):cn,We==null)break e;ut=z({},ut,We);break e;case 2:Rs=!0}}We=ie.callback,We!==null&&(r.flags|=64,Ke&&(r.flags|=8192),Ke=M.callbacks,Ke===null?M.callbacks=[We]:Ke.push(We))}else Ke={lane:We,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},st===null?(Ze=st=Ke,we=ut):st=st.next=Ke,q|=We;if(ie=ie.next,ie===null){if(ie=M.shared.pending,ie===null)break;Ke=ie,ie=Ke.next,Ke.next=null,M.lastBaseUpdate=Ke,M.shared.pending=null}}while(!0);st===null&&(we=ut),M.baseState=we,M.firstBaseUpdate=Ze,M.lastBaseUpdate=st,N===null&&(M.shared.lanes=0),pu|=q,r.lanes=q,r.memoizedState=ut}}function jf(r,u){if(typeof r!="function")throw Error(d(191,r));r.call(u)}function Bf(r,u){var p=r.callbacks;if(p!==null)for(r.callbacks=null,r=0;r<p.length;r++)jf(p[r],u)}var Wr=et(null),Hn=et(0);function Cd(r,u){r=Ls,bt(Hn,r),bt(Wr,u),Ls=r|u.baseLanes}function su(){bt(Hn,Ls),bt(Wr,Wr.current)}function vh(){Ls=Hn.current,Et(Wr),Et(Hn)}var go=0,wn=null,Qn=null,lr=null,Fa=!1,Zo=!1,zt=!1,$t=0,Ua=0,Tl=null,Dd=0;function Ln(){throw Error(d(321))}function bh(r,u){if(u===null)return!1;for(var p=0;p<u.length&&p<r.length;p++)if(!ua(r[p],u[p]))return!1;return!0}function Va(r,u,p,w,M,N){return go=N,wn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Ue.H=r===null||r.memoizedState===null?Ps:Ns,zt=!1,N=p(w,M),zt=!1,Zo&&(N=os(u,p,w,M)),Hp(r),N}function Hp(r){Ue.H=Qr;var u=Qn!==null&&Qn.next!==null;if(go=0,lr=Qn=wn=null,Fa=!1,Ua=0,Tl=null,u)throw Error(d(300));r===null||yr||(r=r.dependencies,r!==null&&ph(r)&&(yr=!0))}function os(r,u,p,w){wn=r;var M=0;do{if(Zo&&(Tl=null),Ua=0,Zo=!1,25<=M)throw Error(d(301));if(M+=1,lr=Qn=null,r.updateQueue!=null){var N=r.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}Ue.H=Ga,N=u(p,w)}while(Zo);return N}function Pi(){var r=Ue.H,u=r.useState()[0];return u=typeof u.then=="function"?uc(u):u,r=r.useState()[0],(Qn!==null?Qn.memoizedState:null)!==r&&(wn.flags|=1024),u}function Ei(){var r=$t!==0;return $t=0,r}function xh(r,u,p){u.updateQueue=r.updateQueue,u.flags&=-2053,r.lanes&=~p}function $o(r){if(Fa){for(r=r.memoizedState;r!==null;){var u=r.queue;u!==null&&(u.pending=null),r=r.next}Fa=!1}go=0,lr=Qn=wn=null,Zo=!1,Ua=$t=0,Tl=null}function Lr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lr===null?wn.memoizedState=lr=r:lr=lr.next=r,lr}function Ai(){if(Qn===null){var r=wn.alternate;r=r!==null?r.memoizedState:null}else r=Qn.next;var u=lr===null?wn.memoizedState:lr.next;if(u!==null)lr=u,Qn=r;else{if(r===null)throw wn.alternate===null?Error(d(467)):Error(d(310));Qn=r,r={memoizedState:Qn.memoizedState,baseState:Qn.baseState,baseQueue:Qn.baseQueue,queue:Qn.queue,next:null},lr===null?wn.memoizedState=lr=r:lr=lr.next=r}return lr}function Yo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uc(r){var u=Ua;return Ua+=1,Tl===null&&(Tl=[]),r=oc(Tl,r,u),u=wn,(lr===null?u.memoizedState:lr.next)===null&&(u=u.alternate,Ue.H=u===null||u.memoizedState===null?Ps:Ns),r}function qo(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return uc(r);if(r.$$typeof===je)return yi(r)}throw Error(d(438,String(r)))}function Ho(r){var u=null,p=wn.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var w=wn.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(u={data:w.data.map(function(M){return M.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Yo(),wn.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(r),w=0;w<r;w++)p[w]=Xe;return u.index++,p}function Is(r,u){return typeof u=="function"?u(r):u}function ou(r){var u=Ai();return lu(u,Qn,r)}function lu(r,u,p){var w=r.queue;if(w===null)throw Error(d(311));w.lastRenderedReducer=p;var M=r.baseQueue,N=w.pending;if(N!==null){if(M!==null){var q=M.next;M.next=N.next,N.next=q}u.baseQueue=M=N,w.pending=null}if(N=r.baseState,M===null)r.memoizedState=N;else{u=M.next;var ie=q=null,we=null,Ze=u,st=!1;do{var ut=Ze.lane&-536870913;if(ut!==Ze.lane?(Zn&ut)===ut:(go&ut)===ut){var We=Ze.revertLane;if(We===0)we!==null&&(we=we.next={lane:0,revertLane:0,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),ut===pr&&(st=!0);else if((go&We)===We){Ze=Ze.next,We===pr&&(st=!0);continue}else ut={lane:0,revertLane:Ze.revertLane,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},we===null?(ie=we=ut,q=N):we=we.next=ut,wn.lanes|=We,pu|=We;ut=Ze.action,zt&&p(N,ut),N=Ze.hasEagerState?Ze.eagerState:p(N,ut)}else We={lane:ut,revertLane:Ze.revertLane,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},we===null?(ie=we=We,q=N):we=we.next=We,wn.lanes|=ut,pu|=ut;Ze=Ze.next}while(Ze!==null&&Ze!==u);if(we===null?q=N:we.next=ie,!ua(N,r.memoizedState)&&(yr=!0,st&&(p=Xr,p!==null)))throw p;r.memoizedState=N,r.baseState=q,r.baseQueue=we,w.lastRenderedState=N}return M===null&&(w.lanes=0),[r.memoizedState,w.dispatch]}function wh(r){var u=Ai(),p=u.queue;if(p===null)throw Error(d(311));p.lastRenderedReducer=r;var w=p.dispatch,M=p.pending,N=u.memoizedState;if(M!==null){p.pending=null;var q=M=M.next;do N=r(N,q.action),q=q.next;while(q!==M);ua(N,u.memoizedState)||(yr=!0),u.memoizedState=N,u.baseQueue===null&&(u.baseState=N),p.lastRenderedState=N}return[N,w]}function b(r,u,p){var w=wn,M=Ai(),N=Gn;if(N){if(p===void 0)throw Error(d(407));p=p()}else p=u();var q=!ua((Qn||M).memoizedState,p);q&&(M.memoizedState=p,yr=!0),M=M.queue;var ie=f.bind(null,w,M,r);if(De(2048,8,ie,[r]),M.getSnapshot!==u||q||lr!==null&&lr.memoizedState.tag&1){if(w.flags|=2048,me(9,xe(),o.bind(null,w,M,p,u),null),li===null)throw Error(d(349));N||(go&124)!==0||e(w,u,p)}return p}function e(r,u,p){r.flags|=16384,r={getSnapshot:u,value:p},u=wn.updateQueue,u===null?(u=Yo(),wn.updateQueue=u,u.stores=[r]):(p=u.stores,p===null?u.stores=[r]:p.push(r))}function o(r,u,p,w){u.value=p,u.getSnapshot=w,y(u)&&T(r)}function f(r,u,p){return p(function(){y(u)&&T(r)})}function y(r){var u=r.getSnapshot;r=r.value;try{var p=u();return!ua(r,p)}catch{return!0}}function T(r){var u=Na(r,2);u!==null&&ps(u,r,2)}function E(r){var u=Lr();if(typeof r=="function"){var p=r;if(r=p(),zt){Ur(!0);try{p()}finally{Ur(!1)}}}return u.memoizedState=u.baseState=r,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:r},u}function k(r,u,p,w){return r.baseState=p,lu(r,Qn,typeof w=="function"?w:Is)}function I(r,u,p,w,M){if(hc(r))throw Error(d(485));if(r=u.action,r!==null){var N={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){N.listeners.push(q)}};Ue.T!==null?p(!0):N.isTransition=!1,w(N),p=u.pending,p===null?(N.next=u.pending=N,O(u,N)):(N.next=p.next,u.pending=p.next=N)}}function O(r,u){var p=u.action,w=u.payload,M=r.state;if(u.isTransition){var N=Ue.T,q={};Ue.T=q;try{var ie=p(M,w),we=Ue.S;we!==null&&we(q,ie),j(r,u,ie)}catch(Ze){U(r,u,Ze)}finally{Ue.T=N}}else try{N=p(M,w),j(r,u,N)}catch(Ze){U(r,u,Ze)}}function j(r,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(w){Z(r,u,w)},function(w){return U(r,u,w)}):Z(r,u,p)}function Z(r,u,p){u.status="fulfilled",u.value=p,Y(u),r.state=p,u=r.pending,u!==null&&(p=u.next,p===u?r.pending=null:(p=p.next,u.next=p,O(r,p)))}function U(r,u,p){var w=r.pending;if(r.pending=null,w!==null){w=w.next;do u.status="rejected",u.reason=p,Y(u),u=u.next;while(u!==w)}r.action=null}function Y(r){r=r.listeners;for(var u=0;u<r.length;u++)(0,r[u])()}function Q(r,u){return u}function le(r,u){if(Gn){var p=li.formState;if(p!==null){e:{var w=wn;if(Gn){if(Ri){t:{for(var M=Ri,N=ja;M.nodeType!==8;){if(!N){M=null;break t}if(M=ms(M.nextSibling),M===null){M=null;break t}}N=M.data,M=N==="F!"||N==="F"?M:null}if(M){Ri=ms(M.nextSibling),w=M.data==="F!";break e}}ac(w)}w=!1}w&&(u=p[0])}}return p=Lr(),p.memoizedState=p.baseState=u,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q,lastRenderedState:u},p.queue=w,p=ls.bind(null,wn,w),w.dispatch=p,w=E(!1),N=Xo.bind(null,wn,!1,w.queue),w=Lr(),M={state:u,dispatch:null,action:r,pending:null},w.queue=M,p=I.bind(null,wn,M,N,p),M.dispatch=p,w.memoizedState=r,[u,p,!1]}function oe(r){var u=Ai();return ue(u,Qn,r)}function ue(r,u,p){if(u=lu(r,u,Q)[0],r=ou(Is)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var w=uc(u)}catch(q){throw q===Vo?Ct:q}else w=u;u=Ai();var M=u.queue,N=M.dispatch;return p!==u.memoizedState&&(wn.flags|=2048,me(9,xe(),he.bind(null,M,p),null)),[w,N,r]}function he(r,u){r.action=u}function ye(r){var u=Ai(),p=Qn;if(p!==null)return ue(u,p,r);Ai(),u=u.memoizedState,p=Ai();var w=p.queue.dispatch;return p.memoizedState=r,[u,w,!1]}function me(r,u,p,w){return r={tag:r,create:p,deps:w,inst:u,next:null},u=wn.updateQueue,u===null&&(u=Yo(),wn.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=r.next=r:(w=p.next,p.next=r,r.next=w,u.lastEffect=r),r}function xe(){return{destroy:void 0,resource:void 0}}function Ee(){return Ai().memoizedState}function ge(r,u,p,w){var M=Lr();w=w===void 0?null:w,wn.flags|=r,M.memoizedState=me(1|u,xe(),p,w)}function De(r,u,p,w){var M=Ai();w=w===void 0?null:w;var N=M.memoizedState.inst;Qn!==null&&w!==null&&bh(w,Qn.memoizedState.deps)?M.memoizedState=me(u,N,p,w):(wn.flags|=r,M.memoizedState=me(1|u,N,p,w))}function qe(r,u){ge(8390656,8,r,u)}function Le(r,u){De(2048,8,r,u)}function Oe(r,u){return De(4,2,r,u)}function Ye(r,u){return De(4,4,r,u)}function vt(r,u){if(typeof u=="function"){r=r();var p=u(r);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return r=r(),u.current=r,function(){u.current=null}}function pt(r,u,p){p=p!=null?p.concat([r]):null,De(4,4,vt.bind(null,u,r),p)}function ot(){}function Ot(r,u){var p=Ai();u=u===void 0?null:u;var w=p.memoizedState;return u!==null&&bh(u,w[1])?w[0]:(p.memoizedState=[r,u],r)}function mn(r,u){var p=Ai();u=u===void 0?null:u;var w=p.memoizedState;if(u!==null&&bh(u,w[1]))return w[0];if(w=r(),zt){Ur(!0);try{r()}finally{Ur(!1)}}return p.memoizedState=[w,u],w}function Rn(r,u,p){return p===void 0||(go&1073741824)!==0?r.memoizedState=u:(r.memoizedState=p,r=mm(),wn.lanes|=r,pu|=r,p)}function Mi(r,u,p,w){return ua(p,u)?p:Wr.current!==null?(r=Rn(r,p,w),ua(r,u)||(yr=!0),r):(go&42)===0?(yr=!0,r.memoizedState=p):(r=mm(),wn.lanes|=r,pu|=r,u)}function Fn(r,u,p,w,M){var N=ft.p;ft.p=N!==0&&8>N?N:8;var q=Ue.T,ie={};Ue.T=ie,Xo(r,!1,u,p);try{var we=M(),Ze=Ue.S;if(Ze!==null&&Ze(ie,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var st=tu(we,w);cs(r,u,st,Kn(r))}else cs(r,u,w,Kn(r))}catch(ut){cs(r,u,{then:function(){},status:"rejected",reason:ut},Kn())}finally{ft.p=N,Ue.T=q}}function _i(){}function Ci(r,u,p,w){if(r.tag!==5)throw Error(d(476));var M=oi(r).queue;Fn(r,M,u,Dt,p===null?_i:function(){return on(r),p(w)})}function oi(r){var u=r.memoizedState;if(u!==null)return u;u={memoizedState:Dt,baseState:Dt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:Dt},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:p},next:null},r.memoizedState=u,r=r.alternate,r!==null&&(r.memoizedState=u),u}function on(r){var u=oi(r).next.queue;cs(r,u,{},Kn())}function cr(){return yi($)}function $i(){return Ai().memoizedState}function mr(){return Ai().memoizedState}function fa(r){for(var u=r.return;u!==null;){switch(u.tag){case 24:case 3:var p=Kn();r=wl(p);var w=Go(u,r,p);w!==null&&(ps(w,u,p),lc(w,u,p)),u={cache:xl()},r.payload=u;return}u=u.return}}function Sl(r,u,p){var w=Kn();p={lane:w,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},hc(r)?dc(u,p):(p=ml(r,u,p,w),p!==null&&(ps(p,r,w),yo(p,u,w)))}function ls(r,u,p){var w=Kn();cs(r,u,p,w)}function cs(r,u,p,w){var M={lane:w,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(hc(r))dc(u,M);else{var N=r.alternate;if(r.lanes===0&&(N===null||N.lanes===0)&&(N=u.lastRenderedReducer,N!==null))try{var q=u.lastRenderedState,ie=N(q,p);if(M.hasEagerState=!0,M.eagerState=ie,ua(ie,q))return lh(r,u,M,0),li===null&&rc(),!1}catch{}finally{}if(p=ml(r,u,M,w),p!==null)return ps(p,r,w),yo(p,u,w),!0}return!1}function Xo(r,u,p,w){if(w={lane:2,revertLane:oy(),action:w,hasEagerState:!1,eagerState:null,next:null},hc(r)){if(u)throw Error(d(479))}else u=ml(r,p,w,2),u!==null&&ps(u,r,2)}function hc(r){var u=r.alternate;return r===wn||u!==null&&u===wn}function dc(r,u){Zo=Fa=!0;var p=r.pending;p===null?u.next=u:(u.next=p.next,p.next=u),r.pending=u}function yo(r,u,p){if((p&4194048)!==0){var w=u.lanes;w&=r.pendingLanes,p|=w,u.lanes=p,Vt(r,p)}}var Qr={readContext:yi,use:qo,useCallback:Ln,useContext:Ln,useEffect:Ln,useImperativeHandle:Ln,useLayoutEffect:Ln,useInsertionEffect:Ln,useMemo:Ln,useReducer:Ln,useRef:Ln,useState:Ln,useDebugValue:Ln,useDeferredValue:Ln,useTransition:Ln,useSyncExternalStore:Ln,useId:Ln,useHostTransitionStatus:Ln,useFormState:Ln,useActionState:Ln,useOptimistic:Ln,useMemoCache:Ln,useCacheRefresh:Ln},Ps={readContext:yi,use:qo,useCallback:function(r,u){return Lr().memoizedState=[r,u===void 0?null:u],r},useContext:yi,useEffect:qe,useImperativeHandle:function(r,u,p){p=p!=null?p.concat([r]):null,ge(4194308,4,vt.bind(null,u,r),p)},useLayoutEffect:function(r,u){return ge(4194308,4,r,u)},useInsertionEffect:function(r,u){ge(4,2,r,u)},useMemo:function(r,u){var p=Lr();u=u===void 0?null:u;var w=r();if(zt){Ur(!0);try{r()}finally{Ur(!1)}}return p.memoizedState=[w,u],w},useReducer:function(r,u,p){var w=Lr();if(p!==void 0){var M=p(u);if(zt){Ur(!0);try{p(u)}finally{Ur(!1)}}}else M=u;return w.memoizedState=w.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},w.queue=r,r=r.dispatch=Sl.bind(null,wn,r),[w.memoizedState,r]},useRef:function(r){var u=Lr();return r={current:r},u.memoizedState=r},useState:function(r){r=E(r);var u=r.queue,p=ls.bind(null,wn,u);return u.dispatch=p,[r.memoizedState,p]},useDebugValue:ot,useDeferredValue:function(r,u){var p=Lr();return Rn(p,r,u)},useTransition:function(){var r=E(!1);return r=Fn.bind(null,wn,r.queue,!0,!1),Lr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,u,p){var w=wn,M=Lr();if(Gn){if(p===void 0)throw Error(d(407));p=p()}else{if(p=u(),li===null)throw Error(d(349));(Zn&124)!==0||e(w,u,p)}M.memoizedState=p;var N={value:p,getSnapshot:u};return M.queue=N,qe(f.bind(null,w,N,r),[r]),w.flags|=2048,me(9,xe(),o.bind(null,w,N,p,u),null),p},useId:function(){var r=Lr(),u=li.identifierPrefix;if(Gn){var p=is,w=Oa;p=(w&~(1<<32-Ae(w)-1)).toString(32)+p,u="«"+u+"R"+p,p=$t++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=Dd++,u="«"+u+"r"+p.toString(32)+"»";return r.memoizedState=u},useHostTransitionStatus:cr,useFormState:le,useActionState:le,useOptimistic:function(r){var u=Lr();u.memoizedState=u.baseState=r;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Xo.bind(null,wn,!0,p),p.dispatch=u,[r,u]},useMemoCache:Ho,useCacheRefresh:function(){return Lr().memoizedState=fa.bind(null,wn)}},Ns={readContext:yi,use:qo,useCallback:Ot,useContext:yi,useEffect:Le,useImperativeHandle:pt,useInsertionEffect:Oe,useLayoutEffect:Ye,useMemo:mn,useReducer:ou,useRef:Ee,useState:function(){return ou(Is)},useDebugValue:ot,useDeferredValue:function(r,u){var p=Ai();return Mi(p,Qn.memoizedState,r,u)},useTransition:function(){var r=ou(Is)[0],u=Ai().memoizedState;return[typeof r=="boolean"?r:uc(r),u]},useSyncExternalStore:b,useId:$i,useHostTransitionStatus:cr,useFormState:oe,useActionState:oe,useOptimistic:function(r,u){var p=Ai();return k(p,Qn,r,u)},useMemoCache:Ho,useCacheRefresh:mr},Ga={readContext:yi,use:qo,useCallback:Ot,useContext:yi,useEffect:Le,useImperativeHandle:pt,useInsertionEffect:Oe,useLayoutEffect:Ye,useMemo:mn,useReducer:wh,useRef:Ee,useState:function(){return wh(Is)},useDebugValue:ot,useDeferredValue:function(r,u){var p=Ai();return Qn===null?Rn(p,r,u):Mi(p,Qn.memoizedState,r,u)},useTransition:function(){var r=wh(Is)[0],u=Ai().memoizedState;return[typeof r=="boolean"?r:uc(r),u]},useSyncExternalStore:b,useId:$i,useHostTransitionStatus:cr,useFormState:ye,useActionState:ye,useOptimistic:function(r,u){var p=Ai();return Qn!==null?k(p,Qn,r,u):(p.baseState=r,[r,p.queue.dispatch])},useMemoCache:Ho,useCacheRefresh:mr},ui=null,Ui=0;function Kr(r){var u=Ui;return Ui+=1,ui===null&&(ui=[]),oc(ui,r,u)}function Yi(r,u){u=u.props.ref,r.ref=u!==void 0?u:null}function cu(r,u){throw u.$$typeof===B?Error(d(525)):(r=Object.prototype.toString.call(u),Error(d(31,r==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":r)))}function uu(r){var u=r._init;return u(r._payload)}function fc(r){function u(ze,Ce){if(r){var $e=ze.deletions;$e===null?(ze.deletions=[Ce],ze.flags|=16):$e.push(Ce)}}function p(ze,Ce){if(!r)return null;for(;Ce!==null;)u(ze,Ce),Ce=Ce.sibling;return null}function w(ze){for(var Ce=new Map;ze!==null;)ze.key!==null?Ce.set(ze.key,ze):Ce.set(ze.index,ze),ze=ze.sibling;return Ce}function M(ze,Ce){return ze=$r(ze,Ce),ze.index=0,ze.sibling=null,ze}function N(ze,Ce,$e){return ze.index=$e,r?($e=ze.alternate,$e!==null?($e=$e.index,$e<Ce?(ze.flags|=67108866,Ce):$e):(ze.flags|=67108866,Ce)):(ze.flags|=1048576,Ce)}function q(ze){return r&&ze.alternate===null&&(ze.flags|=67108866),ze}function ie(ze,Ce,$e,ct){return Ce===null||Ce.tag!==6?(Ce=Nf($e,ze.mode,ct),Ce.return=ze,Ce):(Ce=M(Ce,$e),Ce.return=ze,Ce)}function we(ze,Ce,$e,ct){var Zt=$e.type;return Zt===re?st(ze,Ce,$e.props.children,ct,$e.key):Ce!==null&&(Ce.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===Mt&&uu(Zt)===Ce.type)?(Ce=M(Ce,$e.props),Yi(Ce,$e),Ce.return=ze,Ce):(Ce=bd($e.type,$e.key,$e.props,null,ze.mode,ct),Yi(Ce,$e),Ce.return=ze,Ce)}function Ze(ze,Ce,$e,ct){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==$e.containerInfo||Ce.stateNode.implementation!==$e.implementation?(Ce=uh($e,ze.mode,ct),Ce.return=ze,Ce):(Ce=M(Ce,$e.children||[]),Ce.return=ze,Ce)}function st(ze,Ce,$e,ct,Zt){return Ce===null||Ce.tag!==7?(Ce=gl($e,ze.mode,ct,Zt),Ce.return=ze,Ce):(Ce=M(Ce,$e),Ce.return=ze,Ce)}function ut(ze,Ce,$e){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=Nf(""+Ce,ze.mode,$e),Ce.return=ze,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case V:return $e=bd(Ce.type,Ce.key,Ce.props,null,ze.mode,$e),Yi($e,Ce),$e.return=ze,$e;case G:return Ce=uh(Ce,ze.mode,$e),Ce.return=ze,Ce;case Mt:var ct=Ce._init;return Ce=ct(Ce._payload),ut(ze,Ce,$e)}if(Ht(Ce)||Rt(Ce))return Ce=gl(Ce,ze.mode,$e,null),Ce.return=ze,Ce;if(typeof Ce.then=="function")return ut(ze,Kr(Ce),$e);if(Ce.$$typeof===je)return ut(ze,Uo(ze,Ce),$e);cu(ze,Ce)}return null}function We(ze,Ce,$e,ct){var Zt=Ce!==null?Ce.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return Zt!==null?null:ie(ze,Ce,""+$e,ct);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case V:return $e.key===Zt?we(ze,Ce,$e,ct):null;case G:return $e.key===Zt?Ze(ze,Ce,$e,ct):null;case Mt:return Zt=$e._init,$e=Zt($e._payload),We(ze,Ce,$e,ct)}if(Ht($e)||Rt($e))return Zt!==null?null:st(ze,Ce,$e,ct,null);if(typeof $e.then=="function")return We(ze,Ce,Kr($e),ct);if($e.$$typeof===je)return We(ze,Ce,Uo(ze,$e),ct);cu(ze,$e)}return null}function Ke(ze,Ce,$e,ct,Zt){if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return ze=ze.get($e)||null,ie(Ce,ze,""+ct,Zt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case V:return ze=ze.get(ct.key===null?$e:ct.key)||null,we(Ce,ze,ct,Zt);case G:return ze=ze.get(ct.key===null?$e:ct.key)||null,Ze(Ce,ze,ct,Zt);case Mt:var In=ct._init;return ct=In(ct._payload),Ke(ze,Ce,$e,ct,Zt)}if(Ht(ct)||Rt(ct))return ze=ze.get($e)||null,st(Ce,ze,ct,Zt,null);if(typeof ct.then=="function")return Ke(ze,Ce,$e,Kr(ct),Zt);if(ct.$$typeof===je)return Ke(ze,Ce,$e,Uo(Ce,ct),Zt);cu(Ce,ct)}return null}function cn(ze,Ce,$e,ct){for(var Zt=null,In=null,Kt=Ce,ln=Ce=0,ra=null;Kt!==null&&ln<$e.length;ln++){Kt.index>ln?(ra=Kt,Kt=null):ra=Kt.sibling;var Jn=We(ze,Kt,$e[ln],ct);if(Jn===null){Kt===null&&(Kt=ra);break}r&&Kt&&Jn.alternate===null&&u(ze,Kt),Ce=N(Jn,Ce,ln),In===null?Zt=Jn:In.sibling=Jn,In=Jn,Kt=ra}if(ln===$e.length)return p(ze,Kt),Gn&&Bo(ze,ln),Zt;if(Kt===null){for(;ln<$e.length;ln++)Kt=ut(ze,$e[ln],ct),Kt!==null&&(Ce=N(Kt,Ce,ln),In===null?Zt=Kt:In.sibling=Kt,In=Kt);return Gn&&Bo(ze,ln),Zt}for(Kt=w(Kt);ln<$e.length;ln++)ra=Ke(Kt,ze,ln,$e[ln],ct),ra!==null&&(r&&ra.alternate!==null&&Kt.delete(ra.key===null?ln:ra.key),Ce=N(ra,Ce,ln),In===null?Zt=ra:In.sibling=ra,In=ra);return r&&Kt.forEach(function(Su){return u(ze,Su)}),Gn&&Bo(ze,ln),Zt}function rn(ze,Ce,$e,ct){if($e==null)throw Error(d(151));for(var Zt=null,In=null,Kt=Ce,ln=Ce=0,ra=null,Jn=$e.next();Kt!==null&&!Jn.done;ln++,Jn=$e.next()){Kt.index>ln?(ra=Kt,Kt=null):ra=Kt.sibling;var Su=We(ze,Kt,Jn.value,ct);if(Su===null){Kt===null&&(Kt=ra);break}r&&Kt&&Su.alternate===null&&u(ze,Kt),Ce=N(Su,Ce,ln),In===null?Zt=Su:In.sibling=Su,In=Su,Kt=ra}if(Jn.done)return p(ze,Kt),Gn&&Bo(ze,ln),Zt;if(Kt===null){for(;!Jn.done;ln++,Jn=$e.next())Jn=ut(ze,Jn.value,ct),Jn!==null&&(Ce=N(Jn,Ce,ln),In===null?Zt=Jn:In.sibling=Jn,In=Jn);return Gn&&Bo(ze,ln),Zt}for(Kt=w(Kt);!Jn.done;ln++,Jn=$e.next())Jn=Ke(Kt,ze,ln,Jn.value,ct),Jn!==null&&(r&&Jn.alternate!==null&&Kt.delete(Jn.key===null?ln:Jn.key),Ce=N(Jn,Ce,ln),In===null?Zt=Jn:In.sibling=Jn,In=Jn);return r&&Kt.forEach(function(Gv){return u(ze,Gv)}),Gn&&Bo(ze,ln),Zt}function ci(ze,Ce,$e,ct){if(typeof $e=="object"&&$e!==null&&$e.type===re&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case V:e:{for(var Zt=$e.key;Ce!==null;){if(Ce.key===Zt){if(Zt=$e.type,Zt===re){if(Ce.tag===7){p(ze,Ce.sibling),ct=M(Ce,$e.props.children),ct.return=ze,ze=ct;break e}}else if(Ce.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===Mt&&uu(Zt)===Ce.type){p(ze,Ce.sibling),ct=M(Ce,$e.props),Yi(ct,$e),ct.return=ze,ze=ct;break e}p(ze,Ce);break}else u(ze,Ce);Ce=Ce.sibling}$e.type===re?(ct=gl($e.props.children,ze.mode,ct,$e.key),ct.return=ze,ze=ct):(ct=bd($e.type,$e.key,$e.props,null,ze.mode,ct),Yi(ct,$e),ct.return=ze,ze=ct)}return q(ze);case G:e:{for(Zt=$e.key;Ce!==null;){if(Ce.key===Zt)if(Ce.tag===4&&Ce.stateNode.containerInfo===$e.containerInfo&&Ce.stateNode.implementation===$e.implementation){p(ze,Ce.sibling),ct=M(Ce,$e.children||[]),ct.return=ze,ze=ct;break e}else{p(ze,Ce);break}else u(ze,Ce);Ce=Ce.sibling}ct=uh($e,ze.mode,ct),ct.return=ze,ze=ct}return q(ze);case Mt:return Zt=$e._init,$e=Zt($e._payload),ci(ze,Ce,$e,ct)}if(Ht($e))return cn(ze,Ce,$e,ct);if(Rt($e)){if(Zt=Rt($e),typeof Zt!="function")throw Error(d(150));return $e=Zt.call($e),rn(ze,Ce,$e,ct)}if(typeof $e.then=="function")return ci(ze,Ce,Kr($e),ct);if($e.$$typeof===je)return ci(ze,Ce,Uo(ze,$e),ct);cu(ze,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint"?($e=""+$e,Ce!==null&&Ce.tag===6?(p(ze,Ce.sibling),ct=M(Ce,$e),ct.return=ze,ze=ct):(p(ze,Ce),ct=Nf($e,ze.mode,ct),ct.return=ze,ze=ct),q(ze)):p(ze,Ce)}return function(ze,Ce,$e,ct){try{Ui=0;var Zt=ci(ze,Ce,$e,ct);return ui=null,Zt}catch(Kt){if(Kt===Vo||Kt===Ct)throw Kt;var In=za(29,Kt,null,ze.mode);return In.lanes=ct,In.return=ze,In}finally{}}}var xa=fc(!0),us=fc(!1),gr=et(null),Or=null;function pa(r){var u=r.alternate;bt(Ki,Ki.current&1),bt(gr,r),Or===null&&(u===null||Wr.current!==null||u.memoizedState!==null)&&(Or=r)}function Ff(r){if(r.tag===22){if(bt(Ki,Ki.current),bt(gr,r),Or===null){var u=r.alternate;u!==null&&u.memoizedState!==null&&(Or=r)}}else _o()}function _o(){bt(Ki,Ki.current),bt(gr,gr.current)}function Za(r){Et(gr),Or===r&&(Or=null),Et(Ki)}var Ki=et(0);function hs(r){for(var u=r;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Nm(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function pc(r,u,p,w){u=r.memoizedState,p=p(w,u),p=p==null?u:z({},u,p),r.memoizedState=p,r.lanes===0&&(r.updateQueue.baseState=p)}var Xp={enqueueSetState:function(r,u,p){r=r._reactInternals;var w=Kn(),M=wl(w);M.payload=u,p!=null&&(M.callback=p),u=Go(r,M,w),u!==null&&(ps(u,r,w),lc(u,r,w))},enqueueReplaceState:function(r,u,p){r=r._reactInternals;var w=Kn(),M=wl(w);M.tag=1,M.payload=u,p!=null&&(M.callback=p),u=Go(r,M,w),u!==null&&(ps(u,r,w),lc(u,r,w))},enqueueForceUpdate:function(r,u){r=r._reactInternals;var p=Kn(),w=wl(p);w.tag=2,u!=null&&(w.callback=u),u=Go(r,w,p),u!==null&&(ps(u,r,p),lc(u,r,p))}};function L_(r,u,p,w,M,N,q){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(w,N,q):u.prototype&&u.prototype.isPureReactComponent?!qc(p,w)||!qc(M,N):!0}function Wp(r,u,p,w){r=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,w),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,w),u.state!==r&&Xp.enqueueReplaceState(u,u.state,null)}function hu(r,u){var p=u;if("ref"in u){p={};for(var w in u)w!=="ref"&&(p[w]=u[w])}if(r=r.defaultProps){p===u&&(p=z({},p));for(var M in r)p[M]===void 0&&(p[M]=r[M])}return p}var Th=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Ig(r){Th(r)}function O_(r){console.error(r)}function Qp(r){Th(r)}function Kp(r,u){try{var p=r.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(w){setTimeout(function(){throw w})}}function Jp(r,u,p){try{var w=r.onCaughtError;w(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function em(r,u,p){return p=wl(p),p.tag=3,p.payload={element:null},p.callback=function(){Kp(r,u)},p}function Pg(r){return r=wl(r),r.tag=3,r}function Sh(r,u,p,w){var M=p.type.getDerivedStateFromError;if(typeof M=="function"){var N=w.value;r.payload=function(){return M(N)},r.callback=function(){Jp(u,p,w)}}var q=p.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(r.callback=function(){Jp(u,p,w),typeof M!="function"&&(Qo===null?Qo=new Set([this]):Qo.add(this));var ie=w.stack;this.componentDidCatch(w.value,{componentStack:ie!==null?ie:""})})}function Dv(r,u,p,w,M){if(p.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(u=p.alternate,u!==null&&Kc(u,p,M,!0),p=gr.current,p!==null){switch(p.tag){case 13:return Or===null?Qg():p.alternate===null&&Ji===0&&(Ji=3),p.flags&=-257,p.flags|=65536,p.lanes=M,w===mh?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([w]):u.add(w),vm(r,w,M)),!1;case 22:return p.flags|=65536,w===mh?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([w])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([w]):p.add(w)),vm(r,w,M)),!1}throw Error(d(435,p.tag))}return vm(r,w,M),Qg(),!1}if(Gn)return u=gr.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=M,w!==dh&&(r=Error(d(422),{cause:w}),Fo(Sr(r,p)))):(w!==dh&&(u=Error(d(423),{cause:w}),Fo(Sr(u,p))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,w=Sr(w,p),M=em(r.stateNode,w,M),_h(r,M),Ji!==4&&(Ji=2)),!1;var N=Error(d(520),{cause:w});if(N=Sr(N,p),Ud===null?Ud=[N]:Ud.push(N),Ji!==4&&(Ji=2),u===null)return!0;w=Sr(w,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,r=M&-M,p.lanes|=r,r=em(p.stateNode,w,r),_h(p,r),!1;case 1:if(u=p.type,N=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Qo===null||!Qo.has(N))))return p.flags|=65536,M&=-M,p.lanes|=M,M=Pg(M),Sh(M,r,p,w),_h(p,M),!1}p=p.return}while(p!==null);return!1}var Eh=Error(d(461)),yr=!1;function Er(r,u,p,w){u.child=r===null?us(u,null,p,w):xa(u,r.child,p,w)}function j_(r,u,p,w,M){p=p.render;var N=u.ref;if("ref"in w){var q={};for(var ie in w)ie!=="ref"&&(q[ie]=w[ie])}else q=w;return bl(u),w=Va(r,u,p,q,N,M),ie=Ei(),r!==null&&!yr?(xh(r,u,M),mc(r,u,M)):(Gn&&ie&&hh(u),u.flags|=1,Er(r,u,w,M),u.child)}function B_(r,u,p,w,M){if(r===null){var N=p.type;return typeof N=="function"&&!vd(N)&&N.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=N,F_(r,u,N,w,M)):(r=bd(p.type,null,w,u,u.mode,M),r.ref=u.ref,r.return=u,u.child=r)}if(N=r.child,!lm(r,M)){var q=N.memoizedProps;if(p=p.compare,p=p!==null?p:qc,p(q,w)&&r.ref===u.ref)return mc(r,u,M)}return u.flags|=1,r=$r(N,w),r.ref=u.ref,r.return=u,u.child=r}function F_(r,u,p,w,M){if(r!==null){var N=r.memoizedProps;if(qc(N,w)&&r.ref===u.ref)if(yr=!1,u.pendingProps=w=N,lm(r,M))(r.flags&131072)!==0&&(yr=!0);else return u.lanes=r.lanes,mc(r,u,M)}return tm(r,u,p,w,M)}function U_(r,u,p){var w=u.pendingProps,M=w.children,N=r!==null?r.memoizedState:null;if(w.mode==="hidden"){if((u.flags&128)!==0){if(w=N!==null?N.baseLanes|p:p,r!==null){for(M=u.child=r.child,N=0;M!==null;)N=N|M.lanes|M.childLanes,M=M.sibling;u.childLanes=N&~w}else u.childLanes=0,u.child=null;return Ng(r,u,w,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},r!==null&&Ad(u,N!==null?N.cachePool:null),N!==null?Cd(u,N):su(),Ff(u);else return u.lanes=u.childLanes=536870912,Ng(r,u,N!==null?N.baseLanes|p:p,p)}else N!==null?(Ad(u,N.cachePool),Cd(u,N),_o(),u.memoizedState=null):(r!==null&&Ad(u,null),su(),_o());return Er(r,u,M,p),u.child}function Ng(r,u,p,w){var M=Lf();return M=M===null?null:{parent:or._currentValue,pool:M},u.memoizedState={baseLanes:p,cachePool:M},r!==null&&Ad(u,null),su(),Ff(u),r!==null&&Kc(r,u,w,!0),null}function kd(r,u){var p=u.ref;if(p===null)r!==null&&r.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(d(284));(r===null||r.ref!==p)&&(u.flags|=4194816)}}function tm(r,u,p,w,M){return bl(u),p=Va(r,u,p,w,void 0,M),w=Ei(),r!==null&&!yr?(xh(r,u,M),mc(r,u,M)):(Gn&&w&&hh(u),u.flags|=1,Er(r,u,p,M),u.child)}function zg(r,u,p,w,M,N){return bl(u),u.updateQueue=null,p=os(u,w,p,M),Hp(r),w=Ei(),r!==null&&!yr?(xh(r,u,N),mc(r,u,N)):(Gn&&w&&hh(u),u.flags|=1,Er(r,u,p,N),u.child)}function V_(r,u,p,w,M){if(bl(u),u.stateNode===null){var N=pn,q=p.contextType;typeof q=="object"&&q!==null&&(N=yi(q)),N=new p(w,N),u.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=Xp,u.stateNode=N,N._reactInternals=u,N=u.stateNode,N.props=w,N.state=u.memoizedState,N.refs={},Of(u),q=p.contextType,N.context=typeof q=="object"&&q!==null?yi(q):pn,N.state=u.memoizedState,q=p.getDerivedStateFromProps,typeof q=="function"&&(pc(u,p,q,w),N.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(q=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),q!==N.state&&Xp.enqueueReplaceState(N,N.state,null),cc(u,w,N,M),au(),N.state=u.memoizedState),typeof N.componentDidMount=="function"&&(u.flags|=4194308),w=!0}else if(r===null){N=u.stateNode;var ie=u.memoizedProps,we=hu(p,ie);N.props=we;var Ze=N.context,st=p.contextType;q=pn,typeof st=="object"&&st!==null&&(q=yi(st));var ut=p.getDerivedStateFromProps;st=typeof ut=="function"||typeof N.getSnapshotBeforeUpdate=="function",ie=u.pendingProps!==ie,st||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(ie||Ze!==q)&&Wp(u,N,w,q),Rs=!1;var We=u.memoizedState;N.state=We,cc(u,w,N,M),au(),Ze=u.memoizedState,ie||We!==Ze||Rs?(typeof ut=="function"&&(pc(u,p,ut,w),Ze=u.memoizedState),(we=Rs||L_(u,p,we,w,We,Ze,q))?(st||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(u.flags|=4194308)):(typeof N.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=w,u.memoizedState=Ze),N.props=w,N.state=Ze,N.context=q,w=we):(typeof N.componentDidMount=="function"&&(u.flags|=4194308),w=!1)}else{N=u.stateNode,ru(r,u),q=u.memoizedProps,st=hu(p,q),N.props=st,ut=u.pendingProps,We=N.context,Ze=p.contextType,we=pn,typeof Ze=="object"&&Ze!==null&&(we=yi(Ze)),ie=p.getDerivedStateFromProps,(Ze=typeof ie=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(q!==ut||We!==we)&&Wp(u,N,w,we),Rs=!1,We=u.memoizedState,N.state=We,cc(u,w,N,M),au();var Ke=u.memoizedState;q!==ut||We!==Ke||Rs||r!==null&&r.dependencies!==null&&ph(r.dependencies)?(typeof ie=="function"&&(pc(u,p,ie,w),Ke=u.memoizedState),(st=Rs||L_(u,p,st,w,We,Ke,we)||r!==null&&r.dependencies!==null&&ph(r.dependencies))?(Ze||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(w,Ke,we),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(w,Ke,we)),typeof N.componentDidUpdate=="function"&&(u.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof N.componentDidUpdate!="function"||q===r.memoizedProps&&We===r.memoizedState||(u.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||q===r.memoizedProps&&We===r.memoizedState||(u.flags|=1024),u.memoizedProps=w,u.memoizedState=Ke),N.props=w,N.state=Ke,N.context=we,w=st):(typeof N.componentDidUpdate!="function"||q===r.memoizedProps&&We===r.memoizedState||(u.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||q===r.memoizedProps&&We===r.memoizedState||(u.flags|=1024),w=!1)}return N=w,kd(r,u),w=(u.flags&128)!==0,N||w?(N=u.stateNode,p=w&&typeof p.getDerivedStateFromError!="function"?null:N.render(),u.flags|=1,r!==null&&w?(u.child=xa(u,r.child,null,M),u.child=xa(u,null,p,M)):Er(r,u,p,M),u.memoizedState=N.state,r=u.child):r=mc(r,u,M),r}function G_(r,u,p,w){return qr(),u.flags|=256,Er(r,u,p,w),u.child}var nm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function im(r){return{baseLanes:r,cachePool:nu()}}function Lg(r,u,p){return r=r!==null?r.childLanes&~p:0,u&&(r|=vo),r}function rm(r,u,p){var w=u.pendingProps,M=!1,N=(u.flags&128)!==0,q;if((q=N)||(q=r!==null&&r.memoizedState===null?!1:(Ki.current&2)!==0),q&&(M=!0,u.flags&=-129),q=(u.flags&32)!==0,u.flags&=-33,r===null){if(Gn){if(M?pa(u):_o(),Gn){var ie=Ri,we;if(we=ie){e:{for(we=ie,ie=ja;we.nodeType!==8;){if(!ie){ie=null;break e}if(we=ms(we.nextSibling),we===null){ie=null;break e}}ie=we}ie!==null?(u.memoizedState={dehydrated:ie,treeContext:Ms!==null?{id:Oa,overflow:is}:null,retryLane:536870912,hydrationErrors:null},we=za(18,null,null,0),we.stateNode=ie,we.return=u,u.child=we,Qi=u,Ri=null,we=!0):we=!1}we||ac(u)}if(ie=u.memoizedState,ie!==null&&(ie=ie.dehydrated,ie!==null))return Nm(ie)?u.lanes=32:u.lanes=536870912,null;Za(u)}return ie=w.children,w=w.fallback,M?(_o(),M=u.mode,ie=Rd({mode:"hidden",children:ie},M),w=gl(w,M,p,null),ie.return=u,w.return=u,ie.sibling=w,u.child=ie,M=u.child,M.memoizedState=im(p),M.childLanes=Lg(r,q,p),u.memoizedState=nm,w):(pa(u),am(u,ie))}if(we=r.memoizedState,we!==null&&(ie=we.dehydrated,ie!==null)){if(N)u.flags&256?(pa(u),u.flags&=-257,u=Ah(r,u,p)):u.memoizedState!==null?(_o(),u.child=r.child,u.flags|=128,u=null):(_o(),M=w.fallback,ie=u.mode,w=Rd({mode:"visible",children:w.children},ie),M=gl(M,ie,p,null),M.flags|=2,w.return=u,M.return=u,w.sibling=M,u.child=w,xa(u,r.child,null,p),w=u.child,w.memoizedState=im(p),w.childLanes=Lg(r,q,p),u.memoizedState=nm,u=M);else if(pa(u),Nm(ie)){if(q=ie.nextSibling&&ie.nextSibling.dataset,q)var Ze=q.dgst;q=Ze,w=Error(d(419)),w.stack="",w.digest=q,Fo({value:w,source:null,stack:null}),u=Ah(r,u,p)}else if(yr||Kc(r,u,p,!1),q=(p&r.childLanes)!==0,yr||q){if(q=li,q!==null&&(w=p&-p,w=(w&42)!==0?1:sn(w),w=(w&(q.suspendedLanes|p))!==0?0:w,w!==0&&w!==we.retryLane))throw we.retryLane=w,Na(r,w),ps(q,r,w),Eh;ie.data==="$?"||Qg(),u=Ah(r,u,p)}else ie.data==="$?"?(u.flags|=192,u.child=r.child,u=null):(r=we.treeContext,Ri=ms(ie.nextSibling),Qi=u,Gn=!0,vl=null,ja=!1,r!==null&&(La[Yr++]=Oa,La[Yr++]=is,La[Yr++]=Ms,Oa=r.id,is=r.overflow,Ms=u),u=am(u,w.children),u.flags|=4096);return u}return M?(_o(),M=w.fallback,ie=u.mode,we=r.child,Ze=we.sibling,w=$r(we,{mode:"hidden",children:w.children}),w.subtreeFlags=we.subtreeFlags&65011712,Ze!==null?M=$r(Ze,M):(M=gl(M,ie,p,null),M.flags|=2),M.return=u,w.return=u,w.sibling=M,u.child=w,w=M,M=u.child,ie=r.child.memoizedState,ie===null?ie=im(p):(we=ie.cachePool,we!==null?(Ze=or._currentValue,we=we.parent!==Ze?{parent:Ze,pool:Ze}:we):we=nu(),ie={baseLanes:ie.baseLanes|p,cachePool:we}),M.memoizedState=ie,M.childLanes=Lg(r,q,p),u.memoizedState=nm,w):(pa(u),p=r.child,r=p.sibling,p=$r(p,{mode:"visible",children:w.children}),p.return=u,p.sibling=null,r!==null&&(q=u.deletions,q===null?(u.deletions=[r],u.flags|=16):q.push(r)),u.child=p,u.memoizedState=null,p)}function am(r,u){return u=Rd({mode:"visible",children:u},r.mode),u.return=r,r.child=u}function Rd(r,u){return r=za(22,r,null,u),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Ah(r,u,p){return xa(u,r.child,null,p),r=am(u,u.pendingProps.children),r.flags|=2,u.memoizedState=null,r}function wa(r,u,p){r.lanes|=u;var w=r.alternate;w!==null&&(w.lanes|=u),Td(r.return,u,p)}function sm(r,u,p,w,M){var N=r.memoizedState;N===null?r.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:M}:(N.isBackwards=u,N.rendering=null,N.renderingStartTime=0,N.last=w,N.tail=p,N.tailMode=M)}function om(r,u,p){var w=u.pendingProps,M=w.revealOrder,N=w.tail;if(Er(r,u,w.children,p),w=Ki.current,(w&2)!==0)w=w&1|2,u.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=u.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&wa(r,p,u);else if(r.tag===19)wa(r,p,u);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===u)break e;for(;r.sibling===null;){if(r.return===null||r.return===u)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}w&=1}switch(bt(Ki,w),M){case"forwards":for(p=u.child,M=null;p!==null;)r=p.alternate,r!==null&&hs(r)===null&&(M=p),p=p.sibling;p=M,p===null?(M=u.child,u.child=null):(M=p.sibling,p.sibling=null),sm(u,!1,M,p,N);break;case"backwards":for(p=null,M=u.child,u.child=null;M!==null;){if(r=M.alternate,r!==null&&hs(r)===null){u.child=M;break}r=M.sibling,M.sibling=p,p=M,M=r}sm(u,!0,p,null,N);break;case"together":sm(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function mc(r,u,p){if(r!==null&&(u.dependencies=r.dependencies),pu|=u.lanes,(p&u.childLanes)===0)if(r!==null){if(Kc(r,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(r!==null&&u.child!==r.child)throw Error(d(153));if(u.child!==null){for(r=u.child,p=$r(r,r.pendingProps),u.child=p,p.return=u;r.sibling!==null;)r=r.sibling,p=p.sibling=$r(r,r.pendingProps),p.return=u;p.sibling=null}return u.child}function lm(r,u){return(r.lanes&u)!==0?!0:(r=r.dependencies,!!(r!==null&&ph(r)))}function kv(r,u,p){switch(u.tag){case 3:fn(u,u.stateNode.containerInfo),Hr(u,or,r.memoizedState.cache),qr();break;case 27:case 5:ya(u);break;case 4:fn(u,u.stateNode.containerInfo);break;case 10:Hr(u,u.type,u.memoizedProps.value);break;case 13:var w=u.memoizedState;if(w!==null)return w.dehydrated!==null?(pa(u),u.flags|=128,null):(p&u.child.childLanes)!==0?rm(r,u,p):(pa(u),r=mc(r,u,p),r!==null?r.sibling:null);pa(u);break;case 19:var M=(r.flags&128)!==0;if(w=(p&u.childLanes)!==0,w||(Kc(r,u,p,!1),w=(p&u.childLanes)!==0),M){if(w)return om(r,u,p);u.flags|=128}if(M=u.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),bt(Ki,Ki.current),w)break;return null;case 22:case 23:return u.lanes=0,U_(r,u,p);case 24:Hr(u,or,r.memoizedState.cache)}return mc(r,u,p)}function Z_(r,u,p){if(r!==null)if(r.memoizedProps!==u.pendingProps)yr=!0;else{if(!lm(r,p)&&(u.flags&128)===0)return yr=!1,kv(r,u,p);yr=(r.flags&131072)!==0}else yr=!1,Gn&&(u.flags&1048576)!==0&&_l(u,Wc,u.index);switch(u.lanes=0,u.tag){case 16:e:{r=u.pendingProps;var w=u.elementType,M=w._init;if(w=M(w._payload),u.type=w,typeof w=="function")vd(w)?(r=hu(w,r),u.tag=1,u=V_(null,u,w,r,p)):(u.tag=0,u=tm(null,u,w,r,p));else{if(w!=null){if(M=w.$$typeof,M===He){u.tag=11,u=j_(null,u,w,r,p);break e}else if(M===Je){u.tag=14,u=B_(null,u,w,r,p);break e}}throw u=un(w)||w,Error(d(306,u,""))}}return u;case 0:return tm(r,u,u.type,u.pendingProps,p);case 1:return w=u.type,M=hu(w,u.pendingProps),V_(r,u,w,M,p);case 3:e:{if(fn(u,u.stateNode.containerInfo),r===null)throw Error(d(387));w=u.pendingProps;var N=u.memoizedState;M=N.element,ru(r,u),cc(u,w,null,p);var q=u.memoizedState;if(w=q.cache,Hr(u,or,w),w!==N.cache&&Sd(u,[or],p,!0),au(),w=q.element,N.isDehydrated)if(N={element:w,isDehydrated:!1,cache:q.cache},u.updateQueue.baseState=N,u.memoizedState=N,u.flags&256){u=G_(r,u,w,p);break e}else if(w!==M){M=Sr(Error(d(424)),u),Fo(M),u=G_(r,u,w,p);break e}else{switch(r=u.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ri=ms(r.firstChild),Qi=u,Gn=!0,vl=null,ja=!0,p=us(u,null,w,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(qr(),w===M){u=mc(r,u,p);break e}Er(r,u,w,p)}u=u.child}return u;case 26:return kd(r,u),r===null?(p=Om(u.type,null,u.pendingProps,null))?u.memoizedState=p:Gn||(p=u.type,r=u.pendingProps,w=Tc(Bt.current).createElement(p),w[Wt]=u,w[tn]=r,ea(w,p,r),Si(w),u.stateNode=w):u.memoizedState=Om(u.type,r.memoizedProps,u.pendingProps,r.memoizedState),null;case 27:return ya(u),r===null&&Gn&&(w=u.stateNode=tp(u.type,u.pendingProps,Bt.current),Qi=u,ja=!0,M=Ri,Sc(u.type)?(zm=M,Ri=ms(w.firstChild)):Ri=M),Er(r,u,u.pendingProps.children,p),kd(r,u),r===null&&(u.flags|=4194304),u.child;case 5:return r===null&&Gn&&((M=w=Ri)&&(w=Bv(w,u.type,u.pendingProps,ja),w!==null?(u.stateNode=w,Qi=u,Ri=ms(w.firstChild),ja=!1,M=!0):M=!1),M||ac(u)),ya(u),M=u.type,N=u.pendingProps,q=r!==null?r.memoizedProps:null,w=N.children,Rm(M,N)?w=null:q!==null&&Rm(M,q)&&(u.flags|=32),u.memoizedState!==null&&(M=Va(r,u,Pi,null,null,p),$._currentValue=M),kd(r,u),Er(r,u,w,p),u.child;case 6:return r===null&&Gn&&((r=p=Ri)&&(p=Fv(p,u.pendingProps,ja),p!==null?(u.stateNode=p,Qi=u,Ri=null,r=!0):r=!1),r||ac(u)),null;case 13:return rm(r,u,p);case 4:return fn(u,u.stateNode.containerInfo),w=u.pendingProps,r===null?u.child=xa(u,null,w,p):Er(r,u,w,p),u.child;case 11:return j_(r,u,u.type,u.pendingProps,p);case 7:return Er(r,u,u.pendingProps,p),u.child;case 8:return Er(r,u,u.pendingProps.children,p),u.child;case 12:return Er(r,u,u.pendingProps.children,p),u.child;case 10:return w=u.pendingProps,Hr(u,u.type,w.value),Er(r,u,w.children,p),u.child;case 9:return M=u.type._context,w=u.pendingProps.children,bl(u),M=yi(M),w=w(M),u.flags|=1,Er(r,u,w,p),u.child;case 14:return B_(r,u,u.type,u.pendingProps,p);case 15:return F_(r,u,u.type,u.pendingProps,p);case 19:return om(r,u,p);case 31:return w=u.pendingProps,p=u.mode,w={mode:w.mode,children:w.children},r===null?(p=Rd(w,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=$r(r.child,w),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return U_(r,u,p);case 24:return bl(u),w=yi(or),r===null?(M=Lf(),M===null&&(M=li,N=xl(),M.pooledCache=N,N.refCount++,N!==null&&(M.pooledCacheLanes|=p),M=N),u.memoizedState={parent:w,cache:M},Of(u),Hr(u,or,M)):((r.lanes&p)!==0&&(ru(r,u),cc(u,null,null,p),au()),M=r.memoizedState,N=u.memoizedState,M.parent!==w?(M={parent:w,cache:w},u.memoizedState=M,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=M),Hr(u,or,w)):(w=N.cache,Hr(u,or,w),w!==M.cache&&Sd(u,[or],p,!0))),Er(r,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(d(156,u.tag))}function El(r){r.flags|=4}function $_(r,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!h(u)){if(u=gr.current,u!==null&&((Zn&4194048)===Zn?Or!==null:(Zn&62914560)!==Zn&&(Zn&536870912)===0||u!==Or))throw ks=mh,ss;r.flags|=8192}}function Id(r,u){u!==null&&(r.flags|=4),r.flags&16384&&(u=r.tag!==22?at():536870912,r.lanes|=u,Fd|=u)}function Pd(r,u){if(!Gn)switch(r.tailMode){case"hidden":u=r.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?r.tail=null:p.sibling=null;break;case"collapsed":p=r.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?u||r.tail===null?r.tail=null:r.tail.sibling=null:w.sibling=null}}function qi(r){var u=r.alternate!==null&&r.alternate.child===r.child,p=0,w=0;if(u)for(var M=r.child;M!==null;)p|=M.lanes|M.childLanes,w|=M.subtreeFlags&65011712,w|=M.flags&65011712,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)p|=M.lanes|M.childLanes,w|=M.subtreeFlags,w|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=w,r.childLanes=p,u}function Rv(r,u,p){var w=u.pendingProps;switch(Qc(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qi(u),null;case 1:return qi(u),null;case 3:return p=u.stateNode,w=null,r!==null&&(w=r.memoizedState.cache),u.memoizedState.cache!==w&&(u.flags|=2048),Cs(or),mi(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(r===null||r.child===null)&&(ba(u)?El(u):r===null||r.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,fh())),qi(u),null;case 26:return p=u.memoizedState,r===null?(El(u),p!==null?(qi(u),$_(u,p)):(qi(u),u.flags&=-16777217)):p?p!==r.memoizedState?(El(u),qi(u),$_(u,p)):(qi(u),u.flags&=-16777217):(r.memoizedProps!==w&&El(u),qi(u),u.flags&=-16777217),null;case 27:sa(u),p=Bt.current;var M=u.type;if(r!==null&&u.stateNode!=null)r.memoizedProps!==w&&El(u);else{if(!w){if(u.stateNode===null)throw Error(d(166));return qi(u),null}r=Pt.current,ba(u)?xd(u):(r=tp(M,w,p),u.stateNode=r,El(u))}return qi(u),null;case 5:if(sa(u),p=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==w&&El(u);else{if(!w){if(u.stateNode===null)throw Error(d(166));return qi(u),null}if(r=Pt.current,ba(u))xd(u);else{switch(M=Tc(Bt.current),r){case 1:r=M.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:r=M.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":r=M.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":r=M.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof w.is=="string"?M.createElement("select",{is:w.is}):M.createElement("select"),w.multiple?r.multiple=!0:w.size&&(r.size=w.size);break;default:r=typeof w.is=="string"?M.createElement(p,{is:w.is}):M.createElement(p)}}r[Wt]=u,r[tn]=w;e:for(M=u.child;M!==null;){if(M.tag===5||M.tag===6)r.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===u)break e;for(;M.sibling===null;){if(M.return===null||M.return===u)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}u.stateNode=r;e:switch(ea(r,p,w),p){case"button":case"input":case"select":case"textarea":r=!!w.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&El(u)}}return qi(u),u.flags&=-16777217,null;case 6:if(r&&u.stateNode!=null)r.memoizedProps!==w&&El(u);else{if(typeof w!="string"&&u.stateNode===null)throw Error(d(166));if(r=Bt.current,ba(u)){if(r=u.stateNode,p=u.memoizedProps,w=null,M=Qi,M!==null)switch(M.tag){case 27:case 5:w=M.memoizedProps}r[Wt]=u,r=!!(r.nodeValue===p||w!==null&&w.suppressHydrationWarning===!0||fy(r.nodeValue,p)),r||ac(u)}else r=Tc(r).createTextNode(w),r[Wt]=u,u.stateNode=r}return qi(u),null;case 13:if(w=u.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=ba(u),w!==null&&w.dehydrated!==null){if(r===null){if(!M)throw Error(d(318));if(M=u.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(d(317));M[Wt]=u}else qr(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;qi(u),M=!1}else M=fh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=M),M=!0;if(!M)return u.flags&256?(Za(u),u):(Za(u),null)}if(Za(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=w!==null,r=r!==null&&r.memoizedState!==null,p){w=u.child,M=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(M=w.alternate.memoizedState.cachePool.pool);var N=null;w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(N=w.memoizedState.cachePool.pool),N!==M&&(w.flags|=2048)}return p!==r&&p&&(u.child.flags|=8192),Id(u,u.updateQueue),qi(u),null;case 4:return mi(),r===null&&cy(u.stateNode.containerInfo),qi(u),null;case 10:return Cs(u.type),qi(u),null;case 19:if(Et(Ki),M=u.memoizedState,M===null)return qi(u),null;if(w=(u.flags&128)!==0,N=M.rendering,N===null)if(w)Pd(M,!1);else{if(Ji!==0||r!==null&&(r.flags&128)!==0)for(r=u.child;r!==null;){if(N=hs(r),N!==null){for(u.flags|=128,Pd(M,!1),r=N.updateQueue,u.updateQueue=r,Id(u,r),u.subtreeFlags=0,r=p,p=u.child;p!==null;)Pf(p,r),p=p.sibling;return bt(Ki,Ki.current&1|2),u.child}r=r.sibling}M.tail!==null&&Li()>qf&&(u.flags|=128,w=!0,Pd(M,!1),u.lanes=4194304)}else{if(!w)if(r=hs(N),r!==null){if(u.flags|=128,w=!0,r=r.updateQueue,u.updateQueue=r,Id(u,r),Pd(M,!0),M.tail===null&&M.tailMode==="hidden"&&!N.alternate&&!Gn)return qi(u),null}else 2*Li()-M.renderingStartTime>qf&&p!==536870912&&(u.flags|=128,w=!0,Pd(M,!1),u.lanes=4194304);M.isBackwards?(N.sibling=u.child,u.child=N):(r=M.last,r!==null?r.sibling=N:u.child=N,M.last=N)}return M.tail!==null?(u=M.tail,M.rendering=u,M.tail=u.sibling,M.renderingStartTime=Li(),u.sibling=null,r=Ki.current,bt(Ki,w?r&1|2:r&1),u):(qi(u),null);case 22:case 23:return Za(u),vh(),w=u.memoizedState!==null,r!==null?r.memoizedState!==null!==w&&(u.flags|=8192):w&&(u.flags|=8192),w?(p&536870912)!==0&&(u.flags&128)===0&&(qi(u),u.subtreeFlags&6&&(u.flags|=8192)):qi(u),p=u.updateQueue,p!==null&&Id(u,p.retryQueue),p=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),w=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(w=u.memoizedState.cachePool.pool),w!==p&&(u.flags|=2048),r!==null&&Et(Ds),null;case 24:return p=null,r!==null&&(p=r.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Cs(or),qi(u),null;case 25:return null;case 30:return null}throw Error(d(156,u.tag))}function Iv(r,u){switch(Qc(u),u.tag){case 1:return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 3:return Cs(or),mi(),r=u.flags,(r&65536)!==0&&(r&128)===0?(u.flags=r&-65537|128,u):null;case 26:case 27:case 5:return sa(u),null;case 13:if(Za(u),r=u.memoizedState,r!==null&&r.dehydrated!==null){if(u.alternate===null)throw Error(d(340));qr()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 19:return Et(Ki),null;case 4:return mi(),null;case 10:return Cs(u.type),null;case 22:case 23:return Za(u),vh(),r!==null&&Et(Ds),r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 24:return Cs(or),null;case 25:return null;default:return null}}function Y_(r,u){switch(Qc(u),u.tag){case 3:Cs(or),mi();break;case 26:case 27:case 5:sa(u);break;case 4:mi();break;case 13:Za(u);break;case 19:Et(Ki);break;case 10:Cs(u.type);break;case 22:case 23:Za(u),vh(),r!==null&&Et(Ds);break;case 24:Cs(or)}}function Mh(r,u){try{var p=u.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var M=w.next;p=M;do{if((p.tag&r)===r){w=void 0;var N=p.create,q=p.inst;w=N(),q.destroy=w}p=p.next}while(p!==M)}}catch(ie){ki(u,u.return,ie)}}function Al(r,u,p){try{var w=u.updateQueue,M=w!==null?w.lastEffect:null;if(M!==null){var N=M.next;w=N;do{if((w.tag&r)===r){var q=w.inst,ie=q.destroy;if(ie!==void 0){q.destroy=void 0,M=u;var we=p,Ze=ie;try{Ze()}catch(st){ki(M,we,st)}}}w=w.next}while(w!==N)}}catch(st){ki(u,u.return,st)}}function Og(r){var u=r.updateQueue;if(u!==null){var p=r.stateNode;try{Bf(u,p)}catch(w){ki(r,r.return,w)}}}function du(r,u,p){p.props=hu(r.type,r.memoizedProps),p.state=r.memoizedState;try{p.componentWillUnmount()}catch(w){ki(r,u,w)}}function gc(r,u){try{var p=r.ref;if(p!==null){switch(r.tag){case 26:case 27:case 5:var w=r.stateNode;break;case 30:w=r.stateNode;break;default:w=r.stateNode}typeof p=="function"?r.refCleanup=p(w):p.current=w}}catch(M){ki(r,u,M)}}function Ml(r,u){var p=r.ref,w=r.refCleanup;if(p!==null)if(typeof w=="function")try{w()}catch(M){ki(r,u,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(M){ki(r,u,M)}else p.current=null}function q_(r){var u=r.type,p=r.memoizedProps,w=r.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":p.autoFocus&&w.focus();break e;case"img":p.src?w.src=p.src:p.srcSet&&(w.srcset=p.srcSet)}}catch(M){ki(r,r.return,M)}}function jg(r,u,p){try{var w=r.stateNode;py(w,r.type,p,u),w[tn]=u}catch(M){ki(r,r.return,M)}}function H_(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Sc(r.type)||r.tag===4}function Bg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||H_(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Sc(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Fg(r,u,p){var w=r.tag;if(w===5||w===6)r=r.stateNode,u?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(r,u):(u=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,u.appendChild(r),p=p._reactRootContainer,p!=null||u.onclick!==null||(u.onclick=Wd));else if(w!==4&&(w===27&&Sc(r.type)&&(p=r.stateNode,u=null),r=r.child,r!==null))for(Fg(r,u,p),r=r.sibling;r!==null;)Fg(r,u,p),r=r.sibling}function cm(r,u,p){var w=r.tag;if(w===5||w===6)r=r.stateNode,u?p.insertBefore(r,u):p.appendChild(r);else if(w!==4&&(w===27&&Sc(r.type)&&(p=r.stateNode),r=r.child,r!==null))for(cm(r,u,p),r=r.sibling;r!==null;)cm(r,u,p),r=r.sibling}function um(r){var u=r.stateNode,p=r.memoizedProps;try{for(var w=r.type,M=u.attributes;M.length;)u.removeAttributeNode(M[0]);ea(u,w,p),u[Wt]=r,u[tn]=p}catch(N){ki(r,r.return,N)}}var yc=!1,ur=!1,Ch=!1,X_=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function Nd(r,u){if(r=r.containerInfo,km=Se,r=md(r),ih(r)){if("selectionStart"in r)var p={start:r.selectionStart,end:r.selectionEnd};else e:{p=(p=r.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var M=w.anchorOffset,N=w.focusNode;w=w.focusOffset;try{p.nodeType,N.nodeType}catch{p=null;break e}var q=0,ie=-1,we=-1,Ze=0,st=0,ut=r,We=null;t:for(;;){for(var Ke;ut!==p||M!==0&&ut.nodeType!==3||(ie=q+M),ut!==N||w!==0&&ut.nodeType!==3||(we=q+w),ut.nodeType===3&&(q+=ut.nodeValue.length),(Ke=ut.firstChild)!==null;)We=ut,ut=Ke;for(;;){if(ut===r)break t;if(We===p&&++Ze===M&&(ie=q),We===N&&++st===w&&(we=q),(Ke=ut.nextSibling)!==null)break;ut=We,We=ut.parentNode}ut=Ke}p=ie===-1||we===-1?null:{start:ie,end:we}}else p=null}p=p||{start:0,end:0}}else p=null;for($a={focusedElem:r,selectionRange:p},Se=!1,Cn=u;Cn!==null;)if(u=Cn,r=u.child,(u.subtreeFlags&1024)!==0&&r!==null)r.return=u,Cn=r;else for(;Cn!==null;){switch(u=Cn,N=u.alternate,r=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&N!==null){r=void 0,p=u,M=N.memoizedProps,N=N.memoizedState,w=p.stateNode;try{var cn=hu(p.type,M,p.elementType===p.type);r=w.getSnapshotBeforeUpdate(cn,N),w.__reactInternalSnapshotBeforeUpdate=r}catch(rn){ki(p,p.return,rn)}}break;case 3:if((r&1024)!==0){if(r=u.stateNode.containerInfo,p=r.nodeType,p===9)Pm(r);else if(p===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Pm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(d(163))}if(r=u.sibling,r!==null){r.return=u.return,Cn=r;break}Cn=u.return}}function Ug(r,u,p){var w=p.flags;switch(p.tag){case 0:case 11:case 15:ds(r,p),w&4&&Mh(5,p);break;case 1:if(ds(r,p),w&4)if(r=p.stateNode,u===null)try{r.componentDidMount()}catch(q){ki(p,p.return,q)}else{var M=hu(p.type,u.memoizedProps);u=u.memoizedState;try{r.componentDidUpdate(M,u,r.__reactInternalSnapshotBeforeUpdate)}catch(q){ki(p,p.return,q)}}w&64&&Og(p),w&512&&gc(p,p.return);break;case 3:if(ds(r,p),w&64&&(r=p.updateQueue,r!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=p.child.stateNode;break;case 1:u=p.child.stateNode}try{Bf(r,u)}catch(q){ki(p,p.return,q)}}break;case 27:u===null&&w&4&&um(p);case 26:case 5:ds(r,p),u===null&&w&4&&q_(p),w&512&&gc(p,p.return);break;case 12:ds(r,p);break;case 13:ds(r,p),w&4&&zd(r,p),w&64&&(r=p.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(p=ny.bind(null,p),y0(r,p))));break;case 22:if(w=p.memoizedState!==null||yc,!w){u=u!==null&&u.memoizedState!==null||ur,M=yc;var N=ur;yc=w,(ur=u)&&!N?_c(r,p,(p.subtreeFlags&8772)!==0):ds(r,p),yc=M,ur=N}break;case 30:break;default:ds(r,p)}}function Uf(r){var u=r.alternate;u!==null&&(r.alternate=null,Uf(u)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(u=r.stateNode,u!==null&&St(u)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Di=null,Jr=!1;function Cl(r,u,p){for(p=p.child;p!==null;)Vg(r,u,p),p=p.sibling}function Vg(r,u,p){if(Oi&&typeof Oi.onCommitFiberUnmount=="function")try{Oi.onCommitFiberUnmount(la,p)}catch{}switch(p.tag){case 26:ur||Ml(p,u),Cl(r,u,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:ur||Ml(p,u);var w=Di,M=Jr;Sc(p.type)&&(Di=p.stateNode,Jr=!1),Cl(r,u,p),xu(p.stateNode),Di=w,Jr=M;break;case 5:ur||Ml(p,u);case 6:if(w=Di,M=Jr,Di=null,Cl(r,u,p),Di=w,Jr=M,Di!==null)if(Jr)try{(Di.nodeType===9?Di.body:Di.nodeName==="HTML"?Di.ownerDocument.body:Di).removeChild(p.stateNode)}catch(N){ki(p,u,N)}else try{Di.removeChild(p.stateNode)}catch(N){ki(p,u,N)}break;case 18:Di!==null&&(Jr?(r=Di,yy(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,p.stateNode),Cr(r)):yy(Di,p.stateNode));break;case 4:w=Di,M=Jr,Di=p.stateNode.containerInfo,Jr=!0,Cl(r,u,p),Di=w,Jr=M;break;case 0:case 11:case 14:case 15:ur||Al(2,p,u),ur||Al(4,p,u),Cl(r,u,p);break;case 1:ur||(Ml(p,u),w=p.stateNode,typeof w.componentWillUnmount=="function"&&du(p,u,w)),Cl(r,u,p);break;case 21:Cl(r,u,p);break;case 22:ur=(w=ur)||p.memoizedState!==null,Cl(r,u,p),ur=w;break;default:Cl(r,u,p)}}function zd(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Cr(r)}catch(p){ki(u,u.return,p)}}function Gg(r){switch(r.tag){case 13:case 19:var u=r.stateNode;return u===null&&(u=r.stateNode=new X_),u;case 22:return r=r.stateNode,u=r._retryCache,u===null&&(u=r._retryCache=new X_),u;default:throw Error(d(435,r.tag))}}function fu(r,u){var p=Gg(r);u.forEach(function(w){var M=Ov.bind(null,r,w);p.has(w)||(p.add(w),w.then(M,M))})}function Ta(r,u){var p=u.deletions;if(p!==null)for(var w=0;w<p.length;w++){var M=p[w],N=r,q=u,ie=q;e:for(;ie!==null;){switch(ie.tag){case 27:if(Sc(ie.type)){Di=ie.stateNode,Jr=!1;break e}break;case 5:Di=ie.stateNode,Jr=!1;break e;case 3:case 4:Di=ie.stateNode.containerInfo,Jr=!0;break e}ie=ie.return}if(Di===null)throw Error(d(160));Vg(N,q,M),Di=null,Jr=!1,N=M.alternate,N!==null&&(N.return=null),M.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Ld(u,r),u=u.sibling}var Sa=null;function Ld(r,u){var p=r.alternate,w=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ta(u,r),zs(r),w&4&&(Al(3,r,r.return),Mh(3,r),Al(5,r,r.return));break;case 1:Ta(u,r),zs(r),w&512&&(ur||p===null||Ml(p,p.return)),w&64&&yc&&(r=r.updateQueue,r!==null&&(w=r.callbacks,w!==null&&(p=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=p===null?w:p.concat(w))));break;case 26:var M=Sa;if(Ta(u,r),zs(r),w&512&&(ur||p===null||Ml(p,p.return)),w&4){var N=p!==null?p.memoizedState:null;if(w=r.memoizedState,p===null)if(w===null)if(r.stateNode===null){e:{w=r.type,p=r.memoizedProps,M=M.ownerDocument||M;t:switch(w){case"title":N=M.getElementsByTagName("title")[0],(!N||N[io]||N[Wt]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=M.createElement(w),M.head.insertBefore(N,M.querySelector("head > title"))),ea(N,w,p),N[Wt]=r,Si(N),w=N;break e;case"link":var q=s("link","href",M).get(w+(p.href||""));if(q){for(var ie=0;ie<q.length;ie++)if(N=q[ie],N.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&N.getAttribute("rel")===(p.rel==null?null:p.rel)&&N.getAttribute("title")===(p.title==null?null:p.title)&&N.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){q.splice(ie,1);break t}}N=M.createElement(w),ea(N,w,p),M.head.appendChild(N);break;case"meta":if(q=s("meta","content",M).get(w+(p.content||""))){for(ie=0;ie<q.length;ie++)if(N=q[ie],N.getAttribute("content")===(p.content==null?null:""+p.content)&&N.getAttribute("name")===(p.name==null?null:p.name)&&N.getAttribute("property")===(p.property==null?null:p.property)&&N.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&N.getAttribute("charset")===(p.charSet==null?null:p.charSet)){q.splice(ie,1);break t}}N=M.createElement(w),ea(N,w,p),M.head.appendChild(N);break;default:throw Error(d(468,w))}N[Wt]=r,Si(N),w=N}r.stateNode=w}else t(M,r.type,r.stateNode);else r.stateNode=Kd(M,w,r.memoizedProps);else N!==w?(N===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):N.count--,w===null?t(M,r.type,r.stateNode):Kd(M,w,r.memoizedProps)):w===null&&r.stateNode!==null&&jg(r,r.memoizedProps,p.memoizedProps)}break;case 27:Ta(u,r),zs(r),w&512&&(ur||p===null||Ml(p,p.return)),p!==null&&w&4&&jg(r,r.memoizedProps,p.memoizedProps);break;case 5:if(Ta(u,r),zs(r),w&512&&(ur||p===null||Ml(p,p.return)),r.flags&32){M=r.stateNode;try{oo(M,"")}catch(Ke){ki(r,r.return,Ke)}}w&4&&r.stateNode!=null&&(M=r.memoizedProps,jg(r,M,p!==null?p.memoizedProps:M)),w&1024&&(Ch=!0);break;case 6:if(Ta(u,r),zs(r),w&4){if(r.stateNode===null)throw Error(d(162));w=r.memoizedProps,p=r.stateNode;try{p.nodeValue=w}catch(Ke){ki(r,r.return,Ke)}}break;case 3:if(Bm=null,M=Sa,Sa=Lm(u.containerInfo),Ta(u,r),Sa=M,zs(r),w&4&&p!==null&&p.memoizedState.isDehydrated)try{Cr(u.containerInfo)}catch(Ke){ki(r,r.return,Ke)}Ch&&(Ch=!1,Zg(r));break;case 4:w=Sa,Sa=Lm(r.stateNode.containerInfo),Ta(u,r),zs(r),Sa=w;break;case 12:Ta(u,r),zs(r);break;case 13:Ta(u,r),zs(r),r.child.flags&8192&&r.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(dm=Li()),w&4&&(w=r.updateQueue,w!==null&&(r.updateQueue=null,fu(r,w)));break;case 22:M=r.memoizedState!==null;var we=p!==null&&p.memoizedState!==null,Ze=yc,st=ur;if(yc=Ze||M,ur=st||we,Ta(u,r),ur=st,yc=Ze,zs(r),w&8192)e:for(u=r.stateNode,u._visibility=M?u._visibility&-2:u._visibility|1,M&&(p===null||we||yc||ur||Dh(r)),p=null,u=r;;){if(u.tag===5||u.tag===26){if(p===null){we=p=u;try{if(N=we.stateNode,M)q=N.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ie=we.stateNode;var ut=we.memoizedProps.style,We=ut!=null&&ut.hasOwnProperty("display")?ut.display:null;ie.style.display=We==null||typeof We=="boolean"?"":(""+We).trim()}}catch(Ke){ki(we,we.return,Ke)}}}else if(u.tag===6){if(p===null){we=u;try{we.stateNode.nodeValue=M?"":we.memoizedProps}catch(Ke){ki(we,we.return,Ke)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===r)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break e;for(;u.sibling===null;){if(u.return===null||u.return===r)break e;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}w&4&&(w=r.updateQueue,w!==null&&(p=w.retryQueue,p!==null&&(w.retryQueue=null,fu(r,p))));break;case 19:Ta(u,r),zs(r),w&4&&(w=r.updateQueue,w!==null&&(r.updateQueue=null,fu(r,w)));break;case 30:break;case 21:break;default:Ta(u,r),zs(r)}}function zs(r){var u=r.flags;if(u&2){try{for(var p,w=r.return;w!==null;){if(H_(w)){p=w;break}w=w.return}if(p==null)throw Error(d(160));switch(p.tag){case 27:var M=p.stateNode,N=Bg(r);cm(r,N,M);break;case 5:var q=p.stateNode;p.flags&32&&(oo(q,""),p.flags&=-33);var ie=Bg(r);cm(r,ie,q);break;case 3:case 4:var we=p.stateNode.containerInfo,Ze=Bg(r);Fg(r,Ze,we);break;default:throw Error(d(161))}}catch(st){ki(r,r.return,st)}r.flags&=-3}u&4096&&(r.flags&=-4097)}function Zg(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var u=r;Zg(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),r=r.sibling}}function ds(r,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Ug(r,u.alternate,u),u=u.sibling}function Dh(r){for(r=r.child;r!==null;){var u=r;switch(u.tag){case 0:case 11:case 14:case 15:Al(4,u,u.return),Dh(u);break;case 1:Ml(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&du(u,u.return,p),Dh(u);break;case 27:xu(u.stateNode);case 26:case 5:Ml(u,u.return),Dh(u);break;case 22:u.memoizedState===null&&Dh(u);break;case 30:Dh(u);break;default:Dh(u)}r=r.sibling}}function _c(r,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var w=u.alternate,M=r,N=u,q=N.flags;switch(N.tag){case 0:case 11:case 15:_c(M,N,p),Mh(4,N);break;case 1:if(_c(M,N,p),w=N,M=w.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Ze){ki(w,w.return,Ze)}if(w=N,M=w.updateQueue,M!==null){var ie=w.stateNode;try{var we=M.shared.hiddenCallbacks;if(we!==null)for(M.shared.hiddenCallbacks=null,M=0;M<we.length;M++)jf(we[M],ie)}catch(Ze){ki(w,w.return,Ze)}}p&&q&64&&Og(N),gc(N,N.return);break;case 27:um(N);case 26:case 5:_c(M,N,p),p&&w===null&&q&4&&q_(N),gc(N,N.return);break;case 12:_c(M,N,p);break;case 13:_c(M,N,p),p&&q&4&&zd(M,N);break;case 22:N.memoizedState===null&&_c(M,N,p),gc(N,N.return);break;case 30:break;default:_c(M,N,p)}u=u.sibling}}function kh(r,u){var p=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),r=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(r=u.memoizedState.cachePool.pool),r!==p&&(r!=null&&r.refCount++,p!=null&&sc(p))}function Vf(r,u){r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&sc(r))}function Wo(r,u,p,w){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)$g(r,u,p,w),u=u.sibling}function $g(r,u,p,w){var M=u.flags;switch(u.tag){case 0:case 11:case 15:Wo(r,u,p,w),M&2048&&Mh(9,u);break;case 1:Wo(r,u,p,w);break;case 3:Wo(r,u,p,w),M&2048&&(r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&sc(r)));break;case 12:if(M&2048){Wo(r,u,p,w),r=u.stateNode;try{var N=u.memoizedProps,q=N.id,ie=N.onPostCommit;typeof ie=="function"&&ie(q,u.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(we){ki(u,u.return,we)}}else Wo(r,u,p,w);break;case 13:Wo(r,u,p,w);break;case 23:break;case 22:N=u.stateNode,q=u.alternate,u.memoizedState!==null?N._visibility&2?Wo(r,u,p,w):Gf(r,u):N._visibility&2?Wo(r,u,p,w):(N._visibility|=2,Od(r,u,p,w,(u.subtreeFlags&10256)!==0)),M&2048&&kh(q,u);break;case 24:Wo(r,u,p,w),M&2048&&Vf(u.alternate,u);break;default:Wo(r,u,p,w)}}function Od(r,u,p,w,M){for(M=M&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var N=r,q=u,ie=p,we=w,Ze=q.flags;switch(q.tag){case 0:case 11:case 15:Od(N,q,ie,we,M),Mh(8,q);break;case 23:break;case 22:var st=q.stateNode;q.memoizedState!==null?st._visibility&2?Od(N,q,ie,we,M):Gf(N,q):(st._visibility|=2,Od(N,q,ie,we,M)),M&&Ze&2048&&kh(q.alternate,q);break;case 24:Od(N,q,ie,we,M),M&&Ze&2048&&Vf(q.alternate,q);break;default:Od(N,q,ie,we,M)}u=u.sibling}}function Gf(r,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=r,w=u,M=w.flags;switch(w.tag){case 22:Gf(p,w),M&2048&&kh(w.alternate,w);break;case 24:Gf(p,w),M&2048&&Vf(w.alternate,w);break;default:Gf(p,w)}u=u.sibling}}var Zf=8192;function jd(r){if(r.subtreeFlags&Zf)for(r=r.child;r!==null;)W_(r),r=r.sibling}function W_(r){switch(r.tag){case 26:jd(r),r.flags&Zf&&r.memoizedState!==null&&S(Sa,r.memoizedState,r.memoizedProps);break;case 5:jd(r);break;case 3:case 4:var u=Sa;Sa=Lm(r.stateNode.containerInfo),jd(r),Sa=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Zf,Zf=16777216,jd(r),Zf=u):jd(r));break;default:jd(r)}}function Rh(r){var u=r.alternate;if(u!==null&&(r=u.child,r!==null)){u.child=null;do u=r.sibling,r.sibling=null,r=u;while(r!==null)}}function $f(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var w=u[p];Cn=w,K_(w,r)}Rh(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Q_(r),r=r.sibling}function Q_(r){switch(r.tag){case 0:case 11:case 15:$f(r),r.flags&2048&&Al(9,r,r.return);break;case 3:$f(r);break;case 12:$f(r);break;case 22:var u=r.stateNode;r.memoizedState!==null&&u._visibility&2&&(r.return===null||r.return.tag!==13)?(u._visibility&=-3,Yf(r)):$f(r);break;default:$f(r)}}function Yf(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var w=u[p];Cn=w,K_(w,r)}Rh(r)}for(r=r.child;r!==null;){switch(u=r,u.tag){case 0:case 11:case 15:Al(8,u,u.return),Yf(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Yf(u));break;default:Yf(u)}r=r.sibling}}function K_(r,u){for(;Cn!==null;){var p=Cn;switch(p.tag){case 0:case 11:case 15:Al(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var w=p.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:sc(p.memoizedState.cache)}if(w=p.child,w!==null)w.return=p,Cn=w;else e:for(p=r;Cn!==null;){w=Cn;var M=w.sibling,N=w.return;if(Uf(w),w===p){Cn=null;break e}if(M!==null){M.return=N,Cn=M;break e}Cn=N}}}var J_={getCacheForType:function(r){var u=yi(or),p=u.data.get(r);return p===void 0&&(p=r(),u.data.set(r,p)),p}},Pv=typeof WeakMap=="function"?WeakMap:Map,ii=0,li=null,Dn=null,Zn=0,hi=0,fs=null,vc=!1,Bd=!1,Yg=!1,Ls=0,Ji=0,pu=0,Ih=0,qg=0,vo=0,Fd=0,Ud=null,Ea=null,hm=!1,dm=0,qf=1/0,fm=null,Qo=null,ma=0,bc=null,Vd=null,Gd=0,Hg=0,pm=null,e0=null,Hf=0,Ph=null;function Kn(){if((ii&2)!==0&&Zn!==0)return Zn&-Zn;if(Ue.T!==null){var r=pr;return r!==0?r:oy()}return ar()}function mm(){vo===0&&(vo=(Zn&536870912)===0||Gn?ht():536870912);var r=gr.current;return r!==null&&(r.flags|=32),vo}function ps(r,u,p){(r===li&&(hi===2||hi===9)||r.cancelPendingCommit!==null)&&($d(r,0),xc(r,Zn,vo,!1)),Pe(r,p),((ii&2)===0||r!==li)&&(r===li&&((ii&2)===0&&(Ih|=p),Ji===4&&xc(r,Zn,vo,!1)),Ko(r))}function Xg(r,u,p){if((ii&6)!==0)throw Error(d(327));var w=!p&&(u&124)===0&&(u&r.expiredLanes)===0||Re(r,u),M=w?zv(r,u):Kg(r,u,!0),N=w;do{if(M===0){Bd&&!w&&xc(r,u,0,!1);break}else{if(p=r.current.alternate,N&&!Zd(p)){M=Kg(r,u,!1),N=!1;continue}if(M===2){if(N=u,r.errorRecoveryDisabledLanes&N)var q=0;else q=r.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){u=q;e:{var ie=r;M=Ud;var we=ie.current.memoizedState.isDehydrated;if(we&&($d(ie,q).flags|=256),q=Kg(ie,q,!1),q!==2){if(Yg&&!we){ie.errorRecoveryDisabledLanes|=N,Ih|=N,M=4;break e}N=Ea,Ea=M,N!==null&&(Ea===null?Ea=N:Ea.push.apply(Ea,N))}M=q}if(N=!1,M!==2)continue}}if(M===1){$d(r,0),xc(r,u,0,!0);break}e:{switch(w=r,N=M,N){case 0:case 1:throw Error(d(345));case 4:if((u&4194048)!==u)break;case 6:xc(w,u,vo,!vc);break e;case 2:Ea=null;break;case 3:case 5:break;default:throw Error(d(329))}if((u&62914560)===u&&(M=dm+300-Li(),10<M)){if(xc(w,u,vo,!vc),Fe(w,0,!0)!==0)break e;w.timeoutHandle=my(gm.bind(null,w,p,Ea,fm,hm,u,vo,Ih,Fd,vc,N,2,-0,0),M);break e}gm(w,p,Ea,fm,hm,u,vo,Ih,Fd,vc,N,0,-0,0)}}break}while(!0);Ko(r)}function gm(r,u,p,w,M,N,q,ie,we,Ze,st,ut,We,Ke){if(r.timeoutHandle=-1,ut=u.subtreeFlags,(ut&8192||(ut&16785408)===16785408)&&(g={stylesheets:null,count:0,unsuspend:x},W_(u),ut=A(),ut!==null)){r.cancelPendingCommit=ut(Yd.bind(null,r,u,N,p,w,M,q,ie,we,st,1,We,Ke)),xc(r,N,q,!Ze);return}Yd(r,u,N,p,w,M,q,ie,we)}function Zd(r){for(var u=r;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var w=0;w<p.length;w++){var M=p[w],N=M.getSnapshot;M=M.value;try{if(!ua(N(),M))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function xc(r,u,p,w){u&=~qg,u&=~Ih,r.suspendedLanes|=u,r.pingedLanes&=~u,w&&(r.warmLanes|=u),w=r.expirationTimes;for(var M=u;0<M;){var N=31-Ae(M),q=1<<N;w[N]=-1,M&=~q}p!==0&&vn(r,p,u)}function ym(){return(ii&6)===0?(Os(0),!1):!0}function Wg(){if(Dn!==null){if(hi===0)var r=Dn.return;else r=Dn,rs=Ba=null,$o(r),ui=null,Ui=0,r=Dn;for(;r!==null;)Y_(r.alternate,r),r=r.return;Dn=null}}function $d(r,u){var p=r.timeoutHandle;p!==-1&&(r.timeoutHandle=-1,jv(p)),p=r.cancelPendingCommit,p!==null&&(r.cancelPendingCommit=null,p()),Wg(),li=r,Dn=p=$r(r.current,null),Zn=u,hi=0,fs=null,vc=!1,Bd=Re(r,u),Yg=!1,Fd=vo=qg=Ih=pu=Ji=0,Ea=Ud=null,hm=!1,(u&8)!==0&&(u|=u&32);var w=r.entangledLanes;if(w!==0)for(r=r.entanglements,w&=u;0<w;){var M=31-Ae(w),N=1<<M;u|=r[M],w&=~N}return Ls=u,rc(),p}function t0(r,u){wn=null,Ue.H=Qr,u===Vo||u===Ct?(u=yh(),hi=3):u===ss?(u=yh(),hi=4):hi=u===Eh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,fs=u,Dn===null&&(Ji=1,Kp(r,Sr(u,r.current)))}function n0(){var r=Ue.H;return Ue.H=Qr,r===null?Qr:r}function i0(){var r=Ue.A;return Ue.A=J_,r}function Qg(){Ji=4,vc||(Zn&4194048)!==Zn&&gr.current!==null||(Bd=!0),(pu&134217727)===0&&(Ih&134217727)===0||li===null||xc(li,Zn,vo,!1)}function Kg(r,u,p){var w=ii;ii|=2;var M=n0(),N=i0();(li!==r||Zn!==u)&&(fm=null,$d(r,u)),u=!1;var q=Ji;e:do try{if(hi!==0&&Dn!==null){var ie=Dn,we=fs;switch(hi){case 8:Wg(),q=6;break e;case 3:case 2:case 9:case 6:gr.current===null&&(u=!0);var Ze=hi;if(hi=0,fs=null,mu(r,ie,we,Ze),p&&Bd){q=0;break e}break;default:Ze=hi,hi=0,fs=null,mu(r,ie,we,Ze)}}Nv(),q=Ji;break}catch(st){t0(r,st)}while(!0);return u&&r.shellSuspendCounter++,rs=Ba=null,ii=w,Ue.H=M,Ue.A=N,Dn===null&&(li=null,Zn=0,rc()),q}function Nv(){for(;Dn!==null;)r0(Dn)}function zv(r,u){var p=ii;ii|=2;var w=n0(),M=i0();li!==r||Zn!==u?(fm=null,qf=Li()+500,$d(r,u)):Bd=Re(r,u);e:do try{if(hi!==0&&Dn!==null){u=Dn;var N=fs;t:switch(hi){case 1:hi=0,fs=null,mu(r,u,N,1);break;case 2:case 9:if(gh(N)){hi=0,fs=null,Jg(u);break}u=function(){hi!==2&&hi!==9||li!==r||(hi=7),Ko(r)},N.then(u,u);break e;case 3:hi=7;break e;case 4:hi=5;break e;case 7:gh(N)?(hi=0,fs=null,Jg(u)):(hi=0,fs=null,mu(r,u,N,7));break;case 5:var q=null;switch(Dn.tag){case 26:q=Dn.memoizedState;case 5:case 27:var ie=Dn;if(!q||h(q)){hi=0,fs=null;var we=ie.sibling;if(we!==null)Dn=we;else{var Ze=ie.return;Ze!==null?(Dn=Ze,Xf(Ze)):Dn=null}break t}}hi=0,fs=null,mu(r,u,N,5);break;case 6:hi=0,fs=null,mu(r,u,N,6);break;case 8:Wg(),Ji=6;break e;default:throw Error(d(462))}}Lv();break}catch(st){t0(r,st)}while(!0);return rs=Ba=null,Ue.H=w,Ue.A=M,ii=p,Dn!==null?0:(li=null,Zn=0,rc(),Ji)}function Lv(){for(;Dn!==null&&!Nn();)r0(Dn)}function r0(r){var u=Z_(r.alternate,r,Ls);r.memoizedProps=r.pendingProps,u===null?Xf(r):Dn=u}function Jg(r){var u=r,p=u.alternate;switch(u.tag){case 15:case 0:u=zg(p,u,u.pendingProps,u.type,void 0,Zn);break;case 11:u=zg(p,u,u.pendingProps,u.type.render,u.ref,Zn);break;case 5:$o(u);default:Y_(p,u),u=Dn=Pf(u,Ls),u=Z_(p,u,Ls)}r.memoizedProps=r.pendingProps,u===null?Xf(r):Dn=u}function mu(r,u,p,w){rs=Ba=null,$o(u),ui=null,Ui=0;var M=u.return;try{if(Dv(r,M,u,p,Zn)){Ji=1,Kp(r,Sr(p,r.current)),Dn=null;return}}catch(N){if(M!==null)throw Dn=M,N;Ji=1,Kp(r,Sr(p,r.current)),Dn=null;return}u.flags&32768?(Gn||w===1?r=!0:Bd||(Zn&536870912)!==0?r=!1:(vc=r=!0,(w===2||w===9||w===3||w===6)&&(w=gr.current,w!==null&&w.tag===13&&(w.flags|=16384))),wc(u,r)):Xf(u)}function Xf(r){var u=r;do{if((u.flags&32768)!==0){wc(u,vc);return}r=u.return;var p=Rv(u.alternate,u,Ls);if(p!==null){Dn=p;return}if(u=u.sibling,u!==null){Dn=u;return}Dn=u=r}while(u!==null);Ji===0&&(Ji=5)}function wc(r,u){do{var p=Iv(r.alternate,r);if(p!==null){p.flags&=32767,Dn=p;return}if(p=r.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(r=r.sibling,r!==null)){Dn=r;return}Dn=r=p}while(r!==null);Ji=6,Dn=null}function Yd(r,u,p,w,M,N,q,ie,we){r.cancelPendingCommit=null;do _m();while(ma!==0);if((ii&6)!==0)throw Error(d(327));if(u!==null){if(u===r.current)throw Error(d(177));if(N=u.lanes|u.childLanes,N|=ic,en(r,p,N,q,ie,we),r===li&&(Dn=li=null,Zn=0),Vd=u,bc=r,Gd=p,Hg=N,pm=M,e0=w,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,o0(Fr,function(){return ey(),null})):(r.callbackNode=null,r.callbackPriority=0),w=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||w){w=Ue.T,Ue.T=null,M=ft.p,ft.p=2,q=ii,ii|=4;try{Nd(r,u,p)}finally{ii=q,ft.p=M,Ue.T=w}}ma=1,Nh(),Wf(),Qf()}}function Nh(){if(ma===1){ma=0;var r=bc,u=Vd,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=Ue.T,Ue.T=null;var w=ft.p;ft.p=2;var M=ii;ii|=4;try{Ld(u,r);var N=$a,q=md(r.containerInfo),ie=N.focusedElem,we=N.selectionRange;if(q!==ie&&ie&&ie.ownerDocument&&zn(ie.ownerDocument.documentElement,ie)){if(we!==null&&ih(ie)){var Ze=we.start,st=we.end;if(st===void 0&&(st=Ze),"selectionStart"in ie)ie.selectionStart=Ze,ie.selectionEnd=Math.min(st,ie.value.length);else{var ut=ie.ownerDocument||document,We=ut&&ut.defaultView||window;if(We.getSelection){var Ke=We.getSelection(),cn=ie.textContent.length,rn=Math.min(we.start,cn),ci=we.end===void 0?rn:Math.min(we.end,cn);!Ke.extend&&rn>ci&&(q=ci,ci=rn,rn=q);var ze=fo(ie,rn),Ce=fo(ie,ci);if(ze&&Ce&&(Ke.rangeCount!==1||Ke.anchorNode!==ze.node||Ke.anchorOffset!==ze.offset||Ke.focusNode!==Ce.node||Ke.focusOffset!==Ce.offset)){var $e=ut.createRange();$e.setStart(ze.node,ze.offset),Ke.removeAllRanges(),rn>ci?(Ke.addRange($e),Ke.extend(Ce.node,Ce.offset)):($e.setEnd(Ce.node,Ce.offset),Ke.addRange($e))}}}}for(ut=[],Ke=ie;Ke=Ke.parentNode;)Ke.nodeType===1&&ut.push({element:Ke,left:Ke.scrollLeft,top:Ke.scrollTop});for(typeof ie.focus=="function"&&ie.focus(),ie=0;ie<ut.length;ie++){var ct=ut[ie];ct.element.scrollLeft=ct.left,ct.element.scrollTop=ct.top}}Se=!!km,$a=km=null}finally{ii=M,ft.p=w,Ue.T=p}}r.current=u,ma=2}}function Wf(){if(ma===2){ma=0;var r=bc,u=Vd,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=Ue.T,Ue.T=null;var w=ft.p;ft.p=2;var M=ii;ii|=4;try{Ug(r,u.alternate,u)}finally{ii=M,ft.p=w,Ue.T=p}}ma=3}}function Qf(){if(ma===4||ma===3){ma=0,Br();var r=bc,u=Vd,p=Gd,w=e0;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?ma=5:(ma=0,Vd=bc=null,a0(r,r.pendingLanes));var M=r.pendingLanes;if(M===0&&(Qo=null),ni(p),u=u.stateNode,Oi&&typeof Oi.onCommitFiberRoot=="function")try{Oi.onCommitFiberRoot(la,u,void 0,(u.current.flags&128)===128)}catch{}if(w!==null){u=Ue.T,M=ft.p,ft.p=2,Ue.T=null;try{for(var N=r.onRecoverableError,q=0;q<w.length;q++){var ie=w[q];N(ie.value,{componentStack:ie.stack})}}finally{Ue.T=u,ft.p=M}}(Gd&3)!==0&&_m(),Ko(r),M=r.pendingLanes,(p&4194090)!==0&&(M&42)!==0?r===Ph?Hf++:(Hf=0,Ph=r):Hf=0,Os(0)}}function a0(r,u){(r.pooledCacheLanes&=u)===0&&(u=r.pooledCache,u!=null&&(r.pooledCache=null,sc(u)))}function _m(r){return Nh(),Wf(),Qf(),ey()}function ey(){if(ma!==5)return!1;var r=bc,u=Hg;Hg=0;var p=ni(Gd),w=Ue.T,M=ft.p;try{ft.p=32>p?32:p,Ue.T=null,p=pm,pm=null;var N=bc,q=Gd;if(ma=0,Vd=bc=null,Gd=0,(ii&6)!==0)throw Error(d(331));var ie=ii;if(ii|=4,Q_(N.current),$g(N,N.current,q,p),ii=ie,Os(0,!1),Oi&&typeof Oi.onPostCommitFiberRoot=="function")try{Oi.onPostCommitFiberRoot(la,N)}catch{}return!0}finally{ft.p=M,Ue.T=w,a0(r,u)}}function ty(r,u,p){u=Sr(p,u),u=em(r.stateNode,u,2),r=Go(r,u,2),r!==null&&(Pe(r,2),Ko(r))}function ki(r,u,p){if(r.tag===3)ty(r,r,p);else for(;u!==null;){if(u.tag===3){ty(u,r,p);break}else if(u.tag===1){var w=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Qo===null||!Qo.has(w))){r=Sr(p,r),p=Pg(2),w=Go(u,p,2),w!==null&&(Sh(p,w,u,r),Pe(w,2),Ko(w));break}}u=u.return}}function vm(r,u,p){var w=r.pingCache;if(w===null){w=r.pingCache=new Pv;var M=new Set;w.set(u,M)}else M=w.get(u),M===void 0&&(M=new Set,w.set(u,M));M.has(p)||(Yg=!0,M.add(p),r=s0.bind(null,r,u,p),u.then(r,r))}function s0(r,u,p){var w=r.pingCache;w!==null&&w.delete(u),r.pingedLanes|=r.suspendedLanes&p,r.warmLanes&=~p,li===r&&(Zn&p)===p&&(Ji===4||Ji===3&&(Zn&62914560)===Zn&&300>Li()-dm?(ii&2)===0&&$d(r,0):qg|=p,Fd===Zn&&(Fd=0)),Ko(r)}function bm(r,u){u===0&&(u=at()),r=Na(r,u),r!==null&&(Pe(r,u),Ko(r))}function ny(r){var u=r.memoizedState,p=0;u!==null&&(p=u.retryLane),bm(r,p)}function Ov(r,u){var p=0;switch(r.tag){case 13:var w=r.stateNode,M=r.memoizedState;M!==null&&(p=M.retryLane);break;case 19:w=r.stateNode;break;case 22:w=r.stateNode._retryCache;break;default:throw Error(d(314))}w!==null&&w.delete(u),bm(r,p)}function o0(r,u){return Yn(r,u)}var xm=null,qd=null,iy=!1,wm=!1,ry=!1,gu=0;function Ko(r){r!==qd&&r.next===null&&(qd===null?xm=qd=r:qd=qd.next=r),wm=!0,iy||(iy=!0,sy())}function Os(r,u){if(!ry&&wm){ry=!0;do for(var p=!1,w=xm;w!==null;){if(r!==0){var M=w.pendingLanes;if(M===0)var N=0;else{var q=w.suspendedLanes,ie=w.pingedLanes;N=(1<<31-Ae(42|r)+1)-1,N&=M&~(q&~ie),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(p=!0,Kf(w,N))}else N=Zn,N=Fe(w,w===li?N:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(N&3)===0||Re(w,N)||(p=!0,Kf(w,N));w=w.next}while(p);ry=!1}}function yu(){ay()}function ay(){wm=iy=!1;var r=0;gu!==0&&(m0()&&(r=gu),gu=0);for(var u=Li(),p=null,w=xm;w!==null;){var M=w.next,N=Tm(w,u);N===0?(w.next=null,p===null?xm=M:p.next=M,M===null&&(qd=p)):(p=w,(r!==0||(N&3)!==0)&&(wm=!0)),w=M}Os(r)}function Tm(r,u){for(var p=r.suspendedLanes,w=r.pingedLanes,M=r.expirationTimes,N=r.pendingLanes&-62914561;0<N;){var q=31-Ae(N),ie=1<<q,we=M[q];we===-1?((ie&p)===0||(ie&w)!==0)&&(M[q]=tt(ie,u)):we<=u&&(r.expiredLanes|=ie),N&=~ie}if(u=li,p=Zn,p=Fe(r,r===u?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),w=r.callbackNode,p===0||r===u&&(hi===2||hi===9)||r.cancelPendingCommit!==null)return w!==null&&w!==null&&Wn(w),r.callbackNode=null,r.callbackPriority=0;if((p&3)===0||Re(r,p)){if(u=p&-p,u===r.callbackPriority)return u;switch(w!==null&&Wn(w),ni(p)){case 2:case 8:p=oa;break;case 32:p=Fr;break;case 268435456:p=Ja;break;default:p=Fr}return w=l0.bind(null,r),p=Yn(p,w),r.callbackPriority=u,r.callbackNode=p,u}return w!==null&&w!==null&&Wn(w),r.callbackPriority=2,r.callbackNode=null,2}function l0(r,u){if(ma!==0&&ma!==5)return r.callbackNode=null,r.callbackPriority=0,null;var p=r.callbackNode;if(_m()&&r.callbackNode!==p)return null;var w=Zn;return w=Fe(r,r===li?w:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),w===0?null:(Xg(r,w,u),Tm(r,Li()),r.callbackNode!=null&&r.callbackNode===p?l0.bind(null,r):null)}function Kf(r,u){if(_m())return null;Xg(r,u,!0)}function sy(){bu(function(){(ii&6)!==0?Yn(ka,yu):ay()})}function oy(){return gu===0&&(gu=ht()),gu}function Sm(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:gn(""+r)}function Em(r,u){var p=u.ownerDocument.createElement("input");return p.name=u.name,p.value=u.value,r.id&&p.setAttribute("form",r.id),u.parentNode.insertBefore(p,u),r=new FormData(r),p.parentNode.removeChild(p),r}function Hd(r,u,p,w,M){if(u==="submit"&&p&&p.stateNode===M){var N=Sm((M[tn]||null).action),q=w.submitter;q&&(u=(u=q[tn]||null)?Sm(u.formAction):q.getAttribute("formAction"),u!==null&&(N=u,q=null));var ie=new Ia("action","action",null,w,M);r.push({event:ie,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(gu!==0){var we=q?Em(M,q):new FormData(M);Ci(p,{pending:!0,data:we,method:M.method,action:N},null,we)}}else typeof N=="function"&&(ie.preventDefault(),we=q?Em(M,q):new FormData(M),Ci(p,{pending:!0,data:we,method:M.method,action:N},N,we))},currentTarget:M}]})}}for(var Am=0;Am<yd.length;Am++){var Mm=yd[Am],ly=Mm.toLowerCase(),c0=Mm[0].toUpperCase()+Mm.slice(1);ns(ly,"on"+c0)}ns(rh,"onAnimationEnd"),ns(ah,"onAnimationIteration"),ns(sh,"onAnimationStart"),ns("dblclick","onDoubleClick"),ns("focusin","onFocus"),ns("focusout","onBlur"),ns(Rf,"onTransitionRun"),ns(tc,"onTransitionStart"),ns(oh,"onTransitionCancel"),ns(nc,"onTransitionEnd"),Io("onMouseEnter",["mouseout","mouseover"]),Io("onMouseLeave",["mouseout","mouseover"]),Io("onPointerEnter",["pointerout","pointerover"]),Io("onPointerLeave",["pointerout","pointerover"]),_a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_a("onBeforeInput",["compositionend","keypress","textInput","paste"]),_a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_u));function h0(r,u){u=(u&4)!==0;for(var p=0;p<r.length;p++){var w=r[p],M=w.event;w=w.listeners;e:{var N=void 0;if(u)for(var q=w.length-1;0<=q;q--){var ie=w[q],we=ie.instance,Ze=ie.currentTarget;if(ie=ie.listener,we!==N&&M.isPropagationStopped())break e;N=ie,M.currentTarget=Ze;try{N(M)}catch(st){Th(st)}M.currentTarget=null,N=we}else for(q=0;q<w.length;q++){if(ie=w[q],we=ie.instance,Ze=ie.currentTarget,ie=ie.listener,we!==N&&M.isPropagationStopped())break e;N=ie,M.currentTarget=Ze;try{N(M)}catch(st){Th(st)}M.currentTarget=null,N=we}}}}function On(r,u){var p=u[gt];p===void 0&&(p=u[gt]=new Set);var w=r+"__bubble";p.has(w)||(d0(u,r,2,!1),p.add(w))}function Cm(r,u,p){var w=0;u&&(w|=4),d0(p,r,w,u)}var Dm="_reactListening"+Math.random().toString(36).slice(2);function cy(r){if(!r[Dm]){r[Dm]=!0,dn.forEach(function(p){p!=="selectionchange"&&(u0.has(p)||Cm(p,!1,r),Cm(p,!0,r))});var u=r.nodeType===9?r:r.ownerDocument;u===null||u[Dm]||(u[Dm]=!0,Cm("selectionchange",!1,u))}}function d0(r,u,p,w){switch(jt(u)){case 2:var M=Be;break;case 8:M=Qe;break;default:M=lt}p=M.bind(null,u,p,r),M=void 0,!Pr||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(M=!0),w?M!==void 0?r.addEventListener(u,p,{capture:!0,passive:M}):r.addEventListener(u,p,!0):M!==void 0?r.addEventListener(u,p,{passive:M}):r.addEventListener(u,p,!1)}function uy(r,u,p,w,M){var N=w;if((u&1)===0&&(u&2)===0&&w!==null)e:for(;;){if(w===null)return;var q=w.tag;if(q===3||q===4){var ie=w.stateNode.containerInfo;if(ie===M)break;if(q===4)for(q=w.return;q!==null;){var we=q.tag;if((we===3||we===4)&&q.stateNode.containerInfo===M)return;q=q.return}for(;ie!==null;){if(q=hn(ie),q===null)return;if(we=q.tag,we===5||we===6||we===26||we===27){w=N=q;continue e}ie=ie.parentNode}}w=w.return}Wi(function(){var Ze=N,st=Oc(p),ut=[];e:{var We=Pa.get(r);if(We!==void 0){var Ke=Ia,cn=r;switch(r){case"keypress":if(nn(p)===0)break e;case"keydown":case"keyup":Ke=Wu;break;case"focusin":cn="focus",Ke=ql;break;case"focusout":cn="blur",Ke=ql;break;case"beforeblur":case"afterblur":Ke=ql;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=Yu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=Tr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=Mg;break;case rh:case ah:case sh:Ke=Zi;break;case nc:Ke=Cg;break;case"scroll":case"scrollend":Ke=bf;break;case"wheel":Ke=fd;break;case"copy":case"cut":case"paste":Ke=qu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=wf;break;case"toggle":case"beforetoggle":Ke=Wl}var rn=(u&4)!==0,ci=!rn&&(r==="scroll"||r==="scrollend"),ze=rn?We!==null?We+"Capture":null:We;rn=[];for(var Ce=Ze,$e;Ce!==null;){var ct=Ce;if($e=ct.stateNode,ct=ct.tag,ct!==5&&ct!==26&&ct!==27||$e===null||ze===null||(ct=Vn(Ce,ze),ct!=null&&rn.push(Jf(Ce,ct,$e))),ci)break;Ce=Ce.return}0<rn.length&&(We=new Ke(We,cn,null,p,st),ut.push({event:We,listeners:rn}))}}if((u&7)===0){e:{if(We=r==="mouseover"||r==="pointerover",Ke=r==="mouseout"||r==="pointerout",We&&p!==No&&(cn=p.relatedTarget||p.fromElement)&&(hn(cn)||cn[Ti]))break e;if((Ke||We)&&(We=st.window===st?st:(We=st.ownerDocument)?We.defaultView||We.parentWindow:window,Ke?(cn=p.relatedTarget||p.toElement,Ke=Ze,cn=cn?hn(cn):null,cn!==null&&(ci=_(cn),rn=cn.tag,cn!==ci||rn!==5&&rn!==27&&rn!==6)&&(cn=null)):(Ke=null,cn=Ze),Ke!==cn)){if(rn=Yu,ct="onMouseLeave",ze="onMouseEnter",Ce="mouse",(r==="pointerout"||r==="pointerover")&&(rn=wf,ct="onPointerLeave",ze="onPointerEnter",Ce="pointer"),ci=Ke==null?We:Xi(Ke),$e=cn==null?We:Xi(cn),We=new rn(ct,Ce+"leave",Ke,p,st),We.target=ci,We.relatedTarget=$e,ct=null,hn(st)===Ze&&(rn=new rn(ze,Ce+"enter",cn,p,st),rn.target=$e,rn.relatedTarget=ci,ct=rn),ci=ct,Ke&&cn)t:{for(rn=Ke,ze=cn,Ce=0,$e=rn;$e;$e=js($e))Ce++;for($e=0,ct=ze;ct;ct=js(ct))$e++;for(;0<Ce-$e;)rn=js(rn),Ce--;for(;0<$e-Ce;)ze=js(ze),$e--;for(;Ce--;){if(rn===ze||ze!==null&&rn===ze.alternate)break t;rn=js(rn),ze=js(ze)}rn=null}else rn=null;Ke!==null&&hy(ut,We,Ke,rn,!1),cn!==null&&ci!==null&&hy(ut,ci,cn,rn,!0)}}e:{if(We=Ze?Xi(Ze):window,Ke=We.nodeName&&We.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&We.type==="file")var Zt=Cf;else if(jp(We))if(dl)Zt=Vp;else{Zt=Rg;var In=Fp}else Ke=We.nodeName,!Ke||Ke.toLowerCase()!=="input"||We.type!=="checkbox"&&We.type!=="radio"?Ze&&lo(Ze.elementType)&&(Zt=Cf):Zt=Up;if(Zt&&(Zt=Zt(r,Ze))){Mf(ut,Zt,p,st);break e}In&&In(r,We,Ze),r==="focusout"&&Ze&&We.type==="number"&&Ze.memoizedProps.value!=null&&$u(We,"number",We.value)}switch(In=Ze?Xi(Ze):window,r){case"focusin":(jp(In)||In.contentEditable==="true")&&(fl=In,Lo=Ze,Jl=null);break;case"focusout":Jl=Lo=fl=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,Zp(ut,p,st);break;case"selectionchange":if(Gp)break;case"keydown":case"keyup":Zp(ut,p,st)}var Kt;if(Fc)e:{switch(r){case"compositionstart":var ln="onCompositionStart";break e;case"compositionend":ln="onCompositionEnd";break e;case"compositionupdate":ln="onCompositionUpdate";break e}ln=void 0}else Gc?Lp(r,p)&&(ln="onCompositionEnd"):r==="keydown"&&p.keyCode===229&&(ln="onCompositionStart");ln&&(Qu&&p.locale!=="ko"&&(Gc||ln!=="onCompositionStart"?ln==="onCompositionEnd"&&Gc&&(Kt=qt()):(Fi=st,si="value"in Fi?Fi.value:Fi.textContent,Gc=!0)),In=Xd(Ze,ln),0<In.length&&(ln=new zp(ln,r,null,p,st),ut.push({event:ln,listeners:In}),Kt?ln.data=Kt:(Kt=Ku(p),Kt!==null&&(ln.data=Kt)))),(Kt=kg?Ql(r,p):Op(r,p))&&(ln=Xd(Ze,"onBeforeInput"),0<ln.length&&(In=new zp("onBeforeInput","beforeinput",null,p,st),ut.push({event:In,listeners:ln}),In.data=Kt)),Hd(ut,r,Ze,p,st)}h0(ut,u)})}function Jf(r,u,p){return{instance:r,listener:u,currentTarget:p}}function Xd(r,u){for(var p=u+"Capture",w=[];r!==null;){var M=r,N=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||N===null||(M=Vn(r,p),M!=null&&w.unshift(Jf(r,M,N)),M=Vn(r,u),M!=null&&w.push(Jf(r,M,N))),r.tag===3)return w;r=r.return}return[]}function js(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function hy(r,u,p,w,M){for(var N=u._reactName,q=[];p!==null&&p!==w;){var ie=p,we=ie.alternate,Ze=ie.stateNode;if(ie=ie.tag,we!==null&&we===w)break;ie!==5&&ie!==26&&ie!==27||Ze===null||(we=Ze,M?(Ze=Vn(p,N),Ze!=null&&q.unshift(Jf(p,Ze,we))):M||(Ze=Vn(p,N),Ze!=null&&q.push(Jf(p,Ze,we)))),p=p.return}q.length!==0&&r.push({event:u,listeners:q})}var f0=/\r\n?/g,p0=/\u0000|\uFFFD/g;function dy(r){return(typeof r=="string"?r:""+r).replace(f0,`
`).replace(p0,"")}function fy(r,u){return u=dy(u),dy(r)===u}function Wd(){}function di(r,u,p,w,M,N){switch(p){case"children":typeof w=="string"?u==="body"||u==="textarea"&&w===""||oo(r,w):(typeof w=="number"||typeof w=="bigint")&&u!=="body"&&oo(r,""+w);break;case"className":qn(r,"class",w);break;case"tabIndex":qn(r,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":qn(r,p,w);break;case"style":ll(r,w,N);break;case"data":if(u!=="object"){qn(r,"data",w);break}case"src":case"href":if(w===""&&(u!=="a"||p!=="href")){r.removeAttribute(p);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){r.removeAttribute(p);break}w=gn(""+w),r.setAttribute(p,w);break;case"action":case"formAction":if(typeof w=="function"){r.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(p==="formAction"?(u!=="input"&&di(r,u,"name",M.name,M,null),di(r,u,"formEncType",M.formEncType,M,null),di(r,u,"formMethod",M.formMethod,M,null),di(r,u,"formTarget",M.formTarget,M,null)):(di(r,u,"encType",M.encType,M,null),di(r,u,"method",M.method,M,null),di(r,u,"target",M.target,M,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){r.removeAttribute(p);break}w=gn(""+w),r.setAttribute(p,w);break;case"onClick":w!=null&&(r.onclick=Wd);break;case"onScroll":w!=null&&On("scroll",r);break;case"onScrollEnd":w!=null&&On("scrollend",r);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(d(61));if(p=w.__html,p!=null){if(M.children!=null)throw Error(d(60));r.innerHTML=p}}break;case"multiple":r.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":r.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){r.removeAttribute("xlink:href");break}p=gn(""+w),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?r.setAttribute(p,""+w):r.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?r.setAttribute(p,""):r.removeAttribute(p);break;case"capture":case"download":w===!0?r.setAttribute(p,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?r.setAttribute(p,w):r.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?r.setAttribute(p,w):r.removeAttribute(p);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?r.removeAttribute(p):r.setAttribute(p,w);break;case"popover":On("beforetoggle",r),On("toggle",r),kr(r,"popover",w);break;case"xlinkActuate":ao(r,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":ao(r,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":ao(r,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":ao(r,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":ao(r,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":ao(r,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":ao(r,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":ao(r,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":ao(r,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":kr(r,"is",w);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Po.get(p)||p,kr(r,p,w))}}function zh(r,u,p,w,M,N){switch(p){case"style":ll(r,w,N);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(d(61));if(p=w.__html,p!=null){if(M.children!=null)throw Error(d(60));r.innerHTML=p}}break;case"children":typeof w=="string"?oo(r,w):(typeof w=="number"||typeof w=="bigint")&&oo(r,""+w);break;case"onScroll":w!=null&&On("scroll",r);break;case"onScrollEnd":w!=null&&On("scrollend",r);break;case"onClick":w!=null&&(r.onclick=Wd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vu.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(M=p.endsWith("Capture"),u=p.slice(2,M?p.length-7:void 0),N=r[tn]||null,N=N!=null?N[p]:null,typeof N=="function"&&r.removeEventListener(u,N,M),typeof w=="function")){typeof N!="function"&&N!==null&&(p in r?r[p]=null:r.hasAttribute(p)&&r.removeAttribute(p)),r.addEventListener(u,w,M);break e}p in r?r[p]=w:w===!0?r.setAttribute(p,""):kr(r,p,w)}}}function ea(r,u,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":On("error",r),On("load",r);var w=!1,M=!1,N;for(N in p)if(p.hasOwnProperty(N)){var q=p[N];if(q!=null)switch(N){case"src":w=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(d(137,u));default:di(r,u,N,q,p,null)}}M&&di(r,u,"srcSet",p.srcSet,p,null),w&&di(r,u,"src",p.src,p,null);return;case"input":On("invalid",r);var ie=N=q=M=null,we=null,Ze=null;for(w in p)if(p.hasOwnProperty(w)){var st=p[w];if(st!=null)switch(w){case"name":M=st;break;case"type":q=st;break;case"checked":we=st;break;case"defaultChecked":Ze=st;break;case"value":N=st;break;case"defaultValue":ie=st;break;case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(d(137,u));break;default:di(r,u,w,st,p,null)}}Vl(r,N,ie,we,Ze,q,M,!1),hd(r);return;case"select":On("invalid",r),w=q=N=null;for(M in p)if(p.hasOwnProperty(M)&&(ie=p[M],ie!=null))switch(M){case"value":N=ie;break;case"defaultValue":q=ie;break;case"multiple":w=ie;default:di(r,u,M,ie,p,null)}u=N,p=q,r.multiple=!!w,u!=null?ol(r,!!w,u,!1):p!=null&&ol(r,!!w,p,!0);return;case"textarea":On("invalid",r),N=M=w=null;for(q in p)if(p.hasOwnProperty(q)&&(ie=p[q],ie!=null))switch(q){case"value":w=ie;break;case"defaultValue":M=ie;break;case"children":N=ie;break;case"dangerouslySetInnerHTML":if(ie!=null)throw Error(d(91));break;default:di(r,u,q,ie,p,null)}Gl(r,w,M,N),hd(r);return;case"option":for(we in p)if(p.hasOwnProperty(we)&&(w=p[we],w!=null))switch(we){case"selected":r.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:di(r,u,we,w,p,null)}return;case"dialog":On("beforetoggle",r),On("toggle",r),On("cancel",r),On("close",r);break;case"iframe":case"object":On("load",r);break;case"video":case"audio":for(w=0;w<_u.length;w++)On(_u[w],r);break;case"image":On("error",r),On("load",r);break;case"details":On("toggle",r);break;case"embed":case"source":case"link":On("error",r),On("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ze in p)if(p.hasOwnProperty(Ze)&&(w=p[Ze],w!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(d(137,u));default:di(r,u,Ze,w,p,null)}return;default:if(lo(u)){for(st in p)p.hasOwnProperty(st)&&(w=p[st],w!==void 0&&zh(r,u,st,w,p,void 0));return}}for(ie in p)p.hasOwnProperty(ie)&&(w=p[ie],w!=null&&di(r,u,ie,w,p,null))}function py(r,u,p,w){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,N=null,q=null,ie=null,we=null,Ze=null,st=null;for(Ke in p){var ut=p[Ke];if(p.hasOwnProperty(Ke)&&ut!=null)switch(Ke){case"checked":break;case"value":break;case"defaultValue":we=ut;default:w.hasOwnProperty(Ke)||di(r,u,Ke,null,w,ut)}}for(var We in w){var Ke=w[We];if(ut=p[We],w.hasOwnProperty(We)&&(Ke!=null||ut!=null))switch(We){case"type":N=Ke;break;case"name":M=Ke;break;case"checked":Ze=Ke;break;case"defaultChecked":st=Ke;break;case"value":q=Ke;break;case"defaultValue":ie=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(d(137,u));break;default:Ke!==ut&&di(r,u,We,Ke,w,ut)}}Zu(r,q,ie,we,Ze,st,N,M);return;case"select":Ke=q=ie=We=null;for(N in p)if(we=p[N],p.hasOwnProperty(N)&&we!=null)switch(N){case"value":break;case"multiple":Ke=we;default:w.hasOwnProperty(N)||di(r,u,N,null,w,we)}for(M in w)if(N=w[M],we=p[M],w.hasOwnProperty(M)&&(N!=null||we!=null))switch(M){case"value":We=N;break;case"defaultValue":ie=N;break;case"multiple":q=N;default:N!==we&&di(r,u,M,N,w,we)}u=ie,p=q,w=Ke,We!=null?ol(r,!!p,We,!1):!!w!=!!p&&(u!=null?ol(r,!!p,u,!0):ol(r,!!p,p?[]:"",!1));return;case"textarea":Ke=We=null;for(ie in p)if(M=p[ie],p.hasOwnProperty(ie)&&M!=null&&!w.hasOwnProperty(ie))switch(ie){case"value":break;case"children":break;default:di(r,u,ie,null,w,M)}for(q in w)if(M=w[q],N=p[q],w.hasOwnProperty(q)&&(M!=null||N!=null))switch(q){case"value":We=M;break;case"defaultValue":Ke=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(d(91));break;default:M!==N&&di(r,u,q,M,w,N)}Pp(r,We,Ke);return;case"option":for(var cn in p)if(We=p[cn],p.hasOwnProperty(cn)&&We!=null&&!w.hasOwnProperty(cn))switch(cn){case"selected":r.selected=!1;break;default:di(r,u,cn,null,w,We)}for(we in w)if(We=w[we],Ke=p[we],w.hasOwnProperty(we)&&We!==Ke&&(We!=null||Ke!=null))switch(we){case"selected":r.selected=We&&typeof We!="function"&&typeof We!="symbol";break;default:di(r,u,we,We,w,Ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rn in p)We=p[rn],p.hasOwnProperty(rn)&&We!=null&&!w.hasOwnProperty(rn)&&di(r,u,rn,null,w,We);for(Ze in w)if(We=w[Ze],Ke=p[Ze],w.hasOwnProperty(Ze)&&We!==Ke&&(We!=null||Ke!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(d(137,u));break;default:di(r,u,Ze,We,w,Ke)}return;default:if(lo(u)){for(var ci in p)We=p[ci],p.hasOwnProperty(ci)&&We!==void 0&&!w.hasOwnProperty(ci)&&zh(r,u,ci,void 0,w,We);for(st in w)We=w[st],Ke=p[st],!w.hasOwnProperty(st)||We===Ke||We===void 0&&Ke===void 0||zh(r,u,st,We,w,Ke);return}}for(var ze in p)We=p[ze],p.hasOwnProperty(ze)&&We!=null&&!w.hasOwnProperty(ze)&&di(r,u,ze,null,w,We);for(ut in w)We=w[ut],Ke=p[ut],!w.hasOwnProperty(ut)||We===Ke||We==null&&Ke==null||di(r,u,ut,We,w,Ke)}var km=null,$a=null;function Tc(r){return r.nodeType===9?r:r.ownerDocument}function Qd(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vu(r,u){if(r===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&u==="foreignObject"?0:r}function Rm(r,u){return r==="textarea"||r==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Im=null;function m0(){var r=window.event;return r&&r.type==="popstate"?r===Im?!1:(Im=r,!0):(Im=null,!1)}var my=typeof setTimeout=="function"?setTimeout:void 0,jv=typeof clearTimeout=="function"?clearTimeout:void 0,gy=typeof Promise=="function"?Promise:void 0,bu=typeof queueMicrotask=="function"?queueMicrotask:typeof gy<"u"?function(r){return gy.resolve(null).then(r).catch(g0)}:my;function g0(r){setTimeout(function(){throw r})}function Sc(r){return r==="head"}function yy(r,u){var p=u,w=0,M=0;do{var N=p.nextSibling;if(r.removeChild(p),N&&N.nodeType===8)if(p=N.data,p==="/$"){if(0<w&&8>w){p=w;var q=r.ownerDocument;if(p&1&&xu(q.documentElement),p&2&&xu(q.body),p&4)for(p=q.head,xu(p),q=p.firstChild;q;){var ie=q.nextSibling,we=q.nodeName;q[io]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&q.rel.toLowerCase()==="stylesheet"||p.removeChild(q),q=ie}}if(M===0){r.removeChild(N),Cr(u);return}M--}else p==="$"||p==="$?"||p==="$!"?M++:w=p.charCodeAt(0)-48;else w=0;p=N}while(p);Cr(u)}function Pm(r){var u=r.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var p=u;switch(u=u.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Pm(p),St(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}r.removeChild(p)}}function Bv(r,u,p,w){for(;r.nodeType===1;){var M=p;if(r.nodeName.toLowerCase()!==u.toLowerCase()){if(!w&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(w){if(!r[io])switch(u){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(N=r.getAttribute("rel"),N==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(N!==M.rel||r.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(N=r.getAttribute("src"),(N!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&N&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(u==="input"&&r.type==="hidden"){var N=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===N)return r}else return r;if(r=ms(r.nextSibling),r===null)break}return null}function Fv(r,u,p){if(u==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!p||(r=ms(r.nextSibling),r===null))return null;return r}function Nm(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function y0(r,u){var p=r.ownerDocument;if(r.data!=="$?"||p.readyState==="complete")u();else{var w=function(){u(),p.removeEventListener("DOMContentLoaded",w)};p.addEventListener("DOMContentLoaded",w),r._reactRetry=w}}function ms(r){for(;r!=null;r=r.nextSibling){var u=r.nodeType;if(u===1||u===3)break;if(u===8){if(u=r.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return r}var zm=null;function ep(r){r=r.previousSibling;for(var u=0;r;){if(r.nodeType===8){var p=r.data;if(p==="$"||p==="$!"||p==="$?"){if(u===0)return r;u--}else p==="/$"&&u++}r=r.previousSibling}return null}function tp(r,u,p){switch(u=Tc(p),r){case"html":if(r=u.documentElement,!r)throw Error(d(452));return r;case"head":if(r=u.head,!r)throw Error(d(453));return r;case"body":if(r=u.body,!r)throw Error(d(454));return r;default:throw Error(d(451))}}function xu(r){for(var u=r.attributes;u.length;)r.removeAttributeNode(u[0]);St(r)}var bo=new Map,_0=new Set;function Lm(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var gs=ft.d;ft.d={f:ta,r:_y,D:by,C:Uv,L:v0,m:b0,X:x0,S:Vv,M:xy};function ta(){var r=gs.f(),u=ym();return r||u}function _y(r){var u=an(r);u!==null&&u.tag===5&&u.type==="form"?on(u):gs.r(r)}var Lh=typeof document>"u"?null:document;function vy(r,u,p){var w=Lh;if(w&&typeof u=="string"&&u){var M=va(u);M='link[rel="'+r+'"][href="'+M+'"]',typeof p=="string"&&(M+='[crossorigin="'+p+'"]'),_0.has(M)||(_0.add(M),r={rel:r,crossOrigin:p,href:u},w.querySelector(M)===null&&(u=w.createElement("link"),ea(u,"link",r),Si(u),w.head.appendChild(u)))}}function by(r){gs.D(r),vy("dns-prefetch",r,null)}function Uv(r,u){gs.C(r,u),vy("preconnect",r,u)}function v0(r,u,p){gs.L(r,u,p);var w=Lh;if(w&&r&&u){var M='link[rel="preload"][as="'+va(u)+'"]';u==="image"&&p&&p.imageSrcSet?(M+='[imagesrcset="'+va(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(M+='[imagesizes="'+va(p.imageSizes)+'"]')):M+='[href="'+va(r)+'"]';var N=M;switch(u){case"style":N=Oh(r);break;case"script":N=wu(r)}bo.has(N)||(r=z({rel:"preload",href:u==="image"&&p&&p.imageSrcSet?void 0:r,as:u},p),bo.set(N,r),w.querySelector(M)!==null||u==="style"&&w.querySelector(Ec(N))||u==="script"&&w.querySelector(Tu(N))||(u=w.createElement("link"),ea(u,"link",r),Si(u),w.head.appendChild(u)))}}function b0(r,u){gs.m(r,u);var p=Lh;if(p&&r){var w=u&&typeof u.as=="string"?u.as:"script",M='link[rel="modulepreload"][as="'+va(w)+'"][href="'+va(r)+'"]',N=M;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=wu(r)}if(!bo.has(N)&&(r=z({rel:"modulepreload",href:r},u),bo.set(N,r),p.querySelector(M)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Tu(N)))return}w=p.createElement("link"),ea(w,"link",r),Si(w),p.head.appendChild(w)}}}function Vv(r,u,p){gs.S(r,u,p);var w=Lh;if(w&&r){var M=es(w).hoistableStyles,N=Oh(r);u=u||"default";var q=M.get(N);if(!q){var ie={loading:0,preload:null};if(q=w.querySelector(Ec(N)))ie.loading=5;else{r=z({rel:"stylesheet",href:r,"data-precedence":u},p),(p=bo.get(N))&&np(r,p);var we=q=w.createElement("link");Si(we),ea(we,"link",r),we._p=new Promise(function(Ze,st){we.onload=Ze,we.onerror=st}),we.addEventListener("load",function(){ie.loading|=1}),we.addEventListener("error",function(){ie.loading|=2}),ie.loading|=4,Jd(q,u,w)}q={type:"stylesheet",instance:q,count:1,state:ie},M.set(N,q)}}}function x0(r,u){gs.X(r,u);var p=Lh;if(p&&r){var w=es(p).hoistableScripts,M=wu(r),N=w.get(M);N||(N=p.querySelector(Tu(M)),N||(r=z({src:r,async:!0},u),(u=bo.get(M))&&ip(r,u),N=p.createElement("script"),Si(N),ea(N,"link",r),p.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},w.set(M,N))}}function xy(r,u){gs.M(r,u);var p=Lh;if(p&&r){var w=es(p).hoistableScripts,M=wu(r),N=w.get(M);N||(N=p.querySelector(Tu(M)),N||(r=z({src:r,async:!0,type:"module"},u),(u=bo.get(M))&&ip(r,u),N=p.createElement("script"),Si(N),ea(N,"link",r),p.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},w.set(M,N))}}function Om(r,u,p,w){var M=(M=Bt.current)?Lm(M):null;if(!M)throw Error(d(446));switch(r){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(u=Oh(p.href),p=es(M).hoistableStyles,w=p.get(u),w||(w={type:"style",instance:null,count:0,state:null},p.set(u,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){r=Oh(p.href);var N=es(M).hoistableStyles,q=N.get(r);if(q||(M=M.ownerDocument||M,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(r,q),(N=M.querySelector(Ec(r)))&&!N._p&&(q.instance=N,q.state.loading=5),bo.has(r)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},bo.set(r,p),N||w0(M,r,p,q.state))),u&&w===null)throw Error(d(528,""));return q}if(u&&w!==null)throw Error(d(529,""));return null;case"script":return u=p.async,p=p.src,typeof p=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=wu(p),p=es(M).hoistableScripts,w=p.get(u),w||(w={type:"script",instance:null,count:0,state:null},p.set(u,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(d(444,r))}}function Oh(r){return'href="'+va(r)+'"'}function Ec(r){return'link[rel="stylesheet"]['+r+"]"}function jm(r){return z({},r,{"data-precedence":r.precedence,precedence:null})}function w0(r,u,p,w){r.querySelector('link[rel="preload"][as="style"]['+u+"]")?w.loading=1:(u=r.createElement("link"),w.preload=u,u.addEventListener("load",function(){return w.loading|=1}),u.addEventListener("error",function(){return w.loading|=2}),ea(u,"link",p),Si(u),r.head.appendChild(u))}function wu(r){return'[src="'+va(r)+'"]'}function Tu(r){return"script[async]"+r}function Kd(r,u,p){if(u.count++,u.instance===null)switch(u.type){case"style":var w=r.querySelector('style[data-href~="'+va(p.href)+'"]');if(w)return u.instance=w,Si(w),w;var M=z({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return w=(r.ownerDocument||r).createElement("style"),Si(w),ea(w,"style",M),Jd(w,p.precedence,r),u.instance=w;case"stylesheet":M=Oh(p.href);var N=r.querySelector(Ec(M));if(N)return u.state.loading|=4,u.instance=N,Si(N),N;w=jm(p),(M=bo.get(M))&&np(w,M),N=(r.ownerDocument||r).createElement("link"),Si(N);var q=N;return q._p=new Promise(function(ie,we){q.onload=ie,q.onerror=we}),ea(N,"link",w),u.state.loading|=4,Jd(N,p.precedence,r),u.instance=N;case"script":return N=wu(p.src),(M=r.querySelector(Tu(N)))?(u.instance=M,Si(M),M):(w=p,(M=bo.get(N))&&(w=z({},p),ip(w,M)),r=r.ownerDocument||r,M=r.createElement("script"),Si(M),ea(M,"link",w),r.head.appendChild(M),u.instance=M);case"void":return null;default:throw Error(d(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(w=u.instance,u.state.loading|=4,Jd(w,p.precedence,r));return u.instance}function Jd(r,u,p){for(var w=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=w.length?w[w.length-1]:null,N=M,q=0;q<w.length;q++){var ie=w[q];if(ie.dataset.precedence===u)N=ie;else if(N!==M)break}N?N.parentNode.insertBefore(r,N.nextSibling):(u=p.nodeType===9?p.head:p,u.insertBefore(r,u.firstChild))}function np(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.title==null&&(r.title=u.title)}function ip(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.integrity==null&&(r.integrity=u.integrity)}var Bm=null;function s(r,u,p){if(Bm===null){var w=new Map,M=Bm=new Map;M.set(p,w)}else M=Bm,w=M.get(p),w||(w=new Map,M.set(p,w));if(w.has(r))return w;for(w.set(r,null),p=p.getElementsByTagName(r),M=0;M<p.length;M++){var N=p[M];if(!(N[io]||N[Wt]||r==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var q=N.getAttribute(u)||"";q=r+q;var ie=w.get(q);ie?ie.push(N):w.set(q,[N])}}return w}function t(r,u,p){r=r.ownerDocument||r,r.head.insertBefore(p,u==="title"?r.querySelector("head > title"):null)}function a(r,u,p){if(p===1||u.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return r=u.disabled,typeof u.precedence=="string"&&r==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function h(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var g=null;function x(){}function S(r,u,p){if(g===null)throw Error(d(475));var w=g;if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var M=Oh(p.href),N=r.querySelector(Ec(M));if(N){r=N._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(w.count++,w=D.bind(w),r.then(w,w)),u.state.loading|=4,u.instance=N,Si(N);return}N=r.ownerDocument||r,p=jm(p),(M=bo.get(M))&&np(p,M),N=N.createElement("link"),Si(N);var q=N;q._p=new Promise(function(ie,we){q.onload=ie,q.onerror=we}),ea(N,"link",p),u.instance=N}w.stylesheets===null&&(w.stylesheets=new Map),w.stylesheets.set(u,r),(r=u.state.preload)&&(u.state.loading&3)===0&&(w.count++,u=D.bind(w),r.addEventListener("load",u),r.addEventListener("error",u))}}function A(){if(g===null)throw Error(d(475));var r=g;return r.stylesheets&&r.count===0&&L(r,r.stylesheets),0<r.count?function(u){var p=setTimeout(function(){if(r.stylesheets&&L(r,r.stylesheets),r.unsuspend){var w=r.unsuspend;r.unsuspend=null,w()}},6e4);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(p)}}:null}function D(){if(this.count--,this.count===0){if(this.stylesheets)L(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var P=null;function L(r,u){r.stylesheets=null,r.unsuspend!==null&&(r.count++,P=new Map,u.forEach(F,r),P=null,D.call(r))}function F(r,u){if(!(u.state.loading&4)){var p=P.get(r);if(p)var w=p.get(null);else{p=new Map,P.set(r,p);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<M.length;N++){var q=M[N];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(p.set(q.dataset.precedence,q),w=q)}w&&p.set(null,w)}M=u.instance,q=M.getAttribute("data-precedence"),N=p.get(q)||w,N===w&&p.set(null,M),p.set(q,M),this.count++,w=D.bind(this),M.addEventListener("load",w),M.addEventListener("error",w),N?N.parentNode.insertBefore(M,N.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),u.state.loading|=4}}var $={$$typeof:je,Provider:null,Consumer:null,_currentValue:Dt,_currentValue2:Dt,_threadCount:0};function H(r,u,p,w,M,N,q,ie){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lt(0),this.hiddenUpdates=Lt(null),this.identifierPrefix=w,this.onUncaughtError=M,this.onCaughtError=N,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ie,this.incompleteTransitions=new Map}function X(r,u,p,w,M,N,q,ie,we,Ze,st,ut){return r=new H(r,u,p,q,ie,we,Ze,ut),u=1,N===!0&&(u|=24),N=za(3,null,null,u),r.current=N,N.stateNode=r,u=xl(),u.refCount++,r.pooledCache=u,u.refCount++,N.memoizedState={element:w,isDehydrated:p,cache:u},Of(N),r}function ee(r){return r?(r=pn,r):pn}function se(r,u,p,w,M,N){M=ee(M),w.context===null?w.context=M:w.pendingContext=M,w=wl(u),w.payload={element:p},N=N===void 0?null:N,N!==null&&(w.callback=N),p=Go(r,w,u),p!==null&&(ps(p,r,u),lc(p,r,u))}function de(r,u){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var p=r.retryLane;r.retryLane=p!==0&&p<u?p:u}}function ke(r,u){de(r,u),(r=r.alternate)&&de(r,u)}function ve(r){if(r.tag===13){var u=Na(r,67108864);u!==null&&ps(u,r,67108864),ke(r,67108864)}}var Se=!0;function Be(r,u,p,w){var M=Ue.T;Ue.T=null;var N=ft.p;try{ft.p=2,lt(r,u,p,w)}finally{ft.p=N,Ue.T=M}}function Qe(r,u,p,w){var M=Ue.T;Ue.T=null;var N=ft.p;try{ft.p=8,lt(r,u,p,w)}finally{ft.p=N,Ue.T=M}}function lt(r,u,p,w){if(Se){var M=Tt(w);if(M===null)uy(r,u,w,mt,p),Ni(r,w);else if(na(M,r,u,p,w))w.stopPropagation();else if(Ni(r,w),u&4&&-1<En.indexOf(r)){for(;M!==null;){var N=an(M);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var q=Me(N.pendingLanes);if(q!==0){var ie=N;for(ie.pendingLanes|=2,ie.entangledLanes|=2;q;){var we=1<<31-Ae(q);ie.entanglements[1]|=we,q&=~we}Ko(N),(ii&6)===0&&(qf=Li()+500,Os(0))}}break;case 13:ie=Na(N,2),ie!==null&&ps(ie,N,2),ym(),ke(N,2)}if(N=Tt(w),N===null&&uy(r,u,w,mt,p),N===M)break;M=N}M!==null&&w.stopPropagation()}else uy(r,u,w,null,p)}}function Tt(r){return r=Oc(r),wt(r)}var mt=null;function wt(r){if(mt=null,r=hn(r),r!==null){var u=_(r);if(u===null)r=null;else{var p=u.tag;if(p===13){if(r=v(u),r!==null)return r;r=null}else if(p===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;r=null}else u!==r&&(r=null)}}return mt=r,null}function jt(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ka()){case ka:return 2;case oa:return 8;case Fr:case ws:return 32;case Ja:return 268435456;default:return 32}default:return 32}}var xt=!1,yt=null,nt=null,Gt=null,Qt=new Map,Ft=new Map,Nt=[],En="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ni(r,u){switch(r){case"focusin":case"focusout":yt=null;break;case"dragenter":case"dragleave":nt=null;break;case"mouseover":case"mouseout":Gt=null;break;case"pointerover":case"pointerout":Qt.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ft.delete(u.pointerId)}}function Vi(r,u,p,w,M,N){return r===null||r.nativeEvent!==N?(r={blockedOn:u,domEventName:p,eventSystemFlags:w,nativeEvent:N,targetContainers:[M]},u!==null&&(u=an(u),u!==null&&ve(u)),r):(r.eventSystemFlags|=w,u=r.targetContainers,M!==null&&u.indexOf(M)===-1&&u.push(M),r)}function na(r,u,p,w,M){switch(u){case"focusin":return yt=Vi(yt,r,u,p,w,M),!0;case"dragenter":return nt=Vi(nt,r,u,p,w,M),!0;case"mouseover":return Gt=Vi(Gt,r,u,p,w,M),!0;case"pointerover":var N=M.pointerId;return Qt.set(N,Vi(Qt.get(N)||null,r,u,p,w,M)),!0;case"gotpointercapture":return N=M.pointerId,Ft.set(N,Vi(Ft.get(N)||null,r,u,p,w,M)),!0}return!1}function ys(r){var u=hn(r.target);if(u!==null){var p=_(u);if(p!==null){if(u=p.tag,u===13){if(u=v(p),u!==null){r.blockedOn=u,dr(r.priority,function(){if(p.tag===13){var w=Kn();w=sn(w);var M=Na(p,w);M!==null&&ps(M,p,w),ke(p,w)}});return}}else if(u===3&&p.stateNode.current.memoizedState.isDehydrated){r.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ia(r){if(r.blockedOn!==null)return!1;for(var u=r.targetContainers;0<u.length;){var p=Tt(r.nativeEvent);if(p===null){p=r.nativeEvent;var w=new p.constructor(p.type,p);No=w,p.target.dispatchEvent(w),No=null}else return u=an(p),u!==null&&ve(u),r.blockedOn=p,!1;u.shift()}return!0}function Ar(r,u,p){ia(r)&&p.delete(u)}function zi(){xt=!1,yt!==null&&ia(yt)&&(yt=null),nt!==null&&ia(nt)&&(nt=null),Gt!==null&&ia(Gt)&&(Gt=null),Qt.forEach(Ar),Ft.forEach(Ar)}function er(r,u){r.blockedOn===u&&(r.blockedOn=null,xt||(xt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zi)))}var hr=null;function Mr(r){hr!==r&&(hr=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){hr===r&&(hr=null);for(var u=0;u<r.length;u+=3){var p=r[u],w=r[u+1],M=r[u+2];if(typeof w!="function"){if(wt(w||p)===null)continue;break}var N=an(p);N!==null&&(r.splice(u,3),u-=3,Ci(N,{pending:!0,data:M,method:p.method,action:w},w,M))}}))}function Cr(r){function u(we){return er(we,r)}yt!==null&&er(yt,r),nt!==null&&er(nt,r),Gt!==null&&er(Gt,r),Qt.forEach(u),Ft.forEach(u);for(var p=0;p<Nt.length;p++){var w=Nt[p];w.blockedOn===r&&(w.blockedOn=null)}for(;0<Nt.length&&(p=Nt[0],p.blockedOn===null);)ys(p),p.blockedOn===null&&Nt.shift();if(p=(r.ownerDocument||r).$$reactFormReplay,p!=null)for(w=0;w<p.length;w+=3){var M=p[w],N=p[w+1],q=M[tn]||null;if(typeof N=="function")q||Mr(p);else if(q){var ie=null;if(N&&N.hasAttribute("formAction")){if(M=N,q=N[tn]||null)ie=q.formAction;else if(wt(M)!==null)continue}else ie=q.action;typeof ie=="function"?p[w+1]=ie:(p.splice(w,3),w-=3),Mr(p)}}}function Ya(r){this._internalRoot=r}tr.prototype.render=Ya.prototype.render=function(r){var u=this._internalRoot;if(u===null)throw Error(d(409));var p=u.current,w=Kn();se(p,w,r,u,null,null)},tr.prototype.unmount=Ya.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var u=r.containerInfo;se(r.current,2,null,r,null,null),ym(),u[Ti]=null}};function tr(r){this._internalRoot=r}tr.prototype.unstable_scheduleHydration=function(r){if(r){var u=ar();r={blockedOn:null,target:r,priority:u};for(var p=0;p<Nt.length&&u!==0&&u<Nt[p].priority;p++);Nt.splice(p,0,r),p===0&&ys(r)}};var Aa=n.version;if(Aa!=="19.1.1")throw Error(d(527,Aa,"19.1.1"));ft.findDOMNode=function(r){var u=r._reactInternals;if(u===void 0)throw typeof r.render=="function"?Error(d(188)):(r=Object.keys(r).join(","),Error(d(268,r)));return r=C(u),r=r!==null?R(r):null,r=r===null?null:r.stateNode,r};var _r={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Ue,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nr.isDisabled&&nr.supportsFiber)try{la=nr.inject(_r),Oi=nr}catch{}}return Ty.createRoot=function(r,u){if(!m(r))throw Error(d(299));var p=!1,w="",M=Ig,N=O_,q=Qp,ie=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onUncaughtError!==void 0&&(M=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(q=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ie=u.unstable_transitionCallbacks)),u=X(r,1,!1,null,null,p,w,M,N,q,ie,null),r[Ti]=u.current,cy(r),new Ya(u)},Ty.hydrateRoot=function(r,u,p){if(!m(r))throw Error(d(299));var w=!1,M="",N=Ig,q=O_,ie=Qp,we=null,Ze=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(M=p.identifierPrefix),p.onUncaughtError!==void 0&&(N=p.onUncaughtError),p.onCaughtError!==void 0&&(q=p.onCaughtError),p.onRecoverableError!==void 0&&(ie=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(we=p.unstable_transitionCallbacks),p.formState!==void 0&&(Ze=p.formState)),u=X(r,1,!0,u,p??null,w,M,N,q,ie,we,Ze),u.context=ee(null),p=u.current,w=Kn(),w=sn(w),M=wl(w),M.callback=null,Go(p,M,w),p=w,u.current.lanes=p,Pe(u,p),Ko(u),r[Ti]=u.current,cy(r),new tr(u)},Ty.version="19.1.1",Ty}var o1;function SE(){if(o1)return Yv.exports;o1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Yv.exports=TE(),Yv.exports}var EE=SE();const AE=Sp(EE),ME="modulepreload",CE=function(i){return"https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-25T11:23/"+i},l1={},n2=function(n,l,d){let m=Promise.resolve();if(l&&l.length>0){let R=function(z){return Promise.all(z.map(B=>Promise.resolve(B).then(V=>({status:"fulfilled",value:V}),V=>({status:"rejected",reason:V}))))};var v=R;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),C=c?.nonce||c?.getAttribute("nonce");m=R(l.map(z=>{if(z=CE(z),z in l1)return;l1[z]=!0;const B=z.endsWith(".css"),V=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${z}"]${V}`))return;const G=document.createElement("link");if(G.rel=B?"stylesheet":ME,B||(G.as="script"),G.crossOrigin="",G.href=z,C&&G.setAttribute("nonce",C),document.head.appendChild(G),B)return new Promise((re,fe)=>{G.addEventListener("load",re),G.addEventListener("error",()=>fe(new Error(`Unable to preload CSS for ${z}`)))})}))}function _(c){const C=new Event("vite:preloadError",{cancelable:!0});if(C.payload=c,window.dispatchEvent(C),!C.defaultPrevented)throw c}return m.then(c=>{for(const C of c||[])C.status==="rejected"&&_(C.reason);return n().catch(_)})},DE=ce.createContext(null);function kE(i,n){const l=Array.isArray(i)?i[0]:i?i.x:0,d=Array.isArray(i)?i[1]:i?i.y:0,m=Array.isArray(n)?n[0]:n?n.x:0,_=Array.isArray(n)?n[1]:n?n.y:0;return l===m&&d===_}function wo(i,n){if(i===n)return!0;if(!i||!n)return!1;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let l=0;l<i.length;l++)if(!wo(i[l],n[l]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof i=="object"&&typeof n=="object"){const l=Object.keys(i),d=Object.keys(n);if(l.length!==d.length)return!1;for(const m of l)if(!n.hasOwnProperty(m)||!wo(i[m],n[m]))return!1;return!0}return!1}function c1(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function u1(i,n){const l=n.viewState||n,d={};if("longitude"in l&&"latitude"in l&&(l.longitude!==i.center.lng||l.latitude!==i.center.lat)){const m=i.center.constructor;d.center=new m(l.longitude,l.latitude)}return"zoom"in l&&l.zoom!==i.zoom&&(d.zoom=l.zoom),"bearing"in l&&l.bearing!==i.bearing&&(d.bearing=l.bearing),"pitch"in l&&l.pitch!==i.pitch&&(d.pitch=l.pitch),l.padding&&i.padding&&!wo(l.padding,i.padding)&&(d.padding=l.padding),d}const RE=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function h1(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const n={};for(const d of i.layers)n[d.id]=d;const l=i.layers.map(d=>{let m=null;"interactive"in d&&(m=Object.assign({},d),delete m.interactive);const _=n[d.ref];if(_){m=m||Object.assign({},d),delete m.ref;for(const v of RE)v in _&&(m[v]=_[v])}return m||d});return{...i,layers:l}}const d1={version:8,sources:{},layers:[]},f1={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},p1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},m1={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},IE=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],PE=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class tg{constructor(n,l,d){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=m=>{const _=this.props[m1[m.type]];_?_(m):m.type==="error"&&console.error(m.error)},this._onCameraEvent=m=>{if(this._internalUpdate)return;m.viewState=this._propsedCameraUpdate||c1(this._map.transform);const _=this.props[p1[m.type]];_&&_(m)},this._onCameraUpdate=m=>this._internalUpdate?m:(this._propsedCameraUpdate=c1(m),u1(m,this.props)),this._onPointerEvent=m=>{(m.type==="mousemove"||m.type==="mouseout")&&this._updateHover(m);const _=this.props[f1[m.type]];_&&(this.props.interactiveLayerIds&&m.type!=="mouseover"&&m.type!=="mouseout"&&(m.features=this._hoveredFeatures||this._queryRenderedFeatures(m.point)),_(m),delete m.features)},this._MapClass=n,this.props=l,this._initialize(d)}get map(){return this._map}setProps(n){const l=this.props;this.props=n;const d=this._updateSettings(n,l),m=this._updateSize(n),_=this._updateViewState(n);this._updateStyle(n,l),this._updateStyleComponents(n),this._updateHandlers(n,l),(d||m||_&&!this._map.isMoving())&&this.redraw()}static reuse(n,l){const d=tg.savedMaps.pop();if(!d)return null;const m=d.map,_=m.getContainer();for(l.className=_.className;_.childNodes.length>0;)l.appendChild(_.childNodes[0]);m._container=l;const v=m._resizeObserver;v&&(v.disconnect(),v.observe(l)),d.setProps({...n,styleDiffing:!1}),m.resize();const{initialViewState:c}=n;return c&&(c.bounds?m.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):d._updateViewState(c)),m.isStyleLoaded()?m.fire("load"):m.once("style.load",()=>m.fire("load")),m._update(),d}_initialize(n){const{props:l}=this,{mapStyle:d=d1}=l,m={...l,...l.initialViewState,container:n,style:h1(d)},_=m.initialViewState||m.viewState||m;if(Object.assign(m,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),l.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,l.gl)}const v=new this._MapClass(m);_.padding&&v.setPadding(_.padding),l.cursor&&(v.getCanvas().style.cursor=l.cursor),v.transformCameraUpdate=this._onCameraUpdate,v.on("style.load",()=>{this._styleComponents={light:v.getLight(),sky:v.getSky(),projection:v.getProjection?.(),terrain:v.getTerrain()},this._updateStyleComponents(this.props)}),v.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in f1)v.on(c,this._onPointerEvent);for(const c in p1)v.on(c,this._onCameraEvent);for(const c in m1)v.on(c,this._onEvent);this._map=v}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),tg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_updateSize(n){const{viewState:l}=n;if(l){const d=this._map;if(l.width!==d.transform.width||l.height!==d.transform.height)return d.resize(),!0}return!1}_updateViewState(n){const l=this._map,d=l.transform;if(!l.isMoving()){const _=u1(d,n);if(Object.keys(_).length>0)return this._internalUpdate=!0,l.jumpTo(_),this._internalUpdate=!1,!0}return!1}_updateSettings(n,l){const d=this._map;let m=!1;for(const _ of IE)_ in n&&!wo(n[_],l[_])&&(m=!0,d[`set${_[0].toUpperCase()}${_.slice(1)}`]?.call(d,n[_]));return m}_updateStyle(n,l){if(n.cursor!==l.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==l.mapStyle){const{mapStyle:d=d1,styleDiffing:m=!0}=n,_={diff:m};"localIdeographFontFamily"in n&&(_.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(h1(d),_)}}_updateStyleComponents({light:n,projection:l,sky:d,terrain:m}){const _=this._map,v=this._styleComponents;_.style._loaded&&(n&&!wo(n,v.light)&&(v.light=n,_.setLight(n)),l&&!wo(l,v.projection)&&l!==v.projection?.type&&(v.projection=typeof l=="string"?{type:l}:l,_.setProjection?.(v.projection)),d&&!wo(d,v.sky)&&(v.sky=d,_.setSky(d)),m!==void 0&&!wo(m,v.terrain)&&(!m||_.getSource(m.source))&&(v.terrain=m,_.setTerrain(m)))}_updateHandlers(n,l){const d=this._map;for(const m of PE){const _=n[m]??!0,v=l[m]??!0;wo(_,v)||(_?d[m].enable(_):d[m].disable())}}_queryRenderedFeatures(n){const l=this._map,{interactiveLayerIds:d=[]}=this.props;try{return l.queryRenderedFeatures(n,{layers:d.filter(l.getLayer.bind(l))})}catch{return[]}}_updateHover(n){const{props:l}=this;if(l.interactiveLayerIds&&(l.onMouseMove||l.onMouseEnter||l.onMouseLeave)){const m=n.type,_=this._hoveredFeatures?.length>0,v=this._queryRenderedFeatures(n.point),c=v.length>0;!c&&_&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=v,c&&!_&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=m}else this._hoveredFeatures=null}}tg.savedMaps=[];const NE=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function zE(i){if(!i)return null;const n=i.map,l={getMap:()=>n};for(const d of LE(n))!(d in l)&&!NE.includes(d)&&(l[d]=n[d].bind(n));return l}function LE(i){const n=new Set;let l=i;for(;l;){for(const d of Object.getOwnPropertyNames(l))d[0]!=="_"&&typeof i[d]=="function"&&d!=="fire"&&d!=="setEventedParent"&&n.add(d);l=Object.getPrototypeOf(l)}return Array.from(n)}const OE=typeof document<"u"?ce.useLayoutEffect:ce.useEffect;function jE(i,n){const{RTLTextPlugin:l,maxParallelImageRequests:d,workerCount:m,workerUrl:_}=n;if(l&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:v,lazy:c=!0}=typeof l=="string"?{pluginUrl:l}:l;i.setRTLTextPlugin(v,C=>{C&&console.error(C)},c)}d!==void 0&&i.setMaxParallelImageRequests(d),m!==void 0&&i.setWorkerCount(m),_!==void 0&&i.setWorkerUrl(_)}const mg=ce.createContext(null);function BE(i,n){const l=ce.useContext(DE),[d,m]=ce.useState(null),_=ce.useRef(),{current:v}=ce.useRef({mapLib:null,map:null});ce.useEffect(()=>{const R=i.mapLib;let z=!0,B;return Promise.resolve(R||n2(()=>Promise.resolve().then(()=>l2),void 0)).then(V=>{if(!z)return;if(!V)throw new Error("Invalid mapLib");const G="Map"in V?V:V.default;if(!G.Map)throw new Error("Invalid mapLib");jE(G,i),i.reuseMaps&&(B=tg.reuse(i,_.current)),B||(B=new tg(G.Map,i,_.current)),v.map=zE(B),v.mapLib=G,m(B),l?.onMapMount(v.map,i.id)}).catch(V=>{const{onError:G}=i;G?G({type:"error",target:null,originalEvent:null,error:V}):console.error(V)}),()=>{z=!1,B&&(l?.onMapUnmount(i.id),i.reuseMaps?B.recycle():B.destroy())}},[]),OE(()=>{d&&d.setProps(i)}),ce.useImperativeHandle(n,()=>v.map,[d]);const c=ce.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),C={height:"100%"};return ce.createElement("div",{id:i.id,ref:_,style:c},d&&ce.createElement(mg.Provider,{value:v},ce.createElement("div",{"mapboxgl-children":"",style:C},i.children)))}const FE=ce.forwardRef(BE);var ax=t2();const lp=Sp(ax),UE=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ad(i,n){if(!i||!n)return;const l=i.style;for(const d in n){const m=n[d];Number.isFinite(m)&&!UE.test(d)?l[d]=`${m}px`:l[d]=m}}function i2(i,n){if(i===n)return null;const l=g1(i),d=g1(n),m=[];for(const _ of d)l.has(_)||m.push(_);for(const _ of l)d.has(_)||m.push(_);return m.length===0?null:m}function g1(i){return new Set(i?i.trim().split(/\s+/):[])}const y1=ce.memo(ce.forwardRef((i,n)=>{const{map:l,mapLib:d}=ce.useContext(mg),m=ce.useRef({props:i}),_=ce.useMemo(()=>{let Ie=!1;ce.Children.forEach(i.children,He=>{He&&(Ie=!0)});const Ge={...i,element:Ie?document.createElement("div"):void 0},je=new d.Marker(Ge);return je.setLngLat([i.longitude,i.latitude]),je.getElement().addEventListener("click",He=>{m.current.props.onClick?.({type:"click",target:je,originalEvent:He})}),je.on("dragstart",He=>{const Ve=He;Ve.lngLat=_.getLngLat(),m.current.props.onDragStart?.(Ve)}),je.on("drag",He=>{const Ve=He;Ve.lngLat=_.getLngLat(),m.current.props.onDrag?.(Ve)}),je.on("dragend",He=>{const Ve=He;Ve.lngLat=_.getLngLat(),m.current.props.onDragEnd?.(Ve)}),je},[]);ce.useEffect(()=>(_.addTo(l.getMap()),()=>{_.remove()}),[]);const{longitude:v,latitude:c,offset:C,style:R,draggable:z=!1,popup:B=null,rotation:V=0,rotationAlignment:G="auto",pitchAlignment:re="auto"}=i;ce.useEffect(()=>{ad(_.getElement(),R)},[R]),ce.useImperativeHandle(n,()=>_,[]);const fe=m.current.props;(_.getLngLat().lng!==v||_.getLngLat().lat!==c)&&_.setLngLat([v,c]),C&&!kE(_.getOffset(),C)&&_.setOffset(C),_.isDraggable()!==z&&_.setDraggable(z),_.getRotation()!==V&&_.setRotation(V),_.getRotationAlignment()!==G&&_.setRotationAlignment(G),_.getPitchAlignment()!==re&&_.setPitchAlignment(re),_.getPopup()!==B&&_.setPopup(B);const pe=i2(fe.className,i.className);if(pe)for(const Ie of pe)_.toggleClassName(Ie);return m.current.props=i,ax.createPortal(i.children,_.getElement())})),r2=ce.memo(ce.forwardRef((i,n)=>{const{map:l,mapLib:d}=ce.useContext(mg),m=ce.useMemo(()=>document.createElement("div"),[]),_=ce.useRef({props:i}),v=ce.useMemo(()=>{const c={...i},C=new d.Popup(c);return C.setLngLat([i.longitude,i.latitude]),C.once("open",R=>{_.current.props.onOpen?.(R)}),C},[]);if(ce.useEffect(()=>{const c=C=>{_.current.props.onClose?.(C)};return v.on("close",c),v.setDOMContent(m).addTo(l.getMap()),()=>{v.off("close",c),v.isOpen()&&v.remove()}},[]),ce.useEffect(()=>{ad(v.getElement(),i.style)},[i.style]),ce.useImperativeHandle(n,()=>v,[]),v.isOpen()){const c=_.current.props;(v.getLngLat().lng!==i.longitude||v.getLngLat().lat!==i.latitude)&&v.setLngLat([i.longitude,i.latitude]),i.offset&&!wo(c.offset,i.offset)&&v.setOffset(i.offset),(c.anchor!==i.anchor||c.maxWidth!==i.maxWidth)&&(v.options.anchor=i.anchor,v.setMaxWidth(i.maxWidth));const C=i2(c.className,i.className);if(C)for(const R of C)v.toggleClassName(R);_.current.props=i}return ax.createPortal(i.children,m)}));function Ep(i,n,l,d){const m=ce.useContext(mg),_=ce.useMemo(()=>i(m),[]);return ce.useEffect(()=>{const v=n,c=null,C=typeof n=="function"?n:null,{map:R}=m;return R.hasControl(_)||(R.addControl(_,v?.position),c&&c(m)),()=>{C&&C(m),R.hasControl(_)&&R.removeControl(_)}},[]),_}function VE(i){const n=Ep(({mapLib:l})=>new l.AttributionControl(i),{position:i.position});return ce.useEffect(()=>{ad(n._container,i.style)},[i.style]),null}ce.memo(VE);function GE(i){const n=Ep(({mapLib:l})=>new l.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return ce.useEffect(()=>{ad(n._controlContainer,i.style)},[i.style]),null}ce.memo(GE);function ZE(i,n){const l=ce.useRef({props:i}),d=Ep(({mapLib:m})=>{const _=new m.GeolocateControl(i),v=_._setupUI;return _._setupUI=()=>{_._container.hasChildNodes()||v()},_.on("geolocate",c=>{l.current.props.onGeolocate?.(c)}),_.on("error",c=>{l.current.props.onError?.(c)}),_.on("outofmaxbounds",c=>{l.current.props.onOutOfMaxBounds?.(c)}),_.on("trackuserlocationstart",c=>{l.current.props.onTrackUserLocationStart?.(c)}),_.on("trackuserlocationend",c=>{l.current.props.onTrackUserLocationEnd?.(c)}),_},{position:i.position});return l.current.props=i,ce.useImperativeHandle(n,()=>d,[]),ce.useEffect(()=>{ad(d._container,i.style)},[i.style]),null}ce.memo(ce.forwardRef(ZE));function $E(i){const n=Ep(({mapLib:l})=>new l.NavigationControl(i),{position:i.position});return ce.useEffect(()=>{ad(n._container,i.style)},[i.style]),null}const YE=ce.memo($E);function qE(i){const n=Ep(({mapLib:_})=>new _.ScaleControl(i),{position:i.position}),l=ce.useRef(i),d=l.current;l.current=i;const{style:m}=i;return i.maxWidth!==void 0&&i.maxWidth!==d.maxWidth&&(n.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==d.unit&&n.setUnit(i.unit),ce.useEffect(()=>{ad(n._container,m)},[m]),null}ce.memo(qE);function HE(i){const n=Ep(({mapLib:l})=>new l.TerrainControl(i),{position:i.position});return ce.useEffect(()=>{ad(n._container,i.style)},[i.style]),null}ce.memo(HE);function XE(i){const n=Ep(({mapLib:l})=>new l.LogoControl(i),{position:i.position});return ce.useEffect(()=>{ad(n._container,i.style)},[i.style]),null}ce.memo(XE);function j0(i,n){if(!i)throw new Error(n)}let WE=0;function QE(i,n,l){if(i.style&&i.style._loaded){const d={...l};return delete d.id,delete d.children,i.addSource(n,d),i.getSource(n)}return null}function KE(i,n,l){j0(n.id===l.id,"source id changed"),j0(n.type===l.type,"source type changed");let d="",m=0;for(const v in n)v!=="children"&&v!=="id"&&!wo(l[v],n[v])&&(d=v,m++);if(!m)return;const _=n.type;if(_==="geojson")i.setData(n.data);else if(_==="image")i.updateImage({url:n.url,coordinates:n.coordinates});else switch(d){case"coordinates":i.setCoordinates?.(n.coordinates);break;case"url":i.setUrl?.(n.url);break;case"tiles":i.setTiles?.(n.tiles);break;default:console.warn(`Unable to update <Source> prop: ${d}`)}}function JE(i){const n=ce.useContext(mg).map.getMap(),l=ce.useRef(i),[,d]=ce.useState(0),m=ce.useMemo(()=>i.id||`jsx-source-${WE++}`,[]);ce.useEffect(()=>{if(n){const v=()=>setTimeout(()=>d(c=>c+1),0);return n.on("styledata",v),v(),()=>{if(n.off("styledata",v),n.style&&n.style._loaded&&n.getSource(m)){const c=n.getStyle()?.layers;if(c)for(const C of c)C.source===m&&n.removeLayer(C.id);n.removeSource(m)}}}},[n]);let _=n&&n.style&&n.getSource(m);return _?KE(_,i,l.current):_=QE(n,m,i),l.current=i,_&&ce.Children.map(i.children,v=>v&&ce.cloneElement(v,{source:m}))||null}function eA(i,n,l,d){if(j0(l.id===d.id,"layer id changed"),j0(l.type===d.type,"layer type changed"),l.type==="custom"||d.type==="custom")return;const{layout:m={},paint:_={},filter:v,minzoom:c,maxzoom:C,beforeId:R}=l;if(R!==d.beforeId&&i.moveLayer(n,R),m!==d.layout){const z=d.layout||{};for(const B in m)wo(m[B],z[B])||i.setLayoutProperty(n,B,m[B]);for(const B in z)m.hasOwnProperty(B)||i.setLayoutProperty(n,B,void 0)}if(_!==d.paint){const z=d.paint||{};for(const B in _)wo(_[B],z[B])||i.setPaintProperty(n,B,_[B]);for(const B in z)_.hasOwnProperty(B)||i.setPaintProperty(n,B,void 0)}wo(v,d.filter)||i.setFilter(n,v),(c!==d.minzoom||C!==d.maxzoom)&&i.setLayerZoomRange(n,c,C)}function tA(i,n,l){if(i.style&&i.style._loaded&&(!("source"in l)||i.getSource(l.source))){const d={...l,id:n};delete d.beforeId,i.addLayer(d,l.beforeId)}}let nA=0;function _1(i){const n=ce.useContext(mg).map.getMap(),l=ce.useRef(i),[,d]=ce.useState(0),m=ce.useMemo(()=>i.id||`jsx-layer-${nA++}`,[]);if(ce.useEffect(()=>{if(n){const v=()=>d(c=>c+1);return n.on("styledata",v),v(),()=>{n.off("styledata",v),n.style&&n.style._loaded&&n.getLayer(m)&&n.removeLayer(m)}}},[n]),n&&n.style&&n.getLayer(m))try{eA(n,m,i,l.current)}catch(v){console.warn(v)}else tA(n,m,i);return l.current=i,null}var R0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.2/LICENSE.txt
 */var iA=R0.exports,v1;function rA(){return v1||(v1=1,function(i,n){(function(l,d){i.exports=d()})(iA,function(){var l={},d={};function m(v,c,C){if(d[v]=C,v==="index"){var R="var sharedModule = {}; ("+d.shared+")(sharedModule); ("+d.worker+")(sharedModule);",z={};return d.shared(z),d.index(l,z),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),l}}m("shared",["exports"],function(v){function c(s,t,a,h){return new(a||(a=Promise))(function(g,x){function S(P){try{D(h.next(P))}catch(L){x(L)}}function A(P){try{D(h.throw(P))}catch(L){x(L)}}function D(P){var L;P.done?g(P.value):(L=P.value,L instanceof a?L:new a(function(F){F(L)})).then(S,A)}D((h=h.apply(s,t||[])).next())})}function C(s,t){this.x=s,this.y=t}function R(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var z,B;typeof SuppressedError=="function"&&SuppressedError,C.prototype={clone(){return new C(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,t){return this.clone()._rotateAround(s,t)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const t=s.x-this.x,a=s.y-this.y;return t*t+a*a},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,t){return Math.atan2(this.x*t-this.y*s,this.x*s+this.y*t)},_matMult(s){const t=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=t,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const t=Math.cos(s),a=Math.sin(s),h=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=h,this},_rotateAround(s,t){const a=Math.cos(s),h=Math.sin(s),g=t.y+h*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-h*(this.y-t.y),this.y=g,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:C},C.convert=function(s){if(s instanceof C)return s;if(Array.isArray(s))return new C(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new C(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};var V=function(){if(B)return z;function s(t,a,h,g){this.cx=3*t,this.bx=3*(h-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(g-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=h,this.p2y=g}return B=1,z=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var h=t,g=0;g<8;g++){var x=this.sampleCurveX(h)-t;if(Math.abs(x)<a)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=x/S}var A=0,D=1;for(h=t,g=0;g<20&&(x=this.sampleCurveX(h),!(Math.abs(x-t)<a));g++)t>x?A=h:D=h,h=.5*(D-A)+A;return h},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},z}(),G=R(V);let re,fe;function pe(){return re==null&&(re=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),re}function Ie(){if(fe==null&&(fe=!1,pe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let h=0;h<5*5;h++){const g=4*h;t.fillStyle=`rgb(${g},${g+1},${g+2})`,t.fillRect(h%5,Math.floor(h/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let h=0;h<5*5*4;h++)if(h%4!=3&&a[h]!==h){fe=!0;break}}}return fe||!1}var Ge=1e-6,je=typeof Float32Array<"u"?Float32Array:Array;function He(){var s=new je(9);return je!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Ve(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function rt(){var s=new je(3);return je!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Je(s){var t=s[0],a=s[1],h=s[2];return Math.sqrt(t*t+a*a+h*h)}function Mt(s,t,a){var h=new je(3);return h[0]=s,h[1]=t,h[2]=a,h}function Ne(s,t,a){return s[0]=t[0]+a[0],s[1]=t[1]+a[1],s[2]=t[2]+a[2],s}function Xe(s,t,a){return s[0]=t[0]*a,s[1]=t[1]*a,s[2]=t[2]*a,s}function _t(s,t,a){var h=t[0],g=t[1],x=t[2],S=a[0],A=a[1],D=a[2];return s[0]=g*D-x*A,s[1]=x*S-h*D,s[2]=h*A-g*S,s}var Rt,Ut=Je;function un(s,t,a){var h=t[0],g=t[1],x=t[2],S=t[3];return s[0]=a[0]*h+a[4]*g+a[8]*x+a[12]*S,s[1]=a[1]*h+a[5]*g+a[9]*x+a[13]*S,s[2]=a[2]*h+a[6]*g+a[10]*x+a[14]*S,s[3]=a[3]*h+a[7]*g+a[11]*x+a[15]*S,s}function Ht(){var s=new je(4);return je!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ue(s,t,a,h){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;t*=x,h*=x,a*=x;var S=Math.sin(t),A=Math.cos(t),D=Math.sin(a),P=Math.cos(a),L=Math.sin(h),F=Math.cos(h);switch(g){case"xyz":s[0]=S*P*F+A*D*L,s[1]=A*D*F-S*P*L,s[2]=A*P*L+S*D*F,s[3]=A*P*F-S*D*L;break;case"xzy":s[0]=S*P*F-A*D*L,s[1]=A*D*F-S*P*L,s[2]=A*P*L+S*D*F,s[3]=A*P*F+S*D*L;break;case"yxz":s[0]=S*P*F+A*D*L,s[1]=A*D*F-S*P*L,s[2]=A*P*L-S*D*F,s[3]=A*P*F+S*D*L;break;case"yzx":s[0]=S*P*F+A*D*L,s[1]=A*D*F+S*P*L,s[2]=A*P*L-S*D*F,s[3]=A*P*F-S*D*L;break;case"zxy":s[0]=S*P*F-A*D*L,s[1]=A*D*F+S*P*L,s[2]=A*P*L+S*D*F,s[3]=A*P*F-S*D*L;break;case"zyx":s[0]=S*P*F-A*D*L,s[1]=A*D*F+S*P*L,s[2]=A*P*L-S*D*F,s[3]=A*P*F+S*D*L;break;default:throw new Error("Unknown angle order "+g)}return s}function ft(){var s=new je(2);return je!=Float32Array&&(s[0]=0,s[1]=0),s}function Dt(s,t){var a=new je(2);return a[0]=s,a[1]=t,a}rt(),Rt=new je(4),je!=Float32Array&&(Rt[0]=0,Rt[1]=0,Rt[2]=0,Rt[3]=0),rt(),Mt(1,0,0),Mt(0,1,0),Ht(),Ht(),He(),ft();const It=8192;function be(s,t,a){return t*(It/(s.tileSize*Math.pow(2,a-s.tileID.overscaledZ)))}function et(s,t){return(s%t+t)%t}function Et(s,t,a){return s*(1-a)+t*a}function bt(s){if(s<=0)return 0;if(s>=1)return 1;const t=s*s,a=t*s;return 4*(s<.5?a:3*(s-t)+a-.75)}function Pt(s,t,a,h){const g=new G(s,t,a,h);return x=>g.solve(x)}const Xt=Pt(.25,.1,.25,1);function Bt(s,t,a){return Math.min(a,Math.max(t,s))}function wi(s,t,a){const h=a-t,g=((s-t)%h+h)%h+t;return g===t?a:g}function fn(s,...t){for(const a of t)for(const h in a)s[h]=a[h];return s}let mi=1;function ya(s,t,a){const h={};for(const g in s)h[g]=t.call(this,s[g],g,s);return h}function sa(s,t,a){const h={};for(const g in s)t.call(this,s[g],g,s)&&(h[g]=s[g]);return h}function rr(s){return Array.isArray(s)?s.map(rr):typeof s=="object"&&s?ya(s,rr):s}const Yn={};function Wn(s){Yn[s]||(typeof console<"u"&&console.warn(s),Yn[s]=!0)}function Nn(s,t,a){return(a.y-s.y)*(t.x-s.x)>(t.y-s.y)*(a.x-s.x)}function Br(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let Li=null;function Ka(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const ka="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function oa(s,t,a,h,g){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(s,{timestamp:0});try{const S=x?.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const A=S.startsWith("BGR"),D=new Uint8ClampedArray(h*g*4);if(yield x.copyTo(D,function(P,L,F,$,H){const X=4*Math.max(-L,0),ee=(Math.max(0,F)-F)*$*4+X,se=4*$,de=Math.max(0,L),ke=Math.max(0,F);return{rect:{x:de,y:ke,width:Math.min(P.width,L+$)-de,height:Math.min(P.height,F+H)-ke},layout:[{offset:ee,stride:se}]}}(s,t,a,h,g)),A)for(let P=0;P<D.length;P+=4){const L=D[P];D[P]=D[P+2],D[P+2]=L}return D}finally{x.close()}})}let Fr,ws;function Ja(s,t,a,h){return s.addEventListener(t,a,h),{unsubscribe:()=>{s.removeEventListener(t,a,h)}}}function Ts(s){return s*Math.PI/180}function Ss(s){return s/Math.PI*180}const la={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Oi={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ur="AbortError";function Ae(){return new Error(Ur)}const K={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function J(s){return K.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const ae="global-dispatcher";class _e extends Error{constructor(t,a,h,g){super(`AJAXError: ${a} (${t}): ${h}`),this.status=t,this.statusText=a,this.url=h,this.body=g}}const Te=()=>Br(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Me=function(s,t){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const h=J(s.url);if(h)return h(s,t);if(Br(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:ae},t)}if(!(/^file:/.test(a=s.url)||/^file:/.test(Te())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(h,g){return c(this,void 0,void 0,function*(){const x=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:Te(),signal:g.signal});let S,A;h.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{S=yield fetch(x)}catch(P){throw new _e(0,P.message,h.url,new Blob)}if(!S.ok){const P=yield S.blob();throw new _e(S.status,S.statusText,h.url,P)}A=h.type==="arrayBuffer"||h.type==="image"?S.arrayBuffer():h.type==="json"?S.json():S.text();const D=yield A;if(g.signal.aborted)throw Ae();return{data:D,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(s,t);if(Br(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:ae},t)}var a;return function(h,g){return new Promise((x,S)=>{var A;const D=new XMLHttpRequest;D.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(D.responseType="arraybuffer");for(const P in h.headers)D.setRequestHeader(P,h.headers[P]);h.type==="json"&&(D.responseType="text",!((A=h.headers)===null||A===void 0)&&A.Accept||D.setRequestHeader("Accept","application/json")),D.withCredentials=h.credentials==="include",D.onerror=()=>{S(new Error(D.statusText))},D.onload=()=>{if(!g.signal.aborted)if((D.status>=200&&D.status<300||D.status===0)&&D.response!==null){let P=D.response;if(h.type==="json")try{P=JSON.parse(D.response)}catch(L){return void S(L)}x({data:P,cacheControl:D.getResponseHeader("Cache-Control"),expires:D.getResponseHeader("Expires")})}else{const P=new Blob([D.response],{type:D.getResponseHeader("Content-Type")});S(new _e(D.status,D.statusText,h.url,P))}},g.signal.addEventListener("abort",()=>{D.abort(),S(Ae())}),D.send(h.body)})}(s,t)};function Fe(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const t=new URL(s),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function Re(s,t,a){a[s]&&a[s].indexOf(t)!==-1||(a[s]=a[s]||[],a[s].push(t))}function tt(s,t,a){if(a&&a[s]){const h=a[s].indexOf(t);h!==-1&&a[s].splice(h,1)}}class ht{constructor(t,a={}){fn(this,a),this.type=t}}class at extends ht{constructor(t,a={}){super("error",fn({error:t},a))}}class Lt{on(t,a){return this._listeners=this._listeners||{},Re(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return tt(t,a,this._listeners),tt(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Re(t,a,this._oneTimeListeners),this):new Promise(h=>this.once(t,h))}fire(t,a){typeof t=="string"&&(t=new ht(t,a||{}));const h=t.type;if(this.listens(h)){t.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const A of g)A.call(this,t);const x=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const A of x)tt(h,A,this._oneTimeListeners),A.call(this,t);const S=this._eventedParent;S&&(fn(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(t))}else t instanceof at&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const en=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function vn(s,t){const a={};for(const h in s)h!=="ref"&&(a[h]=s[h]);return en.forEach(h=>{h in t&&(a[h]=t[h])}),a}function Vt(s,t){if(Array.isArray(s)){if(!Array.isArray(t)||s.length!==t.length)return!1;for(let a=0;a<s.length;a++)if(!Vt(s[a],t[a]))return!1;return!0}if(typeof s=="object"&&s!==null&&t!==null){if(typeof t!="object"||Object.keys(s).length!==Object.keys(t).length)return!1;for(const a in s)if(!Vt(s[a],t[a]))return!1;return!0}return s===t}function sn(s,t){s.push(t)}function ni(s,t,a){sn(a,{command:"addSource",args:[s,t[s]]})}function ar(s,t,a){sn(t,{command:"removeSource",args:[s]}),a[s]=!0}function dr(s,t,a,h){ar(s,a,h),ni(s,t,a)}function ai(s,t,a){let h;for(h in s[a])if(Object.prototype.hasOwnProperty.call(s[a],h)&&h!=="data"&&!Vt(s[a][h],t[a][h]))return!1;for(h in t[a])if(Object.prototype.hasOwnProperty.call(t[a],h)&&h!=="data"&&!Vt(s[a][h],t[a][h]))return!1;return!0}function Wt(s,t,a,h,g,x){s=s||{},t=t||{};for(const S in s)Object.prototype.hasOwnProperty.call(s,S)&&(Vt(s[S],t[S])||a.push({command:x,args:[h,S,t[S],g]}));for(const S in t)Object.prototype.hasOwnProperty.call(t,S)&&!Object.prototype.hasOwnProperty.call(s,S)&&(Vt(s[S],t[S])||a.push({command:x,args:[h,S,t[S],g]}))}function tn(s){return s.id}function Ti(s,t){return s[t.id]=t,s}class gt{constructor(t,a,h,g){this.message=(t?`${t}: `:"")+h,g&&(this.identifier=g),a!=null&&a.__line__&&(this.line=a.__line__)}}function Vr(s,...t){for(const a of t)for(const h in a)s[h]=a[h];return s}class ji extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class Ro{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[h,g]of a)this.bindings[h]=g}concat(t){return new Ro(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const io={kind:"null"},St={kind:"number"},hn={kind:"string"},an={kind:"boolean"},Xi={kind:"color"},es={kind:"projectionDefinition"},Si={kind:"object"},dn={kind:"value"},Vu={kind:"collator"},_a={kind:"formatted"},Io={kind:"padding"},ro={kind:"colorArray"},Fl={kind:"numberArray"},Bi={kind:"resolvedImage"},cd={kind:"variableAnchorOffsetCollection"};function kr(s,t){return{kind:"array",itemType:s,N:t}}function qn(s){if(s.kind==="array"){const t=qn(s.itemType);return typeof s.N=="number"?`array<${t}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${t}>`}return s.kind}const ao=[io,St,hn,an,Xi,es,_a,Si,kr(dn),Io,Fl,ro,Bi,cd];function Ul(s,t){if(t.kind==="error")return null;if(s.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ul(s.itemType,t.itemType))&&(typeof s.N!="number"||s.N===t.N))return null}else{if(s.kind===t.kind)return null;if(s.kind==="value"){for(const a of ao)if(!Ul(a,t))return null}}return`Expected ${qn(s)} but found ${qn(t)} instead.`}function ud(s,t){return t.some(a=>a.kind===s.kind)}function Ra(s,t){return t.some(a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s)}function so(s,t){return s.kind==="array"&&t.kind==="array"?s.itemType.kind===t.itemType.kind&&typeof s.N=="number":s.kind===t.kind}const Gu=.96422,Rp=.82521,_f=4/29,Rr=6/29,vf=3*Rr*Rr,Ag=Rr*Rr*Rr,hd=Math.PI/180,Ip=180/Math.PI;function zc(s){return(s%=360)<0&&(s+=360),s}function Lc([s,t,a,h]){let g,x;const S=Zu((.2225045*(s=va(s))+.7168786*(t=va(t))+.0606169*(a=va(a)))/1);s===t&&t===a?g=x=S:(g=Zu((.4360747*s+.3850649*t+.1430804*a)/Gu),x=Zu((.0139322*s+.0971045*t+.7141733*a)/Rp));const A=116*S-16;return[A<0?0:A,500*(g-S),200*(S-x),h]}function va(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Zu(s){return s>Ag?Math.pow(s,1/3):s/vf+_f}function Vl([s,t,a,h]){let g=(s+16)/116,x=isNaN(t)?g:g+t/500,S=isNaN(a)?g:g-a/200;return g=1*ol(g),x=Gu*ol(x),S=Rp*ol(S),[$u(3.1338561*x-1.6168667*g-.4906146*S),$u(-.9787684*x+1.9161415*g+.033454*S),$u(.0719453*x-.2289914*g+1.4052427*S),h]}function $u(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function ol(s){return s>Rr?s*s*s:vf*(s-_f)}const Pp=Object.hasOwn||function(s,t){return Object.prototype.hasOwnProperty.call(s,t)};function Gl(s,t){return Pp(s,t)?s[t]:void 0}function oo(s){return parseInt(s.padEnd(2,s),16)/255}function Es(s,t){return bn(t?s/100:s,0,1)}function bn(s,t,a){return Math.min(Math.max(t,s),a)}function ll(s){return!s.some(Number.isNaN)}const lo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Po(s,t,a){return s+a*(t-s)}function Zl(s,t,a){return s.map((h,g)=>Po(h,t[g],a))}class gn{constructor(t,a,h,g=1,x=!0){this.r=t,this.g=a,this.b=h,this.a=g,x||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[t,a,h,g]))}static parse(t){if(t instanceof gn)return t;if(typeof t!="string")return;const a=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=Gl(lo,h);if(g){const[S,A,D]=g;return[S/255,A/255,D/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const S=h.length<6?1:2;let A=1;return[oo(h.slice(A,A+=S)),oo(h.slice(A,A+=S)),oo(h.slice(A,A+=S)),oo(h.slice(A,A+S)||"ff")]}if(h.startsWith("rgb")){const S=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[A,D,P,L,F,$,H,X,ee,se,de,ke]=S,ve=[L||" ",H||" ",se].join("");if(ve==="  "||ve==="  /"||ve===",,"||ve===",,,"){const Se=[P,$,ee].join(""),Be=Se==="%%%"?100:Se===""?255:0;if(Be){const Qe=[bn(+D/Be,0,1),bn(+F/Be,0,1),bn(+X/Be,0,1),de?Es(+de,ke):1];if(ll(Qe))return Qe}}return}}const x=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[S,A,D,P,L,F,$,H,X]=x,ee=[D||" ",L||" ",$].join("");if(ee==="  "||ee==="  /"||ee===",,"||ee===",,,"){const se=[+A,bn(+P,0,100),bn(+F,0,100),H?Es(+H,X):1];if(ll(se))return function([de,ke,ve,Se]){function Be(Qe){const lt=(Qe+de/30)%12,Tt=ke*Math.min(ve,1-ve);return ve-Tt*Math.max(-1,Math.min(lt-3,9-lt,1))}return de=zc(de),ke/=100,ve/=100,[Be(0),Be(8),Be(4),Se]}(se)}}}(t);return a?new gn(...a,!1):void 0}get rgb(){const{r:t,g:a,b:h,a:g}=this,x=g||1/0;return this.overwriteGetter("rgb",[t/x,a/x,h/x,g])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,h,g,x]=Lc(t),S=Math.sqrt(h*h+g*g);return[Math.round(1e4*S)?zc(Math.atan2(g,h)*Ip):NaN,S,a,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Lc(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,h,g]=this.rgb;return`rgba(${[t,a,h].map(x=>Math.round(255*x)).join(",")},${g})`}static interpolate(t,a,h,g="rgb"){switch(g){case"rgb":{const[x,S,A,D]=Zl(t.rgb,a.rgb,h);return new gn(x,S,A,D,!1)}case"hcl":{const[x,S,A,D]=t.hcl,[P,L,F,$]=a.hcl;let H,X;if(isNaN(x)||isNaN(P))isNaN(x)?isNaN(P)?H=NaN:(H=P,A!==1&&A!==0||(X=L)):(H=x,F!==1&&F!==0||(X=S));else{let ve=P-x;P>x&&ve>180?ve-=360:P<x&&x-P>180&&(ve+=360),H=x+h*ve}const[ee,se,de,ke]=function([ve,Se,Be,Qe]){return ve=isNaN(ve)?0:ve*hd,Vl([Be,Math.cos(ve)*Se,Math.sin(ve)*Se,Qe])}([H,X??Po(S,L,h),Po(A,F,h),Po(D,$,h)]);return new gn(ee,se,de,ke,!1)}case"lab":{const[x,S,A,D]=Vl(Zl(t.lab,a.lab,h));return new gn(x,S,A,D,!1)}}}}gn.black=new gn(0,0,0,1),gn.white=new gn(1,1,1,1),gn.transparent=new gn(0,0,0,0),gn.red=new gn(1,0,0,1);class No{constructor(t,a,h){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Oc=["bottom","center","top"];class zo{constructor(t,a,h,g,x,S){this.text=t,this.image=a,this.scale=h,this.fontStack=g,this.textColor=x,this.verticalAlign=S}}class sr{constructor(t){this.sections=t}static fromString(t){return new sr([new zo(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof sr?t:sr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class fr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof fr)return t;if(typeof t=="number")return new fr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new fr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h){return new fr(Zl(t.values,a.values,h))}}class Ir{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ir)return t;if(typeof t=="number")return new Ir([t]);if(Array.isArray(t)){for(const a of t)if(typeof a!="number")return;return new Ir(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h){return new Ir(Zl(t.values,a.values,h))}}class Wi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Wi)return t;if(typeof t=="string"){const h=gn.parse(t);return h?new Wi([h]):void 0}if(!Array.isArray(t))return;const a=[];for(const h of t){if(typeof h!="string")return;const g=gn.parse(h);if(!g)return;a.push(g)}return new Wi(a)}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h,g="rgb"){const x=[];if(t.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let S=0;S<t.values.length;S++)x.push(gn.interpolate(t.values[S],a.values[S],h,g));return new Wi(x)}}class Vn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const co=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Pr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Pr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const h=t[a],g=t[a+1];if(typeof h!="string"||!co.has(h)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new Pr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h){const g=t.values,x=a.values;if(g.length!==x.length)throw new Vn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const S=[];for(let A=0;A<g.length;A+=2){if(g[A]!==x[A])throw new Vn(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${g[A]}, to[${A}]: ${x[A]}`);S.push(g[A]);const[D,P]=g[A+1],[L,F]=x[A+1];S.push([Po(D,L,h),Po(P,F,h)])}return new Pr(S)}}class Nr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Nr({name:t,available:!1}):null}}class Fi{constructor(t,a,h){this.from=t,this.to=a,this.transition=h}static interpolate(t,a,h){return new Fi(t,a,h)}static parse(t){return t instanceof Fi?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Fi(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Fi(t.from,t.to,t.transition):typeof t=="string"?new Fi(t,t,1):void 0}}function si(s,t,a,h){return typeof s=="number"&&s>=0&&s<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[s,t,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[s,t,a,h]:[s,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function uo(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Fi||s instanceof gn||s instanceof No||s instanceof sr||s instanceof fr||s instanceof Ir||s instanceof Wi||s instanceof Pr||s instanceof Nr)return!0;if(Array.isArray(s)){for(const t of s)if(!uo(t))return!1;return!0}if(typeof s=="object"){for(const t in s)if(!uo(s[t]))return!1;return!0}return!1}function qt(s){if(s===null)return io;if(typeof s=="string")return hn;if(typeof s=="boolean")return an;if(typeof s=="number")return St;if(s instanceof gn)return Xi;if(s instanceof Fi)return es;if(s instanceof No)return Vu;if(s instanceof sr)return _a;if(s instanceof fr)return Io;if(s instanceof Ir)return Fl;if(s instanceof Wi)return ro;if(s instanceof Pr)return cd;if(s instanceof Nr)return Bi;if(Array.isArray(s)){const t=s.length;let a;for(const h of s){const g=qt(h);if(a){if(a===g)continue;a=dn;break}a=g}return kr(a||dn,t)}return Si}function nn(s){const t=typeof s;return s===null?"":t==="string"||t==="number"||t==="boolean"?String(s):s instanceof gn||s instanceof Fi||s instanceof sr||s instanceof fr||s instanceof Ir||s instanceof Wi||s instanceof Pr||s instanceof Nr?s.toString():JSON.stringify(s)}class ts{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!uo(t[1]))return a.error("invalid value");const h=t[1];let g=qt(h);const x=a.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new ts(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Mn={string:hn,number:St,boolean:an,object:Si};class gi{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let h,g=1;const x=t[0];if(x==="array"){let A,D;if(t.length>2){const P=t[1];if(typeof P!="string"||!(P in Mn)||P==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);A=Mn[P],g++}else A=dn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);D=t[2],g++}h=kr(A,D)}else{if(!Mn[x])throw new Error(`Types doesn't contain name = ${x}`);h=Mn[x]}const S=[];for(;g<t.length;g++){const A=a.parse(t[g],g,dn);if(!A)return null;S.push(A)}return new gi(h,S)}evaluate(t){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(t);if(!Ul(this.type,qt(h)))return h;if(a===this.args.length-1)throw new Vn(`Expected value to be of type ${qn(this.type)}, but found ${qn(qt(h))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Gr={"to-boolean":an,"to-color":Xi,"to-number":St,"to-string":hn};class Ia{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[0];if(!Gr[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&t.length!==2)return a.error("Expected one argument.");const g=Gr[h],x=[];for(let S=1;S<t.length;S++){const A=a.parse(t[S],S,dn);if(!A)return null;x.push(A)}return new Ia(g,x)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,h;for(const g of this.args){if(a=g.evaluate(t),h=null,a instanceof gn)return a;if(typeof a=="string"){const x=t.parseColor(a);if(x)return x}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:si(a[0],a[1],a[2],a[3]),!h))return new gn(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Vn(h||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const h of this.args){a=h.evaluate(t);const g=fr.parse(a);if(g)return g}throw new Vn(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const h of this.args){a=h.evaluate(t);const g=Ir.parse(a);if(g)return g}throw new Vn(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const h of this.args){a=h.evaluate(t);const g=Wi.parse(a);if(g)return g}throw new Vn(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const h of this.args){a=h.evaluate(t);const g=Pr.parse(a);if(g)return g}throw new Vn(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const h of this.args){if(a=h.evaluate(t),a===null)return 0;const g=Number(a);if(!isNaN(g))return g}throw new Vn(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return sr.fromString(nn(this.args[0].evaluate(t)));case"resolvedImage":return Nr.fromString(nn(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return nn(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const cl=["Unknown","Point","LineString","Polygon"];class bf{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?cl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache.get(t);return a||(a=gn.parse(t),this._parseColorCache.set(t,a)),a}}class ul{constructor(t,a,h=[],g,x=new Ro,S=[]){this.registry=t,this.path=h,this.key=h.map(A=>`[${A}]`).join(""),this.scope=x,this.errors=S,this.expectedType=g,this._isConstant=a}parse(t,a,h,g,x={}){return a?this.concat(a,h,g)._parse(t,x):this._parse(t,x)}_parse(t,a){function h(g,x,S){return S==="assert"?new gi(x,[g]):S==="coerce"?new Ia(x,[g]):g}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=t[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let S=x.parse(t,this);if(!S)return null;if(this.expectedType){const A=this.expectedType,D=S.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||D.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(D.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(D.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(D.kind)||A.kind==="colorArray"&&["value","string","array"].includes(D.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(D.kind))S=h(S,A,a.typeAnnotation||"coerce");else if(this.checkSubtype(A,D))return null}else S=h(S,A,a.typeAnnotation||"assert")}if(!(S instanceof ts)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const A=new bf;try{S=new ts(S.type,S.evaluate(A))}catch(D){return this.error(D.message),null}}return S}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,h){const g=typeof t=="number"?this.path.concat(t):this.path,x=h?this.scope.concat(h):this.scope;return new ul(this.registry,this._isConstant,g,a||null,x,this.errors)}error(t,...a){const h=`${this.key}${a.map(g=>`[${g}]`).join("")}`;this.errors.push(new ji(h,t))}checkSubtype(t,a){const h=Ul(t,a);return h&&this.error(h),h}}class $l{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const h=[];for(let x=1;x<t.length-1;x+=2){const S=t[x];if(typeof S!="string")return a.error(`Expected string, but found ${typeof S} instead.`,x);if(/[^a-zA-Z0-9_]/.test(S))return a.error("Variable names must contain only alphanumeric characters or '_'.",x);const A=a.parse(t[x+1],x+1);if(!A)return null;h.push([S,A])}const g=a.parse(t[t.length-1],t.length-1,a.expectedType,h);return g?new $l(h,g):null}outputDefined(){return this.result.outputDefined()}}class hl{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=t[1];return a.scope.has(h)?new hl(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Yl{constructor(t,a,h){this.type=t,this.index=a,this.input=h}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,St),g=a.parse(t[2],2,kr(a.expectedType||dn));return h&&g?new Yl(g.type.itemType,h,g):null}evaluate(t){const a=this.index.evaluate(t),h=this.input.evaluate(t);if(a<0)throw new Vn(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new Vn(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new Vn(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Yu{constructor(t,a){this.type=an,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,dn),g=a.parse(t[2],2,dn);return h&&g?ud(h.type,[an,hn,St,io,dn])?new Yu(h,g):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${qn(h.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!h)return!1;if(!Ra(a,["boolean","string","number","null"]))throw new Vn(`Expected first argument to be of type boolean, string, number or null, but found ${qn(qt(a))} instead.`);if(!Ra(h,["string","array"]))throw new Vn(`Expected second argument to be of type array or string, but found ${qn(qt(h))} instead.`);return h.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class As{constructor(t,a,h){this.type=St,this.needle=t,this.haystack=a,this.fromIndex=h}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,dn),g=a.parse(t[2],2,dn);if(!h||!g)return null;if(!ud(h.type,[an,hn,St,io,dn]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${qn(h.type)} instead`);if(t.length===4){const x=a.parse(t[3],3,St);return x?new As(h,g,x):null}return new As(h,g)}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!Ra(a,["boolean","string","number","null"]))throw new Vn(`Expected first argument to be of type boolean, string, number or null, but found ${qn(qt(a))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(t)),Ra(h,["string"])){const x=h.indexOf(a,g);return x===-1?-1:[...h.slice(0,x)].length}if(Ra(h,["array"]))return h.indexOf(a,g);throw new Vn(`Expected second argument to be of type array or string, but found ${qn(qt(h))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Tr{constructor(t,a,h,g,x,S){this.inputType=t,this.type=a,this.input=h,this.cases=g,this.outputs=x,this.otherwise=S}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let h,g;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);const x={},S=[];for(let P=2;P<t.length-1;P+=2){let L=t[P];const F=t[P+1];Array.isArray(L)||(L=[L]);const $=a.concat(P);if(L.length===0)return $.error("Expected at least one branch label.");for(const X of L){if(typeof X!="number"&&typeof X!="string")return $.error("Branch labels must be numbers or strings.");if(typeof X=="number"&&Math.abs(X)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof X=="number"&&Math.floor(X)!==X)return $.error("Numeric branch labels must be integer values.");if(h){if($.checkSubtype(h,qt(X)))return null}else h=qt(X);if(x[String(X)]!==void 0)return $.error("Branch labels must be unique.");x[String(X)]=S.length}const H=a.parse(F,P,g);if(!H)return null;g=g||H.type,S.push(H)}const A=a.parse(t[1],1,dn);if(!A)return null;const D=a.parse(t[t.length-1],t.length-1,g);return D?A.type.kind!=="value"&&a.concat(1).checkSubtype(h,A.type)?null:new Tr(h,g,A,x,S,D):null}evaluate(t){const a=this.input.evaluate(t);return(qt(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class jc{constructor(t,a,h){this.type=t,this.branches=a,this.otherwise=h}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const g=[];for(let S=1;S<t.length-1;S+=2){const A=a.parse(t[S],S,an);if(!A)return null;const D=a.parse(t[S+1],S+1,h);if(!D)return null;g.push([A,D]),h=h||D.type}const x=a.parse(t[t.length-1],t.length-1,h);if(!x)return null;if(!h)throw new Error("Can't infer output type");return new jc(h,g,x)}evaluate(t){for(const[a,h]of this.branches)if(a.evaluate(t))return h.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,h]of this.branches)t(a),t(h);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class ql{constructor(t,a,h,g){this.type=t,this.input=a,this.beginIndex=h,this.endIndex=g}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,dn),g=a.parse(t[2],2,St);if(!h||!g)return null;if(!ud(h.type,[kr(dn),hn,dn]))return a.error(`Expected first argument to be of type array or string, but found ${qn(h.type)} instead`);if(t.length===4){const x=a.parse(t[3],3,St);return x?new ql(h.type,h,g,x):null}return new ql(h.type,h,g)}evaluate(t){const a=this.input.evaluate(t),h=this.beginIndex.evaluate(t);let g;if(this.endIndex&&(g=this.endIndex.evaluate(t)),Ra(a,["string"]))return[...a].slice(h,g).join("");if(Ra(a,["array"]))return a.slice(h,g);throw new Vn(`Expected first argument to be of type array or string, but found ${qn(qt(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Hl(s,t){const a=s.length-1;let h,g,x=0,S=a,A=0;for(;x<=S;)if(A=Math.floor((x+S)/2),h=s[A],g=s[A+1],h<=t){if(A===a||t<g)return A;x=A+1}else{if(!(h>t))throw new Vn("Input is not a number.");S=A-1}return 0}class Zi{constructor(t,a,h){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[g,x]of h)this.labels.push(g),this.outputs.push(x)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(t[1],1,St);if(!h)return null;const g=[];let x=null;a.expectedType&&a.expectedType.kind!=="value"&&(x=a.expectedType);for(let S=1;S<t.length;S+=2){const A=S===1?-1/0:t[S],D=t[S+1],P=S,L=S+1;if(typeof A!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(g.length&&g[g.length-1][0]>=A)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const F=a.parse(D,L,x);if(!F)return null;x=x||F.type,g.push([A,F])}return new Zi(x,h,g)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const g=this.input.evaluate(t);if(g<=a[0])return h[0].evaluate(t);const x=a.length;return g>=a[x-1]?h[x-1].evaluate(t):h[Hl(a,g)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Np(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var qu,xf,zp=function(){if(xf)return qu;function s(t,a,h,g){this.cx=3*t,this.bx=3*(h-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(g-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=h,this.p2y=g}return xf=1,qu=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var h=t,g=0;g<8;g++){var x=this.sampleCurveX(h)-t;if(Math.abs(x)<a)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=x/S}var A=0,D=1;for(h=t,g=0;g<20&&(x=this.sampleCurveX(h),!(Math.abs(x-t)<a));g++)t>x?A=h:D=h,h=.5*(D-A)+A;return h},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},qu}(),Bc=Np(zp);class zr{constructor(t,a,h,g,x){this.type=t,this.operator=a,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[S,A]of x)this.labels.push(S),this.outputs.push(A)}static interpolationFactor(t,a,h,g){let x=0;if(t.name==="exponential")x=Hu(a,t.base,h,g);else if(t.name==="linear")x=Hu(a,1,h,g);else if(t.name==="cubic-bezier"){const S=t.controlPoints;x=new Bc(S[0],S[1],S[2],S[3]).solve(Hu(a,1,h,g))}return x}static parse(t,a){let[h,g,x,...S]=t;if(!Array.isArray(g)||g.length===0)return a.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const P=g[1];if(typeof P!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:P}}else{if(g[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const P=g.slice(1);if(P.length!==4||P.some(L=>typeof L!="number"||L<0||L>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:P}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(x=a.parse(x,2,St),!x)return null;const A=[];let D=null;h!=="interpolate-hcl"&&h!=="interpolate-lab"||a.expectedType==ro?a.expectedType&&a.expectedType.kind!=="value"&&(D=a.expectedType):D=Xi;for(let P=0;P<S.length;P+=2){const L=S[P],F=S[P+1],$=P+3,H=P+4;if(typeof L!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(A.length&&A[A.length-1][0]>=L)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const X=a.parse(F,H,D);if(!X)return null;D=D||X.type,A.push([L,X])}return so(D,St)||so(D,es)||so(D,Xi)||so(D,Io)||so(D,Fl)||so(D,ro)||so(D,cd)||so(D,kr(St))?new zr(D,h,g,x,A):a.error(`Type ${qn(D)} is not interpolatable.`)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const g=this.input.evaluate(t);if(g<=a[0])return h[0].evaluate(t);const x=a.length;if(g>=a[x-1])return h[x-1].evaluate(t);const S=Hl(a,g),A=zr.interpolationFactor(this.interpolation,g,a[S],a[S+1]),D=h[S].evaluate(t),P=h[S+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Po(D,P,A);case"color":return gn.interpolate(D,P,A);case"padding":return fr.interpolate(D,P,A);case"colorArray":return Wi.interpolate(D,P,A);case"numberArray":return Ir.interpolate(D,P,A);case"variableAnchorOffsetCollection":return Pr.interpolate(D,P,A);case"array":return Zl(D,P,A);case"projectionDefinition":return Fi.interpolate(D,P,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return gn.interpolate(D,P,A,"hcl");case"colorArray":return Wi.interpolate(D,P,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return gn.interpolate(D,P,A,"lab");case"colorArray":return Wi.interpolate(D,P,A,"lab")}}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Hu(s,t,a,h){const g=h-a,x=s-a;return g===0?0:t===1?x/g:(Math.pow(t,x)-1)/(Math.pow(t,g)-1)}const ho={color:gn.interpolate,number:Po,padding:fr.interpolate,numberArray:Ir.interpolate,colorArray:Wi.interpolate,variableAnchorOffsetCollection:Pr.interpolate,array:Zl};class Xl{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let h=null;const g=a.expectedType;g&&g.kind!=="value"&&(h=g);const x=[];for(const A of t.slice(1)){const D=a.parse(A,1+x.length,h,void 0,{typeAnnotation:"omit"});if(!D)return null;h=h||D.type,x.push(D)}if(!h)throw new Error("No output type");const S=g&&x.some(A=>Ul(g,A.type));return new Xl(S?dn:h,x)}evaluate(t){let a,h=null,g=0;for(const x of this.args)if(g++,h=x.evaluate(t),h&&h instanceof Nr&&!h.available&&(a||(a=h.name),h=null,g===this.args.length&&(h=a)),h!==null)break;return h}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Xu(s,t){return s==="=="||s==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Wu(s,t,a,h){return h.compare(t,a)===0}function Zr(s,t,a){const h=s!=="=="&&s!=="!=";return class a2{constructor(x,S,A){this.type=an,this.lhs=x,this.rhs=S,this.collator=A,this.hasUntypedArgument=x.type.kind==="value"||S.type.kind==="value"}static parse(x,S){if(x.length!==3&&x.length!==4)return S.error("Expected two or three arguments.");const A=x[0];let D=S.parse(x[1],1,dn);if(!D)return null;if(!Xu(A,D.type))return S.concat(1).error(`"${A}" comparisons are not supported for type '${qn(D.type)}'.`);let P=S.parse(x[2],2,dn);if(!P)return null;if(!Xu(A,P.type))return S.concat(2).error(`"${A}" comparisons are not supported for type '${qn(P.type)}'.`);if(D.type.kind!==P.type.kind&&D.type.kind!=="value"&&P.type.kind!=="value")return S.error(`Cannot compare types '${qn(D.type)}' and '${qn(P.type)}'.`);h&&(D.type.kind==="value"&&P.type.kind!=="value"?D=new gi(P.type,[D]):D.type.kind!=="value"&&P.type.kind==="value"&&(P=new gi(D.type,[P])));let L=null;if(x.length===4){if(D.type.kind!=="string"&&P.type.kind!=="string"&&D.type.kind!=="value"&&P.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(L=S.parse(x[3],3,Vu),!L)return null}return new a2(D,P,L)}evaluate(x){const S=this.lhs.evaluate(x),A=this.rhs.evaluate(x);if(h&&this.hasUntypedArgument){const D=qt(S),P=qt(A);if(D.kind!==P.kind||D.kind!=="string"&&D.kind!=="number")throw new Vn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${D.kind}, ${P.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const D=qt(S),P=qt(A);if(D.kind!=="string"||P.kind!=="string")return t(x,S,A)}return this.collator?a(x,S,A,this.collator.evaluate(x)):t(x,S,A)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const wf=Zr("==",function(s,t,a){return t===a},Wu),dd=Zr("!=",function(s,t,a){return t!==a},function(s,t,a,h){return!Wu(0,t,a,h)}),Mg=Zr("<",function(s,t,a){return t<a},function(s,t,a,h){return h.compare(t,a)<0}),Tf=Zr(">",function(s,t,a){return t>a},function(s,t,a,h){return h.compare(t,a)>0}),Cg=Zr("<=",function(s,t,a){return t<=a},function(s,t,a,h){return h.compare(t,a)<=0}),Dg=Zr(">=",function(s,t,a){return t>=a},function(s,t,a,h){return h.compare(t,a)>=0});class fd{constructor(t,a,h){this.type=Vu,this.locale=h,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const h=t[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const g=a.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,an);if(!g)return null;const x=a.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,an);if(!x)return null;let S=null;return h.locale&&(S=a.parse(h.locale,1,hn),!S)?null:new fd(g,x,S)}evaluate(t){return new No(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Sf{constructor(t,a,h,g,x){this.type=hn,this.number=t,this.locale=a,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=x}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const h=a.parse(t[1],1,St);if(!h)return null;const g=t[2];if(typeof g!="object"||Array.isArray(g))return a.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=a.parse(g.locale,1,hn),!x))return null;let S=null;if(g.currency&&(S=a.parse(g.currency,1,hn),!S))return null;let A=null;if(g["min-fraction-digits"]&&(A=a.parse(g["min-fraction-digits"],1,St),!A))return null;let D=null;return g["max-fraction-digits"]&&(D=a.parse(g["max-fraction-digits"],1,St),!D)?null:new Sf(h,x,S,A,D)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Wl{constructor(t){this.type=_a,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const g=[];let x=!1;for(let S=1;S<=t.length-1;++S){const A=t[S];if(x&&typeof A=="object"&&!Array.isArray(A)){x=!1;let D=null;if(A["font-scale"]&&(D=a.parse(A["font-scale"],1,St),!D))return null;let P=null;if(A["text-font"]&&(P=a.parse(A["text-font"],1,kr(hn)),!P))return null;let L=null;if(A["text-color"]&&(L=a.parse(A["text-color"],1,Xi),!L))return null;let F=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!Oc.includes(A["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(F=a.parse(A["vertical-align"],1,hn),!F)return null}const $=g[g.length-1];$.scale=D,$.font=P,$.textColor=L,$.verticalAlign=F}else{const D=a.parse(t[S],1,dn);if(!D)return null;const P=D.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:D,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Wl(g)}evaluate(t){return new sr(this.sections.map(a=>{const h=a.content.evaluate(t);return qt(h)===Bi?new zo("",h,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new zo(nn(h),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class Ef{constructor(t){this.type=Bi,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const h=a.parse(t[1],1,hn);return h?new Ef(h):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),h=Nr.fromString(a);return h&&t.availableImages&&(h.available=t.availableImages.indexOf(a)>-1),h}eachChild(t){t(this.input)}outputDefined(){return!1}}class Fc{constructor(t){this.type=St,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=a.parse(t[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${qn(h.type)} instead.`):new Fc(h):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Vn(`Expected value to be of type string or array, but found ${qn(qt(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const ca=8192;function kg(s,t){const a=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,g=Math.pow(2,t.z);return[Math.round(a*g*ca),Math.round(h*g*ca)]}function Qu(s,t){const a=Math.pow(2,t.z);return[(g=(s[0]/ca+t.x)/a,360*g-180),(h=(s[1]/ca+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,g}function Uc(s,t){s[0]=Math.min(s[0],t[0]),s[1]=Math.min(s[1],t[1]),s[2]=Math.max(s[2],t[0]),s[3]=Math.max(s[3],t[1])}function Vc(s,t){return!(s[0]<=t[0]||s[2]>=t[2]||s[1]<=t[1]||s[3]>=t[3])}function Lp(s,t,a){const h=s[0]-t[0],g=s[1]-t[1],x=s[0]-a[0],S=s[1]-a[1];return h*S-x*g==0&&h*x<=0&&g*S<=0}function Ku(s,t,a,h){return(g=[h[0]-a[0],h[1]-a[1]])[0]*(x=[t[0]-s[0],t[1]-s[1]])[1]-g[1]*x[0]!=0&&!(!Mf(s,t,a,h)||!Mf(a,h,s,t));var g,x}function Gc(s,t,a){for(const h of a)for(let g=0;g<h.length-1;++g)if(Ku(s,t,h[g],h[g+1]))return!0;return!1}function Ql(s,t,a=!1){let h=!1;for(const A of t)for(let D=0;D<A.length-1;D++){if(Lp(s,A[D],A[D+1]))return a;(x=A[D])[1]>(g=s)[1]!=(S=A[D+1])[1]>g[1]&&g[0]<(S[0]-x[0])*(g[1]-x[1])/(S[1]-x[1])+x[0]&&(h=!h)}var g,x,S;return h}function Op(s,t){for(const a of t)if(Ql(s,a))return!0;return!1}function Af(s,t){for(const a of s)if(!Ql(a,t))return!1;for(let a=0;a<s.length-1;++a)if(Gc(s[a],s[a+1],t))return!1;return!0}function jp(s,t){for(const a of t)if(Af(s,a))return!0;return!1}function Mf(s,t,a,h){const g=h[0]-a[0],x=h[1]-a[1],S=(s[0]-a[0])*x-g*(s[1]-a[1]),A=(t[0]-a[0])*x-g*(t[1]-a[1]);return S>0&&A<0||S<0&&A>0}function Kl(s,t,a){const h=[];for(let g=0;g<s.length;g++){const x=[];for(let S=0;S<s[g].length;S++){const A=kg(s[g][S],a);Uc(t,A),x.push(A)}h.push(x)}return h}function Zc(s,t,a){const h=[];for(let g=0;g<s.length;g++){const x=Kl(s[g],t,a);h.push(x)}return h}function pd(s,t,a,h){if(s[0]<a[0]||s[0]>a[2]){const g=.5*h;let x=s[0]-a[0]>g?-h:a[0]-s[0]>g?h:0;x===0&&(x=s[0]-a[2]>g?-h:a[2]-s[0]>g?h:0),s[0]+=x}Uc(t,s)}function Ju(s,t,a,h){const g=Math.pow(2,h.z)*ca,x=[h.x*ca,h.y*ca],S=[];for(const A of s)for(const D of A){const P=[D.x+x[0],D.y+x[1]];pd(P,t,a,g),S.push(P)}return S}function Cf(s,t,a,h){const g=Math.pow(2,h.z)*ca,x=[h.x*ca,h.y*ca],S=[];for(const D of s){const P=[];for(const L of D){const F=[L.x+x[0],L.y+x[1]];Uc(t,F),P.push(F)}S.push(P)}if(t[2]-t[0]<=g/2){(A=t)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const D of S)for(const P of D)pd(P,t,a,g)}var A;return S}class dl{constructor(t,a){this.type=an,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(uo(t[1])){const h=t[1];if(h.type==="FeatureCollection"){const g=[];for(const x of h.features){const{type:S,coordinates:A}=x.geometry;S==="Polygon"&&g.push(A),S==="MultiPolygon"&&g.push(...A)}if(g.length)return new dl(h,{type:"MultiPolygon",coordinates:g})}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new dl(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new dl(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,h){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(h.type==="Polygon"){const A=Kl(h.coordinates,x,S),D=Ju(a.geometry(),g,x,S);if(!Vc(g,x))return!1;for(const P of D)if(!Ql(P,A))return!1}if(h.type==="MultiPolygon"){const A=Zc(h.coordinates,x,S),D=Ju(a.geometry(),g,x,S);if(!Vc(g,x))return!1;for(const P of D)if(!Op(P,A))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,h){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(h.type==="Polygon"){const A=Kl(h.coordinates,x,S),D=Cf(a.geometry(),g,x,S);if(!Vc(g,x))return!1;for(const P of D)if(!Af(P,A))return!1}if(h.type==="MultiPolygon"){const A=Zc(h.coordinates,x,S),D=Cf(a.geometry(),g,x,S);if(!Vc(g,x))return!1;for(const P of D)if(!jp(P,A))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let eh=class{constructor(s=[],t=(a,h)=>a<h?-1:a>h?1:0){if(this.data=s,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:t,compare:a}=this,h=t[s];for(;s>0;){const g=s-1>>1,x=t[g];if(a(h,x)>=0)break;t[s]=x,s=g}t[s]=h}_down(s){const{data:t,compare:a}=this,h=this.length>>1,g=t[s];for(;s<h;){let x=1+(s<<1);const S=x+1;if(S<this.length&&a(t[S],t[x])<0&&(x=S),a(t[x],g)>=0)break;t[s]=t[x],s=x}t[s]=g}};function th(s,t,a=0,h=s.length-1,g=Bp){for(;h>a;){if(h-a>600){const D=h-a+1,P=t-a+1,L=Math.log(D),F=.5*Math.exp(2*L/3),$=.5*Math.sqrt(L*F*(D-F)/D)*(P-D/2<0?-1:1);th(s,t,Math.max(a,Math.floor(t-P*F/D+$)),Math.min(h,Math.floor(t+(D-P)*F/D+$)),g)}const x=s[t];let S=a,A=h;for($c(s,a,t),g(s[h],x)>0&&$c(s,a,h);S<A;){for($c(s,S,A),S++,A--;g(s[S],x)<0;)S++;for(;g(s[A],x)>0;)A--}g(s[a],x)===0?$c(s,a,A):(A++,$c(s,A,h)),A<=t&&(a=A+1),t<=A&&(h=A-1)}}function $c(s,t,a){const h=s[t];s[t]=s[a],s[a]=h}function Bp(s,t){return s<t?-1:s>t?1:0}function Yc(s,t){if(s.length<=1)return[s];const a=[];let h,g;for(const x of s){const S=Rg(x);S!==0&&(x.area=Math.abs(S),g===void 0&&(g=S<0),g===S<0?(h&&a.push(h),h=[x]):h.push(x))}if(h&&a.push(h),t>1)for(let x=0;x<a.length;x++)a[x].length<=t||(th(a[x],t,1,a[x].length-1,Fp),a[x]=a[x].slice(0,t));return a}function Fp(s,t){return t.area-s.area}function Rg(s){let t=0;for(let a,h,g=0,x=s.length,S=x-1;g<x;S=g++)a=s[g],h=s[S],t+=(h.x-a.x)*(a.y+h.y);return t}const Up=1/298.257223563,Vp=Up*(2-Up),Df=Math.PI/180;class ua{constructor(t){const a=6378.137*Df*1e3,h=Math.cos(t*Df),g=1/(1-Vp*(1-h*h)),x=Math.sqrt(g);this.kx=a*x*h,this.ky=a*x*g*(1-Vp)}distance(t,a){const h=this.wrap(t[0]-a[0])*this.kx,g=(t[1]-a[1])*this.ky;return Math.sqrt(h*h+g*g)}pointOnLine(t,a){let h,g,x,S,A=1/0;for(let D=0;D<t.length-1;D++){let P=t[D][0],L=t[D][1],F=this.wrap(t[D+1][0]-P)*this.kx,$=(t[D+1][1]-L)*this.ky,H=0;F===0&&$===0||(H=(this.wrap(a[0]-P)*this.kx*F+(a[1]-L)*this.ky*$)/(F*F+$*$),H>1?(P=t[D+1][0],L=t[D+1][1]):H>0&&(P+=F/this.kx*H,L+=$/this.ky*H)),F=this.wrap(a[0]-P)*this.kx,$=(a[1]-L)*this.ky;const X=F*F+$*$;X<A&&(A=X,h=P,g=L,x=D,S=H)}return{point:[h,g],index:x,t:Math.max(0,Math.min(1,S))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function qc(s,t){return t[0]-s[0]}function nh(s){return s[1]-s[0]+1}function fo(s,t){return s[1]>=s[0]&&s[1]<t}function zn(s,t){if(s[0]>s[1])return[null,null];const a=nh(s);if(t){if(a===2)return[s,null];const g=Math.floor(a/2);return[[s[0],s[0]+g],[s[0]+g,s[1]]]}if(a===1)return[s,null];const h=Math.floor(a/2)-1;return[[s[0],s[0]+h],[s[0]+h+1,s[1]]]}function md(s,t){if(!fo(t,s.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let h=t[0];h<=t[1];++h)Uc(a,s[h]);return a}function ih(s){const t=[1/0,1/0,-1/0,-1/0];for(const a of s)for(const h of a)Uc(t,h);return t}function Gp(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function fl(s,t,a){if(!Gp(s)||!Gp(t))return NaN;let h=0,g=0;return s[2]<t[0]&&(h=t[0]-s[2]),s[0]>t[2]&&(h=s[0]-t[2]),s[1]>t[3]&&(g=s[1]-t[3]),s[3]<t[1]&&(g=t[1]-s[3]),a.distance([0,0],[h,g])}function Lo(s,t,a){const h=a.pointOnLine(t,s);return a.distance(s,h.point)}function Jl(s,t,a,h,g){const x=Math.min(Lo(s,[a,h],g),Lo(t,[a,h],g)),S=Math.min(Lo(a,[s,t],g),Lo(h,[s,t],g));return Math.min(x,S)}function kf(s,t,a,h,g){if(!fo(t,s.length)||!fo(h,a.length))return 1/0;let x=1/0;for(let S=t[0];S<t[1];++S){const A=s[S],D=s[S+1];for(let P=h[0];P<h[1];++P){const L=a[P],F=a[P+1];if(Ku(A,D,L,F))return 0;x=Math.min(x,Jl(A,D,L,F,g))}}return x}function Zp(s,t,a,h,g){if(!fo(t,s.length)||!fo(h,a.length))return NaN;let x=1/0;for(let S=t[0];S<=t[1];++S)for(let A=h[0];A<=h[1];++A)if(x=Math.min(x,g.distance(s[S],a[A])),x===0)return x;return x}function ec(s,t,a){if(Ql(s,t,!0))return 0;let h=1/0;for(const g of t){const x=g[0],S=g[g.length-1];if(x!==S&&(h=Math.min(h,Lo(s,[S,x],a)),h===0))return h;const A=a.pointOnLine(g,s);if(h=Math.min(h,a.distance(s,A.point)),h===0)return h}return h}function Hc(s,t,a,h){if(!fo(t,s.length))return NaN;for(let x=t[0];x<=t[1];++x)if(Ql(s[x],a,!0))return 0;let g=1/0;for(let x=t[0];x<t[1];++x){const S=s[x],A=s[x+1];for(const D of a)for(let P=0,L=D.length,F=L-1;P<L;F=P++){const $=D[F],H=D[P];if(Ku(S,A,$,H))return 0;g=Math.min(g,Jl(S,A,$,H,h))}}return g}function gd(s,t){for(const a of s)for(const h of a)if(Ql(h,t,!0))return!0;return!1}function $p(s,t,a,h=1/0){const g=ih(s),x=ih(t);if(h!==1/0&&fl(g,x,a)>=h)return h;if(Vc(g,x)){if(gd(s,t))return 0}else if(gd(t,s))return 0;let S=1/0;for(const A of s)for(let D=0,P=A.length,L=P-1;D<P;L=D++){const F=A[L],$=A[D];for(const H of t)for(let X=0,ee=H.length,se=ee-1;X<ee;se=X++){const de=H[se],ke=H[X];if(Ku(F,$,de,ke))return 0;S=Math.min(S,Jl(F,$,de,ke,a))}}return S}function pl(s,t,a,h,g,x){if(!x)return;const S=fl(md(h,x),g,a);S<t&&s.push([S,x,[0,0]])}function rh(s,t,a,h,g,x,S){if(!x||!S)return;const A=fl(md(h,x),md(g,S),a);A<t&&s.push([A,x,S])}function ah(s,t,a,h,g=1/0){let x=Math.min(h.distance(s[0],a[0][0]),g);if(x===0)return x;const S=new eh([[0,[0,s.length-1],[0,0]]],qc),A=ih(a);for(;S.length>0;){const D=S.pop();if(D[0]>=x)continue;const P=D[1],L=t?50:100;if(nh(P)<=L){if(!fo(P,s.length))return NaN;if(t){const F=Hc(s,P,a,h);if(isNaN(F)||F===0)return F;x=Math.min(x,F)}else for(let F=P[0];F<=P[1];++F){const $=ec(s[F],a,h);if(x=Math.min(x,$),x===0)return 0}}else{const F=zn(P,t);pl(S,x,h,s,A,F[0]),pl(S,x,h,s,A,F[1])}}return x}function sh(s,t,a,h,g,x=1/0){let S=Math.min(x,g.distance(s[0],a[0]));if(S===0)return S;const A=new eh([[0,[0,s.length-1],[0,a.length-1]]],qc);for(;A.length>0;){const D=A.pop();if(D[0]>=S)continue;const P=D[1],L=D[2],F=t?50:100,$=h?50:100;if(nh(P)<=F&&nh(L)<=$){if(!fo(P,s.length)&&fo(L,a.length))return NaN;let H;if(t&&h)H=kf(s,P,a,L,g),S=Math.min(S,H);else if(t&&!h){const X=s.slice(P[0],P[1]+1);for(let ee=L[0];ee<=L[1];++ee)if(H=Lo(a[ee],X,g),S=Math.min(S,H),S===0)return S}else if(!t&&h){const X=a.slice(L[0],L[1]+1);for(let ee=P[0];ee<=P[1];++ee)if(H=Lo(s[ee],X,g),S=Math.min(S,H),S===0)return S}else H=Zp(s,P,a,L,g),S=Math.min(S,H)}else{const H=zn(P,t),X=zn(L,h);rh(A,S,g,s,a,H[0],X[0]),rh(A,S,g,s,a,H[0],X[1]),rh(A,S,g,s,a,H[1],X[0]),rh(A,S,g,s,a,H[1],X[1])}}return S}function Rf(s){return s.type==="MultiPolygon"?s.coordinates.map(t=>({type:"Polygon",coordinates:t})):s.type==="MultiLineString"?s.coordinates.map(t=>({type:"LineString",coordinates:t})):s.type==="MultiPoint"?s.coordinates.map(t=>({type:"Point",coordinates:t})):[s]}class tc{constructor(t,a){this.type=St,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(uo(t[1])){const h=t[1];if(h.type==="FeatureCollection")return new tc(h,h.features.map(g=>Rf(g.geometry)).flat());if(h.type==="Feature")return new tc(h,Rf(h.geometry));if("type"in h&&"coordinates"in h)return new tc(h,Rf(h))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,h){const g=a.geometry(),x=g.flat().map(D=>Qu([D.x,D.y],a.canonical));if(g.length===0)return NaN;const S=new ua(x[0][1]);let A=1/0;for(const D of h){switch(D.type){case"Point":A=Math.min(A,sh(x,!1,[D.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,sh(x,!1,D.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,ah(x,!1,D.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,h){const g=a.geometry(),x=g.flat().map(D=>Qu([D.x,D.y],a.canonical));if(g.length===0)return NaN;const S=new ua(x[0][1]);let A=1/0;for(const D of h){switch(D.type){case"Point":A=Math.min(A,sh(x,!0,[D.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,sh(x,!0,D.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,ah(x,!0,D.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,h){const g=a.geometry();if(g.length===0||g[0].length===0)return NaN;const x=Yc(g,0).map(D=>D.map(P=>P.map(L=>Qu([L.x,L.y],a.canonical)))),S=new ua(x[0][0][0][1]);let A=1/0;for(const D of h)for(const P of x){switch(D.type){case"Point":A=Math.min(A,ah([D.coordinates],!1,P,S,A));break;case"LineString":A=Math.min(A,ah(D.coordinates,!0,P,S,A));break;case"Polygon":A=Math.min(A,$p(P,D.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class oh{constructor(t){this.type=dn,this.key=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=t[1];return h==null?a.error("Global state property must be defined."):typeof h!="string"?a.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new oh(h)}evaluate(t){var a;const h=(a=t.globals)===null||a===void 0?void 0:a.globalState;return h&&Object.keys(h).length!==0?Gl(h,this.key):null}eachChild(){}outputDefined(){return!1}}const nc={"==":wf,"!=":dd,">":Tf,"<":Mg,">=":Dg,"<=":Cg,array:gi,at:Yl,boolean:gi,case:jc,coalesce:Xl,collator:fd,format:Wl,image:Ef,in:Yu,"index-of":As,interpolate:zr,"interpolate-hcl":zr,"interpolate-lab":zr,length:Fc,let:$l,literal:ts,match:Tr,number:gi,"number-format":Sf,object:gi,slice:ql,step:Zi,string:gi,"to-boolean":Ia,"to-color":Ia,"to-number":Ia,"to-string":Ia,var:hl,within:dl,distance:tc,"global-state":oh};class Pa{constructor(t,a,h,g){this.name=t,this.type=a,this._evaluate=h,this.args=g}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const h=t[0],g=Pa.definitions[h];if(!g)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,S=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,A=S.filter(([P])=>!Array.isArray(P)||P.length===t.length-1);let D=null;for(const[P,L]of A){D=new ul(a.registry,ha,a.path,null,a.scope);const F=[];let $=!1;for(let H=1;H<t.length;H++){const X=t[H],ee=Array.isArray(P)?P[H-1]:P.type,se=D.parse(X,1+F.length,ee);if(!se){$=!0;break}F.push(se)}if(!$)if(Array.isArray(P)&&P.length!==F.length)D.error(`Expected ${P.length} arguments, but found ${F.length} instead.`);else{for(let H=0;H<F.length;H++){const X=Array.isArray(P)?P[H]:P.type,ee=F[H];D.concat(H+1).checkSubtype(X,ee.type)}if(D.errors.length===0)return new Pa(h,x,L,F)}}if(A.length===1)a.errors.push(...D.errors);else{const P=(A.length?A:S).map(([F])=>{return $=F,Array.isArray($)?`(${$.map(qn).join(", ")})`:`(${qn($.type)}...)`;var $}).join(" | "),L=[];for(let F=1;F<t.length;F++){const $=a.parse(t[F],1+L.length);if(!$)return null;L.push(qn($.type))}a.error(`Expected arguments of type ${P}, but found (${L.join(", ")}) instead.`)}return null}static register(t,a){Pa.definitions=a;for(const h in a)t[h]=Pa}}function yd(s,[t,a,h,g]){t=t.evaluate(s),a=a.evaluate(s),h=h.evaluate(s);const x=g?g.evaluate(s):1,S=si(t,a,h,x);if(S)throw new Vn(S);return new gn(t/255,a/255,h/255,x,!1)}function ns(s,t){return s in t}function _d(s,t){const a=t[s];return a===void 0?null:a}function Sr(s){return{type:s}}function ha(s){if(s instanceof hl)return ha(s.boundExpression);if(s instanceof Pa&&s.name==="error"||s instanceof fd||s instanceof dl||s instanceof tc||s instanceof oh)return!1;const t=s instanceof Ia||s instanceof gi;let a=!0;return s.eachChild(h=>{a=t?a&&ha(h):a&&h instanceof ts}),!!a&&Oo(s)&&rc(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Oo(s){if(s instanceof Pa&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof dl||s instanceof tc)return!1;let t=!0;return s.eachChild(a=>{t&&!Oo(a)&&(t=!1)}),t}function ic(s){if(s instanceof Pa&&s.name==="feature-state")return!1;let t=!0;return s.eachChild(a=>{t&&!ic(a)&&(t=!1)}),t}function rc(s,t){if(s instanceof Pa&&t.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(h=>{a&&!rc(h,t)&&(a=!1)}),a}function lh(s){return{result:"success",value:s}}function ml(s){return{result:"error",value:s}}function Na(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function If(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Xc(s){return!!s.expression&&s.expression.interpolated}function pn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function ch(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&qt(s)===Si}function za(s){return s}function vd(s,t){const a=s.stops&&typeof s.stops[0][0]=="object",h=a||!(a||s.property!==void 0),g=s.type||(Xc(t)?"exponential":"interval"),x=function(L){switch(L.type){case"color":return gn.parse;case"padding":return fr.parse;case"numberArray":return Ir.parse;case"colorArray":return Wi.parse;default:return null}}(t);if(x&&((s=Vr({},s)).stops&&(s.stops=s.stops.map(L=>[L[0],x(L[1])])),s.default=x(s.default?s.default:t.default)),s.colorSpace&&(S=s.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var S;const A=function(L){switch(L){case"exponential":return gl;case"interval":return bd;case"categorical":return Pf;case"identity":return Nf;default:throw new Error(`Unknown function type "${L}"`)}}(g);let D,P;if(g==="categorical"){D=Object.create(null);for(const L of s.stops)D[L[0]]=L[1];P=typeof s.stops[0][0]}if(a){const L={},F=[];for(let X=0;X<s.stops.length;X++){const ee=s.stops[X],se=ee[0].zoom;L[se]===void 0&&(L[se]={zoom:se,type:s.type,property:s.property,default:s.default,stops:[]},F.push(se)),L[se].stops.push([ee[0].value,ee[1]])}const $=[];for(const X of F)$.push([L[X].zoom,vd(L[X],t)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:zr.interpolationFactor.bind(void 0,H),zoomStops:$.map(X=>X[0]),evaluate:({zoom:X},ee)=>gl({stops:$,base:s.base},t,X).evaluate(X,ee)}}if(h){const L=g==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:zr.interpolationFactor.bind(void 0,L),zoomStops:s.stops.map(F=>F[0]),evaluate:({zoom:F})=>A(s,t,F,D,P)}}return{kind:"source",evaluate(L,F){const $=F&&F.properties?F.properties[s.property]:void 0;return $===void 0?$r(s.default,t.default):A(s,t,$,D,P)}}}function $r(s,t,a){return s!==void 0?s:t!==void 0?t:a!==void 0?a:void 0}function Pf(s,t,a,h,g){return $r(typeof a===g?h[a]:void 0,s.default,t.default)}function bd(s,t,a){if(pn(a)!=="number")return $r(s.default,t.default);const h=s.stops.length;if(h===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[h-1][0])return s.stops[h-1][1];const g=Hl(s.stops.map(x=>x[0]),a);return s.stops[g][1]}function gl(s,t,a){const h=s.base!==void 0?s.base:1;if(pn(a)!=="number")return $r(s.default,t.default);const g=s.stops.length;if(g===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[g-1][0])return s.stops[g-1][1];const x=Hl(s.stops.map(L=>L[0]),a),S=function(L,F,$,H){const X=H-$,ee=L-$;return X===0?0:F===1?ee/X:(Math.pow(F,ee)-1)/(Math.pow(F,X)-1)}(a,h,s.stops[x][0],s.stops[x+1][0]),A=s.stops[x][1],D=s.stops[x+1][1],P=ho[t.type]||za;return typeof A.evaluate=="function"?{evaluate(...L){const F=A.evaluate.apply(void 0,L),$=D.evaluate.apply(void 0,L);if(F!==void 0&&$!==void 0)return P(F,$,S,s.colorSpace)}}:P(A,D,S,s.colorSpace)}function Nf(s,t,a){switch(t.type){case"color":a=gn.parse(a);break;case"formatted":a=sr.fromString(a.toString());break;case"resolvedImage":a=Nr.fromString(a.toString());break;case"padding":a=fr.parse(a);break;case"colorArray":a=Wi.parse(a);break;case"numberArray":a=Ir.parse(a);break;default:pn(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return $r(a,s.default,t.default)}Pa.register(nc,{error:[{kind:"error"},[hn],(s,[t])=>{throw new Vn(t.evaluate(s))}],typeof:[hn,[dn],(s,[t])=>qn(qt(t.evaluate(s)))],"to-rgba":[kr(St,4),[Xi],(s,[t])=>{const[a,h,g,x]=t.evaluate(s).rgb;return[255*a,255*h,255*g,x]}],rgb:[Xi,[St,St,St],yd],rgba:[Xi,[St,St,St,St],yd],has:{type:an,overloads:[[[hn],(s,[t])=>ns(t.evaluate(s),s.properties())],[[hn,Si],(s,[t,a])=>ns(t.evaluate(s),a.evaluate(s))]]},get:{type:dn,overloads:[[[hn],(s,[t])=>_d(t.evaluate(s),s.properties())],[[hn,Si],(s,[t,a])=>_d(t.evaluate(s),a.evaluate(s))]]},"feature-state":[dn,[hn],(s,[t])=>_d(t.evaluate(s),s.featureState||{})],properties:[Si,[],s=>s.properties()],"geometry-type":[hn,[],s=>s.geometryType()],id:[dn,[],s=>s.id()],zoom:[St,[],s=>s.globals.zoom],"heatmap-density":[St,[],s=>s.globals.heatmapDensity||0],elevation:[St,[],s=>s.globals.elevation||0],"line-progress":[St,[],s=>s.globals.lineProgress||0],accumulated:[dn,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[St,Sr(St),(s,t)=>{let a=0;for(const h of t)a+=h.evaluate(s);return a}],"*":[St,Sr(St),(s,t)=>{let a=1;for(const h of t)a*=h.evaluate(s);return a}],"-":{type:St,overloads:[[[St,St],(s,[t,a])=>t.evaluate(s)-a.evaluate(s)],[[St],(s,[t])=>-t.evaluate(s)]]},"/":[St,[St,St],(s,[t,a])=>t.evaluate(s)/a.evaluate(s)],"%":[St,[St,St],(s,[t,a])=>t.evaluate(s)%a.evaluate(s)],ln2:[St,[],()=>Math.LN2],pi:[St,[],()=>Math.PI],e:[St,[],()=>Math.E],"^":[St,[St,St],(s,[t,a])=>Math.pow(t.evaluate(s),a.evaluate(s))],sqrt:[St,[St],(s,[t])=>Math.sqrt(t.evaluate(s))],log10:[St,[St],(s,[t])=>Math.log(t.evaluate(s))/Math.LN10],ln:[St,[St],(s,[t])=>Math.log(t.evaluate(s))],log2:[St,[St],(s,[t])=>Math.log(t.evaluate(s))/Math.LN2],sin:[St,[St],(s,[t])=>Math.sin(t.evaluate(s))],cos:[St,[St],(s,[t])=>Math.cos(t.evaluate(s))],tan:[St,[St],(s,[t])=>Math.tan(t.evaluate(s))],asin:[St,[St],(s,[t])=>Math.asin(t.evaluate(s))],acos:[St,[St],(s,[t])=>Math.acos(t.evaluate(s))],atan:[St,[St],(s,[t])=>Math.atan(t.evaluate(s))],min:[St,Sr(St),(s,t)=>Math.min(...t.map(a=>a.evaluate(s)))],max:[St,Sr(St),(s,t)=>Math.max(...t.map(a=>a.evaluate(s)))],abs:[St,[St],(s,[t])=>Math.abs(t.evaluate(s))],round:[St,[St],(s,[t])=>{const a=t.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[St,[St],(s,[t])=>Math.floor(t.evaluate(s))],ceil:[St,[St],(s,[t])=>Math.ceil(t.evaluate(s))],"filter-==":[an,[hn,dn],(s,[t,a])=>s.properties()[t.value]===a.value],"filter-id-==":[an,[dn],(s,[t])=>s.id()===t.value],"filter-type-==":[an,[hn],(s,[t])=>s.geometryType()===t.value],"filter-<":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h<g}],"filter-id-<":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a<h}],"filter->":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h>g}],"filter-id->":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a>h}],"filter-<=":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a<=h}],"filter->=":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a>=h}],"filter-has":[an,[dn],(s,[t])=>t.value in s.properties()],"filter-has-id":[an,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[an,[kr(hn)],(s,[t])=>t.value.indexOf(s.geometryType())>=0],"filter-id-in":[an,[kr(dn)],(s,[t])=>t.value.indexOf(s.id())>=0],"filter-in-small":[an,[hn,kr(dn)],(s,[t,a])=>a.value.indexOf(s.properties()[t.value])>=0],"filter-in-large":[an,[hn,kr(dn)],(s,[t,a])=>function(h,g,x,S){for(;x<=S;){const A=x+S>>1;if(g[A]===h)return!0;g[A]>h?S=A-1:x=A+1}return!1}(s.properties()[t.value],a.value,0,a.value.length-1)],all:{type:an,overloads:[[[an,an],(s,[t,a])=>t.evaluate(s)&&a.evaluate(s)],[Sr(an),(s,t)=>{for(const a of t)if(!a.evaluate(s))return!1;return!0}]]},any:{type:an,overloads:[[[an,an],(s,[t,a])=>t.evaluate(s)||a.evaluate(s)],[Sr(an),(s,t)=>{for(const a of t)if(a.evaluate(s))return!0;return!1}]]},"!":[an,[an],(s,[t])=>!t.evaluate(s)],"is-supported-script":[an,[hn],(s,[t])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(t.evaluate(s))}],upcase:[hn,[hn],(s,[t])=>t.evaluate(s).toUpperCase()],downcase:[hn,[hn],(s,[t])=>t.evaluate(s).toLowerCase()],concat:[hn,Sr(dn),(s,t)=>t.map(a=>nn(a.evaluate(s))).join("")],"resolved-locale":[hn,[Vu],(s,[t])=>t.evaluate(s).resolvedLocale()]});class uh{constructor(t,a,h){this.expression=t,this._warningHistory={},this._evaluator=new bf,this._defaultValue=a?function(g){if(g.type==="color"&&ch(g.default))return new gn(0,0,0,0);switch(g.type){case"color":return gn.parse(g.default)||null;case"padding":return fr.parse(g.default)||null;case"numberArray":return Ir.parse(g.default)||null;case"colorArray":return Wi.parse(g.default)||null;case"variableAnchorOffsetCollection":return Pr.parse(g.default)||null;case"projectionDefinition":return Fi.parse(g.default)||null;default:return g.default===void 0?null:g.default}}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this._globalState=h}evaluateWithoutErrorHandling(t,a,h,g,x,S){return this._globalState&&(t={...t,globalState:this._globalState}),this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(t,a,h,g,x,S){this._globalState&&(t={...t,globalState:this._globalState}),this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=S||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Vn(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function jo(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in nc}function po(s,t,a){const h=new ul(nc,ha,[],t?function(x){const S={color:Xi,string:hn,number:St,enum:hn,boolean:an,formatted:_a,padding:Io,numberArray:Fl,colorArray:ro,projectionDefinition:es,resolvedImage:Bi,variableAnchorOffsetCollection:cd};return x.type==="array"?kr(S[x.value]||dn,x.length):S[x.type]}(t):void 0),g=h.parse(s,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?lh(new uh(g,t,a)):ml(h.errors)}class yl{constructor(t,a,h){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!ic(a.expression),this.globalStateRefs=Oa(a.expression),this._globalState=h}evaluateWithoutErrorHandling(t,a,h,g,x,S){return this._globalState&&(t={...t,globalState:this._globalState}),this._styleExpression.evaluateWithoutErrorHandling(t,a,h,g,x,S)}evaluate(t,a,h,g,x,S){return this._globalState&&(t={...t,globalState:this._globalState}),this._styleExpression.evaluate(t,a,h,g,x,S)}}class Wc{constructor(t,a,h,g,x){this.kind=t,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!ic(a.expression),this.globalStateRefs=Oa(a.expression),this.interpolationType=g,this._globalState=x}evaluateWithoutErrorHandling(t,a,h,g,x,S){return this._globalState&&(t={...t,globalState:this._globalState}),this._styleExpression.evaluateWithoutErrorHandling(t,a,h,g,x,S)}evaluate(t,a,h,g,x,S){return this._globalState&&(t={...t,globalState:this._globalState}),this._styleExpression.evaluate(t,a,h,g,x,S)}interpolationFactor(t,a,h){return this.interpolationType?zr.interpolationFactor(this.interpolationType,t,a,h):0}}function La(s,t,a){const h=po(s,t,a);if(h.result==="error")return h;const g=h.value.expression,x=Oo(g);if(!x&&!Na(t))return ml([new ji("","data expressions not supported")]);const S=rc(g,["zoom"]);if(!S&&!If(t))return ml([new ji("","zoom expressions not supported")]);const A=Ms(g);return A||S?A instanceof ji?ml([A]):A instanceof zr&&!Xc(t)?ml([new ji("",'"interpolate" expressions cannot be used with this property')]):lh(A?new Wc(x?"camera":"composite",h.value,A.labels,A instanceof zr?A.interpolation:void 0,a):new yl(x?"constant":"source",h.value,a)):ml([new ji("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yr{constructor(t,a){this._parameters=t,this._specification=a,Vr(this,vd(this._parameters,this._specification))}static deserialize(t){return new Yr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ms(s){let t=null;if(s instanceof $l)t=Ms(s.result);else if(s instanceof Xl){for(const a of s.args)if(t=Ms(a),t)break}else(s instanceof Zi||s instanceof zr)&&s.input instanceof Pa&&s.input.name==="zoom"&&(t=s);return t instanceof ji||s.eachChild(a=>{const h=Ms(a);h instanceof ji?t=h:!t&&h?t=new ji("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&h&&t!==h&&(t=new ji("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Oa(s,t=new Set){return s instanceof oh&&t.add(s.key),s.eachChild(a=>{Oa(a,t)}),t}function is(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const t of s.slice(1))if(!is(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Bo={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function _l(s,t){if(s==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};is(s)||(s=Qi(s));const a=po(s,Bo,t);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,g,x)=>a.value.evaluate(h,g,{},x),needGeometry:Qc(s),getGlobalStateRefs:()=>Oa(a.value.expression)}}function hh(s,t){return s<t?-1:s>t?1:0}function Qc(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let t=1;t<s.length;t++)if(Qc(s[t]))return!0;return!1}function Qi(s){if(!s)return!0;const t=s[0];return s.length<=1?t!=="any":t==="=="?Ri(s[1],s[2],"=="):t==="!="?ja(Ri(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ri(s[1],s[2],t):t==="any"?(a=s.slice(1),["any"].concat(a.map(Qi))):t==="all"?["all"].concat(s.slice(1).map(Qi)):t==="none"?["all"].concat(s.slice(1).map(Qi).map(ja)):t==="in"?Gn(s[1],s.slice(2)):t==="!in"?ja(Gn(s[1],s.slice(2))):t==="has"?vl(s[1]):t!=="!has"||ja(vl(s[1]));var a}function Ri(s,t,a){switch(s){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,s,t]}}function Gn(s,t){if(t.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",s,["literal",t.sort(hh)]]:["filter-in-small",s,["literal",t]]}}function vl(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function ja(s){return["!",s]}function dh(s){const t=typeof s;if(t==="number"||t==="boolean"||t==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let g="[";for(const x of s)g+=`${dh(x)},`;return`${g}]`}const a=Object.keys(s).sort();let h="{";for(let g=0;g<a.length;g++)h+=`${JSON.stringify(a[g])}:${dh(s[a[g]])},`;return`${h}}`}function ac(s){let t="";for(const a of en)t+=`/${dh(s[a])}`;return t}function xd(s){const t=s.value;return t?[new gt(s.key,t,"constants have been deprecated as of v8")]:[]}function Ii(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ba(s){if(Array.isArray(s))return s.map(ba);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const t={};for(const a in s)t[a]=ba(s[a]);return t}return Ii(s)}function qr(s){const t=s.key,a=s.value,h=s.valueSpec||{},g=s.objectElementValidators||{},x=s.style,S=s.styleSpec,A=s.validateSpec;let D=[];const P=pn(a);if(P!=="object")return[new gt(t,a,`object expected, ${P} found`)];for(const L in a){const F=L.split(".")[0],$=Gl(h,F)||h["*"];let H;if(Gl(g,F))H=g[F];else if(Gl(h,F))H=A;else if(g["*"])H=g["*"];else{if(!h["*"]){D.push(new gt(t,a[L],`unknown property "${L}"`));continue}H=A}D=D.concat(H({key:(t&&`${t}.`)+L,value:a[L],valueSpec:$,style:x,styleSpec:S,object:a,objectKey:L,validateSpec:A},a))}for(const L in h)g[L]||h[L].required&&h[L].default===void 0&&a[L]===void 0&&D.push(new gt(t,a,`missing required property "${L}"`));return D}function fh(s){const t=s.value,a=s.valueSpec,h=s.style,g=s.styleSpec,x=s.key,S=s.arrayElementValidator||s.validateSpec;if(pn(t)!=="array")return[new gt(x,t,`array expected, ${pn(t)} found`)];if(a.length&&t.length!==a.length)return[new gt(x,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new gt(x,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let A={type:a.value,values:a.values};g.$version<7&&(A.function=a.function),pn(a.value)==="object"&&(A=a.value);let D=[];for(let P=0;P<t.length;P++)D=D.concat(S({array:t,arrayIndex:P,value:t[P],valueSpec:A,validateSpec:s.validateSpec,style:h,styleSpec:g,key:`${x}[${P}]`}));return D}function Fo(s){const t=s.key,a=s.value,h=s.valueSpec;let g=pn(a);return g==="number"&&a!=a&&(g="NaN"),g!=="number"?[new gt(t,a,`number expected, ${g} found`)]:"minimum"in h&&a<h.minimum?[new gt(t,a,`${a} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&a>h.maximum?[new gt(t,a,`${a} is greater than the maximum value ${h.maximum}`)]:[]}function wd(s){const t=s.valueSpec,a=Ii(s.value.type);let h,g,x,S={};const A=a!=="categorical"&&s.value.property===void 0,D=!A,P=pn(s.value.stops)==="array"&&pn(s.value.stops[0])==="array"&&pn(s.value.stops[0][0])==="object",L=qr({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(H){if(a==="identity")return[new gt(H.key,H.value,'identity function may not have a "stops" property')];let X=[];const ee=H.value;return X=X.concat(fh({key:H.key,value:ee,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:F})),pn(ee)==="array"&&ee.length===0&&X.push(new gt(H.key,ee,"array must have at least one stop")),X},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:t,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return a==="identity"&&A&&L.push(new gt(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||L.push(new gt(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!Xc(s.valueSpec)&&L.push(new gt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(D&&!Na(s.valueSpec)?L.push(new gt(s.key,s.value,"property functions not supported")):A&&!If(s.valueSpec)&&L.push(new gt(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!P||s.value.property!==void 0||L.push(new gt(s.key,s.value,'"property" property is required')),L;function F(H){let X=[];const ee=H.value,se=H.key;if(pn(ee)!=="array")return[new gt(se,ee,`array expected, ${pn(ee)} found`)];if(ee.length!==2)return[new gt(se,ee,`array length 2 expected, length ${ee.length} found`)];if(P){if(pn(ee[0])!=="object")return[new gt(se,ee,`object expected, ${pn(ee[0])} found`)];if(ee[0].zoom===void 0)return[new gt(se,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new gt(se,ee,"object stop key must have value")];if(x&&x>Ii(ee[0].zoom))return[new gt(se,ee[0].zoom,"stop zoom values must appear in ascending order")];Ii(ee[0].zoom)!==x&&(x=Ii(ee[0].zoom),g=void 0,S={}),X=X.concat(qr({key:`${se}[0]`,value:ee[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Fo,value:$}}))}else X=X.concat($({key:`${se}[0]`,value:ee[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},ee));return jo(ba(ee[1]))?X.concat([new gt(`${se}[1]`,ee[1],"expressions are not allowed in function stops.")]):X.concat(H.validateSpec({key:`${se}[1]`,value:ee[1],valueSpec:t,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function $(H,X){const ee=pn(H.value),se=Ii(H.value),de=H.value!==null?H.value:X;if(h){if(ee!==h)return[new gt(H.key,de,`${ee} stop domain type must match previous stop domain type ${h}`)]}else h=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new gt(H.key,de,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&a!=="categorical"){let ke=`number expected, ${ee} found`;return Na(t)&&a===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(H.key,de,ke)]}return a!=="categorical"||ee!=="number"||isFinite(se)&&Math.floor(se)===se?a!=="categorical"&&ee==="number"&&g!==void 0&&se<g?[new gt(H.key,de,"stop domain values must appear in ascending order")]:(g=se,a==="categorical"&&se in S?[new gt(H.key,de,"stop domain values must be unique")]:(S[se]=!0,[])):[new gt(H.key,de,`integer expected, found ${se}`)]}}function Ba(s){const t=(s.expressionContext==="property"?La:po)(ba(s.value),s.valueSpec);if(t.result==="error")return t.value.map(h=>new gt(`${s.key}${h.key}`,s.value,h.message));const a=t.value.expression||t.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new gt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!ic(a))return[new gt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!ic(a))return[new gt(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!rc(a,["zoom","feature-state"]))return[new gt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Oo(a))return[new gt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rs(s){const t=s.key,a=s.value,h=pn(a);return h!=="string"?[new gt(t,a,`color expected, ${h} found`)]:gn.parse(String(a))?[]:[new gt(t,a,`color expected, "${a}" found`)]}function Hr(s){const t=s.key,a=s.value,h=s.valueSpec,g=[];return Array.isArray(h.values)?h.values.indexOf(Ii(a))===-1&&g.push(new gt(t,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(h.values).indexOf(Ii(a))===-1&&g.push(new gt(t,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),g}function Cs(s){return is(ba(s.value))?Ba(Vr({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Td(s)}function Td(s){const t=s.value,a=s.key;if(pn(t)!=="array")return[new gt(a,t,`array expected, ${pn(t)} found`)];const h=s.styleSpec;let g,x=[];if(t.length<1)return[new gt(a,t,"filter array must have at least 1 element")];switch(x=x.concat(Hr({key:`${a}[0]`,value:t[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),Ii(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Ii(t[1])==="$type"&&x.push(new gt(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&x.push(new gt(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(g=pn(t[1]),g!=="string"&&x.push(new gt(`${a}[1]`,t[1],`string expected, ${g} found`)));for(let S=2;S<t.length;S++)g=pn(t[S]),Ii(t[1])==="$type"?x=x.concat(Hr({key:`${a}[${S}]`,value:t[S],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new gt(`${a}[${S}]`,t[S],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let S=1;S<t.length;S++)x=x.concat(Td({key:`${a}[${S}]`,value:t[S],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":g=pn(t[1]),t.length!==2?x.push(new gt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new gt(`${a}[1]`,t[1],`string expected, ${g} found`))}return x}function Sd(s,t){const a=s.key,h=s.validateSpec,g=s.style,x=s.styleSpec,S=s.value,A=s.objectKey,D=x[`${t}_${s.layerType}`];if(!D)return[];const P=A.match(/^(.*)-transition$/);if(t==="paint"&&P&&D[P[1]]&&D[P[1]].transition)return h({key:a,value:S,valueSpec:x.transition,style:g,styleSpec:x});const L=s.valueSpec||D[A];if(!L)return[new gt(a,S,`unknown property "${A}"`)];let F;if(pn(S)==="string"&&Na(L)&&!L.tokens&&(F=/^{([^}]+)}$/.exec(S)))return[new gt(a,S,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const $=[];return s.layerType==="symbol"&&(A==="text-field"&&g&&!g.glyphs&&$.push(new gt(a,S,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&ch(ba(S))&&Ii(S.type)==="identity"&&$.push(new gt(a,S,'"text-font" does not support identity functions'))),$.concat(h({key:s.key,value:S,valueSpec:L,style:g,styleSpec:x,expressionContext:"property",propertyType:t,propertyKey:A}))}function Kc(s){return Sd(s,"paint")}function ph(s){return Sd(s,"layout")}function bl(s){let t=[];const a=s.value,h=s.key,g=s.style,x=s.styleSpec;if(pn(a)!=="object")return[new gt(h,a,`object expected, ${pn(a)} found`)];a.type||a.ref||t.push(new gt(h,a,'either "type" or "ref" is required'));let S=Ii(a.type);const A=Ii(a.ref);if(a.id){const D=Ii(a.id);for(let P=0;P<s.arrayIndex;P++){const L=g.layers[P];Ii(L.id)===D&&t.push(new gt(h,a.id,`duplicate layer id "${a.id}", previously used at line ${L.id.__line__}`))}}if("ref"in a){let D;["type","source","source-layer","filter","layout"].forEach(P=>{P in a&&t.push(new gt(h,a[P],`"${P}" is prohibited for ref layers`))}),g.layers.forEach(P=>{Ii(P.id)===A&&(D=P)}),D?D.ref?t.push(new gt(h,a.ref,"ref cannot reference another ref layer")):S=Ii(D.type):t.push(new gt(h,a.ref,`ref layer "${A}" not found`))}else if(S!=="background")if(a.source){const D=g.sources&&g.sources[a.source],P=D&&Ii(D.type);D?P==="vector"&&S==="raster"?t.push(new gt(h,a.source,`layer "${a.id}" requires a raster source`)):P!=="raster-dem"&&S==="hillshade"||P!=="raster-dem"&&S==="color-relief"?t.push(new gt(h,a.source,`layer "${a.id}" requires a raster-dem source`)):P==="raster"&&S!=="raster"?t.push(new gt(h,a.source,`layer "${a.id}" requires a vector source`)):P!=="vector"||a["source-layer"]?P==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?t.push(new gt(h,a.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!a.paint||!a.paint["line-gradient"]||P==="geojson"&&D.lineMetrics||t.push(new gt(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new gt(h,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new gt(h,a.source,`source "${a.source}" not found`))}else t.push(new gt(h,a,'missing required property "source"'));return t=t.concat(qr({key:h,value:a,valueSpec:x.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${h}.type`,value:a.type,valueSpec:x.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:a,objectKey:"type"}),filter:Cs,layout:D=>qr({layer:a,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":P=>ph(Vr({layerType:S},P))}}),paint:D=>qr({layer:a,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":P=>Kc(Vr({layerType:S},P))}})}})),t}function yi(s){const t=s.value,a=s.key,h=pn(t);return h!=="string"?[new gt(a,t,`string expected, ${h} found`)]:[]}const Uo={promoteId:function({key:s,value:t}){if(pn(t)==="string")return yi({key:s,value:t});{const a=[];for(const h in t)a.push(...yi({key:`${s}.${h}`,value:t[h]}));return a}}};function da(s){const t=s.value,a=s.key,h=s.styleSpec,g=s.style,x=s.validateSpec;if(!t.type)return[new gt(a,t,'"type" is required')];const S=Ii(t.type);let A;switch(S){case"vector":case"raster":return A=qr({key:a,value:t,valueSpec:h[`source_${S.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:Uo,validateSpec:x}),A;case"raster-dem":return A=function(D){var P;const L=(P=D.sourceName)!==null&&P!==void 0?P:"",F=D.value,$=D.styleSpec,H=$.source_raster_dem,X=D.style;let ee=[];const se=pn(F);if(F===void 0)return ee;if(se!=="object")return ee.push(new gt("source_raster_dem",F,`object expected, ${se} found`)),ee;const de=Ii(F.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],ve=D.value.encoding?`"${D.value.encoding}"`:"Default";for(const Se in F)!de&&ke.includes(Se)?ee.push(new gt(Se,F[Se],`In "${L}": "${Se}" is only valid when "encoding" is set to "custom". ${ve} encoding found`)):H[Se]?ee=ee.concat(D.validateSpec({key:Se,value:F[Se],valueSpec:H[Se],validateSpec:D.validateSpec,style:X,styleSpec:$})):ee.push(new gt(Se,F[Se],`unknown property "${Se}"`));return ee}({sourceName:a,value:t,style:s.style,styleSpec:h,validateSpec:x}),A;case"geojson":if(A=qr({key:a,value:t,valueSpec:h.source_geojson,style:g,styleSpec:h,validateSpec:x,objectElementValidators:Uo}),t.cluster)for(const D in t.clusterProperties){const[P,L]=t.clusterProperties[D],F=typeof P=="string"?[P,["accumulated"],["get",D]]:P;A.push(...Ba({key:`${a}.${D}.map`,value:L,expressionContext:"cluster-map"})),A.push(...Ba({key:`${a}.${D}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return A;case"video":return qr({key:a,value:t,valueSpec:h.source_video,style:g,validateSpec:x,styleSpec:h});case"image":return qr({key:a,value:t,valueSpec:h.source_image,style:g,validateSpec:x,styleSpec:h});case"canvas":return[new gt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hr({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Jc(s){const t=s.value,a=s.styleSpec,h=a.light,g=s.style;let x=[];const S=pn(t);if(t===void 0)return x;if(S!=="object")return x=x.concat([new gt("light",t,`object expected, ${S} found`)]),x;for(const A in t){const D=A.match(/^(.*)-transition$/);x=x.concat(D&&h[D[1]]&&h[D[1]].transition?s.validateSpec({key:A,value:t[A],valueSpec:a.transition,validateSpec:s.validateSpec,style:g,styleSpec:a}):h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],validateSpec:s.validateSpec,style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)])}return x}function zf(s){const t=s.value,a=s.styleSpec,h=a.sky,g=s.style,x=pn(t);if(t===void 0)return[];if(x!=="object")return[new gt("sky",t,`object expected, ${x} found`)];let S=[];for(const A in t)S=S.concat(h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)]);return S}function Yp(s){const t=s.value,a=s.styleSpec,h=a.terrain,g=s.style;let x=[];const S=pn(t);if(t===void 0)return x;if(S!=="object")return x=x.concat([new gt("terrain",t,`object expected, ${S} found`)]),x;for(const A in t)x=x.concat(h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],validateSpec:s.validateSpec,style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)]);return x}function or(s){let t=[];const a=s.value,h=s.key;if(Array.isArray(a)){const g=[],x=[];for(const S in a)a[S].id&&g.includes(a[S].id)&&t.push(new gt(h,a,`all the sprites' ids must be unique, but ${a[S].id} is duplicated`)),g.push(a[S].id),a[S].url&&x.includes(a[S].url)&&t.push(new gt(h,a,`all the sprites' URLs must be unique, but ${a[S].url} is duplicated`)),x.push(a[S].url),t=t.concat(qr({key:`${h}[${S}]`,value:a[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return t}return yi({key:h,value:a})}function xl(s){return t=s.value,t&&t.constructor===Object?[]:[new gt(s.key,s.value,`object expected, ${pn(s.value)} found`)];var t}const sc={"*":()=>[],array:fh,boolean:function(s){const t=s.value,a=s.key,h=pn(t);return h!=="boolean"?[new gt(a,t,`boolean expected, ${h} found`)]:[]},number:Fo,color:rs,constants:xd,enum:Hr,filter:Cs,function:wd,layer:bl,object:qr,source:da,light:Jc,sky:zf,terrain:Yp,projection:function(s){const t=s.value,a=s.styleSpec,h=a.projection,g=s.style,x=pn(t);if(t===void 0)return[];if(x!=="object")return[new gt("projection",t,`object expected, ${x} found`)];let S=[];for(const A in t)S=S.concat(h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)]);return S},projectionDefinition:function(s){const t=s.key;let a=s.value;a=a instanceof String?a.valueOf():a;const h=pn(a);return h!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(a)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(a)?["array","string"].includes(h)?[]:[new gt(t,a,`projection expected, invalid type "${h}" found`)]:[new gt(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:yi,formatted:function(s){return yi(s).length===0?[]:Ba(s)},resolvedImage:function(s){return yi(s).length===0?[]:Ba(s)},padding:function(s){const t=s.key,a=s.value;if(pn(a)==="array"){if(a.length<1||a.length>4)return[new gt(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const h={type:"number"};let g=[];for(let x=0;x<a.length;x++)g=g.concat(s.validateSpec({key:`${t}[${x}]`,value:a[x],validateSpec:s.validateSpec,valueSpec:h}));return g}return Fo({key:t,value:a,valueSpec:{}})},numberArray:function(s){const t=s.key,a=s.value;if(pn(a)==="array"){const h={type:"number"};if(a.length<1)return[new gt(t,a,"array length at least 1 expected, length 0 found")];let g=[];for(let x=0;x<a.length;x++)g=g.concat(s.validateSpec({key:`${t}[${x}]`,value:a[x],validateSpec:s.validateSpec,valueSpec:h}));return g}return Fo({key:t,value:a,valueSpec:{}})},colorArray:function(s){const t=s.key,a=s.value;if(pn(a)==="array"){if(a.length<1)return[new gt(t,a,"array length at least 1 expected, length 0 found")];let h=[];for(let g=0;g<a.length;g++)h=h.concat(rs({key:`${t}[${g}]`,value:a[g]}));return h}return rs({key:t,value:a})},variableAnchorOffsetCollection:function(s){const t=s.key,a=s.value,h=pn(a),g=s.styleSpec;if(h!=="array"||a.length<1||a.length%2!=0)return[new gt(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let S=0;S<a.length;S+=2)x=x.concat(Hr({key:`${t}[${S}]`,value:a[S],valueSpec:g.layout_symbol["text-anchor"]})),x=x.concat(fh({key:`${t}[${S+1}]`,value:a[S+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:g}));return x},sprite:or,state:xl};function mo(s){const t=s.value,a=s.valueSpec,h=s.styleSpec;return s.validateSpec=mo,a.expression&&ch(Ii(t))?wd(s):a.expression&&jo(ba(t))?Ba(s):a.type&&sc[a.type]?sc[a.type](s):qr(Vr({},s,{valueSpec:a.type?h[a.type]:a}))}function Ed(s){const t=s.value,a=s.key,h=yi(s);return h.length||(t.indexOf("{fontstack}")===-1&&h.push(new gt(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&h.push(new gt(a,t,'"glyphs" url must include a "{range}" token'))),h}function pr(s,t=Pe){let a=[];return a=a.concat(mo({key:"",value:s,valueSpec:t.$root,styleSpec:t,style:s,validateSpec:mo,objectElementValidators:{glyphs:Ed,"*":()=>[]}})),s.constants&&(a=a.concat(xd({key:"constants",value:s.constants}))),eu(a)}function Xr(s){return function(t){return s({...t,validateSpec:mo})}}function eu(s){return[].concat(s).sort((t,a)=>t.line-a.line)}function as(s){return function(...t){return eu(s.apply(this,t))}}pr.source=as(Xr(da)),pr.sprite=as(Xr(or)),pr.glyphs=as(Xr(Ed)),pr.light=as(Xr(Jc)),pr.sky=as(Xr(zf)),pr.terrain=as(Xr(Yp)),pr.state=as(Xr(xl)),pr.layer=as(Xr(bl)),pr.filter=as(Xr(Cs)),pr.paintProperty=as(Xr(Kc)),pr.layoutProperty=as(Xr(ph));const tu=pr,qp=tu.light,Ds=tu.sky,Lf=tu.paintProperty,Ad=tu.layoutProperty;function nu(s,t){let a=!1;if(t&&t.length)for(const h of t)s.fire(new at(new Error(h.message))),a=!0;return a}class Vo{constructor(t,a,h){const g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const S=new Int32Array(this.arrayBuffer);t=S[0],this.d=(a=S[1])+2*(h=S[2]);for(let D=0;D<this.d*this.d;D++){const P=S[3+D],L=S[3+D+1];g.push(P===L?null:S.subarray(P,L))}const A=S[3+g.length+1];this.keys=S.subarray(S[3+g.length],A),this.bboxes=S.subarray(A),this.insert=this._insertReadonly}else{this.d=a+2*h;for(let S=0;S<this.d*this.d;S++)g.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=h,this.scale=a/t,this.uid=0;const x=h/a*t;this.min=-x,this.max=t+x}insert(t,a,h,g,x){this._forEachCell(a,h,g,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,h,g,x,S){this.cells[x].push(S)}query(t,a,h,g,x){const S=this.min,A=this.max;if(t<=S&&a<=S&&A<=h&&A<=g&&!x)return Array.prototype.slice.call(this.keys);{const D=[];return this._forEachCell(t,a,h,g,this._queryCell,D,{},x),D}}_queryCell(t,a,h,g,x,S,A,D){const P=this.cells[x];if(P!==null){const L=this.keys,F=this.bboxes;for(let $=0;$<P.length;$++){const H=P[$];if(A[H]===void 0){const X=4*H;(D?D(F[X+0],F[X+1],F[X+2],F[X+3]):t<=F[X+2]&&a<=F[X+3]&&h>=F[X+0]&&g>=F[X+1])?(A[H]=!0,S.push(L[H])):A[H]=!1}}}}_forEachCell(t,a,h,g,x,S,A,D){const P=this._convertToCellCoord(t),L=this._convertToCellCoord(a),F=this._convertToCellCoord(h),$=this._convertToCellCoord(g);for(let H=P;H<=F;H++)for(let X=L;X<=$;X++){const ee=this.d*X+H;if((!D||D(this._convertFromCellCoord(H),this._convertFromCellCoord(X),this._convertFromCellCoord(H+1),this._convertFromCellCoord(X+1)))&&x.call(this,t,a,h,g,ee,S,A,D))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let h=0;for(let S=0;S<this.cells.length;S++)h+=this.cells[S].length;const g=new Int32Array(a+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let x=a;for(let S=0;S<t.length;S++){const A=t[S];g[3+S]=x,g.set(A,x),x+=A.length}return g[3+t.length]=x,g.set(this.keys,x),x+=this.keys.length,g[3+t.length+1]=x,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer}static serialize(t,a){const h=t.toArrayBuffer();return a&&a.push(h),{buffer:h}}static deserialize(t){return new Vo(t.buffer)}}const ss={};function Ct(s,t,a={}){if(ss[s])throw new Error(`${s} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:s,writeable:!1}),ss[s]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}Ct("Object",Object),Ct("Set",Set),Ct("TransferableGridIndex",Vo),Ct("Color",gn),Ct("Error",Error),Ct("AJAXError",_e),Ct("ResolvedImage",Nr),Ct("StylePropertyFunction",Yr),Ct("StyleExpression",uh,{omit:["_evaluator"]}),Ct("ZoomDependentExpression",Wc),Ct("ZoomConstantExpression",yl),Ct("CompoundExpression",Pa,{omit:["_evaluate"]});for(const s in nc)nc[s]._classRegistryKey||Ct(`Expression_${s}`,nc[s]);function mh(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function gh(s){return s.$name||s.constructor._classRegistryKey}function iu(s){return!function(t){if(t===null||typeof t!="object")return!1;const a=gh(t);return!(!a||a==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||mh(s)||Ka(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function oc(s,t){if(iu(s))return(mh(s)||Ka(s))&&t&&t.push(s),ArrayBuffer.isView(s)&&t&&t.push(s.buffer),s instanceof ImageData&&t&&t.push(s.data.buffer),s;if(Array.isArray(s)){const x=[];for(const S of s)x.push(oc(S,t));return x}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const a=gh(s);if(!a)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!ss[a])throw new Error(`${a} is not registered.`);const{klass:h}=ss[a],g=h.serialize?h.serialize(s,t):{};if(h.serialize){if(t&&g===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in s){if(!s.hasOwnProperty(x)||ss[a].omit.indexOf(x)>=0)continue;const S=s[x];g[x]=ss[a].shallow.indexOf(x)>=0?S:oc(S,t)}s instanceof Error&&(g.message=s.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(g.$name=a),g}function ks(s){if(iu(s))return s;if(Array.isArray(s))return s.map(ks);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const t=gh(s)||"Object";if(!ss[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=ss[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(s);const h=Object.create(a.prototype);for(const g of Object.keys(s)){if(g==="$name")continue;const x=s[g];h[g]=ss[t].shallow.indexOf(g)>=0?x:ks(x)}return h}class yh{constructor(){this.first=!0}update(t,a){const h=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=h,!0))}}const Sn={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Hangul Syllables":s=>s>=44032&&s<=55215,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Rs(s){for(const t of s)if(_h(t.charCodeAt(0)))return!0;return!1}function Of(s){for(const t of s)if(!Go(t.charCodeAt(0)))return!1;return!0}function ru(s){const t=s.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const wl=ru(["Arab","Dupl","Mong","Ougr","Syrc"]);function Go(s){return!wl.test(String.fromCodePoint(s))}const lc=ru(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function _h(s){return!(s!==746&&s!==747&&(s<4352||!(Sn["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Sn["CJK Compatibility"](s)||Sn["CJK Strokes"](s)||!(!Sn["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Sn["Enclosed CJK Letters and Months"](s)||Sn["Ideographic Description Characters"](s)||Sn.Kanbun(s)||Sn.Katakana(s)&&s!==12540||!(!Sn["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Sn["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Sn["Vertical Forms"](s)||Sn["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||lc.test(String.fromCodePoint(s)))))}function Md(s){return!(_h(s)||function(t){return!!(Sn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Sn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Sn["Letterlike Symbols"](t)||Sn["Number Forms"](t)||Sn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Sn["Control Pictures"](t)&&t!==9251||Sn["Optical Character Recognition"](t)||Sn["Enclosed Alphanumerics"](t)||Sn["Geometric Shapes"](t)||Sn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Sn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Sn["CJK Symbols and Punctuation"](t)||Sn.Katakana(t)||Sn["Private Use Area"](t)||Sn["CJK Compatibility Forms"](t)||Sn["Small Form Variants"](t)||Sn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(s))}const au=ru(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function cc(s){return au.test(String.fromCodePoint(s))}function jf(s,t){return!(!t&&cc(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Sn.Khmer(s))}function Bf(s){for(const t of s)if(cc(t.charCodeAt(0)))return!0;return!1}const Wr=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(Wr.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const a=s.pluginURL,h=new Promise(x=>{this.loadScriptResolve=x});t(a);const g=new Promise(x=>setTimeout(()=>x(),this.TIMEOUT));if(yield Promise.race([h,g]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:a};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class Hn{constructor(t,a){this.isSupportedScript=Cd,this.zoom=t,a?(this.now=a.now||0,this.fadeDuration=a.fadeDuration||0,this.zoomHistory=a.zoomHistory||new yh,this.transition=a.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yh,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),h=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*a}}}function Cd(s){return function(t,a){for(const h of t)if(!jf(h.charCodeAt(0),a))return!1;return!0}(s,Wr.getRTLTextPluginStatus()==="loaded")}class su{constructor(t,a,h){this.property=t,this.value=a,this.expression=function(g,x,S){if(ch(g))return new Yr(g,x);if(jo(g)){const A=La(g,x,S);if(A.result==="error")throw new Error(A.value.map(D=>`${D.key}: ${D.message}`).join(", "));return A.value}{let A=g;return x.type==="color"&&typeof g=="string"?A=gn.parse(g):x.type!=="padding"||typeof g!="number"&&!Array.isArray(g)?x.type!=="numberArray"||typeof g!="number"&&!Array.isArray(g)?x.type!=="colorArray"||typeof g!="string"&&!Array.isArray(g)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(g)?A=Pr.parse(g):x.type==="projectionDefinition"&&typeof g=="string"&&(A=Fi.parse(g)):A=Wi.parse(g):A=Ir.parse(g):A=fr.parse(g),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>A}}}(a===void 0?t.specification.default:a,t.specification,h)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,a,h){return this.property.possiblyEvaluate(this,t,a,h)}}class vh{constructor(t,a){this.property=t,this.value=new su(t,void 0,a)}transitioned(t,a){return new wn(this.property,this.value,a,fn({},t.transition,this.transition),t.now)}untransitioned(){return new wn(this.property,this.value,null,{},0)}}class go{constructor(t,a){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=a}getValue(t){return rr(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new vh(this._values[t].property,this._globalState)),this._values[t].value=new su(this._values[t].property,a===null?void 0:rr(a),this._globalState)}getTransition(t){return rr(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new vh(this._values[t].property,this._globalState)),this._values[t].transition=rr(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h);const g=this.getTransition(a);g!==void 0&&(t[`${a}-transition`]=g)}return t}transitioned(t,a){const h=new Qn(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(t,a._values[g]);return h}untransitioned(){const t=new Qn(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class wn{constructor(t,a,h,g,x){this.property=t,this.value=a,this.begin=x+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(t,a,h){const g=t.now||0,x=this.value.possiblyEvaluate(t,a,h),S=this.prior;if(S){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return S.possiblyEvaluate(t,a,h);{const A=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(t,a,h),x,bt(A))}}return x}}class Qn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,h){const g=new Zo(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(t,a,h);return g}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class lr{constructor(t,a){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=a}hasValue(t){return this._values[t].value!==void 0}getValue(t){return rr(this._values[t].value)}setValue(t,a){this._values[t]=new su(this._values[t].property,a===null?void 0:rr(a),this._globalState)}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h)}return t}possiblyEvaluate(t,a,h){const g=new Zo(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(t,a,h);return g}}class Fa{constructor(t,a,h){this.property=t,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,h,g){return this.property.evaluate(this.value,this.parameters,t,a,h,g)}}class Zo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class zt{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,h){const g=ho[this.specification.type];return g?g(t,a,h):t}}class $t{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,h,g){return new Fa(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},h,g)}:t.expression,a)}interpolate(t,a,h){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new Fa(this,{kind:"constant",value:void 0},t.parameters);const g=ho[this.specification.type];if(g){const x=g(t.value.value,a.value.value,h);return new Fa(this,{kind:"constant",value:x},t.parameters)}return t}evaluate(t,a,h,g,x,S){return t.kind==="constant"?t.value:t.evaluate(a,h,g,x,S)}}class Ua extends $t{possiblyEvaluate(t,a,h,g){if(t.value===void 0)return new Fa(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const x=t.expression.evaluate(a,null,{},h,g),S=t.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,A=this._calculate(S,S,S,a);return new Fa(this,{kind:"constant",value:A},a)}if(t.expression.kind==="camera"){const x=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new Fa(this,{kind:"constant",value:x},a)}return new Fa(this,t.expression,a)}evaluate(t,a,h,g,x,S){if(t.kind==="source"){const A=t.evaluate(a,h,g,x,S);return this._calculate(A,A,A,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},h,g),t.evaluate({zoom:Math.floor(a.zoom)},h,g),t.evaluate({zoom:Math.floor(a.zoom)+1},h,g),a):t.value}_calculate(t,a,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class Tl{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,g){if(t.value!==void 0){if(t.expression.kind==="constant"){const x=t.expression.evaluate(a,null,{},h,g);return this._calculate(x,x,x,a)}return this._calculate(t.expression.evaluate(new Hn(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Hn(Math.floor(a.zoom),a)),t.expression.evaluate(new Hn(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class Dd{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,g){return!!t.expression.evaluate(a,null,{},h,g)}interpolate(){return!1}}class Ln{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const h=t[a];h.specification.overridable&&this.overridableProperties.push(a);const g=this.defaultPropertyValues[a]=new su(h,void 0,void 0),x=this.defaultTransitionablePropertyValues[a]=new vh(h,void 0);this.defaultTransitioningPropertyValues[a]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=g.possiblyEvaluate({})}}}Ct("DataDrivenProperty",$t),Ct("DataConstantProperty",zt),Ct("CrossFadedDataDrivenProperty",Ua),Ct("CrossFadedProperty",Tl),Ct("ColorRampProperty",Dd);const bh="-transition";class Va extends Lt{constructor(t,a,h){if(super(),this.id=t.id,this.type=t.type,this._globalState=h,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=_l(t.filter,h)),a.layout&&(this._unevaluatedLayout=new lr(a.layout,h)),a.paint)){this._transitionablePaint=new go(a.paint,h);for(const g in t.paint)this.setPaintProperty(g,t.paint[g],{validate:!1});for(const g in t.layout)this.setLayoutProperty(g,t.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Zo(a.paint)}}setFilter(t){this.filter=t,this._featureFilter=_l(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const a in this._unevaluatedLayout._values){const h=this._unevaluatedLayout._values[a];for(const g of h.getGlobalStateRefs())t.add(g)}for(const a of this._featureFilter.getGlobalStateRefs())t.add(a);return t}getPaintAffectingGlobalStateRefs(){var t;const a=new globalThis.Map;if(this._transitionablePaint)for(const h in this._transitionablePaint._values){const g=this._transitionablePaint._values[h].value;for(const x of g.getGlobalStateRefs()){const S=(t=a.get(x))!==null&&t!==void 0?t:[];S.push({name:h,value:g.value}),a.set(x,S)}}return a}setLayoutProperty(t,a,h={}){a!=null&&this._validate(Ad,`layers.${this.id}.layout.${t}`,t,a,h)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(bh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,h={}){if(a!=null&&this._validate(Lf,`layers.${this.id}.paint.${t}`,t,a,h))return!1;if(t.endsWith(bh))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const g=this._transitionablePaint._values[t],x=g.property.specification["property-type"]==="cross-faded-data-driven",S=g.value.isDataDriven(),A=g.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const D=this._transitionablePaint._values[t].value;return D.isDataDriven()||S||x||this._handleOverridablePaintPropertyUpdate(t,A,D)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,h){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),sa(t,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}_validate(t,a,h,g,x={}){return(!x||x.validate!==!1)&&nu(this,t.call(tu,{key:a,layerType:this.type,objectKey:h,value:g,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof Fa&&Na(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Hp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class os{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ei(s,t=1){let a=0,h=0;return{members:s.map(g=>{const x=Hp[g.type].BYTES_PER_ELEMENT,S=a=xh(a,Math.max(t,x)),A=g.components||1;return h=Math.max(h,x),a+=x*A,{name:g.name,type:g.type,components:A,offset:S}}),size:xh(a,Math.max(h,t)),alignment:t}}function xh(s,t){return Math.ceil(s/t)*t}class $o extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const g=2*t;return this.int16[g+0]=a,this.int16[g+1]=h,t}}$o.prototype.bytesPerElement=4,Ct("StructArrayLayout2i4",$o);class Lr extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const x=3*t;return this.int16[x+0]=a,this.int16[x+1]=h,this.int16[x+2]=g,t}}Lr.prototype.bytesPerElement=6,Ct("StructArrayLayout3i6",Lr);class Ai extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,t,a,h,g)}emplace(t,a,h,g,x){const S=4*t;return this.int16[S+0]=a,this.int16[S+1]=h,this.int16[S+2]=g,this.int16[S+3]=x,t}}Ai.prototype.bytesPerElement=8,Ct("StructArrayLayout4i8",Ai);class Yo extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,x,S)}emplace(t,a,h,g,x,S,A){const D=6*t;return this.int16[D+0]=a,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=x,this.int16[D+4]=S,this.int16[D+5]=A,t}}Yo.prototype.bytesPerElement=12,Ct("StructArrayLayout2i4i12",Yo);class uc extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,x,S)}emplace(t,a,h,g,x,S,A){const D=4*t,P=8*t;return this.int16[D+0]=a,this.int16[D+1]=h,this.uint8[P+4]=g,this.uint8[P+5]=x,this.uint8[P+6]=S,this.uint8[P+7]=A,t}}uc.prototype.bytesPerElement=8,Ct("StructArrayLayout2i4ub8",uc);class qo extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const g=2*t;return this.float32[g+0]=a,this.float32[g+1]=h,t}}qo.prototype.bytesPerElement=8,Ct("StructArrayLayout2f8",qo);class Ho extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S,A,D,P,L){const F=this.length;return this.resize(F+1),this.emplace(F,t,a,h,g,x,S,A,D,P,L)}emplace(t,a,h,g,x,S,A,D,P,L,F){const $=10*t;return this.uint16[$+0]=a,this.uint16[$+1]=h,this.uint16[$+2]=g,this.uint16[$+3]=x,this.uint16[$+4]=S,this.uint16[$+5]=A,this.uint16[$+6]=D,this.uint16[$+7]=P,this.uint16[$+8]=L,this.uint16[$+9]=F,t}}Ho.prototype.bytesPerElement=20,Ct("StructArrayLayout10ui20",Ho);class Is extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S,A,D,P,L,F,$){const H=this.length;return this.resize(H+1),this.emplace(H,t,a,h,g,x,S,A,D,P,L,F,$)}emplace(t,a,h,g,x,S,A,D,P,L,F,$,H){const X=12*t;return this.int16[X+0]=a,this.int16[X+1]=h,this.int16[X+2]=g,this.int16[X+3]=x,this.uint16[X+4]=S,this.uint16[X+5]=A,this.uint16[X+6]=D,this.uint16[X+7]=P,this.int16[X+8]=L,this.int16[X+9]=F,this.int16[X+10]=$,this.int16[X+11]=H,t}}Is.prototype.bytesPerElement=24,Ct("StructArrayLayout4i4ui4i24",Is);class ou extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const x=3*t;return this.float32[x+0]=a,this.float32[x+1]=h,this.float32[x+2]=g,t}}ou.prototype.bytesPerElement=12,Ct("StructArrayLayout3f12",ou);class lu extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}lu.prototype.bytesPerElement=4,Ct("StructArrayLayout1ul4",lu);class wh extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S,A,D,P){const L=this.length;return this.resize(L+1),this.emplace(L,t,a,h,g,x,S,A,D,P)}emplace(t,a,h,g,x,S,A,D,P,L){const F=10*t,$=5*t;return this.int16[F+0]=a,this.int16[F+1]=h,this.int16[F+2]=g,this.int16[F+3]=x,this.int16[F+4]=S,this.int16[F+5]=A,this.uint32[$+3]=D,this.uint16[F+8]=P,this.uint16[F+9]=L,t}}wh.prototype.bytesPerElement=20,Ct("StructArrayLayout6i1ul2ui20",wh);class b extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,x,S)}emplace(t,a,h,g,x,S,A){const D=6*t;return this.int16[D+0]=a,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=x,this.int16[D+4]=S,this.int16[D+5]=A,t}}b.prototype.bytesPerElement=12,Ct("StructArrayLayout2i2i2i12",b);class e extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,a,h,g,x)}emplace(t,a,h,g,x,S){const A=4*t,D=8*t;return this.float32[A+0]=a,this.float32[A+1]=h,this.float32[A+2]=g,this.int16[D+6]=x,this.int16[D+7]=S,t}}e.prototype.bytesPerElement=16,Ct("StructArrayLayout2f1f2i16",e);class o extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,x,S)}emplace(t,a,h,g,x,S,A){const D=16*t,P=4*t,L=8*t;return this.uint8[D+0]=a,this.uint8[D+1]=h,this.float32[P+1]=g,this.float32[P+2]=x,this.int16[L+6]=S,this.int16[L+7]=A,t}}o.prototype.bytesPerElement=16,Ct("StructArrayLayout2ub2f2i16",o);class f extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const x=3*t;return this.uint16[x+0]=a,this.uint16[x+1]=h,this.uint16[x+2]=g,t}}f.prototype.bytesPerElement=6,Ct("StructArrayLayout3ui6",f);class y extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de){const ke=this.length;return this.resize(ke+1),this.emplace(ke,t,a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de)}emplace(t,a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de,ke){const ve=24*t,Se=12*t,Be=48*t;return this.int16[ve+0]=a,this.int16[ve+1]=h,this.uint16[ve+2]=g,this.uint16[ve+3]=x,this.uint32[Se+2]=S,this.uint32[Se+3]=A,this.uint32[Se+4]=D,this.uint16[ve+10]=P,this.uint16[ve+11]=L,this.uint16[ve+12]=F,this.float32[Se+7]=$,this.float32[Se+8]=H,this.uint8[Be+36]=X,this.uint8[Be+37]=ee,this.uint8[Be+38]=se,this.uint32[Se+10]=de,this.int16[ve+22]=ke,t}}y.prototype.bytesPerElement=48,Ct("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",y);class T extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de,ke,ve,Se,Be,Qe,lt,Tt,mt,wt,jt,xt){const yt=this.length;return this.resize(yt+1),this.emplace(yt,t,a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de,ke,ve,Se,Be,Qe,lt,Tt,mt,wt,jt,xt)}emplace(t,a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de,ke,ve,Se,Be,Qe,lt,Tt,mt,wt,jt,xt,yt){const nt=32*t,Gt=16*t;return this.int16[nt+0]=a,this.int16[nt+1]=h,this.int16[nt+2]=g,this.int16[nt+3]=x,this.int16[nt+4]=S,this.int16[nt+5]=A,this.int16[nt+6]=D,this.int16[nt+7]=P,this.uint16[nt+8]=L,this.uint16[nt+9]=F,this.uint16[nt+10]=$,this.uint16[nt+11]=H,this.uint16[nt+12]=X,this.uint16[nt+13]=ee,this.uint16[nt+14]=se,this.uint16[nt+15]=de,this.uint16[nt+16]=ke,this.uint16[nt+17]=ve,this.uint16[nt+18]=Se,this.uint16[nt+19]=Be,this.uint16[nt+20]=Qe,this.uint16[nt+21]=lt,this.uint16[nt+22]=Tt,this.uint32[Gt+12]=mt,this.float32[Gt+13]=wt,this.float32[Gt+14]=jt,this.uint16[nt+30]=xt,this.uint16[nt+31]=yt,t}}T.prototype.bytesPerElement=64,Ct("StructArrayLayout8i15ui1ul2f2ui64",T);class E extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}E.prototype.bytesPerElement=4,Ct("StructArrayLayout1f4",E);class k extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const x=3*t;return this.uint16[6*t+0]=a,this.float32[x+1]=h,this.float32[x+2]=g,t}}k.prototype.bytesPerElement=12,Ct("StructArrayLayout1ui2f12",k);class I extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const x=4*t;return this.uint32[2*t+0]=a,this.uint16[x+2]=h,this.uint16[x+3]=g,t}}I.prototype.bytesPerElement=8,Ct("StructArrayLayout1ul2ui8",I);class O extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const g=2*t;return this.uint16[g+0]=a,this.uint16[g+1]=h,t}}O.prototype.bytesPerElement=4,Ct("StructArrayLayout2ui4",O);class j extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}j.prototype.bytesPerElement=2,Ct("StructArrayLayout1ui2",j);class Z extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,t,a,h,g)}emplace(t,a,h,g,x){const S=4*t;return this.float32[S+0]=a,this.float32[S+1]=h,this.float32[S+2]=g,this.float32[S+3]=x,t}}Z.prototype.bytesPerElement=16,Ct("StructArrayLayout4f16",Z);class U extends os{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}U.prototype.size=20;class Y extends wh{get(t){return new U(this,t)}}Ct("CollisionBoxArray",Y);class Q extends os{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Q.prototype.size=48;class le extends y{get(t){return new Q(this,t)}}Ct("PlacedSymbolArray",le);class oe extends os{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}oe.prototype.size=64;class ue extends T{get(t){return new oe(this,t)}}Ct("SymbolInstanceArray",ue);class he extends E{getoffsetX(t){return this.float32[1*t+0]}}Ct("GlyphOffsetArray",he);class ye extends Lr{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ct("SymbolLineVertexArray",ye);class me extends os{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}me.prototype.size=12;class xe extends k{get(t){return new me(this,t)}}Ct("TextAnchorOffsetArray",xe);class Ee extends os{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ee.prototype.size=8;class ge extends I{get(t){return new Ee(this,t)}}Ct("FeatureIndexArray",ge);class De extends $o{}class qe extends $o{}class Le extends $o{}class Oe extends Yo{}class Ye extends uc{}class vt extends qo{}class pt extends Ho{}class ot extends Is{}class Ot extends ou{}class mn extends lu{}class Rn extends b{}class Mi extends o{}class Fn extends f{}class _i extends O{}const Ci=Ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:oi}=Ci;class on{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,h,g){const x=this.segments[this.segments.length-1];return t>on.MAX_VERTEX_ARRAY_LENGTH&&Wn(`Max vertices per segment is ${on.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${on.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+t>on.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g?this.createNewSegment(a,h,g):x}createNewSegment(t,a,h){const g={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return h!==void 0&&(g.sortKey=h),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(t,a,h){return this.prepareSegment(0,t,a,h)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,h,g){return new on([{vertexOffset:t,primitiveOffset:a,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function cr(s,t){return 256*(s=Bt(Math.floor(s),0,255))+Bt(Math.floor(t),0,255)}on.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ct("SegmentVector",on);const $i=Ei([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var mr,fa,Sl,ls={exports:{}},cs={exports:{}},Xo={exports:{}},hc=function(){if(Sl)return ls.exports;Sl=1;var s=(mr||(mr=1,cs.exports=function(a,h){var g,x,S,A,D,P,L,F;for(x=a.length-(g=3&a.length),S=h,D=3432918353,P=461845907,F=0;F<x;)L=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,S=27492+(65535&(A=5*(65535&(S=(S^=L=(65535&(L=(L=(65535&L)*D+(((L>>>16)*D&65535)<<16)&4294967295)<<15|L>>>17))*P+(((L>>>16)*P&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(L=0,g){case 3:L^=(255&a.charCodeAt(F+2))<<16;case 2:L^=(255&a.charCodeAt(F+1))<<8;case 1:S^=L=(65535&(L=(L=(65535&(L^=255&a.charCodeAt(F)))*D+(((L>>>16)*D&65535)<<16)&4294967295)<<15|L>>>17))*P+(((L>>>16)*P&65535)<<16)&4294967295}return S^=a.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),cs.exports),t=(fa||(fa=1,Xo.exports=function(a,h){for(var g,x=a.length,S=h^x,A=0;x>=4;)g=1540483477*(65535&(g=255&a.charCodeAt(A)|(255&a.charCodeAt(++A))<<8|(255&a.charCodeAt(++A))<<16|(255&a.charCodeAt(++A))<<24))+((1540483477*(g>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),x-=4,++A;switch(x){case 3:S^=(255&a.charCodeAt(A+2))<<16;case 2:S^=(255&a.charCodeAt(A+1))<<8;case 1:S=1540483477*(65535&(S^=255&a.charCodeAt(A)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),Xo.exports);return ls.exports=s,ls.exports.murmur3=s,ls.exports.murmur2=t,ls.exports}(),dc=R(hc);class yo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,h,g){this.ids.push(Qr(t)),this.positions.push(a,h,g)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Qr(t);let h=0,g=this.ids.length-1;for(;h<g;){const S=h+g>>1;this.ids[S]>=a?g=S:h=S+1}const x=[];for(;this.ids[h]===a;)x.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return x}static serialize(t,a){const h=new Float64Array(t.ids),g=new Uint32Array(t.positions);return Ps(h,g,0,h.length-1),a&&a.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(t){const a=new yo;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function Qr(s){const t=+s;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:dc(String(s))}function Ps(s,t,a,h){for(;a<h;){const g=s[a+h>>1];let x=a-1,S=h+1;for(;;){do x++;while(s[x]<g);do S--;while(s[S]>g);if(x>=S)break;Ns(s,x,S),Ns(t,3*x,3*S),Ns(t,3*x+1,3*S+1),Ns(t,3*x+2,3*S+2)}S-a<h-S?(Ps(s,t,a,S),a=S+1):(Ps(s,t,S+1,h),h=S)}}function Ns(s,t,a){const h=s[t];s[t]=s[a],s[a]=h}Ct("FeaturePositionMap",yo);class Ga{constructor(t,a){this.gl=t.gl,this.location=a}}class ui extends Ga{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Ui extends Ga{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Kr extends Ga{constructor(t,a){super(t,a),this.current=gn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Yi=new Float32Array(16);function cu(s){return[cr(255*s.r,255*s.g),cr(255*s.b,255*s.a)]}class uu{constructor(t,a,h){this.value=t,this.uniformNames=a.map(g=>`u_${g}`),this.type=h}setUniform(t,a,h){t.set(h.constantOr(this.value))}getBinding(t,a,h){return this.type==="color"?new Kr(t,a):new ui(t,a)}}class fc{constructor(t,a){this.uniformNames=a.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,h,g){const x=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&t.set(x)}getBinding(t,a,h){return h.substr(0,9)==="u_pattern"?new Ui(t,a):new ui(t,a)}}class xa{constructor(t,a,h,g){this.expression=t,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(x=>({name:`a_${x}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,a,h){const g=this.paintVertexArray.length,x=this.expression.evaluate(new Hn(0,h),a,{},h.canonical,[],h.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(g,t,x)}updatePaintArray(t,a,h,g,x){const S=this.expression.evaluate(new Hn(0,x),h,g);this._setPaintValue(t,a,S)}_setPaintValue(t,a,h){if(this.type==="color"){const g=cu(h);for(let x=t;x<a;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class us{constructor(t,a,h,g,x,S){this.expression=t,this.uniformNames=a.map(A=>`u_${A}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=a.map(A=>({name:`a_${A}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(t,a,h){const g=this.expression.evaluate(new Hn(this.zoom,h),a,{},h.canonical,[],h.formattedSection),x=this.expression.evaluate(new Hn(this.zoom+1,h),a,{},h.canonical,[],h.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,g,x)}updatePaintArray(t,a,h,g,x){const S=this.expression.evaluate(new Hn(this.zoom,x),h,g),A=this.expression.evaluate(new Hn(this.zoom+1,x),h,g);this._setPaintValue(t,a,S,A)}_setPaintValue(t,a,h,g){if(this.type==="color"){const x=cu(h),S=cu(g);for(let A=t;A<a;A++)this.paintVertexArray.emplace(A,x[0],x[1],S[0],S[1])}else{for(let x=t;x<a;x++)this.paintVertexArray.emplace(x,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const h=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,g=Bt(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);t.set(g)}getBinding(t,a,h){return new ui(t,a)}}class gr{constructor(t,a,h,g,x,S){this.expression=t,this.type=a,this.useIntegerZoom=h,this.zoom=g,this.layerId=S,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(t,a,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,a.patterns&&a.patterns[this.layerId],h.imagePositions)}updatePaintArray(t,a,h,g,x){this._setPaintValues(t,a,h.patterns&&h.patterns[this.layerId],x.imagePositions)}_setPaintValues(t,a,h,g){if(!g||!h)return;const{min:x,mid:S,max:A}=h,D=g[x],P=g[S],L=g[A];if(D&&P&&L)for(let F=t;F<a;F++)this.zoomInPaintVertexArray.emplace(F,P.tl[0],P.tl[1],P.br[0],P.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],P.pixelRatio,D.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,P.tl[0],P.tl[1],P.br[0],P.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],P.pixelRatio,L.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,$i.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,$i.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Or{constructor(t,a,h){this.binders={},this._buffers=[];const g=[];for(const x in t.paint._values){if(!h(x))continue;const S=t.paint.get(x);if(!(S instanceof Fa&&Na(S.property.specification)))continue;const A=Ff(x,t.type),D=S.value,P=S.property.specification.type,L=S.property.useIntegerZoom,F=S.property.specification["property-type"],$=F==="cross-faded"||F==="cross-faded-data-driven";if(D.kind==="constant")this.binders[x]=$?new fc(D.value,A):new uu(D.value,A,P),g.push(`/u_${x}`);else if(D.kind==="source"||$){const H=_o(x,P,"source");this.binders[x]=$?new gr(D,P,L,a,H,t.id):new xa(D,A,P,H),g.push(`/a_${x}`)}else{const H=_o(x,P,"composite");this.binders[x]=new us(D,A,P,L,a,H),g.push(`/z_${x}`)}}this.cacheKey=g.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof xa||a instanceof us?a.maxValue:0}populatePaintArrays(t,a,h){for(const g in this.binders){const x=this.binders[g];(x instanceof xa||x instanceof us||x instanceof gr)&&x.populatePaintArray(t,a,h)}}setConstantPatternPositions(t,a){for(const h in this.binders){const g=this.binders[h];g instanceof fc&&g.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,h,g,x){let S=!1;for(const A in t){const D=a.getPositions(A);for(const P of D){const L=h.feature(P.index);for(const F in this.binders){const $=this.binders[F];if(($ instanceof xa||$ instanceof us||$ instanceof gr)&&$.expression.isStateDependent===!0){const H=g.paint.get(F);$.expression=H.value,$.updatePaintArray(P.start,P.end,L,t[A],x),S=!0}}}}return S}defines(){const t=[];for(const a in this.binders){const h=this.binders[a];(h instanceof uu||h instanceof fc)&&t.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof xa||h instanceof us)for(let g=0;g<h.paintVertexAttributes.length;g++)t.push(h.paintVertexAttributes[g].name);else if(h instanceof gr)for(let g=0;g<$i.members.length;g++)t.push($i.members[g].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof uu||h instanceof fc||h instanceof us)for(const g of h.uniformNames)t.push(g)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const h=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof uu||x instanceof fc||x instanceof us){for(const S of x.uniformNames)if(a[S]){const A=x.getBinding(t,a[S],S);h.push({name:S,property:g,binding:A})}}}return h}setUniforms(t,a,h,g){for(const{name:x,property:S,binding:A}of a)this.binders[S].setUniform(A,g,h.get(S),x)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const h=this.binders[a];if(t&&h instanceof gr){const g=t.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof xa||h instanceof us)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(t){for(const a in this.binders){const h=this.binders[a];(h instanceof xa||h instanceof us||h instanceof gr)&&h.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof xa||a instanceof us||a instanceof gr)&&a.destroy()}}}class pa{constructor(t,a,h=()=>!0){this.programConfigurations={};for(const g of t)this.programConfigurations[g.id]=new Or(g,a,h);this.needsUpload=!1,this._featureMap=new yo,this._bufferOffset=0}populatePaintArrays(t,a,h,g){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,a,g);a.id!==void 0&&this._featureMap.add(a.id,h,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,h,g){for(const x of h)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(t,this._featureMap,a,x,g)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Ff(s,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${t}-`,"").replace(/-/g,"_")]}function _o(s,t,a){const h={color:{source:qo,composite:Z},number:{source:E,composite:qo}},g=function(x){return{"line-pattern":{source:pt,composite:pt},"fill-pattern":{source:pt,composite:pt},"fill-extrusion-pattern":{source:pt,composite:pt}}[x]}(s);return g&&g[a]||h[t][a]}Ct("ConstantBinder",uu),Ct("CrossFadedConstantBinder",fc),Ct("SourceExpressionBinder",xa),Ct("CrossFadedCompositeBinder",gr),Ct("CompositeExpressionBinder",us),Ct("ProgramConfiguration",Or,{omit:["_buffers"]}),Ct("ProgramConfigurationSet",pa);const Za=Math.pow(2,14)-1,Ki=-Za-1;function hs(s){const t=It/s.extent,a=s.loadGeometry();for(let h=0;h<a.length;h++){const g=a[h];for(let x=0;x<g.length;x++){const S=g[x],A=Math.round(S.x*t),D=Math.round(S.y*t);S.x=Bt(A,Ki,Za),S.y=Bt(D,Ki,Za),(A<S.x||A>S.x+1||D<S.y||D>S.y+1)&&Wn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function pc(s,t){return{type:s.type,id:s.id,properties:s.properties,geometry:t?hs(s):[]}}const Xp=-32768;function L_(s,t,a,h,g){s.emplaceBack(Xp+8*t+h,Xp+8*a+g)}class Wp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new qe,this.indexArray=new Fn,this.segments=new on,this.programConfigurations=new pa(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){const g=this.layers[0],x=[];let S=null,A=!1,D=g.type==="heatmap";if(g.type==="circle"){const L=g;S=L.layout.get("circle-sort-key"),A=!S.isConstant(),D=D||L.paint.get("circle-pitch-alignment")==="map"}const P=D?a.subdivisionGranularity.circle:1;for(const{feature:L,id:F,index:$,sourceLayerIndex:H}of t){const X=this.layers[0]._featureFilter.needGeometry,ee=pc(L,X);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),ee,h))continue;const se=A?S.evaluate(ee,{},h):void 0,de={id:F,properties:L.properties,type:L.type,sourceLayerIndex:H,index:$,geometry:X?ee.geometry:hs(L),patterns:{},sortKey:se};x.push(de)}A&&x.sort((L,F)=>L.sortKey-F.sortKey);for(const L of x){const{geometry:F,index:$,sourceLayerIndex:H}=L,X=t[$].feature;this.addFeature(L,F,$,h,P),a.featureIndex.insert(X,F,$,H,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,oi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,h,g,x=1){let S;switch(x){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const A=S.length;for(const D of a)for(const P of D){const L=P.x,F=P.y;if(L<0||L>=It||F<0||F>=It)continue;const $=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,t.sortKey),H=$.vertexLength;for(let X=0;X<A;X++)for(let ee=0;ee<A;ee++)L_(this.layoutVertexArray,L,F,S[ee],S[X]);for(let X=0;X<A-1;X++)for(let ee=0;ee<A-1;ee++){const se=H+X*A+ee,de=H+(X+1)*A+ee;this.indexArray.emplaceBack(se,de+1,se+1),this.indexArray.emplaceBack(se,de,de+1)}$.vertexLength+=A*A,$.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:{},canonical:g})}}function hu(s,t){for(let a=0;a<s.length;a++)if(Sh(t,s[a]))return!0;for(let a=0;a<t.length;a++)if(Sh(s,t[a]))return!0;return!!Qp(s,t)}function Th(s,t,a){return!!Sh(s,t)||!!Jp(t,s,a)}function Ig(s,t){if(s.length===1)return Pg(t,s[0]);for(let a=0;a<t.length;a++){const h=t[a];for(let g=0;g<h.length;g++)if(Sh(s,h[g]))return!0}for(let a=0;a<s.length;a++)if(Pg(t,s[a]))return!0;for(let a=0;a<t.length;a++)if(Qp(s,t[a]))return!0;return!1}function O_(s,t,a){if(s.length>1){if(Qp(s,t))return!0;for(let h=0;h<t.length;h++)if(Jp(t[h],s,a))return!0}for(let h=0;h<s.length;h++)if(Jp(s[h],t,a))return!0;return!1}function Qp(s,t){if(s.length===0||t.length===0)return!1;for(let a=0;a<s.length-1;a++){const h=s[a],g=s[a+1];for(let x=0;x<t.length-1;x++)if(Kp(h,g,t[x],t[x+1]))return!0}return!1}function Kp(s,t,a,h){return Nn(s,a,h)!==Nn(t,a,h)&&Nn(s,t,a)!==Nn(s,t,h)}function Jp(s,t,a){const h=a*a;if(t.length===1)return s.distSqr(t[0])<h;for(let g=1;g<t.length;g++)if(em(s,t[g-1],t[g])<h)return!0;return!1}function em(s,t,a){const h=t.distSqr(a);if(h===0)return s.distSqr(t);const g=((s.x-t.x)*(a.x-t.x)+(s.y-t.y)*(a.y-t.y))/h;return s.distSqr(g<0?t:g>1?a:a.sub(t)._mult(g)._add(t))}function Pg(s,t){let a,h,g,x=!1;for(let S=0;S<s.length;S++){a=s[S];for(let A=0,D=a.length-1;A<a.length;D=A++)h=a[A],g=a[D],h.y>t.y!=g.y>t.y&&t.x<(g.x-h.x)*(t.y-h.y)/(g.y-h.y)+h.x&&(x=!x)}return x}function Sh(s,t){let a=!1;for(let h=0,g=s.length-1;h<s.length;g=h++){const x=s[h],S=s[g];x.y>t.y!=S.y>t.y&&t.x<(S.x-x.x)*(t.y-x.y)/(S.y-x.y)+x.x&&(a=!a)}return a}function Dv(s,t,a){const h=a[0],g=a[2];if(s.x<h.x&&t.x<h.x||s.x>g.x&&t.x>g.x||s.y<h.y&&t.y<h.y||s.y>g.y&&t.y>g.y)return!1;const x=Nn(s,t,a[0]);return x!==Nn(s,t,a[1])||x!==Nn(s,t,a[2])||x!==Nn(s,t,a[3])}function Eh(s,t,a){const h=t.paint.get(s).value;return h.kind==="constant"?h.value:a.programConfigurations.get(t.id).getMaxValue(s)}function yr(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Er(s,t,a,h,g){if(!t[0]&&!t[1])return s;const x=C.convert(t)._mult(g);a==="viewport"&&x._rotate(-h);const S=[];for(let A=0;A<s.length;A++)S.push(s[A].sub(x));return S}function j_({queryGeometry:s,size:t},a){return Th(s,a,t)}function B_({queryGeometry:s,size:t,transform:a,unwrappedTileID:h,getElevation:g},x){return Th(s,x,t*(a.projectTileCoordinates(x.x,x.y,h,g).signedDistanceFromCamera/a.cameraToCenterDistance))}function F_({queryGeometry:s,size:t,transform:a,unwrappedTileID:h,getElevation:g},x){const S=a.projectTileCoordinates(x.x,x.y,h,g).signedDistanceFromCamera,A=t*(a.cameraToCenterDistance/S);return Th(s,kd(x,a,h,g),A)}function U_({queryGeometry:s,size:t,transform:a,unwrappedTileID:h,getElevation:g},x){return Th(s,kd(x,a,h,g),t)}function Ng({queryGeometry:s,size:t,transform:a,unwrappedTileID:h,getElevation:g,pitchAlignment:x="map",pitchScale:S="map"},A){const D=x==="map"?S==="map"?j_:B_:S==="map"?F_:U_,P={queryGeometry:s,size:t,transform:a,unwrappedTileID:h,getElevation:g};for(const L of A)for(const F of L)if(D(P,F))return!0;return!1}function kd(s,t,a,h){const g=t.projectTileCoordinates(s.x,s.y,a,h).point;return new C((.5*g.x+.5)*t.width,(.5*-g.y+.5)*t.height)}let tm,zg;Ct("CircleBucket",Wp,{omit:["layers"]});var V_={get paint(){return zg=zg||new Ln({"circle-radius":new $t(Pe.paint_circle["circle-radius"]),"circle-color":new $t(Pe.paint_circle["circle-color"]),"circle-blur":new $t(Pe.paint_circle["circle-blur"]),"circle-opacity":new $t(Pe.paint_circle["circle-opacity"]),"circle-translate":new zt(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $t(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $t(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $t(Pe.paint_circle["circle-stroke-opacity"])})},get layout(){return tm=tm||new Ln({"circle-sort-key":new $t(Pe.layout_circle["circle-sort-key"])})}};class G_ extends Va{constructor(t,a){super(t,V_,a)}createBucket(t){return new Wp(t)}queryRadius(t){const a=t;return Eh("circle-radius",this,a)+Eh("circle-stroke-width",this,a)+yr(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:x,pixelsToTileUnits:S,unwrappedTileID:A,getElevation:D}){const P=Er(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,S),L=this.paint.get("circle-radius").evaluate(a,h)+this.paint.get("circle-stroke-width").evaluate(a,h),F=this.paint.get("circle-pitch-scale"),$=this.paint.get("circle-pitch-alignment");let H,X;return $==="map"?(H=P,X=L*S):(H=function(ee,se,de,ke){return ee.map(ve=>kd(ve,se,de,ke))}(P,x,A,D),X=L),Ng({queryGeometry:H,size:X,transform:x,unwrappedTileID:A,getElevation:D,pitchAlignment:$,pitchScale:F},g)}}class nm extends Wp{}let im;Ct("HeatmapBucket",nm,{omit:["layers"]});var Lg={get paint(){return im=im||new Ln({"heatmap-radius":new $t(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $t(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Dd(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(Pe.paint_heatmap["heatmap-opacity"])})}};function rm(s,{width:t,height:a},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==t*a*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${t*a*h}`)}else g=new Uint8Array(t*a*h);return s.width=t,s.height=a,s.data=g,s}function am(s,{width:t,height:a},h){if(t===s.width&&a===s.height)return;const g=rm({},{width:t,height:a},h);Rd(s,g,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,t),height:Math.min(s.height,a)},h),s.width=t,s.height=a,s.data=g.data}function Rd(s,t,a,h,g,x){if(g.width===0||g.height===0)return t;if(g.width>s.width||g.height>s.height||a.x>s.width-g.width||a.y>s.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>t.width||g.height>t.height||h.x>t.width-g.width||h.y>t.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const S=s.data,A=t.data;if(S===A)throw new Error("srcData equals dstData, so image is already copied");for(let D=0;D<g.height;D++){const P=((a.y+D)*s.width+a.x)*x,L=((h.y+D)*t.width+h.x)*x;for(let F=0;F<g.width*x;F++)A[L+F]=S[P+F]}return t}class Ah{constructor(t,a){rm(this,t,1,a)}resize(t){am(this,t,1)}clone(){return new Ah({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,g,x){Rd(t,a,h,g,x,1)}}class wa{constructor(t,a){rm(this,t,4,a)}resize(t){am(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new wa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,g,x){Rd(t,a,h,g,x,4)}setPixel(t,a,h){const g=4*(t*this.width+a);this.data[g+0]=Math.round(255*h.r/h.a),this.data[g+1]=Math.round(255*h.g/h.a),this.data[g+2]=Math.round(255*h.b/h.a),this.data[g+3]=Math.round(255*h.a)}}function sm(s){const t={},a=s.resolution||256,h=s.clips?s.clips.length:1,g=s.image||new wa({width:a,height:h});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const x=(S,A,D)=>{t[s.evaluationKey]=D;const P=s.expression.evaluate(t);g.setPixel(S/4/a,A/4,P)};if(s.clips)for(let S=0,A=0;S<h;++S,A+=4*a)for(let D=0,P=0;D<a;D++,P+=4){const L=D/(a-1),{start:F,end:$}=s.clips[S];x(A,P,F*(1-L)+$*L)}else for(let S=0,A=0;S<a;S++,A+=4)x(0,A,S/(a-1));return g}Ct("AlphaImage",Ah),Ct("RGBAImage",wa);const om="big-fb";class mc extends Va{createBucket(t){return new nm(t)}constructor(t,a){super(t,Lg,a),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(om)&&this.heatmapFbos.delete(om)}queryRadius(t){return Eh("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:x,pixelsToTileUnits:S,unwrappedTileID:A,getElevation:D}){return Ng({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(a,h)*S,transform:x,unwrappedTileID:A,getElevation:D},g)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let lm;var kv={get paint(){return lm=lm||new Ln({"hillshade-illumination-direction":new zt(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new zt(Pe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new zt(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(Pe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new zt(Pe.paint_hillshade["hillshade-method"])})}};class Z_ extends Va{constructor(t,a){super(t,kv,a),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,h=this.paint.get("hillshade-highlight-color").values,g=this.paint.get("hillshade-shadow-color").values;const x=Math.max(t.length,a.length,h.length,g.length);t=t.concat(Array(x-t.length).fill(t.at(-1))),a=a.concat(Array(x-a.length).fill(a.at(-1))),h=h.concat(Array(x-h.length).fill(h.at(-1))),g=g.concat(Array(x-g.length).fill(g.at(-1)));const S=a.map(Ts);return{directionRadians:t.map(Ts),altitudeRadians:S,shadowColor:g,highlightColor:h}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let El;var $_={get paint(){return El=El||new Ln({"color-relief-opacity":new zt(Pe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Dd(Pe["paint_color-relief"]["color-relief-color"])})}};class Id{constructor(t,a,h,g){this.context=t,this.format=h,this.texture=t.gl.createTexture(),this.update(a,g)}update(t,a,h){const{width:g,height:x}=t,S=!(this.size&&this.size[0]===g&&this.size[1]===x||h),{context:A}=this,{gl:D}=A;if(this.useMipmap=!!(a&&a.useMipmap),D.bindTexture(D.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===D.RGBA&&(!a||a.premultiply!==!1)),S)this.size=[g,x],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Ka(t)?D.texImage2D(D.TEXTURE_2D,0,this.format,this.format,D.UNSIGNED_BYTE,t):D.texImage2D(D.TEXTURE_2D,0,this.format,g,x,0,this.format,D.UNSIGNED_BYTE,t.data);else{const{x:P,y:L}=h||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Ka(t)?D.texSubImage2D(D.TEXTURE_2D,0,P,L,D.RGBA,D.UNSIGNED_BYTE,t):D.texSubImage2D(D.TEXTURE_2D,0,P,L,g,x,D.RGBA,D.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&D.generateMipmap(D.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,a,h){const{context:g}=this,{gl:x}=g;x.bindTexture(x.TEXTURE_2D,this.texture),h!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=x.LINEAR),t!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,t),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,h||t),this.filter=t),a!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,a),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Pd{constructor(t,a,h,g=1,x=1,S=1,A=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void Wn(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const D=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=x,this.blueFactor=S,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<D;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(D,P)]=this.data[this._idx(D-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,D)]=this.data[this._idx(P,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<D;P++)for(let L=0;L<D;L++){const F=this.get(P,L);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(t,a){const h=new Uint8Array(this.data.buffer),g=4*this._idx(t,a);return this.unpack(h[g],h[g+1],h[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,h){return t*this.redFactor+a*this.greenFactor+h*this.blueFactor-this.baseShift}pack(t){return qi(t,this.getUnpackVector())}getPixels(){return new wa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,h){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let g=a*this.dim,x=a*this.dim+this.dim,S=h*this.dim,A=h*this.dim+this.dim;switch(a){case-1:g=x-1;break;case 1:x=g+1}switch(h){case-1:S=A-1;break;case 1:A=S+1}const D=-a*this.dim,P=-h*this.dim;for(let L=S;L<A;L++)for(let F=g;F<x;F++)this.data[this._idx(F,L)]=t.data[this._idx(F+D,L+P)]}}function qi(s,t){const a=t[0],h=t[1],g=t[2],x=t[3],S=Math.min(a,h,g),A=Math.round((s+x)/S);return{r:Math.floor(A*S/a)%256,g:Math.floor(A*S/h)%256,b:Math.floor(A*S/g)%256}}Ct("DEMData",Pd);class Rv extends Va{constructor(t,a){super(t,$_,a)}_createColorRamp(t){const a={elevationStops:[],colorStops:[]},h=this._transitionablePaint._values["color-relief-color"].value.expression;if(h instanceof yl&&h._styleExpression.expression instanceof zr){this.colorRampExpression=h;const S=h._styleExpression.expression;a.elevationStops=S.labels,a.colorStops=[];for(const A of a.elevationStops)a.colorStops.push(S.evaluate({globals:{elevation:A}}))}if(a.elevationStops.length<1&&(a.elevationStops=[0],a.colorStops=[gn.transparent]),a.elevationStops.length<2&&(a.elevationStops.push(a.elevationStops[0]+1),a.colorStops.push(a.colorStops[0])),a.elevationStops.length<=t)return a;const g={elevationStops:[],colorStops:[]},x=(a.elevationStops.length-1)/(t-1);for(let S=0;S<a.elevationStops.length-.5;S+=x)g.elevationStops.push(a.elevationStops[Math.round(S)]),g.colorStops.push(a.colorStops[Math.round(S)]);return Wn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),g}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,a,h){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const g=this._createColorRamp(a),x=new wa({width:g.colorStops.length,height:1}),S=new wa({width:g.colorStops.length,height:1});for(let A=0;A<g.elevationStops.length;A++){const D=qi(g.elevationStops[A],h);S.setPixel(0,A,new gn(D.r/255,D.g/255,D.b/255,1)),x.setPixel(0,A,g.colorStops[A])}return this.colorRampTextures={elevationTexture:new Id(t,S,t.gl.RGBA),colorTexture:new Id(t,x,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Iv=Ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:Y_}=Iv;function Mh(s,t,a){const h=a.patternDependencies;let g=!1;for(const x of t){const S=x.paint.get(`${s}-pattern`);S.isConstant()||(g=!0);const A=S.constantOr(null);A&&(g=!0,h[A.to]=!0,h[A.from]=!0)}return g}function Al(s,t,a,h,g){const{zoom:x}=h,S=g.patternDependencies;for(const A of t){const D=A.paint.get(`${s}-pattern`).value;if(D.kind!=="constant"){let P=D.evaluate({zoom:x-1},a,{},g.availableImages),L=D.evaluate({zoom:x},a,{},g.availableImages),F=D.evaluate({zoom:x+1},a,{},g.availableImages);P=P&&P.name?P.name:P,L=L&&L.name?L.name:L,F=F&&F.name?F.name:F,S[P]=!0,S[L]=!0,S[F]=!0,a.patterns[A.id]={min:P,mid:L,max:F}}}return a}function Og(s,t,a,h,g){let x;if(g===function(S,A,D,P){let L=0;for(let F=A,$=D-P;F<D;F+=P)L+=(S[$]-S[F])*(S[F+1]+S[$+1]),$=F;return L}(s,t,a,h)>0)for(let S=t;S<a;S+=h)x=Vg(S/h|0,s[S],s[S+1],x);else for(let S=a-h;S>=t;S-=h)x=Vg(S/h|0,s[S],s[S+1],x);return x&&Nd(x,x.next)&&(zd(x),x=x.next),x}function du(s,t){if(!s)return s;t||(t=s);let a,h=s;do if(a=!1,h.steiner||!Nd(h,h.next)&&Cn(h.prev,h,h.next)!==0)h=h.next;else{if(zd(h),h=t=h.prev,h===h.next)break;a=!0}while(a||h!==t);return t}function gc(s,t,a,h,g,x,S){if(!s)return;!S&&x&&function(D,P,L,F){let $=D;do $.z===0&&($.z=um($.x,$.y,P,L,F)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==D);$.prevZ.nextZ=null,$.prevZ=null,function(H){let X,ee=1;do{let se,de=H;H=null;let ke=null;for(X=0;de;){X++;let ve=de,Se=0;for(let Qe=0;Qe<ee&&(Se++,ve=ve.nextZ,ve);Qe++);let Be=ee;for(;Se>0||Be>0&&ve;)Se!==0&&(Be===0||!ve||de.z<=ve.z)?(se=de,de=de.nextZ,Se--):(se=ve,ve=ve.nextZ,Be--),ke?ke.nextZ=se:H=se,se.prevZ=ke,ke=se;de=ve}ke.nextZ=null,ee*=2}while(X>1)}($)}(s,h,g,x);let A=s;for(;s.prev!==s.next;){const D=s.prev,P=s.next;if(x?q_(s,h,g,x):Ml(s))t.push(D.i,s.i,P.i),zd(s),s=P.next,A=P.next;else if((s=P)===A){S?S===1?gc(s=jg(du(s),t),t,a,h,g,x,2):S===2&&H_(s,t,a,h,g,x):gc(du(s),t,a,h,g,x,1);break}}}function Ml(s){const t=s.prev,a=s,h=s.next;if(Cn(t,a,h)>=0)return!1;const g=t.x,x=a.x,S=h.x,A=t.y,D=a.y,P=h.y,L=Math.min(g,x,S),F=Math.min(A,D,P),$=Math.max(g,x,S),H=Math.max(A,D,P);let X=h.next;for(;X!==t;){if(X.x>=L&&X.x<=$&&X.y>=F&&X.y<=H&&Ch(g,A,x,D,S,P,X.x,X.y)&&Cn(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function q_(s,t,a,h){const g=s.prev,x=s,S=s.next;if(Cn(g,x,S)>=0)return!1;const A=g.x,D=x.x,P=S.x,L=g.y,F=x.y,$=S.y,H=Math.min(A,D,P),X=Math.min(L,F,$),ee=Math.max(A,D,P),se=Math.max(L,F,$),de=um(H,X,t,a,h),ke=um(ee,se,t,a,h);let ve=s.prevZ,Se=s.nextZ;for(;ve&&ve.z>=de&&Se&&Se.z<=ke;){if(ve.x>=H&&ve.x<=ee&&ve.y>=X&&ve.y<=se&&ve!==g&&ve!==S&&Ch(A,L,D,F,P,$,ve.x,ve.y)&&Cn(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Se.x>=H&&Se.x<=ee&&Se.y>=X&&Se.y<=se&&Se!==g&&Se!==S&&Ch(A,L,D,F,P,$,Se.x,Se.y)&&Cn(Se.prev,Se,Se.next)>=0))return!1;Se=Se.nextZ}for(;ve&&ve.z>=de;){if(ve.x>=H&&ve.x<=ee&&ve.y>=X&&ve.y<=se&&ve!==g&&ve!==S&&Ch(A,L,D,F,P,$,ve.x,ve.y)&&Cn(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Se&&Se.z<=ke;){if(Se.x>=H&&Se.x<=ee&&Se.y>=X&&Se.y<=se&&Se!==g&&Se!==S&&Ch(A,L,D,F,P,$,Se.x,Se.y)&&Cn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.nextZ}return!0}function jg(s,t){let a=s;do{const h=a.prev,g=a.next.next;!Nd(h,g)&&Ug(h,a,a.next,g)&&Jr(h,g)&&Jr(g,h)&&(t.push(h.i,a.i,g.i),zd(a),zd(a.next),a=s=g),a=a.next}while(a!==s);return du(a)}function H_(s,t,a,h,g,x){let S=s;do{let A=S.next.next;for(;A!==S.prev;){if(S.i!==A.i&&X_(S,A)){let D=Cl(S,A);return S=du(S,S.next),D=du(D,D.next),gc(S,t,a,h,g,x,0),void gc(D,t,a,h,g,x,0)}A=A.next}S=S.next}while(S!==s)}function Bg(s,t){let a=s.x-t.x;return a===0&&(a=s.y-t.y,a===0)&&(a=(s.next.y-s.y)/(s.next.x-s.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function Fg(s,t){const a=function(g,x){let S=x;const A=g.x,D=g.y;let P,L=-1/0;if(Nd(g,S))return S;do{if(Nd(g,S.next))return S.next;if(D<=S.y&&D>=S.next.y&&S.next.y!==S.y){const ee=S.x+(D-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(ee<=A&&ee>L&&(L=ee,P=S.x<S.next.x?S:S.next,ee===A))return P}S=S.next}while(S!==x);if(!P)return null;const F=P,$=P.x,H=P.y;let X=1/0;S=P;do{if(A>=S.x&&S.x>=$&&A!==S.x&&ur(D<H?A:L,D,$,H,D<H?L:A,D,S.x,S.y)){const ee=Math.abs(D-S.y)/(A-S.x);Jr(S,g)&&(ee<X||ee===X&&(S.x>P.x||S.x===P.x&&cm(P,S)))&&(P=S,X=ee)}S=S.next}while(S!==F);return P}(s,t);if(!a)return t;const h=Cl(a,s);return du(h,h.next),du(a,a.next)}function cm(s,t){return Cn(s.prev,s,t.prev)<0&&Cn(t.next,s,s.next)<0}function um(s,t,a,h,g){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-h)*g|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function yc(s){let t=s,a=s;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==s);return a}function ur(s,t,a,h,g,x,S,A){return(g-S)*(t-A)>=(s-S)*(x-A)&&(s-S)*(h-A)>=(a-S)*(t-A)&&(a-S)*(x-A)>=(g-S)*(h-A)}function Ch(s,t,a,h,g,x,S,A){return!(s===S&&t===A)&&ur(s,t,a,h,g,x,S,A)}function X_(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!function(a,h){let g=a;do{if(g.i!==a.i&&g.next.i!==a.i&&g.i!==h.i&&g.next.i!==h.i&&Ug(g,g.next,a,h))return!0;g=g.next}while(g!==a);return!1}(s,t)&&(Jr(s,t)&&Jr(t,s)&&function(a,h){let g=a,x=!1;const S=(a.x+h.x)/2,A=(a.y+h.y)/2;do g.y>A!=g.next.y>A&&g.next.y!==g.y&&S<(g.next.x-g.x)*(A-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==a);return x}(s,t)&&(Cn(s.prev,s,t.prev)||Cn(s,t.prev,t))||Nd(s,t)&&Cn(s.prev,s,s.next)>0&&Cn(t.prev,t,t.next)>0)}function Cn(s,t,a){return(t.y-s.y)*(a.x-t.x)-(t.x-s.x)*(a.y-t.y)}function Nd(s,t){return s.x===t.x&&s.y===t.y}function Ug(s,t,a,h){const g=Di(Cn(s,t,a)),x=Di(Cn(s,t,h)),S=Di(Cn(a,h,s)),A=Di(Cn(a,h,t));return g!==x&&S!==A||!(g!==0||!Uf(s,a,t))||!(x!==0||!Uf(s,h,t))||!(S!==0||!Uf(a,s,h))||!(A!==0||!Uf(a,t,h))}function Uf(s,t,a){return t.x<=Math.max(s.x,a.x)&&t.x>=Math.min(s.x,a.x)&&t.y<=Math.max(s.y,a.y)&&t.y>=Math.min(s.y,a.y)}function Di(s){return s>0?1:s<0?-1:0}function Jr(s,t){return Cn(s.prev,s,s.next)<0?Cn(s,t,s.next)>=0&&Cn(s,s.prev,t)>=0:Cn(s,t,s.prev)<0||Cn(s,s.next,t)<0}function Cl(s,t){const a=Gg(s.i,s.x,s.y),h=Gg(t.i,t.x,t.y),g=s.next,x=t.prev;return s.next=t,t.prev=s,a.next=g,g.prev=a,h.next=a,a.prev=h,x.next=h,h.prev=x,h}function Vg(s,t,a,h){const g=Gg(s,t,a);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function zd(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Gg(s,t,a){return{i:s,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class fu{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Ta{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Ta.noSubdivision=new Ta({fill:new fu(0,0),line:new fu(0,0),tile:new fu(0,0),stencil:new fu(0,0),circle:1}),Ct("SubdivisionGranularityExpression",fu),Ct("SubdivisionGranularitySetting",Ta);const Sa=-32768,Ld=32767;class zs{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=It/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|a+32768}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const h=0|Math.round(t),g=0|Math.round(a),x=this._getKey(h,g);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,S),this._vertexBuffer.push(h,g),S}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(g,x){const S=[];for(let A=0;A<x.length;A+=3){const D=x[A],P=x[A+1],L=x[A+2],F=g[2*D],$=g[2*D+1];(g[2*P]-F)*(g[2*L+1]-$)-(g[2*P+1]-$)*(g[2*L]-F)>0?(S.push(D),S.push(L),S.push(P)):(S.push(D),S.push(P),S.push(L))}return S}(this._vertexBuffer,t);const a=[],h=t.length;for(let g=0;g<h;g+=3){const x=[t[g+0],t[g+1],t[g+2]],S=[this._vertexBuffer[2*t[g+0]+0],this._vertexBuffer[2*t[g+0]+1],this._vertexBuffer[2*t[g+1]+0],this._vertexBuffer[2*t[g+1]+1],this._vertexBuffer[2*t[g+2]+0],this._vertexBuffer[2*t[g+2]+1]];let A=1/0,D=1/0,P=-1/0,L=-1/0;for(let ee=0;ee<3;ee++){const se=S[2*ee],de=S[2*ee+1];A=Math.min(A,se),P=Math.max(P,se),D=Math.min(D,de),L=Math.max(L,de)}if(A===P||D===L)continue;const F=Math.floor(A/this._granularityCellSize),$=Math.ceil(P/this._granularityCellSize),H=Math.floor(D/this._granularityCellSize),X=Math.ceil(L/this._granularityCellSize);if(F!==$||H!==X)for(let ee=H;ee<X;ee++){const se=this._scanlineGenerateVertexRingForCellRow(ee,S,x);Dh(this._vertexBuffer,se,a)}else a.push(...x)}return a}_scanlineGenerateVertexRingForCellRow(t,a,h){const g=t*this._granularityCellSize,x=g+this._granularityCellSize,S=[];for(let A=0;A<3;A++){const D=a[2*A],P=a[2*A+1],L=a[2*(A+1)%6],F=a[(2*(A+1)+1)%6],$=a[2*(A+2)%6],H=a[(2*(A+2)+1)%6],X=L-D,ee=F-P,se=X===0,de=ee===0,ke=(g-P)/ee,ve=(x-P)/ee,Se=Math.min(ke,ve),Be=Math.max(ke,ve);if(!de&&(Se>=1||Be<=0)||de&&(P<g||P>x)){F>=g&&F<=x&&S.push(h[(A+1)%3]);continue}!de&&Se>0&&S.push(this._vertexToIndex(D+X*Se,P+ee*Se));const Qe=D+X*Math.max(Se,0),lt=D+X*Math.min(Be,1);se||this._generateIntraEdgeVertices(S,D,P,L,F,Qe,lt),!de&&Be<1&&S.push(this._vertexToIndex(D+X*Be,P+ee*Be)),(de||F>=g&&F<=x)&&S.push(h[(A+1)%3]),!de&&(F<=g||F>=x)&&this._generateInterEdgeVertices(S,D,P,L,F,$,H,lt,g,x)}return S}_generateIntraEdgeVertices(t,a,h,g,x,S,A){const D=g-a,P=x-h,L=P===0,F=L?Math.min(a,g):Math.min(S,A),$=L?Math.max(a,g):Math.max(S,A),H=Math.floor(F/this._granularityCellSize)+1,X=Math.ceil($/this._granularityCellSize)-1;if(L?a<g:S<A)for(let ee=H;ee<=X;ee++){const se=ee*this._granularityCellSize;t.push(this._vertexToIndex(se,h+P*(se-a)/D))}else for(let ee=X;ee>=H;ee--){const se=ee*this._granularityCellSize;t.push(this._vertexToIndex(se,h+P*(se-a)/D))}}_generateInterEdgeVertices(t,a,h,g,x,S,A,D,P,L){const F=x-h,$=S-g,H=A-x,X=(P-x)/H,ee=(L-x)/H,se=Math.min(X,ee),de=Math.max(X,ee),ke=g+$*se;let ve=Math.floor(Math.min(ke,D)/this._granularityCellSize)+1,Se=Math.ceil(Math.max(ke,D)/this._granularityCellSize)-1,Be=D<ke;const Qe=H===0;if(Qe&&(A===P||A===L))return;if(Qe||se>=1||de<=0){const Tt=h-A,mt=S+(a-S)*Math.min((P-A)/Tt,(L-A)/Tt);ve=Math.floor(Math.min(mt,D)/this._granularityCellSize)+1,Se=Math.ceil(Math.max(mt,D)/this._granularityCellSize)-1,Be=D<mt}const lt=F>0?L:P;if(Be)for(let Tt=ve;Tt<=Se;Tt++)t.push(this._vertexToIndex(Tt*this._granularityCellSize,lt));else for(let Tt=Se;Tt>=ve;Tt--)t.push(this._vertexToIndex(Tt*this._granularityCellSize,lt))}_generateOutline(t){const a=[];for(const h of t){const g=ds(h,this._granularity,!0),x=this._pointArrayToIndices(g),S=[];for(let A=1;A<x.length;A++)S.push(x[A-1]),S.push(x[A]);a.push(S)}return a}_handlePoles(t){let a=!1,h=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(h=!0)),(a||h)&&this._fillPoles(t,a,h)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const h=t[a+1];h===Sa&&(t[a+1]=-32767),h===Ld&&(t[a+1]=32766)}}_generatePoleQuad(t,a,h,g,x,S){g>x!=(S===Sa)?(t.push(a),t.push(h),t.push(this._vertexToIndex(g,S)),t.push(h),t.push(this._vertexToIndex(x,S)),t.push(this._vertexToIndex(g,S))):(t.push(h),t.push(a),t.push(this._vertexToIndex(g,S)),t.push(this._vertexToIndex(x,S)),t.push(h),t.push(this._vertexToIndex(g,S)))}_fillPoles(t,a,h){const g=this._vertexBuffer,x=It,S=t.length;for(let A=2;A<S;A+=3){const D=t[A-2],P=t[A-1],L=t[A],F=g[2*D],$=g[2*D+1],H=g[2*P],X=g[2*P+1],ee=g[2*L],se=g[2*L+1];a&&($===0&&X===0&&this._generatePoleQuad(t,D,P,F,H,Sa),X===0&&se===0&&this._generatePoleQuad(t,P,L,H,ee,Sa),se===0&&$===0&&this._generatePoleQuad(t,L,D,ee,F,Sa)),h&&($===x&&X===x&&this._generatePoleQuad(t,D,P,F,H,Ld),X===x&&se===x&&this._generatePoleQuad(t,P,L,H,ee,Ld),se===x&&$===x&&this._generatePoleQuad(t,L,D,ee,F,Ld))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:h,holeIndices:g}=function(A){const D=[],P=[];for(const L of A)if(L.length!==0){L!==A[0]&&D.push(P.length/2);for(let F=0;F<L.length;F++)P.push(L[F].x),P.push(L[F].y)}return{flattened:P,holeIndices:D}}(t);let x;this._initializeVertices(h);try{const A=function(P,L,F=2){const $=L&&L.length,H=$?L[0]*F:P.length;let X=Og(P,0,H,F,!0);const ee=[];if(!X||X.next===X.prev)return ee;let se,de,ke;if($&&(X=function(ve,Se,Be,Qe){const lt=[];for(let Tt=0,mt=Se.length;Tt<mt;Tt++){const wt=Og(ve,Se[Tt]*Qe,Tt<mt-1?Se[Tt+1]*Qe:ve.length,Qe,!1);wt===wt.next&&(wt.steiner=!0),lt.push(yc(wt))}lt.sort(Bg);for(let Tt=0;Tt<lt.length;Tt++)Be=Fg(lt[Tt],Be);return Be}(P,L,X,F)),P.length>80*F){se=P[0],de=P[1];let ve=se,Se=de;for(let Be=F;Be<H;Be+=F){const Qe=P[Be],lt=P[Be+1];Qe<se&&(se=Qe),lt<de&&(de=lt),Qe>ve&&(ve=Qe),lt>Se&&(Se=lt)}ke=Math.max(ve-se,Se-de),ke=ke!==0?32767/ke:0}return gc(X,ee,F,se,de,ke,0),ee}(h,g),D=this._convertIndices(h,A);x=this._subdivideTrianglesScanline(D)}catch(A){console.error(A)}let S=[];return a&&(S=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:S}}_convertIndices(t,a){const h=[];for(let g=0;g<a.length;g++)h.push(this._vertexToIndex(t[2*a[g]],t[2*a[g]+1]));return h}_pointArrayToIndices(t){const a=[];for(let h=0;h<t.length;h++){const g=t[h];a.push(this._vertexToIndex(g.x,g.y))}return a}}function Zg(s,t,a,h=!0){return new zs(a,t).subdividePolygonInternal(s,h)}function ds(s,t,a=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const h=s[0],g=s[s.length-1],x=a&&(h.x!==g.x||h.y!==g.y);if(t<2)return x?[...s,s[0]]:[...s];const S=Math.floor(It/t),A=[];A.push(new C(s[0].x,s[0].y));const D=s.length,P=x?D:D-1;for(let L=0;L<P;L++){const F=s[L],$=L<D-1?s[L+1]:s[0],H=F.x,X=F.y,ee=$.x,se=$.y,de=H!==ee,ke=X!==se;if(!de&&!ke)continue;const ve=ee-H,Se=se-X,Be=Math.abs(ve),Qe=Math.abs(Se);let lt=H,Tt=X;for(;;){const wt=ve>0?(Math.floor(lt/S)+1)*S:(Math.ceil(lt/S)-1)*S,jt=Se>0?(Math.floor(Tt/S)+1)*S:(Math.ceil(Tt/S)-1)*S,xt=Math.abs(lt-wt),yt=Math.abs(Tt-jt),nt=Math.abs(lt-ee),Gt=Math.abs(Tt-se),Qt=de?xt/Be:Number.POSITIVE_INFINITY,Ft=ke?yt/Qe:Number.POSITIVE_INFINITY;if((nt<=xt||!de)&&(Gt<=yt||!ke))break;if(Qt<Ft&&de||!ke){lt=wt,Tt+=Se*Qt;const Nt=new C(lt,Math.round(Tt));A[A.length-1].x===Nt.x&&A[A.length-1].y===Nt.y||A.push(Nt)}else{lt+=ve*Ft,Tt=jt;const Nt=new C(Math.round(lt),Tt);A[A.length-1].x===Nt.x&&A[A.length-1].y===Nt.y||A.push(Nt)}}const mt=new C(ee,se);A[A.length-1].x===mt.x&&A[A.length-1].y===mt.y||A.push(mt)}return A}function Dh(s,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let h=0,g=s[2*t[0]];for(let D=1;D<t.length;D++){const P=s[2*t[D]];P<g&&(g=P,h=D)}const x=t.length;let S=h,A=(S+1)%x;for(;;){const D=S-1>=0?S-1:x-1,P=(A+1)%x,L=s[2*t[D]],F=s[2*t[P]],$=s[2*t[S]],H=s[2*t[S]+1],X=s[2*t[A]+1];let ee=!1;if(L<F)ee=!0;else if(L>F)ee=!1;else{const se=X-H,de=-(s[2*t[A]]-$),ke=H<X?1:-1;((L-$)*se+(s[2*t[D]+1]-H)*de)*ke>((F-$)*se+(s[2*t[P]+1]-H)*de)*ke&&(ee=!0)}if(ee){const se=t[D],de=t[S],ke=t[A];se!==de&&se!==ke&&de!==ke&&a.push(ke,de,se),S--,S<0&&(S=x-1)}else{const se=t[P],de=t[S],ke=t[A];se!==de&&se!==ke&&de!==ke&&a.push(ke,de,se),A++,A>=x&&(A=0)}if(D===P)break}}function _c(s,t,a,h,g,x,S,A,D){const P=g.length/2,L=S&&A&&D;if(P<on.MAX_VERTEX_ARRAY_LENGTH){const F=t.prepareSegment(P,a,h),$=F.vertexLength;for(let ee=0;ee<x.length;ee+=3)h.emplaceBack($+x[ee],$+x[ee+1],$+x[ee+2]);let H,X;F.vertexLength+=P,F.primitiveLength+=x.length/3,L&&(X=S.prepareSegment(P,a,A),H=X.vertexLength,X.vertexLength+=P);for(let ee=0;ee<g.length;ee+=2)s(g[ee],g[ee+1]);if(L)for(let ee=0;ee<D.length;ee++){const se=D[ee];for(let de=1;de<se.length;de+=2)A.emplaceBack(H+se[de-1],H+se[de]);X.primitiveLength+=se.length/2}}else(function(F,$,H,X,ee,se){const de=[];for(let Qe=0;Qe<X.length/2;Qe++)de.push(-1);const ke={count:0};let ve=0,Se=F.getOrCreateLatestSegment($,H),Be=Se.vertexLength;for(let Qe=2;Qe<ee.length;Qe+=3){const lt=ee[Qe-2],Tt=ee[Qe-1],mt=ee[Qe];let wt=de[lt]<ve,jt=de[Tt]<ve,xt=de[mt]<ve;Se.vertexLength+((wt?1:0)+(jt?1:0)+(xt?1:0))>on.MAX_VERTEX_ARRAY_LENGTH&&(Se=F.createNewSegment($,H),ve=ke.count,wt=!0,jt=!0,xt=!0,Be=0);const yt=kh(de,X,se,ke,lt,wt,Se),nt=kh(de,X,se,ke,Tt,jt,Se),Gt=kh(de,X,se,ke,mt,xt,Se);H.emplaceBack(Be+yt-ve,Be+nt-ve,Be+Gt-ve),Se.primitiveLength++}})(t,a,h,g,x,s),L&&function(F,$,H,X,ee,se){const de=[];for(let Qe=0;Qe<X.length/2;Qe++)de.push(-1);const ke={count:0};let ve=0,Se=F.getOrCreateLatestSegment($,H),Be=Se.vertexLength;for(let Qe=0;Qe<ee.length;Qe++){const lt=ee[Qe];for(let Tt=1;Tt<ee[Qe].length;Tt+=2){const mt=lt[Tt-1],wt=lt[Tt];let jt=de[mt]<ve,xt=de[wt]<ve;Se.vertexLength+((jt?1:0)+(xt?1:0))>on.MAX_VERTEX_ARRAY_LENGTH&&(Se=F.createNewSegment($,H),ve=ke.count,jt=!0,xt=!0,Be=0);const yt=kh(de,X,se,ke,mt,jt,Se),nt=kh(de,X,se,ke,wt,xt,Se);H.emplaceBack(Be+yt-ve,Be+nt-ve),Se.primitiveLength++}}}(S,a,A,g,D,s),t.forceNewSegmentOnNextPrepare(),S?.forceNewSegmentOnNextPrepare()}function kh(s,t,a,h,g,x,S){if(x){const A=h.count;return a(t[2*g],t[2*g+1]),s[g]=h.count,h.count++,S.vertexLength++,A}return s[g]}class Vf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Le,this.indexArray=new Fn,this.indexArray2=new _i,this.programConfigurations=new pa(t.layers,t.zoom),this.segments=new on,this.segments2=new on,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=Mh("fill",this.layers,a);const g=this.layers[0].layout.get("fill-sort-key"),x=!g.isConstant(),S=[];for(const{feature:A,id:D,index:P,sourceLayerIndex:L}of t){const F=this.layers[0]._featureFilter.needGeometry,$=pc(A,F);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),$,h))continue;const H=x?g.evaluate($,{},h,a.availableImages):void 0,X={id:D,properties:A.properties,type:A.type,sourceLayerIndex:L,index:P,geometry:F?$.geometry:hs(A),patterns:{},sortKey:H};S.push(X)}x&&S.sort((A,D)=>A.sortKey-D.sortKey);for(const A of S){const{geometry:D,index:P,sourceLayerIndex:L}=A;if(this.hasPattern){const F=Al("fill",this.layers,A,{zoom:this.zoom},a);this.patternFeatures.push(F)}else this.addFeature(A,D,P,h,{},a.subdivisionGranularity);a.featureIndex.insert(t[P].feature,D,P,L,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h})}addFeatures(t,a,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,a,h,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Y_),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,h,g,x,S){for(const A of Yc(a,500)){const D=Zg(A,g,S.fill.getGranularityForZoomLevel(g.z)),P=this.layoutVertexArray;_c((L,F)=>{P.emplaceBack(L,F)},this.segments,this.layoutVertexArray,this.indexArray,D.verticesFlattened,D.indicesTriangles,this.segments2,this.indexArray2,D.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:x,canonical:g})}}let Wo,$g;Ct("FillBucket",Vf,{omit:["layers","patternFeatures"]});var Od={get paint(){return $g=$g||new Ln({"fill-antialias":new zt(Pe.paint_fill["fill-antialias"]),"fill-opacity":new $t(Pe.paint_fill["fill-opacity"]),"fill-color":new $t(Pe.paint_fill["fill-color"]),"fill-outline-color":new $t(Pe.paint_fill["fill-outline-color"]),"fill-translate":new zt(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ua(Pe.paint_fill["fill-pattern"])})},get layout(){return Wo=Wo||new Ln({"fill-sort-key":new $t(Pe.layout_fill["fill-sort-key"])})}};class Gf extends Va{constructor(t,a){super(t,Od,a)}recalculate(t,a){super.recalculate(t,a);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Vf(t)}queryRadius(){return yr(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:h,pixelsToTileUnits:g}){return Ig(Er(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-h.bearingInRadians,g),a)}isTileClipped(){return!0}}const Zf=Ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),jd=Ei([{name:"a_centroid",components:2,type:"Int16"}],4),{members:W_}=Zf;class Rh{constructor(t,a,h,g,x){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=g,this._values=x,t.readFields($f,this,a)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const a=t.readVarint()+t.pos,h=[];let g,x=1,S=0,A=0,D=0;for(;t.pos<a;){if(S<=0){const P=t.readVarint();x=7&P,S=P>>3}if(S--,x===1||x===2)A+=t.readSVarint(),D+=t.readSVarint(),x===1&&(g&&h.push(g),g=[]),g&&g.push(new C(A,D));else{if(x!==7)throw new Error(`unknown command ${x}`);g&&g.push(g[0].clone())}}return g&&h.push(g),h}bbox(){const t=this._pbf;t.pos=this._geometry;const a=t.readVarint()+t.pos;let h=1,g=0,x=0,S=0,A=1/0,D=-1/0,P=1/0,L=-1/0;for(;t.pos<a;){if(g<=0){const F=t.readVarint();h=7&F,g=F>>3}if(g--,h===1||h===2)x+=t.readSVarint(),S+=t.readSVarint(),x<A&&(A=x),x>D&&(D=x),S<P&&(P=S),S>L&&(L=S);else if(h!==7)throw new Error(`unknown command ${h}`)}return[A,P,D,L]}toGeoJSON(t,a,h){const g=this.extent*Math.pow(2,h),x=this.extent*t,S=this.extent*a,A=this.loadGeometry();function D($){return[360*($.x+x)/g-180,360/Math.PI*Math.atan(Math.exp((1-2*($.y+S)/g)*Math.PI))-90]}function P($){return $.map(D)}let L;if(this.type===1){const $=[];for(const X of A)$.push(X[0]);const H=P($);L=$.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const $=A.map(P);L=$.length===1?{type:"LineString",coordinates:$[0]}:{type:"MultiLineString",coordinates:$}}else{if(this.type!==3)throw new Error("unknown feature type");{const $=function(X){const ee=X.length;if(ee<=1)return[X];const se=[];let de,ke;for(let ve=0;ve<ee;ve++){const Se=Q_(X[ve]);Se!==0&&(ke===void 0&&(ke=Se<0),ke===Se<0?(de&&se.push(de),de=[X[ve]]):de&&de.push(X[ve]))}return de&&se.push(de),se}(A),H=[];for(const X of $)H.push(X.map(P));L=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const F={type:"Feature",geometry:L,properties:this.properties};return this.id!=null&&(F.id=this.id),F}}function $f(s,t,a){s===1?t.id=a.readVarint():s===2?function(h,g){const x=h.readVarint()+h.pos;for(;h.pos<x;){const S=g._keys[h.readVarint()],A=g._values[h.readVarint()];g.properties[S]=A}}(a,t):s===3?t.type=a.readVarint():s===4&&(t._geometry=a.pos)}function Q_(s){let t=0;for(let a,h,g=0,x=s.length,S=x-1;g<x;S=g++)a=s[g],h=s[S],t+=(h.x-a.x)*(a.y+h.y);return t}Rh.types=["Unknown","Point","LineString","Polygon"];class Yf{constructor(t,a){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(K_,this,a),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const a=this._pbf.readVarint()+this._pbf.pos;return new Rh(this._pbf,a,this.extent,this._keys,this._values)}}function K_(s,t,a){s===15?t.version=a.readVarint():s===1?t.name=a.readString():s===5?t.extent=a.readVarint():s===2?t._features.push(a.pos):s===3?t._keys.push(a.readString()):s===4&&t._values.push(function(h){let g=null;const x=h.readVarint()+h.pos;for(;h.pos<x;){const S=h.readVarint()>>3;g=S===1?h.readString():S===2?h.readFloat():S===3?h.readDouble():S===4?h.readVarint64():S===5?h.readVarint():S===6?h.readSVarint():S===7?h.readBoolean():null}if(g==null)throw new Error("unknown feature value");return g}(a))}class J_{constructor(t,a){this.layers=t.readFields(Pv,{},a)}}function Pv(s,t,a){if(s===3){const h=new Yf(a,a.readVarint()+a.pos);h.length&&(t[h.name]=h)}}const ii=Math.pow(2,13);function li(s,t,a,h,g,x,S,A){s.emplaceBack(t,a,2*Math.floor(h*ii)+S,g*ii*2,x*ii*2,Math.round(A))}class Dn{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Oe,this.centroidVertexArray=new De,this.indexArray=new Fn,this.programConfigurations=new pa(t.layers,t.zoom),this.segments=new on,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.features=[],this.hasPattern=Mh("fill-extrusion",this.layers,a);for(const{feature:g,id:x,index:S,sourceLayerIndex:A}of t){const D=this.layers[0]._featureFilter.needGeometry,P=pc(g,D);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),P,h))continue;const L={id:x,sourceLayerIndex:A,index:S,geometry:D?P.geometry:hs(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Al("fill-extrusion",this.layers,L,{zoom:this.zoom},a)):this.addFeature(L,L.geometry,S,h,{},a.subdivisionGranularity),a.featureIndex.insert(g,L.geometry,S,A,this.index,!0)}}addFeatures(t,a,h){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,a,h,t.subdivisionGranularity)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,W_),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,jd.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,h,g,x,S){for(const A of Yc(a,500)){const D={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(D,g,t,A,S);const L=this.layoutVertexArray.length-P,F=Math.floor(D.x/D.sampleCount),$=Math.floor(D.y/D.sampleCount);for(let H=0;H<L;H++)this.centroidVertexArray.emplaceBack(F,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:x,canonical:g})}processPolygon(t,a,h,g,x){if(g.length<1||fs(g[0]))return;for(const F of g)F.length!==0&&Zn(t,F);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=x.fill.getGranularityForZoomLevel(a.z),D=Rh.types[h.type]==="Polygon";for(const F of g){if(F.length===0||fs(F))continue;const $=ds(F,A,D);this._generateSideFaces($,S)}if(!D)return;const P=Zg(g,a,A,!1),L=this.layoutVertexArray;_c((F,$)=>{li(L,F,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(t,a){let h=0;for(let g=1;g<t.length;g++){const x=t[g],S=t[g-1];if(hi(x,S))continue;a.segment.vertexLength+4>on.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=x.sub(S)._perp()._unit(),D=S.dist(x);h+D>32768&&(h=0),li(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,0,h),li(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,1,h),h+=D,li(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,0,h),li(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,1,h);const P=a.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function Zn(s,t){for(let a=0;a<t.length;a++){const h=t[a];a===t.length-1&&t[0].x===h.x&&t[0].y===h.y||(s.x+=h.x,s.y+=h.y,s.sampleCount++)}}function hi(s,t){return s.x===t.x&&(s.x<0||s.x>It)||s.y===t.y&&(s.y<0||s.y>It)}function fs(s){return s.every(t=>t.x<0)||s.every(t=>t.x>It)||s.every(t=>t.y<0)||s.every(t=>t.y>It)}let vc;Ct("FillExtrusionBucket",Dn,{omit:["layers","features"]});var Bd={get paint(){return vc=vc||new Ln({"fill-extrusion-opacity":new zt(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $t(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ua(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $t(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $t(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zt(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Yg extends Va{constructor(t,a){super(t,Bd,a)}createBucket(t){return new Dn(t)}queryRadius(){return yr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:x,pixelsToTileUnits:S,pixelPosMatrix:A}){const D=Er(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,S),P=this.paint.get("fill-extrusion-height").evaluate(a,h),L=this.paint.get("fill-extrusion-base").evaluate(a,h),F=function(H,X){const ee=[];for(const se of H){const de=[se.x,se.y,0,1];un(de,de,X),ee.push(new C(de[0]/de[3],de[1]/de[3]))}return ee}(D,A),$=function(H,X,ee,se){const de=[],ke=[],ve=se[8]*X,Se=se[9]*X,Be=se[10]*X,Qe=se[11]*X,lt=se[8]*ee,Tt=se[9]*ee,mt=se[10]*ee,wt=se[11]*ee;for(const jt of H){const xt=[],yt=[];for(const nt of jt){const Gt=nt.x,Qt=nt.y,Ft=se[0]*Gt+se[4]*Qt+se[12],Nt=se[1]*Gt+se[5]*Qt+se[13],En=se[2]*Gt+se[6]*Qt+se[14],Ni=se[3]*Gt+se[7]*Qt+se[15],Vi=En+Be,na=Ni+Qe,ys=Ft+lt,ia=Nt+Tt,Ar=En+mt,zi=Ni+wt,er=new C((Ft+ve)/na,(Nt+Se)/na);er.z=Vi/na,xt.push(er);const hr=new C(ys/zi,ia/zi);hr.z=Ar/zi,yt.push(hr)}de.push(xt),ke.push(yt)}return[de,ke]}(g,L,P,A);return function(H,X,ee){let se=1/0;Ig(ee,X)&&(se=Ji(ee,X[0]));for(let de=0;de<X.length;de++){const ke=X[de],ve=H[de];for(let Se=0;Se<ke.length-1;Se++){const Be=ke[Se],Qe=[Be,ke[Se+1],ve[Se+1],ve[Se],Be];hu(ee,Qe)&&(se=Math.min(se,Ji(ee,Qe)))}}return se!==1/0&&se}($[0],$[1],F)}}function Ls(s,t){return s.x*t.x+s.y*t.y}function Ji(s,t){if(s.length===1){let a=0;const h=t[a++];let g;for(;!g||h.equals(g);)if(g=t[a++],!g)return 1/0;for(;a<t.length;a++){const x=t[a],S=s[0],A=g.sub(h),D=x.sub(h),P=S.sub(h),L=Ls(A,A),F=Ls(A,D),$=Ls(D,D),H=Ls(P,A),X=Ls(P,D),ee=L*$-F*F,se=($*H-F*X)/ee,de=(L*X-F*H)/ee,ke=h.z*(1-se-de)+g.z*se+x.z*de;if(isFinite(ke))return ke}return 1/0}{let a=1/0;for(const h of t)a=Math.min(a,h.z);return a}}const pu=Ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ih}=pu,qg=Ei([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:vo}=qg,Fd=Math.cos(Math.PI/180*37.5),Ud=Math.pow(2,14)/.5;class Ea{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Ye,this.layoutVertexArray2=new vt,this.indexArray=new Fn,this.programConfigurations=new pa(t.layers,t.zoom),this.segments=new on,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=Mh("line",this.layers,a);const g=this.layers[0].layout.get("line-sort-key"),x=!g.isConstant(),S=[];for(const{feature:A,id:D,index:P,sourceLayerIndex:L}of t){const F=this.layers[0]._featureFilter.needGeometry,$=pc(A,F);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),$,h))continue;const H=x?g.evaluate($,{},h):void 0,X={id:D,properties:A.properties,type:A.type,sourceLayerIndex:L,index:P,geometry:F?$.geometry:hs(A),patterns:{},sortKey:H};S.push(X)}x&&S.sort((A,D)=>A.sortKey-D.sortKey);for(const A of S){const{geometry:D,index:P,sourceLayerIndex:L}=A;if(this.hasPattern){const F=Al("line",this.layers,A,{zoom:this.zoom},a);this.patternFeatures.push(F)}else this.addFeature(A,D,P,h,{},a.subdivisionGranularity);a.featureIndex.insert(t[P].feature,D,P,L,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h})}addFeatures(t,a,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,a,h,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,vo)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ih),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,h,g,x,S){const A=this.layers[0].layout,D=A.get("line-join").evaluate(t,{}),P=A.get("line-cap"),L=A.get("line-miter-limit"),F=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const $ of a)this.addLine($,t,D,P,L,F,g,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:x,canonical:g})}addLine(t,a,h,g,x,S,A,D){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=ds(t,A?D.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<t.length-1;ve++)this.totalDistance+=t[ve].dist(t[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=Rh.types[a.type]==="Polygon";let L=t.length;for(;L>=2&&t[L-1].equals(t[L-2]);)L--;let F=0;for(;F<L-1&&t[F].equals(t[F+1]);)F++;if(L<(P?3:2))return;h==="bevel"&&(x=1.05);const $=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let X,ee,se,de,ke;this.e1=this.e2=-1,P&&(X=t[L-2],ke=t[F].sub(X)._unit()._perp());for(let ve=F;ve<L;ve++){if(se=ve===L-1?P?t[F+1]:void 0:t[ve+1],se&&t[ve].equals(se))continue;ke&&(de=ke),X&&(ee=X),X=t[ve],ke=se?se.sub(X)._unit()._perp():de,de=de||ke;let Se=de.add(ke);Se.x===0&&Se.y===0||Se._unit();const Be=de.x*ke.x+de.y*ke.y,Qe=Se.x*ke.x+Se.y*ke.y,lt=Qe!==0?1/Qe:1/0,Tt=2*Math.sqrt(2-2*Qe),mt=Qe<Fd&&ee&&se,wt=de.x*ke.y-de.y*ke.x>0;if(mt&&ve>F){const yt=X.dist(ee);if(yt>2*$){const nt=X.sub(X.sub(ee)._mult($/yt)._round());this.updateDistance(ee,nt),this.addCurrentVertex(nt,de,0,0,H),ee=nt}}const jt=ee&&se;let xt=jt?h:P?"butt":g;if(jt&&xt==="round"&&(lt<S?xt="miter":lt<=2&&(xt="fakeround")),xt==="miter"&&lt>x&&(xt="bevel"),xt==="bevel"&&(lt>2&&(xt="flipbevel"),lt<x&&(xt="miter")),ee&&this.updateDistance(ee,X),xt==="miter")Se._mult(lt),this.addCurrentVertex(X,Se,0,0,H);else if(xt==="flipbevel"){if(lt>100)Se=ke.mult(-1);else{const yt=lt*de.add(ke).mag()/de.sub(ke).mag();Se._perp()._mult(yt*(wt?-1:1))}this.addCurrentVertex(X,Se,0,0,H),this.addCurrentVertex(X,Se.mult(-1),0,0,H)}else if(xt==="bevel"||xt==="fakeround"){const yt=-Math.sqrt(lt*lt-1),nt=wt?yt:0,Gt=wt?0:yt;if(ee&&this.addCurrentVertex(X,de,nt,Gt,H),xt==="fakeround"){const Qt=Math.round(180*Tt/Math.PI/20);for(let Ft=1;Ft<Qt;Ft++){let Nt=Ft/Qt;if(Nt!==.5){const Ni=Nt-.5;Nt+=Nt*Ni*(Nt-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*Ni*Ni+(.848013+Be*(.215638*Be-1.06021)))}const En=ke.sub(de)._mult(Nt)._add(de)._unit()._mult(wt?-1:1);this.addHalfVertex(X,En.x,En.y,!1,wt,0,H)}}se&&this.addCurrentVertex(X,ke,-nt,-Gt,H)}else if(xt==="butt")this.addCurrentVertex(X,Se,0,0,H);else if(xt==="square"){const yt=ee?1:-1;this.addCurrentVertex(X,Se,yt,yt,H)}else xt==="round"&&(ee&&(this.addCurrentVertex(X,de,0,0,H),this.addCurrentVertex(X,de,1,1,H,!0)),se&&(this.addCurrentVertex(X,ke,-1,-1,H,!0),this.addCurrentVertex(X,ke,0,0,H)));if(mt&&ve<L-1){const yt=X.dist(se);if(yt>2*$){const nt=X.add(se.sub(X)._mult($/yt)._round());this.updateDistance(X,nt),this.addCurrentVertex(nt,ke,0,0,H),X=nt}}}}addCurrentVertex(t,a,h,g,x,S=!1){const A=a.y*g-a.x,D=-a.y-a.x*g;this.addHalfVertex(t,a.x+a.y*h,a.y-a.x*h,S,!1,h,x),this.addHalfVertex(t,A,D,S,!0,-g,x),this.distance>Ud/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,h,g,x,S))}addHalfVertex({x:t,y:a},h,g,x,S,A,D){const P=.5*(this.lineClips?this.scaledDistance*(Ud-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(x?1:0),(a<<1)+(S?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(A===0?0:A<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,L,this.e2),D.primitiveLength++),S?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let hm,dm;Ct("LineBucket",Ea,{omit:["layers","patternFeatures"]});var qf={get paint(){return dm=dm||new Ln({"line-opacity":new $t(Pe.paint_line["line-opacity"]),"line-color":new $t(Pe.paint_line["line-color"]),"line-translate":new zt(Pe.paint_line["line-translate"]),"line-translate-anchor":new zt(Pe.paint_line["line-translate-anchor"]),"line-width":new $t(Pe.paint_line["line-width"]),"line-gap-width":new $t(Pe.paint_line["line-gap-width"]),"line-offset":new $t(Pe.paint_line["line-offset"]),"line-blur":new $t(Pe.paint_line["line-blur"]),"line-dasharray":new Tl(Pe.paint_line["line-dasharray"]),"line-pattern":new Ua(Pe.paint_line["line-pattern"]),"line-gradient":new Dd(Pe.paint_line["line-gradient"])})},get layout(){return hm=hm||new Ln({"line-cap":new zt(Pe.layout_line["line-cap"]),"line-join":new $t(Pe.layout_line["line-join"]),"line-miter-limit":new zt(Pe.layout_line["line-miter-limit"]),"line-round-limit":new zt(Pe.layout_line["line-round-limit"]),"line-sort-key":new $t(Pe.layout_line["line-sort-key"])})}};class fm extends $t{possiblyEvaluate(t,a){return a=new Hn(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,h,g){return a=fn({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,h,g)}}let Qo;class ma extends Va{constructor(t,a){super(t,qf,a),this.gradientVersion=0,Qo||(Qo=new fm(qf.paint.properties["line-width"].specification),Qo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(h){return h._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Zi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=Qo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ea(t)}queryRadius(t){const a=t,h=bc(Eh("line-width",this,a),Eh("line-gap-width",this,a)),g=Eh("line-offset",this,a);return h/2+Math.abs(g)+yr(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:x,pixelsToTileUnits:S}){const A=Er(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,S),D=S/2*bc(this.paint.get("line-width").evaluate(a,h),this.paint.get("line-gap-width").evaluate(a,h)),P=this.paint.get("line-offset").evaluate(a,h);return P&&(g=function(L,F){const $=[];for(let H=0;H<L.length;H++){const X=L[H],ee=[];for(let se=0;se<X.length;se++){const de=X[se-1],ke=X[se],ve=X[se+1],Se=se===0?new C(0,0):ke.sub(de)._unit()._perp(),Be=se===X.length-1?new C(0,0):ve.sub(ke)._unit()._perp(),Qe=Se._add(Be)._unit(),lt=Qe.x*Be.x+Qe.y*Be.y;lt!==0&&Qe._mult(1/lt),ee.push(Qe._mult(F)._add(ke))}$.push(ee)}return $}(g,P*S)),function(L,F,$){for(let H=0;H<F.length;H++){const X=F[H];if(L.length>=3){for(let ee=0;ee<X.length;ee++)if(Sh(L,X[ee]))return!0}if(O_(L,X,$))return!0}return!1}(A,g,D)}isTileClipped(){return!0}}function bc(s,t){return t>0?t+2*s:s}const Vd=Ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Gd=Ei([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Hg=Ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ei([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const pm=Ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),e0=Ei([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Hf(s,t,a){return s.sections.forEach(h=>{h.text=function(g,x,S){const A=x.layout.get("text-transform").evaluate(S,{});return A==="uppercase"?g=g.toLocaleUpperCase():A==="lowercase"&&(g=g.toLocaleLowerCase()),Wr.applyArabicShaping&&(g=Wr.applyArabicShaping(g)),g}(h.text,t,a)}),s}Ei([{name:"triangle",components:3,type:"Uint16"}]),Ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ei([{type:"Float32",name:"offsetX"}]),Ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ei([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ph={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Kn=24;const mm=4294967296,ps=1/mm,Xg=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class gm{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,a,h=this.length){for(;this.pos<h;){const g=this.readVarint(),x=g>>3,S=this.pos;this.type=7&g,t(x,a,this),this.pos===S&&this.skip(g)}return a}readMessage(t,a){return this.readFields(t,a,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*mm;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*mm;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const a=this.buf;let h,g;return g=a[this.pos++],h=127&g,g<128?h:(g=a[this.pos++],h|=(127&g)<<7,g<128?h:(g=a[this.pos++],h|=(127&g)<<14,g<128?h:(g=a[this.pos++],h|=(127&g)<<21,g<128?h:(g=a[this.pos],h|=(15&g)<<28,function(x,S,A){const D=A.buf;let P,L;if(L=D[A.pos++],P=(112&L)>>4,L<128||(L=D[A.pos++],P|=(127&L)<<3,L<128)||(L=D[A.pos++],P|=(127&L)<<10,L<128)||(L=D[A.pos++],P|=(127&L)<<17,L<128)||(L=D[A.pos++],P|=(127&L)<<24,L<128)||(L=D[A.pos++],P|=(1&L)<<31,L<128))return Zd(x,P,S);throw new Error("Expected varint not more than 10 bytes")}(h,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,a=this.pos;return this.pos=t,t-a>=12&&Xg?Xg.decode(this.buf.subarray(a,t)):function(h,g,x){let S="",A=g;for(;A<x;){const D=h[A];let P,L,F,$=null,H=D>239?4:D>223?3:D>191?2:1;if(A+H>x)break;H===1?D<128&&($=D):H===2?(P=h[A+1],(192&P)==128&&($=(31&D)<<6|63&P,$<=127&&($=null))):H===3?(P=h[A+1],L=h[A+2],(192&P)==128&&(192&L)==128&&($=(15&D)<<12|(63&P)<<6|63&L,($<=2047||$>=55296&&$<=57343)&&($=null))):H===4&&(P=h[A+1],L=h[A+2],F=h[A+3],(192&P)==128&&(192&L)==128&&(192&F)==128&&($=(15&D)<<18|(63&P)<<12|(63&L)<<6|63&F,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,H=1):$>65535&&($-=65536,S+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),S+=String.fromCharCode($),A+=H}return S}(this.buf,a,t)}readBytes(){const t=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,t);return this.pos=t,a}readPackedVarint(t=[],a){const h=this.readPackedEnd();for(;this.pos<h;)t.push(this.readVarint(a));return t}readPackedSVarint(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const a=7&t;if(a===0)for(;this.buf[this.pos++]>127;);else if(a===2)this.pos=this.readVarint()+this.pos;else if(a===5)this.pos+=4;else{if(a!==1)throw new Error(`Unimplemented type: ${a}`);this.pos+=8}}writeTag(t,a){this.writeVarint(t<<3|a)}realloc(t){let a=this.length||16;for(;a<this.pos+t;)a*=2;if(a!==this.length){const h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.dataView=new DataView(h.buffer),this.length=a}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*ps),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*ps),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?function(a,h){let g,x;if(a>=0?(g=a%4294967296|0,x=a/4294967296|0):(g=~(-a%4294967296),x=~(-a/4294967296),4294967295^g?g=g+1|0:(g=0,x=x+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(S,A,D){D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,D.buf[D.pos]=127&(S>>>=7)}(g,0,h),function(S,A){const D=(7&S)<<4;A.buf[A.pos++]|=D|((S>>>=3)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S)))))}(x,h)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const a=this.pos;this.pos=function(g,x,S){for(let A,D,P=0;P<x.length;P++){if(A=x.charCodeAt(P),A>55295&&A<57344){if(!D){A>56319||P+1===x.length?(g[S++]=239,g[S++]=191,g[S++]=189):D=A;continue}if(A<56320){g[S++]=239,g[S++]=191,g[S++]=189,D=A;continue}A=D-55296<<10|A-56320|65536,D=null}else D&&(g[S++]=239,g[S++]=191,g[S++]=189,D=null);A<128?g[S++]=A:(A<2048?g[S++]=A>>6|192:(A<65536?g[S++]=A>>12|224:(g[S++]=A>>18|240,g[S++]=A>>12&63|128),g[S++]=A>>6&63|128),g[S++]=63&A|128)}return S}(this.buf,t,this.pos);const h=this.pos-a;h>=128&&xc(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const a=t.length;this.writeVarint(a),this.realloc(a);for(let h=0;h<a;h++)this.buf[this.pos++]=t[h]}writeRawMessage(t,a){this.pos++;const h=this.pos;t(a,this);const g=this.pos-h;g>=128&&xc(h,g,this),this.pos=h-1,this.writeVarint(g),this.pos+=g}writeMessage(t,a,h){this.writeTag(t,2),this.writeRawMessage(a,h)}writePackedVarint(t,a){a.length&&this.writeMessage(t,ym,a)}writePackedSVarint(t,a){a.length&&this.writeMessage(t,Wg,a)}writePackedBoolean(t,a){a.length&&this.writeMessage(t,n0,a)}writePackedFloat(t,a){a.length&&this.writeMessage(t,$d,a)}writePackedDouble(t,a){a.length&&this.writeMessage(t,t0,a)}writePackedFixed32(t,a){a.length&&this.writeMessage(t,i0,a)}writePackedSFixed32(t,a){a.length&&this.writeMessage(t,Qg,a)}writePackedFixed64(t,a){a.length&&this.writeMessage(t,Kg,a)}writePackedSFixed64(t,a){a.length&&this.writeMessage(t,Nv,a)}writeBytesField(t,a){this.writeTag(t,2),this.writeBytes(a)}writeFixed32Field(t,a){this.writeTag(t,5),this.writeFixed32(a)}writeSFixed32Field(t,a){this.writeTag(t,5),this.writeSFixed32(a)}writeFixed64Field(t,a){this.writeTag(t,1),this.writeFixed64(a)}writeSFixed64Field(t,a){this.writeTag(t,1),this.writeSFixed64(a)}writeVarintField(t,a){this.writeTag(t,0),this.writeVarint(a)}writeSVarintField(t,a){this.writeTag(t,0),this.writeSVarint(a)}writeStringField(t,a){this.writeTag(t,2),this.writeString(a)}writeFloatField(t,a){this.writeTag(t,5),this.writeFloat(a)}writeDoubleField(t,a){this.writeTag(t,1),this.writeDouble(a)}writeBooleanField(t,a){this.writeVarintField(t,+a)}}function Zd(s,t,a){return a?4294967296*t+(s>>>0):4294967296*(t>>>0)+(s>>>0)}function xc(s,t,a){const h=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(h);for(let g=a.pos-1;g>=s;g--)a.buf[g+h]=a.buf[g]}function ym(s,t){for(let a=0;a<s.length;a++)t.writeVarint(s[a])}function Wg(s,t){for(let a=0;a<s.length;a++)t.writeSVarint(s[a])}function $d(s,t){for(let a=0;a<s.length;a++)t.writeFloat(s[a])}function t0(s,t){for(let a=0;a<s.length;a++)t.writeDouble(s[a])}function n0(s,t){for(let a=0;a<s.length;a++)t.writeBoolean(s[a])}function i0(s,t){for(let a=0;a<s.length;a++)t.writeFixed32(s[a])}function Qg(s,t){for(let a=0;a<s.length;a++)t.writeSFixed32(s[a])}function Kg(s,t){for(let a=0;a<s.length;a++)t.writeFixed64(s[a])}function Nv(s,t){for(let a=0;a<s.length;a++)t.writeSFixed64(s[a])}function zv(s,t,a){s===1&&a.readMessage(Lv,t)}function Lv(s,t,a){if(s===3){const{id:h,bitmap:g,width:x,height:S,left:A,top:D,advance:P}=a.readMessage(r0,{});t.push({id:h,bitmap:new Ah({width:x+6,height:S+6},g),metrics:{width:x,height:S,left:A,top:D,advance:P}})}}function r0(s,t,a){s===1?t.id=a.readVarint():s===2?t.bitmap=a.readBytes():s===3?t.width=a.readVarint():s===4?t.height=a.readVarint():s===5?t.left=a.readSVarint():s===6?t.top=a.readSVarint():s===7&&(t.advance=a.readVarint())}function Jg(s){let t=0,a=0;for(const S of s)t+=S.w*S.h,a=Math.max(a,S.w);s.sort((S,A)=>A.h-S.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let g=0,x=0;for(const S of s)for(let A=h.length-1;A>=0;A--){const D=h[A];if(!(S.w>D.w||S.h>D.h)){if(S.x=D.x,S.y=D.y,x=Math.max(x,S.y+S.h),g=Math.max(g,S.x+S.w),S.w===D.w&&S.h===D.h){const P=h.pop();P&&A<h.length&&(h[A]=P)}else S.h===D.h?(D.x+=S.w,D.w-=S.w):S.w===D.w?(D.y+=S.h,D.h-=S.h):(h.push({x:D.x+S.w,y:D.y,w:D.w-S.w,h:S.h}),D.y+=S.h,D.h-=S.h);break}}return{w:g,h:x,fill:t/(g*x)||0}}class mu{constructor(t,{pixelRatio:a,version:h,stretchX:g,stretchY:x,content:S,textFitWidth:A,textFitHeight:D}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=g,this.stretchY=x,this.content=S,this.version=h,this.textFitWidth=A,this.textFitHeight=D}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Xf{constructor(t,a){const h={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(t,h,x),this.addImages(a,g,x);const{w:S,h:A}=Jg(x),D=new wa({width:S||1,height:A||1});for(const P in t){const L=t[P],F=h[P].paddedRect;wa.copy(L.data,D,{x:0,y:0},{x:F.x+1,y:F.y+1},L.data)}for(const P in a){const L=a[P],F=g[P].paddedRect,$=F.x+1,H=F.y+1,X=L.data.width,ee=L.data.height;wa.copy(L.data,D,{x:0,y:0},{x:$,y:H},L.data),wa.copy(L.data,D,{x:0,y:ee-1},{x:$,y:H-1},{width:X,height:1}),wa.copy(L.data,D,{x:0,y:0},{x:$,y:H+ee},{width:X,height:1}),wa.copy(L.data,D,{x:X-1,y:0},{x:$-1,y:H},{width:1,height:ee}),wa.copy(L.data,D,{x:0,y:0},{x:$+X,y:H},{width:1,height:ee})}this.image=D,this.iconPositions=h,this.patternPositions=g}addImages(t,a,h){for(const g in t){const x=t[g],S={x:0,y:0,w:x.data.width+2,h:x.data.height+2};h.push(S),a[g]=new mu(S,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in t.updatedImages)this.patchUpdatedImage(this.iconPositions[h],t.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],t.getImage(h),a)}patchUpdatedImage(t,a,h){if(!t||!a||t.version===a.version)return;t.version=a.version;const[g,x]=t.tl;h.update(a.data,void 0,{x:g,y:x})}}var wc;Ct("ImagePosition",mu),Ct("ImageAtlas",Xf),v.ao=void 0,(wc=v.ao||(v.ao={}))[wc.none=0]="none",wc[wc.horizontal=1]="horizontal",wc[wc.vertical=2]="vertical",wc[wc.horizontalOnly=3]="horizontalOnly";class Yd{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,h){const g=new Yd;return g.scale=t||1,g.fontStack=a,g.verticalAlign=h||"bottom",g}static forImage(t,a){const h=new Yd;return h.imageName=t,h.verticalAlign=a||"bottom",h}}class Nh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const h=new Nh;for(let g=0;g<t.sections.length;g++){const x=t.sections[g];x.image?h.addImageSection(x):h.addTextSection(x,a)}return h}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let h=0;h<t.length;h++){const g=t.charCodeAt(h+1)||null,x=t.charCodeAt(h-1)||null;a+=g&&Md(g)&&!Ph[t[h+1]]||x&&Md(x)&&!Ph[t[h-1]]||!Ph[t[h]]?t[h]:Ph[t[h]]}return a}(this.text)}trim(){let t=0;for(let h=0;h<this.text.length&&Qf[this.text.charCodeAt(h)];h++)t++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=t&&Qf[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const h=new Nh;return h.text=this.text.substring(t,a),h.sectionIndex=this.sectionIndex.slice(t,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}getMaxImageSize(t){let a=0,h=0;for(let g=0;g<this.length();g++){const x=this.getSection(g);if(x.imageName){const S=t[x.imageName];if(!S)continue;const A=S.displaySize;a=Math.max(a,A[0]),h=Math.max(h,A[1])}}return{maxImageWidth:a,maxImageHeight:h}}addTextSection(t,a){this.text+=t.text,this.sections.push(Yd.forText(t.scale,t.fontStack||a,t.verticalAlign));const h=this.sections.length-1;for(let g=0;g<t.text.length;++g)this.sectionIndex.push(h)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void Wn("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Yd.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Wn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Wf(s,t,a,h,g,x,S,A,D,P,L,F,$,H,X){const ee=Nh.fromFeature(s,g);let se;F===v.ao.vertical&&ee.verticalizePunctuation();const{processBidirectionalText:de,processStyledBidirectionalText:ke}=Wr;if(de&&ee.sections.length===1){se=[];const Be=de(ee.toString(),bm(ee,P,x,t,h,H));for(const Qe of Be){const lt=new Nh;lt.text=Qe,lt.sections=ee.sections;for(let Tt=0;Tt<Qe.length;Tt++)lt.sectionIndex.push(0);se.push(lt)}}else if(ke){se=[];const Be=ke(ee.text,ee.sectionIndex,bm(ee,P,x,t,h,H));for(const Qe of Be){const lt=new Nh;lt.text=Qe[0],lt.sectionIndex=Qe[1],lt.sections=ee.sections,se.push(lt)}}else se=function(Be,Qe){const lt=[],Tt=Be.text;let mt=0;for(const wt of Qe)lt.push(Be.substring(mt,wt)),mt=wt;return mt<Tt.length&&lt.push(Be.substring(mt,Tt.length)),lt}(ee,bm(ee,P,x,t,h,H));const ve=[],Se={positionedLines:ve,text:ee.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(Be,Qe,lt,Tt,mt,wt,jt,xt,yt,nt,Gt,Qt){let Ft=0,Nt=0,En=0,Ni=0;const Vi=xt==="right"?1:xt==="left"?0:.5,na=Kn/Qt;let ys=0;for(const zi of mt){zi.trim();const er=zi.getMaxScale(),hr={positionedGlyphs:[],lineOffset:0};Be.positionedLines[ys]=hr;const Mr=hr.positionedGlyphs;let Cr=0;if(!zi.length()){Nt+=wt,++ys;continue}const Ya=Ov(Tt,zi,na);for(let Aa=0;Aa<zi.length();Aa++){const _r=zi.getSection(Aa),nr=zi.getSectionIndex(Aa),r=zi.getCharCode(Aa),u=xm(yt,Gt,r);let p;if(_r.imageName){if(Be.iconsInText=!0,_r.scale=_r.scale*na,p=iy(_r,u,er,Ya,Tt),!p)continue;Cr=Math.max(Cr,p.imageOffset)}else if(p=qd(_r,r,u,Ya,Qe,lt),!p)continue;const{rect:w,metrics:M,baselineOffset:N}=p;Mr.push({glyph:r,imageName:_r.imageName,x:Ft,y:Nt+N+-17,vertical:u,scale:_r.scale,fontStack:_r.fontStack,sectionIndex:nr,metrics:M,rect:w}),u?(Be.verticalizable=!0,Ft+=(_r.imageName?M.advance:Kn)*_r.scale+nt):Ft+=M.advance*_r.scale+nt}Mr.length!==0&&(En=Math.max(Ft-nt,En),wm(Mr,0,Mr.length-1,Vi)),Ft=0,hr.lineOffset=Math.max(Cr,(er-1)*Kn);const tr=wt*er+Cr;Nt+=tr,Ni=Math.max(tr,Ni),++ys}const{horizontalAlign:ia,verticalAlign:Ar}=ny(jt);(function(zi,er,hr,Mr,Cr,Ya,tr,Aa,_r){const nr=(er-hr)*Cr;let r=0;r=Ya!==tr?-Aa*Mr- -17:-Mr*_r*tr+.5*tr;for(const u of zi)for(const p of u.positionedGlyphs)p.x+=nr,p.y+=r})(Be.positionedLines,Vi,ia,Ar,En,Ni,wt,Nt,mt.length),Be.top+=-Ar*Nt,Be.bottom=Be.top+Nt,Be.left+=-ia*En,Be.right=Be.left+En}(Se,t,a,h,se,S,A,D,F,P,$,X),!function(Be){for(const Qe of Be)if(Qe.positionedGlyphs.length!==0)return!1;return!0}(ve)&&Se}const Qf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},a0={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},_m={40:!0};function ey(s,t,a,h,g,x){if(t.imageName){const S=h[t.imageName];return S?S.displaySize[0]*t.scale*Kn/x+g:0}{const S=a[t.fontStack],A=S&&S[s];return A?A.metrics.advance*t.scale+g:0}}function ty(s,t,a,h){const g=Math.pow(s-t,2);return h?s<t?g/2:2*g:g+Math.abs(a)*a}function ki(s,t,a){let h=0;return s===10&&(h-=1e4),a&&(h+=150),s!==40&&s!==65288||(h+=50),t!==41&&t!==65289||(h+=50),h}function vm(s,t,a,h,g,x){let S=null,A=ty(t,a,g,x);for(const D of h){const P=ty(t-D.x,a,g,x)+D.badness;P<=A&&(S=D,A=P)}return{index:s,x:t,priorBreak:S,badness:A}}function s0(s){return s?s0(s.priorBreak).concat(s.index):[]}function bm(s,t,a,h,g,x){if(!s)return[];const S=[],A=function(F,$,H,X,ee,se){let de=0;for(let ke=0;ke<F.length();ke++){const ve=F.getSection(ke);de+=ey(F.getCharCode(ke),ve,X,ee,$,se)}return de/Math.max(1,Math.ceil(de/H))}(s,t,a,h,g,x),D=s.text.indexOf("​")>=0;let P=0;for(let F=0;F<s.length();F++){const $=s.getSection(F),H=s.getCharCode(F);if(Qf[H]||(P+=ey(H,$,h,g,t,x)),F<s.length()-1){const X=!((L=H)<11904)&&(!!Sn["CJK Compatibility Forms"](L)||!!Sn["CJK Compatibility"](L)||!!Sn["CJK Strokes"](L)||!!Sn["CJK Symbols and Punctuation"](L)||!!Sn["Enclosed CJK Letters and Months"](L)||!!Sn["Halfwidth and Fullwidth Forms"](L)||!!Sn["Ideographic Description Characters"](L)||!!Sn["Vertical Forms"](L)||lc.test(String.fromCodePoint(L)));(a0[H]||X||$.imageName||F!==s.length()-2&&_m[s.getCharCode(F+1)])&&S.push(vm(F+1,P,A,S,ki(H,s.getCharCode(F+1),X&&D),!1))}}var L;return s0(vm(s.length(),P,A,S,0,!0))}function ny(s){let t=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function Ov(s,t,a){const h=t.getMaxScale()*Kn,{maxImageWidth:g,maxImageHeight:x}=t.getMaxImageSize(s),S=Math.max(h,x*a);return{verticalLineContentWidth:Math.max(h,g*a),horizontalLineContentHeight:S}}function o0(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function xm(s,t,a){return!(s===v.ao.horizontal||!t&&!_h(a)||t&&(Qf[a]||(h=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(h)))));var h}function qd(s,t,a,h,g,x){const S=x[s.fontStack],A=function(P,L,F,$){if(P&&P.rect)return P;const H=L[F.fontStack],X=H&&H[$];return X?{rect:null,metrics:X.metrics}:null}(S&&S[t],g,s,t);if(A===null)return null;let D;if(a)D=h.verticalLineContentWidth-s.scale*Kn;else{const P=o0(s.verticalAlign);D=(h.horizontalLineContentHeight-s.scale*Kn)*P}return{rect:A.rect,metrics:A.metrics,baselineOffset:D}}function iy(s,t,a,h,g){const x=g[s.imageName];if(!x)return null;const S=x.paddedRect,A=x.displaySize,D={width:A[0],height:A[1],left:1,top:-3,advance:t?A[1]:A[0]};let P;if(t)P=h.verticalLineContentWidth-A[1]*s.scale;else{const L=o0(s.verticalAlign);P=(h.horizontalLineContentHeight-A[1]*s.scale)*L}return{rect:S,metrics:D,baselineOffset:P,imageOffset:(t?A[0]:A[1])*s.scale-Kn*a}}function wm(s,t,a,h){if(h===0)return;const g=s[a],x=(s[a].x+g.metrics.advance*g.scale)*h;for(let S=t;S<=a;S++)s[S].x-=x}function ry(s,t,a){const{horizontalAlign:h,verticalAlign:g}=ny(a),x=t[0]-s.displaySize[0]*h,S=t[1]-s.displaySize[1]*g;return{image:s,top:S,bottom:S+s.displaySize[1],left:x,right:x+s.displaySize[0]}}function gu(s){var t,a;let h=s.left,g=s.top,x=s.right-h,S=s.bottom-g;const A=(t=s.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",D=(a=s.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",P=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(D==="proportional"){if(A==="stretchOnly"&&x/S<P||A==="proportional"){const L=Math.ceil(S*P);h*=L/x,x=L}}else if(A==="proportional"&&D==="stretchOnly"&&P!==0&&x/S>P){const L=Math.ceil(x/P);g*=L/S,S=L}return{x1:h,y1:g,x2:h+x,y2:g+S}}function Ko(s,t,a,h,g,x){const S=s.image;let A;if(S.content){const se=S.content,de=S.pixelRatio||1;A=[se[0]/de,se[1]/de,S.displaySize[0]-se[2]/de,S.displaySize[1]-se[3]/de]}const D=t.left*x,P=t.right*x;let L,F,$,H;a==="width"||a==="both"?(H=g[0]+D-h[3],F=g[0]+P+h[1]):(H=g[0]+(D+P-S.displaySize[0])/2,F=H+S.displaySize[0]);const X=t.top*x,ee=t.bottom*x;return a==="height"||a==="both"?(L=g[1]+X-h[0],$=g[1]+ee+h[2]):(L=g[1]+(X+ee-S.displaySize[1])/2,$=L+S.displaySize[1]),{image:S,top:L,right:F,bottom:$,left:H,collisionPadding:A}}const Os=128,yu=32640;function ay(s,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Hn(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=a;let x=0;for(;x<h.length&&h[x]<=s;)x++;x=Math.max(0,x-1);let S=x;for(;S<h.length&&h[S]<s+1;)S++;S=Math.min(h.length-1,S);const A=h[x],D=h[S];return a.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:D,interpolationType:g}:{kind:"camera",minZoom:A,maxZoom:D,minSize:a.evaluate(new Hn(A)),maxSize:a.evaluate(new Hn(D)),interpolationType:g}}}function Tm(s,t,a){let h="never";const g=s.get(t);return g?h=g:s.get(a)&&(h="always"),h}const l0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kf(s,t,a,h,g,x,S,A,D,P,L,F,$){const H=A?Math.min(yu,Math.round(A[0])):0,X=A?Math.min(yu,Math.round(A[1])):0;s.emplaceBack(t,a,Math.round(32*h),Math.round(32*g),x,S,(H<<1)+(D?1:0),X,16*P,16*L,256*F,256*$)}function sy(s,t,a){s.emplaceBack(t.x,t.y,a),s.emplaceBack(t.x,t.y,a),s.emplaceBack(t.x,t.y,a),s.emplaceBack(t.x,t.y,a)}function oy(s){for(const t of s.sections)if(Bf(t.text))return!0;return!1}class Sm{constructor(t){this.layoutVertexArray=new ot,this.indexArray=new Fn,this.programConfigurations=t,this.segments=new on,this.dynamicLayoutVertexArray=new Ot,this.opacityVertexArray=new mn,this.hasVisibleVertices=!1,this.placedSymbolArray=new le}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Vd.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Gd.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,l0,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ct("SymbolBuffers",Sm);class Em{constructor(t,a,h){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new h,this.segments=new on,this.collisionVertexArray=new Mi}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Hg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ct("CollisionBuffers",Em);class Hd{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(S=>S.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ay(this.zoom,a["text-size"]),this.iconSizeData=ay(this.zoom,a["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),x=h.get("symbol-z-order");this.canOverlap=Tm(h,"text-overlap","text-allow-overlap")!=="never"||Tm(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(S=>v.ao[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=t.sourceID}createArrays(){this.text=new Sm(new pa(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Sm(new pa(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new he,this.lineVertexArray=new ye,this.symbolInstances=new ue,this.textAnchorOffsets=new xe}calculateGlyphDependencies(t,a,h,g,x){for(let S=0;S<t.length;S++)if(a[t.charCodeAt(S)]=!0,(h||g)&&x){const A=Ph[t.charAt(S)];A&&(a[A.charCodeAt(0)]=!0)}}populate(t,a,h){const g=this.layers[0],x=g.layout,S=x.get("text-font"),A=x.get("text-field"),D=x.get("icon-image"),P=(A.value.kind!=="constant"||A.value.value instanceof sr&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),L=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,F=x.get("symbol-sort-key");if(this.features=[],!P&&!L)return;const $=a.iconDependencies,H=a.glyphDependencies,X=a.availableImages,ee=new Hn(this.zoom);for(const{feature:se,id:de,index:ke,sourceLayerIndex:ve}of t){const Se=g._featureFilter.needGeometry,Be=pc(se,Se);if(!g._featureFilter.filter(ee,Be,h))continue;let Qe,lt;if(Se||(Be.geometry=hs(se)),P){const mt=g.getValueAndResolveTokens("text-field",Be,h,X),wt=sr.factory(mt),jt=this.hasRTLText=this.hasRTLText||oy(wt);(!jt||Wr.getRTLTextPluginStatus()==="unavailable"||jt&&Wr.isParsed())&&(Qe=Hf(wt,g,Be))}if(L){const mt=g.getValueAndResolveTokens("icon-image",Be,h,X);lt=mt instanceof Nr?mt:Nr.fromString(mt)}if(!Qe&&!lt)continue;const Tt=this.sortFeaturesByKey?F.evaluate(Be,{},h):void 0;if(this.features.push({id:de,text:Qe,icon:lt,index:ke,sourceLayerIndex:ve,geometry:Be.geometry,properties:se.properties,type:Rh.types[se.type],sortKey:Tt}),lt&&($[lt.name]=!0),Qe){const mt=S.evaluate(Be,{},h).join(","),wt=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ao.vertical)>=0;for(const jt of Qe.sections)if(jt.image)$[jt.image.name]=!0;else{const xt=Rs(Qe.toString()),yt=jt.fontStack||mt,nt=H[yt]=H[yt]||{};this.calculateGlyphDependencies(jt.text,nt,wt,this.allowVerticalPlacement,xt)}}}x.get("symbol-placement")==="line"&&(this.features=function(se){const de={},ke={},ve=[];let Se=0;function Be(mt){ve.push(se[mt]),Se++}function Qe(mt,wt,jt){const xt=ke[mt];return delete ke[mt],ke[wt]=xt,ve[xt].geometry[0].pop(),ve[xt].geometry[0]=ve[xt].geometry[0].concat(jt[0]),xt}function lt(mt,wt,jt){const xt=de[wt];return delete de[wt],de[mt]=xt,ve[xt].geometry[0].shift(),ve[xt].geometry[0]=jt[0].concat(ve[xt].geometry[0]),xt}function Tt(mt,wt,jt){const xt=jt?wt[0][wt[0].length-1]:wt[0][0];return`${mt}:${xt.x}:${xt.y}`}for(let mt=0;mt<se.length;mt++){const wt=se[mt],jt=wt.geometry,xt=wt.text?wt.text.toString():null;if(!xt){Be(mt);continue}const yt=Tt(xt,jt),nt=Tt(xt,jt,!0);if(yt in ke&&nt in de&&ke[yt]!==de[nt]){const Gt=lt(yt,nt,jt),Qt=Qe(yt,nt,ve[Gt].geometry);delete de[yt],delete ke[nt],ke[Tt(xt,ve[Qt].geometry,!0)]=Qt,ve[Gt].geometry=null}else yt in ke?Qe(yt,nt,jt):nt in de?lt(yt,nt,jt):(Be(mt),de[yt]=Se-1,ke[nt]=Se-1)}return ve.filter(mt=>mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((se,de)=>se.sortKey-de.sortKey)}update(t,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,{imagePositions:h}),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,{imagePositions:h}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const h=this.lineVertexArray.length;if(t.segment!==void 0){let g=t.dist(a[t.segment+1]),x=t.dist(a[t.segment]);const S={};for(let A=t.segment+1;A<a.length;A++)S[A]={x:a[A].x,y:a[A].y,tileUnitDistanceFromAnchor:g},A<a.length-1&&(g+=a[A+1].dist(a[A]));for(let A=t.segment||0;A>=0;A--)S[A]={x:a[A].x,y:a[A].y,tileUnitDistanceFromAnchor:x},A>0&&(x+=a[A-1].dist(a[A]));for(let A=0;A<a.length;A++){const D=S[A];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(t,a,h,g,x,S,A,D,P,L,F,$){const H=t.indexArray,X=t.layoutVertexArray,ee=t.segments.prepareSegment(4*a.length,X,H,this.canOverlap?S.sortKey:void 0),se=this.glyphOffsetArray.length,de=ee.vertexLength,ke=this.allowVerticalPlacement&&A===v.ao.vertical?Math.PI/2:0,ve=S.text&&S.text.sections;for(let Se=0;Se<a.length;Se++){const{tl:Be,tr:Qe,bl:lt,br:Tt,tex:mt,pixelOffsetTL:wt,pixelOffsetBR:jt,minFontScaleX:xt,minFontScaleY:yt,glyphOffset:nt,isSDF:Gt,sectionIndex:Qt}=a[Se],Ft=ee.vertexLength,Nt=nt[1];Kf(X,D.x,D.y,Be.x,Nt+Be.y,mt.x,mt.y,h,Gt,wt.x,wt.y,xt,yt),Kf(X,D.x,D.y,Qe.x,Nt+Qe.y,mt.x+mt.w,mt.y,h,Gt,jt.x,wt.y,xt,yt),Kf(X,D.x,D.y,lt.x,Nt+lt.y,mt.x,mt.y+mt.h,h,Gt,wt.x,jt.y,xt,yt),Kf(X,D.x,D.y,Tt.x,Nt+Tt.y,mt.x+mt.w,mt.y+mt.h,h,Gt,jt.x,jt.y,xt,yt),sy(t.dynamicLayoutVertexArray,D,ke),H.emplaceBack(Ft,Ft+2,Ft+1),H.emplaceBack(Ft+1,Ft+2,Ft+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(nt[0]),Se!==a.length-1&&Qt===a[Se+1].sectionIndex||t.programConfigurations.populatePaintArrays(X.length,S,S.index,{imagePositions:{},canonical:$,formattedSection:ve&&ve[Qt]})}t.placedSymbolArray.emplaceBack(D.x,D.y,se,this.glyphOffsetArray.length-se,de,P,L,D.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],A,0,!1,0,F)}_addCollisionDebugVertex(t,a,h,g,x,S){return a.emplaceBack(0,0),t.emplaceBack(h.x,h.y,g,x,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(t,a,h,g,x,S,A){const D=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),P=D.vertexLength,L=x.layoutVertexArray,F=x.collisionVertexArray,$=A.anchorX,H=A.anchorY;this._addCollisionDebugVertex(L,F,S,$,H,new C(t,a)),this._addCollisionDebugVertex(L,F,S,$,H,new C(h,a)),this._addCollisionDebugVertex(L,F,S,$,H,new C(h,g)),this._addCollisionDebugVertex(L,F,S,$,H,new C(t,g)),D.vertexLength+=4;const X=x.indexArray;X.emplaceBack(P,P+1),X.emplaceBack(P+1,P+2),X.emplaceBack(P+2,P+3),X.emplaceBack(P+3,P),D.primitiveLength+=4}addDebugCollisionBoxes(t,a,h,g){for(let x=t;x<a;x++){const S=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,g?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Em(Rn,pm.members,_i),this.iconCollisionBox=new Em(Rn,pm.members,_i);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,h,g,x,S,A,D,P){const L={};for(let F=a;F<h;F++){const $=t.get(F);L.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.textFeatureIndex=$.featureIndex;break}for(let F=g;F<x;F++){const $=t.get(F);L.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalTextFeatureIndex=$.featureIndex;break}for(let F=S;F<A;F++){const $=t.get(F);L.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.iconFeatureIndex=$.featureIndex;break}for(let F=D;F<P;F++){const $=t.get(F);L.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalIconFeatureIndex=$.featureIndex;break}return L}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const h=t.placedSymbolArray.get(a),g=h.vertexStartIndex+4*h.numGlyphs;for(let x=h.vertexStartIndex;x<g;x+=4)t.indexArray.emplaceBack(x,x+2,x+1),t.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),h=Math.cos(t),g=[],x=[],S=[];for(let A=0;A<this.symbolInstances.length;++A){S.push(A);const D=this.symbolInstances.get(A);g.push(0|Math.round(a*D.anchorX+h*D.anchorY)),x.push(D.featureIndex)}return S.sort((A,D)=>g[A]-g[D]||x[D]-x[A]),S}addToSortKeyRanges(t,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,x,S)=>{g>=0&&S.indexOf(g)===x&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Am,Mm;Ct("SymbolBucket",Hd,{omit:["layers","collisionBoxArray","features","compareText"]}),Hd.MAX_GLYPHS=65535,Hd.addDynamicAttributes=sy;var ly={get paint(){return Mm=Mm||new Ln({"icon-opacity":new $t(Pe.paint_symbol["icon-opacity"]),"icon-color":new $t(Pe.paint_symbol["icon-color"]),"icon-halo-color":new $t(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new $t(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $t(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new $t(Pe.paint_symbol["text-opacity"]),"text-color":new $t(Pe.paint_symbol["text-color"],{runtimeType:Xi,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new $t(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new $t(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new $t(Pe.paint_symbol["text-halo-blur"]),"text-translate":new zt(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new zt(Pe.paint_symbol["text-translate-anchor"])})},get layout(){return Am=Am||new Ln({"symbol-placement":new zt(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $t(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new zt(Pe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new zt(Pe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new zt(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new $t(Pe.layout_symbol["icon-size"]),"icon-text-fit":new zt(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zt(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new $t(Pe.layout_symbol["icon-image"]),"icon-rotate":new $t(Pe.layout_symbol["icon-rotate"]),"icon-padding":new $t(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new $t(Pe.layout_symbol["icon-offset"]),"icon-anchor":new $t(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new $t(Pe.layout_symbol["text-field"]),"text-font":new $t(Pe.layout_symbol["text-font"]),"text-size":new $t(Pe.layout_symbol["text-size"]),"text-max-width":new $t(Pe.layout_symbol["text-max-width"]),"text-line-height":new zt(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new $t(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new $t(Pe.layout_symbol["text-justify"]),"text-radial-offset":new $t(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(Pe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new $t(Pe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new $t(Pe.layout_symbol["text-anchor"]),"text-max-angle":new zt(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new $t(Pe.layout_symbol["text-rotate"]),"text-padding":new zt(Pe.layout_symbol["text-padding"]),"text-keep-upright":new zt(Pe.layout_symbol["text-keep-upright"]),"text-transform":new $t(Pe.layout_symbol["text-transform"]),"text-offset":new $t(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new zt(Pe.layout_symbol["text-allow-overlap"]),"text-overlap":new zt(Pe.layout_symbol["text-overlap"]),"text-ignore-placement":new zt(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new zt(Pe.layout_symbol["text-optional"])})}};class c0{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:io,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ct("FormatSectionOverride",c0,{omit:["defaultValue"]});class _u extends Va{constructor(t,a){super(t,ly,a)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const x of h)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,h,g){const x=this.layout.get(t).evaluate(a,{},h,g),S=this._unevaluatedLayout._values[t];return S.isDataDriven()||jo(S.value)||!x?x:function(A,D){return D.replace(/{([^{}]+)}/g,(P,L)=>A&&L in A?String(A[L]):"")}(a.properties,x)}createBucket(t){return new Hd(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ly.paint.overridableProperties){if(!_u.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),h=new c0(a),g=new uh(h,a.property.specification);let x=null;x=a.value.kind==="constant"||a.value.kind==="source"?new yl("source",g):new Wc("composite",g,a.value.zoomStops),this.paint._values[t]=new Fa(a.property,x,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&_u.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const h=t.get("text-field"),g=ly.paint.properties[a];let x=!1;const S=A=>{for(const D of A)if(g.overrides&&g.overrides.hasOverride(D))return void(x=!0)};if(h.value.kind==="constant"&&h.value.value instanceof sr)S(h.value.value.sections);else if(h.value.kind==="source"||h.value.kind==="composite"){const A=P=>{x||(P instanceof ts&&qt(P.value)===_a?S(P.value.sections):P instanceof Wl?S(P.sections):P.eachChild(A))},D=h.value;D._styleExpression&&A(D._styleExpression.expression)}return x}}let u0;var h0={get paint(){return u0=u0||new Ln({"background-color":new zt(Pe.paint_background["background-color"]),"background-pattern":new Tl(Pe.paint_background["background-pattern"]),"background-opacity":new zt(Pe.paint_background["background-opacity"])})}};class On extends Va{constructor(t,a){super(t,h0,a)}}let Cm;var Dm={get paint(){return Cm=Cm||new Ln({"raster-opacity":new zt(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new zt(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(Pe.paint_raster["raster-saturation"]),"raster-contrast":new zt(Pe.paint_raster["raster-contrast"]),"raster-resampling":new zt(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(Pe.paint_raster["raster-fade-duration"])})}};class cy extends Va{constructor(t,a){super(t,Dm,a)}}class d0 extends Va{constructor(t,a){super(t,{},a),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class uy{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Jf={once:!0},Xd=63710088e-1;class js{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new js(wi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,h=this.lat*a,g=t.lat*a,x=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((t.lng-this.lng)*a);return Xd*Math.acos(Math.min(x,1))}static convert(t){if(t instanceof js)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new js(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new js(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const hy=2*Math.PI*Xd;function f0(s){return hy*Math.cos(s*Math.PI/180)}function p0(s){return(180+s)/360}function dy(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function fy(s,t){return s/f0(t)}function Wd(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function di(s,t){return s*f0(Wd(t))}class zh{constructor(t,a,h=0){this.x=+t,this.y=+a,this.z=+h}static fromLngLat(t,a=0){const h=js.convert(t);return new zh(p0(h.lng),dy(h.lat),fy(a,h.lat))}toLngLat(){return new js(360*this.x-180,Wd(this.y))}toAltitude(){return di(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/hy*(t=Wd(this.y),1/Math.cos(t*Math.PI/180));var t}}function ea(s,t,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[s*h-2*Math.PI*6378137/2,t*h-2*Math.PI*6378137/2]}class py{constructor(t,a,h){if(!function(g,x,S){return!(g<0||g>25||S<0||S>=Math.pow(2,g)||x<0||x>=Math.pow(2,g))}(t,a,h))throw new Error(`x=${a}, y=${h}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=h,this.key=Tc(0,t,t,a,h)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,h){const g=(S=this.y,A=this.z,D=ea(256*(x=this.x),256*(S=Math.pow(2,A)-S-1),A),P=ea(256*(x+1),256*(S+1),A),D[0]+","+D[1]+","+P[0]+","+P[1]);var x,S,A,D,P;const L=function(F,$,H){let X,ee="";for(let se=F;se>0;se--)X=1<<se-1,ee+=($&X?1:0)+(H&X?2:0);return ee}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,L).replace(/{bbox-epsg-3857}/g,g)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new C((t.x*a-this.x)*It,(t.y*a-this.y)*It)}toString(){return`${this.z}/${this.x}/${this.y}`}}class km{constructor(t,a){this.wrap=t,this.canonical=a,this.key=Tc(t,a.z,a.z,a.x,a.y)}}class $a{constructor(t,a,h,g,x){if(this.terrainRttPosMatrix32f=null,t<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${h}`);this.overscaledZ=t,this.wrap=a,this.canonical=new py(h,+g,+x),this.key=Tc(a,t,h,g,x)}clone(){return new $a(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new $a(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $a(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-t;return t>this.canonical.z?Tc(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):Tc(this.wrap*+a,t,t,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new $a(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new $a(a,this.wrap,a,h,g),new $a(a,this.wrap,a,h+1,g),new $a(a,this.wrap,a,h,g+1),new $a(a,this.wrap,a,h+1,g+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new $a(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new $a(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new km(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new zh(t.x-this.wrap,t.y))}}function Tc(s,t,a,h,g){(s*=2)<0&&(s=-1*s-1);const x=1<<a;return(x*x*s+x*g+h).toString(36)+a.toString(36)+t.toString(36)}function Qd(s,t){return t?s.properties[t]:s.id}Ct("CanonicalTileID",py),Ct("OverscaledTileID",$a,{omit:["terrainRttPosMatrix32f"]});class vu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const a=new vu;return a.extend(t(new C(this.minX,this.minY))),a.extend(t(new C(this.maxX,this.minY))),a.extend(t(new C(this.minX,this.maxY))),a.extend(t(new C(this.maxX,this.maxY))),a}static fromPoints(t){const a=new vu;for(const h of t)a.extend(h);return a}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class Rm{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const h=t[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Im{constructor(t,a,h,g,x){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=h,t._y=g,this.properties=t.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class m0{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Vo(It,16,0),this.grid3D=new Vo(It,16,0),this.featureIndexArray=new ge,this.promoteId=a}insert(t,a,h,g,x,S){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,x);const D=S?this.grid3D:this.grid;for(let P=0;P<a.length;P++){const L=a[P],F=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const H=L[$];F[0]=Math.min(F[0],H.x),F[1]=Math.min(F[1],H.y),F[2]=Math.max(F[2],H.x),F[3]=Math.max(F[3],H.y)}F[0]<It&&F[1]<It&&F[2]>=0&&F[3]>=0&&D.insert(A,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new J_(new gm(this.rawTileData)).layers,this.sourceLayerCoder=new Rm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,h,g){this.loadVTLayers();const x=t.params,S=It/t.tileSize/t.scale,A=_l(x.filter,x.globalState),D=t.queryGeometry,P=t.queryPadding*S,L=vu.fromPoints(D),F=this.grid.query(L.minX-P,L.minY-P,L.maxX+P,L.maxY+P),$=vu.fromPoints(t.cameraQueryGeometry).expandBy(P),H=this.grid3D.query($.minX,$.minY,$.maxX,$.maxY,(se,de,ke,ve)=>function(Se,Be,Qe,lt,Tt){for(const wt of Se)if(Be<=wt.x&&Qe<=wt.y&&lt>=wt.x&&Tt>=wt.y)return!0;const mt=[new C(Be,Qe),new C(Be,Tt),new C(lt,Tt),new C(lt,Qe)];if(Se.length>2){for(const wt of mt)if(Sh(Se,wt))return!0}for(let wt=0;wt<Se.length-1;wt++)if(Dv(Se[wt],Se[wt+1],mt))return!0;return!1}(t.cameraQueryGeometry,se-P,de-P,ke+P,ve+P));for(const se of H)F.push(se);F.sort(jv);const X={};let ee;for(let se=0;se<F.length;se++){const de=F[se];if(de===ee)continue;ee=de;const ke=this.featureIndexArray.get(de);let ve=null;this.loadMatchingFeature(X,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,A,x.layers,x.availableImages,a,h,g,(Se,Be,Qe)=>(ve||(ve=hs(Se)),Be.queryIntersectsFeature({queryGeometry:D,feature:Se,featureState:Qe,geometry:ve,zoom:this.z,transform:t.transform,pixelsToTileUnits:S,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return X}loadMatchingFeature(t,a,h,g,x,S,A,D,P,L,F){const $=this.bucketLayerIDs[a];if(S&&!$.some(se=>S.has(se)))return;const H=this.sourceLayerCoder.decode(h),X=this.vtLayers[H].feature(g);if(x.needGeometry){const se=pc(X,!0);if(!x.filter(new Hn(this.tileID.overscaledZ),se,this.tileID.canonical))return}else if(!x.filter(new Hn(this.tileID.overscaledZ),X))return;const ee=this.getId(X,H);for(let se=0;se<$.length;se++){const de=$[se];if(S&&!S.has(de))continue;const ke=D[de];if(!ke)continue;let ve={};ee&&L&&(ve=L.getState(ke.sourceLayer||"_geojsonTileLayer",ee));const Se=fn({},P[de]);Se.paint=my(Se.paint,ke.paint,X,ve,A),Se.layout=my(Se.layout,ke.layout,X,ve,A);const Be=!F||F(X,ke,ve);if(!Be)continue;const Qe=new Im(X,this.z,this.x,this.y,ee);Qe.layer=Se;let lt=t[de];lt===void 0&&(lt=t[de]=[]),lt.push({featureIndex:g,feature:Qe,intersectionZ:Be})}}lookupSymbolFeatures(t,a,h,g,x,S,A,D){const P={};this.loadVTLayers();const L=_l(x.filterSpec,x.globalState);for(const F of t)this.loadMatchingFeature(P,h,g,F,L,S,A,D,a);return P}hasLayer(t){for(const a of this.bucketLayerIDs)for(const h of a)if(t===h)return!0;return!1}getId(t,a){var h;let g=t.id;return this.promoteId&&(g=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((h=t.properties)===null||h===void 0)&&h.cluster)&&this.promoteId&&(g=Number(t.properties.cluster_id))),g}}function my(s,t,a,h,g){return ya(s,(x,S)=>{const A=t instanceof Zo?t.get(S):null;return A&&A.evaluate?A.evaluate(a,h,g):A})}function jv(s,t){return t-s}function gy(s,t,a,h,g){const x=[];for(let S=0;S<s.length;S++){const A=s[S];let D;for(let P=0;P<A.length-1;P++){let L=A[P],F=A[P+1];L.x<t&&F.x<t||(L.x<t?L=new C(t,L.y+(t-L.x)/(F.x-L.x)*(F.y-L.y))._round():F.x<t&&(F=new C(t,L.y+(t-L.x)/(F.x-L.x)*(F.y-L.y))._round()),L.y<a&&F.y<a||(L.y<a?L=new C(L.x+(a-L.y)/(F.y-L.y)*(F.x-L.x),a)._round():F.y<a&&(F=new C(L.x+(a-L.y)/(F.y-L.y)*(F.x-L.x),a)._round()),L.x>=h&&F.x>=h||(L.x>=h?L=new C(h,L.y+(h-L.x)/(F.x-L.x)*(F.y-L.y))._round():F.x>=h&&(F=new C(h,L.y+(h-L.x)/(F.x-L.x)*(F.y-L.y))._round()),L.y>=g&&F.y>=g||(L.y>=g?L=new C(L.x+(g-L.y)/(F.y-L.y)*(F.x-L.x),g)._round():F.y>=g&&(F=new C(L.x+(g-L.y)/(F.y-L.y)*(F.x-L.x),g)._round()),D&&L.equals(D[D.length-1])||(D=[L],x.push(D)),D.push(F)))))}}return x}Ct("FeatureIndex",m0,{omit:["rawTileData","sourceLayerCoder"]});class bu extends C{constructor(t,a,h,g){super(t,a),this.angle=h,g!==void 0&&(this.segment=g)}clone(){return new bu(this.x,this.y,this.angle,this.segment)}}function g0(s,t,a,h,g){if(t.segment===void 0||a===0)return!0;let x=t,S=t.segment+1,A=0;for(;A>-a/2;){if(S--,S<0)return!1;A-=s[S].dist(x),x=s[S]}A+=s[S].dist(s[S+1]),S++;const D=[];let P=0;for(;A<a/2;){const L=s[S],F=s[S+1];if(!F)return!1;let $=s[S-1].angleTo(L)-L.angleTo(F);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:A,angleDelta:$}),P+=$;A-D[0].distance>h;)P-=D.shift().angleDelta;if(P>g)return!1;S++,A+=L.dist(F)}return!0}function Sc(s){let t=0;for(let a=0;a<s.length-1;a++)t+=s[a].dist(s[a+1]);return t}function yy(s,t,a){return s?.6*t*a:0}function Pm(s,t){return Math.max(s?s.right-s.left:0,t?t.right-t.left:0)}function Bv(s,t,a,h,g,x){const S=yy(a,g,x),A=Pm(a,h)*x;let D=0;const P=Sc(s)/2;for(let L=0;L<s.length-1;L++){const F=s[L],$=s[L+1],H=F.dist($);if(D+H>P){const X=(P-D)/H,ee=ho.number(F.x,$.x,X),se=ho.number(F.y,$.y,X),de=new bu(ee,se,$.angleTo(F),L);return de._round(),!S||g0(s,de,A,S,t)?de:void 0}D+=H}}function Fv(s,t,a,h,g,x,S,A,D){const P=yy(h,x,S),L=Pm(h,g),F=L*S,$=s[0].x===0||s[0].x===D||s[0].y===0||s[0].y===D;return t-F<t/4&&(t=F+t/4),Nm(s,$?t/2*A%t:(L/2+2*x)*S*A%t,t,P,a,F,$,!1,D)}function Nm(s,t,a,h,g,x,S,A,D){const P=x/2,L=Sc(s);let F=0,$=t-a,H=[];for(let X=0;X<s.length-1;X++){const ee=s[X],se=s[X+1],de=ee.dist(se),ke=se.angleTo(ee);for(;$+a<F+de;){$+=a;const ve=($-F)/de,Se=ho.number(ee.x,se.x,ve),Be=ho.number(ee.y,se.y,ve);if(Se>=0&&Se<D&&Be>=0&&Be<D&&$-P>=0&&$+P<=L){const Qe=new bu(Se,Be,ke,X);Qe._round(),h&&!g0(s,Qe,x,h,g)||H.push(Qe)}}F+=de}return A||H.length||S||(H=Nm(s,F/2,a,h,g,x,S,!0,D)),H}function y0(s,t,a,h){const g=[],x=s.image,S=x.pixelRatio,A=x.paddedRect.w-2,D=x.paddedRect.h-2;let P={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const L=x.stretchX||[[0,A]],F=x.stretchY||[[0,D]],$=(nt,Gt)=>nt+Gt[1]-Gt[0],H=L.reduce($,0),X=F.reduce($,0),ee=A-H,se=D-X;let de=0,ke=H,ve=0,Se=X,Be=0,Qe=ee,lt=0,Tt=se;if(x.content&&h){const nt=x.content,Gt=nt[2]-nt[0],Qt=nt[3]-nt[1];(x.textFitWidth||x.textFitHeight)&&(P=gu(s)),de=ms(L,0,nt[0]),ve=ms(F,0,nt[1]),ke=ms(L,nt[0],nt[2]),Se=ms(F,nt[1],nt[3]),Be=nt[0]-de,lt=nt[1]-ve,Qe=Gt-ke,Tt=Qt-Se}const mt=P.x1,wt=P.y1,jt=P.x2-mt,xt=P.y2-wt,yt=(nt,Gt,Qt,Ft)=>{const Nt=ep(nt.stretch-de,ke,jt,mt),En=tp(nt.fixed-Be,Qe,nt.stretch,H),Ni=ep(Gt.stretch-ve,Se,xt,wt),Vi=tp(Gt.fixed-lt,Tt,Gt.stretch,X),na=ep(Qt.stretch-de,ke,jt,mt),ys=tp(Qt.fixed-Be,Qe,Qt.stretch,H),ia=ep(Ft.stretch-ve,Se,xt,wt),Ar=tp(Ft.fixed-lt,Tt,Ft.stretch,X),zi=new C(Nt,Ni),er=new C(na,Ni),hr=new C(na,ia),Mr=new C(Nt,ia),Cr=new C(En/S,Vi/S),Ya=new C(ys/S,Ar/S),tr=t*Math.PI/180;if(tr){const nr=Math.sin(tr),r=Math.cos(tr),u=[r,-nr,nr,r];zi._matMult(u),er._matMult(u),Mr._matMult(u),hr._matMult(u)}const Aa=nt.stretch+nt.fixed,_r=Gt.stretch+Gt.fixed;return{tl:zi,tr:er,bl:Mr,br:hr,tex:{x:x.paddedRect.x+1+Aa,y:x.paddedRect.y+1+_r,w:Qt.stretch+Qt.fixed-Aa,h:Ft.stretch+Ft.fixed-_r},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Cr,pixelOffsetBR:Ya,minFontScaleX:Qe/S/jt,minFontScaleY:Tt/S/xt,isSDF:a}};if(h&&(x.stretchX||x.stretchY)){const nt=zm(L,ee,H),Gt=zm(F,se,X);for(let Qt=0;Qt<nt.length-1;Qt++){const Ft=nt[Qt],Nt=nt[Qt+1];for(let En=0;En<Gt.length-1;En++)g.push(yt(Ft,Gt[En],Nt,Gt[En+1]))}}else g.push(yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:D+1}));return g}function ms(s,t,a){let h=0;for(const g of s)h+=Math.max(t,Math.min(a,g[1]))-Math.max(t,Math.min(a,g[0]));return h}function zm(s,t,a){const h=[{fixed:-1,stretch:0}];for(const[g,x]of s){const S=h[h.length-1];h.push({fixed:g-S.stretch,stretch:S.stretch}),h.push({fixed:g-S.stretch,stretch:S.stretch+(x-g)})}return h.push({fixed:t+1,stretch:a}),h}function ep(s,t,a,h){return s/t*a+h}function tp(s,t,a,h){return s-t*a/h}Ct("Anchor",bu);class xu{constructor(t,a,h,g,x,S,A,D,P,L){var F;if(this.boxStartIndex=t.length,P){let $=S.top,H=S.bottom;const X=S.collisionPadding;X&&($-=X[1],H+=X[3]);let ee=H-$;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{const $=!((F=S.image)===null||F===void 0)&&F.content&&(S.image.textFitWidth||S.image.textFitHeight)?gu(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};$.y1=$.y1*A-D[0],$.y2=$.y2*A+D[2],$.x1=$.x1*A-D[3],$.x2=$.x2*A+D[1];const H=S.collisionPadding;if(H&&($.x1-=H[0]*A,$.y1-=H[1]*A,$.x2+=H[2]*A,$.y2+=H[3]*A),L){const X=new C($.x1,$.y1),ee=new C($.x2,$.y1),se=new C($.x1,$.y2),de=new C($.x2,$.y2),ke=L*Math.PI/180;X._rotate(ke),ee._rotate(ke),se._rotate(ke),de._rotate(ke),$.x1=Math.min(X.x,ee.x,se.x,de.x),$.x2=Math.max(X.x,ee.x,se.x,de.x),$.y1=Math.min(X.y,ee.y,se.y,de.y),$.y2=Math.max(X.y,ee.y,se.y,de.y)}t.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,h,g,x)}this.boxEndIndex=t.length}}class bo{constructor(t=[],a=(h,g)=>h<g?-1:h>g?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:h}=this,g=a[t];for(;t>0;){const x=t-1>>1,S=a[x];if(h(g,S)>=0)break;a[t]=S,t=x}a[t]=g}_down(t){const{data:a,compare:h}=this,g=this.length>>1,x=a[t];for(;t<g;){let S=1+(t<<1);const A=S+1;if(A<this.length&&h(a[A],a[S])<0&&(S=A),h(a[S],x)>=0)break;a[t]=a[S],t=S}a[t]=x}}function _0(s,t=1,a=!1){const h=vu.fromPoints(s[0]),g=Math.min(h.width(),h.height());let x=g/2;const S=new bo([],Lm),{minX:A,minY:D,maxX:P,maxY:L}=h;if(g===0)return new C(A,D);for(let H=A;H<P;H+=g)for(let X=D;X<L;X+=g)S.push(new gs(H+x,X+x,x,s));let F=function(H){let X=0,ee=0,se=0;const de=H[0];for(let ke=0,ve=de.length,Se=ve-1;ke<ve;Se=ke++){const Be=de[ke],Qe=de[Se],lt=Be.x*Qe.y-Qe.x*Be.y;ee+=(Be.x+Qe.x)*lt,se+=(Be.y+Qe.y)*lt,X+=3*lt}return new gs(ee/X,se/X,0,H)}(s),$=S.length;for(;S.length;){const H=S.pop();(H.d>F.d||!F.d)&&(F=H,a&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,$)),H.max-F.d<=t||(x=H.h/2,S.push(new gs(H.p.x-x,H.p.y-x,x,s)),S.push(new gs(H.p.x+x,H.p.y-x,x,s)),S.push(new gs(H.p.x-x,H.p.y+x,x,s)),S.push(new gs(H.p.x+x,H.p.y+x,x,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${F.d}`)),F.p}function Lm(s,t){return t.max-s.max}function gs(s,t,a,h){this.p=new C(s,t),this.h=a,this.d=function(g,x){let S=!1,A=1/0;for(let D=0;D<x.length;D++){const P=x[D];for(let L=0,F=P.length,$=F-1;L<F;$=L++){const H=P[L],X=P[$];H.y>g.y!=X.y>g.y&&g.x<(X.x-H.x)*(g.y-H.y)/(X.y-H.y)+H.x&&(S=!S),A=Math.min(A,em(g,H,X))}}return(S?1:-1)*Math.sqrt(A)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var ta;v.aE=void 0,(ta=v.aE||(v.aE={}))[ta.center=1]="center",ta[ta.left=2]="left",ta[ta.right=3]="right",ta[ta.top=4]="top",ta[ta.bottom=5]="bottom",ta[ta["top-left"]=6]="top-left",ta[ta["top-right"]=7]="top-right",ta[ta["bottom-left"]=8]="bottom-left",ta[ta["bottom-right"]=9]="bottom-right";const _y=Number.POSITIVE_INFINITY;function Lh(s,t){return t[1]!==_y?function(a,h,g){let x=0,S=0;switch(h=Math.abs(h),g=Math.abs(g),a){case"top-right":case"top-left":case"top":S=g-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-g}switch(a){case"top-right":case"bottom-right":case"right":x=-h;break;case"top-left":case"bottom-left":case"left":x=h}return[x,S]}(s,t[0],t[1]):function(a,h){let g=0,x=0;h<0&&(h=0);const S=h/Math.SQRT2;switch(a){case"top-right":case"top-left":x=S-7;break;case"bottom-right":case"bottom-left":x=7-S;break;case"bottom":x=7-h;break;case"top":x=h-7}switch(a){case"top-right":case"bottom-right":g=-S;break;case"top-left":case"bottom-left":g=S;break;case"left":g=h;break;case"right":g=-h}return[g,x]}(s,t[0])}function vy(s,t,a){var h;const g=s.layout,x=(h=g.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(t,{},a);if(x){const A=x.values,D=[];for(let P=0;P<A.length;P+=2){const L=D[P]=A[P],F=A[P+1].map($=>$*Kn);L.startsWith("top")?F[1]-=7:L.startsWith("bottom")&&(F[1]+=7),D[P+1]=F}return new Pr(D)}const S=g.get("text-variable-anchor");if(S){let A;A=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(t,{},a)*Kn,_y]:g.get("text-offset").evaluate(t,{},a).map(P=>P*Kn);const D=[];for(const P of S)D.push(P,Lh(P,A));return new Pr(D)}return null}function by(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uv(s,t,a,h,g,x,S,A,D,P,L,F){let $=x.textMaxSize.evaluate(t,{});$===void 0&&($=S);const H=s.layers[0].layout,X=H.get("icon-offset").evaluate(t,{},L),ee=b0(a.horizontal),se=S/24,de=s.tilePixelRatio*se,ke=s.tilePixelRatio*$/24,ve=s.tilePixelRatio*A,Se=s.tilePixelRatio*H.get("symbol-spacing"),Be=H.get("text-padding")*s.tilePixelRatio,Qe=function(Qt,Ft,Nt,En=1){const Ni=Qt.get("icon-padding").evaluate(Ft,{},Nt),Vi=Ni&&Ni.values;return[Vi[0]*En,Vi[1]*En,Vi[2]*En,Vi[3]*En]}(H,t,L,s.tilePixelRatio),lt=H.get("text-max-angle")/180*Math.PI,Tt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",mt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",wt=H.get("symbol-placement"),jt=Se/2,xt=H.get("icon-text-fit");let yt;h&&xt!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(yt=Ko(h,a.vertical,xt,H.get("icon-text-fit-padding"),X,se)),ee&&(h=Ko(h,ee,xt,H.get("icon-text-fit-padding"),X,se)));const nt=L?F.line.getGranularityForZoomLevel(L.z):1,Gt=(Qt,Ft)=>{Ft.x<0||Ft.x>=It||Ft.y<0||Ft.y>=It||function(Nt,En,Ni,Vi,na,ys,ia,Ar,zi,er,hr,Mr,Cr,Ya,tr,Aa,_r,nr,r,u,p,w,M,N,q){const ie=Nt.addToLineVertexArray(En,Ni);let we,Ze,st,ut,We=0,Ke=0,cn=0,rn=0,ci=-1,ze=-1;const Ce={};let $e=dc("");if(Nt.allowVerticalPlacement&&Vi.vertical){const qa=Ar.layout.get("text-rotate").evaluate(p,{},N)+90;st=new xu(zi,En,er,hr,Mr,Vi.vertical,Cr,Ya,tr,qa),ia&&(ut=new xu(zi,En,er,hr,Mr,ia,_r,nr,tr,qa))}if(na){const qa=Ar.layout.get("icon-rotate").evaluate(p,{}),Jo=Ar.layout.get("icon-text-fit")!=="none",rp=y0(na,qa,M,Jo),Mc=ia?y0(ia,qa,M,Jo):void 0;Ze=new xu(zi,En,er,hr,Mr,na,_r,nr,!1,qa),We=4*rp.length;const ap=Nt.iconSizeData;let Eu=null;ap.kind==="source"?(Eu=[Os*Ar.layout.get("icon-size").evaluate(p,{})],Eu[0]>yu&&Wn(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ap.kind==="composite"&&(Eu=[Os*w.compositeIconSizes[0].evaluate(p,{},N),Os*w.compositeIconSizes[1].evaluate(p,{},N)],(Eu[0]>yu||Eu[1]>yu)&&Wn(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,rp,Eu,u,r,p,v.ao.none,En,ie.lineStartIndex,ie.lineLength,-1,N),ci=Nt.icon.placedSymbolArray.length-1,Mc&&(Ke=4*Mc.length,Nt.addSymbols(Nt.icon,Mc,Eu,u,r,p,v.ao.vertical,En,ie.lineStartIndex,ie.lineLength,-1,N),ze=Nt.icon.placedSymbolArray.length-1)}const ct=Object.keys(Vi.horizontal);for(const qa of ct){const Jo=Vi.horizontal[qa];if(!we){$e=dc(Jo.text);const Mc=Ar.layout.get("text-rotate").evaluate(p,{},N);we=new xu(zi,En,er,hr,Mr,Jo,Cr,Ya,tr,Mc)}const rp=Jo.positionedLines.length===1;if(cn+=v0(Nt,En,Jo,ys,Ar,tr,p,Aa,ie,Vi.vertical?v.ao.horizontal:v.ao.horizontalOnly,rp?ct:[qa],Ce,ci,w,N),rp)break}Vi.vertical&&(rn+=v0(Nt,En,Vi.vertical,ys,Ar,tr,p,Aa,ie,v.ao.vertical,["vertical"],Ce,ze,w,N));const Zt=we?we.boxStartIndex:Nt.collisionBoxArray.length,In=we?we.boxEndIndex:Nt.collisionBoxArray.length,Kt=st?st.boxStartIndex:Nt.collisionBoxArray.length,ln=st?st.boxEndIndex:Nt.collisionBoxArray.length,ra=Ze?Ze.boxStartIndex:Nt.collisionBoxArray.length,Jn=Ze?Ze.boxEndIndex:Nt.collisionBoxArray.length,Su=ut?ut.boxStartIndex:Nt.collisionBoxArray.length,Gv=ut?ut.boxEndIndex:Nt.collisionBoxArray.length;let Ac=-1;const T0=(qa,Jo)=>qa&&qa.circleDiameter?Math.max(qa.circleDiameter,Jo):Jo;Ac=T0(we,Ac),Ac=T0(st,Ac),Ac=T0(Ze,Ac),Ac=T0(ut,Ac);const Qx=Ac>-1?1:0;Qx&&(Ac*=q/Kn),Nt.glyphOffsetArray.length>=Hd.MAX_GLYPHS&&Wn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),p.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,p.sortKey);const fE=vy(Ar,p,N),[pE,mE]=function(qa,Jo){const rp=qa.length,Mc=Jo?.values;if(Mc?.length>0)for(let ap=0;ap<Mc.length;ap+=2){const Eu=Mc[ap+1];qa.emplaceBack(v.aE[Mc[ap]],Eu[0],Eu[1])}return[rp,qa.length]}(Nt.textAnchorOffsets,fE);Nt.symbolInstances.emplaceBack(En.x,En.y,Ce.right>=0?Ce.right:-1,Ce.center>=0?Ce.center:-1,Ce.left>=0?Ce.left:-1,Ce.vertical||-1,ci,ze,$e,Zt,In,Kt,ln,ra,Jn,Su,Gv,er,cn,rn,We,Ke,Qx,0,Cr,Ac,pE,mE)}(s,Ft,Qt,a,h,g,yt,s.layers[0],s.collisionBoxArray,t.index,t.sourceLayerIndex,s.index,de,[Be,Be,Be,Be],Tt,D,ve,Qe,mt,X,t,x,P,L,S)};if(wt==="line")for(const Qt of gy(t.geometry,0,0,It,It)){const Ft=ds(Qt,nt),Nt=Fv(Ft,Se,lt,a.vertical||ee,h,24,ke,s.overscaling,It);for(const En of Nt)ee&&Vv(s,ee.text,jt,En)||Gt(Ft,En)}else if(wt==="line-center"){for(const Qt of t.geometry)if(Qt.length>1){const Ft=ds(Qt,nt),Nt=Bv(Ft,lt,a.vertical||ee,h,24,ke);Nt&&Gt(Ft,Nt)}}else if(t.type==="Polygon")for(const Qt of Yc(t.geometry,0)){const Ft=_0(Qt,16);Gt(ds(Qt[0],nt,!0),new bu(Ft.x,Ft.y,0))}else if(t.type==="LineString")for(const Qt of t.geometry){const Ft=ds(Qt,nt);Gt(Ft,new bu(Ft[0].x,Ft[0].y,0))}else if(t.type==="Point")for(const Qt of t.geometry)for(const Ft of Qt)Gt([Ft],new bu(Ft.x,Ft.y,0))}function v0(s,t,a,h,g,x,S,A,D,P,L,F,$,H,X){const ee=function(ke,ve,Se,Be,Qe,lt,Tt,mt){const wt=Be.layout.get("text-rotate").evaluate(lt,{})*Math.PI/180,jt=[];for(const xt of ve.positionedLines)for(const yt of xt.positionedGlyphs){if(!yt.rect)continue;const nt=yt.rect||{};let Gt=4,Qt=!0,Ft=1,Nt=0;const En=(Qe||mt)&&yt.vertical,Ni=yt.metrics.advance*yt.scale/2;if(mt&&ve.verticalizable&&(Nt=xt.lineOffset/2-(yt.imageName?-(Kn-yt.metrics.width*yt.scale)/2:(yt.scale-1)*Kn)),yt.imageName){const nr=Tt[yt.imageName];Qt=nr.sdf,Ft=nr.pixelRatio,Gt=1/Ft}const Vi=Qe?[yt.x+Ni,yt.y]:[0,0];let na=Qe?[0,0]:[yt.x+Ni+Se[0],yt.y+Se[1]-Nt],ys=[0,0];En&&(ys=na,na=[0,0]);const ia=yt.metrics.isDoubleResolution?2:1,Ar=(yt.metrics.left-Gt)*yt.scale-Ni+na[0],zi=(-yt.metrics.top-Gt)*yt.scale+na[1],er=Ar+nt.w/ia*yt.scale/Ft,hr=zi+nt.h/ia*yt.scale/Ft,Mr=new C(Ar,zi),Cr=new C(er,zi),Ya=new C(Ar,hr),tr=new C(er,hr);if(En){const nr=new C(-Ni,Ni- -17),r=-Math.PI/2,u=12-Ni,p=new C(22-u,-(yt.imageName?u:0)),w=new C(...ys);Mr._rotateAround(r,nr)._add(p)._add(w),Cr._rotateAround(r,nr)._add(p)._add(w),Ya._rotateAround(r,nr)._add(p)._add(w),tr._rotateAround(r,nr)._add(p)._add(w)}if(wt){const nr=Math.sin(wt),r=Math.cos(wt),u=[r,-nr,nr,r];Mr._matMult(u),Cr._matMult(u),Ya._matMult(u),tr._matMult(u)}const Aa=new C(0,0),_r=new C(0,0);jt.push({tl:Mr,tr:Cr,bl:Ya,br:tr,tex:nt,writingMode:ve.writingMode,glyphOffset:Vi,sectionIndex:yt.sectionIndex,isSDF:Qt,pixelOffsetTL:Aa,pixelOffsetBR:_r,minFontScaleX:0,minFontScaleY:0})}return jt}(0,a,A,g,x,S,h,s.allowVerticalPlacement),se=s.textSizeData;let de=null;se.kind==="source"?(de=[Os*g.layout.get("text-size").evaluate(S,{})],de[0]>yu&&Wn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):se.kind==="composite"&&(de=[Os*H.compositeTextSizes[0].evaluate(S,{},X),Os*H.compositeTextSizes[1].evaluate(S,{},X)],(de[0]>yu||de[1]>yu)&&Wn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,ee,de,A,x,S,P,t,D.lineStartIndex,D.lineLength,$,X);for(const ke of L)F[ke]=s.text.placedSymbolArray.length-1;return 4*ee.length}function b0(s){for(const t in s)return s[t];return null}function Vv(s,t,a,h){const g=s.compareText;if(t in g){const x=g[t];for(let S=x.length-1;S>=0;S--)if(h.dist(x[S])<a)return!0}else g[t]=[];return g[t].push(h),!1}const x0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xy{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,h]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=x0[15&h];if(!x)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(t,2,1),[A]=new Uint32Array(t,4,1);return new xy(A,S,x,t)}constructor(t,a=64,h=Float64Array,g){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=h,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const x=x0.indexOf(this.ArrayType),S=2*t*this.ArrayType.BYTES_PER_ELEMENT,A=t*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-A%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+D,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+S+A+D),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+D,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=t,this.coords[this._pos++]=a,h}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Om(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:S,nodeSize:A}=this,D=[0,x.length-1,0],P=[];for(;D.length;){const L=D.pop()||0,F=D.pop()||0,$=D.pop()||0;if(F-$<=A){for(let se=$;se<=F;se++){const de=S[2*se],ke=S[2*se+1];de>=t&&de<=h&&ke>=a&&ke<=g&&P.push(x[se])}continue}const H=$+F>>1,X=S[2*H],ee=S[2*H+1];X>=t&&X<=h&&ee>=a&&ee<=g&&P.push(x[H]),(L===0?t<=X:a<=ee)&&(D.push($),D.push(H-1),D.push(1-L)),(L===0?h>=X:g>=ee)&&(D.push(H+1),D.push(F),D.push(1-L))}return P}within(t,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:S}=this,A=[0,g.length-1,0],D=[],P=h*h;for(;A.length;){const L=A.pop()||0,F=A.pop()||0,$=A.pop()||0;if(F-$<=S){for(let se=$;se<=F;se++)w0(x[2*se],x[2*se+1],t,a)<=P&&D.push(g[se]);continue}const H=$+F>>1,X=x[2*H],ee=x[2*H+1];w0(X,ee,t,a)<=P&&D.push(g[H]),(L===0?t-h<=X:a-h<=ee)&&(A.push($),A.push(H-1),A.push(1-L)),(L===0?t+h>=X:a+h>=ee)&&(A.push(H+1),A.push(F),A.push(1-L))}return D}}function Om(s,t,a,h,g,x){if(g-h<=a)return;const S=h+g>>1;Oh(s,t,S,h,g,x),Om(s,t,a,h,S-1,1-x),Om(s,t,a,S+1,g,1-x)}function Oh(s,t,a,h,g,x){for(;g>h;){if(g-h>600){const P=g-h+1,L=a-h+1,F=Math.log(P),$=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*$*(P-$)/P)*(L-P/2<0?-1:1);Oh(s,t,a,Math.max(h,Math.floor(a-L*$/P+H)),Math.min(g,Math.floor(a+(P-L)*$/P+H)),x)}const S=t[2*a+x];let A=h,D=g;for(Ec(s,t,h,a),t[2*g+x]>S&&Ec(s,t,h,g);A<D;){for(Ec(s,t,A,D),A++,D--;t[2*A+x]<S;)A++;for(;t[2*D+x]>S;)D--}t[2*h+x]===S?Ec(s,t,h,D):(D++,Ec(s,t,D,g)),D<=a&&(h=D+1),a<=D&&(g=D-1)}}function Ec(s,t,a,h){jm(s,a,h),jm(t,2*a,2*h),jm(t,2*a+1,2*h+1)}function jm(s,t,a){const h=s[t];s[t]=s[a],s[a]=h}function w0(s,t,a,h){const g=s-a,x=t-h;return g*g+x*x}var wu;v.cx=void 0,(wu=v.cx||(v.cx={})).create="create",wu.load="load",wu.fullLoad="fullLoad";let Tu=null,Kd=[];const Jd=1e3/60,np="loadTime",ip="fullLoadTime",Bm={mark(s){performance.mark(s)},frame(s){const t=s;Tu!=null&&Kd.push(t-Tu),Tu=t},clearMetrics(){Tu=null,Kd=[],performance.clearMeasures(np),performance.clearMeasures(ip);for(const s in v.cx)performance.clearMarks(v.cx[s])},getPerformanceMetrics(){performance.measure(np,v.cx.create,v.cx.load),performance.measure(ip,v.cx.create,v.cx.fullLoad);const s=performance.getEntriesByName(np)[0].duration,t=performance.getEntriesByName(ip)[0].duration,a=Kd.length,h=1/(Kd.reduce((x,S)=>x+S,0)/a/1e3),g=Kd.filter(x=>x>Jd).reduce((x,S)=>x+(S-Jd)/Jd,0);return{loadTime:s,fullLoadTime:t,fps:h,percentDroppedFrames:g/(a+g)*100,totalFrames:a}}};v.$=It,v.A=je,v.B=function([s,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:s*Math.cos(t)*Math.sin(a),y:s*Math.sin(t)*Math.sin(a),z:s*Math.cos(a)}},v.C=ho,v.D=zt,v.E=Lt,v.F=Hn,v.G=Ds,v.H=function(s){if(Li==null){const t=s.navigator?s.navigator.userAgent:null;Li=!!s.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Li},v.I=mu,v.J=class{constructor(s,t){this.target=s,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new uy(()=>this.process()),this.subscription=Ja(this.target,"message",a=>this.receive(a),!1),this.globalScope=Br(self)?s:window}registerMessageHandler(s,t){this.messageHandlers[s]=t}sendAsync(s,t){return new Promise((a,h)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=t?Ja(t.signal,"abort",()=>{x?.unsubscribe(),delete this.resolveRejects[g];const D={id:g,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(D)},Jf):null;this.resolveRejects[g]={resolve:D=>{x?.unsubscribe(),a(D)},reject:D=>{x?.unsubscribe(),h(D)}};const S=[],A=Object.assign(Object.assign({},s),{id:g,sourceMapId:this.mapId,origin:location.origin,data:oc(s.data,S)});this.target.postMessage(A,{transfer:S})})}receive(s){const t=s.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const h=this.abortControllers[a];return delete this.abortControllers[a],void(h&&h.abort())}if(Br(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),t=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(s,t)}processTask(s,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const g=this.resolveRejects[s];return delete this.resolveRejects[s],g?void(t.error?g.reject(ks(t.error)):g.resolve(ks(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=ks(t.data),h=new AbortController;this.abortControllers[s]=h;try{const g=yield this.messageHandlers[t.type](t.sourceMapId,a,h);this.completeTask(s,null,g)}catch(g){this.completeTask(s,g)}})}completeTask(s,t,a){const h=[];delete this.abortControllers[s];const g={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?oc(t):null,data:oc(a,h)};this.target.postMessage(g,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.K=ae,v.L=function(){var s=new je(16);return je!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},v.M=function(s,t,a){var h,g,x,S,A,D,P,L,F,$,H,X,ee=a[0],se=a[1],de=a[2];return t===s?(s[12]=t[0]*ee+t[4]*se+t[8]*de+t[12],s[13]=t[1]*ee+t[5]*se+t[9]*de+t[13],s[14]=t[2]*ee+t[6]*se+t[10]*de+t[14],s[15]=t[3]*ee+t[7]*se+t[11]*de+t[15]):(g=t[1],x=t[2],S=t[3],A=t[4],D=t[5],P=t[6],L=t[7],F=t[8],$=t[9],H=t[10],X=t[11],s[0]=h=t[0],s[1]=g,s[2]=x,s[3]=S,s[4]=A,s[5]=D,s[6]=P,s[7]=L,s[8]=F,s[9]=$,s[10]=H,s[11]=X,s[12]=h*ee+A*se+F*de+t[12],s[13]=g*ee+D*se+$*de+t[13],s[14]=x*ee+P*se+H*de+t[14],s[15]=S*ee+L*se+X*de+t[15]),s},v.N=function(s,t,a){var h=a[0],g=a[1],x=a[2];return s[0]=t[0]*h,s[1]=t[1]*h,s[2]=t[2]*h,s[3]=t[3]*h,s[4]=t[4]*g,s[5]=t[5]*g,s[6]=t[6]*g,s[7]=t[7]*g,s[8]=t[8]*x,s[9]=t[9]*x,s[10]=t[10]*x,s[11]=t[11]*x,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},v.O=function(s,t,a){var h=t[0],g=t[1],x=t[2],S=t[3],A=t[4],D=t[5],P=t[6],L=t[7],F=t[8],$=t[9],H=t[10],X=t[11],ee=t[12],se=t[13],de=t[14],ke=t[15],ve=a[0],Se=a[1],Be=a[2],Qe=a[3];return s[0]=ve*h+Se*A+Be*F+Qe*ee,s[1]=ve*g+Se*D+Be*$+Qe*se,s[2]=ve*x+Se*P+Be*H+Qe*de,s[3]=ve*S+Se*L+Be*X+Qe*ke,s[4]=(ve=a[4])*h+(Se=a[5])*A+(Be=a[6])*F+(Qe=a[7])*ee,s[5]=ve*g+Se*D+Be*$+Qe*se,s[6]=ve*x+Se*P+Be*H+Qe*de,s[7]=ve*S+Se*L+Be*X+Qe*ke,s[8]=(ve=a[8])*h+(Se=a[9])*A+(Be=a[10])*F+(Qe=a[11])*ee,s[9]=ve*g+Se*D+Be*$+Qe*se,s[10]=ve*x+Se*P+Be*H+Qe*de,s[11]=ve*S+Se*L+Be*X+Qe*ke,s[12]=(ve=a[12])*h+(Se=a[13])*A+(Be=a[14])*F+(Qe=a[15])*ee,s[13]=ve*g+Se*D+Be*$+Qe*se,s[14]=ve*x+Se*P+Be*H+Qe*de,s[15]=ve*S+Se*L+Be*X+Qe*ke,s},v.P=C,v.Q=function(s,t){const a={};for(let h=0;h<t.length;h++){const g=t[h];g in s&&(a[g]=s[g])}return a},v.R=wa,v.S=js,v.T=Id,v.U=dy,v.V=p0,v.W=pe,v.X=Ie,v.Y=oa,v.Z=$a,v._=c,v.a=K,v.a$=Ut,v.a0=function(s,t){var a,h,g,x,S;if(!s)return t??{};if(!t)return s;let A=Object.assign({},s);if(t.removeAll&&(A={removeAll:!0}),t.remove){const D=new Set(t.remove);A.add&&(A.add=A.add.filter(L=>!D.has(L.id))),A.update&&(A.update=A.update.filter(L=>!D.has(L.id)));const P=new Set(((a=s.add)!==null&&a!==void 0?a:[]).map(L=>L.id));t.remove=t.remove.filter(L=>!P.has(L))}if(t.remove){const D=new Set(A.remove?A.remove.concat(t.remove):t.remove);A.remove=Array.from(D.values())}if(t.add){const D=A.add?A.add.concat(t.add):t.add,P=new Map(D.map(L=>[L.id,L]));A.add=Array.from(P.values())}if(t.update){const D=new Map((h=A.update)===null||h===void 0?void 0:h.map(P=>[P.id,P]));for(const P of t.update){const L=(g=D.get(P.id))!==null&&g!==void 0?g:{id:P.id};P.newGeometry&&(L.newGeometry=P.newGeometry),P.addOrUpdateProperties&&(L.addOrUpdateProperties=((x=L.addOrUpdateProperties)!==null&&x!==void 0?x:[]).concat(P.addOrUpdateProperties)),P.removeProperties&&(L.removeProperties=((S=L.removeProperties)!==null&&S!==void 0?S:[]).concat(P.removeProperties)),P.removeAllProperties&&(L.removeAllProperties=!0),D.set(P.id,L)}A.update=Array.from(D.values())}return A.remove&&A.add&&(A.remove=A.remove.filter(D=>A.add.findIndex(P=>P.id===D)===-1)),A},v.a1=zh,v.a2=vu,v.a3=25,v.a4=py,v.a5=s=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const h of s){const g=window.document.createElement("source");Fe(h)||(t.crossOrigin="Anonymous"),g.src=h,t.appendChild(g)}})},v.a6=gt,v.a7=function(){return mi++},v.a8=Y,v.a9=Hd,v.aA=function(s){let t=1/0,a=1/0,h=-1/0,g=-1/0;for(const x of s)t=Math.min(t,x.x),a=Math.min(a,x.y),h=Math.max(h,x.x),g=Math.max(g,x.y);return[t,a,h,g]},v.aB=Kn,v.aC=be,v.aD=function(s,t,a,h,g=!1){if(!a[0]&&!a[1])return[0,0];const x=g?h==="map"?-s.bearingInRadians:0:h==="viewport"?s.bearingInRadians:0;if(x){const S=Math.sin(x),A=Math.cos(x);a=[a[0]*A-a[1]*S,a[0]*S+a[1]*A]}return[g?a[0]:be(t,a[0],s.zoom),g?a[1]:be(t,a[1],s.zoom)]},v.aF=Tm,v.aG=by,v.aH=ny,v.aI=xy,v.aJ=Ei,v.aK=Ta,v.aL=De,v.aM=on,v.aN=Fn,v.aO=wi,v.aP=Ss,v.aQ=di,v.aR=Xe,v.aS=Ne,v.aT=function(s){var t=new je(3);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t},v.aU=function(s,t,a){return s[0]=t[0]-a[0],s[1]=t[1]-a[1],s[2]=t[2]-a[2],s},v.aV=function(s,t){var a=t[0],h=t[1],g=t[2],x=a*a+h*h+g*g;return x>0&&(x=1/Math.sqrt(x)),s[0]=t[0]*x,s[1]=t[1]*x,s[2]=t[2]*x,s},v.aW=_t,v.aX=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]},v.aY=function(s,t,a){return s[0]=t[0]*a[0],s[1]=t[1]*a[1],s[2]=t[2]*a[2],s[3]=t[3]*a[3],s},v.aZ=Je,v.a_=function(s,t,a){const h=t[0]*a[0]+t[1]*a[1]+t[2]*a[2];return h===0?null:(-(s[0]*a[0]+s[1]*a[1]+s[2]*a[2])-a[3])/h},v.aa=_l,v.ab=pc,v.ac=Im,v.ad=function(s){const t={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,g,x)=>{const S=g||x;return t[h]=!S||S.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},v.ae=Ts,v.af=function(s){return Math.pow(2,s)},v.ag=Ve,v.ah=Bt,v.ai=85.051129,v.aj=fy,v.ak=function(s){return Math.log(s)/Math.LN2},v.al=function(s){var t=s[0],a=s[1];return t*t+a*a},v.am=function(s,t){const a=[];for(const h in s)h in t||a.push(h);return a},v.an=function(s,t){let a=0,h=0;if(s.kind==="constant")h=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:S}=s,A=g?Bt(zr.interpolationFactor(g,t,x,S),0,1):0;s.kind==="camera"?h=ho.number(s.minSize,s.maxSize,A):a=A}return{uSizeT:a,uSize:h}},v.ap=function(s,{uSize:t,uSizeT:a},{lowerSize:h,upperSize:g}){return s.kind==="source"?h/Os:s.kind==="composite"?ho.number(h/Os,g/Os,a):t},v.aq=function(s,t){var a=t[0],h=t[1],g=t[2],x=t[3],S=t[4],A=t[5],D=t[6],P=t[7],L=t[8],F=t[9],$=t[10],H=t[11],X=t[12],ee=t[13],se=t[14],de=t[15],ke=a*A-h*S,ve=a*D-g*S,Se=a*P-x*S,Be=h*D-g*A,Qe=h*P-x*A,lt=g*P-x*D,Tt=L*ee-F*X,mt=L*se-$*X,wt=L*de-H*X,jt=F*se-$*ee,xt=F*de-H*ee,yt=$*de-H*se,nt=ke*yt-ve*xt+Se*jt+Be*wt-Qe*mt+lt*Tt;return nt?(s[0]=(A*yt-D*xt+P*jt)*(nt=1/nt),s[1]=(g*xt-h*yt-x*jt)*nt,s[2]=(ee*lt-se*Qe+de*Be)*nt,s[3]=($*Qe-F*lt-H*Be)*nt,s[4]=(D*wt-S*yt-P*mt)*nt,s[5]=(a*yt-g*wt+x*mt)*nt,s[6]=(se*Se-X*lt-de*ve)*nt,s[7]=(L*lt-$*Se+H*ve)*nt,s[8]=(S*xt-A*wt+P*Tt)*nt,s[9]=(h*wt-a*xt-x*Tt)*nt,s[10]=(X*Qe-ee*Se+de*ke)*nt,s[11]=(F*Se-L*Qe-H*ke)*nt,s[12]=(A*mt-S*jt-D*Tt)*nt,s[13]=(a*jt-h*mt+g*Tt)*nt,s[14]=(ee*ve-X*Be-se*ke)*nt,s[15]=(L*Be-F*ve+$*ke)*nt,s):null},v.ar=ft,v.as=function(s){var t=s[0],a=s[1];return Math.sqrt(t*t+a*a)},v.at=function(s){return s[0]=0,s[1]=0,s},v.au=function(s,t,a){return s[0]=t[0]*a,s[1]=t[1]*a,s},v.av=sy,v.aw=un,v.ax=function(s,t,a,h){const g=t.y-s.y,x=t.x-s.x,S=h.y-a.y,A=h.x-a.x,D=S*x-A*g;if(D===0)return null;const P=(A*(s.y-a.y)-S*(s.x-a.x))/D;return new C(s.x+P*x,s.y+P*g)},v.ay=gy,v.az=hu,v.b=Ka,v.b$=class extends e{},v.b0=function(s,t,a){return s[0]=t[0]*a,s[1]=t[1]*a,s[2]=t[2]*a,s[3]=t[3]*a,s},v.b1=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]+s[3]},v.b2=km,v.b3=Tc,v.b4=function(s,t,a,h,g){var x=1/Math.tan(t/2);if(s[0]=x/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,g!=null&&g!==1/0){var S=1/(h-g);s[10]=(g+h)*S,s[14]=2*g*h*S}else s[10]=-1,s[14]=-2*h;return s},v.b5=function(s){var t=new je(16);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],t},v.b6=function(s,t,a){var h=Math.sin(a),g=Math.cos(a),x=t[0],S=t[1],A=t[2],D=t[3],P=t[4],L=t[5],F=t[6],$=t[7];return t!==s&&(s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=x*g+P*h,s[1]=S*g+L*h,s[2]=A*g+F*h,s[3]=D*g+$*h,s[4]=P*g-x*h,s[5]=L*g-S*h,s[6]=F*g-A*h,s[7]=$*g-D*h,s},v.b7=function(s,t,a){var h=Math.sin(a),g=Math.cos(a),x=t[4],S=t[5],A=t[6],D=t[7],P=t[8],L=t[9],F=t[10],$=t[11];return t!==s&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[4]=x*g+P*h,s[5]=S*g+L*h,s[6]=A*g+F*h,s[7]=D*g+$*h,s[8]=P*g-x*h,s[9]=L*g-S*h,s[10]=F*g-A*h,s[11]=$*g-D*h,s},v.b8=function(){const s=new Float32Array(16);return Ve(s),s},v.b9=function(){const s=new Float64Array(16);return Ve(s),s},v.bA=function(s,t){const a=et(s,360),h=et(t,360),g=h-a,x=h>a?g-360:g+360;return Math.abs(g)<Math.abs(x)?g:x},v.bB=function(s){return s[0]=0,s[1]=0,s[2]=0,s},v.bC=function(s,t,a,h){const g=Math.sqrt(s*s+t*t),x=Math.sqrt(a*a+h*h);s/=g,t/=g,a/=x,h/=x;const S=Math.acos(s*a+t*h);return-t*a+s*h>0?S:-S},v.bD=function(s,t){const a=et(s,2*Math.PI),h=et(t,2*Math.PI);return Math.min(Math.abs(a-h),Math.abs(a-h+2*Math.PI),Math.abs(a-h-2*Math.PI))},v.bE=function(){const s={},t=Pe.$version;for(const a in Pe.$root){const h=Pe.$root[a];if(h.required){let g=null;g=a==="version"?t:h.type==="array"?[]:{},g!=null&&(s[a]=g)}}return s},v.bF=yh,v.bG=Te,v.bH=function s(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let h=0;h<t.length;h++)if(!s(t[h],a[h]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const h in t)if(!s(t[h],a[h]))return!1;return!0}return t===a},v.bI=function(s){s=s.slice();const t=Object.create(null);for(let a=0;a<s.length;a++)t[s[a].id]=s[a];for(let a=0;a<s.length;a++)"ref"in s[a]&&(s[a]=vn(s[a],t[s[a].ref]));return s},v.bJ=function(s,t){if(s.type==="custom")return new d0(s,t);switch(s.type){case"background":return new On(s,t);case"circle":return new G_(s,t);case"color-relief":return new Rv(s,t);case"fill":return new Gf(s,t);case"fill-extrusion":return new Yg(s,t);case"heatmap":return new mc(s,t);case"hillshade":return new Z_(s,t);case"line":return new ma(s,t);case"raster":return new cy(s,t);case"symbol":return new _u(s,t)}},v.bK=rr,v.bL=function(s,t){if(!s)return[{command:"setStyle",args:[t]}];let a=[];try{if(!Vt(s.version,t.version))return[{command:"setStyle",args:[t]}];Vt(s.center,t.center)||a.push({command:"setCenter",args:[t.center]}),Vt(s.state,t.state)||a.push({command:"setGlobalState",args:[t.state]}),Vt(s.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Vt(s.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),Vt(s.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),Vt(s.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),Vt(s.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),Vt(s.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),Vt(s.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),Vt(s.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),Vt(s.light,t.light)||a.push({command:"setLight",args:[t.light]}),Vt(s.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),Vt(s.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),Vt(s.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const h={},g=[];(function(S,A,D,P){let L;for(L in A=A||{},S=S||{})Object.prototype.hasOwnProperty.call(S,L)&&(Object.prototype.hasOwnProperty.call(A,L)||ar(L,D,P));for(L in A)Object.prototype.hasOwnProperty.call(A,L)&&(Object.prototype.hasOwnProperty.call(S,L)?Vt(S[L],A[L])||(S[L].type==="geojson"&&A[L].type==="geojson"&&ai(S,A,L)?sn(D,{command:"setGeoJSONSourceData",args:[L,A[L].data]}):dr(L,A,D,P)):ni(L,A,D))})(s.sources,t.sources,g,h);const x=[];s.layers&&s.layers.forEach(S=>{"source"in S&&h[S.source]?a.push({command:"removeLayer",args:[S.id]}):x.push(S)}),a=a.concat(g),function(S,A,D){A=A||[];const P=(S=S||[]).map(tn),L=A.map(tn),F=S.reduce(Ti,{}),$=A.reduce(Ti,{}),H=P.slice(),X=Object.create(null);let ee,se,de,ke,ve;for(let Se=0,Be=0;Se<P.length;Se++)ee=P[Se],Object.prototype.hasOwnProperty.call($,ee)?Be++:(sn(D,{command:"removeLayer",args:[ee]}),H.splice(H.indexOf(ee,Be),1));for(let Se=0,Be=0;Se<L.length;Se++)ee=L[L.length-1-Se],H[H.length-1-Se]!==ee&&(Object.prototype.hasOwnProperty.call(F,ee)?(sn(D,{command:"removeLayer",args:[ee]}),H.splice(H.lastIndexOf(ee,H.length-Be),1)):Be++,ke=H[H.length-Se],sn(D,{command:"addLayer",args:[$[ee],ke]}),H.splice(H.length-Se,0,ee),X[ee]=!0);for(let Se=0;Se<L.length;Se++)if(ee=L[Se],se=F[ee],de=$[ee],!X[ee]&&!Vt(se,de))if(Vt(se.source,de.source)&&Vt(se["source-layer"],de["source-layer"])&&Vt(se.type,de.type)){for(ve in Wt(se.layout,de.layout,D,ee,null,"setLayoutProperty"),Wt(se.paint,de.paint,D,ee,null,"setPaintProperty"),Vt(se.filter,de.filter)||sn(D,{command:"setFilter",args:[ee,de.filter]}),Vt(se.minzoom,de.minzoom)&&Vt(se.maxzoom,de.maxzoom)||sn(D,{command:"setLayerZoomRange",args:[ee,de.minzoom,de.maxzoom]}),se)Object.prototype.hasOwnProperty.call(se,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Wt(se[ve],de[ve],D,ee,ve.slice(6),"setPaintProperty"):Vt(se[ve],de[ve])||sn(D,{command:"setLayerProperty",args:[ee,ve,de[ve]]}));for(ve in de)Object.prototype.hasOwnProperty.call(de,ve)&&!Object.prototype.hasOwnProperty.call(se,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Wt(se[ve],de[ve],D,ee,ve.slice(6),"setPaintProperty"):Vt(se[ve],de[ve])||sn(D,{command:"setLayerProperty",args:[ee,ve,de[ve]]}))}else sn(D,{command:"removeLayer",args:[ee]}),ke=H[H.lastIndexOf(ee)+1],sn(D,{command:"addLayer",args:[de,ke]})}(x,t.layers,a)}catch(h){console.warn("Unable to compute style diff:",h),a=[{command:"setStyle",args:[t]}]}return a},v.bM=function(s){const t=[],a=s.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},v.bN=ya,v.bO=sa,v.bP=class extends Ga{constructor(s,t){super(s,t),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},v.bQ=Kr,v.bR=class extends Ga{constructor(s,t){super(s,t),this.current=Yi}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let t=1;t<16;t++)if(s[t]!==this.current[t]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},v.bS=Ui,v.bT=class extends Ga{constructor(s,t){super(s,t),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},v.bU=class extends Ga{constructor(s,t){super(s,t),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},v.bV=He,v.bW=function(s,t){var a=Math.sin(t),h=Math.cos(t);return s[0]=h,s[1]=a,s[2]=0,s[3]=-a,s[4]=h,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},v.bX=function(s,t,a){var h=t[0],g=t[1],x=t[2];return s[0]=h*a[0]+g*a[3]+x*a[6],s[1]=h*a[1]+g*a[4]+x*a[7],s[2]=h*a[2]+g*a[5]+x*a[8],s},v.bY=function(s,t,a,h,g,x,S){var A=1/(t-a),D=1/(h-g),P=1/(x-S);return s[0]=-2*A,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*D,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(t+a)*A,s[13]=(g+h)*D,s[14]=(S+x)*P,s[15]=1,s},v.bZ=class extends Ga{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(4*s.length);for(let a=0;a<s.length;a++)t[4*a]=s[a].r,t[4*a+1]=s[a].g,t[4*a+2]=s[a].b,t[4*a+3]=s[a].a;this.gl.uniform4fv(this.location,t)}}},v.b_=class extends Ga{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(s);this.gl.uniform1fv(this.location,t)}}},v.ba=function(){return new Float64Array(16)},v.bb=function(s,t,a){const h=new Float64Array(4);return Ue(h,s,t-90,a),h},v.bc=function(s,t,a,h){var g,x,S,A,D,P=t[0],L=t[1],F=t[2],$=t[3],H=a[0],X=a[1],ee=a[2],se=a[3];return(x=P*H+L*X+F*ee+$*se)<0&&(x=-x,H=-H,X=-X,ee=-ee,se=-se),1-x>Ge?(g=Math.acos(x),S=Math.sin(g),A=Math.sin((1-h)*g)/S,D=Math.sin(h*g)/S):(A=1-h,D=h),s[0]=A*P+D*H,s[1]=A*L+D*X,s[2]=A*F+D*ee,s[3]=A*$+D*se,s},v.bd=function(s){const t=new Float64Array(9);var a,h,g,x,S,A,D,P,L,F,$,H,X,ee,se,de,ke,ve;F=(g=(h=s)[0])*(D=g+g),$=(x=h[1])*D,X=(S=h[2])*D,ee=S*(P=x+x),de=(A=h[3])*D,ke=A*P,ve=A*(L=S+S),(a=t)[0]=1-(H=x*P)-(se=S*L),a[3]=$-ve,a[6]=X+ke,a[1]=$+ve,a[4]=1-F-se,a[7]=ee-de,a[2]=X-ke,a[5]=ee+de,a[8]=1-F-H;const Se=Ss(-Math.asin(Bt(t[2],-1,1)));let Be,Qe;return Math.hypot(t[5],t[8])<.001?(Be=0,Qe=-Ss(Math.atan2(t[3],t[4]))):(Be=Ss(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Qe=Ss(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Be,pitch:Se+90,bearing:Qe}},v.be=function(s,t){return s.roll==t.roll&&s.pitch==t.pitch&&s.bearing==t.bearing},v.bf=gn,v.bg=ui,v.bh=Sa,v.bi=Ld,v.bj=fu,v.bk=Et,v.bl=bt,v.bm=Fi,v.bn=function(s,t,a,h,g){return Et(h,g,Bt((s-t)/(a-t),0,1))},v.bo=et,v.bp=function(){return new Float64Array(3)},v.bq=function(s,t,a,h){return s[0]=t[0]+a[0]*h,s[1]=t[1]+a[1]*h,s[2]=t[2]+a[2]*h,s},v.br=Ue,v.bs=function(s,t,a){var h=a[0],g=a[1],x=a[2],S=a[3],A=t[0],D=t[1],P=t[2],L=g*P-x*D,F=x*A-h*P,$=h*D-g*A;return s[0]=A+S*(L+=L)+g*($+=$)-x*(F+=F),s[1]=D+S*F+x*L-h*$,s[2]=P+S*$+h*F-g*L,s},v.bt=function(s,t,a){const h=(g=[s[0],s[1],s[2],t[0],t[1],t[2],a[0],a[1],a[2]])[0]*((L=g[8])*(S=g[4])-(A=g[5])*(P=g[7]))+g[1]*(-L*(x=g[3])+A*(D=g[6]))+g[2]*(P*x-S*D);var g,x,S,A,D,P,L;if(h===0)return null;const F=_t([],[t[0],t[1],t[2]],[a[0],a[1],a[2]]),$=_t([],[a[0],a[1],a[2]],[s[0],s[1],s[2]]),H=_t([],[s[0],s[1],s[2]],[t[0],t[1],t[2]]),X=Xe([],F,-s[3]);return Ne(X,X,Xe([],$,-t[3])),Ne(X,X,Xe([],H,-a[3])),Xe(X,X,1/h),X},v.bu=Xd,v.bv=function(){return new Float64Array(4)},v.bw=function(s,t,a,h){var g=[],x=[];return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],x[0]=g[0]*Math.cos(h)-g[1]*Math.sin(h),x[1]=g[0]*Math.sin(h)+g[1]*Math.cos(h),x[2]=g[2],s[0]=x[0]+a[0],s[1]=x[1]+a[1],s[2]=x[2]+a[2],s},v.bx=function(s,t,a,h){var g=[],x=[];return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],x[0]=g[0],x[1]=g[1]*Math.cos(h)-g[2]*Math.sin(h),x[2]=g[1]*Math.sin(h)+g[2]*Math.cos(h),s[0]=x[0]+a[0],s[1]=x[1]+a[1],s[2]=x[2]+a[2],s},v.by=function(s,t,a,h){var g=[],x=[];return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],x[0]=g[2]*Math.sin(h)+g[0]*Math.cos(h),x[1]=g[1],x[2]=g[2]*Math.cos(h)-g[0]*Math.sin(h),s[0]=x[0]+a[0],s[1]=x[1]+a[1],s[2]=x[2]+a[2],s},v.bz=function(s,t,a){var h=Math.sin(a),g=Math.cos(a),x=t[0],S=t[1],A=t[2],D=t[3],P=t[8],L=t[9],F=t[10],$=t[11];return t!==s&&(s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=x*g-P*h,s[1]=S*g-L*h,s[2]=A*g-F*h,s[3]=D*g-$*h,s[8]=x*h+P*g,s[9]=S*h+L*g,s[10]=A*h+F*g,s[11]=D*h+$*g,s},v.c=Ae,v.c0=e0,v.c1=class extends f{},v.c2=om,v.c3=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},v.c4=sm,v.c5=function(s,t,a){var h=t[0],g=t[1],x=t[2],S=a[3]*h+a[7]*g+a[11]*x+a[15];return s[0]=(a[0]*h+a[4]*g+a[8]*x+a[12])/(S=S||1),s[1]=(a[1]*h+a[5]*g+a[9]*x+a[13])/S,s[2]=(a[2]*h+a[6]*g+a[10]*x+a[14])/S,s},v.c6=class extends Ai{},v.c7=class extends j{},v.c8=function(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]&&s[4]===t[4]&&s[5]===t[5]&&s[6]===t[6]&&s[7]===t[7]&&s[8]===t[8]&&s[9]===t[9]&&s[10]===t[10]&&s[11]===t[11]&&s[12]===t[12]&&s[13]===t[13]&&s[14]===t[14]&&s[15]===t[15]},v.c9=function(s,t){var a=s[0],h=s[1],g=s[2],x=s[3],S=s[4],A=s[5],D=s[6],P=s[7],L=s[8],F=s[9],$=s[10],H=s[11],X=s[12],ee=s[13],se=s[14],de=s[15],ke=t[0],ve=t[1],Se=t[2],Be=t[3],Qe=t[4],lt=t[5],Tt=t[6],mt=t[7],wt=t[8],jt=t[9],xt=t[10],yt=t[11],nt=t[12],Gt=t[13],Qt=t[14],Ft=t[15];return Math.abs(a-ke)<=Ge*Math.max(1,Math.abs(a),Math.abs(ke))&&Math.abs(h-ve)<=Ge*Math.max(1,Math.abs(h),Math.abs(ve))&&Math.abs(g-Se)<=Ge*Math.max(1,Math.abs(g),Math.abs(Se))&&Math.abs(x-Be)<=Ge*Math.max(1,Math.abs(x),Math.abs(Be))&&Math.abs(S-Qe)<=Ge*Math.max(1,Math.abs(S),Math.abs(Qe))&&Math.abs(A-lt)<=Ge*Math.max(1,Math.abs(A),Math.abs(lt))&&Math.abs(D-Tt)<=Ge*Math.max(1,Math.abs(D),Math.abs(Tt))&&Math.abs(P-mt)<=Ge*Math.max(1,Math.abs(P),Math.abs(mt))&&Math.abs(L-wt)<=Ge*Math.max(1,Math.abs(L),Math.abs(wt))&&Math.abs(F-jt)<=Ge*Math.max(1,Math.abs(F),Math.abs(jt))&&Math.abs($-xt)<=Ge*Math.max(1,Math.abs($),Math.abs(xt))&&Math.abs(H-yt)<=Ge*Math.max(1,Math.abs(H),Math.abs(yt))&&Math.abs(X-nt)<=Ge*Math.max(1,Math.abs(X),Math.abs(nt))&&Math.abs(ee-Gt)<=Ge*Math.max(1,Math.abs(ee),Math.abs(Gt))&&Math.abs(se-Qt)<=Ge*Math.max(1,Math.abs(se),Math.abs(Qt))&&Math.abs(de-Ft)<=Ge*Math.max(1,Math.abs(de),Math.abs(Ft))},v.cA=function(s,t){K.REGISTERED_PROTOCOLS[s]=t},v.cB=function(s){delete K.REGISTERED_PROTOCOLS[s]},v.cC=function(s,t){const a={};for(let g=0;g<s.length;g++){const x=t&&t[s[g].id]||ac(s[g]);t&&(t[s[g].id]=x);let S=a[x];S||(S=a[x]=[]),S.push(s[g])}const h=[];for(const g in a)h.push(a[g]);return h},v.cD=Ct,v.cE=Rm,v.cF=m0,v.cG=Xf,v.cH=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=It/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const t=s.bucket.layers[0],a=t.layout,h=t._unevaluatedLayout._values,g={layoutIconSize:h["icon-size"].possiblyEvaluate(new Hn(s.bucket.zoom+1),s.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Hn(s.bucket.zoom+1),s.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Hn(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=s.bucket.textSizeData;g.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Hn(P),s.canonical),h["text-size"].possiblyEvaluate(new Hn(L),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=s.bucket.iconSizeData;g.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Hn(P),s.canonical),h["icon-size"].possiblyEvaluate(new Hn(L),s.canonical)]}const x=a.get("text-line-height")*Kn,S=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",A=a.get("text-keep-upright"),D=a.get("text-size");for(const P of s.bucket.features){const L=a.get("text-font").evaluate(P,{},s.canonical).join(","),F=D.evaluate(P,{},s.canonical),$=g.layoutTextSize.evaluate(P,{},s.canonical),H=g.layoutIconSize.evaluate(P,{},s.canonical),X={horizontal:{},vertical:void 0},ee=P.text;let se,de=[0,0];if(ee){const Se=ee.toString(),Be=a.get("text-letter-spacing").evaluate(P,{},s.canonical)*Kn,Qe=Of(Se)?Be:0,lt=a.get("text-anchor").evaluate(P,{},s.canonical),Tt=vy(t,P,s.canonical);if(!Tt){const xt=a.get("text-radial-offset").evaluate(P,{},s.canonical);de=xt?Lh(lt,[xt*Kn,_y]):a.get("text-offset").evaluate(P,{},s.canonical).map(yt=>yt*Kn)}let mt=S?"center":a.get("text-justify").evaluate(P,{},s.canonical);const wt=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(P,{},s.canonical)*Kn:1/0,jt=()=>{s.bucket.allowVerticalPlacement&&Rs(Se)&&(X.vertical=Wf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,wt,x,lt,"left",Qe,de,v.ao.vertical,!0,$,F))};if(!S&&Tt){const xt=new Set;if(mt==="auto")for(let nt=0;nt<Tt.values.length;nt+=2)xt.add(by(Tt.values[nt]));else xt.add(mt);let yt=!1;for(const nt of xt)if(!X.horizontal[nt])if(yt)X.horizontal[nt]=X.horizontal[0];else{const Gt=Wf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,wt,x,"center",nt,Qe,de,v.ao.horizontal,!1,$,F);Gt&&(X.horizontal[nt]=Gt,yt=Gt.positionedLines.length===1)}jt()}else{mt==="auto"&&(mt=by(lt));const xt=Wf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,wt,x,lt,mt,Qe,de,v.ao.horizontal,!1,$,F);xt&&(X.horizontal[mt]=xt),jt(),Rs(Se)&&S&&A&&(X.vertical=Wf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,wt,x,lt,mt,Qe,de,v.ao.vertical,!1,$,F))}}let ke=!1;if(P.icon&&P.icon.name){const Se=s.imageMap[P.icon.name];Se&&(se=ry(s.imagePositions[P.icon.name],a.get("icon-offset").evaluate(P,{},s.canonical),a.get("icon-anchor").evaluate(P,{},s.canonical)),ke=!!Se.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ke:s.bucket.sdfIcons!==ke&&Wn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Se.pixelRatio!==s.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ve=b0(X.horizontal)||X.vertical;s.bucket.iconsInText=!!ve&&ve.iconsInText,(ve||se)&&Uv(s.bucket,P,X,se,s.imageMap,g,$,H,de,ke,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},v.cI=Ea,v.cJ=Vf,v.cK=Dn,v.cL=J_,v.cM=gm,v.cN=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},v.cO=function(s,t,a,h,g){return c(this,void 0,void 0,function*(){if(Ie())try{return yield oa(s,t,a,h,g)}catch{}return function(x,S,A,D,P){const L=x.width,F=x.height;Fr&&ws||(Fr=new OffscreenCanvas(L,F),ws=Fr.getContext("2d",{willReadFrequently:!0})),Fr.width=L,Fr.height=F,ws.drawImage(x,0,0,L,F);const $=ws.getImageData(S,A,D,P);return ws.clearRect(0,0,L,F),$.data}(s,t,a,h,g)})},v.cP=Pd,v.cQ=R,v.cR=Yf,v.cS=Rh,v.cT=po,v.cU=function(s,t){const a=new Map;if(s!=null)if(s.type==="Feature")a.set(Qd(s,t),s);else for(const h of s.features)a.set(Qd(h,t),h);return a},v.cV=function(s,t){if(s==null)return!0;if(s.type==="Feature")return Qd(s,t)!=null;if(s.type==="FeatureCollection"){const a=new Set;for(const h of s.features){const g=Qd(h,t);if(g==null||a.has(g))return!1;a.add(g)}return!0}return!1},v.cW=function(s,t,a){var h,g,x,S;if(t.removeAll&&s.clear(),t.remove)for(const A of t.remove)s.delete(A);if(t.add)for(const A of t.add){const D=Qd(A,a);D!=null&&s.set(D,A)}if(t.update)for(const A of t.update){let D=s.get(A.id);if(D==null)continue;const P=!A.removeAllProperties&&(((h=A.removeProperties)===null||h===void 0?void 0:h.length)>0||((g=A.addOrUpdateProperties)===null||g===void 0?void 0:g.length)>0);if((A.newGeometry||A.removeAllProperties||P)&&(D=Object.assign({},D),s.set(A.id,D),P&&(D.properties=Object.assign({},D.properties))),A.newGeometry&&(D.geometry=A.newGeometry),A.removeAllProperties)D.properties={};else if(((x=A.removeProperties)===null||x===void 0?void 0:x.length)>0)for(const L of A.removeProperties)Object.prototype.hasOwnProperty.call(D.properties,L)&&delete D.properties[L];if(((S=A.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0)for(const{key:L,value:F}of A.addOrUpdateProperties)D.properties[L]=F}},v.cX=Wr,v.ca=function(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},v.cb=s=>s.type==="symbol",v.cc=s=>s.type==="circle",v.cd=s=>s.type==="heatmap",v.ce=s=>s.type==="line",v.cf=s=>s.type==="fill",v.cg=s=>s.type==="fill-extrusion",v.ch=s=>s.type==="hillshade",v.ci=s=>s.type==="color-relief",v.cj=s=>s.type==="raster",v.ck=s=>s.type==="background",v.cl=s=>s.type==="custom",v.cm=Pt,v.cn=function(s,t,a){const h=Dt(t.x-a.x,t.y-a.y),g=Dt(s.x-a.x,s.y-a.y);var x,S;return Ss(Math.atan2(h[0]*g[1]-h[1]*g[0],(x=h)[0]*(S=g)[0]+x[1]*S[1]))},v.co=Xt,v.cp=function(s,t){return Oi[t]&&(s instanceof MouseEvent||s instanceof WheelEvent)},v.cq=function(s,t){return la[t]&&"touches"in s},v.cr=function(s){return la[s]||Oi[s]},v.cs=function(s,t,a){var h=t[0],g=t[1];return s[0]=a[0]*h+a[4]*g+a[12],s[1]=a[1]*h+a[5]*g+a[13],s},v.ct=function(s,t){const{x:a,y:h}=zh.fromLngLat(t);return!(s<0||s>25||h<0||h>=1||a<0||a>=1)},v.cu=function(s,t){return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},v.cv=class extends Lr{},v.cw=Bm,v.cy=function(s){return s.message===Ur},v.cz=_e,v.d=Fe,v.e=fn,v.f=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.g=J,v.h=s=>new Promise((t,a)=>{const h=new Image;h.onload=()=>{t(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=ka})},h.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(s)],{type:"image/png"});h.src=s.byteLength?URL.createObjectURL(g):ka}),v.i=Br,v.j=(s,t)=>Me(fn(s,{type:"json"}),t),v.k=at,v.l=ht,v.m=Me,v.n=(s,t)=>Me(fn(s,{type:"arrayBuffer"}),t),v.o=function(s){return new gm(s).readFields(zv,[])},v.p=Jg,v.q=Ah,v.r=Ln,v.s=Ja,v.t=go,v.u=Sn,v.v=Pe,v.w=Wn,v.x=qp,v.y=nu,v.z=tu}),m("worker",["./shared"],function(v){class c{constructor(K,J){this.keyCache={},K&&this.replace(K,J)}replace(K,J){this._layerConfigs={},this._layers={},this.update(K,[],J)}update(K,J,ae){for(const Te of K){this._layerConfigs[Te.id]=Te;const Me=this._layers[Te.id]=v.bJ(Te,ae);Me._featureFilter=v.aa(Me.filter,ae),this.keyCache[Te.id]&&delete this.keyCache[Te.id]}for(const Te of J)delete this.keyCache[Te],delete this._layerConfigs[Te],delete this._layers[Te];this.familiesBySource={};const _e=v.cC(Object.values(this._layerConfigs),this.keyCache);for(const Te of _e){const Me=Te.map(Lt=>this._layers[Lt.id]),Fe=Me[0];if(Fe.visibility==="none")continue;const Re=Fe.source||"";let tt=this.familiesBySource[Re];tt||(tt=this.familiesBySource[Re]={});const ht=Fe.sourceLayer||"_geojsonTileLayer";let at=tt[ht];at||(at=tt[ht]=[]),at.push(Me)}}}class C{constructor(K){const J={},ae=[];for(const Fe in K){const Re=K[Fe],tt=J[Fe]={};for(const ht in Re){const at=Re[+ht];if(!at||at.bitmap.width===0||at.bitmap.height===0)continue;const Lt={x:0,y:0,w:at.bitmap.width+2,h:at.bitmap.height+2};ae.push(Lt),tt[ht]={rect:Lt,metrics:at.metrics}}}const{w:_e,h:Te}=v.p(ae),Me=new v.q({width:_e||1,height:Te||1});for(const Fe in K){const Re=K[Fe];for(const tt in Re){const ht=Re[+tt];if(!ht||ht.bitmap.width===0||ht.bitmap.height===0)continue;const at=J[Fe][tt].rect;v.q.copy(ht.bitmap,Me,{x:0,y:0},{x:at.x+1,y:at.y+1},ht.bitmap)}}this.image=Me,this.positions=J}}v.cD("GlyphAtlas",C);class R{constructor(K){this.tileID=new v.Z(K.tileID.overscaledZ,K.tileID.wrap,K.tileID.canonical.z,K.tileID.canonical.x,K.tileID.canonical.y),this.uid=K.uid,this.zoom=K.zoom,this.pixelRatio=K.pixelRatio,this.tileSize=K.tileSize,this.source=K.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=K.showCollisionBoxes,this.collectResourceTiming=!!K.collectResourceTiming,this.returnDependencies=!!K.returnDependencies,this.promoteId=K.promoteId,this.inFlightDependencies=[]}parse(K,J,ae,_e,Te){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=K,this.collisionBoxArray=new v.a8;const Me=new v.cE(Object.keys(K.layers).sort()),Fe=new v.cF(this.tileID,this.promoteId);Fe.bucketLayerIDs=[];const Re={},tt={featureIndex:Fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ae,subdivisionGranularity:Te},ht=J.familiesBySource[this.source];for(const Wt in ht){const tn=K.layers[Wt];if(!tn)continue;tn.version===1&&v.w(`Vector tile source "${this.source}" layer "${Wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ti=Me.encode(Wt),gt=[];for(let Vr=0;Vr<tn.length;Vr++){const ji=tn.feature(Vr),Ro=Fe.getId(ji,Wt);gt.push({feature:ji,id:Ro,index:Vr,sourceLayerIndex:Ti})}for(const Vr of ht[Wt]){const ji=Vr[0];ji.source!==this.source&&v.w(`layer.source = ${ji.source} does not equal this.source = ${this.source}`),ji.minzoom&&this.zoom<Math.floor(ji.minzoom)||ji.maxzoom&&this.zoom>=ji.maxzoom||ji.visibility!=="none"&&(z(Vr,this.zoom,ae),(Re[ji.id]=ji.createBucket({index:Fe.bucketLayerIDs.length,layers:Vr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ti,sourceID:this.source})).populate(gt,tt,this.tileID.canonical),Fe.bucketLayerIDs.push(Vr.map(Ro=>Ro.id)))}}const at=v.bN(tt.glyphDependencies,Wt=>Object.keys(Wt).map(Number));this.inFlightDependencies.forEach(Wt=>Wt?.abort()),this.inFlightDependencies=[];let Lt=Promise.resolve({});if(Object.keys(at).length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),Lt=_e.sendAsync({type:"GG",data:{stacks:at,source:this.source,tileID:this.tileID,type:"glyphs"}},Wt)}const Pe=Object.keys(tt.iconDependencies);let en=Promise.resolve({});if(Pe.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),en=_e.sendAsync({type:"GI",data:{icons:Pe,source:this.source,tileID:this.tileID,type:"icons"}},Wt)}const vn=Object.keys(tt.patternDependencies);let Vt=Promise.resolve({});if(vn.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),Vt=_e.sendAsync({type:"GI",data:{icons:vn,source:this.source,tileID:this.tileID,type:"patterns"}},Wt)}const[sn,ni,ar]=yield Promise.all([Lt,en,Vt]),dr=new C(sn),ai=new v.cG(ni,ar);for(const Wt in Re){const tn=Re[Wt];tn instanceof v.a9?(z(tn.layers,this.zoom,ae),v.cH({bucket:tn,glyphMap:sn,glyphPositions:dr.positions,imageMap:ni,imagePositions:ai.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:tt.subdivisionGranularity})):tn.hasPattern&&(tn instanceof v.cI||tn instanceof v.cJ||tn instanceof v.cK)&&(z(tn.layers,this.zoom,ae),tn.addFeatures(tt,this.tileID.canonical,ai.patternPositions))}return this.status="done",{buckets:Object.values(Re).filter(Wt=>!Wt.isEmpty()),featureIndex:Fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:dr.image,imageAtlas:ai,glyphMap:this.returnDependencies?sn:null,iconMap:this.returnDependencies?ni:null,glyphPositions:this.returnDependencies?dr.positions:null}})}}function z(Ae,K,J){const ae=new v.F(K);for(const _e of Ae)_e.recalculate(ae,J)}class B{constructor(K,J,ae){this.actor=K,this.layerIndex=J,this.availableImages=ae,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(K,J){return v._(this,void 0,void 0,function*(){const ae=yield v.n(K.request,J);try{return{vectorTile:new v.cL(new v.cM(ae.data)),rawData:ae.data,cacheControl:ae.cacheControl,expires:ae.expires}}catch(_e){const Te=new Uint8Array(ae.data);let Me=`Unable to parse the tile at ${K.request.url}, `;throw Me+=Te[0]===31&&Te[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${_e.message}`,new Error(Me)}})}loadTile(K){return v._(this,void 0,void 0,function*(){const J=K.uid,ae=!!(K&&K.request&&K.request.collectResourceTiming)&&new v.cN(K.request),_e=new R(K);this.loading[J]=_e;const Te=new AbortController;_e.abort=Te;try{const Me=yield this.loadVectorTile(K,Te);if(delete this.loading[J],!Me)return null;const Fe=Me.rawData,Re={};Me.expires&&(Re.expires=Me.expires),Me.cacheControl&&(Re.cacheControl=Me.cacheControl);const tt={};if(ae){const at=ae.finish();at&&(tt.resourceTiming=JSON.parse(JSON.stringify(at)))}_e.vectorTile=Me.vectorTile;const ht=_e.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);this.loaded[J]=_e,this.fetching[J]={rawTileData:Fe,cacheControl:Re,resourceTiming:tt};try{const at=yield ht;return v.e({rawTileData:Fe.slice(0)},at,Re,tt)}finally{delete this.fetching[J]}}catch(Me){throw delete this.loading[J],_e.status="done",this.loaded[J]=_e,Me}})}reloadTile(K){return v._(this,void 0,void 0,function*(){const J=K.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ae=this.loaded[J];if(ae.showCollisionBoxes=K.showCollisionBoxes,ae.status==="parsing"){const _e=yield ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);let Te;if(this.fetching[J]){const{rawTileData:Me,cacheControl:Fe,resourceTiming:Re}=this.fetching[J];delete this.fetching[J],Te=v.e({rawTileData:Me.slice(0)},_e,Fe,Re)}else Te=_e;return Te}if(ae.status==="done"&&ae.vectorTile)return ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity)})}abortTile(K){return v._(this,void 0,void 0,function*(){const J=this.loading,ae=K.uid;J&&J[ae]&&J[ae].abort&&(J[ae].abort.abort(),delete J[ae])})}removeTile(K){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[K.uid]&&delete this.loaded[K.uid]})}}class V{constructor(){this.loaded={}}loadTile(K){return v._(this,void 0,void 0,function*(){const{uid:J,encoding:ae,rawImageData:_e,redFactor:Te,greenFactor:Me,blueFactor:Fe,baseShift:Re}=K,tt=_e.width+2,ht=_e.height+2,at=v.b(_e)?new v.R({width:tt,height:ht},yield v.cO(_e,-1,-1,tt,ht)):_e,Lt=new v.cP(J,at,ae,Te,Me,Fe,Re);return this.loaded=this.loaded||{},this.loaded[J]=Lt,Lt})}removeTile(K){const J=this.loaded,ae=K.uid;J&&J[ae]&&delete J[ae]}}var G,re,fe=function(){if(re)return G;function Ae(J,ae){if(J.length!==0){K(J[0],ae);for(var _e=1;_e<J.length;_e++)K(J[_e],!ae)}}function K(J,ae){for(var _e=0,Te=0,Me=0,Fe=J.length,Re=Fe-1;Me<Fe;Re=Me++){var tt=(J[Me][0]-J[Re][0])*(J[Re][1]+J[Me][1]),ht=_e+tt;Te+=Math.abs(_e)>=Math.abs(tt)?_e-ht+tt:tt-ht+_e,_e=ht}_e+Te>=0!=!!ae&&J.reverse()}return re=1,G=function J(ae,_e){var Te,Me=ae&&ae.type;if(Me==="FeatureCollection")for(Te=0;Te<ae.features.length;Te++)J(ae.features[Te],_e);else if(Me==="GeometryCollection")for(Te=0;Te<ae.geometries.length;Te++)J(ae.geometries[Te],_e);else if(Me==="Feature")J(ae.geometry,_e);else if(Me==="Polygon")Ae(ae.coordinates,_e);else if(Me==="MultiPolygon")for(Te=0;Te<ae.coordinates.length;Te++)Ae(ae.coordinates[Te],_e);return ae}}(),pe=v.cQ(fe);class Ie extends v.cS{constructor(K,J){super(new v.cM,0,J,[],[]),this.feature=K,this.type=K.type,this.properties=K.tags?K.tags:{},"id"in K&&(typeof K.id=="string"?this.id=parseInt(K.id,10):typeof K.id!="number"||isNaN(K.id)||(this.id=K.id))}loadGeometry(){const K=[],J=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ae of J){const _e=[];for(const Te of ae)_e.push(new v.P(Te[0],Te[1]));K.push(_e)}return K}}class Ge extends v.cR{constructor(K,J){super(new v.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=J?J.version:1,this.extent=J?J.extent:4096,this.length=K.length,this.features=K}feature(K){return new Ie(this.features[K],this.extent)}}function je(Ae,K){K.writeVarintField(15,Ae.version||1),K.writeStringField(1,Ae.name||""),K.writeVarintField(5,Ae.extent||4096);const J={keys:[],values:[],keycache:{},valuecache:{}};for(let Te=0;Te<Ae.length;Te++)J.feature=Ae.feature(Te),K.writeMessage(2,He,J);const ae=J.keys;for(const Te of ae)K.writeStringField(3,Te);const _e=J.values;for(const Te of _e)K.writeMessage(4,Ne,Te)}function He(Ae,K){if(!Ae.feature)return;const J=Ae.feature;J.id!==void 0&&K.writeVarintField(1,J.id),K.writeMessage(2,Ve,Ae),K.writeVarintField(3,J.type),K.writeMessage(4,Mt,J)}function Ve(Ae,K){for(const J in Ae.feature?.properties){let ae=Ae.feature.properties[J],_e=Ae.keycache[J];if(ae===null)continue;_e===void 0&&(Ae.keys.push(J),_e=Ae.keys.length-1,Ae.keycache[J]=_e),K.writeVarint(_e),typeof ae!="string"&&typeof ae!="boolean"&&typeof ae!="number"&&(ae=JSON.stringify(ae));const Te=typeof ae+":"+ae;let Me=Ae.valuecache[Te];Me===void 0&&(Ae.values.push(ae),Me=Ae.values.length-1,Ae.valuecache[Te]=Me),K.writeVarint(Me)}}function rt(Ae,K){return(K<<3)+(7&Ae)}function Je(Ae){return Ae<<1^Ae>>31}function Mt(Ae,K){const J=Ae.loadGeometry(),ae=Ae.type;let _e=0,Te=0;for(const Me of J){let Fe=1;ae===1&&(Fe=Me.length),K.writeVarint(rt(1,Fe));const Re=ae===3?Me.length-1:Me.length;for(let tt=0;tt<Re;tt++){tt===1&&ae!==1&&K.writeVarint(rt(2,Re-1));const ht=Me[tt].x-_e,at=Me[tt].y-Te;K.writeVarint(Je(ht)),K.writeVarint(Je(at)),_e+=ht,Te+=at}Ae.type===3&&K.writeVarint(rt(7,1))}}function Ne(Ae,K){const J=typeof Ae;J==="string"?K.writeStringField(1,Ae):J==="boolean"?K.writeBooleanField(7,Ae):J==="number"&&(Ae%1!=0?K.writeDoubleField(3,Ae):Ae<0?K.writeSVarintField(6,Ae):K.writeVarintField(5,Ae))}const Xe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ae=>Ae},_t=Math.fround||(Rt=new Float32Array(1),Ae=>(Rt[0]=+Ae,Rt[0]));var Rt;class Ut{constructor(K){this.options=Object.assign(Object.create(Xe),K),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(K){const{log:J,minZoom:ae,maxZoom:_e}=this.options;J&&console.time("total time");const Te=`prepare ${K.length} points`;J&&console.time(Te),this.points=K;const Me=[];for(let Re=0;Re<K.length;Re++){const tt=K[Re];if(!tt.geometry)continue;const[ht,at]=tt.geometry.coordinates,Lt=_t(Ue(ht)),Pe=_t(ft(at));Me.push(Lt,Pe,1/0,Re,-1,1),this.options.reduce&&Me.push(0)}let Fe=this.trees[_e+1]=this._createTree(Me);J&&console.timeEnd(Te);for(let Re=_e;Re>=ae;Re--){const tt=+Date.now();Fe=this.trees[Re]=this._createTree(this._cluster(Fe,Re)),J&&console.log("z%d: %d clusters in %dms",Re,Fe.numItems,+Date.now()-tt)}return J&&console.timeEnd("total time"),this}getClusters(K,J){let ae=((K[0]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,K[1]));let Te=K[2]===180?180:((K[2]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)ae=-180,Te=180;else if(ae>Te){const at=this.getClusters([ae,_e,180,Me],J),Lt=this.getClusters([-180,_e,Te,Me],J);return at.concat(Lt)}const Fe=this.trees[this._limitZoom(J)],Re=Fe.range(Ue(ae),ft(Me),Ue(Te),ft(_e)),tt=Fe.data,ht=[];for(const at of Re){const Lt=this.stride*at;ht.push(tt[Lt+5]>1?un(tt,Lt,this.clusterProps):this.points[tt[Lt+3]])}return ht}getChildren(K){const J=this._getOriginId(K),ae=this._getOriginZoom(K),_e="No cluster with the specified id.",Te=this.trees[ae];if(!Te)throw new Error(_e);const Me=Te.data;if(J*this.stride>=Me.length)throw new Error(_e);const Fe=this.options.radius/(this.options.extent*Math.pow(2,ae-1)),Re=Te.within(Me[J*this.stride],Me[J*this.stride+1],Fe),tt=[];for(const ht of Re){const at=ht*this.stride;Me[at+4]===K&&tt.push(Me[at+5]>1?un(Me,at,this.clusterProps):this.points[Me[at+3]])}if(tt.length===0)throw new Error(_e);return tt}getLeaves(K,J,ae){const _e=[];return this._appendLeaves(_e,K,J=J||10,ae=ae||0,0),_e}getTile(K,J,ae){const _e=this.trees[this._limitZoom(K)],Te=Math.pow(2,K),{extent:Me,radius:Fe}=this.options,Re=Fe/Me,tt=(ae-Re)/Te,ht=(ae+1+Re)/Te,at={features:[]};return this._addTileFeatures(_e.range((J-Re)/Te,tt,(J+1+Re)/Te,ht),_e.data,J,ae,Te,at),J===0&&this._addTileFeatures(_e.range(1-Re/Te,tt,1,ht),_e.data,Te,ae,Te,at),J===Te-1&&this._addTileFeatures(_e.range(0,tt,Re/Te,ht),_e.data,-1,ae,Te,at),at.features.length?at:null}getClusterExpansionZoom(K){let J=this._getOriginZoom(K)-1;for(;J<=this.options.maxZoom;){const ae=this.getChildren(K);if(J++,ae.length!==1)break;K=ae[0].properties.cluster_id}return J}_appendLeaves(K,J,ae,_e,Te){const Me=this.getChildren(J);for(const Fe of Me){const Re=Fe.properties;if(Re&&Re.cluster?Te+Re.point_count<=_e?Te+=Re.point_count:Te=this._appendLeaves(K,Re.cluster_id,ae,_e,Te):Te<_e?Te++:K.push(Fe),K.length===ae)break}return Te}_createTree(K){const J=new v.aI(K.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ae=0;ae<K.length;ae+=this.stride)J.add(K[ae],K[ae+1]);return J.finish(),J.data=K,J}_addTileFeatures(K,J,ae,_e,Te,Me){for(const Fe of K){const Re=Fe*this.stride,tt=J[Re+5]>1;let ht,at,Lt;if(tt)ht=Ht(J,Re,this.clusterProps),at=J[Re],Lt=J[Re+1];else{const vn=this.points[J[Re+3]];ht=vn.properties;const[Vt,sn]=vn.geometry.coordinates;at=Ue(Vt),Lt=ft(sn)}const Pe={type:1,geometry:[[Math.round(this.options.extent*(at*Te-ae)),Math.round(this.options.extent*(Lt*Te-_e))]],tags:ht};let en;en=tt||this.options.generateId?J[Re+3]:this.points[J[Re+3]].id,en!==void 0&&(Pe.id=en),Me.features.push(Pe)}}_limitZoom(K){return Math.max(this.options.minZoom,Math.min(Math.floor(+K),this.options.maxZoom+1))}_cluster(K,J){const{radius:ae,extent:_e,reduce:Te,minPoints:Me}=this.options,Fe=ae/(_e*Math.pow(2,J)),Re=K.data,tt=[],ht=this.stride;for(let at=0;at<Re.length;at+=ht){if(Re[at+2]<=J)continue;Re[at+2]=J;const Lt=Re[at],Pe=Re[at+1],en=K.within(Re[at],Re[at+1],Fe),vn=Re[at+5];let Vt=vn;for(const sn of en){const ni=sn*ht;Re[ni+2]>J&&(Vt+=Re[ni+5])}if(Vt>vn&&Vt>=Me){let sn,ni=Lt*vn,ar=Pe*vn,dr=-1;const ai=(at/ht<<5)+(J+1)+this.points.length;for(const Wt of en){const tn=Wt*ht;if(Re[tn+2]<=J)continue;Re[tn+2]=J;const Ti=Re[tn+5];ni+=Re[tn]*Ti,ar+=Re[tn+1]*Ti,Re[tn+4]=ai,Te&&(sn||(sn=this._map(Re,at,!0),dr=this.clusterProps.length,this.clusterProps.push(sn)),Te(sn,this._map(Re,tn)))}Re[at+4]=ai,tt.push(ni/Vt,ar/Vt,1/0,ai,-1,Vt),Te&&tt.push(dr)}else{for(let sn=0;sn<ht;sn++)tt.push(Re[at+sn]);if(Vt>1)for(const sn of en){const ni=sn*ht;if(!(Re[ni+2]<=J)){Re[ni+2]=J;for(let ar=0;ar<ht;ar++)tt.push(Re[ni+ar])}}}}return tt}_getOriginId(K){return K-this.points.length>>5}_getOriginZoom(K){return(K-this.points.length)%32}_map(K,J,ae){if(K[J+5]>1){const Me=this.clusterProps[K[J+6]];return ae?Object.assign({},Me):Me}const _e=this.points[K[J+3]].properties,Te=this.options.map(_e);return ae&&Te===_e?Object.assign({},Te):Te}}function un(Ae,K,J){return{type:"Feature",id:Ae[K+3],properties:Ht(Ae,K,J),geometry:{type:"Point",coordinates:[(ae=Ae[K],360*(ae-.5)),Dt(Ae[K+1])]}};var ae}function Ht(Ae,K,J){const ae=Ae[K+5],_e=ae>=1e4?`${Math.round(ae/1e3)}k`:ae>=1e3?Math.round(ae/100)/10+"k":ae,Te=Ae[K+6],Me=Te===-1?{}:Object.assign({},J[Te]);return Object.assign(Me,{cluster:!0,cluster_id:Ae[K+3],point_count:ae,point_count_abbreviated:_e})}function Ue(Ae){return Ae/360+.5}function ft(Ae){const K=Math.sin(Ae*Math.PI/180),J=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return J<0?0:J>1?1:J}function Dt(Ae){const K=(180-360*Ae)*Math.PI/180;return 360*Math.atan(Math.exp(K))/Math.PI-90}function It(Ae,K,J,ae){let _e=ae;const Te=K+(J-K>>1);let Me,Fe=J-K;const Re=Ae[K],tt=Ae[K+1],ht=Ae[J],at=Ae[J+1];for(let Lt=K+3;Lt<J;Lt+=3){const Pe=be(Ae[Lt],Ae[Lt+1],Re,tt,ht,at);if(Pe>_e)Me=Lt,_e=Pe;else if(Pe===_e){const en=Math.abs(Lt-Te);en<Fe&&(Me=Lt,Fe=en)}}_e>ae&&(Me-K>3&&It(Ae,K,Me,ae),Ae[Me+2]=_e,J-Me>3&&It(Ae,Me,J,ae))}function be(Ae,K,J,ae,_e,Te){let Me=_e-J,Fe=Te-ae;if(Me!==0||Fe!==0){const Re=((Ae-J)*Me+(K-ae)*Fe)/(Me*Me+Fe*Fe);Re>1?(J=_e,ae=Te):Re>0&&(J+=Me*Re,ae+=Fe*Re)}return Me=Ae-J,Fe=K-ae,Me*Me+Fe*Fe}function et(Ae,K,J,ae){const _e={id:Ae??null,type:K,geometry:J,tags:ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(K==="Point"||K==="MultiPoint"||K==="LineString")Et(_e,J);else if(K==="Polygon")Et(_e,J[0]);else if(K==="MultiLineString")for(const Te of J)Et(_e,Te);else if(K==="MultiPolygon")for(const Te of J)Et(_e,Te[0]);return _e}function Et(Ae,K){for(let J=0;J<K.length;J+=3)Ae.minX=Math.min(Ae.minX,K[J]),Ae.minY=Math.min(Ae.minY,K[J+1]),Ae.maxX=Math.max(Ae.maxX,K[J]),Ae.maxY=Math.max(Ae.maxY,K[J+1])}function bt(Ae,K,J,ae){if(!K.geometry)return;const _e=K.geometry.coordinates;if(_e&&_e.length===0)return;const Te=K.geometry.type,Me=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let Fe=[],Re=K.id;if(J.promoteId?Re=K.properties[J.promoteId]:J.generateId&&(Re=ae||0),Te==="Point")Pt(_e,Fe);else if(Te==="MultiPoint")for(const tt of _e)Pt(tt,Fe);else if(Te==="LineString")Xt(_e,Fe,Me,!1);else if(Te==="MultiLineString"){if(J.lineMetrics){for(const tt of _e)Fe=[],Xt(tt,Fe,Me,!1),Ae.push(et(Re,"LineString",Fe,K.properties));return}Bt(_e,Fe,Me,!1)}else if(Te==="Polygon")Bt(_e,Fe,Me,!0);else{if(Te!=="MultiPolygon"){if(Te==="GeometryCollection"){for(const tt of K.geometry.geometries)bt(Ae,{id:Re,geometry:tt,properties:K.properties},J,ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const tt of _e){const ht=[];Bt(tt,ht,Me,!0),Fe.push(ht)}}Ae.push(et(Re,Te,Fe,K.properties))}function Pt(Ae,K){K.push(wi(Ae[0]),fn(Ae[1]),0)}function Xt(Ae,K,J,ae){let _e,Te,Me=0;for(let Re=0;Re<Ae.length;Re++){const tt=wi(Ae[Re][0]),ht=fn(Ae[Re][1]);K.push(tt,ht,0),Re>0&&(Me+=ae?(_e*ht-tt*Te)/2:Math.sqrt(Math.pow(tt-_e,2)+Math.pow(ht-Te,2))),_e=tt,Te=ht}const Fe=K.length-3;K[2]=1,It(K,0,Fe,J),K[Fe+2]=1,K.size=Math.abs(Me),K.start=0,K.end=K.size}function Bt(Ae,K,J,ae){for(let _e=0;_e<Ae.length;_e++){const Te=[];Xt(Ae[_e],Te,J,ae),K.push(Te)}}function wi(Ae){return Ae/360+.5}function fn(Ae){const K=Math.sin(Ae*Math.PI/180),J=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return J<0?0:J>1?1:J}function mi(Ae,K,J,ae,_e,Te,Me,Fe){if(ae/=K,Te>=(J/=K)&&Me<ae)return Ae;if(Me<J||Te>=ae)return null;const Re=[];for(const tt of Ae){const ht=tt.geometry;let at=tt.type;const Lt=_e===0?tt.minX:tt.minY,Pe=_e===0?tt.maxX:tt.maxY;if(Lt>=J&&Pe<ae){Re.push(tt);continue}if(Pe<J||Lt>=ae)continue;let en=[];if(at==="Point"||at==="MultiPoint")ya(ht,en,J,ae,_e);else if(at==="LineString")sa(ht,en,J,ae,_e,!1,Fe.lineMetrics);else if(at==="MultiLineString")Yn(ht,en,J,ae,_e,!1);else if(at==="Polygon")Yn(ht,en,J,ae,_e,!0);else if(at==="MultiPolygon")for(const vn of ht){const Vt=[];Yn(vn,Vt,J,ae,_e,!0),Vt.length&&en.push(Vt)}if(en.length){if(Fe.lineMetrics&&at==="LineString"){for(const vn of en)Re.push(et(tt.id,at,vn,tt.tags));continue}at!=="LineString"&&at!=="MultiLineString"||(en.length===1?(at="LineString",en=en[0]):at="MultiLineString"),at!=="Point"&&at!=="MultiPoint"||(at=en.length===3?"Point":"MultiPoint"),Re.push(et(tt.id,at,en,tt.tags))}}return Re.length?Re:null}function ya(Ae,K,J,ae,_e){for(let Te=0;Te<Ae.length;Te+=3){const Me=Ae[Te+_e];Me>=J&&Me<=ae&&Wn(K,Ae[Te],Ae[Te+1],Ae[Te+2])}}function sa(Ae,K,J,ae,_e,Te,Me){let Fe=rr(Ae);const Re=_e===0?Nn:Br;let tt,ht,at=Ae.start;for(let Vt=0;Vt<Ae.length-3;Vt+=3){const sn=Ae[Vt],ni=Ae[Vt+1],ar=Ae[Vt+2],dr=Ae[Vt+3],ai=Ae[Vt+4],Wt=_e===0?sn:ni,tn=_e===0?dr:ai;let Ti=!1;Me&&(tt=Math.sqrt(Math.pow(sn-dr,2)+Math.pow(ni-ai,2))),Wt<J?tn>J&&(ht=Re(Fe,sn,ni,dr,ai,J),Me&&(Fe.start=at+tt*ht)):Wt>ae?tn<ae&&(ht=Re(Fe,sn,ni,dr,ai,ae),Me&&(Fe.start=at+tt*ht)):Wn(Fe,sn,ni,ar),tn<J&&Wt>=J&&(ht=Re(Fe,sn,ni,dr,ai,J),Ti=!0),tn>ae&&Wt<=ae&&(ht=Re(Fe,sn,ni,dr,ai,ae),Ti=!0),!Te&&Ti&&(Me&&(Fe.end=at+tt*ht),K.push(Fe),Fe=rr(Ae)),Me&&(at+=tt)}let Lt=Ae.length-3;const Pe=Ae[Lt],en=Ae[Lt+1],vn=_e===0?Pe:en;vn>=J&&vn<=ae&&Wn(Fe,Pe,en,Ae[Lt+2]),Lt=Fe.length-3,Te&&Lt>=3&&(Fe[Lt]!==Fe[0]||Fe[Lt+1]!==Fe[1])&&Wn(Fe,Fe[0],Fe[1],Fe[2]),Fe.length&&K.push(Fe)}function rr(Ae){const K=[];return K.size=Ae.size,K.start=Ae.start,K.end=Ae.end,K}function Yn(Ae,K,J,ae,_e,Te){for(const Me of Ae)sa(Me,K,J,ae,_e,Te,!1)}function Wn(Ae,K,J,ae){Ae.push(K,J,ae)}function Nn(Ae,K,J,ae,_e,Te){const Me=(Te-K)/(ae-K);return Wn(Ae,Te,J+(_e-J)*Me,1),Me}function Br(Ae,K,J,ae,_e,Te){const Me=(Te-J)/(_e-J);return Wn(Ae,K+(ae-K)*Me,Te,1),Me}function Li(Ae,K){const J=[];for(let ae=0;ae<Ae.length;ae++){const _e=Ae[ae],Te=_e.type;let Me;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")Me=Ka(_e.geometry,K);else if(Te==="MultiLineString"||Te==="Polygon"){Me=[];for(const Fe of _e.geometry)Me.push(Ka(Fe,K))}else if(Te==="MultiPolygon"){Me=[];for(const Fe of _e.geometry){const Re=[];for(const tt of Fe)Re.push(Ka(tt,K));Me.push(Re)}}J.push(et(_e.id,Te,Me,_e.tags))}return J}function Ka(Ae,K){const J=[];J.size=Ae.size,Ae.start!==void 0&&(J.start=Ae.start,J.end=Ae.end);for(let ae=0;ae<Ae.length;ae+=3)J.push(Ae[ae]+K,Ae[ae+1],Ae[ae+2]);return J}function ka(Ae,K){if(Ae.transformed)return Ae;const J=1<<Ae.z,ae=Ae.x,_e=Ae.y;for(const Te of Ae.features){const Me=Te.geometry,Fe=Te.type;if(Te.geometry=[],Fe===1)for(let Re=0;Re<Me.length;Re+=2)Te.geometry.push(oa(Me[Re],Me[Re+1],K,J,ae,_e));else for(let Re=0;Re<Me.length;Re++){const tt=[];for(let ht=0;ht<Me[Re].length;ht+=2)tt.push(oa(Me[Re][ht],Me[Re][ht+1],K,J,ae,_e));Te.geometry.push(tt)}}return Ae.transformed=!0,Ae}function oa(Ae,K,J,ae,_e,Te){return[Math.round(J*(Ae*ae-_e)),Math.round(J*(K*ae-Te))]}function Fr(Ae,K,J,ae,_e){const Te=K===_e.maxZoom?0:_e.tolerance/((1<<K)*_e.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:Ae.length,source:null,x:J,y:ae,z:K,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Fe of Ae)ws(Me,Fe,Te,_e);return Me}function ws(Ae,K,J,ae){const _e=K.geometry,Te=K.type,Me=[];if(Ae.minX=Math.min(Ae.minX,K.minX),Ae.minY=Math.min(Ae.minY,K.minY),Ae.maxX=Math.max(Ae.maxX,K.maxX),Ae.maxY=Math.max(Ae.maxY,K.maxY),Te==="Point"||Te==="MultiPoint")for(let Fe=0;Fe<_e.length;Fe+=3)Me.push(_e[Fe],_e[Fe+1]),Ae.numPoints++,Ae.numSimplified++;else if(Te==="LineString")Ja(Me,_e,Ae,J,!1,!1);else if(Te==="MultiLineString"||Te==="Polygon")for(let Fe=0;Fe<_e.length;Fe++)Ja(Me,_e[Fe],Ae,J,Te==="Polygon",Fe===0);else if(Te==="MultiPolygon")for(let Fe=0;Fe<_e.length;Fe++){const Re=_e[Fe];for(let tt=0;tt<Re.length;tt++)Ja(Me,Re[tt],Ae,J,!0,tt===0)}if(Me.length){let Fe=K.tags||null;if(Te==="LineString"&&ae.lineMetrics){Fe={};for(const tt in K.tags)Fe[tt]=K.tags[tt];Fe.mapbox_clip_start=_e.start/_e.size,Fe.mapbox_clip_end=_e.end/_e.size}const Re={geometry:Me,type:Te==="Polygon"||Te==="MultiPolygon"?3:Te==="LineString"||Te==="MultiLineString"?2:1,tags:Fe};K.id!==null&&(Re.id=K.id),Ae.features.push(Re)}}function Ja(Ae,K,J,ae,_e,Te){const Me=ae*ae;if(ae>0&&K.size<(_e?Me:ae))return void(J.numPoints+=K.length/3);const Fe=[];for(let Re=0;Re<K.length;Re+=3)(ae===0||K[Re+2]>Me)&&(J.numSimplified++,Fe.push(K[Re],K[Re+1])),J.numPoints++;_e&&function(Re,tt){let ht=0;for(let at=0,Lt=Re.length,Pe=Lt-2;at<Lt;Pe=at,at+=2)ht+=(Re[at]-Re[Pe])*(Re[at+1]+Re[Pe+1]);if(ht>0===tt)for(let at=0,Lt=Re.length;at<Lt/2;at+=2){const Pe=Re[at],en=Re[at+1];Re[at]=Re[Lt-2-at],Re[at+1]=Re[Lt-1-at],Re[Lt-2-at]=Pe,Re[Lt-1-at]=en}}(Fe,Te),Ae.push(Fe)}const Ts={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ss{constructor(K,J){const ae=(J=this.options=function(Te,Me){for(const Fe in Me)Te[Fe]=Me[Fe];return Te}(Object.create(Ts),J)).debug;if(ae&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let _e=function(Te,Me){const Fe=[];if(Te.type==="FeatureCollection")for(let Re=0;Re<Te.features.length;Re++)bt(Fe,Te.features[Re],Me,Re);else bt(Fe,Te.type==="Feature"?Te:{geometry:Te},Me);return Fe}(K,J);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_e=function(Te,Me){const Fe=Me.buffer/Me.extent;let Re=Te;const tt=mi(Te,1,-1-Fe,Fe,0,-1,2,Me),ht=mi(Te,1,1-Fe,2+Fe,0,-1,2,Me);return(tt||ht)&&(Re=mi(Te,1,-Fe,1+Fe,0,-1,2,Me)||[],tt&&(Re=Li(tt,1).concat(Re)),ht&&(Re=Re.concat(Li(ht,-1)))),Re}(_e,J),_e.length&&this.splitTile(_e,0,0,0),ae&&(_e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(K,J,ae,_e,Te,Me,Fe){const Re=[K,J,ae,_e],tt=this.options,ht=tt.debug;for(;Re.length;){_e=Re.pop(),ae=Re.pop(),J=Re.pop(),K=Re.pop();const at=1<<J,Lt=la(J,ae,_e);let Pe=this.tiles[Lt];if(!Pe&&(ht>1&&console.time("creation"),Pe=this.tiles[Lt]=Fr(K,J,ae,_e,tt),this.tileCoords.push({z:J,x:ae,y:_e}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,ae,_e,Pe.numFeatures,Pe.numPoints,Pe.numSimplified),console.timeEnd("creation"));const Ti=`z${J}`;this.stats[Ti]=(this.stats[Ti]||0)+1,this.total++}if(Pe.source=K,Te==null){if(J===tt.indexMaxZoom||Pe.numPoints<=tt.indexMaxPoints)continue}else{if(J===tt.maxZoom||J===Te)continue;if(Te!=null){const Ti=Te-J;if(ae!==Me>>Ti||_e!==Fe>>Ti)continue}}if(Pe.source=null,K.length===0)continue;ht>1&&console.time("clipping");const en=.5*tt.buffer/tt.extent,vn=.5-en,Vt=.5+en,sn=1+en;let ni=null,ar=null,dr=null,ai=null,Wt=mi(K,at,ae-en,ae+Vt,0,Pe.minX,Pe.maxX,tt),tn=mi(K,at,ae+vn,ae+sn,0,Pe.minX,Pe.maxX,tt);K=null,Wt&&(ni=mi(Wt,at,_e-en,_e+Vt,1,Pe.minY,Pe.maxY,tt),ar=mi(Wt,at,_e+vn,_e+sn,1,Pe.minY,Pe.maxY,tt),Wt=null),tn&&(dr=mi(tn,at,_e-en,_e+Vt,1,Pe.minY,Pe.maxY,tt),ai=mi(tn,at,_e+vn,_e+sn,1,Pe.minY,Pe.maxY,tt),tn=null),ht>1&&console.timeEnd("clipping"),Re.push(ni||[],J+1,2*ae,2*_e),Re.push(ar||[],J+1,2*ae,2*_e+1),Re.push(dr||[],J+1,2*ae+1,2*_e),Re.push(ai||[],J+1,2*ae+1,2*_e+1)}}getTile(K,J,ae){K=+K,J=+J,ae=+ae;const _e=this.options,{extent:Te,debug:Me}=_e;if(K<0||K>24)return null;const Fe=1<<K,Re=la(K,J=J+Fe&Fe-1,ae);if(this.tiles[Re])return ka(this.tiles[Re],Te);Me>1&&console.log("drilling down to z%d-%d-%d",K,J,ae);let tt,ht=K,at=J,Lt=ae;for(;!tt&&ht>0;)ht--,at>>=1,Lt>>=1,tt=this.tiles[la(ht,at,Lt)];return tt&&tt.source?(Me>1&&(console.log("found parent tile z%d-%d-%d",ht,at,Lt),console.time("drilling down")),this.splitTile(tt.source,ht,at,Lt,K,J,ae),Me>1&&console.timeEnd("drilling down"),this.tiles[Re]?ka(this.tiles[Re],Te):null):null}}function la(Ae,K,J){return 32*((1<<Ae)*J+K)+Ae}class Oi extends B{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(K,J){return v._(this,void 0,void 0,function*(){const ae=K.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const _e=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!_e)return null;const Te=new Ge(_e.features,{version:2,extent:v.$});let Me=function(Fe){const Re=new v.cM;return function(tt,ht){for(const at in tt.layers)ht.writeMessage(3,je,tt.layers[at])}(Fe,Re),Re.finish()}(Te);return Me.byteOffset===0&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),{vectorTile:Te,rawData:Me.buffer}})}loadData(K){return v._(this,void 0,void 0,function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const ae=!!(K&&K.request&&K.request.collectResourceTiming)&&new v.cN(K.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(K,this._pendingRequest);const _e=yield this._pendingData;this._geoJSONIndex=K.cluster?new Ut(function({superclusterOptions:Me,clusterProperties:Fe}){if(!Fe||!Me)return Me;const Re={},tt={},ht={accumulated:null,zoom:0},at={properties:null},Lt=Object.keys(Fe);for(const Pe of Lt){const[en,vn]=Fe[Pe],Vt=v.cT(vn),sn=v.cT(typeof en=="string"?[en,["accumulated"],["get",Pe]]:en);Re[Pe]=Vt.value,tt[Pe]=sn.value}return Me.map=Pe=>{at.properties=Pe;const en={};for(const vn of Lt)en[vn]=Re[vn].evaluate(ht,at);return en},Me.reduce=(Pe,en)=>{at.properties=en;for(const vn of Lt)ht.accumulated=Pe[vn],Pe[vn]=tt[vn].evaluate(ht,at)},Me}(K)).load(_e.features):function(Me,Fe){return new Ss(Me,Fe)}(_e,K.geojsonVtOptions),this.loaded={};const Te={data:_e};if(ae){const Me=ae.finish();Me&&(Te.resourceTiming={},Te.resourceTiming[K.source]=JSON.parse(JSON.stringify(Me)))}return Te}catch(_e){if(delete this._pendingRequest,v.cy(_e))return{abandoned:!0};throw _e}})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(K){const J=this.loaded;return J&&J[K.uid]?super.reloadTile(K):this.loadTile(K)}loadAndProcessGeoJSON(K,J){return v._(this,void 0,void 0,function*(){let ae=yield this.loadGeoJSON(K,J);if(delete this._pendingRequest,typeof ae!="object")throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(pe(ae,!0),K.filter){const _e=v.cT(K.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(_e.result==="error")throw new Error(_e.value.map(Me=>`${Me.key}: ${Me.message}`).join(", "));ae={type:"FeatureCollection",features:ae.features.filter(Me=>_e.value.evaluate({zoom:0},Me))}}return ae})}loadGeoJSON(K,J){return v._(this,void 0,void 0,function*(){const{promoteId:ae}=K;if(K.request){const _e=yield v.j(K.request,J);return this._dataUpdateable=v.cV(_e.data,ae)?v.cU(_e.data,ae):void 0,_e.data}if(typeof K.data=="string")try{const _e=JSON.parse(K.data);return this._dataUpdateable=v.cV(_e,ae)?v.cU(_e,ae):void 0,_e}catch{throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`)}if(!K.dataDiff)throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${K.source}`);return v.cW(this._dataUpdateable,K.dataDiff,ae),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(K){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(K){return this._geoJSONIndex.getClusterExpansionZoom(K.clusterId)}getClusterChildren(K){return this._geoJSONIndex.getChildren(K.clusterId)}getClusterLeaves(K){return this._geoJSONIndex.getLeaves(K.clusterId,K.limit,K.offset)}}class Ur{constructor(K){this.self=K,this.actor=new v.J(K),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(J,ae)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=ae},this.self.addProtocol=v.cA,this.self.removeProtocol=v.cB,this.self.registerRTLTextPlugin=J=>{v.cX.setMethods(J)},this.actor.registerMessageHandler("LDT",(J,ae)=>this._getDEMWorkerSource(J,ae.source).loadTile(ae)),this.actor.registerMessageHandler("RDT",(J,ae)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,ae.source).removeTile(ae)})),this.actor.registerMessageHandler("GCEZ",(J,ae)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ae.type,ae.source).getClusterExpansionZoom(ae)})),this.actor.registerMessageHandler("GCC",(J,ae)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ae.type,ae.source).getClusterChildren(ae)})),this.actor.registerMessageHandler("GCL",(J,ae)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ae.type,ae.source).getClusterLeaves(ae)})),this.actor.registerMessageHandler("LD",(J,ae)=>this._getWorkerSource(J,ae.type,ae.source).loadData(ae)),this.actor.registerMessageHandler("GD",(J,ae)=>this._getWorkerSource(J,ae.type,ae.source).getData()),this.actor.registerMessageHandler("LT",(J,ae)=>this._getWorkerSource(J,ae.type,ae.source).loadTile(ae)),this.actor.registerMessageHandler("RT",(J,ae)=>this._getWorkerSource(J,ae.type,ae.source).reloadTile(ae)),this.actor.registerMessageHandler("AT",(J,ae)=>this._getWorkerSource(J,ae.type,ae.source).abortTile(ae)),this.actor.registerMessageHandler("RMT",(J,ae)=>this._getWorkerSource(J,ae.type,ae.source).removeTile(ae)),this.actor.registerMessageHandler("RS",(J,ae)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[J]||!this.workerSources[J][ae.type]||!this.workerSources[J][ae.type][ae.source])return;const _e=this.workerSources[J][ae.type][ae.source];delete this.workerSources[J][ae.type][ae.source],_e.removeSource!==void 0&&_e.removeSource(ae)})),this.actor.registerMessageHandler("RM",J=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],this.globalStates.delete(J)})),this.actor.registerMessageHandler("SR",(J,ae)=>v._(this,void 0,void 0,function*(){this.referrer=ae})),this.actor.registerMessageHandler("SRPS",(J,ae)=>this._syncRTLPluginState(J,ae)),this.actor.registerMessageHandler("IS",(J,ae)=>v._(this,void 0,void 0,function*(){this.self.importScripts(ae)})),this.actor.registerMessageHandler("SI",(J,ae)=>this._setImages(J,ae)),this.actor.registerMessageHandler("UL",(J,ae)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(J).update(ae.layers,ae.removedIds,this._getGlobalState(J))})),this.actor.registerMessageHandler("UGS",(J,ae)=>v._(this,void 0,void 0,function*(){const _e=this._getGlobalState(J);for(const Te in ae)_e[Te]=ae[Te]})),this.actor.registerMessageHandler("SL",(J,ae)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(ae,this._getGlobalState(J))}))}_getGlobalState(K){let J=this.globalStates.get(K);return J||(J={},this.globalStates.set(K,J)),J}_setImages(K,J){return v._(this,void 0,void 0,function*(){this.availableImages[K]=J;for(const ae in this.workerSources[K]){const _e=this.workerSources[K][ae];for(const Te in _e)_e[Te].availableImages=J}})}_syncRTLPluginState(K,J){return v._(this,void 0,void 0,function*(){return yield v.cX.syncState(J,this.self.importScripts)})}_getAvailableImages(K){let J=this.availableImages[K];return J||(J=[]),J}_getLayerIndex(K){let J=this.layerIndexes[K];return J||(J=this.layerIndexes[K]=new c),J}_getWorkerSource(K,J,ae){if(this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][J]||(this.workerSources[K][J]={}),!this.workerSources[K][J][ae]){const _e={sendAsync:(Te,Me)=>(Te.targetMapId=K,this.actor.sendAsync(Te,Me))};switch(J){case"vector":this.workerSources[K][J][ae]=new B(_e,this._getLayerIndex(K),this._getAvailableImages(K));break;case"geojson":this.workerSources[K][J][ae]=new Oi(_e,this._getLayerIndex(K),this._getAvailableImages(K));break;default:this.workerSources[K][J][ae]=new this.externalWorkerSourceTypes[J](_e,this._getLayerIndex(K),this._getAvailableImages(K))}}return this.workerSources[K][J][ae]}_getDEMWorkerSource(K,J){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][J]||(this.demWorkerSources[K][J]=new V),this.demWorkerSources[K][J]}}return v.i(self)&&(self.worker=new Ur(self)),Ur}),m("index",["exports","./shared"],function(v,c){var C="5.7.2";function R(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let z,B;const V={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,e,o){const f=requestAnimationFrame(T=>{y(),e(T)}),{unsubscribe:y}=c.s(b.signal,"abort",()=>{y(),cancelAnimationFrame(f),o(c.c())},!1)},frameAsync(b){return new Promise((e,o)=>{this.frame(b,e,o)})},getImageData(b,e=0){return this.getImageCanvasContext(b).getImageData(-e,-e,b.width+2*e,b.height+2*e)},getImageCanvasContext(b){const e=window.document.createElement("canvas"),o=e.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return e.width=b.width,e.height=b.height,o.drawImage(b,0,0,b.width,b.height),o},resolveURL:b=>(z||(z=document.createElement("a")),z.href=b,z.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class G{static testProp(e){if(!G.docStyle)return e[0];for(let o=0;o<e.length;o++)if(e[o]in G.docStyle)return e[o];return e[0]}static create(e,o,f){const y=window.document.createElement(e);return o!==void 0&&(y.className=o),f&&f.appendChild(y),y}static createNS(e,o){return window.document.createElementNS(e,o)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(e,o){e.style[G.transformProp]=o}static addEventListener(e,o,f,y={}){e.addEventListener(o,f,"passive"in y?y:y.capture)}static removeEventListener(e,o,f,y={}){e.removeEventListener(o,f,"passive"in y?y:y.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static getScale(e){const o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}static getPoint(e,o,f){const y=o.boundingClientRect;return new c.P((f.clientX-y.left)/o.x-e.clientLeft,(f.clientY-y.top)/o.y-e.clientTop)}static mousePos(e,o){const f=G.getScale(e);return G.getPoint(e,f,o)}static touchPos(e,o){const f=[],y=G.getScale(e);for(let T=0;T<o.length;T++)f.push(G.getPoint(e,y,o[T]));return f}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const o=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),f=o.querySelectorAll("script");for(const y of f)y.remove();return G.clean(o),o.innerHTML}static isPossiblyDangerous(e,o){const f=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!f.includes("javascript:")&&!f.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const o=e.children;for(const f of o)G.removeAttributes(f),G.clean(f)}static removeAttributes(e){for(const{name:o,value:f}of e.attributes)G.isPossiblyDangerous(o,f)&&e.removeAttribute(o)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);const re={supported:!1,testSupport:function(b){!Ie&&pe&&(Ge?je(b):fe=b)}};let fe,pe,Ie=!1,Ge=!1;function je(b){const e=b.createTexture();b.bindTexture(b.TEXTURE_2D,e);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,pe),b.isContextLost())return;re.supported=!0}catch{}b.deleteTexture(e),Ie=!0}var He;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{fe&&je(fe),fe=null,Ge=!0},pe.onerror=()=>{Ie=!0,fe=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let e,o,f,y;b.resetRequestQueue=()=>{e=[],o=0,f=0,y={}},b.addThrottleControl=I=>{const O=f++;return y[O]=I,O},b.removeThrottleControl=I=>{delete y[I],E()},b.getImage=(I,O,j=!0)=>new Promise((Z,U)=>{re.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),c.e(I,{type:"image"}),e.push({abortController:O,requestParameters:I,supportImageRefresh:j,state:"queued",onError:Y=>{U(Y)},onSuccess:Y=>{Z(Y)}}),E()});const T=I=>c._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:O,supportImageRefresh:j,onError:Z,onSuccess:U,abortController:Y}=I,Q=j===!1&&!c.i(self)&&!c.g(O.url)&&(!O.headers||Object.keys(O.headers).reduce((ue,he)=>ue&&he==="accept",!0));o++;const le=Q?k(O,Y):c.m(O,Y);try{const ue=yield le;delete I.abortController,I.state="completed",ue.data instanceof HTMLImageElement||c.b(ue.data)?U(ue):ue.data&&U({data:yield(oe=ue.data,typeof createImageBitmap=="function"?c.f(oe):c.h(oe)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete I.abortController,Z(ue)}finally{o--,E()}var oe}),E=()=>{const I=(()=>{for(const O of Object.keys(y))if(y[O]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=o;O<I&&e.length>0;O++){const j=e.shift();j.abortController.signal.aborted?O--:T(j)}},k=(I,O)=>new Promise((j,Z)=>{const U=new Image,Y=I.url,Q=I.credentials;Q&&Q==="include"?U.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!c.d(Y))&&(U.crossOrigin="anonymous"),O.signal.addEventListener("abort",()=>{U.src="",Z(c.c())}),U.fetchPriority="high",U.onload=()=>{U.onerror=U.onload=null,j({data:U})},U.onerror=()=>{U.onerror=U.onload=null,O.signal.aborted||Z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},U.src=Y})}(He||(He={})),He.resetRequestQueue();class Ve{constructor(e){this._transformRequestFn=e??null}transformRequest(e,o){return this._transformRequestFn&&this._transformRequestFn(e,o)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function rt(b){const e=[];if(typeof b=="string")e.push({id:"default",url:b});else if(b&&b.length>0){const o=[];for(const{id:f,url:y}of b){const T=`${f}${y}`;o.indexOf(T)===-1&&(o.push(T),e.push({id:f,url:y}))}}return e}function Je(b,e,o){try{const f=new URL(b);return f.pathname+=`${e}${o}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Mt(b){const{userImage:e}=b;return!!(e&&e.render&&e.render())&&(b.data.replace(new Uint8Array(e.data.buffer)),!0)}class Ne extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:o,promiseResolve:f}of this.requestors)f(this._getImagesForIds(o));this.requestors=[]}}getImage(e){const o=this.images[e];if(o&&!o.data&&o.spriteData){const f=o.spriteData;o.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),o.spriteData=null}return o}addImage(e,o){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,o)&&(this.images[e]=o)}_validate(e,o){let f=!0;const y=o.data||o.spriteData;return this._validateStretch(o.stretchX,y&&y.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),f=!1),this._validateStretch(o.stretchY,y&&y.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),f=!1),this._validateContent(o.content,o)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),f=!1),f}_validateStretch(e,o){if(!e)return!0;let f=0;for(const y of e){if(y[0]<f||y[1]<y[0]||o<y[1])return!1;f=y[1]}return!0}_validateContent(e,o){if(!e)return!0;if(e.length!==4)return!1;const f=o.spriteData,y=f&&f.width||o.data.width,T=f&&f.height||o.data.height;return!(e[0]<0||y<e[0]||e[1]<0||T<e[1]||e[2]<0||y<e[2]||e[3]<0||T<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,o,f=!0){const y=this.getImage(e);if(f&&(y.data.width!==o.data.width||y.data.height!==o.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=y.version+1,this.images[e]=o,this.updatedImages[e]=!0}removeImage(e){const o=this.images[e];delete this.images[e],delete this.patterns[e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((o,f)=>{let y=!0;if(!this.isLoaded())for(const T of e)this.images[T]||(y=!1);this.isLoaded()||y?o(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:o})})}_getImagesForIds(e){const o={};for(const f of e){let y=this.getImage(f);y||(this.fire(new c.l("styleimagemissing",{id:f})),y=this.getImage(f)),y?o[f]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,textFitWidth:y.textFitWidth,textFitHeight:y.textFitHeight,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:e,height:o}=this.atlasImage;return{width:e,height:o}}getPattern(e){const o=this.patterns[e],f=this.getImage(e);if(!f)return null;if(o&&o.position.version===f.version)return o.position;if(o)o.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},T=new c.I(y,f);this.patterns[e]={bin:y,position:T}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const o=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const T in this.patterns)e.push(this.patterns[T].bin);const{w:o,h:f}=c.p(e),y=this.atlasImage;y.resize({width:o||1,height:f||1});for(const T in this.patterns){const{bin:E}=this.patterns[T],k=E.x+1,I=E.y+1,O=this.getImage(T).data,j=O.width,Z=O.height;c.R.copy(O,y,{x:0,y:0},{x:k,y:I},{width:j,height:Z}),c.R.copy(O,y,{x:0,y:Z-1},{x:k,y:I-1},{width:j,height:1}),c.R.copy(O,y,{x:0,y:0},{x:k,y:I+Z},{width:j,height:1}),c.R.copy(O,y,{x:j-1,y:0},{x:k-1,y:I},{width:1,height:Z}),c.R.copy(O,y,{x:0,y:0},{x:k+j,y:I},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const o of e){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const f=this.getImage(o);f||c.w(`Image with ID: "${o}" was not found`),Mt(f)&&this.updateImage(o,f)}}}const Xe=1e20;function _t(b,e,o,f,y,T,E,k,I){for(let O=e;O<e+f;O++)Rt(b,o*T+O,T,y,E,k,I);for(let O=o;O<o+y;O++)Rt(b,O*T+e,1,f,E,k,I)}function Rt(b,e,o,f,y,T,E){T[0]=0,E[0]=-Xe,E[1]=Xe,y[0]=b[e];for(let k=1,I=0,O=0;k<f;k++){y[k]=b[e+k*o];const j=k*k;do{const Z=T[I];O=(y[k]-y[Z]+j-Z*Z)/(k-Z)/2}while(O<=E[I]&&--I>-1);I++,T[I]=k,E[I]=O,E[I+1]=Xe}for(let k=0,I=0;k<f;k++){for(;E[I+1]<k;)I++;const O=T[I],j=k-O;b[e+k*o]=y[O]+j*j}}class Ut{constructor(e,o,f){this.requestManager=e,this.localIdeographFontFamily=o,this.entries={},this.lang=f}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const o=[];for(const T in e)for(const E of e[T])o.push(this._getAndCacheGlyphsPromise(T,E));const f=yield Promise.all(o),y={};for(const{stack:T,id:E,glyph:k}of f)y[T]||(y[T]={}),y[T][E]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return y})}_getAndCacheGlyphsPromise(e,o){return c._(this,void 0,void 0,function*(){let f=this.entries[e];f||(f=this.entries[e]={glyphs:{},requests:{},ranges:{}});let y=f.glyphs[o];if(y!==void 0)return{stack:e,id:o,glyph:y};if(y=this._tinySDF(f,e,o),y)return f.glyphs[o]=y,{stack:e,id:o,glyph:y};const T=Math.floor(o/256);if(256*T>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[T])return{stack:e,id:o,glyph:y};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[T]){const k=Ut.loadGlyphRange(e,T,this.url,this.requestManager);f.requests[T]=k}const E=yield f.requests[T];for(const k in E)this._doesCharSupportLocalGlyph(+k)||(f.glyphs[+k]=E[+k]);return f.ranges[T]=!0,{stack:e,id:o,glyph:E[o]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,o,f){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let T=e.tinySDF;if(!T){let k="400";/bold/i.test(o)?k="900":/medium/i.test(o)?k="500":/light/i.test(o)&&(k="200"),T=e.tinySDF=new Ut.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:y,fontWeight:k})}const E=T.draw(String.fromCharCode(f));return{id:f,bitmap:new c.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ut.loadGlyphRange=function(b,e,o,f){return c._(this,void 0,void 0,function*(){const y=256*e,T=y+255,E=f.transformRequest(o.replace("{fontstack}",b).replace("{range}",`${y}-${T}`),"Glyphs"),k=yield c.n(E,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${e}, ${y}-${T}`);const I={};for(const O of c.o(k.data))I[O.id]=O;return I})},Ut.TinySDF=class{constructor({fontSize:b=24,buffer:e=3,radius:o=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:T="normal",fontStyle:E="normal",lang:k=null}={}){this.buffer=e,this.cutoff=f,this.radius=o,this.lang=k;const I=this.size=b+4*e,O=this._createCanvas(I),j=this.ctx=O.getContext("2d",{willReadFrequently:!0});j.font=`${E} ${T} ${b}px ${y}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(b){const e=document.createElement("canvas");return e.width=e.height=b,e}draw(b){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:T}=this.ctx.measureText(b),E=Math.ceil(o),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-y))),I=Math.min(this.size-this.buffer,E+Math.ceil(f)),O=k+2*this.buffer,j=I+2*this.buffer,Z=Math.max(O*j,0),U=new Uint8ClampedArray(Z),Y={data:U,width:O,height:j,glyphWidth:k,glyphHeight:I,glyphTop:E,glyphLeft:0,glyphAdvance:e};if(k===0||I===0)return Y;const{ctx:Q,buffer:le,gridInner:oe,gridOuter:ue}=this;this.lang&&(Q.lang=this.lang),Q.clearRect(le,le,k,I),Q.fillText(b,le,le+E);const he=Q.getImageData(le,le,k,I);ue.fill(Xe,0,Z),oe.fill(0,0,Z);for(let ye=0;ye<I;ye++)for(let me=0;me<k;me++){const xe=he.data[4*(ye*k+me)+3]/255;if(xe===0)continue;const Ee=(ye+le)*O+me+le;if(xe===1)ue[Ee]=0,oe[Ee]=Xe;else{const ge=.5-xe;ue[Ee]=ge>0?ge*ge:0,oe[Ee]=ge<0?ge*ge:0}}_t(ue,0,0,O,j,O,this.f,this.v,this.z),_t(oe,le,le,k,I,O,this.f,this.v,this.z);for(let ye=0;ye<Z;ye++){const me=Math.sqrt(ue[ye])-Math.sqrt(oe[ye]);U[ye]=Math.round(255-255*(me/this.radius+this.cutoff))}return Y}};class un{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,o){return c.B(e.expression.evaluate(o))}interpolate(e,o,f){return{x:c.C.number(e.x,o.x,f),y:c.C.number(e.y,o.y,f),z:c.C.number(e.z,o.z,f)}}}let Ht;class Ue extends c.E{constructor(e){super(),Ht=Ht||new c.r({anchor:new c.D(c.v.light.anchor),position:new un,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(Ht,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,o={}){if(!this._validate(c.x,e,o))for(const f in e){const y=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,f){return(!f||f.validate!==!1)&&c.y(this,e.call(c.z,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const ft=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Dt extends c.E{constructor(e){super(),this._transitionable=new c.t(ft,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,o={}){if(!this._validate(c.G,e,o)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in e){const y=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,f={}){return f?.validate!==!1&&c.y(this,e.call(c.z,c.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class It{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,o){const f=e.join(",")+String(o);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(e,o)),this.dashEntry[f]}getDashRanges(e,o,f){const y=[];let T=e.length%2==1?-e[e.length-1]*f:0,E=e[0]*f,k=!0;y.push({left:T,right:E,isDash:k,zeroLength:e[0]===0});let I=e[0];for(let O=1;O<e.length;O++){k=!k;const j=e[O];T=I*f,I+=j,E=I*f,y.push({left:T,right:E,isDash:k,zeroLength:j===0})}return y}addRoundDash(e,o,f){const y=o/2;for(let T=-f;T<=f;T++){const E=this.width*(this.nextRow+f+T);let k=0,I=e[k];for(let O=0;O<this.width;O++){O/I.right>1&&(I=e[++k]);const j=Math.abs(O-I.left),Z=Math.abs(O-I.right),U=Math.min(j,Z);let Y;const Q=T/f*(y+1);if(I.isDash){const le=y-Math.abs(Q);Y=Math.sqrt(U*U+le*le)}else Y=y-Math.sqrt(U*U+Q*Q);this.data[E+O]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(e){for(let k=e.length-1;k>=0;--k){const I=e[k],O=e[k+1];I.zeroLength?e.splice(k,1):O&&O.isDash===I.isDash&&(O.left=I.left,e.splice(k,1))}const o=e[0],f=e[e.length-1];o.isDash===f.isDash&&(o.left=f.left-this.width,f.right=o.right+this.width);const y=this.width*this.nextRow;let T=0,E=e[T];for(let k=0;k<this.width;k++){k/E.right>1&&(E=e[++T]);const I=Math.abs(k-E.left),O=Math.abs(k-E.right),j=Math.min(I,O);this.data[y+k]=Math.max(0,Math.min(255,(E.isDash?j:-j)+128))}}addDash(e,o){const f=o?7:0,y=2*f+1;if(this.nextRow+y>this.height)return c.w("LineAtlas out of space"),null;let T=0;for(let k=0;k<e.length;k++)T+=e[k];if(T!==0){const k=this.width/T,I=this.getDashRanges(e,this.width,k);o?this.addRoundDash(I,k,f):this.addRegularDash(I)}const E={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:T};return this.nextRow+=y,this.dirty=!0,E}bind(e){const o=e.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const be="maplibre_preloaded_worker_pool";class et{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<et.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[be]}numActive(){return Object.keys(this.active).length}}const Et=Math.floor(V.hardwareConcurrency/2);let bt,Pt;function Xt(){return bt||(bt=new et),bt}et.workerCount=c.H(globalThis)?Math.max(Math.min(Et,3),1):1;class Bt{constructor(e,o){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=o;const f=this.workerPool.acquire(o);for(let y=0;y<f.length;y++){const T=new c.J(f[y],o);T.name=`Worker ${y}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,o){const f=[];for(const y of this.actors)f.push(y.sendAsync({type:e,data:o}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,o){for(const f of this.actors)f.registerMessageHandler(e,o)}}function wi(){return Pt||(Pt=new Bt(Xt(),c.K),Pt.registerMessageHandler("GR",(b,e,o)=>c.m(e,o))),Pt}function fn(b,e){const o=c.L();return c.M(o,o,[1,1,0]),c.N(o,o,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.O(o,o,b.calculatePosMatrix(e.toUnwrapped())):o}function mi(b,e,o,f,y,T,E){var k;const I=function(U,Y,Q){if(U)for(const le of U){const oe=Y[le];if(oe&&oe.source===Q&&oe.type==="fill-extrusion")return!0}else for(const le in Y){const oe=Y[le];if(oe.source===Q&&oe.type==="fill-extrusion")return!0}return!1}((k=y?.layers)!==null&&k!==void 0?k:null,e,b.id),O=T.maxPitchScaleFactor(),j=b.tilesIn(f,O,I);j.sort(ya);const Z=[];for(const U of j)Z.push({wrappedTileID:U.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(e,o,b._state,U.queryGeometry,U.cameraQueryGeometry,U.scale,y,T,O,fn(b.transform,U.tileID),E?(Y,Q)=>E(U.tileID,Y,Q):void 0)});return function(U,Y){for(const Q in U)for(const le of U[Q])sa(le,Y);return U}(function(U){const Y={},Q={};for(const le of U){const oe=le.queryResults,ue=le.wrappedTileID,he=Q[ue]=Q[ue]||{};for(const ye in oe){const me=oe[ye],xe=he[ye]=he[ye]||{},Ee=Y[ye]=Y[ye]||[];for(const ge of me)xe[ge.featureIndex]||(xe[ge.featureIndex]=!0,Ee.push(ge))}}return Y}(Z),b)}function ya(b,e){const o=b.tileID,f=e.tileID;return o.overscaledZ-f.overscaledZ||o.canonical.y-f.canonical.y||o.wrap-f.wrap||o.canonical.x-f.canonical.x}function sa(b,e){const o=b.feature,f=e.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=f}function rr(b,e,o){return c._(this,void 0,void 0,function*(){let f=b;if(b.url?f=(yield c.j(e.transformRequest(b.url,"Source"),o)).data:yield V.frameAsync(o),!f)return null;const y=c.Q(c.e(f,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(y.vectorLayerIds=f.vector_layers.map(T=>T.id)),y})}class Yn{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const o=this._sw,f=this._ne;let y,T;if(e instanceof c.S)y=e,T=e;else{if(!(e instanceof Yn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Yn.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(y=e._sw,T=e._ne,!y||!T)return this}return o||f?(o.lng=Math.min(y.lng,o.lng),o.lat=Math.min(y.lat,o.lat),f.lng=Math.max(T.lng,f.lng),f.lat=Math.max(T.lat,f.lat)):(this._sw=new c.S(y.lng,y.lat),this._ne=new c.S(T.lng,T.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:f}=c.S.convert(e);let y=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}static convert(e){return e instanceof Yn?e:e&&new Yn(e)}static fromLngLat(e,o=0){const f=360*o/40075017,y=f/Math.cos(Math.PI/180*e.lat);return new Yn(new c.S(e.lng-y,e.lat-f),new c.S(e.lng+y,e.lat+f))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),o=new c.S(this._ne.lng,this._ne.lat);return new Yn(e,e.lng>o.lng?new c.S(o.lng+360,o.lat):o)}}class Wn{constructor(e,o,f){this.bounds=Yn.convert(this.validateBounds(e)),this.minzoom=o||0,this.maxzoom=f||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const o=Math.pow(2,e.z),f=Math.floor(c.V(this.bounds.getWest())*o),y=Math.floor(c.U(this.bounds.getNorth())*o),T=Math.ceil(c.V(this.bounds.getEast())*o),E=Math.ceil(c.U(this.bounds.getSouth())*o);return e.x>=f&&e.x<T&&e.y>=y&&e.y<E}}class Nn extends c.E{constructor(e,o,f,y){if(super(),this.id=e,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(o,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Wn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(o,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};f.request.collectResourceTiming=this._collectResourceTiming;let y="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((T,E)=>{e.reloadPromise={resolve:T,reject:E}})}else e.actor=this.dispatcher.getActor(),y="LT";e.abortController=new AbortController;try{const T=yield e.actor.sendAsync({type:y,data:f},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,T)}catch(T){if(delete e.abortController,e.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,o){if(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),e.reloadPromise){const f=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(f.resolve).catch(f.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Br extends c.E{constructor(e,o,f,y){super(),this.id=e,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},o),c.e(this,c.Q(o,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(c.e(this,o),o.bounds&&(this.tileBounds=new Wn(o.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(o))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const f=yield He.getImage(this.map._requestManager.transformRequest(o,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const y=this.map.painter.context,T=y.gl,E=f.data;e.texture=this.map.painter.getTileTexture(E.width),e.texture?e.texture.update(E,{useMipmap:!0}):(e.texture=new c.T(y,E,T.RGBA,{useMipmap:!0}),e.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Li extends Br{constructor(e,o,f,y){super(e,o,f,y),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(o,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const y=yield He.getImage(f,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(y&&y.data){const T=y.data;this.map._refreshExpiredTiles&&(y.cacheControl||y.expires)&&e.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const E=c.b(T)&&c.W()?T:yield this.readImageNow(T),k={type:this.type,uid:e.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const I=yield e.actor.sendAsync({type:"LDT",data:k});e.dem=I,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(y){if(delete e.abortController,e.aborted)e.state="unloaded";else if(y)throw e.state="errored",y}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const o=e.width+2,f=e.height+2;try{return new c.R({width:o,height:f},yield c.Y(e,-1,-1,o,f))}catch{}}return V.getImageData(e,1)})}_getNeighboringTiles(e){const o=e.canonical,f=Math.pow(2,o.z),y=(o.x-1+f)%f,T=o.x===0?e.wrap-1:e.wrap,E=(o.x+1+f)%f,k=o.x+1===f?e.wrap+1:e.wrap,I={};return I[new c.Z(e.overscaledZ,T,o.z,y,o.y).key]={backfilled:!1},I[new c.Z(e.overscaledZ,k,o.z,E,o.y).key]={backfilled:!1},o.y>0&&(I[new c.Z(e.overscaledZ,T,o.z,y,o.y-1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,e.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,k,o.z,E,o.y-1).key]={backfilled:!1}),o.y+1<f&&(I[new c.Z(e.overscaledZ,T,o.z,y,o.y+1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,e.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,k,o.z,E,o.y+1).key]={backfilled:!1}),I}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Ka extends c.E{constructor(e,o,f,y){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:o.data},this.actor=f.getActor(),this.setEventedParent(y),this._data=o.data,this._options=c.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(o.clusterMaxZoom),minPoints:Math.max(2,o.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const o=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${o}"`),o}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(o=>o.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const e=new Yn,o=yield this.getData();let f;switch(o.type){case"FeatureCollection":f=o.features.map(y=>this.getCoordinatesFromGeometry(y.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(o.geometry);break;default:f=this.getCoordinatesFromGeometry(o)}if(f.length==0)return e;for(let y=0;y<f.length-1;y+=2)e.extend([f[y],f[y+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,o,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:o,offset:f}})}_updateWorkerData(){return c._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:e,diff:o}=this._pendingWorkerUpdate;if(!e&&!o)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=c.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(f.request=this.map._requestManager.transformRequest(V.resolveURL(e),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):o&&(f.dataDiff=o,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const y=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||y.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=y.data;let T=null;y.resourceTiming&&y.resourceTiming[this.id]&&(T=y.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&T&&T.length>0&&c.e(E,{resourceTiming:T}),this.fire(new c.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(y){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(y))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.actor?"RT":"LT";e.actor=this.actor;const f={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const y=yield this.actor.sendAsync({type:o,data:f},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(y,this.map.painter,o==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class ka extends c.E{constructor(e,o,f,y){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=f,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=o}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield He.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,e&&(this.coordinates=e),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new c.k(o))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const o=e.map(c.a1.fromLngLat);var f;return this.tileID=function(y){const T=c.a2.fromPoints(y),E=T.width(),k=T.height(),I=Math.max(E,k),O=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),j=Math.pow(2,O);return new c.a4(O,Math.floor((T.minX+T.maxX)/2*j),Math.floor((T.minY+T.maxY)/2*j))}(o),this.terrainTileRanges=this._getOverlappingTileRanges(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map(y=>this.tileID.getTilePoint(y)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,o=e.gl;this.texture||(this.texture=new c.T(e,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const T=this.tiles[y];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:o,minY:f,maxX:y,maxY:T}=c.a2.fromPoints(e),E={};for(let k=0;k<=c.a3;k++){const I=Math.pow(2,k),O=Math.floor(o*I),j=Math.floor(f*I),Z=Math.floor(y*I),U=Math.floor(T*I);E[k]={minTileX:O,minTileY:j,maxTileX:Z,maxTileY:U}}return E}}class oa extends ka{constructor(e,o,f,y){super(e,o,f,y),this.roundZoom=!0,this.type="video",this.options=o}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const o of e.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield c.a5(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new c.k(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const o=this.video.seekable;e<o.start(0)||e>o.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,o=e.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const T=this.tiles[y];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Fr extends ka{constructor(e,o,f,y){super(e,o,f,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(T=>!Array.isArray(T)||T.length!==2||T.some(E=>typeof E!="number"))||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,f=o.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(o,this.canvas,f.RGBA,{premultiply:!0});let y=!1;for(const T in this.tiles){const E=this.tiles[T];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ws={},Ja=b=>{switch(b){case"geojson":return Ka;case"image":return ka;case"raster":return Br;case"raster-dem":return Li;case"vector":return Nn;case"video":return oa;case"canvas":return Fr}return ws[b]},Ts="RTLPluginLoaded";class Ss extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=wi()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(o,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=V.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Ts))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let la=null;function Oi(){return la||(la=new Ss),la}class Ur{constructor(e,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a7(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const o=e+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,o,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(y,T){const E={};if(!T)return E;for(const k of y){const I=k.layerIds.map(O=>T.getLayer(O)).filter(Boolean);if(I.length!==0){k.layers=I,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(O=>I.filter(j=>j.id===O)[0]));for(const O of I)E[O.id]=k}}return E}(e.buckets,o?.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const T=this.buckets[y];if(T instanceof c.a9){if(this.hasSymbolBuckets=!0,!f)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const T=this.buckets[y];if(T instanceof c.a9&&T.hasRTLText){this.hasRTLText=!0,Oi().lazyLoad();break}}this.queryPadding=0;for(const y in this.buckets){const T=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(y).queryRadius(T))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,f,y,T,E,k,I,O,j,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:T,scale:E,tileSize:this.tileSize,pixelPosMatrix:j,transform:I,params:k,queryPadding:this.queryPadding*O,getElevation:Z},e,o,f):{}}querySourceFeatures(e,o){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),T=o&&o.sourceLayer?o.sourceLayer:"",E=y._geojsonTileLayer||y[T];if(!E)return;const k=c.aa(o?.filter,o?.globalState),{z:I,x:O,y:j}=this.tileID.canonical,Z={z:I,x:O,y:j};for(let U=0;U<E.length;U++){const Y=E.feature(U);if(k.needGeometry){const oe=c.ab(Y,!0);if(!k.filter(new c.F(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!k.filter(new c.F(this.tileID.overscaledZ),Y))continue;const Q=f.getId(Y,T),le=new c.ac(Y,I,O,j,Q);le.tile=Z,e.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const f=c.ad(e.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{const T=this.expirationTime-o;T?this.expirationTime=f+Math.max(T,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!o.style.hasLayer(y))continue;const T=this.buckets[y],E=T.layers[0].sourceLayer||"_geojsonTileLayer",k=f[E],I=e[E];if(!k||!I||Object.keys(I).length===0)continue;T.update(I,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=o&&o.style&&o.style.getLayer(y);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(T)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<V.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=V.now()+e}setDependencies(e,o){const f={};for(const y of o)f[y]=!0;this.dependencies[e]=f}hasDependency(e,o){for(const f of e){const y=this.dependencies[f];if(y){for(const T of o)if(y[T])return!0}}return!1}}class Ae{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,f){const y=e.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const T={value:o,timeout:void 0};if(f!==void 0&&(T.timeout=setTimeout(()=>{this.remove(e,T)},f)),this.data[y].push(T),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const f=e.wrapped().key,y=o===void 0?0:this.data[f].indexOf(o),T=this.data[f][y];return this.data[f].splice(y,1),T.timeout&&clearTimeout(T.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(T.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const f in this.data)for(const y of this.data[f])e(y.value)||o.push(y);for(const f of o)this.remove(f.value.tileID,f)}}class K{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,f){const y=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][y]=this.stateChanges[e][y]||{},c.e(this.stateChanges[e][y],f),this.deletedStates[e]===null){this.deletedStates[e]={};for(const T in this.state[e])T!==y&&(this.deletedStates[e][T]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][y]===null){this.deletedStates[e][y]={};for(const T in this.state[e][y])f[T]||(this.deletedStates[e][y][T]=null)}else for(const T in f)this.deletedStates[e]&&this.deletedStates[e][y]&&this.deletedStates[e][y][T]===null&&delete this.deletedStates[e][y][T]}removeFeatureState(e,o,f){if(this.deletedStates[e]===null)return;const y=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},f&&o!==void 0)this.deletedStates[e][y]!==null&&(this.deletedStates[e][y]=this.deletedStates[e][y]||{},this.deletedStates[e][y][f]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][y])for(f in this.deletedStates[e][y]={},this.stateChanges[e][y])this.deletedStates[e][y][f]=null;else this.deletedStates[e][y]=null;else this.deletedStates[e]=null}getState(e,o){const f=String(o),y=c.e({},(this.state[e]||{})[f],(this.stateChanges[e]||{})[f]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const T=this.deletedStates[e][o];if(T===null)return{};for(const E in T)delete y[E]}return y}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const T={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),c.e(this.state[y][E],this.stateChanges[y][E]),T[E]=this.state[y][E];f[y]=T}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const T={};if(this.deletedStates[y]===null)for(const E in this.state[y])T[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else for(const k of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][k];T[E]=this.state[y][E]}f[y]=f[y]||{},c.e(f[y],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const y in e)e[y].setFeatureState(f,o)}}const J=89.25;function ae(b,e){const o=c.ah(e.lat,-c.ai,c.ai);return new c.P(c.V(e.lng)*b,c.U(o)*b)}function _e(b,e){return new c.a1(e.x/b,e.y/b).toLngLat()}function Te(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-b.pitch)),Math.tan(c.ae(J-b.pitch)))}function Me(b,e){const o=b.canonical,f=e/c.af(o.z),y=o.x+Math.pow(2,o.z)*b.wrap,T=c.ag(new Float64Array(16));return c.M(T,T,[y*f,o.y*f,0]),c.N(T,T,[f/c.$,f/c.$,1]),T}function Fe(b,e,o,f,y){const T=c.a1.fromLngLat(b,e),E=y*c.aj(1,b.lat),k=E*Math.cos(c.ae(o)),I=Math.sqrt(E*E-k*k),O=I*Math.sin(c.ae(-f)),j=I*Math.cos(c.ae(-f));return new c.a1(T.x+O,T.y+j,T.z+k)}function Re(b,e,o){const f=e.intersectsFrustum(b);if(!o||f===0)return f;const y=e.intersectsPlane(o);return y===0?0:f===2&&y===2?2:1}function tt(b,e,o){let f=0;const y=(o-e)/10;for(let T=0;T<10;T++)f+=y*Math.pow(Math.cos(e+(T+.5)/10*(o-e)),b);return f}function ht(b,e){return function(o,f,y,T,E){const k=2*((b-1)/c.ak(Math.cos(c.ae(J-E))/Math.cos(c.ae(J)))-1),I=Math.acos(y/T),O=2*tt(k-1,0,c.ae(E/2)),j=Math.min(c.ae(J),I+c.ae(E/2)),Z=tt(k-1,Math.min(j,I-c.ae(E/2)),j),U=Math.atan(f/y),Y=Math.hypot(f,y);let Q=o;return Q+=c.ak(T/Y/Math.max(.5,Math.cos(c.ae(E/2)))),Q+=k*c.ak(Math.cos(U))/2,Q-=c.ak(Math.max(1,Z/O/e))/2,Q}}const at=ht(9.314,3);function Lt(b,e){const o=(e.roundZoom?Math.round:Math.floor)(b.zoom+c.ak(b.tileSize/e.tileSize));return Math.max(0,o)}function Pe(b,e){const o=b.getCameraFrustum(),f=b.getClippingPlane(),y=b.screenPointToMercatorCoordinate(b.getCameraPoint()),T=c.a1.fromLngLat(b.center,b.elevation);y.z=T.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const E=b.getCoveringTilesDetailsProvider(),k=E.allowVariableZoom(b,e),I=Lt(b,e),O=e.minzoom||0,j=e.maxzoom!==void 0?e.maxzoom:b.maxZoom,Z=Math.min(Math.max(0,I),j),U=Math.pow(2,Z),Y=[U*y.x,U*y.y,0],Q=[U*T.x,U*T.y,0],le=Math.hypot(T.x-y.x,T.y-y.y),oe=Math.abs(T.z-y.z),ue=Math.hypot(le,oe),he=xe=>({zoom:0,x:0,y:0,wrap:xe,fullyVisible:!1}),ye=[],me=[];if(b.renderWorldCopies&&E.allowWorldCopies())for(let xe=1;xe<=3;xe++)ye.push(he(-xe)),ye.push(he(xe));for(ye.push(he(0));ye.length>0;){const xe=ye.pop(),Ee=xe.x,ge=xe.y;let De=xe.fullyVisible;const qe={x:Ee,y:ge,z:xe.zoom},Le=E.getTileBoundingVolume(qe,xe.wrap,b.elevation,e);if(!De){const pt=Re(o,Le,f);if(pt===0)continue;De=pt===2}const Oe=E.distanceToTile2d(y.x,y.y,qe,Le);let Ye=I;k&&(Ye=(e.calculateTileZoom||at)(b.zoom+c.ak(b.tileSize/e.tileSize),Oe,oe,ue,b.fov)),Ye=(e.roundZoom?Math.round:Math.floor)(Ye),Ye=Math.max(0,Ye);const vt=Math.min(Ye,j);if(xe.wrap=E.getWrap(T,qe,xe.wrap),xe.zoom>=vt){if(xe.zoom<O)continue;const pt=Z-xe.zoom,ot=Y[0]-.5-(Ee<<pt),Ot=Y[1]-.5-(ge<<pt),mn=e.reparseOverscaled?Math.max(xe.zoom,Ye):xe.zoom;me.push({tileID:new c.Z(xe.zoom===j?mn:xe.zoom,xe.wrap,xe.zoom,Ee,ge),distanceSq:c.al([Q[0]-.5-Ee,Q[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(ot*ot+Ot*Ot)})}else for(let pt=0;pt<4;pt++)ye.push({zoom:xe.zoom+1,x:(Ee<<1)+pt%2,y:(ge<<1)+(pt>>1),wrap:xe.wrap,fullyVisible:De})}return me.sort((xe,Ee)=>xe.distanceSq-Ee.distanceSq).map(xe=>xe.tileID)}const en=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class vn extends c.E{constructor(e,o,f){super(),this.id=e,this.dispatcher=f,this.on("data",y=>this._dataHandler(y)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,T,E,k)=>{const I=new(Ja(T.type))(y,T,E,k);if(I.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${I.id}`);return I})(e,o,f,this),this._tiles={},this._cache=new Ae(0,y=>this._unloadTile(y)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new K,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,o,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,o,f)}catch(y){e.state="errored",y.status!==404?this._source.fire(new c.k(y,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const f=this._tiles[o];f.upload(e),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Vt).map(e=>e.key)}getRenderableIds(e){const o=[];for(const f in this._tiles)this._isIdRenderable(f,e)&&o.push(this._tiles[f]);return e?o.sort((f,y)=>{const T=f.tileID,E=y.tileID,k=new c.P(T.canonical.x,T.canonical.y)._rotate(-this.transform.bearingInRadians),I=new c.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return T.overscaledZ-E.overscaledZ||I.y-k.y||I.x-k.x}).map(f=>f.tileID.key):o.map(f=>f.tileID).sort(Vt).map(f=>f.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)e?this._reloadTile(o,"expired"):this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(e,o){return c._(this,void 0,void 0,function*(){const f=this._tiles[e];f&&(f.state!=="loading"&&(f.state=o),yield this._loadTile(f,e,o))})}_tileLoaded(e,o,f){e.timeAdded=V.now(),f==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const o=this.getRenderableIds();for(let y=0;y<o.length;y++){const T=o[y];if(e.neighboringTiles&&e.neighboringTiles[T]){const E=this.getTileByID(T);f(e,E),f(E,e)}}function f(y,T){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let E=T.tileID.canonical.x-y.tileID.canonical.x;const k=T.tileID.canonical.y-y.tileID.canonical.y,I=Math.pow(2,y.tileID.canonical.z),O=T.tileID.key;E===0&&k===0||Math.abs(k)>1||(Math.abs(E)>1&&(Math.abs(E+I)===1?E+=I:Math.abs(E-I)===1&&(E-=I)),T.dem&&y.dem&&(y.dem.backfillBorder(T.dem,E,k),y.neighboringTiles&&y.neighboringTiles[O]&&(y.neighboringTiles[O].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,f,y){for(const T in this._tiles){let E=this._tiles[T];if(y[T]||!E.hasData()||E.tileID.overscaledZ<=o||E.tileID.overscaledZ>f)continue;let k=E.tileID;for(;E&&E.tileID.overscaledZ>o+1;){const O=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[O.key],E&&E.hasData()&&(k=O)}let I=k;for(;I.overscaledZ>o;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]||e[I.canonical.key]){y[k.key]=k;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const f=this._loadedParentTiles[e.key];return f&&f.tileID.overscaledZ>=o?f:null}for(let f=e.overscaledZ-1;f>=o;f--){const y=e.scaledTo(f),T=this._getLoadedTile(y);if(T)return T}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const o=Math.ceil(e.width/this._source.tileSize)+1,f=Math.ceil(e.height/this._source.tileSize)+1,y=Math.floor(o*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(T)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const f={};for(const y in this._tiles){const T=this._tiles[y];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+o),f[T.tileID.key]=T}this._tiles=f;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}_updateCoveredAndRetainedTiles(e,o,f,y,T,E){const k={},I={},O=Object.keys(e),j=V.now();for(const Z of O){const U=e[Z],Y=this._tiles[Z];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=j)continue;const Q=this.findLoadedParent(U,o),le=this.findLoadedSibling(U),oe=Q||le||null;oe&&(this._addTile(oe.tileID),k[oe.tileID.key]=oe.tileID),I[Z]=U}this._retainLoadedChildren(I,y,f,e);for(const Z in k)e[Z]||(this._coveredTiles[Z]=!0,e[Z]=k[Z]);if(E){const Z={},U={};for(const Y of T)this._tiles[Y.key].hasData()?Z[Y.key]=Y:U[Y.key]=Y;for(const Y in U){const Q=U[Y].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(Z[Q[0].key]=e[Q[0].key]=Q[0],Z[Q[1].key]=e[Q[1].key]=Q[1],Z[Q[2].key]=e[Q[2].key]=Q[2],Z[Q[3].key]=e[Q[3].key]=Q[3],delete U[Y])}for(const Y in U){const Q=U[Y],le=this.findLoadedParent(Q,this._source.minzoom),oe=this.findLoadedSibling(Q),ue=le||oe||null;if(ue){Z[ue.tileID.key]=e[ue.tileID.key]=ue.tileID;for(const he in Z)Z[he].isChildOf(ue.tileID)&&delete Z[he]}}for(const Y in this._tiles)Z[Y]||(this._coveredTiles[Y]=!0)}}update(e,o){if(!this._sourceLoaded||this._paused)return;let f;this.transform=e,this.terrain=o,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new c.Z(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(f=Pe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(j=>this._source.hasTile(j)))):f=[];const y=Lt(e,this._source),T=Math.max(y-vn.maxOverzooming,this._source.minzoom),E=Math.max(y+vn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const Z of f)if(Z.canonical.z>this._source.minzoom){const U=Z.scaledTo(Z.canonical.z-1);j[U.key]=U;const Y=Z.scaledTo(Math.max(this._source.minzoom,Math.min(Z.canonical.z,5)));j[Y.key]=Y}f=f.concat(Object.values(j))}const k=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(f,y);sn(this._source.type)&&this._updateCoveredAndRetainedTiles(I,T,E,y,f,o);for(const j in I)this._tiles[j].clearFadeHold();const O=c.am(this._tiles,I);for(const j of O){const Z=this._tiles[j];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,o){var f;const y={},T={},E=Math.max(o-vn.maxOverzooming,this._source.minzoom),k=Math.max(o+vn.maxUnderzooming,this._source.minzoom),I={};for(const O of e){const j=this._addTile(O);y[O.key]=O,j.hasData()||o<this._source.maxzoom&&(I[O.key]=O)}this._retainLoadedChildren(I,o,k,y);for(const O of e){let j=this._tiles[O.key];if(j.hasData())continue;if(o+1>this._source.maxzoom){const U=O.children(this._source.maxzoom)[0],Y=this.getTile(U);if(Y&&Y.hasData()){y[U.key]=U;continue}}else{const U=O.children(this._source.maxzoom);if(U.length===4&&y[U[0].key]&&y[U[1].key]&&y[U[2].key]&&y[U[3].key]||U.length===1&&y[U[0].key])continue}let Z=j.wasRequested();for(let U=O.overscaledZ-1;U>=E;--U){const Y=O.scaledTo(U);if(T[Y.key])break;if(T[Y.key]=!0,j=this.getTile(Y),!j&&Z&&(j=this._addTile(Y)),j){const Q=j.hasData();if((Q||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||Z)&&(y[Y.key]=Y),Z=j.wasRequested(),Q)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let f,y=this._tiles[e].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}o.push(y.key);const T=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(T),f)break;y=T}for(const T of o)this._loadedParentTiles[T]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const o=this._tiles[e].tileID,f=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=f}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const f=o;return o||(o=new Ur(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(o,e.key,o.state)),o.uses++,this._tiles[e.key]=o,f||this._source.fire(new c.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const f=o.getExpiryTimeout();f&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},f))}refreshTiles(e){for(const o in this._tiles)(this._isIdRenderable(o)||this._tiles[o].state=="errored")&&e.some(f=>f.equals(this._tiles[o].tileID.canonical))&&this._reloadTile(o,"expired")}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(e){const o=e.sourceDataType;e.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&o==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,o,f){const y=[],T=this.transform;if(!T)return y;const E=T.getCoveringTilesDetailsProvider().allowWorldCopies(),k=f?T.getCameraQueryGeometry(e):e,I=Y=>T.screenPointToMercatorCoordinate(Y,this.terrain),O=this.transformBbox(e,I,!E),j=this.transformBbox(k,I,!E),Z=this.getIds(),U=c.a2.fromPoints(j);for(let Y=0;Y<Z.length;Y++){const Q=this._tiles[Z[Y]];if(Q.holdingForFade())continue;const le=E?[Q.tileID]:[Q.tileID.unwrapTo(-1),Q.tileID.unwrapTo(0)],oe=Math.pow(2,T.zoom-Q.tileID.overscaledZ),ue=o*Q.queryPadding*c.$/Q.tileSize/oe;for(const he of le){const ye=U.map(me=>he.getTilePoint(new c.a1(me.x,me.y)));if(ye.expandBy(ue),ye.intersects(en)){const me=O.map(Ee=>he.getTilePoint(Ee)),xe=j.map(Ee=>he.getTilePoint(Ee));y.push({tile:Q,tileID:E?he:he.unwrapTo(0),queryGeometry:me,cameraQueryGeometry:xe,scale:oe})}}}return y}transformBbox(e,o,f){let y=e.map(o);if(f){const T=c.a2.fromPoints(e);T.shrinkBy(.001*Math.min(T.width(),T.height()));const E=T.map(o);c.a2.fromPoints(y).covers(E)||(y=y.map(k=>k.x>.5?new c.a1(k.x-1,k.y,k.z):k))}return y}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(o),o}hasTransition(){if(this._source.hasTransition())return!0;if(sn(this._source.type)){const e=V.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=e)return!0}return!1}setFeatureState(e,o,f){this._state.updateState(e=e||"_geojsonTileLayer",o,f)}removeFeatureState(e,o,f){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,f)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,f){const y=this._tiles[e];y&&y.setDependencies(o,f)}reloadTilesForDependencies(e,o){for(const f in this._tiles)this._tiles[f].hasDependency(e,o)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(e,o))}}function Vt(b,e){const o=Math.abs(2*b.wrap)-+(b.wrap<0),f=Math.abs(2*e.wrap)-+(e.wrap<0);return b.overscaledZ-e.overscaledZ||f-o||e.canonical.y-b.canonical.y||e.canonical.x-b.canonical.x}function sn(b){return b==="raster"||b==="image"||b==="video"}vn.maxOverzooming=10,vn.maxUnderzooming=3;class ni{constructor(e,o){this.reset(e,o)}reset(e,o){this.points=e||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ah(e,0,1);let o=1,f=this._distances[o];const y=e*this.paddedLength+this.padding;for(;f<y&&o<this._distances.length;)f=this._distances[++o];const T=o-1,E=this._distances[T],k=f-E,I=k>0?(y-E)/k:0;return this.points[T].mult(1-I).add(this.points[o].mult(I))}}function ar(b,e){let o=!0;return b==="always"||b!=="never"&&e!=="never"||(o=!1),o}class dr{constructor(e,o,f){const y=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(e/f),this.yCellCount=Math.ceil(o/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=o,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,o,f,y,T){this._forEachCell(o,f,y,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(T)}insertCircle(e,o,f,y){this._forEachCell(o-y,f-y,o+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(f),this.circles.push(y)}_insertBoxCell(e,o,f,y,T,E){this.boxCells[T].push(E)}_insertCircleCell(e,o,f,y,T,E){this.circleCells[T].push(E)}_query(e,o,f,y,T,E,k){if(f<0||e>this.width||y<0||o>this.height)return[];const I=[];if(e<=0&&o<=0&&this.width<=f&&this.height<=y){if(T)return[{key:null,x1:e,y1:o,x2:f,y2:y}];for(let O=0;O<this.boxKeys.length;O++)I.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const j=this.circles[3*O],Z=this.circles[3*O+1],U=this.circles[3*O+2];I.push({key:this.circleKeys[O],x1:j-U,y1:Z-U,x2:j+U,y2:Z+U})}}else this._forEachCell(e,o,f,y,this._queryCell,I,{hitTest:T,overlapMode:E,seenUids:{box:{},circle:{}}},k);return I}query(e,o,f,y){return this._query(e,o,f,y,!1,null)}hitTest(e,o,f,y,T,E){return this._query(e,o,f,y,!0,T,E).length>0}hitTestCircle(e,o,f,y,T){const E=e-f,k=e+f,I=o-f,O=o+f;if(k<0||E>this.width||O<0||I>this.height)return!1;const j=[];return this._forEachCell(E,I,k,O,this._queryCellCircle,j,{hitTest:!0,overlapMode:y,circle:{x:e,y:o,radius:f},seenUids:{box:{},circle:{}}},T),j.length>0}_queryCell(e,o,f,y,T,E,k,I){const{seenUids:O,hitTest:j,overlapMode:Z}=k,U=this.boxCells[T];if(U!==null){const Q=this.bboxes;for(const le of U)if(!O.box[le]){O.box[le]=!0;const oe=4*le,ue=this.boxKeys[le];if(e<=Q[oe+2]&&o<=Q[oe+3]&&f>=Q[oe+0]&&y>=Q[oe+1]&&(!I||I(ue))&&(!j||!ar(Z,ue.overlapMode))&&(E.push({key:ue,x1:Q[oe],y1:Q[oe+1],x2:Q[oe+2],y2:Q[oe+3]}),j))return!0}}const Y=this.circleCells[T];if(Y!==null){const Q=this.circles;for(const le of Y)if(!O.circle[le]){O.circle[le]=!0;const oe=3*le,ue=this.circleKeys[le];if(this._circleAndRectCollide(Q[oe],Q[oe+1],Q[oe+2],e,o,f,y)&&(!I||I(ue))&&(!j||!ar(Z,ue.overlapMode))){const he=Q[oe],ye=Q[oe+1],me=Q[oe+2];if(E.push({key:ue,x1:he-me,y1:ye-me,x2:he+me,y2:ye+me}),j)return!0}}}return!1}_queryCellCircle(e,o,f,y,T,E,k,I){const{circle:O,seenUids:j,overlapMode:Z}=k,U=this.boxCells[T];if(U!==null){const Q=this.bboxes;for(const le of U)if(!j.box[le]){j.box[le]=!0;const oe=4*le,ue=this.boxKeys[le];if(this._circleAndRectCollide(O.x,O.y,O.radius,Q[oe+0],Q[oe+1],Q[oe+2],Q[oe+3])&&(!I||I(ue))&&!ar(Z,ue.overlapMode))return E.push(!0),!0}}const Y=this.circleCells[T];if(Y!==null){const Q=this.circles;for(const le of Y)if(!j.circle[le]){j.circle[le]=!0;const oe=3*le,ue=this.circleKeys[le];if(this._circlesCollide(Q[oe],Q[oe+1],Q[oe+2],O.x,O.y,O.radius)&&(!I||I(ue))&&!ar(Z,ue.overlapMode))return E.push(!0),!0}}}_forEachCell(e,o,f,y,T,E,k,I){const O=this._convertToXCellCoord(e),j=this._convertToYCellCoord(o),Z=this._convertToXCellCoord(f),U=this._convertToYCellCoord(y);for(let Y=O;Y<=Z;Y++)for(let Q=j;Q<=U;Q++)if(T.call(this,e,o,f,y,this.xCellCount*Q+Y,E,k,I))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,o,f,y,T,E){const k=y-e,I=T-o,O=f+E;return O*O>k*k+I*I}_circleAndRectCollide(e,o,f,y,T,E,k){const I=(E-y)/2,O=Math.abs(e-(y+I));if(O>I+f)return!1;const j=(k-T)/2,Z=Math.abs(o-(T+j));if(Z>j+f)return!1;if(O<=I||Z<=j)return!0;const U=O-I,Y=Z-j;return U*U+Y*Y<=f*f}}function ai(b,e,o){const f=c.L();if(!b){const{vecSouth:Z,vecEast:U}=tn(e),Y=R();Y[0]=U[0],Y[1]=U[1],Y[2]=Z[0],Y[3]=Z[1],y=Y,(j=(E=(T=Y)[0])*(O=T[3])-(I=T[2])*(k=T[1]))&&(y[0]=O*(j=1/j),y[1]=-k*j,y[2]=-I*j,y[3]=E*j),f[0]=Y[0],f[1]=Y[1],f[4]=Y[2],f[5]=Y[3]}var y,T,E,k,I,O,j;return c.N(f,f,[1/o,1/o,1]),f}function Wt(b,e,o,f){if(b){const y=c.L();if(!e){const{vecSouth:T,vecEast:E}=tn(o);y[0]=E[0],y[1]=E[1],y[4]=T[0],y[5]=T[1]}return c.N(y,y,[f,f,1]),y}return o.pixelsToClipSpaceMatrix}function tn(b){const e=Math.cos(b.rollInRadians),o=Math.sin(b.rollInRadians),f=Math.cos(b.pitchInRadians),y=Math.cos(b.bearingInRadians),T=Math.sin(b.bearingInRadians),E=c.ar();E[0]=-y*f*o-T*e,E[1]=-T*f*o+y*e;const k=c.as(E);k<1e-9?c.at(E):c.au(E,E,1/k);const I=c.ar();I[0]=y*f*e-T*o,I[1]=T*f*e+y*o;const O=c.as(I);return O<1e-9?c.at(I):c.au(I,I,1/O),{vecEast:I,vecSouth:E}}function Ti(b,e,o,f){let y;f?(y=[b,e,f(b,e),1],c.aw(y,y,o)):(y=[b,e,0,1],Fl(y,y,o));const T=y[3];return{point:new c.P(y[0]/T,y[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function gt(b,e){return .5+b/e*.5}function Vr(b,e){return b.x>=-e[0]&&b.x<=e[0]&&b.y>=-e[1]&&b.y<=e[1]}function ji(b,e,o,f,y,T,E,k,I,O,j,Z,U){const Y=o?b.textSizeData:b.iconSizeData,Q=c.an(Y,e.transform.zoom),le=[256/e.width*2+1,256/e.height*2+1],oe=o?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;oe.clear();const ue=b.lineVertexArray,he=o?b.text.placedSymbolArray:b.icon.placedSymbolArray,ye=e.transform.width/e.transform.height;let me=!1;for(let xe=0;xe<he.length;xe++){const Ee=he.get(xe);if(Ee.hidden||Ee.writingMode===c.ao.vertical&&!me){ro(Ee.numGlyphs,oe);continue}me=!1;const ge=new c.P(Ee.anchorX,Ee.anchorY),De={getElevation:U,pitchedLabelPlaneMatrix:f,lineVertexArray:ue,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:ge,unwrappedTileID:I,width:O,height:j,translation:Z},qe=Si(Ee.anchorX,Ee.anchorY,De);if(!Vr(qe.point,le)){ro(Ee.numGlyphs,oe);continue}const Le=gt(e.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Oe=c.ap(Y,Q,Ee),Ye=T?Oe*e.transform.getPitchedTextCorrection(Ee.anchorX,Ee.anchorY,I)/Le:Oe*Le,vt=St({projectionContext:De,pitchedLabelPlaneMatrixInverse:y,symbol:Ee,fontSize:Ye,flip:!1,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:ye,rotateToLine:k});me=vt.useVertical,(vt.notEnoughRoom||me||vt.needsFlipping&&St({projectionContext:De,pitchedLabelPlaneMatrixInverse:y,symbol:Ee,fontSize:Ye,flip:!0,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:ye,rotateToLine:k}).notEnoughRoom)&&ro(Ee.numGlyphs,oe)}o?b.text.dynamicLayoutVertexBuffer.updateData(oe):b.icon.dynamicLayoutVertexBuffer.updateData(oe)}function Ro(b,e,o,f,y,T,E,k){const I=T.glyphStartIndex+T.numGlyphs,O=T.lineStartIndex,j=T.lineStartIndex+T.lineLength,Z=e.getoffsetX(T.glyphStartIndex),U=e.getoffsetX(I-1),Y=_a(b*Z,o,f,y,T.segment,O,j,k,E);if(!Y)return null;const Q=_a(b*U,o,f,y,T.segment,O,j,k,E);return Q?k.projectionCache.anyProjectionOccluded?null:{first:Y,last:Q}:null}function io(b,e,o,f){return b===c.ao.horizontal&&Math.abs(o.y-e.y)>Math.abs(o.x-e.x)*f?{useVertical:!0}:(b===c.ao.vertical?e.y<o.y:e.x>o.x)?{needsFlipping:!0}:null}function St(b){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:o,symbol:f,fontSize:y,flip:T,keepUpright:E,glyphOffsetArray:k,dynamicLayoutVertexArray:I,aspectRatio:O,rotateToLine:j}=b,Z=y/24,U=f.lineOffsetX*Z,Y=f.lineOffsetY*Z;let Q;if(f.numGlyphs>1){const le=f.glyphStartIndex+f.numGlyphs,oe=f.lineStartIndex,ue=f.lineStartIndex+f.lineLength,he=Ro(Z,k,U,Y,T,f,j,e);if(!he)return{notEnoughRoom:!0};const ye=es(he.first.point.x,he.first.point.y,e,o),me=es(he.last.point.x,he.last.point.y,e,o);if(E&&!T){const xe=io(f.writingMode,ye,me,O);if(xe)return xe}Q=[he.first];for(let xe=f.glyphStartIndex+1;xe<le-1;xe++){const Ee=_a(Z*k.getoffsetX(xe),U,Y,T,f.segment,oe,ue,e,j);if(!Ee)return{notEnoughRoom:!0};Q.push(Ee)}Q.push(he.last)}else{if(E&&!T){const oe=Xi(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ue=f.lineStartIndex+f.segment+1,he=new c.P(e.lineVertexArray.getx(ue),e.lineVertexArray.gety(ue)),ye=Xi(he.x,he.y,e),me=ye.signedDistanceFromCamera>0?ye.point:hn(e.tileAnchorPoint,he,oe,1,e),xe=es(oe.x,oe.y,e,o),Ee=es(me.x,me.y,e,o),ge=io(f.writingMode,xe,Ee,O);if(ge)return ge}const le=_a(Z*k.getoffsetX(f.glyphStartIndex),U,Y,T,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,e,j);if(!le||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[le]}for(const le of Q)c.av(I,le.point,le.angle);return{}}function hn(b,e,o,f,y){const T=b.add(b.sub(e)._unit()),E=Xi(T.x,T.y,y).point,k=o.sub(E);return o.add(k._mult(f/k.mag()))}function an(b,e,o){const f=e.projectionCache;if(f.projections[b])return f.projections[b];const y=new c.P(e.lineVertexArray.getx(b),e.lineVertexArray.gety(b)),T=Xi(y.x,y.y,e);if(T.signedDistanceFromCamera>0)return f.projections[b]=T.point,f.anyProjectionOccluded=f.anyProjectionOccluded||T.isOccluded,T.point;const E=b-o.direction;return hn(o.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(E),e.lineVertexArray.gety(E)),y,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,e)}function Xi(b,e,o){const f=b+o.translation[0],y=e+o.translation[1];let T;return o.pitchWithMap?(T=Ti(f,y,o.pitchedLabelPlaneMatrix,o.getElevation),T.isOccluded=!1):(T=o.transform.projectTileCoordinates(f,y,o.unwrappedTileID,o.getElevation),T.point.x=(.5*T.point.x+.5)*o.width,T.point.y=(.5*-T.point.y+.5)*o.height),T}function es(b,e,o,f){if(o.pitchWithMap){const y=[b,e,0,1];return c.aw(y,y,f),o.transform.projectTileCoordinates(y[0]/y[3],y[1]/y[3],o.unwrappedTileID,o.getElevation).point}return{x:b/o.width*2-1,y:1-e/o.height*2}}function Si(b,e,o){return o.transform.projectTileCoordinates(b,e,o.unwrappedTileID,o.getElevation)}function dn(b,e,o){return b._unit()._perp()._mult(e*o)}function Vu(b,e,o,f,y,T,E,k,I){if(k.projectionCache.offsets[b])return k.projectionCache.offsets[b];const O=o.add(e);if(b+I.direction<f||b+I.direction>=y)return k.projectionCache.offsets[b]=O,O;const j=an(b+I.direction,k,I),Z=dn(j.sub(o),E,I.direction),U=o.add(Z),Y=j.add(Z);return k.projectionCache.offsets[b]=c.ax(T,O,U,Y)||O,k.projectionCache.offsets[b]}function _a(b,e,o,f,y,T,E,k,I){const O=f?b-e:b+e;let j=O>0?1:-1,Z=0;f&&(j*=-1,Z=Math.PI),j<0&&(Z+=Math.PI);let U,Y=j>0?T+y:T+y+1;k.projectionCache.cachedAnchorPoint?U=k.projectionCache.cachedAnchorPoint:(U=Xi(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=U);let Q,le,oe=U,ue=U,he=0,ye=0;const me=Math.abs(O),xe=[];let Ee;for(;he+ye<=me;){if(Y+=j,Y<T||Y>=E)return null;he+=ye,ue=oe,le=Q;const qe={absOffsetX:me,direction:j,distanceFromAnchor:he,previousVertex:ue};if(oe=an(Y,k,qe),o===0)xe.push(ue),Ee=oe.sub(ue);else{let Le;const Oe=oe.sub(ue);Le=Oe.mag()===0?dn(an(Y+j,k,qe).sub(oe),o,j):dn(Oe,o,j),le||(le=ue.add(Le)),Q=Vu(Y,Le,oe,T,E,le,o,k,qe),xe.push(le),Ee=Q.sub(le)}ye=Ee.mag()}const ge=Ee._mult((me-he)/ye)._add(le||ue),De=Z+Math.atan2(oe.y-ue.y,oe.x-ue.x);return xe.push(ge),{point:ge,angle:I?De:0,path:xe}}const Io=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ro(b,e){for(let o=0;o<b;o++){const f=e.length;e.resize(f+4),e.float32.set(Io,3*f)}}function Fl(b,e,o){const f=e[0],y=e[1];return b[0]=o[0]*f+o[4]*y+o[12],b[1]=o[1]*f+o[5]*y+o[13],b[3]=o[3]*f+o[7]*y+o[15],b}const Bi=100;class cd{constructor(e,o=new dr(e.width+200,e.height+200,25),f=new dr(e.width+200,e.height+200,25)){this.transform=e,this.grid=o,this.ignoredGrid=f,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Bi,this.screenBottomBoundary=e.height+Bi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,o,f,y,T,E,k,I,O,j,Z,U){const Y=this.projectAndGetPerspectiveRatio(e.anchorPointX+I[0],e.anchorPointY+I[1],T,j,U),Q=f*Y.perspectiveRatio;let le;if(E||k)le=this._projectCollisionBox(e,Q,y,T,E,k,I,Y,j,Z,U);else{const Ee=Y.x+(Z?Z.x*Q:0),ge=Y.y+(Z?Z.y*Q:0);le={allPointsOccluded:!1,box:[Ee+e.x1*Q,ge+e.y1*Q,Ee+e.x2*Q,ge+e.y2*Q]}}const[oe,ue,he,ye]=le.box,me=E?le.allPointsOccluded:Y.isOccluded;let xe=me;return xe||(xe=Y.perspectiveRatio<this.perspectiveRatioCutoff),xe||(xe=!this.isInsideGrid(oe,ue,he,ye)),xe||o!=="always"&&this.grid.hitTest(oe,ue,he,ye,o,O)?{box:[oe,ue,he,ye],placeable:!1,offscreen:!1,occluded:me}:{box:[oe,ue,he,ye],placeable:!0,offscreen:this.isOffscreen(oe,ue,he,ye),occluded:me}}placeCollisionCircles(e,o,f,y,T,E,k,I,O,j,Z,U,Y,Q){const le=[],oe=new c.P(o.anchorX,o.anchorY),ue=this.getPerspectiveRatio(oe.x,oe.y,E,Q),he=(O?T*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,E)/ue:T*ue)/c.aB,ye={getElevation:Q,pitchedLabelPlaneMatrix:k,lineVertexArray:f,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:oe,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:Y},me=Ro(he,y,o.lineOffsetX*he,o.lineOffsetY*he,!1,o,!1,ye);let xe=!1,Ee=!1,ge=!0;if(me){const De=.5*Z*ue+U,qe=new c.P(-100,-100),Le=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Oe=new ni,Ye=me.first,vt=me.last;let pt=[];for(let mn=Ye.path.length-1;mn>=1;mn--)pt.push(Ye.path[mn]);for(let mn=1;mn<vt.path.length;mn++)pt.push(vt.path[mn]);const ot=2.5*De;if(O){const mn=this.projectPathToScreenSpace(pt,ye);pt=mn.some(Rn=>Rn.signedDistanceFromCamera<=0)?[]:mn.map(Rn=>Rn.point)}let Ot=[];if(pt.length>0){const mn=pt[0].clone(),Rn=pt[0].clone();for(let Mi=1;Mi<pt.length;Mi++)mn.x=Math.min(mn.x,pt[Mi].x),mn.y=Math.min(mn.y,pt[Mi].y),Rn.x=Math.max(Rn.x,pt[Mi].x),Rn.y=Math.max(Rn.y,pt[Mi].y);Ot=mn.x>=qe.x&&Rn.x<=Le.x&&mn.y>=qe.y&&Rn.y<=Le.y?[pt]:Rn.x<qe.x||mn.x>Le.x||Rn.y<qe.y||mn.y>Le.y?[]:c.ay([pt],qe.x,qe.y,Le.x,Le.y)}for(const mn of Ot){Oe.reset(mn,.25*De);let Rn=0;Rn=Oe.length<=.5*De?1:Math.ceil(Oe.paddedLength/ot)+1;for(let Mi=0;Mi<Rn;Mi++){const Fn=Mi/Math.max(Rn-1,1),_i=Oe.lerp(Fn),Ci=_i.x+Bi,oi=_i.y+Bi;le.push(Ci,oi,De,0);const on=Ci-De,cr=oi-De,$i=Ci+De,mr=oi+De;if(ge=ge&&this.isOffscreen(on,cr,$i,mr),Ee=Ee||this.isInsideGrid(on,cr,$i,mr),e!=="always"&&this.grid.hitTestCircle(Ci,oi,De,e,j)&&(xe=!0,!I))return{circles:[],offscreen:!1,collisionDetected:xe}}}}return{circles:!I&&xe||!Ee||ue<this.perspectiveRatioCutoff?[]:le,offscreen:ge,collisionDetected:xe}}projectPathToScreenSpace(e,o){const f=function(y,T){const E=c.L();return c.aq(E,T.pitchedLabelPlaneMatrix),y.map(k=>{const I=Ti(k.x,k.y,E,T.getElevation),O=T.transform.projectTileCoordinates(I.point.x,I.point.y,T.unwrappedTileID,T.getElevation);return O.point.x=(.5*O.point.x+.5)*T.width,O.point.y=(.5*-O.point.y+.5)*T.height,O})}(e,o);return function(y){let T=0,E=0,k=0,I=0;for(let O=0;O<y.length;O++)y[O].isOccluded?(k=O+1,I=0):(I++,I>E&&(E=I,T=k));return y.slice(T,T+E)}(f)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[],f=new c.a2;for(const Z of e){const U=new c.P(Z.x+Bi,Z.y+Bi);f.extend(U),o.push(U)}const{minX:y,minY:T,maxX:E,maxY:k}=f,I=this.grid.query(y,T,E,k).concat(this.ignoredGrid.query(y,T,E,k)),O={},j={};for(const Z of I){const U=Z.key;if(O[U.bucketInstanceId]===void 0&&(O[U.bucketInstanceId]={}),O[U.bucketInstanceId][U.featureIndex])continue;const Y=[new c.P(Z.x1,Z.y1),new c.P(Z.x2,Z.y1),new c.P(Z.x2,Z.y2),new c.P(Z.x1,Z.y2)];c.az(o,Y)&&(O[U.bucketInstanceId][U.featureIndex]=!0,j[U.bucketInstanceId]===void 0&&(j[U.bucketInstanceId]=[]),j[U.bucketInstanceId].push(U.featureIndex))}return j}insertCollisionBox(e,o,f,y,T,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:T,collisionGroupID:E,overlapMode:o},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,o,f,y,T,E){const k=f?this.ignoredGrid:this.grid,I={bucketInstanceId:y,featureIndex:T,collisionGroupID:E,overlapMode:o};for(let O=0;O<e.length;O+=4)k.insertCircle(I,e[O],e[O+1],e[O+2])}projectAndGetPerspectiveRatio(e,o,f,y,T){if(T){let E;y?(E=[e,o,y(e,o),1],c.aw(E,E,T)):(E=[e,o,0,1],Fl(E,E,T));const k=E[3];return{x:(E[0]/k+1)/2*this.transform.width+Bi,y:(-E[1]/k+1)/2*this.transform.height+Bi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}{const E=this.transform.projectTileCoordinates(e,o,f,y);return{x:(E.point.x+1)/2*this.transform.width+Bi,y:(1-E.point.y)/2*this.transform.height+Bi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(e,o,f,y){const T=this.transform.projectTileCoordinates(e,o,f,y);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(e,o,f,y){return f<Bi||e>=this.screenRightBoundary||y<Bi||o>this.screenBottomBoundary}isInsideGrid(e,o,f,y){return f>=0&&e<this.gridRightBoundary&&y>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const e=c.ag([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,o,f,y,T,E,k,I,O,j,Z){let U=1,Y=0,Q=0,le=1;const oe=e.anchorPointX+k[0],ue=e.anchorPointY+k[1];if(E&&!T){const pt=this.projectAndGetPerspectiveRatio(oe+1,ue,y,O,Z),ot=pt.x-I.x,Ot=Math.atan((pt.y-I.y)/ot)+(ot<0?Math.PI:0),mn=Math.sin(Ot),Rn=Math.cos(Ot);U=Rn,Y=mn,Q=-mn,le=Rn}else if(!E&&T){const pt=tn(this.transform);U=pt.vecEast[0],Y=pt.vecEast[1],Q=pt.vecSouth[0],le=pt.vecSouth[1]}let he=I.x,ye=I.y,me=o;T&&(he=oe,ye=ue,me=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),me*=this.transform.getPitchedTextCorrection(oe,ue,y),j||(me*=c.ah(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(he+=U*j.x*me+Q*j.y*me,ye+=Y*j.x*me+le*j.y*me);const xe=e.x1*me,Ee=e.x2*me,ge=(xe+Ee)/2,De=e.y1*me,qe=e.y2*me,Le=(De+qe)/2,Oe=[{offsetX:xe,offsetY:De},{offsetX:ge,offsetY:De},{offsetX:Ee,offsetY:De},{offsetX:Ee,offsetY:Le},{offsetX:Ee,offsetY:qe},{offsetX:ge,offsetY:qe},{offsetX:xe,offsetY:qe},{offsetX:xe,offsetY:Le}];let Ye=[];for(const{offsetX:pt,offsetY:ot}of Oe)Ye.push(new c.P(he+U*pt+Q*ot,ye+Y*pt+le*ot));let vt=!1;if(T){const pt=Ye.map(ot=>this.projectAndGetPerspectiveRatio(ot.x,ot.y,y,O,Z));vt=pt.some(ot=>!ot.isOccluded),Ye=pt.map(ot=>new c.P(ot.x,ot.y))}else vt=!0;return{box:c.aA(Ye),allPointsOccluded:!vt}}}class kr{constructor(e,o,f,y){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?o:-o))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class qn{constructor(e,o,f,y,T){this.text=new kr(e?e.text:null,o,f,T),this.icon=new kr(e?e.icon:null,o,y,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ao{constructor(e,o,f){this.text=e,this.icon=o,this.skipFade=f}}class Ul{constructor(e,o,f,y,T){this.bucketInstanceId=e,this.featureIndex=o,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=T}}class ud{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const o=++this.maxGroupID;this.collisionGroups[e]={ID:o,predicate:f=>f.collisionGroupID===o}}return this.collisionGroups[e]}}function Ra(b,e,o,f,y){const{horizontalAlign:T,verticalAlign:E}=c.aH(b);return new c.P(-(T-.5)*e+f[0]*y,-(E-.5)*o+f[1]*y)}class so{constructor(e,o,f,y,T){this.transform=e.clone(),this.terrain=o,this.collisionIndex=new cd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new ud(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const o=this.terrain;return o?(f,y)=>o.getElevation(e,f,y):null}getBucketParts(e,o,f,y){const T=f.getBucket(o),E=f.latestFeatureIndex;if(!T||!E||o.id!==T.layerIds[0])return;const k=f.collisionBoxArray,I=T.layers[0].layout,O=T.layers[0].paint,j=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),Z=f.tileSize/c.$,U=f.tileID.toUnwrapped(),Y=I.get("text-rotation-alignment")==="map",Q=c.aC(f,1,this.transform.zoom),le=c.aD(this.collisionIndex.transform,f,O.get("text-translate"),O.get("text-translate-anchor")),oe=c.aD(this.collisionIndex.transform,f,O.get("icon-translate"),O.get("icon-translate-anchor")),ue=ai(Y,this.transform,Q);this.retainedQueryData[T.bucketInstanceId]=new Ul(T.bucketInstanceId,E,T.sourceLayerIndex,T.index,f.tileID);const he={bucket:T,layout:I,translationText:le,translationIcon:oe,unwrappedTileID:U,pitchedLabelPlaneMatrix:ue,scale:j,textPixelRatio:Z,holdingForFade:f.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:c.an(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(y)for(const ye of T.sortKeyRanges){const{sortKey:me,symbolInstanceStart:xe,symbolInstanceEnd:Ee}=ye;e.push({sortKey:me,symbolInstanceStart:xe,symbolInstanceEnd:Ee,parameters:he})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:he})}attemptAnchorPlacement(e,o,f,y,T,E,k,I,O,j,Z,U,Y,Q,le,oe,ue,he,ye,me){const xe=c.aE[e.textAnchor],Ee=[e.textOffset0,e.textOffset1],ge=Ra(xe,f,y,Ee,T),De=this.collisionIndex.placeCollisionBox(o,U,I,O,j,k,E,oe,Z.predicate,ye,ge,me);if((!he||this.collisionIndex.placeCollisionBox(he,U,I,O,j,k,E,ue,Z.predicate,ye,ge,me).placeable)&&De.placeable){let qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Ee,width:f,height:y,anchor:xe,textBoxScale:T,prevAnchor:qe},this.markUsedJustification(Q,xe,Y,le),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,le,Y),this.placedOrientations[Y.crossTileID]=le),{shift:ge,placedGlyphBoxes:De}}}placeLayerBucketPart(e,o,f){const{bucket:y,layout:T,translationText:E,translationIcon:k,unwrappedTileID:I,pitchedLabelPlaneMatrix:O,textPixelRatio:j,holdingForFade:Z,collisionBoxArray:U,partiallyEvaluatedTextSize:Y,collisionGroup:Q}=e.parameters,le=T.get("text-optional"),oe=T.get("icon-optional"),ue=c.aF(T,"text-overlap","text-allow-overlap"),he=ue==="always",ye=c.aF(T,"icon-overlap","icon-allow-overlap"),me=ye==="always",xe=T.get("text-rotation-alignment")==="map",Ee=T.get("text-pitch-alignment")==="map",ge=T.get("icon-text-fit")!=="none",De=T.get("symbol-z-order")==="viewport-y",qe=he&&(me||!y.hasIconData()||oe),Le=me&&(he||!y.hasTextData()||le);!y.collisionArrays&&U&&y.deserializeCollisionBoxes(U);const Oe=this.retainedQueryData[y.bucketInstanceId].tileID,Ye=this._getTerrainElevationFunc(Oe),vt=this.transform.getFastPathSimpleProjectionMatrix(Oe),pt=(ot,Ot,mn)=>{var Rn,Mi;if(o[ot.crossTileID])return;if(Z)return void(this.placements[ot.crossTileID]=new ao(!1,!1,!1));let Fn=!1,_i=!1,Ci=!0,oi=null,on={box:null,placeable:!1,offscreen:null,occluded:!1},cr={placeable:!1},$i=null,mr=null,fa=null,Sl=0,ls=0,cs=0;Ot.textFeatureIndex?Sl=Ot.textFeatureIndex:ot.useRuntimeCollisionCircles&&(Sl=ot.featureIndex),Ot.verticalTextFeatureIndex&&(ls=Ot.verticalTextFeatureIndex);const Xo=Ot.textBox;if(Xo){const Qr=ui=>{let Ui=c.ao.horizontal;if(y.allowVerticalPlacement&&!ui&&this.prevPlacement){const Kr=this.prevPlacement.placedOrientations[ot.crossTileID];Kr&&(this.placedOrientations[ot.crossTileID]=Kr,Ui=Kr,this.markUsedOrientation(y,Ui,ot))}return Ui},Ps=(ui,Ui)=>{if(y.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&Ot.verticalTextBox){for(const Kr of y.writingModes)if(Kr===c.ao.vertical?(on=Ui(),cr=on):on=ui(),on&&on.placeable)break}else on=ui()},Ns=ot.textAnchorOffsetStartIndex,Ga=ot.textAnchorOffsetEndIndex;if(Ga===Ns){const ui=(Ui,Kr)=>{const Yi=this.collisionIndex.placeCollisionBox(Ui,ue,j,Oe,I,Ee,xe,E,Q.predicate,Ye,void 0,vt);return Yi&&Yi.placeable&&(this.markUsedOrientation(y,Kr,ot),this.placedOrientations[ot.crossTileID]=Kr),Yi};Ps(()=>ui(Xo,c.ao.horizontal),()=>{const Ui=Ot.verticalTextBox;return y.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&Ui?ui(Ui,c.ao.vertical):{box:null,offscreen:null}}),Qr(on&&on.placeable)}else{let ui=c.aE[(Mi=(Rn=this.prevPlacement)===null||Rn===void 0?void 0:Rn.variableOffsets[ot.crossTileID])===null||Mi===void 0?void 0:Mi.anchor];const Ui=(Yi,cu,uu)=>{const fc=Yi.x2-Yi.x1,xa=Yi.y2-Yi.y1,us=ot.textBoxScale,gr=ge&&ye==="never"?cu:null;let Or=null,pa=ue==="never"?1:2,Ff="never";ui&&pa++;for(let _o=0;_o<pa;_o++){for(let Za=Ns;Za<Ga;Za++){const Ki=y.textAnchorOffsets.get(Za);if(ui&&Ki.textAnchor!==ui)continue;const hs=this.attemptAnchorPlacement(Ki,Yi,fc,xa,us,xe,Ee,j,Oe,I,Q,Ff,ot,y,uu,E,k,gr,Ye);if(hs&&(Or=hs.placedGlyphBoxes,Or&&Or.placeable))return Fn=!0,oi=hs.shift,Or}ui?ui=null:Ff=ue}return f&&!Or&&(Or={box:this.collisionIndex.placeCollisionBox(Xo,"always",j,Oe,I,Ee,xe,E,Q.predicate,Ye,void 0,vt).box,offscreen:!1,placeable:!1,occluded:!1}),Or};Ps(()=>Ui(Xo,Ot.iconBox,c.ao.horizontal),()=>{const Yi=Ot.verticalTextBox;return y.allowVerticalPlacement&&(!on||!on.placeable)&&ot.numVerticalGlyphVertices>0&&Yi?Ui(Yi,Ot.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}}),on&&(Fn=on.placeable,Ci=on.offscreen);const Kr=Qr(on&&on.placeable);if(!Fn&&this.prevPlacement){const Yi=this.prevPlacement.variableOffsets[ot.crossTileID];Yi&&(this.variableOffsets[ot.crossTileID]=Yi,this.markUsedJustification(y,Yi.anchor,ot,Kr))}}}if($i=on,Fn=$i&&$i.placeable,Ci=$i&&$i.offscreen,ot.useRuntimeCollisionCircles){const Qr=y.text.placedSymbolArray.get(ot.centerJustifiedTextSymbolIndex),Ps=c.ap(y.textSizeData,Y,Qr),Ns=T.get("text-padding");mr=this.collisionIndex.placeCollisionCircles(ue,Qr,y.lineVertexArray,y.glyphOffsetArray,Ps,I,O,f,Ee,Q.predicate,ot.collisionCircleDiameter,Ns,E,Ye),mr.circles.length&&mr.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),Fn=he||mr.circles.length>0&&!mr.collisionDetected,Ci=Ci&&mr.offscreen}if(Ot.iconFeatureIndex&&(cs=Ot.iconFeatureIndex),Ot.iconBox){const Qr=Ps=>this.collisionIndex.placeCollisionBox(Ps,ye,j,Oe,I,Ee,xe,k,Q.predicate,Ye,ge&&oi?oi:void 0,vt);cr&&cr.placeable&&Ot.verticalIconBox?(fa=Qr(Ot.verticalIconBox),_i=fa.placeable):(fa=Qr(Ot.iconBox),_i=fa.placeable),Ci=Ci&&fa.offscreen}const hc=le||ot.numHorizontalGlyphVertices===0&&ot.numVerticalGlyphVertices===0,dc=oe||ot.numIconVertices===0;hc||dc?dc?hc||(_i=_i&&Fn):Fn=_i&&Fn:_i=Fn=_i&&Fn;const yo=_i&&fa.placeable;if(Fn&&$i.placeable&&this.collisionIndex.insertCollisionBox($i.box,ue,T.get("text-ignore-placement"),y.bucketInstanceId,cr&&cr.placeable&&ls?ls:Sl,Q.ID),yo&&this.collisionIndex.insertCollisionBox(fa.box,ye,T.get("icon-ignore-placement"),y.bucketInstanceId,cs,Q.ID),mr&&Fn&&this.collisionIndex.insertCollisionCircles(mr.circles,ue,T.get("text-ignore-placement"),y.bucketInstanceId,Sl,Q.ID),f&&this.storeCollisionData(y.bucketInstanceId,mn,Ot,$i,fa,mr),ot.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ot.crossTileID]=new ao((Fn||qe)&&!$i?.occluded,(_i||Le)&&!fa?.occluded,Ci||y.justReloaded),o[ot.crossTileID]=!0};if(De){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ot=y.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ot=ot.length-1;Ot>=0;--Ot){const mn=ot[Ot];pt(y.symbolInstances.get(mn),y.collisionArrays[mn],mn)}}else for(let ot=e.symbolInstanceStart;ot<e.symbolInstanceEnd;ot++)pt(y.symbolInstances.get(ot),y.collisionArrays[ot],ot);y.justReloaded=!1}storeCollisionData(e,o,f,y,T,E){if(f.textBox||f.iconBox){let k,I;this.collisionBoxArrays.has(e)?k=this.collisionBoxArrays.get(e):(k=new Map,this.collisionBoxArrays.set(e,k)),k.has(o)?I=k.get(o):(I={text:null,icon:null},k.set(o,I)),f.textBox&&(I.text=y.box),f.iconBox&&(I.icon=T.box)}if(E){let k=this.collisionCircleArrays[e];k===void 0&&(k=this.collisionCircleArrays[e]=[]);for(let I=0;I<E.circles.length;I+=4)k.push(E.circles[I+0]-Bi),k.push(E.circles[I+1]-Bi),k.push(E.circles[I+2]),k.push(E.collisionDetected?1:0)}}markUsedJustification(e,o,f,y){let T;T=y===c.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.aG(o)];const E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const k of E)k>=0&&(e.text.placedSymbolArray.get(k).crossTileID=T>=0&&k!==T?0:f.crossTileID)}markUsedOrientation(e,o,f){const y=o===c.ao.horizontal||o===c.ao.horizontalOnly?o:0,T=o===c.ao.vertical?o:0,E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const k of E)e.text.placedSymbolArray.get(k).placedOrientation=y;f.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let f=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const y=o?o.symbolFadeChange(e):1,T=o?o.opacities:{},E=o?o.variableOffsets:{},k=o?o.placedOrientations:{};for(const I in this.placements){const O=this.placements[I],j=T[I];j?(this.opacities[I]=new qn(j,y,O.text,O.icon),f=f||O.text!==j.text.placed||O.icon!==j.icon.placed):(this.opacities[I]=new qn(null,y,O.text,O.icon,O.skipFade),f=f||O.text||O.icon)}for(const I in T){const O=T[I];if(!this.opacities[I]){const j=new qn(O,y,!1,!1);j.isHidden()||(this.opacities[I]=j,f=f||O.text.placed||O.icon.placed)}}for(const I in E)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=E[I]);for(const I in k)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=k[I]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:e)}updateLayerOpacities(e,o){const f={};for(const y of o){const T=y.getBucket(e);T&&y.latestFeatureIndex&&e.id===T.layerIds[0]&&this.updateBucketOpacities(T,y.tileID,f,y.collisionBoxArray)}}updateBucketOpacities(e,o,f,y){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const T=e.layers[0],E=T.layout,k=new qn(null,0,!1,!1,!0),I=E.get("text-allow-overlap"),O=E.get("icon-allow-overlap"),j=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Z=E.get("text-rotation-alignment")==="map",U=E.get("text-pitch-alignment")==="map",Y=E.get("icon-text-fit")!=="none",Q=new qn(null,0,I&&(O||!e.hasIconData()||E.get("icon-optional")),O&&(I||!e.hasTextData()||E.get("text-optional")),!0);!e.collisionArrays&&y&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(y);const le=(ue,he,ye)=>{for(let me=0;me<he/4;me++)ue.opacityVertexArray.emplaceBack(ye);ue.hasVisibleVertices=ue.hasVisibleVertices||ye!==Lc},oe=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ue=0;ue<e.symbolInstances.length;ue++){const he=e.symbolInstances.get(ue),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:me,crossTileID:xe}=he;let Ee=this.opacities[xe];f[xe]?Ee=k:Ee||(Ee=Q,this.opacities[xe]=Ee),f[xe]=!0;const ge=he.numIconVertices>0,De=this.placedOrientations[he.crossTileID],qe=De===c.ao.vertical,Le=De===c.ao.horizontal||De===c.ao.horizontalOnly;if(ye>0||me>0){const Ye=zc(Ee.text);le(e.text,ye,qe?Lc:Ye),le(e.text,me,Le?Lc:Ye);const vt=Ee.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(Ot=>{Ot>=0&&(e.text.placedSymbolArray.get(Ot).hidden=vt||qe?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=vt||Le?1:0);const pt=this.variableOffsets[he.crossTileID];pt&&this.markUsedJustification(e,pt.anchor,he,De);const ot=this.placedOrientations[he.crossTileID];ot&&(this.markUsedJustification(e,"left",he,ot),this.markUsedOrientation(e,ot,he))}if(ge){const Ye=zc(Ee.icon),vt=!(Y&&he.verticalPlacedIconSymbolIndex&&qe);he.placedIconSymbolIndex>=0&&(le(e.icon,he.numIconVertices,vt?Ye:Lc),e.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=Ee.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(le(e.icon,he.numVerticalIconVertices,vt?Lc:Ye),e.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=Ee.icon.isHidden())}const Oe=oe&&oe.has(ue)?oe.get(ue):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ye=e.collisionArrays[ue];if(Ye){let vt=new c.P(0,0);if(Ye.textBox||Ye.verticalTextBox){let pt=!0;if(j){const ot=this.variableOffsets[xe];ot?(vt=Ra(ot.anchor,ot.width,ot.height,ot.textOffset,ot.textBoxScale),Z&&vt._rotate(U?-this.transform.bearingInRadians:this.transform.bearingInRadians)):pt=!1}if(Ye.textBox||Ye.verticalTextBox){let ot;Ye.textBox&&(ot=qe),Ye.verticalTextBox&&(ot=Le),Gu(e.textCollisionBox.collisionVertexArray,Ee.text.placed,!pt||ot,Oe.text,vt.x,vt.y)}}if(Ye.iconBox||Ye.verticalIconBox){const pt=!!(!Le&&Ye.verticalIconBox);let ot;Ye.iconBox&&(ot=pt),Ye.verticalIconBox&&(ot=!pt),Gu(e.iconCollisionBox.collisionVertexArray,Ee.icon.placed,ot,Oe.icon,Y?vt.x:0,Y?vt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,o){const f=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*f>e}setStale(){this.stale=!0}}function Gu(b,e,o,f,y,T){f&&f.length!==0||(f=[0,0,0,0]);const E=f[0]-Bi,k=f[1]-Bi,I=f[2]-Bi,O=f[3]-Bi;b.emplaceBack(e?1:0,o?1:0,y||0,T||0,E,k),b.emplaceBack(e?1:0,o?1:0,y||0,T||0,I,k),b.emplaceBack(e?1:0,o?1:0,y||0,T||0,I,O),b.emplaceBack(e?1:0,o?1:0,y||0,T||0,E,O)}const Rp=Math.pow(2,25),_f=Math.pow(2,24),Rr=Math.pow(2,17),vf=Math.pow(2,16),Ag=Math.pow(2,9),hd=Math.pow(2,8),Ip=Math.pow(2,1);function zc(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const e=b.placed?1:0,o=Math.floor(127*b.opacity);return o*Rp+e*_f+o*Rr+e*vf+o*Ag+e*hd+o*Ip+e}const Lc=0;class va{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,o,f,y,T){const E=this._bucketParts;for(;this._currentTileIndex<e.length;)if(o.getBucketParts(E,y,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((k,I)=>k.sortKey-I.sortKey));this._currentPartIndex<E.length;)if(o.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,T())return!0;return!1}}class Zu{constructor(e,o,f,y,T,E,k,I){this.placement=new so(e,o,E,k,I),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(e,o,f){const y=V.now(),T=()=>!this._forceFullPlacement&&V.now()-y>2;for(;this._currentPlacementIndex>=0;){const E=o[e[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=k)&&(!E.maxzoom||E.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new va(E)),this._inProgressLayer.continuePlacement(f[E.source],this.placement,this._showCollisionBoxes,E,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Vl=512/c.$/2;class $u{constructor(e,o,f){this.tileID=e,this.bucketInstanceId=f,this._symbolsByKey={};const y=new Map;for(let T=0;T<o.length;T++){const E=o.get(T),k=E.key,I=y.get(k);I?I.push(E):y.set(k,[E])}for(const[T,E]of y){const k={positions:E.map(I=>({x:Math.floor(I.anchorX*Vl),y:Math.floor(I.anchorY*Vl)})),crossTileIDs:E.map(I=>I.crossTileID)};if(k.positions.length>128){const I=new c.aI(k.positions.length,16,Uint16Array);for(const{x:O,y:j}of k.positions)I.add(O,j);I.finish(),delete k.positions,k.index=I}this._symbolsByKey[T]=k}}getScaledCoordinates(e,o){const{x:f,y,z:T}=this.tileID.canonical,{x:E,y:k,z:I}=o.canonical,O=Vl/Math.pow(2,I-T),j=(k*c.$+e.anchorY)*O,Z=y*c.$*Vl;return{x:Math.floor((E*c.$+e.anchorX)*O-f*c.$*Vl),y:Math.floor(j-Z)}}findMatches(e,o,f){const y=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let T=0;T<e.length;T++){const E=e.get(T);if(E.crossTileID)continue;const k=this._symbolsByKey[E.key];if(!k)continue;const I=this.getScaledCoordinates(E,o);if(k.index){const O=k.index.range(I.x-y,I.y-y,I.x+y,I.y+y).sort();for(const j of O){const Z=k.crossTileIDs[j];if(!f[Z]){f[Z]=!0,E.crossTileID=Z;break}}}else if(k.positions)for(let O=0;O<k.positions.length;O++){const j=k.positions[O],Z=k.crossTileIDs[O];if(Math.abs(j.x-I.x)<=y&&Math.abs(j.y-I.y)<=y&&!f[Z]){f[Z]=!0,E.crossTileID=Z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class ol{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Pp{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const o=Math.round((e-this.lng)/360);if(o!==0)for(const f in this.indexes){const y=this.indexes[f],T={};for(const E in y){const k=y[E];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+o),T[k.tileID.key]=k}this.indexes[f]=T}this.lng=e}addBucket(e,o,f){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let T=0;T<o.symbolInstances.length;T++)o.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const y=this.usedCrossTileIDs[e.overscaledZ];for(const T in this.indexes){const E=this.indexes[T];if(Number(T)>e.overscaledZ)for(const k in E){const I=E[k];I.tileID.isChildOf(e)&&I.findMatches(o.symbolInstances,e,y)}else{const k=E[e.scaledTo(Number(T)).key];k&&k.findMatches(o.symbolInstances,e,y)}}for(let T=0;T<o.symbolInstances.length;T++){const E=o.symbolInstances.get(T);E.crossTileID||(E.crossTileID=f.generate(),y[E.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new $u(e,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(e,o){for(const f of o.getCrossTileIDsLists())for(const y of f)delete this.usedCrossTileIDs[e][y]}removeStaleBuckets(e){let o=!1;for(const f in this.indexes){const y=this.indexes[f];for(const T in y)e[y[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[T]),delete y[T],o=!0)}return o}}class Gl{constructor(){this.layerIndexes={},this.crossTileIDs=new ol,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,o,f){let y=this.layerIndexes[e.id];y===void 0&&(y=this.layerIndexes[e.id]=new Pp);let T=!1;const E={};y.handleWrapJump(f);for(const k of o){const I=k.getBucket(e);I&&e.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(k.tileID,I,this.crossTileIDs)&&(T=!0),E[I.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(T=!0),T}pruneUnusedLayers(e){const o={};e.forEach(f=>{o[f]=!0});for(const f in this.layerIndexes)o[f]||delete this.layerIndexes[f]}}var oo="void main() {fragColor=vec4(1.0);}";const Es={prelude:bn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:bn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:bn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:bn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:bn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:bn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:bn(oo,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:bn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:bn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:bn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:bn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:bn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:bn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:bn(oo,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:bn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:bn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:bn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:bn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:bn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:bn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:bn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:bn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:bn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:bn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:bn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:bn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:bn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:bn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:bn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:bn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:bn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:bn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:bn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:bn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:bn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:bn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function bn(b,e){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=e.match(/in ([\w]+) ([\w]+)/g),y=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=T?T.concat(y):y,k={};return{fragmentSource:b=b.replace(o,(I,O,j,Z,U)=>(k[U]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${j} ${Z} ${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = u_${U};
#endif
`)),vertexSource:e=e.replace(o,(I,O,j,Z,U)=>{const Y=Z==="float"?"vec2":"vec4",Q=U.match(/color/)?"color":Y;return k[U]?O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${j} ${Y} a_${U};
out ${j} ${Z} ${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${Q}(a_${U}, u_${U}_t);
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${j} ${Y} a_${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = a_${U};
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = unpack_mix_${Q}(a_${U}, u_${U}_t);
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`}),staticAttributes:f,staticUniforms:E}}class ll{constructor(e,o,f){this.vertexBuffer=e,this.indexBuffer=o,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var lo=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const Po="#define PROJECTION_MERCATOR",Zl="mercator";class gn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Zl}get shaderDefine(){return Po}get shaderPreludeCode(){return Es.projectionMercator}get vertexShaderPreludeCode(){return Es.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,o,f,y,T){if(this._cachedMesh)return this._cachedMesh;const E=new c.aL;E.emplaceBack(0,0),E.emplaceBack(c.$,0),E.emplaceBack(0,c.$),E.emplaceBack(c.$,c.$);const k=e.createVertexBuffer(E,lo.members),I=c.aM.simpleSegment(0,0,4,2),O=new c.aN;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3);const j=e.createIndexBuffer(O);return this._cachedMesh=new ll(k,j,I),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class No{constructor(e=0,o=0,f=0,y=0){if(isNaN(e)||e<0||isNaN(o)||o<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=o,this.left=f,this.right=y}interpolate(e,o,f){return o.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,o.top,f)),o.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,o.bottom,f)),o.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,o.left,f)),o.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,o.right,f)),this}getCenter(e,o){const f=c.ah((this.left+e-this.right)/2,0,e),y=c.ah((this.top+o-this.bottom)/2,0,o);return new c.P(f,y)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new No(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Oc(b,e){if(!b.renderWorldCopies||b.lngRange)return;const o=e.lng-b.center.lng;e.lng+=o>180?-360:o<-180?360:0}function zo(b){return Math.max(0,Math.floor(b))}class sr{constructor(e,o,f,y,T,E){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=o||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=T??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=zo(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new No,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,o,f){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=zo(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new No(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!f&&e.autoCalculateNearFarZ,o&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const o=c.aO(e,-180,180)*Math.PI/180;var f,y,T,E,k,I,O,j,Z;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=R(),f=this._rotationMatrix,T=-this._bearingInRadians,E=(y=this._rotationMatrix)[0],k=y[1],I=y[2],O=y[3],j=Math.sin(T),Z=Math.cos(T),f[0]=E*Z+I*j,f[1]=k*Z+O*j,f[2]=E*-j+I*Z,f[3]=k*-j+O*Z)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const o=c.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const o=e/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(e){e=c.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const o=this.getConstrained(this._center,e).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=c.af(o),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,o){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,o,f){this._unmodified=!1,this._edgeInsets.interpolate(e,o,f),this._constrain(),this._calcMatrices()}resize(e,o,f=!0){this._width=e,this._height=o,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Yn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(e,o){return this._callbacks.getConstrained(e,o)}getCameraQueryGeometry(e,o){if(o.length===1)return[o[0],e];{const{minX:f,minY:y,maxX:T,maxY:E}=c.a2.fromPoints(o).extend(e);return[new c.P(f,y),new c.P(T,y),new c.P(T,E),new c.P(f,E),new c.P(f,y)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:o,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(o),this.setZoom(f),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.ag(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.ag(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,o,f,y){const T=f!==void 0?f:this.bearing,E=y=y!==void 0?y:this.pitch,k=c.a1.fromLngLat(e,o),I=-Math.cos(c.ae(E)),O=Math.sin(c.ae(E)),j=O*Math.sin(c.ae(T)),Z=-O*Math.cos(c.ae(T));let U=this.elevation;const Y=o-U;let Q;I*Y>=0||Math.abs(I)<.1?(Q=1e4,U=o+Q*I):Q=-Y/I;let le,oe,ue=c.aQ(1,k.y),he=0;do{if(he+=1,he>10)break;oe=Q/ue,le=new c.a1(k.x+j*oe,k.y+Z*oe),ue=1/le.meterInMercatorCoordinateUnits()}while(Math.abs(Q-oe*ue)>1e-12);return{center:le.toLngLat(),elevation:U,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/oe/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const o=c.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/o,y=c.a1.fromLngLat(this.center,this.elevation),T=Fe(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=e;const E=this.calculateCenterFromCameraLngLatAlt(T.toLngLat(),c.aQ(T.z,y.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Fe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const o=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/o,e.canonical.y/o,1/o/c.$,1/o/c.$]}}class fr{constructor(e,o){this.min=e,this.max=o,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],f=c.aT(this.min),y=c.aT(this.max);for(let T=0;T<o.length;T++)f[T]=o[T]?this.min[T]:this.center[T],y[T]=o[T]?this.center[T]:this.max[T];return y[2]=this.max[2],new fr(f,y)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let o=!0;for(let f=0;f<e.planes.length;f++){const y=this.intersectsPlane(e.planes[f]);if(y===0)return 0;y===1&&(o=!1)}return o?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let o=e[3],f=e[3];for(let y=0;y<3;y++)e[y]>0?(o+=e[y]*this.min[y],f+=e[y]*this.max[y]):(f+=e[y]*this.min[y],o+=e[y]*this.max[y]);return o>=0?2:f<0?0:1}}class Ir{distanceToTile2d(e,o,f,y){const T=y.distanceX([e,o]),E=y.distanceY([e,o]);return Math.hypot(T,E)}getWrap(e,o,f){return f}getTileBoundingVolume(e,o,f,y){var T,E;let k=0,I=0;if(y?.terrain){const j=new c.Z(e.z,o,e.z,e.x,e.y),Z=y.terrain.getMinMaxElevation(j);k=(T=Z.minElevation)!==null&&T!==void 0?T:Math.min(0,f),I=(E=Z.maxElevation)!==null&&E!==void 0?E:Math.max(0,f)}const O=1<<e.z;return new fr([o+e.x/O,e.y/O,k],[o+(e.x+1)/O,(e.y+1)/O,I])}allowVariableZoom(e,o){const f=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,y=c.ah(78.5-f/2,0,60);return!!o.terrain||e.pitch>y}allowWorldCopies(){return!0}prepareNextFrame(){}}class Wi{constructor(e,o,f){this.points=e,this.planes=o,this.aabb=f}static fromInvProjectionMatrix(e,o=1,f=0,y,T){const E=T?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],k=Math.pow(2,f),I=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>function(Y,Q,le,oe){const ue=c.aw([],Y,Q),he=1/ue[3]/le*oe;return c.aY(ue,ue,[he,he,1/ue[3],he])}(U,e,o,k));y&&function(U,Y,Q,le){const oe=le?4:0,ue=le?0:4;let he=0;const ye=[],me=[];for(let ge=0;ge<4;ge++){const De=c.aU([],U[ge+ue],U[ge+oe]),qe=c.aZ(De);c.aR(De,De,1/qe),ye.push(qe),me.push(De)}for(let ge=0;ge<4;ge++){const De=c.a_(U[ge+oe],me[ge],Q);he=De!==null&&De>=0?Math.max(he,De):Math.max(he,ye[ge])}const xe=function(ge,De){const qe=c.aU([],ge[De[0]],ge[De[1]]),Le=c.aU([],ge[De[2]],ge[De[1]]),Oe=[0,0,0,0];return c.aV(Oe,c.aW([],qe,Le)),Oe[3]=-c.aX(Oe,ge[De[0]]),Oe}(U,Y),Ee=function(ge,De){const qe=c.a$(ge),Le=c.b0([],ge,1/qe),Oe=c.aU([],De,c.aR([],Le,c.aX(De,Le))),Ye=c.a$(Oe);if(Ye>0){const vt=Math.sqrt(1-Le[3]*Le[3]),pt=c.aR([],Le,-Le[3]),ot=c.aS([],pt,c.aR([],Oe,vt/Ye));return c.b1(De,ot)}return null}(Q,xe);if(Ee!==null){const ge=Ee/c.aX(me[0],xe);he=Math.min(he,ge)}for(let ge=0;ge<4;ge++){const De=Math.min(he,ye[ge]);U[ge+ue]=[U[ge+oe][0]+me[ge][0]*De,U[ge+oe][1]+me[ge][1]*De,U[ge+oe][2]+me[ge][2]*De,1]}}(I,E[0],y,T);const O=E.map(U=>{const Y=c.aU([],I[U[0]],I[U[1]]),Q=c.aU([],I[U[2]],I[U[1]]),le=c.aV([],c.aW([],Y,Q)),oe=-c.aX(le,I[U[1]]);return le.concat(oe)}),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Z=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const U of I)for(let Y=0;Y<3;Y++)j[Y]=Math.min(j[Y],U[Y]),Z[Y]=Math.max(Z[Y],U[Y]);return new Wi(I,O,new fr(j,Z))}}class Vn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,f=!0){this._helper.resize(e,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,o){}constructor(e,o,f,y,T){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new sr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,k)=>this.getConstrained(E,k)},e,o,f,y,T),this._coveringTilesDetailsProvider=new Ir}clone(){const e=new Vn;return e.apply(this),e}apply(e,o,f){this._helper.apply(e,o,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const o=[new c.b2(0,e)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new c.P(0,0)),y=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),T=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),k=Math.floor(Math.min(f.x,y.x,T.x,E.x)),I=Math.floor(Math.max(f.x,y.x,T.x,E.x)),O=1;for(let j=k-O;j<=I+O;j++)j!==0&&o.push(new c.b2(j,e))}return o}getCameraFrustum(){return Wi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const o=this.screenPointToLocation(this.centerPoint,e),f=e?e.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(e,o){const f=c.aj(this.elevation,this.center.lat),y=this.screenPointToMercatorCoordinateAtZ(o,f),T=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),E=c.a1.fromLngLat(e),k=new c.a1(E.x-(y.x-T.x),E.y-(y.y-T.y));this.setCenter(k?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,o){return o?this.coordinatePoint(c.a1.fromLngLat(e),o.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(e))}screenPointToLocation(e,o){var f;return(f=this.screenPointToMercatorCoordinate(e,o))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(e,o){if(o){const f=o.pointCoordinate(e);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,o){const f=o||0,y=[e.x,e.y,0,1],T=[e.x,e.y,1,1];c.aw(y,y,this._pixelMatrixInverse),c.aw(T,T,this._pixelMatrixInverse);const E=y[3],k=T[3],I=y[1]/E,O=T[1]/k,j=y[2]/E,Z=T[2]/k,U=j===Z?0:(f-j)/(Z-j);return new c.a1(c.C.number(y[0]/E,T[0]/k,U)/this.worldSize,c.C.number(I,O,U)/this.worldSize,f)}coordinatePoint(e,o=0,f=this._pixelMatrix){const y=[e.x*this.worldSize,e.y*this.worldSize,o,1];return c.aw(y,y,f),new c.P(y[0]/y[3],y[1]/y[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Te(this));return new Yn().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,o){return o?o.pointCoordinate(e)!=null:e.y>this.height/2-Te(this)}calculatePosMatrix(e,o=!1,f){var y;const T=(y=e.key)!==null&&y!==void 0?y:c.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),E=o?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(T)){const O=E.get(T);return f?O.f32:O.f64}const k=Me(e,this.worldSize);c.O(k,o?this._alignedProjMatrix:this._viewProjMatrix,k);const I={f64:k,f32:new Float32Array(k)};return E.set(T,I),f?I.f32:I.f64}calculateFogMatrix(e){const o=e.key,f=this._fogMatrixCacheF32;if(f.has(o))return f.get(o);const y=Me(e,this.worldSize);return c.O(y,this._fogMatrix,y),f.set(o,new Float32Array(y)),f.get(o)}getConstrained(e,o){o=c.ah(+o,this.minZoom,this.maxZoom);const f={center:new c.S(e.lng,e.lat),zoom:o};let y=this._helper._lngRange;if(!this._helper._renderWorldCopies&&y===null){const ye=179.9999999999;y=[-ye,ye]}const T=this.tileSize*c.af(f.zoom);let E=0,k=T,I=0,O=T,j=0,Z=0;const{x:U,y:Y}=this.size;if(this._helper._latRange){const ye=this._helper._latRange;E=c.U(ye[1])*T,k=c.U(ye[0])*T,k-E<Y&&(j=Y/(k-E))}y&&(I=c.aO(c.V(y[0])*T,0,T),O=c.aO(c.V(y[1])*T,0,T),O<I&&(O+=T),O-I<U&&(Z=U/(O-I)));const{x:Q,y:le}=ae(T,e);let oe,ue;const he=Math.max(Z||0,j||0);if(he){const ye=new c.P(Z?(O+I)/2:Q,j?(k+E)/2:le);return f.center=_e(T,ye).wrap(),f.zoom+=c.ak(he),f}if(this._helper._latRange){const ye=Y/2;le-ye<E&&(ue=E+ye),le+ye>k&&(ue=k-ye)}if(y){const ye=(I+O)/2;let me=Q;this._helper._renderWorldCopies&&(me=c.aO(Q,ye-T/2,ye+T/2));const xe=U/2;me-xe<I&&(oe=I+xe),me+xe>O&&(oe=O-xe)}if(oe!==void 0||ue!==void 0){const ye=new c.P(oe??Q,ue??le);f.center=_e(T,ye).wrap()}return f}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}_calculateNearFarZIfNeeded(e,o,f){if(!this._helper.autoCalculateNearFarZ)return;const y=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),T=e-y*this._helper._pixelPerMeter/Math.cos(o),E=y<0?T:e,k=Math.PI/2+this.pitchInRadians,I=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),O=Math.sin(I)*E/Math.sin(c.ah(Math.PI-k-I,.01,Math.PI-.01)),j=Te(this),Z=Math.atan(j/this._helper.cameraToCenterDistance),U=c.ae(.75),Y=Z>U?2*Z*(.5+f.y/(2*j)):U,Q=Math.sin(Y)*E/Math.sin(c.ah(Math.PI-k-Y,.01,Math.PI-.01)),le=Math.min(O,Q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*le+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,o=ae(this.worldSize,this.center),f=o.x,y=o.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const T=c.ae(Math.min(this.pitch,J)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(T));let k;this._calculateNearFarZIfNeeded(E,T,e),k=new Float64Array(16),c.b4(k,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,k),k[8]=2*-e.x/this._helper._width,k[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b5(k),c.N(k,k,[1,-1,1]),c.M(k,k,[0,0,-this._helper.cameraToCenterDistance]),c.b6(k,k,-this.rollInRadians),c.b7(k,k,this.pitchInRadians),c.b6(k,k,-this.bearingInRadians),c.M(k,k,[-f,-y,0]),this._mercatorMatrix=c.N([],k,[this.worldSize,this.worldSize,this.worldSize]),c.N(k,k,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,k),c.M(k,k,[0,0,-this.elevation]),this._viewProjMatrix=k,this._invViewProjMatrix=c.aq([],k);const I=[0,0,-1,1];c.aw(I,I,this._invViewProjMatrix),this._cameraPosition=[I[0]/I[3],I[1]/I[3],I[2]/I[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-f,-y,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,k);const O=this._helper._width%2/2,j=this._helper._height%2/2,Z=Math.cos(this.bearingInRadians),U=Math.sin(-this.bearingInRadians),Y=f-Math.round(f)+Z*O+U*j,Q=y-Math.round(y)+Z*j+U*O,le=new Float64Array(k);if(c.M(le,le,[Y>.5?Y-1:Y,Q>.5?Q-1:Q,0]),this._alignedProjMatrix=le,k=c.aq(new Float64Array(16),this._pixelMatrix),!k)throw new Error("failed to invert matrix");this._pixelMatrixInverse=k,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),o=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.aw(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Fe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,o){const f=c.a1.fromLngLat(e),y=[f.x*this.worldSize,f.y*this.worldSize,o,1];return c.aw(y,y,this._viewProjMatrix),y[2]/y[3]}getProjectionData(e){const{overscaledTileID:o,aligned:f,applyTerrainMatrix:y}=e,T=this._helper.getMercatorTileCoordinates(o),E=o?this.calculatePosMatrix(o,f,!0):null;let k;return k=o&&o.terrainRttPosMatrix32f&&y?o.terrainRttPosMatrix32f:E||c.b8(),{mainMatrix:k,tileMercatorCoords:T,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:k}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,o,f){return 1}transformLightDirection(e){return c.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,o,f,y){const T=this.calculatePosMatrix(f);let E;y?(E=[e,o,y(e,o),1],c.aw(E,E,T)):(E=[e,o,0,1],Fl(E,E,T));const k=E[3];return{point:new c.P(E[0]/k,E[1]/k),signedDistanceFromCamera:k,isOccluded:!1}}populateCache(e){for(const o of e)this.calculatePosMatrix(o)}getMatrixForModel(e,o){const f=c.a1.fromLngLat(e,o),y=f.meterInMercatorCoordinateUnits(),T=c.b9();return c.M(T,T,[f.x,f.y,f.z]),c.b6(T,T,Math.PI),c.b7(T,T,Math.PI/2),c.N(T,T,[-y,y,y]),T}getProjectionDataForCustomLayer(e=!0){const o=new c.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:e}),y=Me(o,this.worldSize);c.O(y,this._viewProjMatrix,y),f.tileMercatorCoords=[0,0,1,1];const T=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],E=c.ba();return c.N(E,y,T),f.fallbackMatrix=E,f.mainMatrix=E,f}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function co(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Pr(b){if(b.useSlerp)if(b.k<1){const e=c.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),o=c.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),f=new Float64Array(4);c.bc(f,e,o,b.k);const y=c.bd(f);b.tr.setRoll(y.roll),b.tr.setPitch(y.pitch),b.tr.setBearing(y.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function Nr(b,e,o,f,y){const T=y.padding,E=ae(y.worldSize,o.getNorthWest()),k=ae(y.worldSize,o.getNorthEast()),I=ae(y.worldSize,o.getSouthEast()),O=ae(y.worldSize,o.getSouthWest()),j=c.ae(-f),Z=E.rotate(j),U=k.rotate(j),Y=I.rotate(j),Q=O.rotate(j),le=new c.P(Math.max(Z.x,U.x,Q.x,Y.x),Math.max(Z.y,U.y,Q.y,Y.y)),oe=new c.P(Math.min(Z.x,U.x,Q.x,Y.x),Math.min(Z.y,U.y,Q.y,Y.y)),ue=le.sub(oe),he=(y.width-(T.left+T.right+e.left+e.right))/ue.x,ye=(y.height-(T.top+T.bottom+e.top+e.bottom))/ue.y;if(ye<0||he<0)return void co();const me=Math.min(c.ak(y.scale*Math.min(he,ye)),b.maxZoom),xe=c.P.convert(b.offset),Ee=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ae(f)),ge=xe.add(Ee).mult(y.scale/c.af(me));return{center:_e(y.worldSize,E.add(I).div(2).sub(ge)),zoom:me,bearing:f}}class Fi{get useGlobeControls(){return!1}handlePanInertia(e,o){const f=e.mag(),y=Math.abs(Te(o));return{easingOffset:e.mult(Math.min(.75*y/f,1)),easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(e,o){e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta),e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta)}handleMapControlsPan(e,o,f){e.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(f,e.around)}cameraForBoxAndBearing(e,o,f,y,T){return Nr(e,o,f,y,T)}handleJumpToCenterZoom(e,o){e.zoom!==(o.zoom!==void 0?+o.zoom:e.zoom)&&e.setZoom(+o.zoom),o.center!==void 0&&e.setCenter(c.S.convert(o.center))}handleEaseTo(e,o){const f=e.zoom,y=e.padding,T={roll:e.roll,pitch:e.pitch,bearing:e.bearing},E={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},k=o.zoom!==void 0,I=!e.isPaddingEqual(o.padding);let O=!1;const j=k?+o.zoom:e.zoom;let Z=e.centerPoint.add(o.offsetAsPoint);const U=e.screenPointToLocation(Z),{center:Y,zoom:Q}=e.getConstrained(c.S.convert(o.center||U),j??f);Oc(e,Y);const le=ae(e.worldSize,U),oe=ae(e.worldSize,Y).sub(le),ue=c.af(Q-f);return O=Q!==f,{easeFunc:he=>{if(O&&e.setZoom(c.C.number(f,Q,he)),c.be(T,E)||Pr({startEulerAngles:T,endEulerAngles:E,tr:e,k:he,useSlerp:T.roll!=E.roll}),I&&(e.interpolatePadding(y,o.padding,he),Z=e.centerPoint.add(o.offsetAsPoint)),o.around)e.setLocationAtPoint(o.around,o.aroundPoint);else{const ye=c.af(e.zoom-f),me=Q>f?Math.min(2,ue):Math.max(.5,ue),xe=Math.pow(me,1-he),Ee=_e(e.worldSize,le.add(oe.mult(he*xe)).mult(ye));e.setLocationAtPoint(e.renderWorldCopies?Ee.wrap():Ee,Z)}},isZooming:O,elevationCenter:Y}}handleFlyTo(e,o){const f=o.zoom!==void 0,y=e.zoom,T=e.getConstrained(c.S.convert(o.center||o.locationAtOffset),f?+o.zoom:y),E=T.center,k=T.zoom;Oc(e,E);const I=ae(e.worldSize,o.locationAtOffset),O=ae(e.worldSize,E).sub(I),j=O.mag(),Z=c.af(k-y);let U;if(o.minZoom!==void 0){const Y=Math.min(+o.minZoom,y,k),Q=e.getConstrained(E,Y).zoom;U=c.af(Q-y)}return{easeFunc:(Y,Q,le,oe)=>{e.setZoom(Y===1?k:y+c.ak(Q));const ue=Y===1?E:_e(e.worldSize,I.add(O.mult(le)).mult(Q));e.setLocationAtPoint(e.renderWorldCopies?ue.wrap():ue,oe)},scaleOfZoom:Z,targetCenter:E,scaleOfMinZoom:U,pixelPathLength:j}}}class si{constructor(e,o,f){this.blendFunction=e,this.blendColor=o,this.mask=f}}si.Replace=[1,0],si.disabled=new si(si.Replace,c.bf.transparent,[!1,!1,!1,!1]),si.unblended=new si(si.Replace,c.bf.transparent,[!0,!0,!0,!0]),si.alphaBlended=new si([1,771],c.bf.transparent,[!0,!0,!0,!0]);const uo=2305;class qt{constructor(e,o,f){this.enable=e,this.mode=o,this.frontFace=f}}qt.disabled=new qt(!1,1029,uo),qt.backCCW=new qt(!0,1029,uo),qt.frontCCW=new qt(!0,1028,uo);class nn{constructor(e,o,f){this.func=e,this.mask=o,this.range=f}}nn.ReadOnly=!1,nn.ReadWrite=!0,nn.disabled=new nn(519,nn.ReadOnly,[0,1]);const ts=7680;class Mn{constructor(e,o,f,y,T,E){this.test=e,this.ref=o,this.mask=f,this.fail=y,this.depthFail=T,this.pass=E}}Mn.disabled=new Mn({func:519,mask:0},0,0,ts,ts,ts);const gi=new WeakMap;function Gr(b){var e;if(gi.has(b))return gi.get(b);{const o=(e=b.getParameter(b.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return gi.set(b,o),o}}class Ia{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const o=e.context,f=o.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const y=new c.aL;y.emplaceBack(-1,-1),y.emplaceBack(2,-1),y.emplaceBack(-1,2);const T=new c.aN;T.emplaceBack(0,1,2),this._fullscreenTriangle=new ll(o.createVertexBuffer(y,lo.members),o.createIndexBuffer(T),c.aM.simpleSegment(0,0,y.length,T.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(f.TEXTURE1);const E=f.createTexture();f.bindTexture(f.TEXTURE_2D,E),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),Gr(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,o){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,o=e.gl;e.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,o){const f=this._cachedRenderContext.context,y=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,y.TRIANGLES,nn.disabled,Mn.disabled,si.unblended,qt.disabled,((T,E)=>({u_input:T,u_output_expected:E}))(e,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Gr(y)){y.bindBuffer(y.PIXEL_PACK_BUFFER,this._pbo),y.readBuffer(y.COLOR_ATTACHMENT0),y.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),y.bindBuffer(y.PIXEL_PACK_BUFFER,null);const T=y.fenceSync(y.SYNC_GPU_COMMANDS_COMPLETE,0);y.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:T}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Gr(e)){const o=e.clientWaitSync(this._readbackQueue.sync,0,0);if(o===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ia._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let o=0;return o+=e[0]/256,o+=e[1]/65536,o+=e[2]/16777216,e[3]<127&&(o=-o),o/128}}const cl=c.$/128;function bf(b,e){const o=b.granularity!==void 0?Math.max(b.granularity,1):1,f=o+(b.generateBorders?2:0),y=o+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),T=f+1,E=y+1,k=b.generateBorders?-1:0,I=b.generateBorders||b.extendToNorthPole?-1:0,O=o+(b.generateBorders?1:0),j=o+(b.generateBorders||b.extendToSouthPole?1:0),Z=T*E,U=f*y*6,Y=T*E>65536;if(Y&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Q=Y||e==="32bit",le=new Int16Array(2*Z);let oe=0;for(let ye=I;ye<=j;ye++)for(let me=k;me<=O;me++){let xe=me/o*c.$;me===-1&&(xe=-cl),me===o+1&&(xe=c.$+cl);let Ee=ye/o*c.$;ye===-1&&(Ee=b.extendToNorthPole?c.bh:-cl),ye===o+1&&(Ee=b.extendToSouthPole?c.bi:c.$+cl),le[oe++]=xe,le[oe++]=Ee}const ue=Q?new Uint32Array(U):new Uint16Array(U);let he=0;for(let ye=0;ye<y;ye++)for(let me=0;me<f;me++){const xe=me+1+ye*T,Ee=me+(ye+1)*T,ge=me+1+(ye+1)*T;ue[he++]=me+ye*T,ue[he++]=Ee,ue[he++]=xe,ue[he++]=xe,ue[he++]=Ee,ue[he++]=ge}return{vertices:le.buffer.slice(0),indices:ue.buffer.slice(0),uses32bitIndices:Q}}const ul=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class $l{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Es.projectionGlobe}get vertexShaderPreludeCode(){return Es.projectionMercator.vertexSource}get subdivisionGranularity(){return ul}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Ia(e));const o=c.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,y=this._errorMeasurement.updateErrorLoop(o,f),T=V.now();y!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=y,this._errorMeasurementLastChangeTime=T);const E=Math.min(Math.max((T-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(E))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,o,f,y,T){const E=(T==="stencil"?ul.stencil:ul.tile).getGranularityForZoomLevel(o.z);return this._getMesh(e,{granularity:E,generateBorders:f,extendToNorthPole:o.y===0&&y,extendToSouthPole:o.y===(1<<o.z)-1&&y})}_getMesh(e,o){const f=this._getMeshKey(o);if(f in this._tileMeshCache)return this._tileMeshCache[f];const y=function(T,E){const k=bf(E,"16bit"),I=c.aL.deserialize({arrayBuffer:k.vertices,length:k.vertices.byteLength/2/2}),O=c.aN.deserialize({arrayBuffer:k.indices,length:k.indices.byteLength/2/3});return new ll(T.createVertexBuffer(I,lo.members),T.createIndexBuffer(O),c.aM.simpleSegment(0,0,I.length,O.length))}(e,o);return this._tileMeshCache[f]=y,y}recalculate(e){}hasTransition(){const e=V.now();let o=!1;return o=o||(e-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const hl=new c.r({type:new c.D(c.v.projection.type)});class Yl extends c.E{constructor(e){super(),this._transitionable=new c.t(hl,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new gn,this._verticalPerspectiveProjection=new $l}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,o,f,y,T){return this.currentProjection.getMeshFromTileID(e,o,f,y,T)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Yu(b){const e=jc(b.worldSize,b.center.lat);return 2*Math.PI*e}function As(b,e,o,f,y){const T=1/(1<<y),E=e/c.$*T+f*T,k=c.bo((b/c.$*T+o*T)*Math.PI*2+Math.PI,2*Math.PI),I=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,O=Math.cos(I),j=new Float64Array(3);return j[0]=Math.sin(k)*O,j[1]=Math.sin(I),j[2]=Math.cos(k)*O,j}function Tr(b){return function(e,o){const f=Math.cos(o),y=new Float64Array(3);return y[0]=Math.sin(e)*f,y[1]=Math.sin(o),y[2]=Math.cos(e)*f,y}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function jc(b,e){return b/(2*Math.PI)/Math.cos(e*Math.PI/180)}function ql(b){const e=Math.asin(b[1])/Math.PI*180,o=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(o>1e-6){const f=b[0]/o,y=Math.acos(b[2]/o),T=(f>0?y:-y)/Math.PI*180;return new c.S(c.aO(T,-180,180),e)}return new c.S(0,e)}function Hl(b){return Math.cos(b*Math.PI/180)}function Zi(b,e){const o=Hl(b),f=Hl(e);return c.ak(f/o)}function Np(b,e){const o=b.rotate(e.bearingInRadians),f=e.zoom+Zi(e.center.lat,0),y=c.bk(1/Hl(e.center.lat),1/Hl(Math.min(Math.abs(e.center.lat),60)),c.bn(f,7,3,0,1)),T=360/Yu({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-o.x*T*y,c.ah(e.center.lat+o.y*T,-c.ai,c.ai))}function qu(b){const e=.5*b,o=Math.sin(e),f=Math.cos(e);return Math.log(o+f)-Math.log(f-o)}function xf(b,e,o,f){const y=b.lat+o*f;if(Math.abs(o)>1){const T=(Math.sign(b.lat+o)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,E=Math.abs(b.lat+o)*Math.PI/180,k=qu(T+f*(E-T)),I=qu(T),O=qu(E);return new c.S(b.lng+e*((k-I)/(O-I)),y)}return new c.S(b.lng+e*f,y)}class zp{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,o,f,y){const T=`${e.z}_${e.x}_${e.y}_${y?.terrain?"t":""}`,E=this._cache.get(T);if(E)return E;const k=this._cachePrevious.get(T);if(k)return this._cache.set(T,k),k;const I=this._boundingVolumeFactory(e,o,f,y);return this._cache.set(T,I),this._hadAnyChanges=!0,I}}class Bc{constructor(e,o,f,y){this.min=f,this.max=y,this.points=e,this.planes=o}static fromAabb(e,o){const f=[];for(let y=0;y<8;y++)f.push([1&~y?e[0]:o[0],(y>>1&1)==1?o[1]:e[1],(y>>2&1)==1?o[2]:e[2]]);return new Bc(f,[[-1,0,0,o[0]],[1,0,0,-e[0]],[0,-1,0,o[1]],[0,1,0,-e[1]],[0,0,-1,o[2]],[0,0,1,-e[2]]],e,o)}static fromCenterSizeAngles(e,o,f){const y=c.br([],f[0],f[1],f[2]),T=c.bs([],[o[0],0,0],y),E=c.bs([],[0,o[1],0],y),k=c.bs([],[0,0,o[2]],y),I=[...e],O=[...e];for(let Z=0;Z<8;Z++)for(let U=0;U<3;U++){const Y=e[U]+T[U]*(1&~Z?-1:1)+E[U]*((Z>>1&1)==1?1:-1)+k[U]*((Z>>2&1)==1?1:-1);I[U]=Math.min(I[U],Y),O[U]=Math.max(O[U],Y)}const j=[];for(let Z=0;Z<8;Z++){const U=[...e];c.aS(U,U,c.aR([],T,1&~Z?-1:1)),c.aS(U,U,c.aR([],E,(Z>>1&1)==1?1:-1)),c.aS(U,U,c.aR([],k,(Z>>2&1)==1?1:-1)),j.push(U)}return new Bc(j,[[...T,-c.aX(T,j[0])],[...E,-c.aX(E,j[0])],[...k,-c.aX(k,j[0])],[-T[0],-T[1],-T[2],-c.aX(T,j[7])],[-E[0],-E[1],-E[2],-c.aX(E,j[7])],[-k[0],-k[1],-k[2],-c.aX(k,j[7])]],I,O)}intersectsFrustum(e){let o=!0;const f=this.points.length,y=this.planes.length,T=e.planes.length,E=e.points.length;for(let k=0;k<T;k++){const I=e.planes[k];let O=0;for(let j=0;j<f;j++){const Z=this.points[j];I[0]*Z[0]+I[1]*Z[1]+I[2]*Z[2]+I[3]>=0&&O++}if(O===0)return 0;O<f&&(o=!1)}if(o)return 2;for(let k=0;k<y;k++){const I=this.planes[k];let O=0;for(let j=0;j<E;j++){const Z=e.points[j];I[0]*Z[0]+I[1]*Z[1]+I[2]*Z[2]+I[3]>=0&&O++}if(O===0)return 0}return 1}intersectsPlane(e){const o=this.points.length;let f=0;for(let y=0;y<o;y++){const T=this.points[y];e[0]*T[0]+e[1]*T[1]+e[2]*T[2]+e[3]>=0&&f++}return f===o?2:f===0?0:1}}function zr(b,e,o){const f=b-e;return f<0?-f:Math.max(0,f-o)}function Hu(b,e,o,f,y){const T=b-o;let E;return E=T<0?Math.min(-T,1+T-y):T>1?Math.min(Math.max(T-y,0),1-T):0,Math.max(E,zr(e,f,y))}class ho{constructor(){this._boundingVolumeCache=new zp(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,o,f,y){const T=1<<f.z,E=1/T,k=f.x/T,I=f.y/T;let O=2;return O=Math.min(O,Hu(e,o,k,I,E)),O=Math.min(O,Hu(e,o,k+.5,-I-E,E)),O=Math.min(O,Hu(e,o,k+.5,2-I-E,E)),O}getWrap(e,o,f){const y=1<<o.z,T=1/y,E=o.x/y,k=zr(e.x,E,T),I=zr(e.x,E-1,T),O=zr(e.x,E+1,T),j=Math.min(k,I,O);return j===O?1:j===I?-1:0}allowVariableZoom(e,o){return Lt(e,o)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,o,f,y){return this._boundingVolumeCache.getTileBoundingVolume(e,o,f,y)}_computeTileBoundingVolume(e,o,f,y){var T,E;let k=0,I=0;if(y?.terrain){const O=new c.Z(e.z,o,e.z,e.x,e.y),j=y.terrain.getMinMaxElevation(O);k=(T=j.minElevation)!==null&&T!==void 0?T:Math.min(0,f),I=(E=j.maxElevation)!==null&&E!==void 0?E:Math.max(0,f)}if(k/=c.bu,I/=c.bu,k+=1,I+=1,e.z<=0)return Bc.fromAabb([-I,-I,-I],[I,I,I]);if(e.z===1)return Bc.fromAabb([e.x===0?-I:0,e.y===0?0:-I,-I],[e.x===0?0:I,e.y===0?I:0,I]);{const O=[As(0,0,e.x,e.y,e.z),As(c.$,0,e.x,e.y,e.z),As(c.$,c.$,e.x,e.y,e.z),As(0,c.$,e.x,e.y,e.z)],j=[];for(const Oe of O)j.push(c.aR([],Oe,I));if(I!==k)for(const Oe of O)j.push(c.aR([],Oe,k));e.y===0&&j.push([0,1,0]),e.y===(1<<e.z)-1&&j.push([0,-1,0]);const Z=[1,1,1],U=[-1,-1,-1];for(const Oe of j)for(let Ye=0;Ye<3;Ye++)Z[Ye]=Math.min(Z[Ye],Oe[Ye]),U[Ye]=Math.max(U[Ye],Oe[Ye]);const Y=As(c.$/2,c.$/2,e.x,e.y,e.z),Q=c.aW([],[0,1,0],Y);c.aV(Q,Q);const le=c.aW([],Y,Q);c.aV(le,le);const oe=c.aW([],O[2],O[1]);c.aV(oe,oe);const ue=c.aW([],O[0],O[3]);c.aV(ue,ue),j.push(c.aR([],Y,I)),e.y>=(1<<e.z)/2&&j.push(c.aR([],As(c.$/2,0,e.x,e.y,e.z),I)),e.y<(1<<e.z)/2&&j.push(c.aR([],As(c.$/2,c.$,e.x,e.y,e.z),I));const he=Xl(Y,j),ye=Xl(le,j),me=[-Y[0],-Y[1],-Y[2],he.max],xe=[Y[0],Y[1],Y[2],-he.min],Ee=[-le[0],-le[1],-le[2],ye.max],ge=[le[0],le[1],le[2],-ye.min],De=[...oe,0],qe=[...ue,0],Le=[];return e.y===0?Le.push(c.bt(qe,De,me),c.bt(qe,De,xe)):Le.push(c.bt(Ee,De,me),c.bt(Ee,De,xe),c.bt(Ee,qe,me),c.bt(Ee,qe,xe)),e.y===(1<<e.z)-1?Le.push(c.bt(qe,De,me),c.bt(qe,De,xe)):Le.push(c.bt(ge,De,me),c.bt(ge,De,xe),c.bt(ge,qe,me),c.bt(ge,qe,xe)),new Bc(Le,[me,xe,Ee,ge,De,qe],Z,U)}}}function Xl(b,e){let o=1/0,f=-1/0;for(const y of e){const T=c.aX(b,y);o=Math.min(o,T),f=Math.max(f,T)}return{min:o,max:f}}class Xu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o){this._helper.resize(e,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new sr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._coveringTilesDetailsProvider=new ho}clone(){const e=new Xu;return e.apply(this),e}apply(e,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:o,applyGlobeMatrix:f}=e,y=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:y,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const o=this.pitchInRadians,f=this.cameraToCenterDistance/e,y=Math.sin(o)*f,T=Math.cos(o)*f+1,E=1/Math.sqrt(y*y+T*T)*1;let k=-y,I=T;const O=Math.sqrt(k*k+I*I);k/=O,I/=O;const j=[0,k,I];c.bw(j,j,[0,0,0],-this.bearingInRadians),c.bx(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),c.by(j,j,[0,0,0],this.center.lng*Math.PI/180);const Z=1/c.aZ(j);return c.aR(j,j,Z),[...j,-E*Z]}isLocationOccluded(e){return!this.isSurfacePointVisible(Tr(e))}transformLightDirection(e){const o=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,y=Math.cos(f),T=[Math.sin(o)*y,Math.sin(f),Math.cos(o)*y],E=[T[2],0,-T[0]],k=[0,0,0];c.aW(k,E,T),c.aV(E,E),c.aV(k,k);const I=[0,0,0];return c.aV(I,[E[0]*e[0]+k[0]*e[1]+T[0]*e[2],E[1]*e[0]+k[1]*e[1]+T[1]*e[2],E[2]*e[0]+k[2]*e[1]+T[2]*e[2]]),I}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,o,f){const y=function(k,I,O){const j=1/(1<<O.z);return new c.a1(k/c.$*j+O.x*j,I/c.$*j+O.y*j)}(e,o,f.canonical),T=(E=y.y,[c.bo(y.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(T[1])}projectTileCoordinates(e,o,f,y){const T=f.canonical,E=As(e,o,T.x,T.y,T.z),k=1+(y?y(e,o):0)/c.bu,I=[E[0]*k,E[1]*k,E[2]*k,1];c.aw(I,I,this._globeViewProjMatrixNoCorrection);const O=this._cachedClippingPlane,j=O[0]*E[0]+O[1]*E[1]+O[2]*E[2]+O[3]<0;return{point:new c.P(I[0]/I[3],I[1]/I[3]),signedDistanceFromCamera:I[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=jc(this.worldSize,this.center.lat),o=c.ba(),f=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b4(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const y=this.centerOffset;o[8]=2*-y.x/this._helper._width,o[9]=2*y.y/this._helper._height,this._projectionMatrix=c.b5(o),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,o),c.M(o,o,[0,0,-this.cameraToCenterDistance]),c.b6(o,o,this.rollInRadians),c.b7(o,o,-this.pitchInRadians),c.b6(o,o,this.bearingInRadians),c.M(o,o,[0,0,-e]);const T=c.bp();T[0]=e,T[1]=e,T[2]=e,c.b7(f,o,this.center.lat*Math.PI/180),c.bz(f,f,-this.center.lng*Math.PI/180),c.N(f,f,T),this._globeViewProjMatrixNoCorrection=f,c.b7(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(o,o,-this.center.lng*Math.PI/180),c.N(o,o,T),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const E=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bw(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const k=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(k,k,[1,1,-1]),this._cachedFrustum=Wi.fromInvProjectionMatrix(k,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const o=c.ba();return c.ag(o),o}getVisibleUnwrappedCoordinates(e){return[new c.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=Tr(e);c.aR(f,f,1+o/c.bu);const y=c.bv();return c.aw(y,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),y[2]/y[3]}populateCache(e){}getBounds(){const e=.5*this.width,o=.5*this.height,f=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,o),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,o)],y=[];for(const Z of f)y.push(this.unprojectScreenPoint(Z));let T=0,E=0,k=0,I=0;const O=this.center;for(const Z of y){const U=c.bA(O.lng,Z.lng),Y=c.bA(O.lat,Z.lat);U<E&&(E=U),U>T&&(T=U),Y<I&&(I=Y),Y>k&&(k=Y)}const j=[O.lng+E,O.lat+I,O.lng+T,O.lat+k];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new Yn(j)}getConstrained(e,o){const f=c.ah(e.lat,-c.ai,c.ai),y=c.ah(+o,this.minZoom+Zi(0,f),this.maxZoom);return{center:new c.S(e.lng,f),zoom:y}}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}setLocationAtPoint(e,o){const f=Tr(this.unprojectScreenPoint(o)),y=Tr(e),T=c.bp();c.bB(T);const E=c.bp();c.by(E,f,T,-this.center.lng*Math.PI/180),c.bx(E,E,T,this.center.lat*Math.PI/180);const k=y[0]*y[0]+y[2]*y[2],I=E[0]*E[0];if(k<I)return;const O=Math.sqrt(k-I),j=-O,Z=c.bC(y[0],y[2],E[0],O),U=c.bC(y[0],y[2],E[0],j),Y=c.bp();c.by(Y,y,T,-Z);const Q=c.bC(Y[1],Y[2],E[1],E[2]),le=c.bp();c.by(le,y,T,-U);const oe=c.bC(le[1],le[2],E[1],E[2]),ue=.5*Math.PI,he=Q>=-ue&&Q<=ue,ye=oe>=-ue&&oe<=ue;let me,xe;if(he&&ye){const qe=this.center.lng*Math.PI/180,Le=this.center.lat*Math.PI/180;c.bD(Z,qe)+c.bD(Q,Le)<c.bD(U,qe)+c.bD(oe,Le)?(me=Z,xe=Q):(me=U,xe=oe)}else if(he)me=Z,xe=Q;else{if(!ye)return;me=U,xe=oe}const Ee=me/Math.PI*180,ge=xe/Math.PI*180,De=this.center.lat;this.setCenter(new c.S(Ee,c.ah(ge,-90,90))),this.setZoom(this.zoom+Zi(De,this.center.lat))}locationToScreenPoint(e,o){const f=Tr(e);if(o){const y=o.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aR(f,f,1+y/c.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(e){const o=c.bv();return c.aw(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new c.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,o){if(o){const f=o.pointCoordinate(e);if(f)return f}return c.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,o){var f;return(f=this.screenPointToMercatorCoordinate(e,o))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(e,o){const f=this._cameraPosition,y=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(f,y)}getRayDirectionFromPixel(e){const o=c.bv();o[0]=e.x/this.width*2-1,o[1]=-1*(e.y/this.height*2-1),o[2]=1,o[3]=1,c.aw(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const f=c.bp();f[0]=o[0]-this._cameraPosition[0],f[1]=o[1]-this._cameraPosition[1],f[2]=o[2]-this._cameraPosition[2];const y=c.bp();return c.aV(y,f),y}isSurfacePointVisible(e){const o=this._cachedClippingPlane;return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const o=c.bv();return c.aw(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(e,o){const f=c.aX(e,o),y=c.bp(),T=c.bp();c.aR(T,o,f),c.aU(y,e,T);const E=1-c.aX(y,y);if(E<0)return null;const k=c.aX(e,e)-1,I=-f+(f<0?1:-1)*Math.sqrt(E),O=k/I,j=I;return{tMin:Math.min(O,j),tMax:Math.max(O,j)}}unprojectScreenPoint(e){const o=this._cameraPosition,f=this.getRayDirectionFromPixel(e),y=this.rayPlanetIntersection(o,f);if(y){const j=c.bp();c.aS(j,o,[f[0]*y.tMin,f[1]*y.tMin,f[2]*y.tMin]);const Z=c.bp();return c.aV(Z,j),ql(Z)}const T=this._cachedClippingPlane,E=T[0]*f[0]+T[1]*f[1]+T[2]*f[2],k=-c.b1(T,o)/E,I=c.bp();if(k>0)c.aS(I,o,[f[0]*k,f[1]*k,f[2]*k]);else{const j=c.bp();c.aS(j,o,[2*f[0],2*f[1],2*f[2]]);const Z=c.b1(this._cachedClippingPlane,j);c.aU(I,j,[this._cachedClippingPlane[0]*Z,this._cachedClippingPlane[1]*Z,this._cachedClippingPlane[2]*Z])}const O=function(j){const Z=c.bp();return Z[0]=j[0]*-j[3],Z[1]=j[1]*-j[3],Z[2]=j[2]*-j[3],{center:Z,radius:Math.sqrt(1-j[3]*j[3])}}(T);return ql(function(j,Z,U){const Y=c.bp();c.aU(Y,U,j);const Q=c.bp();return c.bq(Q,j,Y,Z/c.a$(Y)),Q}(O.center,O.radius,I))}getMatrixForModel(e,o){const f=c.S.convert(e),y=1/c.bu,T=c.b9();return c.bz(T,T,f.lng/180*Math.PI),c.b7(T,T,-f.lat/180*Math.PI),c.M(T,T,[0,0,1+o/c.bu]),c.b7(T,T,.5*Math.PI),c.N(T,T,[y,y,y]),T}getProjectionDataForCustomLayer(e=!0){const o=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(e){}}class Wu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,f=!0){this._helper.resize(e,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,o){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new sr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._globeness=1,this._mercatorTransform=new Vn,this._verticalPerspectiveTransform=new Xu}clone(){const e=new Wu;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const o=this._mercatorTransform.getProjectionData(e),f=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:o.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,o,f){const y=this._mercatorTransform.getPitchedTextCorrection(e,o,f),T=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,o,f);return c.bk(y,T,this._globeness)}projectTileCoordinates(e,o,f,y){return this.currentTransform.projectTileCoordinates(e,o,f,y)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){return this.currentTransform.lngLatToCameraDepth(e,o)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,o){return this.currentTransform.getConstrained(e,o)}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}setLocationAtPoint(e,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,o){return this.currentTransform.locationToScreenPoint(e,o)}screenPointToMercatorCoordinate(e,o){return this.currentTransform.screenPointToMercatorCoordinate(e,o)}screenPointToLocation(e,o){return this.currentTransform.screenPointToLocation(e,o)}isPointOnMapSurface(e,o){return this.currentTransform.isPointOnMapSurface(e,o)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,o){return this.currentTransform.getMatrixForModel(e,o)}getProjectionDataForCustomLayer(e=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return o;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return f.fallbackMatrix=o.mainMatrix,f}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Zr{get useGlobeControls(){return!0}handlePanInertia(e,o){const f=Np(e,o);return Math.abs(f.lng-o.center.lng)>180&&(f.lng=o.center.lng+179.5*Math.sign(f.lng-o.center.lng)),{easingCenter:f,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,o){const f=e.around,y=o.screenPointToLocation(f);e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta);const T=o.zoom;e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta);const E=o.zoom-T;if(E===0)return;const k=c.bA(o.center.lng,y.lng),I=k/(Math.abs(k/180)+1),O=c.bA(o.center.lat,y.lat),j=o.getRayDirectionFromPixel(f),Z=o.cameraPosition,U=-1*c.aX(Z,j),Y=c.bp();c.aS(Y,Z,[j[0]*U,j[1]*U,j[2]*U]);const Q=c.aZ(Y)-1,le=Math.exp(.5*-Math.max(Q-.3,0)),oe=jc(o.worldSize,o.center.lat)/Math.min(o.width,o.height),ue=c.bn(oe,.9,.5,1,.25),he=(1-c.af(-E))*Math.min(le,ue),ye=o.center.lat,me=o.zoom,xe=new c.S(o.center.lng+I*he,c.ah(o.center.lat+O*he,-c.ai,c.ai));o.setLocationAtPoint(y,f);const Ee=o.center,ge=c.bn(Math.abs(k),45,85,0,1),De=c.bn(oe,.75,.35,0,1),qe=Math.pow(Math.max(ge,De),.25),Le=c.bA(Ee.lng,xe.lng),Oe=c.bA(Ee.lat,xe.lat);o.setCenter(new c.S(Ee.lng+Le*qe,Ee.lat+Oe*qe).wrap()),o.setZoom(me+Zi(ye,o.center.lat))}handleMapControlsPan(e,o,f){if(!e.panDelta)return;const y=o.center.lat,T=o.zoom;o.setCenter(Np(e.panDelta,o).wrap()),o.setZoom(T+Zi(y,o.center.lat))}cameraForBoxAndBearing(e,o,f,y,T){const E=Nr(e,o,f,y,T),k=o.left/T.width*2-1,I=(T.width-o.right)/T.width*2-1,O=o.top/T.height*-2+1,j=(T.height-o.bottom)/T.height*-2+1,Z=c.bA(f.getWest(),f.getEast())<0,U=Z?f.getEast():f.getWest(),Y=Z?f.getWest():f.getEast(),Q=Math.max(f.getNorth(),f.getSouth()),le=Math.min(f.getNorth(),f.getSouth()),oe=U+.5*c.bA(U,Y),ue=Q+.5*c.bA(Q,le),he=T.clone();he.setCenter(E.center),he.setBearing(E.bearing),he.setPitch(0),he.setRoll(0),he.setZoom(E.zoom);const ye=he.modelViewProjectionMatrix,me=[Tr(f.getNorthWest()),Tr(f.getNorthEast()),Tr(f.getSouthWest()),Tr(f.getSouthEast()),Tr(new c.S(Y,ue)),Tr(new c.S(U,ue)),Tr(new c.S(oe,Q)),Tr(new c.S(oe,le))],xe=Tr(E.center);let Ee=Number.POSITIVE_INFINITY;for(const ge of me)k<0&&(Ee=Zr.getLesserNonNegativeNonNull(Ee,Zr.solveVectorScale(ge,xe,ye,"x",k))),I>0&&(Ee=Zr.getLesserNonNegativeNonNull(Ee,Zr.solveVectorScale(ge,xe,ye,"x",I))),O>0&&(Ee=Zr.getLesserNonNegativeNonNull(Ee,Zr.solveVectorScale(ge,xe,ye,"y",O))),j<0&&(Ee=Zr.getLesserNonNegativeNonNull(Ee,Zr.solveVectorScale(ge,xe,ye,"y",j)));if(Number.isFinite(Ee)&&Ee!==0)return E.zoom=he.zoom+c.ak(Ee),E;co()}handleJumpToCenterZoom(e,o){const f=e.center.lat,y=e.getConstrained(o.center?c.S.convert(o.center):e.center,e.zoom).center;e.setCenter(y.wrap());const T=o.zoom!==void 0?+o.zoom:e.zoom+Zi(f,y.lat);e.zoom!==T&&e.setZoom(T)}handleEaseTo(e,o){const f=e.zoom,y=e.center,T=e.padding,E={roll:e.roll,pitch:e.pitch,bearing:e.bearing},k={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},I=o.zoom!==void 0,O=!e.isPaddingEqual(o.padding);let j=!1;const Z=o.center?c.S.convert(o.center):y,U=e.getConstrained(Z,f).center;Oc(e,U);const Y=e.clone();Y.setCenter(U),Y.setZoom(I?+o.zoom:f+Zi(y.lat,Z.lat)),Y.setBearing(o.bearing);const Q=new c.P(c.ah(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));Y.setLocationAtPoint(U,Q);const le=(o.offset&&o.offsetAsPoint.mag())>0?Y.center:U,oe=I?+o.zoom:f+Zi(y.lat,le.lat),ue=f+Zi(y.lat,0),he=oe+Zi(le.lat,0),ye=c.bA(y.lng,le.lng),me=c.bA(y.lat,le.lat),xe=c.af(he-ue);return j=oe!==f,{easeFunc:Ee=>{if(c.be(E,k)||Pr({startEulerAngles:E,endEulerAngles:k,tr:e,k:Ee,useSlerp:E.roll!=k.roll}),O&&e.interpolatePadding(T,o.padding,Ee),o.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(o.around,o.aroundPoint);else{const ge=he>ue?Math.min(2,xe):Math.max(.5,xe),De=Math.pow(ge,1-Ee),qe=xf(y,ye,me,Ee*De);e.setCenter(qe.wrap())}if(j){const ge=c.C.number(ue,he,Ee)+Zi(0,e.center.lat);e.setZoom(ge)}},isZooming:j,elevationCenter:le}}handleFlyTo(e,o){const f=o.zoom!==void 0,y=e.center,T=e.zoom,E=e.padding,k=!e.isPaddingEqual(o.padding),I=e.getConstrained(c.S.convert(o.center||o.locationAtOffset),T).center,O=f?+o.zoom:e.zoom+Zi(e.center.lat,I.lat),j=e.clone();j.setCenter(I),j.setZoom(O),j.setBearing(o.bearing);const Z=new c.P(c.ah(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));j.setLocationAtPoint(I,Z);const U=j.center;Oc(e,U);const Y=function(me,xe,Ee){const ge=Tr(xe),De=Tr(Ee),qe=c.aX(ge,De),Le=Math.acos(qe),Oe=Yu(me);return Le/(2*Math.PI)*Oe}(e,y,U),Q=T+Zi(y.lat,0),le=O+Zi(U.lat,0),oe=c.af(le-Q);let ue;if(typeof o.minZoom=="number"){const me=+o.minZoom+Zi(U.lat,0),xe=Math.min(me,Q,le)+Zi(0,U.lat),Ee=e.getConstrained(U,xe).zoom+Zi(U.lat,0);ue=c.af(Ee-Q)}const he=c.bA(y.lng,U.lng),ye=c.bA(y.lat,U.lat);return{easeFunc:(me,xe,Ee,ge)=>{const De=xf(y,he,ye,Ee);k&&e.interpolatePadding(E,o.padding,me);const qe=me===1?U:De;e.setCenter(qe.wrap());const Le=Q+c.ak(xe);e.setZoom(me===1?O:Le+Zi(0,qe.lat))},scaleOfZoom:oe,targetCenter:U,scaleOfMinZoom:ue,pixelPathLength:Y}}static solveVectorScale(e,o,f,y,T){const E=y==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],k=[f[3],f[7],f[11],f[15]],I=e[0]*E[0]+e[1]*E[1]+e[2]*E[2],O=e[0]*k[0]+e[1]*k[1]+e[2]*k[2],j=o[0]*E[0]+o[1]*E[1]+o[2]*E[2],Z=o[0]*k[0]+o[1]*k[1]+o[2]*k[2];return j+T*O===I+T*Z||k[3]*(I-j)+E[3]*(Z-O)+I*Z==j*O?null:(j+E[3]-T*Z-T*k[3])/(j-I-T*Z+T*O)}static getLesserNonNegativeNonNull(e,o){return o!==null&&o>=0&&o<e?o:e}}class wf{constructor(e){this._globe=e,this._mercatorCameraHelper=new Fi,this._verticalPerspectiveCameraHelper=new Zr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,o){return this.currentHelper.handlePanInertia(e,o)}handleMapControlsRollPitchBearingZoom(e,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,o)}handleMapControlsPan(e,o,f){this.currentHelper.handleMapControlsPan(e,o,f)}cameraForBoxAndBearing(e,o,f,y,T){return this.currentHelper.cameraForBoxAndBearing(e,o,f,y,T)}handleJumpToCenterZoom(e,o){this.currentHelper.handleJumpToCenterZoom(e,o)}handleEaseTo(e,o){return this.currentHelper.handleEaseTo(e,o)}handleFlyTo(e,o){return this.currentHelper.handleFlyTo(e,o)}}const dd=(b,e)=>c.y(b,e&&e.filter(o=>o.identifier!=="source.canvas")),Mg=c.bE();class Tf extends c.E{constructor(e,o={}){var f,y;super(),this._rtlPluginLoaded=()=>{for(const E in this.sourceCaches){const k=this.sourceCaches[E].getSource().type;k!=="vector"&&k!=="geojson"||this.sourceCaches[E].reload()}},this.map=e,this.dispatcher=new Bt(Xt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(E,k)=>this.getGlyphs(E,k)),this.dispatcher.registerMessageHandler("GI",(E,k)=>this.getImages(E,k)),this.imageManager=new Ne,this.imageManager.setEventedParent(this);const T=((f=e._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((y=document.documentElement)===null||y===void 0?void 0:y.lang)||void 0;this.glyphManager=new Ut(e._requestManager,o.localIdeographFontFamily,T),this.lineAtlas=new It(256,512),this.crossTileSymbolIndex=new Gl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),Oi().on(Ts,this._rtlPluginLoaded),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const k=this.sourceCaches[E.sourceId];if(!k)return;const I=k.getSource();if(I&&I.vectorLayerIds)for(const O in this._layers){const j=this._layers[O];j.source===I.id&&this._validateLayer(j)}})}setGlobalStateProperty(e,o){var f,y,T;this._checkLoaded();const E=o===null?(T=(y=(f=this.stylesheet.state)===null||f===void 0?void 0:f[e])===null||y===void 0?void 0:y.default)!==null&&T!==void 0?T:null:o;if(c.bH(E,this._globalState[e]))return this;this._globalState[e]=E,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const o=[];for(const f in e)!c.bH(this._globalState[f],e[f].default)&&(o.push(f),this._globalState[f]=e[f].default);this._applyGlobalStateChanges(o)}_applyGlobalStateChanges(e){if(e.length===0)return;const o=new Set,f={};for(const y of e){f[y]=this._globalState[y];for(const T in this._layers){const E=this._layers[T],k=E.getLayoutAffectingGlobalStateRefs(),I=E.getPaintAffectingGlobalStateRefs();if(k.has(y)&&o.add(E.source),I.has(y))for(const{name:O,value:j}of I.get(y))this._updatePaintProperty(E,O,j)}}this.dispatcher.broadcast("UGS",f);for(const y in this.sourceCaches)o.has(y)&&(this._reloadSource(y),this._changed=!0)}loadURL(e,o={},f){this.fire(new c.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const y=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;c.j(y,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,o,f)}).catch(E=>{this._loadStyleRequest=null,E&&!T.signal.aborted&&this.fire(new c.k(E))})}loadJSON(e,o={},f){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,V.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(e,o,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Mg,{validate:!1})}_load(e,o,f){var y,T;let E=o.transformStyle?o.transformStyle(f,e):e;if(!o.validate||!dd(this,c.z(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const k in E.sources)this.addSource(k,E.sources[k],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new Ue(this.stylesheet.light),this._setProjectionInternal(((y=this.stylesheet.projection)===null||y===void 0?void 0:y.type)||"mercator"),this.sky=new Dt(this.stylesheet.sky),this.map.setTerrain((T=this.stylesheet.terrain)!==null&&T!==void 0?T:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var e;const o=c.bI(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",o),this._order=o.map(f=>f.id),this._layers={},this._serializedLayers=null;for(const f of o){const y=c.bJ(f,this._globalState);y.setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=y}}_loadSprite(e,o=!1,f=void 0){let y;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(T,E,k,I){return c._(this,void 0,void 0,function*(){const O=rt(T),j=k>1?"@2x":"",Z={},U={};for(const{id:Y,url:Q}of O){const le=E.transformRequest(Je(Q,j,".json"),"SpriteJSON");Z[Y]=c.j(le,I);const oe=E.transformRequest(Je(Q,j,".png"),"SpriteImage");U[Y]=He.getImage(oe,I)}return yield Promise.all([...Object.values(Z),...Object.values(U)]),function(Y,Q){return c._(this,void 0,void 0,function*(){const le={};for(const oe in Y){le[oe]={};const ue=V.getImageCanvasContext((yield Q[oe]).data),he=(yield Y[oe]).data;for(const ye in he){const{width:me,height:xe,x:Ee,y:ge,sdf:De,pixelRatio:qe,stretchX:Le,stretchY:Oe,content:Ye,textFitWidth:vt,textFitHeight:pt}=he[ye];le[oe][ye]={data:null,pixelRatio:qe,sdf:De,stretchX:Le,stretchY:Oe,content:Ye,textFitWidth:vt,textFitHeight:pt,spriteData:{width:me,height:xe,x:Ee,y:ge,context:ue}}}}return le})}(Z,U)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(T=>{if(this._spriteRequest=null,T)for(const E in T){this._spritesImagesIds[E]=[];const k=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(I=>!(I in T)):[];for(const I of k)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in T[E]){const O=E==="default"?I:`${E}:${I}`;this._spritesImagesIds[E].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,T[E][I],!1):this.imageManager.addImage(O,T[E][I]),o&&(this._changedImages[O]=!0)}}}).catch(T=>{this._spriteRequest=null,y=T,this.fire(new c.k(y))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),f&&f(y)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const o=this.sourceCaches[e.source];if(!o)return;const f=e.sourceLayer;if(!f)return;const y=o.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.k(new Error(`Source layer "${f}" does not exist on source "${y.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,o=!1){const f=this._serializedAllLayers();if(!e||e.length===0)return Object.values(o?c.bK(f):f);const y=[];for(const T of e)if(f[T]){const E=o?c.bK(f[T]):f[T];y.push(E)}return y}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const o=Object.keys(this._layers);for(const f of o){const y=this._layers[f];y.type!=="custom"&&(e[f]=y.serialize())}return e}hasTransitions(){var e,o,f;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const y in this.sourceCaches)if(this.sourceCaches[y].hasTransition())return!0;for(const y in this._layers)if(this._layers[y].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const o=this._changed;if(o){const y=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(y.length||T.length)&&this._updateWorkerLayers(y,T);for(const E in this._updatedSources){const k=this._updatedSources[E];if(k==="reload")this._reloadSource(E);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const f={};for(const y in this.sourceCaches){const T=this.sourceCaches[y];f[y]=T.used,T.used=!1}for(const y of this._order){const T=this._layers[y];T.recalculate(e,this._availableImages),!T.isHidden(e.zoom)&&T.source&&(this.sourceCaches[T.source].used=!0)}for(const y in f){const T=this.sourceCaches[y];!!f[y]!=!!T.used&&T.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,o&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,o={}){var f;this._checkLoaded();const y=this.serialize();if(e=o.transformStyle?o.transformStyle(y,e):e,((f=o.validate)===null||f===void 0||f)&&dd(this,c.z(e)))return!1;(e=c.bK(e)).layers=c.bI(e.layers);const T=c.bL(y,e),E=this._getOperationsToPerform(T);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const k of E.operations)k();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const o=[],f=[];for(const y of e)switch(y.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,y.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,y.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,y.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,y.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,y.args));break;case"addSource":o.push(()=>this.addSource.apply(this,y.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,y.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,y.args));break;case"setLight":o.push(()=>this.setLight.apply(this,y.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,y.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,y.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,y.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,y.args));break;case"setSky":o.push(()=>this.setSky.apply(this,y.args));break;case"setProjection":this.setProjection.apply(this,y.args);break;case"setGlobalState":o.push(()=>this.setGlobalState.apply(this,y.args));break;case"setTransition":o.push(()=>{});break;default:f.push(y.command)}return{operations:o,unimplemented:f}}addImage(e,o){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,o),this._afterImageUpdated(e)}updateImage(e,o){this.imageManager.updateImage(e,o)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,o,f={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(c.z.source,`sources.${e}`,o,null,f))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const y=this.sourceCaches[e]=new vn(e,o,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:e})),y.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${f}" is using it.`)));const o=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],o.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,o){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const f=this.sourceCaches[e].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(o),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,o,f={}){this._checkLoaded();const y=e.id;if(this.getLayer(y))return void this.fire(new c.k(new Error(`Layer "${y}" already exists on this map.`)));let T;if(e.type==="custom"){if(dd(this,c.bM(e)))return;T=c.bJ(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(y,e.source),e=c.bK(e),e=c.e(e,{source:y})),this._validate(c.z.layer,`layers.${y}`,e,{arrayIndex:-1},f))return;T=c.bJ(e,this._globalState),this._validateLayer(T),T.setEventedParent(this,{layer:{id:y}})}const E=o?this._order.indexOf(o):this._order.length;if(o&&E===-1)this.fire(new c.k(new Error(`Cannot add layer "${y}" before non-existing layer "${o}".`)));else{if(this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=T,this._removedLayers[y]&&T.source&&T.type!=="custom"){const k=this._removedLayers[y];delete this._removedLayers[y],k.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(e,o){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===o)return;const f=this._order.indexOf(e);this._order.splice(f,1);const y=o?this._order.indexOf(o):this._order.length;o&&y===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${o}".`))):(this._order.splice(y,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const o=this._layers[e];if(!o)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));o.setEventedParent(null);const f=this._order.indexOf(e);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=o,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],o.onRemove&&o.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,o,f){this._checkLoaded();const y=this.getLayer(e);y?y.minzoom===o&&y.maxzoom===f||(o!=null&&(y.minzoom=o),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,o,f={}){this._checkLoaded();const y=this.getLayer(e);if(y){if(!c.bH(y.filter,o))return o==null?(y.setFilter(void 0),void this._updateLayer(y)):void(this._validate(c.z.filter,`layers.${y.id}.filter`,o,null,f)||(y.setFilter(c.bK(o)),this._updateLayer(y)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bK(this.getLayer(e).filter)}setLayoutProperty(e,o,f,y={}){this._checkLoaded();const T=this.getLayer(e);T?c.bH(T.getLayoutProperty(o),f)||(T.setLayoutProperty(o,f,y),this._updateLayer(T)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,o){const f=this.getLayer(e);if(f)return f.getLayoutProperty(o);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,o,f,y={}){this._checkLoaded();const T=this.getLayer(e);T?c.bH(T.getPaintProperty(o),f)||this._updatePaintProperty(T,o,f,y):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,o,f,y={}){e.setPaintProperty(o,f,y)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,o){return this.getLayer(e).getPaintProperty(o)}setFeatureState(e,o){this._checkLoaded();const f=e.source,y=e.sourceLayer,T=this.sourceCaches[f];if(T===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const E=T.getSource().type;E==="geojson"&&y?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||y?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),T.setFeatureState(y,e.id,o)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,o){this._checkLoaded();const f=e.source,y=this.sourceCaches[f];if(y===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const T=y.getSource().type,E=T==="vector"?e.sourceLayer:void 0;T!=="vector"||E?o&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(E,e.id,o):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const o=e.source,f=e.sourceLayer,y=this.sourceCaches[o];if(y!==void 0)return y.getSource().type!=="vector"||f?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bN(this.sourceCaches,T=>T.serialize()),o=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,y=this.stylesheet;return c.bO({version:y.version,name:y.name,metadata:y.metadata,light:y.light,sky:y.sky,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,projection:y.projection,sources:e,layers:o,terrain:f},T=>T!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const o=E=>this._layers[E].type==="fill-extrusion",f={},y=[];for(let E=this._order.length-1;E>=0;E--){const k=this._order[E];if(o(k)){f[k]=E;for(const I of e){const O=I[k];if(O)for(const j of O)y.push(j)}}}y.sort((E,k)=>k.intersectionZ-E.intersectionZ);const T=[];for(let E=this._order.length-1;E>=0;E--){const k=this._order[E];if(o(k))for(let I=y.length-1;I>=0;I--){const O=y[I].feature;if(f[O.layer.id]<E)break;T.push(O),y.pop()}else for(const I of e){const O=I[k];if(O)for(const j of O)T.push(j.feature)}}return T}queryRenderedFeatures(e,o,f){o&&o.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",o.filter,null,o);const y={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const O of o.layers){const j=this._layers[O];if(!j)return this.fire(new c.k(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];y[j.source]=!0}}const T=[];o.availableImages=this._availableImages;const E=this._serializedAllLayers(),k=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,I=Object.assign(Object.assign({},o),{layers:k,globalState:this._globalState});for(const O in this.sourceCaches)o.layers&&!y[O]||T.push(mi(this.sourceCaches[O],this._layers,E,e,I,f,this.map.terrain?(j,Z,U)=>this.map.terrain.getElevation(j,Z,U):void 0));return this.placement&&T.push(function(O,j,Z,U,Y,Q,le){const oe={},ue=Q.queryRenderedSymbols(U),he=[];for(const ye of Object.keys(ue).map(Number))he.push(le[ye]);he.sort(ya);for(const ye of he){const me=ye.featureIndex.lookupSymbolFeatures(ue[ye.bucketInstanceId],j,ye.bucketIndex,ye.sourceLayerIndex,{filterSpec:Y.filter,globalState:Y.globalState},Y.layers,Y.availableImages,O);for(const xe in me){const Ee=oe[xe]=oe[xe]||[],ge=me[xe];ge.sort((De,qe)=>{const Le=ye.featureSortOrder;if(Le){const Oe=Le.indexOf(De.featureIndex);return Le.indexOf(qe.featureIndex)-Oe}return qe.featureIndex-De.featureIndex});for(const De of ge)Ee.push(De)}}return function(ye,me,xe){for(const Ee in ye)for(const ge of ye[Ee])sa(ge,xe[me[Ee].source]);return ye}(oe,O,Z)}(this._layers,E,this.sourceCaches,e,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(e,o){o?.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",o.filter,null,o);const f=this.sourceCaches[e];return f?function(y,T){const E=y.getRenderableIds().map(O=>y.getTileByID(O)),k=[],I={};for(let O=0;O<E.length;O++){const j=E[O],Z=j.tileID.canonical.key;I[Z]||(I[Z]=!0,j.querySourceFeatures(k,T))}return k}(f,o?Object.assign(Object.assign({},o),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,o={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const E in e)if(!c.bH(e[E],f[E])){y=!0;break}if(!y)return;const T={now:V.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,o),this.light.updateTransitions(T)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,o={}){this._checkLoaded();const f=this.getSky();let y=!1;if(!e&&!f)return;if(e&&!f)y=!0;else if(!e&&f)y=!0;else for(const E in e)if(!c.bH(e[E],f[E])){y=!0;break}if(!y)return;const T={now:V.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,o),this.sky.updateTransitions(T)}_setProjectionInternal(e){const o=function(f){if(Array.isArray(f)){const y=new Yl({type:f});return{projection:y,transform:new Wu,cameraHelper:new wf(y)}}switch(f){case"mercator":return{projection:new gn,transform:new Vn,cameraHelper:new Fi};case"globe":{const y=new Yl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:y,transform:new Wu,cameraHelper:new wf(y)}}case"vertical-perspective":return{projection:new $l,transform:new Xu,cameraHelper:new Zr};default:return c.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new gn,transform:new Vn,cameraHelper:new Fi}}}(e);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(e,o,f,y,T={}){return(!T||T.validate!==!1)&&dd(this,e.call(c.z,c.e({key:o,style:this.serialize(),value:f,styleSpec:c.v},y)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Oi().off(Ts,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const f=this.sourceCaches[o];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const o in this.sourceCaches)this.sourceCaches[o].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,o,f,y,T=!1){let E=!1,k=!1;const I={};for(const O of this._order){const j=this._layers[O];if(j.type!=="symbol")continue;if(!I[j.source]){const U=this.sourceCaches[j.source];I[j.source]=U.getRenderableIds(!0).map(Y=>U.getTileByID(Y)).sort((Y,Q)=>Q.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(Q.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(j,I[j.source],e.center.lng);E=E||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(V.now(),e.zoom))&&(this.pauseablePlacement=new Zu(e,this.map.terrain,this._order,T,o,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(V.now()),k=!0),E&&this.pauseablePlacement.placement.setStale()),k||E)for(const O of this._order){const j=this._layers[O];j.type==="symbol"&&this.placement.updateLayerOpacities(j,I[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(V.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,o){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const y=this.sourceCaches[o.source];return y&&y.setDependencies(o.tileID.key,o.type,o.icons),f})}getGlyphs(e,o){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(o.stacks),y=this.sourceCaches[o.source];return y&&y.setDependencies(o.tileID.key,o.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,o={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,o,f={},y){this._checkLoaded();const T=[{id:e,url:o}],E=[...rt(this.stylesheet.sprite),...T];this._validate(c.z.sprite,"sprite",E,null,f)||(this.stylesheet.sprite=E,this._loadSprite(T,!0,y))}removeSprite(e){this._checkLoaded();const o=rt(this.stylesheet.sprite);if(o.find(f=>f.id===e)){if(this._spritesImagesIds[e])for(const f of this._spritesImagesIds[e])this.imageManager.removeImage(f),this._changedImages[f]=!0;o.splice(o.findIndex(f=>f.id===e),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return rt(this.stylesheet.sprite)}setSprite(e,o={},f){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,o)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,f):(this._unloadSprite(),f&&f(null)))}}var Cg=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Dg{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,o,f,y,T,E,k,I,O){this.context=e;let j=this.boundPaintVertexBuffers.length!==y.length;for(let Z=0;!j&&Z<y.length;Z++)this.boundPaintVertexBuffers[Z]!==y[Z]&&(j=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==f||j||this.boundIndexBuffer!==T||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==O?this.freshBind(o,f,y,T,E,k,I,O):(e.bindVertexArray.set(this.vao),k&&k.bind(),T&&T.dynamicDraw&&T.bind(),I&&I.bind(),O&&O.bind())}freshBind(e,o,f,y,T,E,k,I){const O=e.numAttributes,j=this.context,Z=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=I,o.enableAttributes(Z,e);for(const U of f)U.enableAttributes(Z,e);E&&E.enableAttributes(Z,e),k&&k.enableAttributes(Z,e),I&&I.enableAttributes(Z,e),o.bind(),o.setVertexAttribPointers(Z,e,T);for(const U of f)U.bind(),U.setVertexAttribPointers(Z,e,T);E&&(E.bind(),E.setVertexAttribPointers(Z,e,T)),y&&y.bind(),k&&(k.bind(),k.setVertexAttribPointers(Z,e,T)),I&&(I.bind(),I.setVertexAttribPointers(Z,e,T)),j.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const fd=(b,e,o,f,y)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:e,u_fog_color:o?o.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:y?0:o?o.calculateFogBlendOpacity(f):0,u_horizon_color:o?o.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:y?1:0}),Sf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Wl(b){const e=[];for(let o=0;o<b.length;o++){if(b[o]===null)continue;const f=b[o].split(" ");e.push(f.pop())}return e}class Ef{constructor(e,o,f,y,T,E,k,I,O=[]){const j=e.gl;this.program=j.createProgram();const Z=Wl(o.staticAttributes),U=f?f.getBinderAttributes():[],Y=Z.concat(U),Q=Es.prelude.staticUniforms?Wl(Es.prelude.staticUniforms):[],le=k.staticUniforms?Wl(k.staticUniforms):[],oe=o.staticUniforms?Wl(o.staticUniforms):[],ue=f?f.getBinderUniforms():[],he=Q.concat(le).concat(oe).concat(ue),ye=[];for(const Le of he)ye.indexOf(Le)<0&&ye.push(Le);const me=f?f.defines():[];Gr(j)&&me.unshift("#version 300 es"),T&&me.push("#define OVERDRAW_INSPECTOR;"),E&&me.push("#define TERRAIN3D;"),I&&me.push(I),O&&me.push(...O);let xe=me.concat(Es.prelude.fragmentSource,k.fragmentSource,o.fragmentSource).join(`
`),Ee=me.concat(Es.prelude.vertexSource,k.vertexSource,o.vertexSource).join(`
`);Gr(j)||(xe=function(Le){return Le.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(xe),Ee=function(Le){return Le.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ee));const ge=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(ge,xe),j.compileShader(ge),!j.getShaderParameter(ge,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(ge)}`);j.attachShader(this.program,ge);const De=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(De,Ee),j.compileShader(De),!j.getShaderParameter(De,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(De)}`);j.attachShader(this.program,De),this.attributes={};const qe={};this.numAttributes=Y.length;for(let Le=0;Le<this.numAttributes;Le++)Y[Le]&&(j.bindAttribLocation(this.program,Le,Y[Le]),this.attributes[Y[Le]]=Le);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(De),j.deleteShader(ge);for(let Le=0;Le<ye.length;Le++){const Oe=ye[Le];if(Oe&&!qe[Oe]){const Ye=j.getUniformLocation(this.program,Oe);Ye&&(qe[Oe]=Ye)}}this.fixedUniforms=y(e,qe),this.terrainUniforms=((Le,Oe)=>({u_depth:new c.bP(Le,Oe.u_depth),u_terrain:new c.bP(Le,Oe.u_terrain),u_terrain_dim:new c.bg(Le,Oe.u_terrain_dim),u_terrain_matrix:new c.bR(Le,Oe.u_terrain_matrix),u_terrain_unpack:new c.bS(Le,Oe.u_terrain_unpack),u_terrain_exaggeration:new c.bg(Le,Oe.u_terrain_exaggeration)}))(e,qe),this.projectionUniforms=((Le,Oe)=>({u_projection_matrix:new c.bR(Le,Oe.u_projection_matrix),u_projection_tile_mercator_coords:new c.bS(Le,Oe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bS(Le,Oe.u_projection_clipping_plane),u_projection_transition:new c.bg(Le,Oe.u_projection_transition),u_projection_fallback_matrix:new c.bR(Le,Oe.u_projection_fallback_matrix)}))(e,qe),this.binderUniforms=f?f.getUniforms(e,qe):[]}draw(e,o,f,y,T,E,k,I,O,j,Z,U,Y,Q,le,oe,ue,he,ye){const me=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(f),e.setStencilMode(y),e.setColorMode(T),e.setCullFace(E),I){e.activeTexture.set(me.TEXTURE2),me.bindTexture(me.TEXTURE_2D,I.depthTexture),e.activeTexture.set(me.TEXTURE3),me.bindTexture(me.TEXTURE_2D,I.texture);for(const Ee in this.terrainUniforms)this.terrainUniforms[Ee].set(I[Ee])}if(O)for(const Ee in O)this.projectionUniforms[Sf[Ee]].set(O[Ee]);if(k)for(const Ee in this.fixedUniforms)this.fixedUniforms[Ee].set(k[Ee]);oe&&oe.setUniforms(e,this.binderUniforms,Q,{zoom:le});let xe=0;switch(o){case me.LINES:xe=2;break;case me.TRIANGLES:xe=3;break;case me.LINE_STRIP:xe=1}for(const Ee of Y.get()){const ge=Ee.vaos||(Ee.vaos={});(ge[j]||(ge[j]=new Dg)).bind(e,this,Z,oe?oe.getPaintVertexBuffers():[],U,Ee.vertexOffset,ue,he,ye),me.drawElements(o,Ee.primitiveLength*xe,me.UNSIGNED_SHORT,Ee.primitiveOffset*xe*2)}}}function Fc(b,e,o){const f=1/c.aC(o,1,e.transform.tileZoom),y=Math.pow(2,o.tileID.overscaledZ),T=o.tileSize*Math.pow(2,e.transform.tileZoom)/y,E=T*(o.tileID.canonical.x+o.tileID.wrap*y),k=T*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[f,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[E>>16,k>>16],u_pixel_coord_lower:[65535&E,65535&k]}}const ca=(b,e,o,f)=>{const y=b.style.light,T=y.properties.get("position"),E=[T.x,T.y,T.z],k=c.bV();y.properties.get("anchor")==="viewport"&&c.bW(k,b.transform.bearingInRadians),c.bX(E,E,k);const I=b.transform.transformLightDirection(E),O=y.properties.get("color");return{u_lightpos:E,u_lightpos_globe:I,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+e,u_opacity:o,u_fill_translate:f}},kg=(b,e,o,f,y,T,E)=>c.e(ca(b,e,o,f),Fc(T,b,E),{u_height_factor:-Math.pow(2,y.overscaledZ)/E.tileSize/8}),Qu=(b,e,o,f)=>c.e(Fc(e,b,o),{u_fill_translate:f}),Uc=(b,e)=>({u_world:b,u_fill_translate:e}),Vc=(b,e,o,f,y)=>c.e(Qu(b,e,o,y),{u_world:f}),Lp=(b,e,o,f,y)=>{const T=b.transform;let E,k,I=0;if(o.paint.get("circle-pitch-alignment")==="map"){const O=c.aC(e,1,T.zoom);E=!0,k=[O,O],I=O/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*y}else E=!1,k=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:k,u_globe_extrude_scale:I,u_translate:f}},Ku=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),Gc=b=>({u_viewport_size:[b.width,b.height]}),Ql=(b,e=1)=>({u_color:b,u_overlay:0,u_overlay_scale:e}),Op=(b,e,o,f)=>{const y=c.aC(b,1,e)/(c.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:c.aC(b,1,e),u_intensity:o,u_globe_extrude_scale:y}},Af=(b,e,o,f)=>{const y=c.L();c.bY(y,0,b.width,b.height,0,0,1);const T=b.context.gl;return{u_matrix:y,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:o,u_color_ramp:f,u_opacity:e.paint.get("heatmap-opacity")}},jp=(b,e,o)=>{const f=o.paint.get("hillshade-accent-color");let y;switch(o.paint.get("hillshade-method")){case"basic":y=4;break;case"combined":y=1;break;case"igor":y=2;break;case"multidirectional":y=3;break;default:y=0}const T=o.getIlluminationProperties();for(let E=0;E<T.directionRadians.length;E++)o.paint.get("hillshade-illumination-anchor")==="viewport"&&(T.directionRadians[E]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:Kl(0,e.tileID),u_exaggeration:o.paint.get("hillshade-exaggeration"),u_altitudes:T.altitudeRadians,u_azimuths:T.directionRadians,u_accent:f,u_method:y,u_highlights:T.highlightColor,u_shadows:T.shadowColor}},Mf=(b,e)=>{const o=e.stride,f=c.L();return c.bY(f,0,c.$,-c.$,0,0,1),c.M(f,f,[0,-c.$,0]),{u_matrix:f,u_image:1,u_dimension:[o,o],u_zoom:b.overscaledZ,u_unpack:e.getUnpackVector()}};function Kl(b,e){const o=Math.pow(2,e.canonical.z),f=e.canonical.y;return[new c.a1(0,f/o).toLngLat().lat,new c.a1(0,(f+1)/o).toLngLat().lat]}const Zc=(b,e,o=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:o,u_opacity:b.paint.get("color-relief-opacity")}),pd=(b,e,o,f)=>{const y=b.transform;return{u_translation:th(b,e,o),u_ratio:f/c.aC(e,1,y.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Ju=(b,e,o,f,y)=>c.e(pd(b,e,o,f),{u_image:0,u_image_height:y}),Cf=(b,e,o,f,y)=>{const T=b.transform,E=eh(e,T);return{u_translation:th(b,e,o),u_texsize:e.imageAtlasTexture.size,u_ratio:f/c.aC(e,1,T.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[E,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},dl=(b,e,o,f,y,T)=>{const E=b.lineAtlas,k=eh(e,b.transform),I=o.layout.get("line-cap")==="round",O=E.getDash(y.from,I),j=E.getDash(y.to,I),Z=O.width*T.fromScale,U=j.width*T.toScale;return c.e(pd(b,e,o,f),{u_patternscale_a:[k/Z,-O.height/2],u_patternscale_b:[k/U,-j.height/2],u_sdfgamma:E.width/(256*Math.min(Z,U)*b.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:j.y,u_mix:T.t})};function eh(b,e){return 1/c.aC(b,1,e.tileZoom)}function th(b,e,o){return c.aD(b.transform,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const $c=(b,e,o,f,y)=>{return{u_tl_parent:b,u_scale_parent:e,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(E=f.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(T=f.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Bp(f.paint.get("raster-hue-rotate")),u_coords_top:[y[0].x,y[0].y,y[1].x,y[1].y],u_coords_bottom:[y[3].x,y[3].y,y[2].x,y[2].y]};var T,E};function Bp(b){b*=Math.PI/180;const e=Math.sin(b),o=Math.cos(b);return[(2*o+1)/3,(-Math.sqrt(3)*e-o+1)/3,(Math.sqrt(3)*e-o+1)/3]}const Yc=(b,e,o,f,y,T,E,k,I,O,j,Z,U)=>{const Y=E.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Y.width/Y.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:k,u_coord_matrix:I,u_is_text:+j,u_pitch_with_map:+f,u_is_along_line:y,u_is_variable_anchor:T,u_texsize:Z,u_texture:0,u_translation:O,u_pitched_scale:U}},Fp=(b,e,o,f,y,T,E,k,I,O,j,Z,U,Y)=>{const Q=E.transform;return c.e(Yc(b,e,o,f,y,T,E,k,I,O,j,Z,Y),{u_gamma_scale:f?Math.cos(Q.pitch*Math.PI/180)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Rg=(b,e,o,f,y,T,E,k,I,O,j,Z,U)=>c.e(Fp(b,e,o,f,y,T,E,k,I,O,!0,j,0,U),{u_texsize_icon:Z,u_texture_icon:1}),Up=(b,e)=>({u_opacity:b,u_color:e}),Vp=(b,e,o,f,y)=>c.e(function(T,E,k,I){const O=k.imageManager.getPattern(T.from.toString()),j=k.imageManager.getPattern(T.to.toString()),{width:Z,height:U}=k.imageManager.getPixelSize(),Y=Math.pow(2,I.tileID.overscaledZ),Q=I.tileSize*Math.pow(2,k.transform.tileZoom)/Y,le=Q*(I.tileID.canonical.x+I.tileID.wrap*Y),oe=Q*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[Z,U],u_mix:E.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/c.aC(I,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,oe>>16],u_pixel_coord_lower:[65535&le,65535&oe]}}(o,y,e,f),{u_opacity:b}),Df=(b,e)=>{},ua={fillExtrusion:(b,e)=>({u_lightpos:new c.bT(b,e.u_lightpos),u_lightpos_globe:new c.bT(b,e.u_lightpos_globe),u_lightintensity:new c.bg(b,e.u_lightintensity),u_lightcolor:new c.bT(b,e.u_lightcolor),u_vertical_gradient:new c.bg(b,e.u_vertical_gradient),u_opacity:new c.bg(b,e.u_opacity),u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillExtrusionPattern:(b,e)=>({u_lightpos:new c.bT(b,e.u_lightpos),u_lightpos_globe:new c.bT(b,e.u_lightpos_globe),u_lightintensity:new c.bg(b,e.u_lightintensity),u_lightcolor:new c.bT(b,e.u_lightcolor),u_vertical_gradient:new c.bg(b,e.u_vertical_gradient),u_height_factor:new c.bg(b,e.u_height_factor),u_opacity:new c.bg(b,e.u_opacity),u_fill_translate:new c.bU(b,e.u_fill_translate),u_image:new c.bP(b,e.u_image),u_texsize:new c.bU(b,e.u_texsize),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade)}),fill:(b,e)=>({u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillPattern:(b,e)=>({u_image:new c.bP(b,e.u_image),u_texsize:new c.bU(b,e.u_texsize),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade),u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillOutline:(b,e)=>({u_world:new c.bU(b,e.u_world),u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillOutlinePattern:(b,e)=>({u_world:new c.bU(b,e.u_world),u_image:new c.bP(b,e.u_image),u_texsize:new c.bU(b,e.u_texsize),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade),u_fill_translate:new c.bU(b,e.u_fill_translate)}),circle:(b,e)=>({u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_scale_with_map:new c.bP(b,e.u_scale_with_map),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_extrude_scale:new c.bU(b,e.u_extrude_scale),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(b,e.u_globe_extrude_scale),u_translate:new c.bU(b,e.u_translate)}),collisionBox:(b,e)=>({u_pixel_extrude_scale:new c.bU(b,e.u_pixel_extrude_scale)}),collisionCircle:(b,e)=>({u_viewport_size:new c.bU(b,e.u_viewport_size)}),debug:(b,e)=>({u_color:new c.bQ(b,e.u_color),u_overlay:new c.bP(b,e.u_overlay),u_overlay_scale:new c.bg(b,e.u_overlay_scale)}),depth:Df,clippingMask:Df,heatmap:(b,e)=>({u_extrude_scale:new c.bg(b,e.u_extrude_scale),u_intensity:new c.bg(b,e.u_intensity),u_globe_extrude_scale:new c.bg(b,e.u_globe_extrude_scale)}),heatmapTexture:(b,e)=>({u_matrix:new c.bR(b,e.u_matrix),u_world:new c.bU(b,e.u_world),u_image:new c.bP(b,e.u_image),u_color_ramp:new c.bP(b,e.u_color_ramp),u_opacity:new c.bg(b,e.u_opacity)}),hillshade:(b,e)=>({u_image:new c.bP(b,e.u_image),u_latrange:new c.bU(b,e.u_latrange),u_exaggeration:new c.bg(b,e.u_exaggeration),u_altitudes:new c.b_(b,e.u_altitudes),u_azimuths:new c.b_(b,e.u_azimuths),u_accent:new c.bQ(b,e.u_accent),u_method:new c.bP(b,e.u_method),u_shadows:new c.bZ(b,e.u_shadows),u_highlights:new c.bZ(b,e.u_highlights)}),hillshadePrepare:(b,e)=>({u_matrix:new c.bR(b,e.u_matrix),u_image:new c.bP(b,e.u_image),u_dimension:new c.bU(b,e.u_dimension),u_zoom:new c.bg(b,e.u_zoom),u_unpack:new c.bS(b,e.u_unpack)}),colorRelief:(b,e)=>({u_image:new c.bP(b,e.u_image),u_unpack:new c.bS(b,e.u_unpack),u_dimension:new c.bU(b,e.u_dimension),u_elevation_stops:new c.bP(b,e.u_elevation_stops),u_color_stops:new c.bP(b,e.u_color_stops),u_color_ramp_size:new c.bP(b,e.u_color_ramp_size),u_opacity:new c.bg(b,e.u_opacity)}),line:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels)}),lineGradient:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels),u_image:new c.bP(b,e.u_image),u_image_height:new c.bg(b,e.u_image_height)}),linePattern:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_texsize:new c.bU(b,e.u_texsize),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_image:new c.bP(b,e.u_image),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade)}),lineSDF:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels),u_patternscale_a:new c.bU(b,e.u_patternscale_a),u_patternscale_b:new c.bU(b,e.u_patternscale_b),u_sdfgamma:new c.bg(b,e.u_sdfgamma),u_image:new c.bP(b,e.u_image),u_tex_y_a:new c.bg(b,e.u_tex_y_a),u_tex_y_b:new c.bg(b,e.u_tex_y_b),u_mix:new c.bg(b,e.u_mix)}),raster:(b,e)=>({u_tl_parent:new c.bU(b,e.u_tl_parent),u_scale_parent:new c.bg(b,e.u_scale_parent),u_buffer_scale:new c.bg(b,e.u_buffer_scale),u_fade_t:new c.bg(b,e.u_fade_t),u_opacity:new c.bg(b,e.u_opacity),u_image0:new c.bP(b,e.u_image0),u_image1:new c.bP(b,e.u_image1),u_brightness_low:new c.bg(b,e.u_brightness_low),u_brightness_high:new c.bg(b,e.u_brightness_high),u_saturation_factor:new c.bg(b,e.u_saturation_factor),u_contrast_factor:new c.bg(b,e.u_contrast_factor),u_spin_weights:new c.bT(b,e.u_spin_weights),u_coords_top:new c.bS(b,e.u_coords_top),u_coords_bottom:new c.bS(b,e.u_coords_bottom)}),symbolIcon:(b,e)=>({u_is_size_zoom_constant:new c.bP(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(b,e.u_is_size_feature_constant),u_size_t:new c.bg(b,e.u_size_t),u_size:new c.bg(b,e.u_size),u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_pitch:new c.bg(b,e.u_pitch),u_rotate_symbol:new c.bP(b,e.u_rotate_symbol),u_aspect_ratio:new c.bg(b,e.u_aspect_ratio),u_fade_change:new c.bg(b,e.u_fade_change),u_label_plane_matrix:new c.bR(b,e.u_label_plane_matrix),u_coord_matrix:new c.bR(b,e.u_coord_matrix),u_is_text:new c.bP(b,e.u_is_text),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_is_along_line:new c.bP(b,e.u_is_along_line),u_is_variable_anchor:new c.bP(b,e.u_is_variable_anchor),u_texsize:new c.bU(b,e.u_texsize),u_texture:new c.bP(b,e.u_texture),u_translation:new c.bU(b,e.u_translation),u_pitched_scale:new c.bg(b,e.u_pitched_scale)}),symbolSDF:(b,e)=>({u_is_size_zoom_constant:new c.bP(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(b,e.u_is_size_feature_constant),u_size_t:new c.bg(b,e.u_size_t),u_size:new c.bg(b,e.u_size),u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_pitch:new c.bg(b,e.u_pitch),u_rotate_symbol:new c.bP(b,e.u_rotate_symbol),u_aspect_ratio:new c.bg(b,e.u_aspect_ratio),u_fade_change:new c.bg(b,e.u_fade_change),u_label_plane_matrix:new c.bR(b,e.u_label_plane_matrix),u_coord_matrix:new c.bR(b,e.u_coord_matrix),u_is_text:new c.bP(b,e.u_is_text),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_is_along_line:new c.bP(b,e.u_is_along_line),u_is_variable_anchor:new c.bP(b,e.u_is_variable_anchor),u_texsize:new c.bU(b,e.u_texsize),u_texture:new c.bP(b,e.u_texture),u_gamma_scale:new c.bg(b,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_is_halo:new c.bP(b,e.u_is_halo),u_translation:new c.bU(b,e.u_translation),u_pitched_scale:new c.bg(b,e.u_pitched_scale)}),symbolTextAndIcon:(b,e)=>({u_is_size_zoom_constant:new c.bP(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(b,e.u_is_size_feature_constant),u_size_t:new c.bg(b,e.u_size_t),u_size:new c.bg(b,e.u_size),u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_pitch:new c.bg(b,e.u_pitch),u_rotate_symbol:new c.bP(b,e.u_rotate_symbol),u_aspect_ratio:new c.bg(b,e.u_aspect_ratio),u_fade_change:new c.bg(b,e.u_fade_change),u_label_plane_matrix:new c.bR(b,e.u_label_plane_matrix),u_coord_matrix:new c.bR(b,e.u_coord_matrix),u_is_text:new c.bP(b,e.u_is_text),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_is_along_line:new c.bP(b,e.u_is_along_line),u_is_variable_anchor:new c.bP(b,e.u_is_variable_anchor),u_texsize:new c.bU(b,e.u_texsize),u_texsize_icon:new c.bU(b,e.u_texsize_icon),u_texture:new c.bP(b,e.u_texture),u_texture_icon:new c.bP(b,e.u_texture_icon),u_gamma_scale:new c.bg(b,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_is_halo:new c.bP(b,e.u_is_halo),u_translation:new c.bU(b,e.u_translation),u_pitched_scale:new c.bg(b,e.u_pitched_scale)}),background:(b,e)=>({u_opacity:new c.bg(b,e.u_opacity),u_color:new c.bQ(b,e.u_color)}),backgroundPattern:(b,e)=>({u_opacity:new c.bg(b,e.u_opacity),u_image:new c.bP(b,e.u_image),u_pattern_tl_a:new c.bU(b,e.u_pattern_tl_a),u_pattern_br_a:new c.bU(b,e.u_pattern_br_a),u_pattern_tl_b:new c.bU(b,e.u_pattern_tl_b),u_pattern_br_b:new c.bU(b,e.u_pattern_br_b),u_texsize:new c.bU(b,e.u_texsize),u_mix:new c.bg(b,e.u_mix),u_pattern_size_a:new c.bU(b,e.u_pattern_size_a),u_pattern_size_b:new c.bU(b,e.u_pattern_size_b),u_scale_a:new c.bg(b,e.u_scale_a),u_scale_b:new c.bg(b,e.u_scale_b),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(b,e.u_tile_units_to_pixels)}),terrain:(b,e)=>({u_texture:new c.bP(b,e.u_texture),u_ele_delta:new c.bg(b,e.u_ele_delta),u_fog_matrix:new c.bR(b,e.u_fog_matrix),u_fog_color:new c.bQ(b,e.u_fog_color),u_fog_ground_blend:new c.bg(b,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(b,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bQ(b,e.u_horizon_color),u_horizon_fog_blend:new c.bg(b,e.u_horizon_fog_blend),u_is_globe_mode:new c.bg(b,e.u_is_globe_mode)}),terrainDepth:(b,e)=>({u_ele_delta:new c.bg(b,e.u_ele_delta)}),terrainCoords:(b,e)=>({u_texture:new c.bP(b,e.u_texture),u_terrain_coords_id:new c.bg(b,e.u_terrain_coords_id),u_ele_delta:new c.bg(b,e.u_ele_delta)}),projectionErrorMeasurement:(b,e)=>({u_input:new c.bg(b,e.u_input),u_output_expected:new c.bg(b,e.u_output_expected)}),atmosphere:(b,e)=>({u_sun_pos:new c.bT(b,e.u_sun_pos),u_atmosphere_blend:new c.bg(b,e.u_atmosphere_blend),u_globe_position:new c.bT(b,e.u_globe_position),u_globe_radius:new c.bg(b,e.u_globe_radius),u_inv_proj_matrix:new c.bR(b,e.u_inv_proj_matrix)}),sky:(b,e)=>({u_sky_color:new c.bQ(b,e.u_sky_color),u_horizon_color:new c.bQ(b,e.u_horizon_color),u_horizon:new c.bU(b,e.u_horizon),u_horizon_normal:new c.bU(b,e.u_horizon_normal),u_sky_horizon_blend:new c.bg(b,e.u_sky_horizon_blend),u_sky_blend:new c.bg(b,e.u_sky_blend)})};class qc{constructor(e,o,f){this.context=e;const y=e.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const nh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fo{constructor(e,o,f,y){this.length=o.length,this.attributes=f,this.itemSize=o.bytesPerElement,this.dynamicDraw=y,this.context=e;const T=e.gl;this.buffer=T.createBuffer(),e.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,o){for(let f=0;f<this.attributes.length;f++){const y=o.attributes[this.attributes[f].name];y!==void 0&&e.enableVertexAttribArray(y)}}setVertexAttribPointers(e,o,f){for(let y=0;y<this.attributes.length;y++){const T=this.attributes[y],E=o.attributes[T.name];E!==void 0&&e.vertexAttribPointer(E,T.components,e[nh[T.type]],!1,this.itemSize,T.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class md extends zn{getDefault(){return c.bf.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ih extends zn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Gp extends zn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class fl extends zn{getDefault(){return[!0,!0,!0,!0]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Lo extends zn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Jl extends zn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class kf extends zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const o=this.current;(e.func!==o.func||e.ref!==o.ref||e.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Zp extends zn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class ec extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=e,this.dirty=!1}}class Hc extends zn{getDefault(){return[0,1]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class gd extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=e,this.dirty=!1}}class $p extends zn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class pl extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.BLEND):o.disable(o.BLEND),this.current=e,this.dirty=!1}}class rh extends zn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class ah extends zn{getDefault(){return c.bf.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class sh extends zn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Rf extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=e,this.dirty=!1}}class tc extends zn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class oh extends zn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class nc extends zn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Pa extends zn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class yd extends zn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ns extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class _d extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Sr extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ha extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Oo extends zn{getDefault(){return null}set(e){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ic extends zn{getDefault(){return null}set(e){var o;if(e===this.current&&!this.dirty)return;const f=this.gl;Gr(f)?f.bindVertexArray(e):(o=f.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class rc extends zn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class lh extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ml extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Na extends zn{constructor(e,o){super(e),this.context=e,this.parent=o}getDefault(){return null}}class If extends Na{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Xc extends Na{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class pn extends Na{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const ch="Framebuffer is not complete";class za{constructor(e,o,f,y,T){this.context=e,this.width=o,this.height=f;const E=e.gl,k=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new If(e,k),y)this.depthAttachment=T?new pn(e,k):new Xc(e,k);else if(T)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(ch)}destroy(){const e=this.context.gl,o=this.colorAttachment.get();if(o&&e.deleteTexture(o),this.depthAttachment){const f=this.depthAttachment.get();f&&e.deleteRenderbuffer(f)}e.deleteFramebuffer(this.framebuffer)}}class vd{constructor(e){var o,f;if(this.gl=e,this.clearColor=new md(this),this.clearDepth=new ih(this),this.clearStencil=new Gp(this),this.colorMask=new fl(this),this.depthMask=new Lo(this),this.stencilMask=new Jl(this),this.stencilFunc=new kf(this),this.stencilOp=new Zp(this),this.stencilTest=new ec(this),this.depthRange=new Hc(this),this.depthTest=new gd(this),this.depthFunc=new $p(this),this.blend=new pl(this),this.blendFunc=new rh(this),this.blendColor=new ah(this),this.blendEquation=new sh(this),this.cullFace=new Rf(this),this.cullFaceSide=new tc(this),this.frontFace=new oh(this),this.program=new nc(this),this.activeTexture=new Pa(this),this.viewport=new yd(this),this.bindFramebuffer=new ns(this),this.bindRenderbuffer=new _d(this),this.bindTexture=new Sr(this),this.bindVertexBuffer=new ha(this),this.bindElementBuffer=new Oo(this),this.bindVertexArray=new ic(this),this.pixelStoreUnpack=new rc(this),this.pixelStoreUnpackPremultiplyAlpha=new lh(this),this.pixelStoreUnpackFlipY=new ml(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Gr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const y=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=e.RGBA16F)!==null&&o!==void 0?o:y?.RGBA16F_EXT,this.RGB16F=(f=e.RGB16F)!==null&&f!==void 0?f:y?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const y=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=y?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,o){return new qc(this,e,o)}createVertexBuffer(e,o,f){return new fo(this,e,o,f)}createRenderbuffer(e,o,f){const y=this.gl,T=y.createRenderbuffer();return this.bindRenderbuffer.set(T),y.renderbufferStorage(y.RENDERBUFFER,e,o,f),this.bindRenderbuffer.set(null),T}createFramebuffer(e,o,f,y){return new za(this,e,o,f,y)}clear({color:e,depth:o,stencil:f}){const y=this.gl;let T=0;e&&(T|=y.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(T|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),f!==void 0&&(T|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),y.clear(T)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bH(e.blendFunction,si.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Gr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var o;return Gr(this.gl)?this.gl.deleteVertexArray(e):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let $r;function Pf(b,e,o,f,y){const T=b.context,E=b.transform,k=T.gl,I=b.useProgram("collisionBox"),O=[];let j=0,Z=0;for(let ue=0;ue<f.length;ue++){const he=f[ue],ye=e.getTile(he).getBucket(o);if(!ye)continue;const me=y?ye.textCollisionBox:ye.iconCollisionBox,xe=ye.collisionCircleArray;xe.length>0&&(O.push({circleArray:xe,circleOffset:Z,coord:he}),j+=xe.length/4,Z=j),me&&I.draw(T,k.LINES,nn.disabled,Mn.disabled,b.colorModeForRenderPass(),qt.disabled,Ku(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(he),E.getProjectionData({overscaledTileID:he,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,null,b.transform.zoom,null,null,me.collisionVertexBuffer)}if(!y||!O.length)return;const U=b.useProgram("collisionCircle"),Y=new c.b$;Y.resize(4*j),Y._trim();let Q=0;for(const ue of O)for(let he=0;he<ue.circleArray.length/4;he++){const ye=4*he,me=ue.circleArray[ye+0],xe=ue.circleArray[ye+1],Ee=ue.circleArray[ye+2],ge=ue.circleArray[ye+3];Y.emplace(Q++,me,xe,Ee,ge,0),Y.emplace(Q++,me,xe,Ee,ge,1),Y.emplace(Q++,me,xe,Ee,ge,2),Y.emplace(Q++,me,xe,Ee,ge,3)}(!$r||$r.length<2*j)&&($r=function(ue){const he=2*ue,ye=new c.c1;ye.resize(he),ye._trim();for(let me=0;me<he;me++){const xe=6*me;ye.uint16[xe+0]=4*me+0,ye.uint16[xe+1]=4*me+1,ye.uint16[xe+2]=4*me+2,ye.uint16[xe+3]=4*me+2,ye.uint16[xe+4]=4*me+3,ye.uint16[xe+5]=4*me+0}return ye}(j));const le=T.createIndexBuffer($r,!0),oe=T.createVertexBuffer(Y,c.c0.members,!0);for(const ue of O){const he=Gc(b.transform);U.draw(T,k.TRIANGLES,nn.disabled,Mn.disabled,b.colorModeForRenderPass(),qt.disabled,he,b.style.map.terrain&&b.style.map.terrain.getTerrainData(ue.coord),null,o.id,oe,le,c.aM.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,b.transform.zoom,null,null,null)}oe.destroy(),le.destroy()}const bd=c.ag(new Float32Array(16));function gl(b,e,o,f,y,T){const{horizontalAlign:E,verticalAlign:k}=c.aH(b);return new c.P((-(E-.5)*e/y+f[0])*T,(-(k-.5)*o/y+f[1])*T)}function Nf(b,e,o,f,y,T){const E=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let k=f.mult(T);o||(k=k.rotate(-y));const I=E.add(k);return Ti(I.x,I.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(o){const k=Xi(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(b),I=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return b.add(f.rotate(I))}return b.add(f)}function uh(b,e,o,f,y,T,E,k,I,O,j,Z){const U=b.text.placedSymbolArray,Y=b.text.dynamicLayoutVertexArray,Q=b.icon.dynamicLayoutVertexArray,le={};Y.clear();for(let oe=0;oe<U.length;oe++){const ue=U.get(oe),he=ue.hidden||!ue.crossTileID||b.allowVerticalPlacement&&!ue.placedOrientation?null:f[ue.crossTileID];if(he){const ye=new c.P(ue.anchorX,ue.anchorY),me={getElevation:Z,width:y.width,height:y.height,pitchedLabelPlaneMatrix:T,pitchWithMap:o,transform:y,tileAnchorPoint:ye,translation:O,unwrappedTileID:j},xe=o?Si(ye.x,ye.y,me):Xi(ye.x,ye.y,me),Ee=gt(y.cameraToCenterDistance,xe.signedDistanceFromCamera);let ge=c.ap(b.textSizeData,k,ue)*Ee/c.aB;o&&(ge*=b.tilePixelRatio/E);const{width:De,height:qe,anchor:Le,textOffset:Oe,textBoxScale:Ye}=he,vt=gl(Le,De,qe,Oe,Ye,ge),pt=y.getPitchedTextCorrection(ye.x+O[0],ye.y+O[1],j),ot=Nf(xe.point,me,e,vt,-y.bearingInRadians,pt),Ot=b.allowVerticalPlacement&&ue.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let mn=0;mn<ue.numGlyphs;mn++)c.av(Y,ot,Ot);I&&ue.associatedIconIndex>=0&&(le[ue.associatedIconIndex]={shiftedAnchor:ot,angle:Ot})}else ro(ue.numGlyphs,Y)}if(I){Q.clear();const oe=b.icon.placedSymbolArray;for(let ue=0;ue<oe.length;ue++){const he=oe.get(ue);if(he.hidden)ro(he.numGlyphs,Q);else{const ye=le[ue];if(ye)for(let me=0;me<he.numGlyphs;me++)c.av(Q,ye.shiftedAnchor,ye.angle);else ro(he.numGlyphs,Q)}}b.icon.dynamicLayoutVertexBuffer.updateData(Q)}b.text.dynamicLayoutVertexBuffer.updateData(Y)}function jo(b,e,o){return o.iconsInText&&e?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function po(b,e,o,f,y,T,E,k,I,O,j,Z,U){const Y=b.context,Q=Y.gl,le=b.transform,oe=k==="map",ue=I==="map",he=k!=="viewport"&&o.layout.get("symbol-placement")!=="point",ye=oe&&!ue&&!he,me=!o.layout.get("symbol-sort-key").isConstant();let xe=!1;const Ee=b.getDepthModeForSublayer(0,nn.ReadOnly),ge=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),De=[],qe=le.getCircleRadiusCorrection();for(const Le of f){const Oe=e.getTile(Le),Ye=Oe.getBucket(o);if(!Ye)continue;const vt=y?Ye.text:Ye.icon;if(!vt||!vt.segments.get().length||!vt.hasVisibleVertices)continue;const pt=vt.programConfigurations.get(o.id),ot=y||Ye.sdfIcons,Ot=y?Ye.textSizeData:Ye.iconSizeData,mn=ue||le.pitch!==0,Rn=b.useProgram(jo(ot,y,Ye),pt),Mi=c.an(Ot,le.zoom),Fn=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Le);let _i,Ci,oi,on,cr=[0,0],$i=null;if(y)Ci=Oe.glyphAtlasTexture,oi=Q.LINEAR,_i=Oe.glyphAtlasTexture.size,Ye.iconsInText&&(cr=Oe.imageAtlasTexture.size,$i=Oe.imageAtlasTexture,on=mn||b.options.rotating||b.options.zooming||Ot.kind==="composite"||Ot.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const ui=o.layout.get("icon-size").constantOr(0)!==1||Ye.iconsNeedLinear;Ci=Oe.imageAtlasTexture,oi=ot||b.options.rotating||b.options.zooming||ui||mn?Q.LINEAR:Q.NEAREST,_i=Oe.imageAtlasTexture.size}const mr=c.aC(Oe,1,b.transform.zoom),fa=ai(oe,b.transform,mr),Sl=c.L();c.aq(Sl,fa);const ls=Wt(ue,oe,b.transform,mr),cs=c.aD(le,Oe,T,E),Xo=le.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),hc=ge&&Ye.hasTextData(),dc=o.layout.get("icon-text-fit")!=="none"&&hc&&Ye.hasIconData();if(he){const ui=b.style.map.terrain?(Kr,Yi)=>b.style.map.terrain.getElevation(Le,Kr,Yi):null,Ui=o.layout.get("text-rotation-alignment")==="map";ji(Ye,b,y,fa,Sl,ue,O,Ui,Le.toUnwrapped(),le.width,le.height,cs,ui)}const yo=y&&ge||dc,Qr=he||yo?bd:ue?fa:b.transform.clipSpaceToPixelsMatrix,Ps=ot&&o.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ns;Ns=ot?Ye.iconsInText?Rg(Ot.kind,Mi,ye,ue,he,yo,b,Qr,ls,cs,_i,cr,qe):Fp(Ot.kind,Mi,ye,ue,he,yo,b,Qr,ls,cs,y,_i,0,qe):Yc(Ot.kind,Mi,ye,ue,he,yo,b,Qr,ls,cs,y,_i,qe);const Ga={program:Rn,buffers:vt,uniformValues:Ns,projectionData:Xo,atlasTexture:Ci,atlasTextureIcon:$i,atlasInterpolation:oi,atlasInterpolationIcon:on,isSDF:ot,hasHalo:Ps};if(me&&Ye.canOverlap){xe=!0;const ui=vt.segments.get();for(const Ui of ui)De.push({segments:new c.aM([Ui]),sortKey:Ui.sortKey,state:Ga,terrainData:Fn})}else De.push({segments:vt.segments,sortKey:0,state:Ga,terrainData:Fn})}xe&&De.sort((Le,Oe)=>Le.sortKey-Oe.sortKey);for(const Le of De){const Oe=Le.state;if(Y.activeTexture.set(Q.TEXTURE0),Oe.atlasTexture.bind(Oe.atlasInterpolation,Q.CLAMP_TO_EDGE),Oe.atlasTextureIcon&&(Y.activeTexture.set(Q.TEXTURE1),Oe.atlasTextureIcon&&Oe.atlasTextureIcon.bind(Oe.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Oe.isSDF){const Ye=Oe.uniformValues;Oe.hasHalo&&(Ye.u_is_halo=1,yl(Oe.buffers,Le.segments,o,b,Oe.program,Ee,j,Z,Ye,Oe.projectionData,Le.terrainData)),Ye.u_is_halo=0}yl(Oe.buffers,Le.segments,o,b,Oe.program,Ee,j,Z,Oe.uniformValues,Oe.projectionData,Le.terrainData)}}function yl(b,e,o,f,y,T,E,k,I,O,j){const Z=f.context;y.draw(Z,Z.gl.TRIANGLES,T,E,k,qt.backCCW,I,j,O,o.id,b.layoutVertexBuffer,b.indexBuffer,e,o.paint,f.transform.zoom,b.programConfigurations.get(o.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function Wc(b,e,o,f,y){const T=b.context,E=T.gl,k=Mn.disabled,I=new si([E.ONE,E.ONE],c.bf.transparent,[!0,!0,!0,!0]),O=e.getBucket(o);if(!O)return;const j=f.key;let Z=o.heatmapFbos.get(j);Z||(Z=Yr(T,e.tileSize,e.tileSize),o.heatmapFbos.set(j,Z)),T.bindFramebuffer.set(Z.framebuffer),T.viewport.set([0,0,e.tileSize,e.tileSize]),T.clear({color:c.bf.transparent});const U=O.programConfigurations.get(o.id),Y=b.useProgram("heatmap",U,!y),Q=b.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),le=b.style.map.terrain.getTerrainData(f);Y.draw(T,E.TRIANGLES,nn.disabled,k,I,qt.disabled,Op(e,b.transform.zoom,o.paint.get("heatmap-intensity"),1),le,Q,o.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,o.paint,b.transform.zoom,U)}function La(b,e,o,f,y){const T=b.context,E=T.gl,k=b.transform;T.setColorMode(b.colorModeForRenderPass());const I=Ms(T,e),O=o.key,j=e.heatmapFbos.get(O);if(!j)return;T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,j.colorAttachment.get()),T.activeTexture.set(E.TEXTURE1),I.bind(E.LINEAR,E.CLAMP_TO_EDGE);const Z=k.getProjectionData({overscaledTileID:o,applyTerrainMatrix:y,applyGlobeMatrix:!f});b.useProgram("heatmapTexture").draw(T,E.TRIANGLES,nn.disabled,Mn.disabled,b.colorModeForRenderPass(),qt.disabled,Af(b,e,0,1),null,Z,e.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,e.paint,k.zoom),j.destroy(),e.heatmapFbos.delete(O)}function Yr(b,e,o){var f,y;const T=b.gl,E=T.createTexture();T.bindTexture(T.TEXTURE_2D,E),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const k=(f=b.HALF_FLOAT)!==null&&f!==void 0?f:T.UNSIGNED_BYTE,I=(y=b.RGBA16F)!==null&&y!==void 0?y:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,I,e,o,0,T.RGBA,k,null);const O=b.createFramebuffer(e,o,!1,!1);return O.colorAttachment.set(E),O}function Ms(b,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(b,e.colorRamp,b.gl.RGBA)),e.colorRampTexture}function Oa(b,e,o,f,y){if(!o||!f||!f.imageAtlas)return;const T=f.imageAtlas.patternPositions;let E=T[o.to.toString()],k=T[o.from.toString()];if(!E&&k&&(E=k),!k&&E&&(k=E),!E||!k){const I=y.getPaintProperty(e);E=T[I],k=T[I]}E&&k&&b.setConstantPatternPositions(E,k)}function is(b,e,o,f,y,T,E,k){const I=b.context.gl,O="fill-pattern",j=o.paint.get(O),Z=j&&j.constantOr(1),U=o.getCrossfadeParameters();let Y,Q,le,oe,ue;const he=b.transform,ye=o.paint.get("fill-translate"),me=o.paint.get("fill-translate-anchor");E?(Q=Z&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=I.LINES):(Q=Z?"fillPattern":"fill",Y=I.TRIANGLES);const xe=j.constantOr(null);for(const Ee of f){const ge=e.getTile(Ee);if(Z&&!ge.patternsLoaded())continue;const De=ge.getBucket(o);if(!De)continue;const qe=De.programConfigurations.get(o.id),Le=b.useProgram(Q,qe),Oe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ee);Z&&(b.context.activeTexture.set(I.TEXTURE0),ge.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),qe.updatePaintBuffers(U)),Oa(qe,O,xe,ge,o);const Ye=he.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),vt=c.aD(he,ge,ye,me);if(E){oe=De.indexBuffer2,ue=De.segments2;const ot=[I.drawingBufferWidth,I.drawingBufferHeight];le=Q==="fillOutlinePattern"&&Z?Vc(b,U,ge,ot,vt):Uc(ot,vt)}else oe=De.indexBuffer,ue=De.segments,le=Z?Qu(b,U,ge,vt):{u_fill_translate:vt};const pt=b.stencilModeForClipping(Ee);Le.draw(b.context,Y,y,pt,T,qt.backCCW,le,Oe,Ye,o.id,De.layoutVertexBuffer,oe,ue,o.paint,b.transform.zoom,qe)}}function Bo(b,e,o,f,y,T,E,k){const I=b.context,O=I.gl,j="fill-extrusion-pattern",Z=o.paint.get(j),U=Z.constantOr(1),Y=o.getCrossfadeParameters(),Q=o.paint.get("fill-extrusion-opacity"),le=Z.constantOr(null),oe=b.transform;for(const ue of f){const he=e.getTile(ue),ye=he.getBucket(o);if(!ye)continue;const me=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ue),xe=ye.programConfigurations.get(o.id),Ee=b.useProgram(U?"fillExtrusionPattern":"fillExtrusion",xe);U&&(b.context.activeTexture.set(O.TEXTURE0),he.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),xe.updatePaintBuffers(Y));const ge=oe.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!k,applyTerrainMatrix:!0});Oa(xe,j,le,he,o);const De=c.aD(oe,he,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),qe=o.paint.get("fill-extrusion-vertical-gradient"),Le=U?kg(b,qe,Q,De,ue,Y,he):ca(b,qe,Q,De);Ee.draw(I,I.gl.TRIANGLES,y,T,E,qt.backCCW,Le,me,ge,o.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,o.paint,b.transform.zoom,xe,b.style.map.terrain&&ye.centroidVertexBuffer)}}function _l(b,e,o,f,y,T,E,k,I){var O;const j=b.style.projection,Z=b.context,U=b.transform,Y=Z.gl,Q=[`#define NUM_ILLUMINATION_SOURCES ${o.paint.get("hillshade-highlight-color").values.length}`],le=b.useProgram("hillshade",null,!1,Q),oe=!b.options.moving;for(const ue of f){const he=e.getTile(ue),ye=he.fbo;if(!ye)continue;const me=j.getMeshFromTileID(Z,ue.canonical,k,!0,"raster"),xe=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(ue);Z.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ye.colorAttachment.get());const Ee=U.getProjectionData({overscaledTileID:ue,aligned:oe,applyGlobeMatrix:!I,applyTerrainMatrix:!0});le.draw(Z,Y.TRIANGLES,T,y[ue.overscaledZ],E,qt.backCCW,jp(b,he,o),xe,Ee,o.id,me.vertexBuffer,me.indexBuffer,me.segments)}}function hh(b,e,o,f,y,T,E,k,I){var O;const j=b.style.projection,Z=b.context,U=b.transform,Y=Z.gl,Q=b.useProgram("colorRelief"),le=!b.options.moving;let oe=!0,ue=0;for(const he of f){const ye=e.getTile(he),me=ye.dem;if(oe){const Le=Y.getParameter(Y.MAX_TEXTURE_SIZE),{elevationTexture:Oe,colorTexture:Ye}=o.getColorRampTextures(Z,Le,me.getUnpackVector());Z.activeTexture.set(Y.TEXTURE1),Oe.bind(Y.NEAREST,Y.CLAMP_TO_EDGE),Z.activeTexture.set(Y.TEXTURE4),Ye.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),oe=!1,ue=Oe.size[0]}if(!me||!me.data)continue;const xe=me.stride,Ee=me.getPixels();if(Z.activeTexture.set(Y.TEXTURE0),Z.pixelStoreUnpackPremultiplyAlpha.set(!1),ye.demTexture=ye.demTexture||b.getTileTexture(xe),ye.demTexture){const Le=ye.demTexture;Le.update(Ee,{premultiply:!1}),Le.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}else ye.demTexture=new c.T(Z,Ee,Y.RGBA,{premultiply:!1}),ye.demTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const ge=j.getMeshFromTileID(Z,he.canonical,k,!0,"raster"),De=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(he),qe=U.getProjectionData({overscaledTileID:he,aligned:le,applyGlobeMatrix:!I,applyTerrainMatrix:!0});Q.draw(Z,Y.TRIANGLES,T,y[he.overscaledZ],E,qt.backCCW,Zc(o,ye.dem,ue),De,qe,o.id,ge.vertexBuffer,ge.indexBuffer,ge.segments)}}const Qc=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function Qi(b,e,o,f,y,T,E,k,I=!1,O=!1){const j=f[f.length-1].overscaledZ,Z=b.context,U=Z.gl,Y=b.useProgram("raster"),Q=b.transform,le=b.style.projection,oe=b.colorModeForRenderPass(),ue=!b.options.moving;for(const he of f){const ye=b.getDepthModeForSublayer(he.overscaledZ-j,o.paint.get("raster-opacity")===1?nn.ReadWrite:nn.ReadOnly,U.LESS),me=e.getTile(he);me.registerFadeDuration(o.paint.get("raster-fade-duration"));const xe=e.findLoadedParent(he,0),Ee=e.findLoadedSibling(he),ge=Ri(me,xe||Ee||null,e,o,b.transform,b.style.map.terrain);let De,qe;const Le=o.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;Z.activeTexture.set(U.TEXTURE0),me.texture.bind(Le,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Z.activeTexture.set(U.TEXTURE1),xe?(xe.texture.bind(Le,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),De=Math.pow(2,xe.tileID.overscaledZ-me.tileID.overscaledZ),qe=[me.tileID.canonical.x*De%1,me.tileID.canonical.y*De%1]):me.texture.bind(Le,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),me.texture.useMipmap&&Z.extTextureFilterAnisotropic&&b.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const Oe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(he),Ye=Q.getProjectionData({overscaledTileID:he,aligned:ue,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),vt=$c(qe||[0,0],De||1,ge,o,k),pt=le.getMeshFromTileID(Z,he.canonical,T,E,"raster");Y.draw(Z,U.TRIANGLES,ye,y?y[he.overscaledZ]:Mn.disabled,oe,I?qt.frontCCW:qt.backCCW,vt,Oe,Ye,o.id,pt.vertexBuffer,pt.indexBuffer,pt.segments)}}function Ri(b,e,o,f,y,T){const E=f.paint.get("raster-fade-duration");if(!T&&E>0){const k=V.now(),I=(k-b.timeAdded)/E,O=e?(k-e.timeAdded)/E:-1,j=o.getSource(),Z=Lt(y,{tileSize:j.tileSize,roundZoom:j.roundZoom}),U=!e||Math.abs(e.tileID.overscaledZ-Z)>Math.abs(b.tileID.overscaledZ-Z),Y=U&&b.refreshedUponExpiration?1:c.ah(U?I:1-O,0,1);return b.refreshedUponExpiration&&I>=1&&(b.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Gn=new c.bf(1,0,0,1),vl=new c.bf(0,1,0,1),ja=new c.bf(0,0,1,1),dh=new c.bf(1,0,1,1),ac=new c.bf(0,1,1,1);function xd(b,e,o,f){ba(b,0,e+o/2,b.transform.width,o,f)}function Ii(b,e,o,f){ba(b,e-o/2,0,o,b.transform.height,f)}function ba(b,e,o,f,y,T){const E=b.context,k=E.gl;k.enable(k.SCISSOR_TEST),k.scissor(e*b.pixelRatio,o*b.pixelRatio,f*b.pixelRatio,y*b.pixelRatio),E.clear({color:T}),k.disable(k.SCISSOR_TEST)}function qr(b,e,o){const f=b.context,y=f.gl,T=b.useProgram("debug"),E=nn.disabled,k=Mn.disabled,I=b.colorModeForRenderPass(),O="$debug",j=b.style.map.terrain&&b.style.map.terrain.getTerrainData(o);f.activeTexture.set(y.TEXTURE0);const Z=e.getTileByID(o.key).latestRawTileData,U=Math.floor((Z&&Z.byteLength||0)/1024),Y=e.getTile(o).tileSize,Q=512/Math.min(Y,512)*(o.overscaledZ/b.transform.zoom)*.5;let le=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(le+=` => ${o.overscaledZ}`),function(ue,he){ue.initDebugOverlayCanvas();const ye=ue.debugOverlayCanvas,me=ue.context.gl,xe=ue.debugOverlayCanvas.getContext("2d");xe.clearRect(0,0,ye.width,ye.height),xe.shadowColor="white",xe.shadowBlur=2,xe.lineWidth=1.5,xe.strokeStyle="white",xe.textBaseline="top",xe.font="bold 36px Open Sans, sans-serif",xe.fillText(he,5,5),xe.strokeText(he,5,5),ue.debugOverlayTexture.update(ye),ue.debugOverlayTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE)}(b,`${le} ${U}kB`);const oe=b.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(f,y.TRIANGLES,E,k,si.alphaBlended,qt.disabled,Ql(c.bf.transparent,Q),null,oe,O,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),T.draw(f,y.LINE_STRIP,E,k,I,qt.disabled,Ql(c.bf.red),j,oe,O,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function fh(b,e,o,f){const{isRenderingGlobe:y}=f,T=b.context,E=T.gl,k=b.transform,I=b.colorModeForRenderPass(),O=b.getDepthModeFor3D(),j=b.useProgram("terrain");T.bindFramebuffer.set(null),T.viewport.set([0,0,b.width,b.height]);for(const Z of o){const U=e.getTerrainMesh(Z.tileID),Y=b.renderToTexture.getTexture(Z),Q=e.getTerrainData(Z.tileID);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,Y.texture);const le=e.getMeshFrameDelta(k.zoom),oe=k.calculateFogMatrix(Z.tileID.toUnwrapped()),ue=fd(le,oe,b.style.sky,k.pitch,y),he=k.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(T,E.TRIANGLES,O,Mn.disabled,I,qt.backCCW,ue,Q,he,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}function Fo(b,e){if(!e.mesh){const o=new c.aL;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const f=new c.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),e.mesh=new ll(b.createVertexBuffer(o,lo.members),b.createIndexBuffer(f),c.aM.simpleSegment(0,0,o.length,f.length))}return e.mesh}class wd{constructor(e,o){this.context=new vd(e),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=vn.maxUnderzooming+vn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gl}resize(e,o,f){if(this.width=Math.floor(e*f),this.height=Math.floor(o*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const e=this.context,o=new c.aL;o.emplaceBack(0,0),o.emplaceBack(c.$,0),o.emplaceBack(0,c.$),o.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(o,lo.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const f=new c.aL;f.emplaceBack(0,0),f.emplaceBack(c.$,0),f.emplaceBack(0,c.$),f.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(f,lo.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const y=new c.c6;y.emplaceBack(0,0,0,0),y.emplaceBack(c.$,0,c.$,0),y.emplaceBack(0,c.$,0,c.$),y.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(y,Cg.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const T=new c.aL;T.emplaceBack(0,0),T.emplaceBack(c.$,0),T.emplaceBack(0,c.$),T.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(T,lo.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const E=new c.aL;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(E,lo.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const k=new c.c7;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(k);const I=new c.aN;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(I);const O=this.context.gl;this.stencilClearMode=new Mn({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.tileExtentMesh=new ll(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,o=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.L();c.bY(f,0,this.width,this.height,0,0,1),c.N(f,f,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const y={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(e,o.TRIANGLES,nn.disabled,this.stencilClearMode,si.disabled,qt.disabled,null,null,y,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,o,f){if(this.currentStencilSource===e.source||!e.isTileClipped()||!o||!o.length)return;this.currentStencilSource=e.source,this.nextStencilID+o.length>256&&this.clearStencil();const y=this.context;y.setColorMode(si.disabled),y.setDepthMode(nn.disabled);const T={};for(const E of o)T[E.key]=this.nextStencilID++;this._renderTileMasks(T,o,f,!0),this._renderTileMasks(T,o,f,!1),this._tileClippingMaskIDs=T}_renderTileMasks(e,o,f,y){const T=this.context,E=T.gl,k=this.style.projection,I=this.transform,O=this.useProgram("clippingMask");for(const j of o){const Z=e[j.key],U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),Y=k.getMeshFromTileID(this.context,j.canonical,y,!0,"stencil"),Q=I.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!f,applyTerrainMatrix:!0});O.draw(T,E.TRIANGLES,nn.disabled,new Mn({func:E.ALWAYS,mask:0},Z,255,E.KEEP,E.KEEP,E.REPLACE),si.disabled,f?qt.disabled:qt.backCCW,null,U,Q,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}_renderTilesDepthBuffer(){const e=this.context,o=e.gl,f=this.style.projection,y=this.transform,T=this.useProgram("depth"),E=this.getDepthModeFor3D(),k=Pe(y,{tileSize:y.tileSize});for(const I of k){const O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),j=f.getMeshFromTileID(this.context,I.canonical,!0,!0,"raster"),Z=y.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(e,o.TRIANGLES,E,Mn.disabled,si.disabled,qt.backCCW,null,O,Z,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,o=this.context.gl;return new Mn({func:o.NOTEQUAL,mask:255},e,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(e){const o=this.context.gl;return new Mn({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const o=this.context.gl,f=e.sort((E,k)=>k.overscaledZ-E.overscaledZ),y=f[f.length-1].overscaledZ,T=f[0].overscaledZ-y+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const E={};for(let k=0;k<T;k++)E[k+y]=new Mn({func:o.GEQUAL,mask:255},k+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=T,[E,f]}return[{[y]:Mn.disabled},f]}stencilConfigForOverlapTwoPass(e){const o=this.context.gl,f=e.sort((E,k)=>k.overscaledZ-E.overscaledZ),y=f[f.length-1].overscaledZ,T=f[0].overscaledZ-y+1;if(this.clearStencil(),T>1){const E={},k={};for(let I=0;I<T;I++)E[I+y]=new Mn({func:o.GREATER,mask:255},T+1+I,255,o.KEEP,o.KEEP,o.REPLACE),k[I+y]=new Mn({func:o.GREATER,mask:255},1+I,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*T+1,[E,k,f]}return this.nextStencilID=3,[{[y]:new Mn({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[y]:new Mn({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},f]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new si([e.CONSTANT_COLOR,e.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?si.unblended:si.alphaBlended}getDepthModeForSublayer(e,o,f){if(!this.opaquePassEnabledForLayer())return nn.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new nn(f||this.context.gl.LEQUAL,o,[y,y])}getDepthModeFor3D(){return new nn(this.context.gl.LEQUAL,nn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,o){var f,y;this.style=e,this.options=o,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(V.now()),this.imageManager.beginFrame();const T=this.style._order,E=this.style.sourceCaches,k={},I={},O={},j={isRenderingToTexture:!1,isRenderingGlobe:((f=e.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const U in E){const Y=E[U];Y.used&&Y.prepare(this.context),k[U]=Y.getVisibleCoordinates(!1),I[U]=k[U].slice().reverse(),O[U]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<T.length;U++)if(this.style._layers[T[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of T){const Y=this.style._layers[U];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const Q=I[Y.source];(Y.type==="custom"||Q.length)&&this.renderLayer(this,E[Y.source],Y,Q,j)}if((y=this.style.projection)===null||y===void 0||y.updateGPUdependent({context:this.context,useProgram:U=>this.useProgram(U)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(U,Y){const Q=U.context,le=Q.gl,oe=((Ee,ge,De)=>{const qe=Math.cos(ge.rollInRadians),Le=Math.sin(ge.rollInRadians),Oe=Te(ge),Ye=ge.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ee.properties.get("sky-color"),u_horizon_color:Ee.properties.get("horizon-color"),u_horizon:[(ge.width/2-Oe*Le)*De,(ge.height/2+Oe*qe)*De],u_horizon_normal:[-Le,qe],u_sky_horizon_blend:Ee.properties.get("sky-horizon-blend")*ge.height/2*De,u_sky_blend:Ye}})(Y,U.style.map.transform,U.pixelRatio),ue=new nn(le.LEQUAL,nn.ReadWrite,[0,1]),he=Mn.disabled,ye=U.colorModeForRenderPass(),me=U.useProgram("sky"),xe=Fo(Q,Y);me.draw(Q,le.TRIANGLES,ue,he,ye,qt.disabled,oe,null,void 0,"sky",xe.vertexBuffer,xe.indexBuffer,xe.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[T[this.currentLayer]],Y=E[U.source],Q=k[U.source];this._renderTileClippingMasks(U,Q,!1),this.renderLayer(this,Y,U,Q,j)}this.renderPass="translucent";let Z=!1;for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const U=this.style._layers[T[this.currentLayer]],Y=E[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U,j))continue;this.opaquePassEnabledForLayer()||Z||(Z=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Q=(U.type==="symbol"?O:I)[U.source];this._renderTileClippingMasks(U,k[U.source],!!this.renderToTexture),this.renderLayer(this,Y,U,Q,j)}if(j.isRenderingGlobe&&function(U,Y,Q){const le=U.context,oe=le.gl,ue=U.useProgram("atmosphere"),he=new nn(oe.LEQUAL,nn.ReadOnly,[0,1]),ye=U.transform,me=function(Ye,vt){const pt=Ye.properties.get("position"),ot=[-pt.x,-pt.y,-pt.z],Ot=c.ag(new Float64Array(16));return Ye.properties.get("anchor")==="map"&&(c.b6(Ot,Ot,vt.rollInRadians),c.b7(Ot,Ot,-vt.pitchInRadians),c.b6(Ot,Ot,vt.bearingInRadians),c.b7(Ot,Ot,vt.center.lat*Math.PI/180),c.bz(Ot,Ot,-vt.center.lng*Math.PI/180)),c.c5(ot,ot,Ot),ot}(Q,U.transform),xe=ye.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ee=Y.properties.get("atmosphere-blend")*xe.projectionTransition;if(Ee===0)return;const ge=jc(ye.worldSize,ye.center.lat),De=ye.inverseProjectionMatrix,qe=new Float64Array(4);qe[3]=1,c.aw(qe,qe,ye.modelViewProjectionMatrix),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1,c.aw(qe,qe,De),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1;const Le=((Ye,vt,pt,ot,Ot)=>({u_sun_pos:Ye,u_atmosphere_blend:vt,u_globe_position:pt,u_globe_radius:ot,u_inv_proj_matrix:Ot}))(me,Ee,[qe[0],qe[1],qe[2]],ge,De),Oe=Fo(le,Y);ue.draw(le,oe.TRIANGLES,he,Mn.disabled,si.alphaBlended,qt.disabled,Le,null,null,"atmosphere",Oe.vertexBuffer,Oe.indexBuffer,Oe.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const U=function(Y,Q){let le=null;const oe=Object.values(Y._layers).flatMap(me=>me.source&&!me.isHidden(Q)?[Y.sourceCaches[me.source]]:[]),ue=oe.filter(me=>me.getSource().type==="vector"),he=oe.filter(me=>me.getSource().type!=="vector"),ye=me=>{(!le||le.getSource().maxzoom<me.getSource().maxzoom)&&(le=me)};return ue.forEach(me=>ye(me)),le||he.forEach(me=>ye(me)),le}(this.style,this.transform.zoom);U&&function(Y,Q,le){for(let oe=0;oe<le.length;oe++)qr(Y,Q,le[oe])}(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const Y=U.transform.padding;xd(U,U.transform.height-(Y.top||0),3,Gn),xd(U,Y.bottom||0,3,vl),Ii(U,Y.left||0,3,ja),Ii(U,U.transform.width-(Y.right||0),3,dh);const Q=U.transform.centerPoint;(function(le,oe,ue,he){ba(le,oe-1,ue-10,2,20,he),ba(le,oe-10,ue-1,20,2,he)})(U,Q.x,U.transform.height-Q.y,ac)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let y=this.terrainFacilitator.dirty;y||(y=e?!c.c8(o,f):!c.c9(o,f)),y||(y=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),y&&(c.ca(o,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(T,E){const k=T.context,I=k.gl,O=T.transform,j=si.unblended,Z=new nn(I.LEQUAL,nn.ReadWrite,[0,1]),U=E.sourceCache.getRenderableTiles(),Y=T.useProgram("terrainDepth");k.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),k.clear({color:c.bf.transparent,depth:1});for(const Q of U){const le=E.getTerrainMesh(Q.tileID),oe=E.getTerrainData(Q.tileID),ue=O.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),he={u_ele_delta:E.getMeshFrameDelta(O.zoom)};Y.draw(k,I.TRIANGLES,Z,Mn.disabled,j,qt.backCCW,he,oe,ue,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,T.width,T.height])}(this,this.style.map.terrain),function(T,E){const k=T.context,I=k.gl,O=T.transform,j=si.unblended,Z=new nn(I.LEQUAL,nn.ReadWrite,[0,1]),U=E.getCoordsTexture(),Y=E.sourceCache.getRenderableTiles(),Q=T.useProgram("terrainCoords");k.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),k.clear({color:c.bf.transparent,depth:1}),E.coordsIndex=[];for(const le of Y){const oe=E.getTerrainMesh(le.tileID),ue=E.getTerrainData(le.tileID);k.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,U.texture);const he={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(O.zoom)},ye=O.getProjectionData({overscaledTileID:le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(k,I.TRIANGLES,Z,Mn.disabled,j,qt.backCCW,he,ue,ye,"terrain",oe.vertexBuffer,oe.indexBuffer,oe.segments),E.coordsIndex.push(le.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,T.width,T.height])}(this,this.style.map.terrain))}renderLayer(e,o,f,y,T){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(y||[]).length)&&(this.id=f.id,c.cb(f)?function(E,k,I,O,j,Z){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:U}=Z,Y=Mn.disabled,Q=E.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(le,oe,ue,he,ye,me,xe,Ee,ge){const De=oe.transform,qe=oe.style.map.terrain,Le=ye==="map",Oe=me==="map";for(const Ye of le){const vt=he.getTile(Ye),pt=vt.getBucket(ue);if(!pt||!pt.text||!pt.text.segments.get().length)continue;const ot=c.an(pt.textSizeData,De.zoom),Ot=c.aC(vt,1,oe.transform.zoom),mn=ai(Le,oe.transform,Ot),Rn=ue.layout.get("icon-text-fit")!=="none"&&pt.hasIconData();if(ot){const Mi=Math.pow(2,De.zoom-vt.tileID.overscaledZ),Fn=qe?(_i,Ci)=>qe.getElevation(Ye,_i,Ci):null;uh(pt,Le,Oe,ge,De,mn,Mi,ot,Rn,c.aD(De,vt,xe,Ee),Ye.toUnwrapped(),Fn)}}}(O,E,I,k,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),j),I.paint.get("icon-opacity").constantOr(1)!==0&&po(E,k,I,O,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),Y,Q,U),I.paint.get("text-opacity").constantOr(1)!==0&&po(E,k,I,O,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),Y,Q,U),k.map.showCollisionBoxes&&(Pf(E,k,I,O,!0),Pf(E,k,I,O,!1))}(e,o,f,y,this.style.placement.variableOffsets,T):c.cc(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=I.paint.get("circle-opacity"),Y=I.paint.get("circle-stroke-width"),Q=I.paint.get("circle-stroke-opacity"),le=!I.layout.get("circle-sort-key").isConstant();if(U.constantOr(1)===0&&(Y.constantOr(1)===0||Q.constantOr(1)===0))return;const oe=E.context,ue=oe.gl,he=E.transform,ye=E.getDepthModeForSublayer(0,nn.ReadOnly),me=Mn.disabled,xe=E.colorModeForRenderPass(),Ee=[],ge=he.getCircleRadiusCorrection();for(let De=0;De<O.length;De++){const qe=O[De],Le=k.getTile(qe),Oe=Le.getBucket(I);if(!Oe)continue;const Ye=I.paint.get("circle-translate"),vt=I.paint.get("circle-translate-anchor"),pt=c.aD(he,Le,Ye,vt),ot=Oe.programConfigurations.get(I.id),Ot=E.useProgram("circle",ot),mn=Oe.layoutVertexBuffer,Rn=Oe.indexBuffer,Mi=E.style.map.terrain&&E.style.map.terrain.getTerrainData(qe),Fn={programConfiguration:ot,program:Ot,layoutVertexBuffer:mn,indexBuffer:Rn,uniformValues:Lp(E,Le,I,pt,ge),terrainData:Mi,projectionData:he.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!Z,applyTerrainMatrix:!0})};if(le){const _i=Oe.segments.get();for(const Ci of _i)Ee.push({segments:new c.aM([Ci]),sortKey:Ci.sortKey,state:Fn})}else Ee.push({segments:Oe.segments,sortKey:0,state:Fn})}le&&Ee.sort((De,qe)=>De.sortKey-qe.sortKey);for(const De of Ee){const{programConfiguration:qe,program:Le,layoutVertexBuffer:Oe,indexBuffer:Ye,uniformValues:vt,terrainData:pt,projectionData:ot}=De.state;Le.draw(oe,ue.TRIANGLES,ye,me,xe,qt.backCCW,vt,pt,ot,I.id,Oe,Ye,De.segments,I.paint,E.transform.zoom,qe)}}(e,o,f,y,T):c.cd(f)?function(E,k,I,O,j){if(I.paint.get("heatmap-opacity")===0)return;const Z=E.context,{isRenderingToTexture:U,isRenderingGlobe:Y}=j;if(E.style.map.terrain){for(const Q of O){const le=k.getTile(Q);k.hasRenderableParent(Q)||(E.renderPass==="offscreen"?Wc(E,le,I,Q,Y):E.renderPass==="translucent"&&La(E,I,Q,U,Y))}Z.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(Q,le,oe,ue){const he=Q.context,ye=he.gl,me=Q.transform,xe=Mn.disabled,Ee=new si([ye.ONE,ye.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(ge,De,qe){const Le=ge.gl;ge.activeTexture.set(Le.TEXTURE1),ge.viewport.set([0,0,De.width/4,De.height/4]);let Oe=qe.heatmapFbos.get(c.c2);Oe?(Le.bindTexture(Le.TEXTURE_2D,Oe.colorAttachment.get()),ge.bindFramebuffer.set(Oe.framebuffer)):(Oe=Yr(ge,De.width/4,De.height/4),qe.heatmapFbos.set(c.c2,Oe))})(he,Q,oe),he.clear({color:c.bf.transparent});for(let ge=0;ge<ue.length;ge++){const De=ue[ge];if(le.hasRenderableParent(De))continue;const qe=le.getTile(De),Le=qe.getBucket(oe);if(!Le)continue;const Oe=Le.programConfigurations.get(oe.id),Ye=Q.useProgram("heatmap",Oe),vt=me.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),pt=me.getCircleRadiusCorrection();Ye.draw(he,ye.TRIANGLES,nn.disabled,xe,Ee,qt.backCCW,Op(qe,me.zoom,oe.paint.get("heatmap-intensity"),pt),null,vt,oe.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,oe.paint,me.zoom,Oe)}he.viewport.set([0,0,Q.width,Q.height])}(E,k,I,O):E.renderPass==="translucent"&&function(Q,le){const oe=Q.context,ue=oe.gl;oe.setColorMode(Q.colorModeForRenderPass());const he=le.heatmapFbos.get(c.c2);he&&(oe.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,he.colorAttachment.get()),oe.activeTexture.set(ue.TEXTURE1),Ms(oe,le).bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(oe,ue.TRIANGLES,nn.disabled,Mn.disabled,Q.colorModeForRenderPass(),qt.disabled,Af(Q,le,0,1),null,null,le.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,le.paint,Q.transform.zoom))}(E,I)}(e,o,f,y,T):c.ce(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=I.paint.get("line-opacity"),Y=I.paint.get("line-width");if(U.constantOr(1)===0||Y.constantOr(1)===0)return;const Q=E.getDepthModeForSublayer(0,nn.ReadOnly),le=E.colorModeForRenderPass(),oe=I.paint.get("line-dasharray"),ue=I.paint.get("line-pattern"),he=ue.constantOr(1),ye=I.paint.get("line-gradient"),me=I.getCrossfadeParameters(),xe=he?"linePattern":oe?"lineSDF":ye?"lineGradient":"line",Ee=E.context,ge=Ee.gl,De=E.transform;let qe=!0;for(const Le of O){const Oe=k.getTile(Le);if(he&&!Oe.patternsLoaded())continue;const Ye=Oe.getBucket(I);if(!Ye)continue;const vt=Ye.programConfigurations.get(I.id),pt=E.context.program.get(),ot=E.useProgram(xe,vt),Ot=qe||ot.program!==pt,mn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Le),Rn=ue.constantOr(null);if(Rn&&Oe.imageAtlas){const oi=Oe.imageAtlas,on=oi.patternPositions[Rn.to.toString()],cr=oi.patternPositions[Rn.from.toString()];on&&cr&&vt.setConstantPatternPositions(on,cr)}const Mi=De.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Fn=De.getPixelScale(),_i=he?Cf(E,Oe,I,Fn,me):oe?dl(E,Oe,I,Fn,oe,me):ye?Ju(E,Oe,I,Fn,Ye.lineClipsArray.length):pd(E,Oe,I,Fn);if(he)Ee.activeTexture.set(ge.TEXTURE0),Oe.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),vt.updatePaintBuffers(me);else if(oe&&(Ot||E.lineAtlas.dirty))Ee.activeTexture.set(ge.TEXTURE0),E.lineAtlas.bind(Ee);else if(ye){const oi=Ye.gradients[I.id];let on=oi.texture;if(I.gradientVersion!==oi.version){let cr=256;if(I.stepInterpolant){const $i=k.getSource().maxzoom,mr=Le.canonical.z===$i?Math.ceil(1<<E.transform.maxZoom-Le.canonical.z):1;cr=c.ah(c.c3(Ye.maxLineLength/c.$*1024*mr),256,Ee.maxTextureSize)}oi.gradient=c.c4({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:cr,image:oi.gradient||void 0,clips:Ye.lineClipsArray}),oi.texture?oi.texture.update(oi.gradient):oi.texture=new c.T(Ee,oi.gradient,ge.RGBA),oi.version=I.gradientVersion,on=oi.texture}Ee.activeTexture.set(ge.TEXTURE0),on.bind(I.stepInterpolant?ge.NEAREST:ge.LINEAR,ge.CLAMP_TO_EDGE)}const Ci=E.stencilModeForClipping(Le);ot.draw(Ee,ge.TRIANGLES,Q,Ci,le,qt.disabled,_i,mn,Mi,I.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,I.paint,E.transform.zoom,vt,Ye.layoutVertexBuffer2),qe=!1}}(e,o,f,y,T):c.cf(f)?function(E,k,I,O,j){const Z=I.paint.get("fill-color"),U=I.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const{isRenderingToTexture:Y}=j,Q=E.colorModeForRenderPass(),le=I.paint.get("fill-pattern"),oe=E.opaquePassEnabledForLayer()&&!le.constantOr(1)&&Z.constantOr(c.bf.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===oe){const ue=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?nn.ReadWrite:nn.ReadOnly);is(E,k,I,O,ue,Q,!1,Y)}if(E.renderPass==="translucent"&&I.paint.get("fill-antialias")){const ue=E.getDepthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,nn.ReadOnly);is(E,k,I,O,ue,Q,!0,Y)}}(e,o,f,y,T):c.cg(f)?function(E,k,I,O,j){const Z=I.paint.get("fill-extrusion-opacity");if(Z===0)return;const{isRenderingToTexture:U}=j;if(E.renderPass==="translucent"){const Y=new nn(E.context.gl.LEQUAL,nn.ReadWrite,E.depthRangeFor3D);if(Z!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))Bo(E,k,I,O,Y,Mn.disabled,si.disabled,U),Bo(E,k,I,O,Y,E.stencilModeFor3D(),E.colorModeForRenderPass(),U);else{const Q=E.colorModeForRenderPass();Bo(E,k,I,O,Y,Mn.disabled,Q,U)}}}(e,o,f,y,T):c.ch(f)?function(E,k,I,O,j){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=E.context,Y=E.style.projection.useSubdivision,Q=E.getDepthModeForSublayer(0,nn.ReadOnly),le=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(oe,ue,he,ye,me,xe,Ee){const ge=oe.context,De=ge.gl;for(const qe of he){const Le=ue.getTile(qe),Oe=Le.dem;if(!Oe||!Oe.data||!Le.needsHillshadePrepare)continue;const Ye=Oe.dim,vt=Oe.stride,pt=Oe.getPixels();if(ge.activeTexture.set(De.TEXTURE1),ge.pixelStoreUnpackPremultiplyAlpha.set(!1),Le.demTexture=Le.demTexture||oe.getTileTexture(vt),Le.demTexture){const Ot=Le.demTexture;Ot.update(pt,{premultiply:!1}),Ot.bind(De.NEAREST,De.CLAMP_TO_EDGE)}else Le.demTexture=new c.T(ge,pt,De.RGBA,{premultiply:!1}),Le.demTexture.bind(De.NEAREST,De.CLAMP_TO_EDGE);ge.activeTexture.set(De.TEXTURE0);let ot=Le.fbo;if(!ot){const Ot=new c.T(ge,{width:Ye,height:Ye,data:null},De.RGBA);Ot.bind(De.LINEAR,De.CLAMP_TO_EDGE),ot=Le.fbo=ge.createFramebuffer(Ye,Ye,!0,!1),ot.colorAttachment.set(Ot.texture)}ge.bindFramebuffer.set(ot.framebuffer),ge.viewport.set([0,0,Ye,Ye]),oe.useProgram("hillshadePrepare").draw(ge,De.TRIANGLES,me,xe,Ee,qt.disabled,Mf(Le.tileID,Oe),null,null,ye.id,oe.rasterBoundsBuffer,oe.quadTriangleIndexBuffer,oe.rasterBoundsSegments),Le.needsHillshadePrepare=!1}})(E,k,O,I,Q,Mn.disabled,le),U.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(Y){const[oe,ue,he]=E.stencilConfigForOverlapTwoPass(O);_l(E,k,I,he,oe,Q,le,!1,Z),_l(E,k,I,he,ue,Q,le,!0,Z)}else{const[oe,ue]=E.getStencilConfigForOverlapAndUpdateStencilID(O);_l(E,k,I,ue,oe,Q,le,!1,Z)}}(e,o,f,y,T):c.ci(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent"||!O.length)return;const{isRenderingToTexture:Z}=j,U=E.style.projection.useSubdivision,Y=E.getDepthModeForSublayer(0,nn.ReadOnly),Q=E.colorModeForRenderPass();if(U){const[le,oe,ue]=E.stencilConfigForOverlapTwoPass(O);hh(E,k,I,ue,le,Y,Q,!1,Z),hh(E,k,I,ue,oe,Y,Q,!0,Z)}else{const[le,oe]=E.getStencilConfigForOverlapAndUpdateStencilID(O);hh(E,k,I,oe,le,Y,Q,!1,Z)}}(e,o,f,y,T):c.cj(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!O.length)return;const{isRenderingToTexture:Z}=j,U=k.getSource(),Y=E.style.projection.useSubdivision;if(U instanceof ka)Qi(E,k,I,O,null,!1,!1,U.tileCoords,U.flippedWindingOrder,Z);else if(Y){const[Q,le,oe]=E.stencilConfigForOverlapTwoPass(O);Qi(E,k,I,oe,Q,!1,!0,Qc,!1,Z),Qi(E,k,I,oe,le,!0,!0,Qc,!1,Z)}else{const[Q,le]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Qi(E,k,I,le,Q,!1,!0,Qc,!1,Z)}}(e,o,f,y,T):c.ck(f)?function(E,k,I,O,j){const Z=I.paint.get("background-color"),U=I.paint.get("background-opacity");if(U===0)return;const{isRenderingToTexture:Y}=j,Q=E.context,le=Q.gl,oe=E.style.projection,ue=E.transform,he=ue.tileSize,ye=I.paint.get("background-pattern");if(E.isPatternMissing(ye))return;const me=!ye&&Z.a===1&&U===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==me)return;const xe=Mn.disabled,Ee=E.getDepthModeForSublayer(0,me==="opaque"?nn.ReadWrite:nn.ReadOnly),ge=E.colorModeForRenderPass(),De=E.useProgram(ye?"backgroundPattern":"background"),qe=O||Pe(ue,{tileSize:he,terrain:E.style.map.terrain});ye&&(Q.activeTexture.set(le.TEXTURE0),E.imageManager.bind(E.context));const Le=I.getCrossfadeParameters();for(const Oe of qe){const Ye=ue.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),vt=ye?Vp(U,E,ye,{tileID:Oe,tileSize:he},Le):Up(U,Z),pt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Oe),ot=oe.getMeshFromTileID(Q,Oe.canonical,!1,!0,"raster");De.draw(Q,le.TRIANGLES,Ee,xe,ge,qt.backCCW,vt,pt,Ye,I.id,ot.vertexBuffer,ot.indexBuffer,ot.segments)}}(e,0,f,y,T):c.cl(f)&&function(E,k,I,O){const{isRenderingGlobe:j}=O,Z=E.context,U=I.implementation,Y=E.style.projection,Q=E.transform,le=Q.getProjectionDataForCustomLayer(j),oe={farZ:Q.farZ,nearZ:Q.nearZ,fov:Q.fov*Math.PI/180,modelViewProjectionMatrix:Q.modelViewProjectionMatrix,projectionMatrix:Q.projectionMatrix,shaderData:{variantName:Y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Y.shaderPreludeCode.vertexSource}`,define:Y.shaderDefine},defaultProjectionData:le},ue=U.renderingMode?U.renderingMode:"2d";if(E.renderPass==="offscreen"){const he=U.prerender;he&&(E.setCustomLayerDefaults(),Z.setColorMode(E.colorModeForRenderPass()),he.call(U,Z.gl,oe),Z.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),Z.setColorMode(E.colorModeForRenderPass()),Z.setStencilMode(Mn.disabled);const he=ue==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,nn.ReadOnly);Z.setDepthMode(he),U.render(Z.gl,oe),Z.setDirty(),E.setBaseState(),Z.bindFramebuffer.set(null)}}(e,0,f,T))}saveTileTexture(e){const o=this._tileTextures[e.size[0]];o?o.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const o=this._tileTextures[e];return o&&o.length>0?o.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const o=this.imageManager.getPattern(e.from.toString()),f=this.imageManager.getPattern(e.to.toString());return!o||!f}useProgram(e,o,f=!1,y=[]){this.cache=this.cache||{};const T=!!this.style.map.terrain,E=this.style.projection,k=f?Es.projectionMercator:E.shaderPreludeCode,I=f?Po:E.shaderDefine,O=e+(o?o.cacheKey:"")+`/${f?Zl:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(T?"/terrain":"")+(y?`/${y.join("/")}`:"");return this.cache[O]||(this.cache[O]=new Ef(this.context,Es[e],o,ua[e],this._showOverdrawInspector,T,k,I,y)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:o}=this.context.gl;return this.width!==e||this.height!==o}}function Ba(b,e){let o,f=!1,y=null,T=null;const E=()=>{y=null,f&&(b.apply(T,o),y=setTimeout(E,e),f=!1)};return(...k)=>(f=!0,T=this,o=k,y||E(),y)}class rs{constructor(e){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:f,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const f=o.join("/");let y=f;y.split("&").length>0&&(y=y.split("&")[0]),this._hashName&&(y=`${this._hashName}=${f}`);let T=window.location.hash.replace(y,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let E=window.location.href.replace(/(#.+)?$/,T);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Ba(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const o=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,y),E=Math.round(o.lng*T)/T,k=Math.round(o.lat*T)/T,I=this._map.getBearing(),O=this._map.getPitch();let j="";if(j+=e?`/${E}/${k}/${f}`:`${f}/${k}/${E}`,(I||O)&&(j+="/"+Math.round(10*I)/10),O&&(j+=`/${Math.round(O)}`),this._hashName){const Z=this._hashName;let U=!1;const Y=window.location.hash.slice(1).split("&").map(Q=>{const le=Q.split("=")[0];return le===Z?(U=!0,`${le}=${j}`):Q}).filter(Q=>Q);return U||Y.push(`${Z}=${j}`),`#${Y.join("&")}`}return`#${j}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const o=+e[0],f=+(e[3]||0),y=+(e[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&f>=-180&&f<=180&&y>=this._map.getMinPitch()&&y<=this._map.getMaxPitch()}}const Hr={linearity:.3,easing:c.cm(0,0,.3,1)},Cs=c.e({deceleration:2500,maxSpeed:1400},Hr),Td=c.e({deceleration:20,maxSpeed:1400},Hr),Sd=c.e({deceleration:1e3,maxSpeed:360},Hr),Kc=c.e({deceleration:1e3,maxSpeed:90},Hr),ph=c.e({deceleration:1e3,maxSpeed:360},Hr);class bl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:V.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,o=V.now();for(;e.length>0&&o-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)o.zoom+=T.zoomDelta||0,o.bearing+=T.bearingDelta||0,o.pitch+=T.pitchDelta||0,o.roll+=T.rollDelta||0,T.panDelta&&o.pan._add(T.panDelta),T.around&&(o.around=T.around),T.pinchAround&&(o.pinchAround=T.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(o.pan.mag()){const T=Uo(o.pan.mag(),f,c.e({},Cs,e||{})),E=o.pan.mult(T.amount/o.pan.mag()),k=this._map.cameraHelper.handlePanInertia(E,this._map.transform);y.center=k.easingCenter,y.offset=k.easingOffset,yi(y,T)}if(o.zoom){const T=Uo(o.zoom,f,Td);y.zoom=this._map.transform.zoom+T.amount,yi(y,T)}if(o.bearing){const T=Uo(o.bearing,f,Sd);y.bearing=this._map.transform.bearing+c.ah(T.amount,-179,179),yi(y,T)}if(o.pitch){const T=Uo(o.pitch,f,Kc);y.pitch=this._map.transform.pitch+T.amount,yi(y,T)}if(o.roll){const T=Uo(o.roll,f,ph);y.roll=this._map.transform.roll+c.ah(T.amount,-179,179),yi(y,T)}if(y.zoom||y.bearing){const T=o.pinchAround===void 0?o.around:o.pinchAround;y.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),c.e(y,{noMoveStart:!0})}}function yi(b,e){(!b.duration||b.duration<e.duration)&&(b.duration=e.duration,b.easing=e.easing)}function Uo(b,e,o){const{maxSpeed:f,linearity:y,deceleration:T}=o,E=c.ah(b*y/(e/1e3),-f,f),k=Math.abs(E)/(T*y);return{easing:o.easing,duration:1e3*k,amount:E*(k/2)}}class da extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f,y={}){f=f instanceof MouseEvent?f:new MouseEvent(e,f);const T=G.mousePos(o.getCanvas(),f),E=o.unproject(T);super(e,c.e({point:T,lngLat:E,originalEvent:f},y)),this._defaultPrevented=!1,this.target=o}}class Jc extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f){const y=e==="touchend"?f.changedTouches:f.touches,T=G.touchPos(o.getCanvasContainer(),y),E=T.map(I=>o.unproject(I)),k=T.reduce((I,O,j,Z)=>I.add(O.div(Z.length)),new c.P(0,0));super(e,{points:T,point:k,lngLats:E,lngLat:o.unproject(k),originalEvent:f}),this._defaultPrevented=!1}}class zf extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f){super(e,{originalEvent:f}),this._defaultPrevented=!1}}class Yp{constructor(e,o){this._map=e,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new zf(e.type,this._map,e))}mousedown(e,o){return this._mousedownPos=o,this._firePreventable(new da(e.type,this._map,e))}mouseup(e){this._map.fire(new da(e.type,this._map,e))}click(e,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new da(e.type,this._map,e))}dblclick(e){return this._firePreventable(new da(e.type,this._map,e))}mouseover(e){this._map.fire(new da(e.type,this._map,e))}mouseout(e){this._map.fire(new da(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Jc(e.type,this._map,e))}touchmove(e){this._map.fire(new Jc(e.type,this._map,e))}touchend(e){this._map.fire(new Jc(e.type,this._map,e))}touchcancel(e){this._map.fire(new Jc(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class or{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new da(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new da("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new da(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class sc{constructor(e,o){this._map=e,this._tr=new xl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,o){this.isEnabled()&&e.shiftKey&&e.button===0&&(G.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(e,o){if(!this._active)return;const f=o;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=f,this._box||(this._box=G.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const T=Math.min(y.x,f.x),E=Math.max(y.x,f.x),k=Math.min(y.y,f.y),I=Math.max(y.y,f.y);G.setTransform(this._box,`translate(${T}px,${k}px)`),this._box.style.width=E-T+"px",this._box.style.height=I-k+"px"}mouseupWindow(e,o){if(!this._active||e.button!==0)return;const f=this._startPos,y=o;if(this.reset(),G.suppressClick(),f.x!==y.x||f.y!==y.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:T=>T.fitScreenCoordinates(f,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,o){return this._map.fire(new c.l(e,{originalEvent:o}))}}function mo(b,e){if(b.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${e.length}`);const o={};for(let f=0;f<b.length;f++)o[b[f].identifier]=e[f];return o}class Ed{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,o,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),f.length===this.numTouches&&(this.centroid=function(y){const T=new c.P(0,0);for(const E of y)T._add(E);return T.div(y.length)}(o),this.touches=mo(f,o)))}touchmove(e,o,f){if(this.aborted||!this.centroid)return;const y=mo(f,o);for(const T in this.touches){const E=y[T];(!E||E.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(e,o,f){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class pr{constructor(e){this.singleTap=new Ed(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,o,f){this.singleTap.touchstart(e,o,f)}touchmove(e,o,f){this.singleTap.touchmove(e,o,f)}touchend(e,o,f){const y=this.singleTap.touchend(e,o,f);if(y){const T=e.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(T&&E||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Xr{constructor(e){this._tr=new xl(e),this._zoomIn=new pr({numTouches:1,numTaps:2}),this._zoomOut=new pr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,o,f){this._zoomIn.touchstart(e,o,f),this._zoomOut.touchstart(e,o,f)}touchmove(e,o,f){this._zoomIn.touchmove(e,o,f),this._zoomOut.touchmove(e,o,f)}touchend(e,o,f){const y=this._zoomIn.touchend(e,o,f),T=this._zoomOut.touchend(e,o,f),E=this._tr;return y?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(y)},{originalEvent:e})}):T?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(T)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eu{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const o=this._moveFunction(...e);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(e,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,o){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const y=Array.isArray(o)?o[0]:o;return!this._moved&&y.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(f,y))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&G.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const as=0,tu=2,qp={[as]:1,[tu]:2};class Ds{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const o=G.mouseButton(e);this._eventButton=o}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(o,f){const y=qp[f];return o.buttons===void 0||(o.buttons&y)!==y}(e,this._eventButton)}isValidEndEvent(e){return G.mouseButton(e)===this._eventButton}}class Lf{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Ad{constructor(e=new Ds({checkCorrectEvent:()=>!0}),o=new Lf){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(e,o,f){return e instanceof MouseEvent?o(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?f(e):void 0}startMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.startMove(o),o=>this.oneFingerTouchMoveStateManager.startMove(o))}endMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.endMove(o),o=>this.oneFingerTouchMoveStateManager.endMove(o))}isValidStartEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidStartEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o))}isValidMoveEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidMoveEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o))}isValidEndEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidEndEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o))}}const nu=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=e=>{e.preventDefault()}};class Vo{constructor(e,o){this._clickTolerance=e.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,o,f){return this._calculateTransform(e,o,f)}touchmove(e,o,f){if(this._active){if(!this._shouldBePrevented(f.length))return e.preventDefault(),this._calculateTransform(e,o,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,o,f){this._calculateTransform(e,o,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,o,f){f.length>0&&(this._active=!0);const y=mo(f,o),T=new c.P(0,0),E=new c.P(0,0);let k=0;for(const O in y){const j=y[O],Z=this._touches[O];Z&&(T._add(j),E._add(j.sub(Z)),k++,y[O]=j)}if(this._touches=y,this._shouldBePrevented(k)||!E.mag())return;const I=E.div(k);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(k),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ss{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,o,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([o[0],o[1]]))}touchmove(e,o,f){if(!this._firstTwoTouches)return;e.preventDefault();const[y,T]=this._firstTwoTouches,E=Ct(f,o,y),k=Ct(f,o,T);if(!E||!k)return;const I=this._aroundCenter?null:E.add(k).div(2);return this._move([E,k],I,e)}touchend(e,o,f){if(!this._firstTwoTouches)return;const[y,T]=this._firstTwoTouches,E=Ct(f,o,y),k=Ct(f,o,T);E&&k||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ct(b,e,o){for(let f=0;f<b.length;f++)if(b[f].identifier===o)return e[f]}function mh(b,e){return Math.log(b/e)/Math.LN2}class gh extends ss{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,o){const f=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(mh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mh(this._distance,f),pinchAround:o}}}function iu(b,e){return 180*b.angleWith(e)/Math.PI}class oc extends ss{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,o,f){const y=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:iu(this._vector,y),pinchAround:o}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const o=25/(Math.PI*this._minDiameter)*360,f=iu(e,this._startVector);return Math.abs(f)<o}}function ks(b){return Math.abs(b.y)>Math.abs(b.x)}class yh extends ss{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,o,f){super.touchstart(e,o,f),this._currentTouchCount=f.length}_start(e){this._lastPoints=e,ks(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,o,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const y=e[0].sub(this._lastPoints[0]),T=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,T,f.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(y.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(e,o,f){if(this._valid!==void 0)return this._valid;const y=e.mag()>=2,T=o.mag()>=2;if(!y&&!T)return;if(!y||!T)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=e.y>0==o.y>0;return ks(e)&&ks(o)&&E}}const Sn={panStep:100,bearingStep:15,pitchStep:10};class Rs{constructor(e){this._tr=new xl(e);const o=Sn;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let o=0,f=0,y=0,T=0,E=0;switch(e.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:e.shiftKey?f=-1:(e.preventDefault(),T=-1);break;case 39:e.shiftKey?f=1:(e.preventDefault(),T=1);break;case 38:e.shiftKey?y=1:(e.preventDefault(),E=-1);break;case 40:e.shiftKey?y=-1:(e.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:k=>{const I=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:Of,zoom:o?Math.round(I.zoom)+o*(e.shiftKey?2:1):I.zoom,bearing:I.bearing+f*this._bearingStep,pitch:I.pitch+y*this._pitchStep,offset:[-T*this._panStep,-E*this._panStep],center:I.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Of(b){return b*(2-b)}const ru=4.000244140625,wl=1/450;class Go{constructor(e,o){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=e,this._tr=new xl(e),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=wl}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let o=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const f=V.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,o!==0&&o%ru==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(y*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=e,this._delta-=o,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=G.mousePos(this._map.getCanvas(),e),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(c.S.convert(f.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const k=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=k),typeof this._targetZoom=="number"&&(this._targetZoom+=k)}if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>ru?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&I!==0&&(I=1/I);const O=typeof this._targetZoom!="number"?e.scale:c.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.ak(O*I)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,f=this._startZoom,y=this._easing;let T,E=!1;if(this._type==="wheel"&&f&&y){const k=V.now()-this._lastWheelEventTime,I=Math.min((k+5)/200,1),O=y(I);T=c.C.number(f,o,O),I<1?this._frameId||(this._frameId=!0):E=!0}else T=o,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=T,{noInertia:!0,needsRenderFrame:!E,zoomDelta:T-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let o=c.co;if(this._prevEase){const f=this._prevEase,y=(V.now()-f.start)/f.duration,T=f.easing(y+.01)-f.easing(y),E=.27/Math.sqrt(T*T+1e-4)*.01,k=Math.sqrt(.0729-E*E);o=c.cm(E,k,.25,1)}return this._prevEase={start:V.now(),duration:e,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class lc{constructor(e,o){this._clickZoom=e,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _h{constructor(e){this._tr=new xl(e),this.reset()}reset(){this._active=!1}dblclick(e,o){return e.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Md{constructor(){this._tap=new pr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,o,f){if(!this._swipePoint)if(this._tapTime){const y=o[0],T=e.timeStamp-this._tapTime<500,E=this._tapPoint.dist(y)<30;T&&E?f.length>0&&(this._swipePoint=y,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(e,o,f)}touchmove(e,o,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=o[0],T=y.y-this._swipePoint.y;return this._swipePoint=y,e.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(e,o,f)}touchend(e,o,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const y=this._tap.touchend(e,o,f);y&&(this._tapTime=e.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class au{constructor(e,o,f){this._el=e,this._mousePan=o,this._touchPan=f}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class cc{constructor(e,o,f,y){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=o,this._mousePitch=f,this._mouseRoll=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class jf{constructor(e,o,f,y){this._el=e,this._touchZoom=o,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Bf{constructor(e,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=G.create("div","maplibregl-cooperative-gesture-screen",e);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),y=document.createElement("div");y.className="maplibregl-desktop-message",y.textContent=o,this._container.appendChild(y);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=f,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(G.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,o){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Wr=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Hn extends c.l{}function Cd(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class su{constructor(e,o){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,T)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=y.type==="renderFrame"?void 0:y,k={needsRenderFrame:!1},I={},O={};for(const{handlerName:U,handler:Y,allowed:Q}of this._handlers){if(!Y.isEnabled())continue;let le;if(this._blockedByActive(O,Q,U))Y.reset();else if(Y[T||y.type]){if(c.cp(y,T||y.type)){const oe=G.mousePos(this._map.getCanvas(),y);le=Y[T||y.type](y,oe)}else if(c.cq(y,T||y.type)){const oe=this._getMapTouches(y.touches),ue=G.touchPos(this._map.getCanvas(),oe);le=Y[T||y.type](y,ue,oe)}else c.cr(T||y.type)||(le=Y[T||y.type](y));this.mergeHandlerResult(k,I,le,U,E),le&&le.needsRenderFrame&&this._triggerRenderFrame()}(le||Y.isActive())&&(O[U]=Y)}const j={};for(const U in this._previousActiveHandlers)O[U]||(j[U]=E);this._previousActiveHandlers=O,(Object.keys(j).length||Cd(k))&&(this._changes.push([k,I,j]),this._triggerRenderFrame()),(Object.keys(O).length||Cd(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=k;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bl(e),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,T,E]of this._listeners)G.addEventListener(y,T,y===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[e,o,f]of this._listeners)G.removeEventListener(e,o,e===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(e){const o=this._map,f=o.getCanvasContainer();this._add("mapEvent",new Yp(o,e));const y=o.boxZoom=new sc(o,e);this._add("boxZoom",y),e.interactive&&e.boxZoom&&y.enable();const T=o.cooperativeGestures=new Bf(o,e.cooperativeGestures);this._add("cooperativeGestures",T),e.cooperativeGestures&&T.enable();const E=new Xr(o),k=new _h(o);o.doubleClickZoom=new lc(k,E),this._add("tapZoom",E),this._add("clickZoom",k),e.interactive&&e.doubleClickZoom&&o.doubleClickZoom.enable();const I=new Md;this._add("tapDragZoom",I);const O=o.touchPitch=new yh(o);this._add("touchPitch",O),e.interactive&&e.touchPitch&&o.touchPitch.enable(e.touchPitch);const j=()=>o.project(o.getCenter()),Z=function({enable:me,clickTolerance:xe,aroundCenter:Ee=!0,minPixelCenterThreshold:ge=100,rotateDegreesPerPixelMoved:De=.8},qe){const Le=new Ds({checkCorrectEvent:Oe=>G.mouseButton(Oe)===0&&Oe.ctrlKey||G.mouseButton(Oe)===2&&!Oe.ctrlKey});return new eu({clickTolerance:xe,move:(Oe,Ye)=>{const vt=qe();if(Ee&&Math.abs(vt.y-Oe.y)>ge)return{bearingDelta:c.cn(new c.P(Oe.x,Ye.y),Ye,vt)};let pt=(Ye.x-Oe.x)*De;return Ee&&Ye.y<vt.y&&(pt=-pt),{bearingDelta:pt}},moveStateManager:Le,enable:me,assignEvents:nu})}(e,j),U=function({enable:me,clickTolerance:xe,pitchDegreesPerPixelMoved:Ee=-.5}){const ge=new Ds({checkCorrectEvent:De=>G.mouseButton(De)===0&&De.ctrlKey||G.mouseButton(De)===2});return new eu({clickTolerance:xe,move:(De,qe)=>({pitchDelta:(qe.y-De.y)*Ee}),moveStateManager:ge,enable:me,assignEvents:nu})}(e),Y=function({enable:me,clickTolerance:xe,rollDegreesPerPixelMoved:Ee=.3},ge){const De=new Ds({checkCorrectEvent:qe=>G.mouseButton(qe)===2&&qe.ctrlKey});return new eu({clickTolerance:xe,move:(qe,Le)=>{const Oe=ge();let Ye=(Le.x-qe.x)*Ee;return Le.y<Oe.y&&(Ye=-Ye),{rollDelta:Ye}},moveStateManager:De,enable:me,assignEvents:nu})}(e,j);o.dragRotate=new cc(e,Z,U,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",U,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Y,["mousePitch"]),e.interactive&&e.dragRotate&&o.dragRotate.enable();const Q=function({enable:me,clickTolerance:xe}){const Ee=new Ds({checkCorrectEvent:ge=>G.mouseButton(ge)===0&&!ge.ctrlKey});return new eu({clickTolerance:xe,move:(ge,De)=>({around:De,panDelta:De.sub(ge)}),activateOnStart:!0,moveStateManager:Ee,enable:me,assignEvents:nu})}(e),le=new Vo(e,o);o.dragPan=new au(f,Q,le),this._add("mousePan",Q),this._add("touchPan",le,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&o.dragPan.enable(e.dragPan);const oe=new oc,ue=new gh;o.touchZoomRotate=new jf(f,ue,oe,I),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&o.touchZoomRotate.enable(e.touchZoomRotate);const he=o.scrollZoom=new Go(o,()=>this._triggerRenderFrame());this._add("scrollZoom",he,["mousePan"]),e.interactive&&e.scrollZoom&&o.scrollZoom.enable(e.scrollZoom);const ye=o.keyboard=new Rs(o);this._add("keyboard",ye),e.interactive&&e.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new or(o))}_add(e,o,f){this._handlers.push({handlerName:e,handler:o,allowed:f}),this._handlersById[e]=o}stop(e){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wr(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,o,f){for(const y in e)if(y!==f&&(!o||o.indexOf(y)<0))return!0;return!1}_getMapTouches(e){const o=[];for(const f of e)this._el.contains(f.target)&&o.push(f);return o}mergeHandlerResult(e,o,f,y,T){if(!f)return;c.e(e,f);const E={handlerName:y,originalEvent:f.originalEvent||T};f.zoomDelta!==void 0&&(o.zoom=E),f.panDelta!==void 0&&(o.drag=E),f.rollDelta!==void 0&&(o.roll=E),f.pitchDelta!==void 0&&(o.pitch=E),f.bearingDelta!==void 0&&(o.rotate=E)}_applyChanges(){const e={},o={},f={};for(const[y,T,E]of this._changes)y.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(y.panDelta)),y.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+y.pitchDelta),y.rollDelta&&(e.rollDelta=(e.rollDelta||0)+y.rollDelta),y.around!==void 0&&(e.around=y.around),y.pinchAround!==void 0&&(e.pinchAround=y.pinchAround),y.noInertia&&(e.noInertia=y.noInertia),c.e(o,T),c.e(f,E);this._updateMapTransform(e,o,f),this._changes=[]}_updateMapTransform(e,o,f){const y=this._map,T=y._getTransformForUpdate(),E=y.terrain;if(!(Cd(e)||E&&this._terrainMovement))return this._fireEvents(o,f,!0);y._stop(!0);let{panDelta:k,zoomDelta:I,bearingDelta:O,pitchDelta:j,rollDelta:Z,around:U,pinchAround:Y}=e;Y!==void 0&&(U=Y),U=U||y.transform.centerPoint,E&&!T.isPointOnMapSurface(U)&&(U=T.centerPoint);const Q={panDelta:k,zoomDelta:I,rollDelta:Z,pitchDelta:j,bearingDelta:O,around:U};this._map.cameraHelper.useGlobeControls&&!T.isPointOnMapSurface(U)&&(U=T.centerPoint);const le=U.distSqr(T.centerPoint)<.01?T.center:T.screenPointToLocation(k?U.sub(k):U);E?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,T),this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?T.setCenter(T.screenPointToLocation(T.centerPoint.sub(k))):this._map.cameraHelper.handleMapControlsPan(Q,T,le):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Q,T,le))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,T),this._map.cameraHelper.handleMapControlsPan(Q,T,le)),y._applyUpdatedTransform(T),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(o,f,!0)}_fireEvents(e,o,f){const y=Wr(this._eventsInProgress),T=Wr(e),E={};for(const Z in e){const{originalEvent:U}=e[Z];this._eventsInProgress[Z]||(E[`${Z}start`]=U),this._eventsInProgress[Z]=e[Z]}!y&&T&&this._fireEvent("movestart",T.originalEvent);for(const Z in E)this._fireEvent(Z,E[Z]);T&&this._fireEvent("move",T.originalEvent);for(const Z in e){const{originalEvent:U}=e[Z];this._fireEvent(Z,U)}const k={};let I;for(const Z in this._eventsInProgress){const{handlerName:U,originalEvent:Y}=this._eventsInProgress[Z];this._handlersById[U].isActive()||(delete this._eventsInProgress[Z],I=o[U]||Y,k[`${Z}end`]=I)}for(const Z in k)this._fireEvent(Z,k[Z]);const O=Wr(this._eventsInProgress),j=(y||T)&&!O;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Z=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Z.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Z)}if(f&&j){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!Z||!Z.essential&&V.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:I})),U(this._map.getBearing())&&this._map.resetNorth()):(U(Z.bearing||this._map.getBearing())&&(Z.bearing=0),Z.freezeElevation=!0,this._map.easeTo(Z,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(e,o){this._map.fire(new c.l(e,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Hn("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class vh extends c.E{constructor(e,o,f){super(),this._renderFrameCallback=()=>{const y=Math.min((V.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=f.bearingSnap,this.cameraHelper=o,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,o){e.apply(this.transform),this.transform=e,this.cameraHelper=o}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,o){return this.jumpTo({center:e},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,o){return this.jumpTo({elevation:e},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,o,f){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},o),f)}panTo(e,o,f){return this.easeTo(c.e({center:e},o),f)}getZoom(){return this.transform.zoom}setZoom(e,o){return this.jumpTo({zoom:e},o),this}zoomTo(e,o,f){return this.easeTo(c.e({zoom:e},o),f)}zoomIn(e,o){return this.zoomTo(this.getZoom()+1,e,o),this}zoomOut(e,o){return this.zoomTo(this.getZoom()-1,e,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,o){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",o)).fire(new c.l("move",o)).fire(new c.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(e,o){return this.jumpTo({bearing:e},o),this}getPadding(){return this.transform.padding}setPadding(e,o){return this.jumpTo({padding:e},o),this}rotateTo(e,o,f){return this.easeTo(c.e({bearing:e},o),f)}resetNorth(e,o){return this.rotateTo(0,c.e({duration:1e3},e),o),this}resetNorthPitch(e,o){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),o),this}snapToNorth(e,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,o):this}getPitch(){return this.transform.pitch}setPitch(e,o){return this.jumpTo({pitch:e},o),this}getRoll(){return this.transform.roll}setRoll(e,o){return this.jumpTo({roll:e},o),this}cameraForBounds(e,o){e=Yn.convert(e).adjustAntiMeridian();const f=o&&o.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),f,o)}_cameraForBoxAndBearing(e,o,f,y){const T={top:0,bottom:0,right:0,left:0};if(typeof(y=c.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const O=y.padding;y.padding={top:O,bottom:O,right:O,left:O}}const E=c.e(T,y.padding);y.padding=E;const k=this.transform,I=new Yn(e,o);return this.cameraHelper.cameraForBoxAndBearing(y,E,I,f,k)}fitBounds(e,o,f){return this._fitInternal(this.cameraForBounds(e,o),o,f)}fitScreenCoordinates(e,o,f,y,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(o)),f,y),y,T)}_fitInternal(e,o,f){return e?(delete(o=c.e(e,o)).padding,o.linear?this.easeTo(o,f):this.flyTo(o,f)):this}jumpTo(e,o){this.stop();const f=this._getTransformForUpdate();let y=!1,T=!1,E=!1;const k=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,e);const I=f.zoom!==k;return"elevation"in e&&f.elevation!==+e.elevation&&f.setElevation(+e.elevation),"bearing"in e&&f.bearing!==+e.bearing&&(y=!0,f.setBearing(+e.bearing)),"pitch"in e&&f.pitch!==+e.pitch&&(T=!0,f.setPitch(+e.pitch)),"roll"in e&&f.roll!==+e.roll&&(E=!0,f.setRoll(+e.roll)),e.padding==null||f.isPaddingEqual(e.padding)||f.setPadding(e.padding),this._applyUpdatedTransform(f),this.fire(new c.l("movestart",o)).fire(new c.l("move",o)),I&&this.fire(new c.l("zoomstart",o)).fire(new c.l("zoom",o)).fire(new c.l("zoomend",o)),y&&this.fire(new c.l("rotatestart",o)).fire(new c.l("rotate",o)).fire(new c.l("rotateend",o)),T&&this.fire(new c.l("pitchstart",o)).fire(new c.l("pitch",o)).fire(new c.l("pitchend",o)),E&&this.fire(new c.l("rollstart",o)).fire(new c.l("roll",o)).fire(new c.l("rollend",o)),this.fire(new c.l("moveend",o))}calculateCameraOptionsFromTo(e,o,f,y=0){const T=c.a1.fromLngLat(e,o),E=c.a1.fromLngLat(f,y),k=E.x-T.x,I=E.y-T.y,O=E.z-T.z,j=Math.hypot(k,I,O);if(j===0)throw new Error("Can't calculate camera options with same From and To");const Z=Math.hypot(k,I),U=c.ak(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Y=180*Math.atan2(k,-I)/Math.PI;let Q=180*Math.acos(Z/j)/Math.PI;return Q=O<0?90-Q:90+Q,{center:E.toLngLat(),elevation:y,zoom:U,pitch:Q,bearing:Y}}calculateCameraOptionsFromCameraLngLatAltRotation(e,o,f,y,T){const E=this.transform.calculateCenterFromCameraLngLatAlt(e,o,f,y);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:f,pitch:y,roll:T}}easeTo(e,o){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.co},e)).animate===!1||!e.essential&&V.prefersReducedMotion)&&(e.duration=0);const f=this._getTransformForUpdate(),y=this.getBearing(),T=f.pitch,E=f.roll,k="bearing"in e?this._normalizeBearing(e.bearing,y):y,I="pitch"in e?+e.pitch:T,O="roll"in e?this._normalizeBearing(e.roll,E):E,j="padding"in e?e.padding:f.padding,Z=c.P.convert(e.offset);let U,Y;e.around&&(U=c.S.convert(e.around),Y=f.locationToScreenPoint(U));const Q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},le=this.cameraHelper.handleEaseTo(f,{bearing:k,pitch:I,roll:O,padding:j,around:U,aroundPoint:Y,offsetAsPoint:Z,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||y!==k,this._pitching=this._pitching||I!==T,this._rolling=this._rolling||O!==E,this._padding=!f.isPaddingEqual(j),this._zooming=this._zooming||le.isZooming,this._easeId=e.easeId,this._prepareEase(o,e.noMoveStart,Q),this.terrain&&this._prepareElevation(le.elevationCenter),this._ease(oe=>{le.easeFunc(oe),this.terrain&&!e.freezeElevation&&this._updateElevation(oe),this._applyUpdatedTransform(f),this._fireMoveEvents(o)},oe=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o,oe)},e),this}_prepareEase(e,o,f={}){this._moving=!0,o||f.moving||this.fire(new c.l("movestart",e)),this._zooming&&!f.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!f.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!f.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!f.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&o!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(f-(o-(f*e+this._elevationStart))/(1-e)),this._elevationTarget=o}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const o=e.getCameraLngLat(),f=e.getCameraAltitude(),y=this.terrain?this.terrain.getElevationForLngLatZoom(o,e.zoom):0;if(f<y){const T=this.calculateCameraOptionsFromTo(o,y,e.center,e.elevation);return{pitch:T.pitch,zoom:T.zoom}}return{}}_applyUpdatedTransform(e){const o=[];if(o.push(y=>this._elevateCameraIfInsideTerrain(y)),this.transformCameraUpdate&&o.push(y=>this.transformCameraUpdate(y)),!o.length)return;const f=e.clone();for(const y of o){const T=f.clone(),{center:E,zoom:k,roll:I,pitch:O,bearing:j,elevation:Z}=y(T);E&&T.setCenter(E),Z!==void 0&&T.setElevation(Z),k!==void 0&&T.setZoom(k),I!==void 0&&T.setRoll(I),O!==void 0&&T.setPitch(O),j!==void 0&&T.setBearing(j),f.apply(T)}this.transform.apply(f)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const f=this._zooming,y=this._rotating,T=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new c.l("zoomend",e)),y&&this.fire(new c.l("rotateend",e)),T&&this.fire(new c.l("pitchend",e)),E&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,o){if(!e.essential&&V.prefersReducedMotion){const Ye=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ye,o)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},e);const f=this._getTransformForUpdate(),y=f.bearing,T=f.pitch,E=f.roll,k=f.padding,I="bearing"in e?this._normalizeBearing(e.bearing,y):y,O="pitch"in e?+e.pitch:T,j="roll"in e?this._normalizeBearing(e.roll,E):E,Z="padding"in e?e.padding:f.padding,U=c.P.convert(e.offset);let Y=f.centerPoint.add(U);const Q=f.screenPointToLocation(Y),le=this.cameraHelper.handleFlyTo(f,{bearing:I,pitch:O,roll:j,padding:Z,locationAtOffset:Q,offsetAsPoint:U,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let oe=e.curve;const ue=Math.max(f.width,f.height),he=ue/le.scaleOfZoom,ye=le.pixelPathLength;typeof le.scaleOfMinZoom=="number"&&(oe=Math.sqrt(ue/le.scaleOfMinZoom/ye*2));const me=oe*oe;function xe(Ye){const vt=(he*he-ue*ue+(Ye?-1:1)*me*me*ye*ye)/(2*(Ye?he:ue)*me*ye);return Math.log(Math.sqrt(vt*vt+1)-vt)}function Ee(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function ge(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const De=xe(!1);let qe=function(Ye){return ge(De)/ge(De+oe*Ye)},Le=function(Ye){return ue*((ge(De)*(Ee(vt=De+oe*Ye)/ge(vt))-Ee(De))/me)/ye;var vt},Oe=(xe(!0)-De)/oe;if(Math.abs(ye)<2e-6||!isFinite(Oe)){if(Math.abs(ue-he)<1e-6)return this.easeTo(e,o);const Ye=he<ue?-1:1;Oe=Math.abs(Math.log(he/ue))/oe,Le=()=>0,qe=vt=>Math.exp(Ye*oe*vt)}return e.duration="duration"in e?+e.duration:1e3*Oe/("screenSpeed"in e?+e.screenSpeed/oe:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=y!==I,this._pitching=O!==T,this._rolling=j!==E,this._padding=!f.isPaddingEqual(Z),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(le.targetCenter),this._ease(Ye=>{const vt=Ye*Oe,pt=1/qe(vt),ot=Le(vt);this._rotating&&f.setBearing(c.C.number(y,I,Ye)),this._pitching&&f.setPitch(c.C.number(T,O,Ye)),this._rolling&&f.setRoll(c.C.number(E,j,Ye)),this._padding&&(f.interpolatePadding(k,Z,Ye),Y=f.centerPoint.add(U)),le.easeFunc(Ye,pt,ot,Y),this.terrain&&!e.freezeElevation&&this._updateElevation(Ye),this._applyUpdatedTransform(f),this._fireMoveEvents(o)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,o){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,o)}return e||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(e,o,f){f.animate===!1||f.duration===0?(e(1),o()):(this._easeStart=V.now(),this._easeOptions=f,this._onEaseFrame=e,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,o){e=c.aO(e,-180,180);const f=Math.abs(e-o);return Math.abs(e-360-o)<f&&(e-=360),Math.abs(e+360-o)<f&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const go={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class wn{constructor(e=go){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,o){const f=this._map._getUIString(`AttributionControl.${o}`);e.title=f,e.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const o=this._map.style.sourceCaches;for(const y in o){const T=o[y];if(T.used||T.usedForTerrain){const E=T.getSource();E.attribution&&e.indexOf(E.attribution)<0&&e.push(E.attribution)}}e=e.filter(y=>String(y).trim()),e.sort((y,T)=>y.length-T.length),e=e.filter((y,T)=>{for(let E=T+1;E<e.length;E++)if(e[E].indexOf(y)>=0)return!1;return!0});const f=e.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,e.length?(this._innerContainer.innerHTML=G.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Qn{constructor(e={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl");const o=G.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class lr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const o=++this._id;return this._queue.push({callback:e,id:o,cancelled:!1}),o}remove(e){const o=this._currentlyRunning,f=o?this._queue.concat(o):this._queue;for(const y of f)if(y.id===e)return void(y.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const f of o)if(!f.cancelled&&(f.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Fa=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Zo extends c.E{constructor(e){super(),this._lastTilesetChange=V.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,o){this.sourceCache.update(e,o),this._renderableTilesKeys=[];const f={};for(const y of Pe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.terrainRttPosMatrix32f=new Float64Array(16),c.bY(y.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[y.key]=new Ur(y,this.tileSize),this._lastTilesetChange=V.now());for(const y in this._tiles)f[y]||delete this._tiles[y]}freeRtt(e){for(const o in this._tiles){const f=this._tiles[o];(!e||f.tileID.equals(e)||f.tileID.isChildOf(e)||e.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,o){return o?this._getTerrainCoordsForTileRanges(e,o):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const o={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID,T=e.clone(),E=c.ba();if(y.canonical.equals(e.canonical))c.bY(E,0,c.$,c.$,0,0,1);else if(y.canonical.isChildOf(e.canonical)){const k=y.canonical.z-e.canonical.z,I=y.canonical.x-(y.canonical.x>>k<<k),O=y.canonical.y-(y.canonical.y>>k<<k),j=c.$>>k;c.bY(E,0,j,j,0,0,1),c.M(E,E,[-I*j,-O*j,0])}else{if(!e.canonical.isChildOf(y.canonical))continue;{const k=e.canonical.z-y.canonical.z,I=e.canonical.x-(e.canonical.x>>k<<k),O=e.canonical.y-(e.canonical.y>>k<<k),j=c.$>>k;c.bY(E,0,c.$,c.$,0,0,1),c.M(E,E,[I*j,O*j,0]),c.N(E,E,[1/2**k,1/2**k,0])}}T.terrainRttPosMatrix32f=new Float32Array(E),o[f]=T}return o}_getTerrainCoordsForTileRanges(e,o){const f={};for(const y of this._renderableTilesKeys){const T=this._tiles[y].tileID;if(!this._isWithinTileRanges(T,o))continue;const E=e.clone(),k=c.ba();if(T.canonical.z===e.canonical.z){const I=e.canonical.x-T.canonical.x,O=e.canonical.y-T.canonical.y;c.bY(k,0,c.$,c.$,0,0,1),c.M(k,k,[I*c.$,O*c.$,0])}else if(T.canonical.z>e.canonical.z){const I=T.canonical.z-e.canonical.z,O=T.canonical.x-(T.canonical.x>>I<<I),j=T.canonical.y-(T.canonical.y>>I<<I),Z=e.canonical.x-(T.canonical.x>>I),U=e.canonical.y-(T.canonical.y>>I),Y=c.$>>I;c.bY(k,0,Y,Y,0,0,1),c.M(k,k,[-O*Y+Z*c.$,-j*Y+U*c.$,0])}else{const I=e.canonical.z-T.canonical.z,O=e.canonical.x-(e.canonical.x>>I<<I),j=e.canonical.y-(e.canonical.y>>I<<I),Z=(e.canonical.x>>I)-T.canonical.x,U=(e.canonical.y>>I)-T.canonical.y,Y=c.$<<I;c.bY(k,0,Y,Y,0,0,1),c.M(k,k,[O*c.$+Z*Y,j*c.$+U*Y,0])}E.terrainRttPosMatrix32f=new Float32Array(k),f[y]=E}return f}getSourceTile(e,o){const f=this.sourceCache._source;let y=e.overscaledZ-this.deltaZoom;if(y>f.maxzoom&&(y=f.maxzoom),y<f.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(y).key);let T=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!T||!T.dem)&&o)for(;y>=f.minzoom&&(!T||!T.dem);)T=this.sourceCache.getTileByID(e.scaledTo(y--).key);return T}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,o){return o[e.canonical.z]&&e.canonical.x>=o[e.canonical.z].minTileX&&e.canonical.x<=o[e.canonical.z].maxTileX&&e.canonical.y>=o[e.canonical.z].minTileY&&e.canonical.y<=o[e.canonical.z].maxTileY}}class zt{constructor(e,o,f){this._meshCache={},this.painter=e,this.sourceCache=new Zo(o),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,o,f,y=c.$){var T;if(!(o>=0&&o<y&&f>=0&&f<y))return 0;const E=this.getTerrainData(e),k=(T=E.tile)===null||T===void 0?void 0:T.dem;if(!k)return 0;const I=c.cs([],[o/y*c.$,f/y*c.$],E.u_terrain_matrix),O=[I[0]*k.dim,I[1]*k.dim],j=Math.floor(O[0]),Z=Math.floor(O[1]),U=O[0]-j,Y=O[1]-Z;return k.get(j,Z)*(1-U)*(1-Y)+k.get(j+1,Z)*U*(1-Y)+k.get(j,Z+1)*(1-U)*Y+k.get(j+1,Z+1)*U*Y}getElevationForLngLatZoom(e,o){if(!c.ct(o,e.wrap()))return 0;const{tileID:f,mercatorX:y,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(e,o);return this.getElevation(f,y%c.$,T%c.$,c.$)}getElevation(e,o,f,y=c.$){return this.getDEMElevation(e,o,f,y)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const y=this.painter.context,T=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(y,T,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(y,new c.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const o=this.sourceCache.getSourceTile(e,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const y=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new c.T(y,o.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),o.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const f=o&&o+o.tileID.key+e.key;if(f&&!this._demMatrixCache[f]){const y=this.sourceCache.sourceCache._source.maxzoom;let T=e.canonical.z-o.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=y?T=e.canonical.z-y:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=e.canonical.x-(e.canonical.x>>T<<T),k=e.canonical.y-(e.canonical.y>>T<<T),I=c.cu(new Float64Array(16),[1/(c.$<<T),1/(c.$<<T),0]);c.M(I,I,[E*c.$,k*c.$,0]),this._demMatrixCache[e.key]={matrix:I,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(e){const o=this.painter,f=o.width/devicePixelRatio,y=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(f,y,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,f,y))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,E=0;T<this._coordsTextureSize;T++)for(let k=0;k<this._coordsTextureSize;k++,E+=4)o[E+0]=255&k,o[E+1]=255&T,o[E+2]=k>>8<<4|T>>8,o[E+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),y=new c.T(e,f,e.gl.RGBA,{premultiply:!1});return y.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),f=this.painter.context,y=f.gl,T=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(T,k-E-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null);const I=o[0]+(o[2]>>4<<8),O=o[1]+((15&o[2])<<8),j=this.coordsIndex[255-o[3]],Z=j&&this.sourceCache.getTileByID(j);if(!Z)return null;const U=this._coordsTextureSize,Y=(1<<Z.tileID.canonical.z)*U;return new c.a1((Z.tileID.canonical.x*U+I)/Y+Z.tileID.wrap,(Z.tileID.canonical.y*U+O)/Y,this.getElevation(Z.tileID,I,O,U))}depthAtPoint(e){const o=new Uint8Array(4),f=this.painter.context,y=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),y.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(e){var o;const f=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,y=f&&e.canonical.y===0,T=f&&e.canonical.y===(1<<e.canonical.z)-1,E=`m_${y?"n":""}_${T?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const k=this.painter.context,I=new c.cv,O=new c.aN,j=this.meshSize,Z=c.$/j,U=j*j;for(let ge=0;ge<=j;ge++)for(let De=0;De<=j;De++)I.emplaceBack(De*Z,ge*Z,0);for(let ge=0;ge<U;ge+=j+1)for(let De=0;De<j;De++)O.emplaceBack(De+ge,j+De+ge+1,j+De+ge+2),O.emplaceBack(De+ge,j+De+ge+2,De+ge+1);const Y=I.length,Q=Y+(j+1),le=(j+1)*j,oe=y?c.bh:0,ue=y?0:1,he=T?c.bi:c.$,ye=T?0:1;for(let ge=0;ge<=j;ge++)I.emplaceBack(ge*Z,oe,ue);for(let ge=0;ge<=j;ge++)I.emplaceBack(ge*Z,he,ye);for(let ge=0;ge<j;ge++)O.emplaceBack(le+ge,Q+ge,Q+ge+1),O.emplaceBack(le+ge,Q+ge+1,le+ge+1),O.emplaceBack(0+ge,Y+ge+1,Y+ge),O.emplaceBack(0+ge,0+ge+1,Y+ge+1);const me=I.length,xe=me+2*(j+1);for(const ge of[0,1])for(let De=0;De<=j;De++)for(const qe of[0,1])I.emplaceBack(ge*c.$,De*Z,qe);for(let ge=0;ge<2*j;ge+=2)O.emplaceBack(me+ge,me+ge+1,me+ge+3),O.emplaceBack(me+ge,me+ge+3,me+ge+2),O.emplaceBack(xe+ge,xe+ge+3,xe+ge+1),O.emplaceBack(xe+ge,xe+ge+2,xe+ge+3);const Ee=new ll(k.createVertexBuffer(I,Fa.members),k.createIndexBuffer(O),c.aM.simpleSegment(0,0,I.length,O.length));return this._meshCache[E]=Ee,Ee}getMeshFrameDelta(e){return 2*Math.PI*c.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,o){var f;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(e,o);return(f=this.getMinMaxElevation(y).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(e){const o=this.getTerrainData(e).tile,f={minElevation:null,maxElevation:null};return o&&o.dem&&(f.minElevation=o.dem.min*this.exaggeration,f.maxElevation=o.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(e,o){const f=c.a1.fromLngLat(e.wrap()),y=(1<<o)*c.$,T=f.x*y,E=f.y*y,k=Math.floor(T/c.$),I=Math.floor(E/c.$);return{tileID:new c.Z(o,0,o,k,I),mercatorX:T,mercatorY:E}}}class $t{constructor(e,o,f){this._context=e,this._size=o,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(f.texture),{id:e,fbo:o,texture:f,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>e.id!==o),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Ua={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Tl{constructor(e,o){this.painter=e,this.terrain=o,this.pool=new $t(e.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(f=>!e._layers[f].isHidden(o)),this._coordsAscending={};for(const f in e.sourceCaches){this._coordsAscending[f]={};const y=e.sourceCaches[f].getVisibleCoordinates(),T=e.sourceCaches[f].getSource(),E=T instanceof ka?T.terrainTileRanges:null;for(const k of y){const I=this.terrain.sourceCache.getTerrainCoords(k,E);for(const O in I)this._coordsAscending[f][O]||(this._coordsAscending[f][O]=[]),this._coordsAscending[f][O].push(I[O])}}this._coordsAscendingStr={};for(const f of e._order){const y=e._layers[f],T=y.source;if(Ua[y.type]&&!this._coordsAscendingStr[T]){this._coordsAscendingStr[T]={};for(const E in this._coordsAscending[T])this._coordsAscendingStr[T][E]=this._coordsAscending[T][E].map(k=>k.key).sort().join()}}for(const f of this._renderableTiles)for(const y in this._coordsAscendingStr){const T=this._coordsAscendingStr[y][f.tileID.key];T&&T!==f.rttCoords[y]&&(f.rtt=[])}}renderLayer(e,o){if(e.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),y=e.type,T=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Ua[y]&&(this._prevType&&Ua[this._prevType]||this._stacks.push([]),this._prevType=y,this._stacks[this._stacks.length-1].push(e.id),!E))return!0;if(Ua[this._prevType]||Ua[y]&&E){this._prevType=y;const k=this._stacks.length-1,I=this._stacks[k]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(fh(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[k]){const Z=this.pool.getObjectForId(O.rtt[k].id);if(Z.stamp===O.rtt[k].stamp){this.pool.useObject(Z);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),O.rtt[k]={id:j.id,stamp:j.stamp},T.context.bindFramebuffer.set(j.fbo.framebuffer),T.context.clear({color:c.bf.transparent,stencil:0}),T.currentStencilSource=void 0;for(let Z=0;Z<I.length;Z++){const U=T.style._layers[I[Z]],Y=U.source?this._coordsAscending[U.source][O.tileID.key]:[O.tileID];T.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),T._renderTileClippingMasks(U,Y,!0),T.renderLayer(T,T.style.sourceCaches[U.source],U,Y,f),U.source&&(O.rttCoords[U.source]=this._coordsAscendingStr[U.source][O.tileID.key])}}return fh(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),Ua[y]}return!1}}const Dd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ln=C,bh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:go,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Va={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Hp{constructor(e,o,f=!1){this.mousedown=T=>{this.startMove(T,G.mousePos(this.element,T)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.move(T,G.mousePos(this.element,T))},this.mouseup=T=>{this._rotatePitchHandler.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,T.targetTouches)[0],this.startMove(T,this._startPos),G.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,T.targetTouches)[0],this.move(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const y=new Ad;this._rotatePitchHandler=new eu({clickTolerance:3,move:(T,E)=>{const k=o.getBoundingClientRect(),I=new c.P((k.bottom-k.top)/2,(k.right-k.left)/2);return{bearingDelta:c.cn(new c.P(T.x,E.y),E,I),pitchDelta:f?-.5*(E.y-T.y):void 0}},moveStateManager:y,enable:!0,assignEvents:()=>{}}),this.map=e,G.addEventListener(o,"mousedown",this.mousedown),G.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(o,"touchcancel",this.reset)}startMove(e,o){this._rotatePitchHandler.dragStart(e,o),G.disableDrag()}move(e,o){const f=this.map,{bearingDelta:y,pitchDelta:T}=this._rotatePitchHandler.dragMove(e,o)||{};y&&f.setBearing(f.getBearing()+y),T&&f.setPitch(f.getPitch()+T)}off(){const e=this.element;G.removeEventListener(e,"mousedown",this.mousedown),G.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend),G.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend)}}let os;function Pi(b,e,o,f=!1){if(f||!o.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const y=new c.S(b.lng,b.lat);if(b=new c.S(b.lng,b.lat),e){const T=new c.S(b.lng-360,b.lat),E=new c.S(b.lng+360,b.lat),k=o.locationToScreenPoint(b).distSqr(e);o.locationToScreenPoint(T).distSqr(e)<k?b=T:o.locationToScreenPoint(E).distSqr(e)<k&&(b=E)}for(;Math.abs(b.lng-o.center.lng)>180;){const T=o.locationToScreenPoint(b);if(T.x>=0&&T.y>=0&&T.x<=o.width&&T.y<=o.height)break;b.lng>o.center.lng?b.lng-=360:b.lng+=360}return b.lng!==y.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(b))?b:y}const Ei={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xh(b,e,o){const f=b.classList;for(const y in Ei)f.remove(`maplibregl-${o}-anchor-${y}`);f.add(`maplibregl-${o}-anchor-${e}`)}class $o extends c.E{constructor(e){if(super(),this._onKeyPress=o=>{const f=o.code,y=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=o=>{const f=o.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=Pi(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${Ei[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${y}`),V.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div");const o=G.createNS("http://www.w3.org/2000/svg","svg"),f=41,y=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${f}px`),o.setAttributeNS(null,"width",`${y}px`),o.setAttributeNS(null,"viewBox",`0 0 ${y} ${f}`);const T=G.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const E=G.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const k=G.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of I){const he=G.createNS("http://www.w3.org/2000/svg","ellipse");he.setAttributeNS(null,"opacity","0.04"),he.setAttributeNS(null,"cx","10.5"),he.setAttributeNS(null,"cy","5.80029008"),he.setAttributeNS(null,"rx",ue.rx),he.setAttributeNS(null,"ry",ue.ry),k.appendChild(he)}const O=G.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const j=G.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(j);const Z=G.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"opacity","0.25"),Z.setAttributeNS(null,"fill","#000000");const U=G.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Z.appendChild(U);const Y=G.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const Q=G.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=G.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const oe=G.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),Q.appendChild(le),Q.appendChild(oe),E.appendChild(k),E.appendChild(O),E.appendChild(Z),E.appendChild(Y),E.appendChild(Q),o.appendChild(E),o.setAttributeNS(null,"height",f*this._scale+"px"),o.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(o),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),xh(this._element,this._anchor,"marker"),e&&e.className)for(const o of e.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const y=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var o,f;const y=(o=this._map)===null||o===void 0?void 0:o.terrain,T=this._map.transform.isLocationOccluded(this._lngLat);if(!y||T){const Y=T?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,k=E.terrain.depthAtPoint(this._pos),I=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,I)-k<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/E.transform.pixelsPerMeter,j=Math.sin(E.getPitch()*Math.PI/180)*O,Z=E.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),U=E.transform.lngLatToCameraDepth(this._lngLat,I+j)-Z>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,o){return(this._opacity===void 0||e===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const Lr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ai=0,Yo=!1;const uc={maxWidth:100,unit:"metric"};function qo(b,e,o){const f=o&&o.maxWidth||100,y=b._container.clientHeight/2,T=b._container.clientWidth/2,E=b.unproject([T-f/2,y]),k=b.unproject([T+f/2,y]),I=Math.round(b.project(k).x-b.project(E).x),O=Math.min(f,I,b._container.clientWidth),j=E.distanceTo(k);if(o&&o.unit==="imperial"){const Z=3.2808*j;Z>5280?Ho(e,O,Z/5280,b._getUIString("ScaleControl.Miles")):Ho(e,O,Z,b._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ho(e,O,j/1852,b._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Ho(e,O,j/1e3,b._getUIString("ScaleControl.Kilometers")):Ho(e,O,j,b._getUIString("ScaleControl.Meters"))}function Ho(b,e,o,f){const y=function(T){const E=Math.pow(10,`${Math.floor(T)}`.length-1);let k=T/E;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(I){const O=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*O)/O}(k),E*k}(o);b.style.width=e*(y/o)+"px",b.innerHTML=`${y}&nbsp;${f}`}const Is={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},ou=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lu(b){if(b){if(typeof b=="number"){const e=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-b),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const e=c.P.convert(b);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return lu(new c.P(0,0))}const wh=C;v.AJAXError=c.cz,v.Event=c.l,v.Evented=c.E,v.LngLat=c.S,v.MercatorCoordinate=c.a1,v.Point=c.P,v.addProtocol=c.cA,v.config=c.a,v.removeProtocol=c.cB,v.AttributionControl=wn,v.BoxZoomHandler=sc,v.CanvasSource=Fr,v.CooperativeGesturesHandler=Bf,v.DoubleClickZoomHandler=lc,v.DragPanHandler=au,v.DragRotateHandler=cc,v.EdgeInsets=No,v.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var e;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=o?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=Ka,v.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const o=new c.S(e.coords.longitude,e.coords.latitude),f=e.coords.accuracy,y=this._map.getBearing(),T=c.e({bearing:y},this.options.fitBoundsOptions),E=Yn.fromLngLat(o,f);this._map.fitBounds(E,T,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const o=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Yo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $o({element:this._dotElement}),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $o({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{const f=o?.[0]instanceof ResizeObserverEntry;o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},Lr,b)}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(os!==void 0&&!e)return os;if(window.navigator.permissions===void 0)return os=!!window.navigator.geolocation,os;try{os=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{os=!!window.navigator.geolocation}return os})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ai=0,Yo=!1}_isOutOfMapMaxBounds(b){const e=this._map.getMaxBounds(),o=b.coords;return e&&(o.longitude<e.getWest()||o.longitude>e.getEast()||o.latitude<e.getSouth()||o.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;const e=this._map.project(b),o=this._map.unproject([e.x+100,e.y]),f=b.distanceTo(o)/100,y=2*this._accuracy/f;this._circleElement.style.width=`${y.toFixed(2)}px`,this._circleElement.style.height=`${y.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ai--,Yo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ai++,Ai>1?(b={maximumAge:6e5,timeout:0},Yo=!0):(b=this.options.positionOptions,Yo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const e=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=G.create("button","maplibregl-ctrl-globe",this._container),G.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},v.Hash=rs,v.ImageSource=ka,v.KeyboardHandler=Rs,v.LngLatBounds=Yn,v.LogoControl=Qn,v.Map=class extends vh{constructor(b){var e,o;c.cw.mark(c.cx.create);const f=Object.assign(Object.assign(Object.assign({},bh),b),{canvasContextAttributes:Object.assign(Object.assign({},bh.canvasContextAttributes),b.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const y=new Vn,T=new Fi;if(f.minZoom!==void 0&&y.setMinZoom(f.minZoom),f.maxZoom!==void 0&&y.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&y.setMinPitch(f.minPitch),f.maxPitch!==void 0&&y.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&y.setRenderWorldCopies(f.renderWorldCopies),super(y,T,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new lr,this._controls=[],this._mapId=c.a7(),this._contextLost=k=>{k.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:k}))},this._contextRestored=k=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:k}))},this._onMapScroll=k=>{if(k.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Dd),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=He.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ve(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let k=!1;const I=Ba(O=>{this._trackResize&&!this._removed&&(this.resize(O),this.redraw())},50);this._resizeObserver=new ResizeObserver(O=>{k?I(O):k=!0}),this._resizeObserver.observe(this._container)}this.handlers=new su(this,f),this._hash=f.hash&&new rs(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.e({},f.fitBoundsOptions,{duration:0}))));const E=typeof f.style=="string"||((o=(e=f.style)===null||e===void 0?void 0:e.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new wn(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Qn,f.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const k=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(k)}}),this.on("data",k=>{this._update(k.dataType==="style"),this.fire(new c.l(`${k.dataType}data`,k))}),this.on("dataloading",k=>{this.fire(new c.l(`${k.dataType}dataloading`,k))}),this.on("dataabort",k=>{this.fire(new c.l("sourcedataabort",k))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,e){return this.style.setGlobalStateProperty(b,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,e){if(e===void 0&&(e=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=b.onAdd(this);this._controls.push(b);const f=this._controlPositions[e];return e.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(b);return e>-1&&this._controls.splice(e,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return Pe(this.transform,b)}calculateCameraOptionsFromTo(b,e,o,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,e,o,f)}resize(b,e=!0){const[o,f]=this._containerDimensions(),y=this._getClampedPixelRatio(o,f);if(this._resizeCanvas(o,f,y),this.painter.resize(o,f,y),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const k=this._getClampedPixelRatio(o,f);this._resizeCanvas(o,f,k),this.painter.resize(o,f,k)}this._resizeTransform(e);const T=!this._moving;return T&&(this.stop(),this.fire(new c.l("movestart",b)).fire(new c.l("move",b))),this.fire(new c.l("resize",b)),T&&this.fire(new c.l("moveend",b)),this}_resizeTransform(b=!0){var e;const[o,f]=this._containerDimensions();this.transform.resize(o,f,b),(e=this._requestedCameraState)===null||e===void 0||e.resize(o,f,b)}_getClampedPixelRatio(b,e){const{0:o,1:f}=this._maxCanvasSize,y=this.getPixelRatio(),T=b*y,E=e*y;return Math.min(T>o?o/T:1,E>f?f/E:1)*y}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Yn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,e,o){if(b==="mouseenter"||b==="mouseover"){let f=!1;return{layers:e,listener:o,delegates:{mousemove:T=>{const E=e.filter(I=>this.getLayer(I)),k=E.length!==0?this.queryRenderedFeatures(T.point,{layers:E}):[];k.length?f||(f=!0,o.call(this,new da(b,this,T.originalEvent,{features:k}))):f=!1},mouseout:()=>{f=!1}}}}if(b==="mouseleave"||b==="mouseout"){let f=!1;return{layers:e,listener:o,delegates:{mousemove:E=>{const k=e.filter(I=>this.getLayer(I));(k.length!==0?this.queryRenderedFeatures(E.point,{layers:k}):[]).length?f=!0:f&&(f=!1,o.call(this,new da(b,this,E.originalEvent)))},mouseout:E=>{f&&(f=!1,o.call(this,new da(b,this,E.originalEvent)))}}}}{const f=y=>{const T=e.filter(k=>this.getLayer(k)),E=T.length!==0?this.queryRenderedFeatures(y.point,{layers:T}):[];E.length&&(y.features=E,o.call(this,y),delete y.features)};return{layers:e,listener:o,delegates:{[b]:f}}}}_saveDelegatedListener(b,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(e)}_removeDelegatedListener(b,e,o){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const f=this._delegatedListeners[b];for(let y=0;y<f.length;y++){const T=f[y];if(T.listener===o&&T.layers.length===e.length&&T.layers.every(E=>e.includes(E))){for(const E in T.delegates)this.off(E,T.delegates[E]);return void f.splice(y,1)}}}on(b,e,o){if(o===void 0)return super.on(b,e);const f=typeof e=="string"?[e]:e,y=this._createDelegatedListener(b,f,o);this._saveDelegatedListener(b,y);for(const T in y.delegates)this.on(T,y.delegates[T]);return{unsubscribe:()=>{this._removeDelegatedListener(b,f,o)}}}once(b,e,o){if(o===void 0)return super.once(b,e);const f=typeof e=="string"?[e]:e,y=this._createDelegatedListener(b,f,o);for(const T in y.delegates){const E=y.delegates[T];y.delegates[T]=(...k)=>{this._removeDelegatedListener(b,f,o),E(...k)}}this._saveDelegatedListener(b,y);for(const T in y.delegates)this.once(T,y.delegates[T]);return this}off(b,e,o){return o===void 0?super.off(b,e):(this._removeDelegatedListener(b,typeof e=="string"?[e]:e,o),this)}queryRenderedFeatures(b,e){if(!this.style)return[];let o;const f=b instanceof c.P||Array.isArray(b),y=f?b:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(f?{}:b)||{},y instanceof c.P||typeof y[0]=="number")o=[c.P.convert(y)];else{const T=c.P.convert(y[0]),E=c.P.convert(y[1]);o=[T,new c.P(E.x,T.y),E,new c.P(T.x,E.y),T]}return this.style.queryRenderedFeatures(o,e,this.transform)}querySourceFeatures(b,e){return this.style.querySourceFeatures(b,e)}setStyle(b,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(b,e))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const e=this._locale[b];if(e==null)throw new Error(`Missing UI string '${b}'`);return e}_updateStyle(b,e){var o,f;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,e));const y=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Tf(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,e,y):this.style.loadJSON(b,e,y),this):((f=(o=this.style)===null||o===void 0?void 0:o.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Tf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,e){if(typeof b=="string"){const o=this._requestManager.transformRequest(b,"Style");c.j(o,new AbortController).then(f=>{this._updateDiff(f.data,e)}).catch(f=>{f&&this.fire(new c.k(f))})}else typeof b=="object"&&this._updateDiff(b,e)}_updateDiff(b,e){try{this.style.setState(b,e)&&this._update(!0)}catch(o){c.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(b,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,e){return this._lazyInitEmptyStyle(),this.style.addSource(b,e),this._update(!0)}isSourceLoaded(b){const e=this.style&&this.style.sourceCaches[b];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const e=this.style.sourceCaches[b.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&e.reload();for(const o in this.style._layers){const f=this.style._layers[o];f.type==="hillshade"&&f.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===b.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new zt(this.painter,e,b),this.painter.renderToTexture=new Tl(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{var f;o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=o.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:b})),this}getTerrain(){var b,e;return(e=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const e in b){const o=b[e]._tiles;for(const f in o){const y=o[f];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,e,o){if(o){const f=this.getSource(o);if(!f)throw new Error(`There is no source with ID "${o}", cannot set LOD parameters`);f.calculateTileZoom=ht(Math.max(1,b),Math.max(1,e))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=ht(Math.max(1,b),Math.max(1,e));return this._update(!0),this}refreshTiles(b,e){const o=this.style.sourceCaches[b];if(!o)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);e===void 0?o.reload(!0):o.refreshTiles(e.map(f=>new c.a4(f.z,f.x,f.y)))}addImage(b,e,o={}){const{pixelRatio:f=1,sdf:y=!1,stretchX:T,stretchY:E,content:k,textFitWidth:I,textFitHeight:O}=o;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:Z,data:U}=e,Y=e;return this.style.addImage(b,{data:new c.R({width:j,height:Z},new Uint8Array(U)),pixelRatio:f,stretchX:T,stretchY:E,content:k,textFitWidth:I,textFitHeight:O,sdf:y,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,b),this}}{const{width:j,height:Z,data:U}=V.getImageData(e);this.style.addImage(b,{data:new c.R({width:j,height:Z},U),pixelRatio:f,stretchX:T,stretchY:E,content:k,textFitWidth:I,textFitHeight:O,sdf:y,version:0})}}updateImage(b,e){const o=this.style.getImage(b);if(!o)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=e instanceof HTMLImageElement||c.b(e)?V.getImageData(e):e,{width:y,height:T,data:E}=f;if(y===void 0||T===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==o.data.width||T!==o.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(e instanceof HTMLImageElement||c.b(e));return o.data.replace(E,k),this.style.updateImage(b,o),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return He.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,e){return this._lazyInitEmptyStyle(),this.style.addLayer(b,e),this._update(!0)}moveLayer(b,e){return this.style.moveLayer(b,e),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,e,o){return this.style.setLayerZoomRange(b,e,o),this._update(!0)}setFilter(b,e,o={}){return this.style.setFilter(b,e,o),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,e,o,f={}){return this.style.setPaintProperty(b,e,o,f),this._update(!0)}getPaintProperty(b,e){return this.style.getPaintProperty(b,e)}setLayoutProperty(b,e,o,f={}){return this.style.setLayoutProperty(b,e,o,f),this._update(!0)}getLayoutProperty(b,e){return this.style.getLayoutProperty(b,e)}setGlyphs(b,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,e,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,e,o,f=>{f||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,e,o=>{o||this._update(!0)}),this}setLight(b,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,e){return this.style.setFeatureState(b,e),this._update()}removeFeatureState(b,e){return this.style.removeFeatureState(b,e),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,e=0;return this._container&&(b=this._container.clientWidth||400,e=this._container.clientHeight||300),[b,e]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const e=this._canvasContainer=G.create("div","maplibregl-canvas-container",b);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),f=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],f);const y=this._controlContainer=G.create("div","maplibregl-control-container",b),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{T[E]=G.create("div",`maplibregl-ctrl-${E} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,e,o){this._canvas.width=Math.floor(o*b),this._canvas.height=Math.floor(o*e),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{e={requestedAttributes:b},f&&(e.statusMessage=f.statusMessage,e.type=f.type)},{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!o){const f="Failed to initialize WebGL";throw e?(e.message=f,new Error(JSON.stringify(e))):new Error(f)}this.painter=new wd(o,this.transform),re.testSupport(o)}migrateProjection(b,e){super.migrateProjection(b,e),this.painter.transform=b,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var e,o,f,y,T;const E=this._idleTriggered?this._fadeDuration:0,k=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Z=this.transform.zoom,U=V.now();this.style.zoomHistory.update(Z,U);const Y=new c.F(Z,{now:U,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Q=Y.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(I=!0,this._crossFadingFactor=Q),this.style.update(Y)}const O=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==k;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((y=this.style.projection)===null||y===void 0?void 0:y.transitionState,(T=this.style.projection)===null||T===void 0?void 0:T.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||O)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,O),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),He.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,V.frame(this._frameRequest,b=>{c.cw.frame(b),this._frameRequest=null;try{this._render(b)}catch(e){if(!c.cy(e)&&!function(o){return o.message===ch}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Ln}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},v.MapMouseEvent=da,v.MapTouchEvent=Jc,v.MapWheelEvent=zf,v.Marker=$o,v.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const e=this._map.getZoom(),o=e===this._map.getMaxZoom(),f=e===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,o)=>{const f=this._map._getUIString(`NavigationControl.${o}`);e.title=f,e.setAttribute("aria-label",f)},this.options=c.e({},Va,b),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,e){const o=G.create("button",b,this._container);return o.type="button",o.addEventListener("click",e),o}},v.Popup=class extends c.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=G.create("div","maplibregl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Pi(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const o=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const y=lu(this.options.offset);if(!f){const E=this._container.offsetWidth,k=this._container.offsetHeight;let I;I=o.y+y.bottom.y<k?["top"]:o.y>this._map.transform.height-k?["bottom"]:[],o.x<E/2?I.push("left"):o.x>this._map.transform.width-E/2&&I.push("right"),f=I.length===0?"bottom":I.join("-")}let T=o.add(y[f]);this.options.subpixelPositioning||(T=T.round()),G.setTransform(this._container,`${Ei[f]} translate(${T.x}px,${T.y}px)`),xh(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Is),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const e=document.createDocumentFragment(),o=document.createElement("body");let f;for(o.innerHTML=b;f=o.firstChild,f;)e.appendChild(f);return this.setDOMContent(e)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(ou);b&&b.focus()}},v.RasterDEMTileSource=Li,v.RasterTileSource=Br,v.ScaleControl=class{constructor(b){this._onMove=()=>{qo(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,qo(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},uc),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Go,v.Style=Tf,v.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=yh,v.TwoFingersTouchRotateHandler=oc,v.TwoFingersTouchZoomHandler=gh,v.TwoFingersTouchZoomRotateHandler=jf,v.VectorTileSource=Nn,v.VideoSource=oa,v.addSourceType=(b,e)=>c._(void 0,void 0,void 0,function*(){if(Ja(b))throw new Error(`A source type called "${b}" already exists.`);((o,f)=>{ws[o]=f})(b,e)}),v.clearPrewarmedResources=function(){const b=bt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(be),bt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.createTileMesh=bf,v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return Oi().getRTLTextPluginStatus()},v.getVersion=function(){return wh},v.getWorkerCount=function(){return et.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(b){return wi().broadcast("IS",b)},v.prewarm=function(){Xt().acquire(be)},v.setMaxParallelImageRequests=function(b){c.a.MAX_PARALLEL_IMAGE_REQUESTS=b},v.setRTLTextPlugin=function(b,e){return Oi().setRTLTextPlugin(b,e)},v.setWorkerCount=function(b){et.workerCount=b},v.setWorkerUrl=function(b){c.a.WORKER_URL=b}});var _=l;return _})}(R0)),R0.exports}var s2=rA();const o2=Sp(s2),l2=gE({__proto__:null,default:o2},[s2]),aA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",sA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class Qm extends Error{response;request;constructor(n,l){const d=`${Qm.extractMessage(n)}: ${JSON.stringify({response:n,request:l})}`;super(d),Object.setPrototypeOf(this,Qm.prototype),this.response=n,this.request=l,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Qm)}static extractMessage(n){return n.errors?.[0]?.message??`GraphQL Error (Code: ${String(n.status)})`}}const b1=i=>i.toUpperCase(),Wv=i=>typeof i=="function"?i():i,c2=(i,n)=>i.map((l,d)=>[l,n[d]]),Fm=i=>{let n={};return i instanceof Headers?n=oA(i):Array.isArray(i)?i.forEach(([l,d])=>{l&&d!==void 0&&(n[l]=d)}):i&&(n=i),n},oA=i=>{const n={};return i.forEach((l,d)=>{n[d]=l}),n},lA=i=>{try{const n=i();return cA(n)?n.catch(l=>x1(l)):n}catch(n){return x1(n)}},x1=i=>i instanceof Error?i:new Error(String(i)),cA=i=>typeof i=="object"&&i!==null&&"then"in i&&typeof i.then=="function"&&"catch"in i&&typeof i.catch=="function"&&"finally"in i&&typeof i.finally=="function",sx=i=>{throw new Error(`Unhandled case: ${String(i)}`)},I0=i=>typeof i=="object"&&i!==null&&!Array.isArray(i),uA=(i,n)=>i.documents?i:{documents:i,requestHeaders:n,signal:void 0},hA=(i,n,l)=>i.query?i:{query:i,variables:n,requestHeaders:l,signal:void 0};function pi(i,n){if(!!!i)throw new Error(n)}function td(i){return typeof i=="object"&&i!==null}function nv(i,n){if(!!!i)throw new Error(n??"Unexpected invariant triggered.")}const dA=/\r\n|[\n\r]/g;function bb(i,n){let l=0,d=1;for(const m of i.body.matchAll(dA)){if(typeof m.index=="number"||nv(!1),m.index>=n)break;l=m.index+m[0].length,d+=1}return{line:d,column:n+1-l}}function fA(i){return u2(i.source,bb(i.source,i.start))}function u2(i,n){const l=i.locationOffset.column-1,d="".padStart(l)+i.body,m=n.line-1,_=i.locationOffset.line-1,v=n.line+_,c=n.line===1?l:0,C=n.column+c,R=`${i.name}:${v}:${C}
`,z=d.split(/\r\n|[\n\r]/g),B=z[m];if(B.length>120){const V=Math.floor(C/80),G=C%80,re=[];for(let fe=0;fe<B.length;fe+=80)re.push(B.slice(fe,fe+80));return R+w1([[`${v} |`,re[0]],...re.slice(1,V+1).map(fe=>["|",fe]),["|","^".padStart(G)],["|",re[V+1]]])}return R+w1([[`${v-1} |`,z[m-1]],[`${v} |`,B],["|","^".padStart(C)],[`${v+1} |`,z[m+1]]])}function w1(i){const n=i.filter(([d,m])=>m!==void 0),l=Math.max(...n.map(([d])=>d.length));return n.map(([d,m])=>d.padStart(l)+(m?" "+m:"")).join(`
`)}function pA(i){const n=i[0];return n==null||"kind"in n||"length"in n?{nodes:n,source:i[1],positions:i[2],path:i[3],originalError:i[4],extensions:i[5]}:n}class bi extends Error{constructor(n,...l){var d,m,_;const{nodes:v,source:c,positions:C,path:R,originalError:z,extensions:B}=pA(l);super(n),this.name="GraphQLError",this.path=R??void 0,this.originalError=z??void 0,this.nodes=T1(Array.isArray(v)?v:v?[v]:void 0);const V=T1((d=this.nodes)===null||d===void 0?void 0:d.map(re=>re.loc).filter(re=>re!=null));this.source=c??(V==null||(m=V[0])===null||m===void 0?void 0:m.source),this.positions=C??V?.map(re=>re.start),this.locations=C&&c?C.map(re=>bb(c,re)):V?.map(re=>bb(re.source,re.start));const G=td(z?.extensions)?z?.extensions:void 0;this.extensions=(_=B??G)!==null&&_!==void 0?_:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),z!=null&&z.stack?Object.defineProperty(this,"stack",{value:z.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,bi):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let n=this.message;if(this.nodes)for(const l of this.nodes)l.loc&&(n+=`

`+fA(l.loc));else if(this.source&&this.locations)for(const l of this.locations)n+=`

`+u2(this.source,l);return n}toJSON(){const n={message:this.message};return this.locations!=null&&(n.locations=this.locations),this.path!=null&&(n.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(n.extensions=this.extensions),n}}function T1(i){return i===void 0||i.length===0?void 0:i}function Ca(i,n,l){return new bi(`Syntax Error: ${l}`,{source:i,positions:[n]})}class mA{constructor(n,l,d){this.start=n.start,this.end=l.end,this.startToken=n,this.endToken=l,this.source=d}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class h2{constructor(n,l,d,m,_,v){this.kind=n,this.start=l,this.end=d,this.line=m,this.column=_,this.value=v,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const d2={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},gA=new Set(Object.keys(d2));function S1(i){const n=i?.kind;return typeof n=="string"&&gA.has(n)}var Gh;(function(i){i.QUERY="query",i.MUTATION="mutation",i.SUBSCRIPTION="subscription"})(Gh||(Gh={}));var ei;(function(i){i.QUERY="QUERY",i.MUTATION="MUTATION",i.SUBSCRIPTION="SUBSCRIPTION",i.FIELD="FIELD",i.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",i.FRAGMENT_SPREAD="FRAGMENT_SPREAD",i.INLINE_FRAGMENT="INLINE_FRAGMENT",i.VARIABLE_DEFINITION="VARIABLE_DEFINITION",i.SCHEMA="SCHEMA",i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.FIELD_DEFINITION="FIELD_DEFINITION",i.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.ENUM_VALUE="ENUM_VALUE",i.INPUT_OBJECT="INPUT_OBJECT",i.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(ei||(ei={}));var kt;(function(i){i.NAME="Name",i.DOCUMENT="Document",i.OPERATION_DEFINITION="OperationDefinition",i.VARIABLE_DEFINITION="VariableDefinition",i.SELECTION_SET="SelectionSet",i.FIELD="Field",i.ARGUMENT="Argument",i.FRAGMENT_SPREAD="FragmentSpread",i.INLINE_FRAGMENT="InlineFragment",i.FRAGMENT_DEFINITION="FragmentDefinition",i.VARIABLE="Variable",i.INT="IntValue",i.FLOAT="FloatValue",i.STRING="StringValue",i.BOOLEAN="BooleanValue",i.NULL="NullValue",i.ENUM="EnumValue",i.LIST="ListValue",i.OBJECT="ObjectValue",i.OBJECT_FIELD="ObjectField",i.DIRECTIVE="Directive",i.NAMED_TYPE="NamedType",i.LIST_TYPE="ListType",i.NON_NULL_TYPE="NonNullType",i.SCHEMA_DEFINITION="SchemaDefinition",i.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",i.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",i.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",i.FIELD_DEFINITION="FieldDefinition",i.INPUT_VALUE_DEFINITION="InputValueDefinition",i.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",i.UNION_TYPE_DEFINITION="UnionTypeDefinition",i.ENUM_TYPE_DEFINITION="EnumTypeDefinition",i.ENUM_VALUE_DEFINITION="EnumValueDefinition",i.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",i.DIRECTIVE_DEFINITION="DirectiveDefinition",i.SCHEMA_EXTENSION="SchemaExtension",i.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",i.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",i.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",i.UNION_TYPE_EXTENSION="UnionTypeExtension",i.ENUM_TYPE_EXTENSION="EnumTypeExtension",i.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(kt||(kt={}));function xb(i){return i===9||i===32}function Qy(i){return i>=48&&i<=57}function f2(i){return i>=97&&i<=122||i>=65&&i<=90}function ox(i){return f2(i)||i===95}function p2(i){return f2(i)||Qy(i)||i===95}function yA(i){var n;let l=Number.MAX_SAFE_INTEGER,d=null,m=-1;for(let v=0;v<i.length;++v){var _;const c=i[v],C=_A(c);C!==c.length&&(d=(_=d)!==null&&_!==void 0?_:v,m=v,v!==0&&C<l&&(l=C))}return i.map((v,c)=>c===0?v:v.slice(l)).slice((n=d)!==null&&n!==void 0?n:0,m+1)}function _A(i){let n=0;for(;n<i.length&&xb(i.charCodeAt(n));)++n;return n}function vA(i,n){const l=i.replace(/"""/g,'\\"""'),d=l.split(/\r\n|[\n\r]/g),m=d.length===1,_=d.length>1&&d.slice(1).every(G=>G.length===0||xb(G.charCodeAt(0))),v=l.endsWith('\\"""'),c=i.endsWith('"')&&!v,C=i.endsWith("\\"),R=c||C,z=!m||i.length>70||R||_||v;let B="";const V=m&&xb(i.charCodeAt(0));return(z&&!V||_)&&(B+=`
`),B+=l,(z||R)&&(B+=`
`),'"""'+B+'"""'}var dt;(function(i){i.SOF="<SOF>",i.EOF="<EOF>",i.BANG="!",i.DOLLAR="$",i.AMP="&",i.PAREN_L="(",i.PAREN_R=")",i.SPREAD="...",i.COLON=":",i.EQUALS="=",i.AT="@",i.BRACKET_L="[",i.BRACKET_R="]",i.BRACE_L="{",i.PIPE="|",i.BRACE_R="}",i.NAME="Name",i.INT="Int",i.FLOAT="Float",i.STRING="String",i.BLOCK_STRING="BlockString",i.COMMENT="Comment"})(dt||(dt={}));class bA{constructor(n){const l=new h2(dt.SOF,0,0,0,0);this.source=n,this.lastToken=l,this.token=l,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let n=this.token;if(n.kind!==dt.EOF)do if(n.next)n=n.next;else{const l=wA(this,n.end);n.next=l,l.prev=n,n=l}while(n.kind===dt.COMMENT);return n}}function xA(i){return i===dt.BANG||i===dt.DOLLAR||i===dt.AMP||i===dt.PAREN_L||i===dt.PAREN_R||i===dt.SPREAD||i===dt.COLON||i===dt.EQUALS||i===dt.AT||i===dt.BRACKET_L||i===dt.BRACKET_R||i===dt.BRACE_L||i===dt.PIPE||i===dt.BRACE_R}function gg(i){return i>=0&&i<=55295||i>=57344&&i<=1114111}function iv(i,n){return m2(i.charCodeAt(n))&&g2(i.charCodeAt(n+1))}function m2(i){return i>=55296&&i<=56319}function g2(i){return i>=56320&&i<=57343}function pp(i,n){const l=i.source.body.codePointAt(n);if(l===void 0)return dt.EOF;if(l>=32&&l<=126){const d=String.fromCodePoint(l);return d==='"'?`'"'`:`"${d}"`}return"U+"+l.toString(16).toUpperCase().padStart(4,"0")}function aa(i,n,l,d,m){const _=i.line,v=1+l-i.lineStart;return new h2(n,l,d,_,v,m)}function wA(i,n){const l=i.source.body,d=l.length;let m=n;for(;m<d;){const _=l.charCodeAt(m);switch(_){case 65279:case 9:case 32:case 44:++m;continue;case 10:++m,++i.line,i.lineStart=m;continue;case 13:l.charCodeAt(m+1)===10?m+=2:++m,++i.line,i.lineStart=m;continue;case 35:return TA(i,m);case 33:return aa(i,dt.BANG,m,m+1);case 36:return aa(i,dt.DOLLAR,m,m+1);case 38:return aa(i,dt.AMP,m,m+1);case 40:return aa(i,dt.PAREN_L,m,m+1);case 41:return aa(i,dt.PAREN_R,m,m+1);case 46:if(l.charCodeAt(m+1)===46&&l.charCodeAt(m+2)===46)return aa(i,dt.SPREAD,m,m+3);break;case 58:return aa(i,dt.COLON,m,m+1);case 61:return aa(i,dt.EQUALS,m,m+1);case 64:return aa(i,dt.AT,m,m+1);case 91:return aa(i,dt.BRACKET_L,m,m+1);case 93:return aa(i,dt.BRACKET_R,m,m+1);case 123:return aa(i,dt.BRACE_L,m,m+1);case 124:return aa(i,dt.PIPE,m,m+1);case 125:return aa(i,dt.BRACE_R,m,m+1);case 34:return l.charCodeAt(m+1)===34&&l.charCodeAt(m+2)===34?DA(i,m):EA(i,m)}if(Qy(_)||_===45)return SA(i,m,_);if(ox(_))return kA(i,m);throw Ca(i.source,m,_===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:gg(_)||iv(l,m)?`Unexpected character: ${pp(i,m)}.`:`Invalid character: ${pp(i,m)}.`)}return aa(i,dt.EOF,d,d)}function TA(i,n){const l=i.source.body,d=l.length;let m=n+1;for(;m<d;){const _=l.charCodeAt(m);if(_===10||_===13)break;if(gg(_))++m;else if(iv(l,m))m+=2;else break}return aa(i,dt.COMMENT,n,m,l.slice(n+1,m))}function SA(i,n,l){const d=i.source.body;let m=n,_=l,v=!1;if(_===45&&(_=d.charCodeAt(++m)),_===48){if(_=d.charCodeAt(++m),Qy(_))throw Ca(i.source,m,`Invalid number, unexpected digit after 0: ${pp(i,m)}.`)}else m=Qv(i,m,_),_=d.charCodeAt(m);if(_===46&&(v=!0,_=d.charCodeAt(++m),m=Qv(i,m,_),_=d.charCodeAt(m)),(_===69||_===101)&&(v=!0,_=d.charCodeAt(++m),(_===43||_===45)&&(_=d.charCodeAt(++m)),m=Qv(i,m,_),_=d.charCodeAt(m)),_===46||ox(_))throw Ca(i.source,m,`Invalid number, expected digit but got: ${pp(i,m)}.`);return aa(i,v?dt.FLOAT:dt.INT,n,m,d.slice(n,m))}function Qv(i,n,l){if(!Qy(l))throw Ca(i.source,n,`Invalid number, expected digit but got: ${pp(i,n)}.`);const d=i.source.body;let m=n+1;for(;Qy(d.charCodeAt(m));)++m;return m}function EA(i,n){const l=i.source.body,d=l.length;let m=n+1,_=m,v="";for(;m<d;){const c=l.charCodeAt(m);if(c===34)return v+=l.slice(_,m),aa(i,dt.STRING,n,m+1,v);if(c===92){v+=l.slice(_,m);const C=l.charCodeAt(m+1)===117?l.charCodeAt(m+2)===123?AA(i,m):MA(i,m):CA(i,m);v+=C.value,m+=C.size,_=m;continue}if(c===10||c===13)break;if(gg(c))++m;else if(iv(l,m))m+=2;else throw Ca(i.source,m,`Invalid character within String: ${pp(i,m)}.`)}throw Ca(i.source,m,"Unterminated string.")}function AA(i,n){const l=i.source.body;let d=0,m=3;for(;m<12;){const _=l.charCodeAt(n+m++);if(_===125){if(m<5||!gg(d))break;return{value:String.fromCodePoint(d),size:m}}if(d=d<<4|Dy(_),d<0)break}throw Ca(i.source,n,`Invalid Unicode escape sequence: "${l.slice(n,n+m)}".`)}function MA(i,n){const l=i.source.body,d=E1(l,n+2);if(gg(d))return{value:String.fromCodePoint(d),size:6};if(m2(d)&&l.charCodeAt(n+6)===92&&l.charCodeAt(n+7)===117){const m=E1(l,n+8);if(g2(m))return{value:String.fromCodePoint(d,m),size:12}}throw Ca(i.source,n,`Invalid Unicode escape sequence: "${l.slice(n,n+6)}".`)}function E1(i,n){return Dy(i.charCodeAt(n))<<12|Dy(i.charCodeAt(n+1))<<8|Dy(i.charCodeAt(n+2))<<4|Dy(i.charCodeAt(n+3))}function Dy(i){return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:-1}function CA(i,n){const l=i.source.body;switch(l.charCodeAt(n+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Ca(i.source,n,`Invalid character escape sequence: "${l.slice(n,n+2)}".`)}function DA(i,n){const l=i.source.body,d=l.length;let m=i.lineStart,_=n+3,v=_,c="";const C=[];for(;_<d;){const R=l.charCodeAt(_);if(R===34&&l.charCodeAt(_+1)===34&&l.charCodeAt(_+2)===34){c+=l.slice(v,_),C.push(c);const z=aa(i,dt.BLOCK_STRING,n,_+3,yA(C).join(`
`));return i.line+=C.length-1,i.lineStart=m,z}if(R===92&&l.charCodeAt(_+1)===34&&l.charCodeAt(_+2)===34&&l.charCodeAt(_+3)===34){c+=l.slice(v,_),v=_+1,_+=4;continue}if(R===10||R===13){c+=l.slice(v,_),C.push(c),R===13&&l.charCodeAt(_+1)===10?_+=2:++_,c="",v=_,m=_;continue}if(gg(R))++_;else if(iv(l,_))_+=2;else throw Ca(i.source,_,`Invalid character within String: ${pp(i,_)}.`)}throw Ca(i.source,_,"Unterminated string.")}function kA(i,n){const l=i.source.body,d=l.length;let m=n+1;for(;m<d;){const _=l.charCodeAt(m);if(p2(_))++m;else break}return aa(i,dt.NAME,n,m,l.slice(n,m))}const RA=10,y2=2;function xn(i){return rv(i,[])}function rv(i,n){switch(typeof i){case"string":return JSON.stringify(i);case"function":return i.name?`[function ${i.name}]`:"[function]";case"object":return IA(i,n);default:return String(i)}}function IA(i,n){if(i===null)return"null";if(n.includes(i))return"[Circular]";const l=[...n,i];if(PA(i)){const d=i.toJSON();if(d!==i)return typeof d=="string"?d:rv(d,l)}else if(Array.isArray(i))return zA(i,l);return NA(i,l)}function PA(i){return typeof i.toJSON=="function"}function NA(i,n){const l=Object.entries(i);return l.length===0?"{}":n.length>y2?"["+LA(i)+"]":"{ "+l.map(([m,_])=>m+": "+rv(_,n)).join(", ")+" }"}function zA(i,n){if(i.length===0)return"[]";if(n.length>y2)return"[Array]";const l=Math.min(RA,i.length),d=i.length-l,m=[];for(let _=0;_<l;++_)m.push(rv(i[_],n));return d===1?m.push("... 1 more item"):d>1&&m.push(`... ${d} more items`),"["+m.join(", ")+"]"}function LA(i){const n=Object.prototype.toString.call(i).replace(/^\[object /,"").replace(/]$/,"");if(n==="Object"&&typeof i.constructor=="function"){const l=i.constructor.name;if(typeof l=="string"&&l!=="")return l}return n}const OA=globalThis.process&&!0,Fu=OA?function(n,l){return n instanceof l}:function(n,l){if(n instanceof l)return!0;if(typeof n=="object"&&n!==null){var d;const m=l.prototype[Symbol.toStringTag],_=Symbol.toStringTag in n?n[Symbol.toStringTag]:(d=n.constructor)===null||d===void 0?void 0:d.name;if(m===_){const v=xn(n);throw new Error(`Cannot use ${m} "${v}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class _2{constructor(n,l="GraphQL request",d={line:1,column:1}){typeof n=="string"||pi(!1,`Body must be a string. Received: ${xn(n)}.`),this.body=n,this.name=l,this.locationOffset=d,this.locationOffset.line>0||pi(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||pi(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function jA(i){return Fu(i,_2)}function v2(i,n){const l=new b2(i,n),d=l.parseDocument();return Object.defineProperty(d,"tokenCount",{enumerable:!1,value:l.tokenCount}),d}function BA(i,n){const l=new b2(i,n);l.expectToken(dt.SOF);const d=l.parseValueLiteral(!1);return l.expectToken(dt.EOF),d}class b2{constructor(n,l={}){const d=jA(n)?n:new _2(n);this._lexer=new bA(d),this._options=l,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const n=this.expectToken(dt.NAME);return this.node(n,{kind:kt.NAME,value:n.value})}parseDocument(){return this.node(this._lexer.token,{kind:kt.DOCUMENT,definitions:this.many(dt.SOF,this.parseDefinition,dt.EOF)})}parseDefinition(){if(this.peek(dt.BRACE_L))return this.parseOperationDefinition();const n=this.peekDescription(),l=n?this._lexer.lookahead():this._lexer.token;if(l.kind===dt.NAME){switch(l.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(n)throw Ca(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(l.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(l)}parseOperationDefinition(){const n=this._lexer.token;if(this.peek(dt.BRACE_L))return this.node(n,{kind:kt.OPERATION_DEFINITION,operation:Gh.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const l=this.parseOperationType();let d;return this.peek(dt.NAME)&&(d=this.parseName()),this.node(n,{kind:kt.OPERATION_DEFINITION,operation:l,name:d,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const n=this.expectToken(dt.NAME);switch(n.value){case"query":return Gh.QUERY;case"mutation":return Gh.MUTATION;case"subscription":return Gh.SUBSCRIPTION}throw this.unexpected(n)}parseVariableDefinitions(){return this.optionalMany(dt.PAREN_L,this.parseVariableDefinition,dt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:kt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(dt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(dt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const n=this._lexer.token;return this.expectToken(dt.DOLLAR),this.node(n,{kind:kt.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:kt.SELECTION_SET,selections:this.many(dt.BRACE_L,this.parseSelection,dt.BRACE_R)})}parseSelection(){return this.peek(dt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const n=this._lexer.token,l=this.parseName();let d,m;return this.expectOptionalToken(dt.COLON)?(d=l,m=this.parseName()):m=l,this.node(n,{kind:kt.FIELD,alias:d,name:m,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(dt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(n){const l=n?this.parseConstArgument:this.parseArgument;return this.optionalMany(dt.PAREN_L,l,dt.PAREN_R)}parseArgument(n=!1){const l=this._lexer.token,d=this.parseName();return this.expectToken(dt.COLON),this.node(l,{kind:kt.ARGUMENT,name:d,value:this.parseValueLiteral(n)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const n=this._lexer.token;this.expectToken(dt.SPREAD);const l=this.expectOptionalKeyword("on");return!l&&this.peek(dt.NAME)?this.node(n,{kind:kt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(n,{kind:kt.INLINE_FRAGMENT,typeCondition:l?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const n=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(n,{kind:kt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(n,{kind:kt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(n){const l=this._lexer.token;switch(l.kind){case dt.BRACKET_L:return this.parseList(n);case dt.BRACE_L:return this.parseObject(n);case dt.INT:return this.advanceLexer(),this.node(l,{kind:kt.INT,value:l.value});case dt.FLOAT:return this.advanceLexer(),this.node(l,{kind:kt.FLOAT,value:l.value});case dt.STRING:case dt.BLOCK_STRING:return this.parseStringLiteral();case dt.NAME:switch(this.advanceLexer(),l.value){case"true":return this.node(l,{kind:kt.BOOLEAN,value:!0});case"false":return this.node(l,{kind:kt.BOOLEAN,value:!1});case"null":return this.node(l,{kind:kt.NULL});default:return this.node(l,{kind:kt.ENUM,value:l.value})}case dt.DOLLAR:if(n)if(this.expectToken(dt.DOLLAR),this._lexer.token.kind===dt.NAME){const d=this._lexer.token.value;throw Ca(this._lexer.source,l.start,`Unexpected variable "$${d}" in constant value.`)}else throw this.unexpected(l);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const n=this._lexer.token;return this.advanceLexer(),this.node(n,{kind:kt.STRING,value:n.value,block:n.kind===dt.BLOCK_STRING})}parseList(n){const l=()=>this.parseValueLiteral(n);return this.node(this._lexer.token,{kind:kt.LIST,values:this.any(dt.BRACKET_L,l,dt.BRACKET_R)})}parseObject(n){const l=()=>this.parseObjectField(n);return this.node(this._lexer.token,{kind:kt.OBJECT,fields:this.any(dt.BRACE_L,l,dt.BRACE_R)})}parseObjectField(n){const l=this._lexer.token,d=this.parseName();return this.expectToken(dt.COLON),this.node(l,{kind:kt.OBJECT_FIELD,name:d,value:this.parseValueLiteral(n)})}parseDirectives(n){const l=[];for(;this.peek(dt.AT);)l.push(this.parseDirective(n));return l}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(n){const l=this._lexer.token;return this.expectToken(dt.AT),this.node(l,{kind:kt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(n)})}parseTypeReference(){const n=this._lexer.token;let l;if(this.expectOptionalToken(dt.BRACKET_L)){const d=this.parseTypeReference();this.expectToken(dt.BRACKET_R),l=this.node(n,{kind:kt.LIST_TYPE,type:d})}else l=this.parseNamedType();return this.expectOptionalToken(dt.BANG)?this.node(n,{kind:kt.NON_NULL_TYPE,type:l}):l}parseNamedType(){return this.node(this._lexer.token,{kind:kt.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(dt.STRING)||this.peek(dt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("schema");const d=this.parseConstDirectives(),m=this.many(dt.BRACE_L,this.parseOperationTypeDefinition,dt.BRACE_R);return this.node(n,{kind:kt.SCHEMA_DEFINITION,description:l,directives:d,operationTypes:m})}parseOperationTypeDefinition(){const n=this._lexer.token,l=this.parseOperationType();this.expectToken(dt.COLON);const d=this.parseNamedType();return this.node(n,{kind:kt.OPERATION_TYPE_DEFINITION,operation:l,type:d})}parseScalarTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("scalar");const d=this.parseName(),m=this.parseConstDirectives();return this.node(n,{kind:kt.SCALAR_TYPE_DEFINITION,description:l,name:d,directives:m})}parseObjectTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("type");const d=this.parseName(),m=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:kt.OBJECT_TYPE_DEFINITION,description:l,name:d,interfaces:m,directives:_,fields:v})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(dt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(dt.BRACE_L,this.parseFieldDefinition,dt.BRACE_R)}parseFieldDefinition(){const n=this._lexer.token,l=this.parseDescription(),d=this.parseName(),m=this.parseArgumentDefs();this.expectToken(dt.COLON);const _=this.parseTypeReference(),v=this.parseConstDirectives();return this.node(n,{kind:kt.FIELD_DEFINITION,description:l,name:d,arguments:m,type:_,directives:v})}parseArgumentDefs(){return this.optionalMany(dt.PAREN_L,this.parseInputValueDef,dt.PAREN_R)}parseInputValueDef(){const n=this._lexer.token,l=this.parseDescription(),d=this.parseName();this.expectToken(dt.COLON);const m=this.parseTypeReference();let _;this.expectOptionalToken(dt.EQUALS)&&(_=this.parseConstValueLiteral());const v=this.parseConstDirectives();return this.node(n,{kind:kt.INPUT_VALUE_DEFINITION,description:l,name:d,type:m,defaultValue:_,directives:v})}parseInterfaceTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("interface");const d=this.parseName(),m=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:kt.INTERFACE_TYPE_DEFINITION,description:l,name:d,interfaces:m,directives:_,fields:v})}parseUnionTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("union");const d=this.parseName(),m=this.parseConstDirectives(),_=this.parseUnionMemberTypes();return this.node(n,{kind:kt.UNION_TYPE_DEFINITION,description:l,name:d,directives:m,types:_})}parseUnionMemberTypes(){return this.expectOptionalToken(dt.EQUALS)?this.delimitedMany(dt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("enum");const d=this.parseName(),m=this.parseConstDirectives(),_=this.parseEnumValuesDefinition();return this.node(n,{kind:kt.ENUM_TYPE_DEFINITION,description:l,name:d,directives:m,values:_})}parseEnumValuesDefinition(){return this.optionalMany(dt.BRACE_L,this.parseEnumValueDefinition,dt.BRACE_R)}parseEnumValueDefinition(){const n=this._lexer.token,l=this.parseDescription(),d=this.parseEnumValueName(),m=this.parseConstDirectives();return this.node(n,{kind:kt.ENUM_VALUE_DEFINITION,description:l,name:d,directives:m})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Ca(this._lexer.source,this._lexer.token.start,`${S0(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("input");const d=this.parseName(),m=this.parseConstDirectives(),_=this.parseInputFieldsDefinition();return this.node(n,{kind:kt.INPUT_OBJECT_TYPE_DEFINITION,description:l,name:d,directives:m,fields:_})}parseInputFieldsDefinition(){return this.optionalMany(dt.BRACE_L,this.parseInputValueDef,dt.BRACE_R)}parseTypeSystemExtension(){const n=this._lexer.lookahead();if(n.kind===dt.NAME)switch(n.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(n)}parseSchemaExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const l=this.parseConstDirectives(),d=this.optionalMany(dt.BRACE_L,this.parseOperationTypeDefinition,dt.BRACE_R);if(l.length===0&&d.length===0)throw this.unexpected();return this.node(n,{kind:kt.SCHEMA_EXTENSION,directives:l,operationTypes:d})}parseScalarTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const l=this.parseName(),d=this.parseConstDirectives();if(d.length===0)throw this.unexpected();return this.node(n,{kind:kt.SCALAR_TYPE_EXTENSION,name:l,directives:d})}parseObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const l=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(d.length===0&&m.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:kt.OBJECT_TYPE_EXTENSION,name:l,interfaces:d,directives:m,fields:_})}parseInterfaceTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const l=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(d.length===0&&m.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:kt.INTERFACE_TYPE_EXTENSION,name:l,interfaces:d,directives:m,fields:_})}parseUnionTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const l=this.parseName(),d=this.parseConstDirectives(),m=this.parseUnionMemberTypes();if(d.length===0&&m.length===0)throw this.unexpected();return this.node(n,{kind:kt.UNION_TYPE_EXTENSION,name:l,directives:d,types:m})}parseEnumTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const l=this.parseName(),d=this.parseConstDirectives(),m=this.parseEnumValuesDefinition();if(d.length===0&&m.length===0)throw this.unexpected();return this.node(n,{kind:kt.ENUM_TYPE_EXTENSION,name:l,directives:d,values:m})}parseInputObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const l=this.parseName(),d=this.parseConstDirectives(),m=this.parseInputFieldsDefinition();if(d.length===0&&m.length===0)throw this.unexpected();return this.node(n,{kind:kt.INPUT_OBJECT_TYPE_EXTENSION,name:l,directives:d,fields:m})}parseDirectiveDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("directive"),this.expectToken(dt.AT);const d=this.parseName(),m=this.parseArgumentDefs(),_=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const v=this.parseDirectiveLocations();return this.node(n,{kind:kt.DIRECTIVE_DEFINITION,description:l,name:d,arguments:m,repeatable:_,locations:v})}parseDirectiveLocations(){return this.delimitedMany(dt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const n=this._lexer.token,l=this.parseName();if(Object.prototype.hasOwnProperty.call(ei,l.value))return l;throw this.unexpected(n)}node(n,l){return this._options.noLocation!==!0&&(l.loc=new mA(n,this._lexer.lastToken,this._lexer.source)),l}peek(n){return this._lexer.token.kind===n}expectToken(n){const l=this._lexer.token;if(l.kind===n)return this.advanceLexer(),l;throw Ca(this._lexer.source,l.start,`Expected ${x2(n)}, found ${S0(l)}.`)}expectOptionalToken(n){return this._lexer.token.kind===n?(this.advanceLexer(),!0):!1}expectKeyword(n){const l=this._lexer.token;if(l.kind===dt.NAME&&l.value===n)this.advanceLexer();else throw Ca(this._lexer.source,l.start,`Expected "${n}", found ${S0(l)}.`)}expectOptionalKeyword(n){const l=this._lexer.token;return l.kind===dt.NAME&&l.value===n?(this.advanceLexer(),!0):!1}unexpected(n){const l=n??this._lexer.token;return Ca(this._lexer.source,l.start,`Unexpected ${S0(l)}.`)}any(n,l,d){this.expectToken(n);const m=[];for(;!this.expectOptionalToken(d);)m.push(l.call(this));return m}optionalMany(n,l,d){if(this.expectOptionalToken(n)){const m=[];do m.push(l.call(this));while(!this.expectOptionalToken(d));return m}return[]}many(n,l,d){this.expectToken(n);const m=[];do m.push(l.call(this));while(!this.expectOptionalToken(d));return m}delimitedMany(n,l){this.expectOptionalToken(n);const d=[];do d.push(l.call(this));while(this.expectOptionalToken(n));return d}advanceLexer(){const{maxTokens:n}=this._options,l=this._lexer.advance();if(l.kind!==dt.EOF&&(++this._tokenCounter,n!==void 0&&this._tokenCounter>n))throw Ca(this._lexer.source,l.start,`Document contains more that ${n} tokens. Parsing aborted.`)}}function S0(i){const n=i.value;return x2(i.kind)+(n!=null?` "${n}"`:"")}function x2(i){return xA(i)?`"${i}"`:i}const FA=5;function UA(i,n){const[l,d]=n?[i,n]:[void 0,i];let m=" Did you mean ";l&&(m+=l+" ");const _=d.map(C=>`"${C}"`);switch(_.length){case 0:return"";case 1:return m+_[0]+"?";case 2:return m+_[0]+" or "+_[1]+"?"}const v=_.slice(0,FA),c=v.pop();return m+v.join(", ")+", or "+c+"?"}function A1(i){return i}function w2(i,n){const l=Object.create(null);for(const d of i)l[n(d)]=d;return l}function cp(i,n,l){const d=Object.create(null);for(const m of i)d[n(m)]=l(m);return d}function av(i,n){const l=Object.create(null);for(const d of Object.keys(i))l[d]=n(i[d],d);return l}function VA(i,n){let l=0,d=0;for(;l<i.length&&d<n.length;){let m=i.charCodeAt(l),_=n.charCodeAt(d);if(E0(m)&&E0(_)){let v=0;do++l,v=v*10+m-wb,m=i.charCodeAt(l);while(E0(m)&&v>0);let c=0;do++d,c=c*10+_-wb,_=n.charCodeAt(d);while(E0(_)&&c>0);if(v<c)return-1;if(v>c)return 1}else{if(m<_)return-1;if(m>_)return 1;++l,++d}}return i.length-n.length}const wb=48,GA=57;function E0(i){return!isNaN(i)&&wb<=i&&i<=GA}function ZA(i,n){const l=Object.create(null),d=new $A(i),m=Math.floor(i.length*.4)+1;for(const _ of n){const v=d.measure(_,m);v!==void 0&&(l[_]=v)}return Object.keys(l).sort((_,v)=>{const c=l[_]-l[v];return c!==0?c:VA(_,v)})}class $A{constructor(n){this._input=n,this._inputLowerCase=n.toLowerCase(),this._inputArray=M1(this._inputLowerCase),this._rows=[new Array(n.length+1).fill(0),new Array(n.length+1).fill(0),new Array(n.length+1).fill(0)]}measure(n,l){if(this._input===n)return 0;const d=n.toLowerCase();if(this._inputLowerCase===d)return 1;let m=M1(d),_=this._inputArray;if(m.length<_.length){const z=m;m=_,_=z}const v=m.length,c=_.length;if(v-c>l)return;const C=this._rows;for(let z=0;z<=c;z++)C[0][z]=z;for(let z=1;z<=v;z++){const B=C[(z-1)%3],V=C[z%3];let G=V[0]=z;for(let re=1;re<=c;re++){const fe=m[z-1]===_[re-1]?0:1;let pe=Math.min(B[re]+1,V[re-1]+1,B[re-1]+fe);if(z>1&&re>1&&m[z-1]===_[re-2]&&m[z-2]===_[re-1]){const Ie=C[(z-2)%3][re-2];pe=Math.min(pe,Ie+1)}pe<G&&(G=pe),V[re]=pe}if(G>l)return}const R=C[v%3][c];return R<=l?R:void 0}}function M1(i){const n=i.length,l=new Array(n);for(let d=0;d<n;++d)l[d]=i.charCodeAt(d);return l}function Bl(i){if(i==null)return Object.create(null);if(Object.getPrototypeOf(i)===null)return i;const n=Object.create(null);for(const[l,d]of Object.entries(i))n[l]=d;return n}function YA(i){return`"${i.replace(qA,HA)}"`}const qA=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function HA(i){return XA[i.charCodeAt(0)]}const XA=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],WA=Object.freeze({});function lx(i,n,l=d2){const d=new Map;for(const Ie of Object.values(kt))d.set(Ie,QA(n,Ie));let m,_=Array.isArray(i),v=[i],c=-1,C=[],R=i,z,B;const V=[],G=[];do{c++;const Ie=c===v.length,Ge=Ie&&C.length!==0;if(Ie){if(z=G.length===0?void 0:V[V.length-1],R=B,B=G.pop(),Ge)if(_){R=R.slice();let He=0;for(const[Ve,rt]of C){const Je=Ve-He;rt===null?(R.splice(Je,1),He++):R[Je]=rt}}else{R={...R};for(const[He,Ve]of C)R[He]=Ve}c=m.index,v=m.keys,C=m.edits,_=m.inArray,m=m.prev}else if(B){if(z=_?c:v[c],R=B[z],R==null)continue;V.push(z)}let je;if(!Array.isArray(R)){var re,fe;S1(R)||pi(!1,`Invalid AST Node: ${xn(R)}.`);const He=Ie?(re=d.get(R.kind))===null||re===void 0?void 0:re.leave:(fe=d.get(R.kind))===null||fe===void 0?void 0:fe.enter;if(je=He?.call(n,R,z,B,V,G),je===WA)break;if(je===!1){if(!Ie){V.pop();continue}}else if(je!==void 0&&(C.push([z,je]),!Ie))if(S1(je))R=je;else{V.pop();continue}}if(je===void 0&&Ge&&C.push([z,R]),Ie)V.pop();else{var pe;m={inArray:_,index:c,keys:v,edits:C,prev:m},_=Array.isArray(R),v=_?R:(pe=l[R.kind])!==null&&pe!==void 0?pe:[],c=-1,C=[],B&&G.push(B),B=R}}while(m!==void 0);return C.length!==0?C[C.length-1][1]:i}function QA(i,n){const l=i[n];return typeof l=="object"?l:typeof l=="function"?{enter:l,leave:void 0}:{enter:i.enter,leave:i.leave}}function eo(i){return lx(i,JA)}const KA=80,JA={Name:{leave:i=>i.value},Variable:{leave:i=>"$"+i.name},Document:{leave:i=>Yt(i.definitions,`

`)},OperationDefinition:{leave(i){const n=$n("(",Yt(i.variableDefinitions,", "),")"),l=Yt([i.operation,Yt([i.name,n]),Yt(i.directives," ")]," ");return(l==="query"?"":l+" ")+i.selectionSet}},VariableDefinition:{leave:({variable:i,type:n,defaultValue:l,directives:d})=>i+": "+n+$n(" = ",l)+$n(" ",Yt(d," "))},SelectionSet:{leave:({selections:i})=>Cc(i)},Field:{leave({alias:i,name:n,arguments:l,directives:d,selectionSet:m}){const _=$n("",i,": ")+n;let v=_+$n("(",Yt(l,", "),")");return v.length>KA&&(v=_+$n(`(
`,P0(Yt(l,`
`)),`
)`)),Yt([v,Yt(d," "),m]," ")}},Argument:{leave:({name:i,value:n})=>i+": "+n},FragmentSpread:{leave:({name:i,directives:n})=>"..."+i+$n(" ",Yt(n," "))},InlineFragment:{leave:({typeCondition:i,directives:n,selectionSet:l})=>Yt(["...",$n("on ",i),Yt(n," "),l]," ")},FragmentDefinition:{leave:({name:i,typeCondition:n,variableDefinitions:l,directives:d,selectionSet:m})=>`fragment ${i}${$n("(",Yt(l,", "),")")} on ${n} ${$n("",Yt(d," ")," ")}`+m},IntValue:{leave:({value:i})=>i},FloatValue:{leave:({value:i})=>i},StringValue:{leave:({value:i,block:n})=>n?vA(i):YA(i)},BooleanValue:{leave:({value:i})=>i?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:i})=>i},ListValue:{leave:({values:i})=>"["+Yt(i,", ")+"]"},ObjectValue:{leave:({fields:i})=>"{"+Yt(i,", ")+"}"},ObjectField:{leave:({name:i,value:n})=>i+": "+n},Directive:{leave:({name:i,arguments:n})=>"@"+i+$n("(",Yt(n,", "),")")},NamedType:{leave:({name:i})=>i},ListType:{leave:({type:i})=>"["+i+"]"},NonNullType:{leave:({type:i})=>i+"!"},SchemaDefinition:{leave:({description:i,directives:n,operationTypes:l})=>$n("",i,`
`)+Yt(["schema",Yt(n," "),Cc(l)]," ")},OperationTypeDefinition:{leave:({operation:i,type:n})=>i+": "+n},ScalarTypeDefinition:{leave:({description:i,name:n,directives:l})=>$n("",i,`
`)+Yt(["scalar",n,Yt(l," ")]," ")},ObjectTypeDefinition:{leave:({description:i,name:n,interfaces:l,directives:d,fields:m})=>$n("",i,`
`)+Yt(["type",n,$n("implements ",Yt(l," & ")),Yt(d," "),Cc(m)]," ")},FieldDefinition:{leave:({description:i,name:n,arguments:l,type:d,directives:m})=>$n("",i,`
`)+n+(C1(l)?$n(`(
`,P0(Yt(l,`
`)),`
)`):$n("(",Yt(l,", "),")"))+": "+d+$n(" ",Yt(m," "))},InputValueDefinition:{leave:({description:i,name:n,type:l,defaultValue:d,directives:m})=>$n("",i,`
`)+Yt([n+": "+l,$n("= ",d),Yt(m," ")]," ")},InterfaceTypeDefinition:{leave:({description:i,name:n,interfaces:l,directives:d,fields:m})=>$n("",i,`
`)+Yt(["interface",n,$n("implements ",Yt(l," & ")),Yt(d," "),Cc(m)]," ")},UnionTypeDefinition:{leave:({description:i,name:n,directives:l,types:d})=>$n("",i,`
`)+Yt(["union",n,Yt(l," "),$n("= ",Yt(d," | "))]," ")},EnumTypeDefinition:{leave:({description:i,name:n,directives:l,values:d})=>$n("",i,`
`)+Yt(["enum",n,Yt(l," "),Cc(d)]," ")},EnumValueDefinition:{leave:({description:i,name:n,directives:l})=>$n("",i,`
`)+Yt([n,Yt(l," ")]," ")},InputObjectTypeDefinition:{leave:({description:i,name:n,directives:l,fields:d})=>$n("",i,`
`)+Yt(["input",n,Yt(l," "),Cc(d)]," ")},DirectiveDefinition:{leave:({description:i,name:n,arguments:l,repeatable:d,locations:m})=>$n("",i,`
`)+"directive @"+n+(C1(l)?$n(`(
`,P0(Yt(l,`
`)),`
)`):$n("(",Yt(l,", "),")"))+(d?" repeatable":"")+" on "+Yt(m," | ")},SchemaExtension:{leave:({directives:i,operationTypes:n})=>Yt(["extend schema",Yt(i," "),Cc(n)]," ")},ScalarTypeExtension:{leave:({name:i,directives:n})=>Yt(["extend scalar",i,Yt(n," ")]," ")},ObjectTypeExtension:{leave:({name:i,interfaces:n,directives:l,fields:d})=>Yt(["extend type",i,$n("implements ",Yt(n," & ")),Yt(l," "),Cc(d)]," ")},InterfaceTypeExtension:{leave:({name:i,interfaces:n,directives:l,fields:d})=>Yt(["extend interface",i,$n("implements ",Yt(n," & ")),Yt(l," "),Cc(d)]," ")},UnionTypeExtension:{leave:({name:i,directives:n,types:l})=>Yt(["extend union",i,Yt(n," "),$n("= ",Yt(l," | "))]," ")},EnumTypeExtension:{leave:({name:i,directives:n,values:l})=>Yt(["extend enum",i,Yt(n," "),Cc(l)]," ")},InputObjectTypeExtension:{leave:({name:i,directives:n,fields:l})=>Yt(["extend input",i,Yt(n," "),Cc(l)]," ")}};function Yt(i,n=""){var l;return(l=i?.filter(d=>d).join(n))!==null&&l!==void 0?l:""}function Cc(i){return $n(`{
`,P0(Yt(i,`
`)),`
}`)}function $n(i,n,l=""){return n!=null&&n!==""?i+n+l:""}function P0(i){return $n("  ",i.replace(/\n/g,`
  `))}function C1(i){var n;return(n=i?.some(l=>l.includes(`
`)))!==null&&n!==void 0?n:!1}function Tb(i,n){switch(i.kind){case kt.NULL:return null;case kt.INT:return parseInt(i.value,10);case kt.FLOAT:return parseFloat(i.value);case kt.STRING:case kt.ENUM:case kt.BOOLEAN:return i.value;case kt.LIST:return i.values.map(l=>Tb(l,n));case kt.OBJECT:return cp(i.fields,l=>l.name.value,l=>Tb(l.value,n));case kt.VARIABLE:return n?.[i.name.value]}}function Nc(i){if(i!=null||pi(!1,"Must provide name."),typeof i=="string"||pi(!1,"Expected name to be a string."),i.length===0)throw new bi("Expected name to be a non-empty string.");for(let n=1;n<i.length;++n)if(!p2(i.charCodeAt(n)))throw new bi(`Names must only contain [_a-zA-Z0-9] but "${i}" does not.`);if(!ox(i.charCodeAt(0)))throw new bi(`Names must start with [_a-zA-Z] but "${i}" does not.`);return i}function eM(i){if(i==="true"||i==="false"||i==="null")throw new bi(`Enum values cannot be named: ${i}`);return Nc(i)}function T2(i){return yg(i)||sf(i)||Ic(i)||mp(i)||lf(i)||qh(i)||ff(i)||Hh(i)}function yg(i){return Fu(i,Ap)}function sf(i){return Fu(i,pf)}function tM(i){if(!sf(i))throw new Error(`Expected ${xn(i)} to be a GraphQL Object type.`);return i}function Ic(i){return Fu(i,z2)}function nM(i){if(!Ic(i))throw new Error(`Expected ${xn(i)} to be a GraphQL Interface type.`);return i}function mp(i){return Fu(i,L2)}function lf(i){return Fu(i,sv)}function qh(i){return Fu(i,O2)}function ff(i){return Fu(i,Dl)}function Hh(i){return Fu(i,Xn)}function S2(i){return yg(i)||lf(i)||qh(i)||cx(i)&&S2(i.ofType)}function E2(i){return yg(i)||sf(i)||Ic(i)||mp(i)||lf(i)||cx(i)&&E2(i.ofType)}function A2(i){return yg(i)||lf(i)}function iM(i){return Ic(i)||mp(i)}class Dl{constructor(n){T2(n)||pi(!1,`Expected ${xn(n)} to be a GraphQL type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class Xn{constructor(n){M2(n)||pi(!1,`Expected ${xn(n)} to be a GraphQL nullable type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function cx(i){return ff(i)||Hh(i)}function M2(i){return T2(i)&&!Hh(i)}function rM(i){if(!M2(i))throw new Error(`Expected ${xn(i)} to be a GraphQL nullable type.`);return i}function aM(i){if(i){let n=i;for(;cx(n);)n=n.ofType;return n}}function C2(i){return typeof i=="function"?i():i}function D2(i){return typeof i=="function"?i():i}class Ap{constructor(n){var l,d,m,_;const v=(l=n.parseValue)!==null&&l!==void 0?l:A1;this.name=Nc(n.name),this.description=n.description,this.specifiedByURL=n.specifiedByURL,this.serialize=(d=n.serialize)!==null&&d!==void 0?d:A1,this.parseValue=v,this.parseLiteral=(m=n.parseLiteral)!==null&&m!==void 0?m:(c,C)=>v(Tb(c,C)),this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(_=n.extensionASTNodes)!==null&&_!==void 0?_:[],n.specifiedByURL==null||typeof n.specifiedByURL=="string"||pi(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${xn(n.specifiedByURL)}.`),n.serialize==null||typeof n.serialize=="function"||pi(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),n.parseLiteral&&(typeof n.parseValue=="function"&&typeof n.parseLiteral=="function"||pi(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class pf{constructor(n){var l;this.name=Nc(n.name),this.description=n.description,this.isTypeOf=n.isTypeOf,this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._fields=()=>R2(n),this._interfaces=()=>k2(n),n.isTypeOf==null||typeof n.isTypeOf=="function"||pi(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${xn(n.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:P2(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function k2(i){var n;const l=C2((n=i.interfaces)!==null&&n!==void 0?n:[]);return Array.isArray(l)||pi(!1,`${i.name} interfaces must be an Array or a function which returns an Array.`),l}function R2(i){const n=D2(i.fields);return Km(n)||pi(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),av(n,(l,d)=>{var m;Km(l)||pi(!1,`${i.name}.${d} field config must be an object.`),l.resolve==null||typeof l.resolve=="function"||pi(!1,`${i.name}.${d} field resolver must be a function if provided, but got: ${xn(l.resolve)}.`);const _=(m=l.args)!==null&&m!==void 0?m:{};return Km(_)||pi(!1,`${i.name}.${d} args must be an object with argument names as keys.`),{name:Nc(d),description:l.description,type:l.type,args:I2(_),resolve:l.resolve,subscribe:l.subscribe,deprecationReason:l.deprecationReason,extensions:Bl(l.extensions),astNode:l.astNode}})}function I2(i){return Object.entries(i).map(([n,l])=>({name:Nc(n),description:l.description,type:l.type,defaultValue:l.defaultValue,deprecationReason:l.deprecationReason,extensions:Bl(l.extensions),astNode:l.astNode}))}function Km(i){return td(i)&&!Array.isArray(i)}function P2(i){return av(i,n=>({description:n.description,type:n.type,args:N2(n.args),resolve:n.resolve,subscribe:n.subscribe,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function N2(i){return cp(i,n=>n.name,n=>({description:n.description,type:n.type,defaultValue:n.defaultValue,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}class z2{constructor(n){var l;this.name=Nc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._fields=R2.bind(void 0,n),this._interfaces=k2.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||pi(!1,`${this.name} must provide "resolveType" as a function, but got: ${xn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:P2(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class L2{constructor(n){var l;this.name=Nc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._types=sM.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||pi(!1,`${this.name} must provide "resolveType" as a function, but got: ${xn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function sM(i){const n=C2(i.types);return Array.isArray(n)||pi(!1,`Must provide Array of types or a function which returns such an array for Union ${i.name}.`),n}class sv{constructor(n){var l;this.name=Nc(n.name),this.description=n.description,this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._values=typeof n.values=="function"?n.values:D1(this.name,n.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=D1(this.name,this._values())),this._values}getValue(n){return this._nameLookup===null&&(this._nameLookup=w2(this.getValues(),l=>l.name)),this._nameLookup[n]}serialize(n){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(d=>[d.value,d])));const l=this._valueLookup.get(n);if(l===void 0)throw new bi(`Enum "${this.name}" cannot represent value: ${xn(n)}`);return l.name}parseValue(n){if(typeof n!="string"){const d=xn(n);throw new bi(`Enum "${this.name}" cannot represent non-string value: ${d}.`+A0(this,d))}const l=this.getValue(n);if(l==null)throw new bi(`Value "${n}" does not exist in "${this.name}" enum.`+A0(this,n));return l.value}parseLiteral(n,l){if(n.kind!==kt.ENUM){const m=eo(n);throw new bi(`Enum "${this.name}" cannot represent non-enum value: ${m}.`+A0(this,m),{nodes:n})}const d=this.getValue(n.value);if(d==null){const m=eo(n);throw new bi(`Value "${m}" does not exist in "${this.name}" enum.`+A0(this,m),{nodes:n})}return d.value}toConfig(){const n=cp(this.getValues(),l=>l.name,l=>({description:l.description,value:l.value,deprecationReason:l.deprecationReason,extensions:l.extensions,astNode:l.astNode}));return{name:this.name,description:this.description,values:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function A0(i,n){const l=i.getValues().map(m=>m.name),d=ZA(n,l);return UA("the enum value",d)}function D1(i,n){return Km(n)||pi(!1,`${i} values must be an object with value names as keys.`),Object.entries(n).map(([l,d])=>(Km(d)||pi(!1,`${i}.${l} must refer to an object with a "value" key representing an internal value but got: ${xn(d)}.`),{name:eM(l),description:d.description,value:d.value!==void 0?d.value:l,deprecationReason:d.deprecationReason,extensions:Bl(d.extensions),astNode:d.astNode}))}class O2{constructor(n){var l,d;this.name=Nc(n.name),this.description=n.description,this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this.isOneOf=(d=n.isOneOf)!==null&&d!==void 0?d:!1,this._fields=oM.bind(void 0,n)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const n=av(this.getFields(),l=>({description:l.description,type:l.type,defaultValue:l.defaultValue,deprecationReason:l.deprecationReason,extensions:l.extensions,astNode:l.astNode}));return{name:this.name,description:this.description,fields:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function oM(i){const n=D2(i.fields);return Km(n)||pi(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),av(n,(l,d)=>(!("resolve"in l)||pi(!1,`${i.name}.${d} field has a resolve property, but Input Types cannot define resolvers.`),{name:Nc(d),description:l.description,type:l.type,defaultValue:l.defaultValue,deprecationReason:l.deprecationReason,extensions:Bl(l.extensions),astNode:l.astNode}))}const Kv=2147483647,Jv=-2147483648,lM=new Ap({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(i){const n=h_(i);if(typeof n=="boolean")return n?1:0;let l=n;if(typeof n=="string"&&n!==""&&(l=Number(n)),typeof l!="number"||!Number.isInteger(l))throw new bi(`Int cannot represent non-integer value: ${xn(n)}`);if(l>Kv||l<Jv)throw new bi("Int cannot represent non 32-bit signed integer value: "+xn(n));return l},parseValue(i){if(typeof i!="number"||!Number.isInteger(i))throw new bi(`Int cannot represent non-integer value: ${xn(i)}`);if(i>Kv||i<Jv)throw new bi(`Int cannot represent non 32-bit signed integer value: ${i}`);return i},parseLiteral(i){if(i.kind!==kt.INT)throw new bi(`Int cannot represent non-integer value: ${eo(i)}`,{nodes:i});const n=parseInt(i.value,10);if(n>Kv||n<Jv)throw new bi(`Int cannot represent non 32-bit signed integer value: ${i.value}`,{nodes:i});return n}}),cM=new Ap({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(i){const n=h_(i);if(typeof n=="boolean")return n?1:0;let l=n;if(typeof n=="string"&&n!==""&&(l=Number(n)),typeof l!="number"||!Number.isFinite(l))throw new bi(`Float cannot represent non numeric value: ${xn(n)}`);return l},parseValue(i){if(typeof i!="number"||!Number.isFinite(i))throw new bi(`Float cannot represent non numeric value: ${xn(i)}`);return i},parseLiteral(i){if(i.kind!==kt.FLOAT&&i.kind!==kt.INT)throw new bi(`Float cannot represent non numeric value: ${eo(i)}`,i);return parseFloat(i.value)}}),jr=new Ap({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(i){const n=h_(i);if(typeof n=="string")return n;if(typeof n=="boolean")return n?"true":"false";if(typeof n=="number"&&Number.isFinite(n))return n.toString();throw new bi(`String cannot represent value: ${xn(i)}`)},parseValue(i){if(typeof i!="string")throw new bi(`String cannot represent a non string value: ${xn(i)}`);return i},parseLiteral(i){if(i.kind!==kt.STRING)throw new bi(`String cannot represent a non string value: ${eo(i)}`,{nodes:i});return i.value}}),nl=new Ap({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(i){const n=h_(i);if(typeof n=="boolean")return n;if(Number.isFinite(n))return n!==0;throw new bi(`Boolean cannot represent a non boolean value: ${xn(n)}`)},parseValue(i){if(typeof i!="boolean")throw new bi(`Boolean cannot represent a non boolean value: ${xn(i)}`);return i},parseLiteral(i){if(i.kind!==kt.BOOLEAN)throw new bi(`Boolean cannot represent a non boolean value: ${eo(i)}`,{nodes:i});return i.value}}),j2=new Ap({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(i){const n=h_(i);if(typeof n=="string")return n;if(Number.isInteger(n))return String(n);throw new bi(`ID cannot represent value: ${xn(i)}`)},parseValue(i){if(typeof i=="string")return i;if(typeof i=="number"&&Number.isInteger(i))return i.toString();throw new bi(`ID cannot represent value: ${xn(i)}`)},parseLiteral(i){if(i.kind!==kt.STRING&&i.kind!==kt.INT)throw new bi("ID cannot represent a non-string and non-integer value: "+eo(i),{nodes:i});return i.value}}),uM=Object.freeze([jr,lM,cM,nl,j2]);function h_(i){if(td(i)){if(typeof i.valueOf=="function"){const n=i.valueOf();if(!td(n))return n}if(typeof i.toJSON=="function")return i.toJSON()}return i}function hM(i){return Fu(i,Mp)}class Mp{constructor(n){var l,d;this.name=Nc(n.name),this.description=n.description,this.locations=n.locations,this.isRepeatable=(l=n.isRepeatable)!==null&&l!==void 0?l:!1,this.extensions=Bl(n.extensions),this.astNode=n.astNode,Array.isArray(n.locations)||pi(!1,`@${n.name} locations must be an Array.`);const m=(d=n.args)!==null&&d!==void 0?d:{};td(m)&&!Array.isArray(m)||pi(!1,`@${n.name} args must be an object with argument names as keys.`),this.args=I2(m)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:N2(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const dM=new Mp({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[ei.FIELD,ei.FRAGMENT_SPREAD,ei.INLINE_FRAGMENT],args:{if:{type:new Xn(nl),description:"Included when true."}}}),fM=new Mp({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[ei.FIELD,ei.FRAGMENT_SPREAD,ei.INLINE_FRAGMENT],args:{if:{type:new Xn(nl),description:"Skipped when true."}}}),pM="No longer supported",mM=new Mp({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[ei.FIELD_DEFINITION,ei.ARGUMENT_DEFINITION,ei.INPUT_FIELD_DEFINITION,ei.ENUM_VALUE],args:{reason:{type:jr,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:pM}}}),gM=new Mp({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[ei.SCALAR],args:{url:{type:new Xn(jr),description:"The URL that specifies the behavior of this scalar."}}}),yM=new Mp({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[ei.INPUT_OBJECT],args:{}}),_M=Object.freeze([dM,fM,mM,gM,yM]);function vM(i){return typeof i=="object"&&typeof i?.[Symbol.iterator]=="function"}function ky(i,n){if(Hh(n)){const l=ky(i,n.ofType);return l?.kind===kt.NULL?null:l}if(i===null)return{kind:kt.NULL};if(i===void 0)return null;if(ff(n)){const l=n.ofType;if(vM(i)){const d=[];for(const m of i){const _=ky(m,l);_!=null&&d.push(_)}return{kind:kt.LIST,values:d}}return ky(i,l)}if(qh(n)){if(!td(i))return null;const l=[];for(const d of Object.values(n.getFields())){const m=ky(i[d.name],d.type);m&&l.push({kind:kt.OBJECT_FIELD,name:{kind:kt.NAME,value:d.name},value:m})}return{kind:kt.OBJECT,fields:l}}if(A2(n)){const l=n.serialize(i);if(l==null)return null;if(typeof l=="boolean")return{kind:kt.BOOLEAN,value:l};if(typeof l=="number"&&Number.isFinite(l)){const d=String(l);return k1.test(d)?{kind:kt.INT,value:d}:{kind:kt.FLOAT,value:d}}if(typeof l=="string")return lf(n)?{kind:kt.ENUM,value:l}:n===j2&&k1.test(l)?{kind:kt.INT,value:l}:{kind:kt.STRING,value:l};throw new TypeError(`Cannot convert value to AST: ${xn(l)}.`)}nv(!1,"Unexpected input type: "+xn(n))}const k1=/^-?(?:0|[1-9][0-9]*)$/,ux=new pf({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:jr,resolve:i=>i.description},types:{description:"A list of all types supported by this server.",type:new Xn(new Dl(new Xn(ku))),resolve(i){return Object.values(i.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new Xn(ku),resolve:i=>i.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:ku,resolve:i=>i.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:ku,resolve:i=>i.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new Xn(new Dl(new Xn(B2))),resolve:i=>i.getDirectives()}})}),B2=new pf({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new Xn(jr),resolve:i=>i.name},description:{type:jr,resolve:i=>i.description},isRepeatable:{type:new Xn(nl),resolve:i=>i.isRepeatable},locations:{type:new Xn(new Dl(new Xn(F2))),resolve:i=>i.locations},args:{type:new Xn(new Dl(new Xn(ov))),args:{includeDeprecated:{type:nl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(l=>l.deprecationReason==null)}}})}),F2=new sv({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:ei.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:ei.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:ei.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:ei.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:ei.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:ei.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:ei.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:ei.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:ei.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:ei.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:ei.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:ei.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:ei.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:ei.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:ei.UNION,description:"Location adjacent to a union definition."},ENUM:{value:ei.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:ei.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:ei.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:ei.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),ku=new pf({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new Xn(G2),resolve(i){if(yg(i))return Gi.SCALAR;if(sf(i))return Gi.OBJECT;if(Ic(i))return Gi.INTERFACE;if(mp(i))return Gi.UNION;if(lf(i))return Gi.ENUM;if(qh(i))return Gi.INPUT_OBJECT;if(ff(i))return Gi.LIST;if(Hh(i))return Gi.NON_NULL;nv(!1,`Unexpected type: "${xn(i)}".`)}},name:{type:jr,resolve:i=>"name"in i?i.name:void 0},description:{type:jr,resolve:i=>"description"in i?i.description:void 0},specifiedByURL:{type:jr,resolve:i=>"specifiedByURL"in i?i.specifiedByURL:void 0},fields:{type:new Dl(new Xn(U2)),args:{includeDeprecated:{type:nl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(sf(i)||Ic(i)){const l=Object.values(i.getFields());return n?l:l.filter(d=>d.deprecationReason==null)}}},interfaces:{type:new Dl(new Xn(ku)),resolve(i){if(sf(i)||Ic(i))return i.getInterfaces()}},possibleTypes:{type:new Dl(new Xn(ku)),resolve(i,n,l,{schema:d}){if(iM(i))return d.getPossibleTypes(i)}},enumValues:{type:new Dl(new Xn(V2)),args:{includeDeprecated:{type:nl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(lf(i)){const l=i.getValues();return n?l:l.filter(d=>d.deprecationReason==null)}}},inputFields:{type:new Dl(new Xn(ov)),args:{includeDeprecated:{type:nl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(qh(i)){const l=Object.values(i.getFields());return n?l:l.filter(d=>d.deprecationReason==null)}}},ofType:{type:ku,resolve:i=>"ofType"in i?i.ofType:void 0},isOneOf:{type:nl,resolve:i=>{if(qh(i))return i.isOneOf}}})}),U2=new pf({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new Xn(jr),resolve:i=>i.name},description:{type:jr,resolve:i=>i.description},args:{type:new Xn(new Dl(new Xn(ov))),args:{includeDeprecated:{type:nl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(l=>l.deprecationReason==null)}},type:{type:new Xn(ku),resolve:i=>i.type},isDeprecated:{type:new Xn(nl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:jr,resolve:i=>i.deprecationReason}})}),ov=new pf({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new Xn(jr),resolve:i=>i.name},description:{type:jr,resolve:i=>i.description},type:{type:new Xn(ku),resolve:i=>i.type},defaultValue:{type:jr,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(i){const{type:n,defaultValue:l}=i,d=ky(l,n);return d?eo(d):null}},isDeprecated:{type:new Xn(nl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:jr,resolve:i=>i.deprecationReason}})}),V2=new pf({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new Xn(jr),resolve:i=>i.name},description:{type:jr,resolve:i=>i.description},isDeprecated:{type:new Xn(nl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:jr,resolve:i=>i.deprecationReason}})});var Gi;(function(i){i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.INPUT_OBJECT="INPUT_OBJECT",i.LIST="LIST",i.NON_NULL="NON_NULL"})(Gi||(Gi={}));const G2=new sv({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:Gi.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:Gi.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:Gi.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:Gi.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:Gi.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:Gi.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:Gi.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:Gi.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new Xn(ux);new Xn(jr);new Xn(jr);const bM=Object.freeze([ux,B2,F2,ku,U2,ov,V2,G2]);class xM{constructor(n){var l,d;this.__validationErrors=n.assumeValid===!0?[]:void 0,td(n)||pi(!1,"Must provide configuration object."),!n.types||Array.isArray(n.types)||pi(!1,`"types" must be Array if provided but got: ${xn(n.types)}.`),!n.directives||Array.isArray(n.directives)||pi(!1,`"directives" must be Array if provided but got: ${xn(n.directives)}.`),this.description=n.description,this.extensions=Bl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._queryType=n.query,this._mutationType=n.mutation,this._subscriptionType=n.subscription,this._directives=(d=n.directives)!==null&&d!==void 0?d:_M;const m=new Set(n.types);if(n.types!=null)for(const _ of n.types)m.delete(_),kc(_,m);this._queryType!=null&&kc(this._queryType,m),this._mutationType!=null&&kc(this._mutationType,m),this._subscriptionType!=null&&kc(this._subscriptionType,m);for(const _ of this._directives)if(hM(_))for(const v of _.args)kc(v.type,m);kc(ux,m),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const _ of m){if(_==null)continue;const v=_.name;if(v||pi(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[v]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${v}".`);if(this._typeMap[v]=_,Ic(_)){for(const c of _.getInterfaces())if(Ic(c)){let C=this._implementationsMap[c.name];C===void 0&&(C=this._implementationsMap[c.name]={objects:[],interfaces:[]}),C.interfaces.push(_)}}else if(sf(_)){for(const c of _.getInterfaces())if(Ic(c)){let C=this._implementationsMap[c.name];C===void 0&&(C=this._implementationsMap[c.name]={objects:[],interfaces:[]}),C.objects.push(_)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(n){switch(n){case Gh.QUERY:return this.getQueryType();case Gh.MUTATION:return this.getMutationType();case Gh.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(n){return this.getTypeMap()[n]}getPossibleTypes(n){return mp(n)?n.getTypes():this.getImplementations(n).objects}getImplementations(n){const l=this._implementationsMap[n.name];return l??{objects:[],interfaces:[]}}isSubType(n,l){let d=this._subTypeMap[n.name];if(d===void 0){if(d=Object.create(null),mp(n))for(const m of n.getTypes())d[m.name]=!0;else{const m=this.getImplementations(n);for(const _ of m.objects)d[_.name]=!0;for(const _ of m.interfaces)d[_.name]=!0}this._subTypeMap[n.name]=d}return d[l.name]!==void 0}getDirectives(){return this._directives}getDirective(n){return this.getDirectives().find(l=>l.name===n)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function kc(i,n){const l=aM(i);if(!n.has(l)){if(n.add(l),mp(l))for(const d of l.getTypes())kc(d,n);else if(sf(l)||Ic(l)){for(const d of l.getInterfaces())kc(d,n);for(const d of Object.values(l.getFields())){kc(d.type,n);for(const m of d.args)kc(m.type,n)}}else if(qh(l))for(const d of Object.values(l.getFields()))kc(d.type,n)}return n}function Ry(i,n,l){if(i){if(i.kind===kt.VARIABLE){i.name.value;return}if(Hh(n))return i.kind===kt.NULL?void 0:Ry(i,n.ofType,l);if(i.kind===kt.NULL)return null;if(ff(n)){const d=n.ofType;if(i.kind===kt.LIST){const _=[];for(const v of i.values)if(R1(v,l)){if(Hh(d))return;_.push(null)}else{const c=Ry(v,d,l);if(c===void 0)return;_.push(c)}return _}const m=Ry(i,d,l);return m===void 0?void 0:[m]}if(qh(n)){if(i.kind!==kt.OBJECT)return;const d=Object.create(null),m=w2(i.fields,_=>_.name.value);for(const _ of Object.values(n.getFields())){const v=m[_.name];if(!v||R1(v.value,l)){if(_.defaultValue!==void 0)d[_.name]=_.defaultValue;else if(Hh(_.type))return;continue}const c=Ry(v.value,_.type,l);if(c===void 0)return;d[_.name]=c}if(n.isOneOf){const _=Object.keys(d);if(_.length!==1||d[_[0]]===null)return}return d}if(A2(n)){let d;try{d=n.parseLiteral(i,l)}catch{return}return d===void 0?void 0:d}nv(!1,"Unexpected input type: "+xn(n))}}function R1(i,n){return i.kind===kt.VARIABLE&&n==null}function wM(i){const n={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...i},l=n.descriptions?"description":"",d=n.specifiedByUrl?"specifiedByURL":"",m=n.directiveIsRepeatable?"isRepeatable":"",_=n.schemaDescription?l:"";function v(C){return n.inputValueDeprecation?C:""}const c=n.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${_}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${l}
          ${m}
          locations
          args${v("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${l}
      ${d}
      ${c}
      fields(includeDeprecated: true) {
        name
        ${l}
        args${v("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${v("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${l}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${l}
      type { ...TypeRef }
      defaultValue
      ${v("isDeprecated")}
      ${v("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function TM(i,n){td(i)&&td(i.__schema)||pi(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${xn(i)}.`);const l=i.__schema,d=cp(l.types,Ne=>Ne.name,Ne=>V(Ne));for(const Ne of[...uM,...bM])d[Ne.name]&&(d[Ne.name]=Ne);const m=l.queryType?z(l.queryType):null,_=l.mutationType?z(l.mutationType):null,v=l.subscriptionType?z(l.subscriptionType):null,c=l.directives?l.directives.map(Mt):[];return new xM({description:l.description,query:m,mutation:_,subscription:v,types:Object.values(d),directives:c,assumeValid:void 0});function C(Ne){if(Ne.kind===Gi.LIST){const Xe=Ne.ofType;if(!Xe)throw new Error("Decorated type deeper than introspection query.");return new Dl(C(Xe))}if(Ne.kind===Gi.NON_NULL){const Xe=Ne.ofType;if(!Xe)throw new Error("Decorated type deeper than introspection query.");const _t=C(Xe);return new Xn(rM(_t))}return R(Ne)}function R(Ne){const Xe=Ne.name;if(!Xe)throw new Error(`Unknown type reference: ${xn(Ne)}.`);const _t=d[Xe];if(!_t)throw new Error(`Invalid or incomplete schema, unknown type: ${Xe}. Ensure that a full introspection query is used in order to build a client schema.`);return _t}function z(Ne){return tM(R(Ne))}function B(Ne){return nM(R(Ne))}function V(Ne){if(Ne!=null&&Ne.name!=null&&Ne.kind!=null)switch(Ne.kind){case Gi.SCALAR:return G(Ne);case Gi.OBJECT:return fe(Ne);case Gi.INTERFACE:return pe(Ne);case Gi.UNION:return Ie(Ne);case Gi.ENUM:return Ge(Ne);case Gi.INPUT_OBJECT:return je(Ne)}const Xe=xn(Ne);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${Xe}.`)}function G(Ne){return new Ap({name:Ne.name,description:Ne.description,specifiedByURL:Ne.specifiedByURL})}function re(Ne){if(Ne.interfaces===null&&Ne.kind===Gi.INTERFACE)return[];if(!Ne.interfaces){const Xe=xn(Ne);throw new Error(`Introspection result missing interfaces: ${Xe}.`)}return Ne.interfaces.map(B)}function fe(Ne){return new pf({name:Ne.name,description:Ne.description,interfaces:()=>re(Ne),fields:()=>He(Ne)})}function pe(Ne){return new z2({name:Ne.name,description:Ne.description,interfaces:()=>re(Ne),fields:()=>He(Ne)})}function Ie(Ne){if(!Ne.possibleTypes){const Xe=xn(Ne);throw new Error(`Introspection result missing possibleTypes: ${Xe}.`)}return new L2({name:Ne.name,description:Ne.description,types:()=>Ne.possibleTypes.map(z)})}function Ge(Ne){if(!Ne.enumValues){const Xe=xn(Ne);throw new Error(`Introspection result missing enumValues: ${Xe}.`)}return new sv({name:Ne.name,description:Ne.description,values:cp(Ne.enumValues,Xe=>Xe.name,Xe=>({description:Xe.description,deprecationReason:Xe.deprecationReason}))})}function je(Ne){if(!Ne.inputFields){const Xe=xn(Ne);throw new Error(`Introspection result missing inputFields: ${Xe}.`)}return new O2({name:Ne.name,description:Ne.description,fields:()=>rt(Ne.inputFields),isOneOf:Ne.isOneOf})}function He(Ne){if(!Ne.fields)throw new Error(`Introspection result missing fields: ${xn(Ne)}.`);return cp(Ne.fields,Xe=>Xe.name,Ve)}function Ve(Ne){const Xe=C(Ne.type);if(!E2(Xe)){const _t=xn(Xe);throw new Error(`Introspection must provide output type for fields, but received: ${_t}.`)}if(!Ne.args){const _t=xn(Ne);throw new Error(`Introspection result missing field args: ${_t}.`)}return{description:Ne.description,deprecationReason:Ne.deprecationReason,type:Xe,args:rt(Ne.args)}}function rt(Ne){return cp(Ne,Xe=>Xe.name,Je)}function Je(Ne){const Xe=C(Ne.type);if(!S2(Xe)){const Rt=xn(Xe);throw new Error(`Introspection must provide input type for arguments, but received: ${Rt}.`)}const _t=Ne.defaultValue!=null?Ry(BA(Ne.defaultValue),Xe):void 0;return{description:Ne.description,type:Xe,defaultValue:_t,deprecationReason:Ne.deprecationReason}}function Mt(Ne){if(!Ne.args){const Xe=xn(Ne);throw new Error(`Introspection result missing directive args: ${Xe}.`)}if(!Ne.locations){const Xe=xn(Ne);throw new Error(`Introspection result missing directive locations: ${Xe}.`)}return new Mp({name:Ne.name,description:Ne.description,isRepeatable:Ne.isRepeatable,locations:Ne.locations.slice(),args:rt(Ne.args)})}}const I1="Accept",Sb="Content-Type",Eb="application/json",Z2="application/graphql-response+json",P1=i=>i.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),SM=i=>{const n=i.toLowerCase();return n.includes(Z2)||n.includes(Eb)},N1=i=>{try{if(Array.isArray(i))return{_tag:"Batch",executionResults:i.map(z1)};if(I0(i))return{_tag:"Single",executionResult:z1(i)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(i)}`)}catch(n){return n}},z1=i=>{if(typeof i!="object"||i===null)throw new Error("Invalid execution result: result is not object");let n,l,d;if("errors"in i){if(!I0(i.errors)&&!Array.isArray(i.errors))throw new Error("Invalid execution result: errors is not plain object OR array");n=i.errors}if("data"in i){if(!I0(i.data)&&i.data!==null)throw new Error("Invalid execution result: data is not plain object");l=i.data}if("extensions"in i){if(!I0(i.extensions))throw new Error("Invalid execution result: extensions is not plain object");d=i.extensions}return{data:l,errors:n,extensions:d}},EM=i=>i._tag==="Batch"?i.executionResults.some(L1):L1(i.executionResult),L1=i=>Array.isArray(i.errors)?i.errors.length>0:!!i.errors,$2=i=>typeof i=="object"&&i!==null&&"kind"in i&&i.kind===kt.OPERATION_DEFINITION,AM=i=>{let n;const l=i.definitions.filter($2);return l.length===1&&(n=l[0].name?.value),n},MM=i=>{let n=!1;const l=i.definitions.filter($2);return l.length===1&&(n=l[0].operation==="mutation"),n},eb=(i,n)=>{const l=typeof i=="string"?i:eo(i);let d=!1,m;if(n)return{expression:l,isMutation:d,operationName:m};const _=lA(()=>typeof i=="string"?v2(i):i);return _ instanceof Error?{expression:l,isMutation:d,operationName:m}:(m=AM(_),d=MM(_),{expression:l,operationName:m,isMutation:d})},hx=JSON,tb=async i=>{const n={...i,method:i.request._tag==="Single"?i.request.document.isMutation?"POST":b1(i.method??"post"):i.request.hasMutations?"POST":b1(i.method??"post"),fetchOptions:{...i.fetchOptions,errorPolicy:i.fetchOptions.errorPolicy??"none"}},d=await DM(n.method)(n);if(!d.ok)return new Qm({status:d.status,headers:d.headers},{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables});const m=await CM(d,i.fetchOptions.jsonSerializer??hx);if(m instanceof Error)throw m;const _={status:d.status,headers:d.headers};if(EM(m)&&n.fetchOptions.errorPolicy==="none"){const v=m._tag==="Batch"?{...m.executionResults,..._}:{...m.executionResult,..._};return new Qm(v,{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables})}switch(m._tag){case"Single":return{..._,...O1(n)(m.executionResult)};case"Batch":return{..._,data:m.executionResults.map(O1(n))};default:sx(m)}},O1=i=>n=>({extensions:n.extensions,data:n.data,errors:i.fetchOptions.errorPolicy==="all"?n.errors:void 0}),CM=async(i,n)=>{const l=i.headers.get(Sb),d=await i.text();return l&&SM(l)?N1(n.parse(d)):N1(d)},DM=i=>async n=>{const l=new Headers(n.headers);let d=null,m;l.has(I1)||l.set(I1,[Z2,Eb].join(", ")),i==="POST"?(m=(n.fetchOptions.jsonSerializer??hx).stringify(kM(n)),typeof m=="string"&&!l.has(Sb)&&l.set(Sb,Eb)):d=RM(n);const _={method:i,headers:l,body:m,...n.fetchOptions};let v=new URL(n.url),c=_;if(n.middleware){const R=await Promise.resolve(n.middleware({..._,url:n.url,operationName:n.request._tag==="Single"?n.request.document.operationName:void 0,variables:n.request.variables})),{url:z,...B}=R;v=new URL(z),c=B}return d&&d.forEach((R,z)=>{v.searchParams.append(z,R)}),await(n.fetch??fetch)(v,c)},kM=i=>{switch(i.request._tag){case"Single":return{query:i.request.document.expression,variables:i.request.variables,operationName:i.request.document.operationName};case"Batch":return c2(i.request.query,i.request.variables??[]).map(([n,l])=>({query:n,variables:l}));default:throw sx(i.request)}},RM=i=>{const n=i.fetchOptions.jsonSerializer??hx,l=new URLSearchParams;switch(i.request._tag){case"Single":return l.append("query",P1(i.request.document.expression)),i.request.variables&&l.append("variables",n.stringify(i.request.variables)),i.request.document.operationName&&l.append("operationName",i.request.document.operationName),l;case"Batch":{const d=i.request.variables?.map(v=>n.stringify(v))??[],m=i.request.query.map(P1),_=c2(m,d).map(([v,c])=>({query:v,variables:c}));return l.append("query",n.stringify(_)),l}default:throw sx(i.request)}};class IM{url;requestConfig;constructor(n,l={}){this.url=n,this.requestConfig=l}rawRequest=async(...n)=>{const[l,d,m]=n,_=hA(l,d,m),{headers:v,fetch:c=globalThis.fetch,method:C="POST",requestMiddleware:R,responseMiddleware:z,excludeOperationName:B,...V}=this.requestConfig,{url:G}=this;_.signal!==void 0&&(V.signal=_.signal);const re=eb(_.query,B),fe=await tb({url:G,request:{_tag:"Single",document:re,variables:_.variables},headers:{...Fm(Wv(v)),...Fm(_.requestHeaders)},fetch:c,method:C,fetchOptions:V,middleware:R});if(z&&await z(fe,{operationName:re.operationName,variables:d,url:this.url}),fe instanceof Error)throw fe;return fe};async request(n,...l){const[d,m]=l,_=PM(n,d,m),{headers:v,fetch:c=globalThis.fetch,method:C="POST",requestMiddleware:R,responseMiddleware:z,excludeOperationName:B,...V}=this.requestConfig,{url:G}=this;_.signal!==void 0&&(V.signal=_.signal);const re=eb(_.document,B),fe=await tb({url:G,request:{_tag:"Single",document:re,variables:_.variables},headers:{...Fm(Wv(v)),...Fm(_.requestHeaders)},fetch:c,method:C,fetchOptions:V,middleware:R});if(z&&await z(fe,{operationName:re.operationName,variables:_.variables,url:this.url}),fe instanceof Error)throw fe;return fe.data}async batchRequests(n,l){const d=uA(n,l),{headers:m,excludeOperationName:_,...v}=this.requestConfig;d.signal!==void 0&&(v.signal=d.signal);const c=d.documents.map(({document:V})=>eb(V,_)),C=c.map(({expression:V})=>V),R=c.some(({isMutation:V})=>V),z=d.documents.map(({variables:V})=>V),B=await tb({url:this.url,request:{_tag:"Batch",operationName:void 0,query:C,hasMutations:R,variables:z},headers:{...Fm(Wv(m)),...Fm(d.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:v,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(B,{operationName:void 0,variables:z,url:this.url}),B instanceof Error)throw B;return B.data}setHeaders(n){return this.requestConfig.headers=n,this}setHeader(n,l){const{headers:d}=this.requestConfig;return d?d[n]=l:this.requestConfig.headers={[n]:l},this}setEndpoint(n){return this.url=n,this}}async function dx(i,n,...l){const d=NM(i,n,...l);return new IM(d.url).request({...d})}const PM=(i,n,l)=>i.document?i:{document:i,variables:n,requestHeaders:l,signal:void 0},NM=(i,n,...l)=>{const[d,m]=l;return typeof i=="string"?{url:i,document:n,variables:d,requestHeaders:m,signal:void 0}:i},nb="/otp/transmodel/v3",lv=()=>{try{return new URL(nb),nb}catch{return`${window.location.origin}${nb}`}};var Y2=(i=>(i.LimitToNumOfItineraries="limitToNumOfItineraries",i.LimitToSearchWindow="limitToSearchWindow",i.ListAll="listAll",i.Off="off",i))(Y2||{}),vi=(i=>(i.Air="air",i.Bicycle="bicycle",i.Bus="bus",i.Cableway="cableway",i.Car="car",i.Coach="coach",i.Foot="foot",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Scooter="scooter",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Water="water",i))(vi||{}),ng=(i=>(i.Bicycle="bicycle",i.BikePark="bike_park",i.BikeRental="bike_rental",i.Car="car",i.CarPark="car_park",i.CarPickup="car_pickup",i.CarRental="car_rental",i.Flexible="flexible",i.Foot="foot",i.ScooterRental="scooter_rental",i))(ng||{}),q2=(i=>(i.Air="air",i.Bus="bus",i.Cableway="cableway",i.Coach="coach",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Unknown="unknown",i.Water="water",i))(q2||{});const zM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},LM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},OM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},jM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},BM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},FM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},UM={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":zM,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":LM,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":OM,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":jM,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":BM,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        generalizedCost\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            generalizedCost\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":FM};function _g(i){return UM[i]??{}}const VM=_g(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),GM=i=>{const[n,l]=ce.useState(null);return ce.useEffect(()=>{(async()=>{if(i.place){const m={id:i.place};try{l(await dx(lv(),VM,m))}catch(_){console.error("Error at useQuayCoordinateQuery",_)}}else l(null)})()},[i]),n?.quay};function j1(i){const n=GM(i);if(n){const{latitude:l,longitude:d}=n;if(l&&d)return{latitude:l,longitude:d}}if(i.coordinates)return{...i.coordinates}}function ZM({setCursor:i,tripQueryVariables:n,setTripQueryVariables:l,loading:d}){const m=j1(n.from),_=j1(n.to);return ne.jsxs(ne.Fragment,{children:[m&&ne.jsx(y1,{draggable:!0,latitude:m.latitude,longitude:m.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),d||l({...n,from:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:ne.jsx("img",{alt:"",src:aA,height:48,width:49})}),_&&ne.jsx(y1,{draggable:!0,latitude:_.latitude,longitude:_.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),d||l({...n,to:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:ne.jsx("img",{alt:"",src:sA,height:48,width:49})})]})}var $M=function(i,n){for(var l=Math.pow(10,n),d=i.length,m=new Array(Math.floor(i.length/2)),_=0,v=0,c=0,C=0;_<d;++C){var R=1,z=0,B=void 0;do B=i.charCodeAt(_++)-63-1,R+=B<<z,z+=5;while(B>=31);v+=R&1?~(R>>1):R>>1,R=1,z=0;do B=i.charCodeAt(_++)-63-1,R+=B<<z,z+=5;while(B>=31);c+=R&1?~(R>>1):R>>1,m[C]=[v/l,c/l]}return m.length=C,m};const YM=function(i){return i===vi.Foot?"#191616":i===vi.Bicycle?"#5076D9":i===vi.Scooter?"#14b7ca":i===vi.Car?"#7e7e7e":i===vi.Rail?"#86BF8B":i===vi.Coach?"#25642A":i===vi.Metro?"#D9B250":i===vi.Bus?"#fe0000":i===vi.Tram?"#D9B250":i===vi.Trolleybus?"#25642A":i===vi.Water||i===vi.Air||i===vi.Cableway||i===vi.Funicular||i===vi.Monorail||i===vi.Taxi?"#81304C":"#aaa"},H2=function(i){return i.line?.presentation?.colour?`#${i.line.presentation.colour}`:YM(i.mode)};function qM({tripPattern:i}){return ne.jsx(ne.Fragment,{children:i?.legs.map((n,l)=>n.pointsOnLink&&ne.jsxs(JE,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:$M(n.pointsOnLink.points,5).map(d=>d.reverse())}},children:[ne.jsx(_1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),ne.jsx(_1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":H2(n),"line-width":4}})]},n.id||`footleg_${l}`))})}const X2=(i,n,l)=>({...i,[l]:{coordinates:{latitude:n.lat,longitude:n.lng}}}),HM=(i,n)=>X2(i,n,"from"),XM=(i,n)=>X2(i,n,"to");function WM({tripQueryVariables:i,setTripQueryVariables:n}){return ce.useCallback(l=>{l.preventDefault(),i.from.coordinates?n(XM(i,l.lngLat)):n(HM(i,l.lngLat))},[i,n])}var ib={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var B1;function QM(){return B1||(B1=1,function(i){(function(){var n={}.hasOwnProperty;function l(){for(var _="",v=0;v<arguments.length;v++){var c=arguments[v];c&&(_=m(_,d(c)))}return _}function d(_){if(typeof _=="string"||typeof _=="number")return _;if(typeof _!="object")return"";if(Array.isArray(_))return l.apply(null,_);if(_.toString!==Object.prototype.toString&&!_.toString.toString().includes("[native code]"))return _.toString();var v="";for(var c in _)n.call(_,c)&&_[c]&&(v=m(v,c));return v}function m(_,v){return v?_?_+" "+v:_+v:_}i.exports?(l.default=l,i.exports=l):window.classNames=l})()}(ib)),ib.exports}var KM=QM();const An=Sp(KM);function Ab(){return Ab=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var d in l)({}).hasOwnProperty.call(l,d)&&(i[d]=l[d])}return i},Ab.apply(null,arguments)}function W2(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)!==-1)continue;l[d]=i[d]}return l}function F1(i){return"default"+i.charAt(0).toUpperCase()+i.substr(1)}function JM(i){var n=eC(i,"string");return typeof n=="symbol"?n:String(n)}function eC(i,n){if(typeof i!="object"||i===null)return i;var l=i[Symbol.toPrimitive];if(l!==void 0){var d=l.call(i,n);if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function tC(i,n,l){var d=ce.useRef(i!==void 0),m=ce.useState(n),_=m[0],v=m[1],c=i!==void 0,C=d.current;return d.current=c,!c&&C&&_!==n&&v(n),[c?i:_,ce.useCallback(function(R){for(var z=arguments.length,B=new Array(z>1?z-1:0),V=1;V<z;V++)B[V-1]=arguments[V];l&&l.apply(void 0,[R].concat(B)),v(R)},[l])]}function Q2(i,n){return Object.keys(n).reduce(function(l,d){var m,_=l,v=_[F1(d)],c=_[d],C=W2(_,[F1(d),d].map(JM)),R=n[d],z=tC(c,v,i[R]),B=z[0],V=z[1];return Ab({},C,(m={},m[d]=B,m[R]=V,m))},i)}function Mb(i,n){return Mb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,d){return l.__proto__=d,l},Mb(i,n)}function nC(i,n){i.prototype=Object.create(n.prototype),i.prototype.constructor=i,Mb(i,n)}const iC=["xxl","xl","lg","md","sm","xs"],rC="xs",d_=ce.createContext({prefixes:{},breakpoints:iC,minBreakpoint:rC}),{Consumer:oP,Provider:lP}=d_;function Un(i,n){const{prefixes:l}=ce.useContext(d_);return i||l[n]||n}function aC(){const{breakpoints:i}=ce.useContext(d_);return i}function sC(){const{minBreakpoint:i}=ce.useContext(d_);return i}function K2(){const{dir:i}=ce.useContext(d_);return i==="rtl"}function f_(i){return i&&i.ownerDocument||document}function oC(i){var n=f_(i);return n&&n.defaultView||window}function lC(i,n){return oC(i).getComputedStyle(i,n)}var cC=/([A-Z])/g;function uC(i){return i.replace(cC,"-$1").toLowerCase()}var hC=/^ms-/;function M0(i){return uC(i).replace(hC,"-ms-")}var dC=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function fC(i){return!!(i&&dC.test(i))}function Xh(i,n){var l="",d="";if(typeof n=="string")return i.style.getPropertyValue(M0(n))||lC(i).getPropertyValue(M0(n));Object.keys(n).forEach(function(m){var _=n[m];!_&&_!==0?i.style.removeProperty(M0(m)):fC(m)?d+=m+"("+_+") ":l+=M0(m)+": "+_+";"}),d&&(l+="transform: "+d+";"),i.style.cssText+=";"+l}var rb={exports:{}},ab,U1;function pC(){if(U1)return ab;U1=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ab=i,ab}var sb,V1;function mC(){if(V1)return sb;V1=1;var i=pC();function n(){}function l(){}return l.resetWarningCache=n,sb=function(){function d(v,c,C,R,z,B){if(B!==i){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}d.isRequired=d;function m(){return d}var _={array:d,bigint:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:m,element:d,elementType:d,instanceOf:m,node:d,objectOf:m,oneOf:m,oneOfType:m,shape:m,exact:m,checkPropTypes:l,resetWarningCache:n};return _.PropTypes=_,_},sb}var G1;function gC(){return G1||(G1=1,rb.exports=mC()()),rb.exports}var yC=gC();const Wh=Sp(yC),Z1={disabled:!1},J2=kl.createContext(null);var _C=function(n){return n.scrollTop},Iy="unmounted",ef="exited",Rc="entering",Fh="entered",Ky="exiting",sd=function(i){nC(n,i);function n(d,m){var _;_=i.call(this,d,m)||this;var v=m,c=v&&!v.isMounting?d.enter:d.appear,C;return _.appearStatus=null,d.in?c?(C=ef,_.appearStatus=Rc):C=Fh:d.unmountOnExit||d.mountOnEnter?C=Iy:C=ef,_.state={status:C},_.nextCallback=null,_}n.getDerivedStateFromProps=function(m,_){var v=m.in;return v&&_.status===Iy?{status:ef}:null};var l=n.prototype;return l.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},l.componentDidUpdate=function(m){var _=null;if(m!==this.props){var v=this.state.status;this.props.in?v!==Rc&&v!==Fh&&(_=Rc):(v===Rc||v===Fh)&&(_=Ky)}this.updateStatus(!1,_)},l.componentWillUnmount=function(){this.cancelNextCallback()},l.getTimeouts=function(){var m=this.props.timeout,_,v,c;return _=v=c=m,m!=null&&typeof m!="number"&&(_=m.exit,v=m.enter,c=m.appear!==void 0?m.appear:v),{exit:_,enter:v,appear:c}},l.updateStatus=function(m,_){if(m===void 0&&(m=!1),_!==null)if(this.cancelNextCallback(),_===Rc){if(this.props.unmountOnExit||this.props.mountOnEnter){var v=this.props.nodeRef?this.props.nodeRef.current:lp.findDOMNode(this);v&&_C(v)}this.performEnter(m)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ef&&this.setState({status:Iy})},l.performEnter=function(m){var _=this,v=this.props.enter,c=this.context?this.context.isMounting:m,C=this.props.nodeRef?[c]:[lp.findDOMNode(this),c],R=C[0],z=C[1],B=this.getTimeouts(),V=c?B.appear:B.enter;if(!m&&!v||Z1.disabled){this.safeSetState({status:Fh},function(){_.props.onEntered(R)});return}this.props.onEnter(R,z),this.safeSetState({status:Rc},function(){_.props.onEntering(R,z),_.onTransitionEnd(V,function(){_.safeSetState({status:Fh},function(){_.props.onEntered(R,z)})})})},l.performExit=function(){var m=this,_=this.props.exit,v=this.getTimeouts(),c=this.props.nodeRef?void 0:lp.findDOMNode(this);if(!_||Z1.disabled){this.safeSetState({status:ef},function(){m.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:Ky},function(){m.props.onExiting(c),m.onTransitionEnd(v.exit,function(){m.safeSetState({status:ef},function(){m.props.onExited(c)})})})},l.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},l.safeSetState=function(m,_){_=this.setNextCallback(_),this.setState(m,_)},l.setNextCallback=function(m){var _=this,v=!0;return this.nextCallback=function(c){v&&(v=!1,_.nextCallback=null,m(c))},this.nextCallback.cancel=function(){v=!1},this.nextCallback},l.onTransitionEnd=function(m,_){this.setNextCallback(_);var v=this.props.nodeRef?this.props.nodeRef.current:lp.findDOMNode(this),c=m==null&&!this.props.addEndListener;if(!v||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var C=this.props.nodeRef?[this.nextCallback]:[v,this.nextCallback],R=C[0],z=C[1];this.props.addEndListener(R,z)}m!=null&&setTimeout(this.nextCallback,m)},l.render=function(){var m=this.state.status;if(m===Iy)return null;var _=this.props,v=_.children;_.in,_.mountOnEnter,_.unmountOnExit,_.appear,_.enter,_.exit,_.timeout,_.addEndListener,_.onEnter,_.onEntering,_.onEntered,_.onExit,_.onExiting,_.onExited,_.nodeRef;var c=W2(_,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return kl.createElement(J2.Provider,{value:null},typeof v=="function"?v(m,c):kl.cloneElement(kl.Children.only(v),c))},n}(kl.Component);sd.contextType=J2;sd.propTypes={};function Um(){}sd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Um,onEntering:Um,onEntered:Um,onExit:Um,onExiting:Um,onExited:Um};sd.UNMOUNTED=Iy;sd.EXITED=ef;sd.ENTERING=Rc;sd.ENTERED=Fh;sd.EXITING=Ky;function eT(i){return i.code==="Escape"||i.keyCode===27}function vC(){const i=ce.version.split(".");return{major:+i[0],minor:+i[1],patch:+i[2]}}function vg(i){if(!i||typeof i=="function")return null;const{major:n}=vC();return n>=19?i.props.ref:i.ref}const cv=!!(typeof window<"u"&&window.document&&window.document.createElement);var Cb=!1,Db=!1;try{var ob={get passive(){return Cb=!0},get once(){return Db=Cb=!0}};cv&&(window.addEventListener("test",ob,ob),window.removeEventListener("test",ob,!0))}catch{}function bC(i,n,l,d){if(d&&typeof d!="boolean"&&!Db){var m=d.once,_=d.capture,v=l;!Db&&m&&(v=l.__once||function c(C){this.removeEventListener(n,c,_),l.call(this,C)},l.__once=v),i.addEventListener(n,v,Cb?d:_)}i.addEventListener(n,l,d)}function xC(i,n,l,d){var m=d&&typeof d!="boolean"?d.capture:d;i.removeEventListener(n,l,m),l.__once&&i.removeEventListener(n,l.__once,m)}function Zh(i,n,l,d){return bC(i,n,l,d),function(){xC(i,n,l,d)}}function wC(i,n,l,d){if(d===void 0&&(d=!0),i){var m=document.createEvent("HTMLEvents");m.initEvent(n,l,d),i.dispatchEvent(m)}}function TC(i){var n=Xh(i,"transitionDuration")||"",l=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*l}function SC(i,n,l){l===void 0&&(l=5);var d=!1,m=setTimeout(function(){d||wC(i,"transitionend",!0)},n+l),_=Zh(i,"transitionend",function(){d=!0},{once:!0});return function(){clearTimeout(m),_()}}function EC(i,n,l,d){l==null&&(l=TC(i)||0);var m=SC(i,l,d),_=Zh(i,"transitionend",n);return function(){m(),_()}}function $1(i,n){const l=Xh(i,n)||"",d=l.indexOf("ms")===-1?1e3:1;return parseFloat(l)*d}function fx(i,n){const l=$1(i,"transitionDuration"),d=$1(i,"transitionDelay"),m=EC(i,_=>{_.target===i&&(m(),n(_))},l+d)}function Sy(...i){return i.filter(n=>n!=null).reduce((n,l)=>{if(typeof l!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return n===null?l:function(...m){n.apply(this,m),l.apply(this,m)}},null)}function tT(i){i.offsetHeight}const Y1=i=>!i||typeof i=="function"?i:n=>{i.current=n};function AC(i,n){const l=Y1(i),d=Y1(n);return m=>{l&&l(m),d&&d(m)}}function nT(i,n){return ce.useMemo(()=>AC(i,n),[i,n])}function kb(i){return i&&"setState"in i?lp.findDOMNode(i):i??null}const uv=kl.forwardRef(({onEnter:i,onEntering:n,onEntered:l,onExit:d,onExiting:m,onExited:_,addEndListener:v,children:c,childRef:C,...R},z)=>{const B=ce.useRef(null),V=nT(B,C),G=rt=>{V(kb(rt))},re=rt=>Je=>{rt&&B.current&&rt(B.current,Je)},fe=ce.useCallback(re(i),[i]),pe=ce.useCallback(re(n),[n]),Ie=ce.useCallback(re(l),[l]),Ge=ce.useCallback(re(d),[d]),je=ce.useCallback(re(m),[m]),He=ce.useCallback(re(_),[_]),Ve=ce.useCallback(re(v),[v]);return ne.jsx(sd,{ref:z,...R,onEnter:fe,onEntered:Ie,onEntering:pe,onExit:Ge,onExited:He,onExiting:je,addEndListener:Ve,nodeRef:B,children:typeof c=="function"?(rt,Je)=>c(rt,{...Je,ref:G}):kl.cloneElement(c,{ref:G})})});uv.displayName="TransitionWrapper";const MC={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function CC(i,n){const l=`offset${i[0].toUpperCase()}${i.slice(1)}`,d=n[l],m=MC[i];return d+parseInt(Xh(n,m[0]),10)+parseInt(Xh(n,m[1]),10)}const DC={[ef]:"collapse",[Ky]:"collapsing",[Rc]:"collapsing",[Fh]:"collapse show"},px=kl.forwardRef(({onEnter:i,onEntering:n,onEntered:l,onExit:d,onExiting:m,className:_,children:v,dimension:c="height",in:C=!1,timeout:R=300,mountOnEnter:z=!1,unmountOnExit:B=!1,appear:V=!1,getDimensionValue:G=CC,...re},fe)=>{const pe=typeof c=="function"?c():c,Ie=ce.useMemo(()=>Sy(rt=>{rt.style[pe]="0"},i),[pe,i]),Ge=ce.useMemo(()=>Sy(rt=>{const Je=`scroll${pe[0].toUpperCase()}${pe.slice(1)}`;rt.style[pe]=`${rt[Je]}px`},n),[pe,n]),je=ce.useMemo(()=>Sy(rt=>{rt.style[pe]=null},l),[pe,l]),He=ce.useMemo(()=>Sy(rt=>{rt.style[pe]=`${G(pe,rt)}px`,tT(rt)},d),[d,G,pe]),Ve=ce.useMemo(()=>Sy(rt=>{rt.style[pe]=null},m),[pe,m]);return ne.jsx(uv,{ref:fe,addEndListener:fx,...re,"aria-expanded":re.role?C:null,onEnter:Ie,onEntering:Ge,onEntered:je,onExit:He,onExiting:Ve,childRef:vg(v),in:C,timeout:R,mountOnEnter:z,unmountOnExit:B,appear:V,children:(rt,Je)=>kl.cloneElement(v,{...Je,className:An(_,v.props.className,DC[rt],pe==="width"&&"collapse-horizontal")})})});px.displayName="Collapse";function iT(i,n){return Array.isArray(i)?i.includes(n):i===n}const p_=ce.createContext({});p_.displayName="AccordionContext";const mx=ce.forwardRef(({as:i="div",bsPrefix:n,className:l,children:d,eventKey:m,..._},v)=>{const{activeEventKey:c}=ce.useContext(p_);return n=Un(n,"accordion-collapse"),ne.jsx(px,{ref:v,in:iT(c,m),..._,className:An(l,n),children:ne.jsx(i,{children:ce.Children.only(d)})})});mx.displayName="AccordionCollapse";const hv=ce.createContext({eventKey:""});hv.displayName="AccordionItemContext";const rT=ce.forwardRef(({as:i="div",bsPrefix:n,className:l,onEnter:d,onEntering:m,onEntered:_,onExit:v,onExiting:c,onExited:C,...R},z)=>{n=Un(n,"accordion-body");const{eventKey:B}=ce.useContext(hv);return ne.jsx(mx,{eventKey:B,onEnter:d,onEntering:m,onEntered:_,onExit:v,onExiting:c,onExited:C,children:ne.jsx(i,{ref:z,...R,className:An(l,n)})})});rT.displayName="AccordionBody";function kC(i,n){const{activeEventKey:l,onSelect:d,alwaysOpen:m}=ce.useContext(p_);return _=>{let v=i===l?null:i;m&&(Array.isArray(l)?l.includes(i)?v=l.filter(c=>c!==i):v=[...l,i]:v=[i]),d?.(v,_),n?.(_)}}const gx=ce.forwardRef(({as:i="button",bsPrefix:n,className:l,onClick:d,...m},_)=>{n=Un(n,"accordion-button");const{eventKey:v}=ce.useContext(hv),c=kC(v,d),{activeEventKey:C}=ce.useContext(p_);return i==="button"&&(m.type="button"),ne.jsx(i,{ref:_,onClick:c,...m,"aria-expanded":Array.isArray(C)?C.includes(v):v===C,className:An(l,n,!iT(C,v)&&"collapsed")})});gx.displayName="AccordionButton";const aT=ce.forwardRef(({as:i="h2","aria-controls":n,bsPrefix:l,className:d,children:m,onClick:_,...v},c)=>(l=Un(l,"accordion-header"),ne.jsx(i,{ref:c,...v,className:An(d,l),children:ne.jsx(gx,{onClick:_,"aria-controls":n,children:m})})));aT.displayName="AccordionHeader";const sT=ce.forwardRef(({as:i="div",bsPrefix:n,className:l,eventKey:d,...m},_)=>{n=Un(n,"accordion-item");const v=ce.useMemo(()=>({eventKey:d}),[d]);return ne.jsx(hv.Provider,{value:v,children:ne.jsx(i,{ref:_,...m,className:An(l,n)})})});sT.displayName="AccordionItem";const oT=ce.forwardRef((i,n)=>{const{as:l="div",activeKey:d,bsPrefix:m,className:_,onSelect:v,flush:c,alwaysOpen:C,...R}=Q2(i,{activeKey:"onSelect"}),z=Un(m,"accordion"),B=ce.useMemo(()=>({activeEventKey:d,onSelect:v,alwaysOpen:C}),[d,v,C]);return ne.jsx(p_.Provider,{value:B,children:ne.jsx(l,{ref:n,...R,className:An(_,z,c&&`${z}-flush`)})})});oT.displayName="Accordion";const C0=Object.assign(oT,{Button:gx,Collapse:mx,Item:sT,Header:aT,Body:rT});function RC(i){const n=ce.useRef(i);return ce.useEffect(()=>{n.current=i},[i]),n}function m_(i){const n=RC(i);return ce.useCallback(function(...l){return n.current&&n.current(...l)},[n])}const IC=i=>ce.forwardRef((n,l)=>ne.jsx("div",{...n,ref:l,className:An(n.className,i)}));function q1(){return ce.useState(null)}function PC(i){const n=ce.useRef(i);return ce.useEffect(()=>{n.current=i},[i]),n}function Cu(i){const n=PC(i);return ce.useCallback(function(...l){return n.current&&n.current(...l)},[n])}function lT(){const i=ce.useRef(!0),n=ce.useRef(()=>i.current);return ce.useEffect(()=>(i.current=!0,()=>{i.current=!1}),[]),n.current}function NC(i){const n=ce.useRef(null);return ce.useEffect(()=>{n.current=i}),n.current}const zC=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",LC=typeof document<"u",H1=LC||zC?ce.useLayoutEffect:ce.useEffect,OC=["as","disabled"];function jC(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}function BC(i){return!i||i.trim()==="#"}function cT({tagName:i,disabled:n,href:l,target:d,rel:m,role:_,onClick:v,tabIndex:c=0,type:C}){i||(l!=null||d!=null||m!=null?i="a":i="button");const R={tagName:i};if(i==="button")return[{type:C||"button",disabled:n},R];const z=V=>{if((n||i==="a"&&BC(l))&&V.preventDefault(),n){V.stopPropagation();return}v?.(V)},B=V=>{V.key===" "&&(V.preventDefault(),z(V))};return i==="a"&&(l||(l="#"),n&&(l=void 0)),[{role:_??"button",disabled:void 0,tabIndex:n?void 0:c,href:l,target:i==="a"?d:void 0,"aria-disabled":n||void 0,rel:i==="a"?m:void 0,onClick:z,onKeyDown:B},R]}const FC=ce.forwardRef((i,n)=>{let{as:l,disabled:d}=i,m=jC(i,OC);const[_,{tagName:v}]=cT(Object.assign({tagName:l,disabled:d},m));return ne.jsx(v,Object.assign({},m,_,{ref:n}))});FC.displayName="Button";const UC={[Rc]:"show",[Fh]:"show"},B0=ce.forwardRef(({className:i,children:n,transitionClasses:l={},onEnter:d,...m},_)=>{const v={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...m},c=ce.useCallback((C,R)=>{tT(C),d?.(C,R)},[d]);return ne.jsx(uv,{ref:_,addEndListener:fx,...v,onEnter:c,childRef:vg(n),children:(C,R)=>ce.cloneElement(n,{...R,className:An("fade",i,n.props.className,UC[C],l[C])})})});B0.displayName="Fade";const VC={"aria-label":Wh.string,onClick:Wh.func,variant:Wh.oneOf(["white"])},yx=ce.forwardRef(({className:i,variant:n,"aria-label":l="Close",...d},m)=>ne.jsx("button",{ref:m,type:"button",className:An("btn-close",n&&`btn-close-${n}`,i),"aria-label":l,...d}));yx.displayName="CloseButton";yx.propTypes=VC;const gp=ce.forwardRef(({as:i,bsPrefix:n,variant:l="primary",size:d,active:m=!1,disabled:_=!1,className:v,...c},C)=>{const R=Un(n,"btn"),[z,{tagName:B}]=cT({tagName:i,disabled:_,...c}),V=B;return ne.jsx(V,{...z,...c,ref:C,disabled:_,className:An(v,R,m&&"active",l&&`${R}-${l}`,d&&`${R}-${d}`,c.href&&_&&"disabled")})});gp.displayName="Button";const _x=ce.forwardRef(({bsPrefix:i,size:n,vertical:l=!1,className:d,role:m="group",as:_="div",...v},c)=>{const C=Un(i,"btn-group");let R=C;return l&&(R=`${C}-vertical`),ne.jsx(_,{...v,ref:c,role:m,className:An(d,R,n&&`${C}-${n}`)})});_x.displayName="ButtonGroup";function GC(i,n){return ce.Children.toArray(i).some(l=>ce.isValidElement(l)&&l.type===n)}function ZC({as:i,bsPrefix:n,className:l,...d}){n=Un(n,"col");const m=aC(),_=sC(),v=[],c=[];return m.forEach(C=>{const R=d[C];delete d[C];let z,B,V;typeof R=="object"&&R!=null?{span:z,offset:B,order:V}=R:z=R;const G=C!==_?`-${C}`:"";z&&v.push(z===!0?`${n}${G}`:`${n}${G}-${z}`),V!=null&&c.push(`order${G}-${V}`),B!=null&&c.push(`offset${G}-${B}`)}),[{...d,className:An(l,...v,...c)},{as:i,bsPrefix:n,spans:v}]}const uT=ce.forwardRef((i,n)=>{const[{className:l,...d},{as:m="div",bsPrefix:_,spans:v}]=ZC(i);return ne.jsx(m,{...d,ref:n,className:An(l,!v.length&&_)})});uT.displayName="Col";var $C=Function.prototype.bind.call(Function.prototype.call,[].slice);function Vm(i,n){return $C(i.querySelectorAll(n))}var X1=Object.prototype.hasOwnProperty;function W1(i,n,l){for(l of i.keys())if(Uy(l,n))return l}function Uy(i,n){var l,d,m;if(i===n)return!0;if(i&&n&&(l=i.constructor)===n.constructor){if(l===Date)return i.getTime()===n.getTime();if(l===RegExp)return i.toString()===n.toString();if(l===Array){if((d=i.length)===n.length)for(;d--&&Uy(i[d],n[d]););return d===-1}if(l===Set){if(i.size!==n.size)return!1;for(d of i)if(m=d,m&&typeof m=="object"&&(m=W1(n,m),!m)||!n.has(m))return!1;return!0}if(l===Map){if(i.size!==n.size)return!1;for(d of i)if(m=d[0],m&&typeof m=="object"&&(m=W1(n,m),!m)||!Uy(d[1],n.get(m)))return!1;return!0}if(l===ArrayBuffer)i=new Uint8Array(i),n=new Uint8Array(n);else if(l===DataView){if((d=i.byteLength)===n.byteLength)for(;d--&&i.getInt8(d)===n.getInt8(d););return d===-1}if(ArrayBuffer.isView(i)){if((d=i.byteLength)===n.byteLength)for(;d--&&i[d]===n[d];);return d===-1}if(!l||typeof i=="object"){d=0;for(l in i)if(X1.call(i,l)&&++d&&!X1.call(n,l)||!(l in n)||!Uy(i[l],n[l]))return!1;return Object.keys(n).length===d}}return i!==i&&n!==n}function YC(i){const n=lT();return[i[0],ce.useCallback(l=>{if(n())return i[1](l)},[n,i[1]])]}var Mo="top",zl="bottom",Ll="right",Co="left",vx="auto",g_=[Mo,zl,Ll,Co],ig="start",Jy="end",qC="clippingParents",hT="viewport",Ey="popper",HC="reference",Q1=g_.reduce(function(i,n){return i.concat([n+"-"+ig,n+"-"+Jy])},[]),dT=[].concat(g_,[vx]).reduce(function(i,n){return i.concat([n,n+"-"+ig,n+"-"+Jy])},[]),XC="beforeRead",WC="read",QC="afterRead",KC="beforeMain",JC="main",eD="afterMain",tD="beforeWrite",nD="write",iD="afterWrite",rD=[XC,WC,QC,KC,JC,eD,tD,nD,iD];function Nu(i){return i.split("-")[0]}function al(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var n=i.ownerDocument;return n&&n.defaultView||window}return i}function yp(i){var n=al(i).Element;return i instanceof n||i instanceof Element}function zu(i){var n=al(i).HTMLElement;return i instanceof n||i instanceof HTMLElement}function bx(i){if(typeof ShadowRoot>"u")return!1;var n=al(i).ShadowRoot;return i instanceof n||i instanceof ShadowRoot}var hp=Math.max,F0=Math.min,rg=Math.round;function Rb(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function fT(){return!/^((?!chrome|android).)*safari/i.test(Rb())}function ag(i,n,l){n===void 0&&(n=!1),l===void 0&&(l=!1);var d=i.getBoundingClientRect(),m=1,_=1;n&&zu(i)&&(m=i.offsetWidth>0&&rg(d.width)/i.offsetWidth||1,_=i.offsetHeight>0&&rg(d.height)/i.offsetHeight||1);var v=yp(i)?al(i):window,c=v.visualViewport,C=!fT()&&l,R=(d.left+(C&&c?c.offsetLeft:0))/m,z=(d.top+(C&&c?c.offsetTop:0))/_,B=d.width/m,V=d.height/_;return{width:B,height:V,top:z,right:R+B,bottom:z+V,left:R,x:R,y:z}}function xx(i){var n=ag(i),l=i.offsetWidth,d=i.offsetHeight;return Math.abs(n.width-l)<=1&&(l=n.width),Math.abs(n.height-d)<=1&&(d=n.height),{x:i.offsetLeft,y:i.offsetTop,width:l,height:d}}function pT(i,n){var l=n.getRootNode&&n.getRootNode();if(i.contains(n))return!0;if(l&&bx(l)){var d=n;do{if(d&&i.isSameNode(d))return!0;d=d.parentNode||d.host}while(d)}return!1}function cf(i){return i?(i.nodeName||"").toLowerCase():null}function nd(i){return al(i).getComputedStyle(i)}function aD(i){return["table","td","th"].indexOf(cf(i))>=0}function mf(i){return((yp(i)?i.ownerDocument:i.document)||window.document).documentElement}function dv(i){return cf(i)==="html"?i:i.assignedSlot||i.parentNode||(bx(i)?i.host:null)||mf(i)}function K1(i){return!zu(i)||nd(i).position==="fixed"?null:i.offsetParent}function sD(i){var n=/firefox/i.test(Rb()),l=/Trident/i.test(Rb());if(l&&zu(i)){var d=nd(i);if(d.position==="fixed")return null}var m=dv(i);for(bx(m)&&(m=m.host);zu(m)&&["html","body"].indexOf(cf(m))<0;){var _=nd(m);if(_.transform!=="none"||_.perspective!=="none"||_.contain==="paint"||["transform","perspective"].indexOf(_.willChange)!==-1||n&&_.willChange==="filter"||n&&_.filter&&_.filter!=="none")return m;m=m.parentNode}return null}function y_(i){for(var n=al(i),l=K1(i);l&&aD(l)&&nd(l).position==="static";)l=K1(l);return l&&(cf(l)==="html"||cf(l)==="body"&&nd(l).position==="static")?n:l||sD(i)||n}function wx(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Vy(i,n,l){return hp(i,F0(n,l))}function oD(i,n,l){var d=Vy(i,n,l);return d>l?l:d}function mT(){return{top:0,right:0,bottom:0,left:0}}function gT(i){return Object.assign({},mT(),i)}function yT(i,n){return n.reduce(function(l,d){return l[d]=i,l},{})}var lD=function(n,l){return n=typeof n=="function"?n(Object.assign({},l.rects,{placement:l.placement})):n,gT(typeof n!="number"?n:yT(n,g_))};function cD(i){var n,l=i.state,d=i.name,m=i.options,_=l.elements.arrow,v=l.modifiersData.popperOffsets,c=Nu(l.placement),C=wx(c),R=[Co,Ll].indexOf(c)>=0,z=R?"height":"width";if(!(!_||!v)){var B=lD(m.padding,l),V=xx(_),G=C==="y"?Mo:Co,re=C==="y"?zl:Ll,fe=l.rects.reference[z]+l.rects.reference[C]-v[C]-l.rects.popper[z],pe=v[C]-l.rects.reference[C],Ie=y_(_),Ge=Ie?C==="y"?Ie.clientHeight||0:Ie.clientWidth||0:0,je=fe/2-pe/2,He=B[G],Ve=Ge-V[z]-B[re],rt=Ge/2-V[z]/2+je,Je=Vy(He,rt,Ve),Mt=C;l.modifiersData[d]=(n={},n[Mt]=Je,n.centerOffset=Je-rt,n)}}function uD(i){var n=i.state,l=i.options,d=l.element,m=d===void 0?"[data-popper-arrow]":d;m!=null&&(typeof m=="string"&&(m=n.elements.popper.querySelector(m),!m)||pT(n.elements.popper,m)&&(n.elements.arrow=m))}const hD={name:"arrow",enabled:!0,phase:"main",fn:cD,effect:uD,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function sg(i){return i.split("-")[1]}var dD={top:"auto",right:"auto",bottom:"auto",left:"auto"};function fD(i,n){var l=i.x,d=i.y,m=n.devicePixelRatio||1;return{x:rg(l*m)/m||0,y:rg(d*m)/m||0}}function J1(i){var n,l=i.popper,d=i.popperRect,m=i.placement,_=i.variation,v=i.offsets,c=i.position,C=i.gpuAcceleration,R=i.adaptive,z=i.roundOffsets,B=i.isFixed,V=v.x,G=V===void 0?0:V,re=v.y,fe=re===void 0?0:re,pe=typeof z=="function"?z({x:G,y:fe}):{x:G,y:fe};G=pe.x,fe=pe.y;var Ie=v.hasOwnProperty("x"),Ge=v.hasOwnProperty("y"),je=Co,He=Mo,Ve=window;if(R){var rt=y_(l),Je="clientHeight",Mt="clientWidth";if(rt===al(l)&&(rt=mf(l),nd(rt).position!=="static"&&c==="absolute"&&(Je="scrollHeight",Mt="scrollWidth")),rt=rt,m===Mo||(m===Co||m===Ll)&&_===Jy){He=zl;var Ne=B&&rt===Ve&&Ve.visualViewport?Ve.visualViewport.height:rt[Je];fe-=Ne-d.height,fe*=C?1:-1}if(m===Co||(m===Mo||m===zl)&&_===Jy){je=Ll;var Xe=B&&rt===Ve&&Ve.visualViewport?Ve.visualViewport.width:rt[Mt];G-=Xe-d.width,G*=C?1:-1}}var _t=Object.assign({position:c},R&&dD),Rt=z===!0?fD({x:G,y:fe},al(l)):{x:G,y:fe};if(G=Rt.x,fe=Rt.y,C){var Ut;return Object.assign({},_t,(Ut={},Ut[He]=Ge?"0":"",Ut[je]=Ie?"0":"",Ut.transform=(Ve.devicePixelRatio||1)<=1?"translate("+G+"px, "+fe+"px)":"translate3d("+G+"px, "+fe+"px, 0)",Ut))}return Object.assign({},_t,(n={},n[He]=Ge?fe+"px":"",n[je]=Ie?G+"px":"",n.transform="",n))}function pD(i){var n=i.state,l=i.options,d=l.gpuAcceleration,m=d===void 0?!0:d,_=l.adaptive,v=_===void 0?!0:_,c=l.roundOffsets,C=c===void 0?!0:c,R={placement:Nu(n.placement),variation:sg(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:m,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,J1(Object.assign({},R,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:v,roundOffsets:C})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,J1(Object.assign({},R,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:C})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const mD={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:pD,data:{}};var D0={passive:!0};function gD(i){var n=i.state,l=i.instance,d=i.options,m=d.scroll,_=m===void 0?!0:m,v=d.resize,c=v===void 0?!0:v,C=al(n.elements.popper),R=[].concat(n.scrollParents.reference,n.scrollParents.popper);return _&&R.forEach(function(z){z.addEventListener("scroll",l.update,D0)}),c&&C.addEventListener("resize",l.update,D0),function(){_&&R.forEach(function(z){z.removeEventListener("scroll",l.update,D0)}),c&&C.removeEventListener("resize",l.update,D0)}}const yD={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:gD,data:{}};var _D={left:"right",right:"left",bottom:"top",top:"bottom"};function N0(i){return i.replace(/left|right|bottom|top/g,function(n){return _D[n]})}var vD={start:"end",end:"start"};function ew(i){return i.replace(/start|end/g,function(n){return vD[n]})}function Tx(i){var n=al(i),l=n.pageXOffset,d=n.pageYOffset;return{scrollLeft:l,scrollTop:d}}function Sx(i){return ag(mf(i)).left+Tx(i).scrollLeft}function bD(i,n){var l=al(i),d=mf(i),m=l.visualViewport,_=d.clientWidth,v=d.clientHeight,c=0,C=0;if(m){_=m.width,v=m.height;var R=fT();(R||!R&&n==="fixed")&&(c=m.offsetLeft,C=m.offsetTop)}return{width:_,height:v,x:c+Sx(i),y:C}}function xD(i){var n,l=mf(i),d=Tx(i),m=(n=i.ownerDocument)==null?void 0:n.body,_=hp(l.scrollWidth,l.clientWidth,m?m.scrollWidth:0,m?m.clientWidth:0),v=hp(l.scrollHeight,l.clientHeight,m?m.scrollHeight:0,m?m.clientHeight:0),c=-d.scrollLeft+Sx(i),C=-d.scrollTop;return nd(m||l).direction==="rtl"&&(c+=hp(l.clientWidth,m?m.clientWidth:0)-_),{width:_,height:v,x:c,y:C}}function Ex(i){var n=nd(i),l=n.overflow,d=n.overflowX,m=n.overflowY;return/auto|scroll|overlay|hidden/.test(l+m+d)}function _T(i){return["html","body","#document"].indexOf(cf(i))>=0?i.ownerDocument.body:zu(i)&&Ex(i)?i:_T(dv(i))}function Gy(i,n){var l;n===void 0&&(n=[]);var d=_T(i),m=d===((l=i.ownerDocument)==null?void 0:l.body),_=al(d),v=m?[_].concat(_.visualViewport||[],Ex(d)?d:[]):d,c=n.concat(v);return m?c:c.concat(Gy(dv(v)))}function Ib(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function wD(i,n){var l=ag(i,!1,n==="fixed");return l.top=l.top+i.clientTop,l.left=l.left+i.clientLeft,l.bottom=l.top+i.clientHeight,l.right=l.left+i.clientWidth,l.width=i.clientWidth,l.height=i.clientHeight,l.x=l.left,l.y=l.top,l}function tw(i,n,l){return n===hT?Ib(bD(i,l)):yp(n)?wD(n,l):Ib(xD(mf(i)))}function TD(i){var n=Gy(dv(i)),l=["absolute","fixed"].indexOf(nd(i).position)>=0,d=l&&zu(i)?y_(i):i;return yp(d)?n.filter(function(m){return yp(m)&&pT(m,d)&&cf(m)!=="body"}):[]}function SD(i,n,l,d){var m=n==="clippingParents"?TD(i):[].concat(n),_=[].concat(m,[l]),v=_[0],c=_.reduce(function(C,R){var z=tw(i,R,d);return C.top=hp(z.top,C.top),C.right=F0(z.right,C.right),C.bottom=F0(z.bottom,C.bottom),C.left=hp(z.left,C.left),C},tw(i,v,d));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function vT(i){var n=i.reference,l=i.element,d=i.placement,m=d?Nu(d):null,_=d?sg(d):null,v=n.x+n.width/2-l.width/2,c=n.y+n.height/2-l.height/2,C;switch(m){case Mo:C={x:v,y:n.y-l.height};break;case zl:C={x:v,y:n.y+n.height};break;case Ll:C={x:n.x+n.width,y:c};break;case Co:C={x:n.x-l.width,y:c};break;default:C={x:n.x,y:n.y}}var R=m?wx(m):null;if(R!=null){var z=R==="y"?"height":"width";switch(_){case ig:C[R]=C[R]-(n[z]/2-l[z]/2);break;case Jy:C[R]=C[R]+(n[z]/2-l[z]/2);break}}return C}function e_(i,n){n===void 0&&(n={});var l=n,d=l.placement,m=d===void 0?i.placement:d,_=l.strategy,v=_===void 0?i.strategy:_,c=l.boundary,C=c===void 0?qC:c,R=l.rootBoundary,z=R===void 0?hT:R,B=l.elementContext,V=B===void 0?Ey:B,G=l.altBoundary,re=G===void 0?!1:G,fe=l.padding,pe=fe===void 0?0:fe,Ie=gT(typeof pe!="number"?pe:yT(pe,g_)),Ge=V===Ey?HC:Ey,je=i.rects.popper,He=i.elements[re?Ge:V],Ve=SD(yp(He)?He:He.contextElement||mf(i.elements.popper),C,z,v),rt=ag(i.elements.reference),Je=vT({reference:rt,element:je,placement:m}),Mt=Ib(Object.assign({},je,Je)),Ne=V===Ey?Mt:rt,Xe={top:Ve.top-Ne.top+Ie.top,bottom:Ne.bottom-Ve.bottom+Ie.bottom,left:Ve.left-Ne.left+Ie.left,right:Ne.right-Ve.right+Ie.right},_t=i.modifiersData.offset;if(V===Ey&&_t){var Rt=_t[m];Object.keys(Xe).forEach(function(Ut){var un=[Ll,zl].indexOf(Ut)>=0?1:-1,Ht=[Mo,zl].indexOf(Ut)>=0?"y":"x";Xe[Ut]+=Rt[Ht]*un})}return Xe}function ED(i,n){n===void 0&&(n={});var l=n,d=l.placement,m=l.boundary,_=l.rootBoundary,v=l.padding,c=l.flipVariations,C=l.allowedAutoPlacements,R=C===void 0?dT:C,z=sg(d),B=z?c?Q1:Q1.filter(function(re){return sg(re)===z}):g_,V=B.filter(function(re){return R.indexOf(re)>=0});V.length===0&&(V=B);var G=V.reduce(function(re,fe){return re[fe]=e_(i,{placement:fe,boundary:m,rootBoundary:_,padding:v})[Nu(fe)],re},{});return Object.keys(G).sort(function(re,fe){return G[re]-G[fe]})}function AD(i){if(Nu(i)===vx)return[];var n=N0(i);return[ew(i),n,ew(n)]}function MD(i){var n=i.state,l=i.options,d=i.name;if(!n.modifiersData[d]._skip){for(var m=l.mainAxis,_=m===void 0?!0:m,v=l.altAxis,c=v===void 0?!0:v,C=l.fallbackPlacements,R=l.padding,z=l.boundary,B=l.rootBoundary,V=l.altBoundary,G=l.flipVariations,re=G===void 0?!0:G,fe=l.allowedAutoPlacements,pe=n.options.placement,Ie=Nu(pe),Ge=Ie===pe,je=C||(Ge||!re?[N0(pe)]:AD(pe)),He=[pe].concat(je).reduce(function(Pt,Xt){return Pt.concat(Nu(Xt)===vx?ED(n,{placement:Xt,boundary:z,rootBoundary:B,padding:R,flipVariations:re,allowedAutoPlacements:fe}):Xt)},[]),Ve=n.rects.reference,rt=n.rects.popper,Je=new Map,Mt=!0,Ne=He[0],Xe=0;Xe<He.length;Xe++){var _t=He[Xe],Rt=Nu(_t),Ut=sg(_t)===ig,un=[Mo,zl].indexOf(Rt)>=0,Ht=un?"width":"height",Ue=e_(n,{placement:_t,boundary:z,rootBoundary:B,altBoundary:V,padding:R}),ft=un?Ut?Ll:Co:Ut?zl:Mo;Ve[Ht]>rt[Ht]&&(ft=N0(ft));var Dt=N0(ft),It=[];if(_&&It.push(Ue[Rt]<=0),c&&It.push(Ue[ft]<=0,Ue[Dt]<=0),It.every(function(Pt){return Pt})){Ne=_t,Mt=!1;break}Je.set(_t,It)}if(Mt)for(var be=re?3:1,et=function(Xt){var Bt=He.find(function(wi){var fn=Je.get(wi);if(fn)return fn.slice(0,Xt).every(function(mi){return mi})});if(Bt)return Ne=Bt,"break"},Et=be;Et>0;Et--){var bt=et(Et);if(bt==="break")break}n.placement!==Ne&&(n.modifiersData[d]._skip=!0,n.placement=Ne,n.reset=!0)}}const CD={name:"flip",enabled:!0,phase:"main",fn:MD,requiresIfExists:["offset"],data:{_skip:!1}};function nw(i,n,l){return l===void 0&&(l={x:0,y:0}),{top:i.top-n.height-l.y,right:i.right-n.width+l.x,bottom:i.bottom-n.height+l.y,left:i.left-n.width-l.x}}function iw(i){return[Mo,Ll,zl,Co].some(function(n){return i[n]>=0})}function DD(i){var n=i.state,l=i.name,d=n.rects.reference,m=n.rects.popper,_=n.modifiersData.preventOverflow,v=e_(n,{elementContext:"reference"}),c=e_(n,{altBoundary:!0}),C=nw(v,d),R=nw(c,m,_),z=iw(C),B=iw(R);n.modifiersData[l]={referenceClippingOffsets:C,popperEscapeOffsets:R,isReferenceHidden:z,hasPopperEscaped:B},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":z,"data-popper-escaped":B})}const kD={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:DD};function RD(i,n,l){var d=Nu(i),m=[Co,Mo].indexOf(d)>=0?-1:1,_=typeof l=="function"?l(Object.assign({},n,{placement:i})):l,v=_[0],c=_[1];return v=v||0,c=(c||0)*m,[Co,Ll].indexOf(d)>=0?{x:c,y:v}:{x:v,y:c}}function ID(i){var n=i.state,l=i.options,d=i.name,m=l.offset,_=m===void 0?[0,0]:m,v=dT.reduce(function(z,B){return z[B]=RD(B,n.rects,_),z},{}),c=v[n.placement],C=c.x,R=c.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=C,n.modifiersData.popperOffsets.y+=R),n.modifiersData[d]=v}const PD={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ID};function ND(i){var n=i.state,l=i.name;n.modifiersData[l]=vT({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const zD={name:"popperOffsets",enabled:!0,phase:"read",fn:ND,data:{}};function LD(i){return i==="x"?"y":"x"}function OD(i){var n=i.state,l=i.options,d=i.name,m=l.mainAxis,_=m===void 0?!0:m,v=l.altAxis,c=v===void 0?!1:v,C=l.boundary,R=l.rootBoundary,z=l.altBoundary,B=l.padding,V=l.tether,G=V===void 0?!0:V,re=l.tetherOffset,fe=re===void 0?0:re,pe=e_(n,{boundary:C,rootBoundary:R,padding:B,altBoundary:z}),Ie=Nu(n.placement),Ge=sg(n.placement),je=!Ge,He=wx(Ie),Ve=LD(He),rt=n.modifiersData.popperOffsets,Je=n.rects.reference,Mt=n.rects.popper,Ne=typeof fe=="function"?fe(Object.assign({},n.rects,{placement:n.placement})):fe,Xe=typeof Ne=="number"?{mainAxis:Ne,altAxis:Ne}:Object.assign({mainAxis:0,altAxis:0},Ne),_t=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Rt={x:0,y:0};if(rt){if(_){var Ut,un=He==="y"?Mo:Co,Ht=He==="y"?zl:Ll,Ue=He==="y"?"height":"width",ft=rt[He],Dt=ft+pe[un],It=ft-pe[Ht],be=G?-Mt[Ue]/2:0,et=Ge===ig?Je[Ue]:Mt[Ue],Et=Ge===ig?-Mt[Ue]:-Je[Ue],bt=n.elements.arrow,Pt=G&&bt?xx(bt):{width:0,height:0},Xt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:mT(),Bt=Xt[un],wi=Xt[Ht],fn=Vy(0,Je[Ue],Pt[Ue]),mi=je?Je[Ue]/2-be-fn-Bt-Xe.mainAxis:et-fn-Bt-Xe.mainAxis,ya=je?-Je[Ue]/2+be+fn+wi+Xe.mainAxis:Et+fn+wi+Xe.mainAxis,sa=n.elements.arrow&&y_(n.elements.arrow),rr=sa?He==="y"?sa.clientTop||0:sa.clientLeft||0:0,Yn=(Ut=_t?.[He])!=null?Ut:0,Wn=ft+mi-Yn-rr,Nn=ft+ya-Yn,Br=Vy(G?F0(Dt,Wn):Dt,ft,G?hp(It,Nn):It);rt[He]=Br,Rt[He]=Br-ft}if(c){var Li,Ka=He==="x"?Mo:Co,ka=He==="x"?zl:Ll,oa=rt[Ve],Fr=Ve==="y"?"height":"width",ws=oa+pe[Ka],Ja=oa-pe[ka],Ts=[Mo,Co].indexOf(Ie)!==-1,Ss=(Li=_t?.[Ve])!=null?Li:0,la=Ts?ws:oa-Je[Fr]-Mt[Fr]-Ss+Xe.altAxis,Oi=Ts?oa+Je[Fr]+Mt[Fr]-Ss-Xe.altAxis:Ja,Ur=G&&Ts?oD(la,oa,Oi):Vy(G?la:ws,oa,G?Oi:Ja);rt[Ve]=Ur,Rt[Ve]=Ur-oa}n.modifiersData[d]=Rt}}const jD={name:"preventOverflow",enabled:!0,phase:"main",fn:OD,requiresIfExists:["offset"]};function BD(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function FD(i){return i===al(i)||!zu(i)?Tx(i):BD(i)}function UD(i){var n=i.getBoundingClientRect(),l=rg(n.width)/i.offsetWidth||1,d=rg(n.height)/i.offsetHeight||1;return l!==1||d!==1}function VD(i,n,l){l===void 0&&(l=!1);var d=zu(n),m=zu(n)&&UD(n),_=mf(n),v=ag(i,m,l),c={scrollLeft:0,scrollTop:0},C={x:0,y:0};return(d||!d&&!l)&&((cf(n)!=="body"||Ex(_))&&(c=FD(n)),zu(n)?(C=ag(n,!0),C.x+=n.clientLeft,C.y+=n.clientTop):_&&(C.x=Sx(_))),{x:v.left+c.scrollLeft-C.x,y:v.top+c.scrollTop-C.y,width:v.width,height:v.height}}function GD(i){var n=new Map,l=new Set,d=[];i.forEach(function(_){n.set(_.name,_)});function m(_){l.add(_.name);var v=[].concat(_.requires||[],_.requiresIfExists||[]);v.forEach(function(c){if(!l.has(c)){var C=n.get(c);C&&m(C)}}),d.push(_)}return i.forEach(function(_){l.has(_.name)||m(_)}),d}function ZD(i){var n=GD(i);return rD.reduce(function(l,d){return l.concat(n.filter(function(m){return m.phase===d}))},[])}function $D(i){var n;return function(){return n||(n=new Promise(function(l){Promise.resolve().then(function(){n=void 0,l(i())})})),n}}function YD(i){var n=i.reduce(function(l,d){var m=l[d.name];return l[d.name]=m?Object.assign({},m,d,{options:Object.assign({},m.options,d.options),data:Object.assign({},m.data,d.data)}):d,l},{});return Object.keys(n).map(function(l){return n[l]})}var rw={placement:"bottom",modifiers:[],strategy:"absolute"};function aw(){for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return!n.some(function(d){return!(d&&typeof d.getBoundingClientRect=="function")})}function qD(i){i===void 0&&(i={});var n=i,l=n.defaultModifiers,d=l===void 0?[]:l,m=n.defaultOptions,_=m===void 0?rw:m;return function(c,C,R){R===void 0&&(R=_);var z={placement:"bottom",orderedModifiers:[],options:Object.assign({},rw,_),modifiersData:{},elements:{reference:c,popper:C},attributes:{},styles:{}},B=[],V=!1,G={state:z,setOptions:function(Ie){var Ge=typeof Ie=="function"?Ie(z.options):Ie;fe(),z.options=Object.assign({},_,z.options,Ge),z.scrollParents={reference:yp(c)?Gy(c):c.contextElement?Gy(c.contextElement):[],popper:Gy(C)};var je=ZD(YD([].concat(d,z.options.modifiers)));return z.orderedModifiers=je.filter(function(He){return He.enabled}),re(),G.update()},forceUpdate:function(){if(!V){var Ie=z.elements,Ge=Ie.reference,je=Ie.popper;if(aw(Ge,je)){z.rects={reference:VD(Ge,y_(je),z.options.strategy==="fixed"),popper:xx(je)},z.reset=!1,z.placement=z.options.placement,z.orderedModifiers.forEach(function(Xe){return z.modifiersData[Xe.name]=Object.assign({},Xe.data)});for(var He=0;He<z.orderedModifiers.length;He++){if(z.reset===!0){z.reset=!1,He=-1;continue}var Ve=z.orderedModifiers[He],rt=Ve.fn,Je=Ve.options,Mt=Je===void 0?{}:Je,Ne=Ve.name;typeof rt=="function"&&(z=rt({state:z,options:Mt,name:Ne,instance:G})||z)}}}},update:$D(function(){return new Promise(function(pe){G.forceUpdate(),pe(z)})}),destroy:function(){fe(),V=!0}};if(!aw(c,C))return G;G.setOptions(R).then(function(pe){!V&&R.onFirstUpdate&&R.onFirstUpdate(pe)});function re(){z.orderedModifiers.forEach(function(pe){var Ie=pe.name,Ge=pe.options,je=Ge===void 0?{}:Ge,He=pe.effect;if(typeof He=="function"){var Ve=He({state:z,name:Ie,instance:G,options:je}),rt=function(){};B.push(Ve||rt)}})}function fe(){B.forEach(function(pe){return pe()}),B=[]}return G}}const HD=qD({defaultModifiers:[kD,zD,mD,yD,PD,CD,jD,hD]}),XD=["enabled","placement","strategy","modifiers"];function WD(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}const QD={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},KD={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:i})=>()=>{const{reference:n,popper:l}=i.elements;if("removeAttribute"in n){const d=(n.getAttribute("aria-describedby")||"").split(",").filter(m=>m.trim()!==l.id);d.length?n.setAttribute("aria-describedby",d.join(",")):n.removeAttribute("aria-describedby")}},fn:({state:i})=>{var n;const{popper:l,reference:d}=i.elements,m=(n=l.getAttribute("role"))==null?void 0:n.toLowerCase();if(l.id&&m==="tooltip"&&"setAttribute"in d){const _=d.getAttribute("aria-describedby");if(_&&_.split(",").indexOf(l.id)!==-1)return;d.setAttribute("aria-describedby",_?`${_},${l.id}`:l.id)}}},JD=[];function ek(i,n,l={}){let{enabled:d=!0,placement:m="bottom",strategy:_="absolute",modifiers:v=JD}=l,c=WD(l,XD);const C=ce.useRef(v),R=ce.useRef(),z=ce.useCallback(()=>{var pe;(pe=R.current)==null||pe.update()},[]),B=ce.useCallback(()=>{var pe;(pe=R.current)==null||pe.forceUpdate()},[]),[V,G]=YC(ce.useState({placement:m,update:z,forceUpdate:B,attributes:{},styles:{popper:{},arrow:{}}})),re=ce.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:pe})=>{const Ie={},Ge={};Object.keys(pe.elements).forEach(je=>{Ie[je]=pe.styles[je],Ge[je]=pe.attributes[je]}),G({state:pe,styles:Ie,attributes:Ge,update:z,forceUpdate:B,placement:pe.placement})}}),[z,B,G]),fe=ce.useMemo(()=>(Uy(C.current,v)||(C.current=v),C.current),[v]);return ce.useEffect(()=>{!R.current||!d||R.current.setOptions({placement:m,strategy:_,modifiers:[...fe,re,QD]})},[_,m,re,d,fe]),ce.useEffect(()=>{if(!(!d||i==null||n==null))return R.current=HD(i,n,Object.assign({},c,{placement:m,strategy:_,modifiers:[...fe,KD,re]})),()=>{R.current!=null&&(R.current.destroy(),R.current=void 0,G(pe=>Object.assign({},pe,{attributes:{},styles:{popper:{}}})))}},[d,i,n]),V}function U0(i,n){if(i.contains)return i.contains(n);if(i.compareDocumentPosition)return i===n||!!(i.compareDocumentPosition(n)&16)}var lb,sw;function tk(){if(sw)return lb;sw=1;var i=function(){};return lb=i,lb}var nk=tk();const ik=Sp(nk),ow=()=>{};function rk(i){return i.button===0}function ak(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}const z0=i=>i&&("current"in i?i.current:i),lw={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function sk(i,n=ow,{disabled:l,clickTrigger:d="click"}={}){const m=ce.useRef(!1),_=ce.useRef(!1),v=ce.useCallback(R=>{const z=z0(i);ik(!!z,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),m.current=!z||ak(R)||!rk(R)||!!U0(z,R.target)||_.current,_.current=!1},[i]),c=Cu(R=>{const z=z0(i);z&&U0(z,R.target)?_.current=!0:_.current=!1}),C=Cu(R=>{m.current||n(R)});ce.useEffect(()=>{var R,z;if(l||i==null)return;const B=f_(z0(i)),V=B.defaultView||window;let G=(R=V.event)!=null?R:(z=V.parent)==null?void 0:z.event,re=null;lw[d]&&(re=Zh(B,lw[d],c,!0));const fe=Zh(B,d,v,!0),pe=Zh(B,d,Ge=>{if(Ge===G){G=void 0;return}C(Ge)});let Ie=[];return"ontouchstart"in B.documentElement&&(Ie=[].slice.call(B.body.children).map(Ge=>Zh(Ge,"mousemove",ow))),()=>{re?.(),fe(),pe(),Ie.forEach(Ge=>Ge())}},[i,l,d,v,c,C])}function ok(i){const n={};return Array.isArray(i)?(i?.forEach(l=>{n[l.name]=l}),n):i||n}function lk(i={}){return Array.isArray(i)?i:Object.keys(i).map(n=>(i[n].name=n,i[n]))}function ck({enabled:i,enableEvents:n,placement:l,flip:d,offset:m,fixed:_,containerPadding:v,arrowElement:c,popperConfig:C={}}){var R,z,B,V;const G=ok(C.modifiers);return Object.assign({},C,{placement:l,enabled:i,strategy:_?"fixed":C.strategy,modifiers:lk(Object.assign({},G,{eventListeners:{enabled:n,options:(R=G.eventListeners)==null?void 0:R.options},preventOverflow:Object.assign({},G.preventOverflow,{options:Object.assign({padding:v},(z=G.preventOverflow)==null?void 0:z.options)}),offset:{options:Object.assign({offset:m},(B=G.offset)==null?void 0:B.options)},arrow:Object.assign({},G.arrow,{enabled:!!c,options:Object.assign({},(V=G.arrow)==null?void 0:V.options,{element:c})}),flip:Object.assign({enabled:!!d},G.flip)}))})}const uk=ce.createContext(null),hk="data-rr-ui-";function dk(i){return`${hk}${i}`}const bT=ce.createContext(cv?window:void 0);bT.Provider;function Ax(){return ce.useContext(bT)}const fk=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",pk=typeof document<"u",xT=pk||fk?ce.useLayoutEffect:ce.useEffect,__=ce.createContext(null);__.displayName="NavbarContext";const mk={type:Wh.string,tooltip:Wh.bool,as:Wh.elementType},fv=ce.forwardRef(({as:i="div",className:n,type:l="valid",tooltip:d=!1,...m},_)=>ne.jsx(i,{...m,ref:_,className:An(n,`${l}-${d?"tooltip":"feedback"}`)}));fv.displayName="Feedback";fv.propTypes=mk;const id=ce.createContext({}),Mx=ce.forwardRef(({id:i,bsPrefix:n,className:l,type:d="checkbox",isValid:m=!1,isInvalid:_=!1,as:v="input",...c},C)=>{const{controlId:R}=ce.useContext(id);return n=Un(n,"form-check-input"),ne.jsx(v,{...c,ref:C,type:d,id:i||R,className:An(l,n,m&&"is-valid",_&&"is-invalid")})});Mx.displayName="FormCheckInput";const V0=ce.forwardRef(({bsPrefix:i,className:n,htmlFor:l,...d},m)=>{const{controlId:_}=ce.useContext(id);return i=Un(i,"form-check-label"),ne.jsx("label",{...d,ref:m,htmlFor:l||_,className:An(n,i)})});V0.displayName="FormCheckLabel";const wT=ce.forwardRef(({id:i,bsPrefix:n,bsSwitchPrefix:l,inline:d=!1,reverse:m=!1,disabled:_=!1,isValid:v=!1,isInvalid:c=!1,feedbackTooltip:C=!1,feedback:R,feedbackType:z,className:B,style:V,title:G="",type:re="checkbox",label:fe,children:pe,as:Ie="input",...Ge},je)=>{n=Un(n,"form-check"),l=Un(l,"form-switch");const{controlId:He}=ce.useContext(id),Ve=ce.useMemo(()=>({controlId:i||He}),[He,i]),rt=!pe&&fe!=null&&fe!==!1||GC(pe,V0),Je=ne.jsx(Mx,{...Ge,type:re==="switch"?"checkbox":re,ref:je,isValid:v,isInvalid:c,disabled:_,as:Ie});return ne.jsx(id.Provider,{value:Ve,children:ne.jsx("div",{style:V,className:An(B,rt&&n,d&&`${n}-inline`,m&&`${n}-reverse`,re==="switch"&&l),children:pe||ne.jsxs(ne.Fragment,{children:[Je,rt&&ne.jsx(V0,{title:G,children:fe}),R&&ne.jsx(fv,{type:z,tooltip:C,children:R})]})})})});wT.displayName="FormCheck";const G0=Object.assign(wT,{Input:Mx,Label:V0}),TT=ce.forwardRef(({bsPrefix:i,type:n,size:l,htmlSize:d,id:m,className:_,isValid:v=!1,isInvalid:c=!1,plaintext:C,readOnly:R,as:z="input",...B},V)=>{const{controlId:G}=ce.useContext(id);return i=Un(i,"form-control"),ne.jsx(z,{...B,type:n,size:d,ref:V,readOnly:R,id:m||G,className:An(_,C?`${i}-plaintext`:i,l&&`${i}-${l}`,n==="color"&&`${i}-color`,v&&"is-valid",c&&"is-invalid")})});TT.displayName="FormControl";const gk=Object.assign(TT,{Feedback:fv}),ST=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Un(n,"form-floating"),ne.jsx(l,{ref:m,className:An(i,n),...d})));ST.displayName="FormFloating";const Cx=ce.forwardRef(({controlId:i,as:n="div",...l},d)=>{const m=ce.useMemo(()=>({controlId:i}),[i]);return ne.jsx(id.Provider,{value:m,children:ne.jsx(n,{...l,ref:d})})});Cx.displayName="FormGroup";const ET=ce.forwardRef(({as:i="label",bsPrefix:n,column:l=!1,visuallyHidden:d=!1,className:m,htmlFor:_,...v},c)=>{const{controlId:C}=ce.useContext(id);n=Un(n,"form-label");let R="col-form-label";typeof l=="string"&&(R=`${R} ${R}-${l}`);const z=An(m,n,d&&"visually-hidden",l&&R);return _=_||C,l?ne.jsx(uT,{ref:c,as:"label",className:z,htmlFor:_,...v}):ne.jsx(i,{ref:c,className:z,htmlFor:_,...v})});ET.displayName="FormLabel";const AT=ce.forwardRef(({bsPrefix:i,className:n,id:l,...d},m)=>{const{controlId:_}=ce.useContext(id);return i=Un(i,"form-range"),ne.jsx("input",{...d,type:"range",ref:m,className:An(n,i),id:l||_})});AT.displayName="FormRange";const MT=ce.forwardRef(({bsPrefix:i,size:n,htmlSize:l,className:d,isValid:m=!1,isInvalid:_=!1,id:v,...c},C)=>{const{controlId:R}=ce.useContext(id);return i=Un(i,"form-select"),ne.jsx("select",{...c,size:l,ref:C,className:An(d,i,n&&`${i}-${n}`,m&&"is-valid",_&&"is-invalid"),id:v||R})});MT.displayName="FormSelect";const CT=ce.forwardRef(({bsPrefix:i,className:n,as:l="small",muted:d,...m},_)=>(i=Un(i,"form-text"),ne.jsx(l,{...m,ref:_,className:An(n,i,d&&"text-muted")})));CT.displayName="FormText";const DT=ce.forwardRef((i,n)=>ne.jsx(G0,{...i,ref:n,type:"switch"}));DT.displayName="Switch";const yk=Object.assign(DT,{Input:G0.Input,Label:G0.Label}),kT=ce.forwardRef(({bsPrefix:i,className:n,children:l,controlId:d,label:m,..._},v)=>(i=Un(i,"form-floating"),ne.jsxs(Cx,{ref:v,className:An(n,i),controlId:d,..._,children:[l,ne.jsx("label",{htmlFor:d,children:m})]})));kT.displayName="FloatingLabel";const _k={_ref:Wh.any,validated:Wh.bool,as:Wh.elementType},Dx=ce.forwardRef(({className:i,validated:n,as:l="form",...d},m)=>ne.jsx(l,{...d,ref:m,className:An(i,n&&"was-validated")}));Dx.displayName="Form";Dx.propTypes=_k;const xi=Object.assign(Dx,{Group:Cx,Control:gk,Floating:ST,Check:G0,Switch:yk,Label:ET,Text:CT,Range:AT,Select:MT,FloatingLabel:kT}),cw=i=>!i||typeof i=="function"?i:n=>{i.current=n};function vk(i,n){const l=cw(i),d=cw(n);return m=>{l&&l(m),d&&d(m)}}function pv(i,n){return ce.useMemo(()=>vk(i,n),[i,n])}function cb(i){i===void 0&&(i=f_());try{var n=i.activeElement;return!n||!n.nodeName?null:n}catch{return i.body}}function bk(i){const n=ce.useRef(i);return n.current=i,n}function xk(i){const n=bk(i);ce.useEffect(()=>()=>n.current(),[])}function wk(i=document){const n=i.defaultView;return Math.abs(n.innerWidth-i.documentElement.clientWidth)}const uw=dk("modal-open");class kx{constructor({ownerDocument:n,handleContainerOverflow:l=!0,isRTL:d=!1}={}){this.handleContainerOverflow=l,this.isRTL=d,this.modals=[],this.ownerDocument=n}getScrollbarWidth(){return wk(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(n){}removeModalAttributes(n){}setContainerStyle(n){const l={overflow:"hidden"},d=this.isRTL?"paddingLeft":"paddingRight",m=this.getElement();n.style={overflow:m.style.overflow,[d]:m.style[d]},n.scrollBarWidth&&(l[d]=`${parseInt(Xh(m,d)||"0",10)+n.scrollBarWidth}px`),m.setAttribute(uw,""),Xh(m,l)}reset(){[...this.modals].forEach(n=>this.remove(n))}removeContainerStyle(n){const l=this.getElement();l.removeAttribute(uw),Object.assign(l.style,n.style)}add(n){let l=this.modals.indexOf(n);return l!==-1||(l=this.modals.length,this.modals.push(n),this.setModalAttributes(n),l!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),l}remove(n){const l=this.modals.indexOf(n);l!==-1&&(this.modals.splice(l,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(n))}isTopModal(n){return!!this.modals.length&&this.modals[this.modals.length-1]===n}}const ub=(i,n)=>cv?i==null?(n||f_()).body:(typeof i=="function"&&(i=i()),i&&"current"in i&&(i=i.current),i&&("nodeType"in i||i.getBoundingClientRect)?i:null):null;function Pb(i,n){const l=Ax(),[d,m]=ce.useState(()=>ub(i,l?.document));if(!d){const _=ub(i);_&&m(_)}return ce.useEffect(()=>{},[n,d]),ce.useEffect(()=>{const _=ub(i);_!==d&&m(_)},[i,d]),d}function Tk({children:i,in:n,onExited:l,mountOnEnter:d,unmountOnExit:m}){const _=ce.useRef(null),v=ce.useRef(n),c=Cu(l);ce.useEffect(()=>{n?v.current=!0:c(_.current)},[n,c]);const C=pv(_,vg(i)),R=ce.cloneElement(i,{ref:C});return n?R:m||!v.current&&d?null:R}const Sk=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function Ek(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}function Ak(i){let{onEnter:n,onEntering:l,onEntered:d,onExit:m,onExiting:_,onExited:v,addEndListener:c,children:C}=i,R=Ek(i,Sk);const z=ce.useRef(null),B=pv(z,vg(C)),V=He=>Ve=>{He&&z.current&&He(z.current,Ve)},G=ce.useCallback(V(n),[n]),re=ce.useCallback(V(l),[l]),fe=ce.useCallback(V(d),[d]),pe=ce.useCallback(V(m),[m]),Ie=ce.useCallback(V(_),[_]),Ge=ce.useCallback(V(v),[v]),je=ce.useCallback(V(c),[c]);return Object.assign({},R,{nodeRef:z},n&&{onEnter:G},l&&{onEntering:re},d&&{onEntered:fe},m&&{onExit:pe},_&&{onExiting:Ie},v&&{onExited:Ge},c&&{addEndListener:je},{children:typeof C=="function"?(He,Ve)=>C(He,Object.assign({},Ve,{ref:B})):ce.cloneElement(C,{ref:B})})}const Mk=["component"];function Ck(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}const Dk=ce.forwardRef((i,n)=>{let{component:l}=i,d=Ck(i,Mk);const m=Ak(d);return ne.jsx(l,Object.assign({ref:n},m))});function kk({in:i,onTransition:n}){const l=ce.useRef(null),d=ce.useRef(!0),m=Cu(n);return H1(()=>{if(!l.current)return;let _=!1;return m({in:i,element:l.current,initial:d.current,isStale:()=>_}),()=>{_=!0}},[i,m]),H1(()=>(d.current=!1,()=>{d.current=!0}),[]),l}function Rk({children:i,in:n,onExited:l,onEntered:d,transition:m}){const[_,v]=ce.useState(!n);n&&_&&v(!1);const c=kk({in:!!n,onTransition:R=>{const z=()=>{R.isStale()||(R.in?d?.(R.element,R.initial):(v(!0),l?.(R.element)))};Promise.resolve(m(R)).then(z,B=>{throw R.in||v(!0),B})}}),C=pv(c,vg(i));return _&&!n?null:ce.cloneElement(i,{ref:C})}function Nb(i,n,l){return i?ne.jsx(Dk,Object.assign({},l,{component:i})):n?ne.jsx(Rk,Object.assign({},l,{transition:n})):ne.jsx(Tk,Object.assign({},l))}const Ik=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Pk(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}let hb;function Nk(i){return hb||(hb=new kx({ownerDocument:i?.document})),hb}function zk(i){const n=Ax(),l=i||Nk(n),d=ce.useRef({dialog:null,backdrop:null});return Object.assign(d.current,{add:()=>l.add(d.current),remove:()=>l.remove(d.current),isTopModal:()=>l.isTopModal(d.current),setDialogRef:ce.useCallback(m=>{d.current.dialog=m},[]),setBackdropRef:ce.useCallback(m=>{d.current.backdrop=m},[])})}const RT=ce.forwardRef((i,n)=>{let{show:l=!1,role:d="dialog",className:m,style:_,children:v,backdrop:c=!0,keyboard:C=!0,onBackdropClick:R,onEscapeKeyDown:z,transition:B,runTransition:V,backdropTransition:G,runBackdropTransition:re,autoFocus:fe=!0,enforceFocus:pe=!0,restoreFocus:Ie=!0,restoreFocusOptions:Ge,renderDialog:je,renderBackdrop:He=Nn=>ne.jsx("div",Object.assign({},Nn)),manager:Ve,container:rt,onShow:Je,onHide:Mt=()=>{},onExit:Ne,onExited:Xe,onExiting:_t,onEnter:Rt,onEntering:Ut,onEntered:un}=i,Ht=Pk(i,Ik);const Ue=Ax(),ft=Pb(rt),Dt=zk(Ve),It=lT(),be=NC(l),[et,Et]=ce.useState(!l),bt=ce.useRef(null);ce.useImperativeHandle(n,()=>Dt,[Dt]),cv&&!be&&l&&(bt.current=cb(Ue?.document)),l&&et&&Et(!1);const Pt=Cu(()=>{if(Dt.add(),ya.current=Zh(document,"keydown",fn),mi.current=Zh(document,"focus",()=>setTimeout(Bt),!0),Je&&Je(),fe){var Nn,Br;const Li=cb((Nn=(Br=Dt.dialog)==null?void 0:Br.ownerDocument)!=null?Nn:Ue?.document);Dt.dialog&&Li&&!U0(Dt.dialog,Li)&&(bt.current=Li,Dt.dialog.focus())}}),Xt=Cu(()=>{if(Dt.remove(),ya.current==null||ya.current(),mi.current==null||mi.current(),Ie){var Nn;(Nn=bt.current)==null||Nn.focus==null||Nn.focus(Ge),bt.current=null}});ce.useEffect(()=>{!l||!ft||Pt()},[l,ft,Pt]),ce.useEffect(()=>{et&&Xt()},[et,Xt]),xk(()=>{Xt()});const Bt=Cu(()=>{if(!pe||!It()||!Dt.isTopModal())return;const Nn=cb(Ue?.document);Dt.dialog&&Nn&&!U0(Dt.dialog,Nn)&&Dt.dialog.focus()}),wi=Cu(Nn=>{Nn.target===Nn.currentTarget&&(R?.(Nn),c===!0&&Mt())}),fn=Cu(Nn=>{C&&eT(Nn)&&Dt.isTopModal()&&(z?.(Nn),Nn.defaultPrevented||Mt())}),mi=ce.useRef(),ya=ce.useRef(),sa=(...Nn)=>{Et(!0),Xe?.(...Nn)};if(!ft)return null;const rr=Object.assign({role:d,ref:Dt.setDialogRef,"aria-modal":d==="dialog"?!0:void 0},Ht,{style:_,className:m,tabIndex:-1});let Yn=je?je(rr):ne.jsx("div",Object.assign({},rr,{children:ce.cloneElement(v,{role:"document"})}));Yn=Nb(B,V,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!l,onExit:Ne,onExiting:_t,onExited:sa,onEnter:Rt,onEntering:Ut,onEntered:un,children:Yn});let Wn=null;return c&&(Wn=He({ref:Dt.setBackdropRef,onClick:wi}),Wn=Nb(G,re,{in:!!l,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Wn})),ne.jsx(ne.Fragment,{children:lp.createPortal(ne.jsxs(ne.Fragment,{children:[Wn,Yn]}),ft)})});RT.displayName="Modal";const Lk=Object.assign(RT,{Manager:kx});function zb(i,n){return i.classList?!!n&&i.classList.contains(n):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+n+" ")!==-1}function Ok(i,n){i.classList?i.classList.add(n):zb(i,n)||(typeof i.className=="string"?i.className=i.className+" "+n:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+n))}function hw(i,n){return i.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function jk(i,n){i.classList?i.classList.remove(n):typeof i.className=="string"?i.className=hw(i.className,n):i.setAttribute("class",hw(i.className&&i.className.baseVal||"",n))}const Gm={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class IT extends kx{adjustAndStore(n,l,d){const m=l.style[n];l.dataset[n]=m,Xh(l,{[n]:`${parseFloat(Xh(l,n))+d}px`})}restore(n,l){const d=l.dataset[n];d!==void 0&&(delete l.dataset[n],Xh(l,{[n]:d}))}setContainerStyle(n){super.setContainerStyle(n);const l=this.getElement();if(Ok(l,"modal-open"),!n.scrollBarWidth)return;const d=this.isRTL?"paddingLeft":"paddingRight",m=this.isRTL?"marginLeft":"marginRight";Vm(l,Gm.FIXED_CONTENT).forEach(_=>this.adjustAndStore(d,_,n.scrollBarWidth)),Vm(l,Gm.STICKY_CONTENT).forEach(_=>this.adjustAndStore(m,_,-n.scrollBarWidth)),Vm(l,Gm.NAVBAR_TOGGLER).forEach(_=>this.adjustAndStore(m,_,n.scrollBarWidth))}removeContainerStyle(n){super.removeContainerStyle(n);const l=this.getElement();jk(l,"modal-open");const d=this.isRTL?"paddingLeft":"paddingRight",m=this.isRTL?"marginLeft":"marginRight";Vm(l,Gm.FIXED_CONTENT).forEach(_=>this.restore(d,_)),Vm(l,Gm.STICKY_CONTENT).forEach(_=>this.restore(m,_)),Vm(l,Gm.NAVBAR_TOGGLER).forEach(_=>this.restore(m,_))}}let db;function Bk(i){return db||(db=new IT(i)),db}const PT=ce.createContext({onHide(){}}),NT=ce.forwardRef(({closeLabel:i="Close",closeVariant:n,closeButton:l=!1,onHide:d,children:m,..._},v)=>{const c=ce.useContext(PT),C=m_(()=>{c?.onHide(),d?.()});return ne.jsxs("div",{ref:v,..._,children:[m,l&&ne.jsx(yx,{"aria-label":i,variant:n,onClick:C})]})});NT.displayName="AbstractModalHeader";const zT=ce.forwardRef(({bsPrefix:i,className:n,as:l,...d},m)=>{i=Un(i,"navbar-brand");const _=l||(d.href?"a":"span");return ne.jsx(_,{...d,ref:m,className:An(n,i)})});zT.displayName="NavbarBrand";const LT=ce.forwardRef(({children:i,bsPrefix:n,...l},d)=>{n=Un(n,"navbar-collapse");const m=ce.useContext(__);return ne.jsx(px,{in:!!(m&&m.expanded),...l,children:ne.jsx("div",{ref:d,className:n,children:i})})});LT.displayName="NavbarCollapse";const OT=ce.forwardRef(({bsPrefix:i,className:n,children:l,label:d="Toggle navigation",as:m="button",onClick:_,...v},c)=>{i=Un(i,"navbar-toggler");const{onToggle:C,expanded:R}=ce.useContext(__)||{},z=m_(B=>{_&&_(B),C&&C()});return m==="button"&&(v.type="button"),ne.jsx(m,{...v,ref:c,onClick:z,"aria-label":d,className:An(n,i,!R&&"collapsed"),children:l||ne.jsx("span",{className:`${i}-icon`})})});OT.displayName="NavbarToggle";const Lb=new WeakMap,dw=(i,n)=>{if(!i||!n)return;const l=Lb.get(n)||new Map;Lb.set(n,l);let d=l.get(i);return d||(d=n.matchMedia(i),d.refCount=0,l.set(d.media,d)),d};function Fk(i,n=typeof window>"u"?void 0:window){const l=dw(i,n),[d,m]=ce.useState(()=>l?l.matches:!1);return xT(()=>{let _=dw(i,n);if(!_)return m(!1);let v=Lb.get(n);const c=()=>{m(_.matches)};return _.refCount++,_.addListener(c),c(),()=>{_.removeListener(c),_.refCount--,_.refCount<=0&&v?.delete(_.media),_=void 0}},[i]),d}function Uk(i){const n=Object.keys(i);function l(c,C){return c===C?C:c?`${c} and ${C}`:C}function d(c){return n[Math.min(n.indexOf(c)+1,n.length-1)]}function m(c){const C=d(c);let R=i[C];return typeof R=="number"?R=`${R-.2}px`:R=`calc(${R} - 0.2px)`,`(max-width: ${R})`}function _(c){let C=i[c];return typeof C=="number"&&(C=`${C}px`),`(min-width: ${C})`}function v(c,C,R){let z;typeof c=="object"?(z=c,R=C,C=!0):(C=C||!0,z={[c]:C});let B=ce.useMemo(()=>Object.entries(z).reduce((V,[G,re])=>((re==="up"||re===!0)&&(V=l(V,_(G))),(re==="down"||re===!0)&&(V=l(V,m(G))),V),""),[JSON.stringify(z)]);return Fk(B,R)}return v}const Vk=Uk({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),jT=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Un(n,"offcanvas-body"),ne.jsx(l,{ref:m,className:An(i,n),...d})));jT.displayName="OffcanvasBody";const Gk={[Rc]:"show",[Fh]:"show"},BT=ce.forwardRef(({bsPrefix:i,className:n,children:l,in:d=!1,mountOnEnter:m=!1,unmountOnExit:_=!1,appear:v=!1,...c},C)=>(i=Un(i,"offcanvas"),ne.jsx(uv,{ref:C,addEndListener:fx,in:d,mountOnEnter:m,unmountOnExit:_,appear:v,...c,childRef:vg(l),children:(R,z)=>ce.cloneElement(l,{...z,className:An(n,l.props.className,(R===Rc||R===Ky)&&`${i}-toggling`,Gk[R])})})));BT.displayName="OffcanvasToggling";const FT=ce.forwardRef(({bsPrefix:i,className:n,closeLabel:l="Close",closeButton:d=!1,...m},_)=>(i=Un(i,"offcanvas-header"),ne.jsx(NT,{ref:_,...m,className:An(n,i),closeLabel:l,closeButton:d})));FT.displayName="OffcanvasHeader";const Zk=IC("h5"),UT=ce.forwardRef(({className:i,bsPrefix:n,as:l=Zk,...d},m)=>(n=Un(n,"offcanvas-title"),ne.jsx(l,{ref:m,className:An(i,n),...d})));UT.displayName="OffcanvasTitle";function $k(i){return ne.jsx(BT,{...i})}function Yk(i){return ne.jsx(B0,{...i})}const VT=ce.forwardRef(({bsPrefix:i,className:n,children:l,"aria-labelledby":d,placement:m="start",responsive:_,show:v=!1,backdrop:c=!0,keyboard:C=!0,scroll:R=!1,onEscapeKeyDown:z,onShow:B,onHide:V,container:G,autoFocus:re=!0,enforceFocus:fe=!0,restoreFocus:pe=!0,restoreFocusOptions:Ie,onEntered:Ge,onExit:je,onExiting:He,onEnter:Ve,onEntering:rt,onExited:Je,backdropClassName:Mt,manager:Ne,renderStaticNode:Xe=!1,..._t},Rt)=>{const Ut=ce.useRef();i=Un(i,"offcanvas");const[un,Ht]=ce.useState(!1),Ue=m_(V),ft=Vk(_||"xs","up");ce.useEffect(()=>{Ht(_?v&&!ft:v)},[v,_,ft]);const Dt=ce.useMemo(()=>({onHide:Ue}),[Ue]);function It(){return Ne||(R?(Ut.current||(Ut.current=new IT({handleContainerOverflow:!1})),Ut.current):Bk())}const be=(Pt,...Xt)=>{Pt&&(Pt.style.visibility="visible"),Ve?.(Pt,...Xt)},et=(Pt,...Xt)=>{Pt&&(Pt.style.visibility=""),Je?.(...Xt)},Et=ce.useCallback(Pt=>ne.jsx("div",{...Pt,className:An(`${i}-backdrop`,Mt)}),[Mt,i]),bt=Pt=>ne.jsx("div",{...Pt,..._t,className:An(n,_?`${i}-${_}`:i,`${i}-${m}`),"aria-labelledby":d,children:l});return ne.jsxs(ne.Fragment,{children:[!un&&(_||Xe)&&bt({}),ne.jsx(PT.Provider,{value:Dt,children:ne.jsx(Lk,{show:un,ref:Rt,backdrop:c,container:G,keyboard:C,autoFocus:re,enforceFocus:fe&&!R,restoreFocus:pe,restoreFocusOptions:Ie,onEscapeKeyDown:z,onShow:B,onHide:Ue,onEnter:be,onEntering:rt,onEntered:Ge,onExit:je,onExiting:He,onExited:et,manager:It(),transition:$k,backdropTransition:Yk,renderBackdrop:Et,renderDialog:bt})})]})});VT.displayName="Offcanvas";const qk=Object.assign(VT,{Body:jT,Header:FT,Title:UT}),GT=ce.forwardRef(({onHide:i,...n},l)=>{const d=ce.useContext(__),m=m_(()=>{d==null||d.onToggle==null||d.onToggle(),i?.()});return ne.jsx(qk,{ref:l,show:!!(d!=null&&d.expanded),...n,renderStaticNode:!0,onHide:m})});GT.displayName="NavbarOffcanvas";const ZT=ce.forwardRef(({className:i,bsPrefix:n,as:l="span",...d},m)=>(n=Un(n,"navbar-text"),ne.jsx(l,{ref:m,className:An(i,n),...d})));ZT.displayName="NavbarText";const $T=ce.forwardRef((i,n)=>{const{bsPrefix:l,expand:d=!0,variant:m="light",bg:_,fixed:v,sticky:c,className:C,as:R="nav",expanded:z,onToggle:B,onSelect:V,collapseOnSelect:G=!1,...re}=Q2(i,{expanded:"onToggle"}),fe=Un(l,"navbar"),pe=ce.useCallback((...je)=>{V?.(...je),G&&z&&B?.(!1)},[V,G,z,B]);re.role===void 0&&R!=="nav"&&(re.role="navigation");let Ie=`${fe}-expand`;typeof d=="string"&&(Ie=`${Ie}-${d}`);const Ge=ce.useMemo(()=>({onToggle:()=>B?.(!z),bsPrefix:fe,expanded:!!z,expand:d}),[fe,z,d,B]);return ne.jsx(__.Provider,{value:Ge,children:ne.jsx(uk.Provider,{value:pe,children:ne.jsx(R,{ref:n,...re,className:An(C,fe,d&&Ie,m&&`${fe}-${m}`,_&&`bg-${_}`,c&&`sticky-${c}`,v&&`fixed-${v}`)})})})});$T.displayName="Navbar";const Hk=Object.assign($T,{Brand:zT,Collapse:LT,Offcanvas:GT,Text:ZT,Toggle:OT}),Xk=()=>{};function Wk(i,n,{disabled:l,clickTrigger:d}={}){const m=n||Xk;sk(i,m,{disabled:l,clickTrigger:d});const _=Cu(v=>{eT(v)&&m(v)});ce.useEffect(()=>{if(l||i==null)return;const v=f_(z0(i));let c=(v.defaultView||window).event;const C=Zh(v,"keyup",R=>{if(R===c){c=void 0;return}_(R)});return()=>{C()}},[i,l,_])}const YT=ce.forwardRef((i,n)=>{const{flip:l,offset:d,placement:m,containerPadding:_,popperConfig:v={},transition:c,runTransition:C}=i,[R,z]=q1(),[B,V]=q1(),G=pv(z,n),re=Pb(i.container),fe=Pb(i.target),[pe,Ie]=ce.useState(!i.show),Ge=ek(fe,R,ck({placement:m,enableEvents:!!i.show,containerPadding:_||5,flip:l,offset:d,arrowElement:B,popperConfig:v}));i.show&&pe&&Ie(!1);const je=(..._t)=>{Ie(!0),i.onExited&&i.onExited(..._t)},He=i.show||!pe;if(Wk(R,i.onHide,{disabled:!i.rootClose||i.rootCloseDisabled,clickTrigger:i.rootCloseEvent}),!He)return null;const{onExit:Ve,onExiting:rt,onEnter:Je,onEntering:Mt,onEntered:Ne}=i;let Xe=i.children(Object.assign({},Ge.attributes.popper,{style:Ge.styles.popper,ref:G}),{popper:Ge,placement:m,show:!!i.show,arrowProps:Object.assign({},Ge.attributes.arrow,{style:Ge.styles.arrow,ref:V})});return Xe=Nb(c,C,{in:!!i.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Xe,onExit:Ve,onExiting:rt,onExited:je,onEnter:Je,onEntering:Mt,onEntered:Ne}),re?lp.createPortal(Xe,re):null});YT.displayName="Overlay";const qT=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Un(n,"popover-header"),ne.jsx(l,{ref:m,className:An(i,n),...d})));qT.displayName="PopoverHeader";const Rx=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Un(n,"popover-body"),ne.jsx(l,{ref:m,className:An(i,n),...d})));Rx.displayName="PopoverBody";function HT(i,n){let l=i;return i==="left"?l=n?"end":"start":i==="right"&&(l=n?"start":"end"),l}function XT(i="absolute"){return{position:i,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const WT=ce.forwardRef(({bsPrefix:i,placement:n="right",className:l,style:d,children:m,body:_,arrowProps:v,hasDoneInitialMeasure:c,popper:C,show:R,...z},B)=>{const V=Un(i,"popover"),G=K2(),[re]=n?.split("-")||[],fe=HT(re,G);let pe=d;return R&&!c&&(pe={...d,...XT(C?.strategy)}),ne.jsxs("div",{ref:B,role:"tooltip",style:pe,"x-placement":re,className:An(l,V,re&&`bs-popover-${fe}`),...z,children:[ne.jsx("div",{className:"popover-arrow",...v}),_?ne.jsx(Rx,{children:m}):m]})});WT.displayName="Popover";const Qk=Object.assign(WT,{Header:qT,Body:Rx,POPPER_OFFSET:[0,8]}),QT=ce.forwardRef(({bsPrefix:i,placement:n="right",className:l,style:d,children:m,arrowProps:_,hasDoneInitialMeasure:v,popper:c,show:C,...R},z)=>{i=Un(i,"tooltip");const B=K2(),[V]=n?.split("-")||[],G=HT(V,B);let re=d;return C&&!v&&(re={...d,...XT(c?.strategy)}),ne.jsxs("div",{ref:z,style:re,role:"tooltip","x-placement":V,className:An(l,i,`bs-tooltip-${G}`),...R,children:[ne.jsx("div",{className:"tooltip-arrow",..._}),ne.jsx("div",{className:`${i}-inner`,children:m})]})});QT.displayName="Tooltip";const Kk=Object.assign(QT,{TOOLTIP_OFFSET:[0,6]});function Jk(i){const n=ce.useRef(null),l=Un(void 0,"popover"),d=Un(void 0,"tooltip"),m=ce.useMemo(()=>({name:"offset",options:{offset:()=>{if(i)return i;if(n.current){if(zb(n.current,l))return Qk.POPPER_OFFSET;if(zb(n.current,d))return Kk.TOOLTIP_OFFSET}return[0,0]}}}),[i,l,d]);return[n,[m]]}function eR(i,n){const{ref:l}=i,{ref:d}=n;i.ref=l.__wrapped||(l.__wrapped=m=>l(kb(m))),n.ref=d.__wrapped||(d.__wrapped=m=>d(kb(m)))}const KT=ce.forwardRef(({children:i,transition:n=B0,popperConfig:l={},rootClose:d=!1,placement:m="top",show:_=!1,...v},c)=>{const C=ce.useRef({}),[R,z]=ce.useState(null),[B,V]=Jk(v.offset),G=nT(c,B),re=n===!0?B0:n||void 0,fe=m_(pe=>{z(pe),l==null||l.onFirstUpdate==null||l.onFirstUpdate(pe)});return xT(()=>{R&&v.target&&(C.current.scheduleUpdate==null||C.current.scheduleUpdate())},[R,v.target]),ce.useEffect(()=>{_||z(null)},[_]),ne.jsx(YT,{...v,ref:G,popperConfig:{...l,modifiers:V.concat(l.modifiers||[]),onFirstUpdate:fe},transition:re,rootClose:d,placement:m,show:_,children:(pe,{arrowProps:Ie,popper:Ge,show:je})=>{var He;eR(pe,Ie);const Ve=Ge?.placement,rt=Object.assign(C.current,{state:Ge?.state,scheduleUpdate:Ge?.update,placement:Ve,outOfBoundaries:(Ge==null||(He=Ge.state)==null||(He=He.modifiersData.hide)==null?void 0:He.isReferenceHidden)||!1,strategy:l.strategy}),Je=!!R;return typeof i=="function"?i({...pe,placement:Ve,show:je,...!n&&je&&{className:"show"},popper:rt,arrowProps:Ie,hasDoneInitialMeasure:Je}):ce.cloneElement(i,{...pe,placement:Ve,arrowProps:Ie,popper:rt,hasDoneInitialMeasure:Je,className:An(i.props.className,!n&&je&&"show"),style:{...i.props.style,...pe.style}})}})});KT.displayName="Overlay";const JT=ce.forwardRef(({bsPrefix:i,variant:n,animation:l="border",size:d,as:m="div",className:_,...v},c)=>{i=Un(i,"spinner");const C=`${i}-${l}`;return ne.jsx(m,{ref:c,...v,className:An(_,C,d&&`${C}-${d}`,n&&`text-${n}`)})});JT.displayName="Spinner";const eS=ce.forwardRef(({bsPrefix:i,className:n,striped:l,bordered:d,borderless:m,hover:_,size:v,variant:c,responsive:C,...R},z)=>{const B=Un(i,"table"),V=An(n,B,c&&`${B}-${c}`,v&&`${B}-${v}`,l&&`${B}-${typeof l=="string"?`striped-${l}`:"striped"}`,d&&`${B}-bordered`,m&&`${B}-borderless`,_&&`${B}-hover`),G=ne.jsx("table",{...R,className:V,ref:z});if(C){let re=`${B}-responsive`;return typeof C=="string"&&(re=`${re}-${C}`),ne.jsx("div",{className:re,children:G})}return G});eS.displayName="Table";function tR({tripQueryVariables:i,setTripQueryVariables:n,coordinates:l,onClose:d}){return ne.jsx(r2,{longitude:l.lng,latitude:l.lat,anchor:"bottom",onClose:d,children:ne.jsxs(_x,{vertical:!0,children:[ne.jsx(gp,{onClick:()=>{n({...i,from:{coordinates:{latitude:l.lat,longitude:l.lng}}}),d()},children:"Start here"}),ne.jsx(gp,{onClick:()=>{n({...i,to:{coordinates:{latitude:l.lat,longitude:l.lng}}}),d()},children:"End here"})]})})}function nR({coordinates:i,properties:n,onClose:l}){return ne.jsxs(r2,{latitude:i.lat,longitude:i.lng,closeButton:!0,onClose:()=>l(),maxWidth:"350px",children:[ne.jsx(eS,{bordered:!0,children:ne.jsx("tbody",{children:Object.entries(n).map(([d,m])=>ne.jsxs("tr",{children:[ne.jsx("th",{scope:"row",children:d}),ne.jsx("td",{children:String(m)})]},d))})}),ne.jsx("div",{className:"geometry-popup-osm-link",children:ne.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${i.lat}&mlon=${i.lng}#map=18/${i.lat}/${i.lng}`,target:"_blank",rel:"noreferrer",children:"↗️ osm.org"})})]})}const tS=i=>{const n=i.getStyle();return!n||!n.layers?[]:n.layers.filter(l=>l.type!=="raster"&&!l.id.startsWith("jsx")).filter(l=>i.getLayoutProperty(l.id,"visibility")!=="none").map(l=>l.id)},iR=({mapRef:i,setInteractiveLayerIds:n})=>{const[l,d]=ce.useState([]),[m,_]=ce.useState({});ce.useEffect(()=>{if(!i)return;const C=i.getMap(),R=()=>{const z=C.getStyle();if(!z||!z.layers)return;const B=z.layers.filter(G=>G.type==="raster").map(G=>{let re=G.id;const fe=G.metadata?.name;return fe&&(re=fe),{id:G.id,name:re}});d(B);const V={};z.layers.filter(G=>G.type!=="raster"&&!G.id.startsWith("jsx")).reverse().forEach(G=>{const re=G.metadata?.group||"Misc";V[re]||(V[re]=[]),V[re].push({id:G.id,name:G.id})}),_(V)};return C.isStyleLoaded()?R():C.on("styledata",R),()=>{C.off("styledata",R)}},[i]);const v=ce.useCallback((C,R)=>{if(!i)return;const z=i.getMap();z.setLayoutProperty(C,"visibility",R?"visible":"none");const B=tS(z);n(B)},[i,n]),c=ce.useCallback(C=>{if(!i)return;const R=i.getMap();l.forEach(z=>{R.setLayoutProperty(z.id,"visibility",z.id===C?"visible":"none")})},[i,l]);return ne.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[ne.jsx("h4",{style:{marginTop:0},children:"Background"}),ne.jsx("select",{onChange:C=>c(C.target.value),children:l.map(C=>ne.jsx("option",{value:C.id,children:C.name},C.id))}),ne.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(m).map(([C,R])=>{const z=R.every(V=>i?.getMap().getLayoutProperty(V.id,"visibility")!=="none"),B=V=>{R.forEach(G=>{v(G.id,V)})};return ne.jsxs("div",{style:{marginBottom:"10px"},children:[ne.jsx("h6",{style:{margin:"0 0 5px"},children:ne.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[ne.jsx("input",{type:"checkbox",checked:z,onChange:V=>B(V.target.checked),style:{marginRight:"5px"}}),C]})}),R.map(V=>{const G=i?.getMap().getLayoutProperty(V.id,"visibility")!=="none";return ne.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[ne.jsx("input",{type:"checkbox",checked:G,onChange:re=>v(V.id,re.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),V.name]},V.id)})]},C)})]})},rR="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class aR extends ce.Component{constructor(n){super(n),this.state={isSidebarOpen:!1,activeContent:null}}toggleSidebar=n=>{this.setState(l=>({isSidebarOpen:l.activeContent!==n||!l.isSidebarOpen,activeContent:l.activeContent===n?null:n}))};render(){const{isSidebarOpen:n,activeContent:l}=this.state,{position:d,setInteractiveLayerIds:m,mapRef:_}=this.props;return ne.jsxs("div",{children:[ne.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${l==="debugLayer"?"active":""} ${n?"open":""}`,style:{top:"20px"},children:ne.jsx("img",{src:rR,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),ne.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:n?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:n?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:n&&l==="debugLayer"&&ne.jsx(iR,{position:d,setInteractiveLayerIds:m,mapRef:_})})]})}}const sR="/otp/debug/vectortiles/style.json";function oR({tripQueryVariables:i,setTripQueryVariables:n,tripQueryResult:l,selectedTripPatternIndexes:d,loading:m}){const _=WM({tripQueryVariables:i,setTripQueryVariables:n}),[v,c]=ce.useState(null),[C,R]=ce.useState(null),[z,B]=ce.useState([]),[V,G]=ce.useState("auto"),re=ce.useCallback(()=>G("pointer"),[]),fe=ce.useCallback(()=>G("auto"),[]),pe=Ve=>{if(Ve.features){const rt=Ve.features[0];R({coordinates:Ve.lngLat,feature:rt})}},Ie=Ve=>{const rt=Ve.target;if(rt.getZoom()<2){const Je=rt.getSource("stops");rt.fitBounds(Je.bounds,{animate:!1})}},Ge=Ve=>{Ve.target.addControl(new o2.AttributionControl,"bottom-left")};function je(Ve){Ie(Ve);const rt=tS(Ve.target);B(rt),Ge(Ve)}const He=ce.useRef(null);return ne.jsx("div",{className:"map-container below-content",children:ne.jsxs(FE,{attributionControl:!1,mapLib:n2(()=>Promise.resolve().then(()=>l2),void 0),mapStyle:sR,onDblClick:_,onContextMenu:Ve=>{c(Ve.lngLat)},interactiveLayerIds:z,cursor:V,onMouseEnter:re,onMouseLeave:fe,onClick:pe,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:je,ref:He,children:[ne.jsx(YE,{position:"top-left"}),ne.jsx(ZM,{setCursor:G,tripQueryVariables:i,setTripQueryVariables:n,loading:m}),ne.jsx(aR,{position:"top-right",setInteractiveLayerIds:B,mapRef:He?.current}),l?.trip.tripPatterns.length&&d.map(Ve=>{const rt=l.trip.tripPatterns[Ve];return rt?ne.jsx(qM,{tripPattern:rt},`trippattern-${Ve}`):null}),v&&ne.jsx(tR,{tripQueryVariables:i,setTripQueryVariables:n,coordinates:v,onClose:()=>c(null)}),C?.feature?.properties&&ne.jsx(nR,{coordinates:C?.coordinates,properties:C?.feature?.properties,onClose:()=>R(null)})]})})}function lR(){const[i,n]=ce.useState(0),l=ce.useRef(null);return ce.useLayoutEffect(()=>{l.current&&n(l.current.getBoundingClientRect().width)},[]),ce.useEffect(()=>{const d=()=>{l.current&&n(l.current.getBoundingClientRect().width)};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]),{containerRef:l,containerWidth:i}}const cR=70,uR=20,Ob=40;function hR(i,n,l,d){const m=ce.useMemo(()=>new Date(d).getTime()-new Date(l).getTime(),[l,d]),_=ce.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(l).getTime())/m,[i.expectedStartTime,l,m]),v=ce.useMemo(()=>new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime(),[i.expectedStartTime,i.expectedEndTime]),c=uR+Ob,R=n-cR-Ob-c,z=c+_*R,B=R*(v/m);return{maxSpan:m,startPx:c,pxSpan:R,widthPx:B,leftPx:z}}const dR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",fR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",pR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",mR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",gR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",yR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",_R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",vR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",bR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",xR="https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-25T11:23/assets/monorail-CEIE-7ZV.png",wR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",TR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABHNCSVQICAgIfAhkiAAAAFtJREFUKJFjYCAOCBGpDif4D8UUG8LAwMDAwESJKaOaaaj5GwOZ8fyfgYHBAomNIYkrBYkyMDD8wKaOhYGBYTEWg9CBJBax5YxYNDBiUYjNYBR1y/FoQgZwlwIAXKYUAUY5kWQAAAAASUVORK5CYII=",SR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",ER="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",AR="https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-25T11:23/assets/trolleybus-BefhFtdd.png",MR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function CR(i){return i===vi.Rail||i===vi.Coach||i===vi.Metro||i===vi.Bus||i===vi.Tram||i===vi.Water||i===vi.Air||i===vi.Cableway||i===vi.Funicular||i===vi.Trolleybus||i===vi.Monorail||i===vi.Taxi}function DR(i){const n=kR(i);function l(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const d=l(n[0]/255),m=l(n[1]/255),_=l(n[2]/255);return .2126*d+.7152*m+.0722*_>.179?"#000":"#fff"}function kR(i){return RR(i)}function RR(i){return i.length===4?IR(i):[parseInt(i.slice(1,3),16),parseInt(i.slice(3,5),16),parseInt(i.slice(5,7),16)]}function IR(i){const n=i.slice(1,2),l=i.slice(2,3),d=i.slice(3,4);return[parseInt(n+n,16),parseInt(l+l,16),parseInt(d+d,16)]}function PR(i,n,l,d,m){const _=ce.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(n).getTime())/l,[i.expectedStartTime,n,l]),v=ce.useMemo(()=>m*(new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime())/l-1,[m,i,l]),c=d+_*m+1,C=v>40&&CR(i.mode)&&i.line?.publicCode&&i.line.publicCode.length<=6,R=H2(i),z=ce.useMemo(()=>DR(R),[R]);return{widthPx:v,leftPx:c,legTextColor:z,modeColor:R,showPublicCode:C}}const NR=Object.assign({"../../static/img/mode/air.png":dR,"../../static/img/mode/bicycle.png":fR,"../../static/img/mode/bus.png":pR,"../../static/img/mode/cableway.png":mR,"../../static/img/mode/car.png":gR,"../../static/img/mode/coach.png":yR,"../../static/img/mode/foot.png":_R,"../../static/img/mode/funicular.png":vR,"../../static/img/mode/metro.png":bR,"../../static/img/mode/monorail.png":xR,"../../static/img/mode/rail.png":wR,"../../static/img/mode/scooter.png":TR,"../../static/img/mode/taxi.png":SR,"../../static/img/mode/tram.png":ER,"../../static/img/mode/trolleybus.png":AR,"../../static/img/mode/water.png":MR});function zR(i){return NR[`../../static/img/mode/${i.mode.toLowerCase()}.png`]}function LR({leg:i,earliestStartTime:n,maxSpan:l,startPx:d,pxSpan:m}){const{widthPx:_,leftPx:v,legTextColor:c,modeColor:C,showPublicCode:R}=PR(i,n,l,d,m),z=zR(i);return ne.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${_}px`,left:v,color:c,background:C},children:[ne.jsx("div",{className:"itinerary-header-leg-icon",style:{background:c,maskImage:`url(${z})`,WebkitMaskImage:`url(${z})`}}),R&&ne.jsx("span",{className:"itinerary-header-leg-public-code",children:i.line?.publicCode})]})}function Zy(i,n,l){return new Date(i).toLocaleTimeString("en-US",{timeStyle:l,hourCycle:"h24",timeZone:n})}const v_=ce.createContext("UTC");function OR({tripPattern:i,itineraryIndex:n,containerWidth:l,earliestStartTime:d,latestEndTime:m}){const{maxSpan:_,pxSpan:v,startPx:c,widthPx:C,leftPx:R}=hR(i,l,d,m),z=ce.useContext(v_),B=ce.useMemo(()=>Zy(i.expectedStartTime,z,"short"),[i.expectedStartTime,z]),V=ce.useMemo(()=>Zy(i.expectedEndTime,z,"short"),[i.expectedEndTime,z]);return ne.jsxs("div",{className:"itinerary-header-wrapper",children:[ne.jsxs("div",{className:"itinerary-header-itinerary-number",children:[n+1,"."]}),ne.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${C+5}px`,left:`${R-2}px`}}),ne.jsx("div",{title:i.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${R-Ob}px`},children:B}),i.legs.map((G,re)=>ne.jsx(LR,{leg:G,earliestStartTime:d,startPx:c,maxSpan:_,pxSpan:v},G.id||`leg_${re}`)),ne.jsx("div",{title:i.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${R+C+2}px`},children:V})]})}function jR(i){const n=ce.useMemo(()=>i?.trip.tripPatterns.reduce((d,m)=>d===null?m?.expectedStartTime:new Date(m?.expectedStartTime)<new Date(d)?m.expectedStartTime:d,null)||null,[i?.trip]),l=ce.useMemo(()=>i?.trip.tripPatterns.reduce((d,m)=>d===null?m?.expectedEndTime:new Date(m?.expectedEndTime)>new Date(d)?m.expectedEndTime:d,null)||null,[i?.trip]);return[n,l]}function fw({aimedTime:i,expectedTime:n,hasRealtime:l}){const d=ce.useContext(v_);return i!==n?ne.jsxs(ne.Fragment,{children:[ne.jsx("span",{title:n,style:{color:"red"},children:Zy(n,d,"short")}),ne.jsx("span",{title:i,style:{textDecoration:"line-through"},children:Zy(i,d,"short")})]}):ne.jsxs("span",{title:n,children:[Zy(n,d,"short"),l&&ne.jsx("span",{children:" (on time)"})]})}function BR(i){const n=i/1e3;return n>100?`${n.toFixed(0)} km`:n>1?`${n.toFixed(1)} km`:`${i.toFixed(0)} m`}function FR(i){const n=Math.floor(i/3600),l=Math.floor(i/60)%60,d=i%60;let m="";return n>0&&(m=`${m}${n}h `),l>0&&(m=`${m}${l}min `),d>1&&(m=`${m}${d}s`),m}const UR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function VR({leg:i}){return i.interchangeFrom?.staySeated?ne.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:UR,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const GR=_g(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),ZR=eo(GR),$R="/graphiql?flavor=transmodel";function YR({legId:i,legName:n}){const l={id:i},d=encodeURIComponent(ZR),m=encodeURIComponent(JSON.stringify(l));return ne.jsx("a",{href:$R+"&query="+d+"&variables="+m,target:"_blank",rel:"noreferrer",children:n})}const qR=_g(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),HR=eo(qR),XR="/graphiql?flavor=transmodel";function pw({legId:i,legName:n}){const l={id:i},d=encodeURIComponent(HR),m=encodeURIComponent(JSON.stringify(l));return ne.jsx("a",{href:XR+"&query="+d+"&variables="+m,target:"_blank",rel:"noreferrer",children:n})}const WR=_g(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),QR=eo(WR),KR="/graphiql?flavor=transmodel";function JR({legId:i,legName:n}){const l={id:i},d=encodeURIComponent(QR),m=encodeURIComponent(JSON.stringify(l));return ne.jsx("a",{href:KR+"&query="+d+"&variables="+m,target:"_blank",rel:"noreferrer",children:n})}function eI(i){return i.line?.publicCode?i.line.publicCode+" "+i.toEstimatedCall?.destinationDisplay?.frontText:i.line?.name||"unknown"}function tI({leg:i,isLast:n}){return ne.jsxs("div",{className:"itinerary-leg-details",children:[ne.jsxs("div",{className:"times",children:[BR(i.distance),", ",FR(i.duration),","," ",ne.jsxs("span",{title:"Generalized cost: ¢"+i.generalizedCost,children:["¢",i.generalizedCost]})]}),ne.jsx(VR,{leg:i}),ne.jsx(fw,{aimedTime:i.aimedStartTime,expectedTime:i.expectedStartTime,hasRealtime:i.realtime})," -"," ",ne.jsx(fw,{aimedTime:i.aimedEndTime,expectedTime:i.expectedEndTime,hasRealtime:i.realtime}),ne.jsxs("div",{className:"mode",children:[ne.jsx("b",{children:i.mode})," ",i.line&&ne.jsxs(ne.Fragment,{children:[ne.jsx(YR,{legId:i.line?.id,legName:eI(i)}),", ",ne.jsx(JR,{legId:i.authority?.id,legName:i.authority?.name})]})," ",i.mode!==vi.Foot&&ne.jsxs(ne.Fragment,{children:[ne.jsx("br",{}),ne.jsx(pw,{legId:i.fromPlace.quay?.id,legName:i.fromPlace.name})," →"," "]})," ",!n&&ne.jsx(pw,{legId:i.toPlace.quay?.id,legName:i.toPlace.name})]})]})}function nI({tripPattern:i}){return ne.jsxs("div",{children:[i.systemNotices.length>0&&ne.jsxs("p",{children:["System tags: ",i.systemNotices.map(n=>n.tag).join(", ")]}),i.legs.map((n,l)=>ne.jsx(tI,{leg:n,isLast:l===i.legs.length-1},n.id?n.id:`noid_${l}`)),ne.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ¢",i.generalizedCost]})]})}function iI({previousPageCursor:i,nextPageCursor:n,onPagination:l,loading:d}){return ne.jsxs("div",{className:"pagination-controls-container",children:[ne.jsx(gp,{variant:"outline-primary",size:"sm",disabled:!i||d,onClick:()=>{i&&l(i)},children:"Previous page"})," ",ne.jsx(gp,{variant:"outline-primary",size:"sm",disabled:!n||d,onClick:()=>{n&&l(n)},children:"Next page"})]})}function rI({error:i,onDismiss:n}){if(!i)return null;const l=v=>{try{const c=v,C=String(c.message||"").toLowerCase(),R=c.code;if(C.includes("fetch")&&C.includes("failed"))return{userMessage:"Connection failed. Please check your internet connection and try again.",showRaw:!1};if(C.includes("network error")||R==="NETWORK_ERROR")return{userMessage:"Network error occurred. Please verify your internet connection and try again.",showRaw:!1};if(C.includes("enotfound")||C.includes("getaddrinfo"))return{userMessage:"Unable to reach the server. Please check your internet connection or try again later.",showRaw:!1};if(C.includes("timeout"))return{userMessage:"Request timed out. The server may be busy, please try again in a moment.",showRaw:!0};const z=c.response;if(z&&typeof z.status=="number"){const B=z.status;if(B>=500)return{userMessage:"Server error occurred. Please try again later.",showRaw:!0};if(B===404)return{userMessage:"Service not found. Please contact support if this issue persists.",showRaw:!0};if(B>=400)return{userMessage:"Request failed. Please check your search parameters and try again.",showRaw:!0}}if(z&&z.errors)return{userMessage:"Server returned an error response.",showRaw:!0}}catch{}return{userMessage:"An unexpected error occurred. Please try again.",showRaw:!0}},{userMessage:d,showRaw:m}=l(i);let _;try{const c=i.response;c&&c.errors?_=JSON.stringify(c.errors,null,2):c&&c.data?_=JSON.stringify(c.data,null,2):_=JSON.stringify(i,null,2)}catch{_="Unable to display error details"}return ne.jsx("div",{className:"error-display-container",children:ne.jsxs("div",{className:"flex-space-between",children:[ne.jsxs("div",{className:"flex-1",children:[ne.jsx("div",{className:"error-title",children:"Search Error"}),ne.jsx("div",{className:"error-message",children:d}),m&&ne.jsxs(ne.Fragment,{children:[ne.jsx("div",{className:"error-title",children:"Technical Details:"}),ne.jsx("pre",{className:"error-details",children:_})]})]}),n&&ne.jsx("button",{onClick:n,className:"error-dismiss-button","aria-label":"Dismiss error",children:"×"})]})})}function aI({hasSearched:i,tripQueryResult:n}){return!i||!n?null:ne.jsx("div",{className:"no-results-display-container",children:ne.jsx("div",{className:"flex-space-between",children:ne.jsxs("div",{className:"flex-1",children:[ne.jsx("div",{className:"info-title",children:"No Results Found"}),ne.jsx("div",{className:"info-message",children:"No matching trips were found for your search criteria."}),ne.jsx("div",{className:"info-title",children:"Raw Response:"}),ne.jsx("pre",{className:"no-results-details",children:JSON.stringify(n,null,2)})]})})})}function sI({tripQueryResult:i,selectedTripPatternIndexes:n,setSelectedTripPatternIndexes:l,pageResults:d,loading:m,error:_}){const[v,c]=jR(i),{containerRef:C,containerWidth:R}=lR(),z=ce.useContext(v_),B=!!(i&&i.trip.tripPatterns.length===0),V=i!==null,G=_||V&&!_&&B;return ne.jsxs("section",{className:"left-pane-container below-content",ref:C,children:[ne.jsxs(ne.Fragment,{children:[ne.jsx("div",{className:"panel-header",children:"Itinerary results"}),ne.jsx(rI,{error:_}),ne.jsx(aI,{hasSearched:V&&!_&&B,tripQueryResult:i}),!G&&ne.jsx("div",{className:"pagination-controls",children:ne.jsx(iI,{onPagination:d,previousPageCursor:i?.trip.previousPageCursor,nextPageCursor:i?.trip.nextPageCursor,loading:m})}),ne.jsx(C0,{activeKey:n.map(String),onSelect:re=>{const fe=parseInt(re);l(pe=>{if(pe.includes(fe))return pe.filter(Ie=>Ie!==fe);{const Ie=[...pe,fe];return Ie.length>2?Ie.slice(-2):Ie}})},children:i&&i.trip.tripPatterns.map((re,fe)=>ne.jsxs(C0.Item,{eventKey:`${fe}`,bsPrefix:re.systemNotices.length===0?"":"accordion-item-filtered",children:[ne.jsx(C0.Header,{children:ne.jsx(OR,{containerWidth:R,tripPattern:re,itineraryIndex:fe,earliestStartTime:v,latestEndTime:c})}),ne.jsx(C0.Body,{children:ne.jsx(nI,{tripPattern:re})})]},`${fe}`))})]}),ne.jsxs("div",{className:"time-zone-info",children:["All times in ",ne.jsx("code",{children:z})]})]})}const oI=_g(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        generalizedCost
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            generalizedCost
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            toEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),lI=eo(oI);function cI(i){const n={};return lx(i,{OperationDefinition(l){l.operation==="query"&&l.variableDefinitions&&l.variableDefinitions.forEach(d=>{const m=d.variable.name.value;n[m]=eo(d.type)})}}),n}function nS(i){const n=v2(lI),l=cI(n),d=Object.keys(i).filter(_=>i[_]!==void 0),m=lx(n,{OperationDefinition(_){if(_.operation==="query"){const v=_.variableDefinitions?.filter(c=>{const C=c.variable.name.value;return d.includes(C)&&l[C]});return{..._,variableDefinitions:v||[]}}return _},Field(_){if(_.name.value==="trip"&&_.arguments){const v=_.arguments.filter(c=>{if(c.value.kind==="Variable"){const C=c.value.name.value;return d.includes(C)&&l[C]}return!0});return{..._,arguments:v}}return _}});return eo(m)}function iS(i){const n={};return Object.keys(i).forEach(l=>{const d=i[l];d!==void 0&&(n[l]=d)}),n}const uI=i=>{const[n,l]=ce.useState(null),[d,m]=ce.useState(!1),[_,v]=ce.useState(null),c=ce.useCallback(async C=>{if(d)console.warn("Wait for previous search to finish");else if(i){m(!0),v(null);try{const R=C?{...i,pageCursor:C}:i,z=iS(R),B=nS(R);l(await dx(lv(),B,z))}catch(R){console.error("Error at useTripQuery",R),v(R),l(null)}m(!1)}else console.warn("Can't search without variables")},[l,i,d]);return ce.useEffect(()=>{mw(i?.from)&&mw(i?.to)&&c()},[i?.from,i?.to]),[n,d,c,_]};function mw(i){return i&&(i.coordinates||i.place)}const hI=_g(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),dI=()=>{const[i,n]=ce.useState(null);return ce.useEffect(()=>{(async()=>{n(await dx(lv(),hI))})()},[]),i?.serverInfo},fI={from:{},to:{},dateTime:new Date().toISOString()},pI=()=>{const n=new URLSearchParams(window.location.search).get("variables");return n?JSON.parse(decodeURIComponent(n)):fI},mI=i=>{const n=new URLSearchParams(window.location.search);n.set("variables",encodeURIComponent(JSON.stringify(i))),history.pushState({},"","?"+n.toString()+window.location.hash)},gI=()=>{const[i,n]=ce.useState(pI());return ce.useEffect(()=>{mI(i)},[i]),{tripQueryVariables:i,setTripQueryVariables:n}};function yI({target:i,serverInfo:n}){return ne.jsx(KT,{target:i.current,show:!!n,placement:"right",children:ne.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:ne.jsx("pre",{children:JSON.stringify(n,null,2)})})})}const _I="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function vI({serverInfo:i}){const[n,l]=ce.useState(!1),d=ce.useRef(null);return ne.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[ne.jsx(Hk.Brand,{onClick:()=>l(m=>!m),children:ne.jsxs("div",{ref:d,children:[ne.jsx("img",{alt:"",src:_I,width:"50",height:"50",className:"logo-image"}),"OTP Debug",n&&ne.jsx(yI,{serverInfo:i,target:d})]})}),ne.jsxs("div",{className:"details",children:[ne.jsxs("div",{children:["Version: ",i?.version]}),ne.jsxs("div",{children:["Time zone: ",i?.internalTransitModelTimeZone]})]})]})}const gw=7,yw="-{0,1}\\d+(\\.\\d+){0,1}",bI="("+yw+")(\\s+)("+yw+")";function xI(i){const n=i.match(bI);return n?{coordinates:{latitude:+n[1],longitude:+n[4]}}:{place:i}}function wI(i){return i.coordinates?`${i.coordinates?.latitude.toPrecision(gw)} ${i.coordinates?.longitude.toPrecision(gw)}`:i.place?i.place:null}function _w({id:i,label:n,tripQueryVariables:l,setTripQueryVariables:d,locationFieldKey:m}){const[_,v]=ce.useState("");ce.useEffect(()=>{const C=l[m];v(wI(C)||"")},[l,m]);const c=ce.useCallback(C=>{const R=xI(C)||{};d({...l,[m]:R})},[l,d,m]);return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:i,children:n}),ne.jsx(xi.Control,{type:"text",id:i,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:C=>{v(C.target.value)},onBlur:C=>{c(C.target.value)},value:_})]})}const TI="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function SI({tripQueryVariables:i,setTripQueryVariables:n}){const l=()=>{n({...i,from:i.to,to:i.from})};return ne.jsx("button",{className:"swap-from-to",onClick:l,title:"Swap from/to",children:ne.jsx("img",{alt:"Swap from/to",src:TI})})}function EI({tripQueryVariables:i,setTripQueryVariables:n}){const l=d=>{if(d===void 0){const m={...i};delete m.arriveBy,n(m)}else n({...i,arriveBy:d})};return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Depart/Arrive"}),ne.jsxs(xi.Select,{size:"sm",className:"input-medium",onChange:d=>d.target.value==="arrival"?l(!0):l(void 0),value:i.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[ne.jsx("option",{value:"arrival",children:"Arrive by"}),ne.jsx("option",{value:"departure",children:"Depart after"})]})]})}class W extends Array{constructor(n,l){if(super(n),this.sign=l,Object.setPrototypeOf(this,W.prototype),n>W.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(n){var l=Math.floor,d=Number.isFinite;if(typeof n=="number"){if(n===0)return W.__zero();if(W.__isOneDigitInt(n))return 0>n?W.__oneDigit(-n,!0):W.__oneDigit(n,!1);if(!d(n)||l(n)!==n)throw new RangeError("The number "+n+" cannot be converted to BigInt because it is not an integer");return W.__fromDouble(n)}if(typeof n=="string"){const m=W.__fromString(n);if(m===null)throw new SyntaxError("Cannot convert "+n+" to a BigInt");return m}if(typeof n=="boolean")return n===!0?W.__oneDigit(1,!1):W.__zero();if(typeof n=="object"){if(n.constructor===W)return n;const m=W.__toPrimitive(n);return W.BigInt(m)}throw new TypeError("Cannot convert "+n+" to a BigInt")}toDebugString(){const n=["BigInt["];for(const l of this)n.push((l&&(l>>>0).toString(16))+", ");return n.push("]"),n.join("")}toString(n=10){if(2>n||36<n)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(n&n-1)==0?W.__toStringBasePowerOfTwo(this,n):W.__toStringGeneric(this,n,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(n){const l=n.length;if(l===0)return 0;if(l===1){const pe=n.__unsignedDigit(0);return n.sign?-pe:pe}const d=n.__digit(l-1),m=W.__clz30(d),_=30*l-m;if(1024<_)return n.sign?-1/0:1/0;let v=_-1,c=d,C=l-1;const R=m+3;let z=R===32?0:c<<R;z>>>=12;const B=R-12;let V=12<=R?0:c<<20+R,G=20+R;for(0<B&&0<C&&(C--,c=n.__digit(C),z|=c>>>30-B,V=c<<B+2,G=B+2);0<G&&0<C;)C--,c=n.__digit(C),V|=30<=G?c<<G-30:c>>>30-G,G-=30;const re=W.__decideRounding(n,G,C,c);if((re===1||re===0&&(1&V)==1)&&(V=V+1>>>0,V===0&&(z++,z>>>20!=0&&(z=0,v++,1023<v))))return n.sign?-1/0:1/0;const fe=n.sign?-2147483648:0;return v=v+1023<<20,W.__kBitConversionInts[1]=fe|v|z,W.__kBitConversionInts[0]=V,W.__kBitConversionDouble[0]}static unaryMinus(n){if(n.length===0)return n;const l=n.__copy();return l.sign=!n.sign,l}static bitwiseNot(n){return n.sign?W.__absoluteSubOne(n).__trim():W.__absoluteAddOne(n,!0)}static exponentiate(n,l){if(l.sign)throw new RangeError("Exponent must be positive");if(l.length===0)return W.__oneDigit(1,!1);if(n.length===0)return n;if(n.length===1&&n.__digit(0)===1)return n.sign&&(1&l.__digit(0))==0?W.unaryMinus(n):n;if(1<l.length)throw new RangeError("BigInt too big");let d=l.__unsignedDigit(0);if(d===1)return n;if(d>=W.__kMaxLengthBits)throw new RangeError("BigInt too big");if(n.length===1&&n.__digit(0)===2){const v=1+(0|d/30),c=n.sign&&(1&d)!=0,C=new W(v,c);C.__initializeDigits();const R=1<<d%30;return C.__setDigit(v-1,R),C}let m=null,_=n;for((1&d)!=0&&(m=n),d>>=1;d!==0;d>>=1)_=W.multiply(_,_),(1&d)!=0&&(m===null?m=_:m=W.multiply(m,_));return m}static multiply(n,l){if(n.length===0)return n;if(l.length===0)return l;let d=n.length+l.length;30<=n.__clzmsd()+l.__clzmsd()&&d--;const m=new W(d,n.sign!==l.sign);m.__initializeDigits();for(let _=0;_<n.length;_++)W.__multiplyAccumulate(l,n.__digit(_),m,_);return m.__trim()}static divide(n,l){if(l.length===0)throw new RangeError("Division by zero");if(0>W.__absoluteCompare(n,l))return W.__zero();const d=n.sign!==l.sign,m=l.__unsignedDigit(0);let _;if(l.length===1&&32767>=m){if(m===1)return d===n.sign?n:W.unaryMinus(n);_=W.__absoluteDivSmall(n,m,null)}else _=W.__absoluteDivLarge(n,l,!0,!1);return _.sign=d,_.__trim()}static remainder(n,l){if(l.length===0)throw new RangeError("Division by zero");if(0>W.__absoluteCompare(n,l))return n;const d=l.__unsignedDigit(0);if(l.length===1&&32767>=d){if(d===1)return W.__zero();const _=W.__absoluteModSmall(n,d);return _===0?W.__zero():W.__oneDigit(_,n.sign)}const m=W.__absoluteDivLarge(n,l,!1,!0);return m.sign=n.sign,m.__trim()}static add(n,l){const d=n.sign;return d===l.sign?W.__absoluteAdd(n,l,d):0<=W.__absoluteCompare(n,l)?W.__absoluteSub(n,l,d):W.__absoluteSub(l,n,!d)}static subtract(n,l){const d=n.sign;return d===l.sign?0<=W.__absoluteCompare(n,l)?W.__absoluteSub(n,l,d):W.__absoluteSub(l,n,!d):W.__absoluteAdd(n,l,d)}static leftShift(n,l){return l.length===0||n.length===0?n:l.sign?W.__rightShiftByAbsolute(n,l):W.__leftShiftByAbsolute(n,l)}static signedRightShift(n,l){return l.length===0||n.length===0?n:l.sign?W.__leftShiftByAbsolute(n,l):W.__rightShiftByAbsolute(n,l)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(n,l){return 0>W.__compareToBigInt(n,l)}static lessThanOrEqual(n,l){return 0>=W.__compareToBigInt(n,l)}static greaterThan(n,l){return 0<W.__compareToBigInt(n,l)}static greaterThanOrEqual(n,l){return 0<=W.__compareToBigInt(n,l)}static equal(n,l){if(n.sign!==l.sign||n.length!==l.length)return!1;for(let d=0;d<n.length;d++)if(n.__digit(d)!==l.__digit(d))return!1;return!0}static notEqual(n,l){return!W.equal(n,l)}static bitwiseAnd(n,l){var d=Math.max;if(!n.sign&&!l.sign)return W.__absoluteAnd(n,l).__trim();if(n.sign&&l.sign){const m=d(n.length,l.length)+1;let _=W.__absoluteSubOne(n,m);const v=W.__absoluteSubOne(l);return _=W.__absoluteOr(_,v,_),W.__absoluteAddOne(_,!0,_).__trim()}return n.sign&&([n,l]=[l,n]),W.__absoluteAndNot(n,W.__absoluteSubOne(l)).__trim()}static bitwiseXor(n,l){var d=Math.max;if(!n.sign&&!l.sign)return W.__absoluteXor(n,l).__trim();if(n.sign&&l.sign){const v=d(n.length,l.length),c=W.__absoluteSubOne(n,v),C=W.__absoluteSubOne(l);return W.__absoluteXor(c,C,c).__trim()}const m=d(n.length,l.length)+1;n.sign&&([n,l]=[l,n]);let _=W.__absoluteSubOne(l,m);return _=W.__absoluteXor(_,n,_),W.__absoluteAddOne(_,!0,_).__trim()}static bitwiseOr(n,l){var d=Math.max;const m=d(n.length,l.length);if(!n.sign&&!l.sign)return W.__absoluteOr(n,l).__trim();if(n.sign&&l.sign){let v=W.__absoluteSubOne(n,m);const c=W.__absoluteSubOne(l);return v=W.__absoluteAnd(v,c,v),W.__absoluteAddOne(v,!0,v).__trim()}n.sign&&([n,l]=[l,n]);let _=W.__absoluteSubOne(l,m);return _=W.__absoluteAndNot(_,n,_),W.__absoluteAddOne(_,!0,_).__trim()}static asIntN(n,l){var d=Math.floor;if(l.length===0)return l;if(n=d(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return W.__zero();if(n>=W.__kMaxLengthBits)return l;const m=0|(n+29)/30;if(l.length<m)return l;const _=l.__unsignedDigit(m-1),v=1<<(n-1)%30;if(l.length===m&&_<v)return l;if((_&v)!==v)return W.__truncateToNBits(n,l);if(!l.sign)return W.__truncateAndSubFromPowerOfTwo(n,l,!0);if((_&v-1)==0){for(let c=m-2;0<=c;c--)if(l.__digit(c)!==0)return W.__truncateAndSubFromPowerOfTwo(n,l,!1);return l.length===m&&_===v?l:W.__truncateToNBits(n,l)}return W.__truncateAndSubFromPowerOfTwo(n,l,!1)}static asUintN(n,l){var d=Math.floor;if(l.length===0)return l;if(n=d(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return W.__zero();if(l.sign){if(n>W.__kMaxLengthBits)throw new RangeError("BigInt too big");return W.__truncateAndSubFromPowerOfTwo(n,l,!1)}if(n>=W.__kMaxLengthBits)return l;const m=0|(n+29)/30;if(l.length<m)return l;const _=n%30;return l.length==m&&(_===0||!(l.__digit(m-1)>>>_))?l:W.__truncateToNBits(n,l)}static ADD(n,l){if(n=W.__toPrimitive(n),l=W.__toPrimitive(l),typeof n=="string")return typeof l!="string"&&(l=l.toString()),n+l;if(typeof l=="string")return n.toString()+l;if(n=W.__toNumeric(n),l=W.__toNumeric(l),W.__isBigInt(n)&&W.__isBigInt(l))return W.add(n,l);if(typeof n=="number"&&typeof l=="number")return n+l;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(n,l){return W.__compare(n,l,0)}static LE(n,l){return W.__compare(n,l,1)}static GT(n,l){return W.__compare(n,l,2)}static GE(n,l){return W.__compare(n,l,3)}static EQ(n,l){for(;;){if(W.__isBigInt(n))return W.__isBigInt(l)?W.equal(n,l):W.EQ(l,n);if(typeof n=="number"){if(W.__isBigInt(l))return W.__equalToNumber(l,n);if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="string"){if(W.__isBigInt(l))return n=W.__fromString(n),n!==null&&W.equal(n,l);if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="boolean"){if(W.__isBigInt(l))return W.__equalToNumber(l,+n);if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="symbol"){if(W.__isBigInt(l))return!1;if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="object"){if(typeof l=="object"&&l.constructor!==W)return n==l;n=W.__toPrimitive(n)}else return n==l}}static NE(n,l){return!W.EQ(n,l)}static DataViewGetBigInt64(n,l,d=!1){return W.asIntN(64,W.DataViewGetBigUint64(n,l,d))}static DataViewGetBigUint64(n,l,d=!1){const[m,_]=d?[4,0]:[0,4],v=n.getUint32(l+m,d),c=n.getUint32(l+_,d),C=new W(3,!1);return C.__setDigit(0,1073741823&c),C.__setDigit(1,(268435455&v)<<2|c>>>30),C.__setDigit(2,v>>>28),C.__trim()}static DataViewSetBigInt64(n,l,d,m=!1){W.DataViewSetBigUint64(n,l,d,m)}static DataViewSetBigUint64(n,l,d,m=!1){d=W.asUintN(64,d);let _=0,v=0;if(0<d.length&&(v=d.__digit(0),1<d.length)){const R=d.__digit(1);v|=R<<30,_=R>>>2,2<d.length&&(_|=d.__digit(2)<<28)}const[c,C]=m?[4,0]:[0,4];n.setUint32(l+c,_,m),n.setUint32(l+C,v,m)}static __zero(){return new W(0,!1)}static __oneDigit(n,l){const d=new W(1,l);return d.__setDigit(0,n),d}__copy(){const n=new W(this.length,this.sign);for(let l=0;l<this.length;l++)n[l]=this[l];return n}__trim(){let n=this.length,l=this[n-1];for(;l===0;)n--,l=this[n-1],this.pop();return n===0&&(this.sign=!1),this}__initializeDigits(){for(let n=0;n<this.length;n++)this[n]=0}static __decideRounding(n,l,d,m){if(0<l)return-1;let _;if(0>l)_=-l-1;else{if(d===0)return-1;d--,m=n.__digit(d),_=29}let v=1<<_;if((m&v)==0)return-1;if(v-=1,(m&v)!=0)return 1;for(;0<d;)if(d--,n.__digit(d)!==0)return 1;return 0}static __fromDouble(n){W.__kBitConversionDouble[0]=n;const l=2047&W.__kBitConversionInts[1]>>>20,d=l-1023,m=(0|d/30)+1,_=new W(m,0>n);let v=1048575&W.__kBitConversionInts[1]|1048576,c=W.__kBitConversionInts[0];const C=20,R=d%30;let z,B=0;if(R<20){const V=C-R;B=V+32,z=v>>>V,v=v<<32-V|c>>>V,c<<=32-V}else if(R===20)B=32,z=v,v=c,c=0;else{const V=R-C;B=32-V,z=v<<V|c>>>32-V,v=c<<V,c=0}_.__setDigit(m-1,z);for(let V=m-2;0<=V;V--)0<B?(B-=30,z=v>>>2,v=v<<30|c>>>2,c<<=30):z=0,_.__setDigit(V,z);return _.__trim()}static __isWhitespace(n){return 13>=n&&9<=n||(159>=n?n==32:131071>=n?n==160||n==5760:196607>=n?(n&=131071,10>=n||n==40||n==41||n==47||n==95||n==4096):n==65279)}static __fromString(n,l=0){let d=0;const m=n.length;let _=0;if(_===m)return W.__zero();let v=n.charCodeAt(_);for(;W.__isWhitespace(v);){if(++_===m)return W.__zero();v=n.charCodeAt(_)}if(v===43){if(++_===m)return null;v=n.charCodeAt(_),d=1}else if(v===45){if(++_===m)return null;v=n.charCodeAt(_),d=-1}if(l===0){if(l=10,v===48){if(++_===m)return W.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(l=16,++_===m)return null;v=n.charCodeAt(_)}else if(v===79||v===111){if(l=8,++_===m)return null;v=n.charCodeAt(_)}else if(v===66||v===98){if(l=2,++_===m)return null;v=n.charCodeAt(_)}}}else if(l===16&&v===48){if(++_===m)return W.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(++_===m)return null;v=n.charCodeAt(_)}}if(d!=0&&l!==10)return null;for(;v===48;){if(++_===m)return W.__zero();v=n.charCodeAt(_)}const c=m-_;let C=W.__kMaxBitsPerChar[l],R=W.__kBitsPerCharTableMultiplier-1;if(c>1073741824/C)return null;const z=C*c+R>>>W.__kBitsPerCharTableShift,B=new W(0|(z+29)/30,!1),V=10>l?l:10,G=10<l?l-10:0;if((l&l-1)==0){C>>=W.__kBitsPerCharTableShift;const re=[],fe=[];let pe=!1;do{let Ie=0,Ge=0;for(;;){let je;if(v-48>>>0<V)je=v-48;else if((32|v)-97>>>0<G)je=(32|v)-87;else{pe=!0;break}if(Ge+=C,Ie=Ie<<C|je,++_===m){pe=!0;break}if(v=n.charCodeAt(_),30<Ge+C)break}re.push(Ie),fe.push(Ge)}while(!pe);W.__fillFromParts(B,re,fe)}else{B.__initializeDigits();let re=!1,fe=0;do{let pe=0,Ie=1;for(;;){let je;if(v-48>>>0<V)je=v-48;else if((32|v)-97>>>0<G)je=(32|v)-87;else{re=!0;break}const He=Ie*l;if(1073741823<He)break;if(Ie=He,pe=pe*l+je,fe++,++_===m){re=!0;break}v=n.charCodeAt(_)}R=30*W.__kBitsPerCharTableMultiplier-1;const Ge=0|(C*fe+R>>>W.__kBitsPerCharTableShift)/30;B.__inplaceMultiplyAdd(Ie,pe,Ge)}while(!re)}if(_!==m){if(!W.__isWhitespace(v))return null;for(_++;_<m;_++)if(v=n.charCodeAt(_),!W.__isWhitespace(v))return null}return B.sign=d==-1,B.__trim()}static __fillFromParts(n,l,d){let m=0,_=0,v=0;for(let c=l.length-1;0<=c;c--){const C=l[c],R=d[c];_|=C<<v,v+=R,v===30?(n.__setDigit(m++,_),v=0,_=0):30<v&&(n.__setDigit(m++,1073741823&_),v-=30,_=C>>>R-v)}if(_!==0){if(m>=n.length)throw new Error("implementation bug");n.__setDigit(m++,_)}for(;m<n.length;m++)n.__setDigit(m,0)}static __toStringBasePowerOfTwo(n,l){const d=n.length;let m=l-1;m=(85&m>>>1)+(85&m),m=(51&m>>>2)+(51&m),m=(15&m>>>4)+(15&m);const _=m,v=l-1,c=n.__digit(d-1),C=W.__clz30(c);let R=0|(30*d-C+_-1)/_;if(n.sign&&R++,268435456<R)throw new Error("string too long");const z=Array(R);let B=R-1,V=0,G=0;for(let fe=0;fe<d-1;fe++){const pe=n.__digit(fe),Ie=(V|pe<<G)&v;z[B--]=W.__kConversionChars[Ie];const Ge=_-G;for(V=pe>>>Ge,G=30-Ge;G>=_;)z[B--]=W.__kConversionChars[V&v],V>>>=_,G-=_}const re=(V|c<<G)&v;for(z[B--]=W.__kConversionChars[re],V=c>>>_-G;V!==0;)z[B--]=W.__kConversionChars[V&v],V>>>=_;if(n.sign&&(z[B--]="-"),B!=-1)throw new Error("implementation bug");return z.join("")}static __toStringGeneric(n,l,d){const m=n.length;if(m===0)return"";if(m===1){let fe=n.__unsignedDigit(0).toString(l);return d===!1&&n.sign&&(fe="-"+fe),fe}const _=30*m-W.__clz30(n.__digit(m-1)),v=W.__kMaxBitsPerChar[l],c=v-1;let C=_*W.__kBitsPerCharTableMultiplier;C+=c-1,C=0|C/c;const R=C+1>>1,z=W.exponentiate(W.__oneDigit(l,!1),W.__oneDigit(R,!1));let B,V;const G=z.__unsignedDigit(0);if(z.length===1&&32767>=G){B=new W(n.length,!1),B.__initializeDigits();let fe=0;for(let pe=2*n.length-1;0<=pe;pe--){const Ie=fe<<15|n.__halfDigit(pe);B.__setHalfDigit(pe,0|Ie/G),fe=0|Ie%G}V=fe.toString(l)}else{const fe=W.__absoluteDivLarge(n,z,!0,!0);B=fe.quotient;const pe=fe.remainder.__trim();V=W.__toStringGeneric(pe,l,!0)}B.__trim();let re=W.__toStringGeneric(B,l,!0);for(;V.length<R;)V="0"+V;return d===!1&&n.sign&&(re="-"+re),re+V}static __unequalSign(n){return n?-1:1}static __absoluteGreater(n){return n?-1:1}static __absoluteLess(n){return n?1:-1}static __compareToBigInt(n,l){const d=n.sign;if(d!==l.sign)return W.__unequalSign(d);const m=W.__absoluteCompare(n,l);return 0<m?W.__absoluteGreater(d):0>m?W.__absoluteLess(d):0}static __compareToNumber(n,l){if(W.__isOneDigitInt(l)){const d=n.sign,m=0>l;if(d!==m)return W.__unequalSign(d);if(n.length===0){if(m)throw new Error("implementation bug");return l===0?0:-1}if(1<n.length)return W.__absoluteGreater(d);const _=Math.abs(l),v=n.__unsignedDigit(0);return v>_?W.__absoluteGreater(d):v<_?W.__absoluteLess(d):0}return W.__compareToDouble(n,l)}static __compareToDouble(n,l){if(l!==l)return l;if(l===1/0)return-1;if(l===-1/0)return 1;const d=n.sign;if(d!==0>l)return W.__unequalSign(d);if(l===0)throw new Error("implementation bug: should be handled elsewhere");if(n.length===0)return-1;W.__kBitConversionDouble[0]=l;const m=2047&W.__kBitConversionInts[1]>>>20;if(m==2047)throw new Error("implementation bug: handled elsewhere");const _=m-1023;if(0>_)return W.__absoluteGreater(d);const v=n.length;let c=n.__digit(v-1);const C=W.__clz30(c),R=30*v-C,z=_+1;if(R<z)return W.__absoluteLess(d);if(R>z)return W.__absoluteGreater(d);let B=1048576|1048575&W.__kBitConversionInts[1],V=W.__kBitConversionInts[0];const G=20,re=29-C;if(re!==(0|(R-1)%30))throw new Error("implementation bug");let fe,pe=0;if(20>re){const Ie=G-re;pe=Ie+32,fe=B>>>Ie,B=B<<32-Ie|V>>>Ie,V<<=32-Ie}else if(re===20)pe=32,fe=B,B=V,V=0;else{const Ie=re-G;pe=32-Ie,fe=B<<Ie|V>>>32-Ie,B=V<<Ie,V=0}if(c>>>=0,fe>>>=0,c>fe)return W.__absoluteGreater(d);if(c<fe)return W.__absoluteLess(d);for(let Ie=v-2;0<=Ie;Ie--){0<pe?(pe-=30,fe=B>>>2,B=B<<30|V>>>2,V<<=30):fe=0;const Ge=n.__unsignedDigit(Ie);if(Ge>fe)return W.__absoluteGreater(d);if(Ge<fe)return W.__absoluteLess(d)}if(B!==0||V!==0){if(pe===0)throw new Error("implementation bug");return W.__absoluteLess(d)}return 0}static __equalToNumber(n,l){var d=Math.abs;return W.__isOneDigitInt(l)?l===0?n.length===0:n.length===1&&n.sign===0>l&&n.__unsignedDigit(0)===d(l):W.__compareToDouble(n,l)===0}static __comparisonResultToBool(n,l){return l===0?0>n:l===1?0>=n:l===2?0<n:l===3?0<=n:void 0}static __compare(n,l,d){if(n=W.__toPrimitive(n),l=W.__toPrimitive(l),typeof n=="string"&&typeof l=="string")switch(d){case 0:return n<l;case 1:return n<=l;case 2:return n>l;case 3:return n>=l}if(W.__isBigInt(n)&&typeof l=="string")return l=W.__fromString(l),l!==null&&W.__comparisonResultToBool(W.__compareToBigInt(n,l),d);if(typeof n=="string"&&W.__isBigInt(l))return n=W.__fromString(n),n!==null&&W.__comparisonResultToBool(W.__compareToBigInt(n,l),d);if(n=W.__toNumeric(n),l=W.__toNumeric(l),W.__isBigInt(n)){if(W.__isBigInt(l))return W.__comparisonResultToBool(W.__compareToBigInt(n,l),d);if(typeof l!="number")throw new Error("implementation bug");return W.__comparisonResultToBool(W.__compareToNumber(n,l),d)}if(typeof n!="number")throw new Error("implementation bug");if(W.__isBigInt(l))return W.__comparisonResultToBool(W.__compareToNumber(l,n),2^d);if(typeof l!="number")throw new Error("implementation bug");return d===0?n<l:d===1?n<=l:d===2?n>l:d===3?n>=l:void 0}__clzmsd(){return W.__clz30(this.__digit(this.length-1))}static __absoluteAdd(n,l,d){if(n.length<l.length)return W.__absoluteAdd(l,n,d);if(n.length===0)return n;if(l.length===0)return n.sign===d?n:W.unaryMinus(n);let m=n.length;(n.__clzmsd()===0||l.length===n.length&&l.__clzmsd()===0)&&m++;const _=new W(m,d);let v=0,c=0;for(;c<l.length;c++){const C=n.__digit(c)+l.__digit(c)+v;v=C>>>30,_.__setDigit(c,1073741823&C)}for(;c<n.length;c++){const C=n.__digit(c)+v;v=C>>>30,_.__setDigit(c,1073741823&C)}return c<_.length&&_.__setDigit(c,v),_.__trim()}static __absoluteSub(n,l,d){if(n.length===0)return n;if(l.length===0)return n.sign===d?n:W.unaryMinus(n);const m=new W(n.length,d);let _=0,v=0;for(;v<l.length;v++){const c=n.__digit(v)-l.__digit(v)-_;_=1&c>>>30,m.__setDigit(v,1073741823&c)}for(;v<n.length;v++){const c=n.__digit(v)-_;_=1&c>>>30,m.__setDigit(v,1073741823&c)}return m.__trim()}static __absoluteAddOne(n,l,d=null){const m=n.length;d===null?d=new W(m,l):d.sign=l;let _=1;for(let v=0;v<m;v++){const c=n.__digit(v)+_;_=c>>>30,d.__setDigit(v,1073741823&c)}return _!=0&&d.__setDigitGrow(m,1),d}static __absoluteSubOne(n,l){const d=n.length;l=l||d;const m=new W(l,!1);let _=1;for(let v=0;v<d;v++){const c=n.__digit(v)-_;_=1&c>>>30,m.__setDigit(v,1073741823&c)}if(_!=0)throw new Error("implementation bug");for(let v=d;v<l;v++)m.__setDigit(v,0);return m}static __absoluteAnd(n,l,d=null){let m=n.length,_=l.length,v=_;if(m<_){v=m;const R=n,z=m;n=l,m=_,l=R,_=z}let c=v;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)&l.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteAndNot(n,l,d=null){const m=n.length,_=l.length;let v=_;m<_&&(v=m);let c=m;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)&~l.__digit(C));for(;C<m;C++)d.__setDigit(C,n.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteOr(n,l,d=null){let m=n.length,_=l.length,v=_;if(m<_){v=m;const R=n,z=m;n=l,m=_,l=R,_=z}let c=m;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)|l.__digit(C));for(;C<m;C++)d.__setDigit(C,n.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteXor(n,l,d=null){let m=n.length,_=l.length,v=_;if(m<_){v=m;const R=n,z=m;n=l,m=_,l=R,_=z}let c=m;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)^l.__digit(C));for(;C<m;C++)d.__setDigit(C,n.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteCompare(n,l){const d=n.length-l.length;if(d!=0)return d;let m=n.length-1;for(;0<=m&&n.__digit(m)===l.__digit(m);)m--;return 0>m?0:n.__unsignedDigit(m)>l.__unsignedDigit(m)?1:-1}static __multiplyAccumulate(n,l,d,m){if(l===0)return;const _=32767&l,v=l>>>15;let c=0,C=0;for(let R,z=0;z<n.length;z++,m++){R=d.__digit(m);const B=n.__digit(z),V=32767&B,G=B>>>15,re=W.__imul(V,_),fe=W.__imul(V,v),pe=W.__imul(G,_),Ie=W.__imul(G,v);R+=C+re+c,c=R>>>30,R&=1073741823,R+=((32767&fe)<<15)+((32767&pe)<<15),c+=R>>>30,C=Ie+(fe>>>15)+(pe>>>15),d.__setDigit(m,1073741823&R)}for(;c!=0||C!==0;m++){let R=d.__digit(m);R+=c+C,C=0,c=R>>>30,d.__setDigit(m,1073741823&R)}}static __internalMultiplyAdd(n,l,d,m,_){let v=d,c=0;for(let C=0;C<m;C++){const R=n.__digit(C),z=W.__imul(32767&R,l),B=W.__imul(R>>>15,l),V=z+((32767&B)<<15)+c+v;v=V>>>30,c=B>>>15,_.__setDigit(C,1073741823&V)}if(_.length>m)for(_.__setDigit(m++,v+c);m<_.length;)_.__setDigit(m++,0);else if(v+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(n,l,d){d>this.length&&(d=this.length);const m=32767&n,_=n>>>15;let v=0,c=l;for(let C=0;C<d;C++){const R=this.__digit(C),z=32767&R,B=R>>>15,V=W.__imul(z,m),G=W.__imul(z,_),re=W.__imul(B,m),fe=W.__imul(B,_);let pe=c+V+v;v=pe>>>30,pe&=1073741823,pe+=((32767&G)<<15)+((32767&re)<<15),v+=pe>>>30,c=fe+(G>>>15)+(re>>>15),this.__setDigit(C,1073741823&pe)}if(v!=0||c!==0)throw new Error("implementation bug")}static __absoluteDivSmall(n,l,d=null){d===null&&(d=new W(n.length,!1));let m=0;for(let _,v=2*n.length-1;0<=v;v-=2){_=(m<<15|n.__halfDigit(v))>>>0;const c=0|_/l;m=0|_%l,_=(m<<15|n.__halfDigit(v-1))>>>0;const C=0|_/l;m=0|_%l,d.__setDigit(v>>>1,c<<15|C)}return d}static __absoluteModSmall(n,l){let d=0;for(let m=2*n.length-1;0<=m;m--)d=0|((d<<15|n.__halfDigit(m))>>>0)%l;return d}static __absoluteDivLarge(n,l,d,m){const _=l.__halfDigitLength(),v=l.length,c=n.__halfDigitLength()-_;let C=null;d&&(C=new W(c+2>>>1,!1),C.__initializeDigits());const R=new W(_+2>>>1,!1);R.__initializeDigits();const z=W.__clz15(l.__halfDigit(_-1));0<z&&(l=W.__specialLeftShift(l,z,0));const B=W.__specialLeftShift(n,z,1),V=l.__halfDigit(_-1);let G=0;for(let re,fe=c;0<=fe;fe--){re=32767;const pe=B.__halfDigit(fe+_);if(pe!==V){const Ge=(pe<<15|B.__halfDigit(fe+_-1))>>>0;re=0|Ge/V;let je=0|Ge%V;const He=l.__halfDigit(_-2),Ve=B.__halfDigit(fe+_-2);for(;W.__imul(re,He)>>>0>(je<<16|Ve)>>>0&&(re--,je+=V,!(32767<je)););}W.__internalMultiplyAdd(l,re,0,v,R);let Ie=B.__inplaceSub(R,fe,_+1);Ie!==0&&(Ie=B.__inplaceAdd(l,fe,_),B.__setHalfDigit(fe+_,32767&B.__halfDigit(fe+_)+Ie),re--),d&&(1&fe?G=re<<15:C.__setDigit(fe>>>1,G|re))}if(m)return B.__inplaceRightShift(z),d?{quotient:C,remainder:B}:B;if(d)return C;throw new Error("unreachable")}static __clz15(n){return W.__clz30(n)-15}__inplaceAdd(n,l,d){let m=0;for(let _=0;_<d;_++){const v=this.__halfDigit(l+_)+n.__halfDigit(_)+m;m=v>>>15,this.__setHalfDigit(l+_,32767&v)}return m}__inplaceSub(n,l,d){let m=0;if(1&l){l>>=1;let _=this.__digit(l),v=32767&_,c=0;for(;c<d-1>>>1;c++){const z=n.__digit(c),B=(_>>>15)-(32767&z)-m;m=1&B>>>15,this.__setDigit(l+c,(32767&B)<<15|32767&v),_=this.__digit(l+c+1),v=(32767&_)-(z>>>15)-m,m=1&v>>>15}const C=n.__digit(c),R=(_>>>15)-(32767&C)-m;if(m=1&R>>>15,this.__setDigit(l+c,(32767&R)<<15|32767&v),l+c+1>=this.length)throw new RangeError("out of bounds");(1&d)==0&&(_=this.__digit(l+c+1),v=(32767&_)-(C>>>15)-m,m=1&v>>>15,this.__setDigit(l+n.length,1073709056&_|32767&v))}else{l>>=1;let _=0;for(;_<n.length-1;_++){const z=this.__digit(l+_),B=n.__digit(_),V=(32767&z)-(32767&B)-m;m=1&V>>>15;const G=(z>>>15)-(B>>>15)-m;m=1&G>>>15,this.__setDigit(l+_,(32767&G)<<15|32767&V)}const v=this.__digit(l+_),c=n.__digit(_),C=(32767&v)-(32767&c)-m;m=1&C>>>15;let R=0;(1&d)==0&&(R=(v>>>15)-(c>>>15)-m,m=1&R>>>15),this.__setDigit(l+_,(32767&R)<<15|32767&C)}return m}__inplaceRightShift(n){if(n===0)return;let l=this.__digit(0)>>>n;const d=this.length-1;for(let m=0;m<d;m++){const _=this.__digit(m+1);this.__setDigit(m,1073741823&_<<30-n|l),l=_>>>n}this.__setDigit(d,l)}static __specialLeftShift(n,l,d){const m=n.length,_=new W(m+d,!1);if(l===0){for(let c=0;c<m;c++)_.__setDigit(c,n.__digit(c));return 0<d&&_.__setDigit(m,0),_}let v=0;for(let c=0;c<m;c++){const C=n.__digit(c);_.__setDigit(c,1073741823&C<<l|v),v=C>>>30-l}return 0<d&&_.__setDigit(m,v),_}static __leftShiftByAbsolute(n,l){const d=W.__toShiftAmount(l);if(0>d)throw new RangeError("BigInt too big");const m=0|d/30,_=d%30,v=n.length,c=_!==0&&n.__digit(v-1)>>>30-_!=0,C=v+m+(c?1:0),R=new W(C,n.sign);if(_===0){let z=0;for(;z<m;z++)R.__setDigit(z,0);for(;z<C;z++)R.__setDigit(z,n.__digit(z-m))}else{let z=0;for(let B=0;B<m;B++)R.__setDigit(B,0);for(let B=0;B<v;B++){const V=n.__digit(B);R.__setDigit(B+m,1073741823&V<<_|z),z=V>>>30-_}if(c)R.__setDigit(v+m,z);else if(z!==0)throw new Error("implementation bug")}return R.__trim()}static __rightShiftByAbsolute(n,l){const d=n.length,m=n.sign,_=W.__toShiftAmount(l);if(0>_)return W.__rightShiftByMaximum(m);const v=0|_/30,c=_%30;let C=d-v;if(0>=C)return W.__rightShiftByMaximum(m);let R=!1;if(m){if((n.__digit(v)&(1<<c)-1)!=0)R=!0;else for(let B=0;B<v;B++)if(n.__digit(B)!==0){R=!0;break}}R&&c===0&&~n.__digit(d-1)==0&&C++;let z=new W(C,m);if(c===0){z.__setDigit(C-1,0);for(let B=v;B<d;B++)z.__setDigit(B-v,n.__digit(B))}else{let B=n.__digit(v)>>>c;const V=d-v-1;for(let G=0;G<V;G++){const re=n.__digit(G+v+1);z.__setDigit(G,1073741823&re<<30-c|B),B=re>>>c}z.__setDigit(V,B)}return R&&(z=W.__absoluteAddOne(z,!0,z)),z.__trim()}static __rightShiftByMaximum(n){return n?W.__oneDigit(1,!0):W.__zero()}static __toShiftAmount(n){if(1<n.length)return-1;const l=n.__unsignedDigit(0);return l>W.__kMaxLengthBits?-1:l}static __toPrimitive(n,l="default"){if(typeof n!="object"||n.constructor===W)return n;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const _=n[Symbol.toPrimitive];if(_){const v=_(l);if(typeof v!="object")return v;throw new TypeError("Cannot convert object to primitive value")}}const d=n.valueOf;if(d){const _=d.call(n);if(typeof _!="object")return _}const m=n.toString;if(m){const _=m.call(n);if(typeof _!="object")return _}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(n){return W.__isBigInt(n)?n:+n}static __isBigInt(n){return typeof n=="object"&&n!==null&&n.constructor===W}static __truncateToNBits(n,l){const d=0|(n+29)/30,m=new W(d,l.sign),_=d-1;for(let c=0;c<_;c++)m.__setDigit(c,l.__digit(c));let v=l.__digit(_);if(n%30!=0){const c=32-n%30;v=v<<c>>>c}return m.__setDigit(_,v),m.__trim()}static __truncateAndSubFromPowerOfTwo(n,l,d){var m=Math.min;const _=0|(n+29)/30,v=new W(_,d);let c=0;const C=_-1;let R=0;for(const G=m(C,l.length);c<G;c++){const re=0-l.__digit(c)-R;R=1&re>>>30,v.__setDigit(c,1073741823&re)}for(;c<C;c++)v.__setDigit(c,0|1073741823&-R);let z=C<l.length?l.__digit(C):0;const B=n%30;let V;if(B==0)V=0-z-R,V&=1073741823;else{const G=32-B;z=z<<G>>>G;const re=1<<32-G;V=re-z-R,V&=re-1}return v.__setDigit(C,V),v.__trim()}__digit(n){return this[n]}__unsignedDigit(n){return this[n]>>>0}__setDigit(n,l){this[n]=0|l}__setDigitGrow(n,l){this[n]=0|l}__halfDigitLength(){const n=this.length;return 32767>=this.__unsignedDigit(n-1)?2*n-1:2*n}__halfDigit(n){return 32767&this[n>>>1]>>>15*(1&n)}__setHalfDigit(n,l){const d=n>>>1,m=this.__digit(d),_=1&n?32767&m|l<<15:1073709056&m|32767&l;this.__setDigit(d,_)}static __digitPow(n,l){let d=1;for(;0<l;)1&l&&(d*=n),l>>>=1,n*=n;return d}static __isOneDigitInt(n){return(1073741823&n)===n}}W.__kMaxLength=33554432,W.__kMaxLengthBits=W.__kMaxLength<<5,W.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],W.__kBitsPerCharTableShift=5,W.__kBitsPerCharTableMultiplier=1<<W.__kBitsPerCharTableShift,W.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],W.__kBitConversionBuffer=new ArrayBuffer(8),W.__kBitConversionDouble=new Float64Array(W.__kBitConversionBuffer),W.__kBitConversionInts=new Int32Array(W.__kBitConversionBuffer),W.__clz30=Math.clz32?function(i){return Math.clz32(i)-2}:function(i){return i===0?30:0|29-(0|Math.log(i>>>0)/Math.LN2)},W.__imul=Math.imul||function(i,n){return 0|i*n};const tl=W.BigInt(0),t_=W.BigInt(1),Ix=W.BigInt(2),AI=W.BigInt(10),MI=W.BigInt(24),CI=W.BigInt(60),DI=W.BigInt(1e3),b_=W.BigInt(1e6),$y=W.BigInt(1e9),rS=W.multiply(W.BigInt(3600),$y),kI=W.multiply(CI,$y),uf=W.multiply(rS,MI);function Bh(i){return typeof i=="bigint"?W.BigInt(i.toString(10)):i}function aS(i){return W.equal(W.remainder(i,Ix),tl)}function sp(i){return W.lessThan(i,tl)?W.unaryMinus(i):i}function Z0(i,n){return W.lessThan(i,n)?-1:W.greaterThan(i,n)?1:0}function Py(i,n){return{quotient:W.divide(i,n),remainder:W.remainder(i,n)}}var vw,bw;const yn="slot-epochNanoSeconds",_n="slot-iso-date",ir="slot-iso-date-time",xr="slot-time",At="slot-calendar",sS="slot-date-brand",oS="slot-year-month-brand",lS="slot-month-day-brand",fi="slot-time-zone",Vs="slot-years",Gs="slot-months",To="slot-weeks",Zs="slot-days",$s="slot-hours",Ys="slot-minutes",qs="slot-seconds",Hs="slot-milliseconds",Xs="slot-microseconds",So="slot-nanoseconds",cS="date",uS="ym",hS="md",dS="time",fS="datetime",pS="instant",Cp="original",qm="timezone-canonical",jb="timezone-original",Ny="calendar-id",mS="locale",Bb="options",gS=new WeakMap,Fb=Symbol.for("@@Temporal__GetSlots");(vw=globalThis)[Fb]||(vw[Fb]=function(i){return gS.get(i)});const mv=globalThis[Fb],Ub=Symbol.for("@@Temporal__CreateSlots");(bw=globalThis)[Ub]||(bw[Ub]=function(i){gS.set(i,Object.create(null))});const od=globalThis[Ub];function to(i,...n){if(!i||typeof i!="object")return!1;const l=mv(i);return!!l&&n.every(d=>d in l)}function te(i,n){const l=mv(i)?.[n];if(l===void 0)throw new TypeError(`Missing internal slot ${n}`);return l}function Pn(i,n,l){const d=mv(i);if(d===void 0)throw new TypeError("Missing slots for the given container");if(d[n])throw new TypeError(`${n} already has set`);d[n]=l}const Vb={};function ld(i,n){Object.defineProperty(i.prototype,Symbol.toStringTag,{value:n,writable:!1,enumerable:!1,configurable:!0});const l=Object.getOwnPropertyNames(i);for(let m=0;m<l.length;m++){const _=l[m],v=Object.getOwnPropertyDescriptor(i,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i,_,v))}const d=Object.getOwnPropertyNames(i.prototype);for(let m=0;m<d.length;m++){const _=d[m],v=Object.getOwnPropertyDescriptor(i.prototype,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i.prototype,_,v))}Gb(n,i),Gb(`${n}.prototype`,i.prototype)}function Gb(i,n){const l=`%${i}%`;if(Vb[l]!==void 0)throw new Error(`intrinsic ${i} already exists`);Vb[l]=n}function Qa(i){return Vb[i]}function Xm(i,n){let l=i;if(l===0)return{div:l,mod:l};const d=Math.sign(l);l=Math.abs(l);const m=Math.trunc(1+Math.log10(l));if(n>=m)return{div:0*d,mod:d*l};if(n===0)return{div:d*l,mod:0*d};const _=l.toPrecision(m);return{div:d*Number.parseInt(_.slice(0,m-n),10),mod:d*Number.parseInt(_.slice(m-n),10)}}function fb(i,n,l){let d=i,m=l;if(d===0)return m;const _=Math.sign(d)||Math.sign(m);d=Math.abs(d),m=Math.abs(m);const v=d.toPrecision(Math.trunc(1+Math.log10(d)));if(m===0)return _*Number.parseInt(v+"0".repeat(n),10);const c=v+m.toPrecision(Math.trunc(1+Math.log10(m))).padStart(n,"0");return _*Number.parseInt(c,10)}function gv(i,n){const l=n==="negative";switch(i){case"ceil":return l?"zero":"infinity";case"floor":return l?"infinity":"zero";case"expand":return"infinity";case"trunc":return"zero";case"halfCeil":return l?"half-zero":"half-infinity";case"halfFloor":return l?"half-infinity":"half-zero";case"halfExpand":return"half-infinity";case"halfTrunc":return"half-zero";case"halfEven":return"half-even"}}function yv(i,n,l,d,m){return m==="zero"?i:m==="infinity"?n:l<0?i:l>0?n:m==="half-zero"?i:m==="half-infinity"?n:d?i:n}class Bn{constructor(n){this.totalNs=Bh(n),this.sec=W.toNumber(W.divide(this.totalNs,$y)),this.subsec=W.toNumber(W.remainder(this.totalNs,$y))}static validateNew(n,l){if(W.greaterThan(sp(n),Bn.MAX))throw new RangeError(`${l} of duration time units cannot exceed ${Bn.MAX} s`);return new Bn(n)}static fromEpochNsDiff(n,l){const d=W.subtract(Bh(n),Bh(l));return new Bn(d)}static fromComponents(n,l,d,m,_,v){const c=W.add(W.add(W.add(W.add(W.add(W.BigInt(v),W.multiply(W.BigInt(_),DI)),W.multiply(W.BigInt(m),b_)),W.multiply(W.BigInt(d),$y)),W.multiply(W.BigInt(l),kI)),W.multiply(W.BigInt(n),rS));return Bn.validateNew(c,"total")}abs(){return new Bn(sp(this.totalNs))}add(n){return Bn.validateNew(W.add(this.totalNs,n.totalNs),"sum")}add24HourDays(n){return Bn.validateNew(W.add(this.totalNs,W.multiply(W.BigInt(n),uf)),"sum")}addToEpochNs(n){return W.add(Bh(n),this.totalNs)}cmp(n){return Z0(this.totalNs,n.totalNs)}divmod(n){const{quotient:l,remainder:d}=Py(this.totalNs,W.BigInt(n));return{quotient:W.toNumber(l),remainder:new Bn(d)}}fdiv(n){const l=Bh(n),d=W.BigInt(l);let{quotient:m,remainder:_}=Py(this.totalNs,d);const v=[];let c;const C=(W.lessThan(this.totalNs,tl)?-1:1)*Math.sign(W.toNumber(l));for(;!W.equal(_,tl)&&v.length<50;)_=W.multiply(_,AI),{quotient:c,remainder:_}=Py(_,d),v.push(Math.abs(W.toNumber(c)));return C*+(sp(m).toString()+"."+v.join(""))}isZero(){return W.equal(this.totalNs,tl)}round(n,l){const d=Bh(n);if(W.equal(d,t_))return this;const{quotient:m,remainder:_}=Py(this.totalNs,d),v=W.lessThan(this.totalNs,tl)?"negative":"positive",c=W.multiply(sp(m),d),C=W.add(c,d),R=Z0(sp(W.multiply(_,Ix)),d),z=gv(l,v),B=W.equal(sp(this.totalNs),c)?c:yv(c,C,R,aS(m),z),V=v==="positive"?B:W.unaryMinus(B);return Bn.validateNew(V,"rounding")}sign(){return this.cmp(new Bn(tl))}subtract(n){return Bn.validateNew(W.subtract(this.totalNs,n.totalNs),"difference")}}Bn.MAX=W.BigInt("9007199254740991999999999"),Bn.ZERO=new Bn(tl);const xw=/[A-Za-z._][A-Za-z._0-9+-]*/,x_=new RegExp(`(?:${/(?:[+-](?:[01][0-9]|2[0-3])(?::?[0-5][0-9])?)/.source}|(?:${xw.source})(?:\\/(?:${xw.source}))*)`),yS=/(?:[+-]\d{6}|\d{4})/,$0=/(?:0[1-9]|1[0-2])/,Zb=/(?:0[1-9]|[12]\d|3[01])/,RI=new RegExp(`(${yS.source})(?:-(${$0.source})-(${Zb.source})|(${$0.source})(${Zb.source}))`),_S=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,vS=/((?:[+-])(?:[01][0-9]|2[0-3])(?::?(?:[0-5][0-9])(?::?(?:[0-5][0-9])(?:[.,](?:\d{1,9}))?)?)?)/,bS=new RegExp(`([zZ])|${vS.source}?`),og=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,II=new RegExp([`^${RI.source}`,`(?:(?:[tT]|\\s+)${_S.source}(?:${bS.source})?)?`,`(?:\\[!?(${x_.source})\\])?`,`((?:${og.source})*)$`].join("")),PI=new RegExp([`^[tT]?${_S.source}`,`(?:${bS.source})?`,`(?:\\[!?${x_.source}\\])?`,`((?:${og.source})*)$`].join("")),NI=new RegExp(`^(${yS.source})-?(${$0.source})(?:\\[!?${x_.source}\\])?((?:${og.source})*)$`),zI=new RegExp(`^(?:--)?(${$0.source})-?(${Zb.source})(?:\\[!?${x_.source}\\])?((?:${og.source})*)$`),pb=/(\d+)(?:[.,](\d{1,9}))?/,LI=new RegExp(`(?:${pb.source}H)?(?:${pb.source}M)?(?:${pb.source}S)?`),OI=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${LI.source})?$`,"i"),hf=864e5,Y0=1e6*hf,jI=6e10,xS=1e8*hf,lg=Pu(xS),n_=W.unaryMinus(lg),BI=W.add(W.subtract(n_,uf),t_),FI=W.subtract(W.add(lg,uf),t_),UI=146097*hf,ww=-271821,Tw=275760,Yy=Date.UTC(1847,0,1),VI=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","ethiopic-amete-alem","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"],GI=new Set(["ACT","AET","AGT","ART","AST","BET","BST","CAT","CNT","CST","CTT","EAT","ECT","IET","IST","JST","MIT","NET","NST","PLT","PNT","PRT","PST","SST","VST"]);function wr(i){return typeof i=="object"&&i!==null||typeof i=="function"}function _v(i){if(typeof i=="bigint")throw new TypeError("Cannot convert BigInt to number");return Number(i)}function vv(i){if(typeof i=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return String(i)}function Tn(i){const n=_v(i);if(n===0)return 0;if(Number.isNaN(n)||n===1/0||n===-1/0)throw new RangeError("invalid number value");const l=Math.trunc(n);return l===0?0:l}function Sw(i,n){const l=Tn(i);if(l<=0)throw n!==void 0?new RangeError(`property '${n}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return l}function Dc(i){const n=_v(i);if(Number.isNaN(n))throw new RangeError("not a number");if(n===1/0||n===-1/0)throw new RangeError("infinity is out of range");if(!function(l){if(typeof l!="number"||Number.isNaN(l)||l===1/0||l===-1/0)return!1;const d=Math.abs(l);return Math.floor(d)===d}(n))throw new RangeError(`unsupported fractional value ${i}`);return n===0?0:n}function i_(i,n){return String(i).padStart(n,"0")}function ga(i){if(typeof i!="string")throw new TypeError(`expected a string, not ${String(i)}`);return i}function $b(i,n){if(wr(i)){const l=i?.toString();if(typeof l=="string"||typeof l=="number")return l;throw new TypeError("Cannot convert object to primitive value")}return i}const Yb=["era","eraYear","year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],ZI={era:vv,eraYear:Tn,year:Tn,month:Sw,monthCode:function(i){const n=ga($b(i));if(n.length<3||n.length>4||n[0]!=="M"||"0123456789".indexOf(n[1])===-1||"0123456789".indexOf(n[2])===-1||n[1]+n[2]==="00"&&n[3]!=="L"||n[3]!=="L"&&n[3]!==void 0)throw new RangeError(`bad month code ${n}; must match M01-M99 or M00L-M99L`);return n},day:Sw,hour:Tn,minute:Tn,second:Tn,millisecond:Tn,microsecond:Tn,nanosecond:Tn,offset:function(i){const n=ga($b(i));return Tg(n),n},timeZone:Ks},$I={hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},cg=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],Ew=Object.fromEntries(cg.map(i=>[i[0],i[1]])),YI=Object.fromEntries(cg.map(([i,n])=>[n,i])),qy=cg.map(([,i])=>i),ug={day:Y0,hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},q0=["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],qI=Intl.DateTimeFormat,Aw=new Map;function wS(i){const n=l_(i);let l=Aw.get(n);return l===void 0&&(l=new qI("en-us",{timeZone:n,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),Aw.set(n,l)),l}function Ha(i){return to(i,yn)&&!to(i,fi,At)}function vr(i){return to(i,Vs,Gs,Zs,$s,Ys,qs,Hs,Xs,So)}function br(i){return to(i,sS)}function Dr(i){return to(i,xr)}function Hi(i){return to(i,ir)}function Xa(i){return to(i,oS)}function el(i){return to(i,lS)}function jn(i){return to(i,yn,fi,At)}function it(i,n){if(!n(i))throw new TypeError("invalid receiver: method called with the wrong type of this-object")}function bg(i){if(to(i,At)||to(i,fi))throw new TypeError("with() does not support a calendar or timeZone property");if(Dr(i))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(i.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(i.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function w_(i,n){return n==="never"||n==="auto"&&i==="iso8601"?"":`[${n==="critical"?"!":""}u-ca=${i}]`}function bv(i){let n,l,d=!1;for(og.lastIndex=0;l=og.exec(i);){const{1:m,2:_,3:v}=l;if(_==="u-ca"){if(n===void 0)n=v,d=m==="!";else if(m==="!"||d)throw new RangeError(`Invalid annotations in ${i}: more than one u-ca present with critical flag`)}else if(m==="!")throw new RangeError(`Unrecognized annotation: !${_}=${v}`)}return n}function Uu(i){const n=II.exec(i);if(!n)throw new RangeError(`invalid RFC 9557 string: ${i}`);const l=bv(n[16]);let d=n[1];if(d==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);const m=+d,_=+(n[2]??n[4]??1),v=+(n[3]??n[5]??1),c=n[6]!==void 0,C=+(n[6]??0),R=+(n[7]??n[10]??0);let z=+(n[8]??n[11]??0);z===60&&(z=59);const B=(n[9]??n[12]??"")+"000000000",V=+B.slice(0,3),G=+B.slice(3,6),re=+B.slice(6,9);let fe,pe=!1;n[13]?(fe=void 0,pe=!0):n[14]&&(fe=n[14]);const Ie=n[15];return jx(m,_,v,C,R,z,V,G,re),{year:m,month:_,day:v,time:c?{hour:C,minute:R,second:z,millisecond:V,microsecond:G,nanosecond:re}:"start-of-day",tzAnnotation:Ie,offset:fe,z:pe,calendar:l}}function TS(i){const n=PI.exec(i);let l,d,m,_,v,c,C;if(n){C=bv(n[10]),l=+(n[1]??0),d=+(n[2]??n[5]??0),m=+(n[3]??n[6]??0),m===60&&(m=59);const R=(n[4]??n[7]??"")+"000000000";if(_=+R.slice(0,3),v=+R.slice(3,6),c=+R.slice(6,9),n[8])throw new RangeError("Z designator not supported for PlainTime")}else{let R,z;if({time:R,z,calendar:C}=Uu(i),R==="start-of-day")throw new RangeError(`time is missing in string: ${i}`);if(z)throw new RangeError("Z designator not supported for PlainTime");({hour:l,minute:d,second:m,millisecond:_,microsecond:v,nanosecond:c}=R)}if(Sv(l,d,m,_,v,c),/[tT ][0-9][0-9]/.test(i))return{hour:l,minute:d,second:m,millisecond:_,microsecond:v,nanosecond:c,calendar:C};try{const{month:R,day:z}=Nx(i);vp(1972,R,z)}catch{try{const{year:R,month:z}=Px(i);vp(R,z,1)}catch{return{hour:l,minute:d,second:m,millisecond:_,microsecond:v,nanosecond:c,calendar:C}}}throw new RangeError(`invalid RFC 9557 time-only string ${i}; may need a T prefix`)}function Px(i){const n=NI.exec(i);let l,d,m,_;if(n){m=bv(n[3]);let v=n[1];if(v==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);if(l=+v,d=+n[2],_=1,m!==void 0&&m!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let v;if({year:l,month:d,calendar:m,day:_,z:v}=Uu(i),v)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:l,month:d,calendar:m,referenceISODay:_}}function Nx(i){const n=zI.exec(i);let l,d,m,_;if(n){if(m=bv(n[3]),l=+n[1],d=+n[2],m!==void 0&&m!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let v;if({month:l,day:d,calendar:m,year:_,z:v}=Uu(i),v)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:l,day:d,calendar:m,referenceISOYear:_}}const SS=new RegExp(`^${x_.source}$`,"i"),ES=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])?)?/.source}$`);function AS(i){const n=XI.test(i)?"Seconds not allowed in offset time zone":"Invalid time zone";throw new RangeError(`${n}: ${i}`)}function of(i){return SS.test(i)||AS(i),ES.test(i)?{offsetMinutes:Tg(i)/6e10}:{tzName:i}}function Hy(i,n,l,d){let m=i,_=n,v=l;switch(d){case"reject":vp(m,_,v);break;case"constrain":({year:m,month:_,day:v}=GS(m,_,v))}return{year:m,month:_,day:v}}function xv(i,n,l,d,m,_,v){let c=i,C=n,R=l,z=d,B=m,V=_;switch(v){case"reject":Sv(c,C,R,z,B,V);break;case"constrain":c=Ws(c,0,23),C=Ws(C,0,59),R=Ws(R,0,59),z=Ws(z,0,999),B=Ws(B,0,999),V=Ws(V,0,999)}return{hour:c,minute:C,second:R,millisecond:z,microsecond:B,nanosecond:V}}function MS(i){if(!wr(i))throw new TypeError("invalid duration-like");const n={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let l=!1;for(let d=0;d<q0.length;d++){const m=q0[d],_=i[m];_!==void 0&&(l=!0,n[m]=Dc(_))}if(!l)throw new TypeError("invalid duration-like");return n}function bs({years:i,months:n,weeks:l,days:d},m,_,v){return{years:i,months:v??n,weeks:_??l,days:m??d}}function ri(i,n){return{isoDate:i,time:n}}function ti(i){return Jh(i,"overflow",["constrain","reject"],"constrain")}function Xy(i){return Jh(i,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function Pc(i,n){return Jh(i,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],n)}function L0(i,n){return Jh(i,"offset",["prefer","use","ignore","reject"],n)}function T_(i){return Jh(i,"calendarName",["auto","always","never","critical"],"auto")}function xg(i){let n=i.roundingIncrement;if(n===void 0)return 1;const l=Tn(n);if(l<1||l>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${n}`);return l}function wg(i,n,l){const d=l?n:n-1;if(i>d)throw new RangeError(`roundingIncrement must be at least 1 and less than ${d}, not ${i}`);if(n%i!=0)throw new RangeError(`Rounding increment must divide evenly into ${n}`)}function S_(i){const n=i.fractionalSecondDigits;if(n===void 0)return"auto";if(typeof n!="number"){if(vv(n)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return"auto"}const l=Math.floor(n);if(!Number.isFinite(l)||l<0||l>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return l}function E_(i,n){switch(i){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(n){case"auto":return{precision:n,unit:"nanosecond",increment:1};case 0:return{precision:n,unit:"second",increment:1};case 1:case 2:case 3:return{precision:n,unit:"millisecond",increment:10**(3-n)};case 4:case 5:case 6:return{precision:n,unit:"microsecond",increment:10**(6-n)};case 7:case 8:case 9:return{precision:n,unit:"nanosecond",increment:10**(9-n)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`)}}const rd=Symbol("~required~");function Ao(i,n,l,d,m=[]){let _=[];for(let R=0;R<cg.length;R++){const z=cg[R],B=z[1],V=z[2];l!=="datetime"&&l!==V||_.push(B)}_=_.concat(m);let v=d;v===rd?v=void 0:v!==void 0&&_.push(v);let c=[];c=c.concat(_);for(let R=0;R<_.length;R++){const z=_[R],B=YI[z];B!==void 0&&c.push(B)}let C=Jh(i,n,c,v);if(C===void 0&&d===rd)throw new RangeError(`${n} is required`);return C&&C in Ew?Ew[C]:C}function mb(i){const n=i.relativeTo;if(n===void 0)return{};let l,d,m,_,v,c="option",C=!1;if(wr(n)){if(jn(n))return{zonedRelativeTo:n};if(br(n))return{plainRelativeTo:n};if(Hi(n))return{plainRelativeTo:Qs(te(n,ir).isoDate,te(n,At))};m=k_(n);const R=sl(m,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],[]);({isoDate:l,time:d}=M_(m,R,"constrain")),{offset:v,timeZone:_}=R,v===void 0&&(c="wall")}else{let R,z,B,V,G;if({year:B,month:V,day:G,time:d,calendar:m,tzAnnotation:R,offset:v,z}=Uu(ga(n)),R)_=Ks(R),z?c="exact":v||(c="wall"),C=!0;else if(z)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");m||(m="iso8601"),m=no(m),l={year:B,month:V,day:G}}return _===void 0?{plainRelativeTo:Qs(l,m)}:{zonedRelativeTo:vs(H0(l,d,c,c==="option"?Tg(v):0,_,"compatible","reject",C),_,m)}}function Uh(i){return te(i,Vs)!==0?"year":te(i,Gs)!==0?"month":te(i,To)!==0?"week":te(i,Zs)!==0?"day":te(i,$s)!==0?"hour":te(i,Ys)!==0?"minute":te(i,qs)!==0?"second":te(i,Hs)!==0?"millisecond":te(i,Xs)!==0?"microsecond":"nanosecond"}function Qh(i,n){return qy.indexOf(i)>qy.indexOf(n)?n:i}function Mu(i){return i==="year"||i==="month"||i==="week"}function Vh(i){return Mu(i)||i==="day"?"date":"time"}function gf(i){return Qa("%calendarImpl%")(i)}function A_(i){return Qa("%calendarImpl%")(te(i,At))}function Js(i,n,l="date"){const d=Object.create(null),m=gf(i).isoToDate(n,{year:!0,monthCode:!0,day:!0});return d.monthCode=m.monthCode,l!=="month-day"&&l!=="date"||(d.day=m.day),l!=="year-month"&&l!=="date"||(d.year=m.year),d}function sl(i,n,l,d,m){const _=gf(i).extraFields(l),v=l.concat(d,_),c=Object.create(null);let C=!1;v.sort();for(let R=0;R<v.length;R++){const z=v[R],B=n[z];if(B!==void 0)C=!0,c[z]=(0,ZI[z])(B);else if(m!=="partial"){if(m.includes(z))throw new TypeError(`required property '${z}' missing or undefined`);c[z]=$I[z]}}if(m==="partial"&&!C)throw new TypeError("no supported properties found");return c}function qb(i,n="complete"){const l=["hour","microsecond","millisecond","minute","nanosecond","second"];let d=!1;const m=Object.create(null);for(let _=0;_<l.length;_++){const v=l[_],c=i[v];c!==void 0?(m[v]=Tn(c),d=!0):n==="complete"&&(m[v]=0)}if(!d)throw new TypeError("invalid time-like");return m}function zy(i,n){if(wr(i)){if(br(i))return ti(Jt(n)),Qs(te(i,_n),te(i,At));if(jn(i)){const C=Ol(te(i,fi),te(i,yn));return ti(Jt(n)),Qs(C.isoDate,te(i,At))}if(Hi(i))return ti(Jt(n)),Qs(te(i,ir).isoDate,te(i,At));const c=k_(i);return Qs(df(c,sl(c,i,["year","month","monthCode","day"],[],[]),ti(Jt(n))),c)}let{year:l,month:d,day:m,calendar:_,z:v}=Uu(ga(i));if(v)throw new RangeError("Z designator not supported for PlainDate");return _||(_="iso8601"),_=no(_),ti(Jt(n)),Qs({year:l,month:d,day:m},_)}function M_(i,n,l){return ri(df(i,n,l),xv(n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond,l))}function Ly(i,n){let l,d,m;if(wr(i)){if(Hi(i))return ti(Jt(n)),Rl(te(i,ir),te(i,At));if(jn(i)){const c=Ol(te(i,fi),te(i,yn));return ti(Jt(n)),Rl(c,te(i,At))}if(br(i))return ti(Jt(n)),Rl(ri(te(i,_n),{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),te(i,At));m=k_(i);const _=sl(m,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],[]),v=ti(Jt(n));({isoDate:l,time:d}=M_(m,_,v))}else{let _,v,c,C;if({year:v,month:c,day:C,time:d,calendar:m,z:_}=Uu(ga(i)),_)throw new RangeError("Z designator not supported for PlainDateTime");d==="start-of-day"&&(d={deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),jx(v,c,C,d.hour,d.minute,d.second,d.millisecond,d.microsecond,d.nanosecond),m||(m="iso8601"),m=no(m),ti(Jt(n)),l={year:v,month:c,day:C}}return Rl(ri(l,d),m)}function Nl(i){const n=Qa("%Temporal.Duration%");if(vr(i))return new n(te(i,Vs),te(i,Gs),te(i,To),te(i,Zs),te(i,$s),te(i,Ys),te(i,qs),te(i,Hs),te(i,Xs),te(i,So));if(!wr(i))return function(m){const{years:_,months:v,weeks:c,days:C,hours:R,minutes:z,seconds:B,milliseconds:V,microseconds:G,nanoseconds:re}=function(fe){const pe=OI.exec(fe);if(!pe)throw new RangeError(`invalid duration: ${fe}`);if(pe.every((Dt,It)=>It<2||Dt===void 0))throw new RangeError(`invalid duration: ${fe}`);const Ie=pe[1]==="-"?-1:1,Ge=pe[2]===void 0?0:Tn(pe[2])*Ie,je=pe[3]===void 0?0:Tn(pe[3])*Ie,He=pe[4]===void 0?0:Tn(pe[4])*Ie,Ve=pe[5]===void 0?0:Tn(pe[5])*Ie,rt=pe[6]===void 0?0:Tn(pe[6])*Ie,Je=pe[7],Mt=pe[8],Ne=pe[9],Xe=pe[10],_t=pe[11];let Rt=0,Ut=0,un=0;if(Je!==void 0){if(Mt??Ne??Xe??_t)throw new RangeError("only the smallest unit can be fractional");un=3600*Tn((Je+"000000000").slice(0,9))*Ie}else if(Rt=Mt===void 0?0:Tn(Mt)*Ie,Ne!==void 0){if(Xe??_t)throw new RangeError("only the smallest unit can be fractional");un=60*Tn((Ne+"000000000").slice(0,9))*Ie}else Ut=Xe===void 0?0:Tn(Xe)*Ie,_t!==void 0&&(un=Tn((_t+"000000000").slice(0,9))*Ie);const Ht=un%1e3,Ue=Math.trunc(un/1e3)%1e3,ft=Math.trunc(un/1e6)%1e3;return Ut+=Math.trunc(un/1e9)%60,Rt+=Math.trunc(un/6e10),Ev(Ge,je,He,Ve,rt,Rt,Ut,ft,Ue,Ht),{years:Ge,months:je,weeks:He,days:Ve,hours:rt,minutes:Rt,seconds:Ut,milliseconds:ft,microseconds:Ue,nanoseconds:Ht}}(m);return new(Qa("%Temporal.Duration%"))(_,v,c,C,R,z,B,V,G,re)}(ga(i));const l={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let d=MS(i);for(let m=0;m<q0.length;m++){const _=q0[m],v=d[_];v!==void 0&&(l[_]=v)}return new n(l.years,l.months,l.weeks,l.days,l.hours,l.minutes,l.seconds,l.milliseconds,l.microseconds,l.nanoseconds)}function Oy(i){let n;if(wr(i)){if(Ha(i)||jn(i))return Ru(te(i,yn));n=$b(i)}else n=i;const{year:l,month:d,day:m,time:_,offset:v,z:c}=function(fe){const pe=Uu(fe);if(!pe.z&&!pe.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return pe}(ga(n)),{hour:C=0,minute:R=0,second:z=0,millisecond:B=0,microsecond:V=0,nanosecond:G=0}=_==="start-of-day"?{}:_,re=o_(l,d,m,C,R,z,B,V,G-(c?0:Tg(v)));return eg(re.isoDate),Ru(Wa(re))}function Mw(i,n){if(wr(i)){if(el(i))return ti(Jt(n)),Wm(te(i,_n),te(i,At));let c;return to(i,At)?c=te(i,At):(c=i.calendar,c===void 0&&(c="iso8601"),c=D_(c)),Wm(X0(c,sl(c,i,["year","month","monthCode","day"],[],[]),ti(Jt(n))),c)}let{month:l,day:d,referenceISOYear:m,calendar:_}=Nx(ga(i));if(_===void 0&&(_="iso8601"),_=no(_),ti(Jt(n)),_==="iso8601")return Wm({year:1972,month:l,day:d},_);let v={year:m,month:l,day:d};return Dp(v),v=X0(_,Js(_,v,"month-day"),"constrain"),Wm(v,_)}function rf(i,n){let l;if(wr(i)){if(Dr(i))return ti(Jt(n)),$h(te(i,xr));if(Hi(i))return ti(Jt(n)),$h(te(i,ir).time);if(jn(i)){const R=Ol(te(i,fi),te(i,yn));return ti(Jt(n)),$h(R.time)}const{hour:d,minute:m,second:_,millisecond:v,microsecond:c,nanosecond:C}=qb(i);l=xv(d,m,_,v,c,C,ti(Jt(n)))}else l=TS(ga(i)),ti(Jt(n));return $h(l)}function CS(i){return i===void 0?{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}:te(rf(i),xr)}function jy(i,n){if(wr(i)){if(Xa(i))return ti(Jt(n)),Jm(te(i,_n),te(i,At));const c=k_(i);return Jm(r_(c,sl(c,i,["year","month","monthCode"],[],[]),ti(Jt(n))),c)}let{year:l,month:d,referenceISODay:m,calendar:_}=Px(ga(i));_===void 0&&(_="iso8601"),_=no(_),ti(Jt(n));let v={year:l,month:d,day:m};return Bx(v),v=r_(_,Js(_,v,"year-month"),"constrain"),Jm(v,_)}function H0(i,n,l,d,m,_,v,c){if(n==="start-of-day")return tf(m,i);const C=ri(i,n);if(l==="wall"||v==="ignore")return xs(m,C,_);if(l==="exact"||v==="use"){const B=o_(i.year,i.month,i.day,n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond-d);eg(B.isoDate);const V=Wa(B);return ju(V),V}eg(i);const R=Wa(C),z=a_(m,C);for(let B=0;B<z.length;B++){const V=z[B],G=W.toNumber(W.subtract(R,V)),re=af(G,6e10,"halfExpand");if(G===d||c&&re===d)return V}if(v==="reject"){const B=Hb(d),V=s_(C,"iso8601","auto");throw new RangeError(`Offset ${B} is invalid for ${V} in ${m}`)}return OS(z,m,C,_)}function By(i,n){let l,d,m,_,v,c,C,R=!1,z="option";if(wr(i)){if(jn(i)){const fe=Jt(n);return Xy(fe),L0(fe,"reject"),ti(fe),vs(te(i,yn),te(i,fi),te(i,At))}v=k_(i);const V=sl(v,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],["timeZone"]);({offset:_,timeZone:m}=V),_===void 0&&(z="wall");const G=Jt(n);c=Xy(G),C=L0(G,"reject");const re=ti(G);({isoDate:l,time:d}=M_(v,V,re))}else{let V,G,re,fe,pe;({year:re,month:fe,day:pe,time:d,tzAnnotation:V,offset:_,z:G,calendar:v}=function(Ge){const je=Uu(Ge);if(!je.tzAnnotation)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return je}(ga(i))),m=Ks(V),G?z="exact":_||(z="wall"),v||(v="iso8601"),v=no(v),R=!0;const Ie=Jt(n);c=Xy(Ie),C=L0(Ie,"reject"),ti(Ie),l={year:re,month:fe,day:pe}}let B=0;return z==="option"&&(B=Tg(_)),vs(H0(l,d,z,B,m,c,C,R),m,v)}function DS(i,n,l){Dp(n),od(i),Pn(i,_n,n),Pn(i,At,l),Pn(i,sS,!0)}function Qs(i,n){const l=Qa("%Temporal.PlainDate%"),d=Object.create(l.prototype);return DS(d,i,n),d}function kS(i,n,l){bp(n),od(i),Pn(i,ir,n),Pn(i,At,l)}function Rl(i,n){const l=Qa("%Temporal.PlainDateTime%"),d=Object.create(l.prototype);return kS(d,i,n),d}function RS(i,n,l){Dp(n),od(i),Pn(i,_n,n),Pn(i,At,l),Pn(i,lS,!0)}function Wm(i,n){const l=Qa("%Temporal.PlainMonthDay%"),d=Object.create(l.prototype);return RS(d,i,n),d}function IS(i,n){od(i),Pn(i,xr,n)}function $h(i){const n=Qa("%Temporal.PlainTime%"),l=Object.create(n.prototype);return IS(l,i),l}function PS(i,n,l){Bx(n),od(i),Pn(i,_n,n),Pn(i,At,l),Pn(i,oS,!0)}function Jm(i,n){const l=Qa("%Temporal.PlainYearMonth%"),d=Object.create(l.prototype);return PS(d,i,n),d}function NS(i,n){ju(n),od(i),Pn(i,yn,n)}function Ru(i){const n=Qa("%Temporal.Instant%"),l=Object.create(n.prototype);return NS(l,i),l}function zS(i,n,l,d){ju(n),od(i),Pn(i,yn,n),Pn(i,fi,l),Pn(i,At,d)}function vs(i,n,l="iso8601"){const d=Qa("%Temporal.ZonedDateTime%"),m=Object.create(d.prototype);return zS(m,i,n,l),m}function Cw(i){return Yb.filter(n=>i[n]!==void 0)}function _p(i,n,l){const d=Cw(l),m=gf(i).fieldKeysToIgnore(d),_=Object.create(null),v=Cw(n);for(let c=0;c<Yb.length;c++){let C;const R=Yb[c];v.includes(R)&&!m.includes(R)&&(C=n[R]),d.includes(R)&&(C=l[R]),C!==void 0&&(_[R]=C)}return _}function il(i,n,l,d){const m=gf(i).dateAdd(n,l,d);return Dp(m),m}function C_(i,n,l,d){return gf(i).dateUntil(n,l,d)}function D_(i){if(wr(i)&&to(i,At))return te(i,At);const n=ga(i);try{return no(n)}catch{}let l;try{({calendar:l}=Uu(n))}catch{try{({calendar:l}=TS(n))}catch{try{({calendar:l}=Px(n))}catch{({calendar:l}=Nx(n))}}}return l||(l="iso8601"),no(l)}function k_(i){if(to(i,At))return te(i,At);const{calendar:n}=i;return n===void 0?"iso8601":D_(n)}function Ou(i,n){return no(i)===no(n)}function df(i,n,l){const d=gf(i);d.resolveFields(n,"date");const m=d.dateToISO(n,l);return Dp(m),m}function r_(i,n,l){const d=gf(i);d.resolveFields(n,"year-month"),n.day=1;const m=d.dateToISO(n,l);return Bx(m),m}function X0(i,n,l){const d=gf(i);d.resolveFields(n,"month-day");const m=d.monthDayToISOReferenceDate(n,l);return Dp(m),m}function Ks(i){if(wr(i)&&jn(i))return te(i,fi);const n=ga(i);if(n==="UTC")return"UTC";const{tzName:l,offsetMinutes:d}=function(_){const{tzAnnotation:v,offset:c,z:C}=function(R){if(SS.test(R))return{tzAnnotation:R,offset:void 0,z:!1};try{const{tzAnnotation:z,offset:B,z:V}=Uu(R);if(V||z||B)return{tzAnnotation:z,offset:B,z:V}}catch{}AS(R)}(_);return v?of(v):C?of("UTC"):c?of(c):void 0}(n);if(d!==void 0)return zx(d);const m=W0(l);if(!m)throw new RangeError(`Unrecognized time zone ${l}`);return m.identifier}function LS(i,n){if(i===n)return!0;const l=of(i).offsetMinutes,d=of(n).offsetMinutes;if(l===void 0&&d===void 0){const m=W0(n);if(!m)return!1;const _=W0(i);return!!_&&_.primaryIdentifier===m.primaryIdentifier}return l===d}function Yh(i,n){const l=of(i).offsetMinutes;return l!==void 0?6e10*l:Xb(i,n)}function Hb(i){const n=i<0?"-":"+",l=Math.abs(i),d=Math.floor(l/36e11),m=Math.floor(l/6e10)%60,_=Math.floor(l/1e9)%60,v=l%1e9;return`${n}${wv(d,m,_,v,_===0&&v===0?"minute":"auto")}`}function Ol(i,n){const l=Yh(i,n);let{isoDate:{year:d,month:m,day:_},time:{hour:v,minute:c,second:C,millisecond:R,microsecond:z,nanosecond:B}}=FS(n);return o_(d,m,_,v,c,C,R,z,B+l)}function xs(i,n,l){return OS(a_(i,n),i,n,l)}function OS(i,n,l,d){const m=i.length;if(m===1)return i[0];if(m)switch(d){case"compatible":case"earlier":return i[0];case"later":return i[m-1];case"reject":throw new RangeError("multiple instants found")}if(d==="reject")throw new RangeError("multiple instants found");const _=Wa(l),v=W.subtract(_,uf);ju(v);const c=Yh(n,v),C=W.add(_,uf);ju(C);const R=Yh(n,C)-c;switch(d){case"earlier":{const z=Bn.fromComponents(0,0,0,0,0,-R),B=hg(l.time,z);return a_(n,ri(Do(l.isoDate.year,l.isoDate.month,l.isoDate.day+B.deltaDays),B))[0]}case"compatible":case"later":{const z=Bn.fromComponents(0,0,0,0,0,R),B=hg(l.time,z),V=a_(n,ri(Do(l.isoDate.year,l.isoDate.month,l.isoDate.day+B.deltaDays),B));return V[V.length-1]}}}function a_(i,n){if(i==="UTC")return eg(n.isoDate),[Wa(n)];const l=of(i).offsetMinutes;if(l!==void 0){const d=o_(n.isoDate.year,n.isoDate.month,n.isoDate.day,n.time.hour,n.time.minute-l,n.time.second,n.time.millisecond,n.time.microsecond,n.time.nanosecond);eg(d.isoDate);const m=Wa(d);return ju(m),[m]}return eg(n.isoDate),function(d,m){let _=Wa(m),v=W.subtract(_,uf);W.lessThan(v,n_)&&(v=_);let c=W.add(_,uf);W.greaterThan(c,lg)&&(c=_);const C=Xb(d,v),R=Xb(d,c);return(C===R?[C]:[C,R]).map(B=>{const V=W.subtract(_,W.BigInt(B)),G=function(re,fe){const{epochMilliseconds:pe,time:{millisecond:Ie,microsecond:Ge,nanosecond:je}}=FS(fe),{year:He,month:Ve,day:rt,hour:Je,minute:Mt,second:Ne}=US(re,pe);return o_(He,Ve,rt,Je,Mt,Ne,Ie,Ge,je)}(d,V);if(dg(m,G)===0)return ju(V),V}).filter(B=>B!==void 0)}(i,n)}function tf(i,n){const l=ri(n,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),d=a_(i,l);if(d.length)return d[0];const m=Wa(l),_=W.subtract(m,uf);return ju(_),Ox(i,_)}function R_(i){let n;return n=i<0||i>9999?(i<0?"-":"+")+i_(Math.abs(i),6):i_(i,4),n}function rl(i){return i_(i,2)}function jS(i,n){let l;if(n==="auto"){if(i===0)return"";l=i_(i,9).replace(/0+$/,"")}else{if(n===0)return"";l=i_(i,9).slice(0,n)}return`.${l}`}function wv(i,n,l,d,m){let _=`${rl(i)}:${rl(n)}`;return m==="minute"||(_+=`:${rl(l)}`,_+=jS(d,m)),_}function Dw(i,n,l){let d=n;d===void 0&&(d="UTC");const m=te(i,yn),_=s_(Ol(d,m),"iso8601",l,"never");let v="Z";return n!==void 0&&(v=BS(Yh(d,m))),`${_}${v}`}function k0(i,n){const l=te(i,Vs),d=te(i,Gs),m=te(i,To),_=te(i,Zs),v=te(i,$s),c=te(i,Ys),C=K0(i);let R="";l!==0&&(R+=`${Math.abs(l)}Y`),d!==0&&(R+=`${Math.abs(d)}M`),m!==0&&(R+=`${Math.abs(m)}W`),_!==0&&(R+=`${Math.abs(_)}D`);let z="";v!==0&&(z+=`${Math.abs(v)}H`),c!==0&&(z+=`${Math.abs(c)}M`);const B=Bn.fromComponents(0,0,te(i,qs),te(i,Hs),te(i,Xs),te(i,So));B.isZero()&&!["second","millisecond","microsecond","nanosecond"].includes(Uh(i))&&n==="auto"||(z+=`${Math.abs(B.sec)}${jS(Math.abs(B.subsec),n)}S`);let V=`${C<0?"-":""}P${R}`;return z&&(V=`${V}T${z}`),V}function kw(i,n="auto"){const{year:l,month:d,day:m}=te(i,_n);return`${R_(l)}-${rl(d)}-${rl(m)}${w_(te(i,At),n)}`}function Rw({hour:i,minute:n,second:l,millisecond:d,microsecond:m,nanosecond:_},v){return wv(i,n,l,1e6*d+1e3*m+_,v)}function s_(i,n,l,d="auto"){const{isoDate:{year:m,month:_,day:v},time:{hour:c,minute:C,second:R,millisecond:z,microsecond:B,nanosecond:V}}=i;return`${R_(m)}-${rl(_)}-${rl(v)}T${wv(c,C,R,1e6*z+1e3*B+V,l)}${w_(n,d)}`}function Iw(i,n="auto"){const{year:l,month:d,day:m}=te(i,_n);let _=`${rl(d)}-${rl(m)}`;const v=te(i,At);n!=="always"&&n!=="critical"&&v==="iso8601"||(_=`${R_(l)}-${_}`);const c=w_(v,n);return c&&(_+=c),_}function Pw(i,n="auto"){const{year:l,month:d,day:m}=te(i,_n);let _=`${R_(l)}-${rl(d)}`;const v=te(i,At);n!=="always"&&n!=="critical"&&v==="iso8601"||(_+=`-${rl(m)}`);const c=w_(v,n);return c&&(_+=c),_}function Nw(i,n,l="auto",d="auto",m="auto",_=void 0){let v=te(i,yn);if(_){const{unit:z,increment:B,roundingMode:V}=_;v=Jb(v,B,z,V)}const c=te(i,fi),C=Yh(c,v);let R=s_(Ol(c,v),"iso8601",n,"never");return m!=="never"&&(R+=BS(C)),d!=="never"&&(R+=`[${d==="critical"?"!":""}${c}]`),R+=w_(te(i,At),l),R}function zw(i){return ES.test(i)}function Tg(i){const n=WI.exec(i);if(!n)throw new RangeError(`invalid time zone offset: ${i}; must match ±HH:MM[:SS.SSSSSSSSS]`);return(n[1]==="-"?-1:1)*(1e9*(60*(60*+n[2]+ +(n[3]||0))+ +(n[4]||0))+ +((n[5]||0)+"000000000").slice(0,9))}let Ay;const HI=Object.assign(Object.create(null),{"/":!0,"-":!0,_:!0});function W0(i){if(Ay===void 0){const _=Intl.supportedValuesOf?.("timeZone");if(_){Ay=new Map;for(let v=0;v<_.length;v++){const c=_[v];Ay.set(l_(c),c)}}else Ay=null}const n=l_(i);let l=Ay?.get(n);if(l)return{identifier:l,primaryIdentifier:l};try{l=wS(i).resolvedOptions().timeZone}catch{return}if(n==="antarctica/south_pole"&&(l="Antarctica/McMurdo"),GI.has(i))throw new RangeError(`${i} is a legacy time zone identifier from ICU. Use ${l} instead`);const d=[...n].map((_,v)=>v===0||HI[n[v-1]]?_.toUpperCase():_).join("").split("/");if(d.length===1)return n==="gb-eire"?{identifier:"GB-Eire",primaryIdentifier:l}:{identifier:n.length<=3||/[-0-9]/.test(n)?n.toUpperCase():d[0],primaryIdentifier:l};if(d[0]==="Etc")return{identifier:`Etc/${["Zulu","Greenwich","Universal"].includes(d[1])?d[1]:d[1].toUpperCase()}`,primaryIdentifier:l};if(d[0]==="Us")return{identifier:`US/${d[1]}`,primaryIdentifier:l};const m=new Map([["Act","ACT"],["Lhi","LHI"],["Nsw","NSW"],["Dar_Es_Salaam","Dar_es_Salaam"],["Port_Of_Spain","Port_of_Spain"],["Port-Au-Prince","Port-au-Prince"],["Isle_Of_Man","Isle_of_Man"],["Comodrivadavia","ComodRivadavia"],["Knox_In","Knox_IN"],["Dumontdurville","DumontDUrville"],["Mcmurdo","McMurdo"],["Denoronha","DeNoronha"],["Easterisland","EasterIsland"],["Bajanorte","BajaNorte"],["Bajasur","BajaSur"]]);return d[1]=m.get(d[1])??d[1],d.length>2&&(d[2]=m.get(d[2])??d[2]),{identifier:d.join("/"),primaryIdentifier:l}}function dp(i,n){const{year:l,month:d,day:m,hour:_,minute:v,second:c}=US(i,n);let C=n%1e3;return C<0&&(C+=1e3),1e6*(Lx({isoDate:{year:l,month:d,day:m},time:{hour:_,minute:v,second:c,millisecond:C}})-n)}function Xb(i,n){return dp(i,jl(n,"floor"))}function zx(i){const n=i<0?"-":"+",l=Math.abs(i);return`${n}${wv(Math.floor(l/60),l%60,0,0,"minute")}`}function BS(i){return zx(af(i,jI,"halfExpand")/6e10)}function Lx({isoDate:{year:i,month:n,day:l},time:{hour:d,minute:m,second:_,millisecond:v}}){const c=i%400,C=(i-c)/400,R=new Date;return R.setUTCHours(d,m,_,v),R.setUTCFullYear(c,n-1,l),R.getTime()+UI*C}function Wa(i){const n=Lx(i),l=1e3*i.time.microsecond+i.time.nanosecond;return W.add(Pu(n),W.BigInt(l))}function FS(i){let n=jl(i,"trunc"),l=W.toNumber(W.remainder(i,b_));l<0&&(l+=1e6,n-=1);const d=Math.floor(l/1e3)%1e3,m=l%1e3,_=new Date(n);return{epochMilliseconds:n,isoDate:{year:_.getUTCFullYear(),month:_.getUTCMonth()+1,day:_.getUTCDate()},time:{hour:_.getUTCHours(),minute:_.getUTCMinutes(),second:_.getUTCSeconds(),millisecond:_.getUTCMilliseconds(),microsecond:d,nanosecond:m}}}function Ox(i,n){if(i==="UTC")return null;const l=jl(n,"floor");if(l<Yy)return Ox(i,Pu(Yy));const d=Date.now(),m=Math.max(l,d)+366*hf*3;let _=l,v=dp(i,_),c=_,C=v;for(;v===C&&_<m;){if(c=_+2*hf*7,c>xS)return null;C=dp(i,c),v===C&&(_=c)}return v===C?null:Pu(QS(R=>dp(i,R),_,c,v,C))}function Wb(i,n){if(i==="UTC")return null;const l=jl(n,"ceil"),d=Date.now(),m=d+366*hf*3;if(l>m){const R=Wb(i,Pu(m));if(R===null||W.lessThan(R,Pu(d)))return R}if(i==="Africa/Casablanca"||i==="Africa/El_Aaiun"){const R=Date.UTC(2088,0,1);if(R<l)return Wb(i,Pu(R))}let _=l-1;if(_<Yy)return null;let v=dp(i,_),c=_,C=v;for(;v===C&&_>Yy;){if(c=_-2*hf*7,c<Yy)return null;C=dp(i,c),v===C&&(_=c)}return v===C?null:Pu(QS(R=>dp(i,R),c,_,C,v))}function US(i,n){return function(l){const d=l.split(/[^\w]+/);if(d.length!==7)throw new RangeError(`expected 7 parts in "${l}`);const m=+d[0],_=+d[1];let v=+d[2];const c=d[3];if(c[0]==="b"||c[0]==="B")v=1-v;else if(c[0]!=="a"&&c[0]!=="A")throw new RangeError(`Unknown era ${c} in "${l}`);const C=d[4]==="24"?0:+d[4],R=+d[5],z=+d[6];if(!(Number.isFinite(v)&&Number.isFinite(m)&&Number.isFinite(_)&&Number.isFinite(C)&&Number.isFinite(R)&&Number.isFinite(z)))throw new RangeError(`Invalid number in "${l}`);return{year:v,month:m,day:_,hour:C,minute:R,second:z}}(wS(i).format(n))}function Q0(i){return i!==void 0&&!(i%4!=0||i%100==0&&i%400!=0)}function fp(i,n){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[Q0(i)?"leapyear":"standard"][n-1]}function K0(i){const n=[te(i,Vs),te(i,Gs),te(i,To),te(i,Zs),te(i,$s),te(i,Ys),te(i,qs),te(i,Hs),te(i,Xs),te(i,So)];for(let l=0;l<n.length;l++){const d=n[l];if(d!==0)return d<0?-1:1}return 0}function Tv(i){const n=["years","months","weeks","days"];for(let l=0;l<n.length;l++){const d=i[n[l]];if(d!==0)return d<0?-1:1}return 0}function VS(i){const n=Tv(i.date);return n!==0?n:i.time.sign()}function up(i,n){let l=i,d=n;if(!Number.isFinite(l)||!Number.isFinite(d))throw new RangeError("infinity is out of range");return d-=1,l+=Math.floor(d/12),d%=12,d<0&&(d+=12),d+=1,{year:l,month:d}}function Do(i,n,l){let d=i,m=n,_=l;if(!Number.isFinite(_))throw new RangeError("infinity is out of range");({year:d,month:m}=up(d,m));const v=146097;if(Math.abs(_)>v){const R=Math.trunc(_/v);d+=400*R,_-=R*v}let c=0,C=m>2?d:d-1;for(;c=Q0(C)?366:365,_<-c;)d-=1,C-=1,_+=c;for(C+=1;c=Q0(C)?366:365,_>c;)d+=1,C+=1,_-=c;for(;_<1;)({year:d,month:m}=up(d,m-1)),_+=fp(d,m);for(;_>fp(d,m);)_-=fp(d,m),{year:d,month:m}=up(d,m+1);return{year:d,month:m,day:_}}function o_(i,n,l,d,m,_,v,c,C){const R=nf(d,m,_,v,c,C);return ri(Do(i,n,l+R.deltaDays),R)}function nf(i,n,l,d,m,_){let v,c=i,C=n,R=l,z=d,B=m,V=_;({div:v,mod:V}=Xm(V,3)),B+=v,V<0&&(B-=1,V+=1e3),{div:v,mod:B}=Xm(B,3),z+=v,B<0&&(z-=1,B+=1e3),R+=Math.trunc(z/1e3),z%=1e3,z<0&&(R-=1,z+=1e3),C+=Math.trunc(R/60),R%=60,R<0&&(C-=1,R+=60),c+=Math.trunc(C/60),C%=60,C<0&&(c-=1,C+=60);let G=Math.trunc(c/24);return c%=24,c<0&&(G-=1,c+=24),G+=0,c+=0,C+=0,R+=0,z+=0,B+=0,V+=0,{deltaDays:G,hour:c,minute:C,second:R,millisecond:z,microsecond:B,nanosecond:V}}function Lw(i,n){const l=bs(i,0);if(Tv(l)===0)return i.days;const d=te(n,_n),m=il(te(n,At),d,l,"constrain"),_=xp(d.year,d.month-1,d.day),v=xp(m.year,m.month-1,m.day)-_;return i.days+v}function ko(i){return new(Qa("%Temporal.Duration%"))(-te(i,Vs),-te(i,Gs),-te(i,To),-te(i,Zs),-te(i,$s),-te(i,Ys),-te(i,qs),-te(i,Hs),-te(i,Xs),-te(i,So))}function Ws(i,n,l){return Math.min(l,Math.max(n,i))}function GS(i,n,l){const d=Ws(n,1,12);return{year:i,month:d,day:Ws(l,1,fp(i,d))}}function Da(i,n,l){if(i<n||i>l)throw new RangeError(`value out of range: ${n} <= ${i} <= ${l}`)}function vp(i,n,l){Da(n,1,12),Da(l,1,fp(i,n))}function Dp(i){bp(ri(i,{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}))}function Sv(i,n,l,d,m,_){Da(i,0,23),Da(n,0,59),Da(l,0,59),Da(d,0,999),Da(m,0,999),Da(_,0,999)}function jx(i,n,l,d,m,_,v,c,C){vp(i,n,l),Sv(d,m,_,v,c,C)}function bp(i){const n=Wa(i);(W.lessThan(n,BI)||W.greaterThan(n,FI))&&ju(n)}function Qb(i){Wa(i)}function ju(i){if(W.lessThan(i,n_)||W.greaterThan(i,lg))throw new RangeError("date/time value is outside of supported range")}function Bx({year:i,month:n}){Da(i,ww,Tw),i===ww?Da(n,4,12):i===Tw&&Da(n,1,9)}function Ev(i,n,l,d,m,_,v,c,C,R){let z=0;const B=[i,n,l,d,m,_,v,c,C,R];for(let Ie=0;Ie<B.length;Ie++){const Ge=B[Ie];if(Ge===1/0||Ge===-1/0)throw new RangeError("infinite values not allowed as duration fields");if(Ge!==0){const je=Ge<0?-1:1;if(z!==0&&je!==z)throw new RangeError("mixed-sign values not allowed as duration fields");z=je}}if(Math.abs(i)>=2**32||Math.abs(n)>=2**32||Math.abs(l)>=2**32)throw new RangeError("years, months, and weeks must be < 2³²");const V=Xm(c,3),G=Xm(C,6),re=Xm(R,9),fe=Xm(1e6*V.mod+1e3*G.mod+re.mod,9).div,pe=86400*d+3600*m+60*_+v+V.div+G.div+re.div+fe;if(!Number.isSafeInteger(pe))throw new RangeError("total of duration time units cannot exceed 9007199254740991.999999999 s")}function Hm(i){return{date:{years:te(i,Vs),months:te(i,Gs),weeks:te(i,To),days:te(i,Zs)},time:Bn.fromComponents(te(i,$s),te(i,Ys),te(i,qs),te(i,Hs),te(i,Xs),te(i,So))}}function Iu(i){const n=Bn.fromComponents(te(i,$s),te(i,Ys),te(i,qs),te(i,Hs),te(i,Xs),te(i,So)).add24HourDays(te(i,Zs));return{date:{years:te(i,Vs),months:te(i,Gs),weeks:te(i,To),days:0},time:n}}function ZS(i){const n=Iu(i),l=Math.trunc(n.time.sec/86400);return Ev(n.date.years,n.date.months,n.date.weeks,l,0,0,0,0,0,0),{...n.date,days:l}}function Il(i,n){const l=i.time.sign();let d=i.time.abs().subsec,m=0,_=0,v=i.time.abs().sec,c=0,C=0,R=0;switch(n){case"year":case"month":case"week":case"day":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,C=Math.trunc(c/60),c%=60,R=Math.trunc(C/24),C%=24;break;case"hour":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,C=Math.trunc(c/60),c%=60;break;case"minute":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60;break;case"second":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3;break;case"millisecond":m=Math.trunc(d/1e3),d%=1e3,_=fb(v,3,Math.trunc(m/1e3)),m%=1e3,v=0;break;case"microsecond":m=fb(v,6,Math.trunc(d/1e3)),d%=1e3,v=0;break;case"nanosecond":d=fb(v,9,d),v=0}return new(Qa("%Temporal.Duration%"))(i.date.years,i.date.months,i.date.weeks,i.date.days+l*R,l*C,l*c,l*v,l*_,l*m,l*d)}function Kh(i,n){return Tv(i),n.sign(),{date:i,time:n}}function xp(i,n,l){return Lx({isoDate:{year:i,month:n+1,day:l},time:{hour:0,minute:0,second:0,millisecond:0}})/hf}function eg({year:i,month:n,day:l}){if(Math.abs(xp(i,n-1,l))>1e8)throw new RangeError("date/time value is outside the supported range")}function Fx(i,n){const l=n.hour-i.hour,d=n.minute-i.minute,m=n.second-i.second,_=n.millisecond-i.millisecond,v=n.microsecond-i.microsecond,c=n.nanosecond-i.nanosecond;return Bn.fromComponents(l,d,m,_,v,c)}function Ux(i,n,l,d,m){let _=Bn.fromEpochNsDiff(n,i);return _=J0(_,l,d,m),Kh({years:0,months:0,weeks:0,days:0},_)}function $S(i,n,l,d){Qb(i),Qb(n);let m=Fx(i.time,n.time);const _=m.sign(),v=Bu(i.isoDate,n.isoDate);let c=n.isoDate;v===_&&(c=Do(c.year,c.month,c.day+_),m=m.add24HourDays(-_));const C=Qh("day",d),R=C_(l,i.isoDate,c,C);return d!==C&&(m=m.add24HourDays(R.days),R.days=0),Kh(R,m)}function YS(i,n,l,d,m){const _=W.subtract(n,i);if(W.equal(_,tl))return{date:{years:0,months:0,weeks:0,days:0},time:Bn.ZERO};const v=W.lessThan(_,tl)?-1:1,c=Ol(l,i),C=Ol(l,n);let R,z=0,B=v===1?2:1,V=Fx(c.time,C.time);for(V.sign()===-v&&z++;z<=B;z++){R=ri(Do(C.isoDate.year,C.isoDate.month,C.isoDate.day-z*v),c.time);const re=xs(l,R,"compatible");if(V=Bn.fromEpochNsDiff(n,re),V.sign()!==-v)break}const G=Qh("day",m);return Kh(C_(d,c.isoDate,R.isoDate,G),V)}function qS(i,n,l,d,m,_,v,c,C){let R,z,B,V,G=n;switch(c){case"year":{const Rt=af(G.date.years,v,"trunc");R=Rt,z=Rt+v*i,B={years:R,months:0,weeks:0,days:0},V={...B,years:z};break}case"month":{const Rt=af(G.date.months,v,"trunc");R=Rt,z=Rt+v*i,B=bs(G.date,0,0,R),V=bs(G.date,0,0,z);break}case"week":{const Rt=bs(G.date,0,0),Ut=il(_,d.isoDate,Rt,"constrain"),un=C_(_,Ut,Do(Ut.year,Ut.month,Ut.day+G.date.days),"week"),Ht=af(G.date.weeks+un.weeks,v,"trunc");R=Ht,z=Ht+v*i,B=bs(G.date,0,R),V=bs(G.date,0,z);break}case"day":{const Rt=af(G.date.days,v,"trunc");R=Rt,z=Rt+v*i,B=bs(G.date,R),V=bs(G.date,z);break}}const re=il(_,d.isoDate,B,"constrain"),fe=il(_,d.isoDate,V,"constrain");let pe,Ie;const Ge=ri(re,d.time),je=ri(fe,d.time);m?(pe=xs(m,Ge,"compatible"),Ie=xs(m,je,"compatible")):(pe=Wa(Ge),Ie=Wa(je));const He=Bn.fromEpochNsDiff(l,pe),Ve=Bn.fromEpochNsDiff(Ie,pe),rt=gv(C,i<0?"negative":"positive"),Je=He.add(He).abs().subtract(Ve.abs()).sign(),Mt=Math.abs(R)/v%2==0,Ne=He.isZero()?Math.abs(R):He.cmp(Ve)?yv(Math.abs(R),Math.abs(z),Je,Mt,rt):Math.abs(z),Xe=new Bn(W.add(W.multiply(Ve.totalNs,W.BigInt(R)),W.multiply(He.totalNs,W.BigInt(v*i)))).fdiv(Ve.totalNs),_t=Ne===Math.abs(z);return G={date:_t?V:B,time:Bn.ZERO},{nudgeResult:{duration:G,nudgedEpochNs:_t?Ie:pe,didExpandCalendarUnit:_t},total:Xe}}function Av(i,n,l,d,m,_,v,c,C){let R=i;const z=Mu(c)||d&&c==="day",B=VS(R)<0?-1:1;let V;return z?{nudgeResult:V}=qS(B,R,n,l,d,m,v,c,C):V=d?function(G,re,fe,pe,Ie,Ge,je,He){let Ve=re;const rt=il(Ie,fe.isoDate,Ve.date,"constrain"),Je=ri(rt,fe.time),Mt=ri(Do(rt.year,rt.month,rt.day+G),fe.time),Ne=xs(pe,Je,"compatible"),Xe=xs(pe,Mt,"compatible"),_t=Bn.fromEpochNsDiff(Xe,Ne);if(_t.sign()!==G)throw new RangeError("time zone returned inconsistent Instants");const Rt=W.BigInt(ug[je]*Ge);let Ut=Ve.time.round(Rt,He);const un=Ut.subtract(_t),Ht=un.sign()!==-G;let Ue,ft;return Ht?(Ue=G,Ut=un.round(Rt,He),ft=Ut.addToEpochNs(Xe)):(Ue=0,ft=Ut.addToEpochNs(Ne)),{duration:Kh(bs(Ve.date,Ve.date.days+Ue),Ut),nudgedEpochNs:ft,didExpandCalendarUnit:Ht}}(B,R,l,d,m,v,c,C):function(G,re,fe,pe,Ie,Ge){let je=G;const He=je.time.add24HourDays(je.date.days),Ve=He.round(W.BigInt(pe*ug[Ie]),Ge),rt=Ve.subtract(He),{quotient:Je}=He.divmod(Y0),{quotient:Mt}=Ve.divmod(Y0),Ne=Math.sign(Mt-Je)===He.sign(),Xe=rt.addToEpochNs(re);let _t=0,Rt=Ve;return Vh(fe)==="date"&&(_t=Mt,Rt=Ve.add(Bn.fromComponents(24*-Mt,0,0,0,0,0))),{duration:{date:bs(je.date,_t),time:Rt},nudgedEpochNs:Xe,didExpandCalendarUnit:Ne}}(R,n,_,v,c,C),R=V.duration,V.didExpandCalendarUnit&&c!=="week"&&(R=function(G,re,fe,pe,Ie,Ge,je,He){let Ve=re;if(He===je)return Ve;const rt=qy.indexOf(je);for(let Je=qy.indexOf(He)-1;Je>=rt;Je--){const Mt=qy[Je];if(Mt==="week"&&je!=="week")continue;let Ne;switch(Mt){case"year":Ne={years:Ve.date.years+G,months:0,weeks:0,days:0};break;case"month":{const Rt=Ve.date.months+G;Ne=bs(Ve.date,0,0,Rt);break}case"week":{const Rt=Ve.date.weeks+G;Ne=bs(Ve.date,0,Rt);break}}const Xe=ri(il(Ge,pe.isoDate,Ne,"constrain"),pe.time);let _t;if(_t=Ie?xs(Ie,Xe,"compatible"):Wa(Xe),Z0(fe,_t)===-G)break;Ve={date:Ne,time:Bn.ZERO}}return Ve}(B,R,V.nudgedEpochNs,l,d,m,_,Qh(c,"day"))),R}function Ow(i,n,l,d,m,_){return Mu(_)||d&&_==="day"?qS(VS(i)<0?-1:1,i,n,l,d,m,1,_,"trunc").total:Wy(i.time.add24HourDays(i.date.days),_)}function HS(i,n,l,d,m,_,v){if(dg(i,n)==0)return{date:{years:0,months:0,weeks:0,days:0},time:Bn.ZERO};bp(i),bp(n);const c=$S(i,n,l,d);return _==="nanosecond"&&m===1?c:Av(c,Wa(n),i,null,l,d,m,_,v)}function XS(i,n,l,d,m,_,v,c){if(Vh(m)==="time")return Ux(i,n,_,v,c);const C=YS(i,n,l,d,m);return v==="nanosecond"&&_===1?C:Av(C,n,Ol(l,i),l,d,m,_,v,c)}function Sg(i,n,l,d,m,_){const v=cg.reduce((G,re)=>{const fe=re[0],pe=re[1],Ie=re[2];return l!=="datetime"&&Ie!==l||d.includes(pe)||G.push(pe,fe),G},[]);let c=Ao(n,"largestUnit",l,"auto");if(d.includes(c))throw new RangeError(`largestUnit must be one of ${v.join(", ")}, not ${c}`);const C=xg(n);let R=Pc(n,"trunc");i==="since"&&(R=function(G){switch(G){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return G}}(R));const z=Ao(n,"smallestUnit",l,m);if(d.includes(z))throw new RangeError(`smallestUnit must be one of ${v.join(", ")}, not ${z}`);const B=Qh(_,z);if(c==="auto"&&(c=B),Qh(c,z)!==c)throw new RangeError(`largestUnit ${c} cannot be smaller than smallestUnit ${z}`);const V={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[z];return V!==void 0&&wg(C,V,!1),{largestUnit:c,roundingIncrement:C,roundingMode:R,smallestUnit:z}}function jw(i,n,l,d){const m=Oy(l),_=Sg(i,Jt(d),"time",[],"nanosecond","second");let v=Il(Ux(te(n,yn),te(m,yn),_.roundingIncrement,_.smallestUnit,_.roundingMode),_.largestUnit);return i==="since"&&(v=ko(v)),v}function Bw(i,n,l,d){const m=zy(l),_=te(n,At),v=te(m,At);if(!Ou(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Sg(i,Jt(d),"date",[],"day","day"),C=Qa("%Temporal.Duration%"),R=te(n,_n),z=te(m,_n);if(Bu(R,z)===0)return new C;let B={date:C_(_,R,z,c.largestUnit),time:Bn.ZERO};if(c.smallestUnit!=="day"||c.roundingIncrement!==1){const G=ri(R,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});B=Av(B,Wa(ri(z,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),G,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let V=Il(B,"day");return i==="since"&&(V=ko(V)),V}function Fw(i,n,l,d){const m=Ly(l),_=te(n,At),v=te(m,At);if(!Ou(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Sg(i,Jt(d),"datetime",[],"nanosecond","day"),C=Qa("%Temporal.Duration%"),R=te(n,ir),z=te(m,ir);if(dg(R,z)===0)return new C;let B=Il(HS(R,z,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);return i==="since"&&(B=ko(B)),B}function Uw(i,n,l,d){const m=rf(l),_=Sg(i,Jt(d),"time",[],"nanosecond","hour");let v=Fx(te(n,xr),te(m,xr));v=J0(v,_.roundingIncrement,_.smallestUnit,_.roundingMode);let c=Il(Kh({years:0,months:0,weeks:0,days:0},v),_.largestUnit);return i==="since"&&(c=ko(c)),c}function Vw(i,n,l,d){const m=jy(l),_=te(n,At),v=te(m,At);if(!Ou(_,v))throw new RangeError(`cannot compute difference between months of ${_} and ${v} calendars`);const c=Sg(i,Jt(d),"date",["week","day"],"month","year"),C=Qa("%Temporal.Duration%");if(Bu(te(n,_n),te(m,_n))==0)return new C;const R=Js(_,te(n,_n),"year-month");R.day=1;const z=df(_,R,"constrain"),B=Js(_,te(m,_n),"year-month");B.day=1;const V=df(_,B,"constrain");let G={date:bs(C_(_,z,V,c.largestUnit),0,0),time:Bn.ZERO};if(c.smallestUnit!=="month"||c.roundingIncrement!==1){const fe=ri(z,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});G=Av(G,Wa(ri(V,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),fe,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let re=Il(G,"day");return i==="since"&&(re=ko(re)),re}function Gw(i,n,l,d){const m=By(l),_=te(n,At),v=te(m,At);if(!Ou(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Sg(i,Jt(d),"datetime",[],"nanosecond","hour"),C=te(n,yn),R=te(m,yn),z=Qa("%Temporal.Duration%");let B;if(Vh(c.largestUnit)!=="date")B=Il(Ux(C,R,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);else{const V=te(n,fi);if(!LS(V,te(m,fi)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");if(W.equal(C,R))return new z;B=Il(XS(C,R,V,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),"hour")}return i==="since"&&(B=ko(B)),B}function hg({hour:i,minute:n,second:l,millisecond:d,microsecond:m,nanosecond:_},v){let c=l,C=_;return c+=v.sec,C+=v.subsec,nf(i,n,c,d,m,C)}function Kb(i,n){const l=n.addToEpochNs(i);return ju(l),l}function Fy(i,n,l,d,m="constrain"){if(Tv(d.date)===0)return Kb(i,d.time);const _=Ol(n,i);return Kb(xs(n,ri(il(l,_.isoDate,d.date,m),_.time),"compatible"),d.time)}function Zw(i,n,l){let d=Nl(l);i==="subtract"&&(d=ko(d));const m=Qh(Uh(n),Uh(d));if(Mu(m))throw new RangeError("For years, months, or weeks arithmetic, use date arithmetic relative to a starting point");const _=Iu(n),v=Iu(d);return Il(Kh({years:0,months:0,weeks:0,days:0},_.time.add(v.time)),m)}function $w(i,n,l){let d=Nl(l);i==="subtract"&&(d=ko(d));const m=Uh(d);if(Vh(m)==="date")throw new RangeError(`Duration field ${m} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);const _=Iu(d);return Ru(Kb(te(n,yn),_.time))}function Yw(i,n,l,d){const m=te(n,At);let _=Nl(l);i==="subtract"&&(_=ko(_));const v=ZS(_),c=ti(Jt(d));return Qs(il(m,te(n,_n),v,c),m)}function qw(i,n,l,d){let m=Nl(l);i==="subtract"&&(m=ko(m));const _=ti(Jt(d)),v=te(n,At),c=Iu(m),C=te(n,ir),R=hg(C.time,c.time),z=bs(c.date,R.deltaDays);return Ev(z.years,z.months,z.weeks,z.days,0,0,0,0,0,0),Rl(ri(il(v,C.isoDate,z,_),R),v)}function Hw(i,n,l){let d=Nl(l);i==="subtract"&&(d=ko(d));const m=Iu(d),{hour:_,minute:v,second:c,millisecond:C,microsecond:R,nanosecond:z}=hg(te(n,xr),m.time);return $h(xv(_,v,c,C,R,z,"reject"))}function Xw(i,n,l,d){let m=Nl(l);i==="subtract"&&(m=ko(m));const _=ti(Jt(d)),v=K0(m),c=te(n,At),C=Js(c,te(n,_n),"year-month");C.day=1;let R=df(c,C,"constrain");if(v<0){const B=il(c,R,{months:1},"constrain");R=Do(B.year,B.month,B.day-1)}const z=ZS(m);return Dp(R),Jm(r_(c,Js(c,il(c,R,z,_),"year-month"),_),c)}function Ww(i,n,l,d){let m=Nl(l);i==="subtract"&&(m=ko(m));const _=ti(Jt(d)),v=te(n,fi),c=te(n,At),C=Hm(m);return vs(Fy(te(n,yn),v,c,C,_),v,c)}function af(i,n,l){const d=Math.trunc(i/n),m=i%n,_=i<0?"negative":"positive",v=Math.abs(d),c=v+1,C=Eo(Math.abs(2*m)-n),R=v%2==0,z=gv(l,_),B=m===0?v:yv(v,c,C,R,z);return n*(_==="positive"?B:-B)}function Jb(i,n,l,d){const m=ug[l]*n;return function(_,v,c){const C=Bh(_),R=Bh(v),z=W.divide(C,R),B=W.remainder(C,R),V=gv(c,"positive");let G,re;W.lessThan(C,tl)?(G=W.subtract(z,t_),re=z):(G=z,re=W.add(z,t_));const fe=Z0(sp(W.multiply(B,Ix)),R)*(W.lessThan(C,tl)?-1:1)+0,pe=W.equal(B,tl)?z:yv(G,re,fe,aS(G),V);return W.multiply(pe,R)}(i,W.BigInt(m),d)}function ex(i,n,l,d){Qb(i);const{year:m,month:_,day:v}=i.isoDate,c=tx(i.time,n,l,d);return ri(Do(m,_,v+c.deltaDays),c)}function tx({hour:i,minute:n,second:l,millisecond:d,microsecond:m,nanosecond:_},v,c,C){let R;switch(c){case"day":case"hour":R=1e3*(1e3*(1e3*(60*(60*i+n)+l)+d)+m)+_;break;case"minute":R=1e3*(1e3*(1e3*(60*n+l)+d)+m)+_;break;case"second":R=1e3*(1e3*(1e3*l+d)+m)+_;break;case"millisecond":R=1e3*(1e3*d+m)+_;break;case"microsecond":R=1e3*m+_;break;case"nanosecond":R=_}const z=ug[c],B=af(R,z*v,C)/z;switch(c){case"day":return{deltaDays:B,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return nf(B,0,0,0,0,0);case"minute":return nf(i,B,0,0,0,0);case"second":return nf(i,n,B,0,0,0);case"millisecond":return nf(i,n,l,B,0,0);case"microsecond":return nf(i,n,l,d,B,0);case"nanosecond":return nf(i,n,l,d,m,B);default:throw new Error(`Invalid unit ${c}`)}}function J0(i,n,l,d){const m=ug[l];return i.round(W.BigInt(m*n),d)}function Wy(i,n){const l=ug[n];return i.fdiv(W.BigInt(l))}function Bu(i,n){return i.year!==n.year?Eo(i.year-n.year):i.month!==n.month?Eo(i.month-n.month):i.day!==n.day?Eo(i.day-n.day):0}function nx(i,n){return i.hour!==n.hour?Eo(i.hour-n.hour):i.minute!==n.minute?Eo(i.minute-n.minute):i.second!==n.second?Eo(i.second-n.second):i.millisecond!==n.millisecond?Eo(i.millisecond-n.millisecond):i.microsecond!==n.microsecond?Eo(i.microsecond-n.microsecond):i.nanosecond!==n.nanosecond?Eo(i.nanosecond-n.nanosecond):0}function dg(i,n){const l=Bu(i.isoDate,n.isoDate);return l!==0?l:nx(i.time,n.time)}function WS(i){const n=ev(i);return globalThis.BigInt!==void 0?globalThis.BigInt(n.toString(10)):n}function jl(i,n){const l=Bh(i),{quotient:d,remainder:m}=Py(l,b_);let _=W.toNumber(d);return n==="floor"&&W.toNumber(m)<0&&(_-=1),n==="ceil"&&W.toNumber(m)>0&&(_+=1),_}function Pu(i){if(!Number.isInteger(i))throw new RangeError("epoch milliseconds must be an integer");return W.multiply(W.BigInt(i),b_)}function ev(i){let n=i;if(typeof i=="object"){const l=i[Symbol.toPrimitive];l&&typeof l=="function"&&(n=l.call(i,"number"))}if(typeof n=="number")throw new TypeError("cannot convert number to bigint");return typeof n=="bigint"?W.BigInt(n.toString(10)):W.BigInt(n)}const ix=(()=>{let i=W.BigInt(Date.now()%1e6);return()=>{const n=Date.now(),l=W.BigInt(n),d=W.add(Pu(n),i);return i=W.remainder(l,b_),W.greaterThan(d,lg)?lg:W.lessThan(d,n_)?n_:d}})();function My(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function Eo(i){return i<0?-1:i>0?1:i}function Jt(i){if(i===void 0)return Object.create(null);if(wr(i)&&i!==null)return i;throw new TypeError("Options parameter must be an object, not "+(i===null?"null":typeof i))}function wp(i,n){const l=Object.create(null);return l[i]=n,l}function Jh(i,n,l,d){let m=i[n];if(m!==void 0){if(m=vv(m),!l.includes(m))throw new RangeError(`${n} must be one of ${l.join(", ")}, not ${m}`);return m}if(d===rd)throw new RangeError(`${n} option is required`);return d}function no(i){const n=l_(i);if(!VI.includes(l_(n)))throw new RangeError(`invalid calendar identifier ${n}`);switch(n){case"ethiopic-amete-alem":return"ethioaa";case"islamicc":return"islamic-civil"}return n}function l_(i){let n="";for(let l=0;l<i.length;l++){const d=i.charCodeAt(l);n+=d>=65&&d<=90?String.fromCharCode(d+32):String.fromCharCode(d)}return n}function yf(i){throw new TypeError(`Do not use built-in arithmetic operators with Temporal objects. When comparing, use ${i==="PlainMonthDay"?"Temporal.PlainDate.compare(obj1.toPlainDate(year), obj2.toPlainDate(year))":`Temporal.${i}.compare(obj1, obj2)`}, not obj1 > obj2. When coercing to strings, use \`\${obj}\` or String(obj), not '' + obj. When coercing to numbers, use properties or methods of the object, not \`+obj\`. When concatenating with strings, use \`\${str}\${obj}\` or str.concat(obj), not str + obj. In React, coerce to a string before rendering a Temporal object.`)}const XI=new RegExp(`^${vS.source}$`),WI=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/.source}$`);function QS(i,n,l,d=i(n),m=i(l)){let _=n,v=l,c=d,C=m;for(;v-_>1;){let R=Math.trunc((_+v)/2);const z=i(R);z===c?(_=R,c=z):z===C&&(v=R,C=z)}return v}function KS(i){return[...i]}function JS(i,n){if(i!=="gregory"&&i!=="iso8601")return;const l=I_[i];let d=n.year;const{dayOfWeek:m,dayOfYear:_,daysInYear:v}=l.isoToDate(n,{dayOfWeek:!0,dayOfYear:!0,daysInYear:!0}),c=l.getFirstDayOfWeek(),C=l.getMinimalDaysInFirstWeek();let R=(m+7-c)%7,z=(m-_+7001-c)%7,B=Math.floor((_-1+z)/7);if(7-z>=C&&++B,B==0)B=function(V,G,re,fe){let pe=(fe-V-re+1)%7;pe<0&&(pe+=7);let Ie=Math.floor((re+pe-1)/7);return 7-pe>=G&&++Ie,Ie}(c,C,_+l.isoToDate(l.dateAdd(n,{years:-1},"constrain"),{daysInYear:!0}).daysInYear,m),d--;else if(_>=v-5){let V=(R+v-_)%7;V<0&&(V+=7),6-V>=C&&_+7-R>v&&(B=1,d++)}return{week:B,year:d}}function Qw(i,n,l,d,m){if(n!==m.year){if(i*(n-m.year)>0)return!0}else if(l!==m.month){if(i*(l-m.month)>0)return!0}else if(d!==m.day&&i*(d-m.day)>0)return!0;return!1}const I_={};function Tp(i){if(!i.startsWith("M"))throw new RangeError(`Invalid month code: ${i}.  Month codes must start with M.`);const n=+i.slice(1);if(Number.isNaN(n))throw new RangeError(`Invalid month code: ${i}`);return n}function Lu(i,n=!1){return`M${`${i}`.padStart(2,"0")}${n?"L":""}`}function Vx(i,n=void 0,l=12){let{month:d,monthCode:m}=i;if(m===void 0){if(d===void 0)throw new TypeError("Either month or monthCode are required");n==="reject"&&Da(d,1,l),n==="constrain"&&(d=Ws(d,1,l)),m=Lu(d)}else{const _=Tp(m);if(m!==Lu(_))throw new RangeError(`Invalid month code: ${m}`);if(d!==void 0&&d!==_)throw new RangeError(`monthCode ${m} and month ${d} must match if both are present`);if(d=_,d<1||d>l)throw new RangeError(`Invalid monthCode: ${m}`)}return{...i,month:d,monthCode:m}}I_.iso8601={resolveFields(i,n){if((n==="date"||n==="year-month")&&i.year===void 0)throw new TypeError("year is required");if((n==="date"||n==="month-day")&&i.day===void 0)throw new TypeError("day is required");Object.assign(i,Vx(i))},dateToISO:(i,n)=>Hy(i.year,i.month,i.day,n),monthDayToISOReferenceDate(i,n){const{month:l,day:d}=Hy(i.year??1972,i.month,i.day,n);return{month:l,day:d,year:1972}},extraFields:()=>[],fieldKeysToIgnore(i){const n=new Set;for(let l=0;l<i.length;l++){const d=i[l];n.add(d),d==="month"?n.add("monthCode"):d==="monthCode"&&n.add("month")}return KS(n)},dateAdd(i,{years:n=0,months:l=0,weeks:d=0,days:m=0},_){let{year:v,month:c,day:C}=i;return v+=n,c+=l,{year:v,month:c}=up(v,c),{year:v,month:c,day:C}=Hy(v,c,C,_),C+=m+7*d,Do(v,c,C)},dateUntil(i,n,l){const d=-Bu(i,n);if(d===0)return{years:0,months:0,weeks:0,days:0};let m,_=0,v=0;if(l==="year"||l==="month"){let z=n.year-i.year;for(z!==0&&(z-=d);!Qw(d,i.year+z,i.month,i.day,n);)_=z,z+=d;let B=d;for(m=up(i.year+_,i.month+B);!Qw(d,m.year,m.month,i.day,n);)v=B,B+=d,m=up(m.year,m.month+d);l==="month"&&(v+=12*_,_=0)}m=up(i.year+_,i.month+v);const c=GS(m.year,m.month,i.day);let C=0,R=xp(n.year,n.month-1,n.day)-xp(c.year,c.month-1,c.day);return l==="week"&&(C=Math.trunc(R/7),R%=7),{years:_,months:v,weeks:C,days:R}},isoToDate({year:i,month:n,day:l},d){const m={era:void 0,eraYear:void 0,year:i,month:n,day:l,daysInWeek:7,monthsInYear:12};if(d.monthCode&&(m.monthCode=Lu(n)),d.dayOfWeek){const _=n+(n<3?10:-2),v=i-(n<3?1:0),c=Math.floor(v/100),C=v-100*c,R=(l+Math.floor(2.6*_-.2)+(C+Math.floor(C/4))+(Math.floor(c/4)-2*c))%7;m.dayOfWeek=R+(R<=0?7:0)}if(d.dayOfYear){let _=l;for(let v=n-1;v>0;v--)_+=fp(i,v);m.dayOfYear=_}return d.weekOfYear&&(m.weekOfYear=JS("iso8601",{year:i,month:n,day:l})),d.daysInMonth&&(m.daysInMonth=fp(i,n)),(d.daysInYear||d.inLeapYear)&&(m.inLeapYear=Q0(i),m.daysInYear=m.inLeapYear?366:365),m},getFirstDayOfWeek:()=>1,getMinimalDaysInFirstWeek:()=>4};class Ma{constructor(n){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,n!==void 0){let l=0;for(const d of n.map.entries()){if(++l>Ma.MAX_CACHE_ENTRIES)break;this.map.set(...d)}}}get(n){const l=this.map.get(n);return l&&(this.hits++,this.report()),this.calls++,l}set(n,l){this.map.set(n,l),this.misses++,this.report()}report(){}setObject(n){if(Ma.objectMap.get(n))throw new RangeError("object already cached");Ma.objectMap.set(n,this),this.report()}static getCacheForObject(n){let l=Ma.objectMap.get(n);return l||(l=new Ma,Ma.objectMap.set(n,l)),l}}function eE({isoYear:i,isoMonth:n,isoDay:l}){return`${R_(i)}-${rl(n)}-${rl(l)}T00:00Z`}function gb(i,n){return{years:i.year-n.year,months:i.month-n.month,days:i.day-n.day}}Ma.objectMap=new WeakMap,Ma.MAX_CACHE_ENTRIES=1e3;class kp{constructor(){this.eras=[],this.hasEra=!1,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new Intl.DateTimeFormat(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:"short",timeZone:"UTC"})),this.formatter}getCalendarParts(n){let l=this.getFormatter(),d=new Date(n);if(n==="-271821-04-19T00:00Z"){const m=l.resolvedOptions();l=new Intl.DateTimeFormat(m.locale,{...m,timeZone:"Etc/GMT+1"}),d=new Date("-271821-04-20T00:00Z")}try{return l.formatToParts(d)}catch{throw new RangeError(`Invalid ISO date: ${n}`)}}isoToCalendarDate(n,l){const{year:d,month:m,day:_}=n,v=JSON.stringify({func:"isoToCalendarDate",isoYear:d,isoMonth:m,isoDay:_,id:this.id}),c=l.get(v);if(c)return c;const C=eE({isoYear:d,isoMonth:m,isoDay:_}),R=this.getCalendarParts(C),z={};for(let V=0;V<R.length;V++){const{type:G,value:re}=R[V];if(G!=="year"&&G!=="relatedYear"||(this.hasEra?z.eraYear=+re:z.year=+re),G==="month"){const fe=/^([0-9]*)(.*?)$/.exec(re);if(!fe||fe.length!=3||!fe[1]&&!fe[2])throw new RangeError(`Unexpected month: ${re}`);if(z.month=fe[1]?+fe[1]:1,z.month<1)throw new RangeError(`Invalid month ${re} from ${C}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(z.month>13)throw new RangeError(`Invalid month ${re} from ${C}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);fe[2]&&(z.monthExtra=fe[2])}G==="day"&&(z.day=+re),this.hasEra&&G==="era"&&re!=null&&re!==""&&(z.era=re.split(" (")[0].normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(/ /g,"-").toLowerCase())}if(this.hasEra&&z.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.hasEra){const V=this.eras.find(G=>z.era===G.genericName);V&&(z.era=V.code)}if(this.reviseIntlEra){const{era:V,eraYear:G}=this.reviseIntlEra(z,n);z.era=V,z.eraYear=G}this.checkIcuBugs&&this.checkIcuBugs(n);const B=this.adjustCalendarDate(z,l,"constrain",!0);if(B.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(n)}`);if(B.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(n)}`);if(B.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(n)}`);return l.set(v,B),["constrain","reject"].forEach(V=>{const G=JSON.stringify({func:"calendarToIsoDate",year:B.year,month:B.month,day:B.day,overflow:V,id:this.id});l.set(G,n)}),B}validateCalendarDate(n){const{month:l,year:d,day:m,eraYear:_,monthCode:v,monthExtra:c}=n;if(c!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(d===void 0&&_===void 0)throw new TypeError("year or eraYear is required");if(l===void 0&&v===void 0)throw new TypeError("month or monthCode is required");if(m===void 0)throw new RangeError("Missing day");if(v!==void 0){if(typeof v!="string")throw new RangeError("monthCode must be a string, not "+typeof v);if(!/^M([01]?\d)(L?)$/.test(v))throw new RangeError(`Invalid monthCode: ${v}`)}if(this.hasEra&&n.era===void 0!=(n.eraYear===void 0))throw new TypeError("properties era and eraYear must be provided together")}adjustCalendarDate(n,l=void 0,d="constrain",m=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let _=n;this.validateCalendarDate(_);const v=this.monthsInYear(_,l);let{month:c,monthCode:C}=_;return{month:c,monthCode:C}=Vx(_,d,v),{..._,month:c,monthCode:C}}regulateMonthDayNaive(n,l,d){const m=this.monthsInYear(n,d);let{month:_,day:v}=n;return l==="reject"?(Da(_,1,m),Da(v,1,this.maximumMonthLength(n))):(_=Ws(_,1,m),v=Ws(v,1,this.maximumMonthLength({...n,month:_}))),{...n,month:_,day:v}}calendarToIsoDate(n,l="constrain",d){const m=n;let _=this.adjustCalendarDate(n,d,l,!1);_=this.regulateMonthDayNaive(_,l,d);const{year:v,month:c,day:C}=_,R=JSON.stringify({func:"calendarToIsoDate",year:v,month:c,day:C,overflow:l,id:this.id});let z,B=d.get(R);if(B||m.year!==void 0&&m.month!==void 0&&m.day!==void 0&&(m.year!==_.year||m.month!==_.month||m.day!==_.day)&&(z=JSON.stringify({func:"calendarToIsoDate",year:m.year,month:m.month,day:m.day,overflow:l,id:this.id}),B=d.get(z),B))return B;let V=this.estimateIsoDate({year:v,month:c,day:C});const G=Ge=>{let je=this.addDaysIso(V,Ge);if(_.day>this.minimumMonthLength(_)){let He=this.isoToCalendarDate(je,d);for(;He.month!==c||He.year!==v;){if(l==="reject")throw new RangeError(`day ${C} does not exist in month ${c} of year ${v}`);je=this.addDaysIso(je,-1),He=this.isoToCalendarDate(je,d)}}return je};let re=0,fe=this.isoToCalendarDate(V,d),pe=gb(_,fe);if(pe.years!==0||pe.months!==0||pe.days!==0){const Ge=365*pe.years+30*pe.months+pe.days;V=this.addDaysIso(V,Ge),fe=this.isoToCalendarDate(V,d),pe=gb(_,fe),pe.years===0&&pe.months===0?V=G(pe.days):re=this.compareCalendarDates(_,fe)}let Ie=8;for(;re;){V=this.addDaysIso(V,re*Ie);const Ge=fe;fe=this.isoToCalendarDate(V,d);const je=re;if(re=this.compareCalendarDates(_,fe),re){if(pe=gb(_,fe),pe.years===0&&pe.months===0)V=G(pe.days),re=0;else if(je&&re!==je)if(Ie>1)Ie/=2;else{if(l==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...m})}`);this.compareCalendarDates(fe,Ge)>0&&(V=this.addDaysIso(V,-1)),re=0}}}if(d.set(R,V),z&&d.set(z,V),_.year===void 0||_.month===void 0||_.day===void 0||_.monthCode===void 0||this.hasEra&&(_.era===void 0||_.eraYear===void 0))throw new RangeError("Unexpected missing property");return V}compareCalendarDates(n,l){return n.year!==l.year?Eo(n.year-l.year):n.month!==l.month?Eo(n.month-l.month):n.day!==l.day?Eo(n.day-l.day):0}regulateDate(n,l="constrain",d){const m=this.calendarToIsoDate(n,l,d);return this.isoToCalendarDate(m,d)}addDaysIso(n,l){return Do(n.year,n.month,n.day+l)}addDaysCalendar(n,l,d){const m=this.calendarToIsoDate(n,"constrain",d),_=this.addDaysIso(m,l);return this.isoToCalendarDate(_,d)}addMonthsCalendar(n,l,d,m){let _=n;const{day:v}=_;for(let c=0,C=Math.abs(l);c<C;c++){const{month:R}=_,z=_,B=l<0?-Math.max(v,this.daysInPreviousMonth(_,m)):this.daysInMonth(_,m),V=this.calendarToIsoDate(_,"constrain",m);let G=this.addDaysIso(V,B);if(_=this.isoToCalendarDate(G,m),l>0){const re=this.monthsInYear(z,m);for(;_.month-1!=R%re;)G=this.addDaysIso(G,-1),_=this.isoToCalendarDate(G,m)}_.day!==v&&(_=this.regulateDate({..._,day:v},"constrain",m))}if(d==="reject"&&_.day!==v)throw new RangeError(`Day ${v} does not exist in resulting calendar month`);return _}addCalendar(n,{years:l=0,months:d=0,weeks:m=0,days:_=0},v,c){const{year:C,day:R,monthCode:z}=n,B=this.adjustCalendarDate({year:C+l,monthCode:z,day:R},c),V=this.addMonthsCalendar(B,d,v,c),G=_+7*m;return this.addDaysCalendar(V,G,c)}untilCalendar(n,l,d,m){let _=0,v=0,c=0,C=0;switch(d){case"day":_=this.calendarDaysUntil(n,l,m);break;case"week":{const R=this.calendarDaysUntil(n,l,m);_=R%7,v=(R-_)/7;break}case"month":case"year":{const R=this.compareCalendarDates(l,n);if(!R)return{years:0,months:0,weeks:0,days:0};const z=l.year-n.year,B=l.day-n.day;if(d==="year"&&z){let re=0;l.monthCode>n.monthCode&&(re=1),l.monthCode<n.monthCode&&(re=-1),re||(re=Math.sign(B)),C=re*R<0?z-R:z}let V,G=C?this.addCalendar(n,{years:C},"constrain",m):n;do c+=R,V=G,G=this.addMonthsCalendar(V,R,"constrain",m),G.day!==n.day&&(G=this.regulateDate({...G,day:n.day},"constrain",m));while(this.compareCalendarDates(l,G)*R>=0);c-=R,_=this.calendarDaysUntil(V,l,m);break}}return{years:C,months:c,weeks:v,days:_}}daysInMonth(n,l){const{day:d}=n,m=this.maximumMonthLength(n),_=this.minimumMonthLength(n);if(_===m)return _;const v=d<=m-_?m:_,c=this.calendarToIsoDate(n,"constrain",l),C=this.addDaysIso(c,v),R=this.isoToCalendarDate(C,l),z=this.addDaysIso(C,-R.day);return this.isoToCalendarDate(z,l).day}daysInPreviousMonth(n,l){const{day:d,month:m,year:_}=n;let v={year:m>1?_:_-1,month:m,day:1};const c=m>1?m-1:this.monthsInYear(v,l);v={...v,month:c};const C=this.minimumMonthLength(v),R=this.maximumMonthLength(v);if(C===R)return R;const z=this.calendarToIsoDate(n,"constrain",l),B=this.addDaysIso(z,-d);return this.isoToCalendarDate(B,l).day}startOfCalendarYear(n){return{year:n.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(n){return{year:n.year,month:n.month,day:1}}calendarDaysUntil(n,l,d){const m=this.calendarToIsoDate(n,"constrain",d),_=this.calendarToIsoDate(l,"constrain",d);return xp(_.year,_.month-1,_.day)-xp(m.year,m.month-1,m.day)}monthDaySearchStartYear(n,l){return 1972}monthDayFromFields(n,l,d){let m,_,v,c,C,{era:R,eraYear:z,year:B,month:V,monthCode:G,day:re}=n;if(V!==void 0&&B===void 0&&(!this.hasEra||R===void 0||z===void 0))throw new TypeError("when month is present, year (or era and eraYear) are required");(G===void 0||B!==void 0||this.hasEra&&z!==void 0)&&({monthCode:G,day:re}=this.isoToCalendarDate(this.calendarToIsoDate(n,l,d),d));const fe={year:this.monthDaySearchStartYear(G,re),month:12,day:31},pe=this.isoToCalendarDate(fe,d),Ie=pe.monthCode>G||pe.monthCode===G&&pe.day>=re?pe.year:pe.year-1;for(let Ge=0;Ge<20;Ge++){const je=this.adjustCalendarDate({day:re,monthCode:G,year:Ie-Ge},d),He=this.calendarToIsoDate(je,"constrain",d),Ve=this.isoToCalendarDate(He,d);if({year:m,month:_,day:v}=He,Ve.monthCode===G&&Ve.day===re)return{month:_,day:v,year:m};if(l==="constrain"){const rt=this.maxLengthOfMonthCodeInAnyYear(Ve.monthCode);if(Ve.monthCode===G&&Ve.day===rt&&re>rt)return{month:_,day:v,year:m};(c===void 0||Ve.monthCode===c.monthCode&&Ve.day>c.day)&&(c=Ve,C=He)}}if(l==="constrain"&&C!==void 0)return C;throw new RangeError(`No recent ${this.id} year with monthCode ${G} and day ${re}`)}getFirstDayOfWeek(){}getMinimalDaysInFirstWeek(){}}class QI extends kp{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}}}inLeapYear(n){const{year:l}=n;return(7*l+1)%19<7}monthsInYear(n){return this.inLeapYear(n)?13:12}minimumMonthLength(n){return this.minMaxMonthLength(n,"min")}maximumMonthLength(n){return this.minMaxMonthLength(n,"max")}minMaxMonthLength(n,l){const{month:d,year:m}=n,_=this.getMonthCode(m,d),v=Object.entries(this.months).find(C=>C[1].monthCode===_);if(v===void 0)throw new RangeError(`unmatched Hebrew month: ${d}`);const c=v[1].days;return typeof c=="number"?c:c[l]}maxLengthOfMonthCodeInAnyYear(n){return["M04","M06","M08","M10","M12"].includes(n)?29:30}estimateIsoDate(n){const{year:l}=n;return{year:l-3760,month:1,day:1}}getMonthCode(n,l){return this.inLeapYear({year:n})?l===6?Lu(5,!0):Lu(l<6?l:l-1):Lu(l)}adjustCalendarDate(n,l,d="constrain",m=!1){let{year:_,month:v,monthCode:c,day:C,monthExtra:R}=n;if(_===void 0)throw new TypeError("Missing property: year");if(m){if(R){const z=this.months[R];if(!z)throw new RangeError(`Unrecognized month from formatToParts: ${R}`);v=this.inLeapYear({year:_})?z.leap:z.regular}return c=this.getMonthCode(_,v),{year:_,month:v,day:C,monthCode:c}}if(this.validateCalendarDate(n),v===void 0)if(c.endsWith("L")){if(c!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${c}`);if(v=6,!this.inLeapYear({year:_})){if(d==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${_} which is not a leap year`);v=6,c="M06"}}else{v=Tp(c),this.inLeapYear({year:_})&&v>=6&&v++;const z=this.monthsInYear({year:_});if(v<1||v>z)throw new RangeError(`Invalid monthCode: ${c}`)}else if(d==="reject"?(Da(v,1,this.monthsInYear({year:_})),Da(C,1,this.maximumMonthLength({year:_,month:v}))):(v=Ws(v,1,this.monthsInYear({year:_})),C=Ws(C,1,this.maximumMonthLength({year:_,month:v}))),c===void 0)c=this.getMonthCode(_,v);else if(this.getMonthCode(_,v)!==c)throw new RangeError(`monthCode ${c} doesn't correspond to month ${v} in Hebrew year ${_}`);return{...n,day:C,month:v,monthCode:c,year:_}}}class Eg extends kp{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425}inLeapYear(n,l){const d={year:n.year,month:1,monthCode:"M01",day:1},m={year:n.year+1,month:1,monthCode:"M01",day:1};return this.calendarDaysUntil(d,m,l)===355}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(){return 30}estimateIsoDate(n){const{year:l}=this.adjustCalendarDate(n);return{year:Math.floor(l*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class KI extends Eg{constructor(){super(...arguments),this.id="islamic"}}class JI extends Eg{constructor(){super(...arguments),this.id="islamic-umalqura"}}class e3 extends Eg{constructor(){super(...arguments),this.id="islamic-tbla"}}class t3 extends Eg{constructor(){super(...arguments),this.id="islamic-civil"}}class n3 extends Eg{constructor(){super(...arguments),this.id="islamic-rgsa"}}class i3 extends Eg{constructor(){super(...arguments),this.id="islamicc"}}class r3 extends kp{constructor(){super(...arguments),this.id="persian",this.calendarType="solar"}inLeapYear(n,l){return this.daysInMonth({year:n.year,month:12,day:1},l)===30}monthsInYear(){return 12}minimumMonthLength(n){const{month:l}=n;return l===12?29:l<=6?31:30}maximumMonthLength(n){const{month:l}=n;return l===12?30:l<=6?31:30}maxLengthOfMonthCodeInAnyYear(n){return Tp(n)<=6?31:30}estimateIsoDate(n){const{year:l}=this.adjustCalendarDate(n);return{year:l+621,month:1,day:1}}}class a3 extends kp{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(n){return Gx(n.year+78)}monthsInYear(){return 12}minimumMonthLength(n){return this.getMonthInfo(n).length}maximumMonthLength(n){return this.getMonthInfo(n).length}maxLengthOfMonthCodeInAnyYear(n){const l=Tp(n);let d=this.months[l];return d=d.leap??d,d.length}getMonthInfo(n){const{month:l}=n;let d=this.months[l];if(d===void 0)throw new RangeError(`Invalid month: ${l}`);return this.inLeapYear(n)&&d.leap&&(d=d.leap),d}estimateIsoDate(n){const l=this.adjustCalendarDate(n),d=this.getMonthInfo(l);return Do(l.year+78+(d.nextYear?1:0),d.month,d.day+l.day-1)}checkIcuBugs(n){if(this.vulnerableToBceBug&&n.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function Gx(i){return i%4==0&&(i%100!=0||i%400==0)}class tE extends kp{constructor(n,l){super(),this.calendarType="solar",this.id=n,this.isoEpoch=l}inLeapYear(n){const{year:l}=this.estimateIsoDate({month:1,day:1,year:n.year});return Gx(l)}monthsInYear(){return 12}minimumMonthLength(n){const{month:l}=n;return l===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(l)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][Tp(n)-1]}estimateIsoDate(n){const l=this.adjustCalendarDate(n);return Hy(l.year+this.isoEpoch.year,l.month+this.isoEpoch.month,l.day+this.isoEpoch.day,"constrain")}}class nE extends kp{constructor(n,l){super(),this.hasEra=!0,this.calendarType="solar",this.id=n;const{eras:d,anchorEra:m}=function(_){let v,c=_;if(c.length===0)throw new RangeError("Invalid era data: eras are required");if(c.length===1&&c[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(c.length===1&&!c[0].code)throw new RangeError("Invalid era data: at least one named era is required");if(c.filter(R=>R.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");c.forEach(R=>{if(R.isAnchor||!R.anchorEpoch&&!R.reverseOf){if(v)throw new RangeError("Invalid era data: cannot have multiple anchor eras");v=R,R.anchorEpoch={year:R.hasYearZero?0:1}}else if(!R.code)throw new RangeError("If era name is blank, it must be the anchor era")}),c=c.filter(R=>R.code),c.forEach(R=>{const{reverseOf:z}=R;if(z){const B=c.find(V=>V.code===z);if(B===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${z}`);R.reverseOf=B,R.anchorEpoch=B.anchorEpoch,R.isoEpoch=B.isoEpoch}R.anchorEpoch.month===void 0&&(R.anchorEpoch.month=1),R.anchorEpoch.day===void 0&&(R.anchorEpoch.day=1)}),c.sort((R,z)=>{if(R.reverseOf)return 1;if(z.reverseOf)return-1;if(!R.isoEpoch||!z.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return z.isoEpoch.year-R.isoEpoch.year});const C=c[c.length-1].reverseOf;if(C&&C!==c[c.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return c.forEach((R,z)=>{R.genericName="era"+(c.length-1-z)}),{eras:c,anchorEra:v||c[0]}}(l);this.anchorEra=m,this.eras=d}inLeapYear(n){const{year:l}=this.estimateIsoDate({month:1,day:1,year:n.year});return Gx(l)}monthsInYear(){return 12}minimumMonthLength(n){const{month:l}=n;return l===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(l)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][Tp(n)-1]}completeEraYear(n){const l=(c,C,R)=>{const z=n[c];if(z!=null&&z!=C&&!(R||[]).includes(z)){const B=R?.[0];throw new RangeError(`Input ${c} ${z} doesn't match calculated value ${B?`${C} (also called ${B})`:C}`)}},d=c=>{let C;const R={...n,year:c},z=this.eras.find((B,V)=>{if(V===this.eras.length-1){if(B.reverseOf){if(c>0)throw new RangeError(`Signed year ${c} is invalid for era ${B.code}`);return C=B.anchorEpoch.year-c,!0}return C=c-B.anchorEpoch.year+(B.hasYearZero?0:1),!0}return this.compareCalendarDates(R,B.anchorEpoch)>=0&&(C=c-B.anchorEpoch.year+(B.hasYearZero?0:1),!0)});if(!z)throw new RangeError(`Year ${c} was not matched by any era`);return{eraYear:C,era:z.code,eraNames:z.names}};let{year:m,eraYear:_,era:v}=n;if(m!=null){const c=d(m);({eraYear:_,era:v}=c),l("era",v,c?.eraNames),l("eraYear",_)}else{if(_==null)throw new RangeError("Either year or eraYear and era are required");{if(v===void 0)throw new RangeError("era and eraYear must be provided together");const c=this.eras.find(({code:C,names:R=[]})=>C===v||R.includes(v));if(!c)throw new RangeError(`Era ${v} (ISO year ${_}) was not matched by any era`);m=c.reverseOf?c.anchorEpoch.year-_:_+c.anchorEpoch.year-(c.hasYearZero?0:1),l("year",m),{eraYear:_,era:v}=d(m)}}return{...n,year:m,eraYear:_,era:v}}adjustCalendarDate(n,l,d="constrain"){let m=n;const{month:_,monthCode:v}=m;return _===void 0&&(m={...m,month:Tp(v)}),this.validateCalendarDate(m),m=this.completeEraYear(m),super.adjustCalendarDate(m,l,d)}estimateIsoDate(n){const l=this.adjustCalendarDate(n),{year:d,month:m,day:_}=l,{anchorEra:v}=this;return Hy(d+v.isoEpoch.year-(v.hasYearZero?0:1),m,_,"constrain")}}class Zx extends nE{constructor(n,l){super(n,l)}isoToCalendarDate(n){const{year:l,month:d,day:m}=n,_=Lu(d),v=l-this.anchorEra.isoEpoch.year+1;return this.completeEraYear({year:v,month:d,monthCode:_,day:m})}}const Du={inLeapYear(i){const{year:n}=i;return(n+1)%4==0},monthsInYear:()=>13,minimumMonthLength(i){const{month:n}=i;return n===13?this.inLeapYear(i)?6:5:30},maximumMonthLength(i){return this.minimumMonthLength(i)},maxLengthOfMonthCodeInAnyYear:i=>i==="M13"?6:30};class s3 extends tE{constructor(n,l){super(n,l),this.inLeapYear=Du.inLeapYear,this.monthsInYear=Du.monthsInYear,this.minimumMonthLength=Du.minimumMonthLength,this.maximumMonthLength=Du.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=Du.maxLengthOfMonthCodeInAnyYear}}class iE extends nE{constructor(n,l){super(n,l),this.inLeapYear=Du.inLeapYear,this.monthsInYear=Du.monthsInYear,this.minimumMonthLength=Du.minimumMonthLength,this.maximumMonthLength=Du.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=Du.maxLengthOfMonthCodeInAnyYear}}class o3 extends s3{constructor(){super("ethioaa",{year:-5492,month:7,day:17})}}class l3 extends iE{constructor(){super("coptic",[{code:"coptic",isoEpoch:{year:284,month:8,day:29}},{code:"coptic-inverse",reverseOf:"coptic"}])}}class c3 extends iE{constructor(){super("ethiopic",[{code:"ethioaa",names:["ethiopic-amete-alem","mundi"],isoEpoch:{year:-5492,month:7,day:17}},{code:"ethiopic",names:["incar"],isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class u3 extends Zx{constructor(){super("roc",[{code:"roc",names:["minguo"],isoEpoch:{year:1912,month:1,day:1}},{code:"roc-inverse",names:["before-roc"],reverseOf:"roc"}])}}class h3 extends tE{constructor(){super("buddhist",{year:-543,month:1,day:1})}}class d3 extends Zx{constructor(){super("gregory",[{code:"gregory",names:["ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"gregory-inverse",names:["be","bce"],reverseOf:"gregory"}])}reviseIntlEra(n){let{era:l,eraYear:d}=n;return l==="b"&&(l="gregory-inverse"),l==="a"&&(l="gregory"),{era:l,eraYear:d}}getFirstDayOfWeek(){return 1}getMinimalDaysInFirstWeek(){return 1}}class f3 extends Zx{constructor(){super("japanese",[{code:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{code:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{code:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{code:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{code:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{code:"japanese",names:["japanese","gregory","ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"japanese-inverse",names:["japanese-inverse","gregory-inverse","bc","bce"],reverseOf:"japanese"}]),this.erasBeginMidYear=!0}reviseIntlEra(n,l){const{era:d,eraYear:m}=n,{year:_}=l;return this.eras.find(v=>v.code===d)?{era:d,eraYear:m}:_<1?{era:"japanese-inverse",eraYear:1-_}:{era:"japanese",eraYear:_}}}class rE extends kp{constructor(){super(...arguments),this.calendarType="lunisolar"}inLeapYear(n,l){const d=this.getMonthList(n.year,l);return Object.entries(d).length===13}monthsInYear(n,l){return this.inLeapYear(n,l)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(n){return["M01L","M09L","M10L","M11L","M12L"].includes(n)?29:30}monthDaySearchStartYear(n,l){const d={M01L:[1651,1651],M02L:[1947,1765],M03L:[1966,1955],M04L:[1963,1944],M05L:[1971,1952],M06L:[1960,1941],M07L:[1968,1938],M08L:[1957,1718],M09L:[1832,1832],M10L:[1870,1870],M11L:[1814,1814],M12L:[1890,1890]}[n]??[1972,1972];return l<30?d[0]:d[1]}getMonthList(n,l){if(n===void 0)throw new TypeError("Missing year");const d=JSON.stringify({func:"getMonthList",calendarYear:n,id:this.id}),m=l.get(d);if(m)return m;const _=this.getFormatter(),v=(pe,Ie)=>{const Ge=eE({isoYear:pe,isoMonth:2,isoDay:1}),je=new Date(Ge);je.setUTCDate(Ie+1);const He=_.formatToParts(je),Ve=He.find(Ne=>Ne.type==="month").value,rt=+He.find(Ne=>Ne.type==="day").value,Je=He.find(Ne=>Ne.type==="relatedYear");let Mt;if(Je===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return Mt=+Je.value,{calendarMonthString:Ve,calendarDay:rt,calendarYearToVerify:Mt}};let c=17,{calendarMonthString:C,calendarDay:R,calendarYearToVerify:z}=v(n,c);C!=="1"&&(c+=29,{calendarMonthString:C,calendarDay:R}=v(n,c)),c-=R-5;const B={};let V,G,re=1,fe=!1;do({calendarMonthString:C,calendarDay:R,calendarYearToVerify:z}=v(n,c)),V&&(B[G].daysInMonth=V+30-R),z!==n?fe=!0:(B[C]={monthIndex:re++},c+=30),V=R,G=C;while(!fe);return B[G].daysInMonth=V+30-R,l.set(d,B),B}estimateIsoDate(n){const{year:l,month:d}=n;return{year:l,month:d>=12?12:d+1,day:1}}adjustCalendarDate(n,l,d="constrain",m=!1){let{year:_,month:v,monthExtra:c,day:C,monthCode:R}=n;if(_===void 0)throw new TypeError("Missing property: year");if(m){if(c&&c!=="bis")throw new RangeError(`Unexpected leap month suffix: ${c}`);const z=Lu(v,c!==void 0),B=`${v}${c||""}`,V=this.getMonthList(_,l)[B];if(V===void 0)throw new RangeError(`Unmatched month ${B} in Chinese year ${_}`);return v=V.monthIndex,{year:_,month:v,day:C,monthCode:z}}if(this.validateCalendarDate(n),v===void 0){const z=this.getMonthList(_,l);let B=R.replace(/^M|L$/g,G=>G==="L"?"bis":"");B[0]==="0"&&(B=B.slice(1));let V=z[B];if(v=V&&V.monthIndex,v===void 0&&R.endsWith("L")&&R!="M13L"&&d==="constrain"){const G=+R.replace(/^M0?|L$/g,"");V=z[G],V&&(v=V.monthIndex,R=Lu(G))}if(v===void 0)throw new RangeError(`Unmatched month ${R} in Chinese year ${_}`)}else if(R===void 0){const z=this.getMonthList(_,l),B=Object.entries(z),V=B.length;d==="reject"?(Da(v,1,V),Da(C,1,this.maximumMonthLength())):(v=Ws(v,1,V),C=Ws(C,1,this.maximumMonthLength()));const G=B.find(re=>re[1].monthIndex===v);if(G===void 0)throw new RangeError(`Invalid month ${v} in Chinese year ${_}`);R=Lu(+G[0].replace("bis",""),G[0].indexOf("bis")!==-1)}else{const z=this.getMonthList(_,l);let B=R.replace(/^M|L$/g,G=>G==="L"?"bis":"");B[0]==="0"&&(B=B.slice(1));const V=z[B];if(!V)throw new RangeError(`Unmatched monthCode ${R} in Chinese year ${_}`);if(v!==V.monthIndex)throw new RangeError(`monthCode ${R} doesn't correspond to month ${v} in Chinese year ${_}`)}return{...n,year:_,month:v,monthCode:R,day:C}}}class p3 extends rE{constructor(){super(...arguments),this.id="chinese"}}class m3 extends rE{constructor(){super(...arguments),this.id="dangi"}}class g3{constructor(n){this.helper=n}extraFields(n){return this.helper.hasEra&&n.includes("year")?["era","eraYear"]:[]}resolveFields(n){if(this.helper.calendarType!=="lunisolar"){const l=new Ma;Vx(n,void 0,this.helper.monthsInYear({year:n.year??1972},l))}}dateToISO(n,l){const d=new Ma,m=this.helper.calendarToIsoDate(n,l,d);return d.setObject(m),m}monthDayToISOReferenceDate(n,l){const d=new Ma,m=this.helper.monthDayFromFields(n,l,d);return d.setObject(m),m}fieldKeysToIgnore(n){const l=new Set;for(let d=0;d<n.length;d++){const m=n[d];switch(l.add(m),m){case"era":l.add("eraYear"),l.add("year");break;case"eraYear":l.add("era"),l.add("year");break;case"year":l.add("era"),l.add("eraYear");break;case"month":l.add("monthCode"),this.helper.erasBeginMidYear&&(l.add("era"),l.add("eraYear"));break;case"monthCode":l.add("month"),this.helper.erasBeginMidYear&&(l.add("era"),l.add("eraYear"));break;case"day":this.helper.erasBeginMidYear&&(l.add("era"),l.add("eraYear"))}}return KS(l)}dateAdd(n,{years:l,months:d,weeks:m,days:_},v){const c=Ma.getCacheForObject(n),C=this.helper.isoToCalendarDate(n,c),R=this.helper.addCalendar(C,{years:l,months:d,weeks:m,days:_},v,c),z=this.helper.calendarToIsoDate(R,"constrain",c);return Ma.getCacheForObject(z)||new Ma(c).setObject(z),z}dateUntil(n,l,d){const m=Ma.getCacheForObject(n),_=Ma.getCacheForObject(l),v=this.helper.isoToCalendarDate(n,m),c=this.helper.isoToCalendarDate(l,_);return this.helper.untilCalendar(v,c,d,m)}isoToDate(n,l){const d=Ma.getCacheForObject(n),m=this.helper.isoToCalendarDate(n,d);if(l.dayOfWeek&&(m.dayOfWeek=I_.iso8601.isoToDate(n,{dayOfWeek:!0}).dayOfWeek),l.dayOfYear){const _=this.helper.startOfCalendarYear(m),v=this.helper.calendarDaysUntil(_,m,d);m.dayOfYear=v+1}if(l.weekOfYear&&(m.weekOfYear=JS(this.helper.id,n)),m.daysInWeek=7,l.daysInMonth&&(m.daysInMonth=this.helper.daysInMonth(m,d)),l.daysInYear){const _=this.helper.startOfCalendarYear(m),v=this.helper.addCalendar(_,{years:1},"constrain",d);m.daysInYear=this.helper.calendarDaysUntil(_,v,d)}return l.monthsInYear&&(m.monthsInYear=this.helper.monthsInYear(m,d)),l.inLeapYear&&(m.inLeapYear=this.helper.inLeapYear(m,d)),m}getFirstDayOfWeek(){return this.helper.getFirstDayOfWeek()}getMinimalDaysInFirstWeek(){return this.helper.getMinimalDaysInFirstWeek()}}for(const i of[QI,r3,c3,o3,l3,p3,m3,u3,a3,h3,d3,f3,KI,JI,e3,t3,n3,i3]){const n=new i;I_[n.id]=new g3(n)}Gb("calendarImpl",function(i){return I_[i]});const c_=Intl.DateTimeFormat;function Zm(i,n){let l=te(i,n);return typeof l=="function"&&(l=new c_(te(i,mS),l(te(i,Bb))),function(d,m,_){const v=mv(d);if(v===void 0)throw new TypeError("Missing slots for the given container");if(v[m]===void 0)throw new TypeError(`tried to reset ${m} which was not set`);v[m]=_}(i,n,l)),l}function Cy(i){return to(i,Cp)}class u_{constructor(n=void 0,l=void 0){(function(d,m,_){const v=_!==void 0;let c;if(v){const B=["localeMatcher","calendar","numberingSystem","hour12","hourCycle","timeZone","weekday","era","year","month","day","dayPeriod","hour","minute","second","fractionalSecondDigits","timeZoneName","formatMatcher","dateStyle","timeStyle"];c=function(G){if(G==null)throw new TypeError(`Expected object not ${G}`);return Object(G)}(_);const V=Object.create(null);for(let G=0;G<B.length;G++){const re=B[G];Object.prototype.hasOwnProperty.call(c,re)&&(V[re]=c[re])}c=V}else c=Object.create(null);const C=new c_(m,c),R=C.resolvedOptions();if(od(d),v){const B=Object.assign(Object.create(null),R);for(const V in B)Object.prototype.hasOwnProperty.call(c,V)||delete B[V];B.hour12=c.hour12,B.hourCycle=c.hourCycle,Pn(d,Bb,B)}else Pn(d,Bb,c);Pn(d,mS,R.locale),Pn(d,Cp,C),Pn(d,qm,R.timeZone),Pn(d,Ny,R.calendar),Pn(d,cS,E3),Pn(d,uS,T3),Pn(d,hS,S3),Pn(d,dS,w3),Pn(d,fS,A3),Pn(d,pS,M3);const z=v?c.timeZone:void 0;if(z===void 0)Pn(d,jb,R.timeZone);else{const B=vv(z);if(B.startsWith("−"))throw new RangeError("Unicode minus (U+2212) is not supported in time zone offsets");Pn(d,jb,Ks(B))}})(this,n,l)}get format(){it(this,Cy);const n=_3.bind(this);return Object.defineProperties(n,{length:{value:1,enumerable:!1,writable:!1,configurable:!0},name:{value:"",enumerable:!1,writable:!1,configurable:!0}}),n}formatRange(n,l){return it(this,Cy),b3.call(this,n,l)}formatToParts(n,...l){return it(this,Cy),v3.call(this,n,...l)}formatRangeToParts(n,l){return it(this,Cy),x3.call(this,n,l)}resolvedOptions(){return it(this,Cy),y3.call(this)}}"formatToParts"in c_.prototype||delete u_.prototype.formatToParts,"formatRangeToParts"in c_.prototype||delete u_.prototype.formatRangeToParts;const Pl=function(i=void 0,n=void 0){return new u_(i,n)};function y3(){const i=te(this,Cp).resolvedOptions();return i.timeZone=te(this,jb),i}function _3(i,...n){let l,d,m=fg(i,this);return m.formatter?(l=m.formatter,d=[jl(m.epochNs,"floor")]):(l=te(this,Cp),d=[i,...n]),l.format(...d)}function v3(i,...n){let l,d,m=fg(i,this);return m.formatter?(l=m.formatter,d=[jl(m.epochNs,"floor")]):(l=te(this,Cp),d=[i,...n]),l.formatToParts(...d)}function b3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const l=tv(i),d=tv(n);let m,_=[l,d];if(ed(l)!==ed(d))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");if(ed(l)){if(!aE(l,d))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{epochNs:v,formatter:c}=fg(l,this),{epochNs:C,formatter:R}=fg(d,this);c&&(m=c,_=[jl(v,"floor"),jl(C,"floor")])}return m||(m=te(this,Cp)),m.formatRange(..._)}function x3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const l=tv(i),d=tv(n);let m,_=[l,d];if(ed(l)!==ed(d))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");if(ed(l)){if(!aE(l,d))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{epochNs:v,formatter:c}=fg(l,this),{epochNs:C,formatter:R}=fg(d,this);c&&(m=c,_=[jl(v,"floor"),jl(C,"floor")])}return m||(m=te(this,Cp)),m.formatRangeToParts(..._)}function P_(i={},n={}){const l=Object.assign({},i),d=["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"];for(let m=0;m<d.length;m++){const _=d[m];l[_]=_ in n?n[_]:l[_],l[_]!==!1&&l[_]!==void 0||delete l[_]}return l}function w3(i){const n=P_(i,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});if(n.timeStyle!=="long"&&n.timeStyle!=="full"||(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"})),!Cv(n)){if(N_(i))throw new TypeError(`cannot format Temporal.PlainTime with options [${Object.keys(i)}]`);Object.assign(n,{hour:"numeric",minute:"numeric",second:"numeric"})}return n}function T3(i){const n={short:{year:"2-digit",month:"numeric"},medium:{year:"numeric",month:"short"},long:{year:"numeric",month:"long"},full:{year:"numeric",month:"long"}},l=P_(i,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in l&&l.dateStyle){const d=l.dateStyle;delete l.dateStyle,Object.assign(l,n[d])}if(!("year"in l||"month"in l||"era"in l)){if(N_(i))throw new TypeError(`cannot format PlainYearMonth with options [${Object.keys(i)}]`);Object.assign(l,{year:"numeric",month:"numeric"})}return l}function S3(i){const n={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric"},long:{month:"long",day:"numeric"},full:{month:"long",day:"numeric"}},l=P_(i,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in l&&l.dateStyle){const d=l.dateStyle;delete l.dateStyle,Object.assign(l,n[d])}if(!("month"in l)&&!("day"in l)){if(N_(i))throw new TypeError(`cannot format PlainMonthDay with options [${Object.keys(i)}]`);Object.assign(l,{month:"numeric",day:"numeric"})}return l}function E3(i){const n=P_(i,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if(!Mv(n)){if(N_(i))throw new TypeError(`cannot format PlainDate with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric"})}return n}function A3(i){const n=P_(i,{timeZoneName:!1});if((n.timeStyle==="long"||n.timeStyle==="full")&&(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"}),n.dateStyle)&&(Object.assign(n,{short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"long",day:"numeric"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long"}}[n.dateStyle]),delete n.dateStyle),!Cv(n)&&!Mv(n)){if(N_(i))throw new TypeError(`cannot format PlainDateTime with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}return n}function M3(i){let n=i;return Cv(n)||Mv(n)||(n=Object.assign({},n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),n}function Mv(i){return"year"in i||"month"in i||"day"in i||"weekday"in i||"dateStyle"in i||"era"in i}function Cv(i){return"hour"in i||"minute"in i||"second"in i||"timeStyle"in i||"dayPeriod"in i||"fractionalSecondDigits"in i}function N_(i){return Mv(i)||Cv(i)||"dateStyle"in i||"timeStyle"in i||"timeZoneName"in i}function ed(i){return br(i)||Dr(i)||Hi(i)||jn(i)||Xa(i)||el(i)||Ha(i)}function tv(i){return ed(i)?i:_v(i)}function aE(i,n){return!(!ed(i)||!ed(n)||Dr(i)&&!Dr(n)||br(i)&&!br(n)||Hi(i)&&!Hi(n)||jn(i)&&!jn(n)||Xa(i)&&!Xa(n)||el(i)&&!el(n)||Ha(i)&&!Ha(n))}function fg(i,n){if(Dr(i)){const l={isoDate:{year:1970,month:1,day:1},time:te(i,xr)};return{epochNs:xs(te(n,qm),l,"compatible"),formatter:Zm(n,dS)}}if(Xa(i)){const l=te(i,At),d=te(n,Ny);if(l!==d)throw new RangeError(`cannot format PlainYearMonth with calendar ${l} in locale with calendar ${d}`);const m=ri(te(i,_n),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:xs(te(n,qm),m,"compatible"),formatter:Zm(n,uS)}}if(el(i)){const l=te(i,At),d=te(n,Ny);if(l!==d)throw new RangeError(`cannot format PlainMonthDay with calendar ${l} in locale with calendar ${d}`);const m=ri(te(i,_n),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:xs(te(n,qm),m,"compatible"),formatter:Zm(n,hS)}}if(br(i)){const l=te(i,At),d=te(n,Ny);if(l!=="iso8601"&&l!==d)throw new RangeError(`cannot format PlainDate with calendar ${l} in locale with calendar ${d}`);const m=ri(te(i,_n),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:xs(te(n,qm),m,"compatible"),formatter:Zm(n,cS)}}if(Hi(i)){const l=te(i,At),d=te(n,Ny);if(l!=="iso8601"&&l!==d)throw new RangeError(`cannot format PlainDateTime with calendar ${l} in locale with calendar ${d}`);const m=te(i,ir);return{epochNs:xs(te(n,qm),m,"compatible"),formatter:Zm(n,fS)}}if(jn(i))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return Ha(i)?{epochNs:te(i,yn),formatter:Zm(n,pS)}:{}}function sE(i){const n=Object.create(null);return n.years=te(i,Vs),n.months=te(i,Gs),n.weeks=te(i,To),n.days=te(i,Zs),n.hours=te(i,$s),n.minutes=te(i,Ys),n.seconds=te(i,qs),n.milliseconds=te(i,Hs),n.microseconds=te(i,Xs),n.nanoseconds=te(i,So),n}u_.prototype.constructor=Pl,Object.defineProperty(Pl,"prototype",{value:u_.prototype,writable:!1,enumerable:!1,configurable:!1}),Pl.supportedLocalesOf=c_.supportedLocalesOf,ld(Pl,"Intl.DateTimeFormat");const{format:C3,formatToParts:D3}=Intl.DurationFormat?.prototype??Object.create(null);function oE(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=sE(Nl(i));return C3.call(this,n)}Intl.DurationFormat?.prototype&&(Intl.DurationFormat.prototype.format=oE,Intl.DurationFormat.prototype.formatToParts=function(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=sE(Nl(i));return D3.call(this,n)});class $x{constructor(n){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");NS(this,ev(n))}get epochMilliseconds(){return it(this,Ha),jl(te(this,yn),"floor")}get epochNanoseconds(){return it(this,Ha),WS(W.BigInt(te(this,yn)))}add(n){return it(this,Ha),$w("add",this,n)}subtract(n){return it(this,Ha),$w("subtract",this,n)}until(n,l=void 0){return it(this,Ha),jw("until",this,n,l)}since(n,l=void 0){return it(this,Ha),jw("since",this,n,l)}round(n){if(it(this,Ha),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?wp("smallestUnit",n):Jt(n),d=xg(l),m=Pc(l,"halfExpand"),_=Ao(l,"smallestUnit","time",rd);return wg(d,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[_],!0),Ru(Jb(te(this,yn),d,_,m))}equals(n){it(this,Ha);const l=Oy(n),d=te(this,yn),m=te(l,yn);return W.equal(W.BigInt(d),W.BigInt(m))}toString(n=void 0){it(this,Ha);const l=Jt(n),d=S_(l),m=Pc(l,"trunc"),_=Ao(l,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let v=l.timeZone;v!==void 0&&(v=Ks(v));const{precision:c,unit:C,increment:R}=E_(_,d);return Dw(Ru(Jb(te(this,yn),R,C,m)),v,c)}toJSON(){return it(this,Ha),Dw(this,void 0,"auto")}toLocaleString(n=void 0,l=void 0){return it(this,Ha),new Pl(n,l).format(this)}valueOf(){yf("Instant")}toZonedDateTimeISO(n){it(this,Ha);const l=Ks(n);return vs(te(this,yn),l,"iso8601")}static fromEpochMilliseconds(n){return Ru(Pu(_v(n)))}static fromEpochNanoseconds(n){return Ru(ev(n))}static from(n){return Oy(n)}static compare(n,l){const d=Oy(n),m=Oy(l),_=te(d,yn),v=te(m,yn);return W.lessThan(_,v)?-1:W.greaterThan(_,v)?1:0}}ld($x,"Temporal.Instant");class Yx{constructor(n,l,d,m="iso8601"){const _=Tn(n),v=Tn(l),c=Tn(d),C=no(m===void 0?"iso8601":ga(m));vp(_,v,c),DS(this,{year:_,month:v,day:c},C)}get calendarId(){return it(this,br),te(this,At)}get era(){return Bs(this,"era")}get eraYear(){return Bs(this,"eraYear")}get year(){return Bs(this,"year")}get month(){return Bs(this,"month")}get monthCode(){return Bs(this,"monthCode")}get day(){return Bs(this,"day")}get dayOfWeek(){return Bs(this,"dayOfWeek")}get dayOfYear(){return Bs(this,"dayOfYear")}get weekOfYear(){return Bs(this,"weekOfYear")?.week}get yearOfWeek(){return Bs(this,"weekOfYear")?.year}get daysInWeek(){return Bs(this,"daysInWeek")}get daysInMonth(){return Bs(this,"daysInMonth")}get daysInYear(){return Bs(this,"daysInYear")}get monthsInYear(){return Bs(this,"monthsInYear")}get inLeapYear(){return Bs(this,"inLeapYear")}with(n,l=void 0){if(it(this,br),!wr(n))throw new TypeError("invalid argument");bg(n);const d=te(this,At);let m=Js(d,te(this,_n));return m=_p(d,m,sl(d,n,["year","month","monthCode","day"],[],"partial")),Qs(df(d,m,ti(Jt(l))),d)}withCalendar(n){it(this,br);const l=D_(n);return Qs(te(this,_n),l)}add(n,l=void 0){return it(this,br),Yw("add",this,n,l)}subtract(n,l=void 0){return it(this,br),Yw("subtract",this,n,l)}until(n,l=void 0){return it(this,br),Bw("until",this,n,l)}since(n,l=void 0){return it(this,br),Bw("since",this,n,l)}equals(n){it(this,br);const l=zy(n);return Bu(te(this,_n),te(l,_n))===0&&Ou(te(this,At),te(l,At))}toString(n=void 0){return it(this,br),kw(this,T_(Jt(n)))}toJSON(){return it(this,br),kw(this)}toLocaleString(n=void 0,l=void 0){return it(this,br),new Pl(n,l).format(this)}valueOf(){yf("PlainDate")}toPlainDateTime(n=void 0){it(this,br);const l=CS(n);return Rl(ri(te(this,_n),l),te(this,At))}toZonedDateTime(n){let l,d;if(it(this,br),wr(n)){const v=n.timeZone;v===void 0?l=Ks(n):(l=Ks(v),d=n.plainTime)}else l=Ks(n);const m=te(this,_n);let _;return d===void 0?_=tf(l,m):(d=rf(d),_=xs(l,ri(m,te(d,xr)),"compatible")),vs(_,l,te(this,At))}toPlainYearMonth(){it(this,br);const n=te(this,At);return Jm(r_(n,Js(n,te(this,_n)),"constrain"),n)}toPlainMonthDay(){it(this,br);const n=te(this,At);return Wm(X0(n,Js(n,te(this,_n)),"constrain"),n)}static from(n,l=void 0){return zy(n,l)}static compare(n,l){const d=zy(n),m=zy(l);return Bu(te(d,_n),te(m,_n))}}function Bs(i,n){it(i,br);const l=te(i,_n);return A_(i).isoToDate(l,{[n]:!0})[n]}ld(Yx,"Temporal.PlainDate");class qx{constructor(n,l,d,m=0,_=0,v=0,c=0,C=0,R=0,z="iso8601"){const B=Tn(n),V=Tn(l),G=Tn(d),re=m===void 0?0:Tn(m),fe=_===void 0?0:Tn(_),pe=v===void 0?0:Tn(v),Ie=c===void 0?0:Tn(c),Ge=C===void 0?0:Tn(C),je=R===void 0?0:Tn(R),He=no(z===void 0?"iso8601":ga(z));jx(B,V,G,re,fe,pe,Ie,Ge,je),kS(this,{isoDate:{year:B,month:V,day:G},time:{hour:re,minute:fe,second:pe,millisecond:Ie,microsecond:Ge,nanosecond:je}},He)}get calendarId(){return it(this,Hi),te(this,At)}get year(){return Fs(this,"year")}get month(){return Fs(this,"month")}get monthCode(){return Fs(this,"monthCode")}get day(){return Fs(this,"day")}get hour(){return $m(this,"hour")}get minute(){return $m(this,"minute")}get second(){return $m(this,"second")}get millisecond(){return $m(this,"millisecond")}get microsecond(){return $m(this,"microsecond")}get nanosecond(){return $m(this,"nanosecond")}get era(){return Fs(this,"era")}get eraYear(){return Fs(this,"eraYear")}get dayOfWeek(){return Fs(this,"dayOfWeek")}get dayOfYear(){return Fs(this,"dayOfYear")}get weekOfYear(){return Fs(this,"weekOfYear")?.week}get yearOfWeek(){return Fs(this,"weekOfYear")?.year}get daysInWeek(){return Fs(this,"daysInWeek")}get daysInYear(){return Fs(this,"daysInYear")}get daysInMonth(){return Fs(this,"daysInMonth")}get monthsInYear(){return Fs(this,"monthsInYear")}get inLeapYear(){return Fs(this,"inLeapYear")}with(n,l=void 0){if(it(this,Hi),!wr(n))throw new TypeError("invalid argument");bg(n);const d=te(this,At),m=te(this,ir);let _={...Js(d,m.isoDate),...m.time};return _=_p(d,_,sl(d,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],"partial")),Rl(M_(d,_,ti(Jt(l))),d)}withPlainTime(n=void 0){it(this,Hi);const l=CS(n);return Rl(ri(te(this,ir).isoDate,l),te(this,At))}withCalendar(n){it(this,Hi);const l=D_(n);return Rl(te(this,ir),l)}add(n,l=void 0){return it(this,Hi),qw("add",this,n,l)}subtract(n,l=void 0){return it(this,Hi),qw("subtract",this,n,l)}until(n,l=void 0){return it(this,Hi),Fw("until",this,n,l)}since(n,l=void 0){return it(this,Hi),Fw("since",this,n,l)}round(n){if(it(this,Hi),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?wp("smallestUnit",n):Jt(n),d=xg(l),m=Pc(l,"halfExpand"),_=Ao(l,"smallestUnit","time",rd,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];wg(d,v,v===1);const c=te(this,ir);return Rl(d===1&&_==="nanosecond"?c:ex(c,d,_,m),te(this,At))}equals(n){it(this,Hi);const l=Ly(n);return dg(te(this,ir),te(l,ir))===0&&Ou(te(this,At),te(l,At))}toString(n=void 0){it(this,Hi);const l=Jt(n),d=T_(l),m=S_(l),_=Pc(l,"trunc"),v=Ao(l,"smallestUnit","time",void 0);if(v==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:c,unit:C,increment:R}=E_(v,m),z=ex(te(this,ir),R,C,_);return bp(z),s_(z,te(this,At),c,d)}toJSON(){return it(this,Hi),s_(te(this,ir),te(this,At),"auto")}toLocaleString(n=void 0,l=void 0){return it(this,Hi),new Pl(n,l).format(this)}valueOf(){yf("PlainDateTime")}toZonedDateTime(n,l=void 0){it(this,Hi);const d=Ks(n),m=Xy(Jt(l));return vs(xs(d,te(this,ir),m),d,te(this,At))}toPlainDate(){return it(this,Hi),Qs(te(this,ir).isoDate,te(this,At))}toPlainTime(){return it(this,Hi),$h(te(this,ir).time)}static from(n,l=void 0){return Ly(n,l)}static compare(n,l){const d=Ly(n),m=Ly(l);return dg(te(d,ir),te(m,ir))}}function Fs(i,n){it(i,Hi);const l=te(i,ir).isoDate;return A_(i).isoToDate(l,{[n]:!0})[n]}function $m(i,n){return it(i,Hi),te(i,ir).time[n]}ld(qx,"Temporal.PlainDateTime");class pg{constructor(n=0,l=0,d=0,m=0,_=0,v=0,c=0,C=0,R=0,z=0){const B=n===void 0?0:Dc(n),V=l===void 0?0:Dc(l),G=d===void 0?0:Dc(d),re=m===void 0?0:Dc(m),fe=_===void 0?0:Dc(_),pe=v===void 0?0:Dc(v),Ie=c===void 0?0:Dc(c),Ge=C===void 0?0:Dc(C),je=R===void 0?0:Dc(R),He=z===void 0?0:Dc(z);Ev(B,V,G,re,fe,pe,Ie,Ge,je,He),od(this),Pn(this,Vs,B),Pn(this,Gs,V),Pn(this,To,G),Pn(this,Zs,re),Pn(this,$s,fe),Pn(this,Ys,pe),Pn(this,qs,Ie),Pn(this,Hs,Ge),Pn(this,Xs,je),Pn(this,So,He)}get years(){return it(this,vr),te(this,Vs)}get months(){return it(this,vr),te(this,Gs)}get weeks(){return it(this,vr),te(this,To)}get days(){return it(this,vr),te(this,Zs)}get hours(){return it(this,vr),te(this,$s)}get minutes(){return it(this,vr),te(this,Ys)}get seconds(){return it(this,vr),te(this,qs)}get milliseconds(){return it(this,vr),te(this,Hs)}get microseconds(){return it(this,vr),te(this,Xs)}get nanoseconds(){return it(this,vr),te(this,So)}get sign(){return it(this,vr),K0(this)}get blank(){return it(this,vr),K0(this)===0}with(n){it(this,vr);const l=MS(n),{years:d=te(this,Vs),months:m=te(this,Gs),weeks:_=te(this,To),days:v=te(this,Zs),hours:c=te(this,$s),minutes:C=te(this,Ys),seconds:R=te(this,qs),milliseconds:z=te(this,Hs),microseconds:B=te(this,Xs),nanoseconds:V=te(this,So)}=l;return new pg(d,m,_,v,c,C,R,z,B,V)}negated(){return it(this,vr),ko(this)}abs(){return it(this,vr),new pg(Math.abs(te(this,Vs)),Math.abs(te(this,Gs)),Math.abs(te(this,To)),Math.abs(te(this,Zs)),Math.abs(te(this,$s)),Math.abs(te(this,Ys)),Math.abs(te(this,qs)),Math.abs(te(this,Hs)),Math.abs(te(this,Xs)),Math.abs(te(this,So)))}add(n){return it(this,vr),Zw("add",this,n)}subtract(n){return it(this,vr),Zw("subtract",this,n)}round(n){if(it(this,vr),n===void 0)throw new TypeError("options parameter is required");const l=Uh(this),d=typeof n=="string"?wp("smallestUnit",n):Jt(n);let m=Ao(d,"largestUnit","datetime",void 0,["auto"]),{plainRelativeTo:_,zonedRelativeTo:v}=mb(d);const c=xg(d),C=Pc(d,"halfExpand");let R=Ao(d,"smallestUnit","datetime",void 0),z=!0;R||(z=!1,R="nanosecond");const B=Qh(l,R);let V=!0;if(m||(V=!1,m=B),m==="auto"&&(m=B),!z&&!V)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(Qh(m,R)!==m)throw new RangeError(`largestUnit ${m} cannot be smaller than smallestUnit ${R}`);const G={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[R];if(G!==void 0&&wg(c,G,!1),c>1&&Vh(R)==="date"&&m!==R)throw new RangeError("For calendar units with roundingIncrement > 1, use largestUnit = smallestUnit");if(v){let fe=Hm(this);const pe=te(v,fi),Ie=te(v,At),Ge=te(v,yn);return fe=XS(Ge,Fy(Ge,pe,Ie,fe),pe,Ie,m,c,R,C),Vh(m)==="date"&&(m="hour"),Il(fe,m)}if(_){let fe=Iu(this);const pe=hg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},fe.time),Ie=te(_,_n),Ge=te(_,At),je=il(Ge,Ie,bs(fe.date,pe.deltaDays),"constrain");return fe=HS(ri(Ie,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),ri(je,pe),Ge,m,c,R,C),Il(fe,m)}if(Mu(l))throw new RangeError(`a starting point is required for ${l}s balancing`);if(Mu(m))throw new RangeError(`a starting point is required for ${m}s balancing`);let re=Iu(this);if(R==="day"){const{quotient:fe,remainder:pe}=re.time.divmod(Y0);let Ie=re.date.days+fe+Wy(pe,"day");Ie=af(Ie,c,C),re=Kh({years:0,months:0,weeks:0,days:Ie},Bn.ZERO)}else re=Kh({years:0,months:0,weeks:0,days:0},J0(re.time,c,R,C));return Il(re,m)}total(n){if(it(this,vr),n===void 0)throw new TypeError("options argument is required");const l=typeof n=="string"?wp("unit",n):Jt(n);let{plainRelativeTo:d,zonedRelativeTo:m}=mb(l);const _=Ao(l,"unit","datetime",rd);if(m){const c=Hm(this),C=te(m,fi),R=te(m,At),z=te(m,yn);return function(B,V,G,re,fe){return Vh(fe)==="time"?Wy(Bn.fromEpochNsDiff(V,B),fe):Ow(YS(B,V,G,re,fe),V,Ol(G,B),G,re,fe)}(z,Fy(z,C,R,c),C,R,_)}if(d){const c=Iu(this);let C=hg({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},c.time);const R=te(d,_n),z=te(d,At),B=il(z,R,bs(c.date,C.deltaDays),"constrain");return function(V,G,re,fe){if(dg(V,G)==0)return 0;bp(V),bp(G);const pe=$S(V,G,re,fe);return fe==="nanosecond"?W.toNumber(pe.time.totalNs):Ow(pe,Wa(G),V,null,re,fe)}(ri(R,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),ri(B,C),z,_)}const v=Uh(this);if(Mu(v))throw new RangeError(`a starting point is required for ${v}s total`);if(Mu(_))throw new RangeError(`a starting point is required for ${_}s total`);return Wy(Iu(this).time,_)}toString(n=void 0){it(this,vr);const l=Jt(n),d=S_(l),m=Pc(l,"trunc"),_=Ao(l,"smallestUnit","time",void 0);if(_==="hour"||_==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:v,unit:c,increment:C}=E_(_,d);if(c==="nanosecond"&&C===1)return k0(this,v);const R=Uh(this);let z=Hm(this);const B=J0(z.time,C,c,m);return z=Kh(z.date,B),k0(Il(z,Qh(R,"second")),v)}toJSON(){return it(this,vr),k0(this,"auto")}toLocaleString(n=void 0,l=void 0){if(it(this,vr),typeof Intl.DurationFormat=="function"){const d=new Intl.DurationFormat(n,l);return oE.call(d,this)}return console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),k0(this,"auto")}valueOf(){yf("Duration")}static from(n){return Nl(n)}static compare(n,l,d=void 0){const m=Nl(n),_=Nl(l),v=Jt(d),{plainRelativeTo:c,zonedRelativeTo:C}=mb(v);if(te(m,Vs)===te(_,Vs)&&te(m,Gs)===te(_,Gs)&&te(m,To)===te(_,To)&&te(m,Zs)===te(_,Zs)&&te(m,$s)===te(_,$s)&&te(m,Ys)===te(_,Ys)&&te(m,qs)===te(_,qs)&&te(m,Hs)===te(_,Hs)&&te(m,Xs)===te(_,Xs)&&te(m,So)===te(_,So))return 0;const R=Uh(m),z=Uh(_),B=Hm(m),V=Hm(_);if(C&&(Vh(R)==="date"||Vh(z)==="date")){const Ie=te(C,fi),Ge=te(C,At),je=te(C,yn),He=Fy(je,Ie,Ge,B),Ve=Fy(je,Ie,Ge,V);return Eo(W.toNumber(W.subtract(He,Ve)))}let G=B.date.days,re=V.date.days;if(Mu(R)||Mu(z)){if(!c)throw new RangeError("A starting point is required for years, months, or weeks comparison");G=Lw(B.date,c),re=Lw(V.date,c)}const fe=B.time.add24HourDays(G),pe=V.time.add24HourDays(re);return fe.cmp(pe)}}ld(pg,"Temporal.Duration");class Hx{constructor(n,l,d="iso8601",m=1972){const _=Tn(n),v=Tn(l),c=no(d===void 0?"iso8601":ga(d)),C=Tn(m);vp(C,_,v),RS(this,{year:C,month:_,day:v},c)}get monthCode(){return Kw(this,"monthCode")}get day(){return Kw(this,"day")}get calendarId(){return it(this,el),te(this,At)}with(n,l=void 0){if(it(this,el),!wr(n))throw new TypeError("invalid argument");bg(n);const d=te(this,At);let m=Js(d,te(this,_n),"month-day");return m=_p(d,m,sl(d,n,["year","month","monthCode","day"],[],"partial")),Wm(X0(d,m,ti(Jt(l))),d)}equals(n){it(this,el);const l=Mw(n);return Bu(te(this,_n),te(l,_n))===0&&Ou(te(this,At),te(l,At))}toString(n=void 0){return it(this,el),Iw(this,T_(Jt(n)))}toJSON(){return it(this,el),Iw(this)}toLocaleString(n=void 0,l=void 0){return it(this,el),new Pl(n,l).format(this)}valueOf(){yf("PlainMonthDay")}toPlainDate(n){if(it(this,el),!wr(n))throw new TypeError("argument should be an object");const l=te(this,At);return Qs(df(l,_p(l,Js(l,te(this,_n),"month-day"),sl(l,n,["year"],[],[])),"constrain"),l)}static from(n,l=void 0){return Mw(n,l)}}function Kw(i,n){it(i,el);const l=te(i,_n);return A_(i).isoToDate(l,{[n]:!0})[n]}function yb(i){return Ol(i,ix())}ld(Hx,"Temporal.PlainMonthDay");const lE={instant:()=>Ru(ix()),plainDateTimeISO:(i=My())=>Rl(yb(Ks(i)),"iso8601"),plainDateISO:(i=My())=>Qs(yb(Ks(i)).isoDate,"iso8601"),plainTimeISO:(i=My())=>$h(yb(Ks(i)).time),timeZoneId:()=>My(),zonedDateTimeISO:(i=My())=>{const n=Ks(i);return vs(ix(),n,"iso8601")},[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(lE,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});class z_{constructor(n=0,l=0,d=0,m=0,_=0,v=0){const c=n===void 0?0:Tn(n),C=l===void 0?0:Tn(l),R=d===void 0?0:Tn(d),z=m===void 0?0:Tn(m),B=_===void 0?0:Tn(_),V=v===void 0?0:Tn(v);Sv(c,C,R,z,B,V),IS(this,{hour:c,minute:C,second:R,millisecond:z,microsecond:B,nanosecond:V})}get hour(){return it(this,Dr),te(this,xr).hour}get minute(){return it(this,Dr),te(this,xr).minute}get second(){return it(this,Dr),te(this,xr).second}get millisecond(){return it(this,Dr),te(this,xr).millisecond}get microsecond(){return it(this,Dr),te(this,xr).microsecond}get nanosecond(){return it(this,Dr),te(this,xr).nanosecond}with(n,l=void 0){if(it(this,Dr),!wr(n))throw new TypeError("invalid argument");bg(n);const d=qb(n,"partial"),m=qb(this);let{hour:_,minute:v,second:c,millisecond:C,microsecond:R,nanosecond:z}=Object.assign(m,d);const B=ti(Jt(l));return{hour:_,minute:v,second:c,millisecond:C,microsecond:R,nanosecond:z}=xv(_,v,c,C,R,z,B),new z_(_,v,c,C,R,z)}add(n){return it(this,Dr),Hw("add",this,n)}subtract(n){return it(this,Dr),Hw("subtract",this,n)}until(n,l=void 0){return it(this,Dr),Uw("until",this,n,l)}since(n,l=void 0){return it(this,Dr),Uw("since",this,n,l)}round(n){if(it(this,Dr),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?wp("smallestUnit",n):Jt(n),d=xg(l),m=Pc(l,"halfExpand"),_=Ao(l,"smallestUnit","time",rd);return wg(d,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_],!1),$h(tx(te(this,xr),d,_,m))}equals(n){it(this,Dr);const l=rf(n);return nx(te(this,xr),te(l,xr))===0}toString(n=void 0){it(this,Dr);const l=Jt(n),d=S_(l),m=Pc(l,"trunc"),_=Ao(l,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:v,unit:c,increment:C}=E_(_,d);return Rw(tx(te(this,xr),C,c,m),v)}toJSON(){return it(this,Dr),Rw(te(this,xr),"auto")}toLocaleString(n=void 0,l=void 0){return it(this,Dr),new Pl(n,l).format(this)}valueOf(){yf("PlainTime")}static from(n,l=void 0){return rf(n,l)}static compare(n,l){const d=rf(n),m=rf(l);return nx(te(d,xr),te(m,xr))}}ld(z_,"Temporal.PlainTime");class Xx{constructor(n,l,d="iso8601",m=1){const _=Tn(n),v=Tn(l),c=no(d===void 0?"iso8601":ga(d)),C=Tn(m);vp(_,v,C),PS(this,{year:_,month:v,day:C},c)}get year(){return jh(this,"year")}get month(){return jh(this,"month")}get monthCode(){return jh(this,"monthCode")}get calendarId(){return it(this,Xa),te(this,At)}get era(){return jh(this,"era")}get eraYear(){return jh(this,"eraYear")}get daysInMonth(){return jh(this,"daysInMonth")}get daysInYear(){return jh(this,"daysInYear")}get monthsInYear(){return jh(this,"monthsInYear")}get inLeapYear(){return jh(this,"inLeapYear")}with(n,l=void 0){if(it(this,Xa),!wr(n))throw new TypeError("invalid argument");bg(n);const d=te(this,At);let m=Js(d,te(this,_n),"year-month");return m=_p(d,m,sl(d,n,["year","month","monthCode"],[],"partial")),Jm(r_(d,m,ti(Jt(l))),d)}add(n,l=void 0){return it(this,Xa),Xw("add",this,n,l)}subtract(n,l=void 0){return it(this,Xa),Xw("subtract",this,n,l)}until(n,l=void 0){return it(this,Xa),Vw("until",this,n,l)}since(n,l=void 0){return it(this,Xa),Vw("since",this,n,l)}equals(n){it(this,Xa);const l=jy(n);return Bu(te(this,_n),te(l,_n))===0&&Ou(te(this,At),te(l,At))}toString(n=void 0){return it(this,Xa),Pw(this,T_(Jt(n)))}toJSON(){return it(this,Xa),Pw(this)}toLocaleString(n=void 0,l=void 0){return it(this,Xa),new Pl(n,l).format(this)}valueOf(){yf("PlainYearMonth")}toPlainDate(n){if(it(this,Xa),!wr(n))throw new TypeError("argument should be an object");const l=te(this,At);return Qs(df(l,_p(l,Js(l,te(this,_n),"year-month"),sl(l,n,["day"],[],[])),"constrain"),l)}static from(n,l=void 0){return jy(n,l)}static compare(n,l){const d=jy(n),m=jy(l);return Bu(te(d,_n),te(m,_n))}}function jh(i,n){it(i,Xa);const l=te(i,_n);return A_(i).isoToDate(l,{[n]:!0})[n]}ld(Xx,"Temporal.PlainYearMonth");const k3=Pl.prototype.resolvedOptions;class Wx{constructor(n,l,d="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const m=ev(n);let _=ga(l);const{tzName:v,offsetMinutes:c}=of(_);if(c===void 0){const C=W0(v);if(!C)throw new RangeError(`unknown time zone ${v}`);_=C.identifier}else _=zx(c);zS(this,m,_,no(d===void 0?"iso8601":ga(d)))}get calendarId(){return it(this,jn),te(this,At)}get timeZoneId(){return it(this,jn),te(this,fi)}get year(){return Us(this,"year")}get month(){return Us(this,"month")}get monthCode(){return Us(this,"monthCode")}get day(){return Us(this,"day")}get hour(){return Ym(this,"hour")}get minute(){return Ym(this,"minute")}get second(){return Ym(this,"second")}get millisecond(){return Ym(this,"millisecond")}get microsecond(){return Ym(this,"microsecond")}get nanosecond(){return Ym(this,"nanosecond")}get era(){return Us(this,"era")}get eraYear(){return Us(this,"eraYear")}get epochMilliseconds(){return it(this,jn),jl(te(this,yn),"floor")}get epochNanoseconds(){return it(this,jn),WS(te(this,yn))}get dayOfWeek(){return Us(this,"dayOfWeek")}get dayOfYear(){return Us(this,"dayOfYear")}get weekOfYear(){return Us(this,"weekOfYear")?.week}get yearOfWeek(){return Us(this,"weekOfYear")?.year}get hoursInDay(){it(this,jn);const n=te(this,fi),l=Au(this).isoDate,d=Do(l.year,l.month,l.day+1),m=tf(n,l),_=tf(n,d);return Wy(Bn.fromEpochNsDiff(_,m),"hour")}get daysInWeek(){return Us(this,"daysInWeek")}get daysInMonth(){return Us(this,"daysInMonth")}get daysInYear(){return Us(this,"daysInYear")}get monthsInYear(){return Us(this,"monthsInYear")}get inLeapYear(){return Us(this,"inLeapYear")}get offset(){return it(this,jn),Hb(Yh(te(this,fi),te(this,yn)))}get offsetNanoseconds(){return it(this,jn),Yh(te(this,fi),te(this,yn))}with(n,l=void 0){if(it(this,jn),!wr(n))throw new TypeError("invalid zoned-date-time-like");bg(n);const d=te(this,At),m=te(this,fi),_=Yh(m,te(this,yn)),v=Au(this);let c={...Js(d,v.isoDate),...v.time,offset:Hb(_)};c=_p(d,c,sl(d,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset"],"partial"));const C=Jt(l),R=Xy(C),z=L0(C,"prefer"),B=M_(d,c,ti(C)),V=Tg(c.offset);return vs(H0(B.isoDate,B.time,"option",V,m,R,z,!1),m,d)}withPlainTime(n=void 0){it(this,jn);const l=te(this,fi),d=te(this,At),m=Au(this).isoDate;let _;return _=n===void 0?tf(l,m):xs(l,ri(m,te(rf(n),xr)),"compatible"),vs(_,l,d)}withTimeZone(n){it(this,jn);const l=Ks(n);return vs(te(this,yn),l,te(this,At))}withCalendar(n){it(this,jn);const l=D_(n);return vs(te(this,yn),te(this,fi),l)}add(n,l=void 0){return it(this,jn),Ww("add",this,n,l)}subtract(n,l=void 0){return it(this,jn),Ww("subtract",this,n,l)}until(n,l=void 0){return it(this,jn),Gw("until",this,n,l)}since(n,l=void 0){return it(this,jn),Gw("since",this,n,l)}round(n){if(it(this,jn),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?wp("smallestUnit",n):Jt(n),d=xg(l),m=Pc(l,"halfExpand"),_=Ao(l,"smallestUnit","time",rd,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];if(wg(d,v,v===1),_==="nanosecond"&&d===1)return vs(te(this,yn),te(this,fi),te(this,At));const c=te(this,fi),C=te(this,yn),R=Au(this);let z;if(_==="day"){const B=R.isoDate,V=Do(B.year,B.month,B.day+1),G=tf(c,B),re=tf(c,V),fe=W.subtract(re,G);z=Bn.fromEpochNsDiff(C,G).round(fe,m).addToEpochNs(G)}else{const B=ex(R,d,_,m),V=Yh(c,C);z=H0(B.isoDate,B.time,"option",V,c,"compatible","prefer",!1)}return vs(z,c,te(this,At))}equals(n){it(this,jn);const l=By(n),d=te(this,yn),m=te(l,yn);return!!W.equal(W.BigInt(d),W.BigInt(m))&&!!LS(te(this,fi),te(l,fi))&&Ou(te(this,At),te(l,At))}toString(n=void 0){it(this,jn);const l=Jt(n),d=T_(l),m=S_(l),_=function(V){return Jh(V,"offset",["auto","never"],"auto")}(l),v=Pc(l,"trunc"),c=Ao(l,"smallestUnit","time",void 0);if(c==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const C=function(V){return Jh(V,"timeZoneName",["auto","never","critical"],"auto")}(l),{precision:R,unit:z,increment:B}=E_(c,m);return Nw(this,R,d,C,_,{unit:z,increment:B,roundingMode:v})}toLocaleString(n=void 0,l=void 0){it(this,jn);const d=Jt(l),m=Object.create(null);if(function(C,R,z,B){if(R==null)return;const V=Reflect.ownKeys(R);for(let G=0;G<V.length;G++){const re=V[G];if(!z.some(fe=>Object.is(fe,re))&&Object.prototype.propertyIsEnumerable.call(R,re)){const fe=R[re];C[re]=fe}}}(m,d,["timeZone"]),d.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");if(m.year===void 0&&m.month===void 0&&m.day===void 0&&m.era===void 0&&m.weekday===void 0&&m.dateStyle===void 0&&m.hour===void 0&&m.minute===void 0&&m.second===void 0&&m.fractionalSecondDigits===void 0&&m.timeStyle===void 0&&m.dayPeriod===void 0&&m.timeZoneName===void 0&&(m.timeZoneName="short"),m.timeZone=te(this,fi),zw(m.timeZone))throw new RangeError("toLocaleString does not currently support offset time zones");const _=new Pl(n,m),v=k3.call(_).calendar,c=te(this,At);if(c!=="iso8601"&&v!=="iso8601"&&!Ou(v,c))throw new RangeError(`cannot format ZonedDateTime with calendar ${c} in locale with calendar ${v}`);return _.format(Ru(te(this,yn)))}toJSON(){return it(this,jn),Nw(this,"auto")}valueOf(){yf("ZonedDateTime")}startOfDay(){it(this,jn);const n=te(this,fi);return vs(tf(n,Au(this).isoDate),n,te(this,At))}getTimeZoneTransition(n){it(this,jn);const l=te(this,fi);if(n===void 0)throw new TypeError("options parameter is required");const d=Jh(typeof n=="string"?wp("direction",n):Jt(n),"direction",["next","previous"],rd);if(d===void 0)throw new TypeError("direction option is required");if(zw(l)||l==="UTC")return null;const m=te(this,yn),_=d==="next"?Ox(l,m):Wb(l,m);return _===null?null:vs(_,l,te(this,At))}toInstant(){return it(this,jn),Ru(te(this,yn))}toPlainDate(){return it(this,jn),Qs(Au(this).isoDate,te(this,At))}toPlainTime(){return it(this,jn),$h(Au(this).time)}toPlainDateTime(){return it(this,jn),Rl(Au(this),te(this,At))}static from(n,l=void 0){return By(n,l)}static compare(n,l){const d=By(n),m=By(l),_=te(d,yn),v=te(m,yn);return W.lessThan(W.BigInt(_),W.BigInt(v))?-1:W.greaterThan(W.BigInt(_),W.BigInt(v))?1:0}}function Au(i){return Ol(te(i,fi),te(i,yn))}function Us(i,n){it(i,jn);const l=Au(i).isoDate;return A_(i).isoToDate(l,{[n]:!0})[n]}function Ym(i,n){return it(i,jn),Au(i).time[n]}ld(Wx,"Temporal.ZonedDateTime");var Jw=Object.freeze({__proto__:null,Duration:pg,Instant:$x,Now:lE,PlainDate:Yx,PlainDateTime:qx,PlainMonthDay:Hx,PlainTime:z_,PlainYearMonth:Xx,ZonedDateTime:Wx});const R3=[$x,Yx,qx,pg,Hx,z_,Xx,Wx];for(const i of R3){const n=Object.getOwnPropertyDescriptor(i,"prototype");(n.configurable||n.enumerable||n.writable)&&(n.configurable=!1,n.enumerable=!1,n.writable=!1,Object.defineProperty(i,"prototype",n))}function I3({tripQueryVariables:i,setTripQueryVariables:n}){const l=ce.useContext(v_),d=Jw.Instant.from(i.dateTime).toZonedDateTimeISO(l).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),m=ce.useCallback(_=>{const v=Jw.PlainDateTime.from(_.target.value).toZonedDateTime(l).toString({calendarName:"never",timeZoneName:"never"});n({...i,dateTime:v})},[i,n,l]);return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+l,children:"Time"}),ne.jsx(xi.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:m,value:d})]})}function P3({tripQueryVariables:i,setTripQueryVariables:n}){return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),ne.jsx(xi.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:i.searchWindow||"",onChange:l=>n({...i,searchWindow:Number(l.target.value)>0?Number(l.target.value):void 0})})]})}function N3({tripQueryVariables:i,setTripQueryVariables:n}){return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),ne.jsxs(xi.Select,{id:"accessSelect",size:"sm",className:"input-medium",onChange:l=>{l.target.value!=="not_selected"?n({...i,modes:{...i.modes,accessMode:l.target.value}}):n({...i,modes:i.modes?.directMode||i.modes?.transportModes?{...i.modes,accessMode:void 0}:void 0})},value:i.modes?.accessMode||"not_selected",children:[ne.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(ng).map(l=>ne.jsx("option",{value:l,children:l},l))]})]})}function z3({tripQueryVariables:i,setTripQueryVariables:n}){return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),ne.jsxs(xi.Select,{id:"egressSelect",size:"sm",className:"input-medium",onChange:l=>{l.target.value!=="not_selected"?n({...i,modes:{...i.modes,egressMode:l.target.value}}):n({...i,modes:i.modes?.directMode||i.modes?.transportModes?{...i.modes,egressMode:void 0}:void 0})},value:i.modes?.egressMode||"not_selected",children:[ne.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(ng).map(l=>ne.jsx("option",{value:l,children:l},l))]})]})}function L3({tripQueryVariables:i,setTripQueryVariables:n}){return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),ne.jsxs(xi.Select,{id:"directModeSelect",size:"sm",className:"input-medium",onChange:l=>{l.target.value!=="not_selected"?n({...i,modes:{...i.modes,directMode:l.target.value}}):n({...i,modes:i.modes?.accessMode||i.modes?.egressMode||i.modes?.transportModes?{...i.modes,directMode:void 0}:void 0})},value:i.modes?.directMode||"not_selected",children:[ne.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(ng).map(l=>ne.jsx("option",{value:l,children:l},l))]})]})}const O3=({label:i,options:n,values:l,onChange:d})=>{const[m,_]=ce.useState(!1),v=ce.useRef(null),c=()=>{_(!m)},C=R=>{const z=R.target.value,B=R.target.checked;d(B?[...l,z]:l.filter(V=>V!==z))};return ce.useEffect(()=>{const R=z=>{v.current&&!v.current.contains(z.target)&&_(!1)};return m&&document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[m]),ne.jsxs("div",{className:`dropdown ${m?"show":""}`,ref:v,children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:i}),ne.jsx(xi.Control,{type:"text",id:"multiSelectDropdown",size:"sm",className:"input-medium",value:l.length>0?l.join(", "):"Not selected",onClick:c,onChange:()=>{}}),ne.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${m?"show":""}`,children:n.map(R=>ne.jsx(xi.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${R.id}`,label:R.label,checked:l.includes(R.id),onChange:C,value:`${R.id}`},`${R.id}`))})]})};function j3({tripQueryVariables:i,setTripQueryVariables:n}){const l=ce.useMemo(()=>i?.modes?.transportModes?.map(m=>m?.transportMode).filter(m=>!!m)||[],[i.modes?.transportModes]),d=ce.useCallback(m=>{const _=m.filter(v=>v!=null).map(v=>({transportMode:v}));if(_.length===0){const v={...i.modes};delete v.transportModes;const c=v.directMode||v.accessMode||v.egressMode;n({...i,modes:c?v:void 0})}else{const v=i.modes?.accessMode||ng.Foot,c=i.modes?.egressMode||ng.Foot;n({...i,modes:{...i.modes,transportModes:_,accessMode:v,egressMode:c}})}},[i,n]);return ne.jsx(O3,{label:"Transit mode",options:Object.values(q2).map(m=>({id:m,label:m.toString()})),values:l,onChange:d})}function B3({tripQueryVariables:i,setTripQueryVariables:n}){return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),ne.jsx(xi.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:i.numTripPatterns||"",onChange:l=>n({...i,numTripPatterns:Number(l.target.value)>0?Number(l.target.value):void 0})})]})}function F3({tripQueryVariables:i,setTripQueryVariables:n}){return ne.jsxs(xi.Group,{children:[ne.jsx(xi.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),ne.jsxs(xi.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-medium",onChange:l=>{if(l.target.value==="not_selected"){const d={...i.itineraryFilters};delete d.debug;const m=Object.keys(d).length>0;n({...i,itineraryFilters:m?d:void 0})}else n({...i,itineraryFilters:{...i.itineraryFilters,debug:l.target.value}})},value:i.itineraryFilters?.debug||"not_selected",children:[ne.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(Y2).map(l=>ne.jsx("option",{value:l,children:l},l))]})]})}const U3="https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-25T11:23/assets/graphql-solid-B1mrnAEK.svg",e2="/graphiql?flavor=transmodel";function V3({tripQueryVariables:i}){const n=iS(i),l=encodeURIComponent(JSON.stringify(n)),d=nS(i),m=encodeURIComponent(d),_="Open in GraphiQL",v=e2.includes("?")?"&":"?",c=`${e2}${v}query=${m}&variables=${l}`;return ne.jsx(gp,{title:_,href:c,target:"_blank",children:ne.jsx("img",{alt:_,title:_,src:U3,width:"20",height:"20",className:"d-inline-block align-middle"})})}function G3({tripQueryVariables:i,setTripQueryVariables:n,onRoute:l,loading:d}){return ne.jsxs("div",{className:"box input-group search-bar",children:[ne.jsxs("div",{className:"input-family",children:[ne.jsx(_w,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(SI,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(_w,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:i,setTripQueryVariables:n})]}),ne.jsxs("div",{className:"input-family",children:[ne.jsx(EI,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(I3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ne.jsxs("div",{className:"input-family",children:[ne.jsx(B3,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(P3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ne.jsxs("div",{className:"input-family",children:[ne.jsx(N3,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(j3,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(z3,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx(L3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ne.jsx(F3,{tripQueryVariables:i,setTripQueryVariables:n}),ne.jsx("div",{className:"search-bar-route-button-wrapper",children:ne.jsxs(_x,{children:[ne.jsxs(gp,{variant:"primary",onClick:()=>l(),disabled:d,children:[d&&ne.jsxs(ne.Fragment,{children:[ne.jsx(JT,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),ne.jsx(V3,{tripQueryVariables:i})]})})]})}const cE=ce.createContext(void 0);function Z3(){const i=ce.useContext(cE);if(!i)throw new Error("useTripSchema must be used within a TripSchemaProvider");return i}function xo(i,n){return n.split(".").reduce((l,d)=>{if(l!=null){if(Array.isArray(l)){const m=Number(d);return Number.isNaN(m)?void 0:l[m]}else if(typeof l=="object")return l[d]}},i)}function op(i,n,l){const d=n.split(".");function m(_,v){const c=d[v],C=!isNaN(Number(c));if(v===d.length-1){if(Array.isArray(_)&&C){const V=[..._];return V[Number(c)]=l,V}if(_b(_)&&!C)return{..._,[c]:l};if(C){const V=Array.isArray(_)?[..._]:[];return V[Number(c)]=l,V}else return{..._b(_)?_:{},[c]:l}}const R=v+1,z=d[R],B=!isNaN(Number(z));if(Array.isArray(_)&&C){const V=[..._],G=_[Number(c)];return V[Number(c)]=m(G!==void 0?G:B?[]:{},R),V}else if(_b(_)&&!C){const V={..._},G=_[c];return V[c]=m(G!==void 0?G:B?[]:{},R),V}else if(C){const V=[];return V[Number(c)]=m(B?[]:{},R),V}else return{[c]:m(B?[]:{},R)}}return i==null&&(i=!isNaN(Number(d[0]))?[]:{}),m(i,0)}function _b(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}const $3="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",Y3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",q3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",H3=({defaultValue:i,type:n})=>ne.jsxs("span",{children:[i!=null&&ne.jsx("span",{title:`Default: ${i??"None"}`,children:ne.jsx("img",{alt:"Info",src:$3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="DoubleFunction"&&ne.jsx("span",{title:`Type: ${n.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:ne.jsx("img",{alt:"Info",src:Y3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="Duration"&&ne.jsx("span",{className:"default-tooltip-icon",title:`Type: ${n.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:ne.jsx("img",{alt:"Info",src:q3,className:"default-tooltip-icon"})})]}),uE=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),hE=({tripQueryVariables:i,setTripQueryVariables:n,setExpandedArguments:l})=>{function d(){let m={};uE.forEach(_=>{const v=xo(i,_);v!==void 0&&(m=op(m,_,v))}),n(m),l&&l({})}return ne.jsx("button",{className:"reset-button",onClick:d,children:"Reset"})};function vb(i){if(!i)return" ";const n=i.split(".");return n[n.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,d=>d.toUpperCase())+" "}function O0(i,n=[]){let l=[];return i?(Object.entries(i).forEach(([d,m])=>{const _=[...n,d].join(".");l=l.concat(X3(d,m,_,n))}),l):[]}function X3(i,n,l,d){let m=[];if(typeof n=="object"&&n.type)if(n.type.type==="Enum"){const _=["Not selected",...n.type.values||[]],v=n.defaultValue!==void 0?n.defaultValue:"Not selected";m.push({path:l,type:{type:"Enum"},defaultValue:v,enumValues:_,isList:n.isList})}else n.type.type==="InputObject"&&n.isList?(m.push({path:l,type:{type:"Group",name:n.type.name},defaultValue:n.defaultValue,isComplex:!0,isList:!0}),m=m.concat(O0(n.type.fields,[...d,`${i}.*`]))):n.type.type==="InputObject"?(m.push({path:l,type:{type:"Group",name:n.type.name},isComplex:!0,isList:!1}),m=m.concat(O0(n.type.fields,[...d,i]))):n.type.type==="Scalar"&&m.push({path:l,type:{type:n.type.type,subtype:n.type.subtype},defaultValue:n.defaultValue,isList:n.isList});else typeof n=="object"&&n.type?.fields?(m.push({path:l,type:{type:"Group"},isComplex:!0}),m=m.concat(O0(n.type.fields,[...d,i]))):m.push({path:l,type:n.type??typeof n,defaultValue:n.defaultValue});return m}const W3=({tripQueryVariables:i,setTripQueryVariables:n,expandedArguments:l,setExpandedArguments:d})=>{const[m,_]=ce.useState([]),[v]=ce.useState(""),{tripArgs:c,loading:C,error:R}=Z3();ce.useEffect(()=>{if(!c||C||R)return;const Je=O0(c.trip.arguments);_(Je)},[c,C,R]);function z(Je){return Je.replace(/\.\d+/g,".*")}function B(Je,Mt){const Ne=z(Je),Xe=m.find(Rt=>Rt.path===Ne);if(!Xe){console.error(`No matching argumentConfig found for path: ${Je}`);return}if(Xe.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Xe.type.subtype)&&Xe.isList&&typeof Mt=="string"){const Rt=Mt.split(",").map(un=>un.trim());let Ut=op(i,Je,Rt);Ut=re(Ut,Je),n(Ut);return}let _t=op(i,Je,Mt);_t=re(_t,Je),n(_t)}function V(Je){return typeof Je=="object"&&Je!==null&&!Array.isArray(Je)}function G(Je){return Je==null?!0:Array.isArray(Je)?Je.length===0:V(Je)?Object.values(Je).every(G):!1}function re(Je,Mt){if(!Mt.includes(".")){const Xe=xo(Je,Mt);if(G(Xe)){const _t={...Je};return delete _t[Mt],_t}return Je}const Ne=Mt.split(".");for(let Xe=Ne.length-1;Xe>0;Xe--){const _t=Ne.slice(0,Xe).join("."),Rt=xo(Je,_t);G(Rt)&&(Je=op(Je,_t,void 0))}return Je}function fe(Je){d({...l,[Je]:!l[Je]})}function pe(){d({})}const Ie=m.filter(({path:Je})=>vb(Je).toLowerCase().includes(v.toLowerCase())).filter(({path:Je})=>!uE.has(Je));function Ge(Je,Mt,Ne,Xe){const _t=xo(i,Je)??[],Rt=Xe.name;return ne.jsxs("div",{children:[_t.map((Ut,un)=>{const Ht=`${Je}.${un}`,Ue=Mt.filter(It=>It.path.startsWith(`${Je}.*.`)&&It.path!==`${Je}.*`).map(It=>({...It,path:It.path.replace(`${Je}.*`,Ht)})),ft=Ue.filter(It=>It.path.split(".").length===Ht.split(".").length+1),Dt=l[Ht];return ne.jsxs("div",{style:{marginLeft:15},children:[ne.jsxs("span",{style:{cursor:"pointer"},onClick:()=>fe(Ht),children:[Dt?"▼ ":"▶ "," [#",un+1,"]"]}),ne.jsx("button",{style:{marginLeft:10},onClick:()=>He(Je,un),children:"Remove"}),Dt&&ne.jsx("div",{style:{marginLeft:20},children:rt(ft,Ne+1,Ue)})]},Ht)}),ne.jsxs("button",{onClick:()=>je(Je),children:["+ Add ",Rt]})]})}function je(Je){const Ne=[...xo(i,Je)??[],{}],Xe=op(i,Je,Ne);n(Xe)}function He(Je,Mt){const Xe=(xo(i,Je)??[]).filter((Rt,Ut)=>Ut!==Mt);let _t=op(i,Je,Xe);_t=re(_t,Je),n(_t)}function Ve(Je){let Mt=op(i,Je,void 0);Mt=re(Mt,Je),n(Mt)}function rt(Je,Mt,Ne){return Je.map(({path:Xe,type:_t,defaultValue:Rt,enumValues:Ut,isComplex:un,isList:Ht})=>{const Ue=l[Xe],ft=Xe.split(".").length,Dt=Ne.filter(be=>{const et=be.path.split(".").length;return be.path.startsWith(`${Xe}.`)&&be.path!==Xe&&et===ft+1}),It=Mt+1;return ne.jsx("div",{style:{marginLeft:`${Mt*15}px`,marginBottom:"10px"},children:un?ne.jsxs("div",{children:[ne.jsxs("span",{style:{cursor:"pointer"},onClick:()=>fe(Xe),children:[Ue?"▼ ":"▶ "," ",vb(Xe)]}),Ue&&Ht?ne.jsx("div",{style:{marginLeft:20},children:Ge(Xe,Ne,It,_t)}):Ue?rt(Dt,It,Ne):null]}):ne.jsxs("div",{children:[ne.jsxs("label",{className:"argument-label",htmlFor:Xe,children:[vb(Xe)," ",ne.jsx(H3,{defaultValue:Rt,type:_t})]}),_t.subtype==="Boolean"&&(()=>{const be=xo(i,Xe),et=be!==void 0;return ne.jsxs("span",{children:[ne.jsx("input",{type:"checkbox",id:Xe,checked:be??!1,onChange:Et=>B(Xe,Et.target.checked)}),et&&ne.jsx("button",{onClick:()=>Ve(Xe),className:"remove-argument",style:{fontSize:"10px",paddingTop:"2px",marginLeft:"8px",marginBottom:"0px",marginTop:"-5px",height:"14px",width:"45px",verticalAlign:"middle"},children:"Clear"})]})})(),_t.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(_t.subtype)&&Ht&&ne.jsx("input",{className:"comma-separated-input",type:"text",id:Xe,value:(()=>{const be=xo(i,Xe);return Array.isArray(be)?be.join(", "):""})(),onChange:be=>B(Xe,be.target.value),placeholder:"Comma-separated list"}),_t.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(_t.subtype)&&!Ht&&ne.jsx("input",{type:"text",id:Xe,value:xo(i,Xe)??"",onChange:be=>B(Xe,be.target.value||void 0)}),_t.subtype==="Int"&&ne.jsx("input",{type:"number",id:Xe,value:xo(i,Xe)??"",onChange:be=>{const et=parseInt(be.target.value,10);B(Xe,Number.isNaN(et)?void 0:et)}}),_t.subtype==="Float"&&ne.jsx("input",{type:"number",id:Xe,step:"any",value:xo(i,Xe)??"",onChange:be=>{const et=parseFloat(be.target.value);B(Xe,Number.isNaN(et)?void 0:et)}}),_t.subtype==="DateTime"&&ne.jsx("input",{type:"datetime-local",id:Xe,value:(xo(i,Xe)??"").slice(0,16),onChange:be=>{const et=be.target.value?new Date(be.target.value).toISOString():void 0;B(Xe,et)}}),_t.type==="Enum"&&Ut&&Ht&&ne.jsx("select",{id:Xe,multiple:!0,value:(()=>{const be=xo(i,Xe);return Array.isArray(be)?be:[]})(),onChange:be=>{const et=Array.from(be.target.selectedOptions,Et=>Et.value);B(Xe,et)},children:Ut.map(be=>ne.jsx("option",{value:be,children:be},be))}),_t.type==="Enum"&&Ut&&!Ht&&ne.jsx("select",{id:Xe,value:xo(i,Xe)??"Not selected",onChange:be=>{const et=be.target.value==="Not selected"?void 0:be.target.value;B(Xe,et)},children:Ut.map(be=>ne.jsx("option",{value:be,children:be},be))})]})},Xe)})}return ne.jsxs("div",{className:"left-pane-container below-content",children:[ne.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",position:"relative"},children:[ne.jsx("button",{className:"collapse-all-button",onClick:pe,style:{padding:"4px 8px"},children:"Collapse all"}),ne.jsx("span",{className:"panel-header-title-with-left-button",children:"Arguments"}),ne.jsx("div",{style:{marginLeft:"auto"},children:ne.jsx(hE,{tripQueryVariables:i,setTripQueryVariables:n,setExpandedArguments:d})})]}),Ie.length===0?ne.jsx("p",{children:"No arguments found."}):ne.jsx("div",{className:"argument-list",children:rt(Ie.filter(Je=>Je.path.split(".").length===1),0,Ie)})]})},Q3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",K3="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",J3="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",eP=({children:i})=>{const[n,l]=ce.useState(0),d=_=>{switch(_){case 0:return ne.jsx("img",{src:Q3,alt:"Itinerary results",title:"Itinerary results"});case 1:return ne.jsx("img",{src:K3,alt:"Arguments",title:"Arguments"});case 2:return ne.jsx("img",{width:"25",height:"25",src:J3,alt:"Arguments raw",title:"Arguments raw"});default:return null}},m=kl.Children.toArray(i).filter(_=>kl.isValidElement(_));return ne.jsxs("div",{className:"sidebar-container",children:[ne.jsx("div",{className:"sidebar",children:m.map((_,v)=>ne.jsx("div",{className:`sidebar-button ${v===n?"active":""}`,onClick:()=>l(v),children:d(v)},v))}),ne.jsx("div",{className:"sidebar-content",children:m.map((_,v)=>v===n?ne.jsx("div",{children:_},v):null)})]})},tP=({tripQueryVariables:i,setTripQueryVariables:n,setExpandedArguments:l})=>ne.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[ne.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",position:"relative"},children:[ne.jsx("span",{className:"panel-header-title-simple",children:"Arguments raw"}),ne.jsx("div",{style:{marginLeft:"auto"},children:ne.jsx(hE,{tripQueryVariables:i,setTripQueryVariables:n,setExpandedArguments:l})})]}),ne.jsx("pre",{children:JSON.stringify(i,null,2)})]});function nP(i){let n=i;for(;;)if(Hh(n))n=n.ofType;else if(ff(n))n=n.ofType;else break;return n}function dE(i){const n=nP(i);if(yg(n))return{type:"Scalar",subtype:n.name};if(lf(n))return{type:"Enum",values:n.getValues().map(l=>l.name)};if(qh(n)){const l=n.getFields(),d={};for(const m of Object.keys(l)){const _=l[m];if(_.deprecationReason)continue;const v=ff(_.type),c=_.defaultValue!==void 0?_.defaultValue:null;d[m]={type:dE(_.type),defaultValue:c,isList:v}}return{type:"InputObject",name:n.name,fields:d}}return{type:"Scalar",subtype:"String"}}function iP(i){const n=i.getQueryType();if(!n)throw new Error("No Query type found in the schema.");const l=n.getFields().trip;if(!l)throw new Error("No trip query found in the schema.");const d={};return l.args.forEach(m=>{if(m.deprecationReason)return;const _=m.name,v=dE(m.type),c=m.defaultValue!==null?m.defaultValue:null,C=ff(m.type);d[_]={type:v,...c!==null&&{defaultValue:c},isList:C}}),{trip:{arguments:d}}}async function rP(i){const n=wM(),l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!l.ok)throw new Error(`Failed to fetch schema. HTTP error: ${l.status}`);const{data:d}=await l.json(),m=TM(d);return iP(m)}function aP({endpoint:i,children:n}){const[l,d]=ce.useState(null),[m,_]=ce.useState(!0),[v,c]=ce.useState(null);ce.useEffect(()=>{let R=!0;async function z(){_(!0),c(null);try{const B=await rP(i);R&&d(B)}catch(B){console.error("Error loading trip arguments:",B),R&&c("Failed to load trip schema")}finally{R&&_(!1)}}return z(),()=>{R=!1}},[i]);const C={tripArgs:l,loading:m,error:v};return ne.jsx(cE.Provider,{value:C,children:n})}function sP(){const i=dI(),{tripQueryVariables:n,setTripQueryVariables:l}=gI(),[d,m,_,v]=uI(n),[c,C]=ce.useState([0]),[R,z]=ce.useState({}),B=i?.internalTransitModelTimeZone||Intl.DateTimeFormat().resolvedOptions().timeZone;return ce.useEffect(()=>{d?.trip.tripPatterns.length&&C([0])},[d]),ne.jsx("div",{className:"app",children:ne.jsx(v_.Provider,{value:B,children:ne.jsxs("div",{className:"layout",children:[ne.jsx("div",{className:"box logo-section",children:ne.jsx(vI,{serverInfo:i})}),ne.jsx("div",{className:"box input-section",children:ne.jsx(G3,{onRoute:_,tripQueryVariables:n,setTripQueryVariables:l,loading:m})}),ne.jsx("div",{className:"box trip-section",children:ne.jsxs(eP,{children:[ne.jsx(sI,{tripQueryResult:d,selectedTripPatternIndexes:c,setSelectedTripPatternIndexes:C,pageResults:_,loading:m,error:v}),ne.jsx(aP,{endpoint:lv(),children:ne.jsx(W3,{tripQueryVariables:n,setTripQueryVariables:l,expandedArguments:R,setExpandedArguments:z})}),ne.jsx(tP,{tripQueryVariables:n,setTripQueryVariables:l,setExpandedArguments:z})]})}),ne.jsx("div",{className:"box map-section",children:ne.jsx(oR,{tripQueryResult:d,tripQueryVariables:n,setTripQueryVariables:l,selectedTripPatternIndexes:c,loading:m})})]})})})}AE.createRoot(document.getElementById("root")).render(ne.jsx(kl.StrictMode,{children:ne.jsx(sP,{})}));
