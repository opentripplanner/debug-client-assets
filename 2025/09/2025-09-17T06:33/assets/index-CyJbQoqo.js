function sE(i,n){for(var l=0;l<n.length;l++){const d=n[l];if(typeof d!="string"&&!Array.isArray(d)){for(const m in d)if(m!=="default"&&!(m in i)){const _=Object.getOwnPropertyDescriptor(d,m);_&&Object.defineProperty(i,m,_.get?_:{enumerable:!0,get:()=>d[m]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))d(m);new MutationObserver(m=>{for(const _ of m)if(_.type==="childList")for(const v of _.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&d(v)}).observe(document,{childList:!0,subtree:!0});function l(m){const _={};return m.integrity&&(_.integrity=m.integrity),m.referrerPolicy&&(_.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?_.credentials="include":m.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function d(m){if(m.ep)return;m.ep=!0;const _=l(m);fetch(m.href,_)}})();function Lp(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Gv={exports:{}},by={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xx;function oE(){if(Xx)return by;Xx=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function l(d,m,_){var v=null;if(_!==void 0&&(v=""+_),m.key!==void 0&&(v=""+m.key),"key"in m){_={};for(var c in m)c!=="key"&&(_[c]=m[c])}else _=m;return m=_.ref,{$$typeof:i,type:d,key:v,ref:m!==void 0?m:null,props:_}}return by.Fragment=n,by.jsx=l,by.jsxs=l,by}var Wx;function lE(){return Wx||(Wx=1,Gv.exports=oE()),Gv.exports}var ie=lE(),Zv={exports:{}},Cn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qx;function cE(){if(Qx)return Cn;Qx=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),v=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),B=Symbol.iterator;function V(Ee){return Ee===null||typeof Ee!="object"?null:(Ee=B&&Ee[B]||Ee["@@iterator"],typeof Ee=="function"?Ee:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ae=Object.assign,me={};function pe(Ee,nt,Ct){this.props=Ee,this.context=nt,this.refs=me,this.updater=Ct||G}pe.prototype.isReactComponent={},pe.prototype.setState=function(Ee,nt){if(typeof Ee!="object"&&typeof Ee!="function"&&Ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ee,nt,"setState")},pe.prototype.forceUpdate=function(Ee){this.updater.enqueueForceUpdate(this,Ee,"forceUpdate")};function Ne(){}Ne.prototype=pe.prototype;function Ve(Ee,nt,Ct){this.props=Ee,this.context=nt,this.refs=me,this.updater=Ct||G}var Fe=Ve.prototype=new Ne;Fe.constructor=Ve,ae(Fe,pe.prototype),Fe.isPureReactComponent=!0;var qe=Array.isArray,Ae={H:null,A:null,T:null,S:null,V:null},Ke=Object.prototype.hasOwnProperty;function mt(Ee,nt,Ct,bt,Pt,Xt){return Ct=Xt.ref,{$$typeof:i,type:Ee,key:nt,ref:Ct!==void 0?Ct:null,props:Xt}}function st(Ee,nt){return mt(Ee.type,nt,void 0,void 0,void 0,Ee.props)}function Pe(Ee){return typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===i}function rt(Ee){var nt={"=":"=0",":":"=2"};return"$"+Ee.replace(/[=:]/g,function(Ct){return nt[Ct]})}var Mt=/\/+/g;function Rt(Ee,nt){return typeof Ee=="object"&&Ee!==null&&Ee.key!=null?rt(""+Ee.key):nt.toString(36)}function jt(){}function en(Ee){switch(Ee.status){case"fulfilled":return Ee.value;case"rejected":throw Ee.reason;default:switch(typeof Ee.status=="string"?Ee.then(jt,jt):(Ee.status="pending",Ee.then(function(nt){Ee.status==="pending"&&(Ee.status="fulfilled",Ee.value=nt)},function(nt){Ee.status==="pending"&&(Ee.status="rejected",Ee.reason=nt)})),Ee.status){case"fulfilled":return Ee.value;case"rejected":throw Ee.reason}}throw Ee}function ln(Ee,nt,Ct,bt,Pt){var Xt=typeof Ee;(Xt==="undefined"||Xt==="boolean")&&(Ee=null);var Bt=!1;if(Ee===null)Bt=!0;else switch(Xt){case"bigint":case"string":case"number":Bt=!0;break;case"object":switch(Ee.$$typeof){case i:case n:Bt=!0;break;case N:return Bt=Ee._init,ln(Bt(Ee._payload),nt,Ct,bt,Pt)}}if(Bt)return Pt=Pt(Ee),Bt=bt===""?"."+Rt(Ee,0):bt,qe(Pt)?(Ct="",Bt!=null&&(Ct=Bt.replace(Mt,"$&/")+"/"),ln(Pt,nt,Ct,"",function(mi){return mi})):Pt!=null&&(Pe(Pt)&&(Pt=st(Pt,Ct+(Pt.key==null||Ee&&Ee.key===Pt.key?"":(""+Pt.key).replace(Mt,"$&/")+"/")+Bt)),nt.push(Pt)),1;Bt=0;var Ei=bt===""?".":bt+":";if(qe(Ee))for(var mn=0;mn<Ee.length;mn++)bt=Ee[mn],Xt=Ei+Rt(bt,mn),Bt+=ln(bt,nt,Ct,Xt,Pt);else if(mn=V(Ee),typeof mn=="function")for(Ee=mn.call(Ee),mn=0;!(bt=Ee.next()).done;)bt=bt.value,Xt=Ei+Rt(bt,mn++),Bt+=ln(bt,nt,Ct,Xt,Pt);else if(Xt==="object"){if(typeof Ee.then=="function")return ln(en(Ee),nt,Ct,bt,Pt);throw nt=String(Ee),Error("Objects are not valid as a React child (found: "+(nt==="[object Object]"?"object with keys {"+Object.keys(Ee).join(", ")+"}":nt)+"). If you meant to render a collection of children, use an array instead.")}return Bt}function Ge(Ee,nt,Ct){if(Ee==null)return Ee;var bt=[],Pt=0;return ln(Ee,bt,"","",function(Xt){return nt.call(Ct,Xt,Pt++)}),bt}function ct(Ee){if(Ee._status===-1){var nt=Ee._result;nt=nt(),nt.then(function(Ct){(Ee._status===0||Ee._status===-1)&&(Ee._status=1,Ee._result=Ct)},function(Ct){(Ee._status===0||Ee._status===-1)&&(Ee._status=2,Ee._result=Ct)}),Ee._status===-1&&(Ee._status=0,Ee._result=nt)}if(Ee._status===1)return Ee._result.default;throw Ee._result}var ht=typeof reportError=="function"?reportError:function(Ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var nt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ee=="object"&&Ee!==null&&typeof Ee.message=="string"?String(Ee.message):String(Ee),error:Ee});if(!window.dispatchEvent(nt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ee);return}console.error(Ee)};function kt(){}return Cn.Children={map:Ge,forEach:function(Ee,nt,Ct){Ge(Ee,function(){nt.apply(this,arguments)},Ct)},count:function(Ee){var nt=0;return Ge(Ee,function(){nt++}),nt},toArray:function(Ee){return Ge(Ee,function(nt){return nt})||[]},only:function(Ee){if(!Pe(Ee))throw Error("React.Children.only expected to receive a single React element child.");return Ee}},Cn.Component=pe,Cn.Fragment=l,Cn.Profiler=m,Cn.PureComponent=Ve,Cn.StrictMode=d,Cn.Suspense=C,Cn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ae,Cn.__COMPILER_RUNTIME={__proto__:null,c:function(Ee){return Ae.H.useMemoCache(Ee)}},Cn.cache=function(Ee){return function(){return Ee.apply(null,arguments)}},Cn.cloneElement=function(Ee,nt,Ct){if(Ee==null)throw Error("The argument must be a React element, but you passed "+Ee+".");var bt=ae({},Ee.props),Pt=Ee.key,Xt=void 0;if(nt!=null)for(Bt in nt.ref!==void 0&&(Xt=void 0),nt.key!==void 0&&(Pt=""+nt.key),nt)!Ke.call(nt,Bt)||Bt==="key"||Bt==="__self"||Bt==="__source"||Bt==="ref"&&nt.ref===void 0||(bt[Bt]=nt[Bt]);var Bt=arguments.length-2;if(Bt===1)bt.children=Ct;else if(1<Bt){for(var Ei=Array(Bt),mn=0;mn<Bt;mn++)Ei[mn]=arguments[mn+2];bt.children=Ei}return mt(Ee.type,Pt,void 0,void 0,Xt,bt)},Cn.createContext=function(Ee){return Ee={$$typeof:v,_currentValue:Ee,_currentValue2:Ee,_threadCount:0,Provider:null,Consumer:null},Ee.Provider=Ee,Ee.Consumer={$$typeof:_,_context:Ee},Ee},Cn.createElement=function(Ee,nt,Ct){var bt,Pt={},Xt=null;if(nt!=null)for(bt in nt.key!==void 0&&(Xt=""+nt.key),nt)Ke.call(nt,bt)&&bt!=="key"&&bt!=="__self"&&bt!=="__source"&&(Pt[bt]=nt[bt]);var Bt=arguments.length-2;if(Bt===1)Pt.children=Ct;else if(1<Bt){for(var Ei=Array(Bt),mn=0;mn<Bt;mn++)Ei[mn]=arguments[mn+2];Pt.children=Ei}if(Ee&&Ee.defaultProps)for(bt in Bt=Ee.defaultProps,Bt)Pt[bt]===void 0&&(Pt[bt]=Bt[bt]);return mt(Ee,Xt,void 0,void 0,null,Pt)},Cn.createRef=function(){return{current:null}},Cn.forwardRef=function(Ee){return{$$typeof:c,render:Ee}},Cn.isValidElement=Pe,Cn.lazy=function(Ee){return{$$typeof:N,_payload:{_status:-1,_result:Ee},_init:ct}},Cn.memo=function(Ee,nt){return{$$typeof:R,type:Ee,compare:nt===void 0?null:nt}},Cn.startTransition=function(Ee){var nt=Ae.T,Ct={};Ae.T=Ct;try{var bt=Ee(),Pt=Ae.S;Pt!==null&&Pt(Ct,bt),typeof bt=="object"&&bt!==null&&typeof bt.then=="function"&&bt.then(kt,ht)}catch(Xt){ht(Xt)}finally{Ae.T=nt}},Cn.unstable_useCacheRefresh=function(){return Ae.H.useCacheRefresh()},Cn.use=function(Ee){return Ae.H.use(Ee)},Cn.useActionState=function(Ee,nt,Ct){return Ae.H.useActionState(Ee,nt,Ct)},Cn.useCallback=function(Ee,nt){return Ae.H.useCallback(Ee,nt)},Cn.useContext=function(Ee){return Ae.H.useContext(Ee)},Cn.useDebugValue=function(){},Cn.useDeferredValue=function(Ee,nt){return Ae.H.useDeferredValue(Ee,nt)},Cn.useEffect=function(Ee,nt,Ct){var bt=Ae.H;if(typeof Ct=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return bt.useEffect(Ee,nt)},Cn.useId=function(){return Ae.H.useId()},Cn.useImperativeHandle=function(Ee,nt,Ct){return Ae.H.useImperativeHandle(Ee,nt,Ct)},Cn.useInsertionEffect=function(Ee,nt){return Ae.H.useInsertionEffect(Ee,nt)},Cn.useLayoutEffect=function(Ee,nt){return Ae.H.useLayoutEffect(Ee,nt)},Cn.useMemo=function(Ee,nt){return Ae.H.useMemo(Ee,nt)},Cn.useOptimistic=function(Ee,nt){return Ae.H.useOptimistic(Ee,nt)},Cn.useReducer=function(Ee,nt,Ct){return Ae.H.useReducer(Ee,nt,Ct)},Cn.useRef=function(Ee){return Ae.H.useRef(Ee)},Cn.useState=function(Ee){return Ae.H.useState(Ee)},Cn.useSyncExternalStore=function(Ee,nt,Ct){return Ae.H.useSyncExternalStore(Ee,nt,Ct)},Cn.useTransition=function(){return Ae.H.useTransition()},Cn.version="19.1.1",Cn}var Kx;function rx(){return Kx||(Kx=1,Zv.exports=cE()),Zv.exports}var ce=rx();const Ul=Lp(ce);var $v={exports:{}},xy={},Yv={exports:{}},qv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx;function uE(){return Jx||(Jx=1,function(i){function n(Ge,ct){var ht=Ge.length;Ge.push(ct);e:for(;0<ht;){var kt=ht-1>>>1,Ee=Ge[kt];if(0<m(Ee,ct))Ge[kt]=ct,Ge[ht]=Ee,ht=kt;else break e}}function l(Ge){return Ge.length===0?null:Ge[0]}function d(Ge){if(Ge.length===0)return null;var ct=Ge[0],ht=Ge.pop();if(ht!==ct){Ge[0]=ht;e:for(var kt=0,Ee=Ge.length,nt=Ee>>>1;kt<nt;){var Ct=2*(kt+1)-1,bt=Ge[Ct],Pt=Ct+1,Xt=Ge[Pt];if(0>m(bt,ht))Pt<Ee&&0>m(Xt,bt)?(Ge[kt]=Xt,Ge[Pt]=ht,kt=Pt):(Ge[kt]=bt,Ge[Ct]=ht,kt=Ct);else if(Pt<Ee&&0>m(Xt,ht))Ge[kt]=Xt,Ge[Pt]=ht,kt=Pt;else break e}}return ct}function m(Ge,ct){var ht=Ge.sortIndex-ct.sortIndex;return ht!==0?ht:Ge.id-ct.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;i.unstable_now=function(){return _.now()}}else{var v=Date,c=v.now();i.unstable_now=function(){return v.now()-c}}var C=[],R=[],N=1,B=null,V=3,G=!1,ae=!1,me=!1,pe=!1,Ne=typeof setTimeout=="function"?setTimeout:null,Ve=typeof clearTimeout=="function"?clearTimeout:null,Fe=typeof setImmediate<"u"?setImmediate:null;function qe(Ge){for(var ct=l(R);ct!==null;){if(ct.callback===null)d(R);else if(ct.startTime<=Ge)d(R),ct.sortIndex=ct.expirationTime,n(C,ct);else break;ct=l(R)}}function Ae(Ge){if(me=!1,qe(Ge),!ae)if(l(C)!==null)ae=!0,Ke||(Ke=!0,Rt());else{var ct=l(R);ct!==null&&ln(Ae,ct.startTime-Ge)}}var Ke=!1,mt=-1,st=5,Pe=-1;function rt(){return pe?!0:!(i.unstable_now()-Pe<st)}function Mt(){if(pe=!1,Ke){var Ge=i.unstable_now();Pe=Ge;var ct=!0;try{e:{ae=!1,me&&(me=!1,Ve(mt),mt=-1),G=!0;var ht=V;try{t:{for(qe(Ge),B=l(C);B!==null&&!(B.expirationTime>Ge&&rt());){var kt=B.callback;if(typeof kt=="function"){B.callback=null,V=B.priorityLevel;var Ee=kt(B.expirationTime<=Ge);if(Ge=i.unstable_now(),typeof Ee=="function"){B.callback=Ee,qe(Ge),ct=!0;break t}B===l(C)&&d(C),qe(Ge)}else d(C);B=l(C)}if(B!==null)ct=!0;else{var nt=l(R);nt!==null&&ln(Ae,nt.startTime-Ge),ct=!1}}break e}finally{B=null,V=ht,G=!1}ct=void 0}}finally{ct?Rt():Ke=!1}}}var Rt;if(typeof Fe=="function")Rt=function(){Fe(Mt)};else if(typeof MessageChannel<"u"){var jt=new MessageChannel,en=jt.port2;jt.port1.onmessage=Mt,Rt=function(){en.postMessage(null)}}else Rt=function(){Ne(Mt,0)};function ln(Ge,ct){mt=Ne(function(){Ge(i.unstable_now())},ct)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ge){Ge.callback=null},i.unstable_forceFrameRate=function(Ge){0>Ge||125<Ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):st=0<Ge?Math.floor(1e3/Ge):5},i.unstable_getCurrentPriorityLevel=function(){return V},i.unstable_next=function(Ge){switch(V){case 1:case 2:case 3:var ct=3;break;default:ct=V}var ht=V;V=ct;try{return Ge()}finally{V=ht}},i.unstable_requestPaint=function(){pe=!0},i.unstable_runWithPriority=function(Ge,ct){switch(Ge){case 1:case 2:case 3:case 4:case 5:break;default:Ge=3}var ht=V;V=Ge;try{return ct()}finally{V=ht}},i.unstable_scheduleCallback=function(Ge,ct,ht){var kt=i.unstable_now();switch(typeof ht=="object"&&ht!==null?(ht=ht.delay,ht=typeof ht=="number"&&0<ht?kt+ht:kt):ht=kt,Ge){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ht+Ee,Ge={id:N++,callback:ct,priorityLevel:Ge,startTime:ht,expirationTime:Ee,sortIndex:-1},ht>kt?(Ge.sortIndex=ht,n(R,Ge),l(C)===null&&Ge===l(R)&&(me?(Ve(mt),mt=-1):me=!0,ln(Ae,ht-kt))):(Ge.sortIndex=Ee,n(C,Ge),ae||G||(ae=!0,Ke||(Ke=!0,Rt()))),Ge},i.unstable_shouldYield=rt,i.unstable_wrapCallback=function(Ge){var ct=V;return function(){var ht=V;V=ct;try{return Ge.apply(this,arguments)}finally{V=ht}}}}(qv)),qv}var e1;function hE(){return e1||(e1=1,Yv.exports=uE()),Yv.exports}var Hv={exports:{}},ys={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function dE(){if(t1)return ys;t1=1;var i=rx();function n(C){var R="https://react.dev/errors/"+C;if(1<arguments.length){R+="?args[]="+encodeURIComponent(arguments[1]);for(var N=2;N<arguments.length;N++)R+="&args[]="+encodeURIComponent(arguments[N])}return"Minified React error #"+C+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var d={d:{f:l,r:function(){throw Error(n(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},m=Symbol.for("react.portal");function _(C,R,N){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m,key:B==null?null:""+B,children:C,containerInfo:R,implementation:N}}var v=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(C,R){if(C==="font")return"";if(typeof R=="string")return R==="use-credentials"?R:""}return ys.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=d,ys.createPortal=function(C,R){var N=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!R||R.nodeType!==1&&R.nodeType!==9&&R.nodeType!==11)throw Error(n(299));return _(C,R,null,N)},ys.flushSync=function(C){var R=v.T,N=d.p;try{if(v.T=null,d.p=2,C)return C()}finally{v.T=R,d.p=N,d.d.f()}},ys.preconnect=function(C,R){typeof C=="string"&&(R?(R=R.crossOrigin,R=typeof R=="string"?R==="use-credentials"?R:"":void 0):R=null,d.d.C(C,R))},ys.prefetchDNS=function(C){typeof C=="string"&&d.d.D(C)},ys.preinit=function(C,R){if(typeof C=="string"&&R&&typeof R.as=="string"){var N=R.as,B=c(N,R.crossOrigin),V=typeof R.integrity=="string"?R.integrity:void 0,G=typeof R.fetchPriority=="string"?R.fetchPriority:void 0;N==="style"?d.d.S(C,typeof R.precedence=="string"?R.precedence:void 0,{crossOrigin:B,integrity:V,fetchPriority:G}):N==="script"&&d.d.X(C,{crossOrigin:B,integrity:V,fetchPriority:G,nonce:typeof R.nonce=="string"?R.nonce:void 0})}},ys.preinitModule=function(C,R){if(typeof C=="string")if(typeof R=="object"&&R!==null){if(R.as==null||R.as==="script"){var N=c(R.as,R.crossOrigin);d.d.M(C,{crossOrigin:N,integrity:typeof R.integrity=="string"?R.integrity:void 0,nonce:typeof R.nonce=="string"?R.nonce:void 0})}}else R==null&&d.d.M(C)},ys.preload=function(C,R){if(typeof C=="string"&&typeof R=="object"&&R!==null&&typeof R.as=="string"){var N=R.as,B=c(N,R.crossOrigin);d.d.L(C,N,{crossOrigin:B,integrity:typeof R.integrity=="string"?R.integrity:void 0,nonce:typeof R.nonce=="string"?R.nonce:void 0,type:typeof R.type=="string"?R.type:void 0,fetchPriority:typeof R.fetchPriority=="string"?R.fetchPriority:void 0,referrerPolicy:typeof R.referrerPolicy=="string"?R.referrerPolicy:void 0,imageSrcSet:typeof R.imageSrcSet=="string"?R.imageSrcSet:void 0,imageSizes:typeof R.imageSizes=="string"?R.imageSizes:void 0,media:typeof R.media=="string"?R.media:void 0})}},ys.preloadModule=function(C,R){if(typeof C=="string")if(R){var N=c(R.as,R.crossOrigin);d.d.m(C,{as:typeof R.as=="string"&&R.as!=="script"?R.as:void 0,crossOrigin:N,integrity:typeof R.integrity=="string"?R.integrity:void 0})}else d.d.m(C)},ys.requestFormReset=function(C){d.d.r(C)},ys.unstable_batchedUpdates=function(C,R){return C(R)},ys.useFormState=function(C,R,N){return v.H.useFormState(C,R,N)},ys.useFormStatus=function(){return v.H.useHostTransitionStatus()},ys.version="19.1.1",ys}var n1;function Qw(){if(n1)return Hv.exports;n1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Hv.exports=dE(),Hv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function fE(){if(i1)return xy;i1=1;var i=hE(),n=rx(),l=Qw();function d(r){var u="https://react.dev/errors/"+r;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+r+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function _(r){var u=r,p=r;if(r.alternate)for(;u.return;)u=u.return;else{r=u;do u=r,(u.flags&4098)!==0&&(p=u.return),r=u.return;while(r)}return u.tag===3?p:null}function v(r){if(r.tag===13){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function c(r){if(_(r)!==r)throw Error(d(188))}function C(r){var u=r.alternate;if(!u){if(u=_(r),u===null)throw Error(d(188));return u!==r?null:r}for(var p=r,x=u;;){var M=p.return;if(M===null)break;var z=M.alternate;if(z===null){if(x=M.return,x!==null){p=x;continue}break}if(M.child===z.child){for(z=M.child;z;){if(z===p)return c(M),r;if(z===x)return c(M),u;z=z.sibling}throw Error(d(188))}if(p.return!==x.return)p=M,x=z;else{for(var q=!1,ne=M.child;ne;){if(ne===p){q=!0,p=M,x=z;break}if(ne===x){q=!0,x=M,p=z;break}ne=ne.sibling}if(!q){for(ne=z.child;ne;){if(ne===p){q=!0,p=z,x=M;break}if(ne===x){q=!0,x=z,p=M;break}ne=ne.sibling}if(!q)throw Error(d(189))}}if(p.alternate!==x)throw Error(d(190))}if(p.tag!==3)throw Error(d(188));return p.stateNode.current===p?r:u}function R(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r;for(r=r.child;r!==null;){if(u=R(r),u!==null)return u;r=r.sibling}return null}var N=Object.assign,B=Symbol.for("react.element"),V=Symbol.for("react.transitional.element"),G=Symbol.for("react.portal"),ae=Symbol.for("react.fragment"),me=Symbol.for("react.strict_mode"),pe=Symbol.for("react.profiler"),Ne=Symbol.for("react.provider"),Ve=Symbol.for("react.consumer"),Fe=Symbol.for("react.context"),qe=Symbol.for("react.forward_ref"),Ae=Symbol.for("react.suspense"),Ke=Symbol.for("react.suspense_list"),mt=Symbol.for("react.memo"),st=Symbol.for("react.lazy"),Pe=Symbol.for("react.activity"),rt=Symbol.for("react.memo_cache_sentinel"),Mt=Symbol.iterator;function Rt(r){return r===null||typeof r!="object"?null:(r=Mt&&r[Mt]||r["@@iterator"],typeof r=="function"?r:null)}var jt=Symbol.for("react.client.reference");function en(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===jt?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case ae:return"Fragment";case pe:return"Profiler";case me:return"StrictMode";case Ae:return"Suspense";case Ke:return"SuspenseList";case Pe:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case G:return"Portal";case Fe:return(r.displayName||"Context")+".Provider";case Ve:return(r._context.displayName||"Context")+".Consumer";case qe:var u=r.render;return r=r.displayName,r||(r=u.displayName||u.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case mt:return u=r.displayName||null,u!==null?u:en(r.type)||"Memo";case st:u=r._payload,r=r._init;try{return en(r(u))}catch{}}return null}var ln=Array.isArray,Ge=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ht={pending:!1,data:null,method:null,action:null},kt=[],Ee=-1;function nt(r){return{current:r}}function Ct(r){0>Ee||(r.current=kt[Ee],kt[Ee]=null,Ee--)}function bt(r,u){Ee++,kt[Ee]=r.current,r.current=u}var Pt=nt(null),Xt=nt(null),Bt=nt(null),Ei=nt(null);function mn(r,u){switch(bt(Bt,u),bt(Xt,r),bt(Pt,null),u.nodeType){case 9:case 11:r=(r=u.documentElement)&&(r=r.namespaceURI)?_0(r):0;break;default:if(r=u.tagName,u=u.namespaceURI)u=_0(u),r=uy(u,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Ct(Pt),bt(Pt,r)}function mi(){Ct(Pt),Ct(Xt),Ct(Bt)}function Ea(r){r.memoizedState!==null&&bt(Ei,r);var u=Pt.current,p=uy(u,r.type);u!==p&&(bt(Xt,r),bt(Pt,p))}function ua(r){Xt.current===r&&(Ct(Pt),Ct(Xt)),Ei.current===r&&(Ct(Ei),De._currentValue=ht)}var ur=Object.prototype.hasOwnProperty,Gn=i.unstable_scheduleCallback,Xn=i.unstable_cancelCallback,Rn=i.unstable_shouldYield,Yr=i.unstable_requestPaint,ji=i.unstable_now,Qa=i.unstable_getCurrentPriorityLevel,za=i.unstable_ImmediatePriority,ha=i.unstable_UserBlockingPriority,qr=i.unstable_NormalPriority,xs=i.unstable_LowPriority,Ka=i.unstable_IdlePriority,ws=i.log,Ts=i.unstable_setDisableYieldValue,da=null,Bi=null;function Hr(r){if(typeof ws=="function"&&Ts(r),Bi&&typeof Bi.setStrictMode=="function")try{Bi.setStrictMode(da,r)}catch{}}var Me=Math.clz32?Math.clz32:re,K=Math.log,ee=Math.LN2;function re(r){return r>>>=0,r===0?32:31-(K(r)/ee|0)|0}var ye=256,Te=4194304;function Ce(r){var u=r&42;if(u!==0)return u;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ue(r,u,p){var x=r.pendingLanes;if(x===0)return 0;var M=0,z=r.suspendedLanes,q=r.pingedLanes;r=r.warmLanes;var ne=x&134217727;return ne!==0?(x=ne&~z,x!==0?M=Ce(x):(q&=ne,q!==0?M=Ce(q):p||(p=ne&~r,p!==0&&(M=Ce(p))))):(ne=x&~z,ne!==0?M=Ce(ne):q!==0?M=Ce(q):p||(p=x&~r,p!==0&&(M=Ce(p)))),M===0?0:u!==0&&u!==M&&(u&z)===0&&(z=M&-M,p=u&-u,z>=p||z===32&&(p&4194048)!==0)?u:M}function Ie(r,u){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&u)===0}function Je(r,u){switch(r){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ft(){var r=ye;return ye<<=1,(ye&4194048)===0&&(ye=256),r}function it(){var r=Te;return Te<<=1,(Te&62914560)===0&&(Te=4194304),r}function Lt(r){for(var u=[],p=0;31>p;p++)u.push(r);return u}function Re(r,u){r.pendingLanes|=u,u!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function tn(r,u,p,x,M,z){var q=r.pendingLanes;r.pendingLanes=p,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=p,r.entangledLanes&=p,r.errorRecoveryDisabledLanes&=p,r.shellSuspendCounter=0;var ne=r.entanglements,xe=r.expirationTimes,Ye=r.hiddenUpdates;for(p=q&~p;0<p;){var at=31-Me(p),dt=1<<at;ne[at]=0,xe[at]=-1;var Xe=Ye[at];if(Xe!==null)for(Ye[at]=null,at=0;at<Xe.length;at++){var Qe=Xe[at];Qe!==null&&(Qe.lane&=-536870913)}p&=~dt}x!==0&&bn(r,x,0),z!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=z&~(q&~u))}function bn(r,u,p){r.pendingLanes|=u,r.suspendedLanes&=~u;var x=31-Me(u);r.entangledLanes|=u,r.entanglements[x]=r.entanglements[x]|1073741824|p&4194090}function Vt(r,u){var p=r.entangledLanes|=u;for(r=r.entanglements;p;){var x=31-Me(p),M=1<<x;M&u|r[x]&u&&(r[x]|=u),p&=~M}}function on(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ii(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function hr(){var r=ct.p;return r!==0?r:(r=window.event,r===void 0?32:Zt(r.type))}function yr(r,u){var p=ct.p;try{return ct.p=r,u()}finally{ct.p=p}}var li=Math.random().toString(36).slice(2),Wt="__reactFiber$"+li,nn="__reactProps$"+li,Ai="__reactContainer$"+li,gt="__reactEvents$"+li,Xr="__reactListeners$"+li,Fi="__reactHandles$"+li,ko="__reactResources$"+li,ro="__reactMarker$"+li;function Et(r){delete r[Wt],delete r[nn],delete r[gt],delete r[Xr],delete r[Fi]}function hn(r){var u=r[Wt];if(u)return u;for(var p=r.parentNode;p;){if(u=p[Ai]||p[Wt]){if(p=u.alternate,u.child!==null||p!==null&&p.child!==null)for(r=Fh(r);r!==null;){if(p=r[Wt])return p;r=Fh(r)}return u}r=p,p=r.parentNode}return null}function an(r){if(r=r[Wt]||r[Ai]){var u=r.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return r}return null}function rr(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r.stateNode;throw Error(d(33))}function Ja(r){var u=r[ko];return u||(u=r[ko]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Mi(r){r[ro]=!0}var dn=new Set,$u={};function Aa(r,u){Io(r,u),Io(r+"Capture",u)}function Io(r,u){for($u[r]=u,r=0;r<u.length;r++)dn.add(u[r])}var ao=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ql={},Ui={};function pd(r){return ur.call(Ui,r)?!0:ur.call(Ql,r)?!1:ao.test(r)?Ui[r]=!0:(Ql[r]=!0,!1)}function Rr(r,u,p){if(pd(u))if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":r.removeAttribute(u);return;case"boolean":var x=u.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){r.removeAttribute(u);return}}r.setAttribute(u,""+p)}}function Zn(r,u,p){if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttribute(u,""+p)}}function so(r,u,p,x){if(x===null)r.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(p);return}r.setAttributeNS(u,p,""+x)}}var Kl,md;function Na(r){if(Kl===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Kl=u&&u[1]||"",md=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kl+r+md}var oo=!1;function Yu(r,u){if(!r||oo)return"";oo=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(u){var dt=function(){throw Error()};if(Object.defineProperty(dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(dt,[])}catch(Qe){var Xe=Qe}Reflect.construct(r,[],dt)}else{try{dt.call()}catch(Qe){Xe=Qe}r.call(dt.prototype)}}else{try{throw Error()}catch(Qe){Xe=Qe}(dt=r())&&typeof dt.catch=="function"&&dt.catch(function(){})}}catch(Qe){if(Qe&&Xe&&typeof Qe.stack=="string")return[Qe.stack,Xe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=x.DetermineComponentFrameRoot(),q=z[0],ne=z[1];if(q&&ne){var xe=q.split(`
`),Ye=ne.split(`
`);for(M=x=0;x<xe.length&&!xe[x].includes("DetermineComponentFrameRoot");)x++;for(;M<Ye.length&&!Ye[M].includes("DetermineComponentFrameRoot");)M++;if(x===xe.length||M===Ye.length)for(x=xe.length-1,M=Ye.length-1;1<=x&&0<=M&&xe[x]!==Ye[M];)M--;for(;1<=x&&0<=M;x--,M--)if(xe[x]!==Ye[M]){if(x!==1||M!==1)do if(x--,M--,0>M||xe[x]!==Ye[M]){var at=`
`+xe[x].replace(" at new "," at ");return r.displayName&&at.includes("<anonymous>")&&(at=at.replace("<anonymous>",r.displayName)),at}while(1<=x&&0<=M);break}}}finally{oo=!1,Error.prepareStackTrace=p}return(p=r?r.displayName||r.name:"")?Na(p):""}function Gp(r){switch(r.tag){case 26:case 27:case 5:return Na(r.type);case 16:return Na("Lazy");case 13:return Na("Suspense");case 19:return Na("SuspenseList");case 0:case 15:return Yu(r.type,!1);case 11:return Yu(r.type.render,!1);case 1:return Yu(r.type,!0);case 31:return Na("Activity");default:return""}}function wf(r){try{var u="";do u+=Gp(r),r=r.return;while(r);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Pr(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Tf(r){var u=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Eg(r){var u=Tf(r)?"checked":"value",p=Object.getOwnPropertyDescriptor(r.constructor.prototype,u),x=""+r[u];if(!r.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var M=p.get,z=p.set;return Object.defineProperty(r,u,{configurable:!0,get:function(){return M.call(this)},set:function(q){x=""+q,z.call(this,q)}}),Object.defineProperty(r,u,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){r._valueTracker=null,delete r[u]}}}}function gd(r){r._valueTracker||(r._valueTracker=Eg(r))}function Zp(r){if(!r)return!1;var u=r._valueTracker;if(!u)return!0;var p=u.getValue(),x="";return r&&(x=Tf(r)?r.checked?"true":"false":r.value),r=x,r!==p?(u.setValue(r),!0):!1}function Vc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Gc=/[\n"\\]/g;function Ma(r){return r.replace(Gc,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function qu(r,u,p,x,M,z,q,ne){r.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?r.type=q:r.removeAttribute("type"),u!=null?q==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+Pr(u)):r.value!==""+Pr(u)&&(r.value=""+Pr(u)):q!=="submit"&&q!=="reset"||r.removeAttribute("value"),u!=null?Hu(r,q,Pr(u)):p!=null?Hu(r,q,Pr(p)):x!=null&&r.removeAttribute("value"),M==null&&z!=null&&(r.defaultChecked=!!z),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?r.name=""+Pr(ne):r.removeAttribute("name")}function Jl(r,u,p,x,M,z,q,ne){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(r.type=z),u!=null||p!=null){if(!(z!=="submit"&&z!=="reset"||u!=null))return;p=p!=null?""+Pr(p):"",u=u!=null?""+Pr(u):p,ne||u===r.value||(r.value=u),r.defaultValue=u}x=x??M,x=typeof x!="function"&&typeof x!="symbol"&&!!x,r.checked=ne?r.checked:!!x,r.defaultChecked=!!x,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(r.name=q)}function Hu(r,u,p){u==="number"&&Vc(r.ownerDocument)===r||r.defaultValue===""+p||(r.defaultValue=""+p)}function cl(r,u,p,x){if(r=r.options,u){u={};for(var M=0;M<p.length;M++)u["$"+p[M]]=!0;for(p=0;p<r.length;p++)M=u.hasOwnProperty("$"+r[p].value),r[p].selected!==M&&(r[p].selected=M),M&&x&&(r[p].defaultSelected=!0)}else{for(p=""+Pr(p),u=null,M=0;M<r.length;M++){if(r[M].value===p){r[M].selected=!0,x&&(r[M].defaultSelected=!0);return}u!==null||r[M].disabled||(u=r[M])}u!==null&&(u.selected=!0)}}function $p(r,u,p){if(u!=null&&(u=""+Pr(u),u!==r.value&&(r.value=u),p==null)){r.defaultValue!==u&&(r.defaultValue=u);return}r.defaultValue=p!=null?""+Pr(p):""}function ec(r,u,p,x){if(u==null){if(x!=null){if(p!=null)throw Error(d(92));if(ln(x)){if(1<x.length)throw Error(d(93));x=x[0]}p=x}p==null&&(p=""),u=p}p=Pr(u),r.defaultValue=p,x=r.textContent,x===p&&x!==""&&x!==null&&(r.value=x)}function lo(r,u){if(u){var p=r.firstChild;if(p&&p===r.lastChild&&p.nodeType===3){p.nodeValue=u;return}}r.textContent=u}var Ss=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xn(r,u,p){var x=u.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="":x?r.setProperty(u,p):typeof p!="number"||p===0||Ss.has(u)?u==="float"?r.cssFloat=p:r[u]=(""+p).trim():r[u]=p+"px"}function ul(r,u,p){if(u!=null&&typeof u!="object")throw Error(d(62));if(r=r.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||u!=null&&u.hasOwnProperty(x)||(x.indexOf("--")===0?r.setProperty(x,""):x==="float"?r.cssFloat="":r[x]="");for(var M in u)x=u[M],u.hasOwnProperty(M)&&p[M]!==x&&xn(r,M,x)}else for(var z in u)u.hasOwnProperty(z)&&xn(r,z,u[z])}function co(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ro=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yn(r){return tc.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Po=null;function Zc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var zo=null,dr=null;function _r(r){var u=an(r);if(u&&(r=u.stateNode)){var p=r[nn]||null;e:switch(r=u.stateNode,u.type){case"input":if(qu(r,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),u=p.name,p.type==="radio"&&u!=null){for(p=r;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Ma(""+u)+'"][type="radio"]'),u=0;u<p.length;u++){var x=p[u];if(x!==r&&x.form===r.form){var M=x[nn]||null;if(!M)throw Error(d(90));qu(x,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(u=0;u<p.length;u++)x=p[u],x.form===r.form&&Zp(x)}break e;case"textarea":$p(r,p.value,p.defaultValue);break e;case"select":u=p.value,u!=null&&cl(r,!!p.multiple,u,!1)}}}var zr=!1;function ar(r,u,p){if(zr)return r(u,p);zr=!0;try{var x=r(u);return x}finally{if(zr=!1,(zo!==null||dr!==null)&&(Tm(),zo&&(u=zo,r=dr,dr=zo=null,_r(u),r)))for(u=0;u<r.length;u++)_r(r[u])}}function Fn(r,u){var p=r.stateNode;if(p===null)return null;var x=p[nn]||null;if(x===null)return null;p=x[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(r=r.type,x=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!x;break e;default:r=!1}if(r)return null;if(p&&typeof p!="function")throw Error(d(231,u,typeof p));return p}var uo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nr=!1;if(uo)try{var Lr={};Object.defineProperty(Lr,"passive",{get:function(){Nr=!0}}),window.addEventListener("test",Lr,Lr),window.removeEventListener("test",Lr,Lr)}catch{Nr=!1}var Vi=null,ci=null,ho=null;function Ht(){if(ho)return ho;var r,u=ci,p=u.length,x,M="value"in Vi?Vi.value:Vi.textContent,z=M.length;for(r=0;r<p&&u[r]===M[r];r++);var q=p-r;for(x=1;x<=q&&u[p-x]===M[z-x];x++);return ho=M.slice(r,1<x?1-x:void 0)}function rn(r){var u=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&u===13&&(r=13)):r=u,r===10&&(r=13),32<=r||r===13?r:0}function es(){return!0}function Mn(){return!1}function gi(r){function u(p,x,M,z,q){this._reactName=p,this._targetInst=M,this.type=x,this.nativeEvent=z,this.target=q,this.currentTarget=null;for(var ne in r)r.hasOwnProperty(ne)&&(p=r[ne],this[ne]=p?p(z):z[ne]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?es:Mn,this.isPropagationStopped=Mn,this}return N(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=es)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=es)},persist:function(){},isPersistent:es}),u}var Wr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},La=gi(Wr),hl=N({},Wr,{view:0,detail:0}),Sf=gi(hl),dl,nc,fl,ic=N({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sc,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==fl&&(fl&&r.type==="mousemove"?(dl=r.screenX-fl.screenX,nc=r.screenY-fl.screenY):nc=dl=0,fl=r),dl)},movementY:function(r){return"movementY"in r?r.movementY:nc}}),Xu=gi(ic),Es=N({},ic,{dataTransfer:0}),Mr=gi(Es),$c=N({},hl,{relatedTarget:0}),rc=gi($c),ac=N({},Wr,{animationName:0,elapsedTime:0,pseudoElement:0}),Yi=gi(ac),Yp=N({},Wr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Wu=gi(Yp),Ef=N({},Wr,{data:0}),qp=gi(Ef),Yc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Or={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fo(r){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(r):(r=Qu[r])?!!u[r]:!1}function sc(){return fo}var Ku=N({},hl,{key:function(r){if(r.key){var u=Yc[r.key]||r.key;if(u!=="Unidentified")return u}return r.type==="keypress"?(r=rn(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Or[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sc,charCode:function(r){return r.type==="keypress"?rn(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?rn(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ju=gi(Ku),Qr=N({},ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Af=gi(Qr),yd=N({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sc}),Ag=gi(yd),Mf=N({},Wr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mg=gi(Mf),Cg=N({},ic,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),_d=gi(Cg),Cf=N({},Wr,{newState:0,oldState:0}),oc=gi(Cf),Df=[9,13,27,32],qc=uo&&"CompositionEvent"in window,fa=null;uo&&"documentMode"in document&&(fa=document.documentMode);var Dg=uo&&"TextEvent"in window&&!fa,eh=uo&&(!qc||fa&&8<fa&&11>=fa),Hc=" ",Xc=!1;function Hp(r,u){switch(r){case"keyup":return Df.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function th(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Wc=!1;function lc(r,u){switch(r){case"compositionend":return th(u);case"keypress":return u.which!==32?null:(Xc=!0,Hc);case"textInput":return r=u.data,r===Hc&&Xc?null:r;default:return null}}function Xp(r,u){if(Wc)return r==="compositionend"||!qc&&Hp(r,u)?(r=Ht(),ho=ci=Vi=null,Wc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return eh&&u.locale!=="ko"?null:u.data;default:return null}}var kf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wp(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u==="input"?!!kf[r.type]:u==="textarea"}function If(r,u,p,x){zo?dr?dr.push(x):dr=[x]:zo=x,u=hp(u,"onChange"),0<u.length&&(p=new La("onChange","change",null,p,x),r.push({event:p,listeners:u}))}var cc=null,Qc=null;function vd(r){m0(r,0)}function nh(r){var u=rr(r);if(Zp(u))return r}function Rf(r,u){if(r==="change")return u}var pl=!1;if(uo){var ih;if(uo){var rh="oninput"in document;if(!rh){var Kc=document.createElement("div");Kc.setAttribute("oninput","return;"),rh=typeof Kc.oninput=="function"}ih=rh}else ih=!1;pl=ih&&(!document.documentMode||9<document.documentMode)}function Qp(){cc&&(cc.detachEvent("onpropertychange",Jc),Qc=cc=null)}function Jc(r){if(r.propertyName==="value"&&nh(Qc)){var u=[];If(u,Qc,r,Zc(r)),ar(vd,u)}}function Kp(r,u,p){r==="focusin"?(Qp(),cc=u,Qc=p,cc.attachEvent("onpropertychange",Jc)):r==="focusout"&&Qp()}function kg(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return nh(Qc)}function Jp(r,u){if(r==="click")return nh(u)}function em(r,u){if(r==="input"||r==="change")return nh(u)}function Pf(r,u){return r===u&&(r!==0||1/r===1/u)||r!==r&&u!==u}var pa=typeof Object.is=="function"?Object.is:Pf;function eu(r,u){if(pa(r,u))return!0;if(typeof r!="object"||r===null||typeof u!="object"||u===null)return!1;var p=Object.keys(r),x=Object.keys(u);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var M=p[x];if(!ur.call(u,M)||!pa(r[M],u[M]))return!1}return!0}function ah(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function po(r,u){var p=ah(r);r=0;for(var x;p;){if(p.nodeType===3){if(x=r+p.textContent.length,r<=u&&x>=u)return{node:p,offset:u-r};r=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ah(p)}}function Pn(r,u){return r&&u?r===u?!0:r&&r.nodeType===3?!1:u&&u.nodeType===3?Pn(r,u.parentNode):"contains"in r?r.contains(u):r.compareDocumentPosition?!!(r.compareDocumentPosition(u)&16):!1:!1}function bd(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var u=Vc(r.document);u instanceof r.HTMLIFrameElement;){try{var p=typeof u.contentWindow.location.href=="string"}catch{p=!1}if(p)r=u.contentWindow;else break;u=Vc(r.document)}return u}function sh(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u&&(u==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||u==="textarea"||r.contentEditable==="true")}var tm=uo&&"documentMode"in document&&11>=document.documentMode,ml=null,No=null,uc=null,zf=!1;function nm(r,u,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;zf||ml==null||ml!==Vc(x)||(x=ml,"selectionStart"in x&&sh(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),uc&&eu(uc,x)||(uc=x,x=hp(No,"onSelect"),0<x.length&&(u=new La("onSelect","select",null,u,p),r.push({event:u,listeners:x}),u.target=ml)))}function hc(r,u){var p={};return p[r.toLowerCase()]=u.toLowerCase(),p["Webkit"+r]="webkit"+u,p["Moz"+r]="moz"+u,p}var tu={animationend:hc("Animation","AnimationEnd"),animationiteration:hc("Animation","AnimationIteration"),animationstart:hc("Animation","AnimationStart"),transitionrun:hc("Transition","TransitionRun"),transitionstart:hc("Transition","TransitionStart"),transitioncancel:hc("Transition","TransitionCancel"),transitionend:hc("Transition","TransitionEnd")},xd={},im={};uo&&(im=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function gl(r){if(xd[r])return xd[r];if(!tu[r])return r;var u=tu[r],p;for(p in u)if(u.hasOwnProperty(p)&&p in im)return xd[r]=u[p];return r}var oh=gl("animationend"),lh=gl("animationiteration"),ch=gl("animationstart"),Nf=gl("transitionrun"),dc=gl("transitionstart"),uh=gl("transitioncancel"),fc=gl("transitionend"),Oa=new Map,wd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wd.push("scrollEnd");function ts(r,u){Oa.set(r,u),Aa(u,[r])}var Td=new WeakMap;function Cr(r,u){if(typeof r=="object"&&r!==null){var p=Td.get(r);return p!==void 0?p:(u={value:r,source:u,stack:wf(u)},Td.set(r,u),u)}return{value:r,source:u,stack:wf(u)}}var ma=[],Lo=0,pc=0;function mc(){for(var r=Lo,u=pc=Lo=0;u<r;){var p=ma[u];ma[u++]=null;var x=ma[u];ma[u++]=null;var M=ma[u];ma[u++]=null;var z=ma[u];if(ma[u++]=null,x!==null&&M!==null){var q=x.pending;q===null?M.next=M:(M.next=q.next,q.next=M),x.pending=M}z!==0&&Lf(p,M,z)}}function hh(r,u,p,x){ma[Lo++]=r,ma[Lo++]=u,ma[Lo++]=p,ma[Lo++]=x,pc|=x,r.lanes|=x,r=r.alternate,r!==null&&(r.lanes|=x)}function yl(r,u,p,x){return hh(r,u,p,x),nu(r)}function ja(r,u){return hh(r,null,null,u),nu(r)}function Lf(r,u,p){r.lanes|=p;var x=r.alternate;x!==null&&(x.lanes|=p);for(var M=!1,z=r.return;z!==null;)z.childLanes|=p,x=z.alternate,x!==null&&(x.childLanes|=p),z.tag===22&&(r=z.stateNode,r===null||r._visibility&1||(M=!0)),r=z,z=z.return;return r.tag===3?(z=r.stateNode,M&&u!==null&&(M=31-Me(p),r=z.hiddenUpdates,x=r[M],x===null?r[M]=[u]:x.push(u),u.lane=p|536870912),z):null}function nu(r){if(50<zh)throw zh=0,Tu=null,Error(d(185));for(var u=r.return;u!==null;)r=u,u=r.return;return r.tag===3?r.stateNode:null}var gn={};function dh(r,u,p,x){this.tag=r,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ba(r,u,p,x){return new dh(r,u,p,x)}function Sd(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Kr(r,u){var p=r.alternate;return p===null?(p=Ba(r.tag,u,r.key,r.mode),p.elementType=r.elementType,p.type=r.type,p.stateNode=r.stateNode,p.alternate=r,r.alternate=p):(p.pendingProps=u,p.type=r.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=r.flags&65011712,p.childLanes=r.childLanes,p.lanes=r.lanes,p.child=r.child,p.memoizedProps=r.memoizedProps,p.memoizedState=r.memoizedState,p.updateQueue=r.updateQueue,u=r.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=r.sibling,p.index=r.index,p.ref=r.ref,p.refCleanup=r.refCleanup,p}function Of(r,u){r.flags&=65011714;var p=r.alternate;return p===null?(r.childLanes=0,r.lanes=u,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=p.childLanes,r.lanes=p.lanes,r.child=p.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=p.memoizedProps,r.memoizedState=p.memoizedState,r.updateQueue=p.updateQueue,r.type=p.type,u=p.dependencies,r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),r}function Ed(r,u,p,x,M,z){var q=0;if(x=r,typeof r=="function")Sd(r)&&(q=1);else if(typeof r=="string")q=D(r,p,Pt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Pe:return r=Ba(31,p,u,M),r.elementType=Pe,r.lanes=z,r;case ae:return _l(p.children,M,z,u);case me:q=8,M|=24;break;case pe:return r=Ba(12,p,u,M|2),r.elementType=pe,r.lanes=z,r;case Ae:return r=Ba(13,p,u,M),r.elementType=Ae,r.lanes=z,r;case Ke:return r=Ba(19,p,u,M),r.elementType=Ke,r.lanes=z,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Ne:case Fe:q=10;break e;case Ve:q=9;break e;case qe:q=11;break e;case mt:q=14;break e;case st:q=16,x=null;break e}q=29,p=Error(d(130,r===null?"null":typeof r,"")),x=null}return u=Ba(q,p,u,M),u.elementType=r,u.type=x,u.lanes=z,u}function _l(r,u,p,x){return r=Ba(7,r,x,u),r.lanes=p,r}function jf(r,u,p){return r=Ba(6,r,null,u),r.lanes=p,r}function fh(r,u,p){return u=Ba(4,r.children!==null?r.children:[],r.key,u),u.lanes=p,u.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},u}var Oo=[],mo=0,vl=null,iu=0,Fa=[],Jr=0,As=null,Ua=1,ns="";function jo(r,u){Oo[mo++]=iu,Oo[mo++]=vl,vl=r,iu=u}function bl(r,u,p){Fa[Jr++]=Ua,Fa[Jr++]=ns,Fa[Jr++]=As,As=r;var x=Ua;r=ns;var M=32-Me(x)-1;x&=~(1<<M),p+=1;var z=32-Me(u)+M;if(30<z){var q=M-M%5;z=(x&(1<<q)-1).toString(32),x>>=q,M-=q,Ua=1<<32-Me(u)+M|p<<M|x,ns=z+r}else Ua=1<<z|p<<M|x,ns=r}function ph(r){r.return!==null&&(jo(r,1),bl(r,1,0))}function ru(r){for(;r===vl;)vl=Oo[--mo],Oo[mo]=null,iu=Oo[--mo],Oo[mo]=null;for(;r===As;)As=Fa[--Jr],Fa[Jr]=null,ns=Fa[--Jr],Fa[Jr]=null,Ua=Fa[--Jr],Fa[Jr]=null}var sr=null,Ri=null,Un=!1,xl=null,Va=!1,mh=Error(d(519));function gc(r){var u=Error(d(418,""));throw Bo(Cr(u,r)),mh}function Ad(r){var u=r.stateNode,p=r.type,x=r.memoizedProps;switch(u[Wt]=r,u[nn]=x,p){case"dialog":Ln("cancel",u),Ln("close",u);break;case"iframe":case"object":case"embed":Ln("load",u);break;case"video":case"audio":for(p=0;p<cp.length;p++)Ln(cp[p],u);break;case"source":Ln("error",u);break;case"img":case"image":case"link":Ln("error",u),Ln("load",u);break;case"details":Ln("toggle",u);break;case"input":Ln("invalid",u),Jl(u,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),gd(u);break;case"select":Ln("invalid",u);break;case"textarea":Ln("invalid",u),ec(u,x.value,x.defaultValue,x.children),gd(u)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||u.textContent===""+p||x.suppressHydrationWarning===!0||cy(u.textContent,p)?(x.popover!=null&&(Ln("beforetoggle",u),Ln("toggle",u)),x.onScroll!=null&&Ln("scroll",u),x.onScrollEnd!=null&&Ln("scrollend",u),x.onClick!=null&&(u.onclick=ka),u=!0):u=!1,u||gc(r)}function Pi(r){for(sr=r.return;sr;)switch(sr.tag){case 5:case 13:Va=!1;return;case 27:case 3:Va=!0;return;default:sr=sr.return}}function Ca(r){if(r!==sr)return!1;if(!Un)return Pi(r),Un=!0,!1;var u=r.tag,p;if((p=u!==3&&u!==27)&&((p=u===5)&&(p=r.type,p=!(p!=="form"&&p!=="button")||jl(r.type,r.memoizedProps)),p=!p),p&&Ri&&gc(r),Pi(r),u===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(d(317));e:{for(r=r.nextSibling,u=0;r;){if(r.nodeType===8)if(p=r.data,p==="/$"){if(u===0){Ri=Jo(r.nextSibling);break e}u--}else p!=="$"&&p!=="$!"&&p!=="$?"||u++;r=r.nextSibling}Ri=null}}else u===27?(u=Ri,Rc(r.type)?(r=dy,dy=null,Ri=r):Ri=u):Ri=sr?Jo(r.stateNode.nextSibling):null;return!0}function ea(){Ri=sr=null,Un=!1}function gh(){var r=xl;return r!==null&&(ds===null?ds=r:ds.push.apply(ds,r),xl=null),r}function Bo(r){xl===null?xl=[r]:xl.push(r)}var Md=nt(null),Ga=null,is=null;function ta(r,u,p){bt(Md,u._currentValue),u._currentValue=p}function Ms(r){r._currentValue=Md.current,Ct(Md)}function Cd(r,u,p){for(;r!==null;){var x=r.alternate;if((r.childLanes&u)!==u?(r.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),r===p)break;r=r.return}}function Dd(r,u,p,x){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var z=M.dependencies;if(z!==null){var q=M.child;z=z.firstContext;e:for(;z!==null;){var ne=z;z=M;for(var xe=0;xe<u.length;xe++)if(ne.context===u[xe]){z.lanes|=p,ne=z.alternate,ne!==null&&(ne.lanes|=p),Cd(z.return,p,r),x||(q=null);break e}z=ne.next}}else if(M.tag===18){if(q=M.return,q===null)throw Error(d(341));q.lanes|=p,z=q.alternate,z!==null&&(z.lanes|=p),Cd(q,p,r),q=null}else q=M.child;if(q!==null)q.return=M;else for(q=M;q!==null;){if(q===r){q=null;break}if(M=q.sibling,M!==null){M.return=q.return,q=M;break}q=q.return}M=q}}function au(r,u,p,x){r=null;for(var M=u,z=!1;M!==null;){if(!z){if((M.flags&524288)!==0)z=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var q=M.alternate;if(q===null)throw Error(d(387));if(q=q.memoizedProps,q!==null){var ne=M.type;pa(M.pendingProps.value,q.value)||(r!==null?r.push(ne):r=[ne])}}else if(M===Ei.current){if(q=M.alternate,q===null)throw Error(d(387));q.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push(De):r=[De])}M=M.return}r!==null&&Dd(u,r,p,x),u.flags|=262144}function yh(r){for(r=r.firstContext;r!==null;){if(!pa(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function wl(r){Ga=r,is=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function yi(r){return ga(Ga,r)}function Fo(r,u){return Ga===null&&wl(r),ga(r,u)}function ga(r,u){var p=u._currentValue;if(u={context:u,memoizedValue:p,next:null},is===null){if(r===null)throw Error(d(308));is=u,r.dependencies={lanes:0,firstContext:u},r.flags|=524288}else is=is.next=u;return p}var su=typeof AbortController<"u"?AbortController:function(){var r=[],u=this.signal={aborted:!1,addEventListener:function(p,x){r.push(x)}};this.abort=function(){u.aborted=!0,r.forEach(function(p){return p()})}},Bf=i.unstable_scheduleCallback,rm=i.unstable_NormalPriority,fr={$$typeof:Fe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tl(){return{controller:new su,data:new Map,refCount:0}}function yc(r){r.refCount--,r.refCount===0&&Bf(rm,function(){r.controller.abort()})}var go=null,kd=0,vr=0,na=null;function ou(r,u){if(go===null){var p=go=[];kd=0,vr=op(),na={status:"pending",value:void 0,then:function(x){p.push(x)}}}return kd++,u.then(rs,rs),u}function rs(){if(--kd===0&&go!==null){na!==null&&(na.status="fulfilled");var r=go;go=null,vr=0,na=null;for(var u=0;u<r.length;u++)(0,r[u])()}}function lu(r,u){var p=[],x={status:"pending",value:null,reason:null,then:function(M){p.push(M)}};return r.then(function(){x.status="fulfilled",x.value=u;for(var M=0;M<p.length;M++)(0,p[M])(u)},function(M){for(x.status="rejected",x.reason=M,M=0;M<p.length;M++)(0,p[M])(void 0)}),x}var am=Ge.S;Ge.S=function(r,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&ou(r,u),am!==null&&am(r,u)};var Cs=nt(null);function Ff(){var r=Cs.current;return r!==null?r:Oi.pooledCache}function Id(r,u){u===null?bt(Cs,Cs.current):bt(Cs,u.pool)}function cu(){var r=Ff();return r===null?null:{parent:fr._currentValue,pool:r}}var Uo=Error(d(460)),as=Error(d(474)),Dt=Error(d(542)),_h={then:function(){}};function vh(r){return r=r.status,r==="fulfilled"||r==="rejected"}function uu(){}function _c(r,u,p){switch(p=r[p],p===void 0?r.push(u):p!==u&&(u.then(uu,uu),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,En(r),r;default:if(typeof u.status=="string")u.then(uu,uu);else{if(r=Oi,r!==null&&100<r.shellSuspendCounter)throw Error(d(482));r=u,r.status="pending",r.then(function(x){if(u.status==="pending"){var M=u;M.status="fulfilled",M.value=x}},function(x){if(u.status==="pending"){var M=u;M.status="rejected",M.reason=x}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,En(r),r}throw Ds=u,Uo}}var Ds=null;function bh(){if(Ds===null)throw Error(d(459));var r=Ds;return Ds=null,r}function En(r){if(r===Uo||r===Dt)throw Error(d(483))}var ks=!1;function Uf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hu(r,u){r=r.updateQueue,u.updateQueue===r&&(u.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Sl(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Vo(r,u,p){var x=r.updateQueue;if(x===null)return null;if(x=x.shared,(ui&2)!==0){var M=x.pending;return M===null?u.next=u:(u.next=M.next,M.next=u),x.pending=u,u=nu(r),Lf(r,null,p),u}return hh(r,x,u,p),nu(r)}function vc(r,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var x=u.lanes;x&=r.pendingLanes,p|=x,u.lanes=p,Vt(r,p)}}function xh(r,u){var p=r.updateQueue,x=r.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var M=null,z=null;if(p=p.firstBaseUpdate,p!==null){do{var q={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};z===null?M=z=q:z=z.next=q,p=p.next}while(p!==null);z===null?M=z=u:z=z.next=u}else M=z=u;p={baseState:x.baseState,firstBaseUpdate:M,lastBaseUpdate:z,shared:x.shared,callbacks:x.callbacks},r.updateQueue=p;return}r=p.lastBaseUpdate,r===null?p.firstBaseUpdate=u:r.next=u,p.lastBaseUpdate=u}var Rd=!1;function du(){if(Rd){var r=na;if(r!==null)throw r}}function bc(r,u,p,x){Rd=!1;var M=r.updateQueue;ks=!1;var z=M.firstBaseUpdate,q=M.lastBaseUpdate,ne=M.shared.pending;if(ne!==null){M.shared.pending=null;var xe=ne,Ye=xe.next;xe.next=null,q===null?z=Ye:q.next=Ye,q=xe;var at=r.alternate;at!==null&&(at=at.updateQueue,ne=at.lastBaseUpdate,ne!==q&&(ne===null?at.firstBaseUpdate=Ye:ne.next=Ye,at.lastBaseUpdate=xe))}if(z!==null){var dt=M.baseState;q=0,at=Ye=xe=null,ne=z;do{var Xe=ne.lane&-536870913,Qe=Xe!==ne.lane;if(Qe?(Dn&Xe)===Xe:(x&Xe)===Xe){Xe!==0&&Xe===vr&&(Rd=!0),at!==null&&(at=at.next={lane:0,tag:ne.tag,payload:ne.payload,callback:null,next:null});e:{var un=r,sn=ne;Xe=u;var xi=p;switch(sn.tag){case 1:if(un=sn.payload,typeof un=="function"){dt=un.call(xi,dt,Xe);break e}dt=un;break e;case 3:un.flags=un.flags&-65537|128;case 0:if(un=sn.payload,Xe=typeof un=="function"?un.call(xi,dt,Xe):un,Xe==null)break e;dt=N({},dt,Xe);break e;case 2:ks=!0}}Xe=ne.callback,Xe!==null&&(r.flags|=64,Qe&&(r.flags|=8192),Qe=M.callbacks,Qe===null?M.callbacks=[Xe]:Qe.push(Xe))}else Qe={lane:Xe,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},at===null?(Ye=at=Qe,xe=dt):at=at.next=Qe,q|=Xe;if(ne=ne.next,ne===null){if(ne=M.shared.pending,ne===null)break;Qe=ne,ne=Qe.next,Qe.next=null,M.lastBaseUpdate=Qe,M.shared.pending=null}}while(!0);at===null&&(xe=dt),M.baseState=xe,M.firstBaseUpdate=Ye,M.lastBaseUpdate=at,z===null&&(M.shared.lanes=0),Nl|=q,r.lanes=q,r.memoizedState=dt}}function Vf(r,u){if(typeof r!="function")throw Error(d(191,r));r.call(u)}function Gf(r,u){var p=r.callbacks;if(p!==null)for(r.callbacks=null,r=0;r<p.length;r++)Vf(p[r],u)}var ia=nt(null),$n=nt(0);function xc(r,u){r=Dc,bt($n,r),bt(ia,u),Dc=r|u.baseLanes}function wh(){bt($n,Dc),bt(ia,ia.current)}function Pd(){Dc=$n.current,Ct(ia),Ct($n)}var yo=0,Tn=null,ri=null,ai=null,wc=!1,zt=!1,Gt=!1,Tc=0,ss=0,Go=null,ya=0;function qi(){throw Error(d(321))}function Da(r,u){if(u===null)return!1;for(var p=0;p<u.length&&p<r.length;p++)if(!pa(r[p],u[p]))return!1;return!0}function Zf(r,u,p,x,M,z){return yo=z,Tn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Ge.H=r===null||r.memoizedState===null?ls:aa,Gt=!1,z=p(x,M),Gt=!1,zt&&(z=Wn(u,p,x,M)),fu(r),z}function fu(r){Ge.H=jr;var u=ri!==null&&ri.next!==null;if(yo=0,ai=ri=Tn=null,wc=!1,ss=0,Go=null,u)throw Error(d(300));r===null||xr||(r=r.dependencies,r!==null&&yh(r)&&(xr=!0))}function Wn(r,u,p,x){Tn=r;var M=0;do{if(zt&&(Go=null),ss=0,zt=!1,25<=M)throw Error(d(301));if(M+=1,ai=ri=null,r.updateQueue!=null){var z=r.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}Ge.H=kl,z=u(p,x)}while(zt);return z}function Hi(){var r=Ge.H,u=r.useState()[0];return u=typeof u.then=="function"?$o(u):u,r=r.useState()[0],(ri!==null?ri.memoizedState:null)!==r&&(Tn.flags|=1024),u}function pu(){var r=Tc!==0;return Tc=0,r}function El(r,u,p){u.updateQueue=r.updateQueue,u.flags&=-2053,r.lanes&=~p}function Al(r){if(wc){for(r=r.memoizedState;r!==null;){var u=r.queue;u!==null&&(u.pending=null),r=r.next}wc=!1}yo=0,ai=ri=Tn=null,zt=!1,ss=Tc=0,Go=null}function ra(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ai===null?Tn.memoizedState=ai=r:ai=ai.next=r,ai}function Ci(){if(ri===null){var r=Tn.alternate;r=r!==null?r.memoizedState:null}else r=ri.next;var u=ai===null?Tn.memoizedState:ai.next;if(u!==null)ai=u,ri=r;else{if(r===null)throw Tn.alternate===null?Error(d(467)):Error(d(310));ri=r,r={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},ai===null?Tn.memoizedState=ai=r:ai=ai.next=r}return ai}function Zo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $o(r){var u=ss;return ss+=1,Go===null&&(Go=[]),r=_c(Go,r,u),u=Tn,(ai===null?u.memoizedState:ai.next)===null&&(u=u.alternate,Ge.H=u===null||u.memoizedState===null?ls:aa),r}function Sc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return $o(r);if(r.$$typeof===Fe)return yi(r)}throw Error(d(438,String(r)))}function Yo(r){var u=null,p=Tn.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var x=Tn.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(u={data:x.data.map(function(M){return M.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Zo(),Tn.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(r),x=0;x<r;x++)p[x]=rt;return u.index++,p}function Is(r,u){return typeof u=="function"?u(r):u}function mu(r){var u=Ci();return gu(u,ri,r)}function gu(r,u,p){var x=r.queue;if(x===null)throw Error(d(311));x.lastRenderedReducer=p;var M=r.baseQueue,z=x.pending;if(z!==null){if(M!==null){var q=M.next;M.next=z.next,z.next=q}u.baseQueue=M=z,x.pending=null}if(z=r.baseState,M===null)r.memoizedState=z;else{u=M.next;var ne=q=null,xe=null,Ye=u,at=!1;do{var dt=Ye.lane&-536870913;if(dt!==Ye.lane?(Dn&dt)===dt:(yo&dt)===dt){var Xe=Ye.revertLane;if(Xe===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),dt===vr&&(at=!0);else if((yo&Xe)===Xe){Ye=Ye.next,Xe===vr&&(at=!0);continue}else dt={lane:0,revertLane:Ye.revertLane,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},xe===null?(ne=xe=dt,q=z):xe=xe.next=dt,Tn.lanes|=Xe,Nl|=Xe;dt=Ye.action,Gt&&p(z,dt),z=Ye.hasEagerState?Ye.eagerState:p(z,dt)}else Xe={lane:dt,revertLane:Ye.revertLane,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},xe===null?(ne=xe=Xe,q=z):xe=xe.next=Xe,Tn.lanes|=dt,Nl|=dt;Ye=Ye.next}while(Ye!==null&&Ye!==u);if(xe===null?q=z:xe.next=ne,!pa(z,r.memoizedState)&&(xr=!0,at&&(p=na,p!==null)))throw p;r.memoizedState=z,r.baseState=q,r.baseQueue=xe,x.lastRenderedState=z}return M===null&&(x.lanes=0),[r.memoizedState,x.dispatch]}function Th(r){var u=Ci(),p=u.queue;if(p===null)throw Error(d(311));p.lastRenderedReducer=r;var x=p.dispatch,M=p.pending,z=u.memoizedState;if(M!==null){p.pending=null;var q=M=M.next;do z=r(z,q.action),q=q.next;while(q!==M);pa(z,u.memoizedState)||(xr=!0),u.memoizedState=z,u.baseQueue===null&&(u.baseState=z),p.lastRenderedState=z}return[z,x]}function b(r,u,p){var x=Tn,M=Ci(),z=Un;if(z){if(p===void 0)throw Error(d(407));p=p()}else p=u();var q=!pa((ri||M).memoizedState,p);q&&(M.memoizedState=p,xr=!0),M=M.queue;var ne=f.bind(null,x,M,r);if(ke(2048,8,ne,[r]),M.getSnapshot!==u||q||ai!==null&&ai.memoizedState.tag&1){if(x.flags|=2048,fe(9,be(),o.bind(null,x,M,p,u),null),Oi===null)throw Error(d(349));z||(yo&124)!==0||e(x,u,p)}return p}function e(r,u,p){r.flags|=16384,r={getSnapshot:u,value:p},u=Tn.updateQueue,u===null?(u=Zo(),Tn.updateQueue=u,u.stores=[r]):(p=u.stores,p===null?u.stores=[r]:p.push(r))}function o(r,u,p,x){u.value=p,u.getSnapshot=x,y(u)&&w(r)}function f(r,u,p){return p(function(){y(u)&&w(r)})}function y(r){var u=r.getSnapshot;r=r.value;try{var p=u();return!pa(r,p)}catch{return!0}}function w(r){var u=ja(r,2);u!==null&&Os(u,r,2)}function E(r){var u=ra();if(typeof r=="function"){var p=r;if(r=p(),Gt){Hr(!0);try{p()}finally{Hr(!1)}}}return u.memoizedState=u.baseState=r,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:r},u}function k(r,u,p,x){return r.baseState=p,gu(r,ri,typeof x=="function"?x:Is)}function I(r,u,p,x,M){if(Ho(r))throw Error(d(485));if(r=u.action,r!==null){var z={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){z.listeners.push(q)}};Ge.T!==null?p(!0):z.isTransition=!1,x(z),p=u.pending,p===null?(z.next=u.pending=z,O(u,z)):(z.next=p.next,u.pending=p.next=z)}}function O(r,u){var p=u.action,x=u.payload,M=r.state;if(u.isTransition){var z=Ge.T,q={};Ge.T=q;try{var ne=p(M,x),xe=Ge.S;xe!==null&&xe(q,ne),j(r,u,ne)}catch(Ye){U(r,u,Ye)}finally{Ge.T=z}}else try{z=p(M,x),j(r,u,z)}catch(Ye){U(r,u,Ye)}}function j(r,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Z(r,u,x)},function(x){return U(r,u,x)}):Z(r,u,p)}function Z(r,u,p){u.status="fulfilled",u.value=p,Y(u),r.state=p,u=r.pending,u!==null&&(p=u.next,p===u?r.pending=null:(p=p.next,u.next=p,O(r,p)))}function U(r,u,p){var x=r.pending;if(r.pending=null,x!==null){x=x.next;do u.status="rejected",u.reason=p,Y(u),u=u.next;while(u!==x)}r.action=null}function Y(r){r=r.listeners;for(var u=0;u<r.length;u++)(0,r[u])()}function Q(r,u){return u}function le(r,u){if(Un){var p=Oi.formState;if(p!==null){e:{var x=Tn;if(Un){if(Ri){t:{for(var M=Ri,z=Va;M.nodeType!==8;){if(!z){M=null;break t}if(M=Jo(M.nextSibling),M===null){M=null;break t}}z=M.data,M=z==="F!"||z==="F"?M:null}if(M){Ri=Jo(M.nextSibling),x=M.data==="F!";break e}}gc(x)}x=!1}x&&(u=p[0])}}return p=ra(),p.memoizedState=p.baseState=u,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q,lastRenderedState:u},p.queue=x,p=qo.bind(null,Tn,x),x.dispatch=p,x=E(!1),z=Ml.bind(null,Tn,!1,x.queue),x=ra(),M={state:u,dispatch:null,action:r,pending:null},x.queue=M,p=I.bind(null,Tn,M,z,p),M.dispatch=p,x.memoizedState=r,[u,p,!1]}function oe(r){var u=Ci();return ue(u,ri,r)}function ue(r,u,p){if(u=gu(r,u,Q)[0],r=mu(Is)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var x=$o(u)}catch(q){throw q===Uo?Dt:q}else x=u;u=Ci();var M=u.queue,z=M.dispatch;return p!==u.memoizedState&&(Tn.flags|=2048,fe(9,be(),de.bind(null,M,p),null)),[x,z,r]}function de(r,u){r.action=u}function _e(r){var u=Ci(),p=ri;if(p!==null)return ue(u,p,r);Ci(),u=u.memoizedState,p=Ci();var x=p.queue.dispatch;return p.memoizedState=r,[u,x,!1]}function fe(r,u,p,x){return r={tag:r,create:p,deps:x,inst:u,next:null},u=Tn.updateQueue,u===null&&(u=Zo(),Tn.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=r.next=r:(x=p.next,p.next=r,r.next=x,u.lastEffect=r),r}function be(){return{destroy:void 0,resource:void 0}}function Se(){return Ci().memoizedState}function ge(r,u,p,x){var M=ra();x=x===void 0?null:x,Tn.flags|=r,M.memoizedState=fe(1|u,be(),p,x)}function ke(r,u,p,x){var M=Ci();x=x===void 0?null:x;var z=M.memoizedState.inst;ri!==null&&x!==null&&Da(x,ri.memoizedState.deps)?M.memoizedState=fe(u,z,p,x):(Tn.flags|=r,M.memoizedState=fe(1|u,z,p,x))}function He(r,u){ge(8390656,8,r,u)}function Oe(r,u){ke(2048,8,r,u)}function je(r,u){return ke(4,2,r,u)}function $e(r,u){return ke(4,4,r,u)}function yt(r,u){if(typeof u=="function"){r=r();var p=u(r);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return r=r(),u.current=r,function(){u.current=null}}function vt(r,u,p){p=p!=null?p.concat([r]):null,ke(4,4,yt.bind(null,u,r),p)}function ot(){}function Ot(r,u){var p=Ci();u=u===void 0?null:u;var x=p.memoizedState;return u!==null&&Da(u,x[1])?x[0]:(p.memoizedState=[r,u],r)}function fn(r,u){var p=Ci();u=u===void 0?null:u;var x=p.memoizedState;if(u!==null&&Da(u,x[1]))return x[0];if(x=r(),Gt){Hr(!0);try{r()}finally{Hr(!1)}}return p.memoizedState=[x,u],x}function zn(r,u,p){return p===void 0||(yo&1073741824)!==0?r.memoizedState=u:(r.memoizedState=p,r=e0(),Tn.lanes|=r,Nl|=r,p)}function Qn(r,u,p,x){return pa(p,u)?p:ia.current!==null?(r=zn(r,p,x),pa(r,u)||(xr=!0),r):(yo&42)===0?(xr=!0,r.memoizedState=p):(r=e0(),Tn.lanes|=r,Nl|=r,u)}function Yn(r,u,p,x,M){var z=ct.p;ct.p=z!==0&&8>z?z:8;var q=Ge.T,ne={};Ge.T=ne,Ml(r,!1,u,p);try{var xe=M(),Ye=Ge.S;if(Ye!==null&&Ye(ne,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var at=lu(xe,x);os(r,u,at,fs(r))}else os(r,u,x,fs(r))}catch(dt){os(r,u,{then:function(){},status:"rejected",reason:dt},fs())}finally{ct.p=z,Ge.T=q}}function zi(){}function Di(r,u,p,x){if(r.tag!==5)throw Error(d(476));var M=cn(r).queue;Yn(r,M,u,ht,p===null?zi:function(){return Kn(r),p(x)})}function cn(r){var u=r.memoizedState;if(u!==null)return u;u={memoizedState:ht,baseState:ht,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:ht},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:p},next:null},r.memoizedState=u,r=r.alternate,r!==null&&(r.memoizedState=u),u}function Kn(r){var u=cn(r).next.queue;os(r,u,{},fs())}function Xi(){return yi(De)}function pr(){return Ci().memoizedState}function br(){return Ci().memoizedState}function _a(r){for(var u=r.return;u!==null;){switch(u.tag){case 24:case 3:var p=fs();r=Sl(p);var x=Vo(u,r,p);x!==null&&(Os(x,u,p),vc(x,u,p)),u={cache:Tl()},r.payload=u;return}u=u.return}}function Rs(r,u,p){var x=fs();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Ho(r)?Cl(u,p):(p=yl(r,u,p,x),p!==null&&(Os(p,r,x),Dl(p,u,x)))}function qo(r,u,p){var x=fs();os(r,u,p,x)}function os(r,u,p,x){var M={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Ho(r))Cl(u,M);else{var z=r.alternate;if(r.lanes===0&&(z===null||z.lanes===0)&&(z=u.lastRenderedReducer,z!==null))try{var q=u.lastRenderedState,ne=z(q,p);if(M.hasEagerState=!0,M.eagerState=ne,pa(ne,q))return hh(r,u,M,0),Oi===null&&mc(),!1}catch{}finally{}if(p=yl(r,u,M,x),p!==null)return Os(p,r,x),Dl(p,u,x),!0}return!1}function Ml(r,u,p,x){if(x={lane:2,revertLane:op(),action:x,hasEagerState:!1,eagerState:null,next:null},Ho(r)){if(u)throw Error(d(479))}else u=yl(r,p,x,2),u!==null&&Os(u,r,2)}function Ho(r){var u=r.alternate;return r===Tn||u!==null&&u===Tn}function Cl(r,u){zt=wc=!0;var p=r.pending;p===null?u.next=u:(u.next=p.next,p.next=u),r.pending=u}function Dl(r,u,p){if((p&4194048)!==0){var x=u.lanes;x&=r.pendingLanes,p|=x,u.lanes=p,Vt(r,p)}}var jr={readContext:yi,use:Sc,useCallback:qi,useContext:qi,useEffect:qi,useImperativeHandle:qi,useLayoutEffect:qi,useInsertionEffect:qi,useMemo:qi,useReducer:qi,useRef:qi,useState:qi,useDebugValue:qi,useDeferredValue:qi,useTransition:qi,useSyncExternalStore:qi,useId:qi,useHostTransitionStatus:qi,useFormState:qi,useActionState:qi,useOptimistic:qi,useMemoCache:qi,useCacheRefresh:qi},ls={readContext:yi,use:Sc,useCallback:function(r,u){return ra().memoizedState=[r,u===void 0?null:u],r},useContext:yi,useEffect:He,useImperativeHandle:function(r,u,p){p=p!=null?p.concat([r]):null,ge(4194308,4,yt.bind(null,u,r),p)},useLayoutEffect:function(r,u){return ge(4194308,4,r,u)},useInsertionEffect:function(r,u){ge(4,2,r,u)},useMemo:function(r,u){var p=ra();u=u===void 0?null:u;var x=r();if(Gt){Hr(!0);try{r()}finally{Hr(!1)}}return p.memoizedState=[x,u],x},useReducer:function(r,u,p){var x=ra();if(p!==void 0){var M=p(u);if(Gt){Hr(!0);try{p(u)}finally{Hr(!1)}}}else M=u;return x.memoizedState=x.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},x.queue=r,r=r.dispatch=Rs.bind(null,Tn,r),[x.memoizedState,r]},useRef:function(r){var u=ra();return r={current:r},u.memoizedState=r},useState:function(r){r=E(r);var u=r.queue,p=qo.bind(null,Tn,u);return u.dispatch=p,[r.memoizedState,p]},useDebugValue:ot,useDeferredValue:function(r,u){var p=ra();return zn(p,r,u)},useTransition:function(){var r=E(!1);return r=Yn.bind(null,Tn,r.queue,!0,!1),ra().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,u,p){var x=Tn,M=ra();if(Un){if(p===void 0)throw Error(d(407));p=p()}else{if(p=u(),Oi===null)throw Error(d(349));(Dn&124)!==0||e(x,u,p)}M.memoizedState=p;var z={value:p,getSnapshot:u};return M.queue=z,He(f.bind(null,x,z,r),[r]),x.flags|=2048,fe(9,be(),o.bind(null,x,z,p,u),null),p},useId:function(){var r=ra(),u=Oi.identifierPrefix;if(Un){var p=ns,x=Ua;p=(x&~(1<<32-Me(x)-1)).toString(32)+p,u=""+u+"R"+p,p=Tc++,0<p&&(u+="H"+p.toString(32)),u+=""}else p=ya++,u=""+u+"r"+p.toString(32)+"";return r.memoizedState=u},useHostTransitionStatus:Xi,useFormState:le,useActionState:le,useOptimistic:function(r){var u=ra();u.memoizedState=u.baseState=r;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Ml.bind(null,Tn,!0,p),p.dispatch=u,[r,u]},useMemoCache:Yo,useCacheRefresh:function(){return ra().memoizedState=_a.bind(null,Tn)}},aa={readContext:yi,use:Sc,useCallback:Ot,useContext:yi,useEffect:Oe,useImperativeHandle:vt,useInsertionEffect:je,useLayoutEffect:$e,useMemo:fn,useReducer:mu,useRef:Se,useState:function(){return mu(Is)},useDebugValue:ot,useDeferredValue:function(r,u){var p=Ci();return Qn(p,ri.memoizedState,r,u)},useTransition:function(){var r=mu(Is)[0],u=Ci().memoizedState;return[typeof r=="boolean"?r:$o(r),u]},useSyncExternalStore:b,useId:pr,useHostTransitionStatus:Xi,useFormState:oe,useActionState:oe,useOptimistic:function(r,u){var p=Ci();return k(p,ri,r,u)},useMemoCache:Yo,useCacheRefresh:br},kl={readContext:yi,use:Sc,useCallback:Ot,useContext:yi,useEffect:Oe,useImperativeHandle:vt,useInsertionEffect:je,useLayoutEffect:$e,useMemo:fn,useReducer:Th,useRef:Se,useState:function(){return Th(Is)},useDebugValue:ot,useDeferredValue:function(r,u){var p=Ci();return ri===null?zn(p,r,u):Qn(p,ri.memoizedState,r,u)},useTransition:function(){var r=Th(Is)[0],u=Ci().memoizedState;return[typeof r=="boolean"?r:$o(r),u]},useSyncExternalStore:b,useId:pr,useHostTransitionStatus:Xi,useFormState:_e,useActionState:_e,useOptimistic:function(r,u){var p=Ci();return ri!==null?k(p,ri,r,u):(p.baseState=r,[r,p.queue.dispatch])},useMemoCache:Yo,useCacheRefresh:br},ki=null,Gi=0;function va(r){var u=Gi;return Gi+=1,ki===null&&(ki=[]),_c(ki,r,u)}function Ni(r,u){u=u.props.ref,r.ref=u!==void 0?u:null}function Il(r,u){throw u.$$typeof===B?Error(d(525)):(r=Object.prototype.toString.call(u),Error(d(31,r==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":r)))}function Ec(r){var u=r._init;return u(r._payload)}function _o(r){function u(Le,ze){if(r){var Ze=Le.deletions;Ze===null?(Le.deletions=[ze],Le.flags|=16):Ze.push(ze)}}function p(Le,ze){if(!r)return null;for(;ze!==null;)u(Le,ze),ze=ze.sibling;return null}function x(Le){for(var ze=new Map;Le!==null;)Le.key!==null?ze.set(Le.key,Le):ze.set(Le.index,Le),Le=Le.sibling;return ze}function M(Le,ze){return Le=Kr(Le,ze),Le.index=0,Le.sibling=null,Le}function z(Le,ze,Ze){return Le.index=Ze,r?(Ze=Le.alternate,Ze!==null?(Ze=Ze.index,Ze<ze?(Le.flags|=67108866,ze):Ze):(Le.flags|=67108866,ze)):(Le.flags|=1048576,ze)}function q(Le){return r&&Le.alternate===null&&(Le.flags|=67108866),Le}function ne(Le,ze,Ze,ut){return ze===null||ze.tag!==6?(ze=jf(Ze,Le.mode,ut),ze.return=Le,ze):(ze=M(ze,Ze),ze.return=Le,ze)}function xe(Le,ze,Ze,ut){var $t=Ze.type;return $t===ae?at(Le,ze,Ze.props.children,ut,Ze.key):ze!==null&&(ze.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===st&&Ec($t)===ze.type)?(ze=M(ze,Ze.props),Ni(ze,Ze),ze.return=Le,ze):(ze=Ed(Ze.type,Ze.key,Ze.props,null,Le.mode,ut),Ni(ze,Ze),ze.return=Le,ze)}function Ye(Le,ze,Ze,ut){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==Ze.containerInfo||ze.stateNode.implementation!==Ze.implementation?(ze=fh(Ze,Le.mode,ut),ze.return=Le,ze):(ze=M(ze,Ze.children||[]),ze.return=Le,ze)}function at(Le,ze,Ze,ut,$t){return ze===null||ze.tag!==7?(ze=_l(Ze,Le.mode,ut,$t),ze.return=Le,ze):(ze=M(ze,Ze),ze.return=Le,ze)}function dt(Le,ze,Ze){if(typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint")return ze=jf(""+ze,Le.mode,Ze),ze.return=Le,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case V:return Ze=Ed(ze.type,ze.key,ze.props,null,Le.mode,Ze),Ni(Ze,ze),Ze.return=Le,Ze;case G:return ze=fh(ze,Le.mode,Ze),ze.return=Le,ze;case st:var ut=ze._init;return ze=ut(ze._payload),dt(Le,ze,Ze)}if(ln(ze)||Rt(ze))return ze=_l(ze,Le.mode,Ze,null),ze.return=Le,ze;if(typeof ze.then=="function")return dt(Le,va(ze),Ze);if(ze.$$typeof===Fe)return dt(Le,Fo(Le,ze),Ze);Il(Le,ze)}return null}function Xe(Le,ze,Ze,ut){var $t=ze!==null?ze.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return $t!==null?null:ne(Le,ze,""+Ze,ut);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case V:return Ze.key===$t?xe(Le,ze,Ze,ut):null;case G:return Ze.key===$t?Ye(Le,ze,Ze,ut):null;case st:return $t=Ze._init,Ze=$t(Ze._payload),Xe(Le,ze,Ze,ut)}if(ln(Ze)||Rt(Ze))return $t!==null?null:at(Le,ze,Ze,ut,null);if(typeof Ze.then=="function")return Xe(Le,ze,va(Ze),ut);if(Ze.$$typeof===Fe)return Xe(Le,ze,Fo(Le,Ze),ut);Il(Le,Ze)}return null}function Qe(Le,ze,Ze,ut,$t){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Le=Le.get(Ze)||null,ne(ze,Le,""+ut,$t);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case V:return Le=Le.get(ut.key===null?Ze:ut.key)||null,xe(ze,Le,ut,$t);case G:return Le=Le.get(ut.key===null?Ze:ut.key)||null,Ye(ze,Le,ut,$t);case st:var kn=ut._init;return ut=kn(ut._payload),Qe(Le,ze,Ze,ut,$t)}if(ln(ut)||Rt(ut))return Le=Le.get(Ze)||null,at(ze,Le,ut,$t,null);if(typeof ut.then=="function")return Qe(Le,ze,Ze,va(ut),$t);if(ut.$$typeof===Fe)return Qe(Le,ze,Ze,Fo(ze,ut),$t);Il(ze,ut)}return null}function un(Le,ze,Ze,ut){for(var $t=null,kn=null,Ut=ze,Jt=ze=0,Zr=null;Ut!==null&&Jt<Ze.length;Jt++){Ut.index>Jt?(Zr=Ut,Ut=null):Zr=Ut.sibling;var ei=Xe(Le,Ut,Ze[Jt],ut);if(ei===null){Ut===null&&(Ut=Zr);break}r&&Ut&&ei.alternate===null&&u(Le,Ut),ze=z(ei,ze,Jt),kn===null?$t=ei:kn.sibling=ei,kn=ei,Ut=Zr}if(Jt===Ze.length)return p(Le,Ut),Un&&jo(Le,Jt),$t;if(Ut===null){for(;Jt<Ze.length;Jt++)Ut=dt(Le,Ze[Jt],ut),Ut!==null&&(ze=z(Ut,ze,Jt),kn===null?$t=Ut:kn.sibling=Ut,kn=Ut);return Un&&jo(Le,Jt),$t}for(Ut=x(Ut);Jt<Ze.length;Jt++)Zr=Qe(Ut,Le,Jt,Ze[Jt],ut),Zr!==null&&(r&&Zr.alternate!==null&&Ut.delete(Zr.key===null?Jt:Zr.key),ze=z(Zr,ze,Jt),kn===null?$t=Zr:kn.sibling=Zr,kn=Zr);return r&&Ut.forEach(function(Mu){return u(Le,Mu)}),Un&&jo(Le,Jt),$t}function sn(Le,ze,Ze,ut){if(Ze==null)throw Error(d(151));for(var $t=null,kn=null,Ut=ze,Jt=ze=0,Zr=null,ei=Ze.next();Ut!==null&&!ei.done;Jt++,ei=Ze.next()){Ut.index>Jt?(Zr=Ut,Ut=null):Zr=Ut.sibling;var Mu=Xe(Le,Ut,ei.value,ut);if(Mu===null){Ut===null&&(Ut=Zr);break}r&&Ut&&Mu.alternate===null&&u(Le,Ut),ze=z(Mu,ze,Jt),kn===null?$t=Mu:kn.sibling=Mu,kn=Mu,Ut=Zr}if(ei.done)return p(Le,Ut),Un&&jo(Le,Jt),$t;if(Ut===null){for(;!ei.done;Jt++,ei=Ze.next())ei=dt(Le,ei.value,ut),ei!==null&&(ze=z(ei,ze,Jt),kn===null?$t=ei:kn.sibling=ei,kn=ei);return Un&&jo(Le,Jt),$t}for(Ut=x(Ut);!ei.done;Jt++,ei=Ze.next())ei=Qe(Ut,Le,Jt,ei.value,ut),ei!==null&&(r&&ei.alternate!==null&&Ut.delete(ei.key===null?Jt:ei.key),ze=z(ei,ze,Jt),kn===null?$t=ei:kn.sibling=ei,kn=ei);return r&&Ut.forEach(function(Vv){return u(Le,Vv)}),Un&&jo(Le,Jt),$t}function xi(Le,ze,Ze,ut){if(typeof Ze=="object"&&Ze!==null&&Ze.type===ae&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case V:e:{for(var $t=Ze.key;ze!==null;){if(ze.key===$t){if($t=Ze.type,$t===ae){if(ze.tag===7){p(Le,ze.sibling),ut=M(ze,Ze.props.children),ut.return=Le,Le=ut;break e}}else if(ze.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===st&&Ec($t)===ze.type){p(Le,ze.sibling),ut=M(ze,Ze.props),Ni(ut,Ze),ut.return=Le,Le=ut;break e}p(Le,ze);break}else u(Le,ze);ze=ze.sibling}Ze.type===ae?(ut=_l(Ze.props.children,Le.mode,ut,Ze.key),ut.return=Le,Le=ut):(ut=Ed(Ze.type,Ze.key,Ze.props,null,Le.mode,ut),Ni(ut,Ze),ut.return=Le,Le=ut)}return q(Le);case G:e:{for($t=Ze.key;ze!==null;){if(ze.key===$t)if(ze.tag===4&&ze.stateNode.containerInfo===Ze.containerInfo&&ze.stateNode.implementation===Ze.implementation){p(Le,ze.sibling),ut=M(ze,Ze.children||[]),ut.return=Le,Le=ut;break e}else{p(Le,ze);break}else u(Le,ze);ze=ze.sibling}ut=fh(Ze,Le.mode,ut),ut.return=Le,Le=ut}return q(Le);case st:return $t=Ze._init,Ze=$t(Ze._payload),xi(Le,ze,Ze,ut)}if(ln(Ze))return un(Le,ze,Ze,ut);if(Rt(Ze)){if($t=Rt(Ze),typeof $t!="function")throw Error(d(150));return Ze=$t.call(Ze),sn(Le,ze,Ze,ut)}if(typeof Ze.then=="function")return xi(Le,ze,va(Ze),ut);if(Ze.$$typeof===Fe)return xi(Le,ze,Fo(Le,Ze),ut);Il(Le,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,ze!==null&&ze.tag===6?(p(Le,ze.sibling),ut=M(ze,Ze),ut.return=Le,Le=ut):(p(Le,ze),ut=jf(Ze,Le.mode,ut),ut.return=Le,Le=ut),q(Le)):p(Le,ze)}return function(Le,ze,Ze,ut){try{Gi=0;var $t=xi(Le,ze,Ze,ut);return ki=null,$t}catch(Ut){if(Ut===Uo||Ut===Dt)throw Ut;var kn=Ba(29,Ut,null,Le.mode);return kn.lanes=ut,kn.return=Le,kn}finally{}}}var sa=_o(!0),Xo=_o(!1),Za=nt(null),Wi=null;function Wo(r){var u=r.alternate;bt(_i,_i.current&1),bt(Za,r),Wi===null&&(u===null||ia.current!==null||u.memoizedState!==null)&&(Wi=r)}function zd(r){if(r.tag===22){if(bt(_i,_i.current),bt(Za,r),Wi===null){var u=r.alternate;u!==null&&u.memoizedState!==null&&(Wi=r)}}else Ps()}function Ps(){bt(_i,_i.current),bt(Za,Za.current)}function cs(r){Ct(Za),Wi===r&&(Wi=null),Ct(_i)}var _i=nt(0);function us(r){for(var u=r;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Kd(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function sm(r,u,p,x){u=r.memoizedState,p=p(x,u),p=p==null?u:N({},u,p),r.memoizedState=p,r.lanes===0&&(r.updateQueue.baseState=p)}var Ig={enqueueSetState:function(r,u,p){r=r._reactInternals;var x=fs(),M=Sl(x);M.payload=u,p!=null&&(M.callback=p),u=Vo(r,M,x),u!==null&&(Os(u,r,x),vc(u,r,x))},enqueueReplaceState:function(r,u,p){r=r._reactInternals;var x=fs(),M=Sl(x);M.tag=1,M.payload=u,p!=null&&(M.callback=p),u=Vo(r,M,x),u!==null&&(Os(u,r,x),vc(u,r,x))},enqueueForceUpdate:function(r,u){r=r._reactInternals;var p=fs(),x=Sl(p);x.tag=2,u!=null&&(x.callback=u),u=Vo(r,x,p),u!==null&&(Os(u,r,p),vc(u,r,p))}};function om(r,u,p,x,M,z,q){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(x,z,q):u.prototype&&u.prototype.isPureReactComponent?!eu(p,x)||!eu(M,z):!0}function Rg(r,u,p,x){r=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,x),u.state!==r&&Ig.enqueueReplaceState(u,u.state,null)}function Sh(r,u){var p=u;if("ref"in u){p={};for(var x in u)x!=="ref"&&(p[x]=u[x])}if(r=r.defaultProps){p===u&&(p=N({},p));for(var M in r)p[M]===void 0&&(p[M]=r[M])}return p}var $f=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function N_(r){$f(r)}function lm(r){console.error(r)}function L_(r){$f(r)}function Nd(r,u){try{var p=r.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(x){setTimeout(function(){throw x})}}function Pg(r,u,p){try{var x=r.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function cm(r,u,p){return p=Sl(p),p.tag=3,p.payload={element:null},p.callback=function(){Nd(r,u)},p}function Eh(r){return r=Sl(r),r.tag=3,r}function O_(r,u,p,x){var M=p.type.getDerivedStateFromError;if(typeof M=="function"){var z=x.value;r.payload=function(){return M(z)},r.callback=function(){Pg(u,p,x)}}var q=p.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(r.callback=function(){Pg(u,p,x),typeof M!="function"&&(kc===null?kc=new Set([this]):kc.add(this));var ne=x.stack;this.componentDidCatch(x.value,{componentStack:ne!==null?ne:""})})}function Yf(r,u,p,x,M){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(u=p.alternate,u!==null&&au(u,p,M,!0),p=Za.current,p!==null){switch(p.tag){case 13:return Wi===null?Sm():p.alternate===null&&or===0&&(or=3),p.flags&=-257,p.flags|=65536,p.lanes=M,x===_h?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([x]):u.add(x),ny(r,x,M)),!1;case 22:return p.flags|=65536,x===_h?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([x]):p.add(x)),ny(r,x,M)),!1}throw Error(d(435,p.tag))}return ny(r,x,M),Sm(),!1}if(Un)return u=Za.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=M,x!==mh&&(r=Error(d(422),{cause:x}),Bo(Cr(r,p)))):(x!==mh&&(u=Error(d(423),{cause:x}),Bo(Cr(u,p))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,x=Cr(x,p),M=cm(r.stateNode,x,M),xh(r,M),or!==4&&(or=2)),!1;var z=Error(d(520),{cause:x});if(z=Cr(z,p),xu===null?xu=[z]:xu.push(z),or!==4&&(or=2),u===null)return!0;x=Cr(x,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,r=M&-M,p.lanes|=r,r=cm(p.stateNode,x,r),xh(p,r),!1;case 1:if(u=p.type,z=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(kc===null||!kc.has(z))))return p.flags|=65536,M&=-M,p.lanes|=M,M=Eh(M),O_(M,r,p,x),xh(p,M),!1}p=p.return}while(p!==null);return!1}var qf=Error(d(461)),xr=!1;function oa(r,u,p,x){u.child=r===null?Xo(u,null,p,x):sa(u,r.child,p,x)}function zg(r,u,p,x,M){p=p.render;var z=u.ref;if("ref"in x){var q={};for(var ne in x)ne!=="ref"&&(q[ne]=x[ne])}else q=x;return wl(u),x=Zf(r,u,p,q,z,M),ne=pu(),r!==null&&!xr?(El(r,u,M),Qo(r,u,M)):(Un&&ne&&ph(u),u.flags|=1,oa(r,u,x,M),u.child)}function j_(r,u,p,x,M){if(r===null){var z=p.type;return typeof z=="function"&&!Sd(z)&&z.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=z,B_(r,u,z,x,M)):(r=Ed(p.type,null,x,u,u.mode,M),r.ref=u.ref,r.return=u,u.child=r)}if(z=r.child,!mm(r,M)){var q=z.memoizedProps;if(p=p.compare,p=p!==null?p:eu,p(q,x)&&r.ref===u.ref)return Qo(r,u,M)}return u.flags|=1,r=Kr(z,x),r.ref=u.ref,r.return=u,u.child=r}function B_(r,u,p,x,M){if(r!==null){var z=r.memoizedProps;if(eu(z,x)&&r.ref===u.ref)if(xr=!1,u.pendingProps=x=z,mm(r,M))(r.flags&131072)!==0&&(xr=!0);else return u.lanes=r.lanes,Qo(r,u,M)}return Og(r,u,p,x,M)}function Ng(r,u,p){var x=u.pendingProps,M=x.children,z=r!==null?r.memoizedState:null;if(x.mode==="hidden"){if((u.flags&128)!==0){if(x=z!==null?z.baseLanes|p:p,r!==null){for(M=u.child=r.child,z=0;M!==null;)z=z|M.lanes|M.childLanes,M=M.sibling;u.childLanes=z&~x}else u.childLanes=0,u.child=null;return Lg(r,u,x,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},r!==null&&Id(u,z!==null?z.cachePool:null),z!==null?xc(u,z):wh(),zd(u);else return u.lanes=u.childLanes=536870912,Lg(r,u,z!==null?z.baseLanes|p:p,p)}else z!==null?(Id(u,z.cachePool),xc(u,z),Ps(),u.memoizedState=null):(r!==null&&Id(u,null),wh(),Ps());return oa(r,u,M,p),u.child}function Lg(r,u,p,x){var M=Ff();return M=M===null?null:{parent:fr._currentValue,pool:M},u.memoizedState={baseLanes:p,cachePool:M},r!==null&&Id(u,null),wh(),zd(u),r!==null&&au(r,u,x,!0),null}function Hf(r,u){var p=u.ref;if(p===null)r!==null&&r.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(d(284));(r===null||r.ref!==p)&&(u.flags|=4194816)}}function Og(r,u,p,x,M){return wl(u),p=Zf(r,u,p,x,void 0,M),x=pu(),r!==null&&!xr?(El(r,u,M),Qo(r,u,M)):(Un&&x&&ph(u),u.flags|=1,oa(r,u,p,M),u.child)}function um(r,u,p,x,M,z){return wl(u),u.updateQueue=null,p=Wn(u,x,p,M),fu(r),x=pu(),r!==null&&!xr?(El(r,u,z),Qo(r,u,z)):(Un&&x&&ph(u),u.flags|=1,oa(r,u,p,z),u.child)}function jg(r,u,p,x,M){if(wl(u),u.stateNode===null){var z=gn,q=p.contextType;typeof q=="object"&&q!==null&&(z=yi(q)),z=new p(x,z),u.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=Ig,u.stateNode=z,z._reactInternals=u,z=u.stateNode,z.props=x,z.state=u.memoizedState,z.refs={},Uf(u),q=p.contextType,z.context=typeof q=="object"&&q!==null?yi(q):gn,z.state=u.memoizedState,q=p.getDerivedStateFromProps,typeof q=="function"&&(sm(u,p,q,x),z.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(q=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),q!==z.state&&Ig.enqueueReplaceState(z,z.state,null),bc(u,x,z,M),du(),z.state=u.memoizedState),typeof z.componentDidMount=="function"&&(u.flags|=4194308),x=!0}else if(r===null){z=u.stateNode;var ne=u.memoizedProps,xe=Sh(p,ne);z.props=xe;var Ye=z.context,at=p.contextType;q=gn,typeof at=="object"&&at!==null&&(q=yi(at));var dt=p.getDerivedStateFromProps;at=typeof dt=="function"||typeof z.getSnapshotBeforeUpdate=="function",ne=u.pendingProps!==ne,at||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ne||Ye!==q)&&Rg(u,z,x,q),ks=!1;var Xe=u.memoizedState;z.state=Xe,bc(u,x,z,M),du(),Ye=u.memoizedState,ne||Xe!==Ye||ks?(typeof dt=="function"&&(sm(u,p,dt,x),Ye=u.memoizedState),(xe=ks||om(u,p,xe,x,Xe,Ye,q))?(at||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(u.flags|=4194308)):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=Ye),z.props=x,z.state=Ye,z.context=q,x=xe):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{z=u.stateNode,hu(r,u),q=u.memoizedProps,at=Sh(p,q),z.props=at,dt=u.pendingProps,Xe=z.context,Ye=p.contextType,xe=gn,typeof Ye=="object"&&Ye!==null&&(xe=yi(Ye)),ne=p.getDerivedStateFromProps,(Ye=typeof ne=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(q!==dt||Xe!==xe)&&Rg(u,z,x,xe),ks=!1,Xe=u.memoizedState,z.state=Xe,bc(u,x,z,M),du();var Qe=u.memoizedState;q!==dt||Xe!==Qe||ks||r!==null&&r.dependencies!==null&&yh(r.dependencies)?(typeof ne=="function"&&(sm(u,p,ne,x),Qe=u.memoizedState),(at=ks||om(u,p,at,x,Xe,Qe,xe)||r!==null&&r.dependencies!==null&&yh(r.dependencies))?(Ye||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(x,Qe,xe),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(x,Qe,xe)),typeof z.componentDidUpdate=="function"&&(u.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof z.componentDidUpdate!="function"||q===r.memoizedProps&&Xe===r.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||q===r.memoizedProps&&Xe===r.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=Qe),z.props=x,z.state=Qe,z.context=xe,x=at):(typeof z.componentDidUpdate!="function"||q===r.memoizedProps&&Xe===r.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||q===r.memoizedProps&&Xe===r.memoizedState||(u.flags|=1024),x=!1)}return z=x,Hf(r,u),x=(u.flags&128)!==0,z||x?(z=u.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:z.render(),u.flags|=1,r!==null&&x?(u.child=sa(u,r.child,null,M),u.child=sa(u,null,p,M)):oa(r,u,p,M),u.memoizedState=z.state,r=u.child):r=Qo(r,u,M),r}function hm(r,u,p,x){return ea(),u.flags|=256,oa(r,u,p,x),u.child}var Ah={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ba(r){return{baseLanes:r,cachePool:cu()}}function dm(r,u,p){return r=r!==null?r.childLanes&~p:0,u&&(r|=Ls),r}function fm(r,u,p){var x=u.pendingProps,M=!1,z=(u.flags&128)!==0,q;if((q=z)||(q=r!==null&&r.memoizedState===null?!1:(_i.current&2)!==0),q&&(M=!0,u.flags&=-129),q=(u.flags&32)!==0,u.flags&=-33,r===null){if(Un){if(M?Wo(u):Ps(),Un){var ne=Ri,xe;if(xe=ne){e:{for(xe=ne,ne=Va;xe.nodeType!==8;){if(!ne){ne=null;break e}if(xe=Jo(xe.nextSibling),xe===null){ne=null;break e}}ne=xe}ne!==null?(u.memoizedState={dehydrated:ne,treeContext:As!==null?{id:Ua,overflow:ns}:null,retryLane:536870912,hydrationErrors:null},xe=Ba(18,null,null,0),xe.stateNode=ne,xe.return=u,u.child=xe,sr=u,Ri=null,xe=!0):xe=!1}xe||gc(u)}if(ne=u.memoizedState,ne!==null&&(ne=ne.dehydrated,ne!==null))return Kd(ne)?u.lanes=32:u.lanes=536870912,null;cs(u)}return ne=x.children,x=x.fallback,M?(Ps(),M=u.mode,ne=Xf({mode:"hidden",children:ne},M),x=_l(x,M,p,null),ne.return=u,x.return=u,ne.sibling=x,u.child=ne,M=u.child,M.memoizedState=ba(p),M.childLanes=dm(r,q,p),u.memoizedState=Ah,x):(Wo(u),Bg(u,ne))}if(xe=r.memoizedState,xe!==null&&(ne=xe.dehydrated,ne!==null)){if(z)u.flags&256?(Wo(u),u.flags&=-257,u=Fg(r,u,p)):u.memoizedState!==null?(Ps(),u.child=r.child,u.flags|=128,u=null):(Ps(),M=x.fallback,ne=u.mode,x=Xf({mode:"visible",children:x.children},ne),M=_l(M,ne,p,null),M.flags|=2,x.return=u,M.return=u,x.sibling=M,u.child=x,sa(u,r.child,null,p),x=u.child,x.memoizedState=ba(p),x.childLanes=dm(r,q,p),u.memoizedState=Ah,u=M);else if(Wo(u),Kd(ne)){if(q=ne.nextSibling&&ne.nextSibling.dataset,q)var Ye=q.dgst;q=Ye,x=Error(d(419)),x.stack="",x.digest=q,Bo({value:x,source:null,stack:null}),u=Fg(r,u,p)}else if(xr||au(r,u,p,!1),q=(p&r.childLanes)!==0,xr||q){if(q=Oi,q!==null&&(x=p&-p,x=(x&42)!==0?1:on(x),x=(x&(q.suspendedLanes|p))!==0?0:x,x!==0&&x!==xe.retryLane))throw xe.retryLane=x,ja(r,x),Os(q,r,x),qf;ne.data==="$?"||Sm(),u=Fg(r,u,p)}else ne.data==="$?"?(u.flags|=192,u.child=r.child,u=null):(r=xe.treeContext,Ri=Jo(ne.nextSibling),sr=u,Un=!0,xl=null,Va=!1,r!==null&&(Fa[Jr++]=Ua,Fa[Jr++]=ns,Fa[Jr++]=As,Ua=r.id,ns=r.overflow,As=u),u=Bg(u,x.children),u.flags|=4096);return u}return M?(Ps(),M=x.fallback,ne=u.mode,xe=r.child,Ye=xe.sibling,x=Kr(xe,{mode:"hidden",children:x.children}),x.subtreeFlags=xe.subtreeFlags&65011712,Ye!==null?M=Kr(Ye,M):(M=_l(M,ne,p,null),M.flags|=2),M.return=u,x.return=u,x.sibling=M,u.child=x,x=M,M=u.child,ne=r.child.memoizedState,ne===null?ne=ba(p):(xe=ne.cachePool,xe!==null?(Ye=fr._currentValue,xe=xe.parent!==Ye?{parent:Ye,pool:Ye}:xe):xe=cu(),ne={baseLanes:ne.baseLanes|p,cachePool:xe}),M.memoizedState=ne,M.childLanes=dm(r,q,p),u.memoizedState=Ah,x):(Wo(u),p=r.child,r=p.sibling,p=Kr(p,{mode:"visible",children:x.children}),p.return=u,p.sibling=null,r!==null&&(q=u.deletions,q===null?(u.deletions=[r],u.flags|=16):q.push(r)),u.child=p,u.memoizedState=null,p)}function Bg(r,u){return u=Xf({mode:"visible",children:u},r.mode),u.return=r,r.child=u}function Xf(r,u){return r=Ba(22,r,null,u),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Fg(r,u,p){return sa(u,r.child,null,p),r=Bg(u,u.pendingProps.children),r.flags|=2,u.memoizedState=null,r}function F_(r,u,p){r.lanes|=u;var x=r.alternate;x!==null&&(x.lanes|=u),Cd(r.return,u,p)}function pm(r,u,p,x,M){var z=r.memoizedState;z===null?r.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:M}:(z.isBackwards=u,z.rendering=null,z.renderingStartTime=0,z.last=x,z.tail=p,z.tailMode=M)}function U_(r,u,p){var x=u.pendingProps,M=x.revealOrder,z=x.tail;if(oa(r,u,x.children,p),x=_i.current,(x&2)!==0)x=x&1|2,u.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=u.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&F_(r,p,u);else if(r.tag===19)F_(r,p,u);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===u)break e;for(;r.sibling===null;){if(r.return===null||r.return===u)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}x&=1}switch(bt(_i,x),M){case"forwards":for(p=u.child,M=null;p!==null;)r=p.alternate,r!==null&&us(r)===null&&(M=p),p=p.sibling;p=M,p===null?(M=u.child,u.child=null):(M=p.sibling,p.sibling=null),pm(u,!1,M,p,z);break;case"backwards":for(p=null,M=u.child,u.child=null;M!==null;){if(r=M.alternate,r!==null&&us(r)===null){u.child=M;break}r=M.sibling,M.sibling=p,p=M,M=r}pm(u,!0,p,null,z);break;case"together":pm(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Qo(r,u,p){if(r!==null&&(u.dependencies=r.dependencies),Nl|=u.lanes,(p&u.childLanes)===0)if(r!==null){if(au(r,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(r!==null&&u.child!==r.child)throw Error(d(153));if(u.child!==null){for(r=u.child,p=Kr(r,r.pendingProps),u.child=p,p.return=u;r.sibling!==null;)r=r.sibling,p=p.sibling=Kr(r,r.pendingProps),p.return=u;p.sibling=null}return u.child}function mm(r,u){return(r.lanes&u)!==0?!0:(r=r.dependencies,!!(r!==null&&yh(r)))}function V_(r,u,p){switch(u.tag){case 3:mn(u,u.stateNode.containerInfo),ta(u,fr,r.memoizedState.cache),ea();break;case 27:case 5:Ea(u);break;case 4:mn(u,u.stateNode.containerInfo);break;case 10:ta(u,u.type,u.memoizedProps.value);break;case 13:var x=u.memoizedState;if(x!==null)return x.dehydrated!==null?(Wo(u),u.flags|=128,null):(p&u.child.childLanes)!==0?fm(r,u,p):(Wo(u),r=Qo(r,u,p),r!==null?r.sibling:null);Wo(u);break;case 19:var M=(r.flags&128)!==0;if(x=(p&u.childLanes)!==0,x||(au(r,u,p,!1),x=(p&u.childLanes)!==0),M){if(x)return U_(r,u,p);u.flags|=128}if(M=u.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),bt(_i,_i.current),x)break;return null;case 22:case 23:return u.lanes=0,Ng(r,u,p);case 24:ta(u,fr,r.memoizedState.cache)}return Qo(r,u,p)}function G_(r,u,p){if(r!==null)if(r.memoizedProps!==u.pendingProps)xr=!0;else{if(!mm(r,p)&&(u.flags&128)===0)return xr=!1,V_(r,u,p);xr=(r.flags&131072)!==0}else xr=!1,Un&&(u.flags&1048576)!==0&&bl(u,iu,u.index);switch(u.lanes=0,u.tag){case 16:e:{r=u.pendingProps;var x=u.elementType,M=x._init;if(x=M(x._payload),u.type=x,typeof x=="function")Sd(x)?(r=Sh(x,r),u.tag=1,u=jg(null,u,x,r,p)):(u.tag=0,u=Og(null,u,x,r,p));else{if(x!=null){if(M=x.$$typeof,M===qe){u.tag=11,u=zg(null,u,x,r,p);break e}else if(M===mt){u.tag=14,u=j_(null,u,x,r,p);break e}}throw u=en(x)||x,Error(d(306,u,""))}}return u;case 0:return Og(r,u,u.type,u.pendingProps,p);case 1:return x=u.type,M=Sh(x,u.pendingProps),jg(r,u,x,M,p);case 3:e:{if(mn(u,u.stateNode.containerInfo),r===null)throw Error(d(387));x=u.pendingProps;var z=u.memoizedState;M=z.element,hu(r,u),bc(u,x,null,p);var q=u.memoizedState;if(x=q.cache,ta(u,fr,x),x!==z.cache&&Dd(u,[fr],p,!0),du(),x=q.element,z.isDehydrated)if(z={element:x,isDehydrated:!1,cache:q.cache},u.updateQueue.baseState=z,u.memoizedState=z,u.flags&256){u=hm(r,u,x,p);break e}else if(x!==M){M=Cr(Error(d(424)),u),Bo(M),u=hm(r,u,x,p);break e}else{switch(r=u.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ri=Jo(r.firstChild),sr=u,Un=!0,xl=null,Va=!0,p=Xo(u,null,x,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(ea(),x===M){u=Qo(r,u,p);break e}oa(r,u,x,p)}u=u.child}return u;case 26:return Hf(r,u),r===null?(p=gp(u.type,null,u.pendingProps,null))?u.memoizedState=p:Un||(p=u.type,r=u.pendingProps,x=fp(Bt.current).createElement(p),x[Wt]=u,x[nn]=r,lr(x,p,r),Mi(x),u.stateNode=x):u.memoizedState=gp(u.type,r.memoizedProps,u.pendingProps,r.memoizedState),null;case 27:return Ea(u),r===null&&Un&&(x=u.stateNode=Fr(u.type,u.pendingProps,Bt.current),sr=u,Va=!0,M=Ri,Rc(u.type)?(dy=M,Ri=Jo(x.firstChild)):Ri=M),oa(r,u,u.pendingProps.children,p),Hf(r,u),r===null&&(u.flags|=4194304),u.child;case 5:return r===null&&Un&&((M=x=Ri)&&(x=Lm(x,u.type,u.pendingProps,Va),x!==null?(u.stateNode=x,sr=u,Ri=Jo(x.firstChild),Va=!1,M=!0):M=!1),M||gc(u)),Ea(u),M=u.type,z=u.pendingProps,q=r!==null?r.memoizedProps:null,x=z.children,jl(M,z)?x=null:q!==null&&jl(M,q)&&(u.flags|=32),u.memoizedState!==null&&(M=Zf(r,u,Hi,null,null,p),De._currentValue=M),Hf(r,u),oa(r,u,x,p),u.child;case 6:return r===null&&Un&&((r=p=Ri)&&(p=Om(p,u.pendingProps,Va),p!==null?(u.stateNode=p,sr=u,Ri=null,r=!0):r=!1),r||gc(u)),null;case 13:return fm(r,u,p);case 4:return mn(u,u.stateNode.containerInfo),x=u.pendingProps,r===null?u.child=sa(u,null,x,p):oa(r,u,x,p),u.child;case 11:return zg(r,u,u.type,u.pendingProps,p);case 7:return oa(r,u,u.pendingProps,p),u.child;case 8:return oa(r,u,u.pendingProps.children,p),u.child;case 12:return oa(r,u,u.pendingProps.children,p),u.child;case 10:return x=u.pendingProps,ta(u,u.type,x.value),oa(r,u,x.children,p),u.child;case 9:return M=u.type._context,x=u.pendingProps.children,wl(u),M=yi(M),x=x(M),u.flags|=1,oa(r,u,x,p),u.child;case 14:return j_(r,u,u.type,u.pendingProps,p);case 15:return B_(r,u,u.type,u.pendingProps,p);case 19:return U_(r,u,p);case 31:return x=u.pendingProps,p=u.mode,x={mode:x.mode,children:x.children},r===null?(p=Xf(x,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=Kr(r.child,x),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return Ng(r,u,p);case 24:return wl(u),x=yi(fr),r===null?(M=Ff(),M===null&&(M=Oi,z=Tl(),M.pooledCache=z,z.refCount++,z!==null&&(M.pooledCacheLanes|=p),M=z),u.memoizedState={parent:x,cache:M},Uf(u),ta(u,fr,M)):((r.lanes&p)!==0&&(hu(r,u),bc(u,null,null,p),du()),M=r.memoizedState,z=u.memoizedState,M.parent!==x?(M={parent:x,cache:x},u.memoizedState=M,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=M),ta(u,fr,x)):(x=z.cache,ta(u,fr,x),x!==M.cache&&Dd(u,[fr],p,!0))),oa(r,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(d(156,u.tag))}function Ac(r){r.flags|=4}function Z_(r,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!P(u)){if(u=Za.current,u!==null&&((Dn&4194048)===Dn?Wi!==null:(Dn&62914560)!==Dn&&(Dn&536870912)===0||u!==Wi))throw Ds=_h,as;r.flags|=8192}}function Ld(r,u){u!==null&&(r.flags|=4),r.flags&16384&&(u=r.tag!==22?it():536870912,r.lanes|=u,Hd|=u)}function Mh(r,u){if(!Un)switch(r.tailMode){case"hidden":u=r.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?r.tail=null:p.sibling=null;break;case"collapsed":p=r.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?u||r.tail===null?r.tail=null:r.tail.sibling=null:x.sibling=null}}function Qi(r){var u=r.alternate!==null&&r.alternate.child===r.child,p=0,x=0;if(u)for(var M=r.child;M!==null;)p|=M.lanes|M.childLanes,x|=M.subtreeFlags&65011712,x|=M.flags&65011712,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)p|=M.lanes|M.childLanes,x|=M.subtreeFlags,x|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=x,r.childLanes=p,u}function Ch(r,u,p){var x=u.pendingProps;switch(ru(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qi(u),null;case 1:return Qi(u),null;case 3:return p=u.stateNode,x=null,r!==null&&(x=r.memoizedState.cache),u.memoizedState.cache!==x&&(u.flags|=2048),Ms(fr),mi(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(r===null||r.child===null)&&(Ca(u)?Ac(u):r===null||r.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,gh())),Qi(u),null;case 26:return p=u.memoizedState,r===null?(Ac(u),p!==null?(Qi(u),Z_(u,p)):(Qi(u),u.flags&=-16777217)):p?p!==r.memoizedState?(Ac(u),Qi(u),Z_(u,p)):(Qi(u),u.flags&=-16777217):(r.memoizedProps!==x&&Ac(u),Qi(u),u.flags&=-16777217),null;case 27:ua(u),p=Bt.current;var M=u.type;if(r!==null&&u.stateNode!=null)r.memoizedProps!==x&&Ac(u);else{if(!x){if(u.stateNode===null)throw Error(d(166));return Qi(u),null}r=Pt.current,Ca(u)?Ad(u):(r=Fr(M,x,p),u.stateNode=r,Ac(u))}return Qi(u),null;case 5:if(ua(u),p=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==x&&Ac(u);else{if(!x){if(u.stateNode===null)throw Error(d(166));return Qi(u),null}if(r=Pt.current,Ca(u))Ad(u);else{switch(M=fp(Bt.current),r){case 1:r=M.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:r=M.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":r=M.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":r=M.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof x.is=="string"?M.createElement("select",{is:x.is}):M.createElement("select"),x.multiple?r.multiple=!0:x.size&&(r.size=x.size);break;default:r=typeof x.is=="string"?M.createElement(p,{is:x.is}):M.createElement(p)}}r[Wt]=u,r[nn]=x;e:for(M=u.child;M!==null;){if(M.tag===5||M.tag===6)r.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===u)break e;for(;M.sibling===null;){if(M.return===null||M.return===u)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}u.stateNode=r;e:switch(lr(r,p,x),p){case"button":case"input":case"select":case"textarea":r=!!x.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Ac(u)}}return Qi(u),u.flags&=-16777217,null;case 6:if(r&&u.stateNode!=null)r.memoizedProps!==x&&Ac(u);else{if(typeof x!="string"&&u.stateNode===null)throw Error(d(166));if(r=Bt.current,Ca(u)){if(r=u.stateNode,p=u.memoizedProps,x=null,M=sr,M!==null)switch(M.tag){case 27:case 5:x=M.memoizedProps}r[Wt]=u,r=!!(r.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||cy(r.nodeValue,p)),r||gc(u)}else r=fp(r).createTextNode(x),r[Wt]=u,u.stateNode=r}return Qi(u),null;case 13:if(x=u.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=Ca(u),x!==null&&x.dehydrated!==null){if(r===null){if(!M)throw Error(d(318));if(M=u.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(d(317));M[Wt]=u}else ea(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Qi(u),M=!1}else M=gh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=M),M=!0;if(!M)return u.flags&256?(cs(u),u):(cs(u),null)}if(cs(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=x!==null,r=r!==null&&r.memoizedState!==null,p){x=u.child,M=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(M=x.alternate.memoizedState.cachePool.pool);var z=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(z=x.memoizedState.cachePool.pool),z!==M&&(x.flags|=2048)}return p!==r&&p&&(u.child.flags|=8192),Ld(u,u.updateQueue),Qi(u),null;case 4:return mi(),r===null&&Dm(u.stateNode.containerInfo),Qi(u),null;case 10:return Ms(u.type),Qi(u),null;case 19:if(Ct(_i),M=u.memoizedState,M===null)return Qi(u),null;if(x=(u.flags&128)!==0,z=M.rendering,z===null)if(x)Mh(M,!1);else{if(or!==0||r!==null&&(r.flags&128)!==0)for(r=u.child;r!==null;){if(z=us(r),z!==null){for(u.flags|=128,Mh(M,!1),r=z.updateQueue,u.updateQueue=r,Ld(u,r),u.subtreeFlags=0,r=p,p=u.child;p!==null;)Of(p,r),p=p.sibling;return bt(_i,_i.current&1|2),u.child}r=r.sibling}M.tail!==null&&ji()>bm&&(u.flags|=128,x=!0,Mh(M,!1),u.lanes=4194304)}else{if(!x)if(r=us(z),r!==null){if(u.flags|=128,x=!0,r=r.updateQueue,u.updateQueue=r,Ld(u,r),Mh(M,!0),M.tail===null&&M.tailMode==="hidden"&&!z.alternate&&!Un)return Qi(u),null}else 2*ji()-M.renderingStartTime>bm&&p!==536870912&&(u.flags|=128,x=!0,Mh(M,!1),u.lanes=4194304);M.isBackwards?(z.sibling=u.child,u.child=z):(r=M.last,r!==null?r.sibling=z:u.child=z,M.last=z)}return M.tail!==null?(u=M.tail,M.rendering=u,M.tail=u.sibling,M.renderingStartTime=ji(),u.sibling=null,r=_i.current,bt(_i,x?r&1|2:r&1),u):(Qi(u),null);case 22:case 23:return cs(u),Pd(),x=u.memoizedState!==null,r!==null?r.memoizedState!==null!==x&&(u.flags|=8192):x&&(u.flags|=8192),x?(p&536870912)!==0&&(u.flags&128)===0&&(Qi(u),u.subtreeFlags&6&&(u.flags|=8192)):Qi(u),p=u.updateQueue,p!==null&&Ld(u,p.retryQueue),p=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),x=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(x=u.memoizedState.cachePool.pool),x!==p&&(u.flags|=2048),r!==null&&Ct(Cs),null;case 24:return p=null,r!==null&&(p=r.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Ms(fr),Qi(u),null;case 25:return null;case 30:return null}throw Error(d(156,u.tag))}function Wf(r,u){switch(ru(u),u.tag){case 1:return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 3:return Ms(fr),mi(),r=u.flags,(r&65536)!==0&&(r&128)===0?(u.flags=r&-65537|128,u):null;case 26:case 27:case 5:return ua(u),null;case 13:if(cs(u),r=u.memoizedState,r!==null&&r.dehydrated!==null){if(u.alternate===null)throw Error(d(340));ea()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 19:return Ct(_i),null;case 4:return mi(),null;case 10:return Ms(u.type),null;case 22:case 23:return cs(u),Pd(),r!==null&&Ct(Cs),r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 24:return Ms(fr),null;case 25:return null;default:return null}}function $_(r,u){switch(ru(u),u.tag){case 3:Ms(fr),mi();break;case 26:case 27:case 5:ua(u);break;case 4:mi();break;case 13:cs(u);break;case 19:Ct(_i);break;case 10:Ms(u.type);break;case 22:case 23:cs(u),Pd(),r!==null&&Ct(Cs);break;case 24:Ms(fr)}}function Qf(r,u){try{var p=u.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var M=x.next;p=M;do{if((p.tag&r)===r){x=void 0;var z=p.create,q=p.inst;x=z(),q.destroy=x}p=p.next}while(p!==M)}}catch(ne){vi(u,u.return,ne)}}function yu(r,u,p){try{var x=u.updateQueue,M=x!==null?x.lastEffect:null;if(M!==null){var z=M.next;x=z;do{if((x.tag&r)===r){var q=x.inst,ne=q.destroy;if(ne!==void 0){q.destroy=void 0,M=u;var xe=p,Ye=ne;try{Ye()}catch(at){vi(M,xe,at)}}}x=x.next}while(x!==z)}}catch(at){vi(u,u.return,at)}}function Y_(r){var u=r.updateQueue;if(u!==null){var p=r.stateNode;try{Gf(u,p)}catch(x){vi(r,r.return,x)}}}function q_(r,u,p){p.props=Sh(r.type,r.memoizedProps),p.state=r.memoizedState;try{p.componentWillUnmount()}catch(x){vi(r,u,x)}}function Kf(r,u){try{var p=r.ref;if(p!==null){switch(r.tag){case 26:case 27:case 5:var x=r.stateNode;break;case 30:x=r.stateNode;break;default:x=r.stateNode}typeof p=="function"?r.refCleanup=p(x):p.current=x}}catch(M){vi(r,u,M)}}function Rl(r,u){var p=r.ref,x=r.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(M){vi(r,u,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(M){vi(r,u,M)}else p.current=null}function gm(r){var u=r.type,p=r.memoizedProps,x=r.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(M){vi(r,r.return,M)}}function Ug(r,u,p){try{var x=r.stateNode;y0(x,r.type,p,u),x[nn]=u}catch(M){vi(r,r.return,M)}}function Vg(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Rc(r.type)||r.tag===4}function Dh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Vg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Rc(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Gg(r,u,p){var x=r.tag;if(x===5||x===6)r=r.stateNode,u?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(r,u):(u=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,u.appendChild(r),p=p._reactRootContainer,p!=null||u.onclick!==null||(u.onclick=ka));else if(x!==4&&(x===27&&Rc(r.type)&&(p=r.stateNode,u=null),r=r.child,r!==null))for(Gg(r,u,p),r=r.sibling;r!==null;)Gg(r,u,p),r=r.sibling}function Li(r,u,p){var x=r.tag;if(x===5||x===6)r=r.stateNode,u?p.insertBefore(r,u):p.appendChild(r);else if(x!==4&&(x===27&&Rc(r.type)&&(p=r.stateNode),r=r.child,r!==null))for(Li(r,u,p),r=r.sibling;r!==null;)Li(r,u,p),r=r.sibling}function kh(r){var u=r.stateNode,p=r.memoizedProps;try{for(var x=r.type,M=u.attributes;M.length;)u.removeAttributeNode(M[0]);lr(u,x,p),u[Wt]=r,u[nn]=p}catch(z){vi(r,r.return,z)}}var Pl=!1,Ki=!1,Od=!1,jd=typeof WeakSet=="function"?WeakSet:Set,Br=null;function H_(r,u){if(r=r.containerInfo,Rm=xt,r=bd(r),sh(r)){if("selectionStart"in r)var p={start:r.selectionStart,end:r.selectionEnd};else e:{p=(p=r.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var M=x.anchorOffset,z=x.focusNode;x=x.focusOffset;try{p.nodeType,z.nodeType}catch{p=null;break e}var q=0,ne=-1,xe=-1,Ye=0,at=0,dt=r,Xe=null;t:for(;;){for(var Qe;dt!==p||M!==0&&dt.nodeType!==3||(ne=q+M),dt!==z||x!==0&&dt.nodeType!==3||(xe=q+x),dt.nodeType===3&&(q+=dt.nodeValue.length),(Qe=dt.firstChild)!==null;)Xe=dt,dt=Qe;for(;;){if(dt===r)break t;if(Xe===p&&++Ye===M&&(ne=q),Xe===z&&++at===x&&(xe=q),(Qe=dt.nextSibling)!==null)break;dt=Xe,Xe=dt.parentNode}dt=Qe}p=ne===-1||xe===-1?null:{start:ne,end:xe}}else p=null}p=p||{start:0,end:0}}else p=null;for(Pm={focusedElem:r,selectionRange:p},xt=!1,Br=u;Br!==null;)if(u=Br,r=u.child,(u.subtreeFlags&1024)!==0&&r!==null)r.return=u,Br=r;else for(;Br!==null;){switch(u=Br,z=u.alternate,r=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&z!==null){r=void 0,p=u,M=z.memoizedProps,z=z.memoizedState,x=p.stateNode;try{var un=Sh(p.type,M,p.elementType===p.type);r=x.getSnapshotBeforeUpdate(un,z),x.__reactInternalSnapshotBeforeUpdate=r}catch(sn){vi(p,p.return,sn)}}break;case 3:if((r&1024)!==0){if(r=u.stateNode.containerInfo,p=r.nodeType,p===9)Nm(r);else if(p===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Nm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(d(163))}if(r=u.sibling,r!==null){r.return=u.return,Br=r;break}Br=u.return}}function Bd(r,u,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Cc(r,p),x&4&&Qf(5,p);break;case 1:if(Cc(r,p),x&4)if(r=p.stateNode,u===null)try{r.componentDidMount()}catch(q){vi(p,p.return,q)}else{var M=Sh(p.type,u.memoizedProps);u=u.memoizedState;try{r.componentDidUpdate(M,u,r.__reactInternalSnapshotBeforeUpdate)}catch(q){vi(p,p.return,q)}}x&64&&Y_(p),x&512&&Kf(p,p.return);break;case 3:if(Cc(r,p),x&64&&(r=p.updateQueue,r!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=p.child.stateNode;break;case 1:u=p.child.stateNode}try{Gf(r,u)}catch(q){vi(p,p.return,q)}}break;case 27:u===null&&x&4&&kh(p);case 26:case 5:Cc(r,p),u===null&&x&4&&gm(p),x&512&&Kf(p,p.return);break;case 12:Cc(r,p);break;case 13:Cc(r,p),x&4&&X_(r,p),x&64&&(r=p.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(p=Nv.bind(null,p),Uv(r,p))));break;case 22:if(x=p.memoizedState!==null||Pl,!x){u=u!==null&&u.memoizedState!==null||Ki,M=Pl;var z=Ki;Pl=x,(Ki=u)&&!z?_u(r,p,(p.subtreeFlags&8772)!==0):Cc(r,p),Pl=M,Ki=z}break;case 30:break;default:Cc(r,p)}}function ym(r){var u=r.alternate;u!==null&&(r.alternate=null,ym(u)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(u=r.stateNode,u!==null&&Et(u)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var di=null,xa=!1;function hs(r,u,p){for(p=p.child;p!==null;)Fd(r,u,p),p=p.sibling}function Fd(r,u,p){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(da,p)}catch{}switch(p.tag){case 26:Ki||Rl(p,u),hs(r,u,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Ki||Rl(p,u);var x=di,M=xa;Rc(p.type)&&(di=p.stateNode,xa=!1),hs(r,u,p),Uh(p.stateNode),di=x,xa=M;break;case 5:Ki||Rl(p,u);case 6:if(x=di,M=xa,di=null,hs(r,u,p),di=x,xa=M,di!==null)if(xa)try{(di.nodeType===9?di.body:di.nodeName==="HTML"?di.ownerDocument.body:di).removeChild(p.stateNode)}catch(z){vi(p,u,z)}else try{di.removeChild(p.stateNode)}catch(z){vi(p,u,z)}break;case 18:di!==null&&(xa?(r=di,pp(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,p.stateNode),tr(r)):pp(di,p.stateNode));break;case 4:x=di,M=xa,di=p.stateNode.containerInfo,xa=!0,hs(r,u,p),di=x,xa=M;break;case 0:case 11:case 14:case 15:Ki||yu(2,p,u),Ki||yu(4,p,u),hs(r,u,p);break;case 1:Ki||(Rl(p,u),x=p.stateNode,typeof x.componentWillUnmount=="function"&&q_(p,u,x)),hs(r,u,p);break;case 21:hs(r,u,p);break;case 22:Ki=(x=Ki)||p.memoizedState!==null,hs(r,u,p),Ki=x;break;default:hs(r,u,p)}}function X_(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{tr(r)}catch(p){vi(u,u.return,p)}}function W_(r){switch(r.tag){case 13:case 19:var u=r.stateNode;return u===null&&(u=r.stateNode=new jd),u;case 22:return r=r.stateNode,u=r._retryCache,u===null&&(u=r._retryCache=new jd),u;default:throw Error(d(435,r.tag))}}function Mc(r,u){var p=W_(r);u.forEach(function(x){var M=Lv.bind(null,r,x);p.has(x)||(p.add(x),x.then(M,M))})}function zs(r,u){var p=u.deletions;if(p!==null)for(var x=0;x<p.length;x++){var M=p[x],z=r,q=u,ne=q;e:for(;ne!==null;){switch(ne.tag){case 27:if(Rc(ne.type)){di=ne.stateNode,xa=!1;break e}break;case 5:di=ne.stateNode,xa=!1;break e;case 3:case 4:di=ne.stateNode.containerInfo,xa=!0;break e}ne=ne.return}if(di===null)throw Error(d(160));Fd(z,q,M),di=null,xa=!1,z=M.alternate,z!==null&&(z.return=null),M.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Ud(u,r),u=u.sibling}var vo=null;function Ud(r,u){var p=r.alternate,x=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:zs(u,r),$a(r),x&4&&(yu(3,r,r.return),Qf(3,r),yu(5,r,r.return));break;case 1:zs(u,r),$a(r),x&512&&(Ki||p===null||Rl(p,p.return)),x&64&&Pl&&(r=r.updateQueue,r!==null&&(x=r.callbacks,x!==null&&(p=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var M=vo;if(zs(u,r),$a(r),x&512&&(Ki||p===null||Rl(p,p.return)),x&4){var z=p!==null?p.memoizedState:null;if(x=r.memoizedState,p===null)if(x===null)if(r.stateNode===null){e:{x=r.type,p=r.memoizedProps,M=M.ownerDocument||M;t:switch(x){case"title":z=M.getElementsByTagName("title")[0],(!z||z[ro]||z[Wt]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=M.createElement(x),M.head.insertBefore(z,M.querySelector("head > title"))),lr(z,x,p),z[Wt]=r,Mi(z),x=z;break e;case"link":var q=S("link","href",M).get(x+(p.href||""));if(q){for(var ne=0;ne<q.length;ne++)if(z=q[ne],z.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&z.getAttribute("rel")===(p.rel==null?null:p.rel)&&z.getAttribute("title")===(p.title==null?null:p.title)&&z.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){q.splice(ne,1);break t}}z=M.createElement(x),lr(z,x,p),M.head.appendChild(z);break;case"meta":if(q=S("meta","content",M).get(x+(p.content||""))){for(ne=0;ne<q.length;ne++)if(z=q[ne],z.getAttribute("content")===(p.content==null?null:""+p.content)&&z.getAttribute("name")===(p.name==null?null:p.name)&&z.getAttribute("property")===(p.property==null?null:p.property)&&z.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&z.getAttribute("charset")===(p.charSet==null?null:p.charSet)){q.splice(ne,1);break t}}z=M.createElement(x),lr(z,x,p),M.head.appendChild(z);break;default:throw Error(d(468,x))}z[Wt]=r,Mi(z),x=z}r.stateNode=x}else A(M,r.type,r.stateNode);else r.stateNode=t(M,x,r.memoizedProps);else z!==x?(z===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):z.count--,x===null?A(M,r.type,r.stateNode):t(M,x,r.memoizedProps)):x===null&&r.stateNode!==null&&Ug(r,r.memoizedProps,p.memoizedProps)}break;case 27:zs(u,r),$a(r),x&512&&(Ki||p===null||Rl(p,p.return)),p!==null&&x&4&&Ug(r,r.memoizedProps,p.memoizedProps);break;case 5:if(zs(u,r),$a(r),x&512&&(Ki||p===null||Rl(p,p.return)),r.flags&32){M=r.stateNode;try{lo(M,"")}catch(Qe){vi(r,r.return,Qe)}}x&4&&r.stateNode!=null&&(M=r.memoizedProps,Ug(r,M,p!==null?p.memoizedProps:M)),x&1024&&(Od=!0);break;case 6:if(zs(u,r),$a(r),x&4){if(r.stateNode===null)throw Error(d(162));x=r.memoizedProps,p=r.stateNode;try{p.nodeValue=x}catch(Qe){vi(r,r.return,Qe)}}break;case 3:if(T=null,M=vo,vo=Jd(u.containerInfo),zs(u,r),vo=M,$a(r),x&4&&p!==null&&p.memoizedState.isDehydrated)try{tr(u.containerInfo)}catch(Qe){vi(r,r.return,Qe)}Od&&(Od=!1,Zg(r));break;case 4:x=vo,vo=Jd(r.stateNode.containerInfo),zs(u,r),$a(r),vo=x;break;case 12:zs(u,r),$a(r);break;case 13:zs(u,r),$a(r),r.child.flags&8192&&r.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Xg=ji()),x&4&&(x=r.updateQueue,x!==null&&(r.updateQueue=null,Mc(r,x)));break;case 22:M=r.memoizedState!==null;var xe=p!==null&&p.memoizedState!==null,Ye=Pl,at=Ki;if(Pl=Ye||M,Ki=at||xe,zs(u,r),Ki=at,Pl=Ye,$a(r),x&8192)e:for(u=r.stateNode,u._visibility=M?u._visibility&-2:u._visibility|1,M&&(p===null||xe||Pl||Ki||Ih(r)),p=null,u=r;;){if(u.tag===5||u.tag===26){if(p===null){xe=p=u;try{if(z=xe.stateNode,M)q=z.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ne=xe.stateNode;var dt=xe.memoizedProps.style,Xe=dt!=null&&dt.hasOwnProperty("display")?dt.display:null;ne.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Qe){vi(xe,xe.return,Qe)}}}else if(u.tag===6){if(p===null){xe=u;try{xe.stateNode.nodeValue=M?"":xe.memoizedProps}catch(Qe){vi(xe,xe.return,Qe)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===r)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break e;for(;u.sibling===null;){if(u.return===null||u.return===r)break e;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}x&4&&(x=r.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Mc(r,p))));break;case 19:zs(u,r),$a(r),x&4&&(x=r.updateQueue,x!==null&&(r.updateQueue=null,Mc(r,x)));break;case 30:break;case 21:break;default:zs(u,r),$a(r)}}function $a(r){var u=r.flags;if(u&2){try{for(var p,x=r.return;x!==null;){if(Vg(x)){p=x;break}x=x.return}if(p==null)throw Error(d(160));switch(p.tag){case 27:var M=p.stateNode,z=Dh(r);Li(r,z,M);break;case 5:var q=p.stateNode;p.flags&32&&(lo(q,""),p.flags&=-33);var ne=Dh(r);Li(r,ne,q);break;case 3:case 4:var xe=p.stateNode.containerInfo,Ye=Dh(r);Gg(r,Ye,xe);break;default:throw Error(d(161))}}catch(at){vi(r,r.return,at)}r.flags&=-3}u&4096&&(r.flags&=-4097)}function Zg(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var u=r;Zg(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),r=r.sibling}}function Cc(r,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Bd(r,u.alternate,u),u=u.sibling}function Ih(r){for(r=r.child;r!==null;){var u=r;switch(u.tag){case 0:case 11:case 14:case 15:yu(4,u,u.return),Ih(u);break;case 1:Rl(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&q_(u,u.return,p),Ih(u);break;case 27:Uh(u.stateNode);case 26:case 5:Rl(u,u.return),Ih(u);break;case 22:u.memoizedState===null&&Ih(u);break;case 30:Ih(u);break;default:Ih(u)}r=r.sibling}}function _u(r,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var x=u.alternate,M=r,z=u,q=z.flags;switch(z.tag){case 0:case 11:case 15:_u(M,z,p),Qf(4,z);break;case 1:if(_u(M,z,p),x=z,M=x.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Ye){vi(x,x.return,Ye)}if(x=z,M=x.updateQueue,M!==null){var ne=x.stateNode;try{var xe=M.shared.hiddenCallbacks;if(xe!==null)for(M.shared.hiddenCallbacks=null,M=0;M<xe.length;M++)Vf(xe[M],ne)}catch(Ye){vi(x,x.return,Ye)}}p&&q&64&&Y_(z),Kf(z,z.return);break;case 27:kh(z);case 26:case 5:_u(M,z,p),p&&x===null&&q&4&&gm(z),Kf(z,z.return);break;case 12:_u(M,z,p);break;case 13:_u(M,z,p),p&&q&4&&X_(M,z);break;case 22:z.memoizedState===null&&_u(M,z,p),Kf(z,z.return);break;case 30:break;default:_u(M,z,p)}u=u.sibling}}function $g(r,u){var p=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),r=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(r=u.memoizedState.cachePool.pool),r!==p&&(r!=null&&r.refCount++,p!=null&&yc(p))}function Yg(r,u){r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&yc(r))}function zl(r,u,p,x){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Rh(r,u,p,x),u=u.sibling}function Rh(r,u,p,x){var M=u.flags;switch(u.tag){case 0:case 11:case 15:zl(r,u,p,x),M&2048&&Qf(9,u);break;case 1:zl(r,u,p,x);break;case 3:zl(r,u,p,x),M&2048&&(r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&yc(r)));break;case 12:if(M&2048){zl(r,u,p,x),r=u.stateNode;try{var z=u.memoizedProps,q=z.id,ne=z.onPostCommit;typeof ne=="function"&&ne(q,u.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(xe){vi(u,u.return,xe)}}else zl(r,u,p,x);break;case 13:zl(r,u,p,x);break;case 23:break;case 22:z=u.stateNode,q=u.alternate,u.memoizedState!==null?z._visibility&2?zl(r,u,p,x):Jf(r,u):z._visibility&2?zl(r,u,p,x):(z._visibility|=2,Vd(r,u,p,x,(u.subtreeFlags&10256)!==0)),M&2048&&$g(q,u);break;case 24:zl(r,u,p,x),M&2048&&Yg(u.alternate,u);break;default:zl(r,u,p,x)}}function Vd(r,u,p,x,M){for(M=M&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var z=r,q=u,ne=p,xe=x,Ye=q.flags;switch(q.tag){case 0:case 11:case 15:Vd(z,q,ne,xe,M),Qf(8,q);break;case 23:break;case 22:var at=q.stateNode;q.memoizedState!==null?at._visibility&2?Vd(z,q,ne,xe,M):Jf(z,q):(at._visibility|=2,Vd(z,q,ne,xe,M)),M&&Ye&2048&&$g(q.alternate,q);break;case 24:Vd(z,q,ne,xe,M),M&&Ye&2048&&Yg(q.alternate,q);break;default:Vd(z,q,ne,xe,M)}u=u.sibling}}function Jf(r,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=r,x=u,M=x.flags;switch(x.tag){case 22:Jf(p,x),M&2048&&$g(x.alternate,x);break;case 24:Jf(p,x),M&2048&&Yg(x.alternate,x);break;default:Jf(p,x)}u=u.sibling}}var Gd=8192;function Zd(r){if(r.subtreeFlags&Gd)for(r=r.child;r!==null;)qg(r),r=r.sibling}function qg(r){switch(r.tag){case 26:Zd(r),r.flags&Gd&&r.memoizedState!==null&&$(vo,r.memoizedState,r.memoizedProps);break;case 5:Zd(r);break;case 3:case 4:var u=vo;vo=Jd(r.stateNode.containerInfo),Zd(r),vo=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Gd,Gd=16777216,Zd(r),Gd=u):Zd(r));break;default:Zd(r)}}function Q_(r){var u=r.alternate;if(u!==null&&(r=u.child,r!==null)){u.child=null;do u=r.sibling,r.sibling=null,r=u;while(r!==null)}}function Ph(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var x=u[p];Br=x,K_(x,r)}Q_(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)$d(r),r=r.sibling}function $d(r){switch(r.tag){case 0:case 11:case 15:Ph(r),r.flags&2048&&yu(9,r,r.return);break;case 3:Ph(r);break;case 12:Ph(r);break;case 22:var u=r.stateNode;r.memoizedState!==null&&u._visibility&2&&(r.return===null||r.return.tag!==13)?(u._visibility&=-3,Yd(r)):Ph(r);break;default:Ph(r)}}function Yd(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var x=u[p];Br=x,K_(x,r)}Q_(r)}for(r=r.child;r!==null;){switch(u=r,u.tag){case 0:case 11:case 15:yu(8,u,u.return),Yd(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Yd(u));break;default:Yd(u)}r=r.sibling}}function K_(r,u){for(;Br!==null;){var p=Br;switch(p.tag){case 0:case 11:case 15:yu(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:yc(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Br=x;else e:for(p=r;Br!==null;){x=Br;var M=x.sibling,z=x.return;if(ym(x),x===p){Br=null;break e}if(M!==null){M.return=z,Br=M;break e}Br=z}}}var Rv={getCacheForType:function(r){var u=yi(fr),p=u.data.get(r);return p===void 0&&(p=r(),u.data.set(r,p)),p}},J_=typeof WeakMap=="function"?WeakMap:Map,ui=0,Oi=null,Nn=null,Dn=0,hi=0,Ns=null,vu=!1,qd=!1,Hg=!1,Dc=0,or=0,Nl=0,bu=0,_m=0,Ls=0,Hd=0,xu=null,ds=null,vm=!1,Xg=0,bm=1/0,xm=null,kc=null,wa=0,wu=null,Ll=null,Zi=0,ep=0,wm=null,Wg=null,zh=0,Tu=null;function fs(){if((ui&2)!==0&&Dn!==0)return Dn&-Dn;if(Ge.T!==null){var r=vr;return r!==0?r:op()}return hr()}function e0(){Ls===0&&(Ls=(Dn&536870912)===0||Un?ft():536870912);var r=Za.current;return r!==null&&(r.flags|=32),Ls}function Os(r,u,p){(r===Oi&&(hi===2||hi===9)||r.cancelPendingCommit!==null)&&(Xd(r,0),Su(r,Dn,Ls,!1)),Re(r,p),((ui&2)===0||r!==Oi)&&(r===Oi&&((ui&2)===0&&(bu|=p),or===4&&Su(r,Dn,Ls,!1)),js(r))}function t0(r,u,p){if((ui&6)!==0)throw Error(d(327));var x=!p&&(u&124)===0&&(u&r.expiredLanes)===0||Ie(r,u),M=x?Eu(r,u):tp(r,u,!0),z=x;do{if(M===0){qd&&!x&&Su(r,u,0,!1);break}else{if(p=r.current.alternate,z&&!Pv(p)){M=tp(r,u,!1),z=!1;continue}if(M===2){if(z=u,r.errorRecoveryDisabledLanes&z)var q=0;else q=r.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){u=q;e:{var ne=r;M=xu;var xe=ne.current.memoizedState.isDehydrated;if(xe&&(Xd(ne,q).flags|=256),q=tp(ne,q,!1),q!==2){if(Hg&&!xe){ne.errorRecoveryDisabledLanes|=z,bu|=z,M=4;break e}z=ds,ds=M,z!==null&&(ds===null?ds=z:ds.push.apply(ds,z))}M=q}if(z=!1,M!==2)continue}}if(M===1){Xd(r,0),Su(r,u,0,!0);break}e:{switch(x=r,z=M,z){case 0:case 1:throw Error(d(345));case 4:if((u&4194048)!==u)break;case 6:Su(x,u,Ls,!vu);break e;case 2:ds=null;break;case 3:case 5:break;default:throw Error(d(329))}if((u&62914560)===u&&(M=Xg+300-ji(),10<M)){if(Su(x,u,Ls,!vu),Ue(x,0,!0)!==0)break e;x.timeoutHandle=hy(n0.bind(null,x,p,ds,xm,vm,u,Ls,bu,Hd,vu,z,2,-0,0),M);break e}n0(x,p,ds,xm,vm,u,Ls,bu,Hd,vu,z,0,-0,0)}}break}while(!0);js(r)}function n0(r,u,p,x,M,z,q,ne,xe,Ye,at,dt,Xe,Qe){if(r.timeoutHandle=-1,dt=u.subtreeFlags,(dt&8192||(dt&16785408)===16785408)&&(L={stylesheets:null,count:0,unsuspend:F},qg(u),dt=H(),dt!==null)){r.cancelPendingCommit=dt(Kg.bind(null,r,u,z,p,x,M,q,ne,xe,at,1,Xe,Qe)),Su(r,z,q,!Ye);return}Kg(r,u,z,p,x,M,q,ne,xe)}function Pv(r){for(var u=r;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var M=p[x],z=M.getSnapshot;M=M.value;try{if(!pa(z(),M))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Su(r,u,p,x){u&=~_m,u&=~bu,r.suspendedLanes|=u,r.pingedLanes&=~u,x&&(r.warmLanes|=u),x=r.expirationTimes;for(var M=u;0<M;){var z=31-Me(M),q=1<<z;x[z]=-1,M&=~q}p!==0&&bn(r,p,u)}function Tm(){return(ui&6)===0?(Oh(0),!1):!0}function Qg(){if(Nn!==null){if(hi===0)var r=Nn.return;else r=Nn,is=Ga=null,Al(r),ki=null,Gi=0,r=Nn;for(;r!==null;)$_(r.alternate,r),r=r.return;Nn=null}}function Xd(r,u){var p=r.timeoutHandle;p!==-1&&(r.timeoutHandle=-1,b0(p)),p=r.cancelPendingCommit,p!==null&&(r.cancelPendingCommit=null,p()),Qg(),Oi=r,Nn=p=Kr(r.current,null),Dn=u,hi=0,Ns=null,vu=!1,qd=Ie(r,u),Hg=!1,Hd=Ls=_m=bu=Nl=or=0,ds=xu=null,vm=!1,(u&8)!==0&&(u|=u&32);var x=r.entangledLanes;if(x!==0)for(r=r.entanglements,x&=u;0<x;){var M=31-Me(x),z=1<<M;u|=r[M],x&=~z}return Dc=u,mc(),p}function i0(r,u){Tn=null,Ge.H=jr,u===Uo||u===Dt?(u=bh(),hi=3):u===as?(u=bh(),hi=4):hi=u===qf?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ns=u,Nn===null&&(or=1,Nd(r,Cr(u,r.current)))}function r0(){var r=Ge.H;return Ge.H=jr,r===null?jr:r}function a0(){var r=Ge.A;return Ge.A=Rv,r}function Sm(){or=4,vu||(Dn&4194048)!==Dn&&Za.current!==null||(qd=!0),(Nl&134217727)===0&&(bu&134217727)===0||Oi===null||Su(Oi,Dn,Ls,!1)}function tp(r,u,p){var x=ui;ui|=2;var M=r0(),z=a0();(Oi!==r||Dn!==u)&&(xm=null,Xd(r,u)),u=!1;var q=or;e:do try{if(hi!==0&&Nn!==null){var ne=Nn,xe=Ns;switch(hi){case 8:Qg(),q=6;break e;case 3:case 2:case 9:case 6:Za.current===null&&(u=!0);var Ye=hi;if(hi=0,Ns=null,Ic(r,ne,xe,Ye),p&&qd){q=0;break e}break;default:Ye=hi,hi=0,Ns=null,Ic(r,ne,xe,Ye)}}s0(),q=or;break}catch(at){i0(r,at)}while(!0);return u&&r.shellSuspendCounter++,is=Ga=null,ui=x,Ge.H=M,Ge.A=z,Nn===null&&(Oi=null,Dn=0,mc()),q}function s0(){for(;Nn!==null;)Nh(Nn)}function Eu(r,u){var p=ui;ui|=2;var x=r0(),M=a0();Oi!==r||Dn!==u?(xm=null,bm=ji()+500,Xd(r,u)):qd=Ie(r,u);e:do try{if(hi!==0&&Nn!==null){u=Nn;var z=Ns;t:switch(hi){case 1:hi=0,Ns=null,Ic(r,u,z,1);break;case 2:case 9:if(vh(z)){hi=0,Ns=null,ip(u);break}u=function(){hi!==2&&hi!==9||Oi!==r||(hi=7),js(r)},z.then(u,u);break e;case 3:hi=7;break e;case 4:hi=5;break e;case 7:vh(z)?(hi=0,Ns=null,ip(u)):(hi=0,Ns=null,Ic(r,u,z,7));break;case 5:var q=null;switch(Nn.tag){case 26:q=Nn.memoizedState;case 5:case 27:var ne=Nn;if(!q||P(q)){hi=0,Ns=null;var xe=ne.sibling;if(xe!==null)Nn=xe;else{var Ye=ne.return;Ye!==null?(Nn=Ye,Em(Ye)):Nn=null}break t}}hi=0,Ns=null,Ic(r,u,z,5);break;case 6:hi=0,Ns=null,Ic(r,u,z,6);break;case 8:Qg(),or=6;break e;default:throw Error(d(462))}}np();break}catch(at){i0(r,at)}while(!0);return is=Ga=null,Ge.H=x,Ge.A=M,ui=p,Nn!==null?0:(Oi=null,Dn=0,mc(),or)}function np(){for(;Nn!==null&&!Rn();)Nh(Nn)}function Nh(r){var u=G_(r.alternate,r,Dc);r.memoizedProps=r.pendingProps,u===null?Em(r):Nn=u}function ip(r){var u=r,p=u.alternate;switch(u.tag){case 15:case 0:u=um(p,u,u.pendingProps,u.type,void 0,Dn);break;case 11:u=um(p,u,u.pendingProps,u.type.render,u.ref,Dn);break;case 5:Al(u);default:$_(p,u),u=Nn=Of(u,Dc),u=G_(p,u,Dc)}r.memoizedProps=r.pendingProps,u===null?Em(r):Nn=u}function Ic(r,u,p,x){is=Ga=null,Al(u),ki=null,Gi=0;var M=u.return;try{if(Yf(r,M,u,p,Dn)){or=1,Nd(r,Cr(p,r.current)),Nn=null;return}}catch(z){if(M!==null)throw Nn=M,z;or=1,Nd(r,Cr(p,r.current)),Nn=null;return}u.flags&32768?(Un||x===1?r=!0:qd||(Dn&536870912)!==0?r=!1:(vu=r=!0,(x===2||x===9||x===3||x===6)&&(x=Za.current,x!==null&&x.tag===13&&(x.flags|=16384))),o0(u,r)):Em(u)}function Em(r){var u=r;do{if((u.flags&32768)!==0){o0(u,vu);return}r=u.return;var p=Ch(u.alternate,u,Dc);if(p!==null){Nn=p;return}if(u=u.sibling,u!==null){Nn=u;return}Nn=u=r}while(u!==null);or===0&&(or=5)}function o0(r,u){do{var p=Wf(r.alternate,r);if(p!==null){p.flags&=32767,Nn=p;return}if(p=r.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(r=r.sibling,r!==null)){Nn=r;return}Nn=r=p}while(r!==null);or=6,Nn=null}function Kg(r,u,p,x,M,z,q,ne,xe){r.cancelPendingCommit=null;do Wd();while(wa!==0);if((ui&6)!==0)throw Error(d(327));if(u!==null){if(u===r.current)throw Error(d(177));if(z=u.lanes|u.childLanes,z|=pc,tn(r,p,z,q,ne,xe),r===Oi&&(Nn=Oi=null,Dn=0),Ll=u,wu=r,Zi=p,ep=z,wm=M,Wg=x,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,h0(qr,function(){return Am(),null})):(r.callbackNode=null,r.callbackPriority=0),x=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||x){x=Ge.T,Ge.T=null,M=ct.p,ct.p=2,q=ui,ui|=4;try{H_(r,u,p)}finally{ui=q,ct.p=M,Ge.T=x}}wa=1,Jg(),l0(),ey()}}function Jg(){if(wa===1){wa=0;var r=wu,u=Ll,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=Ge.T,Ge.T=null;var x=ct.p;ct.p=2;var M=ui;ui|=4;try{Ud(u,r);var z=Pm,q=bd(r.containerInfo),ne=z.focusedElem,xe=z.selectionRange;if(q!==ne&&ne&&ne.ownerDocument&&Pn(ne.ownerDocument.documentElement,ne)){if(xe!==null&&sh(ne)){var Ye=xe.start,at=xe.end;if(at===void 0&&(at=Ye),"selectionStart"in ne)ne.selectionStart=Ye,ne.selectionEnd=Math.min(at,ne.value.length);else{var dt=ne.ownerDocument||document,Xe=dt&&dt.defaultView||window;if(Xe.getSelection){var Qe=Xe.getSelection(),un=ne.textContent.length,sn=Math.min(xe.start,un),xi=xe.end===void 0?sn:Math.min(xe.end,un);!Qe.extend&&sn>xi&&(q=xi,xi=sn,sn=q);var Le=po(ne,sn),ze=po(ne,xi);if(Le&&ze&&(Qe.rangeCount!==1||Qe.anchorNode!==Le.node||Qe.anchorOffset!==Le.offset||Qe.focusNode!==ze.node||Qe.focusOffset!==ze.offset)){var Ze=dt.createRange();Ze.setStart(Le.node,Le.offset),Qe.removeAllRanges(),sn>xi?(Qe.addRange(Ze),Qe.extend(ze.node,ze.offset)):(Ze.setEnd(ze.node,ze.offset),Qe.addRange(Ze))}}}}for(dt=[],Qe=ne;Qe=Qe.parentNode;)Qe.nodeType===1&&dt.push({element:Qe,left:Qe.scrollLeft,top:Qe.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<dt.length;ne++){var ut=dt[ne];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}xt=!!Rm,Pm=Rm=null}finally{ui=M,ct.p=x,Ge.T=p}}r.current=u,wa=2}}function l0(){if(wa===2){wa=0;var r=wu,u=Ll,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=Ge.T,Ge.T=null;var x=ct.p;ct.p=2;var M=ui;ui|=4;try{Bd(r,u.alternate,u)}finally{ui=M,ct.p=x,Ge.T=p}}wa=3}}function ey(){if(wa===4||wa===3){wa=0,Yr();var r=wu,u=Ll,p=Zi,x=Wg;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?wa=5:(wa=0,Ll=wu=null,ty(r,r.pendingLanes));var M=r.pendingLanes;if(M===0&&(kc=null),ii(p),u=u.stateNode,Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(da,u,void 0,(u.current.flags&128)===128)}catch{}if(x!==null){u=Ge.T,M=ct.p,ct.p=2,Ge.T=null;try{for(var z=r.onRecoverableError,q=0;q<x.length;q++){var ne=x[q];z(ne.value,{componentStack:ne.stack})}}finally{Ge.T=u,ct.p=M}}(Zi&3)!==0&&Wd(),js(r),M=r.pendingLanes,(p&4194090)!==0&&(M&42)!==0?r===Tu?zh++:(zh=0,Tu=r):zh=0,Oh(0)}}function ty(r,u){(r.pooledCacheLanes&=u)===0&&(u=r.pooledCache,u!=null&&(r.pooledCache=null,yc(u)))}function Wd(r){return Jg(),l0(),ey(),Am()}function Am(){if(wa!==5)return!1;var r=wu,u=ep;ep=0;var p=ii(Zi),x=Ge.T,M=ct.p;try{ct.p=32>p?32:p,Ge.T=null,p=wm,wm=null;var z=wu,q=Zi;if(wa=0,Ll=wu=null,Zi=0,(ui&6)!==0)throw Error(d(331));var ne=ui;if(ui|=4,$d(z.current),Rh(z,z.current,q,p),ui=ne,Oh(0,!1),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(da,z)}catch{}return!0}finally{ct.p=M,Ge.T=x,ty(r,u)}}function c0(r,u,p){u=Cr(p,u),u=cm(r.stateNode,u,2),r=Vo(r,u,2),r!==null&&(Re(r,2),js(r))}function vi(r,u,p){if(r.tag===3)c0(r,r,p);else for(;u!==null;){if(u.tag===3){c0(u,r,p);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(kc===null||!kc.has(x))){r=Cr(p,r),p=Eh(2),x=Vo(u,p,2),x!==null&&(O_(p,x,u,r),Re(x,2),js(x));break}}u=u.return}}function ny(r,u,p){var x=r.pingCache;if(x===null){x=r.pingCache=new J_;var M=new Set;x.set(u,M)}else M=x.get(u),M===void 0&&(M=new Set,x.set(u,M));M.has(p)||(Hg=!0,M.add(p),r=zv.bind(null,r,u,p),u.then(r,r))}function zv(r,u,p){var x=r.pingCache;x!==null&&x.delete(u),r.pingedLanes|=r.suspendedLanes&p,r.warmLanes&=~p,Oi===r&&(Dn&p)===p&&(or===4||or===3&&(Dn&62914560)===Dn&&300>ji()-Xg?(ui&2)===0&&Xd(r,0):_m|=p,Hd===Dn&&(Hd=0)),js(r)}function u0(r,u){u===0&&(u=it()),r=ja(r,u),r!==null&&(Re(r,u),js(r))}function Nv(r){var u=r.memoizedState,p=0;u!==null&&(p=u.retryLane),u0(r,p)}function Lv(r,u){var p=0;switch(r.tag){case 13:var x=r.stateNode,M=r.memoizedState;M!==null&&(p=M.retryLane);break;case 19:x=r.stateNode;break;case 22:x=r.stateNode._retryCache;break;default:throw Error(d(314))}x!==null&&x.delete(u),u0(r,p)}function h0(r,u){return Gn(r,u)}var rp=null,ps=null,Ol=!1,ap=!1,sp=!1,Lh=0;function js(r){r!==ps&&r.next===null&&(ps===null?rp=ps=r:ps=ps.next=r),ap=!0,Ol||(Ol=!0,d0())}function Oh(r,u){if(!sp&&ap){sp=!0;do for(var p=!1,x=rp;x!==null;){if(r!==0){var M=x.pendingLanes;if(M===0)var z=0;else{var q=x.suspendedLanes,ne=x.pingedLanes;z=(1<<31-Me(42|r)+1)-1,z&=M&~(q&~ne),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(p=!0,iy(x,z))}else z=Dn,z=Ue(x,x===Oi?z:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(z&3)===0||Ie(x,z)||(p=!0,iy(x,z));x=x.next}while(p);sp=!1}}function Ov(){Mm()}function Mm(){ap=Ol=!1;var r=0;Lh!==0&&(v0()&&(r=Lh),Lh=0);for(var u=ji(),p=null,x=rp;x!==null;){var M=x.next,z=Cm(x,u);z===0?(x.next=null,p===null?rp=M:p.next=M,M===null&&(ps=p)):(p=x,(r!==0||(z&3)!==0)&&(ap=!0)),x=M}Oh(r)}function Cm(r,u){for(var p=r.suspendedLanes,x=r.pingedLanes,M=r.expirationTimes,z=r.pendingLanes&-62914561;0<z;){var q=31-Me(z),ne=1<<q,xe=M[q];xe===-1?((ne&p)===0||(ne&x)!==0)&&(M[q]=Je(ne,u)):xe<=u&&(r.expiredLanes|=ne),z&=~ne}if(u=Oi,p=Dn,p=Ue(r,r===u?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),x=r.callbackNode,p===0||r===u&&(hi===2||hi===9)||r.cancelPendingCommit!==null)return x!==null&&x!==null&&Xn(x),r.callbackNode=null,r.callbackPriority=0;if((p&3)===0||Ie(r,p)){if(u=p&-p,u===r.callbackPriority)return u;switch(x!==null&&Xn(x),ii(p)){case 2:case 8:p=ha;break;case 32:p=qr;break;case 268435456:p=Ka;break;default:p=qr}return x=jh.bind(null,r),p=Gn(p,x),r.callbackPriority=u,r.callbackNode=p,u}return x!==null&&x!==null&&Xn(x),r.callbackPriority=2,r.callbackNode=null,2}function jh(r,u){if(wa!==0&&wa!==5)return r.callbackNode=null,r.callbackPriority=0,null;var p=r.callbackNode;if(Wd()&&r.callbackNode!==p)return null;var x=Dn;return x=Ue(r,r===Oi?x:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),x===0?null:(t0(r,x,u),Cm(r,ji()),r.callbackNode!=null&&r.callbackNode===p?jh.bind(null,r):null)}function iy(r,u){if(Wd())return null;t0(r,u,!0)}function d0(){Fv(function(){(ui&6)!==0?Gn(za,Ov):Mm()})}function op(){return Lh===0&&(Lh=ft()),Lh}function ry(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:yn(""+r)}function lp(r,u){var p=u.ownerDocument.createElement("input");return p.name=u.name,p.value=u.value,r.id&&p.setAttribute("form",r.id),u.parentNode.insertBefore(p,u),r=new FormData(r),p.parentNode.removeChild(p),r}function f0(r,u,p,x,M){if(u==="submit"&&p&&p.stateNode===M){var z=ry((M[nn]||null).action),q=x.submitter;q&&(u=(u=q[nn]||null)?ry(u.formAction):q.getAttribute("formAction"),u!==null&&(z=u,q=null));var ne=new La("action","action",null,x,M);r.push({event:ne,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Lh!==0){var xe=q?lp(M,q):new FormData(M);Di(p,{pending:!0,data:xe,method:M.method,action:z},null,xe)}}else typeof z=="function"&&(ne.preventDefault(),xe=q?lp(M,q):new FormData(M),Di(p,{pending:!0,data:xe,method:M.method,action:z},z,xe))},currentTarget:M}]})}}for(var ay=0;ay<wd.length;ay++){var sy=wd[ay],p0=sy.toLowerCase(),jv=sy[0].toUpperCase()+sy.slice(1);ts(p0,"on"+jv)}ts(oh,"onAnimationEnd"),ts(lh,"onAnimationIteration"),ts(ch,"onAnimationStart"),ts("dblclick","onDoubleClick"),ts("focusin","onFocus"),ts("focusout","onBlur"),ts(Nf,"onTransitionRun"),ts(dc,"onTransitionStart"),ts(uh,"onTransitionCancel"),ts(fc,"onTransitionEnd"),Io("onMouseEnter",["mouseout","mouseover"]),Io("onMouseLeave",["mouseout","mouseover"]),Io("onPointerEnter",["pointerout","pointerover"]),Io("onPointerLeave",["pointerout","pointerover"]),Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cp));function m0(r,u){u=(u&4)!==0;for(var p=0;p<r.length;p++){var x=r[p],M=x.event;x=x.listeners;e:{var z=void 0;if(u)for(var q=x.length-1;0<=q;q--){var ne=x[q],xe=ne.instance,Ye=ne.currentTarget;if(ne=ne.listener,xe!==z&&M.isPropagationStopped())break e;z=ne,M.currentTarget=Ye;try{z(M)}catch(at){$f(at)}M.currentTarget=null,z=xe}else for(q=0;q<x.length;q++){if(ne=x[q],xe=ne.instance,Ye=ne.currentTarget,ne=ne.listener,xe!==z&&M.isPropagationStopped())break e;z=ne,M.currentTarget=Ye;try{z(M)}catch(at){$f(at)}M.currentTarget=null,z=xe}}}}function Ln(r,u){var p=u[gt];p===void 0&&(p=u[gt]=new Set);var x=r+"__bubble";p.has(x)||(oy(u,r,2,!1),p.add(x))}function up(r,u,p){var x=0;u&&(x|=4),oy(p,r,x,u)}var Ko="_reactListening"+Math.random().toString(36).slice(2);function Dm(r){if(!r[Ko]){r[Ko]=!0,dn.forEach(function(p){p!=="selectionchange"&&(Bv.has(p)||up(p,!1,r),up(p,!0,r))});var u=r.nodeType===9?r:r.ownerDocument;u===null||u[Ko]||(u[Ko]=!0,up("selectionchange",!1,u))}}function oy(r,u,p,x){switch(Zt(u)){case 2:var M=Ft;break;case 8:M=St;break;default:M=wt}p=M.bind(null,u,p,r),M=void 0,!Nr||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(M=!0),x?M!==void 0?r.addEventListener(u,p,{capture:!0,passive:M}):r.addEventListener(u,p,!0):M!==void 0?r.addEventListener(u,p,{passive:M}):r.addEventListener(u,p,!1)}function km(r,u,p,x,M){var z=x;if((u&1)===0&&(u&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var ne=x.stateNode.containerInfo;if(ne===M)break;if(q===4)for(q=x.return;q!==null;){var xe=q.tag;if((xe===3||xe===4)&&q.stateNode.containerInfo===M)return;q=q.return}for(;ne!==null;){if(q=hn(ne),q===null)return;if(xe=q.tag,xe===5||xe===6||xe===26||xe===27){x=z=q;continue e}ne=ne.parentNode}}x=x.return}ar(function(){var Ye=z,at=Zc(p),dt=[];e:{var Xe=Oa.get(r);if(Xe!==void 0){var Qe=La,un=r;switch(r){case"keypress":if(rn(p)===0)break e;case"keydown":case"keyup":Qe=Ju;break;case"focusin":un="focus",Qe=rc;break;case"focusout":un="blur",Qe=rc;break;case"beforeblur":case"afterblur":Qe=rc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=Xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=Mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=Ag;break;case oh:case lh:case ch:Qe=Yi;break;case fc:Qe=Mg;break;case"scroll":case"scrollend":Qe=Sf;break;case"wheel":Qe=_d;break;case"copy":case"cut":case"paste":Qe=Wu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=Af;break;case"toggle":case"beforetoggle":Qe=oc}var sn=(u&4)!==0,xi=!sn&&(r==="scroll"||r==="scrollend"),Le=sn?Xe!==null?Xe+"Capture":null:Xe;sn=[];for(var ze=Ye,Ze;ze!==null;){var ut=ze;if(Ze=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||Ze===null||Le===null||(ut=Fn(ze,Le),ut!=null&&sn.push(Qd(ze,ut,Ze))),xi)break;ze=ze.return}0<sn.length&&(Xe=new Qe(Xe,un,null,p,at),dt.push({event:Xe,listeners:sn}))}}if((u&7)===0){e:{if(Xe=r==="mouseover"||r==="pointerover",Qe=r==="mouseout"||r==="pointerout",Xe&&p!==Po&&(un=p.relatedTarget||p.fromElement)&&(hn(un)||un[Ai]))break e;if((Qe||Xe)&&(Xe=at.window===at?at:(Xe=at.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Qe?(un=p.relatedTarget||p.toElement,Qe=Ye,un=un?hn(un):null,un!==null&&(xi=_(un),sn=un.tag,un!==xi||sn!==5&&sn!==27&&sn!==6)&&(un=null)):(Qe=null,un=Ye),Qe!==un)){if(sn=Xu,ut="onMouseLeave",Le="onMouseEnter",ze="mouse",(r==="pointerout"||r==="pointerover")&&(sn=Af,ut="onPointerLeave",Le="onPointerEnter",ze="pointer"),xi=Qe==null?Xe:rr(Qe),Ze=un==null?Xe:rr(un),Xe=new sn(ut,ze+"leave",Qe,p,at),Xe.target=xi,Xe.relatedTarget=Ze,ut=null,hn(at)===Ye&&(sn=new sn(Le,ze+"enter",un,p,at),sn.target=Ze,sn.relatedTarget=xi,ut=sn),xi=ut,Qe&&un)t:{for(sn=Qe,Le=un,ze=0,Ze=sn;Ze;Ze=Au(Ze))ze++;for(Ze=0,ut=Le;ut;ut=Au(ut))Ze++;for(;0<ze-Ze;)sn=Au(sn),ze--;for(;0<Ze-ze;)Le=Au(Le),Ze--;for(;ze--;){if(sn===Le||Le!==null&&sn===Le.alternate)break t;sn=Au(sn),Le=Au(Le)}sn=null}else sn=null;Qe!==null&&ly(dt,Xe,Qe,sn,!1),un!==null&&xi!==null&&ly(dt,xi,un,sn,!0)}}e:{if(Xe=Ye?rr(Ye):window,Qe=Xe.nodeName&&Xe.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Xe.type==="file")var $t=Rf;else if(Wp(Xe))if(pl)$t=em;else{$t=kg;var kn=Kp}else Qe=Xe.nodeName,!Qe||Qe.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?Ye&&co(Ye.elementType)&&($t=Rf):$t=Jp;if($t&&($t=$t(r,Ye))){If(dt,$t,p,at);break e}kn&&kn(r,Xe,Ye),r==="focusout"&&Ye&&Xe.type==="number"&&Ye.memoizedProps.value!=null&&Hu(Xe,"number",Xe.value)}switch(kn=Ye?rr(Ye):window,r){case"focusin":(Wp(kn)||kn.contentEditable==="true")&&(ml=kn,No=Ye,uc=null);break;case"focusout":uc=No=ml=null;break;case"mousedown":zf=!0;break;case"contextmenu":case"mouseup":case"dragend":zf=!1,nm(dt,p,at);break;case"selectionchange":if(tm)break;case"keydown":case"keyup":nm(dt,p,at)}var Ut;if(qc)e:{switch(r){case"compositionstart":var Jt="onCompositionStart";break e;case"compositionend":Jt="onCompositionEnd";break e;case"compositionupdate":Jt="onCompositionUpdate";break e}Jt=void 0}else Wc?Hp(r,p)&&(Jt="onCompositionEnd"):r==="keydown"&&p.keyCode===229&&(Jt="onCompositionStart");Jt&&(eh&&p.locale!=="ko"&&(Wc||Jt!=="onCompositionStart"?Jt==="onCompositionEnd"&&Wc&&(Ut=Ht()):(Vi=at,ci="value"in Vi?Vi.value:Vi.textContent,Wc=!0)),kn=hp(Ye,Jt),0<kn.length&&(Jt=new qp(Jt,r,null,p,at),dt.push({event:Jt,listeners:kn}),Ut?Jt.data=Ut:(Ut=th(p),Ut!==null&&(Jt.data=Ut)))),(Ut=Dg?lc(r,p):Xp(r,p))&&(Jt=hp(Ye,"onBeforeInput"),0<Jt.length&&(kn=new qp("onBeforeInput","beforeinput",null,p,at),dt.push({event:kn,listeners:Jt}),kn.data=Ut)),f0(dt,r,Ye,p,at)}m0(dt,u)})}function Qd(r,u,p){return{instance:r,listener:u,currentTarget:p}}function hp(r,u){for(var p=u+"Capture",x=[];r!==null;){var M=r,z=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||z===null||(M=Fn(r,p),M!=null&&x.unshift(Qd(r,M,z)),M=Fn(r,u),M!=null&&x.push(Qd(r,M,z))),r.tag===3)return x;r=r.return}return[]}function Au(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function ly(r,u,p,x,M){for(var z=u._reactName,q=[];p!==null&&p!==x;){var ne=p,xe=ne.alternate,Ye=ne.stateNode;if(ne=ne.tag,xe!==null&&xe===x)break;ne!==5&&ne!==26&&ne!==27||Ye===null||(xe=Ye,M?(Ye=Fn(p,z),Ye!=null&&q.unshift(Qd(p,Ye,xe))):M||(Ye=Fn(p,z),Ye!=null&&q.push(Qd(p,Ye,xe)))),p=p.return}q.length!==0&&r.push({event:u,listeners:q})}var dp=/\r\n?/g,g0=/\u0000|\uFFFD/g;function Im(r){return(typeof r=="string"?r:""+r).replace(dp,`
`).replace(g0,"")}function cy(r,u){return u=Im(u),Im(r)===u}function ka(){}function qn(r,u,p,x,M,z){switch(p){case"children":typeof x=="string"?u==="body"||u==="textarea"&&x===""||lo(r,x):(typeof x=="number"||typeof x=="bigint")&&u!=="body"&&lo(r,""+x);break;case"className":Zn(r,"class",x);break;case"tabIndex":Zn(r,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Zn(r,p,x);break;case"style":ul(r,x,z);break;case"data":if(u!=="object"){Zn(r,"data",x);break}case"src":case"href":if(x===""&&(u!=="a"||p!=="href")){r.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){r.removeAttribute(p);break}x=yn(""+x),r.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){r.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(p==="formAction"?(u!=="input"&&qn(r,u,"name",M.name,M,null),qn(r,u,"formEncType",M.formEncType,M,null),qn(r,u,"formMethod",M.formMethod,M,null),qn(r,u,"formTarget",M.formTarget,M,null)):(qn(r,u,"encType",M.encType,M,null),qn(r,u,"method",M.method,M,null),qn(r,u,"target",M.target,M,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){r.removeAttribute(p);break}x=yn(""+x),r.setAttribute(p,x);break;case"onClick":x!=null&&(r.onclick=ka);break;case"onScroll":x!=null&&Ln("scroll",r);break;case"onScrollEnd":x!=null&&Ln("scrollend",r);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(d(61));if(p=x.__html,p!=null){if(M.children!=null)throw Error(d(60));r.innerHTML=p}}break;case"multiple":r.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":r.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){r.removeAttribute("xlink:href");break}p=yn(""+x),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?r.setAttribute(p,""+x):r.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?r.setAttribute(p,""):r.removeAttribute(p);break;case"capture":case"download":x===!0?r.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?r.setAttribute(p,x):r.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?r.setAttribute(p,x):r.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?r.removeAttribute(p):r.setAttribute(p,x);break;case"popover":Ln("beforetoggle",r),Ln("toggle",r),Rr(r,"popover",x);break;case"xlinkActuate":so(r,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":so(r,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":so(r,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":so(r,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":so(r,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":so(r,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":so(r,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":so(r,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":so(r,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Rr(r,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Ro.get(p)||p,Rr(r,p,x))}}function Bh(r,u,p,x,M,z){switch(p){case"style":ul(r,x,z);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(d(61));if(p=x.__html,p!=null){if(M.children!=null)throw Error(d(60));r.innerHTML=p}}break;case"children":typeof x=="string"?lo(r,x):(typeof x=="number"||typeof x=="bigint")&&lo(r,""+x);break;case"onScroll":x!=null&&Ln("scroll",r);break;case"onScrollEnd":x!=null&&Ln("scrollend",r);break;case"onClick":x!=null&&(r.onclick=ka);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$u.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(M=p.endsWith("Capture"),u=p.slice(2,M?p.length-7:void 0),z=r[nn]||null,z=z!=null?z[p]:null,typeof z=="function"&&r.removeEventListener(u,z,M),typeof x=="function")){typeof z!="function"&&z!==null&&(p in r?r[p]=null:r.hasAttribute(p)&&r.removeAttribute(p)),r.addEventListener(u,x,M);break e}p in r?r[p]=x:x===!0?r.setAttribute(p,""):Rr(r,p,x)}}}function lr(r,u,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ln("error",r),Ln("load",r);var x=!1,M=!1,z;for(z in p)if(p.hasOwnProperty(z)){var q=p[z];if(q!=null)switch(z){case"src":x=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(d(137,u));default:qn(r,u,z,q,p,null)}}M&&qn(r,u,"srcSet",p.srcSet,p,null),x&&qn(r,u,"src",p.src,p,null);return;case"input":Ln("invalid",r);var ne=z=q=M=null,xe=null,Ye=null;for(x in p)if(p.hasOwnProperty(x)){var at=p[x];if(at!=null)switch(x){case"name":M=at;break;case"type":q=at;break;case"checked":xe=at;break;case"defaultChecked":Ye=at;break;case"value":z=at;break;case"defaultValue":ne=at;break;case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(d(137,u));break;default:qn(r,u,x,at,p,null)}}Jl(r,z,ne,xe,Ye,q,M,!1),gd(r);return;case"select":Ln("invalid",r),x=q=z=null;for(M in p)if(p.hasOwnProperty(M)&&(ne=p[M],ne!=null))switch(M){case"value":z=ne;break;case"defaultValue":q=ne;break;case"multiple":x=ne;default:qn(r,u,M,ne,p,null)}u=z,p=q,r.multiple=!!x,u!=null?cl(r,!!x,u,!1):p!=null&&cl(r,!!x,p,!0);return;case"textarea":Ln("invalid",r),z=M=x=null;for(q in p)if(p.hasOwnProperty(q)&&(ne=p[q],ne!=null))switch(q){case"value":x=ne;break;case"defaultValue":M=ne;break;case"children":z=ne;break;case"dangerouslySetInnerHTML":if(ne!=null)throw Error(d(91));break;default:qn(r,u,q,ne,p,null)}ec(r,x,M,z),gd(r);return;case"option":for(xe in p)if(p.hasOwnProperty(xe)&&(x=p[xe],x!=null))switch(xe){case"selected":r.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:qn(r,u,xe,x,p,null)}return;case"dialog":Ln("beforetoggle",r),Ln("toggle",r),Ln("cancel",r),Ln("close",r);break;case"iframe":case"object":Ln("load",r);break;case"video":case"audio":for(x=0;x<cp.length;x++)Ln(cp[x],r);break;case"image":Ln("error",r),Ln("load",r);break;case"details":Ln("toggle",r);break;case"embed":case"source":case"link":Ln("error",r),Ln("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ye in p)if(p.hasOwnProperty(Ye)&&(x=p[Ye],x!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":throw Error(d(137,u));default:qn(r,u,Ye,x,p,null)}return;default:if(co(u)){for(at in p)p.hasOwnProperty(at)&&(x=p[at],x!==void 0&&Bh(r,u,at,x,p,void 0));return}}for(ne in p)p.hasOwnProperty(ne)&&(x=p[ne],x!=null&&qn(r,u,ne,x,p,null))}function y0(r,u,p,x){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,z=null,q=null,ne=null,xe=null,Ye=null,at=null;for(Qe in p){var dt=p[Qe];if(p.hasOwnProperty(Qe)&&dt!=null)switch(Qe){case"checked":break;case"value":break;case"defaultValue":xe=dt;default:x.hasOwnProperty(Qe)||qn(r,u,Qe,null,x,dt)}}for(var Xe in x){var Qe=x[Xe];if(dt=p[Xe],x.hasOwnProperty(Xe)&&(Qe!=null||dt!=null))switch(Xe){case"type":z=Qe;break;case"name":M=Qe;break;case"checked":Ye=Qe;break;case"defaultChecked":at=Qe;break;case"value":q=Qe;break;case"defaultValue":ne=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(d(137,u));break;default:Qe!==dt&&qn(r,u,Xe,Qe,x,dt)}}qu(r,q,ne,xe,Ye,at,z,M);return;case"select":Qe=q=ne=Xe=null;for(z in p)if(xe=p[z],p.hasOwnProperty(z)&&xe!=null)switch(z){case"value":break;case"multiple":Qe=xe;default:x.hasOwnProperty(z)||qn(r,u,z,null,x,xe)}for(M in x)if(z=x[M],xe=p[M],x.hasOwnProperty(M)&&(z!=null||xe!=null))switch(M){case"value":Xe=z;break;case"defaultValue":ne=z;break;case"multiple":q=z;default:z!==xe&&qn(r,u,M,z,x,xe)}u=ne,p=q,x=Qe,Xe!=null?cl(r,!!p,Xe,!1):!!x!=!!p&&(u!=null?cl(r,!!p,u,!0):cl(r,!!p,p?[]:"",!1));return;case"textarea":Qe=Xe=null;for(ne in p)if(M=p[ne],p.hasOwnProperty(ne)&&M!=null&&!x.hasOwnProperty(ne))switch(ne){case"value":break;case"children":break;default:qn(r,u,ne,null,x,M)}for(q in x)if(M=x[q],z=p[q],x.hasOwnProperty(q)&&(M!=null||z!=null))switch(q){case"value":Xe=M;break;case"defaultValue":Qe=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(d(91));break;default:M!==z&&qn(r,u,q,M,x,z)}$p(r,Xe,Qe);return;case"option":for(var un in p)if(Xe=p[un],p.hasOwnProperty(un)&&Xe!=null&&!x.hasOwnProperty(un))switch(un){case"selected":r.selected=!1;break;default:qn(r,u,un,null,x,Xe)}for(xe in x)if(Xe=x[xe],Qe=p[xe],x.hasOwnProperty(xe)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(xe){case"selected":r.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:qn(r,u,xe,Xe,x,Qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var sn in p)Xe=p[sn],p.hasOwnProperty(sn)&&Xe!=null&&!x.hasOwnProperty(sn)&&qn(r,u,sn,null,x,Xe);for(Ye in x)if(Xe=x[Ye],Qe=p[Ye],x.hasOwnProperty(Ye)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(d(137,u));break;default:qn(r,u,Ye,Xe,x,Qe)}return;default:if(co(u)){for(var xi in p)Xe=p[xi],p.hasOwnProperty(xi)&&Xe!==void 0&&!x.hasOwnProperty(xi)&&Bh(r,u,xi,void 0,x,Xe);for(at in x)Xe=x[at],Qe=p[at],!x.hasOwnProperty(at)||Xe===Qe||Xe===void 0&&Qe===void 0||Bh(r,u,at,Xe,x,Qe);return}}for(var Le in p)Xe=p[Le],p.hasOwnProperty(Le)&&Xe!=null&&!x.hasOwnProperty(Le)&&qn(r,u,Le,null,x,Xe);for(dt in x)Xe=x[dt],Qe=p[dt],!x.hasOwnProperty(dt)||Xe===Qe||Xe==null&&Qe==null||qn(r,u,dt,Xe,x,Qe)}var Rm=null,Pm=null;function fp(r){return r.nodeType===9?r:r.ownerDocument}function _0(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uy(r,u){if(r===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&u==="foreignObject"?0:r}function jl(r,u){return r==="textarea"||r==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var zm=null;function v0(){var r=window.event;return r&&r.type==="popstate"?r===zm?!1:(zm=r,!0):(zm=null,!1)}var hy=typeof setTimeout=="function"?setTimeout:void 0,b0=typeof clearTimeout=="function"?clearTimeout:void 0,x0=typeof Promise=="function"?Promise:void 0,Fv=typeof queueMicrotask=="function"?queueMicrotask:typeof x0<"u"?function(r){return x0.resolve(null).then(r).catch(w0)}:hy;function w0(r){setTimeout(function(){throw r})}function Rc(r){return r==="head"}function pp(r,u){var p=u,x=0,M=0;do{var z=p.nextSibling;if(r.removeChild(p),z&&z.nodeType===8)if(p=z.data,p==="/$"){if(0<x&&8>x){p=x;var q=r.ownerDocument;if(p&1&&Uh(q.documentElement),p&2&&Uh(q.body),p&4)for(p=q.head,Uh(p),q=p.firstChild;q;){var ne=q.nextSibling,xe=q.nodeName;q[ro]||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&q.rel.toLowerCase()==="stylesheet"||p.removeChild(q),q=ne}}if(M===0){r.removeChild(z),tr(u);return}M--}else p==="$"||p==="$?"||p==="$!"?M++:x=p.charCodeAt(0)-48;else x=0;p=z}while(p);tr(u)}function Nm(r){var u=r.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var p=u;switch(u=u.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Nm(p),Et(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}r.removeChild(p)}}function Lm(r,u,p,x){for(;r.nodeType===1;){var M=p;if(r.nodeName.toLowerCase()!==u.toLowerCase()){if(!x&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(x){if(!r[ro])switch(u){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(z=r.getAttribute("rel"),z==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(z!==M.rel||r.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(z=r.getAttribute("src"),(z!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&z&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(u==="input"&&r.type==="hidden"){var z=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===z)return r}else return r;if(r=Jo(r.nextSibling),r===null)break}return null}function Om(r,u,p){if(u==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!p||(r=Jo(r.nextSibling),r===null))return null;return r}function Kd(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function Uv(r,u){var p=r.ownerDocument;if(r.data!=="$?"||p.readyState==="complete")u();else{var x=function(){u(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),r._reactRetry=x}}function Jo(r){for(;r!=null;r=r.nextSibling){var u=r.nodeType;if(u===1||u===3)break;if(u===8){if(u=r.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return r}var dy=null;function Fh(r){r=r.previousSibling;for(var u=0;r;){if(r.nodeType===8){var p=r.data;if(p==="$"||p==="$!"||p==="$?"){if(u===0)return r;u--}else p==="/$"&&u++}r=r.previousSibling}return null}function Fr(r,u,p){switch(u=fp(p),r){case"html":if(r=u.documentElement,!r)throw Error(d(452));return r;case"head":if(r=u.head,!r)throw Error(d(453));return r;case"body":if(r=u.body,!r)throw Error(d(454));return r;default:throw Error(d(451))}}function Uh(r){for(var u=r.attributes;u.length;)r.removeAttributeNode(u[0]);Et(r)}var Bs=new Map,fy=new Set;function Jd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Pc=ct.d;ct.d={f:T0,r:S0,D:my,C:gy,L:E0,m:mp,X:A0,S:yy,M:_y};function T0(){var r=Pc.f(),u=Tm();return r||u}function S0(r){var u=an(r);u!==null&&u.tag===5&&u.type==="form"?Kn(u):Pc.r(r)}var ef=typeof document>"u"?null:document;function py(r,u,p){var x=ef;if(x&&typeof u=="string"&&u){var M=Ma(u);M='link[rel="'+r+'"][href="'+M+'"]',typeof p=="string"&&(M+='[crossorigin="'+p+'"]'),fy.has(M)||(fy.add(M),r={rel:r,crossOrigin:p,href:u},x.querySelector(M)===null&&(u=x.createElement("link"),lr(u,"link",r),Mi(u),x.head.appendChild(u)))}}function my(r){Pc.D(r),py("dns-prefetch",r,null)}function gy(r,u){Pc.C(r,u),py("preconnect",r,u)}function E0(r,u,p){Pc.L(r,u,p);var x=ef;if(x&&r&&u){var M='link[rel="preload"][as="'+Ma(u)+'"]';u==="image"&&p&&p.imageSrcSet?(M+='[imagesrcset="'+Ma(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(M+='[imagesizes="'+Ma(p.imageSizes)+'"]')):M+='[href="'+Ma(r)+'"]';var z=M;switch(u){case"style":z=Bl(r);break;case"script":z=tf(r)}Bs.has(z)||(r=N({rel:"preload",href:u==="image"&&p&&p.imageSrcSet?void 0:r,as:u},p),Bs.set(z,r),x.querySelector(M)!==null||u==="style"&&x.querySelector(Vh(z))||u==="script"&&x.querySelector(s(z))||(u=x.createElement("link"),lr(u,"link",r),Mi(u),x.head.appendChild(u)))}}function mp(r,u){Pc.m(r,u);var p=ef;if(p&&r){var x=u&&typeof u.as=="string"?u.as:"script",M='link[rel="modulepreload"][as="'+Ma(x)+'"][href="'+Ma(r)+'"]',z=M;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=tf(r)}if(!Bs.has(z)&&(r=N({rel:"modulepreload",href:r},u),Bs.set(z,r),p.querySelector(M)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(s(z)))return}x=p.createElement("link"),lr(x,"link",r),Mi(x),p.head.appendChild(x)}}}function yy(r,u,p){Pc.S(r,u,p);var x=ef;if(x&&r){var M=Ja(x).hoistableStyles,z=Bl(r);u=u||"default";var q=M.get(z);if(!q){var ne={loading:0,preload:null};if(q=x.querySelector(Vh(z)))ne.loading=5;else{r=N({rel:"stylesheet",href:r,"data-precedence":u},p),(p=Bs.get(z))&&h(r,p);var xe=q=x.createElement("link");Mi(xe),lr(xe,"link",r),xe._p=new Promise(function(Ye,at){xe.onload=Ye,xe.onerror=at}),xe.addEventListener("load",function(){ne.loading|=1}),xe.addEventListener("error",function(){ne.loading|=2}),ne.loading|=4,a(q,u,x)}q={type:"stylesheet",instance:q,count:1,state:ne},M.set(z,q)}}}function A0(r,u){Pc.X(r,u);var p=ef;if(p&&r){var x=Ja(p).hoistableScripts,M=tf(r),z=x.get(M);z||(z=p.querySelector(s(M)),z||(r=N({src:r,async:!0},u),(u=Bs.get(M))&&g(r,u),z=p.createElement("script"),Mi(z),lr(z,"link",r),p.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},x.set(M,z))}}function _y(r,u){Pc.M(r,u);var p=ef;if(p&&r){var x=Ja(p).hoistableScripts,M=tf(r),z=x.get(M);z||(z=p.querySelector(s(M)),z||(r=N({src:r,async:!0,type:"module"},u),(u=Bs.get(M))&&g(r,u),z=p.createElement("script"),Mi(z),lr(z,"link",r),p.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},x.set(M,z))}}function gp(r,u,p,x){var M=(M=Bt.current)?Jd(M):null;if(!M)throw Error(d(446));switch(r){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(u=Bl(p.href),p=Ja(M).hoistableStyles,x=p.get(u),x||(x={type:"style",instance:null,count:0,state:null},p.set(u,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){r=Bl(p.href);var z=Ja(M).hoistableStyles,q=z.get(r);if(q||(M=M.ownerDocument||M,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(r,q),(z=M.querySelector(Vh(r)))&&!z._p&&(q.instance=z,q.state.loading=5),Bs.has(r)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Bs.set(r,p),z||vy(M,r,p,q.state))),u&&x===null)throw Error(d(528,""));return q}if(u&&x!==null)throw Error(d(529,""));return null;case"script":return u=p.async,p=p.src,typeof p=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=tf(p),p=Ja(M).hoistableScripts,x=p.get(u),x||(x={type:"script",instance:null,count:0,state:null},p.set(u,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(d(444,r))}}function Bl(r){return'href="'+Ma(r)+'"'}function Vh(r){return'link[rel="stylesheet"]['+r+"]"}function jm(r){return N({},r,{"data-precedence":r.precedence,precedence:null})}function vy(r,u,p,x){r.querySelector('link[rel="preload"][as="style"]['+u+"]")?x.loading=1:(u=r.createElement("link"),x.preload=u,u.addEventListener("load",function(){return x.loading|=1}),u.addEventListener("error",function(){return x.loading|=2}),lr(u,"link",p),Mi(u),r.head.appendChild(u))}function tf(r){return'[src="'+Ma(r)+'"]'}function s(r){return"script[async]"+r}function t(r,u,p){if(u.count++,u.instance===null)switch(u.type){case"style":var x=r.querySelector('style[data-href~="'+Ma(p.href)+'"]');if(x)return u.instance=x,Mi(x),x;var M=N({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(r.ownerDocument||r).createElement("style"),Mi(x),lr(x,"style",M),a(x,p.precedence,r),u.instance=x;case"stylesheet":M=Bl(p.href);var z=r.querySelector(Vh(M));if(z)return u.state.loading|=4,u.instance=z,Mi(z),z;x=jm(p),(M=Bs.get(M))&&h(x,M),z=(r.ownerDocument||r).createElement("link"),Mi(z);var q=z;return q._p=new Promise(function(ne,xe){q.onload=ne,q.onerror=xe}),lr(z,"link",x),u.state.loading|=4,a(z,p.precedence,r),u.instance=z;case"script":return z=tf(p.src),(M=r.querySelector(s(z)))?(u.instance=M,Mi(M),M):(x=p,(M=Bs.get(z))&&(x=N({},p),g(x,M)),r=r.ownerDocument||r,M=r.createElement("script"),Mi(M),lr(M,"link",x),r.head.appendChild(M),u.instance=M);case"void":return null;default:throw Error(d(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(x=u.instance,u.state.loading|=4,a(x,p.precedence,r));return u.instance}function a(r,u,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=x.length?x[x.length-1]:null,z=M,q=0;q<x.length;q++){var ne=x[q];if(ne.dataset.precedence===u)z=ne;else if(z!==M)break}z?z.parentNode.insertBefore(r,z.nextSibling):(u=p.nodeType===9?p.head:p,u.insertBefore(r,u.firstChild))}function h(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.title==null&&(r.title=u.title)}function g(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.integrity==null&&(r.integrity=u.integrity)}var T=null;function S(r,u,p){if(T===null){var x=new Map,M=T=new Map;M.set(p,x)}else M=T,x=M.get(p),x||(x=new Map,M.set(p,x));if(x.has(r))return x;for(x.set(r,null),p=p.getElementsByTagName(r),M=0;M<p.length;M++){var z=p[M];if(!(z[ro]||z[Wt]||r==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var q=z.getAttribute(u)||"";q=r+q;var ne=x.get(q);ne?ne.push(z):x.set(q,[z])}}return x}function A(r,u,p){r=r.ownerDocument||r,r.head.insertBefore(p,u==="title"?r.querySelector("head > title"):null)}function D(r,u,p){if(p===1||u.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return r=u.disabled,typeof u.precedence=="string"&&r==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function P(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var L=null;function F(){}function $(r,u,p){if(L===null)throw Error(d(475));var x=L;if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var M=Bl(p.href),z=r.querySelector(Vh(M));if(z){r=z._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(x.count++,x=X.bind(x),r.then(x,x)),u.state.loading|=4,u.instance=z,Mi(z);return}z=r.ownerDocument||r,p=jm(p),(M=Bs.get(M))&&h(p,M),z=z.createElement("link"),Mi(z);var q=z;q._p=new Promise(function(ne,xe){q.onload=ne,q.onerror=xe}),lr(z,"link",p),u.instance=z}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(u,r),(r=u.state.preload)&&(u.state.loading&3)===0&&(x.count++,u=X.bind(x),r.addEventListener("load",u),r.addEventListener("error",u))}}function H(){if(L===null)throw Error(d(475));var r=L;return r.stylesheets&&r.count===0&&se(r,r.stylesheets),0<r.count?function(u){var p=setTimeout(function(){if(r.stylesheets&&se(r,r.stylesheets),r.unsuspend){var x=r.unsuspend;r.unsuspend=null,x()}},6e4);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(p)}}:null}function X(){if(this.count--,this.count===0){if(this.stylesheets)se(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var J=null;function se(r,u){r.stylesheets=null,r.unsuspend!==null&&(r.count++,J=new Map,u.forEach(he,r),J=null,X.call(r))}function he(r,u){if(!(u.state.loading&4)){var p=J.get(r);if(p)var x=p.get(null);else{p=new Map,J.set(r,p);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<M.length;z++){var q=M[z];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(p.set(q.dataset.precedence,q),x=q)}x&&p.set(null,x)}M=u.instance,q=M.getAttribute("data-precedence"),z=p.get(q)||x,z===x&&p.set(null,M),p.set(q,M),this.count++,x=X.bind(this),M.addEventListener("load",x),M.addEventListener("error",x),z?z.parentNode.insertBefore(M,z.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),u.state.loading|=4}}var De={$$typeof:Fe,Provider:null,Consumer:null,_currentValue:ht,_currentValue2:ht,_threadCount:0};function ve(r,u,p,x,M,z,q,ne){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lt(0),this.hiddenUpdates=Lt(null),this.identifierPrefix=x,this.onUncaughtError=M,this.onCaughtError=z,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ne,this.incompleteTransitions=new Map}function we(r,u,p,x,M,z,q,ne,xe,Ye,at,dt){return r=new ve(r,u,p,q,ne,xe,Ye,dt),u=1,z===!0&&(u|=24),z=Ba(3,null,null,u),r.current=z,z.stateNode=r,u=Tl(),u.refCount++,r.pooledCache=u,u.refCount++,z.memoizedState={element:x,isDehydrated:p,cache:u},Uf(z),r}function Be(r){return r?(r=gn,r):gn}function We(r,u,p,x,M,z){M=Be(M),x.context===null?x.context=M:x.pendingContext=M,x=Sl(u),x.payload={element:p},z=z===void 0?null:z,z!==null&&(x.callback=z),p=Vo(r,x,u),p!==null&&(Os(p,r,u),vc(p,r,u))}function lt(r,u){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var p=r.retryLane;r.retryLane=p!==0&&p<u?p:u}}function Tt(r,u){lt(r,u),(r=r.alternate)&&lt(r,u)}function _t(r){if(r.tag===13){var u=ja(r,67108864);u!==null&&Os(u,r,67108864),Tt(r,67108864)}}var xt=!0;function Ft(r,u,p,x){var M=Ge.T;Ge.T=null;var z=ct.p;try{ct.p=2,wt(r,u,p,x)}finally{ct.p=z,Ge.T=M}}function St(r,u,p,x){var M=Ge.T;Ge.T=null;var z=ct.p;try{ct.p=8,wt(r,u,p,x)}finally{ct.p=z,Ge.T=M}}function wt(r,u,p,x){if(xt){var M=tt(x);if(M===null)km(r,u,x,qt,p),Ii(r,x);else if(Vr(M,r,u,p,x))x.stopPropagation();else if(Ii(r,x),u&4&&-1<Ur.indexOf(r)){for(;M!==null;){var z=an(M);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var q=Ce(z.pendingLanes);if(q!==0){var ne=z;for(ne.pendingLanes|=2,ne.entangledLanes|=2;q;){var xe=1<<31-Me(q);ne.entanglements[1]|=xe,q&=~xe}js(z),(ui&6)===0&&(bm=ji()+500,Oh(0))}}break;case 13:ne=ja(z,2),ne!==null&&Os(ne,z,2),Tm(),Tt(z,2)}if(z=tt(x),z===null&&km(r,u,x,qt,p),z===M)break;M=z}M!==null&&x.stopPropagation()}else km(r,u,x,null,p)}}function tt(r){return r=Zc(r),Kt(r)}var qt=null;function Kt(r){if(qt=null,r=hn(r),r!==null){var u=_(r);if(u===null)r=null;else{var p=u.tag;if(p===13){if(r=v(u),r!==null)return r;r=null}else if(p===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;r=null}else u!==r&&(r=null)}}return qt=r,null}function Zt(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qa()){case za:return 2;case ha:return 8;case qr:case xs:return 32;case Ka:return 268435456;default:return 32}default:return 32}}var Nt=!1,pn=null,Jn=null,bi=null,mr=new Map,Ta=new Map,gr=[],Ur="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ii(r,u){switch(r){case"focusin":case"focusout":pn=null;break;case"dragenter":case"dragleave":Jn=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":mr.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ta.delete(u.pointerId)}}function Ji(r,u,p,x,M,z){return r===null||r.nativeEvent!==z?(r={blockedOn:u,domEventName:p,eventSystemFlags:x,nativeEvent:z,targetContainers:[M]},u!==null&&(u=an(u),u!==null&&_t(u)),r):(r.eventSystemFlags|=x,u=r.targetContainers,M!==null&&u.indexOf(M)===-1&&u.push(M),r)}function Vr(r,u,p,x,M){switch(u){case"focusin":return pn=Ji(pn,r,u,p,x,M),!0;case"dragenter":return Jn=Ji(Jn,r,u,p,x,M),!0;case"mouseover":return bi=Ji(bi,r,u,p,x,M),!0;case"pointerover":var z=M.pointerId;return mr.set(z,Ji(mr.get(z)||null,r,u,p,x,M)),!0;case"gotpointercapture":return z=M.pointerId,Ta.set(z,Ji(Ta.get(z)||null,r,u,p,x,M)),!0}return!1}function Dr(r){var u=hn(r.target);if(u!==null){var p=_(u);if(p!==null){if(u=p.tag,u===13){if(u=v(p),u!==null){r.blockedOn=u,yr(r.priority,function(){if(p.tag===13){var x=fs();x=on(x);var M=ja(p,x);M!==null&&Os(M,p,x),Tt(p,x)}});return}}else if(u===3&&p.stateNode.current.memoizedState.isDehydrated){r.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Gr(r){if(r.blockedOn!==null)return!1;for(var u=r.targetContainers;0<u.length;){var p=tt(r.nativeEvent);if(p===null){p=r.nativeEvent;var x=new p.constructor(p.type,p);Po=x,p.target.dispatchEvent(x),Po=null}else return u=an(p),u!==null&&_t(u),r.blockedOn=p,!1;u.shift()}return!0}function ms(r,u,p){Gr(r)&&p.delete(u)}function kr(){Nt=!1,pn!==null&&Gr(pn)&&(pn=null),Jn!==null&&Gr(Jn)&&(Jn=null),bi!==null&&Gr(bi)&&(bi=null),mr.forEach(ms),Ta.forEach(ms)}function la(r,u){r.blockedOn===u&&(r.blockedOn=null,Nt||(Nt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,kr)))}var er=null;function wr(r){er!==r&&(er=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){er===r&&(er=null);for(var u=0;u<r.length;u+=3){var p=r[u],x=r[u+1],M=r[u+2];if(typeof x!="function"){if(Kt(x||p)===null)continue;break}var z=an(p);z!==null&&(r.splice(u,3),u-=3,Di(z,{pending:!0,data:M,method:p.method,action:x},x,M))}}))}function tr(r){function u(xe){return la(xe,r)}pn!==null&&la(pn,r),Jn!==null&&la(Jn,r),bi!==null&&la(bi,r),mr.forEach(u),Ta.forEach(u);for(var p=0;p<gr.length;p++){var x=gr[p];x.blockedOn===r&&(x.blockedOn=null)}for(;0<gr.length&&(p=gr[0],p.blockedOn===null);)Dr(p),p.blockedOn===null&&gr.shift();if(p=(r.ownerDocument||r).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var M=p[x],z=p[x+1],q=M[nn]||null;if(typeof z=="function")q||wr(p);else if(q){var ne=null;if(z&&z.hasAttribute("formAction")){if(M=z,q=z[nn]||null)ne=q.formAction;else if(Kt(M)!==null)continue}else ne=q.action;typeof ne=="function"?p[x+1]=ne:(p.splice(x,3),x-=3),wr(p)}}}function nr(r){this._internalRoot=r}si.prototype.render=nr.prototype.render=function(r){var u=this._internalRoot;if(u===null)throw Error(d(409));var p=u.current,x=fs();We(p,x,r,u,null,null)},si.prototype.unmount=nr.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var u=r.containerInfo;We(r.current,2,null,r,null,null),Tm(),u[Ai]=null}};function si(r){this._internalRoot=r}si.prototype.unstable_scheduleHydration=function(r){if(r){var u=hr();r={blockedOn:null,target:r,priority:u};for(var p=0;p<gr.length&&u!==0&&u<gr[p].priority;p++);gr.splice(p,0,r),p===0&&Dr(r)}};var bo=n.version;if(bo!=="19.1.1")throw Error(d(527,bo,"19.1.1"));ct.findDOMNode=function(r){var u=r._reactInternals;if(u===void 0)throw typeof r.render=="function"?Error(d(188)):(r=Object.keys(r).join(","),Error(d(268,r)));return r=C(u),r=r!==null?R(r):null,r=r===null?null:r.stateNode,r};var nf={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Ge,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gs.isDisabled&&gs.supportsFiber)try{da=gs.inject(nf),Bi=gs}catch{}}return xy.createRoot=function(r,u){if(!m(r))throw Error(d(299));var p=!1,x="",M=N_,z=lm,q=L_,ne=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(M=u.onUncaughtError),u.onCaughtError!==void 0&&(z=u.onCaughtError),u.onRecoverableError!==void 0&&(q=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ne=u.unstable_transitionCallbacks)),u=we(r,1,!1,null,null,p,x,M,z,q,ne,null),r[Ai]=u.current,Dm(r),new nr(u)},xy.hydrateRoot=function(r,u,p){if(!m(r))throw Error(d(299));var x=!1,M="",z=N_,q=lm,ne=L_,xe=null,Ye=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(M=p.identifierPrefix),p.onUncaughtError!==void 0&&(z=p.onUncaughtError),p.onCaughtError!==void 0&&(q=p.onCaughtError),p.onRecoverableError!==void 0&&(ne=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(xe=p.unstable_transitionCallbacks),p.formState!==void 0&&(Ye=p.formState)),u=we(r,1,!0,u,p??null,x,M,z,q,ne,xe,Ye),u.context=Be(null),p=u.current,x=fs(),x=on(x),M=Sl(x),M.callback=null,Vo(p,M,x),p=x,u.current.lanes=p,Re(u,p),js(u),r[Ai]=u.current,Dm(r),new si(u)},xy.version="19.1.1",xy}var r1;function pE(){if(r1)return $v.exports;r1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),$v.exports=fE(),$v.exports}var mE=pE();const gE=Lp(mE),yE="modulepreload",_E=function(i){return"https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-17T06:33/"+i},a1={},Kw=function(n,l,d){let m=Promise.resolve();if(l&&l.length>0){let R=function(N){return Promise.all(N.map(B=>Promise.resolve(B).then(V=>({status:"fulfilled",value:V}),V=>({status:"rejected",reason:V}))))};var v=R;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),C=c?.nonce||c?.getAttribute("nonce");m=R(l.map(N=>{if(N=_E(N),N in a1)return;a1[N]=!0;const B=N.endsWith(".css"),V=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${N}"]${V}`))return;const G=document.createElement("link");if(G.rel=B?"stylesheet":yE,B||(G.as="script"),G.crossOrigin="",G.href=N,C&&G.setAttribute("nonce",C),document.head.appendChild(G),B)return new Promise((ae,me)=>{G.addEventListener("load",ae),G.addEventListener("error",()=>me(new Error(`Unable to preload CSS for ${N}`)))})}))}function _(c){const C=new Event("vite:preloadError",{cancelable:!0});if(C.payload=c,window.dispatchEvent(C),!C.defaultPrevented)throw c}return m.then(c=>{for(const C of c||[])C.status==="rejected"&&_(C.reason);return n().catch(_)})},vE=ce.createContext(null);function bE(i,n){const l=Array.isArray(i)?i[0]:i?i.x:0,d=Array.isArray(i)?i[1]:i?i.y:0,m=Array.isArray(n)?n[0]:n?n.x:0,_=Array.isArray(n)?n[1]:n?n.y:0;return l===m&&d===_}function xo(i,n){if(i===n)return!0;if(!i||!n)return!1;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let l=0;l<i.length;l++)if(!xo(i[l],n[l]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof i=="object"&&typeof n=="object"){const l=Object.keys(i),d=Object.keys(n);if(l.length!==d.length)return!1;for(const m of l)if(!n.hasOwnProperty(m)||!xo(i[m],n[m]))return!1;return!0}return!1}function s1(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function o1(i,n){const l=n.viewState||n,d={};if("longitude"in l&&"latitude"in l&&(l.longitude!==i.center.lng||l.latitude!==i.center.lat)){const m=i.center.constructor;d.center=new m(l.longitude,l.latitude)}return"zoom"in l&&l.zoom!==i.zoom&&(d.zoom=l.zoom),"bearing"in l&&l.bearing!==i.bearing&&(d.bearing=l.bearing),"pitch"in l&&l.pitch!==i.pitch&&(d.pitch=l.pitch),l.padding&&i.padding&&!xo(l.padding,i.padding)&&(d.padding=l.padding),d}const xE=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function l1(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const n={};for(const d of i.layers)n[d.id]=d;const l=i.layers.map(d=>{let m=null;"interactive"in d&&(m=Object.assign({},d),delete m.interactive);const _=n[d.ref];if(_){m=m||Object.assign({},d),delete m.ref;for(const v of xE)v in _&&(m[v]=_[v])}return m||d});return{...i,layers:l}}const c1={version:8,sources:{},layers:[]},u1={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},h1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},d1={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},wE=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],TE=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class eg{constructor(n,l,d){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=m=>{const _=this.props[d1[m.type]];_?_(m):m.type==="error"&&console.error(m.error)},this._onCameraEvent=m=>{if(this._internalUpdate)return;m.viewState=this._propsedCameraUpdate||s1(this._map.transform);const _=this.props[h1[m.type]];_&&_(m)},this._onCameraUpdate=m=>this._internalUpdate?m:(this._propsedCameraUpdate=s1(m),o1(m,this.props)),this._onPointerEvent=m=>{(m.type==="mousemove"||m.type==="mouseout")&&this._updateHover(m);const _=this.props[u1[m.type]];_&&(this.props.interactiveLayerIds&&m.type!=="mouseover"&&m.type!=="mouseout"&&(m.features=this._hoveredFeatures||this._queryRenderedFeatures(m.point)),_(m),delete m.features)},this._MapClass=n,this.props=l,this._initialize(d)}get map(){return this._map}setProps(n){const l=this.props;this.props=n;const d=this._updateSettings(n,l),m=this._updateSize(n),_=this._updateViewState(n);this._updateStyle(n,l),this._updateStyleComponents(n),this._updateHandlers(n,l),(d||m||_&&!this._map.isMoving())&&this.redraw()}static reuse(n,l){const d=eg.savedMaps.pop();if(!d)return null;const m=d.map,_=m.getContainer();for(l.className=_.className;_.childNodes.length>0;)l.appendChild(_.childNodes[0]);m._container=l;const v=m._resizeObserver;v&&(v.disconnect(),v.observe(l)),d.setProps({...n,styleDiffing:!1}),m.resize();const{initialViewState:c}=n;return c&&(c.bounds?m.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):d._updateViewState(c)),m.isStyleLoaded()?m.fire("load"):m.once("style.load",()=>m.fire("load")),m._update(),d}_initialize(n){const{props:l}=this,{mapStyle:d=c1}=l,m={...l,...l.initialViewState,container:n,style:l1(d)},_=m.initialViewState||m.viewState||m;if(Object.assign(m,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),l.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,l.gl)}const v=new this._MapClass(m);_.padding&&v.setPadding(_.padding),l.cursor&&(v.getCanvas().style.cursor=l.cursor),v.transformCameraUpdate=this._onCameraUpdate,v.on("style.load",()=>{this._styleComponents={light:v.getLight(),sky:v.getSky(),projection:v.getProjection?.(),terrain:v.getTerrain()},this._updateStyleComponents(this.props)}),v.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in u1)v.on(c,this._onPointerEvent);for(const c in h1)v.on(c,this._onCameraEvent);for(const c in d1)v.on(c,this._onEvent);this._map=v}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),eg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_updateSize(n){const{viewState:l}=n;if(l){const d=this._map;if(l.width!==d.transform.width||l.height!==d.transform.height)return d.resize(),!0}return!1}_updateViewState(n){const l=this._map,d=l.transform;if(!l.isMoving()){const _=o1(d,n);if(Object.keys(_).length>0)return this._internalUpdate=!0,l.jumpTo(_),this._internalUpdate=!1,!0}return!1}_updateSettings(n,l){const d=this._map;let m=!1;for(const _ of wE)_ in n&&!xo(n[_],l[_])&&(m=!0,d[`set${_[0].toUpperCase()}${_.slice(1)}`]?.call(d,n[_]));return m}_updateStyle(n,l){if(n.cursor!==l.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==l.mapStyle){const{mapStyle:d=c1,styleDiffing:m=!0}=n,_={diff:m};"localIdeographFontFamily"in n&&(_.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(l1(d),_)}}_updateStyleComponents({light:n,projection:l,sky:d,terrain:m}){const _=this._map,v=this._styleComponents;_.style._loaded&&(n&&!xo(n,v.light)&&(v.light=n,_.setLight(n)),l&&!xo(l,v.projection)&&l!==v.projection?.type&&(v.projection=typeof l=="string"?{type:l}:l,_.setProjection?.(v.projection)),d&&!xo(d,v.sky)&&(v.sky=d,_.setSky(d)),m!==void 0&&!xo(m,v.terrain)&&(!m||_.getSource(m.source))&&(v.terrain=m,_.setTerrain(m)))}_updateHandlers(n,l){const d=this._map;for(const m of TE){const _=n[m]??!0,v=l[m]??!0;xo(_,v)||(_?d[m].enable(_):d[m].disable())}}_queryRenderedFeatures(n){const l=this._map,{interactiveLayerIds:d=[]}=this.props;try{return l.queryRenderedFeatures(n,{layers:d.filter(l.getLayer.bind(l))})}catch{return[]}}_updateHover(n){const{props:l}=this;if(l.interactiveLayerIds&&(l.onMouseMove||l.onMouseEnter||l.onMouseLeave)){const m=n.type,_=this._hoveredFeatures?.length>0,v=this._queryRenderedFeatures(n.point),c=v.length>0;!c&&_&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=v,c&&!_&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=m}else this._hoveredFeatures=null}}eg.savedMaps=[];const SE=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function EE(i){if(!i)return null;const n=i.map,l={getMap:()=>n};for(const d of AE(n))!(d in l)&&!SE.includes(d)&&(l[d]=n[d].bind(n));return l}function AE(i){const n=new Set;let l=i;for(;l;){for(const d of Object.getOwnPropertyNames(l))d[0]!=="_"&&typeof i[d]=="function"&&d!=="fire"&&d!=="setEventedParent"&&n.add(d);l=Object.getPrototypeOf(l)}return Array.from(n)}const ME=typeof document<"u"?ce.useLayoutEffect:ce.useEffect;function CE(i,n){const{RTLTextPlugin:l,maxParallelImageRequests:d,workerCount:m,workerUrl:_}=n;if(l&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:v,lazy:c=!0}=typeof l=="string"?{pluginUrl:l}:l;i.setRTLTextPlugin(v,C=>{C&&console.error(C)},c)}d!==void 0&&i.setMaxParallelImageRequests(d),m!==void 0&&i.setWorkerCount(m),_!==void 0&&i.setWorkerUrl(_)}const pg=ce.createContext(null);function DE(i,n){const l=ce.useContext(vE),[d,m]=ce.useState(null),_=ce.useRef(),{current:v}=ce.useRef({mapLib:null,map:null});ce.useEffect(()=>{const R=i.mapLib;let N=!0,B;return Promise.resolve(R||Kw(()=>Promise.resolve().then(()=>r2),void 0)).then(V=>{if(!N)return;if(!V)throw new Error("Invalid mapLib");const G="Map"in V?V:V.default;if(!G.Map)throw new Error("Invalid mapLib");CE(G,i),i.reuseMaps&&(B=eg.reuse(i,_.current)),B||(B=new eg(G.Map,i,_.current)),v.map=EE(B),v.mapLib=G,m(B),l?.onMapMount(v.map,i.id)}).catch(V=>{const{onError:G}=i;G?G({type:"error",target:null,originalEvent:null,error:V}):console.error(V)}),()=>{N=!1,B&&(l?.onMapUnmount(i.id),i.reuseMaps?B.recycle():B.destroy())}},[]),ME(()=>{d&&d.setProps(i)}),ce.useImperativeHandle(n,()=>v.map,[d]);const c=ce.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),C={height:"100%"};return ce.createElement("div",{id:i.id,ref:_,style:c},d&&ce.createElement(pg.Provider,{value:v},ce.createElement("div",{"mapboxgl-children":"",style:C},i.children)))}const kE=ce.forwardRef(DE);var ax=Qw();const bp=Lp(ax),IE=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ud(i,n){if(!i||!n)return;const l=i.style;for(const d in n){const m=n[d];Number.isFinite(m)&&!IE.test(d)?l[d]=`${m}px`:l[d]=m}}function Jw(i,n){if(i===n)return null;const l=f1(i),d=f1(n),m=[];for(const _ of d)l.has(_)||m.push(_);for(const _ of l)d.has(_)||m.push(_);return m.length===0?null:m}function f1(i){return new Set(i?i.trim().split(/\s+/):[])}const p1=ce.memo(ce.forwardRef((i,n)=>{const{map:l,mapLib:d}=ce.useContext(pg),m=ce.useRef({props:i}),_=ce.useMemo(()=>{let Ne=!1;ce.Children.forEach(i.children,qe=>{qe&&(Ne=!0)});const Ve={...i,element:Ne?document.createElement("div"):void 0},Fe=new d.Marker(Ve);return Fe.setLngLat([i.longitude,i.latitude]),Fe.getElement().addEventListener("click",qe=>{m.current.props.onClick?.({type:"click",target:Fe,originalEvent:qe})}),Fe.on("dragstart",qe=>{const Ae=qe;Ae.lngLat=_.getLngLat(),m.current.props.onDragStart?.(Ae)}),Fe.on("drag",qe=>{const Ae=qe;Ae.lngLat=_.getLngLat(),m.current.props.onDrag?.(Ae)}),Fe.on("dragend",qe=>{const Ae=qe;Ae.lngLat=_.getLngLat(),m.current.props.onDragEnd?.(Ae)}),Fe},[]);ce.useEffect(()=>(_.addTo(l.getMap()),()=>{_.remove()}),[]);const{longitude:v,latitude:c,offset:C,style:R,draggable:N=!1,popup:B=null,rotation:V=0,rotationAlignment:G="auto",pitchAlignment:ae="auto"}=i;ce.useEffect(()=>{ud(_.getElement(),R)},[R]),ce.useImperativeHandle(n,()=>_,[]);const me=m.current.props;(_.getLngLat().lng!==v||_.getLngLat().lat!==c)&&_.setLngLat([v,c]),C&&!bE(_.getOffset(),C)&&_.setOffset(C),_.isDraggable()!==N&&_.setDraggable(N),_.getRotation()!==V&&_.setRotation(V),_.getRotationAlignment()!==G&&_.setRotationAlignment(G),_.getPitchAlignment()!==ae&&_.setPitchAlignment(ae),_.getPopup()!==B&&_.setPopup(B);const pe=Jw(me.className,i.className);if(pe)for(const Ne of pe)_.toggleClassName(Ne);return m.current.props=i,ax.createPortal(i.children,_.getElement())})),e2=ce.memo(ce.forwardRef((i,n)=>{const{map:l,mapLib:d}=ce.useContext(pg),m=ce.useMemo(()=>document.createElement("div"),[]),_=ce.useRef({props:i}),v=ce.useMemo(()=>{const c={...i},C=new d.Popup(c);return C.setLngLat([i.longitude,i.latitude]),C.once("open",R=>{_.current.props.onOpen?.(R)}),C},[]);if(ce.useEffect(()=>{const c=C=>{_.current.props.onClose?.(C)};return v.on("close",c),v.setDOMContent(m).addTo(l.getMap()),()=>{v.off("close",c),v.isOpen()&&v.remove()}},[]),ce.useEffect(()=>{ud(v.getElement(),i.style)},[i.style]),ce.useImperativeHandle(n,()=>v,[]),v.isOpen()){const c=_.current.props;(v.getLngLat().lng!==i.longitude||v.getLngLat().lat!==i.latitude)&&v.setLngLat([i.longitude,i.latitude]),i.offset&&!xo(c.offset,i.offset)&&v.setOffset(i.offset),(c.anchor!==i.anchor||c.maxWidth!==i.maxWidth)&&(v.options.anchor=i.anchor,v.setMaxWidth(i.maxWidth));const C=Jw(c.className,i.className);if(C)for(const R of C)v.toggleClassName(R);_.current.props=i}return ax.createPortal(i.children,m)}));function Op(i,n,l,d){const m=ce.useContext(pg),_=ce.useMemo(()=>i(m),[]);return ce.useEffect(()=>{const v=n,c=null,C=typeof n=="function"?n:null,{map:R}=m;return R.hasControl(_)||(R.addControl(_,v?.position),c&&c(m)),()=>{C&&C(m),R.hasControl(_)&&R.removeControl(_)}},[]),_}function RE(i){const n=Op(({mapLib:l})=>new l.AttributionControl(i),{position:i.position});return ce.useEffect(()=>{ud(n._container,i.style)},[i.style]),null}ce.memo(RE);function PE(i){const n=Op(({mapLib:l})=>new l.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return ce.useEffect(()=>{ud(n._controlContainer,i.style)},[i.style]),null}ce.memo(PE);function zE(i,n){const l=ce.useRef({props:i}),d=Op(({mapLib:m})=>{const _=new m.GeolocateControl(i),v=_._setupUI;return _._setupUI=()=>{_._container.hasChildNodes()||v()},_.on("geolocate",c=>{l.current.props.onGeolocate?.(c)}),_.on("error",c=>{l.current.props.onError?.(c)}),_.on("outofmaxbounds",c=>{l.current.props.onOutOfMaxBounds?.(c)}),_.on("trackuserlocationstart",c=>{l.current.props.onTrackUserLocationStart?.(c)}),_.on("trackuserlocationend",c=>{l.current.props.onTrackUserLocationEnd?.(c)}),_},{position:i.position});return l.current.props=i,ce.useImperativeHandle(n,()=>d,[]),ce.useEffect(()=>{ud(d._container,i.style)},[i.style]),null}ce.memo(ce.forwardRef(zE));function NE(i){const n=Op(({mapLib:l})=>new l.NavigationControl(i),{position:i.position});return ce.useEffect(()=>{ud(n._container,i.style)},[i.style]),null}const LE=ce.memo(NE);function OE(i){const n=Op(({mapLib:_})=>new _.ScaleControl(i),{position:i.position}),l=ce.useRef(i),d=l.current;l.current=i;const{style:m}=i;return i.maxWidth!==void 0&&i.maxWidth!==d.maxWidth&&(n.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==d.unit&&n.setUnit(i.unit),ce.useEffect(()=>{ud(n._container,m)},[m]),null}ce.memo(OE);function jE(i){const n=Op(({mapLib:l})=>new l.TerrainControl(i),{position:i.position});return ce.useEffect(()=>{ud(n._container,i.style)},[i.style]),null}ce.memo(jE);function BE(i){const n=Op(({mapLib:l})=>new l.LogoControl(i),{position:i.position});return ce.useEffect(()=>{ud(n._container,i.style)},[i.style]),null}ce.memo(BE);function U0(i,n){if(!i)throw new Error(n)}let FE=0;function UE(i,n,l){if(i.style&&i.style._loaded){const d={...l};return delete d.id,delete d.children,i.addSource(n,d),i.getSource(n)}return null}function VE(i,n,l){U0(n.id===l.id,"source id changed"),U0(n.type===l.type,"source type changed");let d="",m=0;for(const v in n)v!=="children"&&v!=="id"&&!xo(l[v],n[v])&&(d=v,m++);if(!m)return;const _=n.type;if(_==="geojson")i.setData(n.data);else if(_==="image")i.updateImage({url:n.url,coordinates:n.coordinates});else switch(d){case"coordinates":i.setCoordinates?.(n.coordinates);break;case"url":i.setUrl?.(n.url);break;case"tiles":i.setTiles?.(n.tiles);break;default:console.warn(`Unable to update <Source> prop: ${d}`)}}function GE(i){const n=ce.useContext(pg).map.getMap(),l=ce.useRef(i),[,d]=ce.useState(0),m=ce.useMemo(()=>i.id||`jsx-source-${FE++}`,[]);ce.useEffect(()=>{if(n){const v=()=>setTimeout(()=>d(c=>c+1),0);return n.on("styledata",v),v(),()=>{if(n.off("styledata",v),n.style&&n.style._loaded&&n.getSource(m)){const c=n.getStyle()?.layers;if(c)for(const C of c)C.source===m&&n.removeLayer(C.id);n.removeSource(m)}}}},[n]);let _=n&&n.style&&n.getSource(m);return _?VE(_,i,l.current):_=UE(n,m,i),l.current=i,_&&ce.Children.map(i.children,v=>v&&ce.cloneElement(v,{source:m}))||null}function ZE(i,n,l,d){if(U0(l.id===d.id,"layer id changed"),U0(l.type===d.type,"layer type changed"),l.type==="custom"||d.type==="custom")return;const{layout:m={},paint:_={},filter:v,minzoom:c,maxzoom:C,beforeId:R}=l;if(R!==d.beforeId&&i.moveLayer(n,R),m!==d.layout){const N=d.layout||{};for(const B in m)xo(m[B],N[B])||i.setLayoutProperty(n,B,m[B]);for(const B in N)m.hasOwnProperty(B)||i.setLayoutProperty(n,B,void 0)}if(_!==d.paint){const N=d.paint||{};for(const B in _)xo(_[B],N[B])||i.setPaintProperty(n,B,_[B]);for(const B in N)_.hasOwnProperty(B)||i.setPaintProperty(n,B,void 0)}xo(v,d.filter)||i.setFilter(n,v),(c!==d.minzoom||C!==d.maxzoom)&&i.setLayerZoomRange(n,c,C)}function $E(i,n,l){if(i.style&&i.style._loaded&&(!("source"in l)||i.getSource(l.source))){const d={...l,id:n};delete d.beforeId,i.addLayer(d,l.beforeId)}}let YE=0;function m1(i){const n=ce.useContext(pg).map.getMap(),l=ce.useRef(i),[,d]=ce.useState(0),m=ce.useMemo(()=>i.id||`jsx-layer-${YE++}`,[]);if(ce.useEffect(()=>{if(n){const v=()=>d(c=>c+1);return n.on("styledata",v),v(),()=>{n.off("styledata",v),n.style&&n.style._loaded&&n.getLayer(m)&&n.removeLayer(m)}}},[n]),n&&n.style&&n.getLayer(m))try{ZE(n,m,i,l.current)}catch(v){console.warn(v)}else $E(n,m,i);return l.current=i,null}var z0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.1/LICENSE.txt
 */var qE=z0.exports,g1;function HE(){return g1||(g1=1,function(i,n){(function(l,d){i.exports=d()})(qE,function(){var l={},d={};function m(v,c,C){if(d[v]=C,v==="index"){var R="var sharedModule = {}; ("+d.shared+")(sharedModule); ("+d.worker+")(sharedModule);",N={};return d.shared(N),d.index(l,N),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),l}}m("shared",["exports"],function(v){function c(s,t,a,h){return new(a||(a=Promise))(function(g,T){function S(P){try{D(h.next(P))}catch(L){T(L)}}function A(P){try{D(h.throw(P))}catch(L){T(L)}}function D(P){var L;P.done?g(P.value):(L=P.value,L instanceof a?L:new a(function(F){F(L)})).then(S,A)}D((h=h.apply(s,t||[])).next())})}function C(s,t){this.x=s,this.y=t}function R(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var N,B;typeof SuppressedError=="function"&&SuppressedError,C.prototype={clone(){return new C(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,t){return this.clone()._rotateAround(s,t)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const t=s.x-this.x,a=s.y-this.y;return t*t+a*a},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,t){return Math.atan2(this.x*t-this.y*s,this.x*s+this.y*t)},_matMult(s){const t=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=t,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const t=Math.cos(s),a=Math.sin(s),h=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=h,this},_rotateAround(s,t){const a=Math.cos(s),h=Math.sin(s),g=t.y+h*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-h*(this.y-t.y),this.y=g,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:C},C.convert=function(s){if(s instanceof C)return s;if(Array.isArray(s))return new C(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new C(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};var V=function(){if(B)return N;function s(t,a,h,g){this.cx=3*t,this.bx=3*(h-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(g-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=h,this.p2y=g}return B=1,N=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var h=t,g=0;g<8;g++){var T=this.sampleCurveX(h)-t;if(Math.abs(T)<a)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=T/S}var A=0,D=1;for(h=t,g=0;g<20&&(T=this.sampleCurveX(h),!(Math.abs(T-t)<a));g++)t>T?A=h:D=h,h=.5*(D-A)+A;return h},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},N}(),G=R(V);let ae,me;function pe(){return ae==null&&(ae=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ae}function Ne(){if(me==null&&(me=!1,pe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let h=0;h<5*5;h++){const g=4*h;t.fillStyle=`rgb(${g},${g+1},${g+2})`,t.fillRect(h%5,Math.floor(h/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let h=0;h<5*5*4;h++)if(h%4!=3&&a[h]!==h){me=!0;break}}}return me||!1}var Ve=1e-6,Fe=typeof Float32Array<"u"?Float32Array:Array;function qe(){var s=new Fe(9);return Fe!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Ae(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ke(){var s=new Fe(3);return Fe!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function mt(s){var t=s[0],a=s[1],h=s[2];return Math.sqrt(t*t+a*a+h*h)}function st(s,t,a){var h=new Fe(3);return h[0]=s,h[1]=t,h[2]=a,h}function Pe(s,t,a){return s[0]=t[0]+a[0],s[1]=t[1]+a[1],s[2]=t[2]+a[2],s}function rt(s,t,a){return s[0]=t[0]*a,s[1]=t[1]*a,s[2]=t[2]*a,s}function Mt(s,t,a){var h=t[0],g=t[1],T=t[2],S=a[0],A=a[1],D=a[2];return s[0]=g*D-T*A,s[1]=T*S-h*D,s[2]=h*A-g*S,s}var Rt,jt=mt;function en(s,t,a){var h=t[0],g=t[1],T=t[2],S=t[3];return s[0]=a[0]*h+a[4]*g+a[8]*T+a[12]*S,s[1]=a[1]*h+a[5]*g+a[9]*T+a[13]*S,s[2]=a[2]*h+a[6]*g+a[10]*T+a[14]*S,s[3]=a[3]*h+a[7]*g+a[11]*T+a[15]*S,s}function ln(){var s=new Fe(4);return Fe!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ge(s,t,a,h){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",T=Math.PI/360;t*=T,h*=T,a*=T;var S=Math.sin(t),A=Math.cos(t),D=Math.sin(a),P=Math.cos(a),L=Math.sin(h),F=Math.cos(h);switch(g){case"xyz":s[0]=S*P*F+A*D*L,s[1]=A*D*F-S*P*L,s[2]=A*P*L+S*D*F,s[3]=A*P*F-S*D*L;break;case"xzy":s[0]=S*P*F-A*D*L,s[1]=A*D*F-S*P*L,s[2]=A*P*L+S*D*F,s[3]=A*P*F+S*D*L;break;case"yxz":s[0]=S*P*F+A*D*L,s[1]=A*D*F-S*P*L,s[2]=A*P*L-S*D*F,s[3]=A*P*F+S*D*L;break;case"yzx":s[0]=S*P*F+A*D*L,s[1]=A*D*F+S*P*L,s[2]=A*P*L-S*D*F,s[3]=A*P*F-S*D*L;break;case"zxy":s[0]=S*P*F-A*D*L,s[1]=A*D*F+S*P*L,s[2]=A*P*L+S*D*F,s[3]=A*P*F-S*D*L;break;case"zyx":s[0]=S*P*F-A*D*L,s[1]=A*D*F+S*P*L,s[2]=A*P*L-S*D*F,s[3]=A*P*F+S*D*L;break;default:throw new Error("Unknown angle order "+g)}return s}function ct(){var s=new Fe(2);return Fe!=Float32Array&&(s[0]=0,s[1]=0),s}function ht(s,t){var a=new Fe(2);return a[0]=s,a[1]=t,a}Ke(),Rt=new Fe(4),Fe!=Float32Array&&(Rt[0]=0,Rt[1]=0,Rt[2]=0,Rt[3]=0),Ke(),st(1,0,0),st(0,1,0),ln(),ln(),qe(),ct();const kt=8192;function Ee(s,t,a){return t*(kt/(s.tileSize*Math.pow(2,a-s.tileID.overscaledZ)))}function nt(s,t){return(s%t+t)%t}function Ct(s,t,a){return s*(1-a)+t*a}function bt(s){if(s<=0)return 0;if(s>=1)return 1;const t=s*s,a=t*s;return 4*(s<.5?a:3*(s-t)+a-.75)}function Pt(s,t,a,h){const g=new G(s,t,a,h);return T=>g.solve(T)}const Xt=Pt(.25,.1,.25,1);function Bt(s,t,a){return Math.min(a,Math.max(t,s))}function Ei(s,t,a){const h=a-t,g=((s-t)%h+h)%h+t;return g===t?a:g}function mn(s,...t){for(const a of t)for(const h in a)s[h]=a[h];return s}let mi=1;function Ea(s,t,a){const h={};for(const g in s)h[g]=t.call(this,s[g],g,s);return h}function ua(s,t,a){const h={};for(const g in s)t.call(this,s[g],g,s)&&(h[g]=s[g]);return h}function ur(s){return Array.isArray(s)?s.map(ur):typeof s=="object"&&s?Ea(s,ur):s}const Gn={};function Xn(s){Gn[s]||(typeof console<"u"&&console.warn(s),Gn[s]=!0)}function Rn(s,t,a){return(a.y-s.y)*(t.x-s.x)>(t.y-s.y)*(a.x-s.x)}function Yr(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let ji=null;function Qa(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const za="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ha(s,t,a,h,g){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(s,{timestamp:0});try{const S=T?.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const A=S.startsWith("BGR"),D=new Uint8ClampedArray(h*g*4);if(yield T.copyTo(D,function(P,L,F,$,H){const X=4*Math.max(-L,0),J=(Math.max(0,F)-F)*$*4+X,se=4*$,he=Math.max(0,L),De=Math.max(0,F);return{rect:{x:he,y:De,width:Math.min(P.width,L+$)-he,height:Math.min(P.height,F+H)-De},layout:[{offset:J,stride:se}]}}(s,t,a,h,g)),A)for(let P=0;P<D.length;P+=4){const L=D[P];D[P]=D[P+2],D[P+2]=L}return D}finally{T.close()}})}let qr,xs;function Ka(s,t,a,h){return s.addEventListener(t,a,h),{unsubscribe:()=>{s.removeEventListener(t,a,h)}}}function ws(s){return s*Math.PI/180}function Ts(s){return s/Math.PI*180}const da={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Bi={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Hr="AbortError";function Me(){return new Error(Hr)}const K={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ee(s){return K.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const re="global-dispatcher";class ye extends Error{constructor(t,a,h,g){super(`AJAXError: ${a} (${t}): ${h}`),this.status=t,this.statusText=a,this.url=h,this.body=g}}const Te=()=>Yr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ce=function(s,t){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const h=ee(s.url);if(h)return h(s,t);if(Yr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:re},t)}if(!(/^file:/.test(a=s.url)||/^file:/.test(Te())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(h,g){return c(this,void 0,void 0,function*(){const T=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:Te(),signal:g.signal});let S,A;h.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{S=yield fetch(T)}catch(P){throw new ye(0,P.message,h.url,new Blob)}if(!S.ok){const P=yield S.blob();throw new ye(S.status,S.statusText,h.url,P)}A=h.type==="arrayBuffer"||h.type==="image"?S.arrayBuffer():h.type==="json"?S.json():S.text();const D=yield A;if(g.signal.aborted)throw Me();return{data:D,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(s,t);if(Yr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:re},t)}var a;return function(h,g){return new Promise((T,S)=>{var A;const D=new XMLHttpRequest;D.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(D.responseType="arraybuffer");for(const P in h.headers)D.setRequestHeader(P,h.headers[P]);h.type==="json"&&(D.responseType="text",!((A=h.headers)===null||A===void 0)&&A.Accept||D.setRequestHeader("Accept","application/json")),D.withCredentials=h.credentials==="include",D.onerror=()=>{S(new Error(D.statusText))},D.onload=()=>{if(!g.signal.aborted)if((D.status>=200&&D.status<300||D.status===0)&&D.response!==null){let P=D.response;if(h.type==="json")try{P=JSON.parse(D.response)}catch(L){return void S(L)}T({data:P,cacheControl:D.getResponseHeader("Cache-Control"),expires:D.getResponseHeader("Expires")})}else{const P=new Blob([D.response],{type:D.getResponseHeader("Content-Type")});S(new ye(D.status,D.statusText,h.url,P))}},g.signal.addEventListener("abort",()=>{D.abort(),S(Me())}),D.send(h.body)})}(s,t)};function Ue(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const t=new URL(s),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function Ie(s,t,a){a[s]&&a[s].indexOf(t)!==-1||(a[s]=a[s]||[],a[s].push(t))}function Je(s,t,a){if(a&&a[s]){const h=a[s].indexOf(t);h!==-1&&a[s].splice(h,1)}}class ft{constructor(t,a={}){mn(this,a),this.type=t}}class it extends ft{constructor(t,a={}){super("error",mn({error:t},a))}}class Lt{on(t,a){return this._listeners=this._listeners||{},Ie(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return Je(t,a,this._listeners),Je(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ie(t,a,this._oneTimeListeners),this):new Promise(h=>this.once(t,h))}fire(t,a){typeof t=="string"&&(t=new ft(t,a||{}));const h=t.type;if(this.listens(h)){t.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const A of g)A.call(this,t);const T=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const A of T)Je(h,A,this._oneTimeListeners),A.call(this,t);const S=this._eventedParent;S&&(mn(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(t))}else t instanceof it&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Re={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const tn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bn(s,t){const a={};for(const h in s)h!=="ref"&&(a[h]=s[h]);return tn.forEach(h=>{h in t&&(a[h]=t[h])}),a}function Vt(s,t){if(Array.isArray(s)){if(!Array.isArray(t)||s.length!==t.length)return!1;for(let a=0;a<s.length;a++)if(!Vt(s[a],t[a]))return!1;return!0}if(typeof s=="object"&&s!==null&&t!==null){if(typeof t!="object"||Object.keys(s).length!==Object.keys(t).length)return!1;for(const a in s)if(!Vt(s[a],t[a]))return!1;return!0}return s===t}function on(s,t){s.push(t)}function ii(s,t,a){on(a,{command:"addSource",args:[s,t[s]]})}function hr(s,t,a){on(t,{command:"removeSource",args:[s]}),a[s]=!0}function yr(s,t,a,h){hr(s,a,h),ii(s,t,a)}function li(s,t,a){let h;for(h in s[a])if(Object.prototype.hasOwnProperty.call(s[a],h)&&h!=="data"&&!Vt(s[a][h],t[a][h]))return!1;for(h in t[a])if(Object.prototype.hasOwnProperty.call(t[a],h)&&h!=="data"&&!Vt(s[a][h],t[a][h]))return!1;return!0}function Wt(s,t,a,h,g,T){s=s||{},t=t||{};for(const S in s)Object.prototype.hasOwnProperty.call(s,S)&&(Vt(s[S],t[S])||a.push({command:T,args:[h,S,t[S],g]}));for(const S in t)Object.prototype.hasOwnProperty.call(t,S)&&!Object.prototype.hasOwnProperty.call(s,S)&&(Vt(s[S],t[S])||a.push({command:T,args:[h,S,t[S],g]}))}function nn(s){return s.id}function Ai(s,t){return s[t.id]=t,s}class gt{constructor(t,a,h,g){this.message=(t?`${t}: `:"")+h,g&&(this.identifier=g),a!=null&&a.__line__&&(this.line=a.__line__)}}function Xr(s,...t){for(const a of t)for(const h in a)s[h]=a[h];return s}class Fi extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class ko{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[h,g]of a)this.bindings[h]=g}concat(t){return new ko(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ro={kind:"null"},Et={kind:"number"},hn={kind:"string"},an={kind:"boolean"},rr={kind:"color"},Ja={kind:"projectionDefinition"},Mi={kind:"object"},dn={kind:"value"},$u={kind:"collator"},Aa={kind:"formatted"},Io={kind:"padding"},ao={kind:"colorArray"},Ql={kind:"numberArray"},Ui={kind:"resolvedImage"},pd={kind:"variableAnchorOffsetCollection"};function Rr(s,t){return{kind:"array",itemType:s,N:t}}function Zn(s){if(s.kind==="array"){const t=Zn(s.itemType);return typeof s.N=="number"?`array<${t}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${t}>`}return s.kind}const so=[ro,Et,hn,an,rr,Ja,Aa,Mi,Rr(dn),Io,Ql,ao,Ui,pd];function Kl(s,t){if(t.kind==="error")return null;if(s.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Kl(s.itemType,t.itemType))&&(typeof s.N!="number"||s.N===t.N))return null}else{if(s.kind===t.kind)return null;if(s.kind==="value"){for(const a of so)if(!Kl(a,t))return null}}return`Expected ${Zn(s)} but found ${Zn(t)} instead.`}function md(s,t){return t.some(a=>a.kind===s.kind)}function Na(s,t){return t.some(a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s)}function oo(s,t){return s.kind==="array"&&t.kind==="array"?s.itemType.kind===t.itemType.kind&&typeof s.N=="number":s.kind===t.kind}const Yu=.96422,Gp=.82521,wf=4/29,Pr=6/29,Tf=3*Pr*Pr,Eg=Pr*Pr*Pr,gd=Math.PI/180,Zp=180/Math.PI;function Vc(s){return(s%=360)<0&&(s+=360),s}function Gc([s,t,a,h]){let g,T;const S=qu((.2225045*(s=Ma(s))+.7168786*(t=Ma(t))+.0606169*(a=Ma(a)))/1);s===t&&t===a?g=T=S:(g=qu((.4360747*s+.3850649*t+.1430804*a)/Yu),T=qu((.0139322*s+.0971045*t+.7141733*a)/Gp));const A=116*S-16;return[A<0?0:A,500*(g-S),200*(S-T),h]}function Ma(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function qu(s){return s>Eg?Math.pow(s,1/3):s/Tf+wf}function Jl([s,t,a,h]){let g=(s+16)/116,T=isNaN(t)?g:g+t/500,S=isNaN(a)?g:g-a/200;return g=1*cl(g),T=Yu*cl(T),S=Gp*cl(S),[Hu(3.1338561*T-1.6168667*g-.4906146*S),Hu(-.9787684*T+1.9161415*g+.033454*S),Hu(.0719453*T-.2289914*g+1.4052427*S),h]}function Hu(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function cl(s){return s>Pr?s*s*s:Tf*(s-wf)}const $p=Object.hasOwn||function(s,t){return Object.prototype.hasOwnProperty.call(s,t)};function ec(s,t){return $p(s,t)?s[t]:void 0}function lo(s){return parseInt(s.padEnd(2,s),16)/255}function Ss(s,t){return xn(t?s/100:s,0,1)}function xn(s,t,a){return Math.min(Math.max(t,s),a)}function ul(s){return!s.some(Number.isNaN)}const co={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ro(s,t,a){return s+a*(t-s)}function tc(s,t,a){return s.map((h,g)=>Ro(h,t[g],a))}class yn{constructor(t,a,h,g=1,T=!0){this.r=t,this.g=a,this.b=h,this.a=g,T||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[t,a,h,g]))}static parse(t){if(t instanceof yn)return t;if(typeof t!="string")return;const a=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=ec(co,h);if(g){const[S,A,D]=g;return[S/255,A/255,D/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const S=h.length<6?1:2;let A=1;return[lo(h.slice(A,A+=S)),lo(h.slice(A,A+=S)),lo(h.slice(A,A+=S)),lo(h.slice(A,A+S)||"ff")]}if(h.startsWith("rgb")){const S=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[A,D,P,L,F,$,H,X,J,se,he,De]=S,ve=[L||" ",H||" ",se].join("");if(ve==="  "||ve==="  /"||ve===",,"||ve===",,,"){const we=[P,$,J].join(""),Be=we==="%%%"?100:we===""?255:0;if(Be){const We=[xn(+D/Be,0,1),xn(+F/Be,0,1),xn(+X/Be,0,1),he?Ss(+he,De):1];if(ul(We))return We}}return}}const T=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[S,A,D,P,L,F,$,H,X]=T,J=[D||" ",L||" ",$].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const se=[+A,xn(+P,0,100),xn(+F,0,100),H?Ss(+H,X):1];if(ul(se))return function([he,De,ve,we]){function Be(We){const lt=(We+he/30)%12,Tt=De*Math.min(ve,1-ve);return ve-Tt*Math.max(-1,Math.min(lt-3,9-lt,1))}return he=Vc(he),De/=100,ve/=100,[Be(0),Be(8),Be(4),we]}(se)}}}(t);return a?new yn(...a,!1):void 0}get rgb(){const{r:t,g:a,b:h,a:g}=this,T=g||1/0;return this.overwriteGetter("rgb",[t/T,a/T,h/T,g])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,h,g,T]=Gc(t),S=Math.sqrt(h*h+g*g);return[Math.round(1e4*S)?Vc(Math.atan2(g,h)*Zp):NaN,S,a,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Gc(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,h,g]=this.rgb;return`rgba(${[t,a,h].map(T=>Math.round(255*T)).join(",")},${g})`}static interpolate(t,a,h,g="rgb"){switch(g){case"rgb":{const[T,S,A,D]=tc(t.rgb,a.rgb,h);return new yn(T,S,A,D,!1)}case"hcl":{const[T,S,A,D]=t.hcl,[P,L,F,$]=a.hcl;let H,X;if(isNaN(T)||isNaN(P))isNaN(T)?isNaN(P)?H=NaN:(H=P,A!==1&&A!==0||(X=L)):(H=T,F!==1&&F!==0||(X=S));else{let ve=P-T;P>T&&ve>180?ve-=360:P<T&&T-P>180&&(ve+=360),H=T+h*ve}const[J,se,he,De]=function([ve,we,Be,We]){return ve=isNaN(ve)?0:ve*gd,Jl([Be,Math.cos(ve)*we,Math.sin(ve)*we,We])}([H,X??Ro(S,L,h),Ro(A,F,h),Ro(D,$,h)]);return new yn(J,se,he,De,!1)}case"lab":{const[T,S,A,D]=Jl(tc(t.lab,a.lab,h));return new yn(T,S,A,D,!1)}}}}yn.black=new yn(0,0,0,1),yn.white=new yn(1,1,1,1),yn.transparent=new yn(0,0,0,0),yn.red=new yn(1,0,0,1);class Po{constructor(t,a,h){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Zc=["bottom","center","top"];class zo{constructor(t,a,h,g,T,S){this.text=t,this.image=a,this.scale=h,this.fontStack=g,this.textColor=T,this.verticalAlign=S}}class dr{constructor(t){this.sections=t}static fromString(t){return new dr([new zo(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof dr?t:dr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class _r{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof _r)return t;if(typeof t=="number")return new _r([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new _r(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h){return new _r(tc(t.values,a.values,h))}}class zr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof zr)return t;if(typeof t=="number")return new zr([t]);if(Array.isArray(t)){for(const a of t)if(typeof a!="number")return;return new zr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h){return new zr(tc(t.values,a.values,h))}}class ar{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ar)return t;if(typeof t=="string"){const h=yn.parse(t);return h?new ar([h]):void 0}if(!Array.isArray(t))return;const a=[];for(const h of t){if(typeof h!="string")return;const g=yn.parse(h);if(!g)return;a.push(g)}return new ar(a)}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h,g="rgb"){const T=[];if(t.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let S=0;S<t.values.length;S++)T.push(yn.interpolate(t.values[S],a.values[S],h,g));return new ar(T)}}class Fn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const uo=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Nr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Nr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const h=t[a],g=t[a+1];if(typeof h!="string"||!uo.has(h)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new Nr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,h){const g=t.values,T=a.values;if(g.length!==T.length)throw new Fn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const S=[];for(let A=0;A<g.length;A+=2){if(g[A]!==T[A])throw new Fn(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${g[A]}, to[${A}]: ${T[A]}`);S.push(g[A]);const[D,P]=g[A+1],[L,F]=T[A+1];S.push([Ro(D,L,h),Ro(P,F,h)])}return new Nr(S)}}class Lr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Lr({name:t,available:!1}):null}}class Vi{constructor(t,a,h){this.from=t,this.to=a,this.transition=h}static interpolate(t,a,h){return new Vi(t,a,h)}static parse(t){return t instanceof Vi?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Vi(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Vi(t.from,t.to,t.transition):typeof t=="string"?new Vi(t,t,1):void 0}}function ci(s,t,a,h){return typeof s=="number"&&s>=0&&s<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[s,t,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[s,t,a,h]:[s,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ho(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Vi||s instanceof yn||s instanceof Po||s instanceof dr||s instanceof _r||s instanceof zr||s instanceof ar||s instanceof Nr||s instanceof Lr)return!0;if(Array.isArray(s)){for(const t of s)if(!ho(t))return!1;return!0}if(typeof s=="object"){for(const t in s)if(!ho(s[t]))return!1;return!0}return!1}function Ht(s){if(s===null)return ro;if(typeof s=="string")return hn;if(typeof s=="boolean")return an;if(typeof s=="number")return Et;if(s instanceof yn)return rr;if(s instanceof Vi)return Ja;if(s instanceof Po)return $u;if(s instanceof dr)return Aa;if(s instanceof _r)return Io;if(s instanceof zr)return Ql;if(s instanceof ar)return ao;if(s instanceof Nr)return pd;if(s instanceof Lr)return Ui;if(Array.isArray(s)){const t=s.length;let a;for(const h of s){const g=Ht(h);if(a){if(a===g)continue;a=dn;break}a=g}return Rr(a||dn,t)}return Mi}function rn(s){const t=typeof s;return s===null?"":t==="string"||t==="number"||t==="boolean"?String(s):s instanceof yn||s instanceof Vi||s instanceof dr||s instanceof _r||s instanceof zr||s instanceof ar||s instanceof Nr||s instanceof Lr?s.toString():JSON.stringify(s)}class es{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ho(t[1]))return a.error("invalid value");const h=t[1];let g=Ht(h);const T=a.expectedType;return g.kind!=="array"||g.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(g=T),new es(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Mn={string:hn,number:Et,boolean:an,object:Mi};class gi{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let h,g=1;const T=t[0];if(T==="array"){let A,D;if(t.length>2){const P=t[1];if(typeof P!="string"||!(P in Mn)||P==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);A=Mn[P],g++}else A=dn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);D=t[2],g++}h=Rr(A,D)}else{if(!Mn[T])throw new Error(`Types doesn't contain name = ${T}`);h=Mn[T]}const S=[];for(;g<t.length;g++){const A=a.parse(t[g],g,dn);if(!A)return null;S.push(A)}return new gi(h,S)}evaluate(t){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(t);if(!Kl(this.type,Ht(h)))return h;if(a===this.args.length-1)throw new Fn(`Expected value to be of type ${Zn(this.type)}, but found ${Zn(Ht(h))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Wr={"to-boolean":an,"to-color":rr,"to-number":Et,"to-string":hn};class La{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[0];if(!Wr[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&t.length!==2)return a.error("Expected one argument.");const g=Wr[h],T=[];for(let S=1;S<t.length;S++){const A=a.parse(t[S],S,dn);if(!A)return null;T.push(A)}return new La(g,T)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,h;for(const g of this.args){if(a=g.evaluate(t),h=null,a instanceof yn)return a;if(typeof a=="string"){const T=t.parseColor(a);if(T)return T}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:ci(a[0],a[1],a[2],a[3]),!h))return new yn(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Fn(h||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const h of this.args){a=h.evaluate(t);const g=_r.parse(a);if(g)return g}throw new Fn(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const h of this.args){a=h.evaluate(t);const g=zr.parse(a);if(g)return g}throw new Fn(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const h of this.args){a=h.evaluate(t);const g=ar.parse(a);if(g)return g}throw new Fn(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const h of this.args){a=h.evaluate(t);const g=Nr.parse(a);if(g)return g}throw new Fn(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const h of this.args){if(a=h.evaluate(t),a===null)return 0;const g=Number(a);if(!isNaN(g))return g}throw new Fn(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return dr.fromString(rn(this.args[0].evaluate(t)));case"resolvedImage":return Lr.fromString(rn(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return rn(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const hl=["Unknown","Point","LineString","Polygon"];class Sf{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?hl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache.get(t);return a||(a=yn.parse(t),this._parseColorCache.set(t,a)),a}}class dl{constructor(t,a,h=[],g,T=new ko,S=[]){this.registry=t,this.path=h,this.key=h.map(A=>`[${A}]`).join(""),this.scope=T,this.errors=S,this.expectedType=g,this._isConstant=a}parse(t,a,h,g,T={}){return a?this.concat(a,h,g)._parse(t,T):this._parse(t,T)}_parse(t,a){function h(g,T,S){return S==="assert"?new gi(T,[g]):S==="coerce"?new La(T,[g]):g}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=t[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[g];if(T){let S=T.parse(t,this);if(!S)return null;if(this.expectedType){const A=this.expectedType,D=S.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||D.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(D.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(D.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(D.kind)||A.kind==="colorArray"&&["value","string","array"].includes(D.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(D.kind))S=h(S,A,a.typeAnnotation||"coerce");else if(this.checkSubtype(A,D))return null}else S=h(S,A,a.typeAnnotation||"assert")}if(!(S instanceof es)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const A=new Sf;try{S=new es(S.type,S.evaluate(A))}catch(D){return this.error(D.message),null}}return S}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,h){const g=typeof t=="number"?this.path.concat(t):this.path,T=h?this.scope.concat(h):this.scope;return new dl(this.registry,this._isConstant,g,a||null,T,this.errors)}error(t,...a){const h=`${this.key}${a.map(g=>`[${g}]`).join("")}`;this.errors.push(new Fi(h,t))}checkSubtype(t,a){const h=Kl(t,a);return h&&this.error(h),h}}class nc{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const h=[];for(let T=1;T<t.length-1;T+=2){const S=t[T];if(typeof S!="string")return a.error(`Expected string, but found ${typeof S} instead.`,T);if(/[^a-zA-Z0-9_]/.test(S))return a.error("Variable names must contain only alphanumeric characters or '_'.",T);const A=a.parse(t[T+1],T+1);if(!A)return null;h.push([S,A])}const g=a.parse(t[t.length-1],t.length-1,a.expectedType,h);return g?new nc(h,g):null}outputDefined(){return this.result.outputDefined()}}class fl{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=t[1];return a.scope.has(h)?new fl(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ic{constructor(t,a,h){this.type=t,this.index=a,this.input=h}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Et),g=a.parse(t[2],2,Rr(a.expectedType||dn));return h&&g?new ic(g.type.itemType,h,g):null}evaluate(t){const a=this.index.evaluate(t),h=this.input.evaluate(t);if(a<0)throw new Fn(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new Fn(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new Fn(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Xu{constructor(t,a){this.type=an,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,dn),g=a.parse(t[2],2,dn);return h&&g?md(h.type,[an,hn,Et,ro,dn])?new Xu(h,g):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(h.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!h)return!1;if(!Na(a,["boolean","string","number","null"]))throw new Fn(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(Ht(a))} instead.`);if(!Na(h,["string","array"]))throw new Fn(`Expected second argument to be of type array or string, but found ${Zn(Ht(h))} instead.`);return h.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Es{constructor(t,a,h){this.type=Et,this.needle=t,this.haystack=a,this.fromIndex=h}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,dn),g=a.parse(t[2],2,dn);if(!h||!g)return null;if(!md(h.type,[an,hn,Et,ro,dn]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(h.type)} instead`);if(t.length===4){const T=a.parse(t[3],3,Et);return T?new Es(h,g,T):null}return new Es(h,g)}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!Na(a,["boolean","string","number","null"]))throw new Fn(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(Ht(a))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(t)),Na(h,["string"])){const T=h.indexOf(a,g);return T===-1?-1:[...h.slice(0,T)].length}if(Na(h,["array"]))return h.indexOf(a,g);throw new Fn(`Expected second argument to be of type array or string, but found ${Zn(Ht(h))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Mr{constructor(t,a,h,g,T,S){this.inputType=t,this.type=a,this.input=h,this.cases=g,this.outputs=T,this.otherwise=S}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let h,g;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);const T={},S=[];for(let P=2;P<t.length-1;P+=2){let L=t[P];const F=t[P+1];Array.isArray(L)||(L=[L]);const $=a.concat(P);if(L.length===0)return $.error("Expected at least one branch label.");for(const X of L){if(typeof X!="number"&&typeof X!="string")return $.error("Branch labels must be numbers or strings.");if(typeof X=="number"&&Math.abs(X)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof X=="number"&&Math.floor(X)!==X)return $.error("Numeric branch labels must be integer values.");if(h){if($.checkSubtype(h,Ht(X)))return null}else h=Ht(X);if(T[String(X)]!==void 0)return $.error("Branch labels must be unique.");T[String(X)]=S.length}const H=a.parse(F,P,g);if(!H)return null;g=g||H.type,S.push(H)}const A=a.parse(t[1],1,dn);if(!A)return null;const D=a.parse(t[t.length-1],t.length-1,g);return D?A.type.kind!=="value"&&a.concat(1).checkSubtype(h,A.type)?null:new Mr(h,g,A,T,S,D):null}evaluate(t){const a=this.input.evaluate(t);return(Ht(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class $c{constructor(t,a,h){this.type=t,this.branches=a,this.otherwise=h}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const g=[];for(let S=1;S<t.length-1;S+=2){const A=a.parse(t[S],S,an);if(!A)return null;const D=a.parse(t[S+1],S+1,h);if(!D)return null;g.push([A,D]),h=h||D.type}const T=a.parse(t[t.length-1],t.length-1,h);if(!T)return null;if(!h)throw new Error("Can't infer output type");return new $c(h,g,T)}evaluate(t){for(const[a,h]of this.branches)if(a.evaluate(t))return h.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,h]of this.branches)t(a),t(h);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class rc{constructor(t,a,h,g){this.type=t,this.input=a,this.beginIndex=h,this.endIndex=g}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,dn),g=a.parse(t[2],2,Et);if(!h||!g)return null;if(!md(h.type,[Rr(dn),hn,dn]))return a.error(`Expected first argument to be of type array or string, but found ${Zn(h.type)} instead`);if(t.length===4){const T=a.parse(t[3],3,Et);return T?new rc(h.type,h,g,T):null}return new rc(h.type,h,g)}evaluate(t){const a=this.input.evaluate(t),h=this.beginIndex.evaluate(t);let g;if(this.endIndex&&(g=this.endIndex.evaluate(t)),Na(a,["string"]))return[...a].slice(h,g).join("");if(Na(a,["array"]))return a.slice(h,g);throw new Fn(`Expected first argument to be of type array or string, but found ${Zn(Ht(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ac(s,t){const a=s.length-1;let h,g,T=0,S=a,A=0;for(;T<=S;)if(A=Math.floor((T+S)/2),h=s[A],g=s[A+1],h<=t){if(A===a||t<g)return A;T=A+1}else{if(!(h>t))throw new Fn("Input is not a number.");S=A-1}return 0}class Yi{constructor(t,a,h){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[g,T]of h)this.labels.push(g),this.outputs.push(T)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(t[1],1,Et);if(!h)return null;const g=[];let T=null;a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType);for(let S=1;S<t.length;S+=2){const A=S===1?-1/0:t[S],D=t[S+1],P=S,L=S+1;if(typeof A!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(g.length&&g[g.length-1][0]>=A)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const F=a.parse(D,L,T);if(!F)return null;T=T||F.type,g.push([A,F])}return new Yi(T,h,g)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const g=this.input.evaluate(t);if(g<=a[0])return h[0].evaluate(t);const T=a.length;return g>=a[T-1]?h[T-1].evaluate(t):h[ac(a,g)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Yp(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Wu,Ef,qp=function(){if(Ef)return Wu;function s(t,a,h,g){this.cx=3*t,this.bx=3*(h-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(g-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=h,this.p2y=g}return Ef=1,Wu=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var h=t,g=0;g<8;g++){var T=this.sampleCurveX(h)-t;if(Math.abs(T)<a)return h;var S=this.sampleCurveDerivativeX(h);if(Math.abs(S)<1e-6)break;h-=T/S}var A=0,D=1;for(h=t,g=0;g<20&&(T=this.sampleCurveX(h),!(Math.abs(T-t)<a));g++)t>T?A=h:D=h,h=.5*(D-A)+A;return h},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},Wu}(),Yc=Yp(qp);class Or{constructor(t,a,h,g,T){this.type=t,this.operator=a,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[S,A]of T)this.labels.push(S),this.outputs.push(A)}static interpolationFactor(t,a,h,g){let T=0;if(t.name==="exponential")T=Qu(a,t.base,h,g);else if(t.name==="linear")T=Qu(a,1,h,g);else if(t.name==="cubic-bezier"){const S=t.controlPoints;T=new Yc(S[0],S[1],S[2],S[3]).solve(Qu(a,1,h,g))}return T}static parse(t,a){let[h,g,T,...S]=t;if(!Array.isArray(g)||g.length===0)return a.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const P=g[1];if(typeof P!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:P}}else{if(g[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const P=g.slice(1);if(P.length!==4||P.some(L=>typeof L!="number"||L<0||L>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:P}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(T=a.parse(T,2,Et),!T)return null;const A=[];let D=null;h!=="interpolate-hcl"&&h!=="interpolate-lab"||a.expectedType==ao?a.expectedType&&a.expectedType.kind!=="value"&&(D=a.expectedType):D=rr;for(let P=0;P<S.length;P+=2){const L=S[P],F=S[P+1],$=P+3,H=P+4;if(typeof L!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(A.length&&A[A.length-1][0]>=L)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const X=a.parse(F,H,D);if(!X)return null;D=D||X.type,A.push([L,X])}return oo(D,Et)||oo(D,Ja)||oo(D,rr)||oo(D,Io)||oo(D,Ql)||oo(D,ao)||oo(D,pd)||oo(D,Rr(Et))?new Or(D,h,g,T,A):a.error(`Type ${Zn(D)} is not interpolatable.`)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const g=this.input.evaluate(t);if(g<=a[0])return h[0].evaluate(t);const T=a.length;if(g>=a[T-1])return h[T-1].evaluate(t);const S=ac(a,g),A=Or.interpolationFactor(this.interpolation,g,a[S],a[S+1]),D=h[S].evaluate(t),P=h[S+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ro(D,P,A);case"color":return yn.interpolate(D,P,A);case"padding":return _r.interpolate(D,P,A);case"colorArray":return ar.interpolate(D,P,A);case"numberArray":return zr.interpolate(D,P,A);case"variableAnchorOffsetCollection":return Nr.interpolate(D,P,A);case"array":return tc(D,P,A);case"projectionDefinition":return Vi.interpolate(D,P,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return yn.interpolate(D,P,A,"hcl");case"colorArray":return ar.interpolate(D,P,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return yn.interpolate(D,P,A,"lab");case"colorArray":return ar.interpolate(D,P,A,"lab")}}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Qu(s,t,a,h){const g=h-a,T=s-a;return g===0?0:t===1?T/g:(Math.pow(t,T)-1)/(Math.pow(t,g)-1)}const fo={color:yn.interpolate,number:Ro,padding:_r.interpolate,numberArray:zr.interpolate,colorArray:ar.interpolate,variableAnchorOffsetCollection:Nr.interpolate,array:tc};class sc{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let h=null;const g=a.expectedType;g&&g.kind!=="value"&&(h=g);const T=[];for(const A of t.slice(1)){const D=a.parse(A,1+T.length,h,void 0,{typeAnnotation:"omit"});if(!D)return null;h=h||D.type,T.push(D)}if(!h)throw new Error("No output type");const S=g&&T.some(A=>Kl(g,A.type));return new sc(S?dn:h,T)}evaluate(t){let a,h=null,g=0;for(const T of this.args)if(g++,h=T.evaluate(t),h&&h instanceof Lr&&!h.available&&(a||(a=h.name),h=null,g===this.args.length&&(h=a)),h!==null)break;return h}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Ku(s,t){return s==="=="||s==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ju(s,t,a,h){return h.compare(t,a)===0}function Qr(s,t,a){const h=s!=="=="&&s!=="!=";return class t2{constructor(T,S,A){this.type=an,this.lhs=T,this.rhs=S,this.collator=A,this.hasUntypedArgument=T.type.kind==="value"||S.type.kind==="value"}static parse(T,S){if(T.length!==3&&T.length!==4)return S.error("Expected two or three arguments.");const A=T[0];let D=S.parse(T[1],1,dn);if(!D)return null;if(!Ku(A,D.type))return S.concat(1).error(`"${A}" comparisons are not supported for type '${Zn(D.type)}'.`);let P=S.parse(T[2],2,dn);if(!P)return null;if(!Ku(A,P.type))return S.concat(2).error(`"${A}" comparisons are not supported for type '${Zn(P.type)}'.`);if(D.type.kind!==P.type.kind&&D.type.kind!=="value"&&P.type.kind!=="value")return S.error(`Cannot compare types '${Zn(D.type)}' and '${Zn(P.type)}'.`);h&&(D.type.kind==="value"&&P.type.kind!=="value"?D=new gi(P.type,[D]):D.type.kind!=="value"&&P.type.kind==="value"&&(P=new gi(D.type,[P])));let L=null;if(T.length===4){if(D.type.kind!=="string"&&P.type.kind!=="string"&&D.type.kind!=="value"&&P.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(L=S.parse(T[3],3,$u),!L)return null}return new t2(D,P,L)}evaluate(T){const S=this.lhs.evaluate(T),A=this.rhs.evaluate(T);if(h&&this.hasUntypedArgument){const D=Ht(S),P=Ht(A);if(D.kind!==P.kind||D.kind!=="string"&&D.kind!=="number")throw new Fn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${D.kind}, ${P.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const D=Ht(S),P=Ht(A);if(D.kind!=="string"||P.kind!=="string")return t(T,S,A)}return this.collator?a(T,S,A,this.collator.evaluate(T)):t(T,S,A)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const Af=Qr("==",function(s,t,a){return t===a},Ju),yd=Qr("!=",function(s,t,a){return t!==a},function(s,t,a,h){return!Ju(0,t,a,h)}),Ag=Qr("<",function(s,t,a){return t<a},function(s,t,a,h){return h.compare(t,a)<0}),Mf=Qr(">",function(s,t,a){return t>a},function(s,t,a,h){return h.compare(t,a)>0}),Mg=Qr("<=",function(s,t,a){return t<=a},function(s,t,a,h){return h.compare(t,a)<=0}),Cg=Qr(">=",function(s,t,a){return t>=a},function(s,t,a,h){return h.compare(t,a)>=0});class _d{constructor(t,a,h){this.type=$u,this.locale=h,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const h=t[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const g=a.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,an);if(!g)return null;const T=a.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,an);if(!T)return null;let S=null;return h.locale&&(S=a.parse(h.locale,1,hn),!S)?null:new _d(g,T,S)}evaluate(t){return new Po(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Cf{constructor(t,a,h,g,T){this.type=hn,this.number=t,this.locale=a,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=T}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const h=a.parse(t[1],1,Et);if(!h)return null;const g=t[2];if(typeof g!="object"||Array.isArray(g))return a.error("NumberFormat options argument must be an object.");let T=null;if(g.locale&&(T=a.parse(g.locale,1,hn),!T))return null;let S=null;if(g.currency&&(S=a.parse(g.currency,1,hn),!S))return null;let A=null;if(g["min-fraction-digits"]&&(A=a.parse(g["min-fraction-digits"],1,Et),!A))return null;let D=null;return g["max-fraction-digits"]&&(D=a.parse(g["max-fraction-digits"],1,Et),!D)?null:new Cf(h,T,S,A,D)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class oc{constructor(t){this.type=Aa,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const g=[];let T=!1;for(let S=1;S<=t.length-1;++S){const A=t[S];if(T&&typeof A=="object"&&!Array.isArray(A)){T=!1;let D=null;if(A["font-scale"]&&(D=a.parse(A["font-scale"],1,Et),!D))return null;let P=null;if(A["text-font"]&&(P=a.parse(A["text-font"],1,Rr(hn)),!P))return null;let L=null;if(A["text-color"]&&(L=a.parse(A["text-color"],1,rr),!L))return null;let F=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!Zc.includes(A["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(F=a.parse(A["vertical-align"],1,hn),!F)return null}const $=g[g.length-1];$.scale=D,$.font=P,$.textColor=L,$.verticalAlign=F}else{const D=a.parse(t[S],1,dn);if(!D)return null;const P=D.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,g.push({content:D,scale:null,font:null,textColor:null,verticalAlign:null})}}return new oc(g)}evaluate(t){return new dr(this.sections.map(a=>{const h=a.content.evaluate(t);return Ht(h)===Ui?new zo("",h,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new zo(rn(h),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class Df{constructor(t){this.type=Ui,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const h=a.parse(t[1],1,hn);return h?new Df(h):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),h=Lr.fromString(a);return h&&t.availableImages&&(h.available=t.availableImages.indexOf(a)>-1),h}eachChild(t){t(this.input)}outputDefined(){return!1}}class qc{constructor(t){this.type=Et,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=a.parse(t[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${Zn(h.type)} instead.`):new qc(h):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Fn(`Expected value to be of type string or array, but found ${Zn(Ht(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const fa=8192;function Dg(s,t){const a=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,g=Math.pow(2,t.z);return[Math.round(a*g*fa),Math.round(h*g*fa)]}function eh(s,t){const a=Math.pow(2,t.z);return[(g=(s[0]/fa+t.x)/a,360*g-180),(h=(s[1]/fa+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,g}function Hc(s,t){s[0]=Math.min(s[0],t[0]),s[1]=Math.min(s[1],t[1]),s[2]=Math.max(s[2],t[0]),s[3]=Math.max(s[3],t[1])}function Xc(s,t){return!(s[0]<=t[0]||s[2]>=t[2]||s[1]<=t[1]||s[3]>=t[3])}function Hp(s,t,a){const h=s[0]-t[0],g=s[1]-t[1],T=s[0]-a[0],S=s[1]-a[1];return h*S-T*g==0&&h*T<=0&&g*S<=0}function th(s,t,a,h){return(g=[h[0]-a[0],h[1]-a[1]])[0]*(T=[t[0]-s[0],t[1]-s[1]])[1]-g[1]*T[0]!=0&&!(!If(s,t,a,h)||!If(a,h,s,t));var g,T}function Wc(s,t,a){for(const h of a)for(let g=0;g<h.length-1;++g)if(th(s,t,h[g],h[g+1]))return!0;return!1}function lc(s,t,a=!1){let h=!1;for(const A of t)for(let D=0;D<A.length-1;D++){if(Hp(s,A[D],A[D+1]))return a;(T=A[D])[1]>(g=s)[1]!=(S=A[D+1])[1]>g[1]&&g[0]<(S[0]-T[0])*(g[1]-T[1])/(S[1]-T[1])+T[0]&&(h=!h)}var g,T,S;return h}function Xp(s,t){for(const a of t)if(lc(s,a))return!0;return!1}function kf(s,t){for(const a of s)if(!lc(a,t))return!1;for(let a=0;a<s.length-1;++a)if(Wc(s[a],s[a+1],t))return!1;return!0}function Wp(s,t){for(const a of t)if(kf(s,a))return!0;return!1}function If(s,t,a,h){const g=h[0]-a[0],T=h[1]-a[1],S=(s[0]-a[0])*T-g*(s[1]-a[1]),A=(t[0]-a[0])*T-g*(t[1]-a[1]);return S>0&&A<0||S<0&&A>0}function cc(s,t,a){const h=[];for(let g=0;g<s.length;g++){const T=[];for(let S=0;S<s[g].length;S++){const A=Dg(s[g][S],a);Hc(t,A),T.push(A)}h.push(T)}return h}function Qc(s,t,a){const h=[];for(let g=0;g<s.length;g++){const T=cc(s[g],t,a);h.push(T)}return h}function vd(s,t,a,h){if(s[0]<a[0]||s[0]>a[2]){const g=.5*h;let T=s[0]-a[0]>g?-h:a[0]-s[0]>g?h:0;T===0&&(T=s[0]-a[2]>g?-h:a[2]-s[0]>g?h:0),s[0]+=T}Hc(t,s)}function nh(s,t,a,h){const g=Math.pow(2,h.z)*fa,T=[h.x*fa,h.y*fa],S=[];for(const A of s)for(const D of A){const P=[D.x+T[0],D.y+T[1]];vd(P,t,a,g),S.push(P)}return S}function Rf(s,t,a,h){const g=Math.pow(2,h.z)*fa,T=[h.x*fa,h.y*fa],S=[];for(const D of s){const P=[];for(const L of D){const F=[L.x+T[0],L.y+T[1]];Hc(t,F),P.push(F)}S.push(P)}if(t[2]-t[0]<=g/2){(A=t)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const D of S)for(const P of D)vd(P,t,a,g)}var A;return S}class pl{constructor(t,a){this.type=an,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ho(t[1])){const h=t[1];if(h.type==="FeatureCollection"){const g=[];for(const T of h.features){const{type:S,coordinates:A}=T.geometry;S==="Polygon"&&g.push(A),S==="MultiPolygon"&&g.push(...A)}if(g.length)return new pl(h,{type:"MultiPolygon",coordinates:g})}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new pl(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new pl(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,h){const g=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(h.type==="Polygon"){const A=cc(h.coordinates,T,S),D=nh(a.geometry(),g,T,S);if(!Xc(g,T))return!1;for(const P of D)if(!lc(P,A))return!1}if(h.type==="MultiPolygon"){const A=Qc(h.coordinates,T,S),D=nh(a.geometry(),g,T,S);if(!Xc(g,T))return!1;for(const P of D)if(!Xp(P,A))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,h){const g=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(h.type==="Polygon"){const A=cc(h.coordinates,T,S),D=Rf(a.geometry(),g,T,S);if(!Xc(g,T))return!1;for(const P of D)if(!kf(P,A))return!1}if(h.type==="MultiPolygon"){const A=Qc(h.coordinates,T,S),D=Rf(a.geometry(),g,T,S);if(!Xc(g,T))return!1;for(const P of D)if(!Wp(P,A))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let ih=class{constructor(s=[],t=(a,h)=>a<h?-1:a>h?1:0){if(this.data=s,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:t,compare:a}=this,h=t[s];for(;s>0;){const g=s-1>>1,T=t[g];if(a(h,T)>=0)break;t[s]=T,s=g}t[s]=h}_down(s){const{data:t,compare:a}=this,h=this.length>>1,g=t[s];for(;s<h;){let T=1+(s<<1);const S=T+1;if(S<this.length&&a(t[S],t[T])<0&&(T=S),a(t[T],g)>=0)break;t[s]=t[T],s=T}t[s]=g}};function rh(s,t,a=0,h=s.length-1,g=Qp){for(;h>a;){if(h-a>600){const D=h-a+1,P=t-a+1,L=Math.log(D),F=.5*Math.exp(2*L/3),$=.5*Math.sqrt(L*F*(D-F)/D)*(P-D/2<0?-1:1);rh(s,t,Math.max(a,Math.floor(t-P*F/D+$)),Math.min(h,Math.floor(t+(D-P)*F/D+$)),g)}const T=s[t];let S=a,A=h;for(Kc(s,a,t),g(s[h],T)>0&&Kc(s,a,h);S<A;){for(Kc(s,S,A),S++,A--;g(s[S],T)<0;)S++;for(;g(s[A],T)>0;)A--}g(s[a],T)===0?Kc(s,a,A):(A++,Kc(s,A,h)),A<=t&&(a=A+1),t<=A&&(h=A-1)}}function Kc(s,t,a){const h=s[t];s[t]=s[a],s[a]=h}function Qp(s,t){return s<t?-1:s>t?1:0}function Jc(s,t){if(s.length<=1)return[s];const a=[];let h,g;for(const T of s){const S=kg(T);S!==0&&(T.area=Math.abs(S),g===void 0&&(g=S<0),g===S<0?(h&&a.push(h),h=[T]):h.push(T))}if(h&&a.push(h),t>1)for(let T=0;T<a.length;T++)a[T].length<=t||(rh(a[T],t,1,a[T].length-1,Kp),a[T]=a[T].slice(0,t));return a}function Kp(s,t){return t.area-s.area}function kg(s){let t=0;for(let a,h,g=0,T=s.length,S=T-1;g<T;S=g++)a=s[g],h=s[S],t+=(h.x-a.x)*(a.y+h.y);return t}const Jp=1/298.257223563,em=Jp*(2-Jp),Pf=Math.PI/180;class pa{constructor(t){const a=6378.137*Pf*1e3,h=Math.cos(t*Pf),g=1/(1-em*(1-h*h)),T=Math.sqrt(g);this.kx=a*T*h,this.ky=a*T*g*(1-em)}distance(t,a){const h=this.wrap(t[0]-a[0])*this.kx,g=(t[1]-a[1])*this.ky;return Math.sqrt(h*h+g*g)}pointOnLine(t,a){let h,g,T,S,A=1/0;for(let D=0;D<t.length-1;D++){let P=t[D][0],L=t[D][1],F=this.wrap(t[D+1][0]-P)*this.kx,$=(t[D+1][1]-L)*this.ky,H=0;F===0&&$===0||(H=(this.wrap(a[0]-P)*this.kx*F+(a[1]-L)*this.ky*$)/(F*F+$*$),H>1?(P=t[D+1][0],L=t[D+1][1]):H>0&&(P+=F/this.kx*H,L+=$/this.ky*H)),F=this.wrap(a[0]-P)*this.kx,$=(a[1]-L)*this.ky;const X=F*F+$*$;X<A&&(A=X,h=P,g=L,T=D,S=H)}return{point:[h,g],index:T,t:Math.max(0,Math.min(1,S))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function eu(s,t){return t[0]-s[0]}function ah(s){return s[1]-s[0]+1}function po(s,t){return s[1]>=s[0]&&s[1]<t}function Pn(s,t){if(s[0]>s[1])return[null,null];const a=ah(s);if(t){if(a===2)return[s,null];const g=Math.floor(a/2);return[[s[0],s[0]+g],[s[0]+g,s[1]]]}if(a===1)return[s,null];const h=Math.floor(a/2)-1;return[[s[0],s[0]+h],[s[0]+h+1,s[1]]]}function bd(s,t){if(!po(t,s.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let h=t[0];h<=t[1];++h)Hc(a,s[h]);return a}function sh(s){const t=[1/0,1/0,-1/0,-1/0];for(const a of s)for(const h of a)Hc(t,h);return t}function tm(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function ml(s,t,a){if(!tm(s)||!tm(t))return NaN;let h=0,g=0;return s[2]<t[0]&&(h=t[0]-s[2]),s[0]>t[2]&&(h=s[0]-t[2]),s[1]>t[3]&&(g=s[1]-t[3]),s[3]<t[1]&&(g=t[1]-s[3]),a.distance([0,0],[h,g])}function No(s,t,a){const h=a.pointOnLine(t,s);return a.distance(s,h.point)}function uc(s,t,a,h,g){const T=Math.min(No(s,[a,h],g),No(t,[a,h],g)),S=Math.min(No(a,[s,t],g),No(h,[s,t],g));return Math.min(T,S)}function zf(s,t,a,h,g){if(!po(t,s.length)||!po(h,a.length))return 1/0;let T=1/0;for(let S=t[0];S<t[1];++S){const A=s[S],D=s[S+1];for(let P=h[0];P<h[1];++P){const L=a[P],F=a[P+1];if(th(A,D,L,F))return 0;T=Math.min(T,uc(A,D,L,F,g))}}return T}function nm(s,t,a,h,g){if(!po(t,s.length)||!po(h,a.length))return NaN;let T=1/0;for(let S=t[0];S<=t[1];++S)for(let A=h[0];A<=h[1];++A)if(T=Math.min(T,g.distance(s[S],a[A])),T===0)return T;return T}function hc(s,t,a){if(lc(s,t,!0))return 0;let h=1/0;for(const g of t){const T=g[0],S=g[g.length-1];if(T!==S&&(h=Math.min(h,No(s,[S,T],a)),h===0))return h;const A=a.pointOnLine(g,s);if(h=Math.min(h,a.distance(s,A.point)),h===0)return h}return h}function tu(s,t,a,h){if(!po(t,s.length))return NaN;for(let T=t[0];T<=t[1];++T)if(lc(s[T],a,!0))return 0;let g=1/0;for(let T=t[0];T<t[1];++T){const S=s[T],A=s[T+1];for(const D of a)for(let P=0,L=D.length,F=L-1;P<L;F=P++){const $=D[F],H=D[P];if(th(S,A,$,H))return 0;g=Math.min(g,uc(S,A,$,H,h))}}return g}function xd(s,t){for(const a of s)for(const h of a)if(lc(h,t,!0))return!0;return!1}function im(s,t,a,h=1/0){const g=sh(s),T=sh(t);if(h!==1/0&&ml(g,T,a)>=h)return h;if(Xc(g,T)){if(xd(s,t))return 0}else if(xd(t,s))return 0;let S=1/0;for(const A of s)for(let D=0,P=A.length,L=P-1;D<P;L=D++){const F=A[L],$=A[D];for(const H of t)for(let X=0,J=H.length,se=J-1;X<J;se=X++){const he=H[se],De=H[X];if(th(F,$,he,De))return 0;S=Math.min(S,uc(F,$,he,De,a))}}return S}function gl(s,t,a,h,g,T){if(!T)return;const S=ml(bd(h,T),g,a);S<t&&s.push([S,T,[0,0]])}function oh(s,t,a,h,g,T,S){if(!T||!S)return;const A=ml(bd(h,T),bd(g,S),a);A<t&&s.push([A,T,S])}function lh(s,t,a,h,g=1/0){let T=Math.min(h.distance(s[0],a[0][0]),g);if(T===0)return T;const S=new ih([[0,[0,s.length-1],[0,0]]],eu),A=sh(a);for(;S.length>0;){const D=S.pop();if(D[0]>=T)continue;const P=D[1],L=t?50:100;if(ah(P)<=L){if(!po(P,s.length))return NaN;if(t){const F=tu(s,P,a,h);if(isNaN(F)||F===0)return F;T=Math.min(T,F)}else for(let F=P[0];F<=P[1];++F){const $=hc(s[F],a,h);if(T=Math.min(T,$),T===0)return 0}}else{const F=Pn(P,t);gl(S,T,h,s,A,F[0]),gl(S,T,h,s,A,F[1])}}return T}function ch(s,t,a,h,g,T=1/0){let S=Math.min(T,g.distance(s[0],a[0]));if(S===0)return S;const A=new ih([[0,[0,s.length-1],[0,a.length-1]]],eu);for(;A.length>0;){const D=A.pop();if(D[0]>=S)continue;const P=D[1],L=D[2],F=t?50:100,$=h?50:100;if(ah(P)<=F&&ah(L)<=$){if(!po(P,s.length)&&po(L,a.length))return NaN;let H;if(t&&h)H=zf(s,P,a,L,g),S=Math.min(S,H);else if(t&&!h){const X=s.slice(P[0],P[1]+1);for(let J=L[0];J<=L[1];++J)if(H=No(a[J],X,g),S=Math.min(S,H),S===0)return S}else if(!t&&h){const X=a.slice(L[0],L[1]+1);for(let J=P[0];J<=P[1];++J)if(H=No(s[J],X,g),S=Math.min(S,H),S===0)return S}else H=nm(s,P,a,L,g),S=Math.min(S,H)}else{const H=Pn(P,t),X=Pn(L,h);oh(A,S,g,s,a,H[0],X[0]),oh(A,S,g,s,a,H[0],X[1]),oh(A,S,g,s,a,H[1],X[0]),oh(A,S,g,s,a,H[1],X[1])}}return S}function Nf(s){return s.type==="MultiPolygon"?s.coordinates.map(t=>({type:"Polygon",coordinates:t})):s.type==="MultiLineString"?s.coordinates.map(t=>({type:"LineString",coordinates:t})):s.type==="MultiPoint"?s.coordinates.map(t=>({type:"Point",coordinates:t})):[s]}class dc{constructor(t,a){this.type=Et,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ho(t[1])){const h=t[1];if(h.type==="FeatureCollection")return new dc(h,h.features.map(g=>Nf(g.geometry)).flat());if(h.type==="Feature")return new dc(h,Nf(h.geometry));if("type"in h&&"coordinates"in h)return new dc(h,Nf(h))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,h){const g=a.geometry(),T=g.flat().map(D=>eh([D.x,D.y],a.canonical));if(g.length===0)return NaN;const S=new pa(T[0][1]);let A=1/0;for(const D of h){switch(D.type){case"Point":A=Math.min(A,ch(T,!1,[D.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,ch(T,!1,D.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,lh(T,!1,D.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,h){const g=a.geometry(),T=g.flat().map(D=>eh([D.x,D.y],a.canonical));if(g.length===0)return NaN;const S=new pa(T[0][1]);let A=1/0;for(const D of h){switch(D.type){case"Point":A=Math.min(A,ch(T,!0,[D.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,ch(T,!0,D.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,lh(T,!0,D.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,h){const g=a.geometry();if(g.length===0||g[0].length===0)return NaN;const T=Jc(g,0).map(D=>D.map(P=>P.map(L=>eh([L.x,L.y],a.canonical)))),S=new pa(T[0][0][0][1]);let A=1/0;for(const D of h)for(const P of T){switch(D.type){case"Point":A=Math.min(A,lh([D.coordinates],!1,P,S,A));break;case"LineString":A=Math.min(A,lh(D.coordinates,!0,P,S,A));break;case"Polygon":A=Math.min(A,im(P,D.coordinates,S,A))}if(A===0)return A}return A}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class uh{constructor(t){this.type=dn,this.key=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=t[1];return h==null?a.error("Global state property must be defined."):typeof h!="string"?a.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new uh(h)}evaluate(t){var a;const h=(a=t.globals)===null||a===void 0?void 0:a.globalState;return h&&Object.keys(h).length!==0?ec(h,this.key):null}eachChild(){}outputDefined(){return!1}}const fc={"==":Af,"!=":yd,">":Mf,"<":Ag,">=":Cg,"<=":Mg,array:gi,at:ic,boolean:gi,case:$c,coalesce:sc,collator:_d,format:oc,image:Df,in:Xu,"index-of":Es,interpolate:Or,"interpolate-hcl":Or,"interpolate-lab":Or,length:qc,let:nc,literal:es,match:Mr,number:gi,"number-format":Cf,object:gi,slice:rc,step:Yi,string:gi,"to-boolean":La,"to-color":La,"to-number":La,"to-string":La,var:fl,within:pl,distance:dc,"global-state":uh};class Oa{constructor(t,a,h,g){this.name=t,this.type=a,this._evaluate=h,this.args=g}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const h=t[0],g=Oa.definitions[h];if(!g)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(g)?g[0]:g.type,S=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,A=S.filter(([P])=>!Array.isArray(P)||P.length===t.length-1);let D=null;for(const[P,L]of A){D=new dl(a.registry,ma,a.path,null,a.scope);const F=[];let $=!1;for(let H=1;H<t.length;H++){const X=t[H],J=Array.isArray(P)?P[H-1]:P.type,se=D.parse(X,1+F.length,J);if(!se){$=!0;break}F.push(se)}if(!$)if(Array.isArray(P)&&P.length!==F.length)D.error(`Expected ${P.length} arguments, but found ${F.length} instead.`);else{for(let H=0;H<F.length;H++){const X=Array.isArray(P)?P[H]:P.type,J=F[H];D.concat(H+1).checkSubtype(X,J.type)}if(D.errors.length===0)return new Oa(h,T,L,F)}}if(A.length===1)a.errors.push(...D.errors);else{const P=(A.length?A:S).map(([F])=>{return $=F,Array.isArray($)?`(${$.map(Zn).join(", ")})`:`(${Zn($.type)}...)`;var $}).join(" | "),L=[];for(let F=1;F<t.length;F++){const $=a.parse(t[F],1+L.length);if(!$)return null;L.push(Zn($.type))}a.error(`Expected arguments of type ${P}, but found (${L.join(", ")}) instead.`)}return null}static register(t,a){Oa.definitions=a;for(const h in a)t[h]=Oa}}function wd(s,[t,a,h,g]){t=t.evaluate(s),a=a.evaluate(s),h=h.evaluate(s);const T=g?g.evaluate(s):1,S=ci(t,a,h,T);if(S)throw new Fn(S);return new yn(t/255,a/255,h/255,T,!1)}function ts(s,t){return s in t}function Td(s,t){const a=t[s];return a===void 0?null:a}function Cr(s){return{type:s}}function ma(s){if(s instanceof fl)return ma(s.boundExpression);if(s instanceof Oa&&s.name==="error"||s instanceof _d||s instanceof pl||s instanceof dc||s instanceof uh)return!1;const t=s instanceof La||s instanceof gi;let a=!0;return s.eachChild(h=>{a=t?a&&ma(h):a&&h instanceof es}),!!a&&Lo(s)&&mc(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Lo(s){if(s instanceof Oa&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof pl||s instanceof dc)return!1;let t=!0;return s.eachChild(a=>{t&&!Lo(a)&&(t=!1)}),t}function pc(s){if(s instanceof Oa&&s.name==="feature-state")return!1;let t=!0;return s.eachChild(a=>{t&&!pc(a)&&(t=!1)}),t}function mc(s,t){if(s instanceof Oa&&t.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(h=>{a&&!mc(h,t)&&(a=!1)}),a}function hh(s){return{result:"success",value:s}}function yl(s){return{result:"error",value:s}}function ja(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Lf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function nu(s){return!!s.expression&&s.expression.interpolated}function gn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function dh(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&Ht(s)===Mi}function Ba(s){return s}function Sd(s,t){const a=s.stops&&typeof s.stops[0][0]=="object",h=a||!(a||s.property!==void 0),g=s.type||(nu(t)?"exponential":"interval"),T=function(L){switch(L.type){case"color":return yn.parse;case"padding":return _r.parse;case"numberArray":return zr.parse;case"colorArray":return ar.parse;default:return null}}(t);if(T&&((s=Xr({},s)).stops&&(s.stops=s.stops.map(L=>[L[0],T(L[1])])),s.default=T(s.default?s.default:t.default)),s.colorSpace&&(S=s.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var S;const A=function(L){switch(L){case"exponential":return _l;case"interval":return Ed;case"categorical":return Of;case"identity":return jf;default:throw new Error(`Unknown function type "${L}"`)}}(g);let D,P;if(g==="categorical"){D=Object.create(null);for(const L of s.stops)D[L[0]]=L[1];P=typeof s.stops[0][0]}if(a){const L={},F=[];for(let X=0;X<s.stops.length;X++){const J=s.stops[X],se=J[0].zoom;L[se]===void 0&&(L[se]={zoom:se,type:s.type,property:s.property,default:s.default,stops:[]},F.push(se)),L[se].stops.push([J[0].value,J[1]])}const $=[];for(const X of F)$.push([L[X].zoom,Sd(L[X],t)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Or.interpolationFactor.bind(void 0,H),zoomStops:$.map(X=>X[0]),evaluate:({zoom:X},J)=>_l({stops:$,base:s.base},t,X).evaluate(X,J)}}if(h){const L=g==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:Or.interpolationFactor.bind(void 0,L),zoomStops:s.stops.map(F=>F[0]),evaluate:({zoom:F})=>A(s,t,F,D,P)}}return{kind:"source",evaluate(L,F){const $=F&&F.properties?F.properties[s.property]:void 0;return $===void 0?Kr(s.default,t.default):A(s,t,$,D,P)}}}function Kr(s,t,a){return s!==void 0?s:t!==void 0?t:a!==void 0?a:void 0}function Of(s,t,a,h,g){return Kr(typeof a===g?h[a]:void 0,s.default,t.default)}function Ed(s,t,a){if(gn(a)!=="number")return Kr(s.default,t.default);const h=s.stops.length;if(h===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[h-1][0])return s.stops[h-1][1];const g=ac(s.stops.map(T=>T[0]),a);return s.stops[g][1]}function _l(s,t,a){const h=s.base!==void 0?s.base:1;if(gn(a)!=="number")return Kr(s.default,t.default);const g=s.stops.length;if(g===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[g-1][0])return s.stops[g-1][1];const T=ac(s.stops.map(L=>L[0]),a),S=function(L,F,$,H){const X=H-$,J=L-$;return X===0?0:F===1?J/X:(Math.pow(F,J)-1)/(Math.pow(F,X)-1)}(a,h,s.stops[T][0],s.stops[T+1][0]),A=s.stops[T][1],D=s.stops[T+1][1],P=fo[t.type]||Ba;return typeof A.evaluate=="function"?{evaluate(...L){const F=A.evaluate.apply(void 0,L),$=D.evaluate.apply(void 0,L);if(F!==void 0&&$!==void 0)return P(F,$,S,s.colorSpace)}}:P(A,D,S,s.colorSpace)}function jf(s,t,a){switch(t.type){case"color":a=yn.parse(a);break;case"formatted":a=dr.fromString(a.toString());break;case"resolvedImage":a=Lr.fromString(a.toString());break;case"padding":a=_r.parse(a);break;case"colorArray":a=ar.parse(a);break;case"numberArray":a=zr.parse(a);break;default:gn(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return Kr(a,s.default,t.default)}Oa.register(fc,{error:[{kind:"error"},[hn],(s,[t])=>{throw new Fn(t.evaluate(s))}],typeof:[hn,[dn],(s,[t])=>Zn(Ht(t.evaluate(s)))],"to-rgba":[Rr(Et,4),[rr],(s,[t])=>{const[a,h,g,T]=t.evaluate(s).rgb;return[255*a,255*h,255*g,T]}],rgb:[rr,[Et,Et,Et],wd],rgba:[rr,[Et,Et,Et,Et],wd],has:{type:an,overloads:[[[hn],(s,[t])=>ts(t.evaluate(s),s.properties())],[[hn,Mi],(s,[t,a])=>ts(t.evaluate(s),a.evaluate(s))]]},get:{type:dn,overloads:[[[hn],(s,[t])=>Td(t.evaluate(s),s.properties())],[[hn,Mi],(s,[t,a])=>Td(t.evaluate(s),a.evaluate(s))]]},"feature-state":[dn,[hn],(s,[t])=>Td(t.evaluate(s),s.featureState||{})],properties:[Mi,[],s=>s.properties()],"geometry-type":[hn,[],s=>s.geometryType()],id:[dn,[],s=>s.id()],zoom:[Et,[],s=>s.globals.zoom],"heatmap-density":[Et,[],s=>s.globals.heatmapDensity||0],elevation:[Et,[],s=>s.globals.elevation||0],"line-progress":[Et,[],s=>s.globals.lineProgress||0],accumulated:[dn,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Et,Cr(Et),(s,t)=>{let a=0;for(const h of t)a+=h.evaluate(s);return a}],"*":[Et,Cr(Et),(s,t)=>{let a=1;for(const h of t)a*=h.evaluate(s);return a}],"-":{type:Et,overloads:[[[Et,Et],(s,[t,a])=>t.evaluate(s)-a.evaluate(s)],[[Et],(s,[t])=>-t.evaluate(s)]]},"/":[Et,[Et,Et],(s,[t,a])=>t.evaluate(s)/a.evaluate(s)],"%":[Et,[Et,Et],(s,[t,a])=>t.evaluate(s)%a.evaluate(s)],ln2:[Et,[],()=>Math.LN2],pi:[Et,[],()=>Math.PI],e:[Et,[],()=>Math.E],"^":[Et,[Et,Et],(s,[t,a])=>Math.pow(t.evaluate(s),a.evaluate(s))],sqrt:[Et,[Et],(s,[t])=>Math.sqrt(t.evaluate(s))],log10:[Et,[Et],(s,[t])=>Math.log(t.evaluate(s))/Math.LN10],ln:[Et,[Et],(s,[t])=>Math.log(t.evaluate(s))],log2:[Et,[Et],(s,[t])=>Math.log(t.evaluate(s))/Math.LN2],sin:[Et,[Et],(s,[t])=>Math.sin(t.evaluate(s))],cos:[Et,[Et],(s,[t])=>Math.cos(t.evaluate(s))],tan:[Et,[Et],(s,[t])=>Math.tan(t.evaluate(s))],asin:[Et,[Et],(s,[t])=>Math.asin(t.evaluate(s))],acos:[Et,[Et],(s,[t])=>Math.acos(t.evaluate(s))],atan:[Et,[Et],(s,[t])=>Math.atan(t.evaluate(s))],min:[Et,Cr(Et),(s,t)=>Math.min(...t.map(a=>a.evaluate(s)))],max:[Et,Cr(Et),(s,t)=>Math.max(...t.map(a=>a.evaluate(s)))],abs:[Et,[Et],(s,[t])=>Math.abs(t.evaluate(s))],round:[Et,[Et],(s,[t])=>{const a=t.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[Et,[Et],(s,[t])=>Math.floor(t.evaluate(s))],ceil:[Et,[Et],(s,[t])=>Math.ceil(t.evaluate(s))],"filter-==":[an,[hn,dn],(s,[t,a])=>s.properties()[t.value]===a.value],"filter-id-==":[an,[dn],(s,[t])=>s.id()===t.value],"filter-type-==":[an,[hn],(s,[t])=>s.geometryType()===t.value],"filter-<":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h<g}],"filter-id-<":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a<h}],"filter->":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h>g}],"filter-id->":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a>h}],"filter-<=":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a<=h}],"filter->=":[an,[hn,dn],(s,[t,a])=>{const h=s.properties()[t.value],g=a.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[an,[dn],(s,[t])=>{const a=s.id(),h=t.value;return typeof a==typeof h&&a>=h}],"filter-has":[an,[dn],(s,[t])=>t.value in s.properties()],"filter-has-id":[an,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[an,[Rr(hn)],(s,[t])=>t.value.indexOf(s.geometryType())>=0],"filter-id-in":[an,[Rr(dn)],(s,[t])=>t.value.indexOf(s.id())>=0],"filter-in-small":[an,[hn,Rr(dn)],(s,[t,a])=>a.value.indexOf(s.properties()[t.value])>=0],"filter-in-large":[an,[hn,Rr(dn)],(s,[t,a])=>function(h,g,T,S){for(;T<=S;){const A=T+S>>1;if(g[A]===h)return!0;g[A]>h?S=A-1:T=A+1}return!1}(s.properties()[t.value],a.value,0,a.value.length-1)],all:{type:an,overloads:[[[an,an],(s,[t,a])=>t.evaluate(s)&&a.evaluate(s)],[Cr(an),(s,t)=>{for(const a of t)if(!a.evaluate(s))return!1;return!0}]]},any:{type:an,overloads:[[[an,an],(s,[t,a])=>t.evaluate(s)||a.evaluate(s)],[Cr(an),(s,t)=>{for(const a of t)if(a.evaluate(s))return!0;return!1}]]},"!":[an,[an],(s,[t])=>!t.evaluate(s)],"is-supported-script":[an,[hn],(s,[t])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(t.evaluate(s))}],upcase:[hn,[hn],(s,[t])=>t.evaluate(s).toUpperCase()],downcase:[hn,[hn],(s,[t])=>t.evaluate(s).toLowerCase()],concat:[hn,Cr(dn),(s,t)=>t.map(a=>rn(a.evaluate(s))).join("")],"resolved-locale":[hn,[$u],(s,[t])=>t.evaluate(s).resolvedLocale()]});class fh{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new Sf,this._defaultValue=a?function(h){if(h.type==="color"&&dh(h.default))return new yn(0,0,0,0);switch(h.type){case"color":return yn.parse(h.default)||null;case"padding":return _r.parse(h.default)||null;case"numberArray":return zr.parse(h.default)||null;case"colorArray":return ar.parse(h.default)||null;case"variableAnchorOffsetCollection":return Nr.parse(h.default)||null;case"projectionDefinition":return Vi.parse(h.default)||null;default:return h.default===void 0?null:h.default}}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,h,g,T,S){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(t,a,h,g,T,S){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Fn(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function Oo(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in fc}function mo(s,t){const a=new dl(fc,ma,[],t?function(g){const T={color:rr,string:hn,number:Et,enum:hn,boolean:an,formatted:Aa,padding:Io,numberArray:Ql,colorArray:ao,projectionDefinition:Ja,resolvedImage:Ui,variableAnchorOffsetCollection:pd};return g.type==="array"?Rr(T[g.value]||dn,g.length):T[g.type]}(t):void 0),h=a.parse(s,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?hh(new fh(h,t)):yl(a.errors)}class vl{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!pc(a.expression),this.globalStateRefs=Ua(a.expression)}evaluateWithoutErrorHandling(t,a,h,g,T,S){return this._styleExpression.evaluateWithoutErrorHandling(t,a,h,g,T,S)}evaluate(t,a,h,g,T,S){return this._styleExpression.evaluate(t,a,h,g,T,S)}}class iu{constructor(t,a,h,g){this.kind=t,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!pc(a.expression),this.globalStateRefs=Ua(a.expression),this.interpolationType=g}evaluateWithoutErrorHandling(t,a,h,g,T,S){return this._styleExpression.evaluateWithoutErrorHandling(t,a,h,g,T,S)}evaluate(t,a,h,g,T,S){return this._styleExpression.evaluate(t,a,h,g,T,S)}interpolationFactor(t,a,h){return this.interpolationType?Or.interpolationFactor(this.interpolationType,t,a,h):0}}function Fa(s,t){const a=mo(s,t);if(a.result==="error")return a;const h=a.value.expression,g=Lo(h);if(!g&&!ja(t))return yl([new Fi("","data expressions not supported")]);const T=mc(h,["zoom"]);if(!T&&!Lf(t))return yl([new Fi("","zoom expressions not supported")]);const S=As(h);return S||T?S instanceof Fi?yl([S]):S instanceof Or&&!nu(t)?yl([new Fi("",'"interpolate" expressions cannot be used with this property')]):hh(S?new iu(g?"camera":"composite",a.value,S.labels,S instanceof Or?S.interpolation:void 0):new vl(g?"constant":"source",a.value)):yl([new Fi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jr{constructor(t,a){this._parameters=t,this._specification=a,Xr(this,Sd(this._parameters,this._specification))}static deserialize(t){return new Jr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function As(s){let t=null;if(s instanceof nc)t=As(s.result);else if(s instanceof sc){for(const a of s.args)if(t=As(a),t)break}else(s instanceof Yi||s instanceof Or)&&s.input instanceof Oa&&s.input.name==="zoom"&&(t=s);return t instanceof Fi||s.eachChild(a=>{const h=As(a);h instanceof Fi?t=h:!t&&h?t=new Fi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&h&&t!==h&&(t=new Fi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Ua(s,t=new Set){return s instanceof uh&&t.add(s.key),s.eachChild(a=>{Ua(a,t)}),t}function ns(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const t of s.slice(1))if(!ns(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const jo={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bl(s){if(s==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};ns(s)||(s=sr(s));const t=mo(s,jo);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,h,g)=>t.value.evaluate(a,h,{},g),needGeometry:ru(s),getGlobalStateRefs:()=>Ua(t.value.expression)}}function ph(s,t){return s<t?-1:s>t?1:0}function ru(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let t=1;t<s.length;t++)if(ru(s[t]))return!0;return!1}function sr(s){if(!s)return!0;const t=s[0];return s.length<=1?t!=="any":t==="=="?Ri(s[1],s[2],"=="):t==="!="?Va(Ri(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ri(s[1],s[2],t):t==="any"?(a=s.slice(1),["any"].concat(a.map(sr))):t==="all"?["all"].concat(s.slice(1).map(sr)):t==="none"?["all"].concat(s.slice(1).map(sr).map(Va)):t==="in"?Un(s[1],s.slice(2)):t==="!in"?Va(Un(s[1],s.slice(2))):t==="has"?xl(s[1]):t!=="!has"||Va(xl(s[1]));var a}function Ri(s,t,a){switch(s){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,s,t]}}function Un(s,t){if(t.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",s,["literal",t.sort(ph)]]:["filter-in-small",s,["literal",t]]}}function xl(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Va(s){return["!",s]}function mh(s){const t=typeof s;if(t==="number"||t==="boolean"||t==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let g="[";for(const T of s)g+=`${mh(T)},`;return`${g}]`}const a=Object.keys(s).sort();let h="{";for(let g=0;g<a.length;g++)h+=`${JSON.stringify(a[g])}:${mh(s[a[g]])},`;return`${h}}`}function gc(s){let t="";for(const a of tn)t+=`/${mh(s[a])}`;return t}function Ad(s){const t=s.value;return t?[new gt(s.key,t,"constants have been deprecated as of v8")]:[]}function Pi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Ca(s){if(Array.isArray(s))return s.map(Ca);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const t={};for(const a in s)t[a]=Ca(s[a]);return t}return Pi(s)}function ea(s){const t=s.key,a=s.value,h=s.valueSpec||{},g=s.objectElementValidators||{},T=s.style,S=s.styleSpec,A=s.validateSpec;let D=[];const P=gn(a);if(P!=="object")return[new gt(t,a,`object expected, ${P} found`)];for(const L in a){const F=L.split(".")[0],$=ec(h,F)||h["*"];let H;if(ec(g,F))H=g[F];else if(ec(h,F))H=A;else if(g["*"])H=g["*"];else{if(!h["*"]){D.push(new gt(t,a[L],`unknown property "${L}"`));continue}H=A}D=D.concat(H({key:(t&&`${t}.`)+L,value:a[L],valueSpec:$,style:T,styleSpec:S,object:a,objectKey:L,validateSpec:A},a))}for(const L in h)g[L]||h[L].required&&h[L].default===void 0&&a[L]===void 0&&D.push(new gt(t,a,`missing required property "${L}"`));return D}function gh(s){const t=s.value,a=s.valueSpec,h=s.style,g=s.styleSpec,T=s.key,S=s.arrayElementValidator||s.validateSpec;if(gn(t)!=="array")return[new gt(T,t,`array expected, ${gn(t)} found`)];if(a.length&&t.length!==a.length)return[new gt(T,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new gt(T,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let A={type:a.value,values:a.values};g.$version<7&&(A.function=a.function),gn(a.value)==="object"&&(A=a.value);let D=[];for(let P=0;P<t.length;P++)D=D.concat(S({array:t,arrayIndex:P,value:t[P],valueSpec:A,validateSpec:s.validateSpec,style:h,styleSpec:g,key:`${T}[${P}]`}));return D}function Bo(s){const t=s.key,a=s.value,h=s.valueSpec;let g=gn(a);return g==="number"&&a!=a&&(g="NaN"),g!=="number"?[new gt(t,a,`number expected, ${g} found`)]:"minimum"in h&&a<h.minimum?[new gt(t,a,`${a} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&a>h.maximum?[new gt(t,a,`${a} is greater than the maximum value ${h.maximum}`)]:[]}function Md(s){const t=s.valueSpec,a=Pi(s.value.type);let h,g,T,S={};const A=a!=="categorical"&&s.value.property===void 0,D=!A,P=gn(s.value.stops)==="array"&&gn(s.value.stops[0])==="array"&&gn(s.value.stops[0][0])==="object",L=ea({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(H){if(a==="identity")return[new gt(H.key,H.value,'identity function may not have a "stops" property')];let X=[];const J=H.value;return X=X.concat(gh({key:H.key,value:J,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:F})),gn(J)==="array"&&J.length===0&&X.push(new gt(H.key,J,"array must have at least one stop")),X},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:t,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return a==="identity"&&A&&L.push(new gt(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||L.push(new gt(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!nu(s.valueSpec)&&L.push(new gt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(D&&!ja(s.valueSpec)?L.push(new gt(s.key,s.value,"property functions not supported")):A&&!Lf(s.valueSpec)&&L.push(new gt(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!P||s.value.property!==void 0||L.push(new gt(s.key,s.value,'"property" property is required')),L;function F(H){let X=[];const J=H.value,se=H.key;if(gn(J)!=="array")return[new gt(se,J,`array expected, ${gn(J)} found`)];if(J.length!==2)return[new gt(se,J,`array length 2 expected, length ${J.length} found`)];if(P){if(gn(J[0])!=="object")return[new gt(se,J,`object expected, ${gn(J[0])} found`)];if(J[0].zoom===void 0)return[new gt(se,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new gt(se,J,"object stop key must have value")];if(T&&T>Pi(J[0].zoom))return[new gt(se,J[0].zoom,"stop zoom values must appear in ascending order")];Pi(J[0].zoom)!==T&&(T=Pi(J[0].zoom),g=void 0,S={}),X=X.concat(ea({key:`${se}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Bo,value:$}}))}else X=X.concat($({key:`${se}[0]`,value:J[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},J));return Oo(Ca(J[1]))?X.concat([new gt(`${se}[1]`,J[1],"expressions are not allowed in function stops.")]):X.concat(H.validateSpec({key:`${se}[1]`,value:J[1],valueSpec:t,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function $(H,X){const J=gn(H.value),se=Pi(H.value),he=H.value!==null?H.value:X;if(h){if(J!==h)return[new gt(H.key,he,`${J} stop domain type must match previous stop domain type ${h}`)]}else h=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new gt(H.key,he,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&a!=="categorical"){let De=`number expected, ${J} found`;return ja(t)&&a===void 0&&(De+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(H.key,he,De)]}return a!=="categorical"||J!=="number"||isFinite(se)&&Math.floor(se)===se?a!=="categorical"&&J==="number"&&g!==void 0&&se<g?[new gt(H.key,he,"stop domain values must appear in ascending order")]:(g=se,a==="categorical"&&se in S?[new gt(H.key,he,"stop domain values must be unique")]:(S[se]=!0,[])):[new gt(H.key,he,`integer expected, found ${se}`)]}}function Ga(s){const t=(s.expressionContext==="property"?Fa:mo)(Ca(s.value),s.valueSpec);if(t.result==="error")return t.value.map(h=>new gt(`${s.key}${h.key}`,s.value,h.message));const a=t.value.expression||t.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new gt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!pc(a))return[new gt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!pc(a))return[new gt(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!mc(a,["zoom","feature-state"]))return[new gt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Lo(a))return[new gt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function is(s){const t=s.key,a=s.value,h=gn(a);return h!=="string"?[new gt(t,a,`color expected, ${h} found`)]:yn.parse(String(a))?[]:[new gt(t,a,`color expected, "${a}" found`)]}function ta(s){const t=s.key,a=s.value,h=s.valueSpec,g=[];return Array.isArray(h.values)?h.values.indexOf(Pi(a))===-1&&g.push(new gt(t,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(h.values).indexOf(Pi(a))===-1&&g.push(new gt(t,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),g}function Ms(s){return ns(Ca(s.value))?Ga(Xr({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Cd(s)}function Cd(s){const t=s.value,a=s.key;if(gn(t)!=="array")return[new gt(a,t,`array expected, ${gn(t)} found`)];const h=s.styleSpec;let g,T=[];if(t.length<1)return[new gt(a,t,"filter array must have at least 1 element")];switch(T=T.concat(ta({key:`${a}[0]`,value:t[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),Pi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Pi(t[1])==="$type"&&T.push(new gt(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&T.push(new gt(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(g=gn(t[1]),g!=="string"&&T.push(new gt(`${a}[1]`,t[1],`string expected, ${g} found`)));for(let S=2;S<t.length;S++)g=gn(t[S]),Pi(t[1])==="$type"?T=T.concat(ta({key:`${a}[${S}]`,value:t[S],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&T.push(new gt(`${a}[${S}]`,t[S],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let S=1;S<t.length;S++)T=T.concat(Cd({key:`${a}[${S}]`,value:t[S],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":g=gn(t[1]),t.length!==2?T.push(new gt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="string"&&T.push(new gt(`${a}[1]`,t[1],`string expected, ${g} found`))}return T}function Dd(s,t){const a=s.key,h=s.validateSpec,g=s.style,T=s.styleSpec,S=s.value,A=s.objectKey,D=T[`${t}_${s.layerType}`];if(!D)return[];const P=A.match(/^(.*)-transition$/);if(t==="paint"&&P&&D[P[1]]&&D[P[1]].transition)return h({key:a,value:S,valueSpec:T.transition,style:g,styleSpec:T});const L=s.valueSpec||D[A];if(!L)return[new gt(a,S,`unknown property "${A}"`)];let F;if(gn(S)==="string"&&ja(L)&&!L.tokens&&(F=/^{([^}]+)}$/.exec(S)))return[new gt(a,S,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const $=[];return s.layerType==="symbol"&&(A==="text-field"&&g&&!g.glyphs&&$.push(new gt(a,S,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&dh(Ca(S))&&Pi(S.type)==="identity"&&$.push(new gt(a,S,'"text-font" does not support identity functions'))),$.concat(h({key:s.key,value:S,valueSpec:L,style:g,styleSpec:T,expressionContext:"property",propertyType:t,propertyKey:A}))}function au(s){return Dd(s,"paint")}function yh(s){return Dd(s,"layout")}function wl(s){let t=[];const a=s.value,h=s.key,g=s.style,T=s.styleSpec;if(gn(a)!=="object")return[new gt(h,a,`object expected, ${gn(a)} found`)];a.type||a.ref||t.push(new gt(h,a,'either "type" or "ref" is required'));let S=Pi(a.type);const A=Pi(a.ref);if(a.id){const D=Pi(a.id);for(let P=0;P<s.arrayIndex;P++){const L=g.layers[P];Pi(L.id)===D&&t.push(new gt(h,a.id,`duplicate layer id "${a.id}", previously used at line ${L.id.__line__}`))}}if("ref"in a){let D;["type","source","source-layer","filter","layout"].forEach(P=>{P in a&&t.push(new gt(h,a[P],`"${P}" is prohibited for ref layers`))}),g.layers.forEach(P=>{Pi(P.id)===A&&(D=P)}),D?D.ref?t.push(new gt(h,a.ref,"ref cannot reference another ref layer")):S=Pi(D.type):t.push(new gt(h,a.ref,`ref layer "${A}" not found`))}else if(S!=="background")if(a.source){const D=g.sources&&g.sources[a.source],P=D&&Pi(D.type);D?P==="vector"&&S==="raster"?t.push(new gt(h,a.source,`layer "${a.id}" requires a raster source`)):P!=="raster-dem"&&S==="hillshade"||P!=="raster-dem"&&S==="color-relief"?t.push(new gt(h,a.source,`layer "${a.id}" requires a raster-dem source`)):P==="raster"&&S!=="raster"?t.push(new gt(h,a.source,`layer "${a.id}" requires a vector source`)):P!=="vector"||a["source-layer"]?P==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?t.push(new gt(h,a.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!a.paint||!a.paint["line-gradient"]||P==="geojson"&&D.lineMetrics||t.push(new gt(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new gt(h,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new gt(h,a.source,`source "${a.source}" not found`))}else t.push(new gt(h,a,'missing required property "source"'));return t=t.concat(ea({key:h,value:a,valueSpec:T.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${h}.type`,value:a.type,valueSpec:T.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:a,objectKey:"type"}),filter:Ms,layout:D=>ea({layer:a,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":P=>yh(Xr({layerType:S},P))}}),paint:D=>ea({layer:a,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":P=>au(Xr({layerType:S},P))}})}})),t}function yi(s){const t=s.value,a=s.key,h=gn(t);return h!=="string"?[new gt(a,t,`string expected, ${h} found`)]:[]}const Fo={promoteId:function({key:s,value:t}){if(gn(t)==="string")return yi({key:s,value:t});{const a=[];for(const h in t)a.push(...yi({key:`${s}.${h}`,value:t[h]}));return a}}};function ga(s){const t=s.value,a=s.key,h=s.styleSpec,g=s.style,T=s.validateSpec;if(!t.type)return[new gt(a,t,'"type" is required')];const S=Pi(t.type);let A;switch(S){case"vector":case"raster":return A=ea({key:a,value:t,valueSpec:h[`source_${S.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:Fo,validateSpec:T}),A;case"raster-dem":return A=function(D){var P;const L=(P=D.sourceName)!==null&&P!==void 0?P:"",F=D.value,$=D.styleSpec,H=$.source_raster_dem,X=D.style;let J=[];const se=gn(F);if(F===void 0)return J;if(se!=="object")return J.push(new gt("source_raster_dem",F,`object expected, ${se} found`)),J;const he=Pi(F.encoding)==="custom",De=["redFactor","greenFactor","blueFactor","baseShift"],ve=D.value.encoding?`"${D.value.encoding}"`:"Default";for(const we in F)!he&&De.includes(we)?J.push(new gt(we,F[we],`In "${L}": "${we}" is only valid when "encoding" is set to "custom". ${ve} encoding found`)):H[we]?J=J.concat(D.validateSpec({key:we,value:F[we],valueSpec:H[we],validateSpec:D.validateSpec,style:X,styleSpec:$})):J.push(new gt(we,F[we],`unknown property "${we}"`));return J}({sourceName:a,value:t,style:s.style,styleSpec:h,validateSpec:T}),A;case"geojson":if(A=ea({key:a,value:t,valueSpec:h.source_geojson,style:g,styleSpec:h,validateSpec:T,objectElementValidators:Fo}),t.cluster)for(const D in t.clusterProperties){const[P,L]=t.clusterProperties[D],F=typeof P=="string"?[P,["accumulated"],["get",D]]:P;A.push(...Ga({key:`${a}.${D}.map`,value:L,expressionContext:"cluster-map"})),A.push(...Ga({key:`${a}.${D}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return A;case"video":return ea({key:a,value:t,valueSpec:h.source_video,style:g,validateSpec:T,styleSpec:h});case"image":return ea({key:a,value:t,valueSpec:h.source_image,style:g,validateSpec:T,styleSpec:h});case"canvas":return[new gt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ta({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function su(s){const t=s.value,a=s.styleSpec,h=a.light,g=s.style;let T=[];const S=gn(t);if(t===void 0)return T;if(S!=="object")return T=T.concat([new gt("light",t,`object expected, ${S} found`)]),T;for(const A in t){const D=A.match(/^(.*)-transition$/);T=T.concat(D&&h[D[1]]&&h[D[1]].transition?s.validateSpec({key:A,value:t[A],valueSpec:a.transition,validateSpec:s.validateSpec,style:g,styleSpec:a}):h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],validateSpec:s.validateSpec,style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)])}return T}function Bf(s){const t=s.value,a=s.styleSpec,h=a.sky,g=s.style,T=gn(t);if(t===void 0)return[];if(T!=="object")return[new gt("sky",t,`object expected, ${T} found`)];let S=[];for(const A in t)S=S.concat(h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)]);return S}function rm(s){const t=s.value,a=s.styleSpec,h=a.terrain,g=s.style;let T=[];const S=gn(t);if(t===void 0)return T;if(S!=="object")return T=T.concat([new gt("terrain",t,`object expected, ${S} found`)]),T;for(const A in t)T=T.concat(h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],validateSpec:s.validateSpec,style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)]);return T}function fr(s){let t=[];const a=s.value,h=s.key;if(Array.isArray(a)){const g=[],T=[];for(const S in a)a[S].id&&g.includes(a[S].id)&&t.push(new gt(h,a,`all the sprites' ids must be unique, but ${a[S].id} is duplicated`)),g.push(a[S].id),a[S].url&&T.includes(a[S].url)&&t.push(new gt(h,a,`all the sprites' URLs must be unique, but ${a[S].url} is duplicated`)),T.push(a[S].url),t=t.concat(ea({key:`${h}[${S}]`,value:a[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return t}return yi({key:h,value:a})}function Tl(s){return t=s.value,t&&t.constructor===Object?[]:[new gt(s.key,s.value,`object expected, ${gn(s.value)} found`)];var t}const yc={"*":()=>[],array:gh,boolean:function(s){const t=s.value,a=s.key,h=gn(t);return h!=="boolean"?[new gt(a,t,`boolean expected, ${h} found`)]:[]},number:Bo,color:is,constants:Ad,enum:ta,filter:Ms,function:Md,layer:wl,object:ea,source:ga,light:su,sky:Bf,terrain:rm,projection:function(s){const t=s.value,a=s.styleSpec,h=a.projection,g=s.style,T=gn(t);if(t===void 0)return[];if(T!=="object")return[new gt("projection",t,`object expected, ${T} found`)];let S=[];for(const A in t)S=S.concat(h[A]?s.validateSpec({key:A,value:t[A],valueSpec:h[A],style:g,styleSpec:a}):[new gt(A,t[A],`unknown property "${A}"`)]);return S},projectionDefinition:function(s){const t=s.key;let a=s.value;a=a instanceof String?a.valueOf():a;const h=gn(a);return h!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(a)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(a)?["array","string"].includes(h)?[]:[new gt(t,a,`projection expected, invalid type "${h}" found`)]:[new gt(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:yi,formatted:function(s){return yi(s).length===0?[]:Ga(s)},resolvedImage:function(s){return yi(s).length===0?[]:Ga(s)},padding:function(s){const t=s.key,a=s.value;if(gn(a)==="array"){if(a.length<1||a.length>4)return[new gt(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const h={type:"number"};let g=[];for(let T=0;T<a.length;T++)g=g.concat(s.validateSpec({key:`${t}[${T}]`,value:a[T],validateSpec:s.validateSpec,valueSpec:h}));return g}return Bo({key:t,value:a,valueSpec:{}})},numberArray:function(s){const t=s.key,a=s.value;if(gn(a)==="array"){const h={type:"number"};if(a.length<1)return[new gt(t,a,"array length at least 1 expected, length 0 found")];let g=[];for(let T=0;T<a.length;T++)g=g.concat(s.validateSpec({key:`${t}[${T}]`,value:a[T],validateSpec:s.validateSpec,valueSpec:h}));return g}return Bo({key:t,value:a,valueSpec:{}})},colorArray:function(s){const t=s.key,a=s.value;if(gn(a)==="array"){if(a.length<1)return[new gt(t,a,"array length at least 1 expected, length 0 found")];let h=[];for(let g=0;g<a.length;g++)h=h.concat(is({key:`${t}[${g}]`,value:a[g]}));return h}return is({key:t,value:a})},variableAnchorOffsetCollection:function(s){const t=s.key,a=s.value,h=gn(a),g=s.styleSpec;if(h!=="array"||a.length<1||a.length%2!=0)return[new gt(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let S=0;S<a.length;S+=2)T=T.concat(ta({key:`${t}[${S}]`,value:a[S],valueSpec:g.layout_symbol["text-anchor"]})),T=T.concat(gh({key:`${t}[${S+1}]`,value:a[S+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:g}));return T},sprite:fr,state:Tl};function go(s){const t=s.value,a=s.valueSpec,h=s.styleSpec;return s.validateSpec=go,a.expression&&dh(Pi(t))?Md(s):a.expression&&Oo(Ca(t))?Ga(s):a.type&&yc[a.type]?yc[a.type](s):ea(Xr({},s,{valueSpec:a.type?h[a.type]:a}))}function kd(s){const t=s.value,a=s.key,h=yi(s);return h.length||(t.indexOf("{fontstack}")===-1&&h.push(new gt(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&h.push(new gt(a,t,'"glyphs" url must include a "{range}" token'))),h}function vr(s,t=Re){let a=[];return a=a.concat(go({key:"",value:s,valueSpec:t.$root,styleSpec:t,style:s,validateSpec:go,objectElementValidators:{glyphs:kd,"*":()=>[]}})),s.constants&&(a=a.concat(Ad({key:"constants",value:s.constants}))),ou(a)}function na(s){return function(t){return s({...t,validateSpec:go})}}function ou(s){return[].concat(s).sort((t,a)=>t.line-a.line)}function rs(s){return function(...t){return ou(s.apply(this,t))}}vr.source=rs(na(ga)),vr.sprite=rs(na(fr)),vr.glyphs=rs(na(kd)),vr.light=rs(na(su)),vr.sky=rs(na(Bf)),vr.terrain=rs(na(rm)),vr.state=rs(na(Tl)),vr.layer=rs(na(wl)),vr.filter=rs(na(Ms)),vr.paintProperty=rs(na(au)),vr.layoutProperty=rs(na(yh));const lu=vr,am=lu.light,Cs=lu.sky,Ff=lu.paintProperty,Id=lu.layoutProperty;function cu(s,t){let a=!1;if(t&&t.length)for(const h of t)s.fire(new it(new Error(h.message))),a=!0;return a}class Uo{constructor(t,a,h){const g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const S=new Int32Array(this.arrayBuffer);t=S[0],this.d=(a=S[1])+2*(h=S[2]);for(let D=0;D<this.d*this.d;D++){const P=S[3+D],L=S[3+D+1];g.push(P===L?null:S.subarray(P,L))}const A=S[3+g.length+1];this.keys=S.subarray(S[3+g.length],A),this.bboxes=S.subarray(A),this.insert=this._insertReadonly}else{this.d=a+2*h;for(let S=0;S<this.d*this.d;S++)g.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=h,this.scale=a/t,this.uid=0;const T=h/a*t;this.min=-T,this.max=t+T}insert(t,a,h,g,T){this._forEachCell(a,h,g,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,h,g,T,S){this.cells[T].push(S)}query(t,a,h,g,T){const S=this.min,A=this.max;if(t<=S&&a<=S&&A<=h&&A<=g&&!T)return Array.prototype.slice.call(this.keys);{const D=[];return this._forEachCell(t,a,h,g,this._queryCell,D,{},T),D}}_queryCell(t,a,h,g,T,S,A,D){const P=this.cells[T];if(P!==null){const L=this.keys,F=this.bboxes;for(let $=0;$<P.length;$++){const H=P[$];if(A[H]===void 0){const X=4*H;(D?D(F[X+0],F[X+1],F[X+2],F[X+3]):t<=F[X+2]&&a<=F[X+3]&&h>=F[X+0]&&g>=F[X+1])?(A[H]=!0,S.push(L[H])):A[H]=!1}}}}_forEachCell(t,a,h,g,T,S,A,D){const P=this._convertToCellCoord(t),L=this._convertToCellCoord(a),F=this._convertToCellCoord(h),$=this._convertToCellCoord(g);for(let H=P;H<=F;H++)for(let X=L;X<=$;X++){const J=this.d*X+H;if((!D||D(this._convertFromCellCoord(H),this._convertFromCellCoord(X),this._convertFromCellCoord(H+1),this._convertFromCellCoord(X+1)))&&T.call(this,t,a,h,g,J,S,A,D))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let h=0;for(let S=0;S<this.cells.length;S++)h+=this.cells[S].length;const g=new Int32Array(a+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let T=a;for(let S=0;S<t.length;S++){const A=t[S];g[3+S]=T,g.set(A,T),T+=A.length}return g[3+t.length]=T,g.set(this.keys,T),T+=this.keys.length,g[3+t.length+1]=T,g.set(this.bboxes,T),T+=this.bboxes.length,g.buffer}static serialize(t,a){const h=t.toArrayBuffer();return a&&a.push(h),{buffer:h}}static deserialize(t){return new Uo(t.buffer)}}const as={};function Dt(s,t,a={}){if(as[s])throw new Error(`${s} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:s,writeable:!1}),as[s]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}Dt("Object",Object),Dt("Set",Set),Dt("TransferableGridIndex",Uo),Dt("Color",yn),Dt("Error",Error),Dt("AJAXError",ye),Dt("ResolvedImage",Lr),Dt("StylePropertyFunction",Jr),Dt("StyleExpression",fh,{omit:["_evaluator"]}),Dt("ZoomDependentExpression",iu),Dt("ZoomConstantExpression",vl),Dt("CompoundExpression",Oa,{omit:["_evaluate"]});for(const s in fc)fc[s]._classRegistryKey||Dt(`Expression_${s}`,fc[s]);function _h(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function vh(s){return s.$name||s.constructor._classRegistryKey}function uu(s){return!function(t){if(t===null||typeof t!="object")return!1;const a=vh(t);return!(!a||a==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||_h(s)||Qa(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function _c(s,t){if(uu(s))return(_h(s)||Qa(s))&&t&&t.push(s),ArrayBuffer.isView(s)&&t&&t.push(s.buffer),s instanceof ImageData&&t&&t.push(s.data.buffer),s;if(Array.isArray(s)){const T=[];for(const S of s)T.push(_c(S,t));return T}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const a=vh(s);if(!a)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!as[a])throw new Error(`${a} is not registered.`);const{klass:h}=as[a],g=h.serialize?h.serialize(s,t):{};if(h.serialize){if(t&&g===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in s){if(!s.hasOwnProperty(T)||as[a].omit.indexOf(T)>=0)continue;const S=s[T];g[T]=as[a].shallow.indexOf(T)>=0?S:_c(S,t)}s instanceof Error&&(g.message=s.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(g.$name=a),g}function Ds(s){if(uu(s))return s;if(Array.isArray(s))return s.map(Ds);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const t=vh(s)||"Object";if(!as[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=as[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(s);const h=Object.create(a.prototype);for(const g of Object.keys(s)){if(g==="$name")continue;const T=s[g];h[g]=as[t].shallow.indexOf(g)>=0?T:Ds(T)}return h}class bh{constructor(){this.first=!0}update(t,a){const h=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=h,!0))}}const En={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Hangul Syllables":s=>s>=44032&&s<=55215,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function ks(s){for(const t of s)if(xh(t.charCodeAt(0)))return!0;return!1}function Uf(s){for(const t of s)if(!Vo(t.charCodeAt(0)))return!1;return!0}function hu(s){const t=s.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const Sl=hu(["Arab","Dupl","Mong","Ougr","Syrc"]);function Vo(s){return!Sl.test(String.fromCodePoint(s))}const vc=hu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function xh(s){return!(s!==746&&s!==747&&(s<4352||!(En["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||En["CJK Compatibility"](s)||En["CJK Strokes"](s)||!(!En["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||En["Enclosed CJK Letters and Months"](s)||En["Ideographic Description Characters"](s)||En.Kanbun(s)||En.Katakana(s)&&s!==12540||!(!En["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!En["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||En["Vertical Forms"](s)||En["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||vc.test(String.fromCodePoint(s)))))}function Rd(s){return!(xh(s)||function(t){return!!(En["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||En["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||En["Letterlike Symbols"](t)||En["Number Forms"](t)||En["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||En["Control Pictures"](t)&&t!==9251||En["Optical Character Recognition"](t)||En["Enclosed Alphanumerics"](t)||En["Geometric Shapes"](t)||En["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||En["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||En["CJK Symbols and Punctuation"](t)||En.Katakana(t)||En["Private Use Area"](t)||En["CJK Compatibility Forms"](t)||En["Small Form Variants"](t)||En["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(s))}const du=hu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function bc(s){return du.test(String.fromCodePoint(s))}function Vf(s,t){return!(!t&&bc(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||En.Khmer(s))}function Gf(s){for(const t of s)if(bc(t.charCodeAt(0)))return!0;return!1}const ia=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(ia.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const a=s.pluginURL,h=new Promise(T=>{this.loadScriptResolve=T});t(a);const g=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([h,g]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:a};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class $n{constructor(t,a){this.zoom=t,a?(this.now=a.now||0,this.fadeDuration=a.fadeDuration||0,this.zoomHistory=a.zoomHistory||new bh,this.transition=a.transition||{},this.globalState=a.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new bh,this.transition={},this.globalState={})}isSupportedScript(t){return function(a,h){for(const g of a)if(!Vf(g.charCodeAt(0),h))return!1;return!0}(t,ia.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),h=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*a}}}class xc{constructor(t,a){this.property=t,this.value=a,this.expression=function(h,g){if(dh(h))return new Jr(h,g);if(Oo(h)){const T=Fa(h,g);if(T.result==="error")throw new Error(T.value.map(S=>`${S.key}: ${S.message}`).join(", "));return T.value}{let T=h;return g.type==="color"&&typeof h=="string"?T=yn.parse(h):g.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?g.type!=="numberArray"||typeof h!="number"&&!Array.isArray(h)?g.type!=="colorArray"||typeof h!="string"&&!Array.isArray(h)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(h)?T=Nr.parse(h):g.type==="projectionDefinition"&&typeof h=="string"&&(T=Vi.parse(h)):T=ar.parse(h):T=zr.parse(h):T=_r.parse(h),{globalStateRefs:new Set,kind:"constant",evaluate:()=>T}}}(a===void 0?t.specification.default:a,t.specification),this._evaluate=this.expression.evaluate}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,a,h){return this.property.possiblyEvaluate(this,t,a,h)}setGlobalState(t){this.expression.evaluate=(a,h,g,T,S,A)=>(a.globalState=t,this._evaluate.call(this.expression,a,h,g,T,S,A))}}class wh{constructor(t){this.property=t,this.value=new xc(t,void 0)}transitioned(t,a){return new yo(this.property,this.value,a,mn({},t.transition,this.transition),t.now)}untransitioned(){return new yo(this.property,this.value,null,{},0)}}class Pd{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ur(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new wh(this._values[t].property)),this._values[t].value=new xc(this._values[t].property,a===null?void 0:ur(a))}getTransition(t){return ur(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new wh(this._values[t].property)),this._values[t].transition=ur(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h);const g=this.getTransition(a);g!==void 0&&(t[`${a}-transition`]=g)}return t}transitioned(t,a){const h=new Tn(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(t,a._values[g]);return h}untransitioned(){const t=new Tn(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class yo{constructor(t,a,h,g,T){this.property=t,this.value=a,this.begin=T+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(t,a,h){const g=t.now||0,T=this.value.possiblyEvaluate(t,a,h),S=this.prior;if(S){if(g>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(g<this.begin)return S.possiblyEvaluate(t,a,h);{const A=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(t,a,h),T,bt(A))}}return T}}class Tn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,h){const g=new wc(this._properties);for(const T of Object.keys(this._values))g._values[T]=this._values[T].possiblyEvaluate(t,a,h);return g}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ri{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState={}}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ur(this._values[t].value)}setValue(t,a){this._values[t]=new xc(this._values[t].property,a===null?void 0:ur(a)),this._values[t].setGlobalState(this._globalState)}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h)}return t}possiblyEvaluate(t,a,h){const g=new wc(this._properties);for(const T of Object.keys(this._values))g._values[T]=this._values[T].possiblyEvaluate(t,a,h);return g}setGlobalState(t){this._globalState=t;for(const a of Object.values(this._values))a.setGlobalState(t)}}class ai{constructor(t,a,h){this.property=t,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,h,g){return this.property.evaluate(this.value,this.parameters,t,a,h,g)}}class wc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class zt{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,h){const g=fo[this.specification.type];return g?g(t,a,h):t}}class Gt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,h,g){return new ai(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},h,g)}:t.expression,a)}interpolate(t,a,h){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new ai(this,{kind:"constant",value:void 0},t.parameters);const g=fo[this.specification.type];if(g){const T=g(t.value.value,a.value.value,h);return new ai(this,{kind:"constant",value:T},t.parameters)}return t}evaluate(t,a,h,g,T,S){return t.kind==="constant"?t.value:t.evaluate(a,h,g,T,S)}}class Tc extends Gt{possiblyEvaluate(t,a,h,g){if(t.value===void 0)return new ai(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const T=t.expression.evaluate(a,null,{},h,g),S=t.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,A=this._calculate(S,S,S,a);return new ai(this,{kind:"constant",value:A},a)}if(t.expression.kind==="camera"){const T=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new ai(this,{kind:"constant",value:T},a)}return new ai(this,t.expression,a)}evaluate(t,a,h,g,T,S){if(t.kind==="source"){const A=t.evaluate(a,h,g,T,S);return this._calculate(A,A,A,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},h,g),t.evaluate({zoom:Math.floor(a.zoom)},h,g),t.evaluate({zoom:Math.floor(a.zoom)+1},h,g),a):t.value}_calculate(t,a,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class ss{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,g){if(t.value!==void 0){if(t.expression.kind==="constant"){const T=t.expression.evaluate(a,null,{},h,g);return this._calculate(T,T,T,a)}return this._calculate(t.expression.evaluate(new $n(Math.floor(a.zoom-1),a)),t.expression.evaluate(new $n(Math.floor(a.zoom),a)),t.expression.evaluate(new $n(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class Go{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,g){return!!t.expression.evaluate(a,null,{},h,g)}interpolate(){return!1}}class ya{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const h=t[a];h.specification.overridable&&this.overridableProperties.push(a);const g=this.defaultPropertyValues[a]=new xc(h,void 0),T=this.defaultTransitionablePropertyValues[a]=new wh(h);this.defaultTransitioningPropertyValues[a]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=g.possiblyEvaluate({})}}}Dt("DataDrivenProperty",Gt),Dt("DataConstantProperty",zt),Dt("CrossFadedDataDrivenProperty",Tc),Dt("CrossFadedProperty",ss),Dt("ColorRampProperty",Go);const qi="-transition";class Da extends Lt{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this._globalState={},t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=bl(t.filter)),a.layout&&(this._unevaluatedLayout=new ri(a.layout)),a.paint)){this._transitionablePaint=new Pd(a.paint);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new wc(a.paint)}}setFilter(t){this.filter=t,this._featureFilter=bl(t)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const a in this._unevaluatedLayout._values){const h=this._unevaluatedLayout._values[a];for(const g of h.getGlobalStateRefs())t.add(g)}for(const a of this._featureFilter.getGlobalStateRefs())t.add(a);return t}getPaintAffectingGlobalStateRefs(){var t;const a=new globalThis.Map;if(this._transitionablePaint)for(const h in this._transitionablePaint._values){const g=this._transitionablePaint._values[h].value;for(const T of g.getGlobalStateRefs()){const S=(t=a.get(T))!==null&&t!==void 0?t:[];S.push({name:h,value:g.value}),a.set(T,S)}}return a}setLayoutProperty(t,a,h={}){a!=null&&this._validate(Id,`layers.${this.id}.layout.${t}`,t,a,h)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(qi)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,h={}){if(a!=null&&this._validate(Ff,`layers.${this.id}.paint.${t}`,t,a,h))return!1;if(t.endsWith(qi))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const g=this._transitionablePaint._values[t],T=g.property.specification["property-type"]==="cross-faded-data-driven",S=g.value.isDataDriven(),A=g.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const D=this._transitionablePaint._values[t].value;return D.isDataDriven()||S||T||this._handleOverridablePaintPropertyUpdate(t,A,D)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,h){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.globalState=this._globalState,t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}setGlobalState(t){this._globalState=t,this._unevaluatedLayout&&this._unevaluatedLayout.setGlobalState(t)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ua(t,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}_validate(t,a,h,g,T={}){return(!T||T.validate!==!1)&&cu(this,t.call(lu,{key:a,layerType:this.type,objectKey:h,value:g,styleSpec:Re,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof ai&&ja(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Zf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class fu{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Wn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Hi(s,t=1){let a=0,h=0;return{members:s.map(g=>{const T=Zf[g.type].BYTES_PER_ELEMENT,S=a=pu(a,Math.max(t,T)),A=g.components||1;return h=Math.max(h,T),a+=T*A,{name:g.name,type:g.type,components:A,offset:S}}),size:pu(a,Math.max(h,t)),alignment:t}}function pu(s,t){return Math.ceil(s/t)*t}class El extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const g=2*t;return this.int16[g+0]=a,this.int16[g+1]=h,t}}El.prototype.bytesPerElement=4,Dt("StructArrayLayout2i4",El);class Al extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const T=3*t;return this.int16[T+0]=a,this.int16[T+1]=h,this.int16[T+2]=g,t}}Al.prototype.bytesPerElement=6,Dt("StructArrayLayout3i6",Al);class ra extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,h,g)}emplace(t,a,h,g,T){const S=4*t;return this.int16[S+0]=a,this.int16[S+1]=h,this.int16[S+2]=g,this.int16[S+3]=T,t}}ra.prototype.bytesPerElement=8,Dt("StructArrayLayout4i8",ra);class Ci extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,T,S)}emplace(t,a,h,g,T,S,A){const D=6*t;return this.int16[D+0]=a,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=T,this.int16[D+4]=S,this.int16[D+5]=A,t}}Ci.prototype.bytesPerElement=12,Dt("StructArrayLayout2i4i12",Ci);class Zo extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,T,S)}emplace(t,a,h,g,T,S,A){const D=4*t,P=8*t;return this.int16[D+0]=a,this.int16[D+1]=h,this.uint8[P+4]=g,this.uint8[P+5]=T,this.uint8[P+6]=S,this.uint8[P+7]=A,t}}Zo.prototype.bytesPerElement=8,Dt("StructArrayLayout2i4ub8",Zo);class $o extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const g=2*t;return this.float32[g+0]=a,this.float32[g+1]=h,t}}$o.prototype.bytesPerElement=8,Dt("StructArrayLayout2f8",$o);class Sc extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S,A,D,P,L){const F=this.length;return this.resize(F+1),this.emplace(F,t,a,h,g,T,S,A,D,P,L)}emplace(t,a,h,g,T,S,A,D,P,L,F){const $=10*t;return this.uint16[$+0]=a,this.uint16[$+1]=h,this.uint16[$+2]=g,this.uint16[$+3]=T,this.uint16[$+4]=S,this.uint16[$+5]=A,this.uint16[$+6]=D,this.uint16[$+7]=P,this.uint16[$+8]=L,this.uint16[$+9]=F,t}}Sc.prototype.bytesPerElement=20,Dt("StructArrayLayout10ui20",Sc);class Yo extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S,A,D,P,L,F,$){const H=this.length;return this.resize(H+1),this.emplace(H,t,a,h,g,T,S,A,D,P,L,F,$)}emplace(t,a,h,g,T,S,A,D,P,L,F,$,H){const X=12*t;return this.int16[X+0]=a,this.int16[X+1]=h,this.int16[X+2]=g,this.int16[X+3]=T,this.uint16[X+4]=S,this.uint16[X+5]=A,this.uint16[X+6]=D,this.uint16[X+7]=P,this.int16[X+8]=L,this.int16[X+9]=F,this.int16[X+10]=$,this.int16[X+11]=H,t}}Yo.prototype.bytesPerElement=24,Dt("StructArrayLayout4i4ui4i24",Yo);class Is extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const T=3*t;return this.float32[T+0]=a,this.float32[T+1]=h,this.float32[T+2]=g,t}}Is.prototype.bytesPerElement=12,Dt("StructArrayLayout3f12",Is);class mu extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}mu.prototype.bytesPerElement=4,Dt("StructArrayLayout1ul4",mu);class gu extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S,A,D,P){const L=this.length;return this.resize(L+1),this.emplace(L,t,a,h,g,T,S,A,D,P)}emplace(t,a,h,g,T,S,A,D,P,L){const F=10*t,$=5*t;return this.int16[F+0]=a,this.int16[F+1]=h,this.int16[F+2]=g,this.int16[F+3]=T,this.int16[F+4]=S,this.int16[F+5]=A,this.uint32[$+3]=D,this.uint16[F+8]=P,this.uint16[F+9]=L,t}}gu.prototype.bytesPerElement=20,Dt("StructArrayLayout6i1ul2ui20",gu);class Th extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,T,S)}emplace(t,a,h,g,T,S,A){const D=6*t;return this.int16[D+0]=a,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=T,this.int16[D+4]=S,this.int16[D+5]=A,t}}Th.prototype.bytesPerElement=12,Dt("StructArrayLayout2i2i2i12",Th);class b extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T){const S=this.length;return this.resize(S+1),this.emplace(S,t,a,h,g,T)}emplace(t,a,h,g,T,S){const A=4*t,D=8*t;return this.float32[A+0]=a,this.float32[A+1]=h,this.float32[A+2]=g,this.int16[D+6]=T,this.int16[D+7]=S,t}}b.prototype.bytesPerElement=16,Dt("StructArrayLayout2f1f2i16",b);class e extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,h,g,T,S)}emplace(t,a,h,g,T,S,A){const D=16*t,P=4*t,L=8*t;return this.uint8[D+0]=a,this.uint8[D+1]=h,this.float32[P+1]=g,this.float32[P+2]=T,this.int16[L+6]=S,this.int16[L+7]=A,t}}e.prototype.bytesPerElement=16,Dt("StructArrayLayout2ub2f2i16",e);class o extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const T=3*t;return this.uint16[T+0]=a,this.uint16[T+1]=h,this.uint16[T+2]=g,t}}o.prototype.bytesPerElement=6,Dt("StructArrayLayout3ui6",o);class f extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he){const De=this.length;return this.resize(De+1),this.emplace(De,t,a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he)}emplace(t,a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he,De){const ve=24*t,we=12*t,Be=48*t;return this.int16[ve+0]=a,this.int16[ve+1]=h,this.uint16[ve+2]=g,this.uint16[ve+3]=T,this.uint32[we+2]=S,this.uint32[we+3]=A,this.uint32[we+4]=D,this.uint16[ve+10]=P,this.uint16[ve+11]=L,this.uint16[ve+12]=F,this.float32[we+7]=$,this.float32[we+8]=H,this.uint8[Be+36]=X,this.uint8[Be+37]=J,this.uint8[Be+38]=se,this.uint32[we+10]=he,this.int16[ve+22]=De,t}}f.prototype.bytesPerElement=48,Dt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",f);class y extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he,De,ve,we,Be,We,lt,Tt,_t,xt,Ft,St){const wt=this.length;return this.resize(wt+1),this.emplace(wt,t,a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he,De,ve,we,Be,We,lt,Tt,_t,xt,Ft,St)}emplace(t,a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he,De,ve,we,Be,We,lt,Tt,_t,xt,Ft,St,wt){const tt=32*t,qt=16*t;return this.int16[tt+0]=a,this.int16[tt+1]=h,this.int16[tt+2]=g,this.int16[tt+3]=T,this.int16[tt+4]=S,this.int16[tt+5]=A,this.int16[tt+6]=D,this.int16[tt+7]=P,this.uint16[tt+8]=L,this.uint16[tt+9]=F,this.uint16[tt+10]=$,this.uint16[tt+11]=H,this.uint16[tt+12]=X,this.uint16[tt+13]=J,this.uint16[tt+14]=se,this.uint16[tt+15]=he,this.uint16[tt+16]=De,this.uint16[tt+17]=ve,this.uint16[tt+18]=we,this.uint16[tt+19]=Be,this.uint16[tt+20]=We,this.uint16[tt+21]=lt,this.uint16[tt+22]=Tt,this.uint32[qt+12]=_t,this.float32[qt+13]=xt,this.float32[qt+14]=Ft,this.uint16[tt+30]=St,this.uint16[tt+31]=wt,t}}y.prototype.bytesPerElement=64,Dt("StructArrayLayout8i15ui1ul2f2ui64",y);class w extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}w.prototype.bytesPerElement=4,Dt("StructArrayLayout1f4",w);class E extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const T=3*t;return this.uint16[6*t+0]=a,this.float32[T+1]=h,this.float32[T+2]=g,t}}E.prototype.bytesPerElement=12,Dt("StructArrayLayout1ui2f12",E);class k extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,h)}emplace(t,a,h,g){const T=4*t;return this.uint32[2*t+0]=a,this.uint16[T+2]=h,this.uint16[T+3]=g,t}}k.prototype.bytesPerElement=8,Dt("StructArrayLayout1ul2ui8",k);class I extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const g=2*t;return this.uint16[g+0]=a,this.uint16[g+1]=h,t}}I.prototype.bytesPerElement=4,Dt("StructArrayLayout2ui4",I);class O extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}O.prototype.bytesPerElement=2,Dt("StructArrayLayout1ui2",O);class j extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,h,g)}emplace(t,a,h,g,T){const S=4*t;return this.float32[S+0]=a,this.float32[S+1]=h,this.float32[S+2]=g,this.float32[S+3]=T,t}}j.prototype.bytesPerElement=16,Dt("StructArrayLayout4f16",j);class Z extends fu{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}Z.prototype.size=20;class U extends gu{get(t){return new Z(this,t)}}Dt("CollisionBoxArray",U);class Y extends fu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Y.prototype.size=48;class Q extends f{get(t){return new Y(this,t)}}Dt("PlacedSymbolArray",Q);class le extends fu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}le.prototype.size=64;class oe extends y{get(t){return new le(this,t)}}Dt("SymbolInstanceArray",oe);class ue extends w{getoffsetX(t){return this.float32[1*t+0]}}Dt("GlyphOffsetArray",ue);class de extends Al{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Dt("SymbolLineVertexArray",de);class _e extends fu{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}_e.prototype.size=12;class fe extends E{get(t){return new _e(this,t)}}Dt("TextAnchorOffsetArray",fe);class be extends fu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}be.prototype.size=8;class Se extends k{get(t){return new be(this,t)}}Dt("FeatureIndexArray",Se);class ge extends El{}class ke extends El{}class He extends El{}class Oe extends Ci{}class je extends Zo{}class $e extends $o{}class yt extends Sc{}class vt extends Yo{}class ot extends Is{}class Ot extends mu{}class fn extends Th{}class zn extends e{}class Qn extends o{}class Yn extends I{}const zi=Hi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Di}=zi;class cn{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,h,g){const T=this.segments[this.segments.length-1];return t>cn.MAX_VERTEX_ARRAY_LENGTH&&Xn(`Max vertices per segment is ${cn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${cn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+t>cn.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==g?this.createNewSegment(a,h,g):T}createNewSegment(t,a,h){const g={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return h!==void 0&&(g.sortKey=h),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(t,a,h){return this.prepareSegment(0,t,a,h)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,h,g){return new cn([{vertexOffset:t,primitiveOffset:a,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function Kn(s,t){return 256*(s=Bt(Math.floor(s),0,255))+Bt(Math.floor(t),0,255)}cn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Dt("SegmentVector",cn);const Xi=Hi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var pr,br,_a,Rs={exports:{}},qo={exports:{}},os={exports:{}},Ml=function(){if(_a)return Rs.exports;_a=1;var s=(pr||(pr=1,qo.exports=function(a,h){var g,T,S,A,D,P,L,F;for(T=a.length-(g=3&a.length),S=h,D=3432918353,P=461845907,F=0;F<T;)L=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,S=27492+(65535&(A=5*(65535&(S=(S^=L=(65535&(L=(L=(65535&L)*D+(((L>>>16)*D&65535)<<16)&4294967295)<<15|L>>>17))*P+(((L>>>16)*P&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(L=0,g){case 3:L^=(255&a.charCodeAt(F+2))<<16;case 2:L^=(255&a.charCodeAt(F+1))<<8;case 1:S^=L=(65535&(L=(L=(65535&(L^=255&a.charCodeAt(F)))*D+(((L>>>16)*D&65535)<<16)&4294967295)<<15|L>>>17))*P+(((L>>>16)*P&65535)<<16)&4294967295}return S^=a.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),qo.exports),t=(br||(br=1,os.exports=function(a,h){for(var g,T=a.length,S=h^T,A=0;T>=4;)g=1540483477*(65535&(g=255&a.charCodeAt(A)|(255&a.charCodeAt(++A))<<8|(255&a.charCodeAt(++A))<<16|(255&a.charCodeAt(++A))<<24))+((1540483477*(g>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),T-=4,++A;switch(T){case 3:S^=(255&a.charCodeAt(A+2))<<16;case 2:S^=(255&a.charCodeAt(A+1))<<8;case 1:S=1540483477*(65535&(S^=255&a.charCodeAt(A)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),os.exports);return Rs.exports=s,Rs.exports.murmur3=s,Rs.exports.murmur2=t,Rs.exports}(),Ho=R(Ml);class Cl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,h,g){this.ids.push(Dl(t)),this.positions.push(a,h,g)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Dl(t);let h=0,g=this.ids.length-1;for(;h<g;){const S=h+g>>1;this.ids[S]>=a?g=S:h=S+1}const T=[];for(;this.ids[h]===a;)T.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return T}static serialize(t,a){const h=new Float64Array(t.ids),g=new Uint32Array(t.positions);return jr(h,g,0,h.length-1),a&&a.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(t){const a=new Cl;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function Dl(s){const t=+s;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ho(String(s))}function jr(s,t,a,h){for(;a<h;){const g=s[a+h>>1];let T=a-1,S=h+1;for(;;){do T++;while(s[T]<g);do S--;while(s[S]>g);if(T>=S)break;ls(s,T,S),ls(t,3*T,3*S),ls(t,3*T+1,3*S+1),ls(t,3*T+2,3*S+2)}S-a<h-S?(jr(s,t,a,S),a=S+1):(jr(s,t,S+1,h),h=S)}}function ls(s,t,a){const h=s[t];s[t]=s[a],s[a]=h}Dt("FeaturePositionMap",Cl);class aa{constructor(t,a){this.gl=t.gl,this.location=a}}class kl extends aa{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ki extends aa{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Gi extends aa{constructor(t,a){super(t,a),this.current=yn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const va=new Float32Array(16);function Ni(s){return[Kn(255*s.r,255*s.g),Kn(255*s.b,255*s.a)]}class Il{constructor(t,a,h){this.value=t,this.uniformNames=a.map(g=>`u_${g}`),this.type=h}setUniform(t,a,h){t.set(h.constantOr(this.value))}getBinding(t,a,h){return this.type==="color"?new Gi(t,a):new kl(t,a)}}class Ec{constructor(t,a){this.uniformNames=a.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,h,g){const T=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&t.set(T)}getBinding(t,a,h){return h.substr(0,9)==="u_pattern"?new ki(t,a):new kl(t,a)}}class _o{constructor(t,a,h,g){this.expression=t,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(T=>({name:`a_${T}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,a,h){const g=this.paintVertexArray.length,T=this.expression.evaluate(new $n(0,h),a,{},h.canonical,[],h.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(g,t,T)}updatePaintArray(t,a,h,g,T){const S=this.expression.evaluate(new $n(0,T),h,g);this._setPaintValue(t,a,S)}_setPaintValue(t,a,h){if(this.type==="color"){const g=Ni(h);for(let T=t;T<a;T++)this.paintVertexArray.emplace(T,g[0],g[1])}else{for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sa{constructor(t,a,h,g,T,S){this.expression=t,this.uniformNames=a.map(A=>`u_${A}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=a.map(A=>({name:`a_${A}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(t,a,h){const g=this.expression.evaluate(new $n(this.zoom,h),a,{},h.canonical,[],h.formattedSection),T=this.expression.evaluate(new $n(this.zoom+1,h),a,{},h.canonical,[],h.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,g,T)}updatePaintArray(t,a,h,g,T){const S=this.expression.evaluate(new $n(this.zoom,T),h,g),A=this.expression.evaluate(new $n(this.zoom+1,T),h,g);this._setPaintValue(t,a,S,A)}_setPaintValue(t,a,h,g){if(this.type==="color"){const T=Ni(h),S=Ni(g);for(let A=t;A<a;A++)this.paintVertexArray.emplace(A,T[0],T[1],S[0],S[1])}else{for(let T=t;T<a;T++)this.paintVertexArray.emplace(T,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const h=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,g=Bt(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);t.set(g)}getBinding(t,a,h){return new kl(t,a)}}class Xo{constructor(t,a,h,g,T,S){this.expression=t,this.type=a,this.useIntegerZoom=h,this.zoom=g,this.layerId=S,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(t,a,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,a.patterns&&a.patterns[this.layerId],h.imagePositions)}updatePaintArray(t,a,h,g,T){this._setPaintValues(t,a,h.patterns&&h.patterns[this.layerId],T.imagePositions)}_setPaintValues(t,a,h,g){if(!g||!h)return;const{min:T,mid:S,max:A}=h,D=g[T],P=g[S],L=g[A];if(D&&P&&L)for(let F=t;F<a;F++)this.zoomInPaintVertexArray.emplace(F,P.tl[0],P.tl[1],P.br[0],P.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],P.pixelRatio,D.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,P.tl[0],P.tl[1],P.br[0],P.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],P.pixelRatio,L.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Xi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Xi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Za{constructor(t,a,h){this.binders={},this._buffers=[];const g=[];for(const T in t.paint._values){if(!h(T))continue;const S=t.paint.get(T);if(!(S instanceof ai&&ja(S.property.specification)))continue;const A=Wo(T,t.type),D=S.value,P=S.property.specification.type,L=S.property.useIntegerZoom,F=S.property.specification["property-type"],$=F==="cross-faded"||F==="cross-faded-data-driven";if(D.kind==="constant")this.binders[T]=$?new Ec(D.value,A):new Il(D.value,A,P),g.push(`/u_${T}`);else if(D.kind==="source"||$){const H=zd(T,P,"source");this.binders[T]=$?new Xo(D,P,L,a,H,t.id):new _o(D,A,P,H),g.push(`/a_${T}`)}else{const H=zd(T,P,"composite");this.binders[T]=new sa(D,A,P,L,a,H),g.push(`/z_${T}`)}}this.cacheKey=g.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof _o||a instanceof sa?a.maxValue:0}populatePaintArrays(t,a,h){for(const g in this.binders){const T=this.binders[g];(T instanceof _o||T instanceof sa||T instanceof Xo)&&T.populatePaintArray(t,a,h)}}setConstantPatternPositions(t,a){for(const h in this.binders){const g=this.binders[h];g instanceof Ec&&g.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,h,g,T){let S=!1;for(const A in t){const D=a.getPositions(A);for(const P of D){const L=h.feature(P.index);for(const F in this.binders){const $=this.binders[F];if(($ instanceof _o||$ instanceof sa||$ instanceof Xo)&&$.expression.isStateDependent===!0){const H=g.paint.get(F);$.expression=H.value,$.updatePaintArray(P.start,P.end,L,t[A],T),S=!0}}}}return S}defines(){const t=[];for(const a in this.binders){const h=this.binders[a];(h instanceof Il||h instanceof Ec)&&t.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof _o||h instanceof sa)for(let g=0;g<h.paintVertexAttributes.length;g++)t.push(h.paintVertexAttributes[g].name);else if(h instanceof Xo)for(let g=0;g<Xi.members.length;g++)t.push(Xi.members[g].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Il||h instanceof Ec||h instanceof sa)for(const g of h.uniformNames)t.push(g)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const h=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof Il||T instanceof Ec||T instanceof sa){for(const S of T.uniformNames)if(a[S]){const A=T.getBinding(t,a[S],S);h.push({name:S,property:g,binding:A})}}}return h}setUniforms(t,a,h,g){for(const{name:T,property:S,binding:A}of a)this.binders[S].setUniform(A,g,h.get(S),T)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const h=this.binders[a];if(t&&h instanceof Xo){const g=t.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof _o||h instanceof sa)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(t){for(const a in this.binders){const h=this.binders[a];(h instanceof _o||h instanceof sa||h instanceof Xo)&&h.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof _o||a instanceof sa||a instanceof Xo)&&a.destroy()}}}class Wi{constructor(t,a,h=()=>!0){this.programConfigurations={};for(const g of t)this.programConfigurations[g.id]=new Za(g,a,h);this.needsUpload=!1,this._featureMap=new Cl,this._bufferOffset=0}populatePaintArrays(t,a,h,g){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(t,a,g);a.id!==void 0&&this._featureMap.add(a.id,h,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,h,g){for(const T of h)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(t,this._featureMap,a,T,g)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Wo(s,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${t}-`,"").replace(/-/g,"_")]}function zd(s,t,a){const h={color:{source:$o,composite:j},number:{source:w,composite:$o}},g=function(T){return{"line-pattern":{source:yt,composite:yt},"fill-pattern":{source:yt,composite:yt},"fill-extrusion-pattern":{source:yt,composite:yt}}[T]}(s);return g&&g[a]||h[t][a]}Dt("ConstantBinder",Il),Dt("CrossFadedConstantBinder",Ec),Dt("SourceExpressionBinder",_o),Dt("CrossFadedCompositeBinder",Xo),Dt("CompositeExpressionBinder",sa),Dt("ProgramConfiguration",Za,{omit:["_buffers"]}),Dt("ProgramConfigurationSet",Wi);const Ps=Math.pow(2,14)-1,cs=-Ps-1;function _i(s){const t=kt/s.extent,a=s.loadGeometry();for(let h=0;h<a.length;h++){const g=a[h];for(let T=0;T<g.length;T++){const S=g[T],A=Math.round(S.x*t),D=Math.round(S.y*t);S.x=Bt(A,cs,Ps),S.y=Bt(D,cs,Ps),(A<S.x||A>S.x+1||D<S.y||D>S.y+1)&&Xn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function us(s,t){return{type:s.type,id:s.id,properties:s.properties,geometry:t?_i(s):[]}}const sm=-32768;function Ig(s,t,a,h,g){s.emplaceBack(sm+8*t+h,sm+8*a+g)}class om{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.indexArray=new Qn,this.segments=new cn,this.programConfigurations=new Wi(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){const g=this.layers[0],T=[];let S=null,A=!1,D=g.type==="heatmap";if(g.type==="circle"){const L=g;S=L.layout.get("circle-sort-key"),A=!S.isConstant(),D=D||L.paint.get("circle-pitch-alignment")==="map"}const P=D?a.subdivisionGranularity.circle:1;for(const{feature:L,id:F,index:$,sourceLayerIndex:H}of t){const X=this.layers[0]._featureFilter.needGeometry,J=us(L,X);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{globalState:this.globalState}),J,h))continue;const se=A?S.evaluate(J,{},h):void 0,he={id:F,properties:L.properties,type:L.type,sourceLayerIndex:H,index:$,geometry:X?J.geometry:_i(L),patterns:{},sortKey:se};T.push(he)}A&&T.sort((L,F)=>L.sortKey-F.sortKey);for(const L of T){const{geometry:F,index:$,sourceLayerIndex:H}=L,X=t[$].feature;this.addFeature(L,F,$,h,P),a.featureIndex.insert(X,F,$,H,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Di),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,h,g,T=1){let S;switch(T){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const A=S.length;for(const D of a)for(const P of D){const L=P.x,F=P.y;if(L<0||L>=kt||F<0||F>=kt)continue;const $=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,t.sortKey),H=$.vertexLength;for(let X=0;X<A;X++)for(let J=0;J<A;J++)Ig(this.layoutVertexArray,L,F,S[J],S[X]);for(let X=0;X<A-1;X++)for(let J=0;J<A-1;J++){const se=H+X*A+J,he=H+(X+1)*A+J;this.indexArray.emplaceBack(se,he+1,se+1),this.indexArray.emplaceBack(se,he,he+1)}$.vertexLength+=A*A,$.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:{},canonical:g,globalState:this.globalState})}}function Rg(s,t){for(let a=0;a<s.length;a++)if(Eh(t,s[a]))return!0;for(let a=0;a<t.length;a++)if(Eh(s,t[a]))return!0;return!!lm(s,t)}function Sh(s,t,a){return!!Eh(s,t)||!!Nd(t,s,a)}function $f(s,t){if(s.length===1)return cm(t,s[0]);for(let a=0;a<t.length;a++){const h=t[a];for(let g=0;g<h.length;g++)if(Eh(s,h[g]))return!0}for(let a=0;a<s.length;a++)if(cm(t,s[a]))return!0;for(let a=0;a<t.length;a++)if(lm(s,t[a]))return!0;return!1}function N_(s,t,a){if(s.length>1){if(lm(s,t))return!0;for(let h=0;h<t.length;h++)if(Nd(t[h],s,a))return!0}for(let h=0;h<s.length;h++)if(Nd(s[h],t,a))return!0;return!1}function lm(s,t){if(s.length===0||t.length===0)return!1;for(let a=0;a<s.length-1;a++){const h=s[a],g=s[a+1];for(let T=0;T<t.length-1;T++)if(L_(h,g,t[T],t[T+1]))return!0}return!1}function L_(s,t,a,h){return Rn(s,a,h)!==Rn(t,a,h)&&Rn(s,t,a)!==Rn(s,t,h)}function Nd(s,t,a){const h=a*a;if(t.length===1)return s.distSqr(t[0])<h;for(let g=1;g<t.length;g++)if(Pg(s,t[g-1],t[g])<h)return!0;return!1}function Pg(s,t,a){const h=t.distSqr(a);if(h===0)return s.distSqr(t);const g=((s.x-t.x)*(a.x-t.x)+(s.y-t.y)*(a.y-t.y))/h;return s.distSqr(g<0?t:g>1?a:a.sub(t)._mult(g)._add(t))}function cm(s,t){let a,h,g,T=!1;for(let S=0;S<s.length;S++){a=s[S];for(let A=0,D=a.length-1;A<a.length;D=A++)h=a[A],g=a[D],h.y>t.y!=g.y>t.y&&t.x<(g.x-h.x)*(t.y-h.y)/(g.y-h.y)+h.x&&(T=!T)}return T}function Eh(s,t){let a=!1;for(let h=0,g=s.length-1;h<s.length;g=h++){const T=s[h],S=s[g];T.y>t.y!=S.y>t.y&&t.x<(S.x-T.x)*(t.y-T.y)/(S.y-T.y)+T.x&&(a=!a)}return a}function O_(s,t,a){const h=a[0],g=a[2];if(s.x<h.x&&t.x<h.x||s.x>g.x&&t.x>g.x||s.y<h.y&&t.y<h.y||s.y>g.y&&t.y>g.y)return!1;const T=Rn(s,t,a[0]);return T!==Rn(s,t,a[1])||T!==Rn(s,t,a[2])||T!==Rn(s,t,a[3])}function Yf(s,t,a){const h=t.paint.get(s).value;return h.kind==="constant"?h.value:a.programConfigurations.get(t.id).getMaxValue(s)}function qf(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function xr(s,t,a,h,g){if(!t[0]&&!t[1])return s;const T=C.convert(t)._mult(g);a==="viewport"&&T._rotate(-h);const S=[];for(let A=0;A<s.length;A++)S.push(s[A].sub(T));return S}let oa,zg;Dt("CircleBucket",om,{omit:["layers"]});var j_={get paint(){return zg=zg||new ya({"circle-radius":new Gt(Re.paint_circle["circle-radius"]),"circle-color":new Gt(Re.paint_circle["circle-color"]),"circle-blur":new Gt(Re.paint_circle["circle-blur"]),"circle-opacity":new Gt(Re.paint_circle["circle-opacity"]),"circle-translate":new zt(Re.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(Re.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(Re.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(Re.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gt(Re.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gt(Re.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gt(Re.paint_circle["circle-stroke-opacity"])})},get layout(){return oa=oa||new ya({"circle-sort-key":new Gt(Re.layout_circle["circle-sort-key"])})}};class B_ extends Da{constructor(t){super(t,j_)}createBucket(t){return new om(t)}queryRadius(t){const a=t;return Yf("circle-radius",this,a)+Yf("circle-stroke-width",this,a)+qf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:T,pixelsToTileUnits:S,unwrappedTileID:A,getElevation:D}){const P=xr(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,S),L=this.paint.get("circle-radius").evaluate(a,h)+this.paint.get("circle-stroke-width").evaluate(a,h),F=this.paint.get("circle-pitch-alignment")==="map",$=F?P:function(X,J,se,he){return X.map(De=>Ng(De,J,se,he))}(P,T,A,D),H=F?L*S:L;for(const X of g)for(const J of X){const se=F?J:Ng(J,T,A,D);let he=H;const De=T.projectTileCoordinates(J.x,J.y,A,D).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?he*=De/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(he*=T.cameraToCenterDistance/De),Sh($,se,he))return!0}return!1}}function Ng(s,t,a,h){const g=t.projectTileCoordinates(s.x,s.y,a,h).point;return new C((.5*g.x+.5)*t.width,(.5*-g.y+.5)*t.height)}class Lg extends om{}let Hf;Dt("HeatmapBucket",Lg,{omit:["layers"]});var Og={get paint(){return Hf=Hf||new ya({"heatmap-radius":new Gt(Re.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gt(Re.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(Re.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Go(Re.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(Re.paint_heatmap["heatmap-opacity"])})}};function um(s,{width:t,height:a},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==t*a*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${t*a*h}`)}else g=new Uint8Array(t*a*h);return s.width=t,s.height=a,s.data=g,s}function jg(s,{width:t,height:a},h){if(t===s.width&&a===s.height)return;const g=um({},{width:t,height:a},h);hm(s,g,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,t),height:Math.min(s.height,a)},h),s.width=t,s.height=a,s.data=g.data}function hm(s,t,a,h,g,T){if(g.width===0||g.height===0)return t;if(g.width>s.width||g.height>s.height||a.x>s.width-g.width||a.y>s.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>t.width||g.height>t.height||h.x>t.width-g.width||h.y>t.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const S=s.data,A=t.data;if(S===A)throw new Error("srcData equals dstData, so image is already copied");for(let D=0;D<g.height;D++){const P=((a.y+D)*s.width+a.x)*T,L=((h.y+D)*t.width+h.x)*T;for(let F=0;F<g.width*T;F++)A[L+F]=S[P+F]}return t}class Ah{constructor(t,a){um(this,t,1,a)}resize(t){jg(this,t,1)}clone(){return new Ah({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,g,T){hm(t,a,h,g,T,1)}}class ba{constructor(t,a){um(this,t,4,a)}resize(t){jg(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,g,T){hm(t,a,h,g,T,4)}setPixel(t,a,h){const g=4*(t*this.width+a);this.data[g+0]=Math.round(255*h.r/h.a),this.data[g+1]=Math.round(255*h.g/h.a),this.data[g+2]=Math.round(255*h.b/h.a),this.data[g+3]=Math.round(255*h.a)}}function dm(s){const t={},a=s.resolution||256,h=s.clips?s.clips.length:1,g=s.image||new ba({width:a,height:h});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const T=(S,A,D)=>{t[s.evaluationKey]=D;const P=s.expression.evaluate(t);g.setPixel(S/4/a,A/4,P)};if(s.clips)for(let S=0,A=0;S<h;++S,A+=4*a)for(let D=0,P=0;D<a;D++,P+=4){const L=D/(a-1),{start:F,end:$}=s.clips[S];T(A,P,F*(1-L)+$*L)}else for(let S=0,A=0;S<a;S++,A+=4)T(0,A,S/(a-1));return g}Dt("AlphaImage",Ah),Dt("RGBAImage",ba);const fm="big-fb";class Bg extends Da{createBucket(t){return new Lg(t)}constructor(t){super(t,Og),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=dm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(fm)&&this.heatmapFbos.delete(fm)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xf;var Fg={get paint(){return Xf=Xf||new ya({"hillshade-illumination-direction":new zt(Re.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new zt(Re.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new zt(Re.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(Re.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(Re.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(Re.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(Re.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new zt(Re.paint_hillshade["hillshade-method"])})}};class F_ extends Da{constructor(t){super(t,Fg),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,h=this.paint.get("hillshade-highlight-color").values,g=this.paint.get("hillshade-shadow-color").values;const T=Math.max(t.length,a.length,h.length,g.length);t=t.concat(Array(T-t.length).fill(t.at(-1))),a=a.concat(Array(T-a.length).fill(a.at(-1))),h=h.concat(Array(T-h.length).fill(h.at(-1))),g=g.concat(Array(T-g.length).fill(g.at(-1)));const S=a.map(ws);return{directionRadians:t.map(ws),altitudeRadians:S,shadowColor:g,highlightColor:h}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let pm;var U_={get paint(){return pm=pm||new ya({"color-relief-opacity":new zt(Re["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Go(Re["paint_color-relief"]["color-relief-color"])})}};class Qo{constructor(t,a,h,g){this.context=t,this.format=h,this.texture=t.gl.createTexture(),this.update(a,g)}update(t,a,h){const{width:g,height:T}=t,S=!(this.size&&this.size[0]===g&&this.size[1]===T||h),{context:A}=this,{gl:D}=A;if(this.useMipmap=!!(a&&a.useMipmap),D.bindTexture(D.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===D.RGBA&&(!a||a.premultiply!==!1)),S)this.size=[g,T],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Qa(t)?D.texImage2D(D.TEXTURE_2D,0,this.format,this.format,D.UNSIGNED_BYTE,t):D.texImage2D(D.TEXTURE_2D,0,this.format,g,T,0,this.format,D.UNSIGNED_BYTE,t.data);else{const{x:P,y:L}=h||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Qa(t)?D.texSubImage2D(D.TEXTURE_2D,0,P,L,D.RGBA,D.UNSIGNED_BYTE,t):D.texSubImage2D(D.TEXTURE_2D,0,P,L,g,T,D.RGBA,D.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&D.generateMipmap(D.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,a,h){const{context:g}=this,{gl:T}=g;T.bindTexture(T.TEXTURE_2D,this.texture),h!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=T.LINEAR),t!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,t),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,h||t),this.filter=t),a!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,a),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class mm{constructor(t,a,h,g=1,T=1,S=1,A=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void Xn(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const D=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=T,this.blueFactor=S,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<D;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(D,P)]=this.data[this._idx(D-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,D)]=this.data[this._idx(P,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<D;P++)for(let L=0;L<D;L++){const F=this.get(P,L);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(t,a){const h=new Uint8Array(this.data.buffer),g=4*this._idx(t,a);return this.unpack(h[g],h[g+1],h[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,h){return t*this.redFactor+a*this.greenFactor+h*this.blueFactor-this.baseShift}pack(t){return V_(t,this.getUnpackVector())}getPixels(){return new ba({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,h){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let g=a*this.dim,T=a*this.dim+this.dim,S=h*this.dim,A=h*this.dim+this.dim;switch(a){case-1:g=T-1;break;case 1:T=g+1}switch(h){case-1:S=A-1;break;case 1:A=S+1}const D=-a*this.dim,P=-h*this.dim;for(let L=S;L<A;L++)for(let F=g;F<T;F++)this.data[this._idx(F,L)]=t.data[this._idx(F+D,L+P)]}}function V_(s,t){const a=t[0],h=t[1],g=t[2],T=t[3],S=Math.min(a,h,g),A=Math.round((s+T)/S);return{r:Math.floor(A*S/a)%256,g:Math.floor(A*S/h)%256,b:Math.floor(A*S/g)%256}}Dt("DEMData",mm);class G_ extends Da{constructor(t){super(t,U_)}_createColorRamp(t){const a={elevationStops:[],colorStops:[]},h=this._transitionablePaint._values["color-relief-color"].value.expression;if(h instanceof vl&&h._styleExpression.expression instanceof Or){this.colorRampExpression=h;const S=h._styleExpression.expression;a.elevationStops=S.labels,a.colorStops=[];for(const A of a.elevationStops)a.colorStops.push(S.evaluate({globals:{elevation:A}}))}if(a.elevationStops.length<1&&(a.elevationStops=[0],a.colorStops=[yn.transparent]),a.elevationStops.length<2&&(a.elevationStops.push(a.elevationStops[0]+1),a.colorStops.push(a.colorStops[0])),a.elevationStops.length<=t)return a;const g={elevationStops:[],colorStops:[]},T=(a.elevationStops.length-1)/(t-1);for(let S=0;S<a.elevationStops.length-.5;S+=T)g.elevationStops.push(a.elevationStops[Math.round(S)]),g.colorStops.push(a.colorStops[Math.round(S)]);return Xn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),g}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,a,h){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const g=this._createColorRamp(a),T=new ba({width:g.colorStops.length,height:1}),S=new ba({width:g.colorStops.length,height:1});for(let A=0;A<g.elevationStops.length;A++){const D=V_(g.elevationStops[A],h);S.setPixel(0,A,new yn(D.r/255,D.g/255,D.b/255,1)),T.setPixel(0,A,g.colorStops[A])}return this.colorRampTextures={elevationTexture:new Qo(t,S,t.gl.RGBA),colorTexture:new Qo(t,T,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Ac=Hi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Z_}=Ac;function Ld(s,t,a){const h=a.patternDependencies;let g=!1;for(const T of t){const S=T.paint.get(`${s}-pattern`);S.isConstant()||(g=!0);const A=S.constantOr(null);A&&(g=!0,h[A.to]=!0,h[A.from]=!0)}return g}function Mh(s,t,a,h,g){const{zoom:T,globalState:S}=h,A=g.patternDependencies;for(const D of t){const P=D.paint.get(`${s}-pattern`).value;if(P.kind!=="constant"){let L=P.evaluate({zoom:T-1,globalState:S},a,{},g.availableImages),F=P.evaluate({zoom:T,globalState:S},a,{},g.availableImages),$=P.evaluate({zoom:T+1,globalState:S},a,{},g.availableImages);L=L&&L.name?L.name:L,F=F&&F.name?F.name:F,$=$&&$.name?$.name:$,A[L]=!0,A[F]=!0,A[$]=!0,a.patterns[D.id]={min:L,mid:F,max:$}}}return a}function Qi(s,t,a,h,g){let T;if(g===function(S,A,D,P){let L=0;for(let F=A,$=D-P;F<D;F+=P)L+=(S[$]-S[F])*(S[F+1]+S[$+1]),$=F;return L}(s,t,a,h)>0)for(let S=t;S<a;S+=h)T=H_(S/h|0,s[S],s[S+1],T);else for(let S=a-h;S>=t;S-=h)T=H_(S/h|0,s[S],s[S+1],T);return T&&kh(T,T.next)&&(Bd(T),T=T.next),T}function Ch(s,t){if(!s)return s;t||(t=s);let a,h=s;do if(a=!1,h.steiner||!kh(h,h.next)&&Li(h.prev,h,h.next)!==0)h=h.next;else{if(Bd(h),h=t=h.prev,h===h.next)break;a=!0}while(a||h!==t);return t}function Wf(s,t,a,h,g,T,S){if(!s)return;!S&&T&&function(D,P,L,F){let $=D;do $.z===0&&($.z=gm($.x,$.y,P,L,F)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==D);$.prevZ.nextZ=null,$.prevZ=null,function(H){let X,J=1;do{let se,he=H;H=null;let De=null;for(X=0;he;){X++;let ve=he,we=0;for(let We=0;We<J&&(we++,ve=ve.nextZ,ve);We++);let Be=J;for(;we>0||Be>0&&ve;)we!==0&&(Be===0||!ve||he.z<=ve.z)?(se=he,he=he.nextZ,we--):(se=ve,ve=ve.nextZ,Be--),De?De.nextZ=se:H=se,se.prevZ=De,De=se;he=ve}De.nextZ=null,J*=2}while(X>1)}($)}(s,h,g,T);let A=s;for(;s.prev!==s.next;){const D=s.prev,P=s.next;if(T?Qf(s,h,g,T):$_(s))t.push(D.i,s.i,P.i),Bd(s),s=P.next,A=P.next;else if((s=P)===A){S?S===1?Wf(s=yu(Ch(s),t),t,a,h,g,T,2):S===2&&Y_(s,t,a,h,g,T):Wf(Ch(s),t,a,h,g,T,1);break}}}function $_(s){const t=s.prev,a=s,h=s.next;if(Li(t,a,h)>=0)return!1;const g=t.x,T=a.x,S=h.x,A=t.y,D=a.y,P=h.y,L=Math.min(g,T,S),F=Math.min(A,D,P),$=Math.max(g,T,S),H=Math.max(A,D,P);let X=h.next;for(;X!==t;){if(X.x>=L&&X.x<=$&&X.y>=F&&X.y<=H&&Dh(g,A,T,D,S,P,X.x,X.y)&&Li(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function Qf(s,t,a,h){const g=s.prev,T=s,S=s.next;if(Li(g,T,S)>=0)return!1;const A=g.x,D=T.x,P=S.x,L=g.y,F=T.y,$=S.y,H=Math.min(A,D,P),X=Math.min(L,F,$),J=Math.max(A,D,P),se=Math.max(L,F,$),he=gm(H,X,t,a,h),De=gm(J,se,t,a,h);let ve=s.prevZ,we=s.nextZ;for(;ve&&ve.z>=he&&we&&we.z<=De;){if(ve.x>=H&&ve.x<=J&&ve.y>=X&&ve.y<=se&&ve!==g&&ve!==S&&Dh(A,L,D,F,P,$,ve.x,ve.y)&&Li(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,we.x>=H&&we.x<=J&&we.y>=X&&we.y<=se&&we!==g&&we!==S&&Dh(A,L,D,F,P,$,we.x,we.y)&&Li(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;ve&&ve.z>=he;){if(ve.x>=H&&ve.x<=J&&ve.y>=X&&ve.y<=se&&ve!==g&&ve!==S&&Dh(A,L,D,F,P,$,ve.x,ve.y)&&Li(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;we&&we.z<=De;){if(we.x>=H&&we.x<=J&&we.y>=X&&we.y<=se&&we!==g&&we!==S&&Dh(A,L,D,F,P,$,we.x,we.y)&&Li(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function yu(s,t){let a=s;do{const h=a.prev,g=a.next.next;!kh(h,g)&&Pl(h,a,a.next,g)&&jd(h,g)&&jd(g,h)&&(t.push(h.i,a.i,g.i),Bd(a),Bd(a.next),a=s=g),a=a.next}while(a!==s);return Ch(a)}function Y_(s,t,a,h,g,T){let S=s;do{let A=S.next.next;for(;A!==S.prev;){if(S.i!==A.i&&Gg(S,A)){let D=Br(S,A);return S=Ch(S,S.next),D=Ch(D,D.next),Wf(S,t,a,h,g,T,0),void Wf(D,t,a,h,g,T,0)}A=A.next}S=S.next}while(S!==s)}function q_(s,t){let a=s.x-t.x;return a===0&&(a=s.y-t.y,a===0)&&(a=(s.next.y-s.y)/(s.next.x-s.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function Kf(s,t){const a=function(g,T){let S=T;const A=g.x,D=g.y;let P,L=-1/0;if(kh(g,S))return S;do{if(kh(g,S.next))return S.next;if(D<=S.y&&D>=S.next.y&&S.next.y!==S.y){const J=S.x+(D-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(J<=A&&J>L&&(L=J,P=S.x<S.next.x?S:S.next,J===A))return P}S=S.next}while(S!==T);if(!P)return null;const F=P,$=P.x,H=P.y;let X=1/0;S=P;do{if(A>=S.x&&S.x>=$&&A!==S.x&&Vg(D<H?A:L,D,$,H,D<H?L:A,D,S.x,S.y)){const J=Math.abs(D-S.y)/(A-S.x);jd(S,g)&&(J<X||J===X&&(S.x>P.x||S.x===P.x&&Rl(P,S)))&&(P=S,X=J)}S=S.next}while(S!==F);return P}(s,t);if(!a)return t;const h=Br(a,s);return Ch(h,h.next),Ch(a,a.next)}function Rl(s,t){return Li(s.prev,s,t.prev)<0&&Li(t.next,s,s.next)<0}function gm(s,t,a,h,g){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-h)*g|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ug(s){let t=s,a=s;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==s);return a}function Vg(s,t,a,h,g,T,S,A){return(g-S)*(t-A)>=(s-S)*(T-A)&&(s-S)*(h-A)>=(a-S)*(t-A)&&(a-S)*(T-A)>=(g-S)*(h-A)}function Dh(s,t,a,h,g,T,S,A){return!(s===S&&t===A)&&Vg(s,t,a,h,g,T,S,A)}function Gg(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!function(a,h){let g=a;do{if(g.i!==a.i&&g.next.i!==a.i&&g.i!==h.i&&g.next.i!==h.i&&Pl(g,g.next,a,h))return!0;g=g.next}while(g!==a);return!1}(s,t)&&(jd(s,t)&&jd(t,s)&&function(a,h){let g=a,T=!1;const S=(a.x+h.x)/2,A=(a.y+h.y)/2;do g.y>A!=g.next.y>A&&g.next.y!==g.y&&S<(g.next.x-g.x)*(A-g.y)/(g.next.y-g.y)+g.x&&(T=!T),g=g.next;while(g!==a);return T}(s,t)&&(Li(s.prev,s,t.prev)||Li(s,t.prev,t))||kh(s,t)&&Li(s.prev,s,s.next)>0&&Li(t.prev,t,t.next)>0)}function Li(s,t,a){return(t.y-s.y)*(a.x-t.x)-(t.x-s.x)*(a.y-t.y)}function kh(s,t){return s.x===t.x&&s.y===t.y}function Pl(s,t,a,h){const g=Od(Li(s,t,a)),T=Od(Li(s,t,h)),S=Od(Li(a,h,s)),A=Od(Li(a,h,t));return g!==T&&S!==A||!(g!==0||!Ki(s,a,t))||!(T!==0||!Ki(s,h,t))||!(S!==0||!Ki(a,s,h))||!(A!==0||!Ki(a,t,h))}function Ki(s,t,a){return t.x<=Math.max(s.x,a.x)&&t.x>=Math.min(s.x,a.x)&&t.y<=Math.max(s.y,a.y)&&t.y>=Math.min(s.y,a.y)}function Od(s){return s>0?1:s<0?-1:0}function jd(s,t){return Li(s.prev,s,s.next)<0?Li(s,t,s.next)>=0&&Li(s,s.prev,t)>=0:Li(s,t,s.prev)<0||Li(s,s.next,t)<0}function Br(s,t){const a=ym(s.i,s.x,s.y),h=ym(t.i,t.x,t.y),g=s.next,T=t.prev;return s.next=t,t.prev=s,a.next=g,g.prev=a,h.next=a,a.prev=h,T.next=h,h.prev=T,h}function H_(s,t,a,h){const g=ym(s,t,a);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function Bd(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function ym(s,t,a){return{i:s,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class di{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class xa{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}xa.noSubdivision=new xa({fill:new di(0,0),line:new di(0,0),tile:new di(0,0),stencil:new di(0,0),circle:1}),Dt("SubdivisionGranularityExpression",di),Dt("SubdivisionGranularitySetting",xa);const hs=-32768,Fd=32767;class X_{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=kt/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|a+32768}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const h=0|Math.round(t),g=0|Math.round(a),T=this._getKey(h,g);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,S),this._vertexBuffer.push(h,g),S}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(g,T){const S=[];for(let A=0;A<T.length;A+=3){const D=T[A],P=T[A+1],L=T[A+2],F=g[2*D],$=g[2*D+1];(g[2*P]-F)*(g[2*L+1]-$)-(g[2*P+1]-$)*(g[2*L]-F)>0?(S.push(D),S.push(L),S.push(P)):(S.push(D),S.push(P),S.push(L))}return S}(this._vertexBuffer,t);const a=[],h=t.length;for(let g=0;g<h;g+=3){const T=[t[g+0],t[g+1],t[g+2]],S=[this._vertexBuffer[2*t[g+0]+0],this._vertexBuffer[2*t[g+0]+1],this._vertexBuffer[2*t[g+1]+0],this._vertexBuffer[2*t[g+1]+1],this._vertexBuffer[2*t[g+2]+0],this._vertexBuffer[2*t[g+2]+1]];let A=1/0,D=1/0,P=-1/0,L=-1/0;for(let J=0;J<3;J++){const se=S[2*J],he=S[2*J+1];A=Math.min(A,se),P=Math.max(P,se),D=Math.min(D,he),L=Math.max(L,he)}if(A===P||D===L)continue;const F=Math.floor(A/this._granularityCellSize),$=Math.ceil(P/this._granularityCellSize),H=Math.floor(D/this._granularityCellSize),X=Math.ceil(L/this._granularityCellSize);if(F!==$||H!==X)for(let J=H;J<X;J++){const se=this._scanlineGenerateVertexRingForCellRow(J,S,T);zs(this._vertexBuffer,se,a)}else a.push(...T)}return a}_scanlineGenerateVertexRingForCellRow(t,a,h){const g=t*this._granularityCellSize,T=g+this._granularityCellSize,S=[];for(let A=0;A<3;A++){const D=a[2*A],P=a[2*A+1],L=a[2*(A+1)%6],F=a[(2*(A+1)+1)%6],$=a[2*(A+2)%6],H=a[(2*(A+2)+1)%6],X=L-D,J=F-P,se=X===0,he=J===0,De=(g-P)/J,ve=(T-P)/J,we=Math.min(De,ve),Be=Math.max(De,ve);if(!he&&(we>=1||Be<=0)||he&&(P<g||P>T)){F>=g&&F<=T&&S.push(h[(A+1)%3]);continue}!he&&we>0&&S.push(this._vertexToIndex(D+X*we,P+J*we));const We=D+X*Math.max(we,0),lt=D+X*Math.min(Be,1);se||this._generateIntraEdgeVertices(S,D,P,L,F,We,lt),!he&&Be<1&&S.push(this._vertexToIndex(D+X*Be,P+J*Be)),(he||F>=g&&F<=T)&&S.push(h[(A+1)%3]),!he&&(F<=g||F>=T)&&this._generateInterEdgeVertices(S,D,P,L,F,$,H,lt,g,T)}return S}_generateIntraEdgeVertices(t,a,h,g,T,S,A){const D=g-a,P=T-h,L=P===0,F=L?Math.min(a,g):Math.min(S,A),$=L?Math.max(a,g):Math.max(S,A),H=Math.floor(F/this._granularityCellSize)+1,X=Math.ceil($/this._granularityCellSize)-1;if(L?a<g:S<A)for(let J=H;J<=X;J++){const se=J*this._granularityCellSize;t.push(this._vertexToIndex(se,h+P*(se-a)/D))}else for(let J=X;J>=H;J--){const se=J*this._granularityCellSize;t.push(this._vertexToIndex(se,h+P*(se-a)/D))}}_generateInterEdgeVertices(t,a,h,g,T,S,A,D,P,L){const F=T-h,$=S-g,H=A-T,X=(P-T)/H,J=(L-T)/H,se=Math.min(X,J),he=Math.max(X,J),De=g+$*se;let ve=Math.floor(Math.min(De,D)/this._granularityCellSize)+1,we=Math.ceil(Math.max(De,D)/this._granularityCellSize)-1,Be=D<De;const We=H===0;if(We&&(A===P||A===L))return;if(We||se>=1||he<=0){const Tt=h-A,_t=S+(a-S)*Math.min((P-A)/Tt,(L-A)/Tt);ve=Math.floor(Math.min(_t,D)/this._granularityCellSize)+1,we=Math.ceil(Math.max(_t,D)/this._granularityCellSize)-1,Be=D<_t}const lt=F>0?L:P;if(Be)for(let Tt=ve;Tt<=we;Tt++)t.push(this._vertexToIndex(Tt*this._granularityCellSize,lt));else for(let Tt=we;Tt>=ve;Tt--)t.push(this._vertexToIndex(Tt*this._granularityCellSize,lt))}_generateOutline(t){const a=[];for(const h of t){const g=Mc(h,this._granularity,!0),T=this._pointArrayToIndices(g),S=[];for(let A=1;A<T.length;A++)S.push(T[A-1]),S.push(T[A]);a.push(S)}return a}_handlePoles(t){let a=!1,h=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(h=!0)),(a||h)&&this._fillPoles(t,a,h)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const h=t[a+1];h===hs&&(t[a+1]=-32767),h===Fd&&(t[a+1]=32766)}}_generatePoleQuad(t,a,h,g,T,S){g>T!=(S===hs)?(t.push(a),t.push(h),t.push(this._vertexToIndex(g,S)),t.push(h),t.push(this._vertexToIndex(T,S)),t.push(this._vertexToIndex(g,S))):(t.push(h),t.push(a),t.push(this._vertexToIndex(g,S)),t.push(this._vertexToIndex(T,S)),t.push(h),t.push(this._vertexToIndex(g,S)))}_fillPoles(t,a,h){const g=this._vertexBuffer,T=kt,S=t.length;for(let A=2;A<S;A+=3){const D=t[A-2],P=t[A-1],L=t[A],F=g[2*D],$=g[2*D+1],H=g[2*P],X=g[2*P+1],J=g[2*L],se=g[2*L+1];a&&($===0&&X===0&&this._generatePoleQuad(t,D,P,F,H,hs),X===0&&se===0&&this._generatePoleQuad(t,P,L,H,J,hs),se===0&&$===0&&this._generatePoleQuad(t,L,D,J,F,hs)),h&&($===T&&X===T&&this._generatePoleQuad(t,D,P,F,H,Fd),X===T&&se===T&&this._generatePoleQuad(t,P,L,H,J,Fd),se===T&&$===T&&this._generatePoleQuad(t,L,D,J,F,Fd))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:h,holeIndices:g}=function(A){const D=[],P=[];for(const L of A)if(L.length!==0){L!==A[0]&&D.push(P.length/2);for(let F=0;F<L.length;F++)P.push(L[F].x),P.push(L[F].y)}return{flattened:P,holeIndices:D}}(t);let T;this._initializeVertices(h);try{const A=function(P,L,F=2){const $=L&&L.length,H=$?L[0]*F:P.length;let X=Qi(P,0,H,F,!0);const J=[];if(!X||X.next===X.prev)return J;let se,he,De;if($&&(X=function(ve,we,Be,We){const lt=[];for(let Tt=0,_t=we.length;Tt<_t;Tt++){const xt=Qi(ve,we[Tt]*We,Tt<_t-1?we[Tt+1]*We:ve.length,We,!1);xt===xt.next&&(xt.steiner=!0),lt.push(Ug(xt))}lt.sort(q_);for(let Tt=0;Tt<lt.length;Tt++)Be=Kf(lt[Tt],Be);return Be}(P,L,X,F)),P.length>80*F){se=P[0],he=P[1];let ve=se,we=he;for(let Be=F;Be<H;Be+=F){const We=P[Be],lt=P[Be+1];We<se&&(se=We),lt<he&&(he=lt),We>ve&&(ve=We),lt>we&&(we=lt)}De=Math.max(ve-se,we-he),De=De!==0?32767/De:0}return Wf(X,J,F,se,he,De,0),J}(h,g),D=this._convertIndices(h,A);T=this._subdivideTrianglesScanline(D)}catch(A){console.error(A)}let S=[];return a&&(S=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:S}}_convertIndices(t,a){const h=[];for(let g=0;g<a.length;g++)h.push(this._vertexToIndex(t[2*a[g]],t[2*a[g]+1]));return h}_pointArrayToIndices(t){const a=[];for(let h=0;h<t.length;h++){const g=t[h];a.push(this._vertexToIndex(g.x,g.y))}return a}}function W_(s,t,a,h=!0){return new X_(a,t).subdividePolygonInternal(s,h)}function Mc(s,t,a=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const h=s[0],g=s[s.length-1],T=a&&(h.x!==g.x||h.y!==g.y);if(t<2)return T?[...s,s[0]]:[...s];const S=Math.floor(kt/t),A=[];A.push(new C(s[0].x,s[0].y));const D=s.length,P=T?D:D-1;for(let L=0;L<P;L++){const F=s[L],$=L<D-1?s[L+1]:s[0],H=F.x,X=F.y,J=$.x,se=$.y,he=H!==J,De=X!==se;if(!he&&!De)continue;const ve=J-H,we=se-X,Be=Math.abs(ve),We=Math.abs(we);let lt=H,Tt=X;for(;;){const xt=ve>0?(Math.floor(lt/S)+1)*S:(Math.ceil(lt/S)-1)*S,Ft=we>0?(Math.floor(Tt/S)+1)*S:(Math.ceil(Tt/S)-1)*S,St=Math.abs(lt-xt),wt=Math.abs(Tt-Ft),tt=Math.abs(lt-J),qt=Math.abs(Tt-se),Kt=he?St/Be:Number.POSITIVE_INFINITY,Zt=De?wt/We:Number.POSITIVE_INFINITY;if((tt<=St||!he)&&(qt<=wt||!De))break;if(Kt<Zt&&he||!De){lt=xt,Tt+=we*Kt;const Nt=new C(lt,Math.round(Tt));A[A.length-1].x===Nt.x&&A[A.length-1].y===Nt.y||A.push(Nt)}else{lt+=ve*Zt,Tt=Ft;const Nt=new C(Math.round(lt),Tt);A[A.length-1].x===Nt.x&&A[A.length-1].y===Nt.y||A.push(Nt)}}const _t=new C(J,se);A[A.length-1].x===_t.x&&A[A.length-1].y===_t.y||A.push(_t)}return A}function zs(s,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let h=0,g=s[2*t[0]];for(let D=1;D<t.length;D++){const P=s[2*t[D]];P<g&&(g=P,h=D)}const T=t.length;let S=h,A=(S+1)%T;for(;;){const D=S-1>=0?S-1:T-1,P=(A+1)%T,L=s[2*t[D]],F=s[2*t[P]],$=s[2*t[S]],H=s[2*t[S]+1],X=s[2*t[A]+1];let J=!1;if(L<F)J=!0;else if(L>F)J=!1;else{const se=X-H,he=-(s[2*t[A]]-$),De=H<X?1:-1;((L-$)*se+(s[2*t[D]+1]-H)*he)*De>((F-$)*se+(s[2*t[P]+1]-H)*he)*De&&(J=!0)}if(J){const se=t[D],he=t[S],De=t[A];se!==he&&se!==De&&he!==De&&a.push(De,he,se),S--,S<0&&(S=T-1)}else{const se=t[P],he=t[S],De=t[A];se!==he&&se!==De&&he!==De&&a.push(De,he,se),A++,A>=T&&(A=0)}if(D===P)break}}function vo(s,t,a,h,g,T,S,A,D){const P=g.length/2,L=S&&A&&D;if(P<cn.MAX_VERTEX_ARRAY_LENGTH){const F=t.prepareSegment(P,a,h),$=F.vertexLength;for(let J=0;J<T.length;J+=3)h.emplaceBack($+T[J],$+T[J+1],$+T[J+2]);let H,X;F.vertexLength+=P,F.primitiveLength+=T.length/3,L&&(X=S.prepareSegment(P,a,A),H=X.vertexLength,X.vertexLength+=P);for(let J=0;J<g.length;J+=2)s(g[J],g[J+1]);if(L)for(let J=0;J<D.length;J++){const se=D[J];for(let he=1;he<se.length;he+=2)A.emplaceBack(H+se[he-1],H+se[he]);X.primitiveLength+=se.length/2}}else(function(F,$,H,X,J,se){const he=[];for(let We=0;We<X.length/2;We++)he.push(-1);const De={count:0};let ve=0,we=F.getOrCreateLatestSegment($,H),Be=we.vertexLength;for(let We=2;We<J.length;We+=3){const lt=J[We-2],Tt=J[We-1],_t=J[We];let xt=he[lt]<ve,Ft=he[Tt]<ve,St=he[_t]<ve;we.vertexLength+((xt?1:0)+(Ft?1:0)+(St?1:0))>cn.MAX_VERTEX_ARRAY_LENGTH&&(we=F.createNewSegment($,H),ve=De.count,xt=!0,Ft=!0,St=!0,Be=0);const wt=Ud(he,X,se,De,lt,xt,we),tt=Ud(he,X,se,De,Tt,Ft,we),qt=Ud(he,X,se,De,_t,St,we);H.emplaceBack(Be+wt-ve,Be+tt-ve,Be+qt-ve),we.primitiveLength++}})(t,a,h,g,T,s),L&&function(F,$,H,X,J,se){const he=[];for(let We=0;We<X.length/2;We++)he.push(-1);const De={count:0};let ve=0,we=F.getOrCreateLatestSegment($,H),Be=we.vertexLength;for(let We=0;We<J.length;We++){const lt=J[We];for(let Tt=1;Tt<J[We].length;Tt+=2){const _t=lt[Tt-1],xt=lt[Tt];let Ft=he[_t]<ve,St=he[xt]<ve;we.vertexLength+((Ft?1:0)+(St?1:0))>cn.MAX_VERTEX_ARRAY_LENGTH&&(we=F.createNewSegment($,H),ve=De.count,Ft=!0,St=!0,Be=0);const wt=Ud(he,X,se,De,_t,Ft,we),tt=Ud(he,X,se,De,xt,St,we);H.emplaceBack(Be+wt-ve,Be+tt-ve),we.primitiveLength++}}}(S,a,A,g,D,s),t.forceNewSegmentOnNextPrepare(),S?.forceNewSegmentOnNextPrepare()}function Ud(s,t,a,h,g,T,S){if(T){const A=h.count;return a(t[2*g],t[2*g+1]),s[g]=h.count,h.count++,S.vertexLength++,A}return s[g]}class $a{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new He,this.indexArray=new Qn,this.indexArray2=new Yn,this.programConfigurations=new Wi(t.layers,t.zoom),this.segments=new cn,this.segments2=new cn,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=Ld("fill",this.layers,a);const g=this.layers[0].layout.get("fill-sort-key"),T=!g.isConstant(),S=[];for(const{feature:A,id:D,index:P,sourceLayerIndex:L}of t){const F=this.layers[0]._featureFilter.needGeometry,$=us(A,F);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{globalState:this.globalState}),$,h))continue;const H=T?g.evaluate($,{},h,a.availableImages):void 0,X={id:D,properties:A.properties,type:A.type,sourceLayerIndex:L,index:P,geometry:F?$.geometry:_i(A),patterns:{},sortKey:H};S.push(X)}T&&S.sort((A,D)=>A.sortKey-D.sortKey);for(const A of S){const{geometry:D,index:P,sourceLayerIndex:L}=A;if(this.hasPattern){const F=Mh("fill",this.layers,A,{zoom:this.zoom,globalState:this.globalState},a);this.patternFeatures.push(F)}else this.addFeature(A,D,P,h,{},a.subdivisionGranularity);a.featureIndex.insert(t[P].feature,D,P,L,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h,globalState:this.globalState})}addFeatures(t,a,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,a,h,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Z_),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,h,g,T,S){for(const A of Jc(a,500)){const D=W_(A,g,S.fill.getGranularityForZoomLevel(g.z)),P=this.layoutVertexArray;vo((L,F)=>{P.emplaceBack(L,F)},this.segments,this.layoutVertexArray,this.indexArray,D.verticesFlattened,D.indicesTriangles,this.segments2,this.indexArray2,D.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:T,canonical:g,globalState:this.globalState})}}let Zg,Cc;Dt("FillBucket",$a,{omit:["layers","patternFeatures"]});var Ih={get paint(){return Cc=Cc||new ya({"fill-antialias":new zt(Re.paint_fill["fill-antialias"]),"fill-opacity":new Gt(Re.paint_fill["fill-opacity"]),"fill-color":new Gt(Re.paint_fill["fill-color"]),"fill-outline-color":new Gt(Re.paint_fill["fill-outline-color"]),"fill-translate":new zt(Re.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(Re.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tc(Re.paint_fill["fill-pattern"])})},get layout(){return Zg=Zg||new ya({"fill-sort-key":new Gt(Re.layout_fill["fill-sort-key"])})}};class _u extends Da{constructor(t){super(t,Ih)}recalculate(t,a){super.recalculate(t,a);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new $a(t)}queryRadius(){return qf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:h,pixelsToTileUnits:g}){return $f(xr(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-h.bearingInRadians,g),a)}isTileClipped(){return!0}}const $g=Hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Yg=Hi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:zl}=$g;class Rh{constructor(t,a,h,g,T){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=g,this._values=T,t.readFields(Vd,this,a)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const a=t.readVarint()+t.pos,h=[];let g,T=1,S=0,A=0,D=0;for(;t.pos<a;){if(S<=0){const P=t.readVarint();T=7&P,S=P>>3}if(S--,T===1||T===2)A+=t.readSVarint(),D+=t.readSVarint(),T===1&&(g&&h.push(g),g=[]),g&&g.push(new C(A,D));else{if(T!==7)throw new Error(`unknown command ${T}`);g&&g.push(g[0].clone())}}return g&&h.push(g),h}bbox(){const t=this._pbf;t.pos=this._geometry;const a=t.readVarint()+t.pos;let h=1,g=0,T=0,S=0,A=1/0,D=-1/0,P=1/0,L=-1/0;for(;t.pos<a;){if(g<=0){const F=t.readVarint();h=7&F,g=F>>3}if(g--,h===1||h===2)T+=t.readSVarint(),S+=t.readSVarint(),T<A&&(A=T),T>D&&(D=T),S<P&&(P=S),S>L&&(L=S);else if(h!==7)throw new Error(`unknown command ${h}`)}return[A,P,D,L]}toGeoJSON(t,a,h){const g=this.extent*Math.pow(2,h),T=this.extent*t,S=this.extent*a,A=this.loadGeometry();function D($){return[360*($.x+T)/g-180,360/Math.PI*Math.atan(Math.exp((1-2*($.y+S)/g)*Math.PI))-90]}function P($){return $.map(D)}let L;if(this.type===1){const $=[];for(const X of A)$.push(X[0]);const H=P($);L=$.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const $=A.map(P);L=$.length===1?{type:"LineString",coordinates:$[0]}:{type:"MultiLineString",coordinates:$}}else{if(this.type!==3)throw new Error("unknown feature type");{const $=function(X){const J=X.length;if(J<=1)return[X];const se=[];let he,De;for(let ve=0;ve<J;ve++){const we=Jf(X[ve]);we!==0&&(De===void 0&&(De=we<0),De===we<0?(he&&se.push(he),he=[X[ve]]):he&&he.push(X[ve]))}return he&&se.push(he),se}(A),H=[];for(const X of $)H.push(X.map(P));L=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const F={type:"Feature",geometry:L,properties:this.properties};return this.id!=null&&(F.id=this.id),F}}function Vd(s,t,a){s===1?t.id=a.readVarint():s===2?function(h,g){const T=h.readVarint()+h.pos;for(;h.pos<T;){const S=g._keys[h.readVarint()],A=g._values[h.readVarint()];g.properties[S]=A}}(a,t):s===3?t.type=a.readVarint():s===4&&(t._geometry=a.pos)}function Jf(s){let t=0;for(let a,h,g=0,T=s.length,S=T-1;g<T;S=g++)a=s[g],h=s[S],t+=(h.x-a.x)*(a.y+h.y);return t}Rh.types=["Unknown","Point","LineString","Polygon"];class Gd{constructor(t,a){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Zd,this,a),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const a=this._pbf.readVarint()+this._pbf.pos;return new Rh(this._pbf,a,this.extent,this._keys,this._values)}}function Zd(s,t,a){s===15?t.version=a.readVarint():s===1?t.name=a.readString():s===5?t.extent=a.readVarint():s===2?t._features.push(a.pos):s===3?t._keys.push(a.readString()):s===4&&t._values.push(function(h){let g=null;const T=h.readVarint()+h.pos;for(;h.pos<T;){const S=h.readVarint()>>3;g=S===1?h.readString():S===2?h.readFloat():S===3?h.readDouble():S===4?h.readVarint64():S===5?h.readVarint():S===6?h.readSVarint():S===7?h.readBoolean():null}if(g==null)throw new Error("unknown feature value");return g}(a))}class qg{constructor(t,a){this.layers=t.readFields(Q_,{},a)}}function Q_(s,t,a){if(s===3){const h=new Gd(a,a.readVarint()+a.pos);h.length&&(t[h.name]=h)}}const Ph=Math.pow(2,13);function $d(s,t,a,h,g,T,S,A){s.emplaceBack(t,a,2*Math.floor(h*Ph)+S,g*Ph*2,T*Ph*2,Math.round(A))}class Yd{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Oe,this.centroidVertexArray=new ge,this.indexArray=new Qn,this.programConfigurations=new Wi(t.layers,t.zoom),this.segments=new cn,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.features=[],this.hasPattern=Ld("fill-extrusion",this.layers,a);for(const{feature:g,id:T,index:S,sourceLayerIndex:A}of t){const D=this.layers[0]._featureFilter.needGeometry,P=us(g,D);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{globalState:this.globalState}),P,h))continue;const L={id:T,sourceLayerIndex:A,index:S,geometry:D?P.geometry:_i(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Mh("fill-extrusion",this.layers,L,{zoom:this.zoom,globalState:this.globalState},a)):this.addFeature(L,L.geometry,S,h,{},a.subdivisionGranularity),a.featureIndex.insert(g,L.geometry,S,A,this.index,!0)}}addFeatures(t,a,h){for(const g of this.features){const{geometry:T}=g;this.addFeature(g,T,g.index,a,h,t.subdivisionGranularity)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zl),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Yg.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,h,g,T,S){for(const A of Jc(a,500)){const D={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(D,g,t,A,S);const L=this.layoutVertexArray.length-P,F=Math.floor(D.x/D.sampleCount),$=Math.floor(D.y/D.sampleCount);for(let H=0;H<L;H++)this.centroidVertexArray.emplaceBack(F,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:T,canonical:g,globalState:this.globalState})}processPolygon(t,a,h,g,T){if(g.length<1||J_(g[0]))return;for(const F of g)F.length!==0&&K_(t,F);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=T.fill.getGranularityForZoomLevel(a.z),D=Rh.types[h.type]==="Polygon";for(const F of g){if(F.length===0||J_(F))continue;const $=Mc(F,A,D);this._generateSideFaces($,S)}if(!D)return;const P=W_(g,a,A,!1),L=this.layoutVertexArray;vo((F,$)=>{$d(L,F,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(t,a){let h=0;for(let g=1;g<t.length;g++){const T=t[g],S=t[g-1];if(Rv(T,S))continue;a.segment.vertexLength+4>cn.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=T.sub(S)._perp()._unit(),D=S.dist(T);h+D>32768&&(h=0),$d(this.layoutVertexArray,T.x,T.y,A.x,A.y,0,0,h),$d(this.layoutVertexArray,T.x,T.y,A.x,A.y,0,1,h),h+=D,$d(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,0,h),$d(this.layoutVertexArray,S.x,S.y,A.x,A.y,0,1,h);const P=a.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function K_(s,t){for(let a=0;a<t.length;a++){const h=t[a];a===t.length-1&&t[0].x===h.x&&t[0].y===h.y||(s.x+=h.x,s.y+=h.y,s.sampleCount++)}}function Rv(s,t){return s.x===t.x&&(s.x<0||s.x>kt)||s.y===t.y&&(s.y<0||s.y>kt)}function J_(s){return s.every(t=>t.x<0)||s.every(t=>t.x>kt)||s.every(t=>t.y<0)||s.every(t=>t.y>kt)}let ui;Dt("FillExtrusionBucket",Yd,{omit:["layers","features"]});var Oi={get paint(){return ui=ui||new ya({"fill-extrusion-opacity":new zt(Re["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gt(Re["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(Re["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(Re["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tc(Re["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Gt(Re["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gt(Re["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zt(Re["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Nn extends Da{constructor(t){super(t,Oi)}createBucket(t){return new Yd(t)}queryRadius(){return qf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:T,pixelsToTileUnits:S,pixelPosMatrix:A}){const D=xr(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,S),P=this.paint.get("fill-extrusion-height").evaluate(a,h),L=this.paint.get("fill-extrusion-base").evaluate(a,h),F=function(H,X){const J=[];for(const se of H){const he=[se.x,se.y,0,1];en(he,he,X),J.push(new C(he[0]/he[3],he[1]/he[3]))}return J}(D,A),$=function(H,X,J,se){const he=[],De=[],ve=se[8]*X,we=se[9]*X,Be=se[10]*X,We=se[11]*X,lt=se[8]*J,Tt=se[9]*J,_t=se[10]*J,xt=se[11]*J;for(const Ft of H){const St=[],wt=[];for(const tt of Ft){const qt=tt.x,Kt=tt.y,Zt=se[0]*qt+se[4]*Kt+se[12],Nt=se[1]*qt+se[5]*Kt+se[13],pn=se[2]*qt+se[6]*Kt+se[14],Jn=se[3]*qt+se[7]*Kt+se[15],bi=pn+Be,mr=Jn+We,Ta=Zt+lt,gr=Nt+Tt,Ur=pn+_t,Ii=Jn+xt,Ji=new C((Zt+ve)/mr,(Nt+we)/mr);Ji.z=bi/mr,St.push(Ji);const Vr=new C(Ta/Ii,gr/Ii);Vr.z=Ur/Ii,wt.push(Vr)}he.push(St),De.push(wt)}return[he,De]}(g,L,P,A);return function(H,X,J){let se=1/0;$f(J,X)&&(se=hi(J,X[0]));for(let he=0;he<X.length;he++){const De=X[he],ve=H[he];for(let we=0;we<De.length-1;we++){const Be=De[we],We=[Be,De[we+1],ve[we+1],ve[we],Be];Rg(J,We)&&(se=Math.min(se,hi(J,We)))}}return se!==1/0&&se}($[0],$[1],F)}}function Dn(s,t){return s.x*t.x+s.y*t.y}function hi(s,t){if(s.length===1){let a=0;const h=t[a++];let g;for(;!g||h.equals(g);)if(g=t[a++],!g)return 1/0;for(;a<t.length;a++){const T=t[a],S=s[0],A=g.sub(h),D=T.sub(h),P=S.sub(h),L=Dn(A,A),F=Dn(A,D),$=Dn(D,D),H=Dn(P,A),X=Dn(P,D),J=L*$-F*F,se=($*H-F*X)/J,he=(L*X-F*H)/J,De=h.z*(1-se-he)+g.z*se+T.z*he;if(isFinite(De))return De}return 1/0}{let a=1/0;for(const h of t)a=Math.min(a,h.z);return a}}const Ns=Hi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:vu}=Ns,qd=Hi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Hg}=qd,Dc=Math.cos(Math.PI/180*37.5),or=Math.pow(2,14)/.5;class Nl{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new je,this.layoutVertexArray2=new $e,this.indexArray=new Qn,this.programConfigurations=new Wi(t.layers,t.zoom),this.segments=new cn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=Ld("line",this.layers,a);const g=this.layers[0].layout.get("line-sort-key"),T=!g.isConstant(),S=[];for(const{feature:A,id:D,index:P,sourceLayerIndex:L}of t){const F=this.layers[0]._featureFilter.needGeometry,$=us(A,F);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{globalState:this.globalState}),$,h))continue;const H=T?g.evaluate($,{},h):void 0,X={id:D,properties:A.properties,type:A.type,sourceLayerIndex:L,index:P,geometry:F?$.geometry:_i(A),patterns:{},sortKey:H};S.push(X)}T&&S.sort((A,D)=>A.sortKey-D.sortKey);for(const A of S){const{geometry:D,index:P,sourceLayerIndex:L}=A;if(this.hasPattern){const F=Mh("line",this.layers,A,{zoom:this.zoom,globalState:this.globalState},a);this.patternFeatures.push(F)}else this.addFeature(A,D,P,h,{},a.subdivisionGranularity);a.featureIndex.insert(t[P].feature,D,P,L,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:h,globalState:this.globalState})}addFeatures(t,a,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,a,h,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Hg)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vu),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,h,g,T,S){const A=this.layers[0].layout,D=A.get("line-join").evaluate(t,{}),P=A.get("line-cap"),L=A.get("line-miter-limit"),F=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const $ of a)this.addLine($,t,D,P,L,F,g,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{imagePositions:T,canonical:g,globalState:this.globalState})}addLine(t,a,h,g,T,S,A,D){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Mc(t,A?D.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<t.length-1;ve++)this.totalDistance+=t[ve].dist(t[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=Rh.types[a.type]==="Polygon";let L=t.length;for(;L>=2&&t[L-1].equals(t[L-2]);)L--;let F=0;for(;F<L-1&&t[F].equals(t[F+1]);)F++;if(L<(P?3:2))return;h==="bevel"&&(T=1.05);const $=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let X,J,se,he,De;this.e1=this.e2=-1,P&&(X=t[L-2],De=t[F].sub(X)._unit()._perp());for(let ve=F;ve<L;ve++){if(se=ve===L-1?P?t[F+1]:void 0:t[ve+1],se&&t[ve].equals(se))continue;De&&(he=De),X&&(J=X),X=t[ve],De=se?se.sub(X)._unit()._perp():he,he=he||De;let we=he.add(De);we.x===0&&we.y===0||we._unit();const Be=he.x*De.x+he.y*De.y,We=we.x*De.x+we.y*De.y,lt=We!==0?1/We:1/0,Tt=2*Math.sqrt(2-2*We),_t=We<Dc&&J&&se,xt=he.x*De.y-he.y*De.x>0;if(_t&&ve>F){const wt=X.dist(J);if(wt>2*$){const tt=X.sub(X.sub(J)._mult($/wt)._round());this.updateDistance(J,tt),this.addCurrentVertex(tt,he,0,0,H),J=tt}}const Ft=J&&se;let St=Ft?h:P?"butt":g;if(Ft&&St==="round"&&(lt<S?St="miter":lt<=2&&(St="fakeround")),St==="miter"&&lt>T&&(St="bevel"),St==="bevel"&&(lt>2&&(St="flipbevel"),lt<T&&(St="miter")),J&&this.updateDistance(J,X),St==="miter")we._mult(lt),this.addCurrentVertex(X,we,0,0,H);else if(St==="flipbevel"){if(lt>100)we=De.mult(-1);else{const wt=lt*he.add(De).mag()/he.sub(De).mag();we._perp()._mult(wt*(xt?-1:1))}this.addCurrentVertex(X,we,0,0,H),this.addCurrentVertex(X,we.mult(-1),0,0,H)}else if(St==="bevel"||St==="fakeround"){const wt=-Math.sqrt(lt*lt-1),tt=xt?wt:0,qt=xt?0:wt;if(J&&this.addCurrentVertex(X,he,tt,qt,H),St==="fakeround"){const Kt=Math.round(180*Tt/Math.PI/20);for(let Zt=1;Zt<Kt;Zt++){let Nt=Zt/Kt;if(Nt!==.5){const Jn=Nt-.5;Nt+=Nt*Jn*(Nt-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*Jn*Jn+(.848013+Be*(.215638*Be-1.06021)))}const pn=De.sub(he)._mult(Nt)._add(he)._unit()._mult(xt?-1:1);this.addHalfVertex(X,pn.x,pn.y,!1,xt,0,H)}}se&&this.addCurrentVertex(X,De,-tt,-qt,H)}else if(St==="butt")this.addCurrentVertex(X,we,0,0,H);else if(St==="square"){const wt=J?1:-1;this.addCurrentVertex(X,we,wt,wt,H)}else St==="round"&&(J&&(this.addCurrentVertex(X,he,0,0,H),this.addCurrentVertex(X,he,1,1,H,!0)),se&&(this.addCurrentVertex(X,De,-1,-1,H,!0),this.addCurrentVertex(X,De,0,0,H)));if(_t&&ve<L-1){const wt=X.dist(se);if(wt>2*$){const tt=X.add(se.sub(X)._mult($/wt)._round());this.updateDistance(X,tt),this.addCurrentVertex(tt,De,0,0,H),X=tt}}}}addCurrentVertex(t,a,h,g,T,S=!1){const A=a.y*g-a.x,D=-a.y-a.x*g;this.addHalfVertex(t,a.x+a.y*h,a.y-a.x*h,S,!1,h,T),this.addHalfVertex(t,A,D,S,!0,-g,T),this.distance>or/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,h,g,T,S))}addHalfVertex({x:t,y:a},h,g,T,S,A,D){const P=.5*(this.lineClips?this.scaledDistance*(or-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(T?1:0),(a<<1)+(S?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(A===0?0:A<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,L,this.e2),D.primitiveLength++),S?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let bu,_m;Dt("LineBucket",Nl,{omit:["layers","patternFeatures"]});var Ls={get paint(){return _m=_m||new ya({"line-opacity":new Gt(Re.paint_line["line-opacity"]),"line-color":new Gt(Re.paint_line["line-color"]),"line-translate":new zt(Re.paint_line["line-translate"]),"line-translate-anchor":new zt(Re.paint_line["line-translate-anchor"]),"line-width":new Gt(Re.paint_line["line-width"]),"line-gap-width":new Gt(Re.paint_line["line-gap-width"]),"line-offset":new Gt(Re.paint_line["line-offset"]),"line-blur":new Gt(Re.paint_line["line-blur"]),"line-dasharray":new ss(Re.paint_line["line-dasharray"]),"line-pattern":new Tc(Re.paint_line["line-pattern"]),"line-gradient":new Go(Re.paint_line["line-gradient"])})},get layout(){return bu=bu||new ya({"line-cap":new zt(Re.layout_line["line-cap"]),"line-join":new Gt(Re.layout_line["line-join"]),"line-miter-limit":new zt(Re.layout_line["line-miter-limit"]),"line-round-limit":new zt(Re.layout_line["line-round-limit"]),"line-sort-key":new Gt(Re.layout_line["line-sort-key"])})}};class Hd extends Gt{possiblyEvaluate(t,a){return a=new $n(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,h,g){return a=mn({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,h,g)}}let xu;class ds extends Da{constructor(t){super(t,Ls),this.gradientVersion=0,xu||(xu=new Hd(Ls.paint.properties["line-width"].specification),xu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(h){return h._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Yi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=xu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Nl(t)}queryRadius(t){const a=t,h=vm(Yf("line-width",this,a),Yf("line-gap-width",this,a)),g=Yf("line-offset",this,a);return h/2+Math.abs(g)+qf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:h,geometry:g,transform:T,pixelsToTileUnits:S}){const A=xr(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,S),D=S/2*vm(this.paint.get("line-width").evaluate(a,h),this.paint.get("line-gap-width").evaluate(a,h)),P=this.paint.get("line-offset").evaluate(a,h);return P&&(g=function(L,F){const $=[];for(let H=0;H<L.length;H++){const X=L[H],J=[];for(let se=0;se<X.length;se++){const he=X[se-1],De=X[se],ve=X[se+1],we=se===0?new C(0,0):De.sub(he)._unit()._perp(),Be=se===X.length-1?new C(0,0):ve.sub(De)._unit()._perp(),We=we._add(Be)._unit(),lt=We.x*Be.x+We.y*Be.y;lt!==0&&We._mult(1/lt),J.push(We._mult(F)._add(De))}$.push(J)}return $}(g,P*S)),function(L,F,$){for(let H=0;H<F.length;H++){const X=F[H];if(L.length>=3){for(let J=0;J<X.length;J++)if(Eh(L,X[J]))return!0}if(N_(L,X,$))return!0}return!1}(A,g,D)}isTileClipped(){return!0}}function vm(s,t){return t>0?t+2*s:s}const Xg=Hi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bm=Hi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Hi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const xm=Hi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Hi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kc=Hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wa=Hi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function wu(s,t,a){return s.sections.forEach(h=>{h.text=function(g,T,S){const A=T.layout.get("text-transform").evaluate(S,{});return A==="uppercase"?g=g.toLocaleUpperCase():A==="lowercase"&&(g=g.toLocaleLowerCase()),ia.applyArabicShaping&&(g=ia.applyArabicShaping(g)),g}(h.text,t,a)}),s}Hi([{name:"triangle",components:3,type:"Uint16"}]),Hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Hi([{type:"Float32",name:"offsetX"}]),Hi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Hi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ll={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Zi=24;const ep=4294967296,wm=1/ep,Wg=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class zh{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,a,h=this.length){for(;this.pos<h;){const g=this.readVarint(),T=g>>3,S=this.pos;this.type=7&g,t(T,a,this),this.pos===S&&this.skip(g)}return a}readMessage(t,a){return this.readFields(t,a,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*ep;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*ep;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const a=this.buf;let h,g;return g=a[this.pos++],h=127&g,g<128?h:(g=a[this.pos++],h|=(127&g)<<7,g<128?h:(g=a[this.pos++],h|=(127&g)<<14,g<128?h:(g=a[this.pos++],h|=(127&g)<<21,g<128?h:(g=a[this.pos],h|=(15&g)<<28,function(T,S,A){const D=A.buf;let P,L;if(L=D[A.pos++],P=(112&L)>>4,L<128||(L=D[A.pos++],P|=(127&L)<<3,L<128)||(L=D[A.pos++],P|=(127&L)<<10,L<128)||(L=D[A.pos++],P|=(127&L)<<17,L<128)||(L=D[A.pos++],P|=(127&L)<<24,L<128)||(L=D[A.pos++],P|=(1&L)<<31,L<128))return Tu(T,P,S);throw new Error("Expected varint not more than 10 bytes")}(h,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,a=this.pos;return this.pos=t,t-a>=12&&Wg?Wg.decode(this.buf.subarray(a,t)):function(h,g,T){let S="",A=g;for(;A<T;){const D=h[A];let P,L,F,$=null,H=D>239?4:D>223?3:D>191?2:1;if(A+H>T)break;H===1?D<128&&($=D):H===2?(P=h[A+1],(192&P)==128&&($=(31&D)<<6|63&P,$<=127&&($=null))):H===3?(P=h[A+1],L=h[A+2],(192&P)==128&&(192&L)==128&&($=(15&D)<<12|(63&P)<<6|63&L,($<=2047||$>=55296&&$<=57343)&&($=null))):H===4&&(P=h[A+1],L=h[A+2],F=h[A+3],(192&P)==128&&(192&L)==128&&(192&F)==128&&($=(15&D)<<18|(63&P)<<12|(63&L)<<6|63&F,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,H=1):$>65535&&($-=65536,S+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),S+=String.fromCharCode($),A+=H}return S}(this.buf,a,t)}readBytes(){const t=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,t);return this.pos=t,a}readPackedVarint(t=[],a){const h=this.readPackedEnd();for(;this.pos<h;)t.push(this.readVarint(a));return t}readPackedSVarint(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const a=7&t;if(a===0)for(;this.buf[this.pos++]>127;);else if(a===2)this.pos=this.readVarint()+this.pos;else if(a===5)this.pos+=4;else{if(a!==1)throw new Error(`Unimplemented type: ${a}`);this.pos+=8}}writeTag(t,a){this.writeVarint(t<<3|a)}realloc(t){let a=this.length||16;for(;a<this.pos+t;)a*=2;if(a!==this.length){const h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.dataView=new DataView(h.buffer),this.length=a}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*wm),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*wm),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?function(a,h){let g,T;if(a>=0?(g=a%4294967296|0,T=a/4294967296|0):(g=~(-a%4294967296),T=~(-a/4294967296),4294967295^g?g=g+1|0:(g=0,T=T+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(S,A,D){D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,S>>>=7,D.buf[D.pos++]=127&S|128,D.buf[D.pos]=127&(S>>>=7)}(g,0,h),function(S,A){const D=(7&S)<<4;A.buf[A.pos++]|=D|((S>>>=3)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S|((S>>>=7)?128:0),S&&(A.buf[A.pos++]=127&S)))))}(T,h)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const a=this.pos;this.pos=function(g,T,S){for(let A,D,P=0;P<T.length;P++){if(A=T.charCodeAt(P),A>55295&&A<57344){if(!D){A>56319||P+1===T.length?(g[S++]=239,g[S++]=191,g[S++]=189):D=A;continue}if(A<56320){g[S++]=239,g[S++]=191,g[S++]=189,D=A;continue}A=D-55296<<10|A-56320|65536,D=null}else D&&(g[S++]=239,g[S++]=191,g[S++]=189,D=null);A<128?g[S++]=A:(A<2048?g[S++]=A>>6|192:(A<65536?g[S++]=A>>12|224:(g[S++]=A>>18|240,g[S++]=A>>12&63|128),g[S++]=A>>6&63|128),g[S++]=63&A|128)}return S}(this.buf,t,this.pos);const h=this.pos-a;h>=128&&fs(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const a=t.length;this.writeVarint(a),this.realloc(a);for(let h=0;h<a;h++)this.buf[this.pos++]=t[h]}writeRawMessage(t,a){this.pos++;const h=this.pos;t(a,this);const g=this.pos-h;g>=128&&fs(h,g,this),this.pos=h-1,this.writeVarint(g),this.pos+=g}writeMessage(t,a,h){this.writeTag(t,2),this.writeRawMessage(a,h)}writePackedVarint(t,a){a.length&&this.writeMessage(t,e0,a)}writePackedSVarint(t,a){a.length&&this.writeMessage(t,Os,a)}writePackedBoolean(t,a){a.length&&this.writeMessage(t,Pv,a)}writePackedFloat(t,a){a.length&&this.writeMessage(t,t0,a)}writePackedDouble(t,a){a.length&&this.writeMessage(t,n0,a)}writePackedFixed32(t,a){a.length&&this.writeMessage(t,Su,a)}writePackedSFixed32(t,a){a.length&&this.writeMessage(t,Tm,a)}writePackedFixed64(t,a){a.length&&this.writeMessage(t,Qg,a)}writePackedSFixed64(t,a){a.length&&this.writeMessage(t,Xd,a)}writeBytesField(t,a){this.writeTag(t,2),this.writeBytes(a)}writeFixed32Field(t,a){this.writeTag(t,5),this.writeFixed32(a)}writeSFixed32Field(t,a){this.writeTag(t,5),this.writeSFixed32(a)}writeFixed64Field(t,a){this.writeTag(t,1),this.writeFixed64(a)}writeSFixed64Field(t,a){this.writeTag(t,1),this.writeSFixed64(a)}writeVarintField(t,a){this.writeTag(t,0),this.writeVarint(a)}writeSVarintField(t,a){this.writeTag(t,0),this.writeSVarint(a)}writeStringField(t,a){this.writeTag(t,2),this.writeString(a)}writeFloatField(t,a){this.writeTag(t,5),this.writeFloat(a)}writeDoubleField(t,a){this.writeTag(t,1),this.writeDouble(a)}writeBooleanField(t,a){this.writeVarintField(t,+a)}}function Tu(s,t,a){return a?4294967296*t+(s>>>0):4294967296*(t>>>0)+(s>>>0)}function fs(s,t,a){const h=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(h);for(let g=a.pos-1;g>=s;g--)a.buf[g+h]=a.buf[g]}function e0(s,t){for(let a=0;a<s.length;a++)t.writeVarint(s[a])}function Os(s,t){for(let a=0;a<s.length;a++)t.writeSVarint(s[a])}function t0(s,t){for(let a=0;a<s.length;a++)t.writeFloat(s[a])}function n0(s,t){for(let a=0;a<s.length;a++)t.writeDouble(s[a])}function Pv(s,t){for(let a=0;a<s.length;a++)t.writeBoolean(s[a])}function Su(s,t){for(let a=0;a<s.length;a++)t.writeFixed32(s[a])}function Tm(s,t){for(let a=0;a<s.length;a++)t.writeSFixed32(s[a])}function Qg(s,t){for(let a=0;a<s.length;a++)t.writeFixed64(s[a])}function Xd(s,t){for(let a=0;a<s.length;a++)t.writeSFixed64(s[a])}function i0(s,t,a){s===1&&a.readMessage(r0,t)}function r0(s,t,a){if(s===3){const{id:h,bitmap:g,width:T,height:S,left:A,top:D,advance:P}=a.readMessage(a0,{});t.push({id:h,bitmap:new Ah({width:T+6,height:S+6},g),metrics:{width:T,height:S,left:A,top:D,advance:P}})}}function a0(s,t,a){s===1?t.id=a.readVarint():s===2?t.bitmap=a.readBytes():s===3?t.width=a.readVarint():s===4?t.height=a.readVarint():s===5?t.left=a.readSVarint():s===6?t.top=a.readSVarint():s===7&&(t.advance=a.readVarint())}function Sm(s){let t=0,a=0;for(const S of s)t+=S.w*S.h,a=Math.max(a,S.w);s.sort((S,A)=>A.h-S.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let g=0,T=0;for(const S of s)for(let A=h.length-1;A>=0;A--){const D=h[A];if(!(S.w>D.w||S.h>D.h)){if(S.x=D.x,S.y=D.y,T=Math.max(T,S.y+S.h),g=Math.max(g,S.x+S.w),S.w===D.w&&S.h===D.h){const P=h.pop();P&&A<h.length&&(h[A]=P)}else S.h===D.h?(D.x+=S.w,D.w-=S.w):S.w===D.w?(D.y+=S.h,D.h-=S.h):(h.push({x:D.x+S.w,y:D.y,w:D.w-S.w,h:S.h}),D.y+=S.h,D.h-=S.h);break}}return{w:g,h:T,fill:t/(g*T)||0}}class tp{constructor(t,{pixelRatio:a,version:h,stretchX:g,stretchY:T,content:S,textFitWidth:A,textFitHeight:D}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=g,this.stretchY=T,this.content=S,this.version=h,this.textFitWidth=A,this.textFitHeight=D}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class s0{constructor(t,a){const h={},g={};this.haveRenderCallbacks=[];const T=[];this.addImages(t,h,T),this.addImages(a,g,T);const{w:S,h:A}=Sm(T),D=new ba({width:S||1,height:A||1});for(const P in t){const L=t[P],F=h[P].paddedRect;ba.copy(L.data,D,{x:0,y:0},{x:F.x+1,y:F.y+1},L.data)}for(const P in a){const L=a[P],F=g[P].paddedRect,$=F.x+1,H=F.y+1,X=L.data.width,J=L.data.height;ba.copy(L.data,D,{x:0,y:0},{x:$,y:H},L.data),ba.copy(L.data,D,{x:0,y:J-1},{x:$,y:H-1},{width:X,height:1}),ba.copy(L.data,D,{x:0,y:0},{x:$,y:H+J},{width:X,height:1}),ba.copy(L.data,D,{x:X-1,y:0},{x:$-1,y:H},{width:1,height:J}),ba.copy(L.data,D,{x:0,y:0},{x:$+X,y:H},{width:1,height:J})}this.image=D,this.iconPositions=h,this.patternPositions=g}addImages(t,a,h){for(const g in t){const T=t[g],S={x:0,y:0,w:T.data.width+2,h:T.data.height+2};h.push(S),a[g]=new tp(S,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in t.updatedImages)this.patchUpdatedImage(this.iconPositions[h],t.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],t.getImage(h),a)}patchUpdatedImage(t,a,h){if(!t||!a||t.version===a.version)return;t.version=a.version;const[g,T]=t.tl;h.update(a.data,void 0,{x:g,y:T})}}var Eu;Dt("ImagePosition",tp),Dt("ImageAtlas",s0),v.ao=void 0,(Eu=v.ao||(v.ao={}))[Eu.none=0]="none",Eu[Eu.horizontal=1]="horizontal",Eu[Eu.vertical=2]="vertical",Eu[Eu.horizontalOnly=3]="horizontalOnly";class np{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,h){const g=new np;return g.scale=t||1,g.fontStack=a,g.verticalAlign=h||"bottom",g}static forImage(t,a){const h=new np;return h.imageName=t,h.verticalAlign=a||"bottom",h}}class Nh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const h=new Nh;for(let g=0;g<t.sections.length;g++){const T=t.sections[g];T.image?h.addImageSection(T):h.addTextSection(T,a)}return h}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let h=0;h<t.length;h++){const g=t.charCodeAt(h+1)||null,T=t.charCodeAt(h-1)||null;a+=g&&Rd(g)&&!Ll[t[h+1]]||T&&Rd(T)&&!Ll[t[h-1]]||!Ll[t[h]]?t[h]:Ll[t[h]]}return a}(this.text)}trim(){let t=0;for(let h=0;h<this.text.length&&Ic[this.text.charCodeAt(h)];h++)t++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=t&&Ic[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const h=new Nh;return h.text=this.text.substring(t,a),h.sectionIndex=this.sectionIndex.slice(t,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}getMaxImageSize(t){let a=0,h=0;for(let g=0;g<this.length();g++){const T=this.getSection(g);if(T.imageName){const S=t[T.imageName];if(!S)continue;const A=S.displaySize;a=Math.max(a,A[0]),h=Math.max(h,A[1])}}return{maxImageWidth:a,maxImageHeight:h}}addTextSection(t,a){this.text+=t.text,this.sections.push(np.forText(t.scale,t.fontStack||a,t.verticalAlign));const h=this.sections.length-1;for(let g=0;g<t.text.length;++g)this.sectionIndex.push(h)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void Xn("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(np.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Xn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ip(s,t,a,h,g,T,S,A,D,P,L,F,$,H,X){const J=Nh.fromFeature(s,g);let se;F===v.ao.vertical&&J.verticalizePunctuation();const{processBidirectionalText:he,processStyledBidirectionalText:De}=ia;if(he&&J.sections.length===1){se=[];const Be=he(J.toString(),Wd(J,P,T,t,h,H));for(const We of Be){const lt=new Nh;lt.text=We,lt.sections=J.sections;for(let Tt=0;Tt<We.length;Tt++)lt.sectionIndex.push(0);se.push(lt)}}else if(De){se=[];const Be=De(J.text,J.sectionIndex,Wd(J,P,T,t,h,H));for(const We of Be){const lt=new Nh;lt.text=We[0],lt.sectionIndex=We[1],lt.sections=J.sections,se.push(lt)}}else se=function(Be,We){const lt=[],Tt=Be.text;let _t=0;for(const xt of We)lt.push(Be.substring(_t,xt)),_t=xt;return _t<Tt.length&&lt.push(Be.substring(_t,Tt.length)),lt}(J,Wd(J,P,T,t,h,H));const ve=[],we={positionedLines:ve,text:J.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(Be,We,lt,Tt,_t,xt,Ft,St,wt,tt,qt,Kt){let Zt=0,Nt=0,pn=0,Jn=0;const bi=St==="right"?1:St==="left"?0:.5,mr=Zi/Kt;let Ta=0;for(const Ii of _t){Ii.trim();const Ji=Ii.getMaxScale(),Vr={positionedGlyphs:[],lineOffset:0};Be.positionedLines[Ta]=Vr;const Dr=Vr.positionedGlyphs;let Gr=0;if(!Ii.length()){Nt+=xt,++Ta;continue}const ms=c0(Tt,Ii,mr);for(let la=0;la<Ii.length();la++){const er=Ii.getSection(la),wr=Ii.getSectionIndex(la),tr=Ii.getCharCode(la),nr=ny(wt,qt,tr);let si;if(er.imageName){if(Be.iconsInText=!0,er.scale=er.scale*mr,si=u0(er,nr,Ji,ms,Tt),!si)continue;Gr=Math.max(Gr,si.imageOffset)}else if(si=zv(er,tr,nr,ms,We,lt),!si)continue;const{rect:bo,metrics:nf,baselineOffset:gs}=si;Dr.push({glyph:tr,imageName:er.imageName,x:Zt,y:Nt+gs+-17,vertical:nr,scale:er.scale,fontStack:er.fontStack,sectionIndex:wr,metrics:nf,rect:bo}),nr?(Be.verticalizable=!0,Zt+=(er.imageName?nf.advance:Zi)*er.scale+tt):Zt+=nf.advance*er.scale+tt}Dr.length!==0&&(pn=Math.max(Zt-tt,pn),Nv(Dr,0,Dr.length-1,bi)),Zt=0,Vr.lineOffset=Math.max(Gr,(Ji-1)*Zi);const kr=xt*Ji+Gr;Nt+=kr,Jn=Math.max(kr,Jn),++Ta}const{horizontalAlign:gr,verticalAlign:Ur}=Am(Ft);(function(Ii,Ji,Vr,Dr,Gr,ms,kr,la,er){const wr=(Ji-Vr)*Gr;let tr=0;tr=ms!==kr?-la*Dr- -17:-Dr*er*kr+.5*kr;for(const nr of Ii)for(const si of nr.positionedGlyphs)si.x+=wr,si.y+=tr})(Be.positionedLines,bi,gr,Ur,pn,Jn,xt,Nt,_t.length),Be.top+=-Ur*Nt,Be.bottom=Be.top+Nt,Be.left+=-gr*pn,Be.right=Be.left+pn}(we,t,a,h,se,S,A,D,F,P,$,X),!function(Be){for(const We of Be)if(We.positionedGlyphs.length!==0)return!1;return!0}(ve)&&we}const Ic={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Em={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},o0={40:!0};function Kg(s,t,a,h,g,T){if(t.imageName){const S=h[t.imageName];return S?S.displaySize[0]*t.scale*Zi/T+g:0}{const S=a[t.fontStack],A=S&&S[s];return A?A.metrics.advance*t.scale+g:0}}function Jg(s,t,a,h){const g=Math.pow(s-t,2);return h?s<t?g/2:2*g:g+Math.abs(a)*a}function l0(s,t,a){let h=0;return s===10&&(h-=1e4),a&&(h+=150),s!==40&&s!==65288||(h+=50),t!==41&&t!==65289||(h+=50),h}function ey(s,t,a,h,g,T){let S=null,A=Jg(t,a,g,T);for(const D of h){const P=Jg(t-D.x,a,g,T)+D.badness;P<=A&&(S=D,A=P)}return{index:s,x:t,priorBreak:S,badness:A}}function ty(s){return s?ty(s.priorBreak).concat(s.index):[]}function Wd(s,t,a,h,g,T){if(!s)return[];const S=[],A=function(F,$,H,X,J,se){let he=0;for(let De=0;De<F.length();De++){const ve=F.getSection(De);he+=Kg(F.getCharCode(De),ve,X,J,$,se)}return he/Math.max(1,Math.ceil(he/H))}(s,t,a,h,g,T),D=s.text.indexOf("")>=0;let P=0;for(let F=0;F<s.length();F++){const $=s.getSection(F),H=s.getCharCode(F);if(Ic[H]||(P+=Kg(H,$,h,g,t,T)),F<s.length()-1){const X=!((L=H)<11904)&&(!!En["CJK Compatibility Forms"](L)||!!En["CJK Compatibility"](L)||!!En["CJK Strokes"](L)||!!En["CJK Symbols and Punctuation"](L)||!!En["Enclosed CJK Letters and Months"](L)||!!En["Halfwidth and Fullwidth Forms"](L)||!!En["Ideographic Description Characters"](L)||!!En["Vertical Forms"](L)||vc.test(String.fromCodePoint(L)));(Em[H]||X||$.imageName||F!==s.length()-2&&o0[s.getCharCode(F+1)])&&S.push(ey(F+1,P,A,S,l0(H,s.getCharCode(F+1),X&&D),!1))}}var L;return ty(ey(s.length(),P,A,S,0,!0))}function Am(s){let t=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function c0(s,t,a){const h=t.getMaxScale()*Zi,{maxImageWidth:g,maxImageHeight:T}=t.getMaxImageSize(s),S=Math.max(h,T*a);return{verticalLineContentWidth:Math.max(h,g*a),horizontalLineContentHeight:S}}function vi(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function ny(s,t,a){return!(s===v.ao.horizontal||!t&&!xh(a)||t&&(Ic[a]||(h=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(h)))));var h}function zv(s,t,a,h,g,T){const S=T[s.fontStack],A=function(P,L,F,$){if(P&&P.rect)return P;const H=L[F.fontStack],X=H&&H[$];return X?{rect:null,metrics:X.metrics}:null}(S&&S[t],g,s,t);if(A===null)return null;let D;if(a)D=h.verticalLineContentWidth-s.scale*Zi;else{const P=vi(s.verticalAlign);D=(h.horizontalLineContentHeight-s.scale*Zi)*P}return{rect:A.rect,metrics:A.metrics,baselineOffset:D}}function u0(s,t,a,h,g){const T=g[s.imageName];if(!T)return null;const S=T.paddedRect,A=T.displaySize,D={width:A[0],height:A[1],left:1,top:-3,advance:t?A[1]:A[0]};let P;if(t)P=h.verticalLineContentWidth-A[1]*s.scale;else{const L=vi(s.verticalAlign);P=(h.horizontalLineContentHeight-A[1]*s.scale)*L}return{rect:S,metrics:D,baselineOffset:P,imageOffset:(t?A[0]:A[1])*s.scale-Zi*a}}function Nv(s,t,a,h){if(h===0)return;const g=s[a],T=(s[a].x+g.metrics.advance*g.scale)*h;for(let S=t;S<=a;S++)s[S].x-=T}function Lv(s,t,a){const{horizontalAlign:h,verticalAlign:g}=Am(a),T=t[0]-s.displaySize[0]*h,S=t[1]-s.displaySize[1]*g;return{image:s,top:S,bottom:S+s.displaySize[1],left:T,right:T+s.displaySize[0]}}function h0(s){var t,a;let h=s.left,g=s.top,T=s.right-h,S=s.bottom-g;const A=(t=s.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",D=(a=s.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",P=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(D==="proportional"){if(A==="stretchOnly"&&T/S<P||A==="proportional"){const L=Math.ceil(S*P);h*=L/T,T=L}}else if(A==="proportional"&&D==="stretchOnly"&&P!==0&&T/S>P){const L=Math.ceil(T/P);g*=L/S,S=L}return{x1:h,y1:g,x2:h+T,y2:g+S}}function rp(s,t,a,h,g,T){const S=s.image;let A;if(S.content){const se=S.content,he=S.pixelRatio||1;A=[se[0]/he,se[1]/he,S.displaySize[0]-se[2]/he,S.displaySize[1]-se[3]/he]}const D=t.left*T,P=t.right*T;let L,F,$,H;a==="width"||a==="both"?(H=g[0]+D-h[3],F=g[0]+P+h[1]):(H=g[0]+(D+P-S.displaySize[0])/2,F=H+S.displaySize[0]);const X=t.top*T,J=t.bottom*T;return a==="height"||a==="both"?(L=g[1]+X-h[0],$=g[1]+J+h[2]):(L=g[1]+(X+J-S.displaySize[1])/2,$=L+S.displaySize[1]),{image:S,top:L,right:F,bottom:$,left:H,collisionPadding:A}}const ps=128,Ol=32640;function ap(s,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new $n(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=a;let T=0;for(;T<h.length&&h[T]<=s;)T++;T=Math.max(0,T-1);let S=T;for(;S<h.length&&h[S]<s+1;)S++;S=Math.min(h.length-1,S);const A=h[T],D=h[S];return a.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:D,interpolationType:g}:{kind:"camera",minZoom:A,maxZoom:D,minSize:a.evaluate(new $n(A)),maxSize:a.evaluate(new $n(D)),interpolationType:g}}}function sp(s,t,a){let h="never";const g=s.get(t);return g?h=g:s.get(a)&&(h="always"),h}const Lh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function js(s,t,a,h,g,T,S,A,D,P,L,F,$){const H=A?Math.min(Ol,Math.round(A[0])):0,X=A?Math.min(Ol,Math.round(A[1])):0;s.emplaceBack(t,a,Math.round(32*h),Math.round(32*g),T,S,(H<<1)+(D?1:0),X,16*P,16*L,256*F,256*$)}function Oh(s,t,a){s.emplaceBack(t.x,t.y,a),s.emplaceBack(t.x,t.y,a),s.emplaceBack(t.x,t.y,a),s.emplaceBack(t.x,t.y,a)}function Ov(s){for(const t of s.sections)if(Gf(t.text))return!0;return!1}class Mm{constructor(t){this.layoutVertexArray=new vt,this.indexArray=new Qn,this.programConfigurations=t,this.segments=new cn,this.dynamicLayoutVertexArray=new ot,this.opacityVertexArray=new Ot,this.hasVisibleVertices=!1,this.placedSymbolArray=new Q}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xg.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,bm.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Lh,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Dt("SymbolBuffers",Mm);class Cm{constructor(t,a,h){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new h,this.segments=new cn,this.collisionVertexArray=new zn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,xm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Dt("CollisionBuffers",Cm);class jh{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(S=>S.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ap(this.zoom,a["text-size"]),this.iconSizeData=ap(this.zoom,a["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),T=h.get("symbol-z-order");this.canOverlap=sp(h,"text-overlap","text-allow-overlap")!=="never"||sp(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(S=>v.ao[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=t.sourceID}createArrays(){this.text=new Mm(new Wi(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Mm(new Wi(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ue,this.lineVertexArray=new de,this.symbolInstances=new oe,this.textAnchorOffsets=new fe}calculateGlyphDependencies(t,a,h,g,T){for(let S=0;S<t.length;S++)if(a[t.charCodeAt(S)]=!0,(h||g)&&T){const A=Ll[t.charAt(S)];A&&(a[A.charCodeAt(0)]=!0)}}populate(t,a,h){const g=this.layers[0],T=g.layout,S=T.get("text-font"),A=T.get("text-field"),D=T.get("icon-image"),P=(A.value.kind!=="constant"||A.value.value instanceof dr&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),L=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,F=T.get("symbol-sort-key");if(this.features=[],!P&&!L)return;const $=a.iconDependencies,H=a.glyphDependencies,X=a.availableImages,J=new $n(this.zoom,{globalState:this.globalState});for(const{feature:se,id:he,index:De,sourceLayerIndex:ve}of t){const we=g._featureFilter.needGeometry,Be=us(se,we);if(!g._featureFilter.filter(J,Be,h))continue;let We,lt;if(we||(Be.geometry=_i(se)),P){const _t=g.getValueAndResolveTokens("text-field",Be,h,X),xt=dr.factory(_t),Ft=this.hasRTLText=this.hasRTLText||Ov(xt);(!Ft||ia.getRTLTextPluginStatus()==="unavailable"||Ft&&ia.isParsed())&&(We=wu(xt,g,Be))}if(L){const _t=g.getValueAndResolveTokens("icon-image",Be,h,X);lt=_t instanceof Lr?_t:Lr.fromString(_t)}if(!We&&!lt)continue;const Tt=this.sortFeaturesByKey?F.evaluate(Be,{},h):void 0;if(this.features.push({id:he,text:We,icon:lt,index:De,sourceLayerIndex:ve,geometry:Be.geometry,properties:se.properties,type:Rh.types[se.type],sortKey:Tt}),lt&&($[lt.name]=!0),We){const _t=S.evaluate(Be,{},h).join(","),xt=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ao.vertical)>=0;for(const Ft of We.sections)if(Ft.image)$[Ft.image.name]=!0;else{const St=ks(We.toString()),wt=Ft.fontStack||_t,tt=H[wt]=H[wt]||{};this.calculateGlyphDependencies(Ft.text,tt,xt,this.allowVerticalPlacement,St)}}}T.get("symbol-placement")==="line"&&(this.features=function(se){const he={},De={},ve=[];let we=0;function Be(_t){ve.push(se[_t]),we++}function We(_t,xt,Ft){const St=De[_t];return delete De[_t],De[xt]=St,ve[St].geometry[0].pop(),ve[St].geometry[0]=ve[St].geometry[0].concat(Ft[0]),St}function lt(_t,xt,Ft){const St=he[xt];return delete he[xt],he[_t]=St,ve[St].geometry[0].shift(),ve[St].geometry[0]=Ft[0].concat(ve[St].geometry[0]),St}function Tt(_t,xt,Ft){const St=Ft?xt[0][xt[0].length-1]:xt[0][0];return`${_t}:${St.x}:${St.y}`}for(let _t=0;_t<se.length;_t++){const xt=se[_t],Ft=xt.geometry,St=xt.text?xt.text.toString():null;if(!St){Be(_t);continue}const wt=Tt(St,Ft),tt=Tt(St,Ft,!0);if(wt in De&&tt in he&&De[wt]!==he[tt]){const qt=lt(wt,tt,Ft),Kt=We(wt,tt,ve[qt].geometry);delete he[wt],delete De[tt],De[Tt(St,ve[Kt].geometry,!0)]=Kt,ve[qt].geometry=null}else wt in De?We(wt,tt,Ft):tt in he?lt(wt,tt,Ft):(Be(_t),he[wt]=we-1,De[tt]=we-1)}return ve.filter(_t=>_t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((se,he)=>se.sortKey-he.sortKey)}update(t,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,{imagePositions:h,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,{imagePositions:h,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const h=this.lineVertexArray.length;if(t.segment!==void 0){let g=t.dist(a[t.segment+1]),T=t.dist(a[t.segment]);const S={};for(let A=t.segment+1;A<a.length;A++)S[A]={x:a[A].x,y:a[A].y,tileUnitDistanceFromAnchor:g},A<a.length-1&&(g+=a[A+1].dist(a[A]));for(let A=t.segment||0;A>=0;A--)S[A]={x:a[A].x,y:a[A].y,tileUnitDistanceFromAnchor:T},A>0&&(T+=a[A-1].dist(a[A]));for(let A=0;A<a.length;A++){const D=S[A];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(t,a,h,g,T,S,A,D,P,L,F,$){const H=t.indexArray,X=t.layoutVertexArray,J=t.segments.prepareSegment(4*a.length,X,H,this.canOverlap?S.sortKey:void 0),se=this.glyphOffsetArray.length,he=J.vertexLength,De=this.allowVerticalPlacement&&A===v.ao.vertical?Math.PI/2:0,ve=S.text&&S.text.sections;for(let we=0;we<a.length;we++){const{tl:Be,tr:We,bl:lt,br:Tt,tex:_t,pixelOffsetTL:xt,pixelOffsetBR:Ft,minFontScaleX:St,minFontScaleY:wt,glyphOffset:tt,isSDF:qt,sectionIndex:Kt}=a[we],Zt=J.vertexLength,Nt=tt[1];js(X,D.x,D.y,Be.x,Nt+Be.y,_t.x,_t.y,h,qt,xt.x,xt.y,St,wt),js(X,D.x,D.y,We.x,Nt+We.y,_t.x+_t.w,_t.y,h,qt,Ft.x,xt.y,St,wt),js(X,D.x,D.y,lt.x,Nt+lt.y,_t.x,_t.y+_t.h,h,qt,xt.x,Ft.y,St,wt),js(X,D.x,D.y,Tt.x,Nt+Tt.y,_t.x+_t.w,_t.y+_t.h,h,qt,Ft.x,Ft.y,St,wt),Oh(t.dynamicLayoutVertexArray,D,De),H.emplaceBack(Zt,Zt+2,Zt+1),H.emplaceBack(Zt+1,Zt+2,Zt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(tt[0]),we!==a.length-1&&Kt===a[we+1].sectionIndex||t.programConfigurations.populatePaintArrays(X.length,S,S.index,{imagePositions:{},canonical:$,formattedSection:ve&&ve[Kt],globalState:this.globalState})}t.placedSymbolArray.emplaceBack(D.x,D.y,se,this.glyphOffsetArray.length-se,he,P,L,D.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],A,0,!1,0,F)}_addCollisionDebugVertex(t,a,h,g,T,S){return a.emplaceBack(0,0),t.emplaceBack(h.x,h.y,g,T,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(t,a,h,g,T,S,A){const D=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),P=D.vertexLength,L=T.layoutVertexArray,F=T.collisionVertexArray,$=A.anchorX,H=A.anchorY;this._addCollisionDebugVertex(L,F,S,$,H,new C(t,a)),this._addCollisionDebugVertex(L,F,S,$,H,new C(h,a)),this._addCollisionDebugVertex(L,F,S,$,H,new C(h,g)),this._addCollisionDebugVertex(L,F,S,$,H,new C(t,g)),D.vertexLength+=4;const X=T.indexArray;X.emplaceBack(P,P+1),X.emplaceBack(P+1,P+2),X.emplaceBack(P+2,P+3),X.emplaceBack(P+3,P),D.primitiveLength+=4}addDebugCollisionBoxes(t,a,h,g){for(let T=t;T<a;T++){const S=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,g?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cm(fn,kc.members,Yn),this.iconCollisionBox=new Cm(fn,kc.members,Yn);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,h,g,T,S,A,D,P){const L={};for(let F=a;F<h;F++){const $=t.get(F);L.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.textFeatureIndex=$.featureIndex;break}for(let F=g;F<T;F++){const $=t.get(F);L.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalTextFeatureIndex=$.featureIndex;break}for(let F=S;F<A;F++){const $=t.get(F);L.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.iconFeatureIndex=$.featureIndex;break}for(let F=D;F<P;F++){const $=t.get(F);L.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalIconFeatureIndex=$.featureIndex;break}return L}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const h=t.placedSymbolArray.get(a),g=h.vertexStartIndex+4*h.numGlyphs;for(let T=h.vertexStartIndex;T<g;T+=4)t.indexArray.emplaceBack(T,T+2,T+1),t.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),h=Math.cos(t),g=[],T=[],S=[];for(let A=0;A<this.symbolInstances.length;++A){S.push(A);const D=this.symbolInstances.get(A);g.push(0|Math.round(a*D.anchorX+h*D.anchorY)),T.push(D.featureIndex)}return S.sort((A,D)=>g[A]-g[D]||T[D]-T[A]),S}addToSortKeyRanges(t,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,T,S)=>{g>=0&&S.indexOf(g)===T&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let iy,d0;Dt("SymbolBucket",jh,{omit:["layers","collisionBoxArray","features","compareText"]}),jh.MAX_GLYPHS=65535,jh.addDynamicAttributes=Oh;var op={get paint(){return d0=d0||new ya({"icon-opacity":new Gt(Re.paint_symbol["icon-opacity"]),"icon-color":new Gt(Re.paint_symbol["icon-color"]),"icon-halo-color":new Gt(Re.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gt(Re.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gt(Re.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(Re.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(Re.paint_symbol["icon-translate-anchor"]),"text-opacity":new Gt(Re.paint_symbol["text-opacity"]),"text-color":new Gt(Re.paint_symbol["text-color"],{runtimeType:rr,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Gt(Re.paint_symbol["text-halo-color"]),"text-halo-width":new Gt(Re.paint_symbol["text-halo-width"]),"text-halo-blur":new Gt(Re.paint_symbol["text-halo-blur"]),"text-translate":new zt(Re.paint_symbol["text-translate"]),"text-translate-anchor":new zt(Re.paint_symbol["text-translate-anchor"])})},get layout(){return iy=iy||new ya({"symbol-placement":new zt(Re.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(Re.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(Re.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gt(Re.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(Re.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new zt(Re.layout_symbol["icon-allow-overlap"]),"icon-overlap":new zt(Re.layout_symbol["icon-overlap"]),"icon-ignore-placement":new zt(Re.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(Re.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(Re.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gt(Re.layout_symbol["icon-size"]),"icon-text-fit":new zt(Re.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zt(Re.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gt(Re.layout_symbol["icon-image"]),"icon-rotate":new Gt(Re.layout_symbol["icon-rotate"]),"icon-padding":new Gt(Re.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(Re.layout_symbol["icon-keep-upright"]),"icon-offset":new Gt(Re.layout_symbol["icon-offset"]),"icon-anchor":new Gt(Re.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(Re.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(Re.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(Re.layout_symbol["text-rotation-alignment"]),"text-field":new Gt(Re.layout_symbol["text-field"]),"text-font":new Gt(Re.layout_symbol["text-font"]),"text-size":new Gt(Re.layout_symbol["text-size"]),"text-max-width":new Gt(Re.layout_symbol["text-max-width"]),"text-line-height":new zt(Re.layout_symbol["text-line-height"]),"text-letter-spacing":new Gt(Re.layout_symbol["text-letter-spacing"]),"text-justify":new Gt(Re.layout_symbol["text-justify"]),"text-radial-offset":new Gt(Re.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(Re.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Gt(Re.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Gt(Re.layout_symbol["text-anchor"]),"text-max-angle":new zt(Re.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(Re.layout_symbol["text-writing-mode"]),"text-rotate":new Gt(Re.layout_symbol["text-rotate"]),"text-padding":new zt(Re.layout_symbol["text-padding"]),"text-keep-upright":new zt(Re.layout_symbol["text-keep-upright"]),"text-transform":new Gt(Re.layout_symbol["text-transform"]),"text-offset":new Gt(Re.layout_symbol["text-offset"]),"text-allow-overlap":new zt(Re.layout_symbol["text-allow-overlap"]),"text-overlap":new zt(Re.layout_symbol["text-overlap"]),"text-ignore-placement":new zt(Re.layout_symbol["text-ignore-placement"]),"text-optional":new zt(Re.layout_symbol["text-optional"])})}};class ry{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ro,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Dt("FormatSectionOverride",ry,{omit:["defaultValue"]});class lp extends Da{constructor(t){super(t,op)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const T of h)g.indexOf(T)<0&&g.push(T);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,h,g){const T=this.layout.get(t).evaluate(a,{},h,g),S=this._unevaluatedLayout._values[t];return S.isDataDriven()||Oo(S.value)||!T?T:function(A,D){return D.replace(/{([^{}]+)}/g,(P,L)=>A&&L in A?String(A[L]):"")}(a.properties,T)}createBucket(t){return new jh(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of op.paint.overridableProperties){if(!lp.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),h=new ry(a),g=new fh(h,a.property.specification);let T=null;T=a.value.kind==="constant"||a.value.kind==="source"?new vl("source",g):new iu("composite",g,a.value.zoomStops),this.paint._values[t]=new ai(a.property,T,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&lp.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const h=t.get("text-field"),g=op.paint.properties[a];let T=!1;const S=A=>{for(const D of A)if(g.overrides&&g.overrides.hasOverride(D))return void(T=!0)};if(h.value.kind==="constant"&&h.value.value instanceof dr)S(h.value.value.sections);else if(h.value.kind==="source"||h.value.kind==="composite"){const A=P=>{T||(P instanceof es&&Ht(P.value)===Aa?S(P.value.sections):P instanceof oc?S(P.sections):P.eachChild(A))},D=h.value;D._styleExpression&&A(D._styleExpression.expression)}return T}}let f0;var ay={get paint(){return f0=f0||new ya({"background-color":new zt(Re.paint_background["background-color"]),"background-pattern":new ss(Re.paint_background["background-pattern"]),"background-opacity":new zt(Re.paint_background["background-opacity"])})}};class sy extends Da{constructor(t){super(t,ay)}}let p0;var jv={get paint(){return p0=p0||new ya({"raster-opacity":new zt(Re.paint_raster["raster-opacity"]),"raster-hue-rotate":new zt(Re.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(Re.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(Re.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(Re.paint_raster["raster-saturation"]),"raster-contrast":new zt(Re.paint_raster["raster-contrast"]),"raster-resampling":new zt(Re.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(Re.paint_raster["raster-fade-duration"])})}};class cp extends Da{constructor(t){super(t,jv)}}class Bv extends Da{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class m0{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Ln={once:!0},up=63710088e-1;class Ko{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ko(Ei(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,h=this.lat*a,g=t.lat*a,T=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((t.lng-this.lng)*a);return up*Math.acos(Math.min(T,1))}static convert(t){if(t instanceof Ko)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ko(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ko(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Dm=2*Math.PI*up;function oy(s){return Dm*Math.cos(s*Math.PI/180)}function km(s){return(180+s)/360}function Qd(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function hp(s,t){return s/oy(t)}function Au(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function ly(s,t){return s*oy(Au(t))}class dp{constructor(t,a,h=0){this.x=+t,this.y=+a,this.z=+h}static fromLngLat(t,a=0){const h=Ko.convert(t);return new dp(km(h.lng),Qd(h.lat),hp(a,h.lat))}toLngLat(){return new Ko(360*this.x-180,Au(this.y))}toAltitude(){return ly(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Dm*(t=Au(this.y),1/Math.cos(t*Math.PI/180));var t}}function g0(s,t,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[s*h-2*Math.PI*6378137/2,t*h-2*Math.PI*6378137/2]}class Im{constructor(t,a,h){if(!function(g,T,S){return!(g<0||g>25||S<0||S>=Math.pow(2,g)||T<0||T>=Math.pow(2,g))}(t,a,h))throw new Error(`x=${a}, y=${h}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=h,this.key=qn(0,t,t,a,h)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,h){const g=(S=this.y,A=this.z,D=g0(256*(T=this.x),256*(S=Math.pow(2,A)-S-1),A),P=g0(256*(T+1),256*(S+1),A),D[0]+","+D[1]+","+P[0]+","+P[1]);var T,S,A,D,P;const L=function(F,$,H){let X,J="";for(let se=F;se>0;se--)X=1<<se-1,J+=($&X?1:0)+(H&X?2:0);return J}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,L).replace(/{bbox-epsg-3857}/g,g)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new C((t.x*a-this.x)*kt,(t.y*a-this.y)*kt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class cy{constructor(t,a){this.wrap=t,this.canonical=a,this.key=qn(t,a.z,a.z,a.x,a.y)}}class ka{constructor(t,a,h,g,T){if(this.terrainRttPosMatrix32f=null,t<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${h}`);this.overscaledZ=t,this.wrap=a,this.canonical=new Im(h,+g,+T),this.key=qn(a,t,h,g,T)}clone(){return new ka(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new ka(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ka(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-t;return t>this.canonical.z?qn(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):qn(this.wrap*+a,t,t,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new ka(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new ka(a,this.wrap,a,h,g),new ka(a,this.wrap,a,h+1,g),new ka(a,this.wrap,a,h,g+1),new ka(a,this.wrap,a,h+1,g+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ka(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ka(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new cy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new dp(t.x-this.wrap,t.y))}}function qn(s,t,a,h,g){(s*=2)<0&&(s=-1*s-1);const T=1<<a;return(T*T*s+T*g+h).toString(36)+a.toString(36)+t.toString(36)}function Bh(s,t){return t?s.properties[t]:s.id}Dt("CanonicalTileID",Im),Dt("OverscaledTileID",ka,{omit:["terrainRttPosMatrix32f"]});class lr{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const a=new lr;return a.extend(t(new C(this.minX,this.minY))),a.extend(t(new C(this.maxX,this.minY))),a.extend(t(new C(this.minX,this.maxY))),a.extend(t(new C(this.maxX,this.maxY))),a}static fromPoints(t){const a=new lr;for(const h of t)a.extend(h);return a}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class y0{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const h=t[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Rm{constructor(t,a,h,g,T){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=h,t._y=g,this.properties=t.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class Pm{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Uo(kt,16,0),this.grid3D=new Uo(kt,16,0),this.featureIndexArray=new Se,this.promoteId=a}insert(t,a,h,g,T,S){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,T);const D=S?this.grid3D:this.grid;for(let P=0;P<a.length;P++){const L=a[P],F=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const H=L[$];F[0]=Math.min(F[0],H.x),F[1]=Math.min(F[1],H.y),F[2]=Math.max(F[2],H.x),F[3]=Math.max(F[3],H.y)}F[0]<kt&&F[1]<kt&&F[2]>=0&&F[3]>=0&&D.insert(A,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new qg(new zh(this.rawTileData)).layers,this.sourceLayerCoder=new y0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,h,g){this.loadVTLayers();const T=t.params,S=kt/t.tileSize/t.scale,A=bl(T.filter),D=t.queryGeometry,P=t.queryPadding*S,L=lr.fromPoints(D),F=this.grid.query(L.minX-P,L.minY-P,L.maxX+P,L.maxY+P),$=lr.fromPoints(t.cameraQueryGeometry).expandBy(P),H=this.grid3D.query($.minX,$.minY,$.maxX,$.maxY,(se,he,De,ve)=>function(we,Be,We,lt,Tt){for(const xt of we)if(Be<=xt.x&&We<=xt.y&&lt>=xt.x&&Tt>=xt.y)return!0;const _t=[new C(Be,We),new C(Be,Tt),new C(lt,Tt),new C(lt,We)];if(we.length>2){for(const xt of _t)if(Eh(we,xt))return!0}for(let xt=0;xt<we.length-1;xt++)if(O_(we[xt],we[xt+1],_t))return!0;return!1}(t.cameraQueryGeometry,se-P,he-P,De+P,ve+P));for(const se of H)F.push(se);F.sort(_0);const X={};let J;for(let se=0;se<F.length;se++){const he=F[se];if(he===J)continue;J=he;const De=this.featureIndexArray.get(he);let ve=null;this.loadMatchingFeature(X,De.bucketIndex,De.sourceLayerIndex,De.featureIndex,A,T.layers,T.availableImages,a,h,g,(we,Be,We)=>(ve||(ve=_i(we)),Be.queryIntersectsFeature({queryGeometry:D,feature:we,featureState:We,geometry:ve,zoom:this.z,transform:t.transform,pixelsToTileUnits:S,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return X}loadMatchingFeature(t,a,h,g,T,S,A,D,P,L,F){const $=this.bucketLayerIDs[a];if(S&&!$.some(se=>S.has(se)))return;const H=this.sourceLayerCoder.decode(h),X=this.vtLayers[H].feature(g);if(T.needGeometry){const se=us(X,!0);if(!T.filter(new $n(this.tileID.overscaledZ),se,this.tileID.canonical))return}else if(!T.filter(new $n(this.tileID.overscaledZ),X))return;const J=this.getId(X,H);for(let se=0;se<$.length;se++){const he=$[se];if(S&&!S.has(he))continue;const De=D[he];if(!De)continue;let ve={};J&&L&&(ve=L.getState(De.sourceLayer||"_geojsonTileLayer",J));const we=mn({},P[he]);we.paint=fp(we.paint,De.paint,X,ve,A),we.layout=fp(we.layout,De.layout,X,ve,A);const Be=!F||F(X,De,ve);if(!Be)continue;const We=new Rm(X,this.z,this.x,this.y,J);We.layer=we;let lt=t[he];lt===void 0&&(lt=t[he]=[]),lt.push({featureIndex:g,feature:We,intersectionZ:Be})}}lookupSymbolFeatures(t,a,h,g,T,S,A,D){const P={};this.loadVTLayers();const L=bl(T);for(const F of t)this.loadMatchingFeature(P,h,g,F,L,S,A,D,a);return P}hasLayer(t){for(const a of this.bucketLayerIDs)for(const h of a)if(t===h)return!0;return!1}getId(t,a){var h;let g=t.id;return this.promoteId&&(g=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((h=t.properties)===null||h===void 0)&&h.cluster)&&this.promoteId&&(g=Number(t.properties.cluster_id))),g}}function fp(s,t,a,h,g){return Ea(s,(T,S)=>{const A=t instanceof wc?t.get(S):null;return A&&A.evaluate?A.evaluate(a,h,g):A})}function _0(s,t){return t-s}function uy(s,t,a,h,g){const T=[];for(let S=0;S<s.length;S++){const A=s[S];let D;for(let P=0;P<A.length-1;P++){let L=A[P],F=A[P+1];L.x<t&&F.x<t||(L.x<t?L=new C(t,L.y+(t-L.x)/(F.x-L.x)*(F.y-L.y))._round():F.x<t&&(F=new C(t,L.y+(t-L.x)/(F.x-L.x)*(F.y-L.y))._round()),L.y<a&&F.y<a||(L.y<a?L=new C(L.x+(a-L.y)/(F.y-L.y)*(F.x-L.x),a)._round():F.y<a&&(F=new C(L.x+(a-L.y)/(F.y-L.y)*(F.x-L.x),a)._round()),L.x>=h&&F.x>=h||(L.x>=h?L=new C(h,L.y+(h-L.x)/(F.x-L.x)*(F.y-L.y))._round():F.x>=h&&(F=new C(h,L.y+(h-L.x)/(F.x-L.x)*(F.y-L.y))._round()),L.y>=g&&F.y>=g||(L.y>=g?L=new C(L.x+(g-L.y)/(F.y-L.y)*(F.x-L.x),g)._round():F.y>=g&&(F=new C(L.x+(g-L.y)/(F.y-L.y)*(F.x-L.x),g)._round()),D&&L.equals(D[D.length-1])||(D=[L],T.push(D)),D.push(F)))))}}return T}Dt("FeatureIndex",Pm,{omit:["rawTileData","sourceLayerCoder"]});class jl extends C{constructor(t,a,h,g){super(t,a),this.angle=h,g!==void 0&&(this.segment=g)}clone(){return new jl(this.x,this.y,this.angle,this.segment)}}function zm(s,t,a,h,g){if(t.segment===void 0||a===0)return!0;let T=t,S=t.segment+1,A=0;for(;A>-a/2;){if(S--,S<0)return!1;A-=s[S].dist(T),T=s[S]}A+=s[S].dist(s[S+1]),S++;const D=[];let P=0;for(;A<a/2;){const L=s[S],F=s[S+1];if(!F)return!1;let $=s[S-1].angleTo(L)-L.angleTo(F);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:A,angleDelta:$}),P+=$;A-D[0].distance>h;)P-=D.shift().angleDelta;if(P>g)return!1;S++,A+=L.dist(F)}return!0}function v0(s){let t=0;for(let a=0;a<s.length-1;a++)t+=s[a].dist(s[a+1]);return t}function hy(s,t,a){return s?.6*t*a:0}function b0(s,t){return Math.max(s?s.right-s.left:0,t?t.right-t.left:0)}function x0(s,t,a,h,g,T){const S=hy(a,g,T),A=b0(a,h)*T;let D=0;const P=v0(s)/2;for(let L=0;L<s.length-1;L++){const F=s[L],$=s[L+1],H=F.dist($);if(D+H>P){const X=(P-D)/H,J=fo.number(F.x,$.x,X),se=fo.number(F.y,$.y,X),he=new jl(J,se,$.angleTo(F),L);return he._round(),!S||zm(s,he,A,S,t)?he:void 0}D+=H}}function Fv(s,t,a,h,g,T,S,A,D){const P=hy(h,T,S),L=b0(h,g),F=L*S,$=s[0].x===0||s[0].x===D||s[0].y===0||s[0].y===D;return t-F<t/4&&(t=F+t/4),w0(s,$?t/2*A%t:(L/2+2*T)*S*A%t,t,P,a,F,$,!1,D)}function w0(s,t,a,h,g,T,S,A,D){const P=T/2,L=v0(s);let F=0,$=t-a,H=[];for(let X=0;X<s.length-1;X++){const J=s[X],se=s[X+1],he=J.dist(se),De=se.angleTo(J);for(;$+a<F+he;){$+=a;const ve=($-F)/he,we=fo.number(J.x,se.x,ve),Be=fo.number(J.y,se.y,ve);if(we>=0&&we<D&&Be>=0&&Be<D&&$-P>=0&&$+P<=L){const We=new jl(we,Be,De,X);We._round(),h&&!zm(s,We,T,h,g)||H.push(We)}}F+=he}return A||H.length||S||(H=w0(s,F/2,a,h,g,T,S,!0,D)),H}function Rc(s,t,a,h){const g=[],T=s.image,S=T.pixelRatio,A=T.paddedRect.w-2,D=T.paddedRect.h-2;let P={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const L=T.stretchX||[[0,A]],F=T.stretchY||[[0,D]],$=(tt,qt)=>tt+qt[1]-qt[0],H=L.reduce($,0),X=F.reduce($,0),J=A-H,se=D-X;let he=0,De=H,ve=0,we=X,Be=0,We=J,lt=0,Tt=se;if(T.content&&h){const tt=T.content,qt=tt[2]-tt[0],Kt=tt[3]-tt[1];(T.textFitWidth||T.textFitHeight)&&(P=h0(s)),he=pp(L,0,tt[0]),ve=pp(F,0,tt[1]),De=pp(L,tt[0],tt[2]),we=pp(F,tt[1],tt[3]),Be=tt[0]-he,lt=tt[1]-ve,We=qt-De,Tt=Kt-we}const _t=P.x1,xt=P.y1,Ft=P.x2-_t,St=P.y2-xt,wt=(tt,qt,Kt,Zt)=>{const Nt=Lm(tt.stretch-he,De,Ft,_t),pn=Om(tt.fixed-Be,We,tt.stretch,H),Jn=Lm(qt.stretch-ve,we,St,xt),bi=Om(qt.fixed-lt,Tt,qt.stretch,X),mr=Lm(Kt.stretch-he,De,Ft,_t),Ta=Om(Kt.fixed-Be,We,Kt.stretch,H),gr=Lm(Zt.stretch-ve,we,St,xt),Ur=Om(Zt.fixed-lt,Tt,Zt.stretch,X),Ii=new C(Nt,Jn),Ji=new C(mr,Jn),Vr=new C(mr,gr),Dr=new C(Nt,gr),Gr=new C(pn/S,bi/S),ms=new C(Ta/S,Ur/S),kr=t*Math.PI/180;if(kr){const wr=Math.sin(kr),tr=Math.cos(kr),nr=[tr,-wr,wr,tr];Ii._matMult(nr),Ji._matMult(nr),Dr._matMult(nr),Vr._matMult(nr)}const la=tt.stretch+tt.fixed,er=qt.stretch+qt.fixed;return{tl:Ii,tr:Ji,bl:Dr,br:Vr,tex:{x:T.paddedRect.x+1+la,y:T.paddedRect.y+1+er,w:Kt.stretch+Kt.fixed-la,h:Zt.stretch+Zt.fixed-er},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Gr,pixelOffsetBR:ms,minFontScaleX:We/S/Ft,minFontScaleY:Tt/S/St,isSDF:a}};if(h&&(T.stretchX||T.stretchY)){const tt=Nm(L,J,H),qt=Nm(F,se,X);for(let Kt=0;Kt<tt.length-1;Kt++){const Zt=tt[Kt],Nt=tt[Kt+1];for(let pn=0;pn<qt.length-1;pn++)g.push(wt(Zt,qt[pn],Nt,qt[pn+1]))}}else g.push(wt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:D+1}));return g}function pp(s,t,a){let h=0;for(const g of s)h+=Math.max(t,Math.min(a,g[1]))-Math.max(t,Math.min(a,g[0]));return h}function Nm(s,t,a){const h=[{fixed:-1,stretch:0}];for(const[g,T]of s){const S=h[h.length-1];h.push({fixed:g-S.stretch,stretch:S.stretch}),h.push({fixed:g-S.stretch,stretch:S.stretch+(T-g)})}return h.push({fixed:t+1,stretch:a}),h}function Lm(s,t,a,h){return s/t*a+h}function Om(s,t,a,h){return s-t*a/h}Dt("Anchor",jl);class Kd{constructor(t,a,h,g,T,S,A,D,P,L){var F;if(this.boxStartIndex=t.length,P){let $=S.top,H=S.bottom;const X=S.collisionPadding;X&&($-=X[1],H+=X[3]);let J=H-$;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const $=!((F=S.image)===null||F===void 0)&&F.content&&(S.image.textFitWidth||S.image.textFitHeight)?h0(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};$.y1=$.y1*A-D[0],$.y2=$.y2*A+D[2],$.x1=$.x1*A-D[3],$.x2=$.x2*A+D[1];const H=S.collisionPadding;if(H&&($.x1-=H[0]*A,$.y1-=H[1]*A,$.x2+=H[2]*A,$.y2+=H[3]*A),L){const X=new C($.x1,$.y1),J=new C($.x2,$.y1),se=new C($.x1,$.y2),he=new C($.x2,$.y2),De=L*Math.PI/180;X._rotate(De),J._rotate(De),se._rotate(De),he._rotate(De),$.x1=Math.min(X.x,J.x,se.x,he.x),$.x2=Math.max(X.x,J.x,se.x,he.x),$.y1=Math.min(X.y,J.y,se.y,he.y),$.y2=Math.max(X.y,J.y,se.y,he.y)}t.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,h,g,T)}this.boxEndIndex=t.length}}class Uv{constructor(t=[],a=(h,g)=>h<g?-1:h>g?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:h}=this,g=a[t];for(;t>0;){const T=t-1>>1,S=a[T];if(h(g,S)>=0)break;a[t]=S,t=T}a[t]=g}_down(t){const{data:a,compare:h}=this,g=this.length>>1,T=a[t];for(;t<g;){let S=1+(t<<1);const A=S+1;if(A<this.length&&h(a[A],a[S])<0&&(S=A),h(a[S],T)>=0)break;a[t]=a[S],t=S}a[t]=T}}function Jo(s,t=1,a=!1){const h=lr.fromPoints(s[0]),g=Math.min(h.width(),h.height());let T=g/2;const S=new Uv([],dy),{minX:A,minY:D,maxX:P,maxY:L}=h;if(g===0)return new C(A,D);for(let H=A;H<P;H+=g)for(let X=D;X<L;X+=g)S.push(new Fh(H+T,X+T,T,s));let F=function(H){let X=0,J=0,se=0;const he=H[0];for(let De=0,ve=he.length,we=ve-1;De<ve;we=De++){const Be=he[De],We=he[we],lt=Be.x*We.y-We.x*Be.y;J+=(Be.x+We.x)*lt,se+=(Be.y+We.y)*lt,X+=3*lt}return new Fh(J/X,se/X,0,H)}(s),$=S.length;for(;S.length;){const H=S.pop();(H.d>F.d||!F.d)&&(F=H,a&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,$)),H.max-F.d<=t||(T=H.h/2,S.push(new Fh(H.p.x-T,H.p.y-T,T,s)),S.push(new Fh(H.p.x+T,H.p.y-T,T,s)),S.push(new Fh(H.p.x-T,H.p.y+T,T,s)),S.push(new Fh(H.p.x+T,H.p.y+T,T,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${F.d}`)),F.p}function dy(s,t){return t.max-s.max}function Fh(s,t,a,h){this.p=new C(s,t),this.h=a,this.d=function(g,T){let S=!1,A=1/0;for(let D=0;D<T.length;D++){const P=T[D];for(let L=0,F=P.length,$=F-1;L<F;$=L++){const H=P[L],X=P[$];H.y>g.y!=X.y>g.y&&g.x<(X.x-H.x)*(g.y-H.y)/(X.y-H.y)+H.x&&(S=!S),A=Math.min(A,Pg(g,H,X))}}return(S?1:-1)*Math.sqrt(A)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var Fr;v.aE=void 0,(Fr=v.aE||(v.aE={}))[Fr.center=1]="center",Fr[Fr.left=2]="left",Fr[Fr.right=3]="right",Fr[Fr.top=4]="top",Fr[Fr.bottom=5]="bottom",Fr[Fr["top-left"]=6]="top-left",Fr[Fr["top-right"]=7]="top-right",Fr[Fr["bottom-left"]=8]="bottom-left",Fr[Fr["bottom-right"]=9]="bottom-right";const Uh=Number.POSITIVE_INFINITY;function Bs(s,t){return t[1]!==Uh?function(a,h,g){let T=0,S=0;switch(h=Math.abs(h),g=Math.abs(g),a){case"top-right":case"top-left":case"top":S=g-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-g}switch(a){case"top-right":case"bottom-right":case"right":T=-h;break;case"top-left":case"bottom-left":case"left":T=h}return[T,S]}(s,t[0],t[1]):function(a,h){let g=0,T=0;h<0&&(h=0);const S=h/Math.SQRT2;switch(a){case"top-right":case"top-left":T=S-7;break;case"bottom-right":case"bottom-left":T=7-S;break;case"bottom":T=7-h;break;case"top":T=h-7}switch(a){case"top-right":case"bottom-right":g=-S;break;case"top-left":case"bottom-left":g=S;break;case"left":g=h;break;case"right":g=-h}return[g,T]}(s,t[0])}function fy(s,t,a){var h;const g=s.layout,T=(h=g.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(t,{},a);if(T){const A=T.values,D=[];for(let P=0;P<A.length;P+=2){const L=D[P]=A[P],F=A[P+1].map($=>$*Zi);L.startsWith("top")?F[1]-=7:L.startsWith("bottom")&&(F[1]+=7),D[P+1]=F}return new Nr(D)}const S=g.get("text-variable-anchor");if(S){let A;A=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(t,{},a)*Zi,Uh]:g.get("text-offset").evaluate(t,{},a).map(P=>P*Zi);const D=[];for(const P of S)D.push(P,Bs(P,A));return new Nr(D)}return null}function Jd(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pc(s,t,a,h,g,T,S,A,D,P,L,F){let $=T.textMaxSize.evaluate(t,{});$===void 0&&($=S);const H=s.layers[0].layout,X=H.get("icon-offset").evaluate(t,{},L),J=S0(a.horizontal),se=S/24,he=s.tilePixelRatio*se,De=s.tilePixelRatio*$/24,ve=s.tilePixelRatio*A,we=s.tilePixelRatio*H.get("symbol-spacing"),Be=H.get("text-padding")*s.tilePixelRatio,We=function(Kt,Zt,Nt,pn=1){const Jn=Kt.get("icon-padding").evaluate(Zt,{},Nt),bi=Jn&&Jn.values;return[bi[0]*pn,bi[1]*pn,bi[2]*pn,bi[3]*pn]}(H,t,L,s.tilePixelRatio),lt=H.get("text-max-angle")/180*Math.PI,Tt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",_t=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",xt=H.get("symbol-placement"),Ft=we/2,St=H.get("icon-text-fit");let wt;h&&St!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(wt=rp(h,a.vertical,St,H.get("icon-text-fit-padding"),X,se)),J&&(h=rp(h,J,St,H.get("icon-text-fit-padding"),X,se)));const tt=L?F.line.getGranularityForZoomLevel(L.z):1,qt=(Kt,Zt)=>{Zt.x<0||Zt.x>=kt||Zt.y<0||Zt.y>=kt||function(Nt,pn,Jn,bi,mr,Ta,gr,Ur,Ii,Ji,Vr,Dr,Gr,ms,kr,la,er,wr,tr,nr,si,bo,nf,gs,r){const u=Nt.addToLineVertexArray(pn,Jn);let p,x,M,z,q=0,ne=0,xe=0,Ye=0,at=-1,dt=-1;const Xe={};let Qe=Ho("");if(Nt.allowVerticalPlacement&&bi.vertical){const Ya=Ur.layout.get("text-rotate").evaluate(si,{},gs)+90;M=new Kd(Ii,pn,Ji,Vr,Dr,bi.vertical,Gr,ms,kr,Ya),gr&&(z=new Kd(Ii,pn,Ji,Vr,Dr,gr,er,wr,kr,Ya))}if(mr){const Ya=Ur.layout.get("icon-rotate").evaluate(si,{}),el=Ur.layout.get("icon-text-fit")!=="none",yp=Rc(mr,Ya,nf,el),zc=gr?Rc(gr,Ya,nf,el):void 0;x=new Kd(Ii,pn,Ji,Vr,Dr,mr,er,wr,!1,Ya),q=4*yp.length;const _p=Nt.iconSizeData;let Cu=null;_p.kind==="source"?(Cu=[ps*Ur.layout.get("icon-size").evaluate(si,{})],Cu[0]>Ol&&Xn(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):_p.kind==="composite"&&(Cu=[ps*bo.compositeIconSizes[0].evaluate(si,{},gs),ps*bo.compositeIconSizes[1].evaluate(si,{},gs)],(Cu[0]>Ol||Cu[1]>Ol)&&Xn(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,yp,Cu,nr,tr,si,v.ao.none,pn,u.lineStartIndex,u.lineLength,-1,gs),at=Nt.icon.placedSymbolArray.length-1,zc&&(ne=4*zc.length,Nt.addSymbols(Nt.icon,zc,Cu,nr,tr,si,v.ao.vertical,pn,u.lineStartIndex,u.lineLength,-1,gs),dt=Nt.icon.placedSymbolArray.length-1)}const un=Object.keys(bi.horizontal);for(const Ya of un){const el=bi.horizontal[Ya];if(!p){Qe=Ho(el.text);const zc=Ur.layout.get("text-rotate").evaluate(si,{},gs);p=new Kd(Ii,pn,Ji,Vr,Dr,el,Gr,ms,kr,zc)}const yp=el.positionedLines.length===1;if(xe+=T0(Nt,pn,el,Ta,Ur,kr,si,la,u,bi.vertical?v.ao.horizontal:v.ao.horizontalOnly,yp?un:[Ya],Xe,at,bo,gs),yp)break}bi.vertical&&(Ye+=T0(Nt,pn,bi.vertical,Ta,Ur,kr,si,la,u,v.ao.vertical,["vertical"],Xe,dt,bo,gs));const sn=p?p.boxStartIndex:Nt.collisionBoxArray.length,xi=p?p.boxEndIndex:Nt.collisionBoxArray.length,Le=M?M.boxStartIndex:Nt.collisionBoxArray.length,ze=M?M.boxEndIndex:Nt.collisionBoxArray.length,Ze=x?x.boxStartIndex:Nt.collisionBoxArray.length,ut=x?x.boxEndIndex:Nt.collisionBoxArray.length,$t=z?z.boxStartIndex:Nt.collisionBoxArray.length,kn=z?z.boxEndIndex:Nt.collisionBoxArray.length;let Ut=-1;const Jt=(Ya,el)=>Ya&&Ya.circleDiameter?Math.max(Ya.circleDiameter,el):el;Ut=Jt(p,Ut),Ut=Jt(M,Ut),Ut=Jt(x,Ut),Ut=Jt(z,Ut);const Zr=Ut>-1?1:0;Zr&&(Ut*=r/Zi),Nt.glyphOffsetArray.length>=jh.MAX_GLYPHS&&Xn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),si.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,si.sortKey);const ei=fy(Ur,si,gs),[Mu,Vv]=function(Ya,el){const yp=Ya.length,zc=el?.values;if(zc?.length>0)for(let _p=0;_p<zc.length;_p+=2){const Cu=zc[_p+1];Ya.emplaceBack(v.aE[zc[_p]],Cu[0],Cu[1])}return[yp,Ya.length]}(Nt.textAnchorOffsets,ei);Nt.symbolInstances.emplaceBack(pn.x,pn.y,Xe.right>=0?Xe.right:-1,Xe.center>=0?Xe.center:-1,Xe.left>=0?Xe.left:-1,Xe.vertical||-1,at,dt,Qe,sn,xi,Le,ze,Ze,ut,$t,kn,Ji,xe,Ye,q,ne,Zr,0,Gr,Ut,Mu,Vv)}(s,Zt,Kt,a,h,g,wt,s.layers[0],s.collisionBoxArray,t.index,t.sourceLayerIndex,s.index,he,[Be,Be,Be,Be],Tt,D,ve,We,_t,X,t,T,P,L,S)};if(xt==="line")for(const Kt of uy(t.geometry,0,0,kt,kt)){const Zt=Mc(Kt,tt),Nt=Fv(Zt,we,lt,a.vertical||J,h,24,De,s.overscaling,kt);for(const pn of Nt)J&&ef(s,J.text,Ft,pn)||qt(Zt,pn)}else if(xt==="line-center"){for(const Kt of t.geometry)if(Kt.length>1){const Zt=Mc(Kt,tt),Nt=x0(Zt,lt,a.vertical||J,h,24,De);Nt&&qt(Zt,Nt)}}else if(t.type==="Polygon")for(const Kt of Jc(t.geometry,0)){const Zt=Jo(Kt,16);qt(Mc(Kt[0],tt,!0),new jl(Zt.x,Zt.y,0))}else if(t.type==="LineString")for(const Kt of t.geometry){const Zt=Mc(Kt,tt);qt(Zt,new jl(Zt[0].x,Zt[0].y,0))}else if(t.type==="Point")for(const Kt of t.geometry)for(const Zt of Kt)qt([Zt],new jl(Zt.x,Zt.y,0))}function T0(s,t,a,h,g,T,S,A,D,P,L,F,$,H,X){const J=function(De,ve,we,Be,We,lt,Tt,_t){const xt=Be.layout.get("text-rotate").evaluate(lt,{})*Math.PI/180,Ft=[];for(const St of ve.positionedLines)for(const wt of St.positionedGlyphs){if(!wt.rect)continue;const tt=wt.rect||{};let qt=4,Kt=!0,Zt=1,Nt=0;const pn=(We||_t)&&wt.vertical,Jn=wt.metrics.advance*wt.scale/2;if(_t&&ve.verticalizable&&(Nt=St.lineOffset/2-(wt.imageName?-(Zi-wt.metrics.width*wt.scale)/2:(wt.scale-1)*Zi)),wt.imageName){const wr=Tt[wt.imageName];Kt=wr.sdf,Zt=wr.pixelRatio,qt=1/Zt}const bi=We?[wt.x+Jn,wt.y]:[0,0];let mr=We?[0,0]:[wt.x+Jn+we[0],wt.y+we[1]-Nt],Ta=[0,0];pn&&(Ta=mr,mr=[0,0]);const gr=wt.metrics.isDoubleResolution?2:1,Ur=(wt.metrics.left-qt)*wt.scale-Jn+mr[0],Ii=(-wt.metrics.top-qt)*wt.scale+mr[1],Ji=Ur+tt.w/gr*wt.scale/Zt,Vr=Ii+tt.h/gr*wt.scale/Zt,Dr=new C(Ur,Ii),Gr=new C(Ji,Ii),ms=new C(Ur,Vr),kr=new C(Ji,Vr);if(pn){const wr=new C(-Jn,Jn- -17),tr=-Math.PI/2,nr=12-Jn,si=new C(22-nr,-(wt.imageName?nr:0)),bo=new C(...Ta);Dr._rotateAround(tr,wr)._add(si)._add(bo),Gr._rotateAround(tr,wr)._add(si)._add(bo),ms._rotateAround(tr,wr)._add(si)._add(bo),kr._rotateAround(tr,wr)._add(si)._add(bo)}if(xt){const wr=Math.sin(xt),tr=Math.cos(xt),nr=[tr,-wr,wr,tr];Dr._matMult(nr),Gr._matMult(nr),ms._matMult(nr),kr._matMult(nr)}const la=new C(0,0),er=new C(0,0);Ft.push({tl:Dr,tr:Gr,bl:ms,br:kr,tex:tt,writingMode:ve.writingMode,glyphOffset:bi,sectionIndex:wt.sectionIndex,isSDF:Kt,pixelOffsetTL:la,pixelOffsetBR:er,minFontScaleX:0,minFontScaleY:0})}return Ft}(0,a,A,g,T,S,h,s.allowVerticalPlacement),se=s.textSizeData;let he=null;se.kind==="source"?(he=[ps*g.layout.get("text-size").evaluate(S,{})],he[0]>Ol&&Xn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):se.kind==="composite"&&(he=[ps*H.compositeTextSizes[0].evaluate(S,{},X),ps*H.compositeTextSizes[1].evaluate(S,{},X)],(he[0]>Ol||he[1]>Ol)&&Xn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,J,he,A,T,S,P,t,D.lineStartIndex,D.lineLength,$,X);for(const De of L)F[De]=s.text.placedSymbolArray.length-1;return 4*J.length}function S0(s){for(const t in s)return s[t];return null}function ef(s,t,a,h){const g=s.compareText;if(t in g){const T=g[t];for(let S=T.length-1;S>=0;S--)if(h.dist(T[S])<a)return!0}else g[t]=[];return g[t].push(h),!1}const py=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class my{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,h]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const T=py[15&h];if(!T)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(t,2,1),[A]=new Uint32Array(t,4,1);return new my(A,S,T,t)}constructor(t,a=64,h=Float64Array,g){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=h,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const T=py.indexOf(this.ArrayType),S=2*t*this.ArrayType.BYTES_PER_ELEMENT,A=t*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-A%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+D,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+S+A+D),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+D,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=t,this.coords[this._pos++]=a,h}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return gy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:S,nodeSize:A}=this,D=[0,T.length-1,0],P=[];for(;D.length;){const L=D.pop()||0,F=D.pop()||0,$=D.pop()||0;if(F-$<=A){for(let se=$;se<=F;se++){const he=S[2*se],De=S[2*se+1];he>=t&&he<=h&&De>=a&&De<=g&&P.push(T[se])}continue}const H=$+F>>1,X=S[2*H],J=S[2*H+1];X>=t&&X<=h&&J>=a&&J<=g&&P.push(T[H]),(L===0?t<=X:a<=J)&&(D.push($),D.push(H-1),D.push(1-L)),(L===0?h>=X:g>=J)&&(D.push(H+1),D.push(F),D.push(1-L))}return P}within(t,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:T,nodeSize:S}=this,A=[0,g.length-1,0],D=[],P=h*h;for(;A.length;){const L=A.pop()||0,F=A.pop()||0,$=A.pop()||0;if(F-$<=S){for(let se=$;se<=F;se++)A0(T[2*se],T[2*se+1],t,a)<=P&&D.push(g[se]);continue}const H=$+F>>1,X=T[2*H],J=T[2*H+1];A0(X,J,t,a)<=P&&D.push(g[H]),(L===0?t-h<=X:a-h<=J)&&(A.push($),A.push(H-1),A.push(1-L)),(L===0?t+h>=X:a+h>=J)&&(A.push(H+1),A.push(F),A.push(1-L))}return D}}function gy(s,t,a,h,g,T){if(g-h<=a)return;const S=h+g>>1;E0(s,t,S,h,g,T),gy(s,t,a,h,S-1,1-T),gy(s,t,a,S+1,g,1-T)}function E0(s,t,a,h,g,T){for(;g>h;){if(g-h>600){const P=g-h+1,L=a-h+1,F=Math.log(P),$=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*$*(P-$)/P)*(L-P/2<0?-1:1);E0(s,t,a,Math.max(h,Math.floor(a-L*$/P+H)),Math.min(g,Math.floor(a+(P-L)*$/P+H)),T)}const S=t[2*a+T];let A=h,D=g;for(mp(s,t,h,a),t[2*g+T]>S&&mp(s,t,h,g);A<D;){for(mp(s,t,A,D),A++,D--;t[2*A+T]<S;)A++;for(;t[2*D+T]>S;)D--}t[2*h+T]===S?mp(s,t,h,D):(D++,mp(s,t,D,g)),D<=a&&(h=D+1),a<=D&&(g=D-1)}}function mp(s,t,a,h){yy(s,a,h),yy(t,2*a,2*h),yy(t,2*a+1,2*h+1)}function yy(s,t,a){const h=s[t];s[t]=s[a],s[a]=h}function A0(s,t,a,h){const g=s-a,T=t-h;return g*g+T*T}var _y;v.cx=void 0,(_y=v.cx||(v.cx={})).create="create",_y.load="load",_y.fullLoad="fullLoad";let gp=null,Bl=[];const Vh=1e3/60,jm="loadTime",vy="fullLoadTime",tf={mark(s){performance.mark(s)},frame(s){const t=s;gp!=null&&Bl.push(t-gp),gp=t},clearMetrics(){gp=null,Bl=[],performance.clearMeasures(jm),performance.clearMeasures(vy);for(const s in v.cx)performance.clearMarks(v.cx[s])},getPerformanceMetrics(){performance.measure(jm,v.cx.create,v.cx.load),performance.measure(vy,v.cx.create,v.cx.fullLoad);const s=performance.getEntriesByName(jm)[0].duration,t=performance.getEntriesByName(vy)[0].duration,a=Bl.length,h=1/(Bl.reduce((T,S)=>T+S,0)/a/1e3),g=Bl.filter(T=>T>Vh).reduce((T,S)=>T+(S-Vh)/Vh,0);return{loadTime:s,fullLoadTime:t,fps:h,percentDroppedFrames:g/(a+g)*100,totalFrames:a}}};v.$=kt,v.A=Fe,v.B=function([s,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:s*Math.cos(t)*Math.sin(a),y:s*Math.sin(t)*Math.sin(a),z:s*Math.cos(a)}},v.C=fo,v.D=zt,v.E=Lt,v.F=$n,v.G=Cs,v.H=function(s){if(ji==null){const t=s.navigator?s.navigator.userAgent:null;ji=!!s.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ji},v.I=tp,v.J=class{constructor(s,t){this.target=s,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new m0(()=>this.process()),this.subscription=Ka(this.target,"message",a=>this.receive(a),!1),this.globalScope=Yr(self)?s:window}registerMessageHandler(s,t){this.messageHandlers[s]=t}sendAsync(s,t){return new Promise((a,h)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=t?Ka(t.signal,"abort",()=>{T?.unsubscribe(),delete this.resolveRejects[g];const D={id:g,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(D)},Ln):null;this.resolveRejects[g]={resolve:D=>{T?.unsubscribe(),a(D)},reject:D=>{T?.unsubscribe(),h(D)}};const S=[],A=Object.assign(Object.assign({},s),{id:g,sourceMapId:this.mapId,origin:location.origin,data:_c(s.data,S)});this.target.postMessage(A,{transfer:S})})}receive(s){const t=s.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const h=this.abortControllers[a];return delete this.abortControllers[a],void(h&&h.abort())}if(Yr(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),t=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(s,t)}processTask(s,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const g=this.resolveRejects[s];return delete this.resolveRejects[s],g?void(t.error?g.reject(Ds(t.error)):g.resolve(Ds(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=Ds(t.data),h=new AbortController;this.abortControllers[s]=h;try{const g=yield this.messageHandlers[t.type](t.sourceMapId,a,h);this.completeTask(s,null,g)}catch(g){this.completeTask(s,g)}})}completeTask(s,t,a){const h=[];delete this.abortControllers[s];const g={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?_c(t):null,data:_c(a,h)};this.target.postMessage(g,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.K=re,v.L=function(){var s=new Fe(16);return Fe!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},v.M=function(s,t,a){var h,g,T,S,A,D,P,L,F,$,H,X,J=a[0],se=a[1],he=a[2];return t===s?(s[12]=t[0]*J+t[4]*se+t[8]*he+t[12],s[13]=t[1]*J+t[5]*se+t[9]*he+t[13],s[14]=t[2]*J+t[6]*se+t[10]*he+t[14],s[15]=t[3]*J+t[7]*se+t[11]*he+t[15]):(g=t[1],T=t[2],S=t[3],A=t[4],D=t[5],P=t[6],L=t[7],F=t[8],$=t[9],H=t[10],X=t[11],s[0]=h=t[0],s[1]=g,s[2]=T,s[3]=S,s[4]=A,s[5]=D,s[6]=P,s[7]=L,s[8]=F,s[9]=$,s[10]=H,s[11]=X,s[12]=h*J+A*se+F*he+t[12],s[13]=g*J+D*se+$*he+t[13],s[14]=T*J+P*se+H*he+t[14],s[15]=S*J+L*se+X*he+t[15]),s},v.N=function(s,t,a){var h=a[0],g=a[1],T=a[2];return s[0]=t[0]*h,s[1]=t[1]*h,s[2]=t[2]*h,s[3]=t[3]*h,s[4]=t[4]*g,s[5]=t[5]*g,s[6]=t[6]*g,s[7]=t[7]*g,s[8]=t[8]*T,s[9]=t[9]*T,s[10]=t[10]*T,s[11]=t[11]*T,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},v.O=function(s,t,a){var h=t[0],g=t[1],T=t[2],S=t[3],A=t[4],D=t[5],P=t[6],L=t[7],F=t[8],$=t[9],H=t[10],X=t[11],J=t[12],se=t[13],he=t[14],De=t[15],ve=a[0],we=a[1],Be=a[2],We=a[3];return s[0]=ve*h+we*A+Be*F+We*J,s[1]=ve*g+we*D+Be*$+We*se,s[2]=ve*T+we*P+Be*H+We*he,s[3]=ve*S+we*L+Be*X+We*De,s[4]=(ve=a[4])*h+(we=a[5])*A+(Be=a[6])*F+(We=a[7])*J,s[5]=ve*g+we*D+Be*$+We*se,s[6]=ve*T+we*P+Be*H+We*he,s[7]=ve*S+we*L+Be*X+We*De,s[8]=(ve=a[8])*h+(we=a[9])*A+(Be=a[10])*F+(We=a[11])*J,s[9]=ve*g+we*D+Be*$+We*se,s[10]=ve*T+we*P+Be*H+We*he,s[11]=ve*S+we*L+Be*X+We*De,s[12]=(ve=a[12])*h+(we=a[13])*A+(Be=a[14])*F+(We=a[15])*J,s[13]=ve*g+we*D+Be*$+We*se,s[14]=ve*T+we*P+Be*H+We*he,s[15]=ve*S+we*L+Be*X+We*De,s},v.P=C,v.Q=function(s,t){const a={};for(let h=0;h<t.length;h++){const g=t[h];g in s&&(a[g]=s[g])}return a},v.R=ba,v.S=Ko,v.T=Qo,v.U=Qd,v.V=km,v.W=pe,v.X=Ne,v.Y=ha,v.Z=ka,v._=c,v.a=K,v.a$=jt,v.a0=function(s,t){var a,h,g,T,S;if(!s)return t??{};if(!t)return s;let A=Object.assign({},s);if(t.removeAll&&(A={removeAll:!0}),t.remove){const D=new Set(t.remove);A.add&&(A.add=A.add.filter(L=>!D.has(L.id))),A.update&&(A.update=A.update.filter(L=>!D.has(L.id)));const P=new Set(((a=s.add)!==null&&a!==void 0?a:[]).map(L=>L.id));t.remove=t.remove.filter(L=>!P.has(L))}if(t.remove){const D=new Set(A.remove?A.remove.concat(t.remove):t.remove);A.remove=Array.from(D.values())}if(t.add){const D=A.add?A.add.concat(t.add):t.add,P=new Map(D.map(L=>[L.id,L]));A.add=Array.from(P.values())}if(t.update){const D=new Map((h=A.update)===null||h===void 0?void 0:h.map(P=>[P.id,P]));for(const P of t.update){const L=(g=D.get(P.id))!==null&&g!==void 0?g:{id:P.id};P.newGeometry&&(L.newGeometry=P.newGeometry),P.addOrUpdateProperties&&(L.addOrUpdateProperties=((T=L.addOrUpdateProperties)!==null&&T!==void 0?T:[]).concat(P.addOrUpdateProperties)),P.removeProperties&&(L.removeProperties=((S=L.removeProperties)!==null&&S!==void 0?S:[]).concat(P.removeProperties)),P.removeAllProperties&&(L.removeAllProperties=!0),D.set(P.id,L)}A.update=Array.from(D.values())}return A.remove&&A.add&&(A.remove=A.remove.filter(D=>A.add.findIndex(P=>P.id===D)===-1)),A},v.a1=dp,v.a2=lr,v.a3=25,v.a4=Im,v.a5=s=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const h of s){const g=window.document.createElement("source");Ue(h)||(t.crossOrigin="Anonymous"),g.src=h,t.appendChild(g)}})},v.a6=gt,v.a7=function(){return mi++},v.a8=U,v.a9=jh,v.aA=function(s){let t=1/0,a=1/0,h=-1/0,g=-1/0;for(const T of s)t=Math.min(t,T.x),a=Math.min(a,T.y),h=Math.max(h,T.x),g=Math.max(g,T.y);return[t,a,h,g]},v.aB=Zi,v.aC=Ee,v.aD=function(s,t,a,h,g=!1){if(!a[0]&&!a[1])return[0,0];const T=g?h==="map"?-s.bearingInRadians:0:h==="viewport"?s.bearingInRadians:0;if(T){const S=Math.sin(T),A=Math.cos(T);a=[a[0]*A-a[1]*S,a[0]*S+a[1]*A]}return[g?a[0]:Ee(t,a[0],s.zoom),g?a[1]:Ee(t,a[1],s.zoom)]},v.aF=sp,v.aG=Jd,v.aH=Am,v.aI=my,v.aJ=Hi,v.aK=xa,v.aL=ge,v.aM=cn,v.aN=Qn,v.aO=Ei,v.aP=Ts,v.aQ=ly,v.aR=rt,v.aS=Pe,v.aT=function(s){var t=new Fe(3);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t},v.aU=function(s,t,a){return s[0]=t[0]-a[0],s[1]=t[1]-a[1],s[2]=t[2]-a[2],s},v.aV=function(s,t){var a=t[0],h=t[1],g=t[2],T=a*a+h*h+g*g;return T>0&&(T=1/Math.sqrt(T)),s[0]=t[0]*T,s[1]=t[1]*T,s[2]=t[2]*T,s},v.aW=Mt,v.aX=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]},v.aY=function(s,t,a){return s[0]=t[0]*a[0],s[1]=t[1]*a[1],s[2]=t[2]*a[2],s[3]=t[3]*a[3],s},v.aZ=mt,v.a_=function(s,t,a){const h=t[0]*a[0]+t[1]*a[1]+t[2]*a[2];return h===0?null:(-(s[0]*a[0]+s[1]*a[1]+s[2]*a[2])-a[3])/h},v.aa=bl,v.ab=us,v.ac=Rm,v.ad=function(s){const t={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,g,T)=>{const S=g||T;return t[h]=!S||S.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},v.ae=ws,v.af=function(s){return Math.pow(2,s)},v.ag=Ae,v.ah=Bt,v.ai=85.051129,v.aj=hp,v.ak=function(s){return Math.log(s)/Math.LN2},v.al=function(s){var t=s[0],a=s[1];return t*t+a*a},v.am=function(s,t){const a=[];for(const h in s)h in t||a.push(h);return a},v.an=function(s,t){let a=0,h=0;if(s.kind==="constant")h=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:g,minZoom:T,maxZoom:S}=s,A=g?Bt(Or.interpolationFactor(g,t,T,S),0,1):0;s.kind==="camera"?h=fo.number(s.minSize,s.maxSize,A):a=A}return{uSizeT:a,uSize:h}},v.ap=function(s,{uSize:t,uSizeT:a},{lowerSize:h,upperSize:g}){return s.kind==="source"?h/ps:s.kind==="composite"?fo.number(h/ps,g/ps,a):t},v.aq=function(s,t){var a=t[0],h=t[1],g=t[2],T=t[3],S=t[4],A=t[5],D=t[6],P=t[7],L=t[8],F=t[9],$=t[10],H=t[11],X=t[12],J=t[13],se=t[14],he=t[15],De=a*A-h*S,ve=a*D-g*S,we=a*P-T*S,Be=h*D-g*A,We=h*P-T*A,lt=g*P-T*D,Tt=L*J-F*X,_t=L*se-$*X,xt=L*he-H*X,Ft=F*se-$*J,St=F*he-H*J,wt=$*he-H*se,tt=De*wt-ve*St+we*Ft+Be*xt-We*_t+lt*Tt;return tt?(s[0]=(A*wt-D*St+P*Ft)*(tt=1/tt),s[1]=(g*St-h*wt-T*Ft)*tt,s[2]=(J*lt-se*We+he*Be)*tt,s[3]=($*We-F*lt-H*Be)*tt,s[4]=(D*xt-S*wt-P*_t)*tt,s[5]=(a*wt-g*xt+T*_t)*tt,s[6]=(se*we-X*lt-he*ve)*tt,s[7]=(L*lt-$*we+H*ve)*tt,s[8]=(S*St-A*xt+P*Tt)*tt,s[9]=(h*xt-a*St-T*Tt)*tt,s[10]=(X*We-J*we+he*De)*tt,s[11]=(F*we-L*We-H*De)*tt,s[12]=(A*_t-S*Ft-D*Tt)*tt,s[13]=(a*Ft-h*_t+g*Tt)*tt,s[14]=(J*ve-X*Be-se*De)*tt,s[15]=(L*Be-F*ve+$*De)*tt,s):null},v.ar=ct,v.as=function(s){var t=s[0],a=s[1];return Math.sqrt(t*t+a*a)},v.at=function(s){return s[0]=0,s[1]=0,s},v.au=function(s,t,a){return s[0]=t[0]*a,s[1]=t[1]*a,s},v.av=Oh,v.aw=en,v.ax=function(s,t,a,h){const g=t.y-s.y,T=t.x-s.x,S=h.y-a.y,A=h.x-a.x,D=S*T-A*g;if(D===0)return null;const P=(A*(s.y-a.y)-S*(s.x-a.x))/D;return new C(s.x+P*T,s.y+P*g)},v.ay=uy,v.az=Rg,v.b=Qa,v.b$=class extends b{},v.b0=function(s,t,a){return s[0]=t[0]*a,s[1]=t[1]*a,s[2]=t[2]*a,s[3]=t[3]*a,s},v.b1=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]+s[3]},v.b2=cy,v.b3=qn,v.b4=function(s,t,a,h,g){var T=1/Math.tan(t/2);if(s[0]=T/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=T,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,g!=null&&g!==1/0){var S=1/(h-g);s[10]=(g+h)*S,s[14]=2*g*h*S}else s[10]=-1,s[14]=-2*h;return s},v.b5=function(s){var t=new Fe(16);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],t},v.b6=function(s,t,a){var h=Math.sin(a),g=Math.cos(a),T=t[0],S=t[1],A=t[2],D=t[3],P=t[4],L=t[5],F=t[6],$=t[7];return t!==s&&(s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=T*g+P*h,s[1]=S*g+L*h,s[2]=A*g+F*h,s[3]=D*g+$*h,s[4]=P*g-T*h,s[5]=L*g-S*h,s[6]=F*g-A*h,s[7]=$*g-D*h,s},v.b7=function(s,t,a){var h=Math.sin(a),g=Math.cos(a),T=t[4],S=t[5],A=t[6],D=t[7],P=t[8],L=t[9],F=t[10],$=t[11];return t!==s&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[4]=T*g+P*h,s[5]=S*g+L*h,s[6]=A*g+F*h,s[7]=D*g+$*h,s[8]=P*g-T*h,s[9]=L*g-S*h,s[10]=F*g-A*h,s[11]=$*g-D*h,s},v.b8=function(){const s=new Float32Array(16);return Ae(s),s},v.b9=function(){const s=new Float64Array(16);return Ae(s),s},v.bA=function(s,t){const a=nt(s,360),h=nt(t,360),g=h-a,T=h>a?g-360:g+360;return Math.abs(g)<Math.abs(T)?g:T},v.bB=function(s){return s[0]=0,s[1]=0,s[2]=0,s},v.bC=function(s,t,a,h){const g=Math.sqrt(s*s+t*t),T=Math.sqrt(a*a+h*h);s/=g,t/=g,a/=T,h/=T;const S=Math.acos(s*a+t*h);return-t*a+s*h>0?S:-S},v.bD=function(s,t){const a=nt(s,2*Math.PI),h=nt(t,2*Math.PI);return Math.min(Math.abs(a-h),Math.abs(a-h+2*Math.PI),Math.abs(a-h-2*Math.PI))},v.bE=function(){const s={},t=Re.$version;for(const a in Re.$root){const h=Re.$root[a];if(h.required){let g=null;g=a==="version"?t:h.type==="array"?[]:{},g!=null&&(s[a]=g)}}return s},v.bF=bh,v.bG=Te,v.bH=function s(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let h=0;h<t.length;h++)if(!s(t[h],a[h]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const h in t)if(!s(t[h],a[h]))return!1;return!0}return t===a},v.bI=function(s){s=s.slice();const t=Object.create(null);for(let a=0;a<s.length;a++)t[s[a].id]=s[a];for(let a=0;a<s.length;a++)"ref"in s[a]&&(s[a]=bn(s[a],t[s[a].ref]));return s},v.bJ=function(s){if(s.type==="custom")return new Bv(s);switch(s.type){case"background":return new sy(s);case"circle":return new B_(s);case"color-relief":return new G_(s);case"fill":return new _u(s);case"fill-extrusion":return new Nn(s);case"heatmap":return new Bg(s);case"hillshade":return new F_(s);case"line":return new ds(s);case"raster":return new cp(s);case"symbol":return new lp(s)}},v.bK=ur,v.bL=function(s,t){if(!s)return[{command:"setStyle",args:[t]}];let a=[];try{if(!Vt(s.version,t.version))return[{command:"setStyle",args:[t]}];Vt(s.center,t.center)||a.push({command:"setCenter",args:[t.center]}),Vt(s.state,t.state)||a.push({command:"setGlobalState",args:[t.state]}),Vt(s.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Vt(s.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),Vt(s.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),Vt(s.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),Vt(s.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),Vt(s.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),Vt(s.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),Vt(s.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),Vt(s.light,t.light)||a.push({command:"setLight",args:[t.light]}),Vt(s.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),Vt(s.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),Vt(s.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const h={},g=[];(function(S,A,D,P){let L;for(L in A=A||{},S=S||{})Object.prototype.hasOwnProperty.call(S,L)&&(Object.prototype.hasOwnProperty.call(A,L)||hr(L,D,P));for(L in A)Object.prototype.hasOwnProperty.call(A,L)&&(Object.prototype.hasOwnProperty.call(S,L)?Vt(S[L],A[L])||(S[L].type==="geojson"&&A[L].type==="geojson"&&li(S,A,L)?on(D,{command:"setGeoJSONSourceData",args:[L,A[L].data]}):yr(L,A,D,P)):ii(L,A,D))})(s.sources,t.sources,g,h);const T=[];s.layers&&s.layers.forEach(S=>{"source"in S&&h[S.source]?a.push({command:"removeLayer",args:[S.id]}):T.push(S)}),a=a.concat(g),function(S,A,D){A=A||[];const P=(S=S||[]).map(nn),L=A.map(nn),F=S.reduce(Ai,{}),$=A.reduce(Ai,{}),H=P.slice(),X=Object.create(null);let J,se,he,De,ve;for(let we=0,Be=0;we<P.length;we++)J=P[we],Object.prototype.hasOwnProperty.call($,J)?Be++:(on(D,{command:"removeLayer",args:[J]}),H.splice(H.indexOf(J,Be),1));for(let we=0,Be=0;we<L.length;we++)J=L[L.length-1-we],H[H.length-1-we]!==J&&(Object.prototype.hasOwnProperty.call(F,J)?(on(D,{command:"removeLayer",args:[J]}),H.splice(H.lastIndexOf(J,H.length-Be),1)):Be++,De=H[H.length-we],on(D,{command:"addLayer",args:[$[J],De]}),H.splice(H.length-we,0,J),X[J]=!0);for(let we=0;we<L.length;we++)if(J=L[we],se=F[J],he=$[J],!X[J]&&!Vt(se,he))if(Vt(se.source,he.source)&&Vt(se["source-layer"],he["source-layer"])&&Vt(se.type,he.type)){for(ve in Wt(se.layout,he.layout,D,J,null,"setLayoutProperty"),Wt(se.paint,he.paint,D,J,null,"setPaintProperty"),Vt(se.filter,he.filter)||on(D,{command:"setFilter",args:[J,he.filter]}),Vt(se.minzoom,he.minzoom)&&Vt(se.maxzoom,he.maxzoom)||on(D,{command:"setLayerZoomRange",args:[J,he.minzoom,he.maxzoom]}),se)Object.prototype.hasOwnProperty.call(se,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Wt(se[ve],he[ve],D,J,ve.slice(6),"setPaintProperty"):Vt(se[ve],he[ve])||on(D,{command:"setLayerProperty",args:[J,ve,he[ve]]}));for(ve in he)Object.prototype.hasOwnProperty.call(he,ve)&&!Object.prototype.hasOwnProperty.call(se,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Wt(se[ve],he[ve],D,J,ve.slice(6),"setPaintProperty"):Vt(se[ve],he[ve])||on(D,{command:"setLayerProperty",args:[J,ve,he[ve]]}))}else on(D,{command:"removeLayer",args:[J]}),De=H[H.lastIndexOf(J)+1],on(D,{command:"addLayer",args:[he,De]})}(T,t.layers,a)}catch(h){console.warn("Unable to compute style diff:",h),a=[{command:"setStyle",args:[t]}]}return a},v.bM=function(s){const t=[],a=s.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},v.bN=Ea,v.bO=ua,v.bP=class extends aa{constructor(s,t){super(s,t),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},v.bQ=Gi,v.bR=class extends aa{constructor(s,t){super(s,t),this.current=va}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let t=1;t<16;t++)if(s[t]!==this.current[t]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},v.bS=ki,v.bT=class extends aa{constructor(s,t){super(s,t),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},v.bU=class extends aa{constructor(s,t){super(s,t),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},v.bV=qe,v.bW=function(s,t){var a=Math.sin(t),h=Math.cos(t);return s[0]=h,s[1]=a,s[2]=0,s[3]=-a,s[4]=h,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},v.bX=function(s,t,a){var h=t[0],g=t[1],T=t[2];return s[0]=h*a[0]+g*a[3]+T*a[6],s[1]=h*a[1]+g*a[4]+T*a[7],s[2]=h*a[2]+g*a[5]+T*a[8],s},v.bY=function(s,t,a,h,g,T,S){var A=1/(t-a),D=1/(h-g),P=1/(T-S);return s[0]=-2*A,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*D,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(t+a)*A,s[13]=(g+h)*D,s[14]=(S+T)*P,s[15]=1,s},v.bZ=class extends aa{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(4*s.length);for(let a=0;a<s.length;a++)t[4*a]=s[a].r,t[4*a+1]=s[a].g,t[4*a+2]=s[a].b,t[4*a+3]=s[a].a;this.gl.uniform4fv(this.location,t)}}},v.b_=class extends aa{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(s);this.gl.uniform1fv(this.location,t)}}},v.ba=function(){return new Float64Array(16)},v.bb=function(s,t,a){const h=new Float64Array(4);return Ge(h,s,t-90,a),h},v.bc=function(s,t,a,h){var g,T,S,A,D,P=t[0],L=t[1],F=t[2],$=t[3],H=a[0],X=a[1],J=a[2],se=a[3];return(T=P*H+L*X+F*J+$*se)<0&&(T=-T,H=-H,X=-X,J=-J,se=-se),1-T>Ve?(g=Math.acos(T),S=Math.sin(g),A=Math.sin((1-h)*g)/S,D=Math.sin(h*g)/S):(A=1-h,D=h),s[0]=A*P+D*H,s[1]=A*L+D*X,s[2]=A*F+D*J,s[3]=A*$+D*se,s},v.bd=function(s){const t=new Float64Array(9);var a,h,g,T,S,A,D,P,L,F,$,H,X,J,se,he,De,ve;F=(g=(h=s)[0])*(D=g+g),$=(T=h[1])*D,X=(S=h[2])*D,J=S*(P=T+T),he=(A=h[3])*D,De=A*P,ve=A*(L=S+S),(a=t)[0]=1-(H=T*P)-(se=S*L),a[3]=$-ve,a[6]=X+De,a[1]=$+ve,a[4]=1-F-se,a[7]=J-he,a[2]=X-De,a[5]=J+he,a[8]=1-F-H;const we=Ts(-Math.asin(Bt(t[2],-1,1)));let Be,We;return Math.hypot(t[5],t[8])<.001?(Be=0,We=-Ts(Math.atan2(t[3],t[4]))):(Be=Ts(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),We=Ts(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Be,pitch:we+90,bearing:We}},v.be=function(s,t){return s.roll==t.roll&&s.pitch==t.pitch&&s.bearing==t.bearing},v.bf=yn,v.bg=kl,v.bh=hs,v.bi=Fd,v.bj=di,v.bk=Ct,v.bl=bt,v.bm=Vi,v.bn=function(s,t,a,h,g){return Ct(h,g,Bt((s-t)/(a-t),0,1))},v.bo=nt,v.bp=function(){return new Float64Array(3)},v.bq=function(s,t,a,h){return s[0]=t[0]+a[0]*h,s[1]=t[1]+a[1]*h,s[2]=t[2]+a[2]*h,s},v.br=Ge,v.bs=function(s,t,a){var h=a[0],g=a[1],T=a[2],S=a[3],A=t[0],D=t[1],P=t[2],L=g*P-T*D,F=T*A-h*P,$=h*D-g*A;return s[0]=A+S*(L+=L)+g*($+=$)-T*(F+=F),s[1]=D+S*F+T*L-h*$,s[2]=P+S*$+h*F-g*L,s},v.bt=function(s,t,a){const h=(g=[s[0],s[1],s[2],t[0],t[1],t[2],a[0],a[1],a[2]])[0]*((L=g[8])*(S=g[4])-(A=g[5])*(P=g[7]))+g[1]*(-L*(T=g[3])+A*(D=g[6]))+g[2]*(P*T-S*D);var g,T,S,A,D,P,L;if(h===0)return null;const F=Mt([],[t[0],t[1],t[2]],[a[0],a[1],a[2]]),$=Mt([],[a[0],a[1],a[2]],[s[0],s[1],s[2]]),H=Mt([],[s[0],s[1],s[2]],[t[0],t[1],t[2]]),X=rt([],F,-s[3]);return Pe(X,X,rt([],$,-t[3])),Pe(X,X,rt([],H,-a[3])),rt(X,X,1/h),X},v.bu=up,v.bv=function(){return new Float64Array(4)},v.bw=function(s,t,a,h){var g=[],T=[];return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],T[0]=g[0]*Math.cos(h)-g[1]*Math.sin(h),T[1]=g[0]*Math.sin(h)+g[1]*Math.cos(h),T[2]=g[2],s[0]=T[0]+a[0],s[1]=T[1]+a[1],s[2]=T[2]+a[2],s},v.bx=function(s,t,a,h){var g=[],T=[];return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],T[0]=g[0],T[1]=g[1]*Math.cos(h)-g[2]*Math.sin(h),T[2]=g[1]*Math.sin(h)+g[2]*Math.cos(h),s[0]=T[0]+a[0],s[1]=T[1]+a[1],s[2]=T[2]+a[2],s},v.by=function(s,t,a,h){var g=[],T=[];return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],T[0]=g[2]*Math.sin(h)+g[0]*Math.cos(h),T[1]=g[1],T[2]=g[2]*Math.cos(h)-g[0]*Math.sin(h),s[0]=T[0]+a[0],s[1]=T[1]+a[1],s[2]=T[2]+a[2],s},v.bz=function(s,t,a){var h=Math.sin(a),g=Math.cos(a),T=t[0],S=t[1],A=t[2],D=t[3],P=t[8],L=t[9],F=t[10],$=t[11];return t!==s&&(s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=T*g-P*h,s[1]=S*g-L*h,s[2]=A*g-F*h,s[3]=D*g-$*h,s[8]=T*h+P*g,s[9]=S*h+L*g,s[10]=A*h+F*g,s[11]=D*h+$*g,s},v.c=Me,v.c0=wa,v.c1=class extends o{},v.c2=fm,v.c3=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},v.c4=dm,v.c5=function(s,t,a){var h=t[0],g=t[1],T=t[2],S=a[3]*h+a[7]*g+a[11]*T+a[15];return s[0]=(a[0]*h+a[4]*g+a[8]*T+a[12])/(S=S||1),s[1]=(a[1]*h+a[5]*g+a[9]*T+a[13])/S,s[2]=(a[2]*h+a[6]*g+a[10]*T+a[14])/S,s},v.c6=class extends ra{},v.c7=class extends O{},v.c8=function(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]&&s[4]===t[4]&&s[5]===t[5]&&s[6]===t[6]&&s[7]===t[7]&&s[8]===t[8]&&s[9]===t[9]&&s[10]===t[10]&&s[11]===t[11]&&s[12]===t[12]&&s[13]===t[13]&&s[14]===t[14]&&s[15]===t[15]},v.c9=function(s,t){var a=s[0],h=s[1],g=s[2],T=s[3],S=s[4],A=s[5],D=s[6],P=s[7],L=s[8],F=s[9],$=s[10],H=s[11],X=s[12],J=s[13],se=s[14],he=s[15],De=t[0],ve=t[1],we=t[2],Be=t[3],We=t[4],lt=t[5],Tt=t[6],_t=t[7],xt=t[8],Ft=t[9],St=t[10],wt=t[11],tt=t[12],qt=t[13],Kt=t[14],Zt=t[15];return Math.abs(a-De)<=Ve*Math.max(1,Math.abs(a),Math.abs(De))&&Math.abs(h-ve)<=Ve*Math.max(1,Math.abs(h),Math.abs(ve))&&Math.abs(g-we)<=Ve*Math.max(1,Math.abs(g),Math.abs(we))&&Math.abs(T-Be)<=Ve*Math.max(1,Math.abs(T),Math.abs(Be))&&Math.abs(S-We)<=Ve*Math.max(1,Math.abs(S),Math.abs(We))&&Math.abs(A-lt)<=Ve*Math.max(1,Math.abs(A),Math.abs(lt))&&Math.abs(D-Tt)<=Ve*Math.max(1,Math.abs(D),Math.abs(Tt))&&Math.abs(P-_t)<=Ve*Math.max(1,Math.abs(P),Math.abs(_t))&&Math.abs(L-xt)<=Ve*Math.max(1,Math.abs(L),Math.abs(xt))&&Math.abs(F-Ft)<=Ve*Math.max(1,Math.abs(F),Math.abs(Ft))&&Math.abs($-St)<=Ve*Math.max(1,Math.abs($),Math.abs(St))&&Math.abs(H-wt)<=Ve*Math.max(1,Math.abs(H),Math.abs(wt))&&Math.abs(X-tt)<=Ve*Math.max(1,Math.abs(X),Math.abs(tt))&&Math.abs(J-qt)<=Ve*Math.max(1,Math.abs(J),Math.abs(qt))&&Math.abs(se-Kt)<=Ve*Math.max(1,Math.abs(se),Math.abs(Kt))&&Math.abs(he-Zt)<=Ve*Math.max(1,Math.abs(he),Math.abs(Zt))},v.cA=function(s,t){K.REGISTERED_PROTOCOLS[s]=t},v.cB=function(s){delete K.REGISTERED_PROTOCOLS[s]},v.cC=function(s,t){const a={};for(let g=0;g<s.length;g++){const T=t&&t[s[g].id]||gc(s[g]);t&&(t[s[g].id]=T);let S=a[T];S||(S=a[T]=[]),S.push(s[g])}const h=[];for(const g in a)h.push(a[g]);return h},v.cD=Dt,v.cE=y0,v.cF=Pm,v.cG=s0,v.cH=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=kt/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const t=s.bucket.layers[0],a=t.layout,h=t._unevaluatedLayout._values,g={layoutIconSize:h["icon-size"].possiblyEvaluate(new $n(s.bucket.zoom+1),s.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new $n(s.bucket.zoom+1),s.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new $n(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=s.bucket.textSizeData;g.compositeTextSizes=[h["text-size"].possiblyEvaluate(new $n(P),s.canonical),h["text-size"].possiblyEvaluate(new $n(L),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=s.bucket.iconSizeData;g.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new $n(P),s.canonical),h["icon-size"].possiblyEvaluate(new $n(L),s.canonical)]}const T=a.get("text-line-height")*Zi,S=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",A=a.get("text-keep-upright"),D=a.get("text-size");for(const P of s.bucket.features){const L=a.get("text-font").evaluate(P,{},s.canonical).join(","),F=D.evaluate(P,{},s.canonical),$=g.layoutTextSize.evaluate(P,{},s.canonical),H=g.layoutIconSize.evaluate(P,{},s.canonical),X={horizontal:{},vertical:void 0},J=P.text;let se,he=[0,0];if(J){const we=J.toString(),Be=a.get("text-letter-spacing").evaluate(P,{},s.canonical)*Zi,We=Uf(we)?Be:0,lt=a.get("text-anchor").evaluate(P,{},s.canonical),Tt=fy(t,P,s.canonical);if(!Tt){const St=a.get("text-radial-offset").evaluate(P,{},s.canonical);he=St?Bs(lt,[St*Zi,Uh]):a.get("text-offset").evaluate(P,{},s.canonical).map(wt=>wt*Zi)}let _t=S?"center":a.get("text-justify").evaluate(P,{},s.canonical);const xt=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(P,{},s.canonical)*Zi:1/0,Ft=()=>{s.bucket.allowVerticalPlacement&&ks(we)&&(X.vertical=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,L,xt,T,lt,"left",We,he,v.ao.vertical,!0,$,F))};if(!S&&Tt){const St=new Set;if(_t==="auto")for(let tt=0;tt<Tt.values.length;tt+=2)St.add(Jd(Tt.values[tt]));else St.add(_t);let wt=!1;for(const tt of St)if(!X.horizontal[tt])if(wt)X.horizontal[tt]=X.horizontal[0];else{const qt=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,L,xt,T,"center",tt,We,he,v.ao.horizontal,!1,$,F);qt&&(X.horizontal[tt]=qt,wt=qt.positionedLines.length===1)}Ft()}else{_t==="auto"&&(_t=Jd(lt));const St=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,L,xt,T,lt,_t,We,he,v.ao.horizontal,!1,$,F);St&&(X.horizontal[_t]=St),Ft(),ks(we)&&S&&A&&(X.vertical=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,L,xt,T,lt,_t,We,he,v.ao.vertical,!1,$,F))}}let De=!1;if(P.icon&&P.icon.name){const we=s.imageMap[P.icon.name];we&&(se=Lv(s.imagePositions[P.icon.name],a.get("icon-offset").evaluate(P,{},s.canonical),a.get("icon-anchor").evaluate(P,{},s.canonical)),De=!!we.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=De:s.bucket.sdfIcons!==De&&Xn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(we.pixelRatio!==s.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ve=S0(X.horizontal)||X.vertical;s.bucket.iconsInText=!!ve&&ve.iconsInText,(ve||se)&&Pc(s.bucket,P,X,se,s.imageMap,g,$,H,he,De,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},v.cI=Nl,v.cJ=$a,v.cK=Yd,v.cL=qg,v.cM=zh,v.cN=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},v.cO=function(s,t,a,h,g){return c(this,void 0,void 0,function*(){if(Ne())try{return yield ha(s,t,a,h,g)}catch{}return function(T,S,A,D,P){const L=T.width,F=T.height;qr&&xs||(qr=new OffscreenCanvas(L,F),xs=qr.getContext("2d",{willReadFrequently:!0})),qr.width=L,qr.height=F,xs.drawImage(T,0,0,L,F);const $=xs.getImageData(S,A,D,P);return xs.clearRect(0,0,L,F),$.data}(s,t,a,h,g)})},v.cP=mm,v.cQ=R,v.cR=Gd,v.cS=Rh,v.cT=mo,v.cU=function(s,t){const a=new Map;if(s!=null)if(s.type==="Feature")a.set(Bh(s,t),s);else for(const h of s.features)a.set(Bh(h,t),h);return a},v.cV=function(s,t){if(s==null)return!0;if(s.type==="Feature")return Bh(s,t)!=null;if(s.type==="FeatureCollection"){const a=new Set;for(const h of s.features){const g=Bh(h,t);if(g==null||a.has(g))return!1;a.add(g)}return!0}return!1},v.cW=function(s,t,a){var h,g,T,S;if(t.removeAll&&s.clear(),t.remove)for(const A of t.remove)s.delete(A);if(t.add)for(const A of t.add){const D=Bh(A,a);D!=null&&s.set(D,A)}if(t.update)for(const A of t.update){let D=s.get(A.id);if(D==null)continue;const P=!A.removeAllProperties&&(((h=A.removeProperties)===null||h===void 0?void 0:h.length)>0||((g=A.addOrUpdateProperties)===null||g===void 0?void 0:g.length)>0);if((A.newGeometry||A.removeAllProperties||P)&&(D=Object.assign({},D),s.set(A.id,D),P&&(D.properties=Object.assign({},D.properties))),A.newGeometry&&(D.geometry=A.newGeometry),A.removeAllProperties)D.properties={};else if(((T=A.removeProperties)===null||T===void 0?void 0:T.length)>0)for(const L of A.removeProperties)Object.prototype.hasOwnProperty.call(D.properties,L)&&delete D.properties[L];if(((S=A.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0)for(const{key:L,value:F}of A.addOrUpdateProperties)D.properties[L]=F}},v.cX=ia,v.ca=function(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},v.cb=s=>s.type==="symbol",v.cc=s=>s.type==="circle",v.cd=s=>s.type==="heatmap",v.ce=s=>s.type==="line",v.cf=s=>s.type==="fill",v.cg=s=>s.type==="fill-extrusion",v.ch=s=>s.type==="hillshade",v.ci=s=>s.type==="color-relief",v.cj=s=>s.type==="raster",v.ck=s=>s.type==="background",v.cl=s=>s.type==="custom",v.cm=Pt,v.cn=function(s,t,a){const h=ht(t.x-a.x,t.y-a.y),g=ht(s.x-a.x,s.y-a.y);var T,S;return Ts(Math.atan2(h[0]*g[1]-h[1]*g[0],(T=h)[0]*(S=g)[0]+T[1]*S[1]))},v.co=Xt,v.cp=function(s,t){return Bi[t]&&(s instanceof MouseEvent||s instanceof WheelEvent)},v.cq=function(s,t){return da[t]&&"touches"in s},v.cr=function(s){return da[s]||Bi[s]},v.cs=function(s,t,a){var h=t[0],g=t[1];return s[0]=a[0]*h+a[4]*g+a[12],s[1]=a[1]*h+a[5]*g+a[13],s},v.ct=function(s,t){const{x:a,y:h}=dp.fromLngLat(t);return!(s<0||s>25||h<0||h>=1||a<0||a>=1)},v.cu=function(s,t){return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},v.cv=class extends Al{},v.cw=tf,v.cy=function(s){return s.message===Hr},v.cz=ye,v.d=Ue,v.e=mn,v.f=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.g=ee,v.h=s=>new Promise((t,a)=>{const h=new Image;h.onload=()=>{t(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=za})},h.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(s)],{type:"image/png"});h.src=s.byteLength?URL.createObjectURL(g):za}),v.i=Yr,v.j=(s,t)=>Ce(mn(s,{type:"json"}),t),v.k=it,v.l=ft,v.m=Ce,v.n=(s,t)=>Ce(mn(s,{type:"arrayBuffer"}),t),v.o=function(s){return new zh(s).readFields(i0,[])},v.p=Sm,v.q=Ah,v.r=ya,v.s=Ka,v.t=Pd,v.u=En,v.v=Re,v.w=Xn,v.x=am,v.y=cu,v.z=lu}),m("worker",["./shared"],function(v){class c{constructor(K){this.keyCache={},K&&this.replace(K)}replace(K){this._layerConfigs={},this._layers={},this.update(K,[])}update(K,ee){for(const ye of K){this._layerConfigs[ye.id]=ye;const Te=this._layers[ye.id]=v.bJ(ye);Te._featureFilter=v.aa(Te.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(const ye of ee)delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye];this.familiesBySource={};const re=v.cC(Object.values(this._layerConfigs),this.keyCache);for(const ye of re){const Te=ye.map(it=>this._layers[it.id]),Ce=Te[0];if(Ce.visibility==="none")continue;const Ue=Ce.source||"";let Ie=this.familiesBySource[Ue];Ie||(Ie=this.familiesBySource[Ue]={});const Je=Ce.sourceLayer||"_geojsonTileLayer";let ft=Ie[Je];ft||(ft=Ie[Je]=[]),ft.push(Te)}}}class C{constructor(K){const ee={},re=[];for(const Ue in K){const Ie=K[Ue],Je=ee[Ue]={};for(const ft in Ie){const it=Ie[+ft];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const Lt={x:0,y:0,w:it.bitmap.width+2,h:it.bitmap.height+2};re.push(Lt),Je[ft]={rect:Lt,metrics:it.metrics}}}const{w:ye,h:Te}=v.p(re),Ce=new v.q({width:ye||1,height:Te||1});for(const Ue in K){const Ie=K[Ue];for(const Je in Ie){const ft=Ie[+Je];if(!ft||ft.bitmap.width===0||ft.bitmap.height===0)continue;const it=ee[Ue][Je].rect;v.q.copy(ft.bitmap,Ce,{x:0,y:0},{x:it.x+1,y:it.y+1},ft.bitmap)}}this.image=Ce,this.positions=ee}}v.cD("GlyphAtlas",C);class R{constructor(K){this.tileID=new v.Z(K.tileID.overscaledZ,K.tileID.wrap,K.tileID.canonical.z,K.tileID.canonical.x,K.tileID.canonical.y),this.uid=K.uid,this.zoom=K.zoom,this.pixelRatio=K.pixelRatio,this.tileSize=K.tileSize,this.source=K.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=K.showCollisionBoxes,this.collectResourceTiming=!!K.collectResourceTiming,this.returnDependencies=!!K.returnDependencies,this.promoteId=K.promoteId,this.inFlightDependencies=[],this.globalState=K.globalState}parse(K,ee,re,ye,Te){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=K,this.collisionBoxArray=new v.a8;const Ce=new v.cE(Object.keys(K.layers).sort()),Ue=new v.cF(this.tileID,this.promoteId);Ue.bucketLayerIDs=[];const Ie={},Je={featureIndex:Ue,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:re,subdivisionGranularity:Te},ft=ee.familiesBySource[this.source];for(const Wt in ft){const nn=K.layers[Wt];if(!nn)continue;nn.version===1&&v.w(`Vector tile source "${this.source}" layer "${Wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ai=Ce.encode(Wt),gt=[];for(let Xr=0;Xr<nn.length;Xr++){const Fi=nn.feature(Xr),ko=Ue.getId(Fi,Wt);gt.push({feature:Fi,id:ko,index:Xr,sourceLayerIndex:Ai})}for(const Xr of ft[Wt]){const Fi=Xr[0];Fi.source!==this.source&&v.w(`layer.source = ${Fi.source} does not equal this.source = ${this.source}`),Fi.minzoom&&this.zoom<Math.floor(Fi.minzoom)||Fi.maxzoom&&this.zoom>=Fi.maxzoom||Fi.visibility!=="none"&&(N(Xr,this.zoom,re,this.globalState),(Ie[Fi.id]=Fi.createBucket({index:Ue.bucketLayerIDs.length,layers:Xr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ai,sourceID:this.source,globalState:this.globalState})).populate(gt,Je,this.tileID.canonical),Ue.bucketLayerIDs.push(Xr.map(ko=>ko.id)))}}const it=v.bN(Je.glyphDependencies,Wt=>Object.keys(Wt).map(Number));this.inFlightDependencies.forEach(Wt=>Wt?.abort()),this.inFlightDependencies=[];let Lt=Promise.resolve({});if(Object.keys(it).length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),Lt=ye.sendAsync({type:"GG",data:{stacks:it,source:this.source,tileID:this.tileID,type:"glyphs"}},Wt)}const Re=Object.keys(Je.iconDependencies);let tn=Promise.resolve({});if(Re.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),tn=ye.sendAsync({type:"GI",data:{icons:Re,source:this.source,tileID:this.tileID,type:"icons"}},Wt)}const bn=Object.keys(Je.patternDependencies);let Vt=Promise.resolve({});if(bn.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),Vt=ye.sendAsync({type:"GI",data:{icons:bn,source:this.source,tileID:this.tileID,type:"patterns"}},Wt)}const[on,ii,hr]=yield Promise.all([Lt,tn,Vt]),yr=new C(on),li=new v.cG(ii,hr);for(const Wt in Ie){const nn=Ie[Wt];nn instanceof v.a9?(N(nn.layers,this.zoom,re,this.globalState),v.cH({bucket:nn,glyphMap:on,glyphPositions:yr.positions,imageMap:ii,imagePositions:li.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Je.subdivisionGranularity})):nn.hasPattern&&(nn instanceof v.cI||nn instanceof v.cJ||nn instanceof v.cK)&&(N(nn.layers,this.zoom,re,this.globalState),nn.addFeatures(Je,this.tileID.canonical,li.patternPositions))}return this.status="done",{buckets:Object.values(Ie).filter(Wt=>!Wt.isEmpty()),featureIndex:Ue,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yr.image,imageAtlas:li,glyphMap:this.returnDependencies?on:null,iconMap:this.returnDependencies?ii:null,glyphPositions:this.returnDependencies?yr.positions:null}})}}function N(Me,K,ee,re){const ye=new v.F(K);for(const Te of Me)Te.setGlobalState(re),Te.recalculate(ye,ee)}class B{constructor(K,ee,re){this.actor=K,this.layerIndex=ee,this.availableImages=re,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(K,ee){return v._(this,void 0,void 0,function*(){const re=yield v.n(K.request,ee);try{return{vectorTile:new v.cL(new v.cM(re.data)),rawData:re.data,cacheControl:re.cacheControl,expires:re.expires}}catch(ye){const Te=new Uint8Array(re.data);let Ce=`Unable to parse the tile at ${K.request.url}, `;throw Ce+=Te[0]===31&&Te[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ye.message}`,new Error(Ce)}})}loadTile(K){return v._(this,void 0,void 0,function*(){const ee=K.uid,re=!!(K&&K.request&&K.request.collectResourceTiming)&&new v.cN(K.request),ye=new R(K);this.loading[ee]=ye;const Te=new AbortController;ye.abort=Te;try{const Ce=yield this.loadVectorTile(K,Te);if(delete this.loading[ee],!Ce)return null;const Ue=Ce.rawData,Ie={};Ce.expires&&(Ie.expires=Ce.expires),Ce.cacheControl&&(Ie.cacheControl=Ce.cacheControl);const Je={};if(re){const it=re.finish();it&&(Je.resourceTiming=JSON.parse(JSON.stringify(it)))}ye.vectorTile=Ce.vectorTile;const ft=ye.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);this.loaded[ee]=ye,this.fetching[ee]={rawTileData:Ue,cacheControl:Ie,resourceTiming:Je};try{const it=yield ft;return v.e({rawTileData:Ue.slice(0)},it,Ie,Je)}finally{delete this.fetching[ee]}}catch(Ce){throw delete this.loading[ee],ye.status="done",this.loaded[ee]=ye,Ce}})}reloadTile(K){return v._(this,void 0,void 0,function*(){const ee=K.uid;if(!this.loaded||!this.loaded[ee])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const re=this.loaded[ee];if(re.showCollisionBoxes=K.showCollisionBoxes,re.globalState=K.globalState,re.status==="parsing"){const ye=yield re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);let Te;if(this.fetching[ee]){const{rawTileData:Ce,cacheControl:Ue,resourceTiming:Ie}=this.fetching[ee];delete this.fetching[ee],Te=v.e({rawTileData:Ce.slice(0)},ye,Ue,Ie)}else Te=ye;return Te}if(re.status==="done"&&re.vectorTile)return re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity)})}abortTile(K){return v._(this,void 0,void 0,function*(){const ee=this.loading,re=K.uid;ee&&ee[re]&&ee[re].abort&&(ee[re].abort.abort(),delete ee[re])})}removeTile(K){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[K.uid]&&delete this.loaded[K.uid]})}}class V{constructor(){this.loaded={}}loadTile(K){return v._(this,void 0,void 0,function*(){const{uid:ee,encoding:re,rawImageData:ye,redFactor:Te,greenFactor:Ce,blueFactor:Ue,baseShift:Ie}=K,Je=ye.width+2,ft=ye.height+2,it=v.b(ye)?new v.R({width:Je,height:ft},yield v.cO(ye,-1,-1,Je,ft)):ye,Lt=new v.cP(ee,it,re,Te,Ce,Ue,Ie);return this.loaded=this.loaded||{},this.loaded[ee]=Lt,Lt})}removeTile(K){const ee=this.loaded,re=K.uid;ee&&ee[re]&&delete ee[re]}}var G,ae,me=function(){if(ae)return G;function Me(ee,re){if(ee.length!==0){K(ee[0],re);for(var ye=1;ye<ee.length;ye++)K(ee[ye],!re)}}function K(ee,re){for(var ye=0,Te=0,Ce=0,Ue=ee.length,Ie=Ue-1;Ce<Ue;Ie=Ce++){var Je=(ee[Ce][0]-ee[Ie][0])*(ee[Ie][1]+ee[Ce][1]),ft=ye+Je;Te+=Math.abs(ye)>=Math.abs(Je)?ye-ft+Je:Je-ft+ye,ye=ft}ye+Te>=0!=!!re&&ee.reverse()}return ae=1,G=function ee(re,ye){var Te,Ce=re&&re.type;if(Ce==="FeatureCollection")for(Te=0;Te<re.features.length;Te++)ee(re.features[Te],ye);else if(Ce==="GeometryCollection")for(Te=0;Te<re.geometries.length;Te++)ee(re.geometries[Te],ye);else if(Ce==="Feature")ee(re.geometry,ye);else if(Ce==="Polygon")Me(re.coordinates,ye);else if(Ce==="MultiPolygon")for(Te=0;Te<re.coordinates.length;Te++)Me(re.coordinates[Te],ye);return re}}(),pe=v.cQ(me);class Ne extends v.cS{constructor(K,ee){super(new v.cM,0,ee,[],[]),this.feature=K,this.type=K.type,this.properties=K.tags?K.tags:{},"id"in K&&(typeof K.id=="string"?this.id=parseInt(K.id,10):typeof K.id!="number"||isNaN(K.id)||(this.id=K.id))}loadGeometry(){const K=[],ee=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const re of ee){const ye=[];for(const Te of re)ye.push(new v.P(Te[0],Te[1]));K.push(ye)}return K}}class Ve extends v.cR{constructor(K,ee){super(new v.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ee?ee.version:1,this.extent=ee?ee.extent:4096,this.length=K.length,this.features=K}feature(K){return new Ne(this.features[K],this.extent)}}function Fe(Me,K){K.writeVarintField(15,Me.version||1),K.writeStringField(1,Me.name||""),K.writeVarintField(5,Me.extent||4096);const ee={keys:[],values:[],keycache:{},valuecache:{}};for(let Te=0;Te<Me.length;Te++)ee.feature=Me.feature(Te),K.writeMessage(2,qe,ee);const re=ee.keys;for(const Te of re)K.writeStringField(3,Te);const ye=ee.values;for(const Te of ye)K.writeMessage(4,Pe,Te)}function qe(Me,K){if(!Me.feature)return;const ee=Me.feature;ee.id!==void 0&&K.writeVarintField(1,ee.id),K.writeMessage(2,Ae,Me),K.writeVarintField(3,ee.type),K.writeMessage(4,st,ee)}function Ae(Me,K){for(const ee in Me.feature?.properties){let re=Me.feature.properties[ee],ye=Me.keycache[ee];if(re===null)continue;ye===void 0&&(Me.keys.push(ee),ye=Me.keys.length-1,Me.keycache[ee]=ye),K.writeVarint(ye),typeof re!="string"&&typeof re!="boolean"&&typeof re!="number"&&(re=JSON.stringify(re));const Te=typeof re+":"+re;let Ce=Me.valuecache[Te];Ce===void 0&&(Me.values.push(re),Ce=Me.values.length-1,Me.valuecache[Te]=Ce),K.writeVarint(Ce)}}function Ke(Me,K){return(K<<3)+(7&Me)}function mt(Me){return Me<<1^Me>>31}function st(Me,K){const ee=Me.loadGeometry(),re=Me.type;let ye=0,Te=0;for(const Ce of ee){let Ue=1;re===1&&(Ue=Ce.length),K.writeVarint(Ke(1,Ue));const Ie=re===3?Ce.length-1:Ce.length;for(let Je=0;Je<Ie;Je++){Je===1&&re!==1&&K.writeVarint(Ke(2,Ie-1));const ft=Ce[Je].x-ye,it=Ce[Je].y-Te;K.writeVarint(mt(ft)),K.writeVarint(mt(it)),ye+=ft,Te+=it}Me.type===3&&K.writeVarint(Ke(7,1))}}function Pe(Me,K){const ee=typeof Me;ee==="string"?K.writeStringField(1,Me):ee==="boolean"?K.writeBooleanField(7,Me):ee==="number"&&(Me%1!=0?K.writeDoubleField(3,Me):Me<0?K.writeSVarintField(6,Me):K.writeVarintField(5,Me))}const rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Mt=Math.fround||(Rt=new Float32Array(1),Me=>(Rt[0]=+Me,Rt[0]));var Rt;class jt{constructor(K){this.options=Object.assign(Object.create(rt),K),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(K){const{log:ee,minZoom:re,maxZoom:ye}=this.options;ee&&console.time("total time");const Te=`prepare ${K.length} points`;ee&&console.time(Te),this.points=K;const Ce=[];for(let Ie=0;Ie<K.length;Ie++){const Je=K[Ie];if(!Je.geometry)continue;const[ft,it]=Je.geometry.coordinates,Lt=Mt(Ge(ft)),Re=Mt(ct(it));Ce.push(Lt,Re,1/0,Ie,-1,1),this.options.reduce&&Ce.push(0)}let Ue=this.trees[ye+1]=this._createTree(Ce);ee&&console.timeEnd(Te);for(let Ie=ye;Ie>=re;Ie--){const Je=+Date.now();Ue=this.trees[Ie]=this._createTree(this._cluster(Ue,Ie)),ee&&console.log("z%d: %d clusters in %dms",Ie,Ue.numItems,+Date.now()-Je)}return ee&&console.timeEnd("total time"),this}getClusters(K,ee){let re=((K[0]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,K[1]));let Te=K[2]===180?180:((K[2]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)re=-180,Te=180;else if(re>Te){const it=this.getClusters([re,ye,180,Ce],ee),Lt=this.getClusters([-180,ye,Te,Ce],ee);return it.concat(Lt)}const Ue=this.trees[this._limitZoom(ee)],Ie=Ue.range(Ge(re),ct(Ce),Ge(Te),ct(ye)),Je=Ue.data,ft=[];for(const it of Ie){const Lt=this.stride*it;ft.push(Je[Lt+5]>1?en(Je,Lt,this.clusterProps):this.points[Je[Lt+3]])}return ft}getChildren(K){const ee=this._getOriginId(K),re=this._getOriginZoom(K),ye="No cluster with the specified id.",Te=this.trees[re];if(!Te)throw new Error(ye);const Ce=Te.data;if(ee*this.stride>=Ce.length)throw new Error(ye);const Ue=this.options.radius/(this.options.extent*Math.pow(2,re-1)),Ie=Te.within(Ce[ee*this.stride],Ce[ee*this.stride+1],Ue),Je=[];for(const ft of Ie){const it=ft*this.stride;Ce[it+4]===K&&Je.push(Ce[it+5]>1?en(Ce,it,this.clusterProps):this.points[Ce[it+3]])}if(Je.length===0)throw new Error(ye);return Je}getLeaves(K,ee,re){const ye=[];return this._appendLeaves(ye,K,ee=ee||10,re=re||0,0),ye}getTile(K,ee,re){const ye=this.trees[this._limitZoom(K)],Te=Math.pow(2,K),{extent:Ce,radius:Ue}=this.options,Ie=Ue/Ce,Je=(re-Ie)/Te,ft=(re+1+Ie)/Te,it={features:[]};return this._addTileFeatures(ye.range((ee-Ie)/Te,Je,(ee+1+Ie)/Te,ft),ye.data,ee,re,Te,it),ee===0&&this._addTileFeatures(ye.range(1-Ie/Te,Je,1,ft),ye.data,Te,re,Te,it),ee===Te-1&&this._addTileFeatures(ye.range(0,Je,Ie/Te,ft),ye.data,-1,re,Te,it),it.features.length?it:null}getClusterExpansionZoom(K){let ee=this._getOriginZoom(K)-1;for(;ee<=this.options.maxZoom;){const re=this.getChildren(K);if(ee++,re.length!==1)break;K=re[0].properties.cluster_id}return ee}_appendLeaves(K,ee,re,ye,Te){const Ce=this.getChildren(ee);for(const Ue of Ce){const Ie=Ue.properties;if(Ie&&Ie.cluster?Te+Ie.point_count<=ye?Te+=Ie.point_count:Te=this._appendLeaves(K,Ie.cluster_id,re,ye,Te):Te<ye?Te++:K.push(Ue),K.length===re)break}return Te}_createTree(K){const ee=new v.aI(K.length/this.stride|0,this.options.nodeSize,Float32Array);for(let re=0;re<K.length;re+=this.stride)ee.add(K[re],K[re+1]);return ee.finish(),ee.data=K,ee}_addTileFeatures(K,ee,re,ye,Te,Ce){for(const Ue of K){const Ie=Ue*this.stride,Je=ee[Ie+5]>1;let ft,it,Lt;if(Je)ft=ln(ee,Ie,this.clusterProps),it=ee[Ie],Lt=ee[Ie+1];else{const bn=this.points[ee[Ie+3]];ft=bn.properties;const[Vt,on]=bn.geometry.coordinates;it=Ge(Vt),Lt=ct(on)}const Re={type:1,geometry:[[Math.round(this.options.extent*(it*Te-re)),Math.round(this.options.extent*(Lt*Te-ye))]],tags:ft};let tn;tn=Je||this.options.generateId?ee[Ie+3]:this.points[ee[Ie+3]].id,tn!==void 0&&(Re.id=tn),Ce.features.push(Re)}}_limitZoom(K){return Math.max(this.options.minZoom,Math.min(Math.floor(+K),this.options.maxZoom+1))}_cluster(K,ee){const{radius:re,extent:ye,reduce:Te,minPoints:Ce}=this.options,Ue=re/(ye*Math.pow(2,ee)),Ie=K.data,Je=[],ft=this.stride;for(let it=0;it<Ie.length;it+=ft){if(Ie[it+2]<=ee)continue;Ie[it+2]=ee;const Lt=Ie[it],Re=Ie[it+1],tn=K.within(Ie[it],Ie[it+1],Ue),bn=Ie[it+5];let Vt=bn;for(const on of tn){const ii=on*ft;Ie[ii+2]>ee&&(Vt+=Ie[ii+5])}if(Vt>bn&&Vt>=Ce){let on,ii=Lt*bn,hr=Re*bn,yr=-1;const li=(it/ft<<5)+(ee+1)+this.points.length;for(const Wt of tn){const nn=Wt*ft;if(Ie[nn+2]<=ee)continue;Ie[nn+2]=ee;const Ai=Ie[nn+5];ii+=Ie[nn]*Ai,hr+=Ie[nn+1]*Ai,Ie[nn+4]=li,Te&&(on||(on=this._map(Ie,it,!0),yr=this.clusterProps.length,this.clusterProps.push(on)),Te(on,this._map(Ie,nn)))}Ie[it+4]=li,Je.push(ii/Vt,hr/Vt,1/0,li,-1,Vt),Te&&Je.push(yr)}else{for(let on=0;on<ft;on++)Je.push(Ie[it+on]);if(Vt>1)for(const on of tn){const ii=on*ft;if(!(Ie[ii+2]<=ee)){Ie[ii+2]=ee;for(let hr=0;hr<ft;hr++)Je.push(Ie[ii+hr])}}}}return Je}_getOriginId(K){return K-this.points.length>>5}_getOriginZoom(K){return(K-this.points.length)%32}_map(K,ee,re){if(K[ee+5]>1){const Ce=this.clusterProps[K[ee+6]];return re?Object.assign({},Ce):Ce}const ye=this.points[K[ee+3]].properties,Te=this.options.map(ye);return re&&Te===ye?Object.assign({},Te):Te}}function en(Me,K,ee){return{type:"Feature",id:Me[K+3],properties:ln(Me,K,ee),geometry:{type:"Point",coordinates:[(re=Me[K],360*(re-.5)),ht(Me[K+1])]}};var re}function ln(Me,K,ee){const re=Me[K+5],ye=re>=1e4?`${Math.round(re/1e3)}k`:re>=1e3?Math.round(re/100)/10+"k":re,Te=Me[K+6],Ce=Te===-1?{}:Object.assign({},ee[Te]);return Object.assign(Ce,{cluster:!0,cluster_id:Me[K+3],point_count:re,point_count_abbreviated:ye})}function Ge(Me){return Me/360+.5}function ct(Me){const K=Math.sin(Me*Math.PI/180),ee=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return ee<0?0:ee>1?1:ee}function ht(Me){const K=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(K))/Math.PI-90}function kt(Me,K,ee,re){let ye=re;const Te=K+(ee-K>>1);let Ce,Ue=ee-K;const Ie=Me[K],Je=Me[K+1],ft=Me[ee],it=Me[ee+1];for(let Lt=K+3;Lt<ee;Lt+=3){const Re=Ee(Me[Lt],Me[Lt+1],Ie,Je,ft,it);if(Re>ye)Ce=Lt,ye=Re;else if(Re===ye){const tn=Math.abs(Lt-Te);tn<Ue&&(Ce=Lt,Ue=tn)}}ye>re&&(Ce-K>3&&kt(Me,K,Ce,re),Me[Ce+2]=ye,ee-Ce>3&&kt(Me,Ce,ee,re))}function Ee(Me,K,ee,re,ye,Te){let Ce=ye-ee,Ue=Te-re;if(Ce!==0||Ue!==0){const Ie=((Me-ee)*Ce+(K-re)*Ue)/(Ce*Ce+Ue*Ue);Ie>1?(ee=ye,re=Te):Ie>0&&(ee+=Ce*Ie,re+=Ue*Ie)}return Ce=Me-ee,Ue=K-re,Ce*Ce+Ue*Ue}function nt(Me,K,ee,re){const ye={id:Me??null,type:K,geometry:ee,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(K==="Point"||K==="MultiPoint"||K==="LineString")Ct(ye,ee);else if(K==="Polygon")Ct(ye,ee[0]);else if(K==="MultiLineString")for(const Te of ee)Ct(ye,Te);else if(K==="MultiPolygon")for(const Te of ee)Ct(ye,Te[0]);return ye}function Ct(Me,K){for(let ee=0;ee<K.length;ee+=3)Me.minX=Math.min(Me.minX,K[ee]),Me.minY=Math.min(Me.minY,K[ee+1]),Me.maxX=Math.max(Me.maxX,K[ee]),Me.maxY=Math.max(Me.maxY,K[ee+1])}function bt(Me,K,ee,re){if(!K.geometry)return;const ye=K.geometry.coordinates;if(ye&&ye.length===0)return;const Te=K.geometry.type,Ce=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2);let Ue=[],Ie=K.id;if(ee.promoteId?Ie=K.properties[ee.promoteId]:ee.generateId&&(Ie=re||0),Te==="Point")Pt(ye,Ue);else if(Te==="MultiPoint")for(const Je of ye)Pt(Je,Ue);else if(Te==="LineString")Xt(ye,Ue,Ce,!1);else if(Te==="MultiLineString"){if(ee.lineMetrics){for(const Je of ye)Ue=[],Xt(Je,Ue,Ce,!1),Me.push(nt(Ie,"LineString",Ue,K.properties));return}Bt(ye,Ue,Ce,!1)}else if(Te==="Polygon")Bt(ye,Ue,Ce,!0);else{if(Te!=="MultiPolygon"){if(Te==="GeometryCollection"){for(const Je of K.geometry.geometries)bt(Me,{id:Ie,geometry:Je,properties:K.properties},ee,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Je of ye){const ft=[];Bt(Je,ft,Ce,!0),Ue.push(ft)}}Me.push(nt(Ie,Te,Ue,K.properties))}function Pt(Me,K){K.push(Ei(Me[0]),mn(Me[1]),0)}function Xt(Me,K,ee,re){let ye,Te,Ce=0;for(let Ie=0;Ie<Me.length;Ie++){const Je=Ei(Me[Ie][0]),ft=mn(Me[Ie][1]);K.push(Je,ft,0),Ie>0&&(Ce+=re?(ye*ft-Je*Te)/2:Math.sqrt(Math.pow(Je-ye,2)+Math.pow(ft-Te,2))),ye=Je,Te=ft}const Ue=K.length-3;K[2]=1,kt(K,0,Ue,ee),K[Ue+2]=1,K.size=Math.abs(Ce),K.start=0,K.end=K.size}function Bt(Me,K,ee,re){for(let ye=0;ye<Me.length;ye++){const Te=[];Xt(Me[ye],Te,ee,re),K.push(Te)}}function Ei(Me){return Me/360+.5}function mn(Me){const K=Math.sin(Me*Math.PI/180),ee=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return ee<0?0:ee>1?1:ee}function mi(Me,K,ee,re,ye,Te,Ce,Ue){if(re/=K,Te>=(ee/=K)&&Ce<re)return Me;if(Ce<ee||Te>=re)return null;const Ie=[];for(const Je of Me){const ft=Je.geometry;let it=Je.type;const Lt=ye===0?Je.minX:Je.minY,Re=ye===0?Je.maxX:Je.maxY;if(Lt>=ee&&Re<re){Ie.push(Je);continue}if(Re<ee||Lt>=re)continue;let tn=[];if(it==="Point"||it==="MultiPoint")Ea(ft,tn,ee,re,ye);else if(it==="LineString")ua(ft,tn,ee,re,ye,!1,Ue.lineMetrics);else if(it==="MultiLineString")Gn(ft,tn,ee,re,ye,!1);else if(it==="Polygon")Gn(ft,tn,ee,re,ye,!0);else if(it==="MultiPolygon")for(const bn of ft){const Vt=[];Gn(bn,Vt,ee,re,ye,!0),Vt.length&&tn.push(Vt)}if(tn.length){if(Ue.lineMetrics&&it==="LineString"){for(const bn of tn)Ie.push(nt(Je.id,it,bn,Je.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(tn.length===1?(it="LineString",tn=tn[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=tn.length===3?"Point":"MultiPoint"),Ie.push(nt(Je.id,it,tn,Je.tags))}}return Ie.length?Ie:null}function Ea(Me,K,ee,re,ye){for(let Te=0;Te<Me.length;Te+=3){const Ce=Me[Te+ye];Ce>=ee&&Ce<=re&&Xn(K,Me[Te],Me[Te+1],Me[Te+2])}}function ua(Me,K,ee,re,ye,Te,Ce){let Ue=ur(Me);const Ie=ye===0?Rn:Yr;let Je,ft,it=Me.start;for(let Vt=0;Vt<Me.length-3;Vt+=3){const on=Me[Vt],ii=Me[Vt+1],hr=Me[Vt+2],yr=Me[Vt+3],li=Me[Vt+4],Wt=ye===0?on:ii,nn=ye===0?yr:li;let Ai=!1;Ce&&(Je=Math.sqrt(Math.pow(on-yr,2)+Math.pow(ii-li,2))),Wt<ee?nn>ee&&(ft=Ie(Ue,on,ii,yr,li,ee),Ce&&(Ue.start=it+Je*ft)):Wt>re?nn<re&&(ft=Ie(Ue,on,ii,yr,li,re),Ce&&(Ue.start=it+Je*ft)):Xn(Ue,on,ii,hr),nn<ee&&Wt>=ee&&(ft=Ie(Ue,on,ii,yr,li,ee),Ai=!0),nn>re&&Wt<=re&&(ft=Ie(Ue,on,ii,yr,li,re),Ai=!0),!Te&&Ai&&(Ce&&(Ue.end=it+Je*ft),K.push(Ue),Ue=ur(Me)),Ce&&(it+=Je)}let Lt=Me.length-3;const Re=Me[Lt],tn=Me[Lt+1],bn=ye===0?Re:tn;bn>=ee&&bn<=re&&Xn(Ue,Re,tn,Me[Lt+2]),Lt=Ue.length-3,Te&&Lt>=3&&(Ue[Lt]!==Ue[0]||Ue[Lt+1]!==Ue[1])&&Xn(Ue,Ue[0],Ue[1],Ue[2]),Ue.length&&K.push(Ue)}function ur(Me){const K=[];return K.size=Me.size,K.start=Me.start,K.end=Me.end,K}function Gn(Me,K,ee,re,ye,Te){for(const Ce of Me)ua(Ce,K,ee,re,ye,Te,!1)}function Xn(Me,K,ee,re){Me.push(K,ee,re)}function Rn(Me,K,ee,re,ye,Te){const Ce=(Te-K)/(re-K);return Xn(Me,Te,ee+(ye-ee)*Ce,1),Ce}function Yr(Me,K,ee,re,ye,Te){const Ce=(Te-ee)/(ye-ee);return Xn(Me,K+(re-K)*Ce,Te,1),Ce}function ji(Me,K){const ee=[];for(let re=0;re<Me.length;re++){const ye=Me[re],Te=ye.type;let Ce;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")Ce=Qa(ye.geometry,K);else if(Te==="MultiLineString"||Te==="Polygon"){Ce=[];for(const Ue of ye.geometry)Ce.push(Qa(Ue,K))}else if(Te==="MultiPolygon"){Ce=[];for(const Ue of ye.geometry){const Ie=[];for(const Je of Ue)Ie.push(Qa(Je,K));Ce.push(Ie)}}ee.push(nt(ye.id,Te,Ce,ye.tags))}return ee}function Qa(Me,K){const ee=[];ee.size=Me.size,Me.start!==void 0&&(ee.start=Me.start,ee.end=Me.end);for(let re=0;re<Me.length;re+=3)ee.push(Me[re]+K,Me[re+1],Me[re+2]);return ee}function za(Me,K){if(Me.transformed)return Me;const ee=1<<Me.z,re=Me.x,ye=Me.y;for(const Te of Me.features){const Ce=Te.geometry,Ue=Te.type;if(Te.geometry=[],Ue===1)for(let Ie=0;Ie<Ce.length;Ie+=2)Te.geometry.push(ha(Ce[Ie],Ce[Ie+1],K,ee,re,ye));else for(let Ie=0;Ie<Ce.length;Ie++){const Je=[];for(let ft=0;ft<Ce[Ie].length;ft+=2)Je.push(ha(Ce[Ie][ft],Ce[Ie][ft+1],K,ee,re,ye));Te.geometry.push(Je)}}return Me.transformed=!0,Me}function ha(Me,K,ee,re,ye,Te){return[Math.round(ee*(Me*re-ye)),Math.round(ee*(K*re-Te))]}function qr(Me,K,ee,re,ye){const Te=K===ye.maxZoom?0:ye.tolerance/((1<<K)*ye.extent),Ce={features:[],numPoints:0,numSimplified:0,numFeatures:Me.length,source:null,x:ee,y:re,z:K,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ue of Me)xs(Ce,Ue,Te,ye);return Ce}function xs(Me,K,ee,re){const ye=K.geometry,Te=K.type,Ce=[];if(Me.minX=Math.min(Me.minX,K.minX),Me.minY=Math.min(Me.minY,K.minY),Me.maxX=Math.max(Me.maxX,K.maxX),Me.maxY=Math.max(Me.maxY,K.maxY),Te==="Point"||Te==="MultiPoint")for(let Ue=0;Ue<ye.length;Ue+=3)Ce.push(ye[Ue],ye[Ue+1]),Me.numPoints++,Me.numSimplified++;else if(Te==="LineString")Ka(Ce,ye,Me,ee,!1,!1);else if(Te==="MultiLineString"||Te==="Polygon")for(let Ue=0;Ue<ye.length;Ue++)Ka(Ce,ye[Ue],Me,ee,Te==="Polygon",Ue===0);else if(Te==="MultiPolygon")for(let Ue=0;Ue<ye.length;Ue++){const Ie=ye[Ue];for(let Je=0;Je<Ie.length;Je++)Ka(Ce,Ie[Je],Me,ee,!0,Je===0)}if(Ce.length){let Ue=K.tags||null;if(Te==="LineString"&&re.lineMetrics){Ue={};for(const Je in K.tags)Ue[Je]=K.tags[Je];Ue.mapbox_clip_start=ye.start/ye.size,Ue.mapbox_clip_end=ye.end/ye.size}const Ie={geometry:Ce,type:Te==="Polygon"||Te==="MultiPolygon"?3:Te==="LineString"||Te==="MultiLineString"?2:1,tags:Ue};K.id!==null&&(Ie.id=K.id),Me.features.push(Ie)}}function Ka(Me,K,ee,re,ye,Te){const Ce=re*re;if(re>0&&K.size<(ye?Ce:re))return void(ee.numPoints+=K.length/3);const Ue=[];for(let Ie=0;Ie<K.length;Ie+=3)(re===0||K[Ie+2]>Ce)&&(ee.numSimplified++,Ue.push(K[Ie],K[Ie+1])),ee.numPoints++;ye&&function(Ie,Je){let ft=0;for(let it=0,Lt=Ie.length,Re=Lt-2;it<Lt;Re=it,it+=2)ft+=(Ie[it]-Ie[Re])*(Ie[it+1]+Ie[Re+1]);if(ft>0===Je)for(let it=0,Lt=Ie.length;it<Lt/2;it+=2){const Re=Ie[it],tn=Ie[it+1];Ie[it]=Ie[Lt-2-it],Ie[it+1]=Ie[Lt-1-it],Ie[Lt-2-it]=Re,Ie[Lt-1-it]=tn}}(Ue,Te),Me.push(Ue)}const ws={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ts{constructor(K,ee){const re=(ee=this.options=function(Te,Ce){for(const Ue in Ce)Te[Ue]=Ce[Ue];return Te}(Object.create(ws),ee)).debug;if(re&&console.time("preprocess data"),ee.maxZoom<0||ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ee.promoteId&&ee.generateId)throw new Error("promoteId and generateId cannot be used together.");let ye=function(Te,Ce){const Ue=[];if(Te.type==="FeatureCollection")for(let Ie=0;Ie<Te.features.length;Ie++)bt(Ue,Te.features[Ie],Ce,Ie);else bt(Ue,Te.type==="Feature"?Te:{geometry:Te},Ce);return Ue}(K,ee);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ee.indexMaxZoom,ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ye=function(Te,Ce){const Ue=Ce.buffer/Ce.extent;let Ie=Te;const Je=mi(Te,1,-1-Ue,Ue,0,-1,2,Ce),ft=mi(Te,1,1-Ue,2+Ue,0,-1,2,Ce);return(Je||ft)&&(Ie=mi(Te,1,-Ue,1+Ue,0,-1,2,Ce)||[],Je&&(Ie=ji(Je,1).concat(Ie)),ft&&(Ie=Ie.concat(ji(ft,-1)))),Ie}(ye,ee),ye.length&&this.splitTile(ye,0,0,0),re&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(K,ee,re,ye,Te,Ce,Ue){const Ie=[K,ee,re,ye],Je=this.options,ft=Je.debug;for(;Ie.length;){ye=Ie.pop(),re=Ie.pop(),ee=Ie.pop(),K=Ie.pop();const it=1<<ee,Lt=da(ee,re,ye);let Re=this.tiles[Lt];if(!Re&&(ft>1&&console.time("creation"),Re=this.tiles[Lt]=qr(K,ee,re,ye,Je),this.tileCoords.push({z:ee,x:re,y:ye}),ft)){ft>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ee,re,ye,Re.numFeatures,Re.numPoints,Re.numSimplified),console.timeEnd("creation"));const Ai=`z${ee}`;this.stats[Ai]=(this.stats[Ai]||0)+1,this.total++}if(Re.source=K,Te==null){if(ee===Je.indexMaxZoom||Re.numPoints<=Je.indexMaxPoints)continue}else{if(ee===Je.maxZoom||ee===Te)continue;if(Te!=null){const Ai=Te-ee;if(re!==Ce>>Ai||ye!==Ue>>Ai)continue}}if(Re.source=null,K.length===0)continue;ft>1&&console.time("clipping");const tn=.5*Je.buffer/Je.extent,bn=.5-tn,Vt=.5+tn,on=1+tn;let ii=null,hr=null,yr=null,li=null,Wt=mi(K,it,re-tn,re+Vt,0,Re.minX,Re.maxX,Je),nn=mi(K,it,re+bn,re+on,0,Re.minX,Re.maxX,Je);K=null,Wt&&(ii=mi(Wt,it,ye-tn,ye+Vt,1,Re.minY,Re.maxY,Je),hr=mi(Wt,it,ye+bn,ye+on,1,Re.minY,Re.maxY,Je),Wt=null),nn&&(yr=mi(nn,it,ye-tn,ye+Vt,1,Re.minY,Re.maxY,Je),li=mi(nn,it,ye+bn,ye+on,1,Re.minY,Re.maxY,Je),nn=null),ft>1&&console.timeEnd("clipping"),Ie.push(ii||[],ee+1,2*re,2*ye),Ie.push(hr||[],ee+1,2*re,2*ye+1),Ie.push(yr||[],ee+1,2*re+1,2*ye),Ie.push(li||[],ee+1,2*re+1,2*ye+1)}}getTile(K,ee,re){K=+K,ee=+ee,re=+re;const ye=this.options,{extent:Te,debug:Ce}=ye;if(K<0||K>24)return null;const Ue=1<<K,Ie=da(K,ee=ee+Ue&Ue-1,re);if(this.tiles[Ie])return za(this.tiles[Ie],Te);Ce>1&&console.log("drilling down to z%d-%d-%d",K,ee,re);let Je,ft=K,it=ee,Lt=re;for(;!Je&&ft>0;)ft--,it>>=1,Lt>>=1,Je=this.tiles[da(ft,it,Lt)];return Je&&Je.source?(Ce>1&&(console.log("found parent tile z%d-%d-%d",ft,it,Lt),console.time("drilling down")),this.splitTile(Je.source,ft,it,Lt,K,ee,re),Ce>1&&console.timeEnd("drilling down"),this.tiles[Ie]?za(this.tiles[Ie],Te):null):null}}function da(Me,K,ee){return 32*((1<<Me)*ee+K)+Me}class Bi extends B{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(K,ee){return v._(this,void 0,void 0,function*(){const re=K.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ye=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!ye)return null;const Te=new Ve(ye.features,{version:2,extent:v.$});let Ce=function(Ue){const Ie=new v.cM;return function(Je,ft){for(const it in Je.layers)ft.writeMessage(3,Fe,Je.layers[it])}(Ue,Ie),Ie.finish()}(Te);return Ce.byteOffset===0&&Ce.byteLength===Ce.buffer.byteLength||(Ce=new Uint8Array(Ce)),{vectorTile:Te,rawData:Ce.buffer}})}loadData(K){return v._(this,void 0,void 0,function*(){var ee;(ee=this._pendingRequest)===null||ee===void 0||ee.abort();const re=!!(K&&K.request&&K.request.collectResourceTiming)&&new v.cN(K.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(K,this._pendingRequest);const ye=yield this._pendingData;this._geoJSONIndex=K.cluster?new jt(function({superclusterOptions:Ce,clusterProperties:Ue}){if(!Ue||!Ce)return Ce;const Ie={},Je={},ft={accumulated:null,zoom:0},it={properties:null},Lt=Object.keys(Ue);for(const Re of Lt){const[tn,bn]=Ue[Re],Vt=v.cT(bn),on=v.cT(typeof tn=="string"?[tn,["accumulated"],["get",Re]]:tn);Ie[Re]=Vt.value,Je[Re]=on.value}return Ce.map=Re=>{it.properties=Re;const tn={};for(const bn of Lt)tn[bn]=Ie[bn].evaluate(ft,it);return tn},Ce.reduce=(Re,tn)=>{it.properties=tn;for(const bn of Lt)ft.accumulated=Re[bn],Re[bn]=Je[bn].evaluate(ft,it)},Ce}(K)).load(ye.features):function(Ce,Ue){return new Ts(Ce,Ue)}(ye,K.geojsonVtOptions),this.loaded={};const Te={data:ye};if(re){const Ce=re.finish();Ce&&(Te.resourceTiming={},Te.resourceTiming[K.source]=JSON.parse(JSON.stringify(Ce)))}return Te}catch(ye){if(delete this._pendingRequest,v.cy(ye))return{abandoned:!0};throw ye}})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(K){const ee=this.loaded;return ee&&ee[K.uid]?super.reloadTile(K):this.loadTile(K)}loadAndProcessGeoJSON(K,ee){return v._(this,void 0,void 0,function*(){let re=yield this.loadGeoJSON(K,ee);if(delete this._pendingRequest,typeof re!="object")throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(pe(re,!0),K.filter){const ye=v.cT(K.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Ce=>`${Ce.key}: ${Ce.message}`).join(", "));re={type:"FeatureCollection",features:re.features.filter(Ce=>ye.value.evaluate({zoom:0},Ce))}}return re})}loadGeoJSON(K,ee){return v._(this,void 0,void 0,function*(){const{promoteId:re}=K;if(K.request){const ye=yield v.j(K.request,ee);return this._dataUpdateable=v.cV(ye.data,re)?v.cU(ye.data,re):void 0,ye.data}if(typeof K.data=="string")try{const ye=JSON.parse(K.data);return this._dataUpdateable=v.cV(ye,re)?v.cU(ye,re):void 0,ye}catch{throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`)}if(!K.dataDiff)throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${K.source}`);return v.cW(this._dataUpdateable,K.dataDiff,re),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(K){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(K){return this._geoJSONIndex.getClusterExpansionZoom(K.clusterId)}getClusterChildren(K){return this._geoJSONIndex.getChildren(K.clusterId)}getClusterLeaves(K){return this._geoJSONIndex.getLeaves(K.clusterId,K.limit,K.offset)}}class Hr{constructor(K){this.self=K,this.actor=new v.J(K),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ee,re)=>{if(this.externalWorkerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.externalWorkerSourceTypes[ee]=re},this.self.addProtocol=v.cA,this.self.removeProtocol=v.cB,this.self.registerRTLTextPlugin=ee=>{v.cX.setMethods(ee)},this.actor.registerMessageHandler("LDT",(ee,re)=>this._getDEMWorkerSource(ee,re.source).loadTile(re)),this.actor.registerMessageHandler("RDT",(ee,re)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ee,re.source).removeTile(re)})),this.actor.registerMessageHandler("GCEZ",(ee,re)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(ee,re.type,re.source).getClusterExpansionZoom(re)})),this.actor.registerMessageHandler("GCC",(ee,re)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(ee,re.type,re.source).getClusterChildren(re)})),this.actor.registerMessageHandler("GCL",(ee,re)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(ee,re.type,re.source).getClusterLeaves(re)})),this.actor.registerMessageHandler("LD",(ee,re)=>this._getWorkerSource(ee,re.type,re.source).loadData(re)),this.actor.registerMessageHandler("GD",(ee,re)=>this._getWorkerSource(ee,re.type,re.source).getData()),this.actor.registerMessageHandler("LT",(ee,re)=>this._getWorkerSource(ee,re.type,re.source).loadTile(re)),this.actor.registerMessageHandler("RT",(ee,re)=>this._getWorkerSource(ee,re.type,re.source).reloadTile(re)),this.actor.registerMessageHandler("AT",(ee,re)=>this._getWorkerSource(ee,re.type,re.source).abortTile(re)),this.actor.registerMessageHandler("RMT",(ee,re)=>this._getWorkerSource(ee,re.type,re.source).removeTile(re)),this.actor.registerMessageHandler("RS",(ee,re)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[ee]||!this.workerSources[ee][re.type]||!this.workerSources[ee][re.type][re.source])return;const ye=this.workerSources[ee][re.type][re.source];delete this.workerSources[ee][re.type][re.source],ye.removeSource!==void 0&&ye.removeSource(re)})),this.actor.registerMessageHandler("RM",ee=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[ee],delete this.availableImages[ee],delete this.workerSources[ee],delete this.demWorkerSources[ee]})),this.actor.registerMessageHandler("SR",(ee,re)=>v._(this,void 0,void 0,function*(){this.referrer=re})),this.actor.registerMessageHandler("SRPS",(ee,re)=>this._syncRTLPluginState(ee,re)),this.actor.registerMessageHandler("IS",(ee,re)=>v._(this,void 0,void 0,function*(){this.self.importScripts(re)})),this.actor.registerMessageHandler("SI",(ee,re)=>this._setImages(ee,re)),this.actor.registerMessageHandler("UL",(ee,re)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(ee).update(re.layers,re.removedIds)})),this.actor.registerMessageHandler("SL",(ee,re)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(ee).replace(re)}))}_setImages(K,ee){return v._(this,void 0,void 0,function*(){this.availableImages[K]=ee;for(const re in this.workerSources[K]){const ye=this.workerSources[K][re];for(const Te in ye)ye[Te].availableImages=ee}})}_syncRTLPluginState(K,ee){return v._(this,void 0,void 0,function*(){return yield v.cX.syncState(ee,this.self.importScripts)})}_getAvailableImages(K){let ee=this.availableImages[K];return ee||(ee=[]),ee}_getLayerIndex(K){let ee=this.layerIndexes[K];return ee||(ee=this.layerIndexes[K]=new c),ee}_getWorkerSource(K,ee,re){if(this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][ee]||(this.workerSources[K][ee]={}),!this.workerSources[K][ee][re]){const ye={sendAsync:(Te,Ce)=>(Te.targetMapId=K,this.actor.sendAsync(Te,Ce))};switch(ee){case"vector":this.workerSources[K][ee][re]=new B(ye,this._getLayerIndex(K),this._getAvailableImages(K));break;case"geojson":this.workerSources[K][ee][re]=new Bi(ye,this._getLayerIndex(K),this._getAvailableImages(K));break;default:this.workerSources[K][ee][re]=new this.externalWorkerSourceTypes[ee](ye,this._getLayerIndex(K),this._getAvailableImages(K))}}return this.workerSources[K][ee][re]}_getDEMWorkerSource(K,ee){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][ee]||(this.demWorkerSources[K][ee]=new V),this.demWorkerSources[K][ee]}}return v.i(self)&&(self.worker=new Hr(self)),Hr}),m("index",["exports","./shared"],function(v,c){var C="5.7.1";function R(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let N,B;const V={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,e,o){const f=requestAnimationFrame(w=>{y(),e(w)}),{unsubscribe:y}=c.s(b.signal,"abort",()=>{y(),cancelAnimationFrame(f),o(c.c())},!1)},frameAsync(b){return new Promise((e,o)=>{this.frame(b,e,o)})},getImageData(b,e=0){return this.getImageCanvasContext(b).getImageData(-e,-e,b.width+2*e,b.height+2*e)},getImageCanvasContext(b){const e=window.document.createElement("canvas"),o=e.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return e.width=b.width,e.height=b.height,o.drawImage(b,0,0,b.width,b.height),o},resolveURL:b=>(N||(N=document.createElement("a")),N.href=b,N.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class G{static testProp(e){if(!G.docStyle)return e[0];for(let o=0;o<e.length;o++)if(e[o]in G.docStyle)return e[o];return e[0]}static create(e,o,f){const y=window.document.createElement(e);return o!==void 0&&(y.className=o),f&&f.appendChild(y),y}static createNS(e,o){return window.document.createElementNS(e,o)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(e,o){e.style[G.transformProp]=o}static addEventListener(e,o,f,y={}){e.addEventListener(o,f,"passive"in y?y:y.capture)}static removeEventListener(e,o,f,y={}){e.removeEventListener(o,f,"passive"in y?y:y.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static getScale(e){const o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}static getPoint(e,o,f){const y=o.boundingClientRect;return new c.P((f.clientX-y.left)/o.x-e.clientLeft,(f.clientY-y.top)/o.y-e.clientTop)}static mousePos(e,o){const f=G.getScale(e);return G.getPoint(e,f,o)}static touchPos(e,o){const f=[],y=G.getScale(e);for(let w=0;w<o.length;w++)f.push(G.getPoint(e,y,o[w]));return f}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const o=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),f=o.querySelectorAll("script");for(const y of f)y.remove();return G.clean(o),o.innerHTML}static isPossiblyDangerous(e,o){const f=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!f.includes("javascript:")&&!f.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const o=e.children;for(const f of o)G.removeAttributes(f),G.clean(f)}static removeAttributes(e){for(const{name:o,value:f}of e.attributes)G.isPossiblyDangerous(o,f)&&e.removeAttribute(o)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);const ae={supported:!1,testSupport:function(b){!Ne&&pe&&(Ve?Fe(b):me=b)}};let me,pe,Ne=!1,Ve=!1;function Fe(b){const e=b.createTexture();b.bindTexture(b.TEXTURE_2D,e);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,pe),b.isContextLost())return;ae.supported=!0}catch{}b.deleteTexture(e),Ne=!0}var qe;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{me&&Fe(me),me=null,Ve=!0},pe.onerror=()=>{Ne=!0,me=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let e,o,f,y;b.resetRequestQueue=()=>{e=[],o=0,f=0,y={}},b.addThrottleControl=I=>{const O=f++;return y[O]=I,O},b.removeThrottleControl=I=>{delete y[I],E()},b.getImage=(I,O,j=!0)=>new Promise((Z,U)=>{ae.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),c.e(I,{type:"image"}),e.push({abortController:O,requestParameters:I,supportImageRefresh:j,state:"queued",onError:Y=>{U(Y)},onSuccess:Y=>{Z(Y)}}),E()});const w=I=>c._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:O,supportImageRefresh:j,onError:Z,onSuccess:U,abortController:Y}=I,Q=j===!1&&!c.i(self)&&!c.g(O.url)&&(!O.headers||Object.keys(O.headers).reduce((ue,de)=>ue&&de==="accept",!0));o++;const le=Q?k(O,Y):c.m(O,Y);try{const ue=yield le;delete I.abortController,I.state="completed",ue.data instanceof HTMLImageElement||c.b(ue.data)?U(ue):ue.data&&U({data:yield(oe=ue.data,typeof createImageBitmap=="function"?c.f(oe):c.h(oe)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete I.abortController,Z(ue)}finally{o--,E()}var oe}),E=()=>{const I=(()=>{for(const O of Object.keys(y))if(y[O]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=o;O<I&&e.length>0;O++){const j=e.shift();j.abortController.signal.aborted?O--:w(j)}},k=(I,O)=>new Promise((j,Z)=>{const U=new Image,Y=I.url,Q=I.credentials;Q&&Q==="include"?U.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!c.d(Y))&&(U.crossOrigin="anonymous"),O.signal.addEventListener("abort",()=>{U.src="",Z(c.c())}),U.fetchPriority="high",U.onload=()=>{U.onerror=U.onload=null,j({data:U})},U.onerror=()=>{U.onerror=U.onload=null,O.signal.aborted||Z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},U.src=Y})}(qe||(qe={})),qe.resetRequestQueue();class Ae{constructor(e){this._transformRequestFn=e??null}transformRequest(e,o){return this._transformRequestFn&&this._transformRequestFn(e,o)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ke(b){const e=[];if(typeof b=="string")e.push({id:"default",url:b});else if(b&&b.length>0){const o=[];for(const{id:f,url:y}of b){const w=`${f}${y}`;o.indexOf(w)===-1&&(o.push(w),e.push({id:f,url:y}))}}return e}function mt(b,e,o){try{const f=new URL(b);return f.pathname+=`${e}${o}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function st(b){const{userImage:e}=b;return!!(e&&e.render&&e.render())&&(b.data.replace(new Uint8Array(e.data.buffer)),!0)}class Pe extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:o,promiseResolve:f}of this.requestors)f(this._getImagesForIds(o));this.requestors=[]}}getImage(e){const o=this.images[e];if(o&&!o.data&&o.spriteData){const f=o.spriteData;o.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),o.spriteData=null}return o}addImage(e,o){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,o)&&(this.images[e]=o)}_validate(e,o){let f=!0;const y=o.data||o.spriteData;return this._validateStretch(o.stretchX,y&&y.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),f=!1),this._validateStretch(o.stretchY,y&&y.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),f=!1),this._validateContent(o.content,o)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),f=!1),f}_validateStretch(e,o){if(!e)return!0;let f=0;for(const y of e){if(y[0]<f||y[1]<y[0]||o<y[1])return!1;f=y[1]}return!0}_validateContent(e,o){if(!e)return!0;if(e.length!==4)return!1;const f=o.spriteData,y=f&&f.width||o.data.width,w=f&&f.height||o.data.height;return!(e[0]<0||y<e[0]||e[1]<0||w<e[1]||e[2]<0||y<e[2]||e[3]<0||w<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,o,f=!0){const y=this.getImage(e);if(f&&(y.data.width!==o.data.width||y.data.height!==o.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=y.version+1,this.images[e]=o,this.updatedImages[e]=!0}removeImage(e){const o=this.images[e];delete this.images[e],delete this.patterns[e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((o,f)=>{let y=!0;if(!this.isLoaded())for(const w of e)this.images[w]||(y=!1);this.isLoaded()||y?o(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:o})})}_getImagesForIds(e){const o={};for(const f of e){let y=this.getImage(f);y||(this.fire(new c.l("styleimagemissing",{id:f})),y=this.getImage(f)),y?o[f]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,textFitWidth:y.textFitWidth,textFitHeight:y.textFitHeight,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:e,height:o}=this.atlasImage;return{width:e,height:o}}getPattern(e){const o=this.patterns[e],f=this.getImage(e);if(!f)return null;if(o&&o.position.version===f.version)return o.position;if(o)o.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},w=new c.I(y,f);this.patterns[e]={bin:y,position:w}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const o=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const w in this.patterns)e.push(this.patterns[w].bin);const{w:o,h:f}=c.p(e),y=this.atlasImage;y.resize({width:o||1,height:f||1});for(const w in this.patterns){const{bin:E}=this.patterns[w],k=E.x+1,I=E.y+1,O=this.getImage(w).data,j=O.width,Z=O.height;c.R.copy(O,y,{x:0,y:0},{x:k,y:I},{width:j,height:Z}),c.R.copy(O,y,{x:0,y:Z-1},{x:k,y:I-1},{width:j,height:1}),c.R.copy(O,y,{x:0,y:0},{x:k,y:I+Z},{width:j,height:1}),c.R.copy(O,y,{x:j-1,y:0},{x:k-1,y:I},{width:1,height:Z}),c.R.copy(O,y,{x:0,y:0},{x:k+j,y:I},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const o of e){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const f=this.getImage(o);f||c.w(`Image with ID: "${o}" was not found`),st(f)&&this.updateImage(o,f)}}}const rt=1e20;function Mt(b,e,o,f,y,w,E,k,I){for(let O=e;O<e+f;O++)Rt(b,o*w+O,w,y,E,k,I);for(let O=o;O<o+y;O++)Rt(b,O*w+e,1,f,E,k,I)}function Rt(b,e,o,f,y,w,E){w[0]=0,E[0]=-rt,E[1]=rt,y[0]=b[e];for(let k=1,I=0,O=0;k<f;k++){y[k]=b[e+k*o];const j=k*k;do{const Z=w[I];O=(y[k]-y[Z]+j-Z*Z)/(k-Z)/2}while(O<=E[I]&&--I>-1);I++,w[I]=k,E[I]=O,E[I+1]=rt}for(let k=0,I=0;k<f;k++){for(;E[I+1]<k;)I++;const O=w[I],j=k-O;b[e+k*o]=y[O]+j*j}}class jt{constructor(e,o,f){this.requestManager=e,this.localIdeographFontFamily=o,this.entries={},this.lang=f}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const o=[];for(const w in e)for(const E of e[w])o.push(this._getAndCacheGlyphsPromise(w,E));const f=yield Promise.all(o),y={};for(const{stack:w,id:E,glyph:k}of f)y[w]||(y[w]={}),y[w][E]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return y})}_getAndCacheGlyphsPromise(e,o){return c._(this,void 0,void 0,function*(){let f=this.entries[e];f||(f=this.entries[e]={glyphs:{},requests:{},ranges:{}});let y=f.glyphs[o];if(y!==void 0)return{stack:e,id:o,glyph:y};if(y=this._tinySDF(f,e,o),y)return f.glyphs[o]=y,{stack:e,id:o,glyph:y};const w=Math.floor(o/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[w])return{stack:e,id:o,glyph:y};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[w]){const k=jt.loadGlyphRange(e,w,this.url,this.requestManager);f.requests[w]=k}const E=yield f.requests[w];for(const k in E)this._doesCharSupportLocalGlyph(+k)||(f.glyphs[+k]=E[+k]);return f.ranges[w]=!0,{stack:e,id:o,glyph:E[o]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,o,f){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let w=e.tinySDF;if(!w){let k="400";/bold/i.test(o)?k="900":/medium/i.test(o)?k="500":/light/i.test(o)&&(k="200"),w=e.tinySDF=new jt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:y,fontWeight:k})}const E=w.draw(String.fromCharCode(f));return{id:f,bitmap:new c.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}jt.loadGlyphRange=function(b,e,o,f){return c._(this,void 0,void 0,function*(){const y=256*e,w=y+255,E=f.transformRequest(o.replace("{fontstack}",b).replace("{range}",`${y}-${w}`),"Glyphs"),k=yield c.n(E,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${e}, ${y}-${w}`);const I={};for(const O of c.o(k.data))I[O.id]=O;return I})},jt.TinySDF=class{constructor({fontSize:b=24,buffer:e=3,radius:o=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:w="normal",fontStyle:E="normal",lang:k=null}={}){this.buffer=e,this.cutoff=f,this.radius=o,this.lang=k;const I=this.size=b+4*e,O=this._createCanvas(I),j=this.ctx=O.getContext("2d",{willReadFrequently:!0});j.font=`${E} ${w} ${b}px ${y}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(b){const e=document.createElement("canvas");return e.width=e.height=b,e}draw(b){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:w}=this.ctx.measureText(b),E=Math.ceil(o),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-y))),I=Math.min(this.size-this.buffer,E+Math.ceil(f)),O=k+2*this.buffer,j=I+2*this.buffer,Z=Math.max(O*j,0),U=new Uint8ClampedArray(Z),Y={data:U,width:O,height:j,glyphWidth:k,glyphHeight:I,glyphTop:E,glyphLeft:0,glyphAdvance:e};if(k===0||I===0)return Y;const{ctx:Q,buffer:le,gridInner:oe,gridOuter:ue}=this;this.lang&&(Q.lang=this.lang),Q.clearRect(le,le,k,I),Q.fillText(b,le,le+E);const de=Q.getImageData(le,le,k,I);ue.fill(rt,0,Z),oe.fill(0,0,Z);for(let _e=0;_e<I;_e++)for(let fe=0;fe<k;fe++){const be=de.data[4*(_e*k+fe)+3]/255;if(be===0)continue;const Se=(_e+le)*O+fe+le;if(be===1)ue[Se]=0,oe[Se]=rt;else{const ge=.5-be;ue[Se]=ge>0?ge*ge:0,oe[Se]=ge<0?ge*ge:0}}Mt(ue,0,0,O,j,O,this.f,this.v,this.z),Mt(oe,le,le,k,I,O,this.f,this.v,this.z);for(let _e=0;_e<Z;_e++){const fe=Math.sqrt(ue[_e])-Math.sqrt(oe[_e]);U[_e]=Math.round(255-255*(fe/this.radius+this.cutoff))}return Y}};class en{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,o){return c.B(e.expression.evaluate(o))}interpolate(e,o,f){return{x:c.C.number(e.x,o.x,f),y:c.C.number(e.y,o.y,f),z:c.C.number(e.z,o.z,f)}}}let ln;class Ge extends c.E{constructor(e){super(),ln=ln||new c.r({anchor:new c.D(c.v.light.anchor),position:new en,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(ln),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,o={}){if(!this._validate(c.x,e,o))for(const f in e){const y=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,f){return(!f||f.validate!==!1)&&c.y(this,e.call(c.z,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const ct=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class ht extends c.E{constructor(e){super(),this._transitionable=new c.t(ct),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,o={}){if(!this._validate(c.G,e,o)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in e){const y=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,f={}){return f?.validate!==!1&&c.y(this,e.call(c.z,c.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class kt{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,o){const f=e.join(",")+String(o);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(e,o)),this.dashEntry[f]}getDashRanges(e,o,f){const y=[];let w=e.length%2==1?-e[e.length-1]*f:0,E=e[0]*f,k=!0;y.push({left:w,right:E,isDash:k,zeroLength:e[0]===0});let I=e[0];for(let O=1;O<e.length;O++){k=!k;const j=e[O];w=I*f,I+=j,E=I*f,y.push({left:w,right:E,isDash:k,zeroLength:j===0})}return y}addRoundDash(e,o,f){const y=o/2;for(let w=-f;w<=f;w++){const E=this.width*(this.nextRow+f+w);let k=0,I=e[k];for(let O=0;O<this.width;O++){O/I.right>1&&(I=e[++k]);const j=Math.abs(O-I.left),Z=Math.abs(O-I.right),U=Math.min(j,Z);let Y;const Q=w/f*(y+1);if(I.isDash){const le=y-Math.abs(Q);Y=Math.sqrt(U*U+le*le)}else Y=y-Math.sqrt(U*U+Q*Q);this.data[E+O]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(e){for(let k=e.length-1;k>=0;--k){const I=e[k],O=e[k+1];I.zeroLength?e.splice(k,1):O&&O.isDash===I.isDash&&(O.left=I.left,e.splice(k,1))}const o=e[0],f=e[e.length-1];o.isDash===f.isDash&&(o.left=f.left-this.width,f.right=o.right+this.width);const y=this.width*this.nextRow;let w=0,E=e[w];for(let k=0;k<this.width;k++){k/E.right>1&&(E=e[++w]);const I=Math.abs(k-E.left),O=Math.abs(k-E.right),j=Math.min(I,O);this.data[y+k]=Math.max(0,Math.min(255,(E.isDash?j:-j)+128))}}addDash(e,o){const f=o?7:0,y=2*f+1;if(this.nextRow+y>this.height)return c.w("LineAtlas out of space"),null;let w=0;for(let k=0;k<e.length;k++)w+=e[k];if(w!==0){const k=this.width/w,I=this.getDashRanges(e,this.width,k);o?this.addRoundDash(I,k,f):this.addRegularDash(I)}const E={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:w};return this.nextRow+=y,this.dirty=!0,E}bind(e){const o=e.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const Ee="maplibre_preloaded_worker_pool";class nt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<nt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ee]}numActive(){return Object.keys(this.active).length}}const Ct=Math.floor(V.hardwareConcurrency/2);let bt,Pt;function Xt(){return bt||(bt=new nt),bt}nt.workerCount=c.H(globalThis)?Math.max(Math.min(Ct,3),1):1;class Bt{constructor(e,o){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=o;const f=this.workerPool.acquire(o);for(let y=0;y<f.length;y++){const w=new c.J(f[y],o);w.name=`Worker ${y}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,o){const f=[];for(const y of this.actors)f.push(y.sendAsync({type:e,data:o}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,o){for(const f of this.actors)f.registerMessageHandler(e,o)}}function Ei(){return Pt||(Pt=new Bt(Xt(),c.K),Pt.registerMessageHandler("GR",(b,e,o)=>c.m(e,o))),Pt}function mn(b,e){const o=c.L();return c.M(o,o,[1,1,0]),c.N(o,o,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.O(o,o,b.calculatePosMatrix(e.toUnwrapped())):o}function mi(b,e,o,f,y,w,E){var k;const I=function(U,Y,Q){if(U)for(const le of U){const oe=Y[le];if(oe&&oe.source===Q&&oe.type==="fill-extrusion")return!0}else for(const le in Y){const oe=Y[le];if(oe.source===Q&&oe.type==="fill-extrusion")return!0}return!1}((k=y?.layers)!==null&&k!==void 0?k:null,e,b.id),O=w.maxPitchScaleFactor(),j=b.tilesIn(f,O,I);j.sort(Ea);const Z=[];for(const U of j)Z.push({wrappedTileID:U.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(e,o,b._state,U.queryGeometry,U.cameraQueryGeometry,U.scale,y,w,O,mn(b.transform,U.tileID),E?(Y,Q)=>E(U.tileID,Y,Q):void 0)});return function(U,Y){for(const Q in U)for(const le of U[Q])ua(le,Y);return U}(function(U){const Y={},Q={};for(const le of U){const oe=le.queryResults,ue=le.wrappedTileID,de=Q[ue]=Q[ue]||{};for(const _e in oe){const fe=oe[_e],be=de[_e]=de[_e]||{},Se=Y[_e]=Y[_e]||[];for(const ge of fe)be[ge.featureIndex]||(be[ge.featureIndex]=!0,Se.push(ge))}}return Y}(Z),b)}function Ea(b,e){const o=b.tileID,f=e.tileID;return o.overscaledZ-f.overscaledZ||o.canonical.y-f.canonical.y||o.wrap-f.wrap||o.canonical.x-f.canonical.x}function ua(b,e){const o=b.feature,f=e.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=f}function ur(b,e,o){return c._(this,void 0,void 0,function*(){let f=b;if(b.url?f=(yield c.j(e.transformRequest(b.url,"Source"),o)).data:yield V.frameAsync(o),!f)return null;const y=c.Q(c.e(f,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(y.vectorLayerIds=f.vector_layers.map(w=>w.id)),y})}class Gn{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const o=this._sw,f=this._ne;let y,w;if(e instanceof c.S)y=e,w=e;else{if(!(e instanceof Gn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Gn.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(y=e._sw,w=e._ne,!y||!w)return this}return o||f?(o.lng=Math.min(y.lng,o.lng),o.lat=Math.min(y.lat,o.lat),f.lng=Math.max(w.lng,f.lng),f.lat=Math.max(w.lat,f.lat)):(this._sw=new c.S(y.lng,y.lat),this._ne=new c.S(w.lng,w.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:f}=c.S.convert(e);let y=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}static convert(e){return e instanceof Gn?e:e&&new Gn(e)}static fromLngLat(e,o=0){const f=360*o/40075017,y=f/Math.cos(Math.PI/180*e.lat);return new Gn(new c.S(e.lng-y,e.lat-f),new c.S(e.lng+y,e.lat+f))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),o=new c.S(this._ne.lng,this._ne.lat);return new Gn(e,e.lng>o.lng?new c.S(o.lng+360,o.lat):o)}}class Xn{constructor(e,o,f){this.bounds=Gn.convert(this.validateBounds(e)),this.minzoom=o||0,this.maxzoom=f||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const o=Math.pow(2,e.z),f=Math.floor(c.V(this.bounds.getWest())*o),y=Math.floor(c.U(this.bounds.getNorth())*o),w=Math.ceil(c.V(this.bounds.getEast())*o),E=Math.ceil(c.U(this.bounds.getSouth())*o);return e.x>=f&&e.x<w&&e.y>=y&&e.y<E}}class Rn extends c.E{constructor(e,o,f,y){if(super(),this.id=e,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(o,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ur(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Xn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(o,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};f.request.collectResourceTiming=this._collectResourceTiming;let y="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((w,E)=>{e.reloadPromise={resolve:w,reject:E}})}else e.actor=this.dispatcher.getActor(),y="LT";e.abortController=new AbortController;try{const w=yield e.actor.sendAsync({type:y,data:f},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,w)}catch(w){if(delete e.abortController,e.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,o){if(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),e.reloadPromise){const f=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(f.resolve).catch(f.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Yr extends c.E{constructor(e,o,f,y){super(),this.id=e,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},o),c.e(this,c.Q(o,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield ur(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(c.e(this,o),o.bounds&&(this.tileBounds=new Xn(o.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(o){this._tileJSONRequest=null,this.fire(new c.k(o))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const f=yield qe.getImage(this.map._requestManager.transformRequest(o,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const y=this.map.painter.context,w=y.gl,E=f.data;e.texture=this.map.painter.getTileTexture(E.width),e.texture?e.texture.update(E,{useMipmap:!0}):(e.texture=new c.T(y,E,w.RGBA,{useMipmap:!0}),e.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class ji extends Yr{constructor(e,o,f,y){super(e,o,f,y),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(o,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const y=yield qe.getImage(f,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(y&&y.data){const w=y.data;this.map._refreshExpiredTiles&&(y.cacheControl||y.expires)&&e.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const E=c.b(w)&&c.W()?w:yield this.readImageNow(w),k={type:this.type,uid:e.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const I=yield e.actor.sendAsync({type:"LDT",data:k});e.dem=I,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(y){if(delete e.abortController,e.aborted)e.state="unloaded";else if(y)throw e.state="errored",y}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const o=e.width+2,f=e.height+2;try{return new c.R({width:o,height:f},yield c.Y(e,-1,-1,o,f))}catch{}}return V.getImageData(e,1)})}_getNeighboringTiles(e){const o=e.canonical,f=Math.pow(2,o.z),y=(o.x-1+f)%f,w=o.x===0?e.wrap-1:e.wrap,E=(o.x+1+f)%f,k=o.x+1===f?e.wrap+1:e.wrap,I={};return I[new c.Z(e.overscaledZ,w,o.z,y,o.y).key]={backfilled:!1},I[new c.Z(e.overscaledZ,k,o.z,E,o.y).key]={backfilled:!1},o.y>0&&(I[new c.Z(e.overscaledZ,w,o.z,y,o.y-1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,e.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,k,o.z,E,o.y-1).key]={backfilled:!1}),o.y+1<f&&(I[new c.Z(e.overscaledZ,w,o.z,y,o.y+1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,e.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,k,o.z,E,o.y+1).key]={backfilled:!1}),I}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Qa extends c.E{constructor(e,o,f,y){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:o.data},this.actor=f.getActor(),this.setEventedParent(y),this._data=o.data,this._options=c.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(o.clusterMaxZoom),minPoints:Math.max(2,o.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const o=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${o}"`),o}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(o=>o.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const e=new Gn,o=yield this.getData();let f;switch(o.type){case"FeatureCollection":f=o.features.map(y=>this.getCoordinatesFromGeometry(y.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(o.geometry);break;default:f=this.getCoordinatesFromGeometry(o)}if(f.length==0)return e;for(let y=0;y<f.length-1;y+=2)e.extend([f[y],f[y+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,o,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:o,offset:f}})}_updateWorkerData(){return c._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:e,diff:o}=this._pendingWorkerUpdate;if(!e&&!o)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=c.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(f.request=this.map._requestManager.transformRequest(V.resolveURL(e),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):o&&(f.dataDiff=o,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const y=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||y.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=y.data;let w=null;y.resourceTiming&&y.resourceTiming[this.id]&&(w=y.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&w&&w.length>0&&c.e(E,{resourceTiming:w}),this.fire(new c.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(y){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(y))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.actor?"RT":"LT";e.actor=this.actor;const f={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;const y=yield this.actor.sendAsync({type:o,data:f},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(y,this.map.painter,o==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class za extends c.E{constructor(e,o,f,y){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=f,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=o}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield qe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,e&&(this.coordinates=e),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new c.k(o))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const o=e.map(c.a1.fromLngLat);var f;return this.tileID=function(y){const w=c.a2.fromPoints(y),E=w.width(),k=w.height(),I=Math.max(E,k),O=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),j=Math.pow(2,O);return new c.a4(O,Math.floor((w.minX+w.maxX)/2*j),Math.floor((w.minY+w.maxY)/2*j))}(o),this.terrainTileRanges=this._getOverlappingTileRanges(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map(y=>this.tileID.getTilePoint(y)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,o=e.gl;this.texture||(this.texture=new c.T(e,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:o,minY:f,maxX:y,maxY:w}=c.a2.fromPoints(e),E={};for(let k=0;k<=c.a3;k++){const I=Math.pow(2,k),O=Math.floor(o*I),j=Math.floor(f*I),Z=Math.floor(y*I),U=Math.floor(w*I);E[k]={minTileX:O,minTileY:j,maxTileX:Z,maxTileY:U}}return E}}class ha extends za{constructor(e,o,f,y){super(e,o,f,y),this.roundZoom=!0,this.type="video",this.options=o}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const o of e.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield c.a5(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new c.k(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const o=this.video.seekable;e<o.start(0)||e>o.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,o=e.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class qr extends za{constructor(e,o,f,y){super(e,o,f,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,f=o.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(o,this.canvas,f.RGBA,{premultiply:!0});let y=!1;for(const w in this.tiles){const E=this.tiles[w];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const xs={},Ka=b=>{switch(b){case"geojson":return Qa;case"image":return za;case"raster":return Yr;case"raster-dem":return ji;case"vector":return Rn;case"video":return ha;case"canvas":return qr}return xs[b]},ws="RTLPluginLoaded";class Ts extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ei()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(o,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=V.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(ws))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let da=null;function Bi(){return da||(da=new Ts),da}class Hr{constructor(e,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a7(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const o=e+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,o,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(y,w){const E={};if(!w)return E;for(const k of y){const I=k.layerIds.map(O=>w.getLayer(O)).filter(Boolean);if(I.length!==0){k.layers=I,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(O=>I.filter(j=>j.id===O)[0]));for(const O of I)E[O.id]=k}}return E}(e.buckets,o?.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const w=this.buckets[y];if(w instanceof c.a9){if(this.hasSymbolBuckets=!0,!f)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const w=this.buckets[y];if(w instanceof c.a9&&w.hasRTLText){this.hasRTLText=!0,Bi().lazyLoad();break}}this.queryPadding=0;for(const y in this.buckets){const w=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(y).queryRadius(w))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,f,y,w,E,k,I,O,j,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:w,scale:E,tileSize:this.tileSize,pixelPosMatrix:j,transform:I,params:k,queryPadding:this.queryPadding*O,getElevation:Z},e,o,f):{}}querySourceFeatures(e,o){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),w=o&&o.sourceLayer?o.sourceLayer:"",E=y._geojsonTileLayer||y[w];if(!E)return;const k=c.aa(o&&o.filter),{z:I,x:O,y:j}=this.tileID.canonical,Z={z:I,x:O,y:j};for(let U=0;U<E.length;U++){const Y=E.feature(U);if(k.needGeometry){const oe=c.ab(Y,!0);if(!k.filter(new c.F(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!k.filter(new c.F(this.tileID.overscaledZ),Y))continue;const Q=f.getId(Y,w),le=new c.ac(Y,I,O,j,Q);le.tile=Z,e.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const f=c.ad(e.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{const w=this.expirationTime-o;w?this.expirationTime=f+Math.max(w,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!o.style.hasLayer(y))continue;const w=this.buckets[y],E=w.layers[0].sourceLayer||"_geojsonTileLayer",k=f[E],I=e[E];if(!k||!I||Object.keys(I).length===0)continue;w.update(I,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=o&&o.style&&o.style.getLayer(y);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<V.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=V.now()+e}setDependencies(e,o){const f={};for(const y of o)f[y]=!0;this.dependencies[e]=f}hasDependency(e,o){for(const f of e){const y=this.dependencies[f];if(y){for(const w of o)if(y[w])return!0}}return!1}}class Me{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,f){const y=e.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const w={value:o,timeout:void 0};if(f!==void 0&&(w.timeout=setTimeout(()=>{this.remove(e,w)},f)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const f=e.wrapped().key,y=o===void 0?0:this.data[f].indexOf(o),w=this.data[f][y];return this.data[f].splice(y,1),w.timeout&&clearTimeout(w.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(w.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const f in this.data)for(const y of this.data[f])e(y.value)||o.push(y);for(const f of o)this.remove(f.value.tileID,f)}}class K{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,f){const y=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][y]=this.stateChanges[e][y]||{},c.e(this.stateChanges[e][y],f),this.deletedStates[e]===null){this.deletedStates[e]={};for(const w in this.state[e])w!==y&&(this.deletedStates[e][w]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][y]===null){this.deletedStates[e][y]={};for(const w in this.state[e][y])f[w]||(this.deletedStates[e][y][w]=null)}else for(const w in f)this.deletedStates[e]&&this.deletedStates[e][y]&&this.deletedStates[e][y][w]===null&&delete this.deletedStates[e][y][w]}removeFeatureState(e,o,f){if(this.deletedStates[e]===null)return;const y=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},f&&o!==void 0)this.deletedStates[e][y]!==null&&(this.deletedStates[e][y]=this.deletedStates[e][y]||{},this.deletedStates[e][y][f]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][y])for(f in this.deletedStates[e][y]={},this.stateChanges[e][y])this.deletedStates[e][y][f]=null;else this.deletedStates[e][y]=null;else this.deletedStates[e]=null}getState(e,o){const f=String(o),y=c.e({},(this.state[e]||{})[f],(this.stateChanges[e]||{})[f]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const w=this.deletedStates[e][o];if(w===null)return{};for(const E in w)delete y[E]}return y}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const w={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),c.e(this.state[y][E],this.stateChanges[y][E]),w[E]=this.state[y][E];f[y]=w}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const w={};if(this.deletedStates[y]===null)for(const E in this.state[y])w[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else for(const k of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][k];w[E]=this.state[y][E]}f[y]=f[y]||{},c.e(f[y],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const y in e)e[y].setFeatureState(f,o)}}const ee=89.25;function re(b,e){const o=c.ah(e.lat,-c.ai,c.ai);return new c.P(c.V(e.lng)*b,c.U(o)*b)}function ye(b,e){return new c.a1(e.x/b,e.y/b).toLngLat()}function Te(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-b.pitch)),Math.tan(c.ae(ee-b.pitch)))}function Ce(b,e){const o=b.canonical,f=e/c.af(o.z),y=o.x+Math.pow(2,o.z)*b.wrap,w=c.ag(new Float64Array(16));return c.M(w,w,[y*f,o.y*f,0]),c.N(w,w,[f/c.$,f/c.$,1]),w}function Ue(b,e,o,f,y){const w=c.a1.fromLngLat(b,e),E=y*c.aj(1,b.lat),k=E*Math.cos(c.ae(o)),I=Math.sqrt(E*E-k*k),O=I*Math.sin(c.ae(-f)),j=I*Math.cos(c.ae(-f));return new c.a1(w.x+O,w.y+j,w.z+k)}function Ie(b,e,o){const f=e.intersectsFrustum(b);if(!o||f===0)return f;const y=e.intersectsPlane(o);return y===0?0:f===2&&y===2?2:1}function Je(b,e,o){let f=0;const y=(o-e)/10;for(let w=0;w<10;w++)f+=y*Math.pow(Math.cos(e+(w+.5)/10*(o-e)),b);return f}function ft(b,e){return function(o,f,y,w,E){const k=2*((b-1)/c.ak(Math.cos(c.ae(ee-E))/Math.cos(c.ae(ee)))-1),I=Math.acos(y/w),O=2*Je(k-1,0,c.ae(E/2)),j=Math.min(c.ae(ee),I+c.ae(E/2)),Z=Je(k-1,Math.min(j,I-c.ae(E/2)),j),U=Math.atan(f/y),Y=Math.hypot(f,y);let Q=o;return Q+=c.ak(w/Y/Math.max(.5,Math.cos(c.ae(E/2)))),Q+=k*c.ak(Math.cos(U))/2,Q-=c.ak(Math.max(1,Z/O/e))/2,Q}}const it=ft(9.314,3);function Lt(b,e){const o=(e.roundZoom?Math.round:Math.floor)(b.zoom+c.ak(b.tileSize/e.tileSize));return Math.max(0,o)}function Re(b,e){const o=b.getCameraFrustum(),f=b.getClippingPlane(),y=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=c.a1.fromLngLat(b.center,b.elevation);y.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const E=b.getCoveringTilesDetailsProvider(),k=E.allowVariableZoom(b,e),I=Lt(b,e),O=e.minzoom||0,j=e.maxzoom!==void 0?e.maxzoom:b.maxZoom,Z=Math.min(Math.max(0,I),j),U=Math.pow(2,Z),Y=[U*y.x,U*y.y,0],Q=[U*w.x,U*w.y,0],le=Math.hypot(w.x-y.x,w.y-y.y),oe=Math.abs(w.z-y.z),ue=Math.hypot(le,oe),de=be=>({zoom:0,x:0,y:0,wrap:be,fullyVisible:!1}),_e=[],fe=[];if(b.renderWorldCopies&&E.allowWorldCopies())for(let be=1;be<=3;be++)_e.push(de(-be)),_e.push(de(be));for(_e.push(de(0));_e.length>0;){const be=_e.pop(),Se=be.x,ge=be.y;let ke=be.fullyVisible;const He={x:Se,y:ge,z:be.zoom},Oe=E.getTileBoundingVolume(He,be.wrap,b.elevation,e);if(!ke){const vt=Ie(o,Oe,f);if(vt===0)continue;ke=vt===2}const je=E.distanceToTile2d(y.x,y.y,He,Oe);let $e=I;k&&($e=(e.calculateTileZoom||it)(b.zoom+c.ak(b.tileSize/e.tileSize),je,oe,ue,b.fov)),$e=(e.roundZoom?Math.round:Math.floor)($e),$e=Math.max(0,$e);const yt=Math.min($e,j);if(be.wrap=E.getWrap(w,He,be.wrap),be.zoom>=yt){if(be.zoom<O)continue;const vt=Z-be.zoom,ot=Y[0]-.5-(Se<<vt),Ot=Y[1]-.5-(ge<<vt),fn=e.reparseOverscaled?Math.max(be.zoom,$e):be.zoom;fe.push({tileID:new c.Z(be.zoom===j?fn:be.zoom,be.wrap,be.zoom,Se,ge),distanceSq:c.al([Q[0]-.5-Se,Q[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(ot*ot+Ot*Ot)})}else for(let vt=0;vt<4;vt++)_e.push({zoom:be.zoom+1,x:(Se<<1)+vt%2,y:(ge<<1)+(vt>>1),wrap:be.wrap,fullyVisible:ke})}return fe.sort((be,Se)=>be.distanceSq-Se.distanceSq).map(be=>be.tileID)}const tn=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class bn extends c.E{constructor(e,o,f){super(),this.id=e,this.dispatcher=f,this.on("data",y=>this._dataHandler(y)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,w,E,k)=>{const I=new(Ka(w.type))(y,w,E,k);if(I.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${I.id}`);return I})(e,o,f,this),this._tiles={},this._cache=new Me(0,y=>this._unloadTile(y)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new K,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,o,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,o,f)}catch(y){e.state="errored",y.status!==404?this._source.fire(new c.k(y,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const f=this._tiles[o];f.upload(e),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Vt).map(e=>e.key)}getRenderableIds(e){const o=[];for(const f in this._tiles)this._isIdRenderable(f,e)&&o.push(this._tiles[f]);return e?o.sort((f,y)=>{const w=f.tileID,E=y.tileID,k=new c.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),I=new c.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-E.overscaledZ||I.y-k.y||I.x-k.x}).map(f=>f.tileID.key):o.map(f=>f.tileID).sort(Vt).map(f=>f.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)e?this._reloadTile(o,"expired"):this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(e,o){return c._(this,void 0,void 0,function*(){const f=this._tiles[e];f&&(f.state!=="loading"&&(f.state=o),yield this._loadTile(f,e,o))})}_tileLoaded(e,o,f){e.timeAdded=V.now(),f==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const o=this.getRenderableIds();for(let y=0;y<o.length;y++){const w=o[y];if(e.neighboringTiles&&e.neighboringTiles[w]){const E=this.getTileByID(w);f(e,E),f(E,e)}}function f(y,w){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let E=w.tileID.canonical.x-y.tileID.canonical.x;const k=w.tileID.canonical.y-y.tileID.canonical.y,I=Math.pow(2,y.tileID.canonical.z),O=w.tileID.key;E===0&&k===0||Math.abs(k)>1||(Math.abs(E)>1&&(Math.abs(E+I)===1?E+=I:Math.abs(E-I)===1&&(E-=I)),w.dem&&y.dem&&(y.dem.backfillBorder(w.dem,E,k),y.neighboringTiles&&y.neighboringTiles[O]&&(y.neighboringTiles[O].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,f,y){for(const w in this._tiles){let E=this._tiles[w];if(y[w]||!E.hasData()||E.tileID.overscaledZ<=o||E.tileID.overscaledZ>f)continue;let k=E.tileID;for(;E&&E.tileID.overscaledZ>o+1;){const O=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[O.key],E&&E.hasData()&&(k=O)}let I=k;for(;I.overscaledZ>o;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]||e[I.canonical.key]){y[k.key]=k;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const f=this._loadedParentTiles[e.key];return f&&f.tileID.overscaledZ>=o?f:null}for(let f=e.overscaledZ-1;f>=o;f--){const y=e.scaledTo(f),w=this._getLoadedTile(y);if(w)return w}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const o=Math.ceil(e.width/this._source.tileSize)+1,f=Math.ceil(e.height/this._source.tileSize)+1,y=Math.floor(o*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(w)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const f={};for(const y in this._tiles){const w=this._tiles[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+o),f[w.tileID.key]=w}this._tiles=f;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}_updateCoveredAndRetainedTiles(e,o,f,y,w,E){const k={},I={},O=Object.keys(e),j=V.now();for(const Z of O){const U=e[Z],Y=this._tiles[Z];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=j)continue;const Q=this.findLoadedParent(U,o),le=this.findLoadedSibling(U),oe=Q||le||null;oe&&(this._addTile(oe.tileID),k[oe.tileID.key]=oe.tileID),I[Z]=U}this._retainLoadedChildren(I,y,f,e);for(const Z in k)e[Z]||(this._coveredTiles[Z]=!0,e[Z]=k[Z]);if(E){const Z={},U={};for(const Y of w)this._tiles[Y.key].hasData()?Z[Y.key]=Y:U[Y.key]=Y;for(const Y in U){const Q=U[Y].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(Z[Q[0].key]=e[Q[0].key]=Q[0],Z[Q[1].key]=e[Q[1].key]=Q[1],Z[Q[2].key]=e[Q[2].key]=Q[2],Z[Q[3].key]=e[Q[3].key]=Q[3],delete U[Y])}for(const Y in U){const Q=U[Y],le=this.findLoadedParent(Q,this._source.minzoom),oe=this.findLoadedSibling(Q),ue=le||oe||null;if(ue){Z[ue.tileID.key]=e[ue.tileID.key]=ue.tileID;for(const de in Z)Z[de].isChildOf(ue.tileID)&&delete Z[de]}}for(const Y in this._tiles)Z[Y]||(this._coveredTiles[Y]=!0)}}update(e,o){if(!this._sourceLoaded||this._paused)return;let f;this.transform=e,this.terrain=o,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new c.Z(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(f=Re(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(j=>this._source.hasTile(j)))):f=[];const y=Lt(e,this._source),w=Math.max(y-bn.maxOverzooming,this._source.minzoom),E=Math.max(y+bn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const Z of f)if(Z.canonical.z>this._source.minzoom){const U=Z.scaledTo(Z.canonical.z-1);j[U.key]=U;const Y=Z.scaledTo(Math.max(this._source.minzoom,Math.min(Z.canonical.z,5)));j[Y.key]=Y}f=f.concat(Object.values(j))}const k=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(f,y);on(this._source.type)&&this._updateCoveredAndRetainedTiles(I,w,E,y,f,o);for(const j in I)this._tiles[j].clearFadeHold();const O=c.am(this._tiles,I);for(const j of O){const Z=this._tiles[j];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,o){var f;const y={},w={},E=Math.max(o-bn.maxOverzooming,this._source.minzoom),k=Math.max(o+bn.maxUnderzooming,this._source.minzoom),I={};for(const O of e){const j=this._addTile(O);y[O.key]=O,j.hasData()||o<this._source.maxzoom&&(I[O.key]=O)}this._retainLoadedChildren(I,o,k,y);for(const O of e){let j=this._tiles[O.key];if(j.hasData())continue;if(o+1>this._source.maxzoom){const U=O.children(this._source.maxzoom)[0],Y=this.getTile(U);if(Y&&Y.hasData()){y[U.key]=U;continue}}else{const U=O.children(this._source.maxzoom);if(y[U[0].key]&&y[U[1].key]&&y[U[2].key]&&y[U[3].key])continue}let Z=j.wasRequested();for(let U=O.overscaledZ-1;U>=E;--U){const Y=O.scaledTo(U);if(w[Y.key])break;if(w[Y.key]=!0,j=this.getTile(Y),!j&&Z&&(j=this._addTile(Y)),j){const Q=j.hasData();if((Q||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||Z)&&(y[Y.key]=Y),Z=j.wasRequested(),Q)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let f,y=this._tiles[e].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}o.push(y.key);const w=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(w),f)break;y=w}for(const w of o)this._loadedParentTiles[w]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const o=this._tiles[e].tileID,f=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=f}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const f=o;return o||(o=new Hr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(o,e.key,o.state)),o.uses++,this._tiles[e.key]=o,f||this._source.fire(new c.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const f=o.getExpiryTimeout();f&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},f))}refreshTiles(e){for(const o in this._tiles)(this._isIdRenderable(o)||this._tiles[o].state=="errored")&&e.some(f=>f.equals(this._tiles[o].tileID.canonical))&&this._reloadTile(o,"expired")}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(e){const o=e.sourceDataType;e.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&o==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,o,f){const y=[],w=this.transform;if(!w)return y;const E=w.getCoveringTilesDetailsProvider().allowWorldCopies(),k=f?w.getCameraQueryGeometry(e):e,I=Y=>w.screenPointToMercatorCoordinate(Y,this.terrain),O=this.transformBbox(e,I,!E),j=this.transformBbox(k,I,!E),Z=this.getIds(),U=c.a2.fromPoints(j);for(let Y=0;Y<Z.length;Y++){const Q=this._tiles[Z[Y]];if(Q.holdingForFade())continue;const le=E?[Q.tileID]:[Q.tileID.unwrapTo(-1),Q.tileID.unwrapTo(0)],oe=Math.pow(2,w.zoom-Q.tileID.overscaledZ),ue=o*Q.queryPadding*c.$/Q.tileSize/oe;for(const de of le){const _e=U.map(fe=>de.getTilePoint(new c.a1(fe.x,fe.y)));if(_e.expandBy(ue),_e.intersects(tn)){const fe=O.map(Se=>de.getTilePoint(Se)),be=j.map(Se=>de.getTilePoint(Se));y.push({tile:Q,tileID:E?de:de.unwrapTo(0),queryGeometry:fe,cameraQueryGeometry:be,scale:oe})}}}return y}transformBbox(e,o,f){let y=e.map(o);if(f){const w=c.a2.fromPoints(e);w.shrinkBy(.001*Math.min(w.width(),w.height()));const E=w.map(o);c.a2.fromPoints(y).covers(E)||(y=y.map(k=>k.x>.5?new c.a1(k.x-1,k.y,k.z):k))}return y}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(o),o}hasTransition(){if(this._source.hasTransition())return!0;if(on(this._source.type)){const e=V.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=e)return!0}return!1}setFeatureState(e,o,f){this._state.updateState(e=e||"_geojsonTileLayer",o,f)}removeFeatureState(e,o,f){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,f)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,f){const y=this._tiles[e];y&&y.setDependencies(o,f)}reloadTilesForDependencies(e,o){for(const f in this._tiles)this._tiles[f].hasDependency(e,o)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(e,o))}}function Vt(b,e){const o=Math.abs(2*b.wrap)-+(b.wrap<0),f=Math.abs(2*e.wrap)-+(e.wrap<0);return b.overscaledZ-e.overscaledZ||f-o||e.canonical.y-b.canonical.y||e.canonical.x-b.canonical.x}function on(b){return b==="raster"||b==="image"||b==="video"}bn.maxOverzooming=10,bn.maxUnderzooming=3;class ii{constructor(e,o){this.reset(e,o)}reset(e,o){this.points=e||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ah(e,0,1);let o=1,f=this._distances[o];const y=e*this.paddedLength+this.padding;for(;f<y&&o<this._distances.length;)f=this._distances[++o];const w=o-1,E=this._distances[w],k=f-E,I=k>0?(y-E)/k:0;return this.points[w].mult(1-I).add(this.points[o].mult(I))}}function hr(b,e){let o=!0;return b==="always"||b!=="never"&&e!=="never"||(o=!1),o}class yr{constructor(e,o,f){const y=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(e/f),this.yCellCount=Math.ceil(o/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=o,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,o,f,y,w){this._forEachCell(o,f,y,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w)}insertCircle(e,o,f,y){this._forEachCell(o-y,f-y,o+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(f),this.circles.push(y)}_insertBoxCell(e,o,f,y,w,E){this.boxCells[w].push(E)}_insertCircleCell(e,o,f,y,w,E){this.circleCells[w].push(E)}_query(e,o,f,y,w,E,k){if(f<0||e>this.width||y<0||o>this.height)return[];const I=[];if(e<=0&&o<=0&&this.width<=f&&this.height<=y){if(w)return[{key:null,x1:e,y1:o,x2:f,y2:y}];for(let O=0;O<this.boxKeys.length;O++)I.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const j=this.circles[3*O],Z=this.circles[3*O+1],U=this.circles[3*O+2];I.push({key:this.circleKeys[O],x1:j-U,y1:Z-U,x2:j+U,y2:Z+U})}}else this._forEachCell(e,o,f,y,this._queryCell,I,{hitTest:w,overlapMode:E,seenUids:{box:{},circle:{}}},k);return I}query(e,o,f,y){return this._query(e,o,f,y,!1,null)}hitTest(e,o,f,y,w,E){return this._query(e,o,f,y,!0,w,E).length>0}hitTestCircle(e,o,f,y,w){const E=e-f,k=e+f,I=o-f,O=o+f;if(k<0||E>this.width||O<0||I>this.height)return!1;const j=[];return this._forEachCell(E,I,k,O,this._queryCellCircle,j,{hitTest:!0,overlapMode:y,circle:{x:e,y:o,radius:f},seenUids:{box:{},circle:{}}},w),j.length>0}_queryCell(e,o,f,y,w,E,k,I){const{seenUids:O,hitTest:j,overlapMode:Z}=k,U=this.boxCells[w];if(U!==null){const Q=this.bboxes;for(const le of U)if(!O.box[le]){O.box[le]=!0;const oe=4*le,ue=this.boxKeys[le];if(e<=Q[oe+2]&&o<=Q[oe+3]&&f>=Q[oe+0]&&y>=Q[oe+1]&&(!I||I(ue))&&(!j||!hr(Z,ue.overlapMode))&&(E.push({key:ue,x1:Q[oe],y1:Q[oe+1],x2:Q[oe+2],y2:Q[oe+3]}),j))return!0}}const Y=this.circleCells[w];if(Y!==null){const Q=this.circles;for(const le of Y)if(!O.circle[le]){O.circle[le]=!0;const oe=3*le,ue=this.circleKeys[le];if(this._circleAndRectCollide(Q[oe],Q[oe+1],Q[oe+2],e,o,f,y)&&(!I||I(ue))&&(!j||!hr(Z,ue.overlapMode))){const de=Q[oe],_e=Q[oe+1],fe=Q[oe+2];if(E.push({key:ue,x1:de-fe,y1:_e-fe,x2:de+fe,y2:_e+fe}),j)return!0}}}return!1}_queryCellCircle(e,o,f,y,w,E,k,I){const{circle:O,seenUids:j,overlapMode:Z}=k,U=this.boxCells[w];if(U!==null){const Q=this.bboxes;for(const le of U)if(!j.box[le]){j.box[le]=!0;const oe=4*le,ue=this.boxKeys[le];if(this._circleAndRectCollide(O.x,O.y,O.radius,Q[oe+0],Q[oe+1],Q[oe+2],Q[oe+3])&&(!I||I(ue))&&!hr(Z,ue.overlapMode))return E.push(!0),!0}}const Y=this.circleCells[w];if(Y!==null){const Q=this.circles;for(const le of Y)if(!j.circle[le]){j.circle[le]=!0;const oe=3*le,ue=this.circleKeys[le];if(this._circlesCollide(Q[oe],Q[oe+1],Q[oe+2],O.x,O.y,O.radius)&&(!I||I(ue))&&!hr(Z,ue.overlapMode))return E.push(!0),!0}}}_forEachCell(e,o,f,y,w,E,k,I){const O=this._convertToXCellCoord(e),j=this._convertToYCellCoord(o),Z=this._convertToXCellCoord(f),U=this._convertToYCellCoord(y);for(let Y=O;Y<=Z;Y++)for(let Q=j;Q<=U;Q++)if(w.call(this,e,o,f,y,this.xCellCount*Q+Y,E,k,I))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,o,f,y,w,E){const k=y-e,I=w-o,O=f+E;return O*O>k*k+I*I}_circleAndRectCollide(e,o,f,y,w,E,k){const I=(E-y)/2,O=Math.abs(e-(y+I));if(O>I+f)return!1;const j=(k-w)/2,Z=Math.abs(o-(w+j));if(Z>j+f)return!1;if(O<=I||Z<=j)return!0;const U=O-I,Y=Z-j;return U*U+Y*Y<=f*f}}function li(b,e,o){const f=c.L();if(!b){const{vecSouth:Z,vecEast:U}=nn(e),Y=R();Y[0]=U[0],Y[1]=U[1],Y[2]=Z[0],Y[3]=Z[1],y=Y,(j=(E=(w=Y)[0])*(O=w[3])-(I=w[2])*(k=w[1]))&&(y[0]=O*(j=1/j),y[1]=-k*j,y[2]=-I*j,y[3]=E*j),f[0]=Y[0],f[1]=Y[1],f[4]=Y[2],f[5]=Y[3]}var y,w,E,k,I,O,j;return c.N(f,f,[1/o,1/o,1]),f}function Wt(b,e,o,f){if(b){const y=c.L();if(!e){const{vecSouth:w,vecEast:E}=nn(o);y[0]=E[0],y[1]=E[1],y[4]=w[0],y[5]=w[1]}return c.N(y,y,[f,f,1]),y}return o.pixelsToClipSpaceMatrix}function nn(b){const e=Math.cos(b.rollInRadians),o=Math.sin(b.rollInRadians),f=Math.cos(b.pitchInRadians),y=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),E=c.ar();E[0]=-y*f*o-w*e,E[1]=-w*f*o+y*e;const k=c.as(E);k<1e-9?c.at(E):c.au(E,E,1/k);const I=c.ar();I[0]=y*f*e-w*o,I[1]=w*f*e+y*o;const O=c.as(I);return O<1e-9?c.at(I):c.au(I,I,1/O),{vecEast:I,vecSouth:E}}function Ai(b,e,o,f){let y;f?(y=[b,e,f(b,e),1],c.aw(y,y,o)):(y=[b,e,0,1],Ql(y,y,o));const w=y[3];return{point:new c.P(y[0]/w,y[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function gt(b,e){return .5+b/e*.5}function Xr(b,e){return b.x>=-e[0]&&b.x<=e[0]&&b.y>=-e[1]&&b.y<=e[1]}function Fi(b,e,o,f,y,w,E,k,I,O,j,Z,U){const Y=o?b.textSizeData:b.iconSizeData,Q=c.an(Y,e.transform.zoom),le=[256/e.width*2+1,256/e.height*2+1],oe=o?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;oe.clear();const ue=b.lineVertexArray,de=o?b.text.placedSymbolArray:b.icon.placedSymbolArray,_e=e.transform.width/e.transform.height;let fe=!1;for(let be=0;be<de.length;be++){const Se=de.get(be);if(Se.hidden||Se.writingMode===c.ao.vertical&&!fe){ao(Se.numGlyphs,oe);continue}fe=!1;const ge=new c.P(Se.anchorX,Se.anchorY),ke={getElevation:U,pitchedLabelPlaneMatrix:f,lineVertexArray:ue,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:ge,unwrappedTileID:I,width:O,height:j,translation:Z},He=Mi(Se.anchorX,Se.anchorY,ke);if(!Xr(He.point,le)){ao(Se.numGlyphs,oe);continue}const Oe=gt(e.transform.cameraToCenterDistance,He.signedDistanceFromCamera),je=c.ap(Y,Q,Se),$e=w?je*e.transform.getPitchedTextCorrection(Se.anchorX,Se.anchorY,I)/Oe:je*Oe,yt=Et({projectionContext:ke,pitchedLabelPlaneMatrixInverse:y,symbol:Se,fontSize:$e,flip:!1,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:_e,rotateToLine:k});fe=yt.useVertical,(yt.notEnoughRoom||fe||yt.needsFlipping&&Et({projectionContext:ke,pitchedLabelPlaneMatrixInverse:y,symbol:Se,fontSize:$e,flip:!0,keepUpright:E,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:_e,rotateToLine:k}).notEnoughRoom)&&ao(Se.numGlyphs,oe)}o?b.text.dynamicLayoutVertexBuffer.updateData(oe):b.icon.dynamicLayoutVertexBuffer.updateData(oe)}function ko(b,e,o,f,y,w,E,k){const I=w.glyphStartIndex+w.numGlyphs,O=w.lineStartIndex,j=w.lineStartIndex+w.lineLength,Z=e.getoffsetX(w.glyphStartIndex),U=e.getoffsetX(I-1),Y=Aa(b*Z,o,f,y,w.segment,O,j,k,E);if(!Y)return null;const Q=Aa(b*U,o,f,y,w.segment,O,j,k,E);return Q?k.projectionCache.anyProjectionOccluded?null:{first:Y,last:Q}:null}function ro(b,e,o,f){return b===c.ao.horizontal&&Math.abs(o.y-e.y)>Math.abs(o.x-e.x)*f?{useVertical:!0}:(b===c.ao.vertical?e.y<o.y:e.x>o.x)?{needsFlipping:!0}:null}function Et(b){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:o,symbol:f,fontSize:y,flip:w,keepUpright:E,glyphOffsetArray:k,dynamicLayoutVertexArray:I,aspectRatio:O,rotateToLine:j}=b,Z=y/24,U=f.lineOffsetX*Z,Y=f.lineOffsetY*Z;let Q;if(f.numGlyphs>1){const le=f.glyphStartIndex+f.numGlyphs,oe=f.lineStartIndex,ue=f.lineStartIndex+f.lineLength,de=ko(Z,k,U,Y,w,f,j,e);if(!de)return{notEnoughRoom:!0};const _e=Ja(de.first.point.x,de.first.point.y,e,o),fe=Ja(de.last.point.x,de.last.point.y,e,o);if(E&&!w){const be=ro(f.writingMode,_e,fe,O);if(be)return be}Q=[de.first];for(let be=f.glyphStartIndex+1;be<le-1;be++){const Se=Aa(Z*k.getoffsetX(be),U,Y,w,f.segment,oe,ue,e,j);if(!Se)return{notEnoughRoom:!0};Q.push(Se)}Q.push(de.last)}else{if(E&&!w){const oe=rr(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ue=f.lineStartIndex+f.segment+1,de=new c.P(e.lineVertexArray.getx(ue),e.lineVertexArray.gety(ue)),_e=rr(de.x,de.y,e),fe=_e.signedDistanceFromCamera>0?_e.point:hn(e.tileAnchorPoint,de,oe,1,e),be=Ja(oe.x,oe.y,e,o),Se=Ja(fe.x,fe.y,e,o),ge=ro(f.writingMode,be,Se,O);if(ge)return ge}const le=Aa(Z*k.getoffsetX(f.glyphStartIndex),U,Y,w,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,e,j);if(!le||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[le]}for(const le of Q)c.av(I,le.point,le.angle);return{}}function hn(b,e,o,f,y){const w=b.add(b.sub(e)._unit()),E=rr(w.x,w.y,y).point,k=o.sub(E);return o.add(k._mult(f/k.mag()))}function an(b,e,o){const f=e.projectionCache;if(f.projections[b])return f.projections[b];const y=new c.P(e.lineVertexArray.getx(b),e.lineVertexArray.gety(b)),w=rr(y.x,y.y,e);if(w.signedDistanceFromCamera>0)return f.projections[b]=w.point,f.anyProjectionOccluded=f.anyProjectionOccluded||w.isOccluded,w.point;const E=b-o.direction;return hn(o.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(E),e.lineVertexArray.gety(E)),y,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,e)}function rr(b,e,o){const f=b+o.translation[0],y=e+o.translation[1];let w;return o.pitchWithMap?(w=Ai(f,y,o.pitchedLabelPlaneMatrix,o.getElevation),w.isOccluded=!1):(w=o.transform.projectTileCoordinates(f,y,o.unwrappedTileID,o.getElevation),w.point.x=(.5*w.point.x+.5)*o.width,w.point.y=(.5*-w.point.y+.5)*o.height),w}function Ja(b,e,o,f){if(o.pitchWithMap){const y=[b,e,0,1];return c.aw(y,y,f),o.transform.projectTileCoordinates(y[0]/y[3],y[1]/y[3],o.unwrappedTileID,o.getElevation).point}return{x:b/o.width*2-1,y:1-e/o.height*2}}function Mi(b,e,o){return o.transform.projectTileCoordinates(b,e,o.unwrappedTileID,o.getElevation)}function dn(b,e,o){return b._unit()._perp()._mult(e*o)}function $u(b,e,o,f,y,w,E,k,I){if(k.projectionCache.offsets[b])return k.projectionCache.offsets[b];const O=o.add(e);if(b+I.direction<f||b+I.direction>=y)return k.projectionCache.offsets[b]=O,O;const j=an(b+I.direction,k,I),Z=dn(j.sub(o),E,I.direction),U=o.add(Z),Y=j.add(Z);return k.projectionCache.offsets[b]=c.ax(w,O,U,Y)||O,k.projectionCache.offsets[b]}function Aa(b,e,o,f,y,w,E,k,I){const O=f?b-e:b+e;let j=O>0?1:-1,Z=0;f&&(j*=-1,Z=Math.PI),j<0&&(Z+=Math.PI);let U,Y=j>0?w+y:w+y+1;k.projectionCache.cachedAnchorPoint?U=k.projectionCache.cachedAnchorPoint:(U=rr(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=U);let Q,le,oe=U,ue=U,de=0,_e=0;const fe=Math.abs(O),be=[];let Se;for(;de+_e<=fe;){if(Y+=j,Y<w||Y>=E)return null;de+=_e,ue=oe,le=Q;const He={absOffsetX:fe,direction:j,distanceFromAnchor:de,previousVertex:ue};if(oe=an(Y,k,He),o===0)be.push(ue),Se=oe.sub(ue);else{let Oe;const je=oe.sub(ue);Oe=je.mag()===0?dn(an(Y+j,k,He).sub(oe),o,j):dn(je,o,j),le||(le=ue.add(Oe)),Q=$u(Y,Oe,oe,w,E,le,o,k,He),be.push(le),Se=Q.sub(le)}_e=Se.mag()}const ge=Se._mult((fe-de)/_e)._add(le||ue),ke=Z+Math.atan2(oe.y-ue.y,oe.x-ue.x);return be.push(ge),{point:ge,angle:I?ke:0,path:be}}const Io=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ao(b,e){for(let o=0;o<b;o++){const f=e.length;e.resize(f+4),e.float32.set(Io,3*f)}}function Ql(b,e,o){const f=e[0],y=e[1];return b[0]=o[0]*f+o[4]*y+o[12],b[1]=o[1]*f+o[5]*y+o[13],b[3]=o[3]*f+o[7]*y+o[15],b}const Ui=100;class pd{constructor(e,o=new yr(e.width+200,e.height+200,25),f=new yr(e.width+200,e.height+200,25)){this.transform=e,this.grid=o,this.ignoredGrid=f,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Ui,this.screenBottomBoundary=e.height+Ui,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,o,f,y,w,E,k,I,O,j,Z,U){const Y=this.projectAndGetPerspectiveRatio(e.anchorPointX+I[0],e.anchorPointY+I[1],w,j,U),Q=f*Y.perspectiveRatio;let le;if(E||k)le=this._projectCollisionBox(e,Q,y,w,E,k,I,Y,j,Z,U);else{const Se=Y.x+(Z?Z.x*Q:0),ge=Y.y+(Z?Z.y*Q:0);le={allPointsOccluded:!1,box:[Se+e.x1*Q,ge+e.y1*Q,Se+e.x2*Q,ge+e.y2*Q]}}const[oe,ue,de,_e]=le.box,fe=E?le.allPointsOccluded:Y.isOccluded;let be=fe;return be||(be=Y.perspectiveRatio<this.perspectiveRatioCutoff),be||(be=!this.isInsideGrid(oe,ue,de,_e)),be||o!=="always"&&this.grid.hitTest(oe,ue,de,_e,o,O)?{box:[oe,ue,de,_e],placeable:!1,offscreen:!1,occluded:fe}:{box:[oe,ue,de,_e],placeable:!0,offscreen:this.isOffscreen(oe,ue,de,_e),occluded:fe}}placeCollisionCircles(e,o,f,y,w,E,k,I,O,j,Z,U,Y,Q){const le=[],oe=new c.P(o.anchorX,o.anchorY),ue=this.getPerspectiveRatio(oe.x,oe.y,E,Q),de=(O?w*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,E)/ue:w*ue)/c.aB,_e={getElevation:Q,pitchedLabelPlaneMatrix:k,lineVertexArray:f,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:oe,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:Y},fe=ko(de,y,o.lineOffsetX*de,o.lineOffsetY*de,!1,o,!1,_e);let be=!1,Se=!1,ge=!0;if(fe){const ke=.5*Z*ue+U,He=new c.P(-100,-100),Oe=new c.P(this.screenRightBoundary,this.screenBottomBoundary),je=new ii,$e=fe.first,yt=fe.last;let vt=[];for(let fn=$e.path.length-1;fn>=1;fn--)vt.push($e.path[fn]);for(let fn=1;fn<yt.path.length;fn++)vt.push(yt.path[fn]);const ot=2.5*ke;if(O){const fn=this.projectPathToScreenSpace(vt,_e);vt=fn.some(zn=>zn.signedDistanceFromCamera<=0)?[]:fn.map(zn=>zn.point)}let Ot=[];if(vt.length>0){const fn=vt[0].clone(),zn=vt[0].clone();for(let Qn=1;Qn<vt.length;Qn++)fn.x=Math.min(fn.x,vt[Qn].x),fn.y=Math.min(fn.y,vt[Qn].y),zn.x=Math.max(zn.x,vt[Qn].x),zn.y=Math.max(zn.y,vt[Qn].y);Ot=fn.x>=He.x&&zn.x<=Oe.x&&fn.y>=He.y&&zn.y<=Oe.y?[vt]:zn.x<He.x||fn.x>Oe.x||zn.y<He.y||fn.y>Oe.y?[]:c.ay([vt],He.x,He.y,Oe.x,Oe.y)}for(const fn of Ot){je.reset(fn,.25*ke);let zn=0;zn=je.length<=.5*ke?1:Math.ceil(je.paddedLength/ot)+1;for(let Qn=0;Qn<zn;Qn++){const Yn=Qn/Math.max(zn-1,1),zi=je.lerp(Yn),Di=zi.x+Ui,cn=zi.y+Ui;le.push(Di,cn,ke,0);const Kn=Di-ke,Xi=cn-ke,pr=Di+ke,br=cn+ke;if(ge=ge&&this.isOffscreen(Kn,Xi,pr,br),Se=Se||this.isInsideGrid(Kn,Xi,pr,br),e!=="always"&&this.grid.hitTestCircle(Di,cn,ke,e,j)&&(be=!0,!I))return{circles:[],offscreen:!1,collisionDetected:be}}}}return{circles:!I&&be||!Se||ue<this.perspectiveRatioCutoff?[]:le,offscreen:ge,collisionDetected:be}}projectPathToScreenSpace(e,o){const f=function(y,w){const E=c.L();return c.aq(E,w.pitchedLabelPlaneMatrix),y.map(k=>{const I=Ai(k.x,k.y,E,w.getElevation),O=w.transform.projectTileCoordinates(I.point.x,I.point.y,w.unwrappedTileID,w.getElevation);return O.point.x=(.5*O.point.x+.5)*w.width,O.point.y=(.5*-O.point.y+.5)*w.height,O})}(e,o);return function(y){let w=0,E=0,k=0,I=0;for(let O=0;O<y.length;O++)y[O].isOccluded?(k=O+1,I=0):(I++,I>E&&(E=I,w=k));return y.slice(w,w+E)}(f)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[],f=new c.a2;for(const Z of e){const U=new c.P(Z.x+Ui,Z.y+Ui);f.extend(U),o.push(U)}const{minX:y,minY:w,maxX:E,maxY:k}=f,I=this.grid.query(y,w,E,k).concat(this.ignoredGrid.query(y,w,E,k)),O={},j={};for(const Z of I){const U=Z.key;if(O[U.bucketInstanceId]===void 0&&(O[U.bucketInstanceId]={}),O[U.bucketInstanceId][U.featureIndex])continue;const Y=[new c.P(Z.x1,Z.y1),new c.P(Z.x2,Z.y1),new c.P(Z.x2,Z.y2),new c.P(Z.x1,Z.y2)];c.az(o,Y)&&(O[U.bucketInstanceId][U.featureIndex]=!0,j[U.bucketInstanceId]===void 0&&(j[U.bucketInstanceId]=[]),j[U.bucketInstanceId].push(U.featureIndex))}return j}insertCollisionBox(e,o,f,y,w,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:E,overlapMode:o},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,o,f,y,w,E){const k=f?this.ignoredGrid:this.grid,I={bucketInstanceId:y,featureIndex:w,collisionGroupID:E,overlapMode:o};for(let O=0;O<e.length;O+=4)k.insertCircle(I,e[O],e[O+1],e[O+2])}projectAndGetPerspectiveRatio(e,o,f,y,w){if(w){let E;y?(E=[e,o,y(e,o),1],c.aw(E,E,w)):(E=[e,o,0,1],Ql(E,E,w));const k=E[3];return{x:(E[0]/k+1)/2*this.transform.width+Ui,y:(-E[1]/k+1)/2*this.transform.height+Ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}{const E=this.transform.projectTileCoordinates(e,o,f,y);return{x:(E.point.x+1)/2*this.transform.width+Ui,y:(1-E.point.y)/2*this.transform.height+Ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(e,o,f,y){const w=this.transform.projectTileCoordinates(e,o,f,y);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(e,o,f,y){return f<Ui||e>=this.screenRightBoundary||y<Ui||o>this.screenBottomBoundary}isInsideGrid(e,o,f,y){return f>=0&&e<this.gridRightBoundary&&y>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const e=c.ag([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,o,f,y,w,E,k,I,O,j,Z){let U=1,Y=0,Q=0,le=1;const oe=e.anchorPointX+k[0],ue=e.anchorPointY+k[1];if(E&&!w){const vt=this.projectAndGetPerspectiveRatio(oe+1,ue,y,O,Z),ot=vt.x-I.x,Ot=Math.atan((vt.y-I.y)/ot)+(ot<0?Math.PI:0),fn=Math.sin(Ot),zn=Math.cos(Ot);U=zn,Y=fn,Q=-fn,le=zn}else if(!E&&w){const vt=nn(this.transform);U=vt.vecEast[0],Y=vt.vecEast[1],Q=vt.vecSouth[0],le=vt.vecSouth[1]}let de=I.x,_e=I.y,fe=o;w&&(de=oe,_e=ue,fe=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),fe*=this.transform.getPitchedTextCorrection(oe,ue,y),j||(fe*=c.ah(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(de+=U*j.x*fe+Q*j.y*fe,_e+=Y*j.x*fe+le*j.y*fe);const be=e.x1*fe,Se=e.x2*fe,ge=(be+Se)/2,ke=e.y1*fe,He=e.y2*fe,Oe=(ke+He)/2,je=[{offsetX:be,offsetY:ke},{offsetX:ge,offsetY:ke},{offsetX:Se,offsetY:ke},{offsetX:Se,offsetY:Oe},{offsetX:Se,offsetY:He},{offsetX:ge,offsetY:He},{offsetX:be,offsetY:He},{offsetX:be,offsetY:Oe}];let $e=[];for(const{offsetX:vt,offsetY:ot}of je)$e.push(new c.P(de+U*vt+Q*ot,_e+Y*vt+le*ot));let yt=!1;if(w){const vt=$e.map(ot=>this.projectAndGetPerspectiveRatio(ot.x,ot.y,y,O,Z));yt=vt.some(ot=>!ot.isOccluded),$e=vt.map(ot=>new c.P(ot.x,ot.y))}else yt=!0;return{box:c.aA($e),allPointsOccluded:!yt}}}class Rr{constructor(e,o,f,y){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?o:-o))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Zn{constructor(e,o,f,y,w){this.text=new Rr(e?e.text:null,o,f,w),this.icon=new Rr(e?e.icon:null,o,y,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class so{constructor(e,o,f){this.text=e,this.icon=o,this.skipFade=f}}class Kl{constructor(e,o,f,y,w){this.bucketInstanceId=e,this.featureIndex=o,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=w}}class md{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const o=++this.maxGroupID;this.collisionGroups[e]={ID:o,predicate:f=>f.collisionGroupID===o}}return this.collisionGroups[e]}}function Na(b,e,o,f,y){const{horizontalAlign:w,verticalAlign:E}=c.aH(b);return new c.P(-(w-.5)*e+f[0]*y,-(E-.5)*o+f[1]*y)}class oo{constructor(e,o,f,y,w){this.transform=e.clone(),this.terrain=o,this.collisionIndex=new pd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new md(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const o=this.terrain;return o?(f,y)=>o.getElevation(e,f,y):null}getBucketParts(e,o,f,y){const w=f.getBucket(o),E=f.latestFeatureIndex;if(!w||!E||o.id!==w.layerIds[0])return;const k=f.collisionBoxArray,I=w.layers[0].layout,O=w.layers[0].paint,j=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),Z=f.tileSize/c.$,U=f.tileID.toUnwrapped(),Y=I.get("text-rotation-alignment")==="map",Q=c.aC(f,1,this.transform.zoom),le=c.aD(this.collisionIndex.transform,f,O.get("text-translate"),O.get("text-translate-anchor")),oe=c.aD(this.collisionIndex.transform,f,O.get("icon-translate"),O.get("icon-translate-anchor")),ue=li(Y,this.transform,Q);this.retainedQueryData[w.bucketInstanceId]=new Kl(w.bucketInstanceId,E,w.sourceLayerIndex,w.index,f.tileID);const de={bucket:w,layout:I,translationText:le,translationIcon:oe,unwrappedTileID:U,pitchedLabelPlaneMatrix:ue,scale:j,textPixelRatio:Z,holdingForFade:f.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:c.an(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(y)for(const _e of w.sortKeyRanges){const{sortKey:fe,symbolInstanceStart:be,symbolInstanceEnd:Se}=_e;e.push({sortKey:fe,symbolInstanceStart:be,symbolInstanceEnd:Se,parameters:de})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:de})}attemptAnchorPlacement(e,o,f,y,w,E,k,I,O,j,Z,U,Y,Q,le,oe,ue,de,_e,fe){const be=c.aE[e.textAnchor],Se=[e.textOffset0,e.textOffset1],ge=Na(be,f,y,Se,w),ke=this.collisionIndex.placeCollisionBox(o,U,I,O,j,k,E,oe,Z.predicate,_e,ge,fe);if((!de||this.collisionIndex.placeCollisionBox(de,U,I,O,j,k,E,ue,Z.predicate,_e,ge,fe).placeable)&&ke.placeable){let He;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(He=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Se,width:f,height:y,anchor:be,textBoxScale:w,prevAnchor:He},this.markUsedJustification(Q,be,Y,le),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,le,Y),this.placedOrientations[Y.crossTileID]=le),{shift:ge,placedGlyphBoxes:ke}}}placeLayerBucketPart(e,o,f){const{bucket:y,layout:w,translationText:E,translationIcon:k,unwrappedTileID:I,pitchedLabelPlaneMatrix:O,textPixelRatio:j,holdingForFade:Z,collisionBoxArray:U,partiallyEvaluatedTextSize:Y,collisionGroup:Q}=e.parameters,le=w.get("text-optional"),oe=w.get("icon-optional"),ue=c.aF(w,"text-overlap","text-allow-overlap"),de=ue==="always",_e=c.aF(w,"icon-overlap","icon-allow-overlap"),fe=_e==="always",be=w.get("text-rotation-alignment")==="map",Se=w.get("text-pitch-alignment")==="map",ge=w.get("icon-text-fit")!=="none",ke=w.get("symbol-z-order")==="viewport-y",He=de&&(fe||!y.hasIconData()||oe),Oe=fe&&(de||!y.hasTextData()||le);!y.collisionArrays&&U&&y.deserializeCollisionBoxes(U);const je=this.retainedQueryData[y.bucketInstanceId].tileID,$e=this._getTerrainElevationFunc(je),yt=this.transform.getFastPathSimpleProjectionMatrix(je),vt=(ot,Ot,fn)=>{var zn,Qn;if(o[ot.crossTileID])return;if(Z)return void(this.placements[ot.crossTileID]=new so(!1,!1,!1));let Yn=!1,zi=!1,Di=!0,cn=null,Kn={box:null,placeable:!1,offscreen:null,occluded:!1},Xi={placeable:!1},pr=null,br=null,_a=null,Rs=0,qo=0,os=0;Ot.textFeatureIndex?Rs=Ot.textFeatureIndex:ot.useRuntimeCollisionCircles&&(Rs=ot.featureIndex),Ot.verticalTextFeatureIndex&&(qo=Ot.verticalTextFeatureIndex);const Ml=Ot.textBox;if(Ml){const jr=ki=>{let Gi=c.ao.horizontal;if(y.allowVerticalPlacement&&!ki&&this.prevPlacement){const va=this.prevPlacement.placedOrientations[ot.crossTileID];va&&(this.placedOrientations[ot.crossTileID]=va,Gi=va,this.markUsedOrientation(y,Gi,ot))}return Gi},ls=(ki,Gi)=>{if(y.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&Ot.verticalTextBox){for(const va of y.writingModes)if(va===c.ao.vertical?(Kn=Gi(),Xi=Kn):Kn=ki(),Kn&&Kn.placeable)break}else Kn=ki()},aa=ot.textAnchorOffsetStartIndex,kl=ot.textAnchorOffsetEndIndex;if(kl===aa){const ki=(Gi,va)=>{const Ni=this.collisionIndex.placeCollisionBox(Gi,ue,j,je,I,Se,be,E,Q.predicate,$e,void 0,yt);return Ni&&Ni.placeable&&(this.markUsedOrientation(y,va,ot),this.placedOrientations[ot.crossTileID]=va),Ni};ls(()=>ki(Ml,c.ao.horizontal),()=>{const Gi=Ot.verticalTextBox;return y.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&Gi?ki(Gi,c.ao.vertical):{box:null,offscreen:null}}),jr(Kn&&Kn.placeable)}else{let ki=c.aE[(Qn=(zn=this.prevPlacement)===null||zn===void 0?void 0:zn.variableOffsets[ot.crossTileID])===null||Qn===void 0?void 0:Qn.anchor];const Gi=(Ni,Il,Ec)=>{const _o=Ni.x2-Ni.x1,sa=Ni.y2-Ni.y1,Xo=ot.textBoxScale,Za=ge&&_e==="never"?Il:null;let Wi=null,Wo=ue==="never"?1:2,zd="never";ki&&Wo++;for(let Ps=0;Ps<Wo;Ps++){for(let cs=aa;cs<kl;cs++){const _i=y.textAnchorOffsets.get(cs);if(ki&&_i.textAnchor!==ki)continue;const us=this.attemptAnchorPlacement(_i,Ni,_o,sa,Xo,be,Se,j,je,I,Q,zd,ot,y,Ec,E,k,Za,$e);if(us&&(Wi=us.placedGlyphBoxes,Wi&&Wi.placeable))return Yn=!0,cn=us.shift,Wi}ki?ki=null:zd=ue}return f&&!Wi&&(Wi={box:this.collisionIndex.placeCollisionBox(Ml,"always",j,je,I,Se,be,E,Q.predicate,$e,void 0,yt).box,offscreen:!1,placeable:!1,occluded:!1}),Wi};ls(()=>Gi(Ml,Ot.iconBox,c.ao.horizontal),()=>{const Ni=Ot.verticalTextBox;return y.allowVerticalPlacement&&(!Kn||!Kn.placeable)&&ot.numVerticalGlyphVertices>0&&Ni?Gi(Ni,Ot.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}}),Kn&&(Yn=Kn.placeable,Di=Kn.offscreen);const va=jr(Kn&&Kn.placeable);if(!Yn&&this.prevPlacement){const Ni=this.prevPlacement.variableOffsets[ot.crossTileID];Ni&&(this.variableOffsets[ot.crossTileID]=Ni,this.markUsedJustification(y,Ni.anchor,ot,va))}}}if(pr=Kn,Yn=pr&&pr.placeable,Di=pr&&pr.offscreen,ot.useRuntimeCollisionCircles){const jr=y.text.placedSymbolArray.get(ot.centerJustifiedTextSymbolIndex),ls=c.ap(y.textSizeData,Y,jr),aa=w.get("text-padding");br=this.collisionIndex.placeCollisionCircles(ue,jr,y.lineVertexArray,y.glyphOffsetArray,ls,I,O,f,Se,Q.predicate,ot.collisionCircleDiameter,aa,E,$e),br.circles.length&&br.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),Yn=de||br.circles.length>0&&!br.collisionDetected,Di=Di&&br.offscreen}if(Ot.iconFeatureIndex&&(os=Ot.iconFeatureIndex),Ot.iconBox){const jr=ls=>this.collisionIndex.placeCollisionBox(ls,_e,j,je,I,Se,be,k,Q.predicate,$e,ge&&cn?cn:void 0,yt);Xi&&Xi.placeable&&Ot.verticalIconBox?(_a=jr(Ot.verticalIconBox),zi=_a.placeable):(_a=jr(Ot.iconBox),zi=_a.placeable),Di=Di&&_a.offscreen}const Ho=le||ot.numHorizontalGlyphVertices===0&&ot.numVerticalGlyphVertices===0,Cl=oe||ot.numIconVertices===0;Ho||Cl?Cl?Ho||(zi=zi&&Yn):Yn=zi&&Yn:zi=Yn=zi&&Yn;const Dl=zi&&_a.placeable;if(Yn&&pr.placeable&&this.collisionIndex.insertCollisionBox(pr.box,ue,w.get("text-ignore-placement"),y.bucketInstanceId,Xi&&Xi.placeable&&qo?qo:Rs,Q.ID),Dl&&this.collisionIndex.insertCollisionBox(_a.box,_e,w.get("icon-ignore-placement"),y.bucketInstanceId,os,Q.ID),br&&Yn&&this.collisionIndex.insertCollisionCircles(br.circles,ue,w.get("text-ignore-placement"),y.bucketInstanceId,Rs,Q.ID),f&&this.storeCollisionData(y.bucketInstanceId,fn,Ot,pr,_a,br),ot.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ot.crossTileID]=new so((Yn||He)&&!pr?.occluded,(zi||Oe)&&!_a?.occluded,Di||y.justReloaded),o[ot.crossTileID]=!0};if(ke){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ot=y.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ot=ot.length-1;Ot>=0;--Ot){const fn=ot[Ot];vt(y.symbolInstances.get(fn),y.collisionArrays[fn],fn)}}else for(let ot=e.symbolInstanceStart;ot<e.symbolInstanceEnd;ot++)vt(y.symbolInstances.get(ot),y.collisionArrays[ot],ot);y.justReloaded=!1}storeCollisionData(e,o,f,y,w,E){if(f.textBox||f.iconBox){let k,I;this.collisionBoxArrays.has(e)?k=this.collisionBoxArrays.get(e):(k=new Map,this.collisionBoxArrays.set(e,k)),k.has(o)?I=k.get(o):(I={text:null,icon:null},k.set(o,I)),f.textBox&&(I.text=y.box),f.iconBox&&(I.icon=w.box)}if(E){let k=this.collisionCircleArrays[e];k===void 0&&(k=this.collisionCircleArrays[e]=[]);for(let I=0;I<E.circles.length;I+=4)k.push(E.circles[I+0]-Ui),k.push(E.circles[I+1]-Ui),k.push(E.circles[I+2]),k.push(E.collisionDetected?1:0)}}markUsedJustification(e,o,f,y){let w;w=y===c.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.aG(o)];const E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const k of E)k>=0&&(e.text.placedSymbolArray.get(k).crossTileID=w>=0&&k!==w?0:f.crossTileID)}markUsedOrientation(e,o,f){const y=o===c.ao.horizontal||o===c.ao.horizontalOnly?o:0,w=o===c.ao.vertical?o:0,E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const k of E)e.text.placedSymbolArray.get(k).placedOrientation=y;f.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let f=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const y=o?o.symbolFadeChange(e):1,w=o?o.opacities:{},E=o?o.variableOffsets:{},k=o?o.placedOrientations:{};for(const I in this.placements){const O=this.placements[I],j=w[I];j?(this.opacities[I]=new Zn(j,y,O.text,O.icon),f=f||O.text!==j.text.placed||O.icon!==j.icon.placed):(this.opacities[I]=new Zn(null,y,O.text,O.icon,O.skipFade),f=f||O.text||O.icon)}for(const I in w){const O=w[I];if(!this.opacities[I]){const j=new Zn(O,y,!1,!1);j.isHidden()||(this.opacities[I]=j,f=f||O.text.placed||O.icon.placed)}}for(const I in E)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=E[I]);for(const I in k)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=k[I]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:e)}updateLayerOpacities(e,o){const f={};for(const y of o){const w=y.getBucket(e);w&&y.latestFeatureIndex&&e.id===w.layerIds[0]&&this.updateBucketOpacities(w,y.tileID,f,y.collisionBoxArray)}}updateBucketOpacities(e,o,f,y){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const w=e.layers[0],E=w.layout,k=new Zn(null,0,!1,!1,!0),I=E.get("text-allow-overlap"),O=E.get("icon-allow-overlap"),j=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Z=E.get("text-rotation-alignment")==="map",U=E.get("text-pitch-alignment")==="map",Y=E.get("icon-text-fit")!=="none",Q=new Zn(null,0,I&&(O||!e.hasIconData()||E.get("icon-optional")),O&&(I||!e.hasTextData()||E.get("text-optional")),!0);!e.collisionArrays&&y&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(y);const le=(ue,de,_e)=>{for(let fe=0;fe<de/4;fe++)ue.opacityVertexArray.emplaceBack(_e);ue.hasVisibleVertices=ue.hasVisibleVertices||_e!==Gc},oe=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ue=0;ue<e.symbolInstances.length;ue++){const de=e.symbolInstances.get(ue),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:fe,crossTileID:be}=de;let Se=this.opacities[be];f[be]?Se=k:Se||(Se=Q,this.opacities[be]=Se),f[be]=!0;const ge=de.numIconVertices>0,ke=this.placedOrientations[de.crossTileID],He=ke===c.ao.vertical,Oe=ke===c.ao.horizontal||ke===c.ao.horizontalOnly;if(_e>0||fe>0){const $e=Vc(Se.text);le(e.text,_e,He?Gc:$e),le(e.text,fe,Oe?Gc:$e);const yt=Se.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach(Ot=>{Ot>=0&&(e.text.placedSymbolArray.get(Ot).hidden=yt||He?1:0)}),de.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=yt||Oe?1:0);const vt=this.variableOffsets[de.crossTileID];vt&&this.markUsedJustification(e,vt.anchor,de,ke);const ot=this.placedOrientations[de.crossTileID];ot&&(this.markUsedJustification(e,"left",de,ot),this.markUsedOrientation(e,ot,de))}if(ge){const $e=Vc(Se.icon),yt=!(Y&&de.verticalPlacedIconSymbolIndex&&He);de.placedIconSymbolIndex>=0&&(le(e.icon,de.numIconVertices,yt?$e:Gc),e.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=Se.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(le(e.icon,de.numVerticalIconVertices,yt?Gc:$e),e.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=Se.icon.isHidden())}const je=oe&&oe.has(ue)?oe.get(ue):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const $e=e.collisionArrays[ue];if($e){let yt=new c.P(0,0);if($e.textBox||$e.verticalTextBox){let vt=!0;if(j){const ot=this.variableOffsets[be];ot?(yt=Na(ot.anchor,ot.width,ot.height,ot.textOffset,ot.textBoxScale),Z&&yt._rotate(U?-this.transform.bearingInRadians:this.transform.bearingInRadians)):vt=!1}if($e.textBox||$e.verticalTextBox){let ot;$e.textBox&&(ot=He),$e.verticalTextBox&&(ot=Oe),Yu(e.textCollisionBox.collisionVertexArray,Se.text.placed,!vt||ot,je.text,yt.x,yt.y)}}if($e.iconBox||$e.verticalIconBox){const vt=!!(!Oe&&$e.verticalIconBox);let ot;$e.iconBox&&(ot=vt),$e.verticalIconBox&&(ot=!vt),Yu(e.iconCollisionBox.collisionVertexArray,Se.icon.placed,ot,je.icon,Y?yt.x:0,Y?yt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,o){const f=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*f>e}setStale(){this.stale=!0}}function Yu(b,e,o,f,y,w){f&&f.length!==0||(f=[0,0,0,0]);const E=f[0]-Ui,k=f[1]-Ui,I=f[2]-Ui,O=f[3]-Ui;b.emplaceBack(e?1:0,o?1:0,y||0,w||0,E,k),b.emplaceBack(e?1:0,o?1:0,y||0,w||0,I,k),b.emplaceBack(e?1:0,o?1:0,y||0,w||0,I,O),b.emplaceBack(e?1:0,o?1:0,y||0,w||0,E,O)}const Gp=Math.pow(2,25),wf=Math.pow(2,24),Pr=Math.pow(2,17),Tf=Math.pow(2,16),Eg=Math.pow(2,9),gd=Math.pow(2,8),Zp=Math.pow(2,1);function Vc(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const e=b.placed?1:0,o=Math.floor(127*b.opacity);return o*Gp+e*wf+o*Pr+e*Tf+o*Eg+e*gd+o*Zp+e}const Gc=0;class Ma{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,o,f,y,w){const E=this._bucketParts;for(;this._currentTileIndex<e.length;)if(o.getBucketParts(E,y,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((k,I)=>k.sortKey-I.sortKey));this._currentPartIndex<E.length;)if(o.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,w())return!0;return!1}}class qu{constructor(e,o,f,y,w,E,k,I){this.placement=new oo(e,o,E,k,I),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(e,o,f){const y=V.now(),w=()=>!this._forceFullPlacement&&V.now()-y>2;for(;this._currentPlacementIndex>=0;){const E=o[e[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=k)&&(!E.maxzoom||E.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Ma(E)),this._inProgressLayer.continuePlacement(f[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Jl=512/c.$/2;class Hu{constructor(e,o,f){this.tileID=e,this.bucketInstanceId=f,this._symbolsByKey={};const y=new Map;for(let w=0;w<o.length;w++){const E=o.get(w),k=E.key,I=y.get(k);I?I.push(E):y.set(k,[E])}for(const[w,E]of y){const k={positions:E.map(I=>({x:Math.floor(I.anchorX*Jl),y:Math.floor(I.anchorY*Jl)})),crossTileIDs:E.map(I=>I.crossTileID)};if(k.positions.length>128){const I=new c.aI(k.positions.length,16,Uint16Array);for(const{x:O,y:j}of k.positions)I.add(O,j);I.finish(),delete k.positions,k.index=I}this._symbolsByKey[w]=k}}getScaledCoordinates(e,o){const{x:f,y,z:w}=this.tileID.canonical,{x:E,y:k,z:I}=o.canonical,O=Jl/Math.pow(2,I-w),j=(k*c.$+e.anchorY)*O,Z=y*c.$*Jl;return{x:Math.floor((E*c.$+e.anchorX)*O-f*c.$*Jl),y:Math.floor(j-Z)}}findMatches(e,o,f){const y=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let w=0;w<e.length;w++){const E=e.get(w);if(E.crossTileID)continue;const k=this._symbolsByKey[E.key];if(!k)continue;const I=this.getScaledCoordinates(E,o);if(k.index){const O=k.index.range(I.x-y,I.y-y,I.x+y,I.y+y).sort();for(const j of O){const Z=k.crossTileIDs[j];if(!f[Z]){f[Z]=!0,E.crossTileID=Z;break}}}else if(k.positions)for(let O=0;O<k.positions.length;O++){const j=k.positions[O],Z=k.crossTileIDs[O];if(Math.abs(j.x-I.x)<=y&&Math.abs(j.y-I.y)<=y&&!f[Z]){f[Z]=!0,E.crossTileID=Z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class cl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $p{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const o=Math.round((e-this.lng)/360);if(o!==0)for(const f in this.indexes){const y=this.indexes[f],w={};for(const E in y){const k=y[E];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+o),w[k.tileID.key]=k}this.indexes[f]=w}this.lng=e}addBucket(e,o,f){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let w=0;w<o.symbolInstances.length;w++)o.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const y=this.usedCrossTileIDs[e.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>e.overscaledZ)for(const k in E){const I=E[k];I.tileID.isChildOf(e)&&I.findMatches(o.symbolInstances,e,y)}else{const k=E[e.scaledTo(Number(w)).key];k&&k.findMatches(o.symbolInstances,e,y)}}for(let w=0;w<o.symbolInstances.length;w++){const E=o.symbolInstances.get(w);E.crossTileID||(E.crossTileID=f.generate(),y[E.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Hu(e,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(e,o){for(const f of o.getCrossTileIDsLists())for(const y of f)delete this.usedCrossTileIDs[e][y]}removeStaleBuckets(e){let o=!1;for(const f in this.indexes){const y=this.indexes[f];for(const w in y)e[y[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[w]),delete y[w],o=!0)}return o}}class ec{constructor(){this.layerIndexes={},this.crossTileIDs=new cl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,o,f){let y=this.layerIndexes[e.id];y===void 0&&(y=this.layerIndexes[e.id]=new $p);let w=!1;const E={};y.handleWrapJump(f);for(const k of o){const I=k.getBucket(e);I&&e.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(k.tileID,I,this.crossTileIDs)&&(w=!0),E[I.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(w=!0),w}pruneUnusedLayers(e){const o={};e.forEach(f=>{o[f]=!0});for(const f in this.layerIndexes)o[f]||delete this.layerIndexes[f]}}var lo="void main() {fragColor=vec4(1.0);}";const Ss={prelude:xn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:xn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:xn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:xn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:xn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:xn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:xn(lo,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:xn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:xn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:xn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:xn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:xn(lo,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:xn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:xn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:xn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:xn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:xn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:xn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:xn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:xn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:xn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:xn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:xn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:xn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:xn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:xn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:xn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:xn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:xn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:xn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function xn(b,e){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=e.match(/in ([\w]+) ([\w]+)/g),y=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=w?w.concat(y):y,k={};return{fragmentSource:b=b.replace(o,(I,O,j,Z,U)=>(k[U]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${j} ${Z} ${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = u_${U};
#endif
`)),vertexSource:e=e.replace(o,(I,O,j,Z,U)=>{const Y=Z==="float"?"vec2":"vec4",Q=U.match(/color/)?"color":Y;return k[U]?O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${j} ${Y} a_${U};
out ${j} ${Z} ${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${Q}(a_${U}, u_${U}_t);
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${j} ${Y} a_${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = a_${U};
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = unpack_mix_${Q}(a_${U}, u_${U}_t);
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`}),staticAttributes:f,staticUniforms:E}}class ul{constructor(e,o,f){this.vertexBuffer=e,this.indexBuffer=o,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var co=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const Ro="#define PROJECTION_MERCATOR",tc="mercator";class yn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return tc}get shaderDefine(){return Ro}get shaderPreludeCode(){return Ss.projectionMercator}get vertexShaderPreludeCode(){return Ss.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,o,f,y,w){if(this._cachedMesh)return this._cachedMesh;const E=new c.aL;E.emplaceBack(0,0),E.emplaceBack(c.$,0),E.emplaceBack(0,c.$),E.emplaceBack(c.$,c.$);const k=e.createVertexBuffer(E,co.members),I=c.aM.simpleSegment(0,0,4,2),O=new c.aN;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3);const j=e.createIndexBuffer(O);return this._cachedMesh=new ul(k,j,I),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Po{constructor(e=0,o=0,f=0,y=0){if(isNaN(e)||e<0||isNaN(o)||o<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=o,this.left=f,this.right=y}interpolate(e,o,f){return o.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,o.top,f)),o.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,o.bottom,f)),o.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,o.left,f)),o.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,o.right,f)),this}getCenter(e,o){const f=c.ah((this.left+e-this.right)/2,0,e),y=c.ah((this.top+o-this.bottom)/2,0,o);return new c.P(f,y)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Po(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Zc(b,e){if(!b.renderWorldCopies||b.lngRange)return;const o=e.lng-b.center.lng;e.lng+=o>180?-360:o<-180?360:0}function zo(b){return Math.max(0,Math.floor(b))}class dr{constructor(e,o,f,y,w,E){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=o||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=zo(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Po,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,o,f){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=zo(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Po(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!f&&e.autoCalculateNearFarZ,o&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const o=c.aO(e,-180,180)*Math.PI/180;var f,y,w,E,k,I,O,j,Z;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=R(),f=this._rotationMatrix,w=-this._bearingInRadians,E=(y=this._rotationMatrix)[0],k=y[1],I=y[2],O=y[3],j=Math.sin(w),Z=Math.cos(w),f[0]=E*Z+I*j,f[1]=k*Z+O*j,f[2]=E*-j+I*Z,f[3]=k*-j+O*Z)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const o=c.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const o=e/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(e){e=c.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const o=this.getConstrained(this._center,e).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=c.af(o),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,o){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,o,f){this._unmodified=!1,this._edgeInsets.interpolate(e,o,f),this._constrain(),this._calcMatrices()}resize(e,o,f=!0){this._width=e,this._height=o,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Gn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(e,o){return this._callbacks.getConstrained(e,o)}getCameraQueryGeometry(e,o){if(o.length===1)return[o[0],e];{const{minX:f,minY:y,maxX:w,maxY:E}=c.a2.fromPoints(o).extend(e);return[new c.P(f,y),new c.P(w,y),new c.P(w,E),new c.P(f,E),new c.P(f,y)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:o,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(o),this.setZoom(f),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.ag(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.ag(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,o,f,y){const w=f!==void 0?f:this.bearing,E=y=y!==void 0?y:this.pitch,k=c.a1.fromLngLat(e,o),I=-Math.cos(c.ae(E)),O=Math.sin(c.ae(E)),j=O*Math.sin(c.ae(w)),Z=-O*Math.cos(c.ae(w));let U=this.elevation;const Y=o-U;let Q;I*Y>=0||Math.abs(I)<.1?(Q=1e4,U=o+Q*I):Q=-Y/I;let le,oe,ue=c.aQ(1,k.y),de=0;do{if(de+=1,de>10)break;oe=Q/ue,le=new c.a1(k.x+j*oe,k.y+Z*oe),ue=1/le.meterInMercatorCoordinateUnits()}while(Math.abs(Q-oe*ue)>1e-12);return{center:le.toLngLat(),elevation:U,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/oe/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const o=c.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/o,y=c.a1.fromLngLat(this.center,this.elevation),w=Ue(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=e;const E=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),c.aQ(w.z,y.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Ue(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const o=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/o,e.canonical.y/o,1/o/c.$,1/o/c.$]}}class _r{constructor(e,o){this.min=e,this.max=o,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],f=c.aT(this.min),y=c.aT(this.max);for(let w=0;w<o.length;w++)f[w]=o[w]?this.min[w]:this.center[w],y[w]=o[w]?this.center[w]:this.max[w];return y[2]=this.max[2],new _r(f,y)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let o=!0;for(let f=0;f<e.planes.length;f++){const y=this.intersectsPlane(e.planes[f]);if(y===0)return 0;y===1&&(o=!1)}return o?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let o=e[3],f=e[3];for(let y=0;y<3;y++)e[y]>0?(o+=e[y]*this.min[y],f+=e[y]*this.max[y]):(f+=e[y]*this.min[y],o+=e[y]*this.max[y]);return o>=0?2:f<0?0:1}}class zr{distanceToTile2d(e,o,f,y){const w=y.distanceX([e,o]),E=y.distanceY([e,o]);return Math.hypot(w,E)}getWrap(e,o,f){return f}getTileBoundingVolume(e,o,f,y){var w,E;let k=0,I=0;if(y?.terrain){const j=new c.Z(e.z,o,e.z,e.x,e.y),Z=y.terrain.getMinMaxElevation(j);k=(w=Z.minElevation)!==null&&w!==void 0?w:Math.min(0,f),I=(E=Z.maxElevation)!==null&&E!==void 0?E:Math.max(0,f)}const O=1<<e.z;return new _r([o+e.x/O,e.y/O,k],[o+(e.x+1)/O,(e.y+1)/O,I])}allowVariableZoom(e,o){const f=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,y=c.ah(78.5-f/2,0,60);return!!o.terrain||e.pitch>y}allowWorldCopies(){return!0}prepareNextFrame(){}}class ar{constructor(e,o,f){this.points=e,this.planes=o,this.aabb=f}static fromInvProjectionMatrix(e,o=1,f=0,y,w){const E=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],k=Math.pow(2,f),I=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>function(Y,Q,le,oe){const ue=c.aw([],Y,Q),de=1/ue[3]/le*oe;return c.aY(ue,ue,[de,de,1/ue[3],de])}(U,e,o,k));y&&function(U,Y,Q,le){const oe=le?4:0,ue=le?0:4;let de=0;const _e=[],fe=[];for(let ge=0;ge<4;ge++){const ke=c.aU([],U[ge+ue],U[ge+oe]),He=c.aZ(ke);c.aR(ke,ke,1/He),_e.push(He),fe.push(ke)}for(let ge=0;ge<4;ge++){const ke=c.a_(U[ge+oe],fe[ge],Q);de=ke!==null&&ke>=0?Math.max(de,ke):Math.max(de,_e[ge])}const be=function(ge,ke){const He=c.aU([],ge[ke[0]],ge[ke[1]]),Oe=c.aU([],ge[ke[2]],ge[ke[1]]),je=[0,0,0,0];return c.aV(je,c.aW([],He,Oe)),je[3]=-c.aX(je,ge[ke[0]]),je}(U,Y),Se=function(ge,ke){const He=c.a$(ge),Oe=c.b0([],ge,1/He),je=c.aU([],ke,c.aR([],Oe,c.aX(ke,Oe))),$e=c.a$(je);if($e>0){const yt=Math.sqrt(1-Oe[3]*Oe[3]),vt=c.aR([],Oe,-Oe[3]),ot=c.aS([],vt,c.aR([],je,yt/$e));return c.b1(ke,ot)}return null}(Q,be);if(Se!==null){const ge=Se/c.aX(fe[0],be);de=Math.min(de,ge)}for(let ge=0;ge<4;ge++){const ke=Math.min(de,_e[ge]);U[ge+ue]=[U[ge+oe][0]+fe[ge][0]*ke,U[ge+oe][1]+fe[ge][1]*ke,U[ge+oe][2]+fe[ge][2]*ke,1]}}(I,E[0],y,w);const O=E.map(U=>{const Y=c.aU([],I[U[0]],I[U[1]]),Q=c.aU([],I[U[2]],I[U[1]]),le=c.aV([],c.aW([],Y,Q)),oe=-c.aX(le,I[U[1]]);return le.concat(oe)}),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Z=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const U of I)for(let Y=0;Y<3;Y++)j[Y]=Math.min(j[Y],U[Y]),Z[Y]=Math.max(Z[Y],U[Y]);return new ar(I,O,new _r(j,Z))}}class Fn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,f=!0){this._helper.resize(e,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,o){}constructor(e,o,f,y,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new dr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,k)=>this.getConstrained(E,k)},e,o,f,y,w),this._coveringTilesDetailsProvider=new zr}clone(){const e=new Fn;return e.apply(this),e}apply(e,o,f){this._helper.apply(e,o,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const o=[new c.b2(0,e)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new c.P(0,0)),y=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),k=Math.floor(Math.min(f.x,y.x,w.x,E.x)),I=Math.floor(Math.max(f.x,y.x,w.x,E.x)),O=1;for(let j=k-O;j<=I+O;j++)j!==0&&o.push(new c.b2(j,e))}return o}getCameraFrustum(){return ar.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const o=this.screenPointToLocation(this.centerPoint,e),f=e?e.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(e,o){const f=c.aj(this.elevation,this.center.lat),y=this.screenPointToMercatorCoordinateAtZ(o,f),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),E=c.a1.fromLngLat(e),k=new c.a1(E.x-(y.x-w.x),E.y-(y.y-w.y));this.setCenter(k?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,o){return o?this.coordinatePoint(c.a1.fromLngLat(e),o.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(e))}screenPointToLocation(e,o){var f;return(f=this.screenPointToMercatorCoordinate(e,o))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(e,o){if(o){const f=o.pointCoordinate(e);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,o){const f=o||0,y=[e.x,e.y,0,1],w=[e.x,e.y,1,1];c.aw(y,y,this._pixelMatrixInverse),c.aw(w,w,this._pixelMatrixInverse);const E=y[3],k=w[3],I=y[1]/E,O=w[1]/k,j=y[2]/E,Z=w[2]/k,U=j===Z?0:(f-j)/(Z-j);return new c.a1(c.C.number(y[0]/E,w[0]/k,U)/this.worldSize,c.C.number(I,O,U)/this.worldSize,f)}coordinatePoint(e,o=0,f=this._pixelMatrix){const y=[e.x*this.worldSize,e.y*this.worldSize,o,1];return c.aw(y,y,f),new c.P(y[0]/y[3],y[1]/y[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Te(this));return new Gn().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,o){return o?o.pointCoordinate(e)!=null:e.y>this.height/2-Te(this)}calculatePosMatrix(e,o=!1,f){var y;const w=(y=e.key)!==null&&y!==void 0?y:c.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),E=o?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(w)){const O=E.get(w);return f?O.f32:O.f64}const k=Ce(e,this.worldSize);c.O(k,o?this._alignedProjMatrix:this._viewProjMatrix,k);const I={f64:k,f32:new Float32Array(k)};return E.set(w,I),f?I.f32:I.f64}calculateFogMatrix(e){const o=e.key,f=this._fogMatrixCacheF32;if(f.has(o))return f.get(o);const y=Ce(e,this.worldSize);return c.O(y,this._fogMatrix,y),f.set(o,new Float32Array(y)),f.get(o)}getConstrained(e,o){o=c.ah(+o,this.minZoom,this.maxZoom);const f={center:new c.S(e.lng,e.lat),zoom:o};let y=this._helper._lngRange;if(!this._helper._renderWorldCopies&&y===null){const _e=179.9999999999;y=[-_e,_e]}const w=this.tileSize*c.af(f.zoom);let E=0,k=w,I=0,O=w,j=0,Z=0;const{x:U,y:Y}=this.size;if(this._helper._latRange){const _e=this._helper._latRange;E=c.U(_e[1])*w,k=c.U(_e[0])*w,k-E<Y&&(j=Y/(k-E))}y&&(I=c.aO(c.V(y[0])*w,0,w),O=c.aO(c.V(y[1])*w,0,w),O<I&&(O+=w),O-I<U&&(Z=U/(O-I)));const{x:Q,y:le}=re(w,e);let oe,ue;const de=Math.max(Z||0,j||0);if(de){const _e=new c.P(Z?(O+I)/2:Q,j?(k+E)/2:le);return f.center=ye(w,_e).wrap(),f.zoom+=c.ak(de),f}if(this._helper._latRange){const _e=Y/2;le-_e<E&&(ue=E+_e),le+_e>k&&(ue=k-_e)}if(y){const _e=(I+O)/2;let fe=Q;this._helper._renderWorldCopies&&(fe=c.aO(Q,_e-w/2,_e+w/2));const be=U/2;fe-be<I&&(oe=I+be),fe+be>O&&(oe=O-be)}if(oe!==void 0||ue!==void 0){const _e=new c.P(oe??Q,ue??le);f.center=ye(w,_e).wrap()}return f}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}_calculateNearFarZIfNeeded(e,o,f){if(!this._helper.autoCalculateNearFarZ)return;const y=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=e-y*this._helper._pixelPerMeter/Math.cos(o),E=y<0?w:e,k=Math.PI/2+this.pitchInRadians,I=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),O=Math.sin(I)*E/Math.sin(c.ah(Math.PI-k-I,.01,Math.PI-.01)),j=Te(this),Z=Math.atan(j/this._helper.cameraToCenterDistance),U=c.ae(.75),Y=Z>U?2*Z*(.5+f.y/(2*j)):U,Q=Math.sin(Y)*E/Math.sin(c.ah(Math.PI-k-Y,.01,Math.PI-.01)),le=Math.min(O,Q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*le+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,o=re(this.worldSize,this.center),f=o.x,y=o.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const w=c.ae(Math.min(this.pitch,ee)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let k;this._calculateNearFarZIfNeeded(E,w,e),k=new Float64Array(16),c.b4(k,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,k),k[8]=2*-e.x/this._helper._width,k[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b5(k),c.N(k,k,[1,-1,1]),c.M(k,k,[0,0,-this._helper.cameraToCenterDistance]),c.b6(k,k,-this.rollInRadians),c.b7(k,k,this.pitchInRadians),c.b6(k,k,-this.bearingInRadians),c.M(k,k,[-f,-y,0]),this._mercatorMatrix=c.N([],k,[this.worldSize,this.worldSize,this.worldSize]),c.N(k,k,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,k),c.M(k,k,[0,0,-this.elevation]),this._viewProjMatrix=k,this._invViewProjMatrix=c.aq([],k);const I=[0,0,-1,1];c.aw(I,I,this._invViewProjMatrix),this._cameraPosition=[I[0]/I[3],I[1]/I[3],I[2]/I[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-f,-y,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,k);const O=this._helper._width%2/2,j=this._helper._height%2/2,Z=Math.cos(this.bearingInRadians),U=Math.sin(-this.bearingInRadians),Y=f-Math.round(f)+Z*O+U*j,Q=y-Math.round(y)+Z*j+U*O,le=new Float64Array(k);if(c.M(le,le,[Y>.5?Y-1:Y,Q>.5?Q-1:Q,0]),this._alignedProjMatrix=le,k=c.aq(new Float64Array(16),this._pixelMatrix),!k)throw new Error("failed to invert matrix");this._pixelMatrixInverse=k,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),o=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.aw(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Ue(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,o){const f=c.a1.fromLngLat(e),y=[f.x*this.worldSize,f.y*this.worldSize,o,1];return c.aw(y,y,this._viewProjMatrix),y[2]/y[3]}getProjectionData(e){const{overscaledTileID:o,aligned:f,applyTerrainMatrix:y}=e,w=this._helper.getMercatorTileCoordinates(o),E=o?this.calculatePosMatrix(o,f,!0):null;let k;return k=o&&o.terrainRttPosMatrix32f&&y?o.terrainRttPosMatrix32f:E||c.b8(),{mainMatrix:k,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:k}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,o,f){return 1}transformLightDirection(e){return c.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,o,f,y){const w=this.calculatePosMatrix(f);let E;y?(E=[e,o,y(e,o),1],c.aw(E,E,w)):(E=[e,o,0,1],Ql(E,E,w));const k=E[3];return{point:new c.P(E[0]/k,E[1]/k),signedDistanceFromCamera:k,isOccluded:!1}}populateCache(e){for(const o of e)this.calculatePosMatrix(o)}getMatrixForModel(e,o){const f=c.a1.fromLngLat(e,o),y=f.meterInMercatorCoordinateUnits(),w=c.b9();return c.M(w,w,[f.x,f.y,f.z]),c.b6(w,w,Math.PI),c.b7(w,w,Math.PI/2),c.N(w,w,[-y,y,y]),w}getProjectionDataForCustomLayer(e=!0){const o=new c.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:e}),y=Ce(o,this.worldSize);c.O(y,this._viewProjMatrix,y),f.tileMercatorCoords=[0,0,1,1];const w=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],E=c.ba();return c.N(E,y,w),f.fallbackMatrix=E,f.mainMatrix=E,f}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function uo(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Nr(b){if(b.useSlerp)if(b.k<1){const e=c.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),o=c.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),f=new Float64Array(4);c.bc(f,e,o,b.k);const y=c.bd(f);b.tr.setRoll(y.roll),b.tr.setPitch(y.pitch),b.tr.setBearing(y.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function Lr(b,e,o,f,y){const w=y.padding,E=re(y.worldSize,o.getNorthWest()),k=re(y.worldSize,o.getNorthEast()),I=re(y.worldSize,o.getSouthEast()),O=re(y.worldSize,o.getSouthWest()),j=c.ae(-f),Z=E.rotate(j),U=k.rotate(j),Y=I.rotate(j),Q=O.rotate(j),le=new c.P(Math.max(Z.x,U.x,Q.x,Y.x),Math.max(Z.y,U.y,Q.y,Y.y)),oe=new c.P(Math.min(Z.x,U.x,Q.x,Y.x),Math.min(Z.y,U.y,Q.y,Y.y)),ue=le.sub(oe),de=(y.width-(w.left+w.right+e.left+e.right))/ue.x,_e=(y.height-(w.top+w.bottom+e.top+e.bottom))/ue.y;if(_e<0||de<0)return void uo();const fe=Math.min(c.ak(y.scale*Math.min(de,_e)),b.maxZoom),be=c.P.convert(b.offset),Se=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ae(f)),ge=be.add(Se).mult(y.scale/c.af(fe));return{center:ye(y.worldSize,E.add(I).div(2).sub(ge)),zoom:fe,bearing:f}}class Vi{get useGlobeControls(){return!1}handlePanInertia(e,o){const f=e.mag(),y=Math.abs(Te(o));return{easingOffset:e.mult(Math.min(.75*y/f,1)),easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(e,o){e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta),e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta)}handleMapControlsPan(e,o,f){e.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(f,e.around)}cameraForBoxAndBearing(e,o,f,y,w){return Lr(e,o,f,y,w)}handleJumpToCenterZoom(e,o){e.zoom!==(o.zoom!==void 0?+o.zoom:e.zoom)&&e.setZoom(+o.zoom),o.center!==void 0&&e.setCenter(c.S.convert(o.center))}handleEaseTo(e,o){const f=e.zoom,y=e.padding,w={roll:e.roll,pitch:e.pitch,bearing:e.bearing},E={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},k=o.zoom!==void 0,I=!e.isPaddingEqual(o.padding);let O=!1;const j=k?+o.zoom:e.zoom;let Z=e.centerPoint.add(o.offsetAsPoint);const U=e.screenPointToLocation(Z),{center:Y,zoom:Q}=e.getConstrained(c.S.convert(o.center||U),j??f);Zc(e,Y);const le=re(e.worldSize,U),oe=re(e.worldSize,Y).sub(le),ue=c.af(Q-f);return O=Q!==f,{easeFunc:de=>{if(O&&e.setZoom(c.C.number(f,Q,de)),c.be(w,E)||Nr({startEulerAngles:w,endEulerAngles:E,tr:e,k:de,useSlerp:w.roll!=E.roll}),I&&(e.interpolatePadding(y,o.padding,de),Z=e.centerPoint.add(o.offsetAsPoint)),o.around)e.setLocationAtPoint(o.around,o.aroundPoint);else{const _e=c.af(e.zoom-f),fe=Q>f?Math.min(2,ue):Math.max(.5,ue),be=Math.pow(fe,1-de),Se=ye(e.worldSize,le.add(oe.mult(de*be)).mult(_e));e.setLocationAtPoint(e.renderWorldCopies?Se.wrap():Se,Z)}},isZooming:O,elevationCenter:Y}}handleFlyTo(e,o){const f=o.zoom!==void 0,y=e.zoom,w=e.getConstrained(c.S.convert(o.center||o.locationAtOffset),f?+o.zoom:y),E=w.center,k=w.zoom;Zc(e,E);const I=re(e.worldSize,o.locationAtOffset),O=re(e.worldSize,E).sub(I),j=O.mag(),Z=c.af(k-y);let U;if(o.minZoom!==void 0){const Y=Math.min(+o.minZoom,y,k),Q=e.getConstrained(E,Y).zoom;U=c.af(Q-y)}return{easeFunc:(Y,Q,le,oe)=>{e.setZoom(Y===1?k:y+c.ak(Q));const ue=Y===1?E:ye(e.worldSize,I.add(O.mult(le)).mult(Q));e.setLocationAtPoint(e.renderWorldCopies?ue.wrap():ue,oe)},scaleOfZoom:Z,targetCenter:E,scaleOfMinZoom:U,pixelPathLength:j}}}class ci{constructor(e,o,f){this.blendFunction=e,this.blendColor=o,this.mask=f}}ci.Replace=[1,0],ci.disabled=new ci(ci.Replace,c.bf.transparent,[!1,!1,!1,!1]),ci.unblended=new ci(ci.Replace,c.bf.transparent,[!0,!0,!0,!0]),ci.alphaBlended=new ci([1,771],c.bf.transparent,[!0,!0,!0,!0]);const ho=2305;class Ht{constructor(e,o,f){this.enable=e,this.mode=o,this.frontFace=f}}Ht.disabled=new Ht(!1,1029,ho),Ht.backCCW=new Ht(!0,1029,ho),Ht.frontCCW=new Ht(!0,1028,ho);class rn{constructor(e,o,f){this.func=e,this.mask=o,this.range=f}}rn.ReadOnly=!1,rn.ReadWrite=!0,rn.disabled=new rn(519,rn.ReadOnly,[0,1]);const es=7680;class Mn{constructor(e,o,f,y,w,E){this.test=e,this.ref=o,this.mask=f,this.fail=y,this.depthFail=w,this.pass=E}}Mn.disabled=new Mn({func:519,mask:0},0,0,es,es,es);const gi=new WeakMap;function Wr(b){var e;if(gi.has(b))return gi.get(b);{const o=(e=b.getParameter(b.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return gi.set(b,o),o}}class La{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const o=e.context,f=o.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const y=new c.aL;y.emplaceBack(-1,-1),y.emplaceBack(2,-1),y.emplaceBack(-1,2);const w=new c.aN;w.emplaceBack(0,1,2),this._fullscreenTriangle=new ul(o.createVertexBuffer(y,co.members),o.createIndexBuffer(w),c.aM.simpleSegment(0,0,y.length,w.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(f.TEXTURE1);const E=f.createTexture();f.bindTexture(f.TEXTURE_2D,E),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),Wr(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,o){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,o=e.gl;e.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,o){const f=this._cachedRenderContext.context,y=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,y.TRIANGLES,rn.disabled,Mn.disabled,ci.unblended,Ht.disabled,((w,E)=>({u_input:w,u_output_expected:E}))(e,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Wr(y)){y.bindBuffer(y.PIXEL_PACK_BUFFER,this._pbo),y.readBuffer(y.COLOR_ATTACHMENT0),y.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),y.bindBuffer(y.PIXEL_PACK_BUFFER,null);const w=y.fenceSync(y.SYNC_GPU_COMMANDS_COMPLETE,0);y.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Wr(e)){const o=e.clientWaitSync(this._readbackQueue.sync,0,0);if(o===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=La._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let o=0;return o+=e[0]/256,o+=e[1]/65536,o+=e[2]/16777216,e[3]<127&&(o=-o),o/128}}const hl=c.$/128;function Sf(b,e){const o=b.granularity!==void 0?Math.max(b.granularity,1):1,f=o+(b.generateBorders?2:0),y=o+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=f+1,E=y+1,k=b.generateBorders?-1:0,I=b.generateBorders||b.extendToNorthPole?-1:0,O=o+(b.generateBorders?1:0),j=o+(b.generateBorders||b.extendToSouthPole?1:0),Z=w*E,U=f*y*6,Y=w*E>65536;if(Y&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Q=Y||e==="32bit",le=new Int16Array(2*Z);let oe=0;for(let _e=I;_e<=j;_e++)for(let fe=k;fe<=O;fe++){let be=fe/o*c.$;fe===-1&&(be=-hl),fe===o+1&&(be=c.$+hl);let Se=_e/o*c.$;_e===-1&&(Se=b.extendToNorthPole?c.bh:-hl),_e===o+1&&(Se=b.extendToSouthPole?c.bi:c.$+hl),le[oe++]=be,le[oe++]=Se}const ue=Q?new Uint32Array(U):new Uint16Array(U);let de=0;for(let _e=0;_e<y;_e++)for(let fe=0;fe<f;fe++){const be=fe+1+_e*w,Se=fe+(_e+1)*w,ge=fe+1+(_e+1)*w;ue[de++]=fe+_e*w,ue[de++]=Se,ue[de++]=be,ue[de++]=be,ue[de++]=Se,ue[de++]=ge}return{vertices:le.buffer.slice(0),indices:ue.buffer.slice(0),uses32bitIndices:Q}}const dl=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class nc{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ss.projectionGlobe}get vertexShaderPreludeCode(){return Ss.projectionMercator.vertexSource}get subdivisionGranularity(){return dl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new La(e));const o=c.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,y=this._errorMeasurement.updateErrorLoop(o,f),w=V.now();y!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=y,this._errorMeasurementLastChangeTime=w);const E=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(E))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,o,f,y,w){const E=(w==="stencil"?dl.stencil:dl.tile).getGranularityForZoomLevel(o.z);return this._getMesh(e,{granularity:E,generateBorders:f,extendToNorthPole:o.y===0&&y,extendToSouthPole:o.y===(1<<o.z)-1&&y})}_getMesh(e,o){const f=this._getMeshKey(o);if(f in this._tileMeshCache)return this._tileMeshCache[f];const y=function(w,E){const k=Sf(E,"16bit"),I=c.aL.deserialize({arrayBuffer:k.vertices,length:k.vertices.byteLength/2/2}),O=c.aN.deserialize({arrayBuffer:k.indices,length:k.indices.byteLength/2/3});return new ul(w.createVertexBuffer(I,co.members),w.createIndexBuffer(O),c.aM.simpleSegment(0,0,I.length,O.length))}(e,o);return this._tileMeshCache[f]=y,y}recalculate(e){}hasTransition(){const e=V.now();let o=!1;return o=o||(e-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const fl=new c.r({type:new c.D(c.v.projection.type)});class ic extends c.E{constructor(e){super(),this._transitionable=new c.t(fl),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new yn,this._verticalPerspectiveProjection=new nc}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,o,f,y,w){return this.currentProjection.getMeshFromTileID(e,o,f,y,w)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Xu(b){const e=$c(b.worldSize,b.center.lat);return 2*Math.PI*e}function Es(b,e,o,f,y){const w=1/(1<<y),E=e/c.$*w+f*w,k=c.bo((b/c.$*w+o*w)*Math.PI*2+Math.PI,2*Math.PI),I=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,O=Math.cos(I),j=new Float64Array(3);return j[0]=Math.sin(k)*O,j[1]=Math.sin(I),j[2]=Math.cos(k)*O,j}function Mr(b){return function(e,o){const f=Math.cos(o),y=new Float64Array(3);return y[0]=Math.sin(e)*f,y[1]=Math.sin(o),y[2]=Math.cos(e)*f,y}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function $c(b,e){return b/(2*Math.PI)/Math.cos(e*Math.PI/180)}function rc(b){const e=Math.asin(b[1])/Math.PI*180,o=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(o>1e-6){const f=b[0]/o,y=Math.acos(b[2]/o),w=(f>0?y:-y)/Math.PI*180;return new c.S(c.aO(w,-180,180),e)}return new c.S(0,e)}function ac(b){return Math.cos(b*Math.PI/180)}function Yi(b,e){const o=ac(b),f=ac(e);return c.ak(f/o)}function Yp(b,e){const o=b.rotate(e.bearingInRadians),f=e.zoom+Yi(e.center.lat,0),y=c.bk(1/ac(e.center.lat),1/ac(Math.min(Math.abs(e.center.lat),60)),c.bn(f,7,3,0,1)),w=360/Xu({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-o.x*w*y,c.ah(e.center.lat+o.y*w,-c.ai,c.ai))}function Wu(b){const e=.5*b,o=Math.sin(e),f=Math.cos(e);return Math.log(o+f)-Math.log(f-o)}function Ef(b,e,o,f){const y=b.lat+o*f;if(Math.abs(o)>1){const w=(Math.sign(b.lat+o)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,E=Math.abs(b.lat+o)*Math.PI/180,k=Wu(w+f*(E-w)),I=Wu(w),O=Wu(E);return new c.S(b.lng+e*((k-I)/(O-I)),y)}return new c.S(b.lng+e*f,y)}class qp{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,o,f,y){const w=`${e.z}_${e.x}_${e.y}_${y?.terrain?"t":""}`,E=this._cache.get(w);if(E)return E;const k=this._cachePrevious.get(w);if(k)return this._cache.set(w,k),k;const I=this._boundingVolumeFactory(e,o,f,y);return this._cache.set(w,I),this._hadAnyChanges=!0,I}}class Yc{constructor(e,o,f,y){this.min=f,this.max=y,this.points=e,this.planes=o}static fromAabb(e,o){const f=[];for(let y=0;y<8;y++)f.push([1&~y?e[0]:o[0],(y>>1&1)==1?o[1]:e[1],(y>>2&1)==1?o[2]:e[2]]);return new Yc(f,[[-1,0,0,o[0]],[1,0,0,-e[0]],[0,-1,0,o[1]],[0,1,0,-e[1]],[0,0,-1,o[2]],[0,0,1,-e[2]]],e,o)}static fromCenterSizeAngles(e,o,f){const y=c.br([],f[0],f[1],f[2]),w=c.bs([],[o[0],0,0],y),E=c.bs([],[0,o[1],0],y),k=c.bs([],[0,0,o[2]],y),I=[...e],O=[...e];for(let Z=0;Z<8;Z++)for(let U=0;U<3;U++){const Y=e[U]+w[U]*(1&~Z?-1:1)+E[U]*((Z>>1&1)==1?1:-1)+k[U]*((Z>>2&1)==1?1:-1);I[U]=Math.min(I[U],Y),O[U]=Math.max(O[U],Y)}const j=[];for(let Z=0;Z<8;Z++){const U=[...e];c.aS(U,U,c.aR([],w,1&~Z?-1:1)),c.aS(U,U,c.aR([],E,(Z>>1&1)==1?1:-1)),c.aS(U,U,c.aR([],k,(Z>>2&1)==1?1:-1)),j.push(U)}return new Yc(j,[[...w,-c.aX(w,j[0])],[...E,-c.aX(E,j[0])],[...k,-c.aX(k,j[0])],[-w[0],-w[1],-w[2],-c.aX(w,j[7])],[-E[0],-E[1],-E[2],-c.aX(E,j[7])],[-k[0],-k[1],-k[2],-c.aX(k,j[7])]],I,O)}intersectsFrustum(e){let o=!0;const f=this.points.length,y=this.planes.length,w=e.planes.length,E=e.points.length;for(let k=0;k<w;k++){const I=e.planes[k];let O=0;for(let j=0;j<f;j++){const Z=this.points[j];I[0]*Z[0]+I[1]*Z[1]+I[2]*Z[2]+I[3]>=0&&O++}if(O===0)return 0;O<f&&(o=!1)}if(o)return 2;for(let k=0;k<y;k++){const I=this.planes[k];let O=0;for(let j=0;j<E;j++){const Z=e.points[j];I[0]*Z[0]+I[1]*Z[1]+I[2]*Z[2]+I[3]>=0&&O++}if(O===0)return 0}return 1}intersectsPlane(e){const o=this.points.length;let f=0;for(let y=0;y<o;y++){const w=this.points[y];e[0]*w[0]+e[1]*w[1]+e[2]*w[2]+e[3]>=0&&f++}return f===o?2:f===0?0:1}}function Or(b,e,o){const f=b-e;return f<0?-f:Math.max(0,f-o)}function Qu(b,e,o,f,y){const w=b-o;let E;return E=w<0?Math.min(-w,1+w-y):w>1?Math.min(Math.max(w-y,0),1-w):0,Math.max(E,Or(e,f,y))}class fo{constructor(){this._boundingVolumeCache=new qp(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,o,f,y){const w=1<<f.z,E=1/w,k=f.x/w,I=f.y/w;let O=2;return O=Math.min(O,Qu(e,o,k,I,E)),O=Math.min(O,Qu(e,o,k+.5,-I-E,E)),O=Math.min(O,Qu(e,o,k+.5,2-I-E,E)),O}getWrap(e,o,f){const y=1<<o.z,w=1/y,E=o.x/y,k=Or(e.x,E,w),I=Or(e.x,E-1,w),O=Or(e.x,E+1,w),j=Math.min(k,I,O);return j===O?1:j===I?-1:0}allowVariableZoom(e,o){return Lt(e,o)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,o,f,y){return this._boundingVolumeCache.getTileBoundingVolume(e,o,f,y)}_computeTileBoundingVolume(e,o,f,y){var w,E;let k=0,I=0;if(y?.terrain){const O=new c.Z(e.z,o,e.z,e.x,e.y),j=y.terrain.getMinMaxElevation(O);k=(w=j.minElevation)!==null&&w!==void 0?w:Math.min(0,f),I=(E=j.maxElevation)!==null&&E!==void 0?E:Math.max(0,f)}if(k/=c.bu,I/=c.bu,k+=1,I+=1,e.z<=0)return Yc.fromAabb([-I,-I,-I],[I,I,I]);if(e.z===1)return Yc.fromAabb([e.x===0?-I:0,e.y===0?0:-I,-I],[e.x===0?0:I,e.y===0?I:0,I]);{const O=[Es(0,0,e.x,e.y,e.z),Es(c.$,0,e.x,e.y,e.z),Es(c.$,c.$,e.x,e.y,e.z),Es(0,c.$,e.x,e.y,e.z)],j=[];for(const je of O)j.push(c.aR([],je,I));if(I!==k)for(const je of O)j.push(c.aR([],je,k));e.y===0&&j.push([0,1,0]),e.y===(1<<e.z)-1&&j.push([0,-1,0]);const Z=[1,1,1],U=[-1,-1,-1];for(const je of j)for(let $e=0;$e<3;$e++)Z[$e]=Math.min(Z[$e],je[$e]),U[$e]=Math.max(U[$e],je[$e]);const Y=Es(c.$/2,c.$/2,e.x,e.y,e.z),Q=c.aW([],[0,1,0],Y);c.aV(Q,Q);const le=c.aW([],Y,Q);c.aV(le,le);const oe=c.aW([],O[2],O[1]);c.aV(oe,oe);const ue=c.aW([],O[0],O[3]);c.aV(ue,ue),j.push(c.aR([],Y,I)),e.y>=(1<<e.z)/2&&j.push(c.aR([],Es(c.$/2,0,e.x,e.y,e.z),I)),e.y<(1<<e.z)/2&&j.push(c.aR([],Es(c.$/2,c.$,e.x,e.y,e.z),I));const de=sc(Y,j),_e=sc(le,j),fe=[-Y[0],-Y[1],-Y[2],de.max],be=[Y[0],Y[1],Y[2],-de.min],Se=[-le[0],-le[1],-le[2],_e.max],ge=[le[0],le[1],le[2],-_e.min],ke=[...oe,0],He=[...ue,0],Oe=[];return e.y===0?Oe.push(c.bt(He,ke,fe),c.bt(He,ke,be)):Oe.push(c.bt(Se,ke,fe),c.bt(Se,ke,be),c.bt(Se,He,fe),c.bt(Se,He,be)),e.y===(1<<e.z)-1?Oe.push(c.bt(He,ke,fe),c.bt(He,ke,be)):Oe.push(c.bt(ge,ke,fe),c.bt(ge,ke,be),c.bt(ge,He,fe),c.bt(ge,He,be)),new Yc(Oe,[fe,be,Se,ge,ke,He],Z,U)}}}function sc(b,e){let o=1/0,f=-1/0;for(const y of e){const w=c.aX(b,y);o=Math.min(o,w),f=Math.max(f,w)}return{min:o,max:f}}class Ku{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o){this._helper.resize(e,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new dr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._coveringTilesDetailsProvider=new fo}clone(){const e=new Ku;return e.apply(this),e}apply(e,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:o,applyGlobeMatrix:f}=e,y=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:y,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const o=this.pitchInRadians,f=this.cameraToCenterDistance/e,y=Math.sin(o)*f,w=Math.cos(o)*f+1,E=1/Math.sqrt(y*y+w*w)*1;let k=-y,I=w;const O=Math.sqrt(k*k+I*I);k/=O,I/=O;const j=[0,k,I];c.bw(j,j,[0,0,0],-this.bearingInRadians),c.bx(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),c.by(j,j,[0,0,0],this.center.lng*Math.PI/180);const Z=1/c.aZ(j);return c.aR(j,j,Z),[...j,-E*Z]}isLocationOccluded(e){return!this.isSurfacePointVisible(Mr(e))}transformLightDirection(e){const o=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,y=Math.cos(f),w=[Math.sin(o)*y,Math.sin(f),Math.cos(o)*y],E=[w[2],0,-w[0]],k=[0,0,0];c.aW(k,E,w),c.aV(E,E),c.aV(k,k);const I=[0,0,0];return c.aV(I,[E[0]*e[0]+k[0]*e[1]+w[0]*e[2],E[1]*e[0]+k[1]*e[1]+w[1]*e[2],E[2]*e[0]+k[2]*e[1]+w[2]*e[2]]),I}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,o,f){const y=function(k,I,O){const j=1/(1<<O.z);return new c.a1(k/c.$*j+O.x*j,I/c.$*j+O.y*j)}(e,o,f.canonical),w=(E=y.y,[c.bo(y.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(e,o,f,y){const w=f.canonical,E=Es(e,o,w.x,w.y,w.z),k=1+(y?y(e,o):0)/c.bu,I=[E[0]*k,E[1]*k,E[2]*k,1];c.aw(I,I,this._globeViewProjMatrixNoCorrection);const O=this._cachedClippingPlane,j=O[0]*E[0]+O[1]*E[1]+O[2]*E[2]+O[3]<0;return{point:new c.P(I[0]/I[3],I[1]/I[3]),signedDistanceFromCamera:I[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=$c(this.worldSize,this.center.lat),o=c.ba(),f=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b4(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const y=this.centerOffset;o[8]=2*-y.x/this._helper._width,o[9]=2*y.y/this._helper._height,this._projectionMatrix=c.b5(o),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,o),c.M(o,o,[0,0,-this.cameraToCenterDistance]),c.b6(o,o,this.rollInRadians),c.b7(o,o,-this.pitchInRadians),c.b6(o,o,this.bearingInRadians),c.M(o,o,[0,0,-e]);const w=c.bp();w[0]=e,w[1]=e,w[2]=e,c.b7(f,o,this.center.lat*Math.PI/180),c.bz(f,f,-this.center.lng*Math.PI/180),c.N(f,f,w),this._globeViewProjMatrixNoCorrection=f,c.b7(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(o,o,-this.center.lng*Math.PI/180),c.N(o,o,w),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const E=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bw(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const k=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(k,k,[1,1,-1]),this._cachedFrustum=ar.fromInvProjectionMatrix(k,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const o=c.ba();return c.ag(o),o}getVisibleUnwrappedCoordinates(e){return[new c.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=Mr(e);c.aR(f,f,1+o/c.bu);const y=c.bv();return c.aw(y,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),y[2]/y[3]}populateCache(e){}getBounds(){const e=.5*this.width,o=.5*this.height,f=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,o),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,o)],y=[];for(const Z of f)y.push(this.unprojectScreenPoint(Z));let w=0,E=0,k=0,I=0;const O=this.center;for(const Z of y){const U=c.bA(O.lng,Z.lng),Y=c.bA(O.lat,Z.lat);U<E&&(E=U),U>w&&(w=U),Y<I&&(I=Y),Y>k&&(k=Y)}const j=[O.lng+E,O.lat+I,O.lng+w,O.lat+k];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new Gn(j)}getConstrained(e,o){const f=c.ah(e.lat,-c.ai,c.ai),y=c.ah(+o,this.minZoom+Yi(0,f),this.maxZoom);return{center:new c.S(e.lng,f),zoom:y}}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}setLocationAtPoint(e,o){const f=Mr(this.unprojectScreenPoint(o)),y=Mr(e),w=c.bp();c.bB(w);const E=c.bp();c.by(E,f,w,-this.center.lng*Math.PI/180),c.bx(E,E,w,this.center.lat*Math.PI/180);const k=y[0]*y[0]+y[2]*y[2],I=E[0]*E[0];if(k<I)return;const O=Math.sqrt(k-I),j=-O,Z=c.bC(y[0],y[2],E[0],O),U=c.bC(y[0],y[2],E[0],j),Y=c.bp();c.by(Y,y,w,-Z);const Q=c.bC(Y[1],Y[2],E[1],E[2]),le=c.bp();c.by(le,y,w,-U);const oe=c.bC(le[1],le[2],E[1],E[2]),ue=.5*Math.PI,de=Q>=-ue&&Q<=ue,_e=oe>=-ue&&oe<=ue;let fe,be;if(de&&_e){const He=this.center.lng*Math.PI/180,Oe=this.center.lat*Math.PI/180;c.bD(Z,He)+c.bD(Q,Oe)<c.bD(U,He)+c.bD(oe,Oe)?(fe=Z,be=Q):(fe=U,be=oe)}else if(de)fe=Z,be=Q;else{if(!_e)return;fe=U,be=oe}const Se=fe/Math.PI*180,ge=be/Math.PI*180,ke=this.center.lat;this.setCenter(new c.S(Se,c.ah(ge,-90,90))),this.setZoom(this.zoom+Yi(ke,this.center.lat))}locationToScreenPoint(e,o){const f=Mr(e);if(o){const y=o.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aR(f,f,1+y/c.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(e){const o=c.bv();return c.aw(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new c.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,o){if(o){const f=o.pointCoordinate(e);if(f)return f}return c.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,o){var f;return(f=this.screenPointToMercatorCoordinate(e,o))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(e,o){const f=this._cameraPosition,y=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(f,y)}getRayDirectionFromPixel(e){const o=c.bv();o[0]=e.x/this.width*2-1,o[1]=-1*(e.y/this.height*2-1),o[2]=1,o[3]=1,c.aw(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const f=c.bp();f[0]=o[0]-this._cameraPosition[0],f[1]=o[1]-this._cameraPosition[1],f[2]=o[2]-this._cameraPosition[2];const y=c.bp();return c.aV(y,f),y}isSurfacePointVisible(e){const o=this._cachedClippingPlane;return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const o=c.bv();return c.aw(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(e,o){const f=c.aX(e,o),y=c.bp(),w=c.bp();c.aR(w,o,f),c.aU(y,e,w);const E=1-c.aX(y,y);if(E<0)return null;const k=c.aX(e,e)-1,I=-f+(f<0?1:-1)*Math.sqrt(E),O=k/I,j=I;return{tMin:Math.min(O,j),tMax:Math.max(O,j)}}unprojectScreenPoint(e){const o=this._cameraPosition,f=this.getRayDirectionFromPixel(e),y=this.rayPlanetIntersection(o,f);if(y){const j=c.bp();c.aS(j,o,[f[0]*y.tMin,f[1]*y.tMin,f[2]*y.tMin]);const Z=c.bp();return c.aV(Z,j),rc(Z)}const w=this._cachedClippingPlane,E=w[0]*f[0]+w[1]*f[1]+w[2]*f[2],k=-c.b1(w,o)/E,I=c.bp();if(k>0)c.aS(I,o,[f[0]*k,f[1]*k,f[2]*k]);else{const j=c.bp();c.aS(j,o,[2*f[0],2*f[1],2*f[2]]);const Z=c.b1(this._cachedClippingPlane,j);c.aU(I,j,[this._cachedClippingPlane[0]*Z,this._cachedClippingPlane[1]*Z,this._cachedClippingPlane[2]*Z])}const O=function(j){const Z=c.bp();return Z[0]=j[0]*-j[3],Z[1]=j[1]*-j[3],Z[2]=j[2]*-j[3],{center:Z,radius:Math.sqrt(1-j[3]*j[3])}}(w);return rc(function(j,Z,U){const Y=c.bp();c.aU(Y,U,j);const Q=c.bp();return c.bq(Q,j,Y,Z/c.a$(Y)),Q}(O.center,O.radius,I))}getMatrixForModel(e,o){const f=c.S.convert(e),y=1/c.bu,w=c.b9();return c.bz(w,w,f.lng/180*Math.PI),c.b7(w,w,-f.lat/180*Math.PI),c.M(w,w,[0,0,1+o/c.bu]),c.b7(w,w,.5*Math.PI),c.N(w,w,[y,y,y]),w}getProjectionDataForCustomLayer(e=!0){const o=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(e){}}class Ju{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,f=!0){this._helper.resize(e,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,o){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new dr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._globeness=1,this._mercatorTransform=new Fn,this._verticalPerspectiveTransform=new Ku}clone(){const e=new Ju;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const o=this._mercatorTransform.getProjectionData(e),f=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:o.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,o,f){const y=this._mercatorTransform.getPitchedTextCorrection(e,o,f),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,o,f);return c.bk(y,w,this._globeness)}projectTileCoordinates(e,o,f,y){return this.currentTransform.projectTileCoordinates(e,o,f,y)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){return this.currentTransform.lngLatToCameraDepth(e,o)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,o){return this.currentTransform.getConstrained(e,o)}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}setLocationAtPoint(e,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,o){return this.currentTransform.locationToScreenPoint(e,o)}screenPointToMercatorCoordinate(e,o){return this.currentTransform.screenPointToMercatorCoordinate(e,o)}screenPointToLocation(e,o){return this.currentTransform.screenPointToLocation(e,o)}isPointOnMapSurface(e,o){return this.currentTransform.isPointOnMapSurface(e,o)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,o){return this.currentTransform.getMatrixForModel(e,o)}getProjectionDataForCustomLayer(e=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return o;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return f.fallbackMatrix=o.mainMatrix,f}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Qr{get useGlobeControls(){return!0}handlePanInertia(e,o){const f=Yp(e,o);return Math.abs(f.lng-o.center.lng)>180&&(f.lng=o.center.lng+179.5*Math.sign(f.lng-o.center.lng)),{easingCenter:f,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,o){const f=e.around,y=o.screenPointToLocation(f);e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta);const w=o.zoom;e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta);const E=o.zoom-w;if(E===0)return;const k=c.bA(o.center.lng,y.lng),I=k/(Math.abs(k/180)+1),O=c.bA(o.center.lat,y.lat),j=o.getRayDirectionFromPixel(f),Z=o.cameraPosition,U=-1*c.aX(Z,j),Y=c.bp();c.aS(Y,Z,[j[0]*U,j[1]*U,j[2]*U]);const Q=c.aZ(Y)-1,le=Math.exp(.5*-Math.max(Q-.3,0)),oe=$c(o.worldSize,o.center.lat)/Math.min(o.width,o.height),ue=c.bn(oe,.9,.5,1,.25),de=(1-c.af(-E))*Math.min(le,ue),_e=o.center.lat,fe=o.zoom,be=new c.S(o.center.lng+I*de,c.ah(o.center.lat+O*de,-c.ai,c.ai));o.setLocationAtPoint(y,f);const Se=o.center,ge=c.bn(Math.abs(k),45,85,0,1),ke=c.bn(oe,.75,.35,0,1),He=Math.pow(Math.max(ge,ke),.25),Oe=c.bA(Se.lng,be.lng),je=c.bA(Se.lat,be.lat);o.setCenter(new c.S(Se.lng+Oe*He,Se.lat+je*He).wrap()),o.setZoom(fe+Yi(_e,o.center.lat))}handleMapControlsPan(e,o,f){if(!e.panDelta)return;const y=o.center.lat,w=o.zoom;o.setCenter(Yp(e.panDelta,o).wrap()),o.setZoom(w+Yi(y,o.center.lat))}cameraForBoxAndBearing(e,o,f,y,w){const E=Lr(e,o,f,y,w),k=o.left/w.width*2-1,I=(w.width-o.right)/w.width*2-1,O=o.top/w.height*-2+1,j=(w.height-o.bottom)/w.height*-2+1,Z=c.bA(f.getWest(),f.getEast())<0,U=Z?f.getEast():f.getWest(),Y=Z?f.getWest():f.getEast(),Q=Math.max(f.getNorth(),f.getSouth()),le=Math.min(f.getNorth(),f.getSouth()),oe=U+.5*c.bA(U,Y),ue=Q+.5*c.bA(Q,le),de=w.clone();de.setCenter(E.center),de.setBearing(E.bearing),de.setPitch(0),de.setRoll(0),de.setZoom(E.zoom);const _e=de.modelViewProjectionMatrix,fe=[Mr(f.getNorthWest()),Mr(f.getNorthEast()),Mr(f.getSouthWest()),Mr(f.getSouthEast()),Mr(new c.S(Y,ue)),Mr(new c.S(U,ue)),Mr(new c.S(oe,Q)),Mr(new c.S(oe,le))],be=Mr(E.center);let Se=Number.POSITIVE_INFINITY;for(const ge of fe)k<0&&(Se=Qr.getLesserNonNegativeNonNull(Se,Qr.solveVectorScale(ge,be,_e,"x",k))),I>0&&(Se=Qr.getLesserNonNegativeNonNull(Se,Qr.solveVectorScale(ge,be,_e,"x",I))),O>0&&(Se=Qr.getLesserNonNegativeNonNull(Se,Qr.solveVectorScale(ge,be,_e,"y",O))),j<0&&(Se=Qr.getLesserNonNegativeNonNull(Se,Qr.solveVectorScale(ge,be,_e,"y",j)));if(Number.isFinite(Se)&&Se!==0)return E.zoom=de.zoom+c.ak(Se),E;uo()}handleJumpToCenterZoom(e,o){const f=e.center.lat,y=e.getConstrained(o.center?c.S.convert(o.center):e.center,e.zoom).center;e.setCenter(y.wrap());const w=o.zoom!==void 0?+o.zoom:e.zoom+Yi(f,y.lat);e.zoom!==w&&e.setZoom(w)}handleEaseTo(e,o){const f=e.zoom,y=e.center,w=e.padding,E={roll:e.roll,pitch:e.pitch,bearing:e.bearing},k={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},I=o.zoom!==void 0,O=!e.isPaddingEqual(o.padding);let j=!1;const Z=o.center?c.S.convert(o.center):y,U=e.getConstrained(Z,f).center;Zc(e,U);const Y=e.clone();Y.setCenter(U),Y.setZoom(I?+o.zoom:f+Yi(y.lat,Z.lat)),Y.setBearing(o.bearing);const Q=new c.P(c.ah(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));Y.setLocationAtPoint(U,Q);const le=(o.offset&&o.offsetAsPoint.mag())>0?Y.center:U,oe=I?+o.zoom:f+Yi(y.lat,le.lat),ue=f+Yi(y.lat,0),de=oe+Yi(le.lat,0),_e=c.bA(y.lng,le.lng),fe=c.bA(y.lat,le.lat),be=c.af(de-ue);return j=oe!==f,{easeFunc:Se=>{if(c.be(E,k)||Nr({startEulerAngles:E,endEulerAngles:k,tr:e,k:Se,useSlerp:E.roll!=k.roll}),O&&e.interpolatePadding(w,o.padding,Se),o.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(o.around,o.aroundPoint);else{const ge=de>ue?Math.min(2,be):Math.max(.5,be),ke=Math.pow(ge,1-Se),He=Ef(y,_e,fe,Se*ke);e.setCenter(He.wrap())}if(j){const ge=c.C.number(ue,de,Se)+Yi(0,e.center.lat);e.setZoom(ge)}},isZooming:j,elevationCenter:le}}handleFlyTo(e,o){const f=o.zoom!==void 0,y=e.center,w=e.zoom,E=e.padding,k=!e.isPaddingEqual(o.padding),I=e.getConstrained(c.S.convert(o.center||o.locationAtOffset),w).center,O=f?+o.zoom:e.zoom+Yi(e.center.lat,I.lat),j=e.clone();j.setCenter(I),j.setZoom(O),j.setBearing(o.bearing);const Z=new c.P(c.ah(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));j.setLocationAtPoint(I,Z);const U=j.center;Zc(e,U);const Y=function(fe,be,Se){const ge=Mr(be),ke=Mr(Se),He=c.aX(ge,ke),Oe=Math.acos(He),je=Xu(fe);return Oe/(2*Math.PI)*je}(e,y,U),Q=w+Yi(y.lat,0),le=O+Yi(U.lat,0),oe=c.af(le-Q);let ue;if(typeof o.minZoom=="number"){const fe=+o.minZoom+Yi(U.lat,0),be=Math.min(fe,Q,le)+Yi(0,U.lat),Se=e.getConstrained(U,be).zoom+Yi(U.lat,0);ue=c.af(Se-Q)}const de=c.bA(y.lng,U.lng),_e=c.bA(y.lat,U.lat);return{easeFunc:(fe,be,Se,ge)=>{const ke=Ef(y,de,_e,Se);k&&e.interpolatePadding(E,o.padding,fe);const He=fe===1?U:ke;e.setCenter(He.wrap());const Oe=Q+c.ak(be);e.setZoom(fe===1?O:Oe+Yi(0,He.lat))},scaleOfZoom:oe,targetCenter:U,scaleOfMinZoom:ue,pixelPathLength:Y}}static solveVectorScale(e,o,f,y,w){const E=y==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],k=[f[3],f[7],f[11],f[15]],I=e[0]*E[0]+e[1]*E[1]+e[2]*E[2],O=e[0]*k[0]+e[1]*k[1]+e[2]*k[2],j=o[0]*E[0]+o[1]*E[1]+o[2]*E[2],Z=o[0]*k[0]+o[1]*k[1]+o[2]*k[2];return j+w*O===I+w*Z||k[3]*(I-j)+E[3]*(Z-O)+I*Z==j*O?null:(j+E[3]-w*Z-w*k[3])/(j-I-w*Z+w*O)}static getLesserNonNegativeNonNull(e,o){return o!==null&&o>=0&&o<e?o:e}}class Af{constructor(e){this._globe=e,this._mercatorCameraHelper=new Vi,this._verticalPerspectiveCameraHelper=new Qr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,o){return this.currentHelper.handlePanInertia(e,o)}handleMapControlsRollPitchBearingZoom(e,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,o)}handleMapControlsPan(e,o,f){this.currentHelper.handleMapControlsPan(e,o,f)}cameraForBoxAndBearing(e,o,f,y,w){return this.currentHelper.cameraForBoxAndBearing(e,o,f,y,w)}handleJumpToCenterZoom(e,o){this.currentHelper.handleJumpToCenterZoom(e,o)}handleEaseTo(e,o){return this.currentHelper.handleEaseTo(e,o)}handleFlyTo(e,o){return this.currentHelper.handleFlyTo(e,o)}}const yd=(b,e)=>c.y(b,e&&e.filter(o=>o.identifier!=="source.canvas")),Ag=c.bE();class Mf extends c.E{constructor(e,o={}){var f,y;super(),this._rtlPluginLoaded=()=>{for(const E in this.sourceCaches){const k=this.sourceCaches[E].getSource().type;k!=="vector"&&k!=="geojson"||this.sourceCaches[E].reload()}},this.map=e,this.dispatcher=new Bt(Xt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(E,k)=>this.getGlyphs(E,k)),this.dispatcher.registerMessageHandler("GI",(E,k)=>this.getImages(E,k)),this.imageManager=new Pe,this.imageManager.setEventedParent(this);const w=((f=e._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((y=document.documentElement)===null||y===void 0?void 0:y.lang)||void 0;this.glyphManager=new jt(e._requestManager,o.localIdeographFontFamily,w),this.lineAtlas=new kt(256,512),this.crossTileSymbolIndex=new ec,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),Bi().on(ws,this._rtlPluginLoaded),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const k=this.sourceCaches[E.sourceId];if(!k)return;const I=k.getSource();if(I&&I.vectorLayerIds)for(const O in this._layers){const j=this._layers[O];j.source===I.id&&this._validateLayer(j)}})}setGlobalStateProperty(e,o){var f,y,w;this._checkLoaded();const E=o===null?(w=(y=(f=this.stylesheet.state)===null||f===void 0?void 0:f[e])===null||y===void 0?void 0:y.default)!==null&&w!==void 0?w:null:o;if(c.bH(E,this._globalState[e]))return this;this._globalState[e]=E,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const o=[];for(const f in e)!c.bH(this._globalState[f],e[f].default)&&(o.push(f),this._globalState[f]=e[f].default);this._applyGlobalStateChanges(o)}_applyGlobalStateChanges(e){if(e.length===0)return;const o=new Set;for(const f in this._layers){const y=this._layers[f],w=y.getLayoutAffectingGlobalStateRefs(),E=y.getPaintAffectingGlobalStateRefs();for(const k of e)if(w.has(k)&&o.add(y.source),E.has(k))for(const{name:I,value:O}of E.get(k))this._updatePaintProperty(y,I,O)}for(const f in this.sourceCaches)o.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(e,o={},f){this.fire(new c.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const y=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;c.j(y,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,o,f)}).catch(E=>{this._loadStyleRequest=null,E&&!w.signal.aborted&&this.fire(new c.k(E))})}loadJSON(e,o={},f){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,V.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(e,o,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Ag,{validate:!1})}_load(e,o,f){var y,w;let E=o.transformStyle?o.transformStyle(f,e):e;if(!o.validate||!yd(this,c.z(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const k in E.sources)this.addSource(k,E.sources[k],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new Ge(this.stylesheet.light),this._setProjectionInternal(((y=this.stylesheet.projection)===null||y===void 0?void 0:y.type)||"mercator"),this.sky=new ht(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var e;const o=c.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(f=>f.id),this._layers={},this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this._serializedLayers=null;for(const f of o){const y=c.bJ(f);y.setEventedParent(this,{layer:{id:f.id}}),y.setGlobalState(this._globalState),this._layers[f.id]=y}}_loadSprite(e,o=!1,f=void 0){let y;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,E,k,I){return c._(this,void 0,void 0,function*(){const O=Ke(w),j=k>1?"@2x":"",Z={},U={};for(const{id:Y,url:Q}of O){const le=E.transformRequest(mt(Q,j,".json"),"SpriteJSON");Z[Y]=c.j(le,I);const oe=E.transformRequest(mt(Q,j,".png"),"SpriteImage");U[Y]=qe.getImage(oe,I)}return yield Promise.all([...Object.values(Z),...Object.values(U)]),function(Y,Q){return c._(this,void 0,void 0,function*(){const le={};for(const oe in Y){le[oe]={};const ue=V.getImageCanvasContext((yield Q[oe]).data),de=(yield Y[oe]).data;for(const _e in de){const{width:fe,height:be,x:Se,y:ge,sdf:ke,pixelRatio:He,stretchX:Oe,stretchY:je,content:$e,textFitWidth:yt,textFitHeight:vt}=de[_e];le[oe][_e]={data:null,pixelRatio:He,sdf:ke,stretchX:Oe,stretchY:je,content:$e,textFitWidth:yt,textFitHeight:vt,spriteData:{width:fe,height:be,x:Se,y:ge,context:ue}}}}return le})}(Z,U)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const E in w){this._spritesImagesIds[E]=[];const k=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(I=>!(I in w)):[];for(const I of k)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in w[E]){const O=E==="default"?I:`${E}:${I}`;this._spritesImagesIds[E].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,w[E][I],!1):this.imageManager.addImage(O,w[E][I]),o&&(this._changedImages[O]=!0)}}}).catch(w=>{this._spriteRequest=null,y=w,this.fire(new c.k(y))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),f&&f(y)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const o=this.sourceCaches[e.source];if(!o)return;const f=e.sourceLayer;if(!f)return;const y=o.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.k(new Error(`Source layer "${f}" does not exist on source "${y.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,o=!1){const f=this._serializedAllLayers();if(!e||e.length===0)return Object.values(o?c.bK(f):f);const y=[];for(const w of e)if(f[w]){const E=o?c.bK(f[w]):f[w];y.push(E)}return y}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const o=Object.keys(this._layers);for(const f of o){const y=this._layers[f];y.type!=="custom"&&(e[f]=y.serialize())}return e}hasTransitions(){var e,o,f;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const y in this.sourceCaches)if(this.sourceCaches[y].hasTransition())return!0;for(const y in this._layers)if(this._layers[y].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const o=this._changed;if(o){const y=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(y.length||w.length)&&this._updateWorkerLayers(y,w);for(const E in this._updatedSources){const k=this._updatedSources[E];if(k==="reload")this._reloadSource(E);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const f={};for(const y in this.sourceCaches){const w=this.sourceCaches[y];f[y]=w.used,w.used=!1}for(const y of this._order){const w=this._layers[y];w.recalculate(e,this._availableImages),!w.isHidden(e.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const y in f){const w=this.sourceCaches[y];!!f[y]!=!!w.used&&w.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,o&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,o={}){var f;this._checkLoaded();const y=this.serialize();if(e=o.transformStyle?o.transformStyle(y,e):e,((f=o.validate)===null||f===void 0||f)&&yd(this,c.z(e)))return!1;(e=c.bK(e)).layers=c.bI(e.layers);const w=c.bL(y,e),E=this._getOperationsToPerform(w);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const k of E.operations)k();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const o=[],f=[];for(const y of e)switch(y.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,y.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,y.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,y.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,y.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,y.args));break;case"addSource":o.push(()=>this.addSource.apply(this,y.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,y.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,y.args));break;case"setLight":o.push(()=>this.setLight.apply(this,y.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,y.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,y.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,y.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,y.args));break;case"setSky":o.push(()=>this.setSky.apply(this,y.args));break;case"setProjection":this.setProjection.apply(this,y.args);break;case"setGlobalState":o.push(()=>this.setGlobalState.apply(this,y.args));break;case"setTransition":o.push(()=>{});break;default:f.push(y.command)}return{operations:o,unimplemented:f}}addImage(e,o){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,o),this._afterImageUpdated(e)}updateImage(e,o){this.imageManager.updateImage(e,o)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,o,f={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(c.z.source,`sources.${e}`,o,null,f))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const y=this.sourceCaches[e]=new bn(e,o,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:e})),y.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${f}" is using it.`)));const o=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],o.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,o){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const f=this.sourceCaches[e].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(o),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,o,f={}){this._checkLoaded();const y=e.id;if(this.getLayer(y))return void this.fire(new c.k(new Error(`Layer "${y}" already exists on this map.`)));let w;if(e.type==="custom"){if(yd(this,c.bM(e)))return;w=c.bJ(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(y,e.source),e=c.bK(e),e=c.e(e,{source:y})),this._validate(c.z.layer,`layers.${y}`,e,{arrayIndex:-1},f))return;w=c.bJ(e),this._validateLayer(w),w.setEventedParent(this,{layer:{id:y}})}const E=o?this._order.indexOf(o):this._order.length;if(o&&E===-1)this.fire(new c.k(new Error(`Cannot add layer "${y}" before non-existing layer "${o}".`)));else{if(this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=w,this._removedLayers[y]&&w.source&&w.type!=="custom"){const k=this._removedLayers[y];delete this._removedLayers[y],k.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(e,o){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===o)return;const f=this._order.indexOf(e);this._order.splice(f,1);const y=o?this._order.indexOf(o):this._order.length;o&&y===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${o}".`))):(this._order.splice(y,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const o=this._layers[e];if(!o)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));o.setEventedParent(null);const f=this._order.indexOf(e);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=o,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],o.onRemove&&o.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,o,f){this._checkLoaded();const y=this.getLayer(e);y?y.minzoom===o&&y.maxzoom===f||(o!=null&&(y.minzoom=o),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,o,f={}){this._checkLoaded();const y=this.getLayer(e);if(y){if(!c.bH(y.filter,o))return o==null?(y.setFilter(void 0),void this._updateLayer(y)):void(this._validate(c.z.filter,`layers.${y.id}.filter`,o,null,f)||(y.setFilter(c.bK(o)),this._updateLayer(y)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bK(this.getLayer(e).filter)}setLayoutProperty(e,o,f,y={}){this._checkLoaded();const w=this.getLayer(e);w?c.bH(w.getLayoutProperty(o),f)||(w.setLayoutProperty(o,f,y),this._updateLayer(w)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,o){const f=this.getLayer(e);if(f)return f.getLayoutProperty(o);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,o,f,y={}){this._checkLoaded();const w=this.getLayer(e);w?c.bH(w.getPaintProperty(o),f)||this._updatePaintProperty(w,o,f,y):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,o,f,y={}){e.setPaintProperty(o,f,y)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,o){return this.getLayer(e).getPaintProperty(o)}setFeatureState(e,o){this._checkLoaded();const f=e.source,y=e.sourceLayer,w=this.sourceCaches[f];if(w===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const E=w.getSource().type;E==="geojson"&&y?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||y?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(y,e.id,o)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,o){this._checkLoaded();const f=e.source,y=this.sourceCaches[f];if(y===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const w=y.getSource().type,E=w==="vector"?e.sourceLayer:void 0;w!=="vector"||E?o&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(E,e.id,o):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const o=e.source,f=e.sourceLayer,y=this.sourceCaches[o];if(y!==void 0)return y.getSource().type!=="vector"||f?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bN(this.sourceCaches,w=>w.serialize()),o=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,y=this.stylesheet;return c.bO({version:y.version,name:y.name,metadata:y.metadata,light:y.light,sky:y.sky,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,projection:y.projection,sources:e,layers:o,terrain:f},w=>w!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const o=E=>this._layers[E].type==="fill-extrusion",f={},y=[];for(let E=this._order.length-1;E>=0;E--){const k=this._order[E];if(o(k)){f[k]=E;for(const I of e){const O=I[k];if(O)for(const j of O)y.push(j)}}}y.sort((E,k)=>k.intersectionZ-E.intersectionZ);const w=[];for(let E=this._order.length-1;E>=0;E--){const k=this._order[E];if(o(k))for(let I=y.length-1;I>=0;I--){const O=y[I].feature;if(f[O.layer.id]<E)break;w.push(O),y.pop()}else for(const I of e){const O=I[k];if(O)for(const j of O)w.push(j.feature)}}return w}queryRenderedFeatures(e,o,f){o&&o.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",o.filter,null,o);const y={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const O of o.layers){const j=this._layers[O];if(!j)return this.fire(new c.k(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];y[j.source]=!0}}const w=[];o.availableImages=this._availableImages;const E=this._serializedAllLayers(),k=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,I=Object.assign(Object.assign({},o),{layers:k});for(const O in this.sourceCaches)o.layers&&!y[O]||w.push(mi(this.sourceCaches[O],this._layers,E,e,I,f,this.map.terrain?(j,Z,U)=>this.map.terrain.getElevation(j,Z,U):void 0));return this.placement&&w.push(function(O,j,Z,U,Y,Q,le){const oe={},ue=Q.queryRenderedSymbols(U),de=[];for(const _e of Object.keys(ue).map(Number))de.push(le[_e]);de.sort(Ea);for(const _e of de){const fe=_e.featureIndex.lookupSymbolFeatures(ue[_e.bucketInstanceId],j,_e.bucketIndex,_e.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,O);for(const be in fe){const Se=oe[be]=oe[be]||[],ge=fe[be];ge.sort((ke,He)=>{const Oe=_e.featureSortOrder;if(Oe){const je=Oe.indexOf(ke.featureIndex);return Oe.indexOf(He.featureIndex)-je}return He.featureIndex-ke.featureIndex});for(const ke of ge)Se.push(ke)}}return function(_e,fe,be){for(const Se in _e)for(const ge of _e[Se])ua(ge,be[fe[Se].source]);return _e}(oe,O,Z)}(this._layers,E,this.sourceCaches,e,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(e,o){o&&o.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",o.filter,null,o);const f=this.sourceCaches[e];return f?function(y,w){const E=y.getRenderableIds().map(O=>y.getTileByID(O)),k=[],I={};for(let O=0;O<E.length;O++){const j=E[O],Z=j.tileID.canonical.key;I[Z]||(I[Z]=!0,j.querySourceFeatures(k,w))}return k}(f,o):[]}getLight(){return this.light.getLight()}setLight(e,o={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const E in e)if(!c.bH(e[E],f[E])){y=!0;break}if(!y)return;const w={now:V.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,o),this.light.updateTransitions(w)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,o={}){this._checkLoaded();const f=this.getSky();let y=!1;if(!e&&!f)return;if(e&&!f)y=!0;else if(!e&&f)y=!0;else for(const E in e)if(!c.bH(e[E],f[E])){y=!0;break}if(!y)return;const w={now:V.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,o),this.sky.updateTransitions(w)}_setProjectionInternal(e){const o=function(f){if(Array.isArray(f)){const y=new ic({type:f});return{projection:y,transform:new Ju,cameraHelper:new Af(y)}}switch(f){case"mercator":return{projection:new yn,transform:new Fn,cameraHelper:new Vi};case"globe":{const y=new ic({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:y,transform:new Ju,cameraHelper:new Af(y)}}case"vertical-perspective":return{projection:new nc,transform:new Ku,cameraHelper:new Qr};default:return c.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new yn,transform:new Fn,cameraHelper:new Vi}}}(e);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(e,o,f,y,w={}){return(!w||w.validate!==!1)&&yd(this,e.call(c.z,c.e({key:o,style:this.serialize(),value:f,styleSpec:c.v},y)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Bi().off(ws,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const f=this.sourceCaches[o];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const o in this.sourceCaches)this.sourceCaches[o].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,o,f,y,w=!1){let E=!1,k=!1;const I={};for(const O of this._order){const j=this._layers[O];if(j.type!=="symbol")continue;if(!I[j.source]){const U=this.sourceCaches[j.source];I[j.source]=U.getRenderableIds(!0).map(Y=>U.getTileByID(Y)).sort((Y,Q)=>Q.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(Q.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(j,I[j.source],e.center.lng);E=E||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(V.now(),e.zoom))&&(this.pauseablePlacement=new qu(e,this.map.terrain,this._order,w,o,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(V.now()),k=!0),E&&this.pauseablePlacement.placement.setStale()),k||E)for(const O of this._order){const j=this._layers[O];j.type==="symbol"&&this.placement.updateLayerOpacities(j,I[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(V.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,o){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const y=this.sourceCaches[o.source];return y&&y.setDependencies(o.tileID.key,o.type,o.icons),f})}getGlyphs(e,o){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(o.stacks),y=this.sourceCaches[o.source];return y&&y.setDependencies(o.tileID.key,o.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,o={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,o,f={},y){this._checkLoaded();const w=[{id:e,url:o}],E=[...Ke(this.stylesheet.sprite),...w];this._validate(c.z.sprite,"sprite",E,null,f)||(this.stylesheet.sprite=E,this._loadSprite(w,!0,y))}removeSprite(e){this._checkLoaded();const o=Ke(this.stylesheet.sprite);if(o.find(f=>f.id===e)){if(this._spritesImagesIds[e])for(const f of this._spritesImagesIds[e])this.imageManager.removeImage(f),this._changedImages[f]=!0;o.splice(o.findIndex(f=>f.id===e),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ke(this.stylesheet.sprite)}setSprite(e,o={},f){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,o)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,f):(this._unloadSprite(),f&&f(null)))}}var Mg=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Cg{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,o,f,y,w,E,k,I,O){this.context=e;let j=this.boundPaintVertexBuffers.length!==y.length;for(let Z=0;!j&&Z<y.length;Z++)this.boundPaintVertexBuffers[Z]!==y[Z]&&(j=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==f||j||this.boundIndexBuffer!==w||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==O?this.freshBind(o,f,y,w,E,k,I,O):(e.bindVertexArray.set(this.vao),k&&k.bind(),w&&w.dynamicDraw&&w.bind(),I&&I.bind(),O&&O.bind())}freshBind(e,o,f,y,w,E,k,I){const O=e.numAttributes,j=this.context,Z=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=I,o.enableAttributes(Z,e);for(const U of f)U.enableAttributes(Z,e);E&&E.enableAttributes(Z,e),k&&k.enableAttributes(Z,e),I&&I.enableAttributes(Z,e),o.bind(),o.setVertexAttribPointers(Z,e,w);for(const U of f)U.bind(),U.setVertexAttribPointers(Z,e,w);E&&(E.bind(),E.setVertexAttribPointers(Z,e,w)),y&&y.bind(),k&&(k.bind(),k.setVertexAttribPointers(Z,e,w)),I&&(I.bind(),I.setVertexAttribPointers(Z,e,w)),j.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const _d=(b,e,o,f,y)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:e,u_fog_color:o?o.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:y?0:o?o.calculateFogBlendOpacity(f):0,u_horizon_color:o?o.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:y?1:0}),Cf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function oc(b){const e=[];for(let o=0;o<b.length;o++){if(b[o]===null)continue;const f=b[o].split(" ");e.push(f.pop())}return e}class Df{constructor(e,o,f,y,w,E,k,I,O=[]){const j=e.gl;this.program=j.createProgram();const Z=oc(o.staticAttributes),U=f?f.getBinderAttributes():[],Y=Z.concat(U),Q=Ss.prelude.staticUniforms?oc(Ss.prelude.staticUniforms):[],le=k.staticUniforms?oc(k.staticUniforms):[],oe=o.staticUniforms?oc(o.staticUniforms):[],ue=f?f.getBinderUniforms():[],de=Q.concat(le).concat(oe).concat(ue),_e=[];for(const Oe of de)_e.indexOf(Oe)<0&&_e.push(Oe);const fe=f?f.defines():[];Wr(j)&&fe.unshift("#version 300 es"),w&&fe.push("#define OVERDRAW_INSPECTOR;"),E&&fe.push("#define TERRAIN3D;"),I&&fe.push(I),O&&fe.push(...O);let be=fe.concat(Ss.prelude.fragmentSource,k.fragmentSource,o.fragmentSource).join(`
`),Se=fe.concat(Ss.prelude.vertexSource,k.vertexSource,o.vertexSource).join(`
`);Wr(j)||(be=function(Oe){return Oe.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(be),Se=function(Oe){return Oe.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Se));const ge=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(ge,be),j.compileShader(ge),!j.getShaderParameter(ge,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(ge)}`);j.attachShader(this.program,ge);const ke=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(ke,Se),j.compileShader(ke),!j.getShaderParameter(ke,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(ke)}`);j.attachShader(this.program,ke),this.attributes={};const He={};this.numAttributes=Y.length;for(let Oe=0;Oe<this.numAttributes;Oe++)Y[Oe]&&(j.bindAttribLocation(this.program,Oe,Y[Oe]),this.attributes[Y[Oe]]=Oe);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(ke),j.deleteShader(ge);for(let Oe=0;Oe<_e.length;Oe++){const je=_e[Oe];if(je&&!He[je]){const $e=j.getUniformLocation(this.program,je);$e&&(He[je]=$e)}}this.fixedUniforms=y(e,He),this.terrainUniforms=((Oe,je)=>({u_depth:new c.bP(Oe,je.u_depth),u_terrain:new c.bP(Oe,je.u_terrain),u_terrain_dim:new c.bg(Oe,je.u_terrain_dim),u_terrain_matrix:new c.bR(Oe,je.u_terrain_matrix),u_terrain_unpack:new c.bS(Oe,je.u_terrain_unpack),u_terrain_exaggeration:new c.bg(Oe,je.u_terrain_exaggeration)}))(e,He),this.projectionUniforms=((Oe,je)=>({u_projection_matrix:new c.bR(Oe,je.u_projection_matrix),u_projection_tile_mercator_coords:new c.bS(Oe,je.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bS(Oe,je.u_projection_clipping_plane),u_projection_transition:new c.bg(Oe,je.u_projection_transition),u_projection_fallback_matrix:new c.bR(Oe,je.u_projection_fallback_matrix)}))(e,He),this.binderUniforms=f?f.getUniforms(e,He):[]}draw(e,o,f,y,w,E,k,I,O,j,Z,U,Y,Q,le,oe,ue,de,_e){const fe=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(f),e.setStencilMode(y),e.setColorMode(w),e.setCullFace(E),I){e.activeTexture.set(fe.TEXTURE2),fe.bindTexture(fe.TEXTURE_2D,I.depthTexture),e.activeTexture.set(fe.TEXTURE3),fe.bindTexture(fe.TEXTURE_2D,I.texture);for(const Se in this.terrainUniforms)this.terrainUniforms[Se].set(I[Se])}if(O)for(const Se in O)this.projectionUniforms[Cf[Se]].set(O[Se]);if(k)for(const Se in this.fixedUniforms)this.fixedUniforms[Se].set(k[Se]);oe&&oe.setUniforms(e,this.binderUniforms,Q,{zoom:le});let be=0;switch(o){case fe.LINES:be=2;break;case fe.TRIANGLES:be=3;break;case fe.LINE_STRIP:be=1}for(const Se of Y.get()){const ge=Se.vaos||(Se.vaos={});(ge[j]||(ge[j]=new Cg)).bind(e,this,Z,oe?oe.getPaintVertexBuffers():[],U,Se.vertexOffset,ue,de,_e),fe.drawElements(o,Se.primitiveLength*be,fe.UNSIGNED_SHORT,Se.primitiveOffset*be*2)}}}function qc(b,e,o){const f=1/c.aC(o,1,e.transform.tileZoom),y=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,e.transform.tileZoom)/y,E=w*(o.tileID.canonical.x+o.tileID.wrap*y),k=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[f,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[E>>16,k>>16],u_pixel_coord_lower:[65535&E,65535&k]}}const fa=(b,e,o,f)=>{const y=b.style.light,w=y.properties.get("position"),E=[w.x,w.y,w.z],k=c.bV();y.properties.get("anchor")==="viewport"&&c.bW(k,b.transform.bearingInRadians),c.bX(E,E,k);const I=b.transform.transformLightDirection(E),O=y.properties.get("color");return{u_lightpos:E,u_lightpos_globe:I,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+e,u_opacity:o,u_fill_translate:f}},Dg=(b,e,o,f,y,w,E)=>c.e(fa(b,e,o,f),qc(w,b,E),{u_height_factor:-Math.pow(2,y.overscaledZ)/E.tileSize/8}),eh=(b,e,o,f)=>c.e(qc(e,b,o),{u_fill_translate:f}),Hc=(b,e)=>({u_world:b,u_fill_translate:e}),Xc=(b,e,o,f,y)=>c.e(eh(b,e,o,y),{u_world:f}),Hp=(b,e,o,f,y)=>{const w=b.transform;let E,k,I=0;if(o.paint.get("circle-pitch-alignment")==="map"){const O=c.aC(e,1,w.zoom);E=!0,k=[O,O],I=O/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*y}else E=!1,k=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:k,u_globe_extrude_scale:I,u_translate:f}},th=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),Wc=b=>({u_viewport_size:[b.width,b.height]}),lc=(b,e=1)=>({u_color:b,u_overlay:0,u_overlay_scale:e}),Xp=(b,e,o,f)=>{const y=c.aC(b,1,e)/(c.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:c.aC(b,1,e),u_intensity:o,u_globe_extrude_scale:y}},kf=(b,e,o,f)=>{const y=c.L();c.bY(y,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:y,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:o,u_color_ramp:f,u_opacity:e.paint.get("heatmap-opacity")}},Wp=(b,e,o)=>{const f=o.paint.get("hillshade-accent-color");let y;switch(o.paint.get("hillshade-method")){case"basic":y=4;break;case"combined":y=1;break;case"igor":y=2;break;case"multidirectional":y=3;break;default:y=0}const w=o.getIlluminationProperties();for(let E=0;E<w.directionRadians.length;E++)o.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[E]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:cc(0,e.tileID),u_exaggeration:o.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:f,u_method:y,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},If=(b,e)=>{const o=e.stride,f=c.L();return c.bY(f,0,c.$,-c.$,0,0,1),c.M(f,f,[0,-c.$,0]),{u_matrix:f,u_image:1,u_dimension:[o,o],u_zoom:b.overscaledZ,u_unpack:e.getUnpackVector()}};function cc(b,e){const o=Math.pow(2,e.canonical.z),f=e.canonical.y;return[new c.a1(0,f/o).toLngLat().lat,new c.a1(0,(f+1)/o).toLngLat().lat]}const Qc=(b,e,o=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:o,u_opacity:b.paint.get("color-relief-opacity")}),vd=(b,e,o,f)=>{const y=b.transform;return{u_translation:rh(b,e,o),u_ratio:f/c.aC(e,1,y.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},nh=(b,e,o,f,y)=>c.e(vd(b,e,o,f),{u_image:0,u_image_height:y}),Rf=(b,e,o,f,y)=>{const w=b.transform,E=ih(e,w);return{u_translation:rh(b,e,o),u_texsize:e.imageAtlasTexture.size,u_ratio:f/c.aC(e,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[E,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},pl=(b,e,o,f,y,w)=>{const E=b.lineAtlas,k=ih(e,b.transform),I=o.layout.get("line-cap")==="round",O=E.getDash(y.from,I),j=E.getDash(y.to,I),Z=O.width*w.fromScale,U=j.width*w.toScale;return c.e(vd(b,e,o,f),{u_patternscale_a:[k/Z,-O.height/2],u_patternscale_b:[k/U,-j.height/2],u_sdfgamma:E.width/(256*Math.min(Z,U)*b.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:j.y,u_mix:w.t})};function ih(b,e){return 1/c.aC(b,1,e.tileZoom)}function rh(b,e,o){return c.aD(b.transform,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Kc=(b,e,o,f,y)=>{return{u_tl_parent:b,u_scale_parent:e,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(E=f.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=f.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Qp(f.paint.get("raster-hue-rotate")),u_coords_top:[y[0].x,y[0].y,y[1].x,y[1].y],u_coords_bottom:[y[3].x,y[3].y,y[2].x,y[2].y]};var w,E};function Qp(b){b*=Math.PI/180;const e=Math.sin(b),o=Math.cos(b);return[(2*o+1)/3,(-Math.sqrt(3)*e-o+1)/3,(Math.sqrt(3)*e-o+1)/3]}const Jc=(b,e,o,f,y,w,E,k,I,O,j,Z,U)=>{const Y=E.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Y.width/Y.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:k,u_coord_matrix:I,u_is_text:+j,u_pitch_with_map:+f,u_is_along_line:y,u_is_variable_anchor:w,u_texsize:Z,u_texture:0,u_translation:O,u_pitched_scale:U}},Kp=(b,e,o,f,y,w,E,k,I,O,j,Z,U,Y)=>{const Q=E.transform;return c.e(Jc(b,e,o,f,y,w,E,k,I,O,j,Z,Y),{u_gamma_scale:f?Math.cos(Q.pitch*Math.PI/180)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},kg=(b,e,o,f,y,w,E,k,I,O,j,Z,U)=>c.e(Kp(b,e,o,f,y,w,E,k,I,O,!0,j,0,U),{u_texsize_icon:Z,u_texture_icon:1}),Jp=(b,e)=>({u_opacity:b,u_color:e}),em=(b,e,o,f,y)=>c.e(function(w,E,k,I){const O=k.imageManager.getPattern(w.from.toString()),j=k.imageManager.getPattern(w.to.toString()),{width:Z,height:U}=k.imageManager.getPixelSize(),Y=Math.pow(2,I.tileID.overscaledZ),Q=I.tileSize*Math.pow(2,k.transform.tileZoom)/Y,le=Q*(I.tileID.canonical.x+I.tileID.wrap*Y),oe=Q*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[Z,U],u_mix:E.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/c.aC(I,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,oe>>16],u_pixel_coord_lower:[65535&le,65535&oe]}}(o,y,e,f),{u_opacity:b}),Pf=(b,e)=>{},pa={fillExtrusion:(b,e)=>({u_lightpos:new c.bT(b,e.u_lightpos),u_lightpos_globe:new c.bT(b,e.u_lightpos_globe),u_lightintensity:new c.bg(b,e.u_lightintensity),u_lightcolor:new c.bT(b,e.u_lightcolor),u_vertical_gradient:new c.bg(b,e.u_vertical_gradient),u_opacity:new c.bg(b,e.u_opacity),u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillExtrusionPattern:(b,e)=>({u_lightpos:new c.bT(b,e.u_lightpos),u_lightpos_globe:new c.bT(b,e.u_lightpos_globe),u_lightintensity:new c.bg(b,e.u_lightintensity),u_lightcolor:new c.bT(b,e.u_lightcolor),u_vertical_gradient:new c.bg(b,e.u_vertical_gradient),u_height_factor:new c.bg(b,e.u_height_factor),u_opacity:new c.bg(b,e.u_opacity),u_fill_translate:new c.bU(b,e.u_fill_translate),u_image:new c.bP(b,e.u_image),u_texsize:new c.bU(b,e.u_texsize),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade)}),fill:(b,e)=>({u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillPattern:(b,e)=>({u_image:new c.bP(b,e.u_image),u_texsize:new c.bU(b,e.u_texsize),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade),u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillOutline:(b,e)=>({u_world:new c.bU(b,e.u_world),u_fill_translate:new c.bU(b,e.u_fill_translate)}),fillOutlinePattern:(b,e)=>({u_world:new c.bU(b,e.u_world),u_image:new c.bP(b,e.u_image),u_texsize:new c.bU(b,e.u_texsize),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade),u_fill_translate:new c.bU(b,e.u_fill_translate)}),circle:(b,e)=>({u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_scale_with_map:new c.bP(b,e.u_scale_with_map),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_extrude_scale:new c.bU(b,e.u_extrude_scale),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(b,e.u_globe_extrude_scale),u_translate:new c.bU(b,e.u_translate)}),collisionBox:(b,e)=>({u_pixel_extrude_scale:new c.bU(b,e.u_pixel_extrude_scale)}),collisionCircle:(b,e)=>({u_viewport_size:new c.bU(b,e.u_viewport_size)}),debug:(b,e)=>({u_color:new c.bQ(b,e.u_color),u_overlay:new c.bP(b,e.u_overlay),u_overlay_scale:new c.bg(b,e.u_overlay_scale)}),depth:Pf,clippingMask:Pf,heatmap:(b,e)=>({u_extrude_scale:new c.bg(b,e.u_extrude_scale),u_intensity:new c.bg(b,e.u_intensity),u_globe_extrude_scale:new c.bg(b,e.u_globe_extrude_scale)}),heatmapTexture:(b,e)=>({u_matrix:new c.bR(b,e.u_matrix),u_world:new c.bU(b,e.u_world),u_image:new c.bP(b,e.u_image),u_color_ramp:new c.bP(b,e.u_color_ramp),u_opacity:new c.bg(b,e.u_opacity)}),hillshade:(b,e)=>({u_image:new c.bP(b,e.u_image),u_latrange:new c.bU(b,e.u_latrange),u_exaggeration:new c.bg(b,e.u_exaggeration),u_altitudes:new c.b_(b,e.u_altitudes),u_azimuths:new c.b_(b,e.u_azimuths),u_accent:new c.bQ(b,e.u_accent),u_method:new c.bP(b,e.u_method),u_shadows:new c.bZ(b,e.u_shadows),u_highlights:new c.bZ(b,e.u_highlights)}),hillshadePrepare:(b,e)=>({u_matrix:new c.bR(b,e.u_matrix),u_image:new c.bP(b,e.u_image),u_dimension:new c.bU(b,e.u_dimension),u_zoom:new c.bg(b,e.u_zoom),u_unpack:new c.bS(b,e.u_unpack)}),colorRelief:(b,e)=>({u_image:new c.bP(b,e.u_image),u_unpack:new c.bS(b,e.u_unpack),u_dimension:new c.bU(b,e.u_dimension),u_elevation_stops:new c.bP(b,e.u_elevation_stops),u_color_stops:new c.bP(b,e.u_color_stops),u_color_ramp_size:new c.bP(b,e.u_color_ramp_size),u_opacity:new c.bg(b,e.u_opacity)}),line:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels)}),lineGradient:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels),u_image:new c.bP(b,e.u_image),u_image_height:new c.bg(b,e.u_image_height)}),linePattern:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_texsize:new c.bU(b,e.u_texsize),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_image:new c.bP(b,e.u_image),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels),u_scale:new c.bT(b,e.u_scale),u_fade:new c.bg(b,e.u_fade)}),lineSDF:(b,e)=>({u_translation:new c.bU(b,e.u_translation),u_ratio:new c.bg(b,e.u_ratio),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(b,e.u_units_to_pixels),u_patternscale_a:new c.bU(b,e.u_patternscale_a),u_patternscale_b:new c.bU(b,e.u_patternscale_b),u_sdfgamma:new c.bg(b,e.u_sdfgamma),u_image:new c.bP(b,e.u_image),u_tex_y_a:new c.bg(b,e.u_tex_y_a),u_tex_y_b:new c.bg(b,e.u_tex_y_b),u_mix:new c.bg(b,e.u_mix)}),raster:(b,e)=>({u_tl_parent:new c.bU(b,e.u_tl_parent),u_scale_parent:new c.bg(b,e.u_scale_parent),u_buffer_scale:new c.bg(b,e.u_buffer_scale),u_fade_t:new c.bg(b,e.u_fade_t),u_opacity:new c.bg(b,e.u_opacity),u_image0:new c.bP(b,e.u_image0),u_image1:new c.bP(b,e.u_image1),u_brightness_low:new c.bg(b,e.u_brightness_low),u_brightness_high:new c.bg(b,e.u_brightness_high),u_saturation_factor:new c.bg(b,e.u_saturation_factor),u_contrast_factor:new c.bg(b,e.u_contrast_factor),u_spin_weights:new c.bT(b,e.u_spin_weights),u_coords_top:new c.bS(b,e.u_coords_top),u_coords_bottom:new c.bS(b,e.u_coords_bottom)}),symbolIcon:(b,e)=>({u_is_size_zoom_constant:new c.bP(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(b,e.u_is_size_feature_constant),u_size_t:new c.bg(b,e.u_size_t),u_size:new c.bg(b,e.u_size),u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_pitch:new c.bg(b,e.u_pitch),u_rotate_symbol:new c.bP(b,e.u_rotate_symbol),u_aspect_ratio:new c.bg(b,e.u_aspect_ratio),u_fade_change:new c.bg(b,e.u_fade_change),u_label_plane_matrix:new c.bR(b,e.u_label_plane_matrix),u_coord_matrix:new c.bR(b,e.u_coord_matrix),u_is_text:new c.bP(b,e.u_is_text),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_is_along_line:new c.bP(b,e.u_is_along_line),u_is_variable_anchor:new c.bP(b,e.u_is_variable_anchor),u_texsize:new c.bU(b,e.u_texsize),u_texture:new c.bP(b,e.u_texture),u_translation:new c.bU(b,e.u_translation),u_pitched_scale:new c.bg(b,e.u_pitched_scale)}),symbolSDF:(b,e)=>({u_is_size_zoom_constant:new c.bP(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(b,e.u_is_size_feature_constant),u_size_t:new c.bg(b,e.u_size_t),u_size:new c.bg(b,e.u_size),u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_pitch:new c.bg(b,e.u_pitch),u_rotate_symbol:new c.bP(b,e.u_rotate_symbol),u_aspect_ratio:new c.bg(b,e.u_aspect_ratio),u_fade_change:new c.bg(b,e.u_fade_change),u_label_plane_matrix:new c.bR(b,e.u_label_plane_matrix),u_coord_matrix:new c.bR(b,e.u_coord_matrix),u_is_text:new c.bP(b,e.u_is_text),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_is_along_line:new c.bP(b,e.u_is_along_line),u_is_variable_anchor:new c.bP(b,e.u_is_variable_anchor),u_texsize:new c.bU(b,e.u_texsize),u_texture:new c.bP(b,e.u_texture),u_gamma_scale:new c.bg(b,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_is_halo:new c.bP(b,e.u_is_halo),u_translation:new c.bU(b,e.u_translation),u_pitched_scale:new c.bg(b,e.u_pitched_scale)}),symbolTextAndIcon:(b,e)=>({u_is_size_zoom_constant:new c.bP(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(b,e.u_is_size_feature_constant),u_size_t:new c.bg(b,e.u_size_t),u_size:new c.bg(b,e.u_size),u_camera_to_center_distance:new c.bg(b,e.u_camera_to_center_distance),u_pitch:new c.bg(b,e.u_pitch),u_rotate_symbol:new c.bP(b,e.u_rotate_symbol),u_aspect_ratio:new c.bg(b,e.u_aspect_ratio),u_fade_change:new c.bg(b,e.u_fade_change),u_label_plane_matrix:new c.bR(b,e.u_label_plane_matrix),u_coord_matrix:new c.bR(b,e.u_coord_matrix),u_is_text:new c.bP(b,e.u_is_text),u_pitch_with_map:new c.bP(b,e.u_pitch_with_map),u_is_along_line:new c.bP(b,e.u_is_along_line),u_is_variable_anchor:new c.bP(b,e.u_is_variable_anchor),u_texsize:new c.bU(b,e.u_texsize),u_texsize_icon:new c.bU(b,e.u_texsize_icon),u_texture:new c.bP(b,e.u_texture),u_texture_icon:new c.bP(b,e.u_texture_icon),u_gamma_scale:new c.bg(b,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(b,e.u_device_pixel_ratio),u_is_halo:new c.bP(b,e.u_is_halo),u_translation:new c.bU(b,e.u_translation),u_pitched_scale:new c.bg(b,e.u_pitched_scale)}),background:(b,e)=>({u_opacity:new c.bg(b,e.u_opacity),u_color:new c.bQ(b,e.u_color)}),backgroundPattern:(b,e)=>({u_opacity:new c.bg(b,e.u_opacity),u_image:new c.bP(b,e.u_image),u_pattern_tl_a:new c.bU(b,e.u_pattern_tl_a),u_pattern_br_a:new c.bU(b,e.u_pattern_br_a),u_pattern_tl_b:new c.bU(b,e.u_pattern_tl_b),u_pattern_br_b:new c.bU(b,e.u_pattern_br_b),u_texsize:new c.bU(b,e.u_texsize),u_mix:new c.bg(b,e.u_mix),u_pattern_size_a:new c.bU(b,e.u_pattern_size_a),u_pattern_size_b:new c.bU(b,e.u_pattern_size_b),u_scale_a:new c.bg(b,e.u_scale_a),u_scale_b:new c.bg(b,e.u_scale_b),u_pixel_coord_upper:new c.bU(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(b,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(b,e.u_tile_units_to_pixels)}),terrain:(b,e)=>({u_texture:new c.bP(b,e.u_texture),u_ele_delta:new c.bg(b,e.u_ele_delta),u_fog_matrix:new c.bR(b,e.u_fog_matrix),u_fog_color:new c.bQ(b,e.u_fog_color),u_fog_ground_blend:new c.bg(b,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(b,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bQ(b,e.u_horizon_color),u_horizon_fog_blend:new c.bg(b,e.u_horizon_fog_blend),u_is_globe_mode:new c.bg(b,e.u_is_globe_mode)}),terrainDepth:(b,e)=>({u_ele_delta:new c.bg(b,e.u_ele_delta)}),terrainCoords:(b,e)=>({u_texture:new c.bP(b,e.u_texture),u_terrain_coords_id:new c.bg(b,e.u_terrain_coords_id),u_ele_delta:new c.bg(b,e.u_ele_delta)}),projectionErrorMeasurement:(b,e)=>({u_input:new c.bg(b,e.u_input),u_output_expected:new c.bg(b,e.u_output_expected)}),atmosphere:(b,e)=>({u_sun_pos:new c.bT(b,e.u_sun_pos),u_atmosphere_blend:new c.bg(b,e.u_atmosphere_blend),u_globe_position:new c.bT(b,e.u_globe_position),u_globe_radius:new c.bg(b,e.u_globe_radius),u_inv_proj_matrix:new c.bR(b,e.u_inv_proj_matrix)}),sky:(b,e)=>({u_sky_color:new c.bQ(b,e.u_sky_color),u_horizon_color:new c.bQ(b,e.u_horizon_color),u_horizon:new c.bU(b,e.u_horizon),u_horizon_normal:new c.bU(b,e.u_horizon_normal),u_sky_horizon_blend:new c.bg(b,e.u_sky_horizon_blend),u_sky_blend:new c.bg(b,e.u_sky_blend)})};class eu{constructor(e,o,f){this.context=e;const y=e.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ah={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class po{constructor(e,o,f,y){this.length=o.length,this.attributes=f,this.itemSize=o.bytesPerElement,this.dynamicDraw=y,this.context=e;const w=e.gl;this.buffer=w.createBuffer(),e.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,o){for(let f=0;f<this.attributes.length;f++){const y=o.attributes[this.attributes[f].name];y!==void 0&&e.enableVertexAttribArray(y)}}setVertexAttribPointers(e,o,f){for(let y=0;y<this.attributes.length;y++){const w=this.attributes[y],E=o.attributes[w.name];E!==void 0&&e.vertexAttribPointer(E,w.components,e[ah[w.type]],!1,this.itemSize,w.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Pn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bd extends Pn{getDefault(){return c.bf.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class sh extends Pn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class tm extends Pn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class ml extends Pn{getDefault(){return[!0,!0,!0,!0]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class No extends Pn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class uc extends Pn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class zf extends Pn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const o=this.current;(e.func!==o.func||e.ref!==o.ref||e.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class nm extends Pn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class hc extends Pn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=e,this.dirty=!1}}class tu extends Pn{getDefault(){return[0,1]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class xd extends Pn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=e,this.dirty=!1}}class im extends Pn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class gl extends Pn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.BLEND):o.disable(o.BLEND),this.current=e,this.dirty=!1}}class oh extends Pn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class lh extends Pn{getDefault(){return c.bf.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ch extends Pn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Nf extends Pn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=e,this.dirty=!1}}class dc extends Pn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class uh extends Pn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class fc extends Pn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Oa extends Pn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class wd extends Pn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ts extends Pn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Td extends Pn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Cr extends Pn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ma extends Pn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Lo extends Pn{getDefault(){return null}set(e){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class pc extends Pn{getDefault(){return null}set(e){var o;if(e===this.current&&!this.dirty)return;const f=this.gl;Wr(f)?f.bindVertexArray(e):(o=f.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class mc extends Pn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class hh extends Pn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class yl extends Pn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ja extends Pn{constructor(e,o){super(e),this.context=e,this.parent=o}getDefault(){return null}}class Lf extends ja{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class nu extends ja{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class gn extends ja{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const dh="Framebuffer is not complete";class Ba{constructor(e,o,f,y,w){this.context=e,this.width=o,this.height=f;const E=e.gl,k=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Lf(e,k),y)this.depthAttachment=w?new gn(e,k):new nu(e,k);else if(w)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(dh)}destroy(){const e=this.context.gl,o=this.colorAttachment.get();if(o&&e.deleteTexture(o),this.depthAttachment){const f=this.depthAttachment.get();f&&e.deleteRenderbuffer(f)}e.deleteFramebuffer(this.framebuffer)}}class Sd{constructor(e){var o,f;if(this.gl=e,this.clearColor=new bd(this),this.clearDepth=new sh(this),this.clearStencil=new tm(this),this.colorMask=new ml(this),this.depthMask=new No(this),this.stencilMask=new uc(this),this.stencilFunc=new zf(this),this.stencilOp=new nm(this),this.stencilTest=new hc(this),this.depthRange=new tu(this),this.depthTest=new xd(this),this.depthFunc=new im(this),this.blend=new gl(this),this.blendFunc=new oh(this),this.blendColor=new lh(this),this.blendEquation=new ch(this),this.cullFace=new Nf(this),this.cullFaceSide=new dc(this),this.frontFace=new uh(this),this.program=new fc(this),this.activeTexture=new Oa(this),this.viewport=new wd(this),this.bindFramebuffer=new ts(this),this.bindRenderbuffer=new Td(this),this.bindTexture=new Cr(this),this.bindVertexBuffer=new ma(this),this.bindElementBuffer=new Lo(this),this.bindVertexArray=new pc(this),this.pixelStoreUnpack=new mc(this),this.pixelStoreUnpackPremultiplyAlpha=new hh(this),this.pixelStoreUnpackFlipY=new yl(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Wr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const y=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=e.RGBA16F)!==null&&o!==void 0?o:y?.RGBA16F_EXT,this.RGB16F=(f=e.RGB16F)!==null&&f!==void 0?f:y?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const y=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=y?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,o){return new eu(this,e,o)}createVertexBuffer(e,o,f){return new po(this,e,o,f)}createRenderbuffer(e,o,f){const y=this.gl,w=y.createRenderbuffer();return this.bindRenderbuffer.set(w),y.renderbufferStorage(y.RENDERBUFFER,e,o,f),this.bindRenderbuffer.set(null),w}createFramebuffer(e,o,f,y){return new Ba(this,e,o,f,y)}clear({color:e,depth:o,stencil:f}){const y=this.gl;let w=0;e&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),f!==void 0&&(w|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),y.clear(w)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bH(e.blendFunction,ci.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Wr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var o;return Wr(this.gl)?this.gl.deleteVertexArray(e):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Kr;function Of(b,e,o,f,y){const w=b.context,E=b.transform,k=w.gl,I=b.useProgram("collisionBox"),O=[];let j=0,Z=0;for(let ue=0;ue<f.length;ue++){const de=f[ue],_e=e.getTile(de).getBucket(o);if(!_e)continue;const fe=y?_e.textCollisionBox:_e.iconCollisionBox,be=_e.collisionCircleArray;be.length>0&&(O.push({circleArray:be,circleOffset:Z,coord:de}),j+=be.length/4,Z=j),fe&&I.draw(w,k.LINES,rn.disabled,Mn.disabled,b.colorModeForRenderPass(),Ht.disabled,th(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(de),E.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,null,b.transform.zoom,null,null,fe.collisionVertexBuffer)}if(!y||!O.length)return;const U=b.useProgram("collisionCircle"),Y=new c.b$;Y.resize(4*j),Y._trim();let Q=0;for(const ue of O)for(let de=0;de<ue.circleArray.length/4;de++){const _e=4*de,fe=ue.circleArray[_e+0],be=ue.circleArray[_e+1],Se=ue.circleArray[_e+2],ge=ue.circleArray[_e+3];Y.emplace(Q++,fe,be,Se,ge,0),Y.emplace(Q++,fe,be,Se,ge,1),Y.emplace(Q++,fe,be,Se,ge,2),Y.emplace(Q++,fe,be,Se,ge,3)}(!Kr||Kr.length<2*j)&&(Kr=function(ue){const de=2*ue,_e=new c.c1;_e.resize(de),_e._trim();for(let fe=0;fe<de;fe++){const be=6*fe;_e.uint16[be+0]=4*fe+0,_e.uint16[be+1]=4*fe+1,_e.uint16[be+2]=4*fe+2,_e.uint16[be+3]=4*fe+2,_e.uint16[be+4]=4*fe+3,_e.uint16[be+5]=4*fe+0}return _e}(j));const le=w.createIndexBuffer(Kr,!0),oe=w.createVertexBuffer(Y,c.c0.members,!0);for(const ue of O){const de=Wc(b.transform);U.draw(w,k.TRIANGLES,rn.disabled,Mn.disabled,b.colorModeForRenderPass(),Ht.disabled,de,b.style.map.terrain&&b.style.map.terrain.getTerrainData(ue.coord),null,o.id,oe,le,c.aM.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,b.transform.zoom,null,null,null)}oe.destroy(),le.destroy()}const Ed=c.ag(new Float32Array(16));function _l(b,e,o,f,y,w){const{horizontalAlign:E,verticalAlign:k}=c.aH(b);return new c.P((-(E-.5)*e/y+f[0])*w,(-(k-.5)*o/y+f[1])*w)}function jf(b,e,o,f,y,w){const E=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let k=f.mult(w);o||(k=k.rotate(-y));const I=E.add(k);return Ai(I.x,I.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(o){const k=rr(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(b),I=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return b.add(f.rotate(I))}return b.add(f)}function fh(b,e,o,f,y,w,E,k,I,O,j,Z){const U=b.text.placedSymbolArray,Y=b.text.dynamicLayoutVertexArray,Q=b.icon.dynamicLayoutVertexArray,le={};Y.clear();for(let oe=0;oe<U.length;oe++){const ue=U.get(oe),de=ue.hidden||!ue.crossTileID||b.allowVerticalPlacement&&!ue.placedOrientation?null:f[ue.crossTileID];if(de){const _e=new c.P(ue.anchorX,ue.anchorY),fe={getElevation:Z,width:y.width,height:y.height,pitchedLabelPlaneMatrix:w,pitchWithMap:o,transform:y,tileAnchorPoint:_e,translation:O,unwrappedTileID:j},be=o?Mi(_e.x,_e.y,fe):rr(_e.x,_e.y,fe),Se=gt(y.cameraToCenterDistance,be.signedDistanceFromCamera);let ge=c.ap(b.textSizeData,k,ue)*Se/c.aB;o&&(ge*=b.tilePixelRatio/E);const{width:ke,height:He,anchor:Oe,textOffset:je,textBoxScale:$e}=de,yt=_l(Oe,ke,He,je,$e,ge),vt=y.getPitchedTextCorrection(_e.x+O[0],_e.y+O[1],j),ot=jf(be.point,fe,e,yt,-y.bearingInRadians,vt),Ot=b.allowVerticalPlacement&&ue.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let fn=0;fn<ue.numGlyphs;fn++)c.av(Y,ot,Ot);I&&ue.associatedIconIndex>=0&&(le[ue.associatedIconIndex]={shiftedAnchor:ot,angle:Ot})}else ao(ue.numGlyphs,Y)}if(I){Q.clear();const oe=b.icon.placedSymbolArray;for(let ue=0;ue<oe.length;ue++){const de=oe.get(ue);if(de.hidden)ao(de.numGlyphs,Q);else{const _e=le[ue];if(_e)for(let fe=0;fe<de.numGlyphs;fe++)c.av(Q,_e.shiftedAnchor,_e.angle);else ao(de.numGlyphs,Q)}}b.icon.dynamicLayoutVertexBuffer.updateData(Q)}b.text.dynamicLayoutVertexBuffer.updateData(Y)}function Oo(b,e,o){return o.iconsInText&&e?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function mo(b,e,o,f,y,w,E,k,I,O,j,Z,U){const Y=b.context,Q=Y.gl,le=b.transform,oe=k==="map",ue=I==="map",de=k!=="viewport"&&o.layout.get("symbol-placement")!=="point",_e=oe&&!ue&&!de,fe=!o.layout.get("symbol-sort-key").isConstant();let be=!1;const Se=b.getDepthModeForSublayer(0,rn.ReadOnly),ge=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ke=[],He=le.getCircleRadiusCorrection();for(const Oe of f){const je=e.getTile(Oe),$e=je.getBucket(o);if(!$e)continue;const yt=y?$e.text:$e.icon;if(!yt||!yt.segments.get().length||!yt.hasVisibleVertices)continue;const vt=yt.programConfigurations.get(o.id),ot=y||$e.sdfIcons,Ot=y?$e.textSizeData:$e.iconSizeData,fn=ue||le.pitch!==0,zn=b.useProgram(Oo(ot,y,$e),vt),Qn=c.an(Ot,le.zoom),Yn=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Oe);let zi,Di,cn,Kn,Xi=[0,0],pr=null;if(y)Di=je.glyphAtlasTexture,cn=Q.LINEAR,zi=je.glyphAtlasTexture.size,$e.iconsInText&&(Xi=je.imageAtlasTexture.size,pr=je.imageAtlasTexture,Kn=fn||b.options.rotating||b.options.zooming||Ot.kind==="composite"||Ot.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const ki=o.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;Di=je.imageAtlasTexture,cn=ot||b.options.rotating||b.options.zooming||ki||fn?Q.LINEAR:Q.NEAREST,zi=je.imageAtlasTexture.size}const br=c.aC(je,1,b.transform.zoom),_a=li(oe,b.transform,br),Rs=c.L();c.aq(Rs,_a);const qo=Wt(ue,oe,b.transform,br),os=c.aD(le,je,w,E),Ml=le.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),Ho=ge&&$e.hasTextData(),Cl=o.layout.get("icon-text-fit")!=="none"&&Ho&&$e.hasIconData();if(de){const ki=b.style.map.terrain?(va,Ni)=>b.style.map.terrain.getElevation(Oe,va,Ni):null,Gi=o.layout.get("text-rotation-alignment")==="map";Fi($e,b,y,_a,Rs,ue,O,Gi,Oe.toUnwrapped(),le.width,le.height,os,ki)}const Dl=y&&ge||Cl,jr=de||Dl?Ed:ue?_a:b.transform.clipSpaceToPixelsMatrix,ls=ot&&o.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let aa;aa=ot?$e.iconsInText?kg(Ot.kind,Qn,_e,ue,de,Dl,b,jr,qo,os,zi,Xi,He):Kp(Ot.kind,Qn,_e,ue,de,Dl,b,jr,qo,os,y,zi,0,He):Jc(Ot.kind,Qn,_e,ue,de,Dl,b,jr,qo,os,y,zi,He);const kl={program:zn,buffers:yt,uniformValues:aa,projectionData:Ml,atlasTexture:Di,atlasTextureIcon:pr,atlasInterpolation:cn,atlasInterpolationIcon:Kn,isSDF:ot,hasHalo:ls};if(fe&&$e.canOverlap){be=!0;const ki=yt.segments.get();for(const Gi of ki)ke.push({segments:new c.aM([Gi]),sortKey:Gi.sortKey,state:kl,terrainData:Yn})}else ke.push({segments:yt.segments,sortKey:0,state:kl,terrainData:Yn})}be&&ke.sort((Oe,je)=>Oe.sortKey-je.sortKey);for(const Oe of ke){const je=Oe.state;if(Y.activeTexture.set(Q.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,Q.CLAMP_TO_EDGE),je.atlasTextureIcon&&(Y.activeTexture.set(Q.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),je.isSDF){const $e=je.uniformValues;je.hasHalo&&($e.u_is_halo=1,vl(je.buffers,Oe.segments,o,b,je.program,Se,j,Z,$e,je.projectionData,Oe.terrainData)),$e.u_is_halo=0}vl(je.buffers,Oe.segments,o,b,je.program,Se,j,Z,je.uniformValues,je.projectionData,Oe.terrainData)}}function vl(b,e,o,f,y,w,E,k,I,O,j){const Z=f.context;y.draw(Z,Z.gl.TRIANGLES,w,E,k,Ht.backCCW,I,j,O,o.id,b.layoutVertexBuffer,b.indexBuffer,e,o.paint,f.transform.zoom,b.programConfigurations.get(o.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function iu(b,e,o,f,y){const w=b.context,E=w.gl,k=Mn.disabled,I=new ci([E.ONE,E.ONE],c.bf.transparent,[!0,!0,!0,!0]),O=e.getBucket(o);if(!O)return;const j=f.key;let Z=o.heatmapFbos.get(j);Z||(Z=Jr(w,e.tileSize,e.tileSize),o.heatmapFbos.set(j,Z)),w.bindFramebuffer.set(Z.framebuffer),w.viewport.set([0,0,e.tileSize,e.tileSize]),w.clear({color:c.bf.transparent});const U=O.programConfigurations.get(o.id),Y=b.useProgram("heatmap",U,!y),Q=b.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),le=b.style.map.terrain.getTerrainData(f);Y.draw(w,E.TRIANGLES,rn.disabled,k,I,Ht.disabled,Xp(e,b.transform.zoom,o.paint.get("heatmap-intensity"),1),le,Q,o.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,o.paint,b.transform.zoom,U)}function Fa(b,e,o,f,y){const w=b.context,E=w.gl,k=b.transform;w.setColorMode(b.colorModeForRenderPass());const I=As(w,e),O=o.key,j=e.heatmapFbos.get(O);if(!j)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,j.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1),I.bind(E.LINEAR,E.CLAMP_TO_EDGE);const Z=k.getProjectionData({overscaledTileID:o,applyTerrainMatrix:y,applyGlobeMatrix:!f});b.useProgram("heatmapTexture").draw(w,E.TRIANGLES,rn.disabled,Mn.disabled,b.colorModeForRenderPass(),Ht.disabled,kf(b,e,0,1),null,Z,e.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,e.paint,k.zoom),j.destroy(),e.heatmapFbos.delete(O)}function Jr(b,e,o){var f,y;const w=b.gl,E=w.createTexture();w.bindTexture(w.TEXTURE_2D,E),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const k=(f=b.HALF_FLOAT)!==null&&f!==void 0?f:w.UNSIGNED_BYTE,I=(y=b.RGBA16F)!==null&&y!==void 0?y:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,I,e,o,0,w.RGBA,k,null);const O=b.createFramebuffer(e,o,!1,!1);return O.colorAttachment.set(E),O}function As(b,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(b,e.colorRamp,b.gl.RGBA)),e.colorRampTexture}function Ua(b,e,o,f,y){if(!o||!f||!f.imageAtlas)return;const w=f.imageAtlas.patternPositions;let E=w[o.to.toString()],k=w[o.from.toString()];if(!E&&k&&(E=k),!k&&E&&(k=E),!E||!k){const I=y.getPaintProperty(e);E=w[I],k=w[I]}E&&k&&b.setConstantPatternPositions(E,k)}function ns(b,e,o,f,y,w,E,k){const I=b.context.gl,O="fill-pattern",j=o.paint.get(O),Z=j&&j.constantOr(1),U=o.getCrossfadeParameters();let Y,Q,le,oe,ue;const de=b.transform,_e=o.paint.get("fill-translate"),fe=o.paint.get("fill-translate-anchor");E?(Q=Z&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=I.LINES):(Q=Z?"fillPattern":"fill",Y=I.TRIANGLES);const be=j.constantOr(null);for(const Se of f){const ge=e.getTile(Se);if(Z&&!ge.patternsLoaded())continue;const ke=ge.getBucket(o);if(!ke)continue;const He=ke.programConfigurations.get(o.id),Oe=b.useProgram(Q,He),je=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Se);Z&&(b.context.activeTexture.set(I.TEXTURE0),ge.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),He.updatePaintBuffers(U)),Ua(He,O,be,ge,o);const $e=de.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),yt=c.aD(de,ge,_e,fe);if(E){oe=ke.indexBuffer2,ue=ke.segments2;const ot=[I.drawingBufferWidth,I.drawingBufferHeight];le=Q==="fillOutlinePattern"&&Z?Xc(b,U,ge,ot,yt):Hc(ot,yt)}else oe=ke.indexBuffer,ue=ke.segments,le=Z?eh(b,U,ge,yt):{u_fill_translate:yt};const vt=b.stencilModeForClipping(Se);Oe.draw(b.context,Y,y,vt,w,Ht.backCCW,le,je,$e,o.id,ke.layoutVertexBuffer,oe,ue,o.paint,b.transform.zoom,He)}}function jo(b,e,o,f,y,w,E,k){const I=b.context,O=I.gl,j="fill-extrusion-pattern",Z=o.paint.get(j),U=Z.constantOr(1),Y=o.getCrossfadeParameters(),Q=o.paint.get("fill-extrusion-opacity"),le=Z.constantOr(null),oe=b.transform;for(const ue of f){const de=e.getTile(ue),_e=de.getBucket(o);if(!_e)continue;const fe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ue),be=_e.programConfigurations.get(o.id),Se=b.useProgram(U?"fillExtrusionPattern":"fillExtrusion",be);U&&(b.context.activeTexture.set(O.TEXTURE0),de.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),be.updatePaintBuffers(Y));const ge=oe.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!k,applyTerrainMatrix:!0});Ua(be,j,le,de,o);const ke=c.aD(oe,de,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),He=o.paint.get("fill-extrusion-vertical-gradient"),Oe=U?Dg(b,He,Q,ke,ue,Y,de):fa(b,He,Q,ke);Se.draw(I,I.gl.TRIANGLES,y,w,E,Ht.backCCW,Oe,fe,ge,o.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,o.paint,b.transform.zoom,be,b.style.map.terrain&&_e.centroidVertexBuffer)}}function bl(b,e,o,f,y,w,E,k,I){var O;const j=b.style.projection,Z=b.context,U=b.transform,Y=Z.gl,Q=[`#define NUM_ILLUMINATION_SOURCES ${o.paint.get("hillshade-highlight-color").values.length}`],le=b.useProgram("hillshade",null,!1,Q),oe=!b.options.moving;for(const ue of f){const de=e.getTile(ue),_e=de.fbo;if(!_e)continue;const fe=j.getMeshFromTileID(Z,ue.canonical,k,!0,"raster"),be=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(ue);Z.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,_e.colorAttachment.get());const Se=U.getProjectionData({overscaledTileID:ue,aligned:oe,applyGlobeMatrix:!I,applyTerrainMatrix:!0});le.draw(Z,Y.TRIANGLES,w,y[ue.overscaledZ],E,Ht.backCCW,Wp(b,de,o),be,Se,o.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}function ph(b,e,o,f,y,w,E,k,I){var O;const j=b.style.projection,Z=b.context,U=b.transform,Y=Z.gl,Q=b.useProgram("colorRelief"),le=!b.options.moving;let oe=!0,ue=0;for(const de of f){const _e=e.getTile(de),fe=_e.dem;if(oe){const Oe=Y.getParameter(Y.MAX_TEXTURE_SIZE),{elevationTexture:je,colorTexture:$e}=o.getColorRampTextures(Z,Oe,fe.getUnpackVector());Z.activeTexture.set(Y.TEXTURE1),je.bind(Y.NEAREST,Y.CLAMP_TO_EDGE),Z.activeTexture.set(Y.TEXTURE4),$e.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),oe=!1,ue=je.size[0]}if(!fe||!fe.data)continue;const be=fe.stride,Se=fe.getPixels();if(Z.activeTexture.set(Y.TEXTURE0),Z.pixelStoreUnpackPremultiplyAlpha.set(!1),_e.demTexture=_e.demTexture||b.getTileTexture(be),_e.demTexture){const Oe=_e.demTexture;Oe.update(Se,{premultiply:!1}),Oe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}else _e.demTexture=new c.T(Z,Se,Y.RGBA,{premultiply:!1}),_e.demTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const ge=j.getMeshFromTileID(Z,de.canonical,k,!0,"raster"),ke=(O=b.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(de),He=U.getProjectionData({overscaledTileID:de,aligned:le,applyGlobeMatrix:!I,applyTerrainMatrix:!0});Q.draw(Z,Y.TRIANGLES,w,y[de.overscaledZ],E,Ht.backCCW,Qc(o,_e.dem,ue),ke,He,o.id,ge.vertexBuffer,ge.indexBuffer,ge.segments)}}const ru=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function sr(b,e,o,f,y,w,E,k,I=!1,O=!1){const j=f[f.length-1].overscaledZ,Z=b.context,U=Z.gl,Y=b.useProgram("raster"),Q=b.transform,le=b.style.projection,oe=b.colorModeForRenderPass(),ue=!b.options.moving;for(const de of f){const _e=b.getDepthModeForSublayer(de.overscaledZ-j,o.paint.get("raster-opacity")===1?rn.ReadWrite:rn.ReadOnly,U.LESS),fe=e.getTile(de);fe.registerFadeDuration(o.paint.get("raster-fade-duration"));const be=e.findLoadedParent(de,0),Se=e.findLoadedSibling(de),ge=Ri(fe,be||Se||null,e,o,b.transform,b.style.map.terrain);let ke,He;const Oe=o.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;Z.activeTexture.set(U.TEXTURE0),fe.texture.bind(Oe,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Z.activeTexture.set(U.TEXTURE1),be?(be.texture.bind(Oe,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),ke=Math.pow(2,be.tileID.overscaledZ-fe.tileID.overscaledZ),He=[fe.tileID.canonical.x*ke%1,fe.tileID.canonical.y*ke%1]):fe.texture.bind(Oe,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),fe.texture.useMipmap&&Z.extTextureFilterAnisotropic&&b.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const je=b.style.map.terrain&&b.style.map.terrain.getTerrainData(de),$e=Q.getProjectionData({overscaledTileID:de,aligned:ue,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),yt=Kc(He||[0,0],ke||1,ge,o,k),vt=le.getMeshFromTileID(Z,de.canonical,w,E,"raster");Y.draw(Z,U.TRIANGLES,_e,y?y[de.overscaledZ]:Mn.disabled,oe,I?Ht.frontCCW:Ht.backCCW,yt,je,$e,o.id,vt.vertexBuffer,vt.indexBuffer,vt.segments)}}function Ri(b,e,o,f,y,w){const E=f.paint.get("raster-fade-duration");if(!w&&E>0){const k=V.now(),I=(k-b.timeAdded)/E,O=e?(k-e.timeAdded)/E:-1,j=o.getSource(),Z=Lt(y,{tileSize:j.tileSize,roundZoom:j.roundZoom}),U=!e||Math.abs(e.tileID.overscaledZ-Z)>Math.abs(b.tileID.overscaledZ-Z),Y=U&&b.refreshedUponExpiration?1:c.ah(U?I:1-O,0,1);return b.refreshedUponExpiration&&I>=1&&(b.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Un=new c.bf(1,0,0,1),xl=new c.bf(0,1,0,1),Va=new c.bf(0,0,1,1),mh=new c.bf(1,0,1,1),gc=new c.bf(0,1,1,1);function Ad(b,e,o,f){Ca(b,0,e+o/2,b.transform.width,o,f)}function Pi(b,e,o,f){Ca(b,e-o/2,0,o,b.transform.height,f)}function Ca(b,e,o,f,y,w){const E=b.context,k=E.gl;k.enable(k.SCISSOR_TEST),k.scissor(e*b.pixelRatio,o*b.pixelRatio,f*b.pixelRatio,y*b.pixelRatio),E.clear({color:w}),k.disable(k.SCISSOR_TEST)}function ea(b,e,o){const f=b.context,y=f.gl,w=b.useProgram("debug"),E=rn.disabled,k=Mn.disabled,I=b.colorModeForRenderPass(),O="$debug",j=b.style.map.terrain&&b.style.map.terrain.getTerrainData(o);f.activeTexture.set(y.TEXTURE0);const Z=e.getTileByID(o.key).latestRawTileData,U=Math.floor((Z&&Z.byteLength||0)/1024),Y=e.getTile(o).tileSize,Q=512/Math.min(Y,512)*(o.overscaledZ/b.transform.zoom)*.5;let le=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(le+=` => ${o.overscaledZ}`),function(ue,de){ue.initDebugOverlayCanvas();const _e=ue.debugOverlayCanvas,fe=ue.context.gl,be=ue.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,_e.width,_e.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(de,5,5),be.strokeText(de,5,5),ue.debugOverlayTexture.update(_e),ue.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(b,`${le} ${U}kB`);const oe=b.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(f,y.TRIANGLES,E,k,ci.alphaBlended,Ht.disabled,lc(c.bf.transparent,Q),null,oe,O,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(f,y.LINE_STRIP,E,k,I,Ht.disabled,lc(c.bf.red),j,oe,O,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function gh(b,e,o,f){const{isRenderingGlobe:y}=f,w=b.context,E=w.gl,k=b.transform,I=b.colorModeForRenderPass(),O=b.getDepthModeFor3D(),j=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const Z of o){const U=e.getTerrainMesh(Z.tileID),Y=b.renderToTexture.getTexture(Z),Q=e.getTerrainData(Z.tileID);w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,Y.texture);const le=e.getMeshFrameDelta(k.zoom),oe=k.calculateFogMatrix(Z.tileID.toUnwrapped()),ue=_d(le,oe,b.style.sky,k.pitch,y),de=k.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(w,E.TRIANGLES,O,Mn.disabled,I,Ht.backCCW,ue,Q,de,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}function Bo(b,e){if(!e.mesh){const o=new c.aL;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const f=new c.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),e.mesh=new ul(b.createVertexBuffer(o,co.members),b.createIndexBuffer(f),c.aM.simpleSegment(0,0,o.length,f.length))}return e.mesh}class Md{constructor(e,o){this.context=new Sd(e),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=bn.maxUnderzooming+bn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ec}resize(e,o,f){if(this.width=Math.floor(e*f),this.height=Math.floor(o*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const e=this.context,o=new c.aL;o.emplaceBack(0,0),o.emplaceBack(c.$,0),o.emplaceBack(0,c.$),o.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(o,co.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const f=new c.aL;f.emplaceBack(0,0),f.emplaceBack(c.$,0),f.emplaceBack(0,c.$),f.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(f,co.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const y=new c.c6;y.emplaceBack(0,0,0,0),y.emplaceBack(c.$,0,c.$,0),y.emplaceBack(0,c.$,0,c.$),y.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(y,Mg.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const w=new c.aL;w.emplaceBack(0,0),w.emplaceBack(c.$,0),w.emplaceBack(0,c.$),w.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(w,co.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const E=new c.aL;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(E,co.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const k=new c.c7;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(k);const I=new c.aN;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(I);const O=this.context.gl;this.stencilClearMode=new Mn({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.tileExtentMesh=new ul(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,o=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.L();c.bY(f,0,this.width,this.height,0,0,1),c.N(f,f,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const y={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(e,o.TRIANGLES,rn.disabled,this.stencilClearMode,ci.disabled,Ht.disabled,null,null,y,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,o,f){if(this.currentStencilSource===e.source||!e.isTileClipped()||!o||!o.length)return;this.currentStencilSource=e.source,this.nextStencilID+o.length>256&&this.clearStencil();const y=this.context;y.setColorMode(ci.disabled),y.setDepthMode(rn.disabled);const w={};for(const E of o)w[E.key]=this.nextStencilID++;this._renderTileMasks(w,o,f,!0),this._renderTileMasks(w,o,f,!1),this._tileClippingMaskIDs=w}_renderTileMasks(e,o,f,y){const w=this.context,E=w.gl,k=this.style.projection,I=this.transform,O=this.useProgram("clippingMask");for(const j of o){const Z=e[j.key],U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),Y=k.getMeshFromTileID(this.context,j.canonical,y,!0,"stencil"),Q=I.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!f,applyTerrainMatrix:!0});O.draw(w,E.TRIANGLES,rn.disabled,new Mn({func:E.ALWAYS,mask:0},Z,255,E.KEEP,E.KEEP,E.REPLACE),ci.disabled,f?Ht.disabled:Ht.backCCW,null,U,Q,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}_renderTilesDepthBuffer(){const e=this.context,o=e.gl,f=this.style.projection,y=this.transform,w=this.useProgram("depth"),E=this.getDepthModeFor3D(),k=Re(y,{tileSize:y.tileSize});for(const I of k){const O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),j=f.getMeshFromTileID(this.context,I.canonical,!0,!0,"raster"),Z=y.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(e,o.TRIANGLES,E,Mn.disabled,ci.disabled,Ht.backCCW,null,O,Z,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,o=this.context.gl;return new Mn({func:o.NOTEQUAL,mask:255},e,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(e){const o=this.context.gl;return new Mn({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const o=this.context.gl,f=e.sort((E,k)=>k.overscaledZ-E.overscaledZ),y=f[f.length-1].overscaledZ,w=f[0].overscaledZ-y+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let k=0;k<w;k++)E[k+y]=new Mn({func:o.GEQUAL,mask:255},k+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[E,f]}return[{[y]:Mn.disabled},f]}stencilConfigForOverlapTwoPass(e){const o=this.context.gl,f=e.sort((E,k)=>k.overscaledZ-E.overscaledZ),y=f[f.length-1].overscaledZ,w=f[0].overscaledZ-y+1;if(this.clearStencil(),w>1){const E={},k={};for(let I=0;I<w;I++)E[I+y]=new Mn({func:o.GREATER,mask:255},w+1+I,255,o.KEEP,o.KEEP,o.REPLACE),k[I+y]=new Mn({func:o.GREATER,mask:255},1+I,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*w+1,[E,k,f]}return this.nextStencilID=3,[{[y]:new Mn({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[y]:new Mn({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},f]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new ci([e.CONSTANT_COLOR,e.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ci.unblended:ci.alphaBlended}getDepthModeForSublayer(e,o,f){if(!this.opaquePassEnabledForLayer())return rn.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new rn(f||this.context.gl.LEQUAL,o,[y,y])}getDepthModeFor3D(){return new rn(this.context.gl.LEQUAL,rn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,o){var f,y;this.style=e,this.options=o,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(V.now()),this.imageManager.beginFrame();const w=this.style._order,E=this.style.sourceCaches,k={},I={},O={},j={isRenderingToTexture:!1,isRenderingGlobe:((f=e.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const U in E){const Y=E[U];Y.used&&Y.prepare(this.context),k[U]=Y.getVisibleCoordinates(!1),I[U]=k[U].slice().reverse(),O[U]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<w.length;U++)if(this.style._layers[w[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of w){const Y=this.style._layers[U];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const Q=I[Y.source];(Y.type==="custom"||Q.length)&&this.renderLayer(this,E[Y.source],Y,Q,j)}if((y=this.style.projection)===null||y===void 0||y.updateGPUdependent({context:this.context,useProgram:U=>this.useProgram(U)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(U,Y){const Q=U.context,le=Q.gl,oe=((Se,ge,ke)=>{const He=Math.cos(ge.rollInRadians),Oe=Math.sin(ge.rollInRadians),je=Te(ge),$e=ge.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Se.properties.get("sky-color"),u_horizon_color:Se.properties.get("horizon-color"),u_horizon:[(ge.width/2-je*Oe)*ke,(ge.height/2+je*He)*ke],u_horizon_normal:[-Oe,He],u_sky_horizon_blend:Se.properties.get("sky-horizon-blend")*ge.height/2*ke,u_sky_blend:$e}})(Y,U.style.map.transform,U.pixelRatio),ue=new rn(le.LEQUAL,rn.ReadWrite,[0,1]),de=Mn.disabled,_e=U.colorModeForRenderPass(),fe=U.useProgram("sky"),be=Bo(Q,Y);fe.draw(Q,le.TRIANGLES,ue,de,_e,Ht.disabled,oe,null,void 0,"sky",be.vertexBuffer,be.indexBuffer,be.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[w[this.currentLayer]],Y=E[U.source],Q=k[U.source];this._renderTileClippingMasks(U,Q,!1),this.renderLayer(this,Y,U,Q,j)}this.renderPass="translucent";let Z=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const U=this.style._layers[w[this.currentLayer]],Y=E[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U,j))continue;this.opaquePassEnabledForLayer()||Z||(Z=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Q=(U.type==="symbol"?O:I)[U.source];this._renderTileClippingMasks(U,k[U.source],!!this.renderToTexture),this.renderLayer(this,Y,U,Q,j)}if(j.isRenderingGlobe&&function(U,Y,Q){const le=U.context,oe=le.gl,ue=U.useProgram("atmosphere"),de=new rn(oe.LEQUAL,rn.ReadOnly,[0,1]),_e=U.transform,fe=function($e,yt){const vt=$e.properties.get("position"),ot=[-vt.x,-vt.y,-vt.z],Ot=c.ag(new Float64Array(16));return $e.properties.get("anchor")==="map"&&(c.b6(Ot,Ot,yt.rollInRadians),c.b7(Ot,Ot,-yt.pitchInRadians),c.b6(Ot,Ot,yt.bearingInRadians),c.b7(Ot,Ot,yt.center.lat*Math.PI/180),c.bz(Ot,Ot,-yt.center.lng*Math.PI/180)),c.c5(ot,ot,Ot),ot}(Q,U.transform),be=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Se=Y.properties.get("atmosphere-blend")*be.projectionTransition;if(Se===0)return;const ge=$c(_e.worldSize,_e.center.lat),ke=_e.inverseProjectionMatrix,He=new Float64Array(4);He[3]=1,c.aw(He,He,_e.modelViewProjectionMatrix),He[0]/=He[3],He[1]/=He[3],He[2]/=He[3],He[3]=1,c.aw(He,He,ke),He[0]/=He[3],He[1]/=He[3],He[2]/=He[3],He[3]=1;const Oe=(($e,yt,vt,ot,Ot)=>({u_sun_pos:$e,u_atmosphere_blend:yt,u_globe_position:vt,u_globe_radius:ot,u_inv_proj_matrix:Ot}))(fe,Se,[He[0],He[1],He[2]],ge,ke),je=Bo(le,Y);ue.draw(le,oe.TRIANGLES,de,Mn.disabled,ci.alphaBlended,Ht.disabled,Oe,null,null,"atmosphere",je.vertexBuffer,je.indexBuffer,je.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const U=function(Y,Q){let le=null;const oe=Object.values(Y._layers).flatMap(fe=>fe.source&&!fe.isHidden(Q)?[Y.sourceCaches[fe.source]]:[]),ue=oe.filter(fe=>fe.getSource().type==="vector"),de=oe.filter(fe=>fe.getSource().type!=="vector"),_e=fe=>{(!le||le.getSource().maxzoom<fe.getSource().maxzoom)&&(le=fe)};return ue.forEach(fe=>_e(fe)),le||de.forEach(fe=>_e(fe)),le}(this.style,this.transform.zoom);U&&function(Y,Q,le){for(let oe=0;oe<le.length;oe++)ea(Y,Q,le[oe])}(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const Y=U.transform.padding;Ad(U,U.transform.height-(Y.top||0),3,Un),Ad(U,Y.bottom||0,3,xl),Pi(U,Y.left||0,3,Va),Pi(U,U.transform.width-(Y.right||0),3,mh);const Q=U.transform.centerPoint;(function(le,oe,ue,de){Ca(le,oe-1,ue-10,2,20,de),Ca(le,oe-10,ue-1,20,2,de)})(U,Q.x,U.transform.height-Q.y,gc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let y=this.terrainFacilitator.dirty;y||(y=e?!c.c8(o,f):!c.c9(o,f)),y||(y=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),y&&(c.ca(o,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,E){const k=w.context,I=k.gl,O=w.transform,j=ci.unblended,Z=new rn(I.LEQUAL,rn.ReadWrite,[0,1]),U=E.sourceCache.getRenderableTiles(),Y=w.useProgram("terrainDepth");k.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),k.clear({color:c.bf.transparent,depth:1});for(const Q of U){const le=E.getTerrainMesh(Q.tileID),oe=E.getTerrainData(Q.tileID),ue=O.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),de={u_ele_delta:E.getMeshFrameDelta(O.zoom)};Y.draw(k,I.TRIANGLES,Z,Mn.disabled,j,Ht.backCCW,de,oe,ue,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,E){const k=w.context,I=k.gl,O=w.transform,j=ci.unblended,Z=new rn(I.LEQUAL,rn.ReadWrite,[0,1]),U=E.getCoordsTexture(),Y=E.sourceCache.getRenderableTiles(),Q=w.useProgram("terrainCoords");k.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),k.clear({color:c.bf.transparent,depth:1}),E.coordsIndex=[];for(const le of Y){const oe=E.getTerrainMesh(le.tileID),ue=E.getTerrainData(le.tileID);k.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,U.texture);const de={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(O.zoom)},_e=O.getProjectionData({overscaledTileID:le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(k,I.TRIANGLES,Z,Mn.disabled,j,Ht.backCCW,de,ue,_e,"terrain",oe.vertexBuffer,oe.indexBuffer,oe.segments),E.coordsIndex.push(le.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(e,o,f,y,w){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(y||[]).length)&&(this.id=f.id,c.cb(f)?function(E,k,I,O,j,Z){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:U}=Z,Y=Mn.disabled,Q=E.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(le,oe,ue,de,_e,fe,be,Se,ge){const ke=oe.transform,He=oe.style.map.terrain,Oe=_e==="map",je=fe==="map";for(const $e of le){const yt=de.getTile($e),vt=yt.getBucket(ue);if(!vt||!vt.text||!vt.text.segments.get().length)continue;const ot=c.an(vt.textSizeData,ke.zoom),Ot=c.aC(yt,1,oe.transform.zoom),fn=li(Oe,oe.transform,Ot),zn=ue.layout.get("icon-text-fit")!=="none"&&vt.hasIconData();if(ot){const Qn=Math.pow(2,ke.zoom-yt.tileID.overscaledZ),Yn=He?(zi,Di)=>He.getElevation($e,zi,Di):null;fh(vt,Oe,je,ge,ke,fn,Qn,ot,zn,c.aD(ke,yt,be,Se),$e.toUnwrapped(),Yn)}}}(O,E,I,k,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),j),I.paint.get("icon-opacity").constantOr(1)!==0&&mo(E,k,I,O,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),Y,Q,U),I.paint.get("text-opacity").constantOr(1)!==0&&mo(E,k,I,O,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),Y,Q,U),k.map.showCollisionBoxes&&(Of(E,k,I,O,!0),Of(E,k,I,O,!1))}(e,o,f,y,this.style.placement.variableOffsets,w):c.cc(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=I.paint.get("circle-opacity"),Y=I.paint.get("circle-stroke-width"),Q=I.paint.get("circle-stroke-opacity"),le=!I.layout.get("circle-sort-key").isConstant();if(U.constantOr(1)===0&&(Y.constantOr(1)===0||Q.constantOr(1)===0))return;const oe=E.context,ue=oe.gl,de=E.transform,_e=E.getDepthModeForSublayer(0,rn.ReadOnly),fe=Mn.disabled,be=E.colorModeForRenderPass(),Se=[],ge=de.getCircleRadiusCorrection();for(let ke=0;ke<O.length;ke++){const He=O[ke],Oe=k.getTile(He),je=Oe.getBucket(I);if(!je)continue;const $e=I.paint.get("circle-translate"),yt=I.paint.get("circle-translate-anchor"),vt=c.aD(de,Oe,$e,yt),ot=je.programConfigurations.get(I.id),Ot=E.useProgram("circle",ot),fn=je.layoutVertexBuffer,zn=je.indexBuffer,Qn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(He),Yn={programConfiguration:ot,program:Ot,layoutVertexBuffer:fn,indexBuffer:zn,uniformValues:Hp(E,Oe,I,vt,ge),terrainData:Qn,projectionData:de.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!Z,applyTerrainMatrix:!0})};if(le){const zi=je.segments.get();for(const Di of zi)Se.push({segments:new c.aM([Di]),sortKey:Di.sortKey,state:Yn})}else Se.push({segments:je.segments,sortKey:0,state:Yn})}le&&Se.sort((ke,He)=>ke.sortKey-He.sortKey);for(const ke of Se){const{programConfiguration:He,program:Oe,layoutVertexBuffer:je,indexBuffer:$e,uniformValues:yt,terrainData:vt,projectionData:ot}=ke.state;Oe.draw(oe,ue.TRIANGLES,_e,fe,be,Ht.backCCW,yt,vt,ot,I.id,je,$e,ke.segments,I.paint,E.transform.zoom,He)}}(e,o,f,y,w):c.cd(f)?function(E,k,I,O,j){if(I.paint.get("heatmap-opacity")===0)return;const Z=E.context,{isRenderingToTexture:U,isRenderingGlobe:Y}=j;if(E.style.map.terrain){for(const Q of O){const le=k.getTile(Q);k.hasRenderableParent(Q)||(E.renderPass==="offscreen"?iu(E,le,I,Q,Y):E.renderPass==="translucent"&&Fa(E,I,Q,U,Y))}Z.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(Q,le,oe,ue){const de=Q.context,_e=de.gl,fe=Q.transform,be=Mn.disabled,Se=new ci([_e.ONE,_e.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(ge,ke,He){const Oe=ge.gl;ge.activeTexture.set(Oe.TEXTURE1),ge.viewport.set([0,0,ke.width/4,ke.height/4]);let je=He.heatmapFbos.get(c.c2);je?(Oe.bindTexture(Oe.TEXTURE_2D,je.colorAttachment.get()),ge.bindFramebuffer.set(je.framebuffer)):(je=Jr(ge,ke.width/4,ke.height/4),He.heatmapFbos.set(c.c2,je))})(de,Q,oe),de.clear({color:c.bf.transparent});for(let ge=0;ge<ue.length;ge++){const ke=ue[ge];if(le.hasRenderableParent(ke))continue;const He=le.getTile(ke),Oe=He.getBucket(oe);if(!Oe)continue;const je=Oe.programConfigurations.get(oe.id),$e=Q.useProgram("heatmap",je),yt=fe.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),vt=fe.getCircleRadiusCorrection();$e.draw(de,_e.TRIANGLES,rn.disabled,be,Se,Ht.backCCW,Xp(He,fe.zoom,oe.paint.get("heatmap-intensity"),vt),null,yt,oe.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,oe.paint,fe.zoom,je)}de.viewport.set([0,0,Q.width,Q.height])}(E,k,I,O):E.renderPass==="translucent"&&function(Q,le){const oe=Q.context,ue=oe.gl;oe.setColorMode(Q.colorModeForRenderPass());const de=le.heatmapFbos.get(c.c2);de&&(oe.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,de.colorAttachment.get()),oe.activeTexture.set(ue.TEXTURE1),As(oe,le).bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(oe,ue.TRIANGLES,rn.disabled,Mn.disabled,Q.colorModeForRenderPass(),Ht.disabled,kf(Q,le,0,1),null,null,le.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,le.paint,Q.transform.zoom))}(E,I)}(e,o,f,y,w):c.ce(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=I.paint.get("line-opacity"),Y=I.paint.get("line-width");if(U.constantOr(1)===0||Y.constantOr(1)===0)return;const Q=E.getDepthModeForSublayer(0,rn.ReadOnly),le=E.colorModeForRenderPass(),oe=I.paint.get("line-dasharray"),ue=I.paint.get("line-pattern"),de=ue.constantOr(1),_e=I.paint.get("line-gradient"),fe=I.getCrossfadeParameters(),be=de?"linePattern":oe?"lineSDF":_e?"lineGradient":"line",Se=E.context,ge=Se.gl,ke=E.transform;let He=!0;for(const Oe of O){const je=k.getTile(Oe);if(de&&!je.patternsLoaded())continue;const $e=je.getBucket(I);if(!$e)continue;const yt=$e.programConfigurations.get(I.id),vt=E.context.program.get(),ot=E.useProgram(be,yt),Ot=He||ot.program!==vt,fn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Oe),zn=ue.constantOr(null);if(zn&&je.imageAtlas){const cn=je.imageAtlas,Kn=cn.patternPositions[zn.to.toString()],Xi=cn.patternPositions[zn.from.toString()];Kn&&Xi&&yt.setConstantPatternPositions(Kn,Xi)}const Qn=ke.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Yn=ke.getPixelScale(),zi=de?Rf(E,je,I,Yn,fe):oe?pl(E,je,I,Yn,oe,fe):_e?nh(E,je,I,Yn,$e.lineClipsArray.length):vd(E,je,I,Yn);if(de)Se.activeTexture.set(ge.TEXTURE0),je.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),yt.updatePaintBuffers(fe);else if(oe&&(Ot||E.lineAtlas.dirty))Se.activeTexture.set(ge.TEXTURE0),E.lineAtlas.bind(Se);else if(_e){const cn=$e.gradients[I.id];let Kn=cn.texture;if(I.gradientVersion!==cn.version){let Xi=256;if(I.stepInterpolant){const pr=k.getSource().maxzoom,br=Oe.canonical.z===pr?Math.ceil(1<<E.transform.maxZoom-Oe.canonical.z):1;Xi=c.ah(c.c3($e.maxLineLength/c.$*1024*br),256,Se.maxTextureSize)}cn.gradient=c.c4({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:Xi,image:cn.gradient||void 0,clips:$e.lineClipsArray}),cn.texture?cn.texture.update(cn.gradient):cn.texture=new c.T(Se,cn.gradient,ge.RGBA),cn.version=I.gradientVersion,Kn=cn.texture}Se.activeTexture.set(ge.TEXTURE0),Kn.bind(I.stepInterpolant?ge.NEAREST:ge.LINEAR,ge.CLAMP_TO_EDGE)}const Di=E.stencilModeForClipping(Oe);ot.draw(Se,ge.TRIANGLES,Q,Di,le,Ht.disabled,zi,fn,Qn,I.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,I.paint,E.transform.zoom,yt,$e.layoutVertexBuffer2),He=!1}}(e,o,f,y,w):c.cf(f)?function(E,k,I,O,j){const Z=I.paint.get("fill-color"),U=I.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const{isRenderingToTexture:Y}=j,Q=E.colorModeForRenderPass(),le=I.paint.get("fill-pattern"),oe=E.opaquePassEnabledForLayer()&&!le.constantOr(1)&&Z.constantOr(c.bf.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===oe){const ue=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?rn.ReadWrite:rn.ReadOnly);ns(E,k,I,O,ue,Q,!1,Y)}if(E.renderPass==="translucent"&&I.paint.get("fill-antialias")){const ue=E.getDepthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,rn.ReadOnly);ns(E,k,I,O,ue,Q,!0,Y)}}(e,o,f,y,w):c.cg(f)?function(E,k,I,O,j){const Z=I.paint.get("fill-extrusion-opacity");if(Z===0)return;const{isRenderingToTexture:U}=j;if(E.renderPass==="translucent"){const Y=new rn(E.context.gl.LEQUAL,rn.ReadWrite,E.depthRangeFor3D);if(Z!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))jo(E,k,I,O,Y,Mn.disabled,ci.disabled,U),jo(E,k,I,O,Y,E.stencilModeFor3D(),E.colorModeForRenderPass(),U);else{const Q=E.colorModeForRenderPass();jo(E,k,I,O,Y,Mn.disabled,Q,U)}}}(e,o,f,y,w):c.ch(f)?function(E,k,I,O,j){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=E.context,Y=E.style.projection.useSubdivision,Q=E.getDepthModeForSublayer(0,rn.ReadOnly),le=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(oe,ue,de,_e,fe,be,Se){const ge=oe.context,ke=ge.gl;for(const He of de){const Oe=ue.getTile(He),je=Oe.dem;if(!je||!je.data||!Oe.needsHillshadePrepare)continue;const $e=je.dim,yt=je.stride,vt=je.getPixels();if(ge.activeTexture.set(ke.TEXTURE1),ge.pixelStoreUnpackPremultiplyAlpha.set(!1),Oe.demTexture=Oe.demTexture||oe.getTileTexture(yt),Oe.demTexture){const Ot=Oe.demTexture;Ot.update(vt,{premultiply:!1}),Ot.bind(ke.NEAREST,ke.CLAMP_TO_EDGE)}else Oe.demTexture=new c.T(ge,vt,ke.RGBA,{premultiply:!1}),Oe.demTexture.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);ge.activeTexture.set(ke.TEXTURE0);let ot=Oe.fbo;if(!ot){const Ot=new c.T(ge,{width:$e,height:$e,data:null},ke.RGBA);Ot.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),ot=Oe.fbo=ge.createFramebuffer($e,$e,!0,!1),ot.colorAttachment.set(Ot.texture)}ge.bindFramebuffer.set(ot.framebuffer),ge.viewport.set([0,0,$e,$e]),oe.useProgram("hillshadePrepare").draw(ge,ke.TRIANGLES,fe,be,Se,Ht.disabled,If(Oe.tileID,je),null,null,_e.id,oe.rasterBoundsBuffer,oe.quadTriangleIndexBuffer,oe.rasterBoundsSegments),Oe.needsHillshadePrepare=!1}})(E,k,O,I,Q,Mn.disabled,le),U.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(Y){const[oe,ue,de]=E.stencilConfigForOverlapTwoPass(O);bl(E,k,I,de,oe,Q,le,!1,Z),bl(E,k,I,de,ue,Q,le,!0,Z)}else{const[oe,ue]=E.getStencilConfigForOverlapAndUpdateStencilID(O);bl(E,k,I,ue,oe,Q,le,!1,Z)}}(e,o,f,y,w):c.ci(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent"||!O.length)return;const{isRenderingToTexture:Z}=j,U=E.style.projection.useSubdivision,Y=E.getDepthModeForSublayer(0,rn.ReadOnly),Q=E.colorModeForRenderPass();if(U){const[le,oe,ue]=E.stencilConfigForOverlapTwoPass(O);ph(E,k,I,ue,le,Y,Q,!1,Z),ph(E,k,I,ue,oe,Y,Q,!0,Z)}else{const[le,oe]=E.getStencilConfigForOverlapAndUpdateStencilID(O);ph(E,k,I,oe,le,Y,Q,!1,Z)}}(e,o,f,y,w):c.cj(f)?function(E,k,I,O,j){if(E.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!O.length)return;const{isRenderingToTexture:Z}=j,U=k.getSource(),Y=E.style.projection.useSubdivision;if(U instanceof za)sr(E,k,I,O,null,!1,!1,U.tileCoords,U.flippedWindingOrder,Z);else if(Y){const[Q,le,oe]=E.stencilConfigForOverlapTwoPass(O);sr(E,k,I,oe,Q,!1,!0,ru,!1,Z),sr(E,k,I,oe,le,!0,!0,ru,!1,Z)}else{const[Q,le]=E.getStencilConfigForOverlapAndUpdateStencilID(O);sr(E,k,I,le,Q,!1,!0,ru,!1,Z)}}(e,o,f,y,w):c.ck(f)?function(E,k,I,O,j){const Z=I.paint.get("background-color"),U=I.paint.get("background-opacity");if(U===0)return;const{isRenderingToTexture:Y}=j,Q=E.context,le=Q.gl,oe=E.style.projection,ue=E.transform,de=ue.tileSize,_e=I.paint.get("background-pattern");if(E.isPatternMissing(_e))return;const fe=!_e&&Z.a===1&&U===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==fe)return;const be=Mn.disabled,Se=E.getDepthModeForSublayer(0,fe==="opaque"?rn.ReadWrite:rn.ReadOnly),ge=E.colorModeForRenderPass(),ke=E.useProgram(_e?"backgroundPattern":"background"),He=O||Re(ue,{tileSize:de,terrain:E.style.map.terrain});_e&&(Q.activeTexture.set(le.TEXTURE0),E.imageManager.bind(E.context));const Oe=I.getCrossfadeParameters();for(const je of He){const $e=ue.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),yt=_e?em(U,E,_e,{tileID:je,tileSize:de},Oe):Jp(U,Z),vt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(je),ot=oe.getMeshFromTileID(Q,je.canonical,!1,!0,"raster");ke.draw(Q,le.TRIANGLES,Se,be,ge,Ht.backCCW,yt,vt,$e,I.id,ot.vertexBuffer,ot.indexBuffer,ot.segments)}}(e,0,f,y,w):c.cl(f)&&function(E,k,I,O){const{isRenderingGlobe:j}=O,Z=E.context,U=I.implementation,Y=E.style.projection,Q=E.transform,le=Q.getProjectionDataForCustomLayer(j),oe={farZ:Q.farZ,nearZ:Q.nearZ,fov:Q.fov*Math.PI/180,modelViewProjectionMatrix:Q.modelViewProjectionMatrix,projectionMatrix:Q.projectionMatrix,shaderData:{variantName:Y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Y.shaderPreludeCode.vertexSource}`,define:Y.shaderDefine},defaultProjectionData:le},ue=U.renderingMode?U.renderingMode:"2d";if(E.renderPass==="offscreen"){const de=U.prerender;de&&(E.setCustomLayerDefaults(),Z.setColorMode(E.colorModeForRenderPass()),de.call(U,Z.gl,oe),Z.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),Z.setColorMode(E.colorModeForRenderPass()),Z.setStencilMode(Mn.disabled);const de=ue==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,rn.ReadOnly);Z.setDepthMode(de),U.render(Z.gl,oe),Z.setDirty(),E.setBaseState(),Z.bindFramebuffer.set(null)}}(e,0,f,w))}saveTileTexture(e){const o=this._tileTextures[e.size[0]];o?o.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const o=this._tileTextures[e];return o&&o.length>0?o.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const o=this.imageManager.getPattern(e.from.toString()),f=this.imageManager.getPattern(e.to.toString());return!o||!f}useProgram(e,o,f=!1,y=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,E=this.style.projection,k=f?Ss.projectionMercator:E.shaderPreludeCode,I=f?Ro:E.shaderDefine,O=e+(o?o.cacheKey:"")+`/${f?tc:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(y?`/${y.join("/")}`:"");return this.cache[O]||(this.cache[O]=new Df(this.context,Ss[e],o,pa[e],this._showOverdrawInspector,w,k,I,y)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:o}=this.context.gl;return this.width!==e||this.height!==o}}function Ga(b,e){let o,f=!1,y=null,w=null;const E=()=>{y=null,f&&(b.apply(w,o),y=setTimeout(E,e),f=!1)};return(...k)=>(f=!0,w=this,o=k,y||E(),y)}class is{constructor(e){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:f,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const f=o.join("/");let y=f;y.split("&").length>0&&(y=y.split("&")[0]),this._hashName&&(y=`${this._hashName}=${f}`);let w=window.location.hash.replace(y,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let E=window.location.href.replace(/(#.+)?$/,w);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Ga(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const o=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,y),E=Math.round(o.lng*w)/w,k=Math.round(o.lat*w)/w,I=this._map.getBearing(),O=this._map.getPitch();let j="";if(j+=e?`/${E}/${k}/${f}`:`${f}/${k}/${E}`,(I||O)&&(j+="/"+Math.round(10*I)/10),O&&(j+=`/${Math.round(O)}`),this._hashName){const Z=this._hashName;let U=!1;const Y=window.location.hash.slice(1).split("&").map(Q=>{const le=Q.split("=")[0];return le===Z?(U=!0,`${le}=${j}`):Q}).filter(Q=>Q);return U||Y.push(`${Z}=${j}`),`#${Y.join("&")}`}return`#${j}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const o=+e[0],f=+(e[3]||0),y=+(e[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&f>=-180&&f<=180&&y>=this._map.getMinPitch()&&y<=this._map.getMaxPitch()}}const ta={linearity:.3,easing:c.cm(0,0,.3,1)},Ms=c.e({deceleration:2500,maxSpeed:1400},ta),Cd=c.e({deceleration:20,maxSpeed:1400},ta),Dd=c.e({deceleration:1e3,maxSpeed:360},ta),au=c.e({deceleration:1e3,maxSpeed:90},ta),yh=c.e({deceleration:1e3,maxSpeed:360},ta);class wl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:V.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,o=V.now();for(;e.length>0&&o-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)o.zoom+=w.zoomDelta||0,o.bearing+=w.bearingDelta||0,o.pitch+=w.pitchDelta||0,o.roll+=w.rollDelta||0,w.panDelta&&o.pan._add(w.panDelta),w.around&&(o.around=w.around),w.pinchAround&&(o.pinchAround=w.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(o.pan.mag()){const w=Fo(o.pan.mag(),f,c.e({},Ms,e||{})),E=o.pan.mult(w.amount/o.pan.mag()),k=this._map.cameraHelper.handlePanInertia(E,this._map.transform);y.center=k.easingCenter,y.offset=k.easingOffset,yi(y,w)}if(o.zoom){const w=Fo(o.zoom,f,Cd);y.zoom=this._map.transform.zoom+w.amount,yi(y,w)}if(o.bearing){const w=Fo(o.bearing,f,Dd);y.bearing=this._map.transform.bearing+c.ah(w.amount,-179,179),yi(y,w)}if(o.pitch){const w=Fo(o.pitch,f,au);y.pitch=this._map.transform.pitch+w.amount,yi(y,w)}if(o.roll){const w=Fo(o.roll,f,yh);y.roll=this._map.transform.roll+c.ah(w.amount,-179,179),yi(y,w)}if(y.zoom||y.bearing){const w=o.pinchAround===void 0?o.around:o.pinchAround;y.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),c.e(y,{noMoveStart:!0})}}function yi(b,e){(!b.duration||b.duration<e.duration)&&(b.duration=e.duration,b.easing=e.easing)}function Fo(b,e,o){const{maxSpeed:f,linearity:y,deceleration:w}=o,E=c.ah(b*y/(e/1e3),-f,f),k=Math.abs(E)/(w*y);return{easing:o.easing,duration:1e3*k,amount:E*(k/2)}}class ga extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f,y={}){f=f instanceof MouseEvent?f:new MouseEvent(e,f);const w=G.mousePos(o.getCanvas(),f),E=o.unproject(w);super(e,c.e({point:w,lngLat:E,originalEvent:f},y)),this._defaultPrevented=!1,this.target=o}}class su extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f){const y=e==="touchend"?f.changedTouches:f.touches,w=G.touchPos(o.getCanvasContainer(),y),E=w.map(I=>o.unproject(I)),k=w.reduce((I,O,j,Z)=>I.add(O.div(Z.length)),new c.P(0,0));super(e,{points:w,point:k,lngLats:E,lngLat:o.unproject(k),originalEvent:f}),this._defaultPrevented=!1}}class Bf extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f){super(e,{originalEvent:f}),this._defaultPrevented=!1}}class rm{constructor(e,o){this._map=e,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Bf(e.type,this._map,e))}mousedown(e,o){return this._mousedownPos=o,this._firePreventable(new ga(e.type,this._map,e))}mouseup(e){this._map.fire(new ga(e.type,this._map,e))}click(e,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new ga(e.type,this._map,e))}dblclick(e){return this._firePreventable(new ga(e.type,this._map,e))}mouseover(e){this._map.fire(new ga(e.type,this._map,e))}mouseout(e){this._map.fire(new ga(e.type,this._map,e))}touchstart(e){return this._firePreventable(new su(e.type,this._map,e))}touchmove(e){this._map.fire(new su(e.type,this._map,e))}touchend(e){this._map.fire(new su(e.type,this._map,e))}touchcancel(e){this._map.fire(new su(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fr{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new ga(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ga("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new ga(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class yc{constructor(e,o){this._map=e,this._tr=new Tl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,o){this.isEnabled()&&e.shiftKey&&e.button===0&&(G.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(e,o){if(!this._active)return;const f=o;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=f,this._box||(this._box=G.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const w=Math.min(y.x,f.x),E=Math.max(y.x,f.x),k=Math.min(y.y,f.y),I=Math.max(y.y,f.y);G.setTransform(this._box,`translate(${w}px,${k}px)`),this._box.style.width=E-w+"px",this._box.style.height=I-k+"px"}mouseupWindow(e,o){if(!this._active||e.button!==0)return;const f=this._startPos,y=o;if(this.reset(),G.suppressClick(),f.x!==y.x||f.y!==y.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:w=>w.fitScreenCoordinates(f,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,o){return this._map.fire(new c.l(e,{originalEvent:o}))}}function go(b,e){if(b.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${e.length}`);const o={};for(let f=0;f<b.length;f++)o[b[f].identifier]=e[f];return o}class kd{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,o,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),f.length===this.numTouches&&(this.centroid=function(y){const w=new c.P(0,0);for(const E of y)w._add(E);return w.div(y.length)}(o),this.touches=go(f,o)))}touchmove(e,o,f){if(this.aborted||!this.centroid)return;const y=go(f,o);for(const w in this.touches){const E=y[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(e,o,f){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class vr{constructor(e){this.singleTap=new kd(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,o,f){this.singleTap.touchstart(e,o,f)}touchmove(e,o,f){this.singleTap.touchmove(e,o,f)}touchend(e,o,f){const y=this.singleTap.touchend(e,o,f);if(y){const w=e.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(w&&E||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class na{constructor(e){this._tr=new Tl(e),this._zoomIn=new vr({numTouches:1,numTaps:2}),this._zoomOut=new vr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,o,f){this._zoomIn.touchstart(e,o,f),this._zoomOut.touchstart(e,o,f)}touchmove(e,o,f){this._zoomIn.touchmove(e,o,f),this._zoomOut.touchmove(e,o,f)}touchend(e,o,f){const y=this._zoomIn.touchend(e,o,f),w=this._zoomOut.touchend(e,o,f),E=this._tr;return y?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(y)},{originalEvent:e})}):w?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(w)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ou{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const o=this._moveFunction(...e);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(e,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,o){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const y=Array.isArray(o)?o[0]:o;return!this._moved&&y.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(f,y))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&G.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const rs=0,lu=2,am={[rs]:1,[lu]:2};class Cs{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const o=G.mouseButton(e);this._eventButton=o}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(o,f){const y=am[f];return o.buttons===void 0||(o.buttons&y)!==y}(e,this._eventButton)}isValidEndEvent(e){return G.mouseButton(e)===this._eventButton}}class Ff{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Id{constructor(e=new Cs({checkCorrectEvent:()=>!0}),o=new Ff){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(e,o,f){return e instanceof MouseEvent?o(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?f(e):void 0}startMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.startMove(o),o=>this.oneFingerTouchMoveStateManager.startMove(o))}endMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.endMove(o),o=>this.oneFingerTouchMoveStateManager.endMove(o))}isValidStartEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidStartEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o))}isValidMoveEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidMoveEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o))}isValidEndEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidEndEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o))}}const cu=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=e=>{e.preventDefault()}};class Uo{constructor(e,o){this._clickTolerance=e.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,o,f){return this._calculateTransform(e,o,f)}touchmove(e,o,f){if(this._active){if(!this._shouldBePrevented(f.length))return e.preventDefault(),this._calculateTransform(e,o,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,o,f){this._calculateTransform(e,o,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,o,f){f.length>0&&(this._active=!0);const y=go(f,o),w=new c.P(0,0),E=new c.P(0,0);let k=0;for(const O in y){const j=y[O],Z=this._touches[O];Z&&(w._add(j),E._add(j.sub(Z)),k++,y[O]=j)}if(this._touches=y,this._shouldBePrevented(k)||!E.mag())return;const I=E.div(k);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(k),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class as{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,o,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([o[0],o[1]]))}touchmove(e,o,f){if(!this._firstTwoTouches)return;e.preventDefault();const[y,w]=this._firstTwoTouches,E=Dt(f,o,y),k=Dt(f,o,w);if(!E||!k)return;const I=this._aroundCenter?null:E.add(k).div(2);return this._move([E,k],I,e)}touchend(e,o,f){if(!this._firstTwoTouches)return;const[y,w]=this._firstTwoTouches,E=Dt(f,o,y),k=Dt(f,o,w);E&&k||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Dt(b,e,o){for(let f=0;f<b.length;f++)if(b[f].identifier===o)return e[f]}function _h(b,e){return Math.log(b/e)/Math.LN2}class vh extends as{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,o){const f=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(_h(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_h(this._distance,f),pinchAround:o}}}function uu(b,e){return 180*b.angleWith(e)/Math.PI}class _c extends as{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,o,f){const y=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:uu(this._vector,y),pinchAround:o}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const o=25/(Math.PI*this._minDiameter)*360,f=uu(e,this._startVector);return Math.abs(f)<o}}function Ds(b){return Math.abs(b.y)>Math.abs(b.x)}class bh extends as{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,o,f){super.touchstart(e,o,f),this._currentTouchCount=f.length}_start(e){this._lastPoints=e,Ds(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,o,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const y=e[0].sub(this._lastPoints[0]),w=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,w,f.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(y.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(e,o,f){if(this._valid!==void 0)return this._valid;const y=e.mag()>=2,w=o.mag()>=2;if(!y&&!w)return;if(!y||!w)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=e.y>0==o.y>0;return Ds(e)&&Ds(o)&&E}}const En={panStep:100,bearingStep:15,pitchStep:10};class ks{constructor(e){this._tr=new Tl(e);const o=En;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let o=0,f=0,y=0,w=0,E=0;switch(e.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:e.shiftKey?f=-1:(e.preventDefault(),w=-1);break;case 39:e.shiftKey?f=1:(e.preventDefault(),w=1);break;case 38:e.shiftKey?y=1:(e.preventDefault(),E=-1);break;case 40:e.shiftKey?y=-1:(e.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:k=>{const I=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:Uf,zoom:o?Math.round(I.zoom)+o*(e.shiftKey?2:1):I.zoom,bearing:I.bearing+f*this._bearingStep,pitch:I.pitch+y*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:I.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Uf(b){return b*(2-b)}const hu=4.000244140625,Sl=1/450;class Vo{constructor(e,o){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=e,this._tr=new Tl(e),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Sl}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let o=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const f=V.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,o!==0&&o%hu==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(y*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=e,this._delta-=o,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=G.mousePos(this._map.getCanvas(),e),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(c.S.convert(f.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const k=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=k),typeof this._targetZoom=="number"&&(this._targetZoom+=k)}if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>hu?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&I!==0&&(I=1/I);const O=typeof this._targetZoom!="number"?e.scale:c.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.ak(O*I)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,f=this._startZoom,y=this._easing;let w,E=!1;if(this._type==="wheel"&&f&&y){const k=V.now()-this._lastWheelEventTime,I=Math.min((k+5)/200,1),O=y(I);w=c.C.number(f,o,O),I<1?this._frameId||(this._frameId=!0):E=!0}else w=o,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!E,zoomDelta:w-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let o=c.co;if(this._prevEase){const f=this._prevEase,y=(V.now()-f.start)/f.duration,w=f.easing(y+.01)-f.easing(y),E=.27/Math.sqrt(w*w+1e-4)*.01,k=Math.sqrt(.0729-E*E);o=c.cm(E,k,.25,1)}return this._prevEase={start:V.now(),duration:e,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class vc{constructor(e,o){this._clickZoom=e,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xh{constructor(e){this._tr=new Tl(e),this.reset()}reset(){this._active=!1}dblclick(e,o){return e.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rd{constructor(){this._tap=new vr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,o,f){if(!this._swipePoint)if(this._tapTime){const y=o[0],w=e.timeStamp-this._tapTime<500,E=this._tapPoint.dist(y)<30;w&&E?f.length>0&&(this._swipePoint=y,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(e,o,f)}touchmove(e,o,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=o[0],w=y.y-this._swipePoint.y;return this._swipePoint=y,e.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(e,o,f)}touchend(e,o,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const y=this._tap.touchend(e,o,f);y&&(this._tapTime=e.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class du{constructor(e,o,f){this._el=e,this._mousePan=o,this._touchPan=f}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bc{constructor(e,o,f,y){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=o,this._mousePitch=f,this._mouseRoll=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Vf{constructor(e,o,f,y){this._el=e,this._touchZoom=o,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Gf{constructor(e,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=G.create("div","maplibregl-cooperative-gesture-screen",e);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),y=document.createElement("div");y.className="maplibregl-desktop-message",y.textContent=o,this._container.appendChild(y);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=f,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(G.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,o){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ia=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class $n extends c.l{}function xc(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class wh{constructor(e,o){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,w)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=y.type==="renderFrame"?void 0:y,k={needsRenderFrame:!1},I={},O={};for(const{handlerName:U,handler:Y,allowed:Q}of this._handlers){if(!Y.isEnabled())continue;let le;if(this._blockedByActive(O,Q,U))Y.reset();else if(Y[w||y.type]){if(c.cp(y,w||y.type)){const oe=G.mousePos(this._map.getCanvas(),y);le=Y[w||y.type](y,oe)}else if(c.cq(y,w||y.type)){const oe=this._getMapTouches(y.touches),ue=G.touchPos(this._map.getCanvas(),oe);le=Y[w||y.type](y,ue,oe)}else c.cr(w||y.type)||(le=Y[w||y.type](y));this.mergeHandlerResult(k,I,le,U,E),le&&le.needsRenderFrame&&this._triggerRenderFrame()}(le||Y.isActive())&&(O[U]=Y)}const j={};for(const U in this._previousActiveHandlers)O[U]||(j[U]=E);this._previousActiveHandlers=O,(Object.keys(j).length||xc(k))&&(this._changes.push([k,I,j]),this._triggerRenderFrame()),(Object.keys(O).length||xc(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=k;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wl(e),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,w,E]of this._listeners)G.addEventListener(y,w,y===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[e,o,f]of this._listeners)G.removeEventListener(e,o,e===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(e){const o=this._map,f=o.getCanvasContainer();this._add("mapEvent",new rm(o,e));const y=o.boxZoom=new yc(o,e);this._add("boxZoom",y),e.interactive&&e.boxZoom&&y.enable();const w=o.cooperativeGestures=new Gf(o,e.cooperativeGestures);this._add("cooperativeGestures",w),e.cooperativeGestures&&w.enable();const E=new na(o),k=new xh(o);o.doubleClickZoom=new vc(k,E),this._add("tapZoom",E),this._add("clickZoom",k),e.interactive&&e.doubleClickZoom&&o.doubleClickZoom.enable();const I=new Rd;this._add("tapDragZoom",I);const O=o.touchPitch=new bh(o);this._add("touchPitch",O),e.interactive&&e.touchPitch&&o.touchPitch.enable(e.touchPitch);const j=()=>o.project(o.getCenter()),Z=function({enable:fe,clickTolerance:be,aroundCenter:Se=!0,minPixelCenterThreshold:ge=100,rotateDegreesPerPixelMoved:ke=.8},He){const Oe=new Cs({checkCorrectEvent:je=>G.mouseButton(je)===0&&je.ctrlKey||G.mouseButton(je)===2&&!je.ctrlKey});return new ou({clickTolerance:be,move:(je,$e)=>{const yt=He();if(Se&&Math.abs(yt.y-je.y)>ge)return{bearingDelta:c.cn(new c.P(je.x,$e.y),$e,yt)};let vt=($e.x-je.x)*ke;return Se&&$e.y<yt.y&&(vt=-vt),{bearingDelta:vt}},moveStateManager:Oe,enable:fe,assignEvents:cu})}(e,j),U=function({enable:fe,clickTolerance:be,pitchDegreesPerPixelMoved:Se=-.5}){const ge=new Cs({checkCorrectEvent:ke=>G.mouseButton(ke)===0&&ke.ctrlKey||G.mouseButton(ke)===2});return new ou({clickTolerance:be,move:(ke,He)=>({pitchDelta:(He.y-ke.y)*Se}),moveStateManager:ge,enable:fe,assignEvents:cu})}(e),Y=function({enable:fe,clickTolerance:be,rollDegreesPerPixelMoved:Se=.3},ge){const ke=new Cs({checkCorrectEvent:He=>G.mouseButton(He)===2&&He.ctrlKey});return new ou({clickTolerance:be,move:(He,Oe)=>{const je=ge();let $e=(Oe.x-He.x)*Se;return Oe.y<je.y&&($e=-$e),{rollDelta:$e}},moveStateManager:ke,enable:fe,assignEvents:cu})}(e,j);o.dragRotate=new bc(e,Z,U,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",U,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Y,["mousePitch"]),e.interactive&&e.dragRotate&&o.dragRotate.enable();const Q=function({enable:fe,clickTolerance:be}){const Se=new Cs({checkCorrectEvent:ge=>G.mouseButton(ge)===0&&!ge.ctrlKey});return new ou({clickTolerance:be,move:(ge,ke)=>({around:ke,panDelta:ke.sub(ge)}),activateOnStart:!0,moveStateManager:Se,enable:fe,assignEvents:cu})}(e),le=new Uo(e,o);o.dragPan=new du(f,Q,le),this._add("mousePan",Q),this._add("touchPan",le,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&o.dragPan.enable(e.dragPan);const oe=new _c,ue=new vh;o.touchZoomRotate=new Vf(f,ue,oe,I),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&o.touchZoomRotate.enable(e.touchZoomRotate);const de=o.scrollZoom=new Vo(o,()=>this._triggerRenderFrame());this._add("scrollZoom",de,["mousePan"]),e.interactive&&e.scrollZoom&&o.scrollZoom.enable(e.scrollZoom);const _e=o.keyboard=new ks(o);this._add("keyboard",_e),e.interactive&&e.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new fr(o))}_add(e,o,f){this._handlers.push({handlerName:e,handler:o,allowed:f}),this._handlersById[e]=o}stop(e){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ia(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,o,f){for(const y in e)if(y!==f&&(!o||o.indexOf(y)<0))return!0;return!1}_getMapTouches(e){const o=[];for(const f of e)this._el.contains(f.target)&&o.push(f);return o}mergeHandlerResult(e,o,f,y,w){if(!f)return;c.e(e,f);const E={handlerName:y,originalEvent:f.originalEvent||w};f.zoomDelta!==void 0&&(o.zoom=E),f.panDelta!==void 0&&(o.drag=E),f.rollDelta!==void 0&&(o.roll=E),f.pitchDelta!==void 0&&(o.pitch=E),f.bearingDelta!==void 0&&(o.rotate=E)}_applyChanges(){const e={},o={},f={};for(const[y,w,E]of this._changes)y.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(y.panDelta)),y.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+y.pitchDelta),y.rollDelta&&(e.rollDelta=(e.rollDelta||0)+y.rollDelta),y.around!==void 0&&(e.around=y.around),y.pinchAround!==void 0&&(e.pinchAround=y.pinchAround),y.noInertia&&(e.noInertia=y.noInertia),c.e(o,w),c.e(f,E);this._updateMapTransform(e,o,f),this._changes=[]}_updateMapTransform(e,o,f){const y=this._map,w=y._getTransformForUpdate(),E=y.terrain;if(!(xc(e)||E&&this._terrainMovement))return this._fireEvents(o,f,!0);y._stop(!0);let{panDelta:k,zoomDelta:I,bearingDelta:O,pitchDelta:j,rollDelta:Z,around:U,pinchAround:Y}=e;Y!==void 0&&(U=Y),U=U||y.transform.centerPoint,E&&!w.isPointOnMapSurface(U)&&(U=w.centerPoint);const Q={panDelta:k,zoomDelta:I,rollDelta:Z,pitchDelta:j,bearingDelta:O,around:U};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(U)&&(U=w.centerPoint);const le=U.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(k?U.sub(k):U);E?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,w),this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(k))):this._map.cameraHelper.handleMapControlsPan(Q,w,le):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Q,w,le))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,w),this._map.cameraHelper.handleMapControlsPan(Q,w,le)),y._applyUpdatedTransform(w),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(o,f,!0)}_fireEvents(e,o,f){const y=ia(this._eventsInProgress),w=ia(e),E={};for(const Z in e){const{originalEvent:U}=e[Z];this._eventsInProgress[Z]||(E[`${Z}start`]=U),this._eventsInProgress[Z]=e[Z]}!y&&w&&this._fireEvent("movestart",w.originalEvent);for(const Z in E)this._fireEvent(Z,E[Z]);w&&this._fireEvent("move",w.originalEvent);for(const Z in e){const{originalEvent:U}=e[Z];this._fireEvent(Z,U)}const k={};let I;for(const Z in this._eventsInProgress){const{handlerName:U,originalEvent:Y}=this._eventsInProgress[Z];this._handlersById[U].isActive()||(delete this._eventsInProgress[Z],I=o[U]||Y,k[`${Z}end`]=I)}for(const Z in k)this._fireEvent(Z,k[Z]);const O=ia(this._eventsInProgress),j=(y||w)&&!O;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Z=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Z.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Z)}if(f&&j){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!Z||!Z.essential&&V.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:I})),U(this._map.getBearing())&&this._map.resetNorth()):(U(Z.bearing||this._map.getBearing())&&(Z.bearing=0),Z.freezeElevation=!0,this._map.easeTo(Z,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(e,o){this._map.fire(new c.l(e,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new $n("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Pd extends c.E{constructor(e,o,f){super(),this._renderFrameCallback=()=>{const y=Math.min((V.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=f.bearingSnap,this.cameraHelper=o,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,o){e.apply(this.transform),this.transform=e,this.cameraHelper=o}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,o){return this.jumpTo({center:e},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,o){return this.jumpTo({elevation:e},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,o,f){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},o),f)}panTo(e,o,f){return this.easeTo(c.e({center:e},o),f)}getZoom(){return this.transform.zoom}setZoom(e,o){return this.jumpTo({zoom:e},o),this}zoomTo(e,o,f){return this.easeTo(c.e({zoom:e},o),f)}zoomIn(e,o){return this.zoomTo(this.getZoom()+1,e,o),this}zoomOut(e,o){return this.zoomTo(this.getZoom()-1,e,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,o){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",o)).fire(new c.l("move",o)).fire(new c.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(e,o){return this.jumpTo({bearing:e},o),this}getPadding(){return this.transform.padding}setPadding(e,o){return this.jumpTo({padding:e},o),this}rotateTo(e,o,f){return this.easeTo(c.e({bearing:e},o),f)}resetNorth(e,o){return this.rotateTo(0,c.e({duration:1e3},e),o),this}resetNorthPitch(e,o){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),o),this}snapToNorth(e,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,o):this}getPitch(){return this.transform.pitch}setPitch(e,o){return this.jumpTo({pitch:e},o),this}getRoll(){return this.transform.roll}setRoll(e,o){return this.jumpTo({roll:e},o),this}cameraForBounds(e,o){e=Gn.convert(e).adjustAntiMeridian();const f=o&&o.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),f,o)}_cameraForBoxAndBearing(e,o,f,y){const w={top:0,bottom:0,right:0,left:0};if(typeof(y=c.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const O=y.padding;y.padding={top:O,bottom:O,right:O,left:O}}const E=c.e(w,y.padding);y.padding=E;const k=this.transform,I=new Gn(e,o);return this.cameraHelper.cameraForBoxAndBearing(y,E,I,f,k)}fitBounds(e,o,f){return this._fitInternal(this.cameraForBounds(e,o),o,f)}fitScreenCoordinates(e,o,f,y,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(o)),f,y),y,w)}_fitInternal(e,o,f){return e?(delete(o=c.e(e,o)).padding,o.linear?this.easeTo(o,f):this.flyTo(o,f)):this}jumpTo(e,o){this.stop();const f=this._getTransformForUpdate();let y=!1,w=!1,E=!1;const k=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,e);const I=f.zoom!==k;return"elevation"in e&&f.elevation!==+e.elevation&&f.setElevation(+e.elevation),"bearing"in e&&f.bearing!==+e.bearing&&(y=!0,f.setBearing(+e.bearing)),"pitch"in e&&f.pitch!==+e.pitch&&(w=!0,f.setPitch(+e.pitch)),"roll"in e&&f.roll!==+e.roll&&(E=!0,f.setRoll(+e.roll)),e.padding==null||f.isPaddingEqual(e.padding)||f.setPadding(e.padding),this._applyUpdatedTransform(f),this.fire(new c.l("movestart",o)).fire(new c.l("move",o)),I&&this.fire(new c.l("zoomstart",o)).fire(new c.l("zoom",o)).fire(new c.l("zoomend",o)),y&&this.fire(new c.l("rotatestart",o)).fire(new c.l("rotate",o)).fire(new c.l("rotateend",o)),w&&this.fire(new c.l("pitchstart",o)).fire(new c.l("pitch",o)).fire(new c.l("pitchend",o)),E&&this.fire(new c.l("rollstart",o)).fire(new c.l("roll",o)).fire(new c.l("rollend",o)),this.fire(new c.l("moveend",o))}calculateCameraOptionsFromTo(e,o,f,y=0){const w=c.a1.fromLngLat(e,o),E=c.a1.fromLngLat(f,y),k=E.x-w.x,I=E.y-w.y,O=E.z-w.z,j=Math.hypot(k,I,O);if(j===0)throw new Error("Can't calculate camera options with same From and To");const Z=Math.hypot(k,I),U=c.ak(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Y=180*Math.atan2(k,-I)/Math.PI;let Q=180*Math.acos(Z/j)/Math.PI;return Q=O<0?90-Q:90+Q,{center:E.toLngLat(),elevation:y,zoom:U,pitch:Q,bearing:Y}}calculateCameraOptionsFromCameraLngLatAltRotation(e,o,f,y,w){const E=this.transform.calculateCenterFromCameraLngLatAlt(e,o,f,y);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:f,pitch:y,roll:w}}easeTo(e,o){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.co},e)).animate===!1||!e.essential&&V.prefersReducedMotion)&&(e.duration=0);const f=this._getTransformForUpdate(),y=this.getBearing(),w=f.pitch,E=f.roll,k="bearing"in e?this._normalizeBearing(e.bearing,y):y,I="pitch"in e?+e.pitch:w,O="roll"in e?this._normalizeBearing(e.roll,E):E,j="padding"in e?e.padding:f.padding,Z=c.P.convert(e.offset);let U,Y;e.around&&(U=c.S.convert(e.around),Y=f.locationToScreenPoint(U));const Q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},le=this.cameraHelper.handleEaseTo(f,{bearing:k,pitch:I,roll:O,padding:j,around:U,aroundPoint:Y,offsetAsPoint:Z,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||y!==k,this._pitching=this._pitching||I!==w,this._rolling=this._rolling||O!==E,this._padding=!f.isPaddingEqual(j),this._zooming=this._zooming||le.isZooming,this._easeId=e.easeId,this._prepareEase(o,e.noMoveStart,Q),this.terrain&&this._prepareElevation(le.elevationCenter),this._ease(oe=>{le.easeFunc(oe),this.terrain&&!e.freezeElevation&&this._updateElevation(oe),this._applyUpdatedTransform(f),this._fireMoveEvents(o)},oe=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o,oe)},e),this}_prepareEase(e,o,f={}){this._moving=!0,o||f.moving||this.fire(new c.l("movestart",e)),this._zooming&&!f.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!f.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!f.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!f.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&o!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(f-(o-(f*e+this._elevationStart))/(1-e)),this._elevationTarget=o}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const o=e.getCameraLngLat(),f=e.getCameraAltitude(),y=this.terrain?this.terrain.getElevationForLngLatZoom(o,e.zoom):0;if(f<y){const w=this.calculateCameraOptionsFromTo(o,y,e.center,e.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(e){const o=[];if(o.push(y=>this._elevateCameraIfInsideTerrain(y)),this.transformCameraUpdate&&o.push(y=>this.transformCameraUpdate(y)),!o.length)return;const f=e.clone();for(const y of o){const w=f.clone(),{center:E,zoom:k,roll:I,pitch:O,bearing:j,elevation:Z}=y(w);E&&w.setCenter(E),Z!==void 0&&w.setElevation(Z),k!==void 0&&w.setZoom(k),I!==void 0&&w.setRoll(I),O!==void 0&&w.setPitch(O),j!==void 0&&w.setBearing(j),f.apply(w)}this.transform.apply(f)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const f=this._zooming,y=this._rotating,w=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new c.l("zoomend",e)),y&&this.fire(new c.l("rotateend",e)),w&&this.fire(new c.l("pitchend",e)),E&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,o){if(!e.essential&&V.prefersReducedMotion){const $e=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo($e,o)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},e);const f=this._getTransformForUpdate(),y=f.bearing,w=f.pitch,E=f.roll,k=f.padding,I="bearing"in e?this._normalizeBearing(e.bearing,y):y,O="pitch"in e?+e.pitch:w,j="roll"in e?this._normalizeBearing(e.roll,E):E,Z="padding"in e?e.padding:f.padding,U=c.P.convert(e.offset);let Y=f.centerPoint.add(U);const Q=f.screenPointToLocation(Y),le=this.cameraHelper.handleFlyTo(f,{bearing:I,pitch:O,roll:j,padding:Z,locationAtOffset:Q,offsetAsPoint:U,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let oe=e.curve;const ue=Math.max(f.width,f.height),de=ue/le.scaleOfZoom,_e=le.pixelPathLength;typeof le.scaleOfMinZoom=="number"&&(oe=Math.sqrt(ue/le.scaleOfMinZoom/_e*2));const fe=oe*oe;function be($e){const yt=(de*de-ue*ue+($e?-1:1)*fe*fe*_e*_e)/(2*($e?de:ue)*fe*_e);return Math.log(Math.sqrt(yt*yt+1)-yt)}function Se($e){return(Math.exp($e)-Math.exp(-$e))/2}function ge($e){return(Math.exp($e)+Math.exp(-$e))/2}const ke=be(!1);let He=function($e){return ge(ke)/ge(ke+oe*$e)},Oe=function($e){return ue*((ge(ke)*(Se(yt=ke+oe*$e)/ge(yt))-Se(ke))/fe)/_e;var yt},je=(be(!0)-ke)/oe;if(Math.abs(_e)<2e-6||!isFinite(je)){if(Math.abs(ue-de)<1e-6)return this.easeTo(e,o);const $e=de<ue?-1:1;je=Math.abs(Math.log(de/ue))/oe,Oe=()=>0,He=yt=>Math.exp($e*oe*yt)}return e.duration="duration"in e?+e.duration:1e3*je/("screenSpeed"in e?+e.screenSpeed/oe:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=y!==I,this._pitching=O!==w,this._rolling=j!==E,this._padding=!f.isPaddingEqual(Z),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(le.targetCenter),this._ease($e=>{const yt=$e*je,vt=1/He(yt),ot=Oe(yt);this._rotating&&f.setBearing(c.C.number(y,I,$e)),this._pitching&&f.setPitch(c.C.number(w,O,$e)),this._rolling&&f.setRoll(c.C.number(E,j,$e)),this._padding&&(f.interpolatePadding(k,Z,$e),Y=f.centerPoint.add(U)),le.easeFunc($e,vt,ot,Y),this.terrain&&!e.freezeElevation&&this._updateElevation($e),this._applyUpdatedTransform(f),this._fireMoveEvents(o)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,o){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,o)}return e||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(e,o,f){f.animate===!1||f.duration===0?(e(1),o()):(this._easeStart=V.now(),this._easeOptions=f,this._onEaseFrame=e,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,o){e=c.aO(e,-180,180);const f=Math.abs(e-o);return Math.abs(e-360-o)<f&&(e-=360),Math.abs(e+360-o)<f&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const yo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Tn{constructor(e=yo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,o){const f=this._map._getUIString(`AttributionControl.${o}`);e.title=f,e.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const o=this._map.style.sourceCaches;for(const y in o){const w=o[y];if(w.used||w.usedForTerrain){const E=w.getSource();E.attribution&&e.indexOf(E.attribution)<0&&e.push(E.attribution)}}e=e.filter(y=>String(y).trim()),e.sort((y,w)=>y.length-w.length),e=e.filter((y,w)=>{for(let E=w+1;E<e.length;E++)if(e[E].indexOf(y)>=0)return!1;return!0});const f=e.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,e.length?(this._innerContainer.innerHTML=G.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ri{constructor(e={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl");const o=G.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ai{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const o=++this._id;return this._queue.push({callback:e,id:o,cancelled:!1}),o}remove(e){const o=this._currentlyRunning,f=o?this._queue.concat(o):this._queue;for(const y of f)if(y.id===e)return void(y.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const f of o)if(!f.cancelled&&(f.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var wc=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class zt extends c.E{constructor(e){super(),this._lastTilesetChange=V.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,o){this.sourceCache.update(e,o),this._renderableTilesKeys=[];const f={};for(const y of Re(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.terrainRttPosMatrix32f=new Float64Array(16),c.bY(y.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[y.key]=new Hr(y,this.tileSize),this._lastTilesetChange=V.now());for(const y in this._tiles)f[y]||delete this._tiles[y]}freeRtt(e){for(const o in this._tiles){const f=this._tiles[o];(!e||f.tileID.equals(e)||f.tileID.isChildOf(e)||e.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,o){return o?this._getTerrainCoordsForTileRanges(e,o):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const o={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID,w=e.clone(),E=c.ba();if(y.canonical.equals(e.canonical))c.bY(E,0,c.$,c.$,0,0,1);else if(y.canonical.isChildOf(e.canonical)){const k=y.canonical.z-e.canonical.z,I=y.canonical.x-(y.canonical.x>>k<<k),O=y.canonical.y-(y.canonical.y>>k<<k),j=c.$>>k;c.bY(E,0,j,j,0,0,1),c.M(E,E,[-I*j,-O*j,0])}else{if(!e.canonical.isChildOf(y.canonical))continue;{const k=e.canonical.z-y.canonical.z,I=e.canonical.x-(e.canonical.x>>k<<k),O=e.canonical.y-(e.canonical.y>>k<<k),j=c.$>>k;c.bY(E,0,c.$,c.$,0,0,1),c.M(E,E,[I*j,O*j,0]),c.N(E,E,[1/2**k,1/2**k,0])}}w.terrainRttPosMatrix32f=new Float32Array(E),o[f]=w}return o}_getTerrainCoordsForTileRanges(e,o){const f={};for(const y of this._renderableTilesKeys){const w=this._tiles[y].tileID;if(!this._isWithinTileRanges(w,o))continue;const E=e.clone(),k=c.ba();if(w.canonical.z===e.canonical.z){const I=e.canonical.x-w.canonical.x,O=e.canonical.y-w.canonical.y;c.bY(k,0,c.$,c.$,0,0,1),c.M(k,k,[I*c.$,O*c.$,0])}else if(w.canonical.z>e.canonical.z){const I=w.canonical.z-e.canonical.z,O=w.canonical.x-(w.canonical.x>>I<<I),j=w.canonical.y-(w.canonical.y>>I<<I),Z=e.canonical.x-(w.canonical.x>>I),U=e.canonical.y-(w.canonical.y>>I),Y=c.$>>I;c.bY(k,0,Y,Y,0,0,1),c.M(k,k,[-O*Y+Z*c.$,-j*Y+U*c.$,0])}else{const I=e.canonical.z-w.canonical.z,O=e.canonical.x-(e.canonical.x>>I<<I),j=e.canonical.y-(e.canonical.y>>I<<I),Z=(e.canonical.x>>I)-w.canonical.x,U=(e.canonical.y>>I)-w.canonical.y,Y=c.$<<I;c.bY(k,0,Y,Y,0,0,1),c.M(k,k,[O*c.$+Z*Y,j*c.$+U*Y,0])}E.terrainRttPosMatrix32f=new Float32Array(k),f[y]=E}return f}getSourceTile(e,o){const f=this.sourceCache._source;let y=e.overscaledZ-this.deltaZoom;if(y>f.maxzoom&&(y=f.maxzoom),y<f.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(y).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!w||!w.dem)&&o)for(;y>=f.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(e.scaledTo(y--).key);return w}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,o){return o[e.canonical.z]&&e.canonical.x>=o[e.canonical.z].minTileX&&e.canonical.x<=o[e.canonical.z].maxTileX&&e.canonical.y>=o[e.canonical.z].minTileY&&e.canonical.y<=o[e.canonical.z].maxTileY}}class Gt{constructor(e,o,f){this._meshCache={},this.painter=e,this.sourceCache=new zt(o),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,o,f,y=c.$){var w;if(!(o>=0&&o<y&&f>=0&&f<y))return 0;const E=this.getTerrainData(e),k=(w=E.tile)===null||w===void 0?void 0:w.dem;if(!k)return 0;const I=c.cs([],[o/y*c.$,f/y*c.$],E.u_terrain_matrix),O=[I[0]*k.dim,I[1]*k.dim],j=Math.floor(O[0]),Z=Math.floor(O[1]),U=O[0]-j,Y=O[1]-Z;return k.get(j,Z)*(1-U)*(1-Y)+k.get(j+1,Z)*U*(1-Y)+k.get(j,Z+1)*(1-U)*Y+k.get(j+1,Z+1)*U*Y}getElevationForLngLatZoom(e,o){if(!c.ct(o,e.wrap()))return 0;const{tileID:f,mercatorX:y,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(e,o);return this.getElevation(f,y%c.$,w%c.$,c.$)}getElevation(e,o,f,y=c.$){return this.getDEMElevation(e,o,f,y)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const y=this.painter.context,w=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(y,w,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(y,new c.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const o=this.sourceCache.getSourceTile(e,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const y=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new c.T(y,o.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),o.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const f=o&&o+o.tileID.key+e.key;if(f&&!this._demMatrixCache[f]){const y=this.sourceCache.sourceCache._source.maxzoom;let w=e.canonical.z-o.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=y?w=e.canonical.z-y:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=e.canonical.x-(e.canonical.x>>w<<w),k=e.canonical.y-(e.canonical.y>>w<<w),I=c.cu(new Float64Array(16),[1/(c.$<<w),1/(c.$<<w),0]);c.M(I,I,[E*c.$,k*c.$,0]),this._demMatrixCache[e.key]={matrix:I,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(e){const o=this.painter,f=o.width/devicePixelRatio,y=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(f,y,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,f,y))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,E=0;w<this._coordsTextureSize;w++)for(let k=0;k<this._coordsTextureSize;k++,E+=4)o[E+0]=255&k,o[E+1]=255&w,o[E+2]=k>>8<<4|w>>8,o[E+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),y=new c.T(e,f,e.gl.RGBA,{premultiply:!1});return y.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),f=this.painter.context,y=f.gl,w=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(w,k-E-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null);const I=o[0]+(o[2]>>4<<8),O=o[1]+((15&o[2])<<8),j=this.coordsIndex[255-o[3]],Z=j&&this.sourceCache.getTileByID(j);if(!Z)return null;const U=this._coordsTextureSize,Y=(1<<Z.tileID.canonical.z)*U;return new c.a1((Z.tileID.canonical.x*U+I)/Y+Z.tileID.wrap,(Z.tileID.canonical.y*U+O)/Y,this.getElevation(Z.tileID,I,O,U))}depthAtPoint(e){const o=new Uint8Array(4),f=this.painter.context,y=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),y.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(e){var o;const f=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,y=f&&e.canonical.y===0,w=f&&e.canonical.y===(1<<e.canonical.z)-1,E=`m_${y?"n":""}_${w?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const k=this.painter.context,I=new c.cv,O=new c.aN,j=this.meshSize,Z=c.$/j,U=j*j;for(let ge=0;ge<=j;ge++)for(let ke=0;ke<=j;ke++)I.emplaceBack(ke*Z,ge*Z,0);for(let ge=0;ge<U;ge+=j+1)for(let ke=0;ke<j;ke++)O.emplaceBack(ke+ge,j+ke+ge+1,j+ke+ge+2),O.emplaceBack(ke+ge,j+ke+ge+2,ke+ge+1);const Y=I.length,Q=Y+(j+1),le=(j+1)*j,oe=y?c.bh:0,ue=y?0:1,de=w?c.bi:c.$,_e=w?0:1;for(let ge=0;ge<=j;ge++)I.emplaceBack(ge*Z,oe,ue);for(let ge=0;ge<=j;ge++)I.emplaceBack(ge*Z,de,_e);for(let ge=0;ge<j;ge++)O.emplaceBack(le+ge,Q+ge,Q+ge+1),O.emplaceBack(le+ge,Q+ge+1,le+ge+1),O.emplaceBack(0+ge,Y+ge+1,Y+ge),O.emplaceBack(0+ge,0+ge+1,Y+ge+1);const fe=I.length,be=fe+2*(j+1);for(const ge of[0,1])for(let ke=0;ke<=j;ke++)for(const He of[0,1])I.emplaceBack(ge*c.$,ke*Z,He);for(let ge=0;ge<2*j;ge+=2)O.emplaceBack(fe+ge,fe+ge+1,fe+ge+3),O.emplaceBack(fe+ge,fe+ge+3,fe+ge+2),O.emplaceBack(be+ge,be+ge+3,be+ge+1),O.emplaceBack(be+ge,be+ge+2,be+ge+3);const Se=new ul(k.createVertexBuffer(I,wc.members),k.createIndexBuffer(O),c.aM.simpleSegment(0,0,I.length,O.length));return this._meshCache[E]=Se,Se}getMeshFrameDelta(e){return 2*Math.PI*c.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,o){var f;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(e,o);return(f=this.getMinMaxElevation(y).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(e){const o=this.getTerrainData(e).tile,f={minElevation:null,maxElevation:null};return o&&o.dem&&(f.minElevation=o.dem.min*this.exaggeration,f.maxElevation=o.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(e,o){const f=c.a1.fromLngLat(e.wrap()),y=(1<<o)*c.$,w=f.x*y,E=f.y*y,k=Math.floor(w/c.$),I=Math.floor(E/c.$);return{tileID:new c.Z(o,0,o,k,I),mercatorX:w,mercatorY:E}}}class Tc{constructor(e,o,f){this._context=e,this._size=o,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(f.texture),{id:e,fbo:o,texture:f,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>e.id!==o),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const ss={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Go{constructor(e,o){this.painter=e,this.terrain=o,this.pool=new Tc(e.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(f=>!e._layers[f].isHidden(o)),this._coordsAscending={};for(const f in e.sourceCaches){this._coordsAscending[f]={};const y=e.sourceCaches[f].getVisibleCoordinates(),w=e.sourceCaches[f].getSource(),E=w instanceof za?w.terrainTileRanges:null;for(const k of y){const I=this.terrain.sourceCache.getTerrainCoords(k,E);for(const O in I)this._coordsAscending[f][O]||(this._coordsAscending[f][O]=[]),this._coordsAscending[f][O].push(I[O])}}this._coordsAscendingStr={};for(const f of e._order){const y=e._layers[f],w=y.source;if(ss[y.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const E in this._coordsAscending[w])this._coordsAscendingStr[w][E]=this._coordsAscending[w][E].map(k=>k.key).sort().join()}}for(const f of this._renderableTiles)for(const y in this._coordsAscendingStr){const w=this._coordsAscendingStr[y][f.tileID.key];w&&w!==f.rttCoords[y]&&(f.rtt=[])}}renderLayer(e,o){if(e.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),y=e.type,w=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ss[y]&&(this._prevType&&ss[this._prevType]||this._stacks.push([]),this._prevType=y,this._stacks[this._stacks.length-1].push(e.id),!E))return!0;if(ss[this._prevType]||ss[y]&&E){this._prevType=y;const k=this._stacks.length-1,I=this._stacks[k]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(gh(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[k]){const Z=this.pool.getObjectForId(O.rtt[k].id);if(Z.stamp===O.rtt[k].stamp){this.pool.useObject(Z);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),O.rtt[k]={id:j.id,stamp:j.stamp},w.context.bindFramebuffer.set(j.fbo.framebuffer),w.context.clear({color:c.bf.transparent,stencil:0}),w.currentStencilSource=void 0;for(let Z=0;Z<I.length;Z++){const U=w.style._layers[I[Z]],Y=U.source?this._coordsAscending[U.source][O.tileID.key]:[O.tileID];w.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),w._renderTileClippingMasks(U,Y,!0),w.renderLayer(w,w.style.sourceCaches[U.source],U,Y,f),U.source&&(O.rttCoords[U.source]=this._coordsAscendingStr[U.source][O.tileID.key])}}return gh(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),ss[y]}return!1}}const ya={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},qi=C,Da={hash:!1,interactive:!0,bearingSnap:7,attributionControl:yo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Zf={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class fu{constructor(e,o,f=!1){this.mousedown=w=>{this.startMove(w,G.mousePos(this.element,w)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,G.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHandler.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),G.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const y=new Id;this._rotatePitchHandler=new ou({clickTolerance:3,move:(w,E)=>{const k=o.getBoundingClientRect(),I=new c.P((k.bottom-k.top)/2,(k.right-k.left)/2);return{bearingDelta:c.cn(new c.P(w.x,E.y),E,I),pitchDelta:f?-.5*(E.y-w.y):void 0}},moveStateManager:y,enable:!0,assignEvents:()=>{}}),this.map=e,G.addEventListener(o,"mousedown",this.mousedown),G.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(o,"touchcancel",this.reset)}startMove(e,o){this._rotatePitchHandler.dragStart(e,o),G.disableDrag()}move(e,o){const f=this.map,{bearingDelta:y,pitchDelta:w}=this._rotatePitchHandler.dragMove(e,o)||{};y&&f.setBearing(f.getBearing()+y),w&&f.setPitch(f.getPitch()+w)}off(){const e=this.element;G.removeEventListener(e,"mousedown",this.mousedown),G.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend),G.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend)}}let Wn;function Hi(b,e,o,f=!1){if(f||!o.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const y=new c.S(b.lng,b.lat);if(b=new c.S(b.lng,b.lat),e){const w=new c.S(b.lng-360,b.lat),E=new c.S(b.lng+360,b.lat),k=o.locationToScreenPoint(b).distSqr(e);o.locationToScreenPoint(w).distSqr(e)<k?b=w:o.locationToScreenPoint(E).distSqr(e)<k&&(b=E)}for(;Math.abs(b.lng-o.center.lng)>180;){const w=o.locationToScreenPoint(b);if(w.x>=0&&w.y>=0&&w.x<=o.width&&w.y<=o.height)break;b.lng>o.center.lng?b.lng-=360:b.lng+=360}return b.lng!==y.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(b))?b:y}const pu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function El(b,e,o){const f=b.classList;for(const y in pu)f.remove(`maplibregl-${o}-anchor-${y}`);f.add(`maplibregl-${o}-anchor-${e}`)}class Al extends c.E{constructor(e){if(super(),this._onKeyPress=o=>{const f=o.code,y=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=o=>{const f=o.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=Hi(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${pu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${y}`),V.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div");const o=G.createNS("http://www.w3.org/2000/svg","svg"),f=41,y=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${f}px`),o.setAttributeNS(null,"width",`${y}px`),o.setAttributeNS(null,"viewBox",`0 0 ${y} ${f}`);const w=G.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const E=G.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const k=G.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of I){const de=G.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",ue.rx),de.setAttributeNS(null,"ry",ue.ry),k.appendChild(de)}const O=G.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const j=G.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(j);const Z=G.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"opacity","0.25"),Z.setAttributeNS(null,"fill","#000000");const U=G.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Z.appendChild(U);const Y=G.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const Q=G.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=G.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const oe=G.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),Q.appendChild(le),Q.appendChild(oe),E.appendChild(k),E.appendChild(O),E.appendChild(Z),E.appendChild(Y),E.appendChild(Q),o.appendChild(E),o.setAttributeNS(null,"height",f*this._scale+"px"),o.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(o),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),El(this._element,this._anchor,"marker"),e&&e.className)for(const o of e.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const y=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var o,f;const y=(o=this._map)===null||o===void 0?void 0:o.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!y||w){const Y=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,k=E.terrain.depthAtPoint(this._pos),I=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,I)-k<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/E.transform.pixelsPerMeter,j=Math.sin(E.getPitch()*Math.PI/180)*O,Z=E.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),U=E.transform.lngLatToCameraDepth(this._lngLat,I+j)-Z>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,o){return(this._opacity===void 0||e===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const ra={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ci=0,Zo=!1;const $o={maxWidth:100,unit:"metric"};function Sc(b,e,o){const f=o&&o.maxWidth||100,y=b._container.clientHeight/2,w=b._container.clientWidth/2,E=b.unproject([w-f/2,y]),k=b.unproject([w+f/2,y]),I=Math.round(b.project(k).x-b.project(E).x),O=Math.min(f,I,b._container.clientWidth),j=E.distanceTo(k);if(o&&o.unit==="imperial"){const Z=3.2808*j;Z>5280?Yo(e,O,Z/5280,b._getUIString("ScaleControl.Miles")):Yo(e,O,Z,b._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Yo(e,O,j/1852,b._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Yo(e,O,j/1e3,b._getUIString("ScaleControl.Kilometers")):Yo(e,O,j,b._getUIString("ScaleControl.Meters"))}function Yo(b,e,o,f){const y=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let k=w/E;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(I){const O=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*O)/O}(k),E*k}(o);b.style.width=e*(y/o)+"px",b.innerHTML=`${y}&nbsp;${f}`}const Is={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},mu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function gu(b){if(b){if(typeof b=="number"){const e=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-b),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const e=c.P.convert(b);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return gu(new c.P(0,0))}const Th=C;v.AJAXError=c.cz,v.Event=c.l,v.Evented=c.E,v.LngLat=c.S,v.MercatorCoordinate=c.a1,v.Point=c.P,v.addProtocol=c.cA,v.config=c.a,v.removeProtocol=c.cB,v.AttributionControl=Tn,v.BoxZoomHandler=yc,v.CanvasSource=qr,v.CooperativeGesturesHandler=Gf,v.DoubleClickZoomHandler=vc,v.DragPanHandler=du,v.DragRotateHandler=bc,v.EdgeInsets=Po,v.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var e;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=o?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=Qa,v.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const o=new c.S(e.coords.longitude,e.coords.latitude),f=e.coords.accuracy,y=this._map.getBearing(),w=c.e({bearing:y},this.options.fitBoundsOptions),E=Gn.fromLngLat(o,f);this._map.fitBounds(E,w,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const o=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Zo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Al({element:this._dotElement}),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Al({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{const f=o?.[0]instanceof ResizeObserverEntry;o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},ra,b)}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(Wn!==void 0&&!e)return Wn;if(window.navigator.permissions===void 0)return Wn=!!window.navigator.geolocation,Wn;try{Wn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Wn=!!window.navigator.geolocation}return Wn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ci=0,Zo=!1}_isOutOfMapMaxBounds(b){const e=this._map.getMaxBounds(),o=b.coords;return e&&(o.longitude<e.getWest()||o.longitude>e.getEast()||o.latitude<e.getSouth()||o.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;const e=this._map.project(b),o=this._map.unproject([e.x+100,e.y]),f=b.distanceTo(o)/100,y=2*this._accuracy/f;this._circleElement.style.width=`${y.toFixed(2)}px`,this._circleElement.style.height=`${y.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ci--,Zo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ci++,Ci>1?(b={maximumAge:6e5,timeout:0},Zo=!0):(b=this.options.positionOptions,Zo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const e=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=G.create("button","maplibregl-ctrl-globe",this._container),G.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},v.Hash=is,v.ImageSource=za,v.KeyboardHandler=ks,v.LngLatBounds=Gn,v.LogoControl=ri,v.Map=class extends Pd{constructor(b){var e,o;c.cw.mark(c.cx.create);const f=Object.assign(Object.assign(Object.assign({},Da),b),{canvasContextAttributes:Object.assign(Object.assign({},Da.canvasContextAttributes),b.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const y=new Fn,w=new Vi;if(f.minZoom!==void 0&&y.setMinZoom(f.minZoom),f.maxZoom!==void 0&&y.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&y.setMinPitch(f.minPitch),f.maxPitch!==void 0&&y.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&y.setRenderWorldCopies(f.renderWorldCopies),super(y,w,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ai,this._controls=[],this._mapId=c.a7(),this._contextLost=k=>{k.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:k}))},this._contextRestored=k=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:k}))},this._onMapScroll=k=>{if(k.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},ya),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=qe.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ae(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let k=!1;const I=Ga(O=>{this._trackResize&&!this._removed&&(this.resize(O),this.redraw())},50);this._resizeObserver=new ResizeObserver(O=>{k?I(O):k=!0}),this._resizeObserver.observe(this._container)}this.handlers=new wh(this,f),this._hash=f.hash&&new is(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.e({},f.fitBoundsOptions,{duration:0}))));const E=typeof f.style=="string"||((o=(e=f.style)===null||e===void 0?void 0:e.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Tn(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new ri,f.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const k=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(k)}}),this.on("data",k=>{this._update(k.dataType==="style"),this.fire(new c.l(`${k.dataType}data`,k))}),this.on("dataloading",k=>{this.fire(new c.l(`${k.dataType}dataloading`,k))}),this.on("dataabort",k=>{this.fire(new c.l("sourcedataabort",k))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,e){return this.style.setGlobalStateProperty(b,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,e){if(e===void 0&&(e=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=b.onAdd(this);this._controls.push(b);const f=this._controlPositions[e];return e.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(b);return e>-1&&this._controls.splice(e,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return Re(this.transform,b)}calculateCameraOptionsFromTo(b,e,o,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,e,o,f)}resize(b,e=!0){const[o,f]=this._containerDimensions(),y=this._getClampedPixelRatio(o,f);if(this._resizeCanvas(o,f,y),this.painter.resize(o,f,y),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const k=this._getClampedPixelRatio(o,f);this._resizeCanvas(o,f,k),this.painter.resize(o,f,k)}this._resizeTransform(e);const w=!this._moving;return w&&(this.stop(),this.fire(new c.l("movestart",b)).fire(new c.l("move",b))),this.fire(new c.l("resize",b)),w&&this.fire(new c.l("moveend",b)),this}_resizeTransform(b=!0){var e;const[o,f]=this._containerDimensions();this.transform.resize(o,f,b),(e=this._requestedCameraState)===null||e===void 0||e.resize(o,f,b)}_getClampedPixelRatio(b,e){const{0:o,1:f}=this._maxCanvasSize,y=this.getPixelRatio(),w=b*y,E=e*y;return Math.min(w>o?o/w:1,E>f?f/E:1)*y}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Gn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,e,o){if(b==="mouseenter"||b==="mouseover"){let f=!1;return{layers:e,listener:o,delegates:{mousemove:w=>{const E=e.filter(I=>this.getLayer(I)),k=E.length!==0?this.queryRenderedFeatures(w.point,{layers:E}):[];k.length?f||(f=!0,o.call(this,new ga(b,this,w.originalEvent,{features:k}))):f=!1},mouseout:()=>{f=!1}}}}if(b==="mouseleave"||b==="mouseout"){let f=!1;return{layers:e,listener:o,delegates:{mousemove:E=>{const k=e.filter(I=>this.getLayer(I));(k.length!==0?this.queryRenderedFeatures(E.point,{layers:k}):[]).length?f=!0:f&&(f=!1,o.call(this,new ga(b,this,E.originalEvent)))},mouseout:E=>{f&&(f=!1,o.call(this,new ga(b,this,E.originalEvent)))}}}}{const f=y=>{const w=e.filter(k=>this.getLayer(k)),E=w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[];E.length&&(y.features=E,o.call(this,y),delete y.features)};return{layers:e,listener:o,delegates:{[b]:f}}}}_saveDelegatedListener(b,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(e)}_removeDelegatedListener(b,e,o){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const f=this._delegatedListeners[b];for(let y=0;y<f.length;y++){const w=f[y];if(w.listener===o&&w.layers.length===e.length&&w.layers.every(E=>e.includes(E))){for(const E in w.delegates)this.off(E,w.delegates[E]);return void f.splice(y,1)}}}on(b,e,o){if(o===void 0)return super.on(b,e);const f=typeof e=="string"?[e]:e,y=this._createDelegatedListener(b,f,o);this._saveDelegatedListener(b,y);for(const w in y.delegates)this.on(w,y.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,f,o)}}}once(b,e,o){if(o===void 0)return super.once(b,e);const f=typeof e=="string"?[e]:e,y=this._createDelegatedListener(b,f,o);for(const w in y.delegates){const E=y.delegates[w];y.delegates[w]=(...k)=>{this._removeDelegatedListener(b,f,o),E(...k)}}this._saveDelegatedListener(b,y);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(b,e,o){return o===void 0?super.off(b,e):(this._removeDelegatedListener(b,typeof e=="string"?[e]:e,o),this)}queryRenderedFeatures(b,e){if(!this.style)return[];let o;const f=b instanceof c.P||Array.isArray(b),y=f?b:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(f?{}:b)||{},y instanceof c.P||typeof y[0]=="number")o=[c.P.convert(y)];else{const w=c.P.convert(y[0]),E=c.P.convert(y[1]);o=[w,new c.P(E.x,w.y),E,new c.P(w.x,E.y),w]}return this.style.queryRenderedFeatures(o,e,this.transform)}querySourceFeatures(b,e){return this.style.querySourceFeatures(b,e)}setStyle(b,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(b,e))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const e=this._locale[b];if(e==null)throw new Error(`Missing UI string '${b}'`);return e}_updateStyle(b,e){var o,f;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,e));const y=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Mf(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,e,y):this.style.loadJSON(b,e,y),this):((f=(o=this.style)===null||o===void 0?void 0:o.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Mf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,e){if(typeof b=="string"){const o=this._requestManager.transformRequest(b,"Style");c.j(o,new AbortController).then(f=>{this._updateDiff(f.data,e)}).catch(f=>{f&&this.fire(new c.k(f))})}else typeof b=="object"&&this._updateDiff(b,e)}_updateDiff(b,e){try{this.style.setState(b,e)&&this._update(!0)}catch(o){c.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(b,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,e){return this._lazyInitEmptyStyle(),this.style.addSource(b,e),this._update(!0)}isSourceLoaded(b){const e=this.style&&this.style.sourceCaches[b];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const e=this.style.sourceCaches[b.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&e.reload();for(const o in this.style._layers){const f=this.style._layers[o];f.type==="hillshade"&&f.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===b.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Gt(this.painter,e,b),this.painter.renderToTexture=new Go(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{var f;o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=o.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:b})),this}getTerrain(){var b,e;return(e=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const e in b){const o=b[e]._tiles;for(const f in o){const y=o[f];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,e,o){if(o){const f=this.getSource(o);if(!f)throw new Error(`There is no source with ID "${o}", cannot set LOD parameters`);f.calculateTileZoom=ft(Math.max(1,b),Math.max(1,e))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=ft(Math.max(1,b),Math.max(1,e));return this._update(!0),this}refreshTiles(b,e){const o=this.style.sourceCaches[b];if(!o)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);e===void 0?o.reload(!0):o.refreshTiles(e.map(f=>new c.a4(f.z,f.x,f.y)))}addImage(b,e,o={}){const{pixelRatio:f=1,sdf:y=!1,stretchX:w,stretchY:E,content:k,textFitWidth:I,textFitHeight:O}=o;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:Z,data:U}=e,Y=e;return this.style.addImage(b,{data:new c.R({width:j,height:Z},new Uint8Array(U)),pixelRatio:f,stretchX:w,stretchY:E,content:k,textFitWidth:I,textFitHeight:O,sdf:y,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,b),this}}{const{width:j,height:Z,data:U}=V.getImageData(e);this.style.addImage(b,{data:new c.R({width:j,height:Z},U),pixelRatio:f,stretchX:w,stretchY:E,content:k,textFitWidth:I,textFitHeight:O,sdf:y,version:0})}}updateImage(b,e){const o=this.style.getImage(b);if(!o)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=e instanceof HTMLImageElement||c.b(e)?V.getImageData(e):e,{width:y,height:w,data:E}=f;if(y===void 0||w===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==o.data.width||w!==o.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(e instanceof HTMLImageElement||c.b(e));return o.data.replace(E,k),this.style.updateImage(b,o),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return qe.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,e){return this._lazyInitEmptyStyle(),this.style.addLayer(b,e),this._update(!0)}moveLayer(b,e){return this.style.moveLayer(b,e),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,e,o){return this.style.setLayerZoomRange(b,e,o),this._update(!0)}setFilter(b,e,o={}){return this.style.setFilter(b,e,o),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,e,o,f={}){return this.style.setPaintProperty(b,e,o,f),this._update(!0)}getPaintProperty(b,e){return this.style.getPaintProperty(b,e)}setLayoutProperty(b,e,o,f={}){return this.style.setLayoutProperty(b,e,o,f),this._update(!0)}getLayoutProperty(b,e){return this.style.getLayoutProperty(b,e)}setGlyphs(b,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,e,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,e,o,f=>{f||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,e,o=>{o||this._update(!0)}),this}setLight(b,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,e){return this.style.setFeatureState(b,e),this._update()}removeFeatureState(b,e){return this.style.removeFeatureState(b,e),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,e=0;return this._container&&(b=this._container.clientWidth||400,e=this._container.clientHeight||300),[b,e]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const e=this._canvasContainer=G.create("div","maplibregl-canvas-container",b);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),f=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],f);const y=this._controlContainer=G.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{w[E]=G.create("div",`maplibregl-ctrl-${E} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,e,o){this._canvas.width=Math.floor(o*b),this._canvas.height=Math.floor(o*e),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{e={requestedAttributes:b},f&&(e.statusMessage=f.statusMessage,e.type=f.type)},{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!o){const f="Failed to initialize WebGL";throw e?(e.message=f,new Error(JSON.stringify(e))):new Error(f)}this.painter=new Md(o,this.transform),ae.testSupport(o)}migrateProjection(b,e){super.migrateProjection(b,e),this.painter.transform=b,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var e,o,f,y,w;const E=this._idleTriggered?this._fadeDuration:0,k=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Z=this.transform.zoom,U=V.now();this.style.zoomHistory.update(Z,U);const Y=new c.F(Z,{now:U,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Q=Y.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(I=!0,this._crossFadingFactor=Q),this.style.update(Y)}const O=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==k;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((y=this.style.projection)===null||y===void 0?void 0:y.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||O)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,O),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),qe.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,V.frame(this._frameRequest,b=>{c.cw.frame(b),this._frameRequest=null;try{this._render(b)}catch(e){if(!c.cy(e)&&!function(o){return o.message===dh}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return qi}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},v.MapMouseEvent=ga,v.MapTouchEvent=su,v.MapWheelEvent=Bf,v.Marker=Al,v.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const e=this._map.getZoom(),o=e===this._map.getMaxZoom(),f=e===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,o)=>{const f=this._map._getUIString(`NavigationControl.${o}`);e.title=f,e.setAttribute("aria-label",f)},this.options=c.e({},Zf,b),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,e){const o=G.create("button",b,this._container);return o.type="button",o.addEventListener("click",e),o}},v.Popup=class extends c.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=G.create("div","maplibregl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Hi(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const o=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const y=gu(this.options.offset);if(!f){const E=this._container.offsetWidth,k=this._container.offsetHeight;let I;I=o.y+y.bottom.y<k?["top"]:o.y>this._map.transform.height-k?["bottom"]:[],o.x<E/2?I.push("left"):o.x>this._map.transform.width-E/2&&I.push("right"),f=I.length===0?"bottom":I.join("-")}let w=o.add(y[f]);this.options.subpixelPositioning||(w=w.round()),G.setTransform(this._container,`${pu[f]} translate(${w.x}px,${w.y}px)`),El(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Is),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const e=document.createDocumentFragment(),o=document.createElement("body");let f;for(o.innerHTML=b;f=o.firstChild,f;)e.appendChild(f);return this.setDOMContent(e)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(mu);b&&b.focus()}},v.RasterDEMTileSource=ji,v.RasterTileSource=Yr,v.ScaleControl=class{constructor(b){this._onMove=()=>{Sc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Sc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},$o),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Vo,v.Style=Mf,v.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=bh,v.TwoFingersTouchRotateHandler=_c,v.TwoFingersTouchZoomHandler=vh,v.TwoFingersTouchZoomRotateHandler=Vf,v.VectorTileSource=Rn,v.VideoSource=ha,v.addSourceType=(b,e)=>c._(void 0,void 0,void 0,function*(){if(Ka(b))throw new Error(`A source type called "${b}" already exists.`);((o,f)=>{xs[o]=f})(b,e)}),v.clearPrewarmedResources=function(){const b=bt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Ee),bt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.createTileMesh=Sf,v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return Bi().getRTLTextPluginStatus()},v.getVersion=function(){return Th},v.getWorkerCount=function(){return nt.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(b){return Ei().broadcast("IS",b)},v.prewarm=function(){Xt().acquire(Ee)},v.setMaxParallelImageRequests=function(b){c.a.MAX_PARALLEL_IMAGE_REQUESTS=b},v.setRTLTextPlugin=function(b,e){return Bi().setRTLTextPlugin(b,e)},v.setWorkerCount=function(b){nt.workerCount=b},v.setWorkerUrl=function(b){c.a.WORKER_URL=b}});var _=l;return _})}(z0)),z0.exports}var n2=HE();const i2=Lp(n2),r2=sE({__proto__:null,default:i2},[n2]),XE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",WE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class Wm extends Error{response;request;constructor(n,l){const d=`${Wm.extractMessage(n)}: ${JSON.stringify({response:n,request:l})}`;super(d),Object.setPrototypeOf(this,Wm.prototype),this.response=n,this.request=l,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Wm)}static extractMessage(n){return n.errors?.[0]?.message??`GraphQL Error (Code: ${String(n.status)})`}}const y1=i=>i.toUpperCase(),Xv=i=>typeof i=="function"?i():i,a2=(i,n)=>i.map((l,d)=>[l,n[d]]),Bm=i=>{let n={};return i instanceof Headers?n=QE(i):Array.isArray(i)?i.forEach(([l,d])=>{l&&d!==void 0&&(n[l]=d)}):i&&(n=i),n},QE=i=>{const n={};return i.forEach((l,d)=>{n[d]=l}),n},KE=i=>{try{const n=i();return JE(n)?n.catch(l=>_1(l)):n}catch(n){return _1(n)}},_1=i=>i instanceof Error?i:new Error(String(i)),JE=i=>typeof i=="object"&&i!==null&&"then"in i&&typeof i.then=="function"&&"catch"in i&&typeof i.catch=="function"&&"finally"in i&&typeof i.finally=="function",sx=i=>{throw new Error(`Unhandled case: ${String(i)}`)},N0=i=>typeof i=="object"&&i!==null&&!Array.isArray(i),eA=(i,n)=>i.documents?i:{documents:i,requestHeaders:n,signal:void 0},tA=(i,n,l)=>i.query?i:{query:i,variables:n,requestHeaders:l,signal:void 0};function pi(i,n){if(!!!i)throw new Error(n)}function sd(i){return typeof i=="object"&&i!==null}function sv(i,n){if(!!!i)throw new Error(n??"Unexpected invariant triggered.")}const nA=/\r\n|[\n\r]/g;function vb(i,n){let l=0,d=1;for(const m of i.body.matchAll(nA)){if(typeof m.index=="number"||sv(!1),m.index>=n)break;l=m.index+m[0].length,d+=1}return{line:d,column:n+1-l}}function iA(i){return s2(i.source,vb(i.source,i.start))}function s2(i,n){const l=i.locationOffset.column-1,d="".padStart(l)+i.body,m=n.line-1,_=i.locationOffset.line-1,v=n.line+_,c=n.line===1?l:0,C=n.column+c,R=`${i.name}:${v}:${C}
`,N=d.split(/\r\n|[\n\r]/g),B=N[m];if(B.length>120){const V=Math.floor(C/80),G=C%80,ae=[];for(let me=0;me<B.length;me+=80)ae.push(B.slice(me,me+80));return R+v1([[`${v} |`,ae[0]],...ae.slice(1,V+1).map(me=>["|",me]),["|","^".padStart(G)],["|",ae[V+1]]])}return R+v1([[`${v-1} |`,N[m-1]],[`${v} |`,B],["|","^".padStart(C)],[`${v+1} |`,N[m+1]]])}function v1(i){const n=i.filter(([d,m])=>m!==void 0),l=Math.max(...n.map(([d])=>d.length));return n.map(([d,m])=>d.padStart(l)+(m?" "+m:"")).join(`
`)}function rA(i){const n=i[0];return n==null||"kind"in n||"length"in n?{nodes:n,source:i[1],positions:i[2],path:i[3],originalError:i[4],extensions:i[5]}:n}class Ti extends Error{constructor(n,...l){var d,m,_;const{nodes:v,source:c,positions:C,path:R,originalError:N,extensions:B}=rA(l);super(n),this.name="GraphQLError",this.path=R??void 0,this.originalError=N??void 0,this.nodes=b1(Array.isArray(v)?v:v?[v]:void 0);const V=b1((d=this.nodes)===null||d===void 0?void 0:d.map(ae=>ae.loc).filter(ae=>ae!=null));this.source=c??(V==null||(m=V[0])===null||m===void 0?void 0:m.source),this.positions=C??V?.map(ae=>ae.start),this.locations=C&&c?C.map(ae=>vb(c,ae)):V?.map(ae=>vb(ae.source,ae.start));const G=sd(N?.extensions)?N?.extensions:void 0;this.extensions=(_=B??G)!==null&&_!==void 0?_:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),N!=null&&N.stack?Object.defineProperty(this,"stack",{value:N.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Ti):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let n=this.message;if(this.nodes)for(const l of this.nodes)l.loc&&(n+=`

`+iA(l.loc));else if(this.source&&this.locations)for(const l of this.locations)n+=`

`+s2(this.source,l);return n}toJSON(){const n={message:this.message};return this.locations!=null&&(n.locations=this.locations),this.path!=null&&(n.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(n.extensions=this.extensions),n}}function b1(i){return i===void 0||i.length===0?void 0:i}function Ra(i,n,l){return new Ti(`Syntax Error: ${l}`,{source:i,positions:[n]})}class aA{constructor(n,l,d){this.start=n.start,this.end=l.end,this.startToken=n,this.endToken=l,this.source=d}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class o2{constructor(n,l,d,m,_,v){this.kind=n,this.start=l,this.end=d,this.line=m,this.column=_,this.value=v,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const l2={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},sA=new Set(Object.keys(l2));function x1(i){const n=i?.kind;return typeof n=="string"&&sA.has(n)}var Hh;(function(i){i.QUERY="query",i.MUTATION="mutation",i.SUBSCRIPTION="subscription"})(Hh||(Hh={}));var ti;(function(i){i.QUERY="QUERY",i.MUTATION="MUTATION",i.SUBSCRIPTION="SUBSCRIPTION",i.FIELD="FIELD",i.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",i.FRAGMENT_SPREAD="FRAGMENT_SPREAD",i.INLINE_FRAGMENT="INLINE_FRAGMENT",i.VARIABLE_DEFINITION="VARIABLE_DEFINITION",i.SCHEMA="SCHEMA",i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.FIELD_DEFINITION="FIELD_DEFINITION",i.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.ENUM_VALUE="ENUM_VALUE",i.INPUT_OBJECT="INPUT_OBJECT",i.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(ti||(ti={}));var It;(function(i){i.NAME="Name",i.DOCUMENT="Document",i.OPERATION_DEFINITION="OperationDefinition",i.VARIABLE_DEFINITION="VariableDefinition",i.SELECTION_SET="SelectionSet",i.FIELD="Field",i.ARGUMENT="Argument",i.FRAGMENT_SPREAD="FragmentSpread",i.INLINE_FRAGMENT="InlineFragment",i.FRAGMENT_DEFINITION="FragmentDefinition",i.VARIABLE="Variable",i.INT="IntValue",i.FLOAT="FloatValue",i.STRING="StringValue",i.BOOLEAN="BooleanValue",i.NULL="NullValue",i.ENUM="EnumValue",i.LIST="ListValue",i.OBJECT="ObjectValue",i.OBJECT_FIELD="ObjectField",i.DIRECTIVE="Directive",i.NAMED_TYPE="NamedType",i.LIST_TYPE="ListType",i.NON_NULL_TYPE="NonNullType",i.SCHEMA_DEFINITION="SchemaDefinition",i.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",i.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",i.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",i.FIELD_DEFINITION="FieldDefinition",i.INPUT_VALUE_DEFINITION="InputValueDefinition",i.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",i.UNION_TYPE_DEFINITION="UnionTypeDefinition",i.ENUM_TYPE_DEFINITION="EnumTypeDefinition",i.ENUM_VALUE_DEFINITION="EnumValueDefinition",i.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",i.DIRECTIVE_DEFINITION="DirectiveDefinition",i.SCHEMA_EXTENSION="SchemaExtension",i.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",i.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",i.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",i.UNION_TYPE_EXTENSION="UnionTypeExtension",i.ENUM_TYPE_EXTENSION="EnumTypeExtension",i.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(It||(It={}));function bb(i){return i===9||i===32}function Xy(i){return i>=48&&i<=57}function c2(i){return i>=97&&i<=122||i>=65&&i<=90}function ox(i){return c2(i)||i===95}function u2(i){return c2(i)||Xy(i)||i===95}function oA(i){var n;let l=Number.MAX_SAFE_INTEGER,d=null,m=-1;for(let v=0;v<i.length;++v){var _;const c=i[v],C=lA(c);C!==c.length&&(d=(_=d)!==null&&_!==void 0?_:v,m=v,v!==0&&C<l&&(l=C))}return i.map((v,c)=>c===0?v:v.slice(l)).slice((n=d)!==null&&n!==void 0?n:0,m+1)}function lA(i){let n=0;for(;n<i.length&&bb(i.charCodeAt(n));)++n;return n}function cA(i,n){const l=i.replace(/"""/g,'\\"""'),d=l.split(/\r\n|[\n\r]/g),m=d.length===1,_=d.length>1&&d.slice(1).every(G=>G.length===0||bb(G.charCodeAt(0))),v=l.endsWith('\\"""'),c=i.endsWith('"')&&!v,C=i.endsWith("\\"),R=c||C,N=!m||i.length>70||R||_||v;let B="";const V=m&&bb(i.charCodeAt(0));return(N&&!V||_)&&(B+=`
`),B+=l,(N||R)&&(B+=`
`),'"""'+B+'"""'}var pt;(function(i){i.SOF="<SOF>",i.EOF="<EOF>",i.BANG="!",i.DOLLAR="$",i.AMP="&",i.PAREN_L="(",i.PAREN_R=")",i.SPREAD="...",i.COLON=":",i.EQUALS="=",i.AT="@",i.BRACKET_L="[",i.BRACKET_R="]",i.BRACE_L="{",i.PIPE="|",i.BRACE_R="}",i.NAME="Name",i.INT="Int",i.FLOAT="Float",i.STRING="String",i.BLOCK_STRING="BlockString",i.COMMENT="Comment"})(pt||(pt={}));class uA{constructor(n){const l=new o2(pt.SOF,0,0,0,0);this.source=n,this.lastToken=l,this.token=l,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let n=this.token;if(n.kind!==pt.EOF)do if(n.next)n=n.next;else{const l=dA(this,n.end);n.next=l,l.prev=n,n=l}while(n.kind===pt.COMMENT);return n}}function hA(i){return i===pt.BANG||i===pt.DOLLAR||i===pt.AMP||i===pt.PAREN_L||i===pt.PAREN_R||i===pt.SPREAD||i===pt.COLON||i===pt.EQUALS||i===pt.AT||i===pt.BRACKET_L||i===pt.BRACKET_R||i===pt.BRACE_L||i===pt.PIPE||i===pt.BRACE_R}function mg(i){return i>=0&&i<=55295||i>=57344&&i<=1114111}function ov(i,n){return h2(i.charCodeAt(n))&&d2(i.charCodeAt(n+1))}function h2(i){return i>=55296&&i<=56319}function d2(i){return i>=56320&&i<=57343}function Ap(i,n){const l=i.source.body.codePointAt(n);if(l===void 0)return pt.EOF;if(l>=32&&l<=126){const d=String.fromCodePoint(l);return d==='"'?`'"'`:`"${d}"`}return"U+"+l.toString(16).toUpperCase().padStart(4,"0")}function ca(i,n,l,d,m){const _=i.line,v=1+l-i.lineStart;return new o2(n,l,d,_,v,m)}function dA(i,n){const l=i.source.body,d=l.length;let m=n;for(;m<d;){const _=l.charCodeAt(m);switch(_){case 65279:case 9:case 32:case 44:++m;continue;case 10:++m,++i.line,i.lineStart=m;continue;case 13:l.charCodeAt(m+1)===10?m+=2:++m,++i.line,i.lineStart=m;continue;case 35:return fA(i,m);case 33:return ca(i,pt.BANG,m,m+1);case 36:return ca(i,pt.DOLLAR,m,m+1);case 38:return ca(i,pt.AMP,m,m+1);case 40:return ca(i,pt.PAREN_L,m,m+1);case 41:return ca(i,pt.PAREN_R,m,m+1);case 46:if(l.charCodeAt(m+1)===46&&l.charCodeAt(m+2)===46)return ca(i,pt.SPREAD,m,m+3);break;case 58:return ca(i,pt.COLON,m,m+1);case 61:return ca(i,pt.EQUALS,m,m+1);case 64:return ca(i,pt.AT,m,m+1);case 91:return ca(i,pt.BRACKET_L,m,m+1);case 93:return ca(i,pt.BRACKET_R,m,m+1);case 123:return ca(i,pt.BRACE_L,m,m+1);case 124:return ca(i,pt.PIPE,m,m+1);case 125:return ca(i,pt.BRACE_R,m,m+1);case 34:return l.charCodeAt(m+1)===34&&l.charCodeAt(m+2)===34?vA(i,m):mA(i,m)}if(Xy(_)||_===45)return pA(i,m,_);if(ox(_))return bA(i,m);throw Ra(i.source,m,_===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:mg(_)||ov(l,m)?`Unexpected character: ${Ap(i,m)}.`:`Invalid character: ${Ap(i,m)}.`)}return ca(i,pt.EOF,d,d)}function fA(i,n){const l=i.source.body,d=l.length;let m=n+1;for(;m<d;){const _=l.charCodeAt(m);if(_===10||_===13)break;if(mg(_))++m;else if(ov(l,m))m+=2;else break}return ca(i,pt.COMMENT,n,m,l.slice(n+1,m))}function pA(i,n,l){const d=i.source.body;let m=n,_=l,v=!1;if(_===45&&(_=d.charCodeAt(++m)),_===48){if(_=d.charCodeAt(++m),Xy(_))throw Ra(i.source,m,`Invalid number, unexpected digit after 0: ${Ap(i,m)}.`)}else m=Wv(i,m,_),_=d.charCodeAt(m);if(_===46&&(v=!0,_=d.charCodeAt(++m),m=Wv(i,m,_),_=d.charCodeAt(m)),(_===69||_===101)&&(v=!0,_=d.charCodeAt(++m),(_===43||_===45)&&(_=d.charCodeAt(++m)),m=Wv(i,m,_),_=d.charCodeAt(m)),_===46||ox(_))throw Ra(i.source,m,`Invalid number, expected digit but got: ${Ap(i,m)}.`);return ca(i,v?pt.FLOAT:pt.INT,n,m,d.slice(n,m))}function Wv(i,n,l){if(!Xy(l))throw Ra(i.source,n,`Invalid number, expected digit but got: ${Ap(i,n)}.`);const d=i.source.body;let m=n+1;for(;Xy(d.charCodeAt(m));)++m;return m}function mA(i,n){const l=i.source.body,d=l.length;let m=n+1,_=m,v="";for(;m<d;){const c=l.charCodeAt(m);if(c===34)return v+=l.slice(_,m),ca(i,pt.STRING,n,m+1,v);if(c===92){v+=l.slice(_,m);const C=l.charCodeAt(m+1)===117?l.charCodeAt(m+2)===123?gA(i,m):yA(i,m):_A(i,m);v+=C.value,m+=C.size,_=m;continue}if(c===10||c===13)break;if(mg(c))++m;else if(ov(l,m))m+=2;else throw Ra(i.source,m,`Invalid character within String: ${Ap(i,m)}.`)}throw Ra(i.source,m,"Unterminated string.")}function gA(i,n){const l=i.source.body;let d=0,m=3;for(;m<12;){const _=l.charCodeAt(n+m++);if(_===125){if(m<5||!mg(d))break;return{value:String.fromCodePoint(d),size:m}}if(d=d<<4|My(_),d<0)break}throw Ra(i.source,n,`Invalid Unicode escape sequence: "${l.slice(n,n+m)}".`)}function yA(i,n){const l=i.source.body,d=w1(l,n+2);if(mg(d))return{value:String.fromCodePoint(d),size:6};if(h2(d)&&l.charCodeAt(n+6)===92&&l.charCodeAt(n+7)===117){const m=w1(l,n+8);if(d2(m))return{value:String.fromCodePoint(d,m),size:12}}throw Ra(i.source,n,`Invalid Unicode escape sequence: "${l.slice(n,n+6)}".`)}function w1(i,n){return My(i.charCodeAt(n))<<12|My(i.charCodeAt(n+1))<<8|My(i.charCodeAt(n+2))<<4|My(i.charCodeAt(n+3))}function My(i){return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:-1}function _A(i,n){const l=i.source.body;switch(l.charCodeAt(n+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Ra(i.source,n,`Invalid character escape sequence: "${l.slice(n,n+2)}".`)}function vA(i,n){const l=i.source.body,d=l.length;let m=i.lineStart,_=n+3,v=_,c="";const C=[];for(;_<d;){const R=l.charCodeAt(_);if(R===34&&l.charCodeAt(_+1)===34&&l.charCodeAt(_+2)===34){c+=l.slice(v,_),C.push(c);const N=ca(i,pt.BLOCK_STRING,n,_+3,oA(C).join(`
`));return i.line+=C.length-1,i.lineStart=m,N}if(R===92&&l.charCodeAt(_+1)===34&&l.charCodeAt(_+2)===34&&l.charCodeAt(_+3)===34){c+=l.slice(v,_),v=_+1,_+=4;continue}if(R===10||R===13){c+=l.slice(v,_),C.push(c),R===13&&l.charCodeAt(_+1)===10?_+=2:++_,c="",v=_,m=_;continue}if(mg(R))++_;else if(ov(l,_))_+=2;else throw Ra(i.source,_,`Invalid character within String: ${Ap(i,_)}.`)}throw Ra(i.source,_,"Unterminated string.")}function bA(i,n){const l=i.source.body,d=l.length;let m=n+1;for(;m<d;){const _=l.charCodeAt(m);if(u2(_))++m;else break}return ca(i,pt.NAME,n,m,l.slice(n,m))}const xA=10,f2=2;function wn(i){return lv(i,[])}function lv(i,n){switch(typeof i){case"string":return JSON.stringify(i);case"function":return i.name?`[function ${i.name}]`:"[function]";case"object":return wA(i,n);default:return String(i)}}function wA(i,n){if(i===null)return"null";if(n.includes(i))return"[Circular]";const l=[...n,i];if(TA(i)){const d=i.toJSON();if(d!==i)return typeof d=="string"?d:lv(d,l)}else if(Array.isArray(i))return EA(i,l);return SA(i,l)}function TA(i){return typeof i.toJSON=="function"}function SA(i,n){const l=Object.entries(i);return l.length===0?"{}":n.length>f2?"["+AA(i)+"]":"{ "+l.map(([m,_])=>m+": "+lv(_,n)).join(", ")+" }"}function EA(i,n){if(i.length===0)return"[]";if(n.length>f2)return"[Array]";const l=Math.min(xA,i.length),d=i.length-l,m=[];for(let _=0;_<l;++_)m.push(lv(i[_],n));return d===1?m.push("... 1 more item"):d>1&&m.push(`... ${d} more items`),"["+m.join(", ")+"]"}function AA(i){const n=Object.prototype.toString.call(i).replace(/^\[object /,"").replace(/]$/,"");if(n==="Object"&&typeof i.constructor=="function"){const l=i.constructor.name;if(typeof l=="string"&&l!=="")return l}return n}const MA=globalThis.process&&!0,Gu=MA?function(n,l){return n instanceof l}:function(n,l){if(n instanceof l)return!0;if(typeof n=="object"&&n!==null){var d;const m=l.prototype[Symbol.toStringTag],_=Symbol.toStringTag in n?n[Symbol.toStringTag]:(d=n.constructor)===null||d===void 0?void 0:d.name;if(m===_){const v=wn(n);throw new Error(`Cannot use ${m} "${v}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class p2{constructor(n,l="GraphQL request",d={line:1,column:1}){typeof n=="string"||pi(!1,`Body must be a string. Received: ${wn(n)}.`),this.body=n,this.name=l,this.locationOffset=d,this.locationOffset.line>0||pi(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||pi(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function CA(i){return Gu(i,p2)}function DA(i,n){const l=new m2(i,n),d=l.parseDocument();return Object.defineProperty(d,"tokenCount",{enumerable:!1,value:l.tokenCount}),d}function kA(i,n){const l=new m2(i,n);l.expectToken(pt.SOF);const d=l.parseValueLiteral(!1);return l.expectToken(pt.EOF),d}class m2{constructor(n,l={}){const d=CA(n)?n:new p2(n);this._lexer=new uA(d),this._options=l,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const n=this.expectToken(pt.NAME);return this.node(n,{kind:It.NAME,value:n.value})}parseDocument(){return this.node(this._lexer.token,{kind:It.DOCUMENT,definitions:this.many(pt.SOF,this.parseDefinition,pt.EOF)})}parseDefinition(){if(this.peek(pt.BRACE_L))return this.parseOperationDefinition();const n=this.peekDescription(),l=n?this._lexer.lookahead():this._lexer.token;if(l.kind===pt.NAME){switch(l.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(n)throw Ra(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(l.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(l)}parseOperationDefinition(){const n=this._lexer.token;if(this.peek(pt.BRACE_L))return this.node(n,{kind:It.OPERATION_DEFINITION,operation:Hh.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const l=this.parseOperationType();let d;return this.peek(pt.NAME)&&(d=this.parseName()),this.node(n,{kind:It.OPERATION_DEFINITION,operation:l,name:d,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const n=this.expectToken(pt.NAME);switch(n.value){case"query":return Hh.QUERY;case"mutation":return Hh.MUTATION;case"subscription":return Hh.SUBSCRIPTION}throw this.unexpected(n)}parseVariableDefinitions(){return this.optionalMany(pt.PAREN_L,this.parseVariableDefinition,pt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:It.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(pt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(pt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const n=this._lexer.token;return this.expectToken(pt.DOLLAR),this.node(n,{kind:It.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:It.SELECTION_SET,selections:this.many(pt.BRACE_L,this.parseSelection,pt.BRACE_R)})}parseSelection(){return this.peek(pt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const n=this._lexer.token,l=this.parseName();let d,m;return this.expectOptionalToken(pt.COLON)?(d=l,m=this.parseName()):m=l,this.node(n,{kind:It.FIELD,alias:d,name:m,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(pt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(n){const l=n?this.parseConstArgument:this.parseArgument;return this.optionalMany(pt.PAREN_L,l,pt.PAREN_R)}parseArgument(n=!1){const l=this._lexer.token,d=this.parseName();return this.expectToken(pt.COLON),this.node(l,{kind:It.ARGUMENT,name:d,value:this.parseValueLiteral(n)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const n=this._lexer.token;this.expectToken(pt.SPREAD);const l=this.expectOptionalKeyword("on");return!l&&this.peek(pt.NAME)?this.node(n,{kind:It.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(n,{kind:It.INLINE_FRAGMENT,typeCondition:l?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const n=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(n,{kind:It.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(n,{kind:It.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(n){const l=this._lexer.token;switch(l.kind){case pt.BRACKET_L:return this.parseList(n);case pt.BRACE_L:return this.parseObject(n);case pt.INT:return this.advanceLexer(),this.node(l,{kind:It.INT,value:l.value});case pt.FLOAT:return this.advanceLexer(),this.node(l,{kind:It.FLOAT,value:l.value});case pt.STRING:case pt.BLOCK_STRING:return this.parseStringLiteral();case pt.NAME:switch(this.advanceLexer(),l.value){case"true":return this.node(l,{kind:It.BOOLEAN,value:!0});case"false":return this.node(l,{kind:It.BOOLEAN,value:!1});case"null":return this.node(l,{kind:It.NULL});default:return this.node(l,{kind:It.ENUM,value:l.value})}case pt.DOLLAR:if(n)if(this.expectToken(pt.DOLLAR),this._lexer.token.kind===pt.NAME){const d=this._lexer.token.value;throw Ra(this._lexer.source,l.start,`Unexpected variable "$${d}" in constant value.`)}else throw this.unexpected(l);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const n=this._lexer.token;return this.advanceLexer(),this.node(n,{kind:It.STRING,value:n.value,block:n.kind===pt.BLOCK_STRING})}parseList(n){const l=()=>this.parseValueLiteral(n);return this.node(this._lexer.token,{kind:It.LIST,values:this.any(pt.BRACKET_L,l,pt.BRACKET_R)})}parseObject(n){const l=()=>this.parseObjectField(n);return this.node(this._lexer.token,{kind:It.OBJECT,fields:this.any(pt.BRACE_L,l,pt.BRACE_R)})}parseObjectField(n){const l=this._lexer.token,d=this.parseName();return this.expectToken(pt.COLON),this.node(l,{kind:It.OBJECT_FIELD,name:d,value:this.parseValueLiteral(n)})}parseDirectives(n){const l=[];for(;this.peek(pt.AT);)l.push(this.parseDirective(n));return l}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(n){const l=this._lexer.token;return this.expectToken(pt.AT),this.node(l,{kind:It.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(n)})}parseTypeReference(){const n=this._lexer.token;let l;if(this.expectOptionalToken(pt.BRACKET_L)){const d=this.parseTypeReference();this.expectToken(pt.BRACKET_R),l=this.node(n,{kind:It.LIST_TYPE,type:d})}else l=this.parseNamedType();return this.expectOptionalToken(pt.BANG)?this.node(n,{kind:It.NON_NULL_TYPE,type:l}):l}parseNamedType(){return this.node(this._lexer.token,{kind:It.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(pt.STRING)||this.peek(pt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("schema");const d=this.parseConstDirectives(),m=this.many(pt.BRACE_L,this.parseOperationTypeDefinition,pt.BRACE_R);return this.node(n,{kind:It.SCHEMA_DEFINITION,description:l,directives:d,operationTypes:m})}parseOperationTypeDefinition(){const n=this._lexer.token,l=this.parseOperationType();this.expectToken(pt.COLON);const d=this.parseNamedType();return this.node(n,{kind:It.OPERATION_TYPE_DEFINITION,operation:l,type:d})}parseScalarTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("scalar");const d=this.parseName(),m=this.parseConstDirectives();return this.node(n,{kind:It.SCALAR_TYPE_DEFINITION,description:l,name:d,directives:m})}parseObjectTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("type");const d=this.parseName(),m=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:It.OBJECT_TYPE_DEFINITION,description:l,name:d,interfaces:m,directives:_,fields:v})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(pt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(pt.BRACE_L,this.parseFieldDefinition,pt.BRACE_R)}parseFieldDefinition(){const n=this._lexer.token,l=this.parseDescription(),d=this.parseName(),m=this.parseArgumentDefs();this.expectToken(pt.COLON);const _=this.parseTypeReference(),v=this.parseConstDirectives();return this.node(n,{kind:It.FIELD_DEFINITION,description:l,name:d,arguments:m,type:_,directives:v})}parseArgumentDefs(){return this.optionalMany(pt.PAREN_L,this.parseInputValueDef,pt.PAREN_R)}parseInputValueDef(){const n=this._lexer.token,l=this.parseDescription(),d=this.parseName();this.expectToken(pt.COLON);const m=this.parseTypeReference();let _;this.expectOptionalToken(pt.EQUALS)&&(_=this.parseConstValueLiteral());const v=this.parseConstDirectives();return this.node(n,{kind:It.INPUT_VALUE_DEFINITION,description:l,name:d,type:m,defaultValue:_,directives:v})}parseInterfaceTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("interface");const d=this.parseName(),m=this.parseImplementsInterfaces(),_=this.parseConstDirectives(),v=this.parseFieldsDefinition();return this.node(n,{kind:It.INTERFACE_TYPE_DEFINITION,description:l,name:d,interfaces:m,directives:_,fields:v})}parseUnionTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("union");const d=this.parseName(),m=this.parseConstDirectives(),_=this.parseUnionMemberTypes();return this.node(n,{kind:It.UNION_TYPE_DEFINITION,description:l,name:d,directives:m,types:_})}parseUnionMemberTypes(){return this.expectOptionalToken(pt.EQUALS)?this.delimitedMany(pt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("enum");const d=this.parseName(),m=this.parseConstDirectives(),_=this.parseEnumValuesDefinition();return this.node(n,{kind:It.ENUM_TYPE_DEFINITION,description:l,name:d,directives:m,values:_})}parseEnumValuesDefinition(){return this.optionalMany(pt.BRACE_L,this.parseEnumValueDefinition,pt.BRACE_R)}parseEnumValueDefinition(){const n=this._lexer.token,l=this.parseDescription(),d=this.parseEnumValueName(),m=this.parseConstDirectives();return this.node(n,{kind:It.ENUM_VALUE_DEFINITION,description:l,name:d,directives:m})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Ra(this._lexer.source,this._lexer.token.start,`${M0(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("input");const d=this.parseName(),m=this.parseConstDirectives(),_=this.parseInputFieldsDefinition();return this.node(n,{kind:It.INPUT_OBJECT_TYPE_DEFINITION,description:l,name:d,directives:m,fields:_})}parseInputFieldsDefinition(){return this.optionalMany(pt.BRACE_L,this.parseInputValueDef,pt.BRACE_R)}parseTypeSystemExtension(){const n=this._lexer.lookahead();if(n.kind===pt.NAME)switch(n.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(n)}parseSchemaExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const l=this.parseConstDirectives(),d=this.optionalMany(pt.BRACE_L,this.parseOperationTypeDefinition,pt.BRACE_R);if(l.length===0&&d.length===0)throw this.unexpected();return this.node(n,{kind:It.SCHEMA_EXTENSION,directives:l,operationTypes:d})}parseScalarTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const l=this.parseName(),d=this.parseConstDirectives();if(d.length===0)throw this.unexpected();return this.node(n,{kind:It.SCALAR_TYPE_EXTENSION,name:l,directives:d})}parseObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const l=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(d.length===0&&m.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:It.OBJECT_TYPE_EXTENSION,name:l,interfaces:d,directives:m,fields:_})}parseInterfaceTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const l=this.parseName(),d=this.parseImplementsInterfaces(),m=this.parseConstDirectives(),_=this.parseFieldsDefinition();if(d.length===0&&m.length===0&&_.length===0)throw this.unexpected();return this.node(n,{kind:It.INTERFACE_TYPE_EXTENSION,name:l,interfaces:d,directives:m,fields:_})}parseUnionTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const l=this.parseName(),d=this.parseConstDirectives(),m=this.parseUnionMemberTypes();if(d.length===0&&m.length===0)throw this.unexpected();return this.node(n,{kind:It.UNION_TYPE_EXTENSION,name:l,directives:d,types:m})}parseEnumTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const l=this.parseName(),d=this.parseConstDirectives(),m=this.parseEnumValuesDefinition();if(d.length===0&&m.length===0)throw this.unexpected();return this.node(n,{kind:It.ENUM_TYPE_EXTENSION,name:l,directives:d,values:m})}parseInputObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const l=this.parseName(),d=this.parseConstDirectives(),m=this.parseInputFieldsDefinition();if(d.length===0&&m.length===0)throw this.unexpected();return this.node(n,{kind:It.INPUT_OBJECT_TYPE_EXTENSION,name:l,directives:d,fields:m})}parseDirectiveDefinition(){const n=this._lexer.token,l=this.parseDescription();this.expectKeyword("directive"),this.expectToken(pt.AT);const d=this.parseName(),m=this.parseArgumentDefs(),_=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const v=this.parseDirectiveLocations();return this.node(n,{kind:It.DIRECTIVE_DEFINITION,description:l,name:d,arguments:m,repeatable:_,locations:v})}parseDirectiveLocations(){return this.delimitedMany(pt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const n=this._lexer.token,l=this.parseName();if(Object.prototype.hasOwnProperty.call(ti,l.value))return l;throw this.unexpected(n)}node(n,l){return this._options.noLocation!==!0&&(l.loc=new aA(n,this._lexer.lastToken,this._lexer.source)),l}peek(n){return this._lexer.token.kind===n}expectToken(n){const l=this._lexer.token;if(l.kind===n)return this.advanceLexer(),l;throw Ra(this._lexer.source,l.start,`Expected ${g2(n)}, found ${M0(l)}.`)}expectOptionalToken(n){return this._lexer.token.kind===n?(this.advanceLexer(),!0):!1}expectKeyword(n){const l=this._lexer.token;if(l.kind===pt.NAME&&l.value===n)this.advanceLexer();else throw Ra(this._lexer.source,l.start,`Expected "${n}", found ${M0(l)}.`)}expectOptionalKeyword(n){const l=this._lexer.token;return l.kind===pt.NAME&&l.value===n?(this.advanceLexer(),!0):!1}unexpected(n){const l=n??this._lexer.token;return Ra(this._lexer.source,l.start,`Unexpected ${M0(l)}.`)}any(n,l,d){this.expectToken(n);const m=[];for(;!this.expectOptionalToken(d);)m.push(l.call(this));return m}optionalMany(n,l,d){if(this.expectOptionalToken(n)){const m=[];do m.push(l.call(this));while(!this.expectOptionalToken(d));return m}return[]}many(n,l,d){this.expectToken(n);const m=[];do m.push(l.call(this));while(!this.expectOptionalToken(d));return m}delimitedMany(n,l){this.expectOptionalToken(n);const d=[];do d.push(l.call(this));while(this.expectOptionalToken(n));return d}advanceLexer(){const{maxTokens:n}=this._options,l=this._lexer.advance();if(l.kind!==pt.EOF&&(++this._tokenCounter,n!==void 0&&this._tokenCounter>n))throw Ra(this._lexer.source,l.start,`Document contains more that ${n} tokens. Parsing aborted.`)}}function M0(i){const n=i.value;return g2(i.kind)+(n!=null?` "${n}"`:"")}function g2(i){return hA(i)?`"${i}"`:i}const IA=5;function RA(i,n){const[l,d]=n?[i,n]:[void 0,i];let m=" Did you mean ";l&&(m+=l+" ");const _=d.map(C=>`"${C}"`);switch(_.length){case 0:return"";case 1:return m+_[0]+"?";case 2:return m+_[0]+" or "+_[1]+"?"}const v=_.slice(0,IA),c=v.pop();return m+v.join(", ")+", or "+c+"?"}function T1(i){return i}function y2(i,n){const l=Object.create(null);for(const d of i)l[n(d)]=d;return l}function xp(i,n,l){const d=Object.create(null);for(const m of i)d[n(m)]=l(m);return d}function cv(i,n){const l=Object.create(null);for(const d of Object.keys(i))l[d]=n(i[d],d);return l}function PA(i,n){let l=0,d=0;for(;l<i.length&&d<n.length;){let m=i.charCodeAt(l),_=n.charCodeAt(d);if(C0(m)&&C0(_)){let v=0;do++l,v=v*10+m-xb,m=i.charCodeAt(l);while(C0(m)&&v>0);let c=0;do++d,c=c*10+_-xb,_=n.charCodeAt(d);while(C0(_)&&c>0);if(v<c)return-1;if(v>c)return 1}else{if(m<_)return-1;if(m>_)return 1;++l,++d}}return i.length-n.length}const xb=48,zA=57;function C0(i){return!isNaN(i)&&xb<=i&&i<=zA}function NA(i,n){const l=Object.create(null),d=new LA(i),m=Math.floor(i.length*.4)+1;for(const _ of n){const v=d.measure(_,m);v!==void 0&&(l[_]=v)}return Object.keys(l).sort((_,v)=>{const c=l[_]-l[v];return c!==0?c:PA(_,v)})}class LA{constructor(n){this._input=n,this._inputLowerCase=n.toLowerCase(),this._inputArray=S1(this._inputLowerCase),this._rows=[new Array(n.length+1).fill(0),new Array(n.length+1).fill(0),new Array(n.length+1).fill(0)]}measure(n,l){if(this._input===n)return 0;const d=n.toLowerCase();if(this._inputLowerCase===d)return 1;let m=S1(d),_=this._inputArray;if(m.length<_.length){const N=m;m=_,_=N}const v=m.length,c=_.length;if(v-c>l)return;const C=this._rows;for(let N=0;N<=c;N++)C[0][N]=N;for(let N=1;N<=v;N++){const B=C[(N-1)%3],V=C[N%3];let G=V[0]=N;for(let ae=1;ae<=c;ae++){const me=m[N-1]===_[ae-1]?0:1;let pe=Math.min(B[ae]+1,V[ae-1]+1,B[ae-1]+me);if(N>1&&ae>1&&m[N-1]===_[ae-2]&&m[N-2]===_[ae-1]){const Ne=C[(N-2)%3][ae-2];pe=Math.min(pe,Ne+1)}pe<G&&(G=pe),V[ae]=pe}if(G>l)return}const R=C[v%3][c];return R<=l?R:void 0}}function S1(i){const n=i.length,l=new Array(n);for(let d=0;d<n;++d)l[d]=i.charCodeAt(d);return l}function Wl(i){if(i==null)return Object.create(null);if(Object.getPrototypeOf(i)===null)return i;const n=Object.create(null);for(const[l,d]of Object.entries(i))n[l]=d;return n}function OA(i){return`"${i.replace(jA,BA)}"`}const jA=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function BA(i){return FA[i.charCodeAt(0)]}const FA=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],UA=Object.freeze({});function VA(i,n,l=l2){const d=new Map;for(const Ne of Object.values(It))d.set(Ne,GA(n,Ne));let m,_=Array.isArray(i),v=[i],c=-1,C=[],R=i,N,B;const V=[],G=[];do{c++;const Ne=c===v.length,Ve=Ne&&C.length!==0;if(Ne){if(N=G.length===0?void 0:V[V.length-1],R=B,B=G.pop(),Ve)if(_){R=R.slice();let qe=0;for(const[Ae,Ke]of C){const mt=Ae-qe;Ke===null?(R.splice(mt,1),qe++):R[mt]=Ke}}else{R={...R};for(const[qe,Ae]of C)R[qe]=Ae}c=m.index,v=m.keys,C=m.edits,_=m.inArray,m=m.prev}else if(B){if(N=_?c:v[c],R=B[N],R==null)continue;V.push(N)}let Fe;if(!Array.isArray(R)){var ae,me;x1(R)||pi(!1,`Invalid AST Node: ${wn(R)}.`);const qe=Ne?(ae=d.get(R.kind))===null||ae===void 0?void 0:ae.leave:(me=d.get(R.kind))===null||me===void 0?void 0:me.enter;if(Fe=qe?.call(n,R,N,B,V,G),Fe===UA)break;if(Fe===!1){if(!Ne){V.pop();continue}}else if(Fe!==void 0&&(C.push([N,Fe]),!Ne))if(x1(Fe))R=Fe;else{V.pop();continue}}if(Fe===void 0&&Ve&&C.push([N,R]),Ne)V.pop();else{var pe;m={inArray:_,index:c,keys:v,edits:C,prev:m},_=Array.isArray(R),v=_?R:(pe=l[R.kind])!==null&&pe!==void 0?pe:[],c=-1,C=[],B&&G.push(B),B=R}}while(m!==void 0);return C.length!==0?C[C.length-1][1]:i}function GA(i,n){const l=i[n];return typeof l=="object"?l:typeof l=="function"?{enter:l,leave:void 0}:{enter:i.enter,leave:i.leave}}function sl(i){return VA(i,$A)}const ZA=80,$A={Name:{leave:i=>i.value},Variable:{leave:i=>"$"+i.name},Document:{leave:i=>Yt(i.definitions,`

`)},OperationDefinition:{leave(i){const n=Vn("(",Yt(i.variableDefinitions,", "),")"),l=Yt([i.operation,Yt([i.name,n]),Yt(i.directives," ")]," ");return(l==="query"?"":l+" ")+i.selectionSet}},VariableDefinition:{leave:({variable:i,type:n,defaultValue:l,directives:d})=>i+": "+n+Vn(" = ",l)+Vn(" ",Yt(d," "))},SelectionSet:{leave:({selections:i})=>Nc(i)},Field:{leave({alias:i,name:n,arguments:l,directives:d,selectionSet:m}){const _=Vn("",i,": ")+n;let v=_+Vn("(",Yt(l,", "),")");return v.length>ZA&&(v=_+Vn(`(
`,L0(Yt(l,`
`)),`
)`)),Yt([v,Yt(d," "),m]," ")}},Argument:{leave:({name:i,value:n})=>i+": "+n},FragmentSpread:{leave:({name:i,directives:n})=>"..."+i+Vn(" ",Yt(n," "))},InlineFragment:{leave:({typeCondition:i,directives:n,selectionSet:l})=>Yt(["...",Vn("on ",i),Yt(n," "),l]," ")},FragmentDefinition:{leave:({name:i,typeCondition:n,variableDefinitions:l,directives:d,selectionSet:m})=>`fragment ${i}${Vn("(",Yt(l,", "),")")} on ${n} ${Vn("",Yt(d," ")," ")}`+m},IntValue:{leave:({value:i})=>i},FloatValue:{leave:({value:i})=>i},StringValue:{leave:({value:i,block:n})=>n?cA(i):OA(i)},BooleanValue:{leave:({value:i})=>i?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:i})=>i},ListValue:{leave:({values:i})=>"["+Yt(i,", ")+"]"},ObjectValue:{leave:({fields:i})=>"{"+Yt(i,", ")+"}"},ObjectField:{leave:({name:i,value:n})=>i+": "+n},Directive:{leave:({name:i,arguments:n})=>"@"+i+Vn("(",Yt(n,", "),")")},NamedType:{leave:({name:i})=>i},ListType:{leave:({type:i})=>"["+i+"]"},NonNullType:{leave:({type:i})=>i+"!"},SchemaDefinition:{leave:({description:i,directives:n,operationTypes:l})=>Vn("",i,`
`)+Yt(["schema",Yt(n," "),Nc(l)]," ")},OperationTypeDefinition:{leave:({operation:i,type:n})=>i+": "+n},ScalarTypeDefinition:{leave:({description:i,name:n,directives:l})=>Vn("",i,`
`)+Yt(["scalar",n,Yt(l," ")]," ")},ObjectTypeDefinition:{leave:({description:i,name:n,interfaces:l,directives:d,fields:m})=>Vn("",i,`
`)+Yt(["type",n,Vn("implements ",Yt(l," & ")),Yt(d," "),Nc(m)]," ")},FieldDefinition:{leave:({description:i,name:n,arguments:l,type:d,directives:m})=>Vn("",i,`
`)+n+(E1(l)?Vn(`(
`,L0(Yt(l,`
`)),`
)`):Vn("(",Yt(l,", "),")"))+": "+d+Vn(" ",Yt(m," "))},InputValueDefinition:{leave:({description:i,name:n,type:l,defaultValue:d,directives:m})=>Vn("",i,`
`)+Yt([n+": "+l,Vn("= ",d),Yt(m," ")]," ")},InterfaceTypeDefinition:{leave:({description:i,name:n,interfaces:l,directives:d,fields:m})=>Vn("",i,`
`)+Yt(["interface",n,Vn("implements ",Yt(l," & ")),Yt(d," "),Nc(m)]," ")},UnionTypeDefinition:{leave:({description:i,name:n,directives:l,types:d})=>Vn("",i,`
`)+Yt(["union",n,Yt(l," "),Vn("= ",Yt(d," | "))]," ")},EnumTypeDefinition:{leave:({description:i,name:n,directives:l,values:d})=>Vn("",i,`
`)+Yt(["enum",n,Yt(l," "),Nc(d)]," ")},EnumValueDefinition:{leave:({description:i,name:n,directives:l})=>Vn("",i,`
`)+Yt([n,Yt(l," ")]," ")},InputObjectTypeDefinition:{leave:({description:i,name:n,directives:l,fields:d})=>Vn("",i,`
`)+Yt(["input",n,Yt(l," "),Nc(d)]," ")},DirectiveDefinition:{leave:({description:i,name:n,arguments:l,repeatable:d,locations:m})=>Vn("",i,`
`)+"directive @"+n+(E1(l)?Vn(`(
`,L0(Yt(l,`
`)),`
)`):Vn("(",Yt(l,", "),")"))+(d?" repeatable":"")+" on "+Yt(m," | ")},SchemaExtension:{leave:({directives:i,operationTypes:n})=>Yt(["extend schema",Yt(i," "),Nc(n)]," ")},ScalarTypeExtension:{leave:({name:i,directives:n})=>Yt(["extend scalar",i,Yt(n," ")]," ")},ObjectTypeExtension:{leave:({name:i,interfaces:n,directives:l,fields:d})=>Yt(["extend type",i,Vn("implements ",Yt(n," & ")),Yt(l," "),Nc(d)]," ")},InterfaceTypeExtension:{leave:({name:i,interfaces:n,directives:l,fields:d})=>Yt(["extend interface",i,Vn("implements ",Yt(n," & ")),Yt(l," "),Nc(d)]," ")},UnionTypeExtension:{leave:({name:i,directives:n,types:l})=>Yt(["extend union",i,Yt(n," "),Vn("= ",Yt(l," | "))]," ")},EnumTypeExtension:{leave:({name:i,directives:n,values:l})=>Yt(["extend enum",i,Yt(n," "),Nc(l)]," ")},InputObjectTypeExtension:{leave:({name:i,directives:n,fields:l})=>Yt(["extend input",i,Yt(n," "),Nc(l)]," ")}};function Yt(i,n=""){var l;return(l=i?.filter(d=>d).join(n))!==null&&l!==void 0?l:""}function Nc(i){return Vn(`{
`,L0(Yt(i,`
`)),`
}`)}function Vn(i,n,l=""){return n!=null&&n!==""?i+n+l:""}function L0(i){return Vn("  ",i.replace(/\n/g,`
  `))}function E1(i){var n;return(n=i?.some(l=>l.includes(`
`)))!==null&&n!==void 0?n:!1}function wb(i,n){switch(i.kind){case It.NULL:return null;case It.INT:return parseInt(i.value,10);case It.FLOAT:return parseFloat(i.value);case It.STRING:case It.ENUM:case It.BOOLEAN:return i.value;case It.LIST:return i.values.map(l=>wb(l,n));case It.OBJECT:return xp(i.fields,l=>l.name.value,l=>wb(l.value,n));case It.VARIABLE:return n?.[i.name.value]}}function Uc(i){if(i!=null||pi(!1,"Must provide name."),typeof i=="string"||pi(!1,"Expected name to be a string."),i.length===0)throw new Ti("Expected name to be a non-empty string.");for(let n=1;n<i.length;++n)if(!u2(i.charCodeAt(n)))throw new Ti(`Names must only contain [_a-zA-Z0-9] but "${i}" does not.`);if(!ox(i.charCodeAt(0)))throw new Ti(`Names must start with [_a-zA-Z] but "${i}" does not.`);return i}function YA(i){if(i==="true"||i==="false"||i==="null")throw new Ti(`Enum values cannot be named: ${i}`);return Uc(i)}function _2(i){return gg(i)||uf(i)||Bc(i)||Mp(i)||df(i)||Kh(i)||yf(i)||Jh(i)}function gg(i){return Gu(i,jp)}function uf(i){return Gu(i,_f)}function qA(i){if(!uf(i))throw new Error(`Expected ${wn(i)} to be a GraphQL Object type.`);return i}function Bc(i){return Gu(i,k2)}function HA(i){if(!Bc(i))throw new Error(`Expected ${wn(i)} to be a GraphQL Interface type.`);return i}function Mp(i){return Gu(i,I2)}function df(i){return Gu(i,uv)}function Kh(i){return Gu(i,R2)}function yf(i){return Gu(i,Fl)}function Jh(i){return Gu(i,Hn)}function v2(i){return gg(i)||df(i)||Kh(i)||lx(i)&&v2(i.ofType)}function b2(i){return gg(i)||uf(i)||Bc(i)||Mp(i)||df(i)||lx(i)&&b2(i.ofType)}function x2(i){return gg(i)||df(i)}function XA(i){return Bc(i)||Mp(i)}class Fl{constructor(n){_2(n)||pi(!1,`Expected ${wn(n)} to be a GraphQL type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class Hn{constructor(n){w2(n)||pi(!1,`Expected ${wn(n)} to be a GraphQL nullable type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function lx(i){return yf(i)||Jh(i)}function w2(i){return _2(i)&&!Jh(i)}function WA(i){if(!w2(i))throw new Error(`Expected ${wn(i)} to be a GraphQL nullable type.`);return i}function QA(i){if(i){let n=i;for(;lx(n);)n=n.ofType;return n}}function T2(i){return typeof i=="function"?i():i}function S2(i){return typeof i=="function"?i():i}class jp{constructor(n){var l,d,m,_;const v=(l=n.parseValue)!==null&&l!==void 0?l:T1;this.name=Uc(n.name),this.description=n.description,this.specifiedByURL=n.specifiedByURL,this.serialize=(d=n.serialize)!==null&&d!==void 0?d:T1,this.parseValue=v,this.parseLiteral=(m=n.parseLiteral)!==null&&m!==void 0?m:(c,C)=>v(wb(c,C)),this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(_=n.extensionASTNodes)!==null&&_!==void 0?_:[],n.specifiedByURL==null||typeof n.specifiedByURL=="string"||pi(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${wn(n.specifiedByURL)}.`),n.serialize==null||typeof n.serialize=="function"||pi(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),n.parseLiteral&&(typeof n.parseValue=="function"&&typeof n.parseLiteral=="function"||pi(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class _f{constructor(n){var l;this.name=Uc(n.name),this.description=n.description,this.isTypeOf=n.isTypeOf,this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._fields=()=>A2(n),this._interfaces=()=>E2(n),n.isTypeOf==null||typeof n.isTypeOf=="function"||pi(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${wn(n.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:C2(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function E2(i){var n;const l=T2((n=i.interfaces)!==null&&n!==void 0?n:[]);return Array.isArray(l)||pi(!1,`${i.name} interfaces must be an Array or a function which returns an Array.`),l}function A2(i){const n=S2(i.fields);return Qm(n)||pi(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),cv(n,(l,d)=>{var m;Qm(l)||pi(!1,`${i.name}.${d} field config must be an object.`),l.resolve==null||typeof l.resolve=="function"||pi(!1,`${i.name}.${d} field resolver must be a function if provided, but got: ${wn(l.resolve)}.`);const _=(m=l.args)!==null&&m!==void 0?m:{};return Qm(_)||pi(!1,`${i.name}.${d} args must be an object with argument names as keys.`),{name:Uc(d),description:l.description,type:l.type,args:M2(_),resolve:l.resolve,subscribe:l.subscribe,deprecationReason:l.deprecationReason,extensions:Wl(l.extensions),astNode:l.astNode}})}function M2(i){return Object.entries(i).map(([n,l])=>({name:Uc(n),description:l.description,type:l.type,defaultValue:l.defaultValue,deprecationReason:l.deprecationReason,extensions:Wl(l.extensions),astNode:l.astNode}))}function Qm(i){return sd(i)&&!Array.isArray(i)}function C2(i){return cv(i,n=>({description:n.description,type:n.type,args:D2(n.args),resolve:n.resolve,subscribe:n.subscribe,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function D2(i){return xp(i,n=>n.name,n=>({description:n.description,type:n.type,defaultValue:n.defaultValue,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}class k2{constructor(n){var l;this.name=Uc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._fields=A2.bind(void 0,n),this._interfaces=E2.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||pi(!1,`${this.name} must provide "resolveType" as a function, but got: ${wn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:C2(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class I2{constructor(n){var l;this.name=Uc(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._types=KA.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||pi(!1,`${this.name} must provide "resolveType" as a function, but got: ${wn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function KA(i){const n=T2(i.types);return Array.isArray(n)||pi(!1,`Must provide Array of types or a function which returns such an array for Union ${i.name}.`),n}class uv{constructor(n){var l;this.name=Uc(n.name),this.description=n.description,this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._values=typeof n.values=="function"?n.values:A1(this.name,n.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=A1(this.name,this._values())),this._values}getValue(n){return this._nameLookup===null&&(this._nameLookup=y2(this.getValues(),l=>l.name)),this._nameLookup[n]}serialize(n){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(d=>[d.value,d])));const l=this._valueLookup.get(n);if(l===void 0)throw new Ti(`Enum "${this.name}" cannot represent value: ${wn(n)}`);return l.name}parseValue(n){if(typeof n!="string"){const d=wn(n);throw new Ti(`Enum "${this.name}" cannot represent non-string value: ${d}.`+D0(this,d))}const l=this.getValue(n);if(l==null)throw new Ti(`Value "${n}" does not exist in "${this.name}" enum.`+D0(this,n));return l.value}parseLiteral(n,l){if(n.kind!==It.ENUM){const m=sl(n);throw new Ti(`Enum "${this.name}" cannot represent non-enum value: ${m}.`+D0(this,m),{nodes:n})}const d=this.getValue(n.value);if(d==null){const m=sl(n);throw new Ti(`Value "${m}" does not exist in "${this.name}" enum.`+D0(this,m),{nodes:n})}return d.value}toConfig(){const n=xp(this.getValues(),l=>l.name,l=>({description:l.description,value:l.value,deprecationReason:l.deprecationReason,extensions:l.extensions,astNode:l.astNode}));return{name:this.name,description:this.description,values:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function D0(i,n){const l=i.getValues().map(m=>m.name),d=NA(n,l);return RA("the enum value",d)}function A1(i,n){return Qm(n)||pi(!1,`${i} values must be an object with value names as keys.`),Object.entries(n).map(([l,d])=>(Qm(d)||pi(!1,`${i}.${l} must refer to an object with a "value" key representing an internal value but got: ${wn(d)}.`),{name:YA(l),description:d.description,value:d.value!==void 0?d.value:l,deprecationReason:d.deprecationReason,extensions:Wl(d.extensions),astNode:d.astNode}))}class R2{constructor(n){var l,d;this.name=Uc(n.name),this.description=n.description,this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this.isOneOf=(d=n.isOneOf)!==null&&d!==void 0?d:!1,this._fields=JA.bind(void 0,n)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const n=cv(this.getFields(),l=>({description:l.description,type:l.type,defaultValue:l.defaultValue,deprecationReason:l.deprecationReason,extensions:l.extensions,astNode:l.astNode}));return{name:this.name,description:this.description,fields:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function JA(i){const n=S2(i.fields);return Qm(n)||pi(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),cv(n,(l,d)=>(!("resolve"in l)||pi(!1,`${i.name}.${d} field has a resolve property, but Input Types cannot define resolvers.`),{name:Uc(d),description:l.description,type:l.type,defaultValue:l.defaultValue,deprecationReason:l.deprecationReason,extensions:Wl(l.extensions),astNode:l.astNode}))}const Qv=2147483647,Kv=-2147483648,eM=new jp({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(i){const n=u_(i);if(typeof n=="boolean")return n?1:0;let l=n;if(typeof n=="string"&&n!==""&&(l=Number(n)),typeof l!="number"||!Number.isInteger(l))throw new Ti(`Int cannot represent non-integer value: ${wn(n)}`);if(l>Qv||l<Kv)throw new Ti("Int cannot represent non 32-bit signed integer value: "+wn(n));return l},parseValue(i){if(typeof i!="number"||!Number.isInteger(i))throw new Ti(`Int cannot represent non-integer value: ${wn(i)}`);if(i>Qv||i<Kv)throw new Ti(`Int cannot represent non 32-bit signed integer value: ${i}`);return i},parseLiteral(i){if(i.kind!==It.INT)throw new Ti(`Int cannot represent non-integer value: ${sl(i)}`,{nodes:i});const n=parseInt(i.value,10);if(n>Qv||n<Kv)throw new Ti(`Int cannot represent non 32-bit signed integer value: ${i.value}`,{nodes:i});return n}}),tM=new jp({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(i){const n=u_(i);if(typeof n=="boolean")return n?1:0;let l=n;if(typeof n=="string"&&n!==""&&(l=Number(n)),typeof l!="number"||!Number.isFinite(l))throw new Ti(`Float cannot represent non numeric value: ${wn(n)}`);return l},parseValue(i){if(typeof i!="number"||!Number.isFinite(i))throw new Ti(`Float cannot represent non numeric value: ${wn(i)}`);return i},parseLiteral(i){if(i.kind!==It.FLOAT&&i.kind!==It.INT)throw new Ti(`Float cannot represent non numeric value: ${sl(i)}`,i);return parseFloat(i.value)}}),$r=new jp({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(i){const n=u_(i);if(typeof n=="string")return n;if(typeof n=="boolean")return n?"true":"false";if(typeof n=="number"&&Number.isFinite(n))return n.toString();throw new Ti(`String cannot represent value: ${wn(i)}`)},parseValue(i){if(typeof i!="string")throw new Ti(`String cannot represent a non string value: ${wn(i)}`);return i},parseLiteral(i){if(i.kind!==It.STRING)throw new Ti(`String cannot represent a non string value: ${sl(i)}`,{nodes:i});return i.value}}),il=new jp({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(i){const n=u_(i);if(typeof n=="boolean")return n;if(Number.isFinite(n))return n!==0;throw new Ti(`Boolean cannot represent a non boolean value: ${wn(n)}`)},parseValue(i){if(typeof i!="boolean")throw new Ti(`Boolean cannot represent a non boolean value: ${wn(i)}`);return i},parseLiteral(i){if(i.kind!==It.BOOLEAN)throw new Ti(`Boolean cannot represent a non boolean value: ${sl(i)}`,{nodes:i});return i.value}}),P2=new jp({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(i){const n=u_(i);if(typeof n=="string")return n;if(Number.isInteger(n))return String(n);throw new Ti(`ID cannot represent value: ${wn(i)}`)},parseValue(i){if(typeof i=="string")return i;if(typeof i=="number"&&Number.isInteger(i))return i.toString();throw new Ti(`ID cannot represent value: ${wn(i)}`)},parseLiteral(i){if(i.kind!==It.STRING&&i.kind!==It.INT)throw new Ti("ID cannot represent a non-string and non-integer value: "+sl(i),{nodes:i});return i.value}}),nM=Object.freeze([$r,eM,tM,il,P2]);function u_(i){if(sd(i)){if(typeof i.valueOf=="function"){const n=i.valueOf();if(!sd(n))return n}if(typeof i.toJSON=="function")return i.toJSON()}return i}function iM(i){return Gu(i,Bp)}class Bp{constructor(n){var l,d;this.name=Uc(n.name),this.description=n.description,this.locations=n.locations,this.isRepeatable=(l=n.isRepeatable)!==null&&l!==void 0?l:!1,this.extensions=Wl(n.extensions),this.astNode=n.astNode,Array.isArray(n.locations)||pi(!1,`@${n.name} locations must be an Array.`);const m=(d=n.args)!==null&&d!==void 0?d:{};sd(m)&&!Array.isArray(m)||pi(!1,`@${n.name} args must be an object with argument names as keys.`),this.args=M2(m)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:D2(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const rM=new Bp({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[ti.FIELD,ti.FRAGMENT_SPREAD,ti.INLINE_FRAGMENT],args:{if:{type:new Hn(il),description:"Included when true."}}}),aM=new Bp({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[ti.FIELD,ti.FRAGMENT_SPREAD,ti.INLINE_FRAGMENT],args:{if:{type:new Hn(il),description:"Skipped when true."}}}),sM="No longer supported",oM=new Bp({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[ti.FIELD_DEFINITION,ti.ARGUMENT_DEFINITION,ti.INPUT_FIELD_DEFINITION,ti.ENUM_VALUE],args:{reason:{type:$r,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:sM}}}),lM=new Bp({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[ti.SCALAR],args:{url:{type:new Hn($r),description:"The URL that specifies the behavior of this scalar."}}}),cM=new Bp({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[ti.INPUT_OBJECT],args:{}}),uM=Object.freeze([rM,aM,oM,lM,cM]);function hM(i){return typeof i=="object"&&typeof i?.[Symbol.iterator]=="function"}function Cy(i,n){if(Jh(n)){const l=Cy(i,n.ofType);return l?.kind===It.NULL?null:l}if(i===null)return{kind:It.NULL};if(i===void 0)return null;if(yf(n)){const l=n.ofType;if(hM(i)){const d=[];for(const m of i){const _=Cy(m,l);_!=null&&d.push(_)}return{kind:It.LIST,values:d}}return Cy(i,l)}if(Kh(n)){if(!sd(i))return null;const l=[];for(const d of Object.values(n.getFields())){const m=Cy(i[d.name],d.type);m&&l.push({kind:It.OBJECT_FIELD,name:{kind:It.NAME,value:d.name},value:m})}return{kind:It.OBJECT,fields:l}}if(x2(n)){const l=n.serialize(i);if(l==null)return null;if(typeof l=="boolean")return{kind:It.BOOLEAN,value:l};if(typeof l=="number"&&Number.isFinite(l)){const d=String(l);return M1.test(d)?{kind:It.INT,value:d}:{kind:It.FLOAT,value:d}}if(typeof l=="string")return df(n)?{kind:It.ENUM,value:l}:n===P2&&M1.test(l)?{kind:It.INT,value:l}:{kind:It.STRING,value:l};throw new TypeError(`Cannot convert value to AST: ${wn(l)}.`)}sv(!1,"Unexpected input type: "+wn(n))}const M1=/^-?(?:0|[1-9][0-9]*)$/,cx=new _f({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:$r,resolve:i=>i.description},types:{description:"A list of all types supported by this server.",type:new Hn(new Fl(new Hn(Pu))),resolve(i){return Object.values(i.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new Hn(Pu),resolve:i=>i.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:Pu,resolve:i=>i.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:Pu,resolve:i=>i.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new Hn(new Fl(new Hn(z2))),resolve:i=>i.getDirectives()}})}),z2=new _f({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new Hn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},isRepeatable:{type:new Hn(il),resolve:i=>i.isRepeatable},locations:{type:new Hn(new Fl(new Hn(N2))),resolve:i=>i.locations},args:{type:new Hn(new Fl(new Hn(hv))),args:{includeDeprecated:{type:il,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(l=>l.deprecationReason==null)}}})}),N2=new uv({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:ti.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:ti.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:ti.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:ti.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:ti.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:ti.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:ti.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:ti.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:ti.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:ti.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:ti.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:ti.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:ti.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:ti.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:ti.UNION,description:"Location adjacent to a union definition."},ENUM:{value:ti.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:ti.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:ti.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:ti.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),Pu=new _f({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new Hn(j2),resolve(i){if(gg(i))return $i.SCALAR;if(uf(i))return $i.OBJECT;if(Bc(i))return $i.INTERFACE;if(Mp(i))return $i.UNION;if(df(i))return $i.ENUM;if(Kh(i))return $i.INPUT_OBJECT;if(yf(i))return $i.LIST;if(Jh(i))return $i.NON_NULL;sv(!1,`Unexpected type: "${wn(i)}".`)}},name:{type:$r,resolve:i=>"name"in i?i.name:void 0},description:{type:$r,resolve:i=>"description"in i?i.description:void 0},specifiedByURL:{type:$r,resolve:i=>"specifiedByURL"in i?i.specifiedByURL:void 0},fields:{type:new Fl(new Hn(L2)),args:{includeDeprecated:{type:il,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(uf(i)||Bc(i)){const l=Object.values(i.getFields());return n?l:l.filter(d=>d.deprecationReason==null)}}},interfaces:{type:new Fl(new Hn(Pu)),resolve(i){if(uf(i)||Bc(i))return i.getInterfaces()}},possibleTypes:{type:new Fl(new Hn(Pu)),resolve(i,n,l,{schema:d}){if(XA(i))return d.getPossibleTypes(i)}},enumValues:{type:new Fl(new Hn(O2)),args:{includeDeprecated:{type:il,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(df(i)){const l=i.getValues();return n?l:l.filter(d=>d.deprecationReason==null)}}},inputFields:{type:new Fl(new Hn(hv)),args:{includeDeprecated:{type:il,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(Kh(i)){const l=Object.values(i.getFields());return n?l:l.filter(d=>d.deprecationReason==null)}}},ofType:{type:Pu,resolve:i=>"ofType"in i?i.ofType:void 0},isOneOf:{type:il,resolve:i=>{if(Kh(i))return i.isOneOf}}})}),L2=new _f({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new Hn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},args:{type:new Hn(new Fl(new Hn(hv))),args:{includeDeprecated:{type:il,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(l=>l.deprecationReason==null)}},type:{type:new Hn(Pu),resolve:i=>i.type},isDeprecated:{type:new Hn(il),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:$r,resolve:i=>i.deprecationReason}})}),hv=new _f({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new Hn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},type:{type:new Hn(Pu),resolve:i=>i.type},defaultValue:{type:$r,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(i){const{type:n,defaultValue:l}=i,d=Cy(l,n);return d?sl(d):null}},isDeprecated:{type:new Hn(il),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:$r,resolve:i=>i.deprecationReason}})}),O2=new _f({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new Hn($r),resolve:i=>i.name},description:{type:$r,resolve:i=>i.description},isDeprecated:{type:new Hn(il),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:$r,resolve:i=>i.deprecationReason}})});var $i;(function(i){i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.INPUT_OBJECT="INPUT_OBJECT",i.LIST="LIST",i.NON_NULL="NON_NULL"})($i||($i={}));const j2=new uv({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:$i.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:$i.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:$i.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:$i.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:$i.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:$i.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:$i.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:$i.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new Hn(cx);new Hn($r);new Hn($r);const dM=Object.freeze([cx,z2,N2,Pu,L2,hv,O2,j2]);class fM{constructor(n){var l,d;this.__validationErrors=n.assumeValid===!0?[]:void 0,sd(n)||pi(!1,"Must provide configuration object."),!n.types||Array.isArray(n.types)||pi(!1,`"types" must be Array if provided but got: ${wn(n.types)}.`),!n.directives||Array.isArray(n.directives)||pi(!1,`"directives" must be Array if provided but got: ${wn(n.directives)}.`),this.description=n.description,this.extensions=Wl(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(l=n.extensionASTNodes)!==null&&l!==void 0?l:[],this._queryType=n.query,this._mutationType=n.mutation,this._subscriptionType=n.subscription,this._directives=(d=n.directives)!==null&&d!==void 0?d:uM;const m=new Set(n.types);if(n.types!=null)for(const _ of n.types)m.delete(_),Oc(_,m);this._queryType!=null&&Oc(this._queryType,m),this._mutationType!=null&&Oc(this._mutationType,m),this._subscriptionType!=null&&Oc(this._subscriptionType,m);for(const _ of this._directives)if(iM(_))for(const v of _.args)Oc(v.type,m);Oc(cx,m),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const _ of m){if(_==null)continue;const v=_.name;if(v||pi(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[v]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${v}".`);if(this._typeMap[v]=_,Bc(_)){for(const c of _.getInterfaces())if(Bc(c)){let C=this._implementationsMap[c.name];C===void 0&&(C=this._implementationsMap[c.name]={objects:[],interfaces:[]}),C.interfaces.push(_)}}else if(uf(_)){for(const c of _.getInterfaces())if(Bc(c)){let C=this._implementationsMap[c.name];C===void 0&&(C=this._implementationsMap[c.name]={objects:[],interfaces:[]}),C.objects.push(_)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(n){switch(n){case Hh.QUERY:return this.getQueryType();case Hh.MUTATION:return this.getMutationType();case Hh.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(n){return this.getTypeMap()[n]}getPossibleTypes(n){return Mp(n)?n.getTypes():this.getImplementations(n).objects}getImplementations(n){const l=this._implementationsMap[n.name];return l??{objects:[],interfaces:[]}}isSubType(n,l){let d=this._subTypeMap[n.name];if(d===void 0){if(d=Object.create(null),Mp(n))for(const m of n.getTypes())d[m.name]=!0;else{const m=this.getImplementations(n);for(const _ of m.objects)d[_.name]=!0;for(const _ of m.interfaces)d[_.name]=!0}this._subTypeMap[n.name]=d}return d[l.name]!==void 0}getDirectives(){return this._directives}getDirective(n){return this.getDirectives().find(l=>l.name===n)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function Oc(i,n){const l=QA(i);if(!n.has(l)){if(n.add(l),Mp(l))for(const d of l.getTypes())Oc(d,n);else if(uf(l)||Bc(l)){for(const d of l.getInterfaces())Oc(d,n);for(const d of Object.values(l.getFields())){Oc(d.type,n);for(const m of d.args)Oc(m.type,n)}}else if(Kh(l))for(const d of Object.values(l.getFields()))Oc(d.type,n)}return n}function Dy(i,n,l){if(i){if(i.kind===It.VARIABLE){i.name.value;return}if(Jh(n))return i.kind===It.NULL?void 0:Dy(i,n.ofType,l);if(i.kind===It.NULL)return null;if(yf(n)){const d=n.ofType;if(i.kind===It.LIST){const _=[];for(const v of i.values)if(C1(v,l)){if(Jh(d))return;_.push(null)}else{const c=Dy(v,d,l);if(c===void 0)return;_.push(c)}return _}const m=Dy(i,d,l);return m===void 0?void 0:[m]}if(Kh(n)){if(i.kind!==It.OBJECT)return;const d=Object.create(null),m=y2(i.fields,_=>_.name.value);for(const _ of Object.values(n.getFields())){const v=m[_.name];if(!v||C1(v.value,l)){if(_.defaultValue!==void 0)d[_.name]=_.defaultValue;else if(Jh(_.type))return;continue}const c=Dy(v.value,_.type,l);if(c===void 0)return;d[_.name]=c}if(n.isOneOf){const _=Object.keys(d);if(_.length!==1||d[_[0]]===null)return}return d}if(x2(n)){let d;try{d=n.parseLiteral(i,l)}catch{return}return d===void 0?void 0:d}sv(!1,"Unexpected input type: "+wn(n))}}function C1(i,n){return i.kind===It.VARIABLE&&n==null}function pM(i){const n={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...i},l=n.descriptions?"description":"",d=n.specifiedByUrl?"specifiedByURL":"",m=n.directiveIsRepeatable?"isRepeatable":"",_=n.schemaDescription?l:"";function v(C){return n.inputValueDeprecation?C:""}const c=n.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${_}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${l}
          ${m}
          locations
          args${v("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${l}
      ${d}
      ${c}
      fields(includeDeprecated: true) {
        name
        ${l}
        args${v("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${v("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${l}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${l}
      type { ...TypeRef }
      defaultValue
      ${v("isDeprecated")}
      ${v("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function mM(i,n){sd(i)&&sd(i.__schema)||pi(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${wn(i)}.`);const l=i.__schema,d=xp(l.types,Pe=>Pe.name,Pe=>V(Pe));for(const Pe of[...nM,...dM])d[Pe.name]&&(d[Pe.name]=Pe);const m=l.queryType?N(l.queryType):null,_=l.mutationType?N(l.mutationType):null,v=l.subscriptionType?N(l.subscriptionType):null,c=l.directives?l.directives.map(st):[];return new fM({description:l.description,query:m,mutation:_,subscription:v,types:Object.values(d),directives:c,assumeValid:void 0});function C(Pe){if(Pe.kind===$i.LIST){const rt=Pe.ofType;if(!rt)throw new Error("Decorated type deeper than introspection query.");return new Fl(C(rt))}if(Pe.kind===$i.NON_NULL){const rt=Pe.ofType;if(!rt)throw new Error("Decorated type deeper than introspection query.");const Mt=C(rt);return new Hn(WA(Mt))}return R(Pe)}function R(Pe){const rt=Pe.name;if(!rt)throw new Error(`Unknown type reference: ${wn(Pe)}.`);const Mt=d[rt];if(!Mt)throw new Error(`Invalid or incomplete schema, unknown type: ${rt}. Ensure that a full introspection query is used in order to build a client schema.`);return Mt}function N(Pe){return qA(R(Pe))}function B(Pe){return HA(R(Pe))}function V(Pe){if(Pe!=null&&Pe.name!=null&&Pe.kind!=null)switch(Pe.kind){case $i.SCALAR:return G(Pe);case $i.OBJECT:return me(Pe);case $i.INTERFACE:return pe(Pe);case $i.UNION:return Ne(Pe);case $i.ENUM:return Ve(Pe);case $i.INPUT_OBJECT:return Fe(Pe)}const rt=wn(Pe);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${rt}.`)}function G(Pe){return new jp({name:Pe.name,description:Pe.description,specifiedByURL:Pe.specifiedByURL})}function ae(Pe){if(Pe.interfaces===null&&Pe.kind===$i.INTERFACE)return[];if(!Pe.interfaces){const rt=wn(Pe);throw new Error(`Introspection result missing interfaces: ${rt}.`)}return Pe.interfaces.map(B)}function me(Pe){return new _f({name:Pe.name,description:Pe.description,interfaces:()=>ae(Pe),fields:()=>qe(Pe)})}function pe(Pe){return new k2({name:Pe.name,description:Pe.description,interfaces:()=>ae(Pe),fields:()=>qe(Pe)})}function Ne(Pe){if(!Pe.possibleTypes){const rt=wn(Pe);throw new Error(`Introspection result missing possibleTypes: ${rt}.`)}return new I2({name:Pe.name,description:Pe.description,types:()=>Pe.possibleTypes.map(N)})}function Ve(Pe){if(!Pe.enumValues){const rt=wn(Pe);throw new Error(`Introspection result missing enumValues: ${rt}.`)}return new uv({name:Pe.name,description:Pe.description,values:xp(Pe.enumValues,rt=>rt.name,rt=>({description:rt.description,deprecationReason:rt.deprecationReason}))})}function Fe(Pe){if(!Pe.inputFields){const rt=wn(Pe);throw new Error(`Introspection result missing inputFields: ${rt}.`)}return new R2({name:Pe.name,description:Pe.description,fields:()=>Ke(Pe.inputFields),isOneOf:Pe.isOneOf})}function qe(Pe){if(!Pe.fields)throw new Error(`Introspection result missing fields: ${wn(Pe)}.`);return xp(Pe.fields,rt=>rt.name,Ae)}function Ae(Pe){const rt=C(Pe.type);if(!b2(rt)){const Mt=wn(rt);throw new Error(`Introspection must provide output type for fields, but received: ${Mt}.`)}if(!Pe.args){const Mt=wn(Pe);throw new Error(`Introspection result missing field args: ${Mt}.`)}return{description:Pe.description,deprecationReason:Pe.deprecationReason,type:rt,args:Ke(Pe.args)}}function Ke(Pe){return xp(Pe,rt=>rt.name,mt)}function mt(Pe){const rt=C(Pe.type);if(!v2(rt)){const Rt=wn(rt);throw new Error(`Introspection must provide input type for arguments, but received: ${Rt}.`)}const Mt=Pe.defaultValue!=null?Dy(kA(Pe.defaultValue),rt):void 0;return{description:Pe.description,type:rt,defaultValue:Mt,deprecationReason:Pe.deprecationReason}}function st(Pe){if(!Pe.args){const rt=wn(Pe);throw new Error(`Introspection result missing directive args: ${rt}.`)}if(!Pe.locations){const rt=wn(Pe);throw new Error(`Introspection result missing directive locations: ${rt}.`)}return new Bp({name:Pe.name,description:Pe.description,isRepeatable:Pe.isRepeatable,locations:Pe.locations.slice(),args:Ke(Pe.args)})}}const D1="Accept",Tb="Content-Type",Sb="application/json",B2="application/graphql-response+json",k1=i=>i.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),gM=i=>{const n=i.toLowerCase();return n.includes(B2)||n.includes(Sb)},I1=i=>{try{if(Array.isArray(i))return{_tag:"Batch",executionResults:i.map(R1)};if(N0(i))return{_tag:"Single",executionResult:R1(i)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(i)}`)}catch(n){return n}},R1=i=>{if(typeof i!="object"||i===null)throw new Error("Invalid execution result: result is not object");let n,l,d;if("errors"in i){if(!N0(i.errors)&&!Array.isArray(i.errors))throw new Error("Invalid execution result: errors is not plain object OR array");n=i.errors}if("data"in i){if(!N0(i.data)&&i.data!==null)throw new Error("Invalid execution result: data is not plain object");l=i.data}if("extensions"in i){if(!N0(i.extensions))throw new Error("Invalid execution result: extensions is not plain object");d=i.extensions}return{data:l,errors:n,extensions:d}},yM=i=>i._tag==="Batch"?i.executionResults.some(P1):P1(i.executionResult),P1=i=>Array.isArray(i.errors)?i.errors.length>0:!!i.errors,F2=i=>typeof i=="object"&&i!==null&&"kind"in i&&i.kind===It.OPERATION_DEFINITION,_M=i=>{let n;const l=i.definitions.filter(F2);return l.length===1&&(n=l[0].name?.value),n},vM=i=>{let n=!1;const l=i.definitions.filter(F2);return l.length===1&&(n=l[0].operation==="mutation"),n},Jv=(i,n)=>{const l=typeof i=="string"?i:sl(i);let d=!1,m;if(n)return{expression:l,isMutation:d,operationName:m};const _=KE(()=>typeof i=="string"?DA(i):i);return _ instanceof Error?{expression:l,isMutation:d,operationName:m}:(m=_M(_),d=vM(_),{expression:l,operationName:m,isMutation:d})},ux=JSON,eb=async i=>{const n={...i,method:i.request._tag==="Single"?i.request.document.isMutation?"POST":y1(i.method??"post"):i.request.hasMutations?"POST":y1(i.method??"post"),fetchOptions:{...i.fetchOptions,errorPolicy:i.fetchOptions.errorPolicy??"none"}},d=await xM(n.method)(n);if(!d.ok)return new Wm({status:d.status,headers:d.headers},{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables});const m=await bM(d,i.fetchOptions.jsonSerializer??ux);if(m instanceof Error)throw m;const _={status:d.status,headers:d.headers};if(yM(m)&&n.fetchOptions.errorPolicy==="none"){const v=m._tag==="Batch"?{...m.executionResults,..._}:{...m.executionResult,..._};return new Wm(v,{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables})}switch(m._tag){case"Single":return{..._,...z1(n)(m.executionResult)};case"Batch":return{..._,data:m.executionResults.map(z1(n))};default:sx(m)}},z1=i=>n=>({extensions:n.extensions,data:n.data,errors:i.fetchOptions.errorPolicy==="all"?n.errors:void 0}),bM=async(i,n)=>{const l=i.headers.get(Tb),d=await i.text();return l&&gM(l)?I1(n.parse(d)):I1(d)},xM=i=>async n=>{const l=new Headers(n.headers);let d=null,m;l.has(D1)||l.set(D1,[B2,Sb].join(", ")),i==="POST"?(m=(n.fetchOptions.jsonSerializer??ux).stringify(wM(n)),typeof m=="string"&&!l.has(Tb)&&l.set(Tb,Sb)):d=TM(n);const _={method:i,headers:l,body:m,...n.fetchOptions};let v=new URL(n.url),c=_;if(n.middleware){const R=await Promise.resolve(n.middleware({..._,url:n.url,operationName:n.request._tag==="Single"?n.request.document.operationName:void 0,variables:n.request.variables})),{url:N,...B}=R;v=new URL(N),c=B}return d&&d.forEach((R,N)=>{v.searchParams.append(N,R)}),await(n.fetch??fetch)(v,c)},wM=i=>{switch(i.request._tag){case"Single":return{query:i.request.document.expression,variables:i.request.variables,operationName:i.request.document.operationName};case"Batch":return a2(i.request.query,i.request.variables??[]).map(([n,l])=>({query:n,variables:l}));default:throw sx(i.request)}},TM=i=>{const n=i.fetchOptions.jsonSerializer??ux,l=new URLSearchParams;switch(i.request._tag){case"Single":return l.append("query",k1(i.request.document.expression)),i.request.variables&&l.append("variables",n.stringify(i.request.variables)),i.request.document.operationName&&l.append("operationName",i.request.document.operationName),l;case"Batch":{const d=i.request.variables?.map(v=>n.stringify(v))??[],m=i.request.query.map(k1),_=a2(m,d).map(([v,c])=>({query:v,variables:c}));return l.append("query",n.stringify(_)),l}default:throw sx(i.request)}};class SM{url;requestConfig;constructor(n,l={}){this.url=n,this.requestConfig=l}rawRequest=async(...n)=>{const[l,d,m]=n,_=tA(l,d,m),{headers:v,fetch:c=globalThis.fetch,method:C="POST",requestMiddleware:R,responseMiddleware:N,excludeOperationName:B,...V}=this.requestConfig,{url:G}=this;_.signal!==void 0&&(V.signal=_.signal);const ae=Jv(_.query,B),me=await eb({url:G,request:{_tag:"Single",document:ae,variables:_.variables},headers:{...Bm(Xv(v)),...Bm(_.requestHeaders)},fetch:c,method:C,fetchOptions:V,middleware:R});if(N&&await N(me,{operationName:ae.operationName,variables:d,url:this.url}),me instanceof Error)throw me;return me};async request(n,...l){const[d,m]=l,_=EM(n,d,m),{headers:v,fetch:c=globalThis.fetch,method:C="POST",requestMiddleware:R,responseMiddleware:N,excludeOperationName:B,...V}=this.requestConfig,{url:G}=this;_.signal!==void 0&&(V.signal=_.signal);const ae=Jv(_.document,B),me=await eb({url:G,request:{_tag:"Single",document:ae,variables:_.variables},headers:{...Bm(Xv(v)),...Bm(_.requestHeaders)},fetch:c,method:C,fetchOptions:V,middleware:R});if(N&&await N(me,{operationName:ae.operationName,variables:_.variables,url:this.url}),me instanceof Error)throw me;return me.data}async batchRequests(n,l){const d=eA(n,l),{headers:m,excludeOperationName:_,...v}=this.requestConfig;d.signal!==void 0&&(v.signal=d.signal);const c=d.documents.map(({document:V})=>Jv(V,_)),C=c.map(({expression:V})=>V),R=c.some(({isMutation:V})=>V),N=d.documents.map(({variables:V})=>V),B=await eb({url:this.url,request:{_tag:"Batch",operationName:void 0,query:C,hasMutations:R,variables:N},headers:{...Bm(Xv(m)),...Bm(d.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:v,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(B,{operationName:void 0,variables:N,url:this.url}),B instanceof Error)throw B;return B.data}setHeaders(n){return this.requestConfig.headers=n,this}setHeader(n,l){const{headers:d}=this.requestConfig;return d?d[n]=l:this.requestConfig.headers={[n]:l},this}setEndpoint(n){return this.url=n,this}}async function V0(i,n,...l){const d=AM(i,n,...l);return new SM(d.url).request({...d})}const EM=(i,n,l)=>i.document?i:{document:i,variables:n,requestHeaders:l,signal:void 0},AM=(i,n,...l)=>{const[d,m]=l;return typeof i=="string"?{url:i,document:n,variables:d,requestHeaders:m,signal:void 0}:i},tb="/otp/transmodel/v3",Wy=()=>{try{return new URL(tb),tb}catch{return`${window.location.origin}${tb}`}};var U2=(i=>(i.LimitToNumOfItineraries="limitToNumOfItineraries",i.LimitToSearchWindow="limitToSearchWindow",i.ListAll="listAll",i.Off="off",i))(U2||{}),wi=(i=>(i.Air="air",i.Bicycle="bicycle",i.Bus="bus",i.Cableway="cableway",i.Car="car",i.Coach="coach",i.Foot="foot",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Scooter="scooter",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Water="water",i))(wi||{}),tg=(i=>(i.Bicycle="bicycle",i.BikePark="bike_park",i.BikeRental="bike_rental",i.Car="car",i.CarPark="car_park",i.CarPickup="car_pickup",i.CarRental="car_rental",i.Flexible="flexible",i.Foot="foot",i.ScooterRental="scooter_rental",i))(tg||{}),V2=(i=>(i.Air="air",i.Bus="bus",i.Cableway="cableway",i.Coach="coach",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Unknown="unknown",i.Water="water",i))(V2||{});const MM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},CM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},DM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},kM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},IM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},RM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"generalizedCost"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},PM={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":MM,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":CM,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":DM,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":kM,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":IM,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        generalizedCost\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            generalizedCost\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":RM};function yg(i){return PM[i]??{}}const zM=yg(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),NM=i=>{const[n,l]=ce.useState(null);return ce.useEffect(()=>{(async()=>{if(i.place){const m={id:i.place};try{l(await V0(Wy(),zM,m))}catch(_){console.error("Error at useQuayCoordinateQuery",_)}}else l(null)})()},[i]),n?.quay};function N1(i){const n=NM(i);if(n){const{latitude:l,longitude:d}=n;if(l&&d)return{latitude:l,longitude:d}}if(i.coordinates)return{...i.coordinates}}function LM({setCursor:i,tripQueryVariables:n,setTripQueryVariables:l,loading:d}){const m=N1(n.from),_=N1(n.to);return ie.jsxs(ie.Fragment,{children:[m&&ie.jsx(p1,{draggable:!0,latitude:m.latitude,longitude:m.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),d||l({...n,from:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:ie.jsx("img",{alt:"",src:XE,height:48,width:49})}),_&&ie.jsx(p1,{draggable:!0,latitude:_.latitude,longitude:_.longitude,onDragStart:()=>i("grabbing"),onDragEnd:v=>{i("auto"),d||l({...n,to:{coordinates:{latitude:v.lngLat.lat,longitude:v.lngLat.lng}}})},anchor:"bottom-right",children:ie.jsx("img",{alt:"",src:WE,height:48,width:49})})]})}var OM=function(i,n){for(var l=Math.pow(10,n),d=i.length,m=new Array(Math.floor(i.length/2)),_=0,v=0,c=0,C=0;_<d;++C){var R=1,N=0,B=void 0;do B=i.charCodeAt(_++)-63-1,R+=B<<N,N+=5;while(B>=31);v+=R&1?~(R>>1):R>>1,R=1,N=0;do B=i.charCodeAt(_++)-63-1,R+=B<<N,N+=5;while(B>=31);c+=R&1?~(R>>1):R>>1,m[C]=[v/l,c/l]}return m.length=C,m};const jM=function(i){return i===wi.Foot?"#191616":i===wi.Bicycle?"#5076D9":i===wi.Scooter?"#14b7ca":i===wi.Car?"#7e7e7e":i===wi.Rail?"#86BF8B":i===wi.Coach?"#25642A":i===wi.Metro?"#D9B250":i===wi.Bus?"#fe0000":i===wi.Tram?"#D9B250":i===wi.Trolleybus?"#25642A":i===wi.Water||i===wi.Air||i===wi.Cableway||i===wi.Funicular||i===wi.Monorail||i===wi.Taxi?"#81304C":"#aaa"},G2=function(i){return i.line?.presentation?.colour?`#${i.line.presentation.colour}`:jM(i.mode)};function BM({tripPattern:i}){return ie.jsx(ie.Fragment,{children:i?.legs.map((n,l)=>n.pointsOnLink&&ie.jsxs(GE,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:OM(n.pointsOnLink.points,5).map(d=>d.reverse())}},children:[ie.jsx(m1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),ie.jsx(m1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":G2(n),"line-width":4}})]},n.id||`footleg_${l}`))})}const Z2=(i,n,l)=>({...i,[l]:{coordinates:{latitude:n.lat,longitude:n.lng}}}),FM=(i,n)=>Z2(i,n,"from"),UM=(i,n)=>Z2(i,n,"to");function VM({tripQueryVariables:i,setTripQueryVariables:n}){return ce.useCallback(l=>{l.preventDefault(),i.from.coordinates?n(UM(i,l.lngLat)):n(FM(i,l.lngLat))},[i,n])}var nb={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var L1;function GM(){return L1||(L1=1,function(i){(function(){var n={}.hasOwnProperty;function l(){for(var _="",v=0;v<arguments.length;v++){var c=arguments[v];c&&(_=m(_,d(c)))}return _}function d(_){if(typeof _=="string"||typeof _=="number")return _;if(typeof _!="object")return"";if(Array.isArray(_))return l.apply(null,_);if(_.toString!==Object.prototype.toString&&!_.toString.toString().includes("[native code]"))return _.toString();var v="";for(var c in _)n.call(_,c)&&_[c]&&(v=m(v,c));return v}function m(_,v){return v?_?_+" "+v:_+v:_}i.exports?(l.default=l,i.exports=l):window.classNames=l})()}(nb)),nb.exports}var ZM=GM();const An=Lp(ZM);function Eb(){return Eb=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var d in l)({}).hasOwnProperty.call(l,d)&&(i[d]=l[d])}return i},Eb.apply(null,arguments)}function $2(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)!==-1)continue;l[d]=i[d]}return l}function O1(i){return"default"+i.charAt(0).toUpperCase()+i.substr(1)}function $M(i){var n=YM(i,"string");return typeof n=="symbol"?n:String(n)}function YM(i,n){if(typeof i!="object"||i===null)return i;var l=i[Symbol.toPrimitive];if(l!==void 0){var d=l.call(i,n);if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function qM(i,n,l){var d=ce.useRef(i!==void 0),m=ce.useState(n),_=m[0],v=m[1],c=i!==void 0,C=d.current;return d.current=c,!c&&C&&_!==n&&v(n),[c?i:_,ce.useCallback(function(R){for(var N=arguments.length,B=new Array(N>1?N-1:0),V=1;V<N;V++)B[V-1]=arguments[V];l&&l.apply(void 0,[R].concat(B)),v(R)},[l])]}function Y2(i,n){return Object.keys(n).reduce(function(l,d){var m,_=l,v=_[O1(d)],c=_[d],C=$2(_,[O1(d),d].map($M)),R=n[d],N=qM(c,v,i[R]),B=N[0],V=N[1];return Eb({},C,(m={},m[d]=B,m[R]=V,m))},i)}function Ab(i,n){return Ab=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,d){return l.__proto__=d,l},Ab(i,n)}function HM(i,n){i.prototype=Object.create(n.prototype),i.prototype.constructor=i,Ab(i,n)}const XM=["xxl","xl","lg","md","sm","xs"],WM="xs",h_=ce.createContext({prefixes:{},breakpoints:XM,minBreakpoint:WM}),{Consumer:W3,Provider:Q3}=h_;function Bn(i,n){const{prefixes:l}=ce.useContext(h_);return i||l[n]||n}function QM(){const{breakpoints:i}=ce.useContext(h_);return i}function KM(){const{minBreakpoint:i}=ce.useContext(h_);return i}function q2(){const{dir:i}=ce.useContext(h_);return i==="rtl"}function d_(i){return i&&i.ownerDocument||document}function JM(i){var n=d_(i);return n&&n.defaultView||window}function eC(i,n){return JM(i).getComputedStyle(i,n)}var tC=/([A-Z])/g;function nC(i){return i.replace(tC,"-$1").toLowerCase()}var iC=/^ms-/;function k0(i){return nC(i).replace(iC,"-ms-")}var rC=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function aC(i){return!!(i&&rC.test(i))}function ed(i,n){var l="",d="";if(typeof n=="string")return i.style.getPropertyValue(k0(n))||eC(i).getPropertyValue(k0(n));Object.keys(n).forEach(function(m){var _=n[m];!_&&_!==0?i.style.removeProperty(k0(m)):aC(m)?d+=m+"("+_+") ":l+=k0(m)+": "+_+";"}),d&&(l+="transform: "+d+";"),i.style.cssText+=";"+l}var ib={exports:{}},rb,j1;function sC(){if(j1)return rb;j1=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return rb=i,rb}var ab,B1;function oC(){if(B1)return ab;B1=1;var i=sC();function n(){}function l(){}return l.resetWarningCache=n,ab=function(){function d(v,c,C,R,N,B){if(B!==i){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}d.isRequired=d;function m(){return d}var _={array:d,bigint:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:m,element:d,elementType:d,instanceOf:m,node:d,objectOf:m,oneOf:m,oneOfType:m,shape:m,exact:m,checkPropTypes:l,resetWarningCache:n};return _.PropTypes=_,_},ab}var F1;function lC(){return F1||(F1=1,ib.exports=oC()()),ib.exports}var cC=lC();const td=Lp(cC),U1={disabled:!1},H2=Ul.createContext(null);var uC=function(n){return n.scrollTop},ky="unmounted",af="exited",jc="entering",$h="entered",Qy="exiting",hd=function(i){HM(n,i);function n(d,m){var _;_=i.call(this,d,m)||this;var v=m,c=v&&!v.isMounting?d.enter:d.appear,C;return _.appearStatus=null,d.in?c?(C=af,_.appearStatus=jc):C=$h:d.unmountOnExit||d.mountOnEnter?C=ky:C=af,_.state={status:C},_.nextCallback=null,_}n.getDerivedStateFromProps=function(m,_){var v=m.in;return v&&_.status===ky?{status:af}:null};var l=n.prototype;return l.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},l.componentDidUpdate=function(m){var _=null;if(m!==this.props){var v=this.state.status;this.props.in?v!==jc&&v!==$h&&(_=jc):(v===jc||v===$h)&&(_=Qy)}this.updateStatus(!1,_)},l.componentWillUnmount=function(){this.cancelNextCallback()},l.getTimeouts=function(){var m=this.props.timeout,_,v,c;return _=v=c=m,m!=null&&typeof m!="number"&&(_=m.exit,v=m.enter,c=m.appear!==void 0?m.appear:v),{exit:_,enter:v,appear:c}},l.updateStatus=function(m,_){if(m===void 0&&(m=!1),_!==null)if(this.cancelNextCallback(),_===jc){if(this.props.unmountOnExit||this.props.mountOnEnter){var v=this.props.nodeRef?this.props.nodeRef.current:bp.findDOMNode(this);v&&uC(v)}this.performEnter(m)}else this.performExit();else this.props.unmountOnExit&&this.state.status===af&&this.setState({status:ky})},l.performEnter=function(m){var _=this,v=this.props.enter,c=this.context?this.context.isMounting:m,C=this.props.nodeRef?[c]:[bp.findDOMNode(this),c],R=C[0],N=C[1],B=this.getTimeouts(),V=c?B.appear:B.enter;if(!m&&!v||U1.disabled){this.safeSetState({status:$h},function(){_.props.onEntered(R)});return}this.props.onEnter(R,N),this.safeSetState({status:jc},function(){_.props.onEntering(R,N),_.onTransitionEnd(V,function(){_.safeSetState({status:$h},function(){_.props.onEntered(R,N)})})})},l.performExit=function(){var m=this,_=this.props.exit,v=this.getTimeouts(),c=this.props.nodeRef?void 0:bp.findDOMNode(this);if(!_||U1.disabled){this.safeSetState({status:af},function(){m.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:Qy},function(){m.props.onExiting(c),m.onTransitionEnd(v.exit,function(){m.safeSetState({status:af},function(){m.props.onExited(c)})})})},l.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},l.safeSetState=function(m,_){_=this.setNextCallback(_),this.setState(m,_)},l.setNextCallback=function(m){var _=this,v=!0;return this.nextCallback=function(c){v&&(v=!1,_.nextCallback=null,m(c))},this.nextCallback.cancel=function(){v=!1},this.nextCallback},l.onTransitionEnd=function(m,_){this.setNextCallback(_);var v=this.props.nodeRef?this.props.nodeRef.current:bp.findDOMNode(this),c=m==null&&!this.props.addEndListener;if(!v||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var C=this.props.nodeRef?[this.nextCallback]:[v,this.nextCallback],R=C[0],N=C[1];this.props.addEndListener(R,N)}m!=null&&setTimeout(this.nextCallback,m)},l.render=function(){var m=this.state.status;if(m===ky)return null;var _=this.props,v=_.children;_.in,_.mountOnEnter,_.unmountOnExit,_.appear,_.enter,_.exit,_.timeout,_.addEndListener,_.onEnter,_.onEntering,_.onEntered,_.onExit,_.onExiting,_.onExited,_.nodeRef;var c=$2(_,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Ul.createElement(H2.Provider,{value:null},typeof v=="function"?v(m,c):Ul.cloneElement(Ul.Children.only(v),c))},n}(Ul.Component);hd.contextType=H2;hd.propTypes={};function Fm(){}hd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Fm,onEntering:Fm,onEntered:Fm,onExit:Fm,onExiting:Fm,onExited:Fm};hd.UNMOUNTED=ky;hd.EXITED=af;hd.ENTERING=jc;hd.ENTERED=$h;hd.EXITING=Qy;function X2(i){return i.code==="Escape"||i.keyCode===27}function hC(){const i=ce.version.split(".");return{major:+i[0],minor:+i[1],patch:+i[2]}}function _g(i){if(!i||typeof i=="function")return null;const{major:n}=hC();return n>=19?i.props.ref:i.ref}const dv=!!(typeof window<"u"&&window.document&&window.document.createElement);var Mb=!1,Cb=!1;try{var sb={get passive(){return Mb=!0},get once(){return Cb=Mb=!0}};dv&&(window.addEventListener("test",sb,sb),window.removeEventListener("test",sb,!0))}catch{}function dC(i,n,l,d){if(d&&typeof d!="boolean"&&!Cb){var m=d.once,_=d.capture,v=l;!Cb&&m&&(v=l.__once||function c(C){this.removeEventListener(n,c,_),l.call(this,C)},l.__once=v),i.addEventListener(n,v,Mb?d:_)}i.addEventListener(n,l,d)}function fC(i,n,l,d){var m=d&&typeof d!="boolean"?d.capture:d;i.removeEventListener(n,l,m),l.__once&&i.removeEventListener(n,l.__once,m)}function Xh(i,n,l,d){return dC(i,n,l,d),function(){fC(i,n,l,d)}}function pC(i,n,l,d){if(d===void 0&&(d=!0),i){var m=document.createEvent("HTMLEvents");m.initEvent(n,l,d),i.dispatchEvent(m)}}function mC(i){var n=ed(i,"transitionDuration")||"",l=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*l}function gC(i,n,l){l===void 0&&(l=5);var d=!1,m=setTimeout(function(){d||pC(i,"transitionend",!0)},n+l),_=Xh(i,"transitionend",function(){d=!0},{once:!0});return function(){clearTimeout(m),_()}}function yC(i,n,l,d){l==null&&(l=mC(i)||0);var m=gC(i,l,d),_=Xh(i,"transitionend",n);return function(){m(),_()}}function V1(i,n){const l=ed(i,n)||"",d=l.indexOf("ms")===-1?1e3:1;return parseFloat(l)*d}function hx(i,n){const l=V1(i,"transitionDuration"),d=V1(i,"transitionDelay"),m=yC(i,_=>{_.target===i&&(m(),n(_))},l+d)}function wy(...i){return i.filter(n=>n!=null).reduce((n,l)=>{if(typeof l!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return n===null?l:function(...m){n.apply(this,m),l.apply(this,m)}},null)}function W2(i){i.offsetHeight}const G1=i=>!i||typeof i=="function"?i:n=>{i.current=n};function _C(i,n){const l=G1(i),d=G1(n);return m=>{l&&l(m),d&&d(m)}}function Q2(i,n){return ce.useMemo(()=>_C(i,n),[i,n])}function Db(i){return i&&"setState"in i?bp.findDOMNode(i):i??null}const fv=Ul.forwardRef(({onEnter:i,onEntering:n,onEntered:l,onExit:d,onExiting:m,onExited:_,addEndListener:v,children:c,childRef:C,...R},N)=>{const B=ce.useRef(null),V=Q2(B,C),G=Ke=>{V(Db(Ke))},ae=Ke=>mt=>{Ke&&B.current&&Ke(B.current,mt)},me=ce.useCallback(ae(i),[i]),pe=ce.useCallback(ae(n),[n]),Ne=ce.useCallback(ae(l),[l]),Ve=ce.useCallback(ae(d),[d]),Fe=ce.useCallback(ae(m),[m]),qe=ce.useCallback(ae(_),[_]),Ae=ce.useCallback(ae(v),[v]);return ie.jsx(hd,{ref:N,...R,onEnter:me,onEntered:Ne,onEntering:pe,onExit:Ve,onExited:qe,onExiting:Fe,addEndListener:Ae,nodeRef:B,children:typeof c=="function"?(Ke,mt)=>c(Ke,{...mt,ref:G}):Ul.cloneElement(c,{ref:G})})});fv.displayName="TransitionWrapper";const vC={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function bC(i,n){const l=`offset${i[0].toUpperCase()}${i.slice(1)}`,d=n[l],m=vC[i];return d+parseInt(ed(n,m[0]),10)+parseInt(ed(n,m[1]),10)}const xC={[af]:"collapse",[Qy]:"collapsing",[jc]:"collapsing",[$h]:"collapse show"},dx=Ul.forwardRef(({onEnter:i,onEntering:n,onEntered:l,onExit:d,onExiting:m,className:_,children:v,dimension:c="height",in:C=!1,timeout:R=300,mountOnEnter:N=!1,unmountOnExit:B=!1,appear:V=!1,getDimensionValue:G=bC,...ae},me)=>{const pe=typeof c=="function"?c():c,Ne=ce.useMemo(()=>wy(Ke=>{Ke.style[pe]="0"},i),[pe,i]),Ve=ce.useMemo(()=>wy(Ke=>{const mt=`scroll${pe[0].toUpperCase()}${pe.slice(1)}`;Ke.style[pe]=`${Ke[mt]}px`},n),[pe,n]),Fe=ce.useMemo(()=>wy(Ke=>{Ke.style[pe]=null},l),[pe,l]),qe=ce.useMemo(()=>wy(Ke=>{Ke.style[pe]=`${G(pe,Ke)}px`,W2(Ke)},d),[d,G,pe]),Ae=ce.useMemo(()=>wy(Ke=>{Ke.style[pe]=null},m),[pe,m]);return ie.jsx(fv,{ref:me,addEndListener:hx,...ae,"aria-expanded":ae.role?C:null,onEnter:Ne,onEntering:Ve,onEntered:Fe,onExit:qe,onExiting:Ae,childRef:_g(v),in:C,timeout:R,mountOnEnter:N,unmountOnExit:B,appear:V,children:(Ke,mt)=>Ul.cloneElement(v,{...mt,className:An(_,v.props.className,xC[Ke],pe==="width"&&"collapse-horizontal")})})});dx.displayName="Collapse";function K2(i,n){return Array.isArray(i)?i.includes(n):i===n}const f_=ce.createContext({});f_.displayName="AccordionContext";const fx=ce.forwardRef(({as:i="div",bsPrefix:n,className:l,children:d,eventKey:m,..._},v)=>{const{activeEventKey:c}=ce.useContext(f_);return n=Bn(n,"accordion-collapse"),ie.jsx(dx,{ref:v,in:K2(c,m),..._,className:An(l,n),children:ie.jsx(i,{children:ce.Children.only(d)})})});fx.displayName="AccordionCollapse";const pv=ce.createContext({eventKey:""});pv.displayName="AccordionItemContext";const J2=ce.forwardRef(({as:i="div",bsPrefix:n,className:l,onEnter:d,onEntering:m,onEntered:_,onExit:v,onExiting:c,onExited:C,...R},N)=>{n=Bn(n,"accordion-body");const{eventKey:B}=ce.useContext(pv);return ie.jsx(fx,{eventKey:B,onEnter:d,onEntering:m,onEntered:_,onExit:v,onExiting:c,onExited:C,children:ie.jsx(i,{ref:N,...R,className:An(l,n)})})});J2.displayName="AccordionBody";function wC(i,n){const{activeEventKey:l,onSelect:d,alwaysOpen:m}=ce.useContext(f_);return _=>{let v=i===l?null:i;m&&(Array.isArray(l)?l.includes(i)?v=l.filter(c=>c!==i):v=[...l,i]:v=[i]),d?.(v,_),n?.(_)}}const px=ce.forwardRef(({as:i="button",bsPrefix:n,className:l,onClick:d,...m},_)=>{n=Bn(n,"accordion-button");const{eventKey:v}=ce.useContext(pv),c=wC(v,d),{activeEventKey:C}=ce.useContext(f_);return i==="button"&&(m.type="button"),ie.jsx(i,{ref:_,onClick:c,...m,"aria-expanded":Array.isArray(C)?C.includes(v):v===C,className:An(l,n,!K2(C,v)&&"collapsed")})});px.displayName="AccordionButton";const eT=ce.forwardRef(({as:i="h2","aria-controls":n,bsPrefix:l,className:d,children:m,onClick:_,...v},c)=>(l=Bn(l,"accordion-header"),ie.jsx(i,{ref:c,...v,className:An(d,l),children:ie.jsx(px,{onClick:_,"aria-controls":n,children:m})})));eT.displayName="AccordionHeader";const tT=ce.forwardRef(({as:i="div",bsPrefix:n,className:l,eventKey:d,...m},_)=>{n=Bn(n,"accordion-item");const v=ce.useMemo(()=>({eventKey:d}),[d]);return ie.jsx(pv.Provider,{value:v,children:ie.jsx(i,{ref:_,...m,className:An(l,n)})})});tT.displayName="AccordionItem";const nT=ce.forwardRef((i,n)=>{const{as:l="div",activeKey:d,bsPrefix:m,className:_,onSelect:v,flush:c,alwaysOpen:C,...R}=Y2(i,{activeKey:"onSelect"}),N=Bn(m,"accordion"),B=ce.useMemo(()=>({activeEventKey:d,onSelect:v,alwaysOpen:C}),[d,v,C]);return ie.jsx(f_.Provider,{value:B,children:ie.jsx(l,{ref:n,...R,className:An(_,N,c&&`${N}-flush`)})})});nT.displayName="Accordion";const I0=Object.assign(nT,{Button:px,Collapse:fx,Item:tT,Header:eT,Body:J2});function TC(i){const n=ce.useRef(i);return ce.useEffect(()=>{n.current=i},[i]),n}function p_(i){const n=TC(i);return ce.useCallback(function(...l){return n.current&&n.current(...l)},[n])}const SC=i=>ce.forwardRef((n,l)=>ie.jsx("div",{...n,ref:l,className:An(n.className,i)}));function Z1(){return ce.useState(null)}function EC(i){const n=ce.useRef(i);return ce.useEffect(()=>{n.current=i},[i]),n}function Iu(i){const n=EC(i);return ce.useCallback(function(...l){return n.current&&n.current(...l)},[n])}function iT(){const i=ce.useRef(!0),n=ce.useRef(()=>i.current);return ce.useEffect(()=>(i.current=!0,()=>{i.current=!1}),[]),n.current}function AC(i){const n=ce.useRef(null);return ce.useEffect(()=>{n.current=i}),n.current}const MC=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",CC=typeof document<"u",$1=CC||MC?ce.useLayoutEffect:ce.useEffect,DC=["as","disabled"];function kC(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}function IC(i){return!i||i.trim()==="#"}function rT({tagName:i,disabled:n,href:l,target:d,rel:m,role:_,onClick:v,tabIndex:c=0,type:C}){i||(l!=null||d!=null||m!=null?i="a":i="button");const R={tagName:i};if(i==="button")return[{type:C||"button",disabled:n},R];const N=V=>{if((n||i==="a"&&IC(l))&&V.preventDefault(),n){V.stopPropagation();return}v?.(V)},B=V=>{V.key===" "&&(V.preventDefault(),N(V))};return i==="a"&&(l||(l="#"),n&&(l=void 0)),[{role:_??"button",disabled:void 0,tabIndex:n?void 0:c,href:l,target:i==="a"?d:void 0,"aria-disabled":n||void 0,rel:i==="a"?m:void 0,onClick:N,onKeyDown:B},R]}const RC=ce.forwardRef((i,n)=>{let{as:l,disabled:d}=i,m=kC(i,DC);const[_,{tagName:v}]=rT(Object.assign({tagName:l,disabled:d},m));return ie.jsx(v,Object.assign({},m,_,{ref:n}))});RC.displayName="Button";const PC={[jc]:"show",[$h]:"show"},G0=ce.forwardRef(({className:i,children:n,transitionClasses:l={},onEnter:d,...m},_)=>{const v={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...m},c=ce.useCallback((C,R)=>{W2(C),d?.(C,R)},[d]);return ie.jsx(fv,{ref:_,addEndListener:hx,...v,onEnter:c,childRef:_g(n),children:(C,R)=>ce.cloneElement(n,{...R,className:An("fade",i,n.props.className,PC[C],l[C])})})});G0.displayName="Fade";const zC={"aria-label":td.string,onClick:td.func,variant:td.oneOf(["white"])},mx=ce.forwardRef(({className:i,variant:n,"aria-label":l="Close",...d},m)=>ie.jsx("button",{ref:m,type:"button",className:An("btn-close",n&&`btn-close-${n}`,i),"aria-label":l,...d}));mx.displayName="CloseButton";mx.propTypes=zC;const Cp=ce.forwardRef(({as:i,bsPrefix:n,variant:l="primary",size:d,active:m=!1,disabled:_=!1,className:v,...c},C)=>{const R=Bn(n,"btn"),[N,{tagName:B}]=rT({tagName:i,disabled:_,...c}),V=B;return ie.jsx(V,{...N,...c,ref:C,disabled:_,className:An(v,R,m&&"active",l&&`${R}-${l}`,d&&`${R}-${d}`,c.href&&_&&"disabled")})});Cp.displayName="Button";const gx=ce.forwardRef(({bsPrefix:i,size:n,vertical:l=!1,className:d,role:m="group",as:_="div",...v},c)=>{const C=Bn(i,"btn-group");let R=C;return l&&(R=`${C}-vertical`),ie.jsx(_,{...v,ref:c,role:m,className:An(d,R,n&&`${C}-${n}`)})});gx.displayName="ButtonGroup";function NC(i,n){return ce.Children.toArray(i).some(l=>ce.isValidElement(l)&&l.type===n)}function LC({as:i,bsPrefix:n,className:l,...d}){n=Bn(n,"col");const m=QM(),_=KM(),v=[],c=[];return m.forEach(C=>{const R=d[C];delete d[C];let N,B,V;typeof R=="object"&&R!=null?{span:N,offset:B,order:V}=R:N=R;const G=C!==_?`-${C}`:"";N&&v.push(N===!0?`${n}${G}`:`${n}${G}-${N}`),V!=null&&c.push(`order${G}-${V}`),B!=null&&c.push(`offset${G}-${B}`)}),[{...d,className:An(l,...v,...c)},{as:i,bsPrefix:n,spans:v}]}const aT=ce.forwardRef((i,n)=>{const[{className:l,...d},{as:m="div",bsPrefix:_,spans:v}]=LC(i);return ie.jsx(m,{...d,ref:n,className:An(l,!v.length&&_)})});aT.displayName="Col";var OC=Function.prototype.bind.call(Function.prototype.call,[].slice);function Um(i,n){return OC(i.querySelectorAll(n))}var Y1=Object.prototype.hasOwnProperty;function q1(i,n,l){for(l of i.keys())if(By(l,n))return l}function By(i,n){var l,d,m;if(i===n)return!0;if(i&&n&&(l=i.constructor)===n.constructor){if(l===Date)return i.getTime()===n.getTime();if(l===RegExp)return i.toString()===n.toString();if(l===Array){if((d=i.length)===n.length)for(;d--&&By(i[d],n[d]););return d===-1}if(l===Set){if(i.size!==n.size)return!1;for(d of i)if(m=d,m&&typeof m=="object"&&(m=q1(n,m),!m)||!n.has(m))return!1;return!0}if(l===Map){if(i.size!==n.size)return!1;for(d of i)if(m=d[0],m&&typeof m=="object"&&(m=q1(n,m),!m)||!By(d[1],n.get(m)))return!1;return!0}if(l===ArrayBuffer)i=new Uint8Array(i),n=new Uint8Array(n);else if(l===DataView){if((d=i.byteLength)===n.byteLength)for(;d--&&i.getInt8(d)===n.getInt8(d););return d===-1}if(ArrayBuffer.isView(i)){if((d=i.byteLength)===n.byteLength)for(;d--&&i[d]===n[d];);return d===-1}if(!l||typeof i=="object"){d=0;for(l in i)if(Y1.call(i,l)&&++d&&!Y1.call(n,l)||!(l in n)||!By(i[l],n[l]))return!1;return Object.keys(n).length===d}}return i!==i&&n!==n}function jC(i){const n=iT();return[i[0],ce.useCallback(l=>{if(n())return i[1](l)},[n,i[1]])]}var Ao="top",Yl="bottom",ql="right",Mo="left",yx="auto",m_=[Ao,Yl,ql,Mo],ng="start",Ky="end",BC="clippingParents",sT="viewport",Ty="popper",FC="reference",H1=m_.reduce(function(i,n){return i.concat([n+"-"+ng,n+"-"+Ky])},[]),oT=[].concat(m_,[yx]).reduce(function(i,n){return i.concat([n,n+"-"+ng,n+"-"+Ky])},[]),UC="beforeRead",VC="read",GC="afterRead",ZC="beforeMain",$C="main",YC="afterMain",qC="beforeWrite",HC="write",XC="afterWrite",WC=[UC,VC,GC,ZC,$C,YC,qC,HC,XC];function Ou(i){return i.split("-")[0]}function ol(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var n=i.ownerDocument;return n&&n.defaultView||window}return i}function Dp(i){var n=ol(i).Element;return i instanceof n||i instanceof Element}function ju(i){var n=ol(i).HTMLElement;return i instanceof n||i instanceof HTMLElement}function _x(i){if(typeof ShadowRoot>"u")return!1;var n=ol(i).ShadowRoot;return i instanceof n||i instanceof ShadowRoot}var Tp=Math.max,Z0=Math.min,ig=Math.round;function kb(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function lT(){return!/^((?!chrome|android).)*safari/i.test(kb())}function rg(i,n,l){n===void 0&&(n=!1),l===void 0&&(l=!1);var d=i.getBoundingClientRect(),m=1,_=1;n&&ju(i)&&(m=i.offsetWidth>0&&ig(d.width)/i.offsetWidth||1,_=i.offsetHeight>0&&ig(d.height)/i.offsetHeight||1);var v=Dp(i)?ol(i):window,c=v.visualViewport,C=!lT()&&l,R=(d.left+(C&&c?c.offsetLeft:0))/m,N=(d.top+(C&&c?c.offsetTop:0))/_,B=d.width/m,V=d.height/_;return{width:B,height:V,top:N,right:R+B,bottom:N+V,left:R,x:R,y:N}}function vx(i){var n=rg(i),l=i.offsetWidth,d=i.offsetHeight;return Math.abs(n.width-l)<=1&&(l=n.width),Math.abs(n.height-d)<=1&&(d=n.height),{x:i.offsetLeft,y:i.offsetTop,width:l,height:d}}function cT(i,n){var l=n.getRootNode&&n.getRootNode();if(i.contains(n))return!0;if(l&&_x(l)){var d=n;do{if(d&&i.isSameNode(d))return!0;d=d.parentNode||d.host}while(d)}return!1}function ff(i){return i?(i.nodeName||"").toLowerCase():null}function od(i){return ol(i).getComputedStyle(i)}function QC(i){return["table","td","th"].indexOf(ff(i))>=0}function vf(i){return((Dp(i)?i.ownerDocument:i.document)||window.document).documentElement}function mv(i){return ff(i)==="html"?i:i.assignedSlot||i.parentNode||(_x(i)?i.host:null)||vf(i)}function X1(i){return!ju(i)||od(i).position==="fixed"?null:i.offsetParent}function KC(i){var n=/firefox/i.test(kb()),l=/Trident/i.test(kb());if(l&&ju(i)){var d=od(i);if(d.position==="fixed")return null}var m=mv(i);for(_x(m)&&(m=m.host);ju(m)&&["html","body"].indexOf(ff(m))<0;){var _=od(m);if(_.transform!=="none"||_.perspective!=="none"||_.contain==="paint"||["transform","perspective"].indexOf(_.willChange)!==-1||n&&_.willChange==="filter"||n&&_.filter&&_.filter!=="none")return m;m=m.parentNode}return null}function g_(i){for(var n=ol(i),l=X1(i);l&&QC(l)&&od(l).position==="static";)l=X1(l);return l&&(ff(l)==="html"||ff(l)==="body"&&od(l).position==="static")?n:l||KC(i)||n}function bx(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Fy(i,n,l){return Tp(i,Z0(n,l))}function JC(i,n,l){var d=Fy(i,n,l);return d>l?l:d}function uT(){return{top:0,right:0,bottom:0,left:0}}function hT(i){return Object.assign({},uT(),i)}function dT(i,n){return n.reduce(function(l,d){return l[d]=i,l},{})}var eD=function(n,l){return n=typeof n=="function"?n(Object.assign({},l.rects,{placement:l.placement})):n,hT(typeof n!="number"?n:dT(n,m_))};function tD(i){var n,l=i.state,d=i.name,m=i.options,_=l.elements.arrow,v=l.modifiersData.popperOffsets,c=Ou(l.placement),C=bx(c),R=[Mo,ql].indexOf(c)>=0,N=R?"height":"width";if(!(!_||!v)){var B=eD(m.padding,l),V=vx(_),G=C==="y"?Ao:Mo,ae=C==="y"?Yl:ql,me=l.rects.reference[N]+l.rects.reference[C]-v[C]-l.rects.popper[N],pe=v[C]-l.rects.reference[C],Ne=g_(_),Ve=Ne?C==="y"?Ne.clientHeight||0:Ne.clientWidth||0:0,Fe=me/2-pe/2,qe=B[G],Ae=Ve-V[N]-B[ae],Ke=Ve/2-V[N]/2+Fe,mt=Fy(qe,Ke,Ae),st=C;l.modifiersData[d]=(n={},n[st]=mt,n.centerOffset=mt-Ke,n)}}function nD(i){var n=i.state,l=i.options,d=l.element,m=d===void 0?"[data-popper-arrow]":d;m!=null&&(typeof m=="string"&&(m=n.elements.popper.querySelector(m),!m)||cT(n.elements.popper,m)&&(n.elements.arrow=m))}const iD={name:"arrow",enabled:!0,phase:"main",fn:tD,effect:nD,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ag(i){return i.split("-")[1]}var rD={top:"auto",right:"auto",bottom:"auto",left:"auto"};function aD(i,n){var l=i.x,d=i.y,m=n.devicePixelRatio||1;return{x:ig(l*m)/m||0,y:ig(d*m)/m||0}}function W1(i){var n,l=i.popper,d=i.popperRect,m=i.placement,_=i.variation,v=i.offsets,c=i.position,C=i.gpuAcceleration,R=i.adaptive,N=i.roundOffsets,B=i.isFixed,V=v.x,G=V===void 0?0:V,ae=v.y,me=ae===void 0?0:ae,pe=typeof N=="function"?N({x:G,y:me}):{x:G,y:me};G=pe.x,me=pe.y;var Ne=v.hasOwnProperty("x"),Ve=v.hasOwnProperty("y"),Fe=Mo,qe=Ao,Ae=window;if(R){var Ke=g_(l),mt="clientHeight",st="clientWidth";if(Ke===ol(l)&&(Ke=vf(l),od(Ke).position!=="static"&&c==="absolute"&&(mt="scrollHeight",st="scrollWidth")),Ke=Ke,m===Ao||(m===Mo||m===ql)&&_===Ky){qe=Yl;var Pe=B&&Ke===Ae&&Ae.visualViewport?Ae.visualViewport.height:Ke[mt];me-=Pe-d.height,me*=C?1:-1}if(m===Mo||(m===Ao||m===Yl)&&_===Ky){Fe=ql;var rt=B&&Ke===Ae&&Ae.visualViewport?Ae.visualViewport.width:Ke[st];G-=rt-d.width,G*=C?1:-1}}var Mt=Object.assign({position:c},R&&rD),Rt=N===!0?aD({x:G,y:me},ol(l)):{x:G,y:me};if(G=Rt.x,me=Rt.y,C){var jt;return Object.assign({},Mt,(jt={},jt[qe]=Ve?"0":"",jt[Fe]=Ne?"0":"",jt.transform=(Ae.devicePixelRatio||1)<=1?"translate("+G+"px, "+me+"px)":"translate3d("+G+"px, "+me+"px, 0)",jt))}return Object.assign({},Mt,(n={},n[qe]=Ve?me+"px":"",n[Fe]=Ne?G+"px":"",n.transform="",n))}function sD(i){var n=i.state,l=i.options,d=l.gpuAcceleration,m=d===void 0?!0:d,_=l.adaptive,v=_===void 0?!0:_,c=l.roundOffsets,C=c===void 0?!0:c,R={placement:Ou(n.placement),variation:ag(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:m,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,W1(Object.assign({},R,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:v,roundOffsets:C})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,W1(Object.assign({},R,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:C})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const oD={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:sD,data:{}};var R0={passive:!0};function lD(i){var n=i.state,l=i.instance,d=i.options,m=d.scroll,_=m===void 0?!0:m,v=d.resize,c=v===void 0?!0:v,C=ol(n.elements.popper),R=[].concat(n.scrollParents.reference,n.scrollParents.popper);return _&&R.forEach(function(N){N.addEventListener("scroll",l.update,R0)}),c&&C.addEventListener("resize",l.update,R0),function(){_&&R.forEach(function(N){N.removeEventListener("scroll",l.update,R0)}),c&&C.removeEventListener("resize",l.update,R0)}}const cD={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lD,data:{}};var uD={left:"right",right:"left",bottom:"top",top:"bottom"};function O0(i){return i.replace(/left|right|bottom|top/g,function(n){return uD[n]})}var hD={start:"end",end:"start"};function Q1(i){return i.replace(/start|end/g,function(n){return hD[n]})}function xx(i){var n=ol(i),l=n.pageXOffset,d=n.pageYOffset;return{scrollLeft:l,scrollTop:d}}function wx(i){return rg(vf(i)).left+xx(i).scrollLeft}function dD(i,n){var l=ol(i),d=vf(i),m=l.visualViewport,_=d.clientWidth,v=d.clientHeight,c=0,C=0;if(m){_=m.width,v=m.height;var R=lT();(R||!R&&n==="fixed")&&(c=m.offsetLeft,C=m.offsetTop)}return{width:_,height:v,x:c+wx(i),y:C}}function fD(i){var n,l=vf(i),d=xx(i),m=(n=i.ownerDocument)==null?void 0:n.body,_=Tp(l.scrollWidth,l.clientWidth,m?m.scrollWidth:0,m?m.clientWidth:0),v=Tp(l.scrollHeight,l.clientHeight,m?m.scrollHeight:0,m?m.clientHeight:0),c=-d.scrollLeft+wx(i),C=-d.scrollTop;return od(m||l).direction==="rtl"&&(c+=Tp(l.clientWidth,m?m.clientWidth:0)-_),{width:_,height:v,x:c,y:C}}function Tx(i){var n=od(i),l=n.overflow,d=n.overflowX,m=n.overflowY;return/auto|scroll|overlay|hidden/.test(l+m+d)}function fT(i){return["html","body","#document"].indexOf(ff(i))>=0?i.ownerDocument.body:ju(i)&&Tx(i)?i:fT(mv(i))}function Uy(i,n){var l;n===void 0&&(n=[]);var d=fT(i),m=d===((l=i.ownerDocument)==null?void 0:l.body),_=ol(d),v=m?[_].concat(_.visualViewport||[],Tx(d)?d:[]):d,c=n.concat(v);return m?c:c.concat(Uy(mv(v)))}function Ib(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function pD(i,n){var l=rg(i,!1,n==="fixed");return l.top=l.top+i.clientTop,l.left=l.left+i.clientLeft,l.bottom=l.top+i.clientHeight,l.right=l.left+i.clientWidth,l.width=i.clientWidth,l.height=i.clientHeight,l.x=l.left,l.y=l.top,l}function K1(i,n,l){return n===sT?Ib(dD(i,l)):Dp(n)?pD(n,l):Ib(fD(vf(i)))}function mD(i){var n=Uy(mv(i)),l=["absolute","fixed"].indexOf(od(i).position)>=0,d=l&&ju(i)?g_(i):i;return Dp(d)?n.filter(function(m){return Dp(m)&&cT(m,d)&&ff(m)!=="body"}):[]}function gD(i,n,l,d){var m=n==="clippingParents"?mD(i):[].concat(n),_=[].concat(m,[l]),v=_[0],c=_.reduce(function(C,R){var N=K1(i,R,d);return C.top=Tp(N.top,C.top),C.right=Z0(N.right,C.right),C.bottom=Z0(N.bottom,C.bottom),C.left=Tp(N.left,C.left),C},K1(i,v,d));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function pT(i){var n=i.reference,l=i.element,d=i.placement,m=d?Ou(d):null,_=d?ag(d):null,v=n.x+n.width/2-l.width/2,c=n.y+n.height/2-l.height/2,C;switch(m){case Ao:C={x:v,y:n.y-l.height};break;case Yl:C={x:v,y:n.y+n.height};break;case ql:C={x:n.x+n.width,y:c};break;case Mo:C={x:n.x-l.width,y:c};break;default:C={x:n.x,y:n.y}}var R=m?bx(m):null;if(R!=null){var N=R==="y"?"height":"width";switch(_){case ng:C[R]=C[R]-(n[N]/2-l[N]/2);break;case Ky:C[R]=C[R]+(n[N]/2-l[N]/2);break}}return C}function Jy(i,n){n===void 0&&(n={});var l=n,d=l.placement,m=d===void 0?i.placement:d,_=l.strategy,v=_===void 0?i.strategy:_,c=l.boundary,C=c===void 0?BC:c,R=l.rootBoundary,N=R===void 0?sT:R,B=l.elementContext,V=B===void 0?Ty:B,G=l.altBoundary,ae=G===void 0?!1:G,me=l.padding,pe=me===void 0?0:me,Ne=hT(typeof pe!="number"?pe:dT(pe,m_)),Ve=V===Ty?FC:Ty,Fe=i.rects.popper,qe=i.elements[ae?Ve:V],Ae=gD(Dp(qe)?qe:qe.contextElement||vf(i.elements.popper),C,N,v),Ke=rg(i.elements.reference),mt=pT({reference:Ke,element:Fe,placement:m}),st=Ib(Object.assign({},Fe,mt)),Pe=V===Ty?st:Ke,rt={top:Ae.top-Pe.top+Ne.top,bottom:Pe.bottom-Ae.bottom+Ne.bottom,left:Ae.left-Pe.left+Ne.left,right:Pe.right-Ae.right+Ne.right},Mt=i.modifiersData.offset;if(V===Ty&&Mt){var Rt=Mt[m];Object.keys(rt).forEach(function(jt){var en=[ql,Yl].indexOf(jt)>=0?1:-1,ln=[Ao,Yl].indexOf(jt)>=0?"y":"x";rt[jt]+=Rt[ln]*en})}return rt}function yD(i,n){n===void 0&&(n={});var l=n,d=l.placement,m=l.boundary,_=l.rootBoundary,v=l.padding,c=l.flipVariations,C=l.allowedAutoPlacements,R=C===void 0?oT:C,N=ag(d),B=N?c?H1:H1.filter(function(ae){return ag(ae)===N}):m_,V=B.filter(function(ae){return R.indexOf(ae)>=0});V.length===0&&(V=B);var G=V.reduce(function(ae,me){return ae[me]=Jy(i,{placement:me,boundary:m,rootBoundary:_,padding:v})[Ou(me)],ae},{});return Object.keys(G).sort(function(ae,me){return G[ae]-G[me]})}function _D(i){if(Ou(i)===yx)return[];var n=O0(i);return[Q1(i),n,Q1(n)]}function vD(i){var n=i.state,l=i.options,d=i.name;if(!n.modifiersData[d]._skip){for(var m=l.mainAxis,_=m===void 0?!0:m,v=l.altAxis,c=v===void 0?!0:v,C=l.fallbackPlacements,R=l.padding,N=l.boundary,B=l.rootBoundary,V=l.altBoundary,G=l.flipVariations,ae=G===void 0?!0:G,me=l.allowedAutoPlacements,pe=n.options.placement,Ne=Ou(pe),Ve=Ne===pe,Fe=C||(Ve||!ae?[O0(pe)]:_D(pe)),qe=[pe].concat(Fe).reduce(function(Pt,Xt){return Pt.concat(Ou(Xt)===yx?yD(n,{placement:Xt,boundary:N,rootBoundary:B,padding:R,flipVariations:ae,allowedAutoPlacements:me}):Xt)},[]),Ae=n.rects.reference,Ke=n.rects.popper,mt=new Map,st=!0,Pe=qe[0],rt=0;rt<qe.length;rt++){var Mt=qe[rt],Rt=Ou(Mt),jt=ag(Mt)===ng,en=[Ao,Yl].indexOf(Rt)>=0,ln=en?"width":"height",Ge=Jy(n,{placement:Mt,boundary:N,rootBoundary:B,altBoundary:V,padding:R}),ct=en?jt?ql:Mo:jt?Yl:Ao;Ae[ln]>Ke[ln]&&(ct=O0(ct));var ht=O0(ct),kt=[];if(_&&kt.push(Ge[Rt]<=0),c&&kt.push(Ge[ct]<=0,Ge[ht]<=0),kt.every(function(Pt){return Pt})){Pe=Mt,st=!1;break}mt.set(Mt,kt)}if(st)for(var Ee=ae?3:1,nt=function(Xt){var Bt=qe.find(function(Ei){var mn=mt.get(Ei);if(mn)return mn.slice(0,Xt).every(function(mi){return mi})});if(Bt)return Pe=Bt,"break"},Ct=Ee;Ct>0;Ct--){var bt=nt(Ct);if(bt==="break")break}n.placement!==Pe&&(n.modifiersData[d]._skip=!0,n.placement=Pe,n.reset=!0)}}const bD={name:"flip",enabled:!0,phase:"main",fn:vD,requiresIfExists:["offset"],data:{_skip:!1}};function J1(i,n,l){return l===void 0&&(l={x:0,y:0}),{top:i.top-n.height-l.y,right:i.right-n.width+l.x,bottom:i.bottom-n.height+l.y,left:i.left-n.width-l.x}}function ew(i){return[Ao,ql,Yl,Mo].some(function(n){return i[n]>=0})}function xD(i){var n=i.state,l=i.name,d=n.rects.reference,m=n.rects.popper,_=n.modifiersData.preventOverflow,v=Jy(n,{elementContext:"reference"}),c=Jy(n,{altBoundary:!0}),C=J1(v,d),R=J1(c,m,_),N=ew(C),B=ew(R);n.modifiersData[l]={referenceClippingOffsets:C,popperEscapeOffsets:R,isReferenceHidden:N,hasPopperEscaped:B},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":N,"data-popper-escaped":B})}const wD={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:xD};function TD(i,n,l){var d=Ou(i),m=[Mo,Ao].indexOf(d)>=0?-1:1,_=typeof l=="function"?l(Object.assign({},n,{placement:i})):l,v=_[0],c=_[1];return v=v||0,c=(c||0)*m,[Mo,ql].indexOf(d)>=0?{x:c,y:v}:{x:v,y:c}}function SD(i){var n=i.state,l=i.options,d=i.name,m=l.offset,_=m===void 0?[0,0]:m,v=oT.reduce(function(N,B){return N[B]=TD(B,n.rects,_),N},{}),c=v[n.placement],C=c.x,R=c.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=C,n.modifiersData.popperOffsets.y+=R),n.modifiersData[d]=v}const ED={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:SD};function AD(i){var n=i.state,l=i.name;n.modifiersData[l]=pT({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const MD={name:"popperOffsets",enabled:!0,phase:"read",fn:AD,data:{}};function CD(i){return i==="x"?"y":"x"}function DD(i){var n=i.state,l=i.options,d=i.name,m=l.mainAxis,_=m===void 0?!0:m,v=l.altAxis,c=v===void 0?!1:v,C=l.boundary,R=l.rootBoundary,N=l.altBoundary,B=l.padding,V=l.tether,G=V===void 0?!0:V,ae=l.tetherOffset,me=ae===void 0?0:ae,pe=Jy(n,{boundary:C,rootBoundary:R,padding:B,altBoundary:N}),Ne=Ou(n.placement),Ve=ag(n.placement),Fe=!Ve,qe=bx(Ne),Ae=CD(qe),Ke=n.modifiersData.popperOffsets,mt=n.rects.reference,st=n.rects.popper,Pe=typeof me=="function"?me(Object.assign({},n.rects,{placement:n.placement})):me,rt=typeof Pe=="number"?{mainAxis:Pe,altAxis:Pe}:Object.assign({mainAxis:0,altAxis:0},Pe),Mt=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Rt={x:0,y:0};if(Ke){if(_){var jt,en=qe==="y"?Ao:Mo,ln=qe==="y"?Yl:ql,Ge=qe==="y"?"height":"width",ct=Ke[qe],ht=ct+pe[en],kt=ct-pe[ln],Ee=G?-st[Ge]/2:0,nt=Ve===ng?mt[Ge]:st[Ge],Ct=Ve===ng?-st[Ge]:-mt[Ge],bt=n.elements.arrow,Pt=G&&bt?vx(bt):{width:0,height:0},Xt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:uT(),Bt=Xt[en],Ei=Xt[ln],mn=Fy(0,mt[Ge],Pt[Ge]),mi=Fe?mt[Ge]/2-Ee-mn-Bt-rt.mainAxis:nt-mn-Bt-rt.mainAxis,Ea=Fe?-mt[Ge]/2+Ee+mn+Ei+rt.mainAxis:Ct+mn+Ei+rt.mainAxis,ua=n.elements.arrow&&g_(n.elements.arrow),ur=ua?qe==="y"?ua.clientTop||0:ua.clientLeft||0:0,Gn=(jt=Mt?.[qe])!=null?jt:0,Xn=ct+mi-Gn-ur,Rn=ct+Ea-Gn,Yr=Fy(G?Z0(ht,Xn):ht,ct,G?Tp(kt,Rn):kt);Ke[qe]=Yr,Rt[qe]=Yr-ct}if(c){var ji,Qa=qe==="x"?Ao:Mo,za=qe==="x"?Yl:ql,ha=Ke[Ae],qr=Ae==="y"?"height":"width",xs=ha+pe[Qa],Ka=ha-pe[za],ws=[Ao,Mo].indexOf(Ne)!==-1,Ts=(ji=Mt?.[Ae])!=null?ji:0,da=ws?xs:ha-mt[qr]-st[qr]-Ts+rt.altAxis,Bi=ws?ha+mt[qr]+st[qr]-Ts-rt.altAxis:Ka,Hr=G&&ws?JC(da,ha,Bi):Fy(G?da:xs,ha,G?Bi:Ka);Ke[Ae]=Hr,Rt[Ae]=Hr-ha}n.modifiersData[d]=Rt}}const kD={name:"preventOverflow",enabled:!0,phase:"main",fn:DD,requiresIfExists:["offset"]};function ID(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function RD(i){return i===ol(i)||!ju(i)?xx(i):ID(i)}function PD(i){var n=i.getBoundingClientRect(),l=ig(n.width)/i.offsetWidth||1,d=ig(n.height)/i.offsetHeight||1;return l!==1||d!==1}function zD(i,n,l){l===void 0&&(l=!1);var d=ju(n),m=ju(n)&&PD(n),_=vf(n),v=rg(i,m,l),c={scrollLeft:0,scrollTop:0},C={x:0,y:0};return(d||!d&&!l)&&((ff(n)!=="body"||Tx(_))&&(c=RD(n)),ju(n)?(C=rg(n,!0),C.x+=n.clientLeft,C.y+=n.clientTop):_&&(C.x=wx(_))),{x:v.left+c.scrollLeft-C.x,y:v.top+c.scrollTop-C.y,width:v.width,height:v.height}}function ND(i){var n=new Map,l=new Set,d=[];i.forEach(function(_){n.set(_.name,_)});function m(_){l.add(_.name);var v=[].concat(_.requires||[],_.requiresIfExists||[]);v.forEach(function(c){if(!l.has(c)){var C=n.get(c);C&&m(C)}}),d.push(_)}return i.forEach(function(_){l.has(_.name)||m(_)}),d}function LD(i){var n=ND(i);return WC.reduce(function(l,d){return l.concat(n.filter(function(m){return m.phase===d}))},[])}function OD(i){var n;return function(){return n||(n=new Promise(function(l){Promise.resolve().then(function(){n=void 0,l(i())})})),n}}function jD(i){var n=i.reduce(function(l,d){var m=l[d.name];return l[d.name]=m?Object.assign({},m,d,{options:Object.assign({},m.options,d.options),data:Object.assign({},m.data,d.data)}):d,l},{});return Object.keys(n).map(function(l){return n[l]})}var tw={placement:"bottom",modifiers:[],strategy:"absolute"};function nw(){for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return!n.some(function(d){return!(d&&typeof d.getBoundingClientRect=="function")})}function BD(i){i===void 0&&(i={});var n=i,l=n.defaultModifiers,d=l===void 0?[]:l,m=n.defaultOptions,_=m===void 0?tw:m;return function(c,C,R){R===void 0&&(R=_);var N={placement:"bottom",orderedModifiers:[],options:Object.assign({},tw,_),modifiersData:{},elements:{reference:c,popper:C},attributes:{},styles:{}},B=[],V=!1,G={state:N,setOptions:function(Ne){var Ve=typeof Ne=="function"?Ne(N.options):Ne;me(),N.options=Object.assign({},_,N.options,Ve),N.scrollParents={reference:Dp(c)?Uy(c):c.contextElement?Uy(c.contextElement):[],popper:Uy(C)};var Fe=LD(jD([].concat(d,N.options.modifiers)));return N.orderedModifiers=Fe.filter(function(qe){return qe.enabled}),ae(),G.update()},forceUpdate:function(){if(!V){var Ne=N.elements,Ve=Ne.reference,Fe=Ne.popper;if(nw(Ve,Fe)){N.rects={reference:zD(Ve,g_(Fe),N.options.strategy==="fixed"),popper:vx(Fe)},N.reset=!1,N.placement=N.options.placement,N.orderedModifiers.forEach(function(rt){return N.modifiersData[rt.name]=Object.assign({},rt.data)});for(var qe=0;qe<N.orderedModifiers.length;qe++){if(N.reset===!0){N.reset=!1,qe=-1;continue}var Ae=N.orderedModifiers[qe],Ke=Ae.fn,mt=Ae.options,st=mt===void 0?{}:mt,Pe=Ae.name;typeof Ke=="function"&&(N=Ke({state:N,options:st,name:Pe,instance:G})||N)}}}},update:OD(function(){return new Promise(function(pe){G.forceUpdate(),pe(N)})}),destroy:function(){me(),V=!0}};if(!nw(c,C))return G;G.setOptions(R).then(function(pe){!V&&R.onFirstUpdate&&R.onFirstUpdate(pe)});function ae(){N.orderedModifiers.forEach(function(pe){var Ne=pe.name,Ve=pe.options,Fe=Ve===void 0?{}:Ve,qe=pe.effect;if(typeof qe=="function"){var Ae=qe({state:N,name:Ne,instance:G,options:Fe}),Ke=function(){};B.push(Ae||Ke)}})}function me(){B.forEach(function(pe){return pe()}),B=[]}return G}}const FD=BD({defaultModifiers:[wD,MD,oD,cD,ED,bD,kD,iD]}),UD=["enabled","placement","strategy","modifiers"];function VD(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}const GD={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},ZD={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:i})=>()=>{const{reference:n,popper:l}=i.elements;if("removeAttribute"in n){const d=(n.getAttribute("aria-describedby")||"").split(",").filter(m=>m.trim()!==l.id);d.length?n.setAttribute("aria-describedby",d.join(",")):n.removeAttribute("aria-describedby")}},fn:({state:i})=>{var n;const{popper:l,reference:d}=i.elements,m=(n=l.getAttribute("role"))==null?void 0:n.toLowerCase();if(l.id&&m==="tooltip"&&"setAttribute"in d){const _=d.getAttribute("aria-describedby");if(_&&_.split(",").indexOf(l.id)!==-1)return;d.setAttribute("aria-describedby",_?`${_},${l.id}`:l.id)}}},$D=[];function YD(i,n,l={}){let{enabled:d=!0,placement:m="bottom",strategy:_="absolute",modifiers:v=$D}=l,c=VD(l,UD);const C=ce.useRef(v),R=ce.useRef(),N=ce.useCallback(()=>{var pe;(pe=R.current)==null||pe.update()},[]),B=ce.useCallback(()=>{var pe;(pe=R.current)==null||pe.forceUpdate()},[]),[V,G]=jC(ce.useState({placement:m,update:N,forceUpdate:B,attributes:{},styles:{popper:{},arrow:{}}})),ae=ce.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:pe})=>{const Ne={},Ve={};Object.keys(pe.elements).forEach(Fe=>{Ne[Fe]=pe.styles[Fe],Ve[Fe]=pe.attributes[Fe]}),G({state:pe,styles:Ne,attributes:Ve,update:N,forceUpdate:B,placement:pe.placement})}}),[N,B,G]),me=ce.useMemo(()=>(By(C.current,v)||(C.current=v),C.current),[v]);return ce.useEffect(()=>{!R.current||!d||R.current.setOptions({placement:m,strategy:_,modifiers:[...me,ae,GD]})},[_,m,ae,d,me]),ce.useEffect(()=>{if(!(!d||i==null||n==null))return R.current=FD(i,n,Object.assign({},c,{placement:m,strategy:_,modifiers:[...me,ZD,ae]})),()=>{R.current!=null&&(R.current.destroy(),R.current=void 0,G(pe=>Object.assign({},pe,{attributes:{},styles:{popper:{}}})))}},[d,i,n]),V}function $0(i,n){if(i.contains)return i.contains(n);if(i.compareDocumentPosition)return i===n||!!(i.compareDocumentPosition(n)&16)}var ob,iw;function qD(){if(iw)return ob;iw=1;var i=function(){};return ob=i,ob}var HD=qD();const XD=Lp(HD),rw=()=>{};function WD(i){return i.button===0}function QD(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}const j0=i=>i&&("current"in i?i.current:i),aw={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function KD(i,n=rw,{disabled:l,clickTrigger:d="click"}={}){const m=ce.useRef(!1),_=ce.useRef(!1),v=ce.useCallback(R=>{const N=j0(i);XD(!!N,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),m.current=!N||QD(R)||!WD(R)||!!$0(N,R.target)||_.current,_.current=!1},[i]),c=Iu(R=>{const N=j0(i);N&&$0(N,R.target)?_.current=!0:_.current=!1}),C=Iu(R=>{m.current||n(R)});ce.useEffect(()=>{var R,N;if(l||i==null)return;const B=d_(j0(i)),V=B.defaultView||window;let G=(R=V.event)!=null?R:(N=V.parent)==null?void 0:N.event,ae=null;aw[d]&&(ae=Xh(B,aw[d],c,!0));const me=Xh(B,d,v,!0),pe=Xh(B,d,Ve=>{if(Ve===G){G=void 0;return}C(Ve)});let Ne=[];return"ontouchstart"in B.documentElement&&(Ne=[].slice.call(B.body.children).map(Ve=>Xh(Ve,"mousemove",rw))),()=>{ae?.(),me(),pe(),Ne.forEach(Ve=>Ve())}},[i,l,d,v,c,C])}function JD(i){const n={};return Array.isArray(i)?(i?.forEach(l=>{n[l.name]=l}),n):i||n}function ek(i={}){return Array.isArray(i)?i:Object.keys(i).map(n=>(i[n].name=n,i[n]))}function tk({enabled:i,enableEvents:n,placement:l,flip:d,offset:m,fixed:_,containerPadding:v,arrowElement:c,popperConfig:C={}}){var R,N,B,V;const G=JD(C.modifiers);return Object.assign({},C,{placement:l,enabled:i,strategy:_?"fixed":C.strategy,modifiers:ek(Object.assign({},G,{eventListeners:{enabled:n,options:(R=G.eventListeners)==null?void 0:R.options},preventOverflow:Object.assign({},G.preventOverflow,{options:Object.assign({padding:v},(N=G.preventOverflow)==null?void 0:N.options)}),offset:{options:Object.assign({offset:m},(B=G.offset)==null?void 0:B.options)},arrow:Object.assign({},G.arrow,{enabled:!!c,options:Object.assign({},(V=G.arrow)==null?void 0:V.options,{element:c})}),flip:Object.assign({enabled:!!d},G.flip)}))})}const nk=ce.createContext(null),ik="data-rr-ui-";function rk(i){return`${ik}${i}`}const mT=ce.createContext(dv?window:void 0);mT.Provider;function Sx(){return ce.useContext(mT)}const ak=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",sk=typeof document<"u",gT=sk||ak?ce.useLayoutEffect:ce.useEffect,y_=ce.createContext(null);y_.displayName="NavbarContext";const ok={type:td.string,tooltip:td.bool,as:td.elementType},gv=ce.forwardRef(({as:i="div",className:n,type:l="valid",tooltip:d=!1,...m},_)=>ie.jsx(i,{...m,ref:_,className:An(n,`${l}-${d?"tooltip":"feedback"}`)}));gv.displayName="Feedback";gv.propTypes=ok;const ld=ce.createContext({}),Ex=ce.forwardRef(({id:i,bsPrefix:n,className:l,type:d="checkbox",isValid:m=!1,isInvalid:_=!1,as:v="input",...c},C)=>{const{controlId:R}=ce.useContext(ld);return n=Bn(n,"form-check-input"),ie.jsx(v,{...c,ref:C,type:d,id:i||R,className:An(l,n,m&&"is-valid",_&&"is-invalid")})});Ex.displayName="FormCheckInput";const Y0=ce.forwardRef(({bsPrefix:i,className:n,htmlFor:l,...d},m)=>{const{controlId:_}=ce.useContext(ld);return i=Bn(i,"form-check-label"),ie.jsx("label",{...d,ref:m,htmlFor:l||_,className:An(n,i)})});Y0.displayName="FormCheckLabel";const yT=ce.forwardRef(({id:i,bsPrefix:n,bsSwitchPrefix:l,inline:d=!1,reverse:m=!1,disabled:_=!1,isValid:v=!1,isInvalid:c=!1,feedbackTooltip:C=!1,feedback:R,feedbackType:N,className:B,style:V,title:G="",type:ae="checkbox",label:me,children:pe,as:Ne="input",...Ve},Fe)=>{n=Bn(n,"form-check"),l=Bn(l,"form-switch");const{controlId:qe}=ce.useContext(ld),Ae=ce.useMemo(()=>({controlId:i||qe}),[qe,i]),Ke=!pe&&me!=null&&me!==!1||NC(pe,Y0),mt=ie.jsx(Ex,{...Ve,type:ae==="switch"?"checkbox":ae,ref:Fe,isValid:v,isInvalid:c,disabled:_,as:Ne});return ie.jsx(ld.Provider,{value:Ae,children:ie.jsx("div",{style:V,className:An(B,Ke&&n,d&&`${n}-inline`,m&&`${n}-reverse`,ae==="switch"&&l),children:pe||ie.jsxs(ie.Fragment,{children:[mt,Ke&&ie.jsx(Y0,{title:G,children:me}),R&&ie.jsx(gv,{type:N,tooltip:C,children:R})]})})})});yT.displayName="FormCheck";const q0=Object.assign(yT,{Input:Ex,Label:Y0}),_T=ce.forwardRef(({bsPrefix:i,type:n,size:l,htmlSize:d,id:m,className:_,isValid:v=!1,isInvalid:c=!1,plaintext:C,readOnly:R,as:N="input",...B},V)=>{const{controlId:G}=ce.useContext(ld);return i=Bn(i,"form-control"),ie.jsx(N,{...B,type:n,size:d,ref:V,readOnly:R,id:m||G,className:An(_,C?`${i}-plaintext`:i,l&&`${i}-${l}`,n==="color"&&`${i}-color`,v&&"is-valid",c&&"is-invalid")})});_T.displayName="FormControl";const lk=Object.assign(_T,{Feedback:gv}),vT=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Bn(n,"form-floating"),ie.jsx(l,{ref:m,className:An(i,n),...d})));vT.displayName="FormFloating";const Ax=ce.forwardRef(({controlId:i,as:n="div",...l},d)=>{const m=ce.useMemo(()=>({controlId:i}),[i]);return ie.jsx(ld.Provider,{value:m,children:ie.jsx(n,{...l,ref:d})})});Ax.displayName="FormGroup";const bT=ce.forwardRef(({as:i="label",bsPrefix:n,column:l=!1,visuallyHidden:d=!1,className:m,htmlFor:_,...v},c)=>{const{controlId:C}=ce.useContext(ld);n=Bn(n,"form-label");let R="col-form-label";typeof l=="string"&&(R=`${R} ${R}-${l}`);const N=An(m,n,d&&"visually-hidden",l&&R);return _=_||C,l?ie.jsx(aT,{ref:c,as:"label",className:N,htmlFor:_,...v}):ie.jsx(i,{ref:c,className:N,htmlFor:_,...v})});bT.displayName="FormLabel";const xT=ce.forwardRef(({bsPrefix:i,className:n,id:l,...d},m)=>{const{controlId:_}=ce.useContext(ld);return i=Bn(i,"form-range"),ie.jsx("input",{...d,type:"range",ref:m,className:An(n,i),id:l||_})});xT.displayName="FormRange";const wT=ce.forwardRef(({bsPrefix:i,size:n,htmlSize:l,className:d,isValid:m=!1,isInvalid:_=!1,id:v,...c},C)=>{const{controlId:R}=ce.useContext(ld);return i=Bn(i,"form-select"),ie.jsx("select",{...c,size:l,ref:C,className:An(d,i,n&&`${i}-${n}`,m&&"is-valid",_&&"is-invalid"),id:v||R})});wT.displayName="FormSelect";const TT=ce.forwardRef(({bsPrefix:i,className:n,as:l="small",muted:d,...m},_)=>(i=Bn(i,"form-text"),ie.jsx(l,{...m,ref:_,className:An(n,i,d&&"text-muted")})));TT.displayName="FormText";const ST=ce.forwardRef((i,n)=>ie.jsx(q0,{...i,ref:n,type:"switch"}));ST.displayName="Switch";const ck=Object.assign(ST,{Input:q0.Input,Label:q0.Label}),ET=ce.forwardRef(({bsPrefix:i,className:n,children:l,controlId:d,label:m,..._},v)=>(i=Bn(i,"form-floating"),ie.jsxs(Ax,{ref:v,className:An(n,i),controlId:d,..._,children:[l,ie.jsx("label",{htmlFor:d,children:m})]})));ET.displayName="FloatingLabel";const uk={_ref:td.any,validated:td.bool,as:td.elementType},Mx=ce.forwardRef(({className:i,validated:n,as:l="form",...d},m)=>ie.jsx(l,{...d,ref:m,className:An(i,n&&"was-validated")}));Mx.displayName="Form";Mx.propTypes=uk;const Si=Object.assign(Mx,{Group:Ax,Control:lk,Floating:vT,Check:q0,Switch:ck,Label:bT,Text:TT,Range:xT,Select:wT,FloatingLabel:ET}),sw=i=>!i||typeof i=="function"?i:n=>{i.current=n};function hk(i,n){const l=sw(i),d=sw(n);return m=>{l&&l(m),d&&d(m)}}function yv(i,n){return ce.useMemo(()=>hk(i,n),[i,n])}function lb(i){i===void 0&&(i=d_());try{var n=i.activeElement;return!n||!n.nodeName?null:n}catch{return i.body}}function dk(i){const n=ce.useRef(i);return n.current=i,n}function fk(i){const n=dk(i);ce.useEffect(()=>()=>n.current(),[])}function pk(i=document){const n=i.defaultView;return Math.abs(n.innerWidth-i.documentElement.clientWidth)}const ow=rk("modal-open");class Cx{constructor({ownerDocument:n,handleContainerOverflow:l=!0,isRTL:d=!1}={}){this.handleContainerOverflow=l,this.isRTL=d,this.modals=[],this.ownerDocument=n}getScrollbarWidth(){return pk(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(n){}removeModalAttributes(n){}setContainerStyle(n){const l={overflow:"hidden"},d=this.isRTL?"paddingLeft":"paddingRight",m=this.getElement();n.style={overflow:m.style.overflow,[d]:m.style[d]},n.scrollBarWidth&&(l[d]=`${parseInt(ed(m,d)||"0",10)+n.scrollBarWidth}px`),m.setAttribute(ow,""),ed(m,l)}reset(){[...this.modals].forEach(n=>this.remove(n))}removeContainerStyle(n){const l=this.getElement();l.removeAttribute(ow),Object.assign(l.style,n.style)}add(n){let l=this.modals.indexOf(n);return l!==-1||(l=this.modals.length,this.modals.push(n),this.setModalAttributes(n),l!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),l}remove(n){const l=this.modals.indexOf(n);l!==-1&&(this.modals.splice(l,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(n))}isTopModal(n){return!!this.modals.length&&this.modals[this.modals.length-1]===n}}const cb=(i,n)=>dv?i==null?(n||d_()).body:(typeof i=="function"&&(i=i()),i&&"current"in i&&(i=i.current),i&&("nodeType"in i||i.getBoundingClientRect)?i:null):null;function Rb(i,n){const l=Sx(),[d,m]=ce.useState(()=>cb(i,l?.document));if(!d){const _=cb(i);_&&m(_)}return ce.useEffect(()=>{},[n,d]),ce.useEffect(()=>{const _=cb(i);_!==d&&m(_)},[i,d]),d}function mk({children:i,in:n,onExited:l,mountOnEnter:d,unmountOnExit:m}){const _=ce.useRef(null),v=ce.useRef(n),c=Iu(l);ce.useEffect(()=>{n?v.current=!0:c(_.current)},[n,c]);const C=yv(_,_g(i)),R=ce.cloneElement(i,{ref:C});return n?R:m||!v.current&&d?null:R}const gk=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function yk(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}function _k(i){let{onEnter:n,onEntering:l,onEntered:d,onExit:m,onExiting:_,onExited:v,addEndListener:c,children:C}=i,R=yk(i,gk);const N=ce.useRef(null),B=yv(N,_g(C)),V=qe=>Ae=>{qe&&N.current&&qe(N.current,Ae)},G=ce.useCallback(V(n),[n]),ae=ce.useCallback(V(l),[l]),me=ce.useCallback(V(d),[d]),pe=ce.useCallback(V(m),[m]),Ne=ce.useCallback(V(_),[_]),Ve=ce.useCallback(V(v),[v]),Fe=ce.useCallback(V(c),[c]);return Object.assign({},R,{nodeRef:N},n&&{onEnter:G},l&&{onEntering:ae},d&&{onEntered:me},m&&{onExit:pe},_&&{onExiting:Ne},v&&{onExited:Ve},c&&{addEndListener:Fe},{children:typeof C=="function"?(qe,Ae)=>C(qe,Object.assign({},Ae,{ref:B})):ce.cloneElement(C,{ref:B})})}const vk=["component"];function bk(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}const xk=ce.forwardRef((i,n)=>{let{component:l}=i,d=bk(i,vk);const m=_k(d);return ie.jsx(l,Object.assign({ref:n},m))});function wk({in:i,onTransition:n}){const l=ce.useRef(null),d=ce.useRef(!0),m=Iu(n);return $1(()=>{if(!l.current)return;let _=!1;return m({in:i,element:l.current,initial:d.current,isStale:()=>_}),()=>{_=!0}},[i,m]),$1(()=>(d.current=!1,()=>{d.current=!0}),[]),l}function Tk({children:i,in:n,onExited:l,onEntered:d,transition:m}){const[_,v]=ce.useState(!n);n&&_&&v(!1);const c=wk({in:!!n,onTransition:R=>{const N=()=>{R.isStale()||(R.in?d?.(R.element,R.initial):(v(!0),l?.(R.element)))};Promise.resolve(m(R)).then(N,B=>{throw R.in||v(!0),B})}}),C=yv(c,_g(i));return _&&!n?null:ce.cloneElement(i,{ref:C})}function Pb(i,n,l){return i?ie.jsx(xk,Object.assign({},l,{component:i})):n?ie.jsx(Tk,Object.assign({},l,{transition:n})):ie.jsx(mk,Object.assign({},l))}const Sk=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Ek(i,n){if(i==null)return{};var l={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(n.indexOf(d)>=0)continue;l[d]=i[d]}return l}let ub;function Ak(i){return ub||(ub=new Cx({ownerDocument:i?.document})),ub}function Mk(i){const n=Sx(),l=i||Ak(n),d=ce.useRef({dialog:null,backdrop:null});return Object.assign(d.current,{add:()=>l.add(d.current),remove:()=>l.remove(d.current),isTopModal:()=>l.isTopModal(d.current),setDialogRef:ce.useCallback(m=>{d.current.dialog=m},[]),setBackdropRef:ce.useCallback(m=>{d.current.backdrop=m},[])})}const AT=ce.forwardRef((i,n)=>{let{show:l=!1,role:d="dialog",className:m,style:_,children:v,backdrop:c=!0,keyboard:C=!0,onBackdropClick:R,onEscapeKeyDown:N,transition:B,runTransition:V,backdropTransition:G,runBackdropTransition:ae,autoFocus:me=!0,enforceFocus:pe=!0,restoreFocus:Ne=!0,restoreFocusOptions:Ve,renderDialog:Fe,renderBackdrop:qe=Rn=>ie.jsx("div",Object.assign({},Rn)),manager:Ae,container:Ke,onShow:mt,onHide:st=()=>{},onExit:Pe,onExited:rt,onExiting:Mt,onEnter:Rt,onEntering:jt,onEntered:en}=i,ln=Ek(i,Sk);const Ge=Sx(),ct=Rb(Ke),ht=Mk(Ae),kt=iT(),Ee=AC(l),[nt,Ct]=ce.useState(!l),bt=ce.useRef(null);ce.useImperativeHandle(n,()=>ht,[ht]),dv&&!Ee&&l&&(bt.current=lb(Ge?.document)),l&&nt&&Ct(!1);const Pt=Iu(()=>{if(ht.add(),Ea.current=Xh(document,"keydown",mn),mi.current=Xh(document,"focus",()=>setTimeout(Bt),!0),mt&&mt(),me){var Rn,Yr;const ji=lb((Rn=(Yr=ht.dialog)==null?void 0:Yr.ownerDocument)!=null?Rn:Ge?.document);ht.dialog&&ji&&!$0(ht.dialog,ji)&&(bt.current=ji,ht.dialog.focus())}}),Xt=Iu(()=>{if(ht.remove(),Ea.current==null||Ea.current(),mi.current==null||mi.current(),Ne){var Rn;(Rn=bt.current)==null||Rn.focus==null||Rn.focus(Ve),bt.current=null}});ce.useEffect(()=>{!l||!ct||Pt()},[l,ct,Pt]),ce.useEffect(()=>{nt&&Xt()},[nt,Xt]),fk(()=>{Xt()});const Bt=Iu(()=>{if(!pe||!kt()||!ht.isTopModal())return;const Rn=lb(Ge?.document);ht.dialog&&Rn&&!$0(ht.dialog,Rn)&&ht.dialog.focus()}),Ei=Iu(Rn=>{Rn.target===Rn.currentTarget&&(R?.(Rn),c===!0&&st())}),mn=Iu(Rn=>{C&&X2(Rn)&&ht.isTopModal()&&(N?.(Rn),Rn.defaultPrevented||st())}),mi=ce.useRef(),Ea=ce.useRef(),ua=(...Rn)=>{Ct(!0),rt?.(...Rn)};if(!ct)return null;const ur=Object.assign({role:d,ref:ht.setDialogRef,"aria-modal":d==="dialog"?!0:void 0},ln,{style:_,className:m,tabIndex:-1});let Gn=Fe?Fe(ur):ie.jsx("div",Object.assign({},ur,{children:ce.cloneElement(v,{role:"document"})}));Gn=Pb(B,V,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!l,onExit:Pe,onExiting:Mt,onExited:ua,onEnter:Rt,onEntering:jt,onEntered:en,children:Gn});let Xn=null;return c&&(Xn=qe({ref:ht.setBackdropRef,onClick:Ei}),Xn=Pb(G,ae,{in:!!l,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Xn})),ie.jsx(ie.Fragment,{children:bp.createPortal(ie.jsxs(ie.Fragment,{children:[Xn,Gn]}),ct)})});AT.displayName="Modal";const Ck=Object.assign(AT,{Manager:Cx});function zb(i,n){return i.classList?!!n&&i.classList.contains(n):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+n+" ")!==-1}function Dk(i,n){i.classList?i.classList.add(n):zb(i,n)||(typeof i.className=="string"?i.className=i.className+" "+n:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+n))}function lw(i,n){return i.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function kk(i,n){i.classList?i.classList.remove(n):typeof i.className=="string"?i.className=lw(i.className,n):i.setAttribute("class",lw(i.className&&i.className.baseVal||"",n))}const Vm={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class MT extends Cx{adjustAndStore(n,l,d){const m=l.style[n];l.dataset[n]=m,ed(l,{[n]:`${parseFloat(ed(l,n))+d}px`})}restore(n,l){const d=l.dataset[n];d!==void 0&&(delete l.dataset[n],ed(l,{[n]:d}))}setContainerStyle(n){super.setContainerStyle(n);const l=this.getElement();if(Dk(l,"modal-open"),!n.scrollBarWidth)return;const d=this.isRTL?"paddingLeft":"paddingRight",m=this.isRTL?"marginLeft":"marginRight";Um(l,Vm.FIXED_CONTENT).forEach(_=>this.adjustAndStore(d,_,n.scrollBarWidth)),Um(l,Vm.STICKY_CONTENT).forEach(_=>this.adjustAndStore(m,_,-n.scrollBarWidth)),Um(l,Vm.NAVBAR_TOGGLER).forEach(_=>this.adjustAndStore(m,_,n.scrollBarWidth))}removeContainerStyle(n){super.removeContainerStyle(n);const l=this.getElement();kk(l,"modal-open");const d=this.isRTL?"paddingLeft":"paddingRight",m=this.isRTL?"marginLeft":"marginRight";Um(l,Vm.FIXED_CONTENT).forEach(_=>this.restore(d,_)),Um(l,Vm.STICKY_CONTENT).forEach(_=>this.restore(m,_)),Um(l,Vm.NAVBAR_TOGGLER).forEach(_=>this.restore(m,_))}}let hb;function Ik(i){return hb||(hb=new MT(i)),hb}const CT=ce.createContext({onHide(){}}),DT=ce.forwardRef(({closeLabel:i="Close",closeVariant:n,closeButton:l=!1,onHide:d,children:m,..._},v)=>{const c=ce.useContext(CT),C=p_(()=>{c?.onHide(),d?.()});return ie.jsxs("div",{ref:v,..._,children:[m,l&&ie.jsx(mx,{"aria-label":i,variant:n,onClick:C})]})});DT.displayName="AbstractModalHeader";const kT=ce.forwardRef(({bsPrefix:i,className:n,as:l,...d},m)=>{i=Bn(i,"navbar-brand");const _=l||(d.href?"a":"span");return ie.jsx(_,{...d,ref:m,className:An(n,i)})});kT.displayName="NavbarBrand";const IT=ce.forwardRef(({children:i,bsPrefix:n,...l},d)=>{n=Bn(n,"navbar-collapse");const m=ce.useContext(y_);return ie.jsx(dx,{in:!!(m&&m.expanded),...l,children:ie.jsx("div",{ref:d,className:n,children:i})})});IT.displayName="NavbarCollapse";const RT=ce.forwardRef(({bsPrefix:i,className:n,children:l,label:d="Toggle navigation",as:m="button",onClick:_,...v},c)=>{i=Bn(i,"navbar-toggler");const{onToggle:C,expanded:R}=ce.useContext(y_)||{},N=p_(B=>{_&&_(B),C&&C()});return m==="button"&&(v.type="button"),ie.jsx(m,{...v,ref:c,onClick:N,"aria-label":d,className:An(n,i,!R&&"collapsed"),children:l||ie.jsx("span",{className:`${i}-icon`})})});RT.displayName="NavbarToggle";const Nb=new WeakMap,cw=(i,n)=>{if(!i||!n)return;const l=Nb.get(n)||new Map;Nb.set(n,l);let d=l.get(i);return d||(d=n.matchMedia(i),d.refCount=0,l.set(d.media,d)),d};function Rk(i,n=typeof window>"u"?void 0:window){const l=cw(i,n),[d,m]=ce.useState(()=>l?l.matches:!1);return gT(()=>{let _=cw(i,n);if(!_)return m(!1);let v=Nb.get(n);const c=()=>{m(_.matches)};return _.refCount++,_.addListener(c),c(),()=>{_.removeListener(c),_.refCount--,_.refCount<=0&&v?.delete(_.media),_=void 0}},[i]),d}function Pk(i){const n=Object.keys(i);function l(c,C){return c===C?C:c?`${c} and ${C}`:C}function d(c){return n[Math.min(n.indexOf(c)+1,n.length-1)]}function m(c){const C=d(c);let R=i[C];return typeof R=="number"?R=`${R-.2}px`:R=`calc(${R} - 0.2px)`,`(max-width: ${R})`}function _(c){let C=i[c];return typeof C=="number"&&(C=`${C}px`),`(min-width: ${C})`}function v(c,C,R){let N;typeof c=="object"?(N=c,R=C,C=!0):(C=C||!0,N={[c]:C});let B=ce.useMemo(()=>Object.entries(N).reduce((V,[G,ae])=>((ae==="up"||ae===!0)&&(V=l(V,_(G))),(ae==="down"||ae===!0)&&(V=l(V,m(G))),V),""),[JSON.stringify(N)]);return Rk(B,R)}return v}const zk=Pk({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),PT=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Bn(n,"offcanvas-body"),ie.jsx(l,{ref:m,className:An(i,n),...d})));PT.displayName="OffcanvasBody";const Nk={[jc]:"show",[$h]:"show"},zT=ce.forwardRef(({bsPrefix:i,className:n,children:l,in:d=!1,mountOnEnter:m=!1,unmountOnExit:_=!1,appear:v=!1,...c},C)=>(i=Bn(i,"offcanvas"),ie.jsx(fv,{ref:C,addEndListener:hx,in:d,mountOnEnter:m,unmountOnExit:_,appear:v,...c,childRef:_g(l),children:(R,N)=>ce.cloneElement(l,{...N,className:An(n,l.props.className,(R===jc||R===Qy)&&`${i}-toggling`,Nk[R])})})));zT.displayName="OffcanvasToggling";const NT=ce.forwardRef(({bsPrefix:i,className:n,closeLabel:l="Close",closeButton:d=!1,...m},_)=>(i=Bn(i,"offcanvas-header"),ie.jsx(DT,{ref:_,...m,className:An(n,i),closeLabel:l,closeButton:d})));NT.displayName="OffcanvasHeader";const Lk=SC("h5"),LT=ce.forwardRef(({className:i,bsPrefix:n,as:l=Lk,...d},m)=>(n=Bn(n,"offcanvas-title"),ie.jsx(l,{ref:m,className:An(i,n),...d})));LT.displayName="OffcanvasTitle";function Ok(i){return ie.jsx(zT,{...i})}function jk(i){return ie.jsx(G0,{...i})}const OT=ce.forwardRef(({bsPrefix:i,className:n,children:l,"aria-labelledby":d,placement:m="start",responsive:_,show:v=!1,backdrop:c=!0,keyboard:C=!0,scroll:R=!1,onEscapeKeyDown:N,onShow:B,onHide:V,container:G,autoFocus:ae=!0,enforceFocus:me=!0,restoreFocus:pe=!0,restoreFocusOptions:Ne,onEntered:Ve,onExit:Fe,onExiting:qe,onEnter:Ae,onEntering:Ke,onExited:mt,backdropClassName:st,manager:Pe,renderStaticNode:rt=!1,...Mt},Rt)=>{const jt=ce.useRef();i=Bn(i,"offcanvas");const[en,ln]=ce.useState(!1),Ge=p_(V),ct=zk(_||"xs","up");ce.useEffect(()=>{ln(_?v&&!ct:v)},[v,_,ct]);const ht=ce.useMemo(()=>({onHide:Ge}),[Ge]);function kt(){return Pe||(R?(jt.current||(jt.current=new MT({handleContainerOverflow:!1})),jt.current):Ik())}const Ee=(Pt,...Xt)=>{Pt&&(Pt.style.visibility="visible"),Ae?.(Pt,...Xt)},nt=(Pt,...Xt)=>{Pt&&(Pt.style.visibility=""),mt?.(...Xt)},Ct=ce.useCallback(Pt=>ie.jsx("div",{...Pt,className:An(`${i}-backdrop`,st)}),[st,i]),bt=Pt=>ie.jsx("div",{...Pt,...Mt,className:An(n,_?`${i}-${_}`:i,`${i}-${m}`),"aria-labelledby":d,children:l});return ie.jsxs(ie.Fragment,{children:[!en&&(_||rt)&&bt({}),ie.jsx(CT.Provider,{value:ht,children:ie.jsx(Ck,{show:en,ref:Rt,backdrop:c,container:G,keyboard:C,autoFocus:ae,enforceFocus:me&&!R,restoreFocus:pe,restoreFocusOptions:Ne,onEscapeKeyDown:N,onShow:B,onHide:Ge,onEnter:Ee,onEntering:Ke,onEntered:Ve,onExit:Fe,onExiting:qe,onExited:nt,manager:kt(),transition:Ok,backdropTransition:jk,renderBackdrop:Ct,renderDialog:bt})})]})});OT.displayName="Offcanvas";const Bk=Object.assign(OT,{Body:PT,Header:NT,Title:LT}),jT=ce.forwardRef(({onHide:i,...n},l)=>{const d=ce.useContext(y_),m=p_(()=>{d==null||d.onToggle==null||d.onToggle(),i?.()});return ie.jsx(Bk,{ref:l,show:!!(d!=null&&d.expanded),...n,renderStaticNode:!0,onHide:m})});jT.displayName="NavbarOffcanvas";const BT=ce.forwardRef(({className:i,bsPrefix:n,as:l="span",...d},m)=>(n=Bn(n,"navbar-text"),ie.jsx(l,{ref:m,className:An(i,n),...d})));BT.displayName="NavbarText";const FT=ce.forwardRef((i,n)=>{const{bsPrefix:l,expand:d=!0,variant:m="light",bg:_,fixed:v,sticky:c,className:C,as:R="nav",expanded:N,onToggle:B,onSelect:V,collapseOnSelect:G=!1,...ae}=Y2(i,{expanded:"onToggle"}),me=Bn(l,"navbar"),pe=ce.useCallback((...Fe)=>{V?.(...Fe),G&&N&&B?.(!1)},[V,G,N,B]);ae.role===void 0&&R!=="nav"&&(ae.role="navigation");let Ne=`${me}-expand`;typeof d=="string"&&(Ne=`${Ne}-${d}`);const Ve=ce.useMemo(()=>({onToggle:()=>B?.(!N),bsPrefix:me,expanded:!!N,expand:d}),[me,N,d,B]);return ie.jsx(y_.Provider,{value:Ve,children:ie.jsx(nk.Provider,{value:pe,children:ie.jsx(R,{ref:n,...ae,className:An(C,me,d&&Ne,m&&`${me}-${m}`,_&&`bg-${_}`,c&&`sticky-${c}`,v&&`fixed-${v}`)})})})});FT.displayName="Navbar";const Fk=Object.assign(FT,{Brand:kT,Collapse:IT,Offcanvas:jT,Text:BT,Toggle:RT}),Uk=()=>{};function Vk(i,n,{disabled:l,clickTrigger:d}={}){const m=n||Uk;KD(i,m,{disabled:l,clickTrigger:d});const _=Iu(v=>{X2(v)&&m(v)});ce.useEffect(()=>{if(l||i==null)return;const v=d_(j0(i));let c=(v.defaultView||window).event;const C=Xh(v,"keyup",R=>{if(R===c){c=void 0;return}_(R)});return()=>{C()}},[i,l,_])}const UT=ce.forwardRef((i,n)=>{const{flip:l,offset:d,placement:m,containerPadding:_,popperConfig:v={},transition:c,runTransition:C}=i,[R,N]=Z1(),[B,V]=Z1(),G=yv(N,n),ae=Rb(i.container),me=Rb(i.target),[pe,Ne]=ce.useState(!i.show),Ve=YD(me,R,tk({placement:m,enableEvents:!!i.show,containerPadding:_||5,flip:l,offset:d,arrowElement:B,popperConfig:v}));i.show&&pe&&Ne(!1);const Fe=(...Mt)=>{Ne(!0),i.onExited&&i.onExited(...Mt)},qe=i.show||!pe;if(Vk(R,i.onHide,{disabled:!i.rootClose||i.rootCloseDisabled,clickTrigger:i.rootCloseEvent}),!qe)return null;const{onExit:Ae,onExiting:Ke,onEnter:mt,onEntering:st,onEntered:Pe}=i;let rt=i.children(Object.assign({},Ve.attributes.popper,{style:Ve.styles.popper,ref:G}),{popper:Ve,placement:m,show:!!i.show,arrowProps:Object.assign({},Ve.attributes.arrow,{style:Ve.styles.arrow,ref:V})});return rt=Pb(c,C,{in:!!i.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:rt,onExit:Ae,onExiting:Ke,onExited:Fe,onEnter:mt,onEntering:st,onEntered:Pe}),ae?bp.createPortal(rt,ae):null});UT.displayName="Overlay";const VT=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Bn(n,"popover-header"),ie.jsx(l,{ref:m,className:An(i,n),...d})));VT.displayName="PopoverHeader";const Dx=ce.forwardRef(({className:i,bsPrefix:n,as:l="div",...d},m)=>(n=Bn(n,"popover-body"),ie.jsx(l,{ref:m,className:An(i,n),...d})));Dx.displayName="PopoverBody";function GT(i,n){let l=i;return i==="left"?l=n?"end":"start":i==="right"&&(l=n?"start":"end"),l}function ZT(i="absolute"){return{position:i,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const $T=ce.forwardRef(({bsPrefix:i,placement:n="right",className:l,style:d,children:m,body:_,arrowProps:v,hasDoneInitialMeasure:c,popper:C,show:R,...N},B)=>{const V=Bn(i,"popover"),G=q2(),[ae]=n?.split("-")||[],me=GT(ae,G);let pe=d;return R&&!c&&(pe={...d,...ZT(C?.strategy)}),ie.jsxs("div",{ref:B,role:"tooltip",style:pe,"x-placement":ae,className:An(l,V,ae&&`bs-popover-${me}`),...N,children:[ie.jsx("div",{className:"popover-arrow",...v}),_?ie.jsx(Dx,{children:m}):m]})});$T.displayName="Popover";const Gk=Object.assign($T,{Header:VT,Body:Dx,POPPER_OFFSET:[0,8]}),YT=ce.forwardRef(({bsPrefix:i,placement:n="right",className:l,style:d,children:m,arrowProps:_,hasDoneInitialMeasure:v,popper:c,show:C,...R},N)=>{i=Bn(i,"tooltip");const B=q2(),[V]=n?.split("-")||[],G=GT(V,B);let ae=d;return C&&!v&&(ae={...d,...ZT(c?.strategy)}),ie.jsxs("div",{ref:N,style:ae,role:"tooltip","x-placement":V,className:An(l,i,`bs-tooltip-${G}`),...R,children:[ie.jsx("div",{className:"tooltip-arrow",..._}),ie.jsx("div",{className:`${i}-inner`,children:m})]})});YT.displayName="Tooltip";const Zk=Object.assign(YT,{TOOLTIP_OFFSET:[0,6]});function $k(i){const n=ce.useRef(null),l=Bn(void 0,"popover"),d=Bn(void 0,"tooltip"),m=ce.useMemo(()=>({name:"offset",options:{offset:()=>{if(i)return i;if(n.current){if(zb(n.current,l))return Gk.POPPER_OFFSET;if(zb(n.current,d))return Zk.TOOLTIP_OFFSET}return[0,0]}}}),[i,l,d]);return[n,[m]]}function Yk(i,n){const{ref:l}=i,{ref:d}=n;i.ref=l.__wrapped||(l.__wrapped=m=>l(Db(m))),n.ref=d.__wrapped||(d.__wrapped=m=>d(Db(m)))}const qT=ce.forwardRef(({children:i,transition:n=G0,popperConfig:l={},rootClose:d=!1,placement:m="top",show:_=!1,...v},c)=>{const C=ce.useRef({}),[R,N]=ce.useState(null),[B,V]=$k(v.offset),G=Q2(c,B),ae=n===!0?G0:n||void 0,me=p_(pe=>{N(pe),l==null||l.onFirstUpdate==null||l.onFirstUpdate(pe)});return gT(()=>{R&&v.target&&(C.current.scheduleUpdate==null||C.current.scheduleUpdate())},[R,v.target]),ce.useEffect(()=>{_||N(null)},[_]),ie.jsx(UT,{...v,ref:G,popperConfig:{...l,modifiers:V.concat(l.modifiers||[]),onFirstUpdate:me},transition:ae,rootClose:d,placement:m,show:_,children:(pe,{arrowProps:Ne,popper:Ve,show:Fe})=>{var qe;Yk(pe,Ne);const Ae=Ve?.placement,Ke=Object.assign(C.current,{state:Ve?.state,scheduleUpdate:Ve?.update,placement:Ae,outOfBoundaries:(Ve==null||(qe=Ve.state)==null||(qe=qe.modifiersData.hide)==null?void 0:qe.isReferenceHidden)||!1,strategy:l.strategy}),mt=!!R;return typeof i=="function"?i({...pe,placement:Ae,show:Fe,...!n&&Fe&&{className:"show"},popper:Ke,arrowProps:Ne,hasDoneInitialMeasure:mt}):ce.cloneElement(i,{...pe,placement:Ae,arrowProps:Ne,popper:Ke,hasDoneInitialMeasure:mt,className:An(i.props.className,!n&&Fe&&"show"),style:{...i.props.style,...pe.style}})}})});qT.displayName="Overlay";const HT=ce.forwardRef(({bsPrefix:i,variant:n,animation:l="border",size:d,as:m="div",className:_,...v},c)=>{i=Bn(i,"spinner");const C=`${i}-${l}`;return ie.jsx(m,{ref:c,...v,className:An(_,C,d&&`${C}-${d}`,n&&`text-${n}`)})});HT.displayName="Spinner";const XT=ce.forwardRef(({bsPrefix:i,className:n,striped:l,bordered:d,borderless:m,hover:_,size:v,variant:c,responsive:C,...R},N)=>{const B=Bn(i,"table"),V=An(n,B,c&&`${B}-${c}`,v&&`${B}-${v}`,l&&`${B}-${typeof l=="string"?`striped-${l}`:"striped"}`,d&&`${B}-bordered`,m&&`${B}-borderless`,_&&`${B}-hover`),G=ie.jsx("table",{...R,className:V,ref:N});if(C){let ae=`${B}-responsive`;return typeof C=="string"&&(ae=`${ae}-${C}`),ie.jsx("div",{className:ae,children:G})}return G});XT.displayName="Table";function qk({tripQueryVariables:i,setTripQueryVariables:n,coordinates:l,onClose:d}){return ie.jsx(e2,{longitude:l.lng,latitude:l.lat,anchor:"bottom",onClose:d,children:ie.jsxs(gx,{vertical:!0,children:[ie.jsx(Cp,{onClick:()=>{n({...i,from:{coordinates:{latitude:l.lat,longitude:l.lng}}}),d()},children:"Start here"}),ie.jsx(Cp,{onClick:()=>{n({...i,to:{coordinates:{latitude:l.lat,longitude:l.lng}}}),d()},children:"End here"})]})})}function Hk({coordinates:i,properties:n,onClose:l}){return ie.jsxs(e2,{latitude:i.lat,longitude:i.lng,closeButton:!0,onClose:()=>l(),maxWidth:"350px",children:[ie.jsx(XT,{bordered:!0,children:ie.jsx("tbody",{children:Object.entries(n).map(([d,m])=>ie.jsxs("tr",{children:[ie.jsx("th",{scope:"row",children:d}),ie.jsx("td",{children:String(m)})]},d))})}),ie.jsx("div",{className:"geometry-popup-osm-link",children:ie.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${i.lat}&mlon=${i.lng}#map=18/${i.lat}/${i.lng}`,target:"_blank",rel:"noreferrer",children:" osm.org"})})]})}const WT=i=>{const n=i.getStyle();return!n||!n.layers?[]:n.layers.filter(l=>l.type!=="raster"&&!l.id.startsWith("jsx")).filter(l=>i.getLayoutProperty(l.id,"visibility")!=="none").map(l=>l.id)},Xk=({mapRef:i,setInteractiveLayerIds:n})=>{const[l,d]=ce.useState([]),[m,_]=ce.useState({});ce.useEffect(()=>{if(!i)return;const C=i.getMap(),R=()=>{const N=C.getStyle();if(!N||!N.layers)return;const B=N.layers.filter(G=>G.type==="raster").map(G=>{let ae=G.id;const me=G.metadata?.name;return me&&(ae=me),{id:G.id,name:ae}});d(B);const V={};N.layers.filter(G=>G.type!=="raster"&&!G.id.startsWith("jsx")).reverse().forEach(G=>{const ae=G.metadata?.group||"Misc";V[ae]||(V[ae]=[]),V[ae].push({id:G.id,name:G.id})}),_(V)};return C.isStyleLoaded()?R():C.on("styledata",R),()=>{C.off("styledata",R)}},[i]);const v=ce.useCallback((C,R)=>{if(!i)return;const N=i.getMap();N.setLayoutProperty(C,"visibility",R?"visible":"none");const B=WT(N);n(B)},[i,n]),c=ce.useCallback(C=>{if(!i)return;const R=i.getMap();l.forEach(N=>{R.setLayoutProperty(N.id,"visibility",N.id===C?"visible":"none")})},[i,l]);return ie.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[ie.jsx("h4",{style:{marginTop:0},children:"Background"}),ie.jsx("select",{onChange:C=>c(C.target.value),children:l.map(C=>ie.jsx("option",{value:C.id,children:C.name},C.id))}),ie.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(m).map(([C,R])=>{const N=R.every(V=>i?.getMap().getLayoutProperty(V.id,"visibility")!=="none"),B=V=>{R.forEach(G=>{v(G.id,V)})};return ie.jsxs("div",{style:{marginBottom:"10px"},children:[ie.jsx("h6",{style:{margin:"0 0 5px"},children:ie.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[ie.jsx("input",{type:"checkbox",checked:N,onChange:V=>B(V.target.checked),style:{marginRight:"5px"}}),C]})}),R.map(V=>{const G=i?.getMap().getLayoutProperty(V.id,"visibility")!=="none";return ie.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[ie.jsx("input",{type:"checkbox",checked:G,onChange:ae=>v(V.id,ae.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),V.name]},V.id)})]},C)})]})},Wk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class Qk extends ce.Component{constructor(n){super(n),this.state={isSidebarOpen:!1,activeContent:null}}toggleSidebar=n=>{this.setState(l=>({isSidebarOpen:l.activeContent!==n||!l.isSidebarOpen,activeContent:l.activeContent===n?null:n}))};render(){const{isSidebarOpen:n,activeContent:l}=this.state,{position:d,setInteractiveLayerIds:m,mapRef:_}=this.props;return ie.jsxs("div",{children:[ie.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${l==="debugLayer"?"active":""} ${n?"open":""}`,style:{top:"20px"},children:ie.jsx("img",{src:Wk,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),ie.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:n?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:n?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:n&&l==="debugLayer"&&ie.jsx(Xk,{position:d,setInteractiveLayerIds:m,mapRef:_})})]})}}const Kk="/otp/debug/vectortiles/style.json";function Jk({tripQueryVariables:i,setTripQueryVariables:n,tripQueryResult:l,selectedTripPatternIndex:d,loading:m}){const _=VM({tripQueryVariables:i,setTripQueryVariables:n}),[v,c]=ce.useState(null),[C,R]=ce.useState(null),[N,B]=ce.useState([]),[V,G]=ce.useState("auto"),ae=ce.useCallback(()=>G("pointer"),[]),me=ce.useCallback(()=>G("auto"),[]),pe=Ae=>{if(Ae.features){const Ke=Ae.features[0];R({coordinates:Ae.lngLat,feature:Ke})}},Ne=Ae=>{const Ke=Ae.target;if(Ke.getZoom()<2){const mt=Ke.getSource("stops");Ke.fitBounds(mt.bounds,{animate:!1})}},Ve=Ae=>{Ae.target.addControl(new i2.AttributionControl,"bottom-left")};function Fe(Ae){Ne(Ae);const Ke=WT(Ae.target);B(Ke),Ve(Ae)}const qe=ce.useRef(null);return ie.jsx("div",{className:"map-container below-content",children:ie.jsxs(kE,{attributionControl:!1,mapLib:Kw(()=>Promise.resolve().then(()=>r2),void 0),mapStyle:Kk,onDblClick:_,onContextMenu:Ae=>{c(Ae.lngLat)},interactiveLayerIds:N,cursor:V,onMouseEnter:ae,onMouseLeave:me,onClick:pe,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:Fe,ref:qe,children:[ie.jsx(LE,{position:"top-left"}),ie.jsx(LM,{setCursor:G,tripQueryVariables:i,setTripQueryVariables:n,loading:m}),ie.jsx(Qk,{position:"top-right",setInteractiveLayerIds:B,mapRef:qe?.current}),l?.trip.tripPatterns.length&&ie.jsx(BM,{tripPattern:l.trip.tripPatterns[d]}),v&&ie.jsx(qk,{tripQueryVariables:i,setTripQueryVariables:n,coordinates:v,onClose:()=>c(null)}),C?.feature?.properties&&ie.jsx(Hk,{coordinates:C?.coordinates,properties:C?.feature?.properties,onClose:()=>R(null)})]})})}function eI(){const[i,n]=ce.useState(0),l=ce.useRef(null);return ce.useLayoutEffect(()=>{l.current&&n(l.current.getBoundingClientRect().width)},[]),ce.useEffect(()=>{const d=()=>{l.current&&n(l.current.getBoundingClientRect().width)};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]),{containerRef:l,containerWidth:i}}const tI=70,nI=20,Lb=40;function iI(i,n,l,d){const m=ce.useMemo(()=>new Date(d).getTime()-new Date(l).getTime(),[l,d]),_=ce.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(l).getTime())/m,[i.expectedStartTime,l,m]),v=ce.useMemo(()=>new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime(),[i.expectedStartTime,i.expectedEndTime]),c=nI+Lb,R=n-tI-Lb-c,N=c+_*R,B=R*(v/m);return{maxSpan:m,startPx:c,pxSpan:R,widthPx:B,leftPx:N}}const rI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",aI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",sI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",oI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",lI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",cI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",uI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",hI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",dI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",fI="https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-17T06:33/assets/monorail-CEIE-7ZV.png",pI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",mI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABHNCSVQICAgIfAhkiAAAAFtJREFUKJFjYCAOCBGpDif4D8UUG8LAwMDAwESJKaOaaaj5GwOZ8fyfgYHBAomNIYkrBYkyMDD8wKaOhYGBYTEWg9CBJBax5YxYNDBiUYjNYBR1y/FoQgZwlwIAXKYUAUY5kWQAAAAASUVORK5CYII=",gI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",yI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",_I="https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-17T06:33/assets/trolleybus-BefhFtdd.png",vI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function bI(i){return i===wi.Rail||i===wi.Coach||i===wi.Metro||i===wi.Bus||i===wi.Tram||i===wi.Water||i===wi.Air||i===wi.Cableway||i===wi.Funicular||i===wi.Trolleybus||i===wi.Monorail||i===wi.Taxi}function xI(i){const n=wI(i);function l(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const d=l(n[0]/255),m=l(n[1]/255),_=l(n[2]/255);return .2126*d+.7152*m+.0722*_>.179?"#000":"#fff"}function wI(i){return TI(i)}function TI(i){return i.length===4?SI(i):[parseInt(i.slice(1,3),16),parseInt(i.slice(3,5),16),parseInt(i.slice(5,7),16)]}function SI(i){const n=i.slice(1,2),l=i.slice(2,3),d=i.slice(3,4);return[parseInt(n+n,16),parseInt(l+l,16),parseInt(d+d,16)]}function EI(i,n,l,d,m){const _=ce.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(n).getTime())/l,[i.expectedStartTime,n,l]),v=ce.useMemo(()=>m*(new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime())/l-1,[m,i,l]),c=d+_*m+1,C=v>40&&bI(i.mode)&&i.line?.publicCode&&i.line.publicCode.length<=6,R=G2(i),N=ce.useMemo(()=>xI(R),[R]);return{widthPx:v,leftPx:c,legTextColor:N,modeColor:R,showPublicCode:C}}const AI=Object.assign({"../../static/img/mode/air.png":rI,"../../static/img/mode/bicycle.png":aI,"../../static/img/mode/bus.png":sI,"../../static/img/mode/cableway.png":oI,"../../static/img/mode/car.png":lI,"../../static/img/mode/coach.png":cI,"../../static/img/mode/foot.png":uI,"../../static/img/mode/funicular.png":hI,"../../static/img/mode/metro.png":dI,"../../static/img/mode/monorail.png":fI,"../../static/img/mode/rail.png":pI,"../../static/img/mode/scooter.png":mI,"../../static/img/mode/taxi.png":gI,"../../static/img/mode/tram.png":yI,"../../static/img/mode/trolleybus.png":_I,"../../static/img/mode/water.png":vI});function MI(i){return AI[`../../static/img/mode/${i.mode.toLowerCase()}.png`]}function CI({leg:i,earliestStartTime:n,maxSpan:l,startPx:d,pxSpan:m}){const{widthPx:_,leftPx:v,legTextColor:c,modeColor:C,showPublicCode:R}=EI(i,n,l,d,m),N=MI(i);return ie.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${_}px`,left:v,color:c,background:C},children:[ie.jsx("div",{className:"itinerary-header-leg-icon",style:{background:c,maskImage:`url(${N})`,WebkitMaskImage:`url(${N})`}}),R&&ie.jsx("span",{className:"itinerary-header-leg-public-code",children:i.line?.publicCode})]})}function Vy(i,n,l){return new Date(i).toLocaleTimeString("en-US",{timeStyle:l,hourCycle:"h24",timeZone:n})}const __=ce.createContext("UTC");function DI({tripPattern:i,itineraryIndex:n,containerWidth:l,earliestStartTime:d,latestEndTime:m}){const{maxSpan:_,pxSpan:v,startPx:c,widthPx:C,leftPx:R}=iI(i,l,d,m),N=ce.useContext(__),B=ce.useMemo(()=>Vy(i.expectedStartTime,N,"short"),[i.expectedStartTime,N]),V=ce.useMemo(()=>Vy(i.expectedEndTime,N,"short"),[i.expectedEndTime,N]);return ie.jsxs("div",{className:"itinerary-header-wrapper",children:[ie.jsxs("div",{className:"itinerary-header-itinerary-number",children:[n+1,"."]}),ie.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${C+5}px`,left:`${R-2}px`}}),ie.jsx("div",{title:i.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${R-Lb}px`},children:B}),i.legs.map((G,ae)=>ie.jsx(CI,{leg:G,earliestStartTime:d,startPx:c,maxSpan:_,pxSpan:v},G.id||`leg_${ae}`)),ie.jsx("div",{title:i.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${R+C+2}px`},children:V})]})}function kI(i){const n=ce.useMemo(()=>i?.trip.tripPatterns.reduce((d,m)=>d===null?m?.expectedStartTime:new Date(m?.expectedStartTime)<new Date(d)?m.expectedStartTime:d,null)||null,[i?.trip]),l=ce.useMemo(()=>i?.trip.tripPatterns.reduce((d,m)=>d===null?m?.expectedEndTime:new Date(m?.expectedEndTime)>new Date(d)?m.expectedEndTime:d,null)||null,[i?.trip]);return[n,l]}function uw({aimedTime:i,expectedTime:n,hasRealtime:l}){const d=ce.useContext(__);return i!==n?ie.jsxs(ie.Fragment,{children:[ie.jsx("span",{title:n,style:{color:"red"},children:Vy(n,d,"short")}),ie.jsx("span",{title:i,style:{textDecoration:"line-through"},children:Vy(i,d,"short")})]}):ie.jsxs("span",{title:n,children:[Vy(n,d,"short"),l&&ie.jsx("span",{children:" (on time)"})]})}function II(i){const n=i/1e3;return n>100?`${n.toFixed(0)} km`:n>1?`${n.toFixed(1)} km`:`${i.toFixed(0)} m`}function RI(i){const n=Math.floor(i/3600),l=Math.floor(i/60)%60,d=i%60;let m="";return n>0&&(m=`${m}${n}h `),l>0&&(m=`${m}${l}min `),d>1&&(m=`${m}${d}s`),m}const PI="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function zI({leg:i}){return i.interchangeFrom?.staySeated?ie.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:PI,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const NI=yg(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),LI=sl(NI),OI="/graphiql?flavor=transmodel";function jI({legId:i,legName:n}){const l={id:i},d=encodeURIComponent(LI),m=encodeURIComponent(JSON.stringify(l));return ie.jsx("a",{href:OI+"&query="+d+"&variables="+m,target:"_blank",rel:"noreferrer",children:n})}const BI=yg(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),FI=sl(BI),UI="/graphiql?flavor=transmodel";function hw({legId:i,legName:n}){const l={id:i},d=encodeURIComponent(FI),m=encodeURIComponent(JSON.stringify(l));return ie.jsx("a",{href:UI+"&query="+d+"&variables="+m,target:"_blank",rel:"noreferrer",children:n})}const VI=yg(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),GI=sl(VI),ZI="/graphiql?flavor=transmodel";function $I({legId:i,legName:n}){const l={id:i},d=encodeURIComponent(GI),m=encodeURIComponent(JSON.stringify(l));return ie.jsx("a",{href:ZI+"&query="+d+"&variables="+m,target:"_blank",rel:"noreferrer",children:n})}function YI(i){return i.line?.publicCode?i.line.publicCode+" "+i.toEstimatedCall?.destinationDisplay?.frontText:i.line?.name||"unknown"}function qI({leg:i,isLast:n}){return ie.jsxs("div",{className:"itinerary-leg-details",children:[ie.jsxs("div",{className:"times",children:[II(i.distance),", ",RI(i.duration),","," ",ie.jsxs("span",{title:"Generalized cost: "+i.generalizedCost,children:["",i.generalizedCost]})]}),ie.jsx(zI,{leg:i}),ie.jsx(uw,{aimedTime:i.aimedStartTime,expectedTime:i.expectedStartTime,hasRealtime:i.realtime})," -"," ",ie.jsx(uw,{aimedTime:i.aimedEndTime,expectedTime:i.expectedEndTime,hasRealtime:i.realtime}),ie.jsxs("div",{className:"mode",children:[ie.jsx("b",{children:i.mode})," ",i.line&&ie.jsxs(ie.Fragment,{children:[ie.jsx(jI,{legId:i.line?.id,legName:YI(i)}),", ",ie.jsx($I,{legId:i.authority?.id,legName:i.authority?.name})]})," ",i.mode!==wi.Foot&&ie.jsxs(ie.Fragment,{children:[ie.jsx("br",{}),ie.jsx(hw,{legId:i.fromPlace.quay?.id,legName:i.fromPlace.name})," "," "]})," ",!n&&ie.jsx(hw,{legId:i.toPlace.quay?.id,legName:i.toPlace.name})]})]})}function HI({tripPattern:i}){return ie.jsxs("div",{children:[i.systemNotices.length>0&&ie.jsxs("p",{children:["System tags: ",i.systemNotices.map(n=>n.tag).join(", ")]}),i.legs.map((n,l)=>ie.jsx(qI,{leg:n,isLast:l===i.legs.length-1},n.id?n.id:`noid_${l}`)),ie.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ",i.generalizedCost]})]})}function XI({previousPageCursor:i,nextPageCursor:n,onPagination:l,loading:d}){return ie.jsxs("div",{style:{display:"flex",justifyContent:"space-evenly"},children:[ie.jsx(Cp,{variant:"outline-primary",size:"sm",disabled:!i||d,onClick:()=>{i&&l(i)},children:"Previous page"})," ",ie.jsx(Cp,{variant:"outline-primary",size:"sm",disabled:!n||d,onClick:()=>{n&&l(n)},children:"Next page"})]})}function WI({tripQueryResult:i,selectedTripPatternIndex:n,setSelectedTripPatternIndex:l,pageResults:d,loading:m}){const[_,v]=kI(i),{containerRef:c,containerWidth:C}=eI(),R=ce.useContext(__);return ie.jsxs("section",{className:"left-pane-container below-content",ref:c,children:[ie.jsxs(ie.Fragment,{children:[ie.jsx("div",{className:"panel-header",children:"Itinerary results"}),ie.jsx("div",{className:"pagination-controls",children:ie.jsx(XI,{onPagination:d,previousPageCursor:i?.trip.previousPageCursor,nextPageCursor:i?.trip.nextPageCursor,loading:m})}),ie.jsx(I0,{activeKey:`${n}`,onSelect:N=>l(parseInt(N)),children:i&&i.trip.tripPatterns.map((N,B)=>ie.jsxs(I0.Item,{eventKey:`${B}`,bsPrefix:N.systemNotices.length===0?"":"accordion-item-filtered",children:[ie.jsx(I0.Header,{children:ie.jsx(DI,{containerWidth:C,tripPattern:N,itineraryIndex:B,earliestStartTime:_,latestEndTime:v})}),ie.jsx(I0.Body,{children:ie.jsx(HI,{tripPattern:N})})]},`${B}`))})]}),ie.jsxs("div",{className:"time-zone-info",children:["All times in ",ie.jsx("code",{children:R})]})]})}const Ob=yg(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        generalizedCost
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            generalizedCost
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            toEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),QI=sl(Ob),KI=i=>{const[n,l]=ce.useState(null),[d,m]=ce.useState(!1),_=ce.useCallback(async v=>{if(d)console.warn("Wait for previous search to finish");else if(i){m(!0);try{l(v?await V0(Wy(),Ob,{...i,pageCursor:v}):await V0(Wy(),Ob,i))}catch(c){console.error("Error at useTripQuery",c)}m(!1)}else console.warn("Can't search without variables")},[l,i,d]);return ce.useEffect(()=>{dw(i?.from)&&dw(i?.to)&&_()},[i?.from,i?.to]),[n,d,_]};function dw(i){return i&&(i.coordinates||i.place)}const JI=yg(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),eR=()=>{const[i,n]=ce.useState(null);return ce.useEffect(()=>{(async()=>{n(await V0(Wy(),JI))})()},[]),i?.serverInfo},tR={from:{},to:{},dateTime:new Date().toISOString()},nR=()=>{const n=new URLSearchParams(window.location.search).get("variables");return n?JSON.parse(decodeURIComponent(n)):tR},iR=i=>{const n=new URLSearchParams(window.location.search);n.set("variables",encodeURIComponent(JSON.stringify(i))),history.pushState({},"","?"+n.toString()+window.location.hash)},rR=()=>{const[i,n]=ce.useState(nR());return ce.useEffect(()=>{iR(i)},[i]),{tripQueryVariables:i,setTripQueryVariables:n}};function aR({target:i,serverInfo:n}){return ie.jsx(qT,{target:i.current,show:!!n,placement:"right",children:ie.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:ie.jsx("pre",{children:JSON.stringify(n,null,2)})})})}const sR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function oR({serverInfo:i}){const[n,l]=ce.useState(!1),d=ce.useRef(null);return ie.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[ie.jsx(Fk.Brand,{onClick:()=>l(m=>!m),children:ie.jsxs("div",{ref:d,children:[ie.jsx("img",{alt:"",src:sR,width:"50",height:"50",className:"logo-image"}),"OTP Debug",n&&ie.jsx(aR,{serverInfo:i,target:d})]})}),ie.jsxs("div",{className:"details",children:[ie.jsxs("div",{children:["Version: ",i?.version]}),ie.jsxs("div",{children:["Time zone: ",i?.internalTransitModelTimeZone]})]})]})}const fw=7,pw="-{0,1}\\d+(\\.\\d+){0,1}",lR="("+pw+")(\\s+)("+pw+")";function cR(i){const n=i.match(lR);return n?{coordinates:{latitude:+n[1],longitude:+n[4]}}:{place:i}}function uR(i){return i.coordinates?`${i.coordinates?.latitude.toPrecision(fw)} ${i.coordinates?.longitude.toPrecision(fw)}`:i.place?i.place:null}function mw({id:i,label:n,tripQueryVariables:l,setTripQueryVariables:d,locationFieldKey:m}){const[_,v]=ce.useState("");ce.useEffect(()=>{const C=l[m];v(uR(C)||"")},[l,m]);const c=ce.useCallback(C=>{const R=cR(C)||{};d({...l,[m]:R})},[l,d,m]);return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:i,children:n}),ie.jsx(Si.Control,{type:"text",id:i,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:C=>{v(C.target.value)},onBlur:C=>{c(C.target.value)},value:_})]})}const hR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function dR({tripQueryVariables:i,setTripQueryVariables:n}){const l=()=>{n({...i,from:i.to,to:i.from})};return ie.jsx("button",{className:"swap-from-to",onClick:l,title:"Swap from/to",children:ie.jsx("img",{alt:"Swap from/to",src:hR})})}function fR({tripQueryVariables:i,setTripQueryVariables:n}){const l=d=>{n({...i,arriveBy:d})};return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Departure/Arrival"}),ie.jsxs(Si.Select,{size:"sm",className:"input-medium",onChange:d=>d.target.value==="arrival"?l(!0):l(!1),value:i.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[ie.jsx("option",{value:"arrival",children:"Arrive before"}),ie.jsx("option",{value:"departure",children:"Depart after"})]})]})}class W extends Array{constructor(n,l){if(super(n),this.sign=l,Object.setPrototypeOf(this,W.prototype),n>W.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(n){var l=Math.floor,d=Number.isFinite;if(typeof n=="number"){if(n===0)return W.__zero();if(W.__isOneDigitInt(n))return 0>n?W.__oneDigit(-n,!0):W.__oneDigit(n,!1);if(!d(n)||l(n)!==n)throw new RangeError("The number "+n+" cannot be converted to BigInt because it is not an integer");return W.__fromDouble(n)}if(typeof n=="string"){const m=W.__fromString(n);if(m===null)throw new SyntaxError("Cannot convert "+n+" to a BigInt");return m}if(typeof n=="boolean")return n===!0?W.__oneDigit(1,!1):W.__zero();if(typeof n=="object"){if(n.constructor===W)return n;const m=W.__toPrimitive(n);return W.BigInt(m)}throw new TypeError("Cannot convert "+n+" to a BigInt")}toDebugString(){const n=["BigInt["];for(const l of this)n.push((l&&(l>>>0).toString(16))+", ");return n.push("]"),n.join("")}toString(n=10){if(2>n||36<n)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(n&n-1)==0?W.__toStringBasePowerOfTwo(this,n):W.__toStringGeneric(this,n,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(n){const l=n.length;if(l===0)return 0;if(l===1){const pe=n.__unsignedDigit(0);return n.sign?-pe:pe}const d=n.__digit(l-1),m=W.__clz30(d),_=30*l-m;if(1024<_)return n.sign?-1/0:1/0;let v=_-1,c=d,C=l-1;const R=m+3;let N=R===32?0:c<<R;N>>>=12;const B=R-12;let V=12<=R?0:c<<20+R,G=20+R;for(0<B&&0<C&&(C--,c=n.__digit(C),N|=c>>>30-B,V=c<<B+2,G=B+2);0<G&&0<C;)C--,c=n.__digit(C),V|=30<=G?c<<G-30:c>>>30-G,G-=30;const ae=W.__decideRounding(n,G,C,c);if((ae===1||ae===0&&(1&V)==1)&&(V=V+1>>>0,V===0&&(N++,N>>>20!=0&&(N=0,v++,1023<v))))return n.sign?-1/0:1/0;const me=n.sign?-2147483648:0;return v=v+1023<<20,W.__kBitConversionInts[1]=me|v|N,W.__kBitConversionInts[0]=V,W.__kBitConversionDouble[0]}static unaryMinus(n){if(n.length===0)return n;const l=n.__copy();return l.sign=!n.sign,l}static bitwiseNot(n){return n.sign?W.__absoluteSubOne(n).__trim():W.__absoluteAddOne(n,!0)}static exponentiate(n,l){if(l.sign)throw new RangeError("Exponent must be positive");if(l.length===0)return W.__oneDigit(1,!1);if(n.length===0)return n;if(n.length===1&&n.__digit(0)===1)return n.sign&&(1&l.__digit(0))==0?W.unaryMinus(n):n;if(1<l.length)throw new RangeError("BigInt too big");let d=l.__unsignedDigit(0);if(d===1)return n;if(d>=W.__kMaxLengthBits)throw new RangeError("BigInt too big");if(n.length===1&&n.__digit(0)===2){const v=1+(0|d/30),c=n.sign&&(1&d)!=0,C=new W(v,c);C.__initializeDigits();const R=1<<d%30;return C.__setDigit(v-1,R),C}let m=null,_=n;for((1&d)!=0&&(m=n),d>>=1;d!==0;d>>=1)_=W.multiply(_,_),(1&d)!=0&&(m===null?m=_:m=W.multiply(m,_));return m}static multiply(n,l){if(n.length===0)return n;if(l.length===0)return l;let d=n.length+l.length;30<=n.__clzmsd()+l.__clzmsd()&&d--;const m=new W(d,n.sign!==l.sign);m.__initializeDigits();for(let _=0;_<n.length;_++)W.__multiplyAccumulate(l,n.__digit(_),m,_);return m.__trim()}static divide(n,l){if(l.length===0)throw new RangeError("Division by zero");if(0>W.__absoluteCompare(n,l))return W.__zero();const d=n.sign!==l.sign,m=l.__unsignedDigit(0);let _;if(l.length===1&&32767>=m){if(m===1)return d===n.sign?n:W.unaryMinus(n);_=W.__absoluteDivSmall(n,m,null)}else _=W.__absoluteDivLarge(n,l,!0,!1);return _.sign=d,_.__trim()}static remainder(n,l){if(l.length===0)throw new RangeError("Division by zero");if(0>W.__absoluteCompare(n,l))return n;const d=l.__unsignedDigit(0);if(l.length===1&&32767>=d){if(d===1)return W.__zero();const _=W.__absoluteModSmall(n,d);return _===0?W.__zero():W.__oneDigit(_,n.sign)}const m=W.__absoluteDivLarge(n,l,!1,!0);return m.sign=n.sign,m.__trim()}static add(n,l){const d=n.sign;return d===l.sign?W.__absoluteAdd(n,l,d):0<=W.__absoluteCompare(n,l)?W.__absoluteSub(n,l,d):W.__absoluteSub(l,n,!d)}static subtract(n,l){const d=n.sign;return d===l.sign?0<=W.__absoluteCompare(n,l)?W.__absoluteSub(n,l,d):W.__absoluteSub(l,n,!d):W.__absoluteAdd(n,l,d)}static leftShift(n,l){return l.length===0||n.length===0?n:l.sign?W.__rightShiftByAbsolute(n,l):W.__leftShiftByAbsolute(n,l)}static signedRightShift(n,l){return l.length===0||n.length===0?n:l.sign?W.__leftShiftByAbsolute(n,l):W.__rightShiftByAbsolute(n,l)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(n,l){return 0>W.__compareToBigInt(n,l)}static lessThanOrEqual(n,l){return 0>=W.__compareToBigInt(n,l)}static greaterThan(n,l){return 0<W.__compareToBigInt(n,l)}static greaterThanOrEqual(n,l){return 0<=W.__compareToBigInt(n,l)}static equal(n,l){if(n.sign!==l.sign||n.length!==l.length)return!1;for(let d=0;d<n.length;d++)if(n.__digit(d)!==l.__digit(d))return!1;return!0}static notEqual(n,l){return!W.equal(n,l)}static bitwiseAnd(n,l){var d=Math.max;if(!n.sign&&!l.sign)return W.__absoluteAnd(n,l).__trim();if(n.sign&&l.sign){const m=d(n.length,l.length)+1;let _=W.__absoluteSubOne(n,m);const v=W.__absoluteSubOne(l);return _=W.__absoluteOr(_,v,_),W.__absoluteAddOne(_,!0,_).__trim()}return n.sign&&([n,l]=[l,n]),W.__absoluteAndNot(n,W.__absoluteSubOne(l)).__trim()}static bitwiseXor(n,l){var d=Math.max;if(!n.sign&&!l.sign)return W.__absoluteXor(n,l).__trim();if(n.sign&&l.sign){const v=d(n.length,l.length),c=W.__absoluteSubOne(n,v),C=W.__absoluteSubOne(l);return W.__absoluteXor(c,C,c).__trim()}const m=d(n.length,l.length)+1;n.sign&&([n,l]=[l,n]);let _=W.__absoluteSubOne(l,m);return _=W.__absoluteXor(_,n,_),W.__absoluteAddOne(_,!0,_).__trim()}static bitwiseOr(n,l){var d=Math.max;const m=d(n.length,l.length);if(!n.sign&&!l.sign)return W.__absoluteOr(n,l).__trim();if(n.sign&&l.sign){let v=W.__absoluteSubOne(n,m);const c=W.__absoluteSubOne(l);return v=W.__absoluteAnd(v,c,v),W.__absoluteAddOne(v,!0,v).__trim()}n.sign&&([n,l]=[l,n]);let _=W.__absoluteSubOne(l,m);return _=W.__absoluteAndNot(_,n,_),W.__absoluteAddOne(_,!0,_).__trim()}static asIntN(n,l){var d=Math.floor;if(l.length===0)return l;if(n=d(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return W.__zero();if(n>=W.__kMaxLengthBits)return l;const m=0|(n+29)/30;if(l.length<m)return l;const _=l.__unsignedDigit(m-1),v=1<<(n-1)%30;if(l.length===m&&_<v)return l;if((_&v)!==v)return W.__truncateToNBits(n,l);if(!l.sign)return W.__truncateAndSubFromPowerOfTwo(n,l,!0);if((_&v-1)==0){for(let c=m-2;0<=c;c--)if(l.__digit(c)!==0)return W.__truncateAndSubFromPowerOfTwo(n,l,!1);return l.length===m&&_===v?l:W.__truncateToNBits(n,l)}return W.__truncateAndSubFromPowerOfTwo(n,l,!1)}static asUintN(n,l){var d=Math.floor;if(l.length===0)return l;if(n=d(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return W.__zero();if(l.sign){if(n>W.__kMaxLengthBits)throw new RangeError("BigInt too big");return W.__truncateAndSubFromPowerOfTwo(n,l,!1)}if(n>=W.__kMaxLengthBits)return l;const m=0|(n+29)/30;if(l.length<m)return l;const _=n%30;return l.length==m&&(_===0||!(l.__digit(m-1)>>>_))?l:W.__truncateToNBits(n,l)}static ADD(n,l){if(n=W.__toPrimitive(n),l=W.__toPrimitive(l),typeof n=="string")return typeof l!="string"&&(l=l.toString()),n+l;if(typeof l=="string")return n.toString()+l;if(n=W.__toNumeric(n),l=W.__toNumeric(l),W.__isBigInt(n)&&W.__isBigInt(l))return W.add(n,l);if(typeof n=="number"&&typeof l=="number")return n+l;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(n,l){return W.__compare(n,l,0)}static LE(n,l){return W.__compare(n,l,1)}static GT(n,l){return W.__compare(n,l,2)}static GE(n,l){return W.__compare(n,l,3)}static EQ(n,l){for(;;){if(W.__isBigInt(n))return W.__isBigInt(l)?W.equal(n,l):W.EQ(l,n);if(typeof n=="number"){if(W.__isBigInt(l))return W.__equalToNumber(l,n);if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="string"){if(W.__isBigInt(l))return n=W.__fromString(n),n!==null&&W.equal(n,l);if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="boolean"){if(W.__isBigInt(l))return W.__equalToNumber(l,+n);if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="symbol"){if(W.__isBigInt(l))return!1;if(typeof l!="object")return n==l;l=W.__toPrimitive(l)}else if(typeof n=="object"){if(typeof l=="object"&&l.constructor!==W)return n==l;n=W.__toPrimitive(n)}else return n==l}}static NE(n,l){return!W.EQ(n,l)}static DataViewGetBigInt64(n,l,d=!1){return W.asIntN(64,W.DataViewGetBigUint64(n,l,d))}static DataViewGetBigUint64(n,l,d=!1){const[m,_]=d?[4,0]:[0,4],v=n.getUint32(l+m,d),c=n.getUint32(l+_,d),C=new W(3,!1);return C.__setDigit(0,1073741823&c),C.__setDigit(1,(268435455&v)<<2|c>>>30),C.__setDigit(2,v>>>28),C.__trim()}static DataViewSetBigInt64(n,l,d,m=!1){W.DataViewSetBigUint64(n,l,d,m)}static DataViewSetBigUint64(n,l,d,m=!1){d=W.asUintN(64,d);let _=0,v=0;if(0<d.length&&(v=d.__digit(0),1<d.length)){const R=d.__digit(1);v|=R<<30,_=R>>>2,2<d.length&&(_|=d.__digit(2)<<28)}const[c,C]=m?[4,0]:[0,4];n.setUint32(l+c,_,m),n.setUint32(l+C,v,m)}static __zero(){return new W(0,!1)}static __oneDigit(n,l){const d=new W(1,l);return d.__setDigit(0,n),d}__copy(){const n=new W(this.length,this.sign);for(let l=0;l<this.length;l++)n[l]=this[l];return n}__trim(){let n=this.length,l=this[n-1];for(;l===0;)n--,l=this[n-1],this.pop();return n===0&&(this.sign=!1),this}__initializeDigits(){for(let n=0;n<this.length;n++)this[n]=0}static __decideRounding(n,l,d,m){if(0<l)return-1;let _;if(0>l)_=-l-1;else{if(d===0)return-1;d--,m=n.__digit(d),_=29}let v=1<<_;if((m&v)==0)return-1;if(v-=1,(m&v)!=0)return 1;for(;0<d;)if(d--,n.__digit(d)!==0)return 1;return 0}static __fromDouble(n){W.__kBitConversionDouble[0]=n;const l=2047&W.__kBitConversionInts[1]>>>20,d=l-1023,m=(0|d/30)+1,_=new W(m,0>n);let v=1048575&W.__kBitConversionInts[1]|1048576,c=W.__kBitConversionInts[0];const C=20,R=d%30;let N,B=0;if(R<20){const V=C-R;B=V+32,N=v>>>V,v=v<<32-V|c>>>V,c<<=32-V}else if(R===20)B=32,N=v,v=c,c=0;else{const V=R-C;B=32-V,N=v<<V|c>>>32-V,v=c<<V,c=0}_.__setDigit(m-1,N);for(let V=m-2;0<=V;V--)0<B?(B-=30,N=v>>>2,v=v<<30|c>>>2,c<<=30):N=0,_.__setDigit(V,N);return _.__trim()}static __isWhitespace(n){return 13>=n&&9<=n||(159>=n?n==32:131071>=n?n==160||n==5760:196607>=n?(n&=131071,10>=n||n==40||n==41||n==47||n==95||n==4096):n==65279)}static __fromString(n,l=0){let d=0;const m=n.length;let _=0;if(_===m)return W.__zero();let v=n.charCodeAt(_);for(;W.__isWhitespace(v);){if(++_===m)return W.__zero();v=n.charCodeAt(_)}if(v===43){if(++_===m)return null;v=n.charCodeAt(_),d=1}else if(v===45){if(++_===m)return null;v=n.charCodeAt(_),d=-1}if(l===0){if(l=10,v===48){if(++_===m)return W.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(l=16,++_===m)return null;v=n.charCodeAt(_)}else if(v===79||v===111){if(l=8,++_===m)return null;v=n.charCodeAt(_)}else if(v===66||v===98){if(l=2,++_===m)return null;v=n.charCodeAt(_)}}}else if(l===16&&v===48){if(++_===m)return W.__zero();if(v=n.charCodeAt(_),v===88||v===120){if(++_===m)return null;v=n.charCodeAt(_)}}if(d!=0&&l!==10)return null;for(;v===48;){if(++_===m)return W.__zero();v=n.charCodeAt(_)}const c=m-_;let C=W.__kMaxBitsPerChar[l],R=W.__kBitsPerCharTableMultiplier-1;if(c>1073741824/C)return null;const N=C*c+R>>>W.__kBitsPerCharTableShift,B=new W(0|(N+29)/30,!1),V=10>l?l:10,G=10<l?l-10:0;if((l&l-1)==0){C>>=W.__kBitsPerCharTableShift;const ae=[],me=[];let pe=!1;do{let Ne=0,Ve=0;for(;;){let Fe;if(v-48>>>0<V)Fe=v-48;else if((32|v)-97>>>0<G)Fe=(32|v)-87;else{pe=!0;break}if(Ve+=C,Ne=Ne<<C|Fe,++_===m){pe=!0;break}if(v=n.charCodeAt(_),30<Ve+C)break}ae.push(Ne),me.push(Ve)}while(!pe);W.__fillFromParts(B,ae,me)}else{B.__initializeDigits();let ae=!1,me=0;do{let pe=0,Ne=1;for(;;){let Fe;if(v-48>>>0<V)Fe=v-48;else if((32|v)-97>>>0<G)Fe=(32|v)-87;else{ae=!0;break}const qe=Ne*l;if(1073741823<qe)break;if(Ne=qe,pe=pe*l+Fe,me++,++_===m){ae=!0;break}v=n.charCodeAt(_)}R=30*W.__kBitsPerCharTableMultiplier-1;const Ve=0|(C*me+R>>>W.__kBitsPerCharTableShift)/30;B.__inplaceMultiplyAdd(Ne,pe,Ve)}while(!ae)}if(_!==m){if(!W.__isWhitespace(v))return null;for(_++;_<m;_++)if(v=n.charCodeAt(_),!W.__isWhitespace(v))return null}return B.sign=d==-1,B.__trim()}static __fillFromParts(n,l,d){let m=0,_=0,v=0;for(let c=l.length-1;0<=c;c--){const C=l[c],R=d[c];_|=C<<v,v+=R,v===30?(n.__setDigit(m++,_),v=0,_=0):30<v&&(n.__setDigit(m++,1073741823&_),v-=30,_=C>>>R-v)}if(_!==0){if(m>=n.length)throw new Error("implementation bug");n.__setDigit(m++,_)}for(;m<n.length;m++)n.__setDigit(m,0)}static __toStringBasePowerOfTwo(n,l){const d=n.length;let m=l-1;m=(85&m>>>1)+(85&m),m=(51&m>>>2)+(51&m),m=(15&m>>>4)+(15&m);const _=m,v=l-1,c=n.__digit(d-1),C=W.__clz30(c);let R=0|(30*d-C+_-1)/_;if(n.sign&&R++,268435456<R)throw new Error("string too long");const N=Array(R);let B=R-1,V=0,G=0;for(let me=0;me<d-1;me++){const pe=n.__digit(me),Ne=(V|pe<<G)&v;N[B--]=W.__kConversionChars[Ne];const Ve=_-G;for(V=pe>>>Ve,G=30-Ve;G>=_;)N[B--]=W.__kConversionChars[V&v],V>>>=_,G-=_}const ae=(V|c<<G)&v;for(N[B--]=W.__kConversionChars[ae],V=c>>>_-G;V!==0;)N[B--]=W.__kConversionChars[V&v],V>>>=_;if(n.sign&&(N[B--]="-"),B!=-1)throw new Error("implementation bug");return N.join("")}static __toStringGeneric(n,l,d){const m=n.length;if(m===0)return"";if(m===1){let me=n.__unsignedDigit(0).toString(l);return d===!1&&n.sign&&(me="-"+me),me}const _=30*m-W.__clz30(n.__digit(m-1)),v=W.__kMaxBitsPerChar[l],c=v-1;let C=_*W.__kBitsPerCharTableMultiplier;C+=c-1,C=0|C/c;const R=C+1>>1,N=W.exponentiate(W.__oneDigit(l,!1),W.__oneDigit(R,!1));let B,V;const G=N.__unsignedDigit(0);if(N.length===1&&32767>=G){B=new W(n.length,!1),B.__initializeDigits();let me=0;for(let pe=2*n.length-1;0<=pe;pe--){const Ne=me<<15|n.__halfDigit(pe);B.__setHalfDigit(pe,0|Ne/G),me=0|Ne%G}V=me.toString(l)}else{const me=W.__absoluteDivLarge(n,N,!0,!0);B=me.quotient;const pe=me.remainder.__trim();V=W.__toStringGeneric(pe,l,!0)}B.__trim();let ae=W.__toStringGeneric(B,l,!0);for(;V.length<R;)V="0"+V;return d===!1&&n.sign&&(ae="-"+ae),ae+V}static __unequalSign(n){return n?-1:1}static __absoluteGreater(n){return n?-1:1}static __absoluteLess(n){return n?1:-1}static __compareToBigInt(n,l){const d=n.sign;if(d!==l.sign)return W.__unequalSign(d);const m=W.__absoluteCompare(n,l);return 0<m?W.__absoluteGreater(d):0>m?W.__absoluteLess(d):0}static __compareToNumber(n,l){if(W.__isOneDigitInt(l)){const d=n.sign,m=0>l;if(d!==m)return W.__unequalSign(d);if(n.length===0){if(m)throw new Error("implementation bug");return l===0?0:-1}if(1<n.length)return W.__absoluteGreater(d);const _=Math.abs(l),v=n.__unsignedDigit(0);return v>_?W.__absoluteGreater(d):v<_?W.__absoluteLess(d):0}return W.__compareToDouble(n,l)}static __compareToDouble(n,l){if(l!==l)return l;if(l===1/0)return-1;if(l===-1/0)return 1;const d=n.sign;if(d!==0>l)return W.__unequalSign(d);if(l===0)throw new Error("implementation bug: should be handled elsewhere");if(n.length===0)return-1;W.__kBitConversionDouble[0]=l;const m=2047&W.__kBitConversionInts[1]>>>20;if(m==2047)throw new Error("implementation bug: handled elsewhere");const _=m-1023;if(0>_)return W.__absoluteGreater(d);const v=n.length;let c=n.__digit(v-1);const C=W.__clz30(c),R=30*v-C,N=_+1;if(R<N)return W.__absoluteLess(d);if(R>N)return W.__absoluteGreater(d);let B=1048576|1048575&W.__kBitConversionInts[1],V=W.__kBitConversionInts[0];const G=20,ae=29-C;if(ae!==(0|(R-1)%30))throw new Error("implementation bug");let me,pe=0;if(20>ae){const Ne=G-ae;pe=Ne+32,me=B>>>Ne,B=B<<32-Ne|V>>>Ne,V<<=32-Ne}else if(ae===20)pe=32,me=B,B=V,V=0;else{const Ne=ae-G;pe=32-Ne,me=B<<Ne|V>>>32-Ne,B=V<<Ne,V=0}if(c>>>=0,me>>>=0,c>me)return W.__absoluteGreater(d);if(c<me)return W.__absoluteLess(d);for(let Ne=v-2;0<=Ne;Ne--){0<pe?(pe-=30,me=B>>>2,B=B<<30|V>>>2,V<<=30):me=0;const Ve=n.__unsignedDigit(Ne);if(Ve>me)return W.__absoluteGreater(d);if(Ve<me)return W.__absoluteLess(d)}if(B!==0||V!==0){if(pe===0)throw new Error("implementation bug");return W.__absoluteLess(d)}return 0}static __equalToNumber(n,l){var d=Math.abs;return W.__isOneDigitInt(l)?l===0?n.length===0:n.length===1&&n.sign===0>l&&n.__unsignedDigit(0)===d(l):W.__compareToDouble(n,l)===0}static __comparisonResultToBool(n,l){return l===0?0>n:l===1?0>=n:l===2?0<n:l===3?0<=n:void 0}static __compare(n,l,d){if(n=W.__toPrimitive(n),l=W.__toPrimitive(l),typeof n=="string"&&typeof l=="string")switch(d){case 0:return n<l;case 1:return n<=l;case 2:return n>l;case 3:return n>=l}if(W.__isBigInt(n)&&typeof l=="string")return l=W.__fromString(l),l!==null&&W.__comparisonResultToBool(W.__compareToBigInt(n,l),d);if(typeof n=="string"&&W.__isBigInt(l))return n=W.__fromString(n),n!==null&&W.__comparisonResultToBool(W.__compareToBigInt(n,l),d);if(n=W.__toNumeric(n),l=W.__toNumeric(l),W.__isBigInt(n)){if(W.__isBigInt(l))return W.__comparisonResultToBool(W.__compareToBigInt(n,l),d);if(typeof l!="number")throw new Error("implementation bug");return W.__comparisonResultToBool(W.__compareToNumber(n,l),d)}if(typeof n!="number")throw new Error("implementation bug");if(W.__isBigInt(l))return W.__comparisonResultToBool(W.__compareToNumber(l,n),2^d);if(typeof l!="number")throw new Error("implementation bug");return d===0?n<l:d===1?n<=l:d===2?n>l:d===3?n>=l:void 0}__clzmsd(){return W.__clz30(this.__digit(this.length-1))}static __absoluteAdd(n,l,d){if(n.length<l.length)return W.__absoluteAdd(l,n,d);if(n.length===0)return n;if(l.length===0)return n.sign===d?n:W.unaryMinus(n);let m=n.length;(n.__clzmsd()===0||l.length===n.length&&l.__clzmsd()===0)&&m++;const _=new W(m,d);let v=0,c=0;for(;c<l.length;c++){const C=n.__digit(c)+l.__digit(c)+v;v=C>>>30,_.__setDigit(c,1073741823&C)}for(;c<n.length;c++){const C=n.__digit(c)+v;v=C>>>30,_.__setDigit(c,1073741823&C)}return c<_.length&&_.__setDigit(c,v),_.__trim()}static __absoluteSub(n,l,d){if(n.length===0)return n;if(l.length===0)return n.sign===d?n:W.unaryMinus(n);const m=new W(n.length,d);let _=0,v=0;for(;v<l.length;v++){const c=n.__digit(v)-l.__digit(v)-_;_=1&c>>>30,m.__setDigit(v,1073741823&c)}for(;v<n.length;v++){const c=n.__digit(v)-_;_=1&c>>>30,m.__setDigit(v,1073741823&c)}return m.__trim()}static __absoluteAddOne(n,l,d=null){const m=n.length;d===null?d=new W(m,l):d.sign=l;let _=1;for(let v=0;v<m;v++){const c=n.__digit(v)+_;_=c>>>30,d.__setDigit(v,1073741823&c)}return _!=0&&d.__setDigitGrow(m,1),d}static __absoluteSubOne(n,l){const d=n.length;l=l||d;const m=new W(l,!1);let _=1;for(let v=0;v<d;v++){const c=n.__digit(v)-_;_=1&c>>>30,m.__setDigit(v,1073741823&c)}if(_!=0)throw new Error("implementation bug");for(let v=d;v<l;v++)m.__setDigit(v,0);return m}static __absoluteAnd(n,l,d=null){let m=n.length,_=l.length,v=_;if(m<_){v=m;const R=n,N=m;n=l,m=_,l=R,_=N}let c=v;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)&l.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteAndNot(n,l,d=null){const m=n.length,_=l.length;let v=_;m<_&&(v=m);let c=m;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)&~l.__digit(C));for(;C<m;C++)d.__setDigit(C,n.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteOr(n,l,d=null){let m=n.length,_=l.length,v=_;if(m<_){v=m;const R=n,N=m;n=l,m=_,l=R,_=N}let c=m;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)|l.__digit(C));for(;C<m;C++)d.__setDigit(C,n.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteXor(n,l,d=null){let m=n.length,_=l.length,v=_;if(m<_){v=m;const R=n,N=m;n=l,m=_,l=R,_=N}let c=m;d===null?d=new W(c,!1):c=d.length;let C=0;for(;C<v;C++)d.__setDigit(C,n.__digit(C)^l.__digit(C));for(;C<m;C++)d.__setDigit(C,n.__digit(C));for(;C<c;C++)d.__setDigit(C,0);return d}static __absoluteCompare(n,l){const d=n.length-l.length;if(d!=0)return d;let m=n.length-1;for(;0<=m&&n.__digit(m)===l.__digit(m);)m--;return 0>m?0:n.__unsignedDigit(m)>l.__unsignedDigit(m)?1:-1}static __multiplyAccumulate(n,l,d,m){if(l===0)return;const _=32767&l,v=l>>>15;let c=0,C=0;for(let R,N=0;N<n.length;N++,m++){R=d.__digit(m);const B=n.__digit(N),V=32767&B,G=B>>>15,ae=W.__imul(V,_),me=W.__imul(V,v),pe=W.__imul(G,_),Ne=W.__imul(G,v);R+=C+ae+c,c=R>>>30,R&=1073741823,R+=((32767&me)<<15)+((32767&pe)<<15),c+=R>>>30,C=Ne+(me>>>15)+(pe>>>15),d.__setDigit(m,1073741823&R)}for(;c!=0||C!==0;m++){let R=d.__digit(m);R+=c+C,C=0,c=R>>>30,d.__setDigit(m,1073741823&R)}}static __internalMultiplyAdd(n,l,d,m,_){let v=d,c=0;for(let C=0;C<m;C++){const R=n.__digit(C),N=W.__imul(32767&R,l),B=W.__imul(R>>>15,l),V=N+((32767&B)<<15)+c+v;v=V>>>30,c=B>>>15,_.__setDigit(C,1073741823&V)}if(_.length>m)for(_.__setDigit(m++,v+c);m<_.length;)_.__setDigit(m++,0);else if(v+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(n,l,d){d>this.length&&(d=this.length);const m=32767&n,_=n>>>15;let v=0,c=l;for(let C=0;C<d;C++){const R=this.__digit(C),N=32767&R,B=R>>>15,V=W.__imul(N,m),G=W.__imul(N,_),ae=W.__imul(B,m),me=W.__imul(B,_);let pe=c+V+v;v=pe>>>30,pe&=1073741823,pe+=((32767&G)<<15)+((32767&ae)<<15),v+=pe>>>30,c=me+(G>>>15)+(ae>>>15),this.__setDigit(C,1073741823&pe)}if(v!=0||c!==0)throw new Error("implementation bug")}static __absoluteDivSmall(n,l,d=null){d===null&&(d=new W(n.length,!1));let m=0;for(let _,v=2*n.length-1;0<=v;v-=2){_=(m<<15|n.__halfDigit(v))>>>0;const c=0|_/l;m=0|_%l,_=(m<<15|n.__halfDigit(v-1))>>>0;const C=0|_/l;m=0|_%l,d.__setDigit(v>>>1,c<<15|C)}return d}static __absoluteModSmall(n,l){let d=0;for(let m=2*n.length-1;0<=m;m--)d=0|((d<<15|n.__halfDigit(m))>>>0)%l;return d}static __absoluteDivLarge(n,l,d,m){const _=l.__halfDigitLength(),v=l.length,c=n.__halfDigitLength()-_;let C=null;d&&(C=new W(c+2>>>1,!1),C.__initializeDigits());const R=new W(_+2>>>1,!1);R.__initializeDigits();const N=W.__clz15(l.__halfDigit(_-1));0<N&&(l=W.__specialLeftShift(l,N,0));const B=W.__specialLeftShift(n,N,1),V=l.__halfDigit(_-1);let G=0;for(let ae,me=c;0<=me;me--){ae=32767;const pe=B.__halfDigit(me+_);if(pe!==V){const Ve=(pe<<15|B.__halfDigit(me+_-1))>>>0;ae=0|Ve/V;let Fe=0|Ve%V;const qe=l.__halfDigit(_-2),Ae=B.__halfDigit(me+_-2);for(;W.__imul(ae,qe)>>>0>(Fe<<16|Ae)>>>0&&(ae--,Fe+=V,!(32767<Fe)););}W.__internalMultiplyAdd(l,ae,0,v,R);let Ne=B.__inplaceSub(R,me,_+1);Ne!==0&&(Ne=B.__inplaceAdd(l,me,_),B.__setHalfDigit(me+_,32767&B.__halfDigit(me+_)+Ne),ae--),d&&(1&me?G=ae<<15:C.__setDigit(me>>>1,G|ae))}if(m)return B.__inplaceRightShift(N),d?{quotient:C,remainder:B}:B;if(d)return C;throw new Error("unreachable")}static __clz15(n){return W.__clz30(n)-15}__inplaceAdd(n,l,d){let m=0;for(let _=0;_<d;_++){const v=this.__halfDigit(l+_)+n.__halfDigit(_)+m;m=v>>>15,this.__setHalfDigit(l+_,32767&v)}return m}__inplaceSub(n,l,d){let m=0;if(1&l){l>>=1;let _=this.__digit(l),v=32767&_,c=0;for(;c<d-1>>>1;c++){const N=n.__digit(c),B=(_>>>15)-(32767&N)-m;m=1&B>>>15,this.__setDigit(l+c,(32767&B)<<15|32767&v),_=this.__digit(l+c+1),v=(32767&_)-(N>>>15)-m,m=1&v>>>15}const C=n.__digit(c),R=(_>>>15)-(32767&C)-m;if(m=1&R>>>15,this.__setDigit(l+c,(32767&R)<<15|32767&v),l+c+1>=this.length)throw new RangeError("out of bounds");(1&d)==0&&(_=this.__digit(l+c+1),v=(32767&_)-(C>>>15)-m,m=1&v>>>15,this.__setDigit(l+n.length,1073709056&_|32767&v))}else{l>>=1;let _=0;for(;_<n.length-1;_++){const N=this.__digit(l+_),B=n.__digit(_),V=(32767&N)-(32767&B)-m;m=1&V>>>15;const G=(N>>>15)-(B>>>15)-m;m=1&G>>>15,this.__setDigit(l+_,(32767&G)<<15|32767&V)}const v=this.__digit(l+_),c=n.__digit(_),C=(32767&v)-(32767&c)-m;m=1&C>>>15;let R=0;(1&d)==0&&(R=(v>>>15)-(c>>>15)-m,m=1&R>>>15),this.__setDigit(l+_,(32767&R)<<15|32767&C)}return m}__inplaceRightShift(n){if(n===0)return;let l=this.__digit(0)>>>n;const d=this.length-1;for(let m=0;m<d;m++){const _=this.__digit(m+1);this.__setDigit(m,1073741823&_<<30-n|l),l=_>>>n}this.__setDigit(d,l)}static __specialLeftShift(n,l,d){const m=n.length,_=new W(m+d,!1);if(l===0){for(let c=0;c<m;c++)_.__setDigit(c,n.__digit(c));return 0<d&&_.__setDigit(m,0),_}let v=0;for(let c=0;c<m;c++){const C=n.__digit(c);_.__setDigit(c,1073741823&C<<l|v),v=C>>>30-l}return 0<d&&_.__setDigit(m,v),_}static __leftShiftByAbsolute(n,l){const d=W.__toShiftAmount(l);if(0>d)throw new RangeError("BigInt too big");const m=0|d/30,_=d%30,v=n.length,c=_!==0&&n.__digit(v-1)>>>30-_!=0,C=v+m+(c?1:0),R=new W(C,n.sign);if(_===0){let N=0;for(;N<m;N++)R.__setDigit(N,0);for(;N<C;N++)R.__setDigit(N,n.__digit(N-m))}else{let N=0;for(let B=0;B<m;B++)R.__setDigit(B,0);for(let B=0;B<v;B++){const V=n.__digit(B);R.__setDigit(B+m,1073741823&V<<_|N),N=V>>>30-_}if(c)R.__setDigit(v+m,N);else if(N!==0)throw new Error("implementation bug")}return R.__trim()}static __rightShiftByAbsolute(n,l){const d=n.length,m=n.sign,_=W.__toShiftAmount(l);if(0>_)return W.__rightShiftByMaximum(m);const v=0|_/30,c=_%30;let C=d-v;if(0>=C)return W.__rightShiftByMaximum(m);let R=!1;if(m){if((n.__digit(v)&(1<<c)-1)!=0)R=!0;else for(let B=0;B<v;B++)if(n.__digit(B)!==0){R=!0;break}}R&&c===0&&~n.__digit(d-1)==0&&C++;let N=new W(C,m);if(c===0){N.__setDigit(C-1,0);for(let B=v;B<d;B++)N.__setDigit(B-v,n.__digit(B))}else{let B=n.__digit(v)>>>c;const V=d-v-1;for(let G=0;G<V;G++){const ae=n.__digit(G+v+1);N.__setDigit(G,1073741823&ae<<30-c|B),B=ae>>>c}N.__setDigit(V,B)}return R&&(N=W.__absoluteAddOne(N,!0,N)),N.__trim()}static __rightShiftByMaximum(n){return n?W.__oneDigit(1,!0):W.__zero()}static __toShiftAmount(n){if(1<n.length)return-1;const l=n.__unsignedDigit(0);return l>W.__kMaxLengthBits?-1:l}static __toPrimitive(n,l="default"){if(typeof n!="object"||n.constructor===W)return n;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const _=n[Symbol.toPrimitive];if(_){const v=_(l);if(typeof v!="object")return v;throw new TypeError("Cannot convert object to primitive value")}}const d=n.valueOf;if(d){const _=d.call(n);if(typeof _!="object")return _}const m=n.toString;if(m){const _=m.call(n);if(typeof _!="object")return _}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(n){return W.__isBigInt(n)?n:+n}static __isBigInt(n){return typeof n=="object"&&n!==null&&n.constructor===W}static __truncateToNBits(n,l){const d=0|(n+29)/30,m=new W(d,l.sign),_=d-1;for(let c=0;c<_;c++)m.__setDigit(c,l.__digit(c));let v=l.__digit(_);if(n%30!=0){const c=32-n%30;v=v<<c>>>c}return m.__setDigit(_,v),m.__trim()}static __truncateAndSubFromPowerOfTwo(n,l,d){var m=Math.min;const _=0|(n+29)/30,v=new W(_,d);let c=0;const C=_-1;let R=0;for(const G=m(C,l.length);c<G;c++){const ae=0-l.__digit(c)-R;R=1&ae>>>30,v.__setDigit(c,1073741823&ae)}for(;c<C;c++)v.__setDigit(c,0|1073741823&-R);let N=C<l.length?l.__digit(C):0;const B=n%30;let V;if(B==0)V=0-N-R,V&=1073741823;else{const G=32-B;N=N<<G>>>G;const ae=1<<32-G;V=ae-N-R,V&=ae-1}return v.__setDigit(C,V),v.__trim()}__digit(n){return this[n]}__unsignedDigit(n){return this[n]>>>0}__setDigit(n,l){this[n]=0|l}__setDigitGrow(n,l){this[n]=0|l}__halfDigitLength(){const n=this.length;return 32767>=this.__unsignedDigit(n-1)?2*n-1:2*n}__halfDigit(n){return 32767&this[n>>>1]>>>15*(1&n)}__setHalfDigit(n,l){const d=n>>>1,m=this.__digit(d),_=1&n?32767&m|l<<15:1073709056&m|32767&l;this.__setDigit(d,_)}static __digitPow(n,l){let d=1;for(;0<l;)1&l&&(d*=n),l>>>=1,n*=n;return d}static __isOneDigitInt(n){return(1073741823&n)===n}}W.__kMaxLength=33554432,W.__kMaxLengthBits=W.__kMaxLength<<5,W.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],W.__kBitsPerCharTableShift=5,W.__kBitsPerCharTableMultiplier=1<<W.__kBitsPerCharTableShift,W.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],W.__kBitConversionBuffer=new ArrayBuffer(8),W.__kBitConversionDouble=new Float64Array(W.__kBitConversionBuffer),W.__kBitConversionInts=new Int32Array(W.__kBitConversionBuffer),W.__clz30=Math.clz32?function(i){return Math.clz32(i)-2}:function(i){return i===0?30:0|29-(0|Math.log(i>>>0)/Math.LN2)},W.__imul=Math.imul||function(i,n){return 0|i*n};const nl=W.BigInt(0),e_=W.BigInt(1),kx=W.BigInt(2),pR=W.BigInt(10),mR=W.BigInt(24),gR=W.BigInt(60),yR=W.BigInt(1e3),v_=W.BigInt(1e6),Gy=W.BigInt(1e9),QT=W.multiply(W.BigInt(3600),Gy),_R=W.multiply(gR,Gy),pf=W.multiply(QT,mR);function Zh(i){return typeof i=="bigint"?W.BigInt(i.toString(10)):i}function KT(i){return W.equal(W.remainder(i,kx),nl)}function vp(i){return W.lessThan(i,nl)?W.unaryMinus(i):i}function H0(i,n){return W.lessThan(i,n)?-1:W.greaterThan(i,n)?1:0}function Iy(i,n){return{quotient:W.divide(i,n),remainder:W.remainder(i,n)}}var gw,yw;const _n="slot-epochNanoSeconds",vn="slot-iso-date",cr="slot-iso-date-time",Er="slot-time",At="slot-calendar",JT="slot-date-brand",eS="slot-year-month-brand",tS="slot-month-day-brand",fi="slot-time-zone",Zs="slot-years",$s="slot-months",wo="slot-weeks",Ys="slot-days",qs="slot-hours",Hs="slot-minutes",Xs="slot-seconds",Ws="slot-milliseconds",Qs="slot-microseconds",To="slot-nanoseconds",nS="date",iS="ym",rS="md",aS="time",sS="datetime",oS="instant",Fp="original",Ym="timezone-canonical",jb="timezone-original",Ry="calendar-id",lS="locale",Bb="options",cS=new WeakMap,Fb=Symbol.for("@@Temporal__GetSlots");(gw=globalThis)[Fb]||(gw[Fb]=function(i){return cS.get(i)});const _v=globalThis[Fb],Ub=Symbol.for("@@Temporal__CreateSlots");(yw=globalThis)[Ub]||(yw[Ub]=function(i){cS.set(i,Object.create(null))});const dd=globalThis[Ub];function no(i,...n){if(!i||typeof i!="object")return!1;const l=_v(i);return!!l&&n.every(d=>d in l)}function te(i,n){const l=_v(i)?.[n];if(l===void 0)throw new TypeError(`Missing internal slot ${n}`);return l}function In(i,n,l){const d=_v(i);if(d===void 0)throw new TypeError("Missing slots for the given container");if(d[n])throw new TypeError(`${n} already has set`);d[n]=l}const Vb={};function fd(i,n){Object.defineProperty(i.prototype,Symbol.toStringTag,{value:n,writable:!1,enumerable:!1,configurable:!0});const l=Object.getOwnPropertyNames(i);for(let m=0;m<l.length;m++){const _=l[m],v=Object.getOwnPropertyDescriptor(i,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i,_,v))}const d=Object.getOwnPropertyNames(i.prototype);for(let m=0;m<d.length;m++){const _=d[m],v=Object.getOwnPropertyDescriptor(i.prototype,_);v.configurable&&v.enumerable&&(v.enumerable=!1,Object.defineProperty(i.prototype,_,v))}Gb(n,i),Gb(`${n}.prototype`,i.prototype)}function Gb(i,n){const l=`%${i}%`;if(Vb[l]!==void 0)throw new Error(`intrinsic ${i} already exists`);Vb[l]=n}function Wa(i){return Vb[i]}function Hm(i,n){let l=i;if(l===0)return{div:l,mod:l};const d=Math.sign(l);l=Math.abs(l);const m=Math.trunc(1+Math.log10(l));if(n>=m)return{div:0*d,mod:d*l};if(n===0)return{div:d*l,mod:0*d};const _=l.toPrecision(m);return{div:d*Number.parseInt(_.slice(0,m-n),10),mod:d*Number.parseInt(_.slice(m-n),10)}}function db(i,n,l){let d=i,m=l;if(d===0)return m;const _=Math.sign(d)||Math.sign(m);d=Math.abs(d),m=Math.abs(m);const v=d.toPrecision(Math.trunc(1+Math.log10(d)));if(m===0)return _*Number.parseInt(v+"0".repeat(n),10);const c=v+m.toPrecision(Math.trunc(1+Math.log10(m))).padStart(n,"0");return _*Number.parseInt(c,10)}function vv(i,n){const l=n==="negative";switch(i){case"ceil":return l?"zero":"infinity";case"floor":return l?"infinity":"zero";case"expand":return"infinity";case"trunc":return"zero";case"halfCeil":return l?"half-zero":"half-infinity";case"halfFloor":return l?"half-infinity":"half-zero";case"halfExpand":return"half-infinity";case"halfTrunc":return"half-zero";case"halfEven":return"half-even"}}function bv(i,n,l,d,m){return m==="zero"?i:m==="infinity"?n:l<0?i:l>0?n:m==="half-zero"?i:m==="half-infinity"?n:d?i:n}class jn{constructor(n){this.totalNs=Zh(n),this.sec=W.toNumber(W.divide(this.totalNs,Gy)),this.subsec=W.toNumber(W.remainder(this.totalNs,Gy))}static validateNew(n,l){if(W.greaterThan(vp(n),jn.MAX))throw new RangeError(`${l} of duration time units cannot exceed ${jn.MAX} s`);return new jn(n)}static fromEpochNsDiff(n,l){const d=W.subtract(Zh(n),Zh(l));return new jn(d)}static fromComponents(n,l,d,m,_,v){const c=W.add(W.add(W.add(W.add(W.add(W.BigInt(v),W.multiply(W.BigInt(_),yR)),W.multiply(W.BigInt(m),v_)),W.multiply(W.BigInt(d),Gy)),W.multiply(W.BigInt(l),_R)),W.multiply(W.BigInt(n),QT));return jn.validateNew(c,"total")}abs(){return new jn(vp(this.totalNs))}add(n){return jn.validateNew(W.add(this.totalNs,n.totalNs),"sum")}add24HourDays(n){return jn.validateNew(W.add(this.totalNs,W.multiply(W.BigInt(n),pf)),"sum")}addToEpochNs(n){return W.add(Zh(n),this.totalNs)}cmp(n){return H0(this.totalNs,n.totalNs)}divmod(n){const{quotient:l,remainder:d}=Iy(this.totalNs,W.BigInt(n));return{quotient:W.toNumber(l),remainder:new jn(d)}}fdiv(n){const l=Zh(n),d=W.BigInt(l);let{quotient:m,remainder:_}=Iy(this.totalNs,d);const v=[];let c;const C=(W.lessThan(this.totalNs,nl)?-1:1)*Math.sign(W.toNumber(l));for(;!W.equal(_,nl)&&v.length<50;)_=W.multiply(_,pR),{quotient:c,remainder:_}=Iy(_,d),v.push(Math.abs(W.toNumber(c)));return C*+(vp(m).toString()+"."+v.join(""))}isZero(){return W.equal(this.totalNs,nl)}round(n,l){const d=Zh(n);if(W.equal(d,e_))return this;const{quotient:m,remainder:_}=Iy(this.totalNs,d),v=W.lessThan(this.totalNs,nl)?"negative":"positive",c=W.multiply(vp(m),d),C=W.add(c,d),R=H0(vp(W.multiply(_,kx)),d),N=vv(l,v),B=W.equal(vp(this.totalNs),c)?c:bv(c,C,R,KT(m),N),V=v==="positive"?B:W.unaryMinus(B);return jn.validateNew(V,"rounding")}sign(){return this.cmp(new jn(nl))}subtract(n){return jn.validateNew(W.subtract(this.totalNs,n.totalNs),"difference")}}jn.MAX=W.BigInt("9007199254740991999999999"),jn.ZERO=new jn(nl);const _w=/[A-Za-z._][A-Za-z._0-9+-]*/,b_=new RegExp(`(?:${/(?:[+-](?:[01][0-9]|2[0-3])(?::?[0-5][0-9])?)/.source}|(?:${_w.source})(?:\\/(?:${_w.source}))*)`),uS=/(?:[+-]\d{6}|\d{4})/,X0=/(?:0[1-9]|1[0-2])/,Zb=/(?:0[1-9]|[12]\d|3[01])/,vR=new RegExp(`(${uS.source})(?:-(${X0.source})-(${Zb.source})|(${X0.source})(${Zb.source}))`),hS=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,dS=/((?:[+-])(?:[01][0-9]|2[0-3])(?::?(?:[0-5][0-9])(?::?(?:[0-5][0-9])(?:[.,](?:\d{1,9}))?)?)?)/,fS=new RegExp(`([zZ])|${dS.source}?`),sg=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,bR=new RegExp([`^${vR.source}`,`(?:(?:[tT]|\\s+)${hS.source}(?:${fS.source})?)?`,`(?:\\[!?(${b_.source})\\])?`,`((?:${sg.source})*)$`].join("")),xR=new RegExp([`^[tT]?${hS.source}`,`(?:${fS.source})?`,`(?:\\[!?${b_.source}\\])?`,`((?:${sg.source})*)$`].join("")),wR=new RegExp(`^(${uS.source})-?(${X0.source})(?:\\[!?${b_.source}\\])?((?:${sg.source})*)$`),TR=new RegExp(`^(?:--)?(${X0.source})-?(${Zb.source})(?:\\[!?${b_.source}\\])?((?:${sg.source})*)$`),fb=/(\d+)(?:[.,](\d{1,9}))?/,SR=new RegExp(`(?:${fb.source}H)?(?:${fb.source}M)?(?:${fb.source}S)?`),ER=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${SR.source})?$`,"i"),mf=864e5,W0=1e6*mf,AR=6e10,pS=1e8*mf,og=Lu(pS),t_=W.unaryMinus(og),MR=W.add(W.subtract(t_,pf),e_),CR=W.subtract(W.add(og,pf),e_),DR=146097*mf,vw=-271821,bw=275760,Zy=Date.UTC(1847,0,1),kR=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","ethiopic-amete-alem","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"],IR=new Set(["ACT","AET","AGT","ART","AST","BET","BST","CAT","CNT","CST","CTT","EAT","ECT","IET","IST","JST","MIT","NET","NST","PLT","PNT","PRT","PST","SST","VST"]);function Ar(i){return typeof i=="object"&&i!==null||typeof i=="function"}function xv(i){if(typeof i=="bigint")throw new TypeError("Cannot convert BigInt to number");return Number(i)}function wv(i){if(typeof i=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return String(i)}function Sn(i){const n=xv(i);if(n===0)return 0;if(Number.isNaN(n)||n===1/0||n===-1/0)throw new RangeError("invalid number value");const l=Math.trunc(n);return l===0?0:l}function xw(i,n){const l=Sn(i);if(l<=0)throw n!==void 0?new RangeError(`property '${n}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return l}function Lc(i){const n=xv(i);if(Number.isNaN(n))throw new RangeError("not a number");if(n===1/0||n===-1/0)throw new RangeError("infinity is out of range");if(!function(l){if(typeof l!="number"||Number.isNaN(l)||l===1/0||l===-1/0)return!1;const d=Math.abs(l);return Math.floor(d)===d}(n))throw new RangeError(`unsupported fractional value ${i}`);return n===0?0:n}function n_(i,n){return String(i).padStart(n,"0")}function Sa(i){if(typeof i!="string")throw new TypeError(`expected a string, not ${String(i)}`);return i}function $b(i,n){if(Ar(i)){const l=i?.toString();if(typeof l=="string"||typeof l=="number")return l;throw new TypeError("Cannot convert object to primitive value")}return i}const Yb=["era","eraYear","year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],RR={era:wv,eraYear:Sn,year:Sn,month:xw,monthCode:function(i){const n=Sa($b(i));if(n.length<3||n.length>4||n[0]!=="M"||"0123456789".indexOf(n[1])===-1||"0123456789".indexOf(n[2])===-1||n[1]+n[2]==="00"&&n[3]!=="L"||n[3]!=="L"&&n[3]!==void 0)throw new RangeError(`bad month code ${n}; must match M01-M99 or M00L-M99L`);return n},day:xw,hour:Sn,minute:Sn,second:Sn,millisecond:Sn,microsecond:Sn,nanosecond:Sn,offset:function(i){const n=Sa($b(i));return wg(n),n},timeZone:eo},PR={hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},lg=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],ww=Object.fromEntries(lg.map(i=>[i[0],i[1]])),zR=Object.fromEntries(lg.map(([i,n])=>[n,i])),$y=lg.map(([,i])=>i),cg={day:W0,hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},Q0=["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],NR=Intl.DateTimeFormat,Tw=new Map;function mS(i){const n=o_(i);let l=Tw.get(n);return l===void 0&&(l=new NR("en-us",{timeZone:n,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),Tw.set(n,l)),l}function qa(i){return no(i,_n)&&!no(i,fi,At)}function Tr(i){return no(i,Zs,$s,Ys,qs,Hs,Xs,Ws,Qs,To)}function Sr(i){return no(i,JT)}function Ir(i){return no(i,Er)}function ir(i){return no(i,cr)}function Ha(i){return no(i,eS)}function tl(i){return no(i,tS)}function On(i){return no(i,_n,fi,At)}function et(i,n){if(!n(i))throw new TypeError("invalid receiver: method called with the wrong type of this-object")}function vg(i){if(no(i,At)||no(i,fi))throw new TypeError("with() does not support a calendar or timeZone property");if(Ir(i))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(i.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(i.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function x_(i,n){return n==="never"||n==="auto"&&i==="iso8601"?"":`[${n==="critical"?"!":""}u-ca=${i}]`}function Tv(i){let n,l,d=!1;for(sg.lastIndex=0;l=sg.exec(i);){const{1:m,2:_,3:v}=l;if(_==="u-ca"){if(n===void 0)n=v,d=m==="!";else if(m==="!"||d)throw new RangeError(`Invalid annotations in ${i}: more than one u-ca present with critical flag`)}else if(m==="!")throw new RangeError(`Unrecognized annotation: !${_}=${v}`)}return n}function Zu(i){const n=bR.exec(i);if(!n)throw new RangeError(`invalid RFC 9557 string: ${i}`);const l=Tv(n[16]);let d=n[1];if(d==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);const m=+d,_=+(n[2]??n[4]??1),v=+(n[3]??n[5]??1),c=n[6]!==void 0,C=+(n[6]??0),R=+(n[7]??n[10]??0);let N=+(n[8]??n[11]??0);N===60&&(N=59);const B=(n[9]??n[12]??"")+"000000000",V=+B.slice(0,3),G=+B.slice(3,6),ae=+B.slice(6,9);let me,pe=!1;n[13]?(me=void 0,pe=!0):n[14]&&(me=n[14]);const Ne=n[15];return Lx(m,_,v,C,R,N,V,G,ae),{year:m,month:_,day:v,time:c?{hour:C,minute:R,second:N,millisecond:V,microsecond:G,nanosecond:ae}:"start-of-day",tzAnnotation:Ne,offset:me,z:pe,calendar:l}}function gS(i){const n=xR.exec(i);let l,d,m,_,v,c,C;if(n){C=Tv(n[10]),l=+(n[1]??0),d=+(n[2]??n[5]??0),m=+(n[3]??n[6]??0),m===60&&(m=59);const R=(n[4]??n[7]??"")+"000000000";if(_=+R.slice(0,3),v=+R.slice(3,6),c=+R.slice(6,9),n[8])throw new RangeError("Z designator not supported for PlainTime")}else{let R,N;if({time:R,z:N,calendar:C}=Zu(i),R==="start-of-day")throw new RangeError(`time is missing in string: ${i}`);if(N)throw new RangeError("Z designator not supported for PlainTime");({hour:l,minute:d,second:m,millisecond:_,microsecond:v,nanosecond:c}=R)}if(Mv(l,d,m,_,v,c),/[tT ][0-9][0-9]/.test(i))return{hour:l,minute:d,second:m,millisecond:_,microsecond:v,nanosecond:c,calendar:C};try{const{month:R,day:N}=Rx(i);Ip(1972,R,N)}catch{try{const{year:R,month:N}=Ix(i);Ip(R,N,1)}catch{return{hour:l,minute:d,second:m,millisecond:_,microsecond:v,nanosecond:c,calendar:C}}}throw new RangeError(`invalid RFC 9557 time-only string ${i}; may need a T prefix`)}function Ix(i){const n=wR.exec(i);let l,d,m,_;if(n){m=Tv(n[3]);let v=n[1];if(v==="-000000")throw new RangeError(`invalid RFC 9557 string: ${i}`);if(l=+v,d=+n[2],_=1,m!==void 0&&m!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let v;if({year:l,month:d,calendar:m,day:_,z:v}=Zu(i),v)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:l,month:d,calendar:m,referenceISODay:_}}function Rx(i){const n=TR.exec(i);let l,d,m,_;if(n){if(m=Tv(n[3]),l=+n[1],d=+n[2],m!==void 0&&m!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let v;if({month:l,day:d,calendar:m,year:_,z:v}=Zu(i),v)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:l,day:d,calendar:m,referenceISOYear:_}}const yS=new RegExp(`^${b_.source}$`,"i"),_S=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])?)?/.source}$`);function vS(i){const n=OR.test(i)?"Seconds not allowed in offset time zone":"Invalid time zone";throw new RangeError(`${n}: ${i}`)}function hf(i){return yS.test(i)||vS(i),_S.test(i)?{offsetMinutes:wg(i)/6e10}:{tzName:i}}function Yy(i,n,l,d){let m=i,_=n,v=l;switch(d){case"reject":Ip(m,_,v);break;case"constrain":({year:m,month:_,day:v}=LS(m,_,v))}return{year:m,month:_,day:v}}function Sv(i,n,l,d,m,_,v){let c=i,C=n,R=l,N=d,B=m,V=_;switch(v){case"reject":Mv(c,C,R,N,B,V);break;case"constrain":c=Ks(c,0,23),C=Ks(C,0,59),R=Ks(R,0,59),N=Ks(N,0,999),B=Ks(B,0,999),V=Ks(V,0,999)}return{hour:c,minute:C,second:R,millisecond:N,microsecond:B,nanosecond:V}}function bS(i){if(!Ar(i))throw new TypeError("invalid duration-like");const n={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let l=!1;for(let d=0;d<Q0.length;d++){const m=Q0[d],_=i[m];_!==void 0&&(l=!0,n[m]=Lc(_))}if(!l)throw new TypeError("invalid duration-like");return n}function vs({years:i,months:n,weeks:l,days:d},m,_,v){return{years:i,months:v??n,weeks:_??l,days:m??d}}function oi(i,n){return{isoDate:i,time:n}}function ni(i){return rd(i,"overflow",["constrain","reject"],"constrain")}function qy(i){return rd(i,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function Fc(i,n){return rd(i,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],n)}function B0(i,n){return rd(i,"offset",["prefer","use","ignore","reject"],n)}function w_(i){return rd(i,"calendarName",["auto","always","never","critical"],"auto")}function bg(i){let n=i.roundingIncrement;if(n===void 0)return 1;const l=Sn(n);if(l<1||l>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${n}`);return l}function xg(i,n,l){const d=l?n:n-1;if(i>d)throw new RangeError(`roundingIncrement must be at least 1 and less than ${d}, not ${i}`);if(n%i!=0)throw new RangeError(`Rounding increment must divide evenly into ${n}`)}function T_(i){const n=i.fractionalSecondDigits;if(n===void 0)return"auto";if(typeof n!="number"){if(wv(n)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return"auto"}const l=Math.floor(n);if(!Number.isFinite(l)||l<0||l>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return l}function S_(i,n){switch(i){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(n){case"auto":return{precision:n,unit:"nanosecond",increment:1};case 0:return{precision:n,unit:"second",increment:1};case 1:case 2:case 3:return{precision:n,unit:"millisecond",increment:10**(3-n)};case 4:case 5:case 6:return{precision:n,unit:"microsecond",increment:10**(6-n)};case 7:case 8:case 9:return{precision:n,unit:"nanosecond",increment:10**(9-n)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`)}}const cd=Symbol("~required~");function Eo(i,n,l,d,m=[]){let _=[];for(let R=0;R<lg.length;R++){const N=lg[R],B=N[1],V=N[2];l!=="datetime"&&l!==V||_.push(B)}_=_.concat(m);let v=d;v===cd?v=void 0:v!==void 0&&_.push(v);let c=[];c=c.concat(_);for(let R=0;R<_.length;R++){const N=_[R],B=zR[N];B!==void 0&&c.push(B)}let C=rd(i,n,c,v);if(C===void 0&&d===cd)throw new RangeError(`${n} is required`);return C&&C in ww?ww[C]:C}function pb(i){const n=i.relativeTo;if(n===void 0)return{};let l,d,m,_,v,c="option",C=!1;if(Ar(n)){if(On(n))return{zonedRelativeTo:n};if(Sr(n))return{plainRelativeTo:n};if(ir(n))return{plainRelativeTo:Js(te(n,cr).isoDate,te(n,At))};m=D_(n);const R=ll(m,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],[]);({isoDate:l,time:d}=A_(m,R,"constrain")),{offset:v,timeZone:_}=R,v===void 0&&(c="wall")}else{let R,N,B,V,G;if({year:B,month:V,day:G,time:d,calendar:m,tzAnnotation:R,offset:v,z:N}=Zu(Sa(n)),R)_=eo(R),N?c="exact":v||(c="wall"),C=!0;else if(N)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");m||(m="iso8601"),m=io(m),l={year:B,month:V,day:G}}return _===void 0?{plainRelativeTo:Js(l,m)}:{zonedRelativeTo:_s(K0(l,d,c,c==="option"?wg(v):0,_,"compatible","reject",C),_,m)}}function Yh(i){return te(i,Zs)!==0?"year":te(i,$s)!==0?"month":te(i,wo)!==0?"week":te(i,Ys)!==0?"day":te(i,qs)!==0?"hour":te(i,Hs)!==0?"minute":te(i,Xs)!==0?"second":te(i,Ws)!==0?"millisecond":te(i,Qs)!==0?"microsecond":"nanosecond"}function nd(i,n){return $y.indexOf(i)>$y.indexOf(n)?n:i}function ku(i){return i==="year"||i==="month"||i==="week"}function qh(i){return ku(i)||i==="day"?"date":"time"}function bf(i){return Wa("%calendarImpl%")(i)}function E_(i){return Wa("%calendarImpl%")(te(i,At))}function to(i,n,l="date"){const d=Object.create(null),m=bf(i).isoToDate(n,{year:!0,monthCode:!0,day:!0});return d.monthCode=m.monthCode,l!=="month-day"&&l!=="date"||(d.day=m.day),l!=="year-month"&&l!=="date"||(d.year=m.year),d}function ll(i,n,l,d,m){const _=bf(i).extraFields(l),v=l.concat(d,_),c=Object.create(null);let C=!1;v.sort();for(let R=0;R<v.length;R++){const N=v[R],B=n[N];if(B!==void 0)C=!0,c[N]=(0,RR[N])(B);else if(m!=="partial"){if(m.includes(N))throw new TypeError(`required property '${N}' missing or undefined`);c[N]=PR[N]}}if(m==="partial"&&!C)throw new TypeError("no supported properties found");return c}function qb(i,n="complete"){const l=["hour","microsecond","millisecond","minute","nanosecond","second"];let d=!1;const m=Object.create(null);for(let _=0;_<l.length;_++){const v=l[_],c=i[v];c!==void 0?(m[v]=Sn(c),d=!0):n==="complete"&&(m[v]=0)}if(!d)throw new TypeError("invalid time-like");return m}function Py(i,n){if(Ar(i)){if(Sr(i))return ni(Qt(n)),Js(te(i,vn),te(i,At));if(On(i)){const C=Hl(te(i,fi),te(i,_n));return ni(Qt(n)),Js(C.isoDate,te(i,At))}if(ir(i))return ni(Qt(n)),Js(te(i,cr).isoDate,te(i,At));const c=D_(i);return Js(gf(c,ll(c,i,["year","month","monthCode","day"],[],[]),ni(Qt(n))),c)}let{year:l,month:d,day:m,calendar:_,z:v}=Zu(Sa(i));if(v)throw new RangeError("Z designator not supported for PlainDate");return _||(_="iso8601"),_=io(_),ni(Qt(n)),Js({year:l,month:d,day:m},_)}function A_(i,n,l){return oi(gf(i,n,l),Sv(n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond,l))}function zy(i,n){let l,d,m;if(Ar(i)){if(ir(i))return ni(Qt(n)),Vl(te(i,cr),te(i,At));if(On(i)){const c=Hl(te(i,fi),te(i,_n));return ni(Qt(n)),Vl(c,te(i,At))}if(Sr(i))return ni(Qt(n)),Vl(oi(te(i,vn),{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),te(i,At));m=D_(i);const _=ll(m,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],[]),v=ni(Qt(n));({isoDate:l,time:d}=A_(m,_,v))}else{let _,v,c,C;if({year:v,month:c,day:C,time:d,calendar:m,z:_}=Zu(Sa(i)),_)throw new RangeError("Z designator not supported for PlainDateTime");d==="start-of-day"&&(d={deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),Lx(v,c,C,d.hour,d.minute,d.second,d.millisecond,d.microsecond,d.nanosecond),m||(m="iso8601"),m=io(m),ni(Qt(n)),l={year:v,month:c,day:C}}return Vl(oi(l,d),m)}function $l(i){const n=Wa("%Temporal.Duration%");if(Tr(i))return new n(te(i,Zs),te(i,$s),te(i,wo),te(i,Ys),te(i,qs),te(i,Hs),te(i,Xs),te(i,Ws),te(i,Qs),te(i,To));if(!Ar(i))return function(m){const{years:_,months:v,weeks:c,days:C,hours:R,minutes:N,seconds:B,milliseconds:V,microseconds:G,nanoseconds:ae}=function(me){const pe=ER.exec(me);if(!pe)throw new RangeError(`invalid duration: ${me}`);if(pe.every((ht,kt)=>kt<2||ht===void 0))throw new RangeError(`invalid duration: ${me}`);const Ne=pe[1]==="-"?-1:1,Ve=pe[2]===void 0?0:Sn(pe[2])*Ne,Fe=pe[3]===void 0?0:Sn(pe[3])*Ne,qe=pe[4]===void 0?0:Sn(pe[4])*Ne,Ae=pe[5]===void 0?0:Sn(pe[5])*Ne,Ke=pe[6]===void 0?0:Sn(pe[6])*Ne,mt=pe[7],st=pe[8],Pe=pe[9],rt=pe[10],Mt=pe[11];let Rt=0,jt=0,en=0;if(mt!==void 0){if(st??Pe??rt??Mt)throw new RangeError("only the smallest unit can be fractional");en=3600*Sn((mt+"000000000").slice(0,9))*Ne}else if(Rt=st===void 0?0:Sn(st)*Ne,Pe!==void 0){if(rt??Mt)throw new RangeError("only the smallest unit can be fractional");en=60*Sn((Pe+"000000000").slice(0,9))*Ne}else jt=rt===void 0?0:Sn(rt)*Ne,Mt!==void 0&&(en=Sn((Mt+"000000000").slice(0,9))*Ne);const ln=en%1e3,Ge=Math.trunc(en/1e3)%1e3,ct=Math.trunc(en/1e6)%1e3;return jt+=Math.trunc(en/1e9)%60,Rt+=Math.trunc(en/6e10),Cv(Ve,Fe,qe,Ae,Ke,Rt,jt,ct,Ge,ln),{years:Ve,months:Fe,weeks:qe,days:Ae,hours:Ke,minutes:Rt,seconds:jt,milliseconds:ct,microseconds:Ge,nanoseconds:ln}}(m);return new(Wa("%Temporal.Duration%"))(_,v,c,C,R,N,B,V,G,ae)}(Sa(i));const l={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let d=bS(i);for(let m=0;m<Q0.length;m++){const _=Q0[m],v=d[_];v!==void 0&&(l[_]=v)}return new n(l.years,l.months,l.weeks,l.days,l.hours,l.minutes,l.seconds,l.milliseconds,l.microseconds,l.nanoseconds)}function Ny(i){let n;if(Ar(i)){if(qa(i)||On(i))return zu(te(i,_n));n=$b(i)}else n=i;const{year:l,month:d,day:m,time:_,offset:v,z:c}=function(me){const pe=Zu(me);if(!pe.z&&!pe.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return pe}(Sa(n)),{hour:C=0,minute:R=0,second:N=0,millisecond:B=0,microsecond:V=0,nanosecond:G=0}=_==="start-of-day"?{}:_,ae=s_(l,d,m,C,R,N,B,V,G-(c?0:wg(v)));return Jm(ae.isoDate),zu(Xa(ae))}function Sw(i,n){if(Ar(i)){if(tl(i))return ni(Qt(n)),Xm(te(i,vn),te(i,At));let c;return no(i,At)?c=te(i,At):(c=i.calendar,c===void 0&&(c="iso8601"),c=C_(c)),Xm(J0(c,ll(c,i,["year","month","monthCode","day"],[],[]),ni(Qt(n))),c)}let{month:l,day:d,referenceISOYear:m,calendar:_}=Rx(Sa(i));if(_===void 0&&(_="iso8601"),_=io(_),ni(Qt(n)),_==="iso8601")return Xm({year:1972,month:l,day:d},_);let v={year:m,month:l,day:d};return Up(v),v=J0(_,to(_,v,"month-day"),"constrain"),Xm(v,_)}function lf(i,n){let l;if(Ar(i)){if(Ir(i))return ni(Qt(n)),Wh(te(i,Er));if(ir(i))return ni(Qt(n)),Wh(te(i,cr).time);if(On(i)){const R=Hl(te(i,fi),te(i,_n));return ni(Qt(n)),Wh(R.time)}const{hour:d,minute:m,second:_,millisecond:v,microsecond:c,nanosecond:C}=qb(i);l=Sv(d,m,_,v,c,C,ni(Qt(n)))}else l=gS(Sa(i)),ni(Qt(n));return Wh(l)}function xS(i){return i===void 0?{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}:te(lf(i),Er)}function Ly(i,n){if(Ar(i)){if(Ha(i))return ni(Qt(n)),Km(te(i,vn),te(i,At));const c=D_(i);return Km(i_(c,ll(c,i,["year","month","monthCode"],[],[]),ni(Qt(n))),c)}let{year:l,month:d,referenceISODay:m,calendar:_}=Ix(Sa(i));_===void 0&&(_="iso8601"),_=io(_),ni(Qt(n));let v={year:l,month:d,day:m};return Ox(v),v=i_(_,to(_,v,"year-month"),"constrain"),Km(v,_)}function K0(i,n,l,d,m,_,v,c){if(n==="start-of-day")return sf(m,i);const C=oi(i,n);if(l==="wall"||v==="ignore")return bs(m,C,_);if(l==="exact"||v==="use"){const B=s_(i.year,i.month,i.day,n.hour,n.minute,n.second,n.millisecond,n.microsecond,n.nanosecond-d);Jm(B.isoDate);const V=Xa(B);return Uu(V),V}Jm(i);const R=Xa(C),N=r_(m,C);for(let B=0;B<N.length;B++){const V=N[B],G=W.toNumber(W.subtract(R,V)),ae=cf(G,6e10,"halfExpand");if(G===d||c&&ae===d)return V}if(v==="reject"){const B=Hb(d),V=a_(C,"iso8601","auto");throw new RangeError(`Offset ${B} is invalid for ${V} in ${m}`)}return kS(N,m,C,_)}function Oy(i,n){let l,d,m,_,v,c,C,R=!1,N="option";if(Ar(i)){if(On(i)){const me=Qt(n);return qy(me),B0(me,"reject"),ni(me),_s(te(i,_n),te(i,fi),te(i,At))}v=D_(i);const V=ll(v,i,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset","timeZone"],["timeZone"]);({offset:_,timeZone:m}=V),_===void 0&&(N="wall");const G=Qt(n);c=qy(G),C=B0(G,"reject");const ae=ni(G);({isoDate:l,time:d}=A_(v,V,ae))}else{let V,G,ae,me,pe;({year:ae,month:me,day:pe,time:d,tzAnnotation:V,offset:_,z:G,calendar:v}=function(Ve){const Fe=Zu(Ve);if(!Fe.tzAnnotation)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return Fe}(Sa(i))),m=eo(V),G?N="exact":_||(N="wall"),v||(v="iso8601"),v=io(v),R=!0;const Ne=Qt(n);c=qy(Ne),C=B0(Ne,"reject"),ni(Ne),l={year:ae,month:me,day:pe}}let B=0;return N==="option"&&(B=wg(_)),_s(K0(l,d,N,B,m,c,C,R),m,v)}function wS(i,n,l){Up(n),dd(i),In(i,vn,n),In(i,At,l),In(i,JT,!0)}function Js(i,n){const l=Wa("%Temporal.PlainDate%"),d=Object.create(l.prototype);return wS(d,i,n),d}function TS(i,n,l){Rp(n),dd(i),In(i,cr,n),In(i,At,l)}function Vl(i,n){const l=Wa("%Temporal.PlainDateTime%"),d=Object.create(l.prototype);return TS(d,i,n),d}function SS(i,n,l){Up(n),dd(i),In(i,vn,n),In(i,At,l),In(i,tS,!0)}function Xm(i,n){const l=Wa("%Temporal.PlainMonthDay%"),d=Object.create(l.prototype);return SS(d,i,n),d}function ES(i,n){dd(i),In(i,Er,n)}function Wh(i){const n=Wa("%Temporal.PlainTime%"),l=Object.create(n.prototype);return ES(l,i),l}function AS(i,n,l){Ox(n),dd(i),In(i,vn,n),In(i,At,l),In(i,eS,!0)}function Km(i,n){const l=Wa("%Temporal.PlainYearMonth%"),d=Object.create(l.prototype);return AS(d,i,n),d}function MS(i,n){Uu(n),dd(i),In(i,_n,n)}function zu(i){const n=Wa("%Temporal.Instant%"),l=Object.create(n.prototype);return MS(l,i),l}function CS(i,n,l,d){Uu(n),dd(i),In(i,_n,n),In(i,fi,l),In(i,At,d)}function _s(i,n,l="iso8601"){const d=Wa("%Temporal.ZonedDateTime%"),m=Object.create(d.prototype);return CS(m,i,n,l),m}function Ew(i){return Yb.filter(n=>i[n]!==void 0)}function kp(i,n,l){const d=Ew(l),m=bf(i).fieldKeysToIgnore(d),_=Object.create(null),v=Ew(n);for(let c=0;c<Yb.length;c++){let C;const R=Yb[c];v.includes(R)&&!m.includes(R)&&(C=n[R]),d.includes(R)&&(C=l[R]),C!==void 0&&(_[R]=C)}return _}function rl(i,n,l,d){const m=bf(i).dateAdd(n,l,d);return Up(m),m}function M_(i,n,l,d){return bf(i).dateUntil(n,l,d)}function C_(i){if(Ar(i)&&no(i,At))return te(i,At);const n=Sa(i);try{return io(n)}catch{}let l;try{({calendar:l}=Zu(n))}catch{try{({calendar:l}=gS(n))}catch{try{({calendar:l}=Ix(n))}catch{({calendar:l}=Rx(n))}}}return l||(l="iso8601"),io(l)}function D_(i){if(no(i,At))return te(i,At);const{calendar:n}=i;return n===void 0?"iso8601":C_(n)}function Fu(i,n){return io(i)===io(n)}function gf(i,n,l){const d=bf(i);d.resolveFields(n,"date");const m=d.dateToISO(n,l);return Up(m),m}function i_(i,n,l){const d=bf(i);d.resolveFields(n,"year-month"),n.day=1;const m=d.dateToISO(n,l);return Ox(m),m}function J0(i,n,l){const d=bf(i);d.resolveFields(n,"month-day");const m=d.monthDayToISOReferenceDate(n,l);return Up(m),m}function eo(i){if(Ar(i)&&On(i))return te(i,fi);const n=Sa(i);if(n==="UTC")return"UTC";const{tzName:l,offsetMinutes:d}=function(_){const{tzAnnotation:v,offset:c,z:C}=function(R){if(yS.test(R))return{tzAnnotation:R,offset:void 0,z:!1};try{const{tzAnnotation:N,offset:B,z:V}=Zu(R);if(V||N||B)return{tzAnnotation:N,offset:B,z:V}}catch{}vS(R)}(_);return v?hf(v):C?hf("UTC"):c?hf(c):void 0}(n);if(d!==void 0)return Px(d);const m=ev(l);if(!m)throw new RangeError(`Unrecognized time zone ${l}`);return m.identifier}function DS(i,n){if(i===n)return!0;const l=hf(i).offsetMinutes,d=hf(n).offsetMinutes;if(l===void 0&&d===void 0){const m=ev(n);if(!m)return!1;const _=ev(i);return!!_&&_.primaryIdentifier===m.primaryIdentifier}return l===d}function Qh(i,n){const l=hf(i).offsetMinutes;return l!==void 0?6e10*l:Xb(i,n)}function Hb(i){const n=i<0?"-":"+",l=Math.abs(i),d=Math.floor(l/36e11),m=Math.floor(l/6e10)%60,_=Math.floor(l/1e9)%60,v=l%1e9;return`${n}${Ev(d,m,_,v,_===0&&v===0?"minute":"auto")}`}function Hl(i,n){const l=Qh(i,n);let{isoDate:{year:d,month:m,day:_},time:{hour:v,minute:c,second:C,millisecond:R,microsecond:N,nanosecond:B}}=PS(n);return s_(d,m,_,v,c,C,R,N,B+l)}function bs(i,n,l){return kS(r_(i,n),i,n,l)}function kS(i,n,l,d){const m=i.length;if(m===1)return i[0];if(m)switch(d){case"compatible":case"earlier":return i[0];case"later":return i[m-1];case"reject":throw new RangeError("multiple instants found")}if(d==="reject")throw new RangeError("multiple instants found");const _=Xa(l),v=W.subtract(_,pf);Uu(v);const c=Qh(n,v),C=W.add(_,pf);Uu(C);const R=Qh(n,C)-c;switch(d){case"earlier":{const N=jn.fromComponents(0,0,0,0,0,-R),B=ug(l.time,N);return r_(n,oi(Co(l.isoDate.year,l.isoDate.month,l.isoDate.day+B.deltaDays),B))[0]}case"compatible":case"later":{const N=jn.fromComponents(0,0,0,0,0,R),B=ug(l.time,N),V=r_(n,oi(Co(l.isoDate.year,l.isoDate.month,l.isoDate.day+B.deltaDays),B));return V[V.length-1]}}}function r_(i,n){if(i==="UTC")return Jm(n.isoDate),[Xa(n)];const l=hf(i).offsetMinutes;if(l!==void 0){const d=s_(n.isoDate.year,n.isoDate.month,n.isoDate.day,n.time.hour,n.time.minute-l,n.time.second,n.time.millisecond,n.time.microsecond,n.time.nanosecond);Jm(d.isoDate);const m=Xa(d);return Uu(m),[m]}return Jm(n.isoDate),function(d,m){let _=Xa(m),v=W.subtract(_,pf);W.lessThan(v,t_)&&(v=_);let c=W.add(_,pf);W.greaterThan(c,og)&&(c=_);const C=Xb(d,v),R=Xb(d,c);return(C===R?[C]:[C,R]).map(B=>{const V=W.subtract(_,W.BigInt(B)),G=function(ae,me){const{epochMilliseconds:pe,time:{millisecond:Ne,microsecond:Ve,nanosecond:Fe}}=PS(me),{year:qe,month:Ae,day:Ke,hour:mt,minute:st,second:Pe}=zS(ae,pe);return s_(qe,Ae,Ke,mt,st,Pe,Ne,Ve,Fe)}(d,V);if(hg(m,G)===0)return Uu(V),V}).filter(B=>B!==void 0)}(i,n)}function sf(i,n){const l=oi(n,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),d=r_(i,l);if(d.length)return d[0];const m=Xa(l),_=W.subtract(m,pf);return Uu(_),Nx(i,_)}function k_(i){let n;return n=i<0||i>9999?(i<0?"-":"+")+n_(Math.abs(i),6):n_(i,4),n}function al(i){return n_(i,2)}function IS(i,n){let l;if(n==="auto"){if(i===0)return"";l=n_(i,9).replace(/0+$/,"")}else{if(n===0)return"";l=n_(i,9).slice(0,n)}return`.${l}`}function Ev(i,n,l,d,m){let _=`${al(i)}:${al(n)}`;return m==="minute"||(_+=`:${al(l)}`,_+=IS(d,m)),_}function Aw(i,n,l){let d=n;d===void 0&&(d="UTC");const m=te(i,_n),_=a_(Hl(d,m),"iso8601",l,"never");let v="Z";return n!==void 0&&(v=RS(Qh(d,m))),`${_}${v}`}function P0(i,n){const l=te(i,Zs),d=te(i,$s),m=te(i,wo),_=te(i,Ys),v=te(i,qs),c=te(i,Hs),C=nv(i);let R="";l!==0&&(R+=`${Math.abs(l)}Y`),d!==0&&(R+=`${Math.abs(d)}M`),m!==0&&(R+=`${Math.abs(m)}W`),_!==0&&(R+=`${Math.abs(_)}D`);let N="";v!==0&&(N+=`${Math.abs(v)}H`),c!==0&&(N+=`${Math.abs(c)}M`);const B=jn.fromComponents(0,0,te(i,Xs),te(i,Ws),te(i,Qs),te(i,To));B.isZero()&&!["second","millisecond","microsecond","nanosecond"].includes(Yh(i))&&n==="auto"||(N+=`${Math.abs(B.sec)}${IS(Math.abs(B.subsec),n)}S`);let V=`${C<0?"-":""}P${R}`;return N&&(V=`${V}T${N}`),V}function Mw(i,n="auto"){const{year:l,month:d,day:m}=te(i,vn);return`${k_(l)}-${al(d)}-${al(m)}${x_(te(i,At),n)}`}function Cw({hour:i,minute:n,second:l,millisecond:d,microsecond:m,nanosecond:_},v){return Ev(i,n,l,1e6*d+1e3*m+_,v)}function a_(i,n,l,d="auto"){const{isoDate:{year:m,month:_,day:v},time:{hour:c,minute:C,second:R,millisecond:N,microsecond:B,nanosecond:V}}=i;return`${k_(m)}-${al(_)}-${al(v)}T${Ev(c,C,R,1e6*N+1e3*B+V,l)}${x_(n,d)}`}function Dw(i,n="auto"){const{year:l,month:d,day:m}=te(i,vn);let _=`${al(d)}-${al(m)}`;const v=te(i,At);n!=="always"&&n!=="critical"&&v==="iso8601"||(_=`${k_(l)}-${_}`);const c=x_(v,n);return c&&(_+=c),_}function kw(i,n="auto"){const{year:l,month:d,day:m}=te(i,vn);let _=`${k_(l)}-${al(d)}`;const v=te(i,At);n!=="always"&&n!=="critical"&&v==="iso8601"||(_+=`-${al(m)}`);const c=x_(v,n);return c&&(_+=c),_}function Iw(i,n,l="auto",d="auto",m="auto",_=void 0){let v=te(i,_n);if(_){const{unit:N,increment:B,roundingMode:V}=_;v=Jb(v,B,N,V)}const c=te(i,fi),C=Qh(c,v);let R=a_(Hl(c,v),"iso8601",n,"never");return m!=="never"&&(R+=RS(C)),d!=="never"&&(R+=`[${d==="critical"?"!":""}${c}]`),R+=x_(te(i,At),l),R}function Rw(i){return _S.test(i)}function wg(i){const n=jR.exec(i);if(!n)throw new RangeError(`invalid time zone offset: ${i}; must match HH:MM[:SS.SSSSSSSSS]`);return(n[1]==="-"?-1:1)*(1e9*(60*(60*+n[2]+ +(n[3]||0))+ +(n[4]||0))+ +((n[5]||0)+"000000000").slice(0,9))}let Sy;const LR=Object.assign(Object.create(null),{"/":!0,"-":!0,_:!0});function ev(i){if(Sy===void 0){const _=Intl.supportedValuesOf?.("timeZone");if(_){Sy=new Map;for(let v=0;v<_.length;v++){const c=_[v];Sy.set(o_(c),c)}}else Sy=null}const n=o_(i);let l=Sy?.get(n);if(l)return{identifier:l,primaryIdentifier:l};try{l=mS(i).resolvedOptions().timeZone}catch{return}if(n==="antarctica/south_pole"&&(l="Antarctica/McMurdo"),IR.has(i))throw new RangeError(`${i} is a legacy time zone identifier from ICU. Use ${l} instead`);const d=[...n].map((_,v)=>v===0||LR[n[v-1]]?_.toUpperCase():_).join("").split("/");if(d.length===1)return n==="gb-eire"?{identifier:"GB-Eire",primaryIdentifier:l}:{identifier:n.length<=3||/[-0-9]/.test(n)?n.toUpperCase():d[0],primaryIdentifier:l};if(d[0]==="Etc")return{identifier:`Etc/${["Zulu","Greenwich","Universal"].includes(d[1])?d[1]:d[1].toUpperCase()}`,primaryIdentifier:l};if(d[0]==="Us")return{identifier:`US/${d[1]}`,primaryIdentifier:l};const m=new Map([["Act","ACT"],["Lhi","LHI"],["Nsw","NSW"],["Dar_Es_Salaam","Dar_es_Salaam"],["Port_Of_Spain","Port_of_Spain"],["Port-Au-Prince","Port-au-Prince"],["Isle_Of_Man","Isle_of_Man"],["Comodrivadavia","ComodRivadavia"],["Knox_In","Knox_IN"],["Dumontdurville","DumontDUrville"],["Mcmurdo","McMurdo"],["Denoronha","DeNoronha"],["Easterisland","EasterIsland"],["Bajanorte","BajaNorte"],["Bajasur","BajaSur"]]);return d[1]=m.get(d[1])??d[1],d.length>2&&(d[2]=m.get(d[2])??d[2]),{identifier:d.join("/"),primaryIdentifier:l}}function Sp(i,n){const{year:l,month:d,day:m,hour:_,minute:v,second:c}=zS(i,n);let C=n%1e3;return C<0&&(C+=1e3),1e6*(zx({isoDate:{year:l,month:d,day:m},time:{hour:_,minute:v,second:c,millisecond:C}})-n)}function Xb(i,n){return Sp(i,Xl(n,"floor"))}function Px(i){const n=i<0?"-":"+",l=Math.abs(i);return`${n}${Ev(Math.floor(l/60),l%60,0,0,"minute")}`}function RS(i){return Px(cf(i,AR,"halfExpand")/6e10)}function zx({isoDate:{year:i,month:n,day:l},time:{hour:d,minute:m,second:_,millisecond:v}}){const c=i%400,C=(i-c)/400,R=new Date;return R.setUTCHours(d,m,_,v),R.setUTCFullYear(c,n-1,l),R.getTime()+DR*C}function Xa(i){const n=zx(i),l=1e3*i.time.microsecond+i.time.nanosecond;return W.add(Lu(n),W.BigInt(l))}function PS(i){let n=Xl(i,"trunc"),l=W.toNumber(W.remainder(i,v_));l<0&&(l+=1e6,n-=1);const d=Math.floor(l/1e3)%1e3,m=l%1e3,_=new Date(n);return{epochMilliseconds:n,isoDate:{year:_.getUTCFullYear(),month:_.getUTCMonth()+1,day:_.getUTCDate()},time:{hour:_.getUTCHours(),minute:_.getUTCMinutes(),second:_.getUTCSeconds(),millisecond:_.getUTCMilliseconds(),microsecond:d,nanosecond:m}}}function Nx(i,n){if(i==="UTC")return null;const l=Xl(n,"floor");if(l<Zy)return Nx(i,Lu(Zy));const d=Date.now(),m=Math.max(l,d)+366*mf*3;let _=l,v=Sp(i,_),c=_,C=v;for(;v===C&&_<m;){if(c=_+2*mf*7,c>pS)return null;C=Sp(i,c),v===C&&(_=c)}return v===C?null:Lu(ZS(R=>Sp(i,R),_,c,v,C))}function Wb(i,n){if(i==="UTC")return null;const l=Xl(n,"ceil"),d=Date.now(),m=d+366*mf*3;if(l>m){const R=Wb(i,Lu(m));if(R===null||W.lessThan(R,Lu(d)))return R}if(i==="Africa/Casablanca"||i==="Africa/El_Aaiun"){const R=Date.UTC(2088,0,1);if(R<l)return Wb(i,Lu(R))}let _=l-1;if(_<Zy)return null;let v=Sp(i,_),c=_,C=v;for(;v===C&&_>Zy;){if(c=_-2*mf*7,c<Zy)return null;C=Sp(i,c),v===C&&(_=c)}return v===C?null:Lu(ZS(R=>Sp(i,R),c,_,C,v))}function zS(i,n){return function(l){const d=l.split(/[^\w]+/);if(d.length!==7)throw new RangeError(`expected 7 parts in "${l}`);const m=+d[0],_=+d[1];let v=+d[2];const c=d[3];if(c[0]==="b"||c[0]==="B")v=1-v;else if(c[0]!=="a"&&c[0]!=="A")throw new RangeError(`Unknown era ${c} in "${l}`);const C=d[4]==="24"?0:+d[4],R=+d[5],N=+d[6];if(!(Number.isFinite(v)&&Number.isFinite(m)&&Number.isFinite(_)&&Number.isFinite(C)&&Number.isFinite(R)&&Number.isFinite(N)))throw new RangeError(`Invalid number in "${l}`);return{year:v,month:m,day:_,hour:C,minute:R,second:N}}(mS(i).format(n))}function tv(i){return i!==void 0&&!(i%4!=0||i%100==0&&i%400!=0)}function Ep(i,n){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[tv(i)?"leapyear":"standard"][n-1]}function nv(i){const n=[te(i,Zs),te(i,$s),te(i,wo),te(i,Ys),te(i,qs),te(i,Hs),te(i,Xs),te(i,Ws),te(i,Qs),te(i,To)];for(let l=0;l<n.length;l++){const d=n[l];if(d!==0)return d<0?-1:1}return 0}function Av(i){const n=["years","months","weeks","days"];for(let l=0;l<n.length;l++){const d=i[n[l]];if(d!==0)return d<0?-1:1}return 0}function NS(i){const n=Av(i.date);return n!==0?n:i.time.sign()}function wp(i,n){let l=i,d=n;if(!Number.isFinite(l)||!Number.isFinite(d))throw new RangeError("infinity is out of range");return d-=1,l+=Math.floor(d/12),d%=12,d<0&&(d+=12),d+=1,{year:l,month:d}}function Co(i,n,l){let d=i,m=n,_=l;if(!Number.isFinite(_))throw new RangeError("infinity is out of range");({year:d,month:m}=wp(d,m));const v=146097;if(Math.abs(_)>v){const R=Math.trunc(_/v);d+=400*R,_-=R*v}let c=0,C=m>2?d:d-1;for(;c=tv(C)?366:365,_<-c;)d-=1,C-=1,_+=c;for(C+=1;c=tv(C)?366:365,_>c;)d+=1,C+=1,_-=c;for(;_<1;)({year:d,month:m}=wp(d,m-1)),_+=Ep(d,m);for(;_>Ep(d,m);)_-=Ep(d,m),{year:d,month:m}=wp(d,m+1);return{year:d,month:m,day:_}}function s_(i,n,l,d,m,_,v,c,C){const R=of(d,m,_,v,c,C);return oi(Co(i,n,l+R.deltaDays),R)}function of(i,n,l,d,m,_){let v,c=i,C=n,R=l,N=d,B=m,V=_;({div:v,mod:V}=Hm(V,3)),B+=v,V<0&&(B-=1,V+=1e3),{div:v,mod:B}=Hm(B,3),N+=v,B<0&&(N-=1,B+=1e3),R+=Math.trunc(N/1e3),N%=1e3,N<0&&(R-=1,N+=1e3),C+=Math.trunc(R/60),R%=60,R<0&&(C-=1,R+=60),c+=Math.trunc(C/60),C%=60,C<0&&(c-=1,C+=60);let G=Math.trunc(c/24);return c%=24,c<0&&(G-=1,c+=24),G+=0,c+=0,C+=0,R+=0,N+=0,B+=0,V+=0,{deltaDays:G,hour:c,minute:C,second:R,millisecond:N,microsecond:B,nanosecond:V}}function Pw(i,n){const l=vs(i,0);if(Av(l)===0)return i.days;const d=te(n,vn),m=rl(te(n,At),d,l,"constrain"),_=Pp(d.year,d.month-1,d.day),v=Pp(m.year,m.month-1,m.day)-_;return i.days+v}function Do(i){return new(Wa("%Temporal.Duration%"))(-te(i,Zs),-te(i,$s),-te(i,wo),-te(i,Ys),-te(i,qs),-te(i,Hs),-te(i,Xs),-te(i,Ws),-te(i,Qs),-te(i,To))}function Ks(i,n,l){return Math.min(l,Math.max(n,i))}function LS(i,n,l){const d=Ks(n,1,12);return{year:i,month:d,day:Ks(l,1,Ep(i,d))}}function Pa(i,n,l){if(i<n||i>l)throw new RangeError(`value out of range: ${n} <= ${i} <= ${l}`)}function Ip(i,n,l){Pa(n,1,12),Pa(l,1,Ep(i,n))}function Up(i){Rp(oi(i,{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}))}function Mv(i,n,l,d,m,_){Pa(i,0,23),Pa(n,0,59),Pa(l,0,59),Pa(d,0,999),Pa(m,0,999),Pa(_,0,999)}function Lx(i,n,l,d,m,_,v,c,C){Ip(i,n,l),Mv(d,m,_,v,c,C)}function Rp(i){const n=Xa(i);(W.lessThan(n,MR)||W.greaterThan(n,CR))&&Uu(n)}function Qb(i){Xa(i)}function Uu(i){if(W.lessThan(i,t_)||W.greaterThan(i,og))throw new RangeError("date/time value is outside of supported range")}function Ox({year:i,month:n}){Pa(i,vw,bw),i===vw?Pa(n,4,12):i===bw&&Pa(n,1,9)}function Cv(i,n,l,d,m,_,v,c,C,R){let N=0;const B=[i,n,l,d,m,_,v,c,C,R];for(let Ne=0;Ne<B.length;Ne++){const Ve=B[Ne];if(Ve===1/0||Ve===-1/0)throw new RangeError("infinite values not allowed as duration fields");if(Ve!==0){const Fe=Ve<0?-1:1;if(N!==0&&Fe!==N)throw new RangeError("mixed-sign values not allowed as duration fields");N=Fe}}if(Math.abs(i)>=2**32||Math.abs(n)>=2**32||Math.abs(l)>=2**32)throw new RangeError("years, months, and weeks must be < 2");const V=Hm(c,3),G=Hm(C,6),ae=Hm(R,9),me=Hm(1e6*V.mod+1e3*G.mod+ae.mod,9).div,pe=86400*d+3600*m+60*_+v+V.div+G.div+ae.div+me;if(!Number.isSafeInteger(pe))throw new RangeError("total of duration time units cannot exceed 9007199254740991.999999999 s")}function qm(i){return{date:{years:te(i,Zs),months:te(i,$s),weeks:te(i,wo),days:te(i,Ys)},time:jn.fromComponents(te(i,qs),te(i,Hs),te(i,Xs),te(i,Ws),te(i,Qs),te(i,To))}}function Nu(i){const n=jn.fromComponents(te(i,qs),te(i,Hs),te(i,Xs),te(i,Ws),te(i,Qs),te(i,To)).add24HourDays(te(i,Ys));return{date:{years:te(i,Zs),months:te(i,$s),weeks:te(i,wo),days:0},time:n}}function OS(i){const n=Nu(i),l=Math.trunc(n.time.sec/86400);return Cv(n.date.years,n.date.months,n.date.weeks,l,0,0,0,0,0,0),{...n.date,days:l}}function Gl(i,n){const l=i.time.sign();let d=i.time.abs().subsec,m=0,_=0,v=i.time.abs().sec,c=0,C=0,R=0;switch(n){case"year":case"month":case"week":case"day":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,C=Math.trunc(c/60),c%=60,R=Math.trunc(C/24),C%=24;break;case"hour":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60,C=Math.trunc(c/60),c%=60;break;case"minute":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3,c=Math.trunc(v/60),v%=60;break;case"second":m=Math.trunc(d/1e3),d%=1e3,_=Math.trunc(m/1e3),m%=1e3,v+=Math.trunc(_/1e3),_%=1e3;break;case"millisecond":m=Math.trunc(d/1e3),d%=1e3,_=db(v,3,Math.trunc(m/1e3)),m%=1e3,v=0;break;case"microsecond":m=db(v,6,Math.trunc(d/1e3)),d%=1e3,v=0;break;case"nanosecond":d=db(v,9,d),v=0}return new(Wa("%Temporal.Duration%"))(i.date.years,i.date.months,i.date.weeks,i.date.days+l*R,l*C,l*c,l*v,l*_,l*m,l*d)}function id(i,n){return Av(i),n.sign(),{date:i,time:n}}function Pp(i,n,l){return zx({isoDate:{year:i,month:n+1,day:l},time:{hour:0,minute:0,second:0,millisecond:0}})/mf}function Jm({year:i,month:n,day:l}){if(Math.abs(Pp(i,n-1,l))>1e8)throw new RangeError("date/time value is outside the supported range")}function jx(i,n){const l=n.hour-i.hour,d=n.minute-i.minute,m=n.second-i.second,_=n.millisecond-i.millisecond,v=n.microsecond-i.microsecond,c=n.nanosecond-i.nanosecond;return jn.fromComponents(l,d,m,_,v,c)}function Bx(i,n,l,d,m){let _=jn.fromEpochNsDiff(n,i);return _=iv(_,l,d,m),id({years:0,months:0,weeks:0,days:0},_)}function jS(i,n,l,d){Qb(i),Qb(n);let m=jx(i.time,n.time);const _=m.sign(),v=Vu(i.isoDate,n.isoDate);let c=n.isoDate;v===_&&(c=Co(c.year,c.month,c.day+_),m=m.add24HourDays(-_));const C=nd("day",d),R=M_(l,i.isoDate,c,C);return d!==C&&(m=m.add24HourDays(R.days),R.days=0),id(R,m)}function BS(i,n,l,d,m){const _=W.subtract(n,i);if(W.equal(_,nl))return{date:{years:0,months:0,weeks:0,days:0},time:jn.ZERO};const v=W.lessThan(_,nl)?-1:1,c=Hl(l,i),C=Hl(l,n);let R,N=0,B=v===1?2:1,V=jx(c.time,C.time);for(V.sign()===-v&&N++;N<=B;N++){R=oi(Co(C.isoDate.year,C.isoDate.month,C.isoDate.day-N*v),c.time);const ae=bs(l,R,"compatible");if(V=jn.fromEpochNsDiff(n,ae),V.sign()!==-v)break}const G=nd("day",m);return id(M_(d,c.isoDate,R.isoDate,G),V)}function FS(i,n,l,d,m,_,v,c,C){let R,N,B,V,G=n;switch(c){case"year":{const Rt=cf(G.date.years,v,"trunc");R=Rt,N=Rt+v*i,B={years:R,months:0,weeks:0,days:0},V={...B,years:N};break}case"month":{const Rt=cf(G.date.months,v,"trunc");R=Rt,N=Rt+v*i,B=vs(G.date,0,0,R),V=vs(G.date,0,0,N);break}case"week":{const Rt=vs(G.date,0,0),jt=rl(_,d.isoDate,Rt,"constrain"),en=M_(_,jt,Co(jt.year,jt.month,jt.day+G.date.days),"week"),ln=cf(G.date.weeks+en.weeks,v,"trunc");R=ln,N=ln+v*i,B=vs(G.date,0,R),V=vs(G.date,0,N);break}case"day":{const Rt=cf(G.date.days,v,"trunc");R=Rt,N=Rt+v*i,B=vs(G.date,R),V=vs(G.date,N);break}}const ae=rl(_,d.isoDate,B,"constrain"),me=rl(_,d.isoDate,V,"constrain");let pe,Ne;const Ve=oi(ae,d.time),Fe=oi(me,d.time);m?(pe=bs(m,Ve,"compatible"),Ne=bs(m,Fe,"compatible")):(pe=Xa(Ve),Ne=Xa(Fe));const qe=jn.fromEpochNsDiff(l,pe),Ae=jn.fromEpochNsDiff(Ne,pe),Ke=vv(C,i<0?"negative":"positive"),mt=qe.add(qe).abs().subtract(Ae.abs()).sign(),st=Math.abs(R)/v%2==0,Pe=qe.isZero()?Math.abs(R):qe.cmp(Ae)?bv(Math.abs(R),Math.abs(N),mt,st,Ke):Math.abs(N),rt=new jn(W.add(W.multiply(Ae.totalNs,W.BigInt(R)),W.multiply(qe.totalNs,W.BigInt(v*i)))).fdiv(Ae.totalNs),Mt=Pe===Math.abs(N);return G={date:Mt?V:B,time:jn.ZERO},{nudgeResult:{duration:G,nudgedEpochNs:Mt?Ne:pe,didExpandCalendarUnit:Mt},total:rt}}function Dv(i,n,l,d,m,_,v,c,C){let R=i;const N=ku(c)||d&&c==="day",B=NS(R)<0?-1:1;let V;return N?{nudgeResult:V}=FS(B,R,n,l,d,m,v,c,C):V=d?function(G,ae,me,pe,Ne,Ve,Fe,qe){let Ae=ae;const Ke=rl(Ne,me.isoDate,Ae.date,"constrain"),mt=oi(Ke,me.time),st=oi(Co(Ke.year,Ke.month,Ke.day+G),me.time),Pe=bs(pe,mt,"compatible"),rt=bs(pe,st,"compatible"),Mt=jn.fromEpochNsDiff(rt,Pe);if(Mt.sign()!==G)throw new RangeError("time zone returned inconsistent Instants");const Rt=W.BigInt(cg[Fe]*Ve);let jt=Ae.time.round(Rt,qe);const en=jt.subtract(Mt),ln=en.sign()!==-G;let Ge,ct;return ln?(Ge=G,jt=en.round(Rt,qe),ct=jt.addToEpochNs(rt)):(Ge=0,ct=jt.addToEpochNs(Pe)),{duration:id(vs(Ae.date,Ae.date.days+Ge),jt),nudgedEpochNs:ct,didExpandCalendarUnit:ln}}(B,R,l,d,m,v,c,C):function(G,ae,me,pe,Ne,Ve){let Fe=G;const qe=Fe.time.add24HourDays(Fe.date.days),Ae=qe.round(W.BigInt(pe*cg[Ne]),Ve),Ke=Ae.subtract(qe),{quotient:mt}=qe.divmod(W0),{quotient:st}=Ae.divmod(W0),Pe=Math.sign(st-mt)===qe.sign(),rt=Ke.addToEpochNs(ae);let Mt=0,Rt=Ae;return qh(me)==="date"&&(Mt=st,Rt=Ae.add(jn.fromComponents(24*-st,0,0,0,0,0))),{duration:{date:vs(Fe.date,Mt),time:Rt},nudgedEpochNs:rt,didExpandCalendarUnit:Pe}}(R,n,_,v,c,C),R=V.duration,V.didExpandCalendarUnit&&c!=="week"&&(R=function(G,ae,me,pe,Ne,Ve,Fe,qe){let Ae=ae;if(qe===Fe)return Ae;const Ke=$y.indexOf(Fe);for(let mt=$y.indexOf(qe)-1;mt>=Ke;mt--){const st=$y[mt];if(st==="week"&&Fe!=="week")continue;let Pe;switch(st){case"year":Pe={years:Ae.date.years+G,months:0,weeks:0,days:0};break;case"month":{const Rt=Ae.date.months+G;Pe=vs(Ae.date,0,0,Rt);break}case"week":{const Rt=Ae.date.weeks+G;Pe=vs(Ae.date,0,Rt);break}}const rt=oi(rl(Ve,pe.isoDate,Pe,"constrain"),pe.time);let Mt;if(Mt=Ne?bs(Ne,rt,"compatible"):Xa(rt),H0(me,Mt)===-G)break;Ae={date:Pe,time:jn.ZERO}}return Ae}(B,R,V.nudgedEpochNs,l,d,m,_,nd(c,"day"))),R}function zw(i,n,l,d,m,_){return ku(_)||d&&_==="day"?FS(NS(i)<0?-1:1,i,n,l,d,m,1,_,"trunc").total:Hy(i.time.add24HourDays(i.date.days),_)}function US(i,n,l,d,m,_,v){if(hg(i,n)==0)return{date:{years:0,months:0,weeks:0,days:0},time:jn.ZERO};Rp(i),Rp(n);const c=jS(i,n,l,d);return _==="nanosecond"&&m===1?c:Dv(c,Xa(n),i,null,l,d,m,_,v)}function VS(i,n,l,d,m,_,v,c){if(qh(m)==="time")return Bx(i,n,_,v,c);const C=BS(i,n,l,d,m);return v==="nanosecond"&&_===1?C:Dv(C,n,Hl(l,i),l,d,m,_,v,c)}function Tg(i,n,l,d,m,_){const v=lg.reduce((G,ae)=>{const me=ae[0],pe=ae[1],Ne=ae[2];return l!=="datetime"&&Ne!==l||d.includes(pe)||G.push(pe,me),G},[]);let c=Eo(n,"largestUnit",l,"auto");if(d.includes(c))throw new RangeError(`largestUnit must be one of ${v.join(", ")}, not ${c}`);const C=bg(n);let R=Fc(n,"trunc");i==="since"&&(R=function(G){switch(G){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return G}}(R));const N=Eo(n,"smallestUnit",l,m);if(d.includes(N))throw new RangeError(`smallestUnit must be one of ${v.join(", ")}, not ${N}`);const B=nd(_,N);if(c==="auto"&&(c=B),nd(c,N)!==c)throw new RangeError(`largestUnit ${c} cannot be smaller than smallestUnit ${N}`);const V={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[N];return V!==void 0&&xg(C,V,!1),{largestUnit:c,roundingIncrement:C,roundingMode:R,smallestUnit:N}}function Nw(i,n,l,d){const m=Ny(l),_=Tg(i,Qt(d),"time",[],"nanosecond","second");let v=Gl(Bx(te(n,_n),te(m,_n),_.roundingIncrement,_.smallestUnit,_.roundingMode),_.largestUnit);return i==="since"&&(v=Do(v)),v}function Lw(i,n,l,d){const m=Py(l),_=te(n,At),v=te(m,At);if(!Fu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Tg(i,Qt(d),"date",[],"day","day"),C=Wa("%Temporal.Duration%"),R=te(n,vn),N=te(m,vn);if(Vu(R,N)===0)return new C;let B={date:M_(_,R,N,c.largestUnit),time:jn.ZERO};if(c.smallestUnit!=="day"||c.roundingIncrement!==1){const G=oi(R,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});B=Dv(B,Xa(oi(N,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),G,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let V=Gl(B,"day");return i==="since"&&(V=Do(V)),V}function Ow(i,n,l,d){const m=zy(l),_=te(n,At),v=te(m,At);if(!Fu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Tg(i,Qt(d),"datetime",[],"nanosecond","day"),C=Wa("%Temporal.Duration%"),R=te(n,cr),N=te(m,cr);if(hg(R,N)===0)return new C;let B=Gl(US(R,N,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);return i==="since"&&(B=Do(B)),B}function jw(i,n,l,d){const m=lf(l),_=Tg(i,Qt(d),"time",[],"nanosecond","hour");let v=jx(te(n,Er),te(m,Er));v=iv(v,_.roundingIncrement,_.smallestUnit,_.roundingMode);let c=Gl(id({years:0,months:0,weeks:0,days:0},v),_.largestUnit);return i==="since"&&(c=Do(c)),c}function Bw(i,n,l,d){const m=Ly(l),_=te(n,At),v=te(m,At);if(!Fu(_,v))throw new RangeError(`cannot compute difference between months of ${_} and ${v} calendars`);const c=Tg(i,Qt(d),"date",["week","day"],"month","year"),C=Wa("%Temporal.Duration%");if(Vu(te(n,vn),te(m,vn))==0)return new C;const R=to(_,te(n,vn),"year-month");R.day=1;const N=gf(_,R,"constrain"),B=to(_,te(m,vn),"year-month");B.day=1;const V=gf(_,B,"constrain");let G={date:vs(M_(_,N,V,c.largestUnit),0,0),time:jn.ZERO};if(c.smallestUnit!=="month"||c.roundingIncrement!==1){const me=oi(N,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});G=Dv(G,Xa(oi(V,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0})),me,null,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode)}let ae=Gl(G,"day");return i==="since"&&(ae=Do(ae)),ae}function Fw(i,n,l,d){const m=Oy(l),_=te(n,At),v=te(m,At);if(!Fu(_,v))throw new RangeError(`cannot compute difference between dates of ${_} and ${v} calendars`);const c=Tg(i,Qt(d),"datetime",[],"nanosecond","hour"),C=te(n,_n),R=te(m,_n),N=Wa("%Temporal.Duration%");let B;if(qh(c.largestUnit)!=="date")B=Gl(Bx(C,R,c.roundingIncrement,c.smallestUnit,c.roundingMode),c.largestUnit);else{const V=te(n,fi);if(!DS(V,te(m,fi)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");if(W.equal(C,R))return new N;B=Gl(VS(C,R,V,_,c.largestUnit,c.roundingIncrement,c.smallestUnit,c.roundingMode),"hour")}return i==="since"&&(B=Do(B)),B}function ug({hour:i,minute:n,second:l,millisecond:d,microsecond:m,nanosecond:_},v){let c=l,C=_;return c+=v.sec,C+=v.subsec,of(i,n,c,d,m,C)}function Kb(i,n){const l=n.addToEpochNs(i);return Uu(l),l}function jy(i,n,l,d,m="constrain"){if(Av(d.date)===0)return Kb(i,d.time);const _=Hl(n,i);return Kb(bs(n,oi(rl(l,_.isoDate,d.date,m),_.time),"compatible"),d.time)}function Uw(i,n,l){let d=$l(l);i==="subtract"&&(d=Do(d));const m=nd(Yh(n),Yh(d));if(ku(m))throw new RangeError("For years, months, or weeks arithmetic, use date arithmetic relative to a starting point");const _=Nu(n),v=Nu(d);return Gl(id({years:0,months:0,weeks:0,days:0},_.time.add(v.time)),m)}function Vw(i,n,l){let d=$l(l);i==="subtract"&&(d=Do(d));const m=Yh(d);if(qh(m)==="date")throw new RangeError(`Duration field ${m} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);const _=Nu(d);return zu(Kb(te(n,_n),_.time))}function Gw(i,n,l,d){const m=te(n,At);let _=$l(l);i==="subtract"&&(_=Do(_));const v=OS(_),c=ni(Qt(d));return Js(rl(m,te(n,vn),v,c),m)}function Zw(i,n,l,d){let m=$l(l);i==="subtract"&&(m=Do(m));const _=ni(Qt(d)),v=te(n,At),c=Nu(m),C=te(n,cr),R=ug(C.time,c.time),N=vs(c.date,R.deltaDays);return Cv(N.years,N.months,N.weeks,N.days,0,0,0,0,0,0),Vl(oi(rl(v,C.isoDate,N,_),R),v)}function $w(i,n,l){let d=$l(l);i==="subtract"&&(d=Do(d));const m=Nu(d),{hour:_,minute:v,second:c,millisecond:C,microsecond:R,nanosecond:N}=ug(te(n,Er),m.time);return Wh(Sv(_,v,c,C,R,N,"reject"))}function Yw(i,n,l,d){let m=$l(l);i==="subtract"&&(m=Do(m));const _=ni(Qt(d)),v=nv(m),c=te(n,At),C=to(c,te(n,vn),"year-month");C.day=1;let R=gf(c,C,"constrain");if(v<0){const B=rl(c,R,{months:1},"constrain");R=Co(B.year,B.month,B.day-1)}const N=OS(m);return Up(R),Km(i_(c,to(c,rl(c,R,N,_),"year-month"),_),c)}function qw(i,n,l,d){let m=$l(l);i==="subtract"&&(m=Do(m));const _=ni(Qt(d)),v=te(n,fi),c=te(n,At),C=qm(m);return _s(jy(te(n,_n),v,c,C,_),v,c)}function cf(i,n,l){const d=Math.trunc(i/n),m=i%n,_=i<0?"negative":"positive",v=Math.abs(d),c=v+1,C=So(Math.abs(2*m)-n),R=v%2==0,N=vv(l,_),B=m===0?v:bv(v,c,C,R,N);return n*(_==="positive"?B:-B)}function Jb(i,n,l,d){const m=cg[l]*n;return function(_,v,c){const C=Zh(_),R=Zh(v),N=W.divide(C,R),B=W.remainder(C,R),V=vv(c,"positive");let G,ae;W.lessThan(C,nl)?(G=W.subtract(N,e_),ae=N):(G=N,ae=W.add(N,e_));const me=H0(vp(W.multiply(B,kx)),R)*(W.lessThan(C,nl)?-1:1)+0,pe=W.equal(B,nl)?N:bv(G,ae,me,KT(G),V);return W.multiply(pe,R)}(i,W.BigInt(m),d)}function ex(i,n,l,d){Qb(i);const{year:m,month:_,day:v}=i.isoDate,c=tx(i.time,n,l,d);return oi(Co(m,_,v+c.deltaDays),c)}function tx({hour:i,minute:n,second:l,millisecond:d,microsecond:m,nanosecond:_},v,c,C){let R;switch(c){case"day":case"hour":R=1e3*(1e3*(1e3*(60*(60*i+n)+l)+d)+m)+_;break;case"minute":R=1e3*(1e3*(1e3*(60*n+l)+d)+m)+_;break;case"second":R=1e3*(1e3*(1e3*l+d)+m)+_;break;case"millisecond":R=1e3*(1e3*d+m)+_;break;case"microsecond":R=1e3*m+_;break;case"nanosecond":R=_}const N=cg[c],B=cf(R,N*v,C)/N;switch(c){case"day":return{deltaDays:B,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return of(B,0,0,0,0,0);case"minute":return of(i,B,0,0,0,0);case"second":return of(i,n,B,0,0,0);case"millisecond":return of(i,n,l,B,0,0);case"microsecond":return of(i,n,l,d,B,0);case"nanosecond":return of(i,n,l,d,m,B);default:throw new Error(`Invalid unit ${c}`)}}function iv(i,n,l,d){const m=cg[l];return i.round(W.BigInt(m*n),d)}function Hy(i,n){const l=cg[n];return i.fdiv(W.BigInt(l))}function Vu(i,n){return i.year!==n.year?So(i.year-n.year):i.month!==n.month?So(i.month-n.month):i.day!==n.day?So(i.day-n.day):0}function nx(i,n){return i.hour!==n.hour?So(i.hour-n.hour):i.minute!==n.minute?So(i.minute-n.minute):i.second!==n.second?So(i.second-n.second):i.millisecond!==n.millisecond?So(i.millisecond-n.millisecond):i.microsecond!==n.microsecond?So(i.microsecond-n.microsecond):i.nanosecond!==n.nanosecond?So(i.nanosecond-n.nanosecond):0}function hg(i,n){const l=Vu(i.isoDate,n.isoDate);return l!==0?l:nx(i.time,n.time)}function GS(i){const n=rv(i);return globalThis.BigInt!==void 0?globalThis.BigInt(n.toString(10)):n}function Xl(i,n){const l=Zh(i),{quotient:d,remainder:m}=Iy(l,v_);let _=W.toNumber(d);return n==="floor"&&W.toNumber(m)<0&&(_-=1),n==="ceil"&&W.toNumber(m)>0&&(_+=1),_}function Lu(i){if(!Number.isInteger(i))throw new RangeError("epoch milliseconds must be an integer");return W.multiply(W.BigInt(i),v_)}function rv(i){let n=i;if(typeof i=="object"){const l=i[Symbol.toPrimitive];l&&typeof l=="function"&&(n=l.call(i,"number"))}if(typeof n=="number")throw new TypeError("cannot convert number to bigint");return typeof n=="bigint"?W.BigInt(n.toString(10)):W.BigInt(n)}const ix=(()=>{let i=W.BigInt(Date.now()%1e6);return()=>{const n=Date.now(),l=W.BigInt(n),d=W.add(Lu(n),i);return i=W.remainder(l,v_),W.greaterThan(d,og)?og:W.lessThan(d,t_)?t_:d}})();function Ey(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function So(i){return i<0?-1:i>0?1:i}function Qt(i){if(i===void 0)return Object.create(null);if(Ar(i)&&i!==null)return i;throw new TypeError("Options parameter must be an object, not "+(i===null?"null":typeof i))}function zp(i,n){const l=Object.create(null);return l[i]=n,l}function rd(i,n,l,d){let m=i[n];if(m!==void 0){if(m=wv(m),!l.includes(m))throw new RangeError(`${n} must be one of ${l.join(", ")}, not ${m}`);return m}if(d===cd)throw new RangeError(`${n} option is required`);return d}function io(i){const n=o_(i);if(!kR.includes(o_(n)))throw new RangeError(`invalid calendar identifier ${n}`);switch(n){case"ethiopic-amete-alem":return"ethioaa";case"islamicc":return"islamic-civil"}return n}function o_(i){let n="";for(let l=0;l<i.length;l++){const d=i.charCodeAt(l);n+=d>=65&&d<=90?String.fromCharCode(d+32):String.fromCharCode(d)}return n}function xf(i){throw new TypeError(`Do not use built-in arithmetic operators with Temporal objects. When comparing, use ${i==="PlainMonthDay"?"Temporal.PlainDate.compare(obj1.toPlainDate(year), obj2.toPlainDate(year))":`Temporal.${i}.compare(obj1, obj2)`}, not obj1 > obj2. When coercing to strings, use \`\${obj}\` or String(obj), not '' + obj. When coercing to numbers, use properties or methods of the object, not \`+obj\`. When concatenating with strings, use \`\${str}\${obj}\` or str.concat(obj), not str + obj. In React, coerce to a string before rendering a Temporal object.`)}const OR=new RegExp(`^${dS.source}$`),jR=new RegExp(`^${/([+-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/.source}$`);function ZS(i,n,l,d=i(n),m=i(l)){let _=n,v=l,c=d,C=m;for(;v-_>1;){let R=Math.trunc((_+v)/2);const N=i(R);N===c?(_=R,c=N):N===C&&(v=R,C=N)}return v}function $S(i){return[...i]}function YS(i,n){if(i!=="gregory"&&i!=="iso8601")return;const l=I_[i];let d=n.year;const{dayOfWeek:m,dayOfYear:_,daysInYear:v}=l.isoToDate(n,{dayOfWeek:!0,dayOfYear:!0,daysInYear:!0}),c=l.getFirstDayOfWeek(),C=l.getMinimalDaysInFirstWeek();let R=(m+7-c)%7,N=(m-_+7001-c)%7,B=Math.floor((_-1+N)/7);if(7-N>=C&&++B,B==0)B=function(V,G,ae,me){let pe=(me-V-ae+1)%7;pe<0&&(pe+=7);let Ne=Math.floor((ae+pe-1)/7);return 7-pe>=G&&++Ne,Ne}(c,C,_+l.isoToDate(l.dateAdd(n,{years:-1},"constrain"),{daysInYear:!0}).daysInYear,m),d--;else if(_>=v-5){let V=(R+v-_)%7;V<0&&(V+=7),6-V>=C&&_+7-R>v&&(B=1,d++)}return{week:B,year:d}}function Hw(i,n,l,d,m){if(n!==m.year){if(i*(n-m.year)>0)return!0}else if(l!==m.month){if(i*(l-m.month)>0)return!0}else if(d!==m.day&&i*(d-m.day)>0)return!0;return!1}const I_={};function Np(i){if(!i.startsWith("M"))throw new RangeError(`Invalid month code: ${i}.  Month codes must start with M.`);const n=+i.slice(1);if(Number.isNaN(n))throw new RangeError(`Invalid month code: ${i}`);return n}function Bu(i,n=!1){return`M${`${i}`.padStart(2,"0")}${n?"L":""}`}function Fx(i,n=void 0,l=12){let{month:d,monthCode:m}=i;if(m===void 0){if(d===void 0)throw new TypeError("Either month or monthCode are required");n==="reject"&&Pa(d,1,l),n==="constrain"&&(d=Ks(d,1,l)),m=Bu(d)}else{const _=Np(m);if(m!==Bu(_))throw new RangeError(`Invalid month code: ${m}`);if(d!==void 0&&d!==_)throw new RangeError(`monthCode ${m} and month ${d} must match if both are present`);if(d=_,d<1||d>l)throw new RangeError(`Invalid monthCode: ${m}`)}return{...i,month:d,monthCode:m}}I_.iso8601={resolveFields(i,n){if((n==="date"||n==="year-month")&&i.year===void 0)throw new TypeError("year is required");if((n==="date"||n==="month-day")&&i.day===void 0)throw new TypeError("day is required");Object.assign(i,Fx(i))},dateToISO:(i,n)=>Yy(i.year,i.month,i.day,n),monthDayToISOReferenceDate(i,n){const{month:l,day:d}=Yy(i.year??1972,i.month,i.day,n);return{month:l,day:d,year:1972}},extraFields:()=>[],fieldKeysToIgnore(i){const n=new Set;for(let l=0;l<i.length;l++){const d=i[l];n.add(d),d==="month"?n.add("monthCode"):d==="monthCode"&&n.add("month")}return $S(n)},dateAdd(i,{years:n=0,months:l=0,weeks:d=0,days:m=0},_){let{year:v,month:c,day:C}=i;return v+=n,c+=l,{year:v,month:c}=wp(v,c),{year:v,month:c,day:C}=Yy(v,c,C,_),C+=m+7*d,Co(v,c,C)},dateUntil(i,n,l){const d=-Vu(i,n);if(d===0)return{years:0,months:0,weeks:0,days:0};let m,_=0,v=0;if(l==="year"||l==="month"){let N=n.year-i.year;for(N!==0&&(N-=d);!Hw(d,i.year+N,i.month,i.day,n);)_=N,N+=d;let B=d;for(m=wp(i.year+_,i.month+B);!Hw(d,m.year,m.month,i.day,n);)v=B,B+=d,m=wp(m.year,m.month+d);l==="month"&&(v+=12*_,_=0)}m=wp(i.year+_,i.month+v);const c=LS(m.year,m.month,i.day);let C=0,R=Pp(n.year,n.month-1,n.day)-Pp(c.year,c.month-1,c.day);return l==="week"&&(C=Math.trunc(R/7),R%=7),{years:_,months:v,weeks:C,days:R}},isoToDate({year:i,month:n,day:l},d){const m={era:void 0,eraYear:void 0,year:i,month:n,day:l,daysInWeek:7,monthsInYear:12};if(d.monthCode&&(m.monthCode=Bu(n)),d.dayOfWeek){const _=n+(n<3?10:-2),v=i-(n<3?1:0),c=Math.floor(v/100),C=v-100*c,R=(l+Math.floor(2.6*_-.2)+(C+Math.floor(C/4))+(Math.floor(c/4)-2*c))%7;m.dayOfWeek=R+(R<=0?7:0)}if(d.dayOfYear){let _=l;for(let v=n-1;v>0;v--)_+=Ep(i,v);m.dayOfYear=_}return d.weekOfYear&&(m.weekOfYear=YS("iso8601",{year:i,month:n,day:l})),d.daysInMonth&&(m.daysInMonth=Ep(i,n)),(d.daysInYear||d.inLeapYear)&&(m.inLeapYear=tv(i),m.daysInYear=m.inLeapYear?366:365),m},getFirstDayOfWeek:()=>1,getMinimalDaysInFirstWeek:()=>4};class Ia{constructor(n){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,n!==void 0){let l=0;for(const d of n.map.entries()){if(++l>Ia.MAX_CACHE_ENTRIES)break;this.map.set(...d)}}}get(n){const l=this.map.get(n);return l&&(this.hits++,this.report()),this.calls++,l}set(n,l){this.map.set(n,l),this.misses++,this.report()}report(){}setObject(n){if(Ia.objectMap.get(n))throw new RangeError("object already cached");Ia.objectMap.set(n,this),this.report()}static getCacheForObject(n){let l=Ia.objectMap.get(n);return l||(l=new Ia,Ia.objectMap.set(n,l)),l}}function qS({isoYear:i,isoMonth:n,isoDay:l}){return`${k_(i)}-${al(n)}-${al(l)}T00:00Z`}function mb(i,n){return{years:i.year-n.year,months:i.month-n.month,days:i.day-n.day}}Ia.objectMap=new WeakMap,Ia.MAX_CACHE_ENTRIES=1e3;class Vp{constructor(){this.eras=[],this.hasEra=!1,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new Intl.DateTimeFormat(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:"short",timeZone:"UTC"})),this.formatter}getCalendarParts(n){let l=this.getFormatter(),d=new Date(n);if(n==="-271821-04-19T00:00Z"){const m=l.resolvedOptions();l=new Intl.DateTimeFormat(m.locale,{...m,timeZone:"Etc/GMT+1"}),d=new Date("-271821-04-20T00:00Z")}try{return l.formatToParts(d)}catch{throw new RangeError(`Invalid ISO date: ${n}`)}}isoToCalendarDate(n,l){const{year:d,month:m,day:_}=n,v=JSON.stringify({func:"isoToCalendarDate",isoYear:d,isoMonth:m,isoDay:_,id:this.id}),c=l.get(v);if(c)return c;const C=qS({isoYear:d,isoMonth:m,isoDay:_}),R=this.getCalendarParts(C),N={};for(let V=0;V<R.length;V++){const{type:G,value:ae}=R[V];if(G!=="year"&&G!=="relatedYear"||(this.hasEra?N.eraYear=+ae:N.year=+ae),G==="month"){const me=/^([0-9]*)(.*?)$/.exec(ae);if(!me||me.length!=3||!me[1]&&!me[2])throw new RangeError(`Unexpected month: ${ae}`);if(N.month=me[1]?+me[1]:1,N.month<1)throw new RangeError(`Invalid month ${ae} from ${C}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(N.month>13)throw new RangeError(`Invalid month ${ae} from ${C}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);me[2]&&(N.monthExtra=me[2])}G==="day"&&(N.day=+ae),this.hasEra&&G==="era"&&ae!=null&&ae!==""&&(N.era=ae.split(" (")[0].normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(/ /g,"-").toLowerCase())}if(this.hasEra&&N.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.hasEra){const V=this.eras.find(G=>N.era===G.genericName);V&&(N.era=V.code)}if(this.reviseIntlEra){const{era:V,eraYear:G}=this.reviseIntlEra(N,n);N.era=V,N.eraYear=G}this.checkIcuBugs&&this.checkIcuBugs(n);const B=this.adjustCalendarDate(N,l,"constrain",!0);if(B.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(n)}`);if(B.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(n)}`);if(B.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(n)}`);return l.set(v,B),["constrain","reject"].forEach(V=>{const G=JSON.stringify({func:"calendarToIsoDate",year:B.year,month:B.month,day:B.day,overflow:V,id:this.id});l.set(G,n)}),B}validateCalendarDate(n){const{month:l,year:d,day:m,eraYear:_,monthCode:v,monthExtra:c}=n;if(c!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(d===void 0&&_===void 0)throw new TypeError("year or eraYear is required");if(l===void 0&&v===void 0)throw new TypeError("month or monthCode is required");if(m===void 0)throw new RangeError("Missing day");if(v!==void 0){if(typeof v!="string")throw new RangeError("monthCode must be a string, not "+typeof v);if(!/^M([01]?\d)(L?)$/.test(v))throw new RangeError(`Invalid monthCode: ${v}`)}if(this.hasEra&&n.era===void 0!=(n.eraYear===void 0))throw new TypeError("properties era and eraYear must be provided together")}adjustCalendarDate(n,l=void 0,d="constrain",m=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let _=n;this.validateCalendarDate(_);const v=this.monthsInYear(_,l);let{month:c,monthCode:C}=_;return{month:c,monthCode:C}=Fx(_,d,v),{..._,month:c,monthCode:C}}regulateMonthDayNaive(n,l,d){const m=this.monthsInYear(n,d);let{month:_,day:v}=n;return l==="reject"?(Pa(_,1,m),Pa(v,1,this.maximumMonthLength(n))):(_=Ks(_,1,m),v=Ks(v,1,this.maximumMonthLength({...n,month:_}))),{...n,month:_,day:v}}calendarToIsoDate(n,l="constrain",d){const m=n;let _=this.adjustCalendarDate(n,d,l,!1);_=this.regulateMonthDayNaive(_,l,d);const{year:v,month:c,day:C}=_,R=JSON.stringify({func:"calendarToIsoDate",year:v,month:c,day:C,overflow:l,id:this.id});let N,B=d.get(R);if(B||m.year!==void 0&&m.month!==void 0&&m.day!==void 0&&(m.year!==_.year||m.month!==_.month||m.day!==_.day)&&(N=JSON.stringify({func:"calendarToIsoDate",year:m.year,month:m.month,day:m.day,overflow:l,id:this.id}),B=d.get(N),B))return B;let V=this.estimateIsoDate({year:v,month:c,day:C});const G=Ve=>{let Fe=this.addDaysIso(V,Ve);if(_.day>this.minimumMonthLength(_)){let qe=this.isoToCalendarDate(Fe,d);for(;qe.month!==c||qe.year!==v;){if(l==="reject")throw new RangeError(`day ${C} does not exist in month ${c} of year ${v}`);Fe=this.addDaysIso(Fe,-1),qe=this.isoToCalendarDate(Fe,d)}}return Fe};let ae=0,me=this.isoToCalendarDate(V,d),pe=mb(_,me);if(pe.years!==0||pe.months!==0||pe.days!==0){const Ve=365*pe.years+30*pe.months+pe.days;V=this.addDaysIso(V,Ve),me=this.isoToCalendarDate(V,d),pe=mb(_,me),pe.years===0&&pe.months===0?V=G(pe.days):ae=this.compareCalendarDates(_,me)}let Ne=8;for(;ae;){V=this.addDaysIso(V,ae*Ne);const Ve=me;me=this.isoToCalendarDate(V,d);const Fe=ae;if(ae=this.compareCalendarDates(_,me),ae){if(pe=mb(_,me),pe.years===0&&pe.months===0)V=G(pe.days),ae=0;else if(Fe&&ae!==Fe)if(Ne>1)Ne/=2;else{if(l==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...m})}`);this.compareCalendarDates(me,Ve)>0&&(V=this.addDaysIso(V,-1)),ae=0}}}if(d.set(R,V),N&&d.set(N,V),_.year===void 0||_.month===void 0||_.day===void 0||_.monthCode===void 0||this.hasEra&&(_.era===void 0||_.eraYear===void 0))throw new RangeError("Unexpected missing property");return V}compareCalendarDates(n,l){return n.year!==l.year?So(n.year-l.year):n.month!==l.month?So(n.month-l.month):n.day!==l.day?So(n.day-l.day):0}regulateDate(n,l="constrain",d){const m=this.calendarToIsoDate(n,l,d);return this.isoToCalendarDate(m,d)}addDaysIso(n,l){return Co(n.year,n.month,n.day+l)}addDaysCalendar(n,l,d){const m=this.calendarToIsoDate(n,"constrain",d),_=this.addDaysIso(m,l);return this.isoToCalendarDate(_,d)}addMonthsCalendar(n,l,d,m){let _=n;const{day:v}=_;for(let c=0,C=Math.abs(l);c<C;c++){const{month:R}=_,N=_,B=l<0?-Math.max(v,this.daysInPreviousMonth(_,m)):this.daysInMonth(_,m),V=this.calendarToIsoDate(_,"constrain",m);let G=this.addDaysIso(V,B);if(_=this.isoToCalendarDate(G,m),l>0){const ae=this.monthsInYear(N,m);for(;_.month-1!=R%ae;)G=this.addDaysIso(G,-1),_=this.isoToCalendarDate(G,m)}_.day!==v&&(_=this.regulateDate({..._,day:v},"constrain",m))}if(d==="reject"&&_.day!==v)throw new RangeError(`Day ${v} does not exist in resulting calendar month`);return _}addCalendar(n,{years:l=0,months:d=0,weeks:m=0,days:_=0},v,c){const{year:C,day:R,monthCode:N}=n,B=this.adjustCalendarDate({year:C+l,monthCode:N,day:R},c),V=this.addMonthsCalendar(B,d,v,c),G=_+7*m;return this.addDaysCalendar(V,G,c)}untilCalendar(n,l,d,m){let _=0,v=0,c=0,C=0;switch(d){case"day":_=this.calendarDaysUntil(n,l,m);break;case"week":{const R=this.calendarDaysUntil(n,l,m);_=R%7,v=(R-_)/7;break}case"month":case"year":{const R=this.compareCalendarDates(l,n);if(!R)return{years:0,months:0,weeks:0,days:0};const N=l.year-n.year,B=l.day-n.day;if(d==="year"&&N){let ae=0;l.monthCode>n.monthCode&&(ae=1),l.monthCode<n.monthCode&&(ae=-1),ae||(ae=Math.sign(B)),C=ae*R<0?N-R:N}let V,G=C?this.addCalendar(n,{years:C},"constrain",m):n;do c+=R,V=G,G=this.addMonthsCalendar(V,R,"constrain",m),G.day!==n.day&&(G=this.regulateDate({...G,day:n.day},"constrain",m));while(this.compareCalendarDates(l,G)*R>=0);c-=R,_=this.calendarDaysUntil(V,l,m);break}}return{years:C,months:c,weeks:v,days:_}}daysInMonth(n,l){const{day:d}=n,m=this.maximumMonthLength(n),_=this.minimumMonthLength(n);if(_===m)return _;const v=d<=m-_?m:_,c=this.calendarToIsoDate(n,"constrain",l),C=this.addDaysIso(c,v),R=this.isoToCalendarDate(C,l),N=this.addDaysIso(C,-R.day);return this.isoToCalendarDate(N,l).day}daysInPreviousMonth(n,l){const{day:d,month:m,year:_}=n;let v={year:m>1?_:_-1,month:m,day:1};const c=m>1?m-1:this.monthsInYear(v,l);v={...v,month:c};const C=this.minimumMonthLength(v),R=this.maximumMonthLength(v);if(C===R)return R;const N=this.calendarToIsoDate(n,"constrain",l),B=this.addDaysIso(N,-d);return this.isoToCalendarDate(B,l).day}startOfCalendarYear(n){return{year:n.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(n){return{year:n.year,month:n.month,day:1}}calendarDaysUntil(n,l,d){const m=this.calendarToIsoDate(n,"constrain",d),_=this.calendarToIsoDate(l,"constrain",d);return Pp(_.year,_.month-1,_.day)-Pp(m.year,m.month-1,m.day)}monthDaySearchStartYear(n,l){return 1972}monthDayFromFields(n,l,d){let m,_,v,c,C,{era:R,eraYear:N,year:B,month:V,monthCode:G,day:ae}=n;if(V!==void 0&&B===void 0&&(!this.hasEra||R===void 0||N===void 0))throw new TypeError("when month is present, year (or era and eraYear) are required");(G===void 0||B!==void 0||this.hasEra&&N!==void 0)&&({monthCode:G,day:ae}=this.isoToCalendarDate(this.calendarToIsoDate(n,l,d),d));const me={year:this.monthDaySearchStartYear(G,ae),month:12,day:31},pe=this.isoToCalendarDate(me,d),Ne=pe.monthCode>G||pe.monthCode===G&&pe.day>=ae?pe.year:pe.year-1;for(let Ve=0;Ve<20;Ve++){const Fe=this.adjustCalendarDate({day:ae,monthCode:G,year:Ne-Ve},d),qe=this.calendarToIsoDate(Fe,"constrain",d),Ae=this.isoToCalendarDate(qe,d);if({year:m,month:_,day:v}=qe,Ae.monthCode===G&&Ae.day===ae)return{month:_,day:v,year:m};if(l==="constrain"){const Ke=this.maxLengthOfMonthCodeInAnyYear(Ae.monthCode);if(Ae.monthCode===G&&Ae.day===Ke&&ae>Ke)return{month:_,day:v,year:m};(c===void 0||Ae.monthCode===c.monthCode&&Ae.day>c.day)&&(c=Ae,C=qe)}}if(l==="constrain"&&C!==void 0)return C;throw new RangeError(`No recent ${this.id} year with monthCode ${G} and day ${ae}`)}getFirstDayOfWeek(){}getMinimalDaysInFirstWeek(){}}class BR extends Vp{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}}}inLeapYear(n){const{year:l}=n;return(7*l+1)%19<7}monthsInYear(n){return this.inLeapYear(n)?13:12}minimumMonthLength(n){return this.minMaxMonthLength(n,"min")}maximumMonthLength(n){return this.minMaxMonthLength(n,"max")}minMaxMonthLength(n,l){const{month:d,year:m}=n,_=this.getMonthCode(m,d),v=Object.entries(this.months).find(C=>C[1].monthCode===_);if(v===void 0)throw new RangeError(`unmatched Hebrew month: ${d}`);const c=v[1].days;return typeof c=="number"?c:c[l]}maxLengthOfMonthCodeInAnyYear(n){return["M04","M06","M08","M10","M12"].includes(n)?29:30}estimateIsoDate(n){const{year:l}=n;return{year:l-3760,month:1,day:1}}getMonthCode(n,l){return this.inLeapYear({year:n})?l===6?Bu(5,!0):Bu(l<6?l:l-1):Bu(l)}adjustCalendarDate(n,l,d="constrain",m=!1){let{year:_,month:v,monthCode:c,day:C,monthExtra:R}=n;if(_===void 0)throw new TypeError("Missing property: year");if(m){if(R){const N=this.months[R];if(!N)throw new RangeError(`Unrecognized month from formatToParts: ${R}`);v=this.inLeapYear({year:_})?N.leap:N.regular}return c=this.getMonthCode(_,v),{year:_,month:v,day:C,monthCode:c}}if(this.validateCalendarDate(n),v===void 0)if(c.endsWith("L")){if(c!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${c}`);if(v=6,!this.inLeapYear({year:_})){if(d==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${_} which is not a leap year`);v=6,c="M06"}}else{v=Np(c),this.inLeapYear({year:_})&&v>=6&&v++;const N=this.monthsInYear({year:_});if(v<1||v>N)throw new RangeError(`Invalid monthCode: ${c}`)}else if(d==="reject"?(Pa(v,1,this.monthsInYear({year:_})),Pa(C,1,this.maximumMonthLength({year:_,month:v}))):(v=Ks(v,1,this.monthsInYear({year:_})),C=Ks(C,1,this.maximumMonthLength({year:_,month:v}))),c===void 0)c=this.getMonthCode(_,v);else if(this.getMonthCode(_,v)!==c)throw new RangeError(`monthCode ${c} doesn't correspond to month ${v} in Hebrew year ${_}`);return{...n,day:C,month:v,monthCode:c,year:_}}}class Sg extends Vp{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425}inLeapYear(n,l){const d={year:n.year,month:1,monthCode:"M01",day:1},m={year:n.year+1,month:1,monthCode:"M01",day:1};return this.calendarDaysUntil(d,m,l)===355}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(){return 30}estimateIsoDate(n){const{year:l}=this.adjustCalendarDate(n);return{year:Math.floor(l*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class FR extends Sg{constructor(){super(...arguments),this.id="islamic"}}class UR extends Sg{constructor(){super(...arguments),this.id="islamic-umalqura"}}class VR extends Sg{constructor(){super(...arguments),this.id="islamic-tbla"}}class GR extends Sg{constructor(){super(...arguments),this.id="islamic-civil"}}class ZR extends Sg{constructor(){super(...arguments),this.id="islamic-rgsa"}}class $R extends Sg{constructor(){super(...arguments),this.id="islamicc"}}class YR extends Vp{constructor(){super(...arguments),this.id="persian",this.calendarType="solar"}inLeapYear(n,l){return this.daysInMonth({year:n.year,month:12,day:1},l)===30}monthsInYear(){return 12}minimumMonthLength(n){const{month:l}=n;return l===12?29:l<=6?31:30}maximumMonthLength(n){const{month:l}=n;return l===12?30:l<=6?31:30}maxLengthOfMonthCodeInAnyYear(n){return Np(n)<=6?31:30}estimateIsoDate(n){const{year:l}=this.adjustCalendarDate(n);return{year:l+621,month:1,day:1}}}class qR extends Vp{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(n){return Ux(n.year+78)}monthsInYear(){return 12}minimumMonthLength(n){return this.getMonthInfo(n).length}maximumMonthLength(n){return this.getMonthInfo(n).length}maxLengthOfMonthCodeInAnyYear(n){const l=Np(n);let d=this.months[l];return d=d.leap??d,d.length}getMonthInfo(n){const{month:l}=n;let d=this.months[l];if(d===void 0)throw new RangeError(`Invalid month: ${l}`);return this.inLeapYear(n)&&d.leap&&(d=d.leap),d}estimateIsoDate(n){const l=this.adjustCalendarDate(n),d=this.getMonthInfo(l);return Co(l.year+78+(d.nextYear?1:0),d.month,d.day+l.day-1)}checkIcuBugs(n){if(this.vulnerableToBceBug&&n.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function Ux(i){return i%4==0&&(i%100!=0||i%400==0)}class HS extends Vp{constructor(n,l){super(),this.calendarType="solar",this.id=n,this.isoEpoch=l}inLeapYear(n){const{year:l}=this.estimateIsoDate({month:1,day:1,year:n.year});return Ux(l)}monthsInYear(){return 12}minimumMonthLength(n){const{month:l}=n;return l===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(l)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][Np(n)-1]}estimateIsoDate(n){const l=this.adjustCalendarDate(n);return Yy(l.year+this.isoEpoch.year,l.month+this.isoEpoch.month,l.day+this.isoEpoch.day,"constrain")}}class XS extends Vp{constructor(n,l){super(),this.hasEra=!0,this.calendarType="solar",this.id=n;const{eras:d,anchorEra:m}=function(_){let v,c=_;if(c.length===0)throw new RangeError("Invalid era data: eras are required");if(c.length===1&&c[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(c.length===1&&!c[0].code)throw new RangeError("Invalid era data: at least one named era is required");if(c.filter(R=>R.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");c.forEach(R=>{if(R.isAnchor||!R.anchorEpoch&&!R.reverseOf){if(v)throw new RangeError("Invalid era data: cannot have multiple anchor eras");v=R,R.anchorEpoch={year:R.hasYearZero?0:1}}else if(!R.code)throw new RangeError("If era name is blank, it must be the anchor era")}),c=c.filter(R=>R.code),c.forEach(R=>{const{reverseOf:N}=R;if(N){const B=c.find(V=>V.code===N);if(B===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${N}`);R.reverseOf=B,R.anchorEpoch=B.anchorEpoch,R.isoEpoch=B.isoEpoch}R.anchorEpoch.month===void 0&&(R.anchorEpoch.month=1),R.anchorEpoch.day===void 0&&(R.anchorEpoch.day=1)}),c.sort((R,N)=>{if(R.reverseOf)return 1;if(N.reverseOf)return-1;if(!R.isoEpoch||!N.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return N.isoEpoch.year-R.isoEpoch.year});const C=c[c.length-1].reverseOf;if(C&&C!==c[c.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return c.forEach((R,N)=>{R.genericName="era"+(c.length-1-N)}),{eras:c,anchorEra:v||c[0]}}(l);this.anchorEra=m,this.eras=d}inLeapYear(n){const{year:l}=this.estimateIsoDate({month:1,day:1,year:n.year});return Ux(l)}monthsInYear(){return 12}minimumMonthLength(n){const{month:l}=n;return l===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(l)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}maxLengthOfMonthCodeInAnyYear(n){return[31,29,31,30,31,30,31,31,30,31,30,31][Np(n)-1]}completeEraYear(n){const l=(c,C,R)=>{const N=n[c];if(N!=null&&N!=C&&!(R||[]).includes(N)){const B=R?.[0];throw new RangeError(`Input ${c} ${N} doesn't match calculated value ${B?`${C} (also called ${B})`:C}`)}},d=c=>{let C;const R={...n,year:c},N=this.eras.find((B,V)=>{if(V===this.eras.length-1){if(B.reverseOf){if(c>0)throw new RangeError(`Signed year ${c} is invalid for era ${B.code}`);return C=B.anchorEpoch.year-c,!0}return C=c-B.anchorEpoch.year+(B.hasYearZero?0:1),!0}return this.compareCalendarDates(R,B.anchorEpoch)>=0&&(C=c-B.anchorEpoch.year+(B.hasYearZero?0:1),!0)});if(!N)throw new RangeError(`Year ${c} was not matched by any era`);return{eraYear:C,era:N.code,eraNames:N.names}};let{year:m,eraYear:_,era:v}=n;if(m!=null){const c=d(m);({eraYear:_,era:v}=c),l("era",v,c?.eraNames),l("eraYear",_)}else{if(_==null)throw new RangeError("Either year or eraYear and era are required");{if(v===void 0)throw new RangeError("era and eraYear must be provided together");const c=this.eras.find(({code:C,names:R=[]})=>C===v||R.includes(v));if(!c)throw new RangeError(`Era ${v} (ISO year ${_}) was not matched by any era`);m=c.reverseOf?c.anchorEpoch.year-_:_+c.anchorEpoch.year-(c.hasYearZero?0:1),l("year",m),{eraYear:_,era:v}=d(m)}}return{...n,year:m,eraYear:_,era:v}}adjustCalendarDate(n,l,d="constrain"){let m=n;const{month:_,monthCode:v}=m;return _===void 0&&(m={...m,month:Np(v)}),this.validateCalendarDate(m),m=this.completeEraYear(m),super.adjustCalendarDate(m,l,d)}estimateIsoDate(n){const l=this.adjustCalendarDate(n),{year:d,month:m,day:_}=l,{anchorEra:v}=this;return Yy(d+v.isoEpoch.year-(v.hasYearZero?0:1),m,_,"constrain")}}class Vx extends XS{constructor(n,l){super(n,l)}isoToCalendarDate(n){const{year:l,month:d,day:m}=n,_=Bu(d),v=l-this.anchorEra.isoEpoch.year+1;return this.completeEraYear({year:v,month:d,monthCode:_,day:m})}}const Ru={inLeapYear(i){const{year:n}=i;return(n+1)%4==0},monthsInYear:()=>13,minimumMonthLength(i){const{month:n}=i;return n===13?this.inLeapYear(i)?6:5:30},maximumMonthLength(i){return this.minimumMonthLength(i)},maxLengthOfMonthCodeInAnyYear:i=>i==="M13"?6:30};class HR extends HS{constructor(n,l){super(n,l),this.inLeapYear=Ru.inLeapYear,this.monthsInYear=Ru.monthsInYear,this.minimumMonthLength=Ru.minimumMonthLength,this.maximumMonthLength=Ru.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=Ru.maxLengthOfMonthCodeInAnyYear}}class WS extends XS{constructor(n,l){super(n,l),this.inLeapYear=Ru.inLeapYear,this.monthsInYear=Ru.monthsInYear,this.minimumMonthLength=Ru.minimumMonthLength,this.maximumMonthLength=Ru.maximumMonthLength,this.maxLengthOfMonthCodeInAnyYear=Ru.maxLengthOfMonthCodeInAnyYear}}class XR extends HR{constructor(){super("ethioaa",{year:-5492,month:7,day:17})}}class WR extends WS{constructor(){super("coptic",[{code:"coptic",isoEpoch:{year:284,month:8,day:29}},{code:"coptic-inverse",reverseOf:"coptic"}])}}class QR extends WS{constructor(){super("ethiopic",[{code:"ethioaa",names:["ethiopic-amete-alem","mundi"],isoEpoch:{year:-5492,month:7,day:17}},{code:"ethiopic",names:["incar"],isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class KR extends Vx{constructor(){super("roc",[{code:"roc",names:["minguo"],isoEpoch:{year:1912,month:1,day:1}},{code:"roc-inverse",names:["before-roc"],reverseOf:"roc"}])}}class JR extends HS{constructor(){super("buddhist",{year:-543,month:1,day:1})}}class e3 extends Vx{constructor(){super("gregory",[{code:"gregory",names:["ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"gregory-inverse",names:["be","bce"],reverseOf:"gregory"}])}reviseIntlEra(n){let{era:l,eraYear:d}=n;return l==="b"&&(l="gregory-inverse"),l==="a"&&(l="gregory"),{era:l,eraYear:d}}getFirstDayOfWeek(){return 1}getMinimalDaysInFirstWeek(){return 1}}class t3 extends Vx{constructor(){super("japanese",[{code:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{code:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{code:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{code:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{code:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{code:"japanese",names:["japanese","gregory","ad","ce"],isoEpoch:{year:1,month:1,day:1}},{code:"japanese-inverse",names:["japanese-inverse","gregory-inverse","bc","bce"],reverseOf:"japanese"}]),this.erasBeginMidYear=!0}reviseIntlEra(n,l){const{era:d,eraYear:m}=n,{year:_}=l;return this.eras.find(v=>v.code===d)?{era:d,eraYear:m}:_<1?{era:"japanese-inverse",eraYear:1-_}:{era:"japanese",eraYear:_}}}class QS extends Vp{constructor(){super(...arguments),this.calendarType="lunisolar"}inLeapYear(n,l){const d=this.getMonthList(n.year,l);return Object.entries(d).length===13}monthsInYear(n,l){return this.inLeapYear(n,l)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}maxLengthOfMonthCodeInAnyYear(n){return["M01L","M09L","M10L","M11L","M12L"].includes(n)?29:30}monthDaySearchStartYear(n,l){const d={M01L:[1651,1651],M02L:[1947,1765],M03L:[1966,1955],M04L:[1963,1944],M05L:[1971,1952],M06L:[1960,1941],M07L:[1968,1938],M08L:[1957,1718],M09L:[1832,1832],M10L:[1870,1870],M11L:[1814,1814],M12L:[1890,1890]}[n]??[1972,1972];return l<30?d[0]:d[1]}getMonthList(n,l){if(n===void 0)throw new TypeError("Missing year");const d=JSON.stringify({func:"getMonthList",calendarYear:n,id:this.id}),m=l.get(d);if(m)return m;const _=this.getFormatter(),v=(pe,Ne)=>{const Ve=qS({isoYear:pe,isoMonth:2,isoDay:1}),Fe=new Date(Ve);Fe.setUTCDate(Ne+1);const qe=_.formatToParts(Fe),Ae=qe.find(Pe=>Pe.type==="month").value,Ke=+qe.find(Pe=>Pe.type==="day").value,mt=qe.find(Pe=>Pe.type==="relatedYear");let st;if(mt===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return st=+mt.value,{calendarMonthString:Ae,calendarDay:Ke,calendarYearToVerify:st}};let c=17,{calendarMonthString:C,calendarDay:R,calendarYearToVerify:N}=v(n,c);C!=="1"&&(c+=29,{calendarMonthString:C,calendarDay:R}=v(n,c)),c-=R-5;const B={};let V,G,ae=1,me=!1;do({calendarMonthString:C,calendarDay:R,calendarYearToVerify:N}=v(n,c)),V&&(B[G].daysInMonth=V+30-R),N!==n?me=!0:(B[C]={monthIndex:ae++},c+=30),V=R,G=C;while(!me);return B[G].daysInMonth=V+30-R,l.set(d,B),B}estimateIsoDate(n){const{year:l,month:d}=n;return{year:l,month:d>=12?12:d+1,day:1}}adjustCalendarDate(n,l,d="constrain",m=!1){let{year:_,month:v,monthExtra:c,day:C,monthCode:R}=n;if(_===void 0)throw new TypeError("Missing property: year");if(m){if(c&&c!=="bis")throw new RangeError(`Unexpected leap month suffix: ${c}`);const N=Bu(v,c!==void 0),B=`${v}${c||""}`,V=this.getMonthList(_,l)[B];if(V===void 0)throw new RangeError(`Unmatched month ${B} in Chinese year ${_}`);return v=V.monthIndex,{year:_,month:v,day:C,monthCode:N}}if(this.validateCalendarDate(n),v===void 0){const N=this.getMonthList(_,l);let B=R.replace(/^M|L$/g,G=>G==="L"?"bis":"");B[0]==="0"&&(B=B.slice(1));let V=N[B];if(v=V&&V.monthIndex,v===void 0&&R.endsWith("L")&&R!="M13L"&&d==="constrain"){const G=+R.replace(/^M0?|L$/g,"");V=N[G],V&&(v=V.monthIndex,R=Bu(G))}if(v===void 0)throw new RangeError(`Unmatched month ${R} in Chinese year ${_}`)}else if(R===void 0){const N=this.getMonthList(_,l),B=Object.entries(N),V=B.length;d==="reject"?(Pa(v,1,V),Pa(C,1,this.maximumMonthLength())):(v=Ks(v,1,V),C=Ks(C,1,this.maximumMonthLength()));const G=B.find(ae=>ae[1].monthIndex===v);if(G===void 0)throw new RangeError(`Invalid month ${v} in Chinese year ${_}`);R=Bu(+G[0].replace("bis",""),G[0].indexOf("bis")!==-1)}else{const N=this.getMonthList(_,l);let B=R.replace(/^M|L$/g,G=>G==="L"?"bis":"");B[0]==="0"&&(B=B.slice(1));const V=N[B];if(!V)throw new RangeError(`Unmatched monthCode ${R} in Chinese year ${_}`);if(v!==V.monthIndex)throw new RangeError(`monthCode ${R} doesn't correspond to month ${v} in Chinese year ${_}`)}return{...n,year:_,month:v,monthCode:R,day:C}}}class n3 extends QS{constructor(){super(...arguments),this.id="chinese"}}class i3 extends QS{constructor(){super(...arguments),this.id="dangi"}}class r3{constructor(n){this.helper=n}extraFields(n){return this.helper.hasEra&&n.includes("year")?["era","eraYear"]:[]}resolveFields(n){if(this.helper.calendarType!=="lunisolar"){const l=new Ia;Fx(n,void 0,this.helper.monthsInYear({year:n.year??1972},l))}}dateToISO(n,l){const d=new Ia,m=this.helper.calendarToIsoDate(n,l,d);return d.setObject(m),m}monthDayToISOReferenceDate(n,l){const d=new Ia,m=this.helper.monthDayFromFields(n,l,d);return d.setObject(m),m}fieldKeysToIgnore(n){const l=new Set;for(let d=0;d<n.length;d++){const m=n[d];switch(l.add(m),m){case"era":l.add("eraYear"),l.add("year");break;case"eraYear":l.add("era"),l.add("year");break;case"year":l.add("era"),l.add("eraYear");break;case"month":l.add("monthCode"),this.helper.erasBeginMidYear&&(l.add("era"),l.add("eraYear"));break;case"monthCode":l.add("month"),this.helper.erasBeginMidYear&&(l.add("era"),l.add("eraYear"));break;case"day":this.helper.erasBeginMidYear&&(l.add("era"),l.add("eraYear"))}}return $S(l)}dateAdd(n,{years:l,months:d,weeks:m,days:_},v){const c=Ia.getCacheForObject(n),C=this.helper.isoToCalendarDate(n,c),R=this.helper.addCalendar(C,{years:l,months:d,weeks:m,days:_},v,c),N=this.helper.calendarToIsoDate(R,"constrain",c);return Ia.getCacheForObject(N)||new Ia(c).setObject(N),N}dateUntil(n,l,d){const m=Ia.getCacheForObject(n),_=Ia.getCacheForObject(l),v=this.helper.isoToCalendarDate(n,m),c=this.helper.isoToCalendarDate(l,_);return this.helper.untilCalendar(v,c,d,m)}isoToDate(n,l){const d=Ia.getCacheForObject(n),m=this.helper.isoToCalendarDate(n,d);if(l.dayOfWeek&&(m.dayOfWeek=I_.iso8601.isoToDate(n,{dayOfWeek:!0}).dayOfWeek),l.dayOfYear){const _=this.helper.startOfCalendarYear(m),v=this.helper.calendarDaysUntil(_,m,d);m.dayOfYear=v+1}if(l.weekOfYear&&(m.weekOfYear=YS(this.helper.id,n)),m.daysInWeek=7,l.daysInMonth&&(m.daysInMonth=this.helper.daysInMonth(m,d)),l.daysInYear){const _=this.helper.startOfCalendarYear(m),v=this.helper.addCalendar(_,{years:1},"constrain",d);m.daysInYear=this.helper.calendarDaysUntil(_,v,d)}return l.monthsInYear&&(m.monthsInYear=this.helper.monthsInYear(m,d)),l.inLeapYear&&(m.inLeapYear=this.helper.inLeapYear(m,d)),m}getFirstDayOfWeek(){return this.helper.getFirstDayOfWeek()}getMinimalDaysInFirstWeek(){return this.helper.getMinimalDaysInFirstWeek()}}for(const i of[BR,YR,QR,XR,WR,n3,i3,KR,qR,JR,e3,t3,FR,UR,VR,GR,ZR,$R]){const n=new i;I_[n.id]=new r3(n)}Gb("calendarImpl",function(i){return I_[i]});const l_=Intl.DateTimeFormat;function Gm(i,n){let l=te(i,n);return typeof l=="function"&&(l=new l_(te(i,lS),l(te(i,Bb))),function(d,m,_){const v=_v(d);if(v===void 0)throw new TypeError("Missing slots for the given container");if(v[m]===void 0)throw new TypeError(`tried to reset ${m} which was not set`);v[m]=_}(i,n,l)),l}function Ay(i){return no(i,Fp)}class c_{constructor(n=void 0,l=void 0){(function(d,m,_){const v=_!==void 0;let c;if(v){const B=["localeMatcher","calendar","numberingSystem","hour12","hourCycle","timeZone","weekday","era","year","month","day","dayPeriod","hour","minute","second","fractionalSecondDigits","timeZoneName","formatMatcher","dateStyle","timeStyle"];c=function(G){if(G==null)throw new TypeError(`Expected object not ${G}`);return Object(G)}(_);const V=Object.create(null);for(let G=0;G<B.length;G++){const ae=B[G];Object.prototype.hasOwnProperty.call(c,ae)&&(V[ae]=c[ae])}c=V}else c=Object.create(null);const C=new l_(m,c),R=C.resolvedOptions();if(dd(d),v){const B=Object.assign(Object.create(null),R);for(const V in B)Object.prototype.hasOwnProperty.call(c,V)||delete B[V];B.hour12=c.hour12,B.hourCycle=c.hourCycle,In(d,Bb,B)}else In(d,Bb,c);In(d,lS,R.locale),In(d,Fp,C),In(d,Ym,R.timeZone),In(d,Ry,R.calendar),In(d,nS,f3),In(d,iS,h3),In(d,rS,d3),In(d,aS,u3),In(d,sS,p3),In(d,oS,m3);const N=v?c.timeZone:void 0;if(N===void 0)In(d,jb,R.timeZone);else{const B=wv(N);if(B.startsWith(""))throw new RangeError("Unicode minus (U+2212) is not supported in time zone offsets");In(d,jb,eo(B))}})(this,n,l)}get format(){et(this,Ay);const n=s3.bind(this);return Object.defineProperties(n,{length:{value:1,enumerable:!1,writable:!1,configurable:!0},name:{value:"",enumerable:!1,writable:!1,configurable:!0}}),n}formatRange(n,l){return et(this,Ay),l3.call(this,n,l)}formatToParts(n,...l){return et(this,Ay),o3.call(this,n,...l)}formatRangeToParts(n,l){return et(this,Ay),c3.call(this,n,l)}resolvedOptions(){return et(this,Ay),a3.call(this)}}"formatToParts"in l_.prototype||delete c_.prototype.formatToParts,"formatRangeToParts"in l_.prototype||delete c_.prototype.formatRangeToParts;const Zl=function(i=void 0,n=void 0){return new c_(i,n)};function a3(){const i=te(this,Fp).resolvedOptions();return i.timeZone=te(this,jb),i}function s3(i,...n){let l,d,m=dg(i,this);return m.formatter?(l=m.formatter,d=[Xl(m.epochNs,"floor")]):(l=te(this,Fp),d=[i,...n]),l.format(...d)}function o3(i,...n){let l,d,m=dg(i,this);return m.formatter?(l=m.formatter,d=[Xl(m.epochNs,"floor")]):(l=te(this,Fp),d=[i,...n]),l.formatToParts(...d)}function l3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const l=av(i),d=av(n);let m,_=[l,d];if(ad(l)!==ad(d))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");if(ad(l)){if(!KS(l,d))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{epochNs:v,formatter:c}=dg(l,this),{epochNs:C,formatter:R}=dg(d,this);c&&(m=c,_=[Xl(v,"floor"),Xl(C,"floor")])}return m||(m=te(this,Fp)),m.formatRange(..._)}function c3(i,n){if(i===void 0||n===void 0)throw new TypeError("Intl.DateTimeFormat.formatRange requires two values");const l=av(i),d=av(n);let m,_=[l,d];if(ad(l)!==ad(d))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");if(ad(l)){if(!KS(l,d))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{epochNs:v,formatter:c}=dg(l,this),{epochNs:C,formatter:R}=dg(d,this);c&&(m=c,_=[Xl(v,"floor"),Xl(C,"floor")])}return m||(m=te(this,Fp)),m.formatRangeToParts(..._)}function R_(i={},n={}){const l=Object.assign({},i),d=["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"];for(let m=0;m<d.length;m++){const _=d[m];l[_]=_ in n?n[_]:l[_],l[_]!==!1&&l[_]!==void 0||delete l[_]}return l}function u3(i){const n=R_(i,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});if(n.timeStyle!=="long"&&n.timeStyle!=="full"||(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"})),!Iv(n)){if(P_(i))throw new TypeError(`cannot format Temporal.PlainTime with options [${Object.keys(i)}]`);Object.assign(n,{hour:"numeric",minute:"numeric",second:"numeric"})}return n}function h3(i){const n={short:{year:"2-digit",month:"numeric"},medium:{year:"numeric",month:"short"},long:{year:"numeric",month:"long"},full:{year:"numeric",month:"long"}},l=R_(i,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in l&&l.dateStyle){const d=l.dateStyle;delete l.dateStyle,Object.assign(l,n[d])}if(!("year"in l||"month"in l||"era"in l)){if(P_(i))throw new TypeError(`cannot format PlainYearMonth with options [${Object.keys(i)}]`);Object.assign(l,{year:"numeric",month:"numeric"})}return l}function d3(i){const n={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric"},long:{month:"long",day:"numeric"},full:{month:"long",day:"numeric"}},l=R_(i,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if("dateStyle"in l&&l.dateStyle){const d=l.dateStyle;delete l.dateStyle,Object.assign(l,n[d])}if(!("month"in l)&&!("day"in l)){if(P_(i))throw new TypeError(`cannot format PlainMonthDay with options [${Object.keys(i)}]`);Object.assign(l,{month:"numeric",day:"numeric"})}return l}function f3(i){const n=R_(i,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});if(!kv(n)){if(P_(i))throw new TypeError(`cannot format PlainDate with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric"})}return n}function p3(i){const n=R_(i,{timeZoneName:!1});if((n.timeStyle==="long"||n.timeStyle==="full")&&(delete n.timeStyle,Object.assign(n,{hour:"numeric",minute:"2-digit",second:"2-digit"}),n.dateStyle)&&(Object.assign(n,{short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"long",day:"numeric"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long"}}[n.dateStyle]),delete n.dateStyle),!Iv(n)&&!kv(n)){if(P_(i))throw new TypeError(`cannot format PlainDateTime with options [${Object.keys(i)}]`);Object.assign(n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}return n}function m3(i){let n=i;return Iv(n)||kv(n)||(n=Object.assign({},n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),n}function kv(i){return"year"in i||"month"in i||"day"in i||"weekday"in i||"dateStyle"in i||"era"in i}function Iv(i){return"hour"in i||"minute"in i||"second"in i||"timeStyle"in i||"dayPeriod"in i||"fractionalSecondDigits"in i}function P_(i){return kv(i)||Iv(i)||"dateStyle"in i||"timeStyle"in i||"timeZoneName"in i}function ad(i){return Sr(i)||Ir(i)||ir(i)||On(i)||Ha(i)||tl(i)||qa(i)}function av(i){return ad(i)?i:xv(i)}function KS(i,n){return!(!ad(i)||!ad(n)||Ir(i)&&!Ir(n)||Sr(i)&&!Sr(n)||ir(i)&&!ir(n)||On(i)&&!On(n)||Ha(i)&&!Ha(n)||tl(i)&&!tl(n)||qa(i)&&!qa(n))}function dg(i,n){if(Ir(i)){const l={isoDate:{year:1970,month:1,day:1},time:te(i,Er)};return{epochNs:bs(te(n,Ym),l,"compatible"),formatter:Gm(n,aS)}}if(Ha(i)){const l=te(i,At),d=te(n,Ry);if(l!==d)throw new RangeError(`cannot format PlainYearMonth with calendar ${l} in locale with calendar ${d}`);const m=oi(te(i,vn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:bs(te(n,Ym),m,"compatible"),formatter:Gm(n,iS)}}if(tl(i)){const l=te(i,At),d=te(n,Ry);if(l!==d)throw new RangeError(`cannot format PlainMonthDay with calendar ${l} in locale with calendar ${d}`);const m=oi(te(i,vn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:bs(te(n,Ym),m,"compatible"),formatter:Gm(n,rS)}}if(Sr(i)){const l=te(i,At),d=te(n,Ry);if(l!=="iso8601"&&l!==d)throw new RangeError(`cannot format PlainDate with calendar ${l} in locale with calendar ${d}`);const m=oi(te(i,vn),{deltaDays:0,hour:12,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0});return{epochNs:bs(te(n,Ym),m,"compatible"),formatter:Gm(n,nS)}}if(ir(i)){const l=te(i,At),d=te(n,Ry);if(l!=="iso8601"&&l!==d)throw new RangeError(`cannot format PlainDateTime with calendar ${l} in locale with calendar ${d}`);const m=te(i,cr);return{epochNs:bs(te(n,Ym),m,"compatible"),formatter:Gm(n,sS)}}if(On(i))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return qa(i)?{epochNs:te(i,_n),formatter:Gm(n,oS)}:{}}function JS(i){const n=Object.create(null);return n.years=te(i,Zs),n.months=te(i,$s),n.weeks=te(i,wo),n.days=te(i,Ys),n.hours=te(i,qs),n.minutes=te(i,Hs),n.seconds=te(i,Xs),n.milliseconds=te(i,Ws),n.microseconds=te(i,Qs),n.nanoseconds=te(i,To),n}c_.prototype.constructor=Zl,Object.defineProperty(Zl,"prototype",{value:c_.prototype,writable:!1,enumerable:!1,configurable:!1}),Zl.supportedLocalesOf=l_.supportedLocalesOf,fd(Zl,"Intl.DateTimeFormat");const{format:g3,formatToParts:y3}=Intl.DurationFormat?.prototype??Object.create(null);function eE(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=JS($l(i));return g3.call(this,n)}Intl.DurationFormat?.prototype&&(Intl.DurationFormat.prototype.format=eE,Intl.DurationFormat.prototype.formatToParts=function(i){Intl.DurationFormat.prototype.resolvedOptions.call(this);const n=JS($l(i));return y3.call(this,n)});class Gx{constructor(n){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");MS(this,rv(n))}get epochMilliseconds(){return et(this,qa),Xl(te(this,_n),"floor")}get epochNanoseconds(){return et(this,qa),GS(W.BigInt(te(this,_n)))}add(n){return et(this,qa),Vw("add",this,n)}subtract(n){return et(this,qa),Vw("subtract",this,n)}until(n,l=void 0){return et(this,qa),Nw("until",this,n,l)}since(n,l=void 0){return et(this,qa),Nw("since",this,n,l)}round(n){if(et(this,qa),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?zp("smallestUnit",n):Qt(n),d=bg(l),m=Fc(l,"halfExpand"),_=Eo(l,"smallestUnit","time",cd);return xg(d,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[_],!0),zu(Jb(te(this,_n),d,_,m))}equals(n){et(this,qa);const l=Ny(n),d=te(this,_n),m=te(l,_n);return W.equal(W.BigInt(d),W.BigInt(m))}toString(n=void 0){et(this,qa);const l=Qt(n),d=T_(l),m=Fc(l,"trunc"),_=Eo(l,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let v=l.timeZone;v!==void 0&&(v=eo(v));const{precision:c,unit:C,increment:R}=S_(_,d);return Aw(zu(Jb(te(this,_n),R,C,m)),v,c)}toJSON(){return et(this,qa),Aw(this,void 0,"auto")}toLocaleString(n=void 0,l=void 0){return et(this,qa),new Zl(n,l).format(this)}valueOf(){xf("Instant")}toZonedDateTimeISO(n){et(this,qa);const l=eo(n);return _s(te(this,_n),l,"iso8601")}static fromEpochMilliseconds(n){return zu(Lu(xv(n)))}static fromEpochNanoseconds(n){return zu(rv(n))}static from(n){return Ny(n)}static compare(n,l){const d=Ny(n),m=Ny(l),_=te(d,_n),v=te(m,_n);return W.lessThan(_,v)?-1:W.greaterThan(_,v)?1:0}}fd(Gx,"Temporal.Instant");class Zx{constructor(n,l,d,m="iso8601"){const _=Sn(n),v=Sn(l),c=Sn(d),C=io(m===void 0?"iso8601":Sa(m));Ip(_,v,c),wS(this,{year:_,month:v,day:c},C)}get calendarId(){return et(this,Sr),te(this,At)}get era(){return Fs(this,"era")}get eraYear(){return Fs(this,"eraYear")}get year(){return Fs(this,"year")}get month(){return Fs(this,"month")}get monthCode(){return Fs(this,"monthCode")}get day(){return Fs(this,"day")}get dayOfWeek(){return Fs(this,"dayOfWeek")}get dayOfYear(){return Fs(this,"dayOfYear")}get weekOfYear(){return Fs(this,"weekOfYear")?.week}get yearOfWeek(){return Fs(this,"weekOfYear")?.year}get daysInWeek(){return Fs(this,"daysInWeek")}get daysInMonth(){return Fs(this,"daysInMonth")}get daysInYear(){return Fs(this,"daysInYear")}get monthsInYear(){return Fs(this,"monthsInYear")}get inLeapYear(){return Fs(this,"inLeapYear")}with(n,l=void 0){if(et(this,Sr),!Ar(n))throw new TypeError("invalid argument");vg(n);const d=te(this,At);let m=to(d,te(this,vn));return m=kp(d,m,ll(d,n,["year","month","monthCode","day"],[],"partial")),Js(gf(d,m,ni(Qt(l))),d)}withCalendar(n){et(this,Sr);const l=C_(n);return Js(te(this,vn),l)}add(n,l=void 0){return et(this,Sr),Gw("add",this,n,l)}subtract(n,l=void 0){return et(this,Sr),Gw("subtract",this,n,l)}until(n,l=void 0){return et(this,Sr),Lw("until",this,n,l)}since(n,l=void 0){return et(this,Sr),Lw("since",this,n,l)}equals(n){et(this,Sr);const l=Py(n);return Vu(te(this,vn),te(l,vn))===0&&Fu(te(this,At),te(l,At))}toString(n=void 0){return et(this,Sr),Mw(this,w_(Qt(n)))}toJSON(){return et(this,Sr),Mw(this)}toLocaleString(n=void 0,l=void 0){return et(this,Sr),new Zl(n,l).format(this)}valueOf(){xf("PlainDate")}toPlainDateTime(n=void 0){et(this,Sr);const l=xS(n);return Vl(oi(te(this,vn),l),te(this,At))}toZonedDateTime(n){let l,d;if(et(this,Sr),Ar(n)){const v=n.timeZone;v===void 0?l=eo(n):(l=eo(v),d=n.plainTime)}else l=eo(n);const m=te(this,vn);let _;return d===void 0?_=sf(l,m):(d=lf(d),_=bs(l,oi(m,te(d,Er)),"compatible")),_s(_,l,te(this,At))}toPlainYearMonth(){et(this,Sr);const n=te(this,At);return Km(i_(n,to(n,te(this,vn)),"constrain"),n)}toPlainMonthDay(){et(this,Sr);const n=te(this,At);return Xm(J0(n,to(n,te(this,vn)),"constrain"),n)}static from(n,l=void 0){return Py(n,l)}static compare(n,l){const d=Py(n),m=Py(l);return Vu(te(d,vn),te(m,vn))}}function Fs(i,n){et(i,Sr);const l=te(i,vn);return E_(i).isoToDate(l,{[n]:!0})[n]}fd(Zx,"Temporal.PlainDate");class $x{constructor(n,l,d,m=0,_=0,v=0,c=0,C=0,R=0,N="iso8601"){const B=Sn(n),V=Sn(l),G=Sn(d),ae=m===void 0?0:Sn(m),me=_===void 0?0:Sn(_),pe=v===void 0?0:Sn(v),Ne=c===void 0?0:Sn(c),Ve=C===void 0?0:Sn(C),Fe=R===void 0?0:Sn(R),qe=io(N===void 0?"iso8601":Sa(N));Lx(B,V,G,ae,me,pe,Ne,Ve,Fe),TS(this,{isoDate:{year:B,month:V,day:G},time:{hour:ae,minute:me,second:pe,millisecond:Ne,microsecond:Ve,nanosecond:Fe}},qe)}get calendarId(){return et(this,ir),te(this,At)}get year(){return Us(this,"year")}get month(){return Us(this,"month")}get monthCode(){return Us(this,"monthCode")}get day(){return Us(this,"day")}get hour(){return Zm(this,"hour")}get minute(){return Zm(this,"minute")}get second(){return Zm(this,"second")}get millisecond(){return Zm(this,"millisecond")}get microsecond(){return Zm(this,"microsecond")}get nanosecond(){return Zm(this,"nanosecond")}get era(){return Us(this,"era")}get eraYear(){return Us(this,"eraYear")}get dayOfWeek(){return Us(this,"dayOfWeek")}get dayOfYear(){return Us(this,"dayOfYear")}get weekOfYear(){return Us(this,"weekOfYear")?.week}get yearOfWeek(){return Us(this,"weekOfYear")?.year}get daysInWeek(){return Us(this,"daysInWeek")}get daysInYear(){return Us(this,"daysInYear")}get daysInMonth(){return Us(this,"daysInMonth")}get monthsInYear(){return Us(this,"monthsInYear")}get inLeapYear(){return Us(this,"inLeapYear")}with(n,l=void 0){if(et(this,ir),!Ar(n))throw new TypeError("invalid argument");vg(n);const d=te(this,At),m=te(this,cr);let _={...to(d,m.isoDate),...m.time};return _=kp(d,_,ll(d,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond"],"partial")),Vl(A_(d,_,ni(Qt(l))),d)}withPlainTime(n=void 0){et(this,ir);const l=xS(n);return Vl(oi(te(this,cr).isoDate,l),te(this,At))}withCalendar(n){et(this,ir);const l=C_(n);return Vl(te(this,cr),l)}add(n,l=void 0){return et(this,ir),Zw("add",this,n,l)}subtract(n,l=void 0){return et(this,ir),Zw("subtract",this,n,l)}until(n,l=void 0){return et(this,ir),Ow("until",this,n,l)}since(n,l=void 0){return et(this,ir),Ow("since",this,n,l)}round(n){if(et(this,ir),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?zp("smallestUnit",n):Qt(n),d=bg(l),m=Fc(l,"halfExpand"),_=Eo(l,"smallestUnit","time",cd,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];xg(d,v,v===1);const c=te(this,cr);return Vl(d===1&&_==="nanosecond"?c:ex(c,d,_,m),te(this,At))}equals(n){et(this,ir);const l=zy(n);return hg(te(this,cr),te(l,cr))===0&&Fu(te(this,At),te(l,At))}toString(n=void 0){et(this,ir);const l=Qt(n),d=w_(l),m=T_(l),_=Fc(l,"trunc"),v=Eo(l,"smallestUnit","time",void 0);if(v==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:c,unit:C,increment:R}=S_(v,m),N=ex(te(this,cr),R,C,_);return Rp(N),a_(N,te(this,At),c,d)}toJSON(){return et(this,ir),a_(te(this,cr),te(this,At),"auto")}toLocaleString(n=void 0,l=void 0){return et(this,ir),new Zl(n,l).format(this)}valueOf(){xf("PlainDateTime")}toZonedDateTime(n,l=void 0){et(this,ir);const d=eo(n),m=qy(Qt(l));return _s(bs(d,te(this,cr),m),d,te(this,At))}toPlainDate(){return et(this,ir),Js(te(this,cr).isoDate,te(this,At))}toPlainTime(){return et(this,ir),Wh(te(this,cr).time)}static from(n,l=void 0){return zy(n,l)}static compare(n,l){const d=zy(n),m=zy(l);return hg(te(d,cr),te(m,cr))}}function Us(i,n){et(i,ir);const l=te(i,cr).isoDate;return E_(i).isoToDate(l,{[n]:!0})[n]}function Zm(i,n){return et(i,ir),te(i,cr).time[n]}fd($x,"Temporal.PlainDateTime");class fg{constructor(n=0,l=0,d=0,m=0,_=0,v=0,c=0,C=0,R=0,N=0){const B=n===void 0?0:Lc(n),V=l===void 0?0:Lc(l),G=d===void 0?0:Lc(d),ae=m===void 0?0:Lc(m),me=_===void 0?0:Lc(_),pe=v===void 0?0:Lc(v),Ne=c===void 0?0:Lc(c),Ve=C===void 0?0:Lc(C),Fe=R===void 0?0:Lc(R),qe=N===void 0?0:Lc(N);Cv(B,V,G,ae,me,pe,Ne,Ve,Fe,qe),dd(this),In(this,Zs,B),In(this,$s,V),In(this,wo,G),In(this,Ys,ae),In(this,qs,me),In(this,Hs,pe),In(this,Xs,Ne),In(this,Ws,Ve),In(this,Qs,Fe),In(this,To,qe)}get years(){return et(this,Tr),te(this,Zs)}get months(){return et(this,Tr),te(this,$s)}get weeks(){return et(this,Tr),te(this,wo)}get days(){return et(this,Tr),te(this,Ys)}get hours(){return et(this,Tr),te(this,qs)}get minutes(){return et(this,Tr),te(this,Hs)}get seconds(){return et(this,Tr),te(this,Xs)}get milliseconds(){return et(this,Tr),te(this,Ws)}get microseconds(){return et(this,Tr),te(this,Qs)}get nanoseconds(){return et(this,Tr),te(this,To)}get sign(){return et(this,Tr),nv(this)}get blank(){return et(this,Tr),nv(this)===0}with(n){et(this,Tr);const l=bS(n),{years:d=te(this,Zs),months:m=te(this,$s),weeks:_=te(this,wo),days:v=te(this,Ys),hours:c=te(this,qs),minutes:C=te(this,Hs),seconds:R=te(this,Xs),milliseconds:N=te(this,Ws),microseconds:B=te(this,Qs),nanoseconds:V=te(this,To)}=l;return new fg(d,m,_,v,c,C,R,N,B,V)}negated(){return et(this,Tr),Do(this)}abs(){return et(this,Tr),new fg(Math.abs(te(this,Zs)),Math.abs(te(this,$s)),Math.abs(te(this,wo)),Math.abs(te(this,Ys)),Math.abs(te(this,qs)),Math.abs(te(this,Hs)),Math.abs(te(this,Xs)),Math.abs(te(this,Ws)),Math.abs(te(this,Qs)),Math.abs(te(this,To)))}add(n){return et(this,Tr),Uw("add",this,n)}subtract(n){return et(this,Tr),Uw("subtract",this,n)}round(n){if(et(this,Tr),n===void 0)throw new TypeError("options parameter is required");const l=Yh(this),d=typeof n=="string"?zp("smallestUnit",n):Qt(n);let m=Eo(d,"largestUnit","datetime",void 0,["auto"]),{plainRelativeTo:_,zonedRelativeTo:v}=pb(d);const c=bg(d),C=Fc(d,"halfExpand");let R=Eo(d,"smallestUnit","datetime",void 0),N=!0;R||(N=!1,R="nanosecond");const B=nd(l,R);let V=!0;if(m||(V=!1,m=B),m==="auto"&&(m=B),!N&&!V)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(nd(m,R)!==m)throw new RangeError(`largestUnit ${m} cannot be smaller than smallestUnit ${R}`);const G={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[R];if(G!==void 0&&xg(c,G,!1),c>1&&qh(R)==="date"&&m!==R)throw new RangeError("For calendar units with roundingIncrement > 1, use largestUnit = smallestUnit");if(v){let me=qm(this);const pe=te(v,fi),Ne=te(v,At),Ve=te(v,_n);return me=VS(Ve,jy(Ve,pe,Ne,me),pe,Ne,m,c,R,C),qh(m)==="date"&&(m="hour"),Gl(me,m)}if(_){let me=Nu(this);const pe=ug({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},me.time),Ne=te(_,vn),Ve=te(_,At),Fe=rl(Ve,Ne,vs(me.date,pe.deltaDays),"constrain");return me=US(oi(Ne,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),oi(Fe,pe),Ve,m,c,R,C),Gl(me,m)}if(ku(l))throw new RangeError(`a starting point is required for ${l}s balancing`);if(ku(m))throw new RangeError(`a starting point is required for ${m}s balancing`);let ae=Nu(this);if(R==="day"){const{quotient:me,remainder:pe}=ae.time.divmod(W0);let Ne=ae.date.days+me+Hy(pe,"day");Ne=cf(Ne,c,C),ae=id({years:0,months:0,weeks:0,days:Ne},jn.ZERO)}else ae=id({years:0,months:0,weeks:0,days:0},iv(ae.time,c,R,C));return Gl(ae,m)}total(n){if(et(this,Tr),n===void 0)throw new TypeError("options argument is required");const l=typeof n=="string"?zp("unit",n):Qt(n);let{plainRelativeTo:d,zonedRelativeTo:m}=pb(l);const _=Eo(l,"unit","datetime",cd);if(m){const c=qm(this),C=te(m,fi),R=te(m,At),N=te(m,_n);return function(B,V,G,ae,me){return qh(me)==="time"?Hy(jn.fromEpochNsDiff(V,B),me):zw(BS(B,V,G,ae,me),V,Hl(G,B),G,ae,me)}(N,jy(N,C,R,c),C,R,_)}if(d){const c=Nu(this);let C=ug({hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0},c.time);const R=te(d,vn),N=te(d,At),B=rl(N,R,vs(c.date,C.deltaDays),"constrain");return function(V,G,ae,me){if(hg(V,G)==0)return 0;Rp(V),Rp(G);const pe=jS(V,G,ae,me);return me==="nanosecond"?W.toNumber(pe.time.totalNs):zw(pe,Xa(G),V,null,ae,me)}(oi(R,{deltaDays:0,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0}),oi(B,C),N,_)}const v=Yh(this);if(ku(v))throw new RangeError(`a starting point is required for ${v}s total`);if(ku(_))throw new RangeError(`a starting point is required for ${_}s total`);return Hy(Nu(this).time,_)}toString(n=void 0){et(this,Tr);const l=Qt(n),d=T_(l),m=Fc(l,"trunc"),_=Eo(l,"smallestUnit","time",void 0);if(_==="hour"||_==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:v,unit:c,increment:C}=S_(_,d);if(c==="nanosecond"&&C===1)return P0(this,v);const R=Yh(this);let N=qm(this);const B=iv(N.time,C,c,m);return N=id(N.date,B),P0(Gl(N,nd(R,"second")),v)}toJSON(){return et(this,Tr),P0(this,"auto")}toLocaleString(n=void 0,l=void 0){if(et(this,Tr),typeof Intl.DurationFormat=="function"){const d=new Intl.DurationFormat(n,l);return eE.call(d,this)}return console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),P0(this,"auto")}valueOf(){xf("Duration")}static from(n){return $l(n)}static compare(n,l,d=void 0){const m=$l(n),_=$l(l),v=Qt(d),{plainRelativeTo:c,zonedRelativeTo:C}=pb(v);if(te(m,Zs)===te(_,Zs)&&te(m,$s)===te(_,$s)&&te(m,wo)===te(_,wo)&&te(m,Ys)===te(_,Ys)&&te(m,qs)===te(_,qs)&&te(m,Hs)===te(_,Hs)&&te(m,Xs)===te(_,Xs)&&te(m,Ws)===te(_,Ws)&&te(m,Qs)===te(_,Qs)&&te(m,To)===te(_,To))return 0;const R=Yh(m),N=Yh(_),B=qm(m),V=qm(_);if(C&&(qh(R)==="date"||qh(N)==="date")){const Ne=te(C,fi),Ve=te(C,At),Fe=te(C,_n),qe=jy(Fe,Ne,Ve,B),Ae=jy(Fe,Ne,Ve,V);return So(W.toNumber(W.subtract(qe,Ae)))}let G=B.date.days,ae=V.date.days;if(ku(R)||ku(N)){if(!c)throw new RangeError("A starting point is required for years, months, or weeks comparison");G=Pw(B.date,c),ae=Pw(V.date,c)}const me=B.time.add24HourDays(G),pe=V.time.add24HourDays(ae);return me.cmp(pe)}}fd(fg,"Temporal.Duration");class Yx{constructor(n,l,d="iso8601",m=1972){const _=Sn(n),v=Sn(l),c=io(d===void 0?"iso8601":Sa(d)),C=Sn(m);Ip(C,_,v),SS(this,{year:C,month:_,day:v},c)}get monthCode(){return Xw(this,"monthCode")}get day(){return Xw(this,"day")}get calendarId(){return et(this,tl),te(this,At)}with(n,l=void 0){if(et(this,tl),!Ar(n))throw new TypeError("invalid argument");vg(n);const d=te(this,At);let m=to(d,te(this,vn),"month-day");return m=kp(d,m,ll(d,n,["year","month","monthCode","day"],[],"partial")),Xm(J0(d,m,ni(Qt(l))),d)}equals(n){et(this,tl);const l=Sw(n);return Vu(te(this,vn),te(l,vn))===0&&Fu(te(this,At),te(l,At))}toString(n=void 0){return et(this,tl),Dw(this,w_(Qt(n)))}toJSON(){return et(this,tl),Dw(this)}toLocaleString(n=void 0,l=void 0){return et(this,tl),new Zl(n,l).format(this)}valueOf(){xf("PlainMonthDay")}toPlainDate(n){if(et(this,tl),!Ar(n))throw new TypeError("argument should be an object");const l=te(this,At);return Js(gf(l,kp(l,to(l,te(this,vn),"month-day"),ll(l,n,["year"],[],[])),"constrain"),l)}static from(n,l=void 0){return Sw(n,l)}}function Xw(i,n){et(i,tl);const l=te(i,vn);return E_(i).isoToDate(l,{[n]:!0})[n]}function gb(i){return Hl(i,ix())}fd(Yx,"Temporal.PlainMonthDay");const tE={instant:()=>zu(ix()),plainDateTimeISO:(i=Ey())=>Vl(gb(eo(i)),"iso8601"),plainDateISO:(i=Ey())=>Js(gb(eo(i)).isoDate,"iso8601"),plainTimeISO:(i=Ey())=>Wh(gb(eo(i)).time),timeZoneId:()=>Ey(),zonedDateTimeISO:(i=Ey())=>{const n=eo(i);return _s(ix(),n,"iso8601")},[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(tE,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});class z_{constructor(n=0,l=0,d=0,m=0,_=0,v=0){const c=n===void 0?0:Sn(n),C=l===void 0?0:Sn(l),R=d===void 0?0:Sn(d),N=m===void 0?0:Sn(m),B=_===void 0?0:Sn(_),V=v===void 0?0:Sn(v);Mv(c,C,R,N,B,V),ES(this,{hour:c,minute:C,second:R,millisecond:N,microsecond:B,nanosecond:V})}get hour(){return et(this,Ir),te(this,Er).hour}get minute(){return et(this,Ir),te(this,Er).minute}get second(){return et(this,Ir),te(this,Er).second}get millisecond(){return et(this,Ir),te(this,Er).millisecond}get microsecond(){return et(this,Ir),te(this,Er).microsecond}get nanosecond(){return et(this,Ir),te(this,Er).nanosecond}with(n,l=void 0){if(et(this,Ir),!Ar(n))throw new TypeError("invalid argument");vg(n);const d=qb(n,"partial"),m=qb(this);let{hour:_,minute:v,second:c,millisecond:C,microsecond:R,nanosecond:N}=Object.assign(m,d);const B=ni(Qt(l));return{hour:_,minute:v,second:c,millisecond:C,microsecond:R,nanosecond:N}=Sv(_,v,c,C,R,N,B),new z_(_,v,c,C,R,N)}add(n){return et(this,Ir),$w("add",this,n)}subtract(n){return et(this,Ir),$w("subtract",this,n)}until(n,l=void 0){return et(this,Ir),jw("until",this,n,l)}since(n,l=void 0){return et(this,Ir),jw("since",this,n,l)}round(n){if(et(this,Ir),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?zp("smallestUnit",n):Qt(n),d=bg(l),m=Fc(l,"halfExpand"),_=Eo(l,"smallestUnit","time",cd);return xg(d,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_],!1),Wh(tx(te(this,Er),d,_,m))}equals(n){et(this,Ir);const l=lf(n);return nx(te(this,Er),te(l,Er))===0}toString(n=void 0){et(this,Ir);const l=Qt(n),d=T_(l),m=Fc(l,"trunc"),_=Eo(l,"smallestUnit","time",void 0);if(_==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:v,unit:c,increment:C}=S_(_,d);return Cw(tx(te(this,Er),C,c,m),v)}toJSON(){return et(this,Ir),Cw(te(this,Er),"auto")}toLocaleString(n=void 0,l=void 0){return et(this,Ir),new Zl(n,l).format(this)}valueOf(){xf("PlainTime")}static from(n,l=void 0){return lf(n,l)}static compare(n,l){const d=lf(n),m=lf(l);return nx(te(d,Er),te(m,Er))}}fd(z_,"Temporal.PlainTime");class qx{constructor(n,l,d="iso8601",m=1){const _=Sn(n),v=Sn(l),c=io(d===void 0?"iso8601":Sa(d)),C=Sn(m);Ip(_,v,C),AS(this,{year:_,month:v,day:C},c)}get year(){return Gh(this,"year")}get month(){return Gh(this,"month")}get monthCode(){return Gh(this,"monthCode")}get calendarId(){return et(this,Ha),te(this,At)}get era(){return Gh(this,"era")}get eraYear(){return Gh(this,"eraYear")}get daysInMonth(){return Gh(this,"daysInMonth")}get daysInYear(){return Gh(this,"daysInYear")}get monthsInYear(){return Gh(this,"monthsInYear")}get inLeapYear(){return Gh(this,"inLeapYear")}with(n,l=void 0){if(et(this,Ha),!Ar(n))throw new TypeError("invalid argument");vg(n);const d=te(this,At);let m=to(d,te(this,vn),"year-month");return m=kp(d,m,ll(d,n,["year","month","monthCode"],[],"partial")),Km(i_(d,m,ni(Qt(l))),d)}add(n,l=void 0){return et(this,Ha),Yw("add",this,n,l)}subtract(n,l=void 0){return et(this,Ha),Yw("subtract",this,n,l)}until(n,l=void 0){return et(this,Ha),Bw("until",this,n,l)}since(n,l=void 0){return et(this,Ha),Bw("since",this,n,l)}equals(n){et(this,Ha);const l=Ly(n);return Vu(te(this,vn),te(l,vn))===0&&Fu(te(this,At),te(l,At))}toString(n=void 0){return et(this,Ha),kw(this,w_(Qt(n)))}toJSON(){return et(this,Ha),kw(this)}toLocaleString(n=void 0,l=void 0){return et(this,Ha),new Zl(n,l).format(this)}valueOf(){xf("PlainYearMonth")}toPlainDate(n){if(et(this,Ha),!Ar(n))throw new TypeError("argument should be an object");const l=te(this,At);return Js(gf(l,kp(l,to(l,te(this,vn),"year-month"),ll(l,n,["day"],[],[])),"constrain"),l)}static from(n,l=void 0){return Ly(n,l)}static compare(n,l){const d=Ly(n),m=Ly(l);return Vu(te(d,vn),te(m,vn))}}function Gh(i,n){et(i,Ha);const l=te(i,vn);return E_(i).isoToDate(l,{[n]:!0})[n]}fd(qx,"Temporal.PlainYearMonth");const _3=Zl.prototype.resolvedOptions;class Hx{constructor(n,l,d="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const m=rv(n);let _=Sa(l);const{tzName:v,offsetMinutes:c}=hf(_);if(c===void 0){const C=ev(v);if(!C)throw new RangeError(`unknown time zone ${v}`);_=C.identifier}else _=Px(c);CS(this,m,_,io(d===void 0?"iso8601":Sa(d)))}get calendarId(){return et(this,On),te(this,At)}get timeZoneId(){return et(this,On),te(this,fi)}get year(){return Vs(this,"year")}get month(){return Vs(this,"month")}get monthCode(){return Vs(this,"monthCode")}get day(){return Vs(this,"day")}get hour(){return $m(this,"hour")}get minute(){return $m(this,"minute")}get second(){return $m(this,"second")}get millisecond(){return $m(this,"millisecond")}get microsecond(){return $m(this,"microsecond")}get nanosecond(){return $m(this,"nanosecond")}get era(){return Vs(this,"era")}get eraYear(){return Vs(this,"eraYear")}get epochMilliseconds(){return et(this,On),Xl(te(this,_n),"floor")}get epochNanoseconds(){return et(this,On),GS(te(this,_n))}get dayOfWeek(){return Vs(this,"dayOfWeek")}get dayOfYear(){return Vs(this,"dayOfYear")}get weekOfYear(){return Vs(this,"weekOfYear")?.week}get yearOfWeek(){return Vs(this,"weekOfYear")?.year}get hoursInDay(){et(this,On);const n=te(this,fi),l=Du(this).isoDate,d=Co(l.year,l.month,l.day+1),m=sf(n,l),_=sf(n,d);return Hy(jn.fromEpochNsDiff(_,m),"hour")}get daysInWeek(){return Vs(this,"daysInWeek")}get daysInMonth(){return Vs(this,"daysInMonth")}get daysInYear(){return Vs(this,"daysInYear")}get monthsInYear(){return Vs(this,"monthsInYear")}get inLeapYear(){return Vs(this,"inLeapYear")}get offset(){return et(this,On),Hb(Qh(te(this,fi),te(this,_n)))}get offsetNanoseconds(){return et(this,On),Qh(te(this,fi),te(this,_n))}with(n,l=void 0){if(et(this,On),!Ar(n))throw new TypeError("invalid zoned-date-time-like");vg(n);const d=te(this,At),m=te(this,fi),_=Qh(m,te(this,_n)),v=Du(this);let c={...to(d,v.isoDate),...v.time,offset:Hb(_)};c=kp(d,c,ll(d,n,["year","month","monthCode","day"],["hour","minute","second","millisecond","microsecond","nanosecond","offset"],"partial"));const C=Qt(l),R=qy(C),N=B0(C,"prefer"),B=A_(d,c,ni(C)),V=wg(c.offset);return _s(K0(B.isoDate,B.time,"option",V,m,R,N,!1),m,d)}withPlainTime(n=void 0){et(this,On);const l=te(this,fi),d=te(this,At),m=Du(this).isoDate;let _;return _=n===void 0?sf(l,m):bs(l,oi(m,te(lf(n),Er)),"compatible"),_s(_,l,d)}withTimeZone(n){et(this,On);const l=eo(n);return _s(te(this,_n),l,te(this,At))}withCalendar(n){et(this,On);const l=C_(n);return _s(te(this,_n),te(this,fi),l)}add(n,l=void 0){return et(this,On),qw("add",this,n,l)}subtract(n,l=void 0){return et(this,On),qw("subtract",this,n,l)}until(n,l=void 0){return et(this,On),Fw("until",this,n,l)}since(n,l=void 0){return et(this,On),Fw("since",this,n,l)}round(n){if(et(this,On),n===void 0)throw new TypeError("options parameter is required");const l=typeof n=="string"?zp("smallestUnit",n):Qt(n),d=bg(l),m=Fc(l,"halfExpand"),_=Eo(l,"smallestUnit","time",cd,["day"]),v={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[_];if(xg(d,v,v===1),_==="nanosecond"&&d===1)return _s(te(this,_n),te(this,fi),te(this,At));const c=te(this,fi),C=te(this,_n),R=Du(this);let N;if(_==="day"){const B=R.isoDate,V=Co(B.year,B.month,B.day+1),G=sf(c,B),ae=sf(c,V),me=W.subtract(ae,G);N=jn.fromEpochNsDiff(C,G).round(me,m).addToEpochNs(G)}else{const B=ex(R,d,_,m),V=Qh(c,C);N=K0(B.isoDate,B.time,"option",V,c,"compatible","prefer",!1)}return _s(N,c,te(this,At))}equals(n){et(this,On);const l=Oy(n),d=te(this,_n),m=te(l,_n);return!!W.equal(W.BigInt(d),W.BigInt(m))&&!!DS(te(this,fi),te(l,fi))&&Fu(te(this,At),te(l,At))}toString(n=void 0){et(this,On);const l=Qt(n),d=w_(l),m=T_(l),_=function(V){return rd(V,"offset",["auto","never"],"auto")}(l),v=Fc(l,"trunc"),c=Eo(l,"smallestUnit","time",void 0);if(c==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const C=function(V){return rd(V,"timeZoneName",["auto","never","critical"],"auto")}(l),{precision:R,unit:N,increment:B}=S_(c,m);return Iw(this,R,d,C,_,{unit:N,increment:B,roundingMode:v})}toLocaleString(n=void 0,l=void 0){et(this,On);const d=Qt(l),m=Object.create(null);if(function(C,R,N,B){if(R==null)return;const V=Reflect.ownKeys(R);for(let G=0;G<V.length;G++){const ae=V[G];if(!N.some(me=>Object.is(me,ae))&&Object.prototype.propertyIsEnumerable.call(R,ae)){const me=R[ae];C[ae]=me}}}(m,d,["timeZone"]),d.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");if(m.year===void 0&&m.month===void 0&&m.day===void 0&&m.era===void 0&&m.weekday===void 0&&m.dateStyle===void 0&&m.hour===void 0&&m.minute===void 0&&m.second===void 0&&m.fractionalSecondDigits===void 0&&m.timeStyle===void 0&&m.dayPeriod===void 0&&m.timeZoneName===void 0&&(m.timeZoneName="short"),m.timeZone=te(this,fi),Rw(m.timeZone))throw new RangeError("toLocaleString does not currently support offset time zones");const _=new Zl(n,m),v=_3.call(_).calendar,c=te(this,At);if(c!=="iso8601"&&v!=="iso8601"&&!Fu(v,c))throw new RangeError(`cannot format ZonedDateTime with calendar ${c} in locale with calendar ${v}`);return _.format(zu(te(this,_n)))}toJSON(){return et(this,On),Iw(this,"auto")}valueOf(){xf("ZonedDateTime")}startOfDay(){et(this,On);const n=te(this,fi);return _s(sf(n,Du(this).isoDate),n,te(this,At))}getTimeZoneTransition(n){et(this,On);const l=te(this,fi);if(n===void 0)throw new TypeError("options parameter is required");const d=rd(typeof n=="string"?zp("direction",n):Qt(n),"direction",["next","previous"],cd);if(d===void 0)throw new TypeError("direction option is required");if(Rw(l)||l==="UTC")return null;const m=te(this,_n),_=d==="next"?Nx(l,m):Wb(l,m);return _===null?null:_s(_,l,te(this,At))}toInstant(){return et(this,On),zu(te(this,_n))}toPlainDate(){return et(this,On),Js(Du(this).isoDate,te(this,At))}toPlainTime(){return et(this,On),Wh(Du(this).time)}toPlainDateTime(){return et(this,On),Vl(Du(this),te(this,At))}static from(n,l=void 0){return Oy(n,l)}static compare(n,l){const d=Oy(n),m=Oy(l),_=te(d,_n),v=te(m,_n);return W.lessThan(W.BigInt(_),W.BigInt(v))?-1:W.greaterThan(W.BigInt(_),W.BigInt(v))?1:0}}function Du(i){return Hl(te(i,fi),te(i,_n))}function Vs(i,n){et(i,On);const l=Du(i).isoDate;return E_(i).isoToDate(l,{[n]:!0})[n]}function $m(i,n){return et(i,On),Du(i).time[n]}fd(Hx,"Temporal.ZonedDateTime");var Ww=Object.freeze({__proto__:null,Duration:fg,Instant:Gx,Now:tE,PlainDate:Zx,PlainDateTime:$x,PlainMonthDay:Yx,PlainTime:z_,PlainYearMonth:qx,ZonedDateTime:Hx});const v3=[Gx,Zx,$x,fg,Yx,z_,qx,Hx];for(const i of v3){const n=Object.getOwnPropertyDescriptor(i,"prototype");(n.configurable||n.enumerable||n.writable)&&(n.configurable=!1,n.enumerable=!1,n.writable=!1,Object.defineProperty(i,"prototype",n))}function b3({tripQueryVariables:i,setTripQueryVariables:n}){const l=ce.useContext(__),d=Ww.Instant.from(i.dateTime).toZonedDateTimeISO(l).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),m=ce.useCallback(_=>{const v=Ww.PlainDateTime.from(_.target.value).toZonedDateTime(l).toString({calendarName:"never",timeZoneName:"never"});n({...i,dateTime:v})},[i,n,l]);return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+l,children:"Time"}),ie.jsx(Si.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:m,value:d})]})}function x3({tripQueryVariables:i,setTripQueryVariables:n}){return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),ie.jsx(Si.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:i.searchWindow||"",onChange:l=>n({...i,searchWindow:Number(l.target.value)>0?Number(l.target.value):void 0})})]})}function w3({tripQueryVariables:i,setTripQueryVariables:n}){return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),ie.jsxs(Si.Select,{id:"accessSelect",size:"sm",className:"input-medium",onChange:l=>{l.target.value!=="not_selected"?n({...i,modes:{...i.modes,accessMode:l.target.value}}):n({...i,modes:i.modes?.directMode||i.modes?.transportModes?{...i.modes,accessMode:void 0}:void 0})},value:i.modes?.accessMode||"not_selected",children:[ie.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(tg).map(l=>ie.jsx("option",{value:l,children:l},l))]})]})}function T3({tripQueryVariables:i,setTripQueryVariables:n}){return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),ie.jsxs(Si.Select,{id:"egressSelect",size:"sm",className:"input-medium",onChange:l=>{l.target.value!=="not_selected"?n({...i,modes:{...i.modes,egressMode:l.target.value}}):n({...i,modes:i.modes?.directMode||i.modes?.transportModes?{...i.modes,egressMode:void 0}:void 0})},value:i.modes?.egressMode||"not_selected",children:[ie.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(tg).map(l=>ie.jsx("option",{value:l,children:l},l))]})]})}function S3({tripQueryVariables:i,setTripQueryVariables:n}){return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),ie.jsxs(Si.Select,{id:"directModeSelect",size:"sm",className:"input-medium",onChange:l=>{l.target.value!=="not_selected"?n({...i,modes:{...i.modes,directMode:l.target.value}}):n({...i,modes:i.modes?.accessMode||i.modes?.egressMode||i.modes?.transportModes?{...i.modes,directMode:void 0}:void 0})},value:i.modes?.directMode||"not_selected",children:[ie.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(tg).map(l=>ie.jsx("option",{value:l,children:l},l))]})]})}const E3=({label:i,options:n,values:l,onChange:d})=>{const[m,_]=ce.useState(!1),v=()=>{_(!m)},c=C=>{const R=C.target.value,N=C.target.checked;d(N?[...l,R]:l.filter(B=>B!==R))};return ie.jsxs("div",{className:`dropdown ${m?"show":""}`,children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:i}),ie.jsx(Si.Control,{type:"text",id:"multiSelectDropdown",size:"sm",className:"input-medium",value:l.length>0?l.join(", "):"Not selected",onClick:v,onChange:()=>{}}),ie.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${m?"show":""}`,children:n.map(C=>ie.jsx(Si.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${C.id}`,label:C.label,checked:l.includes(C.id),onChange:c,value:`${C.id}`},`${C.id}`))})]})};function A3({tripQueryVariables:i,setTripQueryVariables:n}){const l=ce.useMemo(()=>i?.modes?.transportModes?.map(m=>m?.transportMode).filter(m=>!!m)||[],[i.modes?.transportModes]),d=ce.useCallback(m=>{const _=m.map(v=>({transportMode:v}));if(_.length===0)n({...i,modes:i.modes?.directMode||i.modes?.accessMode||i.modes?.egressMode?{...i.modes}:void 0});else{const v=i.modes?.accessMode||tg.Foot,c=i.modes?.egressMode||tg.Foot;n({...i,modes:{...i.modes,transportModes:_.length>0?_:void 0,accessMode:v,egressMode:c}})}},[i,n]);return ie.jsx(E3,{label:"Transit mode",options:Object.values(V2).map(m=>({id:m,label:m.toString()})),values:l,onChange:d})}function M3({tripQueryVariables:i,setTripQueryVariables:n}){return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),ie.jsx(Si.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:i.numTripPatterns||"",onChange:l=>n({...i,numTripPatterns:Number(l.target.value)>0?Number(l.target.value):void 0})})]})}function C3({tripQueryVariables:i,setTripQueryVariables:n}){return ie.jsxs(Si.Group,{children:[ie.jsx(Si.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),ie.jsxs(Si.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-small",onChange:l=>{n({...i,itineraryFilters:{debug:l.target.value}})},value:i.itineraryFilters?.debug||"not_selected",children:[ie.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(U2).map(l=>ie.jsx("option",{value:l,children:l},l))]})]})}const D3="https://www.opentripplanner.org/debug-client-assets/2025/09/2025-09-17T06:33/assets/graphql-solid-B1mrnAEK.svg",k3="/graphiql?flavor=transmodel";function I3({tripQueryVariables:i}){const n=encodeURIComponent(JSON.stringify(i)),l=encodeURIComponent(QI),d="Open in GraphiQL";return ie.jsx(Cp,{title:d,href:k3+"&query="+l+"&variables="+n,target:"_blank",children:ie.jsx("img",{alt:d,title:d,src:D3,width:"20",height:"20",className:"d-inline-block align-middle"})})}function R3({tripQueryVariables:i,setTripQueryVariables:n,onRoute:l,loading:d}){return ie.jsxs("div",{className:"box input-group search-bar",children:[ie.jsxs("div",{className:"input-family",children:[ie.jsx(mw,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(dR,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(mw,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:i,setTripQueryVariables:n})]}),ie.jsxs("div",{className:"input-family",children:[ie.jsx(fR,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(b3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ie.jsxs("div",{className:"input-family",children:[ie.jsx(M3,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(x3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ie.jsxs("div",{className:"input-family",children:[ie.jsx(w3,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(A3,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(T3,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx(S3,{tripQueryVariables:i,setTripQueryVariables:n})]}),ie.jsx(C3,{tripQueryVariables:i,setTripQueryVariables:n}),ie.jsx("div",{className:"search-bar-route-button-wrapper",children:ie.jsxs(gx,{children:[ie.jsxs(Cp,{variant:"primary",onClick:()=>l(),disabled:d,children:[d&&ie.jsxs(ie.Fragment,{children:[ie.jsx(HT,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),ie.jsx(I3,{tripQueryVariables:i})]})})]})}const nE=ce.createContext(void 0);function P3(){const i=ce.useContext(nE);if(!i)throw new Error("useTripSchema must be used within a TripSchemaProvider");return i}function Gs(i,n){return n.split(".").reduce((l,d)=>{if(l!=null){if(Array.isArray(l)){const m=Number(d);return Number.isNaN(m)?void 0:l[m]}else if(typeof l=="object")return l[d]}},i)}function rf(i,n,l){const d=n.split(".");function m(_,v){const c=d[v],C=!isNaN(Number(c));if(v===d.length-1){if(Array.isArray(_)&&C){const V=[..._];return V[Number(c)]=l,V}if(yb(_)&&!C)return{..._,[c]:l};if(C){const V=Array.isArray(_)?[..._]:[];return V[Number(c)]=l,V}else return{...yb(_)?_:{},[c]:l}}const R=v+1,N=d[R],B=!isNaN(Number(N));if(Array.isArray(_)&&C){const V=[..._],G=_[Number(c)];return V[Number(c)]=m(G!==void 0?G:B?[]:{},R),V}else if(yb(_)&&!C){const V={..._},G=_[c];return V[c]=m(G!==void 0?G:B?[]:{},R),V}else if(C){const V=[];return V[Number(c)]=m(B?[]:{},R),V}else return{[c]:m(B?[]:{},R)}}return i==null&&(i=!isNaN(Number(d[0]))?[]:{}),m(i,0)}function yb(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}const z3="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",N3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",L3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",O3=({defaultValue:i,type:n})=>ie.jsxs("span",{children:[i!=null&&ie.jsx("span",{title:`Default: ${i??"None"}`,children:ie.jsx("img",{alt:"Info",src:z3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="DoubleFunction"&&ie.jsx("span",{title:`Type: ${n.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:ie.jsx("img",{alt:"Info",src:N3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="Duration"&&ie.jsx("span",{className:"default-tooltip-icon",title:`Type: ${n.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:ie.jsx("img",{alt:"Info",src:L3,className:"default-tooltip-icon"})})]}),iE=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),rE=({tripQueryVariables:i,setTripQueryVariables:n})=>{function l(){let d={};iE.forEach(m=>{const _=Gs(i,m);_!==void 0&&(d=rf(d,m,_))}),n(d)}return ie.jsx("button",{className:"reset-button",onClick:l,children:"Reset"})};function _b(i){if(!i)return" ";const n=i.split(".");return n[n.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,d=>d.toUpperCase())+" "}function F0(i,n=[]){let l=[];return i?(Object.entries(i).forEach(([d,m])=>{const _=[...n,d].join(".");l=l.concat(j3(d,m,_,n))}),l):[]}function j3(i,n,l,d){let m=[];if(typeof n=="object"&&n.type)if(n.type.type==="Enum"){const _=["Not selected",...n.type.values||[]],v=n.defaultValue!==void 0?n.defaultValue:"Not selected";m.push({path:l,type:{type:"Enum"},defaultValue:v,enumValues:_,isList:n.isList})}else n.type.type==="InputObject"&&n.isList?(m.push({path:l,type:{type:"Group",name:n.type.name},defaultValue:n.defaultValue,isComplex:!0,isList:!0}),m=m.concat(F0(n.type.fields,[...d,`${i}.*`]))):n.type.type==="InputObject"?(m.push({path:l,type:{type:"Group",name:n.type.name},isComplex:!0,isList:!1}),m=m.concat(F0(n.type.fields,[...d,i]))):n.type.type==="Scalar"&&m.push({path:l,type:{type:n.type.type,subtype:n.type.subtype},defaultValue:n.defaultValue,isList:n.isList});else typeof n=="object"&&n.type?.fields?(m.push({path:l,type:{type:"Group"},isComplex:!0}),m=m.concat(F0(n.type.fields,[...d,i]))):m.push({path:l,type:n.type??typeof n,defaultValue:n.defaultValue});return m}const B3=({tripQueryVariables:i,setTripQueryVariables:n})=>{const[l,d]=ce.useState([]),[m,_]=ce.useState({}),[v]=ce.useState(""),{tripArgs:c,loading:C,error:R}=P3();ce.useEffect(()=>{if(!c||C||R)return;const Ae=F0(c.trip.arguments);d(Ae)},[c,C,R]);function N(Ae){return Ae.replace(/\.\d+/g,".*")}function B(Ae,Ke){const mt=N(Ae),st=l.find(rt=>rt.path===mt);if(!st){console.error(`No matching argumentConfig found for path: ${Ae}`);return}if(st.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(st.type.subtype)&&st.isList&&typeof Ke=="string"){const rt=Ke.split(",").map(Rt=>Rt.trim());let Mt=rf(i,Ae,rt);Mt=G(Mt,Ae),n(Mt);return}let Pe=rf(i,Ae,Ke);Pe=G(Pe,Ae),n(Pe)}function V(Ae){return typeof Ae=="object"&&Ae!==null&&!Array.isArray(Ae)}function G(Ae,Ke){if(!Ke.includes(".")){const st=Gs(Ae,Ke);if(Array.isArray(st)&&st.length===0){const Pe={...Ae};return delete Pe[Ke],Pe}if(V(st)&&Object.keys(st).every(rt=>{const Mt=st[rt];return Mt==null||Array.isArray(Mt)&&Mt.length===0})){const rt={...Ae};return delete rt[Ke],rt}return Ae}const mt=Ke.split(".");for(let st=mt.length-1;st>0;st--){const Pe=mt.slice(0,st).join("."),rt=Gs(Ae,Pe);rt!=null&&(Array.isArray(rt)?rt.length===0&&(Ae=rf(Ae,Pe,void 0)):V(rt)&&Object.keys(rt).every(Rt=>{const jt=`${Pe}.${Rt}`,en=Gs(Ae,jt);return en==null||Array.isArray(en)&&en.length===0})&&(Ae=rf(Ae,Pe,void 0)))}return Ae}function ae(Ae){_(Ke=>({...Ke,[Ae]:!Ke[Ae]}))}const me=l.filter(({path:Ae})=>_b(Ae).toLowerCase().includes(v.toLowerCase())).filter(({path:Ae})=>!iE.has(Ae));function pe(Ae,Ke,mt,st){const Pe=Gs(i,Ae)??[],rt=st.name;return ie.jsxs("div",{children:[Pe.map((Mt,Rt)=>{const jt=`${Ae}.${Rt}`,en=Ke.filter(ct=>ct.path.startsWith(`${Ae}.*.`)&&ct.path!==`${Ae}.*`).map(ct=>({...ct,path:ct.path.replace(`${Ae}.*`,jt)})),ln=en.filter(ct=>ct.path.split(".").length===jt.split(".").length+1),Ge=m[jt];return ie.jsxs("div",{style:{marginLeft:15},children:[ie.jsxs("span",{style:{cursor:"pointer"},onClick:()=>ae(jt),children:[Ge?" ":" "," [#",Rt+1,"]"]}),ie.jsx("button",{style:{marginLeft:10},onClick:()=>Ve(Ae,Rt),children:"Remove"}),Ge&&ie.jsx("div",{style:{marginLeft:20},children:qe(ln,mt+1,en)})]},jt)}),ie.jsxs("button",{onClick:()=>Ne(Ae),children:["+ Add ",rt]})]})}function Ne(Ae){const mt=[...Gs(i,Ae)??[],{}],st=rf(i,Ae,mt);n(st)}function Ve(Ae,Ke){const st=(Gs(i,Ae)??[]).filter((rt,Mt)=>Mt!==Ke);let Pe=rf(i,Ae,st);Pe=G(Pe,Ae),n(Pe)}function Fe(Ae){let Ke=rf(i,Ae,void 0);Ke=G(Ke,Ae),n(Ke)}function qe(Ae,Ke,mt){return Ae.map(({path:st,type:Pe,defaultValue:rt,enumValues:Mt,isComplex:Rt,isList:jt})=>{const en=m[st],ln=st.split(".").length,Ge=mt.filter(ht=>{const kt=ht.path.split(".").length;return ht.path.startsWith(`${st}.`)&&ht.path!==st&&kt===ln+1}),ct=Ke+1;return ie.jsx("div",{style:{marginLeft:`${Ke*15}px`,marginBottom:"10px"},children:Rt?ie.jsxs("div",{children:[ie.jsxs("span",{style:{cursor:"pointer"},onClick:()=>ae(st),children:[en?" ":" "," ",_b(st)]}),en&&jt?ie.jsx("div",{style:{marginLeft:20},children:pe(st,mt,ct,Pe)}):en?qe(Ge,ct,mt):null]}):ie.jsxs("div",{children:[ie.jsxs("label",{className:"argument-label",htmlFor:st,children:[_b(st)," ",ie.jsx(O3,{defaultValue:rt,type:Pe})]}),Pe.subtype==="Boolean"&&(()=>{const ht=Gs(i,st),kt=ht!==void 0;return ie.jsxs("span",{children:[ie.jsx("input",{type:"checkbox",id:st,checked:ht??!1,onChange:Ee=>B(st,Ee.target.checked)}),kt&&ie.jsx("a",{onClick:()=>Fe(st),className:"remove-argument",children:"x"})]})})(),Pe.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Pe.subtype)&&jt&&ie.jsx("input",{className:"comma-separated-input",type:"text",id:st,value:(()=>{const ht=Gs(i,st);return Array.isArray(ht)?ht.join(", "):""})(),onChange:ht=>B(st,ht.target.value),placeholder:"Comma-separated list"}),Pe.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(Pe.subtype)&&!jt&&ie.jsx("input",{type:"text",id:st,value:Gs(i,st)??"",onChange:ht=>B(st,ht.target.value||void 0)}),Pe.subtype==="Int"&&ie.jsx("input",{type:"number",id:st,value:Gs(i,st)??"",onChange:ht=>{const kt=parseInt(ht.target.value,10);B(st,Number.isNaN(kt)?void 0:kt)}}),Pe.subtype==="Float"&&ie.jsx("input",{type:"number",id:st,step:"any",value:Gs(i,st)??"",onChange:ht=>{const kt=parseFloat(ht.target.value);B(st,Number.isNaN(kt)?void 0:kt)}}),Pe.subtype==="DateTime"&&ie.jsx("input",{type:"datetime-local",id:st,value:(Gs(i,st)??"").slice(0,16),onChange:ht=>{const kt=ht.target.value?new Date(ht.target.value).toISOString():void 0;B(st,kt)}}),Pe.type==="Enum"&&Mt&&jt&&ie.jsx("select",{id:st,multiple:!0,value:(()=>{const ht=Gs(i,st);return Array.isArray(ht)?ht:[]})(),onChange:ht=>{const kt=Array.from(ht.target.selectedOptions,Ee=>Ee.value);B(st,kt)},children:Mt.map(ht=>ie.jsx("option",{value:ht,children:ht},ht))}),Pe.type==="Enum"&&Mt&&!jt&&ie.jsx("select",{id:st,value:Gs(i,st)??"Not selected",onChange:ht=>{B(st,ht.target.value||void 0)},children:Mt.map(ht=>ie.jsx("option",{value:ht,children:ht},ht))})]})},st)})}return ie.jsxs("div",{className:"left-pane-container below-content",children:[ie.jsxs("div",{className:"panel-header",children:["Filters",ie.jsx(rE,{tripQueryVariables:i,setTripQueryVariables:n})]}),me.length===0?ie.jsx("p",{children:"No arguments found."}):ie.jsx("div",{className:"argument-list",children:qe(me.filter(Ae=>Ae.path.split(".").length===1),0,me)})]})},F3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",U3="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",V3="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",G3=({children:i})=>{const[n,l]=ce.useState(0),d=_=>{switch(_){case 0:return ie.jsx("img",{src:F3,alt:"Itineray list",title:"Itineray"});case 1:return ie.jsx("img",{src:U3,alt:"Filters",title:"Filters"});case 2:return ie.jsx("img",{width:"25",height:"25",src:V3,alt:"Filters",title:"Filters"});default:return null}},m=Ul.Children.toArray(i).filter(_=>Ul.isValidElement(_));return ie.jsxs("div",{className:"sidebar-container",children:[ie.jsx("div",{className:"sidebar",children:m.map((_,v)=>ie.jsx("div",{className:`sidebar-button ${v===n?"active":""}`,onClick:()=>l(v),children:d(v)},v))}),ie.jsx("div",{className:"sidebar-content",children:m.map((_,v)=>v===n?ie.jsx("div",{children:_},v):null)})]})},Z3=({tripQueryVariables:i,setTripQueryVariables:n})=>ie.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[ie.jsxs("div",{className:"panel-header",children:["Arguments raw",ie.jsx(rE,{tripQueryVariables:i,setTripQueryVariables:n})]}),ie.jsx("pre",{children:JSON.stringify(i,null,2)})]});function $3(i){let n=i;for(;;)if(Jh(n))n=n.ofType;else if(yf(n))n=n.ofType;else break;return n}function aE(i){const n=$3(i);if(gg(n))return{type:"Scalar",subtype:n.name};if(df(n))return{type:"Enum",values:n.getValues().map(l=>l.name)};if(Kh(n)){const l=n.getFields(),d={};for(const m of Object.keys(l)){const _=l[m];if(_.deprecationReason)continue;const v=yf(_.type),c=_.defaultValue!==void 0?_.defaultValue:null;d[m]={type:aE(_.type),defaultValue:c,isList:v}}return{type:"InputObject",name:n.name,fields:d}}return{type:"Scalar",subtype:"String"}}function Y3(i){const n=i.getQueryType();if(!n)throw new Error("No Query type found in the schema.");const l=n.getFields().trip;if(!l)throw new Error("No trip query found in the schema.");const d={};return l.args.forEach(m=>{if(m.deprecationReason)return;const _=m.name,v=aE(m.type),c=m.defaultValue!==null?m.defaultValue:null,C=yf(m.type);d[_]={type:v,...c!==null&&{defaultValue:c},isList:C}}),{trip:{arguments:d}}}async function q3(i){const n=pM(),l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!l.ok)throw new Error(`Failed to fetch schema. HTTP error: ${l.status}`);const{data:d}=await l.json(),m=mM(d);return Y3(m)}function H3({endpoint:i,children:n}){const[l,d]=ce.useState(null),[m,_]=ce.useState(!0),[v,c]=ce.useState(null);ce.useEffect(()=>{let R=!0;async function N(){_(!0),c(null);try{const B=await q3(i);R&&d(B)}catch(B){console.error("Error loading trip arguments:",B),R&&c("Failed to load trip schema")}finally{R&&_(!1)}}return N(),()=>{R=!1}},[i]);const C={tripArgs:l,loading:m,error:v};return ie.jsx(nE.Provider,{value:C,children:n})}function X3(){const i=eR(),{tripQueryVariables:n,setTripQueryVariables:l}=rR(),[d,m,_]=KI(n),[v,c]=ce.useState(0),C=i?.internalTransitModelTimeZone||Intl.DateTimeFormat().resolvedOptions().timeZone;return ie.jsx("div",{className:"app",children:ie.jsx(__.Provider,{value:C,children:ie.jsxs("div",{className:"layout",children:[ie.jsx("div",{className:"box logo-section",children:ie.jsx(oR,{serverInfo:i})}),ie.jsx("div",{className:"box input-section",children:ie.jsx(R3,{onRoute:_,tripQueryVariables:n,setTripQueryVariables:l,loading:m})}),ie.jsx("div",{className:"box trip-section",children:ie.jsxs(G3,{children:[ie.jsx(WI,{tripQueryResult:d,selectedTripPatternIndex:v,setSelectedTripPatternIndex:c,pageResults:_,loading:m}),ie.jsx(H3,{endpoint:Wy(),children:ie.jsx(B3,{tripQueryVariables:n,setTripQueryVariables:l})}),ie.jsx(Z3,{tripQueryVariables:n,setTripQueryVariables:l})]})}),ie.jsx("div",{className:"box map-section",children:ie.jsx(Jk,{tripQueryResult:d,tripQueryVariables:n,setTripQueryVariables:l,selectedTripPatternIndex:v,loading:m})})]})})})}gE.createRoot(document.getElementById("root")).render(ie.jsx(Ul.StrictMode,{children:ie.jsx(X3,{})}));
